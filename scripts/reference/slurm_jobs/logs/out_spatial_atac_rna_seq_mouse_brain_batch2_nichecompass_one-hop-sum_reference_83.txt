[True]
Run timestamp: 10082023_224626_83.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_83']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6740; val_auprc_score: 0.7242; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 97063.1865; train_edge_recon_loss: 3777694.9256; train_gene_expr_recon_loss: 45314059.2977; train_masked_gp_l1_reg_loss: 85616.8836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245824.8812; train_chrom_access_recon_loss: 4123182.2500; train_global_loss: 53643441.1298; train_optim_loss: 53643441.1298; val_kl_reg_loss: 139059.0010; val_edge_recon_loss: 4065655.2667; val_gene_expr_recon_loss: 38778497.8667; val_masked_gp_l1_reg_loss: 87413.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 240767.3750; val_chrom_access_recon_loss: 3891368.3667; val_global_loss: 47202761.0667; val_optim_loss: 47202761.0667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7666; val_auprc_score: 0.7858; val_best_acc_score: 0.5771; val_best_f1_score: 0.6988; train_kl_reg_loss: 143367.2394; train_edge_recon_loss: 3670519.7920; train_gene_expr_recon_loss: 38652896.8855; train_masked_gp_l1_reg_loss: 88353.2078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 235711.9750; train_chrom_access_recon_loss: 3860226.7767; train_global_loss: 46651075.9389; train_optim_loss: 46651075.9389; val_kl_reg_loss: 192303.8458; val_edge_recon_loss: 4061304.0333; val_gene_expr_recon_loss: 37378389.3333; val_masked_gp_l1_reg_loss: 86044.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 229512.5312; val_chrom_access_recon_loss: 3833189.9333; val_global_loss: 45780743.7333; val_optim_loss: 45780743.7333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8267; val_auprc_score: 0.8308; val_best_acc_score: 0.7385; val_best_f1_score: 0.7351; train_kl_reg_loss: 172550.7542; train_edge_recon_loss: 3567201.1050; train_gene_expr_recon_loss: 37113579.5725; train_masked_gp_l1_reg_loss: 83971.6693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 222810.0004; train_chrom_access_recon_loss: 3792447.8702; train_global_loss: 44952560.9466; train_optim_loss: 44952560.9466; val_kl_reg_loss: 177131.7781; val_edge_recon_loss: 4017865.8000; val_gene_expr_recon_loss: 36525016.0000; val_masked_gp_l1_reg_loss: 82772.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 216119.5781; val_chrom_access_recon_loss: 3761921.0333; val_global_loss: 44780826.6667; val_optim_loss: 44780826.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8924; val_auprc_score: 0.8842; val_best_acc_score: 0.8118; val_best_f1_score: 0.8216; train_kl_reg_loss: 154244.8483; train_edge_recon_loss: 3528839.1698; train_gene_expr_recon_loss: 36701765.5878; train_masked_gp_l1_reg_loss: 83204.9986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 209845.2326; train_chrom_access_recon_loss: 3769216.5992; train_global_loss: 44447116.6107; train_optim_loss: 44447116.6107; val_kl_reg_loss: 143131.2521; val_edge_recon_loss: 3851065.3500; val_gene_expr_recon_loss: 36225050.4000; val_masked_gp_l1_reg_loss: 85296.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 203655.6719; val_chrom_access_recon_loss: 3746466.6333; val_global_loss: 44254666.1333; val_optim_loss: 44254666.1333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8893; val_auprc_score: 0.8774; val_best_acc_score: 0.7996; val_best_f1_score: 0.8172; train_kl_reg_loss: 138012.4849; train_edge_recon_loss: 3320792.4256; train_gene_expr_recon_loss: 36465976.7328; train_masked_gp_l1_reg_loss: 86428.7938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 197898.1931; train_chrom_access_recon_loss: 3756333.1794; train_global_loss: 43965441.8931; train_optim_loss: 43965441.8931; val_kl_reg_loss: 161454.5573; val_edge_recon_loss: 3097927.0500; val_gene_expr_recon_loss: 36036975.2000; val_masked_gp_l1_reg_loss: 87673.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192253.4219; val_chrom_access_recon_loss: 3735766.9500; val_global_loss: 43312048.2667; val_optim_loss: 43312048.2667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8933; val_auprc_score: 0.8749; val_best_acc_score: 0.8168; val_best_f1_score: 0.8321; train_kl_reg_loss: 179308.8370; train_edge_recon_loss: 3008353.0382; train_gene_expr_recon_loss: 36189543.8168; train_masked_gp_l1_reg_loss: 88404.5297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 187098.0533; train_chrom_access_recon_loss: 3738948.7195; train_global_loss: 43391656.9160; train_optim_loss: 43391656.9160; val_kl_reg_loss: 177340.0083; val_edge_recon_loss: 2986499.9000; val_gene_expr_recon_loss: 35772960.8000; val_masked_gp_l1_reg_loss: 89346.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 182095.0156; val_chrom_access_recon_loss: 3726605.4167; val_global_loss: 42934848.5333; val_optim_loss: 42934848.5333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9132; val_auprc_score: 0.8982; val_best_acc_score: 0.8406; val_best_f1_score: 0.8517; train_kl_reg_loss: 176408.7301; train_edge_recon_loss: 2947284.1279; train_gene_expr_recon_loss: 35964777.8015; train_masked_gp_l1_reg_loss: 90655.4820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 177484.0688; train_chrom_access_recon_loss: 3721518.8855; train_global_loss: 43078129.0687; train_optim_loss: 43078129.0687; val_kl_reg_loss: 174702.3510; val_edge_recon_loss: 2919909.8833; val_gene_expr_recon_loss: 35612882.0000; val_masked_gp_l1_reg_loss: 91834.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172895.3906; val_chrom_access_recon_loss: 3723185.2167; val_global_loss: 42695411.4667; val_optim_loss: 42695411.4667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9182; val_auprc_score: 0.9005; val_best_acc_score: 0.8433; val_best_f1_score: 0.8552; train_kl_reg_loss: 173835.6677; train_edge_recon_loss: 2918784.7939; train_gene_expr_recon_loss: 35779842.5038; train_masked_gp_l1_reg_loss: 92821.7112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 168650.4844; train_chrom_access_recon_loss: 3709213.3092; train_global_loss: 42843148.4580; train_optim_loss: 42843148.4580; val_kl_reg_loss: 168355.6292; val_edge_recon_loss: 2914415.5833; val_gene_expr_recon_loss: 35405520.2667; val_masked_gp_l1_reg_loss: 93943.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 164387.8438; val_chrom_access_recon_loss: 3702995.6333; val_global_loss: 42449617.8667; val_optim_loss: 42449617.8667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9187; val_auprc_score: 0.9036; val_best_acc_score: 0.8432; val_best_f1_score: 0.8566; train_kl_reg_loss: 169795.0947; train_edge_recon_loss: 2892508.8569; train_gene_expr_recon_loss: 35635193.0382; train_masked_gp_l1_reg_loss: 95002.8461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160488.3952; train_chrom_access_recon_loss: 3700501.1355; train_global_loss: 42653489.3130; train_optim_loss: 42653489.3130; val_kl_reg_loss: 164143.1156; val_edge_recon_loss: 2905463.7667; val_gene_expr_recon_loss: 35384077.6000; val_masked_gp_l1_reg_loss: 95998.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156570.1406; val_chrom_access_recon_loss: 3697929.5667; val_global_loss: 42404185.6000; val_optim_loss: 42404185.6000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9295; val_auprc_score: 0.9143; val_best_acc_score: 0.8573; val_best_f1_score: 0.8654; train_kl_reg_loss: 163136.0054; train_edge_recon_loss: 2879269.9237; train_gene_expr_recon_loss: 35414476.6412; train_masked_gp_l1_reg_loss: 97011.2957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152838.3210; train_chrom_access_recon_loss: 3681999.7156; train_global_loss: 42388731.9084; train_optim_loss: 42388731.9084; val_kl_reg_loss: 163994.9781; val_edge_recon_loss: 2857783.9667; val_gene_expr_recon_loss: 35197961.6000; val_masked_gp_l1_reg_loss: 98086.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149148.8281; val_chrom_access_recon_loss: 3686549.6667; val_global_loss: 42153525.0667; val_optim_loss: 42153525.0667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9295; val_auprc_score: 0.9166; val_best_acc_score: 0.8564; val_best_f1_score: 0.8664; train_kl_reg_loss: 157006.8044; train_edge_recon_loss: 2874617.8779; train_gene_expr_recon_loss: 35363039.1603; train_masked_gp_l1_reg_loss: 99083.0963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145635.7083; train_chrom_access_recon_loss: 3678975.0477; train_global_loss: 42318357.2824; train_optim_loss: 42318357.2824; val_kl_reg_loss: 151405.3406; val_edge_recon_loss: 2867721.1500; val_gene_expr_recon_loss: 35045485.3333; val_masked_gp_l1_reg_loss: 100047.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142150.0312; val_chrom_access_recon_loss: 3664621.2000; val_global_loss: 41971433.0667; val_optim_loss: 41971433.0667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9280; val_auprc_score: 0.9117; val_best_acc_score: 0.8580; val_best_f1_score: 0.8689; train_kl_reg_loss: 153816.3913; train_edge_recon_loss: 2847605.3416; train_gene_expr_recon_loss: 35199756.9466; train_masked_gp_l1_reg_loss: 101006.8321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138855.8577; train_chrom_access_recon_loss: 3666534.4885; train_global_loss: 42107576.0305; train_optim_loss: 42107576.0305; val_kl_reg_loss: 152202.4990; val_edge_recon_loss: 2854450.8833; val_gene_expr_recon_loss: 34960232.8000; val_masked_gp_l1_reg_loss: 101890.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135612.2500; val_chrom_access_recon_loss: 3660298.8000; val_global_loss: 41864689.3333; val_optim_loss: 41864689.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9426; val_auprc_score: 0.9319; val_best_acc_score: 0.8736; val_best_f1_score: 0.8817; train_kl_reg_loss: 150426.2063; train_edge_recon_loss: 2836950.7863; train_gene_expr_recon_loss: 35118879.0534; train_masked_gp_l1_reg_loss: 102904.5754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132621.8799; train_chrom_access_recon_loss: 3661116.1584; train_global_loss: 42002898.5038; train_optim_loss: 42002898.5038; val_kl_reg_loss: 148047.2469; val_edge_recon_loss: 2841780.2500; val_gene_expr_recon_loss: 34798078.6667; val_masked_gp_l1_reg_loss: 103603.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129717.3594; val_chrom_access_recon_loss: 3651059.5667; val_global_loss: 41672285.8667; val_optim_loss: 41672285.8667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9426; val_auprc_score: 0.9304; val_best_acc_score: 0.8728; val_best_f1_score: 0.8819; train_kl_reg_loss: 146582.4177; train_edge_recon_loss: 2834336.3855; train_gene_expr_recon_loss: 34985582.1069; train_masked_gp_l1_reg_loss: 105228.2794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126915.4512; train_chrom_access_recon_loss: 3650126.4924; train_global_loss: 41848771.2977; train_optim_loss: 41848771.2977; val_kl_reg_loss: 145368.8573; val_edge_recon_loss: 2843520.8500; val_gene_expr_recon_loss: 34701401.6000; val_masked_gp_l1_reg_loss: 106485.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124247.0469; val_chrom_access_recon_loss: 3644935.6500; val_global_loss: 41565958.9333; val_optim_loss: 41565958.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9411; val_auprc_score: 0.9294; val_best_acc_score: 0.8763; val_best_f1_score: 0.8833; train_kl_reg_loss: 140356.5861; train_edge_recon_loss: 2840849.3893; train_gene_expr_recon_loss: 34991386.8855; train_masked_gp_l1_reg_loss: 107565.2348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121598.9567; train_chrom_access_recon_loss: 3654096.2805; train_global_loss: 41855853.0382; train_optim_loss: 41855853.0382; val_kl_reg_loss: 137218.7313; val_edge_recon_loss: 2833318.7333; val_gene_expr_recon_loss: 34739718.9333; val_masked_gp_l1_reg_loss: 108522.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118972.3906; val_chrom_access_recon_loss: 3658697.5500; val_global_loss: 41596449.6000; val_optim_loss: 41596449.6000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9453; val_auprc_score: 0.9339; val_best_acc_score: 0.8771; val_best_f1_score: 0.8854; train_kl_reg_loss: 140110.0192; train_edge_recon_loss: 2815571.8912; train_gene_expr_recon_loss: 34897633.1298; train_masked_gp_l1_reg_loss: 108970.8566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116463.8529; train_chrom_access_recon_loss: 3649699.3340; train_global_loss: 41728448.8855; train_optim_loss: 41728448.8855; val_kl_reg_loss: 138324.9458; val_edge_recon_loss: 2827008.6667; val_gene_expr_recon_loss: 34625204.2667; val_masked_gp_l1_reg_loss: 109879.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114073.7344; val_chrom_access_recon_loss: 3639796.3833; val_global_loss: 41454286.6667; val_optim_loss: 41454286.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9514; val_auprc_score: 0.9418; val_best_acc_score: 0.8824; val_best_f1_score: 0.8874; train_kl_reg_loss: 137055.7940; train_edge_recon_loss: 2808958.8683; train_gene_expr_recon_loss: 34792303.5115; train_masked_gp_l1_reg_loss: 110539.5361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111710.4346; train_chrom_access_recon_loss: 3639884.3721; train_global_loss: 41600452.4580; train_optim_loss: 41600452.4580; val_kl_reg_loss: 133386.3755; val_edge_recon_loss: 2828686.7167; val_gene_expr_recon_loss: 34588969.8667; val_masked_gp_l1_reg_loss: 111557.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109414.9688; val_chrom_access_recon_loss: 3644934.4500; val_global_loss: 41416949.3333; val_optim_loss: 41416949.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9540; val_auprc_score: 0.9445; val_best_acc_score: 0.8876; val_best_f1_score: 0.8930; train_kl_reg_loss: 132421.2441; train_edge_recon_loss: 2811572.9370; train_gene_expr_recon_loss: 34727534.3359; train_masked_gp_l1_reg_loss: 112785.0953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107222.6751; train_chrom_access_recon_loss: 3635743.1050; train_global_loss: 41527280.0305; train_optim_loss: 41527280.0305; val_kl_reg_loss: 132597.1552; val_edge_recon_loss: 2809371.2167; val_gene_expr_recon_loss: 34576774.1333; val_masked_gp_l1_reg_loss: 113716.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105082.7656; val_chrom_access_recon_loss: 3642263.2333; val_global_loss: 41379805.8667; val_optim_loss: 41379805.8667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9596; val_auprc_score: 0.9514; val_best_acc_score: 0.8976; val_best_f1_score: 0.9002; train_kl_reg_loss: 131582.9181; train_edge_recon_loss: 2794887.8034; train_gene_expr_recon_loss: 34650617.5115; train_masked_gp_l1_reg_loss: 114616.1464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103090.5008; train_chrom_access_recon_loss: 3629497.7233; train_global_loss: 41424292.5496; train_optim_loss: 41424292.5496; val_kl_reg_loss: 129751.8938; val_edge_recon_loss: 2777356.5167; val_gene_expr_recon_loss: 34412469.3333; val_masked_gp_l1_reg_loss: 115094.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101034.7266; val_chrom_access_recon_loss: 3631911.7000; val_global_loss: 41167621.8667; val_optim_loss: 41167621.8667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9592; val_auprc_score: 0.9506; val_best_acc_score: 0.8985; val_best_f1_score: 0.9020; train_kl_reg_loss: 128298.2341; train_edge_recon_loss: 2790926.4752; train_gene_expr_recon_loss: 34637945.6183; train_masked_gp_l1_reg_loss: 115907.4657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99163.4566; train_chrom_access_recon_loss: 3631193.5172; train_global_loss: 41403434.6260; train_optim_loss: 41403434.6260; val_kl_reg_loss: 128864.3750; val_edge_recon_loss: 2801014.2667; val_gene_expr_recon_loss: 34278954.0000; val_masked_gp_l1_reg_loss: 116473.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97293.9844; val_chrom_access_recon_loss: 3615730.9833; val_global_loss: 41038328.0000; val_optim_loss: 41038328.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9597; val_auprc_score: 0.9520; val_best_acc_score: 0.8996; val_best_f1_score: 0.9012; train_kl_reg_loss: 127828.5197; train_edge_recon_loss: 2779634.7977; train_gene_expr_recon_loss: 34553549.1908; train_masked_gp_l1_reg_loss: 117148.2332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95587.4114; train_chrom_access_recon_loss: 3626185.0115; train_global_loss: 41299933.1908; train_optim_loss: 41299933.1908; val_kl_reg_loss: 128910.8375; val_edge_recon_loss: 2794522.9667; val_gene_expr_recon_loss: 34499946.5333; val_masked_gp_l1_reg_loss: 117840.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93858.8750; val_chrom_access_recon_loss: 3642903.5833; val_global_loss: 41277983.7333; val_optim_loss: 41277983.7333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9615; val_auprc_score: 0.9542; val_best_acc_score: 0.9006; val_best_f1_score: 0.9047; train_kl_reg_loss: 124894.9623; train_edge_recon_loss: 2784092.7901; train_gene_expr_recon_loss: 34512456.1374; train_masked_gp_l1_reg_loss: 118593.8160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92331.7764; train_chrom_access_recon_loss: 3621183.9065; train_global_loss: 41253553.5267; train_optim_loss: 41253553.5267; val_kl_reg_loss: 123873.0813; val_edge_recon_loss: 2784475.9167; val_gene_expr_recon_loss: 34398260.5333; val_masked_gp_l1_reg_loss: 119429.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90782.5938; val_chrom_access_recon_loss: 3638465.0167; val_global_loss: 41155286.6667; val_optim_loss: 41155286.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9636; val_auprc_score: 0.9561; val_best_acc_score: 0.9050; val_best_f1_score: 0.9084; train_kl_reg_loss: 124305.0352; train_edge_recon_loss: 2770060.0191; train_gene_expr_recon_loss: 34459591.4504; train_masked_gp_l1_reg_loss: 120107.4459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89330.4027; train_chrom_access_recon_loss: 3621793.5573; train_global_loss: 41185187.6336; train_optim_loss: 41185187.6336; val_kl_reg_loss: 125568.2620; val_edge_recon_loss: 2790231.5333; val_gene_expr_recon_loss: 34335390.9333; val_masked_gp_l1_reg_loss: 121021.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87952.8438; val_chrom_access_recon_loss: 3624298.2833; val_global_loss: 41084461.6000; val_optim_loss: 41084461.6000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9661; val_auprc_score: 0.9584; val_best_acc_score: 0.9116; val_best_f1_score: 0.9147; train_kl_reg_loss: 122650.3916; train_edge_recon_loss: 2766101.4523; train_gene_expr_recon_loss: 34420929.4351; train_masked_gp_l1_reg_loss: 121853.3025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86580.0240; train_chrom_access_recon_loss: 3618891.8225; train_global_loss: 41137006.4733; train_optim_loss: 41137006.4733; val_kl_reg_loss: 122310.5161; val_edge_recon_loss: 2766597.2000; val_gene_expr_recon_loss: 34184534.0000; val_masked_gp_l1_reg_loss: 123140.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85177.2188; val_chrom_access_recon_loss: 3624599.3000; val_global_loss: 40906356.8000; val_optim_loss: 40906356.8000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9695; val_auprc_score: 0.9631; val_best_acc_score: 0.9165; val_best_f1_score: 0.9190; train_kl_reg_loss: 120740.2448; train_edge_recon_loss: 2756978.5897; train_gene_expr_recon_loss: 34384990.9771; train_masked_gp_l1_reg_loss: 123687.5881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83906.2241; train_chrom_access_recon_loss: 3619239.9714; train_global_loss: 41089543.4809; train_optim_loss: 41089543.4809; val_kl_reg_loss: 117500.4911; val_edge_recon_loss: 2758388.4833; val_gene_expr_recon_loss: 34230792.8000; val_masked_gp_l1_reg_loss: 124606.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82701.6016; val_chrom_access_recon_loss: 3630822.0500; val_global_loss: 40944811.2000; val_optim_loss: 40944811.2000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9639; val_auprc_score: 0.9546; val_best_acc_score: 0.9076; val_best_f1_score: 0.9109; train_kl_reg_loss: 137315.3513; train_edge_recon_loss: 2874483.5725; train_gene_expr_recon_loss: 36606351.7557; train_masked_gp_l1_reg_loss: 126398.0942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87829.3616; train_chrom_access_recon_loss: 3693981.3645; train_global_loss: 43526359.5115; train_optim_loss: 43526359.5115; val_kl_reg_loss: 45844.1857; val_edge_recon_loss: 2824374.5667; val_gene_expr_recon_loss: 36123302.6667; val_masked_gp_l1_reg_loss: 127247.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88764.7891; val_chrom_access_recon_loss: 3680864.0000; val_global_loss: 42890397.3333; val_optim_loss: 42890397.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9623; val_auprc_score: 0.9526; val_best_acc_score: 0.9035; val_best_f1_score: 0.9066; train_kl_reg_loss: 130801.9734; train_edge_recon_loss: 2817868.8073; train_gene_expr_recon_loss: 36453573.6794; train_masked_gp_l1_reg_loss: 127452.4339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88201.4484; train_chrom_access_recon_loss: 3726972.3282; train_global_loss: 43344870.9313; train_optim_loss: 43344870.9313; val_kl_reg_loss: 48585.6391; val_edge_recon_loss: 2832708.3833; val_gene_expr_recon_loss: 36321124.0000; val_masked_gp_l1_reg_loss: 127721.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88100.2656; val_chrom_access_recon_loss: 3748789.8000; val_global_loss: 43167028.2667; val_optim_loss: 43167028.2667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9624; val_auprc_score: 0.9517; val_best_acc_score: 0.9070; val_best_f1_score: 0.9097; train_kl_reg_loss: 122956.3586; train_edge_recon_loss: 2818242.9924; train_gene_expr_recon_loss: 36931923.2061; train_masked_gp_l1_reg_loss: 127897.4873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87648.7526; train_chrom_access_recon_loss: 3756140.7882; train_global_loss: 43844809.8626; train_optim_loss: 43844809.8626; val_kl_reg_loss: 44217.3721; val_edge_recon_loss: 2822320.6667; val_gene_expr_recon_loss: 37229363.2000; val_masked_gp_l1_reg_loss: 127976.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87127.3125; val_chrom_access_recon_loss: 3775267.6500; val_global_loss: 44086273.3333; val_optim_loss: 44086273.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9615; val_auprc_score: 0.9526; val_best_acc_score: 0.9019; val_best_f1_score: 0.9052; train_kl_reg_loss: 118552.5319; train_edge_recon_loss: 2812925.2996; train_gene_expr_recon_loss: 37491973.2214; train_masked_gp_l1_reg_loss: 127655.0725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86841.7637; train_chrom_access_recon_loss: 3767237.4027; train_global_loss: 44405185.5573; train_optim_loss: 44405185.5573; val_kl_reg_loss: 46465.6362; val_edge_recon_loss: 2808541.0833; val_gene_expr_recon_loss: 37326791.2000; val_masked_gp_l1_reg_loss: 127532.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86586.0312; val_chrom_access_recon_loss: 3765554.0000; val_global_loss: 44161471.7333; val_optim_loss: 44161471.7333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9615; val_auprc_score: 0.9500; val_best_acc_score: 0.9019; val_best_f1_score: 0.9048; train_kl_reg_loss: 119672.6007; train_edge_recon_loss: 2806642.9561; train_gene_expr_recon_loss: 37602429.2214; train_masked_gp_l1_reg_loss: 127417.1093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86356.0282; train_chrom_access_recon_loss: 3768448.2691; train_global_loss: 44510966.1069; train_optim_loss: 44510966.1069; val_kl_reg_loss: 47450.0461; val_edge_recon_loss: 2794430.6167; val_gene_expr_recon_loss: 37398743.7333; val_masked_gp_l1_reg_loss: 127288.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86102.5156; val_chrom_access_recon_loss: 3769888.7500; val_global_loss: 44223905.0667; val_optim_loss: 44223905.0667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9636; val_auprc_score: 0.9538; val_best_acc_score: 0.9073; val_best_f1_score: 0.9109; train_kl_reg_loss: 118782.6468; train_edge_recon_loss: 2798857.5057; train_gene_expr_recon_loss: 37621520.6107; train_masked_gp_l1_reg_loss: 127133.4886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85836.1497; train_chrom_access_recon_loss: 3770079.3263; train_global_loss: 44522209.8015; train_optim_loss: 44522209.8015; val_kl_reg_loss: 45259.7341; val_edge_recon_loss: 2788609.8667; val_gene_expr_recon_loss: 37353948.2667; val_masked_gp_l1_reg_loss: 126970.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85548.2578; val_chrom_access_recon_loss: 3761496.8667; val_global_loss: 44161834.4000; val_optim_loss: 44161834.4000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9566; val_auprc_score: 0.9454; val_best_acc_score: 0.8998; val_best_f1_score: 0.9033; train_kl_reg_loss: 117169.5492; train_edge_recon_loss: 2800902.2767; train_gene_expr_recon_loss: 37636854.3511; train_masked_gp_l1_reg_loss: 126797.8096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85273.8325; train_chrom_access_recon_loss: 3763495.6679; train_global_loss: 44530493.3130; train_optim_loss: 44530493.3130; val_kl_reg_loss: 45036.4073; val_edge_recon_loss: 2821713.7667; val_gene_expr_recon_loss: 37433843.7333; val_masked_gp_l1_reg_loss: 126618.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84999.9375; val_chrom_access_recon_loss: 3772985.0667; val_global_loss: 44285199.4667; val_optim_loss: 44285199.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 34 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9638
val AUPRC score: 0.9523
val best accuracy score: 0.9086
val best F1 score: 0.9109
val target rna MSE score: 1.1447
val source rna MSE score: 542.6634
val target atac MSE score: 0.5793
val source atac MSE score: 5.1982
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
