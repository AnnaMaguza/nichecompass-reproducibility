[True]
Run timestamp: 10082023_134053_1008.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1008']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7315; val_auprc_score: 0.7639; val_best_acc_score: 0.5015; val_best_f1_score: 0.6672; train_kl_reg_loss: 82248.4215; train_edge_recon_loss: 3592348.2176; train_gene_expr_recon_loss: 14619961.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 2215849.0553; train_global_loss: 20510407.1450; train_optim_loss: 20510407.1450; val_kl_reg_loss: 136888.6000; val_edge_recon_loss: 4065145.0167; val_gene_expr_recon_loss: 12740818.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 2058430.9167; val_global_loss: 19001283.0667; val_optim_loss: 19001283.0667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8109; val_auprc_score: 0.8231; val_best_acc_score: 0.7193; val_best_f1_score: 0.7372; train_kl_reg_loss: 115396.2869; train_edge_recon_loss: 3531461.5744; train_gene_expr_recon_loss: 12665429.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 2079784.1212; train_global_loss: 18392071.7557; train_optim_loss: 18392071.7557; val_kl_reg_loss: 121057.4625; val_edge_recon_loss: 4038207.1333; val_gene_expr_recon_loss: 12348241.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 2018011.4667; val_global_loss: 18525517.6000; val_optim_loss: 18525517.6000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8493; val_auprc_score: 0.8536; val_best_acc_score: 0.7657; val_best_f1_score: 0.7711; train_kl_reg_loss: 91766.5982; train_edge_recon_loss: 3454233.6947; train_gene_expr_recon_loss: 12435561.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 2051921.4742; train_global_loss: 18033483.6947; train_optim_loss: 18033483.6947; val_kl_reg_loss: 79250.3344; val_edge_recon_loss: 3299465.9667; val_gene_expr_recon_loss: 12255092.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1999888.6083; val_global_loss: 17633697.2000; val_optim_loss: 17633697.2000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9040; val_auprc_score: 0.8942; val_best_acc_score: 0.8277; val_best_f1_score: 0.8392; train_kl_reg_loss: 97550.5490; train_edge_recon_loss: 3054431.9294; train_gene_expr_recon_loss: 12302993.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 2030345.0067; train_global_loss: 17485320.8473; train_optim_loss: 17485320.8473; val_kl_reg_loss: 110271.3786; val_edge_recon_loss: 2926263.4333; val_gene_expr_recon_loss: 12100433.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1982050.8917; val_global_loss: 17119019.5333; val_optim_loss: 17119019.5333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9180; val_auprc_score: 0.9047; val_best_acc_score: 0.8502; val_best_f1_score: 0.8601; train_kl_reg_loss: 112751.8764; train_edge_recon_loss: 2871538.9828; train_gene_expr_recon_loss: 12170510.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 2010933.1870; train_global_loss: 17165734.4733; train_optim_loss: 17165734.4733; val_kl_reg_loss: 116865.4125; val_edge_recon_loss: 2861692.7833; val_gene_expr_recon_loss: 11926062.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1958042.1500; val_global_loss: 16862663.0667; val_optim_loss: 16862663.0667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9296; val_auprc_score: 0.9151; val_best_acc_score: 0.8638; val_best_f1_score: 0.8712; train_kl_reg_loss: 112871.6258; train_edge_recon_loss: 2824435.4733; train_gene_expr_recon_loss: 12041162.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1989101.3263; train_global_loss: 16967570.6031; train_optim_loss: 16967570.6031; val_kl_reg_loss: 110491.6859; val_edge_recon_loss: 2826920.9167; val_gene_expr_recon_loss: 11859881.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1943734.9833; val_global_loss: 16741029.4000; val_optim_loss: 16741029.4000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9300; val_auprc_score: 0.9171; val_best_acc_score: 0.8655; val_best_f1_score: 0.8740; train_kl_reg_loss: 105858.3043; train_edge_recon_loss: 2813723.5496; train_gene_expr_recon_loss: 11925339.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1971489.3082; train_global_loss: 16816411.0000; train_optim_loss: 16816411.0000; val_kl_reg_loss: 104081.8411; val_edge_recon_loss: 2845010.9333; val_gene_expr_recon_loss: 11750899.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1930616.5583; val_global_loss: 16630608.6667; val_optim_loss: 16630608.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9323; val_auprc_score: 0.9193; val_best_acc_score: 0.8641; val_best_f1_score: 0.8735; train_kl_reg_loss: 99834.5577; train_edge_recon_loss: 2801866.0916; train_gene_expr_recon_loss: 11846363.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1959153.3216; train_global_loss: 16707217.1298; train_optim_loss: 16707217.1298; val_kl_reg_loss: 99023.6042; val_edge_recon_loss: 2814116.1667; val_gene_expr_recon_loss: 11641830.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1915689.9333; val_global_loss: 16470660.3333; val_optim_loss: 16470660.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9403; val_auprc_score: 0.9273; val_best_acc_score: 0.8755; val_best_f1_score: 0.8798; train_kl_reg_loss: 96412.8952; train_edge_recon_loss: 2797019.8473; train_gene_expr_recon_loss: 11758597.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1945175.8101; train_global_loss: 16597205.7099; train_optim_loss: 16597205.7099; val_kl_reg_loss: 94004.0562; val_edge_recon_loss: 2779966.0167; val_gene_expr_recon_loss: 11569068.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1897652.6417; val_global_loss: 16340690.8667; val_optim_loss: 16340690.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9387; val_auprc_score: 0.9251; val_best_acc_score: 0.8743; val_best_f1_score: 0.8821; train_kl_reg_loss: 91901.1763; train_edge_recon_loss: 2793413.8073; train_gene_expr_recon_loss: 11681950.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1932424.0620; train_global_loss: 16499689.3664; train_optim_loss: 16499689.3664; val_kl_reg_loss: 94274.8854; val_edge_recon_loss: 2792262.5833; val_gene_expr_recon_loss: 11536026.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1886334.1583; val_global_loss: 16308897.8667; val_optim_loss: 16308897.8667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9417; val_auprc_score: 0.9296; val_best_acc_score: 0.8797; val_best_f1_score: 0.8851; train_kl_reg_loss: 90089.1042; train_edge_recon_loss: 2771071.0191; train_gene_expr_recon_loss: 11621065.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1921424.8435; train_global_loss: 16403650.0534; train_optim_loss: 16403650.0534; val_kl_reg_loss: 88669.7776; val_edge_recon_loss: 2791840.6000; val_gene_expr_recon_loss: 11406795.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1874137.7333; val_global_loss: 16161443.5333; val_optim_loss: 16161443.5333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9431; val_auprc_score: 0.9295; val_best_acc_score: 0.8817; val_best_f1_score: 0.8876; train_kl_reg_loss: 85124.8101; train_edge_recon_loss: 2771057.1107; train_gene_expr_recon_loss: 11560532.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1909143.6679; train_global_loss: 16325857.6031; train_optim_loss: 16325857.6031; val_kl_reg_loss: 81837.8766; val_edge_recon_loss: 2775777.1667; val_gene_expr_recon_loss: 11372913.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1861338.5917; val_global_loss: 16091866.9333; val_optim_loss: 16091866.9333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9470; val_auprc_score: 0.9364; val_best_acc_score: 0.8828; val_best_f1_score: 0.8893; train_kl_reg_loss: 82586.4747; train_edge_recon_loss: 2756710.5210; train_gene_expr_recon_loss: 11519038.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1902654.1126; train_global_loss: 16260989.8321; train_optim_loss: 16260989.8321; val_kl_reg_loss: 80194.2427; val_edge_recon_loss: 2786027.5167; val_gene_expr_recon_loss: 11369408.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1860569.8833; val_global_loss: 16096200.0667; val_optim_loss: 16096200.0667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9490; val_auprc_score: 0.9377; val_best_acc_score: 0.8938; val_best_f1_score: 0.8967; train_kl_reg_loss: 80856.3300; train_edge_recon_loss: 2747509.0573; train_gene_expr_recon_loss: 11472062.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1893923.3769; train_global_loss: 16194351.7252; train_optim_loss: 16194351.7252; val_kl_reg_loss: 80855.3776; val_edge_recon_loss: 2753874.9333; val_gene_expr_recon_loss: 11339032.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1849030.1333; val_global_loss: 16022792.6667; val_optim_loss: 16022792.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9544; val_auprc_score: 0.9422; val_best_acc_score: 0.8987; val_best_f1_score: 0.9021; train_kl_reg_loss: 79827.6662; train_edge_recon_loss: 2736573.5076; train_gene_expr_recon_loss: 11431418.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1886399.6069; train_global_loss: 16134219.4427; train_optim_loss: 16134219.4427; val_kl_reg_loss: 75464.8281; val_edge_recon_loss: 2737998.9167; val_gene_expr_recon_loss: 11274787.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1848705.6833; val_global_loss: 15936956.4000; val_optim_loss: 15936956.4000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9538; val_auprc_score: 0.9419; val_best_acc_score: 0.8954; val_best_f1_score: 0.8997; train_kl_reg_loss: 76912.7845; train_edge_recon_loss: 2731377.9027; train_gene_expr_recon_loss: 11385459.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1878718.3731; train_global_loss: 16072468.7634; train_optim_loss: 16072468.7634; val_kl_reg_loss: 78213.2286; val_edge_recon_loss: 2746758.6333; val_gene_expr_recon_loss: 11291168.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1847477.6167; val_global_loss: 15963618.4000; val_optim_loss: 15963618.4000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9563; val_auprc_score: 0.9453; val_best_acc_score: 0.8989; val_best_f1_score: 0.9023; train_kl_reg_loss: 75931.4621; train_edge_recon_loss: 2730555.3111; train_gene_expr_recon_loss: 11355339.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1874848.3511; train_global_loss: 16036674.4885; train_optim_loss: 16036674.4885; val_kl_reg_loss: 75668.5297; val_edge_recon_loss: 2717683.7333; val_gene_expr_recon_loss: 11160592.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1824754.3417; val_global_loss: 15778699.4667; val_optim_loss: 15778699.4667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9584; val_auprc_score: 0.9502; val_best_acc_score: 0.9019; val_best_f1_score: 0.9041; train_kl_reg_loss: 74061.4258; train_edge_recon_loss: 2720816.9580; train_gene_expr_recon_loss: 11318336.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1867104.9809; train_global_loss: 15980319.7023; train_optim_loss: 15980319.7023; val_kl_reg_loss: 74842.8464; val_edge_recon_loss: 2731109.0000; val_gene_expr_recon_loss: 11179490.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1834595.4333; val_global_loss: 15820037.4000; val_optim_loss: 15820037.4000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9612; val_auprc_score: 0.9514; val_best_acc_score: 0.9035; val_best_f1_score: 0.9070; train_kl_reg_loss: 72569.0979; train_edge_recon_loss: 2703848.5763; train_gene_expr_recon_loss: 11285161.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1860565.0945; train_global_loss: 15922144.6107; train_optim_loss: 15922144.6107; val_kl_reg_loss: 71506.1896; val_edge_recon_loss: 2733207.9833; val_gene_expr_recon_loss: 11156866.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1824421.4583; val_global_loss: 15786002.4000; val_optim_loss: 15786002.4000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9581; val_auprc_score: 0.9461; val_best_acc_score: 0.9002; val_best_f1_score: 0.9036; train_kl_reg_loss: 71140.7986; train_edge_recon_loss: 2704387.2385; train_gene_expr_recon_loss: 11258384.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1857283.9132; train_global_loss: 15891196.0000; train_optim_loss: 15891196.0000; val_kl_reg_loss: 70112.8193; val_edge_recon_loss: 2724173.9833; val_gene_expr_recon_loss: 11109374.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1821850.2917; val_global_loss: 15725511.4667; val_optim_loss: 15725511.4667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9651; val_auprc_score: 0.9539; val_best_acc_score: 0.9068; val_best_f1_score: 0.9106; train_kl_reg_loss: 68556.3051; train_edge_recon_loss: 2702648.8321; train_gene_expr_recon_loss: 11229700.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1853421.8998; train_global_loss: 15854327.0992; train_optim_loss: 15854327.0992; val_kl_reg_loss: 70157.5255; val_edge_recon_loss: 2711683.5333; val_gene_expr_recon_loss: 11074286.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1815856.2333; val_global_loss: 15671983.3333; val_optim_loss: 15671983.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9684; val_auprc_score: 0.9589; val_best_acc_score: 0.9186; val_best_f1_score: 0.9214; train_kl_reg_loss: 68345.1140; train_edge_recon_loss: 2700791.8626; train_gene_expr_recon_loss: 11207346.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1850184.0210; train_global_loss: 15826667.3664; train_optim_loss: 15826667.3664; val_kl_reg_loss: 67164.0625; val_edge_recon_loss: 2698218.9500; val_gene_expr_recon_loss: 11061108.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1800825.8250; val_global_loss: 15627316.8667; val_optim_loss: 15627316.8667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9653; val_auprc_score: 0.9559; val_best_acc_score: 0.9104; val_best_f1_score: 0.9136; train_kl_reg_loss: 67112.9900; train_edge_recon_loss: 2691821.2939; train_gene_expr_recon_loss: 11190457.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1845441.2233; train_global_loss: 15794832.8244; train_optim_loss: 15794832.8244; val_kl_reg_loss: 66773.1599; val_edge_recon_loss: 2714301.6333; val_gene_expr_recon_loss: 11062477.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1808916.5917; val_global_loss: 15652468.5333; val_optim_loss: 15652468.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9699; val_auprc_score: 0.9611; val_best_acc_score: 0.9177; val_best_f1_score: 0.9196; train_kl_reg_loss: 66462.1552; train_edge_recon_loss: 2689433.3989; train_gene_expr_recon_loss: 11160119.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1841352.8712; train_global_loss: 15757368.3435; train_optim_loss: 15757368.3435; val_kl_reg_loss: 64916.2471; val_edge_recon_loss: 2709196.4333; val_gene_expr_recon_loss: 10993419.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1799740.4000; val_global_loss: 15567272.6667; val_optim_loss: 15567272.6667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9709; val_auprc_score: 0.9607; val_best_acc_score: 0.9197; val_best_f1_score: 0.9215; train_kl_reg_loss: 65159.4162; train_edge_recon_loss: 2686643.1374; train_gene_expr_recon_loss: 11139703.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1838232.2252; train_global_loss: 15729737.8015; train_optim_loss: 15729737.8015; val_kl_reg_loss: 64774.7716; val_edge_recon_loss: 2703820.2833; val_gene_expr_recon_loss: 11016893.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1808666.2583; val_global_loss: 15594154.8667; val_optim_loss: 15594154.8667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9726; val_auprc_score: 0.9641; val_best_acc_score: 0.9219; val_best_f1_score: 0.9235; train_kl_reg_loss: 73399.6546; train_edge_recon_loss: 2715896.9141; train_gene_expr_recon_loss: 11485070.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1888527.4895; train_global_loss: 16162894.1221; train_optim_loss: 16162894.1221; val_kl_reg_loss: 33881.9885; val_edge_recon_loss: 2700079.5500; val_gene_expr_recon_loss: 11337255.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1846674.8083; val_global_loss: 15917891.8667; val_optim_loss: 15917891.8667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9692; val_auprc_score: 0.9573; val_best_acc_score: 0.9208; val_best_f1_score: 0.9233; train_kl_reg_loss: 69366.1140; train_edge_recon_loss: 2696147.0706; train_gene_expr_recon_loss: 11473870.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1885827.6326; train_global_loss: 16125211.6489; train_optim_loss: 16125211.6489; val_kl_reg_loss: 31710.3214; val_edge_recon_loss: 2695540.1167; val_gene_expr_recon_loss: 11320336.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1840173.2750; val_global_loss: 15887759.7333; val_optim_loss: 15887759.7333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9676; val_auprc_score: 0.9584; val_best_acc_score: 0.9179; val_best_f1_score: 0.9201; train_kl_reg_loss: 67842.1069; train_edge_recon_loss: 2693701.4733; train_gene_expr_recon_loss: 11499410.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1887738.1403; train_global_loss: 16148692.4656; train_optim_loss: 16148692.4656; val_kl_reg_loss: 27782.3339; val_edge_recon_loss: 2700802.3167; val_gene_expr_recon_loss: 11421414.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1854608.3750; val_global_loss: 16004607.5333; val_optim_loss: 16004607.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9697; val_auprc_score: 0.9623; val_best_acc_score: 0.9167; val_best_f1_score: 0.9203; train_kl_reg_loss: 65950.4507; train_edge_recon_loss: 2689748.4676; train_gene_expr_recon_loss: 11550279.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1891542.8511; train_global_loss: 16197521.6412; train_optim_loss: 16197521.6412; val_kl_reg_loss: 28163.1923; val_edge_recon_loss: 2703350.2000; val_gene_expr_recon_loss: 11397125.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1853084.7833; val_global_loss: 15981724.0667; val_optim_loss: 15981724.0667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9710; val_auprc_score: 0.9630; val_best_acc_score: 0.9202; val_best_f1_score: 0.9233; train_kl_reg_loss: 65740.9197; train_edge_recon_loss: 2687199.7366; train_gene_expr_recon_loss: 11548438.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1891618.6441; train_global_loss: 16192997.8015; train_optim_loss: 16192997.8015; val_kl_reg_loss: 28383.7609; val_edge_recon_loss: 2702026.9000; val_gene_expr_recon_loss: 11458394.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1859393.2417; val_global_loss: 16048198.4667; val_optim_loss: 16048198.4667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9691; val_auprc_score: 0.9592; val_best_acc_score: 0.9182; val_best_f1_score: 0.9209; train_kl_reg_loss: 61594.7869; train_edge_recon_loss: 2699592.8855; train_gene_expr_recon_loss: 11540605.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1888534.3807; train_global_loss: 16190327.3893; train_optim_loss: 16190327.3893; val_kl_reg_loss: 27391.0379; val_edge_recon_loss: 2718101.6000; val_gene_expr_recon_loss: 11393894.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1861888.4000; val_global_loss: 16001276.0667; val_optim_loss: 16001276.0667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9719; val_auprc_score: 0.9634; val_best_acc_score: 0.9251; val_best_f1_score: 0.9277; train_kl_reg_loss: 61035.4486; train_edge_recon_loss: 2679489.0401; train_gene_expr_recon_loss: 11535129.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1890981.5926; train_global_loss: 16166635.5878; train_optim_loss: 16166635.5878; val_kl_reg_loss: 28621.6283; val_edge_recon_loss: 2682276.1333; val_gene_expr_recon_loss: 11391421.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1850917.7333; val_global_loss: 15953237.2000; val_optim_loss: 15953237.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 48 min 24 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9682
val AUPRC score: 0.9594
val best accuracy score: 0.9151
val best F1 score: 0.9183
val target rna MSE score: 1.1368
val source rna MSE score: 0.8861
val target atac MSE score: 0.5430
val source atac MSE score: 0.1355
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
