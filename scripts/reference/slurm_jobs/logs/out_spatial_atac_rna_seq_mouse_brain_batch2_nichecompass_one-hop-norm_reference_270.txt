[True]
Run timestamp: 10102023_125304_270.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_270']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7633; val_auprc_score: 0.7744; val_best_acc_score: 0.5306; val_best_f1_score: 0.6795; train_kl_reg_loss: 51414.4697; train_edge_recon_loss: 736861.1178; train_gene_expr_recon_loss: 22311154.5191; train_masked_gp_l1_reg_loss: 131265.1100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3447139.4542; train_chrom_access_recon_loss: 11203582.1908; train_global_loss: 37881417.0229; train_optim_loss: 37881417.0229; val_kl_reg_loss: 76129.5495; val_edge_recon_loss: 812684.2125; val_gene_expr_recon_loss: 20842376.8000; val_masked_gp_l1_reg_loss: 108862.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 927501.9375; val_chrom_access_recon_loss: 10770890.4667; val_global_loss: 33538445.3333; val_optim_loss: 33538445.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8323; val_auprc_score: 0.8418; val_best_acc_score: 0.6407; val_best_f1_score: 0.7285; train_kl_reg_loss: 70799.1332; train_edge_recon_loss: 734504.1412; train_gene_expr_recon_loss: 20905778.0305; train_masked_gp_l1_reg_loss: 104673.9745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 476225.3538; train_chrom_access_recon_loss: 10797713.0305; train_global_loss: 33089693.7557; train_optim_loss: 33089693.7557; val_kl_reg_loss: 71532.2625; val_edge_recon_loss: 811356.5750; val_gene_expr_recon_loss: 20587078.4000; val_masked_gp_l1_reg_loss: 102894.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 258730.5312; val_chrom_access_recon_loss: 10687651.0667; val_global_loss: 32519242.4000; val_optim_loss: 32519242.4000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8992; val_auprc_score: 0.8942; val_best_acc_score: 0.8203; val_best_f1_score: 0.8223; train_kl_reg_loss: 64536.0931; train_edge_recon_loss: 726838.0644; train_gene_expr_recon_loss: 20604257.9084; train_masked_gp_l1_reg_loss: 103295.4364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 196416.4115; train_chrom_access_recon_loss: 10648409.3588; train_global_loss: 32343753.2672; train_optim_loss: 32343753.2672; val_kl_reg_loss: 59629.1570; val_edge_recon_loss: 799485.4667; val_gene_expr_recon_loss: 20266071.6000; val_masked_gp_l1_reg_loss: 104196.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158603.8750; val_chrom_access_recon_loss: 10513058.7333; val_global_loss: 31901044.4000; val_optim_loss: 31901044.4000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9029; val_auprc_score: 0.8933; val_best_acc_score: 0.8164; val_best_f1_score: 0.8317; train_kl_reg_loss: 59215.1009; train_edge_recon_loss: 717665.8836; train_gene_expr_recon_loss: 20400015.4504; train_masked_gp_l1_reg_loss: 106005.4623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146140.1041; train_chrom_access_recon_loss: 10545515.6412; train_global_loss: 31974557.6336; train_optim_loss: 31974557.6336; val_kl_reg_loss: 57720.1516; val_edge_recon_loss: 758774.7833; val_gene_expr_recon_loss: 19994288.5333; val_masked_gp_l1_reg_loss: 108342.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137735.5469; val_chrom_access_recon_loss: 10428497.6667; val_global_loss: 31485358.9333; val_optim_loss: 31485358.9333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8893; val_auprc_score: 0.8741; val_best_acc_score: 0.8056; val_best_f1_score: 0.8209; train_kl_reg_loss: 58055.5203; train_edge_recon_loss: 679396.2882; train_gene_expr_recon_loss: 20182163.3893; train_masked_gp_l1_reg_loss: 110310.7322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133379.3567; train_chrom_access_recon_loss: 10448101.5802; train_global_loss: 31611406.9313; train_optim_loss: 31611406.9313; val_kl_reg_loss: 63557.8909; val_edge_recon_loss: 652032.0583; val_gene_expr_recon_loss: 19867114.5333; val_masked_gp_l1_reg_loss: 111679.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127088.5781; val_chrom_access_recon_loss: 10284751.2000; val_global_loss: 31106223.4667; val_optim_loss: 31106223.4667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8956; val_auprc_score: 0.8824; val_best_acc_score: 0.8088; val_best_f1_score: 0.8272; train_kl_reg_loss: 68221.4008; train_edge_recon_loss: 637753.7948; train_gene_expr_recon_loss: 20017819.7557; train_masked_gp_l1_reg_loss: 113435.4802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121861.4888; train_chrom_access_recon_loss: 10374195.6183; train_global_loss: 31333287.6031; train_optim_loss: 31333287.6031; val_kl_reg_loss: 67707.6661; val_edge_recon_loss: 636782.5083; val_gene_expr_recon_loss: 19733061.2000; val_masked_gp_l1_reg_loss: 114531.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116252.8672; val_chrom_access_recon_loss: 10295778.6667; val_global_loss: 30964114.2667; val_optim_loss: 30964114.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9023; val_auprc_score: 0.8924; val_best_acc_score: 0.8115; val_best_f1_score: 0.8313; train_kl_reg_loss: 69651.1369; train_edge_recon_loss: 624314.1159; train_gene_expr_recon_loss: 19877865.6794; train_masked_gp_l1_reg_loss: 115310.3206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112269.4956; train_chrom_access_recon_loss: 10299354.7252; train_global_loss: 31098765.4962; train_optim_loss: 31098765.4962; val_kl_reg_loss: 69496.0792; val_edge_recon_loss: 619069.9083; val_gene_expr_recon_loss: 19665704.8000; val_masked_gp_l1_reg_loss: 115912.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109193.2344; val_chrom_access_recon_loss: 10189706.2667; val_global_loss: 30769082.9333; val_optim_loss: 30769082.9333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9151; val_auprc_score: 0.9041; val_best_acc_score: 0.8302; val_best_f1_score: 0.8408; train_kl_reg_loss: 69034.6067; train_edge_recon_loss: 618882.4599; train_gene_expr_recon_loss: 19750795.0076; train_masked_gp_l1_reg_loss: 116735.0238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106455.1815; train_chrom_access_recon_loss: 10226400.2443; train_global_loss: 30888302.4733; train_optim_loss: 30888302.4733; val_kl_reg_loss: 68520.1490; val_edge_recon_loss: 612761.1375; val_gene_expr_recon_loss: 19443810.1333; val_masked_gp_l1_reg_loss: 117143.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105020.2500; val_chrom_access_recon_loss: 10093915.2667; val_global_loss: 30441170.6667; val_optim_loss: 30441170.6667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9216; val_auprc_score: 0.9131; val_best_acc_score: 0.8378; val_best_f1_score: 0.8476; train_kl_reg_loss: 68011.7422; train_edge_recon_loss: 614441.4141; train_gene_expr_recon_loss: 19644253.8168; train_masked_gp_l1_reg_loss: 117640.5888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103159.9986; train_chrom_access_recon_loss: 10177528.2901; train_global_loss: 30725035.8168; train_optim_loss: 30725035.8168; val_kl_reg_loss: 67762.7276; val_edge_recon_loss: 612758.8542; val_gene_expr_recon_loss: 19434401.4667; val_masked_gp_l1_reg_loss: 118532.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102815.0469; val_chrom_access_recon_loss: 10072607.2667; val_global_loss: 30408878.4000; val_optim_loss: 30408878.4000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9280; val_auprc_score: 0.9183; val_best_acc_score: 0.8479; val_best_f1_score: 0.8588; train_kl_reg_loss: 67937.5161; train_edge_recon_loss: 609290.7667; train_gene_expr_recon_loss: 19545424.9771; train_masked_gp_l1_reg_loss: 118847.7694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101211.5967; train_chrom_access_recon_loss: 10129339.8015; train_global_loss: 30572052.2443; train_optim_loss: 30572052.2443; val_kl_reg_loss: 67981.4698; val_edge_recon_loss: 609889.9917; val_gene_expr_recon_loss: 19322908.9333; val_masked_gp_l1_reg_loss: 119149.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99581.7578; val_chrom_access_recon_loss: 10016890.4000; val_global_loss: 30236403.0667; val_optim_loss: 30236403.0667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9293; val_auprc_score: 0.9140; val_best_acc_score: 0.8513; val_best_f1_score: 0.8594; train_kl_reg_loss: 67346.8177; train_edge_recon_loss: 606535.0138; train_gene_expr_recon_loss: 19466572.8702; train_masked_gp_l1_reg_loss: 119543.3997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98750.2182; train_chrom_access_recon_loss: 10069783.5725; train_global_loss: 30428531.8779; train_optim_loss: 30428531.8779; val_kl_reg_loss: 65653.3378; val_edge_recon_loss: 606810.0458; val_gene_expr_recon_loss: 19210366.4000; val_masked_gp_l1_reg_loss: 120183.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98110.9922; val_chrom_access_recon_loss: 9953502.0667; val_global_loss: 30054626.0000; val_optim_loss: 30054626.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9424; val_auprc_score: 0.9313; val_best_acc_score: 0.8736; val_best_f1_score: 0.8776; train_kl_reg_loss: 67429.9339; train_edge_recon_loss: 603877.1908; train_gene_expr_recon_loss: 19396002.8397; train_masked_gp_l1_reg_loss: 120226.3449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96753.1728; train_chrom_access_recon_loss: 10022149.3511; train_global_loss: 30306438.7939; train_optim_loss: 30306438.7939; val_kl_reg_loss: 65222.0932; val_edge_recon_loss: 599379.2875; val_gene_expr_recon_loss: 19100912.9333; val_masked_gp_l1_reg_loss: 120576.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96441.5859; val_chrom_access_recon_loss: 9921361.8667; val_global_loss: 29903894.5333; val_optim_loss: 29903894.5333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9429; val_auprc_score: 0.9302; val_best_acc_score: 0.8742; val_best_f1_score: 0.8805; train_kl_reg_loss: 67146.9685; train_edge_recon_loss: 599963.8392; train_gene_expr_recon_loss: 19306072.4885; train_masked_gp_l1_reg_loss: 120766.1698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95009.3533; train_chrom_access_recon_loss: 9967666.7023; train_global_loss: 30156625.5115; train_optim_loss: 30156625.5115; val_kl_reg_loss: 67966.2547; val_edge_recon_loss: 601891.5792; val_gene_expr_recon_loss: 19076207.6000; val_masked_gp_l1_reg_loss: 121288.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94786.1641; val_chrom_access_recon_loss: 9903813.8667; val_global_loss: 29865953.0667; val_optim_loss: 29865953.0667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9466; val_auprc_score: 0.9340; val_best_acc_score: 0.8840; val_best_f1_score: 0.8882; train_kl_reg_loss: 66837.7897; train_edge_recon_loss: 598271.7185; train_gene_expr_recon_loss: 19225186.5649; train_masked_gp_l1_reg_loss: 121473.2548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93708.9793; train_chrom_access_recon_loss: 9913340.9389; train_global_loss: 30018819.2519; train_optim_loss: 30018819.2519; val_kl_reg_loss: 67893.4526; val_edge_recon_loss: 600396.5708; val_gene_expr_recon_loss: 19013328.5333; val_masked_gp_l1_reg_loss: 121691.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92824.8047; val_chrom_access_recon_loss: 9802727.6667; val_global_loss: 29698862.4000; val_optim_loss: 29698862.4000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9497; val_auprc_score: 0.9373; val_best_acc_score: 0.8880; val_best_f1_score: 0.8923; train_kl_reg_loss: 66709.4668; train_edge_recon_loss: 596579.2018; train_gene_expr_recon_loss: 19179557.4046; train_masked_gp_l1_reg_loss: 122009.1891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92349.7829; train_chrom_access_recon_loss: 9872382.4198; train_global_loss: 29929587.3588; train_optim_loss: 29929587.3588; val_kl_reg_loss: 67301.0440; val_edge_recon_loss: 597544.8417; val_gene_expr_recon_loss: 18937625.6000; val_masked_gp_l1_reg_loss: 122610.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92171.9922; val_chrom_access_recon_loss: 9768682.2667; val_global_loss: 29585935.7333; val_optim_loss: 29585935.7333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9521; val_auprc_score: 0.9413; val_best_acc_score: 0.8874; val_best_f1_score: 0.8929; train_kl_reg_loss: 66588.2256; train_edge_recon_loss: 593512.7934; train_gene_expr_recon_loss: 19121796.5038; train_masked_gp_l1_reg_loss: 122849.5849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91559.8587; train_chrom_access_recon_loss: 9825491.3969; train_global_loss: 29821798.3359; train_optim_loss: 29821798.3359; val_kl_reg_loss: 66297.9698; val_edge_recon_loss: 597758.4792; val_gene_expr_recon_loss: 18937265.6000; val_masked_gp_l1_reg_loss: 123443.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90650.3750; val_chrom_access_recon_loss: 9759369.7333; val_global_loss: 29574785.7333; val_optim_loss: 29574785.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9569; val_auprc_score: 0.9462; val_best_acc_score: 0.8946; val_best_f1_score: 0.8999; train_kl_reg_loss: 66374.2177; train_edge_recon_loss: 593201.4623; train_gene_expr_recon_loss: 19052163.0229; train_masked_gp_l1_reg_loss: 123468.1908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90400.7264; train_chrom_access_recon_loss: 9770723.0229; train_global_loss: 29696330.5649; train_optim_loss: 29696330.5649; val_kl_reg_loss: 64687.8500; val_edge_recon_loss: 591494.0083; val_gene_expr_recon_loss: 18866703.7333; val_masked_gp_l1_reg_loss: 124345.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90442.0156; val_chrom_access_recon_loss: 9700174.6000; val_global_loss: 29437848.2667; val_optim_loss: 29437848.2667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9525; val_auprc_score: 0.9367; val_best_acc_score: 0.8901; val_best_f1_score: 0.8950; train_kl_reg_loss: 65881.5334; train_edge_recon_loss: 594103.5472; train_gene_expr_recon_loss: 19013496.0916; train_masked_gp_l1_reg_loss: 124496.0704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89882.5083; train_chrom_access_recon_loss: 9732846.4046; train_global_loss: 29620706.0763; train_optim_loss: 29620706.0763; val_kl_reg_loss: 64589.2089; val_edge_recon_loss: 596141.4000; val_gene_expr_recon_loss: 18852303.0667; val_masked_gp_l1_reg_loss: 124523.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89844.9375; val_chrom_access_recon_loss: 9701055.1333; val_global_loss: 29428457.0667; val_optim_loss: 29428457.0667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9576; val_auprc_score: 0.9466; val_best_acc_score: 0.8985; val_best_f1_score: 0.9009; train_kl_reg_loss: 65770.9287; train_edge_recon_loss: 591973.7462; train_gene_expr_recon_loss: 18946975.2977; train_masked_gp_l1_reg_loss: 125053.4131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89375.1475; train_chrom_access_recon_loss: 9683292.9695; train_global_loss: 29502441.4198; train_optim_loss: 29502441.4198; val_kl_reg_loss: 65648.2312; val_edge_recon_loss: 597004.9292; val_gene_expr_recon_loss: 18784902.4000; val_masked_gp_l1_reg_loss: 125669.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89464.9062; val_chrom_access_recon_loss: 9632718.6667; val_global_loss: 29295407.8667; val_optim_loss: 29295407.8667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9607; val_auprc_score: 0.9505; val_best_acc_score: 0.9057; val_best_f1_score: 0.9082; train_kl_reg_loss: 65754.6774; train_edge_recon_loss: 592046.0706; train_gene_expr_recon_loss: 18905610.7939; train_masked_gp_l1_reg_loss: 125995.9424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88980.6703; train_chrom_access_recon_loss: 9656574.2748; train_global_loss: 29434962.3664; train_optim_loss: 29434962.3664; val_kl_reg_loss: 64945.2951; val_edge_recon_loss: 591651.3417; val_gene_expr_recon_loss: 18718377.6000; val_masked_gp_l1_reg_loss: 126813.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89815.7812; val_chrom_access_recon_loss: 9620200.8667; val_global_loss: 29211805.4667; val_optim_loss: 29211805.4667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9564; val_auprc_score: 0.9456; val_best_acc_score: 0.8992; val_best_f1_score: 0.9034; train_kl_reg_loss: 65516.6849; train_edge_recon_loss: 591967.3020; train_gene_expr_recon_loss: 18858115.7252; train_masked_gp_l1_reg_loss: 126979.7652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88719.5661; train_chrom_access_recon_loss: 9606203.7710; train_global_loss: 29337502.7634; train_optim_loss: 29337502.7634; val_kl_reg_loss: 65144.1776; val_edge_recon_loss: 592784.7792; val_gene_expr_recon_loss: 18672907.8667; val_masked_gp_l1_reg_loss: 127335.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89403.8125; val_chrom_access_recon_loss: 9610602.3333; val_global_loss: 29158178.9333; val_optim_loss: 29158178.9333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9603; val_auprc_score: 0.9516; val_best_acc_score: 0.9016; val_best_f1_score: 0.9049; train_kl_reg_loss: 65439.6880; train_edge_recon_loss: 592007.2896; train_gene_expr_recon_loss: 18836229.5878; train_masked_gp_l1_reg_loss: 128015.3017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88585.6963; train_chrom_access_recon_loss: 9582494.3206; train_global_loss: 29292771.9695; train_optim_loss: 29292771.9695; val_kl_reg_loss: 64758.8349; val_edge_recon_loss: 591627.7375; val_gene_expr_recon_loss: 18659471.4667; val_masked_gp_l1_reg_loss: 128227.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88461.3359; val_chrom_access_recon_loss: 9552327.5333; val_global_loss: 29084875.6000; val_optim_loss: 29084875.6000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9584; val_auprc_score: 0.9480; val_best_acc_score: 0.9018; val_best_f1_score: 0.9066; train_kl_reg_loss: 65527.4694; train_edge_recon_loss: 590204.5272; train_gene_expr_recon_loss: 18752804.3206; train_masked_gp_l1_reg_loss: 128623.0068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87998.9456; train_chrom_access_recon_loss: 9523690.4504; train_global_loss: 29148848.5191; train_optim_loss: 29148848.5191; val_kl_reg_loss: 64798.0464; val_edge_recon_loss: 594424.6833; val_gene_expr_recon_loss: 18601360.8000; val_masked_gp_l1_reg_loss: 129088.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87773.1641; val_chrom_access_recon_loss: 9530099.9333; val_global_loss: 29007545.7333; val_optim_loss: 29007545.7333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9568; val_auprc_score: 0.9452; val_best_acc_score: 0.8988; val_best_f1_score: 0.9019; train_kl_reg_loss: 65924.2313; train_edge_recon_loss: 589489.7462; train_gene_expr_recon_loss: 18713269.4962; train_masked_gp_l1_reg_loss: 129351.4512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87855.0370; train_chrom_access_recon_loss: 9477512.4237; train_global_loss: 29063402.3817; train_optim_loss: 29063402.3817; val_kl_reg_loss: 65306.0148; val_edge_recon_loss: 592889.0458; val_gene_expr_recon_loss: 18598478.9333; val_masked_gp_l1_reg_loss: 128993.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87735.7500; val_chrom_access_recon_loss: 9498815.3333; val_global_loss: 28972219.0667; val_optim_loss: 28972219.0667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9594; val_auprc_score: 0.9467; val_best_acc_score: 0.9047; val_best_f1_score: 0.9092; train_kl_reg_loss: 65912.8263; train_edge_recon_loss: 589444.5272; train_gene_expr_recon_loss: 18688246.0916; train_masked_gp_l1_reg_loss: 129750.8765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87646.0886; train_chrom_access_recon_loss: 9463685.3511; train_global_loss: 29024686.0153; train_optim_loss: 29024686.0153; val_kl_reg_loss: 65683.9711; val_edge_recon_loss: 591234.5958; val_gene_expr_recon_loss: 18597423.4667; val_masked_gp_l1_reg_loss: 130252.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88455.0234; val_chrom_access_recon_loss: 9468542.2667; val_global_loss: 28941592.0000; val_optim_loss: 28941592.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9436; val_auprc_score: 0.9306; val_best_acc_score: 0.8742; val_best_f1_score: 0.8818; train_kl_reg_loss: 58095.1461; train_edge_recon_loss: 652515.5434; train_gene_expr_recon_loss: 18022848.7557; train_masked_gp_l1_reg_loss: 128731.7208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80192.4057; train_chrom_access_recon_loss: 9408409.4351; train_global_loss: 28350793.0076; train_optim_loss: 28350793.0076; val_kl_reg_loss: 34853.9073; val_edge_recon_loss: 626979.2500; val_gene_expr_recon_loss: 17731816.2667; val_masked_gp_l1_reg_loss: 126080.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79174.2188; val_chrom_access_recon_loss: 9277425.4000; val_global_loss: 27876328.5333; val_optim_loss: 27876328.5333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9429; val_auprc_score: 0.9259; val_best_acc_score: 0.8770; val_best_f1_score: 0.8840; train_kl_reg_loss: 57623.6170; train_edge_recon_loss: 611913.1536; train_gene_expr_recon_loss: 17901500.1603; train_masked_gp_l1_reg_loss: 123659.3793; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77932.3968; train_chrom_access_recon_loss: 9352952.8092; train_global_loss: 28125581.4351; train_optim_loss: 28125581.4351; val_kl_reg_loss: 43709.2865; val_edge_recon_loss: 607052.3167; val_gene_expr_recon_loss: 17790909.4667; val_masked_gp_l1_reg_loss: 121383.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76675.6250; val_chrom_access_recon_loss: 9296443.1333; val_global_loss: 27936174.1333; val_optim_loss: 27936174.1333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9503; val_auprc_score: 0.9376; val_best_acc_score: 0.8856; val_best_f1_score: 0.8906; train_kl_reg_loss: 57774.5872; train_edge_recon_loss: 601742.3039; train_gene_expr_recon_loss: 17859162.5420; train_masked_gp_l1_reg_loss: 119760.9281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76591.1596; train_chrom_access_recon_loss: 9327623.3435; train_global_loss: 28042654.9313; train_optim_loss: 28042654.9313; val_kl_reg_loss: 47224.1414; val_edge_recon_loss: 600872.3083; val_gene_expr_recon_loss: 17770620.5333; val_masked_gp_l1_reg_loss: 118512.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76062.2578; val_chrom_access_recon_loss: 9294301.3333; val_global_loss: 27907592.2667; val_optim_loss: 27907592.2667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9448; val_auprc_score: 0.9309; val_best_acc_score: 0.8853; val_best_f1_score: 0.8900; train_kl_reg_loss: 58407.4706; train_edge_recon_loss: 595641.1784; train_gene_expr_recon_loss: 17844883.1298; train_masked_gp_l1_reg_loss: 117221.0683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75813.9351; train_chrom_access_recon_loss: 9317121.2901; train_global_loss: 28009088.2290; train_optim_loss: 28009088.2290; val_kl_reg_loss: 50309.1990; val_edge_recon_loss: 598029.6833; val_gene_expr_recon_loss: 17679253.2000; val_masked_gp_l1_reg_loss: 116539.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76156.3359; val_chrom_access_recon_loss: 9272782.4667; val_global_loss: 27793070.5333; val_optim_loss: 27793070.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9489; val_auprc_score: 0.9355; val_best_acc_score: 0.8860; val_best_f1_score: 0.8907; train_kl_reg_loss: 57759.5746; train_edge_recon_loss: 590976.4280; train_gene_expr_recon_loss: 17793320.5496; train_masked_gp_l1_reg_loss: 115898.9945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75795.9888; train_chrom_access_recon_loss: 9288517.4580; train_global_loss: 27922268.9618; train_optim_loss: 27922268.9618; val_kl_reg_loss: 50690.2940; val_edge_recon_loss: 593969.0000; val_gene_expr_recon_loss: 17642905.3333; val_masked_gp_l1_reg_loss: 115637.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75833.5547; val_chrom_access_recon_loss: 9226617.7333; val_global_loss: 27705654.5333; val_optim_loss: 27705654.5333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9464; val_auprc_score: 0.9282; val_best_acc_score: 0.8861; val_best_f1_score: 0.8907; train_kl_reg_loss: 60300.1614; train_edge_recon_loss: 596901.4656; train_gene_expr_recon_loss: 17856783.8855; train_masked_gp_l1_reg_loss: 114243.1820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75234.3826; train_chrom_access_recon_loss: 9300271.8550; train_global_loss: 28003735.0840; train_optim_loss: 28003735.0840; val_kl_reg_loss: 56780.3039; val_edge_recon_loss: 597522.7417; val_gene_expr_recon_loss: 17668023.1333; val_masked_gp_l1_reg_loss: 113060.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75138.3047; val_chrom_access_recon_loss: 9253271.3333; val_global_loss: 27763795.6000; val_optim_loss: 27763795.6000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9533; val_auprc_score: 0.9380; val_best_acc_score: 0.8998; val_best_f1_score: 0.9039; train_kl_reg_loss: 60701.0138; train_edge_recon_loss: 591681.7257; train_gene_expr_recon_loss: 17775559.5878; train_masked_gp_l1_reg_loss: 111682.6057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74220.8967; train_chrom_access_recon_loss: 9280761.6794; train_global_loss: 27894607.4962; train_optim_loss: 27894607.4962; val_kl_reg_loss: 81058.6964; val_edge_recon_loss: 591124.1917; val_gene_expr_recon_loss: 17626414.8000; val_masked_gp_l1_reg_loss: 111363.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73967.0391; val_chrom_access_recon_loss: 9201268.5333; val_global_loss: 27685198.1333; val_optim_loss: 27685198.1333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9548; val_auprc_score: 0.9425; val_best_acc_score: 0.8988; val_best_f1_score: 0.9011; train_kl_reg_loss: 61716.9559; train_edge_recon_loss: 588463.0258; train_gene_expr_recon_loss: 17743833.5038; train_masked_gp_l1_reg_loss: 110979.5245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74074.1392; train_chrom_access_recon_loss: 9272312.6183; train_global_loss: 27851379.9542; train_optim_loss: 27851379.9542; val_kl_reg_loss: 54710.8367; val_edge_recon_loss: 591248.2292; val_gene_expr_recon_loss: 17569780.0000; val_masked_gp_l1_reg_loss: 111010.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74049.5156; val_chrom_access_recon_loss: 9170832.6000; val_global_loss: 27571631.8667; val_optim_loss: 27571631.8667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9534; val_auprc_score: 0.9407; val_best_acc_score: 0.8928; val_best_f1_score: 0.8973; train_kl_reg_loss: 59986.6267; train_edge_recon_loss: 587178.6913; train_gene_expr_recon_loss: 17699626.9542; train_masked_gp_l1_reg_loss: 111059.0050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74149.6816; train_chrom_access_recon_loss: 9245704.1908; train_global_loss: 27777705.2672; train_optim_loss: 27777705.2672; val_kl_reg_loss: 55059.5458; val_edge_recon_loss: 594249.2208; val_gene_expr_recon_loss: 17518837.6000; val_masked_gp_l1_reg_loss: 111284.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74042.4453; val_chrom_access_recon_loss: 9191346.2667; val_global_loss: 27544818.9333; val_optim_loss: 27544818.9333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9561; val_auprc_score: 0.9427; val_best_acc_score: 0.9014; val_best_f1_score: 0.9051; train_kl_reg_loss: 65943.8972; train_edge_recon_loss: 593889.0930; train_gene_expr_recon_loss: 17834424.0687; train_masked_gp_l1_reg_loss: 110303.7911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73751.1364; train_chrom_access_recon_loss: 9271446.8321; train_global_loss: 27949758.8550; train_optim_loss: 27949758.8550; val_kl_reg_loss: 65226.2755; val_edge_recon_loss: 592432.7875; val_gene_expr_recon_loss: 17705926.5333; val_masked_gp_l1_reg_loss: 107490.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71789.3828; val_chrom_access_recon_loss: 9244574.1333; val_global_loss: 27787439.6000; val_optim_loss: 27787439.6000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9528; val_auprc_score: 0.9403; val_best_acc_score: 0.8969; val_best_f1_score: 0.9009; train_kl_reg_loss: 65707.7728; train_edge_recon_loss: 593177.7667; train_gene_expr_recon_loss: 17734461.9695; train_masked_gp_l1_reg_loss: 106885.0530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72101.3239; train_chrom_access_recon_loss: 9263288.9389; train_global_loss: 27835622.9313; train_optim_loss: 27835622.9313; val_kl_reg_loss: 60363.2589; val_edge_recon_loss: 589541.1208; val_gene_expr_recon_loss: 17562810.2667; val_masked_gp_l1_reg_loss: 106446.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72246.4375; val_chrom_access_recon_loss: 9165719.6000; val_global_loss: 27557126.1333; val_optim_loss: 27557126.1333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9445; val_auprc_score: 0.9284; val_best_acc_score: 0.8805; val_best_f1_score: 0.8869; train_kl_reg_loss: 63628.9359; train_edge_recon_loss: 607981.2319; train_gene_expr_recon_loss: 18046932.1374; train_masked_gp_l1_reg_loss: 105988.4677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73158.6387; train_chrom_access_recon_loss: 9339111.1908; train_global_loss: 28236800.6107; train_optim_loss: 28236800.6107; val_kl_reg_loss: 58158.9750; val_edge_recon_loss: 608650.4958; val_gene_expr_recon_loss: 17581869.0667; val_masked_gp_l1_reg_loss: 104322.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73266.7734; val_chrom_access_recon_loss: 9163799.2000; val_global_loss: 27590065.7333; val_optim_loss: 27590065.7333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9523; val_auprc_score: 0.9388; val_best_acc_score: 0.8965; val_best_f1_score: 0.9013; train_kl_reg_loss: 62979.9524; train_edge_recon_loss: 599114.2624; train_gene_expr_recon_loss: 17767365.9542; train_masked_gp_l1_reg_loss: 104106.9942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72503.7356; train_chrom_access_recon_loss: 9272842.3359; train_global_loss: 27878913.2977; train_optim_loss: 27878913.2977; val_kl_reg_loss: 59611.1326; val_edge_recon_loss: 591783.9167; val_gene_expr_recon_loss: 17590546.8667; val_masked_gp_l1_reg_loss: 103807.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72688.4297; val_chrom_access_recon_loss: 9215432.0000; val_global_loss: 27633869.6000; val_optim_loss: 27633869.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9483; val_auprc_score: 0.9335; val_best_acc_score: 0.8898; val_best_f1_score: 0.8954; train_kl_reg_loss: 64445.8520; train_edge_recon_loss: 592905.2910; train_gene_expr_recon_loss: 17709705.1298; train_masked_gp_l1_reg_loss: 99735.3901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58191.3566; train_chrom_access_recon_loss: 9235813.6603; train_global_loss: 27760796.6260; train_optim_loss: 27760796.6260; val_kl_reg_loss: 59847.1521; val_edge_recon_loss: 592146.4917; val_gene_expr_recon_loss: 17543139.8000; val_masked_gp_l1_reg_loss: 98740.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56181.6641; val_chrom_access_recon_loss: 9171426.9667; val_global_loss: 27521482.2667; val_optim_loss: 27521482.2667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9517; val_auprc_score: 0.9396; val_best_acc_score: 0.8933; val_best_f1_score: 0.8967; train_kl_reg_loss: 64806.2620; train_edge_recon_loss: 590257.9885; train_gene_expr_recon_loss: 17676729.6947; train_masked_gp_l1_reg_loss: 98518.2108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55798.0012; train_chrom_access_recon_loss: 9218476.9542; train_global_loss: 27704587.0840; train_optim_loss: 27704587.0840; val_kl_reg_loss: 60391.4865; val_edge_recon_loss: 594945.4625; val_gene_expr_recon_loss: 17582376.1333; val_masked_gp_l1_reg_loss: 98393.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55441.7500; val_chrom_access_recon_loss: 9204732.6667; val_global_loss: 27596281.8667; val_optim_loss: 27596281.8667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9468; val_auprc_score: 0.9293; val_best_acc_score: 0.8878; val_best_f1_score: 0.8940; train_kl_reg_loss: 65308.8333; train_edge_recon_loss: 590289.7638; train_gene_expr_recon_loss: 17672806.2748; train_masked_gp_l1_reg_loss: 98332.1633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55210.4228; train_chrom_access_recon_loss: 9213579.4046; train_global_loss: 27695526.7481; train_optim_loss: 27695526.7481; val_kl_reg_loss: 60759.7198; val_edge_recon_loss: 594982.7792; val_gene_expr_recon_loss: 17563772.8667; val_masked_gp_l1_reg_loss: 98305.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55025.7812; val_chrom_access_recon_loss: 9181959.1333; val_global_loss: 27554806.4000; val_optim_loss: 27554806.4000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9512; val_auprc_score: 0.9356; val_best_acc_score: 0.8942; val_best_f1_score: 0.8989; train_kl_reg_loss: 65685.1926; train_edge_recon_loss: 589731.2118; train_gene_expr_recon_loss: 17681359.6183; train_masked_gp_l1_reg_loss: 98224.5259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54807.4617; train_chrom_access_recon_loss: 9223052.5267; train_global_loss: 27712860.6107; train_optim_loss: 27712860.6107; val_kl_reg_loss: 60812.2318; val_edge_recon_loss: 593375.3583; val_gene_expr_recon_loss: 17508844.9333; val_masked_gp_l1_reg_loss: 98205.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54641.3203; val_chrom_access_recon_loss: 9134718.1333; val_global_loss: 27450598.6667; val_optim_loss: 27450598.6667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9487; val_auprc_score: 0.9327; val_best_acc_score: 0.8917; val_best_f1_score: 0.8965; train_kl_reg_loss: 65682.6926; train_edge_recon_loss: 588750.6780; train_gene_expr_recon_loss: 17675970.1679; train_masked_gp_l1_reg_loss: 98185.2870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54477.1429; train_chrom_access_recon_loss: 9208479.1527; train_global_loss: 27691545.1145; train_optim_loss: 27691545.1145; val_kl_reg_loss: 61101.0552; val_edge_recon_loss: 592391.2667; val_gene_expr_recon_loss: 17534127.6000; val_masked_gp_l1_reg_loss: 98147.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54306.4023; val_chrom_access_recon_loss: 9151037.5333; val_global_loss: 27491111.6000; val_optim_loss: 27491111.6000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9558; val_auprc_score: 0.9449; val_best_acc_score: 0.8967; val_best_f1_score: 0.9009; train_kl_reg_loss: 65836.6524; train_edge_recon_loss: 589774.8721; train_gene_expr_recon_loss: 17684055.3053; train_masked_gp_l1_reg_loss: 98126.0751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54147.1549; train_chrom_access_recon_loss: 9222860.8550; train_global_loss: 27714800.9924; train_optim_loss: 27714800.9924; val_kl_reg_loss: 61772.7107; val_edge_recon_loss: 594297.5667; val_gene_expr_recon_loss: 17528623.0667; val_masked_gp_l1_reg_loss: 98141.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54006.6484; val_chrom_access_recon_loss: 9178993.1667; val_global_loss: 27515834.4000; val_optim_loss: 27515834.4000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9476; val_auprc_score: 0.9323; val_best_acc_score: 0.8910; val_best_f1_score: 0.8961; train_kl_reg_loss: 65782.4312; train_edge_recon_loss: 588116.3731; train_gene_expr_recon_loss: 17683380.8855; train_masked_gp_l1_reg_loss: 98122.0652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53889.0400; train_chrom_access_recon_loss: 9220777.7863; train_global_loss: 27710068.5649; train_optim_loss: 27710068.5649; val_kl_reg_loss: 61084.4120; val_edge_recon_loss: 594054.2458; val_gene_expr_recon_loss: 17544333.0667; val_masked_gp_l1_reg_loss: 98088.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53682.0703; val_chrom_access_recon_loss: 9192430.0667; val_global_loss: 27543672.0000; val_optim_loss: 27543672.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9542; val_auprc_score: 0.9422; val_best_acc_score: 0.8959; val_best_f1_score: 0.8998; train_kl_reg_loss: 65763.9295; train_edge_recon_loss: 587420.7371; train_gene_expr_recon_loss: 17667804.4427; train_masked_gp_l1_reg_loss: 98087.4799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53591.4265; train_chrom_access_recon_loss: 9216097.8321; train_global_loss: 27688765.9084; train_optim_loss: 27688765.9084; val_kl_reg_loss: 61698.7005; val_edge_recon_loss: 591161.9583; val_gene_expr_recon_loss: 17543912.8000; val_masked_gp_l1_reg_loss: 98067.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53441.6719; val_chrom_access_recon_loss: 9221104.3333; val_global_loss: 27569388.0000; val_optim_loss: 27569388.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9546; val_auprc_score: 0.9407; val_best_acc_score: 0.8971; val_best_f1_score: 0.9011; train_kl_reg_loss: 65939.0911; train_edge_recon_loss: 589696.4504; train_gene_expr_recon_loss: 17660500.3206; train_masked_gp_l1_reg_loss: 97626.3695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51992.1076; train_chrom_access_recon_loss: 9211493.1832; train_global_loss: 27677247.6641; train_optim_loss: 27677247.6641; val_kl_reg_loss: 61861.1367; val_edge_recon_loss: 587802.8333; val_gene_expr_recon_loss: 17488130.0000; val_masked_gp_l1_reg_loss: 97471.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51801.6250; val_chrom_access_recon_loss: 9168019.6000; val_global_loss: 27455087.3333; val_optim_loss: 27455087.3333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9514; val_auprc_score: 0.9368; val_best_acc_score: 0.8909; val_best_f1_score: 0.8975; train_kl_reg_loss: 65995.4899; train_edge_recon_loss: 589820.9938; train_gene_expr_recon_loss: 17648876.5496; train_masked_gp_l1_reg_loss: 97425.9995; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51749.5129; train_chrom_access_recon_loss: 9213519.7099; train_global_loss: 27667388.0916; train_optim_loss: 27667388.0916; val_kl_reg_loss: 61839.3258; val_edge_recon_loss: 590014.3333; val_gene_expr_recon_loss: 17560728.6667; val_masked_gp_l1_reg_loss: 97388.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51705.2070; val_chrom_access_recon_loss: 9168949.9333; val_global_loss: 27530626.0000; val_optim_loss: 27530626.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9540; val_auprc_score: 0.9387; val_best_acc_score: 0.8999; val_best_f1_score: 0.9055; train_kl_reg_loss: 66048.3000; train_edge_recon_loss: 587479.3225; train_gene_expr_recon_loss: 17674296.7328; train_masked_gp_l1_reg_loss: 97372.2975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51671.5830; train_chrom_access_recon_loss: 9224175.5649; train_global_loss: 27701043.8015; train_optim_loss: 27701043.8015; val_kl_reg_loss: 61892.0940; val_edge_recon_loss: 586722.1958; val_gene_expr_recon_loss: 17512635.7333; val_masked_gp_l1_reg_loss: 97364.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51640.2070; val_chrom_access_recon_loss: 9166264.4667; val_global_loss: 27476518.2667; val_optim_loss: 27476518.2667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9535; val_auprc_score: 0.9426; val_best_acc_score: 0.8907; val_best_f1_score: 0.8952; train_kl_reg_loss: 66089.0783; train_edge_recon_loss: 588375.8135; train_gene_expr_recon_loss: 17658389.1679; train_masked_gp_l1_reg_loss: 97354.7434; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51603.7688; train_chrom_access_recon_loss: 9215047.7672; train_global_loss: 27676860.2443; train_optim_loss: 27676860.2443; val_kl_reg_loss: 62152.8443; val_edge_recon_loss: 590461.9208; val_gene_expr_recon_loss: 17549894.4000; val_masked_gp_l1_reg_loss: 97341.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51574.2266; val_chrom_access_recon_loss: 9150773.8000; val_global_loss: 27502199.0667; val_optim_loss: 27502199.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 48 min 32 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9528
val AUPRC score: 0.9410
val best accuracy score: 0.8942
val best F1 score: 0.8987
val target rna MSE score: 1.3254
val source rna MSE score: 0.6042
val target atac MSE score: 0.3398
val source atac MSE score: 0.1038
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
