[True]
Run timestamp: 07092023_051033_270.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_270']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3385 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7888, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3385
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3385

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6210; val_auprc_score: 0.6090; val_best_acc_score: 0.5016; val_best_f1_score: 0.6673; train_kl_reg_loss: 45677.0234; train_edge_recon_loss: 3575585.9053; train_gene_expr_recon_loss: 16967659.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1453602.5606; train_chrom_access_recon_loss: 15033784.9242; train_global_loss: 37076310.1212; train_optim_loss: 37076310.1212; val_kl_reg_loss: 33674.0667; val_edge_recon_loss: 4065285.6562; val_gene_expr_recon_loss: 15076459.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1091051.0000; val_chrom_access_recon_loss: 14193876.7500; val_global_loss: 34460347.0000; val_optim_loss: 34460347.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6624; val_auprc_score: 0.6539; val_best_acc_score: 0.5312; val_best_f1_score: 0.6772; train_kl_reg_loss: 93625.3067; train_edge_recon_loss: 3538824.3333; train_gene_expr_recon_loss: 14970602.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 785265.3153; train_chrom_access_recon_loss: 14181291.2121; train_global_loss: 33569608.4848; train_optim_loss: 33569608.4848; val_kl_reg_loss: 99642.1084; val_edge_recon_loss: 4063524.4688; val_gene_expr_recon_loss: 14568261.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 533326.5000; val_chrom_access_recon_loss: 13929945.1250; val_global_loss: 33194698.5000; val_optim_loss: 33194698.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6975; val_auprc_score: 0.6931; val_best_acc_score: 0.6158; val_best_f1_score: 0.6882; train_kl_reg_loss: 101940.8632; train_edge_recon_loss: 3525949.2462; train_gene_expr_recon_loss: 14619141.1212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 395678.7050; train_chrom_access_recon_loss: 14014835.3485; train_global_loss: 32657545.2727; train_optim_loss: 32657545.2727; val_kl_reg_loss: 98843.2305; val_edge_recon_loss: 4052397.3125; val_gene_expr_recon_loss: 14257314.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 290033.8438; val_chrom_access_recon_loss: 13745679.0000; val_global_loss: 32444268.0000; val_optim_loss: 32444268.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7732; val_auprc_score: 0.7552; val_best_acc_score: 0.6889; val_best_f1_score: 0.7187; train_kl_reg_loss: 94364.1882; train_edge_recon_loss: 3513184.1326; train_gene_expr_recon_loss: 14486187.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 231857.2235; train_chrom_access_recon_loss: 13937267.2424; train_global_loss: 32262860.4848; train_optim_loss: 32262860.4848; val_kl_reg_loss: 92579.5635; val_edge_recon_loss: 4002275.6250; val_gene_expr_recon_loss: 14340068.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 185290.9375; val_chrom_access_recon_loss: 13831144.6250; val_global_loss: 32451358.5000; val_optim_loss: 32451358.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8106; val_auprc_score: 0.7691; val_best_acc_score: 0.7493; val_best_f1_score: 0.7877; train_kl_reg_loss: 79881.8339; train_edge_recon_loss: 3477775.4962; train_gene_expr_recon_loss: 14375356.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157757.9593; train_chrom_access_recon_loss: 13813939.3030; train_global_loss: 31904710.8788; train_optim_loss: 31904710.8788; val_kl_reg_loss: 69053.2266; val_edge_recon_loss: 3661343.5625; val_gene_expr_recon_loss: 13989522.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134389.0312; val_chrom_access_recon_loss: 13558075.3750; val_global_loss: 31412385.2500; val_optim_loss: 31412385.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8255; val_auprc_score: 0.7790; val_best_acc_score: 0.7574; val_best_f1_score: 0.7964; train_kl_reg_loss: 72454.4938; train_edge_recon_loss: 3188612.9735; train_gene_expr_recon_loss: 14315948.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118975.5135; train_chrom_access_recon_loss: 13769398.0606; train_global_loss: 31465389.5152; train_optim_loss: 31465389.5152; val_kl_reg_loss: 89852.5264; val_edge_recon_loss: 3029545.6875; val_gene_expr_recon_loss: 14164953.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106113.4766; val_chrom_access_recon_loss: 13616214.2500; val_global_loss: 31006680.0000; val_optim_loss: 31006680.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8377; val_auprc_score: 0.7928; val_best_acc_score: 0.7590; val_best_f1_score: 0.7912; train_kl_reg_loss: 98034.8759; train_edge_recon_loss: 2990436.4205; train_gene_expr_recon_loss: 14231035.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95842.6545; train_chrom_access_recon_loss: 13709942.2879; train_global_loss: 31125291.9091; train_optim_loss: 31125291.9091; val_kl_reg_loss: 94565.4316; val_edge_recon_loss: 2982760.6250; val_gene_expr_recon_loss: 14029686.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86704.1406; val_chrom_access_recon_loss: 13579684.5000; val_global_loss: 30773401.7500; val_optim_loss: 30773401.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8521; val_auprc_score: 0.8115; val_best_acc_score: 0.7671; val_best_f1_score: 0.7944; train_kl_reg_loss: 102231.6396; train_edge_recon_loss: 2944164.4318; train_gene_expr_recon_loss: 14150579.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80136.7911; train_chrom_access_recon_loss: 13614469.6970; train_global_loss: 30891581.7879; train_optim_loss: 30891581.7879; val_kl_reg_loss: 100174.8301; val_edge_recon_loss: 2922362.9688; val_gene_expr_recon_loss: 13923733.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74466.1406; val_chrom_access_recon_loss: 13511450.1250; val_global_loss: 30532186.7500; val_optim_loss: 30532186.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8437; val_auprc_score: 0.7990; val_best_acc_score: 0.7684; val_best_f1_score: 0.7928; train_kl_reg_loss: 101269.5348; train_edge_recon_loss: 2941062.5417; train_gene_expr_recon_loss: 14090089.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70107.0495; train_chrom_access_recon_loss: 13572724.4394; train_global_loss: 30775253.4848; train_optim_loss: 30775253.4848; val_kl_reg_loss: 97496.6328; val_edge_recon_loss: 2979199.7188; val_gene_expr_recon_loss: 13934231.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66450.0469; val_chrom_access_recon_loss: 13505454.7500; val_global_loss: 30582833.0000; val_optim_loss: 30582833.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8562; val_auprc_score: 0.8129; val_best_acc_score: 0.7805; val_best_f1_score: 0.8023; train_kl_reg_loss: 98736.8260; train_edge_recon_loss: 2927348.0341; train_gene_expr_recon_loss: 14030732.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63278.8659; train_chrom_access_recon_loss: 13512739.2879; train_global_loss: 30632835.5758; train_optim_loss: 30632835.5758; val_kl_reg_loss: 95697.5186; val_edge_recon_loss: 2969895.2812; val_gene_expr_recon_loss: 13818605.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60867.5781; val_chrom_access_recon_loss: 13402380.0000; val_global_loss: 30347446.2500; val_optim_loss: 30347446.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8787; val_auprc_score: 0.8444; val_best_acc_score: 0.8025; val_best_f1_score: 0.8187; train_kl_reg_loss: 93982.2073; train_edge_recon_loss: 2902744.1780; train_gene_expr_recon_loss: 13971573.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58321.5882; train_chrom_access_recon_loss: 13452883.6970; train_global_loss: 30479504.6970; train_optim_loss: 30479504.6970; val_kl_reg_loss: 91547.5596; val_edge_recon_loss: 2917306.2188; val_gene_expr_recon_loss: 13935465.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56405.7500; val_chrom_access_recon_loss: 13430119.2500; val_global_loss: 30430844.2500; val_optim_loss: 30430844.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8879; val_auprc_score: 0.8540; val_best_acc_score: 0.8160; val_best_f1_score: 0.8312; train_kl_reg_loss: 91578.6304; train_edge_recon_loss: 2864957.7500; train_gene_expr_recon_loss: 13933095.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54779.8717; train_chrom_access_recon_loss: 13414942.6818; train_global_loss: 30359354.5455; train_optim_loss: 30359354.5455; val_kl_reg_loss: 88984.7305; val_edge_recon_loss: 2879680.0000; val_gene_expr_recon_loss: 13734382.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53375.8047; val_chrom_access_recon_loss: 13162874.8750; val_global_loss: 29919297.7500; val_optim_loss: 29919297.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8911; val_auprc_score: 0.8525; val_best_acc_score: 0.8272; val_best_f1_score: 0.8390; train_kl_reg_loss: 92026.3554; train_edge_recon_loss: 2851826.7576; train_gene_expr_recon_loss: 13886846.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51999.7088; train_chrom_access_recon_loss: 13363403.2424; train_global_loss: 30246102.5152; train_optim_loss: 30246102.5152; val_kl_reg_loss: 91765.5400; val_edge_recon_loss: 2869715.7812; val_gene_expr_recon_loss: 13737118.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50908.6289; val_chrom_access_recon_loss: 13181080.2500; val_global_loss: 29930588.2500; val_optim_loss: 29930588.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9011; val_auprc_score: 0.8659; val_best_acc_score: 0.8383; val_best_f1_score: 0.8517; train_kl_reg_loss: 92642.4741; train_edge_recon_loss: 2824278.6856; train_gene_expr_recon_loss: 13850143.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49812.2709; train_chrom_access_recon_loss: 13333943.9242; train_global_loss: 30150821.1212; train_optim_loss: 30150821.1212; val_kl_reg_loss: 89303.5518; val_edge_recon_loss: 2873969.0938; val_gene_expr_recon_loss: 13604478.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49058.7500; val_chrom_access_recon_loss: 13161859.0000; val_global_loss: 29778669.0000; val_optim_loss: 29778669.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9038; val_auprc_score: 0.8717; val_best_acc_score: 0.8409; val_best_f1_score: 0.8543; train_kl_reg_loss: 90051.6580; train_edge_recon_loss: 2809710.4621; train_gene_expr_recon_loss: 13797545.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48496.2943; train_chrom_access_recon_loss: 13279642.2424; train_global_loss: 30025445.6970; train_optim_loss: 30025445.6970; val_kl_reg_loss: 91692.3545; val_edge_recon_loss: 2839930.7188; val_gene_expr_recon_loss: 13661841.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47597.1484; val_chrom_access_recon_loss: 13168558.8750; val_global_loss: 29809620.5000; val_optim_loss: 29809620.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9030; val_auprc_score: 0.8653; val_best_acc_score: 0.8426; val_best_f1_score: 0.8543; train_kl_reg_loss: 89813.1836; train_edge_recon_loss: 2788904.1970; train_gene_expr_recon_loss: 13763475.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46985.6599; train_chrom_access_recon_loss: 13238420.1970; train_global_loss: 29927598.8182; train_optim_loss: 29927598.8182; val_kl_reg_loss: 90547.6680; val_edge_recon_loss: 2840199.0938; val_gene_expr_recon_loss: 13542985.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46565.4492; val_chrom_access_recon_loss: 13098937.3750; val_global_loss: 29619234.7500; val_optim_loss: 29619234.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9125; val_auprc_score: 0.8751; val_best_acc_score: 0.8514; val_best_f1_score: 0.8614; train_kl_reg_loss: 88482.3658; train_edge_recon_loss: 2791551.7992; train_gene_expr_recon_loss: 13733766.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46163.4113; train_chrom_access_recon_loss: 13201265.2121; train_global_loss: 29861229.4242; train_optim_loss: 29861229.4242; val_kl_reg_loss: 86574.4922; val_edge_recon_loss: 2787093.7188; val_gene_expr_recon_loss: 13553725.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45934.5898; val_chrom_access_recon_loss: 13080781.0000; val_global_loss: 29554109.5000; val_optim_loss: 29554109.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9108; val_auprc_score: 0.8774; val_best_acc_score: 0.8536; val_best_f1_score: 0.8644; train_kl_reg_loss: 86037.0102; train_edge_recon_loss: 2776126.8068; train_gene_expr_recon_loss: 13701021.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45438.8341; train_chrom_access_recon_loss: 13164237.6667; train_global_loss: 29772861.6061; train_optim_loss: 29772861.6061; val_kl_reg_loss: 87114.5449; val_edge_recon_loss: 2816930.7188; val_gene_expr_recon_loss: 13467819.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45263.1094; val_chrom_access_recon_loss: 12991150.5000; val_global_loss: 29408279.0000; val_optim_loss: 29408279.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9278; val_auprc_score: 0.8968; val_best_acc_score: 0.8724; val_best_f1_score: 0.8800; train_kl_reg_loss: 84656.6613; train_edge_recon_loss: 2766042.1591; train_gene_expr_recon_loss: 13653147.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44924.7178; train_chrom_access_recon_loss: 13115159.0909; train_global_loss: 29663930.6970; train_optim_loss: 29663930.6970; val_kl_reg_loss: 88131.0537; val_edge_recon_loss: 2756190.1562; val_gene_expr_recon_loss: 13450877.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44857.4570; val_chrom_access_recon_loss: 12905449.6250; val_global_loss: 29245505.2500; val_optim_loss: 29245505.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9254; val_auprc_score: 0.8938; val_best_acc_score: 0.8705; val_best_f1_score: 0.8769; train_kl_reg_loss: 85488.0251; train_edge_recon_loss: 2750941.0038; train_gene_expr_recon_loss: 13635182.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44660.4194; train_chrom_access_recon_loss: 13098978.0303; train_global_loss: 29615250.0909; train_optim_loss: 29615250.0909; val_kl_reg_loss: 87192.2344; val_edge_recon_loss: 2763216.2500; val_gene_expr_recon_loss: 13371744.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44198.5781; val_chrom_access_recon_loss: 12927478.8750; val_global_loss: 29193830.5000; val_optim_loss: 29193830.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9247; val_auprc_score: 0.8930; val_best_acc_score: 0.8716; val_best_f1_score: 0.8803; train_kl_reg_loss: 83962.4761; train_edge_recon_loss: 2755233.0114; train_gene_expr_recon_loss: 13600067.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44145.2530; train_chrom_access_recon_loss: 13050528.5909; train_global_loss: 29533937.1515; train_optim_loss: 29533937.1515; val_kl_reg_loss: 82295.4766; val_edge_recon_loss: 2754113.8750; val_gene_expr_recon_loss: 13319409.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43964.4883; val_chrom_access_recon_loss: 12834444.8750; val_global_loss: 29034227.5000; val_optim_loss: 29034227.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9270; val_auprc_score: 0.8924; val_best_acc_score: 0.8729; val_best_f1_score: 0.8804; train_kl_reg_loss: 82180.0152; train_edge_recon_loss: 2734992.0530; train_gene_expr_recon_loss: 13579991.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43803.5247; train_chrom_access_recon_loss: 13034150.8030; train_global_loss: 29475117.3030; train_optim_loss: 29475117.3030; val_kl_reg_loss: 83288.4150; val_edge_recon_loss: 2764831.5938; val_gene_expr_recon_loss: 13467123.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43671.7344; val_chrom_access_recon_loss: 12956505.7500; val_global_loss: 29315421.0000; val_optim_loss: 29315421.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9332; val_auprc_score: 0.9073; val_best_acc_score: 0.8705; val_best_f1_score: 0.8791; train_kl_reg_loss: 82025.0188; train_edge_recon_loss: 2745360.0455; train_gene_expr_recon_loss: 13533880.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43457.7878; train_chrom_access_recon_loss: 12995644.4394; train_global_loss: 29400368.1212; train_optim_loss: 29400368.1212; val_kl_reg_loss: 82855.6729; val_edge_recon_loss: 2752814.6875; val_gene_expr_recon_loss: 13272310.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43333.8789; val_chrom_access_recon_loss: 12798157.1250; val_global_loss: 28949472.5000; val_optim_loss: 28949472.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9357; val_auprc_score: 0.9107; val_best_acc_score: 0.8834; val_best_f1_score: 0.8891; train_kl_reg_loss: 81006.1226; train_edge_recon_loss: 2736514.3371; train_gene_expr_recon_loss: 13520461.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43143.4343; train_chrom_access_recon_loss: 12964115.1818; train_global_loss: 29345240.2727; train_optim_loss: 29345240.2727; val_kl_reg_loss: 78919.4521; val_edge_recon_loss: 2735789.3750; val_gene_expr_recon_loss: 13218359.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43003.4414; val_chrom_access_recon_loss: 12822920.8750; val_global_loss: 28898992.5000; val_optim_loss: 28898992.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9293; val_auprc_score: 0.8990; val_best_acc_score: 0.8778; val_best_f1_score: 0.8837; train_kl_reg_loss: 80460.2358; train_edge_recon_loss: 2734585.2917; train_gene_expr_recon_loss: 13497075.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42770.6580; train_chrom_access_recon_loss: 12936259.9545; train_global_loss: 29291151.3939; train_optim_loss: 29291151.3939; val_kl_reg_loss: 80204.0713; val_edge_recon_loss: 2776084.1250; val_gene_expr_recon_loss: 13384264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42636.1367; val_chrom_access_recon_loss: 12929743.2500; val_global_loss: 29212931.7500; val_optim_loss: 29212931.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9371; val_auprc_score: 0.9111; val_best_acc_score: 0.8821; val_best_f1_score: 0.8895; train_kl_reg_loss: 78946.8022; train_edge_recon_loss: 2752759.7235; train_gene_expr_recon_loss: 13433951.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39037.7147; train_chrom_access_recon_loss: 12932240.5758; train_global_loss: 29236936.5455; train_optim_loss: 29236936.5455; val_kl_reg_loss: 66913.7266; val_edge_recon_loss: 2756824.0625; val_gene_expr_recon_loss: 13115418.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38736.3672; val_chrom_access_recon_loss: 12708855.6250; val_global_loss: 28686748.2500; val_optim_loss: 28686748.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9316; val_auprc_score: 0.8974; val_best_acc_score: 0.8753; val_best_f1_score: 0.8822; train_kl_reg_loss: 81329.5191; train_edge_recon_loss: 2720156.9242; train_gene_expr_recon_loss: 13379303.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38592.8303; train_chrom_access_recon_loss: 12840416.5606; train_global_loss: 29059799.2424; train_optim_loss: 29059799.2424; val_kl_reg_loss: 68086.3955; val_edge_recon_loss: 2795197.6875; val_gene_expr_recon_loss: 13102169.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38671.2539; val_chrom_access_recon_loss: 12679593.0000; val_global_loss: 28683717.5000; val_optim_loss: 28683717.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9434; val_auprc_score: 0.9232; val_best_acc_score: 0.8917; val_best_f1_score: 0.8952; train_kl_reg_loss: 78803.6909; train_edge_recon_loss: 2726614.1780; train_gene_expr_recon_loss: 13365045.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38580.5569; train_chrom_access_recon_loss: 12829290.5000; train_global_loss: 29038334.6364; train_optim_loss: 29038334.6364; val_kl_reg_loss: 66303.7070; val_edge_recon_loss: 2738356.0938; val_gene_expr_recon_loss: 13127549.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38480.0156; val_chrom_access_recon_loss: 12699587.5000; val_global_loss: 28670277.0000; val_optim_loss: 28670277.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9341; val_auprc_score: 0.9036; val_best_acc_score: 0.8823; val_best_f1_score: 0.8866; train_kl_reg_loss: 77500.3751; train_edge_recon_loss: 2726199.6894; train_gene_expr_recon_loss: 13333248.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38473.9962; train_chrom_access_recon_loss: 12796351.6667; train_global_loss: 28971773.8788; train_optim_loss: 28971773.8788; val_kl_reg_loss: 66954.0088; val_edge_recon_loss: 2756482.9062; val_gene_expr_recon_loss: 13117379.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38469.7812; val_chrom_access_recon_loss: 12687333.3750; val_global_loss: 28666619.7500; val_optim_loss: 28666619.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9443; val_auprc_score: 0.9253; val_best_acc_score: 0.8909; val_best_f1_score: 0.8950; train_kl_reg_loss: 76434.6674; train_edge_recon_loss: 2722856.2803; train_gene_expr_recon_loss: 13312729.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38363.5916; train_chrom_access_recon_loss: 12775563.6818; train_global_loss: 28925947.4848; train_optim_loss: 28925947.4848; val_kl_reg_loss: 66242.2178; val_edge_recon_loss: 2727221.5938; val_gene_expr_recon_loss: 13049968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38247.6094; val_chrom_access_recon_loss: 12638861.5000; val_global_loss: 28520541.5000; val_optim_loss: 28520541.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9366; val_auprc_score: 0.9094; val_best_acc_score: 0.8826; val_best_f1_score: 0.8896; train_kl_reg_loss: 74759.6390; train_edge_recon_loss: 2711703.0417; train_gene_expr_recon_loss: 13284943.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38256.7048; train_chrom_access_recon_loss: 12755186.4697; train_global_loss: 28864849.7576; train_optim_loss: 28864849.7576; val_kl_reg_loss: 66610.7310; val_edge_recon_loss: 2767374.5625; val_gene_expr_recon_loss: 13117335.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38265.4688; val_chrom_access_recon_loss: 12619163.0000; val_global_loss: 28608747.7500; val_optim_loss: 28608747.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9378; val_auprc_score: 0.9025; val_best_acc_score: 0.8909; val_best_f1_score: 0.8955; train_kl_reg_loss: 73265.1656; train_edge_recon_loss: 2700441.7348; train_gene_expr_recon_loss: 13272451.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38219.1886; train_chrom_access_recon_loss: 12720667.0606; train_global_loss: 28805045.0000; train_optim_loss: 28805045.0000; val_kl_reg_loss: 64764.4258; val_edge_recon_loss: 2761891.5312; val_gene_expr_recon_loss: 12960094.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38160.9844; val_chrom_access_recon_loss: 12547611.2500; val_global_loss: 28372522.0000; val_optim_loss: 28372522.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9446; val_auprc_score: 0.9267; val_best_acc_score: 0.8866; val_best_f1_score: 0.8920; train_kl_reg_loss: 72126.5945; train_edge_recon_loss: 2709163.9129; train_gene_expr_recon_loss: 13262609.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38127.9827; train_chrom_access_recon_loss: 12711573.8030; train_global_loss: 28793601.6061; train_optim_loss: 28793601.6061; val_kl_reg_loss: 64720.3579; val_edge_recon_loss: 2757729.6875; val_gene_expr_recon_loss: 13011042.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38097.2578; val_chrom_access_recon_loss: 12515716.7500; val_global_loss: 28387306.0000; val_optim_loss: 28387306.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9477; val_auprc_score: 0.9263; val_best_acc_score: 0.8966; val_best_f1_score: 0.9004; train_kl_reg_loss: 71250.3924; train_edge_recon_loss: 2719133.3447; train_gene_expr_recon_loss: 13221284.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38019.3058; train_chrom_access_recon_loss: 12662621.6818; train_global_loss: 28712309.1212; train_optim_loss: 28712309.1212; val_kl_reg_loss: 63254.0479; val_edge_recon_loss: 2727560.5312; val_gene_expr_recon_loss: 12997628.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37994.9414; val_chrom_access_recon_loss: 12459625.5000; val_global_loss: 28286063.2500; val_optim_loss: 28286063.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9457; val_auprc_score: 0.9246; val_best_acc_score: 0.8939; val_best_f1_score: 0.8982; train_kl_reg_loss: 69865.0215; train_edge_recon_loss: 2707834.5038; train_gene_expr_recon_loss: 13206486.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37831.3041; train_chrom_access_recon_loss: 12652982.7727; train_global_loss: 28675000.2727; train_optim_loss: 28675000.2727; val_kl_reg_loss: 65369.8032; val_edge_recon_loss: 2736224.9375; val_gene_expr_recon_loss: 13032875.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37842.0703; val_chrom_access_recon_loss: 12512181.5000; val_global_loss: 28384494.2500; val_optim_loss: 28384494.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9464; val_auprc_score: 0.9245; val_best_acc_score: 0.8931; val_best_f1_score: 0.8987; train_kl_reg_loss: 69183.7160; train_edge_recon_loss: 2713017.2083; train_gene_expr_recon_loss: 13200231.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37754.7354; train_chrom_access_recon_loss: 12655099.7273; train_global_loss: 28675286.7879; train_optim_loss: 28675286.7879; val_kl_reg_loss: 64294.4043; val_edge_recon_loss: 2757878.7188; val_gene_expr_recon_loss: 12908001.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37714.4414; val_chrom_access_recon_loss: 12497768.1250; val_global_loss: 28265656.7500; val_optim_loss: 28265656.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9527; val_auprc_score: 0.9370; val_best_acc_score: 0.9022; val_best_f1_score: 0.9049; train_kl_reg_loss: 68104.9473; train_edge_recon_loss: 2705404.9811; train_gene_expr_recon_loss: 13187722.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37642.2536; train_chrom_access_recon_loss: 12622229.5152; train_global_loss: 28621104.3333; train_optim_loss: 28621104.3333; val_kl_reg_loss: 62961.1831; val_edge_recon_loss: 2716985.2500; val_gene_expr_recon_loss: 13012739.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37629.5273; val_chrom_access_recon_loss: 12467577.5000; val_global_loss: 28297894.0000; val_optim_loss: 28297894.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9500; val_auprc_score: 0.9289; val_best_acc_score: 0.8992; val_best_f1_score: 0.9024; train_kl_reg_loss: 66924.6097; train_edge_recon_loss: 2702799.8939; train_gene_expr_recon_loss: 13169865.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37596.4821; train_chrom_access_recon_loss: 12612977.5000; train_global_loss: 28590164.2121; train_optim_loss: 28590164.2121; val_kl_reg_loss: 62643.7061; val_edge_recon_loss: 2703915.7500; val_gene_expr_recon_loss: 12991874.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37517.0469; val_chrom_access_recon_loss: 12476453.7500; val_global_loss: 28272404.0000; val_optim_loss: 28272404.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9468; val_auprc_score: 0.9229; val_best_acc_score: 0.8909; val_best_f1_score: 0.8959; train_kl_reg_loss: 66518.5984; train_edge_recon_loss: 2704551.0114; train_gene_expr_recon_loss: 13148138.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37442.9077; train_chrom_access_recon_loss: 12574328.2879; train_global_loss: 28530979.3030; train_optim_loss: 28530979.3030; val_kl_reg_loss: 62641.2075; val_edge_recon_loss: 2734003.4375; val_gene_expr_recon_loss: 13032447.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37483.4180; val_chrom_access_recon_loss: 12437705.5000; val_global_loss: 28304281.0000; val_optim_loss: 28304281.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9570; val_auprc_score: 0.9394; val_best_acc_score: 0.9073; val_best_f1_score: 0.9104; train_kl_reg_loss: 65439.7325; train_edge_recon_loss: 2695328.7159; train_gene_expr_recon_loss: 13140506.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37402.4674; train_chrom_access_recon_loss: 12579269.4091; train_global_loss: 28517946.8182; train_optim_loss: 28517946.8182; val_kl_reg_loss: 62783.6714; val_edge_recon_loss: 2700787.4688; val_gene_expr_recon_loss: 12959966.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37298.5312; val_chrom_access_recon_loss: 12380449.6250; val_global_loss: 28141286.0000; val_optim_loss: 28141286.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9522; val_auprc_score: 0.9317; val_best_acc_score: 0.9049; val_best_f1_score: 0.9091; train_kl_reg_loss: 65161.5172; train_edge_recon_loss: 2693080.2652; train_gene_expr_recon_loss: 13112281.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37209.6220; train_chrom_access_recon_loss: 12541629.3636; train_global_loss: 28449361.6970; train_optim_loss: 28449361.6970; val_kl_reg_loss: 62413.2886; val_edge_recon_loss: 2728640.0312; val_gene_expr_recon_loss: 13034606.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37176.4727; val_chrom_access_recon_loss: 12590315.1250; val_global_loss: 28453150.2500; val_optim_loss: 28453150.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9554; val_auprc_score: 0.9383; val_best_acc_score: 0.9049; val_best_f1_score: 0.9085; train_kl_reg_loss: 64906.3602; train_edge_recon_loss: 2685932.7841; train_gene_expr_recon_loss: 13107925.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37113.0842; train_chrom_access_recon_loss: 12540638.4545; train_global_loss: 28436516.5455; train_optim_loss: 28436516.5455; val_kl_reg_loss: 60569.6660; val_edge_recon_loss: 2711408.1875; val_gene_expr_recon_loss: 12971319.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37158.8672; val_chrom_access_recon_loss: 12392381.0000; val_global_loss: 28172836.5000; val_optim_loss: 28172836.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9533; val_auprc_score: 0.9347; val_best_acc_score: 0.9011; val_best_f1_score: 0.9042; train_kl_reg_loss: 64540.6074; train_edge_recon_loss: 2693289.5682; train_gene_expr_recon_loss: 13076459.1212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37111.7869; train_chrom_access_recon_loss: 12485047.1212; train_global_loss: 28356448.3030; train_optim_loss: 28356448.3030; val_kl_reg_loss: 58101.6929; val_edge_recon_loss: 2732007.8750; val_gene_expr_recon_loss: 12950682.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37086.2930; val_chrom_access_recon_loss: 12392247.5000; val_global_loss: 28170126.0000; val_optim_loss: 28170126.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9558; val_auprc_score: 0.9370; val_best_acc_score: 0.9105; val_best_f1_score: 0.9142; train_kl_reg_loss: 62916.7743; train_edge_recon_loss: 2683742.8295; train_gene_expr_recon_loss: 13062129.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37040.0508; train_chrom_access_recon_loss: 12472306.5000; train_global_loss: 28318135.4848; train_optim_loss: 28318135.4848; val_kl_reg_loss: 58507.4126; val_edge_recon_loss: 2700885.9688; val_gene_expr_recon_loss: 12963242.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36971.9492; val_chrom_access_recon_loss: 12355882.0000; val_global_loss: 28115490.0000; val_optim_loss: 28115490.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9542; val_auprc_score: 0.9345; val_best_acc_score: 0.9073; val_best_f1_score: 0.9121; train_kl_reg_loss: 63853.4799; train_edge_recon_loss: 2679474.2273; train_gene_expr_recon_loss: 13046323.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36909.9694; train_chrom_access_recon_loss: 12455663.6212; train_global_loss: 28282224.6667; train_optim_loss: 28282224.6667; val_kl_reg_loss: 59361.6045; val_edge_recon_loss: 2728609.5312; val_gene_expr_recon_loss: 12843535.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37000.0469; val_chrom_access_recon_loss: 12289735.7500; val_global_loss: 27958242.5000; val_optim_loss: 27958242.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9602; val_auprc_score: 0.9447; val_best_acc_score: 0.9151; val_best_f1_score: 0.9181; train_kl_reg_loss: 62941.2228; train_edge_recon_loss: 2676653.8712; train_gene_expr_recon_loss: 13039674.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36912.0146; train_chrom_access_recon_loss: 12452284.6970; train_global_loss: 28268466.4242; train_optim_loss: 28268466.4242; val_kl_reg_loss: 58462.3550; val_edge_recon_loss: 2693486.5938; val_gene_expr_recon_loss: 12890602.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36829.6875; val_chrom_access_recon_loss: 12346810.8750; val_global_loss: 28026192.2500; val_optim_loss: 28026192.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9630; val_auprc_score: 0.9485; val_best_acc_score: 0.9167; val_best_f1_score: 0.9192; train_kl_reg_loss: 62125.1445; train_edge_recon_loss: 2676831.9470; train_gene_expr_recon_loss: 13015637.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36788.5491; train_chrom_access_recon_loss: 12427343.1364; train_global_loss: 28218726.2424; train_optim_loss: 28218726.2424; val_kl_reg_loss: 57924.1592; val_edge_recon_loss: 2677549.1250; val_gene_expr_recon_loss: 12885638.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36745.7109; val_chrom_access_recon_loss: 12325485.1250; val_global_loss: 27983342.7500; val_optim_loss: 27983342.7500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9638; val_auprc_score: 0.9525; val_best_acc_score: 0.9146; val_best_f1_score: 0.9180; train_kl_reg_loss: 61445.2962; train_edge_recon_loss: 2679703.2689; train_gene_expr_recon_loss: 13001124.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36712.0700; train_chrom_access_recon_loss: 12416983.1061; train_global_loss: 28195968.1212; train_optim_loss: 28195968.1212; val_kl_reg_loss: 56968.0957; val_edge_recon_loss: 2671179.7812; val_gene_expr_recon_loss: 12788555.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36754.0664; val_chrom_access_recon_loss: 12195634.3750; val_global_loss: 27749092.5000; val_optim_loss: 27749092.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9610; val_auprc_score: 0.9470; val_best_acc_score: 0.9113; val_best_f1_score: 0.9146; train_kl_reg_loss: 60896.3133; train_edge_recon_loss: 2670784.5076; train_gene_expr_recon_loss: 12993555.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36687.1270; train_chrom_access_recon_loss: 12405658.4242; train_global_loss: 28167582.0000; train_optim_loss: 28167582.0000; val_kl_reg_loss: 56318.9229; val_edge_recon_loss: 2681829.0312; val_gene_expr_recon_loss: 12760780.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36698.8047; val_chrom_access_recon_loss: 12233312.2500; val_global_loss: 27768940.0000; val_optim_loss: 27768940.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9600; val_auprc_score: 0.9439; val_best_acc_score: 0.9151; val_best_f1_score: 0.9187; train_kl_reg_loss: 60610.5305; train_edge_recon_loss: 2676989.1136; train_gene_expr_recon_loss: 12979655.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36645.4157; train_chrom_access_recon_loss: 12394612.4091; train_global_loss: 28148512.9697; train_optim_loss: 28148512.9697; val_kl_reg_loss: 57588.3828; val_edge_recon_loss: 2693027.5625; val_gene_expr_recon_loss: 12831912.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36549.5703; val_chrom_access_recon_loss: 12258454.6250; val_global_loss: 27877533.7500; val_optim_loss: 27877533.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9625; val_auprc_score: 0.9479; val_best_acc_score: 0.9148; val_best_f1_score: 0.9186; train_kl_reg_loss: 60401.2893; train_edge_recon_loss: 2672795.6250; train_gene_expr_recon_loss: 12966633.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36544.5830; train_chrom_access_recon_loss: 12377710.5303; train_global_loss: 28114085.8788; train_optim_loss: 28114085.8788; val_kl_reg_loss: 56969.2256; val_edge_recon_loss: 2700741.2500; val_gene_expr_recon_loss: 12805215.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36587.0430; val_chrom_access_recon_loss: 12329608.3750; val_global_loss: 27929121.7500; val_optim_loss: 27929121.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9665; val_auprc_score: 0.9545; val_best_acc_score: 0.9205; val_best_f1_score: 0.9228; train_kl_reg_loss: 59205.9205; train_edge_recon_loss: 2683116.7083; train_gene_expr_recon_loss: 12957498.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36553.7984; train_chrom_access_recon_loss: 12378323.8030; train_global_loss: 28114698.7879; train_optim_loss: 28114698.7879; val_kl_reg_loss: 55763.3022; val_edge_recon_loss: 2697349.5312; val_gene_expr_recon_loss: 12739147.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36591.9570; val_chrom_access_recon_loss: 12330054.6250; val_global_loss: 27858906.2500; val_optim_loss: 27858906.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9613; val_auprc_score: 0.9474; val_best_acc_score: 0.9143; val_best_f1_score: 0.9171; train_kl_reg_loss: 59384.8175; train_edge_recon_loss: 2670743.4621; train_gene_expr_recon_loss: 12938148.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33414.1425; train_chrom_access_recon_loss: 12352597.6364; train_global_loss: 28054288.3333; train_optim_loss: 28054288.3333; val_kl_reg_loss: 55701.7554; val_edge_recon_loss: 2723667.1562; val_gene_expr_recon_loss: 12864846.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32605.3535; val_chrom_access_recon_loss: 12241780.8750; val_global_loss: 27918600.5000; val_optim_loss: 27918600.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9671; val_auprc_score: 0.9527; val_best_acc_score: 0.9202; val_best_f1_score: 0.9231; train_kl_reg_loss: 59973.0281; train_edge_recon_loss: 2670787.7008; train_gene_expr_recon_loss: 12932947.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32432.8094; train_chrom_access_recon_loss: 12358815.8636; train_global_loss: 28054957.3939; train_optim_loss: 28054957.3939; val_kl_reg_loss: 56490.2681; val_edge_recon_loss: 2685657.8125; val_gene_expr_recon_loss: 12741325.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32287.5098; val_chrom_access_recon_loss: 12088428.7500; val_global_loss: 27604190.5000; val_optim_loss: 27604190.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9624; val_auprc_score: 0.9481; val_best_acc_score: 0.9140; val_best_f1_score: 0.9169; train_kl_reg_loss: 60239.4087; train_edge_recon_loss: 2683775.6780; train_gene_expr_recon_loss: 12925081.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32193.7304; train_chrom_access_recon_loss: 12342879.5758; train_global_loss: 28044169.7576; train_optim_loss: 28044169.7576; val_kl_reg_loss: 56147.8335; val_edge_recon_loss: 2701164.9062; val_gene_expr_recon_loss: 12908059.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32109.0273; val_chrom_access_recon_loss: 12248637.8750; val_global_loss: 27946119.2500; val_optim_loss: 27946119.2500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9633; val_auprc_score: 0.9449; val_best_acc_score: 0.9148; val_best_f1_score: 0.9176; train_kl_reg_loss: 60353.5265; train_edge_recon_loss: 2666368.3182; train_gene_expr_recon_loss: 12933705.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32058.8072; train_chrom_access_recon_loss: 12349452.5455; train_global_loss: 28041938.3030; train_optim_loss: 28041938.3030; val_kl_reg_loss: 56921.5190; val_edge_recon_loss: 2715769.7500; val_gene_expr_recon_loss: 12730449.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31996.6914; val_chrom_access_recon_loss: 12225914.0000; val_global_loss: 27761052.0000; val_optim_loss: 27761052.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9578; val_auprc_score: 0.9385; val_best_acc_score: 0.9135; val_best_f1_score: 0.9165; train_kl_reg_loss: 60568.6264; train_edge_recon_loss: 2667987.6174; train_gene_expr_recon_loss: 12922006.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31940.3005; train_chrom_access_recon_loss: 12340827.4545; train_global_loss: 28023330.6667; train_optim_loss: 28023330.6667; val_kl_reg_loss: 56906.7295; val_edge_recon_loss: 2705865.1562; val_gene_expr_recon_loss: 12826231.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31909.7227; val_chrom_access_recon_loss: 12284066.2500; val_global_loss: 27904979.2500; val_optim_loss: 27904979.2500
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9641; val_auprc_score: 0.9508; val_best_acc_score: 0.9194; val_best_f1_score: 0.9216; train_kl_reg_loss: 60488.2637; train_edge_recon_loss: 2666180.1439; train_gene_expr_recon_loss: 12927860.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31877.1289; train_chrom_access_recon_loss: 12346476.9545; train_global_loss: 28032883.4242; train_optim_loss: 28032883.4242; val_kl_reg_loss: 57110.0376; val_edge_recon_loss: 2680091.3125; val_gene_expr_recon_loss: 12762726.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31831.6035; val_chrom_access_recon_loss: 12310855.6250; val_global_loss: 27842615.5000; val_optim_loss: 27842615.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9607; val_auprc_score: 0.9460; val_best_acc_score: 0.9159; val_best_f1_score: 0.9175; train_kl_reg_loss: 60665.8475; train_edge_recon_loss: 2657619.4886; train_gene_expr_recon_loss: 12926388.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31504.2923; train_chrom_access_recon_loss: 12347557.7121; train_global_loss: 28023735.3939; train_optim_loss: 28023735.3939; val_kl_reg_loss: 56995.4395; val_edge_recon_loss: 2707171.8125; val_gene_expr_recon_loss: 12810105.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31426.6445; val_chrom_access_recon_loss: 12206739.5000; val_global_loss: 27812439.2500; val_optim_loss: 27812439.2500
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9570; val_auprc_score: 0.9392; val_best_acc_score: 0.9089; val_best_f1_score: 0.9117; train_kl_reg_loss: 60681.6768; train_edge_recon_loss: 2667563.8750; train_gene_expr_recon_loss: 12922359.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31410.4514; train_chrom_access_recon_loss: 12346794.5455; train_global_loss: 28028809.8788; train_optim_loss: 28028809.8788; val_kl_reg_loss: 56811.5620; val_edge_recon_loss: 2724986.5312; val_gene_expr_recon_loss: 12736954.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31395.4863; val_chrom_access_recon_loss: 12237330.6250; val_global_loss: 27787478.5000; val_optim_loss: 27787478.5000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9647; val_auprc_score: 0.9494; val_best_acc_score: 0.9175; val_best_f1_score: 0.9204; train_kl_reg_loss: 60615.5680; train_edge_recon_loss: 2663345.1326; train_gene_expr_recon_loss: 12923396.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31385.3026; train_chrom_access_recon_loss: 12346828.5000; train_global_loss: 28025570.8485; train_optim_loss: 28025570.8485; val_kl_reg_loss: 56693.5146; val_edge_recon_loss: 2691983.8125; val_gene_expr_recon_loss: 12811994.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31374.7070; val_chrom_access_recon_loss: 12316932.3750; val_global_loss: 27908979.7500; val_optim_loss: 27908979.7500
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9606; val_auprc_score: 0.9374; val_best_acc_score: 0.9170; val_best_f1_score: 0.9203; train_kl_reg_loss: 60655.2090; train_edge_recon_loss: 2673186.2614; train_gene_expr_recon_loss: 12924287.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31366.8840; train_chrom_access_recon_loss: 12349157.6364; train_global_loss: 28038653.6061; train_optim_loss: 28038653.6061; val_kl_reg_loss: 57152.8882; val_edge_recon_loss: 2673833.4062; val_gene_expr_recon_loss: 12723235.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31358.8984; val_chrom_access_recon_loss: 12259168.6250; val_global_loss: 27744749.2500; val_optim_loss: 27744749.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 51 min 53 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9647
val AUPRC score: 0.9473
val best accuracy score: 0.9210
val best F1 score: 0.9238
val target rna MSE score: 0.8030
val source rna MSE score: 0.2357
val target atac MSE score: 0.3238
val source atac MSE score: 0.0727
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
