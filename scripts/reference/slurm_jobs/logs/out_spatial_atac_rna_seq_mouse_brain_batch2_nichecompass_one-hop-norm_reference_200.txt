[True]
Run timestamp: 10102023_081609_200.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_200']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6849; val_auprc_score: 0.6708; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 57504.6036; train_edge_recon_loss: 752528.6023; train_gene_expr_recon_loss: 23102784.5455; train_masked_gp_l1_reg_loss: 103041.3287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3308367.0227; train_chrom_access_recon_loss: 6931953.1364; train_global_loss: 34256179.3939; train_optim_loss: 34256179.3939; val_kl_reg_loss: 85272.1396; val_edge_recon_loss: 813117.4688; val_gene_expr_recon_loss: 21604930.7500; val_masked_gp_l1_reg_loss: 77659.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2232138.2500; val_chrom_access_recon_loss: 6664830.2500; val_global_loss: 31477948.2500; val_optim_loss: 31477948.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7361; val_auprc_score: 0.7248; val_best_acc_score: 0.5459; val_best_f1_score: 0.6842; train_kl_reg_loss: 90952.3980; train_edge_recon_loss: 749831.8598; train_gene_expr_recon_loss: 21265994.7273; train_masked_gp_l1_reg_loss: 71561.4190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1455925.9924; train_chrom_access_recon_loss: 6601733.0758; train_global_loss: 30235999.4848; train_optim_loss: 30235999.4848; val_kl_reg_loss: 84979.1758; val_edge_recon_loss: 812521.6562; val_gene_expr_recon_loss: 21072334.0000; val_masked_gp_l1_reg_loss: 68835.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 869880.5000; val_chrom_access_recon_loss: 6433483.2500; val_global_loss: 29342034.2500; val_optim_loss: 29342034.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8367; val_auprc_score: 0.8173; val_best_acc_score: 0.7681; val_best_f1_score: 0.7722; train_kl_reg_loss: 83212.6097; train_edge_recon_loss: 739751.3769; train_gene_expr_recon_loss: 21019740.8182; train_masked_gp_l1_reg_loss: 68704.8165; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 601521.1411; train_chrom_access_recon_loss: 6542471.0606; train_global_loss: 29055401.8182; train_optim_loss: 29055401.8182; val_kl_reg_loss: 83908.9639; val_edge_recon_loss: 806322.2500; val_gene_expr_recon_loss: 21160662.5000; val_masked_gp_l1_reg_loss: 69584.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 411823.3125; val_chrom_access_recon_loss: 6528126.1250; val_global_loss: 29060427.7500; val_optim_loss: 29060427.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8635; val_auprc_score: 0.8291; val_best_acc_score: 0.7894; val_best_f1_score: 0.8083; train_kl_reg_loss: 75361.2385; train_edge_recon_loss: 729981.5009; train_gene_expr_recon_loss: 20849812.1212; train_masked_gp_l1_reg_loss: 71146.9406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 323511.6901; train_chrom_access_recon_loss: 6496844.0227; train_global_loss: 28546657.6970; train_optim_loss: 28546657.6970; val_kl_reg_loss: 71425.7695; val_edge_recon_loss: 777445.0312; val_gene_expr_recon_loss: 20815615.5000; val_masked_gp_l1_reg_loss: 73119.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 258948.7500; val_chrom_access_recon_loss: 6445913.0625; val_global_loss: 28442467.2500; val_optim_loss: 28442467.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8797; val_auprc_score: 0.8549; val_best_acc_score: 0.8017; val_best_f1_score: 0.8188; train_kl_reg_loss: 69192.2788; train_edge_recon_loss: 704178.7235; train_gene_expr_recon_loss: 20687114.8182; train_masked_gp_l1_reg_loss: 75121.5510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 220567.8381; train_chrom_access_recon_loss: 6456058.3636; train_global_loss: 28212233.6364; train_optim_loss: 28212233.6364; val_kl_reg_loss: 69602.0459; val_edge_recon_loss: 690199.9844; val_gene_expr_recon_loss: 20643172.5000; val_masked_gp_l1_reg_loss: 76589.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 187884.1875; val_chrom_access_recon_loss: 6441934.3125; val_global_loss: 28109383.5000; val_optim_loss: 28109383.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8770; val_auprc_score: 0.8370; val_best_acc_score: 0.8111; val_best_f1_score: 0.8302; train_kl_reg_loss: 77611.5101; train_edge_recon_loss: 651157.0360; train_gene_expr_recon_loss: 20574580.4545; train_masked_gp_l1_reg_loss: 78087.6341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167079.8414; train_chrom_access_recon_loss: 6429510.0985; train_global_loss: 27978026.6061; train_optim_loss: 27978026.6061; val_kl_reg_loss: 77691.7402; val_edge_recon_loss: 638137.7031; val_gene_expr_recon_loss: 20488187.2500; val_masked_gp_l1_reg_loss: 79330.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148930.0625; val_chrom_access_recon_loss: 6398015.0000; val_global_loss: 27830291.5000; val_optim_loss: 27830291.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8873; val_auprc_score: 0.8546; val_best_acc_score: 0.8141; val_best_f1_score: 0.8309; train_kl_reg_loss: 79850.3348; train_edge_recon_loss: 634871.0511; train_gene_expr_recon_loss: 20467386.6667; train_masked_gp_l1_reg_loss: 80491.3451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136545.5064; train_chrom_access_recon_loss: 6397524.0682; train_global_loss: 27796669.0000; train_optim_loss: 27796669.0000; val_kl_reg_loss: 78742.8467; val_edge_recon_loss: 633530.9453; val_gene_expr_recon_loss: 20610409.2500; val_masked_gp_l1_reg_loss: 81527.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126201.1406; val_chrom_access_recon_loss: 6369733.2500; val_global_loss: 27900146.5000; val_optim_loss: 27900146.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9041; val_auprc_score: 0.8760; val_best_acc_score: 0.8283; val_best_f1_score: 0.8448; train_kl_reg_loss: 78356.8279; train_edge_recon_loss: 625622.4479; train_gene_expr_recon_loss: 20374745.4242; train_masked_gp_l1_reg_loss: 82493.6364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117847.7047; train_chrom_access_recon_loss: 6366109.5682; train_global_loss: 27645175.7879; train_optim_loss: 27645175.7879; val_kl_reg_loss: 80030.7227; val_edge_recon_loss: 622289.9922; val_gene_expr_recon_loss: 20382154.0000; val_masked_gp_l1_reg_loss: 83232.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110591.8047; val_chrom_access_recon_loss: 6302162.0000; val_global_loss: 27580461.0000; val_optim_loss: 27580461.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8999; val_auprc_score: 0.8719; val_best_acc_score: 0.8256; val_best_f1_score: 0.8409; train_kl_reg_loss: 77748.0954; train_edge_recon_loss: 617910.8674; train_gene_expr_recon_loss: 20309151.9697; train_masked_gp_l1_reg_loss: 84249.7174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105506.5947; train_chrom_access_recon_loss: 6348753.7121; train_global_loss: 27543321.0303; train_optim_loss: 27543321.0303; val_kl_reg_loss: 74120.3516; val_edge_recon_loss: 622091.6094; val_gene_expr_recon_loss: 20304874.2500; val_masked_gp_l1_reg_loss: 85080.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100989.6641; val_chrom_access_recon_loss: 6374153.5625; val_global_loss: 27561309.7500; val_optim_loss: 27561309.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9026; val_auprc_score: 0.8774; val_best_acc_score: 0.8291; val_best_f1_score: 0.8404; train_kl_reg_loss: 75428.7325; train_edge_recon_loss: 615601.2652; train_gene_expr_recon_loss: 20202742.6970; train_masked_gp_l1_reg_loss: 85680.3072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97537.1765; train_chrom_access_recon_loss: 6317675.3485; train_global_loss: 27394665.6364; train_optim_loss: 27394665.6364; val_kl_reg_loss: 74641.0234; val_edge_recon_loss: 620643.7656; val_gene_expr_recon_loss: 20264520.2500; val_masked_gp_l1_reg_loss: 86556.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94755.9453; val_chrom_access_recon_loss: 6279069.3125; val_global_loss: 27420186.5000; val_optim_loss: 27420186.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9096; val_auprc_score: 0.8793; val_best_acc_score: 0.8366; val_best_f1_score: 0.8468; train_kl_reg_loss: 74121.5687; train_edge_recon_loss: 609809.9574; train_gene_expr_recon_loss: 20137627.1515; train_masked_gp_l1_reg_loss: 87034.4545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92394.4213; train_chrom_access_recon_loss: 6312094.0909; train_global_loss: 27313081.5152; train_optim_loss: 27313081.5152; val_kl_reg_loss: 73677.0527; val_edge_recon_loss: 608432.9141; val_gene_expr_recon_loss: 20064230.0000; val_masked_gp_l1_reg_loss: 87665.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90704.6797; val_chrom_access_recon_loss: 6261034.2500; val_global_loss: 27185744.5000; val_optim_loss: 27185744.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9214; val_auprc_score: 0.9014; val_best_acc_score: 0.8485; val_best_f1_score: 0.8604; train_kl_reg_loss: 73088.5515; train_edge_recon_loss: 604737.0947; train_gene_expr_recon_loss: 20060912.2121; train_masked_gp_l1_reg_loss: 88202.5281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88391.4290; train_chrom_access_recon_loss: 6277409.9621; train_global_loss: 27192741.7879; train_optim_loss: 27192741.7879; val_kl_reg_loss: 71703.2529; val_edge_recon_loss: 607331.3828; val_gene_expr_recon_loss: 20093192.0000; val_masked_gp_l1_reg_loss: 88695.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86588.1172; val_chrom_access_recon_loss: 6224882.3125; val_global_loss: 27172393.2500; val_optim_loss: 27172393.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9177; val_auprc_score: 0.8953; val_best_acc_score: 0.8485; val_best_f1_score: 0.8591; train_kl_reg_loss: 71673.8042; train_edge_recon_loss: 605562.7519; train_gene_expr_recon_loss: 19982129.7576; train_masked_gp_l1_reg_loss: 89172.9299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84826.2464; train_chrom_access_recon_loss: 6257016.2500; train_global_loss: 27090381.6364; train_optim_loss: 27090381.6364; val_kl_reg_loss: 71108.7188; val_edge_recon_loss: 608430.7031; val_gene_expr_recon_loss: 20016956.7500; val_masked_gp_l1_reg_loss: 89781.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83283.2031; val_chrom_access_recon_loss: 6226188.6875; val_global_loss: 27095750.2500; val_optim_loss: 27095750.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9145; val_auprc_score: 0.8916; val_best_acc_score: 0.8426; val_best_f1_score: 0.8519; train_kl_reg_loss: 70346.9595; train_edge_recon_loss: 601601.9062; train_gene_expr_recon_loss: 19913337.6970; train_masked_gp_l1_reg_loss: 90250.3636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81656.8954; train_chrom_access_recon_loss: 6234078.8864; train_global_loss: 26991272.7273; train_optim_loss: 26991272.7273; val_kl_reg_loss: 71744.1279; val_edge_recon_loss: 613230.7109; val_gene_expr_recon_loss: 20136946.5000; val_masked_gp_l1_reg_loss: 90843.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81012.1562; val_chrom_access_recon_loss: 6290925.7500; val_global_loss: 27284703.2500; val_optim_loss: 27284703.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9279; val_auprc_score: 0.9052; val_best_acc_score: 0.8622; val_best_f1_score: 0.8692; train_kl_reg_loss: 69419.5247; train_edge_recon_loss: 600216.7841; train_gene_expr_recon_loss: 19862237.7273; train_masked_gp_l1_reg_loss: 91242.5552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79511.0489; train_chrom_access_recon_loss: 6216950.3409; train_global_loss: 26919577.8182; train_optim_loss: 26919577.8182; val_kl_reg_loss: 70605.7051; val_edge_recon_loss: 602826.9688; val_gene_expr_recon_loss: 19782363.5000; val_masked_gp_l1_reg_loss: 91767.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78985.7031; val_chrom_access_recon_loss: 6142661.5000; val_global_loss: 26769211.0000; val_optim_loss: 26769211.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9326; val_auprc_score: 0.9152; val_best_acc_score: 0.8654; val_best_f1_score: 0.8713; train_kl_reg_loss: 68867.5356; train_edge_recon_loss: 598460.7509; train_gene_expr_recon_loss: 19803372.5758; train_masked_gp_l1_reg_loss: 92199.1314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77769.8255; train_chrom_access_recon_loss: 6200329.9545; train_global_loss: 26840999.6667; train_optim_loss: 26840999.6667; val_kl_reg_loss: 68211.3896; val_edge_recon_loss: 603398.4453; val_gene_expr_recon_loss: 19615410.5000; val_masked_gp_l1_reg_loss: 92775.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77095.8906; val_chrom_access_recon_loss: 6141044.6250; val_global_loss: 26597937.2500; val_optim_loss: 26597937.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9338; val_auprc_score: 0.9163; val_best_acc_score: 0.8692; val_best_f1_score: 0.8756; train_kl_reg_loss: 67994.0650; train_edge_recon_loss: 594934.3665; train_gene_expr_recon_loss: 19769280.9697; train_masked_gp_l1_reg_loss: 93121.4621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76247.1103; train_chrom_access_recon_loss: 6188589.0530; train_global_loss: 26790167.0909; train_optim_loss: 26790167.0909; val_kl_reg_loss: 68214.9219; val_edge_recon_loss: 599618.2109; val_gene_expr_recon_loss: 19802769.5000; val_masked_gp_l1_reg_loss: 93560.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75301.1172; val_chrom_access_recon_loss: 6135113.0625; val_global_loss: 26774577.5000; val_optim_loss: 26774577.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9374; val_auprc_score: 0.9198; val_best_acc_score: 0.8716; val_best_f1_score: 0.8782; train_kl_reg_loss: 67482.4051; train_edge_recon_loss: 593855.6506; train_gene_expr_recon_loss: 19697246.6970; train_masked_gp_l1_reg_loss: 94017.0619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74559.3577; train_chrom_access_recon_loss: 6164393.3864; train_global_loss: 26691554.7576; train_optim_loss: 26691554.7576; val_kl_reg_loss: 67862.2373; val_edge_recon_loss: 599406.4844; val_gene_expr_recon_loss: 19796372.0000; val_masked_gp_l1_reg_loss: 94612.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74853.3047; val_chrom_access_recon_loss: 6165762.2500; val_global_loss: 26798868.7500; val_optim_loss: 26798868.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9399; val_auprc_score: 0.9215; val_best_acc_score: 0.8721; val_best_f1_score: 0.8788; train_kl_reg_loss: 66836.3625; train_edge_recon_loss: 591030.0483; train_gene_expr_recon_loss: 19649847.2727; train_masked_gp_l1_reg_loss: 94900.4227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74144.3358; train_chrom_access_recon_loss: 6148981.1061; train_global_loss: 26625739.9394; train_optim_loss: 26625739.9394; val_kl_reg_loss: 65292.0850; val_edge_recon_loss: 595060.0781; val_gene_expr_recon_loss: 19505157.7500; val_masked_gp_l1_reg_loss: 95465.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73480.5625; val_chrom_access_recon_loss: 6116956.3750; val_global_loss: 26451412.2500; val_optim_loss: 26451412.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9434; val_auprc_score: 0.9296; val_best_acc_score: 0.8761; val_best_f1_score: 0.8822; train_kl_reg_loss: 66019.9009; train_edge_recon_loss: 592377.7481; train_gene_expr_recon_loss: 19602051.6364; train_masked_gp_l1_reg_loss: 95787.5933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73274.8375; train_chrom_access_recon_loss: 6134039.8182; train_global_loss: 26563551.3636; train_optim_loss: 26563551.3636; val_kl_reg_loss: 66217.0059; val_edge_recon_loss: 595553.0938; val_gene_expr_recon_loss: 19624425.0000; val_masked_gp_l1_reg_loss: 96384.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73033.0938; val_chrom_access_recon_loss: 6106807.1875; val_global_loss: 26562420.2500; val_optim_loss: 26562420.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9320; val_auprc_score: 0.9113; val_best_acc_score: 0.8689; val_best_f1_score: 0.8761; train_kl_reg_loss: 65366.2793; train_edge_recon_loss: 591026.8314; train_gene_expr_recon_loss: 19558921.6970; train_masked_gp_l1_reg_loss: 96804.8786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72775.6867; train_chrom_access_recon_loss: 6117693.2652; train_global_loss: 26502588.6970; train_optim_loss: 26502588.6970; val_kl_reg_loss: 64752.4160; val_edge_recon_loss: 597723.5781; val_gene_expr_recon_loss: 19716611.7500; val_masked_gp_l1_reg_loss: 97343.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72329.8672; val_chrom_access_recon_loss: 6192824.5000; val_global_loss: 26741586.0000; val_optim_loss: 26741586.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9437; val_auprc_score: 0.9251; val_best_acc_score: 0.8834; val_best_f1_score: 0.8870; train_kl_reg_loss: 64924.9057; train_edge_recon_loss: 588523.5095; train_gene_expr_recon_loss: 19509805.4848; train_masked_gp_l1_reg_loss: 97724.0217; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72150.0943; train_chrom_access_recon_loss: 6096834.4242; train_global_loss: 26429962.3636; train_optim_loss: 26429962.3636; val_kl_reg_loss: 65693.9561; val_edge_recon_loss: 593261.8281; val_gene_expr_recon_loss: 19749040.2500; val_masked_gp_l1_reg_loss: 98328.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71700.1953; val_chrom_access_recon_loss: 6134742.4375; val_global_loss: 26712766.2500; val_optim_loss: 26712766.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9487; val_auprc_score: 0.9293; val_best_acc_score: 0.8904; val_best_f1_score: 0.8947; train_kl_reg_loss: 64272.5816; train_edge_recon_loss: 588706.9451; train_gene_expr_recon_loss: 19438389.2727; train_masked_gp_l1_reg_loss: 98744.7506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71401.5717; train_chrom_access_recon_loss: 6068408.8561; train_global_loss: 26329924.0000; train_optim_loss: 26329924.0000; val_kl_reg_loss: 64158.6953; val_edge_recon_loss: 594998.3203; val_gene_expr_recon_loss: 19628543.5000; val_masked_gp_l1_reg_loss: 99349.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71949.1719; val_chrom_access_recon_loss: 6108992.7500; val_global_loss: 26567993.2500; val_optim_loss: 26567993.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9452; val_auprc_score: 0.9301; val_best_acc_score: 0.8861; val_best_f1_score: 0.8910; train_kl_reg_loss: 63886.3349; train_edge_recon_loss: 589099.5199; train_gene_expr_recon_loss: 19420800.5455; train_masked_gp_l1_reg_loss: 96003.1740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58247.7053; train_chrom_access_recon_loss: 6058291.9621; train_global_loss: 26286329.1212; train_optim_loss: 26286329.1212; val_kl_reg_loss: 64914.5972; val_edge_recon_loss: 592958.2812; val_gene_expr_recon_loss: 19534683.0000; val_masked_gp_l1_reg_loss: 94541.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53835.4141; val_chrom_access_recon_loss: 6065491.6250; val_global_loss: 26406425.2500; val_optim_loss: 26406425.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9352; val_auprc_score: 0.9095; val_best_acc_score: 0.8769; val_best_f1_score: 0.8826; train_kl_reg_loss: 64614.0288; train_edge_recon_loss: 587650.9366; train_gene_expr_recon_loss: 19407359.7576; train_masked_gp_l1_reg_loss: 94322.1219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53133.8171; train_chrom_access_recon_loss: 6054421.5076; train_global_loss: 26261501.9697; train_optim_loss: 26261501.9697; val_kl_reg_loss: 65576.7964; val_edge_recon_loss: 597929.6719; val_gene_expr_recon_loss: 19552272.2500; val_masked_gp_l1_reg_loss: 94202.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52708.0039; val_chrom_access_recon_loss: 6061859.8125; val_global_loss: 26424548.5000; val_optim_loss: 26424548.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9307; val_auprc_score: 0.9119; val_best_acc_score: 0.8619; val_best_f1_score: 0.8680; train_kl_reg_loss: 66126.1200; train_edge_recon_loss: 725221.5123; train_gene_expr_recon_loss: 18223718.3333; train_masked_gp_l1_reg_loss: 93881.8600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51875.4696; train_chrom_access_recon_loss: 5903733.9167; train_global_loss: 25064557.3030; train_optim_loss: 25064557.3030; val_kl_reg_loss: 28448.0935; val_edge_recon_loss: 747747.0938; val_gene_expr_recon_loss: 18238667.2500; val_masked_gp_l1_reg_loss: 93680.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51914.8906; val_chrom_access_recon_loss: 5766565.7500; val_global_loss: 24927022.5000; val_optim_loss: 24927022.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9328; val_auprc_score: 0.9159; val_best_acc_score: 0.8619; val_best_f1_score: 0.8695; train_kl_reg_loss: 64453.0707; train_edge_recon_loss: 711097.7254; train_gene_expr_recon_loss: 18174159.5455; train_masked_gp_l1_reg_loss: 93475.7299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52090.8687; train_chrom_access_recon_loss: 5751642.9394; train_global_loss: 24846919.6970; train_optim_loss: 24846919.6970; val_kl_reg_loss: 31367.0393; val_edge_recon_loss: 751724.6875; val_gene_expr_recon_loss: 18156553.5000; val_masked_gp_l1_reg_loss: 93214.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52106.3125; val_chrom_access_recon_loss: 5671268.0625; val_global_loss: 24756233.0000; val_optim_loss: 24756233.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9241; val_auprc_score: 0.9076; val_best_acc_score: 0.8455; val_best_f1_score: 0.8563; train_kl_reg_loss: 59486.0189; train_edge_recon_loss: 722523.1184; train_gene_expr_recon_loss: 18159026.4545; train_masked_gp_l1_reg_loss: 92972.8162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52032.0823; train_chrom_access_recon_loss: 5725511.0000; train_global_loss: 24811551.3636; train_optim_loss: 24811551.3636; val_kl_reg_loss: 26378.4492; val_edge_recon_loss: 756557.5000; val_gene_expr_recon_loss: 18124477.0000; val_masked_gp_l1_reg_loss: 92704.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51899.7773; val_chrom_access_recon_loss: 5692932.5625; val_global_loss: 24744949.7500; val_optim_loss: 24744949.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9162; val_auprc_score: 0.8940; val_best_acc_score: 0.8428; val_best_f1_score: 0.8528; train_kl_reg_loss: 51026.4355; train_edge_recon_loss: 730089.0483; train_gene_expr_recon_loss: 18146298.8182; train_masked_gp_l1_reg_loss: 92529.2302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51796.9315; train_chrom_access_recon_loss: 5720694.4091; train_global_loss: 24792435.0000; train_optim_loss: 24792435.0000; val_kl_reg_loss: 22711.1069; val_edge_recon_loss: 749252.0938; val_gene_expr_recon_loss: 18292647.0000; val_masked_gp_l1_reg_loss: 92301.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51678.4141; val_chrom_access_recon_loss: 5736101.5000; val_global_loss: 24944692.0000; val_optim_loss: 24944692.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9130; val_auprc_score: 0.8971; val_best_acc_score: 0.8348; val_best_f1_score: 0.8453; train_kl_reg_loss: 51323.3559; train_edge_recon_loss: 721296.1790; train_gene_expr_recon_loss: 18137957.0303; train_masked_gp_l1_reg_loss: 92050.3162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51573.1732; train_chrom_access_recon_loss: 5717902.1061; train_global_loss: 24772102.3030; train_optim_loss: 24772102.3030; val_kl_reg_loss: 25308.0376; val_edge_recon_loss: 747376.1406; val_gene_expr_recon_loss: 18153671.0000; val_masked_gp_l1_reg_loss: 91770.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51374.6172; val_chrom_access_recon_loss: 5689384.7500; val_global_loss: 24758883.2500; val_optim_loss: 24758883.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9155; val_auprc_score: 0.8953; val_best_acc_score: 0.8326; val_best_f1_score: 0.8484; train_kl_reg_loss: 50642.8035; train_edge_recon_loss: 714647.4460; train_gene_expr_recon_loss: 18138877.3333; train_masked_gp_l1_reg_loss: 91532.1515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51190.6415; train_chrom_access_recon_loss: 5714441.9697; train_global_loss: 24761332.5455; train_optim_loss: 24761332.5455; val_kl_reg_loss: 25762.6841; val_edge_recon_loss: 745229.5000; val_gene_expr_recon_loss: 18211627.5000; val_masked_gp_l1_reg_loss: 91275.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51063.9766; val_chrom_access_recon_loss: 5682056.6250; val_global_loss: 24807016.7500; val_optim_loss: 24807016.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9189; val_auprc_score: 0.9048; val_best_acc_score: 0.8436; val_best_f1_score: 0.8506; train_kl_reg_loss: 49668.2431; train_edge_recon_loss: 716892.5871; train_gene_expr_recon_loss: 18135139.6667; train_masked_gp_l1_reg_loss: 91046.2253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50919.6252; train_chrom_access_recon_loss: 5712548.4318; train_global_loss: 24756214.7576; train_optim_loss: 24756214.7576; val_kl_reg_loss: 23859.1614; val_edge_recon_loss: 739007.9219; val_gene_expr_recon_loss: 18239437.0000; val_masked_gp_l1_reg_loss: 90806.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50763.6758; val_chrom_access_recon_loss: 5693033.8125; val_global_loss: 24836908.0000; val_optim_loss: 24836908.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9202; val_auprc_score: 0.9011; val_best_acc_score: 0.8490; val_best_f1_score: 0.8551; train_kl_reg_loss: 50044.5121; train_edge_recon_loss: 713278.0341; train_gene_expr_recon_loss: 18122543.7273; train_masked_gp_l1_reg_loss: 90647.4053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50053.1516; train_chrom_access_recon_loss: 5710035.2500; train_global_loss: 24736601.9697; train_optim_loss: 24736601.9697; val_kl_reg_loss: 25134.6799; val_edge_recon_loss: 737633.9297; val_gene_expr_recon_loss: 18228213.2500; val_masked_gp_l1_reg_loss: 90562.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49844.0195; val_chrom_access_recon_loss: 5671359.0625; val_global_loss: 24802747.2500; val_optim_loss: 24802747.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9146; val_auprc_score: 0.8920; val_best_acc_score: 0.8418; val_best_f1_score: 0.8503; train_kl_reg_loss: 50452.2352; train_edge_recon_loss: 711719.7519; train_gene_expr_recon_loss: 18114160.3333; train_masked_gp_l1_reg_loss: 90519.4901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49771.5781; train_chrom_access_recon_loss: 5708786.9621; train_global_loss: 24725410.2424; train_optim_loss: 24725410.2424; val_kl_reg_loss: 25814.5886; val_edge_recon_loss: 739518.7969; val_gene_expr_recon_loss: 18116483.2500; val_masked_gp_l1_reg_loss: 90478.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49705.5859; val_chrom_access_recon_loss: 5678234.5625; val_global_loss: 24700234.7500; val_optim_loss: 24700234.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9178; val_auprc_score: 0.8973; val_best_acc_score: 0.8439; val_best_f1_score: 0.8505; train_kl_reg_loss: 50943.4115; train_edge_recon_loss: 710748.3220; train_gene_expr_recon_loss: 18121619.3636; train_masked_gp_l1_reg_loss: 90442.3952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49656.6512; train_chrom_access_recon_loss: 5708634.5227; train_global_loss: 24732044.7273; train_optim_loss: 24732044.7273; val_kl_reg_loss: 26186.0190; val_edge_recon_loss: 739171.6875; val_gene_expr_recon_loss: 18186201.2500; val_masked_gp_l1_reg_loss: 90403.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49610.6953; val_chrom_access_recon_loss: 5711741.2500; val_global_loss: 24803314.5000; val_optim_loss: 24803314.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9208; val_auprc_score: 0.9040; val_best_acc_score: 0.8461; val_best_f1_score: 0.8521; train_kl_reg_loss: 50459.4809; train_edge_recon_loss: 710409.0180; train_gene_expr_recon_loss: 18114913.5455; train_masked_gp_l1_reg_loss: 90372.6789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49577.1569; train_chrom_access_recon_loss: 5703716.1212; train_global_loss: 24719447.9394; train_optim_loss: 24719447.9394; val_kl_reg_loss: 26093.2288; val_edge_recon_loss: 739499.5156; val_gene_expr_recon_loss: 18250159.0000; val_masked_gp_l1_reg_loss: 90337.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49536.5391; val_chrom_access_recon_loss: 5737524.9375; val_global_loss: 24893151.5000; val_optim_loss: 24893151.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9179; val_auprc_score: 0.8972; val_best_acc_score: 0.8452; val_best_f1_score: 0.8513; train_kl_reg_loss: 50679.4029; train_edge_recon_loss: 710001.4375; train_gene_expr_recon_loss: 18113247.3636; train_masked_gp_l1_reg_loss: 90304.1512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49506.3412; train_chrom_access_recon_loss: 5705231.7727; train_global_loss: 24718970.5758; train_optim_loss: 24718970.5758; val_kl_reg_loss: 26163.8696; val_edge_recon_loss: 738516.6328; val_gene_expr_recon_loss: 18274059.7500; val_masked_gp_l1_reg_loss: 90271.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49474.3164; val_chrom_access_recon_loss: 5688570.2500; val_global_loss: 24867056.7500; val_optim_loss: 24867056.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9311; val_auprc_score: 0.9141; val_best_acc_score: 0.8565; val_best_f1_score: 0.8640; train_kl_reg_loss: 50764.3213; train_edge_recon_loss: 708968.7689; train_gene_expr_recon_loss: 18129594.0000; train_masked_gp_l1_reg_loss: 90238.3323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49445.6029; train_chrom_access_recon_loss: 5706762.3106; train_global_loss: 24735773.4242; train_optim_loss: 24735773.4242; val_kl_reg_loss: 25717.3860; val_edge_recon_loss: 735454.8516; val_gene_expr_recon_loss: 18275053.7500; val_masked_gp_l1_reg_loss: 90207.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49417.3008; val_chrom_access_recon_loss: 5657156.0625; val_global_loss: 24833008.5000; val_optim_loss: 24833008.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9192; val_auprc_score: 0.8999; val_best_acc_score: 0.8469; val_best_f1_score: 0.8527; train_kl_reg_loss: 50168.6471; train_edge_recon_loss: 709894.7140; train_gene_expr_recon_loss: 18114340.0606; train_masked_gp_l1_reg_loss: 90191.4054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49342.8565; train_chrom_access_recon_loss: 5706716.5227; train_global_loss: 24720654.3333; train_optim_loss: 24720654.3333; val_kl_reg_loss: 25761.5000; val_edge_recon_loss: 738246.5469; val_gene_expr_recon_loss: 18171216.5000; val_masked_gp_l1_reg_loss: 90182.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49323.0664; val_chrom_access_recon_loss: 5677370.1250; val_global_loss: 24752100.7500; val_optim_loss: 24752100.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9165; val_auprc_score: 0.8966; val_best_acc_score: 0.8439; val_best_f1_score: 0.8501; train_kl_reg_loss: 50290.8911; train_edge_recon_loss: 710243.8125; train_gene_expr_recon_loss: 18125591.3333; train_masked_gp_l1_reg_loss: 90177.1495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49316.7634; train_chrom_access_recon_loss: 5707853.1970; train_global_loss: 24733472.9394; train_optim_loss: 24733472.9394; val_kl_reg_loss: 25836.2439; val_edge_recon_loss: 739232.2969; val_gene_expr_recon_loss: 18120344.5000; val_masked_gp_l1_reg_loss: 90171.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49310.6328; val_chrom_access_recon_loss: 5673578.8125; val_global_loss: 24698474.2500; val_optim_loss: 24698474.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9213; val_auprc_score: 0.9045; val_best_acc_score: 0.8452; val_best_f1_score: 0.8522; train_kl_reg_loss: 50367.3466; train_edge_recon_loss: 709180.0758; train_gene_expr_recon_loss: 18112227.8485; train_masked_gp_l1_reg_loss: 90167.0823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49305.6022; train_chrom_access_recon_loss: 5703113.6439; train_global_loss: 24714361.7879; train_optim_loss: 24714361.7879; val_kl_reg_loss: 25972.2053; val_edge_recon_loss: 738925.4219; val_gene_expr_recon_loss: 18129396.7500; val_masked_gp_l1_reg_loss: 90162.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49300.6211; val_chrom_access_recon_loss: 5628820.1250; val_global_loss: 24662576.2500; val_optim_loss: 24662576.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9136; val_auprc_score: 0.8918; val_best_acc_score: 0.8409; val_best_f1_score: 0.8492; train_kl_reg_loss: 50448.8104; train_edge_recon_loss: 709935.0606; train_gene_expr_recon_loss: 18120659.2727; train_masked_gp_l1_reg_loss: 90158.0935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49296.6045; train_chrom_access_recon_loss: 5704203.5985; train_global_loss: 24724701.3333; train_optim_loss: 24724701.3333; val_kl_reg_loss: 26120.1816; val_edge_recon_loss: 738387.0938; val_gene_expr_recon_loss: 18214747.5000; val_masked_gp_l1_reg_loss: 90153.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49292.4609; val_chrom_access_recon_loss: 5677117.7500; val_global_loss: 24795817.7500; val_optim_loss: 24795817.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9155; val_auprc_score: 0.8958; val_best_acc_score: 0.8399; val_best_f1_score: 0.8473; train_kl_reg_loss: 50425.8055; train_edge_recon_loss: 709340.3210; train_gene_expr_recon_loss: 18104236.0606; train_masked_gp_l1_reg_loss: 90149.4197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49288.8561; train_chrom_access_recon_loss: 5701805.7652; train_global_loss: 24705246.4848; train_optim_loss: 24705246.4848; val_kl_reg_loss: 26052.4749; val_edge_recon_loss: 736988.2656; val_gene_expr_recon_loss: 18218645.0000; val_masked_gp_l1_reg_loss: 90145.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49285.4844; val_chrom_access_recon_loss: 5705701.8125; val_global_loss: 24826819.2500; val_optim_loss: 24826819.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9215; val_auprc_score: 0.9066; val_best_acc_score: 0.8485; val_best_f1_score: 0.8537; train_kl_reg_loss: 50401.2859; train_edge_recon_loss: 709194.8958; train_gene_expr_recon_loss: 18120944.2121; train_masked_gp_l1_reg_loss: 90141.0851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49281.9215; train_chrom_access_recon_loss: 5706047.8333; train_global_loss: 24726011.3333; train_optim_loss: 24726011.3333; val_kl_reg_loss: 26134.0120; val_edge_recon_loss: 737465.8516; val_gene_expr_recon_loss: 18274537.2500; val_masked_gp_l1_reg_loss: 90136.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49278.1055; val_chrom_access_recon_loss: 5729790.5625; val_global_loss: 24907342.2500; val_optim_loss: 24907342.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9216; val_auprc_score: 0.8993; val_best_acc_score: 0.8514; val_best_f1_score: 0.8571; train_kl_reg_loss: 50485.8999; train_edge_recon_loss: 708896.6061; train_gene_expr_recon_loss: 18111792.0909; train_masked_gp_l1_reg_loss: 90132.7383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49275.4837; train_chrom_access_recon_loss: 5702960.9015; train_global_loss: 24713543.7576; train_optim_loss: 24713543.7576; val_kl_reg_loss: 26124.3010; val_edge_recon_loss: 736959.4453; val_gene_expr_recon_loss: 18222477.0000; val_masked_gp_l1_reg_loss: 90128.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49271.5625; val_chrom_access_recon_loss: 5668890.8750; val_global_loss: 24793851.5000; val_optim_loss: 24793851.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9229; val_auprc_score: 0.9100; val_best_acc_score: 0.8479; val_best_f1_score: 0.8560; train_kl_reg_loss: 50396.9955; train_edge_recon_loss: 709333.6837; train_gene_expr_recon_loss: 18120227.6061; train_masked_gp_l1_reg_loss: 90126.6055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49263.9401; train_chrom_access_recon_loss: 5706776.7121; train_global_loss: 24726125.3333; train_optim_loss: 24726125.3333; val_kl_reg_loss: 26101.7559; val_edge_recon_loss: 734538.5938; val_gene_expr_recon_loss: 18139962.0000; val_masked_gp_l1_reg_loss: 90125.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49261.8945; val_chrom_access_recon_loss: 5682606.2500; val_global_loss: 24722597.0000; val_optim_loss: 24722597.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9155; val_auprc_score: 0.8970; val_best_acc_score: 0.8452; val_best_f1_score: 0.8509; train_kl_reg_loss: 50382.4371; train_edge_recon_loss: 709070.8523; train_gene_expr_recon_loss: 18115234.6061; train_masked_gp_l1_reg_loss: 90125.0582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49261.2637; train_chrom_access_recon_loss: 5704817.9621; train_global_loss: 24718892.4848; train_optim_loss: 24718892.4848; val_kl_reg_loss: 26040.0017; val_edge_recon_loss: 738046.0703; val_gene_expr_recon_loss: 18203110.2500; val_masked_gp_l1_reg_loss: 90124.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49260.6914; val_chrom_access_recon_loss: 5682004.5625; val_global_loss: 24788585.0000; val_optim_loss: 24788585.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9186; val_auprc_score: 0.9046; val_best_acc_score: 0.8385; val_best_f1_score: 0.8459; train_kl_reg_loss: 50329.2624; train_edge_recon_loss: 709662.0511; train_gene_expr_recon_loss: 18091656.1818; train_masked_gp_l1_reg_loss: 90123.9588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49260.2310; train_chrom_access_recon_loss: 5698309.3561; train_global_loss: 24689340.8182; train_optim_loss: 24689340.8182; val_kl_reg_loss: 25907.4268; val_edge_recon_loss: 737920.9375; val_gene_expr_recon_loss: 18250881.5000; val_masked_gp_l1_reg_loss: 90123.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49259.7188; val_chrom_access_recon_loss: 5695843.1875; val_global_loss: 24849937.2500; val_optim_loss: 24849937.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9145; val_auprc_score: 0.8924; val_best_acc_score: 0.8415; val_best_f1_score: 0.8498; train_kl_reg_loss: 50388.4915; train_edge_recon_loss: 708729.2273; train_gene_expr_recon_loss: 18107921.4545; train_masked_gp_l1_reg_loss: 90122.9233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49259.3332; train_chrom_access_recon_loss: 5703684.0606; train_global_loss: 24710105.7273; train_optim_loss: 24710105.7273; val_kl_reg_loss: 25926.4917; val_edge_recon_loss: 736089.9766; val_gene_expr_recon_loss: 18244960.7500; val_masked_gp_l1_reg_loss: 90122.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49258.8789; val_chrom_access_recon_loss: 5675657.5625; val_global_loss: 24822014.7500; val_optim_loss: 24822014.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 51 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9143
val AUPRC score: 0.8950
val best accuracy score: 0.8423
val best F1 score: 0.8488
val target rna MSE score: 1.6838
val source rna MSE score: 0.9030
val target atac MSE score: 0.3168
val source atac MSE score: 0.1341
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
