[True]
Run timestamp: 07082023_233428_48.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_48']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5399 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 5399, n_cat_covariates_embed_input: 0, n_hidden: 1847, n_latent: 1797, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8940; val_auprc_score: 0.9782; val_best_acc_score: 0.8576; val_best_f1_score: 0.9228; train_kl_reg_loss: 140154.0293; train_edge_recon_loss: 11850.6932; train_gene_expr_recon_loss: 3753252.4784; train_masked_gp_l1_reg_loss: 18693.1966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176005.0104; train_global_loss: 4099955.3942; train_optim_loss: 4099955.3942; val_kl_reg_loss: 123500.8184; val_edge_recon_loss: 12048.5638; val_gene_expr_recon_loss: 2908325.8542; val_masked_gp_l1_reg_loss: 16209.5420; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 166735.5938; val_global_loss: 3226820.2708; val_optim_loss: 3226820.2708
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8755; val_auprc_score: 0.9732; val_best_acc_score: 0.8905; val_best_f1_score: 0.9386; train_kl_reg_loss: 102902.3754; train_edge_recon_loss: 11893.2028; train_gene_expr_recon_loss: 2591291.5553; train_masked_gp_l1_reg_loss: 14704.0711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154198.7441; train_global_loss: 2874989.9231; train_optim_loss: 2874989.9231; val_kl_reg_loss: 87088.7741; val_edge_recon_loss: 11862.4472; val_gene_expr_recon_loss: 2333981.9583; val_masked_gp_l1_reg_loss: 13649.2363; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141162.3281; val_global_loss: 2587744.6875; val_optim_loss: 2587744.6875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8927; val_auprc_score: 0.9764; val_best_acc_score: 0.8904; val_best_f1_score: 0.9362; train_kl_reg_loss: 79404.5541; train_edge_recon_loss: 11823.8469; train_gene_expr_recon_loss: 2290233.8486; train_masked_gp_l1_reg_loss: 13167.7040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128731.2060; train_global_loss: 2523361.1659; train_optim_loss: 2523361.1659; val_kl_reg_loss: 70547.4238; val_edge_recon_loss: 11946.3539; val_gene_expr_recon_loss: 2252160.4583; val_masked_gp_l1_reg_loss: 12864.6348; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116496.6797; val_global_loss: 2464015.7083; val_optim_loss: 2464015.7083
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9081; val_auprc_score: 0.9801; val_best_acc_score: 0.8957; val_best_f1_score: 0.9419; train_kl_reg_loss: 66163.1246; train_edge_recon_loss: 11689.8506; train_gene_expr_recon_loss: 2221308.1010; train_masked_gp_l1_reg_loss: 12790.8494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105744.0106; train_global_loss: 2417695.9423; train_optim_loss: 2417695.9423; val_kl_reg_loss: 60708.4346; val_edge_recon_loss: 11801.8287; val_gene_expr_recon_loss: 2192842.0625; val_masked_gp_l1_reg_loss: 12787.8496; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95511.8125; val_global_loss: 2373651.8542; val_optim_loss: 2373651.8542
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9188; val_auprc_score: 0.9826; val_best_acc_score: 0.9101; val_best_f1_score: 0.9494; train_kl_reg_loss: 57928.8100; train_edge_recon_loss: 11759.2211; train_gene_expr_recon_loss: 2167573.3702; train_masked_gp_l1_reg_loss: 12868.0400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86911.3288; train_global_loss: 2337040.7740; train_optim_loss: 2337040.7740; val_kl_reg_loss: 54054.3708; val_edge_recon_loss: 11643.0948; val_gene_expr_recon_loss: 2143773.4375; val_masked_gp_l1_reg_loss: 12962.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78791.7891; val_global_loss: 2301225.3750; val_optim_loss: 2301225.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9258; val_auprc_score: 0.9842; val_best_acc_score: 0.9197; val_best_f1_score: 0.9542; train_kl_reg_loss: 52252.6031; train_edge_recon_loss: 11635.5059; train_gene_expr_recon_loss: 2122551.2945; train_masked_gp_l1_reg_loss: 13075.3959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71975.8299; train_global_loss: 2271490.6202; train_optim_loss: 2271490.6202; val_kl_reg_loss: 49190.6686; val_edge_recon_loss: 11679.1935; val_gene_expr_recon_loss: 2102888.6771; val_masked_gp_l1_reg_loss: 13195.2090; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65549.7812; val_global_loss: 2242503.5417; val_optim_loss: 2242503.5417
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9361; val_auprc_score: 0.9864; val_best_acc_score: 0.9266; val_best_f1_score: 0.9578; train_kl_reg_loss: 47949.3538; train_edge_recon_loss: 11561.8598; train_gene_expr_recon_loss: 2085585.0240; train_masked_gp_l1_reg_loss: 13319.1236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60187.9470; train_global_loss: 2218603.2957; train_optim_loss: 2218603.2957; val_kl_reg_loss: 45674.1354; val_edge_recon_loss: 11589.9422; val_gene_expr_recon_loss: 2066812.2708; val_masked_gp_l1_reg_loss: 13449.1943; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55153.9219; val_global_loss: 2192679.6042; val_optim_loss: 2192679.6042
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9396; val_auprc_score: 0.9867; val_best_acc_score: 0.9283; val_best_f1_score: 0.9583; train_kl_reg_loss: 44549.0927; train_edge_recon_loss: 11597.2211; train_gene_expr_recon_loss: 2052685.2067; train_masked_gp_l1_reg_loss: 13580.0013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50958.0359; train_global_loss: 2173369.5457; train_optim_loss: 2173369.5457; val_kl_reg_loss: 42686.8551; val_edge_recon_loss: 11768.1534; val_gene_expr_recon_loss: 2035492.1875; val_masked_gp_l1_reg_loss: 13708.7354; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47004.4141; val_global_loss: 2150660.3542; val_optim_loss: 2150660.3542
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9425; val_auprc_score: 0.9878; val_best_acc_score: 0.9294; val_best_f1_score: 0.9590; train_kl_reg_loss: 41797.0645; train_edge_recon_loss: 11504.0046; train_gene_expr_recon_loss: 2023134.5901; train_masked_gp_l1_reg_loss: 13826.5964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43685.8374; train_global_loss: 2133948.1010; train_optim_loss: 2133948.1010; val_kl_reg_loss: 40221.0710; val_edge_recon_loss: 11306.1143; val_gene_expr_recon_loss: 2008802.8854; val_masked_gp_l1_reg_loss: 13948.4277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40550.8984; val_global_loss: 2114829.3750; val_optim_loss: 2114829.3750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9487; val_auprc_score: 0.9890; val_best_acc_score: 0.9295; val_best_f1_score: 0.9597; train_kl_reg_loss: 39515.6483; train_edge_recon_loss: 11445.9202; train_gene_expr_recon_loss: 1996010.0685; train_masked_gp_l1_reg_loss: 14063.8433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37919.6936; train_global_loss: 2098955.1779; train_optim_loss: 2098955.1779; val_kl_reg_loss: 37897.8675; val_edge_recon_loss: 11576.1197; val_gene_expr_recon_loss: 1983327.7188; val_masked_gp_l1_reg_loss: 14176.6660; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35446.2266; val_global_loss: 2082424.5938; val_optim_loss: 2082424.5938
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9517; val_auprc_score: 0.9902; val_best_acc_score: 0.9337; val_best_f1_score: 0.9622; train_kl_reg_loss: 37505.8769; train_edge_recon_loss: 11410.8886; train_gene_expr_recon_loss: 1971284.6058; train_masked_gp_l1_reg_loss: 14286.6895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33341.3678; train_global_loss: 2067829.4267; train_optim_loss: 2067829.4267; val_kl_reg_loss: 35991.1953; val_edge_recon_loss: 11253.1050; val_gene_expr_recon_loss: 1961462.0208; val_masked_gp_l1_reg_loss: 14393.1494; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31366.3398; val_global_loss: 2054465.8333; val_optim_loss: 2054465.8333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9535; val_auprc_score: 0.9899; val_best_acc_score: 0.9350; val_best_f1_score: 0.9627; train_kl_reg_loss: 35749.3029; train_edge_recon_loss: 11405.6221; train_gene_expr_recon_loss: 1948624.6611; train_masked_gp_l1_reg_loss: 14486.4403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29696.4496; train_global_loss: 2039962.4760; train_optim_loss: 2039962.4760; val_kl_reg_loss: 34859.2008; val_edge_recon_loss: 11577.4567; val_gene_expr_recon_loss: 1936974.8646; val_masked_gp_l1_reg_loss: 14573.5723; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28127.1895; val_global_loss: 2026112.3854; val_optim_loss: 2026112.3854
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9547; val_auprc_score: 0.9902; val_best_acc_score: 0.9377; val_best_f1_score: 0.9641; train_kl_reg_loss: 34151.3027; train_edge_recon_loss: 11406.2907; train_gene_expr_recon_loss: 1927476.8401; train_masked_gp_l1_reg_loss: 14657.1126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26796.9539; train_global_loss: 2014488.4988; train_optim_loss: 2014488.4988; val_kl_reg_loss: 32908.2664; val_edge_recon_loss: 11466.7415; val_gene_expr_recon_loss: 1916771.3125; val_masked_gp_l1_reg_loss: 14738.3350; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25545.5664; val_global_loss: 2001430.3125; val_optim_loss: 2001430.3125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9586; val_auprc_score: 0.9913; val_best_acc_score: 0.9391; val_best_f1_score: 0.9648; train_kl_reg_loss: 32694.6376; train_edge_recon_loss: 11358.6057; train_gene_expr_recon_loss: 1907054.6286; train_masked_gp_l1_reg_loss: 14810.4032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24436.7322; train_global_loss: 1990355.0108; train_optim_loss: 1990355.0108; val_kl_reg_loss: 31797.3848; val_edge_recon_loss: 11391.0281; val_gene_expr_recon_loss: 1896792.3958; val_masked_gp_l1_reg_loss: 14881.6006; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23389.5859; val_global_loss: 1978252.0729; val_optim_loss: 1978252.0729
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9565; val_auprc_score: 0.9907; val_best_acc_score: 0.9400; val_best_f1_score: 0.9652; train_kl_reg_loss: 31365.7479; train_edge_recon_loss: 11268.4572; train_gene_expr_recon_loss: 1888139.4519; train_masked_gp_l1_reg_loss: 14943.4882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22460.5536; train_global_loss: 1968177.7043; train_optim_loss: 1968177.7043; val_kl_reg_loss: 30438.7686; val_edge_recon_loss: 11401.9989; val_gene_expr_recon_loss: 1878706.1250; val_masked_gp_l1_reg_loss: 15003.3379; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21570.6934; val_global_loss: 1957121.0104; val_optim_loss: 1957121.0104
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9595; val_auprc_score: 0.9913; val_best_acc_score: 0.9401; val_best_f1_score: 0.9651; train_kl_reg_loss: 30099.6021; train_edge_recon_loss: 11315.7022; train_gene_expr_recon_loss: 1870576.8149; train_masked_gp_l1_reg_loss: 15054.3996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20767.3006; train_global_loss: 1947813.8137; train_optim_loss: 1947813.8137; val_kl_reg_loss: 28911.4810; val_edge_recon_loss: 11490.5942; val_gene_expr_recon_loss: 1861940.8438; val_masked_gp_l1_reg_loss: 15099.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20008.0039; val_global_loss: 1937450.7917; val_optim_loss: 1937450.7917
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9583; val_auprc_score: 0.9912; val_best_acc_score: 0.9404; val_best_f1_score: 0.9653; train_kl_reg_loss: 28913.7221; train_edge_recon_loss: 11202.2035; train_gene_expr_recon_loss: 1853780.7175; train_masked_gp_l1_reg_loss: 15141.4177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19315.7099; train_global_loss: 1928353.7776; train_optim_loss: 1928353.7776; val_kl_reg_loss: 28071.1253; val_edge_recon_loss: 11332.1929; val_gene_expr_recon_loss: 1845883.3542; val_masked_gp_l1_reg_loss: 15176.9316; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18660.0273; val_global_loss: 1919123.5521; val_optim_loss: 1919123.5521
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9618; val_auprc_score: 0.9919; val_best_acc_score: 0.9420; val_best_f1_score: 0.9667; train_kl_reg_loss: 27797.1199; train_edge_recon_loss: 11172.0903; train_gene_expr_recon_loss: 1837658.7825; train_masked_gp_l1_reg_loss: 15211.4116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18071.3059; train_global_loss: 1909910.7151; train_optim_loss: 1909910.7151; val_kl_reg_loss: 26438.4036; val_edge_recon_loss: 11353.4204; val_gene_expr_recon_loss: 1829845.0208; val_masked_gp_l1_reg_loss: 15241.1973; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17521.3320; val_global_loss: 1900399.4688; val_optim_loss: 1900399.4688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9638; val_auprc_score: 0.9924; val_best_acc_score: 0.9434; val_best_f1_score: 0.9673; train_kl_reg_loss: 26758.7400; train_edge_recon_loss: 11189.0633; train_gene_expr_recon_loss: 1821941.4976; train_masked_gp_l1_reg_loss: 15261.5596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17014.3705; train_global_loss: 1892165.2332; train_optim_loss: 1892165.2332; val_kl_reg_loss: 26222.7228; val_edge_recon_loss: 11356.7410; val_gene_expr_recon_loss: 1816285.7188; val_masked_gp_l1_reg_loss: 15281.7979; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16549.1367; val_global_loss: 1885696.0625; val_optim_loss: 1885696.0625
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9648; val_auprc_score: 0.9926; val_best_acc_score: 0.9457; val_best_f1_score: 0.9686; train_kl_reg_loss: 25758.8643; train_edge_recon_loss: 11151.0647; train_gene_expr_recon_loss: 1808046.7776; train_masked_gp_l1_reg_loss: 15291.8540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16120.9345; train_global_loss: 1876369.4916; train_optim_loss: 1876369.4916; val_kl_reg_loss: 24851.4585; val_edge_recon_loss: 11249.2489; val_gene_expr_recon_loss: 1801220.4271; val_masked_gp_l1_reg_loss: 15296.6104; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15728.6279; val_global_loss: 1868346.4062; val_optim_loss: 1868346.4062
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9642; val_auprc_score: 0.9923; val_best_acc_score: 0.9464; val_best_f1_score: 0.9689; train_kl_reg_loss: 24784.3698; train_edge_recon_loss: 11044.8254; train_gene_expr_recon_loss: 1793662.6743; train_masked_gp_l1_reg_loss: 15294.0924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15364.0501; train_global_loss: 1860150.0120; train_optim_loss: 1860150.0120; val_kl_reg_loss: 23987.3122; val_edge_recon_loss: 11279.3314; val_gene_expr_recon_loss: 1786054.5729; val_masked_gp_l1_reg_loss: 15289.7861; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15023.3281; val_global_loss: 1851634.3333; val_optim_loss: 1851634.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9659; val_auprc_score: 0.9926; val_best_acc_score: 0.9481; val_best_f1_score: 0.9699; train_kl_reg_loss: 23874.5296; train_edge_recon_loss: 11016.2498; train_gene_expr_recon_loss: 1780448.8978; train_masked_gp_l1_reg_loss: 15275.8562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14722.3464; train_global_loss: 1845337.8810; train_optim_loss: 1845337.8810; val_kl_reg_loss: 23205.0614; val_edge_recon_loss: 10982.8226; val_gene_expr_recon_loss: 1772458.6042; val_masked_gp_l1_reg_loss: 15264.6279; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14448.4951; val_global_loss: 1836359.6458; val_optim_loss: 1836359.6458
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9660; val_auprc_score: 0.9927; val_best_acc_score: 0.9470; val_best_f1_score: 0.9691; train_kl_reg_loss: 23028.1341; train_edge_recon_loss: 10989.9827; train_gene_expr_recon_loss: 1767480.3990; train_masked_gp_l1_reg_loss: 15231.6363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14167.4940; train_global_loss: 1830897.6490; train_optim_loss: 1830897.6490; val_kl_reg_loss: 22155.8151; val_edge_recon_loss: 11111.4683; val_gene_expr_recon_loss: 1760839.3958; val_masked_gp_l1_reg_loss: 15203.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13906.1426; val_global_loss: 1823215.9271; val_optim_loss: 1823215.9271
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9643; val_auprc_score: 0.9919; val_best_acc_score: 0.9465; val_best_f1_score: 0.9690; train_kl_reg_loss: 22154.1502; train_edge_recon_loss: 10983.4565; train_gene_expr_recon_loss: 1755355.4567; train_masked_gp_l1_reg_loss: 15162.4428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13668.6486; train_global_loss: 1817324.1502; train_optim_loss: 1817324.1502; val_kl_reg_loss: 21163.0638; val_edge_recon_loss: 11147.6200; val_gene_expr_recon_loss: 1750951.6562; val_masked_gp_l1_reg_loss: 15122.7432; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13455.3789; val_global_loss: 1811840.4583; val_optim_loss: 1811840.4583
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9670; val_auprc_score: 0.9932; val_best_acc_score: 0.9493; val_best_f1_score: 0.9707; train_kl_reg_loss: 21337.9376; train_edge_recon_loss: 10876.5876; train_gene_expr_recon_loss: 1743920.0168; train_masked_gp_l1_reg_loss: 15068.3306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13248.2415; train_global_loss: 1804451.1082; train_optim_loss: 1804451.1082; val_kl_reg_loss: 20058.5508; val_edge_recon_loss: 10946.8761; val_gene_expr_recon_loss: 1740507.0417; val_masked_gp_l1_reg_loss: 15021.3330; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13075.0830; val_global_loss: 1799608.9688; val_optim_loss: 1799608.9688
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9574; val_auprc_score: 0.9913; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 1225067265.7526; train_edge_recon_loss: 11751.0979; train_gene_expr_recon_loss: 60149459.5577; train_masked_gp_l1_reg_loss: 15208.0660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10193.0882; train_global_loss: 1285253878.5048; train_optim_loss: 1285253878.5048; val_kl_reg_loss: 846113.4948; val_edge_recon_loss: 11899.3641; val_gene_expr_recon_loss: 31892554.0000; val_masked_gp_l1_reg_loss: 14364.2588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7973.7720; val_global_loss: 32772905.1667; val_optim_loss: 32772905.1667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9572; val_auprc_score: 0.9909; val_best_acc_score: 0.8520; val_best_f1_score: 0.9201; train_kl_reg_loss: 677374.8233; train_edge_recon_loss: 11985.7250; train_gene_expr_recon_loss: 32208375.9231; train_masked_gp_l1_reg_loss: 13563.2933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6893.1423; train_global_loss: 32918192.9615; train_optim_loss: 32918192.9615; val_kl_reg_loss: 478838.0469; val_edge_recon_loss: 12025.6629; val_gene_expr_recon_loss: 28261214.0000; val_masked_gp_l1_reg_loss: 12953.7393; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6041.3730; val_global_loss: 28771073.8333; val_optim_loss: 28771073.8333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9574; val_auprc_score: 0.9914; val_best_acc_score: 0.8550; val_best_f1_score: 0.9218; train_kl_reg_loss: 328903.4983; train_edge_recon_loss: 11958.6099; train_gene_expr_recon_loss: 8887714.7019; train_masked_gp_l1_reg_loss: 13561.5532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5494.5306; train_global_loss: 9247632.9639; train_optim_loss: 9247632.9639; val_kl_reg_loss: 258605.0599; val_edge_recon_loss: 11780.1963; val_gene_expr_recon_loss: 3122486.6458; val_masked_gp_l1_reg_loss: 13826.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5022.5498; val_global_loss: 3411720.9167; val_optim_loss: 3411720.9167
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9558; val_auprc_score: 0.9909; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 243477.3268; train_edge_recon_loss: 11920.2098; train_gene_expr_recon_loss: 2839371.1562; train_masked_gp_l1_reg_loss: 13439.1412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4663.2663; train_global_loss: 3112871.1010; train_optim_loss: 3112871.1010; val_kl_reg_loss: 220524.3294; val_edge_recon_loss: 11996.1008; val_gene_expr_recon_loss: 2727857.2917; val_masked_gp_l1_reg_loss: 13044.4287; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4332.8965; val_global_loss: 2977755.2083; val_optim_loss: 2977755.2083

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9561; val_auprc_score: 0.9911; val_best_acc_score: 0.8534; val_best_f1_score: 0.9209; train_kl_reg_loss: 223951.6855; train_edge_recon_loss: 12016.2844; train_gene_expr_recon_loss: 2714383.4688; train_masked_gp_l1_reg_loss: 12918.5889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4178.7873; train_global_loss: 2967448.8317; train_optim_loss: 2967448.8317; val_kl_reg_loss: 217993.4635; val_edge_recon_loss: 11919.1075; val_gene_expr_recon_loss: 2715251.3750; val_masked_gp_l1_reg_loss: 12869.2764; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4135.9214; val_global_loss: 2962169.2083; val_optim_loss: 2962169.2083
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9563; val_auprc_score: 0.9910; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 220806.7716; train_edge_recon_loss: 12019.5445; train_gene_expr_recon_loss: 2701720.7524; train_masked_gp_l1_reg_loss: 12829.3058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4106.1944; train_global_loss: 2951482.5769; train_optim_loss: 2951482.5769; val_kl_reg_loss: 214770.4375; val_edge_recon_loss: 12016.8375; val_gene_expr_recon_loss: 2700380.5208; val_masked_gp_l1_reg_loss: 12787.4434; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4075.1257; val_global_loss: 2944030.5625; val_optim_loss: 2944030.5625
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9579; val_auprc_score: 0.9912; val_best_acc_score: 0.8528; val_best_f1_score: 0.9206; train_kl_reg_loss: 217766.4578; train_edge_recon_loss: 11990.1872; train_gene_expr_recon_loss: 2689575.4014; train_masked_gp_l1_reg_loss: 12745.6725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4044.9489; train_global_loss: 2936122.6755; train_optim_loss: 2936122.6755; val_kl_reg_loss: 212111.5560; val_edge_recon_loss: 11956.9183; val_gene_expr_recon_loss: 2691445.5417; val_masked_gp_l1_reg_loss: 12702.4209; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4013.8770; val_global_loss: 2932230.5208; val_optim_loss: 2932230.5208
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9566; val_auprc_score: 0.9909; val_best_acc_score: 0.8522; val_best_f1_score: 0.9202; train_kl_reg_loss: 214678.6665; train_edge_recon_loss: 11963.4993; train_gene_expr_recon_loss: 2679191.9880; train_masked_gp_l1_reg_loss: 12658.3707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3982.5795; train_global_loss: 2922475.1298; train_optim_loss: 2922475.1298; val_kl_reg_loss: 209084.9375; val_edge_recon_loss: 12033.8195; val_gene_expr_recon_loss: 2681216.1458; val_masked_gp_l1_reg_loss: 12612.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3950.5972; val_global_loss: 2918897.8958; val_optim_loss: 2918897.8958

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 92 min 8 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9624
val AUPRC score: 0.9919
val best accuracy score: 0.9408
val best F1 score: 0.9659
val target rna MSE score: 27.1591
val source rna MSE score: 216.1249
Val cat covariate0 mean sim diff: -0.0006

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
