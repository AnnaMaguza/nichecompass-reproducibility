[True]
Run timestamp: 01082023_081018_48.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_48']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9021; val_auprc_score: 0.9816; val_best_acc_score: 0.8568; val_best_f1_score: 0.9227; train_kl_reg_loss: 21857.3848; train_edge_recon_loss: 109514.1642; train_gene_expr_recon_loss: 532293.9925; train_masked_gp_l1_reg_loss: 9566.7485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115024.5240; train_global_loss: 788256.8113; train_optim_loss: 788256.8113; val_kl_reg_loss: 15554.5711; val_edge_recon_loss: 118000.3190; val_gene_expr_recon_loss: 431831.0469; val_masked_gp_l1_reg_loss: 7962.4224; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102948.5781; val_global_loss: 676296.9375; val_optim_loss: 676296.9375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8957; val_auprc_score: 0.9805; val_best_acc_score: 0.8601; val_best_f1_score: 0.9242; train_kl_reg_loss: 14564.9328; train_edge_recon_loss: 108145.9054; train_gene_expr_recon_loss: 369572.6684; train_masked_gp_l1_reg_loss: 7245.1492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93326.4012; train_global_loss: 592855.0556; train_optim_loss: 592855.0556; val_kl_reg_loss: 13260.2798; val_edge_recon_loss: 119376.4206; val_gene_expr_recon_loss: 302110.3750; val_masked_gp_l1_reg_loss: 6792.0596; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84020.3203; val_global_loss: 525559.4583; val_optim_loss: 525559.4583
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8644; val_auprc_score: 0.9715; val_best_acc_score: 0.8734; val_best_f1_score: 0.9296; train_kl_reg_loss: 13802.9397; train_edge_recon_loss: 109105.8578; train_gene_expr_recon_loss: 270440.1904; train_masked_gp_l1_reg_loss: 6613.9710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75279.6301; train_global_loss: 475242.5903; train_optim_loss: 475242.5903; val_kl_reg_loss: 13047.5236; val_edge_recon_loss: 123208.2734; val_gene_expr_recon_loss: 252235.5339; val_masked_gp_l1_reg_loss: 6506.7524; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66250.9141; val_global_loss: 461248.9896; val_optim_loss: 461248.9896
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8471; val_auprc_score: 0.9687; val_best_acc_score: 0.8797; val_best_f1_score: 0.9330; train_kl_reg_loss: 12966.5741; train_edge_recon_loss: 107516.9763; train_gene_expr_recon_loss: 246571.3773; train_masked_gp_l1_reg_loss: 6508.3032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58233.4247; train_global_loss: 431796.6557; train_optim_loss: 431796.6557; val_kl_reg_loss: 12064.9546; val_edge_recon_loss: 117831.3958; val_gene_expr_recon_loss: 241748.1432; val_masked_gp_l1_reg_loss: 6544.6465; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50510.7578; val_global_loss: 428699.9010; val_optim_loss: 428699.9010
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8401; val_auprc_score: 0.9645; val_best_acc_score: 0.8814; val_best_f1_score: 0.9346; train_kl_reg_loss: 12224.4491; train_edge_recon_loss: 106973.3898; train_gene_expr_recon_loss: 239628.1267; train_masked_gp_l1_reg_loss: 6626.8997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44358.8305; train_global_loss: 409811.6968; train_optim_loss: 409811.6968; val_kl_reg_loss: 11739.5659; val_edge_recon_loss: 108429.7812; val_gene_expr_recon_loss: 237228.4609; val_masked_gp_l1_reg_loss: 6734.2002; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38684.5781; val_global_loss: 402816.5625; val_optim_loss: 402816.5625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8442; val_auprc_score: 0.9633; val_best_acc_score: 0.8877; val_best_f1_score: 0.9370; train_kl_reg_loss: 12891.9570; train_edge_recon_loss: 101824.2956; train_gene_expr_recon_loss: 235229.9233; train_masked_gp_l1_reg_loss: 6849.6125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34580.4732; train_global_loss: 391376.2622; train_optim_loss: 391376.2622; val_kl_reg_loss: 12674.3786; val_edge_recon_loss: 103779.7279; val_gene_expr_recon_loss: 232868.2578; val_masked_gp_l1_reg_loss: 6961.2793; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31013.0469; val_global_loss: 387296.6979; val_optim_loss: 387296.6979
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8420; val_auprc_score: 0.9634; val_best_acc_score: 0.8910; val_best_f1_score: 0.9394; train_kl_reg_loss: 12928.4057; train_edge_recon_loss: 98441.5252; train_gene_expr_recon_loss: 231410.0252; train_masked_gp_l1_reg_loss: 7040.0597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28298.0088; train_global_loss: 378118.0208; train_optim_loss: 378118.0208; val_kl_reg_loss: 12366.1064; val_edge_recon_loss: 100233.7656; val_gene_expr_recon_loss: 229388.5833; val_masked_gp_l1_reg_loss: 7111.4277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25704.6270; val_global_loss: 374804.5104; val_optim_loss: 374804.5104
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8598; val_auprc_score: 0.9682; val_best_acc_score: 0.8971; val_best_f1_score: 0.9424; train_kl_reg_loss: 12714.3248; train_edge_recon_loss: 97522.4663; train_gene_expr_recon_loss: 228256.8255; train_masked_gp_l1_reg_loss: 7168.5745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23577.6467; train_global_loss: 369239.8351; train_optim_loss: 369239.8351; val_kl_reg_loss: 12308.4723; val_edge_recon_loss: 99789.9180; val_gene_expr_recon_loss: 227102.9349; val_masked_gp_l1_reg_loss: 7224.1934; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21547.5273; val_global_loss: 367973.0521; val_optim_loss: 367973.0521
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8671; val_auprc_score: 0.9708; val_best_acc_score: 0.9030; val_best_f1_score: 0.9457; train_kl_reg_loss: 12610.2148; train_edge_recon_loss: 95384.1655; train_gene_expr_recon_loss: 225394.9450; train_masked_gp_l1_reg_loss: 7266.7147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19910.7651; train_global_loss: 360566.8090; train_optim_loss: 360566.8090; val_kl_reg_loss: 11911.3413; val_edge_recon_loss: 97551.1471; val_gene_expr_recon_loss: 223802.6615; val_masked_gp_l1_reg_loss: 7306.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18358.0859; val_global_loss: 358930.1198; val_optim_loss: 358930.1198
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8756; val_auprc_score: 0.9711; val_best_acc_score: 0.9104; val_best_f1_score: 0.9490; train_kl_reg_loss: 12557.3200; train_edge_recon_loss: 95034.2179; train_gene_expr_recon_loss: 222905.5003; train_masked_gp_l1_reg_loss: 7334.6918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17105.8962; train_global_loss: 354937.6273; train_optim_loss: 354937.6273; val_kl_reg_loss: 11993.6273; val_edge_recon_loss: 97288.2630; val_gene_expr_recon_loss: 221493.9974; val_masked_gp_l1_reg_loss: 7359.9849; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15915.8975; val_global_loss: 354051.7917; val_optim_loss: 354051.7917
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8821; val_auprc_score: 0.9736; val_best_acc_score: 0.9138; val_best_f1_score: 0.9511; train_kl_reg_loss: 12467.9382; train_edge_recon_loss: 94456.4430; train_gene_expr_recon_loss: 220555.3160; train_masked_gp_l1_reg_loss: 7371.2856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14941.9036; train_global_loss: 349792.8866; train_optim_loss: 349792.8866; val_kl_reg_loss: 12395.7894; val_edge_recon_loss: 93167.6758; val_gene_expr_recon_loss: 220013.5130; val_masked_gp_l1_reg_loss: 7378.3643; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14022.4854; val_global_loss: 346977.8542; val_optim_loss: 346977.8542
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8876; val_auprc_score: 0.9761; val_best_acc_score: 0.9170; val_best_f1_score: 0.9533; train_kl_reg_loss: 12276.4527; train_edge_recon_loss: 93088.5880; train_gene_expr_recon_loss: 218468.7321; train_masked_gp_l1_reg_loss: 7375.1336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13279.7729; train_global_loss: 344488.6806; train_optim_loss: 344488.6806; val_kl_reg_loss: 11830.6429; val_edge_recon_loss: 89409.6432; val_gene_expr_recon_loss: 217986.4505; val_masked_gp_l1_reg_loss: 7367.7803; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12565.9570; val_global_loss: 339160.4896; val_optim_loss: 339160.4896
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9005; val_auprc_score: 0.9753; val_best_acc_score: 0.9169; val_best_f1_score: 0.9526; train_kl_reg_loss: 11930.0059; train_edge_recon_loss: 92277.9310; train_gene_expr_recon_loss: 216484.3189; train_masked_gp_l1_reg_loss: 7351.5149; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11974.8474; train_global_loss: 340018.6169; train_optim_loss: 340018.6169; val_kl_reg_loss: 10972.5991; val_edge_recon_loss: 95674.2240; val_gene_expr_recon_loss: 216091.7057; val_masked_gp_l1_reg_loss: 7328.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11410.0049; val_global_loss: 341476.9688; val_optim_loss: 341476.9688
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9068; val_auprc_score: 0.9795; val_best_acc_score: 0.9180; val_best_f1_score: 0.9532; train_kl_reg_loss: 11795.7835; train_edge_recon_loss: 91861.7593; train_gene_expr_recon_loss: 214749.0677; train_masked_gp_l1_reg_loss: 7298.3301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10937.2411; train_global_loss: 336642.1817; train_optim_loss: 336642.1817; val_kl_reg_loss: 11636.9318; val_edge_recon_loss: 91226.3320; val_gene_expr_recon_loss: 213680.1927; val_masked_gp_l1_reg_loss: 7259.6558; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10481.7891; val_global_loss: 334284.8958; val_optim_loss: 334284.8958
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9187; val_auprc_score: 0.9822; val_best_acc_score: 0.9220; val_best_f1_score: 0.9551; train_kl_reg_loss: 11427.9801; train_edge_recon_loss: 90423.3675; train_gene_expr_recon_loss: 212981.1369; train_masked_gp_l1_reg_loss: 7213.9022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10104.9123; train_global_loss: 332151.2969; train_optim_loss: 332151.2969; val_kl_reg_loss: 11037.8512; val_edge_recon_loss: 91958.9948; val_gene_expr_recon_loss: 212579.9245; val_masked_gp_l1_reg_loss: 7162.0923; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9740.3145; val_global_loss: 332479.1823; val_optim_loss: 332479.1823
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9238; val_auprc_score: 0.9833; val_best_acc_score: 0.9257; val_best_f1_score: 0.9575; train_kl_reg_loss: 11053.6001; train_edge_recon_loss: 89417.2331; train_gene_expr_recon_loss: 211286.1496; train_masked_gp_l1_reg_loss: 7100.2249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9430.8038; train_global_loss: 328288.0122; train_optim_loss: 328288.0122; val_kl_reg_loss: 10475.9697; val_edge_recon_loss: 92030.7161; val_gene_expr_recon_loss: 210459.5807; val_masked_gp_l1_reg_loss: 7030.1973; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9138.0625; val_global_loss: 329134.5208; val_optim_loss: 329134.5208
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9231; val_auprc_score: 0.9823; val_best_acc_score: 0.9271; val_best_f1_score: 0.9583; train_kl_reg_loss: 10718.3929; train_edge_recon_loss: 88644.4708; train_gene_expr_recon_loss: 209650.2271; train_masked_gp_l1_reg_loss: 6955.2304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8892.5835; train_global_loss: 324860.9051; train_optim_loss: 324860.9051; val_kl_reg_loss: 10046.5365; val_edge_recon_loss: 88789.5365; val_gene_expr_recon_loss: 209353.1745; val_masked_gp_l1_reg_loss: 6873.4316; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8659.8750; val_global_loss: 323722.5625; val_optim_loss: 323722.5625
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9311; val_auprc_score: 0.9846; val_best_acc_score: 0.9325; val_best_f1_score: 0.9615; train_kl_reg_loss: 10278.5878; train_edge_recon_loss: 89144.3863; train_gene_expr_recon_loss: 208000.2856; train_masked_gp_l1_reg_loss: 6783.9693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8466.7180; train_global_loss: 322673.9456; train_optim_loss: 322673.9456; val_kl_reg_loss: 9664.2521; val_edge_recon_loss: 87019.4583; val_gene_expr_recon_loss: 206899.7891; val_masked_gp_l1_reg_loss: 6687.6978; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8281.2354; val_global_loss: 318552.4375; val_optim_loss: 318552.4375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9330; val_auprc_score: 0.9848; val_best_acc_score: 0.9308; val_best_f1_score: 0.9602; train_kl_reg_loss: 9961.7033; train_edge_recon_loss: 88171.0556; train_gene_expr_recon_loss: 206306.4731; train_masked_gp_l1_reg_loss: 6584.3988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8137.0412; train_global_loss: 319160.6713; train_optim_loss: 319160.6713; val_kl_reg_loss: 9565.9997; val_edge_recon_loss: 89487.4831; val_gene_expr_recon_loss: 205031.2812; val_masked_gp_l1_reg_loss: 6477.0796; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7992.3530; val_global_loss: 318554.2083; val_optim_loss: 318554.2083
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9405; val_auprc_score: 0.9865; val_best_acc_score: 0.9352; val_best_f1_score: 0.9628; train_kl_reg_loss: 9629.3911; train_edge_recon_loss: 87759.6940; train_gene_expr_recon_loss: 204658.0041; train_masked_gp_l1_reg_loss: 6365.9254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7870.3350; train_global_loss: 316283.3484; train_optim_loss: 316283.3484; val_kl_reg_loss: 8953.4564; val_edge_recon_loss: 87707.9414; val_gene_expr_recon_loss: 204182.4271; val_masked_gp_l1_reg_loss: 6242.9976; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7755.2627; val_global_loss: 314842.0677; val_optim_loss: 314842.0677
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9398; val_auprc_score: 0.9860; val_best_acc_score: 0.9345; val_best_f1_score: 0.9622; train_kl_reg_loss: 9179.1634; train_edge_recon_loss: 86153.6600; train_gene_expr_recon_loss: 202938.9728; train_masked_gp_l1_reg_loss: 6118.7061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7634.6075; train_global_loss: 312025.1123; train_optim_loss: 312025.1123; val_kl_reg_loss: 8496.1727; val_edge_recon_loss: 87290.3919; val_gene_expr_recon_loss: 202680.7318; val_masked_gp_l1_reg_loss: 5981.0493; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7514.4639; val_global_loss: 311962.8333; val_optim_loss: 311962.8333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9444; val_auprc_score: 0.9868; val_best_acc_score: 0.9355; val_best_f1_score: 0.9628; train_kl_reg_loss: 8908.8150; train_edge_recon_loss: 86222.7801; train_gene_expr_recon_loss: 201433.4977; train_masked_gp_l1_reg_loss: 5846.3187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7409.3437; train_global_loss: 309820.7552; train_optim_loss: 309820.7552; val_kl_reg_loss: 8316.5630; val_edge_recon_loss: 86620.2656; val_gene_expr_recon_loss: 200911.3464; val_masked_gp_l1_reg_loss: 5700.0566; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7295.1357; val_global_loss: 308843.3594; val_optim_loss: 308843.3594
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9435; val_auprc_score: 0.9873; val_best_acc_score: 0.9379; val_best_f1_score: 0.9643; train_kl_reg_loss: 8540.9428; train_edge_recon_loss: 85236.2365; train_gene_expr_recon_loss: 199987.4540; train_masked_gp_l1_reg_loss: 5560.8642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7196.5623; train_global_loss: 306522.0590; train_optim_loss: 306522.0590; val_kl_reg_loss: 8309.4168; val_edge_recon_loss: 84609.7253; val_gene_expr_recon_loss: 198985.8698; val_masked_gp_l1_reg_loss: 5414.3252; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7087.5537; val_global_loss: 304406.8854; val_optim_loss: 304406.8854
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9458; val_auprc_score: 0.9876; val_best_acc_score: 0.9366; val_best_f1_score: 0.9635; train_kl_reg_loss: 8140.5197; train_edge_recon_loss: 85992.4042; train_gene_expr_recon_loss: 198588.8388; train_masked_gp_l1_reg_loss: 5270.0714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6993.1123; train_global_loss: 304984.9479; train_optim_loss: 304984.9479; val_kl_reg_loss: 7725.5960; val_edge_recon_loss: 86057.3385; val_gene_expr_recon_loss: 197587.6797; val_masked_gp_l1_reg_loss: 5115.9585; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6889.3643; val_global_loss: 303375.9583; val_optim_loss: 303375.9583
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9488; val_auprc_score: 0.9883; val_best_acc_score: 0.9401; val_best_f1_score: 0.9656; train_kl_reg_loss: 7872.8922; train_edge_recon_loss: 83594.7403; train_gene_expr_recon_loss: 197264.0778; train_masked_gp_l1_reg_loss: 4971.0887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6799.4596; train_global_loss: 300502.2587; train_optim_loss: 300502.2587; val_kl_reg_loss: 7347.9268; val_edge_recon_loss: 84200.0872; val_gene_expr_recon_loss: 196739.6510; val_masked_gp_l1_reg_loss: 4821.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6702.0684; val_global_loss: 299810.8229; val_optim_loss: 299810.8229
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9437; val_auprc_score: 0.9873; val_best_acc_score: 0.9367; val_best_f1_score: 0.9633; train_kl_reg_loss: 4142.5512; train_edge_recon_loss: 81849.4265; train_gene_expr_recon_loss: 309012.2633; train_masked_gp_l1_reg_loss: 4636.0254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5355.1201; train_global_loss: 404995.3843; train_optim_loss: 404995.3843; val_kl_reg_loss: 2597.9454; val_edge_recon_loss: 83351.7096; val_gene_expr_recon_loss: 266001.9948; val_masked_gp_l1_reg_loss: 4427.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3953.8120; val_global_loss: 360333.3385; val_optim_loss: 360333.3385
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9490; val_auprc_score: 0.9884; val_best_acc_score: 0.9389; val_best_f1_score: 0.9645; train_kl_reg_loss: 3057.1685; train_edge_recon_loss: 79824.1929; train_gene_expr_recon_loss: 247929.9884; train_masked_gp_l1_reg_loss: 4228.7169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3196.7924; train_global_loss: 338236.8524; train_optim_loss: 338236.8524; val_kl_reg_loss: 2409.5795; val_edge_recon_loss: 82622.7786; val_gene_expr_recon_loss: 234085.9010; val_masked_gp_l1_reg_loss: 4033.0571; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2611.7407; val_global_loss: 325763.0729; val_optim_loss: 325763.0729
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9522; val_auprc_score: 0.9894; val_best_acc_score: 0.9449; val_best_f1_score: 0.9683; train_kl_reg_loss: 2663.1536; train_edge_recon_loss: 79908.1638; train_gene_expr_recon_loss: 226897.8368; train_masked_gp_l1_reg_loss: 3864.6514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2275.6357; train_global_loss: 315609.4398; train_optim_loss: 315609.4398; val_kl_reg_loss: 2144.5567; val_edge_recon_loss: 77384.0820; val_gene_expr_recon_loss: 220934.5573; val_masked_gp_l1_reg_loss: 3698.5608; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1997.2646; val_global_loss: 306159.0052; val_optim_loss: 306159.0052
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9502; val_auprc_score: 0.9892; val_best_acc_score: 0.9383; val_best_f1_score: 0.9642; train_kl_reg_loss: 2433.8198; train_edge_recon_loss: 78913.5775; train_gene_expr_recon_loss: 216101.7263; train_masked_gp_l1_reg_loss: 3561.4189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1816.5540; train_global_loss: 302827.0984; train_optim_loss: 302827.0984; val_kl_reg_loss: 1986.1972; val_edge_recon_loss: 80011.3151; val_gene_expr_recon_loss: 213136.3880; val_masked_gp_l1_reg_loss: 3428.4233; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1656.6669; val_global_loss: 300218.9948; val_optim_loss: 300218.9948

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9506; val_auprc_score: 0.9884; val_best_acc_score: 0.9431; val_best_f1_score: 0.9672; train_kl_reg_loss: 2336.7564; train_edge_recon_loss: 77679.9459; train_gene_expr_recon_loss: 211848.2859; train_masked_gp_l1_reg_loss: 3343.6136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1576.7925; train_global_loss: 296785.3987; train_optim_loss: 296785.3987; val_kl_reg_loss: 2119.5413; val_edge_recon_loss: 77959.3242; val_gene_expr_recon_loss: 212124.8125; val_masked_gp_l1_reg_loss: 3315.4905; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1549.1707; val_global_loss: 297068.3385; val_optim_loss: 297068.3385
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9511; val_auprc_score: 0.9890; val_best_acc_score: 0.9455; val_best_f1_score: 0.9687; train_kl_reg_loss: 2327.5935; train_edge_recon_loss: 77873.8495; train_gene_expr_recon_loss: 211219.2457; train_masked_gp_l1_reg_loss: 3303.1882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1535.7223; train_global_loss: 296259.5972; train_optim_loss: 296259.5972; val_kl_reg_loss: 2112.4541; val_edge_recon_loss: 76533.4362; val_gene_expr_recon_loss: 210979.5078; val_masked_gp_l1_reg_loss: 3290.9011; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1522.2727; val_global_loss: 294438.5885; val_optim_loss: 294438.5885
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9504; val_auprc_score: 0.9879; val_best_acc_score: 0.9441; val_best_f1_score: 0.9676; train_kl_reg_loss: 2335.4181; train_edge_recon_loss: 77405.6840; train_gene_expr_recon_loss: 210701.7616; train_masked_gp_l1_reg_loss: 3279.1162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1509.5904; train_global_loss: 295231.5683; train_optim_loss: 295231.5683; val_kl_reg_loss: 2101.9159; val_edge_recon_loss: 80873.4466; val_gene_expr_recon_loss: 210230.5130; val_masked_gp_l1_reg_loss: 3267.0471; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1496.7305; val_global_loss: 297969.6562; val_optim_loss: 297969.6562
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9501; val_auprc_score: 0.9879; val_best_acc_score: 0.9424; val_best_f1_score: 0.9667; train_kl_reg_loss: 2301.2924; train_edge_recon_loss: 77795.4653; train_gene_expr_recon_loss: 210259.4476; train_masked_gp_l1_reg_loss: 3255.1101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1484.0812; train_global_loss: 295095.3958; train_optim_loss: 295095.3958; val_kl_reg_loss: 2112.5538; val_edge_recon_loss: 80380.0638; val_gene_expr_recon_loss: 210911.8750; val_masked_gp_l1_reg_loss: 3242.8892; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1471.0139; val_global_loss: 298118.3646; val_optim_loss: 298118.3646
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9569; val_auprc_score: 0.9900; val_best_acc_score: 0.9423; val_best_f1_score: 0.9665; train_kl_reg_loss: 2298.9642; train_edge_recon_loss: 77942.6791; train_gene_expr_recon_loss: 209606.2199; train_masked_gp_l1_reg_loss: 3231.2828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1458.8403; train_global_loss: 294537.9826; train_optim_loss: 294537.9826; val_kl_reg_loss: 2136.5695; val_edge_recon_loss: 80477.0820; val_gene_expr_recon_loss: 210017.9427; val_masked_gp_l1_reg_loss: 3219.2246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1446.1123; val_global_loss: 297296.9323; val_optim_loss: 297296.9323
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9566; val_auprc_score: 0.9901; val_best_acc_score: 0.9457; val_best_f1_score: 0.9687; train_kl_reg_loss: 2308.2626; train_edge_recon_loss: 77846.9359; train_gene_expr_recon_loss: 209083.6073; train_masked_gp_l1_reg_loss: 3207.4619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1434.0391; train_global_loss: 293880.3102; train_optim_loss: 293880.3102; val_kl_reg_loss: 2073.7912; val_edge_recon_loss: 78135.7057; val_gene_expr_recon_loss: 209553.5990; val_masked_gp_l1_reg_loss: 3195.6753; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1421.6348; val_global_loss: 294380.4115; val_optim_loss: 294380.4115
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9520; val_auprc_score: 0.9890; val_best_acc_score: 0.9439; val_best_f1_score: 0.9675; train_kl_reg_loss: 2271.3428; train_edge_recon_loss: 78016.3009; train_gene_expr_recon_loss: 208684.3021; train_masked_gp_l1_reg_loss: 3183.8339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1409.5185; train_global_loss: 293565.2986; train_optim_loss: 293565.2986; val_kl_reg_loss: 2064.3127; val_edge_recon_loss: 80103.2448; val_gene_expr_recon_loss: 208317.9349; val_masked_gp_l1_reg_loss: 3171.9690; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1397.0826; val_global_loss: 295054.5573; val_optim_loss: 295054.5573
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9552; val_auprc_score: 0.9897; val_best_acc_score: 0.9447; val_best_f1_score: 0.9681; train_kl_reg_loss: 2266.6296; train_edge_recon_loss: 78325.7788; train_gene_expr_recon_loss: 208096.9664; train_masked_gp_l1_reg_loss: 3160.4093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1385.2783; train_global_loss: 293235.0625; train_optim_loss: 293235.0625; val_kl_reg_loss: 2080.0239; val_edge_recon_loss: 79319.6198; val_gene_expr_recon_loss: 208755.3620; val_masked_gp_l1_reg_loss: 3148.0903; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1373.1530; val_global_loss: 294676.2552; val_optim_loss: 294676.2552
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9589; val_auprc_score: 0.9912; val_best_acc_score: 0.9477; val_best_f1_score: 0.9697; train_kl_reg_loss: 2267.1635; train_edge_recon_loss: 77762.9648; train_gene_expr_recon_loss: 207720.0203; train_masked_gp_l1_reg_loss: 3136.1554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1361.5425; train_global_loss: 292247.8501; train_optim_loss: 292247.8501; val_kl_reg_loss: 2067.7085; val_edge_recon_loss: 76645.2109; val_gene_expr_recon_loss: 208058.2630; val_masked_gp_l1_reg_loss: 3123.9309; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1349.3824; val_global_loss: 291244.5000; val_optim_loss: 291244.5000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9577; val_auprc_score: 0.9908; val_best_acc_score: 0.9472; val_best_f1_score: 0.9696; train_kl_reg_loss: 2228.4721; train_edge_recon_loss: 76882.7554; train_gene_expr_recon_loss: 207157.7257; train_masked_gp_l1_reg_loss: 3112.8328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1338.1880; train_global_loss: 290719.9716; train_optim_loss: 290719.9716; val_kl_reg_loss: 2043.9242; val_edge_recon_loss: 78154.8438; val_gene_expr_recon_loss: 206880.7474; val_masked_gp_l1_reg_loss: 3100.6860; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1326.4592; val_global_loss: 291506.6719; val_optim_loss: 291506.6719
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9553; val_auprc_score: 0.9899; val_best_acc_score: 0.9443; val_best_f1_score: 0.9677; train_kl_reg_loss: 2225.5402; train_edge_recon_loss: 78279.2525; train_gene_expr_recon_loss: 206716.4832; train_masked_gp_l1_reg_loss: 3088.7051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1315.2628; train_global_loss: 291625.2419; train_optim_loss: 291625.2419; val_kl_reg_loss: 2029.1326; val_edge_recon_loss: 78442.3958; val_gene_expr_recon_loss: 206821.5260; val_masked_gp_l1_reg_loss: 3076.6079; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1303.9325; val_global_loss: 291673.5781; val_optim_loss: 291673.5781
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9535; val_auprc_score: 0.9896; val_best_acc_score: 0.9445; val_best_f1_score: 0.9679; train_kl_reg_loss: 2233.9252; train_edge_recon_loss: 77454.5493; train_gene_expr_recon_loss: 206364.8527; train_masked_gp_l1_reg_loss: 3064.3231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1292.6772; train_global_loss: 290410.3275; train_optim_loss: 290410.3275; val_kl_reg_loss: 2034.3381; val_edge_recon_loss: 78661.7799; val_gene_expr_recon_loss: 205899.8411; val_masked_gp_l1_reg_loss: 3052.0583; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1281.0939; val_global_loss: 290929.1198; val_optim_loss: 290929.1198
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9590; val_auprc_score: 0.9899; val_best_acc_score: 0.9468; val_best_f1_score: 0.9691; train_kl_reg_loss: 2201.0442; train_edge_recon_loss: 77631.6238; train_gene_expr_recon_loss: 205938.6207; train_masked_gp_l1_reg_loss: 3040.7303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1270.3231; train_global_loss: 290082.3414; train_optim_loss: 290082.3414; val_kl_reg_loss: 2043.8459; val_edge_recon_loss: 80092.9961; val_gene_expr_recon_loss: 206060.2526; val_masked_gp_l1_reg_loss: 3029.0659; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1259.0735; val_global_loss: 292485.2135; val_optim_loss: 292485.2135
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9573; val_auprc_score: 0.9893; val_best_acc_score: 0.9469; val_best_f1_score: 0.9691; train_kl_reg_loss: 2195.5514; train_edge_recon_loss: 77538.0848; train_gene_expr_recon_loss: 205472.2063; train_masked_gp_l1_reg_loss: 3017.4202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1248.1545; train_global_loss: 289471.4161; train_optim_loss: 289471.4161; val_kl_reg_loss: 2014.3847; val_edge_recon_loss: 80640.4935; val_gene_expr_recon_loss: 205481.8516; val_masked_gp_l1_reg_loss: 3005.3545; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1237.0222; val_global_loss: 292379.1042; val_optim_loss: 292379.1042
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9594; val_auprc_score: 0.9912; val_best_acc_score: 0.9481; val_best_f1_score: 0.9699; train_kl_reg_loss: 2187.3882; train_edge_recon_loss: 78511.1793; train_gene_expr_recon_loss: 205056.2141; train_masked_gp_l1_reg_loss: 2993.7204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1226.4234; train_global_loss: 289974.9242; train_optim_loss: 289974.9242; val_kl_reg_loss: 2023.8978; val_edge_recon_loss: 78309.4609; val_gene_expr_recon_loss: 205075.9948; val_masked_gp_l1_reg_loss: 2981.7068; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1215.5935; val_global_loss: 289606.6667; val_optim_loss: 289606.6667
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9556; val_auprc_score: 0.9890; val_best_acc_score: 0.9473; val_best_f1_score: 0.9695; train_kl_reg_loss: 2177.8795; train_edge_recon_loss: 77132.8005; train_gene_expr_recon_loss: 204790.9523; train_masked_gp_l1_reg_loss: 2970.1284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1205.0427; train_global_loss: 288276.8021; train_optim_loss: 288276.8021; val_kl_reg_loss: 1986.4335; val_edge_recon_loss: 78191.5625; val_gene_expr_recon_loss: 204677.7292; val_masked_gp_l1_reg_loss: 2958.1782; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1194.2555; val_global_loss: 289008.1562; val_optim_loss: 289008.1562
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9565; val_auprc_score: 0.9897; val_best_acc_score: 0.9496; val_best_f1_score: 0.9710; train_kl_reg_loss: 2176.4166; train_edge_recon_loss: 77252.0153; train_gene_expr_recon_loss: 204348.7850; train_masked_gp_l1_reg_loss: 2946.6281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1183.8683; train_global_loss: 287907.7135; train_optim_loss: 287907.7135; val_kl_reg_loss: 2034.8352; val_edge_recon_loss: 76632.4102; val_gene_expr_recon_loss: 204728.8568; val_masked_gp_l1_reg_loss: 2934.6326; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1172.9619; val_global_loss: 287503.6927; val_optim_loss: 287503.6927
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9561; val_auprc_score: 0.9895; val_best_acc_score: 0.9467; val_best_f1_score: 0.9692; train_kl_reg_loss: 2157.1190; train_edge_recon_loss: 77777.5087; train_gene_expr_recon_loss: 203985.1502; train_masked_gp_l1_reg_loss: 2923.3639; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1162.9008; train_global_loss: 288006.0440; train_optim_loss: 288006.0440; val_kl_reg_loss: 1991.2040; val_edge_recon_loss: 78645.4844; val_gene_expr_recon_loss: 204072.7604; val_masked_gp_l1_reg_loss: 2911.4832; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1152.4302; val_global_loss: 288773.3594; val_optim_loss: 288773.3594
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9545; val_auprc_score: 0.9887; val_best_acc_score: 0.9468; val_best_f1_score: 0.9692; train_kl_reg_loss: 2165.5932; train_edge_recon_loss: 77190.8342; train_gene_expr_recon_loss: 203575.2595; train_masked_gp_l1_reg_loss: 2899.9455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1142.1236; train_global_loss: 286973.7587; train_optim_loss: 286973.7587; val_kl_reg_loss: 2000.5706; val_edge_recon_loss: 79502.0352; val_gene_expr_recon_loss: 203590.9531; val_masked_gp_l1_reg_loss: 2887.6023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1131.5513; val_global_loss: 289112.7188; val_optim_loss: 289112.7188
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9622; val_auprc_score: 0.9915; val_best_acc_score: 0.9503; val_best_f1_score: 0.9712; train_kl_reg_loss: 2158.6216; train_edge_recon_loss: 78056.7130; train_gene_expr_recon_loss: 203182.5321; train_masked_gp_l1_reg_loss: 2876.0319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1121.5045; train_global_loss: 287395.4028; train_optim_loss: 287395.4028; val_kl_reg_loss: 2002.0943; val_edge_recon_loss: 77936.0885; val_gene_expr_recon_loss: 203271.4766; val_masked_gp_l1_reg_loss: 2864.1165; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1111.0507; val_global_loss: 287184.8438; val_optim_loss: 287184.8438
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9602; val_auprc_score: 0.9904; val_best_acc_score: 0.9507; val_best_f1_score: 0.9714; train_kl_reg_loss: 2154.2516; train_edge_recon_loss: 76799.1884; train_gene_expr_recon_loss: 202800.9560; train_masked_gp_l1_reg_loss: 2852.6944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1101.2108; train_global_loss: 285708.3021; train_optim_loss: 285708.3021; val_kl_reg_loss: 2012.9843; val_edge_recon_loss: 78210.8789; val_gene_expr_recon_loss: 202991.6693; val_masked_gp_l1_reg_loss: 2840.9973; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1091.0723; val_global_loss: 287147.5938; val_optim_loss: 287147.5938
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9586; val_auprc_score: 0.9900; val_best_acc_score: 0.9491; val_best_f1_score: 0.9705; train_kl_reg_loss: 2157.2883; train_edge_recon_loss: 77359.0453; train_gene_expr_recon_loss: 202520.6114; train_masked_gp_l1_reg_loss: 2829.6751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1081.1922; train_global_loss: 285947.8125; train_optim_loss: 285947.8125; val_kl_reg_loss: 1997.4345; val_edge_recon_loss: 77072.9831; val_gene_expr_recon_loss: 202416.7682; val_masked_gp_l1_reg_loss: 2817.8306; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1071.0784; val_global_loss: 285376.1198; val_optim_loss: 285376.1198
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9592; val_auprc_score: 0.9900; val_best_acc_score: 0.9516; val_best_f1_score: 0.9720; train_kl_reg_loss: 2148.7184; train_edge_recon_loss: 77349.5528; train_gene_expr_recon_loss: 202178.2454; train_masked_gp_l1_reg_loss: 2806.6030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1061.5439; train_global_loss: 285544.6603; train_optim_loss: 285544.6603; val_kl_reg_loss: 2018.1964; val_edge_recon_loss: 77466.9935; val_gene_expr_recon_loss: 201786.0703; val_masked_gp_l1_reg_loss: 2794.8245; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1051.8036; val_global_loss: 285117.8854; val_optim_loss: 285117.8854
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9572; val_auprc_score: 0.9904; val_best_acc_score: 0.9474; val_best_f1_score: 0.9695; train_kl_reg_loss: 2144.4304; train_edge_recon_loss: 78027.0424; train_gene_expr_recon_loss: 201849.9410; train_masked_gp_l1_reg_loss: 2783.6500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1042.1765; train_global_loss: 285847.2390; train_optim_loss: 285847.2390; val_kl_reg_loss: 1976.7583; val_edge_recon_loss: 78973.9883; val_gene_expr_recon_loss: 202093.9505; val_masked_gp_l1_reg_loss: 2772.1033; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1032.3018; val_global_loss: 286849.1094; val_optim_loss: 286849.1094
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9600; val_auprc_score: 0.9912; val_best_acc_score: 0.9475; val_best_f1_score: 0.9697; train_kl_reg_loss: 2114.4678; train_edge_recon_loss: 77495.8236; train_gene_expr_recon_loss: 201461.5773; train_masked_gp_l1_reg_loss: 2761.3153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1022.8742; train_global_loss: 284856.0561; train_optim_loss: 284856.0561; val_kl_reg_loss: 2001.6620; val_edge_recon_loss: 78186.3594; val_gene_expr_recon_loss: 201481.0703; val_masked_gp_l1_reg_loss: 2749.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1013.0208; val_global_loss: 285432.0990; val_optim_loss: 285432.0990
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9601; val_auprc_score: 0.9904; val_best_acc_score: 0.9495; val_best_f1_score: 0.9706; train_kl_reg_loss: 2121.4509; train_edge_recon_loss: 78598.8113; train_gene_expr_recon_loss: 201217.9031; train_masked_gp_l1_reg_loss: 2738.8279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1003.7997; train_global_loss: 285680.7922; train_optim_loss: 285680.7922; val_kl_reg_loss: 1977.8379; val_edge_recon_loss: 79761.6784; val_gene_expr_recon_loss: 200449.8385; val_masked_gp_l1_reg_loss: 2727.6616; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 994.2717; val_global_loss: 285911.2969; val_optim_loss: 285911.2969
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9567; val_auprc_score: 0.9902; val_best_acc_score: 0.9481; val_best_f1_score: 0.9698; train_kl_reg_loss: 2111.6440; train_edge_recon_loss: 77771.5120; train_gene_expr_recon_loss: 200883.9566; train_masked_gp_l1_reg_loss: 2716.5081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 984.9662; train_global_loss: 284468.5856; train_optim_loss: 284468.5856; val_kl_reg_loss: 1990.0096; val_edge_recon_loss: 79638.6628; val_gene_expr_recon_loss: 200975.5286; val_masked_gp_l1_reg_loss: 2705.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 975.5270; val_global_loss: 286285.2917; val_optim_loss: 286285.2917

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9615; val_auprc_score: 0.9913; val_best_acc_score: 0.9500; val_best_f1_score: 0.9708; train_kl_reg_loss: 2132.1227; train_edge_recon_loss: 77240.6273; train_gene_expr_recon_loss: 200664.2708; train_masked_gp_l1_reg_loss: 2695.8603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 967.6421; train_global_loss: 283700.5243; train_optim_loss: 283700.5243; val_kl_reg_loss: 2000.5100; val_edge_recon_loss: 79292.8281; val_gene_expr_recon_loss: 201196.3646; val_masked_gp_l1_reg_loss: 2692.8208; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 965.2355; val_global_loss: 286147.7656; val_optim_loss: 286147.7656
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9544; val_auprc_score: 0.9891; val_best_acc_score: 0.9497; val_best_f1_score: 0.9708; train_kl_reg_loss: 2130.3734; train_edge_recon_loss: 77147.3122; train_gene_expr_recon_loss: 200581.0451; train_masked_gp_l1_reg_loss: 2691.5874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 964.2417; train_global_loss: 283514.5584; train_optim_loss: 283514.5584; val_kl_reg_loss: 1995.9809; val_edge_recon_loss: 78706.3789; val_gene_expr_recon_loss: 201139.2214; val_masked_gp_l1_reg_loss: 2690.3540; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 963.2582; val_global_loss: 285495.1719; val_optim_loss: 285495.1719
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9583; val_auprc_score: 0.9902; val_best_acc_score: 0.9505; val_best_f1_score: 0.9712; train_kl_reg_loss: 2130.1250; train_edge_recon_loss: 77707.4874; train_gene_expr_recon_loss: 200535.3770; train_masked_gp_l1_reg_loss: 2689.1672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 962.3059; train_global_loss: 284024.4618; train_optim_loss: 284024.4618; val_kl_reg_loss: 2003.6887; val_edge_recon_loss: 78155.4375; val_gene_expr_recon_loss: 201131.4505; val_masked_gp_l1_reg_loss: 2687.9739; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 961.3400; val_global_loss: 284939.8906; val_optim_loss: 284939.8906
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9509; val_auprc_score: 0.9877; val_best_acc_score: 0.9473; val_best_f1_score: 0.9691; train_kl_reg_loss: 2128.9511; train_edge_recon_loss: 77788.1512; train_gene_expr_recon_loss: 200584.6687; train_masked_gp_l1_reg_loss: 2686.7653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 960.3447; train_global_loss: 284148.8802; train_optim_loss: 284148.8802; val_kl_reg_loss: 1990.9220; val_edge_recon_loss: 83091.9076; val_gene_expr_recon_loss: 200407.7057; val_masked_gp_l1_reg_loss: 2685.5442; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 959.3099; val_global_loss: 289135.3854; val_optim_loss: 289135.3854
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9599; val_auprc_score: 0.9906; val_best_acc_score: 0.9495; val_best_f1_score: 0.9705; train_kl_reg_loss: 2129.5800; train_edge_recon_loss: 77020.6302; train_gene_expr_recon_loss: 200476.8626; train_masked_gp_l1_reg_loss: 2684.3847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 958.3444; train_global_loss: 283269.7998; train_optim_loss: 283269.7998; val_kl_reg_loss: 1998.8573; val_edge_recon_loss: 81204.0638; val_gene_expr_recon_loss: 200716.4349; val_masked_gp_l1_reg_loss: 2683.1528; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 957.3228; val_global_loss: 287559.8177; val_optim_loss: 287559.8177
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9611; val_auprc_score: 0.9911; val_best_acc_score: 0.9506; val_best_f1_score: 0.9713; train_kl_reg_loss: 2133.6599; train_edge_recon_loss: 77575.1214; train_gene_expr_recon_loss: 200520.6481; train_masked_gp_l1_reg_loss: 2681.9155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 956.3076; train_global_loss: 283867.6481; train_optim_loss: 283867.6481; val_kl_reg_loss: 1997.5920; val_edge_recon_loss: 78855.0286; val_gene_expr_recon_loss: 200506.8958; val_masked_gp_l1_reg_loss: 2680.6704; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 955.2752; val_global_loss: 284995.4531; val_optim_loss: 284995.4531
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9588; val_auprc_score: 0.9900; val_best_acc_score: 0.9515; val_best_f1_score: 0.9718; train_kl_reg_loss: 2115.5358; train_edge_recon_loss: 77065.3578; train_gene_expr_recon_loss: 200373.1438; train_masked_gp_l1_reg_loss: 2679.4546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 954.2320; train_global_loss: 283187.7234; train_optim_loss: 283187.7234; val_kl_reg_loss: 1983.1244; val_edge_recon_loss: 79222.2630; val_gene_expr_recon_loss: 200314.8255; val_masked_gp_l1_reg_loss: 2678.1702; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 953.1633; val_global_loss: 285151.5208; val_optim_loss: 285151.5208

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9642; val_auprc_score: 0.9921; val_best_acc_score: 0.9535; val_best_f1_score: 0.9731; train_kl_reg_loss: 2123.4464; train_edge_recon_loss: 76785.1534; train_gene_expr_recon_loss: 200447.4945; train_masked_gp_l1_reg_loss: 2677.1765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 952.3617; train_global_loss: 282985.6348; train_optim_loss: 282985.6348; val_kl_reg_loss: 1992.8668; val_edge_recon_loss: 75815.9753; val_gene_expr_recon_loss: 200953.3490; val_masked_gp_l1_reg_loss: 2676.8643; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 952.1064; val_global_loss: 282391.1562; val_optim_loss: 282391.1562
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9620; val_auprc_score: 0.9916; val_best_acc_score: 0.9491; val_best_f1_score: 0.9705; train_kl_reg_loss: 2122.0784; train_edge_recon_loss: 76961.0422; train_gene_expr_recon_loss: 200368.8819; train_masked_gp_l1_reg_loss: 2676.7294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 951.9938; train_global_loss: 283080.7257; train_optim_loss: 283080.7257; val_kl_reg_loss: 1986.9465; val_edge_recon_loss: 78709.3789; val_gene_expr_recon_loss: 200664.5625; val_masked_gp_l1_reg_loss: 2676.6001; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 951.8814; val_global_loss: 284989.3542; val_optim_loss: 284989.3542
Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9606; val_auprc_score: 0.9910; val_best_acc_score: 0.9499; val_best_f1_score: 0.9710; train_kl_reg_loss: 2122.3432; train_edge_recon_loss: 77731.2595; train_gene_expr_recon_loss: 200406.2043; train_masked_gp_l1_reg_loss: 2676.4729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 951.7717; train_global_loss: 283888.0532; train_optim_loss: 283888.0532; val_kl_reg_loss: 1981.2914; val_edge_recon_loss: 77472.9297; val_gene_expr_recon_loss: 200369.8411; val_masked_gp_l1_reg_loss: 2676.3452; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 951.6599; val_global_loss: 283452.0625; val_optim_loss: 283452.0625
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9520; val_auprc_score: 0.9882; val_best_acc_score: 0.9469; val_best_f1_score: 0.9692; train_kl_reg_loss: 2120.3940; train_edge_recon_loss: 77134.5162; train_gene_expr_recon_loss: 200396.8753; train_masked_gp_l1_reg_loss: 2676.2171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 951.5461; train_global_loss: 283279.5492; train_optim_loss: 283279.5492; val_kl_reg_loss: 1988.9468; val_edge_recon_loss: 79676.9883; val_gene_expr_recon_loss: 200594.7344; val_masked_gp_l1_reg_loss: 2676.0828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 951.4271; val_global_loss: 285888.1927; val_optim_loss: 285888.1927
Epoch 68/100 |█████████████-------| 68.0% val_auroc_score: 0.9550; val_auprc_score: 0.9894; val_best_acc_score: 0.9485; val_best_f1_score: 0.9701; train_kl_reg_loss: 2119.4998; train_edge_recon_loss: 77149.8270; train_gene_expr_recon_loss: 200412.3084; train_masked_gp_l1_reg_loss: 2675.9559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 951.3153; train_global_loss: 283308.9051; train_optim_loss: 283308.9051; val_kl_reg_loss: 1982.8364; val_edge_recon_loss: 79769.8333; val_gene_expr_recon_loss: 200522.4271; val_masked_gp_l1_reg_loss: 2675.8232; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 951.1970; val_global_loss: 285902.0885; val_optim_loss: 285902.0885

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 69/100 |█████████████-------| 69.0% val_auroc_score: 0.9581; val_auprc_score: 0.9900; val_best_acc_score: 0.9495; val_best_f1_score: 0.9709; train_kl_reg_loss: 2118.3694; train_edge_recon_loss: 77608.3630; train_gene_expr_recon_loss: 200368.9187; train_masked_gp_l1_reg_loss: 2675.7227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 951.1148; train_global_loss: 283722.4832; train_optim_loss: 283722.4832; val_kl_reg_loss: 1979.0652; val_edge_recon_loss: 77840.4388; val_gene_expr_recon_loss: 200508.0755; val_masked_gp_l1_reg_loss: 2675.6904; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 951.0881; val_global_loss: 283954.3646; val_optim_loss: 283954.3646
Epoch 70/100 |██████████████------| 70.0% val_auroc_score: 0.9594; val_auprc_score: 0.9906; val_best_acc_score: 0.9505; val_best_f1_score: 0.9711; train_kl_reg_loss: 2117.1744; train_edge_recon_loss: 77979.2805; train_gene_expr_recon_loss: 200360.8157; train_masked_gp_l1_reg_loss: 2675.6758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 951.0757; train_global_loss: 284084.0231; train_optim_loss: 284084.0231; val_kl_reg_loss: 1985.0899; val_edge_recon_loss: 79514.3281; val_gene_expr_recon_loss: 200598.3932; val_masked_gp_l1_reg_loss: 2675.6616; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 951.0631; val_global_loss: 285724.5260; val_optim_loss: 285724.5260
Epoch 71/100 |██████████████------| 71.0% val_auroc_score: 0.9610; val_auprc_score: 0.9908; val_best_acc_score: 0.9501; val_best_f1_score: 0.9709; train_kl_reg_loss: 2117.1734; train_edge_recon_loss: 78130.4012; train_gene_expr_recon_loss: 200336.7972; train_masked_gp_l1_reg_loss: 2675.6480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 951.0510; train_global_loss: 284211.0718; train_optim_loss: 284211.0718; val_kl_reg_loss: 1985.8311; val_edge_recon_loss: 79321.0221; val_gene_expr_recon_loss: 200660.9427; val_masked_gp_l1_reg_loss: 2675.6343; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 951.0385; val_global_loss: 285594.4427; val_optim_loss: 285594.4427
Epoch 72/100 |██████████████------| 72.0% val_auroc_score: 0.9610; val_auprc_score: 0.9907; val_best_acc_score: 0.9503; val_best_f1_score: 0.9711; train_kl_reg_loss: 2116.4388; train_edge_recon_loss: 77589.9567; train_gene_expr_recon_loss: 200359.7295; train_masked_gp_l1_reg_loss: 2675.6207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 951.0261; train_global_loss: 283692.7749; train_optim_loss: 283692.7749; val_kl_reg_loss: 1987.4878; val_edge_recon_loss: 78717.5729; val_gene_expr_recon_loss: 200489.7396; val_masked_gp_l1_reg_loss: 2675.6060; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 951.0129; val_global_loss: 284821.3958; val_optim_loss: 284821.3958

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 56 sec.
Using best model state, which was in epoch 64.

--- MODEL EVALUATION ---
val AUROC score: 0.9576
val AUPRC score: 0.9901
val best accuracy score: 0.9493
val best F1 score: 0.9706
val target rna MSE score: 99.3168
val source rna MSE score: 136.4239
Val cat covariate0 mean sim diff: -0.0013

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
