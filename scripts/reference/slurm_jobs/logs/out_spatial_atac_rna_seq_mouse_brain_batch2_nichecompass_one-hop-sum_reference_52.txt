[True]
Run timestamp: 10082023_211453_52.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_52']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7896; val_auprc_score: 0.8075; val_best_acc_score: 0.5930; val_best_f1_score: 0.7054; train_kl_reg_loss: 224052.5261; train_edge_recon_loss: 3941735.6279; train_gene_expr_recon_loss: 30634495.7557; train_masked_gp_l1_reg_loss: 80877.8096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 243298.3402; train_chrom_access_recon_loss: 134252135.4504; train_global_loss: 169376595.5420; train_optim_loss: 169376595.5420; val_kl_reg_loss: 145177.8583; val_edge_recon_loss: 4060187.5667; val_gene_expr_recon_loss: 24213270.2667; val_masked_gp_l1_reg_loss: 80014.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 240627.7812; val_chrom_access_recon_loss: 115998474.6667; val_global_loss: 144737752.5333; val_optim_loss: 144737752.5333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7837; val_auprc_score: 0.8018; val_best_acc_score: 0.6870; val_best_f1_score: 0.7255; train_kl_reg_loss: 216651.3801; train_edge_recon_loss: 3739199.1851; train_gene_expr_recon_loss: 23184269.0992; train_masked_gp_l1_reg_loss: 75543.1239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 236635.5967; train_chrom_access_recon_loss: 115683259.1145; train_global_loss: 143135557.0076; train_optim_loss: 143135557.0076; val_kl_reg_loss: 211492.2031; val_edge_recon_loss: 3967086.6667; val_gene_expr_recon_loss: 22613407.6000; val_masked_gp_l1_reg_loss: 72491.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 231428.9844; val_chrom_access_recon_loss: 114843347.2000; val_global_loss: 141939254.4000; val_optim_loss: 141939254.4000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8723; val_auprc_score: 0.8689; val_best_acc_score: 0.7784; val_best_f1_score: 0.7923; train_kl_reg_loss: 212644.6768; train_edge_recon_loss: 3481208.6469; train_gene_expr_recon_loss: 22342574.2443; train_masked_gp_l1_reg_loss: 72269.9017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225071.7996; train_chrom_access_recon_loss: 114407936.4275; train_global_loss: 140741706.7481; train_optim_loss: 140741706.7481; val_kl_reg_loss: 218441.8406; val_edge_recon_loss: 3264682.0167; val_gene_expr_recon_loss: 22263629.2000; val_masked_gp_l1_reg_loss: 72792.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 218398.1719; val_chrom_access_recon_loss: 113485971.7333; val_global_loss: 139523916.8000; val_optim_loss: 139523916.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8822; val_auprc_score: 0.8733; val_best_acc_score: 0.7963; val_best_f1_score: 0.8136; train_kl_reg_loss: 243491.8899; train_edge_recon_loss: 3138123.6088; train_gene_expr_recon_loss: 22125212.1221; train_masked_gp_l1_reg_loss: 73002.8359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 211784.9927; train_chrom_access_recon_loss: 113928929.5267; train_global_loss: 139720545.4046; train_optim_loss: 139720545.4046; val_kl_reg_loss: 237438.1771; val_edge_recon_loss: 3108065.8833; val_gene_expr_recon_loss: 22037832.2667; val_masked_gp_l1_reg_loss: 73663.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 205120.1406; val_chrom_access_recon_loss: 112995869.3333; val_global_loss: 138657988.2667; val_optim_loss: 138657988.2667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8918; val_auprc_score: 0.8830; val_best_acc_score: 0.8040; val_best_f1_score: 0.8229; train_kl_reg_loss: 241469.2505; train_edge_recon_loss: 3056423.5725; train_gene_expr_recon_loss: 21936654.0611; train_masked_gp_l1_reg_loss: 74031.8860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 198649.4170; train_chrom_access_recon_loss: 113145308.7634; train_global_loss: 138652536.3664; train_optim_loss: 138652536.3664; val_kl_reg_loss: 228669.2500; val_edge_recon_loss: 3042615.3000; val_gene_expr_recon_loss: 21990120.5333; val_masked_gp_l1_reg_loss: 74666.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192241.7812; val_chrom_access_recon_loss: 112746451.2000; val_global_loss: 138274765.3333; val_optim_loss: 138274765.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9080; val_auprc_score: 0.8971; val_best_acc_score: 0.8223; val_best_f1_score: 0.8394; train_kl_reg_loss: 225667.9184; train_edge_recon_loss: 3008445.8550; train_gene_expr_recon_loss: 21809214.0916; train_masked_gp_l1_reg_loss: 75427.6003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186195.9913; train_chrom_access_recon_loss: 112565474.6870; train_global_loss: 137870426.3817; train_optim_loss: 137870426.3817; val_kl_reg_loss: 218202.4042; val_edge_recon_loss: 2966172.3667; val_gene_expr_recon_loss: 21748763.7333; val_masked_gp_l1_reg_loss: 76208.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 180249.5938; val_chrom_access_recon_loss: 112159944.0000; val_global_loss: 137349539.7333; val_optim_loss: 137349539.7333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9162; val_auprc_score: 0.9031; val_best_acc_score: 0.8378; val_best_f1_score: 0.8508; train_kl_reg_loss: 217155.2543; train_edge_recon_loss: 2966669.2500; train_gene_expr_recon_loss: 21681644.9466; train_masked_gp_l1_reg_loss: 77038.4501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 174651.0802; train_chrom_access_recon_loss: 112048154.1985; train_global_loss: 137165313.2824; train_optim_loss: 137165313.2824; val_kl_reg_loss: 209749.7646; val_edge_recon_loss: 2951559.2667; val_gene_expr_recon_loss: 21692227.8667; val_masked_gp_l1_reg_loss: 77866.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169134.8594; val_chrom_access_recon_loss: 111509059.7333; val_global_loss: 136609597.3333; val_optim_loss: 136609597.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9264; val_auprc_score: 0.9116; val_best_acc_score: 0.8538; val_best_f1_score: 0.8643; train_kl_reg_loss: 209215.5304; train_edge_recon_loss: 2928722.1221; train_gene_expr_recon_loss: 21600794.0458; train_masked_gp_l1_reg_loss: 78804.2287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163974.3234; train_chrom_access_recon_loss: 111803748.5802; train_global_loss: 136785258.4427; train_optim_loss: 136785258.4427; val_kl_reg_loss: 206890.9312; val_edge_recon_loss: 2909725.9333; val_gene_expr_recon_loss: 21572733.7333; val_masked_gp_l1_reg_loss: 79677.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158879.8125; val_chrom_access_recon_loss: 111023189.3333; val_global_loss: 135951096.5333; val_optim_loss: 135951096.5333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9349; val_auprc_score: 0.9228; val_best_acc_score: 0.8641; val_best_f1_score: 0.8737; train_kl_reg_loss: 205699.6155; train_edge_recon_loss: 2912778.4237; train_gene_expr_recon_loss: 21470874.2290; train_masked_gp_l1_reg_loss: 80456.1691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154071.4986; train_chrom_access_recon_loss: 110979997.5573; train_global_loss: 135803876.8244; train_optim_loss: 135803876.8244; val_kl_reg_loss: 201118.3469; val_edge_recon_loss: 2909601.5333; val_gene_expr_recon_loss: 21439938.2667; val_masked_gp_l1_reg_loss: 81437.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149354.0469; val_chrom_access_recon_loss: 110312044.8000; val_global_loss: 135093495.4667; val_optim_loss: 135093495.4667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9417; val_auprc_score: 0.9310; val_best_acc_score: 0.8752; val_best_f1_score: 0.8821; train_kl_reg_loss: 199766.8304; train_edge_recon_loss: 2886115.8626; train_gene_expr_recon_loss: 21408222.5496; train_masked_gp_l1_reg_loss: 82160.4820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145000.3928; train_chrom_access_recon_loss: 110725361.5267; train_global_loss: 135446628.2137; train_optim_loss: 135446628.2137; val_kl_reg_loss: 194397.9615; val_edge_recon_loss: 2879974.2667; val_gene_expr_recon_loss: 21307228.6667; val_masked_gp_l1_reg_loss: 83022.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140763.8906; val_chrom_access_recon_loss: 109289570.6667; val_global_loss: 133894956.8000; val_optim_loss: 133894956.8000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9415; val_auprc_score: 0.9297; val_best_acc_score: 0.8721; val_best_f1_score: 0.8806; train_kl_reg_loss: 195289.5267; train_edge_recon_loss: 2867325.6412; train_gene_expr_recon_loss: 21315187.3130; train_masked_gp_l1_reg_loss: 83757.5286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136882.6480; train_chrom_access_recon_loss: 110169889.2824; train_global_loss: 134768332.2748; train_optim_loss: 134768332.2748; val_kl_reg_loss: 193681.8490; val_edge_recon_loss: 2868435.9667; val_gene_expr_recon_loss: 21310547.3333; val_masked_gp_l1_reg_loss: 84441.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133151.1406; val_chrom_access_recon_loss: 109686114.1333; val_global_loss: 134276373.3333; val_optim_loss: 134276373.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9488; val_auprc_score: 0.9401; val_best_acc_score: 0.8812; val_best_f1_score: 0.8874; train_kl_reg_loss: 192492.5945; train_edge_recon_loss: 2857946.9427; train_gene_expr_recon_loss: 21247416.8855; train_masked_gp_l1_reg_loss: 85297.1455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129672.1292; train_chrom_access_recon_loss: 109811681.3435; train_global_loss: 134324507.4198; train_optim_loss: 134324507.4198; val_kl_reg_loss: 190712.9542; val_edge_recon_loss: 2860206.1667; val_gene_expr_recon_loss: 21634147.6000; val_masked_gp_l1_reg_loss: 85900.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126213.9375; val_chrom_access_recon_loss: 109383060.2667; val_global_loss: 134280240.5333; val_optim_loss: 134280240.5333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9534; val_auprc_score: 0.9454; val_best_acc_score: 0.8871; val_best_f1_score: 0.8924; train_kl_reg_loss: 187145.4127; train_edge_recon_loss: 2851467.7481; train_gene_expr_recon_loss: 21198894.2290; train_masked_gp_l1_reg_loss: 86727.6422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123021.0252; train_chrom_access_recon_loss: 109380165.9847; train_global_loss: 133827421.8015; train_optim_loss: 133827421.8015; val_kl_reg_loss: 186789.3729; val_edge_recon_loss: 2837447.0833; val_gene_expr_recon_loss: 21131407.2000; val_masked_gp_l1_reg_loss: 87254.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119617.6484; val_chrom_access_recon_loss: 108101511.4667; val_global_loss: 132464028.8000; val_optim_loss: 132464028.8000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9479; val_auprc_score: 0.9390; val_best_acc_score: 0.8814; val_best_f1_score: 0.8890; train_kl_reg_loss: 186195.3961; train_edge_recon_loss: 2833922.6737; train_gene_expr_recon_loss: 21120268.5038; train_masked_gp_l1_reg_loss: 87969.4803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116472.6750; train_chrom_access_recon_loss: 109088758.1679; train_global_loss: 133433586.8702; train_optim_loss: 133433586.8702; val_kl_reg_loss: 190435.9240; val_edge_recon_loss: 2853754.8500; val_gene_expr_recon_loss: 21084063.2000; val_masked_gp_l1_reg_loss: 88669.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113377.0781; val_chrom_access_recon_loss: 108397769.0667; val_global_loss: 132728070.4000; val_optim_loss: 132728070.4000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9546; val_auprc_score: 0.9451; val_best_acc_score: 0.8937; val_best_f1_score: 0.8990; train_kl_reg_loss: 180864.1331; train_edge_recon_loss: 2827684.3836; train_gene_expr_recon_loss: 21087841.8321; train_masked_gp_l1_reg_loss: 89394.7342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110552.5796; train_chrom_access_recon_loss: 108903733.9237; train_global_loss: 133200071.4504; train_optim_loss: 133200071.4504; val_kl_reg_loss: 176308.5281; val_edge_recon_loss: 2834403.1500; val_gene_expr_recon_loss: 21164155.3333; val_masked_gp_l1_reg_loss: 90038.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107753.1641; val_chrom_access_recon_loss: 108765665.0667; val_global_loss: 133138323.2000; val_optim_loss: 133138323.2000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9585; val_auprc_score: 0.9501; val_best_acc_score: 0.8930; val_best_f1_score: 0.8989; train_kl_reg_loss: 178278.4088; train_edge_recon_loss: 2818744.1260; train_gene_expr_recon_loss: 21038148.1832; train_masked_gp_l1_reg_loss: 90682.8187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105189.0467; train_chrom_access_recon_loss: 108659643.6641; train_global_loss: 132890686.2901; train_optim_loss: 132890686.2901; val_kl_reg_loss: 174789.5229; val_edge_recon_loss: 2842016.0167; val_gene_expr_recon_loss: 20993680.6667; val_masked_gp_l1_reg_loss: 91462.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102712.9844; val_chrom_access_recon_loss: 107979899.7333; val_global_loss: 132184561.0667; val_optim_loss: 132184561.0667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9601; val_auprc_score: 0.9537; val_best_acc_score: 0.8959; val_best_f1_score: 0.9025; train_kl_reg_loss: 173837.8310; train_edge_recon_loss: 2809994.7500; train_gene_expr_recon_loss: 20986588.1679; train_masked_gp_l1_reg_loss: 92148.8457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100374.5571; train_chrom_access_recon_loss: 108354067.0534; train_global_loss: 132517011.1756; train_optim_loss: 132517011.1756; val_kl_reg_loss: 171271.0219; val_edge_recon_loss: 2823182.2667; val_gene_expr_recon_loss: 21005798.5333; val_masked_gp_l1_reg_loss: 92841.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98081.0703; val_chrom_access_recon_loss: 108074371.7333; val_global_loss: 132265548.2667; val_optim_loss: 132265548.2667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9574; val_auprc_score: 0.9494; val_best_acc_score: 0.8998; val_best_f1_score: 0.9044; train_kl_reg_loss: 170572.0584; train_edge_recon_loss: 2810007.9237; train_gene_expr_recon_loss: 20946569.1908; train_masked_gp_l1_reg_loss: 93517.7303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96019.9396; train_chrom_access_recon_loss: 108134494.1069; train_global_loss: 132251180.9466; train_optim_loss: 132251180.9466; val_kl_reg_loss: 164479.5948; val_edge_recon_loss: 2839972.2167; val_gene_expr_recon_loss: 20959585.4667; val_masked_gp_l1_reg_loss: 94232.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93924.8281; val_chrom_access_recon_loss: 107366543.4667; val_global_loss: 131518736.0000; val_optim_loss: 131518736.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9635; val_auprc_score: 0.9563; val_best_acc_score: 0.9050; val_best_f1_score: 0.9083; train_kl_reg_loss: 165940.6311; train_edge_recon_loss: 2809239.2977; train_gene_expr_recon_loss: 20911024.2901; train_masked_gp_l1_reg_loss: 94872.2922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92056.3856; train_chrom_access_recon_loss: 107863994.8702; train_global_loss: 131937127.8168; train_optim_loss: 131937127.8168; val_kl_reg_loss: 166412.1677; val_edge_recon_loss: 2818074.6667; val_gene_expr_recon_loss: 20828125.8667; val_masked_gp_l1_reg_loss: 95542.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90156.3438; val_chrom_access_recon_loss: 106938102.4000; val_global_loss: 130936412.2667; val_optim_loss: 130936412.2667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9647; val_auprc_score: 0.9583; val_best_acc_score: 0.9095; val_best_f1_score: 0.9126; train_kl_reg_loss: 164446.0731; train_edge_recon_loss: 2796136.1813; train_gene_expr_recon_loss: 20868616.3817; train_masked_gp_l1_reg_loss: 96170.5508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88310.9446; train_chrom_access_recon_loss: 107584496.6718; train_global_loss: 131598175.9389; train_optim_loss: 131598175.9389; val_kl_reg_loss: 162077.1042; val_edge_recon_loss: 2807670.7500; val_gene_expr_recon_loss: 20995409.7333; val_masked_gp_l1_reg_loss: 96942.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86594.9688; val_chrom_access_recon_loss: 108253063.4667; val_global_loss: 132401756.2667; val_optim_loss: 132401756.2667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9711; val_auprc_score: 0.9672; val_best_acc_score: 0.9130; val_best_f1_score: 0.9169; train_kl_reg_loss: 161361.3610; train_edge_recon_loss: 2792334.0191; train_gene_expr_recon_loss: 20847260.1221; train_masked_gp_l1_reg_loss: 97641.6413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84895.5032; train_chrom_access_recon_loss: 107547980.7023; train_global_loss: 131531473.2214; train_optim_loss: 131531473.2214; val_kl_reg_loss: 158348.0760; val_edge_recon_loss: 2803161.7333; val_gene_expr_recon_loss: 20862537.3333; val_masked_gp_l1_reg_loss: 98249.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83256.4062; val_chrom_access_recon_loss: 106852356.2667; val_global_loss: 130857909.3333; val_optim_loss: 130857909.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9682; val_auprc_score: 0.9624; val_best_acc_score: 0.9130; val_best_f1_score: 0.9158; train_kl_reg_loss: 158460.0407; train_edge_recon_loss: 2788054.5592; train_gene_expr_recon_loss: 20799516.1679; train_masked_gp_l1_reg_loss: 98842.8272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81613.7400; train_chrom_access_recon_loss: 107233127.8168; train_global_loss: 131159615.3282; train_optim_loss: 131159615.3282; val_kl_reg_loss: 156999.2188; val_edge_recon_loss: 2802113.1833; val_gene_expr_recon_loss: 20832452.8000; val_masked_gp_l1_reg_loss: 99534.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80089.5703; val_chrom_access_recon_loss: 106324183.4667; val_global_loss: 130295372.8000; val_optim_loss: 130295372.8000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9727; val_auprc_score: 0.9669; val_best_acc_score: 0.9170; val_best_f1_score: 0.9192; train_kl_reg_loss: 156884.7032; train_edge_recon_loss: 2784028.0859; train_gene_expr_recon_loss: 20790450.2901; train_masked_gp_l1_reg_loss: 100221.7264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78598.2034; train_chrom_access_recon_loss: 107162620.0305; train_global_loss: 131072802.7481; train_optim_loss: 131072802.7481; val_kl_reg_loss: 155162.3740; val_edge_recon_loss: 2776148.2500; val_gene_expr_recon_loss: 20793973.0667; val_masked_gp_l1_reg_loss: 100961.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77194.8828; val_chrom_access_recon_loss: 106423017.0667; val_global_loss: 130326456.5333; val_optim_loss: 130326456.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9708; val_auprc_score: 0.9643; val_best_acc_score: 0.9179; val_best_f1_score: 0.9212; train_kl_reg_loss: 152432.6799; train_edge_recon_loss: 2787227.4714; train_gene_expr_recon_loss: 20758992.1985; train_masked_gp_l1_reg_loss: 101541.4934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75756.3204; train_chrom_access_recon_loss: 106949201.2824; train_global_loss: 130825151.1450; train_optim_loss: 130825151.1450; val_kl_reg_loss: 151412.7396; val_edge_recon_loss: 2794063.1500; val_gene_expr_recon_loss: 20792082.0000; val_masked_gp_l1_reg_loss: 102347.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74407.4062; val_chrom_access_recon_loss: 106395507.7333; val_global_loss: 130309821.3333; val_optim_loss: 130309821.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9703; val_auprc_score: 0.9624; val_best_acc_score: 0.9194; val_best_f1_score: 0.9227; train_kl_reg_loss: 151952.8200; train_edge_recon_loss: 2773218.7042; train_gene_expr_recon_loss: 20763144.2748; train_masked_gp_l1_reg_loss: 102912.5441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73103.5000; train_chrom_access_recon_loss: 107064924.0305; train_global_loss: 130929255.8779; train_optim_loss: 130929255.8779; val_kl_reg_loss: 150552.9969; val_edge_recon_loss: 2789955.1333; val_gene_expr_recon_loss: 20759660.2667; val_masked_gp_l1_reg_loss: 103517.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71872.4453; val_chrom_access_recon_loss: 106534972.2667; val_global_loss: 130410530.1333; val_optim_loss: 130410530.1333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9246; val_auprc_score: 0.9036; val_best_acc_score: 0.8599; val_best_f1_score: 0.8669; train_kl_reg_loss: 138336.6794; train_edge_recon_loss: 2996644.0573; train_gene_expr_recon_loss: 25145472.2748; train_masked_gp_l1_reg_loss: 101010.0080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72916.3924; train_chrom_access_recon_loss: 112846823.1450; train_global_loss: 141301202.5038; train_optim_loss: 141301202.5038; val_kl_reg_loss: 11729.4772; val_edge_recon_loss: 2887118.9333; val_gene_expr_recon_loss: 24997518.6667; val_masked_gp_l1_reg_loss: 97852.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71452.4922; val_chrom_access_recon_loss: 112426637.8667; val_global_loss: 140492308.8000; val_optim_loss: 140492308.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9268; val_auprc_score: 0.9073; val_best_acc_score: 0.8607; val_best_f1_score: 0.8696; train_kl_reg_loss: 81248.2001; train_edge_recon_loss: 2841893.1031; train_gene_expr_recon_loss: 24837141.7863; train_masked_gp_l1_reg_loss: 97238.1153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71133.1097; train_chrom_access_recon_loss: 112381333.7405; train_global_loss: 140309988.2748; train_optim_loss: 140309988.2748; val_kl_reg_loss: 14269.6902; val_edge_recon_loss: 2822853.0500; val_gene_expr_recon_loss: 24840348.0000; val_masked_gp_l1_reg_loss: 96833.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70826.0000; val_chrom_access_recon_loss: 111815186.1333; val_global_loss: 139660315.7333; val_optim_loss: 139660315.7333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9283; val_auprc_score: 0.9115; val_best_acc_score: 0.8608; val_best_f1_score: 0.8693; train_kl_reg_loss: 80424.4928; train_edge_recon_loss: 2826355.3168; train_gene_expr_recon_loss: 24796355.9542; train_masked_gp_l1_reg_loss: 96437.2702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70512.7016; train_chrom_access_recon_loss: 112435220.5802; train_global_loss: 140305306.6260; train_optim_loss: 140305306.6260; val_kl_reg_loss: 15391.4483; val_edge_recon_loss: 2823785.0000; val_gene_expr_recon_loss: 24908809.7333; val_masked_gp_l1_reg_loss: 96031.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70180.5312; val_chrom_access_recon_loss: 112451089.6000; val_global_loss: 140365288.5333; val_optim_loss: 140365288.5333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9290; val_auprc_score: 0.9129; val_best_acc_score: 0.8591; val_best_f1_score: 0.8691; train_kl_reg_loss: 75985.4015; train_edge_recon_loss: 2810486.6679; train_gene_expr_recon_loss: 24761501.6183; train_masked_gp_l1_reg_loss: 95612.4486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69843.0245; train_chrom_access_recon_loss: 112366982.5344; train_global_loss: 140180411.2977; train_optim_loss: 140180411.2977; val_kl_reg_loss: 16399.9600; val_edge_recon_loss: 2841935.4667; val_gene_expr_recon_loss: 24781547.8667; val_masked_gp_l1_reg_loss: 95179.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69496.0938; val_chrom_access_recon_loss: 111952242.6667; val_global_loss: 139756802.1333; val_optim_loss: 139756802.1333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9315; val_auprc_score: 0.9131; val_best_acc_score: 0.8646; val_best_f1_score: 0.8730; train_kl_reg_loss: 71903.7731; train_edge_recon_loss: 2803086.6737; train_gene_expr_recon_loss: 24703355.7863; train_masked_gp_l1_reg_loss: 94744.0802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69142.7526; train_chrom_access_recon_loss: 112166429.4351; train_global_loss: 139908663.5115; train_optim_loss: 139908663.5115; val_kl_reg_loss: 17320.2207; val_edge_recon_loss: 2789987.4333; val_gene_expr_recon_loss: 24821387.8667; val_masked_gp_l1_reg_loss: 94296.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68787.3281; val_chrom_access_recon_loss: 111830307.2000; val_global_loss: 139622088.0000; val_optim_loss: 139622088.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 48 min 49 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9668
val AUPRC score: 0.9603
val best accuracy score: 0.9056
val best F1 score: 0.9079
val target rna MSE score: 2.8944
val source rna MSE score: 112.3510
val target atac MSE score: 0.1278
val source atac MSE score: 1.0656
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
