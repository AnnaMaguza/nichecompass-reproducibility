[True]
Run timestamp: 10082023_191246_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7808; val_auprc_score: 0.8006; val_best_acc_score: 0.5071; val_best_f1_score: 0.6690; train_kl_reg_loss: 132689.0546; train_edge_recon_loss: 3745428.2309; train_gene_expr_recon_loss: 27205622.0305; train_masked_gp_l1_reg_loss: 77725.3358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 242611.0100; train_chrom_access_recon_loss: 5562037.3855; train_global_loss: 36966112.9618; train_optim_loss: 36966112.9618; val_kl_reg_loss: 204865.1417; val_edge_recon_loss: 4064814.2333; val_gene_expr_recon_loss: 23205722.5333; val_masked_gp_l1_reg_loss: 74518.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 234860.7500; val_chrom_access_recon_loss: 5155967.0333; val_global_loss: 32940746.8000; val_optim_loss: 32940746.8000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7866; val_auprc_score: 0.8070; val_best_acc_score: 0.6310; val_best_f1_score: 0.7177; train_kl_reg_loss: 141561.5798; train_edge_recon_loss: 3646220.6698; train_gene_expr_recon_loss: 22951817.4504; train_masked_gp_l1_reg_loss: 76025.3870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 226275.8084; train_chrom_access_recon_loss: 5177688.1145; train_global_loss: 32219589.0229; train_optim_loss: 32219589.0229; val_kl_reg_loss: 173128.2406; val_edge_recon_loss: 4055266.5000; val_gene_expr_recon_loss: 22501658.8000; val_masked_gp_l1_reg_loss: 76105.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 216760.1094; val_chrom_access_recon_loss: 5102167.0667; val_global_loss: 32125086.6667; val_optim_loss: 32125086.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8201; val_auprc_score: 0.8363; val_best_acc_score: 0.7375; val_best_f1_score: 0.7259; train_kl_reg_loss: 154193.3370; train_edge_recon_loss: 3551125.2576; train_gene_expr_recon_loss: 22271590.6718; train_masked_gp_l1_reg_loss: 76037.6729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 207085.4690; train_chrom_access_recon_loss: 5124930.2443; train_global_loss: 31384962.7023; train_optim_loss: 31384962.7023; val_kl_reg_loss: 130590.5099; val_edge_recon_loss: 3998684.1167; val_gene_expr_recon_loss: 22156515.7333; val_masked_gp_l1_reg_loss: 75561.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 197514.9062; val_chrom_access_recon_loss: 5048066.2667; val_global_loss: 31606932.9333; val_optim_loss: 31606932.9333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8821; val_auprc_score: 0.8811; val_best_acc_score: 0.8037; val_best_f1_score: 0.8108; train_kl_reg_loss: 130882.4951; train_edge_recon_loss: 3504555.0496; train_gene_expr_recon_loss: 21987343.8626; train_masked_gp_l1_reg_loss: 76576.0349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 188519.0559; train_chrom_access_recon_loss: 5083166.1336; train_global_loss: 30971042.6870; train_optim_loss: 30971042.6870; val_kl_reg_loss: 114897.8167; val_edge_recon_loss: 3680402.6667; val_gene_expr_recon_loss: 21887802.2667; val_masked_gp_l1_reg_loss: 77955.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179733.7656; val_chrom_access_recon_loss: 4998780.0000; val_global_loss: 30939572.6667; val_optim_loss: 30939572.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9059; val_auprc_score: 0.8914; val_best_acc_score: 0.8298; val_best_f1_score: 0.8378; train_kl_reg_loss: 138943.9969; train_edge_recon_loss: 3142385.9103; train_gene_expr_recon_loss: 21850763.4351; train_masked_gp_l1_reg_loss: 80497.6662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171831.7084; train_chrom_access_recon_loss: 5061972.3053; train_global_loss: 30446394.8855; train_optim_loss: 30446394.8855; val_kl_reg_loss: 168728.2219; val_edge_recon_loss: 2965553.6000; val_gene_expr_recon_loss: 21789476.6667; val_masked_gp_l1_reg_loss: 82700.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 164323.6562; val_chrom_access_recon_loss: 4985103.8667; val_global_loss: 30155886.6667; val_optim_loss: 30155886.6667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9127; val_auprc_score: 0.8964; val_best_acc_score: 0.8358; val_best_f1_score: 0.8484; train_kl_reg_loss: 162606.9247; train_edge_recon_loss: 2950650.8702; train_gene_expr_recon_loss: 21703177.7252; train_masked_gp_l1_reg_loss: 83679.5898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157853.0766; train_chrom_access_recon_loss: 5038497.9313; train_global_loss: 30096465.8779; train_optim_loss: 30096465.8779; val_kl_reg_loss: 162484.2021; val_edge_recon_loss: 2931481.4167; val_gene_expr_recon_loss: 21698109.6000; val_masked_gp_l1_reg_loss: 84999.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151767.8750; val_chrom_access_recon_loss: 4984696.8333; val_global_loss: 30013540.6667; val_optim_loss: 30013540.6667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9195; val_auprc_score: 0.9061; val_best_acc_score: 0.8430; val_best_f1_score: 0.8545; train_kl_reg_loss: 156287.0528; train_edge_recon_loss: 2913267.7042; train_gene_expr_recon_loss: 21537799.6031; train_masked_gp_l1_reg_loss: 86447.1392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146197.8680; train_chrom_access_recon_loss: 5005444.4580; train_global_loss: 29845443.7863; train_optim_loss: 29845443.7863; val_kl_reg_loss: 162547.1063; val_edge_recon_loss: 2917250.5833; val_gene_expr_recon_loss: 21417226.8000; val_masked_gp_l1_reg_loss: 87787.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140809.3438; val_chrom_access_recon_loss: 4917411.3000; val_global_loss: 29643033.8667; val_optim_loss: 29643033.8667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9285; val_auprc_score: 0.9136; val_best_acc_score: 0.8622; val_best_f1_score: 0.8707; train_kl_reg_loss: 150107.2766; train_edge_recon_loss: 2891937.4256; train_gene_expr_recon_loss: 21471742.7023; train_masked_gp_l1_reg_loss: 89990.3474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136024.4797; train_chrom_access_recon_loss: 4996978.6069; train_global_loss: 29736780.7786; train_optim_loss: 29736780.7786; val_kl_reg_loss: 151265.9292; val_edge_recon_loss: 2872513.9167; val_gene_expr_recon_loss: 21397920.0000; val_masked_gp_l1_reg_loss: 91256.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130977.7812; val_chrom_access_recon_loss: 4913618.5667; val_global_loss: 29557552.1333; val_optim_loss: 29557552.1333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9343; val_auprc_score: 0.9213; val_best_acc_score: 0.8673; val_best_f1_score: 0.8754; train_kl_reg_loss: 147542.4956; train_edge_recon_loss: 2853184.8989; train_gene_expr_recon_loss: 21351207.4656; train_masked_gp_l1_reg_loss: 92293.6746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126143.5178; train_chrom_access_recon_loss: 4975332.3244; train_global_loss: 29545704.2595; train_optim_loss: 29545704.2595; val_kl_reg_loss: 138713.3521; val_edge_recon_loss: 2884295.6833; val_gene_expr_recon_loss: 21345896.5333; val_masked_gp_l1_reg_loss: 93304.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121443.2109; val_chrom_access_recon_loss: 4915786.0333; val_global_loss: 29499439.7333; val_optim_loss: 29499439.7333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9418; val_auprc_score: 0.9292; val_best_acc_score: 0.8786; val_best_f1_score: 0.8842; train_kl_reg_loss: 143833.3624; train_edge_recon_loss: 2836620.3760; train_gene_expr_recon_loss: 21239168.0763; train_masked_gp_l1_reg_loss: 94502.9667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117128.2684; train_chrom_access_recon_loss: 4955169.7901; train_global_loss: 29386422.7481; train_optim_loss: 29386422.7481; val_kl_reg_loss: 145866.7021; val_edge_recon_loss: 2859246.4833; val_gene_expr_recon_loss: 21183250.2667; val_masked_gp_l1_reg_loss: 95634.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112959.1562; val_chrom_access_recon_loss: 4885074.7667; val_global_loss: 29282032.5333; val_optim_loss: 29282032.5333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9491; val_auprc_score: 0.9382; val_best_acc_score: 0.8872; val_best_f1_score: 0.8938; train_kl_reg_loss: 139444.4637; train_edge_recon_loss: 2823606.6088; train_gene_expr_recon_loss: 21191214.1374; train_masked_gp_l1_reg_loss: 96562.8366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109064.5639; train_chrom_access_recon_loss: 4950082.8206; train_global_loss: 29309975.5878; train_optim_loss: 29309975.5878; val_kl_reg_loss: 137378.4708; val_edge_recon_loss: 2829957.8667; val_gene_expr_recon_loss: 21188149.4667; val_masked_gp_l1_reg_loss: 97473.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105308.1328; val_chrom_access_recon_loss: 4891247.4000; val_global_loss: 29249515.2000; val_optim_loss: 29249515.2000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9561; val_auprc_score: 0.9454; val_best_acc_score: 0.8995; val_best_f1_score: 0.9025; train_kl_reg_loss: 135336.6032; train_edge_recon_loss: 2810423.1927; train_gene_expr_recon_loss: 21122579.2977; train_masked_gp_l1_reg_loss: 98459.9982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101821.7017; train_chrom_access_recon_loss: 4935064.3893; train_global_loss: 29203685.0534; train_optim_loss: 29203685.0534; val_kl_reg_loss: 136458.9094; val_edge_recon_loss: 2804827.3833; val_gene_expr_recon_loss: 21117046.6667; val_masked_gp_l1_reg_loss: 99470.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98458.2188; val_chrom_access_recon_loss: 4872609.9000; val_global_loss: 29128870.8000; val_optim_loss: 29128870.8000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9563; val_auprc_score: 0.9441; val_best_acc_score: 0.9006; val_best_f1_score: 0.9048; train_kl_reg_loss: 133836.2201; train_edge_recon_loss: 2795995.7557; train_gene_expr_recon_loss: 21079292.7481; train_masked_gp_l1_reg_loss: 100260.9169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95467.3538; train_chrom_access_recon_loss: 4929038.1527; train_global_loss: 29133891.0534; train_optim_loss: 29133891.0534; val_kl_reg_loss: 132971.6385; val_edge_recon_loss: 2780257.5500; val_gene_expr_recon_loss: 21005932.6667; val_masked_gp_l1_reg_loss: 101134.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92619.7109; val_chrom_access_recon_loss: 4848351.5000; val_global_loss: 28961267.2000; val_optim_loss: 28961267.2000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9586; val_auprc_score: 0.9471; val_best_acc_score: 0.8975; val_best_f1_score: 0.9002; train_kl_reg_loss: 131983.3347; train_edge_recon_loss: 2786777.7004; train_gene_expr_recon_loss: 20992230.4580; train_masked_gp_l1_reg_loss: 101948.1497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89935.7483; train_chrom_access_recon_loss: 4913890.7328; train_global_loss: 29016766.0611; train_optim_loss: 29016766.0611; val_kl_reg_loss: 126065.6427; val_edge_recon_loss: 2801993.3500; val_gene_expr_recon_loss: 21061440.1333; val_masked_gp_l1_reg_loss: 102792.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87393.5000; val_chrom_access_recon_loss: 4863480.2000; val_global_loss: 29043165.0667; val_optim_loss: 29043165.0667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9620; val_auprc_score: 0.9527; val_best_acc_score: 0.9064; val_best_f1_score: 0.9093; train_kl_reg_loss: 127389.4008; train_edge_recon_loss: 2776815.2366; train_gene_expr_recon_loss: 20963897.3588; train_masked_gp_l1_reg_loss: 103492.6783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85039.6923; train_chrom_access_recon_loss: 4908032.3511; train_global_loss: 28964666.7328; train_optim_loss: 28964666.7328; val_kl_reg_loss: 125744.7729; val_edge_recon_loss: 2773044.6833; val_gene_expr_recon_loss: 20977035.8667; val_masked_gp_l1_reg_loss: 104320.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82701.6953; val_chrom_access_recon_loss: 4855120.4667; val_global_loss: 28917968.1333; val_optim_loss: 28917968.1333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9627; val_auprc_score: 0.9530; val_best_acc_score: 0.9069; val_best_f1_score: 0.9109; train_kl_reg_loss: 126544.4285; train_edge_recon_loss: 2768770.9885; train_gene_expr_recon_loss: 20919112.9466; train_masked_gp_l1_reg_loss: 105005.5902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80586.7307; train_chrom_access_recon_loss: 4899205.9198; train_global_loss: 28899226.6565; train_optim_loss: 28899226.6565; val_kl_reg_loss: 124392.0156; val_edge_recon_loss: 2771146.6667; val_gene_expr_recon_loss: 20869140.8000; val_masked_gp_l1_reg_loss: 105774.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78460.0000; val_chrom_access_recon_loss: 4842421.2000; val_global_loss: 28791334.5333; val_optim_loss: 28791334.5333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9649; val_auprc_score: 0.9565; val_best_acc_score: 0.9115; val_best_f1_score: 0.9149; train_kl_reg_loss: 123134.7906; train_edge_recon_loss: 2761580.2462; train_gene_expr_recon_loss: 20864642.5038; train_masked_gp_l1_reg_loss: 106546.4150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76543.8285; train_chrom_access_recon_loss: 4888139.5305; train_global_loss: 28820587.2366; train_optim_loss: 28820587.2366; val_kl_reg_loss: 121192.2651; val_edge_recon_loss: 2758324.5000; val_gene_expr_recon_loss: 20910986.2667; val_masked_gp_l1_reg_loss: 107360.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74702.7109; val_chrom_access_recon_loss: 4842001.2667; val_global_loss: 28814566.2667; val_optim_loss: 28814566.2667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9673; val_auprc_score: 0.9592; val_best_acc_score: 0.9113; val_best_f1_score: 0.9152; train_kl_reg_loss: 121128.4244; train_edge_recon_loss: 2757293.3912; train_gene_expr_recon_loss: 20846629.0992; train_masked_gp_l1_reg_loss: 108072.2171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72782.4346; train_chrom_access_recon_loss: 4889109.8893; train_global_loss: 28795015.4656; train_optim_loss: 28795015.4656; val_kl_reg_loss: 118576.8562; val_edge_recon_loss: 2759622.3833; val_gene_expr_recon_loss: 20900738.5333; val_masked_gp_l1_reg_loss: 108867.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70959.2656; val_chrom_access_recon_loss: 4843023.5333; val_global_loss: 28801789.4667; val_optim_loss: 28801789.4667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9661; val_auprc_score: 0.9577; val_best_acc_score: 0.9122; val_best_f1_score: 0.9149; train_kl_reg_loss: 119411.6768; train_edge_recon_loss: 2753149.2805; train_gene_expr_recon_loss: 20810492.4122; train_masked_gp_l1_reg_loss: 109605.1734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69416.2269; train_chrom_access_recon_loss: 4885462.9618; train_global_loss: 28747537.5573; train_optim_loss: 28747537.5573; val_kl_reg_loss: 120451.8146; val_edge_recon_loss: 2770928.8500; val_gene_expr_recon_loss: 20786495.2000; val_masked_gp_l1_reg_loss: 110389.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67785.3047; val_chrom_access_recon_loss: 4839950.6000; val_global_loss: 28696002.4000; val_optim_loss: 28696002.4000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9701; val_auprc_score: 0.9620; val_best_acc_score: 0.9184; val_best_f1_score: 0.9207; train_kl_reg_loss: 117574.1359; train_edge_recon_loss: 2747298.5019; train_gene_expr_recon_loss: 20777380.9618; train_masked_gp_l1_reg_loss: 111056.1129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66392.8964; train_chrom_access_recon_loss: 4876730.4962; train_global_loss: 28696433.1756; train_optim_loss: 28696433.1756; val_kl_reg_loss: 116490.6880; val_edge_recon_loss: 2748561.0000; val_gene_expr_recon_loss: 20761867.4667; val_masked_gp_l1_reg_loss: 111583.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64945.0742; val_chrom_access_recon_loss: 4805862.8667; val_global_loss: 28609312.2667; val_optim_loss: 28609312.2667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9681; val_auprc_score: 0.9581; val_best_acc_score: 0.9157; val_best_f1_score: 0.9190; train_kl_reg_loss: 115334.9907; train_edge_recon_loss: 2735434.2385; train_gene_expr_recon_loss: 20765045.6489; train_masked_gp_l1_reg_loss: 112384.7443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63646.0564; train_chrom_access_recon_loss: 4880150.8244; train_global_loss: 28671996.5038; train_optim_loss: 28671996.5038; val_kl_reg_loss: 115470.9417; val_edge_recon_loss: 2753479.2833; val_gene_expr_recon_loss: 20706429.8667; val_masked_gp_l1_reg_loss: 113153.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62463.9023; val_chrom_access_recon_loss: 4797189.7000; val_global_loss: 28548187.8667; val_optim_loss: 28548187.8667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9705; val_auprc_score: 0.9615; val_best_acc_score: 0.9208; val_best_f1_score: 0.9235; train_kl_reg_loss: 113667.3987; train_edge_recon_loss: 2738114.6985; train_gene_expr_recon_loss: 20701174.5496; train_masked_gp_l1_reg_loss: 113839.1507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61257.3873; train_chrom_access_recon_loss: 4866726.4733; train_global_loss: 28594779.8015; train_optim_loss: 28594779.8015; val_kl_reg_loss: 113425.0141; val_edge_recon_loss: 2754449.8167; val_gene_expr_recon_loss: 20721691.3333; val_masked_gp_l1_reg_loss: 114646.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60103.3672; val_chrom_access_recon_loss: 4807470.8667; val_global_loss: 28571787.3333; val_optim_loss: 28571787.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9737; val_auprc_score: 0.9682; val_best_acc_score: 0.9219; val_best_f1_score: 0.9239; train_kl_reg_loss: 112377.4213; train_edge_recon_loss: 2730005.8683; train_gene_expr_recon_loss: 20667397.3893; train_masked_gp_l1_reg_loss: 115321.1290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59045.9241; train_chrom_access_recon_loss: 4864103.5763; train_global_loss: 28548251.3435; train_optim_loss: 28548251.3435; val_kl_reg_loss: 112793.4729; val_edge_recon_loss: 2751187.1167; val_gene_expr_recon_loss: 20790852.8000; val_masked_gp_l1_reg_loss: 115987.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58030.6289; val_chrom_access_recon_loss: 4824240.2333; val_global_loss: 28653091.4667; val_optim_loss: 28653091.4667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9724; val_auprc_score: 0.9658; val_best_acc_score: 0.9229; val_best_f1_score: 0.9249; train_kl_reg_loss: 111194.7953; train_edge_recon_loss: 2731599.3263; train_gene_expr_recon_loss: 20659302.9771; train_masked_gp_l1_reg_loss: 116706.5380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57127.1964; train_chrom_access_recon_loss: 4865140.3664; train_global_loss: 28541071.0229; train_optim_loss: 28541071.0229; val_kl_reg_loss: 108543.8500; val_edge_recon_loss: 2754684.7667; val_gene_expr_recon_loss: 20667040.5333; val_masked_gp_l1_reg_loss: 117287.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56255.8359; val_chrom_access_recon_loss: 4797812.6667; val_global_loss: 28501626.0000; val_optim_loss: 28501626.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9765; val_auprc_score: 0.9725; val_best_acc_score: 0.9255; val_best_f1_score: 0.9270; train_kl_reg_loss: 108430.2548; train_edge_recon_loss: 2732710.5515; train_gene_expr_recon_loss: 20629608.9160; train_masked_gp_l1_reg_loss: 118126.1959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55458.8927; train_chrom_access_recon_loss: 4862765.8626; train_global_loss: 28507100.7328; train_optim_loss: 28507100.7328; val_kl_reg_loss: 107975.9240; val_edge_recon_loss: 2731665.0667; val_gene_expr_recon_loss: 20683684.5333; val_masked_gp_l1_reg_loss: 118942.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54672.5703; val_chrom_access_recon_loss: 4808967.0667; val_global_loss: 28505907.0667; val_optim_loss: 28505907.0667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9739; val_auprc_score: 0.9686; val_best_acc_score: 0.9202; val_best_f1_score: 0.9220; train_kl_reg_loss: 126277.7513; train_edge_recon_loss: 2814771.2824; train_gene_expr_recon_loss: 21855863.1908; train_masked_gp_l1_reg_loss: 120186.1964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54892.8340; train_chrom_access_recon_loss: 4964897.8473; train_global_loss: 29936889.1756; train_optim_loss: 29936889.1756; val_kl_reg_loss: 43319.8177; val_edge_recon_loss: 2778038.3667; val_gene_expr_recon_loss: 21617744.8000; val_masked_gp_l1_reg_loss: 121551.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53793.7969; val_chrom_access_recon_loss: 4858660.2000; val_global_loss: 29473109.2000; val_optim_loss: 29473109.2000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9661; val_auprc_score: 0.9594; val_best_acc_score: 0.9073; val_best_f1_score: 0.9092; train_kl_reg_loss: 117315.1690; train_edge_recon_loss: 2788459.1011; train_gene_expr_recon_loss: 21944773.3740; train_masked_gp_l1_reg_loss: 122330.4158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53099.9236; train_chrom_access_recon_loss: 4944965.5916; train_global_loss: 29970943.6336; train_optim_loss: 29970943.6336; val_kl_reg_loss: 30774.2263; val_edge_recon_loss: 2809527.6167; val_gene_expr_recon_loss: 22532139.2000; val_masked_gp_l1_reg_loss: 123890.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53540.5469; val_chrom_access_recon_loss: 4913048.2000; val_global_loss: 30462919.4667; val_optim_loss: 30462919.4667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9572; val_auprc_score: 0.9483; val_best_acc_score: 0.8971; val_best_f1_score: 0.9018; train_kl_reg_loss: 120745.9620; train_edge_recon_loss: 2816178.7099; train_gene_expr_recon_loss: 23619455.9542; train_masked_gp_l1_reg_loss: 125204.4829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54817.0833; train_chrom_access_recon_loss: 5009865.2710; train_global_loss: 31746267.3740; train_optim_loss: 31746267.3740; val_kl_reg_loss: 22651.9388; val_edge_recon_loss: 2788103.4500; val_gene_expr_recon_loss: 23861664.8000; val_masked_gp_l1_reg_loss: 124481.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54917.4492; val_chrom_access_recon_loss: 4957219.9333; val_global_loss: 31809039.6000; val_optim_loss: 31809039.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9530; val_auprc_score: 0.9397; val_best_acc_score: 0.8936; val_best_f1_score: 0.8998; train_kl_reg_loss: 98181.0533; train_edge_recon_loss: 2767790.9389; train_gene_expr_recon_loss: 23855870.2595; train_masked_gp_l1_reg_loss: 123954.9714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54707.9991; train_chrom_access_recon_loss: 5021908.6794; train_global_loss: 31922413.9084; train_optim_loss: 31922413.9084; val_kl_reg_loss: 24889.2316; val_edge_recon_loss: 2782575.7667; val_gene_expr_recon_loss: 23853524.8000; val_masked_gp_l1_reg_loss: 123671.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54514.2383; val_chrom_access_recon_loss: 4974698.1333; val_global_loss: 31813874.1333; val_optim_loss: 31813874.1333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9469; val_auprc_score: 0.9356; val_best_acc_score: 0.8855; val_best_f1_score: 0.8913; train_kl_reg_loss: 96340.0005; train_edge_recon_loss: 2799835.7080; train_gene_expr_recon_loss: 23821601.8321; train_masked_gp_l1_reg_loss: 123401.7219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54338.0208; train_chrom_access_recon_loss: 5014812.4656; train_global_loss: 31910329.5267; train_optim_loss: 31910329.5267; val_kl_reg_loss: 21998.3835; val_edge_recon_loss: 2807255.3167; val_gene_expr_recon_loss: 23909543.7333; val_masked_gp_l1_reg_loss: 123116.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54151.6602; val_chrom_access_recon_loss: 4965274.6000; val_global_loss: 31881340.0000; val_optim_loss: 31881340.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9509; val_auprc_score: 0.9405; val_best_acc_score: 0.8898; val_best_f1_score: 0.8949; train_kl_reg_loss: 93729.6353; train_edge_recon_loss: 2783557.0324; train_gene_expr_recon_loss: 23900537.5420; train_masked_gp_l1_reg_loss: 122798.1201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53967.6209; train_chrom_access_recon_loss: 5015378.7290; train_global_loss: 31969968.6412; train_optim_loss: 31969968.6412; val_kl_reg_loss: 23373.7346; val_edge_recon_loss: 2785227.2500; val_gene_expr_recon_loss: 24069870.4000; val_masked_gp_l1_reg_loss: 122464.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53799.0547; val_chrom_access_recon_loss: 4968421.0333; val_global_loss: 32023156.4000; val_optim_loss: 32023156.4000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9461; val_auprc_score: 0.9311; val_best_acc_score: 0.8886; val_best_f1_score: 0.8951; train_kl_reg_loss: 90364.9632; train_edge_recon_loss: 2776180.7672; train_gene_expr_recon_loss: 23993202.1374; train_masked_gp_l1_reg_loss: 122119.4188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53641.8158; train_chrom_access_recon_loss: 5015142.3893; train_global_loss: 32050651.4962; train_optim_loss: 32050651.4962; val_kl_reg_loss: 25103.7090; val_edge_recon_loss: 2766967.2833; val_gene_expr_recon_loss: 24015464.4000; val_masked_gp_l1_reg_loss: 121760.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53469.9531; val_chrom_access_recon_loss: 4967728.9667; val_global_loss: 31950494.4000; val_optim_loss: 31950494.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 58 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9740
val AUPRC score: 0.9667
val best accuracy score: 0.9231
val best F1 score: 0.9251
val target rna MSE score: 1.8005
val source rna MSE score: 99.0728
val target atac MSE score: 0.3419
val source atac MSE score: 3.8619
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
