[True]
Run timestamp: 10082023_220739_71.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_71']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6983; val_auprc_score: 0.7406; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 110804.9005; train_edge_recon_loss: 3788030.1164; train_gene_expr_recon_loss: 44460298.4427; train_masked_gp_l1_reg_loss: 82906.5776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244453.9241; train_chrom_access_recon_loss: 1384845.4962; train_global_loss: 50071339.1450; train_optim_loss: 50071339.1450; val_kl_reg_loss: 54440.8701; val_edge_recon_loss: 4065639.5500; val_gene_expr_recon_loss: 39705354.6667; val_masked_gp_l1_reg_loss: 81115.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 238858.4531; val_chrom_access_recon_loss: 1307385.4250; val_global_loss: 45452797.0667; val_optim_loss: 45452797.0667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7289; val_auprc_score: 0.7633; val_best_acc_score: 0.5261; val_best_f1_score: 0.6771; train_kl_reg_loss: 141133.5187; train_edge_recon_loss: 3690711.7767; train_gene_expr_recon_loss: 39151734.1374; train_masked_gp_l1_reg_loss: 85053.5853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 233613.2337; train_chrom_access_recon_loss: 1295225.9475; train_global_loss: 44597472.1832; train_optim_loss: 44597472.1832; val_kl_reg_loss: 168837.8062; val_edge_recon_loss: 4063763.5667; val_gene_expr_recon_loss: 37303649.0667; val_masked_gp_l1_reg_loss: 84189.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 227061.1875; val_chrom_access_recon_loss: 1269086.0750; val_global_loss: 43116584.0000; val_optim_loss: 43116584.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7727; val_auprc_score: 0.7927; val_best_acc_score: 0.5966; val_best_f1_score: 0.7027; train_kl_reg_loss: 164171.1110; train_edge_recon_loss: 3565680.1679; train_gene_expr_recon_loss: 37318487.6031; train_masked_gp_l1_reg_loss: 82653.8488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 220071.9371; train_chrom_access_recon_loss: 1270977.1784; train_global_loss: 42622041.7405; train_optim_loss: 42622041.7405; val_kl_reg_loss: 157162.2552; val_edge_recon_loss: 4058954.4167; val_gene_expr_recon_loss: 36590799.2000; val_masked_gp_l1_reg_loss: 80853.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 212960.2812; val_chrom_access_recon_loss: 1264230.5417; val_global_loss: 42364958.4000; val_optim_loss: 42364958.4000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8671; val_auprc_score: 0.8705; val_best_acc_score: 0.7812; val_best_f1_score: 0.7645; train_kl_reg_loss: 154880.2846; train_edge_recon_loss: 3545459.4542; train_gene_expr_recon_loss: 36759237.2824; train_masked_gp_l1_reg_loss: 80781.6836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 206288.6817; train_chrom_access_recon_loss: 1261220.8645; train_global_loss: 42007868.3664; train_optim_loss: 42007868.3664; val_kl_reg_loss: 166072.4688; val_edge_recon_loss: 3982719.7500; val_gene_expr_recon_loss: 36224081.3333; val_masked_gp_l1_reg_loss: 81764.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 199777.0000; val_chrom_access_recon_loss: 1253213.9833; val_global_loss: 41907626.9333; val_optim_loss: 41907626.9333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8884; val_auprc_score: 0.8747; val_best_acc_score: 0.8057; val_best_f1_score: 0.8233; train_kl_reg_loss: 134128.6710; train_edge_recon_loss: 3464280.1240; train_gene_expr_recon_loss: 36472144.8550; train_masked_gp_l1_reg_loss: 83039.9770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 194220.2710; train_chrom_access_recon_loss: 1255636.1660; train_global_loss: 41603450.2901; train_optim_loss: 41603450.2901; val_kl_reg_loss: 124174.5734; val_edge_recon_loss: 3398374.7000; val_gene_expr_recon_loss: 35670553.0667; val_masked_gp_l1_reg_loss: 84524.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189160.6094; val_chrom_access_recon_loss: 1236359.9167; val_global_loss: 40703146.9333; val_optim_loss: 40703146.9333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8873; val_auprc_score: 0.8748; val_best_acc_score: 0.8002; val_best_f1_score: 0.8159; train_kl_reg_loss: 155920.6675; train_edge_recon_loss: 3120705.0210; train_gene_expr_recon_loss: 36206351.0840; train_masked_gp_l1_reg_loss: 86975.3429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 184512.4739; train_chrom_access_recon_loss: 1248707.8378; train_global_loss: 41003172.3053; train_optim_loss: 41003172.3053; val_kl_reg_loss: 173859.8031; val_edge_recon_loss: 3032343.7333; val_gene_expr_recon_loss: 35571219.4667; val_masked_gp_l1_reg_loss: 88217.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179737.9219; val_chrom_access_recon_loss: 1234312.8667; val_global_loss: 40279688.5333; val_optim_loss: 40279688.5333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9019; val_auprc_score: 0.8932; val_best_acc_score: 0.8122; val_best_f1_score: 0.8287; train_kl_reg_loss: 169089.1313; train_edge_recon_loss: 3013967.0076; train_gene_expr_recon_loss: 35970037.8321; train_masked_gp_l1_reg_loss: 89430.4099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 174950.9021; train_chrom_access_recon_loss: 1242706.9399; train_global_loss: 40660181.8931; train_optim_loss: 40660181.8931; val_kl_reg_loss: 168654.2073; val_edge_recon_loss: 2992183.8667; val_gene_expr_recon_loss: 35551011.4667; val_masked_gp_l1_reg_loss: 90633.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 170188.3281; val_chrom_access_recon_loss: 1238336.2167; val_global_loss: 40211005.3333; val_optim_loss: 40211005.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9102; val_auprc_score: 0.9009; val_best_acc_score: 0.8231; val_best_f1_score: 0.8337; train_kl_reg_loss: 164869.7817; train_edge_recon_loss: 2980919.0744; train_gene_expr_recon_loss: 35794936.1679; train_masked_gp_l1_reg_loss: 91764.4239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165831.9314; train_chrom_access_recon_loss: 1239654.5334; train_global_loss: 40437975.5420; train_optim_loss: 40437975.5420; val_kl_reg_loss: 157835.3219; val_edge_recon_loss: 2974477.8000; val_gene_expr_recon_loss: 35263794.9333; val_masked_gp_l1_reg_loss: 93143.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161560.4219; val_chrom_access_recon_loss: 1231305.1417; val_global_loss: 39882116.5333; val_optim_loss: 39882116.5333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9147; val_auprc_score: 0.9081; val_best_acc_score: 0.8304; val_best_f1_score: 0.8347; train_kl_reg_loss: 158023.3008; train_edge_recon_loss: 2955875.6851; train_gene_expr_recon_loss: 35631304.0916; train_masked_gp_l1_reg_loss: 94125.7659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157594.4238; train_chrom_access_recon_loss: 1235231.5391; train_global_loss: 40232154.8702; train_optim_loss: 40232154.8702; val_kl_reg_loss: 154818.0688; val_edge_recon_loss: 2958705.1333; val_gene_expr_recon_loss: 35112063.4667; val_masked_gp_l1_reg_loss: 95122.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153697.0625; val_chrom_access_recon_loss: 1230559.1333; val_global_loss: 39704966.1333; val_optim_loss: 39704966.1333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9209; val_auprc_score: 0.9096; val_best_acc_score: 0.8440; val_best_f1_score: 0.8537; train_kl_reg_loss: 153572.7716; train_edge_recon_loss: 2916695.5305; train_gene_expr_recon_loss: 35461412.4580; train_masked_gp_l1_reg_loss: 96238.9575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150034.8398; train_chrom_access_recon_loss: 1230809.4265; train_global_loss: 40008764.0000; train_optim_loss: 40008764.0000; val_kl_reg_loss: 152605.7167; val_edge_recon_loss: 2903700.3333; val_gene_expr_recon_loss: 34943922.4000; val_masked_gp_l1_reg_loss: 97299.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146382.5000; val_chrom_access_recon_loss: 1217830.4333; val_global_loss: 39461744.0000; val_optim_loss: 39461744.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9303; val_auprc_score: 0.9218; val_best_acc_score: 0.8546; val_best_f1_score: 0.8615; train_kl_reg_loss: 150279.2439; train_edge_recon_loss: 2900350.4065; train_gene_expr_recon_loss: 35331578.5802; train_masked_gp_l1_reg_loss: 98244.2985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143088.1888; train_chrom_access_recon_loss: 1227429.6202; train_global_loss: 39850970.4733; train_optim_loss: 39850970.4733; val_kl_reg_loss: 150790.0375; val_edge_recon_loss: 2891389.5333; val_gene_expr_recon_loss: 34791321.3333; val_masked_gp_l1_reg_loss: 99061.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139804.9688; val_chrom_access_recon_loss: 1215770.9333; val_global_loss: 39288135.7333; val_optim_loss: 39288135.7333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9330; val_auprc_score: 0.9219; val_best_acc_score: 0.8580; val_best_f1_score: 0.8659; train_kl_reg_loss: 149314.8266; train_edge_recon_loss: 2863234.3836; train_gene_expr_recon_loss: 35187801.6031; train_masked_gp_l1_reg_loss: 100072.3063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136745.6756; train_chrom_access_recon_loss: 1223553.8569; train_global_loss: 39660722.8397; train_optim_loss: 39660722.8397; val_kl_reg_loss: 148067.3823; val_edge_recon_loss: 2892896.4500; val_gene_expr_recon_loss: 34773043.8667; val_masked_gp_l1_reg_loss: 101366.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133728.6719; val_chrom_access_recon_loss: 1217522.4833; val_global_loss: 39266626.1333; val_optim_loss: 39266626.1333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9415; val_auprc_score: 0.9322; val_best_acc_score: 0.8686; val_best_f1_score: 0.8760; train_kl_reg_loss: 145697.8584; train_edge_recon_loss: 2854072.0763; train_gene_expr_recon_loss: 35138971.7710; train_masked_gp_l1_reg_loss: 102545.7450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130870.6888; train_chrom_access_recon_loss: 1222711.0134; train_global_loss: 39594869.1298; train_optim_loss: 39594869.1298; val_kl_reg_loss: 138579.6896; val_edge_recon_loss: 2862690.2833; val_gene_expr_recon_loss: 34713921.6000; val_masked_gp_l1_reg_loss: 103422.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127976.6094; val_chrom_access_recon_loss: 1215718.3417; val_global_loss: 39162309.6000; val_optim_loss: 39162309.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9432; val_auprc_score: 0.9324; val_best_acc_score: 0.8756; val_best_f1_score: 0.8813; train_kl_reg_loss: 142145.8084; train_edge_recon_loss: 2842108.5095; train_gene_expr_recon_loss: 35017660.2748; train_masked_gp_l1_reg_loss: 104183.5370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125328.4565; train_chrom_access_recon_loss: 1220033.2929; train_global_loss: 39451459.6947; train_optim_loss: 39451459.6947; val_kl_reg_loss: 140089.9740; val_edge_recon_loss: 2847039.3833; val_gene_expr_recon_loss: 34558739.2000; val_masked_gp_l1_reg_loss: 104972.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122559.9141; val_chrom_access_recon_loss: 1208622.7500; val_global_loss: 38982023.2000; val_optim_loss: 38982023.2000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9469; val_auprc_score: 0.9376; val_best_acc_score: 0.8795; val_best_f1_score: 0.8854; train_kl_reg_loss: 141612.6658; train_edge_recon_loss: 2830301.2538; train_gene_expr_recon_loss: 34953711.3130; train_masked_gp_l1_reg_loss: 105882.3426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119989.9497; train_chrom_access_recon_loss: 1218141.6956; train_global_loss: 39369639.5115; train_optim_loss: 39369639.5115; val_kl_reg_loss: 136834.9109; val_edge_recon_loss: 2820247.6167; val_gene_expr_recon_loss: 34337537.6000; val_masked_gp_l1_reg_loss: 106879.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117486.6250; val_chrom_access_recon_loss: 1201312.6667; val_global_loss: 38720300.8000; val_optim_loss: 38720300.8000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9514; val_auprc_score: 0.9420; val_best_acc_score: 0.8848; val_best_f1_score: 0.8909; train_kl_reg_loss: 137706.3780; train_edge_recon_loss: 2815564.7996; train_gene_expr_recon_loss: 34888461.8779; train_masked_gp_l1_reg_loss: 107776.8873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115026.6298; train_chrom_access_recon_loss: 1216832.4351; train_global_loss: 39281368.7328; train_optim_loss: 39281368.7328; val_kl_reg_loss: 137366.0063; val_edge_recon_loss: 2821101.4167; val_gene_expr_recon_loss: 34529190.9333; val_masked_gp_l1_reg_loss: 108754.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112645.6641; val_chrom_access_recon_loss: 1210443.8667; val_global_loss: 38919502.4000; val_optim_loss: 38919502.4000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9509; val_auprc_score: 0.9422; val_best_acc_score: 0.8848; val_best_f1_score: 0.8893; train_kl_reg_loss: 136171.9903; train_edge_recon_loss: 2804472.1489; train_gene_expr_recon_loss: 34822041.2824; train_masked_gp_l1_reg_loss: 109547.9891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110425.3718; train_chrom_access_recon_loss: 1216464.3836; train_global_loss: 39199123.1756; train_optim_loss: 39199123.1756; val_kl_reg_loss: 133453.2833; val_edge_recon_loss: 2824975.7000; val_gene_expr_recon_loss: 34294395.7333; val_masked_gp_l1_reg_loss: 110584.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108232.3828; val_chrom_access_recon_loss: 1204464.9500; val_global_loss: 38676105.6000; val_optim_loss: 38676105.6000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9576; val_auprc_score: 0.9496; val_best_acc_score: 0.8915; val_best_f1_score: 0.8965; train_kl_reg_loss: 133597.3284; train_edge_recon_loss: 2795678.8149; train_gene_expr_recon_loss: 34740086.5191; train_masked_gp_l1_reg_loss: 111312.9340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106234.6758; train_chrom_access_recon_loss: 1213527.8960; train_global_loss: 39100437.9542; train_optim_loss: 39100437.9542; val_kl_reg_loss: 131964.9672; val_edge_recon_loss: 2793410.3500; val_gene_expr_recon_loss: 34276808.1333; val_masked_gp_l1_reg_loss: 112261.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104215.7578; val_chrom_access_recon_loss: 1206990.3417; val_global_loss: 38625649.8667; val_optim_loss: 38625649.8667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9561; val_auprc_score: 0.9451; val_best_acc_score: 0.8945; val_best_f1_score: 0.8989; train_kl_reg_loss: 133041.5468; train_edge_recon_loss: 2781569.6431; train_gene_expr_recon_loss: 34712734.4122; train_masked_gp_l1_reg_loss: 113025.8059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102352.9595; train_chrom_access_recon_loss: 1213745.8225; train_global_loss: 39056470.0153; train_optim_loss: 39056470.0153; val_kl_reg_loss: 132439.4630; val_edge_recon_loss: 2796098.4667; val_gene_expr_recon_loss: 34329308.5333; val_masked_gp_l1_reg_loss: 113786.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100450.5156; val_chrom_access_recon_loss: 1210899.4667; val_global_loss: 38682986.1333; val_optim_loss: 38682986.1333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9602; val_auprc_score: 0.9518; val_best_acc_score: 0.9025; val_best_f1_score: 0.9061; train_kl_reg_loss: 130712.8379; train_edge_recon_loss: 2776685.0954; train_gene_expr_recon_loss: 34657150.2595; train_masked_gp_l1_reg_loss: 114643.0649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98703.7281; train_chrom_access_recon_loss: 1212119.8073; train_global_loss: 38990014.6870; train_optim_loss: 38990014.6870; val_kl_reg_loss: 126538.7776; val_edge_recon_loss: 2798349.4167; val_gene_expr_recon_loss: 34365906.4000; val_masked_gp_l1_reg_loss: 115405.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97007.3516; val_chrom_access_recon_loss: 1210672.6917; val_global_loss: 38713878.9333; val_optim_loss: 38713878.9333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9611; val_auprc_score: 0.9536; val_best_acc_score: 0.9015; val_best_f1_score: 0.9066; train_kl_reg_loss: 128099.4394; train_edge_recon_loss: 2766761.4103; train_gene_expr_recon_loss: 34627631.9542; train_masked_gp_l1_reg_loss: 116343.1246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95384.7605; train_chrom_access_recon_loss: 1212263.7185; train_global_loss: 38946484.6107; train_optim_loss: 38946484.6107; val_kl_reg_loss: 127247.9917; val_edge_recon_loss: 2771338.8833; val_gene_expr_recon_loss: 34149874.6667; val_masked_gp_l1_reg_loss: 117246.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93729.4844; val_chrom_access_recon_loss: 1201926.6417; val_global_loss: 38461364.5333; val_optim_loss: 38461364.5333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9604; val_auprc_score: 0.9526; val_best_acc_score: 0.8998; val_best_f1_score: 0.9039; train_kl_reg_loss: 126650.6550; train_edge_recon_loss: 2767654.3511; train_gene_expr_recon_loss: 34523582.8092; train_masked_gp_l1_reg_loss: 117882.3159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92224.3068; train_chrom_access_recon_loss: 1210028.5821; train_global_loss: 38838023.0840; train_optim_loss: 38838023.0840; val_kl_reg_loss: 125551.6932; val_edge_recon_loss: 2773690.0333; val_gene_expr_recon_loss: 33992053.7333; val_masked_gp_l1_reg_loss: 118703.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90707.1250; val_chrom_access_recon_loss: 1197514.8167; val_global_loss: 38298222.6667; val_optim_loss: 38298222.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9621; val_auprc_score: 0.9520; val_best_acc_score: 0.9074; val_best_f1_score: 0.9109; train_kl_reg_loss: 124391.3767; train_edge_recon_loss: 2762532.4676; train_gene_expr_recon_loss: 34483621.9237; train_masked_gp_l1_reg_loss: 119439.8134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89281.8699; train_chrom_access_recon_loss: 1209407.7567; train_global_loss: 38788675.1756; train_optim_loss: 38788675.1756; val_kl_reg_loss: 120242.9495; val_edge_recon_loss: 2780367.0167; val_gene_expr_recon_loss: 34066884.0000; val_masked_gp_l1_reg_loss: 120270.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87908.5547; val_chrom_access_recon_loss: 1197884.3583; val_global_loss: 38373558.9333; val_optim_loss: 38373558.9333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9631; val_auprc_score: 0.9497; val_best_acc_score: 0.9080; val_best_f1_score: 0.9108; train_kl_reg_loss: 122832.2767; train_edge_recon_loss: 2755544.6527; train_gene_expr_recon_loss: 34470830.8092; train_masked_gp_l1_reg_loss: 121043.1623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86517.9779; train_chrom_access_recon_loss: 1210370.0067; train_global_loss: 38767138.9924; train_optim_loss: 38767138.9924; val_kl_reg_loss: 122414.3760; val_edge_recon_loss: 2752322.4833; val_gene_expr_recon_loss: 34157214.6667; val_masked_gp_l1_reg_loss: 121802.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85204.2500; val_chrom_access_recon_loss: 1205329.1750; val_global_loss: 38444288.8000; val_optim_loss: 38444288.8000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9650; val_auprc_score: 0.9566; val_best_acc_score: 0.9077; val_best_f1_score: 0.9113; train_kl_reg_loss: 122479.4229; train_edge_recon_loss: 2749782.8492; train_gene_expr_recon_loss: 34388929.4198; train_masked_gp_l1_reg_loss: 122619.2612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83994.0810; train_chrom_access_recon_loss: 1207752.8044; train_global_loss: 38675557.7099; train_optim_loss: 38675557.7099; val_kl_reg_loss: 121548.9740; val_edge_recon_loss: 2773459.6833; val_gene_expr_recon_loss: 34116836.0000; val_masked_gp_l1_reg_loss: 123287.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82715.2109; val_chrom_access_recon_loss: 1202651.9917; val_global_loss: 38420500.5333; val_optim_loss: 38420500.5333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9514; val_auprc_score: 0.9404; val_best_acc_score: 0.8872; val_best_f1_score: 0.8925; train_kl_reg_loss: 152438.8582; train_edge_recon_loss: 3007314.9885; train_gene_expr_recon_loss: 38352950.4427; train_masked_gp_l1_reg_loss: 125931.9905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91392.7524; train_chrom_access_recon_loss: 1268180.0248; train_global_loss: 42998208.7634; train_optim_loss: 42998208.7634; val_kl_reg_loss: 21488.1609; val_edge_recon_loss: 2972965.2667; val_gene_expr_recon_loss: 37699155.7333; val_masked_gp_l1_reg_loss: 127238.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93557.1484; val_chrom_access_recon_loss: 1253158.1917; val_global_loss: 42167563.2000; val_optim_loss: 42167563.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9535; val_auprc_score: 0.9465; val_best_acc_score: 0.8915; val_best_f1_score: 0.8963; train_kl_reg_loss: 159045.5658; train_edge_recon_loss: 2981165.7500; train_gene_expr_recon_loss: 39208403.8779; train_masked_gp_l1_reg_loss: 127018.6569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93793.6583; train_chrom_access_recon_loss: 1267743.0582; train_global_loss: 43837170.9924; train_optim_loss: 43837170.9924; val_kl_reg_loss: 17541.7033; val_edge_recon_loss: 2989219.6667; val_gene_expr_recon_loss: 39176393.3333; val_masked_gp_l1_reg_loss: 127004.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94159.9453; val_chrom_access_recon_loss: 1258687.3833; val_global_loss: 43663006.1333; val_optim_loss: 43663006.1333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9561; val_auprc_score: 0.9495; val_best_acc_score: 0.8945; val_best_f1_score: 0.8989; train_kl_reg_loss: 156374.3952; train_edge_recon_loss: 2964649.7156; train_gene_expr_recon_loss: 39798087.5115; train_masked_gp_l1_reg_loss: 126953.6518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94479.3821; train_chrom_access_recon_loss: 1274025.5095; train_global_loss: 44414570.0763; train_optim_loss: 44414570.0763; val_kl_reg_loss: 16838.7551; val_edge_recon_loss: 2952182.4000; val_gene_expr_recon_loss: 39540942.4000; val_masked_gp_l1_reg_loss: 126908.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94715.1016; val_chrom_access_recon_loss: 1263942.5083; val_global_loss: 43995529.8667; val_optim_loss: 43995529.8667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9578; val_auprc_score: 0.9483; val_best_acc_score: 0.8975; val_best_f1_score: 0.9011; train_kl_reg_loss: 150523.0427; train_edge_recon_loss: 2939115.4981; train_gene_expr_recon_loss: 40187480.5496; train_masked_gp_l1_reg_loss: 126825.7253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94814.4243; train_chrom_access_recon_loss: 1271296.0038; train_global_loss: 44770055.1145; train_optim_loss: 44770055.1145; val_kl_reg_loss: 16289.9393; val_edge_recon_loss: 2917925.6667; val_gene_expr_recon_loss: 40025235.4667; val_masked_gp_l1_reg_loss: 126722.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94888.9609; val_chrom_access_recon_loss: 1269121.6500; val_global_loss: 44450184.5333; val_optim_loss: 44450184.5333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9509; val_auprc_score: 0.9424; val_best_acc_score: 0.8879; val_best_f1_score: 0.8921; train_kl_reg_loss: 143092.7830; train_edge_recon_loss: 2909988.8607; train_gene_expr_recon_loss: 40506788.3664; train_masked_gp_l1_reg_loss: 126540.8949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94785.5985; train_chrom_access_recon_loss: 1272734.2605; train_global_loss: 45053930.6260; train_optim_loss: 45053930.6260; val_kl_reg_loss: 17444.1206; val_edge_recon_loss: 2921191.4667; val_gene_expr_recon_loss: 40246578.1333; val_masked_gp_l1_reg_loss: 126334.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94582.7422; val_chrom_access_recon_loss: 1268568.7333; val_global_loss: 44674702.6667; val_optim_loss: 44674702.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 31 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9656
val AUPRC score: 0.9584
val best accuracy score: 0.9072
val best F1 score: 0.9102
val target rna MSE score: 1.3697
val source rna MSE score: 33.7151
val target atac MSE score: 0.5969
val source atac MSE score: 15.9360
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
