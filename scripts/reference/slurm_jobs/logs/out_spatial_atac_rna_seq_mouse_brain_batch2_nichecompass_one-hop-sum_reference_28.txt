[True]
Run timestamp: 10082023_200620_28.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_28']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7695; val_auprc_score: 0.7913; val_best_acc_score: 0.6032; val_best_f1_score: 0.7086; train_kl_reg_loss: 213111.3529; train_edge_recon_loss: 3780545.3511; train_gene_expr_recon_loss: 30603285.8321; train_masked_gp_l1_reg_loss: 88225.1170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245761.1639; train_chrom_access_recon_loss: 78670591.0840; train_global_loss: 113601520.0000; train_optim_loss: 113601520.0000; val_kl_reg_loss: 226528.7073; val_edge_recon_loss: 4059776.2833; val_gene_expr_recon_loss: 24117581.6000; val_masked_gp_l1_reg_loss: 86701.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 241832.4688; val_chrom_access_recon_loss: 69655626.1333; val_global_loss: 98388047.4667; val_optim_loss: 98388047.4667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7996; val_auprc_score: 0.8172; val_best_acc_score: 0.7071; val_best_f1_score: 0.7251; train_kl_reg_loss: 222511.7997; train_edge_recon_loss: 3606751.8607; train_gene_expr_recon_loss: 22930049.2214; train_masked_gp_l1_reg_loss: 79842.2013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 236349.9356; train_chrom_access_recon_loss: 69267299.2366; train_global_loss: 96342804.2137; train_optim_loss: 96342804.2137; val_kl_reg_loss: 219167.2812; val_edge_recon_loss: 4040911.9500; val_gene_expr_recon_loss: 22577007.8667; val_masked_gp_l1_reg_loss: 75975.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 229788.8750; val_chrom_access_recon_loss: 68912097.8667; val_global_loss: 96054948.8000; val_optim_loss: 96054948.8000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8721; val_auprc_score: 0.8696; val_best_acc_score: 0.7763; val_best_f1_score: 0.7953; train_kl_reg_loss: 183795.7551; train_edge_recon_loss: 3509687.8989; train_gene_expr_recon_loss: 22330705.7405; train_masked_gp_l1_reg_loss: 75780.4208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 222534.1287; train_chrom_access_recon_loss: 68808967.2977; train_global_loss: 95131470.9008; train_optim_loss: 95131470.9008; val_kl_reg_loss: 162349.8667; val_edge_recon_loss: 3327156.4333; val_gene_expr_recon_loss: 22286530.2667; val_masked_gp_l1_reg_loss: 76486.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 215056.2969; val_chrom_access_recon_loss: 68383180.5333; val_global_loss: 94450759.4667; val_optim_loss: 94450759.4667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8838; val_auprc_score: 0.8690; val_best_acc_score: 0.8037; val_best_f1_score: 0.8229; train_kl_reg_loss: 206994.7946; train_edge_recon_loss: 3095777.0840; train_gene_expr_recon_loss: 22112718.3206; train_masked_gp_l1_reg_loss: 77496.1261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 207788.5767; train_chrom_access_recon_loss: 68281677.8321; train_global_loss: 93982452.8855; train_optim_loss: 93982452.8855; val_kl_reg_loss: 206044.1542; val_edge_recon_loss: 3067816.0500; val_gene_expr_recon_loss: 22051760.4000; val_masked_gp_l1_reg_loss: 77924.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 200536.0156; val_chrom_access_recon_loss: 67718143.7333; val_global_loss: 93322224.5333; val_optim_loss: 93322224.5333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8942; val_auprc_score: 0.8760; val_best_acc_score: 0.8143; val_best_f1_score: 0.8324; train_kl_reg_loss: 207491.9968; train_edge_recon_loss: 3012011.2443; train_gene_expr_recon_loss: 21945252.1069; train_masked_gp_l1_reg_loss: 78857.0144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 193543.9915; train_chrom_access_recon_loss: 67966867.1756; train_global_loss: 93404023.5115; train_optim_loss: 93404023.5115; val_kl_reg_loss: 204636.3500; val_edge_recon_loss: 2974712.9833; val_gene_expr_recon_loss: 21912157.3333; val_masked_gp_l1_reg_loss: 79713.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 186625.4688; val_chrom_access_recon_loss: 67422111.2000; val_global_loss: 92779958.4000; val_optim_loss: 92779958.4000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9096; val_auprc_score: 0.8945; val_best_acc_score: 0.8290; val_best_f1_score: 0.8432; train_kl_reg_loss: 199036.4778; train_edge_recon_loss: 2955560.6889; train_gene_expr_recon_loss: 21821007.0382; train_masked_gp_l1_reg_loss: 80475.6224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180209.8690; train_chrom_access_recon_loss: 67627182.5038; train_global_loss: 92863472.2443; train_optim_loss: 92863472.2443; val_kl_reg_loss: 193581.0323; val_edge_recon_loss: 2931244.6333; val_gene_expr_recon_loss: 21827239.6000; val_masked_gp_l1_reg_loss: 81425.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173955.6875; val_chrom_access_recon_loss: 67413072.2667; val_global_loss: 92620519.4667; val_optim_loss: 92620519.4667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9202; val_auprc_score: 0.9043; val_best_acc_score: 0.8475; val_best_f1_score: 0.8587; train_kl_reg_loss: 191191.5930; train_edge_recon_loss: 2925113.1546; train_gene_expr_recon_loss: 21667030.7176; train_masked_gp_l1_reg_loss: 82262.5191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 168150.1134; train_chrom_access_recon_loss: 67142913.4046; train_global_loss: 92176661.4351; train_optim_loss: 92176661.4351; val_kl_reg_loss: 187759.3844; val_edge_recon_loss: 2898912.0333; val_gene_expr_recon_loss: 21724767.3333; val_masked_gp_l1_reg_loss: 83321.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162437.0156; val_chrom_access_recon_loss: 66986522.6667; val_global_loss: 92043719.4667; val_optim_loss: 92043719.4667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9263; val_auprc_score: 0.9090; val_best_acc_score: 0.8576; val_best_f1_score: 0.8675; train_kl_reg_loss: 184573.5415; train_edge_recon_loss: 2899302.9599; train_gene_expr_recon_loss: 21545129.6489; train_masked_gp_l1_reg_loss: 84134.4943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157141.7847; train_chrom_access_recon_loss: 66733777.9237; train_global_loss: 91604060.1527; train_optim_loss: 91604060.1527; val_kl_reg_loss: 181064.9198; val_edge_recon_loss: 2891597.5667; val_gene_expr_recon_loss: 21537448.1333; val_masked_gp_l1_reg_loss: 85135.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152038.3438; val_chrom_access_recon_loss: 66262829.0667; val_global_loss: 91110113.0667; val_optim_loss: 91110113.0667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9283; val_auprc_score: 0.9126; val_best_acc_score: 0.8603; val_best_f1_score: 0.8712; train_kl_reg_loss: 180423.0819; train_edge_recon_loss: 2869896.8435; train_gene_expr_recon_loss: 21471363.7405; train_masked_gp_l1_reg_loss: 86042.5151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147328.5641; train_chrom_access_recon_loss: 66656377.0992; train_global_loss: 91411432.1221; train_optim_loss: 91411432.1221; val_kl_reg_loss: 178780.7885; val_edge_recon_loss: 2884094.6833; val_gene_expr_recon_loss: 21566923.3333; val_masked_gp_l1_reg_loss: 86908.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142828.8906; val_chrom_access_recon_loss: 66805267.7333; val_global_loss: 91664802.6667; val_optim_loss: 91664802.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9410; val_auprc_score: 0.9266; val_best_acc_score: 0.8771; val_best_f1_score: 0.8837; train_kl_reg_loss: 177389.2752; train_edge_recon_loss: 2844335.0382; train_gene_expr_recon_loss: 21388147.0534; train_masked_gp_l1_reg_loss: 87880.8478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138673.0373; train_chrom_access_recon_loss: 66376693.3740; train_global_loss: 91013118.3511; train_optim_loss: 91013118.3511; val_kl_reg_loss: 176570.4281; val_edge_recon_loss: 2855226.8500; val_gene_expr_recon_loss: 21409437.7333; val_masked_gp_l1_reg_loss: 88643.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134627.0312; val_chrom_access_recon_loss: 66253802.4000; val_global_loss: 90918309.8667; val_optim_loss: 90918309.8667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9452; val_auprc_score: 0.9313; val_best_acc_score: 0.8816; val_best_f1_score: 0.8884; train_kl_reg_loss: 171805.0469; train_edge_recon_loss: 2840711.5134; train_gene_expr_recon_loss: 21284493.8931; train_masked_gp_l1_reg_loss: 89505.6220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130787.7923; train_chrom_access_recon_loss: 66084696.4275; train_global_loss: 90602000.2443; train_optim_loss: 90602000.2443; val_kl_reg_loss: 167907.9438; val_edge_recon_loss: 2832022.4833; val_gene_expr_recon_loss: 21335301.4667; val_masked_gp_l1_reg_loss: 90350.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127064.7578; val_chrom_access_recon_loss: 65976256.5333; val_global_loss: 90528901.3333; val_optim_loss: 90528901.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9532; val_auprc_score: 0.9437; val_best_acc_score: 0.8936; val_best_f1_score: 0.9001; train_kl_reg_loss: 168509.9362; train_edge_recon_loss: 2818019.8798; train_gene_expr_recon_loss: 21218711.3893; train_masked_gp_l1_reg_loss: 91337.6168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123508.9408; train_chrom_access_recon_loss: 65885705.7099; train_global_loss: 90305793.2824; train_optim_loss: 90305793.2824; val_kl_reg_loss: 167136.6344; val_edge_recon_loss: 2794635.1167; val_gene_expr_recon_loss: 21313468.6667; val_masked_gp_l1_reg_loss: 92069.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120025.4062; val_chrom_access_recon_loss: 65707612.8000; val_global_loss: 90194948.2667; val_optim_loss: 90194948.2667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9544; val_auprc_score: 0.9459; val_best_acc_score: 0.8922; val_best_f1_score: 0.8980; train_kl_reg_loss: 163903.1842; train_edge_recon_loss: 2808102.4504; train_gene_expr_recon_loss: 21164509.4962; train_masked_gp_l1_reg_loss: 92886.5255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116777.4512; train_chrom_access_recon_loss: 65694904.7634; train_global_loss: 90041083.7863; train_optim_loss: 90041083.7863; val_kl_reg_loss: 162752.5458; val_edge_recon_loss: 2799105.6833; val_gene_expr_recon_loss: 21117652.8000; val_masked_gp_l1_reg_loss: 93797.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113557.0781; val_chrom_access_recon_loss: 65048231.2000; val_global_loss: 89335097.6000; val_optim_loss: 89335097.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9486; val_auprc_score: 0.9346; val_best_acc_score: 0.8890; val_best_f1_score: 0.8952; train_kl_reg_loss: 160086.6336; train_edge_recon_loss: 2799287.1412; train_gene_expr_recon_loss: 21085948.0763; train_masked_gp_l1_reg_loss: 94570.3705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110529.2093; train_chrom_access_recon_loss: 65428739.1450; train_global_loss: 89679160.1832; train_optim_loss: 89679160.1832; val_kl_reg_loss: 157537.9875; val_edge_recon_loss: 2826598.6500; val_gene_expr_recon_loss: 21082910.6667; val_masked_gp_l1_reg_loss: 95273.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107621.8047; val_chrom_access_recon_loss: 64824078.1333; val_global_loss: 89094021.8667; val_optim_loss: 89094021.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9547; val_auprc_score: 0.9456; val_best_acc_score: 0.8938; val_best_f1_score: 0.8984; train_kl_reg_loss: 156041.2061; train_edge_recon_loss: 2797836.6050; train_gene_expr_recon_loss: 21034795.5115; train_masked_gp_l1_reg_loss: 96217.1003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105086.6329; train_chrom_access_recon_loss: 65288962.4122; train_global_loss: 89478939.8473; train_optim_loss: 89478939.8473; val_kl_reg_loss: 155866.6531; val_edge_recon_loss: 2811152.8167; val_gene_expr_recon_loss: 21028525.7333; val_masked_gp_l1_reg_loss: 96888.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102452.8438; val_chrom_access_recon_loss: 64756781.6000; val_global_loss: 88951667.2000; val_optim_loss: 88951667.2000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9563; val_auprc_score: 0.9455; val_best_acc_score: 0.8979; val_best_f1_score: 0.9031; train_kl_reg_loss: 153865.8384; train_edge_recon_loss: 2788791.1603; train_gene_expr_recon_loss: 21003148.5038; train_masked_gp_l1_reg_loss: 97640.7521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100050.7223; train_chrom_access_recon_loss: 65229853.0076; train_global_loss: 89373349.4962; train_optim_loss: 89373349.4962; val_kl_reg_loss: 153971.0135; val_edge_recon_loss: 2795482.5500; val_gene_expr_recon_loss: 21035880.8000; val_masked_gp_l1_reg_loss: 98438.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97819.2109; val_chrom_access_recon_loss: 64924202.6667; val_global_loss: 89105794.6667; val_optim_loss: 89105794.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9563; val_auprc_score: 0.9469; val_best_acc_score: 0.8998; val_best_f1_score: 0.9051; train_kl_reg_loss: 150757.4940; train_edge_recon_loss: 2786013.6966; train_gene_expr_recon_loss: 20936491.3130; train_masked_gp_l1_reg_loss: 99260.7013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95727.5471; train_chrom_access_recon_loss: 64900483.3893; train_global_loss: 88968734.3511; train_optim_loss: 88968734.3511; val_kl_reg_loss: 149498.3802; val_edge_recon_loss: 2796222.2833; val_gene_expr_recon_loss: 20998733.3333; val_masked_gp_l1_reg_loss: 99968.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93704.0625; val_chrom_access_recon_loss: 64678188.5333; val_global_loss: 88816314.1333; val_optim_loss: 88816314.1333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9585; val_auprc_score: 0.9502; val_best_acc_score: 0.9000; val_best_f1_score: 0.9047; train_kl_reg_loss: 148538.5743; train_edge_recon_loss: 2779047.4198; train_gene_expr_recon_loss: 20889906.2443; train_masked_gp_l1_reg_loss: 100761.7071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91939.6662; train_chrom_access_recon_loss: 64859129.1603; train_global_loss: 88869322.5038; train_optim_loss: 88869322.5038; val_kl_reg_loss: 146804.3625; val_edge_recon_loss: 2785453.1500; val_gene_expr_recon_loss: 20939454.0000; val_masked_gp_l1_reg_loss: 101413.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90194.7422; val_chrom_access_recon_loss: 64542148.2667; val_global_loss: 88605466.6667; val_optim_loss: 88605466.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9638; val_auprc_score: 0.9570; val_best_acc_score: 0.9077; val_best_f1_score: 0.9118; train_kl_reg_loss: 144800.4154; train_edge_recon_loss: 2775326.9351; train_gene_expr_recon_loss: 20849838.1221; train_masked_gp_l1_reg_loss: 102230.9735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88498.4086; train_chrom_access_recon_loss: 64660516.1832; train_global_loss: 88621210.9924; train_optim_loss: 88621210.9924; val_kl_reg_loss: 144840.1927; val_edge_recon_loss: 2795008.2833; val_gene_expr_recon_loss: 20883628.2667; val_masked_gp_l1_reg_loss: 102743.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86798.9141; val_chrom_access_recon_loss: 64361110.6667; val_global_loss: 88374129.6000; val_optim_loss: 88374129.6000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9637; val_auprc_score: 0.9573; val_best_acc_score: 0.9050; val_best_f1_score: 0.9109; train_kl_reg_loss: 143107.2083; train_edge_recon_loss: 2769480.2366; train_gene_expr_recon_loss: 20813184.8855; train_masked_gp_l1_reg_loss: 103493.4869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85162.2989; train_chrom_access_recon_loss: 64561094.6260; train_global_loss: 88475522.8702; train_optim_loss: 88475522.8702; val_kl_reg_loss: 143481.0271; val_edge_recon_loss: 2777646.1500; val_gene_expr_recon_loss: 20877720.0000; val_masked_gp_l1_reg_loss: 104419.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83705.2031; val_chrom_access_recon_loss: 64378128.0000; val_global_loss: 88365102.9333; val_optim_loss: 88365102.9333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9656; val_auprc_score: 0.9578; val_best_acc_score: 0.9105; val_best_f1_score: 0.9140; train_kl_reg_loss: 141004.5197; train_edge_recon_loss: 2769269.3321; train_gene_expr_recon_loss: 20800065.0534; train_masked_gp_l1_reg_loss: 104919.2453; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82289.3855; train_chrom_access_recon_loss: 64511059.8168; train_global_loss: 88408607.6336; train_optim_loss: 88408607.6336; val_kl_reg_loss: 138595.1781; val_edge_recon_loss: 2778367.1500; val_gene_expr_recon_loss: 20886996.5333; val_masked_gp_l1_reg_loss: 105598.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80584.6016; val_chrom_access_recon_loss: 64187978.1333; val_global_loss: 88178120.0000; val_optim_loss: 88178120.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9657; val_auprc_score: 0.9586; val_best_acc_score: 0.9144; val_best_f1_score: 0.9178; train_kl_reg_loss: 140720.9460; train_edge_recon_loss: 2756457.7385; train_gene_expr_recon_loss: 20765812.3053; train_masked_gp_l1_reg_loss: 106240.3714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79102.5205; train_chrom_access_recon_loss: 64409618.6870; train_global_loss: 88257952.7328; train_optim_loss: 88257952.7328; val_kl_reg_loss: 140404.0333; val_edge_recon_loss: 2776341.8333; val_gene_expr_recon_loss: 20867321.0667; val_masked_gp_l1_reg_loss: 106956.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77736.4844; val_chrom_access_recon_loss: 64160166.9333; val_global_loss: 88128926.4000; val_optim_loss: 88128926.4000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9681; val_auprc_score: 0.9621; val_best_acc_score: 0.9126; val_best_f1_score: 0.9173; train_kl_reg_loss: 138742.8036; train_edge_recon_loss: 2754497.5592; train_gene_expr_recon_loss: 20745437.5878; train_masked_gp_l1_reg_loss: 107612.8002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76396.2306; train_chrom_access_recon_loss: 64385302.5649; train_global_loss: 88207989.4962; train_optim_loss: 88207989.4962; val_kl_reg_loss: 138090.9438; val_edge_recon_loss: 2772403.1667; val_gene_expr_recon_loss: 20904296.2667; val_masked_gp_l1_reg_loss: 108243.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75126.9531; val_chrom_access_recon_loss: 64503260.0000; val_global_loss: 88501420.2667; val_optim_loss: 88501420.2667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9701; val_auprc_score: 0.9638; val_best_acc_score: 0.9186; val_best_f1_score: 0.9220; train_kl_reg_loss: 136452.5532; train_edge_recon_loss: 2760147.5553; train_gene_expr_recon_loss: 20711749.5573; train_masked_gp_l1_reg_loss: 109044.8880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73992.2824; train_chrom_access_recon_loss: 64291551.2977; train_global_loss: 88082937.9542; train_optim_loss: 88082937.9542; val_kl_reg_loss: 137951.0719; val_edge_recon_loss: 2762237.5500; val_gene_expr_recon_loss: 20708295.8667; val_masked_gp_l1_reg_loss: 109703.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72854.7891; val_chrom_access_recon_loss: 63874772.5333; val_global_loss: 87665815.4667; val_optim_loss: 87665815.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9741; val_auprc_score: 0.9699; val_best_acc_score: 0.9256; val_best_f1_score: 0.9279; train_kl_reg_loss: 134581.1958; train_edge_recon_loss: 2755486.5057; train_gene_expr_recon_loss: 20663186.5649; train_masked_gp_l1_reg_loss: 110351.2341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71737.3541; train_chrom_access_recon_loss: 64112660.1221; train_global_loss: 87848003.3588; train_optim_loss: 87848003.3588; val_kl_reg_loss: 133542.6250; val_edge_recon_loss: 2741224.2833; val_gene_expr_recon_loss: 20804323.6000; val_masked_gp_l1_reg_loss: 110936.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70611.5781; val_chrom_access_recon_loss: 64228815.4667; val_global_loss: 88089453.8667; val_optim_loss: 88089453.8667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9699; val_auprc_score: 0.9618; val_best_acc_score: 0.9169; val_best_f1_score: 0.9207; train_kl_reg_loss: 150396.7629; train_edge_recon_loss: 2840660.1508; train_gene_expr_recon_loss: 22019759.7099; train_masked_gp_l1_reg_loss: 109789.2965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72395.9312; train_chrom_access_recon_loss: 65359305.8015; train_global_loss: 90552307.6031; train_optim_loss: 90552307.6031; val_kl_reg_loss: 56109.7966; val_edge_recon_loss: 2789685.9333; val_gene_expr_recon_loss: 22028329.2000; val_masked_gp_l1_reg_loss: 109637.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73248.6719; val_chrom_access_recon_loss: 65309388.2667; val_global_loss: 90366398.4000; val_optim_loss: 90366398.4000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9704; val_auprc_score: 0.9626; val_best_acc_score: 0.9192; val_best_f1_score: 0.9221; train_kl_reg_loss: 138417.7866; train_edge_recon_loss: 2786980.5649; train_gene_expr_recon_loss: 21925452.7023; train_masked_gp_l1_reg_loss: 109342.3498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72873.7156; train_chrom_access_recon_loss: 65253878.3817; train_global_loss: 90286945.4046; train_optim_loss: 90286945.4046; val_kl_reg_loss: 61657.2260; val_edge_recon_loss: 2762290.1500; val_gene_expr_recon_loss: 21975940.6667; val_masked_gp_l1_reg_loss: 108926.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72483.6641; val_chrom_access_recon_loss: 65082185.0667; val_global_loss: 90063483.7333; val_optim_loss: 90063483.7333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9661; val_auprc_score: 0.9583; val_best_acc_score: 0.9142; val_best_f1_score: 0.9178; train_kl_reg_loss: 122715.5648; train_edge_recon_loss: 2771511.8187; train_gene_expr_recon_loss: 22026016.5191; train_masked_gp_l1_reg_loss: 108404.3856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72080.0844; train_chrom_access_recon_loss: 65438494.6260; train_global_loss: 90539223.2672; train_optim_loss: 90539223.2672; val_kl_reg_loss: 60913.4305; val_edge_recon_loss: 2757166.8000; val_gene_expr_recon_loss: 22062394.2667; val_masked_gp_l1_reg_loss: 107776.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71373.2578; val_chrom_access_recon_loss: 65178152.5333; val_global_loss: 90237776.5333; val_optim_loss: 90237776.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9685; val_auprc_score: 0.9603; val_best_acc_score: 0.9178; val_best_f1_score: 0.9221; train_kl_reg_loss: 116748.4018; train_edge_recon_loss: 2760136.3092; train_gene_expr_recon_loss: 22048021.0992; train_masked_gp_l1_reg_loss: 107388.2143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71092.7163; train_chrom_access_recon_loss: 65411002.7786; train_global_loss: 90514389.5573; train_optim_loss: 90514389.5573; val_kl_reg_loss: 57695.2135; val_edge_recon_loss: 2751530.8000; val_gene_expr_recon_loss: 22063579.8667; val_masked_gp_l1_reg_loss: 107250.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70857.2891; val_chrom_access_recon_loss: 64897928.2667; val_global_loss: 89948840.5333; val_optim_loss: 89948840.5333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9681; val_auprc_score: 0.9623; val_best_acc_score: 0.9123; val_best_f1_score: 0.9162; train_kl_reg_loss: 116793.5922; train_edge_recon_loss: 2761852.5153; train_gene_expr_recon_loss: 22060295.7557; train_masked_gp_l1_reg_loss: 107116.8803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70648.3880; train_chrom_access_recon_loss: 65411886.2901; train_global_loss: 90528593.4046; train_optim_loss: 90528593.4046; val_kl_reg_loss: 53592.1875; val_edge_recon_loss: 2792494.4500; val_gene_expr_recon_loss: 22200975.4667; val_masked_gp_l1_reg_loss: 106977.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70424.1484; val_chrom_access_recon_loss: 65410557.6000; val_global_loss: 90635020.8000; val_optim_loss: 90635020.8000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9666; val_auprc_score: 0.9593; val_best_acc_score: 0.9147; val_best_f1_score: 0.9172; train_kl_reg_loss: 116754.0842; train_edge_recon_loss: 2762509.5210; train_gene_expr_recon_loss: 22110699.4351; train_masked_gp_l1_reg_loss: 106826.4515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70269.3232; train_chrom_access_recon_loss: 65408727.1145; train_global_loss: 90575785.8931; train_optim_loss: 90575785.8931; val_kl_reg_loss: 56367.3432; val_edge_recon_loss: 2776349.6500; val_gene_expr_recon_loss: 22293611.4667; val_masked_gp_l1_reg_loss: 106689.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70147.8750; val_chrom_access_recon_loss: 65958083.2000; val_global_loss: 91261249.0667; val_optim_loss: 91261249.0667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9664; val_auprc_score: 0.9591; val_best_acc_score: 0.9135; val_best_f1_score: 0.9171; train_kl_reg_loss: 116365.4426; train_edge_recon_loss: 2762771.2290; train_gene_expr_recon_loss: 22109732.3053; train_masked_gp_l1_reg_loss: 106525.2867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70014.9280; train_chrom_access_recon_loss: 65338433.0076; train_global_loss: 90503842.0763; train_optim_loss: 90503842.0763; val_kl_reg_loss: 53954.5893; val_edge_recon_loss: 2780409.7000; val_gene_expr_recon_loss: 22183693.3333; val_masked_gp_l1_reg_loss: 106356.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69855.0547; val_chrom_access_recon_loss: 65256099.4667; val_global_loss: 90450367.4667; val_optim_loss: 90450367.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 58 min 9 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9708
val AUPRC score: 0.9632
val best accuracy score: 0.9198
val best F1 score: 0.9230
val target rna MSE score: 1.2429
val source rna MSE score: 46.9249
val target atac MSE score: 0.1293
val source atac MSE score: 1.4133
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
