[True]
Run timestamp: 26072023_040036_149.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_149']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9076; val_auprc_score: 0.9225; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 49779.6882; train_edge_recon_loss: 34756259.1111; train_gene_expr_recon_loss: 31905071.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1138907.8056; train_global_loss: 67850015.5556; train_optim_loss: 67850015.5556; val_kl_reg_loss: 30143.0938; val_edge_recon_loss: 40655148.0000; val_gene_expr_recon_loss: 30042484.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1062139.5000; val_global_loss: 71789912.0000; val_optim_loss: 71789912.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8957; val_auprc_score: 0.9095; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 82143.6990; train_edge_recon_loss: 34852642.6667; train_gene_expr_recon_loss: 28676155.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1081506.4653; train_global_loss: 64692448.8889; train_optim_loss: 64692448.8889; val_kl_reg_loss: 97178.0781; val_edge_recon_loss: 40654604.0000; val_gene_expr_recon_loss: 27982342.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1046229.0625; val_global_loss: 69780360.0000; val_optim_loss: 69780360.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8926; val_auprc_score: 0.9063; val_best_acc_score: 0.5050; val_best_f1_score: 0.6689; train_kl_reg_loss: 118560.5556; train_edge_recon_loss: 34843933.3333; train_gene_expr_recon_loss: 27132991.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1061669.4722; train_global_loss: 63157154.6667; train_optim_loss: 63157154.6667; val_kl_reg_loss: 128791.6719; val_edge_recon_loss: 40652416.0000; val_gene_expr_recon_loss: 26323782.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1031607.1250; val_global_loss: 68136600.0000; val_optim_loss: 68136600.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9004; val_auprc_score: 0.9082; val_best_acc_score: 0.5044; val_best_f1_score: 0.6686; train_kl_reg_loss: 189970.6901; train_edge_recon_loss: 34813080.8889; train_gene_expr_recon_loss: 25496074.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1042630.6528; train_global_loss: 61541756.4444; train_optim_loss: 61541756.4444; val_kl_reg_loss: 318267.3750; val_edge_recon_loss: 40653460.0000; val_gene_expr_recon_loss: 24832442.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1016343.1875; val_global_loss: 66820512.0000; val_optim_loss: 66820512.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9118; val_auprc_score: 0.9178; val_best_acc_score: 0.5067; val_best_f1_score: 0.6696; train_kl_reg_loss: 237103.0573; train_edge_recon_loss: 34837395.5556; train_gene_expr_recon_loss: 24472044.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1038456.1250; train_global_loss: 60584998.6667; train_optim_loss: 60584998.6667; val_kl_reg_loss: 204961.1250; val_edge_recon_loss: 40649884.0000; val_gene_expr_recon_loss: 23920450.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1004509.3750; val_global_loss: 65779804.0000; val_optim_loss: 65779804.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9210; val_auprc_score: 0.9206; val_best_acc_score: 0.5018; val_best_f1_score: 0.6674; train_kl_reg_loss: 244665.2066; train_edge_recon_loss: 34816431.1111; train_gene_expr_recon_loss: 23324604.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007625.3542; train_global_loss: 59393325.7778; train_optim_loss: 59393325.7778; val_kl_reg_loss: 246948.6250; val_edge_recon_loss: 40650720.0000; val_gene_expr_recon_loss: 23300648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 997091.6875; val_global_loss: 65195408.0000; val_optim_loss: 65195408.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9216; val_auprc_score: 0.9207; val_best_acc_score: 0.5044; val_best_f1_score: 0.6686; train_kl_reg_loss: 285514.3594; train_edge_recon_loss: 34798360.0000; train_gene_expr_recon_loss: 22795938.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1008341.9236; train_global_loss: 58888153.7778; train_optim_loss: 58888153.7778; val_kl_reg_loss: 277761.2500; val_edge_recon_loss: 40647628.0000; val_gene_expr_recon_loss: 22751694.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 991296.1250; val_global_loss: 64668376.0000; val_optim_loss: 64668376.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9210; val_auprc_score: 0.9215; val_best_acc_score: 0.5156; val_best_f1_score: 0.6736; train_kl_reg_loss: 337702.2222; train_edge_recon_loss: 34785492.4444; train_gene_expr_recon_loss: 22353373.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1000101.0556; train_global_loss: 58476669.3333; train_optim_loss: 58476669.3333; val_kl_reg_loss: 293049.3125; val_edge_recon_loss: 40640316.0000; val_gene_expr_recon_loss: 22225740.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 985203.7500; val_global_loss: 64144308.0000; val_optim_loss: 64144308.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9138; val_auprc_score: 0.9103; val_best_acc_score: 0.5384; val_best_f1_score: 0.6839; train_kl_reg_loss: 330349.6667; train_edge_recon_loss: 34817778.2222; train_gene_expr_recon_loss: 21882738.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 999790.8125; train_global_loss: 58030657.7778; train_optim_loss: 58030657.7778; val_kl_reg_loss: 286094.6562; val_edge_recon_loss: 40628004.0000; val_gene_expr_recon_loss: 21878140.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979036.9375; val_global_loss: 63771276.0000; val_optim_loss: 63771276.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9121; val_auprc_score: 0.9080; val_best_acc_score: 0.5648; val_best_f1_score: 0.6963; train_kl_reg_loss: 338572.4201; train_edge_recon_loss: 34822888.0000; train_gene_expr_recon_loss: 21574009.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 988667.7986; train_global_loss: 57724137.3333; train_optim_loss: 57724137.3333; val_kl_reg_loss: 280511.7812; val_edge_recon_loss: 40614512.0000; val_gene_expr_recon_loss: 21669434.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 977903.5625; val_global_loss: 63542360.0000; val_optim_loss: 63542360.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9162; val_auprc_score: 0.9096; val_best_acc_score: 0.6196; val_best_f1_score: 0.7234; train_kl_reg_loss: 326222.8056; train_edge_recon_loss: 34818452.0000; train_gene_expr_recon_loss: 21308863.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 988199.8333; train_global_loss: 57441738.6667; train_optim_loss: 57441738.6667; val_kl_reg_loss: 299867.0312; val_edge_recon_loss: 40590356.0000; val_gene_expr_recon_loss: 21512648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 975509.0625; val_global_loss: 63378380.0000; val_optim_loss: 63378380.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9180; val_auprc_score: 0.9125; val_best_acc_score: 0.6929; val_best_f1_score: 0.7624; train_kl_reg_loss: 320931.4722; train_edge_recon_loss: 34846628.0000; train_gene_expr_recon_loss: 21284930.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 986953.7153; train_global_loss: 57439442.6667; train_optim_loss: 57439442.6667; val_kl_reg_loss: 227752.4375; val_edge_recon_loss: 40552532.0000; val_gene_expr_recon_loss: 21417572.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973502.8125; val_global_loss: 63171360.0000; val_optim_loss: 63171360.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9142; val_auprc_score: 0.9050; val_best_acc_score: 0.7487; val_best_f1_score: 0.7951; train_kl_reg_loss: 302912.0139; train_edge_recon_loss: 34827185.3333; train_gene_expr_recon_loss: 21337361.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 991812.7014; train_global_loss: 57459271.5556; train_optim_loss: 57459271.5556; val_kl_reg_loss: 242218.6406; val_edge_recon_loss: 40504976.0000; val_gene_expr_recon_loss: 21375730.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971876.6875; val_global_loss: 63094804.0000; val_optim_loss: 63094804.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9214; val_auprc_score: 0.9151; val_best_acc_score: 0.7991; val_best_f1_score: 0.8261; train_kl_reg_loss: 297317.9549; train_edge_recon_loss: 34804698.6667; train_gene_expr_recon_loss: 21091957.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 983353.9306; train_global_loss: 57177328.0000; train_optim_loss: 57177328.0000; val_kl_reg_loss: 236686.9062; val_edge_recon_loss: 40434460.0000; val_gene_expr_recon_loss: 21287660.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971081.6250; val_global_loss: 62929888.0000; val_optim_loss: 62929888.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9204; val_auprc_score: 0.9100; val_best_acc_score: 0.8352; val_best_f1_score: 0.8481; train_kl_reg_loss: 287882.0556; train_edge_recon_loss: 34805210.6667; train_gene_expr_recon_loss: 21110740.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 983058.6458; train_global_loss: 57186891.5556; train_optim_loss: 57186891.5556; val_kl_reg_loss: 222809.8125; val_edge_recon_loss: 40294844.0000; val_gene_expr_recon_loss: 21221304.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970219.5625; val_global_loss: 62709176.0000; val_optim_loss: 62709176.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9247; val_auprc_score: 0.9138; val_best_acc_score: 0.8508; val_best_f1_score: 0.8529; train_kl_reg_loss: 266312.4583; train_edge_recon_loss: 34800477.7778; train_gene_expr_recon_loss: 21004365.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 980017.3889; train_global_loss: 57051172.4444; train_optim_loss: 57051172.4444; val_kl_reg_loss: 274231.0312; val_edge_recon_loss: 40111940.0000; val_gene_expr_recon_loss: 21151626.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967777.3125; val_global_loss: 62505576.0000; val_optim_loss: 62505576.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9242; val_auprc_score: 0.9139; val_best_acc_score: 0.8327; val_best_f1_score: 0.8220; train_kl_reg_loss: 269694.0052; train_edge_recon_loss: 34731240.8889; train_gene_expr_recon_loss: 20949312.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976717.5764; train_global_loss: 56926964.4444; train_optim_loss: 56926964.4444; val_kl_reg_loss: 191110.2344; val_edge_recon_loss: 39753184.0000; val_gene_expr_recon_loss: 21099392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965506.0000; val_global_loss: 62009192.0000; val_optim_loss: 62009192.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9242; val_auprc_score: 0.9112; val_best_acc_score: 0.8309; val_best_f1_score: 0.8497; train_kl_reg_loss: 242292.0764; train_edge_recon_loss: 34655962.6667; train_gene_expr_recon_loss: 20918076.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977748.4722; train_global_loss: 56794079.5556; train_optim_loss: 56794079.5556; val_kl_reg_loss: 203898.0625; val_edge_recon_loss: 38959256.0000; val_gene_expr_recon_loss: 21113836.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966239.3750; val_global_loss: 61243232.0000; val_optim_loss: 61243232.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9224; val_auprc_score: 0.9034; val_best_acc_score: 0.8538; val_best_f1_score: 0.8583; train_kl_reg_loss: 213109.8351; train_edge_recon_loss: 34453004.4444; train_gene_expr_recon_loss: 20959957.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977515.0625; train_global_loss: 56603586.2222; train_optim_loss: 56603586.2222; val_kl_reg_loss: 186584.2188; val_edge_recon_loss: 36999792.0000; val_gene_expr_recon_loss: 21149664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967276.6250; val_global_loss: 59303316.0000; val_optim_loss: 59303316.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9086; val_auprc_score: 0.8947; val_best_acc_score: 0.8294; val_best_f1_score: 0.8372; train_kl_reg_loss: 133453.7917; train_edge_recon_loss: 33466401.1111; train_gene_expr_recon_loss: 21117358.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982302.8056; train_global_loss: 55699515.5556; train_optim_loss: 55699515.5556; val_kl_reg_loss: 61608.2734; val_edge_recon_loss: 32298732.0000; val_gene_expr_recon_loss: 21750176.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 977972.5625; val_global_loss: 55088488.0000; val_optim_loss: 55088488.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8985; val_auprc_score: 0.8788; val_best_acc_score: 0.8215; val_best_f1_score: 0.8295; train_kl_reg_loss: 67954.1806; train_edge_recon_loss: 30272446.8889; train_gene_expr_recon_loss: 22015536.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1003364.3333; train_global_loss: 53359301.7778; train_optim_loss: 53359301.7778; val_kl_reg_loss: 99255.6953; val_edge_recon_loss: 29180772.0000; val_gene_expr_recon_loss: 21953988.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 980055.6250; val_global_loss: 52214072.0000; val_optim_loss: 52214072.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8950; val_auprc_score: 0.8788; val_best_acc_score: 0.8076; val_best_f1_score: 0.8192; train_kl_reg_loss: 143123.4931; train_edge_recon_loss: 29211840.6667; train_gene_expr_recon_loss: 21448694.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 987673.2153; train_global_loss: 51791332.4444; train_optim_loss: 51791332.4444; val_kl_reg_loss: 180593.0000; val_edge_recon_loss: 28844854.0000; val_gene_expr_recon_loss: 21501058.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974610.1875; val_global_loss: 51501116.0000; val_optim_loss: 51501116.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8921; val_auprc_score: 0.8645; val_best_acc_score: 0.8124; val_best_f1_score: 0.8260; train_kl_reg_loss: 221512.2656; train_edge_recon_loss: 28746841.7778; train_gene_expr_recon_loss: 21311776.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982953.3889; train_global_loss: 51263084.4444; train_optim_loss: 51263084.4444; val_kl_reg_loss: 239642.8750; val_edge_recon_loss: 28643838.0000; val_gene_expr_recon_loss: 21320362.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970069.2500; val_global_loss: 51173908.0000; val_optim_loss: 51173908.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9008; val_auprc_score: 0.8773; val_best_acc_score: 0.8230; val_best_f1_score: 0.8336; train_kl_reg_loss: 266478.7066; train_edge_recon_loss: 28311460.2222; train_gene_expr_recon_loss: 20997814.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979184.2708; train_global_loss: 50554937.3333; train_optim_loss: 50554937.3333; val_kl_reg_loss: 263273.5938; val_edge_recon_loss: 28213906.0000; val_gene_expr_recon_loss: 21218836.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968738.8750; val_global_loss: 50664756.0000; val_optim_loss: 50664756.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8967; val_auprc_score: 0.8743; val_best_acc_score: 0.8215; val_best_f1_score: 0.8336; train_kl_reg_loss: 281894.7292; train_edge_recon_loss: 28085534.2222; train_gene_expr_recon_loss: 20907465.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979746.1111; train_global_loss: 50254640.4444; train_optim_loss: 50254640.4444; val_kl_reg_loss: 272426.6875; val_edge_recon_loss: 28271094.0000; val_gene_expr_recon_loss: 21178882.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967808.1250; val_global_loss: 50690208.0000; val_optim_loss: 50690208.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9177; val_auprc_score: 0.8985; val_best_acc_score: 0.8417; val_best_f1_score: 0.8508; train_kl_reg_loss: 294043.7014; train_edge_recon_loss: 28846733.1111; train_gene_expr_recon_loss: 21336922.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 984820.4653; train_global_loss: 51462519.1111; train_optim_loss: 51462519.1111; val_kl_reg_loss: 79469.3594; val_edge_recon_loss: 28583332.0000; val_gene_expr_recon_loss: 21603372.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974018.1875; val_global_loss: 51240196.0000; val_optim_loss: 51240196.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9155; val_auprc_score: 0.8974; val_best_acc_score: 0.8364; val_best_f1_score: 0.8449; train_kl_reg_loss: 376779.0347; train_edge_recon_loss: 28522975.5556; train_gene_expr_recon_loss: 21278134.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 984571.1250; train_global_loss: 51162460.8889; train_optim_loss: 51162460.8889; val_kl_reg_loss: 100383.3438; val_edge_recon_loss: 28462174.0000; val_gene_expr_recon_loss: 21459868.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971141.3750; val_global_loss: 50993564.0000; val_optim_loss: 50993564.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9152; val_auprc_score: 0.8941; val_best_acc_score: 0.8406; val_best_f1_score: 0.8507; train_kl_reg_loss: 429354.0069; train_edge_recon_loss: 28260642.2222; train_gene_expr_recon_loss: 21369801.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 987104.6528; train_global_loss: 51046901.7778; train_optim_loss: 51046901.7778; val_kl_reg_loss: 109564.4844; val_edge_recon_loss: 28107372.0000; val_gene_expr_recon_loss: 21437494.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970549.3125; val_global_loss: 50624980.0000; val_optim_loss: 50624980.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9120; val_auprc_score: 0.8882; val_best_acc_score: 0.8402; val_best_f1_score: 0.8492; train_kl_reg_loss: 435914.9792; train_edge_recon_loss: 28128506.4444; train_gene_expr_recon_loss: 21067634.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975995.1736; train_global_loss: 50608052.0000; train_optim_loss: 50608052.0000; val_kl_reg_loss: 114528.5625; val_edge_recon_loss: 28144052.0000; val_gene_expr_recon_loss: 21349576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971053.8125; val_global_loss: 50579208.0000; val_optim_loss: 50579208.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9137; val_auprc_score: 0.8908; val_best_acc_score: 0.8430; val_best_f1_score: 0.8521; train_kl_reg_loss: 435808.7292; train_edge_recon_loss: 27952676.8889; train_gene_expr_recon_loss: 21166277.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 983788.8264; train_global_loss: 50538552.0000; train_optim_loss: 50538552.0000; val_kl_reg_loss: 117481.8906; val_edge_recon_loss: 28053984.0000; val_gene_expr_recon_loss: 21267780.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966984.9375; val_global_loss: 50406232.0000; val_optim_loss: 50406232.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9141; val_auprc_score: 0.8928; val_best_acc_score: 0.8433; val_best_f1_score: 0.8504; train_kl_reg_loss: 398176.9236; train_edge_recon_loss: 27889446.8889; train_gene_expr_recon_loss: 20890923.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971975.4375; train_global_loss: 50150522.6667; train_optim_loss: 50150522.6667; val_kl_reg_loss: 112235.8906; val_edge_recon_loss: 28188446.0000; val_gene_expr_recon_loss: 21274222.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966297.5625; val_global_loss: 50541200.0000; val_optim_loss: 50541200.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9206; val_auprc_score: 0.8959; val_best_acc_score: 0.8522; val_best_f1_score: 0.8610; train_kl_reg_loss: 381270.8403; train_edge_recon_loss: 27846294.2222; train_gene_expr_recon_loss: 20928347.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976337.6250; train_global_loss: 50132249.3333; train_optim_loss: 50132249.3333; val_kl_reg_loss: 118872.8125; val_edge_recon_loss: 27856306.0000; val_gene_expr_recon_loss: 21182628.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965648.1250; val_global_loss: 50123456.0000; val_optim_loss: 50123456.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9262; val_auprc_score: 0.9096; val_best_acc_score: 0.8534; val_best_f1_score: 0.8627; train_kl_reg_loss: 367278.5104; train_edge_recon_loss: 27771286.6667; train_gene_expr_recon_loss: 20794764.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972771.6597; train_global_loss: 49906101.7778; train_optim_loss: 49906101.7778; val_kl_reg_loss: 123211.3906; val_edge_recon_loss: 27577320.0000; val_gene_expr_recon_loss: 21143854.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963930.2500; val_global_loss: 49808316.0000; val_optim_loss: 49808316.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9223; val_auprc_score: 0.9025; val_best_acc_score: 0.8564; val_best_f1_score: 0.8623; train_kl_reg_loss: 356351.9583; train_edge_recon_loss: 27690386.4444; train_gene_expr_recon_loss: 20824276.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972444.6736; train_global_loss: 49843459.5556; train_optim_loss: 49843459.5556; val_kl_reg_loss: 128499.3750; val_edge_recon_loss: 27815152.0000; val_gene_expr_recon_loss: 21161028.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964334.6250; val_global_loss: 50069016.0000; val_optim_loss: 50069016.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9286; val_auprc_score: 0.9108; val_best_acc_score: 0.8631; val_best_f1_score: 0.8678; train_kl_reg_loss: 340292.8056; train_edge_recon_loss: 27637929.1111; train_gene_expr_recon_loss: 20883084.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973567.5486; train_global_loss: 49834874.2222; train_optim_loss: 49834874.2222; val_kl_reg_loss: 132735.1562; val_edge_recon_loss: 27618730.0000; val_gene_expr_recon_loss: 21072534.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962592.1250; val_global_loss: 49786592.0000; val_optim_loss: 49786592.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9282; val_auprc_score: 0.9088; val_best_acc_score: 0.8626; val_best_f1_score: 0.8672; train_kl_reg_loss: 325388.3299; train_edge_recon_loss: 27647268.0000; train_gene_expr_recon_loss: 20907608.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971054.2847; train_global_loss: 49851320.0000; train_optim_loss: 49851320.0000; val_kl_reg_loss: 140732.2500; val_edge_recon_loss: 27382782.0000; val_gene_expr_recon_loss: 21052530.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962581.4375; val_global_loss: 49538624.0000; val_optim_loss: 49538624.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9297; val_auprc_score: 0.9116; val_best_acc_score: 0.8646; val_best_f1_score: 0.8699; train_kl_reg_loss: 310436.3993; train_edge_recon_loss: 27604622.0000; train_gene_expr_recon_loss: 20727452.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972499.9306; train_global_loss: 49615010.2222; train_optim_loss: 49615010.2222; val_kl_reg_loss: 136749.5625; val_edge_recon_loss: 27721108.0000; val_gene_expr_recon_loss: 21037444.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961468.3750; val_global_loss: 49856772.0000; val_optim_loss: 49856772.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9268; val_auprc_score: 0.9084; val_best_acc_score: 0.8619; val_best_f1_score: 0.8694; train_kl_reg_loss: 303441.6319; train_edge_recon_loss: 27573918.2222; train_gene_expr_recon_loss: 20785253.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974045.7431; train_global_loss: 49636659.5556; train_optim_loss: 49636659.5556; val_kl_reg_loss: 135012.5938; val_edge_recon_loss: 27648168.0000; val_gene_expr_recon_loss: 21106580.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961513.6875; val_global_loss: 49851272.0000; val_optim_loss: 49851272.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9293; val_auprc_score: 0.9131; val_best_acc_score: 0.8611; val_best_f1_score: 0.8687; train_kl_reg_loss: 284265.8993; train_edge_recon_loss: 27533123.5556; train_gene_expr_recon_loss: 20829554.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 990829.8125; train_global_loss: 49637773.3333; train_optim_loss: 49637773.3333; val_kl_reg_loss: 130289.8438; val_edge_recon_loss: 27910280.0000; val_gene_expr_recon_loss: 20999028.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 959756.5000; val_global_loss: 49999356.0000; val_optim_loss: 49999356.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9368; val_auprc_score: 0.9219; val_best_acc_score: 0.8678; val_best_f1_score: 0.8744; train_kl_reg_loss: 262374.9271; train_edge_recon_loss: 27463820.6667; train_gene_expr_recon_loss: 20696702.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 969759.3889; train_global_loss: 49392658.2222; train_optim_loss: 49392658.2222; val_kl_reg_loss: 124525.9844; val_edge_recon_loss: 27743172.0000; val_gene_expr_recon_loss: 20987588.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 959919.9375; val_global_loss: 49815208.0000; val_optim_loss: 49815208.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9321; val_auprc_score: 0.9138; val_best_acc_score: 0.8692; val_best_f1_score: 0.8755; train_kl_reg_loss: 259909.8316; train_edge_recon_loss: 27453179.7778; train_gene_expr_recon_loss: 20794153.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972085.0556; train_global_loss: 49479328.0000; train_optim_loss: 49479328.0000; val_kl_reg_loss: 126154.5312; val_edge_recon_loss: 27548894.0000; val_gene_expr_recon_loss: 20923692.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 957603.8750; val_global_loss: 49556344.0000; val_optim_loss: 49556344.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9350; val_auprc_score: 0.9184; val_best_acc_score: 0.8701; val_best_f1_score: 0.8763; train_kl_reg_loss: 260800.3663; train_edge_recon_loss: 27571631.1111; train_gene_expr_recon_loss: 20771526.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970693.4861; train_global_loss: 49574651.1111; train_optim_loss: 49574651.1111; val_kl_reg_loss: 127714.8125; val_edge_recon_loss: 27560738.0000; val_gene_expr_recon_loss: 20948768.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 958947.7500; val_global_loss: 49596168.0000; val_optim_loss: 49596168.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9338; val_auprc_score: 0.9168; val_best_acc_score: 0.8662; val_best_f1_score: 0.8732; train_kl_reg_loss: 261985.6684; train_edge_recon_loss: 27524863.3333; train_gene_expr_recon_loss: 20760114.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968735.6875; train_global_loss: 49515699.5556; train_optim_loss: 49515699.5556; val_kl_reg_loss: 129305.7891; val_edge_recon_loss: 27554226.0000; val_gene_expr_recon_loss: 20916740.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 958111.6875; val_global_loss: 49558384.0000; val_optim_loss: 49558384.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9331; val_auprc_score: 0.9142; val_best_acc_score: 0.8684; val_best_f1_score: 0.8749; train_kl_reg_loss: 265249.3594; train_edge_recon_loss: 27535797.7778; train_gene_expr_recon_loss: 20641353.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968032.0764; train_global_loss: 49410433.3333; train_optim_loss: 49410433.3333; val_kl_reg_loss: 131029.1016; val_edge_recon_loss: 27775874.0000; val_gene_expr_recon_loss: 20925526.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 958609.1250; val_global_loss: 49791040.0000; val_optim_loss: 49791040.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 29 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9280
Val AUPRC score: 0.9086
Val best accuracy score: 0.8627
Val best F1 score: 0.8687
Val gene expr MSE score: 0.4904
Val chrom access MSE score: 0.0871
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
