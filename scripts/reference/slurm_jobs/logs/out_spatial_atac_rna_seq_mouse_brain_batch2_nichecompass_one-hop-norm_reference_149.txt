[True]
Run timestamp: 07082023_220346_149.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_149']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8939; val_auprc_score: 0.9046; val_best_acc_score: 0.5419; val_best_f1_score: 0.6850; train_kl_reg_loss: 21369.1706; train_edge_recon_loss: 3472885.7500; train_gene_expr_recon_loss: 1285814.0417; train_masked_gp_l1_reg_loss: 8697.8034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119338.4444; train_chrom_access_recon_loss: 832415.6910; train_global_loss: 5740520.8333; train_optim_loss: 5740520.8333; val_kl_reg_loss: 5398.7676; val_edge_recon_loss: 4062282.2500; val_gene_expr_recon_loss: 1097039.2500; val_masked_gp_l1_reg_loss: 7047.8770; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116941.5547; val_chrom_access_recon_loss: 507138.1250; val_global_loss: 5795847.5000; val_optim_loss: 5795847.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8939; val_auprc_score: 0.9027; val_best_acc_score: 0.5232; val_best_f1_score: 0.6767; train_kl_reg_loss: 5925.1783; train_edge_recon_loss: 3470602.3333; train_gene_expr_recon_loss: 1038659.4444; train_masked_gp_l1_reg_loss: 6365.4717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115420.3767; train_chrom_access_recon_loss: 498462.0243; train_global_loss: 5135434.8333; train_optim_loss: 5135434.8333; val_kl_reg_loss: 6888.2559; val_edge_recon_loss: 4063737.7500; val_gene_expr_recon_loss: 972221.8750; val_masked_gp_l1_reg_loss: 5817.9365; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113566.1797; val_chrom_access_recon_loss: 487129.9375; val_global_loss: 5649362.0000; val_optim_loss: 5649362.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8924; val_auprc_score: 0.9035; val_best_acc_score: 0.5166; val_best_f1_score: 0.6738; train_kl_reg_loss: 10780.7936; train_edge_recon_loss: 3475764.5278; train_gene_expr_recon_loss: 924419.7569; train_masked_gp_l1_reg_loss: 5783.3477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112093.9080; train_chrom_access_recon_loss: 486068.0417; train_global_loss: 5014910.3889; train_optim_loss: 5014910.3889; val_kl_reg_loss: 10234.1084; val_edge_recon_loss: 4064280.0000; val_gene_expr_recon_loss: 875277.8750; val_masked_gp_l1_reg_loss: 5799.7681; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110221.7344; val_chrom_access_recon_loss: 477200.7812; val_global_loss: 5543014.5000; val_optim_loss: 5543014.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8905; val_auprc_score: 0.9035; val_best_acc_score: 0.5216; val_best_f1_score: 0.6756; train_kl_reg_loss: 11876.8926; train_edge_recon_loss: 3477091.7222; train_gene_expr_recon_loss: 848351.5069; train_masked_gp_l1_reg_loss: 5782.5107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108649.1267; train_chrom_access_recon_loss: 469977.8993; train_global_loss: 4921729.7778; train_optim_loss: 4921729.7778; val_kl_reg_loss: 14529.0654; val_edge_recon_loss: 4063893.0000; val_gene_expr_recon_loss: 816949.3750; val_masked_gp_l1_reg_loss: 5746.5620; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106620.2656; val_chrom_access_recon_loss: 461242.6250; val_global_loss: 5468981.0000; val_optim_loss: 5468981.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8791; val_auprc_score: 0.8932; val_best_acc_score: 0.5485; val_best_f1_score: 0.6861; train_kl_reg_loss: 16144.5354; train_edge_recon_loss: 3477840.8056; train_gene_expr_recon_loss: 800723.6944; train_masked_gp_l1_reg_loss: 5735.4057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104865.9575; train_chrom_access_recon_loss: 459069.8785; train_global_loss: 4864380.2778; train_optim_loss: 4864380.2778; val_kl_reg_loss: 14570.0527; val_edge_recon_loss: 4061386.0000; val_gene_expr_recon_loss: 786892.1250; val_masked_gp_l1_reg_loss: 5726.0054; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102586.5781; val_chrom_access_recon_loss: 454252.7812; val_global_loss: 5425413.5000; val_optim_loss: 5425413.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8817; val_auprc_score: 0.8904; val_best_acc_score: 0.5493; val_best_f1_score: 0.6852; train_kl_reg_loss: 16693.9657; train_edge_recon_loss: 3477392.3333; train_gene_expr_recon_loss: 770486.8264; train_masked_gp_l1_reg_loss: 5745.4942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100646.0104; train_chrom_access_recon_loss: 451185.6771; train_global_loss: 4822150.3889; train_optim_loss: 4822150.3889; val_kl_reg_loss: 16382.8496; val_edge_recon_loss: 4060185.5000; val_gene_expr_recon_loss: 759712.9375; val_masked_gp_l1_reg_loss: 5765.7085; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98153.8750; val_chrom_access_recon_loss: 451003.9688; val_global_loss: 5391204.5000; val_optim_loss: 5391204.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8961; val_auprc_score: 0.8987; val_best_acc_score: 0.6304; val_best_f1_score: 0.7240; train_kl_reg_loss: 16953.4772; train_edge_recon_loss: 3478719.6667; train_gene_expr_recon_loss: 747885.9028; train_masked_gp_l1_reg_loss: 5790.1705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96085.3854; train_chrom_access_recon_loss: 450293.9410; train_global_loss: 4795728.6667; train_optim_loss: 4795728.6667; val_kl_reg_loss: 15768.9883; val_edge_recon_loss: 4054940.0000; val_gene_expr_recon_loss: 743821.8750; val_masked_gp_l1_reg_loss: 5814.0601; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93475.5781; val_chrom_access_recon_loss: 448723.8750; val_global_loss: 5362544.5000; val_optim_loss: 5362544.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8903; val_auprc_score: 0.8836; val_best_acc_score: 0.7576; val_best_f1_score: 0.7958; train_kl_reg_loss: 17210.5605; train_edge_recon_loss: 3478247.2778; train_gene_expr_recon_loss: 737024.2917; train_masked_gp_l1_reg_loss: 5848.9902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91372.3359; train_chrom_access_recon_loss: 449891.3403; train_global_loss: 4779594.7222; train_optim_loss: 4779594.7222; val_kl_reg_loss: 16205.0459; val_edge_recon_loss: 4043719.5000; val_gene_expr_recon_loss: 730186.8125; val_masked_gp_l1_reg_loss: 5888.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88738.4688; val_chrom_access_recon_loss: 446874.8438; val_global_loss: 5331613.0000; val_optim_loss: 5331613.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8927; val_auprc_score: 0.8780; val_best_acc_score: 0.8275; val_best_f1_score: 0.8346; train_kl_reg_loss: 17358.6731; train_edge_recon_loss: 3476586.0556; train_gene_expr_recon_loss: 727206.0417; train_masked_gp_l1_reg_loss: 5933.3220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86642.3403; train_chrom_access_recon_loss: 447116.5243; train_global_loss: 4760842.9444; train_optim_loss: 4760842.9444; val_kl_reg_loss: 15647.4648; val_edge_recon_loss: 4013580.5000; val_gene_expr_recon_loss: 720893.3750; val_masked_gp_l1_reg_loss: 5980.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84033.7109; val_chrom_access_recon_loss: 445674.8438; val_global_loss: 5285810.5000; val_optim_loss: 5285810.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8989; val_auprc_score: 0.8826; val_best_acc_score: 0.7889; val_best_f1_score: 0.8157; train_kl_reg_loss: 16104.6095; train_edge_recon_loss: 3470750.5000; train_gene_expr_recon_loss: 716696.2778; train_masked_gp_l1_reg_loss: 6036.7441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81981.0278; train_chrom_access_recon_loss: 447266.3368; train_global_loss: 4738835.5000; train_optim_loss: 4738835.5000; val_kl_reg_loss: 13617.5527; val_edge_recon_loss: 3887335.2500; val_gene_expr_recon_loss: 716685.3750; val_masked_gp_l1_reg_loss: 6094.7617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79438.0625; val_chrom_access_recon_loss: 444750.1875; val_global_loss: 5147921.0000; val_optim_loss: 5147921.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8863; val_auprc_score: 0.8751; val_best_acc_score: 0.8011; val_best_f1_score: 0.8133; train_kl_reg_loss: 11120.0668; train_edge_recon_loss: 3418371.7500; train_gene_expr_recon_loss: 719208.1736; train_masked_gp_l1_reg_loss: 6158.8404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77466.2101; train_chrom_access_recon_loss: 444708.7847; train_global_loss: 4677033.8333; train_optim_loss: 4677033.8333; val_kl_reg_loss: 6666.8042; val_edge_recon_loss: 3344123.0000; val_gene_expr_recon_loss: 733678.8750; val_masked_gp_l1_reg_loss: 6238.8115; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75060.6328; val_chrom_access_recon_loss: 446366.1562; val_global_loss: 4612134.0000; val_optim_loss: 4612134.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8627; val_auprc_score: 0.8524; val_best_acc_score: 0.7661; val_best_f1_score: 0.7865; train_kl_reg_loss: 10475.7628; train_edge_recon_loss: 3078828.0556; train_gene_expr_recon_loss: 752951.4514; train_masked_gp_l1_reg_loss: 6352.5347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73244.2691; train_chrom_access_recon_loss: 447135.5104; train_global_loss: 4368987.6667; train_optim_loss: 4368987.6667; val_kl_reg_loss: 20778.1035; val_edge_recon_loss: 2932250.0000; val_gene_expr_recon_loss: 778733.5000; val_masked_gp_l1_reg_loss: 6503.2959; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71010.2188; val_chrom_access_recon_loss: 450607.3125; val_global_loss: 4259882.5000; val_optim_loss: 4259882.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8677; val_auprc_score: 0.8450; val_best_acc_score: 0.7842; val_best_f1_score: 0.8008; train_kl_reg_loss: 30855.6782; train_edge_recon_loss: 2895226.0278; train_gene_expr_recon_loss: 754265.7083; train_masked_gp_l1_reg_loss: 6603.6916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69268.5755; train_chrom_access_recon_loss: 449178.6979; train_global_loss: 4205398.3333; train_optim_loss: 4205398.3333; val_kl_reg_loss: 39730.4531; val_edge_recon_loss: 2901208.5000; val_gene_expr_recon_loss: 739121.6250; val_masked_gp_l1_reg_loss: 6702.2563; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67121.4531; val_chrom_access_recon_loss: 446127.2812; val_global_loss: 4200011.5000; val_optim_loss: 4200011.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9004; val_auprc_score: 0.8641; val_best_acc_score: 0.8362; val_best_f1_score: 0.8520; train_kl_reg_loss: 39826.6892; train_edge_recon_loss: 2822318.3611; train_gene_expr_recon_loss: 739514.6181; train_masked_gp_l1_reg_loss: 6729.1100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65475.7643; train_chrom_access_recon_loss: 445451.0799; train_global_loss: 4119315.6389; train_optim_loss: 4119315.6389; val_kl_reg_loss: 36800.9062; val_edge_recon_loss: 2784503.0000; val_gene_expr_recon_loss: 743245.0000; val_masked_gp_l1_reg_loss: 6752.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63458.7109; val_chrom_access_recon_loss: 445702.1562; val_global_loss: 4080462.5000; val_optim_loss: 4080462.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9258; val_auprc_score: 0.8958; val_best_acc_score: 0.8684; val_best_f1_score: 0.8779; train_kl_reg_loss: 35721.0330; train_edge_recon_loss: 2767110.4444; train_gene_expr_recon_loss: 738514.4444; train_masked_gp_l1_reg_loss: 6770.0660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61902.9692; train_chrom_access_recon_loss: 444291.9375; train_global_loss: 4054310.9167; train_optim_loss: 4054310.9167; val_kl_reg_loss: 34129.9453; val_edge_recon_loss: 2770309.2500; val_gene_expr_recon_loss: 734256.2500; val_masked_gp_l1_reg_loss: 6788.8745; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59994.8242; val_chrom_access_recon_loss: 444192.5312; val_global_loss: 4049671.5000; val_optim_loss: 4049671.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9373; val_auprc_score: 0.9113; val_best_acc_score: 0.8795; val_best_f1_score: 0.8863; train_kl_reg_loss: 36091.5065; train_edge_recon_loss: 2743618.8889; train_gene_expr_recon_loss: 730087.6597; train_masked_gp_l1_reg_loss: 6807.6006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58526.2565; train_chrom_access_recon_loss: 444575.4861; train_global_loss: 4019707.3333; train_optim_loss: 4019707.3333; val_kl_reg_loss: 37080.1406; val_edge_recon_loss: 2717356.7500; val_gene_expr_recon_loss: 727084.1250; val_masked_gp_l1_reg_loss: 6828.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56711.9492; val_chrom_access_recon_loss: 442950.6250; val_global_loss: 3988012.0000; val_optim_loss: 3988012.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9380; val_auprc_score: 0.9137; val_best_acc_score: 0.8806; val_best_f1_score: 0.8876; train_kl_reg_loss: 38743.3186; train_edge_recon_loss: 2728664.7778; train_gene_expr_recon_loss: 720477.0417; train_masked_gp_l1_reg_loss: 6851.7061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55310.3338; train_chrom_access_recon_loss: 441550.4653; train_global_loss: 3991597.5833; train_optim_loss: 3991597.5833; val_kl_reg_loss: 38810.0156; val_edge_recon_loss: 2718908.5000; val_gene_expr_recon_loss: 720183.2500; val_masked_gp_l1_reg_loss: 6866.6162; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53592.9609; val_chrom_access_recon_loss: 441793.0312; val_global_loss: 3980154.2500; val_optim_loss: 3980154.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9416; val_auprc_score: 0.9200; val_best_acc_score: 0.8835; val_best_f1_score: 0.8891; train_kl_reg_loss: 39388.4731; train_edge_recon_loss: 2720204.8889; train_gene_expr_recon_loss: 714144.9722; train_masked_gp_l1_reg_loss: 6878.7255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52284.4865; train_chrom_access_recon_loss: 440435.2188; train_global_loss: 3973336.7500; train_optim_loss: 3973336.7500; val_kl_reg_loss: 38639.4688; val_edge_recon_loss: 2746874.5000; val_gene_expr_recon_loss: 717441.5000; val_masked_gp_l1_reg_loss: 6885.1748; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50687.0000; val_chrom_access_recon_loss: 440982.7500; val_global_loss: 4001510.5000; val_optim_loss: 4001510.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9486; val_auprc_score: 0.9291; val_best_acc_score: 0.8925; val_best_f1_score: 0.8972; train_kl_reg_loss: 39172.2127; train_edge_recon_loss: 2720906.7500; train_gene_expr_recon_loss: 712880.0556; train_masked_gp_l1_reg_loss: 6900.9970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49478.8338; train_chrom_access_recon_loss: 442379.0000; train_global_loss: 3971717.9444; train_optim_loss: 3971717.9444; val_kl_reg_loss: 37512.3984; val_edge_recon_loss: 2717823.7500; val_gene_expr_recon_loss: 714056.6250; val_masked_gp_l1_reg_loss: 6926.1465; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47997.4766; val_chrom_access_recon_loss: 440086.0938; val_global_loss: 3964402.7500; val_optim_loss: 3964402.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9503; val_auprc_score: 0.9325; val_best_acc_score: 0.8948; val_best_f1_score: 0.9000; train_kl_reg_loss: 37827.4297; train_edge_recon_loss: 2709323.8611; train_gene_expr_recon_loss: 708103.1667; train_masked_gp_l1_reg_loss: 6947.9021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46874.2261; train_chrom_access_recon_loss: 438973.6215; train_global_loss: 3948050.2500; train_optim_loss: 3948050.2500; val_kl_reg_loss: 37080.5625; val_edge_recon_loss: 2705343.0000; val_gene_expr_recon_loss: 709646.8750; val_masked_gp_l1_reg_loss: 6963.5811; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45503.4219; val_chrom_access_recon_loss: 439651.8438; val_global_loss: 3944189.2500; val_optim_loss: 3944189.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9540; val_auprc_score: 0.9386; val_best_acc_score: 0.8998; val_best_f1_score: 0.9055; train_kl_reg_loss: 37986.8568; train_edge_recon_loss: 2709112.1944; train_gene_expr_recon_loss: 707163.8403; train_masked_gp_l1_reg_loss: 6988.8675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44464.5161; train_chrom_access_recon_loss: 440177.6076; train_global_loss: 3945893.8333; train_optim_loss: 3945893.8333; val_kl_reg_loss: 36329.9766; val_edge_recon_loss: 2705398.5000; val_gene_expr_recon_loss: 709690.5000; val_masked_gp_l1_reg_loss: 7013.4644; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43195.0469; val_chrom_access_recon_loss: 438964.3125; val_global_loss: 3940591.7500; val_optim_loss: 3940591.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9530; val_auprc_score: 0.9326; val_best_acc_score: 0.9003; val_best_f1_score: 0.9051; train_kl_reg_loss: 36737.8555; train_edge_recon_loss: 2715737.8611; train_gene_expr_recon_loss: 702831.5833; train_masked_gp_l1_reg_loss: 7045.9352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42242.1632; train_chrom_access_recon_loss: 437291.2812; train_global_loss: 3941886.7222; train_optim_loss: 3941886.7222; val_kl_reg_loss: 35621.3906; val_edge_recon_loss: 2710867.0000; val_gene_expr_recon_loss: 705411.6250; val_masked_gp_l1_reg_loss: 7073.6465; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41076.6211; val_chrom_access_recon_loss: 437930.6562; val_global_loss: 3937981.0000; val_optim_loss: 3937981.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9595; val_auprc_score: 0.9454; val_best_acc_score: 0.9053; val_best_f1_score: 0.9099; train_kl_reg_loss: 35947.1302; train_edge_recon_loss: 2712708.0833; train_gene_expr_recon_loss: 704872.0903; train_masked_gp_l1_reg_loss: 7098.3104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40190.2791; train_chrom_access_recon_loss: 440064.6806; train_global_loss: 3940880.5833; train_optim_loss: 3940880.5833; val_kl_reg_loss: 34267.4766; val_edge_recon_loss: 2701222.2500; val_gene_expr_recon_loss: 704262.2500; val_masked_gp_l1_reg_loss: 7126.7671; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39110.4492; val_chrom_access_recon_loss: 437715.4688; val_global_loss: 3923704.7500; val_optim_loss: 3923704.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9607; val_auprc_score: 0.9457; val_best_acc_score: 0.9057; val_best_f1_score: 0.9103; train_kl_reg_loss: 34622.4158; train_edge_recon_loss: 2700499.6667; train_gene_expr_recon_loss: 700019.2431; train_masked_gp_l1_reg_loss: 7153.7137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38301.8702; train_chrom_access_recon_loss: 436085.9028; train_global_loss: 3916682.8611; train_optim_loss: 3916682.8611; val_kl_reg_loss: 33586.6562; val_edge_recon_loss: 2692827.2500; val_gene_expr_recon_loss: 707689.5000; val_masked_gp_l1_reg_loss: 7181.9771; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37299.5664; val_chrom_access_recon_loss: 437627.1875; val_global_loss: 3916212.2500; val_optim_loss: 3916212.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9604; val_auprc_score: 0.9447; val_best_acc_score: 0.9105; val_best_f1_score: 0.9151; train_kl_reg_loss: 34157.1658; train_edge_recon_loss: 2700803.5833; train_gene_expr_recon_loss: 701780.0972; train_masked_gp_l1_reg_loss: 7207.3475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36555.5169; train_chrom_access_recon_loss: 437018.1979; train_global_loss: 3917521.8889; train_optim_loss: 3917521.8889; val_kl_reg_loss: 33339.8281; val_edge_recon_loss: 2691687.2500; val_gene_expr_recon_loss: 703942.6875; val_masked_gp_l1_reg_loss: 7228.2705; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35644.3906; val_chrom_access_recon_loss: 436868.1562; val_global_loss: 3908710.7500; val_optim_loss: 3908710.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9628; val_auprc_score: 0.9479; val_best_acc_score: 0.9119; val_best_f1_score: 0.9165; train_kl_reg_loss: 31283.8164; train_edge_recon_loss: 2694120.7778; train_gene_expr_recon_loss: 994660.2917; train_masked_gp_l1_reg_loss: 7259.9813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34779.0477; train_chrom_access_recon_loss: 460650.0486; train_global_loss: 4222754.0556; train_optim_loss: 4222754.0556; val_kl_reg_loss: 14244.9434; val_edge_recon_loss: 2687283.5000; val_gene_expr_recon_loss: 994706.0000; val_masked_gp_l1_reg_loss: 7294.1973; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33596.9453; val_chrom_access_recon_loss: 460514.1250; val_global_loss: 4197640.0000; val_optim_loss: 4197640.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9680; val_auprc_score: 0.9558; val_best_acc_score: 0.9171; val_best_f1_score: 0.9206; train_kl_reg_loss: 26205.0853; train_edge_recon_loss: 2679101.7222; train_gene_expr_recon_loss: 995558.2986; train_masked_gp_l1_reg_loss: 7341.8094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32587.6146; train_chrom_access_recon_loss: 458733.4792; train_global_loss: 4199528.0000; train_optim_loss: 4199528.0000; val_kl_reg_loss: 12945.0977; val_edge_recon_loss: 2677486.2500; val_gene_expr_recon_loss: 998241.1875; val_masked_gp_l1_reg_loss: 7395.5693; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31328.7617; val_chrom_access_recon_loss: 460610.5625; val_global_loss: 4188007.2500; val_optim_loss: 4188007.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9719; val_auprc_score: 0.9619; val_best_acc_score: 0.9237; val_best_f1_score: 0.9274; train_kl_reg_loss: 23527.3889; train_edge_recon_loss: 2664935.5833; train_gene_expr_recon_loss: 995404.8958; train_masked_gp_l1_reg_loss: 7440.9978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30351.8158; train_chrom_access_recon_loss: 461445.9583; train_global_loss: 4183106.6389; train_optim_loss: 4183106.6389; val_kl_reg_loss: 12703.2568; val_edge_recon_loss: 2658143.0000; val_gene_expr_recon_loss: 999321.5000; val_masked_gp_l1_reg_loss: 7491.7949; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29160.6055; val_chrom_access_recon_loss: 460680.5312; val_global_loss: 4167500.5000; val_optim_loss: 4167500.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9723; val_auprc_score: 0.9603; val_best_acc_score: 0.9262; val_best_f1_score: 0.9292; train_kl_reg_loss: 22638.2188; train_edge_recon_loss: 2654285.5833; train_gene_expr_recon_loss: 993469.1042; train_masked_gp_l1_reg_loss: 7528.6946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28264.5725; train_chrom_access_recon_loss: 462084.7465; train_global_loss: 4168270.9167; train_optim_loss: 4168270.9167; val_kl_reg_loss: 13231.0088; val_edge_recon_loss: 2660678.7500; val_gene_expr_recon_loss: 993904.5000; val_masked_gp_l1_reg_loss: 7573.9229; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27178.4199; val_chrom_access_recon_loss: 459831.8750; val_global_loss: 4162398.5000; val_optim_loss: 4162398.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9733; val_auprc_score: 0.9657; val_best_acc_score: 0.9268; val_best_f1_score: 0.9296; train_kl_reg_loss: 22412.5458; train_edge_recon_loss: 2656583.9167; train_gene_expr_recon_loss: 988526.7917; train_masked_gp_l1_reg_loss: 7547.5249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27052.7311; train_chrom_access_recon_loss: 457654.0347; train_global_loss: 4159777.5278; train_optim_loss: 4159777.5278; val_kl_reg_loss: 13187.1816; val_edge_recon_loss: 2650405.2500; val_gene_expr_recon_loss: 994434.2500; val_masked_gp_l1_reg_loss: 7522.2563; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26900.8828; val_chrom_access_recon_loss: 459861.2188; val_global_loss: 4152311.2500; val_optim_loss: 4152311.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9700; val_auprc_score: 0.9599; val_best_acc_score: 0.9245; val_best_f1_score: 0.9282; train_kl_reg_loss: 22205.9236; train_edge_recon_loss: 2647407.2778; train_gene_expr_recon_loss: 988988.3542; train_masked_gp_l1_reg_loss: 7516.6914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26794.7474; train_chrom_access_recon_loss: 458955.8750; train_global_loss: 4151868.9167; train_optim_loss: 4151868.9167; val_kl_reg_loss: 13136.5508; val_edge_recon_loss: 2643086.0000; val_gene_expr_recon_loss: 993804.3125; val_masked_gp_l1_reg_loss: 7507.7637; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26661.3965; val_chrom_access_recon_loss: 459833.7500; val_global_loss: 4144029.7500; val_optim_loss: 4144029.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9686; val_auprc_score: 0.9569; val_best_acc_score: 0.9194; val_best_f1_score: 0.9232; train_kl_reg_loss: 22139.7190; train_edge_recon_loss: 2646657.9167; train_gene_expr_recon_loss: 985508.0694; train_masked_gp_l1_reg_loss: 7504.4537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26561.1330; train_chrom_access_recon_loss: 458177.8993; train_global_loss: 4146549.2222; train_optim_loss: 4146549.2222; val_kl_reg_loss: 13171.3252; val_edge_recon_loss: 2672225.0000; val_gene_expr_recon_loss: 993202.2500; val_masked_gp_l1_reg_loss: 7501.1616; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26438.1055; val_chrom_access_recon_loss: 459823.9375; val_global_loss: 4172361.7500; val_optim_loss: 4172361.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9725; val_auprc_score: 0.9586; val_best_acc_score: 0.9283; val_best_f1_score: 0.9315; train_kl_reg_loss: 22465.4290; train_edge_recon_loss: 2652991.3889; train_gene_expr_recon_loss: 994199.5139; train_masked_gp_l1_reg_loss: 7500.1547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26343.2711; train_chrom_access_recon_loss: 461369.0764; train_global_loss: 4164868.8333; train_optim_loss: 4164868.8333; val_kl_reg_loss: 13256.6748; val_edge_recon_loss: 2641872.7500; val_gene_expr_recon_loss: 992993.7500; val_masked_gp_l1_reg_loss: 7500.3364; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26228.8438; val_chrom_access_recon_loss: 459723.6250; val_global_loss: 4141576.0000; val_optim_loss: 4141576.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 30 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9620
val AUPRC score: 0.9489
val best accuracy score: 0.9074
val best F1 score: 0.9108
val target rna MSE score: 3.9991
val source rna MSE score: 3.1946
val target atac MSE score: 0.1357
val source atac MSE score: 0.0217
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
