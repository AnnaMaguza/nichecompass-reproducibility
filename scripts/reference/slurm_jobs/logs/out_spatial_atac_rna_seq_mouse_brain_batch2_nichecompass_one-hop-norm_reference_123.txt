[True]
Run timestamp: 07082023_211823_123.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_123']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8882; val_auprc_score: 0.9041; val_best_acc_score: 0.5212; val_best_f1_score: 0.6760; train_kl_reg_loss: 35522.7432; train_edge_recon_loss: 3475587.5556; train_gene_expr_recon_loss: 1156292.7917; train_masked_gp_l1_reg_loss: 8563.6132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167071.7847; train_chrom_access_recon_loss: 1857996.0139; train_global_loss: 6701034.4444; train_optim_loss: 6701034.4444; val_kl_reg_loss: 8045.6641; val_edge_recon_loss: 4063729.2500; val_gene_expr_recon_loss: 988097.2500; val_masked_gp_l1_reg_loss: 6795.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162777.1719; val_chrom_access_recon_loss: 1498178.8750; val_global_loss: 6727623.0000; val_optim_loss: 6727623.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8935; val_auprc_score: 0.9074; val_best_acc_score: 0.5217; val_best_f1_score: 0.6759; train_kl_reg_loss: 7900.5497; train_edge_recon_loss: 3474166.7222; train_gene_expr_recon_loss: 947141.8681; train_masked_gp_l1_reg_loss: 6050.4858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160092.2188; train_chrom_access_recon_loss: 1452383.0972; train_global_loss: 6047734.6667; train_optim_loss: 6047734.6667; val_kl_reg_loss: 9003.4141; val_edge_recon_loss: 4063921.0000; val_gene_expr_recon_loss: 883763.3750; val_masked_gp_l1_reg_loss: 5417.5059; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156729.5156; val_chrom_access_recon_loss: 1400734.1250; val_global_loss: 6519569.0000; val_optim_loss: 6519569.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8773; val_auprc_score: 0.8910; val_best_acc_score: 0.5195; val_best_f1_score: 0.6748; train_kl_reg_loss: 14223.2464; train_edge_recon_loss: 3477644.6944; train_gene_expr_recon_loss: 859801.2778; train_masked_gp_l1_reg_loss: 5333.3241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153814.8073; train_chrom_access_recon_loss: 1402610.6250; train_global_loss: 5913427.8889; train_optim_loss: 5913427.8889; val_kl_reg_loss: 15112.8496; val_edge_recon_loss: 4064270.2500; val_gene_expr_recon_loss: 812646.5000; val_masked_gp_l1_reg_loss: 5325.9448; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149910.7500; val_chrom_access_recon_loss: 1375006.0000; val_global_loss: 6422272.0000; val_optim_loss: 6422272.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8816; val_auprc_score: 0.8973; val_best_acc_score: 0.5357; val_best_f1_score: 0.6813; train_kl_reg_loss: 15275.3889; train_edge_recon_loss: 3480044.0833; train_gene_expr_recon_loss: 810287.3542; train_masked_gp_l1_reg_loss: 5330.3950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146377.6476; train_chrom_access_recon_loss: 1374634.8472; train_global_loss: 5831949.6667; train_optim_loss: 5831949.6667; val_kl_reg_loss: 16895.3984; val_edge_recon_loss: 4063003.2500; val_gene_expr_recon_loss: 780843.3125; val_masked_gp_l1_reg_loss: 5328.2920; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141773.4219; val_chrom_access_recon_loss: 1356923.1250; val_global_loss: 6364767.0000; val_optim_loss: 6364767.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8946; val_auprc_score: 0.9040; val_best_acc_score: 0.5476; val_best_f1_score: 0.6851; train_kl_reg_loss: 18798.3863; train_edge_recon_loss: 3480349.3056; train_gene_expr_recon_loss: 773367.4306; train_masked_gp_l1_reg_loss: 5351.5557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137869.6337; train_chrom_access_recon_loss: 1362718.4722; train_global_loss: 5778454.7222; train_optim_loss: 5778454.7222; val_kl_reg_loss: 18104.3789; val_edge_recon_loss: 4061334.2500; val_gene_expr_recon_loss: 754499.4375; val_masked_gp_l1_reg_loss: 5385.3105; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132896.5312; val_chrom_access_recon_loss: 1345713.7500; val_global_loss: 6317934.0000; val_optim_loss: 6317934.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8888; val_auprc_score: 0.8851; val_best_acc_score: 0.6382; val_best_f1_score: 0.7293; train_kl_reg_loss: 20170.2253; train_edge_recon_loss: 3480510.6667; train_gene_expr_recon_loss: 755551.3750; train_masked_gp_l1_reg_loss: 5420.0643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128837.7622; train_chrom_access_recon_loss: 1353316.7083; train_global_loss: 5743807.0000; train_optim_loss: 5743807.0000; val_kl_reg_loss: 18267.6133; val_edge_recon_loss: 4057270.2500; val_gene_expr_recon_loss: 736868.9375; val_masked_gp_l1_reg_loss: 5466.2690; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123751.3906; val_chrom_access_recon_loss: 1337088.2500; val_global_loss: 6278713.0000; val_optim_loss: 6278713.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8884; val_auprc_score: 0.8852; val_best_acc_score: 0.7144; val_best_f1_score: 0.7698; train_kl_reg_loss: 20734.6135; train_edge_recon_loss: 3480565.5833; train_gene_expr_recon_loss: 739013.1111; train_masked_gp_l1_reg_loss: 5528.2322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119718.6250; train_chrom_access_recon_loss: 1343315.3611; train_global_loss: 5708875.5556; train_optim_loss: 5708875.5556; val_kl_reg_loss: 20520.5527; val_edge_recon_loss: 4051323.0000; val_gene_expr_recon_loss: 721451.5000; val_masked_gp_l1_reg_loss: 5589.7612; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114720.7422; val_chrom_access_recon_loss: 1330752.0000; val_global_loss: 6244357.5000; val_optim_loss: 6244357.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9031; val_auprc_score: 0.8901; val_best_acc_score: 0.8224; val_best_f1_score: 0.8367; train_kl_reg_loss: 21757.6523; train_edge_recon_loss: 3479810.8056; train_gene_expr_recon_loss: 722739.3194; train_masked_gp_l1_reg_loss: 5652.1483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110827.9375; train_chrom_access_recon_loss: 1332157.6389; train_global_loss: 5672945.5000; train_optim_loss: 5672945.5000; val_kl_reg_loss: 21100.4102; val_edge_recon_loss: 4030439.2500; val_gene_expr_recon_loss: 711560.1250; val_masked_gp_l1_reg_loss: 5713.3164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106042.4844; val_chrom_access_recon_loss: 1325377.1250; val_global_loss: 6200233.0000; val_optim_loss: 6200233.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9126; val_auprc_score: 0.8980; val_best_acc_score: 0.8085; val_best_f1_score: 0.8333; train_kl_reg_loss: 20440.7563; train_edge_recon_loss: 3474798.3333; train_gene_expr_recon_loss: 713384.1875; train_masked_gp_l1_reg_loss: 5776.5654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102374.8620; train_chrom_access_recon_loss: 1326172.9167; train_global_loss: 5642947.5000; train_optim_loss: 5642947.5000; val_kl_reg_loss: 18561.6016; val_edge_recon_loss: 3891473.5000; val_gene_expr_recon_loss: 707139.0000; val_masked_gp_l1_reg_loss: 5845.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97895.8438; val_chrom_access_recon_loss: 1321723.5000; val_global_loss: 6042638.5000; val_optim_loss: 6042638.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8674; val_auprc_score: 0.8462; val_best_acc_score: 0.7838; val_best_f1_score: 0.8071; train_kl_reg_loss: 14215.0186; train_edge_recon_loss: 3400529.6944; train_gene_expr_recon_loss: 721502.8611; train_masked_gp_l1_reg_loss: 5927.4499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94519.0399; train_chrom_access_recon_loss: 1328324.7639; train_global_loss: 5565018.8889; train_optim_loss: 5565018.8889; val_kl_reg_loss: 8567.9697; val_edge_recon_loss: 3214088.0000; val_gene_expr_recon_loss: 732744.5625; val_masked_gp_l1_reg_loss: 6039.4658; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90453.9688; val_chrom_access_recon_loss: 1327563.3750; val_global_loss: 5379457.5000; val_optim_loss: 5379457.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8655; val_auprc_score: 0.8532; val_best_acc_score: 0.7692; val_best_f1_score: 0.7937; train_kl_reg_loss: 16278.5598; train_edge_recon_loss: 3025265.4167; train_gene_expr_recon_loss: 752903.6250; train_masked_gp_l1_reg_loss: 6202.0997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87496.0972; train_chrom_access_recon_loss: 1336490.5833; train_global_loss: 5224636.5556; train_optim_loss: 5224636.5556; val_kl_reg_loss: 32951.7422; val_edge_recon_loss: 2908645.5000; val_gene_expr_recon_loss: 755278.7500; val_masked_gp_l1_reg_loss: 6404.5771; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83918.0469; val_chrom_access_recon_loss: 1332581.2500; val_global_loss: 5119780.0000; val_optim_loss: 5119780.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8741; val_auprc_score: 0.8609; val_best_acc_score: 0.7855; val_best_f1_score: 0.7962; train_kl_reg_loss: 43676.8872; train_edge_recon_loss: 2887646.8333; train_gene_expr_recon_loss: 747532.9861; train_masked_gp_l1_reg_loss: 6515.6183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81214.6675; train_chrom_access_recon_loss: 1341418.5972; train_global_loss: 5108005.5000; train_optim_loss: 5108005.5000; val_kl_reg_loss: 53015.9844; val_edge_recon_loss: 2880768.7500; val_gene_expr_recon_loss: 726341.3750; val_masked_gp_l1_reg_loss: 6615.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77956.0156; val_chrom_access_recon_loss: 1322006.0000; val_global_loss: 5066703.5000; val_optim_loss: 5066703.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8889; val_auprc_score: 0.8707; val_best_acc_score: 0.8046; val_best_f1_score: 0.8090; train_kl_reg_loss: 54133.8481; train_edge_recon_loss: 2871404.0278; train_gene_expr_recon_loss: 723269.0764; train_masked_gp_l1_reg_loss: 6649.8203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75519.3863; train_chrom_access_recon_loss: 1324576.7778; train_global_loss: 5055552.8889; train_optim_loss: 5055552.8889; val_kl_reg_loss: 48272.2500; val_edge_recon_loss: 2851219.0000; val_gene_expr_recon_loss: 713337.6250; val_masked_gp_l1_reg_loss: 6669.9199; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72531.7344; val_chrom_access_recon_loss: 1317370.7500; val_global_loss: 5009401.5000; val_optim_loss: 5009401.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8972; val_auprc_score: 0.8711; val_best_acc_score: 0.8195; val_best_f1_score: 0.8290; train_kl_reg_loss: 42617.7214; train_edge_recon_loss: 2839184.3611; train_gene_expr_recon_loss: 720687.5208; train_masked_gp_l1_reg_loss: 6674.4427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70274.7031; train_chrom_access_recon_loss: 1322364.6111; train_global_loss: 5001803.2778; train_optim_loss: 5001803.2778; val_kl_reg_loss: 37134.0234; val_edge_recon_loss: 2823616.0000; val_gene_expr_recon_loss: 713987.0000; val_masked_gp_l1_reg_loss: 6671.9429; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67552.5156; val_chrom_access_recon_loss: 1315428.1250; val_global_loss: 4964389.5000; val_optim_loss: 4964389.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9106; val_auprc_score: 0.8793; val_best_acc_score: 0.8475; val_best_f1_score: 0.8575; train_kl_reg_loss: 37019.3034; train_edge_recon_loss: 2814884.1389; train_gene_expr_recon_loss: 719777.3958; train_masked_gp_l1_reg_loss: 6679.9874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65520.6589; train_chrom_access_recon_loss: 1320890.8333; train_global_loss: 4964772.3333; train_optim_loss: 4964772.3333; val_kl_reg_loss: 35953.7500; val_edge_recon_loss: 2797416.5000; val_gene_expr_recon_loss: 713039.2500; val_masked_gp_l1_reg_loss: 6696.8174; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63063.3789; val_chrom_access_recon_loss: 1314615.6250; val_global_loss: 4930785.5000; val_optim_loss: 4930785.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9328; val_auprc_score: 0.9132; val_best_acc_score: 0.8705; val_best_f1_score: 0.8797; train_kl_reg_loss: 40055.8038; train_edge_recon_loss: 2762783.8333; train_gene_expr_recon_loss: 717402.3681; train_masked_gp_l1_reg_loss: 6721.9124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61255.3924; train_chrom_access_recon_loss: 1317266.7222; train_global_loss: 4905486.0556; train_optim_loss: 4905486.0556; val_kl_reg_loss: 41339.1445; val_edge_recon_loss: 2745842.2500; val_gene_expr_recon_loss: 712202.3750; val_masked_gp_l1_reg_loss: 6747.1216; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59068.6719; val_chrom_access_recon_loss: 1311787.0000; val_global_loss: 4876987.0000; val_optim_loss: 4876987.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9347; val_auprc_score: 0.9141; val_best_acc_score: 0.8739; val_best_f1_score: 0.8822; train_kl_reg_loss: 44419.7843; train_edge_recon_loss: 2741562.7778; train_gene_expr_recon_loss: 713392.3681; train_masked_gp_l1_reg_loss: 6771.1347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57442.0521; train_chrom_access_recon_loss: 1310100.2083; train_global_loss: 4873688.3333; train_optim_loss: 4873688.3333; val_kl_reg_loss: 43862.7734; val_edge_recon_loss: 2760146.0000; val_gene_expr_recon_loss: 705558.3750; val_masked_gp_l1_reg_loss: 6794.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55464.5000; val_chrom_access_recon_loss: 1308836.0000; val_global_loss: 4880662.0000; val_optim_loss: 4880662.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9402; val_auprc_score: 0.9202; val_best_acc_score: 0.8810; val_best_f1_score: 0.8877; train_kl_reg_loss: 45828.4692; train_edge_recon_loss: 2738916.7500; train_gene_expr_recon_loss: 708236.8056; train_masked_gp_l1_reg_loss: 6819.1057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53988.4201; train_chrom_access_recon_loss: 1307709.1250; train_global_loss: 4861498.6667; train_optim_loss: 4861498.6667; val_kl_reg_loss: 42887.3359; val_edge_recon_loss: 2745720.7500; val_gene_expr_recon_loss: 704364.9375; val_masked_gp_l1_reg_loss: 6847.0161; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52186.2461; val_chrom_access_recon_loss: 1305354.6250; val_global_loss: 4857361.0000; val_optim_loss: 4857361.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9465; val_auprc_score: 0.9291; val_best_acc_score: 0.8880; val_best_f1_score: 0.8935; train_kl_reg_loss: 43616.3780; train_edge_recon_loss: 2725154.7500; train_gene_expr_recon_loss: 705006.2639; train_masked_gp_l1_reg_loss: 6873.7454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50843.7622; train_chrom_access_recon_loss: 1309364.0694; train_global_loss: 4840858.8889; train_optim_loss: 4840858.8889; val_kl_reg_loss: 40676.4453; val_edge_recon_loss: 2728769.0000; val_gene_expr_recon_loss: 701907.1875; val_masked_gp_l1_reg_loss: 6896.9980; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49200.5938; val_chrom_access_recon_loss: 1303543.5000; val_global_loss: 4830994.0000; val_optim_loss: 4830994.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9527; val_auprc_score: 0.9360; val_best_acc_score: 0.8953; val_best_f1_score: 0.9003; train_kl_reg_loss: 41318.7760; train_edge_recon_loss: 2716978.2222; train_gene_expr_recon_loss: 702643.6528; train_masked_gp_l1_reg_loss: 6917.9387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47975.2170; train_chrom_access_recon_loss: 1308622.1389; train_global_loss: 4824455.8889; train_optim_loss: 4824455.8889; val_kl_reg_loss: 40286.9688; val_edge_recon_loss: 2740501.5000; val_gene_expr_recon_loss: 696223.1250; val_masked_gp_l1_reg_loss: 6932.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46469.7070; val_chrom_access_recon_loss: 1301565.8750; val_global_loss: 4831979.5000; val_optim_loss: 4831979.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9560; val_auprc_score: 0.9384; val_best_acc_score: 0.8981; val_best_f1_score: 0.9033; train_kl_reg_loss: 41299.2643; train_edge_recon_loss: 2721095.8889; train_gene_expr_recon_loss: 704491.9722; train_masked_gp_l1_reg_loss: 6958.4415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45339.2713; train_chrom_access_recon_loss: 1309422.2917; train_global_loss: 4828607.0000; train_optim_loss: 4828607.0000; val_kl_reg_loss: 39413.8203; val_edge_recon_loss: 2731855.7500; val_gene_expr_recon_loss: 696755.7500; val_masked_gp_l1_reg_loss: 6983.8237; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43968.4766; val_chrom_access_recon_loss: 1299358.8750; val_global_loss: 4818336.5000; val_optim_loss: 4818336.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9601; val_auprc_score: 0.9448; val_best_acc_score: 0.9096; val_best_f1_score: 0.9131; train_kl_reg_loss: 40550.3503; train_edge_recon_loss: 2709410.8056; train_gene_expr_recon_loss: 700659.0972; train_masked_gp_l1_reg_loss: 7015.7847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42955.3151; train_chrom_access_recon_loss: 1306428.2917; train_global_loss: 4807019.6667; train_optim_loss: 4807019.6667; val_kl_reg_loss: 38626.1953; val_edge_recon_loss: 2706251.5000; val_gene_expr_recon_loss: 696413.2500; val_masked_gp_l1_reg_loss: 7038.4771; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41701.7969; val_chrom_access_recon_loss: 1297755.7500; val_global_loss: 4787787.0000; val_optim_loss: 4787787.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9575; val_auprc_score: 0.9408; val_best_acc_score: 0.9050; val_best_f1_score: 0.9085; train_kl_reg_loss: 39119.9544; train_edge_recon_loss: 2711694.8056; train_gene_expr_recon_loss: 696697.1111; train_masked_gp_l1_reg_loss: 7063.4963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40761.3464; train_chrom_access_recon_loss: 1305574.3333; train_global_loss: 4800911.0000; train_optim_loss: 4800911.0000; val_kl_reg_loss: 37912.4766; val_edge_recon_loss: 2711064.0000; val_gene_expr_recon_loss: 693562.7500; val_masked_gp_l1_reg_loss: 7079.9932; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39607.6367; val_chrom_access_recon_loss: 1294851.1250; val_global_loss: 4784078.0000; val_optim_loss: 4784078.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9606; val_auprc_score: 0.9426; val_best_acc_score: 0.9122; val_best_f1_score: 0.9153; train_kl_reg_loss: 39294.1016; train_edge_recon_loss: 2703165.0000; train_gene_expr_recon_loss: 691424.5764; train_masked_gp_l1_reg_loss: 7100.5197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38739.0273; train_chrom_access_recon_loss: 1299782.5833; train_global_loss: 4779505.8889; train_optim_loss: 4779505.8889; val_kl_reg_loss: 39031.9414; val_edge_recon_loss: 2700073.0000; val_gene_expr_recon_loss: 690036.5000; val_masked_gp_l1_reg_loss: 7109.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37670.6875; val_chrom_access_recon_loss: 1292874.5000; val_global_loss: 4766796.0000; val_optim_loss: 4766796.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9598; val_auprc_score: 0.9439; val_best_acc_score: 0.9119; val_best_f1_score: 0.9155; train_kl_reg_loss: 39833.5977; train_edge_recon_loss: 2694125.2222; train_gene_expr_recon_loss: 692257.2500; train_masked_gp_l1_reg_loss: 7120.7275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36870.6402; train_chrom_access_recon_loss: 1297330.7222; train_global_loss: 4767538.2222; train_optim_loss: 4767538.2222; val_kl_reg_loss: 39524.2695; val_edge_recon_loss: 2692033.0000; val_gene_expr_recon_loss: 687435.7500; val_masked_gp_l1_reg_loss: 7127.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35883.8633; val_chrom_access_recon_loss: 1290630.1250; val_global_loss: 4752634.0000; val_optim_loss: 4752634.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9558; val_auprc_score: 0.9350; val_best_acc_score: 0.9057; val_best_f1_score: 0.9094; train_kl_reg_loss: 38109.2930; train_edge_recon_loss: 2687214.0278; train_gene_expr_recon_loss: 971389.7708; train_masked_gp_l1_reg_loss: 7147.3702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34883.3967; train_chrom_access_recon_loss: 1378739.1806; train_global_loss: 5117483.0000; train_optim_loss: 5117483.0000; val_kl_reg_loss: 17273.4727; val_edge_recon_loss: 2728044.7500; val_gene_expr_recon_loss: 951374.7500; val_masked_gp_l1_reg_loss: 7162.3604; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33507.8555; val_chrom_access_recon_loss: 1363745.7500; val_global_loss: 5101109.0000; val_optim_loss: 5101109.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9602; val_auprc_score: 0.9449; val_best_acc_score: 0.9080; val_best_f1_score: 0.9124; train_kl_reg_loss: 36025.4457; train_edge_recon_loss: 2683591.5556; train_gene_expr_recon_loss: 964886.2083; train_masked_gp_l1_reg_loss: 7193.3353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32337.4125; train_chrom_access_recon_loss: 1374005.9306; train_global_loss: 5098039.8889; train_optim_loss: 5098039.8889; val_kl_reg_loss: 17408.7031; val_edge_recon_loss: 2703206.5000; val_gene_expr_recon_loss: 952350.8750; val_masked_gp_l1_reg_loss: 7234.9473; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30884.6914; val_chrom_access_recon_loss: 1363386.3750; val_global_loss: 5074472.0000; val_optim_loss: 5074472.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9684; val_auprc_score: 0.9576; val_best_acc_score: 0.9155; val_best_f1_score: 0.9191; train_kl_reg_loss: 33858.9811; train_edge_recon_loss: 2678326.8889; train_gene_expr_recon_loss: 959401.6875; train_masked_gp_l1_reg_loss: 7275.1714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29775.3249; train_chrom_access_recon_loss: 1373251.8611; train_global_loss: 5081890.0000; train_optim_loss: 5081890.0000; val_kl_reg_loss: 17179.8086; val_edge_recon_loss: 2680178.0000; val_gene_expr_recon_loss: 951626.5000; val_masked_gp_l1_reg_loss: 7321.6885; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28429.8145; val_chrom_access_recon_loss: 1363011.7500; val_global_loss: 5047747.5000; val_optim_loss: 5047747.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9665; val_auprc_score: 0.9553; val_best_acc_score: 0.9162; val_best_f1_score: 0.9200; train_kl_reg_loss: 31711.0942; train_edge_recon_loss: 2667249.3333; train_gene_expr_recon_loss: 951167.6042; train_masked_gp_l1_reg_loss: 7359.5657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27431.1183; train_chrom_access_recon_loss: 1364964.1944; train_global_loss: 5049883.0000; train_optim_loss: 5049883.0000; val_kl_reg_loss: 16939.0684; val_edge_recon_loss: 2686838.2500; val_gene_expr_recon_loss: 945496.6250; val_masked_gp_l1_reg_loss: 7402.1333; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26231.3633; val_chrom_access_recon_loss: 1359863.8750; val_global_loss: 5042771.5000; val_optim_loss: 5042771.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9656; val_auprc_score: 0.9527; val_best_acc_score: 0.9148; val_best_f1_score: 0.9192; train_kl_reg_loss: 30367.1762; train_edge_recon_loss: 2667405.2500; train_gene_expr_recon_loss: 949938.2153; train_masked_gp_l1_reg_loss: 7374.7396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26047.9833; train_chrom_access_recon_loss: 1359330.4306; train_global_loss: 5040463.8889; train_optim_loss: 5040463.8889; val_kl_reg_loss: 17152.4121; val_edge_recon_loss: 2687960.2500; val_gene_expr_recon_loss: 947568.6250; val_masked_gp_l1_reg_loss: 7349.0010; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25843.2441; val_chrom_access_recon_loss: 1361101.6250; val_global_loss: 5046975.5000; val_optim_loss: 5046975.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9688; val_auprc_score: 0.9559; val_best_acc_score: 0.9189; val_best_f1_score: 0.9224; train_kl_reg_loss: 30297.1272; train_edge_recon_loss: 2659064.7778; train_gene_expr_recon_loss: 958172.2500; train_masked_gp_l1_reg_loss: 7343.7705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25717.2320; train_chrom_access_recon_loss: 1376444.1944; train_global_loss: 5057039.3333; train_optim_loss: 5057039.3333; val_kl_reg_loss: 17006.2051; val_edge_recon_loss: 2679023.2500; val_gene_expr_recon_loss: 946377.7500; val_masked_gp_l1_reg_loss: 7335.3799; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25555.3516; val_chrom_access_recon_loss: 1360357.3750; val_global_loss: 5035655.5000; val_optim_loss: 5035655.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9681; val_auprc_score: 0.9567; val_best_acc_score: 0.9175; val_best_f1_score: 0.9211; train_kl_reg_loss: 30077.8014; train_edge_recon_loss: 2662445.2778; train_gene_expr_recon_loss: 957954.9444; train_masked_gp_l1_reg_loss: 7332.2697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25438.5972; train_chrom_access_recon_loss: 1370773.6389; train_global_loss: 5054022.5556; train_optim_loss: 5054022.5556; val_kl_reg_loss: 17091.5879; val_edge_recon_loss: 2670335.0000; val_gene_expr_recon_loss: 946400.7500; val_masked_gp_l1_reg_loss: 7328.9302; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25296.0039; val_chrom_access_recon_loss: 1360371.3750; val_global_loss: 5026823.5000; val_optim_loss: 5026823.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9673; val_auprc_score: 0.9564; val_best_acc_score: 0.9166; val_best_f1_score: 0.9199; train_kl_reg_loss: 29833.4201; train_edge_recon_loss: 2660820.0278; train_gene_expr_recon_loss: 956071.9236; train_masked_gp_l1_reg_loss: 7328.0264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25187.8053; train_chrom_access_recon_loss: 1378481.3889; train_global_loss: 5057722.5556; train_optim_loss: 5057722.5556; val_kl_reg_loss: 16999.7031; val_edge_recon_loss: 2673146.7500; val_gene_expr_recon_loss: 945701.8750; val_masked_gp_l1_reg_loss: 7327.8506; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25058.7461; val_chrom_access_recon_loss: 1360010.0000; val_global_loss: 5028245.0000; val_optim_loss: 5028245.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 37 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9616
val AUPRC score: 0.9455
val best accuracy score: 0.9085
val best F1 score: 0.9133
val target rna MSE score: 3.8059
val source rna MSE score: 3.2067
val target atac MSE score: 0.1321
val source atac MSE score: 0.0208
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
