[True]
Run timestamp: 29072023_125536_123.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_123']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8803; val_auprc_score: 0.8984; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 40966.8176; train_edge_recon_loss: 34786451.5556; train_gene_expr_recon_loss: 816137.2639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 183360421.3333; train_global_loss: 219003975.1111; train_optim_loss: 219003975.1111; val_kl_reg_loss: 37353.5547; val_edge_recon_loss: 40653096.0000; val_gene_expr_recon_loss: 772597.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 173424432.0000; val_global_loss: 214887472.0000; val_optim_loss: 214887472.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8824; val_auprc_score: 0.9016; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 38129.1840; train_edge_recon_loss: 34865837.7778; train_gene_expr_recon_loss: 776710.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 173156412.4444; train_global_loss: 208837089.7778; train_optim_loss: 208837089.7778; val_kl_reg_loss: 30806.0664; val_edge_recon_loss: 40656228.0000; val_gene_expr_recon_loss: 759770.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 171637632.0000; val_global_loss: 213084448.0000; val_optim_loss: 213084448.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8744; val_auprc_score: 0.8911; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 49700.6645; train_edge_recon_loss: 34826817.3333; train_gene_expr_recon_loss: 744551.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 170004613.3333; train_global_loss: 205625681.7778; train_optim_loss: 205625681.7778; val_kl_reg_loss: 54306.4688; val_edge_recon_loss: 40657512.0000; val_gene_expr_recon_loss: 737968.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 169885568.0000; val_global_loss: 211335360.0000; val_optim_loss: 211335360.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8718; val_auprc_score: 0.8847; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 123128.4444; train_edge_recon_loss: 34822925.7778; train_gene_expr_recon_loss: 730947.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 170498016.0000; train_global_loss: 206175018.6667; train_optim_loss: 206175018.6667; val_kl_reg_loss: 87975.6172; val_edge_recon_loss: 40658664.0000; val_gene_expr_recon_loss: 720194.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 168092128.0000; val_global_loss: 209558960.0000; val_optim_loss: 209558960.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8739; val_auprc_score: 0.8882; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 103422.7457; train_edge_recon_loss: 34877016.0000; train_gene_expr_recon_loss: 711362.3542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 167393560.8889; train_global_loss: 203085365.3333; train_optim_loss: 203085365.3333; val_kl_reg_loss: 237159.8125; val_edge_recon_loss: 40659484.0000; val_gene_expr_recon_loss: 707686.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 166588080.0000; val_global_loss: 208192416.0000; val_optim_loss: 208192416.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8734; val_auprc_score: 0.8831; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 212440.1163; train_edge_recon_loss: 34825718.2222; train_gene_expr_recon_loss: 700414.7639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 166370741.3333; train_global_loss: 202109315.5556; train_optim_loss: 202109315.5556; val_kl_reg_loss: 222348.7188; val_edge_recon_loss: 40659468.0000; val_gene_expr_recon_loss: 688434.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 164797536.0000; val_global_loss: 206367792.0000; val_optim_loss: 206367792.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8720; val_auprc_score: 0.8839; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 238617.0990; train_edge_recon_loss: 34868688.4444; train_gene_expr_recon_loss: 682417.5486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 164131121.7778; train_global_loss: 199920846.2222; train_optim_loss: 199920846.2222; val_kl_reg_loss: 212119.9062; val_edge_recon_loss: 40659036.0000; val_gene_expr_recon_loss: 677104.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 163893344.0000; val_global_loss: 205441600.0000; val_optim_loss: 205441600.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8733; val_auprc_score: 0.8818; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 272008.8490; train_edge_recon_loss: 34840624.0000; train_gene_expr_recon_loss: 668523.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 163932168.8889; train_global_loss: 199713326.2222; train_optim_loss: 199713326.2222; val_kl_reg_loss: 217867.2656; val_edge_recon_loss: 40658444.0000; val_gene_expr_recon_loss: 660272.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 162566752.0000; val_global_loss: 204103328.0000; val_optim_loss: 204103328.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8749; val_auprc_score: 0.8778; val_best_acc_score: 0.5035; val_best_f1_score: 0.6682; train_kl_reg_loss: 278318.6701; train_edge_recon_loss: 34831668.4444; train_gene_expr_recon_loss: 648384.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 162474247.1111; train_global_loss: 198232620.4444; train_optim_loss: 198232620.4444; val_kl_reg_loss: 252381.0469; val_edge_recon_loss: 40656124.0000; val_gene_expr_recon_loss: 641235.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 161543008.0000; val_global_loss: 203092752.0000; val_optim_loss: 203092752.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8764; val_auprc_score: 0.8774; val_best_acc_score: 0.5100; val_best_f1_score: 0.6711; train_kl_reg_loss: 302591.6406; train_edge_recon_loss: 34811195.1111; train_gene_expr_recon_loss: 628593.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 161647015.1111; train_global_loss: 197389397.3333; train_optim_loss: 197389397.3333; val_kl_reg_loss: 210847.0781; val_edge_recon_loss: 40652300.0000; val_gene_expr_recon_loss: 620811.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 160227696.0000; val_global_loss: 201711648.0000; val_optim_loss: 201711648.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8576; val_auprc_score: 0.8591; val_best_acc_score: 0.5140; val_best_f1_score: 0.6730; train_kl_reg_loss: 275365.9566; train_edge_recon_loss: 34816526.2222; train_gene_expr_recon_loss: 607154.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 160503379.5556; train_global_loss: 196202421.3333; train_optim_loss: 196202421.3333; val_kl_reg_loss: 244068.0938; val_edge_recon_loss: 40649624.0000; val_gene_expr_recon_loss: 597020.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 159171792.0000; val_global_loss: 200662496.0000; val_optim_loss: 200662496.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8496; val_auprc_score: 0.8519; val_best_acc_score: 0.5206; val_best_f1_score: 0.6759; train_kl_reg_loss: 282584.1389; train_edge_recon_loss: 34804305.7778; train_gene_expr_recon_loss: 580778.6736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 158910531.5556; train_global_loss: 194578200.8889; train_optim_loss: 194578200.8889; val_kl_reg_loss: 228608.7344; val_edge_recon_loss: 40645144.0000; val_gene_expr_recon_loss: 572769.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 158151168.0000; val_global_loss: 199597696.0000; val_optim_loss: 199597696.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8417; val_auprc_score: 0.8448; val_best_acc_score: 0.5279; val_best_f1_score: 0.6789; train_kl_reg_loss: 271592.2465; train_edge_recon_loss: 34793842.2222; train_gene_expr_recon_loss: 554458.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156924698.6667; train_global_loss: 192544592.0000; train_optim_loss: 192544592.0000; val_kl_reg_loss: 225254.9219; val_edge_recon_loss: 40639376.0000; val_gene_expr_recon_loss: 550229.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 157147536.0000; val_global_loss: 198562400.0000; val_optim_loss: 198562400.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8346; val_auprc_score: 0.8354; val_best_acc_score: 0.5314; val_best_f1_score: 0.6802; train_kl_reg_loss: 264774.8438; train_edge_recon_loss: 34811711.5556; train_gene_expr_recon_loss: 532074.6285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156585226.6667; train_global_loss: 192193786.6667; train_optim_loss: 192193786.6667; val_kl_reg_loss: 198185.9375; val_edge_recon_loss: 40635816.0000; val_gene_expr_recon_loss: 526901.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155931408.0000; val_global_loss: 197292304.0000; val_optim_loss: 197292304.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8290; val_auprc_score: 0.8297; val_best_acc_score: 0.5399; val_best_f1_score: 0.6837; train_kl_reg_loss: 257702.3490; train_edge_recon_loss: 34815808.0000; train_gene_expr_recon_loss: 509564.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155675633.7778; train_global_loss: 191258707.5556; train_optim_loss: 191258707.5556; val_kl_reg_loss: 202239.0625; val_edge_recon_loss: 40630288.0000; val_gene_expr_recon_loss: 506298.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155728608.0000; val_global_loss: 197067440.0000; val_optim_loss: 197067440.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8225; val_auprc_score: 0.8262; val_best_acc_score: 0.5461; val_best_f1_score: 0.6859; train_kl_reg_loss: 253684.3056; train_edge_recon_loss: 34809064.4444; train_gene_expr_recon_loss: 490294.1354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155281793.7778; train_global_loss: 190834837.3333; train_optim_loss: 190834837.3333; val_kl_reg_loss: 180005.2500; val_edge_recon_loss: 40624616.0000; val_gene_expr_recon_loss: 489544.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154857264.0000; val_global_loss: 196151424.0000; val_optim_loss: 196151424.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8270; val_auprc_score: 0.8333; val_best_acc_score: 0.5538; val_best_f1_score: 0.6892; train_kl_reg_loss: 243279.9983; train_edge_recon_loss: 34789301.3333; train_gene_expr_recon_loss: 476750.4514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154912542.2222; train_global_loss: 190421875.5556; train_optim_loss: 190421875.5556; val_kl_reg_loss: 207659.3281; val_edge_recon_loss: 40619900.0000; val_gene_expr_recon_loss: 473594.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154439312.0000; val_global_loss: 195740464.0000; val_optim_loss: 195740464.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8220; val_auprc_score: 0.8231; val_best_acc_score: 0.5622; val_best_f1_score: 0.6927; train_kl_reg_loss: 237046.1389; train_edge_recon_loss: 34793285.3333; train_gene_expr_recon_loss: 464221.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155141527.1111; train_global_loss: 190636080.0000; train_optim_loss: 190636080.0000; val_kl_reg_loss: 191389.5625; val_edge_recon_loss: 40611928.0000; val_gene_expr_recon_loss: 461829.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153849520.0000; val_global_loss: 195114656.0000; val_optim_loss: 195114656.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8169; val_auprc_score: 0.8203; val_best_acc_score: 0.5707; val_best_f1_score: 0.6956; train_kl_reg_loss: 230341.7101; train_edge_recon_loss: 34785763.1111; train_gene_expr_recon_loss: 451721.9896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154028698.6667; train_global_loss: 189496526.2222; train_optim_loss: 189496526.2222; val_kl_reg_loss: 185692.7812; val_edge_recon_loss: 40603992.0000; val_gene_expr_recon_loss: 452347.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153750688.0000; val_global_loss: 194992720.0000; val_optim_loss: 194992720.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8273; val_auprc_score: 0.8256; val_best_acc_score: 0.5861; val_best_f1_score: 0.7025; train_kl_reg_loss: 232852.1042; train_edge_recon_loss: 34789506.6667; train_gene_expr_recon_loss: 441025.3299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153369185.7778; train_global_loss: 188832570.6667; train_optim_loss: 188832570.6667; val_kl_reg_loss: 179691.7812; val_edge_recon_loss: 40592032.0000; val_gene_expr_recon_loss: 442596.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153185088.0000; val_global_loss: 194399408.0000; val_optim_loss: 194399408.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8268; val_auprc_score: 0.8240; val_best_acc_score: 0.6011; val_best_f1_score: 0.7089; train_kl_reg_loss: 221431.0851; train_edge_recon_loss: 34783357.7778; train_gene_expr_recon_loss: 434150.8160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152691219.5556; train_global_loss: 188130158.2222; train_optim_loss: 188130158.2222; val_kl_reg_loss: 188322.3750; val_edge_recon_loss: 40576952.0000; val_gene_expr_recon_loss: 436399.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152922016.0000; val_global_loss: 194123696.0000; val_optim_loss: 194123696.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8257; val_auprc_score: 0.8223; val_best_acc_score: 0.6223; val_best_f1_score: 0.7188; train_kl_reg_loss: 218602.1788; train_edge_recon_loss: 34761621.7778; train_gene_expr_recon_loss: 425619.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152222062.2222; train_global_loss: 187627907.5556; train_optim_loss: 187627907.5556; val_kl_reg_loss: 172856.6875; val_edge_recon_loss: 40557444.0000; val_gene_expr_recon_loss: 429461.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152747712.0000; val_global_loss: 193907472.0000; val_optim_loss: 193907472.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8427; val_auprc_score: 0.8348; val_best_acc_score: 0.6549; val_best_f1_score: 0.7352; train_kl_reg_loss: 212615.7639; train_edge_recon_loss: 34774831.1111; train_gene_expr_recon_loss: 423682.4618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153885424.0000; train_global_loss: 189296551.1111; train_optim_loss: 189296551.1111; val_kl_reg_loss: 185529.6719; val_edge_recon_loss: 40514604.0000; val_gene_expr_recon_loss: 423170.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152549408.0000; val_global_loss: 193672704.0000; val_optim_loss: 193672704.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8382; val_auprc_score: 0.8284; val_best_acc_score: 0.6889; val_best_f1_score: 0.7525; train_kl_reg_loss: 215708.2344; train_edge_recon_loss: 34766380.4444; train_gene_expr_recon_loss: 421399.5903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153755310.2222; train_global_loss: 189158800.0000; train_optim_loss: 189158800.0000; val_kl_reg_loss: 161001.0469; val_edge_recon_loss: 40479916.0000; val_gene_expr_recon_loss: 421676.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152515616.0000; val_global_loss: 193578208.0000; val_optim_loss: 193578208.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8408; val_auprc_score: 0.8288; val_best_acc_score: 0.7172; val_best_f1_score: 0.7661; train_kl_reg_loss: 199231.5208; train_edge_recon_loss: 34733289.7778; train_gene_expr_recon_loss: 414628.8819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152876142.2222; train_global_loss: 188223290.6667; train_optim_loss: 188223290.6667; val_kl_reg_loss: 165138.8594; val_edge_recon_loss: 40406092.0000; val_gene_expr_recon_loss: 417913.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152177040.0000; val_global_loss: 193166176.0000; val_optim_loss: 193166176.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8366; val_auprc_score: 0.8221; val_best_acc_score: 0.7515; val_best_f1_score: 0.7796; train_kl_reg_loss: 389457.4149; train_edge_recon_loss: 37612633.3333; train_gene_expr_recon_loss: 417685.8299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152285726.2222; train_global_loss: 190705507.5556; train_optim_loss: 190705507.5556; val_kl_reg_loss: 473641.7500; val_edge_recon_loss: 40315520.0000; val_gene_expr_recon_loss: 422460.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152567504.0000; val_global_loss: 193779120.0000; val_optim_loss: 193779120.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8255; val_auprc_score: 0.8202; val_best_acc_score: 0.7096; val_best_f1_score: 0.7584; train_kl_reg_loss: 398610.5590; train_edge_recon_loss: 36020871.1111; train_gene_expr_recon_loss: 449863.6181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154036320.0000; train_global_loss: 190905665.7778; train_optim_loss: 190905665.7778; val_kl_reg_loss: 136465.6562; val_edge_recon_loss: 40357804.0000; val_gene_expr_recon_loss: 421712.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152769760.0000; val_global_loss: 193685744.0000; val_optim_loss: 193685744.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8424; val_auprc_score: 0.8381; val_best_acc_score: 0.6766; val_best_f1_score: 0.7472; train_kl_reg_loss: 199863.4149; train_edge_recon_loss: 35165652.0000; train_gene_expr_recon_loss: 427698.7604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152231973.3333; train_global_loss: 188025187.5556; train_optim_loss: 188025187.5556; val_kl_reg_loss: 133152.6875; val_edge_recon_loss: 40468492.0000; val_gene_expr_recon_loss: 412269.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152394528.0000; val_global_loss: 193408448.0000; val_optim_loss: 193408448.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8267; val_auprc_score: 0.8210; val_best_acc_score: 0.6878; val_best_f1_score: 0.7498; train_kl_reg_loss: 191689.7422; train_edge_recon_loss: 35287884.4444; train_gene_expr_recon_loss: 429578.3403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153545461.3333; train_global_loss: 189454615.1111; train_optim_loss: 189454615.1111; val_kl_reg_loss: 136016.5312; val_edge_recon_loss: 40426240.0000; val_gene_expr_recon_loss: 414970.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152206272.0000; val_global_loss: 193183504.0000; val_optim_loss: 193183504.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8204; val_auprc_score: 0.8156; val_best_acc_score: 0.6741; val_best_f1_score: 0.7441; train_kl_reg_loss: 189700.5260; train_edge_recon_loss: 35388296.4444; train_gene_expr_recon_loss: 424211.1181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152978323.5556; train_global_loss: 188980531.5556; train_optim_loss: 188980531.5556; val_kl_reg_loss: 262991.5625; val_edge_recon_loss: 40464560.0000; val_gene_expr_recon_loss: 405681.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152279872.0000; val_global_loss: 193413104.0000; val_optim_loss: 193413104.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8293; val_auprc_score: 0.8238; val_best_acc_score: 0.6783; val_best_f1_score: 0.7466; train_kl_reg_loss: 309994.1215; train_edge_recon_loss: 35136340.4444; train_gene_expr_recon_loss: 435034.9306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152405036.4444; train_global_loss: 188286405.3333; train_optim_loss: 188286405.3333; val_kl_reg_loss: 245112.9688; val_edge_recon_loss: 40450024.0000; val_gene_expr_recon_loss: 405137.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152171328.0000; val_global_loss: 193271600.0000; val_optim_loss: 193271600.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8276; val_auprc_score: 0.8189; val_best_acc_score: 0.6909; val_best_f1_score: 0.7530; train_kl_reg_loss: 217094.1528; train_edge_recon_loss: 35225827.1111; train_gene_expr_recon_loss: 425096.6354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152221518.2222; train_global_loss: 188089536.0000; train_optim_loss: 188089536.0000; val_kl_reg_loss: 179690.3125; val_edge_recon_loss: 40427704.0000; val_gene_expr_recon_loss: 407358.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151782576.0000; val_global_loss: 192797328.0000; val_optim_loss: 192797328.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8233; val_auprc_score: 0.8167; val_best_acc_score: 0.6850; val_best_f1_score: 0.7495; train_kl_reg_loss: 214326.1215; train_edge_recon_loss: 35176904.4444; train_gene_expr_recon_loss: 421299.5486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151718259.5556; train_global_loss: 187530789.3333; train_optim_loss: 187530789.3333; val_kl_reg_loss: 225141.2969; val_edge_recon_loss: 40423136.0000; val_gene_expr_recon_loss: 405673.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151956064.0000; val_global_loss: 193010016.0000; val_optim_loss: 193010016.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8234; val_auprc_score: 0.8168; val_best_acc_score: 0.6920; val_best_f1_score: 0.7525; train_kl_reg_loss: 241299.5052; train_edge_recon_loss: 35141880.0000; train_gene_expr_recon_loss: 428296.8368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152346046.2222; train_global_loss: 188157521.7778; train_optim_loss: 188157521.7778; val_kl_reg_loss: 193941.0469; val_edge_recon_loss: 40407284.0000; val_gene_expr_recon_loss: 406781.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152025664.0000; val_global_loss: 193033664.0000; val_optim_loss: 193033664.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8249; val_auprc_score: 0.8225; val_best_acc_score: 0.6951; val_best_f1_score: 0.7532; train_kl_reg_loss: 168865.7691; train_edge_recon_loss: 35155550.6667; train_gene_expr_recon_loss: 418935.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152331927.1111; train_global_loss: 188075276.4444; train_optim_loss: 188075276.4444; val_kl_reg_loss: 156011.8906; val_edge_recon_loss: 40392040.0000; val_gene_expr_recon_loss: 408145.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152091168.0000; val_global_loss: 193047360.0000; val_optim_loss: 193047360.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.8253; val_auprc_score: 0.8180; val_best_acc_score: 0.6939; val_best_f1_score: 0.7535; train_kl_reg_loss: 202214.8750; train_edge_recon_loss: 35021000.4444; train_gene_expr_recon_loss: 421856.1806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152610748.4444; train_global_loss: 188255820.4444; train_optim_loss: 188255820.4444; val_kl_reg_loss: 207828.6875; val_edge_recon_loss: 40401240.0000; val_gene_expr_recon_loss: 404298.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151931536.0000; val_global_loss: 192944896.0000; val_optim_loss: 192944896.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8307; val_auprc_score: 0.8240; val_best_acc_score: 0.6954; val_best_f1_score: 0.7541; train_kl_reg_loss: 219787.3993; train_edge_recon_loss: 35027412.4444; train_gene_expr_recon_loss: 425375.2604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152406725.3333; train_global_loss: 188079299.5556; train_optim_loss: 188079299.5556; val_kl_reg_loss: 198416.5625; val_edge_recon_loss: 40409720.0000; val_gene_expr_recon_loss: 404922.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151891040.0000; val_global_loss: 192904096.0000; val_optim_loss: 192904096.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.8257; val_auprc_score: 0.8177; val_best_acc_score: 0.6962; val_best_f1_score: 0.7545; train_kl_reg_loss: 206068.0139; train_edge_recon_loss: 35030415.1111; train_gene_expr_recon_loss: 418330.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151505523.5556; train_global_loss: 187160337.7778; train_optim_loss: 187160337.7778; val_kl_reg_loss: 185966.7188; val_edge_recon_loss: 40400244.0000; val_gene_expr_recon_loss: 405398.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151709056.0000; val_global_loss: 192700672.0000; val_optim_loss: 192700672.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.8317; val_auprc_score: 0.8236; val_best_acc_score: 0.7028; val_best_f1_score: 0.7585; train_kl_reg_loss: 196635.2899; train_edge_recon_loss: 35059156.4444; train_gene_expr_recon_loss: 422400.0069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151850140.4444; train_global_loss: 187528330.6667; train_optim_loss: 187528330.6667; val_kl_reg_loss: 179008.0000; val_edge_recon_loss: 40398016.0000; val_gene_expr_recon_loss: 405809.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151980352.0000; val_global_loss: 192963184.0000; val_optim_loss: 192963184.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.8256; val_auprc_score: 0.8165; val_best_acc_score: 0.6960; val_best_f1_score: 0.7541; train_kl_reg_loss: 193411.9948; train_edge_recon_loss: 35091313.3333; train_gene_expr_recon_loss: 423554.2569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152470860.4444; train_global_loss: 188179137.7778; train_optim_loss: 188179137.7778; val_kl_reg_loss: 179969.6875; val_edge_recon_loss: 40401172.0000; val_gene_expr_recon_loss: 405794.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152001088.0000; val_global_loss: 192988032.0000; val_optim_loss: 192988032.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.8294; val_auprc_score: 0.8229; val_best_acc_score: 0.6998; val_best_f1_score: 0.7567; train_kl_reg_loss: 194710.4792; train_edge_recon_loss: 35056358.6667; train_gene_expr_recon_loss: 422832.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152229285.3333; train_global_loss: 187903185.7778; train_optim_loss: 187903185.7778; val_kl_reg_loss: 179804.5000; val_edge_recon_loss: 40403636.0000; val_gene_expr_recon_loss: 405439.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151834864.0000; val_global_loss: 192823744.0000; val_optim_loss: 192823744.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.8291; val_auprc_score: 0.8194; val_best_acc_score: 0.7043; val_best_f1_score: 0.7595; train_kl_reg_loss: 197185.1875; train_edge_recon_loss: 35090627.1111; train_gene_expr_recon_loss: 418584.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152504053.3333; train_global_loss: 188210448.0000; train_optim_loss: 188210448.0000; val_kl_reg_loss: 186494.6250; val_edge_recon_loss: 40388364.0000; val_gene_expr_recon_loss: 405665.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152022624.0000; val_global_loss: 193003152.0000; val_optim_loss: 193003152.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.8246; val_auprc_score: 0.8153; val_best_acc_score: 0.7009; val_best_f1_score: 0.7573; train_kl_reg_loss: 198628.1667; train_edge_recon_loss: 35087930.6667; train_gene_expr_recon_loss: 420558.0521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152874561.7778; train_global_loss: 188581678.2222; train_optim_loss: 188581678.2222; val_kl_reg_loss: 185780.8438; val_edge_recon_loss: 40396376.0000; val_gene_expr_recon_loss: 405628.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151932720.0000; val_global_loss: 192920512.0000; val_optim_loss: 192920512.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.8271; val_auprc_score: 0.8215; val_best_acc_score: 0.6990; val_best_f1_score: 0.7562; train_kl_reg_loss: 199129.1806; train_edge_recon_loss: 35107689.7778; train_gene_expr_recon_loss: 419116.7535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152336469.3333; train_global_loss: 188062407.1111; train_optim_loss: 188062407.1111; val_kl_reg_loss: 185029.3438; val_edge_recon_loss: 40412580.0000; val_gene_expr_recon_loss: 405316.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151970272.0000; val_global_loss: 192973200.0000; val_optim_loss: 192973200.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.8255; val_auprc_score: 0.8195; val_best_acc_score: 0.6940; val_best_f1_score: 0.7532; train_kl_reg_loss: 198416.5156; train_edge_recon_loss: 35129861.3333; train_gene_expr_recon_loss: 420936.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152712444.4444; train_global_loss: 188461658.6667; train_optim_loss: 188461658.6667; val_kl_reg_loss: 184088.3125; val_edge_recon_loss: 40401544.0000; val_gene_expr_recon_loss: 405748.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152023808.0000; val_global_loss: 193015184.0000; val_optim_loss: 193015184.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.8292; val_auprc_score: 0.8238; val_best_acc_score: 0.6985; val_best_f1_score: 0.7558; train_kl_reg_loss: 197732.4427; train_edge_recon_loss: 35119944.8889; train_gene_expr_recon_loss: 422661.4861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152415568.0000; train_global_loss: 188155907.5556; train_optim_loss: 188155907.5556; val_kl_reg_loss: 184118.1562; val_edge_recon_loss: 40390144.0000; val_gene_expr_recon_loss: 405178.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151713648.0000; val_global_loss: 192693088.0000; val_optim_loss: 192693088.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.8277; val_auprc_score: 0.8205; val_best_acc_score: 0.6994; val_best_f1_score: 0.7565; train_kl_reg_loss: 200047.7639; train_edge_recon_loss: 35096972.0000; train_gene_expr_recon_loss: 420849.9653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152043952.0000; train_global_loss: 187761825.7778; train_optim_loss: 187761825.7778; val_kl_reg_loss: 185350.9062; val_edge_recon_loss: 40409244.0000; val_gene_expr_recon_loss: 405729.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151921408.0000; val_global_loss: 192921728.0000; val_optim_loss: 192921728.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.8247; val_auprc_score: 0.8181; val_best_acc_score: 0.6999; val_best_f1_score: 0.7568; train_kl_reg_loss: 200391.5417; train_edge_recon_loss: 35122499.1111; train_gene_expr_recon_loss: 420806.7257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152503512.8889; train_global_loss: 188247210.6667; train_optim_loss: 188247210.6667; val_kl_reg_loss: 184392.8125; val_edge_recon_loss: 40398944.0000; val_gene_expr_recon_loss: 405621.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151901504.0000; val_global_loss: 192890464.0000; val_optim_loss: 192890464.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.8308; val_auprc_score: 0.8226; val_best_acc_score: 0.7075; val_best_f1_score: 0.7614; train_kl_reg_loss: 201018.6736; train_edge_recon_loss: 35096445.3333; train_gene_expr_recon_loss: 419887.5451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152225086.2222; train_global_loss: 187942435.5556; train_optim_loss: 187942435.5556; val_kl_reg_loss: 185604.8750; val_edge_recon_loss: 40395892.0000; val_gene_expr_recon_loss: 405308.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152007424.0000; val_global_loss: 192994224.0000; val_optim_loss: 192994224.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.8281; val_auprc_score: 0.8202; val_best_acc_score: 0.6966; val_best_f1_score: 0.7547; train_kl_reg_loss: 200566.5017; train_edge_recon_loss: 35080410.2222; train_gene_expr_recon_loss: 426025.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152762746.6667; train_global_loss: 188469745.7778; train_optim_loss: 188469745.7778; val_kl_reg_loss: 187546.5000; val_edge_recon_loss: 40411148.0000; val_gene_expr_recon_loss: 405382.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152150720.0000; val_global_loss: 193154800.0000; val_optim_loss: 193154800.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.8266; val_auprc_score: 0.8226; val_best_acc_score: 0.6970; val_best_f1_score: 0.7550; train_kl_reg_loss: 200303.2483; train_edge_recon_loss: 35099360.8889; train_gene_expr_recon_loss: 420753.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152447175.1111; train_global_loss: 188167594.6667; train_optim_loss: 188167594.6667; val_kl_reg_loss: 184104.8125; val_edge_recon_loss: 40403744.0000; val_gene_expr_recon_loss: 404973.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151875168.0000; val_global_loss: 192867984.0000; val_optim_loss: 192867984.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.8257; val_auprc_score: 0.8190; val_best_acc_score: 0.6946; val_best_f1_score: 0.7536; train_kl_reg_loss: 200634.5885; train_edge_recon_loss: 35144840.0000; train_gene_expr_recon_loss: 422814.0521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152286101.3333; train_global_loss: 188054389.3333; train_optim_loss: 188054389.3333; val_kl_reg_loss: 184562.2812; val_edge_recon_loss: 40405576.0000; val_gene_expr_recon_loss: 405156.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151785760.0000; val_global_loss: 192781056.0000; val_optim_loss: 192781056.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.8297; val_auprc_score: 0.8237; val_best_acc_score: 0.6998; val_best_f1_score: 0.7567; train_kl_reg_loss: 198753.9670; train_edge_recon_loss: 35073970.2222; train_gene_expr_recon_loss: 424814.1597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152059123.5556; train_global_loss: 187756661.3333; train_optim_loss: 187756661.3333; val_kl_reg_loss: 185549.4688; val_edge_recon_loss: 40415612.0000; val_gene_expr_recon_loss: 405206.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151704800.0000; val_global_loss: 192711168.0000; val_optim_loss: 192711168.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.8231; val_auprc_score: 0.8159; val_best_acc_score: 0.6981; val_best_f1_score: 0.7556; train_kl_reg_loss: 200300.3611; train_edge_recon_loss: 35077983.5556; train_gene_expr_recon_loss: 416589.3958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151927242.6667; train_global_loss: 187622115.5556; train_optim_loss: 187622115.5556; val_kl_reg_loss: 187459.1250; val_edge_recon_loss: 40402000.0000; val_gene_expr_recon_loss: 405477.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152014016.0000; val_global_loss: 193008960.0000; val_optim_loss: 193008960.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 5 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.8249
val AUPRC score: 0.8158
val best accuracy score: 0.6951
val best F1 score: 0.7538
val target rna MSE score: 6.5327
val source rna MSE score: 6.5313
val target atac MSE score: 0.1201
val source atac MSE score: 0.0170
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
