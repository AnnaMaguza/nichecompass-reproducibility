[True]
Run timestamp: 10102023_124128_267.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_267']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6841; val_auprc_score: 0.6599; val_best_acc_score: 0.5019; val_best_f1_score: 0.6673; train_kl_reg_loss: 68399.0816; train_edge_recon_loss: 750083.0246; train_gene_expr_recon_loss: 23054936.7273; train_masked_gp_l1_reg_loss: 57519.0637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6061122.7917; train_chrom_access_recon_loss: 4906480.3864; train_global_loss: 34898541.0606; train_optim_loss: 34898541.0606; val_kl_reg_loss: 93060.5986; val_edge_recon_loss: 813033.7969; val_gene_expr_recon_loss: 21498724.7500; val_masked_gp_l1_reg_loss: 62781.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3366296.5000; val_chrom_access_recon_loss: 4745905.9375; val_global_loss: 30579803.2500; val_optim_loss: 30579803.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6894; val_auprc_score: 0.6801; val_best_acc_score: 0.5911; val_best_f1_score: 0.6941; train_kl_reg_loss: 91100.6596; train_edge_recon_loss: 746302.2453; train_gene_expr_recon_loss: 21230409.2727; train_masked_gp_l1_reg_loss: 63596.1059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1830762.9697; train_chrom_access_recon_loss: 4701283.9470; train_global_loss: 28663455.2424; train_optim_loss: 28663455.2424; val_kl_reg_loss: 85746.6758; val_edge_recon_loss: 811866.8672; val_gene_expr_recon_loss: 21016683.5000; val_masked_gp_l1_reg_loss: 63456.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 869628.4375; val_chrom_access_recon_loss: 4694094.6875; val_global_loss: 27541475.5000; val_optim_loss: 27541475.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7771; val_auprc_score: 0.7665; val_best_acc_score: 0.7053; val_best_f1_score: 0.7105; train_kl_reg_loss: 80883.3024; train_edge_recon_loss: 737319.1080; train_gene_expr_recon_loss: 21029987.8485; train_masked_gp_l1_reg_loss: 63585.8619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 561957.5724; train_chrom_access_recon_loss: 4676684.9091; train_global_loss: 27150418.6061; train_optim_loss: 27150418.6061; val_kl_reg_loss: 77533.7158; val_edge_recon_loss: 803524.1875; val_gene_expr_recon_loss: 21225646.7500; val_masked_gp_l1_reg_loss: 64122.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 364621.1562; val_chrom_access_recon_loss: 4754797.8750; val_global_loss: 27290245.7500; val_optim_loss: 27290245.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8061; val_auprc_score: 0.7797; val_best_acc_score: 0.7300; val_best_f1_score: 0.7512; train_kl_reg_loss: 72741.8119; train_edge_recon_loss: 727505.7604; train_gene_expr_recon_loss: 20866143.0909; train_masked_gp_l1_reg_loss: 64764.8645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 281359.9368; train_chrom_access_recon_loss: 4643234.8030; train_global_loss: 26655750.6667; train_optim_loss: 26655750.6667; val_kl_reg_loss: 68370.6553; val_edge_recon_loss: 779017.4062; val_gene_expr_recon_loss: 20946740.5000; val_masked_gp_l1_reg_loss: 65758.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 220092.7969; val_chrom_access_recon_loss: 4651906.3125; val_global_loss: 26731884.7500; val_optim_loss: 26731884.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8656; val_auprc_score: 0.8453; val_best_acc_score: 0.7912; val_best_f1_score: 0.7982; train_kl_reg_loss: 68305.4754; train_edge_recon_loss: 708770.3011; train_gene_expr_recon_loss: 20745554.0606; train_masked_gp_l1_reg_loss: 66824.2773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 190891.7931; train_chrom_access_recon_loss: 4618649.4091; train_global_loss: 26398995.1515; train_optim_loss: 26398995.1515; val_kl_reg_loss: 66175.8096; val_edge_recon_loss: 716167.9766; val_gene_expr_recon_loss: 20659610.2500; val_masked_gp_l1_reg_loss: 68080.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 170028.1094; val_chrom_access_recon_loss: 4654530.8750; val_global_loss: 26334592.7500; val_optim_loss: 26334592.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8761; val_auprc_score: 0.8463; val_best_acc_score: 0.8028; val_best_f1_score: 0.8166; train_kl_reg_loss: 70615.8817; train_edge_recon_loss: 671037.2718; train_gene_expr_recon_loss: 20615674.6061; train_masked_gp_l1_reg_loss: 69330.7415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160137.7569; train_chrom_access_recon_loss: 4594604.9545; train_global_loss: 26181401.1818; train_optim_loss: 26181401.1818; val_kl_reg_loss: 78785.1846; val_edge_recon_loss: 647836.3203; val_gene_expr_recon_loss: 20655261.0000; val_masked_gp_l1_reg_loss: 70735.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153263.1094; val_chrom_access_recon_loss: 4645038.1250; val_global_loss: 26250920.5000; val_optim_loss: 26250920.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8721; val_auprc_score: 0.8324; val_best_acc_score: 0.8028; val_best_f1_score: 0.8160; train_kl_reg_loss: 79359.9478; train_edge_recon_loss: 634259.7850; train_gene_expr_recon_loss: 20499854.1515; train_masked_gp_l1_reg_loss: 72064.8387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146497.7036; train_chrom_access_recon_loss: 4576206.1818; train_global_loss: 26008242.6667; train_optim_loss: 26008242.6667; val_kl_reg_loss: 82977.5244; val_edge_recon_loss: 640368.7422; val_gene_expr_recon_loss: 20615317.7500; val_masked_gp_l1_reg_loss: 73164.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141095.9219; val_chrom_access_recon_loss: 4627083.7500; val_global_loss: 26180008.0000; val_optim_loss: 26180008.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8915; val_auprc_score: 0.8529; val_best_acc_score: 0.8275; val_best_f1_score: 0.8402; train_kl_reg_loss: 80195.4315; train_edge_recon_loss: 622518.7112; train_gene_expr_recon_loss: 20373706.8788; train_masked_gp_l1_reg_loss: 74225.9113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137137.5194; train_chrom_access_recon_loss: 4553358.7500; train_global_loss: 25841143.2121; train_optim_loss: 25841143.2121; val_kl_reg_loss: 77618.0625; val_edge_recon_loss: 618881.8438; val_gene_expr_recon_loss: 20334980.2500; val_masked_gp_l1_reg_loss: 75342.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133122.6094; val_chrom_access_recon_loss: 4572810.1875; val_global_loss: 25812754.2500; val_optim_loss: 25812754.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8899; val_auprc_score: 0.8594; val_best_acc_score: 0.8243; val_best_f1_score: 0.8372; train_kl_reg_loss: 78680.0054; train_edge_recon_loss: 614290.7775; train_gene_expr_recon_loss: 20293930.7576; train_masked_gp_l1_reg_loss: 76223.5651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128404.8224; train_chrom_access_recon_loss: 4537388.4167; train_global_loss: 25728918.0303; train_optim_loss: 25728918.0303; val_kl_reg_loss: 76457.7109; val_edge_recon_loss: 623885.3516; val_gene_expr_recon_loss: 20380827.5000; val_masked_gp_l1_reg_loss: 77198.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124443.5391; val_chrom_access_recon_loss: 4556246.1875; val_global_loss: 25839058.2500; val_optim_loss: 25839058.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8953; val_auprc_score: 0.8602; val_best_acc_score: 0.8270; val_best_f1_score: 0.8414; train_kl_reg_loss: 77150.2199; train_edge_recon_loss: 610596.3826; train_gene_expr_recon_loss: 20198951.7576; train_masked_gp_l1_reg_loss: 77804.4366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120518.1765; train_chrom_access_recon_loss: 4518558.7500; train_global_loss: 25603579.5455; train_optim_loss: 25603579.5455; val_kl_reg_loss: 76786.7422; val_edge_recon_loss: 614667.5469; val_gene_expr_recon_loss: 20190415.0000; val_masked_gp_l1_reg_loss: 78529.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117780.8516; val_chrom_access_recon_loss: 4580760.8125; val_global_loss: 25658940.2500; val_optim_loss: 25658940.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9021; val_auprc_score: 0.8660; val_best_acc_score: 0.8377; val_best_f1_score: 0.8508; train_kl_reg_loss: 75297.5179; train_edge_recon_loss: 609630.9801; train_gene_expr_recon_loss: 20129558.2727; train_masked_gp_l1_reg_loss: 79126.2668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114874.3933; train_chrom_access_recon_loss: 4502694.6970; train_global_loss: 25511181.8788; train_optim_loss: 25511181.8788; val_kl_reg_loss: 72873.9766; val_edge_recon_loss: 611247.6875; val_gene_expr_recon_loss: 20059494.5000; val_masked_gp_l1_reg_loss: 79697.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112414.7344; val_chrom_access_recon_loss: 4521512.0000; val_global_loss: 25457240.5000; val_optim_loss: 25457240.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9113; val_auprc_score: 0.8848; val_best_acc_score: 0.8444; val_best_f1_score: 0.8553; train_kl_reg_loss: 73929.2584; train_edge_recon_loss: 607137.0511; train_gene_expr_recon_loss: 20055894.1515; train_masked_gp_l1_reg_loss: 80243.9252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110426.7209; train_chrom_access_recon_loss: 4483507.2803; train_global_loss: 25411138.3030; train_optim_loss: 25411138.3030; val_kl_reg_loss: 73457.6104; val_edge_recon_loss: 607634.1172; val_gene_expr_recon_loss: 19954841.7500; val_masked_gp_l1_reg_loss: 80708.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108469.1953; val_chrom_access_recon_loss: 4460675.5625; val_global_loss: 25285787.0000; val_optim_loss: 25285787.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9131; val_auprc_score: 0.8892; val_best_acc_score: 0.8461; val_best_f1_score: 0.8572; train_kl_reg_loss: 73095.9776; train_edge_recon_loss: 603211.3267; train_gene_expr_recon_loss: 20010160.9697; train_masked_gp_l1_reg_loss: 81346.5489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107259.5819; train_chrom_access_recon_loss: 4476123.8939; train_global_loss: 25351198.3333; train_optim_loss: 25351198.3333; val_kl_reg_loss: 70717.6621; val_edge_recon_loss: 605949.1484; val_gene_expr_recon_loss: 20012056.0000; val_masked_gp_l1_reg_loss: 81953.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105925.1094; val_chrom_access_recon_loss: 4509843.8125; val_global_loss: 25386446.5000; val_optim_loss: 25386446.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9063; val_auprc_score: 0.8804; val_best_acc_score: 0.8342; val_best_f1_score: 0.8478; train_kl_reg_loss: 71273.5473; train_edge_recon_loss: 603078.4100; train_gene_expr_recon_loss: 19934632.4545; train_masked_gp_l1_reg_loss: 82286.4848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105038.5064; train_chrom_access_recon_loss: 4455596.2273; train_global_loss: 25251905.6364; train_optim_loss: 25251905.6364; val_kl_reg_loss: 69770.0547; val_edge_recon_loss: 618645.9766; val_gene_expr_recon_loss: 19892607.2500; val_masked_gp_l1_reg_loss: 82823.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104109.4688; val_chrom_access_recon_loss: 4444400.3750; val_global_loss: 25212357.7500; val_optim_loss: 25212357.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9126; val_auprc_score: 0.8881; val_best_acc_score: 0.8471; val_best_f1_score: 0.8561; train_kl_reg_loss: 70710.9809; train_edge_recon_loss: 600437.4517; train_gene_expr_recon_loss: 19884717.4848; train_masked_gp_l1_reg_loss: 83244.6757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103525.8883; train_chrom_access_recon_loss: 4443456.4242; train_global_loss: 25186093.1515; train_optim_loss: 25186093.1515; val_kl_reg_loss: 71694.5225; val_edge_recon_loss: 606706.7266; val_gene_expr_recon_loss: 19939201.0000; val_masked_gp_l1_reg_loss: 83709.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104004.3438; val_chrom_access_recon_loss: 4462408.5000; val_global_loss: 25267724.7500; val_optim_loss: 25267724.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9167; val_auprc_score: 0.8980; val_best_acc_score: 0.8533; val_best_f1_score: 0.8626; train_kl_reg_loss: 69673.8084; train_edge_recon_loss: 600104.9962; train_gene_expr_recon_loss: 19814793.1515; train_masked_gp_l1_reg_loss: 84068.5283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103125.6317; train_chrom_access_recon_loss: 4430688.5568; train_global_loss: 25102454.6364; train_optim_loss: 25102454.6364; val_kl_reg_loss: 67322.4072; val_edge_recon_loss: 604262.7578; val_gene_expr_recon_loss: 19966857.2500; val_masked_gp_l1_reg_loss: 84510.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103737.4688; val_chrom_access_recon_loss: 4474059.1875; val_global_loss: 25300749.5000; val_optim_loss: 25300749.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9306; val_auprc_score: 0.9125; val_best_acc_score: 0.8665; val_best_f1_score: 0.8710; train_kl_reg_loss: 68688.2090; train_edge_recon_loss: 597920.2955; train_gene_expr_recon_loss: 19745251.7576; train_masked_gp_l1_reg_loss: 84792.3795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103273.8042; train_chrom_access_recon_loss: 4409998.8902; train_global_loss: 25009925.3636; train_optim_loss: 25009925.3636; val_kl_reg_loss: 68945.1025; val_edge_recon_loss: 600003.2812; val_gene_expr_recon_loss: 19992709.5000; val_masked_gp_l1_reg_loss: 85209.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103215.2812; val_chrom_access_recon_loss: 4461223.9375; val_global_loss: 25311307.7500; val_optim_loss: 25311307.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9242; val_auprc_score: 0.8970; val_best_acc_score: 0.8600; val_best_f1_score: 0.8695; train_kl_reg_loss: 68258.6270; train_edge_recon_loss: 596877.5663; train_gene_expr_recon_loss: 19700129.2424; train_masked_gp_l1_reg_loss: 85558.0278; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102901.5116; train_chrom_access_recon_loss: 4394866.2348; train_global_loss: 24948591.2424; train_optim_loss: 24948591.2424; val_kl_reg_loss: 70337.5010; val_edge_recon_loss: 602677.1250; val_gene_expr_recon_loss: 19656468.5000; val_masked_gp_l1_reg_loss: 85838.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102640.1875; val_chrom_access_recon_loss: 4413355.3750; val_global_loss: 24931316.5000; val_optim_loss: 24931316.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9214; val_auprc_score: 0.9031; val_best_acc_score: 0.8571; val_best_f1_score: 0.8644; train_kl_reg_loss: 67855.0705; train_edge_recon_loss: 593022.7604; train_gene_expr_recon_loss: 19656409.4545; train_masked_gp_l1_reg_loss: 86340.8582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102427.6525; train_chrom_access_recon_loss: 4383243.6288; train_global_loss: 24889299.5455; train_optim_loss: 24889299.5455; val_kl_reg_loss: 69788.6445; val_edge_recon_loss: 607280.0000; val_gene_expr_recon_loss: 19748879.7500; val_masked_gp_l1_reg_loss: 86812.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101637.7734; val_chrom_access_recon_loss: 4393743.3750; val_global_loss: 25008142.0000; val_optim_loss: 25008142.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9325; val_auprc_score: 0.9137; val_best_acc_score: 0.8686; val_best_f1_score: 0.8758; train_kl_reg_loss: 67115.7083; train_edge_recon_loss: 592161.7434; train_gene_expr_recon_loss: 19589210.8182; train_masked_gp_l1_reg_loss: 87233.9039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101521.4168; train_chrom_access_recon_loss: 4366337.2500; train_global_loss: 24803580.7576; train_optim_loss: 24803580.7576; val_kl_reg_loss: 67519.9092; val_edge_recon_loss: 595828.6797; val_gene_expr_recon_loss: 19674490.5000; val_masked_gp_l1_reg_loss: 87838.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101416.0625; val_chrom_access_recon_loss: 4426331.0000; val_global_loss: 24953423.5000; val_optim_loss: 24953423.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9288; val_auprc_score: 0.9035; val_best_acc_score: 0.8675; val_best_f1_score: 0.8765; train_kl_reg_loss: 66193.8897; train_edge_recon_loss: 592775.0966; train_gene_expr_recon_loss: 19549144.4545; train_masked_gp_l1_reg_loss: 88189.0884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101008.0806; train_chrom_access_recon_loss: 4351027.9962; train_global_loss: 24748338.6667; train_optim_loss: 24748338.6667; val_kl_reg_loss: 65914.5767; val_edge_recon_loss: 599801.7969; val_gene_expr_recon_loss: 19513157.5000; val_masked_gp_l1_reg_loss: 88826.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100962.0000; val_chrom_access_recon_loss: 4401331.4375; val_global_loss: 24769993.2500; val_optim_loss: 24769993.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9286; val_auprc_score: 0.9032; val_best_acc_score: 0.8670; val_best_f1_score: 0.8735; train_kl_reg_loss: 65493.2577; train_edge_recon_loss: 591782.7576; train_gene_expr_recon_loss: 19508606.6667; train_masked_gp_l1_reg_loss: 89134.5832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100110.5031; train_chrom_access_recon_loss: 4336289.0265; train_global_loss: 24691416.7273; train_optim_loss: 24691416.7273; val_kl_reg_loss: 63772.8745; val_edge_recon_loss: 598983.6797; val_gene_expr_recon_loss: 19540156.0000; val_masked_gp_l1_reg_loss: 89817.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100565.0781; val_chrom_access_recon_loss: 4376817.0625; val_global_loss: 24770113.5000; val_optim_loss: 24770113.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9301; val_auprc_score: 0.9089; val_best_acc_score: 0.8684; val_best_f1_score: 0.8766; train_kl_reg_loss: 65160.7255; train_edge_recon_loss: 588233.3153; train_gene_expr_recon_loss: 19443362.2424; train_masked_gp_l1_reg_loss: 90249.8774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99593.1508; train_chrom_access_recon_loss: 4317948.0038; train_global_loss: 24604547.3636; train_optim_loss: 24604547.3636; val_kl_reg_loss: 63157.4668; val_edge_recon_loss: 599211.6016; val_gene_expr_recon_loss: 19567427.0000; val_masked_gp_l1_reg_loss: 90779.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99572.8594; val_chrom_access_recon_loss: 4354981.7500; val_global_loss: 24775130.2500; val_optim_loss: 24775130.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9422; val_auprc_score: 0.9300; val_best_acc_score: 0.8788; val_best_f1_score: 0.8831; train_kl_reg_loss: 64228.9473; train_edge_recon_loss: 590841.3456; train_gene_expr_recon_loss: 19399107.3333; train_masked_gp_l1_reg_loss: 91271.0181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98943.0022; train_chrom_access_recon_loss: 4301151.1364; train_global_loss: 24545542.8485; train_optim_loss: 24545542.8485; val_kl_reg_loss: 64293.4346; val_edge_recon_loss: 592392.4375; val_gene_expr_recon_loss: 19457946.2500; val_masked_gp_l1_reg_loss: 91733.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98504.7578; val_chrom_access_recon_loss: 4349839.1875; val_global_loss: 24654709.2500; val_optim_loss: 24654709.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9363; val_auprc_score: 0.9155; val_best_acc_score: 0.8767; val_best_f1_score: 0.8825; train_kl_reg_loss: 63930.6604; train_edge_recon_loss: 587680.3419; train_gene_expr_recon_loss: 19364476.1212; train_masked_gp_l1_reg_loss: 92337.7715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98598.9071; train_chrom_access_recon_loss: 4285172.4848; train_global_loss: 24492196.2424; train_optim_loss: 24492196.2424; val_kl_reg_loss: 64706.0884; val_edge_recon_loss: 598075.2734; val_gene_expr_recon_loss: 19687076.0000; val_masked_gp_l1_reg_loss: 92956.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98915.3438; val_chrom_access_recon_loss: 4380352.5312; val_global_loss: 24922082.0000; val_optim_loss: 24922082.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8509; val_auprc_score: 0.8124; val_best_acc_score: 0.7509; val_best_f1_score: 0.7951; train_kl_reg_loss: 41851.1570; train_edge_recon_loss: 747944.8286; train_gene_expr_recon_loss: 18573517.0606; train_masked_gp_l1_reg_loss: 95695.6473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111588.4929; train_chrom_access_recon_loss: 4162355.0152; train_global_loss: 23732952.1818; train_optim_loss: 23732952.1818; val_kl_reg_loss: 17438.8518; val_edge_recon_loss: 797590.8828; val_gene_expr_recon_loss: 18156246.2500; val_masked_gp_l1_reg_loss: 99285.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129269.0703; val_chrom_access_recon_loss: 4067772.3125; val_global_loss: 23267604.5000; val_optim_loss: 23267604.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8392; val_auprc_score: 0.8031; val_best_acc_score: 0.7515; val_best_f1_score: 0.7923; train_kl_reg_loss: 20753.6046; train_edge_recon_loss: 751839.6241; train_gene_expr_recon_loss: 18122524.6970; train_masked_gp_l1_reg_loss: 97702.1992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131463.4266; train_chrom_access_recon_loss: 4062410.8371; train_global_loss: 23186694.2727; train_optim_loss: 23186694.2727; val_kl_reg_loss: 12659.2821; val_edge_recon_loss: 790011.6797; val_gene_expr_recon_loss: 18103002.7500; val_masked_gp_l1_reg_loss: 96820.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135908.5938; val_chrom_access_recon_loss: 4080493.2500; val_global_loss: 23218894.7500; val_optim_loss: 23218894.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8339; val_auprc_score: 0.8009; val_best_acc_score: 0.7389; val_best_f1_score: 0.7851; train_kl_reg_loss: 16408.3919; train_edge_recon_loss: 761081.9451; train_gene_expr_recon_loss: 18143410.5455; train_masked_gp_l1_reg_loss: 95630.2113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136600.4671; train_chrom_access_recon_loss: 4054650.7803; train_global_loss: 23207782.4848; train_optim_loss: 23207782.4848; val_kl_reg_loss: 13509.4968; val_edge_recon_loss: 793702.2734; val_gene_expr_recon_loss: 17971599.7500; val_masked_gp_l1_reg_loss: 94635.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137147.2188; val_chrom_access_recon_loss: 4071369.8750; val_global_loss: 23081965.2500; val_optim_loss: 23081965.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8264; val_auprc_score: 0.7873; val_best_acc_score: 0.7426; val_best_f1_score: 0.7831; train_kl_reg_loss: 14252.0383; train_edge_recon_loss: 760446.7301; train_gene_expr_recon_loss: 18020378.1212; train_masked_gp_l1_reg_loss: 92921.8176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135653.1302; train_chrom_access_recon_loss: 4047971.8144; train_global_loss: 23071623.7576; train_optim_loss: 23071623.7576; val_kl_reg_loss: 13179.7817; val_edge_recon_loss: 787682.4219; val_gene_expr_recon_loss: 17998658.2500; val_masked_gp_l1_reg_loss: 91948.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135095.0781; val_chrom_access_recon_loss: 4055451.3750; val_global_loss: 23082015.5000; val_optim_loss: 23082015.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8068; val_auprc_score: 0.7629; val_best_acc_score: 0.7337; val_best_f1_score: 0.7821; train_kl_reg_loss: 14638.7868; train_edge_recon_loss: 753418.0682; train_gene_expr_recon_loss: 17988603.8182; train_masked_gp_l1_reg_loss: 91584.5473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135961.0147; train_chrom_access_recon_loss: 4047003.1970; train_global_loss: 23031209.3636; train_optim_loss: 23031209.3636; val_kl_reg_loss: 10388.7264; val_edge_recon_loss: 778621.1328; val_gene_expr_recon_loss: 18169344.0000; val_masked_gp_l1_reg_loss: 91418.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137391.8750; val_chrom_access_recon_loss: 4064740.8438; val_global_loss: 23251904.5000; val_optim_loss: 23251904.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8323; val_auprc_score: 0.7950; val_best_acc_score: 0.7547; val_best_f1_score: 0.7868; train_kl_reg_loss: 13046.6416; train_edge_recon_loss: 762700.0919; train_gene_expr_recon_loss: 17945161.3333; train_masked_gp_l1_reg_loss: 89797.9263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136445.4747; train_chrom_access_recon_loss: 4028395.8485; train_global_loss: 22975547.3030; train_optim_loss: 22975547.3030; val_kl_reg_loss: 11946.9863; val_edge_recon_loss: 780008.4844; val_gene_expr_recon_loss: 18068188.5000; val_masked_gp_l1_reg_loss: 88493.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135716.2500; val_chrom_access_recon_loss: 4077497.6875; val_global_loss: 23161851.2500; val_optim_loss: 23161851.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8142; val_auprc_score: 0.7774; val_best_acc_score: 0.7421; val_best_f1_score: 0.7781; train_kl_reg_loss: 12119.5324; train_edge_recon_loss: 759033.2292; train_gene_expr_recon_loss: 18005617.6667; train_masked_gp_l1_reg_loss: 87776.4895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136201.9995; train_chrom_access_recon_loss: 4033383.0985; train_global_loss: 23034131.7576; train_optim_loss: 23034131.7576; val_kl_reg_loss: 8192.2880; val_edge_recon_loss: 768701.9297; val_gene_expr_recon_loss: 18168561.5000; val_masked_gp_l1_reg_loss: 88793.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140959.9062; val_chrom_access_recon_loss: 4051862.0938; val_global_loss: 23227072.2500; val_optim_loss: 23227072.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8189; val_auprc_score: 0.7792; val_best_acc_score: 0.7488; val_best_f1_score: 0.7849; train_kl_reg_loss: 12052.1144; train_edge_recon_loss: 739653.4972; train_gene_expr_recon_loss: 17912255.1818; train_masked_gp_l1_reg_loss: 88596.9416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126613.5256; train_chrom_access_recon_loss: 4023125.6591; train_global_loss: 22902296.8182; train_optim_loss: 22902296.8182; val_kl_reg_loss: 10827.8881; val_edge_recon_loss: 768401.6016; val_gene_expr_recon_loss: 18094875.5000; val_masked_gp_l1_reg_loss: 88377.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123096.0469; val_chrom_access_recon_loss: 4098798.7812; val_global_loss: 23184377.7500; val_optim_loss: 23184377.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8183; val_auprc_score: 0.7771; val_best_acc_score: 0.7464; val_best_f1_score: 0.7880; train_kl_reg_loss: 12427.0910; train_edge_recon_loss: 741987.0009; train_gene_expr_recon_loss: 17870502.1515; train_masked_gp_l1_reg_loss: 88243.0031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122046.2417; train_chrom_access_recon_loss: 4023299.0644; train_global_loss: 22858504.4545; train_optim_loss: 22858504.4545; val_kl_reg_loss: 11056.2126; val_edge_recon_loss: 770019.4531; val_gene_expr_recon_loss: 17745051.3750; val_masked_gp_l1_reg_loss: 88151.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121225.0547; val_chrom_access_recon_loss: 4014786.5938; val_global_loss: 22750292.0000; val_optim_loss: 22750292.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8149; val_auprc_score: 0.7713; val_best_acc_score: 0.7437; val_best_f1_score: 0.7805; train_kl_reg_loss: 13410.1697; train_edge_recon_loss: 737684.7074; train_gene_expr_recon_loss: 17851252.4848; train_masked_gp_l1_reg_loss: 87994.6566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120434.9286; train_chrom_access_recon_loss: 4022488.2121; train_global_loss: 22833265.1818; train_optim_loss: 22833265.1818; val_kl_reg_loss: 12364.1635; val_edge_recon_loss: 769892.9922; val_gene_expr_recon_loss: 17851836.7500; val_masked_gp_l1_reg_loss: 87848.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119734.0703; val_chrom_access_recon_loss: 4027534.1562; val_global_loss: 22869209.7500; val_optim_loss: 22869209.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8200; val_auprc_score: 0.7785; val_best_acc_score: 0.7423; val_best_f1_score: 0.7831; train_kl_reg_loss: 13797.2994; train_edge_recon_loss: 735079.0009; train_gene_expr_recon_loss: 17851810.1515; train_masked_gp_l1_reg_loss: 87693.4415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119175.4813; train_chrom_access_recon_loss: 4019938.7311; train_global_loss: 22827494.1515; train_optim_loss: 22827494.1515; val_kl_reg_loss: 11406.7980; val_edge_recon_loss: 768099.1172; val_gene_expr_recon_loss: 17859070.0000; val_masked_gp_l1_reg_loss: 87596.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118842.6172; val_chrom_access_recon_loss: 4041703.7188; val_global_loss: 22886718.0000; val_optim_loss: 22886718.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8258; val_auprc_score: 0.7833; val_best_acc_score: 0.7571; val_best_f1_score: 0.7913; train_kl_reg_loss: 13661.9274; train_edge_recon_loss: 737823.6562; train_gene_expr_recon_loss: 17826974.0909; train_masked_gp_l1_reg_loss: 87431.7595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118354.0902; train_chrom_access_recon_loss: 4017083.1856; train_global_loss: 22801328.4242; train_optim_loss: 22801328.4242; val_kl_reg_loss: 12571.5698; val_edge_recon_loss: 764903.0156; val_gene_expr_recon_loss: 17966785.2500; val_masked_gp_l1_reg_loss: 87223.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117842.0859; val_chrom_access_recon_loss: 4052248.4375; val_global_loss: 23001574.2500; val_optim_loss: 23001574.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8254; val_auprc_score: 0.7805; val_best_acc_score: 0.7574; val_best_f1_score: 0.7904; train_kl_reg_loss: 14369.5278; train_edge_recon_loss: 732801.7017; train_gene_expr_recon_loss: 17859647.3636; train_masked_gp_l1_reg_loss: 87045.4302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117330.6860; train_chrom_access_recon_loss: 4022760.0720; train_global_loss: 22833955.0000; train_optim_loss: 22833955.0000; val_kl_reg_loss: 12259.4733; val_edge_recon_loss: 763623.6953; val_gene_expr_recon_loss: 17717490.7500; val_masked_gp_l1_reg_loss: 86906.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116911.6328; val_chrom_access_recon_loss: 4039666.2500; val_global_loss: 22736858.7500; val_optim_loss: 22736858.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8310; val_auprc_score: 0.7886; val_best_acc_score: 0.7638; val_best_f1_score: 0.7940; train_kl_reg_loss: 14834.6082; train_edge_recon_loss: 731268.2121; train_gene_expr_recon_loss: 17823745.7121; train_masked_gp_l1_reg_loss: 86769.5965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116515.0330; train_chrom_access_recon_loss: 4018516.0568; train_global_loss: 22791649.1818; train_optim_loss: 22791649.1818; val_kl_reg_loss: 14180.1931; val_edge_recon_loss: 761928.0547; val_gene_expr_recon_loss: 17920696.7500; val_masked_gp_l1_reg_loss: 86601.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116098.4141; val_chrom_access_recon_loss: 4040308.6250; val_global_loss: 22939813.7500; val_optim_loss: 22939813.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8257; val_auprc_score: 0.7866; val_best_acc_score: 0.7534; val_best_f1_score: 0.7871; train_kl_reg_loss: 14520.0376; train_edge_recon_loss: 731828.4489; train_gene_expr_recon_loss: 17822722.1818; train_masked_gp_l1_reg_loss: 86477.8139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115850.6297; train_chrom_access_recon_loss: 4016777.3712; train_global_loss: 22788176.1818; train_optim_loss: 22788176.1818; val_kl_reg_loss: 12963.5781; val_edge_recon_loss: 764589.4531; val_gene_expr_recon_loss: 17932431.0000; val_masked_gp_l1_reg_loss: 86320.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115520.6094; val_chrom_access_recon_loss: 4049229.2500; val_global_loss: 22961053.2500; val_optim_loss: 22961053.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8465; val_auprc_score: 0.8067; val_best_acc_score: 0.7687; val_best_f1_score: 0.7986; train_kl_reg_loss: 14970.8890; train_edge_recon_loss: 730093.5227; train_gene_expr_recon_loss: 17848756.2121; train_masked_gp_l1_reg_loss: 86182.6246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115235.9948; train_chrom_access_recon_loss: 4021946.8409; train_global_loss: 22817185.9091; train_optim_loss: 22817185.9091; val_kl_reg_loss: 13751.2507; val_edge_recon_loss: 762741.3828; val_gene_expr_recon_loss: 17888165.7500; val_masked_gp_l1_reg_loss: 86039.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114946.0781; val_chrom_access_recon_loss: 4064751.9375; val_global_loss: 22930396.7500; val_optim_loss: 22930396.7500
