[True]
Run timestamp: 07092023_050358_267.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_267']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1131 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5649, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1131
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1131

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7710; val_auprc_score: 0.7871; val_best_acc_score: 0.5627; val_best_f1_score: 0.6925; train_kl_reg_loss: 82603.9311; train_edge_recon_loss: 3534072.1088; train_gene_expr_recon_loss: 16658957.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1137777.7963; train_chrom_access_recon_loss: 6620892.5573; train_global_loss: 28034304.2137; train_optim_loss: 28034304.2137; val_kl_reg_loss: 141339.6177; val_edge_recon_loss: 4061994.1833; val_gene_expr_recon_loss: 15767848.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 577693.0000; val_chrom_access_recon_loss: 6424726.6667; val_global_loss: 26973602.0000; val_optim_loss: 26973602.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8509; val_auprc_score: 0.8597; val_best_acc_score: 0.7359; val_best_f1_score: 0.7705; train_kl_reg_loss: 96997.4604; train_edge_recon_loss: 3518993.9847; train_gene_expr_recon_loss: 15508300.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 350266.2364; train_chrom_access_recon_loss: 6368038.6756; train_global_loss: 25842596.7176; train_optim_loss: 25842596.7176; val_kl_reg_loss: 97212.4578; val_edge_recon_loss: 4034978.4000; val_gene_expr_recon_loss: 15548004.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 208982.3281; val_chrom_access_recon_loss: 6348038.2000; val_global_loss: 26237215.6000; val_optim_loss: 26237215.6000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8759; val_auprc_score: 0.8694; val_best_acc_score: 0.7812; val_best_f1_score: 0.8023; train_kl_reg_loss: 73008.0430; train_edge_recon_loss: 3400534.2004; train_gene_expr_recon_loss: 15307430.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152792.2763; train_chrom_access_recon_loss: 6287331.4008; train_global_loss: 25221096.4580; train_optim_loss: 25221096.4580; val_kl_reg_loss: 87064.1552; val_edge_recon_loss: 3095510.1000; val_gene_expr_recon_loss: 15322282.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116042.2734; val_chrom_access_recon_loss: 6260242.8667; val_global_loss: 24881142.0000; val_optim_loss: 24881142.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9112; val_auprc_score: 0.8946; val_best_acc_score: 0.8309; val_best_f1_score: 0.8443; train_kl_reg_loss: 97404.2202; train_edge_recon_loss: 2939526.8168; train_gene_expr_recon_loss: 15122874.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94910.6588; train_chrom_access_recon_loss: 6216029.3855; train_global_loss: 24470746.0000; train_optim_loss: 24470746.0000; val_kl_reg_loss: 94887.7786; val_edge_recon_loss: 2875683.2500; val_gene_expr_recon_loss: 15114379.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78758.2188; val_chrom_access_recon_loss: 6208786.0667; val_global_loss: 24372494.5333; val_optim_loss: 24372494.5333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9229; val_auprc_score: 0.9039; val_best_acc_score: 0.8556; val_best_f1_score: 0.8631; train_kl_reg_loss: 96768.0862; train_edge_recon_loss: 2853707.9466; train_gene_expr_recon_loss: 14956348.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68818.1709; train_chrom_access_recon_loss: 6150411.9924; train_global_loss: 24126054.6412; train_optim_loss: 24126054.6412; val_kl_reg_loss: 95540.7510; val_edge_recon_loss: 2838628.1500; val_gene_expr_recon_loss: 15061476.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61049.3906; val_chrom_access_recon_loss: 6151988.7667; val_global_loss: 24208683.7333; val_optim_loss: 24208683.7333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9329; val_auprc_score: 0.9176; val_best_acc_score: 0.8686; val_best_f1_score: 0.8759; train_kl_reg_loss: 95584.1472; train_edge_recon_loss: 2808222.9828; train_gene_expr_recon_loss: 14828535.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55866.6303; train_chrom_access_recon_loss: 6098771.0229; train_global_loss: 23886979.8779; train_optim_loss: 23886979.8779; val_kl_reg_loss: 93855.6703; val_edge_recon_loss: 2818627.0667; val_gene_expr_recon_loss: 14900112.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52410.5938; val_chrom_access_recon_loss: 6100948.9333; val_global_loss: 23965954.6667; val_optim_loss: 23965954.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9428; val_auprc_score: 0.9295; val_best_acc_score: 0.8787; val_best_f1_score: 0.8853; train_kl_reg_loss: 91548.9929; train_edge_recon_loss: 2783075.5076; train_gene_expr_recon_loss: 14709872.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49609.3912; train_chrom_access_recon_loss: 6043944.5038; train_global_loss: 23678050.6260; train_optim_loss: 23678050.6260; val_kl_reg_loss: 87426.6740; val_edge_recon_loss: 2781493.3000; val_gene_expr_recon_loss: 14803230.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47637.0273; val_chrom_access_recon_loss: 6082528.9667; val_global_loss: 23802318.0000; val_optim_loss: 23802318.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9433; val_auprc_score: 0.9307; val_best_acc_score: 0.8809; val_best_f1_score: 0.8872; train_kl_reg_loss: 86792.0278; train_edge_recon_loss: 2786134.5057; train_gene_expr_recon_loss: 14610737.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46242.0618; train_chrom_access_recon_loss: 5996698.1336; train_global_loss: 23526604.1221; train_optim_loss: 23526604.1221; val_kl_reg_loss: 84816.3948; val_edge_recon_loss: 2783191.0667; val_gene_expr_recon_loss: 14660143.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44880.1094; val_chrom_access_recon_loss: 5978618.4667; val_global_loss: 23551649.6000; val_optim_loss: 23551649.6000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9474; val_auprc_score: 0.9343; val_best_acc_score: 0.8874; val_best_f1_score: 0.8922; train_kl_reg_loss: 83199.2239; train_edge_recon_loss: 2762800.8092; train_gene_expr_recon_loss: 14504284.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44351.4090; train_chrom_access_recon_loss: 5950181.4198; train_global_loss: 23344817.9084; train_optim_loss: 23344817.9084; val_kl_reg_loss: 85974.7917; val_edge_recon_loss: 2773975.6333; val_gene_expr_recon_loss: 14681361.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43686.4883; val_chrom_access_recon_loss: 5986149.8667; val_global_loss: 23571147.7333; val_optim_loss: 23571147.7333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9488; val_auprc_score: 0.9337; val_best_acc_score: 0.8855; val_best_f1_score: 0.8909; train_kl_reg_loss: 80205.8195; train_edge_recon_loss: 2744227.0687; train_gene_expr_recon_loss: 14445450.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43086.8445; train_chrom_access_recon_loss: 5918933.8817; train_global_loss: 23231904.4733; train_optim_loss: 23231904.4733; val_kl_reg_loss: 79852.1714; val_edge_recon_loss: 2740643.7000; val_gene_expr_recon_loss: 14583187.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42374.2812; val_chrom_access_recon_loss: 5937043.7667; val_global_loss: 23383100.9333; val_optim_loss: 23383100.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9542; val_auprc_score: 0.9384; val_best_acc_score: 0.8965; val_best_f1_score: 0.9009; train_kl_reg_loss: 77654.4455; train_edge_recon_loss: 2739176.7767; train_gene_expr_recon_loss: 14368810.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41990.1850; train_chrom_access_recon_loss: 5883781.3969; train_global_loss: 23111413.2366; train_optim_loss: 23111413.2366; val_kl_reg_loss: 74867.3240; val_edge_recon_loss: 2734002.1667; val_gene_expr_recon_loss: 14458980.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42113.2227; val_chrom_access_recon_loss: 5919639.1000; val_global_loss: 23229602.6667; val_optim_loss: 23229602.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9566; val_auprc_score: 0.9439; val_best_acc_score: 0.8991; val_best_f1_score: 0.9043; train_kl_reg_loss: 75055.6245; train_edge_recon_loss: 2727436.9447; train_gene_expr_recon_loss: 14305448.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41255.4539; train_chrom_access_recon_loss: 5850281.6183; train_global_loss: 22999478.4733; train_optim_loss: 22999478.4733; val_kl_reg_loss: 77291.3036; val_edge_recon_loss: 2710791.7833; val_gene_expr_recon_loss: 14435171.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40793.2422; val_chrom_access_recon_loss: 5921184.6667; val_global_loss: 23185233.3333; val_optim_loss: 23185233.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9602; val_auprc_score: 0.9490; val_best_acc_score: 0.9020; val_best_f1_score: 0.9067; train_kl_reg_loss: 74218.5908; train_edge_recon_loss: 2721156.2576; train_gene_expr_recon_loss: 14229842.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40547.4964; train_chrom_access_recon_loss: 5817827.4847; train_global_loss: 22883592.7328; train_optim_loss: 22883592.7328; val_kl_reg_loss: 73553.0922; val_edge_recon_loss: 2719556.8500; val_gene_expr_recon_loss: 14360209.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40167.0195; val_chrom_access_recon_loss: 5834719.4000; val_global_loss: 23028206.6667; val_optim_loss: 23028206.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9625; val_auprc_score: 0.9521; val_best_acc_score: 0.9081; val_best_f1_score: 0.9126; train_kl_reg_loss: 71515.4350; train_edge_recon_loss: 2711504.2576; train_gene_expr_recon_loss: 14178320.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40001.1071; train_chrom_access_recon_loss: 5791559.3664; train_global_loss: 22792900.1221; train_optim_loss: 22792900.1221; val_kl_reg_loss: 71406.2365; val_edge_recon_loss: 2699560.5500; val_gene_expr_recon_loss: 14265769.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39710.4062; val_chrom_access_recon_loss: 5788771.9333; val_global_loss: 22865217.8667; val_optim_loss: 22865217.8667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9666; val_auprc_score: 0.9568; val_best_acc_score: 0.9127; val_best_f1_score: 0.9165; train_kl_reg_loss: 70793.6338; train_edge_recon_loss: 2697486.2863; train_gene_expr_recon_loss: 14126638.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39548.7496; train_chrom_access_recon_loss: 5771380.6908; train_global_loss: 22705847.3588; train_optim_loss: 22705847.3588; val_kl_reg_loss: 71021.3323; val_edge_recon_loss: 2689287.7000; val_gene_expr_recon_loss: 14253982.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39497.1172; val_chrom_access_recon_loss: 5782378.7000; val_global_loss: 22836168.4000; val_optim_loss: 22836168.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9617; val_auprc_score: 0.9502; val_best_acc_score: 0.9065; val_best_f1_score: 0.9098; train_kl_reg_loss: 69294.4713; train_edge_recon_loss: 2695828.9733; train_gene_expr_recon_loss: 14078779.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39173.1089; train_chrom_access_recon_loss: 5745943.6336; train_global_loss: 22629019.2061; train_optim_loss: 22629019.2061; val_kl_reg_loss: 67496.8615; val_edge_recon_loss: 2710049.5000; val_gene_expr_recon_loss: 14163870.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39126.0195; val_chrom_access_recon_loss: 5762843.6667; val_global_loss: 22743386.2667; val_optim_loss: 22743386.2667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9704; val_auprc_score: 0.9632; val_best_acc_score: 0.9196; val_best_f1_score: 0.9227; train_kl_reg_loss: 67681.9631; train_edge_recon_loss: 2693402.4103; train_gene_expr_recon_loss: 14025573.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38935.1572; train_chrom_access_recon_loss: 5720030.8282; train_global_loss: 22545623.6489; train_optim_loss: 22545623.6489; val_kl_reg_loss: 69071.6620; val_edge_recon_loss: 2684478.0000; val_gene_expr_recon_loss: 14059228.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38587.6758; val_chrom_access_recon_loss: 5723065.6000; val_global_loss: 22574432.4000; val_optim_loss: 22574432.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9707; val_auprc_score: 0.9610; val_best_acc_score: 0.9196; val_best_f1_score: 0.9227; train_kl_reg_loss: 66869.6260; train_edge_recon_loss: 2692795.4885; train_gene_expr_recon_loss: 13987856.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38586.2074; train_chrom_access_recon_loss: 5700393.2977; train_global_loss: 22486501.1298; train_optim_loss: 22486501.1298; val_kl_reg_loss: 67115.8130; val_edge_recon_loss: 2688881.0167; val_gene_expr_recon_loss: 14111113.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38807.4570; val_chrom_access_recon_loss: 5732371.2000; val_global_loss: 22638288.6667; val_optim_loss: 22638288.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9683; val_auprc_score: 0.9589; val_best_acc_score: 0.9159; val_best_f1_score: 0.9197; train_kl_reg_loss: 65742.4159; train_edge_recon_loss: 2688268.0649; train_gene_expr_recon_loss: 13951937.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38563.4901; train_chrom_access_recon_loss: 5681507.9351; train_global_loss: 22426019.9542; train_optim_loss: 22426019.9542; val_kl_reg_loss: 64176.8531; val_edge_recon_loss: 2702689.8833; val_gene_expr_recon_loss: 14028180.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38520.3555; val_chrom_access_recon_loss: 5697277.8667; val_global_loss: 22530845.0667; val_optim_loss: 22530845.0667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9725; val_auprc_score: 0.9628; val_best_acc_score: 0.9256; val_best_f1_score: 0.9283; train_kl_reg_loss: 64916.9259; train_edge_recon_loss: 2680513.7672; train_gene_expr_recon_loss: 13923732.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38437.1037; train_chrom_access_recon_loss: 5666580.3359; train_global_loss: 22374180.3511; train_optim_loss: 22374180.3511; val_kl_reg_loss: 65262.3346; val_edge_recon_loss: 2680505.4333; val_gene_expr_recon_loss: 14068210.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38706.3242; val_chrom_access_recon_loss: 5706364.7333; val_global_loss: 22559049.6000; val_optim_loss: 22559049.6000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9714; val_auprc_score: 0.9616; val_best_acc_score: 0.9213; val_best_f1_score: 0.9238; train_kl_reg_loss: 63675.1659; train_edge_recon_loss: 2677086.7958; train_gene_expr_recon_loss: 13888378.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38396.4421; train_chrom_access_recon_loss: 5651601.7519; train_global_loss: 22319138.1985; train_optim_loss: 22319138.1985; val_kl_reg_loss: 63314.2724; val_edge_recon_loss: 2692325.5500; val_gene_expr_recon_loss: 13971876.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38757.1992; val_chrom_access_recon_loss: 5669722.5333; val_global_loss: 22435996.9333; val_optim_loss: 22435996.9333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9729; val_auprc_score: 0.9656; val_best_acc_score: 0.9254; val_best_f1_score: 0.9281; train_kl_reg_loss: 63066.8365; train_edge_recon_loss: 2671172.1718; train_gene_expr_recon_loss: 13848460.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38372.3658; train_chrom_access_recon_loss: 5627295.1947; train_global_loss: 22248367.3588; train_optim_loss: 22248367.3588; val_kl_reg_loss: 63713.1560; val_edge_recon_loss: 2699019.8667; val_gene_expr_recon_loss: 14026106.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38408.2461; val_chrom_access_recon_loss: 5716884.4000; val_global_loss: 22544131.4667; val_optim_loss: 22544131.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9775; val_auprc_score: 0.9721; val_best_acc_score: 0.9320; val_best_f1_score: 0.9344; train_kl_reg_loss: 62416.0240; train_edge_recon_loss: 2677629.4523; train_gene_expr_recon_loss: 13832054.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38326.1435; train_chrom_access_recon_loss: 5621267.2290; train_global_loss: 22231693.4809; train_optim_loss: 22231693.4809; val_kl_reg_loss: 61186.9292; val_edge_recon_loss: 2691025.8167; val_gene_expr_recon_loss: 13987516.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38466.7734; val_chrom_access_recon_loss: 5656115.0667; val_global_loss: 22434310.5333; val_optim_loss: 22434310.5333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9776; val_auprc_score: 0.9729; val_best_acc_score: 0.9290; val_best_f1_score: 0.9315; train_kl_reg_loss: 61157.3609; train_edge_recon_loss: 2668265.6126; train_gene_expr_recon_loss: 13786666.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38380.2138; train_chrom_access_recon_loss: 5595882.1985; train_global_loss: 22150351.7405; train_optim_loss: 22150351.7405; val_kl_reg_loss: 61522.5320; val_edge_recon_loss: 2692748.3333; val_gene_expr_recon_loss: 13930951.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38697.2773; val_chrom_access_recon_loss: 5673520.2667; val_global_loss: 22397439.8667; val_optim_loss: 22397439.8667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9776; val_auprc_score: 0.9730; val_best_acc_score: 0.9316; val_best_f1_score: 0.9333; train_kl_reg_loss: 61235.0038; train_edge_recon_loss: 2661712.1908; train_gene_expr_recon_loss: 13779157.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38615.4694; train_chrom_access_recon_loss: 5588652.1832; train_global_loss: 22129372.1069; train_optim_loss: 22129372.1069; val_kl_reg_loss: 61294.5685; val_edge_recon_loss: 2680761.2833; val_gene_expr_recon_loss: 13933872.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38769.4180; val_chrom_access_recon_loss: 5653313.0000; val_global_loss: 22368010.6667; val_optim_loss: 22368010.6667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9772; val_auprc_score: 0.9721; val_best_acc_score: 0.9344; val_best_f1_score: 0.9369; train_kl_reg_loss: 60829.8181; train_edge_recon_loss: 2680228.5592; train_gene_expr_recon_loss: 13569036.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34398.3629; train_chrom_access_recon_loss: 5539398.8702; train_global_loss: 21883892.1221; train_optim_loss: 21883892.1221; val_kl_reg_loss: 48606.5503; val_edge_recon_loss: 2701697.0000; val_gene_expr_recon_loss: 13709254.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33637.4727; val_chrom_access_recon_loss: 5555204.3000; val_global_loss: 22048400.0000; val_optim_loss: 22048400.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9815; val_auprc_score: 0.9783; val_best_acc_score: 0.9383; val_best_f1_score: 0.9398; train_kl_reg_loss: 59083.5003; train_edge_recon_loss: 2672449.1393; train_gene_expr_recon_loss: 13517017.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33714.0025; train_chrom_access_recon_loss: 5513517.4733; train_global_loss: 21795781.8931; train_optim_loss: 21795781.8931; val_kl_reg_loss: 47491.0323; val_edge_recon_loss: 2662175.5000; val_gene_expr_recon_loss: 13669849.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33724.6484; val_chrom_access_recon_loss: 5553427.7667; val_global_loss: 21966668.4000; val_optim_loss: 21966668.4000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9800; val_auprc_score: 0.9751; val_best_acc_score: 0.9368; val_best_f1_score: 0.9390; train_kl_reg_loss: 57412.3653; train_edge_recon_loss: 2668813.3817; train_gene_expr_recon_loss: 13495731.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33784.6258; train_chrom_access_recon_loss: 5503740.0305; train_global_loss: 21759481.5420; train_optim_loss: 21759481.5420; val_kl_reg_loss: 48242.4117; val_edge_recon_loss: 2673485.0000; val_gene_expr_recon_loss: 13654869.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33805.1914; val_chrom_access_recon_loss: 5534554.1667; val_global_loss: 21944956.4000; val_optim_loss: 21944956.4000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9790; val_auprc_score: 0.9729; val_best_acc_score: 0.9373; val_best_f1_score: 0.9395; train_kl_reg_loss: 55704.5091; train_edge_recon_loss: 2663994.1660; train_gene_expr_recon_loss: 13465786.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33899.1560; train_chrom_access_recon_loss: 5495400.4847; train_global_loss: 21714784.4427; train_optim_loss: 21714784.4427; val_kl_reg_loss: 49079.0151; val_edge_recon_loss: 2687392.2667; val_gene_expr_recon_loss: 13596476.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34149.1875; val_chrom_access_recon_loss: 5519769.8000; val_global_loss: 21886866.1333; val_optim_loss: 21886866.1333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9834; val_auprc_score: 0.9793; val_best_acc_score: 0.9468; val_best_f1_score: 0.9482; train_kl_reg_loss: 55415.4069; train_edge_recon_loss: 2667102.0019; train_gene_expr_recon_loss: 13430576.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34066.9744; train_chrom_access_recon_loss: 5484075.2710; train_global_loss: 21671236.6107; train_optim_loss: 21671236.6107; val_kl_reg_loss: 48867.2883; val_edge_recon_loss: 2653490.2167; val_gene_expr_recon_loss: 13581810.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34183.3867; val_chrom_access_recon_loss: 5533926.7000; val_global_loss: 21852277.4667; val_optim_loss: 21852277.4667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9809; val_auprc_score: 0.9749; val_best_acc_score: 0.9421; val_best_f1_score: 0.9434; train_kl_reg_loss: 54155.4770; train_edge_recon_loss: 2660421.8034; train_gene_expr_recon_loss: 13418901.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34168.2917; train_chrom_access_recon_loss: 5479743.1489; train_global_loss: 21647390.1832; train_optim_loss: 21647390.1832; val_kl_reg_loss: 49448.8875; val_edge_recon_loss: 2664596.1333; val_gene_expr_recon_loss: 13593859.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34310.8086; val_chrom_access_recon_loss: 5530694.6667; val_global_loss: 21872910.4000; val_optim_loss: 21872910.4000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9819; val_auprc_score: 0.9766; val_best_acc_score: 0.9433; val_best_f1_score: 0.9447; train_kl_reg_loss: 53197.9875; train_edge_recon_loss: 2652744.6718; train_gene_expr_recon_loss: 13388931.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34405.0830; train_chrom_access_recon_loss: 5464307.5534; train_global_loss: 21593586.9771; train_optim_loss: 21593586.9771; val_kl_reg_loss: 48770.6914; val_edge_recon_loss: 2663831.1833; val_gene_expr_recon_loss: 13541098.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34411.5117; val_chrom_access_recon_loss: 5510507.5667; val_global_loss: 21798620.0000; val_optim_loss: 21798620.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9821; val_auprc_score: 0.9756; val_best_acc_score: 0.9475; val_best_f1_score: 0.9487; train_kl_reg_loss: 51793.2823; train_edge_recon_loss: 2651558.8798; train_gene_expr_recon_loss: 13383368.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34432.6842; train_chrom_access_recon_loss: 5462538.7557; train_global_loss: 21583691.8321; train_optim_loss: 21583691.8321; val_kl_reg_loss: 46861.0594; val_edge_recon_loss: 2667761.6833; val_gene_expr_recon_loss: 13504999.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34360.4531; val_chrom_access_recon_loss: 5489719.3000; val_global_loss: 21743701.4667; val_optim_loss: 21743701.4667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9818; val_auprc_score: 0.9745; val_best_acc_score: 0.9466; val_best_f1_score: 0.9481; train_kl_reg_loss: 51335.6313; train_edge_recon_loss: 2656487.1489; train_gene_expr_recon_loss: 13367464.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34498.5104; train_chrom_access_recon_loss: 5452558.4046; train_global_loss: 21562344.5649; train_optim_loss: 21562344.5649; val_kl_reg_loss: 48444.5391; val_edge_recon_loss: 2672471.1833; val_gene_expr_recon_loss: 13530748.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34486.2656; val_chrom_access_recon_loss: 5505048.0000; val_global_loss: 21791198.1333; val_optim_loss: 21791198.1333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9841; val_auprc_score: 0.9799; val_best_acc_score: 0.9488; val_best_f1_score: 0.9500; train_kl_reg_loss: 50485.9624; train_edge_recon_loss: 2650301.2137; train_gene_expr_recon_loss: 13345978.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34629.1294; train_chrom_access_recon_loss: 5448928.9237; train_global_loss: 21530324.0611; train_optim_loss: 21530324.0611; val_kl_reg_loss: 47392.8729; val_edge_recon_loss: 2653613.0333; val_gene_expr_recon_loss: 13569066.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34580.0742; val_chrom_access_recon_loss: 5501111.5000; val_global_loss: 21805763.3333; val_optim_loss: 21805763.3333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9839; val_auprc_score: 0.9800; val_best_acc_score: 0.9496; val_best_f1_score: 0.9515; train_kl_reg_loss: 49838.8282; train_edge_recon_loss: 2650054.8168; train_gene_expr_recon_loss: 13335562.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34677.7377; train_chrom_access_recon_loss: 5443237.7595; train_global_loss: 21513371.6489; train_optim_loss: 21513371.6489; val_kl_reg_loss: 47255.7159; val_edge_recon_loss: 2663934.7500; val_gene_expr_recon_loss: 13512445.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34796.4023; val_chrom_access_recon_loss: 5486427.3000; val_global_loss: 21744859.3333; val_optim_loss: 21744859.3333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9837; val_auprc_score: 0.9769; val_best_acc_score: 0.9499; val_best_f1_score: 0.9514; train_kl_reg_loss: 49017.2093; train_edge_recon_loss: 2646813.1221; train_gene_expr_recon_loss: 13323919.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34803.7578; train_chrom_access_recon_loss: 5439561.7634; train_global_loss: 21494115.5573; train_optim_loss: 21494115.5573; val_kl_reg_loss: 47522.1430; val_edge_recon_loss: 2655114.5833; val_gene_expr_recon_loss: 13503177.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34890.8594; val_chrom_access_recon_loss: 5484592.2333; val_global_loss: 21725297.7333; val_optim_loss: 21725297.7333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9847; val_auprc_score: 0.9808; val_best_acc_score: 0.9510; val_best_f1_score: 0.9519; train_kl_reg_loss: 48656.4716; train_edge_recon_loss: 2651261.3073; train_gene_expr_recon_loss: 13318511.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34926.4662; train_chrom_access_recon_loss: 5434580.9313; train_global_loss: 21487936.9008; train_optim_loss: 21487936.9008; val_kl_reg_loss: 46337.6115; val_edge_recon_loss: 2657870.9000; val_gene_expr_recon_loss: 13527141.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34934.6836; val_chrom_access_recon_loss: 5468741.3333; val_global_loss: 21735026.1333; val_optim_loss: 21735026.1333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9845; val_auprc_score: 0.9756; val_best_acc_score: 0.9514; val_best_f1_score: 0.9523; train_kl_reg_loss: 48311.2090; train_edge_recon_loss: 2650429.5420; train_gene_expr_recon_loss: 13300972.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34959.8284; train_chrom_access_recon_loss: 5426855.5763; train_global_loss: 21461528.6718; train_optim_loss: 21461528.6718; val_kl_reg_loss: 43964.0971; val_edge_recon_loss: 2669301.1500; val_gene_expr_recon_loss: 13489989.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34909.9648; val_chrom_access_recon_loss: 5488781.9333; val_global_loss: 21726946.8000; val_optim_loss: 21726946.8000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9846; val_auprc_score: 0.9809; val_best_acc_score: 0.9488; val_best_f1_score: 0.9501; train_kl_reg_loss: 47663.4062; train_edge_recon_loss: 2642085.4466; train_gene_expr_recon_loss: 13287586.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34998.3995; train_chrom_access_recon_loss: 5422906.1679; train_global_loss: 21435239.8321; train_optim_loss: 21435239.8321; val_kl_reg_loss: 46873.5115; val_edge_recon_loss: 2658520.6500; val_gene_expr_recon_loss: 13456180.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34994.5898; val_chrom_access_recon_loss: 5469246.9000; val_global_loss: 21665816.6667; val_optim_loss: 21665816.6667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9872; val_auprc_score: 0.9820; val_best_acc_score: 0.9559; val_best_f1_score: 0.9566; train_kl_reg_loss: 47314.7703; train_edge_recon_loss: 2645419.5763; train_gene_expr_recon_loss: 13274000.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34994.4662; train_chrom_access_recon_loss: 5409281.5649; train_global_loss: 21411010.9618; train_optim_loss: 21411010.9618; val_kl_reg_loss: 44015.9846; val_edge_recon_loss: 2653558.0333; val_gene_expr_recon_loss: 13514858.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35111.8047; val_chrom_access_recon_loss: 5485329.4333; val_global_loss: 21732874.1333; val_optim_loss: 21732874.1333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9875; val_auprc_score: 0.9824; val_best_acc_score: 0.9537; val_best_f1_score: 0.9551; train_kl_reg_loss: 47143.0669; train_edge_recon_loss: 2643462.8263; train_gene_expr_recon_loss: 13263601.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35107.7463; train_chrom_access_recon_loss: 5406458.3511; train_global_loss: 21395772.9924; train_optim_loss: 21395772.9924; val_kl_reg_loss: 45074.4542; val_edge_recon_loss: 2655112.2167; val_gene_expr_recon_loss: 13448451.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35208.0078; val_chrom_access_recon_loss: 5447866.9667; val_global_loss: 21631713.7333; val_optim_loss: 21631713.7333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9878; val_auprc_score: 0.9823; val_best_acc_score: 0.9580; val_best_f1_score: 0.9590; train_kl_reg_loss: 46830.5724; train_edge_recon_loss: 2636798.0802; train_gene_expr_recon_loss: 13259875.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35172.5309; train_chrom_access_recon_loss: 5404358.7481; train_global_loss: 21383035.7252; train_optim_loss: 21383035.7252; val_kl_reg_loss: 44951.1049; val_edge_recon_loss: 2656398.4833; val_gene_expr_recon_loss: 13411682.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35227.0273; val_chrom_access_recon_loss: 5445244.0333; val_global_loss: 21593503.2000; val_optim_loss: 21593503.2000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9859; val_auprc_score: 0.9815; val_best_acc_score: 0.9554; val_best_f1_score: 0.9562; train_kl_reg_loss: 46535.8166; train_edge_recon_loss: 2640823.4943; train_gene_expr_recon_loss: 13257410.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35194.8497; train_chrom_access_recon_loss: 5402920.0573; train_global_loss: 21382884.5802; train_optim_loss: 21382884.5802; val_kl_reg_loss: 45257.2346; val_edge_recon_loss: 2644184.0000; val_gene_expr_recon_loss: 13414060.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35163.2188; val_chrom_access_recon_loss: 5445611.6333; val_global_loss: 21584276.6667; val_optim_loss: 21584276.6667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9890; val_auprc_score: 0.9861; val_best_acc_score: 0.9594; val_best_f1_score: 0.9601; train_kl_reg_loss: 45884.2370; train_edge_recon_loss: 2639469.3015; train_gene_expr_recon_loss: 13240079.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35278.3915; train_chrom_access_recon_loss: 5396964.6718; train_global_loss: 21357676.5038; train_optim_loss: 21357676.5038; val_kl_reg_loss: 44584.2672; val_edge_recon_loss: 2655918.2667; val_gene_expr_recon_loss: 13451374.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35352.0078; val_chrom_access_recon_loss: 5444161.6000; val_global_loss: 21631390.6667; val_optim_loss: 21631390.6667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9872; val_auprc_score: 0.9797; val_best_acc_score: 0.9559; val_best_f1_score: 0.9571; train_kl_reg_loss: 46015.4661; train_edge_recon_loss: 2637347.8989; train_gene_expr_recon_loss: 13226809.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35335.4164; train_chrom_access_recon_loss: 5388881.6107; train_global_loss: 21334389.3588; train_optim_loss: 21334389.3588; val_kl_reg_loss: 45093.7940; val_edge_recon_loss: 2653911.9833; val_gene_expr_recon_loss: 13462529.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35270.4180; val_chrom_access_recon_loss: 5452546.6667; val_global_loss: 21649351.7333; val_optim_loss: 21649351.7333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9885; val_auprc_score: 0.9853; val_best_acc_score: 0.9582; val_best_f1_score: 0.9589; train_kl_reg_loss: 46200.8768; train_edge_recon_loss: 2636906.3817; train_gene_expr_recon_loss: 13217544.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35332.7889; train_chrom_access_recon_loss: 5383035.0458; train_global_loss: 21319020.0000; train_optim_loss: 21319020.0000; val_kl_reg_loss: 44959.9380; val_edge_recon_loss: 2650715.1333; val_gene_expr_recon_loss: 13432232.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35382.2578; val_chrom_access_recon_loss: 5457681.1000; val_global_loss: 21620970.9333; val_optim_loss: 21620970.9333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9871; val_auprc_score: 0.9804; val_best_acc_score: 0.9566; val_best_f1_score: 0.9577; train_kl_reg_loss: 45785.1762; train_edge_recon_loss: 2639455.2863; train_gene_expr_recon_loss: 13202904.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35400.3548; train_chrom_access_recon_loss: 5379970.4427; train_global_loss: 21303515.2977; train_optim_loss: 21303515.2977; val_kl_reg_loss: 43878.1029; val_edge_recon_loss: 2643560.7667; val_gene_expr_recon_loss: 13409446.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35432.9766; val_chrom_access_recon_loss: 5452456.0667; val_global_loss: 21584774.1333; val_optim_loss: 21584774.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9862; val_auprc_score: 0.9797; val_best_acc_score: 0.9534; val_best_f1_score: 0.9547; train_kl_reg_loss: 46307.7677; train_edge_recon_loss: 2631271.7672; train_gene_expr_recon_loss: 13193161.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31753.2172; train_chrom_access_recon_loss: 5375907.6527; train_global_loss: 21278401.5115; train_optim_loss: 21278401.5115; val_kl_reg_loss: 45618.0826; val_edge_recon_loss: 2653602.9000; val_gene_expr_recon_loss: 13442708.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31158.6855; val_chrom_access_recon_loss: 5440550.0333; val_global_loss: 21613637.8667; val_optim_loss: 21613637.8667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9890; val_auprc_score: 0.9844; val_best_acc_score: 0.9580; val_best_f1_score: 0.9589; train_kl_reg_loss: 46771.2880; train_edge_recon_loss: 2630902.9466; train_gene_expr_recon_loss: 13174272.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30997.5369; train_chrom_access_recon_loss: 5371715.6374; train_global_loss: 21254659.6641; train_optim_loss: 21254659.6641; val_kl_reg_loss: 46116.6310; val_edge_recon_loss: 2653586.6000; val_gene_expr_recon_loss: 13413685.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30833.4043; val_chrom_access_recon_loss: 5431353.6333; val_global_loss: 21575575.2000; val_optim_loss: 21575575.2000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9893; val_auprc_score: 0.9853; val_best_acc_score: 0.9576; val_best_f1_score: 0.9582; train_kl_reg_loss: 47066.6559; train_edge_recon_loss: 2629430.2156; train_gene_expr_recon_loss: 13167857.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30723.1699; train_chrom_access_recon_loss: 5363991.0153; train_global_loss: 21239069.0076; train_optim_loss: 21239069.0076; val_kl_reg_loss: 46206.5875; val_edge_recon_loss: 2641493.8500; val_gene_expr_recon_loss: 13447090.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30624.3965; val_chrom_access_recon_loss: 5439888.3333; val_global_loss: 21605303.3333; val_optim_loss: 21605303.3333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9889; val_auprc_score: 0.9852; val_best_acc_score: 0.9590; val_best_f1_score: 0.9600; train_kl_reg_loss: 46885.8114; train_edge_recon_loss: 2634070.7786; train_gene_expr_recon_loss: 13169089.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30564.8651; train_chrom_access_recon_loss: 5364096.1107; train_global_loss: 21244707.5420; train_optim_loss: 21244707.5420; val_kl_reg_loss: 45822.1826; val_edge_recon_loss: 2632284.2500; val_gene_expr_recon_loss: 13439801.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30478.7109; val_chrom_access_recon_loss: 5463846.1667; val_global_loss: 21612233.2000; val_optim_loss: 21612233.2000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9904; val_auprc_score: 0.9880; val_best_acc_score: 0.9605; val_best_f1_score: 0.9613; train_kl_reg_loss: 47187.6178; train_edge_recon_loss: 2632564.2156; train_gene_expr_recon_loss: 13174280.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30426.9382; train_chrom_access_recon_loss: 5370490.1947; train_global_loss: 21254949.4809; train_optim_loss: 21254949.4809; val_kl_reg_loss: 46213.9867; val_edge_recon_loss: 2631599.6500; val_gene_expr_recon_loss: 13388972.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30351.5859; val_chrom_access_recon_loss: 5426110.5333; val_global_loss: 21523248.2667; val_optim_loss: 21523248.2667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9899; val_auprc_score: 0.9870; val_best_acc_score: 0.9613; val_best_f1_score: 0.9619; train_kl_reg_loss: 47285.4550; train_edge_recon_loss: 2628167.0630; train_gene_expr_recon_loss: 13168453.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30305.5903; train_chrom_access_recon_loss: 5366438.0534; train_global_loss: 21240650.0000; train_optim_loss: 21240650.0000; val_kl_reg_loss: 45869.3263; val_edge_recon_loss: 2638417.9167; val_gene_expr_recon_loss: 13428828.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30236.2969; val_chrom_access_recon_loss: 5434671.9000; val_global_loss: 21578023.8667; val_optim_loss: 21578023.8667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9887; val_auprc_score: 0.9813; val_best_acc_score: 0.9601; val_best_f1_score: 0.9607; train_kl_reg_loss: 47167.0319; train_edge_recon_loss: 2632500.7176; train_gene_expr_recon_loss: 13165357.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30170.9436; train_chrom_access_recon_loss: 5365589.4695; train_global_loss: 21240786.0611; train_optim_loss: 21240786.0611; val_kl_reg_loss: 45979.3539; val_edge_recon_loss: 2653475.4500; val_gene_expr_recon_loss: 13366945.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30109.4668; val_chrom_access_recon_loss: 5439463.3333; val_global_loss: 21535973.0667; val_optim_loss: 21535973.0667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9890; val_auprc_score: 0.9856; val_best_acc_score: 0.9578; val_best_f1_score: 0.9589; train_kl_reg_loss: 47069.0670; train_edge_recon_loss: 2632256.3798; train_gene_expr_recon_loss: 13172936.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30068.4548; train_chrom_access_recon_loss: 5368460.2557; train_global_loss: 21250791.0840; train_optim_loss: 21250791.0840; val_kl_reg_loss: 46469.1776; val_edge_recon_loss: 2651381.2833; val_gene_expr_recon_loss: 13351262.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30013.4160; val_chrom_access_recon_loss: 5445381.7000; val_global_loss: 21524508.4000; val_optim_loss: 21524508.4000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9904; val_auprc_score: 0.9872; val_best_acc_score: 0.9628; val_best_f1_score: 0.9636; train_kl_reg_loss: 46998.9690; train_edge_recon_loss: 2632030.1584; train_gene_expr_recon_loss: 13169902.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29988.0764; train_chrom_access_recon_loss: 5369433.3435; train_global_loss: 21248353.1145; train_optim_loss: 21248353.1145; val_kl_reg_loss: 45758.5148; val_edge_recon_loss: 2629999.2833; val_gene_expr_recon_loss: 13479059.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29927.7715; val_chrom_access_recon_loss: 5479413.6000; val_global_loss: 21664158.5333; val_optim_loss: 21664158.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9887; val_auprc_score: 0.9860; val_best_acc_score: 0.9585; val_best_f1_score: 0.9595; train_kl_reg_loss: 46684.5734; train_edge_recon_loss: 2627934.1336; train_gene_expr_recon_loss: 13157580.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29566.4470; train_chrom_access_recon_loss: 5365979.9122; train_global_loss: 21227745.4962; train_optim_loss: 21227745.4962; val_kl_reg_loss: 45991.9758; val_edge_recon_loss: 2635318.3167; val_gene_expr_recon_loss: 13403408.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29516.1680; val_chrom_access_recon_loss: 5432720.7000; val_global_loss: 21546955.4667; val_optim_loss: 21546955.4667
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9897; val_auprc_score: 0.9852; val_best_acc_score: 0.9621; val_best_f1_score: 0.9628; train_kl_reg_loss: 46861.8594; train_edge_recon_loss: 2631083.6985; train_gene_expr_recon_loss: 13149033.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29500.5716; train_chrom_access_recon_loss: 5360230.0305; train_global_loss: 21216709.8321; train_optim_loss: 21216709.8321; val_kl_reg_loss: 46052.8206; val_edge_recon_loss: 2648243.7333; val_gene_expr_recon_loss: 13395403.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29485.8125; val_chrom_access_recon_loss: 5431756.7667; val_global_loss: 21550942.4000; val_optim_loss: 21550942.4000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9904; val_auprc_score: 0.9879; val_best_acc_score: 0.9603; val_best_f1_score: 0.9614; train_kl_reg_loss: 47057.6009; train_edge_recon_loss: 2632346.8092; train_gene_expr_recon_loss: 13162806.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29474.1086; train_chrom_access_recon_loss: 5366540.5038; train_global_loss: 21238225.3893; train_optim_loss: 21238225.3893; val_kl_reg_loss: 46130.5151; val_edge_recon_loss: 2627336.6667; val_gene_expr_recon_loss: 13416128.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29461.5059; val_chrom_access_recon_loss: 5446677.7000; val_global_loss: 21565735.0667; val_optim_loss: 21565735.0667
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9878; val_auprc_score: 0.9817; val_best_acc_score: 0.9592; val_best_f1_score: 0.9605; train_kl_reg_loss: 47107.0630; train_edge_recon_loss: 2626259.6240; train_gene_expr_recon_loss: 13157876.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29451.7813; train_chrom_access_recon_loss: 5365553.4313; train_global_loss: 21226248.0153; train_optim_loss: 21226248.0153; val_kl_reg_loss: 46284.3380; val_edge_recon_loss: 2648434.1333; val_gene_expr_recon_loss: 13437170.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29441.5430; val_chrom_access_recon_loss: 5448855.2333; val_global_loss: 21610186.5333; val_optim_loss: 21610186.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 104 min 15 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9882
val AUPRC score: 0.9831
val best accuracy score: 0.9598
val best F1 score: 0.9605
val target rna MSE score: 0.7992
val source rna MSE score: 0.1614
val target atac MSE score: 0.5049
val source atac MSE score: 0.0793
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
