[True]
Run timestamp: 07082023_221434_156.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_156']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8700; val_auprc_score: 0.8771; val_best_acc_score: 0.6178; val_best_f1_score: 0.7207; train_kl_reg_loss: 81090.6617; train_edge_recon_loss: 3476083.9722; train_gene_expr_recon_loss: 1154676.9236; train_masked_gp_l1_reg_loss: 4623.8223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166907.0851; train_chrom_access_recon_loss: 625415.1771; train_global_loss: 5508797.7778; train_optim_loss: 5508797.7778; val_kl_reg_loss: 61640.6914; val_edge_recon_loss: 4057571.5000; val_gene_expr_recon_loss: 964694.1250; val_masked_gp_l1_reg_loss: 4228.4033; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161809.3594; val_chrom_access_recon_loss: 499560.4062; val_global_loss: 5749505.0000; val_optim_loss: 5749505.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8443; val_auprc_score: 0.8512; val_best_acc_score: 0.6547; val_best_f1_score: 0.7363; train_kl_reg_loss: 33383.2945; train_edge_recon_loss: 3479215.0556; train_gene_expr_recon_loss: 909999.0486; train_masked_gp_l1_reg_loss: 4133.4261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158480.4149; train_chrom_access_recon_loss: 482858.3472; train_global_loss: 5068069.6667; train_optim_loss: 5068069.6667; val_kl_reg_loss: 33475.6445; val_edge_recon_loss: 4053072.7500; val_gene_expr_recon_loss: 869225.8750; val_masked_gp_l1_reg_loss: 4064.0083; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154149.8125; val_chrom_access_recon_loss: 477676.2812; val_global_loss: 5591665.0000; val_optim_loss: 5591665.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8220; val_auprc_score: 0.8179; val_best_acc_score: 0.7296; val_best_f1_score: 0.7612; train_kl_reg_loss: 20108.0043; train_edge_recon_loss: 3479317.4444; train_gene_expr_recon_loss: 843461.5833; train_masked_gp_l1_reg_loss: 4084.3834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150297.0104; train_chrom_access_recon_loss: 468575.0556; train_global_loss: 4965843.5556; train_optim_loss: 4965843.5556; val_kl_reg_loss: 19899.4336; val_edge_recon_loss: 4029882.5000; val_gene_expr_recon_loss: 826567.0000; val_masked_gp_l1_reg_loss: 4129.3853; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145224.3281; val_chrom_access_recon_loss: 466465.4688; val_global_loss: 5492168.5000; val_optim_loss: 5492168.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8231; val_auprc_score: 0.8099; val_best_acc_score: 0.7184; val_best_f1_score: 0.7661; train_kl_reg_loss: 15676.8823; train_edge_recon_loss: 3472573.7778; train_gene_expr_recon_loss: 808332.4931; train_masked_gp_l1_reg_loss: 4156.0255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140760.8767; train_chrom_access_recon_loss: 460291.4688; train_global_loss: 4901791.3889; train_optim_loss: 4901791.3889; val_kl_reg_loss: 16234.5605; val_edge_recon_loss: 3944253.0000; val_gene_expr_recon_loss: 795906.3750; val_masked_gp_l1_reg_loss: 4181.1724; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134959.7500; val_chrom_access_recon_loss: 462172.3750; val_global_loss: 5357707.5000; val_optim_loss: 5357707.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8404; val_auprc_score: 0.8200; val_best_acc_score: 0.7627; val_best_f1_score: 0.7868; train_kl_reg_loss: 12317.9141; train_edge_recon_loss: 3430216.6389; train_gene_expr_recon_loss: 790506.0139; train_masked_gp_l1_reg_loss: 4192.6654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130099.5807; train_chrom_access_recon_loss: 457490.7535; train_global_loss: 4824823.6111; train_optim_loss: 4824823.6111; val_kl_reg_loss: 6881.2666; val_edge_recon_loss: 3435341.5000; val_gene_expr_recon_loss: 800575.1250; val_masked_gp_l1_reg_loss: 4204.2861; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123993.5547; val_chrom_access_recon_loss: 461013.2812; val_global_loss: 4832009.5000; val_optim_loss: 4832009.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8652; val_auprc_score: 0.8577; val_best_acc_score: 0.7626; val_best_f1_score: 0.7927; train_kl_reg_loss: 11141.4183; train_edge_recon_loss: 3092393.9722; train_gene_expr_recon_loss: 820261.9722; train_masked_gp_l1_reg_loss: 4202.5715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119224.2995; train_chrom_access_recon_loss: 458576.5764; train_global_loss: 4505800.7778; train_optim_loss: 4505800.7778; val_kl_reg_loss: 24047.4629; val_edge_recon_loss: 2910385.7500; val_gene_expr_recon_loss: 824964.9375; val_masked_gp_l1_reg_loss: 4220.4014; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113427.7812; val_chrom_access_recon_loss: 462862.1250; val_global_loss: 4339908.5000; val_optim_loss: 4339908.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8769; val_auprc_score: 0.8544; val_best_acc_score: 0.7956; val_best_f1_score: 0.8095; train_kl_reg_loss: 37428.5174; train_edge_recon_loss: 2876645.9722; train_gene_expr_recon_loss: 801398.4931; train_masked_gp_l1_reg_loss: 4247.7469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108976.9401; train_chrom_access_recon_loss: 458195.2778; train_global_loss: 4286892.9444; train_optim_loss: 4286892.9444; val_kl_reg_loss: 50532.3320; val_edge_recon_loss: 2877824.0000; val_gene_expr_recon_loss: 784804.3750; val_masked_gp_l1_reg_loss: 4268.5405; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103442.3125; val_chrom_access_recon_loss: 458084.2188; val_global_loss: 4278955.5000; val_optim_loss: 4278955.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8986; val_auprc_score: 0.8704; val_best_acc_score: 0.8304; val_best_f1_score: 0.8426; train_kl_reg_loss: 53349.4418; train_edge_recon_loss: 2813477.7778; train_gene_expr_recon_loss: 774513.8403; train_masked_gp_l1_reg_loss: 4314.3815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99054.2023; train_chrom_access_recon_loss: 454028.6250; train_global_loss: 4198738.3333; train_optim_loss: 4198738.3333; val_kl_reg_loss: 48742.5664; val_edge_recon_loss: 2793419.0000; val_gene_expr_recon_loss: 767284.2500; val_masked_gp_l1_reg_loss: 4380.6699; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93645.1562; val_chrom_access_recon_loss: 456214.2188; val_global_loss: 4163686.0000; val_optim_loss: 4163686.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9180; val_auprc_score: 0.8957; val_best_acc_score: 0.8525; val_best_f1_score: 0.8622; train_kl_reg_loss: 43919.4844; train_edge_recon_loss: 2762890.6111; train_gene_expr_recon_loss: 763321.7361; train_masked_gp_l1_reg_loss: 4415.4843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89516.6823; train_chrom_access_recon_loss: 452907.3819; train_global_loss: 4116971.3333; train_optim_loss: 4116971.3333; val_kl_reg_loss: 39495.5078; val_edge_recon_loss: 2760164.2500; val_gene_expr_recon_loss: 767279.2500; val_masked_gp_l1_reg_loss: 4437.4155; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84495.0078; val_chrom_access_recon_loss: 454608.7812; val_global_loss: 4110480.2500; val_optim_loss: 4110480.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9218; val_auprc_score: 0.8990; val_best_acc_score: 0.8607; val_best_f1_score: 0.8702; train_kl_reg_loss: 39814.6658; train_edge_recon_loss: 2756667.8889; train_gene_expr_recon_loss: 760252.5208; train_masked_gp_l1_reg_loss: 4446.9785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80774.4392; train_chrom_access_recon_loss: 450925.3056; train_global_loss: 4092881.8889; train_optim_loss: 4092881.8889; val_kl_reg_loss: 41189.9922; val_edge_recon_loss: 2758121.7500; val_gene_expr_recon_loss: 756456.6875; val_masked_gp_l1_reg_loss: 4450.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76282.4062; val_chrom_access_recon_loss: 452878.3750; val_global_loss: 4089380.0000; val_optim_loss: 4089380.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9338; val_auprc_score: 0.9145; val_best_acc_score: 0.8708; val_best_f1_score: 0.8791; train_kl_reg_loss: 42099.8316; train_edge_recon_loss: 2743405.2778; train_gene_expr_recon_loss: 746690.3681; train_masked_gp_l1_reg_loss: 4461.6104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72984.2318; train_chrom_access_recon_loss: 447871.7917; train_global_loss: 4057513.1944; train_optim_loss: 4057513.1944; val_kl_reg_loss: 43934.5156; val_edge_recon_loss: 2714409.7500; val_gene_expr_recon_loss: 751067.7500; val_masked_gp_l1_reg_loss: 4470.9331; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69026.3594; val_chrom_access_recon_loss: 451350.6250; val_global_loss: 4034260.0000; val_optim_loss: 4034260.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9374; val_auprc_score: 0.9185; val_best_acc_score: 0.8789; val_best_f1_score: 0.8856; train_kl_reg_loss: 43567.7348; train_edge_recon_loss: 2730807.4722; train_gene_expr_recon_loss: 746834.2986; train_masked_gp_l1_reg_loss: 4482.7062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66163.9544; train_chrom_access_recon_loss: 447042.4132; train_global_loss: 4038898.5278; train_optim_loss: 4038898.5278; val_kl_reg_loss: 43498.3828; val_edge_recon_loss: 2722120.2500; val_gene_expr_recon_loss: 740726.7500; val_masked_gp_l1_reg_loss: 4499.1162; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62738.4453; val_chrom_access_recon_loss: 449776.3750; val_global_loss: 4023359.5000; val_optim_loss: 4023359.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9345; val_auprc_score: 0.9130; val_best_acc_score: 0.8785; val_best_f1_score: 0.8858; train_kl_reg_loss: 42875.0859; train_edge_recon_loss: 2730687.0000; train_gene_expr_recon_loss: 733326.9861; train_masked_gp_l1_reg_loss: 4518.6642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60237.6762; train_chrom_access_recon_loss: 445895.5660; train_global_loss: 4017540.9722; train_optim_loss: 4017540.9722; val_kl_reg_loss: 42016.4414; val_edge_recon_loss: 2722939.7500; val_gene_expr_recon_loss: 734157.4375; val_masked_gp_l1_reg_loss: 4540.8818; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57224.4375; val_chrom_access_recon_loss: 448680.1875; val_global_loss: 4009559.5000; val_optim_loss: 4009559.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9407; val_auprc_score: 0.9228; val_best_acc_score: 0.8833; val_best_f1_score: 0.8894; train_kl_reg_loss: 41231.4440; train_edge_recon_loss: 2723036.2778; train_gene_expr_recon_loss: 730323.9375; train_masked_gp_l1_reg_loss: 4561.4029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55019.2005; train_chrom_access_recon_loss: 446050.9167; train_global_loss: 4000223.2222; train_optim_loss: 4000223.2222; val_kl_reg_loss: 41479.5234; val_edge_recon_loss: 2741196.7500; val_gene_expr_recon_loss: 729029.5000; val_masked_gp_l1_reg_loss: 4587.0693; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52374.6094; val_chrom_access_recon_loss: 447399.9062; val_global_loss: 4016067.2500; val_optim_loss: 4016067.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9454; val_auprc_score: 0.9274; val_best_acc_score: 0.8902; val_best_f1_score: 0.8962; train_kl_reg_loss: 40328.5412; train_edge_recon_loss: 2715880.6389; train_gene_expr_recon_loss: 721042.4306; train_masked_gp_l1_reg_loss: 4606.3474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50438.0260; train_chrom_access_recon_loss: 444582.6736; train_global_loss: 3976878.6389; train_optim_loss: 3976878.6389; val_kl_reg_loss: 39260.3438; val_edge_recon_loss: 2708977.2500; val_gene_expr_recon_loss: 725172.5000; val_masked_gp_l1_reg_loss: 4625.1938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48106.2109; val_chrom_access_recon_loss: 446857.4688; val_global_loss: 3972999.0000; val_optim_loss: 3972999.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9482; val_auprc_score: 0.9294; val_best_acc_score: 0.8888; val_best_f1_score: 0.8950; train_kl_reg_loss: 39131.1567; train_edge_recon_loss: 2726013.8333; train_gene_expr_recon_loss: 721573.5833; train_masked_gp_l1_reg_loss: 4642.1905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46407.0690; train_chrom_access_recon_loss: 443322.0382; train_global_loss: 3981089.8333; train_optim_loss: 3981089.8333; val_kl_reg_loss: 38433.9062; val_edge_recon_loss: 2728541.2500; val_gene_expr_recon_loss: 722110.4375; val_masked_gp_l1_reg_loss: 4658.7749; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44360.3906; val_chrom_access_recon_loss: 446050.0625; val_global_loss: 3984155.0000; val_optim_loss: 3984155.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9495; val_auprc_score: 0.9340; val_best_acc_score: 0.8901; val_best_f1_score: 0.8963; train_kl_reg_loss: 38512.4961; train_edge_recon_loss: 2721980.1111; train_gene_expr_recon_loss: 716524.0278; train_masked_gp_l1_reg_loss: 4682.4410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42863.0282; train_chrom_access_recon_loss: 442622.4028; train_global_loss: 3967184.5000; train_optim_loss: 3967184.5000; val_kl_reg_loss: 38608.4258; val_edge_recon_loss: 2745570.2500; val_gene_expr_recon_loss: 718790.1250; val_masked_gp_l1_reg_loss: 4705.0518; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41058.7422; val_chrom_access_recon_loss: 444937.4062; val_global_loss: 3993670.2500; val_optim_loss: 3993670.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9603; val_auprc_score: 0.9497; val_best_acc_score: 0.9058; val_best_f1_score: 0.9092; train_kl_reg_loss: 37570.6957; train_edge_recon_loss: 2712849.5278; train_gene_expr_recon_loss: 713516.0764; train_masked_gp_l1_reg_loss: 4729.7700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39727.0200; train_chrom_access_recon_loss: 440223.7188; train_global_loss: 3948616.8056; train_optim_loss: 3948616.8056; val_kl_reg_loss: 37067.2188; val_edge_recon_loss: 2691508.0000; val_gene_expr_recon_loss: 715945.1250; val_masked_gp_l1_reg_loss: 4752.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38112.7031; val_chrom_access_recon_loss: 444948.0000; val_global_loss: 3932333.7500; val_optim_loss: 3932333.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9576; val_auprc_score: 0.9386; val_best_acc_score: 0.9049; val_best_f1_score: 0.9082; train_kl_reg_loss: 37693.2240; train_edge_recon_loss: 2713994.9167; train_gene_expr_recon_loss: 711043.7847; train_masked_gp_l1_reg_loss: 4772.4625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36927.4262; train_chrom_access_recon_loss: 438960.3715; train_global_loss: 3943392.0556; train_optim_loss: 3943392.0556; val_kl_reg_loss: 36996.2266; val_edge_recon_loss: 2718072.5000; val_gene_expr_recon_loss: 714148.6250; val_masked_gp_l1_reg_loss: 4793.0088; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35489.9609; val_chrom_access_recon_loss: 444075.5000; val_global_loss: 3953576.0000; val_optim_loss: 3953576.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9614; val_auprc_score: 0.9452; val_best_acc_score: 0.9104; val_best_f1_score: 0.9154; train_kl_reg_loss: 36894.7882; train_edge_recon_loss: 2699487.9722; train_gene_expr_recon_loss: 707910.9653; train_masked_gp_l1_reg_loss: 4816.9607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34437.8355; train_chrom_access_recon_loss: 438944.0069; train_global_loss: 3922492.5278; train_optim_loss: 3922492.5278; val_kl_reg_loss: 36511.9922; val_edge_recon_loss: 2694514.0000; val_gene_expr_recon_loss: 709835.8750; val_masked_gp_l1_reg_loss: 4839.7666; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33163.3008; val_chrom_access_recon_loss: 442932.1875; val_global_loss: 3921797.2500; val_optim_loss: 3921797.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9630; val_auprc_score: 0.9518; val_best_acc_score: 0.9108; val_best_f1_score: 0.9145; train_kl_reg_loss: 36521.8381; train_edge_recon_loss: 2690230.3056; train_gene_expr_recon_loss: 702707.0000; train_masked_gp_l1_reg_loss: 4866.1779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32225.8628; train_chrom_access_recon_loss: 439304.2604; train_global_loss: 3905855.5278; train_optim_loss: 3905855.5278; val_kl_reg_loss: 35738.2969; val_edge_recon_loss: 2713606.2500; val_gene_expr_recon_loss: 708481.0000; val_masked_gp_l1_reg_loss: 4892.9136; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31090.7910; val_chrom_access_recon_loss: 442199.7500; val_global_loss: 3936009.0000; val_optim_loss: 3936009.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9656; val_auprc_score: 0.9498; val_best_acc_score: 0.9158; val_best_f1_score: 0.9194; train_kl_reg_loss: 36338.1315; train_edge_recon_loss: 2683286.6944; train_gene_expr_recon_loss: 705781.6181; train_masked_gp_l1_reg_loss: 4918.3715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30258.5278; train_chrom_access_recon_loss: 440984.5764; train_global_loss: 3901567.8611; train_optim_loss: 3901567.8611; val_kl_reg_loss: 36747.1016; val_edge_recon_loss: 2665898.7500; val_gene_expr_recon_loss: 705115.1250; val_masked_gp_l1_reg_loss: 4947.6982; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29246.3555; val_chrom_access_recon_loss: 441952.1562; val_global_loss: 3883907.2500; val_optim_loss: 3883907.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9646; val_auprc_score: 0.9507; val_best_acc_score: 0.9162; val_best_f1_score: 0.9199; train_kl_reg_loss: 38613.1367; train_edge_recon_loss: 2681884.9444; train_gene_expr_recon_loss: 696824.8403; train_masked_gp_l1_reg_loss: 4977.5528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28496.3570; train_chrom_access_recon_loss: 437494.3611; train_global_loss: 3888291.1667; train_optim_loss: 3888291.1667; val_kl_reg_loss: 38796.0938; val_edge_recon_loss: 2689583.5000; val_gene_expr_recon_loss: 702287.7500; val_masked_gp_l1_reg_loss: 4998.7510; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27583.2656; val_chrom_access_recon_loss: 441112.8750; val_global_loss: 3904362.0000; val_optim_loss: 3904362.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9704; val_auprc_score: 0.9591; val_best_acc_score: 0.9248; val_best_f1_score: 0.9265; train_kl_reg_loss: 40387.3715; train_edge_recon_loss: 2676699.3611; train_gene_expr_recon_loss: 695347.8056; train_masked_gp_l1_reg_loss: 5016.9153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26893.1430; train_chrom_access_recon_loss: 435824.2535; train_global_loss: 3880168.8889; train_optim_loss: 3880168.8889; val_kl_reg_loss: 39709.1211; val_edge_recon_loss: 2661603.0000; val_gene_expr_recon_loss: 700893.6250; val_masked_gp_l1_reg_loss: 5037.8779; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26046.9258; val_chrom_access_recon_loss: 440305.3125; val_global_loss: 3873595.7500; val_optim_loss: 3873595.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9658; val_auprc_score: 0.9538; val_best_acc_score: 0.9155; val_best_f1_score: 0.9182; train_kl_reg_loss: 39962.0655; train_edge_recon_loss: 2685867.8333; train_gene_expr_recon_loss: 694274.6806; train_masked_gp_l1_reg_loss: 5063.0759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25419.5935; train_chrom_access_recon_loss: 436944.0069; train_global_loss: 3887531.3056; train_optim_loss: 3887531.3056; val_kl_reg_loss: 39321.4297; val_edge_recon_loss: 2696319.2500; val_gene_expr_recon_loss: 697010.1250; val_masked_gp_l1_reg_loss: 5082.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24653.0664; val_chrom_access_recon_loss: 439313.7188; val_global_loss: 3901700.5000; val_optim_loss: 3901700.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9680; val_auprc_score: 0.9545; val_best_acc_score: 0.9225; val_best_f1_score: 0.9247; train_kl_reg_loss: 38473.6992; train_edge_recon_loss: 2676100.4167; train_gene_expr_recon_loss: 951697.6944; train_masked_gp_l1_reg_loss: 5108.2785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23791.0779; train_chrom_access_recon_loss: 462340.9514; train_global_loss: 4157512.1944; train_optim_loss: 4157512.1944; val_kl_reg_loss: 13689.3398; val_edge_recon_loss: 2695331.7500; val_gene_expr_recon_loss: 968941.8750; val_masked_gp_l1_reg_loss: 5132.7598; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22548.6836; val_chrom_access_recon_loss: 467138.0938; val_global_loss: 4172782.5000; val_optim_loss: 4172782.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9733; val_auprc_score: 0.9644; val_best_acc_score: 0.9290; val_best_f1_score: 0.9314; train_kl_reg_loss: 34421.4151; train_edge_recon_loss: 2674122.9722; train_gene_expr_recon_loss: 953417.7708; train_masked_gp_l1_reg_loss: 5146.6000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21461.7439; train_chrom_access_recon_loss: 462803.2986; train_global_loss: 4151373.8333; train_optim_loss: 4151373.8333; val_kl_reg_loss: 13323.5703; val_edge_recon_loss: 2679621.2500; val_gene_expr_recon_loss: 955471.2500; val_masked_gp_l1_reg_loss: 5166.2749; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20111.4980; val_chrom_access_recon_loss: 465776.3750; val_global_loss: 4139470.0000; val_optim_loss: 4139470.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9729; val_auprc_score: 0.9616; val_best_acc_score: 0.9274; val_best_f1_score: 0.9296; train_kl_reg_loss: 30865.4158; train_edge_recon_loss: 2669320.9722; train_gene_expr_recon_loss: 946358.2639; train_masked_gp_l1_reg_loss: 5186.9952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19088.2541; train_chrom_access_recon_loss: 462672.2708; train_global_loss: 4133492.1111; train_optim_loss: 4133492.1111; val_kl_reg_loss: 12577.2725; val_edge_recon_loss: 2679799.2500; val_gene_expr_recon_loss: 948704.5625; val_masked_gp_l1_reg_loss: 5212.9238; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17856.3203; val_chrom_access_recon_loss: 464962.8438; val_global_loss: 4129113.0000; val_optim_loss: 4129113.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9686; val_auprc_score: 0.9531; val_best_acc_score: 0.9221; val_best_f1_score: 0.9241; train_kl_reg_loss: 29184.6016; train_edge_recon_loss: 2661283.9167; train_gene_expr_recon_loss: 941355.2083; train_masked_gp_l1_reg_loss: 5205.3983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17656.5488; train_chrom_access_recon_loss: 459323.3472; train_global_loss: 4114009.0278; train_optim_loss: 4114009.0278; val_kl_reg_loss: 12739.6191; val_edge_recon_loss: 2685466.5000; val_gene_expr_recon_loss: 948001.3750; val_masked_gp_l1_reg_loss: 5196.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17438.2070; val_chrom_access_recon_loss: 464706.0000; val_global_loss: 4133548.0000; val_optim_loss: 4133548.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9704; val_auprc_score: 0.9608; val_best_acc_score: 0.9237; val_best_f1_score: 0.9263; train_kl_reg_loss: 29111.4306; train_edge_recon_loss: 2659101.8611; train_gene_expr_recon_loss: 940926.1389; train_masked_gp_l1_reg_loss: 5193.3070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17305.6352; train_chrom_access_recon_loss: 460108.3993; train_global_loss: 4111746.9722; train_optim_loss: 4111746.9722; val_kl_reg_loss: 12719.4961; val_edge_recon_loss: 2677401.2500; val_gene_expr_recon_loss: 946895.7500; val_masked_gp_l1_reg_loss: 5189.5059; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17134.9199; val_chrom_access_recon_loss: 464651.6250; val_global_loss: 4123992.5000; val_optim_loss: 4123992.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9716; val_auprc_score: 0.9578; val_best_acc_score: 0.9262; val_best_f1_score: 0.9288; train_kl_reg_loss: 28858.5868; train_edge_recon_loss: 2658445.8889; train_gene_expr_recon_loss: 939306.2083; train_masked_gp_l1_reg_loss: 5187.4113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17013.0163; train_chrom_access_recon_loss: 460808.7639; train_global_loss: 4109619.9167; train_optim_loss: 4109619.9167; val_kl_reg_loss: 12759.2266; val_edge_recon_loss: 2672690.5000; val_gene_expr_recon_loss: 947233.9375; val_masked_gp_l1_reg_loss: 5185.3716; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16864.6152; val_chrom_access_recon_loss: 464652.4375; val_global_loss: 4119386.0000; val_optim_loss: 4119386.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9701; val_auprc_score: 0.9585; val_best_acc_score: 0.9248; val_best_f1_score: 0.9276; train_kl_reg_loss: 28600.2148; train_edge_recon_loss: 2654177.1111; train_gene_expr_recon_loss: 938132.2847; train_masked_gp_l1_reg_loss: 5184.7323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16754.8398; train_chrom_access_recon_loss: 459104.3472; train_global_loss: 4101953.5556; train_optim_loss: 4101953.5556; val_kl_reg_loss: 12839.2715; val_edge_recon_loss: 2678353.5000; val_gene_expr_recon_loss: 946687.6250; val_masked_gp_l1_reg_loss: 5184.3613; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16625.7461; val_chrom_access_recon_loss: 464678.7500; val_global_loss: 4124369.2500; val_optim_loss: 4124369.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 24 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9675
val AUPRC score: 0.9516
val best accuracy score: 0.9217
val best F1 score: 0.9241
val target rna MSE score: 4.0985
val source rna MSE score: 3.3171
val target atac MSE score: 0.1379
val source atac MSE score: 0.0223
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
