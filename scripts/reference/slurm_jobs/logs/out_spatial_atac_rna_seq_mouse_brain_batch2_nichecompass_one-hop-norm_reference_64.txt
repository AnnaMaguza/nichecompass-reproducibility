[True]
Run timestamp: 24072023_170452_64.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_64']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9297; val_auprc_score: 0.9372; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 165616.4204; train_edge_recon_loss: 34688685.7778; train_gene_expr_recon_loss: 3418457.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1186681.8750; train_global_loss: 39459443.1111; train_optim_loss: 39459443.1111; val_kl_reg_loss: 78436.6250; val_edge_recon_loss: 40653404.0000; val_gene_expr_recon_loss: 3092630.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1089644.7500; val_global_loss: 44914116.0000; val_optim_loss: 44914116.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9300; val_auprc_score: 0.9377; val_best_acc_score: 0.5057; val_best_f1_score: 0.6692; train_kl_reg_loss: 90453.1593; train_edge_recon_loss: 34751875.5556; train_gene_expr_recon_loss: 3198090.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1159491.0972; train_global_loss: 39199909.7778; train_optim_loss: 39199909.7778; val_kl_reg_loss: 28885.7012; val_edge_recon_loss: 40640892.0000; val_gene_expr_recon_loss: 2997614.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1081563.6250; val_global_loss: 44748956.0000; val_optim_loss: 44748956.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9265; val_auprc_score: 0.9353; val_best_acc_score: 0.5194; val_best_f1_score: 0.6752; train_kl_reg_loss: 28785.2467; train_edge_recon_loss: 34733623.1111; train_gene_expr_recon_loss: 2959583.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1086943.8750; train_global_loss: 38808935.5556; train_optim_loss: 38808935.5556; val_kl_reg_loss: 19146.0039; val_edge_recon_loss: 40631392.0000; val_gene_expr_recon_loss: 2901933.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1075180.6250; val_global_loss: 44627652.0000; val_optim_loss: 44627652.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9132; val_auprc_score: 0.9224; val_best_acc_score: 0.5783; val_best_f1_score: 0.7020; train_kl_reg_loss: 28836.0485; train_edge_recon_loss: 34719559.1111; train_gene_expr_recon_loss: 2851179.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1067439.4375; train_global_loss: 38667013.7778; train_optim_loss: 38667013.7778; val_kl_reg_loss: 19486.6055; val_edge_recon_loss: 40603856.0000; val_gene_expr_recon_loss: 2793425.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1065199.7500; val_global_loss: 44481968.0000; val_optim_loss: 44481968.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9041; val_auprc_score: 0.9077; val_best_acc_score: 0.6681; val_best_f1_score: 0.7470; train_kl_reg_loss: 30235.2166; train_edge_recon_loss: 34728379.5556; train_gene_expr_recon_loss: 2731894.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1055096.6528; train_global_loss: 38545605.3333; train_optim_loss: 38545605.3333; val_kl_reg_loss: 24571.4609; val_edge_recon_loss: 40544600.0000; val_gene_expr_recon_loss: 2686311.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1056232.1250; val_global_loss: 44311716.0000; val_optim_loss: 44311716.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9008; val_auprc_score: 0.8953; val_best_acc_score: 0.7874; val_best_f1_score: 0.8166; train_kl_reg_loss: 45781.4201; train_edge_recon_loss: 34710021.7778; train_gene_expr_recon_loss: 2648904.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1048165.8194; train_global_loss: 38452873.7778; train_optim_loss: 38452873.7778; val_kl_reg_loss: 28257.1504; val_edge_recon_loss: 40389256.0000; val_gene_expr_recon_loss: 2596397.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1048062.8125; val_global_loss: 44061972.0000; val_optim_loss: 44061972.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9025; val_auprc_score: 0.8868; val_best_acc_score: 0.8173; val_best_f1_score: 0.8163; train_kl_reg_loss: 41310.7830; train_edge_recon_loss: 34685988.4444; train_gene_expr_recon_loss: 2523111.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1028816.3333; train_global_loss: 38279225.3333; train_optim_loss: 38279225.3333; val_kl_reg_loss: 38709.1875; val_edge_recon_loss: 39808260.0000; val_gene_expr_recon_loss: 2522748.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1039834.3750; val_global_loss: 43409552.0000; val_optim_loss: 43409552.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8916; val_auprc_score: 0.8710; val_best_acc_score: 0.8178; val_best_f1_score: 0.8289; train_kl_reg_loss: 39240.1022; train_edge_recon_loss: 34603168.0000; train_gene_expr_recon_loss: 2470807.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1021145.8194; train_global_loss: 38134362.6667; train_optim_loss: 38134362.6667; val_kl_reg_loss: 19277.8594; val_edge_recon_loss: 36976688.0000; val_gene_expr_recon_loss: 2510536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1037797.7500; val_global_loss: 40544296.0000; val_optim_loss: 40544296.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8486; val_auprc_score: 0.8379; val_best_acc_score: 0.7475; val_best_f1_score: 0.7818; train_kl_reg_loss: 8935.1894; train_edge_recon_loss: 32566862.0000; train_gene_expr_recon_loss: 2648384.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1041473.9792; train_global_loss: 36265655.5556; train_optim_loss: 36265655.5556; val_kl_reg_loss: 7644.5361; val_edge_recon_loss: 29416924.0000; val_gene_expr_recon_loss: 2922495.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1074272.2500; val_global_loss: 33421336.0000; val_optim_loss: 33421336.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8678; val_auprc_score: 0.8580; val_best_acc_score: 0.7739; val_best_f1_score: 0.7937; train_kl_reg_loss: 19028.1807; train_edge_recon_loss: 28842101.5556; train_gene_expr_recon_loss: 2814497.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047201.0069; train_global_loss: 32722828.8889; train_optim_loss: 32722828.8889; val_kl_reg_loss: 34012.4844; val_edge_recon_loss: 28515164.0000; val_gene_expr_recon_loss: 2775514.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1057337.0000; val_global_loss: 32382028.0000; val_optim_loss: 32382028.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8686; val_auprc_score: 0.8504; val_best_acc_score: 0.7805; val_best_f1_score: 0.7971; train_kl_reg_loss: 44071.7708; train_edge_recon_loss: 28441707.7778; train_gene_expr_recon_loss: 2690374.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1040093.0417; train_global_loss: 32216247.1111; train_optim_loss: 32216247.1111; val_kl_reg_loss: 52391.7656; val_edge_recon_loss: 28399438.0000; val_gene_expr_recon_loss: 2653039.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1046219.0625; val_global_loss: 32151090.0000; val_optim_loss: 32151090.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8737; val_auprc_score: 0.8498; val_best_acc_score: 0.7881; val_best_f1_score: 0.8000; train_kl_reg_loss: 58595.1997; train_edge_recon_loss: 28494788.2222; train_gene_expr_recon_loss: 2591734.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1028376.2778; train_global_loss: 32173494.2222; train_optim_loss: 32173494.2222; val_kl_reg_loss: 61928.0039; val_edge_recon_loss: 28685430.0000; val_gene_expr_recon_loss: 2606989.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1043547.0625; val_global_loss: 32397896.0000; val_optim_loss: 32397896.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8795; val_auprc_score: 0.8483; val_best_acc_score: 0.7998; val_best_f1_score: 0.8152; train_kl_reg_loss: 67471.8993; train_edge_recon_loss: 28043209.7778; train_gene_expr_recon_loss: 2542926.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1030062.7917; train_global_loss: 31683670.8889; train_optim_loss: 31683670.8889; val_kl_reg_loss: 68886.8438; val_edge_recon_loss: 28136506.0000; val_gene_expr_recon_loss: 2580965.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1045159.1875; val_global_loss: 31831518.0000; val_optim_loss: 31831518.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9049; val_auprc_score: 0.8739; val_best_acc_score: 0.8422; val_best_f1_score: 0.8542; train_kl_reg_loss: 71653.9722; train_edge_recon_loss: 27662828.2222; train_gene_expr_recon_loss: 2524769.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1027028.2778; train_global_loss: 31286279.7778; train_optim_loss: 31286279.7778; val_kl_reg_loss: 70318.4844; val_edge_recon_loss: 27506364.0000; val_gene_expr_recon_loss: 2570221.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1043370.4375; val_global_loss: 31190274.0000; val_optim_loss: 31190274.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9235; val_auprc_score: 0.8973; val_best_acc_score: 0.8655; val_best_f1_score: 0.8735; train_kl_reg_loss: 75431.0087; train_edge_recon_loss: 27291537.5556; train_gene_expr_recon_loss: 2516067.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1026734.4722; train_global_loss: 30909770.6667; train_optim_loss: 30909770.6667; val_kl_reg_loss: 74766.7969; val_edge_recon_loss: 27212292.0000; val_gene_expr_recon_loss: 2531483.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1038046.3750; val_global_loss: 30856588.0000; val_optim_loss: 30856588.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9274; val_auprc_score: 0.9099; val_best_acc_score: 0.8622; val_best_f1_score: 0.8716; train_kl_reg_loss: 81549.2891; train_edge_recon_loss: 27223190.4444; train_gene_expr_recon_loss: 2477010.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1023890.0764; train_global_loss: 30805640.0000; train_optim_loss: 30805640.0000; val_kl_reg_loss: 81523.8203; val_edge_recon_loss: 27598116.0000; val_gene_expr_recon_loss: 2488783.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1031756.5625; val_global_loss: 31200180.0000; val_optim_loss: 31200180.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9317; val_auprc_score: 0.9083; val_best_acc_score: 0.8731; val_best_f1_score: 0.8798; train_kl_reg_loss: 87745.6944; train_edge_recon_loss: 27129803.5556; train_gene_expr_recon_loss: 2438750.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1013436.3125; train_global_loss: 30669736.0000; train_optim_loss: 30669736.0000; val_kl_reg_loss: 86065.8750; val_edge_recon_loss: 27305656.0000; val_gene_expr_recon_loss: 2463544.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1030005.6250; val_global_loss: 30885272.0000; val_optim_loss: 30885272.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9314; val_auprc_score: 0.9066; val_best_acc_score: 0.8750; val_best_f1_score: 0.8819; train_kl_reg_loss: 90742.6293; train_edge_recon_loss: 26971474.8889; train_gene_expr_recon_loss: 2425600.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1015122.3819; train_global_loss: 30502940.2222; train_optim_loss: 30502940.2222; val_kl_reg_loss: 88811.8203; val_edge_recon_loss: 27165670.0000; val_gene_expr_recon_loss: 2461068.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1029828.0625; val_global_loss: 30745378.0000; val_optim_loss: 30745378.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9394; val_auprc_score: 0.9200; val_best_acc_score: 0.8821; val_best_f1_score: 0.8877; train_kl_reg_loss: 91960.4887; train_edge_recon_loss: 27004626.2222; train_gene_expr_recon_loss: 2407641.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1014701.4861; train_global_loss: 30518929.3333; train_optim_loss: 30518929.3333; val_kl_reg_loss: 88101.6328; val_edge_recon_loss: 27181446.0000; val_gene_expr_recon_loss: 2429073.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1026355.0000; val_global_loss: 30724976.0000; val_optim_loss: 30724976.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9447; val_auprc_score: 0.9258; val_best_acc_score: 0.8879; val_best_f1_score: 0.8943; train_kl_reg_loss: 92154.6589; train_edge_recon_loss: 26973616.8889; train_gene_expr_recon_loss: 2389238.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1014057.0556; train_global_loss: 30469067.1111; train_optim_loss: 30469067.1111; val_kl_reg_loss: 87546.6797; val_edge_recon_loss: 26917014.0000; val_gene_expr_recon_loss: 2436044.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1026467.7500; val_global_loss: 30467072.0000; val_optim_loss: 30467072.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9431; val_auprc_score: 0.9224; val_best_acc_score: 0.8883; val_best_f1_score: 0.8939; train_kl_reg_loss: 91715.5469; train_edge_recon_loss: 26913436.0000; train_gene_expr_recon_loss: 2357271.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1010347.7431; train_global_loss: 30372771.3333; train_optim_loss: 30372771.3333; val_kl_reg_loss: 87971.3750; val_edge_recon_loss: 26931300.0000; val_gene_expr_recon_loss: 2406519.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1022627.1875; val_global_loss: 30448420.0000; val_optim_loss: 30448420.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9484; val_auprc_score: 0.9290; val_best_acc_score: 0.8930; val_best_f1_score: 0.8974; train_kl_reg_loss: 90554.1458; train_edge_recon_loss: 26836569.5556; train_gene_expr_recon_loss: 2355240.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1007302.8056; train_global_loss: 30289666.8889; train_optim_loss: 30289666.8889; val_kl_reg_loss: 86197.5391; val_edge_recon_loss: 26920876.0000; val_gene_expr_recon_loss: 2383096.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1020218.1250; val_global_loss: 30410388.0000; val_optim_loss: 30410388.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9464; val_auprc_score: 0.9225; val_best_acc_score: 0.8902; val_best_f1_score: 0.8958; train_kl_reg_loss: 89487.6658; train_edge_recon_loss: 26816249.5556; train_gene_expr_recon_loss: 2341042.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1001219.2361; train_global_loss: 30247998.8889; train_optim_loss: 30247998.8889; val_kl_reg_loss: 84974.9766; val_edge_recon_loss: 26827422.0000; val_gene_expr_recon_loss: 2379787.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1021728.0625; val_global_loss: 30313912.0000; val_optim_loss: 30313912.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9496; val_auprc_score: 0.9293; val_best_acc_score: 0.8911; val_best_f1_score: 0.8970; train_kl_reg_loss: 87132.3776; train_edge_recon_loss: 26703365.3333; train_gene_expr_recon_loss: 2328572.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1008668.7083; train_global_loss: 30127739.1111; train_optim_loss: 30127739.1111; val_kl_reg_loss: 83127.9609; val_edge_recon_loss: 26868972.0000; val_gene_expr_recon_loss: 2368614.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1018352.2500; val_global_loss: 30339066.0000; val_optim_loss: 30339066.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9539; val_auprc_score: 0.9359; val_best_acc_score: 0.8992; val_best_f1_score: 0.9047; train_kl_reg_loss: 86605.8194; train_edge_recon_loss: 26622879.5556; train_gene_expr_recon_loss: 2318864.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1005609.5625; train_global_loss: 30033959.1111; train_optim_loss: 30033959.1111; val_kl_reg_loss: 85131.4141; val_edge_recon_loss: 26778250.0000; val_gene_expr_recon_loss: 2371154.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1017803.8125; val_global_loss: 30252340.0000; val_optim_loss: 30252340.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9523; val_auprc_score: 0.9338; val_best_acc_score: 0.8979; val_best_f1_score: 0.9030; train_kl_reg_loss: 88640.0061; train_edge_recon_loss: 26455027.5556; train_gene_expr_recon_loss: 2317945.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1002953.8819; train_global_loss: 29864566.8889; train_optim_loss: 29864566.8889; val_kl_reg_loss: 87469.8203; val_edge_recon_loss: 26791096.0000; val_gene_expr_recon_loss: 2370816.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1016930.9375; val_global_loss: 30266312.0000; val_optim_loss: 30266312.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9542; val_auprc_score: 0.9314; val_best_acc_score: 0.9025; val_best_f1_score: 0.9072; train_kl_reg_loss: 92366.8550; train_edge_recon_loss: 26612274.0000; train_gene_expr_recon_loss: 2318839.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 999661.7222; train_global_loss: 30023142.8889; train_optim_loss: 30023142.8889; val_kl_reg_loss: 88770.0312; val_edge_recon_loss: 26831660.0000; val_gene_expr_recon_loss: 2346383.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1013410.6250; val_global_loss: 30280224.0000; val_optim_loss: 30280224.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9543; val_auprc_score: 0.9342; val_best_acc_score: 0.9023; val_best_f1_score: 0.9075; train_kl_reg_loss: 94888.4523; train_edge_recon_loss: 26587174.0000; train_gene_expr_recon_loss: 2310191.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1000034.7917; train_global_loss: 29992288.2222; train_optim_loss: 29992288.2222; val_kl_reg_loss: 91095.2656; val_edge_recon_loss: 26714196.0000; val_gene_expr_recon_loss: 2346550.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1013049.3125; val_global_loss: 30164892.0000; val_optim_loss: 30164892.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9592; val_auprc_score: 0.9463; val_best_acc_score: 0.9062; val_best_f1_score: 0.9102; train_kl_reg_loss: 96313.0816; train_edge_recon_loss: 26588359.1111; train_gene_expr_recon_loss: 2292653.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 998307.3056; train_global_loss: 29975633.5556; train_optim_loss: 29975633.5556; val_kl_reg_loss: 94060.9141; val_edge_recon_loss: 26740644.0000; val_gene_expr_recon_loss: 2332056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1013278.0000; val_global_loss: 30180038.0000; val_optim_loss: 30180038.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9606; val_auprc_score: 0.9465; val_best_acc_score: 0.9111; val_best_f1_score: 0.9153; train_kl_reg_loss: 97529.5538; train_edge_recon_loss: 26506325.7778; train_gene_expr_recon_loss: 2282495.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 997628.0486; train_global_loss: 29883978.4444; train_optim_loss: 29883978.4444; val_kl_reg_loss: 93265.1094; val_edge_recon_loss: 26669648.0000; val_gene_expr_recon_loss: 2329516.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1010016.7500; val_global_loss: 30102446.0000; val_optim_loss: 30102446.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9635; val_auprc_score: 0.9516; val_best_acc_score: 0.9132; val_best_f1_score: 0.9176; train_kl_reg_loss: 97622.8845; train_edge_recon_loss: 26605586.2222; train_gene_expr_recon_loss: 2268903.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 988999.2083; train_global_loss: 29961111.7778; train_optim_loss: 29961111.7778; val_kl_reg_loss: 94836.0625; val_edge_recon_loss: 26611662.0000; val_gene_expr_recon_loss: 2317963.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1009118.3125; val_global_loss: 30033580.0000; val_optim_loss: 30033580.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9609; val_auprc_score: 0.9435; val_best_acc_score: 0.9127; val_best_f1_score: 0.9162; train_kl_reg_loss: 97707.5165; train_edge_recon_loss: 26437574.6667; train_gene_expr_recon_loss: 2272654.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1000190.6528; train_global_loss: 29808127.7778; train_optim_loss: 29808127.7778; val_kl_reg_loss: 93413.9219; val_edge_recon_loss: 26626592.0000; val_gene_expr_recon_loss: 2332509.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1010342.5000; val_global_loss: 30062858.0000; val_optim_loss: 30062858.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9649; val_auprc_score: 0.9509; val_best_acc_score: 0.9161; val_best_f1_score: 0.9196; train_kl_reg_loss: 96920.6780; train_edge_recon_loss: 26369978.8889; train_gene_expr_recon_loss: 2266200.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 996043.4583; train_global_loss: 29729143.7778; train_optim_loss: 29729143.7778; val_kl_reg_loss: 92652.2812; val_edge_recon_loss: 26671252.0000; val_gene_expr_recon_loss: 2305861.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1005704.1250; val_global_loss: 30075468.0000; val_optim_loss: 30075468.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9644; val_auprc_score: 0.9490; val_best_acc_score: 0.9190; val_best_f1_score: 0.9226; train_kl_reg_loss: 95513.8186; train_edge_recon_loss: 26491405.1111; train_gene_expr_recon_loss: 2250589.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 993713.3333; train_global_loss: 29831221.3333; train_optim_loss: 29831221.3333; val_kl_reg_loss: 92509.7266; val_edge_recon_loss: 26548496.0000; val_gene_expr_recon_loss: 2321368.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1007528.7500; val_global_loss: 29969902.0000; val_optim_loss: 29969902.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9626; val_auprc_score: 0.9455; val_best_acc_score: 0.9157; val_best_f1_score: 0.9196; train_kl_reg_loss: 95905.4783; train_edge_recon_loss: 26424144.4444; train_gene_expr_recon_loss: 2253086.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 993146.4375; train_global_loss: 29766282.6667; train_optim_loss: 29766282.6667; val_kl_reg_loss: 90731.9844; val_edge_recon_loss: 26702958.0000; val_gene_expr_recon_loss: 2299959.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1005490.0625; val_global_loss: 30099140.0000; val_optim_loss: 30099140.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9675; val_auprc_score: 0.9544; val_best_acc_score: 0.9236; val_best_f1_score: 0.9260; train_kl_reg_loss: 93402.2708; train_edge_recon_loss: 26420475.5556; train_gene_expr_recon_loss: 2244329.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 990559.9514; train_global_loss: 29748766.4444; train_optim_loss: 29748766.4444; val_kl_reg_loss: 89876.1562; val_edge_recon_loss: 26530904.0000; val_gene_expr_recon_loss: 2299002.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1004319.6250; val_global_loss: 29924102.0000; val_optim_loss: 29924102.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9686; val_auprc_score: 0.9559; val_best_acc_score: 0.9267; val_best_f1_score: 0.9289; train_kl_reg_loss: 94001.6502; train_edge_recon_loss: 26332756.2222; train_gene_expr_recon_loss: 2241013.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 985727.3681; train_global_loss: 29653499.1111; train_optim_loss: 29653499.1111; val_kl_reg_loss: 91367.4297; val_edge_recon_loss: 26543320.0000; val_gene_expr_recon_loss: 2292862.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1002972.5625; val_global_loss: 29930522.0000; val_optim_loss: 29930522.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9686; val_auprc_score: 0.9571; val_best_acc_score: 0.9240; val_best_f1_score: 0.9263; train_kl_reg_loss: 93479.8620; train_edge_recon_loss: 26391328.6667; train_gene_expr_recon_loss: 2227059.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982041.4861; train_global_loss: 29693909.7778; train_optim_loss: 29693909.7778; val_kl_reg_loss: 90113.6953; val_edge_recon_loss: 26655548.0000; val_gene_expr_recon_loss: 2284138.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1001005.3125; val_global_loss: 30030806.0000; val_optim_loss: 30030806.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9698; val_auprc_score: 0.9568; val_best_acc_score: 0.9240; val_best_f1_score: 0.9270; train_kl_reg_loss: 91416.7552; train_edge_recon_loss: 26363310.4444; train_gene_expr_recon_loss: 2236700.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 985278.7083; train_global_loss: 29676706.6667; train_optim_loss: 29676706.6667; val_kl_reg_loss: 87534.9844; val_edge_recon_loss: 26480028.0000; val_gene_expr_recon_loss: 2286662.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1000696.1250; val_global_loss: 29854920.0000; val_optim_loss: 29854920.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9718; val_auprc_score: 0.9593; val_best_acc_score: 0.9271; val_best_f1_score: 0.9300; train_kl_reg_loss: 89317.9974; train_edge_recon_loss: 26348248.2222; train_gene_expr_recon_loss: 2225103.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 984376.2778; train_global_loss: 29647046.4444; train_optim_loss: 29647046.4444; val_kl_reg_loss: 84826.6406; val_edge_recon_loss: 26297318.0000; val_gene_expr_recon_loss: 2277491.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 999747.5625; val_global_loss: 29659384.0000; val_optim_loss: 29659384.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9695; val_auprc_score: 0.9549; val_best_acc_score: 0.9278; val_best_f1_score: 0.9304; train_kl_reg_loss: 86824.3247; train_edge_recon_loss: 26328161.3333; train_gene_expr_recon_loss: 2220918.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 980480.6667; train_global_loss: 29616385.5556; train_optim_loss: 29616385.5556; val_kl_reg_loss: 84333.2656; val_edge_recon_loss: 26366776.0000; val_gene_expr_recon_loss: 2287471.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1001339.8750; val_global_loss: 29739922.0000; val_optim_loss: 29739922.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9711; val_auprc_score: 0.9592; val_best_acc_score: 0.9272; val_best_f1_score: 0.9299; train_kl_reg_loss: 87001.4523; train_edge_recon_loss: 26353619.7778; train_gene_expr_recon_loss: 2223066.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 983672.0069; train_global_loss: 29647358.8889; train_optim_loss: 29647358.8889; val_kl_reg_loss: 83978.7891; val_edge_recon_loss: 26581574.0000; val_gene_expr_recon_loss: 2275884.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 999743.3125; val_global_loss: 29941180.0000; val_optim_loss: 29941180.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9710; val_auprc_score: 0.9571; val_best_acc_score: 0.9275; val_best_f1_score: 0.9305; train_kl_reg_loss: 86107.6970; train_edge_recon_loss: 26354794.2222; train_gene_expr_recon_loss: 2214944.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982679.0417; train_global_loss: 29638525.7778; train_optim_loss: 29638525.7778; val_kl_reg_loss: 84288.3594; val_edge_recon_loss: 26465150.0000; val_gene_expr_recon_loss: 2272234.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 997993.1250; val_global_loss: 29819666.0000; val_optim_loss: 29819666.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9740; val_auprc_score: 0.9644; val_best_acc_score: 0.9324; val_best_f1_score: 0.9342; train_kl_reg_loss: 86628.9592; train_edge_recon_loss: 26396149.3333; train_gene_expr_recon_loss: 2215883.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 985782.1042; train_global_loss: 29684444.0000; train_optim_loss: 29684444.0000; val_kl_reg_loss: 83919.4219; val_edge_recon_loss: 26443464.0000; val_gene_expr_recon_loss: 2285054.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 999617.9375; val_global_loss: 29812056.0000; val_optim_loss: 29812056.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9753; val_auprc_score: 0.9658; val_best_acc_score: 0.9336; val_best_f1_score: 0.9354; train_kl_reg_loss: 85699.5425; train_edge_recon_loss: 26313263.1111; train_gene_expr_recon_loss: 2213921.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979257.1389; train_global_loss: 29592140.2222; train_optim_loss: 29592140.2222; val_kl_reg_loss: 83790.3281; val_edge_recon_loss: 26216012.0000; val_gene_expr_recon_loss: 2258513.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 995712.8750; val_global_loss: 29554028.0000; val_optim_loss: 29554028.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9716; val_auprc_score: 0.9626; val_best_acc_score: 0.9283; val_best_f1_score: 0.9300; train_kl_reg_loss: 85745.0564; train_edge_recon_loss: 26312790.0000; train_gene_expr_recon_loss: 2207847.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982219.5903; train_global_loss: 29588601.7778; train_optim_loss: 29588601.7778; val_kl_reg_loss: 84081.2500; val_edge_recon_loss: 26646290.0000; val_gene_expr_recon_loss: 2267654.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 997449.3750; val_global_loss: 29995476.0000; val_optim_loss: 29995476.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9731; val_auprc_score: 0.9600; val_best_acc_score: 0.9325; val_best_f1_score: 0.9346; train_kl_reg_loss: 85713.9939; train_edge_recon_loss: 26295291.7778; train_gene_expr_recon_loss: 2208925.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 983802.4931; train_global_loss: 29573733.3333; train_optim_loss: 29573733.3333; val_kl_reg_loss: 83653.8438; val_edge_recon_loss: 26336292.0000; val_gene_expr_recon_loss: 2267607.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 997322.8750; val_global_loss: 29684874.0000; val_optim_loss: 29684874.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9749; val_auprc_score: 0.9639; val_best_acc_score: 0.9318; val_best_f1_score: 0.9332; train_kl_reg_loss: 85718.4844; train_edge_recon_loss: 26314482.6667; train_gene_expr_recon_loss: 2209167.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 981493.5347; train_global_loss: 29590862.0000; train_optim_loss: 29590862.0000; val_kl_reg_loss: 83207.6328; val_edge_recon_loss: 26311418.0000; val_gene_expr_recon_loss: 2260917.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 995650.8750; val_global_loss: 29651194.0000; val_optim_loss: 29651194.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9741; val_auprc_score: 0.9616; val_best_acc_score: 0.9318; val_best_f1_score: 0.9334; train_kl_reg_loss: 84981.5911; train_edge_recon_loss: 26293405.1111; train_gene_expr_recon_loss: 2198630.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 980237.4722; train_global_loss: 29557254.8889; train_optim_loss: 29557254.8889; val_kl_reg_loss: 83458.1406; val_edge_recon_loss: 26425410.0000; val_gene_expr_recon_loss: 2271713.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 998297.1875; val_global_loss: 29778878.0000; val_optim_loss: 29778878.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9673; val_auprc_score: 0.9527; val_best_acc_score: 0.9278; val_best_f1_score: 0.9299; train_kl_reg_loss: 85272.1380; train_edge_recon_loss: 26222087.3333; train_gene_expr_recon_loss: 2213643.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 980920.0208; train_global_loss: 29501923.1111; train_optim_loss: 29501923.1111; val_kl_reg_loss: 83048.6719; val_edge_recon_loss: 26494088.0000; val_gene_expr_recon_loss: 2270233.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 998234.5625; val_global_loss: 29845604.0000; val_optim_loss: 29845604.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9724; val_auprc_score: 0.9621; val_best_acc_score: 0.9310; val_best_f1_score: 0.9325; train_kl_reg_loss: 85236.5582; train_edge_recon_loss: 26269687.3333; train_gene_expr_recon_loss: 2213127.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 981040.0000; train_global_loss: 29549092.2222; train_optim_loss: 29549092.2222; val_kl_reg_loss: 82937.4922; val_edge_recon_loss: 26599624.0000; val_gene_expr_recon_loss: 2265765.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 996688.8125; val_global_loss: 29945016.0000; val_optim_loss: 29945016.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9715; val_auprc_score: 0.9581; val_best_acc_score: 0.9321; val_best_f1_score: 0.9341; train_kl_reg_loss: 84809.0799; train_edge_recon_loss: 26309470.0000; train_gene_expr_recon_loss: 2195426.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976575.5139; train_global_loss: 29566280.6667; train_optim_loss: 29566280.6667; val_kl_reg_loss: 83006.1250; val_edge_recon_loss: 26329336.0000; val_gene_expr_recon_loss: 2266160.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 996659.3125; val_global_loss: 29675162.0000; val_optim_loss: 29675162.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9715; val_auprc_score: 0.9575; val_best_acc_score: 0.9285; val_best_f1_score: 0.9302; train_kl_reg_loss: 84750.2613; train_edge_recon_loss: 26289036.0000; train_gene_expr_recon_loss: 2200738.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975349.3958; train_global_loss: 29549874.4444; train_optim_loss: 29549874.4444; val_kl_reg_loss: 82824.9688; val_edge_recon_loss: 26521448.0000; val_gene_expr_recon_loss: 2264431.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 997262.1875; val_global_loss: 29865966.0000; val_optim_loss: 29865966.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 15 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
Val AUROC score: 0.9732
Val AUPRC score: 0.9646
Val best accuracy score: 0.9285
Val best F1 score: 0.9300
Val gene expr MSE score: 0.4077
Val chrom access MSE score: 0.0891
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
