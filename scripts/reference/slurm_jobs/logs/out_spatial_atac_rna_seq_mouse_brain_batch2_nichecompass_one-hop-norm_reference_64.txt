[True]
Run timestamp: 07092023_173324_64.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_64']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3394 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7897, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6387; val_auprc_score: 0.6144; val_best_acc_score: 0.5220; val_best_f1_score: 0.6749; train_kl_reg_loss: 63812.8780; train_edge_recon_loss: 3558645.1818; train_gene_expr_recon_loss: 28385636.1212; train_masked_gp_l1_reg_loss: 207091.5772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10841157.1970; train_chrom_access_recon_loss: 3040021.6439; train_global_loss: 46096364.8485; train_optim_loss: 46096364.8485; val_kl_reg_loss: 121624.0322; val_edge_recon_loss: 4064027.4688; val_gene_expr_recon_loss: 25088479.2500; val_masked_gp_l1_reg_loss: 197271.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4734493.0000; val_chrom_access_recon_loss: 2886789.7188; val_global_loss: 37092686.5000; val_optim_loss: 37092686.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6849; val_auprc_score: 0.6672; val_best_acc_score: 0.5333; val_best_f1_score: 0.6774; train_kl_reg_loss: 132626.4948; train_edge_recon_loss: 3567969.0455; train_gene_expr_recon_loss: 24978338.9091; train_masked_gp_l1_reg_loss: 181726.9141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2084770.9195; train_chrom_access_recon_loss: 2855885.5303; train_global_loss: 33801317.8182; train_optim_loss: 33801317.8182; val_kl_reg_loss: 142651.0352; val_edge_recon_loss: 4062985.8438; val_gene_expr_recon_loss: 24357872.2500; val_masked_gp_l1_reg_loss: 171771.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 789172.0625; val_chrom_access_recon_loss: 2823823.9688; val_global_loss: 32348277.5000; val_optim_loss: 32348277.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7519; val_auprc_score: 0.7433; val_best_acc_score: 0.6343; val_best_f1_score: 0.7129; train_kl_reg_loss: 140772.8075; train_edge_recon_loss: 3553244.3144; train_gene_expr_recon_loss: 24498430.6061; train_masked_gp_l1_reg_loss: 169532.7090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 520995.1146; train_chrom_access_recon_loss: 2822020.0152; train_global_loss: 31704995.4242; train_optim_loss: 31704995.4242; val_kl_reg_loss: 145951.3926; val_edge_recon_loss: 4056475.3438; val_gene_expr_recon_loss: 23973863.2500; val_masked_gp_l1_reg_loss: 168830.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 358968.2188; val_chrom_access_recon_loss: 2804486.3438; val_global_loss: 31508574.2500; val_optim_loss: 31508574.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8183; val_auprc_score: 0.7987; val_best_acc_score: 0.7493; val_best_f1_score: 0.7335; train_kl_reg_loss: 132148.5470; train_edge_recon_loss: 3540017.2235; train_gene_expr_recon_loss: 24312655.9091; train_masked_gp_l1_reg_loss: 169968.7401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 293185.1307; train_chrom_access_recon_loss: 2807476.5076; train_global_loss: 31255452.1818; train_optim_loss: 31255452.1818; val_kl_reg_loss: 130054.6406; val_edge_recon_loss: 4015732.1875; val_gene_expr_recon_loss: 23963110.2500; val_masked_gp_l1_reg_loss: 172617.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 246382.6094; val_chrom_access_recon_loss: 2821993.6250; val_global_loss: 31349890.5000; val_optim_loss: 31349890.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8650; val_auprc_score: 0.8291; val_best_acc_score: 0.7920; val_best_f1_score: 0.8129; train_kl_reg_loss: 117853.5067; train_edge_recon_loss: 3512689.5303; train_gene_expr_recon_loss: 24139660.3636; train_masked_gp_l1_reg_loss: 174856.4602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 219020.7824; train_chrom_access_recon_loss: 2787756.4886; train_global_loss: 30951836.9091; train_optim_loss: 30951836.9091; val_kl_reg_loss: 111177.9814; val_edge_recon_loss: 3783766.5938; val_gene_expr_recon_loss: 23785953.2500; val_masked_gp_l1_reg_loss: 177877.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 197135.0781; val_chrom_access_recon_loss: 2795055.7812; val_global_loss: 30850967.7500; val_optim_loss: 30850967.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8529; val_auprc_score: 0.8200; val_best_acc_score: 0.7754; val_best_f1_score: 0.8001; train_kl_reg_loss: 101685.3769; train_edge_recon_loss: 3354694.8182; train_gene_expr_recon_loss: 24089939.4545; train_masked_gp_l1_reg_loss: 186303.1402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 187228.7810; train_chrom_access_recon_loss: 2777748.4848; train_global_loss: 30697600.1515; train_optim_loss: 30697600.1515; val_kl_reg_loss: 98814.2490; val_edge_recon_loss: 3258109.1250; val_gene_expr_recon_loss: 23479399.2500; val_masked_gp_l1_reg_loss: 196981.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 183966.0156; val_chrom_access_recon_loss: 2715000.9375; val_global_loss: 29932270.7500; val_optim_loss: 29932270.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8563; val_auprc_score: 0.8208; val_best_acc_score: 0.7724; val_best_f1_score: 0.8017; train_kl_reg_loss: 119501.2461; train_edge_recon_loss: 3101769.5189; train_gene_expr_recon_loss: 23923115.9697; train_masked_gp_l1_reg_loss: 197029.8710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 175389.4905; train_chrom_access_recon_loss: 2758083.8258; train_global_loss: 30274889.9697; train_optim_loss: 30274889.9697; val_kl_reg_loss: 129330.0010; val_edge_recon_loss: 3004090.1562; val_gene_expr_recon_loss: 23183576.7500; val_masked_gp_l1_reg_loss: 198616.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 170124.7188; val_chrom_access_recon_loss: 2707220.3125; val_global_loss: 29392957.2500; val_optim_loss: 29392957.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8684; val_auprc_score: 0.8287; val_best_acc_score: 0.7915; val_best_f1_score: 0.8093; train_kl_reg_loss: 138926.9669; train_edge_recon_loss: 3013494.8409; train_gene_expr_recon_loss: 23800543.3030; train_masked_gp_l1_reg_loss: 199449.3937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165813.3691; train_chrom_access_recon_loss: 2745754.5303; train_global_loss: 30063982.6061; train_optim_loss: 30063982.6061; val_kl_reg_loss: 144029.5566; val_edge_recon_loss: 2990638.0938; val_gene_expr_recon_loss: 23361328.5000; val_masked_gp_l1_reg_loss: 201097.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162107.2969; val_chrom_access_recon_loss: 2726580.8125; val_global_loss: 29585783.2500; val_optim_loss: 29585783.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8655; val_auprc_score: 0.8308; val_best_acc_score: 0.7910; val_best_f1_score: 0.8089; train_kl_reg_loss: 144078.7280; train_edge_recon_loss: 2966565.7841; train_gene_expr_recon_loss: 23662275.2424; train_masked_gp_l1_reg_loss: 202178.1146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159708.5492; train_chrom_access_recon_loss: 2727248.0076; train_global_loss: 29862054.5455; train_optim_loss: 29862054.5455; val_kl_reg_loss: 142053.7617; val_edge_recon_loss: 2998477.9688; val_gene_expr_recon_loss: 23307970.5000; val_masked_gp_l1_reg_loss: 203380.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157672.3594; val_chrom_access_recon_loss: 2713302.0625; val_global_loss: 29522856.2500; val_optim_loss: 29522856.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8810; val_auprc_score: 0.8394; val_best_acc_score: 0.8114; val_best_f1_score: 0.8293; train_kl_reg_loss: 148929.8999; train_edge_recon_loss: 2910811.2083; train_gene_expr_recon_loss: 23572934.6061; train_masked_gp_l1_reg_loss: 204778.4432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156095.1418; train_chrom_access_recon_loss: 2719323.7955; train_global_loss: 29712873.0000; train_optim_loss: 29712873.0000; val_kl_reg_loss: 150761.0469; val_edge_recon_loss: 2887305.7188; val_gene_expr_recon_loss: 23043678.5000; val_masked_gp_l1_reg_loss: 206437.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154982.7344; val_chrom_access_recon_loss: 2675747.4375; val_global_loss: 29118913.5000; val_optim_loss: 29118913.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8863; val_auprc_score: 0.8507; val_best_acc_score: 0.8248; val_best_f1_score: 0.8373; train_kl_reg_loss: 148743.0836; train_edge_recon_loss: 2897292.4205; train_gene_expr_recon_loss: 23472233.0000; train_masked_gp_l1_reg_loss: 207157.7038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154246.9626; train_chrom_access_recon_loss: 2708255.4205; train_global_loss: 29587928.7273; train_optim_loss: 29587928.7273; val_kl_reg_loss: 147907.1406; val_edge_recon_loss: 2922753.1875; val_gene_expr_recon_loss: 23127130.5000; val_masked_gp_l1_reg_loss: 208481.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153885.2031; val_chrom_access_recon_loss: 2689963.2500; val_global_loss: 29250122.0000; val_optim_loss: 29250122.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8980; val_auprc_score: 0.8612; val_best_acc_score: 0.8332; val_best_f1_score: 0.8475; train_kl_reg_loss: 149791.2621; train_edge_recon_loss: 2876656.8447; train_gene_expr_recon_loss: 23386034.6364; train_masked_gp_l1_reg_loss: 209566.0393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152858.2713; train_chrom_access_recon_loss: 2697615.8409; train_global_loss: 29472523.0909; train_optim_loss: 29472523.0909; val_kl_reg_loss: 151704.7207; val_edge_recon_loss: 2883515.5312; val_gene_expr_recon_loss: 22953264.2500; val_masked_gp_l1_reg_loss: 210532.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151426.3281; val_chrom_access_recon_loss: 2670561.7188; val_global_loss: 29021004.0000; val_optim_loss: 29021004.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9114; val_auprc_score: 0.8817; val_best_acc_score: 0.8509; val_best_f1_score: 0.8595; train_kl_reg_loss: 147021.1153; train_edge_recon_loss: 2856804.5000; train_gene_expr_recon_loss: 23300541.0303; train_masked_gp_l1_reg_loss: 211246.7249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151371.7273; train_chrom_access_recon_loss: 2689059.4621; train_global_loss: 29356044.4242; train_optim_loss: 29356044.4242; val_kl_reg_loss: 149559.1172; val_edge_recon_loss: 2840150.1250; val_gene_expr_recon_loss: 22821826.0000; val_masked_gp_l1_reg_loss: 212415.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151261.5469; val_chrom_access_recon_loss: 2654569.8125; val_global_loss: 28829783.5000; val_optim_loss: 28829783.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9046; val_auprc_score: 0.8683; val_best_acc_score: 0.8450; val_best_f1_score: 0.8571; train_kl_reg_loss: 147359.3984; train_edge_recon_loss: 2862689.0492; train_gene_expr_recon_loss: 23232533.3333; train_masked_gp_l1_reg_loss: 213129.1191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149854.5268; train_chrom_access_recon_loss: 2680175.4583; train_global_loss: 29285740.8182; train_optim_loss: 29285740.8182; val_kl_reg_loss: 141101.3398; val_edge_recon_loss: 2858306.6875; val_gene_expr_recon_loss: 22863406.7500; val_masked_gp_l1_reg_loss: 214548.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149804.3906; val_chrom_access_recon_loss: 2653285.8750; val_global_loss: 28880452.7500; val_optim_loss: 28880452.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9055; val_auprc_score: 0.8731; val_best_acc_score: 0.8455; val_best_f1_score: 0.8582; train_kl_reg_loss: 145188.4588; train_edge_recon_loss: 2848816.2008; train_gene_expr_recon_loss: 23164035.8788; train_masked_gp_l1_reg_loss: 214894.2050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148140.6226; train_chrom_access_recon_loss: 2671676.6667; train_global_loss: 29192752.2727; train_optim_loss: 29192752.2727; val_kl_reg_loss: 140915.8555; val_edge_recon_loss: 2872862.4062; val_gene_expr_recon_loss: 22910439.2500; val_masked_gp_l1_reg_loss: 215159.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147256.2188; val_chrom_access_recon_loss: 2663817.3438; val_global_loss: 28950451.2500; val_optim_loss: 28950451.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9139; val_auprc_score: 0.8844; val_best_acc_score: 0.8568; val_best_f1_score: 0.8660; train_kl_reg_loss: 144598.1811; train_edge_recon_loss: 2840719.9129; train_gene_expr_recon_loss: 23104155.3636; train_masked_gp_l1_reg_loss: 216013.6049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146698.4508; train_chrom_access_recon_loss: 2663092.5076; train_global_loss: 29115277.8788; train_optim_loss: 29115277.8788; val_kl_reg_loss: 145757.1875; val_edge_recon_loss: 2875463.2500; val_gene_expr_recon_loss: 22733618.0000; val_masked_gp_l1_reg_loss: 216876.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147526.0312; val_chrom_access_recon_loss: 2653906.1875; val_global_loss: 28773146.7500; val_optim_loss: 28773146.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9182; val_auprc_score: 0.8907; val_best_acc_score: 0.8568; val_best_f1_score: 0.8665; train_kl_reg_loss: 143046.2824; train_edge_recon_loss: 2841146.1023; train_gene_expr_recon_loss: 23057142.2121; train_masked_gp_l1_reg_loss: 217266.3310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145946.8097; train_chrom_access_recon_loss: 2658007.4811; train_global_loss: 29062555.2121; train_optim_loss: 29062555.2121; val_kl_reg_loss: 137852.2832; val_edge_recon_loss: 2857227.8125; val_gene_expr_recon_loss: 22900717.5000; val_masked_gp_l1_reg_loss: 218117.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145758.7344; val_chrom_access_recon_loss: 2643942.3750; val_global_loss: 28903615.7500; val_optim_loss: 28903615.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9007; val_auprc_score: 0.8644; val_best_acc_score: 0.8436; val_best_f1_score: 0.8577; train_kl_reg_loss: 142142.5634; train_edge_recon_loss: 2833826.2348; train_gene_expr_recon_loss: 22976746.2424; train_masked_gp_l1_reg_loss: 218459.1908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144824.9827; train_chrom_access_recon_loss: 2648423.1326; train_global_loss: 28964422.4242; train_optim_loss: 28964422.4242; val_kl_reg_loss: 137536.4277; val_edge_recon_loss: 2891814.1875; val_gene_expr_recon_loss: 22586245.7500; val_masked_gp_l1_reg_loss: 218907.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143682.2969; val_chrom_access_recon_loss: 2619752.9062; val_global_loss: 28597939.0000; val_optim_loss: 28597939.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9246; val_auprc_score: 0.8976; val_best_acc_score: 0.8627; val_best_f1_score: 0.8712; train_kl_reg_loss: 142474.0310; train_edge_recon_loss: 2827861.2121; train_gene_expr_recon_loss: 22917338.9091; train_masked_gp_l1_reg_loss: 219248.4870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143889.5935; train_chrom_access_recon_loss: 2641763.2955; train_global_loss: 28892575.4242; train_optim_loss: 28892575.4242; val_kl_reg_loss: 137100.2402; val_edge_recon_loss: 2838532.9062; val_gene_expr_recon_loss: 22386902.5000; val_masked_gp_l1_reg_loss: 219713.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143239.5312; val_chrom_access_recon_loss: 2610847.9062; val_global_loss: 28336337.7500; val_optim_loss: 28336337.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9342; val_auprc_score: 0.9119; val_best_acc_score: 0.8689; val_best_f1_score: 0.8765; train_kl_reg_loss: 141028.2493; train_edge_recon_loss: 2816780.5833; train_gene_expr_recon_loss: 22851709.5455; train_masked_gp_l1_reg_loss: 219815.7443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143198.7628; train_chrom_access_recon_loss: 2630978.3712; train_global_loss: 28803511.2727; train_optim_loss: 28803511.2727; val_kl_reg_loss: 139250.6309; val_edge_recon_loss: 2793142.8750; val_gene_expr_recon_loss: 22576467.7500; val_masked_gp_l1_reg_loss: 220388.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142643.6094; val_chrom_access_recon_loss: 2646401.6562; val_global_loss: 28518295.0000; val_optim_loss: 28518295.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9236; val_auprc_score: 0.8940; val_best_acc_score: 0.8622; val_best_f1_score: 0.8700; train_kl_reg_loss: 144796.5625; train_edge_recon_loss: 2807397.6515; train_gene_expr_recon_loss: 22815322.7576; train_masked_gp_l1_reg_loss: 220324.5625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142287.1229; train_chrom_access_recon_loss: 2627303.9621; train_global_loss: 28757432.7576; train_optim_loss: 28757432.7576; val_kl_reg_loss: 141951.5449; val_edge_recon_loss: 2845149.2812; val_gene_expr_recon_loss: 22281847.2500; val_masked_gp_l1_reg_loss: 220688.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142108.1875; val_chrom_access_recon_loss: 2589009.4688; val_global_loss: 28220754.0000; val_optim_loss: 28220754.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9298; val_auprc_score: 0.9070; val_best_acc_score: 0.8675; val_best_f1_score: 0.8739; train_kl_reg_loss: 140916.7057; train_edge_recon_loss: 2811363.3864; train_gene_expr_recon_loss: 22775391.5152; train_masked_gp_l1_reg_loss: 220806.6851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141685.5147; train_chrom_access_recon_loss: 2620809.4508; train_global_loss: 28710973.2727; train_optim_loss: 28710973.2727; val_kl_reg_loss: 138574.0957; val_edge_recon_loss: 2809046.0938; val_gene_expr_recon_loss: 22391748.5000; val_masked_gp_l1_reg_loss: 221178.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141701.4375; val_chrom_access_recon_loss: 2594656.6250; val_global_loss: 28296905.5000; val_optim_loss: 28296905.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9205; val_auprc_score: 0.8921; val_best_acc_score: 0.8619; val_best_f1_score: 0.8681; train_kl_reg_loss: 140652.3172; train_edge_recon_loss: 2798309.2197; train_gene_expr_recon_loss: 22719858.0000; train_masked_gp_l1_reg_loss: 221260.1880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141034.5033; train_chrom_access_recon_loss: 2614996.3258; train_global_loss: 28636110.4242; train_optim_loss: 28636110.4242; val_kl_reg_loss: 139565.8340; val_edge_recon_loss: 2856112.4688; val_gene_expr_recon_loss: 22389203.2500; val_masked_gp_l1_reg_loss: 221671.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141142.2500; val_chrom_access_recon_loss: 2607395.8125; val_global_loss: 28355091.5000; val_optim_loss: 28355091.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9240; val_auprc_score: 0.8935; val_best_acc_score: 0.8694; val_best_f1_score: 0.8754; train_kl_reg_loss: 138813.3904; train_edge_recon_loss: 2792320.1098; train_gene_expr_recon_loss: 22674183.0606; train_masked_gp_l1_reg_loss: 221449.4384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140524.5272; train_chrom_access_recon_loss: 2607211.6250; train_global_loss: 28574502.1515; train_optim_loss: 28574502.1515; val_kl_reg_loss: 135448.9062; val_edge_recon_loss: 2836209.2188; val_gene_expr_recon_loss: 22299128.5000; val_masked_gp_l1_reg_loss: 221486.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141338.4062; val_chrom_access_recon_loss: 2591608.0938; val_global_loss: 28225218.7500; val_optim_loss: 28225218.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9298; val_auprc_score: 0.9079; val_best_acc_score: 0.8657; val_best_f1_score: 0.8731; train_kl_reg_loss: 140493.0765; train_edge_recon_loss: 2787804.2348; train_gene_expr_recon_loss: 22618589.0606; train_masked_gp_l1_reg_loss: 221733.4948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139864.9633; train_chrom_access_recon_loss: 2602113.4394; train_global_loss: 28510598.1818; train_optim_loss: 28510598.1818; val_kl_reg_loss: 135926.4473; val_edge_recon_loss: 2809979.5000; val_gene_expr_recon_loss: 22216112.2500; val_masked_gp_l1_reg_loss: 221805.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139303.3906; val_chrom_access_recon_loss: 2569399.4375; val_global_loss: 28092527.7500; val_optim_loss: 28092527.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9226; val_auprc_score: 0.8910; val_best_acc_score: 0.8638; val_best_f1_score: 0.8721; train_kl_reg_loss: 151700.7164; train_edge_recon_loss: 2861050.5909; train_gene_expr_recon_loss: 22157055.4545; train_masked_gp_l1_reg_loss: 219181.1203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134778.8324; train_chrom_access_recon_loss: 2567667.3182; train_global_loss: 28091434.2121; train_optim_loss: 28091434.2121; val_kl_reg_loss: 95111.2588; val_edge_recon_loss: 2871016.9375; val_gene_expr_recon_loss: 21807821.2500; val_masked_gp_l1_reg_loss: 218784.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134923.8594; val_chrom_access_recon_loss: 2525566.1250; val_global_loss: 27653224.0000; val_optim_loss: 27653224.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9353; val_auprc_score: 0.9110; val_best_acc_score: 0.8764; val_best_f1_score: 0.8830; train_kl_reg_loss: 152121.0196; train_edge_recon_loss: 2821058.8864; train_gene_expr_recon_loss: 22073023.1212; train_masked_gp_l1_reg_loss: 218782.0502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134632.3189; train_chrom_access_recon_loss: 2533461.5455; train_global_loss: 27933078.9394; train_optim_loss: 27933078.9394; val_kl_reg_loss: 106719.8906; val_edge_recon_loss: 2820178.1875; val_gene_expr_recon_loss: 21597494.5000; val_masked_gp_l1_reg_loss: 218600.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135325.0781; val_chrom_access_recon_loss: 2507476.9375; val_global_loss: 27385795.7500; val_optim_loss: 27385795.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9306; val_auprc_score: 0.9044; val_best_acc_score: 0.8729; val_best_f1_score: 0.8803; train_kl_reg_loss: 145643.6349; train_edge_recon_loss: 2801762.1288; train_gene_expr_recon_loss: 22014322.3030; train_masked_gp_l1_reg_loss: 218596.7261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134360.2583; train_chrom_access_recon_loss: 2526099.2614; train_global_loss: 27840784.3636; train_optim_loss: 27840784.3636; val_kl_reg_loss: 110008.1309; val_edge_recon_loss: 2825280.4688; val_gene_expr_recon_loss: 21688111.0000; val_masked_gp_l1_reg_loss: 218312.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133307.7969; val_chrom_access_recon_loss: 2490195.6562; val_global_loss: 27465215.7500; val_optim_loss: 27465215.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9350; val_auprc_score: 0.9107; val_best_acc_score: 0.8764; val_best_f1_score: 0.8831; train_kl_reg_loss: 141055.4957; train_edge_recon_loss: 2788471.6212; train_gene_expr_recon_loss: 21995359.6667; train_masked_gp_l1_reg_loss: 217982.3892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133840.6300; train_chrom_access_recon_loss: 2519682.2235; train_global_loss: 27796391.8182; train_optim_loss: 27796391.8182; val_kl_reg_loss: 118183.3359; val_edge_recon_loss: 2813477.5938; val_gene_expr_recon_loss: 21675918.7500; val_masked_gp_l1_reg_loss: 217491.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132975.1406; val_chrom_access_recon_loss: 2491270.1875; val_global_loss: 27449317.7500; val_optim_loss: 27449317.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9322; val_auprc_score: 0.9040; val_best_acc_score: 0.8745; val_best_f1_score: 0.8806; train_kl_reg_loss: 137975.4238; train_edge_recon_loss: 2784485.5227; train_gene_expr_recon_loss: 21943554.4848; train_masked_gp_l1_reg_loss: 217113.0975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133072.6747; train_chrom_access_recon_loss: 2513512.3561; train_global_loss: 27729713.4848; train_optim_loss: 27729713.4848; val_kl_reg_loss: 118514.6289; val_edge_recon_loss: 2817948.4688; val_gene_expr_recon_loss: 21531362.5000; val_masked_gp_l1_reg_loss: 216704.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132522.3906; val_chrom_access_recon_loss: 2475995.5938; val_global_loss: 27293047.0000; val_optim_loss: 27293047.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9407; val_auprc_score: 0.9193; val_best_acc_score: 0.8831; val_best_f1_score: 0.8884; train_kl_reg_loss: 136041.5378; train_edge_recon_loss: 2783146.7841; train_gene_expr_recon_loss: 21929081.5758; train_masked_gp_l1_reg_loss: 216232.6333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132740.9633; train_chrom_access_recon_loss: 2509570.1098; train_global_loss: 27706813.3939; train_optim_loss: 27706813.3939; val_kl_reg_loss: 122656.6729; val_edge_recon_loss: 2790287.0312; val_gene_expr_recon_loss: 21518835.0000; val_masked_gp_l1_reg_loss: 215774.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132207.2812; val_chrom_access_recon_loss: 2481273.2188; val_global_loss: 27261034.2500; val_optim_loss: 27261034.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9374; val_auprc_score: 0.9127; val_best_acc_score: 0.8818; val_best_f1_score: 0.8879; train_kl_reg_loss: 134461.9847; train_edge_recon_loss: 2773086.6970; train_gene_expr_recon_loss: 21895219.0909; train_masked_gp_l1_reg_loss: 215312.4787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132213.3442; train_chrom_access_recon_loss: 2506554.1023; train_global_loss: 27656847.5758; train_optim_loss: 27656847.5758; val_kl_reg_loss: 123046.0010; val_edge_recon_loss: 2801637.5312; val_gene_expr_recon_loss: 21606081.5000; val_masked_gp_l1_reg_loss: 215182.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133229.9844; val_chrom_access_recon_loss: 2481235.3438; val_global_loss: 27360412.0000; val_optim_loss: 27360412.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9385; val_auprc_score: 0.9136; val_best_acc_score: 0.8888; val_best_f1_score: 0.8935; train_kl_reg_loss: 133948.0291; train_edge_recon_loss: 2763760.9659; train_gene_expr_recon_loss: 21846343.6667; train_masked_gp_l1_reg_loss: 214791.0490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132093.3517; train_chrom_access_recon_loss: 2501009.1364; train_global_loss: 27591945.9697; train_optim_loss: 27591945.9697; val_kl_reg_loss: 121578.3281; val_edge_recon_loss: 2809656.1250; val_gene_expr_recon_loss: 21499470.5000; val_masked_gp_l1_reg_loss: 214584.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131495.0000; val_chrom_access_recon_loss: 2500839.5625; val_global_loss: 27277624.0000; val_optim_loss: 27277624.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9518; val_auprc_score: 0.9367; val_best_acc_score: 0.8949; val_best_f1_score: 0.8992; train_kl_reg_loss: 133920.2580; train_edge_recon_loss: 2773006.5000; train_gene_expr_recon_loss: 21813490.1818; train_masked_gp_l1_reg_loss: 214218.5689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131435.3411; train_chrom_access_recon_loss: 2497529.1439; train_global_loss: 27563599.8182; train_optim_loss: 27563599.8182; val_kl_reg_loss: 124597.5303; val_edge_recon_loss: 2749993.4688; val_gene_expr_recon_loss: 21375704.7500; val_masked_gp_l1_reg_loss: 214207.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131083.9531; val_chrom_access_recon_loss: 2458033.9062; val_global_loss: 27053622.0000; val_optim_loss: 27053622.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9411; val_auprc_score: 0.9132; val_best_acc_score: 0.8855; val_best_f1_score: 0.8906; train_kl_reg_loss: 131396.7038; train_edge_recon_loss: 2767472.5871; train_gene_expr_recon_loss: 21763572.3939; train_masked_gp_l1_reg_loss: 213957.4226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131298.8781; train_chrom_access_recon_loss: 2489709.6477; train_global_loss: 27497407.5758; train_optim_loss: 27497407.5758; val_kl_reg_loss: 126899.2061; val_edge_recon_loss: 2806251.6562; val_gene_expr_recon_loss: 21536636.5000; val_masked_gp_l1_reg_loss: 213945.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131205.7812; val_chrom_access_recon_loss: 2490884.3125; val_global_loss: 27305823.5000; val_optim_loss: 27305823.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9430; val_auprc_score: 0.9213; val_best_acc_score: 0.8858; val_best_f1_score: 0.8904; train_kl_reg_loss: 131920.8357; train_edge_recon_loss: 2755361.9962; train_gene_expr_recon_loss: 21766970.3939; train_masked_gp_l1_reg_loss: 213680.5573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130820.0737; train_chrom_access_recon_loss: 2490083.6023; train_global_loss: 27488837.6061; train_optim_loss: 27488837.6061; val_kl_reg_loss: 126251.7012; val_edge_recon_loss: 2823264.4062; val_gene_expr_recon_loss: 21617670.2500; val_masked_gp_l1_reg_loss: 213615.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131041.2266; val_chrom_access_recon_loss: 2506867.4375; val_global_loss: 27418711.2500; val_optim_loss: 27418711.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9496; val_auprc_score: 0.9296; val_best_acc_score: 0.8974; val_best_f1_score: 0.9003; train_kl_reg_loss: 132557.5823; train_edge_recon_loss: 2757966.8750; train_gene_expr_recon_loss: 21730536.4848; train_masked_gp_l1_reg_loss: 213468.5518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130599.2544; train_chrom_access_recon_loss: 2486775.7576; train_global_loss: 27451904.4242; train_optim_loss: 27451904.4242; val_kl_reg_loss: 125977.6250; val_edge_recon_loss: 2778129.3750; val_gene_expr_recon_loss: 21243839.5000; val_masked_gp_l1_reg_loss: 213630.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131839.5625; val_chrom_access_recon_loss: 2465894.8750; val_global_loss: 26959311.0000; val_optim_loss: 26959311.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9463; val_auprc_score: 0.9187; val_best_acc_score: 0.8941; val_best_f1_score: 0.8987; train_kl_reg_loss: 131802.5485; train_edge_recon_loss: 2758635.8068; train_gene_expr_recon_loss: 21698830.4242; train_masked_gp_l1_reg_loss: 213506.8049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130790.8590; train_chrom_access_recon_loss: 2482131.2121; train_global_loss: 27415697.6061; train_optim_loss: 27415697.6061; val_kl_reg_loss: 126041.1348; val_edge_recon_loss: 2776382.1250; val_gene_expr_recon_loss: 21541571.2500; val_masked_gp_l1_reg_loss: 213463.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130482.0859; val_chrom_access_recon_loss: 2526140.5312; val_global_loss: 27314081.0000; val_optim_loss: 27314081.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9506; val_auprc_score: 0.9343; val_best_acc_score: 0.8963; val_best_f1_score: 0.8997; train_kl_reg_loss: 130083.8340; train_edge_recon_loss: 2757436.7045; train_gene_expr_recon_loss: 21680297.3939; train_masked_gp_l1_reg_loss: 213383.4370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130187.7955; train_chrom_access_recon_loss: 2480917.7311; train_global_loss: 27392306.9697; train_optim_loss: 27392306.9697; val_kl_reg_loss: 128222.7822; val_edge_recon_loss: 2786155.5625; val_gene_expr_recon_loss: 21376437.0000; val_masked_gp_l1_reg_loss: 213478.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130379.3828; val_chrom_access_recon_loss: 2464891.0312; val_global_loss: 27099564.7500; val_optim_loss: 27099564.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9498; val_auprc_score: 0.9298; val_best_acc_score: 0.8944; val_best_f1_score: 0.8989; train_kl_reg_loss: 131167.6828; train_edge_recon_loss: 2748391.1061; train_gene_expr_recon_loss: 21666761.1515; train_masked_gp_l1_reg_loss: 213529.8267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130130.7544; train_chrom_access_recon_loss: 2477635.5303; train_global_loss: 27367615.6970; train_optim_loss: 27367615.6970; val_kl_reg_loss: 132342.8613; val_edge_recon_loss: 2770540.0938; val_gene_expr_recon_loss: 21245363.2500; val_masked_gp_l1_reg_loss: 213357.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129801.7422; val_chrom_access_recon_loss: 2460251.7500; val_global_loss: 26951658.0000; val_optim_loss: 26951658.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9472; val_auprc_score: 0.9204; val_best_acc_score: 0.8963; val_best_f1_score: 0.8999; train_kl_reg_loss: 131468.5653; train_edge_recon_loss: 2754463.3523; train_gene_expr_recon_loss: 21636938.9697; train_masked_gp_l1_reg_loss: 213447.1911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129891.3454; train_chrom_access_recon_loss: 2475059.9811; train_global_loss: 27341269.6364; train_optim_loss: 27341269.6364; val_kl_reg_loss: 127671.3047; val_edge_recon_loss: 2772389.3750; val_gene_expr_recon_loss: 21206000.7500; val_masked_gp_l1_reg_loss: 213488.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129457.6875; val_chrom_access_recon_loss: 2468213.5625; val_global_loss: 26917221.2500; val_optim_loss: 26917221.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9581; val_auprc_score: 0.9354; val_best_acc_score: 0.9130; val_best_f1_score: 0.9153; train_kl_reg_loss: 130135.1255; train_edge_recon_loss: 2755395.7159; train_gene_expr_recon_loss: 21622462.3939; train_masked_gp_l1_reg_loss: 213453.4545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129552.4921; train_chrom_access_recon_loss: 2472965.1742; train_global_loss: 27323964.2121; train_optim_loss: 27323964.2121; val_kl_reg_loss: 125407.9072; val_edge_recon_loss: 2755284.4688; val_gene_expr_recon_loss: 21191505.5000; val_masked_gp_l1_reg_loss: 213866.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129844.2266; val_chrom_access_recon_loss: 2440127.9062; val_global_loss: 26856035.2500; val_optim_loss: 26856035.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9529; val_auprc_score: 0.9324; val_best_acc_score: 0.9044; val_best_f1_score: 0.9069; train_kl_reg_loss: 129297.2737; train_edge_recon_loss: 2739657.5076; train_gene_expr_recon_loss: 21604993.4545; train_masked_gp_l1_reg_loss: 213975.4711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129731.4305; train_chrom_access_recon_loss: 2472896.0114; train_global_loss: 27290550.9394; train_optim_loss: 27290550.9394; val_kl_reg_loss: 125164.7646; val_edge_recon_loss: 2757326.5312; val_gene_expr_recon_loss: 21389805.0000; val_masked_gp_l1_reg_loss: 214062.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130110.5312; val_chrom_access_recon_loss: 2462066.2812; val_global_loss: 27078534.7500; val_optim_loss: 27078534.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9528; val_auprc_score: 0.9342; val_best_acc_score: 0.9025; val_best_f1_score: 0.9059; train_kl_reg_loss: 129834.4452; train_edge_recon_loss: 2751451.0682; train_gene_expr_recon_loss: 21551102.6364; train_masked_gp_l1_reg_loss: 214009.6972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129706.5620; train_chrom_access_recon_loss: 2466887.5758; train_global_loss: 27242992.0000; train_optim_loss: 27242992.0000; val_kl_reg_loss: 127234.9434; val_edge_recon_loss: 2774241.2500; val_gene_expr_recon_loss: 21206622.7500; val_masked_gp_l1_reg_loss: 214231.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128937.8047; val_chrom_access_recon_loss: 2429568.1875; val_global_loss: 26880836.7500; val_optim_loss: 26880836.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9494; val_auprc_score: 0.9254; val_best_acc_score: 0.9019; val_best_f1_score: 0.9057; train_kl_reg_loss: 130627.0558; train_edge_recon_loss: 2744312.7424; train_gene_expr_recon_loss: 21548110.4242; train_masked_gp_l1_reg_loss: 214217.0012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129180.3040; train_chrom_access_recon_loss: 2468549.7197; train_global_loss: 27234997.3939; train_optim_loss: 27234997.3939; val_kl_reg_loss: 128346.3574; val_edge_recon_loss: 2798945.0000; val_gene_expr_recon_loss: 21117799.0000; val_masked_gp_l1_reg_loss: 214254.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128420.5312; val_chrom_access_recon_loss: 2432070.3750; val_global_loss: 26819835.0000; val_optim_loss: 26819835.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9561; val_auprc_score: 0.9357; val_best_acc_score: 0.9100; val_best_f1_score: 0.9124; train_kl_reg_loss: 130181.1147; train_edge_recon_loss: 2749228.1250; train_gene_expr_recon_loss: 21517835.1515; train_masked_gp_l1_reg_loss: 214363.1679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129281.9163; train_chrom_access_recon_loss: 2465637.6553; train_global_loss: 27206527.2424; train_optim_loss: 27206527.2424; val_kl_reg_loss: 126582.2988; val_edge_recon_loss: 2742784.6250; val_gene_expr_recon_loss: 21193745.5000; val_masked_gp_l1_reg_loss: 214546.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129519.0156; val_chrom_access_recon_loss: 2436658.4062; val_global_loss: 26843837.0000; val_optim_loss: 26843837.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9549; val_auprc_score: 0.9386; val_best_acc_score: 0.9060; val_best_f1_score: 0.9101; train_kl_reg_loss: 129426.8996; train_edge_recon_loss: 2748314.9280; train_gene_expr_recon_loss: 21488185.7576; train_masked_gp_l1_reg_loss: 214565.7029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129146.4188; train_chrom_access_recon_loss: 2463842.3258; train_global_loss: 27173482.0909; train_optim_loss: 27173482.0909; val_kl_reg_loss: 126525.4551; val_edge_recon_loss: 2755048.0312; val_gene_expr_recon_loss: 21345318.5000; val_masked_gp_l1_reg_loss: 214789.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128932.7422; val_chrom_access_recon_loss: 2437910.6562; val_global_loss: 27008524.5000; val_optim_loss: 27008524.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9576; val_auprc_score: 0.9425; val_best_acc_score: 0.9019; val_best_f1_score: 0.9054; train_kl_reg_loss: 128456.5537; train_edge_recon_loss: 2741067.0758; train_gene_expr_recon_loss: 21465351.0606; train_masked_gp_l1_reg_loss: 214904.4257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129117.6671; train_chrom_access_recon_loss: 2462571.2955; train_global_loss: 27141468.1818; train_optim_loss: 27141468.1818; val_kl_reg_loss: 124620.1191; val_edge_recon_loss: 2779349.5625; val_gene_expr_recon_loss: 21207060.5000; val_masked_gp_l1_reg_loss: 214944.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129166.9922; val_chrom_access_recon_loss: 2441459.3750; val_global_loss: 26896599.2500; val_optim_loss: 26896599.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9583; val_auprc_score: 0.9419; val_best_acc_score: 0.9062; val_best_f1_score: 0.9102; train_kl_reg_loss: 129119.1014; train_edge_recon_loss: 2742452.1553; train_gene_expr_recon_loss: 21444198.3333; train_masked_gp_l1_reg_loss: 215023.7043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128926.8641; train_chrom_access_recon_loss: 2459062.7197; train_global_loss: 27118782.8485; train_optim_loss: 27118782.8485; val_kl_reg_loss: 127550.5430; val_edge_recon_loss: 2760100.6562; val_gene_expr_recon_loss: 20969781.7500; val_masked_gp_l1_reg_loss: 215257.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128823.8359; val_chrom_access_recon_loss: 2418097.1250; val_global_loss: 26619612.7500; val_optim_loss: 26619612.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9526; val_auprc_score: 0.9318; val_best_acc_score: 0.9041; val_best_f1_score: 0.9065; train_kl_reg_loss: 127879.1114; train_edge_recon_loss: 2756206.2008; train_gene_expr_recon_loss: 21430779.3030; train_masked_gp_l1_reg_loss: 215183.3350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128920.2863; train_chrom_access_recon_loss: 2457025.1439; train_global_loss: 27115993.5152; train_optim_loss: 27115993.5152; val_kl_reg_loss: 125125.9023; val_edge_recon_loss: 2779143.8750; val_gene_expr_recon_loss: 21244226.0000; val_masked_gp_l1_reg_loss: 215286.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128158.0234; val_chrom_access_recon_loss: 2439488.5625; val_global_loss: 26931428.7500; val_optim_loss: 26931428.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9569; val_auprc_score: 0.9390; val_best_acc_score: 0.9057; val_best_f1_score: 0.9090; train_kl_reg_loss: 128648.6849; train_edge_recon_loss: 2748231.9242; train_gene_expr_recon_loss: 21394567.2121; train_masked_gp_l1_reg_loss: 215303.2053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128692.4465; train_chrom_access_recon_loss: 2455398.7462; train_global_loss: 27070842.2727; train_optim_loss: 27070842.2727; val_kl_reg_loss: 127616.8193; val_edge_recon_loss: 2785767.8750; val_gene_expr_recon_loss: 21091064.5000; val_masked_gp_l1_reg_loss: 215218.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128905.3047; val_chrom_access_recon_loss: 2459862.1250; val_global_loss: 26808435.2500; val_optim_loss: 26808435.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9631; val_auprc_score: 0.9473; val_best_acc_score: 0.9130; val_best_f1_score: 0.9150; train_kl_reg_loss: 129597.2324; train_edge_recon_loss: 2744503.0530; train_gene_expr_recon_loss: 21384880.3030; train_masked_gp_l1_reg_loss: 215254.6465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128522.2672; train_chrom_access_recon_loss: 2454866.5492; train_global_loss: 27057624.0303; train_optim_loss: 27057624.0303; val_kl_reg_loss: 125244.6270; val_edge_recon_loss: 2759185.8750; val_gene_expr_recon_loss: 21387592.0000; val_masked_gp_l1_reg_loss: 215261.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128780.5469; val_chrom_access_recon_loss: 2473912.0000; val_global_loss: 27089976.5000; val_optim_loss: 27089976.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9557; val_auprc_score: 0.9345; val_best_acc_score: 0.9065; val_best_f1_score: 0.9106; train_kl_reg_loss: 128597.6072; train_edge_recon_loss: 2742939.8333; train_gene_expr_recon_loss: 21371190.0909; train_masked_gp_l1_reg_loss: 215416.1442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128482.3886; train_chrom_access_recon_loss: 2453602.7727; train_global_loss: 27040228.7273; train_optim_loss: 27040228.7273; val_kl_reg_loss: 125986.0674; val_edge_recon_loss: 2773955.4688; val_gene_expr_recon_loss: 21008003.2500; val_masked_gp_l1_reg_loss: 215462.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128072.5703; val_chrom_access_recon_loss: 2430031.0938; val_global_loss: 26681510.2500; val_optim_loss: 26681510.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9638; val_auprc_score: 0.9503; val_best_acc_score: 0.9156; val_best_f1_score: 0.9181; train_kl_reg_loss: 129419.2050; train_edge_recon_loss: 2733895.3561; train_gene_expr_recon_loss: 21340242.1818; train_masked_gp_l1_reg_loss: 212259.4328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97127.4497; train_chrom_access_recon_loss: 2449570.5606; train_global_loss: 26962514.3333; train_optim_loss: 26962514.3333; val_kl_reg_loss: 127337.0654; val_edge_recon_loss: 2746346.7188; val_gene_expr_recon_loss: 21180804.7500; val_masked_gp_l1_reg_loss: 210908.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91198.6953; val_chrom_access_recon_loss: 2433754.1875; val_global_loss: 26790349.0000; val_optim_loss: 26790349.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9550; val_auprc_score: 0.9410; val_best_acc_score: 0.9052; val_best_f1_score: 0.9095; train_kl_reg_loss: 130516.7324; train_edge_recon_loss: 2739690.6439; train_gene_expr_recon_loss: 21320815.1212; train_masked_gp_l1_reg_loss: 210603.9055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90720.8445; train_chrom_access_recon_loss: 2448840.2841; train_global_loss: 26941187.6061; train_optim_loss: 26941187.6061; val_kl_reg_loss: 128150.3662; val_edge_recon_loss: 2769220.8750; val_gene_expr_recon_loss: 21112865.2500; val_masked_gp_l1_reg_loss: 210350.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90302.7188; val_chrom_access_recon_loss: 2424693.1250; val_global_loss: 26735582.2500; val_optim_loss: 26735582.2500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9567; val_auprc_score: 0.9396; val_best_acc_score: 0.9052; val_best_f1_score: 0.9088; train_kl_reg_loss: 130955.6761; train_edge_recon_loss: 2739940.0606; train_gene_expr_recon_loss: 21309470.3333; train_masked_gp_l1_reg_loss: 210251.1605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90102.4297; train_chrom_access_recon_loss: 2445951.6856; train_global_loss: 26926671.3939; train_optim_loss: 26926671.3939; val_kl_reg_loss: 129393.5605; val_edge_recon_loss: 2769768.2500; val_gene_expr_recon_loss: 21189224.2500; val_masked_gp_l1_reg_loss: 210180.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89786.8906; val_chrom_access_recon_loss: 2426231.5312; val_global_loss: 26814583.7500; val_optim_loss: 26814583.7500
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9566; val_auprc_score: 0.9357; val_best_acc_score: 0.9057; val_best_f1_score: 0.9094; train_kl_reg_loss: 131085.8409; train_edge_recon_loss: 2734104.4129; train_gene_expr_recon_loss: 21321355.9394; train_masked_gp_l1_reg_loss: 210111.4988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89631.2914; train_chrom_access_recon_loss: 2448854.8030; train_global_loss: 26935143.6667; train_optim_loss: 26935143.6667; val_kl_reg_loss: 129448.6084; val_edge_recon_loss: 2757874.5312; val_gene_expr_recon_loss: 21044969.5000; val_masked_gp_l1_reg_loss: 210067.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89566.8125; val_chrom_access_recon_loss: 2442680.9375; val_global_loss: 26674607.2500; val_optim_loss: 26674607.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 45 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9517
val AUPRC score: 0.9332
val best accuracy score: 0.8982
val best F1 score: 0.9033
val target rna MSE score: 0.9608
val source rna MSE score: 0.3734
val target atac MSE score: 0.3293
val source atac MSE score: 0.0713
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
