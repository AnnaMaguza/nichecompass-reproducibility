[True, False, True]
Run timestamp: 03092023_011939_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 556628
Number of validation nodes: 61848
Number of training edges: 1316511
Number of validation edges: 146278
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9210; val_auprc_score: 0.9848; val_best_acc_score: 0.9264; val_best_f1_score: 0.9586; train_kl_reg_loss: 14884.5163; train_edge_recon_loss: 713713.2365; train_gene_expr_recon_loss: 2524216.4574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59435.5147; train_global_loss: 3312249.7249; train_optim_loss: 3312249.7249; val_kl_reg_loss: 15371.7927; val_edge_recon_loss: 719569.4137; val_gene_expr_recon_loss: 2192045.3549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16245.2637; val_global_loss: 2943231.8094; val_optim_loss: 2943231.8094
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9337; val_auprc_score: 0.9873; val_best_acc_score: 0.9323; val_best_f1_score: 0.9617; train_kl_reg_loss: 16174.4399; train_edge_recon_loss: 688528.5979; train_gene_expr_recon_loss: 2064127.8390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16457.1944; train_global_loss: 2785288.0710; train_optim_loss: 2785288.0710; val_kl_reg_loss: 17170.8207; val_edge_recon_loss: 717329.6541; val_gene_expr_recon_loss: 1990310.9323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16548.2617; val_global_loss: 2741359.6521; val_optim_loss: 2741359.6521
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9398; val_auprc_score: 0.9888; val_best_acc_score: 0.9358; val_best_f1_score: 0.9638; train_kl_reg_loss: 17630.7671; train_edge_recon_loss: 687555.1118; train_gene_expr_recon_loss: 1952961.5591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16578.3668; train_global_loss: 2674725.8055; train_optim_loss: 2674725.8055; val_kl_reg_loss: 17825.2113; val_edge_recon_loss: 715030.8372; val_gene_expr_recon_loss: 1932195.7373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16767.6426; val_global_loss: 2681819.5385; val_optim_loss: 2681819.5385
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9406; val_auprc_score: 0.9890; val_best_acc_score: 0.9339; val_best_f1_score: 0.9627; train_kl_reg_loss: 18409.1532; train_edge_recon_loss: 687982.4730; train_gene_expr_recon_loss: 1908081.0870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16691.3123; train_global_loss: 2631164.0245; train_optim_loss: 2631164.0245; val_kl_reg_loss: 18971.4270; val_edge_recon_loss: 727254.2616; val_gene_expr_recon_loss: 1897143.5372; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16802.2070; val_global_loss: 2660171.4790; val_optim_loss: 2660171.4790
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9422; val_auprc_score: 0.9891; val_best_acc_score: 0.9376; val_best_f1_score: 0.9648; train_kl_reg_loss: 18994.1552; train_edge_recon_loss: 688977.4576; train_gene_expr_recon_loss: 1885142.4110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16835.3715; train_global_loss: 2609949.3937; train_optim_loss: 2609949.3937; val_kl_reg_loss: 19348.7511; val_edge_recon_loss: 716196.6128; val_gene_expr_recon_loss: 1877982.9384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17029.4121; val_global_loss: 2630557.8033; val_optim_loss: 2630557.8033
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9466; val_auprc_score: 0.9901; val_best_acc_score: 0.9398; val_best_f1_score: 0.9659; train_kl_reg_loss: 19416.7448; train_edge_recon_loss: 689807.6763; train_gene_expr_recon_loss: 1866872.6039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16949.7097; train_global_loss: 2593046.7332; train_optim_loss: 2593046.7332; val_kl_reg_loss: 19691.8149; val_edge_recon_loss: 711709.8998; val_gene_expr_recon_loss: 1864257.6394; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17062.9980; val_global_loss: 2612722.3531; val_optim_loss: 2612722.3531
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9460; val_auprc_score: 0.9899; val_best_acc_score: 0.9394; val_best_f1_score: 0.9658; train_kl_reg_loss: 19946.9095; train_edge_recon_loss: 690294.0232; train_gene_expr_recon_loss: 1854621.3336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17101.2392; train_global_loss: 2581963.5046; train_optim_loss: 2581963.5046; val_kl_reg_loss: 20194.7871; val_edge_recon_loss: 716990.7102; val_gene_expr_recon_loss: 1852926.1075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17270.8730; val_global_loss: 2607382.3505; val_optim_loss: 2607382.3505
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9493; val_auprc_score: 0.9905; val_best_acc_score: 0.9413; val_best_f1_score: 0.9668; train_kl_reg_loss: 20395.2197; train_edge_recon_loss: 689237.0899; train_gene_expr_recon_loss: 1844744.7379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17321.1062; train_global_loss: 2571698.1504; train_optim_loss: 2571698.1504; val_kl_reg_loss: 20962.3798; val_edge_recon_loss: 717231.2100; val_gene_expr_recon_loss: 1848120.4926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17366.9355; val_global_loss: 2603681.0778; val_optim_loss: 2603681.0778
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9507; val_auprc_score: 0.9909; val_best_acc_score: 0.9424; val_best_f1_score: 0.9674; train_kl_reg_loss: 20800.4599; train_edge_recon_loss: 689268.6987; train_gene_expr_recon_loss: 1832076.5973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17446.9940; train_global_loss: 2559592.7481; train_optim_loss: 2559592.7481; val_kl_reg_loss: 20917.3218; val_edge_recon_loss: 710548.9308; val_gene_expr_recon_loss: 1834239.1525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17583.5195; val_global_loss: 2583288.9091; val_optim_loss: 2583288.9091
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9488; val_auprc_score: 0.9905; val_best_acc_score: 0.9407; val_best_f1_score: 0.9664; train_kl_reg_loss: 21192.2538; train_edge_recon_loss: 688697.5442; train_gene_expr_recon_loss: 1827149.4254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17550.7188; train_global_loss: 2554589.9437; train_optim_loss: 2554589.9437; val_kl_reg_loss: 21662.3992; val_edge_recon_loss: 721063.3916; val_gene_expr_recon_loss: 1833828.1718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17451.6777; val_global_loss: 2594005.7142; val_optim_loss: 2594005.7142
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9286; val_auprc_score: 0.9860; val_best_acc_score: 0.9307; val_best_f1_score: 0.9610; train_kl_reg_loss: 21266.7749; train_edge_recon_loss: 692075.2038; train_gene_expr_recon_loss: 1887709.2336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18107.4956; train_global_loss: 2619158.7043; train_optim_loss: 2619158.7043; val_kl_reg_loss: 17109.3987; val_edge_recon_loss: 718497.8293; val_gene_expr_recon_loss: 2296600.4642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18378.2324; val_global_loss: 3050585.9379; val_optim_loss: 3050585.9379
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9502; val_auprc_score: 0.9908; val_best_acc_score: 0.9421; val_best_f1_score: 0.9673; train_kl_reg_loss: 20801.0960; train_edge_recon_loss: 689719.8352; train_gene_expr_recon_loss: 1968504.9415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17909.2631; train_global_loss: 2696935.1346; train_optim_loss: 2696935.1346; val_kl_reg_loss: 22226.7442; val_edge_recon_loss: 713415.3765; val_gene_expr_recon_loss: 1873784.3059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17574.7285; val_global_loss: 2627001.1740; val_optim_loss: 2627001.1740
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9523; val_auprc_score: 0.9912; val_best_acc_score: 0.9421; val_best_f1_score: 0.9672; train_kl_reg_loss: 22430.3679; train_edge_recon_loss: 687488.2643; train_gene_expr_recon_loss: 1842072.9547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17801.3764; train_global_loss: 2569792.9651; train_optim_loss: 2569792.9651; val_kl_reg_loss: 22764.1464; val_edge_recon_loss: 720093.9117; val_gene_expr_recon_loss: 1834390.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17906.5352; val_global_loss: 2595154.6530; val_optim_loss: 2595154.6530

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9542; val_auprc_score: 0.9915; val_best_acc_score: 0.9434; val_best_f1_score: 0.9679; train_kl_reg_loss: 22419.2531; train_edge_recon_loss: 685973.1173; train_gene_expr_recon_loss: 1796183.5151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8803.2153; train_global_loss: 2513379.0990; train_optim_loss: 2513379.0990; val_kl_reg_loss: 22519.9158; val_edge_recon_loss: 717993.5951; val_gene_expr_recon_loss: 1800313.9156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8781.9531; val_global_loss: 2549609.4301; val_optim_loss: 2549609.4301
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9540; val_auprc_score: 0.9917; val_best_acc_score: 0.9436; val_best_f1_score: 0.9681; train_kl_reg_loss: 22207.5533; train_edge_recon_loss: 686704.5127; train_gene_expr_recon_loss: 1786569.6474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8784.9429; train_global_loss: 2504266.6557; train_optim_loss: 2504266.6557; val_kl_reg_loss: 22209.4326; val_edge_recon_loss: 705973.4913; val_gene_expr_recon_loss: 1792956.6302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8741.6006; val_global_loss: 2529881.0533; val_optim_loss: 2529881.0533
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9548; val_auprc_score: 0.9918; val_best_acc_score: 0.9436; val_best_f1_score: 0.9681; train_kl_reg_loss: 21858.8862; train_edge_recon_loss: 685230.6171; train_gene_expr_recon_loss: 1781649.6974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8802.2708; train_global_loss: 2497541.4722; train_optim_loss: 2497541.4722; val_kl_reg_loss: 21837.8834; val_edge_recon_loss: 713574.2979; val_gene_expr_recon_loss: 1788854.8597; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8775.5439; val_global_loss: 2533042.5437; val_optim_loss: 2533042.5437
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9540; val_auprc_score: 0.9917; val_best_acc_score: 0.9442; val_best_f1_score: 0.9684; train_kl_reg_loss: 21670.7447; train_edge_recon_loss: 688363.6357; train_gene_expr_recon_loss: 1777652.7004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8849.6910; train_global_loss: 2496536.7709; train_optim_loss: 2496536.7709; val_kl_reg_loss: 21689.4191; val_edge_recon_loss: 711276.5174; val_gene_expr_recon_loss: 1787217.4222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8895.2285; val_global_loss: 2529078.6154; val_optim_loss: 2529078.6154
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9540; val_auprc_score: 0.9916; val_best_acc_score: 0.9434; val_best_f1_score: 0.9680; train_kl_reg_loss: 21535.7570; train_edge_recon_loss: 685726.7757; train_gene_expr_recon_loss: 1774899.4701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8905.9317; train_global_loss: 2491067.9341; train_optim_loss: 2491067.9341; val_kl_reg_loss: 21742.4865; val_edge_recon_loss: 719027.2507; val_gene_expr_recon_loss: 1782097.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8905.5508; val_global_loss: 2531772.6460; val_optim_loss: 2531772.6460
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9538; val_auprc_score: 0.9916; val_best_acc_score: 0.9446; val_best_f1_score: 0.9686; train_kl_reg_loss: 21452.1566; train_edge_recon_loss: 686369.7881; train_gene_expr_recon_loss: 1773146.3776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8935.5808; train_global_loss: 2489903.9023; train_optim_loss: 2489903.9023; val_kl_reg_loss: 21502.8729; val_edge_recon_loss: 711844.9803; val_gene_expr_recon_loss: 1783415.2194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8882.6201; val_global_loss: 2525645.5752; val_optim_loss: 2525645.5752
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9543; val_auprc_score: 0.9915; val_best_acc_score: 0.9441; val_best_f1_score: 0.9684; train_kl_reg_loss: 21321.1405; train_edge_recon_loss: 686641.6053; train_gene_expr_recon_loss: 1771178.0650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8958.3476; train_global_loss: 2488099.1569; train_optim_loss: 2488099.1569; val_kl_reg_loss: 21356.0297; val_edge_recon_loss: 714024.5028; val_gene_expr_recon_loss: 1781484.6298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8972.7852; val_global_loss: 2525837.9091; val_optim_loss: 2525837.9091
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9559; val_auprc_score: 0.9919; val_best_acc_score: 0.9444; val_best_f1_score: 0.9685; train_kl_reg_loss: 21191.5245; train_edge_recon_loss: 687073.1831; train_gene_expr_recon_loss: 1769817.2710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8977.6590; train_global_loss: 2487059.6384; train_optim_loss: 2487059.6384; val_kl_reg_loss: 21231.9283; val_edge_recon_loss: 714410.6035; val_gene_expr_recon_loss: 1779034.5826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8946.6270; val_global_loss: 2523623.8628; val_optim_loss: 2523623.8628
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9551; val_auprc_score: 0.9919; val_best_acc_score: 0.9444; val_best_f1_score: 0.9685; train_kl_reg_loss: 21091.3185; train_edge_recon_loss: 687347.4881; train_gene_expr_recon_loss: 1768328.1017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9008.4020; train_global_loss: 2485775.3126; train_optim_loss: 2485775.3126; val_kl_reg_loss: 21253.5719; val_edge_recon_loss: 709559.3680; val_gene_expr_recon_loss: 1776501.0354; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9032.6670; val_global_loss: 2516346.7360; val_optim_loss: 2516346.7360
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9544; val_auprc_score: 0.9916; val_best_acc_score: 0.9443; val_best_f1_score: 0.9685; train_kl_reg_loss: 21044.2011; train_edge_recon_loss: 685450.4367; train_gene_expr_recon_loss: 1767396.3710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9046.2520; train_global_loss: 2482937.2595; train_optim_loss: 2482937.2595; val_kl_reg_loss: 21214.7668; val_edge_recon_loss: 712995.0679; val_gene_expr_recon_loss: 1778795.6831; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9089.4170; val_global_loss: 2522095.0184; val_optim_loss: 2522095.0184
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9550; val_auprc_score: 0.9916; val_best_acc_score: 0.9449; val_best_f1_score: 0.9687; train_kl_reg_loss: 20972.1460; train_edge_recon_loss: 684420.0251; train_gene_expr_recon_loss: 1765913.9754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9088.9642; train_global_loss: 2480395.1129; train_optim_loss: 2480395.1129; val_kl_reg_loss: 20990.9458; val_edge_recon_loss: 718744.0715; val_gene_expr_recon_loss: 1775547.7753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9045.7744; val_global_loss: 2524328.5376; val_optim_loss: 2524328.5376
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9567; val_auprc_score: 0.9921; val_best_acc_score: 0.9445; val_best_f1_score: 0.9685; train_kl_reg_loss: 20880.9449; train_edge_recon_loss: 685715.1697; train_gene_expr_recon_loss: 1765175.6117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9125.7550; train_global_loss: 2480897.4782; train_optim_loss: 2480897.4782; val_kl_reg_loss: 21086.0583; val_edge_recon_loss: 718687.9572; val_gene_expr_recon_loss: 1774293.2107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9143.2236; val_global_loss: 2523210.4747; val_optim_loss: 2523210.4747
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9476; val_auprc_score: 0.9901; val_best_acc_score: 0.9398; val_best_f1_score: 0.9659; train_kl_reg_loss: 20549.2848; train_edge_recon_loss: 688702.4686; train_gene_expr_recon_loss: 1713650.5506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8208.6815; train_global_loss: 2431110.9850; train_optim_loss: 2431110.9850; val_kl_reg_loss: 17509.4252; val_edge_recon_loss: 725764.4850; val_gene_expr_recon_loss: 1715970.7238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7916.8677; val_global_loss: 2467161.3776; val_optim_loss: 2467161.3776
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9471; val_auprc_score: 0.9902; val_best_acc_score: 0.9402; val_best_f1_score: 0.9662; train_kl_reg_loss: 20257.0521; train_edge_recon_loss: 688294.0753; train_gene_expr_recon_loss: 1703733.3745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7933.7184; train_global_loss: 2420218.2203; train_optim_loss: 2420218.2203; val_kl_reg_loss: 17936.4736; val_edge_recon_loss: 710363.9047; val_gene_expr_recon_loss: 1712666.7998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7837.0366; val_global_loss: 2448804.1792; val_optim_loss: 2448804.1792
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9489; val_auprc_score: 0.9904; val_best_acc_score: 0.9409; val_best_f1_score: 0.9666; train_kl_reg_loss: 19666.5086; train_edge_recon_loss: 687088.9753; train_gene_expr_recon_loss: 1700970.0998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7939.5381; train_global_loss: 2415665.1212; train_optim_loss: 2415665.1212; val_kl_reg_loss: 18126.1970; val_edge_recon_loss: 721086.6407; val_gene_expr_recon_loss: 1711930.2395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7866.5967; val_global_loss: 2459009.5795; val_optim_loss: 2459009.5795
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9527; val_auprc_score: 0.9915; val_best_acc_score: 0.9428; val_best_f1_score: 0.9677; train_kl_reg_loss: 19324.2691; train_edge_recon_loss: 685943.4195; train_gene_expr_recon_loss: 1699194.7934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7936.0274; train_global_loss: 2412398.5141; train_optim_loss: 2412398.5141; val_kl_reg_loss: 18332.2131; val_edge_recon_loss: 707822.0107; val_gene_expr_recon_loss: 1708015.0162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7942.5425; val_global_loss: 2442111.7395; val_optim_loss: 2442111.7395
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9516; val_auprc_score: 0.9910; val_best_acc_score: 0.9425; val_best_f1_score: 0.9674; train_kl_reg_loss: 19173.4123; train_edge_recon_loss: 685226.5950; train_gene_expr_recon_loss: 1696466.6083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7961.3343; train_global_loss: 2408827.9498; train_optim_loss: 2408827.9498; val_kl_reg_loss: 18489.8877; val_edge_recon_loss: 718319.3132; val_gene_expr_recon_loss: 1706537.5157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7974.3413; val_global_loss: 2451320.9659; val_optim_loss: 2451320.9659
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9508; val_auprc_score: 0.9908; val_best_acc_score: 0.9426; val_best_f1_score: 0.9675; train_kl_reg_loss: 19104.7408; train_edge_recon_loss: 687864.0011; train_gene_expr_recon_loss: 1695549.0293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7970.4695; train_global_loss: 2410488.2406; train_optim_loss: 2410488.2406; val_kl_reg_loss: 18521.5930; val_edge_recon_loss: 719058.4694; val_gene_expr_recon_loss: 1705514.2448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7988.7529; val_global_loss: 2451083.0559; val_optim_loss: 2451083.0559
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9500; val_auprc_score: 0.9908; val_best_acc_score: 0.9404; val_best_f1_score: 0.9663; train_kl_reg_loss: 19098.1509; train_edge_recon_loss: 687009.4695; train_gene_expr_recon_loss: 1693324.2299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7974.3402; train_global_loss: 2407406.1925; train_optim_loss: 2407406.1925; val_kl_reg_loss: 18749.2951; val_edge_recon_loss: 717825.9742; val_gene_expr_recon_loss: 1703598.3715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8013.6919; val_global_loss: 2448187.3872; val_optim_loss: 2448187.3872
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9532; val_auprc_score: 0.9915; val_best_acc_score: 0.9422; val_best_f1_score: 0.9673; train_kl_reg_loss: 19023.3137; train_edge_recon_loss: 687556.0824; train_gene_expr_recon_loss: 1692593.7868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7992.2266; train_global_loss: 2407165.4042; train_optim_loss: 2407165.4042; val_kl_reg_loss: 18719.0875; val_edge_recon_loss: 715363.1735; val_gene_expr_recon_loss: 1703305.6971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7951.4414; val_global_loss: 2445339.4607; val_optim_loss: 2445339.4607

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9524; val_auprc_score: 0.9914; val_best_acc_score: 0.9430; val_best_f1_score: 0.9678; train_kl_reg_loss: 18956.0798; train_edge_recon_loss: 684712.6812; train_gene_expr_recon_loss: 1688708.5964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7167.8748; train_global_loss: 2399545.2323; train_optim_loss: 2399545.2323; val_kl_reg_loss: 18692.6564; val_edge_recon_loss: 711433.9513; val_gene_expr_recon_loss: 1700619.5669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7175.9556; val_global_loss: 2437922.1757; val_optim_loss: 2437922.1757
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9512; val_auprc_score: 0.9911; val_best_acc_score: 0.9430; val_best_f1_score: 0.9678; train_kl_reg_loss: 18964.1868; train_edge_recon_loss: 683537.6602; train_gene_expr_recon_loss: 1688814.6441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7161.7213; train_global_loss: 2398478.2153; train_optim_loss: 2398478.2153; val_kl_reg_loss: 18676.0780; val_edge_recon_loss: 708282.2584; val_gene_expr_recon_loss: 1700975.4340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7169.6143; val_global_loss: 2435103.2797; val_optim_loss: 2435103.2797
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9530; val_auprc_score: 0.9913; val_best_acc_score: 0.9433; val_best_f1_score: 0.9680; train_kl_reg_loss: 18947.6604; train_edge_recon_loss: 687186.5889; train_gene_expr_recon_loss: 1688687.0393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7159.3956; train_global_loss: 2401980.6839; train_optim_loss: 2401980.6839; val_kl_reg_loss: 18664.5348; val_edge_recon_loss: 710606.4958; val_gene_expr_recon_loss: 1702253.9397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7147.1685; val_global_loss: 2438672.2255; val_optim_loss: 2438672.2255
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9533; val_auprc_score: 0.9914; val_best_acc_score: 0.9441; val_best_f1_score: 0.9683; train_kl_reg_loss: 18929.5827; train_edge_recon_loss: 687620.9636; train_gene_expr_recon_loss: 1688800.5922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7165.9599; train_global_loss: 2402517.0992; train_optim_loss: 2402517.0992; val_kl_reg_loss: 18636.0373; val_edge_recon_loss: 709155.3951; val_gene_expr_recon_loss: 1698662.9436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7170.1021; val_global_loss: 2433624.3811; val_optim_loss: 2433624.3811
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9521; val_auprc_score: 0.9912; val_best_acc_score: 0.9418; val_best_f1_score: 0.9671; train_kl_reg_loss: 18939.0990; train_edge_recon_loss: 685304.5689; train_gene_expr_recon_loss: 1688577.8403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7166.7223; train_global_loss: 2399988.2296; train_optim_loss: 2399988.2296; val_kl_reg_loss: 18707.7638; val_edge_recon_loss: 715334.1618; val_gene_expr_recon_loss: 1700151.3698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7164.4888; val_global_loss: 2441357.7963; val_optim_loss: 2441357.7963
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9527; val_auprc_score: 0.9913; val_best_acc_score: 0.9429; val_best_f1_score: 0.9677; train_kl_reg_loss: 18932.1744; train_edge_recon_loss: 684622.6365; train_gene_expr_recon_loss: 1687926.1477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7165.5015; train_global_loss: 2398646.4614; train_optim_loss: 2398646.4614; val_kl_reg_loss: 18700.0663; val_edge_recon_loss: 717044.4104; val_gene_expr_recon_loss: 1699576.5940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7166.1899; val_global_loss: 2442487.3199; val_optim_loss: 2442487.3199
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9530; val_auprc_score: 0.9913; val_best_acc_score: 0.9431; val_best_f1_score: 0.9678; train_kl_reg_loss: 18942.5751; train_edge_recon_loss: 683341.5234; train_gene_expr_recon_loss: 1688712.1590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7165.4152; train_global_loss: 2398161.6727; train_optim_loss: 2398161.6727; val_kl_reg_loss: 18693.7895; val_edge_recon_loss: 716623.7209; val_gene_expr_recon_loss: 1699532.6862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7178.3481; val_global_loss: 2442028.4493; val_optim_loss: 2442028.4493
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9533; val_auprc_score: 0.9916; val_best_acc_score: 0.9433; val_best_f1_score: 0.9680; train_kl_reg_loss: 18927.9535; train_edge_recon_loss: 683420.2276; train_gene_expr_recon_loss: 1687737.4007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7170.2137; train_global_loss: 2397255.7950; train_optim_loss: 2397255.7950; val_kl_reg_loss: 18696.0745; val_edge_recon_loss: 708032.5347; val_gene_expr_recon_loss: 1701040.5363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7171.3960; val_global_loss: 2434940.6477; val_optim_loss: 2434940.6477

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9525; val_auprc_score: 0.9913; val_best_acc_score: 0.9432; val_best_f1_score: 0.9679; train_kl_reg_loss: 18917.9196; train_edge_recon_loss: 685308.1735; train_gene_expr_recon_loss: 1686864.8142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7080.8657; train_global_loss: 2398171.7748; train_optim_loss: 2398171.7748; val_kl_reg_loss: 18694.7769; val_edge_recon_loss: 714090.5935; val_gene_expr_recon_loss: 1701096.3226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7077.3223; val_global_loss: 2440958.9484; val_optim_loss: 2440958.9484
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9522; val_auprc_score: 0.9913; val_best_acc_score: 0.9430; val_best_f1_score: 0.9678; train_kl_reg_loss: 18916.1834; train_edge_recon_loss: 684627.9446; train_gene_expr_recon_loss: 1687095.4030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7075.9839; train_global_loss: 2397715.5158; train_optim_loss: 2397715.5158; val_kl_reg_loss: 18691.8644; val_edge_recon_loss: 712598.6101; val_gene_expr_recon_loss: 1700202.0424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7076.1577; val_global_loss: 2438568.7640; val_optim_loss: 2438568.7640
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9537; val_auprc_score: 0.9915; val_best_acc_score: 0.9437; val_best_f1_score: 0.9681; train_kl_reg_loss: 18919.6715; train_edge_recon_loss: 684464.7414; train_gene_expr_recon_loss: 1687430.9890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7075.8471; train_global_loss: 2397891.2510; train_optim_loss: 2397891.2510; val_kl_reg_loss: 18691.5380; val_edge_recon_loss: 715399.8396; val_gene_expr_recon_loss: 1701688.8444; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7077.7700; val_global_loss: 2442857.9781; val_optim_loss: 2442857.9781
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9525; val_auprc_score: 0.9913; val_best_acc_score: 0.9429; val_best_f1_score: 0.9677; train_kl_reg_loss: 18917.0912; train_edge_recon_loss: 685456.0800; train_gene_expr_recon_loss: 1687683.9175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7076.2811; train_global_loss: 2399133.3697; train_optim_loss: 2399133.3697; val_kl_reg_loss: 18701.5995; val_edge_recon_loss: 712796.4113; val_gene_expr_recon_loss: 1700949.3920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7077.9580; val_global_loss: 2439525.3977; val_optim_loss: 2439525.3977

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1017 min 11 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9528
val AUPRC score: 0.9913
val best accuracy score: 0.9437
val best F1 score: 0.9681
val target rna MSE score: 0.4759
val source rna MSE score: 0.1201
Val cat covariate0 mean sim diff: -0.0004
Val cat covariate1 mean sim diff: -0.0480
Val cat covariate2 mean sim diff: -0.0003

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
