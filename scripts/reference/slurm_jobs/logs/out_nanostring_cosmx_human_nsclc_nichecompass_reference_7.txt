[True, False, True]
Run timestamp: 05092023_121353_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '500000.0', '--contrastive_logits_pos_ratio', '0.0078125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 556628
Number of validation nodes: 61848
Number of training edges: 1316511
Number of validation edges: 146278
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9033; val_auprc_score: 0.9804; val_best_acc_score: 0.9197; val_best_f1_score: 0.9550; train_kl_reg_loss: 14865.8559; train_edge_recon_loss: 719485.1057; train_cat_covariates_contrastive_loss: 477427.2875; train_gene_expr_recon_loss: 2588699.5988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58397.5944; train_global_loss: 3858875.4470; train_optim_loss: 3858875.4470; val_kl_reg_loss: 16550.4494; val_edge_recon_loss: 721616.8007; val_cat_covariates_contrastive_loss: 475986.0564; val_gene_expr_recon_loss: 2238337.8068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14528.2266; val_global_loss: 3467019.3689; val_optim_loss: 3467019.3689
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9090; val_auprc_score: 0.9811; val_best_acc_score: 0.9221; val_best_f1_score: 0.9563; train_kl_reg_loss: 18044.4756; train_edge_recon_loss: 692738.0250; train_cat_covariates_contrastive_loss: 477132.5538; train_gene_expr_recon_loss: 2097690.7430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14647.6805; train_global_loss: 3300253.4761; train_optim_loss: 3300253.4761; val_kl_reg_loss: 20514.3819; val_edge_recon_loss: 721892.7104; val_cat_covariates_contrastive_loss: 475886.1235; val_gene_expr_recon_loss: 2008746.5905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14826.2510; val_global_loss: 3241866.0594; val_optim_loss: 3241866.0594
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9199; val_auprc_score: 0.9834; val_best_acc_score: 0.9276; val_best_f1_score: 0.9593; train_kl_reg_loss: 20171.0400; train_edge_recon_loss: 691581.4490; train_cat_covariates_contrastive_loss: 477468.0380; train_gene_expr_recon_loss: 1971071.2099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14747.1693; train_global_loss: 3175038.9028; train_optim_loss: 3175038.9028; val_kl_reg_loss: 21237.5051; val_edge_recon_loss: 720343.7157; val_cat_covariates_contrastive_loss: 477169.9491; val_gene_expr_recon_loss: 1943739.0275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14701.6934; val_global_loss: 3177191.9449; val_optim_loss: 3177191.9449
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9279; val_auprc_score: 0.9853; val_best_acc_score: 0.9318; val_best_f1_score: 0.9616; train_kl_reg_loss: 21183.5044; train_edge_recon_loss: 691913.2836; train_cat_covariates_contrastive_loss: 477493.6353; train_gene_expr_recon_loss: 1924869.0753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14939.6386; train_global_loss: 3130399.1376; train_optim_loss: 3130399.1376; val_kl_reg_loss: 21889.8137; val_edge_recon_loss: 707463.2933; val_cat_covariates_contrastive_loss: 476874.5686; val_gene_expr_recon_loss: 1910733.9515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15166.0840; val_global_loss: 3132127.6320; val_optim_loss: 3132127.6320
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9284; val_auprc_score: 0.9851; val_best_acc_score: 0.9323; val_best_f1_score: 0.9618; train_kl_reg_loss: 21901.1124; train_edge_recon_loss: 691833.6378; train_cat_covariates_contrastive_loss: 477603.8147; train_gene_expr_recon_loss: 1898909.0252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15262.6656; train_global_loss: 3105510.2551; train_optim_loss: 3105510.2551; val_kl_reg_loss: 22682.3296; val_edge_recon_loss: 712999.0968; val_cat_covariates_contrastive_loss: 477000.6176; val_gene_expr_recon_loss: 1887845.8610; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15283.4902; val_global_loss: 3115811.4030; val_optim_loss: 3115811.4030
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9313; val_auprc_score: 0.9859; val_best_acc_score: 0.9330; val_best_f1_score: 0.9621; train_kl_reg_loss: 22521.1730; train_edge_recon_loss: 687885.3752; train_cat_covariates_contrastive_loss: 477726.7767; train_gene_expr_recon_loss: 1882987.0729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15340.1633; train_global_loss: 3086460.5631; train_optim_loss: 3086460.5631; val_kl_reg_loss: 22631.7119; val_edge_recon_loss: 714694.0691; val_cat_covariates_contrastive_loss: 477790.2949; val_gene_expr_recon_loss: 1875623.7107; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15440.2295; val_global_loss: 3106180.0428; val_optim_loss: 3106180.0428
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9281; val_auprc_score: 0.9847; val_best_acc_score: 0.9304; val_best_f1_score: 0.9607; train_kl_reg_loss: 23026.5920; train_edge_recon_loss: 689610.7018; train_cat_covariates_contrastive_loss: 478000.8034; train_gene_expr_recon_loss: 1868291.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15501.0653; train_global_loss: 3074430.7733; train_optim_loss: 3074430.7733; val_kl_reg_loss: 23037.7236; val_edge_recon_loss: 722781.5986; val_cat_covariates_contrastive_loss: 477482.3989; val_gene_expr_recon_loss: 1861890.9327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15612.4473; val_global_loss: 3100805.1530; val_optim_loss: 3100805.1530
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9325; val_auprc_score: 0.9859; val_best_acc_score: 0.9331; val_best_f1_score: 0.9622; train_kl_reg_loss: 23404.5866; train_edge_recon_loss: 689135.1824; train_cat_covariates_contrastive_loss: 478086.6248; train_gene_expr_recon_loss: 1857054.8528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15649.9281; train_global_loss: 3063331.1750; train_optim_loss: 3063331.1750; val_kl_reg_loss: 24031.1643; val_edge_recon_loss: 712929.7874; val_cat_covariates_contrastive_loss: 477442.6523; val_gene_expr_recon_loss: 1857347.0739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15781.0469; val_global_loss: 3087531.6818; val_optim_loss: 3087531.6818
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9334; val_auprc_score: 0.9865; val_best_acc_score: 0.9335; val_best_f1_score: 0.9625; train_kl_reg_loss: 23848.6756; train_edge_recon_loss: 687536.6803; train_cat_covariates_contrastive_loss: 478158.4883; train_gene_expr_recon_loss: 1847495.9365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15655.5673; train_global_loss: 3052695.3522; train_optim_loss: 3052695.3522; val_kl_reg_loss: 23948.0111; val_edge_recon_loss: 711601.4449; val_cat_covariates_contrastive_loss: 479793.7701; val_gene_expr_recon_loss: 1847692.3422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15664.7188; val_global_loss: 3078700.3173; val_optim_loss: 3078700.3173
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9321; val_auprc_score: 0.9857; val_best_acc_score: 0.9339; val_best_f1_score: 0.9627; train_kl_reg_loss: 24232.8568; train_edge_recon_loss: 688454.1452; train_cat_covariates_contrastive_loss: 478303.3387; train_gene_expr_recon_loss: 1840140.1859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15701.2830; train_global_loss: 3046831.8091; train_optim_loss: 3046831.8091; val_kl_reg_loss: 24256.3138; val_edge_recon_loss: 712168.1267; val_cat_covariates_contrastive_loss: 477985.0532; val_gene_expr_recon_loss: 1840275.5341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15884.6328; val_global_loss: 3070569.7902; val_optim_loss: 3070569.7902
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9305; val_auprc_score: 0.9850; val_best_acc_score: 0.9341; val_best_f1_score: 0.9626; train_kl_reg_loss: 24497.4217; train_edge_recon_loss: 689000.4385; train_cat_covariates_contrastive_loss: 478327.6813; train_gene_expr_recon_loss: 1832557.6388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15794.9988; train_global_loss: 3040178.1816; train_optim_loss: 3040178.1816; val_kl_reg_loss: 25373.5076; val_edge_recon_loss: 718520.4685; val_cat_covariates_contrastive_loss: 477453.6335; val_gene_expr_recon_loss: 1834524.0629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15714.3271; val_global_loss: 3071585.9170; val_optim_loss: 3071585.9170
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9364; val_auprc_score: 0.9865; val_best_acc_score: 0.9369; val_best_f1_score: 0.9644; train_kl_reg_loss: 24680.4211; train_edge_recon_loss: 685465.1124; train_cat_covariates_contrastive_loss: 478441.3318; train_gene_expr_recon_loss: 1826751.1026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15956.7755; train_global_loss: 3031294.7446; train_optim_loss: 3031294.7446; val_kl_reg_loss: 24954.7072; val_edge_recon_loss: 712274.8494; val_cat_covariates_contrastive_loss: 478288.9540; val_gene_expr_recon_loss: 1829243.3733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15834.6621; val_global_loss: 3060596.6355; val_optim_loss: 3060596.6355
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9369; val_auprc_score: 0.9868; val_best_acc_score: 0.9369; val_best_f1_score: 0.9643; train_kl_reg_loss: 24948.5215; train_edge_recon_loss: 690885.2862; train_cat_covariates_contrastive_loss: 478530.8779; train_gene_expr_recon_loss: 1823058.9802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16049.5206; train_global_loss: 3033473.1826; train_optim_loss: 3033473.1826; val_kl_reg_loss: 24611.3409; val_edge_recon_loss: 715222.0227; val_cat_covariates_contrastive_loss: 479407.9732; val_gene_expr_recon_loss: 1822028.0376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16068.1934; val_global_loss: 3057337.6233; val_optim_loss: 3057337.6233
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9345; val_auprc_score: 0.9859; val_best_acc_score: 0.9362; val_best_f1_score: 0.9639; train_kl_reg_loss: 25063.3441; train_edge_recon_loss: 688009.2199; train_cat_covariates_contrastive_loss: 478534.7991; train_gene_expr_recon_loss: 1819203.6137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16146.7239; train_global_loss: 3026957.7019; train_optim_loss: 3026957.7019; val_kl_reg_loss: 25989.6702; val_edge_recon_loss: 711505.8352; val_cat_covariates_contrastive_loss: 477765.7654; val_gene_expr_recon_loss: 1819247.8698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16090.1035; val_global_loss: 3050599.1451; val_optim_loss: 3050599.1451
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9337; val_auprc_score: 0.9863; val_best_acc_score: 0.9326; val_best_f1_score: 0.9619; train_kl_reg_loss: 25318.8610; train_edge_recon_loss: 688175.4955; train_cat_covariates_contrastive_loss: 478661.6079; train_gene_expr_recon_loss: 1816378.9879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16249.1757; train_global_loss: 3024784.1238; train_optim_loss: 3024784.1238; val_kl_reg_loss: 25224.4997; val_edge_recon_loss: 712775.0939; val_cat_covariates_contrastive_loss: 479065.6471; val_gene_expr_recon_loss: 1822830.8081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16341.5166; val_global_loss: 3056237.5568; val_optim_loss: 3056237.5568
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9411; val_auprc_score: 0.9878; val_best_acc_score: 0.9384; val_best_f1_score: 0.9651; train_kl_reg_loss: 25358.0041; train_edge_recon_loss: 686866.8313; train_cat_covariates_contrastive_loss: 478607.3925; train_gene_expr_recon_loss: 1812800.4056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16405.3528; train_global_loss: 3020037.9851; train_optim_loss: 3020037.9851; val_kl_reg_loss: 26817.2453; val_edge_recon_loss: 736860.3717; val_cat_covariates_contrastive_loss: 478833.0687; val_gene_expr_recon_loss: 2073996.6508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16839.7891; val_global_loss: 3333347.0717; val_optim_loss: 3333347.0717
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9335; val_auprc_score: 0.9860; val_best_acc_score: 0.9343; val_best_f1_score: 0.9629; train_kl_reg_loss: 221781.8516; train_edge_recon_loss: 691414.0484; train_cat_covariates_contrastive_loss: 479231.0650; train_gene_expr_recon_loss: 1921723.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16411.3874; train_global_loss: 3330561.9391; train_optim_loss: 3330561.9391; val_kl_reg_loss: 29494.0457; val_edge_recon_loss: 713273.5249; val_cat_covariates_contrastive_loss: 478638.2326; val_gene_expr_recon_loss: 1842666.5275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16242.3896; val_global_loss: 3080314.8226; val_optim_loss: 3080314.8226
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9348; val_auprc_score: 0.9861; val_best_acc_score: 0.9373; val_best_f1_score: 0.9646; train_kl_reg_loss: 28562.2308; train_edge_recon_loss: 691420.6219; train_cat_covariates_contrastive_loss: 479322.9129; train_gene_expr_recon_loss: 1831793.4551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16402.1854; train_global_loss: 3047501.4071; train_optim_loss: 3047501.4071; val_kl_reg_loss: 29088.2087; val_edge_recon_loss: 714410.6377; val_cat_covariates_contrastive_loss: 478908.4212; val_gene_expr_recon_loss: 1827505.7308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16458.8633; val_global_loss: 3066371.7649; val_optim_loss: 3066371.7649

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9353; val_auprc_score: 0.9860; val_best_acc_score: 0.9367; val_best_f1_score: 0.9642; train_kl_reg_loss: 28149.5261; train_edge_recon_loss: 687806.1674; train_cat_covariates_contrastive_loss: 479240.6786; train_gene_expr_recon_loss: 1793237.8232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8155.7814; train_global_loss: 2996589.9729; train_optim_loss: 2996589.9729; val_kl_reg_loss: 28344.9536; val_edge_recon_loss: 712569.7790; val_cat_covariates_contrastive_loss: 479011.1297; val_gene_expr_recon_loss: 1798012.5017; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8049.6494; val_global_loss: 3025988.1014; val_optim_loss: 3025988.1014
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9360; val_auprc_score: 0.9863; val_best_acc_score: 0.9371; val_best_f1_score: 0.9645; train_kl_reg_loss: 27961.5913; train_edge_recon_loss: 687806.4071; train_cat_covariates_contrastive_loss: 479264.8502; train_gene_expr_recon_loss: 1786613.1232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8112.8670; train_global_loss: 2989758.8389; train_optim_loss: 2989758.8389; val_kl_reg_loss: 28103.7080; val_edge_recon_loss: 713749.7220; val_cat_covariates_contrastive_loss: 479198.5971; val_gene_expr_recon_loss: 1793072.0459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8095.4648; val_global_loss: 3022219.5726; val_optim_loss: 3022219.5726
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9378; val_auprc_score: 0.9866; val_best_acc_score: 0.9376; val_best_f1_score: 0.9647; train_kl_reg_loss: 27838.9973; train_edge_recon_loss: 686720.6329; train_cat_covariates_contrastive_loss: 479220.0911; train_gene_expr_recon_loss: 1783231.9888; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8121.4608; train_global_loss: 2985133.1733; train_optim_loss: 2985133.1733; val_kl_reg_loss: 27853.6291; val_edge_recon_loss: 711259.6930; val_cat_covariates_contrastive_loss: 479635.4099; val_gene_expr_recon_loss: 1789823.0839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8145.4976; val_global_loss: 3016717.3138; val_optim_loss: 3016717.3138
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9370; val_auprc_score: 0.9866; val_best_acc_score: 0.9376; val_best_f1_score: 0.9648; train_kl_reg_loss: 27658.9698; train_edge_recon_loss: 686589.5231; train_cat_covariates_contrastive_loss: 479200.0640; train_gene_expr_recon_loss: 1779431.7616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8139.4693; train_global_loss: 2981019.7880; train_optim_loss: 2981019.7880; val_kl_reg_loss: 27677.0215; val_edge_recon_loss: 708027.6718; val_cat_covariates_contrastive_loss: 479297.0306; val_gene_expr_recon_loss: 1786501.6464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8146.8374; val_global_loss: 3009650.1128; val_optim_loss: 3009650.1128
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9370; val_auprc_score: 0.9865; val_best_acc_score: 0.9373; val_best_f1_score: 0.9644; train_kl_reg_loss: 27472.2250; train_edge_recon_loss: 687692.2616; train_cat_covariates_contrastive_loss: 479157.9770; train_gene_expr_recon_loss: 1776829.0213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8172.7701; train_global_loss: 2979324.2510; train_optim_loss: 2979324.2510; val_kl_reg_loss: 27673.7861; val_edge_recon_loss: 714212.7426; val_cat_covariates_contrastive_loss: 478543.9568; val_gene_expr_recon_loss: 1784208.7382; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8145.3638; val_global_loss: 3012784.4790; val_optim_loss: 3012784.4790
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9389; val_auprc_score: 0.9871; val_best_acc_score: 0.9368; val_best_f1_score: 0.9643; train_kl_reg_loss: 27241.1546; train_edge_recon_loss: 688745.8882; train_cat_covariates_contrastive_loss: 479065.9217; train_gene_expr_recon_loss: 1774656.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8212.4272; train_global_loss: 2977921.8385; train_optim_loss: 2977921.8385; val_kl_reg_loss: 26738.8637; val_edge_recon_loss: 713887.0461; val_cat_covariates_contrastive_loss: 480051.2393; val_gene_expr_recon_loss: 1782080.8016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8245.5518; val_global_loss: 3011003.4519; val_optim_loss: 3011003.4519
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9387; val_auprc_score: 0.9869; val_best_acc_score: 0.9375; val_best_f1_score: 0.9647; train_kl_reg_loss: 27007.1748; train_edge_recon_loss: 688571.1657; train_cat_covariates_contrastive_loss: 478937.3114; train_gene_expr_recon_loss: 1773042.7909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8237.2524; train_global_loss: 2975795.6956; train_optim_loss: 2975795.6956; val_kl_reg_loss: 26890.5254; val_edge_recon_loss: 708471.9468; val_cat_covariates_contrastive_loss: 478909.4161; val_gene_expr_recon_loss: 1779174.2491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8217.2461; val_global_loss: 3001663.3811; val_optim_loss: 3001663.3811
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9279; val_auprc_score: 0.9849; val_best_acc_score: 0.9313; val_best_f1_score: 0.9614; train_kl_reg_loss: 24978.1954; train_edge_recon_loss: 690295.1407; train_cat_covariates_contrastive_loss: 479271.3658; train_gene_expr_recon_loss: 1654814.1436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6841.7196; train_global_loss: 2856200.5649; train_optim_loss: 2856200.5649; val_kl_reg_loss: 19225.0697; val_edge_recon_loss: 714717.7323; val_cat_covariates_contrastive_loss: 478747.9606; val_gene_expr_recon_loss: 1652100.9449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6375.4272; val_global_loss: 2871167.2019; val_optim_loss: 2871167.2019
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9302; val_auprc_score: 0.9854; val_best_acc_score: 0.9326; val_best_f1_score: 0.9621; train_kl_reg_loss: 23749.4805; train_edge_recon_loss: 690444.3278; train_cat_covariates_contrastive_loss: 478509.4507; train_gene_expr_recon_loss: 1641900.2048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6299.0272; train_global_loss: 2840902.4913; train_optim_loss: 2840902.4913; val_kl_reg_loss: 20213.4927; val_edge_recon_loss: 708081.2473; val_cat_covariates_contrastive_loss: 478076.2253; val_gene_expr_recon_loss: 1641848.5022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6288.3828; val_global_loss: 2854507.9694; val_optim_loss: 2854507.9694
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9300; val_auprc_score: 0.9853; val_best_acc_score: 0.9324; val_best_f1_score: 0.9618; train_kl_reg_loss: 22810.3430; train_edge_recon_loss: 687601.4669; train_cat_covariates_contrastive_loss: 478006.3080; train_gene_expr_recon_loss: 1632808.9630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6275.1893; train_global_loss: 2827502.2740; train_optim_loss: 2827502.2740; val_kl_reg_loss: 20369.3762; val_edge_recon_loss: 709907.7006; val_cat_covariates_contrastive_loss: 477902.5343; val_gene_expr_recon_loss: 1634608.4760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6229.3540; val_global_loss: 2849017.3348; val_optim_loss: 2849017.3348
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9310; val_auprc_score: 0.9857; val_best_acc_score: 0.9331; val_best_f1_score: 0.9623; train_kl_reg_loss: 22268.5479; train_edge_recon_loss: 689561.2016; train_cat_covariates_contrastive_loss: 477970.6498; train_gene_expr_recon_loss: 1617319.0320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6269.2632; train_global_loss: 2813388.6987; train_optim_loss: 2813388.6987; val_kl_reg_loss: 20240.1972; val_edge_recon_loss: 702775.2006; val_cat_covariates_contrastive_loss: 477752.3133; val_gene_expr_recon_loss: 1615075.6359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6200.8896; val_global_loss: 2822044.3435; val_optim_loss: 2822044.3435
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9288; val_auprc_score: 0.9848; val_best_acc_score: 0.9319; val_best_f1_score: 0.9615; train_kl_reg_loss: 22073.7328; train_edge_recon_loss: 690175.8285; train_cat_covariates_contrastive_loss: 478014.8952; train_gene_expr_recon_loss: 1606231.0922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6216.7591; train_global_loss: 2802712.3073; train_optim_loss: 2802712.3073; val_kl_reg_loss: 20285.2460; val_edge_recon_loss: 715009.7214; val_cat_covariates_contrastive_loss: 477567.1595; val_gene_expr_recon_loss: 1610952.6088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6219.9038; val_global_loss: 2830034.7386; val_optim_loss: 2830034.7386
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9305; val_auprc_score: 0.9853; val_best_acc_score: 0.9327; val_best_f1_score: 0.9620; train_kl_reg_loss: 21598.3194; train_edge_recon_loss: 684802.5478; train_cat_covariates_contrastive_loss: 477822.8451; train_gene_expr_recon_loss: 1600443.7958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6217.2556; train_global_loss: 2790884.7649; train_optim_loss: 2790884.7649; val_kl_reg_loss: 20465.8277; val_edge_recon_loss: 712199.4388; val_cat_covariates_contrastive_loss: 477299.3290; val_gene_expr_recon_loss: 1603433.7360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6204.5298; val_global_loss: 2819602.8287; val_optim_loss: 2819602.8287
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9332; val_auprc_score: 0.9862; val_best_acc_score: 0.9336; val_best_f1_score: 0.9625; train_kl_reg_loss: 21310.2998; train_edge_recon_loss: 687625.2938; train_cat_covariates_contrastive_loss: 477688.8175; train_gene_expr_recon_loss: 1594114.8606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6229.4720; train_global_loss: 2786968.7450; train_optim_loss: 2786968.7450; val_kl_reg_loss: 20145.4069; val_edge_recon_loss: 704437.9792; val_cat_covariates_contrastive_loss: 477766.1394; val_gene_expr_recon_loss: 1598280.4196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6254.7891; val_global_loss: 2806884.6949; val_optim_loss: 2806884.6949
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9318; val_auprc_score: 0.9855; val_best_acc_score: 0.9343; val_best_f1_score: 0.9629; train_kl_reg_loss: 21103.7785; train_edge_recon_loss: 687742.8923; train_cat_covariates_contrastive_loss: 477613.7311; train_gene_expr_recon_loss: 1591492.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6239.3801; train_global_loss: 2784192.6596; train_optim_loss: 2784192.6596; val_kl_reg_loss: 20526.9952; val_edge_recon_loss: 711227.0527; val_cat_covariates_contrastive_loss: 477412.6596; val_gene_expr_recon_loss: 1595570.6766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6183.3789; val_global_loss: 2810920.8855; val_optim_loss: 2810920.8855
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9313; val_auprc_score: 0.9852; val_best_acc_score: 0.9335; val_best_f1_score: 0.9624; train_kl_reg_loss: 21010.3343; train_edge_recon_loss: 688447.4234; train_cat_covariates_contrastive_loss: 477573.2406; train_gene_expr_recon_loss: 1588706.8715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6236.8547; train_global_loss: 2781974.7275; train_optim_loss: 2781974.7275; val_kl_reg_loss: 20312.3621; val_edge_recon_loss: 715384.6403; val_cat_covariates_contrastive_loss: 477692.7644; val_gene_expr_recon_loss: 1596221.7758; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6243.9521; val_global_loss: 2815855.5437; val_optim_loss: 2815855.5437
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9337; val_auprc_score: 0.9861; val_best_acc_score: 0.9343; val_best_f1_score: 0.9629; train_kl_reg_loss: 20847.7803; train_edge_recon_loss: 684452.2418; train_cat_covariates_contrastive_loss: 477540.7236; train_gene_expr_recon_loss: 1586920.4464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6246.1296; train_global_loss: 2776007.3194; train_optim_loss: 2776007.3194; val_kl_reg_loss: 20202.2256; val_edge_recon_loss: 709803.8134; val_cat_covariates_contrastive_loss: 477527.3483; val_gene_expr_recon_loss: 1592595.3711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6226.7676; val_global_loss: 2806355.5052; val_optim_loss: 2806355.5052
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9322; val_auprc_score: 0.9855; val_best_acc_score: 0.9341; val_best_f1_score: 0.9629; train_kl_reg_loss: 20866.0618; train_edge_recon_loss: 686314.5032; train_cat_covariates_contrastive_loss: 477432.8676; train_gene_expr_recon_loss: 1585326.8812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6240.7153; train_global_loss: 2776181.0253; train_optim_loss: 2776181.0253; val_kl_reg_loss: 20501.9873; val_edge_recon_loss: 712063.5752; val_cat_covariates_contrastive_loss: 477804.1412; val_gene_expr_recon_loss: 1591621.6045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6245.8579; val_global_loss: 2808237.0621; val_optim_loss: 2808237.0621
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9333; val_auprc_score: 0.9857; val_best_acc_score: 0.9344; val_best_f1_score: 0.9629; train_kl_reg_loss: 20841.1175; train_edge_recon_loss: 687471.4346; train_cat_covariates_contrastive_loss: 477415.1445; train_gene_expr_recon_loss: 1583784.2097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6259.7961; train_global_loss: 2775771.7010; train_optim_loss: 2775771.7010; val_kl_reg_loss: 20417.2583; val_edge_recon_loss: 710989.6826; val_cat_covariates_contrastive_loss: 477120.7500; val_gene_expr_recon_loss: 1589609.9996; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6270.5977; val_global_loss: 2804408.1906; val_optim_loss: 2804408.1906
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9327; val_auprc_score: 0.9859; val_best_acc_score: 0.9350; val_best_f1_score: 0.9633; train_kl_reg_loss: 20724.6004; train_edge_recon_loss: 688501.4300; train_cat_covariates_contrastive_loss: 477391.4174; train_gene_expr_recon_loss: 1582396.4960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6257.2311; train_global_loss: 2775271.1716; train_optim_loss: 2775271.1716; val_kl_reg_loss: 20273.1542; val_edge_recon_loss: 706217.7587; val_cat_covariates_contrastive_loss: 477493.6457; val_gene_expr_recon_loss: 1590635.7649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6223.9844; val_global_loss: 2800844.3156; val_optim_loss: 2800844.3156
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9322; val_auprc_score: 0.9854; val_best_acc_score: 0.9340; val_best_f1_score: 0.9627; train_kl_reg_loss: 36081658.7720; train_edge_recon_loss: 686929.3621; train_cat_covariates_contrastive_loss: 477795.3811; train_gene_expr_recon_loss: 1587961.1851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6295.8930; train_global_loss: 38840641.0958; train_optim_loss: 38840641.0958; val_kl_reg_loss: 20343.7463; val_edge_recon_loss: 713968.0870; val_cat_covariates_contrastive_loss: 477462.8572; val_gene_expr_recon_loss: 1580552.4091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6284.7832; val_global_loss: 2798611.8514; val_optim_loss: 2798611.8514
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9321; val_auprc_score: 0.9855; val_best_acc_score: 0.9348; val_best_f1_score: 0.9632; train_kl_reg_loss: 20995.0864; train_edge_recon_loss: 688862.1899; train_cat_covariates_contrastive_loss: 477597.5378; train_gene_expr_recon_loss: 1572584.3755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6287.9328; train_global_loss: 2766327.1207; train_optim_loss: 2766327.1207; val_kl_reg_loss: 20273.9491; val_edge_recon_loss: 709087.0275; val_cat_covariates_contrastive_loss: 476846.9973; val_gene_expr_recon_loss: 1577072.7657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6304.2871; val_global_loss: 2789584.9878; val_optim_loss: 2789584.9878
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9330; val_auprc_score: 0.9858; val_best_acc_score: 0.9342; val_best_f1_score: 0.9628; train_kl_reg_loss: 20749.0984; train_edge_recon_loss: 686837.2110; train_cat_covariates_contrastive_loss: 477360.5930; train_gene_expr_recon_loss: 1569148.7362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6269.2787; train_global_loss: 2760364.9195; train_optim_loss: 2760364.9195; val_kl_reg_loss: 20240.7635; val_edge_recon_loss: 712031.1261; val_cat_covariates_contrastive_loss: 477501.9372; val_gene_expr_recon_loss: 1573998.4454; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6286.8506; val_global_loss: 2790059.0210; val_optim_loss: 2790059.0210
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9338; val_auprc_score: 0.9859; val_best_acc_score: 0.9345; val_best_f1_score: 0.9630; train_kl_reg_loss: 20745.1202; train_edge_recon_loss: 687773.1648; train_cat_covariates_contrastive_loss: 477288.0681; train_gene_expr_recon_loss: 1566569.0642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6253.2368; train_global_loss: 2758628.6544; train_optim_loss: 2758628.6544; val_kl_reg_loss: 20452.0304; val_edge_recon_loss: 709570.1086; val_cat_covariates_contrastive_loss: 477173.5824; val_gene_expr_recon_loss: 1572126.2819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6244.9487; val_global_loss: 2785567.0026; val_optim_loss: 2785567.0026
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9316; val_auprc_score: 0.9852; val_best_acc_score: 0.9343; val_best_f1_score: 0.9629; train_kl_reg_loss: 20678.7266; train_edge_recon_loss: 684549.4786; train_cat_covariates_contrastive_loss: 477038.2457; train_gene_expr_recon_loss: 1564034.8641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6254.5073; train_global_loss: 2752555.8240; train_optim_loss: 2752555.8240; val_kl_reg_loss: 20607.5064; val_edge_recon_loss: 711825.0411; val_cat_covariates_contrastive_loss: 476886.8094; val_gene_expr_recon_loss: 1570924.3925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6244.6226; val_global_loss: 2786488.2456; val_optim_loss: 2786488.2456
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9346; val_auprc_score: 0.9862; val_best_acc_score: 0.9350; val_best_f1_score: 0.9633; train_kl_reg_loss: 20620.2093; train_edge_recon_loss: 685966.3144; train_cat_covariates_contrastive_loss: 477124.4515; train_gene_expr_recon_loss: 1562633.7399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6249.0994; train_global_loss: 2752593.8158; train_optim_loss: 2752593.8158; val_kl_reg_loss: 20340.1233; val_edge_recon_loss: 712732.7512; val_cat_covariates_contrastive_loss: 477651.3110; val_gene_expr_recon_loss: 1570038.3711; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6253.3687; val_global_loss: 2787015.8173; val_optim_loss: 2787015.8173
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9319; val_auprc_score: 0.9854; val_best_acc_score: 0.9339; val_best_f1_score: 0.9627; train_kl_reg_loss: 20591.9564; train_edge_recon_loss: 687537.5311; train_cat_covariates_contrastive_loss: 477088.8845; train_gene_expr_recon_loss: 1560325.8545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6251.0755; train_global_loss: 2751795.3032; train_optim_loss: 2751795.3032; val_kl_reg_loss: 20413.0145; val_edge_recon_loss: 710185.2375; val_cat_covariates_contrastive_loss: 477060.7409; val_gene_expr_recon_loss: 1568011.9904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6266.3223; val_global_loss: 2781937.2378; val_optim_loss: 2781937.2378
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9327; val_auprc_score: 0.9857; val_best_acc_score: 0.9343; val_best_f1_score: 0.9630; train_kl_reg_loss: 20512.6121; train_edge_recon_loss: 685458.9955; train_cat_covariates_contrastive_loss: 477084.8952; train_gene_expr_recon_loss: 1559094.7474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6251.6307; train_global_loss: 2748402.8810; train_optim_loss: 2748402.8810; val_kl_reg_loss: 20248.5383; val_edge_recon_loss: 708978.1302; val_cat_covariates_contrastive_loss: 477116.9691; val_gene_expr_recon_loss: 1567409.9078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6236.6685; val_global_loss: 2779990.3024; val_optim_loss: 2779990.3024
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9346; val_auprc_score: 0.9862; val_best_acc_score: 0.9346; val_best_f1_score: 0.9630; train_kl_reg_loss: 20454.3723; train_edge_recon_loss: 687567.4405; train_cat_covariates_contrastive_loss: 477058.2790; train_gene_expr_recon_loss: 1557800.5757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6249.5168; train_global_loss: 2749130.1842; train_optim_loss: 2749130.1842; val_kl_reg_loss: 20245.5050; val_edge_recon_loss: 709599.3824; val_cat_covariates_contrastive_loss: 477239.0456; val_gene_expr_recon_loss: 1565927.3960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6210.0122; val_global_loss: 2779221.3243; val_optim_loss: 2779221.3243
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9332; val_auprc_score: 0.9856; val_best_acc_score: 0.9359; val_best_f1_score: 0.9637; train_kl_reg_loss: 20358.7617; train_edge_recon_loss: 685578.3834; train_cat_covariates_contrastive_loss: 477063.6151; train_gene_expr_recon_loss: 1557357.8272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6254.8633; train_global_loss: 2746613.4515; train_optim_loss: 2746613.4515; val_kl_reg_loss: 20089.5469; val_edge_recon_loss: 711199.1754; val_cat_covariates_contrastive_loss: 476655.4064; val_gene_expr_recon_loss: 1565728.1757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6268.2275; val_global_loss: 2779940.5612; val_optim_loss: 2779940.5612
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9324; val_auprc_score: 0.9856; val_best_acc_score: 0.9344; val_best_f1_score: 0.9629; train_kl_reg_loss: 20226.7755; train_edge_recon_loss: 685153.8922; train_cat_covariates_contrastive_loss: 477058.4607; train_gene_expr_recon_loss: 1555699.6689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6270.2521; train_global_loss: 2744409.0534; train_optim_loss: 2744409.0534; val_kl_reg_loss: 19958.1773; val_edge_recon_loss: 709692.6340; val_cat_covariates_contrastive_loss: 477334.9207; val_gene_expr_recon_loss: 1564288.8011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6296.9492; val_global_loss: 2777571.5350; val_optim_loss: 2777571.5350
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9333; val_auprc_score: 0.9859; val_best_acc_score: 0.9354; val_best_f1_score: 0.9636; train_kl_reg_loss: 20130.7883; train_edge_recon_loss: 686899.1181; train_cat_covariates_contrastive_loss: 476987.0319; train_gene_expr_recon_loss: 1554693.2991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6281.8221; train_global_loss: 2744992.0597; train_optim_loss: 2744992.0597; val_kl_reg_loss: 20078.0181; val_edge_recon_loss: 704002.2415; val_cat_covariates_contrastive_loss: 476806.8705; val_gene_expr_recon_loss: 1561823.0153; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6309.6953; val_global_loss: 2769019.8942; val_optim_loss: 2769019.8942
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9321; val_auprc_score: 0.9852; val_best_acc_score: 0.9341; val_best_f1_score: 0.9627; train_kl_reg_loss: 20099.9363; train_edge_recon_loss: 685140.5078; train_cat_covariates_contrastive_loss: 477013.6613; train_gene_expr_recon_loss: 1553509.0030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6295.9024; train_global_loss: 2742059.0087; train_optim_loss: 2742059.0087; val_kl_reg_loss: 20161.4971; val_edge_recon_loss: 715249.4373; val_cat_covariates_contrastive_loss: 476426.3889; val_gene_expr_recon_loss: 1560663.1499; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6278.5273; val_global_loss: 2778778.9747; val_optim_loss: 2778778.9747
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9317; val_auprc_score: 0.9854; val_best_acc_score: 0.9331; val_best_f1_score: 0.9621; train_kl_reg_loss: 20189.5957; train_edge_recon_loss: 685261.3000; train_cat_covariates_contrastive_loss: 476945.4089; train_gene_expr_recon_loss: 1552960.3614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6321.6270; train_global_loss: 2741678.2908; train_optim_loss: 2741678.2908; val_kl_reg_loss: 20420.3829; val_edge_recon_loss: 714428.2986; val_cat_covariates_contrastive_loss: 476208.6004; val_gene_expr_recon_loss: 1559966.9406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6267.3613; val_global_loss: 2777291.4712; val_optim_loss: 2777291.4712
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9340; val_auprc_score: 0.9859; val_best_acc_score: 0.9349; val_best_f1_score: 0.9632; train_kl_reg_loss: 20171.7282; train_edge_recon_loss: 685831.4991; train_cat_covariates_contrastive_loss: 476773.9569; train_gene_expr_recon_loss: 1551888.1340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6311.4538; train_global_loss: 2740976.7703; train_optim_loss: 2740976.7703; val_kl_reg_loss: 20075.4585; val_edge_recon_loss: 710419.3448; val_cat_covariates_contrastive_loss: 477112.5463; val_gene_expr_recon_loss: 1559958.2771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6310.4736; val_global_loss: 2773876.1241; val_optim_loss: 2773876.1241
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9332; val_auprc_score: 0.9856; val_best_acc_score: 0.9354; val_best_f1_score: 0.9635; train_kl_reg_loss: 20049.9430; train_edge_recon_loss: 685424.1701; train_cat_covariates_contrastive_loss: 476882.2154; train_gene_expr_recon_loss: 1551142.3807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6318.1793; train_global_loss: 2739816.8914; train_optim_loss: 2739816.8914; val_kl_reg_loss: 19973.4077; val_edge_recon_loss: 710456.2247; val_cat_covariates_contrastive_loss: 476359.7427; val_gene_expr_recon_loss: 1558014.0826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6269.0996; val_global_loss: 2771072.4668; val_optim_loss: 2771072.4668

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9341; val_auprc_score: 0.9860; val_best_acc_score: 0.9361; val_best_f1_score: 0.9640; train_kl_reg_loss: 19886.9331; train_edge_recon_loss: 684018.2756; train_cat_covariates_contrastive_loss: 476663.4977; train_gene_expr_recon_loss: 1546726.0069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5576.0322; train_global_loss: 2732870.7485; train_optim_loss: 2732870.7485; val_kl_reg_loss: 19788.4182; val_edge_recon_loss: 706896.1043; val_cat_covariates_contrastive_loss: 476769.2257; val_gene_expr_recon_loss: 1555340.8737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5575.7939; val_global_loss: 2764370.3680; val_optim_loss: 2764370.3680
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9340; val_auprc_score: 0.9860; val_best_acc_score: 0.9353; val_best_f1_score: 0.9634; train_kl_reg_loss: 19885.4957; train_edge_recon_loss: 684395.1217; train_cat_covariates_contrastive_loss: 476752.5649; train_gene_expr_recon_loss: 1546825.2397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5570.1054; train_global_loss: 2733428.5298; train_optim_loss: 2733428.5298; val_kl_reg_loss: 19780.7296; val_edge_recon_loss: 711213.3824; val_cat_covariates_contrastive_loss: 477296.4197; val_gene_expr_recon_loss: 1555188.2959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5575.1416; val_global_loss: 2769054.0752; val_optim_loss: 2769054.0752
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9334; val_auprc_score: 0.9857; val_best_acc_score: 0.9354; val_best_f1_score: 0.9635; train_kl_reg_loss: 19872.1877; train_edge_recon_loss: 686005.8803; train_cat_covariates_contrastive_loss: 476799.3175; train_gene_expr_recon_loss: 1546428.6832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5567.4570; train_global_loss: 2734673.5268; train_optim_loss: 2734673.5268; val_kl_reg_loss: 19893.3803; val_edge_recon_loss: 710873.1300; val_cat_covariates_contrastive_loss: 476471.4075; val_gene_expr_recon_loss: 1554563.4961; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5559.9019; val_global_loss: 2767361.4100; val_optim_loss: 2767361.4100
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9354; val_auprc_score: 0.9864; val_best_acc_score: 0.9348; val_best_f1_score: 0.9631; train_kl_reg_loss: 19882.7988; train_edge_recon_loss: 684061.7427; train_cat_covariates_contrastive_loss: 476742.5137; train_gene_expr_recon_loss: 1546050.2728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5562.9775; train_global_loss: 2732300.3101; train_optim_loss: 2732300.3101; val_kl_reg_loss: 19857.2285; val_edge_recon_loss: 709243.8373; val_cat_covariates_contrastive_loss: 476891.1002; val_gene_expr_recon_loss: 1554231.8011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5563.7495; val_global_loss: 2765787.7107; val_optim_loss: 2765787.7107
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9331; val_auprc_score: 0.9858; val_best_acc_score: 0.9360; val_best_f1_score: 0.9639; train_kl_reg_loss: 19866.4953; train_edge_recon_loss: 686503.6147; train_cat_covariates_contrastive_loss: 476696.3135; train_gene_expr_recon_loss: 1546265.0293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5565.2836; train_global_loss: 2734896.7347; train_optim_loss: 2734896.7347; val_kl_reg_loss: 19659.3669; val_edge_recon_loss: 701933.9976; val_cat_covariates_contrastive_loss: 476891.7817; val_gene_expr_recon_loss: 1553605.3116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5579.2554; val_global_loss: 2757669.7089; val_optim_loss: 2757669.7089
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9324; val_auprc_score: 0.9856; val_best_acc_score: 0.9349; val_best_f1_score: 0.9632; train_kl_reg_loss: 19816.8743; train_edge_recon_loss: 685834.3234; train_cat_covariates_contrastive_loss: 476832.4378; train_gene_expr_recon_loss: 1545629.4529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5568.0747; train_global_loss: 2733681.1639; train_optim_loss: 2733681.1639; val_kl_reg_loss: 19752.3084; val_edge_recon_loss: 711927.7537; val_cat_covariates_contrastive_loss: 476642.8664; val_gene_expr_recon_loss: 1553658.7784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5570.4028; val_global_loss: 2767552.2107; val_optim_loss: 2767552.2107
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9348; val_auprc_score: 0.9860; val_best_acc_score: 0.9354; val_best_f1_score: 0.9635; train_kl_reg_loss: 19857.0334; train_edge_recon_loss: 684819.7385; train_cat_covariates_contrastive_loss: 476810.1411; train_gene_expr_recon_loss: 1545922.4156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5569.8488; train_global_loss: 2732979.1776; train_optim_loss: 2732979.1776; val_kl_reg_loss: 19746.3853; val_edge_recon_loss: 706065.5945; val_cat_covariates_contrastive_loss: 476579.9341; val_gene_expr_recon_loss: 1554517.7566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5581.2681; val_global_loss: 2762490.9231; val_optim_loss: 2762490.9231
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9340; val_auprc_score: 0.9858; val_best_acc_score: 0.9353; val_best_f1_score: 0.9635; train_kl_reg_loss: 19800.1212; train_edge_recon_loss: 682121.8296; train_cat_covariates_contrastive_loss: 476751.9446; train_gene_expr_recon_loss: 1545999.4358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5571.0561; train_global_loss: 2730244.3874; train_optim_loss: 2730244.3874; val_kl_reg_loss: 19694.3818; val_edge_recon_loss: 709184.0262; val_cat_covariates_contrastive_loss: 476855.3017; val_gene_expr_recon_loss: 1553686.1538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5574.0693; val_global_loss: 2764993.8628; val_optim_loss: 2764993.8628
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9354; val_auprc_score: 0.9865; val_best_acc_score: 0.9357; val_best_f1_score: 0.9637; train_kl_reg_loss: 19800.3109; train_edge_recon_loss: 684668.6648; train_cat_covariates_contrastive_loss: 476780.6309; train_gene_expr_recon_loss: 1545604.0440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5569.1581; train_global_loss: 2732422.8073; train_optim_loss: 2732422.8073; val_kl_reg_loss: 19792.7875; val_edge_recon_loss: 703717.6993; val_cat_covariates_contrastive_loss: 476337.6606; val_gene_expr_recon_loss: 1554064.9030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5573.4443; val_global_loss: 2759486.5507; val_optim_loss: 2759486.5507

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9362; val_auprc_score: 0.9864; val_best_acc_score: 0.9349; val_best_f1_score: 0.9631; train_kl_reg_loss: 19780.2076; train_edge_recon_loss: 685431.1772; train_cat_covariates_contrastive_loss: 476679.2976; train_gene_expr_recon_loss: 1544771.4146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5489.7492; train_global_loss: 2732151.8483; train_optim_loss: 2732151.8483; val_kl_reg_loss: 19698.5457; val_edge_recon_loss: 717623.4067; val_cat_covariates_contrastive_loss: 476629.0434; val_gene_expr_recon_loss: 1553072.3684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5486.1411; val_global_loss: 2772509.6101; val_optim_loss: 2772509.6101
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.9330; val_auprc_score: 0.9856; val_best_acc_score: 0.9350; val_best_f1_score: 0.9633; train_kl_reg_loss: 19774.9961; train_edge_recon_loss: 684422.3811; train_cat_covariates_contrastive_loss: 476809.9102; train_gene_expr_recon_loss: 1544791.1462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5484.9728; train_global_loss: 2731283.4079; train_optim_loss: 2731283.4079; val_kl_reg_loss: 19687.5072; val_edge_recon_loss: 711295.8253; val_cat_covariates_contrastive_loss: 476998.2057; val_gene_expr_recon_loss: 1553004.4602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5484.5376; val_global_loss: 2766470.4904; val_optim_loss: 2766470.4904
Epoch 66/400 |███-----------------| 16.5% val_auroc_score: 0.9347; val_auprc_score: 0.9865; val_best_acc_score: 0.9360; val_best_f1_score: 0.9639; train_kl_reg_loss: 19756.1328; train_edge_recon_loss: 683931.0293; train_cat_covariates_contrastive_loss: 476741.2619; train_gene_expr_recon_loss: 1544447.9891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5485.4292; train_global_loss: 2730361.8447; train_optim_loss: 2730361.8447; val_kl_reg_loss: 19689.0038; val_edge_recon_loss: 700484.7872; val_cat_covariates_contrastive_loss: 477032.4828; val_gene_expr_recon_loss: 1552787.4143; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5485.6431; val_global_loss: 2755479.4458; val_optim_loss: 2755479.4458
Epoch 67/400 |███-----------------| 16.8% val_auroc_score: 0.9366; val_auprc_score: 0.9866; val_best_acc_score: 0.9362; val_best_f1_score: 0.9640; train_kl_reg_loss: 19762.4452; train_edge_recon_loss: 683675.1010; train_cat_covariates_contrastive_loss: 476748.3231; train_gene_expr_recon_loss: 1544881.7208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5486.1558; train_global_loss: 2730553.7433; train_optim_loss: 2730553.7433; val_kl_reg_loss: 19674.3672; val_edge_recon_loss: 703335.3808; val_cat_covariates_contrastive_loss: 476651.7656; val_gene_expr_recon_loss: 1553662.0490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5485.4326; val_global_loss: 2758809.0682; val_optim_loss: 2758809.0682
Epoch 68/400 |███-----------------| 17.0% val_auroc_score: 0.9348; val_auprc_score: 0.9860; val_best_acc_score: 0.9360; val_best_f1_score: 0.9638; train_kl_reg_loss: 19758.3075; train_edge_recon_loss: 682660.4180; train_cat_covariates_contrastive_loss: 476766.2457; train_gene_expr_recon_loss: 1544504.8069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5485.8398; train_global_loss: 2729175.6188; train_optim_loss: 2729175.6188; val_kl_reg_loss: 19674.3849; val_edge_recon_loss: 706780.9836; val_cat_covariates_contrastive_loss: 476703.5788; val_gene_expr_recon_loss: 1553894.6302; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5486.1675; val_global_loss: 2762539.8252; val_optim_loss: 2762539.8252
Epoch 69/400 |███-----------------| 17.2% val_auroc_score: 0.9354; val_auprc_score: 0.9862; val_best_acc_score: 0.9359; val_best_f1_score: 0.9637; train_kl_reg_loss: 19737.2685; train_edge_recon_loss: 682706.5466; train_cat_covariates_contrastive_loss: 476599.0346; train_gene_expr_recon_loss: 1544529.7407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5487.2037; train_global_loss: 2729059.7969; train_optim_loss: 2729059.7969; val_kl_reg_loss: 19673.9542; val_edge_recon_loss: 703292.3571; val_cat_covariates_contrastive_loss: 476487.1951; val_gene_expr_recon_loss: 1552058.6862; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5487.2612; val_global_loss: 2756999.4406; val_optim_loss: 2756999.4406
Epoch 70/400 |███-----------------| 17.5% val_auroc_score: 0.9340; val_auprc_score: 0.9860; val_best_acc_score: 0.9360; val_best_f1_score: 0.9640; train_kl_reg_loss: 19743.9747; train_edge_recon_loss: 686957.4312; train_cat_covariates_contrastive_loss: 476840.5184; train_gene_expr_recon_loss: 1544960.7565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5486.8430; train_global_loss: 2733989.5237; train_optim_loss: 2733989.5237; val_kl_reg_loss: 19668.1915; val_edge_recon_loss: 704153.6703; val_cat_covariates_contrastive_loss: 476820.0782; val_gene_expr_recon_loss: 1553623.9969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5488.9741; val_global_loss: 2759754.9301; val_optim_loss: 2759754.9301

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 71/400 |███-----------------| 17.8% val_auroc_score: 0.9349; val_auprc_score: 0.9862; val_best_acc_score: 0.9357; val_best_f1_score: 0.9637; train_kl_reg_loss: 19739.5453; train_edge_recon_loss: 684598.9966; train_cat_covariates_contrastive_loss: 476655.1133; train_gene_expr_recon_loss: 1544437.2337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5480.3213; train_global_loss: 2730911.1851; train_optim_loss: 2730911.1851; val_kl_reg_loss: 19681.3993; val_edge_recon_loss: 704769.0240; val_cat_covariates_contrastive_loss: 476920.8258; val_gene_expr_recon_loss: 1551415.8099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5479.6636; val_global_loss: 2758266.8129; val_optim_loss: 2758266.8129
Epoch 72/400 |███-----------------| 18.0% val_auroc_score: 0.9342; val_auprc_score: 0.9860; val_best_acc_score: 0.9355; val_best_f1_score: 0.9635; train_kl_reg_loss: 19747.0825; train_edge_recon_loss: 686597.5249; train_cat_covariates_contrastive_loss: 476723.5615; train_gene_expr_recon_loss: 1544587.0971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5479.3968; train_global_loss: 2733134.6525; train_optim_loss: 2733134.6525; val_kl_reg_loss: 19677.0627; val_edge_recon_loss: 711281.1696; val_cat_covariates_contrastive_loss: 477063.6752; val_gene_expr_recon_loss: 1553825.0878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5479.4131; val_global_loss: 2767326.4913; val_optim_loss: 2767326.4913
Epoch 73/400 |███-----------------| 18.2% val_auroc_score: 0.9334; val_auprc_score: 0.9858; val_best_acc_score: 0.9355; val_best_f1_score: 0.9636; train_kl_reg_loss: 19741.1142; train_edge_recon_loss: 684431.4207; train_cat_covariates_contrastive_loss: 476655.5208; train_gene_expr_recon_loss: 1545420.3489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5479.3181; train_global_loss: 2731727.7390; train_optim_loss: 2731727.7390; val_kl_reg_loss: 19675.9101; val_edge_recon_loss: 705185.7404; val_cat_covariates_contrastive_loss: 476662.6111; val_gene_expr_recon_loss: 1553407.4821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5479.1475; val_global_loss: 2760410.9974; val_optim_loss: 2760410.9974
Epoch 74/400 |███-----------------| 18.5% val_auroc_score: 0.9337; val_auprc_score: 0.9859; val_best_acc_score: 0.9349; val_best_f1_score: 0.9632; train_kl_reg_loss: 19749.5174; train_edge_recon_loss: 684065.2142; train_cat_covariates_contrastive_loss: 476728.8293; train_gene_expr_recon_loss: 1545960.0402; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5478.9983; train_global_loss: 2731982.5863; train_optim_loss: 2731982.5863; val_kl_reg_loss: 19659.5811; val_edge_recon_loss: 713426.2910; val_cat_covariates_contrastive_loss: 476967.2564; val_gene_expr_recon_loss: 1554255.8400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5478.8286; val_global_loss: 2769787.7142; val_optim_loss: 2769787.7142

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1309 min 11 sec.
Using best model state, which was in epoch 66.

--- MODEL EVALUATION ---
val AUROC score: 0.9219
val AUPRC score: 0.9801
val best accuracy score: 0.9332
val best F1 score: 0.9622
val target rna MSE score: 0.4015
val source rna MSE score: 0.1550
Val cat covariate0 mean sim diff: -0.0021
Val cat covariate1 mean sim diff: -0.0498
Val cat covariate2 mean sim diff: -0.0007

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
