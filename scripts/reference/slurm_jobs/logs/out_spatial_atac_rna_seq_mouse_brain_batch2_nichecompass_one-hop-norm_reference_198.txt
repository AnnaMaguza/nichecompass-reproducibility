[True]
Run timestamp: 10102023_081009_198.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_198']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7771; val_auprc_score: 0.8023; val_best_acc_score: 0.5668; val_best_f1_score: 0.6933; train_kl_reg_loss: 63371.4164; train_edge_recon_loss: 744511.8192; train_gene_expr_recon_loss: 22014164.7176; train_masked_gp_l1_reg_loss: 88851.8023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2433649.7500; train_chrom_access_recon_loss: 6710605.1908; train_global_loss: 32055154.5344; train_optim_loss: 32055154.5344; val_kl_reg_loss: 80620.1229; val_edge_recon_loss: 812290.9042; val_gene_expr_recon_loss: 20943658.5333; val_masked_gp_l1_reg_loss: 71421.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 952245.0000; val_chrom_access_recon_loss: 6429842.7000; val_global_loss: 29290078.6667; val_optim_loss: 29290078.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8872; val_auprc_score: 0.8834; val_best_acc_score: 0.7827; val_best_f1_score: 0.7861; train_kl_reg_loss: 71450.2468; train_edge_recon_loss: 730918.5892; train_gene_expr_recon_loss: 20879445.0229; train_masked_gp_l1_reg_loss: 71560.0180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 512117.0322; train_chrom_access_recon_loss: 6479600.3969; train_global_loss: 28745091.3130; train_optim_loss: 28745091.3130; val_kl_reg_loss: 61970.4469; val_edge_recon_loss: 789737.4958; val_gene_expr_recon_loss: 20616213.2000; val_masked_gp_l1_reg_loss: 73797.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 279380.6250; val_chrom_access_recon_loss: 6352593.3000; val_global_loss: 28173692.4000; val_optim_loss: 28173692.4000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9049; val_auprc_score: 0.8930; val_best_acc_score: 0.8239; val_best_f1_score: 0.8344; train_kl_reg_loss: 63824.8272; train_edge_recon_loss: 692089.0792; train_gene_expr_recon_loss: 20571846.8092; train_masked_gp_l1_reg_loss: 76389.8662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 212659.0459; train_chrom_access_recon_loss: 6395449.5267; train_global_loss: 28012259.0687; train_optim_loss: 28012259.0687; val_kl_reg_loss: 65096.5633; val_edge_recon_loss: 652357.0917; val_gene_expr_recon_loss: 20496887.8667; val_masked_gp_l1_reg_loss: 79230.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169504.4062; val_chrom_access_recon_loss: 6325577.6667; val_global_loss: 27788653.4667; val_optim_loss: 27788653.4667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9163; val_auprc_score: 0.9020; val_best_acc_score: 0.8344; val_best_f1_score: 0.8460; train_kl_reg_loss: 72287.1190; train_edge_recon_loss: 631450.7567; train_gene_expr_recon_loss: 20342385.1298; train_masked_gp_l1_reg_loss: 80925.8869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144056.3981; train_chrom_access_recon_loss: 6332340.4427; train_global_loss: 27603445.9084; train_optim_loss: 27603445.9084; val_kl_reg_loss: 70827.5927; val_edge_recon_loss: 623653.2958; val_gene_expr_recon_loss: 20262569.4667; val_masked_gp_l1_reg_loss: 83153.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124474.9531; val_chrom_access_recon_loss: 6245546.2000; val_global_loss: 27410224.5333; val_optim_loss: 27410224.5333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9250; val_auprc_score: 0.9126; val_best_acc_score: 0.8473; val_best_f1_score: 0.8569; train_kl_reg_loss: 69850.6093; train_edge_recon_loss: 618308.9828; train_gene_expr_recon_loss: 20152345.6641; train_masked_gp_l1_reg_loss: 84403.2294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112056.9781; train_chrom_access_recon_loss: 6275036.7786; train_global_loss: 27312002.3817; train_optim_loss: 27312002.3817; val_kl_reg_loss: 67910.3346; val_edge_recon_loss: 619524.0250; val_gene_expr_recon_loss: 19952857.3333; val_masked_gp_l1_reg_loss: 85911.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102717.3594; val_chrom_access_recon_loss: 6216576.8000; val_global_loss: 27045498.5333; val_optim_loss: 27045498.5333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9387; val_auprc_score: 0.9236; val_best_acc_score: 0.8755; val_best_f1_score: 0.8806; train_kl_reg_loss: 68052.0637; train_edge_recon_loss: 608801.7853; train_gene_expr_recon_loss: 20001766.4580; train_masked_gp_l1_reg_loss: 87035.4654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96918.9482; train_chrom_access_recon_loss: 6235625.2672; train_global_loss: 27098199.9542; train_optim_loss: 27098199.9542; val_kl_reg_loss: 67564.1693; val_edge_recon_loss: 603648.3583; val_gene_expr_recon_loss: 19924801.7333; val_masked_gp_l1_reg_loss: 88100.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93039.4688; val_chrom_access_recon_loss: 6165673.1000; val_global_loss: 26942827.6000; val_optim_loss: 26942827.6000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9458; val_auprc_score: 0.9338; val_best_acc_score: 0.8813; val_best_f1_score: 0.8863; train_kl_reg_loss: 66817.6799; train_edge_recon_loss: 602084.0234; train_gene_expr_recon_loss: 19877570.9924; train_masked_gp_l1_reg_loss: 89022.8939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90285.4441; train_chrom_access_recon_loss: 6188946.3397; train_global_loss: 26914727.4504; train_optim_loss: 26914727.4504; val_kl_reg_loss: 65393.1286; val_edge_recon_loss: 601125.3125; val_gene_expr_recon_loss: 19767004.0000; val_masked_gp_l1_reg_loss: 89937.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87788.6797; val_chrom_access_recon_loss: 6092697.5667; val_global_loss: 26703946.1333; val_optim_loss: 26703946.1333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9455; val_auprc_score: 0.9328; val_best_acc_score: 0.8826; val_best_f1_score: 0.8891; train_kl_reg_loss: 65582.8878; train_edge_recon_loss: 596600.8683; train_gene_expr_recon_loss: 19708958.4427; train_masked_gp_l1_reg_loss: 90749.8714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85343.5018; train_chrom_access_recon_loss: 6137710.7901; train_global_loss: 26684946.2137; train_optim_loss: 26684946.2137; val_kl_reg_loss: 64824.7406; val_edge_recon_loss: 597995.3583; val_gene_expr_recon_loss: 19574053.0667; val_masked_gp_l1_reg_loss: 91914.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83869.1406; val_chrom_access_recon_loss: 6033539.1333; val_global_loss: 26446195.8667; val_optim_loss: 26446195.8667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9490; val_auprc_score: 0.9348; val_best_acc_score: 0.8871; val_best_f1_score: 0.8929; train_kl_reg_loss: 64261.9705; train_edge_recon_loss: 591681.0534; train_gene_expr_recon_loss: 19628540.3817; train_masked_gp_l1_reg_loss: 92301.7409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82076.5950; train_chrom_access_recon_loss: 6115858.8893; train_global_loss: 26574720.6565; train_optim_loss: 26574720.6565; val_kl_reg_loss: 64044.9766; val_edge_recon_loss: 593274.5542; val_gene_expr_recon_loss: 19537608.1333; val_masked_gp_l1_reg_loss: 92937.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80107.1953; val_chrom_access_recon_loss: 6028958.3667; val_global_loss: 26396932.1333; val_optim_loss: 26396932.1333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9548; val_auprc_score: 0.9435; val_best_acc_score: 0.8950; val_best_f1_score: 0.8998; train_kl_reg_loss: 63052.4394; train_edge_recon_loss: 591188.0759; train_gene_expr_recon_loss: 19522044.9466; train_masked_gp_l1_reg_loss: 93526.9148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78858.8757; train_chrom_access_recon_loss: 6083673.1718; train_global_loss: 26432344.4122; train_optim_loss: 26432344.4122; val_kl_reg_loss: 61248.6854; val_edge_recon_loss: 591001.5833; val_gene_expr_recon_loss: 19448324.6667; val_masked_gp_l1_reg_loss: 94487.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78660.6250; val_chrom_access_recon_loss: 6003413.1000; val_global_loss: 26277136.2667; val_optim_loss: 26277136.2667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9560; val_auprc_score: 0.9440; val_best_acc_score: 0.8977; val_best_f1_score: 0.9016; train_kl_reg_loss: 62527.9063; train_edge_recon_loss: 585846.2304; train_gene_expr_recon_loss: 19433479.2519; train_masked_gp_l1_reg_loss: 94563.2183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76978.6404; train_chrom_access_recon_loss: 6052116.6221; train_global_loss: 26305511.8779; train_optim_loss: 26305511.8779; val_kl_reg_loss: 63480.5456; val_edge_recon_loss: 590807.2083; val_gene_expr_recon_loss: 19317311.2000; val_masked_gp_l1_reg_loss: 95240.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76665.2891; val_chrom_access_recon_loss: 5969003.6000; val_global_loss: 26112508.1333; val_optim_loss: 26112508.1333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9576; val_auprc_score: 0.9457; val_best_acc_score: 0.8988; val_best_f1_score: 0.9032; train_kl_reg_loss: 61603.2995; train_edge_recon_loss: 586406.9499; train_gene_expr_recon_loss: 19346680.9313; train_masked_gp_l1_reg_loss: 95624.4473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75697.4067; train_chrom_access_recon_loss: 6021463.0992; train_global_loss: 26187476.2901; train_optim_loss: 26187476.2901; val_kl_reg_loss: 59901.1857; val_edge_recon_loss: 587176.0250; val_gene_expr_recon_loss: 19321274.2667; val_masked_gp_l1_reg_loss: 96329.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75530.9688; val_chrom_access_recon_loss: 5954218.6333; val_global_loss: 26094430.0000; val_optim_loss: 26094430.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9611; val_auprc_score: 0.9501; val_best_acc_score: 0.9092; val_best_f1_score: 0.9130; train_kl_reg_loss: 60756.1945; train_edge_recon_loss: 583255.8898; train_gene_expr_recon_loss: 19264934.1985; train_masked_gp_l1_reg_loss: 96605.4151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74874.8577; train_chrom_access_recon_loss: 5982745.1298; train_global_loss: 26063171.5878; train_optim_loss: 26063171.5878; val_kl_reg_loss: 59303.7893; val_edge_recon_loss: 583672.4833; val_gene_expr_recon_loss: 19224155.0667; val_masked_gp_l1_reg_loss: 97269.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74893.6094; val_chrom_access_recon_loss: 5902257.3000; val_global_loss: 25941553.0667; val_optim_loss: 25941553.0667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9593; val_auprc_score: 0.9471; val_best_acc_score: 0.9051; val_best_f1_score: 0.9085; train_kl_reg_loss: 60006.5798; train_edge_recon_loss: 584768.7004; train_gene_expr_recon_loss: 19196394.5802; train_masked_gp_l1_reg_loss: 98057.7982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74362.7154; train_chrom_access_recon_loss: 5956820.4847; train_global_loss: 25970410.8855; train_optim_loss: 25970410.8855; val_kl_reg_loss: 59253.1456; val_edge_recon_loss: 585482.9292; val_gene_expr_recon_loss: 19190964.5333; val_masked_gp_l1_reg_loss: 98523.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73510.3203; val_chrom_access_recon_loss: 5932033.5000; val_global_loss: 25939768.0000; val_optim_loss: 25939768.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9631; val_auprc_score: 0.9513; val_best_acc_score: 0.9095; val_best_f1_score: 0.9128; train_kl_reg_loss: 59788.5927; train_edge_recon_loss: 581092.6770; train_gene_expr_recon_loss: 19130768.1221; train_masked_gp_l1_reg_loss: 99129.3502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73663.5443; train_chrom_access_recon_loss: 5935748.5038; train_global_loss: 25880190.7176; train_optim_loss: 25880190.7176; val_kl_reg_loss: 59584.6055; val_edge_recon_loss: 583514.8042; val_gene_expr_recon_loss: 19073092.8000; val_masked_gp_l1_reg_loss: 100070.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74582.3672; val_chrom_access_recon_loss: 5870530.8333; val_global_loss: 25761375.0667; val_optim_loss: 25761375.0667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9626; val_auprc_score: 0.9511; val_best_acc_score: 0.9097; val_best_f1_score: 0.9141; train_kl_reg_loss: 58910.4809; train_edge_recon_loss: 580989.5401; train_gene_expr_recon_loss: 19040509.9542; train_masked_gp_l1_reg_loss: 100636.4030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73911.2397; train_chrom_access_recon_loss: 5904903.4809; train_global_loss: 25759861.1450; train_optim_loss: 25759861.1450; val_kl_reg_loss: 59045.8206; val_edge_recon_loss: 582476.7583; val_gene_expr_recon_loss: 18929378.6667; val_masked_gp_l1_reg_loss: 101724.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74321.1562; val_chrom_access_recon_loss: 5824129.0333; val_global_loss: 25571076.4000; val_optim_loss: 25571076.4000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9659; val_auprc_score: 0.9572; val_best_acc_score: 0.9146; val_best_f1_score: 0.9180; train_kl_reg_loss: 58406.3999; train_edge_recon_loss: 578842.6178; train_gene_expr_recon_loss: 18984668.2290; train_masked_gp_l1_reg_loss: 102411.0677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74065.4813; train_chrom_access_recon_loss: 5877607.3321; train_global_loss: 25676001.2366; train_optim_loss: 25676001.2366; val_kl_reg_loss: 60147.7339; val_edge_recon_loss: 582882.5542; val_gene_expr_recon_loss: 19026513.0667; val_masked_gp_l1_reg_loss: 103568.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74099.4531; val_chrom_access_recon_loss: 5850782.1667; val_global_loss: 25697993.8667; val_optim_loss: 25697993.8667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9665; val_auprc_score: 0.9585; val_best_acc_score: 0.9127; val_best_f1_score: 0.9166; train_kl_reg_loss: 57931.6563; train_edge_recon_loss: 580435.4699; train_gene_expr_recon_loss: 18895377.9847; train_masked_gp_l1_reg_loss: 104300.9881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74108.1127; train_chrom_access_recon_loss: 5852332.1183; train_global_loss: 25564486.1985; train_optim_loss: 25564486.1985; val_kl_reg_loss: 58714.6742; val_edge_recon_loss: 582217.8458; val_gene_expr_recon_loss: 18924378.2667; val_masked_gp_l1_reg_loss: 105196.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73968.6016; val_chrom_access_recon_loss: 5805758.0333; val_global_loss: 25550232.6667; val_optim_loss: 25550232.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9671; val_auprc_score: 0.9576; val_best_acc_score: 0.9138; val_best_f1_score: 0.9170; train_kl_reg_loss: 57832.2188; train_edge_recon_loss: 578339.9981; train_gene_expr_recon_loss: 18837430.4580; train_masked_gp_l1_reg_loss: 106017.4837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74298.3719; train_chrom_access_recon_loss: 5830901.7023; train_global_loss: 25484820.2595; train_optim_loss: 25484820.2595; val_kl_reg_loss: 57540.9029; val_edge_recon_loss: 582820.8667; val_gene_expr_recon_loss: 18801433.4667; val_masked_gp_l1_reg_loss: 107018.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75068.3906; val_chrom_access_recon_loss: 5774850.6667; val_global_loss: 25398731.8667; val_optim_loss: 25398731.8667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9669; val_auprc_score: 0.9594; val_best_acc_score: 0.9146; val_best_f1_score: 0.9173; train_kl_reg_loss: 57354.2518; train_edge_recon_loss: 578763.6240; train_gene_expr_recon_loss: 18774752.2443; train_masked_gp_l1_reg_loss: 107930.6813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74718.9799; train_chrom_access_recon_loss: 5809561.7137; train_global_loss: 25403081.4809; train_optim_loss: 25403081.4809; val_kl_reg_loss: 55659.0867; val_edge_recon_loss: 580005.8292; val_gene_expr_recon_loss: 18780812.4000; val_masked_gp_l1_reg_loss: 108777.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75110.6562; val_chrom_access_recon_loss: 5777747.5667; val_global_loss: 25378113.0667; val_optim_loss: 25378113.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9646; val_auprc_score: 0.9496; val_best_acc_score: 0.9151; val_best_f1_score: 0.9178; train_kl_reg_loss: 57588.1833; train_edge_recon_loss: 576998.3392; train_gene_expr_recon_loss: 18692872.7328; train_masked_gp_l1_reg_loss: 109527.6870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75098.7756; train_chrom_access_recon_loss: 5776299.3092; train_global_loss: 25288384.9160; train_optim_loss: 25288384.9160; val_kl_reg_loss: 59156.7581; val_edge_recon_loss: 582339.5208; val_gene_expr_recon_loss: 18722297.6000; val_masked_gp_l1_reg_loss: 110786.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75762.3438; val_chrom_access_recon_loss: 5742713.8333; val_global_loss: 25293055.7333; val_optim_loss: 25293055.7333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9644; val_auprc_score: 0.9516; val_best_acc_score: 0.9105; val_best_f1_score: 0.9144; train_kl_reg_loss: 57797.8960; train_edge_recon_loss: 577953.1489; train_gene_expr_recon_loss: 18626627.3893; train_masked_gp_l1_reg_loss: 111089.7286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75547.1137; train_chrom_access_recon_loss: 5761766.6870; train_global_loss: 25210782.0305; train_optim_loss: 25210782.0305; val_kl_reg_loss: 58126.6427; val_edge_recon_loss: 581550.2375; val_gene_expr_recon_loss: 18715854.2667; val_masked_gp_l1_reg_loss: 111638.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76204.0234; val_chrom_access_recon_loss: 5741001.5667; val_global_loss: 25284374.8000; val_optim_loss: 25284374.8000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9646; val_auprc_score: 0.9513; val_best_acc_score: 0.9151; val_best_f1_score: 0.9179; train_kl_reg_loss: 57786.2324; train_edge_recon_loss: 577803.0157; train_gene_expr_recon_loss: 18568765.9389; train_masked_gp_l1_reg_loss: 112469.0110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75949.1817; train_chrom_access_recon_loss: 5738828.8855; train_global_loss: 25131602.3206; train_optim_loss: 25131602.3206; val_kl_reg_loss: 58163.5141; val_edge_recon_loss: 582878.4542; val_gene_expr_recon_loss: 18596929.6000; val_masked_gp_l1_reg_loss: 112988.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76161.6328; val_chrom_access_recon_loss: 5691492.8333; val_global_loss: 25118614.4000; val_optim_loss: 25118614.4000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9646; val_auprc_score: 0.9540; val_best_acc_score: 0.9139; val_best_f1_score: 0.9181; train_kl_reg_loss: 58036.1318; train_edge_recon_loss: 578428.6355; train_gene_expr_recon_loss: 18515760.9313; train_masked_gp_l1_reg_loss: 113708.3348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76403.5500; train_chrom_access_recon_loss: 5726693.5038; train_global_loss: 25069031.0687; train_optim_loss: 25069031.0687; val_kl_reg_loss: 58380.7852; val_edge_recon_loss: 582406.8375; val_gene_expr_recon_loss: 18581336.6667; val_masked_gp_l1_reg_loss: 114321.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76713.7656; val_chrom_access_recon_loss: 5718423.1333; val_global_loss: 25131583.4667; val_optim_loss: 25131583.4667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9593; val_auprc_score: 0.9454; val_best_acc_score: 0.9061; val_best_f1_score: 0.9102; train_kl_reg_loss: 59118.5001; train_edge_recon_loss: 577345.9241; train_gene_expr_recon_loss: 18484195.7557; train_masked_gp_l1_reg_loss: 114767.8291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76928.5204; train_chrom_access_recon_loss: 5711802.1985; train_global_loss: 25024158.8092; train_optim_loss: 25024158.8092; val_kl_reg_loss: 59236.2464; val_edge_recon_loss: 585899.0792; val_gene_expr_recon_loss: 18572418.4000; val_masked_gp_l1_reg_loss: 115179.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77753.4609; val_chrom_access_recon_loss: 5688591.9000; val_global_loss: 25099079.6000; val_optim_loss: 25099079.6000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8768; val_auprc_score: 0.8683; val_best_acc_score: 0.7874; val_best_f1_score: 0.8070; train_kl_reg_loss: 26426.6465; train_edge_recon_loss: 743946.4823; train_gene_expr_recon_loss: 17987102.7710; train_masked_gp_l1_reg_loss: 115683.0298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79443.5163; train_chrom_access_recon_loss: 5607793.2214; train_global_loss: 24560395.7405; train_optim_loss: 24560395.7405; val_kl_reg_loss: 7917.4967; val_edge_recon_loss: 780980.3833; val_gene_expr_recon_loss: 17759819.6000; val_masked_gp_l1_reg_loss: 116756.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91243.8906; val_chrom_access_recon_loss: 5516813.2000; val_global_loss: 24273530.6667; val_optim_loss: 24273530.6667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8676; val_auprc_score: 0.8552; val_best_acc_score: 0.7687; val_best_f1_score: 0.7990; train_kl_reg_loss: 12626.2718; train_edge_recon_loss: 764570.7696; train_gene_expr_recon_loss: 17893401.4580; train_masked_gp_l1_reg_loss: 115504.2487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93808.9513; train_chrom_access_recon_loss: 5577534.4771; train_global_loss: 24457446.2595; train_optim_loss: 24457446.2595; val_kl_reg_loss: 16098.9573; val_edge_recon_loss: 787347.8708; val_gene_expr_recon_loss: 17729516.5333; val_masked_gp_l1_reg_loss: 113740.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94548.4297; val_chrom_access_recon_loss: 5497647.4667; val_global_loss: 24238898.8000; val_optim_loss: 24238898.8000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8622; val_auprc_score: 0.8520; val_best_acc_score: 0.7798; val_best_f1_score: 0.7963; train_kl_reg_loss: 14256.1884; train_edge_recon_loss: 755081.4318; train_gene_expr_recon_loss: 17725171.5573; train_masked_gp_l1_reg_loss: 110370.0051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93595.7602; train_chrom_access_recon_loss: 5557047.9695; train_global_loss: 24255522.9771; train_optim_loss: 24255522.9771; val_kl_reg_loss: 9466.9969; val_edge_recon_loss: 774240.3417; val_gene_expr_recon_loss: 17771050.0000; val_masked_gp_l1_reg_loss: 107768.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93336.8750; val_chrom_access_recon_loss: 5485457.7667; val_global_loss: 24241318.9333; val_optim_loss: 24241318.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8266; val_auprc_score: 0.8135; val_best_acc_score: 0.7359; val_best_f1_score: 0.7766; train_kl_reg_loss: 12446.2515; train_edge_recon_loss: 761939.2400; train_gene_expr_recon_loss: 17746283.6412; train_masked_gp_l1_reg_loss: 105332.3359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92737.2115; train_chrom_access_recon_loss: 5563177.8779; train_global_loss: 24281916.5344; train_optim_loss: 24281916.5344; val_kl_reg_loss: 9078.9592; val_edge_recon_loss: 791145.7208; val_gene_expr_recon_loss: 17622722.0000; val_masked_gp_l1_reg_loss: 102473.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90496.8750; val_chrom_access_recon_loss: 5486536.9667; val_global_loss: 24102453.6000; val_optim_loss: 24102453.6000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8736; val_auprc_score: 0.8571; val_best_acc_score: 0.7930; val_best_f1_score: 0.8158; train_kl_reg_loss: 11997.4413; train_edge_recon_loss: 765839.8769; train_gene_expr_recon_loss: 17641782.4198; train_masked_gp_l1_reg_loss: 100756.6076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89576.1062; train_chrom_access_recon_loss: 5536025.4885; train_global_loss: 24145978.0458; train_optim_loss: 24145978.0458; val_kl_reg_loss: 11292.1842; val_edge_recon_loss: 753158.1750; val_gene_expr_recon_loss: 17564519.1333; val_masked_gp_l1_reg_loss: 97971.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86740.6797; val_chrom_access_recon_loss: 5454874.5000; val_global_loss: 23968555.8667; val_optim_loss: 23968555.8667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8776; val_auprc_score: 0.8590; val_best_acc_score: 0.7999; val_best_f1_score: 0.8221; train_kl_reg_loss: 15756.4999; train_edge_recon_loss: 722576.4094; train_gene_expr_recon_loss: 17621624.9618; train_masked_gp_l1_reg_loss: 95982.9842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85360.1169; train_chrom_access_recon_loss: 5531434.3511; train_global_loss: 24072735.1450; train_optim_loss: 24072735.1450; val_kl_reg_loss: 14296.4830; val_edge_recon_loss: 711523.0250; val_gene_expr_recon_loss: 17545020.0000; val_masked_gp_l1_reg_loss: 93972.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83799.1406; val_chrom_access_recon_loss: 5485475.6667; val_global_loss: 23934087.0667; val_optim_loss: 23934087.0667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8673; val_auprc_score: 0.8424; val_best_acc_score: 0.7961; val_best_f1_score: 0.8229; train_kl_reg_loss: 16726.8714; train_edge_recon_loss: 701575.3826; train_gene_expr_recon_loss: 17621268.8702; train_masked_gp_l1_reg_loss: 92931.1418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83457.4600; train_chrom_access_recon_loss: 5543032.9313; train_global_loss: 24058992.4733; train_optim_loss: 24058992.4733; val_kl_reg_loss: 13006.1395; val_edge_recon_loss: 694467.4583; val_gene_expr_recon_loss: 17561747.0667; val_masked_gp_l1_reg_loss: 92450.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82998.0469; val_chrom_access_recon_loss: 5474068.4667; val_global_loss: 23918737.4667; val_optim_loss: 23918737.4667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8696; val_auprc_score: 0.8474; val_best_acc_score: 0.7933; val_best_f1_score: 0.8181; train_kl_reg_loss: 17081.9378; train_edge_recon_loss: 676482.0706; train_gene_expr_recon_loss: 17533883.7939; train_masked_gp_l1_reg_loss: 91626.4597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81270.8527; train_chrom_access_recon_loss: 5512175.7061; train_global_loss: 23912520.9313; train_optim_loss: 23912520.9313; val_kl_reg_loss: 16189.0494; val_edge_recon_loss: 669782.8708; val_gene_expr_recon_loss: 17517536.2667; val_masked_gp_l1_reg_loss: 90875.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80146.9922; val_chrom_access_recon_loss: 5457399.5667; val_global_loss: 23831929.4667; val_optim_loss: 23831929.4667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8709; val_auprc_score: 0.8500; val_best_acc_score: 0.7987; val_best_f1_score: 0.8242; train_kl_reg_loss: 19980.9605; train_edge_recon_loss: 655751.7261; train_gene_expr_recon_loss: 17501593.3969; train_masked_gp_l1_reg_loss: 90062.1206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78262.8002; train_chrom_access_recon_loss: 5504602.2328; train_global_loss: 23850253.2519; train_optim_loss: 23850253.2519; val_kl_reg_loss: 18439.6540; val_edge_recon_loss: 651556.3750; val_gene_expr_recon_loss: 17441968.6667; val_masked_gp_l1_reg_loss: 89079.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76569.0859; val_chrom_access_recon_loss: 5421171.2000; val_global_loss: 23698786.0000; val_optim_loss: 23698786.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8737; val_auprc_score: 0.8556; val_best_acc_score: 0.7947; val_best_f1_score: 0.8211; train_kl_reg_loss: 23118.3354; train_edge_recon_loss: 642307.8898; train_gene_expr_recon_loss: 17471412.7481; train_masked_gp_l1_reg_loss: 88216.2013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75311.2858; train_chrom_access_recon_loss: 5495311.0802; train_global_loss: 23795677.6641; train_optim_loss: 23795677.6641; val_kl_reg_loss: 20780.6010; val_edge_recon_loss: 641340.6833; val_gene_expr_recon_loss: 17424635.8000; val_masked_gp_l1_reg_loss: 87898.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74787.0234; val_chrom_access_recon_loss: 5432970.1333; val_global_loss: 23682413.6000; val_optim_loss: 23682413.6000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8729; val_auprc_score: 0.8506; val_best_acc_score: 0.8009; val_best_f1_score: 0.8259; train_kl_reg_loss: 24664.4546; train_edge_recon_loss: 631308.2915; train_gene_expr_recon_loss: 17439278.5344; train_masked_gp_l1_reg_loss: 87423.0631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74343.6941; train_chrom_access_recon_loss: 5490053.5840; train_global_loss: 23747071.5573; train_optim_loss: 23747071.5573; val_kl_reg_loss: 20111.2204; val_edge_recon_loss: 630546.9292; val_gene_expr_recon_loss: 17378537.6667; val_masked_gp_l1_reg_loss: 87323.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74454.0703; val_chrom_access_recon_loss: 5427203.4667; val_global_loss: 23618176.9333; val_optim_loss: 23618176.9333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8782; val_auprc_score: 0.8608; val_best_acc_score: 0.7976; val_best_f1_score: 0.8221; train_kl_reg_loss: 25247.8733; train_edge_recon_loss: 623564.6193; train_gene_expr_recon_loss: 17425980.7328; train_masked_gp_l1_reg_loss: 86883.7374; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73916.4193; train_chrom_access_recon_loss: 5489926.8168; train_global_loss: 23725520.1374; train_optim_loss: 23725520.1374; val_kl_reg_loss: 24076.0557; val_edge_recon_loss: 618160.5125; val_gene_expr_recon_loss: 17458729.5333; val_masked_gp_l1_reg_loss: 86321.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73011.2656; val_chrom_access_recon_loss: 5451079.5000; val_global_loss: 23711380.0000; val_optim_loss: 23711380.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8750; val_auprc_score: 0.8534; val_best_acc_score: 0.7968; val_best_f1_score: 0.8236; train_kl_reg_loss: 28080.7776; train_edge_recon_loss: 614055.3550; train_gene_expr_recon_loss: 17411495.3435; train_masked_gp_l1_reg_loss: 85569.5710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72098.3284; train_chrom_access_recon_loss: 5483683.4198; train_global_loss: 23694982.9618; train_optim_loss: 23694982.9618; val_kl_reg_loss: 26425.1365; val_edge_recon_loss: 615617.4333; val_gene_expr_recon_loss: 17444752.7333; val_masked_gp_l1_reg_loss: 85138.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71474.8906; val_chrom_access_recon_loss: 5423170.6333; val_global_loss: 23666578.0000; val_optim_loss: 23666578.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8827; val_auprc_score: 0.8646; val_best_acc_score: 0.8021; val_best_f1_score: 0.8248; train_kl_reg_loss: 30427.6806; train_edge_recon_loss: 608657.3483; train_gene_expr_recon_loss: 17400634.8931; train_masked_gp_l1_reg_loss: 84550.2838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70915.4546; train_chrom_access_recon_loss: 5482321.1985; train_global_loss: 23677506.9313; train_optim_loss: 23677506.9313; val_kl_reg_loss: 28290.3365; val_edge_recon_loss: 609071.2833; val_gene_expr_recon_loss: 17380806.6667; val_masked_gp_l1_reg_loss: 84084.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70285.6406; val_chrom_access_recon_loss: 5418910.2333; val_global_loss: 23591448.1333; val_optim_loss: 23591448.1333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8823; val_auprc_score: 0.8640; val_best_acc_score: 0.8017; val_best_f1_score: 0.8252; train_kl_reg_loss: 32124.0506; train_edge_recon_loss: 607558.5778; train_gene_expr_recon_loss: 17371551.6641; train_masked_gp_l1_reg_loss: 83604.6113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70178.2273; train_chrom_access_recon_loss: 5477055.5344; train_global_loss: 23642072.7176; train_optim_loss: 23642072.7176; val_kl_reg_loss: 29334.4763; val_edge_recon_loss: 608589.2042; val_gene_expr_recon_loss: 17298521.2000; val_masked_gp_l1_reg_loss: 83121.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69846.8906; val_chrom_access_recon_loss: 5400942.0333; val_global_loss: 23490355.2000; val_optim_loss: 23490355.2000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8888; val_auprc_score: 0.8732; val_best_acc_score: 0.8036; val_best_f1_score: 0.8260; train_kl_reg_loss: 33315.1520; train_edge_recon_loss: 601921.4203; train_gene_expr_recon_loss: 17370021.2595; train_masked_gp_l1_reg_loss: 82731.1447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69518.0967; train_chrom_access_recon_loss: 5472306.3206; train_global_loss: 23629813.4046; train_optim_loss: 23629813.4046; val_kl_reg_loss: 31203.3164; val_edge_recon_loss: 606241.3250; val_gene_expr_recon_loss: 17371526.7333; val_masked_gp_l1_reg_loss: 82425.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69452.0312; val_chrom_access_recon_loss: 5434542.9667; val_global_loss: 23595392.5333; val_optim_loss: 23595392.5333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8925; val_auprc_score: 0.8725; val_best_acc_score: 0.8081; val_best_f1_score: 0.8290; train_kl_reg_loss: 34071.0017; train_edge_recon_loss: 601564.1865; train_gene_expr_recon_loss: 17349905.1069; train_masked_gp_l1_reg_loss: 82060.8123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69110.7602; train_chrom_access_recon_loss: 5473772.2634; train_global_loss: 23610484.1374; train_optim_loss: 23610484.1374; val_kl_reg_loss: 32284.1857; val_edge_recon_loss: 604776.6292; val_gene_expr_recon_loss: 17351571.1333; val_masked_gp_l1_reg_loss: 81795.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68851.8203; val_chrom_access_recon_loss: 5398090.8667; val_global_loss: 23537371.3333; val_optim_loss: 23537371.3333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8970; val_auprc_score: 0.8776; val_best_acc_score: 0.8174; val_best_f1_score: 0.8362; train_kl_reg_loss: 34651.0923; train_edge_recon_loss: 599368.6198; train_gene_expr_recon_loss: 17343948.5954; train_masked_gp_l1_reg_loss: 81446.8357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68725.8610; train_chrom_access_recon_loss: 5474368.0115; train_global_loss: 23602509.0382; train_optim_loss: 23602509.0382; val_kl_reg_loss: 32540.7501; val_edge_recon_loss: 597955.3333; val_gene_expr_recon_loss: 17372464.2000; val_masked_gp_l1_reg_loss: 81170.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68630.7891; val_chrom_access_recon_loss: 5400774.7000; val_global_loss: 23553535.2000; val_optim_loss: 23553535.2000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9035; val_auprc_score: 0.8857; val_best_acc_score: 0.8230; val_best_f1_score: 0.8394; train_kl_reg_loss: 35378.3180; train_edge_recon_loss: 595151.0887; train_gene_expr_recon_loss: 17324445.3053; train_masked_gp_l1_reg_loss: 80833.8803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68339.2878; train_chrom_access_recon_loss: 5470334.9084; train_global_loss: 23574482.8092; train_optim_loss: 23574482.8092; val_kl_reg_loss: 34045.1780; val_edge_recon_loss: 594571.9583; val_gene_expr_recon_loss: 17320809.2000; val_masked_gp_l1_reg_loss: 80433.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68031.1953; val_chrom_access_recon_loss: 5401561.6000; val_global_loss: 23499454.0000; val_optim_loss: 23499454.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9079; val_auprc_score: 0.8908; val_best_acc_score: 0.8273; val_best_f1_score: 0.8429; train_kl_reg_loss: 36179.8138; train_edge_recon_loss: 592889.4594; train_gene_expr_recon_loss: 17289956.5878; train_masked_gp_l1_reg_loss: 78376.4536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58763.4307; train_chrom_access_recon_loss: 5453973.7977; train_global_loss: 23510139.5878; train_optim_loss: 23510139.5878; val_kl_reg_loss: 34529.2570; val_edge_recon_loss: 591593.9792; val_gene_expr_recon_loss: 17214430.6667; val_masked_gp_l1_reg_loss: 77837.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57197.0117; val_chrom_access_recon_loss: 5369036.0667; val_global_loss: 23344625.8667; val_optim_loss: 23344625.8667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9049; val_auprc_score: 0.8889; val_best_acc_score: 0.8247; val_best_f1_score: 0.8403; train_kl_reg_loss: 36504.7046; train_edge_recon_loss: 594792.3516; train_gene_expr_recon_loss: 17269040.5649; train_masked_gp_l1_reg_loss: 77678.1893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56773.7821; train_chrom_access_recon_loss: 5445139.3893; train_global_loss: 23479929.0229; train_optim_loss: 23479929.0229; val_kl_reg_loss: 35047.4633; val_edge_recon_loss: 591237.2333; val_gene_expr_recon_loss: 17320429.8667; val_masked_gp_l1_reg_loss: 77540.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56400.0469; val_chrom_access_recon_loss: 5426717.4333; val_global_loss: 23507372.1333; val_optim_loss: 23507372.1333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9094; val_auprc_score: 0.8954; val_best_acc_score: 0.8297; val_best_f1_score: 0.8428; train_kl_reg_loss: 36861.6430; train_edge_recon_loss: 593888.4523; train_gene_expr_recon_loss: 17269360.7176; train_masked_gp_l1_reg_loss: 77446.6747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56164.2850; train_chrom_access_recon_loss: 5445836.2634; train_global_loss: 23479557.9695; train_optim_loss: 23479557.9695; val_kl_reg_loss: 35221.0633; val_edge_recon_loss: 596409.9083; val_gene_expr_recon_loss: 17302665.8667; val_masked_gp_l1_reg_loss: 77351.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55865.7422; val_chrom_access_recon_loss: 5376758.0000; val_global_loss: 23444272.9333; val_optim_loss: 23444272.9333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9019; val_auprc_score: 0.8821; val_best_acc_score: 0.8208; val_best_f1_score: 0.8378; train_kl_reg_loss: 37018.2004; train_edge_recon_loss: 592150.9814; train_gene_expr_recon_loss: 17270395.5115; train_masked_gp_l1_reg_loss: 77255.4535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55660.2417; train_chrom_access_recon_loss: 5447227.3053; train_global_loss: 23479707.7557; train_optim_loss: 23479707.7557; val_kl_reg_loss: 35255.3605; val_edge_recon_loss: 597552.3875; val_gene_expr_recon_loss: 17235404.0000; val_masked_gp_l1_reg_loss: 77186.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55492.8633; val_chrom_access_recon_loss: 5378254.9333; val_global_loss: 23379144.8000; val_optim_loss: 23379144.8000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8994; val_auprc_score: 0.8795; val_best_acc_score: 0.8228; val_best_f1_score: 0.8373; train_kl_reg_loss: 37122.0338; train_edge_recon_loss: 594767.3263; train_gene_expr_recon_loss: 17259616.0000; train_masked_gp_l1_reg_loss: 77106.9566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55326.5915; train_chrom_access_recon_loss: 5443122.6069; train_global_loss: 23467061.4046; train_optim_loss: 23467061.4046; val_kl_reg_loss: 35631.3732; val_edge_recon_loss: 600394.7292; val_gene_expr_recon_loss: 17178907.7333; val_masked_gp_l1_reg_loss: 77040.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55101.0234; val_chrom_access_recon_loss: 5356377.1667; val_global_loss: 23303452.9333; val_optim_loss: 23303452.9333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9125; val_auprc_score: 0.8976; val_best_acc_score: 0.8298; val_best_f1_score: 0.8425; train_kl_reg_loss: 37345.4014; train_edge_recon_loss: 593763.0487; train_gene_expr_recon_loss: 17261858.3588; train_masked_gp_l1_reg_loss: 76951.7957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54947.8920; train_chrom_access_recon_loss: 5444569.2405; train_global_loss: 23469435.6794; train_optim_loss: 23469435.6794; val_kl_reg_loss: 35678.5495; val_edge_recon_loss: 592154.5833; val_gene_expr_recon_loss: 17314984.6000; val_masked_gp_l1_reg_loss: 76882.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54746.2109; val_chrom_access_recon_loss: 5404534.0000; val_global_loss: 23478979.3333; val_optim_loss: 23478979.3333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9064; val_auprc_score: 0.8893; val_best_acc_score: 0.8267; val_best_f1_score: 0.8425; train_kl_reg_loss: 37565.5118; train_edge_recon_loss: 591742.3216; train_gene_expr_recon_loss: 17256206.3130; train_masked_gp_l1_reg_loss: 76816.3568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54599.6777; train_chrom_access_recon_loss: 5444587.3359; train_global_loss: 23461517.6489; train_optim_loss: 23461517.6489; val_kl_reg_loss: 35904.4737; val_edge_recon_loss: 596583.2083; val_gene_expr_recon_loss: 17222737.5333; val_masked_gp_l1_reg_loss: 76739.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54448.1016; val_chrom_access_recon_loss: 5405031.5333; val_global_loss: 23391444.5333; val_optim_loss: 23391444.5333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9115; val_auprc_score: 0.8932; val_best_acc_score: 0.8340; val_best_f1_score: 0.8474; train_kl_reg_loss: 37729.5578; train_edge_recon_loss: 593278.5019; train_gene_expr_recon_loss: 17255433.5725; train_masked_gp_l1_reg_loss: 76691.2845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54300.7004; train_chrom_access_recon_loss: 5438004.6450; train_global_loss: 23455438.3359; train_optim_loss: 23455438.3359; val_kl_reg_loss: 35985.5104; val_edge_recon_loss: 591210.4250; val_gene_expr_recon_loss: 17228438.9333; val_masked_gp_l1_reg_loss: 76605.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54084.5859; val_chrom_access_recon_loss: 5394070.4000; val_global_loss: 23380395.4667; val_optim_loss: 23380395.4667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9117; val_auprc_score: 0.8940; val_best_acc_score: 0.8366; val_best_f1_score: 0.8490; train_kl_reg_loss: 37945.6520; train_edge_recon_loss: 593205.3607; train_gene_expr_recon_loss: 17261168.4962; train_masked_gp_l1_reg_loss: 76536.4768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53954.1088; train_chrom_access_recon_loss: 5441211.6221; train_global_loss: 23464021.8168; train_optim_loss: 23464021.8168; val_kl_reg_loss: 36420.3323; val_edge_recon_loss: 591098.4000; val_gene_expr_recon_loss: 17265200.5333; val_masked_gp_l1_reg_loss: 76497.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53805.4375; val_chrom_access_recon_loss: 5358882.2333; val_global_loss: 23381905.7333; val_optim_loss: 23381905.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9118; val_auprc_score: 0.8927; val_best_acc_score: 0.8337; val_best_f1_score: 0.8458; train_kl_reg_loss: 38011.6210; train_edge_recon_loss: 592085.1751; train_gene_expr_recon_loss: 17270233.5420; train_masked_gp_l1_reg_loss: 76266.8683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52888.3635; train_chrom_access_recon_loss: 5446470.3702; train_global_loss: 23475955.7405; train_optim_loss: 23475955.7405; val_kl_reg_loss: 36112.2771; val_edge_recon_loss: 593541.5708; val_gene_expr_recon_loss: 17259665.0667; val_masked_gp_l1_reg_loss: 76185.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52728.1133; val_chrom_access_recon_loss: 5380478.1000; val_global_loss: 23398710.6667; val_optim_loss: 23398710.6667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9069; val_auprc_score: 0.8916; val_best_acc_score: 0.8246; val_best_f1_score: 0.8402; train_kl_reg_loss: 38033.0291; train_edge_recon_loss: 591341.7495; train_gene_expr_recon_loss: 17247589.2595; train_masked_gp_l1_reg_loss: 76149.7612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52670.6288; train_chrom_access_recon_loss: 5441300.9656; train_global_loss: 23447085.6183; train_optim_loss: 23447085.6183; val_kl_reg_loss: 36448.4023; val_edge_recon_loss: 598958.7667; val_gene_expr_recon_loss: 17360521.7333; val_masked_gp_l1_reg_loss: 76121.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52617.4805; val_chrom_access_recon_loss: 5434539.4000; val_global_loss: 23559207.7333; val_optim_loss: 23559207.7333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9123; val_auprc_score: 0.8944; val_best_acc_score: 0.8343; val_best_f1_score: 0.8479; train_kl_reg_loss: 38180.7391; train_edge_recon_loss: 591686.5787; train_gene_expr_recon_loss: 17266440.7710; train_masked_gp_l1_reg_loss: 76101.6061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52580.6092; train_chrom_access_recon_loss: 5453423.8664; train_global_loss: 23478414.4275; train_optim_loss: 23478414.4275; val_kl_reg_loss: 36485.3586; val_edge_recon_loss: 591051.3375; val_gene_expr_recon_loss: 17270776.0667; val_masked_gp_l1_reg_loss: 76084.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52540.2656; val_chrom_access_recon_loss: 5394561.9667; val_global_loss: 23421498.8000; val_optim_loss: 23421498.8000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9037; val_auprc_score: 0.8862; val_best_acc_score: 0.8216; val_best_f1_score: 0.8377; train_kl_reg_loss: 38227.6282; train_edge_recon_loss: 591714.9952; train_gene_expr_recon_loss: 17265398.4733; train_masked_gp_l1_reg_loss: 76071.7320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52503.2656; train_chrom_access_recon_loss: 5445221.4771; train_global_loss: 23469137.5878; train_optim_loss: 23469137.5878; val_kl_reg_loss: 36484.5276; val_edge_recon_loss: 602329.0625; val_gene_expr_recon_loss: 17343642.9333; val_masked_gp_l1_reg_loss: 76056.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52468.0312; val_chrom_access_recon_loss: 5419026.2333; val_global_loss: 23530006.6667; val_optim_loss: 23530006.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 54 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9056
val AUPRC score: 0.8921
val best accuracy score: 0.8200
val best F1 score: 0.8364
val target rna MSE score: 1.5087
val source rna MSE score: 0.6243
val target atac MSE score: 0.3326
val source atac MSE score: 0.1038
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
