[True]
Run timestamp: 01082023_061626_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9223; val_auprc_score: 0.9854; val_best_acc_score: 0.8536; val_best_f1_score: 0.9210; train_kl_reg_loss: 23337.8888; train_edge_recon_loss: 11530.8376; train_gene_expr_recon_loss: 519385.1713; train_masked_gp_l1_reg_loss: 5509.6647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115449.8737; train_global_loss: 675213.4340; train_optim_loss: 675213.4340; val_kl_reg_loss: 16854.3454; val_edge_recon_loss: 11903.0233; val_gene_expr_recon_loss: 420221.8906; val_masked_gp_l1_reg_loss: 5037.2700; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104176.4844; val_global_loss: 558193.0208; val_optim_loss: 558193.0208
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9173; val_auprc_score: 0.9837; val_best_acc_score: 0.8499; val_best_f1_score: 0.9188; train_kl_reg_loss: 15512.8335; train_edge_recon_loss: 11586.0322; train_gene_expr_recon_loss: 367327.8397; train_masked_gp_l1_reg_loss: 4674.4693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94962.7947; train_global_loss: 494063.9670; train_optim_loss: 494063.9670; val_kl_reg_loss: 13924.4095; val_edge_recon_loss: 12234.8677; val_gene_expr_recon_loss: 310889.4688; val_masked_gp_l1_reg_loss: 4413.6982; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85926.3125; val_global_loss: 427388.7500; val_optim_loss: 427388.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8922; val_auprc_score: 0.9793; val_best_acc_score: 0.8634; val_best_f1_score: 0.9259; train_kl_reg_loss: 14242.9143; train_edge_recon_loss: 11592.3494; train_gene_expr_recon_loss: 276598.5477; train_masked_gp_l1_reg_loss: 4288.8790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77582.3957; train_global_loss: 384305.0816; train_optim_loss: 384305.0816; val_kl_reg_loss: 13519.9121; val_edge_recon_loss: 11744.4684; val_gene_expr_recon_loss: 253948.7995; val_masked_gp_l1_reg_loss: 4195.1519; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69055.6328; val_global_loss: 352463.9583; val_optim_loss: 352463.9583
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8793; val_auprc_score: 0.9766; val_best_acc_score: 0.8696; val_best_f1_score: 0.9279; train_kl_reg_loss: 13394.7350; train_edge_recon_loss: 11552.6817; train_gene_expr_recon_loss: 245913.4540; train_masked_gp_l1_reg_loss: 4158.0409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61441.2344; train_global_loss: 336460.1429; train_optim_loss: 336460.1429; val_kl_reg_loss: 12425.1216; val_edge_recon_loss: 11997.2907; val_gene_expr_recon_loss: 239988.6146; val_masked_gp_l1_reg_loss: 4141.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54044.7109; val_global_loss: 322597.2396; val_optim_loss: 322597.2396
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8636; val_auprc_score: 0.9719; val_best_acc_score: 0.8733; val_best_f1_score: 0.9285; train_kl_reg_loss: 12302.6438; train_edge_recon_loss: 11531.3003; train_gene_expr_recon_loss: 236694.0764; train_masked_gp_l1_reg_loss: 4152.2949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48064.8903; train_global_loss: 312745.2066; train_optim_loss: 312745.2066; val_kl_reg_loss: 11296.8431; val_edge_recon_loss: 11885.9958; val_gene_expr_recon_loss: 233570.2188; val_masked_gp_l1_reg_loss: 4170.5659; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42504.7617; val_global_loss: 303428.3750; val_optim_loss: 303428.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8492; val_auprc_score: 0.9699; val_best_acc_score: 0.8671; val_best_f1_score: 0.9276; train_kl_reg_loss: 11397.5750; train_edge_recon_loss: 11513.7393; train_gene_expr_recon_loss: 231675.2737; train_masked_gp_l1_reg_loss: 4197.5933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38418.8916; train_global_loss: 297203.0770; train_optim_loss: 297203.0770; val_kl_reg_loss: 10538.1712; val_edge_recon_loss: 11788.7048; val_gene_expr_recon_loss: 230168.6068; val_masked_gp_l1_reg_loss: 4227.7949; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34815.2812; val_global_loss: 291538.5573; val_optim_loss: 291538.5573
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8453; val_auprc_score: 0.9682; val_best_acc_score: 0.8715; val_best_f1_score: 0.9292; train_kl_reg_loss: 10703.8901; train_edge_recon_loss: 11368.7678; train_gene_expr_recon_loss: 227873.3571; train_masked_gp_l1_reg_loss: 4259.8838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31979.1129; train_global_loss: 286185.0110; train_optim_loss: 286185.0110; val_kl_reg_loss: 9945.2835; val_edge_recon_loss: 12004.3996; val_gene_expr_recon_loss: 226257.6901; val_masked_gp_l1_reg_loss: 4294.7949; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29224.6680; val_global_loss: 281726.8385; val_optim_loss: 281726.8385
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8492; val_auprc_score: 0.9697; val_best_acc_score: 0.8779; val_best_f1_score: 0.9321; train_kl_reg_loss: 10167.2935; train_edge_recon_loss: 11381.3783; train_gene_expr_recon_loss: 224694.5885; train_masked_gp_l1_reg_loss: 4328.9008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26907.8915; train_global_loss: 277480.0527; train_optim_loss: 277480.0527; val_kl_reg_loss: 9624.1543; val_edge_recon_loss: 11758.1138; val_gene_expr_recon_loss: 223039.2656; val_masked_gp_l1_reg_loss: 4364.3467; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24668.7266; val_global_loss: 273454.5990; val_optim_loss: 273454.5990
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8592; val_auprc_score: 0.9716; val_best_acc_score: 0.8725; val_best_f1_score: 0.9297; train_kl_reg_loss: 9742.2447; train_edge_recon_loss: 11352.1328; train_gene_expr_recon_loss: 221943.2425; train_masked_gp_l1_reg_loss: 4397.6633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22804.1878; train_global_loss: 270239.4716; train_optim_loss: 270239.4716; val_kl_reg_loss: 9185.9264; val_edge_recon_loss: 11928.7391; val_gene_expr_recon_loss: 220551.5208; val_masked_gp_l1_reg_loss: 4430.9009; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21010.7383; val_global_loss: 267107.8385; val_optim_loss: 267107.8385
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8570; val_auprc_score: 0.9698; val_best_acc_score: 0.8754; val_best_f1_score: 0.9310; train_kl_reg_loss: 9412.0664; train_edge_recon_loss: 11250.9895; train_gene_expr_recon_loss: 219460.1050; train_masked_gp_l1_reg_loss: 4460.2429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19534.6839; train_global_loss: 264118.0871; train_optim_loss: 264118.0871; val_kl_reg_loss: 8984.8504; val_edge_recon_loss: 11720.8631; val_gene_expr_recon_loss: 217911.0234; val_masked_gp_l1_reg_loss: 4489.3423; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18117.1836; val_global_loss: 261223.2708; val_optim_loss: 261223.2708
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8714; val_auprc_score: 0.9737; val_best_acc_score: 0.8744; val_best_f1_score: 0.9303; train_kl_reg_loss: 9156.7034; train_edge_recon_loss: 11155.4885; train_gene_expr_recon_loss: 217140.1985; train_masked_gp_l1_reg_loss: 4512.9217; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16953.8558; train_global_loss: 258919.1687; train_optim_loss: 258919.1687; val_kl_reg_loss: 8697.9780; val_edge_recon_loss: 11712.1006; val_gene_expr_recon_loss: 216667.8698; val_masked_gp_l1_reg_loss: 4535.3057; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15841.8701; val_global_loss: 257455.1380; val_optim_loss: 257455.1380
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8723; val_auprc_score: 0.9734; val_best_acc_score: 0.8708; val_best_f1_score: 0.9280; train_kl_reg_loss: 8908.6213; train_edge_recon_loss: 11326.1449; train_gene_expr_recon_loss: 215206.6603; train_masked_gp_l1_reg_loss: 4552.1129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14923.8896; train_global_loss: 254917.4297; train_optim_loss: 254917.4297; val_kl_reg_loss: 8546.2619; val_edge_recon_loss: 11928.1825; val_gene_expr_recon_loss: 214159.9974; val_masked_gp_l1_reg_loss: 4568.5688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14045.6592; val_global_loss: 253248.6615; val_optim_loss: 253248.6615
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8822; val_auprc_score: 0.9757; val_best_acc_score: 0.8757; val_best_f1_score: 0.9310; train_kl_reg_loss: 8678.4771; train_edge_recon_loss: 11129.5965; train_gene_expr_recon_loss: 213429.9256; train_masked_gp_l1_reg_loss: 4580.4753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13315.0133; train_global_loss: 251133.4884; train_optim_loss: 251133.4884; val_kl_reg_loss: 8238.7778; val_edge_recon_loss: 11866.0662; val_gene_expr_recon_loss: 212392.3490; val_masked_gp_l1_reg_loss: 4591.4849; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12609.5293; val_global_loss: 249698.2083; val_optim_loss: 249698.2083
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8728; val_auprc_score: 0.9746; val_best_acc_score: 0.8763; val_best_f1_score: 0.9317; train_kl_reg_loss: 8437.9870; train_edge_recon_loss: 11184.1279; train_gene_expr_recon_loss: 211611.7133; train_masked_gp_l1_reg_loss: 4597.7784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12024.5011; train_global_loss: 247856.1100; train_optim_loss: 247856.1100; val_kl_reg_loss: 7998.4149; val_edge_recon_loss: 11385.3315; val_gene_expr_recon_loss: 210433.0208; val_masked_gp_l1_reg_loss: 4602.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11464.7949; val_global_loss: 245884.0156; val_optim_loss: 245884.0156
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8800; val_auprc_score: 0.9751; val_best_acc_score: 0.8753; val_best_f1_score: 0.9306; train_kl_reg_loss: 8175.1205; train_edge_recon_loss: 11052.5695; train_gene_expr_recon_loss: 210065.4491; train_masked_gp_l1_reg_loss: 4602.5288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10988.3235; train_global_loss: 244883.9925; train_optim_loss: 244883.9925; val_kl_reg_loss: 7768.0285; val_edge_recon_loss: 11796.8732; val_gene_expr_recon_loss: 208872.5729; val_masked_gp_l1_reg_loss: 4601.3628; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10527.9023; val_global_loss: 243566.7370; val_optim_loss: 243566.7370
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8873; val_auprc_score: 0.9764; val_best_acc_score: 0.8776; val_best_f1_score: 0.9318; train_kl_reg_loss: 7898.0096; train_edge_recon_loss: 11130.8579; train_gene_expr_recon_loss: 208506.4320; train_masked_gp_l1_reg_loss: 4595.8979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10136.9164; train_global_loss: 242268.1149; train_optim_loss: 242268.1149; val_kl_reg_loss: 7575.1734; val_edge_recon_loss: 11767.7785; val_gene_expr_recon_loss: 207155.4062; val_masked_gp_l1_reg_loss: 4588.4819; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9756.6719; val_global_loss: 240843.5104; val_optim_loss: 240843.5104
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8859; val_auprc_score: 0.9768; val_best_acc_score: 0.8824; val_best_f1_score: 0.9342; train_kl_reg_loss: 7615.3757; train_edge_recon_loss: 10974.5721; train_gene_expr_recon_loss: 206951.0078; train_masked_gp_l1_reg_loss: 4578.1462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9433.9012; train_global_loss: 239553.0029; train_optim_loss: 239553.0029; val_kl_reg_loss: 7237.7641; val_edge_recon_loss: 11381.1821; val_gene_expr_recon_loss: 205899.7057; val_masked_gp_l1_reg_loss: 4566.1782; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9117.7939; val_global_loss: 238202.6172; val_optim_loss: 238202.6172
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8917; val_auprc_score: 0.9765; val_best_acc_score: 0.8799; val_best_f1_score: 0.9319; train_kl_reg_loss: 7329.0796; train_edge_recon_loss: 10909.3258; train_gene_expr_recon_loss: 205503.0483; train_masked_gp_l1_reg_loss: 4550.2417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8845.8345; train_global_loss: 237137.5307; train_optim_loss: 237137.5307; val_kl_reg_loss: 6877.6631; val_edge_recon_loss: 11583.1602; val_gene_expr_recon_loss: 204486.2734; val_masked_gp_l1_reg_loss: 4531.4946; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8579.8301; val_global_loss: 236058.4245; val_optim_loss: 236058.4245
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8942; val_auprc_score: 0.9779; val_best_acc_score: 0.8844; val_best_f1_score: 0.9330; train_kl_reg_loss: 7040.2831; train_edge_recon_loss: 10982.8081; train_gene_expr_recon_loss: 204063.7422; train_masked_gp_l1_reg_loss: 4509.5462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8352.0140; train_global_loss: 234948.3941; train_optim_loss: 234948.3941; val_kl_reg_loss: 6684.9316; val_edge_recon_loss: 11748.2856; val_gene_expr_recon_loss: 203008.6120; val_masked_gp_l1_reg_loss: 4484.9878; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8128.4692; val_global_loss: 234055.2812; val_optim_loss: 234055.2812
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8951; val_auprc_score: 0.9774; val_best_acc_score: 0.8861; val_best_f1_score: 0.9336; train_kl_reg_loss: 6753.1458; train_edge_recon_loss: 10988.4730; train_gene_expr_recon_loss: 202721.4291; train_masked_gp_l1_reg_loss: 4456.7048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7932.1843; train_global_loss: 232851.9361; train_optim_loss: 232851.9361; val_kl_reg_loss: 6415.9224; val_edge_recon_loss: 11781.6549; val_gene_expr_recon_loss: 201668.5573; val_masked_gp_l1_reg_loss: 4426.3237; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7741.3877; val_global_loss: 232033.8516; val_optim_loss: 232033.8516
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8993; val_auprc_score: 0.9789; val_best_acc_score: 0.8849; val_best_f1_score: 0.9336; train_kl_reg_loss: 6480.4818; train_edge_recon_loss: 10932.3563; train_gene_expr_recon_loss: 201319.4957; train_masked_gp_l1_reg_loss: 4391.7112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7578.1812; train_global_loss: 230702.2286; train_optim_loss: 230702.2286; val_kl_reg_loss: 6112.3034; val_edge_recon_loss: 11641.4505; val_gene_expr_recon_loss: 200297.5651; val_masked_gp_l1_reg_loss: 4353.8818; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7420.9541; val_global_loss: 229826.1484; val_optim_loss: 229826.1484
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9035; val_auprc_score: 0.9796; val_best_acc_score: 0.8904; val_best_f1_score: 0.9369; train_kl_reg_loss: 6209.5479; train_edge_recon_loss: 10790.1112; train_gene_expr_recon_loss: 199981.2595; train_masked_gp_l1_reg_loss: 4313.2490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7282.3077; train_global_loss: 228576.4742; train_optim_loss: 228576.4742; val_kl_reg_loss: 5850.5109; val_edge_recon_loss: 11479.8470; val_gene_expr_recon_loss: 199621.4557; val_masked_gp_l1_reg_loss: 4268.6670; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7150.6646; val_global_loss: 228371.1562; val_optim_loss: 228371.1562
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9039; val_auprc_score: 0.9805; val_best_acc_score: 0.8950; val_best_f1_score: 0.9394; train_kl_reg_loss: 5947.4592; train_edge_recon_loss: 10827.5685; train_gene_expr_recon_loss: 198585.1406; train_masked_gp_l1_reg_loss: 4221.7341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7039.4505; train_global_loss: 226621.3519; train_optim_loss: 226621.3519; val_kl_reg_loss: 5648.4744; val_edge_recon_loss: 10983.6689; val_gene_expr_recon_loss: 197713.9323; val_masked_gp_l1_reg_loss: 4172.0171; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6928.6597; val_global_loss: 225446.7474; val_optim_loss: 225446.7474
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9103; val_auprc_score: 0.9821; val_best_acc_score: 0.8966; val_best_f1_score: 0.9402; train_kl_reg_loss: 5697.0355; train_edge_recon_loss: 10873.4058; train_gene_expr_recon_loss: 197199.0402; train_masked_gp_l1_reg_loss: 4120.6348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6833.0179; train_global_loss: 224723.1328; train_optim_loss: 224723.1328; val_kl_reg_loss: 5435.3373; val_edge_recon_loss: 11155.9440; val_gene_expr_recon_loss: 196298.9583; val_masked_gp_l1_reg_loss: 4065.9619; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6735.8076; val_global_loss: 223692.0182; val_optim_loss: 223692.0182
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9078; val_auprc_score: 0.9810; val_best_acc_score: 0.8958; val_best_f1_score: 0.9399; train_kl_reg_loss: 5461.5645; train_edge_recon_loss: 10635.1685; train_gene_expr_recon_loss: 195858.5961; train_masked_gp_l1_reg_loss: 4011.3895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6636.7889; train_global_loss: 222603.5067; train_optim_loss: 222603.5067; val_kl_reg_loss: 5207.3319; val_edge_recon_loss: 11236.9839; val_gene_expr_recon_loss: 194875.7370; val_masked_gp_l1_reg_loss: 3954.2126; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6530.6377; val_global_loss: 221804.9115; val_optim_loss: 221804.9115
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9027; val_auprc_score: 0.9799; val_best_acc_score: 0.8980; val_best_f1_score: 0.9416; train_kl_reg_loss: 3756.6265; train_edge_recon_loss: 10800.3508; train_gene_expr_recon_loss: 338718.2240; train_masked_gp_l1_reg_loss: 4185.1872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5421.3525; train_global_loss: 362881.7407; train_optim_loss: 362881.7407; val_kl_reg_loss: 2657.6186; val_edge_recon_loss: 10666.1616; val_gene_expr_recon_loss: 288158.7708; val_masked_gp_l1_reg_loss: 4251.8667; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4299.0410; val_global_loss: 310033.4531; val_optim_loss: 310033.4531
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9145; val_auprc_score: 0.9823; val_best_acc_score: 0.9056; val_best_f1_score: 0.9461; train_kl_reg_loss: 2709.4931; train_edge_recon_loss: 10454.1363; train_gene_expr_recon_loss: 263790.1806; train_masked_gp_l1_reg_loss: 4171.6115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3706.7102; train_global_loss: 284832.1325; train_optim_loss: 284832.1325; val_kl_reg_loss: 2396.8147; val_edge_recon_loss: 10348.0604; val_gene_expr_recon_loss: 244253.9375; val_masked_gp_l1_reg_loss: 4064.2581; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3250.7083; val_global_loss: 264313.7917; val_optim_loss: 264313.7917
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9127; val_auprc_score: 0.9800; val_best_acc_score: 0.9104; val_best_f1_score: 0.9484; train_kl_reg_loss: 2419.3157; train_edge_recon_loss: 10077.4890; train_gene_expr_recon_loss: 232670.6172; train_masked_gp_l1_reg_loss: 3940.9807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2984.9106; train_global_loss: 252093.3128; train_optim_loss: 252093.3128; val_kl_reg_loss: 2183.6923; val_edge_recon_loss: 10275.9076; val_gene_expr_recon_loss: 223026.2266; val_masked_gp_l1_reg_loss: 3811.0430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2755.9980; val_global_loss: 242052.8724; val_optim_loss: 242052.8724
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9204; val_auprc_score: 0.9818; val_best_acc_score: 0.9149; val_best_f1_score: 0.9509; train_kl_reg_loss: 2211.7989; train_edge_recon_loss: 9640.1884; train_gene_expr_recon_loss: 217005.3738; train_masked_gp_l1_reg_loss: 3684.5212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2592.0246; train_global_loss: 235133.9068; train_optim_loss: 235133.9068; val_kl_reg_loss: 1999.4653; val_edge_recon_loss: 9969.0615; val_gene_expr_recon_loss: 211829.8177; val_masked_gp_l1_reg_loss: 3554.4253; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2441.1985; val_global_loss: 229793.9688; val_optim_loss: 229793.9688

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9196; val_auprc_score: 0.9829; val_best_acc_score: 0.9182; val_best_f1_score: 0.9533; train_kl_reg_loss: 2109.8883; train_edge_recon_loss: 9523.7921; train_gene_expr_recon_loss: 211477.4418; train_masked_gp_l1_reg_loss: 3511.4612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2364.2247; train_global_loss: 228986.8073; train_optim_loss: 228986.8073; val_kl_reg_loss: 1966.6324; val_edge_recon_loss: 9438.6134; val_gene_expr_recon_loss: 210663.0339; val_masked_gp_l1_reg_loss: 3492.0981; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2337.4043; val_global_loss: 227897.7812; val_optim_loss: 227897.7812
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9225; val_auprc_score: 0.9826; val_best_acc_score: 0.9169; val_best_f1_score: 0.9523; train_kl_reg_loss: 2095.3892; train_edge_recon_loss: 9436.6186; train_gene_expr_recon_loss: 210721.9213; train_masked_gp_l1_reg_loss: 3479.2892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2324.0301; train_global_loss: 228057.2471; train_optim_loss: 228057.2471; val_kl_reg_loss: 1961.6763; val_edge_recon_loss: 9677.0967; val_gene_expr_recon_loss: 210204.6693; val_masked_gp_l1_reg_loss: 3466.1924; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2310.6387; val_global_loss: 227620.2708; val_optim_loss: 227620.2708
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9220; val_auprc_score: 0.9830; val_best_acc_score: 0.9170; val_best_f1_score: 0.9526; train_kl_reg_loss: 2079.7326; train_edge_recon_loss: 9402.7120; train_gene_expr_recon_loss: 209979.7989; train_masked_gp_l1_reg_loss: 3453.5773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2297.9860; train_global_loss: 227213.8073; train_optim_loss: 227213.8073; val_kl_reg_loss: 1957.9844; val_edge_recon_loss: 9575.8293; val_gene_expr_recon_loss: 209492.4531; val_masked_gp_l1_reg_loss: 3440.5618; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2285.0420; val_global_loss: 226751.8776; val_optim_loss: 226751.8776
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9198; val_auprc_score: 0.9811; val_best_acc_score: 0.9163; val_best_f1_score: 0.9521; train_kl_reg_loss: 2065.7948; train_edge_recon_loss: 9372.7765; train_gene_expr_recon_loss: 209275.4071; train_masked_gp_l1_reg_loss: 3427.7491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2272.2466; train_global_loss: 226413.9766; train_optim_loss: 226413.9766; val_kl_reg_loss: 1943.0998; val_edge_recon_loss: 9625.1877; val_gene_expr_recon_loss: 208736.4401; val_masked_gp_l1_reg_loss: 3414.4121; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2258.9390; val_global_loss: 225978.0729; val_optim_loss: 225978.0729

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 7 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9059
val AUPRC score: 0.9790
val best accuracy score: 0.8970
val best F1 score: 0.9404
val target rna MSE score: 24.2322
val source rna MSE score: 94.7647
Val cat covariate0 mean sim diff: -0.0018

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
