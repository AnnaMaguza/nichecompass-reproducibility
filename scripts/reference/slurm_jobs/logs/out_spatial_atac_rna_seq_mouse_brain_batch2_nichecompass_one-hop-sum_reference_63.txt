[True]
Run timestamp: 10082023_214543_63.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_63']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7126; val_auprc_score: 0.7541; val_best_acc_score: 0.5295; val_best_f1_score: 0.6777; train_kl_reg_loss: 101194.5607; train_edge_recon_loss: 3774100.4523; train_gene_expr_recon_loss: 44978209.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5487990.5420; train_global_loss: 54341495.1450; train_optim_loss: 54341495.1450; val_kl_reg_loss: 179353.3354; val_edge_recon_loss: 4063711.2333; val_gene_expr_recon_loss: 38461602.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5176239.2000; val_global_loss: 47880906.9333; val_optim_loss: 47880906.9333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8094; val_auprc_score: 0.8266; val_best_acc_score: 0.7079; val_best_f1_score: 0.7379; train_kl_reg_loss: 190254.6810; train_edge_recon_loss: 3645052.2996; train_gene_expr_recon_loss: 37767522.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5176813.9389; train_global_loss: 46779643.2672; train_optim_loss: 46779643.2672; val_kl_reg_loss: 211859.6344; val_edge_recon_loss: 4045879.0167; val_gene_expr_recon_loss: 36994964.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5104654.5000; val_global_loss: 46357356.2667; val_optim_loss: 46357356.2667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8682; val_auprc_score: 0.8728; val_best_acc_score: 0.7513; val_best_f1_score: 0.7860; train_kl_reg_loss: 180369.9062; train_edge_recon_loss: 3561013.1088; train_gene_expr_recon_loss: 36832490.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5117778.5534; train_global_loss: 45691652.5191; train_optim_loss: 45691652.5191; val_kl_reg_loss: 170907.3073; val_edge_recon_loss: 3950866.1167; val_gene_expr_recon_loss: 36555262.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5062818.1333; val_global_loss: 45739854.4000; val_optim_loss: 45739854.4000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8999; val_auprc_score: 0.8935; val_best_acc_score: 0.8207; val_best_f1_score: 0.8310; train_kl_reg_loss: 149057.8805; train_edge_recon_loss: 3457435.9237; train_gene_expr_recon_loss: 36515031.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5092311.0611; train_global_loss: 45213836.6107; train_optim_loss: 45213836.6107; val_kl_reg_loss: 144099.3583; val_edge_recon_loss: 3343735.5000; val_gene_expr_recon_loss: 36364731.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5059497.5000; val_global_loss: 44912063.4667; val_optim_loss: 44912063.4667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8938; val_auprc_score: 0.8869; val_best_acc_score: 0.8007; val_best_f1_score: 0.8138; train_kl_reg_loss: 175037.6962; train_edge_recon_loss: 3092346.7767; train_gene_expr_recon_loss: 36227650.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5059495.9733; train_global_loss: 44554531.1756; train_optim_loss: 44554531.1756; val_kl_reg_loss: 192577.2365; val_edge_recon_loss: 3014927.3333; val_gene_expr_recon_loss: 36023799.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5013142.6333; val_global_loss: 44244446.4000; val_optim_loss: 44244446.4000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9102; val_auprc_score: 0.9004; val_best_acc_score: 0.8259; val_best_f1_score: 0.8375; train_kl_reg_loss: 181957.7170; train_edge_recon_loss: 2971911.6870; train_gene_expr_recon_loss: 36045111.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5043798.4924; train_global_loss: 44242778.9924; train_optim_loss: 44242778.9924; val_kl_reg_loss: 175553.0031; val_edge_recon_loss: 2942498.9167; val_gene_expr_recon_loss: 35802496.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4996278.8333; val_global_loss: 43916827.4667; val_optim_loss: 43916827.4667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9097; val_auprc_score: 0.8951; val_best_acc_score: 0.8329; val_best_f1_score: 0.8459; train_kl_reg_loss: 171490.1004; train_edge_recon_loss: 2944491.7290; train_gene_expr_recon_loss: 35783831.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5014943.5763; train_global_loss: 43914756.9466; train_optim_loss: 43914756.9466; val_kl_reg_loss: 172490.1896; val_edge_recon_loss: 2951238.2167; val_gene_expr_recon_loss: 35489277.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4955919.5667; val_global_loss: 43568925.0667; val_optim_loss: 43568925.0667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9244; val_auprc_score: 0.9131; val_best_acc_score: 0.8533; val_best_f1_score: 0.8633; train_kl_reg_loss: 166627.4387; train_edge_recon_loss: 2903081.0859; train_gene_expr_recon_loss: 35641792.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5002323.8779; train_global_loss: 43713824.8855; train_optim_loss: 43713824.8855; val_kl_reg_loss: 160716.8271; val_edge_recon_loss: 2905234.2167; val_gene_expr_recon_loss: 35332124.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4941393.3333; val_global_loss: 43339468.5333; val_optim_loss: 43339468.5333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9259; val_auprc_score: 0.9143; val_best_acc_score: 0.8549; val_best_f1_score: 0.8650; train_kl_reg_loss: 159998.2240; train_edge_recon_loss: 2881891.3359; train_gene_expr_recon_loss: 35495118.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4985821.4580; train_global_loss: 43522829.7405; train_optim_loss: 43522829.7405; val_kl_reg_loss: 160574.3917; val_edge_recon_loss: 2911135.0333; val_gene_expr_recon_loss: 35252141.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4919080.9667; val_global_loss: 43242931.7333; val_optim_loss: 43242931.7333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9386; val_auprc_score: 0.9280; val_best_acc_score: 0.8700; val_best_f1_score: 0.8779; train_kl_reg_loss: 156296.2592; train_edge_recon_loss: 2854830.2099; train_gene_expr_recon_loss: 35312394.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4963796.0191; train_global_loss: 43287316.7634; train_optim_loss: 43287316.7634; val_kl_reg_loss: 152019.2135; val_edge_recon_loss: 2864281.8833; val_gene_expr_recon_loss: 35187666.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4933210.1333; val_global_loss: 43137178.6667; val_optim_loss: 43137178.6667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9400; val_auprc_score: 0.9262; val_best_acc_score: 0.8764; val_best_f1_score: 0.8827; train_kl_reg_loss: 148928.7308; train_edge_recon_loss: 2846214.5878; train_gene_expr_recon_loss: 35181052.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4944780.3664; train_global_loss: 43120975.6336; train_optim_loss: 43120975.6336; val_kl_reg_loss: 143717.3719; val_edge_recon_loss: 2851110.3167; val_gene_expr_recon_loss: 35056982.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4922703.9000; val_global_loss: 42974513.6000; val_optim_loss: 42974513.6000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9455; val_auprc_score: 0.9347; val_best_acc_score: 0.8787; val_best_f1_score: 0.8869; train_kl_reg_loss: 145955.9988; train_edge_recon_loss: 2829455.7615; train_gene_expr_recon_loss: 35133077.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4941618.3282; train_global_loss: 43050107.8168; train_optim_loss: 43050107.8168; val_kl_reg_loss: 135533.9948; val_edge_recon_loss: 2847013.5667; val_gene_expr_recon_loss: 34947266.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4892507.7667; val_global_loss: 42822322.1333; val_optim_loss: 42822322.1333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9532; val_auprc_score: 0.9445; val_best_acc_score: 0.8895; val_best_f1_score: 0.8941; train_kl_reg_loss: 141272.7987; train_edge_recon_loss: 2807857.5439; train_gene_expr_recon_loss: 34987937.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4923109.2901; train_global_loss: 42860177.3130; train_optim_loss: 42860177.3130; val_kl_reg_loss: 140133.8833; val_edge_recon_loss: 2816183.1667; val_gene_expr_recon_loss: 34861589.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4889947.2000; val_global_loss: 42707853.3333; val_optim_loss: 42707853.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9546; val_auprc_score: 0.9467; val_best_acc_score: 0.8918; val_best_f1_score: 0.8955; train_kl_reg_loss: 136879.9805; train_edge_recon_loss: 2797125.9160; train_gene_expr_recon_loss: 34930047.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4918450.4313; train_global_loss: 42782503.6947; train_optim_loss: 42782503.6947; val_kl_reg_loss: 136627.9536; val_edge_recon_loss: 2804102.3667; val_gene_expr_recon_loss: 34779439.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4886832.4667; val_global_loss: 42607002.1333; val_optim_loss: 42607002.1333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9615; val_auprc_score: 0.9541; val_best_acc_score: 0.8981; val_best_f1_score: 0.9024; train_kl_reg_loss: 134350.8640; train_edge_recon_loss: 2796089.0840; train_gene_expr_recon_loss: 34803605.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4907155.5611; train_global_loss: 42641201.1298; train_optim_loss: 42641201.1298; val_kl_reg_loss: 134467.5583; val_edge_recon_loss: 2797060.1333; val_gene_expr_recon_loss: 34751206.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4875978.3000; val_global_loss: 42558713.0667; val_optim_loss: 42558713.0667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9601; val_auprc_score: 0.9508; val_best_acc_score: 0.9014; val_best_f1_score: 0.9044; train_kl_reg_loss: 130854.4595; train_edge_recon_loss: 2785618.6489; train_gene_expr_recon_loss: 34737189.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4900199.0267; train_global_loss: 42553861.8931; train_optim_loss: 42553861.8931; val_kl_reg_loss: 130781.1479; val_edge_recon_loss: 2778710.8500; val_gene_expr_recon_loss: 34544076.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4872077.8000; val_global_loss: 42325646.4000; val_optim_loss: 42325646.4000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9668; val_auprc_score: 0.9580; val_best_acc_score: 0.9143; val_best_f1_score: 0.9161; train_kl_reg_loss: 128419.2655; train_edge_recon_loss: 2775236.3683; train_gene_expr_recon_loss: 34678126.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4897651.3244; train_global_loss: 42479432.9160; train_optim_loss: 42479432.9160; val_kl_reg_loss: 126549.8036; val_edge_recon_loss: 2757949.5000; val_gene_expr_recon_loss: 34480545.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4843153.0333; val_global_loss: 42208198.1333; val_optim_loss: 42208198.1333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9683; val_auprc_score: 0.9604; val_best_acc_score: 0.9130; val_best_f1_score: 0.9157; train_kl_reg_loss: 125649.2250; train_edge_recon_loss: 2764732.4160; train_gene_expr_recon_loss: 34643592.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4897359.7863; train_global_loss: 42431334.1069; train_optim_loss: 42431334.1069; val_kl_reg_loss: 124859.1552; val_edge_recon_loss: 2770563.9500; val_gene_expr_recon_loss: 34513584.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4852488.9667; val_global_loss: 42261496.5333; val_optim_loss: 42261496.5333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9688; val_auprc_score: 0.9619; val_best_acc_score: 0.9163; val_best_f1_score: 0.9181; train_kl_reg_loss: 122788.6951; train_edge_recon_loss: 2756481.4275; train_gene_expr_recon_loss: 34521720.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4880755.0076; train_global_loss: 42281745.7405; train_optim_loss: 42281745.7405; val_kl_reg_loss: 123314.8760; val_edge_recon_loss: 2773727.9000; val_gene_expr_recon_loss: 34488559.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4845885.7333; val_global_loss: 42231488.5333; val_optim_loss: 42231488.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9701; val_auprc_score: 0.9621; val_best_acc_score: 0.9213; val_best_f1_score: 0.9240; train_kl_reg_loss: 120397.4778; train_edge_recon_loss: 2754410.5134; train_gene_expr_recon_loss: 34454598.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4877222.9122; train_global_loss: 42206628.9466; train_optim_loss: 42206628.9466; val_kl_reg_loss: 119419.2339; val_edge_recon_loss: 2753512.6667; val_gene_expr_recon_loss: 34469604.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4866532.5333; val_global_loss: 42209068.8000; val_optim_loss: 42209068.8000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9720; val_auprc_score: 0.9647; val_best_acc_score: 0.9185; val_best_f1_score: 0.9211; train_kl_reg_loss: 118177.4534; train_edge_recon_loss: 2749162.3950; train_gene_expr_recon_loss: 34389478.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4873593.6870; train_global_loss: 42130412.4885; train_optim_loss: 42130412.4885; val_kl_reg_loss: 113251.3786; val_edge_recon_loss: 2761547.9167; val_gene_expr_recon_loss: 34291780.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4830250.9000; val_global_loss: 41996830.4000; val_optim_loss: 41996830.4000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9735; val_auprc_score: 0.9670; val_best_acc_score: 0.9225; val_best_f1_score: 0.9256; train_kl_reg_loss: 115516.6837; train_edge_recon_loss: 2749513.5744; train_gene_expr_recon_loss: 34336893.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4873808.1985; train_global_loss: 42075731.8473; train_optim_loss: 42075731.8473; val_kl_reg_loss: 114257.6370; val_edge_recon_loss: 2734373.5333; val_gene_expr_recon_loss: 34216736.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4825784.1333; val_global_loss: 41891150.9333; val_optim_loss: 41891150.9333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9740; val_auprc_score: 0.9694; val_best_acc_score: 0.9244; val_best_f1_score: 0.9273; train_kl_reg_loss: 113804.9297; train_edge_recon_loss: 2743709.4103; train_gene_expr_recon_loss: 34293115.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4870063.7099; train_global_loss: 42020693.3130; train_optim_loss: 42020693.3130; val_kl_reg_loss: 112531.1651; val_edge_recon_loss: 2749493.9000; val_gene_expr_recon_loss: 34263845.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4827825.9000; val_global_loss: 41953696.5333; val_optim_loss: 41953696.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9733; val_auprc_score: 0.9669; val_best_acc_score: 0.9256; val_best_f1_score: 0.9283; train_kl_reg_loss: 112546.9053; train_edge_recon_loss: 2734734.6336; train_gene_expr_recon_loss: 34211965.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4860161.2481; train_global_loss: 41919408.4885; train_optim_loss: 41919408.4885; val_kl_reg_loss: 112134.5380; val_edge_recon_loss: 2765997.7000; val_gene_expr_recon_loss: 34055060.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4804549.8667; val_global_loss: 41737743.2000; val_optim_loss: 41737743.2000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9779; val_auprc_score: 0.9726; val_best_acc_score: 0.9302; val_best_f1_score: 0.9324; train_kl_reg_loss: 110526.3467; train_edge_recon_loss: 2733455.6450; train_gene_expr_recon_loss: 34174804.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4860972.1298; train_global_loss: 41879758.7176; train_optim_loss: 41879758.7176; val_kl_reg_loss: 108236.4552; val_edge_recon_loss: 2726617.7833; val_gene_expr_recon_loss: 34140706.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4823943.0000; val_global_loss: 41799503.2000; val_optim_loss: 41799503.2000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9776; val_auprc_score: 0.9721; val_best_acc_score: 0.9317; val_best_f1_score: 0.9332; train_kl_reg_loss: 118993.9874; train_edge_recon_loss: 2781914.2519; train_gene_expr_recon_loss: 35602891.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4930796.7214; train_global_loss: 43434596.1527; train_optim_loss: 43434596.1527; val_kl_reg_loss: 64374.4385; val_edge_recon_loss: 2759690.7000; val_gene_expr_recon_loss: 35348316.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4893400.1333; val_global_loss: 43065781.6000; val_optim_loss: 43065781.6000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9738; val_auprc_score: 0.9677; val_best_acc_score: 0.9252; val_best_f1_score: 0.9273; train_kl_reg_loss: 115889.4235; train_edge_recon_loss: 2755869.4008; train_gene_expr_recon_loss: 35456712.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4911570.3893; train_global_loss: 43240041.9847; train_optim_loss: 43240041.9847; val_kl_reg_loss: 68206.3901; val_edge_recon_loss: 2757395.9333; val_gene_expr_recon_loss: 35403008.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4878907.5000; val_global_loss: 43107517.3333; val_optim_loss: 43107517.3333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9760; val_auprc_score: 0.9698; val_best_acc_score: 0.9309; val_best_f1_score: 0.9326; train_kl_reg_loss: 109250.8618; train_edge_recon_loss: 2741555.0324; train_gene_expr_recon_loss: 35444354.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4912807.2786; train_global_loss: 43207968.1221; train_optim_loss: 43207968.1221; val_kl_reg_loss: 67972.6935; val_edge_recon_loss: 2744935.0833; val_gene_expr_recon_loss: 35338207.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4864916.7333; val_global_loss: 43016032.0000; val_optim_loss: 43016032.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9751; val_auprc_score: 0.9682; val_best_acc_score: 0.9309; val_best_f1_score: 0.9329; train_kl_reg_loss: 106378.9566; train_edge_recon_loss: 2740516.2786; train_gene_expr_recon_loss: 35330885.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4906674.0954; train_global_loss: 43084455.0534; train_optim_loss: 43084455.0534; val_kl_reg_loss: 68872.6854; val_edge_recon_loss: 2738266.6667; val_gene_expr_recon_loss: 35178119.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4862059.1667; val_global_loss: 42847317.3333; val_optim_loss: 42847317.3333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9740; val_auprc_score: 0.9675; val_best_acc_score: 0.9264; val_best_f1_score: 0.9286; train_kl_reg_loss: 107217.4903; train_edge_recon_loss: 2735511.9771; train_gene_expr_recon_loss: 35309195.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4901451.0725; train_global_loss: 43053375.8473; train_optim_loss: 43053375.8473; val_kl_reg_loss: 69557.0068; val_edge_recon_loss: 2756271.2500; val_gene_expr_recon_loss: 35337622.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4881688.7333; val_global_loss: 43045138.6667; val_optim_loss: 43045138.6667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9774; val_auprc_score: 0.9730; val_best_acc_score: 0.9324; val_best_f1_score: 0.9342; train_kl_reg_loss: 106558.1733; train_edge_recon_loss: 2729268.8607; train_gene_expr_recon_loss: 35303557.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4902716.8969; train_global_loss: 43042100.8244; train_optim_loss: 43042100.8244; val_kl_reg_loss: 70212.8057; val_edge_recon_loss: 2735949.8000; val_gene_expr_recon_loss: 35231501.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4871218.0000; val_global_loss: 42908882.4000; val_optim_loss: 42908882.4000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9753; val_auprc_score: 0.9679; val_best_acc_score: 0.9298; val_best_f1_score: 0.9319; train_kl_reg_loss: 105872.5078; train_edge_recon_loss: 2732247.5038; train_gene_expr_recon_loss: 35265845.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4899612.8053; train_global_loss: 43003578.6260; train_optim_loss: 43003578.6260; val_kl_reg_loss: 70714.0135; val_edge_recon_loss: 2742008.3333; val_gene_expr_recon_loss: 35216485.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4869327.1333; val_global_loss: 42898534.9333; val_optim_loss: 42898534.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 25 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9731
val AUPRC score: 0.9662
val best accuracy score: 0.9248
val best F1 score: 0.9276
val target rna MSE score: 1.4069
val source rna MSE score: 21.4375
val target atac MSE score: 0.3479
val source atac MSE score: 2.9288
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
