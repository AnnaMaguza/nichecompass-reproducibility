[True]
Run timestamp: 07092023_191817_91.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_91']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2376 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5103, n_cat_covariates_embed_input: 0, n_hidden: 2313, n_latent: 2213, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2376
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2376

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7679; val_auprc_score: 0.7863; val_best_acc_score: 0.5462; val_best_f1_score: 0.6850; train_kl_reg_loss: 90121.5835; train_edge_recon_loss: 3552298.9065; train_gene_expr_recon_loss: 21326266.8550; train_masked_gp_l1_reg_loss: 136470.2925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3599373.5592; train_chrom_access_recon_loss: 10654372.3053; train_global_loss: 39358903.3588; train_optim_loss: 39358903.3588; val_kl_reg_loss: 149567.8021; val_edge_recon_loss: 4062462.0000; val_gene_expr_recon_loss: 19768623.0667; val_masked_gp_l1_reg_loss: 122167.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 454057.5312; val_chrom_access_recon_loss: 10390028.1333; val_global_loss: 34946907.6000; val_optim_loss: 34946907.6000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8689; val_auprc_score: 0.8736; val_best_acc_score: 0.7879; val_best_f1_score: 0.8004; train_kl_reg_loss: 112622.7110; train_edge_recon_loss: 3527071.5763; train_gene_expr_recon_loss: 19758184.1985; train_masked_gp_l1_reg_loss: 119246.4130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 246110.9532; train_chrom_access_recon_loss: 10221449.2061; train_global_loss: 33984685.0382; train_optim_loss: 33984685.0382; val_kl_reg_loss: 101722.5609; val_edge_recon_loss: 4025022.8667; val_gene_expr_recon_loss: 19322718.5333; val_masked_gp_l1_reg_loss: 120091.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159472.9688; val_chrom_access_recon_loss: 10205562.5333; val_global_loss: 33934589.7333; val_optim_loss: 33934589.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8807; val_auprc_score: 0.8764; val_best_acc_score: 0.7802; val_best_f1_score: 0.8013; train_kl_reg_loss: 90077.7648; train_edge_recon_loss: 3394838.8492; train_gene_expr_recon_loss: 19446120.6107; train_masked_gp_l1_reg_loss: 125805.6367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137442.8449; train_chrom_access_recon_loss: 10078793.6641; train_global_loss: 33273079.2519; train_optim_loss: 33273079.2519; val_kl_reg_loss: 107505.8979; val_edge_recon_loss: 3026840.1500; val_gene_expr_recon_loss: 19166748.2667; val_masked_gp_l1_reg_loss: 134526.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124150.4844; val_chrom_access_recon_loss: 10132677.8667; val_global_loss: 32692448.4000; val_optim_loss: 32692448.4000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8784; val_auprc_score: 0.8664; val_best_acc_score: 0.7859; val_best_f1_score: 0.8065; train_kl_reg_loss: 119329.5433; train_edge_recon_loss: 2989040.6031; train_gene_expr_recon_loss: 19203516.9313; train_masked_gp_l1_reg_loss: 137514.9652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118273.9940; train_chrom_access_recon_loss: 9961769.1527; train_global_loss: 32529445.2519; train_optim_loss: 32529445.2519; val_kl_reg_loss: 120980.6229; val_edge_recon_loss: 2956793.3333; val_gene_expr_recon_loss: 18950073.4667; val_masked_gp_l1_reg_loss: 140322.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114053.3203; val_chrom_access_recon_loss: 9993910.4667; val_global_loss: 32276133.7333; val_optim_loss: 32276133.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9033; val_auprc_score: 0.8900; val_best_acc_score: 0.8185; val_best_f1_score: 0.8259; train_kl_reg_loss: 117557.4649; train_edge_recon_loss: 2940245.8416; train_gene_expr_recon_loss: 19003514.5496; train_masked_gp_l1_reg_loss: 142299.6207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111099.2806; train_chrom_access_recon_loss: 9866241.5191; train_global_loss: 32180958.1221; train_optim_loss: 32180958.1221; val_kl_reg_loss: 118008.9984; val_edge_recon_loss: 2947684.1167; val_gene_expr_recon_loss: 18793770.2667; val_masked_gp_l1_reg_loss: 145034.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108807.0078; val_chrom_access_recon_loss: 9915096.4667; val_global_loss: 32028401.8667; val_optim_loss: 32028401.8667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9276; val_auprc_score: 0.9089; val_best_acc_score: 0.8587; val_best_f1_score: 0.8697; train_kl_reg_loss: 116133.0697; train_edge_recon_loss: 2870782.5916; train_gene_expr_recon_loss: 18818513.0229; train_masked_gp_l1_reg_loss: 147124.9076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107058.3819; train_chrom_access_recon_loss: 9775216.9924; train_global_loss: 31834828.9771; train_optim_loss: 31834828.9771; val_kl_reg_loss: 113570.3922; val_edge_recon_loss: 2840165.2833; val_gene_expr_recon_loss: 18622637.0667; val_masked_gp_l1_reg_loss: 149753.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106617.5547; val_chrom_access_recon_loss: 9822990.4667; val_global_loss: 31655735.0667; val_optim_loss: 31655735.0667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9378; val_auprc_score: 0.9256; val_best_acc_score: 0.8690; val_best_f1_score: 0.8768; train_kl_reg_loss: 119342.2316; train_edge_recon_loss: 2818651.3321; train_gene_expr_recon_loss: 18667363.2366; train_masked_gp_l1_reg_loss: 151559.7604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105983.1970; train_chrom_access_recon_loss: 9698363.1908; train_global_loss: 31561263.0229; train_optim_loss: 31561263.0229; val_kl_reg_loss: 123726.8630; val_edge_recon_loss: 2825981.1167; val_gene_expr_recon_loss: 18441901.6000; val_masked_gp_l1_reg_loss: 153454.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105453.1406; val_chrom_access_recon_loss: 9746471.2667; val_global_loss: 31396988.8000; val_optim_loss: 31396988.8000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9430; val_auprc_score: 0.9315; val_best_acc_score: 0.8752; val_best_f1_score: 0.8834; train_kl_reg_loss: 120881.7114; train_edge_recon_loss: 2793761.0344; train_gene_expr_recon_loss: 18552054.4122; train_masked_gp_l1_reg_loss: 154561.7669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104750.9464; train_chrom_access_recon_loss: 9644881.0992; train_global_loss: 31370891.1298; train_optim_loss: 31370891.1298; val_kl_reg_loss: 119080.7479; val_edge_recon_loss: 2798741.7500; val_gene_expr_recon_loss: 18308916.0000; val_masked_gp_l1_reg_loss: 156090.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104416.6328; val_chrom_access_recon_loss: 9668603.7333; val_global_loss: 31155847.8667; val_optim_loss: 31155847.8667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9471; val_auprc_score: 0.9368; val_best_acc_score: 0.8816; val_best_f1_score: 0.8892; train_kl_reg_loss: 119466.4479; train_edge_recon_loss: 2783518.1889; train_gene_expr_recon_loss: 18425438.6489; train_masked_gp_l1_reg_loss: 157156.4753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102992.0561; train_chrom_access_recon_loss: 9580814.0992; train_global_loss: 31169385.8168; train_optim_loss: 31169385.8168; val_kl_reg_loss: 120529.4932; val_edge_recon_loss: 2772767.5833; val_gene_expr_recon_loss: 18276373.7333; val_masked_gp_l1_reg_loss: 157756.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101421.9688; val_chrom_access_recon_loss: 9721940.0000; val_global_loss: 31150789.0667; val_optim_loss: 31150789.0667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9511; val_auprc_score: 0.9385; val_best_acc_score: 0.8894; val_best_f1_score: 0.8947; train_kl_reg_loss: 117033.3292; train_edge_recon_loss: 2779958.9027; train_gene_expr_recon_loss: 18302576.7634; train_masked_gp_l1_reg_loss: 159196.0392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100718.6103; train_chrom_access_recon_loss: 9515926.6183; train_global_loss: 30975410.2443; train_optim_loss: 30975410.2443; val_kl_reg_loss: 115343.9443; val_edge_recon_loss: 2763587.2000; val_gene_expr_recon_loss: 18130898.9333; val_masked_gp_l1_reg_loss: 160058.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99623.5469; val_chrom_access_recon_loss: 9600976.4000; val_global_loss: 30870488.2667; val_optim_loss: 30870488.2667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9483; val_auprc_score: 0.9363; val_best_acc_score: 0.8871; val_best_f1_score: 0.8919; train_kl_reg_loss: 114361.8980; train_edge_recon_loss: 2770105.4427; train_gene_expr_recon_loss: 18218905.5725; train_masked_gp_l1_reg_loss: 160938.6716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98845.5309; train_chrom_access_recon_loss: 9469557.3206; train_global_loss: 30832714.3817; train_optim_loss: 30832714.3817; val_kl_reg_loss: 118433.9589; val_edge_recon_loss: 2785721.7833; val_gene_expr_recon_loss: 18036788.0000; val_masked_gp_l1_reg_loss: 161936.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98006.1172; val_chrom_access_recon_loss: 9568081.9333; val_global_loss: 30768968.0000; val_optim_loss: 30768968.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9512; val_auprc_score: 0.9398; val_best_acc_score: 0.8874; val_best_f1_score: 0.8932; train_kl_reg_loss: 115082.4077; train_edge_recon_loss: 2754787.9943; train_gene_expr_recon_loss: 18135597.5344; train_masked_gp_l1_reg_loss: 162447.2106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97055.5787; train_chrom_access_recon_loss: 9419832.2519; train_global_loss: 30684802.8702; train_optim_loss: 30684802.8702; val_kl_reg_loss: 110283.4552; val_edge_recon_loss: 2778825.9333; val_gene_expr_recon_loss: 17932947.3333; val_masked_gp_l1_reg_loss: 163567.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96572.8672; val_chrom_access_recon_loss: 9490291.8667; val_global_loss: 30572488.4000; val_optim_loss: 30572488.4000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9566; val_auprc_score: 0.9459; val_best_acc_score: 0.8960; val_best_f1_score: 0.9004; train_kl_reg_loss: 112544.7895; train_edge_recon_loss: 2752051.0897; train_gene_expr_recon_loss: 18033593.8626; train_masked_gp_l1_reg_loss: 163879.0515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95531.7189; train_chrom_access_recon_loss: 9366773.4656; train_global_loss: 30524373.9237; train_optim_loss: 30524373.9237; val_kl_reg_loss: 112458.7010; val_edge_recon_loss: 2770262.7667; val_gene_expr_recon_loss: 17809980.4000; val_masked_gp_l1_reg_loss: 164749.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94533.7266; val_chrom_access_recon_loss: 9418969.0667; val_global_loss: 30370954.6667; val_optim_loss: 30370954.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9633; val_auprc_score: 0.9544; val_best_acc_score: 0.9082; val_best_f1_score: 0.9109; train_kl_reg_loss: 110027.1035; train_edge_recon_loss: 2746937.8282; train_gene_expr_recon_loss: 17965357.6183; train_masked_gp_l1_reg_loss: 165140.9401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94195.3841; train_chrom_access_recon_loss: 9328209.5573; train_global_loss: 30409868.2290; train_optim_loss: 30409868.2290; val_kl_reg_loss: 111428.9391; val_edge_recon_loss: 2735822.4500; val_gene_expr_recon_loss: 17807666.1333; val_masked_gp_l1_reg_loss: 165628.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94038.6328; val_chrom_access_recon_loss: 9417364.4667; val_global_loss: 30331948.1333; val_optim_loss: 30331948.1333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9610; val_auprc_score: 0.9513; val_best_acc_score: 0.9010; val_best_f1_score: 0.9062; train_kl_reg_loss: 110362.8213; train_edge_recon_loss: 2738550.5763; train_gene_expr_recon_loss: 17897786.6183; train_masked_gp_l1_reg_loss: 166032.0595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93212.0114; train_chrom_access_recon_loss: 9278384.4046; train_global_loss: 30284328.2137; train_optim_loss: 30284328.2137; val_kl_reg_loss: 107870.0490; val_edge_recon_loss: 2759698.2333; val_gene_expr_recon_loss: 17649463.7333; val_masked_gp_l1_reg_loss: 166636.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93160.0000; val_chrom_access_recon_loss: 9332568.2000; val_global_loss: 30109396.2667; val_optim_loss: 30109396.2667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9618; val_auprc_score: 0.9494; val_best_acc_score: 0.9050; val_best_f1_score: 0.9086; train_kl_reg_loss: 108984.7567; train_edge_recon_loss: 2734727.4866; train_gene_expr_recon_loss: 17839527.7710; train_masked_gp_l1_reg_loss: 167240.0821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92430.1130; train_chrom_access_recon_loss: 9246865.7863; train_global_loss: 30189775.8779; train_optim_loss: 30189775.8779; val_kl_reg_loss: 112237.4187; val_edge_recon_loss: 2758010.2333; val_gene_expr_recon_loss: 17729770.9333; val_masked_gp_l1_reg_loss: 167642.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92039.1094; val_chrom_access_recon_loss: 9328673.4667; val_global_loss: 30188374.1333; val_optim_loss: 30188374.1333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9632; val_auprc_score: 0.9513; val_best_acc_score: 0.9095; val_best_f1_score: 0.9122; train_kl_reg_loss: 109907.4850; train_edge_recon_loss: 2731601.9695; train_gene_expr_recon_loss: 17784157.7939; train_masked_gp_l1_reg_loss: 167816.2449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91575.9702; train_chrom_access_recon_loss: 9221249.6947; train_global_loss: 30106309.1908; train_optim_loss: 30106309.1908; val_kl_reg_loss: 110891.2344; val_edge_recon_loss: 2744617.5167; val_gene_expr_recon_loss: 17633599.2000; val_masked_gp_l1_reg_loss: 168181.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91378.9844; val_chrom_access_recon_loss: 9284736.3333; val_global_loss: 30033404.1333; val_optim_loss: 30033404.1333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9639; val_auprc_score: 0.9535; val_best_acc_score: 0.9103; val_best_f1_score: 0.9136; train_kl_reg_loss: 108616.2056; train_edge_recon_loss: 2731896.1832; train_gene_expr_recon_loss: 17726945.5802; train_masked_gp_l1_reg_loss: 168532.0963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91004.5134; train_chrom_access_recon_loss: 9185773.5763; train_global_loss: 30012768.1679; train_optim_loss: 30012768.1679; val_kl_reg_loss: 107147.0271; val_edge_recon_loss: 2748299.3167; val_gene_expr_recon_loss: 17521411.7333; val_masked_gp_l1_reg_loss: 169156.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90540.2109; val_chrom_access_recon_loss: 9272369.4000; val_global_loss: 29908923.4667; val_optim_loss: 29908923.4667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9709; val_auprc_score: 0.9637; val_best_acc_score: 0.9179; val_best_f1_score: 0.9214; train_kl_reg_loss: 108529.3970; train_edge_recon_loss: 2725434.2347; train_gene_expr_recon_loss: 17683860.0229; train_masked_gp_l1_reg_loss: 169154.8755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90613.4225; train_chrom_access_recon_loss: 9160042.0611; train_global_loss: 29937634.0458; train_optim_loss: 29937634.0458; val_kl_reg_loss: 110812.8573; val_edge_recon_loss: 2719266.0500; val_gene_expr_recon_loss: 17533227.7333; val_masked_gp_l1_reg_loss: 169494.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90809.6328; val_chrom_access_recon_loss: 9278671.6000; val_global_loss: 29902282.1333; val_optim_loss: 29902282.1333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9673; val_auprc_score: 0.9572; val_best_acc_score: 0.9169; val_best_f1_score: 0.9202; train_kl_reg_loss: 108127.7821; train_edge_recon_loss: 2720711.7977; train_gene_expr_recon_loss: 17642110.9695; train_masked_gp_l1_reg_loss: 169842.3514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90511.9334; train_chrom_access_recon_loss: 9139243.2977; train_global_loss: 29870548.2443; train_optim_loss: 29870548.2443; val_kl_reg_loss: 108736.9292; val_edge_recon_loss: 2745321.2000; val_gene_expr_recon_loss: 17532915.8667; val_masked_gp_l1_reg_loss: 170631.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90898.4219; val_chrom_access_recon_loss: 9254599.2667; val_global_loss: 29903103.0667; val_optim_loss: 29903103.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9729; val_auprc_score: 0.9665; val_best_acc_score: 0.9235; val_best_f1_score: 0.9267; train_kl_reg_loss: 107322.4167; train_edge_recon_loss: 2724038.0687; train_gene_expr_recon_loss: 17593274.8321; train_masked_gp_l1_reg_loss: 170529.2211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90619.5414; train_chrom_access_recon_loss: 9102022.0763; train_global_loss: 29787806.0000; train_optim_loss: 29787806.0000; val_kl_reg_loss: 106243.4651; val_edge_recon_loss: 2718214.9000; val_gene_expr_recon_loss: 17458616.0000; val_masked_gp_l1_reg_loss: 170840.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90940.8281; val_chrom_access_recon_loss: 9209615.3333; val_global_loss: 29754470.1333; val_optim_loss: 29754470.1333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9736; val_auprc_score: 0.9683; val_best_acc_score: 0.9174; val_best_f1_score: 0.9205; train_kl_reg_loss: 107159.1628; train_edge_recon_loss: 2724039.7271; train_gene_expr_recon_loss: 17556203.8092; train_masked_gp_l1_reg_loss: 171122.8391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90720.1022; train_chrom_access_recon_loss: 9075628.2901; train_global_loss: 29724873.8168; train_optim_loss: 29724873.8168; val_kl_reg_loss: 104796.1661; val_edge_recon_loss: 2752631.8000; val_gene_expr_recon_loss: 17343176.9333; val_masked_gp_l1_reg_loss: 171498.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90861.8047; val_chrom_access_recon_loss: 9167020.5333; val_global_loss: 29629985.6000; val_optim_loss: 29629985.6000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9718; val_auprc_score: 0.9652; val_best_acc_score: 0.9240; val_best_f1_score: 0.9273; train_kl_reg_loss: 106247.3564; train_edge_recon_loss: 2722890.1546; train_gene_expr_recon_loss: 17522546.7863; train_masked_gp_l1_reg_loss: 171732.1014; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91068.9358; train_chrom_access_recon_loss: 9065239.8626; train_global_loss: 29679725.1908; train_optim_loss: 29679725.1908; val_kl_reg_loss: 110571.8906; val_edge_recon_loss: 2717963.8500; val_gene_expr_recon_loss: 17413465.0000; val_masked_gp_l1_reg_loss: 172157.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91341.2891; val_chrom_access_recon_loss: 9190977.4667; val_global_loss: 29696478.4000; val_optim_loss: 29696478.4000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9717; val_auprc_score: 0.9647; val_best_acc_score: 0.9221; val_best_f1_score: 0.9254; train_kl_reg_loss: 106623.9927; train_edge_recon_loss: 2728062.1679; train_gene_expr_recon_loss: 17492943.8779; train_masked_gp_l1_reg_loss: 172331.2053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91433.4342; train_chrom_access_recon_loss: 9032494.0000; train_global_loss: 29623888.7634; train_optim_loss: 29623888.7634; val_kl_reg_loss: 104502.3807; val_edge_recon_loss: 2737512.2333; val_gene_expr_recon_loss: 17279857.7333; val_masked_gp_l1_reg_loss: 172495.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91468.7422; val_chrom_access_recon_loss: 9095470.9333; val_global_loss: 29481307.2000; val_optim_loss: 29481307.2000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9781; val_auprc_score: 0.9703; val_best_acc_score: 0.9336; val_best_f1_score: 0.9348; train_kl_reg_loss: 106194.7314; train_edge_recon_loss: 2715994.2290; train_gene_expr_recon_loss: 17451446.2137; train_masked_gp_l1_reg_loss: 172726.3801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91587.2978; train_chrom_access_recon_loss: 9012412.2824; train_global_loss: 29550360.9924; train_optim_loss: 29550360.9924; val_kl_reg_loss: 107028.1313; val_edge_recon_loss: 2688115.4500; val_gene_expr_recon_loss: 17330392.4667; val_masked_gp_l1_reg_loss: 173092.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91902.6328; val_chrom_access_recon_loss: 9146630.3333; val_global_loss: 29537160.1333; val_optim_loss: 29537160.1333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9749; val_auprc_score: 0.9670; val_best_acc_score: 0.9275; val_best_f1_score: 0.9297; train_kl_reg_loss: 114626.6332; train_edge_recon_loss: 2750165.0802; train_gene_expr_recon_loss: 16985954.4198; train_masked_gp_l1_reg_loss: 170124.1486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86719.1449; train_chrom_access_recon_loss: 8835742.6031; train_global_loss: 28943331.9695; train_optim_loss: 28943331.9695; val_kl_reg_loss: 75910.5385; val_edge_recon_loss: 2746645.8667; val_gene_expr_recon_loss: 16813428.6667; val_masked_gp_l1_reg_loss: 169494.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85894.2422; val_chrom_access_recon_loss: 8886157.6667; val_global_loss: 28777530.6667; val_optim_loss: 28777530.6667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9738; val_auprc_score: 0.9638; val_best_acc_score: 0.9285; val_best_f1_score: 0.9299; train_kl_reg_loss: 109109.4271; train_edge_recon_loss: 2732907.0153; train_gene_expr_recon_loss: 16954302.2366; train_masked_gp_l1_reg_loss: 168950.9219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86065.1308; train_chrom_access_recon_loss: 8813117.5420; train_global_loss: 28864452.3053; train_optim_loss: 28864452.3053; val_kl_reg_loss: 80137.1266; val_edge_recon_loss: 2743528.6500; val_gene_expr_recon_loss: 16824931.0667; val_masked_gp_l1_reg_loss: 168950.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86976.4141; val_chrom_access_recon_loss: 8916130.0000; val_global_loss: 28820652.6667; val_optim_loss: 28820652.6667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9773; val_auprc_score: 0.9715; val_best_acc_score: 0.9309; val_best_f1_score: 0.9328; train_kl_reg_loss: 104539.6081; train_edge_recon_loss: 2716153.0210; train_gene_expr_recon_loss: 16923086.9847; train_masked_gp_l1_reg_loss: 168467.6415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86336.6034; train_chrom_access_recon_loss: 8804923.3206; train_global_loss: 28803507.1145; train_optim_loss: 28803507.1145; val_kl_reg_loss: 88107.9260; val_edge_recon_loss: 2704756.5000; val_gene_expr_recon_loss: 16746321.6000; val_masked_gp_l1_reg_loss: 168018.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85987.3828; val_chrom_access_recon_loss: 8854241.0000; val_global_loss: 28647433.3333; val_optim_loss: 28647433.3333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9775; val_auprc_score: 0.9708; val_best_acc_score: 0.9298; val_best_f1_score: 0.9320; train_kl_reg_loss: 101694.1910; train_edge_recon_loss: 2715656.3893; train_gene_expr_recon_loss: 16881504.3130; train_masked_gp_l1_reg_loss: 167620.8291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85909.7735; train_chrom_access_recon_loss: 8780252.3092; train_global_loss: 28732637.6947; train_optim_loss: 28732637.6947; val_kl_reg_loss: 89337.0818; val_edge_recon_loss: 2746051.1833; val_gene_expr_recon_loss: 16836584.5333; val_masked_gp_l1_reg_loss: 167271.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86432.8672; val_chrom_access_recon_loss: 8910246.7000; val_global_loss: 28835923.2000; val_optim_loss: 28835923.2000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9763; val_auprc_score: 0.9692; val_best_acc_score: 0.9324; val_best_f1_score: 0.9340; train_kl_reg_loss: 100404.3050; train_edge_recon_loss: 2708889.2252; train_gene_expr_recon_loss: 16864718.7481; train_masked_gp_l1_reg_loss: 166992.6418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85534.1849; train_chrom_access_recon_loss: 8775343.3282; train_global_loss: 28701882.5191; train_optim_loss: 28701882.5191; val_kl_reg_loss: 90126.7943; val_edge_recon_loss: 2714987.7000; val_gene_expr_recon_loss: 16727035.7333; val_masked_gp_l1_reg_loss: 166643.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85550.0312; val_chrom_access_recon_loss: 8872671.2000; val_global_loss: 28657015.3333; val_optim_loss: 28657015.3333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9786; val_auprc_score: 0.9732; val_best_acc_score: 0.9303; val_best_f1_score: 0.9328; train_kl_reg_loss: 98276.1299; train_edge_recon_loss: 2713777.8149; train_gene_expr_recon_loss: 16826230.0382; train_masked_gp_l1_reg_loss: 166398.2042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85444.5026; train_chrom_access_recon_loss: 8755903.4504; train_global_loss: 28646030.0916; train_optim_loss: 28646030.0916; val_kl_reg_loss: 90177.3677; val_edge_recon_loss: 2722390.6500; val_gene_expr_recon_loss: 16688390.3333; val_masked_gp_l1_reg_loss: 166339.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84830.8750; val_chrom_access_recon_loss: 8851321.8667; val_global_loss: 28603450.5333; val_optim_loss: 28603450.5333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9780; val_auprc_score: 0.9719; val_best_acc_score: 0.9307; val_best_f1_score: 0.9325; train_kl_reg_loss: 98241.8365; train_edge_recon_loss: 2707548.4065; train_gene_expr_recon_loss: 16816366.6489; train_masked_gp_l1_reg_loss: 166175.0302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85395.9516; train_chrom_access_recon_loss: 8750997.1565; train_global_loss: 28624725.1450; train_optim_loss: 28624725.1450; val_kl_reg_loss: 92345.6057; val_edge_recon_loss: 2726682.5167; val_gene_expr_recon_loss: 16705434.8000; val_masked_gp_l1_reg_loss: 166026.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84648.7422; val_chrom_access_recon_loss: 8851465.9000; val_global_loss: 28626602.9333; val_optim_loss: 28626602.9333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9798; val_auprc_score: 0.9754; val_best_acc_score: 0.9341; val_best_f1_score: 0.9363; train_kl_reg_loss: 97427.9450; train_edge_recon_loss: 2703511.6546; train_gene_expr_recon_loss: 16786756.2595; train_masked_gp_l1_reg_loss: 165950.4074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85147.9191; train_chrom_access_recon_loss: 8731874.5954; train_global_loss: 28570668.8397; train_optim_loss: 28570668.8397; val_kl_reg_loss: 94688.2380; val_edge_recon_loss: 2706938.9833; val_gene_expr_recon_loss: 16703701.7333; val_masked_gp_l1_reg_loss: 165729.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85202.9844; val_chrom_access_recon_loss: 8852196.8667; val_global_loss: 28608458.0000; val_optim_loss: 28608458.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9803; val_auprc_score: 0.9756; val_best_acc_score: 0.9340; val_best_f1_score: 0.9363; train_kl_reg_loss: 97623.5513; train_edge_recon_loss: 2706604.3473; train_gene_expr_recon_loss: 16759391.9847; train_masked_gp_l1_reg_loss: 165637.0037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85137.2157; train_chrom_access_recon_loss: 8719539.0458; train_global_loss: 28533933.1756; train_optim_loss: 28533933.1756; val_kl_reg_loss: 94357.3214; val_edge_recon_loss: 2713293.8500; val_gene_expr_recon_loss: 16616350.2000; val_masked_gp_l1_reg_loss: 165545.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84976.2656; val_chrom_access_recon_loss: 8791110.6000; val_global_loss: 28465634.0000; val_optim_loss: 28465634.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9790; val_auprc_score: 0.9743; val_best_acc_score: 0.9352; val_best_f1_score: 0.9367; train_kl_reg_loss: 97771.8956; train_edge_recon_loss: 2700296.9427; train_gene_expr_recon_loss: 16757055.3053; train_masked_gp_l1_reg_loss: 165435.3144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85007.9458; train_chrom_access_recon_loss: 8715060.4847; train_global_loss: 28520627.8473; train_optim_loss: 28520627.8473; val_kl_reg_loss: 94917.8943; val_edge_recon_loss: 2716208.4333; val_gene_expr_recon_loss: 16645582.4000; val_masked_gp_l1_reg_loss: 165471.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85024.2734; val_chrom_access_recon_loss: 8792234.0667; val_global_loss: 28499438.8000; val_optim_loss: 28499438.8000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9803; val_auprc_score: 0.9765; val_best_acc_score: 0.9348; val_best_f1_score: 0.9370; train_kl_reg_loss: 97927.3247; train_edge_recon_loss: 2702484.8626; train_gene_expr_recon_loss: 16727357.7176; train_masked_gp_l1_reg_loss: 165399.5916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84915.7855; train_chrom_access_recon_loss: 8685278.9427; train_global_loss: 28463364.0916; train_optim_loss: 28463364.0916; val_kl_reg_loss: 92873.6797; val_edge_recon_loss: 2723525.5333; val_gene_expr_recon_loss: 16614761.4667; val_masked_gp_l1_reg_loss: 165214.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85070.2031; val_chrom_access_recon_loss: 8791369.9667; val_global_loss: 28472815.0667; val_optim_loss: 28472815.0667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9801; val_auprc_score: 0.9711; val_best_acc_score: 0.9348; val_best_f1_score: 0.9364; train_kl_reg_loss: 97543.2640; train_edge_recon_loss: 2705142.4198; train_gene_expr_recon_loss: 16708263.7557; train_masked_gp_l1_reg_loss: 165060.1566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84924.0081; train_chrom_access_recon_loss: 8675959.4542; train_global_loss: 28436893.1908; train_optim_loss: 28436893.1908; val_kl_reg_loss: 96355.7370; val_edge_recon_loss: 2708999.2000; val_gene_expr_recon_loss: 16657112.5333; val_masked_gp_l1_reg_loss: 164926.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84909.9766; val_chrom_access_recon_loss: 8816618.4000; val_global_loss: 28528922.0000; val_optim_loss: 28528922.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9804; val_auprc_score: 0.9732; val_best_acc_score: 0.9368; val_best_f1_score: 0.9383; train_kl_reg_loss: 97467.7258; train_edge_recon_loss: 2705205.4656; train_gene_expr_recon_loss: 16712406.0076; train_masked_gp_l1_reg_loss: 164956.6936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84770.1060; train_chrom_access_recon_loss: 8681420.3893; train_global_loss: 28446226.4275; train_optim_loss: 28446226.4275; val_kl_reg_loss: 95092.2573; val_edge_recon_loss: 2716456.5833; val_gene_expr_recon_loss: 16610658.3333; val_masked_gp_l1_reg_loss: 164882.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84495.1094; val_chrom_access_recon_loss: 8783345.8667; val_global_loss: 28454931.3333; val_optim_loss: 28454931.3333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9793; val_auprc_score: 0.9746; val_best_acc_score: 0.9344; val_best_f1_score: 0.9372; train_kl_reg_loss: 97574.3492; train_edge_recon_loss: 2707767.7481; train_gene_expr_recon_loss: 16691918.3130; train_masked_gp_l1_reg_loss: 164672.3333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84603.5157; train_chrom_access_recon_loss: 8672207.3206; train_global_loss: 28418743.6183; train_optim_loss: 28418743.6183; val_kl_reg_loss: 92254.4396; val_edge_recon_loss: 2734110.6167; val_gene_expr_recon_loss: 16580374.6000; val_masked_gp_l1_reg_loss: 164754.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84944.9219; val_chrom_access_recon_loss: 8772438.4000; val_global_loss: 28428875.8667; val_optim_loss: 28428875.8667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9795; val_auprc_score: 0.9707; val_best_acc_score: 0.9371; val_best_f1_score: 0.9390; train_kl_reg_loss: 96687.4906; train_edge_recon_loss: 2697083.1870; train_gene_expr_recon_loss: 16668433.0305; train_masked_gp_l1_reg_loss: 164549.2230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84751.9362; train_chrom_access_recon_loss: 8657069.2481; train_global_loss: 28368574.1374; train_optim_loss: 28368574.1374; val_kl_reg_loss: 96266.3646; val_edge_recon_loss: 2718359.4500; val_gene_expr_recon_loss: 16545883.6667; val_masked_gp_l1_reg_loss: 164667.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84840.6250; val_chrom_access_recon_loss: 8738701.3333; val_global_loss: 28348718.9333; val_optim_loss: 28348718.9333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9817; val_auprc_score: 0.9752; val_best_acc_score: 0.9403; val_best_f1_score: 0.9417; train_kl_reg_loss: 95743.3338; train_edge_recon_loss: 2709892.2118; train_gene_expr_recon_loss: 16661408.3740; train_masked_gp_l1_reg_loss: 164557.5475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84693.1066; train_chrom_access_recon_loss: 8662348.2099; train_global_loss: 28378642.7328; train_optim_loss: 28378642.7328; val_kl_reg_loss: 95395.5281; val_edge_recon_loss: 2716411.6667; val_gene_expr_recon_loss: 16624892.7333; val_masked_gp_l1_reg_loss: 164503.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84628.9766; val_chrom_access_recon_loss: 8792940.4667; val_global_loss: 28478772.1333; val_optim_loss: 28478772.1333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9818; val_auprc_score: 0.9752; val_best_acc_score: 0.9427; val_best_f1_score: 0.9440; train_kl_reg_loss: 96728.0407; train_edge_recon_loss: 2702938.4408; train_gene_expr_recon_loss: 16650242.9466; train_masked_gp_l1_reg_loss: 164266.0403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84624.5796; train_chrom_access_recon_loss: 8655553.6565; train_global_loss: 28354353.7252; train_optim_loss: 28354353.7252; val_kl_reg_loss: 96247.4057; val_edge_recon_loss: 2700126.6833; val_gene_expr_recon_loss: 16580883.4000; val_masked_gp_l1_reg_loss: 164097.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84740.5703; val_chrom_access_recon_loss: 8774175.6333; val_global_loss: 28400271.2000; val_optim_loss: 28400271.2000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9834; val_auprc_score: 0.9793; val_best_acc_score: 0.9429; val_best_f1_score: 0.9437; train_kl_reg_loss: 96855.2801; train_edge_recon_loss: 2703638.9218; train_gene_expr_recon_loss: 16641324.0305; train_masked_gp_l1_reg_loss: 163912.4692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84628.8245; train_chrom_access_recon_loss: 8643869.2748; train_global_loss: 28334228.7634; train_optim_loss: 28334228.7634; val_kl_reg_loss: 95433.7083; val_edge_recon_loss: 2703033.4000; val_gene_expr_recon_loss: 16572809.6667; val_masked_gp_l1_reg_loss: 163950.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84950.6875; val_chrom_access_recon_loss: 8762017.9000; val_global_loss: 28382194.9333; val_optim_loss: 28382194.9333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9823; val_auprc_score: 0.9772; val_best_acc_score: 0.9410; val_best_f1_score: 0.9425; train_kl_reg_loss: 96788.2807; train_edge_recon_loss: 2698742.2252; train_gene_expr_recon_loss: 16620446.4962; train_masked_gp_l1_reg_loss: 163605.3052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84588.8603; train_chrom_access_recon_loss: 8634687.9924; train_global_loss: 28298858.9313; train_optim_loss: 28298858.9313; val_kl_reg_loss: 93985.0344; val_edge_recon_loss: 2716497.8833; val_gene_expr_recon_loss: 16592178.4000; val_masked_gp_l1_reg_loss: 163382.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84013.0938; val_chrom_access_recon_loss: 8768691.0000; val_global_loss: 28418748.2667; val_optim_loss: 28418748.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9821; val_auprc_score: 0.9733; val_best_acc_score: 0.9446; val_best_f1_score: 0.9461; train_kl_reg_loss: 97378.2196; train_edge_recon_loss: 2699965.4752; train_gene_expr_recon_loss: 16591104.0382; train_masked_gp_l1_reg_loss: 160700.2468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65807.7028; train_chrom_access_recon_loss: 8623939.4962; train_global_loss: 28238895.1603; train_optim_loss: 28238895.1603; val_kl_reg_loss: 97514.1964; val_edge_recon_loss: 2708765.2833; val_gene_expr_recon_loss: 16464531.9333; val_masked_gp_l1_reg_loss: 159894.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63857.9727; val_chrom_access_recon_loss: 8712200.8000; val_global_loss: 28206764.4000; val_optim_loss: 28206764.4000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9827; val_auprc_score: 0.9737; val_best_acc_score: 0.9440; val_best_f1_score: 0.9452; train_kl_reg_loss: 99408.2682; train_edge_recon_loss: 2694437.9981; train_gene_expr_recon_loss: 16584575.7786; train_masked_gp_l1_reg_loss: 159681.2742; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63465.7962; train_chrom_access_recon_loss: 8623933.3855; train_global_loss: 28225502.4122; train_optim_loss: 28225502.4122; val_kl_reg_loss: 98469.9276; val_edge_recon_loss: 2707362.1000; val_gene_expr_recon_loss: 16484117.8667; val_masked_gp_l1_reg_loss: 159484.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63155.0742; val_chrom_access_recon_loss: 8755796.4000; val_global_loss: 28268386.4000; val_optim_loss: 28268386.4000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9844; val_auprc_score: 0.9796; val_best_acc_score: 0.9454; val_best_f1_score: 0.9470; train_kl_reg_loss: 99834.3206; train_edge_recon_loss: 2692791.3836; train_gene_expr_recon_loss: 16578917.2290; train_masked_gp_l1_reg_loss: 159393.4515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62876.2458; train_chrom_access_recon_loss: 8619614.3664; train_global_loss: 28213426.9618; train_optim_loss: 28213426.9618; val_kl_reg_loss: 99310.8365; val_edge_recon_loss: 2695446.0833; val_gene_expr_recon_loss: 16511446.4000; val_masked_gp_l1_reg_loss: 159294.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62666.3984; val_chrom_access_recon_loss: 8726973.2667; val_global_loss: 28255136.8000; val_optim_loss: 28255136.8000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9846; val_auprc_score: 0.9802; val_best_acc_score: 0.9446; val_best_f1_score: 0.9458; train_kl_reg_loss: 100212.9442; train_edge_recon_loss: 2695011.0992; train_gene_expr_recon_loss: 16578289.1298; train_masked_gp_l1_reg_loss: 159203.2455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62439.7608; train_chrom_access_recon_loss: 8617233.0649; train_global_loss: 28212389.2977; train_optim_loss: 28212389.2977; val_kl_reg_loss: 99021.2401; val_edge_recon_loss: 2705302.2833; val_gene_expr_recon_loss: 16481061.0667; val_masked_gp_l1_reg_loss: 159124.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62273.1719; val_chrom_access_recon_loss: 8742990.7333; val_global_loss: 28249773.2000; val_optim_loss: 28249773.2000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9851; val_auprc_score: 0.9822; val_best_acc_score: 0.9462; val_best_f1_score: 0.9468; train_kl_reg_loss: 100208.9962; train_edge_recon_loss: 2694830.2004; train_gene_expr_recon_loss: 16584597.7023; train_masked_gp_l1_reg_loss: 159070.9732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62101.5522; train_chrom_access_recon_loss: 8623680.4771; train_global_loss: 28224489.8931; train_optim_loss: 28224489.8931; val_kl_reg_loss: 99435.6422; val_edge_recon_loss: 2708473.5500; val_gene_expr_recon_loss: 16513263.4667; val_masked_gp_l1_reg_loss: 159019.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61852.5430; val_chrom_access_recon_loss: 8732639.7667; val_global_loss: 28274684.2667; val_optim_loss: 28274684.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9847; val_auprc_score: 0.9777; val_best_acc_score: 0.9481; val_best_f1_score: 0.9492; train_kl_reg_loss: 99889.2703; train_edge_recon_loss: 2698429.2824; train_gene_expr_recon_loss: 16576783.7099; train_masked_gp_l1_reg_loss: 158738.6955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59840.4266; train_chrom_access_recon_loss: 8616185.8168; train_global_loss: 28209867.1450; train_optim_loss: 28209867.1450; val_kl_reg_loss: 99559.5818; val_edge_recon_loss: 2691508.1667; val_gene_expr_recon_loss: 16532496.4667; val_masked_gp_l1_reg_loss: 158634.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59627.9844; val_chrom_access_recon_loss: 8753954.0000; val_global_loss: 28295780.5333; val_optim_loss: 28295780.5333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9823; val_auprc_score: 0.9768; val_best_acc_score: 0.9425; val_best_f1_score: 0.9440; train_kl_reg_loss: 100115.1830; train_edge_recon_loss: 2694136.1870; train_gene_expr_recon_loss: 16577437.8931; train_masked_gp_l1_reg_loss: 158594.8547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59597.7918; train_chrom_access_recon_loss: 8622852.6260; train_global_loss: 28212734.6412; train_optim_loss: 28212734.6412; val_kl_reg_loss: 99772.5781; val_edge_recon_loss: 2706132.9833; val_gene_expr_recon_loss: 16530010.8667; val_masked_gp_l1_reg_loss: 158557.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59553.5664; val_chrom_access_recon_loss: 8755131.8667; val_global_loss: 28309160.2667; val_optim_loss: 28309160.2667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9845; val_auprc_score: 0.9815; val_best_acc_score: 0.9449; val_best_f1_score: 0.9466; train_kl_reg_loss: 100240.4236; train_edge_recon_loss: 2689895.0573; train_gene_expr_recon_loss: 16563793.8550; train_masked_gp_l1_reg_loss: 158541.3771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59526.7288; train_chrom_access_recon_loss: 8613862.7824; train_global_loss: 28185860.1985; train_optim_loss: 28185860.1985; val_kl_reg_loss: 99719.4891; val_edge_recon_loss: 2699616.4500; val_gene_expr_recon_loss: 16492133.9333; val_masked_gp_l1_reg_loss: 158521.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59491.6914; val_chrom_access_recon_loss: 8737163.7000; val_global_loss: 28246647.8667; val_optim_loss: 28246647.8667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9849; val_auprc_score: 0.9803; val_best_acc_score: 0.9461; val_best_f1_score: 0.9473; train_kl_reg_loss: 100466.5278; train_edge_recon_loss: 2694580.6107; train_gene_expr_recon_loss: 16574629.9084; train_masked_gp_l1_reg_loss: 158506.5859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59460.1716; train_chrom_access_recon_loss: 8618883.7290; train_global_loss: 28206527.5267; train_optim_loss: 28206527.5267; val_kl_reg_loss: 100011.5276; val_edge_recon_loss: 2699944.8000; val_gene_expr_recon_loss: 16480891.0000; val_masked_gp_l1_reg_loss: 158492.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59436.5078; val_chrom_access_recon_loss: 8776111.8333; val_global_loss: 28274887.2000; val_optim_loss: 28274887.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 80 min 2 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9829
val AUPRC score: 0.9771
val best accuracy score: 0.9437
val best F1 score: 0.9451
val target rna MSE score: 1.2582
val source rna MSE score: 0.3558
val target atac MSE score: 0.3401
val source atac MSE score: 0.0565
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
