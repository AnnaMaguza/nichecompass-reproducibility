[True]
Run timestamp: 27072023_013351_114.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_114']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8781; val_auprc_score: 0.9736; val_best_acc_score: 0.8507; val_best_f1_score: 0.9194; train_kl_reg_loss: 600892535.1678; train_edge_recon_loss: 11508749.8116; train_gene_expr_recon_loss: 17524308.0581; train_masked_gp_l1_reg_loss: 14235.7842; train_group_lasso_reg_loss: 0.0000; train_global_loss: 629939799.7628; train_optim_loss: 629939799.7628; val_kl_reg_loss: 1473838.8281; val_edge_recon_loss: 12126833.7917; val_gene_expr_recon_loss: 5231492.1250; val_masked_gp_l1_reg_loss: 15839.8848; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18848004.5833; val_optim_loss: 18848004.5833
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8879; val_auprc_score: 0.9757; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 252719115.2517; train_edge_recon_loss: 11616034.2233; train_gene_expr_recon_loss: 21231769.0744; train_masked_gp_l1_reg_loss: 16971.6132; train_group_lasso_reg_loss: 0.0000; train_global_loss: 285583899.1814; train_optim_loss: 285583899.1814; val_kl_reg_loss: 1290615.8490; val_edge_recon_loss: 11930434.5833; val_gene_expr_recon_loss: 6713195.7708; val_masked_gp_l1_reg_loss: 17825.7910; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19952072.3333; val_optim_loss: 19952072.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8858; val_auprc_score: 0.9753; val_best_acc_score: 0.8489; val_best_f1_score: 0.9183; train_kl_reg_loss: 83711327.6134; train_edge_recon_loss: 11837184.0372; train_gene_expr_recon_loss: 18678009.0372; train_masked_gp_l1_reg_loss: 18338.7564; train_group_lasso_reg_loss: 0.0000; train_global_loss: 114244859.9628; train_optim_loss: 114244859.9628; val_kl_reg_loss: 1139736.4635; val_edge_recon_loss: 12264254.5000; val_gene_expr_recon_loss: 7137338.0625; val_masked_gp_l1_reg_loss: 18883.8691; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20560212.9167; val_optim_loss: 20560212.9167
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8651; val_auprc_score: 0.9702; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 975707504.5047; train_edge_recon_loss: 11722390.7116; train_gene_expr_recon_loss: 20386018.8233; train_masked_gp_l1_reg_loss: 19875.9159; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1007835782.1953; train_optim_loss: 1007835782.1953; val_kl_reg_loss: 1106569.5260; val_edge_recon_loss: 11934180.1667; val_gene_expr_recon_loss: 6786127.7708; val_masked_gp_l1_reg_loss: 20893.7070; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19847771.3333; val_optim_loss: 19847771.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8671; val_auprc_score: 0.9696; val_best_acc_score: 0.8518; val_best_f1_score: 0.9199; train_kl_reg_loss: 4335590610.1477; train_edge_recon_loss: 11760670.6488; train_gene_expr_recon_loss: 22759035.3814; train_masked_gp_l1_reg_loss: 21795.6333; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4370132109.1256; train_optim_loss: 4370132109.1256; val_kl_reg_loss: 1493753.6979; val_edge_recon_loss: 12057878.6250; val_gene_expr_recon_loss: 9047306.5417; val_masked_gp_l1_reg_loss: 22544.4316; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22621482.8333; val_optim_loss: 22621482.8333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8558; val_auprc_score: 0.9677; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 6806206332.3320; train_edge_recon_loss: 11715611.8791; train_gene_expr_recon_loss: 20361231.1953; train_masked_gp_l1_reg_loss: 23016.8776; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6838306247.3116; train_optim_loss: 6838306247.3116; val_kl_reg_loss: 1325678.7812; val_edge_recon_loss: 12082393.1250; val_gene_expr_recon_loss: 9786951.9167; val_masked_gp_l1_reg_loss: 23770.7070; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23218794.0000; val_optim_loss: 23218794.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8375; val_auprc_score: 0.9639; val_best_acc_score: 0.8588; val_best_f1_score: 0.9229; train_kl_reg_loss: 1352648421.9547; train_edge_recon_loss: 11868336.8465; train_gene_expr_recon_loss: 17792404.3860; train_masked_gp_l1_reg_loss: 24019.7428; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1382333080.2791; train_optim_loss: 1382333080.2791; val_kl_reg_loss: 869252.8359; val_edge_recon_loss: 12256955.5000; val_gene_expr_recon_loss: 8865682.7500; val_masked_gp_l1_reg_loss: 24229.5723; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22016121.1667; val_optim_loss: 22016121.1667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8176; val_auprc_score: 0.9599; val_best_acc_score: 0.8655; val_best_f1_score: 0.9271; train_kl_reg_loss: 2239592103.7128; train_edge_recon_loss: 11788248.9535; train_gene_expr_recon_loss: 15906414.4256; train_masked_gp_l1_reg_loss: 24607.9355; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2267311410.7535; train_optim_loss: 2267311410.7535; val_kl_reg_loss: 905722.7812; val_edge_recon_loss: 11525860.3333; val_gene_expr_recon_loss: 6862609.3958; val_masked_gp_l1_reg_loss: 25292.5938; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19319484.2500; val_optim_loss: 19319484.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8180; val_auprc_score: 0.9584; val_best_acc_score: 0.8607; val_best_f1_score: 0.9243; train_kl_reg_loss: 809869.4706; train_edge_recon_loss: 11938209.1023; train_gene_expr_recon_loss: 6088398.3256; train_masked_gp_l1_reg_loss: 25194.0157; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18861670.8930; train_optim_loss: 18861670.8930; val_kl_reg_loss: 686318.8932; val_edge_recon_loss: 11930126.0833; val_gene_expr_recon_loss: 5907174.4792; val_masked_gp_l1_reg_loss: 25108.1074; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18548727.4167; val_optim_loss: 18548727.4167
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8175; val_auprc_score: 0.9588; val_best_acc_score: 0.8641; val_best_f1_score: 0.9262; train_kl_reg_loss: 688820.2849; train_edge_recon_loss: 11540137.2093; train_gene_expr_recon_loss: 5729945.7372; train_masked_gp_l1_reg_loss: 25043.3633; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17983946.5535; train_optim_loss: 17983946.5535; val_kl_reg_loss: 580460.8880; val_edge_recon_loss: 11662912.0000; val_gene_expr_recon_loss: 5595769.2083; val_masked_gp_l1_reg_loss: 24994.9844; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17864136.0833; val_optim_loss: 17864136.0833
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8221; val_auprc_score: 0.9605; val_best_acc_score: 0.8654; val_best_f1_score: 0.9270; train_kl_reg_loss: 591254.2823; train_edge_recon_loss: 11094453.5442; train_gene_expr_recon_loss: 5210787.5558; train_masked_gp_l1_reg_loss: 25001.7992; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16921497.1814; train_optim_loss: 16921497.1814; val_kl_reg_loss: 439188.5898; val_edge_recon_loss: 11467890.7500; val_gene_expr_recon_loss: 4833154.3750; val_masked_gp_l1_reg_loss: 25050.5156; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16765284.0833; val_optim_loss: 16765284.0833
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8273; val_auprc_score: 0.9609; val_best_acc_score: 0.8690; val_best_f1_score: 0.9279; train_kl_reg_loss: 440122.7484; train_edge_recon_loss: 10867503.5256; train_gene_expr_recon_loss: 4139833.7942; train_masked_gp_l1_reg_loss: 25203.1959; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15472663.2930; train_optim_loss: 15472663.2930; val_kl_reg_loss: 335161.8424; val_edge_recon_loss: 11361680.2083; val_gene_expr_recon_loss: 1577498.9844; val_masked_gp_l1_reg_loss: 25425.4258; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13299766.0000; val_optim_loss: 13299766.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8247; val_auprc_score: 0.9588; val_best_acc_score: 0.8651; val_best_f1_score: 0.9251; train_kl_reg_loss: 321432.5435; train_edge_recon_loss: 10804967.2651; train_gene_expr_recon_loss: 1360801.5680; train_masked_gp_l1_reg_loss: 25700.5363; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12512901.8512; train_optim_loss: 12512901.8512; val_kl_reg_loss: 237870.1719; val_edge_recon_loss: 11675109.8750; val_gene_expr_recon_loss: 1324552.0260; val_masked_gp_l1_reg_loss: 25936.9297; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13263469.0000; val_optim_loss: 13263469.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8271; val_auprc_score: 0.9609; val_best_acc_score: 0.8689; val_best_f1_score: 0.9275; train_kl_reg_loss: 247631.9614; train_edge_recon_loss: 10560552.4349; train_gene_expr_recon_loss: 1304981.0238; train_masked_gp_l1_reg_loss: 26139.3695; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12139304.7721; train_optim_loss: 12139304.7721; val_kl_reg_loss: 230393.9238; val_edge_recon_loss: 11311267.3750; val_gene_expr_recon_loss: 1273326.5260; val_masked_gp_l1_reg_loss: 26341.6250; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12841329.7917; val_optim_loss: 12841329.7917
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8255; val_auprc_score: 0.9610; val_best_acc_score: 0.8764; val_best_f1_score: 0.9317; train_kl_reg_loss: 207319.1763; train_edge_recon_loss: 10592277.7791; train_gene_expr_recon_loss: 1274119.7099; train_masked_gp_l1_reg_loss: 26533.5505; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12100250.2047; train_optim_loss: 12100250.2047; val_kl_reg_loss: 201914.0931; val_edge_recon_loss: 10916714.2500; val_gene_expr_recon_loss: 1268082.6198; val_masked_gp_l1_reg_loss: 26728.4141; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12413438.8750; val_optim_loss: 12413438.8750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8304; val_auprc_score: 0.9614; val_best_acc_score: 0.8734; val_best_f1_score: 0.9302; train_kl_reg_loss: 182961.3561; train_edge_recon_loss: 10476101.0163; train_gene_expr_recon_loss: 1286829.0186; train_masked_gp_l1_reg_loss: 26940.4022; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11972831.8279; train_optim_loss: 11972831.8279; val_kl_reg_loss: 166834.0241; val_edge_recon_loss: 11100188.5417; val_gene_expr_recon_loss: 1270765.5521; val_masked_gp_l1_reg_loss: 27146.9883; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12564935.1250; val_optim_loss: 12564935.1250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8354; val_auprc_score: 0.9627; val_best_acc_score: 0.8785; val_best_f1_score: 0.9325; train_kl_reg_loss: 163304.1788; train_edge_recon_loss: 10416717.9698; train_gene_expr_recon_loss: 1294534.4186; train_masked_gp_l1_reg_loss: 27344.8570; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11901901.4605; train_optim_loss: 11901901.4605; val_kl_reg_loss: 140561.8047; val_edge_recon_loss: 11018421.1667; val_gene_expr_recon_loss: 1283789.4062; val_masked_gp_l1_reg_loss: 27542.3398; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12470314.3333; val_optim_loss: 12470314.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8354; val_auprc_score: 0.9625; val_best_acc_score: 0.8777; val_best_f1_score: 0.9322; train_kl_reg_loss: 144616.6323; train_edge_recon_loss: 10249903.9767; train_gene_expr_recon_loss: 1329287.4128; train_masked_gp_l1_reg_loss: 27770.5582; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11751578.5930; train_optim_loss: 11751578.5930; val_kl_reg_loss: 132074.8926; val_edge_recon_loss: 10821509.6667; val_gene_expr_recon_loss: 1353385.6250; val_masked_gp_l1_reg_loss: 28001.5332; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12334972.1250; val_optim_loss: 12334972.1250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8400; val_auprc_score: 0.9643; val_best_acc_score: 0.8836; val_best_f1_score: 0.9356; train_kl_reg_loss: 127227.4172; train_edge_recon_loss: 10215860.5837; train_gene_expr_recon_loss: 1411333.4076; train_masked_gp_l1_reg_loss: 28281.0488; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11782702.4651; train_optim_loss: 11782702.4651; val_kl_reg_loss: 115014.9072; val_edge_recon_loss: 10321905.0000; val_gene_expr_recon_loss: 1477429.8229; val_masked_gp_l1_reg_loss: 28604.5859; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11942954.7500; val_optim_loss: 11942954.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8283; val_auprc_score: 0.9622; val_best_acc_score: 0.8848; val_best_f1_score: 0.9357; train_kl_reg_loss: 113013.1907; train_edge_recon_loss: 9295396.5721; train_gene_expr_recon_loss: 1904782.7924; train_masked_gp_l1_reg_loss: 29001.7767; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11342194.3209; train_optim_loss: 11342194.3209; val_kl_reg_loss: 110702.7643; val_edge_recon_loss: 9033242.5208; val_gene_expr_recon_loss: 2086277.5156; val_masked_gp_l1_reg_loss: 29185.0742; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11259407.8333; val_optim_loss: 11259407.8333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8356; val_auprc_score: 0.9626; val_best_acc_score: 0.8793; val_best_f1_score: 0.9321; train_kl_reg_loss: 111171.4288; train_edge_recon_loss: 8650311.0605; train_gene_expr_recon_loss: 2031534.4895; train_masked_gp_l1_reg_loss: 29205.5701; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10822222.4930; train_optim_loss: 10822222.4930; val_kl_reg_loss: 109950.8509; val_edge_recon_loss: 9330410.5417; val_gene_expr_recon_loss: 1990865.1354; val_masked_gp_l1_reg_loss: 29211.7539; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11460438.4583; val_optim_loss: 11460438.4583
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8411; val_auprc_score: 0.9661; val_best_acc_score: 0.8873; val_best_f1_score: 0.9372; train_kl_reg_loss: 110604.9127; train_edge_recon_loss: 8562837.7767; train_gene_expr_recon_loss: 1946052.8424; train_masked_gp_l1_reg_loss: 29195.0544; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10648690.5605; train_optim_loss: 10648690.5605; val_kl_reg_loss: 109524.8958; val_edge_recon_loss: 8862064.3125; val_gene_expr_recon_loss: 1870432.8177; val_masked_gp_l1_reg_loss: 29168.9824; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10871191.0000; val_optim_loss: 10871191.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8363; val_auprc_score: 0.9630; val_best_acc_score: 0.8882; val_best_f1_score: 0.9371; train_kl_reg_loss: 110012.9408; train_edge_recon_loss: 8524267.4977; train_gene_expr_recon_loss: 1869463.7378; train_masked_gp_l1_reg_loss: 29143.8493; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10532887.9907; train_optim_loss: 10532887.9907; val_kl_reg_loss: 109069.7673; val_edge_recon_loss: 8843430.3333; val_gene_expr_recon_loss: 1816213.9167; val_masked_gp_l1_reg_loss: 29112.4316; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10797826.0000; val_optim_loss: 10797826.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8310; val_auprc_score: 0.9635; val_best_acc_score: 0.8870; val_best_f1_score: 0.9369; train_kl_reg_loss: 109187.0904; train_edge_recon_loss: 8472454.0279; train_gene_expr_recon_loss: 1808636.7471; train_masked_gp_l1_reg_loss: 29063.3236; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10419341.2279; train_optim_loss: 10419341.2279; val_kl_reg_loss: 107651.6462; val_edge_recon_loss: 8739659.1042; val_gene_expr_recon_loss: 1785560.7865; val_masked_gp_l1_reg_loss: 29007.3008; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10661878.5000; val_optim_loss: 10661878.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8425; val_auprc_score: 0.9659; val_best_acc_score: 0.8920; val_best_f1_score: 0.9398; train_kl_reg_loss: 108531.6754; train_edge_recon_loss: 8644460.8721; train_gene_expr_recon_loss: 1754085.5459; train_masked_gp_l1_reg_loss: 28949.4058; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10536027.4814; train_optim_loss: 10536027.4814; val_kl_reg_loss: 107532.4118; val_edge_recon_loss: 8481496.1250; val_gene_expr_recon_loss: 1730134.1250; val_masked_gp_l1_reg_loss: 28879.0469; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10348041.7917; val_optim_loss: 10348041.7917
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8303; val_auprc_score: 0.9618; val_best_acc_score: 0.8843; val_best_f1_score: 0.9354; train_kl_reg_loss: 107752.0109; train_edge_recon_loss: 8561694.2488; train_gene_expr_recon_loss: 1700114.5564; train_masked_gp_l1_reg_loss: 28802.5744; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10398363.3372; train_optim_loss: 10398363.3372; val_kl_reg_loss: 105909.3252; val_edge_recon_loss: 9097379.6875; val_gene_expr_recon_loss: 1656284.8281; val_masked_gp_l1_reg_loss: 28728.3242; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10888301.9583; val_optim_loss: 10888301.9583
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8385; val_auprc_score: 0.9642; val_best_acc_score: 0.8849; val_best_f1_score: 0.9358; train_kl_reg_loss: 106947.1962; train_edge_recon_loss: 8581023.5326; train_gene_expr_recon_loss: 1651998.6587; train_masked_gp_l1_reg_loss: 28641.4925; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10368610.8930; train_optim_loss: 10368610.8930; val_kl_reg_loss: 105532.5928; val_edge_recon_loss: 8861879.6458; val_gene_expr_recon_loss: 1637032.9740; val_masked_gp_l1_reg_loss: 28547.0938; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10632992.2083; val_optim_loss: 10632992.2083
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8384; val_auprc_score: 0.9650; val_best_acc_score: 0.8887; val_best_f1_score: 0.9380; train_kl_reg_loss: 106101.0781; train_edge_recon_loss: 8685678.6442; train_gene_expr_recon_loss: 1608924.8337; train_masked_gp_l1_reg_loss: 28443.2667; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10429147.7791; train_optim_loss: 10429147.7791; val_kl_reg_loss: 105107.5221; val_edge_recon_loss: 8709522.2917; val_gene_expr_recon_loss: 1569752.1302; val_masked_gp_l1_reg_loss: 28340.5078; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10412722.9583; val_optim_loss: 10412722.9583
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8404; val_auprc_score: 0.9654; val_best_acc_score: 0.8904; val_best_f1_score: 0.9386; train_kl_reg_loss: 105229.3322; train_edge_recon_loss: 8609620.0442; train_gene_expr_recon_loss: 1565954.4157; train_masked_gp_l1_reg_loss: 28234.1916; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10309037.9907; train_optim_loss: 10309037.9907; val_kl_reg_loss: 103869.8773; val_edge_recon_loss: 8682248.0000; val_gene_expr_recon_loss: 1537898.2969; val_masked_gp_l1_reg_loss: 28116.8672; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10352133.2500; val_optim_loss: 10352133.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8385; val_auprc_score: 0.9643; val_best_acc_score: 0.8866; val_best_f1_score: 0.9363; train_kl_reg_loss: 104867.2872; train_edge_recon_loss: 8605516.5791; train_gene_expr_recon_loss: 1538186.6919; train_masked_gp_l1_reg_loss: 28104.9594; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10276675.4814; train_optim_loss: 10276675.4814; val_kl_reg_loss: 103828.6810; val_edge_recon_loss: 8876364.6875; val_gene_expr_recon_loss: 1532008.8594; val_masked_gp_l1_reg_loss: 28094.5078; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10540297.2917; val_optim_loss: 10540297.2917
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8398; val_auprc_score: 0.9646; val_best_acc_score: 0.8883; val_best_f1_score: 0.9375; train_kl_reg_loss: 104748.2318; train_edge_recon_loss: 8523190.9116; train_gene_expr_recon_loss: 1537205.0930; train_masked_gp_l1_reg_loss: 28082.2569; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10193226.4907; train_optim_loss: 10193226.4907; val_kl_reg_loss: 103717.5062; val_edge_recon_loss: 8759876.4583; val_gene_expr_recon_loss: 1524338.2865; val_masked_gp_l1_reg_loss: 28070.2324; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10416002.2917; val_optim_loss: 10416002.2917
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8340; val_auprc_score: 0.9624; val_best_acc_score: 0.8879; val_best_f1_score: 0.9372; train_kl_reg_loss: 104668.1883; train_edge_recon_loss: 8522582.4814; train_gene_expr_recon_loss: 1531945.7442; train_masked_gp_l1_reg_loss: 28057.9288; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10187254.3953; train_optim_loss: 10187254.3953; val_kl_reg_loss: 104063.2770; val_edge_recon_loss: 8804071.9375; val_gene_expr_recon_loss: 1530524.2812; val_masked_gp_l1_reg_loss: 28044.5742; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10466704.4583; val_optim_loss: 10466704.4583
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8332; val_auprc_score: 0.9629; val_best_acc_score: 0.8875; val_best_f1_score: 0.9370; train_kl_reg_loss: 104787.7567; train_edge_recon_loss: 8581912.4349; train_gene_expr_recon_loss: 1528155.5953; train_masked_gp_l1_reg_loss: 28030.0261; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10242885.8628; train_optim_loss: 10242885.8628; val_kl_reg_loss: 103541.8242; val_edge_recon_loss: 8843734.6042; val_gene_expr_recon_loss: 1517224.0312; val_masked_gp_l1_reg_loss: 28015.0684; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10492515.4583; val_optim_loss: 10492515.4583

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 26 min 26 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.8301
Val AUPRC score: 0.9627
Val best accuracy score: 0.8878
Val best F1 score: 0.9373
Val gene expr MSE score: 6532.8195
Val cat covariate0 mean sim diff: -0.0061

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
