[True]
Run timestamp: 10082023_230901_92.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_92']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7717; val_auprc_score: 0.7862; val_best_acc_score: 0.5078; val_best_f1_score: 0.6700; train_kl_reg_loss: 151615.4801; train_edge_recon_loss: 3751439.8569; train_gene_expr_recon_loss: 44265645.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6813941.9351; train_global_loss: 54982643.0840; train_optim_loss: 54982643.0840; val_kl_reg_loss: 309549.8458; val_edge_recon_loss: 4064603.3000; val_gene_expr_recon_loss: 38157123.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6422844.8333; val_global_loss: 48954121.6000; val_optim_loss: 48954121.6000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7877; val_auprc_score: 0.7898; val_best_acc_score: 0.6893; val_best_f1_score: 0.7378; train_kl_reg_loss: 236592.6552; train_edge_recon_loss: 3612999.9332; train_gene_expr_recon_loss: 37606846.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6419101.4275; train_global_loss: 47875540.1832; train_optim_loss: 47875540.1832; val_kl_reg_loss: 229914.5281; val_edge_recon_loss: 4045300.5500; val_gene_expr_recon_loss: 37203658.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6350402.1667; val_global_loss: 47829275.7333; val_optim_loss: 47829275.7333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8203; val_auprc_score: 0.8209; val_best_acc_score: 0.7214; val_best_f1_score: 0.7514; train_kl_reg_loss: 194569.8602; train_edge_recon_loss: 3568573.0992; train_gene_expr_recon_loss: 37006805.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6357779.9618; train_global_loss: 47127728.5496; train_optim_loss: 47127728.5496; val_kl_reg_loss: 166404.8979; val_edge_recon_loss: 3975197.8833; val_gene_expr_recon_loss: 36794050.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6317634.4333; val_global_loss: 47253287.7333; val_optim_loss: 47253287.7333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8377; val_auprc_score: 0.8425; val_best_acc_score: 0.7510; val_best_f1_score: 0.7604; train_kl_reg_loss: 162672.3847; train_edge_recon_loss: 3514900.1584; train_gene_expr_recon_loss: 36737713.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6327421.5954; train_global_loss: 46742707.6336; train_optim_loss: 46742707.6336; val_kl_reg_loss: 175665.1771; val_edge_recon_loss: 3725769.5333; val_gene_expr_recon_loss: 36367541.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6248709.4333; val_global_loss: 46517685.3333; val_optim_loss: 46517685.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8584; val_auprc_score: 0.8621; val_best_acc_score: 0.7695; val_best_f1_score: 0.7734; train_kl_reg_loss: 142158.5349; train_edge_recon_loss: 3343467.3607; train_gene_expr_recon_loss: 36425203.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6285526.4924; train_global_loss: 46196355.6641; train_optim_loss: 46196355.6641; val_kl_reg_loss: 141483.1349; val_edge_recon_loss: 3289268.9500; val_gene_expr_recon_loss: 36160102.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6216195.3000; val_global_loss: 45807049.3333; val_optim_loss: 45807049.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8577; val_auprc_score: 0.8586; val_best_acc_score: 0.7719; val_best_f1_score: 0.7694; train_kl_reg_loss: 152225.2471; train_edge_recon_loss: 3171473.3855; train_gene_expr_recon_loss: 36200935.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6261574.3473; train_global_loss: 45786208.2443; train_optim_loss: 45786208.2443; val_kl_reg_loss: 158672.7302; val_edge_recon_loss: 3165410.4000; val_gene_expr_recon_loss: 35937197.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6206575.1000; val_global_loss: 45467856.2667; val_optim_loss: 45467856.2667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9025; val_auprc_score: 0.8967; val_best_acc_score: 0.8204; val_best_f1_score: 0.8226; train_kl_reg_loss: 157377.4256; train_edge_recon_loss: 3072146.1317; train_gene_expr_recon_loss: 35967292.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6231248.0191; train_global_loss: 45428063.7252; train_optim_loss: 45428063.7252; val_kl_reg_loss: 152454.7198; val_edge_recon_loss: 3035081.5833; val_gene_expr_recon_loss: 35797972.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6163141.0000; val_global_loss: 45148649.0667; val_optim_loss: 45148649.0667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9267; val_auprc_score: 0.9133; val_best_acc_score: 0.8544; val_best_f1_score: 0.8620; train_kl_reg_loss: 158168.6868; train_edge_recon_loss: 2949415.2118; train_gene_expr_recon_loss: 35792113.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6208651.5573; train_global_loss: 45108348.5496; train_optim_loss: 45108348.5496; val_kl_reg_loss: 167031.2625; val_edge_recon_loss: 2906207.0500; val_gene_expr_recon_loss: 35625692.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6150225.7000; val_global_loss: 44849156.8000; val_optim_loss: 44849156.8000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9301; val_auprc_score: 0.9134; val_best_acc_score: 0.8636; val_best_f1_score: 0.8721; train_kl_reg_loss: 162549.3453; train_edge_recon_loss: 2892109.5248; train_gene_expr_recon_loss: 35632562.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6183565.8092; train_global_loss: 44870786.9313; train_optim_loss: 44870786.9313; val_kl_reg_loss: 160525.0656; val_edge_recon_loss: 2904773.1667; val_gene_expr_recon_loss: 35237269.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6078487.7667; val_global_loss: 44381055.7333; val_optim_loss: 44381055.7333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9338; val_auprc_score: 0.9171; val_best_acc_score: 0.8705; val_best_f1_score: 0.8760; train_kl_reg_loss: 159216.5681; train_edge_recon_loss: 2867653.0706; train_gene_expr_recon_loss: 35493425.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6163831.9198; train_global_loss: 44684126.9618; train_optim_loss: 44684126.9618; val_kl_reg_loss: 160852.3802; val_edge_recon_loss: 2864057.6333; val_gene_expr_recon_loss: 35357248.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6120615.9667; val_global_loss: 44502774.9333; val_optim_loss: 44502774.9333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9370; val_auprc_score: 0.9210; val_best_acc_score: 0.8733; val_best_f1_score: 0.8780; train_kl_reg_loss: 155131.9812; train_edge_recon_loss: 2858138.8569; train_gene_expr_recon_loss: 35374603.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6149539.2710; train_global_loss: 44537413.5878; train_optim_loss: 44537413.5878; val_kl_reg_loss: 150614.4552; val_edge_recon_loss: 2863936.0333; val_gene_expr_recon_loss: 35065234.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6083894.4333; val_global_loss: 44163679.2000; val_optim_loss: 44163679.2000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9381; val_auprc_score: 0.9262; val_best_acc_score: 0.8764; val_best_f1_score: 0.8808; train_kl_reg_loss: 148104.7137; train_edge_recon_loss: 2841067.2137; train_gene_expr_recon_loss: 35219216.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6128267.1756; train_global_loss: 44336655.3282; train_optim_loss: 44336655.3282; val_kl_reg_loss: 143779.5844; val_edge_recon_loss: 2860724.6000; val_gene_expr_recon_loss: 35126839.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6077406.3667; val_global_loss: 44208749.8667; val_optim_loss: 44208749.8667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9389; val_auprc_score: 0.9250; val_best_acc_score: 0.8793; val_best_f1_score: 0.8849; train_kl_reg_loss: 142944.8500; train_edge_recon_loss: 2838589.2233; train_gene_expr_recon_loss: 35126371.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6111779.2634; train_global_loss: 44219684.8244; train_optim_loss: 44219684.8244; val_kl_reg_loss: 141859.7990; val_edge_recon_loss: 2849059.5500; val_gene_expr_recon_loss: 34989305.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6083169.0000; val_global_loss: 44063393.3333; val_optim_loss: 44063393.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9391; val_auprc_score: 0.9227; val_best_acc_score: 0.8805; val_best_f1_score: 0.8857; train_kl_reg_loss: 137235.8404; train_edge_recon_loss: 2833727.5267; train_gene_expr_recon_loss: 35004939.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6098354.3550; train_global_loss: 44074257.0687; train_optim_loss: 44074257.0687; val_kl_reg_loss: 134539.3198; val_edge_recon_loss: 2850230.2333; val_gene_expr_recon_loss: 34822788.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6049777.1667; val_global_loss: 43857336.2667; val_optim_loss: 43857336.2667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9480; val_auprc_score: 0.9366; val_best_acc_score: 0.8857; val_best_f1_score: 0.8915; train_kl_reg_loss: 135352.2913; train_edge_recon_loss: 2813228.6698; train_gene_expr_recon_loss: 34901838.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6084698.1565; train_global_loss: 43935117.6794; train_optim_loss: 43935117.6794; val_kl_reg_loss: 134264.2208; val_edge_recon_loss: 2815302.5000; val_gene_expr_recon_loss: 34873156.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6049574.7333; val_global_loss: 43872296.8000; val_optim_loss: 43872296.8000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9473; val_auprc_score: 0.9339; val_best_acc_score: 0.8895; val_best_f1_score: 0.8955; train_kl_reg_loss: 130722.2300; train_edge_recon_loss: 2816871.2481; train_gene_expr_recon_loss: 34881925.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6084655.6756; train_global_loss: 43914174.5954; train_optim_loss: 43914174.5954; val_kl_reg_loss: 125487.5906; val_edge_recon_loss: 2819587.2833; val_gene_expr_recon_loss: 34601895.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6006365.1667; val_global_loss: 43553335.4667; val_optim_loss: 43553335.4667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9515; val_auprc_score: 0.9391; val_best_acc_score: 0.8925; val_best_f1_score: 0.8976; train_kl_reg_loss: 126874.0460; train_edge_recon_loss: 2808083.0210; train_gene_expr_recon_loss: 34801655.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6071937.4084; train_global_loss: 43808549.8931; train_optim_loss: 43808549.8931; val_kl_reg_loss: 124573.0250; val_edge_recon_loss: 2829820.4167; val_gene_expr_recon_loss: 34721807.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6049535.0667; val_global_loss: 43725735.7333; val_optim_loss: 43725735.7333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9557; val_auprc_score: 0.9463; val_best_acc_score: 0.8995; val_best_f1_score: 0.9040; train_kl_reg_loss: 123548.0753; train_edge_recon_loss: 2793804.9141; train_gene_expr_recon_loss: 34680571.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6061279.7557; train_global_loss: 43659204.6107; train_optim_loss: 43659204.6107; val_kl_reg_loss: 123240.8396; val_edge_recon_loss: 2791651.0833; val_gene_expr_recon_loss: 34547214.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6023663.3667; val_global_loss: 43485769.3333; val_optim_loss: 43485769.3333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9502; val_auprc_score: 0.9374; val_best_acc_score: 0.8941; val_best_f1_score: 0.9002; train_kl_reg_loss: 121078.6471; train_edge_recon_loss: 2782315.7977; train_gene_expr_recon_loss: 34615992.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6053036.5076; train_global_loss: 43572423.6336; train_optim_loss: 43572423.6336; val_kl_reg_loss: 119305.7828; val_edge_recon_loss: 2819428.5500; val_gene_expr_recon_loss: 34427659.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6002507.1667; val_global_loss: 43368900.8000; val_optim_loss: 43368900.8000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9591; val_auprc_score: 0.9496; val_best_acc_score: 0.9045; val_best_f1_score: 0.9078; train_kl_reg_loss: 117941.0625; train_edge_recon_loss: 2777920.9275; train_gene_expr_recon_loss: 34533040.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6043947.9733; train_global_loss: 43472849.9847; train_optim_loss: 43472849.9847; val_kl_reg_loss: 116838.0641; val_edge_recon_loss: 2787714.3833; val_gene_expr_recon_loss: 34536686.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6037191.6333; val_global_loss: 43478430.1333; val_optim_loss: 43478430.1333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9602; val_auprc_score: 0.9523; val_best_acc_score: 0.9062; val_best_f1_score: 0.9103; train_kl_reg_loss: 115890.9201; train_edge_recon_loss: 2772677.2615; train_gene_expr_recon_loss: 34459966.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6032804.1145; train_global_loss: 43381339.2672; train_optim_loss: 43381339.2672; val_kl_reg_loss: 114927.8979; val_edge_recon_loss: 2780259.1333; val_gene_expr_recon_loss: 34426546.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6022178.0333; val_global_loss: 43343911.7333; val_optim_loss: 43343911.7333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9623; val_auprc_score: 0.9523; val_best_acc_score: 0.9099; val_best_f1_score: 0.9129; train_kl_reg_loss: 114670.7479; train_edge_recon_loss: 2762218.8378; train_gene_expr_recon_loss: 34394055.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6027761.9122; train_global_loss: 43298706.8702; train_optim_loss: 43298706.8702; val_kl_reg_loss: 115114.7125; val_edge_recon_loss: 2767976.4667; val_gene_expr_recon_loss: 34408497.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6001511.4333; val_global_loss: 43293100.5333; val_optim_loss: 43293100.5333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9644; val_auprc_score: 0.9567; val_best_acc_score: 0.9101; val_best_f1_score: 0.9141; train_kl_reg_loss: 112565.4965; train_edge_recon_loss: 2756279.0916; train_gene_expr_recon_loss: 34373845.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6028840.6221; train_global_loss: 43271530.6565; train_optim_loss: 43271530.6565; val_kl_reg_loss: 110047.8880; val_edge_recon_loss: 2770400.5833; val_gene_expr_recon_loss: 34269680.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5998396.6333; val_global_loss: 43148525.0667; val_optim_loss: 43148525.0667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9674; val_auprc_score: 0.9597; val_best_acc_score: 0.9155; val_best_f1_score: 0.9198; train_kl_reg_loss: 110662.1662; train_edge_recon_loss: 2749604.2328; train_gene_expr_recon_loss: 34251366.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6010814.4351; train_global_loss: 43122447.0229; train_optim_loss: 43122447.0229; val_kl_reg_loss: 107201.1755; val_edge_recon_loss: 2744769.3667; val_gene_expr_recon_loss: 34265970.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5982685.9333; val_global_loss: 43100626.4000; val_optim_loss: 43100626.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9685; val_auprc_score: 0.9602; val_best_acc_score: 0.9185; val_best_f1_score: 0.9210; train_kl_reg_loss: 108044.4572; train_edge_recon_loss: 2736211.0286; train_gene_expr_recon_loss: 34237880.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6015606.1832; train_global_loss: 43097742.1069; train_optim_loss: 43097742.1069; val_kl_reg_loss: 108427.9177; val_edge_recon_loss: 2733041.1333; val_gene_expr_recon_loss: 34285690.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6002295.6333; val_global_loss: 43129455.4667; val_optim_loss: 43129455.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9666; val_auprc_score: 0.9592; val_best_acc_score: 0.9155; val_best_f1_score: 0.9189; train_kl_reg_loss: 112477.3625; train_edge_recon_loss: 2779970.6279; train_gene_expr_recon_loss: 35253040.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6183554.8092; train_global_loss: 44329043.5420; train_optim_loss: 44329043.5420; val_kl_reg_loss: 66322.8490; val_edge_recon_loss: 2773138.3000; val_gene_expr_recon_loss: 35181239.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6085280.3333; val_global_loss: 44105980.8000; val_optim_loss: 44105980.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9702; val_auprc_score: 0.9637; val_best_acc_score: 0.9175; val_best_f1_score: 0.9198; train_kl_reg_loss: 111905.8064; train_edge_recon_loss: 2754939.5897; train_gene_expr_recon_loss: 35287713.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6130191.6985; train_global_loss: 44284750.5649; train_optim_loss: 44284750.5649; val_kl_reg_loss: 67858.5427; val_edge_recon_loss: 2758553.0167; val_gene_expr_recon_loss: 35160476.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6066634.2667; val_global_loss: 44053522.6667; val_optim_loss: 44053522.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9660; val_auprc_score: 0.9563; val_best_acc_score: 0.9146; val_best_f1_score: 0.9183; train_kl_reg_loss: 108134.7025; train_edge_recon_loss: 2743220.0134; train_gene_expr_recon_loss: 35277007.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6106747.5992; train_global_loss: 44235109.4962; train_optim_loss: 44235109.4962; val_kl_reg_loss: 69256.7656; val_edge_recon_loss: 2758418.4667; val_gene_expr_recon_loss: 35248080.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6078060.8000; val_global_loss: 44153817.0667; val_optim_loss: 44153817.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9683; val_auprc_score: 0.9594; val_best_acc_score: 0.9166; val_best_f1_score: 0.9205; train_kl_reg_loss: 106856.5233; train_edge_recon_loss: 2753278.1641; train_gene_expr_recon_loss: 35249447.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6104291.2939; train_global_loss: 44213872.7634; train_optim_loss: 44213872.7634; val_kl_reg_loss: 71167.8057; val_edge_recon_loss: 2770785.9000; val_gene_expr_recon_loss: 35105636.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6047152.9333; val_global_loss: 43994742.9333; val_optim_loss: 43994742.9333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9677; val_auprc_score: 0.9583; val_best_acc_score: 0.9162; val_best_f1_score: 0.9202; train_kl_reg_loss: 107630.7109; train_edge_recon_loss: 2741695.6202; train_gene_expr_recon_loss: 35227343.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6097591.0229; train_global_loss: 44174260.8550; train_optim_loss: 44174260.8550; val_kl_reg_loss: 70837.3031; val_edge_recon_loss: 2770624.0833; val_gene_expr_recon_loss: 35250503.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6072693.2667; val_global_loss: 44164658.9333; val_optim_loss: 44164658.9333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9709; val_auprc_score: 0.9622; val_best_acc_score: 0.9233; val_best_f1_score: 0.9255; train_kl_reg_loss: 107100.8610; train_edge_recon_loss: 2737071.4218; train_gene_expr_recon_loss: 35192059.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6090002.0458; train_global_loss: 44126234.2290; train_optim_loss: 44126234.2290; val_kl_reg_loss: 71709.4599; val_edge_recon_loss: 2736943.5667; val_gene_expr_recon_loss: 35141258.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6065622.3667; val_global_loss: 44015534.1333; val_optim_loss: 44015534.1333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9692; val_auprc_score: 0.9602; val_best_acc_score: 0.9216; val_best_f1_score: 0.9243; train_kl_reg_loss: 107001.6486; train_edge_recon_loss: 2737917.3626; train_gene_expr_recon_loss: 35232786.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6105346.2290; train_global_loss: 44183051.5420; train_optim_loss: 44183051.5420; val_kl_reg_loss: 72221.3604; val_edge_recon_loss: 2750349.6333; val_gene_expr_recon_loss: 35155137.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6062521.3333; val_global_loss: 44040230.6667; val_optim_loss: 44040230.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 11 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9684
val AUPRC score: 0.9611
val best accuracy score: 0.9166
val best F1 score: 0.9188
val target rna MSE score: 1.0974
val source rna MSE score: 29.0485
val target atac MSE score: 0.5474
val source atac MSE score: 6.1678
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
