[True]
Run timestamp: 07082023_220127_148.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_148']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9666; val_auprc_score: 0.9686; val_best_acc_score: 0.8901; val_best_f1_score: 0.8836; train_kl_reg_loss: 2864.3349; train_edge_recon_loss: 3467497.8889; train_gene_expr_recon_loss: 627097.7778; train_masked_gp_l1_reg_loss: 8427.5430; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 265320.0677; train_global_loss: 4371207.5556; train_optim_loss: 4371207.5556; val_kl_reg_loss: 1121.1577; val_edge_recon_loss: 4029802.5000; val_gene_expr_recon_loss: 617331.3125; val_masked_gp_l1_reg_loss: 6063.4907; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 263882.9688; val_global_loss: 4918201.5000; val_optim_loss: 4918201.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9384; val_auprc_score: 0.9272; val_best_acc_score: 0.8713; val_best_f1_score: 0.8792; train_kl_reg_loss: 1203.8193; train_edge_recon_loss: 3451056.4167; train_gene_expr_recon_loss: 609608.9444; train_masked_gp_l1_reg_loss: 4935.0570; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 265673.8264; train_global_loss: 4332478.0556; train_optim_loss: 4332478.0556; val_kl_reg_loss: 1563.3350; val_edge_recon_loss: 3560832.7500; val_gene_expr_recon_loss: 592563.8125; val_masked_gp_l1_reg_loss: 4025.6943; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 262061.5000; val_global_loss: 4421047.0000; val_optim_loss: 4421047.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9181; val_auprc_score: 0.8973; val_best_acc_score: 0.8484; val_best_f1_score: 0.8588; train_kl_reg_loss: 5395.1308; train_edge_recon_loss: 3139848.4722; train_gene_expr_recon_loss: 583479.6667; train_masked_gp_l1_reg_loss: 3980.7789; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 263299.6667; train_global_loss: 3996003.6667; train_optim_loss: 3996003.6667; val_kl_reg_loss: 16022.3486; val_edge_recon_loss: 2769389.5000; val_gene_expr_recon_loss: 579507.0625; val_masked_gp_l1_reg_loss: 4012.8870; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 260469.1719; val_global_loss: 3629401.0000; val_optim_loss: 3629401.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9254; val_auprc_score: 0.9031; val_best_acc_score: 0.8665; val_best_f1_score: 0.8732; train_kl_reg_loss: 29443.1343; train_edge_recon_loss: 2749435.0000; train_gene_expr_recon_loss: 577004.1806; train_masked_gp_l1_reg_loss: 3899.9137; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 261704.5208; train_global_loss: 3621486.7778; train_optim_loss: 3621486.7778; val_kl_reg_loss: 38085.1406; val_edge_recon_loss: 2726838.2500; val_gene_expr_recon_loss: 569265.3750; val_masked_gp_l1_reg_loss: 3789.6912; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 258987.6406; val_global_loss: 3596966.5000; val_optim_loss: 3596966.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9232; val_auprc_score: 0.9011; val_best_acc_score: 0.8615; val_best_f1_score: 0.8701; train_kl_reg_loss: 39546.8320; train_edge_recon_loss: 2713841.2778; train_gene_expr_recon_loss: 562963.1458; train_masked_gp_l1_reg_loss: 3807.1982; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 259410.4410; train_global_loss: 3579568.9167; train_optim_loss: 3579568.9167; val_kl_reg_loss: 34794.6445; val_edge_recon_loss: 2757661.2500; val_gene_expr_recon_loss: 557225.5000; val_masked_gp_l1_reg_loss: 3862.6565; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 257508.2812; val_global_loss: 3611052.5000; val_optim_loss: 3611052.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9324; val_auprc_score: 0.9133; val_best_acc_score: 0.8705; val_best_f1_score: 0.8787; train_kl_reg_loss: 35031.6259; train_edge_recon_loss: 2712206.0833; train_gene_expr_recon_loss: 547189.0000; train_masked_gp_l1_reg_loss: 3933.3926; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 258806.0382; train_global_loss: 3557166.1667; train_optim_loss: 3557166.1667; val_kl_reg_loss: 31314.3652; val_edge_recon_loss: 2721610.2500; val_gene_expr_recon_loss: 541043.8750; val_masked_gp_l1_reg_loss: 4015.7729; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 256009.0625; val_global_loss: 3553993.2500; val_optim_loss: 3553993.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9400; val_auprc_score: 0.9169; val_best_acc_score: 0.8832; val_best_f1_score: 0.8897; train_kl_reg_loss: 32986.9718; train_edge_recon_loss: 2705221.4444; train_gene_expr_recon_loss: 534583.4167; train_masked_gp_l1_reg_loss: 4098.9003; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256859.6493; train_global_loss: 3533750.3889; train_optim_loss: 3533750.3889; val_kl_reg_loss: 31602.6602; val_edge_recon_loss: 2681812.0000; val_gene_expr_recon_loss: 532995.0000; val_masked_gp_l1_reg_loss: 4194.0127; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 254796.5781; val_global_loss: 3505400.2500; val_optim_loss: 3505400.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9364; val_auprc_score: 0.9147; val_best_acc_score: 0.8791; val_best_f1_score: 0.8855; train_kl_reg_loss: 33082.5243; train_edge_recon_loss: 2710875.4444; train_gene_expr_recon_loss: 530015.8958; train_masked_gp_l1_reg_loss: 4260.7742; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256178.4115; train_global_loss: 3534413.0278; train_optim_loss: 3534413.0278; val_kl_reg_loss: 29670.6758; val_edge_recon_loss: 2707818.2500; val_gene_expr_recon_loss: 523752.3750; val_masked_gp_l1_reg_loss: 4363.7812; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253734.3281; val_global_loss: 3519339.5000; val_optim_loss: 3519339.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9392; val_auprc_score: 0.9201; val_best_acc_score: 0.8795; val_best_f1_score: 0.8863; train_kl_reg_loss: 30739.9186; train_edge_recon_loss: 2706333.5000; train_gene_expr_recon_loss: 519523.5694; train_masked_gp_l1_reg_loss: 4464.2458; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 254173.8819; train_global_loss: 3515235.1111; train_optim_loss: 3515235.1111; val_kl_reg_loss: 29052.2852; val_edge_recon_loss: 2719626.7500; val_gene_expr_recon_loss: 520332.6562; val_masked_gp_l1_reg_loss: 4572.0796; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252870.6094; val_global_loss: 3526454.2500; val_optim_loss: 3526454.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9465; val_auprc_score: 0.9315; val_best_acc_score: 0.8884; val_best_f1_score: 0.8954; train_kl_reg_loss: 29965.3902; train_edge_recon_loss: 2714582.4444; train_gene_expr_recon_loss: 514799.5208; train_masked_gp_l1_reg_loss: 4656.6170; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 254907.6736; train_global_loss: 3518911.6389; train_optim_loss: 3518911.6389; val_kl_reg_loss: 27827.0625; val_edge_recon_loss: 2703958.5000; val_gene_expr_recon_loss: 510136.1250; val_masked_gp_l1_reg_loss: 4764.0732; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251815.5938; val_global_loss: 3498501.0000; val_optim_loss: 3498501.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9465; val_auprc_score: 0.9253; val_best_acc_score: 0.8898; val_best_f1_score: 0.8950; train_kl_reg_loss: 28792.1879; train_edge_recon_loss: 2703103.3889; train_gene_expr_recon_loss: 506348.0694; train_masked_gp_l1_reg_loss: 4858.7737; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252986.8403; train_global_loss: 3496089.2222; train_optim_loss: 3496089.2222; val_kl_reg_loss: 26285.5273; val_edge_recon_loss: 2722931.0000; val_gene_expr_recon_loss: 502280.4688; val_masked_gp_l1_reg_loss: 4960.6255; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250965.1406; val_global_loss: 3507423.0000; val_optim_loss: 3507423.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9509; val_auprc_score: 0.9348; val_best_acc_score: 0.8934; val_best_f1_score: 0.8973; train_kl_reg_loss: 27593.6621; train_edge_recon_loss: 2691635.1667; train_gene_expr_recon_loss: 507025.7778; train_masked_gp_l1_reg_loss: 5038.3091; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252977.2014; train_global_loss: 3484270.0278; train_optim_loss: 3484270.0278; val_kl_reg_loss: 27901.7383; val_edge_recon_loss: 2702108.5000; val_gene_expr_recon_loss: 500442.8750; val_masked_gp_l1_reg_loss: 5120.4453; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250375.8750; val_global_loss: 3485949.5000; val_optim_loss: 3485949.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9541; val_auprc_score: 0.9371; val_best_acc_score: 0.8977; val_best_f1_score: 0.9032; train_kl_reg_loss: 29357.7808; train_edge_recon_loss: 2674687.9444; train_gene_expr_recon_loss: 498122.9549; train_masked_gp_l1_reg_loss: 5190.2012; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251406.1389; train_global_loss: 3458765.1111; train_optim_loss: 3458765.1111; val_kl_reg_loss: 26250.8730; val_edge_recon_loss: 2692593.2500; val_gene_expr_recon_loss: 505829.0938; val_masked_gp_l1_reg_loss: 5250.7920; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250355.9062; val_global_loss: 3480279.7500; val_optim_loss: 3480279.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9571; val_auprc_score: 0.9430; val_best_acc_score: 0.9047; val_best_f1_score: 0.9089; train_kl_reg_loss: 27088.6671; train_edge_recon_loss: 2672794.5000; train_gene_expr_recon_loss: 496513.7326; train_masked_gp_l1_reg_loss: 5306.1823; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251682.3194; train_global_loss: 3453385.4167; train_optim_loss: 3453385.4167; val_kl_reg_loss: 28394.4980; val_edge_recon_loss: 2678243.0000; val_gene_expr_recon_loss: 498045.5000; val_masked_gp_l1_reg_loss: 5368.1094; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249395.0000; val_global_loss: 3459446.0000; val_optim_loss: 3459446.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9625; val_auprc_score: 0.9490; val_best_acc_score: 0.9069; val_best_f1_score: 0.9104; train_kl_reg_loss: 28588.0030; train_edge_recon_loss: 2669587.5000; train_gene_expr_recon_loss: 492062.7292; train_masked_gp_l1_reg_loss: 5421.8646; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250341.9757; train_global_loss: 3446002.1111; train_optim_loss: 3446002.1111; val_kl_reg_loss: 27168.1426; val_edge_recon_loss: 2665615.0000; val_gene_expr_recon_loss: 491720.9375; val_masked_gp_l1_reg_loss: 5473.2129; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248508.0781; val_global_loss: 3438485.5000; val_optim_loss: 3438485.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9607; val_auprc_score: 0.9444; val_best_acc_score: 0.9111; val_best_f1_score: 0.9144; train_kl_reg_loss: 27634.2941; train_edge_recon_loss: 2643286.9722; train_gene_expr_recon_loss: 489370.4201; train_masked_gp_l1_reg_loss: 5520.9356; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249164.8021; train_global_loss: 3414977.5000; train_optim_loss: 3414977.5000; val_kl_reg_loss: 28371.4336; val_edge_recon_loss: 2659385.5000; val_gene_expr_recon_loss: 492695.1250; val_masked_gp_l1_reg_loss: 5574.0015; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248126.3438; val_global_loss: 3434152.2500; val_optim_loss: 3434152.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9632; val_auprc_score: 0.9504; val_best_acc_score: 0.9151; val_best_f1_score: 0.9181; train_kl_reg_loss: 28829.4727; train_edge_recon_loss: 2650551.3889; train_gene_expr_recon_loss: 487194.8125; train_masked_gp_l1_reg_loss: 5621.0718; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249445.7604; train_global_loss: 3421642.5278; train_optim_loss: 3421642.5278; val_kl_reg_loss: 25920.7227; val_edge_recon_loss: 2667393.0000; val_gene_expr_recon_loss: 487650.3125; val_masked_gp_l1_reg_loss: 5675.2729; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247322.4062; val_global_loss: 3433961.7500; val_optim_loss: 3433961.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9672; val_auprc_score: 0.9558; val_best_acc_score: 0.9188; val_best_f1_score: 0.9222; train_kl_reg_loss: 27758.3878; train_edge_recon_loss: 2648179.7778; train_gene_expr_recon_loss: 480914.2326; train_masked_gp_l1_reg_loss: 5726.8353; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248467.7413; train_global_loss: 3411046.9444; train_optim_loss: 3411046.9444; val_kl_reg_loss: 27208.7676; val_edge_recon_loss: 2650843.2500; val_gene_expr_recon_loss: 486712.9375; val_masked_gp_l1_reg_loss: 5776.2256; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246855.2031; val_global_loss: 3417396.5000; val_optim_loss: 3417396.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9668; val_auprc_score: 0.9518; val_best_acc_score: 0.9209; val_best_f1_score: 0.9234; train_kl_reg_loss: 27838.9809; train_edge_recon_loss: 2645583.6667; train_gene_expr_recon_loss: 478524.9028; train_masked_gp_l1_reg_loss: 5810.7227; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246453.7639; train_global_loss: 3404212.1111; train_optim_loss: 3404212.1111; val_kl_reg_loss: 26753.5312; val_edge_recon_loss: 2673566.0000; val_gene_expr_recon_loss: 483572.7500; val_masked_gp_l1_reg_loss: 5851.4380; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246185.1562; val_global_loss: 3435929.0000; val_optim_loss: 3435929.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9743; val_auprc_score: 0.9665; val_best_acc_score: 0.9291; val_best_f1_score: 0.9313; train_kl_reg_loss: 28305.9690; train_edge_recon_loss: 2638642.6667; train_gene_expr_recon_loss: 477043.9792; train_masked_gp_l1_reg_loss: 5886.2819; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247314.3889; train_global_loss: 3397193.2778; train_optim_loss: 3397193.2778; val_kl_reg_loss: 26925.0078; val_edge_recon_loss: 2649778.5000; val_gene_expr_recon_loss: 482770.4375; val_masked_gp_l1_reg_loss: 5925.0781; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246110.3281; val_global_loss: 3411509.2500; val_optim_loss: 3411509.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9797; val_auprc_score: 0.9742; val_best_acc_score: 0.9363; val_best_f1_score: 0.9386; train_kl_reg_loss: 27563.3466; train_edge_recon_loss: 2638457.5833; train_gene_expr_recon_loss: 474836.4722; train_masked_gp_l1_reg_loss: 5958.6021; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247605.3715; train_global_loss: 3394421.3611; train_optim_loss: 3394421.3611; val_kl_reg_loss: 28167.6328; val_edge_recon_loss: 2611143.2500; val_gene_expr_recon_loss: 481999.3438; val_masked_gp_l1_reg_loss: 6003.6758; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245552.4688; val_global_loss: 3372866.5000; val_optim_loss: 3372866.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9757; val_auprc_score: 0.9674; val_best_acc_score: 0.9349; val_best_f1_score: 0.9370; train_kl_reg_loss: 29181.9256; train_edge_recon_loss: 2628696.9167; train_gene_expr_recon_loss: 473096.4444; train_masked_gp_l1_reg_loss: 6041.7253; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247550.7240; train_global_loss: 3384567.7222; train_optim_loss: 3384567.7222; val_kl_reg_loss: 28184.7227; val_edge_recon_loss: 2642829.5000; val_gene_expr_recon_loss: 480497.3750; val_masked_gp_l1_reg_loss: 6084.2603; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245209.1094; val_global_loss: 3402804.7500; val_optim_loss: 3402804.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9755; val_auprc_score: 0.9654; val_best_acc_score: 0.9312; val_best_f1_score: 0.9334; train_kl_reg_loss: 28947.7229; train_edge_recon_loss: 2627607.6667; train_gene_expr_recon_loss: 469821.6667; train_masked_gp_l1_reg_loss: 6125.2512; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245912.6910; train_global_loss: 3378415.0556; train_optim_loss: 3378415.0556; val_kl_reg_loss: 28669.8281; val_edge_recon_loss: 2644026.0000; val_gene_expr_recon_loss: 475135.8750; val_masked_gp_l1_reg_loss: 6161.7891; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244344.8438; val_global_loss: 3398338.0000; val_optim_loss: 3398338.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9760; val_auprc_score: 0.9658; val_best_acc_score: 0.9357; val_best_f1_score: 0.9382; train_kl_reg_loss: 29017.4529; train_edge_recon_loss: 2624731.7500; train_gene_expr_recon_loss: 468868.0035; train_masked_gp_l1_reg_loss: 6189.9940; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245088.3229; train_global_loss: 3373895.5278; train_optim_loss: 3373895.5278; val_kl_reg_loss: 27845.4531; val_edge_recon_loss: 2626929.5000; val_gene_expr_recon_loss: 474278.6250; val_masked_gp_l1_reg_loss: 6220.1035; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244154.4375; val_global_loss: 3379428.0000; val_optim_loss: 3379428.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9778; val_auprc_score: 0.9697; val_best_acc_score: 0.9364; val_best_f1_score: 0.9384; train_kl_reg_loss: 29179.1233; train_edge_recon_loss: 2626229.7778; train_gene_expr_recon_loss: 465588.9201; train_masked_gp_l1_reg_loss: 6253.2889; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245297.3819; train_global_loss: 3372548.5278; train_optim_loss: 3372548.5278; val_kl_reg_loss: 27827.7578; val_edge_recon_loss: 2629344.5000; val_gene_expr_recon_loss: 472292.9375; val_masked_gp_l1_reg_loss: 6289.9536; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243791.2188; val_global_loss: 3379546.5000; val_optim_loss: 3379546.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9796; val_auprc_score: 0.9740; val_best_acc_score: 0.9371; val_best_f1_score: 0.9389; train_kl_reg_loss: 28500.4722; train_edge_recon_loss: 2636932.6944; train_gene_expr_recon_loss: 480181.8958; train_masked_gp_l1_reg_loss: 6253.4518; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246187.1701; train_global_loss: 3398055.6667; train_optim_loss: 3398055.6667; val_kl_reg_loss: 15480.3359; val_edge_recon_loss: 2630803.0000; val_gene_expr_recon_loss: 498425.9688; val_masked_gp_l1_reg_loss: 6200.4106; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246726.5312; val_global_loss: 3397636.2500; val_optim_loss: 3397636.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9749; val_auprc_score: 0.9656; val_best_acc_score: 0.9334; val_best_f1_score: 0.9361; train_kl_reg_loss: 28232.4674; train_edge_recon_loss: 2626818.6667; train_gene_expr_recon_loss: 486768.8681; train_masked_gp_l1_reg_loss: 6177.3514; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246887.0781; train_global_loss: 3394884.4444; train_optim_loss: 3394884.4444; val_kl_reg_loss: 15635.1562; val_edge_recon_loss: 2638597.0000; val_gene_expr_recon_loss: 488923.7812; val_masked_gp_l1_reg_loss: 6152.2144; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245859.2812; val_global_loss: 3395167.5000; val_optim_loss: 3395167.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9791; val_auprc_score: 0.9723; val_best_acc_score: 0.9402; val_best_f1_score: 0.9419; train_kl_reg_loss: 28437.8817; train_edge_recon_loss: 2625544.4444; train_gene_expr_recon_loss: 479117.7674; train_masked_gp_l1_reg_loss: 6139.7565; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246122.2795; train_global_loss: 3385362.0833; train_optim_loss: 3385362.0833; val_kl_reg_loss: 15731.2207; val_edge_recon_loss: 2629526.2500; val_gene_expr_recon_loss: 490065.1875; val_masked_gp_l1_reg_loss: 6125.9922; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245947.2344; val_global_loss: 3387396.0000; val_optim_loss: 3387396.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9765; val_auprc_score: 0.9675; val_best_acc_score: 0.9330; val_best_f1_score: 0.9357; train_kl_reg_loss: 28449.0454; train_edge_recon_loss: 2621160.5278; train_gene_expr_recon_loss: 483020.4826; train_masked_gp_l1_reg_loss: 6117.8282; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246492.8455; train_global_loss: 3385240.6944; train_optim_loss: 3385240.6944; val_kl_reg_loss: 15434.5840; val_edge_recon_loss: 2653513.2500; val_gene_expr_recon_loss: 489937.5938; val_masked_gp_l1_reg_loss: 6109.6963; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245947.9531; val_global_loss: 3410943.0000; val_optim_loss: 3410943.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 55 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
val AUROC score: 0.9745
val AUPRC score: 0.9665
val best accuracy score: 0.9268
val best F1 score: 0.9300
val target rna MSE score: 0.4480
val source rna MSE score: 0.2609
val target atac MSE score: 0.1353
val source atac MSE score: 0.0216
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
