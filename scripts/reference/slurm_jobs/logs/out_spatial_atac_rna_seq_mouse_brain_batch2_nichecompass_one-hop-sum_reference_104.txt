[True]
Run timestamp: 10082023_234423_104.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_104']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6961; val_auprc_score: 0.7310; val_best_acc_score: 0.5085; val_best_f1_score: 0.6701; train_kl_reg_loss: 146188.2896; train_edge_recon_loss: 3843631.2004; train_gene_expr_recon_loss: 44655290.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6796936.8359; train_global_loss: 55442046.9618; train_optim_loss: 55442046.9618; val_kl_reg_loss: 80679.0672; val_edge_recon_loss: 4064826.7833; val_gene_expr_recon_loss: 39018036.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6594737.3000; val_global_loss: 49758278.4000; val_optim_loss: 49758278.4000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7301; val_auprc_score: 0.7599; val_best_acc_score: 0.5280; val_best_f1_score: 0.6777; train_kl_reg_loss: 123872.8267; train_edge_recon_loss: 3742853.7595; train_gene_expr_recon_loss: 39106532.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6461807.6718; train_global_loss: 49435066.8397; train_optim_loss: 49435066.8397; val_kl_reg_loss: 123615.9906; val_edge_recon_loss: 4063604.5167; val_gene_expr_recon_loss: 37695655.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6483859.9333; val_global_loss: 48366736.5333; val_optim_loss: 48366736.5333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7549; val_auprc_score: 0.7811; val_best_acc_score: 0.5391; val_best_f1_score: 0.6822; train_kl_reg_loss: 155069.8946; train_edge_recon_loss: 3611496.5744; train_gene_expr_recon_loss: 37542950.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6357950.3130; train_global_loss: 47667467.6641; train_optim_loss: 47667467.6641; val_kl_reg_loss: 157847.8510; val_edge_recon_loss: 4062929.6000; val_gene_expr_recon_loss: 36743045.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6423605.2333; val_global_loss: 47387428.2667; val_optim_loss: 47387428.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8300; val_auprc_score: 0.8428; val_best_acc_score: 0.6929; val_best_f1_score: 0.7465; train_kl_reg_loss: 157748.1848; train_edge_recon_loss: 3559799.9618; train_gene_expr_recon_loss: 36884252.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6298796.1298; train_global_loss: 46900597.3435; train_optim_loss: 46900597.3435; val_kl_reg_loss: 156124.6969; val_edge_recon_loss: 4051447.0667; val_gene_expr_recon_loss: 36212654.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6375763.5333; val_global_loss: 46795989.0667; val_optim_loss: 46795989.0667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8881; val_auprc_score: 0.8820; val_best_acc_score: 0.7920; val_best_f1_score: 0.7840; train_kl_reg_loss: 145981.3093; train_edge_recon_loss: 3541192.0573; train_gene_expr_recon_loss: 36536105.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6270839.7252; train_global_loss: 46494118.8092; train_optim_loss: 46494118.8092; val_kl_reg_loss: 137323.4573; val_edge_recon_loss: 3998970.8333; val_gene_expr_recon_loss: 35837406.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6339263.3333; val_global_loss: 46312963.7333; val_optim_loss: 46312963.7333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8971; val_auprc_score: 0.8860; val_best_acc_score: 0.8120; val_best_f1_score: 0.8297; train_kl_reg_loss: 129196.8705; train_edge_recon_loss: 3505709.8111; train_gene_expr_recon_loss: 36231879.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6230121.4618; train_global_loss: 46096907.4504; train_optim_loss: 46096907.4504; val_kl_reg_loss: 116925.2891; val_edge_recon_loss: 3693518.8667; val_gene_expr_recon_loss: 35666128.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6330008.4333; val_global_loss: 45806580.5333; val_optim_loss: 45806580.5333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8875; val_auprc_score: 0.8742; val_best_acc_score: 0.8106; val_best_f1_score: 0.8241; train_kl_reg_loss: 129085.2983; train_edge_recon_loss: 3191862.8492; train_gene_expr_recon_loss: 36055515.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6213935.8397; train_global_loss: 45590398.9618; train_optim_loss: 45590398.9618; val_kl_reg_loss: 157965.5396; val_edge_recon_loss: 3035465.8500; val_gene_expr_recon_loss: 35437532.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6277079.7333; val_global_loss: 44908042.9333; val_optim_loss: 44908042.9333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8991; val_auprc_score: 0.8884; val_best_acc_score: 0.8126; val_best_f1_score: 0.8247; train_kl_reg_loss: 159160.2968; train_edge_recon_loss: 2999598.8435; train_gene_expr_recon_loss: 35821829.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6187219.1565; train_global_loss: 45167808.0611; train_optim_loss: 45167808.0611; val_kl_reg_loss: 161558.8979; val_edge_recon_loss: 2973506.2667; val_gene_expr_recon_loss: 35421937.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6283741.9667; val_global_loss: 44840744.5333; val_optim_loss: 44840744.5333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9020; val_auprc_score: 0.8883; val_best_acc_score: 0.8216; val_best_f1_score: 0.8373; train_kl_reg_loss: 155647.5345; train_edge_recon_loss: 2969494.5038; train_gene_expr_recon_loss: 35595887.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6155112.4733; train_global_loss: 44876141.3435; train_optim_loss: 44876141.3435; val_kl_reg_loss: 149634.4354; val_edge_recon_loss: 2949576.1500; val_gene_expr_recon_loss: 35207942.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6266604.5667; val_global_loss: 44573757.8667; val_optim_loss: 44573757.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9164; val_auprc_score: 0.9049; val_best_acc_score: 0.8398; val_best_f1_score: 0.8518; train_kl_reg_loss: 149689.4538; train_edge_recon_loss: 2932539.6221; train_gene_expr_recon_loss: 35493592.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6143597.0305; train_global_loss: 44719418.4427; train_optim_loss: 44719418.4427; val_kl_reg_loss: 147013.9906; val_edge_recon_loss: 2923386.9833; val_gene_expr_recon_loss: 34912538.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6215385.6000; val_global_loss: 44198325.6000; val_optim_loss: 44198325.6000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9186; val_auprc_score: 0.9037; val_best_acc_score: 0.8420; val_best_f1_score: 0.8536; train_kl_reg_loss: 146980.5530; train_edge_recon_loss: 2902339.6889; train_gene_expr_recon_loss: 35376731.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6128405.2786; train_global_loss: 44554456.6718; train_optim_loss: 44554456.6718; val_kl_reg_loss: 151955.3969; val_edge_recon_loss: 2911578.5167; val_gene_expr_recon_loss: 34833976.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6205954.9333; val_global_loss: 44103465.6000; val_optim_loss: 44103465.6000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9182; val_auprc_score: 0.9031; val_best_acc_score: 0.8434; val_best_f1_score: 0.8546; train_kl_reg_loss: 147102.4220; train_edge_recon_loss: 2875135.9676; train_gene_expr_recon_loss: 35211151.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6109298.0496; train_global_loss: 44342688.4580; train_optim_loss: 44342688.4580; val_kl_reg_loss: 147233.2479; val_edge_recon_loss: 2903266.6167; val_gene_expr_recon_loss: 34812308.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6179660.9333; val_global_loss: 44042469.3333; val_optim_loss: 44042469.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9354; val_auprc_score: 0.9209; val_best_acc_score: 0.8676; val_best_f1_score: 0.8745; train_kl_reg_loss: 140192.8568; train_edge_recon_loss: 2863940.7328; train_gene_expr_recon_loss: 35116755.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6094133.9809; train_global_loss: 44215023.2672; train_optim_loss: 44215023.2672; val_kl_reg_loss: 134951.9411; val_edge_recon_loss: 2869559.4333; val_gene_expr_recon_loss: 34723222.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6171385.0000; val_global_loss: 43899119.2000; val_optim_loss: 43899119.2000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9385; val_auprc_score: 0.9281; val_best_acc_score: 0.8697; val_best_f1_score: 0.8764; train_kl_reg_loss: 139635.8647; train_edge_recon_loss: 2844286.1927; train_gene_expr_recon_loss: 35029694.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6084472.8740; train_global_loss: 44098089.2824; train_optim_loss: 44098089.2824; val_kl_reg_loss: 138068.4677; val_edge_recon_loss: 2836620.0000; val_gene_expr_recon_loss: 34650835.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6194755.2333; val_global_loss: 43820278.9333; val_optim_loss: 43820278.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9430; val_auprc_score: 0.9329; val_best_acc_score: 0.8739; val_best_f1_score: 0.8785; train_kl_reg_loss: 136004.4406; train_edge_recon_loss: 2830407.6450; train_gene_expr_recon_loss: 34950451.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6071579.5420; train_global_loss: 43988442.6565; train_optim_loss: 43988442.6565; val_kl_reg_loss: 134378.9224; val_edge_recon_loss: 2822018.3833; val_gene_expr_recon_loss: 34535653.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6163073.0333; val_global_loss: 43655123.7333; val_optim_loss: 43655123.7333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9481; val_auprc_score: 0.9382; val_best_acc_score: 0.8782; val_best_f1_score: 0.8837; train_kl_reg_loss: 132754.6713; train_edge_recon_loss: 2824856.0344; train_gene_expr_recon_loss: 34849654.9160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6061852.0382; train_global_loss: 43869117.7405; train_optim_loss: 43869117.7405; val_kl_reg_loss: 130465.1490; val_edge_recon_loss: 2812262.1833; val_gene_expr_recon_loss: 34465465.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6171337.2667; val_global_loss: 43579530.1333; val_optim_loss: 43579530.1333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9532; val_auprc_score: 0.9458; val_best_acc_score: 0.8841; val_best_f1_score: 0.8903; train_kl_reg_loss: 130503.3834; train_edge_recon_loss: 2805467.4542; train_gene_expr_recon_loss: 34797874.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6060708.8206; train_global_loss: 43794553.9542; train_optim_loss: 43794553.9542; val_kl_reg_loss: 129377.6391; val_edge_recon_loss: 2792471.3833; val_gene_expr_recon_loss: 34330800.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6153929.2667; val_global_loss: 43406578.9333; val_optim_loss: 43406578.9333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9515; val_auprc_score: 0.9413; val_best_acc_score: 0.8826; val_best_f1_score: 0.8890; train_kl_reg_loss: 126959.9943; train_edge_recon_loss: 2800365.1107; train_gene_expr_recon_loss: 34701944.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6042034.2328; train_global_loss: 43671303.8779; train_optim_loss: 43671303.8779; val_kl_reg_loss: 126353.9818; val_edge_recon_loss: 2789371.0833; val_gene_expr_recon_loss: 34283988.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6139889.8333; val_global_loss: 43339603.4667; val_optim_loss: 43339603.4667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9555; val_auprc_score: 0.9463; val_best_acc_score: 0.8897; val_best_f1_score: 0.8946; train_kl_reg_loss: 124912.5116; train_edge_recon_loss: 2792680.3626; train_gene_expr_recon_loss: 34688700.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6042313.6794; train_global_loss: 43648606.5649; train_optim_loss: 43648606.5649; val_kl_reg_loss: 123626.6089; val_edge_recon_loss: 2786171.8000; val_gene_expr_recon_loss: 34296562.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6122561.3667; val_global_loss: 43328921.8667; val_optim_loss: 43328921.8667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9550; val_auprc_score: 0.9456; val_best_acc_score: 0.8903; val_best_f1_score: 0.8960; train_kl_reg_loss: 122741.8539; train_edge_recon_loss: 2789278.1183; train_gene_expr_recon_loss: 34580587.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6032111.3168; train_global_loss: 43524718.3817; train_optim_loss: 43524718.3817; val_kl_reg_loss: 120796.6271; val_edge_recon_loss: 2793831.9167; val_gene_expr_recon_loss: 34189865.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6117170.2333; val_global_loss: 43221663.7333; val_optim_loss: 43221663.7333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9565; val_auprc_score: 0.9448; val_best_acc_score: 0.8954; val_best_f1_score: 0.8999; train_kl_reg_loss: 119816.6672; train_edge_recon_loss: 2774266.8531; train_gene_expr_recon_loss: 34563664.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6030817.2557; train_global_loss: 43488564.7939; train_optim_loss: 43488564.7939; val_kl_reg_loss: 119511.3906; val_edge_recon_loss: 2783779.1000; val_gene_expr_recon_loss: 34174058.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6130394.1000; val_global_loss: 43207744.0000; val_optim_loss: 43207744.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9637; val_auprc_score: 0.9562; val_best_acc_score: 0.9049; val_best_f1_score: 0.9076; train_kl_reg_loss: 118112.9493; train_edge_recon_loss: 2770246.2691; train_gene_expr_recon_loss: 34489927.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6018621.0458; train_global_loss: 43396907.6641; train_optim_loss: 43396907.6641; val_kl_reg_loss: 116204.9125; val_edge_recon_loss: 2750122.9333; val_gene_expr_recon_loss: 34061045.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6103233.1667; val_global_loss: 43030606.1333; val_optim_loss: 43030606.1333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9602; val_auprc_score: 0.9491; val_best_acc_score: 0.9003; val_best_f1_score: 0.9042; train_kl_reg_loss: 115471.9656; train_edge_recon_loss: 2766260.1679; train_gene_expr_recon_loss: 34421098.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6011179.7137; train_global_loss: 43314010.1374; train_optim_loss: 43314010.1374; val_kl_reg_loss: 116395.0542; val_edge_recon_loss: 2782864.2167; val_gene_expr_recon_loss: 34309716.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6155460.3333; val_global_loss: 43364434.9333; val_optim_loss: 43364434.9333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9629; val_auprc_score: 0.9551; val_best_acc_score: 0.9027; val_best_f1_score: 0.9067; train_kl_reg_loss: 113245.4634; train_edge_recon_loss: 2765967.1527; train_gene_expr_recon_loss: 34394224.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6008958.9924; train_global_loss: 43282396.2137; train_optim_loss: 43282396.2137; val_kl_reg_loss: 112903.6109; val_edge_recon_loss: 2783253.9833; val_gene_expr_recon_loss: 33937447.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6086242.9333; val_global_loss: 42919847.7333; val_optim_loss: 42919847.7333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9641; val_auprc_score: 0.9528; val_best_acc_score: 0.9053; val_best_f1_score: 0.9099; train_kl_reg_loss: 112135.6191; train_edge_recon_loss: 2755411.1851; train_gene_expr_recon_loss: 34344502.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6005554.9275; train_global_loss: 43217604.6718; train_optim_loss: 43217604.6718; val_kl_reg_loss: 111041.0505; val_edge_recon_loss: 2760918.8667; val_gene_expr_recon_loss: 34089535.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6106297.0667; val_global_loss: 43067792.5333; val_optim_loss: 43067792.5333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9600; val_auprc_score: 0.9485; val_best_acc_score: 0.8995; val_best_f1_score: 0.9044; train_kl_reg_loss: 122437.1217; train_edge_recon_loss: 2919659.7099; train_gene_expr_recon_loss: 37215867.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6266763.7595; train_global_loss: 46524727.7252; train_optim_loss: 46524727.7252; val_kl_reg_loss: 34089.8594; val_edge_recon_loss: 2865047.5500; val_gene_expr_recon_loss: 36514977.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6336816.8667; val_global_loss: 45750932.8000; val_optim_loss: 45750932.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9564; val_auprc_score: 0.9491; val_best_acc_score: 0.8917; val_best_f1_score: 0.8951; train_kl_reg_loss: 141054.7551; train_edge_recon_loss: 2912180.7099; train_gene_expr_recon_loss: 37660862.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6253078.3740; train_global_loss: 46967175.7557; train_optim_loss: 46967175.7557; val_kl_reg_loss: 29386.7160; val_edge_recon_loss: 2889126.4833; val_gene_expr_recon_loss: 37931121.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6364418.1667; val_global_loss: 47214052.5333; val_optim_loss: 47214052.5333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9344; val_auprc_score: 0.9213; val_best_acc_score: 0.8643; val_best_f1_score: 0.8739; train_kl_reg_loss: 160585.9030; train_edge_recon_loss: 3622716.2844; train_gene_expr_recon_loss: 38971172.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6281163.9351; train_global_loss: 49035638.1374; train_optim_loss: 49035638.1374; val_kl_reg_loss: 14805.3936; val_edge_recon_loss: 3580315.5667; val_gene_expr_recon_loss: 37989015.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6370397.7333; val_global_loss: 47954533.8667; val_optim_loss: 47954533.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9258; val_auprc_score: 0.9139; val_best_acc_score: 0.8477; val_best_f1_score: 0.8612; train_kl_reg_loss: 83541.6807; train_edge_recon_loss: 3494409.9828; train_gene_expr_recon_loss: 39019894.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6262809.0305; train_global_loss: 48860655.2672; train_optim_loss: 48860655.2672; val_kl_reg_loss: 13461.4082; val_edge_recon_loss: 3436618.8333; val_gene_expr_recon_loss: 38541852.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6383634.1667; val_global_loss: 48375566.9333; val_optim_loss: 48375566.9333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9161; val_auprc_score: 0.9025; val_best_acc_score: 0.8389; val_best_f1_score: 0.8516; train_kl_reg_loss: 84693.1609; train_edge_recon_loss: 3356011.3969; train_gene_expr_recon_loss: 39161804.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6267619.6985; train_global_loss: 48870128.8244; train_optim_loss: 48870128.8244; val_kl_reg_loss: 13298.1691; val_edge_recon_loss: 3259323.4833; val_gene_expr_recon_loss: 38958549.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6393666.5667; val_global_loss: 48624836.8000; val_optim_loss: 48624836.8000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8912; val_auprc_score: 0.8775; val_best_acc_score: 0.8094; val_best_f1_score: 0.8267; train_kl_reg_loss: 83262.6664; train_edge_recon_loss: 3184329.3206; train_gene_expr_recon_loss: 39645793.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6287524.8244; train_global_loss: 49200910.9313; train_optim_loss: 49200910.9313; val_kl_reg_loss: 12002.9119; val_edge_recon_loss: 3140730.8167; val_gene_expr_recon_loss: 39308834.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6437262.5667; val_global_loss: 48898830.4000; val_optim_loss: 48898830.4000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8920; val_auprc_score: 0.8814; val_best_acc_score: 0.8041; val_best_f1_score: 0.8234; train_kl_reg_loss: 81225.9390; train_edge_recon_loss: 3119391.7290; train_gene_expr_recon_loss: 39703226.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6295530.7939; train_global_loss: 49199374.9008; train_optim_loss: 49199374.9008; val_kl_reg_loss: 12146.6440; val_edge_recon_loss: 3107322.7333; val_gene_expr_recon_loss: 39228146.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6385766.5000; val_global_loss: 48733382.4000; val_optim_loss: 48733382.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 7 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9614
val AUPRC score: 0.9528
val best accuracy score: 0.9010
val best F1 score: 0.9063
val target rna MSE score: 1.5602
val source rna MSE score: 99.3374
val target atac MSE score: 0.6462
val source atac MSE score: 6.8282
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
