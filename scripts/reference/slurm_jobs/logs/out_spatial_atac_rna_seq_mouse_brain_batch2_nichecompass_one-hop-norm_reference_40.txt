[True]
Run timestamp: 07092023_154704_40.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_40']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3394 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7897, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6319; val_auprc_score: 0.6184; val_best_acc_score: 0.5140; val_best_f1_score: 0.6719; train_kl_reg_loss: 71431.4503; train_edge_recon_loss: 3577870.0076; train_gene_expr_recon_loss: 16561086.8636; train_masked_gp_l1_reg_loss: 82213.8594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1465453.7879; train_chrom_access_recon_loss: 14877372.4848; train_global_loss: 36635428.3939; train_optim_loss: 36635428.3939; val_kl_reg_loss: 87573.5225; val_edge_recon_loss: 4064738.8438; val_gene_expr_recon_loss: 15154973.2500; val_masked_gp_l1_reg_loss: 76092.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1115967.3750; val_chrom_access_recon_loss: 14539006.8750; val_global_loss: 35038352.0000; val_optim_loss: 35038352.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6358; val_auprc_score: 0.6202; val_best_acc_score: 0.5382; val_best_f1_score: 0.6803; train_kl_reg_loss: 121193.1151; train_edge_recon_loss: 3547724.8750; train_gene_expr_recon_loss: 14875115.1970; train_masked_gp_l1_reg_loss: 71359.7972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 821258.0142; train_chrom_access_recon_loss: 14138649.6061; train_global_loss: 33575300.5455; train_optim_loss: 33575300.5455; val_kl_reg_loss: 136094.3633; val_edge_recon_loss: 4063402.3125; val_gene_expr_recon_loss: 14655529.7500; val_masked_gp_l1_reg_loss: 68810.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 574876.3750; val_chrom_access_recon_loss: 14165664.6250; val_global_loss: 33664376.7500; val_optim_loss: 33664376.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6549; val_auprc_score: 0.6430; val_best_acc_score: 0.5664; val_best_f1_score: 0.6841; train_kl_reg_loss: 118096.5617; train_edge_recon_loss: 3529408.5379; train_gene_expr_recon_loss: 14642957.6667; train_masked_gp_l1_reg_loss: 68111.9663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 434103.0308; train_chrom_access_recon_loss: 14006021.5909; train_global_loss: 32798699.3636; train_optim_loss: 32798699.3636; val_kl_reg_loss: 126055.5010; val_edge_recon_loss: 4060958.7500; val_gene_expr_recon_loss: 14688707.2500; val_masked_gp_l1_reg_loss: 67915.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 324018.6875; val_chrom_access_recon_loss: 14296252.2500; val_global_loss: 33563907.2500; val_optim_loss: 33563907.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7183; val_auprc_score: 0.7085; val_best_acc_score: 0.6556; val_best_f1_score: 0.6961; train_kl_reg_loss: 108276.3414; train_edge_recon_loss: 3523675.0455; train_gene_expr_recon_loss: 14516922.2879; train_masked_gp_l1_reg_loss: 68675.0504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 260444.4112; train_chrom_access_recon_loss: 13920528.8182; train_global_loss: 32398521.7273; train_optim_loss: 32398521.7273; val_kl_reg_loss: 103547.8477; val_edge_recon_loss: 4017545.5625; val_gene_expr_recon_loss: 14431265.1250; val_masked_gp_l1_reg_loss: 70056.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 209103.7656; val_chrom_access_recon_loss: 14125918.6250; val_global_loss: 32957437.0000; val_optim_loss: 32957437.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8053; val_auprc_score: 0.7884; val_best_acc_score: 0.7179; val_best_f1_score: 0.7585; train_kl_reg_loss: 94418.9513; train_edge_recon_loss: 3483117.6098; train_gene_expr_recon_loss: 14426445.9545; train_masked_gp_l1_reg_loss: 72134.1450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176603.3106; train_chrom_access_recon_loss: 13827595.6970; train_global_loss: 32080315.7273; train_optim_loss: 32080315.7273; val_kl_reg_loss: 93597.7383; val_edge_recon_loss: 3658583.0312; val_gene_expr_recon_loss: 14380010.5000; val_masked_gp_l1_reg_loss: 74628.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149203.4688; val_chrom_access_recon_loss: 13862544.8750; val_global_loss: 32218568.0000; val_optim_loss: 32218568.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8204; val_auprc_score: 0.7940; val_best_acc_score: 0.7477; val_best_f1_score: 0.7860; train_kl_reg_loss: 94356.7604; train_edge_recon_loss: 3235146.4053; train_gene_expr_recon_loss: 14353994.9242; train_masked_gp_l1_reg_loss: 77566.4487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131484.9003; train_chrom_access_recon_loss: 13771373.0909; train_global_loss: 31663922.5455; train_optim_loss: 31663922.5455; val_kl_reg_loss: 113386.6748; val_edge_recon_loss: 3115721.9688; val_gene_expr_recon_loss: 14386916.7500; val_masked_gp_l1_reg_loss: 80119.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116283.7422; val_chrom_access_recon_loss: 13896825.8750; val_global_loss: 31709255.5000; val_optim_loss: 31709255.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8502; val_auprc_score: 0.8181; val_best_acc_score: 0.7730; val_best_f1_score: 0.7901; train_kl_reg_loss: 115502.1341; train_edge_recon_loss: 3034360.0568; train_gene_expr_recon_loss: 14262868.8333; train_masked_gp_l1_reg_loss: 82600.1655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105586.5524; train_chrom_access_recon_loss: 13690264.5758; train_global_loss: 31291182.3333; train_optim_loss: 31291182.3333; val_kl_reg_loss: 123374.5723; val_edge_recon_loss: 2984163.7812; val_gene_expr_recon_loss: 14195790.5000; val_masked_gp_l1_reg_loss: 84495.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95272.5625; val_chrom_access_recon_loss: 13771528.5000; val_global_loss: 31254625.7500; val_optim_loss: 31254625.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8454; val_auprc_score: 0.8062; val_best_acc_score: 0.7692; val_best_f1_score: 0.8001; train_kl_reg_loss: 121638.0671; train_edge_recon_loss: 2958435.6061; train_gene_expr_recon_loss: 14193778.8788; train_masked_gp_l1_reg_loss: 85742.7470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87805.7620; train_chrom_access_recon_loss: 13626933.4394; train_global_loss: 31074334.5455; train_optim_loss: 31074334.5455; val_kl_reg_loss: 117846.7236; val_edge_recon_loss: 2965274.6875; val_gene_expr_recon_loss: 14149910.8750; val_masked_gp_l1_reg_loss: 87044.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80713.0391; val_chrom_access_recon_loss: 13772840.7500; val_global_loss: 31173631.2500; val_optim_loss: 31173631.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8693; val_auprc_score: 0.8381; val_best_acc_score: 0.7937; val_best_f1_score: 0.8184; train_kl_reg_loss: 116336.5496; train_edge_recon_loss: 2935985.4167; train_gene_expr_recon_loss: 14124181.1061; train_masked_gp_l1_reg_loss: 88130.0696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75172.6513; train_chrom_access_recon_loss: 13559039.4697; train_global_loss: 30898845.1515; train_optim_loss: 30898845.1515; val_kl_reg_loss: 109655.4131; val_edge_recon_loss: 2921962.3750; val_gene_expr_recon_loss: 14104665.3750; val_masked_gp_l1_reg_loss: 89198.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70104.4531; val_chrom_access_recon_loss: 13728070.8750; val_global_loss: 31023656.2500; val_optim_loss: 31023656.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8660; val_auprc_score: 0.8271; val_best_acc_score: 0.8015; val_best_f1_score: 0.8283; train_kl_reg_loss: 112579.2934; train_edge_recon_loss: 2894278.0076; train_gene_expr_recon_loss: 14081219.6364; train_masked_gp_l1_reg_loss: 90225.5888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66153.0843; train_chrom_access_recon_loss: 13521200.9848; train_global_loss: 30765656.5152; train_optim_loss: 30765656.5152; val_kl_reg_loss: 108595.2266; val_edge_recon_loss: 2871238.7500; val_gene_expr_recon_loss: 14090763.0000; val_masked_gp_l1_reg_loss: 91378.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62595.8906; val_chrom_access_recon_loss: 13598326.0000; val_global_loss: 30822897.2500; val_optim_loss: 30822897.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8812; val_auprc_score: 0.8495; val_best_acc_score: 0.8047; val_best_f1_score: 0.8298; train_kl_reg_loss: 110158.4070; train_edge_recon_loss: 2876598.8674; train_gene_expr_recon_loss: 14019798.6061; train_masked_gp_l1_reg_loss: 92140.0273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59786.0960; train_chrom_access_recon_loss: 13443457.6212; train_global_loss: 30601939.6061; train_optim_loss: 30601939.6061; val_kl_reg_loss: 107620.4463; val_edge_recon_loss: 2886555.2812; val_gene_expr_recon_loss: 14127738.2500; val_masked_gp_l1_reg_loss: 93043.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57143.8984; val_chrom_access_recon_loss: 13630505.0000; val_global_loss: 30902606.5000; val_optim_loss: 30902606.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8925; val_auprc_score: 0.8600; val_best_acc_score: 0.8213; val_best_f1_score: 0.8354; train_kl_reg_loss: 109926.2219; train_edge_recon_loss: 2850028.2917; train_gene_expr_recon_loss: 13963856.6364; train_masked_gp_l1_reg_loss: 93643.6929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54745.6236; train_chrom_access_recon_loss: 13403254.5758; train_global_loss: 30475455.1818; train_optim_loss: 30475455.1818; val_kl_reg_loss: 107931.6768; val_edge_recon_loss: 2869291.0938; val_gene_expr_recon_loss: 13934920.3750; val_masked_gp_l1_reg_loss: 94466.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52937.6836; val_chrom_access_recon_loss: 13565840.7500; val_global_loss: 30625388.5000; val_optim_loss: 30625388.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8965; val_auprc_score: 0.8662; val_best_acc_score: 0.8267; val_best_f1_score: 0.8433; train_kl_reg_loss: 108011.9920; train_edge_recon_loss: 2824531.7235; train_gene_expr_recon_loss: 13923264.0455; train_masked_gp_l1_reg_loss: 95148.0361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50966.6942; train_chrom_access_recon_loss: 13360055.3939; train_global_loss: 30361977.7273; train_optim_loss: 30361977.7273; val_kl_reg_loss: 112867.1201; val_edge_recon_loss: 2888897.1875; val_gene_expr_recon_loss: 13969950.6250; val_masked_gp_l1_reg_loss: 96099.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49484.0430; val_chrom_access_recon_loss: 13587574.2500; val_global_loss: 30704873.5000; val_optim_loss: 30704873.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9075; val_auprc_score: 0.8791; val_best_acc_score: 0.8434; val_best_f1_score: 0.8532; train_kl_reg_loss: 109345.0827; train_edge_recon_loss: 2809648.4848; train_gene_expr_recon_loss: 13875673.8485; train_masked_gp_l1_reg_loss: 96856.0911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48101.7837; train_chrom_access_recon_loss: 13303980.7727; train_global_loss: 30243606.0606; train_optim_loss: 30243606.0606; val_kl_reg_loss: 109110.4668; val_edge_recon_loss: 2854336.2500; val_gene_expr_recon_loss: 13739363.0000; val_masked_gp_l1_reg_loss: 97477.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46741.0039; val_chrom_access_recon_loss: 13352092.1250; val_global_loss: 30199121.0000; val_optim_loss: 30199121.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9165; val_auprc_score: 0.8939; val_best_acc_score: 0.8458; val_best_f1_score: 0.8578; train_kl_reg_loss: 109390.2964; train_edge_recon_loss: 2786472.4091; train_gene_expr_recon_loss: 13830457.4545; train_masked_gp_l1_reg_loss: 98279.4465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45647.2317; train_chrom_access_recon_loss: 13265548.4394; train_global_loss: 30135795.2121; train_optim_loss: 30135795.2121; val_kl_reg_loss: 110600.9443; val_edge_recon_loss: 2804538.6562; val_gene_expr_recon_loss: 13820303.1250; val_masked_gp_l1_reg_loss: 99048.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44665.7734; val_chrom_access_recon_loss: 13452853.5000; val_global_loss: 30332010.7500; val_optim_loss: 30332010.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9213; val_auprc_score: 0.8923; val_best_acc_score: 0.8630; val_best_f1_score: 0.8703; train_kl_reg_loss: 109553.3287; train_edge_recon_loss: 2782970.1288; train_gene_expr_recon_loss: 13796611.8182; train_masked_gp_l1_reg_loss: 99734.3119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44020.4329; train_chrom_access_recon_loss: 13234993.2727; train_global_loss: 30067883.1515; train_optim_loss: 30067883.1515; val_kl_reg_loss: 106674.2773; val_edge_recon_loss: 2789771.9688; val_gene_expr_recon_loss: 13669716.7500; val_masked_gp_l1_reg_loss: 100383.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43166.2773; val_chrom_access_recon_loss: 13315628.2500; val_global_loss: 30025340.2500; val_optim_loss: 30025340.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9077; val_auprc_score: 0.8771; val_best_acc_score: 0.8509; val_best_f1_score: 0.8611; train_kl_reg_loss: 108243.2627; train_edge_recon_loss: 2778450.6174; train_gene_expr_recon_loss: 13763457.3485; train_masked_gp_l1_reg_loss: 100998.0228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42568.3696; train_chrom_access_recon_loss: 13196332.6667; train_global_loss: 29990050.2727; train_optim_loss: 29990050.2727; val_kl_reg_loss: 105422.2227; val_edge_recon_loss: 2843981.2812; val_gene_expr_recon_loss: 13576685.3750; val_masked_gp_l1_reg_loss: 101685.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42232.0664; val_chrom_access_recon_loss: 13152415.2500; val_global_loss: 29822422.0000; val_optim_loss: 29822422.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9185; val_auprc_score: 0.8880; val_best_acc_score: 0.8632; val_best_f1_score: 0.8709; train_kl_reg_loss: 104227.4875; train_edge_recon_loss: 2778469.2424; train_gene_expr_recon_loss: 13726755.6515; train_masked_gp_l1_reg_loss: 102239.9460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41598.1752; train_chrom_access_recon_loss: 13164201.6667; train_global_loss: 29917492.2424; train_optim_loss: 29917492.2424; val_kl_reg_loss: 104557.6045; val_edge_recon_loss: 2785953.7500; val_gene_expr_recon_loss: 13753719.2500; val_masked_gp_l1_reg_loss: 102875.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40995.8789; val_chrom_access_recon_loss: 13293853.7500; val_global_loss: 30081956.5000; val_optim_loss: 30081956.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9222; val_auprc_score: 0.9026; val_best_acc_score: 0.8538; val_best_f1_score: 0.8636; train_kl_reg_loss: 103678.9081; train_edge_recon_loss: 2783773.1439; train_gene_expr_recon_loss: 13685313.6061; train_masked_gp_l1_reg_loss: 103422.6913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40683.3243; train_chrom_access_recon_loss: 13117136.2576; train_global_loss: 29834008.0909; train_optim_loss: 29834008.0909; val_kl_reg_loss: 103550.9365; val_edge_recon_loss: 2802540.9688; val_gene_expr_recon_loss: 13735758.8750; val_masked_gp_l1_reg_loss: 104017.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40366.2227; val_chrom_access_recon_loss: 13373567.2500; val_global_loss: 30159802.0000; val_optim_loss: 30159802.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9170; val_auprc_score: 0.8917; val_best_acc_score: 0.8552; val_best_f1_score: 0.8658; train_kl_reg_loss: 103990.5819; train_edge_recon_loss: 2760144.5909; train_gene_expr_recon_loss: 13651146.0455; train_masked_gp_l1_reg_loss: 104459.4350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40023.3910; train_chrom_access_recon_loss: 13074744.6061; train_global_loss: 29734508.6970; train_optim_loss: 29734508.6970; val_kl_reg_loss: 101164.3281; val_edge_recon_loss: 2814187.1562; val_gene_expr_recon_loss: 13686389.1250; val_masked_gp_l1_reg_loss: 105300.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39890.0859; val_chrom_access_recon_loss: 13209712.7500; val_global_loss: 29956643.5000; val_optim_loss: 29956643.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9202; val_auprc_score: 0.8884; val_best_acc_score: 0.8557; val_best_f1_score: 0.8639; train_kl_reg_loss: 101984.1133; train_edge_recon_loss: 2753992.0795; train_gene_expr_recon_loss: 13632433.0000; train_masked_gp_l1_reg_loss: 105604.0147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39645.5378; train_chrom_access_recon_loss: 13053596.1364; train_global_loss: 29687254.9697; train_optim_loss: 29687254.9697; val_kl_reg_loss: 100228.7754; val_edge_recon_loss: 2795350.0312; val_gene_expr_recon_loss: 13548523.3750; val_masked_gp_l1_reg_loss: 106207.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39509.2148; val_chrom_access_recon_loss: 13116993.8750; val_global_loss: 29706812.7500; val_optim_loss: 29706812.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9233; val_auprc_score: 0.8999; val_best_acc_score: 0.8614; val_best_f1_score: 0.8685; train_kl_reg_loss: 101881.1487; train_edge_recon_loss: 2753873.1288; train_gene_expr_recon_loss: 13593272.4848; train_masked_gp_l1_reg_loss: 106606.8839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39309.8267; train_chrom_access_recon_loss: 12999163.5152; train_global_loss: 29594106.9697; train_optim_loss: 29594106.9697; val_kl_reg_loss: 97976.9297; val_edge_recon_loss: 2780961.6875; val_gene_expr_recon_loss: 13553611.1250; val_masked_gp_l1_reg_loss: 107281.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39214.3398; val_chrom_access_recon_loss: 13145408.8750; val_global_loss: 29724454.5000; val_optim_loss: 29724454.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9253; val_auprc_score: 0.9028; val_best_acc_score: 0.8646; val_best_f1_score: 0.8712; train_kl_reg_loss: 99940.7111; train_edge_recon_loss: 2748559.5568; train_gene_expr_recon_loss: 13562304.1818; train_masked_gp_l1_reg_loss: 107563.0900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38942.0443; train_chrom_access_recon_loss: 12972886.3485; train_global_loss: 29530195.8485; train_optim_loss: 29530195.8485; val_kl_reg_loss: 96490.9277; val_edge_recon_loss: 2784809.9375; val_gene_expr_recon_loss: 13496968.1250; val_masked_gp_l1_reg_loss: 108061.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38878.5039; val_chrom_access_recon_loss: 13049105.7500; val_global_loss: 29574314.2500; val_optim_loss: 29574314.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9302; val_auprc_score: 0.9073; val_best_acc_score: 0.8697; val_best_f1_score: 0.8756; train_kl_reg_loss: 99359.5595; train_edge_recon_loss: 2749276.5795; train_gene_expr_recon_loss: 13540131.6364; train_masked_gp_l1_reg_loss: 108489.4828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38728.8068; train_chrom_access_recon_loss: 12947631.9091; train_global_loss: 29483618.1515; train_optim_loss: 29483618.1515; val_kl_reg_loss: 98101.9756; val_edge_recon_loss: 2775029.2500; val_gene_expr_recon_loss: 13616641.7500; val_masked_gp_l1_reg_loss: 108932.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38588.4141; val_chrom_access_recon_loss: 13175794.2500; val_global_loss: 29813087.2500; val_optim_loss: 29813087.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9272; val_auprc_score: 0.8987; val_best_acc_score: 0.8635; val_best_f1_score: 0.8707; train_kl_reg_loss: 99248.1983; train_edge_recon_loss: 2742156.0379; train_gene_expr_recon_loss: 13521067.9697; train_masked_gp_l1_reg_loss: 109290.5736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38463.1391; train_chrom_access_recon_loss: 12921331.8333; train_global_loss: 29431557.8485; train_optim_loss: 29431557.8485; val_kl_reg_loss: 98743.0908; val_edge_recon_loss: 2754535.2500; val_gene_expr_recon_loss: 13491604.2500; val_masked_gp_l1_reg_loss: 109646.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38488.5117; val_chrom_access_recon_loss: 12948497.2500; val_global_loss: 29441515.5000; val_optim_loss: 29441515.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9294; val_auprc_score: 0.9075; val_best_acc_score: 0.8670; val_best_f1_score: 0.8731; train_kl_reg_loss: 104161.6919; train_edge_recon_loss: 2768340.6212; train_gene_expr_recon_loss: 13337939.2273; train_masked_gp_l1_reg_loss: 108792.0619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35594.9897; train_chrom_access_recon_loss: 12822566.0758; train_global_loss: 29177394.6667; train_optim_loss: 29177394.6667; val_kl_reg_loss: 70873.6523; val_edge_recon_loss: 2803865.7812; val_gene_expr_recon_loss: 13195229.2500; val_masked_gp_l1_reg_loss: 108509.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34725.7461; val_chrom_access_recon_loss: 12793168.6250; val_global_loss: 29006372.2500; val_optim_loss: 29006372.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9319; val_auprc_score: 0.9127; val_best_acc_score: 0.8692; val_best_f1_score: 0.8758; train_kl_reg_loss: 104738.1433; train_edge_recon_loss: 2761224.2121; train_gene_expr_recon_loss: 13308187.2273; train_masked_gp_l1_reg_loss: 108737.2975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34540.3076; train_chrom_access_recon_loss: 12734020.6364; train_global_loss: 29051447.7273; train_optim_loss: 29051447.7273; val_kl_reg_loss: 74571.4219; val_edge_recon_loss: 2783302.8438; val_gene_expr_recon_loss: 13269194.5000; val_masked_gp_l1_reg_loss: 108942.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34397.2422; val_chrom_access_recon_loss: 12914135.2500; val_global_loss: 29184543.0000; val_optim_loss: 29184543.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9385; val_auprc_score: 0.9236; val_best_acc_score: 0.8743; val_best_f1_score: 0.8792; train_kl_reg_loss: 100930.1344; train_edge_recon_loss: 2748154.8258; train_gene_expr_recon_loss: 13273714.0909; train_masked_gp_l1_reg_loss: 109231.1446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34371.4270; train_chrom_access_recon_loss: 12692794.9394; train_global_loss: 28959196.4242; train_optim_loss: 28959196.4242; val_kl_reg_loss: 75734.7559; val_edge_recon_loss: 2789676.8125; val_gene_expr_recon_loss: 13354908.2500; val_masked_gp_l1_reg_loss: 109518.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34340.0195; val_chrom_access_recon_loss: 12826561.6250; val_global_loss: 29190740.2500; val_optim_loss: 29190740.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9354; val_auprc_score: 0.9138; val_best_acc_score: 0.8732; val_best_f1_score: 0.8798; train_kl_reg_loss: 97000.3813; train_edge_recon_loss: 2730700.6856; train_gene_expr_recon_loss: 13241803.3485; train_masked_gp_l1_reg_loss: 109756.3496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34336.7833; train_chrom_access_recon_loss: 12656155.9697; train_global_loss: 28869753.6061; train_optim_loss: 28869753.6061; val_kl_reg_loss: 78713.1934; val_edge_recon_loss: 2778889.4062; val_gene_expr_recon_loss: 13343564.8750; val_masked_gp_l1_reg_loss: 110099.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34359.2656; val_chrom_access_recon_loss: 12863247.7500; val_global_loss: 29208873.0000; val_optim_loss: 29208873.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9353; val_auprc_score: 0.9151; val_best_acc_score: 0.8729; val_best_f1_score: 0.8793; train_kl_reg_loss: 95111.0536; train_edge_recon_loss: 2735974.1515; train_gene_expr_recon_loss: 13216224.3485; train_masked_gp_l1_reg_loss: 110231.7657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34192.3326; train_chrom_access_recon_loss: 12627808.3030; train_global_loss: 28819541.8485; train_optim_loss: 28819541.8485; val_kl_reg_loss: 79959.7607; val_edge_recon_loss: 2785666.0938; val_gene_expr_recon_loss: 13118962.2500; val_masked_gp_l1_reg_loss: 110405.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34038.1289; val_chrom_access_recon_loss: 12687502.8750; val_global_loss: 28816535.0000; val_optim_loss: 28816535.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9361; val_auprc_score: 0.9172; val_best_acc_score: 0.8737; val_best_f1_score: 0.8805; train_kl_reg_loss: 93375.6307; train_edge_recon_loss: 2731489.3902; train_gene_expr_recon_loss: 13190166.3485; train_masked_gp_l1_reg_loss: 110633.4469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33989.9909; train_chrom_access_recon_loss: 12595475.6364; train_global_loss: 28755130.4242; train_optim_loss: 28755130.4242; val_kl_reg_loss: 81226.9316; val_edge_recon_loss: 2759171.2188; val_gene_expr_recon_loss: 13143232.7500; val_masked_gp_l1_reg_loss: 110801.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33911.7227; val_chrom_access_recon_loss: 12783824.2500; val_global_loss: 28912168.2500; val_optim_loss: 28912168.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9427; val_auprc_score: 0.9270; val_best_acc_score: 0.8807; val_best_f1_score: 0.8867; train_kl_reg_loss: 91156.3746; train_edge_recon_loss: 2724927.0227; train_gene_expr_recon_loss: 13174716.9091; train_masked_gp_l1_reg_loss: 110935.8461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33779.8225; train_chrom_access_recon_loss: 12566081.4697; train_global_loss: 28701597.4242; train_optim_loss: 28701597.4242; val_kl_reg_loss: 79398.4717; val_edge_recon_loss: 2734217.5625; val_gene_expr_recon_loss: 13121914.3750; val_masked_gp_l1_reg_loss: 111165.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33743.2109; val_chrom_access_recon_loss: 12648711.1250; val_global_loss: 28729149.2500; val_optim_loss: 28729149.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9446; val_auprc_score: 0.9278; val_best_acc_score: 0.8831; val_best_f1_score: 0.8893; train_kl_reg_loss: 88309.1932; train_edge_recon_loss: 2720778.5947; train_gene_expr_recon_loss: 13145810.4545; train_masked_gp_l1_reg_loss: 111471.7249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33700.9466; train_chrom_access_recon_loss: 12532951.5455; train_global_loss: 28633022.0606; train_optim_loss: 28633022.0606; val_kl_reg_loss: 80614.5410; val_edge_recon_loss: 2747611.7812; val_gene_expr_recon_loss: 13159124.8750; val_masked_gp_l1_reg_loss: 111636.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33537.1953; val_chrom_access_recon_loss: 12627693.5000; val_global_loss: 28760217.2500; val_optim_loss: 28760217.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9465; val_auprc_score: 0.9297; val_best_acc_score: 0.8839; val_best_f1_score: 0.8897; train_kl_reg_loss: 87649.9548; train_edge_recon_loss: 2721816.7652; train_gene_expr_recon_loss: 13126175.0758; train_masked_gp_l1_reg_loss: 111830.7768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33476.8048; train_chrom_access_recon_loss: 12512555.5152; train_global_loss: 28593504.8485; train_optim_loss: 28593504.8485; val_kl_reg_loss: 76960.6611; val_edge_recon_loss: 2780273.0312; val_gene_expr_recon_loss: 12990677.5000; val_masked_gp_l1_reg_loss: 112006.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33322.0039; val_chrom_access_recon_loss: 12546652.6250; val_global_loss: 28539891.5000; val_optim_loss: 28539891.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9449; val_auprc_score: 0.9228; val_best_acc_score: 0.8858; val_best_f1_score: 0.8914; train_kl_reg_loss: 87665.5604; train_edge_recon_loss: 2715818.7008; train_gene_expr_recon_loss: 13100203.3485; train_masked_gp_l1_reg_loss: 112221.6504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32792.3912; train_chrom_access_recon_loss: 12493742.3788; train_global_loss: 28542443.9394; train_optim_loss: 28542443.9394; val_kl_reg_loss: 84633.5596; val_edge_recon_loss: 2752091.8750; val_gene_expr_recon_loss: 13156459.0000; val_masked_gp_l1_reg_loss: 112452.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32484.9395; val_chrom_access_recon_loss: 12620423.2500; val_global_loss: 28758545.5000; val_optim_loss: 28758545.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9436; val_auprc_score: 0.9224; val_best_acc_score: 0.8861; val_best_f1_score: 0.8921; train_kl_reg_loss: 86908.1982; train_edge_recon_loss: 2710897.6667; train_gene_expr_recon_loss: 13084374.2121; train_masked_gp_l1_reg_loss: 112603.2338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32319.7347; train_chrom_access_recon_loss: 12474774.2424; train_global_loss: 28501877.2424; train_optim_loss: 28501877.2424; val_kl_reg_loss: 79514.6836; val_edge_recon_loss: 2746497.0938; val_gene_expr_recon_loss: 13114829.5000; val_masked_gp_l1_reg_loss: 112876.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32315.6367; val_chrom_access_recon_loss: 12581583.2500; val_global_loss: 28667616.5000; val_optim_loss: 28667616.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9493; val_auprc_score: 0.9309; val_best_acc_score: 0.8939; val_best_f1_score: 0.8974; train_kl_reg_loss: 86540.6036; train_edge_recon_loss: 2722220.0758; train_gene_expr_recon_loss: 13058611.3788; train_masked_gp_l1_reg_loss: 112992.3770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32267.3548; train_chrom_access_recon_loss: 12433378.3333; train_global_loss: 28446010.1515; train_optim_loss: 28446010.1515; val_kl_reg_loss: 80941.4648; val_edge_recon_loss: 2753905.9688; val_gene_expr_recon_loss: 13008016.6250; val_masked_gp_l1_reg_loss: 113161.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32238.3555; val_chrom_access_recon_loss: 12625971.7500; val_global_loss: 28614235.7500; val_optim_loss: 28614235.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9459; val_auprc_score: 0.9242; val_best_acc_score: 0.8877; val_best_f1_score: 0.8932; train_kl_reg_loss: 85585.2925; train_edge_recon_loss: 2716370.1970; train_gene_expr_recon_loss: 13041905.5758; train_masked_gp_l1_reg_loss: 113326.0131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32189.0504; train_chrom_access_recon_loss: 12431753.3485; train_global_loss: 28421129.3939; train_optim_loss: 28421129.3939; val_kl_reg_loss: 79536.1689; val_edge_recon_loss: 2732334.7500; val_gene_expr_recon_loss: 13074693.0000; val_masked_gp_l1_reg_loss: 113554.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32125.7051; val_chrom_access_recon_loss: 12511246.5000; val_global_loss: 28543491.2500; val_optim_loss: 28543491.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9536; val_auprc_score: 0.9409; val_best_acc_score: 0.8960; val_best_f1_score: 0.9013; train_kl_reg_loss: 85986.4995; train_edge_recon_loss: 2696786.0758; train_gene_expr_recon_loss: 13017483.5303; train_masked_gp_l1_reg_loss: 112610.2673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29344.0264; train_chrom_access_recon_loss: 12402217.3788; train_global_loss: 28344427.8485; train_optim_loss: 28344427.8485; val_kl_reg_loss: 81040.9180; val_edge_recon_loss: 2718961.9062; val_gene_expr_recon_loss: 13037809.6250; val_masked_gp_l1_reg_loss: 112155.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28734.9004; val_chrom_access_recon_loss: 12669601.2500; val_global_loss: 28648304.5000; val_optim_loss: 28648304.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9482; val_auprc_score: 0.9180; val_best_acc_score: 0.8923; val_best_f1_score: 0.8981; train_kl_reg_loss: 86691.0431; train_edge_recon_loss: 2711051.5379; train_gene_expr_recon_loss: 13019144.3788; train_masked_gp_l1_reg_loss: 112024.3362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28616.5152; train_chrom_access_recon_loss: 12410205.0455; train_global_loss: 28367733.0000; train_optim_loss: 28367733.0000; val_kl_reg_loss: 81747.5469; val_edge_recon_loss: 2725726.9375; val_gene_expr_recon_loss: 13002103.2500; val_masked_gp_l1_reg_loss: 111955.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28538.2754; val_chrom_access_recon_loss: 12535560.5000; val_global_loss: 28485632.2500; val_optim_loss: 28485632.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9483; val_auprc_score: 0.9270; val_best_acc_score: 0.8912; val_best_f1_score: 0.8961; train_kl_reg_loss: 87098.8588; train_edge_recon_loss: 2704027.6705; train_gene_expr_recon_loss: 13022926.6818; train_masked_gp_l1_reg_loss: 111926.0915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28473.3738; train_chrom_access_recon_loss: 12397978.8333; train_global_loss: 28352431.4545; train_optim_loss: 28352431.4545; val_kl_reg_loss: 82194.9717; val_edge_recon_loss: 2746674.5000; val_gene_expr_recon_loss: 13039402.6250; val_masked_gp_l1_reg_loss: 111896.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28409.0117; val_chrom_access_recon_loss: 12496758.5000; val_global_loss: 28505335.5000; val_optim_loss: 28505335.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9449; val_auprc_score: 0.9210; val_best_acc_score: 0.8909; val_best_f1_score: 0.8971; train_kl_reg_loss: 87258.2327; train_edge_recon_loss: 2700439.2652; train_gene_expr_recon_loss: 13011133.9394; train_masked_gp_l1_reg_loss: 111893.7549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28362.0334; train_chrom_access_recon_loss: 12388153.5455; train_global_loss: 28327240.6061; train_optim_loss: 28327240.6061; val_kl_reg_loss: 82664.0723; val_edge_recon_loss: 2739391.4688; val_gene_expr_recon_loss: 12989531.6250; val_masked_gp_l1_reg_loss: 111882.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28312.4180; val_chrom_access_recon_loss: 12484254.8750; val_global_loss: 28436036.7500; val_optim_loss: 28436036.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9484; val_auprc_score: 0.9266; val_best_acc_score: 0.8912; val_best_f1_score: 0.8964; train_kl_reg_loss: 86571.9637; train_edge_recon_loss: 2720845.8902; train_gene_expr_recon_loss: 13011489.5909; train_masked_gp_l1_reg_loss: 111887.5605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28282.1839; train_chrom_access_recon_loss: 12386023.1515; train_global_loss: 28345100.3030; train_optim_loss: 28345100.3030; val_kl_reg_loss: 81235.1611; val_edge_recon_loss: 2749299.6562; val_gene_expr_recon_loss: 13056276.8750; val_masked_gp_l1_reg_loss: 111899.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28251.3145; val_chrom_access_recon_loss: 12595499.5000; val_global_loss: 28622461.0000; val_optim_loss: 28622461.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9532; val_auprc_score: 0.9379; val_best_acc_score: 0.8920; val_best_f1_score: 0.8980; train_kl_reg_loss: 86758.7257; train_edge_recon_loss: 2700792.7311; train_gene_expr_recon_loss: 13017828.1667; train_masked_gp_l1_reg_loss: 111910.2179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28199.9575; train_chrom_access_recon_loss: 12392822.2576; train_global_loss: 28338312.0000; train_optim_loss: 28338312.0000; val_kl_reg_loss: 82241.9521; val_edge_recon_loss: 2720751.4688; val_gene_expr_recon_loss: 12965615.3750; val_masked_gp_l1_reg_loss: 111920.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28162.3379; val_chrom_access_recon_loss: 12594385.7500; val_global_loss: 28503076.5000; val_optim_loss: 28503076.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9475; val_auprc_score: 0.9271; val_best_acc_score: 0.8936; val_best_f1_score: 0.8994; train_kl_reg_loss: 86213.7030; train_edge_recon_loss: 2707122.0038; train_gene_expr_recon_loss: 13002687.7879; train_masked_gp_l1_reg_loss: 111931.6458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28143.7253; train_chrom_access_recon_loss: 12380395.5455; train_global_loss: 28316494.2424; train_optim_loss: 28316494.2424; val_kl_reg_loss: 81112.2578; val_edge_recon_loss: 2730988.6562; val_gene_expr_recon_loss: 13059276.7500; val_masked_gp_l1_reg_loss: 111946.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28111.5938; val_chrom_access_recon_loss: 12511310.8750; val_global_loss: 28522747.7500; val_optim_loss: 28522747.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9557; val_auprc_score: 0.9394; val_best_acc_score: 0.9033; val_best_f1_score: 0.9073; train_kl_reg_loss: 85759.5350; train_edge_recon_loss: 2705873.6098; train_gene_expr_recon_loss: 13015742.5606; train_masked_gp_l1_reg_loss: 111967.4991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28075.4113; train_chrom_access_recon_loss: 12392111.5455; train_global_loss: 28339530.0303; train_optim_loss: 28339530.0303; val_kl_reg_loss: 81704.2275; val_edge_recon_loss: 2714666.6875; val_gene_expr_recon_loss: 13111194.7500; val_masked_gp_l1_reg_loss: 111980.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28042.4199; val_chrom_access_recon_loss: 12583005.7500; val_global_loss: 28630595.2500; val_optim_loss: 28630595.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9539; val_auprc_score: 0.9378; val_best_acc_score: 0.8992; val_best_f1_score: 0.9037; train_kl_reg_loss: 86001.3480; train_edge_recon_loss: 2702156.4659; train_gene_expr_recon_loss: 13005743.9848; train_masked_gp_l1_reg_loss: 111886.7279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27747.2240; train_chrom_access_recon_loss: 12378280.7121; train_global_loss: 28311816.4242; train_optim_loss: 28311816.4242; val_kl_reg_loss: 81701.5820; val_edge_recon_loss: 2722153.3125; val_gene_expr_recon_loss: 13142351.5000; val_masked_gp_l1_reg_loss: 111836.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27685.0059; val_chrom_access_recon_loss: 12641224.2500; val_global_loss: 28726952.5000; val_optim_loss: 28726952.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9487; val_auprc_score: 0.9253; val_best_acc_score: 0.8955; val_best_f1_score: 0.9005; train_kl_reg_loss: 86039.0354; train_edge_recon_loss: 2697659.5606; train_gene_expr_recon_loss: 13006703.7424; train_masked_gp_l1_reg_loss: 111819.5284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27676.7845; train_chrom_access_recon_loss: 12377253.5909; train_global_loss: 28307152.1818; train_optim_loss: 28307152.1818; val_kl_reg_loss: 80916.0977; val_edge_recon_loss: 2723399.8438; val_gene_expr_recon_loss: 12923879.3750; val_masked_gp_l1_reg_loss: 111805.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27668.1602; val_chrom_access_recon_loss: 12434963.0000; val_global_loss: 28302631.5000; val_optim_loss: 28302631.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9456; val_auprc_score: 0.9243; val_best_acc_score: 0.8939; val_best_f1_score: 0.8992; train_kl_reg_loss: 86053.1636; train_edge_recon_loss: 2707166.0833; train_gene_expr_recon_loss: 13005053.7879; train_masked_gp_l1_reg_loss: 111798.1792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27662.2639; train_chrom_access_recon_loss: 12387026.1212; train_global_loss: 28324759.4848; train_optim_loss: 28324759.4848; val_kl_reg_loss: 81469.4160; val_edge_recon_loss: 2744206.3750; val_gene_expr_recon_loss: 12968138.1250; val_masked_gp_l1_reg_loss: 111791.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27655.3066; val_chrom_access_recon_loss: 12399799.8750; val_global_loss: 28333060.0000; val_optim_loss: 28333060.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9496; val_auprc_score: 0.9272; val_best_acc_score: 0.8987; val_best_f1_score: 0.9032; train_kl_reg_loss: 86036.5094; train_edge_recon_loss: 2704283.5076; train_gene_expr_recon_loss: 13005059.5303; train_masked_gp_l1_reg_loss: 111788.9034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27651.1769; train_chrom_access_recon_loss: 12378162.1970; train_global_loss: 28312981.8182; train_optim_loss: 28312981.8182; val_kl_reg_loss: 81320.0820; val_edge_recon_loss: 2738573.3125; val_gene_expr_recon_loss: 13019643.0000; val_masked_gp_l1_reg_loss: 111784.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27646.5977; val_chrom_access_recon_loss: 12479263.2500; val_global_loss: 28458231.7500; val_optim_loss: 28458231.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9539; val_auprc_score: 0.9366; val_best_acc_score: 0.8955; val_best_f1_score: 0.9005; train_kl_reg_loss: 86229.1637; train_edge_recon_loss: 2700062.6553; train_gene_expr_recon_loss: 13014810.6364; train_masked_gp_l1_reg_loss: 111783.2116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27641.4211; train_chrom_access_recon_loss: 12390502.3333; train_global_loss: 28331029.4242; train_optim_loss: 28331029.4242; val_kl_reg_loss: 82064.7119; val_edge_recon_loss: 2723376.0625; val_gene_expr_recon_loss: 13056419.8750; val_masked_gp_l1_reg_loss: 111781.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27637.3164; val_chrom_access_recon_loss: 12640417.1250; val_global_loss: 28641696.7500; val_optim_loss: 28641696.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9563; val_auprc_score: 0.9357; val_best_acc_score: 0.9006; val_best_f1_score: 0.9054; train_kl_reg_loss: 86289.1991; train_edge_recon_loss: 2701795.0833; train_gene_expr_recon_loss: 12999203.1818; train_masked_gp_l1_reg_loss: 111781.6151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27632.3746; train_chrom_access_recon_loss: 12376287.7424; train_global_loss: 28302989.2121; train_optim_loss: 28302989.2121; val_kl_reg_loss: 81914.4873; val_edge_recon_loss: 2712574.0312; val_gene_expr_recon_loss: 13048478.1250; val_masked_gp_l1_reg_loss: 111782.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27628.4551; val_chrom_access_recon_loss: 12498722.1250; val_global_loss: 28481098.7500; val_optim_loss: 28481098.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9475; val_auprc_score: 0.9248; val_best_acc_score: 0.8915; val_best_f1_score: 0.8971; train_kl_reg_loss: 86412.3511; train_edge_recon_loss: 2701816.6098; train_gene_expr_recon_loss: 13004365.4242; train_masked_gp_l1_reg_loss: 111772.6637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27597.7770; train_chrom_access_recon_loss: 12380079.6061; train_global_loss: 28312044.4848; train_optim_loss: 28312044.4848; val_kl_reg_loss: 82619.0332; val_edge_recon_loss: 2758015.2188; val_gene_expr_recon_loss: 13130605.5000; val_masked_gp_l1_reg_loss: 111767.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27591.5137; val_chrom_access_recon_loss: 12602353.5000; val_global_loss: 28712953.2500; val_optim_loss: 28712953.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9478; val_auprc_score: 0.9271; val_best_acc_score: 0.8928; val_best_f1_score: 0.8982; train_kl_reg_loss: 86418.9942; train_edge_recon_loss: 2705165.0076; train_gene_expr_recon_loss: 13014105.1364; train_masked_gp_l1_reg_loss: 111765.8229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27590.5108; train_chrom_access_recon_loss: 12388828.7273; train_global_loss: 28333874.2424; train_optim_loss: 28333874.2424; val_kl_reg_loss: 82216.8281; val_edge_recon_loss: 2723372.4688; val_gene_expr_recon_loss: 13008289.2500; val_masked_gp_l1_reg_loss: 111764.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27589.7578; val_chrom_access_recon_loss: 12564225.5000; val_global_loss: 28517458.2500; val_optim_loss: 28517458.2500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9520; val_auprc_score: 0.9353; val_best_acc_score: 0.8907; val_best_f1_score: 0.8972; train_kl_reg_loss: 86485.1864; train_edge_recon_loss: 2706532.3939; train_gene_expr_recon_loss: 13014970.6515; train_masked_gp_l1_reg_loss: 111763.2753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27589.2271; train_chrom_access_recon_loss: 12383693.2121; train_global_loss: 28331033.9697; train_optim_loss: 28331033.9697; val_kl_reg_loss: 81875.5361; val_edge_recon_loss: 2744158.8438; val_gene_expr_recon_loss: 12942559.6250; val_masked_gp_l1_reg_loss: 111762.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27588.5000; val_chrom_access_recon_loss: 12433194.8750; val_global_loss: 28341139.5000; val_optim_loss: 28341139.5000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9509; val_auprc_score: 0.9351; val_best_acc_score: 0.8936; val_best_f1_score: 0.8974; train_kl_reg_loss: 86515.2880; train_edge_recon_loss: 2702797.9470; train_gene_expr_recon_loss: 13006485.0000; train_masked_gp_l1_reg_loss: 111761.8861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27588.0327; train_chrom_access_recon_loss: 12383253.6364; train_global_loss: 28318401.6364; train_optim_loss: 28318401.6364; val_kl_reg_loss: 82106.3730; val_edge_recon_loss: 2748436.6875; val_gene_expr_recon_loss: 13068765.0000; val_masked_gp_l1_reg_loss: 111761.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27587.3809; val_chrom_access_recon_loss: 12627331.1250; val_global_loss: 28665987.0000; val_optim_loss: 28665987.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 16 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9461
val AUPRC score: 0.9256
val best accuracy score: 0.8907
val best F1 score: 0.8964
val target rna MSE score: 0.8590
val source rna MSE score: 0.2659
val target atac MSE score: 0.3343
val source atac MSE score: 0.0745
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
