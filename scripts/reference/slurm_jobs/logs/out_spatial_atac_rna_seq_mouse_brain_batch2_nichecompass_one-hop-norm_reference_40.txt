[True]
Run timestamp: 09102023_211917_40.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_40']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6222; val_auprc_score: 0.6116; val_best_acc_score: 0.5118; val_best_f1_score: 0.6709; train_kl_reg_loss: 44153.3106; train_edge_recon_loss: 3508337.9394; train_gene_expr_recon_loss: 13934193.0909; train_masked_gp_l1_reg_loss: 90824.9715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2968702.0398; train_chrom_access_recon_loss: 2331115.3712; train_global_loss: 22877326.8788; train_optim_loss: 22877326.8788; val_kl_reg_loss: 102098.0117; val_edge_recon_loss: 4064781.0312; val_gene_expr_recon_loss: 13089189.8750; val_masked_gp_l1_reg_loss: 78690.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1639922.3750; val_chrom_access_recon_loss: 2253375.0938; val_global_loss: 21228056.2500; val_optim_loss: 21228056.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6334; val_auprc_score: 0.6263; val_best_acc_score: 0.5567; val_best_f1_score: 0.6775; train_kl_reg_loss: 86844.4846; train_edge_recon_loss: 3517899.4735; train_gene_expr_recon_loss: 12787105.5909; train_masked_gp_l1_reg_loss: 75571.7848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 881591.8565; train_chrom_access_recon_loss: 2208575.4205; train_global_loss: 19557588.4545; train_optim_loss: 19557588.4545; val_kl_reg_loss: 97086.3057; val_edge_recon_loss: 4061479.2812; val_gene_expr_recon_loss: 12729426.6250; val_masked_gp_l1_reg_loss: 74425.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 416173.2500; val_chrom_access_recon_loss: 2193230.4062; val_global_loss: 19571822.7500; val_optim_loss: 19571822.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7182; val_auprc_score: 0.6974; val_best_acc_score: 0.6561; val_best_f1_score: 0.6900; train_kl_reg_loss: 82048.7898; train_edge_recon_loss: 3510199.8220; train_gene_expr_recon_loss: 12642657.6515; train_masked_gp_l1_reg_loss: 74763.6435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 277615.2957; train_chrom_access_recon_loss: 2191089.1989; train_global_loss: 18778374.5758; train_optim_loss: 18778374.5758; val_kl_reg_loss: 84111.5195; val_edge_recon_loss: 4032793.5312; val_gene_expr_recon_loss: 12743914.8750; val_masked_gp_l1_reg_loss: 76027.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 190962.0469; val_chrom_access_recon_loss: 2204522.9375; val_global_loss: 19332332.5000; val_optim_loss: 19332332.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8182; val_auprc_score: 0.7849; val_best_acc_score: 0.7515; val_best_f1_score: 0.7663; train_kl_reg_loss: 67700.0227; train_edge_recon_loss: 3475464.7008; train_gene_expr_recon_loss: 12556988.3788; train_masked_gp_l1_reg_loss: 77851.2197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154628.3203; train_chrom_access_recon_loss: 2177142.4527; train_global_loss: 18509775.0909; train_optim_loss: 18509775.0909; val_kl_reg_loss: 61803.0283; val_edge_recon_loss: 3640044.0938; val_gene_expr_recon_loss: 12747071.2500; val_masked_gp_l1_reg_loss: 80471.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128723.5938; val_chrom_access_recon_loss: 2196360.0625; val_global_loss: 18854474.2500; val_optim_loss: 18854474.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8438; val_auprc_score: 0.8136; val_best_acc_score: 0.7593; val_best_f1_score: 0.7932; train_kl_reg_loss: 54734.5003; train_edge_recon_loss: 3183980.1061; train_gene_expr_recon_loss: 12536807.5606; train_masked_gp_l1_reg_loss: 89450.5624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117886.1915; train_chrom_access_recon_loss: 2171104.4034; train_global_loss: 18153963.3939; train_optim_loss: 18153963.3939; val_kl_reg_loss: 61761.9336; val_edge_recon_loss: 3057398.1875; val_gene_expr_recon_loss: 12607900.0000; val_masked_gp_l1_reg_loss: 102138.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108376.1172; val_chrom_access_recon_loss: 2178274.0000; val_global_loss: 18115848.5000; val_optim_loss: 18115848.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8520; val_auprc_score: 0.8253; val_best_acc_score: 0.7759; val_best_f1_score: 0.8040; train_kl_reg_loss: 75090.8738; train_edge_recon_loss: 2958108.4962; train_gene_expr_recon_loss: 12483882.7576; train_masked_gp_l1_reg_loss: 105569.8125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99779.3627; train_chrom_access_recon_loss: 2159328.1932; train_global_loss: 17881759.4545; train_optim_loss: 17881759.4545; val_kl_reg_loss: 78259.9834; val_edge_recon_loss: 2930598.3125; val_gene_expr_recon_loss: 12514176.3750; val_masked_gp_l1_reg_loss: 107087.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92288.9219; val_chrom_access_recon_loss: 2159076.0000; val_global_loss: 17881488.0000; val_optim_loss: 17881488.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8570; val_auprc_score: 0.8205; val_best_acc_score: 0.7864; val_best_f1_score: 0.8106; train_kl_reg_loss: 86536.0619; train_edge_recon_loss: 2892278.3523; train_gene_expr_recon_loss: 12383072.5909; train_masked_gp_l1_reg_loss: 106209.9508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85710.3248; train_chrom_access_recon_loss: 2147969.0890; train_global_loss: 17701776.2121; train_optim_loss: 17701776.2121; val_kl_reg_loss: 85816.8086; val_edge_recon_loss: 2899457.1562; val_gene_expr_recon_loss: 12334659.0000; val_masked_gp_l1_reg_loss: 105518.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79512.4766; val_chrom_access_recon_loss: 2135605.6875; val_global_loss: 17640568.5000; val_optim_loss: 17640568.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8637; val_auprc_score: 0.8298; val_best_acc_score: 0.7859; val_best_f1_score: 0.8096; train_kl_reg_loss: 88652.9659; train_edge_recon_loss: 2858023.7689; train_gene_expr_recon_loss: 12304956.3182; train_masked_gp_l1_reg_loss: 105459.1959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76021.3665; train_chrom_access_recon_loss: 2136808.6742; train_global_loss: 17569922.3333; train_optim_loss: 17569922.3333; val_kl_reg_loss: 89253.1387; val_edge_recon_loss: 2912875.6875; val_gene_expr_recon_loss: 12274584.7500; val_masked_gp_l1_reg_loss: 105585.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73101.1719; val_chrom_access_recon_loss: 2140359.6562; val_global_loss: 17595759.5000; val_optim_loss: 17595759.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8787; val_auprc_score: 0.8414; val_best_acc_score: 0.8103; val_best_f1_score: 0.8245; train_kl_reg_loss: 89071.0605; train_edge_recon_loss: 2843414.9545; train_gene_expr_recon_loss: 12253648.4394; train_masked_gp_l1_reg_loss: 105801.7777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70629.3447; train_chrom_access_recon_loss: 2125759.4527; train_global_loss: 17488325.1212; train_optim_loss: 17488325.1212; val_kl_reg_loss: 97913.1641; val_edge_recon_loss: 2832036.9688; val_gene_expr_recon_loss: 12280562.8750; val_masked_gp_l1_reg_loss: 106231.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69369.7734; val_chrom_access_recon_loss: 2127125.6406; val_global_loss: 17513240.5000; val_optim_loss: 17513240.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8884; val_auprc_score: 0.8621; val_best_acc_score: 0.8205; val_best_f1_score: 0.8349; train_kl_reg_loss: 93234.4582; train_edge_recon_loss: 2809510.0947; train_gene_expr_recon_loss: 12198447.0455; train_masked_gp_l1_reg_loss: 106304.4523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68650.8474; train_chrom_access_recon_loss: 2117710.7121; train_global_loss: 17393857.5455; train_optim_loss: 17393857.5455; val_kl_reg_loss: 91579.1201; val_edge_recon_loss: 2848163.2500; val_gene_expr_recon_loss: 12303466.7500; val_masked_gp_l1_reg_loss: 106282.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68431.0234; val_chrom_access_recon_loss: 2141323.2969; val_global_loss: 17559245.5000; val_optim_loss: 17559245.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8915; val_auprc_score: 0.8551; val_best_acc_score: 0.8243; val_best_f1_score: 0.8412; train_kl_reg_loss: 90021.8192; train_edge_recon_loss: 2813058.6780; train_gene_expr_recon_loss: 12146529.4394; train_masked_gp_l1_reg_loss: 106654.1707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68062.4338; train_chrom_access_recon_loss: 2110256.5909; train_global_loss: 17334583.3030; train_optim_loss: 17334583.3030; val_kl_reg_loss: 88267.3818; val_edge_recon_loss: 2825696.1250; val_gene_expr_recon_loss: 12119242.5000; val_masked_gp_l1_reg_loss: 107082.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67524.9609; val_chrom_access_recon_loss: 2114898.4844; val_global_loss: 17322712.2500; val_optim_loss: 17322712.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8898; val_auprc_score: 0.8526; val_best_acc_score: 0.8326; val_best_f1_score: 0.8496; train_kl_reg_loss: 88821.4659; train_edge_recon_loss: 2783837.5492; train_gene_expr_recon_loss: 12087444.5606; train_masked_gp_l1_reg_loss: 107097.6245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66551.0800; train_chrom_access_recon_loss: 2102034.3769; train_global_loss: 17235786.7424; train_optim_loss: 17235786.7424; val_kl_reg_loss: 90351.8242; val_edge_recon_loss: 2836889.1250; val_gene_expr_recon_loss: 12204175.8750; val_masked_gp_l1_reg_loss: 107326.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65553.4844; val_chrom_access_recon_loss: 2126813.3125; val_global_loss: 17431109.3750; val_optim_loss: 17431109.3750
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9038; val_auprc_score: 0.8712; val_best_acc_score: 0.8426; val_best_f1_score: 0.8556; train_kl_reg_loss: 88743.2296; train_edge_recon_loss: 2769305.1402; train_gene_expr_recon_loss: 12052116.7121; train_masked_gp_l1_reg_loss: 107196.8062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64306.9390; train_chrom_access_recon_loss: 2096439.6307; train_global_loss: 17178108.4848; train_optim_loss: 17178108.4848; val_kl_reg_loss: 85329.2021; val_edge_recon_loss: 2801654.6875; val_gene_expr_recon_loss: 12050784.2500; val_masked_gp_l1_reg_loss: 107394.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63779.5039; val_chrom_access_recon_loss: 2092556.6875; val_global_loss: 17201500.0000; val_optim_loss: 17201500.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9078; val_auprc_score: 0.8683; val_best_acc_score: 0.8509; val_best_f1_score: 0.8612; train_kl_reg_loss: 86926.7635; train_edge_recon_loss: 2774630.9924; train_gene_expr_recon_loss: 12010721.7576; train_masked_gp_l1_reg_loss: 107299.5258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63044.3358; train_chrom_access_recon_loss: 2089136.7254; train_global_loss: 17131759.9545; train_optim_loss: 17131759.9545; val_kl_reg_loss: 90909.8799; val_edge_recon_loss: 2769586.5000; val_gene_expr_recon_loss: 12042251.2500; val_masked_gp_l1_reg_loss: 107303.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62276.3047; val_chrom_access_recon_loss: 2105752.6406; val_global_loss: 17178079.2500; val_optim_loss: 17178079.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9029; val_auprc_score: 0.8705; val_best_acc_score: 0.8477; val_best_f1_score: 0.8596; train_kl_reg_loss: 87150.4303; train_edge_recon_loss: 2749676.6477; train_gene_expr_recon_loss: 11966229.0152; train_masked_gp_l1_reg_loss: 107018.6849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61337.7656; train_chrom_access_recon_loss: 2083113.8314; train_global_loss: 17054526.3485; train_optim_loss: 17054526.3485; val_kl_reg_loss: 86834.4033; val_edge_recon_loss: 2797438.9375; val_gene_expr_recon_loss: 11973276.2500; val_masked_gp_l1_reg_loss: 107180.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60639.5312; val_chrom_access_recon_loss: 2087663.3281; val_global_loss: 17113034.1250; val_optim_loss: 17113034.1250
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9155; val_auprc_score: 0.8861; val_best_acc_score: 0.8619; val_best_f1_score: 0.8701; train_kl_reg_loss: 85266.5694; train_edge_recon_loss: 2764988.8258; train_gene_expr_recon_loss: 11940052.8182; train_masked_gp_l1_reg_loss: 107119.1845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60349.8158; train_chrom_access_recon_loss: 2078024.9886; train_global_loss: 17035802.1061; train_optim_loss: 17035802.1061; val_kl_reg_loss: 85934.8701; val_edge_recon_loss: 2781507.5312; val_gene_expr_recon_loss: 12034742.3750; val_masked_gp_l1_reg_loss: 107245.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59896.2344; val_chrom_access_recon_loss: 2082542.8750; val_global_loss: 17151869.3750; val_optim_loss: 17151869.3750
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9116; val_auprc_score: 0.8762; val_best_acc_score: 0.8552; val_best_f1_score: 0.8673; train_kl_reg_loss: 85504.6720; train_edge_recon_loss: 2760989.6061; train_gene_expr_recon_loss: 11907727.1364; train_masked_gp_l1_reg_loss: 107181.2599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59610.9198; train_chrom_access_recon_loss: 2073768.4583; train_global_loss: 16994782.0758; train_optim_loss: 16994782.0758; val_kl_reg_loss: 86625.6699; val_edge_recon_loss: 2829071.1562; val_gene_expr_recon_loss: 11926486.7500; val_masked_gp_l1_reg_loss: 107111.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59647.9258; val_chrom_access_recon_loss: 2086404.1719; val_global_loss: 17095347.0000; val_optim_loss: 17095347.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9203; val_auprc_score: 0.8955; val_best_acc_score: 0.8606; val_best_f1_score: 0.8714; train_kl_reg_loss: 85704.4658; train_edge_recon_loss: 2739565.6667; train_gene_expr_recon_loss: 11878484.5909; train_masked_gp_l1_reg_loss: 107451.5211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59430.0537; train_chrom_access_recon_loss: 2066822.0530; train_global_loss: 16937458.2576; train_optim_loss: 16937458.2576; val_kl_reg_loss: 85518.1455; val_edge_recon_loss: 2762608.0312; val_gene_expr_recon_loss: 11983669.2500; val_masked_gp_l1_reg_loss: 107470.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59000.8203; val_chrom_access_recon_loss: 2075265.6094; val_global_loss: 17073533.3750; val_optim_loss: 17073533.3750
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9156; val_auprc_score: 0.8871; val_best_acc_score: 0.8544; val_best_f1_score: 0.8643; train_kl_reg_loss: 83138.0755; train_edge_recon_loss: 2744916.4242; train_gene_expr_recon_loss: 11850080.0152; train_masked_gp_l1_reg_loss: 107377.5765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59460.3594; train_chrom_access_recon_loss: 2062276.2235; train_global_loss: 16907248.6970; train_optim_loss: 16907248.6970; val_kl_reg_loss: 83910.6973; val_edge_recon_loss: 2806293.7188; val_gene_expr_recon_loss: 11998850.1250; val_masked_gp_l1_reg_loss: 107509.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59937.9453; val_chrom_access_recon_loss: 2074832.2188; val_global_loss: 17131334.3750; val_optim_loss: 17131334.3750
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9310; val_auprc_score: 0.9076; val_best_acc_score: 0.8657; val_best_f1_score: 0.8743; train_kl_reg_loss: 82972.8265; train_edge_recon_loss: 2733858.8409; train_gene_expr_recon_loss: 11825663.2121; train_masked_gp_l1_reg_loss: 107636.1772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59973.3325; train_chrom_access_recon_loss: 2057830.4148; train_global_loss: 16867934.8788; train_optim_loss: 16867934.8788; val_kl_reg_loss: 82247.6660; val_edge_recon_loss: 2752054.4688; val_gene_expr_recon_loss: 11995919.7500; val_masked_gp_l1_reg_loss: 107759.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60265.3125; val_chrom_access_recon_loss: 2072430.8750; val_global_loss: 17070677.0000; val_optim_loss: 17070677.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9207; val_auprc_score: 0.8923; val_best_acc_score: 0.8622; val_best_f1_score: 0.8724; train_kl_reg_loss: 83037.4834; train_edge_recon_loss: 2739638.5947; train_gene_expr_recon_loss: 11806926.6667; train_masked_gp_l1_reg_loss: 107797.2616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60370.9616; train_chrom_access_recon_loss: 2054800.3864; train_global_loss: 16852571.3030; train_optim_loss: 16852571.3030; val_kl_reg_loss: 84514.3535; val_edge_recon_loss: 2782645.3750; val_gene_expr_recon_loss: 11854673.0000; val_masked_gp_l1_reg_loss: 107712.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60341.3008; val_chrom_access_recon_loss: 2065023.2344; val_global_loss: 16954910.3750; val_optim_loss: 16954910.3750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9300; val_auprc_score: 0.9032; val_best_acc_score: 0.8710; val_best_f1_score: 0.8798; train_kl_reg_loss: 84091.0739; train_edge_recon_loss: 2735400.0038; train_gene_expr_recon_loss: 11772761.4545; train_masked_gp_l1_reg_loss: 107920.7204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60443.7589; train_chrom_access_recon_loss: 2048474.3826; train_global_loss: 16809091.3636; train_optim_loss: 16809091.3636; val_kl_reg_loss: 85534.1475; val_edge_recon_loss: 2759546.0312; val_gene_expr_recon_loss: 11759416.1250; val_masked_gp_l1_reg_loss: 108154.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60634.9375; val_chrom_access_recon_loss: 2059989.4219; val_global_loss: 16833274.6250; val_optim_loss: 16833274.6250
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9340; val_auprc_score: 0.9037; val_best_acc_score: 0.8767; val_best_f1_score: 0.8821; train_kl_reg_loss: 81406.4961; train_edge_recon_loss: 2732907.2727; train_gene_expr_recon_loss: 11740567.8485; train_masked_gp_l1_reg_loss: 108100.5155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60584.3037; train_chrom_access_recon_loss: 2043332.6913; train_global_loss: 16766899.1212; train_optim_loss: 16766899.1212; val_kl_reg_loss: 84147.8848; val_edge_recon_loss: 2765040.2500; val_gene_expr_recon_loss: 11799535.1250; val_masked_gp_l1_reg_loss: 108290.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60790.7539; val_chrom_access_recon_loss: 2066353.2344; val_global_loss: 16884157.5000; val_optim_loss: 16884157.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9341; val_auprc_score: 0.9047; val_best_acc_score: 0.8761; val_best_f1_score: 0.8832; train_kl_reg_loss: 81669.6586; train_edge_recon_loss: 2722656.6894; train_gene_expr_recon_loss: 11717479.5152; train_masked_gp_l1_reg_loss: 108316.1142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60719.7341; train_chrom_access_recon_loss: 2038635.2140; train_global_loss: 16729477.0303; train_optim_loss: 16729477.0303; val_kl_reg_loss: 81585.3936; val_edge_recon_loss: 2774417.5312; val_gene_expr_recon_loss: 11821946.6250; val_masked_gp_l1_reg_loss: 108440.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60834.1992; val_chrom_access_recon_loss: 2056022.7812; val_global_loss: 16903246.2500; val_optim_loss: 16903246.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9345; val_auprc_score: 0.9145; val_best_acc_score: 0.8718; val_best_f1_score: 0.8798; train_kl_reg_loss: 81537.0882; train_edge_recon_loss: 2719848.7083; train_gene_expr_recon_loss: 11699400.5909; train_masked_gp_l1_reg_loss: 108445.1406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60583.7402; train_chrom_access_recon_loss: 2036172.6591; train_global_loss: 16705987.9394; train_optim_loss: 16705987.9394; val_kl_reg_loss: 85360.4082; val_edge_recon_loss: 2752102.3125; val_gene_expr_recon_loss: 11773411.1250; val_masked_gp_l1_reg_loss: 108652.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60856.6836; val_chrom_access_recon_loss: 2037800.6562; val_global_loss: 16818183.5000; val_optim_loss: 16818183.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9334; val_auprc_score: 0.9116; val_best_acc_score: 0.8794; val_best_f1_score: 0.8869; train_kl_reg_loss: 80835.0169; train_edge_recon_loss: 2710663.8977; train_gene_expr_recon_loss: 11685291.6364; train_masked_gp_l1_reg_loss: 108601.7069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60668.7901; train_chrom_access_recon_loss: 2031434.6174; train_global_loss: 16677495.6667; train_optim_loss: 16677495.6667; val_kl_reg_loss: 80219.6865; val_edge_recon_loss: 2775446.8750; val_gene_expr_recon_loss: 11738139.3750; val_masked_gp_l1_reg_loss: 108640.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60644.3086; val_chrom_access_recon_loss: 2059792.3281; val_global_loss: 16822882.0000; val_optim_loss: 16822882.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9350; val_auprc_score: 0.9075; val_best_acc_score: 0.8829; val_best_f1_score: 0.8871; train_kl_reg_loss: 79828.6946; train_edge_recon_loss: 2717184.7955; train_gene_expr_recon_loss: 11657237.8030; train_masked_gp_l1_reg_loss: 108827.5135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60575.0803; train_chrom_access_recon_loss: 2026937.9924; train_global_loss: 16650591.8939; train_optim_loss: 16650591.8939; val_kl_reg_loss: 82776.4717; val_edge_recon_loss: 2771888.0938; val_gene_expr_recon_loss: 11765227.1250; val_masked_gp_l1_reg_loss: 108874.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60620.8906; val_chrom_access_recon_loss: 2032344.3438; val_global_loss: 16821731.1250; val_optim_loss: 16821731.1250
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9432; val_auprc_score: 0.9200; val_best_acc_score: 0.8904; val_best_f1_score: 0.8969; train_kl_reg_loss: 79424.5314; train_edge_recon_loss: 2720414.9545; train_gene_expr_recon_loss: 11646198.4697; train_masked_gp_l1_reg_loss: 109090.5820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60416.6001; train_chrom_access_recon_loss: 2024228.6004; train_global_loss: 16639773.8030; train_optim_loss: 16639773.8030; val_kl_reg_loss: 80563.9014; val_edge_recon_loss: 2727134.0000; val_gene_expr_recon_loss: 11680427.7500; val_masked_gp_l1_reg_loss: 108989.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60000.7109; val_chrom_access_recon_loss: 2034672.4844; val_global_loss: 16691788.5000; val_optim_loss: 16691788.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9446; val_auprc_score: 0.9248; val_best_acc_score: 0.8890; val_best_f1_score: 0.8934; train_kl_reg_loss: 79105.0357; train_edge_recon_loss: 2713971.6098; train_gene_expr_recon_loss: 11628452.0152; train_masked_gp_l1_reg_loss: 109082.4522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60303.2232; train_chrom_access_recon_loss: 2020990.8295; train_global_loss: 16611905.1970; train_optim_loss: 16611905.1970; val_kl_reg_loss: 79197.7217; val_edge_recon_loss: 2756595.3125; val_gene_expr_recon_loss: 11651703.1250; val_masked_gp_l1_reg_loss: 109164.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60331.8594; val_chrom_access_recon_loss: 2026574.6875; val_global_loss: 16683566.6250; val_optim_loss: 16683566.6250
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9462; val_auprc_score: 0.9259; val_best_acc_score: 0.8928; val_best_f1_score: 0.8976; train_kl_reg_loss: 77760.4962; train_edge_recon_loss: 2712196.2689; train_gene_expr_recon_loss: 11618796.9091; train_masked_gp_l1_reg_loss: 109396.0870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60165.8835; train_chrom_access_recon_loss: 2019345.3788; train_global_loss: 16597660.9091; train_optim_loss: 16597660.9091; val_kl_reg_loss: 81101.4189; val_edge_recon_loss: 2733607.0938; val_gene_expr_recon_loss: 11733886.6250; val_masked_gp_l1_reg_loss: 109842.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60458.3711; val_chrom_access_recon_loss: 2035448.4062; val_global_loss: 16754343.6250; val_optim_loss: 16754343.6250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9500; val_auprc_score: 0.9303; val_best_acc_score: 0.8958; val_best_f1_score: 0.9021; train_kl_reg_loss: 78624.3011; train_edge_recon_loss: 2706474.0455; train_gene_expr_recon_loss: 11597630.0606; train_masked_gp_l1_reg_loss: 109695.2885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60018.7445; train_chrom_access_recon_loss: 2014072.9640; train_global_loss: 16566515.4545; train_optim_loss: 16566515.4545; val_kl_reg_loss: 79695.9580; val_edge_recon_loss: 2725349.9688; val_gene_expr_recon_loss: 11619671.7500; val_masked_gp_l1_reg_loss: 109861.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60068.2617; val_chrom_access_recon_loss: 2013441.0781; val_global_loss: 16608087.7500; val_optim_loss: 16608087.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9473; val_auprc_score: 0.9299; val_best_acc_score: 0.8907; val_best_f1_score: 0.8965; train_kl_reg_loss: 78710.3366; train_edge_recon_loss: 2710072.4545; train_gene_expr_recon_loss: 11584452.6970; train_masked_gp_l1_reg_loss: 109767.6069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59928.9654; train_chrom_access_recon_loss: 2011791.6761; train_global_loss: 16554723.7879; train_optim_loss: 16554723.7879; val_kl_reg_loss: 82012.9209; val_edge_recon_loss: 2749242.6250; val_gene_expr_recon_loss: 11718395.7500; val_masked_gp_l1_reg_loss: 109847.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59859.9688; val_chrom_access_recon_loss: 2040454.1562; val_global_loss: 16759812.1250; val_optim_loss: 16759812.1250
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9530; val_auprc_score: 0.9345; val_best_acc_score: 0.8992; val_best_f1_score: 0.9032; train_kl_reg_loss: 78844.2878; train_edge_recon_loss: 2699719.9962; train_gene_expr_recon_loss: 11578015.0152; train_masked_gp_l1_reg_loss: 109841.5196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59666.3271; train_chrom_access_recon_loss: 2010561.5133; train_global_loss: 16536648.6061; train_optim_loss: 16536648.6061; val_kl_reg_loss: 76653.9092; val_edge_recon_loss: 2722230.8750; val_gene_expr_recon_loss: 11682472.1250; val_masked_gp_l1_reg_loss: 109895.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59574.8320; val_chrom_access_recon_loss: 2014208.5000; val_global_loss: 16665036.5000; val_optim_loss: 16665036.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9456; val_auprc_score: 0.9232; val_best_acc_score: 0.8968; val_best_f1_score: 0.9016; train_kl_reg_loss: 76887.3842; train_edge_recon_loss: 2711524.3636; train_gene_expr_recon_loss: 11552764.5152; train_masked_gp_l1_reg_loss: 109968.8952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59577.0456; train_chrom_access_recon_loss: 2006180.4261; train_global_loss: 16516902.5152; train_optim_loss: 16516902.5152; val_kl_reg_loss: 80832.5459; val_edge_recon_loss: 2754017.1562; val_gene_expr_recon_loss: 11655770.0000; val_masked_gp_l1_reg_loss: 109939.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59572.2617; val_chrom_access_recon_loss: 2021160.3906; val_global_loss: 16681291.1250; val_optim_loss: 16681291.1250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9525; val_auprc_score: 0.9342; val_best_acc_score: 0.9001; val_best_f1_score: 0.9038; train_kl_reg_loss: 77678.2758; train_edge_recon_loss: 2705033.1894; train_gene_expr_recon_loss: 11546640.5303; train_masked_gp_l1_reg_loss: 109910.1977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59349.4474; train_chrom_access_recon_loss: 2004745.5038; train_global_loss: 16503357.1970; train_optim_loss: 16503357.1970; val_kl_reg_loss: 79136.1934; val_edge_recon_loss: 2743593.7188; val_gene_expr_recon_loss: 11674247.8750; val_masked_gp_l1_reg_loss: 110221.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59485.2617; val_chrom_access_recon_loss: 2015111.9844; val_global_loss: 16681796.0000; val_optim_loss: 16681796.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9524; val_auprc_score: 0.9292; val_best_acc_score: 0.9030; val_best_f1_score: 0.9078; train_kl_reg_loss: 77763.8660; train_edge_recon_loss: 2696343.9886; train_gene_expr_recon_loss: 11531980.8333; train_masked_gp_l1_reg_loss: 107258.4338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48613.4013; train_chrom_access_recon_loss: 2000373.5511; train_global_loss: 16462334.1818; train_optim_loss: 16462334.1818; val_kl_reg_loss: 81408.9150; val_edge_recon_loss: 2720095.4375; val_gene_expr_recon_loss: 11559536.8750; val_masked_gp_l1_reg_loss: 106016.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45839.5156; val_chrom_access_recon_loss: 2005507.9219; val_global_loss: 16518406.0000; val_optim_loss: 16518406.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9493; val_auprc_score: 0.9240; val_best_acc_score: 0.8998; val_best_f1_score: 0.9036; train_kl_reg_loss: 79996.5134; train_edge_recon_loss: 2701508.8826; train_gene_expr_recon_loss: 11519935.5909; train_masked_gp_l1_reg_loss: 105830.4157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45477.9342; train_chrom_access_recon_loss: 1997953.6136; train_global_loss: 16450702.9848; train_optim_loss: 16450702.9848; val_kl_reg_loss: 81923.5850; val_edge_recon_loss: 2736872.6250; val_gene_expr_recon_loss: 11654640.7500; val_masked_gp_l1_reg_loss: 105714.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45275.0703; val_chrom_access_recon_loss: 2026098.4062; val_global_loss: 16650524.2500; val_optim_loss: 16650524.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9498; val_auprc_score: 0.9296; val_best_acc_score: 0.9009; val_best_f1_score: 0.9047; train_kl_reg_loss: 80536.8233; train_edge_recon_loss: 2697837.1970; train_gene_expr_recon_loss: 11520640.5758; train_masked_gp_l1_reg_loss: 105682.1900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45106.1562; train_chrom_access_recon_loss: 1995721.7860; train_global_loss: 16445524.6061; train_optim_loss: 16445524.6061; val_kl_reg_loss: 82467.6016; val_edge_recon_loss: 2713279.8750; val_gene_expr_recon_loss: 11636932.6250; val_masked_gp_l1_reg_loss: 105645.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44962.9375; val_chrom_access_recon_loss: 2009443.5625; val_global_loss: 16592732.2500; val_optim_loss: 16592732.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9529; val_auprc_score: 0.9327; val_best_acc_score: 0.9001; val_best_f1_score: 0.9050; train_kl_reg_loss: 81104.6396; train_edge_recon_loss: 2695738.4886; train_gene_expr_recon_loss: 11528227.3939; train_masked_gp_l1_reg_loss: 105587.2764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44874.7255; train_chrom_access_recon_loss: 1998999.7121; train_global_loss: 16454532.3182; train_optim_loss: 16454532.3182; val_kl_reg_loss: 82401.0371; val_edge_recon_loss: 2717440.9062; val_gene_expr_recon_loss: 11590536.8750; val_masked_gp_l1_reg_loss: 105576.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44774.9570; val_chrom_access_recon_loss: 2020499.5938; val_global_loss: 16561230.7500; val_optim_loss: 16561230.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9497; val_auprc_score: 0.9301; val_best_acc_score: 0.8982; val_best_f1_score: 0.9039; train_kl_reg_loss: 81677.8551; train_edge_recon_loss: 2694865.8939; train_gene_expr_recon_loss: 11529380.9545; train_masked_gp_l1_reg_loss: 105542.4728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44675.5900; train_chrom_access_recon_loss: 1999198.3561; train_global_loss: 16455341.0758; train_optim_loss: 16455341.0758; val_kl_reg_loss: 82885.0879; val_edge_recon_loss: 2721996.3125; val_gene_expr_recon_loss: 11545259.0000; val_masked_gp_l1_reg_loss: 105527.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44604.2539; val_chrom_access_recon_loss: 2000022.9844; val_global_loss: 16500294.5000; val_optim_loss: 16500294.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9442; val_auprc_score: 0.9222; val_best_acc_score: 0.8931; val_best_f1_score: 0.8995; train_kl_reg_loss: 81165.9974; train_edge_recon_loss: 2691785.5947; train_gene_expr_recon_loss: 11527733.1667; train_masked_gp_l1_reg_loss: 105486.1692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44545.6119; train_chrom_access_recon_loss: 2000141.4356; train_global_loss: 16450857.9394; train_optim_loss: 16450857.9394; val_kl_reg_loss: 83048.6377; val_edge_recon_loss: 2736295.4688; val_gene_expr_recon_loss: 11620810.3750; val_masked_gp_l1_reg_loss: 105489.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44497.2500; val_chrom_access_recon_loss: 2002634.1875; val_global_loss: 16592774.7500; val_optim_loss: 16592774.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9477; val_auprc_score: 0.9230; val_best_acc_score: 0.8936; val_best_f1_score: 0.8997; train_kl_reg_loss: 81022.9147; train_edge_recon_loss: 2689630.5000; train_gene_expr_recon_loss: 11510340.6667; train_masked_gp_l1_reg_loss: 105489.1177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44424.5839; train_chrom_access_recon_loss: 1995267.2405; train_global_loss: 16426174.8939; train_optim_loss: 16426174.8939; val_kl_reg_loss: 82686.6777; val_edge_recon_loss: 2730409.2500; val_gene_expr_recon_loss: 11610893.3750; val_masked_gp_l1_reg_loss: 105479.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44359.4961; val_chrom_access_recon_loss: 2017104.1406; val_global_loss: 16590931.5000; val_optim_loss: 16590931.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9522; val_auprc_score: 0.9292; val_best_acc_score: 0.9011; val_best_f1_score: 0.9050; train_kl_reg_loss: 80974.4664; train_edge_recon_loss: 2695458.0644; train_gene_expr_recon_loss: 11514169.0152; train_masked_gp_l1_reg_loss: 105475.5780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44312.6539; train_chrom_access_recon_loss: 1998013.5303; train_global_loss: 16438403.2576; train_optim_loss: 16438403.2576; val_kl_reg_loss: 82516.6797; val_edge_recon_loss: 2732512.0312; val_gene_expr_recon_loss: 11497664.0000; val_masked_gp_l1_reg_loss: 105462.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44276.8984; val_chrom_access_recon_loss: 1996603.0469; val_global_loss: 16459034.7500; val_optim_loss: 16459034.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9501; val_auprc_score: 0.9256; val_best_acc_score: 0.9011; val_best_f1_score: 0.9058; train_kl_reg_loss: 80843.8105; train_edge_recon_loss: 2695555.2311; train_gene_expr_recon_loss: 11517860.4848; train_masked_gp_l1_reg_loss: 105427.0028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44218.8108; train_chrom_access_recon_loss: 1996917.1705; train_global_loss: 16440822.4394; train_optim_loss: 16440822.4394; val_kl_reg_loss: 82275.1562; val_edge_recon_loss: 2747450.2812; val_gene_expr_recon_loss: 11660128.1250; val_masked_gp_l1_reg_loss: 105415.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44170.6055; val_chrom_access_recon_loss: 2015141.3594; val_global_loss: 16654582.0000; val_optim_loss: 16654582.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9522; val_auprc_score: 0.9325; val_best_acc_score: 0.8976; val_best_f1_score: 0.9027; train_kl_reg_loss: 80138.1213; train_edge_recon_loss: 2697323.3826; train_gene_expr_recon_loss: 11512766.1212; train_masked_gp_l1_reg_loss: 105435.5175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44129.5275; train_chrom_access_recon_loss: 1996393.9318; train_global_loss: 16436186.6212; train_optim_loss: 16436186.6212; val_kl_reg_loss: 82084.0000; val_edge_recon_loss: 2742246.7812; val_gene_expr_recon_loss: 11595519.7500; val_masked_gp_l1_reg_loss: 105437.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44094.1172; val_chrom_access_recon_loss: 2025203.1406; val_global_loss: 16594585.2500; val_optim_loss: 16594585.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9509; val_auprc_score: 0.9279; val_best_acc_score: 0.8974; val_best_f1_score: 0.9033; train_kl_reg_loss: 80647.4570; train_edge_recon_loss: 2684877.6136; train_gene_expr_recon_loss: 11511396.7576; train_masked_gp_l1_reg_loss: 105446.0481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44046.8304; train_chrom_access_recon_loss: 1994127.3598; train_global_loss: 16420542.0758; train_optim_loss: 16420542.0758; val_kl_reg_loss: 83011.3008; val_edge_recon_loss: 2736063.4688; val_gene_expr_recon_loss: 11547042.7500; val_masked_gp_l1_reg_loss: 105454.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44003.0781; val_chrom_access_recon_loss: 2006877.5156; val_global_loss: 16522452.8750; val_optim_loss: 16522452.8750
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9497; val_auprc_score: 0.9233; val_best_acc_score: 0.9035; val_best_f1_score: 0.9079; train_kl_reg_loss: 81103.0749; train_edge_recon_loss: 2695823.1970; train_gene_expr_recon_loss: 11505169.0152; train_masked_gp_l1_reg_loss: 105445.1352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43946.0336; train_chrom_access_recon_loss: 1993922.4261; train_global_loss: 16425408.8636; train_optim_loss: 16425408.8636; val_kl_reg_loss: 82911.5791; val_edge_recon_loss: 2733295.3750; val_gene_expr_recon_loss: 11494785.8750; val_masked_gp_l1_reg_loss: 105429.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43872.6133; val_chrom_access_recon_loss: 2005812.5469; val_global_loss: 16466108.1250; val_optim_loss: 16466108.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9514; val_auprc_score: 0.9301; val_best_acc_score: 0.9009; val_best_f1_score: 0.9055; train_kl_reg_loss: 81012.0573; train_edge_recon_loss: 2697850.1515; train_gene_expr_recon_loss: 11517105.9848; train_masked_gp_l1_reg_loss: 105107.1766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42831.6003; train_chrom_access_recon_loss: 1996733.5095; train_global_loss: 16440640.4242; train_optim_loss: 16440640.4242; val_kl_reg_loss: 82496.6650; val_edge_recon_loss: 2715456.3750; val_gene_expr_recon_loss: 11606791.8750; val_masked_gp_l1_reg_loss: 104956.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42588.1055; val_chrom_access_recon_loss: 2005685.7969; val_global_loss: 16557975.7500; val_optim_loss: 16557975.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9538; val_auprc_score: 0.9347; val_best_acc_score: 0.9054; val_best_f1_score: 0.9080; train_kl_reg_loss: 80825.4287; train_edge_recon_loss: 2688421.2879; train_gene_expr_recon_loss: 11512610.6515; train_masked_gp_l1_reg_loss: 104920.2597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42554.8523; train_chrom_access_recon_loss: 1995286.5549; train_global_loss: 16424619.0152; train_optim_loss: 16424619.0152; val_kl_reg_loss: 82893.5732; val_edge_recon_loss: 2707727.7812; val_gene_expr_recon_loss: 11548876.3750; val_masked_gp_l1_reg_loss: 104896.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42530.8555; val_chrom_access_recon_loss: 2017703.8750; val_global_loss: 16504629.6250; val_optim_loss: 16504629.6250
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9509; val_auprc_score: 0.9279; val_best_acc_score: 0.8995; val_best_f1_score: 0.9051; train_kl_reg_loss: 80796.3491; train_edge_recon_loss: 2691174.2348; train_gene_expr_recon_loss: 11509230.1667; train_masked_gp_l1_reg_loss: 104884.8013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42512.8002; train_chrom_access_recon_loss: 1994374.7746; train_global_loss: 16422973.0758; train_optim_loss: 16422973.0758; val_kl_reg_loss: 83056.1973; val_edge_recon_loss: 2720700.0938; val_gene_expr_recon_loss: 11719317.3750; val_masked_gp_l1_reg_loss: 104876.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42497.8633; val_chrom_access_recon_loss: 2051111.7812; val_global_loss: 16721559.3750; val_optim_loss: 16721559.3750
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9541; val_auprc_score: 0.9380; val_best_acc_score: 0.8995; val_best_f1_score: 0.9042; train_kl_reg_loss: 80975.0661; train_edge_recon_loss: 2696229.4394; train_gene_expr_recon_loss: 11508144.3636; train_masked_gp_l1_reg_loss: 104868.0251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42485.7573; train_chrom_access_recon_loss: 1994055.2481; train_global_loss: 16426757.8636; train_optim_loss: 16426757.8636; val_kl_reg_loss: 83392.0928; val_edge_recon_loss: 2719954.5938; val_gene_expr_recon_loss: 11671179.6250; val_masked_gp_l1_reg_loss: 104858.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42472.4219; val_chrom_access_recon_loss: 2026357.1094; val_global_loss: 16648213.5000; val_optim_loss: 16648213.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 5 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9513
val AUPRC score: 0.9270
val best accuracy score: 0.9001
val best F1 score: 0.9041
val target rna MSE score: 1.2041
val source rna MSE score: 0.6966
val target atac MSE score: 0.3246
val source atac MSE score: 0.1329
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
