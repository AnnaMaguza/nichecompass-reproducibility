[True]
Run timestamp: 07082023_182932_40.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_40']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8885; val_auprc_score: 0.8964; val_best_acc_score: 0.5071; val_best_f1_score: 0.6698; train_kl_reg_loss: 7989.4644; train_edge_recon_loss: 35419.3589; train_gene_expr_recon_loss: 650712.1597; train_masked_gp_l1_reg_loss: 8334.8868; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 267527.9149; train_global_loss: 969983.7778; train_optim_loss: 969983.7778; val_kl_reg_loss: 8180.5781; val_edge_recon_loss: 40650.4844; val_gene_expr_recon_loss: 592802.6875; val_masked_gp_l1_reg_loss: 6494.4082; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 263709.8438; val_global_loss: 911838.0000; val_optim_loss: 911838.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8648; val_auprc_score: 0.8658; val_best_acc_score: 0.5085; val_best_f1_score: 0.6704; train_kl_reg_loss: 13407.0805; train_edge_recon_loss: 37694.4314; train_gene_expr_recon_loss: 566427.6319; train_masked_gp_l1_reg_loss: 5932.9950; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 263290.4479; train_global_loss: 886752.5972; train_optim_loss: 886752.5972; val_kl_reg_loss: 17189.2344; val_edge_recon_loss: 40651.3438; val_gene_expr_recon_loss: 535231.8125; val_masked_gp_l1_reg_loss: 5557.5000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 258643.8281; val_global_loss: 857273.6875; val_optim_loss: 857273.6875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8608; val_auprc_score: 0.8568; val_best_acc_score: 0.5202; val_best_f1_score: 0.6752; train_kl_reg_loss: 18279.4397; train_edge_recon_loss: 38532.9397; train_gene_expr_recon_loss: 517847.7951; train_masked_gp_l1_reg_loss: 5690.4284; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256686.9792; train_global_loss: 837037.5833; train_optim_loss: 837037.5833; val_kl_reg_loss: 21021.4297; val_edge_recon_loss: 40640.8984; val_gene_expr_recon_loss: 498374.6875; val_masked_gp_l1_reg_loss: 5879.7358; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 254472.2656; val_global_loss: 820389.0000; val_optim_loss: 820389.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8653; val_auprc_score: 0.8618; val_best_acc_score: 0.5410; val_best_f1_score: 0.6844; train_kl_reg_loss: 22800.8184; train_edge_recon_loss: 38956.3351; train_gene_expr_recon_loss: 487476.3333; train_masked_gp_l1_reg_loss: 5884.3717; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 253858.4497; train_global_loss: 808976.3194; train_optim_loss: 808976.3194; val_kl_reg_loss: 21752.4766; val_edge_recon_loss: 40627.0000; val_gene_expr_recon_loss: 477402.3750; val_masked_gp_l1_reg_loss: 5831.5010; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251506.2812; val_global_loss: 797119.6250; val_optim_loss: 797119.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8680; val_auprc_score: 0.8594; val_best_acc_score: 0.5806; val_best_f1_score: 0.7016; train_kl_reg_loss: 22282.0666; train_edge_recon_loss: 38867.1884; train_gene_expr_recon_loss: 470412.1875; train_masked_gp_l1_reg_loss: 5798.4627; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251486.8785; train_global_loss: 788846.7778; train_optim_loss: 788846.7778; val_kl_reg_loss: 20880.0938; val_edge_recon_loss: 40592.6836; val_gene_expr_recon_loss: 463469.0625; val_masked_gp_l1_reg_loss: 5761.3857; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249427.8281; val_global_loss: 780131.0000; val_optim_loss: 780131.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8834; val_auprc_score: 0.8771; val_best_acc_score: 0.6400; val_best_f1_score: 0.7306; train_kl_reg_loss: 22090.9989; train_edge_recon_loss: 38858.0221; train_gene_expr_recon_loss: 456714.8403; train_masked_gp_l1_reg_loss: 5742.7830; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248816.0052; train_global_loss: 772222.6528; train_optim_loss: 772222.6528; val_kl_reg_loss: 21532.7070; val_edge_recon_loss: 40544.9766; val_gene_expr_recon_loss: 452331.5938; val_masked_gp_l1_reg_loss: 5709.2168; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247584.7344; val_global_loss: 767703.2500; val_optim_loss: 767703.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8839; val_auprc_score: 0.8712; val_best_acc_score: 0.6729; val_best_f1_score: 0.7478; train_kl_reg_loss: 22693.0124; train_edge_recon_loss: 38881.4240; train_gene_expr_recon_loss: 449910.6771; train_masked_gp_l1_reg_loss: 5688.2464; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246581.7969; train_global_loss: 763755.1389; train_optim_loss: 763755.1389; val_kl_reg_loss: 22587.2500; val_edge_recon_loss: 40516.7461; val_gene_expr_recon_loss: 443048.2812; val_masked_gp_l1_reg_loss: 5657.7935; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245916.5938; val_global_loss: 757726.6250; val_optim_loss: 757726.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8875; val_auprc_score: 0.8797; val_best_acc_score: 0.7324; val_best_f1_score: 0.7808; train_kl_reg_loss: 23166.6243; train_edge_recon_loss: 38923.5703; train_gene_expr_recon_loss: 438384.7188; train_masked_gp_l1_reg_loss: 5646.1906; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244794.9809; train_global_loss: 750916.0764; train_optim_loss: 750916.0764; val_kl_reg_loss: 22588.0234; val_edge_recon_loss: 40461.0234; val_gene_expr_recon_loss: 436366.2500; val_masked_gp_l1_reg_loss: 5628.4087; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244455.4219; val_global_loss: 749499.1250; val_optim_loss: 749499.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8983; val_auprc_score: 0.8938; val_best_acc_score: 0.7788; val_best_f1_score: 0.8084; train_kl_reg_loss: 23391.4503; train_edge_recon_loss: 38912.7695; train_gene_expr_recon_loss: 432893.5729; train_masked_gp_l1_reg_loss: 5625.4275; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244049.6372; train_global_loss: 744872.8472; train_optim_loss: 744872.8472; val_kl_reg_loss: 22928.9883; val_edge_recon_loss: 40388.6484; val_gene_expr_recon_loss: 430781.5000; val_masked_gp_l1_reg_loss: 5619.1011; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 242970.6250; val_global_loss: 742688.8750; val_optim_loss: 742688.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9034; val_auprc_score: 0.8937; val_best_acc_score: 0.8126; val_best_f1_score: 0.8292; train_kl_reg_loss: 23658.8919; train_edge_recon_loss: 38882.4618; train_gene_expr_recon_loss: 427467.0451; train_masked_gp_l1_reg_loss: 5622.2606; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243012.0139; train_global_loss: 738642.6597; train_optim_loss: 738642.6597; val_kl_reg_loss: 22477.0254; val_edge_recon_loss: 40299.4258; val_gene_expr_recon_loss: 426933.9375; val_masked_gp_l1_reg_loss: 5619.5430; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241776.6562; val_global_loss: 737106.5625; val_optim_loss: 737106.5625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9142; val_auprc_score: 0.9083; val_best_acc_score: 0.8347; val_best_f1_score: 0.8435; train_kl_reg_loss: 23698.2478; train_edge_recon_loss: 38866.8550; train_gene_expr_recon_loss: 423861.6389; train_masked_gp_l1_reg_loss: 5621.8861; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241239.2517; train_global_loss: 733287.8819; train_optim_loss: 733287.8819; val_kl_reg_loss: 22328.8008; val_edge_recon_loss: 40231.8633; val_gene_expr_recon_loss: 423445.8125; val_masked_gp_l1_reg_loss: 5619.7471; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240528.9062; val_global_loss: 732155.1250; val_optim_loss: 732155.1250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9177; val_auprc_score: 0.9064; val_best_acc_score: 0.8494; val_best_f1_score: 0.8530; train_kl_reg_loss: 23607.9614; train_edge_recon_loss: 38810.5634; train_gene_expr_recon_loss: 419980.2882; train_masked_gp_l1_reg_loss: 5628.0572; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240465.6458; train_global_loss: 728492.5347; train_optim_loss: 728492.5347; val_kl_reg_loss: 21903.6914; val_edge_recon_loss: 40162.2852; val_gene_expr_recon_loss: 420841.6875; val_masked_gp_l1_reg_loss: 5626.5039; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239604.6562; val_global_loss: 728138.8125; val_optim_loss: 728138.8125
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9221; val_auprc_score: 0.9153; val_best_acc_score: 0.8537; val_best_f1_score: 0.8554; train_kl_reg_loss: 23296.8123; train_edge_recon_loss: 38780.6024; train_gene_expr_recon_loss: 421222.9306; train_masked_gp_l1_reg_loss: 5632.1018; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240002.5122; train_global_loss: 728934.9375; train_optim_loss: 728934.9375; val_kl_reg_loss: 22598.3555; val_edge_recon_loss: 40139.7656; val_gene_expr_recon_loss: 417379.7500; val_masked_gp_l1_reg_loss: 5636.5107; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238457.1094; val_global_loss: 724211.5000; val_optim_loss: 724211.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9234; val_auprc_score: 0.9109; val_best_acc_score: 0.8554; val_best_f1_score: 0.8549; train_kl_reg_loss: 23137.5916; train_edge_recon_loss: 38743.2943; train_gene_expr_recon_loss: 416752.1042; train_masked_gp_l1_reg_loss: 5648.4305; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238722.4757; train_global_loss: 723003.8958; train_optim_loss: 723003.8958; val_kl_reg_loss: 21920.4023; val_edge_recon_loss: 40089.1211; val_gene_expr_recon_loss: 415586.5625; val_masked_gp_l1_reg_loss: 5657.0679; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237566.7969; val_global_loss: 720819.9375; val_optim_loss: 720819.9375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9341; val_auprc_score: 0.9277; val_best_acc_score: 0.8622; val_best_f1_score: 0.8587; train_kl_reg_loss: 22700.7973; train_edge_recon_loss: 38693.0825; train_gene_expr_recon_loss: 415547.2604; train_masked_gp_l1_reg_loss: 5668.7924; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237561.6059; train_global_loss: 720171.5278; train_optim_loss: 720171.5278; val_kl_reg_loss: 21439.5664; val_edge_recon_loss: 40039.6562; val_gene_expr_recon_loss: 413951.0000; val_masked_gp_l1_reg_loss: 5675.2593; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 236817.3125; val_global_loss: 717922.7500; val_optim_loss: 717922.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9270; val_auprc_score: 0.9119; val_best_acc_score: 0.8494; val_best_f1_score: 0.8456; train_kl_reg_loss: 22401.3220; train_edge_recon_loss: 38642.5217; train_gene_expr_recon_loss: 413823.8542; train_masked_gp_l1_reg_loss: 5686.4162; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236487.1962; train_global_loss: 717041.2917; train_optim_loss: 717041.2917; val_kl_reg_loss: 21133.0938; val_edge_recon_loss: 39964.4727; val_gene_expr_recon_loss: 412267.1875; val_masked_gp_l1_reg_loss: 5694.4199; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 236022.1875; val_global_loss: 715081.3750; val_optim_loss: 715081.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9401; val_auprc_score: 0.9314; val_best_acc_score: 0.8603; val_best_f1_score: 0.8532; train_kl_reg_loss: 22076.0030; train_edge_recon_loss: 38598.6849; train_gene_expr_recon_loss: 408694.8090; train_masked_gp_l1_reg_loss: 5704.4358; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 235925.4531; train_global_loss: 710999.3889; train_optim_loss: 710999.3889; val_kl_reg_loss: 20547.4297; val_edge_recon_loss: 39912.8906; val_gene_expr_recon_loss: 411124.3750; val_masked_gp_l1_reg_loss: 5709.7617; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235378.3125; val_global_loss: 712672.7500; val_optim_loss: 712672.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9387; val_auprc_score: 0.9305; val_best_acc_score: 0.8517; val_best_f1_score: 0.8426; train_kl_reg_loss: 21746.5738; train_edge_recon_loss: 38542.2109; train_gene_expr_recon_loss: 409082.3924; train_masked_gp_l1_reg_loss: 5718.7686; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234698.4826; train_global_loss: 709788.4236; train_optim_loss: 709788.4236; val_kl_reg_loss: 20093.2969; val_edge_recon_loss: 39861.7812; val_gene_expr_recon_loss: 410033.1875; val_masked_gp_l1_reg_loss: 5721.1255; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 234748.0469; val_global_loss: 710457.4375; val_optim_loss: 710457.4375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9400; val_auprc_score: 0.9302; val_best_acc_score: 0.8463; val_best_f1_score: 0.8354; train_kl_reg_loss: 21408.0668; train_edge_recon_loss: 38487.2448; train_gene_expr_recon_loss: 408263.9375; train_masked_gp_l1_reg_loss: 5731.5128; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 235020.2934; train_global_loss: 708911.0625; train_optim_loss: 708911.0625; val_kl_reg_loss: 19861.5273; val_edge_recon_loss: 39784.1484; val_gene_expr_recon_loss: 408804.1250; val_masked_gp_l1_reg_loss: 5738.4668; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 234114.8750; val_global_loss: 708303.1250; val_optim_loss: 708303.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9436; val_auprc_score: 0.9363; val_best_acc_score: 0.8472; val_best_f1_score: 0.8349; train_kl_reg_loss: 21158.4779; train_edge_recon_loss: 38444.7873; train_gene_expr_recon_loss: 407237.2604; train_masked_gp_l1_reg_loss: 5748.8924; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234997.2309; train_global_loss: 707586.6597; train_optim_loss: 707586.6597; val_kl_reg_loss: 19547.6055; val_edge_recon_loss: 39760.2773; val_gene_expr_recon_loss: 407715.0625; val_masked_gp_l1_reg_loss: 5757.0771; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233579.3906; val_global_loss: 706359.3750; val_optim_loss: 706359.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9440; val_auprc_score: 0.9356; val_best_acc_score: 0.8441; val_best_f1_score: 0.8411; train_kl_reg_loss: 20857.3620; train_edge_recon_loss: 38406.3681; train_gene_expr_recon_loss: 405295.1319; train_masked_gp_l1_reg_loss: 5767.3560; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233597.7031; train_global_loss: 703923.9097; train_optim_loss: 703923.9097; val_kl_reg_loss: 19101.5898; val_edge_recon_loss: 39719.8242; val_gene_expr_recon_loss: 406887.4375; val_masked_gp_l1_reg_loss: 5770.0005; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232974.5781; val_global_loss: 704453.4375; val_optim_loss: 704453.4375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9429; val_auprc_score: 0.9318; val_best_acc_score: 0.8441; val_best_f1_score: 0.8427; train_kl_reg_loss: 20503.6964; train_edge_recon_loss: 38364.0642; train_gene_expr_recon_loss: 403989.4444; train_masked_gp_l1_reg_loss: 5781.0170; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 232594.4288; train_global_loss: 701232.6528; train_optim_loss: 701232.6528; val_kl_reg_loss: 19268.0352; val_edge_recon_loss: 39695.1016; val_gene_expr_recon_loss: 405510.4062; val_masked_gp_l1_reg_loss: 5785.2939; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232391.1406; val_global_loss: 702649.9375; val_optim_loss: 702649.9375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9496; val_auprc_score: 0.9436; val_best_acc_score: 0.8430; val_best_f1_score: 0.8513; train_kl_reg_loss: 20272.6608; train_edge_recon_loss: 38338.6528; train_gene_expr_recon_loss: 401876.9826; train_masked_gp_l1_reg_loss: 5795.2273; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 231982.2205; train_global_loss: 698265.7361; train_optim_loss: 698265.7361; val_kl_reg_loss: 18855.7109; val_edge_recon_loss: 39638.5547; val_gene_expr_recon_loss: 404953.0000; val_masked_gp_l1_reg_loss: 5802.4414; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231905.6562; val_global_loss: 701155.3750; val_optim_loss: 701155.3750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9484; val_auprc_score: 0.9393; val_best_acc_score: 0.8385; val_best_f1_score: 0.8572; train_kl_reg_loss: 20058.9989; train_edge_recon_loss: 38282.2235; train_gene_expr_recon_loss: 402881.8715; train_masked_gp_l1_reg_loss: 5813.0074; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 230860.2014; train_global_loss: 697896.2986; train_optim_loss: 697896.2986; val_kl_reg_loss: 18527.0547; val_edge_recon_loss: 39601.6602; val_gene_expr_recon_loss: 404135.4375; val_masked_gp_l1_reg_loss: 5816.3613; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231480.5938; val_global_loss: 699561.1250; val_optim_loss: 699561.1250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9507; val_auprc_score: 0.9444; val_best_acc_score: 0.8375; val_best_f1_score: 0.8576; train_kl_reg_loss: 19773.5482; train_edge_recon_loss: 38238.8164; train_gene_expr_recon_loss: 401666.2326; train_masked_gp_l1_reg_loss: 5827.5385; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 230685.0573; train_global_loss: 696191.1806; train_optim_loss: 696191.1806; val_kl_reg_loss: 18127.2715; val_edge_recon_loss: 39575.5430; val_gene_expr_recon_loss: 403682.2500; val_masked_gp_l1_reg_loss: 5832.8486; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 230968.3594; val_global_loss: 698186.2500; val_optim_loss: 698186.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9479; val_auprc_score: 0.9390; val_best_acc_score: 0.8820; val_best_f1_score: 0.8832; train_kl_reg_loss: 19759.6317; train_edge_recon_loss: 39946.4918; train_gene_expr_recon_loss: 410998.7326; train_masked_gp_l1_reg_loss: 5845.8433; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233246.5972; train_global_loss: 709797.2986; train_optim_loss: 709797.2986; val_kl_reg_loss: 15923.7754; val_edge_recon_loss: 40196.5547; val_gene_expr_recon_loss: 409927.5000; val_masked_gp_l1_reg_loss: 5841.4897; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233124.8750; val_global_loss: 705014.1875; val_optim_loss: 705014.1875
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9481; val_auprc_score: 0.9416; val_best_acc_score: 0.8770; val_best_f1_score: 0.8781; train_kl_reg_loss: 18334.1747; train_edge_recon_loss: 39972.5122; train_gene_expr_recon_loss: 408541.8889; train_masked_gp_l1_reg_loss: 5837.9728; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 231926.8003; train_global_loss: 704613.3542; train_optim_loss: 704613.3542; val_kl_reg_loss: 16592.7461; val_edge_recon_loss: 40167.8320; val_gene_expr_recon_loss: 407544.5938; val_masked_gp_l1_reg_loss: 5826.1611; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232418.1094; val_global_loss: 702549.4375; val_optim_loss: 702549.4375
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9503; val_auprc_score: 0.9444; val_best_acc_score: 0.8769; val_best_f1_score: 0.8757; train_kl_reg_loss: 17713.9635; train_edge_recon_loss: 39898.4453; train_gene_expr_recon_loss: 409078.6111; train_masked_gp_l1_reg_loss: 5820.5359; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 232387.0382; train_global_loss: 704898.5833; train_optim_loss: 704898.5833; val_kl_reg_loss: 16679.1602; val_edge_recon_loss: 40103.5352; val_gene_expr_recon_loss: 406321.0312; val_masked_gp_l1_reg_loss: 5810.2612; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231958.0312; val_global_loss: 700872.0000; val_optim_loss: 700872.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9483; val_auprc_score: 0.9363; val_best_acc_score: 0.8723; val_best_f1_score: 0.8690; train_kl_reg_loss: 17306.6382; train_edge_recon_loss: 39833.4288; train_gene_expr_recon_loss: 404472.3056; train_masked_gp_l1_reg_loss: 5807.3332; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 231983.5260; train_global_loss: 699403.2153; train_optim_loss: 699403.2153; val_kl_reg_loss: 16080.1699; val_edge_recon_loss: 40024.4023; val_gene_expr_recon_loss: 405933.3125; val_masked_gp_l1_reg_loss: 5800.7578; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231696.6094; val_global_loss: 699535.2500; val_optim_loss: 699535.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9539; val_auprc_score: 0.9480; val_best_acc_score: 0.8751; val_best_f1_score: 0.8714; train_kl_reg_loss: 17185.2771; train_edge_recon_loss: 39792.4796; train_gene_expr_recon_loss: 405439.6944; train_masked_gp_l1_reg_loss: 5764.4302; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 232047.3212; train_global_loss: 700229.1944; train_optim_loss: 700229.1944; val_kl_reg_loss: 16115.9121; val_edge_recon_loss: 39992.3984; val_gene_expr_recon_loss: 405754.9375; val_masked_gp_l1_reg_loss: 5732.4468; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231654.9844; val_global_loss: 699250.6875; val_optim_loss: 699250.6875
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9506; val_auprc_score: 0.9452; val_best_acc_score: 0.8738; val_best_f1_score: 0.8700; train_kl_reg_loss: 17139.2791; train_edge_recon_loss: 39791.2595; train_gene_expr_recon_loss: 405184.0104; train_masked_gp_l1_reg_loss: 5723.8094; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 231378.2743; train_global_loss: 699216.6389; train_optim_loss: 699216.6389; val_kl_reg_loss: 16045.1719; val_edge_recon_loss: 40014.6055; val_gene_expr_recon_loss: 405703.4375; val_masked_gp_l1_reg_loss: 5709.9873; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231599.6406; val_global_loss: 699072.8750; val_optim_loss: 699072.8750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9503; val_auprc_score: 0.9452; val_best_acc_score: 0.8735; val_best_f1_score: 0.8696; train_kl_reg_loss: 17069.4800; train_edge_recon_loss: 39786.3433; train_gene_expr_recon_loss: 404289.8785; train_masked_gp_l1_reg_loss: 5702.7555; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 231982.0052; train_global_loss: 698830.4514; train_optim_loss: 698830.4514; val_kl_reg_loss: 16099.9102; val_edge_recon_loss: 40015.5703; val_gene_expr_recon_loss: 405559.5000; val_masked_gp_l1_reg_loss: 5694.6294; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231551.6406; val_global_loss: 698921.2500; val_optim_loss: 698921.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9532; val_auprc_score: 0.9468; val_best_acc_score: 0.8748; val_best_f1_score: 0.8705; train_kl_reg_loss: 17096.0215; train_edge_recon_loss: 39782.7995; train_gene_expr_recon_loss: 402842.7188; train_masked_gp_l1_reg_loss: 5690.0730; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 231804.9392; train_global_loss: 697216.5625; train_optim_loss: 697216.5625; val_kl_reg_loss: 15981.6992; val_edge_recon_loss: 39992.1797; val_gene_expr_recon_loss: 405585.7812; val_masked_gp_l1_reg_loss: 5685.2222; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231557.9062; val_global_loss: 698802.7500; val_optim_loss: 698802.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 28 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9542
val AUPRC score: 0.9490
val best accuracy score: 0.8856
val best F1 score: 0.8851
val target rna MSE score: 0.5090
val source rna MSE score: 0.3036
val target atac MSE score: 0.1343
val source atac MSE score: 0.0187
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
