Run timestamp: 14062023_155739.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', '8', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1726.
Number of gene programs after filtering and combining: 1585.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 960, n_cond_embed_input: 0, n_layers: 1, n_hidden: 960, n_latent: 1064, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1064, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1064, n_cond_embed_input: 8, n_addon_input: 0, n_output: 1920
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 254337
Number of validation nodes: 28260
Number of training edges: 1722321
Number of validation edges: 191368
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9833; val_auprc_score: 0.9932; val_best_acc_score: 0.9575; val_best_f1_score: 0.9720; train_kl_reg_loss: 17342.2619; train_edge_recon_loss: 1355158.2185; train_gene_expr_recon_loss: 1915435.8949; train_masked_gp_l1_reg_loss: 1999.9000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3289936.2779; train_optim_loss: 3289936.2779; val_kl_reg_loss: 7840.0718; val_edge_recon_loss: 1316801.7152; val_gene_expr_recon_loss: 1826874.2179; val_masked_gp_l1_reg_loss: 2212.8159; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3153728.7580; val_optim_loss: 3153728.7580
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9868; val_auprc_score: 0.9944; val_best_acc_score: 0.9657; val_best_f1_score: 0.9773; train_kl_reg_loss: 7661.0892; train_edge_recon_loss: 1301823.9275; train_gene_expr_recon_loss: 1791801.0438; train_masked_gp_l1_reg_loss: 2188.8645; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3103474.9260; train_optim_loss: 3103474.9260; val_kl_reg_loss: 7499.7121; val_edge_recon_loss: 1309386.7039; val_gene_expr_recon_loss: 1788372.6932; val_masked_gp_l1_reg_loss: 2203.3140; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3107462.3676; val_optim_loss: 3107462.3676
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9881; val_auprc_score: 0.9950; val_best_acc_score: 0.9674; val_best_f1_score: 0.9785; train_kl_reg_loss: 7519.9964; train_edge_recon_loss: 1297313.2988; train_gene_expr_recon_loss: 1766884.8675; train_masked_gp_l1_reg_loss: 2262.4644; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3073980.6274; train_optim_loss: 3073980.6274; val_kl_reg_loss: 7444.4814; val_edge_recon_loss: 1299407.3670; val_gene_expr_recon_loss: 1768748.7266; val_masked_gp_l1_reg_loss: 2318.8340; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3077919.3235; val_optim_loss: 3077919.3235
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9906; val_auprc_score: 0.9962; val_best_acc_score: 0.9727; val_best_f1_score: 0.9819; train_kl_reg_loss: 7624.3586; train_edge_recon_loss: 1296726.2805; train_gene_expr_recon_loss: 1754360.7290; train_masked_gp_l1_reg_loss: 2382.5367; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3061093.9056; train_optim_loss: 3061093.9056; val_kl_reg_loss: 7571.5072; val_edge_recon_loss: 1303674.6096; val_gene_expr_recon_loss: 1762289.3416; val_masked_gp_l1_reg_loss: 2439.3857; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3075974.9505; val_optim_loss: 3075974.9505
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9909; val_auprc_score: 0.9963; val_best_acc_score: 0.9725; val_best_f1_score: 0.9818; train_kl_reg_loss: 7753.7890; train_edge_recon_loss: 1296905.3265; train_gene_expr_recon_loss: 1747328.2157; train_masked_gp_l1_reg_loss: 2485.6221; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3054472.9556; train_optim_loss: 3054472.9556; val_kl_reg_loss: 7663.5368; val_edge_recon_loss: 1303183.1511; val_gene_expr_recon_loss: 1757786.5842; val_masked_gp_l1_reg_loss: 2520.5129; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3071153.7687; val_optim_loss: 3071153.7687
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9913; val_auprc_score: 0.9963; val_best_acc_score: 0.9745; val_best_f1_score: 0.9831; train_kl_reg_loss: 7928.9809; train_edge_recon_loss: 1293659.6313; train_gene_expr_recon_loss: 1742313.7617; train_masked_gp_l1_reg_loss: 2559.2073; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3046461.5785; train_optim_loss: 3046461.5785; val_kl_reg_loss: 7797.4504; val_edge_recon_loss: 1297393.7814; val_gene_expr_recon_loss: 1752555.5628; val_masked_gp_l1_reg_loss: 2581.9897; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3060328.7928; val_optim_loss: 3060328.7928
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9916; val_auprc_score: 0.9965; val_best_acc_score: 0.9754; val_best_f1_score: 0.9837; train_kl_reg_loss: 8076.5200; train_edge_recon_loss: 1292860.6104; train_gene_expr_recon_loss: 1737586.4518; train_masked_gp_l1_reg_loss: 2613.0898; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3041136.6702; train_optim_loss: 3041136.6702; val_kl_reg_loss: 8196.4322; val_edge_recon_loss: 1298334.8282; val_gene_expr_recon_loss: 1748877.2701; val_masked_gp_l1_reg_loss: 2632.2578; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3058040.7754; val_optim_loss: 3058040.7754
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9920; val_auprc_score: 0.9967; val_best_acc_score: 0.9758; val_best_f1_score: 0.9840; train_kl_reg_loss: 8188.5694; train_edge_recon_loss: 1293901.5650; train_gene_expr_recon_loss: 1735554.4914; train_masked_gp_l1_reg_loss: 2648.2129; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3040292.8365; train_optim_loss: 3040292.8365; val_kl_reg_loss: 8146.9569; val_edge_recon_loss: 1296969.0127; val_gene_expr_recon_loss: 1747080.5595; val_masked_gp_l1_reg_loss: 2666.7942; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3054863.2754; val_optim_loss: 3054863.2754
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9922; val_auprc_score: 0.9968; val_best_acc_score: 0.9768; val_best_f1_score: 0.9847; train_kl_reg_loss: 8314.4768; train_edge_recon_loss: 1290450.1467; train_gene_expr_recon_loss: 1733047.4550; train_masked_gp_l1_reg_loss: 2676.0120; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3034488.0889; train_optim_loss: 3034488.0889; val_kl_reg_loss: 8291.1166; val_edge_recon_loss: 1295964.4225; val_gene_expr_recon_loss: 1746264.8636; val_masked_gp_l1_reg_loss: 2683.3662; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3053203.6364; val_optim_loss: 3053203.6364
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9927; val_auprc_score: 0.9970; val_best_acc_score: 0.9778; val_best_f1_score: 0.9853; train_kl_reg_loss: 8436.8467; train_edge_recon_loss: 1292821.3357; train_gene_expr_recon_loss: 1730903.7805; train_masked_gp_l1_reg_loss: 2693.4378; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3034855.3968; train_optim_loss: 3034855.3968; val_kl_reg_loss: 8315.5788; val_edge_recon_loss: 1294957.4004; val_gene_expr_recon_loss: 1746924.1604; val_masked_gp_l1_reg_loss: 2698.6934; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3052895.8971; val_optim_loss: 3052895.8971
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9932; val_auprc_score: 0.9972; val_best_acc_score: 0.9781; val_best_f1_score: 0.9855; train_kl_reg_loss: 8506.2669; train_edge_recon_loss: 1290469.7261; train_gene_expr_recon_loss: 1728318.6485; train_masked_gp_l1_reg_loss: 2707.9438; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3030002.5834; train_optim_loss: 3030002.5834; val_kl_reg_loss: 8410.8508; val_edge_recon_loss: 1300066.3630; val_gene_expr_recon_loss: 1743219.4198; val_masked_gp_l1_reg_loss: 2713.5273; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3054410.1430; val_optim_loss: 3054410.1430
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9922; val_auprc_score: 0.9967; val_best_acc_score: 0.9778; val_best_f1_score: 0.9853; train_kl_reg_loss: 8593.6574; train_edge_recon_loss: 1290759.9555; train_gene_expr_recon_loss: 1727406.2826; train_masked_gp_l1_reg_loss: 2720.9289; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3029480.8298; train_optim_loss: 3029480.8298; val_kl_reg_loss: 8606.0725; val_edge_recon_loss: 1295262.5414; val_gene_expr_recon_loss: 1745145.3590; val_masked_gp_l1_reg_loss: 2725.8936; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3051739.9652; val_optim_loss: 3051739.9652
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9935; val_auprc_score: 0.9973; val_best_acc_score: 0.9797; val_best_f1_score: 0.9866; train_kl_reg_loss: 8646.6391; train_edge_recon_loss: 1290299.1471; train_gene_expr_recon_loss: 1725799.8905; train_masked_gp_l1_reg_loss: 2738.2404; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3027483.9159; train_optim_loss: 3027483.9159; val_kl_reg_loss: 8554.0914; val_edge_recon_loss: 1292517.2286; val_gene_expr_recon_loss: 1745640.7888; val_masked_gp_l1_reg_loss: 2735.6978; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3049447.8610; val_optim_loss: 3049447.8610
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9935; val_auprc_score: 0.9973; val_best_acc_score: 0.9796; val_best_f1_score: 0.9865; train_kl_reg_loss: 8732.6513; train_edge_recon_loss: 1290464.7504; train_gene_expr_recon_loss: 1725067.8887; train_masked_gp_l1_reg_loss: 2749.3354; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3027014.6246; train_optim_loss: 3027014.6246; val_kl_reg_loss: 8651.9210; val_edge_recon_loss: 1291467.6397; val_gene_expr_recon_loss: 1746417.9639; val_masked_gp_l1_reg_loss: 2754.5823; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3049292.0281; val_optim_loss: 3049292.0281
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9939; val_auprc_score: 0.9975; val_best_acc_score: 0.9793; val_best_f1_score: 0.9863; train_kl_reg_loss: 8771.7925; train_edge_recon_loss: 1290089.7070; train_gene_expr_recon_loss: 1723680.5172; train_masked_gp_l1_reg_loss: 2761.0907; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3025303.1098; train_optim_loss: 3025303.1098; val_kl_reg_loss: 8746.0990; val_edge_recon_loss: 1298122.2119; val_gene_expr_recon_loss: 1745827.6745; val_masked_gp_l1_reg_loss: 2765.4937; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3055461.4840; val_optim_loss: 3055461.4840
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9939; val_auprc_score: 0.9975; val_best_acc_score: 0.9800; val_best_f1_score: 0.9867; train_kl_reg_loss: 8859.2896; train_edge_recon_loss: 1287695.5452; train_gene_expr_recon_loss: 1723018.6564; train_masked_gp_l1_reg_loss: 2772.4968; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3022345.9897; train_optim_loss: 3022345.9897; val_kl_reg_loss: 8775.6536; val_edge_recon_loss: 1293549.7286; val_gene_expr_recon_loss: 1744723.3229; val_masked_gp_l1_reg_loss: 2777.5288; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3049826.1952; val_optim_loss: 3049826.1952
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9937; val_auprc_score: 0.9973; val_best_acc_score: 0.9810; val_best_f1_score: 0.9874; train_kl_reg_loss: 8882.1778; train_edge_recon_loss: 1290438.8387; train_gene_expr_recon_loss: 1721386.6364; train_masked_gp_l1_reg_loss: 2781.9908; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3023489.6473; train_optim_loss: 3023489.6473; val_kl_reg_loss: 8815.0459; val_edge_recon_loss: 1298774.9539; val_gene_expr_recon_loss: 1746015.4492; val_masked_gp_l1_reg_loss: 2781.7354; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3056387.2072; val_optim_loss: 3056387.2072

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9948; val_auprc_score: 0.9978; val_best_acc_score: 0.9820; val_best_f1_score: 0.9881; train_kl_reg_loss: 8811.6649; train_edge_recon_loss: 1289504.5598; train_gene_expr_recon_loss: 1713708.0835; train_masked_gp_l1_reg_loss: 2673.0467; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3014697.3563; train_optim_loss: 3014697.3563; val_kl_reg_loss: 8702.0802; val_edge_recon_loss: 1295870.6297; val_gene_expr_recon_loss: 1743028.4078; val_masked_gp_l1_reg_loss: 2637.7224; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3050238.8703; val_optim_loss: 3050238.8703
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9948; val_auprc_score: 0.9979; val_best_acc_score: 0.9819; val_best_f1_score: 0.9880; train_kl_reg_loss: 8824.8672; train_edge_recon_loss: 1287013.0903; train_gene_expr_recon_loss: 1713957.5072; train_masked_gp_l1_reg_loss: 2635.1613; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3012430.6260; train_optim_loss: 3012430.6260; val_kl_reg_loss: 8758.6269; val_edge_recon_loss: 1293768.4552; val_gene_expr_recon_loss: 1742063.6036; val_masked_gp_l1_reg_loss: 2635.1748; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3047225.9358; val_optim_loss: 3047225.9358
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9949; val_auprc_score: 0.9978; val_best_acc_score: 0.9820; val_best_f1_score: 0.9881; train_kl_reg_loss: 8838.1905; train_edge_recon_loss: 1287104.4561; train_gene_expr_recon_loss: 1713875.4783; train_masked_gp_l1_reg_loss: 2638.6538; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3012456.7797; train_optim_loss: 3012456.7797; val_kl_reg_loss: 8704.6533; val_edge_recon_loss: 1294969.0501; val_gene_expr_recon_loss: 1741849.0836; val_masked_gp_l1_reg_loss: 2642.4441; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3048165.2767; val_optim_loss: 3048165.2767
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9947; val_auprc_score: 0.9978; val_best_acc_score: 0.9818; val_best_f1_score: 0.9879; train_kl_reg_loss: 8815.3066; train_edge_recon_loss: 1287730.7613; train_gene_expr_recon_loss: 1712844.3588; train_masked_gp_l1_reg_loss: 2645.8217; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3012036.2464; train_optim_loss: 3012036.2464; val_kl_reg_loss: 8764.6148; val_edge_recon_loss: 1294467.6918; val_gene_expr_recon_loss: 1743502.9071; val_masked_gp_l1_reg_loss: 2652.5916; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3049387.7126; val_optim_loss: 3049387.7126
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9951; val_auprc_score: 0.9980; val_best_acc_score: 0.9823; val_best_f1_score: 0.9883; train_kl_reg_loss: 8815.7553; train_edge_recon_loss: 1286444.7727; train_gene_expr_recon_loss: 1712920.2840; train_masked_gp_l1_reg_loss: 2657.0725; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3010837.8853; train_optim_loss: 3010837.8853; val_kl_reg_loss: 8670.5129; val_edge_recon_loss: 1287571.0548; val_gene_expr_recon_loss: 1742412.2320; val_masked_gp_l1_reg_loss: 2662.0532; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3041315.7848; val_optim_loss: 3041315.7848
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9944; val_auprc_score: 0.9977; val_best_acc_score: 0.9818; val_best_f1_score: 0.9879; train_kl_reg_loss: 8801.2724; train_edge_recon_loss: 1288025.9828; train_gene_expr_recon_loss: 1712839.3346; train_masked_gp_l1_reg_loss: 2667.5088; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3012334.0997; train_optim_loss: 3012334.0997; val_kl_reg_loss: 8696.3759; val_edge_recon_loss: 1297439.2045; val_gene_expr_recon_loss: 1743019.5448; val_masked_gp_l1_reg_loss: 2672.5779; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3051827.6324; val_optim_loss: 3051827.6324
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9951; val_auprc_score: 0.9979; val_best_acc_score: 0.9825; val_best_f1_score: 0.9884; train_kl_reg_loss: 8789.6546; train_edge_recon_loss: 1286935.0889; train_gene_expr_recon_loss: 1711976.3121; train_masked_gp_l1_reg_loss: 2678.2972; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3010379.3575; train_optim_loss: 3010379.3575; val_kl_reg_loss: 8710.7912; val_edge_recon_loss: 1288765.9866; val_gene_expr_recon_loss: 1741847.9158; val_masked_gp_l1_reg_loss: 2685.5042; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3042010.1832; val_optim_loss: 3042010.1832
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9949; val_auprc_score: 0.9978; val_best_acc_score: 0.9826; val_best_f1_score: 0.9885; train_kl_reg_loss: 8774.7505; train_edge_recon_loss: 1287404.6283; train_gene_expr_recon_loss: 1711280.7628; train_masked_gp_l1_reg_loss: 2690.3031; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3010150.4398; train_optim_loss: 3010150.4398; val_kl_reg_loss: 8662.7546; val_edge_recon_loss: 1290203.1270; val_gene_expr_recon_loss: 1744598.2106; val_masked_gp_l1_reg_loss: 2695.4565; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3046159.5829; val_optim_loss: 3046159.5829

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9949; val_auprc_score: 0.9979; val_best_acc_score: 0.9813; val_best_f1_score: 0.9876; train_kl_reg_loss: 8244.4942; train_edge_recon_loss: 1293910.1820; train_gene_expr_recon_loss: 1717947.3323; train_masked_gp_l1_reg_loss: 2704.8538; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3022806.8641; train_optim_loss: 3022806.8641; val_kl_reg_loss: 5534.4908; val_edge_recon_loss: 1294410.0140; val_gene_expr_recon_loss: 1747276.3001; val_masked_gp_l1_reg_loss: 2716.1836; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3049937.0628; val_optim_loss: 3049937.0628
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9951; val_auprc_score: 0.9980; val_best_acc_score: 0.9816; val_best_f1_score: 0.9878; train_kl_reg_loss: 7915.5526; train_edge_recon_loss: 1291936.6913; train_gene_expr_recon_loss: 1716726.8150; train_masked_gp_l1_reg_loss: 2724.9901; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3019304.0391; train_optim_loss: 3019304.0391; val_kl_reg_loss: 5542.6629; val_edge_recon_loss: 1301046.4746; val_gene_expr_recon_loss: 1748617.9352; val_masked_gp_l1_reg_loss: 2732.0317; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3057939.0762; val_optim_loss: 3057939.0762
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9945; val_auprc_score: 0.9978; val_best_acc_score: 0.9809; val_best_f1_score: 0.9874; train_kl_reg_loss: 7896.5579; train_edge_recon_loss: 1292099.9970; train_gene_expr_recon_loss: 1715627.9739; train_masked_gp_l1_reg_loss: 2736.5803; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3018361.1069; train_optim_loss: 3018361.1069; val_kl_reg_loss: 5533.2423; val_edge_recon_loss: 1296854.1317; val_gene_expr_recon_loss: 1746487.1350; val_masked_gp_l1_reg_loss: 2739.8757; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3051614.5107; val_optim_loss: 3051614.5107

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 350 min 56 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9950
Val AUPRC score: 0.9980
Val best accuracy score: 0.9809
Val best F1 score: 0.9873
Val gene expr MSE score: 1.0970

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
