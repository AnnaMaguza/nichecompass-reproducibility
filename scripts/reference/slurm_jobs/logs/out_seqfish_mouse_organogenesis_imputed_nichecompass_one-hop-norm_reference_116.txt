[True]
Run timestamp: 27072023_013935_116.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_116']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8739; val_auprc_score: 0.9761; val_best_acc_score: 0.8570; val_best_f1_score: 0.9229; train_kl_reg_loss: 182573.4584; train_edge_recon_loss: 10415178.6512; train_gene_expr_recon_loss: 2195694.2384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12793446.3535; train_optim_loss: 12793446.3535; val_kl_reg_loss: 65632.0768; val_edge_recon_loss: 11715216.7500; val_gene_expr_recon_loss: 1308698.8021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13089547.6667; val_optim_loss: 13089547.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8486; val_auprc_score: 0.9705; val_best_acc_score: 0.8625; val_best_f1_score: 0.9246; train_kl_reg_loss: 72831.6021; train_edge_recon_loss: 10307708.4721; train_gene_expr_recon_loss: 1240310.1343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11620850.1953; train_optim_loss: 11620850.1953; val_kl_reg_loss: 56981.3140; val_edge_recon_loss: 11866983.4583; val_gene_expr_recon_loss: 1161116.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13085081.2083; val_optim_loss: 13085081.2083
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8506; val_auprc_score: 0.9673; val_best_acc_score: 0.8812; val_best_f1_score: 0.9337; train_kl_reg_loss: 55323.9290; train_edge_recon_loss: 10286131.8047; train_gene_expr_recon_loss: 1127331.1837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11468786.9070; train_optim_loss: 11468786.9070; val_kl_reg_loss: 20285.6764; val_edge_recon_loss: 10496969.2500; val_gene_expr_recon_loss: 1146534.1927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11663789.1250; val_optim_loss: 11663789.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8584; val_auprc_score: 0.9659; val_best_acc_score: 0.8954; val_best_f1_score: 0.9414; train_kl_reg_loss: 50804.1166; train_edge_recon_loss: 8794729.8186; train_gene_expr_recon_loss: 1136791.9395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9982325.9163; train_optim_loss: 9982325.9163; val_kl_reg_loss: 66173.6315; val_edge_recon_loss: 8495190.8542; val_gene_expr_recon_loss: 1051027.4896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9612391.9583; val_optim_loss: 9612391.9583
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8812; val_auprc_score: 0.9732; val_best_acc_score: 0.8965; val_best_f1_score: 0.9417; train_kl_reg_loss: 70723.2373; train_edge_recon_loss: 8172349.5395; train_gene_expr_recon_loss: 1007065.6735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9250138.4605; train_optim_loss: 9250138.4605; val_kl_reg_loss: 68932.3896; val_edge_recon_loss: 8431466.6458; val_gene_expr_recon_loss: 975871.0104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9476270.1250; val_optim_loss: 9476270.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9091; val_auprc_score: 0.9784; val_best_acc_score: 0.9184; val_best_f1_score: 0.9533; train_kl_reg_loss: 65454.0613; train_edge_recon_loss: 8041320.0140; train_gene_expr_recon_loss: 954325.3924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9061099.4860; train_optim_loss: 9061099.4860; val_kl_reg_loss: 58807.3525; val_edge_recon_loss: 7929276.3333; val_gene_expr_recon_loss: 934442.0807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8922525.7917; val_optim_loss: 8922525.7917
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9052; val_auprc_score: 0.9786; val_best_acc_score: 0.9168; val_best_f1_score: 0.9524; train_kl_reg_loss: 51995.2357; train_edge_recon_loss: 8076372.5767; train_gene_expr_recon_loss: 919816.9898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9048184.8116; train_optim_loss: 9048184.8116; val_kl_reg_loss: 51040.0010; val_edge_recon_loss: 8156068.8750; val_gene_expr_recon_loss: 900641.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9107750.8750; val_optim_loss: 9107750.8750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9133; val_auprc_score: 0.9805; val_best_acc_score: 0.9193; val_best_f1_score: 0.9542; train_kl_reg_loss: 43534.8593; train_edge_recon_loss: 7911100.4442; train_gene_expr_recon_loss: 889169.3413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8843804.6326; train_optim_loss: 8843804.6326; val_kl_reg_loss: 39268.5575; val_edge_recon_loss: 8002775.2292; val_gene_expr_recon_loss: 874595.6458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8916639.3958; val_optim_loss: 8916639.3958
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9286; val_auprc_score: 0.9843; val_best_acc_score: 0.9184; val_best_f1_score: 0.9530; train_kl_reg_loss: 34319.3288; train_edge_recon_loss: 7892038.6070; train_gene_expr_recon_loss: 866770.1166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8793128.0326; train_optim_loss: 8793128.0326; val_kl_reg_loss: 31746.8015; val_edge_recon_loss: 8222375.5833; val_gene_expr_recon_loss: 857021.9193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9111144.2917; val_optim_loss: 9111144.2917
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9218; val_auprc_score: 0.9818; val_best_acc_score: 0.9206; val_best_f1_score: 0.9541; train_kl_reg_loss: 31441.2708; train_edge_recon_loss: 7870920.6767; train_gene_expr_recon_loss: 848426.9172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8750788.8279; train_optim_loss: 8750788.8279; val_kl_reg_loss: 28250.9306; val_edge_recon_loss: 8230070.8125; val_gene_expr_recon_loss: 842585.9505; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9100907.7292; val_optim_loss: 9100907.7292
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9324; val_auprc_score: 0.9850; val_best_acc_score: 0.9257; val_best_f1_score: 0.9573; train_kl_reg_loss: 27990.5007; train_edge_recon_loss: 7788670.0698; train_gene_expr_recon_loss: 833605.5602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8650266.0837; train_optim_loss: 8650266.0837; val_kl_reg_loss: 23440.7377; val_edge_recon_loss: 8074348.6875; val_gene_expr_recon_loss: 826998.0286; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8924787.5000; val_optim_loss: 8924787.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9447; val_auprc_score: 0.9884; val_best_acc_score: 0.9333; val_best_f1_score: 0.9618; train_kl_reg_loss: 23984.4275; train_edge_recon_loss: 7827421.4349; train_gene_expr_recon_loss: 821821.8544; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8673227.7070; train_optim_loss: 8673227.7070; val_kl_reg_loss: 23598.8031; val_edge_recon_loss: 7638760.9375; val_gene_expr_recon_loss: 815132.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8477492.6667; val_optim_loss: 8477492.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9454; val_auprc_score: 0.9880; val_best_acc_score: 0.9332; val_best_f1_score: 0.9615; train_kl_reg_loss: 24629.2831; train_edge_recon_loss: 7747324.2023; train_gene_expr_recon_loss: 809368.1093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8581321.5721; train_optim_loss: 8581321.5721; val_kl_reg_loss: 24134.7282; val_edge_recon_loss: 7834528.2708; val_gene_expr_recon_loss: 802191.1823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8660854.1667; val_optim_loss: 8660854.1667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9485; val_auprc_score: 0.9882; val_best_acc_score: 0.9395; val_best_f1_score: 0.9649; train_kl_reg_loss: 22955.4674; train_edge_recon_loss: 7674276.0186; train_gene_expr_recon_loss: 802511.3541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8499742.8349; train_optim_loss: 8499742.8349; val_kl_reg_loss: 23533.1741; val_edge_recon_loss: 7868343.9792; val_gene_expr_recon_loss: 800860.2682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8692737.5000; val_optim_loss: 8692737.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9470; val_auprc_score: 0.9881; val_best_acc_score: 0.9392; val_best_f1_score: 0.9649; train_kl_reg_loss: 23885.0588; train_edge_recon_loss: 7815857.1279; train_gene_expr_recon_loss: 796490.2279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8636232.4326; train_optim_loss: 8636232.4326; val_kl_reg_loss: 24192.3629; val_edge_recon_loss: 7956203.1042; val_gene_expr_recon_loss: 794299.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8774694.5833; val_optim_loss: 8774694.5833
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9519; val_auprc_score: 0.9889; val_best_acc_score: 0.9427; val_best_f1_score: 0.9668; train_kl_reg_loss: 21577.1391; train_edge_recon_loss: 7782822.6442; train_gene_expr_recon_loss: 782480.7488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8586880.4837; train_optim_loss: 8586880.4837; val_kl_reg_loss: 20314.2287; val_edge_recon_loss: 7762396.8958; val_gene_expr_recon_loss: 776861.7396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8559572.9375; val_optim_loss: 8559572.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9470; val_auprc_score: 0.9876; val_best_acc_score: 0.9407; val_best_f1_score: 0.9658; train_kl_reg_loss: 20328.5065; train_edge_recon_loss: 7675299.0767; train_gene_expr_recon_loss: 774974.9250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8470602.5256; train_optim_loss: 8470602.5256; val_kl_reg_loss: 19023.5976; val_edge_recon_loss: 7867325.6667; val_gene_expr_recon_loss: 774309.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8660658.6667; val_optim_loss: 8660658.6667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9484; val_auprc_score: 0.9875; val_best_acc_score: 0.9428; val_best_f1_score: 0.9670; train_kl_reg_loss: 20222.1888; train_edge_recon_loss: 7657227.8721; train_gene_expr_recon_loss: 773749.5064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8451199.5721; train_optim_loss: 8451199.5721; val_kl_reg_loss: 19149.2386; val_edge_recon_loss: 7782813.8333; val_gene_expr_recon_loss: 773143.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8575106.0833; val_optim_loss: 8575106.0833
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9552; val_auprc_score: 0.9896; val_best_acc_score: 0.9457; val_best_f1_score: 0.9685; train_kl_reg_loss: 19648.5639; train_edge_recon_loss: 7768497.8767; train_gene_expr_recon_loss: 773095.9808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8561242.4000; train_optim_loss: 8561242.4000; val_kl_reg_loss: 18695.3979; val_edge_recon_loss: 7684449.6042; val_gene_expr_recon_loss: 772439.6510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8475584.6250; val_optim_loss: 8475584.6250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9549; val_auprc_score: 0.9889; val_best_acc_score: 0.9443; val_best_f1_score: 0.9677; train_kl_reg_loss: 19741.6353; train_edge_recon_loss: 7732316.8791; train_gene_expr_recon_loss: 772256.0206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8524314.5419; train_optim_loss: 8524314.5419; val_kl_reg_loss: 19443.3263; val_edge_recon_loss: 7857963.8750; val_gene_expr_recon_loss: 772526.1198; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8649933.3333; val_optim_loss: 8649933.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9589; val_auprc_score: 0.9910; val_best_acc_score: 0.9468; val_best_f1_score: 0.9694; train_kl_reg_loss: 19807.6865; train_edge_recon_loss: 7679184.8116; train_gene_expr_recon_loss: 771544.7006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8470537.2070; train_optim_loss: 8470537.2070; val_kl_reg_loss: 19002.8787; val_edge_recon_loss: 7648862.0208; val_gene_expr_recon_loss: 772534.3854; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8440399.2708; val_optim_loss: 8440399.2708
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9565; val_auprc_score: 0.9906; val_best_acc_score: 0.9447; val_best_f1_score: 0.9680; train_kl_reg_loss: 19395.7460; train_edge_recon_loss: 7669831.6837; train_gene_expr_recon_loss: 770665.9494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8459893.3326; train_optim_loss: 8459893.3326; val_kl_reg_loss: 18343.5481; val_edge_recon_loss: 7744537.0000; val_gene_expr_recon_loss: 770828.9115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8533709.4792; val_optim_loss: 8533709.4792
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9504; val_auprc_score: 0.9879; val_best_acc_score: 0.9446; val_best_f1_score: 0.9679; train_kl_reg_loss: 19011.5104; train_edge_recon_loss: 7709548.4140; train_gene_expr_recon_loss: 770061.3567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8498621.3349; train_optim_loss: 8498621.3349; val_kl_reg_loss: 18440.3485; val_edge_recon_loss: 7920116.8750; val_gene_expr_recon_loss: 770352.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8708909.2917; val_optim_loss: 8708909.2917
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9567; val_auprc_score: 0.9902; val_best_acc_score: 0.9463; val_best_f1_score: 0.9688; train_kl_reg_loss: 18468.0159; train_edge_recon_loss: 7673042.8163; train_gene_expr_recon_loss: 769328.0997; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8460838.9116; train_optim_loss: 8460838.9116; val_kl_reg_loss: 17243.8310; val_edge_recon_loss: 7952197.4167; val_gene_expr_recon_loss: 769475.9271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8738917.2083; val_optim_loss: 8738917.2083
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9592; val_auprc_score: 0.9905; val_best_acc_score: 0.9470; val_best_f1_score: 0.9692; train_kl_reg_loss: 18377.0691; train_edge_recon_loss: 7769640.9395; train_gene_expr_recon_loss: 768383.5366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8556401.5581; train_optim_loss: 8556401.5581; val_kl_reg_loss: 18142.2622; val_edge_recon_loss: 7915105.6667; val_gene_expr_recon_loss: 767144.8802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8700392.7917; val_optim_loss: 8700392.7917

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9567; val_auprc_score: 0.9897; val_best_acc_score: 0.9493; val_best_f1_score: 0.9708; train_kl_reg_loss: 18648.1239; train_edge_recon_loss: 7669178.6581; train_gene_expr_recon_loss: 772151.2858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8459978.0860; train_optim_loss: 8459978.0860; val_kl_reg_loss: 13560.6079; val_edge_recon_loss: 7531298.2083; val_gene_expr_recon_loss: 772196.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8317055.5000; val_optim_loss: 8317055.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9591; val_auprc_score: 0.9909; val_best_acc_score: 0.9480; val_best_f1_score: 0.9701; train_kl_reg_loss: 18504.4697; train_edge_recon_loss: 7607015.8791; train_gene_expr_recon_loss: 770952.3192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8396472.6512; train_optim_loss: 8396472.6512; val_kl_reg_loss: 13531.8286; val_edge_recon_loss: 7537713.3125; val_gene_expr_recon_loss: 771195.8099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8322440.9792; val_optim_loss: 8322440.9792
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9525; val_auprc_score: 0.9877; val_best_acc_score: 0.9454; val_best_f1_score: 0.9682; train_kl_reg_loss: 18433.6401; train_edge_recon_loss: 7658239.2186; train_gene_expr_recon_loss: 770572.3360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8447245.1674; train_optim_loss: 8447245.1674; val_kl_reg_loss: 13486.8772; val_edge_recon_loss: 8187981.1875; val_gene_expr_recon_loss: 770542.4010; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8972010.3333; val_optim_loss: 8972010.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9557; val_auprc_score: 0.9899; val_best_acc_score: 0.9458; val_best_f1_score: 0.9687; train_kl_reg_loss: 18347.7335; train_edge_recon_loss: 7718119.9977; train_gene_expr_recon_loss: 770144.3706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8506612.0884; train_optim_loss: 8506612.0884; val_kl_reg_loss: 13356.2706; val_edge_recon_loss: 7828810.7500; val_gene_expr_recon_loss: 770804.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8612971.8542; val_optim_loss: 8612971.8542
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9573; val_auprc_score: 0.9897; val_best_acc_score: 0.9491; val_best_f1_score: 0.9705; train_kl_reg_loss: 18254.3473; train_edge_recon_loss: 7701676.6837; train_gene_expr_recon_loss: 769886.3474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8489817.3930; train_optim_loss: 8489817.3930; val_kl_reg_loss: 13299.3461; val_edge_recon_loss: 7895734.9167; val_gene_expr_recon_loss: 770146.6536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8679180.9583; val_optim_loss: 8679180.9583

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9544; val_auprc_score: 0.9882; val_best_acc_score: 0.9473; val_best_f1_score: 0.9696; train_kl_reg_loss: 18292.9271; train_edge_recon_loss: 7615854.3721; train_gene_expr_recon_loss: 769948.9215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8404096.2512; train_optim_loss: 8404096.2512; val_kl_reg_loss: 13309.3384; val_edge_recon_loss: 7842954.6667; val_gene_expr_recon_loss: 770268.5026; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8626532.4375; val_optim_loss: 8626532.4375
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9546; val_auprc_score: 0.9895; val_best_acc_score: 0.9463; val_best_f1_score: 0.9689; train_kl_reg_loss: 18292.8692; train_edge_recon_loss: 7709307.0488; train_gene_expr_recon_loss: 770116.5110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8497716.4465; train_optim_loss: 8497716.4465; val_kl_reg_loss: 13331.8099; val_edge_recon_loss: 7847339.0417; val_gene_expr_recon_loss: 770501.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8631172.4583; val_optim_loss: 8631172.4583
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9578; val_auprc_score: 0.9901; val_best_acc_score: 0.9513; val_best_f1_score: 0.9718; train_kl_reg_loss: 18272.9625; train_edge_recon_loss: 7758758.6581; train_gene_expr_recon_loss: 769813.5128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8546845.1395; train_optim_loss: 8546845.1395; val_kl_reg_loss: 13322.6424; val_edge_recon_loss: 7704340.6042; val_gene_expr_recon_loss: 770890.6901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8488553.9375; val_optim_loss: 8488553.9375
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9559; val_auprc_score: 0.9899; val_best_acc_score: 0.9469; val_best_f1_score: 0.9694; train_kl_reg_loss: 18270.9786; train_edge_recon_loss: 7742178.4953; train_gene_expr_recon_loss: 769857.3823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8530306.8791; train_optim_loss: 8530306.8791; val_kl_reg_loss: 13288.8563; val_edge_recon_loss: 7798145.2708; val_gene_expr_recon_loss: 770186.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8581620.6458; val_optim_loss: 8581620.6458

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 4 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.9592
Val AUPRC score: 0.9904
Val best accuracy score: 0.9479
Val best F1 score: 0.9699
Val gene expr MSE score: 22614.3381
Val cat covariate0 mean sim diff: 0.0003

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
