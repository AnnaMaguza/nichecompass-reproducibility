[True]
Run timestamp: 10102023_081956_201.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_201']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7796; val_auprc_score: 0.7988; val_best_acc_score: 0.5458; val_best_f1_score: 0.6855; train_kl_reg_loss: 70897.2919; train_edge_recon_loss: 749108.6560; train_gene_expr_recon_loss: 22099146.7481; train_masked_gp_l1_reg_loss: 60436.7884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4009579.1622; train_chrom_access_recon_loss: 2850511.1966; train_global_loss: 29839679.6794; train_optim_loss: 29839679.6794; val_kl_reg_loss: 69418.1052; val_edge_recon_loss: 812564.4708; val_gene_expr_recon_loss: 21343536.2667; val_masked_gp_l1_reg_loss: 67708.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 974828.0625; val_chrom_access_recon_loss: 2804134.6500; val_global_loss: 26072189.7333; val_optim_loss: 26072189.7333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8096; val_auprc_score: 0.8254; val_best_acc_score: 0.7090; val_best_f1_score: 0.7424; train_kl_reg_loss: 72880.0127; train_edge_recon_loss: 734268.0219; train_gene_expr_recon_loss: 20873905.4046; train_masked_gp_l1_reg_loss: 68530.5002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 491144.4864; train_chrom_access_recon_loss: 2748592.8760; train_global_loss: 24989321.3282; train_optim_loss: 24989321.3282; val_kl_reg_loss: 70395.6771; val_edge_recon_loss: 806387.0708; val_gene_expr_recon_loss: 20962552.4000; val_masked_gp_l1_reg_loss: 69425.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 261969.7812; val_chrom_access_recon_loss: 2767665.4667; val_global_loss: 24938396.4000; val_optim_loss: 24938396.4000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8912; val_auprc_score: 0.8896; val_best_acc_score: 0.8150; val_best_f1_score: 0.8206; train_kl_reg_loss: 62677.2568; train_edge_recon_loss: 718576.0935; train_gene_expr_recon_loss: 20577327.8015; train_masked_gp_l1_reg_loss: 70652.5351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 201024.2389; train_chrom_access_recon_loss: 2715306.8569; train_global_loss: 24345564.8855; train_optim_loss: 24345564.8855; val_kl_reg_loss: 64705.9651; val_edge_recon_loss: 751084.3417; val_gene_expr_recon_loss: 20676955.6000; val_masked_gp_l1_reg_loss: 71829.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168183.2500; val_chrom_access_recon_loss: 2746054.5333; val_global_loss: 24478814.0000; val_optim_loss: 24478814.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9131; val_auprc_score: 0.9074; val_best_acc_score: 0.8258; val_best_f1_score: 0.8365; train_kl_reg_loss: 67993.0478; train_edge_recon_loss: 661054.4418; train_gene_expr_recon_loss: 20322801.0076; train_masked_gp_l1_reg_loss: 73404.1186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 161053.5726; train_chrom_access_recon_loss: 2691058.5267; train_global_loss: 23977364.7023; train_optim_loss: 23977364.7023; val_kl_reg_loss: 76237.9578; val_edge_recon_loss: 630786.1458; val_gene_expr_recon_loss: 20395731.3333; val_masked_gp_l1_reg_loss: 75480.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154225.2344; val_chrom_access_recon_loss: 2710068.3333; val_global_loss: 24042529.8667; val_optim_loss: 24042529.8667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9234; val_auprc_score: 0.9121; val_best_acc_score: 0.8464; val_best_f1_score: 0.8565; train_kl_reg_loss: 72420.3592; train_edge_recon_loss: 624309.3340; train_gene_expr_recon_loss: 20101251.2672; train_masked_gp_l1_reg_loss: 76803.7472; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142603.1323; train_chrom_access_recon_loss: 2664558.2309; train_global_loss: 23681945.9084; train_optim_loss: 23681945.9084; val_kl_reg_loss: 74342.1052; val_edge_recon_loss: 616707.7958; val_gene_expr_recon_loss: 20278511.6000; val_masked_gp_l1_reg_loss: 78294.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135009.0781; val_chrom_access_recon_loss: 2695718.7167; val_global_loss: 23878584.1333; val_optim_loss: 23878584.1333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9355; val_auprc_score: 0.9279; val_best_acc_score: 0.8561; val_best_f1_score: 0.8650; train_kl_reg_loss: 71142.8539; train_edge_recon_loss: 612400.6407; train_gene_expr_recon_loss: 19962708.3511; train_masked_gp_l1_reg_loss: 79109.3327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127404.3736; train_chrom_access_recon_loss: 2648692.3454; train_global_loss: 23501458.0458; train_optim_loss: 23501458.0458; val_kl_reg_loss: 72441.1573; val_edge_recon_loss: 608063.3750; val_gene_expr_recon_loss: 20110243.7333; val_masked_gp_l1_reg_loss: 80158.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121512.3125; val_chrom_access_recon_loss: 2665820.6667; val_global_loss: 23658239.0667; val_optim_loss: 23658239.0667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9388; val_auprc_score: 0.9302; val_best_acc_score: 0.8635; val_best_f1_score: 0.8697; train_kl_reg_loss: 69709.4588; train_edge_recon_loss: 603959.5425; train_gene_expr_recon_loss: 19809512.6718; train_masked_gp_l1_reg_loss: 80948.1791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118141.3703; train_chrom_access_recon_loss: 2628123.9580; train_global_loss: 23310395.1298; train_optim_loss: 23310395.1298; val_kl_reg_loss: 70486.2750; val_edge_recon_loss: 604621.2667; val_gene_expr_recon_loss: 19980422.1333; val_masked_gp_l1_reg_loss: 81805.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116167.1562; val_chrom_access_recon_loss: 2653140.9333; val_global_loss: 23506644.6667; val_optim_loss: 23506644.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9485; val_auprc_score: 0.9404; val_best_acc_score: 0.8777; val_best_f1_score: 0.8823; train_kl_reg_loss: 68123.9713; train_edge_recon_loss: 599791.1584; train_gene_expr_recon_loss: 19722457.4656; train_masked_gp_l1_reg_loss: 82411.6326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115817.1635; train_chrom_access_recon_loss: 2616251.7385; train_global_loss: 23204853.1450; train_optim_loss: 23204853.1450; val_kl_reg_loss: 67883.5688; val_edge_recon_loss: 596539.5917; val_gene_expr_recon_loss: 19829217.4667; val_masked_gp_l1_reg_loss: 83113.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116044.6172; val_chrom_access_recon_loss: 2638313.9333; val_global_loss: 23331112.4000; val_optim_loss: 23331112.4000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9473; val_auprc_score: 0.9371; val_best_acc_score: 0.8795; val_best_f1_score: 0.8855; train_kl_reg_loss: 66462.4797; train_edge_recon_loss: 598000.7395; train_gene_expr_recon_loss: 19579224.8244; train_masked_gp_l1_reg_loss: 83449.9197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114596.9888; train_chrom_access_recon_loss: 2598202.6947; train_global_loss: 23039937.5878; train_optim_loss: 23039937.5878; val_kl_reg_loss: 66428.4156; val_edge_recon_loss: 598400.1250; val_gene_expr_recon_loss: 19692144.0000; val_masked_gp_l1_reg_loss: 83917.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113062.4609; val_chrom_access_recon_loss: 2610543.3333; val_global_loss: 23164495.8667; val_optim_loss: 23164495.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9546; val_auprc_score: 0.9472; val_best_acc_score: 0.8875; val_best_f1_score: 0.8920; train_kl_reg_loss: 65240.3413; train_edge_recon_loss: 593333.7285; train_gene_expr_recon_loss: 19481141.9847; train_masked_gp_l1_reg_loss: 84423.0970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111472.8222; train_chrom_access_recon_loss: 2583423.6794; train_global_loss: 22919035.8473; train_optim_loss: 22919035.8473; val_kl_reg_loss: 65978.5240; val_edge_recon_loss: 596305.1708; val_gene_expr_recon_loss: 19596553.2000; val_masked_gp_l1_reg_loss: 84920.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110694.3281; val_chrom_access_recon_loss: 2614157.1667; val_global_loss: 23068607.4667; val_optim_loss: 23068607.4667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9581; val_auprc_score: 0.9488; val_best_acc_score: 0.8989; val_best_f1_score: 0.9031; train_kl_reg_loss: 64880.5596; train_edge_recon_loss: 589880.0353; train_gene_expr_recon_loss: 19403050.0458; train_masked_gp_l1_reg_loss: 85337.7179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108916.0326; train_chrom_access_recon_loss: 2571503.4771; train_global_loss: 22823567.9389; train_optim_loss: 22823567.9389; val_kl_reg_loss: 65132.5687; val_edge_recon_loss: 591187.6292; val_gene_expr_recon_loss: 19564197.3333; val_masked_gp_l1_reg_loss: 85664.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108125.0938; val_chrom_access_recon_loss: 2603723.9500; val_global_loss: 23018031.4667; val_optim_loss: 23018031.4667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9595; val_auprc_score: 0.9493; val_best_acc_score: 0.8998; val_best_f1_score: 0.9038; train_kl_reg_loss: 63937.4461; train_edge_recon_loss: 590004.7490; train_gene_expr_recon_loss: 19316778.5191; train_masked_gp_l1_reg_loss: 86124.5454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106425.0574; train_chrom_access_recon_loss: 2561033.5534; train_global_loss: 22724304.0000; train_optim_loss: 22724304.0000; val_kl_reg_loss: 63379.8057; val_edge_recon_loss: 591691.0500; val_gene_expr_recon_loss: 19458988.8000; val_masked_gp_l1_reg_loss: 86555.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106141.2969; val_chrom_access_recon_loss: 2597270.5000; val_global_loss: 22904028.1333; val_optim_loss: 22904028.1333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9664; val_auprc_score: 0.9578; val_best_acc_score: 0.9126; val_best_f1_score: 0.9157; train_kl_reg_loss: 63457.4787; train_edge_recon_loss: 584952.6336; train_gene_expr_recon_loss: 19248694.5344; train_masked_gp_l1_reg_loss: 86829.1430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105066.2110; train_chrom_access_recon_loss: 2547901.2137; train_global_loss: 22636901.2214; train_optim_loss: 22636901.2214; val_kl_reg_loss: 63100.6721; val_edge_recon_loss: 586475.6917; val_gene_expr_recon_loss: 19431649.8667; val_masked_gp_l1_reg_loss: 87110.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103968.8672; val_chrom_access_recon_loss: 2593101.4667; val_global_loss: 22865405.7333; val_optim_loss: 22865405.7333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9628; val_auprc_score: 0.9540; val_best_acc_score: 0.9054; val_best_f1_score: 0.9089; train_kl_reg_loss: 62451.0035; train_edge_recon_loss: 585239.9270; train_gene_expr_recon_loss: 19197758.0000; train_masked_gp_l1_reg_loss: 87528.5045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104106.9396; train_chrom_access_recon_loss: 2540981.4008; train_global_loss: 22578065.6183; train_optim_loss: 22578065.6183; val_kl_reg_loss: 61848.5482; val_edge_recon_loss: 584532.0250; val_gene_expr_recon_loss: 19272676.0000; val_masked_gp_l1_reg_loss: 87896.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105195.5703; val_chrom_access_recon_loss: 2565537.6333; val_global_loss: 22677685.8667; val_optim_loss: 22677685.8667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9669; val_auprc_score: 0.9608; val_best_acc_score: 0.9112; val_best_f1_score: 0.9149; train_kl_reg_loss: 62076.5967; train_edge_recon_loss: 583866.0754; train_gene_expr_recon_loss: 19110780.4733; train_masked_gp_l1_reg_loss: 88325.6688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104336.1570; train_chrom_access_recon_loss: 2528539.0573; train_global_loss: 22477923.8321; train_optim_loss: 22477923.8321; val_kl_reg_loss: 61819.7464; val_edge_recon_loss: 583866.0458; val_gene_expr_recon_loss: 19245075.0667; val_masked_gp_l1_reg_loss: 88667.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105028.3594; val_chrom_access_recon_loss: 2544702.1833; val_global_loss: 22629158.8000; val_optim_loss: 22629158.8000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9695; val_auprc_score: 0.9629; val_best_acc_score: 0.9170; val_best_f1_score: 0.9190; train_kl_reg_loss: 61370.9228; train_edge_recon_loss: 583419.3626; train_gene_expr_recon_loss: 19053502.3359; train_masked_gp_l1_reg_loss: 89179.8340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104540.1926; train_chrom_access_recon_loss: 2519858.9294; train_global_loss: 22411871.5115; train_optim_loss: 22411871.5115; val_kl_reg_loss: 60801.1544; val_edge_recon_loss: 583466.8417; val_gene_expr_recon_loss: 19163421.6000; val_masked_gp_l1_reg_loss: 89779.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104781.7422; val_chrom_access_recon_loss: 2541540.9667; val_global_loss: 22543792.2667; val_optim_loss: 22543792.2667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9676; val_auprc_score: 0.9579; val_best_acc_score: 0.9132; val_best_f1_score: 0.9167; train_kl_reg_loss: 60672.0515; train_edge_recon_loss: 581136.8211; train_gene_expr_recon_loss: 18983218.2901; train_masked_gp_l1_reg_loss: 90222.0646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104720.0339; train_chrom_access_recon_loss: 2509596.3492; train_global_loss: 22329565.7405; train_optim_loss: 22329565.7405; val_kl_reg_loss: 60848.8128; val_edge_recon_loss: 581185.6042; val_gene_expr_recon_loss: 19082894.9333; val_masked_gp_l1_reg_loss: 90659.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104644.1875; val_chrom_access_recon_loss: 2532195.2500; val_global_loss: 22452428.6667; val_optim_loss: 22452428.6667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9676; val_auprc_score: 0.9568; val_best_acc_score: 0.9099; val_best_f1_score: 0.9135; train_kl_reg_loss: 60068.5145; train_edge_recon_loss: 581475.3822; train_gene_expr_recon_loss: 18949895.4046; train_masked_gp_l1_reg_loss: 91210.7283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105025.5435; train_chrom_access_recon_loss: 2503553.9141; train_global_loss: 22291229.5420; train_optim_loss: 22291229.5420; val_kl_reg_loss: 58892.2055; val_edge_recon_loss: 579241.2167; val_gene_expr_recon_loss: 19111280.0000; val_masked_gp_l1_reg_loss: 91612.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105332.3203; val_chrom_access_recon_loss: 2524184.4333; val_global_loss: 22470541.8667; val_optim_loss: 22470541.8667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9661; val_auprc_score: 0.9558; val_best_acc_score: 0.9158; val_best_f1_score: 0.9173; train_kl_reg_loss: 59666.1533; train_edge_recon_loss: 581369.8311; train_gene_expr_recon_loss: 18872793.0534; train_masked_gp_l1_reg_loss: 92030.0219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105191.3481; train_chrom_access_recon_loss: 2490660.7309; train_global_loss: 22201711.1298; train_optim_loss: 22201711.1298; val_kl_reg_loss: 60890.2641; val_edge_recon_loss: 585270.9167; val_gene_expr_recon_loss: 19098023.4667; val_masked_gp_l1_reg_loss: 92389.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105090.3125; val_chrom_access_recon_loss: 2538802.0000; val_global_loss: 22480466.6667; val_optim_loss: 22480466.6667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9660; val_auprc_score: 0.9589; val_best_acc_score: 0.9096; val_best_f1_score: 0.9137; train_kl_reg_loss: 59350.4755; train_edge_recon_loss: 579919.8874; train_gene_expr_recon_loss: 18825210.7634; train_masked_gp_l1_reg_loss: 92998.9056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104837.6809; train_chrom_access_recon_loss: 2484000.8511; train_global_loss: 22146318.4427; train_optim_loss: 22146318.4427; val_kl_reg_loss: 59315.8758; val_edge_recon_loss: 584820.7625; val_gene_expr_recon_loss: 19134247.6000; val_masked_gp_l1_reg_loss: 93504.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104845.4766; val_chrom_access_recon_loss: 2537543.5000; val_global_loss: 22514277.8667; val_optim_loss: 22514277.8667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9651; val_auprc_score: 0.9551; val_best_acc_score: 0.9113; val_best_f1_score: 0.9149; train_kl_reg_loss: 59130.1681; train_edge_recon_loss: 579287.6183; train_gene_expr_recon_loss: 18766481.9847; train_masked_gp_l1_reg_loss: 93968.3567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104844.5590; train_chrom_access_recon_loss: 2472099.0630; train_global_loss: 22075811.8473; train_optim_loss: 22075811.8473; val_kl_reg_loss: 59593.7068; val_edge_recon_loss: 584410.0958; val_gene_expr_recon_loss: 18977839.8667; val_masked_gp_l1_reg_loss: 94486.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104398.3203; val_chrom_access_recon_loss: 2518434.0667; val_global_loss: 22339162.0000; val_optim_loss: 22339162.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9646; val_auprc_score: 0.9543; val_best_acc_score: 0.9117; val_best_f1_score: 0.9154; train_kl_reg_loss: 58965.7134; train_edge_recon_loss: 579287.5095; train_gene_expr_recon_loss: 18746637.8473; train_masked_gp_l1_reg_loss: 94950.4661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104648.9572; train_chrom_access_recon_loss: 2468636.5916; train_global_loss: 22053127.1298; train_optim_loss: 22053127.1298; val_kl_reg_loss: 58084.6898; val_edge_recon_loss: 581869.7333; val_gene_expr_recon_loss: 18985017.8667; val_masked_gp_l1_reg_loss: 95462.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106182.3750; val_chrom_access_recon_loss: 2510191.7667; val_global_loss: 22336808.0000; val_optim_loss: 22336808.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9668; val_auprc_score: 0.9592; val_best_acc_score: 0.9154; val_best_f1_score: 0.9172; train_kl_reg_loss: 59030.9583; train_edge_recon_loss: 579189.3483; train_gene_expr_recon_loss: 18653044.1069; train_masked_gp_l1_reg_loss: 95818.5380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104840.9137; train_chrom_access_recon_loss: 2456123.1985; train_global_loss: 21948047.0534; train_optim_loss: 21948047.0534; val_kl_reg_loss: 59799.9563; val_edge_recon_loss: 584614.4958; val_gene_expr_recon_loss: 18825079.2000; val_masked_gp_l1_reg_loss: 96386.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105532.1328; val_chrom_access_recon_loss: 2498960.8667; val_global_loss: 22170372.4000; val_optim_loss: 22170372.4000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9621; val_auprc_score: 0.9504; val_best_acc_score: 0.9126; val_best_f1_score: 0.9164; train_kl_reg_loss: 59317.0121; train_edge_recon_loss: 579871.0124; train_gene_expr_recon_loss: 18597581.4351; train_masked_gp_l1_reg_loss: 96739.4380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104931.9319; train_chrom_access_recon_loss: 2446510.8950; train_global_loss: 21884951.7099; train_optim_loss: 21884951.7099; val_kl_reg_loss: 59420.3820; val_edge_recon_loss: 580993.6250; val_gene_expr_recon_loss: 18769150.5333; val_masked_gp_l1_reg_loss: 97050.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105085.3438; val_chrom_access_recon_loss: 2483294.9833; val_global_loss: 22094995.2000; val_optim_loss: 22094995.2000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9609; val_auprc_score: 0.9450; val_best_acc_score: 0.9134; val_best_f1_score: 0.9172; train_kl_reg_loss: 59310.0256; train_edge_recon_loss: 578826.2696; train_gene_expr_recon_loss: 18540268.7710; train_masked_gp_l1_reg_loss: 97473.0423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104161.1816; train_chrom_access_recon_loss: 2439804.4466; train_global_loss: 21819843.7557; train_optim_loss: 21819843.7557; val_kl_reg_loss: 58994.7529; val_edge_recon_loss: 582801.8708; val_gene_expr_recon_loss: 18788662.2667; val_masked_gp_l1_reg_loss: 98084.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106029.4609; val_chrom_access_recon_loss: 2483617.3000; val_global_loss: 22118190.4000; val_optim_loss: 22118190.4000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8867; val_auprc_score: 0.8759; val_best_acc_score: 0.7914; val_best_f1_score: 0.7749; train_kl_reg_loss: 20881.5857; train_edge_recon_loss: 769056.7300; train_gene_expr_recon_loss: 17582662.2595; train_masked_gp_l1_reg_loss: 100349.6053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119312.4151; train_chrom_access_recon_loss: 2287736.7729; train_global_loss: 20879999.4656; train_optim_loss: 20879999.4656; val_kl_reg_loss: 6758.8160; val_edge_recon_loss: 803297.2542; val_gene_expr_recon_loss: 17210983.4667; val_masked_gp_l1_reg_loss: 101122.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132565.0000; val_chrom_access_recon_loss: 2278730.4417; val_global_loss: 20533457.0667; val_optim_loss: 20533457.0667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8658; val_auprc_score: 0.8608; val_best_acc_score: 0.7839; val_best_f1_score: 0.7884; train_kl_reg_loss: 9349.3370; train_edge_recon_loss: 783285.0973; train_gene_expr_recon_loss: 17216250.9160; train_masked_gp_l1_reg_loss: 96638.5035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130287.6260; train_chrom_access_recon_loss: 2264249.5229; train_global_loss: 20500061.0534; train_optim_loss: 20500061.0534; val_kl_reg_loss: 7652.2851; val_edge_recon_loss: 804509.7125; val_gene_expr_recon_loss: 17217988.2000; val_masked_gp_l1_reg_loss: 94307.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137145.0625; val_chrom_access_recon_loss: 2289542.8167; val_global_loss: 20551147.0667; val_optim_loss: 20551147.0667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8713; val_auprc_score: 0.8561; val_best_acc_score: 0.7831; val_best_f1_score: 0.7760; train_kl_reg_loss: 8665.6969; train_edge_recon_loss: 783584.9079; train_gene_expr_recon_loss: 17097736.9771; train_masked_gp_l1_reg_loss: 90410.3609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130759.5323; train_chrom_access_recon_loss: 2256275.8034; train_global_loss: 20367433.1756; train_optim_loss: 20367433.1756; val_kl_reg_loss: 7393.9231; val_edge_recon_loss: 800750.7083; val_gene_expr_recon_loss: 17122465.4667; val_masked_gp_l1_reg_loss: 87213.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126132.7500; val_chrom_access_recon_loss: 2273125.1833; val_global_loss: 20417080.8000; val_optim_loss: 20417080.8000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8652; val_auprc_score: 0.8584; val_best_acc_score: 0.7549; val_best_f1_score: 0.7766; train_kl_reg_loss: 8344.2783; train_edge_recon_loss: 774868.7543; train_gene_expr_recon_loss: 17091556.9084; train_masked_gp_l1_reg_loss: 85186.3477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126750.1016; train_chrom_access_recon_loss: 2251267.9637; train_global_loss: 20337974.3359; train_optim_loss: 20337974.3359; val_kl_reg_loss: 5872.8215; val_edge_recon_loss: 797497.4125; val_gene_expr_recon_loss: 17319066.6667; val_masked_gp_l1_reg_loss: 82787.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125262.1172; val_chrom_access_recon_loss: 2286477.4083; val_global_loss: 20616962.9333; val_optim_loss: 20616962.9333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8838; val_auprc_score: 0.8772; val_best_acc_score: 0.7976; val_best_f1_score: 0.8174; train_kl_reg_loss: 9685.3997; train_edge_recon_loss: 771422.6088; train_gene_expr_recon_loss: 17021327.6107; train_masked_gp_l1_reg_loss: 80256.7284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122555.1672; train_chrom_access_recon_loss: 2247961.4160; train_global_loss: 20253208.9924; train_optim_loss: 20253208.9924; val_kl_reg_loss: 7878.2533; val_edge_recon_loss: 782793.6083; val_gene_expr_recon_loss: 17119014.6000; val_masked_gp_l1_reg_loss: 78207.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121615.4609; val_chrom_access_recon_loss: 2279081.8667; val_global_loss: 20388592.4000; val_optim_loss: 20388592.4000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8851; val_auprc_score: 0.8758; val_best_acc_score: 0.7966; val_best_f1_score: 0.8162; train_kl_reg_loss: 10047.3634; train_edge_recon_loss: 766778.4528; train_gene_expr_recon_loss: 16980474.3588; train_masked_gp_l1_reg_loss: 75595.4648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119094.7850; train_chrom_access_recon_loss: 2243873.4761; train_global_loss: 20195863.9542; train_optim_loss: 20195863.9542; val_kl_reg_loss: 9347.5113; val_edge_recon_loss: 774707.1417; val_gene_expr_recon_loss: 17119064.0667; val_masked_gp_l1_reg_loss: 73088.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116086.7031; val_chrom_access_recon_loss: 2271775.4667; val_global_loss: 20364068.0000; val_optim_loss: 20364068.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8953; val_auprc_score: 0.8808; val_best_acc_score: 0.8115; val_best_f1_score: 0.8286; train_kl_reg_loss: 11719.4266; train_edge_recon_loss: 745511.3640; train_gene_expr_recon_loss: 16899407.4275; train_masked_gp_l1_reg_loss: 71753.6130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115761.8873; train_chrom_access_recon_loss: 2239356.5744; train_global_loss: 20083510.2901; train_optim_loss: 20083510.2901; val_kl_reg_loss: 9517.1263; val_edge_recon_loss: 750479.7292; val_gene_expr_recon_loss: 16982753.8000; val_masked_gp_l1_reg_loss: 70227.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114037.5391; val_chrom_access_recon_loss: 2253621.8500; val_global_loss: 20180638.0000; val_optim_loss: 20180638.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9081; val_auprc_score: 0.8976; val_best_acc_score: 0.8208; val_best_f1_score: 0.8336; train_kl_reg_loss: 12062.2211; train_edge_recon_loss: 727833.0377; train_gene_expr_recon_loss: 16884604.0458; train_masked_gp_l1_reg_loss: 68759.7489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112724.8146; train_chrom_access_recon_loss: 2229683.1527; train_global_loss: 20035667.0687; train_optim_loss: 20035667.0687; val_kl_reg_loss: 10144.1473; val_edge_recon_loss: 718416.5583; val_gene_expr_recon_loss: 17059175.7333; val_masked_gp_l1_reg_loss: 67304.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110939.9375; val_chrom_access_recon_loss: 2270360.8333; val_global_loss: 20236341.6000; val_optim_loss: 20236341.6000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9038; val_auprc_score: 0.8908; val_best_acc_score: 0.8254; val_best_f1_score: 0.8369; train_kl_reg_loss: 14203.6563; train_edge_recon_loss: 693214.7066; train_gene_expr_recon_loss: 16835431.9084; train_masked_gp_l1_reg_loss: 65980.2915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109462.1006; train_chrom_access_recon_loss: 2223503.2996; train_global_loss: 19941795.8015; train_optim_loss: 19941795.8015; val_kl_reg_loss: 11276.9290; val_edge_recon_loss: 693432.1917; val_gene_expr_recon_loss: 16988256.2000; val_masked_gp_l1_reg_loss: 64935.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108777.7891; val_chrom_access_recon_loss: 2245657.8500; val_global_loss: 20112337.0667; val_optim_loss: 20112337.0667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8959; val_auprc_score: 0.8823; val_best_acc_score: 0.8137; val_best_f1_score: 0.8298; train_kl_reg_loss: 13754.9924; train_edge_recon_loss: 686575.1369; train_gene_expr_recon_loss: 16834568.2977; train_masked_gp_l1_reg_loss: 64871.2526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110590.4557; train_chrom_access_recon_loss: 2225715.9704; train_global_loss: 19936076.2290; train_optim_loss: 19936076.2290; val_kl_reg_loss: 9418.2410; val_edge_recon_loss: 711381.8083; val_gene_expr_recon_loss: 16917323.6667; val_masked_gp_l1_reg_loss: 64515.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110474.8828; val_chrom_access_recon_loss: 2242580.6583; val_global_loss: 20055694.6667; val_optim_loss: 20055694.6667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9073; val_auprc_score: 0.8959; val_best_acc_score: 0.8265; val_best_f1_score: 0.8418; train_kl_reg_loss: 15114.5636; train_edge_recon_loss: 669944.5363; train_gene_expr_recon_loss: 16797897.3740; train_masked_gp_l1_reg_loss: 63884.6148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107603.4589; train_chrom_access_recon_loss: 2223854.9590; train_global_loss: 19878299.5115; train_optim_loss: 19878299.5115; val_kl_reg_loss: 12346.1695; val_edge_recon_loss: 655161.7875; val_gene_expr_recon_loss: 16954560.9333; val_masked_gp_l1_reg_loss: 63112.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106259.5391; val_chrom_access_recon_loss: 2248126.1667; val_global_loss: 20039566.8000; val_optim_loss: 20039566.8000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8979; val_auprc_score: 0.8817; val_best_acc_score: 0.8226; val_best_f1_score: 0.8370; train_kl_reg_loss: 18256.8746; train_edge_recon_loss: 645088.0310; train_gene_expr_recon_loss: 16796244.3817; train_masked_gp_l1_reg_loss: 62543.9896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102417.3417; train_chrom_access_recon_loss: 2227387.6250; train_global_loss: 19851938.3053; train_optim_loss: 19851938.3053; val_kl_reg_loss: 15502.9025; val_edge_recon_loss: 633996.3917; val_gene_expr_recon_loss: 16897690.5333; val_masked_gp_l1_reg_loss: 61980.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100175.9453; val_chrom_access_recon_loss: 2242615.4000; val_global_loss: 19951961.2000; val_optim_loss: 19951961.2000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9028; val_auprc_score: 0.8816; val_best_acc_score: 0.8305; val_best_f1_score: 0.8465; train_kl_reg_loss: 21261.1269; train_edge_recon_loss: 626899.1703; train_gene_expr_recon_loss: 16736278.9389; train_masked_gp_l1_reg_loss: 61592.6260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98115.5177; train_chrom_access_recon_loss: 2223880.7500; train_global_loss: 19768028.1069; train_optim_loss: 19768028.1069; val_kl_reg_loss: 17627.3438; val_edge_recon_loss: 623291.3042; val_gene_expr_recon_loss: 16870205.4000; val_masked_gp_l1_reg_loss: 61215.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96582.2734; val_chrom_access_recon_loss: 2253264.8000; val_global_loss: 19922186.8000; val_optim_loss: 19922186.8000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9049; val_auprc_score: 0.8856; val_best_acc_score: 0.8288; val_best_f1_score: 0.8435; train_kl_reg_loss: 21286.9212; train_edge_recon_loss: 624060.3120; train_gene_expr_recon_loss: 16710342.2672; train_masked_gp_l1_reg_loss: 60698.6197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95726.9425; train_chrom_access_recon_loss: 2220819.9323; train_global_loss: 19732935.1908; train_optim_loss: 19732935.1908; val_kl_reg_loss: 18938.2854; val_edge_recon_loss: 615531.5542; val_gene_expr_recon_loss: 16848602.6000; val_masked_gp_l1_reg_loss: 60360.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94433.7812; val_chrom_access_recon_loss: 2245666.9833; val_global_loss: 19883533.3333; val_optim_loss: 19883533.3333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9130; val_auprc_score: 0.8988; val_best_acc_score: 0.8358; val_best_f1_score: 0.8487; train_kl_reg_loss: 23757.3285; train_edge_recon_loss: 608437.8635; train_gene_expr_recon_loss: 16671905.4504; train_masked_gp_l1_reg_loss: 60001.4920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92802.6840; train_chrom_access_recon_loss: 2217128.4017; train_global_loss: 19674033.1450; train_optim_loss: 19674033.1450; val_kl_reg_loss: 21272.7195; val_edge_recon_loss: 606137.3375; val_gene_expr_recon_loss: 16766884.9333; val_masked_gp_l1_reg_loss: 59443.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91588.4688; val_chrom_access_recon_loss: 2236183.3750; val_global_loss: 19781510.1333; val_optim_loss: 19781510.1333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9130; val_auprc_score: 0.8977; val_best_acc_score: 0.8296; val_best_f1_score: 0.8431; train_kl_reg_loss: 25381.8037; train_edge_recon_loss: 599202.1512; train_gene_expr_recon_loss: 16661588.9008; train_masked_gp_l1_reg_loss: 59339.4380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90365.0824; train_chrom_access_recon_loss: 2215104.8406; train_global_loss: 19650982.3817; train_optim_loss: 19650982.3817; val_kl_reg_loss: 23648.2747; val_edge_recon_loss: 600793.9708; val_gene_expr_recon_loss: 16804555.6667; val_masked_gp_l1_reg_loss: 59104.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89095.6875; val_chrom_access_recon_loss: 2245563.3417; val_global_loss: 19822761.4667; val_optim_loss: 19822761.4667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9148; val_auprc_score: 0.8990; val_best_acc_score: 0.8363; val_best_f1_score: 0.8491; train_kl_reg_loss: 26315.5086; train_edge_recon_loss: 594240.1102; train_gene_expr_recon_loss: 16649510.5573; train_masked_gp_l1_reg_loss: 58890.7295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88262.5948; train_chrom_access_recon_loss: 2215323.6718; train_global_loss: 19632543.2672; train_optim_loss: 19632543.2672; val_kl_reg_loss: 24315.3156; val_edge_recon_loss: 597070.4208; val_gene_expr_recon_loss: 16822940.6000; val_masked_gp_l1_reg_loss: 58755.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87520.6719; val_chrom_access_recon_loss: 2235359.4250; val_global_loss: 19825962.0000; val_optim_loss: 19825962.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9228; val_auprc_score: 0.9097; val_best_acc_score: 0.8464; val_best_f1_score: 0.8568; train_kl_reg_loss: 27539.1968; train_edge_recon_loss: 590207.8569; train_gene_expr_recon_loss: 16629047.2672; train_masked_gp_l1_reg_loss: 58470.1930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86891.8757; train_chrom_access_recon_loss: 2209844.3502; train_global_loss: 19602000.6718; train_optim_loss: 19602000.6718; val_kl_reg_loss: 25809.1673; val_edge_recon_loss: 585730.9250; val_gene_expr_recon_loss: 16788742.0667; val_masked_gp_l1_reg_loss: 58324.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86108.0859; val_chrom_access_recon_loss: 2248448.8667; val_global_loss: 19793163.0667; val_optim_loss: 19793163.0667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9286; val_auprc_score: 0.9161; val_best_acc_score: 0.8544; val_best_f1_score: 0.8633; train_kl_reg_loss: 28442.1419; train_edge_recon_loss: 584318.4151; train_gene_expr_recon_loss: 16621462.7710; train_masked_gp_l1_reg_loss: 58069.0388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85570.3666; train_chrom_access_recon_loss: 2208064.7653; train_global_loss: 19585927.3740; train_optim_loss: 19585927.3740; val_kl_reg_loss: 27829.9964; val_edge_recon_loss: 583628.4583; val_gene_expr_recon_loss: 16667356.1333; val_masked_gp_l1_reg_loss: 57984.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85300.5703; val_chrom_access_recon_loss: 2220572.8500; val_global_loss: 19642671.3333; val_optim_loss: 19642671.3333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9272; val_auprc_score: 0.9106; val_best_acc_score: 0.8548; val_best_f1_score: 0.8652; train_kl_reg_loss: 29602.8406; train_edge_recon_loss: 580899.1660; train_gene_expr_recon_loss: 16637678.1374; train_masked_gp_l1_reg_loss: 57696.4642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84661.7037; train_chrom_access_recon_loss: 2205629.7452; train_global_loss: 19596168.0305; train_optim_loss: 19596168.0305; val_kl_reg_loss: 28529.3283; val_edge_recon_loss: 581534.1292; val_gene_expr_recon_loss: 16832704.6667; val_masked_gp_l1_reg_loss: 57484.8633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84243.7656; val_chrom_access_recon_loss: 2241590.4000; val_global_loss: 19826086.9333; val_optim_loss: 19826086.9333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9286; val_auprc_score: 0.9116; val_best_acc_score: 0.8544; val_best_f1_score: 0.8630; train_kl_reg_loss: 30519.6561; train_edge_recon_loss: 578389.2152; train_gene_expr_recon_loss: 16597406.1450; train_masked_gp_l1_reg_loss: 57310.6246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83836.2665; train_chrom_access_recon_loss: 2199444.6966; train_global_loss: 19546906.5802; train_optim_loss: 19546906.5802; val_kl_reg_loss: 29756.7098; val_edge_recon_loss: 582172.2500; val_gene_expr_recon_loss: 16754071.9333; val_masked_gp_l1_reg_loss: 57312.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83681.9453; val_chrom_access_recon_loss: 2225928.7917; val_global_loss: 19732924.2667; val_optim_loss: 19732924.2667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9331; val_auprc_score: 0.9179; val_best_acc_score: 0.8618; val_best_f1_score: 0.8711; train_kl_reg_loss: 31308.2015; train_edge_recon_loss: 575779.4451; train_gene_expr_recon_loss: 16602442.9695; train_masked_gp_l1_reg_loss: 57075.6068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83378.6779; train_chrom_access_recon_loss: 2200624.0973; train_global_loss: 19550608.9924; train_optim_loss: 19550608.9924; val_kl_reg_loss: 30131.7491; val_edge_recon_loss: 580286.8625; val_gene_expr_recon_loss: 16681173.7333; val_masked_gp_l1_reg_loss: 56962.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82735.9141; val_chrom_access_recon_loss: 2219694.1167; val_global_loss: 19650984.4000; val_optim_loss: 19650984.4000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9312; val_auprc_score: 0.9162; val_best_acc_score: 0.8605; val_best_f1_score: 0.8706; train_kl_reg_loss: 31825.8516; train_edge_recon_loss: 574175.4475; train_gene_expr_recon_loss: 16596817.1450; train_masked_gp_l1_reg_loss: 56816.9684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82884.0201; train_chrom_access_recon_loss: 2200133.4924; train_global_loss: 19542652.9008; train_optim_loss: 19542652.9008; val_kl_reg_loss: 30892.6671; val_edge_recon_loss: 580142.6625; val_gene_expr_recon_loss: 16771627.7333; val_masked_gp_l1_reg_loss: 56732.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82849.2969; val_chrom_access_recon_loss: 2229314.5917; val_global_loss: 19751559.4667; val_optim_loss: 19751559.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9336; val_auprc_score: 0.9205; val_best_acc_score: 0.8603; val_best_f1_score: 0.8696; train_kl_reg_loss: 32027.1970; train_edge_recon_loss: 573915.1517; train_gene_expr_recon_loss: 16600446.9695; train_masked_gp_l1_reg_loss: 56053.2656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65240.1999; train_chrom_access_recon_loss: 2202988.4733; train_global_loss: 19530671.4046; train_optim_loss: 19530671.4046; val_kl_reg_loss: 31753.7661; val_edge_recon_loss: 578497.0375; val_gene_expr_recon_loss: 16718520.9333; val_masked_gp_l1_reg_loss: 55842.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63200.8906; val_chrom_access_recon_loss: 2223093.1167; val_global_loss: 19670907.0667; val_optim_loss: 19670907.0667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9333; val_auprc_score: 0.9174; val_best_acc_score: 0.8688; val_best_f1_score: 0.8753; train_kl_reg_loss: 32653.5051; train_edge_recon_loss: 574438.7648; train_gene_expr_recon_loss: 16569583.2137; train_masked_gp_l1_reg_loss: 55777.5190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62759.5159; train_chrom_access_recon_loss: 2198138.1517; train_global_loss: 19493350.7176; train_optim_loss: 19493350.7176; val_kl_reg_loss: 32141.0426; val_edge_recon_loss: 574240.0208; val_gene_expr_recon_loss: 16736704.2000; val_masked_gp_l1_reg_loss: 55719.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62373.2031; val_chrom_access_recon_loss: 2221503.1167; val_global_loss: 19682681.7333; val_optim_loss: 19682681.7333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9340; val_auprc_score: 0.9165; val_best_acc_score: 0.8666; val_best_f1_score: 0.8728; train_kl_reg_loss: 33126.4148; train_edge_recon_loss: 572396.7109; train_gene_expr_recon_loss: 16571385.6794; train_masked_gp_l1_reg_loss: 55674.3487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62057.2377; train_chrom_access_recon_loss: 2197529.0410; train_global_loss: 19492169.4809; train_optim_loss: 19492169.4809; val_kl_reg_loss: 32645.5008; val_edge_recon_loss: 575203.8250; val_gene_expr_recon_loss: 16770040.8667; val_masked_gp_l1_reg_loss: 55624.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61750.2266; val_chrom_access_recon_loss: 2224614.6417; val_global_loss: 19719878.8000; val_optim_loss: 19719878.8000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9322; val_auprc_score: 0.9177; val_best_acc_score: 0.8669; val_best_f1_score: 0.8723; train_kl_reg_loss: 33392.1738; train_edge_recon_loss: 572763.2290; train_gene_expr_recon_loss: 16566667.3740; train_masked_gp_l1_reg_loss: 55573.1176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61605.1780; train_chrom_access_recon_loss: 2196151.6135; train_global_loss: 19486152.8092; train_optim_loss: 19486152.8092; val_kl_reg_loss: 32416.8770; val_edge_recon_loss: 577938.3708; val_gene_expr_recon_loss: 16734830.5333; val_masked_gp_l1_reg_loss: 55532.7852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61310.3320; val_chrom_access_recon_loss: 2226320.2000; val_global_loss: 19688348.2667; val_optim_loss: 19688348.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 33 min 53 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9277
val AUPRC score: 0.9149
val best accuracy score: 0.8523
val best F1 score: 0.8646
val target rna MSE score: 2.1233
val source rna MSE score: 0.9370
val target atac MSE score: 0.5202
val source atac MSE score: 0.1626
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
