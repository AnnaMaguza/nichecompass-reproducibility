[True]
Run timestamp: 21072023_091334_1020.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '20', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000.', '--lambda_gene_expr_recon', '30000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100.0', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1020']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 3031 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 3031, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1507, n_latent: 1507, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1507, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 6062
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 529546
Number of validation edges: 58838
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9098; val_auprc_score: 0.9807; val_best_acc_score: 0.8521; val_best_f1_score: 0.9202; train_kl_reg_loss: 716437.1624; train_edge_recon_loss: 11368305.8726; train_gene_expr_recon_loss: 336807894.7336; train_masked_gp_l1_reg_loss: 122413.1231; train_group_lasso_reg_loss: 0.0000; train_global_loss: 349015051.3668; train_optim_loss: 349015051.3668; val_kl_reg_loss: 982414.8125; val_edge_recon_loss: 12021718.6552; val_gene_expr_recon_loss: 329294622.8966; val_masked_gp_l1_reg_loss: 133333.0312; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342432099.3103; val_optim_loss: 342432099.3103
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8957; val_auprc_score: 0.9782; val_best_acc_score: 0.8521; val_best_f1_score: 0.9202; train_kl_reg_loss: 562468.2389; train_edge_recon_loss: 11864561.4672; train_gene_expr_recon_loss: 313652125.0965; train_masked_gp_l1_reg_loss: 136426.2064; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326215581.5907; train_optim_loss: 326215581.5907; val_kl_reg_loss: 372513.0668; val_edge_recon_loss: 12018500.0345; val_gene_expr_recon_loss: 298727755.0345; val_masked_gp_l1_reg_loss: 136870.5625; val_group_lasso_reg_loss: 0.0000; val_global_loss: 311255630.3448; val_optim_loss: 311255630.3448
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8919; val_auprc_score: 0.9774; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 312814.5742; train_edge_recon_loss: 11870053.0695; train_gene_expr_recon_loss: 295941227.7375; train_masked_gp_l1_reg_loss: 138288.1369; train_group_lasso_reg_loss: 0.0000; train_global_loss: 308262384.3089; train_optim_loss: 308262384.3089; val_kl_reg_loss: 448601.5711; val_edge_recon_loss: 12081164.1724; val_gene_expr_recon_loss: 286004182.0690; val_masked_gp_l1_reg_loss: 139955.1250; val_group_lasso_reg_loss: 0.0000; val_global_loss: 298673914.4828; val_optim_loss: 298673914.4828
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8855; val_auprc_score: 0.9764; val_best_acc_score: 0.8535; val_best_f1_score: 0.9209; train_kl_reg_loss: 204778.5941; train_edge_recon_loss: 11849746.6602; train_gene_expr_recon_loss: 284886404.4479; train_masked_gp_l1_reg_loss: 145881.8101; train_group_lasso_reg_loss: 0.0000; train_global_loss: 297086810.9344; train_optim_loss: 297086810.9344; val_kl_reg_loss: 217643.6245; val_edge_recon_loss: 11949371.9310; val_gene_expr_recon_loss: 280461209.3793; val_masked_gp_l1_reg_loss: 150170.4219; val_group_lasso_reg_loss: 0.0000; val_global_loss: 292778397.7931; val_optim_loss: 292778397.7931
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8822; val_auprc_score: 0.9753; val_best_acc_score: 0.8691; val_best_f1_score: 0.9287; train_kl_reg_loss: 141273.8109; train_edge_recon_loss: 11910973.5367; train_gene_expr_recon_loss: 276004818.2857; train_masked_gp_l1_reg_loss: 152488.3383; train_group_lasso_reg_loss: 0.0000; train_global_loss: 288209554.1622; train_optim_loss: 288209554.1622; val_kl_reg_loss: 100912.5749; val_edge_recon_loss: 11946709.5862; val_gene_expr_recon_loss: 272541993.3793; val_masked_gp_l1_reg_loss: 155734.8438; val_group_lasso_reg_loss: 0.0000; val_global_loss: 284745359.4483; val_optim_loss: 284745359.4483
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8618; val_auprc_score: 0.9721; val_best_acc_score: 0.8644; val_best_f1_score: 0.9254; train_kl_reg_loss: 77266.3279; train_edge_recon_loss: 11416316.3514; train_gene_expr_recon_loss: 225231467.5521; train_masked_gp_l1_reg_loss: 178494.6030; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236903544.1853; train_optim_loss: 236903544.1853; val_kl_reg_loss: 122106.3413; val_edge_recon_loss: 11926468.0000; val_gene_expr_recon_loss: 116590637.2414; val_masked_gp_l1_reg_loss: 204512.5938; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128843723.3103; val_optim_loss: 128843723.3103
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8539; val_auprc_score: 0.9680; val_best_acc_score: 0.8728; val_best_f1_score: 0.9297; train_kl_reg_loss: 150842.6537; train_edge_recon_loss: 10655366.7838; train_gene_expr_recon_loss: 96775078.8880; train_masked_gp_l1_reg_loss: 201746.0810; train_group_lasso_reg_loss: 0.0000; train_global_loss: 107783034.4710; train_optim_loss: 107783034.4710; val_kl_reg_loss: 161876.9736; val_edge_recon_loss: 11973010.3448; val_gene_expr_recon_loss: 92383630.0690; val_masked_gp_l1_reg_loss: 198615.3125; val_group_lasso_reg_loss: 0.0000; val_global_loss: 104717132.6897; val_optim_loss: 104717132.6897
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8614; val_auprc_score: 0.9701; val_best_acc_score: 0.8756; val_best_f1_score: 0.9302; train_kl_reg_loss: 165453.0218; train_edge_recon_loss: 10657814.9421; train_gene_expr_recon_loss: 91618574.0541; train_masked_gp_l1_reg_loss: 197423.3323; train_group_lasso_reg_loss: 0.0000; train_global_loss: 102639265.5753; train_optim_loss: 102639265.5753; val_kl_reg_loss: 169561.0248; val_edge_recon_loss: 11837446.8276; val_gene_expr_recon_loss: 90518321.1034; val_masked_gp_l1_reg_loss: 197112.9688; val_group_lasso_reg_loss: 0.0000; val_global_loss: 102722440.5517; val_optim_loss: 102722440.5517
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8648; val_auprc_score: 0.9706; val_best_acc_score: 0.8821; val_best_f1_score: 0.9321; train_kl_reg_loss: 175680.4132; train_edge_recon_loss: 10548250.6757; train_gene_expr_recon_loss: 89891504.8340; train_masked_gp_l1_reg_loss: 197890.7189; train_group_lasso_reg_loss: 0.0000; train_global_loss: 100813327.0116; train_optim_loss: 100813327.0116; val_kl_reg_loss: 178437.9402; val_edge_recon_loss: 11721526.6207; val_gene_expr_recon_loss: 89019886.3448; val_masked_gp_l1_reg_loss: 199010.2188; val_group_lasso_reg_loss: 0.0000; val_global_loss: 101118858.7586; val_optim_loss: 101118858.7586
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8693; val_auprc_score: 0.9706; val_best_acc_score: 0.8898; val_best_f1_score: 0.9384; train_kl_reg_loss: 184005.8011; train_edge_recon_loss: 10533845.6409; train_gene_expr_recon_loss: 88410139.0579; train_masked_gp_l1_reg_loss: 200355.6222; train_group_lasso_reg_loss: 0.0000; train_global_loss: 99328346.3475; train_optim_loss: 99328346.3475; val_kl_reg_loss: 188176.4084; val_edge_recon_loss: 11733225.3103; val_gene_expr_recon_loss: 87531926.0690; val_masked_gp_l1_reg_loss: 201839.7656; val_group_lasso_reg_loss: 0.0000; val_global_loss: 99655167.7241; val_optim_loss: 99655167.7241
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8763; val_auprc_score: 0.9718; val_best_acc_score: 0.9015; val_best_f1_score: 0.9442; train_kl_reg_loss: 181507.7898; train_edge_recon_loss: 10447696.1699; train_gene_expr_recon_loss: 87038525.4054; train_masked_gp_l1_reg_loss: 203270.0674; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97870999.5367; train_optim_loss: 97870999.5367; val_kl_reg_loss: 175244.6584; val_edge_recon_loss: 11431652.2414; val_gene_expr_recon_loss: 86248377.9310; val_masked_gp_l1_reg_loss: 204784.0156; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98060058.4828; val_optim_loss: 98060058.4828
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8799; val_auprc_score: 0.9720; val_best_acc_score: 0.9097; val_best_f1_score: 0.9488; train_kl_reg_loss: 171482.4282; train_edge_recon_loss: 10313962.4672; train_gene_expr_recon_loss: 85808345.7606; train_masked_gp_l1_reg_loss: 206264.9001; train_group_lasso_reg_loss: 0.0000; train_global_loss: 96500055.6602; train_optim_loss: 96500055.6602; val_kl_reg_loss: 155924.8658; val_edge_recon_loss: 10965231.9655; val_gene_expr_recon_loss: 85025022.6207; val_masked_gp_l1_reg_loss: 207810.5938; val_group_lasso_reg_loss: 0.0000; val_global_loss: 96353987.3103; val_optim_loss: 96353987.3103
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8883; val_auprc_score: 0.9733; val_best_acc_score: 0.9131; val_best_f1_score: 0.9505; train_kl_reg_loss: 157500.1663; train_edge_recon_loss: 10154427.9382; train_gene_expr_recon_loss: 84708347.8610; train_masked_gp_l1_reg_loss: 209232.5778; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95229508.5405; train_optim_loss: 95229508.5405; val_kl_reg_loss: 143205.4510; val_edge_recon_loss: 10697049.5517; val_gene_expr_recon_loss: 84060933.7931; val_masked_gp_l1_reg_loss: 210693.0625; val_group_lasso_reg_loss: 0.0000; val_global_loss: 95111885.2414; val_optim_loss: 95111885.2414
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8958; val_auprc_score: 0.9748; val_best_acc_score: 0.9154; val_best_f1_score: 0.9519; train_kl_reg_loss: 85676.0123; train_edge_recon_loss: 10586003.2780; train_gene_expr_recon_loss: 89389044.5097; train_masked_gp_l1_reg_loss: 224526.9012; train_group_lasso_reg_loss: 0.0000; train_global_loss: 100285250.8108; train_optim_loss: 100285250.8108; val_kl_reg_loss: 107870.1452; val_edge_recon_loss: 10880649.5517; val_gene_expr_recon_loss: 84748848.5517; val_masked_gp_l1_reg_loss: 233812.2500; val_group_lasso_reg_loss: 0.0000; val_global_loss: 95971184.0000; val_optim_loss: 95971184.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8929; val_auprc_score: 0.9735; val_best_acc_score: 0.9132; val_best_f1_score: 0.9505; train_kl_reg_loss: 104768.4526; train_edge_recon_loss: 10174893.7606; train_gene_expr_recon_loss: 83768781.6525; train_masked_gp_l1_reg_loss: 232396.5441; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94280840.2780; train_optim_loss: 94280840.2780; val_kl_reg_loss: 95260.0154; val_edge_recon_loss: 10445235.6207; val_gene_expr_recon_loss: 83056281.1034; val_masked_gp_l1_reg_loss: 231999.6875; val_group_lasso_reg_loss: 0.0000; val_global_loss: 93828776.5517; val_optim_loss: 93828776.5517
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8903; val_auprc_score: 0.9735; val_best_acc_score: 0.9098; val_best_f1_score: 0.9487; train_kl_reg_loss: 100945.5649; train_edge_recon_loss: 9837848.4093; train_gene_expr_recon_loss: 82787885.6834; train_masked_gp_l1_reg_loss: 232802.5948; train_group_lasso_reg_loss: 0.0000; train_global_loss: 92959482.4402; train_optim_loss: 92959482.4402; val_kl_reg_loss: 105582.5013; val_edge_recon_loss: 10033129.8276; val_gene_expr_recon_loss: 82233686.0690; val_masked_gp_l1_reg_loss: 233609.1562; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92606005.7931; val_optim_loss: 92606005.7931
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8868; val_auprc_score: 0.9729; val_best_acc_score: 0.9067; val_best_f1_score: 0.9472; train_kl_reg_loss: 106945.7238; train_edge_recon_loss: 9594916.2703; train_gene_expr_recon_loss: 81966870.0541; train_masked_gp_l1_reg_loss: 234620.3729; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91903352.5251; train_optim_loss: 91903352.5251; val_kl_reg_loss: 110509.3093; val_edge_recon_loss: 9637527.4138; val_gene_expr_recon_loss: 81485953.1034; val_masked_gp_l1_reg_loss: 235885.4219; val_group_lasso_reg_loss: 0.0000; val_global_loss: 91469877.7931; val_optim_loss: 91469877.7931
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8846; val_auprc_score: 0.9726; val_best_acc_score: 0.9049; val_best_f1_score: 0.9462; train_kl_reg_loss: 120026.2362; train_edge_recon_loss: 9384853.8108; train_gene_expr_recon_loss: 81301377.8224; train_masked_gp_l1_reg_loss: 237323.4725; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91043581.4054; train_optim_loss: 91043581.4054; val_kl_reg_loss: 128851.5727; val_edge_recon_loss: 9407069.5172; val_gene_expr_recon_loss: 80730664.8276; val_masked_gp_l1_reg_loss: 238732.6250; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90505322.2069; val_optim_loss: 90505322.2069
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8779; val_auprc_score: 0.9708; val_best_acc_score: 0.9043; val_best_f1_score: 0.9461; train_kl_reg_loss: 140252.5293; train_edge_recon_loss: 9194251.2896; train_gene_expr_recon_loss: 80574486.3320; train_masked_gp_l1_reg_loss: 240488.2930; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90149478.4556; train_optim_loss: 90149478.4556; val_kl_reg_loss: 148211.7392; val_edge_recon_loss: 9203718.9310; val_gene_expr_recon_loss: 80228966.3448; val_masked_gp_l1_reg_loss: 241958.2344; val_group_lasso_reg_loss: 0.0000; val_global_loss: 89822857.3793; val_optim_loss: 89822857.3793
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8830; val_auprc_score: 0.9734; val_best_acc_score: 0.9054; val_best_f1_score: 0.9468; train_kl_reg_loss: 162231.7069; train_edge_recon_loss: 9130261.0328; train_gene_expr_recon_loss: 80015596.3552; train_masked_gp_l1_reg_loss: 243535.7974; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89551624.6486; train_optim_loss: 89551624.6486; val_kl_reg_loss: 169809.6870; val_edge_recon_loss: 8945496.2759; val_gene_expr_recon_loss: 79514549.5172; val_masked_gp_l1_reg_loss: 244817.1406; val_group_lasso_reg_loss: 0.0000; val_global_loss: 88874671.1724; val_optim_loss: 88874671.1724
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8827; val_auprc_score: 0.9727; val_best_acc_score: 0.9044; val_best_f1_score: 0.9462; train_kl_reg_loss: 181214.3302; train_edge_recon_loss: 8984053.2027; train_gene_expr_recon_loss: 79421598.2085; train_masked_gp_l1_reg_loss: 245942.4642; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88832808.2471; train_optim_loss: 88832808.2471; val_kl_reg_loss: 184735.6848; val_edge_recon_loss: 9036553.5690; val_gene_expr_recon_loss: 78923894.0690; val_masked_gp_l1_reg_loss: 247010.8906; val_group_lasso_reg_loss: 0.0000; val_global_loss: 88392191.1724; val_optim_loss: 88392191.1724
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8858; val_auprc_score: 0.9739; val_best_acc_score: 0.9068; val_best_f1_score: 0.9475; train_kl_reg_loss: 193154.5801; train_edge_recon_loss: 8879353.7046; train_gene_expr_recon_loss: 78907657.9768; train_masked_gp_l1_reg_loss: 247648.4158; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88227814.3320; train_optim_loss: 88227814.3320; val_kl_reg_loss: 194456.9952; val_edge_recon_loss: 8912738.7931; val_gene_expr_recon_loss: 78614716.1379; val_masked_gp_l1_reg_loss: 248181.7188; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87970096.5517; val_optim_loss: 87970096.5517
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8882; val_auprc_score: 0.9749; val_best_acc_score: 0.9094; val_best_f1_score: 0.9491; train_kl_reg_loss: 198805.4667; train_edge_recon_loss: 8808632.9093; train_gene_expr_recon_loss: 78578743.1660; train_masked_gp_l1_reg_loss: 248431.1343; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87834612.7259; train_optim_loss: 87834612.7259; val_kl_reg_loss: 196970.2064; val_edge_recon_loss: 8699975.5345; val_gene_expr_recon_loss: 78185685.5172; val_masked_gp_l1_reg_loss: 248709.4688; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87331343.1724; val_optim_loss: 87331343.1724
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8964; val_auprc_score: 0.9767; val_best_acc_score: 0.9105; val_best_f1_score: 0.9496; train_kl_reg_loss: 199415.4110; train_edge_recon_loss: 8695983.2027; train_gene_expr_recon_loss: 78190080.9884; train_masked_gp_l1_reg_loss: 248951.2939; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87334431.0116; train_optim_loss: 87334431.0116; val_kl_reg_loss: 198327.2586; val_edge_recon_loss: 8665944.1552; val_gene_expr_recon_loss: 77788049.3793; val_masked_gp_l1_reg_loss: 249008.7188; val_group_lasso_reg_loss: 0.0000; val_global_loss: 86901329.1034; val_optim_loss: 86901329.1034
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9012; val_auprc_score: 0.9782; val_best_acc_score: 0.9119; val_best_f1_score: 0.9503; train_kl_reg_loss: 198423.2101; train_edge_recon_loss: 8631842.9131; train_gene_expr_recon_loss: 77825104.4324; train_masked_gp_l1_reg_loss: 248927.8240; train_group_lasso_reg_loss: 0.0000; train_global_loss: 86904298.5946; train_optim_loss: 86904298.5946; val_kl_reg_loss: 195793.7877; val_edge_recon_loss: 8569251.5172; val_gene_expr_recon_loss: 77442793.1034; val_masked_gp_l1_reg_loss: 248808.5469; val_group_lasso_reg_loss: 0.0000; val_global_loss: 86456646.3448; val_optim_loss: 86456646.3448
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9003; val_auprc_score: 0.9757; val_best_acc_score: 0.9155; val_best_f1_score: 0.9519; train_kl_reg_loss: 93965.5023; train_edge_recon_loss: 11259676.3089; train_gene_expr_recon_loss: 81092114.1622; train_masked_gp_l1_reg_loss: 260808.2513; train_group_lasso_reg_loss: 0.0000; train_global_loss: 92706564.4170; train_optim_loss: 92706564.4170; val_kl_reg_loss: 19805.6548; val_edge_recon_loss: 11066943.6207; val_gene_expr_recon_loss: 78870678.6207; val_masked_gp_l1_reg_loss: 265935.8125; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90223363.8621; val_optim_loss: 90223363.8621
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9127; val_auprc_score: 0.9778; val_best_acc_score: 0.9230; val_best_f1_score: 0.9558; train_kl_reg_loss: 99600.8403; train_edge_recon_loss: 10732899.7027; train_gene_expr_recon_loss: 79235003.1815; train_masked_gp_l1_reg_loss: 263101.3065; train_group_lasso_reg_loss: 0.0000; train_global_loss: 90330605.0965; train_optim_loss: 90330605.0965; val_kl_reg_loss: 20772.0664; val_edge_recon_loss: 10602610.3793; val_gene_expr_recon_loss: 79202762.2069; val_masked_gp_l1_reg_loss: 262663.4375; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90088809.1034; val_optim_loss: 90088809.1034
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9109; val_auprc_score: 0.9775; val_best_acc_score: 0.9221; val_best_f1_score: 0.9552; train_kl_reg_loss: 113835.6972; train_edge_recon_loss: 10217079.6139; train_gene_expr_recon_loss: 78759190.9807; train_masked_gp_l1_reg_loss: 263507.0442; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89353613.4672; train_optim_loss: 89353613.4672; val_kl_reg_loss: 24481.8743; val_edge_recon_loss: 10160316.2069; val_gene_expr_recon_loss: 78333164.1379; val_masked_gp_l1_reg_loss: 263331.1875; val_group_lasso_reg_loss: 0.0000; val_global_loss: 88781290.7586; val_optim_loss: 88781290.7586
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9061; val_auprc_score: 0.9764; val_best_acc_score: 0.9191; val_best_f1_score: 0.9535; train_kl_reg_loss: 125869.4136; train_edge_recon_loss: 9775442.7104; train_gene_expr_recon_loss: 78273883.4595; train_masked_gp_l1_reg_loss: 261493.0828; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88436688.9884; train_optim_loss: 88436688.9884; val_kl_reg_loss: 29586.3225; val_edge_recon_loss: 9645340.6552; val_gene_expr_recon_loss: 77853113.1034; val_masked_gp_l1_reg_loss: 259606.9375; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87787648.2759; val_optim_loss: 87787648.2759

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9092; val_auprc_score: 0.9774; val_best_acc_score: 0.9194; val_best_f1_score: 0.9537; train_kl_reg_loss: 130368.1972; train_edge_recon_loss: 9575247.9344; train_gene_expr_recon_loss: 78061970.9961; train_masked_gp_l1_reg_loss: 259199.4016; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88026786.4093; train_optim_loss: 88026786.4093; val_kl_reg_loss: 30156.3087; val_edge_recon_loss: 9623569.1034; val_gene_expr_recon_loss: 77895139.5862; val_masked_gp_l1_reg_loss: 259013.5781; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87807880.5517; val_optim_loss: 87807880.5517
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9117; val_auprc_score: 0.9781; val_best_acc_score: 0.9195; val_best_f1_score: 0.9540; train_kl_reg_loss: 131160.0172; train_edge_recon_loss: 9636070.5097; train_gene_expr_recon_loss: 77991554.7181; train_masked_gp_l1_reg_loss: 258830.3244; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88017615.3514; train_optim_loss: 88017615.3514; val_kl_reg_loss: 30512.5386; val_edge_recon_loss: 9494087.3793; val_gene_expr_recon_loss: 77795817.3793; val_masked_gp_l1_reg_loss: 258633.9375; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87579049.6552; val_optim_loss: 87579049.6552
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9069; val_auprc_score: 0.9765; val_best_acc_score: 0.9180; val_best_f1_score: 0.9530; train_kl_reg_loss: 131662.5705; train_edge_recon_loss: 9556647.9305; train_gene_expr_recon_loss: 77905962.9344; train_masked_gp_l1_reg_loss: 258421.0965; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87852694.1776; train_optim_loss: 87852694.1776; val_kl_reg_loss: 30695.1476; val_edge_recon_loss: 9624354.7586; val_gene_expr_recon_loss: 77680405.2414; val_masked_gp_l1_reg_loss: 258226.4219; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87593679.4483; val_optim_loss: 87593679.4483
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9109; val_auprc_score: 0.9774; val_best_acc_score: 0.9202; val_best_f1_score: 0.9543; train_kl_reg_loss: 132911.3355; train_edge_recon_loss: 9578210.9247; train_gene_expr_recon_loss: 77974143.1042; train_masked_gp_l1_reg_loss: 258017.8088; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87943283.4595; train_optim_loss: 87943283.4595; val_kl_reg_loss: 29508.1116; val_edge_recon_loss: 9630262.2759; val_gene_expr_recon_loss: 77860537.6552; val_masked_gp_l1_reg_loss: 257798.1875; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87778108.9655; val_optim_loss: 87778108.9655

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 127 min 22 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9383
Val AUPRC score: 0.9855
Val best accuracy score: 0.9411
Val best F1 score: 0.9660
Val gene expr MSE score: 4078.8637
Val cat covariate0 mean sim diff: -0.0019

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
