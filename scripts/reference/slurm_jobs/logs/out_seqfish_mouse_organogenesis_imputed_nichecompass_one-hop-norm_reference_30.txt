[True]
Run timestamp: 26072023_211336_30.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_30']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8397; val_auprc_score: 0.9677; val_best_acc_score: 0.8749; val_best_f1_score: 0.9311; train_kl_reg_loss: 247219.3312; train_edge_recon_loss: 118233.6920; train_gene_expr_recon_loss: 16057147.8000; train_masked_gp_l1_reg_loss: 14564.4309; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16437165.2651; train_optim_loss: 16437165.2651; val_kl_reg_loss: 241460.1146; val_edge_recon_loss: 114058.2474; val_gene_expr_recon_loss: 10357666.8750; val_masked_gp_l1_reg_loss: 14939.5215; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10728125.1667; val_optim_loss: 10728125.1667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8597; val_auprc_score: 0.9702; val_best_acc_score: 0.8749; val_best_f1_score: 0.9309; train_kl_reg_loss: 215135.7419; train_edge_recon_loss: 119199.2422; train_gene_expr_recon_loss: 10004719.3721; train_masked_gp_l1_reg_loss: 15182.9188; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10354237.3163; train_optim_loss: 10354237.3163; val_kl_reg_loss: 180489.6172; val_edge_recon_loss: 115488.4264; val_gene_expr_recon_loss: 9733036.7500; val_masked_gp_l1_reg_loss: 15400.0312; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10044414.8333; val_optim_loss: 10044414.8333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8753; val_auprc_score: 0.9737; val_best_acc_score: 0.8850; val_best_f1_score: 0.9352; train_kl_reg_loss: 170972.6028; train_edge_recon_loss: 116942.4774; train_gene_expr_recon_loss: 9512851.9628; train_masked_gp_l1_reg_loss: 15613.7033; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9816380.7256; train_optim_loss: 9816380.7256; val_kl_reg_loss: 151690.9043; val_edge_recon_loss: 116035.1738; val_gene_expr_recon_loss: 9330138.2083; val_masked_gp_l1_reg_loss: 15832.2910; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9613696.4167; val_optim_loss: 9613696.4167
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8813; val_auprc_score: 0.9735; val_best_acc_score: 0.8912; val_best_f1_score: 0.9378; train_kl_reg_loss: 146328.3526; train_edge_recon_loss: 118283.9166; train_gene_expr_recon_loss: 9173999.4326; train_masked_gp_l1_reg_loss: 16052.7125; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9454664.4000; train_optim_loss: 9454664.4000; val_kl_reg_loss: 132423.7786; val_edge_recon_loss: 115123.6989; val_gene_expr_recon_loss: 9043011.3333; val_masked_gp_l1_reg_loss: 16273.2871; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9306831.7500; val_optim_loss: 9306831.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8945; val_auprc_score: 0.9777; val_best_acc_score: 0.8915; val_best_f1_score: 0.9371; train_kl_reg_loss: 129836.1932; train_edge_recon_loss: 116778.6175; train_gene_expr_recon_loss: 8909777.6372; train_masked_gp_l1_reg_loss: 16518.8481; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9172911.2837; train_optim_loss: 9172911.2837; val_kl_reg_loss: 119151.0322; val_edge_recon_loss: 117980.5671; val_gene_expr_recon_loss: 8804901.4583; val_masked_gp_l1_reg_loss: 16778.5996; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9058812.0417; val_optim_loss: 9058812.0417
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9010; val_auprc_score: 0.9785; val_best_acc_score: 0.8904; val_best_f1_score: 0.9378; train_kl_reg_loss: 116752.3291; train_edge_recon_loss: 117455.4764; train_gene_expr_recon_loss: 8687594.4977; train_masked_gp_l1_reg_loss: 17039.0101; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8938841.3023; train_optim_loss: 8938841.3023; val_kl_reg_loss: 106724.0186; val_edge_recon_loss: 118917.1969; val_gene_expr_recon_loss: 8596961.4583; val_masked_gp_l1_reg_loss: 17300.7949; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8839903.6667; val_optim_loss: 8839903.6667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9060; val_auprc_score: 0.9797; val_best_acc_score: 0.8973; val_best_f1_score: 0.9416; train_kl_reg_loss: 104864.0379; train_edge_recon_loss: 116264.0215; train_gene_expr_recon_loss: 8557754.3977; train_masked_gp_l1_reg_loss: 17613.6318; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8796496.1349; train_optim_loss: 8796496.1349; val_kl_reg_loss: 96789.2614; val_edge_recon_loss: 116062.1986; val_gene_expr_recon_loss: 8421189.6250; val_masked_gp_l1_reg_loss: 17860.9160; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8651902.0833; val_optim_loss: 8651902.0833
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9102; val_auprc_score: 0.9813; val_best_acc_score: 0.9008; val_best_f1_score: 0.9430; train_kl_reg_loss: 94865.5007; train_edge_recon_loss: 114949.2898; train_gene_expr_recon_loss: 8331702.5535; train_masked_gp_l1_reg_loss: 18050.7996; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8559568.1535; train_optim_loss: 8559568.1535; val_kl_reg_loss: 86302.3499; val_edge_recon_loss: 115352.5449; val_gene_expr_recon_loss: 8263658.9167; val_masked_gp_l1_reg_loss: 18244.0469; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8483557.8750; val_optim_loss: 8483557.8750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9211; val_auprc_score: 0.9835; val_best_acc_score: 0.9042; val_best_f1_score: 0.9443; train_kl_reg_loss: 86250.0661; train_edge_recon_loss: 115227.5083; train_gene_expr_recon_loss: 8184370.3302; train_masked_gp_l1_reg_loss: 18414.7310; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8404262.6558; train_optim_loss: 8404262.6558; val_kl_reg_loss: 79196.4362; val_edge_recon_loss: 116363.0094; val_gene_expr_recon_loss: 8130425.0833; val_masked_gp_l1_reg_loss: 18590.5059; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8344574.9583; val_optim_loss: 8344574.9583
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9204; val_auprc_score: 0.9823; val_best_acc_score: 0.9071; val_best_f1_score: 0.9457; train_kl_reg_loss: 79395.0620; train_edge_recon_loss: 114908.6950; train_gene_expr_recon_loss: 8061193.1930; train_masked_gp_l1_reg_loss: 18768.0098; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8274264.9349; train_optim_loss: 8274264.9349; val_kl_reg_loss: 73466.5605; val_edge_recon_loss: 114093.1650; val_gene_expr_recon_loss: 8013925.3750; val_masked_gp_l1_reg_loss: 18940.2227; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8220425.1042; val_optim_loss: 8220425.1042
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9237; val_auprc_score: 0.9841; val_best_acc_score: 0.9042; val_best_f1_score: 0.9452; train_kl_reg_loss: 73821.2263; train_edge_recon_loss: 113775.8043; train_gene_expr_recon_loss: 7951208.7093; train_masked_gp_l1_reg_loss: 19117.4104; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8157923.1651; train_optim_loss: 8157923.1651; val_kl_reg_loss: 68392.1517; val_edge_recon_loss: 114208.5739; val_gene_expr_recon_loss: 7906997.2500; val_masked_gp_l1_reg_loss: 19281.6641; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8108879.5208; val_optim_loss: 8108879.5208
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9223; val_auprc_score: 0.9845; val_best_acc_score: 0.9068; val_best_f1_score: 0.9465; train_kl_reg_loss: 69005.0782; train_edge_recon_loss: 114560.0242; train_gene_expr_recon_loss: 7856462.2186; train_masked_gp_l1_reg_loss: 19452.2739; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8059479.6070; train_optim_loss: 8059479.6070; val_kl_reg_loss: 64836.6698; val_edge_recon_loss: 112856.8958; val_gene_expr_recon_loss: 7815917.0417; val_masked_gp_l1_reg_loss: 19622.8496; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8013233.5833; val_optim_loss: 8013233.5833
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9287; val_auprc_score: 0.9854; val_best_acc_score: 0.9083; val_best_f1_score: 0.9469; train_kl_reg_loss: 64881.5865; train_edge_recon_loss: 114229.3506; train_gene_expr_recon_loss: 7768395.9953; train_masked_gp_l1_reg_loss: 19775.7560; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7967282.7093; train_optim_loss: 7967282.7093; val_kl_reg_loss: 60485.5659; val_edge_recon_loss: 113908.9277; val_gene_expr_recon_loss: 7738266.7292; val_masked_gp_l1_reg_loss: 19941.0293; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7932602.1875; val_optim_loss: 7932602.1875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9310; val_auprc_score: 0.9860; val_best_acc_score: 0.9114; val_best_f1_score: 0.9484; train_kl_reg_loss: 61077.3458; train_edge_recon_loss: 112625.9159; train_gene_expr_recon_loss: 7690331.3744; train_masked_gp_l1_reg_loss: 20104.8831; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7884139.5233; train_optim_loss: 7884139.5233; val_kl_reg_loss: 57171.0269; val_edge_recon_loss: 113879.7559; val_gene_expr_recon_loss: 7662417.6458; val_masked_gp_l1_reg_loss: 20264.2383; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7853732.4583; val_optim_loss: 7853732.4583
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9334; val_auprc_score: 0.9858; val_best_acc_score: 0.9112; val_best_f1_score: 0.9479; train_kl_reg_loss: 57693.4585; train_edge_recon_loss: 112049.4670; train_gene_expr_recon_loss: 7619448.6302; train_masked_gp_l1_reg_loss: 20431.7353; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7809623.2953; train_optim_loss: 7809623.2953; val_kl_reg_loss: 53820.9406; val_edge_recon_loss: 115708.7741; val_gene_expr_recon_loss: 7596919.4583; val_masked_gp_l1_reg_loss: 20603.5586; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7787052.6875; val_optim_loss: 7787052.6875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9292; val_auprc_score: 0.9857; val_best_acc_score: 0.9123; val_best_f1_score: 0.9497; train_kl_reg_loss: 54491.2630; train_edge_recon_loss: 111379.5235; train_gene_expr_recon_loss: 7554679.4279; train_masked_gp_l1_reg_loss: 20767.8386; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7741318.0465; train_optim_loss: 7741318.0465; val_kl_reg_loss: 51703.0732; val_edge_recon_loss: 111321.5560; val_gene_expr_recon_loss: 7530405.8542; val_masked_gp_l1_reg_loss: 20934.5098; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7714365.0000; val_optim_loss: 7714365.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9327; val_auprc_score: 0.9871; val_best_acc_score: 0.9109; val_best_f1_score: 0.9488; train_kl_reg_loss: 51657.3519; train_edge_recon_loss: 111818.2912; train_gene_expr_recon_loss: 7497562.6837; train_masked_gp_l1_reg_loss: 21099.2236; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7682137.5419; train_optim_loss: 7682137.5419; val_kl_reg_loss: 48564.2502; val_edge_recon_loss: 109166.5156; val_gene_expr_recon_loss: 7471669.6875; val_masked_gp_l1_reg_loss: 21254.3848; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7650654.9375; val_optim_loss: 7650654.9375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9330; val_auprc_score: 0.9859; val_best_acc_score: 0.9133; val_best_f1_score: 0.9496; train_kl_reg_loss: 49005.0825; train_edge_recon_loss: 110686.5201; train_gene_expr_recon_loss: 7440161.1837; train_masked_gp_l1_reg_loss: 21415.6305; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7621268.4186; train_optim_loss: 7621268.4186; val_kl_reg_loss: 45369.7451; val_edge_recon_loss: 112202.5973; val_gene_expr_recon_loss: 7431372.3750; val_masked_gp_l1_reg_loss: 21591.1328; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7610535.7500; val_optim_loss: 7610535.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9346; val_auprc_score: 0.9873; val_best_acc_score: 0.9116; val_best_f1_score: 0.9484; train_kl_reg_loss: 46449.0986; train_edge_recon_loss: 110379.5056; train_gene_expr_recon_loss: 7389219.1209; train_masked_gp_l1_reg_loss: 21736.3811; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7567784.0953; train_optim_loss: 7567784.0953; val_kl_reg_loss: 43904.6860; val_edge_recon_loss: 111284.2822; val_gene_expr_recon_loss: 7370090.7708; val_masked_gp_l1_reg_loss: 21883.9297; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7547163.7292; val_optim_loss: 7547163.7292
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9316; val_auprc_score: 0.9850; val_best_acc_score: 0.9139; val_best_f1_score: 0.9502; train_kl_reg_loss: 44235.3937; train_edge_recon_loss: 111695.0981; train_gene_expr_recon_loss: 7342046.5326; train_masked_gp_l1_reg_loss: 22049.5056; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7520026.5326; train_optim_loss: 7520026.5326; val_kl_reg_loss: 42395.2174; val_edge_recon_loss: 110194.6198; val_gene_expr_recon_loss: 7332215.5833; val_masked_gp_l1_reg_loss: 22199.0332; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7507004.4583; val_optim_loss: 7507004.4583
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9354; val_auprc_score: 0.9858; val_best_acc_score: 0.9170; val_best_f1_score: 0.9514; train_kl_reg_loss: 42147.4035; train_edge_recon_loss: 109006.4484; train_gene_expr_recon_loss: 7304832.4372; train_masked_gp_l1_reg_loss: 22356.4824; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7478342.7651; train_optim_loss: 7478342.7651; val_kl_reg_loss: 40539.9038; val_edge_recon_loss: 112187.4561; val_gene_expr_recon_loss: 7286450.6042; val_masked_gp_l1_reg_loss: 22513.3887; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7461691.4792; val_optim_loss: 7461691.4792
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9418; val_auprc_score: 0.9880; val_best_acc_score: 0.9220; val_best_f1_score: 0.9545; train_kl_reg_loss: 40400.9051; train_edge_recon_loss: 109242.0873; train_gene_expr_recon_loss: 7263946.6372; train_masked_gp_l1_reg_loss: 22653.1016; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7436242.7488; train_optim_loss: 7436242.7488; val_kl_reg_loss: 38043.5815; val_edge_recon_loss: 108714.1839; val_gene_expr_recon_loss: 7244818.3542; val_masked_gp_l1_reg_loss: 22792.9219; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7414369.1667; val_optim_loss: 7414369.1667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9453; val_auprc_score: 0.9882; val_best_acc_score: 0.9259; val_best_f1_score: 0.9572; train_kl_reg_loss: 38979.9407; train_edge_recon_loss: 106957.5068; train_gene_expr_recon_loss: 7328808.4651; train_masked_gp_l1_reg_loss: 22946.7180; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7497692.6395; train_optim_loss: 7497692.6395; val_kl_reg_loss: 86788.0716; val_edge_recon_loss: 117117.2500; val_gene_expr_recon_loss: 12187264.0417; val_masked_gp_l1_reg_loss: 23180.7617; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12414350.5000; val_optim_loss: 12414350.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9008; val_auprc_score: 0.9778; val_best_acc_score: 0.9012; val_best_f1_score: 0.9442; train_kl_reg_loss: 376048.1418; train_edge_recon_loss: 112808.0274; train_gene_expr_recon_loss: 31989110.7070; train_masked_gp_l1_reg_loss: 34152.6437; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32512119.6744; train_optim_loss: 32512119.6744; val_kl_reg_loss: 24094.8468; val_edge_recon_loss: 118600.4189; val_gene_expr_recon_loss: 9039046.5417; val_masked_gp_l1_reg_loss: 35432.5586; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9217174.7083; val_optim_loss: 9217174.7083
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8994; val_auprc_score: 0.9781; val_best_acc_score: 0.9001; val_best_f1_score: 0.9437; train_kl_reg_loss: 24926.2857; train_edge_recon_loss: 111679.7706; train_gene_expr_recon_loss: 8832517.7209; train_masked_gp_l1_reg_loss: 35454.3403; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9004578.1116; train_optim_loss: 9004578.1116; val_kl_reg_loss: 24718.9157; val_edge_recon_loss: 114526.7816; val_gene_expr_recon_loss: 8712738.1667; val_masked_gp_l1_reg_loss: 35405.5273; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8887389.7500; val_optim_loss: 8887389.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9064; val_auprc_score: 0.9803; val_best_acc_score: 0.9062; val_best_f1_score: 0.9467; train_kl_reg_loss: 23184.7907; train_edge_recon_loss: 113710.7481; train_gene_expr_recon_loss: 8624412.4605; train_masked_gp_l1_reg_loss: 35411.6848; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8796719.7209; train_optim_loss: 8796719.7209; val_kl_reg_loss: 21510.2185; val_edge_recon_loss: 114213.9987; val_gene_expr_recon_loss: 8533772.2292; val_masked_gp_l1_reg_loss: 35331.2188; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8704827.4167; val_optim_loss: 8704827.4167

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9042; val_auprc_score: 0.9781; val_best_acc_score: 0.9050; val_best_f1_score: 0.9458; train_kl_reg_loss: 23224.1559; train_edge_recon_loss: 115537.6589; train_gene_expr_recon_loss: 8518234.9953; train_masked_gp_l1_reg_loss: 35282.0545; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8692278.8512; train_optim_loss: 8692278.8512; val_kl_reg_loss: 21109.0158; val_edge_recon_loss: 117922.8265; val_gene_expr_recon_loss: 8530194.6875; val_masked_gp_l1_reg_loss: 35260.7578; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8704487.5000; val_optim_loss: 8704487.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9049; val_auprc_score: 0.9801; val_best_acc_score: 0.9035; val_best_f1_score: 0.9450; train_kl_reg_loss: 23040.5571; train_edge_recon_loss: 113690.1644; train_gene_expr_recon_loss: 8504879.6465; train_masked_gp_l1_reg_loss: 35244.6673; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8676855.0698; train_optim_loss: 8676855.0698; val_kl_reg_loss: 21870.1721; val_edge_recon_loss: 116293.9661; val_gene_expr_recon_loss: 8513842.6250; val_masked_gp_l1_reg_loss: 35226.9062; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8687233.8333; val_optim_loss: 8687233.8333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9015; val_auprc_score: 0.9778; val_best_acc_score: 0.9041; val_best_f1_score: 0.9452; train_kl_reg_loss: 23568.9487; train_edge_recon_loss: 112768.9250; train_gene_expr_recon_loss: 8489889.2186; train_masked_gp_l1_reg_loss: 35207.1152; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8661434.2791; train_optim_loss: 8661434.2791; val_kl_reg_loss: 22029.1407; val_edge_recon_loss: 116599.4424; val_gene_expr_recon_loss: 8508752.8750; val_masked_gp_l1_reg_loss: 35184.6992; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8682566.5000; val_optim_loss: 8682566.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9016; val_auprc_score: 0.9791; val_best_acc_score: 0.9061; val_best_f1_score: 0.9465; train_kl_reg_loss: 23658.0701; train_edge_recon_loss: 111889.4543; train_gene_expr_recon_loss: 8479079.1047; train_masked_gp_l1_reg_loss: 35164.1134; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8649790.7488; train_optim_loss: 8649790.7488; val_kl_reg_loss: 21712.8312; val_edge_recon_loss: 113558.7165; val_gene_expr_recon_loss: 8500711.9792; val_masked_gp_l1_reg_loss: 35138.9844; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8671122.5417; val_optim_loss: 8671122.5417

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 32 min 59 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
Val AUROC score: 0.9379
Val AUPRC score: 0.9870
Val best accuracy score: 0.9190
Val best F1 score: 0.9529
Val gene expr MSE score: 11456.5254
Val cat covariate0 mean sim diff: -0.0011

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
