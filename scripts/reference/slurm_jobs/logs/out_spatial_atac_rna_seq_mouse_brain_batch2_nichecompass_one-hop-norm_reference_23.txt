[True]
Run timestamp: 07082023_175035_23.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_23']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8910; val_auprc_score: 0.9108; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13091.8683; train_edge_recon_loss: 36163.1493; train_gene_expr_recon_loss: 1342713.5139; train_masked_gp_l1_reg_loss: 8506.0298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119584.6267; train_chrom_access_recon_loss: 2761160.0000; train_global_loss: 4281219.1667; train_optim_loss: 4281219.1667; val_kl_reg_loss: 9840.9277; val_edge_recon_loss: 40660.5234; val_gene_expr_recon_loss: 1099632.2500; val_masked_gp_l1_reg_loss: 6739.5986; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117349.0234; val_chrom_access_recon_loss: 1652278.1250; val_global_loss: 2926500.5000; val_optim_loss: 2926500.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9014; val_auprc_score: 0.9165; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7919.5273; train_edge_recon_loss: 37112.7899; train_gene_expr_recon_loss: 1020221.6597; train_masked_gp_l1_reg_loss: 6272.2594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116049.8151; train_chrom_access_recon_loss: 1534953.4722; train_global_loss: 2722529.5278; train_optim_loss: 2722529.5278; val_kl_reg_loss: 6127.7500; val_edge_recon_loss: 40659.4453; val_gene_expr_recon_loss: 940638.2500; val_masked_gp_l1_reg_loss: 6144.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114528.6094; val_chrom_access_recon_loss: 1438034.5000; val_global_loss: 2546133.5000; val_optim_loss: 2546133.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9036; val_auprc_score: 0.9158; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 8184.8386; train_edge_recon_loss: 37071.8854; train_gene_expr_recon_loss: 905340.3194; train_masked_gp_l1_reg_loss: 6508.4003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113393.7144; train_chrom_access_recon_loss: 1433608.6389; train_global_loss: 2504107.7778; train_optim_loss: 2504107.7778; val_kl_reg_loss: 11991.3770; val_edge_recon_loss: 40661.1602; val_gene_expr_recon_loss: 845270.0625; val_masked_gp_l1_reg_loss: 6871.2300; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111974.1484; val_chrom_access_recon_loss: 1411280.7500; val_global_loss: 2428048.7500; val_optim_loss: 2428048.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8968; val_auprc_score: 0.9099; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16001.4810; train_edge_recon_loss: 38306.3898; train_gene_expr_recon_loss: 818605.7569; train_masked_gp_l1_reg_loss: 6926.4298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110793.7196; train_chrom_access_recon_loss: 1407346.0000; train_global_loss: 2397979.8056; train_optim_loss: 2397979.8056; val_kl_reg_loss: 18642.8633; val_edge_recon_loss: 40661.3867; val_gene_expr_recon_loss: 780666.4375; val_masked_gp_l1_reg_loss: 6941.3301; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109263.5938; val_chrom_access_recon_loss: 1375496.0000; val_global_loss: 2331671.5000; val_optim_loss: 2331671.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8948; val_auprc_score: 0.9097; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 21323.5286; train_edge_recon_loss: 38910.6285; train_gene_expr_recon_loss: 767858.2569; train_masked_gp_l1_reg_loss: 6916.0561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107929.8976; train_chrom_access_recon_loss: 1368617.4861; train_global_loss: 2311555.8333; train_optim_loss: 2311555.8333; val_kl_reg_loss: 22609.7930; val_edge_recon_loss: 40661.2617; val_gene_expr_recon_loss: 741403.2500; val_masked_gp_l1_reg_loss: 6857.3506; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106181.0625; val_chrom_access_recon_loss: 1346848.6250; val_global_loss: 2264561.5000; val_optim_loss: 2264561.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8896; val_auprc_score: 0.9015; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 23749.4312; train_edge_recon_loss: 39080.3290; train_gene_expr_recon_loss: 736856.8889; train_masked_gp_l1_reg_loss: 6795.5632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104650.1094; train_chrom_access_recon_loss: 1351155.6389; train_global_loss: 2262287.9722; train_optim_loss: 2262287.9722; val_kl_reg_loss: 23117.4102; val_edge_recon_loss: 40660.7539; val_gene_expr_recon_loss: 718653.7500; val_masked_gp_l1_reg_loss: 6714.3921; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102659.7812; val_chrom_access_recon_loss: 1331236.8750; val_global_loss: 2223043.0000; val_optim_loss: 2223043.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8901; val_auprc_score: 0.8993; val_best_acc_score: 0.5009; val_best_f1_score: 0.6671; train_kl_reg_loss: 24259.0102; train_edge_recon_loss: 39107.4154; train_gene_expr_recon_loss: 717050.1667; train_masked_gp_l1_reg_loss: 6670.5487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100974.4253; train_chrom_access_recon_loss: 1333855.5833; train_global_loss: 2221917.1389; train_optim_loss: 2221917.1389; val_kl_reg_loss: 23724.7637; val_edge_recon_loss: 40659.0273; val_gene_expr_recon_loss: 702823.5000; val_masked_gp_l1_reg_loss: 6618.6816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98829.9062; val_chrom_access_recon_loss: 1321042.3750; val_global_loss: 2193698.2500; val_optim_loss: 2193698.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8819; val_auprc_score: 0.8857; val_best_acc_score: 0.5075; val_best_f1_score: 0.6700; train_kl_reg_loss: 24863.0616; train_edge_recon_loss: 39136.6992; train_gene_expr_recon_loss: 700985.4653; train_masked_gp_l1_reg_loss: 6587.0424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97080.5260; train_chrom_access_recon_loss: 1326931.8194; train_global_loss: 2195584.6389; train_optim_loss: 2195584.6389; val_kl_reg_loss: 24467.4492; val_edge_recon_loss: 40654.3672; val_gene_expr_recon_loss: 690227.6875; val_masked_gp_l1_reg_loss: 6541.7842; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94880.9766; val_chrom_access_recon_loss: 1313585.6250; val_global_loss: 2170358.0000; val_optim_loss: 2170358.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8600; val_auprc_score: 0.8635; val_best_acc_score: 0.5187; val_best_f1_score: 0.6744; train_kl_reg_loss: 25497.2997; train_edge_recon_loss: 39196.0838; train_gene_expr_recon_loss: 691878.4861; train_masked_gp_l1_reg_loss: 6513.8336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93113.1050; train_chrom_access_recon_loss: 1322233.3056; train_global_loss: 2178432.1111; train_optim_loss: 2178432.1111; val_kl_reg_loss: 24405.9258; val_edge_recon_loss: 40641.8789; val_gene_expr_recon_loss: 680620.0000; val_masked_gp_l1_reg_loss: 6468.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90901.4219; val_chrom_access_recon_loss: 1308448.6250; val_global_loss: 2151486.7500; val_optim_loss: 2151486.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8405; val_auprc_score: 0.8447; val_best_acc_score: 0.5427; val_best_f1_score: 0.6837; train_kl_reg_loss: 25443.0588; train_edge_recon_loss: 39185.1059; train_gene_expr_recon_loss: 681630.1806; train_masked_gp_l1_reg_loss: 6442.8264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89144.0200; train_chrom_access_recon_loss: 1311941.5833; train_global_loss: 2153786.7778; train_optim_loss: 2153786.7778; val_kl_reg_loss: 24844.8008; val_edge_recon_loss: 40625.1758; val_gene_expr_recon_loss: 672001.6250; val_masked_gp_l1_reg_loss: 6404.6982; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86949.6719; val_chrom_access_recon_loss: 1304066.0000; val_global_loss: 2134892.0000; val_optim_loss: 2134892.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8222; val_auprc_score: 0.8215; val_best_acc_score: 0.5837; val_best_f1_score: 0.7013; train_kl_reg_loss: 25581.3366; train_edge_recon_loss: 39227.8125; train_gene_expr_recon_loss: 673877.6458; train_masked_gp_l1_reg_loss: 6379.3811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85215.6345; train_chrom_access_recon_loss: 1314600.7639; train_global_loss: 2144882.6111; train_optim_loss: 2144882.6111; val_kl_reg_loss: 24086.2539; val_edge_recon_loss: 40592.2656; val_gene_expr_recon_loss: 666059.1250; val_masked_gp_l1_reg_loss: 6339.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83064.8828; val_chrom_access_recon_loss: 1300013.2500; val_global_loss: 2120155.5000; val_optim_loss: 2120155.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8164; val_auprc_score: 0.8186; val_best_acc_score: 0.6151; val_best_f1_score: 0.7150; train_kl_reg_loss: 24953.2051; train_edge_recon_loss: 39171.9062; train_gene_expr_recon_loss: 666533.1458; train_masked_gp_l1_reg_loss: 6318.0086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81381.2344; train_chrom_access_recon_loss: 1307298.0556; train_global_loss: 2125655.5556; train_optim_loss: 2125655.5556; val_kl_reg_loss: 24037.3770; val_edge_recon_loss: 40563.3398; val_gene_expr_recon_loss: 660639.3750; val_masked_gp_l1_reg_loss: 6288.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79294.6875; val_chrom_access_recon_loss: 1296366.5000; val_global_loss: 2107189.7500; val_optim_loss: 2107189.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8084; val_auprc_score: 0.8075; val_best_acc_score: 0.6428; val_best_f1_score: 0.7277; train_kl_reg_loss: 24778.6474; train_edge_recon_loss: 39159.8203; train_gene_expr_recon_loss: 661210.4375; train_masked_gp_l1_reg_loss: 6277.0238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77664.7023; train_chrom_access_recon_loss: 1298439.2083; train_global_loss: 2107529.8750; train_optim_loss: 2107529.8750; val_kl_reg_loss: 24237.4570; val_edge_recon_loss: 40542.9336; val_gene_expr_recon_loss: 656252.5625; val_masked_gp_l1_reg_loss: 6260.0420; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75652.7188; val_chrom_access_recon_loss: 1293330.5000; val_global_loss: 2096276.2500; val_optim_loss: 2096276.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8061; val_auprc_score: 0.8080; val_best_acc_score: 0.6727; val_best_f1_score: 0.7409; train_kl_reg_loss: 24205.2237; train_edge_recon_loss: 39125.4983; train_gene_expr_recon_loss: 660790.1875; train_masked_gp_l1_reg_loss: 6248.8682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74089.2873; train_chrom_access_recon_loss: 1303975.7778; train_global_loss: 2108434.8611; train_optim_loss: 2108434.8611; val_kl_reg_loss: 22850.0215; val_edge_recon_loss: 40502.6523; val_gene_expr_recon_loss: 653543.1250; val_masked_gp_l1_reg_loss: 6232.7939; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72162.1250; val_chrom_access_recon_loss: 1290605.3750; val_global_loss: 2085896.1250; val_optim_loss: 2085896.1250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8264; val_auprc_score: 0.8265; val_best_acc_score: 0.6970; val_best_f1_score: 0.7512; train_kl_reg_loss: 23617.7109; train_edge_recon_loss: 39096.1480; train_gene_expr_recon_loss: 655764.2847; train_masked_gp_l1_reg_loss: 6227.7115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70671.4036; train_chrom_access_recon_loss: 1295092.8889; train_global_loss: 2090470.1389; train_optim_loss: 2090470.1389; val_kl_reg_loss: 22262.4766; val_edge_recon_loss: 40465.6562; val_gene_expr_recon_loss: 651079.4375; val_masked_gp_l1_reg_loss: 6217.5293; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68836.9531; val_chrom_access_recon_loss: 1288242.0000; val_global_loss: 2077104.0000; val_optim_loss: 2077104.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8262; val_auprc_score: 0.8239; val_best_acc_score: 0.7119; val_best_f1_score: 0.7579; train_kl_reg_loss: 23036.6816; train_edge_recon_loss: 39070.8351; train_gene_expr_recon_loss: 652726.1736; train_masked_gp_l1_reg_loss: 6215.9323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67424.2656; train_chrom_access_recon_loss: 1292954.1111; train_global_loss: 2081428.0139; train_optim_loss: 2081428.0139; val_kl_reg_loss: 22270.9141; val_edge_recon_loss: 40451.3555; val_gene_expr_recon_loss: 648406.0000; val_masked_gp_l1_reg_loss: 6203.9277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65687.2734; val_chrom_access_recon_loss: 1285789.1250; val_global_loss: 2068808.5000; val_optim_loss: 2068808.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8427; val_auprc_score: 0.8423; val_best_acc_score: 0.7379; val_best_f1_score: 0.7691; train_kl_reg_loss: 22731.9653; train_edge_recon_loss: 39013.9058; train_gene_expr_recon_loss: 653385.8472; train_masked_gp_l1_reg_loss: 6205.7653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64356.0603; train_chrom_access_recon_loss: 1298862.0972; train_global_loss: 2084555.6528; train_optim_loss: 2084555.6528; val_kl_reg_loss: 20954.2168; val_edge_recon_loss: 40380.2500; val_gene_expr_recon_loss: 647851.5000; val_masked_gp_l1_reg_loss: 6199.7271; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62718.6133; val_chrom_access_recon_loss: 1283921.5000; val_global_loss: 2062025.8750; val_optim_loss: 2062025.8750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8465; val_auprc_score: 0.8404; val_best_acc_score: 0.7524; val_best_f1_score: 0.7786; train_kl_reg_loss: 22277.3110; train_edge_recon_loss: 38992.0174; train_gene_expr_recon_loss: 652956.1944; train_masked_gp_l1_reg_loss: 6200.4483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61466.4614; train_chrom_access_recon_loss: 1290589.3889; train_global_loss: 2072481.8194; train_optim_loss: 2072481.8194; val_kl_reg_loss: 21420.7930; val_edge_recon_loss: 40376.7148; val_gene_expr_recon_loss: 644989.8750; val_masked_gp_l1_reg_loss: 6193.2559; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59930.3828; val_chrom_access_recon_loss: 1281675.2500; val_global_loss: 2054586.2500; val_optim_loss: 2054586.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8640; val_auprc_score: 0.8611; val_best_acc_score: 0.7804; val_best_f1_score: 0.7946; train_kl_reg_loss: 21907.7079; train_edge_recon_loss: 38935.6797; train_gene_expr_recon_loss: 651555.9931; train_masked_gp_l1_reg_loss: 6195.8787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58758.5334; train_chrom_access_recon_loss: 1293356.8333; train_global_loss: 2070710.6389; train_optim_loss: 2070710.6389; val_kl_reg_loss: 20780.6445; val_edge_recon_loss: 40318.7695; val_gene_expr_recon_loss: 643669.0000; val_masked_gp_l1_reg_loss: 6193.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57318.8320; val_chrom_access_recon_loss: 1281519.6250; val_global_loss: 2049800.0000; val_optim_loss: 2049800.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8691; val_auprc_score: 0.8631; val_best_acc_score: 0.7886; val_best_f1_score: 0.7980; train_kl_reg_loss: 21399.0252; train_edge_recon_loss: 38892.8025; train_gene_expr_recon_loss: 643835.6319; train_masked_gp_l1_reg_loss: 6196.4395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56221.2183; train_chrom_access_recon_loss: 1288794.7778; train_global_loss: 2055339.9028; train_optim_loss: 2055339.9028; val_kl_reg_loss: 20606.8398; val_edge_recon_loss: 40306.4258; val_gene_expr_recon_loss: 642160.8750; val_masked_gp_l1_reg_loss: 6194.1895; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54863.6914; val_chrom_access_recon_loss: 1280031.0000; val_global_loss: 2044163.0000; val_optim_loss: 2044163.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8732; val_auprc_score: 0.8695; val_best_acc_score: 0.7960; val_best_f1_score: 0.7986; train_kl_reg_loss: 21115.7413; train_edge_recon_loss: 38844.4045; train_gene_expr_recon_loss: 650396.8681; train_masked_gp_l1_reg_loss: 6196.2260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53823.1615; train_chrom_access_recon_loss: 1286725.5972; train_global_loss: 2057102.0000; train_optim_loss: 2057102.0000; val_kl_reg_loss: 19571.2109; val_edge_recon_loss: 40225.3320; val_gene_expr_recon_loss: 641644.4375; val_masked_gp_l1_reg_loss: 6193.7510; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52547.1172; val_chrom_access_recon_loss: 1278279.5000; val_global_loss: 2038461.3750; val_optim_loss: 2038461.3750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8846; val_auprc_score: 0.8764; val_best_acc_score: 0.8099; val_best_f1_score: 0.8063; train_kl_reg_loss: 20686.5803; train_edge_recon_loss: 38788.2912; train_gene_expr_recon_loss: 643997.0139; train_masked_gp_l1_reg_loss: 6204.3276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51580.6706; train_chrom_access_recon_loss: 1283836.0694; train_global_loss: 2045092.9444; train_optim_loss: 2045092.9444; val_kl_reg_loss: 19272.2656; val_edge_recon_loss: 40171.4141; val_gene_expr_recon_loss: 640566.1250; val_masked_gp_l1_reg_loss: 6204.8188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50382.2422; val_chrom_access_recon_loss: 1275757.5000; val_global_loss: 2032354.3750; val_optim_loss: 2032354.3750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8894; val_auprc_score: 0.8804; val_best_acc_score: 0.8116; val_best_f1_score: 0.8052; train_kl_reg_loss: 20419.6100; train_edge_recon_loss: 38749.8802; train_gene_expr_recon_loss: 644669.8333; train_masked_gp_l1_reg_loss: 6209.1762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49468.4922; train_chrom_access_recon_loss: 1283961.1250; train_global_loss: 2043478.1250; train_optim_loss: 2043478.1250; val_kl_reg_loss: 19091.9062; val_edge_recon_loss: 40134.9023; val_gene_expr_recon_loss: 639191.3750; val_masked_gp_l1_reg_loss: 6211.2354; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48340.7617; val_chrom_access_recon_loss: 1274300.6250; val_global_loss: 2027270.7500; val_optim_loss: 2027270.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8960; val_auprc_score: 0.8894; val_best_acc_score: 0.8188; val_best_f1_score: 0.8084; train_kl_reg_loss: 20219.6682; train_edge_recon_loss: 38685.4232; train_gene_expr_recon_loss: 642648.4514; train_masked_gp_l1_reg_loss: 6219.0989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47482.3954; train_chrom_access_recon_loss: 1285019.9722; train_global_loss: 2040275.0000; train_optim_loss: 2040275.0000; val_kl_reg_loss: 18921.7520; val_edge_recon_loss: 40050.5664; val_gene_expr_recon_loss: 638093.5000; val_masked_gp_l1_reg_loss: 6218.4204; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46415.6719; val_chrom_access_recon_loss: 1272172.0000; val_global_loss: 2021872.0000; val_optim_loss: 2021872.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9003; val_auprc_score: 0.8911; val_best_acc_score: 0.8207; val_best_f1_score: 0.8106; train_kl_reg_loss: 20045.4766; train_edge_recon_loss: 38652.2109; train_gene_expr_recon_loss: 642791.0694; train_masked_gp_l1_reg_loss: 6224.1485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45601.4080; train_chrom_access_recon_loss: 1286721.7222; train_global_loss: 2040036.0417; train_optim_loss: 2040036.0417; val_kl_reg_loss: 19463.5977; val_edge_recon_loss: 40062.1914; val_gene_expr_recon_loss: 636411.4375; val_masked_gp_l1_reg_loss: 6218.6387; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44596.6211; val_chrom_access_recon_loss: 1270493.8750; val_global_loss: 2017246.3750; val_optim_loss: 2017246.3750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9057; val_auprc_score: 0.9002; val_best_acc_score: 0.7891; val_best_f1_score: 0.8159; train_kl_reg_loss: 17706.8422; train_edge_recon_loss: 40248.0477; train_gene_expr_recon_loss: 894698.0486; train_masked_gp_l1_reg_loss: 6305.8970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43704.3650; train_chrom_access_recon_loss: 1357518.8056; train_global_loss: 2360182.0278; train_optim_loss: 2360182.0278; val_kl_reg_loss: 14157.1025; val_edge_recon_loss: 40451.8789; val_gene_expr_recon_loss: 883466.2500; val_masked_gp_l1_reg_loss: 6469.3877; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42527.6250; val_chrom_access_recon_loss: 1342760.7500; val_global_loss: 2329833.0000; val_optim_loss: 2329833.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9007; val_auprc_score: 0.8916; val_best_acc_score: 0.7866; val_best_f1_score: 0.8140; train_kl_reg_loss: 15605.9424; train_edge_recon_loss: 40272.0317; train_gene_expr_recon_loss: 890580.7569; train_masked_gp_l1_reg_loss: 6610.2286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41563.1966; train_chrom_access_recon_loss: 1361252.2361; train_global_loss: 2355884.3611; train_optim_loss: 2355884.3611; val_kl_reg_loss: 13066.6885; val_edge_recon_loss: 40455.7422; val_gene_expr_recon_loss: 877999.2500; val_masked_gp_l1_reg_loss: 6763.9917; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40369.5898; val_chrom_access_recon_loss: 1340839.2500; val_global_loss: 2319494.5000; val_optim_loss: 2319494.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9042; val_auprc_score: 0.8986; val_best_acc_score: 0.7885; val_best_f1_score: 0.8157; train_kl_reg_loss: 14815.8308; train_edge_recon_loss: 40272.3455; train_gene_expr_recon_loss: 881966.5972; train_masked_gp_l1_reg_loss: 6857.6295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39448.2209; train_chrom_access_recon_loss: 1351100.5556; train_global_loss: 2334461.1389; train_optim_loss: 2334461.1389; val_kl_reg_loss: 13179.7617; val_edge_recon_loss: 40465.0586; val_gene_expr_recon_loss: 873064.6250; val_masked_gp_l1_reg_loss: 6955.3735; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38322.2344; val_chrom_access_recon_loss: 1338759.2500; val_global_loss: 2310746.2500; val_optim_loss: 2310746.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9095; val_auprc_score: 0.9025; val_best_acc_score: 0.8063; val_best_f1_score: 0.8282; train_kl_reg_loss: 14547.8908; train_edge_recon_loss: 40278.6962; train_gene_expr_recon_loss: 875900.2847; train_masked_gp_l1_reg_loss: 7012.2310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37465.0226; train_chrom_access_recon_loss: 1349206.7639; train_global_loss: 2324410.9444; train_optim_loss: 2324410.9444; val_kl_reg_loss: 13455.2988; val_edge_recon_loss: 40449.8320; val_gene_expr_recon_loss: 869138.8125; val_masked_gp_l1_reg_loss: 7069.0845; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36421.3047; val_chrom_access_recon_loss: 1336661.1250; val_global_loss: 2303195.5000; val_optim_loss: 2303195.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9092; val_auprc_score: 0.9008; val_best_acc_score: 0.8112; val_best_f1_score: 0.8313; train_kl_reg_loss: 14547.4648; train_edge_recon_loss: 40267.3789; train_gene_expr_recon_loss: 879803.4375; train_masked_gp_l1_reg_loss: 7037.6447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36306.3607; train_chrom_access_recon_loss: 1355206.7917; train_global_loss: 2333169.0000; train_optim_loss: 2333169.0000; val_kl_reg_loss: 13189.5645; val_edge_recon_loss: 40444.1211; val_gene_expr_recon_loss: 869005.8125; val_masked_gp_l1_reg_loss: 7011.2280; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36166.0430; val_chrom_access_recon_loss: 1336600.8750; val_global_loss: 2302417.7500; val_optim_loss: 2302417.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9102; val_auprc_score: 0.9005; val_best_acc_score: 0.8145; val_best_f1_score: 0.8337; train_kl_reg_loss: 14393.8893; train_edge_recon_loss: 40257.6918; train_gene_expr_recon_loss: 877241.7708; train_masked_gp_l1_reg_loss: 7006.2241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36066.9505; train_chrom_access_recon_loss: 1353569.7083; train_global_loss: 2328536.2222; train_optim_loss: 2328536.2222; val_kl_reg_loss: 13275.8896; val_edge_recon_loss: 40437.9453; val_gene_expr_recon_loss: 868642.6250; val_masked_gp_l1_reg_loss: 6996.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35942.5938; val_chrom_access_recon_loss: 1336513.1250; val_global_loss: 2301808.7500; val_optim_loss: 2301808.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9079; val_auprc_score: 0.8980; val_best_acc_score: 0.8178; val_best_f1_score: 0.8360; train_kl_reg_loss: 14420.4902; train_edge_recon_loss: 40261.0924; train_gene_expr_recon_loss: 874120.0278; train_masked_gp_l1_reg_loss: 6991.9102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35848.0668; train_chrom_access_recon_loss: 1346083.1944; train_global_loss: 2317724.7778; train_optim_loss: 2317724.7778; val_kl_reg_loss: 13237.4473; val_edge_recon_loss: 40434.6680; val_gene_expr_recon_loss: 868341.2500; val_masked_gp_l1_reg_loss: 6986.4360; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35731.8281; val_chrom_access_recon_loss: 1336212.6250; val_global_loss: 2300944.2500; val_optim_loss: 2300944.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9126; val_auprc_score: 0.9048; val_best_acc_score: 0.8204; val_best_f1_score: 0.8378; train_kl_reg_loss: 14339.8621; train_edge_recon_loss: 40259.1745; train_gene_expr_recon_loss: 871042.8611; train_masked_gp_l1_reg_loss: 6983.2831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35641.3854; train_chrom_access_recon_loss: 1341222.0972; train_global_loss: 2309488.6389; train_optim_loss: 2309488.6389; val_kl_reg_loss: 13225.0752; val_edge_recon_loss: 40429.5039; val_gene_expr_recon_loss: 868050.6250; val_masked_gp_l1_reg_loss: 6980.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35531.3633; val_chrom_access_recon_loss: 1336543.7500; val_global_loss: 2300760.5000; val_optim_loss: 2300760.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 32 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9003
val AUPRC score: 0.8908
val best accuracy score: 0.7668
val best F1 score: 0.8026
val target rna MSE score: 3.9080
val source rna MSE score: 3.1613
val target atac MSE score: 0.1340
val source atac MSE score: 0.0195
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
