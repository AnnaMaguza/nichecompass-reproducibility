[True]
Run timestamp: 09102023_201703_23.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_23']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6810; val_auprc_score: 0.6632; val_best_acc_score: 0.5003; val_best_f1_score: 0.6667; train_kl_reg_loss: 46665.3357; train_edge_recon_loss: 3507785.6288; train_gene_expr_recon_loss: 14014284.1364; train_masked_gp_l1_reg_loss: 31572.1468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3699179.5833; train_chrom_access_recon_loss: 2319857.0947; train_global_loss: 23619343.9091; train_optim_loss: 23619343.9091; val_kl_reg_loss: 33154.8679; val_edge_recon_loss: 4064716.5000; val_gene_expr_recon_loss: 13020096.7500; val_masked_gp_l1_reg_loss: 37668.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2115051.2500; val_chrom_access_recon_loss: 2232518.4375; val_global_loss: 21503206.7500; val_optim_loss: 21503206.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7164; val_auprc_score: 0.6785; val_best_acc_score: 0.6112; val_best_f1_score: 0.7075; train_kl_reg_loss: 77876.4188; train_edge_recon_loss: 3512254.4508; train_gene_expr_recon_loss: 12862078.6212; train_masked_gp_l1_reg_loss: 39629.9679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1188161.2633; train_chrom_access_recon_loss: 2209710.5492; train_global_loss: 19889711.1818; train_optim_loss: 19889711.1818; val_kl_reg_loss: 80276.9424; val_edge_recon_loss: 4058662.6562; val_gene_expr_recon_loss: 12731064.3750; val_masked_gp_l1_reg_loss: 40974.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 592551.5000; val_chrom_access_recon_loss: 2217325.9375; val_global_loss: 19720856.0000; val_optim_loss: 19720856.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7432; val_auprc_score: 0.7185; val_best_acc_score: 0.6687; val_best_f1_score: 0.7138; train_kl_reg_loss: 77509.3981; train_edge_recon_loss: 3503541.9205; train_gene_expr_recon_loss: 12666372.6818; train_masked_gp_l1_reg_loss: 42135.1622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 395121.0331; train_chrom_access_recon_loss: 2190211.6780; train_global_loss: 18874891.7576; train_optim_loss: 18874891.7576; val_kl_reg_loss: 75324.9482; val_edge_recon_loss: 4020477.3438; val_gene_expr_recon_loss: 12632838.7500; val_masked_gp_l1_reg_loss: 43444.9258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 265988.9062; val_chrom_access_recon_loss: 2186375.6719; val_global_loss: 19224449.7500; val_optim_loss: 19224449.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8092; val_auprc_score: 0.7865; val_best_acc_score: 0.7284; val_best_f1_score: 0.7565; train_kl_reg_loss: 61560.8346; train_edge_recon_loss: 3439145.2765; train_gene_expr_recon_loss: 12581102.2121; train_masked_gp_l1_reg_loss: 45142.7975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 209694.1035; train_chrom_access_recon_loss: 2179495.6629; train_global_loss: 18516140.9697; train_optim_loss: 18516140.9697; val_kl_reg_loss: 50807.2876; val_edge_recon_loss: 3314251.5312; val_gene_expr_recon_loss: 12554394.5000; val_masked_gp_l1_reg_loss: 47711.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167287.9219; val_chrom_access_recon_loss: 2204260.2188; val_global_loss: 18338713.0000; val_optim_loss: 18338713.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8278; val_auprc_score: 0.8094; val_best_acc_score: 0.7375; val_best_f1_score: 0.7679; train_kl_reg_loss: 72989.6245; train_edge_recon_loss: 3106946.3295; train_gene_expr_recon_loss: 12525109.5758; train_masked_gp_l1_reg_loss: 50444.8446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144291.2101; train_chrom_access_recon_loss: 2165766.0265; train_global_loss: 18065547.5455; train_optim_loss: 18065547.5455; val_kl_reg_loss: 92069.5254; val_edge_recon_loss: 3064358.3438; val_gene_expr_recon_loss: 12433325.6250; val_masked_gp_l1_reg_loss: 52776.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125898.9609; val_chrom_access_recon_loss: 2184388.9375; val_global_loss: 17952818.7500; val_optim_loss: 17952818.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8854; val_auprc_score: 0.8600; val_best_acc_score: 0.8203; val_best_f1_score: 0.8347; train_kl_reg_loss: 88067.8821; train_edge_recon_loss: 2946960.0720; train_gene_expr_recon_loss: 12442022.8788; train_masked_gp_l1_reg_loss: 54604.8259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117704.8827; train_chrom_access_recon_loss: 2157195.4242; train_global_loss: 17806556.0909; train_optim_loss: 17806556.0909; val_kl_reg_loss: 91921.9326; val_edge_recon_loss: 2908007.7812; val_gene_expr_recon_loss: 12427121.6250; val_masked_gp_l1_reg_loss: 56747.3320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110787.1406; val_chrom_access_recon_loss: 2162399.1875; val_global_loss: 17756985.0000; val_optim_loss: 17756985.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9031; val_auprc_score: 0.8792; val_best_acc_score: 0.8383; val_best_f1_score: 0.8485; train_kl_reg_loss: 93719.8390; train_edge_recon_loss: 2841963.4773; train_gene_expr_recon_loss: 12343264.6515; train_masked_gp_l1_reg_loss: 58191.7043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104151.8410; train_chrom_access_recon_loss: 2140377.6364; train_global_loss: 17581669.2727; train_optim_loss: 17581669.2727; val_kl_reg_loss: 90072.4141; val_edge_recon_loss: 2859089.3438; val_gene_expr_recon_loss: 12334381.2500; val_masked_gp_l1_reg_loss: 59512.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98985.3594; val_chrom_access_recon_loss: 2152097.2188; val_global_loss: 17594137.2500; val_optim_loss: 17594137.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9006; val_auprc_score: 0.8678; val_best_acc_score: 0.8350; val_best_f1_score: 0.8473; train_kl_reg_loss: 93554.0691; train_edge_recon_loss: 2810754.4280; train_gene_expr_recon_loss: 12281671.3788; train_masked_gp_l1_reg_loss: 60667.6257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95061.0379; train_chrom_access_recon_loss: 2130007.7462; train_global_loss: 17471716.1515; train_optim_loss: 17471716.1515; val_kl_reg_loss: 98160.0449; val_edge_recon_loss: 2848810.3438; val_gene_expr_recon_loss: 12224898.2500; val_masked_gp_l1_reg_loss: 61877.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91971.8828; val_chrom_access_recon_loss: 2141332.8906; val_global_loss: 17467051.7500; val_optim_loss: 17467051.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9146; val_auprc_score: 0.8856; val_best_acc_score: 0.8522; val_best_f1_score: 0.8629; train_kl_reg_loss: 96214.6616; train_edge_recon_loss: 2800766.5189; train_gene_expr_recon_loss: 12221192.6212; train_masked_gp_l1_reg_loss: 62728.1481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90399.5036; train_chrom_access_recon_loss: 2122689.4943; train_global_loss: 17393990.8333; train_optim_loss: 17393990.8333; val_kl_reg_loss: 96750.7500; val_edge_recon_loss: 2798482.6562; val_gene_expr_recon_loss: 12227911.5000; val_masked_gp_l1_reg_loss: 63562.0508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88410.2266; val_chrom_access_recon_loss: 2143442.5312; val_global_loss: 17418559.5000; val_optim_loss: 17418559.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9028; val_auprc_score: 0.8633; val_best_acc_score: 0.8434; val_best_f1_score: 0.8536; train_kl_reg_loss: 93162.9993; train_edge_recon_loss: 2779786.1667; train_gene_expr_recon_loss: 12163805.3030; train_masked_gp_l1_reg_loss: 64395.0699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86888.4453; train_chrom_access_recon_loss: 2114442.9205; train_global_loss: 17302480.8333; train_optim_loss: 17302480.8333; val_kl_reg_loss: 93062.5127; val_edge_recon_loss: 2840217.6875; val_gene_expr_recon_loss: 12147376.1250; val_masked_gp_l1_reg_loss: 65119.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85205.2266; val_chrom_access_recon_loss: 2131837.7500; val_global_loss: 17362818.1250; val_optim_loss: 17362818.1250
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9062; val_auprc_score: 0.8816; val_best_acc_score: 0.8428; val_best_f1_score: 0.8547; train_kl_reg_loss: 90211.6920; train_edge_recon_loss: 2787579.4508; train_gene_expr_recon_loss: 12122044.1061; train_masked_gp_l1_reg_loss: 65852.4263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83211.9118; train_chrom_access_recon_loss: 2108610.4811; train_global_loss: 17257510.1818; train_optim_loss: 17257510.1818; val_kl_reg_loss: 88598.4492; val_edge_recon_loss: 2878930.9375; val_gene_expr_recon_loss: 12105484.0000; val_masked_gp_l1_reg_loss: 66667.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81878.9688; val_chrom_access_recon_loss: 2126391.0312; val_global_loss: 17347950.5000; val_optim_loss: 17347950.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9118; val_auprc_score: 0.8808; val_best_acc_score: 0.8538; val_best_f1_score: 0.8638; train_kl_reg_loss: 86206.7280; train_edge_recon_loss: 2794819.9773; train_gene_expr_recon_loss: 12075104.0303; train_masked_gp_l1_reg_loss: 67287.1961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80289.2320; train_chrom_access_recon_loss: 2100834.7576; train_global_loss: 17204541.8939; train_optim_loss: 17204541.8939; val_kl_reg_loss: 88712.5518; val_edge_recon_loss: 2799296.8125; val_gene_expr_recon_loss: 12073987.2500; val_masked_gp_l1_reg_loss: 67991.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79844.6406; val_chrom_access_recon_loss: 2122224.4688; val_global_loss: 17232057.5000; val_optim_loss: 17232057.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9171; val_auprc_score: 0.8892; val_best_acc_score: 0.8563; val_best_f1_score: 0.8654; train_kl_reg_loss: 84333.9924; train_edge_recon_loss: 2785338.8902; train_gene_expr_recon_loss: 12038683.7576; train_masked_gp_l1_reg_loss: 68548.0804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78650.7348; train_chrom_access_recon_loss: 2094861.1534; train_global_loss: 17150416.5758; train_optim_loss: 17150416.5758; val_kl_reg_loss: 85187.4629; val_edge_recon_loss: 2773829.7188; val_gene_expr_recon_loss: 12091974.7500; val_masked_gp_l1_reg_loss: 69157.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77538.5078; val_chrom_access_recon_loss: 2125333.5156; val_global_loss: 17223021.3750; val_optim_loss: 17223021.3750
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9192; val_auprc_score: 0.8906; val_best_acc_score: 0.8606; val_best_f1_score: 0.8698; train_kl_reg_loss: 85920.6591; train_edge_recon_loss: 2769028.8409; train_gene_expr_recon_loss: 11988530.0909; train_masked_gp_l1_reg_loss: 69650.6096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76941.4382; train_chrom_access_recon_loss: 2087288.7330; train_global_loss: 17077360.3788; train_optim_loss: 17077360.3788; val_kl_reg_loss: 84813.7305; val_edge_recon_loss: 2800483.1875; val_gene_expr_recon_loss: 12070074.2500; val_masked_gp_l1_reg_loss: 70144.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77040.6406; val_chrom_access_recon_loss: 2095568.7656; val_global_loss: 17198124.7500; val_optim_loss: 17198124.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9277; val_auprc_score: 0.9079; val_best_acc_score: 0.8713; val_best_f1_score: 0.8758; train_kl_reg_loss: 83838.0908; train_edge_recon_loss: 2765086.2576; train_gene_expr_recon_loss: 11960334.0455; train_masked_gp_l1_reg_loss: 70608.5571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76424.5534; train_chrom_access_recon_loss: 2082477.6250; train_global_loss: 17038769.1212; train_optim_loss: 17038769.1212; val_kl_reg_loss: 83706.2402; val_edge_recon_loss: 2761743.2500; val_gene_expr_recon_loss: 11930101.2500; val_masked_gp_l1_reg_loss: 71104.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76325.2344; val_chrom_access_recon_loss: 2105177.2656; val_global_loss: 17028156.5000; val_optim_loss: 17028156.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9156; val_auprc_score: 0.8898; val_best_acc_score: 0.8611; val_best_f1_score: 0.8688; train_kl_reg_loss: 80505.5507; train_edge_recon_loss: 2758944.1212; train_gene_expr_recon_loss: 11923387.9091; train_masked_gp_l1_reg_loss: 71529.6757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75805.8119; train_chrom_access_recon_loss: 2076146.1780; train_global_loss: 16986319.1515; train_optim_loss: 16986319.1515; val_kl_reg_loss: 80178.5156; val_edge_recon_loss: 2803505.9062; val_gene_expr_recon_loss: 11950255.7500; val_masked_gp_l1_reg_loss: 71931.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75168.5859; val_chrom_access_recon_loss: 2106285.3281; val_global_loss: 17087326.1250; val_optim_loss: 17087326.1250
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9294; val_auprc_score: 0.9114; val_best_acc_score: 0.8673; val_best_f1_score: 0.8761; train_kl_reg_loss: 78555.1571; train_edge_recon_loss: 2755572.5833; train_gene_expr_recon_loss: 11889556.9394; train_masked_gp_l1_reg_loss: 72342.0708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74869.1842; train_chrom_access_recon_loss: 2070118.7595; train_global_loss: 16941014.7576; train_optim_loss: 16941014.7576; val_kl_reg_loss: 81544.8984; val_edge_recon_loss: 2783708.4688; val_gene_expr_recon_loss: 11975634.8750; val_masked_gp_l1_reg_loss: 72720.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74582.6406; val_chrom_access_recon_loss: 2117595.0156; val_global_loss: 17105787.1250; val_optim_loss: 17105787.1250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9216; val_auprc_score: 0.8964; val_best_acc_score: 0.8673; val_best_f1_score: 0.8745; train_kl_reg_loss: 79119.1639; train_edge_recon_loss: 2745224.1970; train_gene_expr_recon_loss: 11856852.6970; train_masked_gp_l1_reg_loss: 73063.6796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74356.2481; train_chrom_access_recon_loss: 2064120.1534; train_global_loss: 16892736.0606; train_optim_loss: 16892736.0606; val_kl_reg_loss: 79425.1191; val_edge_recon_loss: 2785392.5312; val_gene_expr_recon_loss: 11971210.5000; val_masked_gp_l1_reg_loss: 73562.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74399.1094; val_chrom_access_recon_loss: 2084545.7188; val_global_loss: 17068534.6250; val_optim_loss: 17068534.6250
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9291; val_auprc_score: 0.9063; val_best_acc_score: 0.8689; val_best_f1_score: 0.8762; train_kl_reg_loss: 78819.0907; train_edge_recon_loss: 2738425.3523; train_gene_expr_recon_loss: 11837091.9545; train_masked_gp_l1_reg_loss: 73922.4624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73798.6966; train_chrom_access_recon_loss: 2060639.5038; train_global_loss: 16862697.0455; train_optim_loss: 16862697.0455; val_kl_reg_loss: 81258.5537; val_edge_recon_loss: 2762253.2812; val_gene_expr_recon_loss: 11879713.2500; val_masked_gp_l1_reg_loss: 74247.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73309.5234; val_chrom_access_recon_loss: 2081395.2812; val_global_loss: 16952178.2500; val_optim_loss: 16952178.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9279; val_auprc_score: 0.8966; val_best_acc_score: 0.8786; val_best_f1_score: 0.8851; train_kl_reg_loss: 79348.9157; train_edge_recon_loss: 2736932.0189; train_gene_expr_recon_loss: 11805859.2727; train_masked_gp_l1_reg_loss: 74524.4828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73086.2456; train_chrom_access_recon_loss: 2057168.7405; train_global_loss: 16826919.6667; train_optim_loss: 16826919.6667; val_kl_reg_loss: 80565.9092; val_edge_recon_loss: 2741688.7812; val_gene_expr_recon_loss: 11778154.5000; val_masked_gp_l1_reg_loss: 74876.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73391.2109; val_chrom_access_recon_loss: 2096313.7500; val_global_loss: 16844991.0000; val_optim_loss: 16844991.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9354; val_auprc_score: 0.9180; val_best_acc_score: 0.8767; val_best_f1_score: 0.8838; train_kl_reg_loss: 78525.8607; train_edge_recon_loss: 2718584.8144; train_gene_expr_recon_loss: 11779762.8182; train_masked_gp_l1_reg_loss: 75149.0844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73231.1390; train_chrom_access_recon_loss: 2051586.0739; train_global_loss: 16776839.7879; train_optim_loss: 16776839.7879; val_kl_reg_loss: 78384.8643; val_edge_recon_loss: 2766042.4375; val_gene_expr_recon_loss: 11758264.0000; val_masked_gp_l1_reg_loss: 75505.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72935.2812; val_chrom_access_recon_loss: 2082541.8438; val_global_loss: 16833673.1250; val_optim_loss: 16833673.1250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9387; val_auprc_score: 0.9171; val_best_acc_score: 0.8872; val_best_f1_score: 0.8932; train_kl_reg_loss: 77759.2815; train_edge_recon_loss: 2724375.2879; train_gene_expr_recon_loss: 11759362.4848; train_masked_gp_l1_reg_loss: 75734.0317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72443.1409; train_chrom_access_recon_loss: 2046822.5170; train_global_loss: 16756496.7121; train_optim_loss: 16756496.7121; val_kl_reg_loss: 77217.4258; val_edge_recon_loss: 2734078.4062; val_gene_expr_recon_loss: 11858097.8750; val_masked_gp_l1_reg_loss: 76015.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72414.1328; val_chrom_access_recon_loss: 2075923.0625; val_global_loss: 16893746.0000; val_optim_loss: 16893746.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9369; val_auprc_score: 0.9128; val_best_acc_score: 0.8769; val_best_f1_score: 0.8839; train_kl_reg_loss: 76079.1597; train_edge_recon_loss: 2718360.8523; train_gene_expr_recon_loss: 11731492.0000; train_masked_gp_l1_reg_loss: 76239.2766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72254.2656; train_chrom_access_recon_loss: 2041937.6875; train_global_loss: 16716363.2879; train_optim_loss: 16716363.2879; val_kl_reg_loss: 73050.1436; val_edge_recon_loss: 2773338.1250; val_gene_expr_recon_loss: 11685002.5000; val_masked_gp_l1_reg_loss: 76660.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72331.2891; val_chrom_access_recon_loss: 2046176.1562; val_global_loss: 16726557.6250; val_optim_loss: 16726557.6250
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9375; val_auprc_score: 0.9151; val_best_acc_score: 0.8839; val_best_f1_score: 0.8888; train_kl_reg_loss: 74600.4267; train_edge_recon_loss: 2716192.1402; train_gene_expr_recon_loss: 11714316.9545; train_masked_gp_l1_reg_loss: 76840.7275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72030.6796; train_chrom_access_recon_loss: 2039042.7008; train_global_loss: 16693023.7121; train_optim_loss: 16693023.7121; val_kl_reg_loss: 75147.2021; val_edge_recon_loss: 2752622.0625; val_gene_expr_recon_loss: 11767660.1250; val_masked_gp_l1_reg_loss: 77095.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72223.2500; val_chrom_access_recon_loss: 2057916.8281; val_global_loss: 16802665.1250; val_optim_loss: 16802665.1250
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9400; val_auprc_score: 0.9205; val_best_acc_score: 0.8869; val_best_f1_score: 0.8930; train_kl_reg_loss: 76781.2040; train_edge_recon_loss: 2709389.1326; train_gene_expr_recon_loss: 11691411.0152; train_masked_gp_l1_reg_loss: 77264.7595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71731.3690; train_chrom_access_recon_loss: 2033223.2064; train_global_loss: 16659800.6970; train_optim_loss: 16659800.6970; val_kl_reg_loss: 76310.2510; val_edge_recon_loss: 2714435.2812; val_gene_expr_recon_loss: 11742222.1250; val_masked_gp_l1_reg_loss: 77448.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71690.5625; val_chrom_access_recon_loss: 2112318.8125; val_global_loss: 16794425.5000; val_optim_loss: 16794425.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9367; val_auprc_score: 0.9139; val_best_acc_score: 0.8783; val_best_f1_score: 0.8851; train_kl_reg_loss: 95800.5855; train_edge_recon_loss: 2801437.7652; train_gene_expr_recon_loss: 10819974.8636; train_masked_gp_l1_reg_loss: 77455.2006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66795.3368; train_chrom_access_recon_loss: 1904427.1875; train_global_loss: 15765890.8485; train_optim_loss: 15765890.8485; val_kl_reg_loss: 30775.6594; val_edge_recon_loss: 2793148.9062; val_gene_expr_recon_loss: 10781089.7500; val_masked_gp_l1_reg_loss: 77201.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66875.9688; val_chrom_access_recon_loss: 1902906.1250; val_global_loss: 15651998.5000; val_optim_loss: 15651998.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9337; val_auprc_score: 0.9116; val_best_acc_score: 0.8783; val_best_f1_score: 0.8826; train_kl_reg_loss: 80477.5973; train_edge_recon_loss: 2745678.3523; train_gene_expr_recon_loss: 10756499.6515; train_masked_gp_l1_reg_loss: 76834.5843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67312.2609; train_chrom_access_recon_loss: 1867120.7557; train_global_loss: 15593923.2273; train_optim_loss: 15593923.2273; val_kl_reg_loss: 37632.7012; val_edge_recon_loss: 2783219.7500; val_gene_expr_recon_loss: 10731481.8750; val_masked_gp_l1_reg_loss: 76436.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67733.6172; val_chrom_access_recon_loss: 1874188.0469; val_global_loss: 15570693.3750; val_optim_loss: 15570693.3750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9357; val_auprc_score: 0.9053; val_best_acc_score: 0.8788; val_best_f1_score: 0.8866; train_kl_reg_loss: 70225.9027; train_edge_recon_loss: 2711388.3144; train_gene_expr_recon_loss: 10737352.3939; train_masked_gp_l1_reg_loss: 76062.1757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67808.5715; train_chrom_access_recon_loss: 1864436.8409; train_global_loss: 15527274.1818; train_optim_loss: 15527274.1818; val_kl_reg_loss: 40512.1831; val_edge_recon_loss: 2748792.5312; val_gene_expr_recon_loss: 10727710.2500; val_masked_gp_l1_reg_loss: 75720.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68192.8516; val_chrom_access_recon_loss: 1878222.5781; val_global_loss: 15539151.3750; val_optim_loss: 15539151.3750
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9428; val_auprc_score: 0.9243; val_best_acc_score: 0.8874; val_best_f1_score: 0.8925; train_kl_reg_loss: 65712.4645; train_edge_recon_loss: 2714185.3674; train_gene_expr_recon_loss: 10723498.7727; train_masked_gp_l1_reg_loss: 75244.3890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68257.4383; train_chrom_access_recon_loss: 1863485.7557; train_global_loss: 15510384.2576; train_optim_loss: 15510384.2576; val_kl_reg_loss: 45634.2363; val_edge_recon_loss: 2724909.1562; val_gene_expr_recon_loss: 10766414.3750; val_masked_gp_l1_reg_loss: 74775.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68376.7109; val_chrom_access_recon_loss: 1871695.4531; val_global_loss: 15551806.2500; val_optim_loss: 15551806.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9460; val_auprc_score: 0.9287; val_best_acc_score: 0.8882; val_best_f1_score: 0.8940; train_kl_reg_loss: 63209.7542; train_edge_recon_loss: 2700911.0189; train_gene_expr_recon_loss: 10697937.7273; train_masked_gp_l1_reg_loss: 74392.4871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68218.7933; train_chrom_access_recon_loss: 1858564.2083; train_global_loss: 15463234.0909; train_optim_loss: 15463234.0909; val_kl_reg_loss: 46610.3477; val_edge_recon_loss: 2745454.4375; val_gene_expr_recon_loss: 10716170.8750; val_masked_gp_l1_reg_loss: 73979.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68260.0312; val_chrom_access_recon_loss: 1889306.5625; val_global_loss: 15539781.0000; val_optim_loss: 15539781.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9375; val_auprc_score: 0.9102; val_best_acc_score: 0.8796; val_best_f1_score: 0.8867; train_kl_reg_loss: 59031.5509; train_edge_recon_loss: 2702124.4697; train_gene_expr_recon_loss: 10677775.8939; train_masked_gp_l1_reg_loss: 73624.6211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68264.8965; train_chrom_access_recon_loss: 1855402.3144; train_global_loss: 15436223.5909; train_optim_loss: 15436223.5909; val_kl_reg_loss: 47322.3706; val_edge_recon_loss: 2769838.4375; val_gene_expr_recon_loss: 10667374.1250; val_masked_gp_l1_reg_loss: 73284.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68090.6953; val_chrom_access_recon_loss: 1861631.7031; val_global_loss: 15487542.7500; val_optim_loss: 15487542.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9380; val_auprc_score: 0.9139; val_best_acc_score: 0.8855; val_best_f1_score: 0.8915; train_kl_reg_loss: 59957.1273; train_edge_recon_loss: 2706948.0758; train_gene_expr_recon_loss: 10662692.5455; train_masked_gp_l1_reg_loss: 72911.8961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68259.4206; train_chrom_access_recon_loss: 1851720.7216; train_global_loss: 15422489.8333; train_optim_loss: 15422489.8333; val_kl_reg_loss: 49347.5684; val_edge_recon_loss: 2766358.9062; val_gene_expr_recon_loss: 10770509.1250; val_masked_gp_l1_reg_loss: 72550.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68346.6172; val_chrom_access_recon_loss: 1884345.2188; val_global_loss: 15611457.8750; val_optim_loss: 15611457.8750
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9419; val_auprc_score: 0.9214; val_best_acc_score: 0.8842; val_best_f1_score: 0.8893; train_kl_reg_loss: 59584.6706; train_edge_recon_loss: 2699617.2538; train_gene_expr_recon_loss: 10640553.8788; train_masked_gp_l1_reg_loss: 72236.1800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68089.1591; train_chrom_access_recon_loss: 1849628.5492; train_global_loss: 15389709.5455; train_optim_loss: 15389709.5455; val_kl_reg_loss: 51966.9917; val_edge_recon_loss: 2752362.5625; val_gene_expr_recon_loss: 10707459.2500; val_masked_gp_l1_reg_loss: 71830.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67821.4844; val_chrom_access_recon_loss: 1877222.5469; val_global_loss: 15528663.5000; val_optim_loss: 15528663.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9457; val_auprc_score: 0.9254; val_best_acc_score: 0.8987; val_best_f1_score: 0.9018; train_kl_reg_loss: 57135.0057; train_edge_recon_loss: 2692016.7614; train_gene_expr_recon_loss: 10633270.0758; train_masked_gp_l1_reg_loss: 71508.2288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67903.3390; train_chrom_access_recon_loss: 1846452.9621; train_global_loss: 15368286.3636; train_optim_loss: 15368286.3636; val_kl_reg_loss: 49760.2563; val_edge_recon_loss: 2730105.5312; val_gene_expr_recon_loss: 10695268.1250; val_masked_gp_l1_reg_loss: 71209.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68049.0703; val_chrom_access_recon_loss: 1867854.6406; val_global_loss: 15482246.6250; val_optim_loss: 15482246.6250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9415; val_auprc_score: 0.9146; val_best_acc_score: 0.8939; val_best_f1_score: 0.8983; train_kl_reg_loss: 57012.5557; train_edge_recon_loss: 2695001.9318; train_gene_expr_recon_loss: 10625598.0909; train_masked_gp_l1_reg_loss: 70973.6476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67937.9822; train_chrom_access_recon_loss: 1845578.1610; train_global_loss: 15362102.3788; train_optim_loss: 15362102.3788; val_kl_reg_loss: 53211.3677; val_edge_recon_loss: 2746627.3125; val_gene_expr_recon_loss: 10673295.7500; val_masked_gp_l1_reg_loss: 70629.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67684.8047; val_chrom_access_recon_loss: 1857114.6406; val_global_loss: 15468563.7500; val_optim_loss: 15468563.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9439; val_auprc_score: 0.9237; val_best_acc_score: 0.8925; val_best_f1_score: 0.8980; train_kl_reg_loss: 57657.7399; train_edge_recon_loss: 2674345.8030; train_gene_expr_recon_loss: 10615466.4848; train_masked_gp_l1_reg_loss: 70332.6811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67640.1474; train_chrom_access_recon_loss: 1843080.5095; train_global_loss: 15328523.3333; train_optim_loss: 15328523.3333; val_kl_reg_loss: 51964.9414; val_edge_recon_loss: 2731442.1562; val_gene_expr_recon_loss: 10708061.0000; val_masked_gp_l1_reg_loss: 70052.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67690.5469; val_chrom_access_recon_loss: 1885425.2656; val_global_loss: 15514637.5000; val_optim_loss: 15514637.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9445; val_auprc_score: 0.9229; val_best_acc_score: 0.8955; val_best_f1_score: 0.9003; train_kl_reg_loss: 57804.5434; train_edge_recon_loss: 2683492.5114; train_gene_expr_recon_loss: 10607948.3485; train_masked_gp_l1_reg_loss: 69758.8924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67579.8995; train_chrom_access_recon_loss: 1839932.2822; train_global_loss: 15326516.6061; train_optim_loss: 15326516.6061; val_kl_reg_loss: 51706.5996; val_edge_recon_loss: 2698389.6562; val_gene_expr_recon_loss: 10612112.6250; val_masked_gp_l1_reg_loss: 69484.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67430.7656; val_chrom_access_recon_loss: 1847261.0781; val_global_loss: 15346386.2500; val_optim_loss: 15346386.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9575; val_auprc_score: 0.9428; val_best_acc_score: 0.9065; val_best_f1_score: 0.9100; train_kl_reg_loss: 56817.6409; train_edge_recon_loss: 2683261.5985; train_gene_expr_recon_loss: 10590075.9848; train_masked_gp_l1_reg_loss: 69247.1115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67460.8419; train_chrom_access_recon_loss: 1837572.4867; train_global_loss: 15304435.5455; train_optim_loss: 15304435.5455; val_kl_reg_loss: 51975.8779; val_edge_recon_loss: 2695944.4688; val_gene_expr_recon_loss: 10564718.2500; val_masked_gp_l1_reg_loss: 68981.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67147.6719; val_chrom_access_recon_loss: 1862872.8438; val_global_loss: 15311641.5000; val_optim_loss: 15311641.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9524; val_auprc_score: 0.9347; val_best_acc_score: 0.9011; val_best_f1_score: 0.9051; train_kl_reg_loss: 55367.2419; train_edge_recon_loss: 2685778.9167; train_gene_expr_recon_loss: 10567499.2879; train_masked_gp_l1_reg_loss: 68832.3629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67422.1072; train_chrom_access_recon_loss: 1834488.0833; train_global_loss: 15279387.9242; train_optim_loss: 15279387.9242; val_kl_reg_loss: 53152.9668; val_edge_recon_loss: 2694994.5938; val_gene_expr_recon_loss: 10634339.8750; val_masked_gp_l1_reg_loss: 68632.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67254.7188; val_chrom_access_recon_loss: 1862336.8125; val_global_loss: 15380712.1250; val_optim_loss: 15380712.1250
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9488; val_auprc_score: 0.9269; val_best_acc_score: 0.8915; val_best_f1_score: 0.8968; train_kl_reg_loss: 57470.7021; train_edge_recon_loss: 2676481.9508; train_gene_expr_recon_loss: 10556723.1061; train_masked_gp_l1_reg_loss: 68404.9255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67217.4901; train_chrom_access_recon_loss: 1832589.2462; train_global_loss: 15258887.5152; train_optim_loss: 15258887.5152; val_kl_reg_loss: 53903.7324; val_edge_recon_loss: 2728055.1250; val_gene_expr_recon_loss: 10588020.5000; val_masked_gp_l1_reg_loss: 68220.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67548.1875; val_chrom_access_recon_loss: 1853015.7344; val_global_loss: 15358763.8750; val_optim_loss: 15358763.8750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9561; val_auprc_score: 0.9429; val_best_acc_score: 0.9011; val_best_f1_score: 0.9053; train_kl_reg_loss: 57186.6577; train_edge_recon_loss: 2679875.7917; train_gene_expr_recon_loss: 10557781.6212; train_masked_gp_l1_reg_loss: 67956.5288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67239.1813; train_chrom_access_recon_loss: 1830749.8902; train_global_loss: 15260789.6515; train_optim_loss: 15260789.6515; val_kl_reg_loss: 53756.5859; val_edge_recon_loss: 2708163.8750; val_gene_expr_recon_loss: 10595488.6250; val_masked_gp_l1_reg_loss: 67704.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67007.7188; val_chrom_access_recon_loss: 1860832.0156; val_global_loss: 15352953.1250; val_optim_loss: 15352953.1250
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9462; val_auprc_score: 0.9183; val_best_acc_score: 0.8979; val_best_f1_score: 0.9034; train_kl_reg_loss: 55955.6709; train_edge_recon_loss: 2676888.5909; train_gene_expr_recon_loss: 10558920.8030; train_masked_gp_l1_reg_loss: 67583.9238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66984.1628; train_chrom_access_recon_loss: 1830630.3939; train_global_loss: 15256963.5909; train_optim_loss: 15256963.5909; val_kl_reg_loss: 49510.2959; val_edge_recon_loss: 2727209.7500; val_gene_expr_recon_loss: 10563102.0000; val_masked_gp_l1_reg_loss: 67400.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67193.3594; val_chrom_access_recon_loss: 1849278.5000; val_global_loss: 15323693.6250; val_optim_loss: 15323693.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9532; val_auprc_score: 0.9356; val_best_acc_score: 0.9076; val_best_f1_score: 0.9113; train_kl_reg_loss: 53375.5585; train_edge_recon_loss: 2678030.1136; train_gene_expr_recon_loss: 10533895.9697; train_masked_gp_l1_reg_loss: 67086.0923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57824.1020; train_chrom_access_recon_loss: 1827767.9848; train_global_loss: 15217979.7879; train_optim_loss: 15217979.7879; val_kl_reg_loss: 52176.5181; val_edge_recon_loss: 2752709.8750; val_gene_expr_recon_loss: 10499732.6250; val_masked_gp_l1_reg_loss: 66953.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55626.7422; val_chrom_access_recon_loss: 1850397.3281; val_global_loss: 15277597.3750; val_optim_loss: 15277597.3750
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9496; val_auprc_score: 0.9275; val_best_acc_score: 0.9006; val_best_f1_score: 0.9058; train_kl_reg_loss: 55590.6703; train_edge_recon_loss: 2680890.7083; train_gene_expr_recon_loss: 10526818.8485; train_masked_gp_l1_reg_loss: 66922.4779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55221.1622; train_chrom_access_recon_loss: 1824664.3258; train_global_loss: 15210108.1667; train_optim_loss: 15210108.1667; val_kl_reg_loss: 53645.0195; val_edge_recon_loss: 2697909.6875; val_gene_expr_recon_loss: 10577406.7500; val_masked_gp_l1_reg_loss: 66889.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54926.6797; val_chrom_access_recon_loss: 1853423.7344; val_global_loss: 15304201.1250; val_optim_loss: 15304201.1250
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9512; val_auprc_score: 0.9283; val_best_acc_score: 0.9035; val_best_f1_score: 0.9077; train_kl_reg_loss: 56678.7405; train_edge_recon_loss: 2665244.4432; train_gene_expr_recon_loss: 10531033.4091; train_masked_gp_l1_reg_loss: 66863.0948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54701.7315; train_chrom_access_recon_loss: 1826371.8598; train_global_loss: 15200893.3485; train_optim_loss: 15200893.3485; val_kl_reg_loss: 55492.5259; val_edge_recon_loss: 2700187.3750; val_gene_expr_recon_loss: 10616391.6250; val_masked_gp_l1_reg_loss: 66842.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54498.6016; val_chrom_access_recon_loss: 1861794.9688; val_global_loss: 15355207.5000; val_optim_loss: 15355207.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9551; val_auprc_score: 0.9331; val_best_acc_score: 0.9046; val_best_f1_score: 0.9090; train_kl_reg_loss: 57631.8271; train_edge_recon_loss: 2675942.3750; train_gene_expr_recon_loss: 10521749.2576; train_masked_gp_l1_reg_loss: 66827.6308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54391.4218; train_chrom_access_recon_loss: 1824585.0208; train_global_loss: 15201127.3939; train_optim_loss: 15201127.3939; val_kl_reg_loss: 55335.1216; val_edge_recon_loss: 2678185.7188; val_gene_expr_recon_loss: 10595328.7500; val_masked_gp_l1_reg_loss: 66802.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54211.6016; val_chrom_access_recon_loss: 1872879.9688; val_global_loss: 15322743.5000; val_optim_loss: 15322743.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9531; val_auprc_score: 0.9325; val_best_acc_score: 0.9062; val_best_f1_score: 0.9097; train_kl_reg_loss: 57300.1846; train_edge_recon_loss: 2669548.6136; train_gene_expr_recon_loss: 10518638.8030; train_masked_gp_l1_reg_loss: 66783.0088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54102.4558; train_chrom_access_recon_loss: 1825272.3239; train_global_loss: 15191645.3939; train_optim_loss: 15191645.3939; val_kl_reg_loss: 54774.0571; val_edge_recon_loss: 2709640.0625; val_gene_expr_recon_loss: 10559837.1250; val_masked_gp_l1_reg_loss: 66764.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54006.0234; val_chrom_access_recon_loss: 1861012.6719; val_global_loss: 15306033.7500; val_optim_loss: 15306033.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9482; val_auprc_score: 0.9203; val_best_acc_score: 0.8944; val_best_f1_score: 0.8995; train_kl_reg_loss: 57222.5948; train_edge_recon_loss: 2678444.0833; train_gene_expr_recon_loss: 10505893.3182; train_masked_gp_l1_reg_loss: 66732.1205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53022.3333; train_chrom_access_recon_loss: 1823805.5701; train_global_loss: 15185120.0303; train_optim_loss: 15185120.0303; val_kl_reg_loss: 55486.3887; val_edge_recon_loss: 2708943.5000; val_gene_expr_recon_loss: 10533530.2500; val_masked_gp_l1_reg_loss: 66715.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52807.7539; val_chrom_access_recon_loss: 1847322.4844; val_global_loss: 15264806.6250; val_optim_loss: 15264806.6250
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9540; val_auprc_score: 0.9340; val_best_acc_score: 0.9033; val_best_f1_score: 0.9078; train_kl_reg_loss: 57298.3137; train_edge_recon_loss: 2669357.2159; train_gene_expr_recon_loss: 10516612.2727; train_masked_gp_l1_reg_loss: 66710.4741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52774.2231; train_chrom_access_recon_loss: 1824036.5758; train_global_loss: 15186789.0909; train_optim_loss: 15186789.0909; val_kl_reg_loss: 54685.2104; val_edge_recon_loss: 2689953.0938; val_gene_expr_recon_loss: 10507570.7500; val_masked_gp_l1_reg_loss: 66705.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52742.5039; val_chrom_access_recon_loss: 1837573.7500; val_global_loss: 15209231.7500; val_optim_loss: 15209231.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9501; val_auprc_score: 0.9331; val_best_acc_score: 0.8992; val_best_f1_score: 0.9044; train_kl_reg_loss: 57484.2796; train_edge_recon_loss: 2678657.1023; train_gene_expr_recon_loss: 10517672.2576; train_masked_gp_l1_reg_loss: 66701.4248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52714.0120; train_chrom_access_recon_loss: 1824377.8371; train_global_loss: 15197606.9091; train_optim_loss: 15197606.9091; val_kl_reg_loss: 54937.5967; val_edge_recon_loss: 2719283.8125; val_gene_expr_recon_loss: 10582150.1250; val_masked_gp_l1_reg_loss: 66697.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52689.9727; val_chrom_access_recon_loss: 1850919.2656; val_global_loss: 15326678.8750; val_optim_loss: 15326678.8750
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9520; val_auprc_score: 0.9322; val_best_acc_score: 0.9025; val_best_f1_score: 0.9073; train_kl_reg_loss: 57450.1452; train_edge_recon_loss: 2673021.7386; train_gene_expr_recon_loss: 10512673.7121; train_masked_gp_l1_reg_loss: 66695.0713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52672.7931; train_chrom_access_recon_loss: 1822558.4356; train_global_loss: 15185071.8485; train_optim_loss: 15185071.8485; val_kl_reg_loss: 55160.3472; val_edge_recon_loss: 2717392.6875; val_gene_expr_recon_loss: 10596716.8750; val_masked_gp_l1_reg_loss: 66692.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52653.5625; val_chrom_access_recon_loss: 1872719.1875; val_global_loss: 15361335.3750; val_optim_loss: 15361335.3750
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9553; val_auprc_score: 0.9378; val_best_acc_score: 0.9089; val_best_f1_score: 0.9128; train_kl_reg_loss: 57454.7078; train_edge_recon_loss: 2666428.2462; train_gene_expr_recon_loss: 10503886.2424; train_masked_gp_l1_reg_loss: 66688.6233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52635.1380; train_chrom_access_recon_loss: 1823324.0833; train_global_loss: 15170416.9697; train_optim_loss: 15170416.9697; val_kl_reg_loss: 55442.1577; val_edge_recon_loss: 2720892.9375; val_gene_expr_recon_loss: 10543198.3750; val_masked_gp_l1_reg_loss: 66686.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52621.0547; val_chrom_access_recon_loss: 1828110.5000; val_global_loss: 15266952.1250; val_optim_loss: 15266952.1250
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9483; val_auprc_score: 0.9268; val_best_acc_score: 0.8971; val_best_f1_score: 0.9026; train_kl_reg_loss: 57375.1796; train_edge_recon_loss: 2671854.8864; train_gene_expr_recon_loss: 10503880.0909; train_masked_gp_l1_reg_loss: 66684.0340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52600.6625; train_chrom_access_recon_loss: 1822149.9186; train_global_loss: 15174544.8030; train_optim_loss: 15174544.8030; val_kl_reg_loss: 55003.0508; val_edge_recon_loss: 2723441.4062; val_gene_expr_recon_loss: 10535894.7500; val_masked_gp_l1_reg_loss: 66680.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52583.7305; val_chrom_access_recon_loss: 1852409.5469; val_global_loss: 15286013.7500; val_optim_loss: 15286013.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9519; val_auprc_score: 0.9364; val_best_acc_score: 0.9054; val_best_f1_score: 0.9098; train_kl_reg_loss: 57295.5327; train_edge_recon_loss: 2670404.2083; train_gene_expr_recon_loss: 10504488.4545; train_masked_gp_l1_reg_loss: 66677.5833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52486.2628; train_chrom_access_recon_loss: 1822942.2557; train_global_loss: 15174294.3485; train_optim_loss: 15174294.3485; val_kl_reg_loss: 54766.0640; val_edge_recon_loss: 2687162.1250; val_gene_expr_recon_loss: 10556730.8750; val_masked_gp_l1_reg_loss: 66676.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52465.6328; val_chrom_access_recon_loss: 1841865.9688; val_global_loss: 15259667.1250; val_optim_loss: 15259667.1250
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9497; val_auprc_score: 0.9321; val_best_acc_score: 0.8971; val_best_f1_score: 0.9032; train_kl_reg_loss: 57391.1484; train_edge_recon_loss: 2688003.0947; train_gene_expr_recon_loss: 10509487.8939; train_masked_gp_l1_reg_loss: 66675.4309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52462.3813; train_chrom_access_recon_loss: 1823720.5133; train_global_loss: 15197740.3333; train_optim_loss: 15197740.3333; val_kl_reg_loss: 55053.2568; val_edge_recon_loss: 2709152.5938; val_gene_expr_recon_loss: 10552877.8750; val_masked_gp_l1_reg_loss: 66674.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52459.2969; val_chrom_access_recon_loss: 1846142.1719; val_global_loss: 15282359.8750; val_optim_loss: 15282359.8750
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9520; val_auprc_score: 0.9313; val_best_acc_score: 0.9054; val_best_f1_score: 0.9097; train_kl_reg_loss: 57421.7618; train_edge_recon_loss: 2668370.8826; train_gene_expr_recon_loss: 10513365.9242; train_masked_gp_l1_reg_loss: 66674.3594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52456.5932; train_chrom_access_recon_loss: 1824039.2121; train_global_loss: 15182328.7424; train_optim_loss: 15182328.7424; val_kl_reg_loss: 54980.9194; val_edge_recon_loss: 2694339.7500; val_gene_expr_recon_loss: 10522093.0000; val_masked_gp_l1_reg_loss: 66673.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52453.9844; val_chrom_access_recon_loss: 1843713.9219; val_global_loss: 15234255.7500; val_optim_loss: 15234255.7500
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9528; val_auprc_score: 0.9334; val_best_acc_score: 0.9022; val_best_f1_score: 0.9060; train_kl_reg_loss: 57439.1907; train_edge_recon_loss: 2678006.7386; train_gene_expr_recon_loss: 10514589.5303; train_masked_gp_l1_reg_loss: 66673.5643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52452.0549; train_chrom_access_recon_loss: 1822598.9034; train_global_loss: 15191760.0455; train_optim_loss: 15191760.0455; val_kl_reg_loss: 55288.0933; val_edge_recon_loss: 2703655.5938; val_gene_expr_recon_loss: 10516360.5000; val_masked_gp_l1_reg_loss: 66673.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52450.1797; val_chrom_access_recon_loss: 1838189.5000; val_global_loss: 15232616.7500; val_optim_loss: 15232616.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 51 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9566
val AUPRC score: 0.9364
val best accuracy score: 0.9057
val best F1 score: 0.9093
val target rna MSE score: 1.9107
val source rna MSE score: 0.9019
val target atac MSE score: 0.3321
val source atac MSE score: 0.1372
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
