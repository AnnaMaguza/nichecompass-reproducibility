[True]
Run timestamp: 29072023_101714_23.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_23']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8916; val_auprc_score: 0.9096; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1247.7997; train_edge_recon_loss: 347842.4931; train_gene_expr_recon_loss: 7992573.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1922519.0972; train_global_loss: 10264182.6667; train_optim_loss: 10264182.6667; val_kl_reg_loss: 1370.4011; val_edge_recon_loss: 406542.0312; val_gene_expr_recon_loss: 7282469.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1745692.8750; val_global_loss: 9436075.0000; val_optim_loss: 9436075.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9057; val_auprc_score: 0.9169; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 14594.8838; train_edge_recon_loss: 355278.3368; train_gene_expr_recon_loss: 6744053.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1786457.1944; train_global_loss: 8900384.1111; train_optim_loss: 8900384.1111; val_kl_reg_loss: 29003.4102; val_edge_recon_loss: 406622.8125; val_gene_expr_recon_loss: 6134182.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1876735.1250; val_global_loss: 8446544.0000; val_optim_loss: 8446544.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9060; val_auprc_score: 0.9184; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 28119.4755; train_edge_recon_loss: 370617.9549; train_gene_expr_recon_loss: 6018691.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1801014.4722; train_global_loss: 8218443.7778; train_optim_loss: 8218443.7778; val_kl_reg_loss: 30137.9609; val_edge_recon_loss: 406617.2188; val_gene_expr_recon_loss: 5795382.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1763828.7500; val_global_loss: 7995966.0000; val_optim_loss: 7995966.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9007; val_auprc_score: 0.9108; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 37723.2656; train_edge_recon_loss: 374170.9931; train_gene_expr_recon_loss: 5650543.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1754657.7222; train_global_loss: 7817095.4444; train_optim_loss: 7817095.4444; val_kl_reg_loss: 40654.7656; val_edge_recon_loss: 406612.8750; val_gene_expr_recon_loss: 5387641.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1749699.5000; val_global_loss: 7584608.0000; val_optim_loss: 7584608.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8969; val_auprc_score: 0.9053; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 46514.5911; train_edge_recon_loss: 378791.8993; train_gene_expr_recon_loss: 5265082.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1725367.2917; train_global_loss: 7415756.6111; train_optim_loss: 7415756.6111; val_kl_reg_loss: 44472.1562; val_edge_recon_loss: 406599.7188; val_gene_expr_recon_loss: 5068068.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1719315.7500; val_global_loss: 7238456.0000; val_optim_loss: 7238456.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8911; val_auprc_score: 0.9010; val_best_acc_score: 0.5011; val_best_f1_score: 0.6671; train_kl_reg_loss: 46739.5356; train_edge_recon_loss: 379300.6354; train_gene_expr_recon_loss: 4991436.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1698972.4444; train_global_loss: 7116449.4444; train_optim_loss: 7116449.4444; val_kl_reg_loss: 46199.7109; val_edge_recon_loss: 406588.7188; val_gene_expr_recon_loss: 4832820.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1698002.2500; val_global_loss: 6983611.0000; val_optim_loss: 6983611.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8881; val_auprc_score: 0.8938; val_best_acc_score: 0.5028; val_best_f1_score: 0.6679; train_kl_reg_loss: 49422.5660; train_edge_recon_loss: 380503.9826; train_gene_expr_recon_loss: 4781288.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1681329.5556; train_global_loss: 6892544.6667; train_optim_loss: 6892544.6667; val_kl_reg_loss: 46057.0703; val_edge_recon_loss: 406572.3750; val_gene_expr_recon_loss: 4626269.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1667711.2500; val_global_loss: 6746610.0000; val_optim_loss: 6746610.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8815; val_auprc_score: 0.8867; val_best_acc_score: 0.5050; val_best_f1_score: 0.6688; train_kl_reg_loss: 50560.2530; train_edge_recon_loss: 380572.3785; train_gene_expr_recon_loss: 4568097.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1648220.5000; train_global_loss: 6647450.7222; train_optim_loss: 6647450.7222; val_kl_reg_loss: 47813.8594; val_edge_recon_loss: 406551.4688; val_gene_expr_recon_loss: 4453015.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1648742.7500; val_global_loss: 6556123.0000; val_optim_loss: 6556123.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8781; val_auprc_score: 0.8852; val_best_acc_score: 0.5088; val_best_f1_score: 0.6705; train_kl_reg_loss: 52138.5161; train_edge_recon_loss: 380555.8021; train_gene_expr_recon_loss: 4412323.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1634394.4583; train_global_loss: 6479412.3333; train_optim_loss: 6479412.3333; val_kl_reg_loss: 48175.5078; val_edge_recon_loss: 406524.0312; val_gene_expr_recon_loss: 4315517.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1626990.7500; val_global_loss: 6397208.0000; val_optim_loss: 6397208.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8717; val_auprc_score: 0.8751; val_best_acc_score: 0.5152; val_best_f1_score: 0.6734; train_kl_reg_loss: 52308.6484; train_edge_recon_loss: 380297.7604; train_gene_expr_recon_loss: 4272455.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1607819.5139; train_global_loss: 6312880.9444; train_optim_loss: 6312880.9444; val_kl_reg_loss: 46913.6172; val_edge_recon_loss: 406473.0625; val_gene_expr_recon_loss: 4213104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1611088.6250; val_global_loss: 6277579.0000; val_optim_loss: 6277579.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8664; val_auprc_score: 0.8685; val_best_acc_score: 0.5212; val_best_f1_score: 0.6758; train_kl_reg_loss: 52099.3576; train_edge_recon_loss: 378914.8472; train_gene_expr_recon_loss: 4198204.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1598246.8889; train_global_loss: 6227465.2778; train_optim_loss: 6227465.2778; val_kl_reg_loss: 44670.5391; val_edge_recon_loss: 406414.5938; val_gene_expr_recon_loss: 4128892.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1595878.3750; val_global_loss: 6175856.0000; val_optim_loss: 6175856.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8585; val_auprc_score: 0.8618; val_best_acc_score: 0.5381; val_best_f1_score: 0.6836; train_kl_reg_loss: 51143.6102; train_edge_recon_loss: 378274.8681; train_gene_expr_recon_loss: 4109683.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1582387.7778; train_global_loss: 6121489.8333; train_optim_loss: 6121489.8333; val_kl_reg_loss: 44366.0039; val_edge_recon_loss: 406325.6875; val_gene_expr_recon_loss: 4066752.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1587224.8750; val_global_loss: 6104669.5000; val_optim_loss: 6104669.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8531; val_auprc_score: 0.8517; val_best_acc_score: 0.5538; val_best_f1_score: 0.6906; train_kl_reg_loss: 49812.5052; train_edge_recon_loss: 377105.6667; train_gene_expr_recon_loss: 4039122.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1570369.8194; train_global_loss: 6036410.2778; train_optim_loss: 6036410.2778; val_kl_reg_loss: 48203.4258; val_edge_recon_loss: 406245.5000; val_gene_expr_recon_loss: 4002847.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1578479.2500; val_global_loss: 6035775.0000; val_optim_loss: 6035775.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8561; val_auprc_score: 0.8496; val_best_acc_score: 0.5935; val_best_f1_score: 0.7097; train_kl_reg_loss: 49943.2873; train_edge_recon_loss: 375731.9097; train_gene_expr_recon_loss: 4002605.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1567558.9583; train_global_loss: 5995840.0000; train_optim_loss: 5995840.0000; val_kl_reg_loss: 43963.4297; val_edge_recon_loss: 406054.1250; val_gene_expr_recon_loss: 3974426.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1569928.5000; val_global_loss: 5994372.5000; val_optim_loss: 5994372.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8608; val_auprc_score: 0.8549; val_best_acc_score: 0.6254; val_best_f1_score: 0.7249; train_kl_reg_loss: 47668.7201; train_edge_recon_loss: 375359.8472; train_gene_expr_recon_loss: 3976620.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1551624.6667; train_global_loss: 5951273.8333; train_optim_loss: 5951273.8333; val_kl_reg_loss: 40058.6797; val_edge_recon_loss: 405830.0000; val_gene_expr_recon_loss: 3956868.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1565970.0000; val_global_loss: 5968727.0000; val_optim_loss: 5968727.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8504; val_auprc_score: 0.8387; val_best_acc_score: 0.6478; val_best_f1_score: 0.7358; train_kl_reg_loss: 46478.0208; train_edge_recon_loss: 374600.6597; train_gene_expr_recon_loss: 3954624.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1556949.0000; train_global_loss: 5932652.5000; train_optim_loss: 5932652.5000; val_kl_reg_loss: 44226.0000; val_edge_recon_loss: 405620.2500; val_gene_expr_recon_loss: 3918534.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1561780.0000; val_global_loss: 5930160.0000; val_optim_loss: 5930160.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8525; val_auprc_score: 0.8402; val_best_acc_score: 0.6878; val_best_f1_score: 0.7555; train_kl_reg_loss: 46459.7418; train_edge_recon_loss: 373115.7326; train_gene_expr_recon_loss: 3939482.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1555147.2778; train_global_loss: 5914205.5556; train_optim_loss: 5914205.5556; val_kl_reg_loss: 41749.2070; val_edge_recon_loss: 405212.4375; val_gene_expr_recon_loss: 3906253.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1559250.8750; val_global_loss: 5912465.5000; val_optim_loss: 5912465.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8602; val_auprc_score: 0.8483; val_best_acc_score: 0.7184; val_best_f1_score: 0.7710; train_kl_reg_loss: 44996.0942; train_edge_recon_loss: 372689.8507; train_gene_expr_recon_loss: 3932912.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1553050.4028; train_global_loss: 5903648.4444; train_optim_loss: 5903648.4444; val_kl_reg_loss: 39083.2305; val_edge_recon_loss: 404741.1250; val_gene_expr_recon_loss: 3888162.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1553952.1250; val_global_loss: 5885939.0000; val_optim_loss: 5885939.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8589; val_auprc_score: 0.8485; val_best_acc_score: 0.7344; val_best_f1_score: 0.7783; train_kl_reg_loss: 44074.1089; train_edge_recon_loss: 372006.2361; train_gene_expr_recon_loss: 3883459.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1541004.1111; train_global_loss: 5840543.5556; train_optim_loss: 5840543.5556; val_kl_reg_loss: 38701.9922; val_edge_recon_loss: 404194.4062; val_gene_expr_recon_loss: 3875402.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1551739.0000; val_global_loss: 5870038.0000; val_optim_loss: 5870038.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8523; val_auprc_score: 0.8364; val_best_acc_score: 0.7521; val_best_f1_score: 0.7866; train_kl_reg_loss: 43122.8116; train_edge_recon_loss: 371064.9132; train_gene_expr_recon_loss: 3880844.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1541616.9167; train_global_loss: 5836649.3889; train_optim_loss: 5836649.3889; val_kl_reg_loss: 39781.6992; val_edge_recon_loss: 403673.7812; val_gene_expr_recon_loss: 3860198.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1551009.0000; val_global_loss: 5854662.5000; val_optim_loss: 5854662.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8510; val_auprc_score: 0.8357; val_best_acc_score: 0.7652; val_best_f1_score: 0.7885; train_kl_reg_loss: 42708.4635; train_edge_recon_loss: 370125.0521; train_gene_expr_recon_loss: 3856158.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1535109.8889; train_global_loss: 5804101.7222; train_optim_loss: 5804101.7222; val_kl_reg_loss: 37301.8750; val_edge_recon_loss: 403019.1250; val_gene_expr_recon_loss: 3850580.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1545603.5000; val_global_loss: 5836505.5000; val_optim_loss: 5836505.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8490; val_auprc_score: 0.8316; val_best_acc_score: 0.7711; val_best_f1_score: 0.7878; train_kl_reg_loss: 40965.4180; train_edge_recon_loss: 370262.8125; train_gene_expr_recon_loss: 3863302.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1536601.7917; train_global_loss: 5811132.6667; train_optim_loss: 5811132.6667; val_kl_reg_loss: 38774.9219; val_edge_recon_loss: 402060.0625; val_gene_expr_recon_loss: 3840892.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1545591.2500; val_global_loss: 5827318.0000; val_optim_loss: 5827318.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8585; val_auprc_score: 0.8445; val_best_acc_score: 0.7808; val_best_f1_score: 0.7838; train_kl_reg_loss: 41044.8151; train_edge_recon_loss: 368422.9792; train_gene_expr_recon_loss: 3837795.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1535183.4722; train_global_loss: 5782447.1667; train_optim_loss: 5782447.1667; val_kl_reg_loss: 34867.1094; val_edge_recon_loss: 400670.0312; val_gene_expr_recon_loss: 3837362.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1544906.5000; val_global_loss: 5817806.0000; val_optim_loss: 5817806.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8478; val_auprc_score: 0.8271; val_best_acc_score: 0.7618; val_best_f1_score: 0.7577; train_kl_reg_loss: 39400.2674; train_edge_recon_loss: 367840.2465; train_gene_expr_recon_loss: 3852761.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1537829.7222; train_global_loss: 5797832.1111; train_optim_loss: 5797832.1111; val_kl_reg_loss: 36377.6445; val_edge_recon_loss: 399460.2500; val_gene_expr_recon_loss: 3823691.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1541175.1250; val_global_loss: 5800704.0000; val_optim_loss: 5800704.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8585; val_auprc_score: 0.8419; val_best_acc_score: 0.7596; val_best_f1_score: 0.7675; train_kl_reg_loss: 39322.3003; train_edge_recon_loss: 366843.9062; train_gene_expr_recon_loss: 3832521.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1534224.7222; train_global_loss: 5772911.9444; train_optim_loss: 5772911.9444; val_kl_reg_loss: 34209.4922; val_edge_recon_loss: 397638.8125; val_gene_expr_recon_loss: 3822071.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1540025.8750; val_global_loss: 5793945.5000; val_optim_loss: 5793945.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8639; val_auprc_score: 0.8511; val_best_acc_score: 0.7821; val_best_f1_score: 0.7904; train_kl_reg_loss: 42699.0161; train_edge_recon_loss: 376211.5451; train_gene_expr_recon_loss: 3860588.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1535550.0278; train_global_loss: 5815049.0000; train_optim_loss: 5815049.0000; val_kl_reg_loss: 40800.8984; val_edge_recon_loss: 401097.3125; val_gene_expr_recon_loss: 3825945.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1540791.3750; val_global_loss: 5808635.0000; val_optim_loss: 5808635.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8736; val_auprc_score: 0.8612; val_best_acc_score: 0.7918; val_best_f1_score: 0.7932; train_kl_reg_loss: 44170.5260; train_edge_recon_loss: 369161.3160; train_gene_expr_recon_loss: 3844123.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1539589.2778; train_global_loss: 5797044.8333; train_optim_loss: 5797044.8333; val_kl_reg_loss: 30994.6914; val_edge_recon_loss: 400130.0312; val_gene_expr_recon_loss: 3827089.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1538925.7500; val_global_loss: 5797139.0000; val_optim_loss: 5797139.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8744; val_auprc_score: 0.8606; val_best_acc_score: 0.7929; val_best_f1_score: 0.7920; train_kl_reg_loss: 40230.4288; train_edge_recon_loss: 372521.3854; train_gene_expr_recon_loss: 3842911.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1530805.5694; train_global_loss: 5786468.6111; train_optim_loss: 5786468.6111; val_kl_reg_loss: 34148.1953; val_edge_recon_loss: 399817.9688; val_gene_expr_recon_loss: 3815244.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1537255.2500; val_global_loss: 5786466.0000; val_optim_loss: 5786466.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8805; val_auprc_score: 0.8678; val_best_acc_score: 0.7970; val_best_f1_score: 0.7945; train_kl_reg_loss: 42122.2027; train_edge_recon_loss: 369121.0000; train_gene_expr_recon_loss: 3840769.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1533214.5139; train_global_loss: 5785227.6667; train_optim_loss: 5785227.6667; val_kl_reg_loss: 31980.1016; val_edge_recon_loss: 399160.7812; val_gene_expr_recon_loss: 3819129.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1539628.7500; val_global_loss: 5789899.0000; val_optim_loss: 5789899.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8904; val_auprc_score: 0.8760; val_best_acc_score: 0.8081; val_best_f1_score: 0.8029; train_kl_reg_loss: 40217.1150; train_edge_recon_loss: 371321.5000; train_gene_expr_recon_loss: 3826190.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1538361.1528; train_global_loss: 5776090.4444; train_optim_loss: 5776090.4444; val_kl_reg_loss: 30353.3281; val_edge_recon_loss: 399191.1250; val_gene_expr_recon_loss: 3809437.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1533425.2500; val_global_loss: 5772407.0000; val_optim_loss: 5772407.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8899; val_auprc_score: 0.8766; val_best_acc_score: 0.8038; val_best_f1_score: 0.7953; train_kl_reg_loss: 36620.6816; train_edge_recon_loss: 374129.2604; train_gene_expr_recon_loss: 3825798.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1526722.6944; train_global_loss: 5763271.5000; train_optim_loss: 5763271.5000; val_kl_reg_loss: 25753.6758; val_edge_recon_loss: 398165.5312; val_gene_expr_recon_loss: 3818490.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1535724.7500; val_global_loss: 5778135.0000; val_optim_loss: 5778135.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8920; val_auprc_score: 0.8779; val_best_acc_score: 0.8098; val_best_f1_score: 0.8068; train_kl_reg_loss: 32122.6465; train_edge_recon_loss: 375795.8889; train_gene_expr_recon_loss: 3832012.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1523620.8194; train_global_loss: 5763551.7222; train_optim_loss: 5763551.7222; val_kl_reg_loss: 34168.5898; val_edge_recon_loss: 399148.4688; val_gene_expr_recon_loss: 3795438.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1531210.3750; val_global_loss: 5759965.5000; val_optim_loss: 5759965.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8987; val_auprc_score: 0.8895; val_best_acc_score: 0.8104; val_best_f1_score: 0.7986; train_kl_reg_loss: 34534.7925; train_edge_recon_loss: 374910.6597; train_gene_expr_recon_loss: 3797121.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1519055.2917; train_global_loss: 5725622.5556; train_optim_loss: 5725622.5556; val_kl_reg_loss: 24295.6523; val_edge_recon_loss: 397766.5938; val_gene_expr_recon_loss: 3795158.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1530515.6250; val_global_loss: 5747735.5000; val_optim_loss: 5747735.5000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9002; val_auprc_score: 0.8848; val_best_acc_score: 0.8099; val_best_f1_score: 0.7948; train_kl_reg_loss: 30816.5401; train_edge_recon_loss: 375643.7847; train_gene_expr_recon_loss: 3791237.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1516252.1389; train_global_loss: 5713950.5000; train_optim_loss: 5713950.5000; val_kl_reg_loss: 29636.5156; val_edge_recon_loss: 397377.6250; val_gene_expr_recon_loss: 3780429.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1526379.2500; val_global_loss: 5733823.0000; val_optim_loss: 5733823.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9076; val_auprc_score: 0.8985; val_best_acc_score: 0.8037; val_best_f1_score: 0.7908; train_kl_reg_loss: 32334.5061; train_edge_recon_loss: 374646.8403; train_gene_expr_recon_loss: 3800344.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1519024.4722; train_global_loss: 5726350.5556; train_optim_loss: 5726350.5556; val_kl_reg_loss: 24594.5801; val_edge_recon_loss: 396332.3750; val_gene_expr_recon_loss: 3786434.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1528015.7500; val_global_loss: 5735377.0000; val_optim_loss: 5735377.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9068; val_auprc_score: 0.8942; val_best_acc_score: 0.7945; val_best_f1_score: 0.8025; train_kl_reg_loss: 30452.4386; train_edge_recon_loss: 377183.3507; train_gene_expr_recon_loss: 3809714.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1520719.5417; train_global_loss: 5738070.1111; train_optim_loss: 5738070.1111; val_kl_reg_loss: 19091.0312; val_edge_recon_loss: 394880.2812; val_gene_expr_recon_loss: 3819391.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1530427.7500; val_global_loss: 5763790.0000; val_optim_loss: 5763790.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8980; val_auprc_score: 0.8779; val_best_acc_score: 0.8027; val_best_f1_score: 0.7860; train_kl_reg_loss: 25742.0645; train_edge_recon_loss: 379305.5903; train_gene_expr_recon_loss: 3823123.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1518483.5694; train_global_loss: 5746655.0000; train_optim_loss: 5746655.0000; val_kl_reg_loss: 23827.7207; val_edge_recon_loss: 396298.7812; val_gene_expr_recon_loss: 3789520.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1525038.5000; val_global_loss: 5734685.0000; val_optim_loss: 5734685.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9095; val_auprc_score: 0.8929; val_best_acc_score: 0.7975; val_best_f1_score: 0.8070; train_kl_reg_loss: 27081.3199; train_edge_recon_loss: 376510.2882; train_gene_expr_recon_loss: 3791617.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1514750.9444; train_global_loss: 5709960.3889; train_optim_loss: 5709960.3889; val_kl_reg_loss: 19805.5332; val_edge_recon_loss: 394577.7812; val_gene_expr_recon_loss: 3796955.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1526384.8750; val_global_loss: 5737724.0000; val_optim_loss: 5737724.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9104; val_auprc_score: 0.8996; val_best_acc_score: 0.8092; val_best_f1_score: 0.7927; train_kl_reg_loss: 23360.6944; train_edge_recon_loss: 378950.6042; train_gene_expr_recon_loss: 3790319.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1519862.6250; train_global_loss: 5712493.8889; train_optim_loss: 5712493.8889; val_kl_reg_loss: 26544.9922; val_edge_recon_loss: 395862.3438; val_gene_expr_recon_loss: 3772590.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1524620.8750; val_global_loss: 5719618.5000; val_optim_loss: 5719618.5000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9023; val_auprc_score: 0.8863; val_best_acc_score: 0.7992; val_best_f1_score: 0.7963; train_kl_reg_loss: 29268.9143; train_edge_recon_loss: 375005.4340; train_gene_expr_recon_loss: 3779656.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1516113.7222; train_global_loss: 5700044.5556; train_optim_loss: 5700044.5556; val_kl_reg_loss: 24979.3125; val_edge_recon_loss: 395996.4062; val_gene_expr_recon_loss: 3770619.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1523758.7500; val_global_loss: 5715354.0000; val_optim_loss: 5715354.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9107; val_auprc_score: 0.8972; val_best_acc_score: 0.8079; val_best_f1_score: 0.7990; train_kl_reg_loss: 25948.1988; train_edge_recon_loss: 377644.0035; train_gene_expr_recon_loss: 3784865.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1511636.3889; train_global_loss: 5700093.6667; train_optim_loss: 5700093.6667; val_kl_reg_loss: 24545.8477; val_edge_recon_loss: 395370.6875; val_gene_expr_recon_loss: 3765658.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522567.5000; val_global_loss: 5708142.5000; val_optim_loss: 5708142.5000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9051; val_auprc_score: 0.8834; val_best_acc_score: 0.8041; val_best_f1_score: 0.7985; train_kl_reg_loss: 27924.8665; train_edge_recon_loss: 378326.2188; train_gene_expr_recon_loss: 3799985.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1519346.8194; train_global_loss: 5725583.1667; train_optim_loss: 5725583.1667; val_kl_reg_loss: 26407.4199; val_edge_recon_loss: 395072.3438; val_gene_expr_recon_loss: 3763924.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1521542.1250; val_global_loss: 5706946.5000; val_optim_loss: 5706946.5000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9060; val_auprc_score: 0.8882; val_best_acc_score: 0.8009; val_best_f1_score: 0.7974; train_kl_reg_loss: 27776.4861; train_edge_recon_loss: 376663.2951; train_gene_expr_recon_loss: 3779616.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1513747.6250; train_global_loss: 5697804.0000; train_optim_loss: 5697804.0000; val_kl_reg_loss: 25335.0898; val_edge_recon_loss: 395104.7500; val_gene_expr_recon_loss: 3764363.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522356.7500; val_global_loss: 5707160.0000; val_optim_loss: 5707160.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9066; val_auprc_score: 0.8906; val_best_acc_score: 0.8017; val_best_f1_score: 0.8024; train_kl_reg_loss: 27733.6254; train_edge_recon_loss: 376681.6076; train_gene_expr_recon_loss: 3783122.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1512594.9861; train_global_loss: 5700132.7222; train_optim_loss: 5700132.7222; val_kl_reg_loss: 26212.0195; val_edge_recon_loss: 395094.2812; val_gene_expr_recon_loss: 3763807.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522084.8750; val_global_loss: 5707198.5000; val_optim_loss: 5707198.5000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9078; val_auprc_score: 0.8947; val_best_acc_score: 0.7991; val_best_f1_score: 0.8022; train_kl_reg_loss: 27989.4970; train_edge_recon_loss: 377283.9132; train_gene_expr_recon_loss: 3797231.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1515542.4722; train_global_loss: 5718047.3333; train_optim_loss: 5718047.3333; val_kl_reg_loss: 25487.7949; val_edge_recon_loss: 394910.0312; val_gene_expr_recon_loss: 3765334.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522815.8750; val_global_loss: 5708548.0000; val_optim_loss: 5708548.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9077; val_auprc_score: 0.8927; val_best_acc_score: 0.8030; val_best_f1_score: 0.7966; train_kl_reg_loss: 26924.8945; train_edge_recon_loss: 379015.3750; train_gene_expr_recon_loss: 3780906.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1509147.2083; train_global_loss: 5695994.6111; train_optim_loss: 5695994.6111; val_kl_reg_loss: 25029.3789; val_edge_recon_loss: 395106.8750; val_gene_expr_recon_loss: 3765569.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522172.0000; val_global_loss: 5707878.0000; val_optim_loss: 5707878.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9085; val_auprc_score: 0.8959; val_best_acc_score: 0.8014; val_best_f1_score: 0.7962; train_kl_reg_loss: 27015.8220; train_edge_recon_loss: 378175.1667; train_gene_expr_recon_loss: 3782877.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1522112.6944; train_global_loss: 5710181.1111; train_optim_loss: 5710181.1111; val_kl_reg_loss: 24938.5039; val_edge_recon_loss: 395071.5625; val_gene_expr_recon_loss: 3765222.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1523190.2500; val_global_loss: 5708422.5000; val_optim_loss: 5708422.5000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9133; val_auprc_score: 0.8977; val_best_acc_score: 0.8080; val_best_f1_score: 0.8035; train_kl_reg_loss: 26924.8082; train_edge_recon_loss: 377790.2396; train_gene_expr_recon_loss: 3793427.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1515351.7500; train_global_loss: 5713494.3889; train_optim_loss: 5713494.3889; val_kl_reg_loss: 24812.9180; val_edge_recon_loss: 394773.0625; val_gene_expr_recon_loss: 3765311.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522501.7500; val_global_loss: 5707399.0000; val_optim_loss: 5707399.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9066; val_auprc_score: 0.8879; val_best_acc_score: 0.7988; val_best_f1_score: 0.8063; train_kl_reg_loss: 26767.5239; train_edge_recon_loss: 377489.7847; train_gene_expr_recon_loss: 3794466.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1513982.0556; train_global_loss: 5712705.6111; train_optim_loss: 5712705.6111; val_kl_reg_loss: 24770.3047; val_edge_recon_loss: 394677.3750; val_gene_expr_recon_loss: 3762266.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1520795.0000; val_global_loss: 5702509.5000; val_optim_loss: 5702509.5000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9063; val_auprc_score: 0.8834; val_best_acc_score: 0.8005; val_best_f1_score: 0.7990; train_kl_reg_loss: 26950.5794; train_edge_recon_loss: 377382.4062; train_gene_expr_recon_loss: 3801125.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1519072.5972; train_global_loss: 5724531.1111; train_optim_loss: 5724531.1111; val_kl_reg_loss: 24868.1406; val_edge_recon_loss: 394857.0000; val_gene_expr_recon_loss: 3764889.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1523266.1250; val_global_loss: 5707880.0000; val_optim_loss: 5707880.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9107; val_auprc_score: 0.8967; val_best_acc_score: 0.8023; val_best_f1_score: 0.8043; train_kl_reg_loss: 26797.8722; train_edge_recon_loss: 376968.8889; train_gene_expr_recon_loss: 3773483.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1509388.5417; train_global_loss: 5686638.6111; train_optim_loss: 5686638.6111; val_kl_reg_loss: 24983.0488; val_edge_recon_loss: 394589.1250; val_gene_expr_recon_loss: 3765870.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1521807.1250; val_global_loss: 5707250.0000; val_optim_loss: 5707250.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9105; val_auprc_score: 0.8938; val_best_acc_score: 0.8033; val_best_f1_score: 0.8023; train_kl_reg_loss: 26932.8652; train_edge_recon_loss: 377003.2708; train_gene_expr_recon_loss: 3796473.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1513036.6250; train_global_loss: 5713446.3889; train_optim_loss: 5713446.3889; val_kl_reg_loss: 25031.5039; val_edge_recon_loss: 395022.5000; val_gene_expr_recon_loss: 3767338.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1524121.5000; val_global_loss: 5711514.0000; val_optim_loss: 5711514.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9059; val_auprc_score: 0.8908; val_best_acc_score: 0.7992; val_best_f1_score: 0.8006; train_kl_reg_loss: 26877.7632; train_edge_recon_loss: 378038.8576; train_gene_expr_recon_loss: 3779376.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1520639.2500; train_global_loss: 5704932.4444; train_optim_loss: 5704932.4444; val_kl_reg_loss: 24983.6836; val_edge_recon_loss: 395212.2188; val_gene_expr_recon_loss: 3766297.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522544.1250; val_global_loss: 5709037.5000; val_optim_loss: 5709037.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9097; val_auprc_score: 0.8950; val_best_acc_score: 0.8027; val_best_f1_score: 0.7983; train_kl_reg_loss: 26964.2151; train_edge_recon_loss: 377787.6181; train_gene_expr_recon_loss: 3797837.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1517184.2500; train_global_loss: 5719773.1667; train_optim_loss: 5719773.1667; val_kl_reg_loss: 24954.9512; val_edge_recon_loss: 395082.7500; val_gene_expr_recon_loss: 3764256.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522849.5000; val_global_loss: 5707143.0000; val_optim_loss: 5707143.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9115; val_auprc_score: 0.8973; val_best_acc_score: 0.8034; val_best_f1_score: 0.8085; train_kl_reg_loss: 27024.1393; train_edge_recon_loss: 377732.2847; train_gene_expr_recon_loss: 3782414.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1510521.3889; train_global_loss: 5697692.8333; train_optim_loss: 5697692.8333; val_kl_reg_loss: 24926.4297; val_edge_recon_loss: 394960.9688; val_gene_expr_recon_loss: 3765233.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1522496.2500; val_global_loss: 5707617.0000; val_optim_loss: 5707617.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9131; val_auprc_score: 0.8991; val_best_acc_score: 0.8026; val_best_f1_score: 0.8074; train_kl_reg_loss: 26945.5571; train_edge_recon_loss: 377822.4340; train_gene_expr_recon_loss: 3781201.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1518247.2222; train_global_loss: 5704216.9444; train_optim_loss: 5704216.9444; val_kl_reg_loss: 25042.9531; val_edge_recon_loss: 394440.9062; val_gene_expr_recon_loss: 3765998.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1524523.0000; val_global_loss: 5710005.5000; val_optim_loss: 5710005.5000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9049; val_auprc_score: 0.8869; val_best_acc_score: 0.7982; val_best_f1_score: 0.7982; train_kl_reg_loss: 26966.7133; train_edge_recon_loss: 377837.8160; train_gene_expr_recon_loss: 3795664.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1522424.1528; train_global_loss: 5722893.4444; train_optim_loss: 5722893.4444; val_kl_reg_loss: 24967.5547; val_edge_recon_loss: 395094.9062; val_gene_expr_recon_loss: 3764350.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1521645.0000; val_global_loss: 5706058.0000; val_optim_loss: 5706058.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 38 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9078
val AUPRC score: 0.8905
val best accuracy score: 0.8007
val best F1 score: 0.8013
val target rna MSE score: 2.2224
val source rna MSE score: 0.5921
val target atac MSE score: 0.1217
val source atac MSE score: 0.0227
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
