[True]
Run timestamp: 26072023_012415_23.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_23']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9007; val_auprc_score: 0.9116; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 4822.7963; train_edge_recon_loss: 349427.0590; train_gene_expr_recon_loss: 3113282.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1080858.1806; train_global_loss: 4548390.0556; train_optim_loss: 4548390.0556; val_kl_reg_loss: 14357.5742; val_edge_recon_loss: 406582.7500; val_gene_expr_recon_loss: 2970666.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1059126.7500; val_global_loss: 4450733.0000; val_optim_loss: 4450733.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8764; val_auprc_score: 0.8868; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 22157.9062; train_edge_recon_loss: 362335.7951; train_gene_expr_recon_loss: 2806109.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1066157.0972; train_global_loss: 4256759.8611; train_optim_loss: 4256759.8611; val_kl_reg_loss: 25882.3242; val_edge_recon_loss: 406580.8438; val_gene_expr_recon_loss: 2684383.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1037389.6250; val_global_loss: 4154236.5000; val_optim_loss: 4154236.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8691; val_auprc_score: 0.8776; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 33243.0729; train_edge_recon_loss: 372546.9965; train_gene_expr_recon_loss: 2587602.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1039922.4236; train_global_loss: 4033315.0833; train_optim_loss: 4033315.0833; val_kl_reg_loss: 39455.2109; val_edge_recon_loss: 406572.8125; val_gene_expr_recon_loss: 2479619.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1014842.4375; val_global_loss: 3940490.0000; val_optim_loss: 3940490.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8712; val_auprc_score: 0.8691; val_best_acc_score: 0.5063; val_best_f1_score: 0.6695; train_kl_reg_loss: 47709.9683; train_edge_recon_loss: 381635.0243; train_gene_expr_recon_loss: 2408944.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1016747.5000; train_global_loss: 3855037.3333; train_optim_loss: 3855037.3333; val_kl_reg_loss: 48527.8516; val_edge_recon_loss: 406533.9688; val_gene_expr_recon_loss: 2361966.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 999860.0000; val_global_loss: 3816888.2500; val_optim_loss: 3816888.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8873; val_auprc_score: 0.8799; val_best_acc_score: 0.5097; val_best_f1_score: 0.6709; train_kl_reg_loss: 51860.7222; train_edge_recon_loss: 382645.3021; train_gene_expr_recon_loss: 2319829.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1008131.5972; train_global_loss: 3762467.5556; train_optim_loss: 3762467.5556; val_kl_reg_loss: 50373.0195; val_edge_recon_loss: 406474.3125; val_gene_expr_recon_loss: 2286321.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 990595.8750; val_global_loss: 3733764.0000; val_optim_loss: 3733764.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8818; val_auprc_score: 0.8713; val_best_acc_score: 0.5216; val_best_f1_score: 0.6760; train_kl_reg_loss: 55157.1988; train_edge_recon_loss: 383311.9410; train_gene_expr_recon_loss: 2245648.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1000487.6319; train_global_loss: 3684605.0833; train_optim_loss: 3684605.0833; val_kl_reg_loss: 55435.9297; val_edge_recon_loss: 406383.3438; val_gene_expr_recon_loss: 2225544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984294.0625; val_global_loss: 3671657.2500; val_optim_loss: 3671657.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8893; val_auprc_score: 0.8781; val_best_acc_score: 0.5530; val_best_f1_score: 0.6901; train_kl_reg_loss: 59184.5269; train_edge_recon_loss: 384099.0035; train_gene_expr_recon_loss: 2192554.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 990329.4167; train_global_loss: 3626167.1389; train_optim_loss: 3626167.1389; val_kl_reg_loss: 56776.4297; val_edge_recon_loss: 406210.7812; val_gene_expr_recon_loss: 2187123.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979857.5625; val_global_loss: 3629968.2500; val_optim_loss: 3629968.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8831; val_auprc_score: 0.8703; val_best_acc_score: 0.6273; val_best_f1_score: 0.7261; train_kl_reg_loss: 59607.6463; train_edge_recon_loss: 383364.3472; train_gene_expr_recon_loss: 2166259.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 990976.0764; train_global_loss: 3600207.5833; train_optim_loss: 3600207.5833; val_kl_reg_loss: 55156.0156; val_edge_recon_loss: 405816.3438; val_gene_expr_recon_loss: 2164403.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 976148.3750; val_global_loss: 3601524.5000; val_optim_loss: 3601524.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8751; val_auprc_score: 0.8552; val_best_acc_score: 0.7045; val_best_f1_score: 0.7675; train_kl_reg_loss: 58288.5065; train_edge_recon_loss: 381559.7708; train_gene_expr_recon_loss: 2153847.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 987938.5486; train_global_loss: 3581634.3056; train_optim_loss: 3581634.3056; val_kl_reg_loss: 53102.2617; val_edge_recon_loss: 405126.9062; val_gene_expr_recon_loss: 2154622.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974261.4375; val_global_loss: 3587113.5000; val_optim_loss: 3587113.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8798; val_auprc_score: 0.8618; val_best_acc_score: 0.7615; val_best_f1_score: 0.7987; train_kl_reg_loss: 55989.9466; train_edge_recon_loss: 380422.7743; train_gene_expr_recon_loss: 2134737.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 981236.8403; train_global_loss: 3552387.3889; train_optim_loss: 3552387.3889; val_kl_reg_loss: 52895.4844; val_edge_recon_loss: 403874.7500; val_gene_expr_recon_loss: 2145322.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972576.5625; val_global_loss: 3574668.7500; val_optim_loss: 3574668.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8776; val_auprc_score: 0.8597; val_best_acc_score: 0.7974; val_best_f1_score: 0.8139; train_kl_reg_loss: 55462.1628; train_edge_recon_loss: 378094.3854; train_gene_expr_recon_loss: 2127015.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 985439.7778; train_global_loss: 3546011.6667; train_optim_loss: 3546011.6667; val_kl_reg_loss: 48386.8906; val_edge_recon_loss: 401593.3125; val_gene_expr_recon_loss: 2137205.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971223.4375; val_global_loss: 3558409.2500; val_optim_loss: 3558409.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8819; val_auprc_score: 0.8634; val_best_acc_score: 0.8060; val_best_f1_score: 0.8069; train_kl_reg_loss: 52420.3073; train_edge_recon_loss: 376232.6181; train_gene_expr_recon_loss: 2112453.2639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979508.0069; train_global_loss: 3520614.1667; train_optim_loss: 3520614.1667; val_kl_reg_loss: 47384.0703; val_edge_recon_loss: 398726.6875; val_gene_expr_recon_loss: 2128127.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969057.2500; val_global_loss: 3543295.0000; val_optim_loss: 3543295.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8854; val_auprc_score: 0.8680; val_best_acc_score: 0.7851; val_best_f1_score: 0.7985; train_kl_reg_loss: 51964.2617; train_edge_recon_loss: 373388.6771; train_gene_expr_recon_loss: 2102012.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974249.4444; train_global_loss: 3501615.0556; train_optim_loss: 3501615.0556; val_kl_reg_loss: 46379.2773; val_edge_recon_loss: 393688.8438; val_gene_expr_recon_loss: 2123945.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968287.4375; val_global_loss: 3532300.5000; val_optim_loss: 3532300.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8937; val_auprc_score: 0.8774; val_best_acc_score: 0.7996; val_best_f1_score: 0.8240; train_kl_reg_loss: 50785.1033; train_edge_recon_loss: 369602.3229; train_gene_expr_recon_loss: 2097783.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973872.7500; train_global_loss: 3492043.5278; train_optim_loss: 3492043.5278; val_kl_reg_loss: 46097.4961; val_edge_recon_loss: 386509.5938; val_gene_expr_recon_loss: 2117041.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966006.9375; val_global_loss: 3515655.7500; val_optim_loss: 3515655.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8996; val_auprc_score: 0.8819; val_best_acc_score: 0.8220; val_best_f1_score: 0.8346; train_kl_reg_loss: 50115.5082; train_edge_recon_loss: 365437.0625; train_gene_expr_recon_loss: 2107249.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976844.9375; train_global_loss: 3499646.6944; train_optim_loss: 3499646.6944; val_kl_reg_loss: 45081.1641; val_edge_recon_loss: 378393.8750; val_gene_expr_recon_loss: 2114097.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965026.6250; val_global_loss: 3502599.5000; val_optim_loss: 3502599.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9019; val_auprc_score: 0.8806; val_best_acc_score: 0.8255; val_best_f1_score: 0.8358; train_kl_reg_loss: 50249.3251; train_edge_recon_loss: 359829.0382; train_gene_expr_recon_loss: 2090366.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973892.9236; train_global_loss: 3474337.3333; train_optim_loss: 3474337.3333; val_kl_reg_loss: 46235.8164; val_edge_recon_loss: 367172.9688; val_gene_expr_recon_loss: 2112829.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964518.1875; val_global_loss: 3490756.2500; val_optim_loss: 3490756.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9068; val_auprc_score: 0.8891; val_best_acc_score: 0.8317; val_best_f1_score: 0.8412; train_kl_reg_loss: 50972.8173; train_edge_recon_loss: 352742.8229; train_gene_expr_recon_loss: 2093757.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968092.4236; train_global_loss: 3465565.4167; train_optim_loss: 3465565.4167; val_kl_reg_loss: 49008.6484; val_edge_recon_loss: 355066.5000; val_gene_expr_recon_loss: 2108523.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964422.0625; val_global_loss: 3477021.0000; val_optim_loss: 3477021.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9019; val_auprc_score: 0.8770; val_best_acc_score: 0.8223; val_best_f1_score: 0.8332; train_kl_reg_loss: 53548.5360; train_edge_recon_loss: 344375.8715; train_gene_expr_recon_loss: 2095692.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972778.5556; train_global_loss: 3466395.5000; train_optim_loss: 3466395.5000; val_kl_reg_loss: 51373.4844; val_edge_recon_loss: 344170.1875; val_gene_expr_recon_loss: 2105852.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962370.1875; val_global_loss: 3463766.5000; val_optim_loss: 3463766.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9072; val_auprc_score: 0.8855; val_best_acc_score: 0.8296; val_best_f1_score: 0.8374; train_kl_reg_loss: 54626.4379; train_edge_recon_loss: 338127.8750; train_gene_expr_recon_loss: 2093838.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972937.4236; train_global_loss: 3459530.4167; train_optim_loss: 3459530.4167; val_kl_reg_loss: 51491.6328; val_edge_recon_loss: 336110.8750; val_gene_expr_recon_loss: 2103544.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961759.8750; val_global_loss: 3452907.0000; val_optim_loss: 3452907.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9092; val_auprc_score: 0.8910; val_best_acc_score: 0.8301; val_best_f1_score: 0.8368; train_kl_reg_loss: 54054.5920; train_edge_recon_loss: 333469.9132; train_gene_expr_recon_loss: 2075187.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966003.7500; train_global_loss: 3428715.6667; train_optim_loss: 3428715.6667; val_kl_reg_loss: 51520.4453; val_edge_recon_loss: 332539.4375; val_gene_expr_recon_loss: 2100009.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961209.1250; val_global_loss: 3445278.0000; val_optim_loss: 3445278.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9176; val_auprc_score: 0.9040; val_best_acc_score: 0.8397; val_best_f1_score: 0.8465; train_kl_reg_loss: 53105.3403; train_edge_recon_loss: 331657.2569; train_gene_expr_recon_loss: 2063248.5694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 962916.3333; train_global_loss: 3410927.5278; train_optim_loss: 3410927.5278; val_kl_reg_loss: 50089.9453; val_edge_recon_loss: 330019.9688; val_gene_expr_recon_loss: 2096369.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 958878.8125; val_global_loss: 3435358.0000; val_optim_loss: 3435358.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9136; val_auprc_score: 0.8967; val_best_acc_score: 0.8350; val_best_f1_score: 0.8427; train_kl_reg_loss: 52471.8872; train_edge_recon_loss: 328677.9618; train_gene_expr_recon_loss: 2069592.5694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965943.6736; train_global_loss: 3416686.1389; train_optim_loss: 3416686.1389; val_kl_reg_loss: 50358.8359; val_edge_recon_loss: 327801.1562; val_gene_expr_recon_loss: 2094306.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 959446.4375; val_global_loss: 3431913.2500; val_optim_loss: 3431913.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9155; val_auprc_score: 0.8949; val_best_acc_score: 0.8385; val_best_f1_score: 0.8475; train_kl_reg_loss: 51729.5382; train_edge_recon_loss: 327025.1632; train_gene_expr_recon_loss: 2072335.3194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965574.2292; train_global_loss: 3416664.2778; train_optim_loss: 3416664.2778; val_kl_reg_loss: 49002.5430; val_edge_recon_loss: 326874.3438; val_gene_expr_recon_loss: 2090207.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 957263.0625; val_global_loss: 3423347.5000; val_optim_loss: 3423347.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9170; val_auprc_score: 0.8985; val_best_acc_score: 0.8375; val_best_f1_score: 0.8489; train_kl_reg_loss: 50704.9510; train_edge_recon_loss: 325913.9549; train_gene_expr_recon_loss: 2067503.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964142.5208; train_global_loss: 3408264.9167; train_optim_loss: 3408264.9167; val_kl_reg_loss: 48750.7891; val_edge_recon_loss: 326028.9688; val_gene_expr_recon_loss: 2087025.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 957702.6875; val_global_loss: 3419508.2500; val_optim_loss: 3419508.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9176; val_auprc_score: 0.9036; val_best_acc_score: 0.8378; val_best_f1_score: 0.8462; train_kl_reg_loss: 50189.3789; train_edge_recon_loss: 323709.5417; train_gene_expr_recon_loss: 2062550.1806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965468.6528; train_global_loss: 3401917.7222; train_optim_loss: 3401917.7222; val_kl_reg_loss: 48027.8359; val_edge_recon_loss: 325294.5625; val_gene_expr_recon_loss: 2084604.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 956653.8125; val_global_loss: 3414580.2500; val_optim_loss: 3414580.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9289; val_auprc_score: 0.9145; val_best_acc_score: 0.8575; val_best_f1_score: 0.8617; train_kl_reg_loss: 50527.5699; train_edge_recon_loss: 352266.3194; train_gene_expr_recon_loss: 2090956.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968527.6181; train_global_loss: 3462278.5000; train_optim_loss: 3462278.5000; val_kl_reg_loss: 33815.5742; val_edge_recon_loss: 350947.3750; val_gene_expr_recon_loss: 2105759.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 958154.5625; val_global_loss: 3448676.7500; val_optim_loss: 3448676.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9303; val_auprc_score: 0.9154; val_best_acc_score: 0.8572; val_best_f1_score: 0.8636; train_kl_reg_loss: 48627.6367; train_edge_recon_loss: 344345.8889; train_gene_expr_recon_loss: 2089065.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964656.3611; train_global_loss: 3446694.9444; train_optim_loss: 3446694.9444; val_kl_reg_loss: 33465.5938; val_edge_recon_loss: 342052.1875; val_gene_expr_recon_loss: 2101074.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 957978.5000; val_global_loss: 3434570.7500; val_optim_loss: 3434570.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9297; val_auprc_score: 0.9177; val_best_acc_score: 0.8549; val_best_f1_score: 0.8577; train_kl_reg_loss: 47440.3377; train_edge_recon_loss: 335931.6076; train_gene_expr_recon_loss: 2070547.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961310.5069; train_global_loss: 3415230.3333; train_optim_loss: 3415230.3333; val_kl_reg_loss: 36877.9219; val_edge_recon_loss: 334066.3750; val_gene_expr_recon_loss: 2098770.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 956529.0625; val_global_loss: 3426243.2500; val_optim_loss: 3426243.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9347; val_auprc_score: 0.9264; val_best_acc_score: 0.8575; val_best_f1_score: 0.8603; train_kl_reg_loss: 47949.0885; train_edge_recon_loss: 330627.4028; train_gene_expr_recon_loss: 2088399.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 969936.4236; train_global_loss: 3436912.5556; train_optim_loss: 3436912.5556; val_kl_reg_loss: 38752.2344; val_edge_recon_loss: 328012.6562; val_gene_expr_recon_loss: 2094243.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 956261.5000; val_global_loss: 3417270.0000; val_optim_loss: 3417270.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9337; val_auprc_score: 0.9211; val_best_acc_score: 0.8591; val_best_f1_score: 0.8615; train_kl_reg_loss: 47821.0777; train_edge_recon_loss: 328325.2604; train_gene_expr_recon_loss: 2071535.6806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965563.2917; train_global_loss: 3413245.3333; train_optim_loss: 3413245.3333; val_kl_reg_loss: 38756.9102; val_edge_recon_loss: 328804.6562; val_gene_expr_recon_loss: 2093164.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 955807.0000; val_global_loss: 3416532.5000; val_optim_loss: 3416532.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9279; val_auprc_score: 0.9108; val_best_acc_score: 0.8542; val_best_f1_score: 0.8587; train_kl_reg_loss: 47800.7101; train_edge_recon_loss: 328134.8194; train_gene_expr_recon_loss: 2067212.3472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965364.5208; train_global_loss: 3408512.3889; train_optim_loss: 3408512.3889; val_kl_reg_loss: 38577.4062; val_edge_recon_loss: 329039.8438; val_gene_expr_recon_loss: 2093785.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 956049.2500; val_global_loss: 3417452.2500; val_optim_loss: 3417452.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9260; val_auprc_score: 0.9095; val_best_acc_score: 0.8500; val_best_f1_score: 0.8547; train_kl_reg_loss: 47521.1762; train_edge_recon_loss: 327589.0000; train_gene_expr_recon_loss: 2072852.6806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963172.6111; train_global_loss: 3411135.5000; train_optim_loss: 3411135.5000; val_kl_reg_loss: 38583.7812; val_edge_recon_loss: 331518.0312; val_gene_expr_recon_loss: 2091930.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 955539.0625; val_global_loss: 3417570.7500; val_optim_loss: 3417570.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9300; val_auprc_score: 0.9175; val_best_acc_score: 0.8545; val_best_f1_score: 0.8600; train_kl_reg_loss: 47555.7014; train_edge_recon_loss: 327271.5764; train_gene_expr_recon_loss: 2071153.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961404.4861; train_global_loss: 3407385.0833; train_optim_loss: 3407385.0833; val_kl_reg_loss: 38652.2344; val_edge_recon_loss: 329156.5000; val_gene_expr_recon_loss: 2090361.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 953552.3750; val_global_loss: 3411722.5000; val_optim_loss: 3411722.5000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9309; val_auprc_score: 0.9212; val_best_acc_score: 0.8525; val_best_f1_score: 0.8606; train_kl_reg_loss: 47591.9839; train_edge_recon_loss: 326630.9340; train_gene_expr_recon_loss: 2074755.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959846.7361; train_global_loss: 3408825.0000; train_optim_loss: 3408825.0000; val_kl_reg_loss: 38952.4609; val_edge_recon_loss: 328988.9375; val_gene_expr_recon_loss: 2091484.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 956533.7500; val_global_loss: 3415960.0000; val_optim_loss: 3415960.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9300; val_auprc_score: 0.9176; val_best_acc_score: 0.8534; val_best_f1_score: 0.8569; train_kl_reg_loss: 47563.4271; train_edge_recon_loss: 326420.5208; train_gene_expr_recon_loss: 2074684.8472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968181.2431; train_global_loss: 3416850.0556; train_optim_loss: 3416850.0556; val_kl_reg_loss: 38623.3203; val_edge_recon_loss: 328602.5938; val_gene_expr_recon_loss: 2090478.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954538.3750; val_global_loss: 3412243.0000; val_optim_loss: 3412243.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9329; val_auprc_score: 0.9225; val_best_acc_score: 0.8554; val_best_f1_score: 0.8618; train_kl_reg_loss: 47115.4918; train_edge_recon_loss: 326736.1910; train_gene_expr_recon_loss: 2057806.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 958862.1528; train_global_loss: 3390520.4444; train_optim_loss: 3390520.4444; val_kl_reg_loss: 39072.5703; val_edge_recon_loss: 327319.5312; val_gene_expr_recon_loss: 2090025.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 953582.8750; val_global_loss: 3410001.0000; val_optim_loss: 3410001.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9367; val_auprc_score: 0.9285; val_best_acc_score: 0.8591; val_best_f1_score: 0.8609; train_kl_reg_loss: 47526.0074; train_edge_recon_loss: 326516.0139; train_gene_expr_recon_loss: 2068521.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 960141.5972; train_global_loss: 3402705.3611; train_optim_loss: 3402705.3611; val_kl_reg_loss: 38754.0391; val_edge_recon_loss: 326047.0938; val_gene_expr_recon_loss: 2089997.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954774.8750; val_global_loss: 3409573.0000; val_optim_loss: 3409573.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9260; val_auprc_score: 0.9139; val_best_acc_score: 0.8492; val_best_f1_score: 0.8523; train_kl_reg_loss: 47200.4796; train_edge_recon_loss: 326267.4201; train_gene_expr_recon_loss: 2067007.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964469.3264; train_global_loss: 3404944.9444; train_optim_loss: 3404944.9444; val_kl_reg_loss: 38746.8203; val_edge_recon_loss: 329211.0000; val_gene_expr_recon_loss: 2089494.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954421.8750; val_global_loss: 3411874.0000; val_optim_loss: 3411874.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9301; val_auprc_score: 0.9154; val_best_acc_score: 0.8541; val_best_f1_score: 0.8578; train_kl_reg_loss: 47277.9336; train_edge_recon_loss: 326743.2535; train_gene_expr_recon_loss: 2079300.6528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966167.0417; train_global_loss: 3419488.9167; train_optim_loss: 3419488.9167; val_kl_reg_loss: 38943.3125; val_edge_recon_loss: 326558.2812; val_gene_expr_recon_loss: 2090246.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954833.5000; val_global_loss: 3410581.7500; val_optim_loss: 3410581.7500
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9340; val_auprc_score: 0.9257; val_best_acc_score: 0.8554; val_best_f1_score: 0.8592; train_kl_reg_loss: 46966.0508; train_edge_recon_loss: 325850.0833; train_gene_expr_recon_loss: 2072032.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 962359.1528; train_global_loss: 3407207.8056; train_optim_loss: 3407207.8056; val_kl_reg_loss: 38464.3477; val_edge_recon_loss: 326971.6875; val_gene_expr_recon_loss: 2090487.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 955300.6875; val_global_loss: 3411224.0000; val_optim_loss: 3411224.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9309; val_auprc_score: 0.9173; val_best_acc_score: 0.8557; val_best_f1_score: 0.8584; train_kl_reg_loss: 46680.3060; train_edge_recon_loss: 325571.6979; train_gene_expr_recon_loss: 2068397.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964312.8333; train_global_loss: 3404962.7778; train_optim_loss: 3404962.7778; val_kl_reg_loss: 38753.1602; val_edge_recon_loss: 327893.7812; val_gene_expr_recon_loss: 2089282.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954636.5625; val_global_loss: 3410566.2500; val_optim_loss: 3410566.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9254; val_auprc_score: 0.9126; val_best_acc_score: 0.8469; val_best_f1_score: 0.8527; train_kl_reg_loss: 46909.6111; train_edge_recon_loss: 325391.3958; train_gene_expr_recon_loss: 2070689.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961233.9097; train_global_loss: 3404224.5556; train_optim_loss: 3404224.5556; val_kl_reg_loss: 38813.0078; val_edge_recon_loss: 327416.3750; val_gene_expr_recon_loss: 2089780.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 955920.4375; val_global_loss: 3411930.5000; val_optim_loss: 3411930.5000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9292; val_auprc_score: 0.9164; val_best_acc_score: 0.8513; val_best_f1_score: 0.8580; train_kl_reg_loss: 46906.8932; train_edge_recon_loss: 324968.2951; train_gene_expr_recon_loss: 2062160.7639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961653.0694; train_global_loss: 3395688.9722; train_optim_loss: 3395688.9722; val_kl_reg_loss: 38752.9219; val_edge_recon_loss: 327490.2188; val_gene_expr_recon_loss: 2088298.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954015.3750; val_global_loss: 3408556.5000; val_optim_loss: 3408556.5000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9311; val_auprc_score: 0.9210; val_best_acc_score: 0.8507; val_best_f1_score: 0.8558; train_kl_reg_loss: 46989.4770; train_edge_recon_loss: 325464.1875; train_gene_expr_recon_loss: 2080283.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964438.1181; train_global_loss: 3417175.6389; train_optim_loss: 3417175.6389; val_kl_reg_loss: 38753.6367; val_edge_recon_loss: 326700.5938; val_gene_expr_recon_loss: 2088946.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954915.9375; val_global_loss: 3409316.2500; val_optim_loss: 3409316.2500
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9330; val_auprc_score: 0.9218; val_best_acc_score: 0.8572; val_best_f1_score: 0.8600; train_kl_reg_loss: 46881.1493; train_edge_recon_loss: 325413.4757; train_gene_expr_recon_loss: 2070649.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963890.5069; train_global_loss: 3406834.5556; train_optim_loss: 3406834.5556; val_kl_reg_loss: 38780.7930; val_edge_recon_loss: 326309.1875; val_gene_expr_recon_loss: 2089974.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954640.3125; val_global_loss: 3409704.2500; val_optim_loss: 3409704.2500
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9307; val_auprc_score: 0.9175; val_best_acc_score: 0.8561; val_best_f1_score: 0.8621; train_kl_reg_loss: 46730.7595; train_edge_recon_loss: 325927.7500; train_gene_expr_recon_loss: 2073294.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 960772.2708; train_global_loss: 3406725.1111; train_optim_loss: 3406725.1111; val_kl_reg_loss: 38773.9531; val_edge_recon_loss: 326506.6250; val_gene_expr_recon_loss: 2088144.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954527.1250; val_global_loss: 3407952.0000; val_optim_loss: 3407952.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9300; val_auprc_score: 0.9187; val_best_acc_score: 0.8517; val_best_f1_score: 0.8608; train_kl_reg_loss: 46859.4870; train_edge_recon_loss: 325269.2431; train_gene_expr_recon_loss: 2075195.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963869.5833; train_global_loss: 3411194.2222; train_optim_loss: 3411194.2222; val_kl_reg_loss: 38665.1094; val_edge_recon_loss: 326417.9375; val_gene_expr_recon_loss: 2088364.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 953952.1875; val_global_loss: 3407399.7500; val_optim_loss: 3407399.7500
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9311; val_auprc_score: 0.9223; val_best_acc_score: 0.8519; val_best_f1_score: 0.8569; train_kl_reg_loss: 46711.7925; train_edge_recon_loss: 325703.1944; train_gene_expr_recon_loss: 2058360.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 960276.1806; train_global_loss: 3391052.1389; train_optim_loss: 3391052.1389; val_kl_reg_loss: 38764.0469; val_edge_recon_loss: 327205.9062; val_gene_expr_recon_loss: 2088885.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954408.5000; val_global_loss: 3409263.7500; val_optim_loss: 3409263.7500
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9307; val_auprc_score: 0.9183; val_best_acc_score: 0.8531; val_best_f1_score: 0.8579; train_kl_reg_loss: 46969.7296; train_edge_recon_loss: 325567.6319; train_gene_expr_recon_loss: 2069592.9861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963786.8750; train_global_loss: 3405917.2222; train_optim_loss: 3405917.2222; val_kl_reg_loss: 38899.5586; val_edge_recon_loss: 325238.4688; val_gene_expr_recon_loss: 2089005.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954484.5625; val_global_loss: 3407628.0000; val_optim_loss: 3407628.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9318; val_auprc_score: 0.9234; val_best_acc_score: 0.8539; val_best_f1_score: 0.8562; train_kl_reg_loss: 46929.9835; train_edge_recon_loss: 325798.4549; train_gene_expr_recon_loss: 2075042.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964865.7708; train_global_loss: 3412636.1944; train_optim_loss: 3412636.1944; val_kl_reg_loss: 38797.6016; val_edge_recon_loss: 326182.1250; val_gene_expr_recon_loss: 2087556.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954687.8750; val_global_loss: 3407223.5000; val_optim_loss: 3407223.5000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9339; val_auprc_score: 0.9225; val_best_acc_score: 0.8576; val_best_f1_score: 0.8632; train_kl_reg_loss: 46874.1241; train_edge_recon_loss: 325815.0139; train_gene_expr_recon_loss: 2070739.5694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964800.1528; train_global_loss: 3408228.8889; train_optim_loss: 3408228.8889; val_kl_reg_loss: 38728.7930; val_edge_recon_loss: 324593.0625; val_gene_expr_recon_loss: 2088038.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 953399.1875; val_global_loss: 3404759.7500; val_optim_loss: 3404759.7500
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9317; val_auprc_score: 0.9182; val_best_acc_score: 0.8538; val_best_f1_score: 0.8576; train_kl_reg_loss: 46794.8785; train_edge_recon_loss: 325271.3924; train_gene_expr_recon_loss: 2063726.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961297.8056; train_global_loss: 3397090.4722; train_optim_loss: 3397090.4722; val_kl_reg_loss: 38823.1289; val_edge_recon_loss: 326793.0312; val_gene_expr_recon_loss: 2089559.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 955600.0625; val_global_loss: 3410775.2500; val_optim_loss: 3410775.2500
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9362; val_auprc_score: 0.9241; val_best_acc_score: 0.8632; val_best_f1_score: 0.8650; train_kl_reg_loss: 46626.1155; train_edge_recon_loss: 325444.5938; train_gene_expr_recon_loss: 2072203.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963387.5139; train_global_loss: 3407661.5833; train_optim_loss: 3407661.5833; val_kl_reg_loss: 38633.7461; val_edge_recon_loss: 324704.6875; val_gene_expr_recon_loss: 2088095.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 953408.1250; val_global_loss: 3404842.0000; val_optim_loss: 3404842.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9339; val_auprc_score: 0.9258; val_best_acc_score: 0.8566; val_best_f1_score: 0.8599; train_kl_reg_loss: 46784.4744; train_edge_recon_loss: 324604.1250; train_gene_expr_recon_loss: 2077045.9028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963597.0486; train_global_loss: 3412031.5833; train_optim_loss: 3412031.5833; val_kl_reg_loss: 38788.5078; val_edge_recon_loss: 326184.9375; val_gene_expr_recon_loss: 2088887.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 955042.0625; val_global_loss: 3408903.0000; val_optim_loss: 3408903.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9330; val_auprc_score: 0.9180; val_best_acc_score: 0.8580; val_best_f1_score: 0.8634; train_kl_reg_loss: 46680.6957; train_edge_recon_loss: 324856.7743; train_gene_expr_recon_loss: 2068772.5972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959342.1944; train_global_loss: 3399652.2500; train_optim_loss: 3399652.2500; val_kl_reg_loss: 38681.9375; val_edge_recon_loss: 326007.8125; val_gene_expr_recon_loss: 2087306.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954411.5000; val_global_loss: 3406408.0000; val_optim_loss: 3406408.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9311; val_auprc_score: 0.9217; val_best_acc_score: 0.8544; val_best_f1_score: 0.8575; train_kl_reg_loss: 46727.8915; train_edge_recon_loss: 324573.2778; train_gene_expr_recon_loss: 2065249.4028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961743.5556; train_global_loss: 3398294.1389; train_optim_loss: 3398294.1389; val_kl_reg_loss: 38799.3516; val_edge_recon_loss: 326745.5938; val_gene_expr_recon_loss: 2088510.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954776.2500; val_global_loss: 3408831.7500; val_optim_loss: 3408831.7500
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9315; val_auprc_score: 0.9184; val_best_acc_score: 0.8544; val_best_f1_score: 0.8616; train_kl_reg_loss: 46593.7027; train_edge_recon_loss: 326036.8090; train_gene_expr_recon_loss: 2055043.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 958227.1528; train_global_loss: 3385901.5556; train_optim_loss: 3385901.5556; val_kl_reg_loss: 38744.1875; val_edge_recon_loss: 324828.0000; val_gene_expr_recon_loss: 2088244.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954189.3750; val_global_loss: 3406006.0000; val_optim_loss: 3406006.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9323; val_auprc_score: 0.9224; val_best_acc_score: 0.8558; val_best_f1_score: 0.8593; train_kl_reg_loss: 46778.2053; train_edge_recon_loss: 325070.5243; train_gene_expr_recon_loss: 2074186.6528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966237.7083; train_global_loss: 3412273.0556; train_optim_loss: 3412273.0556; val_kl_reg_loss: 38774.0000; val_edge_recon_loss: 326216.2500; val_gene_expr_recon_loss: 2089572.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 954393.1875; val_global_loss: 3408955.5000; val_optim_loss: 3408955.5000
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9319; val_auprc_score: 0.9207; val_best_acc_score: 0.8554; val_best_f1_score: 0.8597; train_kl_reg_loss: 46756.8859; train_edge_recon_loss: 324452.4757; train_gene_expr_recon_loss: 2063690.5694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965027.8333; train_global_loss: 3399927.7500; train_optim_loss: 3399927.7500; val_kl_reg_loss: 38682.1016; val_edge_recon_loss: 327026.7188; val_gene_expr_recon_loss: 2088198.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 953568.3125; val_global_loss: 3407475.2500; val_optim_loss: 3407475.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 49 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
Val AUROC score: 0.9325
Val AUPRC score: 0.9204
Val best accuracy score: 0.8573
Val best F1 score: 0.8610
Val gene expr MSE score: 0.4341
Val chrom access MSE score: 0.0860
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
