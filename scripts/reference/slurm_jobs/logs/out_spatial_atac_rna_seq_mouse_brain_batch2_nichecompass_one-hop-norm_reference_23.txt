[True]
Run timestamp: 07092023_144202_23.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_23']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3433 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7954, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3433
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3433

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7719; val_auprc_score: 0.7868; val_best_acc_score: 0.5392; val_best_f1_score: 0.6822; train_kl_reg_loss: 82485.1132; train_edge_recon_loss: 3542062.6660; train_gene_expr_recon_loss: 16837195.0916; train_masked_gp_l1_reg_loss: 79535.0510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1165622.0253; train_chrom_access_recon_loss: 9407645.8092; train_global_loss: 31114545.8015; train_optim_loss: 31114545.8015; val_kl_reg_loss: 113064.1859; val_edge_recon_loss: 4062914.8500; val_gene_expr_recon_loss: 15734667.2667; val_masked_gp_l1_reg_loss: 72420.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 604355.8750; val_chrom_access_recon_loss: 9057851.2667; val_global_loss: 29645273.6000; val_optim_loss: 29645273.6000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8642; val_auprc_score: 0.8700; val_best_acc_score: 0.7844; val_best_f1_score: 0.7901; train_kl_reg_loss: 103585.2234; train_edge_recon_loss: 3524030.2672; train_gene_expr_recon_loss: 15580734.7099; train_masked_gp_l1_reg_loss: 71777.2062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 367234.6817; train_chrom_access_recon_loss: 9023873.9847; train_global_loss: 28671236.0763; train_optim_loss: 28671236.0763; val_kl_reg_loss: 90118.2510; val_edge_recon_loss: 4016561.5000; val_gene_expr_recon_loss: 15446897.4000; val_masked_gp_l1_reg_loss: 73136.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 220975.3438; val_chrom_access_recon_loss: 8946336.3000; val_global_loss: 28794025.3333; val_optim_loss: 28794025.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8853; val_auprc_score: 0.8728; val_best_acc_score: 0.7994; val_best_f1_score: 0.8179; train_kl_reg_loss: 84011.0812; train_edge_recon_loss: 3301928.9809; train_gene_expr_recon_loss: 15372345.2137; train_masked_gp_l1_reg_loss: 78828.1817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165200.4388; train_chrom_access_recon_loss: 8912807.5305; train_global_loss: 27915121.5573; train_optim_loss: 27915121.5573; val_kl_reg_loss: 106367.8969; val_edge_recon_loss: 2988822.9333; val_gene_expr_recon_loss: 15251988.3333; val_masked_gp_l1_reg_loss: 85488.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125708.6875; val_chrom_access_recon_loss: 8841951.7333; val_global_loss: 27400326.9333; val_optim_loss: 27400326.9333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9001; val_auprc_score: 0.8867; val_best_acc_score: 0.8160; val_best_f1_score: 0.8275; train_kl_reg_loss: 109919.0423; train_edge_recon_loss: 2960247.2443; train_gene_expr_recon_loss: 15187372.5267; train_masked_gp_l1_reg_loss: 87439.7665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102914.9491; train_chrom_access_recon_loss: 8809118.4084; train_global_loss: 27257012.1221; train_optim_loss: 27257012.1221; val_kl_reg_loss: 111145.9891; val_edge_recon_loss: 2930449.2833; val_gene_expr_recon_loss: 15100923.4000; val_masked_gp_l1_reg_loss: 89538.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85713.5625; val_chrom_access_recon_loss: 8733663.1000; val_global_loss: 27051433.7333; val_optim_loss: 27051433.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9058; val_auprc_score: 0.8889; val_best_acc_score: 0.8335; val_best_f1_score: 0.8475; train_kl_reg_loss: 105299.8923; train_edge_recon_loss: 2890815.7729; train_gene_expr_recon_loss: 15036004.8855; train_masked_gp_l1_reg_loss: 91698.6727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75067.4458; train_chrom_access_recon_loss: 8723248.0649; train_global_loss: 26922134.7328; train_optim_loss: 26922134.7328; val_kl_reg_loss: 102773.8484; val_edge_recon_loss: 2889960.4833; val_gene_expr_recon_loss: 14979830.6000; val_masked_gp_l1_reg_loss: 94045.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66596.2266; val_chrom_access_recon_loss: 8640363.2000; val_global_loss: 26773570.1333; val_optim_loss: 26773570.1333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9208; val_auprc_score: 0.9018; val_best_acc_score: 0.8503; val_best_f1_score: 0.8615; train_kl_reg_loss: 104908.7716; train_edge_recon_loss: 2833148.2118; train_gene_expr_recon_loss: 14905975.8473; train_masked_gp_l1_reg_loss: 95646.5410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60451.3983; train_chrom_access_recon_loss: 8650147.1679; train_global_loss: 26650277.9542; train_optim_loss: 26650277.9542; val_kl_reg_loss: 101176.9760; val_edge_recon_loss: 2838200.3167; val_gene_expr_recon_loss: 14820724.3333; val_masked_gp_l1_reg_loss: 97530.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55598.1211; val_chrom_access_recon_loss: 8610812.9667; val_global_loss: 26524042.6667; val_optim_loss: 26524042.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9340; val_auprc_score: 0.9192; val_best_acc_score: 0.8680; val_best_f1_score: 0.8759; train_kl_reg_loss: 101998.9323; train_edge_recon_loss: 2808445.6985; train_gene_expr_recon_loss: 14785544.3053; train_masked_gp_l1_reg_loss: 98787.8367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51930.6548; train_chrom_access_recon_loss: 8564214.2634; train_global_loss: 26410921.7252; train_optim_loss: 26410921.7252; val_kl_reg_loss: 101894.8583; val_edge_recon_loss: 2806161.7333; val_gene_expr_recon_loss: 14697616.5333; val_masked_gp_l1_reg_loss: 100282.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49536.9922; val_chrom_access_recon_loss: 8541289.3333; val_global_loss: 26296780.8000; val_optim_loss: 26296780.8000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9378; val_auprc_score: 0.9253; val_best_acc_score: 0.8688; val_best_f1_score: 0.8761; train_kl_reg_loss: 99689.4222; train_edge_recon_loss: 2789380.7557; train_gene_expr_recon_loss: 14676775.1374; train_masked_gp_l1_reg_loss: 101450.8528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47060.9464; train_chrom_access_recon_loss: 8508707.7557; train_global_loss: 26223064.8397; train_optim_loss: 26223064.8397; val_kl_reg_loss: 100016.6073; val_edge_recon_loss: 2809605.4333; val_gene_expr_recon_loss: 14629787.0667; val_masked_gp_l1_reg_loss: 102442.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45151.1680; val_chrom_access_recon_loss: 8473619.3333; val_global_loss: 26160622.5333; val_optim_loss: 26160622.5333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9436; val_auprc_score: 0.9304; val_best_acc_score: 0.8798; val_best_f1_score: 0.8861; train_kl_reg_loss: 99216.8120; train_edge_recon_loss: 2760081.2290; train_gene_expr_recon_loss: 14592585.5802; train_masked_gp_l1_reg_loss: 103527.1068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44120.4745; train_chrom_access_recon_loss: 8462971.6565; train_global_loss: 26062502.8244; train_optim_loss: 26062502.8244; val_kl_reg_loss: 96921.3630; val_edge_recon_loss: 2786253.4833; val_gene_expr_recon_loss: 14577110.0000; val_masked_gp_l1_reg_loss: 104617.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43463.4688; val_chrom_access_recon_loss: 8442041.7000; val_global_loss: 26050408.6667; val_optim_loss: 26050408.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9466; val_auprc_score: 0.9341; val_best_acc_score: 0.8857; val_best_f1_score: 0.8923; train_kl_reg_loss: 95921.3984; train_edge_recon_loss: 2757041.2424; train_gene_expr_recon_loss: 14502409.7328; train_masked_gp_l1_reg_loss: 105588.6236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42658.4607; train_chrom_access_recon_loss: 8400747.0038; train_global_loss: 25904366.5191; train_optim_loss: 25904366.5191; val_kl_reg_loss: 94661.6536; val_edge_recon_loss: 2757205.4833; val_gene_expr_recon_loss: 14434525.3333; val_masked_gp_l1_reg_loss: 106695.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42472.8516; val_chrom_access_recon_loss: 8342928.3000; val_global_loss: 25778488.9333; val_optim_loss: 25778488.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9517; val_auprc_score: 0.9375; val_best_acc_score: 0.8934; val_best_f1_score: 0.8985; train_kl_reg_loss: 94299.1443; train_edge_recon_loss: 2739905.9809; train_gene_expr_recon_loss: 14438010.1221; train_masked_gp_l1_reg_loss: 107491.3003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41791.2804; train_chrom_access_recon_loss: 8364344.8092; train_global_loss: 25785842.6565; train_optim_loss: 25785842.6565; val_kl_reg_loss: 94402.5057; val_edge_recon_loss: 2759034.5167; val_gene_expr_recon_loss: 14390289.2000; val_masked_gp_l1_reg_loss: 108323.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41368.9375; val_chrom_access_recon_loss: 8302850.2000; val_global_loss: 25696268.2667; val_optim_loss: 25696268.2667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9556; val_auprc_score: 0.9434; val_best_acc_score: 0.8973; val_best_f1_score: 0.9022; train_kl_reg_loss: 93688.0542; train_edge_recon_loss: 2733647.6851; train_gene_expr_recon_loss: 14365416.3969; train_masked_gp_l1_reg_loss: 109022.9807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40872.2369; train_chrom_access_recon_loss: 8320037.8015; train_global_loss: 25662685.1756; train_optim_loss: 25662685.1756; val_kl_reg_loss: 93096.9724; val_edge_recon_loss: 2741182.3833; val_gene_expr_recon_loss: 14383554.6000; val_masked_gp_l1_reg_loss: 110039.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40921.3203; val_chrom_access_recon_loss: 8312761.9000; val_global_loss: 25681557.4667; val_optim_loss: 25681557.4667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9527; val_auprc_score: 0.9423; val_best_acc_score: 0.8923; val_best_f1_score: 0.8985; train_kl_reg_loss: 92065.8640; train_edge_recon_loss: 2730469.8130; train_gene_expr_recon_loss: 14297766.4046; train_masked_gp_l1_reg_loss: 110443.8559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40164.5098; train_chrom_access_recon_loss: 8277270.0573; train_global_loss: 25548180.4427; train_optim_loss: 25548180.4427; val_kl_reg_loss: 88456.6755; val_edge_recon_loss: 2761947.1333; val_gene_expr_recon_loss: 14228090.1333; val_masked_gp_l1_reg_loss: 111122.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39993.0938; val_chrom_access_recon_loss: 8222282.0000; val_global_loss: 25451892.0000; val_optim_loss: 25451892.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9588; val_auprc_score: 0.9471; val_best_acc_score: 0.9027; val_best_f1_score: 0.9062; train_kl_reg_loss: 89670.7625; train_edge_recon_loss: 2735677.0134; train_gene_expr_recon_loss: 14252803.7405; train_masked_gp_l1_reg_loss: 111772.4172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39407.8774; train_chrom_access_recon_loss: 8239467.4046; train_global_loss: 25468799.1450; train_optim_loss: 25468799.1450; val_kl_reg_loss: 86930.0953; val_edge_recon_loss: 2748884.1333; val_gene_expr_recon_loss: 14210470.0667; val_masked_gp_l1_reg_loss: 112565.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39129.7383; val_chrom_access_recon_loss: 8192179.1667; val_global_loss: 25390159.4667; val_optim_loss: 25390159.4667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9579; val_auprc_score: 0.9435; val_best_acc_score: 0.9002; val_best_f1_score: 0.9044; train_kl_reg_loss: 88548.2752; train_edge_recon_loss: 2721853.6947; train_gene_expr_recon_loss: 14199964.0305; train_masked_gp_l1_reg_loss: 113057.9050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38757.7023; train_chrom_access_recon_loss: 8205592.7481; train_global_loss: 25367774.4122; train_optim_loss: 25367774.4122; val_kl_reg_loss: 91625.8750; val_edge_recon_loss: 2726666.9000; val_gene_expr_recon_loss: 14137881.3333; val_masked_gp_l1_reg_loss: 113916.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38782.8477; val_chrom_access_recon_loss: 8140302.5333; val_global_loss: 25249175.3333; val_optim_loss: 25249175.3333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9613; val_auprc_score: 0.9455; val_best_acc_score: 0.9056; val_best_f1_score: 0.9097; train_kl_reg_loss: 87060.5521; train_edge_recon_loss: 2713434.2576; train_gene_expr_recon_loss: 14149910.1374; train_masked_gp_l1_reg_loss: 114227.0020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38283.2611; train_chrom_access_recon_loss: 8176456.0229; train_global_loss: 25279371.3435; train_optim_loss: 25279371.3435; val_kl_reg_loss: 87387.5323; val_edge_recon_loss: 2722845.5500; val_gene_expr_recon_loss: 14099623.8000; val_masked_gp_l1_reg_loss: 114992.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38401.2344; val_chrom_access_recon_loss: 8117239.3333; val_global_loss: 25180490.4000; val_optim_loss: 25180490.4000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9640; val_auprc_score: 0.9513; val_best_acc_score: 0.9097; val_best_f1_score: 0.9141; train_kl_reg_loss: 86772.0291; train_edge_recon_loss: 2713876.6050; train_gene_expr_recon_loss: 14110072.0992; train_masked_gp_l1_reg_loss: 115327.7410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37907.9368; train_chrom_access_recon_loss: 8147229.7901; train_global_loss: 25211186.2137; train_optim_loss: 25211186.2137; val_kl_reg_loss: 84311.2188; val_edge_recon_loss: 2708186.7833; val_gene_expr_recon_loss: 14047219.0667; val_masked_gp_l1_reg_loss: 115826.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37887.7930; val_chrom_access_recon_loss: 8099460.2667; val_global_loss: 25092891.0667; val_optim_loss: 25092891.0667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9685; val_auprc_score: 0.9579; val_best_acc_score: 0.9185; val_best_f1_score: 0.9207; train_kl_reg_loss: 84872.2035; train_edge_recon_loss: 2712730.0458; train_gene_expr_recon_loss: 14067588.1679; train_masked_gp_l1_reg_loss: 116349.9678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37601.3102; train_chrom_access_recon_loss: 8117571.6870; train_global_loss: 25136713.3588; train_optim_loss: 25136713.3588; val_kl_reg_loss: 85685.6703; val_edge_recon_loss: 2723385.0333; val_gene_expr_recon_loss: 14004245.8667; val_masked_gp_l1_reg_loss: 117018.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37487.6406; val_chrom_access_recon_loss: 8089295.5000; val_global_loss: 25057118.4000; val_optim_loss: 25057118.4000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9670; val_auprc_score: 0.9575; val_best_acc_score: 0.9155; val_best_f1_score: 0.9190; train_kl_reg_loss: 85174.0419; train_edge_recon_loss: 2699613.9237; train_gene_expr_recon_loss: 14025399.2443; train_masked_gp_l1_reg_loss: 117339.3789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37374.6254; train_chrom_access_recon_loss: 8084111.8664; train_global_loss: 25049013.1756; train_optim_loss: 25049013.1756; val_kl_reg_loss: 83105.5823; val_edge_recon_loss: 2713127.1667; val_gene_expr_recon_loss: 13995925.4000; val_masked_gp_l1_reg_loss: 117723.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37217.8086; val_chrom_access_recon_loss: 8068080.0333; val_global_loss: 25015180.4000; val_optim_loss: 25015180.4000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9712; val_auprc_score: 0.9641; val_best_acc_score: 0.9232; val_best_f1_score: 0.9253; train_kl_reg_loss: 83683.6684; train_edge_recon_loss: 2697789.5420; train_gene_expr_recon_loss: 13995849.0305; train_masked_gp_l1_reg_loss: 118124.6517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37173.6102; train_chrom_access_recon_loss: 8063005.3053; train_global_loss: 24995625.8473; train_optim_loss: 24995625.8473; val_kl_reg_loss: 84446.6781; val_edge_recon_loss: 2696325.6167; val_gene_expr_recon_loss: 14010409.4667; val_masked_gp_l1_reg_loss: 118497.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36935.2031; val_chrom_access_recon_loss: 8077257.6667; val_global_loss: 25023872.6667; val_optim_loss: 25023872.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9732; val_auprc_score: 0.9650; val_best_acc_score: 0.9255; val_best_f1_score: 0.9275; train_kl_reg_loss: 83812.5175; train_edge_recon_loss: 2707078.6279; train_gene_expr_recon_loss: 13962638.3359; train_masked_gp_l1_reg_loss: 118925.3650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37069.2299; train_chrom_access_recon_loss: 8044972.5496; train_global_loss: 24954496.7023; train_optim_loss: 24954496.7023; val_kl_reg_loss: 82226.9542; val_edge_recon_loss: 2714801.3167; val_gene_expr_recon_loss: 13971161.9333; val_masked_gp_l1_reg_loss: 119416.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37110.4961; val_chrom_access_recon_loss: 8060634.3000; val_global_loss: 24985350.9333; val_optim_loss: 24985350.9333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9701; val_auprc_score: 0.9612; val_best_acc_score: 0.9170; val_best_f1_score: 0.9207; train_kl_reg_loss: 83218.5682; train_edge_recon_loss: 2699930.1775; train_gene_expr_recon_loss: 13941263.5649; train_masked_gp_l1_reg_loss: 119751.0900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37080.3742; train_chrom_access_recon_loss: 8027949.9275; train_global_loss: 24909193.7557; train_optim_loss: 24909193.7557; val_kl_reg_loss: 83620.5594; val_edge_recon_loss: 2730873.2333; val_gene_expr_recon_loss: 13943016.0000; val_masked_gp_l1_reg_loss: 120044.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37029.3555; val_chrom_access_recon_loss: 8008316.5667; val_global_loss: 24922900.6667; val_optim_loss: 24922900.6667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9737; val_auprc_score: 0.9663; val_best_acc_score: 0.9250; val_best_f1_score: 0.9271; train_kl_reg_loss: 82731.7041; train_edge_recon_loss: 2695793.4351; train_gene_expr_recon_loss: 13915630.9160; train_masked_gp_l1_reg_loss: 120328.1523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37070.0392; train_chrom_access_recon_loss: 8008039.5191; train_global_loss: 24859593.8473; train_optim_loss: 24859593.8473; val_kl_reg_loss: 83130.0755; val_edge_recon_loss: 2701388.1833; val_gene_expr_recon_loss: 13906462.2667; val_masked_gp_l1_reg_loss: 120629.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36905.9648; val_chrom_access_recon_loss: 8009172.7667; val_global_loss: 24857689.2000; val_optim_loss: 24857689.2000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9754; val_auprc_score: 0.9666; val_best_acc_score: 0.9272; val_best_f1_score: 0.9298; train_kl_reg_loss: 82041.5815; train_edge_recon_loss: 2698307.3473; train_gene_expr_recon_loss: 13889908.4809; train_masked_gp_l1_reg_loss: 120931.9185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37090.1919; train_chrom_access_recon_loss: 7992240.4847; train_global_loss: 24820520.0305; train_optim_loss: 24820520.0305; val_kl_reg_loss: 82523.9328; val_edge_recon_loss: 2702384.8500; val_gene_expr_recon_loss: 13916879.6667; val_masked_gp_l1_reg_loss: 121304.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36956.2305; val_chrom_access_recon_loss: 8024504.1000; val_global_loss: 24884552.5333; val_optim_loss: 24884552.5333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9755; val_auprc_score: 0.9694; val_best_acc_score: 0.9299; val_best_f1_score: 0.9323; train_kl_reg_loss: 81503.1219; train_edge_recon_loss: 2692538.8721; train_gene_expr_recon_loss: 13857026.1832; train_masked_gp_l1_reg_loss: 121579.5131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37124.7780; train_chrom_access_recon_loss: 7974099.9351; train_global_loss: 24763872.4733; train_optim_loss: 24763872.4733; val_kl_reg_loss: 81305.1104; val_edge_recon_loss: 2706709.3000; val_gene_expr_recon_loss: 13824324.8000; val_masked_gp_l1_reg_loss: 121867.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37223.4180; val_chrom_access_recon_loss: 7952458.9333; val_global_loss: 24723888.5333; val_optim_loss: 24723888.5333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9770; val_auprc_score: 0.9713; val_best_acc_score: 0.9328; val_best_f1_score: 0.9352; train_kl_reg_loss: 86075.2117; train_edge_recon_loss: 2702228.3931; train_gene_expr_recon_loss: 13594978.6489; train_masked_gp_l1_reg_loss: 119545.8770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31609.8487; train_chrom_access_recon_loss: 7839929.7519; train_global_loss: 24374367.8015; train_optim_loss: 24374367.8015; val_kl_reg_loss: 64952.7195; val_edge_recon_loss: 2708291.0667; val_gene_expr_recon_loss: 13560751.8000; val_masked_gp_l1_reg_loss: 119050.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30589.1836; val_chrom_access_recon_loss: 7780566.1667; val_global_loss: 24264201.3333; val_optim_loss: 24264201.3333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9787; val_auprc_score: 0.9723; val_best_acc_score: 0.9359; val_best_f1_score: 0.9375; train_kl_reg_loss: 82764.5795; train_edge_recon_loss: 2701062.2156; train_gene_expr_recon_loss: 13565945.8168; train_masked_gp_l1_reg_loss: 118965.4073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30545.1520; train_chrom_access_recon_loss: 7814924.6756; train_global_loss: 24314207.7099; train_optim_loss: 24314207.7099; val_kl_reg_loss: 66410.5018; val_edge_recon_loss: 2699380.4333; val_gene_expr_recon_loss: 13557314.0667; val_masked_gp_l1_reg_loss: 118928.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30621.2930; val_chrom_access_recon_loss: 7793719.2333; val_global_loss: 24266373.0667; val_optim_loss: 24266373.0667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9782; val_auprc_score: 0.9743; val_best_acc_score: 0.9276; val_best_f1_score: 0.9302; train_kl_reg_loss: 80684.7898; train_edge_recon_loss: 2681391.6584; train_gene_expr_recon_loss: 13539655.7328; train_masked_gp_l1_reg_loss: 118903.9791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30654.9242; train_chrom_access_recon_loss: 7796339.0344; train_global_loss: 24247630.1221; train_optim_loss: 24247630.1221; val_kl_reg_loss: 67814.4229; val_edge_recon_loss: 2695931.4833; val_gene_expr_recon_loss: 13455097.2000; val_masked_gp_l1_reg_loss: 118890.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30626.4883; val_chrom_access_recon_loss: 7761044.9667; val_global_loss: 24129404.0000; val_optim_loss: 24129404.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9792; val_auprc_score: 0.9739; val_best_acc_score: 0.9341; val_best_f1_score: 0.9355; train_kl_reg_loss: 77960.1199; train_edge_recon_loss: 2693878.9866; train_gene_expr_recon_loss: 13509859.5115; train_masked_gp_l1_reg_loss: 118919.3322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30787.1742; train_chrom_access_recon_loss: 7782679.5191; train_global_loss: 24214084.6107; train_optim_loss: 24214084.6107; val_kl_reg_loss: 70920.0057; val_edge_recon_loss: 2696769.9667; val_gene_expr_recon_loss: 13475776.4000; val_masked_gp_l1_reg_loss: 118991.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30876.3574; val_chrom_access_recon_loss: 7771979.6667; val_global_loss: 24165312.9333; val_optim_loss: 24165312.9333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9794; val_auprc_score: 0.9746; val_best_acc_score: 0.9360; val_best_f1_score: 0.9385; train_kl_reg_loss: 77371.9879; train_edge_recon_loss: 2678627.1011; train_gene_expr_recon_loss: 13474607.0992; train_masked_gp_l1_reg_loss: 118893.9373; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30850.1251; train_chrom_access_recon_loss: 7758894.8435; train_global_loss: 24139245.2061; train_optim_loss: 24139245.2061; val_kl_reg_loss: 69575.5505; val_edge_recon_loss: 2687484.4833; val_gene_expr_recon_loss: 13457781.0667; val_masked_gp_l1_reg_loss: 118665.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30985.7598; val_chrom_access_recon_loss: 7736406.3333; val_global_loss: 24100899.6000; val_optim_loss: 24100899.6000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9799; val_auprc_score: 0.9745; val_best_acc_score: 0.9376; val_best_f1_score: 0.9388; train_kl_reg_loss: 75953.0089; train_edge_recon_loss: 2682453.7653; train_gene_expr_recon_loss: 13458393.2214; train_masked_gp_l1_reg_loss: 118796.2449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30944.2451; train_chrom_access_recon_loss: 7748601.1756; train_global_loss: 24115141.5115; train_optim_loss: 24115141.5115; val_kl_reg_loss: 70557.4979; val_edge_recon_loss: 2670891.0500; val_gene_expr_recon_loss: 13520801.0000; val_masked_gp_l1_reg_loss: 118849.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30835.4375; val_chrom_access_recon_loss: 7781044.8667; val_global_loss: 24192978.9333; val_optim_loss: 24192978.9333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9804; val_auprc_score: 0.9729; val_best_acc_score: 0.9378; val_best_f1_score: 0.9394; train_kl_reg_loss: 75200.9402; train_edge_recon_loss: 2678499.4714; train_gene_expr_recon_loss: 13441052.8855; train_masked_gp_l1_reg_loss: 118934.9817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30949.2684; train_chrom_access_recon_loss: 7738649.8588; train_global_loss: 24083287.3282; train_optim_loss: 24083287.3282; val_kl_reg_loss: 68057.4281; val_edge_recon_loss: 2689836.5500; val_gene_expr_recon_loss: 13390767.4667; val_masked_gp_l1_reg_loss: 119084.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31041.3965; val_chrom_access_recon_loss: 7705236.5667; val_global_loss: 24004024.0000; val_optim_loss: 24004024.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9796; val_auprc_score: 0.9746; val_best_acc_score: 0.9325; val_best_f1_score: 0.9341; train_kl_reg_loss: 74756.3316; train_edge_recon_loss: 2678191.9046; train_gene_expr_recon_loss: 13417619.2748; train_masked_gp_l1_reg_loss: 119022.0965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30997.8675; train_chrom_access_recon_loss: 7725600.6527; train_global_loss: 24046188.1832; train_optim_loss: 24046188.1832; val_kl_reg_loss: 69398.4370; val_edge_recon_loss: 2698539.0333; val_gene_expr_recon_loss: 13426429.6667; val_masked_gp_l1_reg_loss: 119118.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31036.8828; val_chrom_access_recon_loss: 7726297.5667; val_global_loss: 24070819.6000; val_optim_loss: 24070819.6000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9811; val_auprc_score: 0.9760; val_best_acc_score: 0.9352; val_best_f1_score: 0.9370; train_kl_reg_loss: 74060.5141; train_edge_recon_loss: 2676637.6718; train_gene_expr_recon_loss: 13400061.3817; train_masked_gp_l1_reg_loss: 119032.9181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31092.7386; train_chrom_access_recon_loss: 7717149.4466; train_global_loss: 24018034.7481; train_optim_loss: 24018034.7481; val_kl_reg_loss: 69724.9620; val_edge_recon_loss: 2681085.4833; val_gene_expr_recon_loss: 13344667.6667; val_masked_gp_l1_reg_loss: 119112.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31039.2207; val_chrom_access_recon_loss: 7691799.5333; val_global_loss: 23937428.6667; val_optim_loss: 23937428.6667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9818; val_auprc_score: 0.9770; val_best_acc_score: 0.9363; val_best_f1_score: 0.9384; train_kl_reg_loss: 73450.7683; train_edge_recon_loss: 2674488.1317; train_gene_expr_recon_loss: 13402118.1832; train_masked_gp_l1_reg_loss: 119103.2774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31073.3535; train_chrom_access_recon_loss: 7716424.1527; train_global_loss: 24016657.9389; train_optim_loss: 24016657.9389; val_kl_reg_loss: 70282.4229; val_edge_recon_loss: 2694687.9167; val_gene_expr_recon_loss: 13438464.4667; val_masked_gp_l1_reg_loss: 119167.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31196.0781; val_chrom_access_recon_loss: 7703860.6333; val_global_loss: 24057658.5333; val_optim_loss: 24057658.5333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9798; val_auprc_score: 0.9712; val_best_acc_score: 0.9365; val_best_f1_score: 0.9381; train_kl_reg_loss: 72786.7566; train_edge_recon_loss: 2672336.9809; train_gene_expr_recon_loss: 13385401.0534; train_masked_gp_l1_reg_loss: 119143.1168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31167.0816; train_chrom_access_recon_loss: 7717158.5534; train_global_loss: 23997993.4962; train_optim_loss: 23997993.4962; val_kl_reg_loss: 68695.7505; val_edge_recon_loss: 2676744.2333; val_gene_expr_recon_loss: 13402018.2667; val_masked_gp_l1_reg_loss: 119050.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31181.5371; val_chrom_access_recon_loss: 7693068.0000; val_global_loss: 23990758.0000; val_optim_loss: 23990758.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9829; val_auprc_score: 0.9775; val_best_acc_score: 0.9380; val_best_f1_score: 0.9388; train_kl_reg_loss: 72323.4590; train_edge_recon_loss: 2677264.4294; train_gene_expr_recon_loss: 13373585.8626; train_masked_gp_l1_reg_loss: 119001.8916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31168.0377; train_chrom_access_recon_loss: 7700105.1641; train_global_loss: 23973448.8092; train_optim_loss: 23973448.8092; val_kl_reg_loss: 69104.7193; val_edge_recon_loss: 2685112.8000; val_gene_expr_recon_loss: 13382818.8667; val_masked_gp_l1_reg_loss: 119006.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31222.3672; val_chrom_access_recon_loss: 7699401.5000; val_global_loss: 23986666.6667; val_optim_loss: 23986666.6667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9840; val_auprc_score: 0.9797; val_best_acc_score: 0.9442; val_best_f1_score: 0.9448; train_kl_reg_loss: 71572.6994; train_edge_recon_loss: 2676152.3626; train_gene_expr_recon_loss: 13358290.5115; train_masked_gp_l1_reg_loss: 118974.1604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31215.0802; train_chrom_access_recon_loss: 7694426.4008; train_global_loss: 23950631.1908; train_optim_loss: 23950631.1908; val_kl_reg_loss: 69651.9292; val_edge_recon_loss: 2667387.9833; val_gene_expr_recon_loss: 13350906.8667; val_masked_gp_l1_reg_loss: 119089.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31180.0840; val_chrom_access_recon_loss: 7654015.2667; val_global_loss: 23892231.7333; val_optim_loss: 23892231.7333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9806; val_auprc_score: 0.9746; val_best_acc_score: 0.9382; val_best_f1_score: 0.9400; train_kl_reg_loss: 71394.5659; train_edge_recon_loss: 2672530.1527; train_gene_expr_recon_loss: 13352229.8473; train_masked_gp_l1_reg_loss: 119091.5997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31247.8312; train_chrom_access_recon_loss: 7689474.9198; train_global_loss: 23935968.9924; train_optim_loss: 23935968.9924; val_kl_reg_loss: 69959.8177; val_edge_recon_loss: 2696404.5000; val_gene_expr_recon_loss: 13359600.6000; val_masked_gp_l1_reg_loss: 119069.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31171.8516; val_chrom_access_recon_loss: 7648164.4333; val_global_loss: 23924370.2667; val_optim_loss: 23924370.2667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9858; val_auprc_score: 0.9828; val_best_acc_score: 0.9458; val_best_f1_score: 0.9466; train_kl_reg_loss: 72026.6240; train_edge_recon_loss: 2674131.4866; train_gene_expr_recon_loss: 13348212.3511; train_masked_gp_l1_reg_loss: 119029.1009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31273.0015; train_chrom_access_recon_loss: 7693559.3206; train_global_loss: 23938231.8015; train_optim_loss: 23938231.8015; val_kl_reg_loss: 68772.1557; val_edge_recon_loss: 2675019.5167; val_gene_expr_recon_loss: 13288180.0000; val_masked_gp_l1_reg_loss: 119044.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31344.1836; val_chrom_access_recon_loss: 7644731.7667; val_global_loss: 23827092.4000; val_optim_loss: 23827092.4000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9832; val_auprc_score: 0.9783; val_best_acc_score: 0.9438; val_best_f1_score: 0.9450; train_kl_reg_loss: 71941.4444; train_edge_recon_loss: 2671776.6202; train_gene_expr_recon_loss: 13329757.0076; train_masked_gp_l1_reg_loss: 118956.5616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31254.9821; train_chrom_access_recon_loss: 7675920.3053; train_global_loss: 23899606.8397; train_optim_loss: 23899606.8397; val_kl_reg_loss: 69593.3714; val_edge_recon_loss: 2686126.9667; val_gene_expr_recon_loss: 13365315.6000; val_masked_gp_l1_reg_loss: 119010.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31265.8027; val_chrom_access_recon_loss: 7657295.7000; val_global_loss: 23928608.5333; val_optim_loss: 23928608.5333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9835; val_auprc_score: 0.9792; val_best_acc_score: 0.9395; val_best_f1_score: 0.9409; train_kl_reg_loss: 72154.0217; train_edge_recon_loss: 2667379.0000; train_gene_expr_recon_loss: 13322665.1221; train_masked_gp_l1_reg_loss: 118909.8007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31226.5307; train_chrom_access_recon_loss: 7668319.1870; train_global_loss: 23880653.7405; train_optim_loss: 23880653.7405; val_kl_reg_loss: 70885.6245; val_edge_recon_loss: 2692685.5333; val_gene_expr_recon_loss: 13291038.7333; val_masked_gp_l1_reg_loss: 118950.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31182.8867; val_chrom_access_recon_loss: 7636672.2333; val_global_loss: 23841415.0667; val_optim_loss: 23841415.0667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9857; val_auprc_score: 0.9791; val_best_acc_score: 0.9476; val_best_f1_score: 0.9490; train_kl_reg_loss: 71456.1406; train_edge_recon_loss: 2663004.1279; train_gene_expr_recon_loss: 13315828.6183; train_masked_gp_l1_reg_loss: 118865.5432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31219.8204; train_chrom_access_recon_loss: 7659451.2634; train_global_loss: 23859825.5725; train_optim_loss: 23859825.5725; val_kl_reg_loss: 69559.9193; val_edge_recon_loss: 2674911.9333; val_gene_expr_recon_loss: 13300789.8667; val_masked_gp_l1_reg_loss: 118894.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31348.2148; val_chrom_access_recon_loss: 7638294.0000; val_global_loss: 23833797.8667; val_optim_loss: 23833797.8667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9856; val_auprc_score: 0.9828; val_best_acc_score: 0.9453; val_best_f1_score: 0.9467; train_kl_reg_loss: 71275.6286; train_edge_recon_loss: 2660357.8855; train_gene_expr_recon_loss: 13302975.8931; train_masked_gp_l1_reg_loss: 118857.2549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31323.6172; train_chrom_access_recon_loss: 7649022.5916; train_global_loss: 23833812.9466; train_optim_loss: 23833812.9466; val_kl_reg_loss: 70184.5922; val_edge_recon_loss: 2688733.7333; val_gene_expr_recon_loss: 13328956.6000; val_masked_gp_l1_reg_loss: 118745.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31238.4023; val_chrom_access_recon_loss: 7666464.2667; val_global_loss: 23904322.1333; val_optim_loss: 23904322.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9865; val_auprc_score: 0.9827; val_best_acc_score: 0.9483; val_best_f1_score: 0.9493; train_kl_reg_loss: 71724.3885; train_edge_recon_loss: 2659068.0229; train_gene_expr_recon_loss: 13280583.5649; train_masked_gp_l1_reg_loss: 117250.6699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27773.1932; train_chrom_access_recon_loss: 7640994.0573; train_global_loss: 23797394.0305; train_optim_loss: 23797394.0305; val_kl_reg_loss: 71387.8391; val_edge_recon_loss: 2655998.4833; val_gene_expr_recon_loss: 13301101.6667; val_masked_gp_l1_reg_loss: 116702.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27287.3535; val_chrom_access_recon_loss: 7615351.5333; val_global_loss: 23787828.9333; val_optim_loss: 23787828.9333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9860; val_auprc_score: 0.9829; val_best_acc_score: 0.9464; val_best_f1_score: 0.9474; train_kl_reg_loss: 72636.3357; train_edge_recon_loss: 2663475.8588; train_gene_expr_recon_loss: 13269611.3359; train_masked_gp_l1_reg_loss: 116533.9875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27160.7230; train_chrom_access_recon_loss: 7640416.7214; train_global_loss: 23789834.9771; train_optim_loss: 23789834.9771; val_kl_reg_loss: 70820.6193; val_edge_recon_loss: 2666019.1333; val_gene_expr_recon_loss: 13235481.8000; val_masked_gp_l1_reg_loss: 116421.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27052.5820; val_chrom_access_recon_loss: 7598139.7333; val_global_loss: 23713935.3333; val_optim_loss: 23713935.3333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9864; val_auprc_score: 0.9830; val_best_acc_score: 0.9485; val_best_f1_score: 0.9498; train_kl_reg_loss: 72589.6592; train_edge_recon_loss: 2661370.7557; train_gene_expr_recon_loss: 13271662.9237; train_masked_gp_l1_reg_loss: 116360.4185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26985.8478; train_chrom_access_recon_loss: 7640627.3321; train_global_loss: 23789596.7939; train_optim_loss: 23789596.7939; val_kl_reg_loss: 70857.2177; val_edge_recon_loss: 2687867.0333; val_gene_expr_recon_loss: 13273937.8667; val_masked_gp_l1_reg_loss: 116296.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26889.5352; val_chrom_access_recon_loss: 7617042.5000; val_global_loss: 23792891.0667; val_optim_loss: 23792891.0667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9878; val_auprc_score: 0.9846; val_best_acc_score: 0.9500; val_best_f1_score: 0.9511; train_kl_reg_loss: 72742.2856; train_edge_recon_loss: 2661387.5802; train_gene_expr_recon_loss: 13272900.4046; train_masked_gp_l1_reg_loss: 116267.1770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26823.9946; train_chrom_access_recon_loss: 7641435.6565; train_global_loss: 23791557.0534; train_optim_loss: 23791557.0534; val_kl_reg_loss: 70985.1995; val_edge_recon_loss: 2652989.2000; val_gene_expr_recon_loss: 13278931.9333; val_masked_gp_l1_reg_loss: 116234.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26761.3516; val_chrom_access_recon_loss: 7622376.6000; val_global_loss: 23768278.0000; val_optim_loss: 23768278.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9849; val_auprc_score: 0.9790; val_best_acc_score: 0.9475; val_best_f1_score: 0.9484; train_kl_reg_loss: 72993.8283; train_edge_recon_loss: 2665702.7634; train_gene_expr_recon_loss: 13263460.6641; train_masked_gp_l1_reg_loss: 116210.4006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26701.3105; train_chrom_access_recon_loss: 7638418.2748; train_global_loss: 23783487.2824; train_optim_loss: 23783487.2824; val_kl_reg_loss: 72081.2120; val_edge_recon_loss: 2672861.9833; val_gene_expr_recon_loss: 13325422.6667; val_masked_gp_l1_reg_loss: 116185.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26633.4727; val_chrom_access_recon_loss: 7630579.4000; val_global_loss: 23843764.4000; val_optim_loss: 23843764.4000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9885; val_auprc_score: 0.9858; val_best_acc_score: 0.9538; val_best_f1_score: 0.9545; train_kl_reg_loss: 73008.6243; train_edge_recon_loss: 2658909.7347; train_gene_expr_recon_loss: 13269048.5267; train_masked_gp_l1_reg_loss: 116169.7613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26590.6001; train_chrom_access_recon_loss: 7636722.4160; train_global_loss: 23780449.4656; train_optim_loss: 23780449.4656; val_kl_reg_loss: 71282.3328; val_edge_recon_loss: 2669038.1333; val_gene_expr_recon_loss: 13303479.0667; val_masked_gp_l1_reg_loss: 116143.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26538.5469; val_chrom_access_recon_loss: 7621118.9333; val_global_loss: 23807600.4000; val_optim_loss: 23807600.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9860; val_auprc_score: 0.9824; val_best_acc_score: 0.9489; val_best_f1_score: 0.9501; train_kl_reg_loss: 72971.1771; train_edge_recon_loss: 2660474.5878; train_gene_expr_recon_loss: 13271452.3588; train_masked_gp_l1_reg_loss: 115990.3643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26178.4772; train_chrom_access_recon_loss: 7645781.2099; train_global_loss: 23792848.0153; train_optim_loss: 23792848.0153; val_kl_reg_loss: 71619.2370; val_edge_recon_loss: 2674485.0000; val_gene_expr_recon_loss: 13263668.7333; val_masked_gp_l1_reg_loss: 115923.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26134.6504; val_chrom_access_recon_loss: 7627420.4000; val_global_loss: 23779252.4000; val_optim_loss: 23779252.4000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9864; val_auprc_score: 0.9812; val_best_acc_score: 0.9487; val_best_f1_score: 0.9496; train_kl_reg_loss: 73083.4931; train_edge_recon_loss: 2665002.6527; train_gene_expr_recon_loss: 13260771.7328; train_masked_gp_l1_reg_loss: 115899.3737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26124.1577; train_chrom_access_recon_loss: 7636870.4962; train_global_loss: 23777752.0458; train_optim_loss: 23777752.0458; val_kl_reg_loss: 71577.2120; val_edge_recon_loss: 2680435.9667; val_gene_expr_recon_loss: 13307219.6667; val_masked_gp_l1_reg_loss: 115878.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26112.9551; val_chrom_access_recon_loss: 7631738.9333; val_global_loss: 23832962.4000; val_optim_loss: 23832962.4000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9877; val_auprc_score: 0.9856; val_best_acc_score: 0.9480; val_best_f1_score: 0.9494; train_kl_reg_loss: 73016.2517; train_edge_recon_loss: 2663825.5821; train_gene_expr_recon_loss: 13265920.2137; train_masked_gp_l1_reg_loss: 115866.3383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26102.4496; train_chrom_access_recon_loss: 7637472.9885; train_global_loss: 23782203.8015; train_optim_loss: 23782203.8015; val_kl_reg_loss: 71484.5151; val_edge_recon_loss: 2674475.0667; val_gene_expr_recon_loss: 13307255.4000; val_masked_gp_l1_reg_loss: 115856.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26093.1309; val_chrom_access_recon_loss: 7638948.6667; val_global_loss: 23834113.3333; val_optim_loss: 23834113.3333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9867; val_auprc_score: 0.9823; val_best_acc_score: 0.9480; val_best_f1_score: 0.9494; train_kl_reg_loss: 72902.4359; train_edge_recon_loss: 2664216.3053; train_gene_expr_recon_loss: 13271952.0458; train_masked_gp_l1_reg_loss: 115852.2638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26084.4404; train_chrom_access_recon_loss: 7638662.7099; train_global_loss: 23789670.1679; train_optim_loss: 23789670.1679; val_kl_reg_loss: 70895.9229; val_edge_recon_loss: 2676663.5333; val_gene_expr_recon_loss: 13300808.8667; val_masked_gp_l1_reg_loss: 115843.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26076.4336; val_chrom_access_recon_loss: 7633401.9667; val_global_loss: 23823689.0667; val_optim_loss: 23823689.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 78 min 7 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9860
val AUPRC score: 0.9802
val best accuracy score: 0.9493
val best F1 score: 0.9502
val target rna MSE score: 0.8373
val source rna MSE score: 0.1846
val target atac MSE score: 0.3358
val source atac MSE score: 0.0558
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
