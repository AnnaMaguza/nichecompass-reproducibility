[True]
Run timestamp: 26072023_041430_161.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_161']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9020; val_auprc_score: 0.9148; val_best_acc_score: 0.5086; val_best_f1_score: 0.6705; train_kl_reg_loss: 8298.6330; train_edge_recon_loss: 34753412.0000; train_gene_expr_recon_loss: 30904588.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 107416546.6667; train_global_loss: 173082848.0000; train_optim_loss: 173082848.0000; val_kl_reg_loss: 39137.9219; val_edge_recon_loss: 40645920.0000; val_gene_expr_recon_loss: 29422224.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 106597392.0000; val_global_loss: 176704672.0000; val_optim_loss: 176704672.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8935; val_auprc_score: 0.9089; val_best_acc_score: 0.5054; val_best_f1_score: 0.6690; train_kl_reg_loss: 63590.6187; train_edge_recon_loss: 34873286.2222; train_gene_expr_recon_loss: 28556256.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 106143493.3333; train_global_loss: 169636624.0000; train_optim_loss: 169636624.0000; val_kl_reg_loss: 55274.2656; val_edge_recon_loss: 40651628.0000; val_gene_expr_recon_loss: 27442744.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 104892568.0000; val_global_loss: 173042208.0000; val_optim_loss: 173042208.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8899; val_auprc_score: 0.9037; val_best_acc_score: 0.5022; val_best_f1_score: 0.6676; train_kl_reg_loss: 117723.9156; train_edge_recon_loss: 34879331.5556; train_gene_expr_recon_loss: 27042514.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 104881874.6667; train_global_loss: 166921440.0000; train_optim_loss: 166921440.0000; val_kl_reg_loss: 121807.8906; val_edge_recon_loss: 40655760.0000; val_gene_expr_recon_loss: 26111196.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 103423856.0000; val_global_loss: 170312624.0000; val_optim_loss: 170312624.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8842; val_auprc_score: 0.8981; val_best_acc_score: 0.5036; val_best_f1_score: 0.6682; train_kl_reg_loss: 197578.7283; train_edge_recon_loss: 34843605.3333; train_gene_expr_recon_loss: 25393903.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102068865.7778; train_global_loss: 162503953.7778; train_optim_loss: 162503953.7778; val_kl_reg_loss: 296046.9375; val_edge_recon_loss: 40655720.0000; val_gene_expr_recon_loss: 24665734.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101551064.0000; val_global_loss: 167168576.0000; val_optim_loss: 167168576.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8729; val_auprc_score: 0.8814; val_best_acc_score: 0.5055; val_best_f1_score: 0.6691; train_kl_reg_loss: 329933.9549; train_edge_recon_loss: 34856206.2222; train_gene_expr_recon_loss: 24079997.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100753653.3333; train_global_loss: 160019788.4444; train_optim_loss: 160019788.4444; val_kl_reg_loss: 239357.3750; val_edge_recon_loss: 40653308.0000; val_gene_expr_recon_loss: 23652170.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99950336.0000; val_global_loss: 164495168.0000; val_optim_loss: 164495168.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8614; val_auprc_score: 0.8700; val_best_acc_score: 0.5108; val_best_f1_score: 0.6714; train_kl_reg_loss: 391787.3160; train_edge_recon_loss: 34862240.4444; train_gene_expr_recon_loss: 23294522.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99905352.0000; train_global_loss: 158453902.2222; train_optim_loss: 158453902.2222; val_kl_reg_loss: 321836.3750; val_edge_recon_loss: 40649248.0000; val_gene_expr_recon_loss: 22923320.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99152928.0000; val_global_loss: 163047328.0000; val_optim_loss: 163047328.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8601; val_auprc_score: 0.8667; val_best_acc_score: 0.5171; val_best_f1_score: 0.6741; train_kl_reg_loss: 447832.0278; train_edge_recon_loss: 34886285.3333; train_gene_expr_recon_loss: 22584329.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98833748.4444; train_global_loss: 156752195.5556; train_optim_loss: 156752195.5556; val_kl_reg_loss: 317957.9688; val_edge_recon_loss: 40644084.0000; val_gene_expr_recon_loss: 22323896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98421376.0000; val_global_loss: 161707312.0000; val_optim_loss: 161707312.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8678; val_auprc_score: 0.8739; val_best_acc_score: 0.5226; val_best_f1_score: 0.6766; train_kl_reg_loss: 444941.3611; train_edge_recon_loss: 34934548.0000; train_gene_expr_recon_loss: 22074598.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98423906.6667; train_global_loss: 155877991.1111; train_optim_loss: 155877991.1111; val_kl_reg_loss: 358836.5938; val_edge_recon_loss: 40640768.0000; val_gene_expr_recon_loss: 21894486.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97795016.0000; val_global_loss: 160689104.0000; val_optim_loss: 160689104.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8712; val_auprc_score: 0.8728; val_best_acc_score: 0.5245; val_best_f1_score: 0.6774; train_kl_reg_loss: 456705.7118; train_edge_recon_loss: 34927695.5556; train_gene_expr_recon_loss: 21815167.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98095203.5556; train_global_loss: 155294771.5556; train_optim_loss: 155294771.5556; val_kl_reg_loss: 388876.2500; val_edge_recon_loss: 40639068.0000; val_gene_expr_recon_loss: 21596688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97585264.0000; val_global_loss: 160209888.0000; val_optim_loss: 160209888.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8836; val_auprc_score: 0.8829; val_best_acc_score: 0.5298; val_best_f1_score: 0.6795; train_kl_reg_loss: 483532.3264; train_edge_recon_loss: 34931543.5556; train_gene_expr_recon_loss: 21504769.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97461143.1111; train_global_loss: 154380986.6667; train_optim_loss: 154380986.6667; val_kl_reg_loss: 230201.5312; val_edge_recon_loss: 40632052.0000; val_gene_expr_recon_loss: 21480054.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97386968.0000; val_global_loss: 159729280.0000; val_optim_loss: 159729280.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8924; val_auprc_score: 0.8934; val_best_acc_score: 0.5119; val_best_f1_score: 0.6719; train_kl_reg_loss: 412271.6059; train_edge_recon_loss: 34999659.5556; train_gene_expr_recon_loss: 21310561.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96909362.6667; train_global_loss: 153631857.7778; train_optim_loss: 153631857.7778; val_kl_reg_loss: 406145.2500; val_edge_recon_loss: 40643488.0000; val_gene_expr_recon_loss: 21385066.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97268752.0000; val_global_loss: 159703456.0000; val_optim_loss: 159703456.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8949; val_auprc_score: 0.8974; val_best_acc_score: 0.5236; val_best_f1_score: 0.6770; train_kl_reg_loss: 414059.6875; train_edge_recon_loss: 34923664.4444; train_gene_expr_recon_loss: 21332931.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97379047.1111; train_global_loss: 154049703.1111; train_optim_loss: 154049703.1111; val_kl_reg_loss: 264013.6562; val_edge_recon_loss: 40634672.0000; val_gene_expr_recon_loss: 21337560.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97288480.0000; val_global_loss: 159524720.0000; val_optim_loss: 159524720.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8979; val_auprc_score: 0.8967; val_best_acc_score: 0.5365; val_best_f1_score: 0.6829; train_kl_reg_loss: 411006.1736; train_edge_recon_loss: 34939255.5556; train_gene_expr_recon_loss: 21191428.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97365009.7778; train_global_loss: 153906704.0000; train_optim_loss: 153906704.0000; val_kl_reg_loss: 355422.8750; val_edge_recon_loss: 40628224.0000; val_gene_expr_recon_loss: 21181286.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97017704.0000; val_global_loss: 159182640.0000; val_optim_loss: 159182640.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9022; val_auprc_score: 0.9000; val_best_acc_score: 0.5667; val_best_f1_score: 0.6966; train_kl_reg_loss: 417424.5903; train_edge_recon_loss: 34914787.1111; train_gene_expr_recon_loss: 21114818.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97014768.0000; train_global_loss: 153461795.5556; train_optim_loss: 153461795.5556; val_kl_reg_loss: 359763.8125; val_edge_recon_loss: 40613900.0000; val_gene_expr_recon_loss: 21119730.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96994312.0000; val_global_loss: 159087712.0000; val_optim_loss: 159087712.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9043; val_auprc_score: 0.9001; val_best_acc_score: 0.6043; val_best_f1_score: 0.7145; train_kl_reg_loss: 404070.4410; train_edge_recon_loss: 34906031.1111; train_gene_expr_recon_loss: 20989388.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97507250.6667; train_global_loss: 153806739.5556; train_optim_loss: 153806739.5556; val_kl_reg_loss: 315505.1250; val_edge_recon_loss: 40596584.0000; val_gene_expr_recon_loss: 21036460.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96684504.0000; val_global_loss: 158633056.0000; val_optim_loss: 158633056.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9017; val_auprc_score: 0.8930; val_best_acc_score: 0.6504; val_best_f1_score: 0.7376; train_kl_reg_loss: 391585.9931; train_edge_recon_loss: 34899698.6667; train_gene_expr_recon_loss: 20892994.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96282762.6667; train_global_loss: 152467045.3333; train_optim_loss: 152467045.3333; val_kl_reg_loss: 323625.3125; val_edge_recon_loss: 40571632.0000; val_gene_expr_recon_loss: 20993662.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96610352.0000; val_global_loss: 158499264.0000; val_optim_loss: 158499264.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9118; val_auprc_score: 0.9081; val_best_acc_score: 0.7160; val_best_f1_score: 0.7735; train_kl_reg_loss: 396061.1562; train_edge_recon_loss: 34903606.6667; train_gene_expr_recon_loss: 20908866.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96295330.6667; train_global_loss: 152503861.3333; train_optim_loss: 152503861.3333; val_kl_reg_loss: 287799.0625; val_edge_recon_loss: 40525072.0000; val_gene_expr_recon_loss: 20964560.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96560136.0000; val_global_loss: 158337568.0000; val_optim_loss: 158337568.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9092; val_auprc_score: 0.9034; val_best_acc_score: 0.7608; val_best_f1_score: 0.8002; train_kl_reg_loss: 370931.9688; train_edge_recon_loss: 34905752.8889; train_gene_expr_recon_loss: 20930969.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96806757.3333; train_global_loss: 153014414.2222; train_optim_loss: 153014414.2222; val_kl_reg_loss: 284062.4062; val_edge_recon_loss: 40468456.0000; val_gene_expr_recon_loss: 20922460.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96477320.0000; val_global_loss: 158152304.0000; val_optim_loss: 158152304.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9072; val_auprc_score: 0.9004; val_best_acc_score: 0.8003; val_best_f1_score: 0.8240; train_kl_reg_loss: 376173.2951; train_edge_recon_loss: 34876910.6667; train_gene_expr_recon_loss: 20786162.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96273376.8889; train_global_loss: 152312624.0000; train_optim_loss: 152312624.0000; val_kl_reg_loss: 314756.2812; val_edge_recon_loss: 40399836.0000; val_gene_expr_recon_loss: 20896028.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96500736.0000; val_global_loss: 158111360.0000; val_optim_loss: 158111360.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9075; val_auprc_score: 0.8994; val_best_acc_score: 0.8277; val_best_f1_score: 0.8387; train_kl_reg_loss: 357672.1562; train_edge_recon_loss: 34859217.7778; train_gene_expr_recon_loss: 20809083.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96258064.8889; train_global_loss: 152284037.3333; train_optim_loss: 152284037.3333; val_kl_reg_loss: 305752.6250; val_edge_recon_loss: 40271996.0000; val_gene_expr_recon_loss: 20869612.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96375928.0000; val_global_loss: 157823296.0000; val_optim_loss: 157823296.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9135; val_auprc_score: 0.9099; val_best_acc_score: 0.8383; val_best_f1_score: 0.8390; train_kl_reg_loss: 360667.3403; train_edge_recon_loss: 34833571.1111; train_gene_expr_recon_loss: 20685479.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96159912.8889; train_global_loss: 152039632.0000; train_optim_loss: 152039632.0000; val_kl_reg_loss: 280755.5625; val_edge_recon_loss: 40101416.0000; val_gene_expr_recon_loss: 20843478.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96293792.0000; val_global_loss: 157519440.0000; val_optim_loss: 157519440.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9114; val_auprc_score: 0.9042; val_best_acc_score: 0.8271; val_best_f1_score: 0.8174; train_kl_reg_loss: 342643.6354; train_edge_recon_loss: 34784984.0000; train_gene_expr_recon_loss: 20696581.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95720132.4444; train_global_loss: 151544337.7778; train_optim_loss: 151544337.7778; val_kl_reg_loss: 308351.0000; val_edge_recon_loss: 39824356.0000; val_gene_expr_recon_loss: 20805106.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96157920.0000; val_global_loss: 157095744.0000; val_optim_loss: 157095744.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9103; val_auprc_score: 0.8998; val_best_acc_score: 0.7951; val_best_f1_score: 0.8174; train_kl_reg_loss: 340480.5139; train_edge_recon_loss: 34687511.1111; train_gene_expr_recon_loss: 20779803.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96308535.1111; train_global_loss: 152116332.4444; train_optim_loss: 152116332.4444; val_kl_reg_loss: 295436.9688; val_edge_recon_loss: 39372316.0000; val_gene_expr_recon_loss: 20782688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96116360.0000; val_global_loss: 156566800.0000; val_optim_loss: 156566800.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9114; val_auprc_score: 0.8979; val_best_acc_score: 0.8262; val_best_f1_score: 0.8412; train_kl_reg_loss: 334044.9444; train_edge_recon_loss: 34580231.5556; train_gene_expr_recon_loss: 20764140.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96578919.1111; train_global_loss: 152257336.8889; train_optim_loss: 152257336.8889; val_kl_reg_loss: 263156.5000; val_edge_recon_loss: 38699780.0000; val_gene_expr_recon_loss: 20797380.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96122712.0000; val_global_loss: 155883024.0000; val_optim_loss: 155883024.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9139; val_auprc_score: 0.8976; val_best_acc_score: 0.8378; val_best_f1_score: 0.8447; train_kl_reg_loss: 287276.9392; train_edge_recon_loss: 34354635.1111; train_gene_expr_recon_loss: 20577893.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95985984.0000; train_global_loss: 151205790.2222; train_optim_loss: 151205790.2222; val_kl_reg_loss: 251571.5938; val_edge_recon_loss: 37437080.0000; val_gene_expr_recon_loss: 20787818.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96179160.0000; val_global_loss: 154655632.0000; val_optim_loss: 154655632.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9154; val_auprc_score: 0.9028; val_best_acc_score: 0.8329; val_best_f1_score: 0.8418; train_kl_reg_loss: 253217.8572; train_edge_recon_loss: 36386502.6667; train_gene_expr_recon_loss: 21634308.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96733519.1111; train_global_loss: 155007548.4444; train_optim_loss: 155007548.4444; val_kl_reg_loss: 31017.1191; val_edge_recon_loss: 36953612.0000; val_gene_expr_recon_loss: 21849930.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97205416.0000; val_global_loss: 156039968.0000; val_optim_loss: 156039968.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9158; val_auprc_score: 0.9005; val_best_acc_score: 0.8390; val_best_f1_score: 0.8467; train_kl_reg_loss: 74868.4891; train_edge_recon_loss: 35283896.0000; train_gene_expr_recon_loss: 21647119.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97103177.7778; train_global_loss: 154109064.8889; train_optim_loss: 154109064.8889; val_kl_reg_loss: 62930.5547; val_edge_recon_loss: 35924684.0000; val_gene_expr_recon_loss: 21493492.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96949712.0000; val_global_loss: 154430816.0000; val_optim_loss: 154430816.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9121; val_auprc_score: 0.8925; val_best_acc_score: 0.8364; val_best_f1_score: 0.8440; train_kl_reg_loss: 116438.1736; train_edge_recon_loss: 34371014.6667; train_gene_expr_recon_loss: 21415482.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96937603.5556; train_global_loss: 152840540.4444; train_optim_loss: 152840540.4444; val_kl_reg_loss: 71067.5625; val_edge_recon_loss: 35140856.0000; val_gene_expr_recon_loss: 21441126.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96394272.0000; val_global_loss: 153047328.0000; val_optim_loss: 153047328.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9131; val_auprc_score: 0.8979; val_best_acc_score: 0.8389; val_best_f1_score: 0.8436; train_kl_reg_loss: 118123.0009; train_edge_recon_loss: 33473976.2222; train_gene_expr_recon_loss: 21511645.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97358779.5556; train_global_loss: 152462520.8889; train_optim_loss: 152462520.8889; val_kl_reg_loss: 96435.3125; val_edge_recon_loss: 33418832.0000; val_gene_expr_recon_loss: 21352236.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96501072.0000; val_global_loss: 151368576.0000; val_optim_loss: 151368576.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9023; val_auprc_score: 0.8839; val_best_acc_score: 0.8251; val_best_f1_score: 0.8310; train_kl_reg_loss: 118937.8663; train_edge_recon_loss: 32244986.4444; train_gene_expr_recon_loss: 21334751.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96435656.8889; train_global_loss: 150134334.2222; train_optim_loss: 150134334.2222; val_kl_reg_loss: 78413.8906; val_edge_recon_loss: 31704432.0000; val_gene_expr_recon_loss: 21406432.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96485616.0000; val_global_loss: 149674896.0000; val_optim_loss: 149674896.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8948; val_auprc_score: 0.8756; val_best_acc_score: 0.8157; val_best_f1_score: 0.8253; train_kl_reg_loss: 112102.3715; train_edge_recon_loss: 31173256.2222; train_gene_expr_recon_loss: 21355790.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96434468.4444; train_global_loss: 149075617.7778; train_optim_loss: 149075617.7778; val_kl_reg_loss: 70778.5938; val_edge_recon_loss: 30956090.0000; val_gene_expr_recon_loss: 21339306.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96223880.0000; val_global_loss: 148590048.0000; val_optim_loss: 148590048.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8958; val_auprc_score: 0.8748; val_best_acc_score: 0.8162; val_best_f1_score: 0.8280; train_kl_reg_loss: 122420.7986; train_edge_recon_loss: 30403986.8889; train_gene_expr_recon_loss: 21299726.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96767364.4444; train_global_loss: 148593496.8889; train_optim_loss: 148593496.8889; val_kl_reg_loss: 79284.8281; val_edge_recon_loss: 30046868.0000; val_gene_expr_recon_loss: 21212950.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95996632.0000; val_global_loss: 147335744.0000; val_optim_loss: 147335744.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8886; val_auprc_score: 0.8658; val_best_acc_score: 0.8080; val_best_f1_score: 0.8223; train_kl_reg_loss: 144231.6979; train_edge_recon_loss: 29965864.4444; train_gene_expr_recon_loss: 21108548.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96284979.5556; train_global_loss: 147503626.6667; train_optim_loss: 147503626.6667; val_kl_reg_loss: 92552.3438; val_edge_recon_loss: 30229142.0000; val_gene_expr_recon_loss: 21127154.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95944376.0000; val_global_loss: 147393216.0000; val_optim_loss: 147393216.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8942; val_auprc_score: 0.8757; val_best_acc_score: 0.8115; val_best_f1_score: 0.8260; train_kl_reg_loss: 168654.4080; train_edge_recon_loss: 29553359.7778; train_gene_expr_recon_loss: 21006312.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96100821.3333; train_global_loss: 146829144.8889; train_optim_loss: 146829144.8889; val_kl_reg_loss: 108275.9766; val_edge_recon_loss: 29633710.0000; val_gene_expr_recon_loss: 21073912.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95931752.0000; val_global_loss: 146747648.0000; val_optim_loss: 146747648.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8998; val_auprc_score: 0.8824; val_best_acc_score: 0.8172; val_best_f1_score: 0.8312; train_kl_reg_loss: 193443.8438; train_edge_recon_loss: 29424817.3333; train_gene_expr_recon_loss: 20792313.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95482796.4444; train_global_loss: 145893370.6667; train_optim_loss: 145893370.6667; val_kl_reg_loss: 124634.6797; val_edge_recon_loss: 29043418.0000; val_gene_expr_recon_loss: 21004194.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95686040.0000; val_global_loss: 145858288.0000; val_optim_loss: 145858288.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.8897; val_auprc_score: 0.8667; val_best_acc_score: 0.8049; val_best_f1_score: 0.8214; train_kl_reg_loss: 216303.7708; train_edge_recon_loss: 29300152.6667; train_gene_expr_recon_loss: 20886488.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95804739.5556; train_global_loss: 146207685.3333; train_optim_loss: 146207685.3333; val_kl_reg_loss: 132519.5312; val_edge_recon_loss: 29440552.0000; val_gene_expr_recon_loss: 20950358.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95572208.0000; val_global_loss: 146095648.0000; val_optim_loss: 146095648.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8991; val_auprc_score: 0.8793; val_best_acc_score: 0.8145; val_best_f1_score: 0.8285; train_kl_reg_loss: 232029.5486; train_edge_recon_loss: 29275401.1111; train_gene_expr_recon_loss: 20817173.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95138093.3333; train_global_loss: 145462696.8889; train_optim_loss: 145462696.8889; val_kl_reg_loss: 132256.4844; val_edge_recon_loss: 29025892.0000; val_gene_expr_recon_loss: 20960256.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95733968.0000; val_global_loss: 145852368.0000; val_optim_loss: 145852368.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9004; val_auprc_score: 0.8822; val_best_acc_score: 0.8146; val_best_f1_score: 0.8287; train_kl_reg_loss: 245170.7083; train_edge_recon_loss: 28873726.4444; train_gene_expr_recon_loss: 20954750.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96065239.1111; train_global_loss: 146138888.8889; train_optim_loss: 146138888.8889; val_kl_reg_loss: 135294.6875; val_edge_recon_loss: 29053500.0000; val_gene_expr_recon_loss: 20925790.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95586592.0000; val_global_loss: 145701184.0000; val_optim_loss: 145701184.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9008; val_auprc_score: 0.8827; val_best_acc_score: 0.8154; val_best_f1_score: 0.8288; train_kl_reg_loss: 256957.3351; train_edge_recon_loss: 28919312.2222; train_gene_expr_recon_loss: 20842556.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95596703.1111; train_global_loss: 145615532.4444; train_optim_loss: 145615532.4444; val_kl_reg_loss: 138246.8281; val_edge_recon_loss: 29078934.0000; val_gene_expr_recon_loss: 20905396.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95388944.0000; val_global_loss: 145511520.0000; val_optim_loss: 145511520.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.8897; val_auprc_score: 0.8627; val_best_acc_score: 0.8096; val_best_f1_score: 0.8284; train_kl_reg_loss: 271661.0799; train_edge_recon_loss: 28989585.3333; train_gene_expr_recon_loss: 20995989.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96067811.5556; train_global_loss: 146325050.6667; train_optim_loss: 146325050.6667; val_kl_reg_loss: 143796.9844; val_edge_recon_loss: 28994408.0000; val_gene_expr_recon_loss: 20962512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95373304.0000; val_global_loss: 145474016.0000; val_optim_loss: 145474016.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9063; val_auprc_score: 0.8855; val_best_acc_score: 0.8238; val_best_f1_score: 0.8357; train_kl_reg_loss: 278796.4826; train_edge_recon_loss: 28790450.8889; train_gene_expr_recon_loss: 20781120.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95145071.1111; train_global_loss: 144995441.7778; train_optim_loss: 144995441.7778; val_kl_reg_loss: 144227.1250; val_edge_recon_loss: 28482658.0000; val_gene_expr_recon_loss: 21021656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95363024.0000; val_global_loss: 145011568.0000; val_optim_loss: 145011568.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9023; val_auprc_score: 0.8779; val_best_acc_score: 0.8292; val_best_f1_score: 0.8381; train_kl_reg_loss: 279934.5208; train_edge_recon_loss: 28726014.8889; train_gene_expr_recon_loss: 20932639.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96119401.7778; train_global_loss: 146057989.3333; train_optim_loss: 146057989.3333; val_kl_reg_loss: 145730.9062; val_edge_recon_loss: 28833040.0000; val_gene_expr_recon_loss: 20893258.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95277048.0000; val_global_loss: 145149072.0000; val_optim_loss: 145149072.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.8987; val_auprc_score: 0.8757; val_best_acc_score: 0.8209; val_best_f1_score: 0.8353; train_kl_reg_loss: 281078.5278; train_edge_recon_loss: 28654258.0000; train_gene_expr_recon_loss: 20808975.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95375121.7778; train_global_loss: 145119436.4444; train_optim_loss: 145119436.4444; val_kl_reg_loss: 148765.5312; val_edge_recon_loss: 28420770.0000; val_gene_expr_recon_loss: 20824406.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95159120.0000; val_global_loss: 144553056.0000; val_optim_loss: 144553056.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9020; val_auprc_score: 0.8794; val_best_acc_score: 0.8196; val_best_f1_score: 0.8367; train_kl_reg_loss: 289307.0312; train_edge_recon_loss: 28524426.8889; train_gene_expr_recon_loss: 20824323.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95496736.0000; train_global_loss: 145134798.2222; train_optim_loss: 145134798.2222; val_kl_reg_loss: 152982.5625; val_edge_recon_loss: 28562946.0000; val_gene_expr_recon_loss: 20981564.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95265400.0000; val_global_loss: 144962896.0000; val_optim_loss: 144962896.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.8922; val_auprc_score: 0.8661; val_best_acc_score: 0.8184; val_best_f1_score: 0.8308; train_kl_reg_loss: 293406.0451; train_edge_recon_loss: 28465819.3333; train_gene_expr_recon_loss: 20774649.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95138255.1111; train_global_loss: 144672129.7778; train_optim_loss: 144672129.7778; val_kl_reg_loss: 142483.0625; val_edge_recon_loss: 28717866.0000; val_gene_expr_recon_loss: 20842582.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95304752.0000; val_global_loss: 145007680.0000; val_optim_loss: 145007680.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9039; val_auprc_score: 0.8792; val_best_acc_score: 0.8279; val_best_f1_score: 0.8410; train_kl_reg_loss: 258819.0833; train_edge_recon_loss: 28606344.8889; train_gene_expr_recon_loss: 21053555.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95172376.8889; train_global_loss: 145091095.1111; train_optim_loss: 145091095.1111; val_kl_reg_loss: 106277.2656; val_edge_recon_loss: 28770838.0000; val_gene_expr_recon_loss: 20881398.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95081472.0000; val_global_loss: 144839984.0000; val_optim_loss: 144839984.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.8986; val_auprc_score: 0.8755; val_best_acc_score: 0.8234; val_best_f1_score: 0.8365; train_kl_reg_loss: 189719.4826; train_edge_recon_loss: 28800868.8889; train_gene_expr_recon_loss: 20731200.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94866000.0000; train_global_loss: 144587790.2222; train_optim_loss: 144587790.2222; val_kl_reg_loss: 93609.2422; val_edge_recon_loss: 29009112.0000; val_gene_expr_recon_loss: 20847988.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95056168.0000; val_global_loss: 145006880.0000; val_optim_loss: 145006880.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9019; val_auprc_score: 0.8778; val_best_acc_score: 0.8273; val_best_f1_score: 0.8400; train_kl_reg_loss: 182414.0417; train_edge_recon_loss: 28642010.2222; train_gene_expr_recon_loss: 20695654.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95163726.2222; train_global_loss: 144683808.0000; train_optim_loss: 144683808.0000; val_kl_reg_loss: 95565.7656; val_edge_recon_loss: 29023456.0000; val_gene_expr_recon_loss: 20778056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94846744.0000; val_global_loss: 144743824.0000; val_optim_loss: 144743824.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9025; val_auprc_score: 0.8783; val_best_acc_score: 0.8271; val_best_f1_score: 0.8396; train_kl_reg_loss: 188495.8646; train_edge_recon_loss: 28706821.3333; train_gene_expr_recon_loss: 20617418.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94979630.2222; train_global_loss: 144492364.4444; train_optim_loss: 144492364.4444; val_kl_reg_loss: 98837.9688; val_edge_recon_loss: 28868172.0000; val_gene_expr_recon_loss: 20778730.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94947728.0000; val_global_loss: 144693472.0000; val_optim_loss: 144693472.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9010; val_auprc_score: 0.8711; val_best_acc_score: 0.8275; val_best_f1_score: 0.8427; train_kl_reg_loss: 192899.8750; train_edge_recon_loss: 28619118.0000; train_gene_expr_recon_loss: 20645280.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94921895.1111; train_global_loss: 144379189.3333; train_optim_loss: 144379189.3333; val_kl_reg_loss: 99717.8750; val_edge_recon_loss: 28640622.0000; val_gene_expr_recon_loss: 20810256.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94914664.0000; val_global_loss: 144465264.0000; val_optim_loss: 144465264.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9066; val_auprc_score: 0.8815; val_best_acc_score: 0.8321; val_best_f1_score: 0.8440; train_kl_reg_loss: 198404.2049; train_edge_recon_loss: 28584529.7778; train_gene_expr_recon_loss: 20787447.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95262418.6667; train_global_loss: 144832798.2222; train_optim_loss: 144832798.2222; val_kl_reg_loss: 103354.5000; val_edge_recon_loss: 28656446.0000; val_gene_expr_recon_loss: 20792446.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95042632.0000; val_global_loss: 144594880.0000; val_optim_loss: 144594880.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9081; val_auprc_score: 0.8820; val_best_acc_score: 0.8321; val_best_f1_score: 0.8458; train_kl_reg_loss: 201817.3368; train_edge_recon_loss: 28560718.2222; train_gene_expr_recon_loss: 20744013.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95029278.2222; train_global_loss: 144535829.3333; train_optim_loss: 144535829.3333; val_kl_reg_loss: 105845.3516; val_edge_recon_loss: 28468734.0000; val_gene_expr_recon_loss: 20782210.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94827040.0000; val_global_loss: 144183840.0000; val_optim_loss: 144183840.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9048; val_auprc_score: 0.8788; val_best_acc_score: 0.8297; val_best_f1_score: 0.8437; train_kl_reg_loss: 206222.0538; train_edge_recon_loss: 28500836.2222; train_gene_expr_recon_loss: 20632836.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95073463.1111; train_global_loss: 144413360.0000; train_optim_loss: 144413360.0000; val_kl_reg_loss: 108339.0156; val_edge_recon_loss: 28634468.0000; val_gene_expr_recon_loss: 20775506.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94894976.0000; val_global_loss: 144413280.0000; val_optim_loss: 144413280.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9065; val_auprc_score: 0.8878; val_best_acc_score: 0.8263; val_best_f1_score: 0.8409; train_kl_reg_loss: 209423.0278; train_edge_recon_loss: 28518886.6667; train_gene_expr_recon_loss: 20586616.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94839168.8889; train_global_loss: 144154096.0000; train_optim_loss: 144154096.0000; val_kl_reg_loss: 110458.6875; val_edge_recon_loss: 28589544.0000; val_gene_expr_recon_loss: 20764606.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94846472.0000; val_global_loss: 144311072.0000; val_optim_loss: 144311072.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9073; val_auprc_score: 0.8832; val_best_acc_score: 0.8327; val_best_f1_score: 0.8433; train_kl_reg_loss: 214037.0816; train_edge_recon_loss: 28474434.0000; train_gene_expr_recon_loss: 20509301.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94497259.5556; train_global_loss: 143695031.1111; train_optim_loss: 143695031.1111; val_kl_reg_loss: 111189.7812; val_edge_recon_loss: 28527092.0000; val_gene_expr_recon_loss: 20774414.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94832848.0000; val_global_loss: 144245536.0000; val_optim_loss: 144245536.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9069; val_auprc_score: 0.8794; val_best_acc_score: 0.8317; val_best_f1_score: 0.8450; train_kl_reg_loss: 217275.2535; train_edge_recon_loss: 28511361.3333; train_gene_expr_recon_loss: 20613558.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94999307.5556; train_global_loss: 144341500.4444; train_optim_loss: 144341500.4444; val_kl_reg_loss: 112598.3438; val_edge_recon_loss: 28336522.0000; val_gene_expr_recon_loss: 20773084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94738536.0000; val_global_loss: 143960736.0000; val_optim_loss: 143960736.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9052; val_auprc_score: 0.8807; val_best_acc_score: 0.8277; val_best_f1_score: 0.8430; train_kl_reg_loss: 221577.1615; train_edge_recon_loss: 28470678.6667; train_gene_expr_recon_loss: 20617540.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94680542.2222; train_global_loss: 143990336.0000; train_optim_loss: 143990336.0000; val_kl_reg_loss: 115386.1094; val_edge_recon_loss: 28575808.0000; val_gene_expr_recon_loss: 20758280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94886072.0000; val_global_loss: 144335552.0000; val_optim_loss: 144335552.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9017; val_auprc_score: 0.8725; val_best_acc_score: 0.8271; val_best_f1_score: 0.8410; train_kl_reg_loss: 225245.4392; train_edge_recon_loss: 28432096.0000; train_gene_expr_recon_loss: 20693750.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95227187.5556; train_global_loss: 144578279.1111; train_optim_loss: 144578279.1111; val_kl_reg_loss: 116459.4688; val_edge_recon_loss: 28542214.0000; val_gene_expr_recon_loss: 20736206.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94814760.0000; val_global_loss: 144209632.0000; val_optim_loss: 144209632.0000
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9016; val_auprc_score: 0.8754; val_best_acc_score: 0.8271; val_best_f1_score: 0.8407; train_kl_reg_loss: 228966.6024; train_edge_recon_loss: 28394754.6667; train_gene_expr_recon_loss: 20751260.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95191563.5556; train_global_loss: 144566545.7778; train_optim_loss: 144566545.7778; val_kl_reg_loss: 118371.1719; val_edge_recon_loss: 28659940.0000; val_gene_expr_recon_loss: 20724948.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94725976.0000; val_global_loss: 144229232.0000; val_optim_loss: 144229232.0000
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9045; val_auprc_score: 0.8771; val_best_acc_score: 0.8354; val_best_f1_score: 0.8454; train_kl_reg_loss: 230478.3229; train_edge_recon_loss: 28413489.3333; train_gene_expr_recon_loss: 20645680.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95201480.8889; train_global_loss: 144491130.6667; train_optim_loss: 144491130.6667; val_kl_reg_loss: 120969.0156; val_edge_recon_loss: 28496752.0000; val_gene_expr_recon_loss: 20761262.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94885480.0000; val_global_loss: 144264464.0000; val_optim_loss: 144264464.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9054; val_auprc_score: 0.8869; val_best_acc_score: 0.8263; val_best_f1_score: 0.8377; train_kl_reg_loss: 232280.5000; train_edge_recon_loss: 28483997.1111; train_gene_expr_recon_loss: 20575494.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94855379.5556; train_global_loss: 144147150.2222; train_optim_loss: 144147150.2222; val_kl_reg_loss: 120211.9844; val_edge_recon_loss: 28802332.0000; val_gene_expr_recon_loss: 20753452.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94818536.0000; val_global_loss: 144494528.0000; val_optim_loss: 144494528.0000
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9078; val_auprc_score: 0.8844; val_best_acc_score: 0.8324; val_best_f1_score: 0.8431; train_kl_reg_loss: 232163.5955; train_edge_recon_loss: 28493575.7778; train_gene_expr_recon_loss: 20617159.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94853060.4444; train_global_loss: 144195955.5556; train_optim_loss: 144195955.5556; val_kl_reg_loss: 120244.5312; val_edge_recon_loss: 28464902.0000; val_gene_expr_recon_loss: 20745460.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94860824.0000; val_global_loss: 144191424.0000; val_optim_loss: 144191424.0000
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9048; val_auprc_score: 0.8787; val_best_acc_score: 0.8308; val_best_f1_score: 0.8415; train_kl_reg_loss: 232323.6181; train_edge_recon_loss: 28368828.8889; train_gene_expr_recon_loss: 20619976.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94786784.0000; train_global_loss: 144007912.8889; train_optim_loss: 144007912.8889; val_kl_reg_loss: 121042.5859; val_edge_recon_loss: 28673780.0000; val_gene_expr_recon_loss: 20744130.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94816360.0000; val_global_loss: 144355312.0000; val_optim_loss: 144355312.0000
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9050; val_auprc_score: 0.8813; val_best_acc_score: 0.8302; val_best_f1_score: 0.8425; train_kl_reg_loss: 232732.5503; train_edge_recon_loss: 28496879.3333; train_gene_expr_recon_loss: 20751436.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95002939.5556; train_global_loss: 144483992.8889; train_optim_loss: 144483992.8889; val_kl_reg_loss: 120701.3125; val_edge_recon_loss: 28606560.0000; val_gene_expr_recon_loss: 20737196.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 94816120.0000; val_global_loss: 144280576.0000; val_optim_loss: 144280576.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 37 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
Val AUROC score: 0.9071
Val AUPRC score: 0.8801
Val best accuracy score: 0.8367
Val best F1 score: 0.8466
Val gene expr MSE score: 0.5205
Val chrom access MSE score: 0.0866
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
