[True]
Run timestamp: 10102023_054459_161.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_161']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7738; val_auprc_score: 0.7922; val_best_acc_score: 0.5500; val_best_f1_score: 0.6866; train_kl_reg_loss: 65416.3793; train_edge_recon_loss: 745590.2591; train_gene_expr_recon_loss: 22209708.4427; train_masked_gp_l1_reg_loss: 41997.6507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2983005.3244; train_chrom_access_recon_loss: 956110.9785; train_global_loss: 27001829.0229; train_optim_loss: 27001829.0229; val_kl_reg_loss: 76433.1906; val_edge_recon_loss: 812436.1750; val_gene_expr_recon_loss: 20989832.0000; val_masked_gp_l1_reg_loss: 45811.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1184347.2500; val_chrom_access_recon_loss: 932681.6792; val_global_loss: 24041542.9333; val_optim_loss: 24041542.9333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8450; val_auprc_score: 0.8495; val_best_acc_score: 0.7573; val_best_f1_score: 0.7379; train_kl_reg_loss: 68968.3296; train_edge_recon_loss: 730747.9079; train_gene_expr_recon_loss: 20855187.2977; train_masked_gp_l1_reg_loss: 46848.2753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 637429.3469; train_chrom_access_recon_loss: 921752.4871; train_global_loss: 23260933.6947; train_optim_loss: 23260933.6947; val_kl_reg_loss: 64348.9865; val_edge_recon_loss: 795090.0333; val_gene_expr_recon_loss: 20709774.5333; val_masked_gp_l1_reg_loss: 48318.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 346100.0938; val_chrom_access_recon_loss: 924237.9250; val_global_loss: 22887869.7333; val_optim_loss: 22887869.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9043; val_auprc_score: 0.8954; val_best_acc_score: 0.8201; val_best_f1_score: 0.8319; train_kl_reg_loss: 62652.7648; train_edge_recon_loss: 691525.6412; train_gene_expr_recon_loss: 20529458.0611; train_masked_gp_l1_reg_loss: 50291.3093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 263403.7600; train_chrom_access_recon_loss: 910999.4785; train_global_loss: 22508331.0076; train_optim_loss: 22508331.0076; val_kl_reg_loss: 68457.8385; val_edge_recon_loss: 648492.8958; val_gene_expr_recon_loss: 20390236.1333; val_masked_gp_l1_reg_loss: 52277.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 207539.1719; val_chrom_access_recon_loss: 910889.5375; val_global_loss: 22277894.5333; val_optim_loss: 22277894.5333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9197; val_auprc_score: 0.9099; val_best_acc_score: 0.8402; val_best_f1_score: 0.8469; train_kl_reg_loss: 70446.1253; train_edge_recon_loss: 625709.3349; train_gene_expr_recon_loss: 20251723.0229; train_masked_gp_l1_reg_loss: 54182.5860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 175033.6196; train_chrom_access_recon_loss: 901025.3559; train_global_loss: 22078120.2137; train_optim_loss: 22078120.2137; val_kl_reg_loss: 67251.6182; val_edge_recon_loss: 619714.7500; val_gene_expr_recon_loss: 20189844.0000; val_masked_gp_l1_reg_loss: 55868.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151004.8281; val_chrom_access_recon_loss: 909778.3375; val_global_loss: 21993460.6667; val_optim_loss: 21993460.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9281; val_auprc_score: 0.9174; val_best_acc_score: 0.8519; val_best_f1_score: 0.8616; train_kl_reg_loss: 67669.3463; train_edge_recon_loss: 611352.0553; train_gene_expr_recon_loss: 20099542.7786; train_masked_gp_l1_reg_loss: 57273.0143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135546.2461; train_chrom_access_recon_loss: 894227.8158; train_global_loss: 21865611.1145; train_optim_loss: 21865611.1145; val_kl_reg_loss: 65058.1664; val_edge_recon_loss: 608956.8125; val_gene_expr_recon_loss: 20038649.6000; val_masked_gp_l1_reg_loss: 58660.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124438.4062; val_chrom_access_recon_loss: 896639.4125; val_global_loss: 21792401.8667; val_optim_loss: 21792401.8667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9402; val_auprc_score: 0.9325; val_best_acc_score: 0.8663; val_best_f1_score: 0.8723; train_kl_reg_loss: 64880.0228; train_edge_recon_loss: 604010.8316; train_gene_expr_recon_loss: 19928188.7634; train_masked_gp_l1_reg_loss: 59731.8409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115267.9704; train_chrom_access_recon_loss: 886278.2424; train_global_loss: 21658357.7252; train_optim_loss: 21658357.7252; val_kl_reg_loss: 64218.8419; val_edge_recon_loss: 599596.6667; val_gene_expr_recon_loss: 19839879.6000; val_masked_gp_l1_reg_loss: 60709.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110081.2500; val_chrom_access_recon_loss: 888405.5792; val_global_loss: 21562892.6667; val_optim_loss: 21562892.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9474; val_auprc_score: 0.9378; val_best_acc_score: 0.8782; val_best_f1_score: 0.8831; train_kl_reg_loss: 63611.3076; train_edge_recon_loss: 595295.5677; train_gene_expr_recon_loss: 19803241.2214; train_masked_gp_l1_reg_loss: 61524.1581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104277.0463; train_chrom_access_recon_loss: 881760.1670; train_global_loss: 21509709.4809; train_optim_loss: 21509709.4809; val_kl_reg_loss: 60845.9661; val_edge_recon_loss: 595774.0417; val_gene_expr_recon_loss: 19741994.5333; val_masked_gp_l1_reg_loss: 62386.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100739.5938; val_chrom_access_recon_loss: 882758.9542; val_global_loss: 21444499.8667; val_optim_loss: 21444499.8667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9529; val_auprc_score: 0.9452; val_best_acc_score: 0.8876; val_best_f1_score: 0.8908; train_kl_reg_loss: 61304.5164; train_edge_recon_loss: 592511.2004; train_gene_expr_recon_loss: 19681393.4809; train_masked_gp_l1_reg_loss: 63013.4271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98005.3290; train_chrom_access_recon_loss: 875583.3325; train_global_loss: 21371811.1908; train_optim_loss: 21371811.1908; val_kl_reg_loss: 58989.8443; val_edge_recon_loss: 589733.9292; val_gene_expr_recon_loss: 19651289.7333; val_masked_gp_l1_reg_loss: 63723.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96623.5625; val_chrom_access_recon_loss: 881022.3167; val_global_loss: 21341383.8667; val_optim_loss: 21341383.8667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9575; val_auprc_score: 0.9474; val_best_acc_score: 0.8975; val_best_f1_score: 0.9006; train_kl_reg_loss: 60062.0119; train_edge_recon_loss: 588383.9585; train_gene_expr_recon_loss: 19563896.0611; train_masked_gp_l1_reg_loss: 64348.5625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94302.3333; train_chrom_access_recon_loss: 870066.6031; train_global_loss: 21241059.5573; train_optim_loss: 21241059.5573; val_kl_reg_loss: 58863.3818; val_edge_recon_loss: 585214.6625; val_gene_expr_recon_loss: 19422905.2000; val_masked_gp_l1_reg_loss: 64967.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92725.7656; val_chrom_access_recon_loss: 871985.0000; val_global_loss: 21096662.4000; val_optim_loss: 21096662.4000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9472; val_auprc_score: 0.9341; val_best_acc_score: 0.8790; val_best_f1_score: 0.8836; train_kl_reg_loss: 57326.9783; train_edge_recon_loss: 591028.6393; train_gene_expr_recon_loss: 19526743.2824; train_masked_gp_l1_reg_loss: 65462.3738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92260.0228; train_chrom_access_recon_loss: 868739.0339; train_global_loss: 21201560.4885; train_optim_loss: 21201560.4885; val_kl_reg_loss: 57282.4893; val_edge_recon_loss: 596087.8417; val_gene_expr_recon_loss: 19490865.0667; val_masked_gp_l1_reg_loss: 65481.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93179.5703; val_chrom_access_recon_loss: 878411.4792; val_global_loss: 21181308.6667; val_optim_loss: 21181308.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9613; val_auprc_score: 0.9549; val_best_acc_score: 0.8992; val_best_f1_score: 0.9017; train_kl_reg_loss: 60366.2523; train_edge_recon_loss: 586293.9656; train_gene_expr_recon_loss: 19406389.1756; train_masked_gp_l1_reg_loss: 65215.3351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87510.7153; train_chrom_access_recon_loss: 862669.8802; train_global_loss: 21068445.1756; train_optim_loss: 21068445.1756; val_kl_reg_loss: 62875.8495; val_edge_recon_loss: 584300.5500; val_gene_expr_recon_loss: 19356986.4000; val_masked_gp_l1_reg_loss: 65437.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86352.2266; val_chrom_access_recon_loss: 866771.7458; val_global_loss: 21022724.9333; val_optim_loss: 21022724.9333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9584; val_auprc_score: 0.9479; val_best_acc_score: 0.9010; val_best_f1_score: 0.9038; train_kl_reg_loss: 59109.9624; train_edge_recon_loss: 583363.4060; train_gene_expr_recon_loss: 19304232.3206; train_masked_gp_l1_reg_loss: 66026.9649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85921.3025; train_chrom_access_recon_loss: 857803.1803; train_global_loss: 20956457.0687; train_optim_loss: 20956457.0687; val_kl_reg_loss: 58835.6383; val_edge_recon_loss: 583865.2208; val_gene_expr_recon_loss: 19210901.8667; val_masked_gp_l1_reg_loss: 66413.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85981.2812; val_chrom_access_recon_loss: 858710.4667; val_global_loss: 20864709.4667; val_optim_loss: 20864709.4667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9597; val_auprc_score: 0.9506; val_best_acc_score: 0.9008; val_best_f1_score: 0.9043; train_kl_reg_loss: 57410.2858; train_edge_recon_loss: 581487.6236; train_gene_expr_recon_loss: 19246934.7786; train_masked_gp_l1_reg_loss: 66928.5822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85155.7688; train_chrom_access_recon_loss: 854555.2462; train_global_loss: 20892472.3664; train_optim_loss: 20892472.3664; val_kl_reg_loss: 57577.5435; val_edge_recon_loss: 581111.4583; val_gene_expr_recon_loss: 19132214.2667; val_masked_gp_l1_reg_loss: 67494.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86643.5156; val_chrom_access_recon_loss: 856813.7333; val_global_loss: 20781855.0667; val_optim_loss: 20781855.0667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9636; val_auprc_score: 0.9513; val_best_acc_score: 0.9096; val_best_f1_score: 0.9122; train_kl_reg_loss: 56093.6919; train_edge_recon_loss: 579653.7066; train_gene_expr_recon_loss: 19166245.2824; train_masked_gp_l1_reg_loss: 67823.0495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84513.6999; train_chrom_access_recon_loss: 851151.8001; train_global_loss: 20805481.2824; train_optim_loss: 20805481.2824; val_kl_reg_loss: 55588.7156; val_edge_recon_loss: 578734.7250; val_gene_expr_recon_loss: 19222428.5333; val_masked_gp_l1_reg_loss: 68226.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84504.7578; val_chrom_access_recon_loss: 855278.8500; val_global_loss: 20864760.6667; val_optim_loss: 20864760.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9622; val_auprc_score: 0.9521; val_best_acc_score: 0.9035; val_best_f1_score: 0.9078; train_kl_reg_loss: 55542.3354; train_edge_recon_loss: 577352.1398; train_gene_expr_recon_loss: 19127437.1145; train_masked_gp_l1_reg_loss: 68693.1460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83824.5584; train_chrom_access_recon_loss: 849489.8626; train_global_loss: 20762339.2214; train_optim_loss: 20762339.2214; val_kl_reg_loss: 54469.9523; val_edge_recon_loss: 579854.3167; val_gene_expr_recon_loss: 19175581.2000; val_masked_gp_l1_reg_loss: 69186.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82510.1172; val_chrom_access_recon_loss: 856660.3708; val_global_loss: 20818261.8667; val_optim_loss: 20818261.8667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9631; val_auprc_score: 0.9494; val_best_acc_score: 0.9105; val_best_f1_score: 0.9136; train_kl_reg_loss: 54102.1183; train_edge_recon_loss: 581803.5787; train_gene_expr_recon_loss: 19114341.5725; train_masked_gp_l1_reg_loss: 69116.3010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86694.2502; train_chrom_access_recon_loss: 850372.2853; train_global_loss: 20756429.9389; train_optim_loss: 20756429.9389; val_kl_reg_loss: 56485.6643; val_edge_recon_loss: 580358.5917; val_gene_expr_recon_loss: 19031396.4000; val_masked_gp_l1_reg_loss: 68284.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84382.6328; val_chrom_access_recon_loss: 848040.7417; val_global_loss: 20668947.0667; val_optim_loss: 20668947.0667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9671; val_auprc_score: 0.9605; val_best_acc_score: 0.9095; val_best_f1_score: 0.9126; train_kl_reg_loss: 57824.8786; train_edge_recon_loss: 581878.7228; train_gene_expr_recon_loss: 19080716.6870; train_masked_gp_l1_reg_loss: 67986.9121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90307.5330; train_chrom_access_recon_loss: 849554.3039; train_global_loss: 20728268.9313; train_optim_loss: 20728268.9313; val_kl_reg_loss: 58306.5813; val_edge_recon_loss: 580452.6333; val_gene_expr_recon_loss: 18982403.8667; val_masked_gp_l1_reg_loss: 67455.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84848.5078; val_chrom_access_recon_loss: 847528.4875; val_global_loss: 20620995.2000; val_optim_loss: 20620995.2000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9654; val_auprc_score: 0.9584; val_best_acc_score: 0.9076; val_best_f1_score: 0.9103; train_kl_reg_loss: 57137.9898; train_edge_recon_loss: 578814.0329; train_gene_expr_recon_loss: 18994589.7099; train_masked_gp_l1_reg_loss: 67533.8328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84831.7594; train_chrom_access_recon_loss: 843253.6369; train_global_loss: 20626161.0229; train_optim_loss: 20626161.0229; val_kl_reg_loss: 56962.8484; val_edge_recon_loss: 578298.2458; val_gene_expr_recon_loss: 18967863.8667; val_masked_gp_l1_reg_loss: 67849.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83980.0391; val_chrom_access_recon_loss: 845007.4917; val_global_loss: 20599962.5333; val_optim_loss: 20599962.5333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9623; val_auprc_score: 0.9472; val_best_acc_score: 0.9112; val_best_f1_score: 0.9148; train_kl_reg_loss: 428033.5985; train_edge_recon_loss: 577783.0530; train_gene_expr_recon_loss: 19005826.5649; train_masked_gp_l1_reg_loss: 68291.6072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82677.5055; train_chrom_access_recon_loss: 840063.9408; train_global_loss: 21002676.2137; train_optim_loss: 21002676.2137; val_kl_reg_loss: 54171.8539; val_edge_recon_loss: 606400.4792; val_gene_expr_recon_loss: 19082183.2000; val_masked_gp_l1_reg_loss: 68619.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90962.0625; val_chrom_access_recon_loss: 858001.6333; val_global_loss: 20760339.0667; val_optim_loss: 20760339.0667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9631; val_auprc_score: 0.9530; val_best_acc_score: 0.9054; val_best_f1_score: 0.9087; train_kl_reg_loss: 156551.1108; train_edge_recon_loss: 587945.4132; train_gene_expr_recon_loss: 19001185.8321; train_masked_gp_l1_reg_loss: 67867.7337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86622.0816; train_chrom_access_recon_loss: 843887.0491; train_global_loss: 20744059.1450; train_optim_loss: 20744059.1450; val_kl_reg_loss: 55306.1370; val_edge_recon_loss: 590532.5542; val_gene_expr_recon_loss: 18898089.2000; val_masked_gp_l1_reg_loss: 67316.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85203.9531; val_chrom_access_recon_loss: 844870.4083; val_global_loss: 20541318.4000; val_optim_loss: 20541318.4000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9620; val_auprc_score: 0.9512; val_best_acc_score: 0.9107; val_best_f1_score: 0.9140; train_kl_reg_loss: 56582.0729; train_edge_recon_loss: 580839.2519; train_gene_expr_recon_loss: 18927868.1679; train_masked_gp_l1_reg_loss: 67274.1197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80248.6797; train_chrom_access_recon_loss: 838857.4628; train_global_loss: 20551669.7405; train_optim_loss: 20551669.7405; val_kl_reg_loss: 5916525.2807; val_edge_recon_loss: 582084.1292; val_gene_expr_recon_loss: 18841032.0000; val_masked_gp_l1_reg_loss: 67431.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80544.6094; val_chrom_access_recon_loss: 839571.9583; val_global_loss: 26327189.3333; val_optim_loss: 26327189.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9620; val_auprc_score: 0.9523; val_best_acc_score: 0.9081; val_best_f1_score: 0.9117; train_kl_reg_loss: 55952.6516; train_edge_recon_loss: 578869.6088; train_gene_expr_recon_loss: 18885282.3893; train_masked_gp_l1_reg_loss: 67612.8686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80157.2465; train_chrom_access_recon_loss: 837004.3483; train_global_loss: 20504879.0076; train_optim_loss: 20504879.0076; val_kl_reg_loss: 56510.5378; val_edge_recon_loss: 580915.3250; val_gene_expr_recon_loss: 18895274.5333; val_masked_gp_l1_reg_loss: 67765.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79078.0000; val_chrom_access_recon_loss: 842876.1708; val_global_loss: 20522420.5333; val_optim_loss: 20522420.5333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9604; val_auprc_score: 0.9510; val_best_acc_score: 0.9062; val_best_f1_score: 0.9090; train_kl_reg_loss: 6173015.7741; train_edge_recon_loss: 584809.7385; train_gene_expr_recon_loss: 18905699.8931; train_masked_gp_l1_reg_loss: 67454.4334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83302.1579; train_chrom_access_recon_loss: 838823.7624; train_global_loss: 26653105.9084; train_optim_loss: 26653105.9084; val_kl_reg_loss: 69452.3323; val_edge_recon_loss: 586181.4750; val_gene_expr_recon_loss: 18871223.2000; val_masked_gp_l1_reg_loss: 66455.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88680.3438; val_chrom_access_recon_loss: 842334.3083; val_global_loss: 20524327.0667; val_optim_loss: 20524327.0667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9570; val_auprc_score: 0.9441; val_best_acc_score: 0.9037; val_best_f1_score: 0.9078; train_kl_reg_loss: 635290.8221; train_edge_recon_loss: 584017.1088; train_gene_expr_recon_loss: 18891226.9771; train_masked_gp_l1_reg_loss: 65914.7885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85425.1695; train_chrom_access_recon_loss: 838034.9676; train_global_loss: 21099910.0305; train_optim_loss: 21099910.0305; val_kl_reg_loss: 59063.0292; val_edge_recon_loss: 592049.7625; val_gene_expr_recon_loss: 18899324.5333; val_masked_gp_l1_reg_loss: 65761.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93464.4297; val_chrom_access_recon_loss: 848038.1375; val_global_loss: 20557701.0667; val_optim_loss: 20557701.0667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9642; val_auprc_score: 0.9559; val_best_acc_score: 0.9095; val_best_f1_score: 0.9131; train_kl_reg_loss: 60584.6729; train_edge_recon_loss: 584407.3149; train_gene_expr_recon_loss: 18839711.3588; train_masked_gp_l1_reg_loss: 65792.9248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85042.9760; train_chrom_access_recon_loss: 835769.2853; train_global_loss: 20471308.4580; train_optim_loss: 20471308.4580; val_kl_reg_loss: 61865.3445; val_edge_recon_loss: 581372.5583; val_gene_expr_recon_loss: 18798009.3333; val_masked_gp_l1_reg_loss: 65876.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83570.5234; val_chrom_access_recon_loss: 838484.5333; val_global_loss: 20429178.0000; val_optim_loss: 20429178.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9377; val_auprc_score: 0.9341; val_best_acc_score: 0.8608; val_best_f1_score: 0.8631; train_kl_reg_loss: 665884.5014; train_edge_recon_loss: 752587.6455; train_gene_expr_recon_loss: 17927747.6718; train_masked_gp_l1_reg_loss: 61846.9634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71016.9696; train_chrom_access_recon_loss: 777928.4404; train_global_loss: 20257012.3664; train_optim_loss: 20257012.3664; val_kl_reg_loss: 73175.8878; val_edge_recon_loss: 728709.8167; val_gene_expr_recon_loss: 17500559.3333; val_masked_gp_l1_reg_loss: 58177.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70526.2031; val_chrom_access_recon_loss: 782225.5833; val_global_loss: 19213374.4000; val_optim_loss: 19213374.4000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9100; val_auprc_score: 0.9090; val_best_acc_score: 0.8285; val_best_f1_score: 0.8309; train_kl_reg_loss: 75942.3265; train_edge_recon_loss: 704606.3125; train_gene_expr_recon_loss: 17650234.4580; train_masked_gp_l1_reg_loss: 57049.3335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70107.2345; train_chrom_access_recon_loss: 775102.6923; train_global_loss: 19333042.5038; train_optim_loss: 19333042.5038; val_kl_reg_loss: 40010.6216; val_edge_recon_loss: 712045.8875; val_gene_expr_recon_loss: 17374575.4667; val_masked_gp_l1_reg_loss: 55381.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69238.7422; val_chrom_access_recon_loss: 778439.6417; val_global_loss: 19029691.4667; val_optim_loss: 19029691.4667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9194; val_auprc_score: 0.9116; val_best_acc_score: 0.8442; val_best_f1_score: 0.8535; train_kl_reg_loss: 87761.4532; train_edge_recon_loss: 669527.7552; train_gene_expr_recon_loss: 17385600.4122; train_masked_gp_l1_reg_loss: 54693.8874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68816.6874; train_chrom_access_recon_loss: 769861.9881; train_global_loss: 19036262.0458; train_optim_loss: 19036262.0458; val_kl_reg_loss: 30327.0089; val_edge_recon_loss: 650067.1333; val_gene_expr_recon_loss: 17328649.4667; val_masked_gp_l1_reg_loss: 54815.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67414.3125; val_chrom_access_recon_loss: 774104.9125; val_global_loss: 18905378.9333; val_optim_loss: 18905378.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9213; val_auprc_score: 0.9133; val_best_acc_score: 0.8445; val_best_f1_score: 0.8508; train_kl_reg_loss: 52804.5047; train_edge_recon_loss: 647140.4041; train_gene_expr_recon_loss: 17391027.5420; train_masked_gp_l1_reg_loss: 54187.1343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66902.4938; train_chrom_access_recon_loss: 770662.2252; train_global_loss: 18982724.2595; train_optim_loss: 18982724.2595; val_kl_reg_loss: 32259.5214; val_edge_recon_loss: 628501.9542; val_gene_expr_recon_loss: 17329474.3333; val_masked_gp_l1_reg_loss: 53979.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66409.2969; val_chrom_access_recon_loss: 776201.9542; val_global_loss: 18886827.8667; val_optim_loss: 18886827.8667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9257; val_auprc_score: 0.9165; val_best_acc_score: 0.8527; val_best_f1_score: 0.8594; train_kl_reg_loss: 50723.5970; train_edge_recon_loss: 621232.8278; train_gene_expr_recon_loss: 17335653.4046; train_masked_gp_l1_reg_loss: 54153.1459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65858.9934; train_chrom_access_recon_loss: 769047.6565; train_global_loss: 18896669.6031; train_optim_loss: 18896669.6031; val_kl_reg_loss: 36540.8471; val_edge_recon_loss: 622569.6083; val_gene_expr_recon_loss: 17303912.0000; val_masked_gp_l1_reg_loss: 54231.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65227.3594; val_chrom_access_recon_loss: 771789.2208; val_global_loss: 18854271.4667; val_optim_loss: 18854271.4667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9291; val_auprc_score: 0.9237; val_best_acc_score: 0.8557; val_best_f1_score: 0.8595; train_kl_reg_loss: 54609.0565; train_edge_recon_loss: 611775.6932; train_gene_expr_recon_loss: 17350318.2137; train_masked_gp_l1_reg_loss: 54182.9852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65413.5795; train_chrom_access_recon_loss: 768823.9909; train_global_loss: 18905123.8168; train_optim_loss: 18905123.8168; val_kl_reg_loss: 139324.9729; val_edge_recon_loss: 614913.6042; val_gene_expr_recon_loss: 17216266.0000; val_masked_gp_l1_reg_loss: 54147.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65209.9766; val_chrom_access_recon_loss: 772027.3042; val_global_loss: 18861890.0000; val_optim_loss: 18861890.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9236; val_auprc_score: 0.9115; val_best_acc_score: 0.8473; val_best_f1_score: 0.8591; train_kl_reg_loss: 55412.9090; train_edge_recon_loss: 607695.9485; train_gene_expr_recon_loss: 17314152.6412; train_masked_gp_l1_reg_loss: 54205.2546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65632.8584; train_chrom_access_recon_loss: 769235.1231; train_global_loss: 18866334.7328; train_optim_loss: 18866334.7328; val_kl_reg_loss: 36503.6914; val_edge_recon_loss: 603413.4958; val_gene_expr_recon_loss: 17315994.0000; val_masked_gp_l1_reg_loss: 54380.7695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65643.3281; val_chrom_access_recon_loss: 777012.5833; val_global_loss: 18852947.8667; val_optim_loss: 18852947.8667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9294; val_auprc_score: 0.9205; val_best_acc_score: 0.8519; val_best_f1_score: 0.8604; train_kl_reg_loss: 50678.2237; train_edge_recon_loss: 595132.8063; train_gene_expr_recon_loss: 17284405.6565; train_masked_gp_l1_reg_loss: 54517.0830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65662.2967; train_chrom_access_recon_loss: 768140.9179; train_global_loss: 18818536.9924; train_optim_loss: 18818536.9924; val_kl_reg_loss: 37335.2805; val_edge_recon_loss: 600184.0125; val_gene_expr_recon_loss: 17299118.9333; val_masked_gp_l1_reg_loss: 54527.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65869.7812; val_chrom_access_recon_loss: 774048.4625; val_global_loss: 18831084.8000; val_optim_loss: 18831084.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9335; val_auprc_score: 0.9246; val_best_acc_score: 0.8591; val_best_f1_score: 0.8658; train_kl_reg_loss: 51563.5432; train_edge_recon_loss: 591375.7090; train_gene_expr_recon_loss: 17269851.7863; train_masked_gp_l1_reg_loss: 54318.9885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65959.4703; train_chrom_access_recon_loss: 766913.1245; train_global_loss: 18799982.5649; train_optim_loss: 18799982.5649; val_kl_reg_loss: 40156.8349; val_edge_recon_loss: 592988.7833; val_gene_expr_recon_loss: 17268164.8667; val_masked_gp_l1_reg_loss: 54183.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66377.5781; val_chrom_access_recon_loss: 773063.6792; val_global_loss: 18794935.8667; val_optim_loss: 18794935.8667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9242; val_auprc_score: 0.9138; val_best_acc_score: 0.8492; val_best_f1_score: 0.8585; train_kl_reg_loss: 423810.0697; train_edge_recon_loss: 588064.2739; train_gene_expr_recon_loss: 17262211.1985; train_masked_gp_l1_reg_loss: 53849.0618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66156.2359; train_chrom_access_recon_loss: 766683.8402; train_global_loss: 19160774.4885; train_optim_loss: 19160774.4885; val_kl_reg_loss: 48876.4341; val_edge_recon_loss: 590330.1875; val_gene_expr_recon_loss: 17234760.0667; val_masked_gp_l1_reg_loss: 53144.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65960.0859; val_chrom_access_recon_loss: 775087.5250; val_global_loss: 18768158.5333; val_optim_loss: 18768158.5333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9358; val_auprc_score: 0.9270; val_best_acc_score: 0.8657; val_best_f1_score: 0.8710; train_kl_reg_loss: 60231.7818; train_edge_recon_loss: 583269.9647; train_gene_expr_recon_loss: 17255760.1679; train_masked_gp_l1_reg_loss: 52797.2266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65573.7484; train_chrom_access_recon_loss: 767194.8531; train_global_loss: 18784827.7557; train_optim_loss: 18784827.7557; val_kl_reg_loss: 47640.3070; val_edge_recon_loss: 586901.7167; val_gene_expr_recon_loss: 17209556.2667; val_masked_gp_l1_reg_loss: 52514.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65445.1484; val_chrom_access_recon_loss: 771748.6417; val_global_loss: 18733806.8000; val_optim_loss: 18733806.8000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9299; val_auprc_score: 0.9210; val_best_acc_score: 0.8545; val_best_f1_score: 0.8625; train_kl_reg_loss: 2553433026.6297; train_edge_recon_loss: 590097.7820; train_gene_expr_recon_loss: 17254744.8397; train_masked_gp_l1_reg_loss: 52212.4960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65523.5006; train_chrom_access_recon_loss: 766083.9971; train_global_loss: 2572161919.0687; train_optim_loss: 2572161919.0687; val_kl_reg_loss: 56392.8409; val_edge_recon_loss: 607157.3500; val_gene_expr_recon_loss: 17237574.4000; val_masked_gp_l1_reg_loss: 51786.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66185.0547; val_chrom_access_recon_loss: 769879.9125; val_global_loss: 18788976.6667; val_optim_loss: 18788976.6667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9096; val_auprc_score: 0.9038; val_best_acc_score: 0.8316; val_best_f1_score: 0.8373; train_kl_reg_loss: 446625339600.3389; train_edge_recon_loss: 648771.1455; train_gene_expr_recon_loss: 17437960.8931; train_masked_gp_l1_reg_loss: 51129.7547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66534.8294; train_chrom_access_recon_loss: 771245.0539; train_global_loss: 446644303675.1909; train_optim_loss: 446644303675.1909; val_kl_reg_loss: 92662.7422; val_edge_recon_loss: 679288.8542; val_gene_expr_recon_loss: 17229290.0667; val_masked_gp_l1_reg_loss: 49384.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67685.1484; val_chrom_access_recon_loss: 771314.7125; val_global_loss: 18889626.2667; val_optim_loss: 18889626.2667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9093; val_auprc_score: 0.8978; val_best_acc_score: 0.8296; val_best_f1_score: 0.8417; train_kl_reg_loss: 1898895.6397; train_edge_recon_loss: 630608.8020; train_gene_expr_recon_loss: 17377961.9389; train_masked_gp_l1_reg_loss: 48611.0426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66823.2878; train_chrom_access_recon_loss: 767657.3564; train_global_loss: 20790558.0611; train_optim_loss: 20790558.0611; val_kl_reg_loss: 77191.7760; val_edge_recon_loss: 609794.3208; val_gene_expr_recon_loss: 17212035.7333; val_masked_gp_l1_reg_loss: 48062.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66491.8438; val_chrom_access_recon_loss: 768098.9708; val_global_loss: 18781675.2000; val_optim_loss: 18781675.2000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9203; val_auprc_score: 0.9057; val_best_acc_score: 0.8471; val_best_f1_score: 0.8552; train_kl_reg_loss: 81491.4483; train_edge_recon_loss: 605161.4504; train_gene_expr_recon_loss: 17246866.9313; train_masked_gp_l1_reg_loss: 48059.5423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66331.6025; train_chrom_access_recon_loss: 764932.9633; train_global_loss: 18812843.9084; train_optim_loss: 18812843.9084; val_kl_reg_loss: 60539.3008; val_edge_recon_loss: 600724.4000; val_gene_expr_recon_loss: 17197624.0667; val_masked_gp_l1_reg_loss: 47941.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66128.8359; val_chrom_access_recon_loss: 769099.9333; val_global_loss: 18742057.8667; val_optim_loss: 18742057.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9218; val_auprc_score: 0.9081; val_best_acc_score: 0.8433; val_best_f1_score: 0.8534; train_kl_reg_loss: 64977.5217; train_edge_recon_loss: 596119.1660; train_gene_expr_recon_loss: 17187902.1450; train_masked_gp_l1_reg_loss: 47602.2390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55049.1306; train_chrom_access_recon_loss: 763511.6818; train_global_loss: 18715161.9542; train_optim_loss: 18715161.9542; val_kl_reg_loss: 58563.6643; val_edge_recon_loss: 596427.0333; val_gene_expr_recon_loss: 17134110.0667; val_masked_gp_l1_reg_loss: 47518.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53091.0781; val_chrom_access_recon_loss: 764984.7958; val_global_loss: 18654695.0667; val_optim_loss: 18654695.0667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9206; val_auprc_score: 0.9118; val_best_acc_score: 0.8386; val_best_f1_score: 0.8501; train_kl_reg_loss: 63372.7443; train_edge_recon_loss: 592616.8616; train_gene_expr_recon_loss: 17194798.3969; train_masked_gp_l1_reg_loss: 47536.3452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52601.8613; train_chrom_access_recon_loss: 762966.2319; train_global_loss: 18713892.3664; train_optim_loss: 18713892.3664; val_kl_reg_loss: 56475.9068; val_edge_recon_loss: 597169.1167; val_gene_expr_recon_loss: 17114361.6667; val_masked_gp_l1_reg_loss: 47575.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52193.1797; val_chrom_access_recon_loss: 768817.7917; val_global_loss: 18636594.8000; val_optim_loss: 18636594.8000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9190; val_auprc_score: 0.9064; val_best_acc_score: 0.8425; val_best_f1_score: 0.8522; train_kl_reg_loss: 63912.4379; train_edge_recon_loss: 590820.3445; train_gene_expr_recon_loss: 17185139.8855; train_masked_gp_l1_reg_loss: 47577.9098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51979.6395; train_chrom_access_recon_loss: 762767.0315; train_global_loss: 18702197.3740; train_optim_loss: 18702197.3740; val_kl_reg_loss: 57855.2432; val_edge_recon_loss: 597014.8750; val_gene_expr_recon_loss: 17111089.2000; val_masked_gp_l1_reg_loss: 47543.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51675.6602; val_chrom_access_recon_loss: 765447.2250; val_global_loss: 18630626.2667; val_optim_loss: 18630626.2667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9181; val_auprc_score: 0.9077; val_best_acc_score: 0.8402; val_best_f1_score: 0.8512; train_kl_reg_loss: 63616.6585; train_edge_recon_loss: 589871.0353; train_gene_expr_recon_loss: 17163866.6412; train_masked_gp_l1_reg_loss: 47557.1613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51502.6594; train_chrom_access_recon_loss: 762293.7261; train_global_loss: 18678707.8626; train_optim_loss: 18678707.8626; val_kl_reg_loss: 54892.6924; val_edge_recon_loss: 600821.7958; val_gene_expr_recon_loss: 17152313.0000; val_masked_gp_l1_reg_loss: 47591.7695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51319.5664; val_chrom_access_recon_loss: 769158.7792; val_global_loss: 18676098.2667; val_optim_loss: 18676098.2667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9242; val_auprc_score: 0.9137; val_best_acc_score: 0.8426; val_best_f1_score: 0.8518; train_kl_reg_loss: 61731.7445; train_edge_recon_loss: 590185.4470; train_gene_expr_recon_loss: 17174905.6565; train_masked_gp_l1_reg_loss: 47607.6200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51188.5900; train_chrom_access_recon_loss: 763161.9857; train_global_loss: 18688781.1298; train_optim_loss: 18688781.1298; val_kl_reg_loss: 55851.2474; val_edge_recon_loss: 592827.6750; val_gene_expr_recon_loss: 17217873.1333; val_masked_gp_l1_reg_loss: 47648.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50996.9961; val_chrom_access_recon_loss: 770120.7542; val_global_loss: 18735316.6667; val_optim_loss: 18735316.6667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9248; val_auprc_score: 0.9134; val_best_acc_score: 0.8461; val_best_f1_score: 0.8558; train_kl_reg_loss: 61524.5237; train_edge_recon_loss: 589161.4461; train_gene_expr_recon_loss: 17156673.6336; train_masked_gp_l1_reg_loss: 47678.6266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50970.1816; train_chrom_access_recon_loss: 762147.7247; train_global_loss: 18668156.1221; train_optim_loss: 18668156.1221; val_kl_reg_loss: 55816.0953; val_edge_recon_loss: 590493.9333; val_gene_expr_recon_loss: 17125947.4667; val_masked_gp_l1_reg_loss: 47705.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50794.7656; val_chrom_access_recon_loss: 767407.5000; val_global_loss: 18638164.8000; val_optim_loss: 18638164.8000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9210; val_auprc_score: 0.9092; val_best_acc_score: 0.8393; val_best_f1_score: 0.8511; train_kl_reg_loss: 5619148211.0538; train_edge_recon_loss: 588199.2300; train_gene_expr_recon_loss: 17229984.1985; train_masked_gp_l1_reg_loss: 47729.8198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50661.9464; train_chrom_access_recon_loss: 763011.3368; train_global_loss: 5637828092.9618; train_optim_loss: 5637828092.9618; val_kl_reg_loss: 57809.4740; val_edge_recon_loss: 593563.3542; val_gene_expr_recon_loss: 17199812.7333; val_masked_gp_l1_reg_loss: 47747.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50552.1406; val_chrom_access_recon_loss: 769697.7542; val_global_loss: 18719183.2000; val_optim_loss: 18719183.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9180; val_auprc_score: 0.9031; val_best_acc_score: 0.8406; val_best_f1_score: 0.8507; train_kl_reg_loss: 63389.2547; train_edge_recon_loss: 588158.5940; train_gene_expr_recon_loss: 17166502.2977; train_masked_gp_l1_reg_loss: 47714.6269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49475.6719; train_chrom_access_recon_loss: 762777.5010; train_global_loss: 18678018.0153; train_optim_loss: 18678018.0153; val_kl_reg_loss: 57334.3112; val_edge_recon_loss: 593089.0250; val_gene_expr_recon_loss: 17165980.0667; val_masked_gp_l1_reg_loss: 47701.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49314.2773; val_chrom_access_recon_loss: 766113.5833; val_global_loss: 18679532.8000; val_optim_loss: 18679532.8000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9181; val_auprc_score: 0.9049; val_best_acc_score: 0.8397; val_best_f1_score: 0.8502; train_kl_reg_loss: 62922.8736; train_edge_recon_loss: 589182.9490; train_gene_expr_recon_loss: 17147096.7939; train_masked_gp_l1_reg_loss: 47695.7358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49260.4256; train_chrom_access_recon_loss: 761703.0382; train_global_loss: 18657861.7557; train_optim_loss: 18657861.7557; val_kl_reg_loss: 57250.1768; val_edge_recon_loss: 594723.5083; val_gene_expr_recon_loss: 17133975.2000; val_masked_gp_l1_reg_loss: 47693.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49211.5938; val_chrom_access_recon_loss: 770740.7208; val_global_loss: 18653595.6000; val_optim_loss: 18653595.6000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9235; val_auprc_score: 0.9114; val_best_acc_score: 0.8448; val_best_f1_score: 0.8548; train_kl_reg_loss: 62854.8655; train_edge_recon_loss: 586794.1188; train_gene_expr_recon_loss: 17152592.1298; train_masked_gp_l1_reg_loss: 47693.1975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49172.4646; train_chrom_access_recon_loss: 761650.7710; train_global_loss: 18660757.6336; train_optim_loss: 18660757.6336; val_kl_reg_loss: 57057.4883; val_edge_recon_loss: 593244.5042; val_gene_expr_recon_loss: 17154351.3333; val_masked_gp_l1_reg_loss: 47691.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49140.1562; val_chrom_access_recon_loss: 769742.5833; val_global_loss: 18671227.7333; val_optim_loss: 18671227.7333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9230; val_auprc_score: 0.9093; val_best_acc_score: 0.8455; val_best_f1_score: 0.8546; train_kl_reg_loss: 62849.6394; train_edge_recon_loss: 586569.5969; train_gene_expr_recon_loss: 17167730.3511; train_masked_gp_l1_reg_loss: 47694.5324; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49110.9022; train_chrom_access_recon_loss: 762336.4604; train_global_loss: 18676291.6183; train_optim_loss: 18676291.6183; val_kl_reg_loss: 57067.5375; val_edge_recon_loss: 591733.0333; val_gene_expr_recon_loss: 17154363.4667; val_masked_gp_l1_reg_loss: 47694.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49084.3125; val_chrom_access_recon_loss: 768954.3292; val_global_loss: 18668896.5333; val_optim_loss: 18668896.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 44 min 16 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9285
val AUPRC score: 0.9189
val best accuracy score: 0.8513
val best F1 score: 0.8596
val target rna MSE score: 1.6517
val source rna MSE score: 0.7586
val target atac MSE score: 0.5091
val source atac MSE score: 0.1569
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
