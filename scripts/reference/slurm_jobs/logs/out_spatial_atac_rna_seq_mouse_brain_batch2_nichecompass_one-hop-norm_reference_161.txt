[True]
Run timestamp: 29072023_134338_161.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_161']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8795; val_auprc_score: 0.8972; val_best_acc_score: 0.5106; val_best_f1_score: 0.6714; train_kl_reg_loss: 5725.5669; train_edge_recon_loss: 34740650.2222; train_gene_expr_recon_loss: 83664048.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 186951006.2222; train_global_loss: 305361425.7778; train_optim_loss: 305361425.7778; val_kl_reg_loss: 2374.9189; val_edge_recon_loss: 40639684.0000; val_gene_expr_recon_loss: 71526000.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 173100096.0000; val_global_loss: 285268160.0000; val_optim_loss: 285268160.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8819; val_auprc_score: 0.8983; val_best_acc_score: 0.5012; val_best_f1_score: 0.6672; train_kl_reg_loss: 8434.4325; train_edge_recon_loss: 34812325.7778; train_gene_expr_recon_loss: 68988868.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 175667248.0000; train_global_loss: 279476885.3333; train_optim_loss: 279476885.3333; val_kl_reg_loss: 25048.5078; val_edge_recon_loss: 40657696.0000; val_gene_expr_recon_loss: 66587360.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 174347552.0000; val_global_loss: 281617664.0000; val_optim_loss: 281617664.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8718; val_auprc_score: 0.8880; val_best_acc_score: 0.5012; val_best_f1_score: 0.6672; train_kl_reg_loss: 44801.5840; train_edge_recon_loss: 34860977.3333; train_gene_expr_recon_loss: 65945771.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 172484723.5556; train_global_loss: 273336279.1111; train_optim_loss: 273336279.1111; val_kl_reg_loss: 62823.2930; val_edge_recon_loss: 40658484.0000; val_gene_expr_recon_loss: 65532984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 169802864.0000; val_global_loss: 276057152.0000; val_optim_loss: 276057152.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8816; val_auprc_score: 0.8982; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 142644.7422; train_edge_recon_loss: 34832009.3333; train_gene_expr_recon_loss: 64712188.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 170570076.4444; train_global_loss: 270256917.3333; train_optim_loss: 270256917.3333; val_kl_reg_loss: 103184.1094; val_edge_recon_loss: 40659652.0000; val_gene_expr_recon_loss: 62761408.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 167635392.0000; val_global_loss: 271159616.0000; val_optim_loss: 271159616.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8859; val_auprc_score: 0.8955; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 267766.4957; train_edge_recon_loss: 34801569.7778; train_gene_expr_recon_loss: 61267615.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 168769507.5556; train_global_loss: 265106460.4444; train_optim_loss: 265106460.4444; val_kl_reg_loss: 136587.2656; val_edge_recon_loss: 40659988.0000; val_gene_expr_recon_loss: 59135048.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 166868992.0000; val_global_loss: 266800608.0000; val_optim_loss: 266800608.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8912; val_auprc_score: 0.9036; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 278535.0599; train_edge_recon_loss: 34889207.5556; train_gene_expr_recon_loss: 57596160.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 166226684.4444; train_global_loss: 258990590.2222; train_optim_loss: 258990590.2222; val_kl_reg_loss: 396630.7188; val_edge_recon_loss: 40660656.0000; val_gene_expr_recon_loss: 55428928.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 164663296.0000; val_global_loss: 261149504.0000; val_optim_loss: 261149504.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8834; val_auprc_score: 0.8916; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 332299.4010; train_edge_recon_loss: 34842254.2222; train_gene_expr_recon_loss: 54441987.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 164608124.4444; train_global_loss: 254224666.6667; train_optim_loss: 254224666.6667; val_kl_reg_loss: 382954.5000; val_edge_recon_loss: 40659880.0000; val_gene_expr_recon_loss: 52771264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 162819168.0000; val_global_loss: 256633264.0000; val_optim_loss: 256633264.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8707; val_auprc_score: 0.8777; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 431129.9826; train_edge_recon_loss: 34827623.1111; train_gene_expr_recon_loss: 51773802.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 163071731.5556; train_global_loss: 250104286.2222; train_optim_loss: 250104286.2222; val_kl_reg_loss: 280098.6562; val_edge_recon_loss: 40659144.0000; val_gene_expr_recon_loss: 50066792.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 161145696.0000; val_global_loss: 252151728.0000; val_optim_loss: 252151728.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8590; val_auprc_score: 0.8682; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 382630.7083; train_edge_recon_loss: 34945926.2222; train_gene_expr_recon_loss: 48659809.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 161226204.4444; train_global_loss: 245214570.6667; train_optim_loss: 245214570.6667; val_kl_reg_loss: 332994.7500; val_edge_recon_loss: 40658668.0000; val_gene_expr_recon_loss: 47500504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 159750208.0000; val_global_loss: 248242368.0000; val_optim_loss: 248242368.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8516; val_auprc_score: 0.8639; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 430320.0347; train_edge_recon_loss: 34888852.8889; train_gene_expr_recon_loss: 46640133.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 160327125.3333; train_global_loss: 242286432.0000; train_optim_loss: 242286432.0000; val_kl_reg_loss: 265843.5312; val_edge_recon_loss: 40658148.0000; val_gene_expr_recon_loss: 45644896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 158070848.0000; val_global_loss: 244639744.0000; val_optim_loss: 244639744.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8478; val_auprc_score: 0.8564; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 434958.5243; train_edge_recon_loss: 34902107.5556; train_gene_expr_recon_loss: 44545817.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 158102977.7778; train_global_loss: 237985861.3333; train_optim_loss: 237985861.3333; val_kl_reg_loss: 248430.5625; val_edge_recon_loss: 40657556.0000; val_gene_expr_recon_loss: 44059652.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156703216.0000; val_global_loss: 241668864.0000; val_optim_loss: 241668864.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8332; val_auprc_score: 0.8436; val_best_acc_score: 0.5024; val_best_f1_score: 0.6677; train_kl_reg_loss: 394631.4410; train_edge_recon_loss: 34969128.0000; train_gene_expr_recon_loss: 43127496.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156882104.8889; train_global_loss: 235373358.2222; train_optim_loss: 235373358.2222; val_kl_reg_loss: 265301.0938; val_edge_recon_loss: 40656252.0000; val_gene_expr_recon_loss: 42824880.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156284128.0000; val_global_loss: 240030560.0000; val_optim_loss: 240030560.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8296; val_auprc_score: 0.8373; val_best_acc_score: 0.5030; val_best_f1_score: 0.6680; train_kl_reg_loss: 410803.3438; train_edge_recon_loss: 34929262.6667; train_gene_expr_recon_loss: 41848400.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156100675.5556; train_global_loss: 233289139.5556; train_optim_loss: 233289139.5556; val_kl_reg_loss: 259463.0938; val_edge_recon_loss: 40655388.0000; val_gene_expr_recon_loss: 41751160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155153184.0000; val_global_loss: 237819200.0000; val_optim_loss: 237819200.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8199; val_auprc_score: 0.8274; val_best_acc_score: 0.5077; val_best_f1_score: 0.6701; train_kl_reg_loss: 395860.9931; train_edge_recon_loss: 34912540.4444; train_gene_expr_recon_loss: 41445680.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156590855.1111; train_global_loss: 233344936.8889; train_optim_loss: 233344936.8889; val_kl_reg_loss: 307764.5312; val_edge_recon_loss: 40653540.0000; val_gene_expr_recon_loss: 40926416.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154556160.0000; val_global_loss: 236443872.0000; val_optim_loss: 236443872.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8141; val_auprc_score: 0.8201; val_best_acc_score: 0.5123; val_best_f1_score: 0.6722; train_kl_reg_loss: 391900.9236; train_edge_recon_loss: 34917889.7778; train_gene_expr_recon_loss: 40525302.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155191000.8889; train_global_loss: 231026094.2222; train_optim_loss: 231026094.2222; val_kl_reg_loss: 261442.3750; val_edge_recon_loss: 40650976.0000; val_gene_expr_recon_loss: 40508924.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154400544.0000; val_global_loss: 235821888.0000; val_optim_loss: 235821888.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8109; val_auprc_score: 0.8178; val_best_acc_score: 0.5102; val_best_f1_score: 0.6712; train_kl_reg_loss: 380731.5174; train_edge_recon_loss: 34930759.5556; train_gene_expr_recon_loss: 40201399.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154429927.1111; train_global_loss: 229942817.7778; train_optim_loss: 229942817.7778; val_kl_reg_loss: 273134.6562; val_edge_recon_loss: 40650984.0000; val_gene_expr_recon_loss: 40006712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153905136.0000; val_global_loss: 234835968.0000; val_optim_loss: 234835968.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8086; val_auprc_score: 0.8092; val_best_acc_score: 0.5131; val_best_f1_score: 0.6725; train_kl_reg_loss: 374115.6493; train_edge_recon_loss: 34892587.5556; train_gene_expr_recon_loss: 39634161.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154746718.2222; train_global_loss: 229647582.2222; train_optim_loss: 229647582.2222; val_kl_reg_loss: 317738.6875; val_edge_recon_loss: 40648664.0000; val_gene_expr_recon_loss: 39611032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153521264.0000; val_global_loss: 234098704.0000; val_optim_loss: 234098704.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8035; val_auprc_score: 0.8090; val_best_acc_score: 0.5182; val_best_f1_score: 0.6748; train_kl_reg_loss: 366973.3472; train_edge_recon_loss: 34903443.1111; train_gene_expr_recon_loss: 39352737.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153846625.7778; train_global_loss: 228469777.7778; train_optim_loss: 228469777.7778; val_kl_reg_loss: 310839.8125; val_edge_recon_loss: 40645920.0000; val_gene_expr_recon_loss: 39389156.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153463888.0000; val_global_loss: 233809808.0000; val_optim_loss: 233809808.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7993; val_auprc_score: 0.8036; val_best_acc_score: 0.5210; val_best_f1_score: 0.6760; train_kl_reg_loss: 356909.5764; train_edge_recon_loss: 34887888.0000; train_gene_expr_recon_loss: 38963514.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153054385.7778; train_global_loss: 227262698.6667; train_optim_loss: 227262698.6667; val_kl_reg_loss: 293354.7500; val_edge_recon_loss: 40643348.0000; val_gene_expr_recon_loss: 39210076.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153169952.0000; val_global_loss: 233316736.0000; val_optim_loss: 233316736.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8082; val_auprc_score: 0.8085; val_best_acc_score: 0.5261; val_best_f1_score: 0.6781; train_kl_reg_loss: 358841.6736; train_edge_recon_loss: 34887883.1111; train_gene_expr_recon_loss: 38947526.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153561144.8889; train_global_loss: 227755395.5556; train_optim_loss: 227755395.5556; val_kl_reg_loss: 275298.3750; val_edge_recon_loss: 40639632.0000; val_gene_expr_recon_loss: 39055856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152875200.0000; val_global_loss: 232845984.0000; val_optim_loss: 232845984.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8183; val_auprc_score: 0.8201; val_best_acc_score: 0.5309; val_best_f1_score: 0.6800; train_kl_reg_loss: 343798.9097; train_edge_recon_loss: 34894406.6667; train_gene_expr_recon_loss: 39129005.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154292142.2222; train_global_loss: 228659352.8889; train_optim_loss: 228659352.8889; val_kl_reg_loss: 273759.5938; val_edge_recon_loss: 40634092.0000; val_gene_expr_recon_loss: 38866536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152560304.0000; val_global_loss: 232334688.0000; val_optim_loss: 232334688.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8343; val_auprc_score: 0.8334; val_best_acc_score: 0.5388; val_best_f1_score: 0.6830; train_kl_reg_loss: 342100.3125; train_edge_recon_loss: 34890999.1111; train_gene_expr_recon_loss: 38756257.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153289256.8889; train_global_loss: 227278611.5556; train_optim_loss: 227278611.5556; val_kl_reg_loss: 274679.8125; val_edge_recon_loss: 40622996.0000; val_gene_expr_recon_loss: 38835636.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152607920.0000; val_global_loss: 232341232.0000; val_optim_loss: 232341232.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8388; val_auprc_score: 0.8310; val_best_acc_score: 0.5583; val_best_f1_score: 0.6915; train_kl_reg_loss: 333975.3438; train_edge_recon_loss: 34885201.7778; train_gene_expr_recon_loss: 38490806.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152415612.4444; train_global_loss: 226125596.4444; train_optim_loss: 226125596.4444; val_kl_reg_loss: 268969.7812; val_edge_recon_loss: 40606500.0000; val_gene_expr_recon_loss: 38745948.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152470048.0000; val_global_loss: 232091456.0000; val_optim_loss: 232091456.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8405; val_auprc_score: 0.8312; val_best_acc_score: 0.5757; val_best_f1_score: 0.6994; train_kl_reg_loss: 336239.3403; train_edge_recon_loss: 34868796.0000; train_gene_expr_recon_loss: 38429156.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152728928.0000; train_global_loss: 226363121.7778; train_optim_loss: 226363121.7778; val_kl_reg_loss: 254535.4688; val_edge_recon_loss: 40591340.0000; val_gene_expr_recon_loss: 38589032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151971520.0000; val_global_loss: 231406432.0000; val_optim_loss: 231406432.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8605; val_auprc_score: 0.8486; val_best_acc_score: 0.6093; val_best_f1_score: 0.7156; train_kl_reg_loss: 322313.9115; train_edge_recon_loss: 34873586.6667; train_gene_expr_recon_loss: 38367462.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152478412.4444; train_global_loss: 226041777.7778; train_optim_loss: 226041777.7778; val_kl_reg_loss: 260166.2500; val_edge_recon_loss: 40559268.0000; val_gene_expr_recon_loss: 38497968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151976384.0000; val_global_loss: 231293792.0000; val_optim_loss: 231293792.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8602; val_auprc_score: 0.8568; val_best_acc_score: 0.5912; val_best_f1_score: 0.7070; train_kl_reg_loss: 249463.5230; train_edge_recon_loss: 39194465.3333; train_gene_expr_recon_loss: 39835365.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152804280.8889; train_global_loss: 232083575.1111; train_optim_loss: 232083575.1111; val_kl_reg_loss: 62055.9453; val_edge_recon_loss: 40573480.0000; val_gene_expr_recon_loss: 39539624.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153463872.0000; val_global_loss: 233639040.0000; val_optim_loss: 233639040.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8316; val_auprc_score: 0.8209; val_best_acc_score: 0.6549; val_best_f1_score: 0.7394; train_kl_reg_loss: 63174.3570; train_edge_recon_loss: 38123566.2222; train_gene_expr_recon_loss: 46563802.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156455960.8889; train_global_loss: 241206501.3333; train_optim_loss: 241206501.3333; val_kl_reg_loss: 18654.7930; val_edge_recon_loss: 40511176.0000; val_gene_expr_recon_loss: 42063036.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154946976.0000; val_global_loss: 237539840.0000; val_optim_loss: 237539840.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8272; val_auprc_score: 0.8142; val_best_acc_score: 0.6583; val_best_f1_score: 0.7398; train_kl_reg_loss: 35404.6684; train_edge_recon_loss: 36352464.0000; train_gene_expr_recon_loss: 41544124.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154502597.3333; train_global_loss: 232434590.2222; train_optim_loss: 232434590.2222; val_kl_reg_loss: 41390.5195; val_edge_recon_loss: 40473740.0000; val_gene_expr_recon_loss: 39935636.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153764320.0000; val_global_loss: 234215088.0000; val_optim_loss: 234215088.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8222; val_auprc_score: 0.8112; val_best_acc_score: 0.6271; val_best_f1_score: 0.7247; train_kl_reg_loss: 98421.4462; train_edge_recon_loss: 35421524.0000; train_gene_expr_recon_loss: 39676934.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154031777.7778; train_global_loss: 229228656.0000; train_optim_loss: 229228656.0000; val_kl_reg_loss: 165649.0000; val_edge_recon_loss: 40541188.0000; val_gene_expr_recon_loss: 39223344.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152797824.0000; val_global_loss: 232728000.0000; val_optim_loss: 232728000.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8214; val_auprc_score: 0.8132; val_best_acc_score: 0.6229; val_best_f1_score: 0.7227; train_kl_reg_loss: 185233.4948; train_edge_recon_loss: 35637120.8889; train_gene_expr_recon_loss: 39275285.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153937694.2222; train_global_loss: 229035333.3333; train_optim_loss: 229035333.3333; val_kl_reg_loss: 163864.6875; val_edge_recon_loss: 40543740.0000; val_gene_expr_recon_loss: 39169928.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152913760.0000; val_global_loss: 232791296.0000; val_optim_loss: 232791296.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8251; val_auprc_score: 0.8145; val_best_acc_score: 0.6237; val_best_f1_score: 0.7232; train_kl_reg_loss: 162061.2899; train_edge_recon_loss: 35673508.8889; train_gene_expr_recon_loss: 39187521.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153438725.3333; train_global_loss: 228461820.4444; train_optim_loss: 228461820.4444; val_kl_reg_loss: 143328.4688; val_edge_recon_loss: 40549248.0000; val_gene_expr_recon_loss: 39104248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152669376.0000; val_global_loss: 232466208.0000; val_optim_loss: 232466208.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8224; val_auprc_score: 0.8121; val_best_acc_score: 0.6236; val_best_f1_score: 0.7231; train_kl_reg_loss: 160848.2500; train_edge_recon_loss: 35468872.8889; train_gene_expr_recon_loss: 39279663.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153550664.8889; train_global_loss: 228460049.7778; train_optim_loss: 228460049.7778; val_kl_reg_loss: 153112.3125; val_edge_recon_loss: 40544816.0000; val_gene_expr_recon_loss: 39062016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152592032.0000; val_global_loss: 232351968.0000; val_optim_loss: 232351968.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8325; val_auprc_score: 0.8264; val_best_acc_score: 0.6271; val_best_f1_score: 0.7251; train_kl_reg_loss: 158633.6146; train_edge_recon_loss: 35494205.7778; train_gene_expr_recon_loss: 39189358.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153605242.6667; train_global_loss: 228447441.7778; train_optim_loss: 228447441.7778; val_kl_reg_loss: 141340.5781; val_edge_recon_loss: 40543588.0000; val_gene_expr_recon_loss: 39057984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152614080.0000; val_global_loss: 232356992.0000; val_optim_loss: 232356992.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 39 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8539
val AUPRC score: 0.8409
val best accuracy score: 0.5695
val best F1 score: 0.6969
val target rna MSE score: 3.6110
val source rna MSE score: 1.4433
val target atac MSE score: 0.1215
val source atac MSE score: 0.0180
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
