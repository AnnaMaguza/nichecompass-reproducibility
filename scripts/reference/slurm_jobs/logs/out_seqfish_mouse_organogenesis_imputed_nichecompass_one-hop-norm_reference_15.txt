[True]
Run timestamp: 27072023_060151_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8360; val_auprc_score: 0.9676; val_best_acc_score: 0.8643; val_best_f1_score: 0.9261; train_kl_reg_loss: 85449.2417; train_edge_recon_loss: 119615.9119; train_gene_expr_recon_loss: 1454784.7744; train_masked_gp_l1_reg_loss: 6838.3557; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1666688.2872; train_optim_loss: 1666688.2872; val_kl_reg_loss: 74997.0176; val_edge_recon_loss: 117334.9202; val_gene_expr_recon_loss: 1033262.7839; val_masked_gp_l1_reg_loss: 5990.5918; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1231585.3438; val_optim_loss: 1231585.3438
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8407; val_auprc_score: 0.9668; val_best_acc_score: 0.8658; val_best_f1_score: 0.9267; train_kl_reg_loss: 63263.2006; train_edge_recon_loss: 116735.4347; train_gene_expr_recon_loss: 988807.5238; train_masked_gp_l1_reg_loss: 5810.0240; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1174616.1826; train_optim_loss: 1174616.1826; val_kl_reg_loss: 54260.5368; val_edge_recon_loss: 114369.7780; val_gene_expr_recon_loss: 953117.7500; val_masked_gp_l1_reg_loss: 5793.5229; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1127541.5677; val_optim_loss: 1127541.5677
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8522; val_auprc_score: 0.9702; val_best_acc_score: 0.8665; val_best_f1_score: 0.9266; train_kl_reg_loss: 48351.1483; train_edge_recon_loss: 114384.1251; train_gene_expr_recon_loss: 931619.3288; train_masked_gp_l1_reg_loss: 5925.7313; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1100280.3355; train_optim_loss: 1100280.3355; val_kl_reg_loss: 43454.6021; val_edge_recon_loss: 113629.7145; val_gene_expr_recon_loss: 909384.5833; val_masked_gp_l1_reg_loss: 6096.5503; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1072565.4115; val_optim_loss: 1072565.4115
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8733; val_auprc_score: 0.9742; val_best_acc_score: 0.8665; val_best_f1_score: 0.9262; train_kl_reg_loss: 40277.7790; train_edge_recon_loss: 112960.4338; train_gene_expr_recon_loss: 894235.3320; train_masked_gp_l1_reg_loss: 6288.3026; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1053761.8462; train_optim_loss: 1053761.8462; val_kl_reg_loss: 36889.3228; val_edge_recon_loss: 114678.0612; val_gene_expr_recon_loss: 879184.6589; val_masked_gp_l1_reg_loss: 6483.5747; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1037235.6068; val_optim_loss: 1037235.6068
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8776; val_auprc_score: 0.9757; val_best_acc_score: 0.8724; val_best_f1_score: 0.9297; train_kl_reg_loss: 35260.4377; train_edge_recon_loss: 110782.7285; train_gene_expr_recon_loss: 867043.9340; train_masked_gp_l1_reg_loss: 6682.0738; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1019769.1776; train_optim_loss: 1019769.1776; val_kl_reg_loss: 33356.9162; val_edge_recon_loss: 108984.2568; val_gene_expr_recon_loss: 852785.9818; val_masked_gp_l1_reg_loss: 6883.4893; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1002010.6510; val_optim_loss: 1002010.6510
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8880; val_auprc_score: 0.9767; val_best_acc_score: 0.8758; val_best_f1_score: 0.9300; train_kl_reg_loss: 31737.2817; train_edge_recon_loss: 108412.7594; train_gene_expr_recon_loss: 844595.0799; train_masked_gp_l1_reg_loss: 7075.1421; train_group_lasso_reg_loss: 0.0000; train_global_loss: 991820.2634; train_optim_loss: 991820.2634; val_kl_reg_loss: 30857.6192; val_edge_recon_loss: 110260.6344; val_gene_expr_recon_loss: 832240.3411; val_masked_gp_l1_reg_loss: 7264.3984; val_group_lasso_reg_loss: 0.0000; val_global_loss: 980622.9714; val_optim_loss: 980622.9714
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8977; val_auprc_score: 0.9780; val_best_acc_score: 0.8865; val_best_f1_score: 0.9355; train_kl_reg_loss: 29058.4399; train_edge_recon_loss: 105880.9513; train_gene_expr_recon_loss: 824938.4326; train_masked_gp_l1_reg_loss: 7440.5570; train_group_lasso_reg_loss: 0.0000; train_global_loss: 967318.3788; train_optim_loss: 967318.3788; val_kl_reg_loss: 27595.8348; val_edge_recon_loss: 108248.7152; val_gene_expr_recon_loss: 815176.6328; val_masked_gp_l1_reg_loss: 7612.9194; val_group_lasso_reg_loss: 0.0000; val_global_loss: 958634.1224; val_optim_loss: 958634.1224
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9052; val_auprc_score: 0.9800; val_best_acc_score: 0.8959; val_best_f1_score: 0.9412; train_kl_reg_loss: 26848.0051; train_edge_recon_loss: 104155.5608; train_gene_expr_recon_loss: 807645.2922; train_masked_gp_l1_reg_loss: 7774.9850; train_group_lasso_reg_loss: 0.0000; train_global_loss: 946423.8453; train_optim_loss: 946423.8453; val_kl_reg_loss: 26280.1943; val_edge_recon_loss: 100984.8317; val_gene_expr_recon_loss: 800345.1849; val_masked_gp_l1_reg_loss: 7934.9492; val_group_lasso_reg_loss: 0.0000; val_global_loss: 935545.1510; val_optim_loss: 935545.1510
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9132; val_auprc_score: 0.9813; val_best_acc_score: 0.9002; val_best_f1_score: 0.9425; train_kl_reg_loss: 24604.6099; train_edge_recon_loss: 100313.6835; train_gene_expr_recon_loss: 792191.8756; train_masked_gp_l1_reg_loss: 8083.3270; train_group_lasso_reg_loss: 0.0000; train_global_loss: 925193.4968; train_optim_loss: 925193.4968; val_kl_reg_loss: 23926.1960; val_edge_recon_loss: 101931.2643; val_gene_expr_recon_loss: 782688.6823; val_masked_gp_l1_reg_loss: 8226.2998; val_group_lasso_reg_loss: 0.0000; val_global_loss: 916772.4583; val_optim_loss: 916772.4583
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9185; val_auprc_score: 0.9824; val_best_acc_score: 0.9041; val_best_f1_score: 0.9446; train_kl_reg_loss: 22553.7671; train_edge_recon_loss: 97456.4933; train_gene_expr_recon_loss: 778090.9994; train_masked_gp_l1_reg_loss: 8354.7514; train_group_lasso_reg_loss: 0.0000; train_global_loss: 906456.0131; train_optim_loss: 906456.0131; val_kl_reg_loss: 21654.1332; val_edge_recon_loss: 100683.3574; val_gene_expr_recon_loss: 769108.7057; val_masked_gp_l1_reg_loss: 8472.8457; val_group_lasso_reg_loss: 0.0000; val_global_loss: 899919.0729; val_optim_loss: 899919.0729
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9245; val_auprc_score: 0.9838; val_best_acc_score: 0.9126; val_best_f1_score: 0.9505; train_kl_reg_loss: 20603.1763; train_edge_recon_loss: 96598.3448; train_gene_expr_recon_loss: 765341.0395; train_masked_gp_l1_reg_loss: 8571.6702; train_group_lasso_reg_loss: 0.0000; train_global_loss: 891114.2302; train_optim_loss: 891114.2302; val_kl_reg_loss: 19471.8674; val_edge_recon_loss: 94057.6139; val_gene_expr_recon_loss: 757361.2839; val_masked_gp_l1_reg_loss: 8659.6738; val_group_lasso_reg_loss: 0.0000; val_global_loss: 879550.4531; val_optim_loss: 879550.4531
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9315; val_auprc_score: 0.9853; val_best_acc_score: 0.9116; val_best_f1_score: 0.9493; train_kl_reg_loss: 18724.1875; train_edge_recon_loss: 94509.2072; train_gene_expr_recon_loss: 753598.1471; train_masked_gp_l1_reg_loss: 8726.5652; train_group_lasso_reg_loss: 0.0000; train_global_loss: 875558.1052; train_optim_loss: 875558.1052; val_kl_reg_loss: 17771.4125; val_edge_recon_loss: 94029.6331; val_gene_expr_recon_loss: 746371.5677; val_masked_gp_l1_reg_loss: 8782.2832; val_group_lasso_reg_loss: 0.0000; val_global_loss: 866954.9245; val_optim_loss: 866954.9245
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9302; val_auprc_score: 0.9851; val_best_acc_score: 0.9194; val_best_f1_score: 0.9538; train_kl_reg_loss: 16893.3290; train_edge_recon_loss: 92416.2186; train_gene_expr_recon_loss: 742957.6233; train_masked_gp_l1_reg_loss: 8811.1947; train_group_lasso_reg_loss: 0.0000; train_global_loss: 861078.3657; train_optim_loss: 861078.3657; val_kl_reg_loss: 15978.9025; val_edge_recon_loss: 91004.5163; val_gene_expr_recon_loss: 736251.4349; val_masked_gp_l1_reg_loss: 8827.6709; val_group_lasso_reg_loss: 0.0000; val_global_loss: 852062.5391; val_optim_loss: 852062.5391
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9295; val_auprc_score: 0.9836; val_best_acc_score: 0.9192; val_best_f1_score: 0.9539; train_kl_reg_loss: 15314.5327; train_edge_recon_loss: 90590.7939; train_gene_expr_recon_loss: 733380.3712; train_masked_gp_l1_reg_loss: 8821.8591; train_group_lasso_reg_loss: 0.0000; train_global_loss: 848107.5570; train_optim_loss: 848107.5570; val_kl_reg_loss: 14552.1805; val_edge_recon_loss: 91156.3219; val_gene_expr_recon_loss: 727079.2969; val_masked_gp_l1_reg_loss: 8801.3965; val_group_lasso_reg_loss: 0.0000; val_global_loss: 841589.1797; val_optim_loss: 841589.1797
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9384; val_auprc_score: 0.9857; val_best_acc_score: 0.9195; val_best_f1_score: 0.9536; train_kl_reg_loss: 13855.8813; train_edge_recon_loss: 88385.7228; train_gene_expr_recon_loss: 724123.5631; train_masked_gp_l1_reg_loss: 8754.3381; train_group_lasso_reg_loss: 0.0000; train_global_loss: 835119.5078; train_optim_loss: 835119.5078; val_kl_reg_loss: 13216.8186; val_edge_recon_loss: 90742.2829; val_gene_expr_recon_loss: 718568.2448; val_masked_gp_l1_reg_loss: 8694.1719; val_group_lasso_reg_loss: 0.0000; val_global_loss: 831221.5286; val_optim_loss: 831221.5286
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9374; val_auprc_score: 0.9849; val_best_acc_score: 0.9260; val_best_f1_score: 0.9571; train_kl_reg_loss: 12612.3248; train_edge_recon_loss: 87390.5849; train_gene_expr_recon_loss: 716101.8468; train_masked_gp_l1_reg_loss: 8617.6492; train_group_lasso_reg_loss: 0.0000; train_global_loss: 824722.4038; train_optim_loss: 824722.4038; val_kl_reg_loss: 12125.1523; val_edge_recon_loss: 90050.7975; val_gene_expr_recon_loss: 710869.8594; val_masked_gp_l1_reg_loss: 8537.6484; val_group_lasso_reg_loss: 0.0000; val_global_loss: 821583.4375; val_optim_loss: 821583.4375
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9421; val_auprc_score: 0.9867; val_best_acc_score: 0.9267; val_best_f1_score: 0.9576; train_kl_reg_loss: 11538.2012; train_edge_recon_loss: 85216.2241; train_gene_expr_recon_loss: 708618.7500; train_masked_gp_l1_reg_loss: 8437.6336; train_group_lasso_reg_loss: 0.0000; train_global_loss: 813810.8102; train_optim_loss: 813810.8102; val_kl_reg_loss: 11044.6030; val_edge_recon_loss: 87821.9193; val_gene_expr_recon_loss: 704059.4557; val_masked_gp_l1_reg_loss: 8340.1357; val_group_lasso_reg_loss: 0.0000; val_global_loss: 811266.1068; val_optim_loss: 811266.1068
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9464; val_auprc_score: 0.9874; val_best_acc_score: 0.9272; val_best_f1_score: 0.9578; train_kl_reg_loss: 10659.5858; train_edge_recon_loss: 83914.2796; train_gene_expr_recon_loss: 701674.1503; train_masked_gp_l1_reg_loss: 8227.9054; train_group_lasso_reg_loss: 0.0000; train_global_loss: 804475.9212; train_optim_loss: 804475.9212; val_kl_reg_loss: 10376.1231; val_edge_recon_loss: 86794.8659; val_gene_expr_recon_loss: 697103.9245; val_masked_gp_l1_reg_loss: 8110.4697; val_group_lasso_reg_loss: 0.0000; val_global_loss: 802385.4193; val_optim_loss: 802385.4193
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9467; val_auprc_score: 0.9879; val_best_acc_score: 0.9313; val_best_f1_score: 0.9601; train_kl_reg_loss: 10035.8213; train_edge_recon_loss: 83116.3885; train_gene_expr_recon_loss: 695526.0186; train_masked_gp_l1_reg_loss: 7996.7468; train_group_lasso_reg_loss: 0.0000; train_global_loss: 796674.9770; train_optim_loss: 796674.9770; val_kl_reg_loss: 9782.3714; val_edge_recon_loss: 84777.7721; val_gene_expr_recon_loss: 691408.3073; val_masked_gp_l1_reg_loss: 7882.7285; val_group_lasso_reg_loss: 0.0000; val_global_loss: 793851.1979; val_optim_loss: 793851.1979
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9505; val_auprc_score: 0.9892; val_best_acc_score: 0.9381; val_best_f1_score: 0.9643; train_kl_reg_loss: 9537.4381; train_edge_recon_loss: 82716.6843; train_gene_expr_recon_loss: 689813.7006; train_masked_gp_l1_reg_loss: 7768.0239; train_group_lasso_reg_loss: 0.0000; train_global_loss: 789835.8506; train_optim_loss: 789835.8506; val_kl_reg_loss: 9380.4681; val_edge_recon_loss: 79689.5062; val_gene_expr_recon_loss: 686420.4401; val_masked_gp_l1_reg_loss: 7655.3618; val_group_lasso_reg_loss: 0.0000; val_global_loss: 783145.7891; val_optim_loss: 783145.7891
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9485; val_auprc_score: 0.9887; val_best_acc_score: 0.9329; val_best_f1_score: 0.9611; train_kl_reg_loss: 9166.3561; train_edge_recon_loss: 82348.9241; train_gene_expr_recon_loss: 684490.6933; train_masked_gp_l1_reg_loss: 7548.8128; train_group_lasso_reg_loss: 0.0000; train_global_loss: 783554.7863; train_optim_loss: 783554.7863; val_kl_reg_loss: 9072.8118; val_edge_recon_loss: 83475.4827; val_gene_expr_recon_loss: 680912.6875; val_masked_gp_l1_reg_loss: 7441.5469; val_group_lasso_reg_loss: 0.0000; val_global_loss: 780902.5495; val_optim_loss: 780902.5495
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9543; val_auprc_score: 0.9894; val_best_acc_score: 0.9366; val_best_f1_score: 0.9632; train_kl_reg_loss: 8887.5796; train_edge_recon_loss: 81242.6007; train_gene_expr_recon_loss: 679517.7892; train_masked_gp_l1_reg_loss: 7348.3145; train_group_lasso_reg_loss: 0.0000; train_global_loss: 776996.2881; train_optim_loss: 776996.2881; val_kl_reg_loss: 8729.7993; val_edge_recon_loss: 82153.4014; val_gene_expr_recon_loss: 675913.5104; val_masked_gp_l1_reg_loss: 7251.8481; val_group_lasso_reg_loss: 0.0000; val_global_loss: 774048.5807; val_optim_loss: 774048.5807
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9486; val_auprc_score: 0.9876; val_best_acc_score: 0.9386; val_best_f1_score: 0.9643; train_kl_reg_loss: 8636.6376; train_edge_recon_loss: 81866.9834; train_gene_expr_recon_loss: 675094.0866; train_masked_gp_l1_reg_loss: 7167.1472; train_group_lasso_reg_loss: 0.0000; train_global_loss: 772764.8593; train_optim_loss: 772764.8593; val_kl_reg_loss: 8465.1434; val_edge_recon_loss: 83045.0150; val_gene_expr_recon_loss: 672412.5651; val_masked_gp_l1_reg_loss: 7077.1729; val_group_lasso_reg_loss: 0.0000; val_global_loss: 770999.9115; val_optim_loss: 770999.9115
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9515; val_auprc_score: 0.9891; val_best_acc_score: 0.9386; val_best_f1_score: 0.9642; train_kl_reg_loss: 8449.3419; train_edge_recon_loss: 80232.6860; train_gene_expr_recon_loss: 670997.8233; train_masked_gp_l1_reg_loss: 7000.8808; train_group_lasso_reg_loss: 0.0000; train_global_loss: 766680.7326; train_optim_loss: 766680.7326; val_kl_reg_loss: 8369.3066; val_edge_recon_loss: 82661.9834; val_gene_expr_recon_loss: 668072.1146; val_masked_gp_l1_reg_loss: 6923.7036; val_group_lasso_reg_loss: 0.0000; val_global_loss: 766027.0911; val_optim_loss: 766027.0911
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9571; val_auprc_score: 0.9898; val_best_acc_score: 0.9454; val_best_f1_score: 0.9683; train_kl_reg_loss: 8313.2903; train_edge_recon_loss: 81059.3491; train_gene_expr_recon_loss: 667194.3494; train_masked_gp_l1_reg_loss: 6851.2588; train_group_lasso_reg_loss: 0.0000; train_global_loss: 763418.2442; train_optim_loss: 763418.2442; val_kl_reg_loss: 8130.5539; val_edge_recon_loss: 80589.1095; val_gene_expr_recon_loss: 663967.4505; val_masked_gp_l1_reg_loss: 6777.2266; val_group_lasso_reg_loss: 0.0000; val_global_loss: 759464.3698; val_optim_loss: 759464.3698
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9490; val_auprc_score: 0.9882; val_best_acc_score: 0.9350; val_best_f1_score: 0.9626; train_kl_reg_loss: 6705.6165; train_edge_recon_loss: 80405.3312; train_gene_expr_recon_loss: 694813.2628; train_masked_gp_l1_reg_loss: 6794.7938; train_group_lasso_reg_loss: 0.0000; train_global_loss: 788719.0047; train_optim_loss: 788719.0047; val_kl_reg_loss: 5810.9499; val_edge_recon_loss: 81215.5199; val_gene_expr_recon_loss: 682721.6615; val_masked_gp_l1_reg_loss: 6661.3379; val_group_lasso_reg_loss: 0.0000; val_global_loss: 776409.4453; val_optim_loss: 776409.4453
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9525; val_auprc_score: 0.9895; val_best_acc_score: 0.9388; val_best_f1_score: 0.9645; train_kl_reg_loss: 6427.9729; train_edge_recon_loss: 80390.6287; train_gene_expr_recon_loss: 681042.1680; train_masked_gp_l1_reg_loss: 6554.6188; train_group_lasso_reg_loss: 0.0000; train_global_loss: 774415.3860; train_optim_loss: 774415.3860; val_kl_reg_loss: 5849.6470; val_edge_recon_loss: 80403.0060; val_gene_expr_recon_loss: 678306.0651; val_masked_gp_l1_reg_loss: 6458.6445; val_group_lasso_reg_loss: 0.0000; val_global_loss: 771017.3438; val_optim_loss: 771017.3438
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9487; val_auprc_score: 0.9885; val_best_acc_score: 0.9373; val_best_f1_score: 0.9638; train_kl_reg_loss: 6261.3692; train_edge_recon_loss: 79661.4996; train_gene_expr_recon_loss: 676868.2372; train_masked_gp_l1_reg_loss: 6372.1272; train_group_lasso_reg_loss: 0.0000; train_global_loss: 769163.2314; train_optim_loss: 769163.2314; val_kl_reg_loss: 5928.0418; val_edge_recon_loss: 80328.2035; val_gene_expr_recon_loss: 673842.6667; val_masked_gp_l1_reg_loss: 6292.8540; val_group_lasso_reg_loss: 0.0000; val_global_loss: 766391.7786; val_optim_loss: 766391.7786
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9537; val_auprc_score: 0.9896; val_best_acc_score: 0.9408; val_best_f1_score: 0.9656; train_kl_reg_loss: 6165.3724; train_edge_recon_loss: 79429.8077; train_gene_expr_recon_loss: 673507.5878; train_masked_gp_l1_reg_loss: 6226.4404; train_group_lasso_reg_loss: 0.0000; train_global_loss: 765329.2134; train_optim_loss: 765329.2134; val_kl_reg_loss: 5911.8210; val_edge_recon_loss: 80284.4840; val_gene_expr_recon_loss: 671365.7240; val_masked_gp_l1_reg_loss: 6163.7900; val_group_lasso_reg_loss: 0.0000; val_global_loss: 763725.8464; val_optim_loss: 763725.8464

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9551; val_auprc_score: 0.9905; val_best_acc_score: 0.9433; val_best_f1_score: 0.9672; train_kl_reg_loss: 6121.4888; train_edge_recon_loss: 79335.8255; train_gene_expr_recon_loss: 670944.4360; train_masked_gp_l1_reg_loss: 6111.6432; train_group_lasso_reg_loss: 0.0000; train_global_loss: 762513.3956; train_optim_loss: 762513.3956; val_kl_reg_loss: 5886.3563; val_edge_recon_loss: 77336.5926; val_gene_expr_recon_loss: 670447.0260; val_masked_gp_l1_reg_loss: 6099.4082; val_group_lasso_reg_loss: 0.0000; val_global_loss: 759769.4141; val_optim_loss: 759769.4141
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9494; val_auprc_score: 0.9879; val_best_acc_score: 0.9396; val_best_f1_score: 0.9651; train_kl_reg_loss: 6117.9341; train_edge_recon_loss: 79430.5885; train_gene_expr_recon_loss: 670706.9448; train_masked_gp_l1_reg_loss: 6092.8162; train_group_lasso_reg_loss: 0.0000; train_global_loss: 762348.2843; train_optim_loss: 762348.2843; val_kl_reg_loss: 5891.6086; val_edge_recon_loss: 79852.6426; val_gene_expr_recon_loss: 669638.8828; val_masked_gp_l1_reg_loss: 6086.3262; val_group_lasso_reg_loss: 0.0000; val_global_loss: 761469.4453; val_optim_loss: 761469.4453
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9553; val_auprc_score: 0.9902; val_best_acc_score: 0.9398; val_best_f1_score: 0.9650; train_kl_reg_loss: 6109.7548; train_edge_recon_loss: 78902.1464; train_gene_expr_recon_loss: 670246.6642; train_masked_gp_l1_reg_loss: 6080.0256; train_group_lasso_reg_loss: 0.0000; train_global_loss: 761338.5890; train_optim_loss: 761338.5890; val_kl_reg_loss: 5894.1520; val_edge_recon_loss: 80225.9808; val_gene_expr_recon_loss: 669378.9245; val_masked_gp_l1_reg_loss: 6073.7178; val_group_lasso_reg_loss: 0.0000; val_global_loss: 761572.7422; val_optim_loss: 761572.7422
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9538; val_auprc_score: 0.9894; val_best_acc_score: 0.9408; val_best_f1_score: 0.9655; train_kl_reg_loss: 6099.7807; train_edge_recon_loss: 79082.7259; train_gene_expr_recon_loss: 669782.2660; train_masked_gp_l1_reg_loss: 6066.6733; train_group_lasso_reg_loss: 0.0000; train_global_loss: 761031.4436; train_optim_loss: 761031.4436; val_kl_reg_loss: 5898.0004; val_edge_recon_loss: 80469.5273; val_gene_expr_recon_loss: 668861.8177; val_masked_gp_l1_reg_loss: 6060.4580; val_group_lasso_reg_loss: 0.0000; val_global_loss: 761289.7786; val_optim_loss: 761289.7786

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 76 min 59 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9469
Val AUPRC score: 0.9882
Val best accuracy score: 0.9321
Val best F1 score: 0.9606
Val gene expr MSE score: 60355.7363
Val cat covariate0 mean sim diff: -0.0050

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
