[True]
Run timestamp: 09102023_215819_51.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_51']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7376; val_auprc_score: 0.7194; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 41093.2602; train_edge_recon_loss: 3500353.6023; train_gene_expr_recon_loss: 14029993.1667; train_masked_gp_l1_reg_loss: 32546.5363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3717409.6705; train_chrom_access_recon_loss: 3005345.5985; train_global_loss: 24326741.7576; train_optim_loss: 24326741.7576; val_kl_reg_loss: 92039.2080; val_edge_recon_loss: 4064921.0625; val_gene_expr_recon_loss: 12935182.8750; val_masked_gp_l1_reg_loss: 39460.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2151057.5000; val_chrom_access_recon_loss: 2853161.0625; val_global_loss: 22135822.0000; val_optim_loss: 22135822.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6979; val_auprc_score: 0.6769; val_best_acc_score: 0.6026; val_best_f1_score: 0.6975; train_kl_reg_loss: 82212.0040; train_edge_recon_loss: 3510515.3750; train_gene_expr_recon_loss: 12854907.5303; train_masked_gp_l1_reg_loss: 40797.7659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1210841.0938; train_chrom_access_recon_loss: 2847505.4167; train_global_loss: 20546779.1212; train_optim_loss: 20546779.1212; val_kl_reg_loss: 82064.3506; val_edge_recon_loss: 4057909.3438; val_gene_expr_recon_loss: 12585146.3750; val_masked_gp_l1_reg_loss: 42266.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 605042.6250; val_chrom_access_recon_loss: 2794192.6250; val_global_loss: 20166621.7500; val_optim_loss: 20166621.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7683; val_auprc_score: 0.7337; val_best_acc_score: 0.6768; val_best_f1_score: 0.7348; train_kl_reg_loss: 77914.4335; train_edge_recon_loss: 3505050.8750; train_gene_expr_recon_loss: 12673960.3788; train_masked_gp_l1_reg_loss: 43684.0873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 402069.0327; train_chrom_access_recon_loss: 2818255.4735; train_global_loss: 19520934.0303; train_optim_loss: 19520934.0303; val_kl_reg_loss: 75579.8916; val_edge_recon_loss: 3991795.9062; val_gene_expr_recon_loss: 12484330.5000; val_masked_gp_l1_reg_loss: 45055.6445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 268559.5625; val_chrom_access_recon_loss: 2753331.4688; val_global_loss: 19618653.5000; val_optim_loss: 19618653.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8075; val_auprc_score: 0.7920; val_best_acc_score: 0.7265; val_best_f1_score: 0.7589; train_kl_reg_loss: 56993.1866; train_edge_recon_loss: 3393678.0265; train_gene_expr_recon_loss: 12613725.9242; train_masked_gp_l1_reg_loss: 46731.8574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 211378.6913; train_chrom_access_recon_loss: 2804392.3977; train_global_loss: 19126900.0909; train_optim_loss: 19126900.0909; val_kl_reg_loss: 52854.1494; val_edge_recon_loss: 3208912.8125; val_gene_expr_recon_loss: 12543452.1250; val_masked_gp_l1_reg_loss: 49185.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168203.0469; val_chrom_access_recon_loss: 2767951.5938; val_global_loss: 18790560.0000; val_optim_loss: 18790560.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8798; val_auprc_score: 0.8467; val_best_acc_score: 0.8125; val_best_f1_score: 0.8250; train_kl_reg_loss: 75259.0681; train_edge_recon_loss: 2977997.6212; train_gene_expr_recon_loss: 12565333.5303; train_masked_gp_l1_reg_loss: 51989.1776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145872.2526; train_chrom_access_recon_loss: 2793185.9318; train_global_loss: 18609637.6364; train_optim_loss: 18609637.6364; val_kl_reg_loss: 86533.0996; val_edge_recon_loss: 2937467.3438; val_gene_expr_recon_loss: 12390553.3750; val_masked_gp_l1_reg_loss: 54558.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131061.9297; val_chrom_access_recon_loss: 2769535.2812; val_global_loss: 18369708.7500; val_optim_loss: 18369708.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8862; val_auprc_score: 0.8484; val_best_acc_score: 0.8224; val_best_f1_score: 0.8391; train_kl_reg_loss: 96701.8724; train_edge_recon_loss: 2827461.4129; train_gene_expr_recon_loss: 12449574.2727; train_masked_gp_l1_reg_loss: 55823.5910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122113.6683; train_chrom_access_recon_loss: 2776143.2879; train_global_loss: 18327818.0303; train_optim_loss: 18327818.0303; val_kl_reg_loss: 95544.0146; val_edge_recon_loss: 2856588.5312; val_gene_expr_recon_loss: 12406906.1250; val_masked_gp_l1_reg_loss: 57126.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113212.8516; val_chrom_access_recon_loss: 2730910.0938; val_global_loss: 18260289.0000; val_optim_loss: 18260289.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9015; val_auprc_score: 0.8637; val_best_acc_score: 0.8455; val_best_f1_score: 0.8553; train_kl_reg_loss: 96119.1166; train_edge_recon_loss: 2827002.1402; train_gene_expr_recon_loss: 12377568.7879; train_masked_gp_l1_reg_loss: 58169.7204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106393.6785; train_chrom_access_recon_loss: 2759509.6932; train_global_loss: 18224763.1818; train_optim_loss: 18224763.1818; val_kl_reg_loss: 92483.4561; val_edge_recon_loss: 2810950.0312; val_gene_expr_recon_loss: 12284912.1250; val_masked_gp_l1_reg_loss: 59241.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100580.9297; val_chrom_access_recon_loss: 2717105.0625; val_global_loss: 18065272.5000; val_optim_loss: 18065272.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8989; val_auprc_score: 0.8656; val_best_acc_score: 0.8391; val_best_f1_score: 0.8481; train_kl_reg_loss: 93114.2006; train_edge_recon_loss: 2809362.2917; train_gene_expr_recon_loss: 12323035.5152; train_masked_gp_l1_reg_loss: 60108.8018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96188.0321; train_chrom_access_recon_loss: 2748289.8333; train_global_loss: 18130098.7879; train_optim_loss: 18130098.7879; val_kl_reg_loss: 95630.4102; val_edge_recon_loss: 2830047.0625; val_gene_expr_recon_loss: 12263816.5000; val_masked_gp_l1_reg_loss: 61117.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93509.1406; val_chrom_access_recon_loss: 2711347.3750; val_global_loss: 18055468.7500; val_optim_loss: 18055468.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9111; val_auprc_score: 0.8775; val_best_acc_score: 0.8546; val_best_f1_score: 0.8654; train_kl_reg_loss: 92982.2098; train_edge_recon_loss: 2804928.2008; train_gene_expr_recon_loss: 12261900.2424; train_masked_gp_l1_reg_loss: 61913.4933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90823.4257; train_chrom_access_recon_loss: 2736366.1402; train_global_loss: 18048913.7879; train_optim_loss: 18048913.7879; val_kl_reg_loss: 91176.9219; val_edge_recon_loss: 2786480.4062; val_gene_expr_recon_loss: 12173855.8750; val_masked_gp_l1_reg_loss: 62766.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88798.3516; val_chrom_access_recon_loss: 2718544.8125; val_global_loss: 17921623.2500; val_optim_loss: 17921623.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9020; val_auprc_score: 0.8714; val_best_acc_score: 0.8434; val_best_f1_score: 0.8551; train_kl_reg_loss: 90693.7455; train_edge_recon_loss: 2796110.7235; train_gene_expr_recon_loss: 12205276.9848; train_masked_gp_l1_reg_loss: 63414.0887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85972.0251; train_chrom_access_recon_loss: 2724895.9015; train_global_loss: 17966363.2424; train_optim_loss: 17966363.2424; val_kl_reg_loss: 90524.7637; val_edge_recon_loss: 2825832.9062; val_gene_expr_recon_loss: 12115745.0000; val_masked_gp_l1_reg_loss: 64176.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84285.7109; val_chrom_access_recon_loss: 2694902.4688; val_global_loss: 17875467.0000; val_optim_loss: 17875467.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9089; val_auprc_score: 0.8722; val_best_acc_score: 0.8493; val_best_f1_score: 0.8616; train_kl_reg_loss: 88565.6746; train_edge_recon_loss: 2790464.3977; train_gene_expr_recon_loss: 12160277.6515; train_masked_gp_l1_reg_loss: 64759.2335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82003.8770; train_chrom_access_recon_loss: 2717779.8750; train_global_loss: 17903850.7576; train_optim_loss: 17903850.7576; val_kl_reg_loss: 85484.5791; val_edge_recon_loss: 2837888.2500; val_gene_expr_recon_loss: 12051388.5000; val_masked_gp_l1_reg_loss: 65485.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81014.5625; val_chrom_access_recon_loss: 2711641.5625; val_global_loss: 17832903.7500; val_optim_loss: 17832903.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9111; val_auprc_score: 0.8782; val_best_acc_score: 0.8581; val_best_f1_score: 0.8666; train_kl_reg_loss: 86279.0827; train_edge_recon_loss: 2787616.3561; train_gene_expr_recon_loss: 12108045.4848; train_masked_gp_l1_reg_loss: 66069.1737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79047.2157; train_chrom_access_recon_loss: 2707005.3333; train_global_loss: 17834062.5758; train_optim_loss: 17834062.5758; val_kl_reg_loss: 88810.2959; val_edge_recon_loss: 2768532.0312; val_gene_expr_recon_loss: 12057320.5000; val_masked_gp_l1_reg_loss: 66612.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77838.2109; val_chrom_access_recon_loss: 2697464.0312; val_global_loss: 17756576.7500; val_optim_loss: 17756576.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9153; val_auprc_score: 0.8856; val_best_acc_score: 0.8579; val_best_f1_score: 0.8682; train_kl_reg_loss: 85931.7589; train_edge_recon_loss: 2780673.1553; train_gene_expr_recon_loss: 12077349.0909; train_masked_gp_l1_reg_loss: 67072.3757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76135.6104; train_chrom_access_recon_loss: 2699467.3030; train_global_loss: 17786629.1818; train_optim_loss: 17786629.1818; val_kl_reg_loss: 87638.7197; val_edge_recon_loss: 2776590.0312; val_gene_expr_recon_loss: 11993997.2500; val_masked_gp_l1_reg_loss: 67525.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74965.6641; val_chrom_access_recon_loss: 2663654.2812; val_global_loss: 17664371.2500; val_optim_loss: 17664371.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9169; val_auprc_score: 0.8929; val_best_acc_score: 0.8573; val_best_f1_score: 0.8652; train_kl_reg_loss: 81707.4759; train_edge_recon_loss: 2794942.0795; train_gene_expr_recon_loss: 12019760.2576; train_masked_gp_l1_reg_loss: 68026.0380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74173.3718; train_chrom_access_recon_loss: 2686847.3598; train_global_loss: 17725456.6061; train_optim_loss: 17725456.6061; val_kl_reg_loss: 82426.4453; val_edge_recon_loss: 2824924.5938; val_gene_expr_recon_loss: 11958734.2500; val_masked_gp_l1_reg_loss: 68586.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73157.4609; val_chrom_access_recon_loss: 2669451.1875; val_global_loss: 17677280.7500; val_optim_loss: 17677280.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9100; val_auprc_score: 0.8849; val_best_acc_score: 0.8477; val_best_f1_score: 0.8583; train_kl_reg_loss: 81553.5908; train_edge_recon_loss: 2782394.5795; train_gene_expr_recon_loss: 12001784.7727; train_masked_gp_l1_reg_loss: 68995.4349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72177.2944; train_chrom_access_recon_loss: 2683389.0758; train_global_loss: 17690294.8788; train_optim_loss: 17690294.8788; val_kl_reg_loss: 81145.7158; val_edge_recon_loss: 2846982.2500; val_gene_expr_recon_loss: 11899785.8750; val_masked_gp_l1_reg_loss: 69636.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72058.4219; val_chrom_access_recon_loss: 2650712.6250; val_global_loss: 17620321.7500; val_optim_loss: 17620321.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9188; val_auprc_score: 0.8941; val_best_acc_score: 0.8619; val_best_f1_score: 0.8699; train_kl_reg_loss: 79292.6789; train_edge_recon_loss: 2766095.2538; train_gene_expr_recon_loss: 11968171.7424; train_masked_gp_l1_reg_loss: 69986.3554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71132.0753; train_chrom_access_recon_loss: 2675792.7311; train_global_loss: 17630470.7273; train_optim_loss: 17630470.7273; val_kl_reg_loss: 77387.4365; val_edge_recon_loss: 2787949.4688; val_gene_expr_recon_loss: 11934920.3750; val_masked_gp_l1_reg_loss: 70416.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70376.7578; val_chrom_access_recon_loss: 2666940.1562; val_global_loss: 17607990.5000; val_optim_loss: 17607990.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9238; val_auprc_score: 0.8967; val_best_acc_score: 0.8678; val_best_f1_score: 0.8767; train_kl_reg_loss: 77400.1706; train_edge_recon_loss: 2783260.6402; train_gene_expr_recon_loss: 11936419.3182; train_masked_gp_l1_reg_loss: 70880.8542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69666.1641; train_chrom_access_recon_loss: 2667861.1970; train_global_loss: 17605488.4848; train_optim_loss: 17605488.4848; val_kl_reg_loss: 77518.6465; val_edge_recon_loss: 2785301.5312; val_gene_expr_recon_loss: 11859185.7500; val_masked_gp_l1_reg_loss: 71331.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69180.1484; val_chrom_access_recon_loss: 2657173.0000; val_global_loss: 17519690.7500; val_optim_loss: 17519690.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9194; val_auprc_score: 0.8930; val_best_acc_score: 0.8579; val_best_f1_score: 0.8687; train_kl_reg_loss: 77767.2551; train_edge_recon_loss: 2768020.3561; train_gene_expr_recon_loss: 11897778.1970; train_masked_gp_l1_reg_loss: 71674.1161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68841.4788; train_chrom_access_recon_loss: 2660614.0227; train_global_loss: 17544695.4848; train_optim_loss: 17544695.4848; val_kl_reg_loss: 77932.2451; val_edge_recon_loss: 2809645.4688; val_gene_expr_recon_loss: 11825316.5000; val_masked_gp_l1_reg_loss: 71974.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68656.8438; val_chrom_access_recon_loss: 2636116.0625; val_global_loss: 17489641.2500; val_optim_loss: 17489641.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9176; val_auprc_score: 0.8882; val_best_acc_score: 0.8557; val_best_f1_score: 0.8640; train_kl_reg_loss: 77610.5697; train_edge_recon_loss: 2746216.7121; train_gene_expr_recon_loss: 11863775.3636; train_masked_gp_l1_reg_loss: 72411.7199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68502.4395; train_chrom_access_recon_loss: 2652253.3220; train_global_loss: 17480770.0606; train_optim_loss: 17480770.0606; val_kl_reg_loss: 75247.9424; val_edge_recon_loss: 2808143.7188; val_gene_expr_recon_loss: 11777130.8750; val_masked_gp_l1_reg_loss: 72859.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67681.7578; val_chrom_access_recon_loss: 2624268.1250; val_global_loss: 17425331.2500; val_optim_loss: 17425331.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9258; val_auprc_score: 0.8984; val_best_acc_score: 0.8651; val_best_f1_score: 0.8736; train_kl_reg_loss: 76767.9205; train_edge_recon_loss: 2747849.1629; train_gene_expr_recon_loss: 11847627.2879; train_masked_gp_l1_reg_loss: 73047.5124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67619.5829; train_chrom_access_recon_loss: 2649877.4811; train_global_loss: 17462789.0909; train_optim_loss: 17462789.0909; val_kl_reg_loss: 74428.6465; val_edge_recon_loss: 2787910.8125; val_gene_expr_recon_loss: 11712653.5000; val_masked_gp_l1_reg_loss: 73410.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67662.0469; val_chrom_access_recon_loss: 2633609.0000; val_global_loss: 17349674.0000; val_optim_loss: 17349674.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9201; val_auprc_score: 0.8963; val_best_acc_score: 0.8600; val_best_f1_score: 0.8683; train_kl_reg_loss: 76608.9809; train_edge_recon_loss: 2741958.5871; train_gene_expr_recon_loss: 11820473.5455; train_masked_gp_l1_reg_loss: 73698.4067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67484.2157; train_chrom_access_recon_loss: 2642351.4356; train_global_loss: 17422575.4091; train_optim_loss: 17422575.4091; val_kl_reg_loss: 76472.4805; val_edge_recon_loss: 2804318.6875; val_gene_expr_recon_loss: 11734415.8750; val_masked_gp_l1_reg_loss: 74058.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67341.5391; val_chrom_access_recon_loss: 2611744.8438; val_global_loss: 17368353.1250; val_optim_loss: 17368353.1250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9291; val_auprc_score: 0.9041; val_best_acc_score: 0.8737; val_best_f1_score: 0.8805; train_kl_reg_loss: 75608.3648; train_edge_recon_loss: 2739065.2803; train_gene_expr_recon_loss: 11801597.9394; train_masked_gp_l1_reg_loss: 74256.1089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67182.7122; train_chrom_access_recon_loss: 2639645.8826; train_global_loss: 17397356.1970; train_optim_loss: 17397356.1970; val_kl_reg_loss: 75518.8135; val_edge_recon_loss: 2782285.0938; val_gene_expr_recon_loss: 11823000.2500; val_masked_gp_l1_reg_loss: 74537.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67225.1953; val_chrom_access_recon_loss: 2633622.9062; val_global_loss: 17456189.7500; val_optim_loss: 17456189.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9237; val_auprc_score: 0.8928; val_best_acc_score: 0.8651; val_best_f1_score: 0.8743; train_kl_reg_loss: 76377.8714; train_edge_recon_loss: 2735735.0720; train_gene_expr_recon_loss: 11780302.9242; train_masked_gp_l1_reg_loss: 74734.8170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67113.4599; train_chrom_access_recon_loss: 2633675.4886; train_global_loss: 17367939.7273; train_optim_loss: 17367939.7273; val_kl_reg_loss: 73817.7949; val_edge_recon_loss: 2764629.0625; val_gene_expr_recon_loss: 11726111.1250; val_masked_gp_l1_reg_loss: 74954.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67559.1406; val_chrom_access_recon_loss: 2619996.7500; val_global_loss: 17327067.2500; val_optim_loss: 17327067.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9222; val_auprc_score: 0.8992; val_best_acc_score: 0.8584; val_best_f1_score: 0.8674; train_kl_reg_loss: 75769.7918; train_edge_recon_loss: 2720573.9318; train_gene_expr_recon_loss: 11758337.7424; train_masked_gp_l1_reg_loss: 75200.0573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67581.8655; train_chrom_access_recon_loss: 2626801.0833; train_global_loss: 17324264.5152; train_optim_loss: 17324264.5152; val_kl_reg_loss: 73017.1328; val_edge_recon_loss: 2790511.7188; val_gene_expr_recon_loss: 11683589.8750; val_masked_gp_l1_reg_loss: 75404.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67473.5391; val_chrom_access_recon_loss: 2606868.7188; val_global_loss: 17296865.5000; val_optim_loss: 17296865.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9280; val_auprc_score: 0.9061; val_best_acc_score: 0.8697; val_best_f1_score: 0.8761; train_kl_reg_loss: 74911.2215; train_edge_recon_loss: 2734192.1629; train_gene_expr_recon_loss: 11729251.7576; train_masked_gp_l1_reg_loss: 75652.0611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67591.2776; train_chrom_access_recon_loss: 2622034.7083; train_global_loss: 17303633.1061; train_optim_loss: 17303633.1061; val_kl_reg_loss: 74810.7158; val_edge_recon_loss: 2769743.3438; val_gene_expr_recon_loss: 11578437.8750; val_masked_gp_l1_reg_loss: 75803.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67610.0625; val_chrom_access_recon_loss: 2592649.7500; val_global_loss: 17159054.7500; val_optim_loss: 17159054.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9214; val_auprc_score: 0.8874; val_best_acc_score: 0.8649; val_best_f1_score: 0.8750; train_kl_reg_loss: 102760.0618; train_edge_recon_loss: 2853508.9735; train_gene_expr_recon_loss: 10540661.8485; train_masked_gp_l1_reg_loss: 75471.1435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61946.6094; train_chrom_access_recon_loss: 2416957.6818; train_global_loss: 16051306.4697; train_optim_loss: 16051306.4697; val_kl_reg_loss: 23785.4736; val_edge_recon_loss: 2812555.1250; val_gene_expr_recon_loss: 10539852.3750; val_masked_gp_l1_reg_loss: 74902.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61624.6289; val_chrom_access_recon_loss: 2402133.2812; val_global_loss: 15914853.2500; val_optim_loss: 15914853.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9279; val_auprc_score: 0.9008; val_best_acc_score: 0.8692; val_best_f1_score: 0.8773; train_kl_reg_loss: 85492.3658; train_edge_recon_loss: 2754630.1932; train_gene_expr_recon_loss: 10477501.4848; train_masked_gp_l1_reg_loss: 74190.8622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61821.2811; train_chrom_access_recon_loss: 2381025.6629; train_global_loss: 15834661.8788; train_optim_loss: 15834661.8788; val_kl_reg_loss: 28077.3159; val_edge_recon_loss: 2794756.6562; val_gene_expr_recon_loss: 10442881.2500; val_masked_gp_l1_reg_loss: 73405.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62066.8516; val_chrom_access_recon_loss: 2372089.3438; val_global_loss: 15773276.7500; val_optim_loss: 15773276.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9206; val_auprc_score: 0.8891; val_best_acc_score: 0.8659; val_best_f1_score: 0.8759; train_kl_reg_loss: 69116.0371; train_edge_recon_loss: 2736774.9697; train_gene_expr_recon_loss: 10462991.1818; train_masked_gp_l1_reg_loss: 72611.2164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62200.5720; train_chrom_access_recon_loss: 2380875.2727; train_global_loss: 15784569.1970; train_optim_loss: 15784569.1970; val_kl_reg_loss: 31153.2383; val_edge_recon_loss: 2783411.8438; val_gene_expr_recon_loss: 10542918.2500; val_masked_gp_l1_reg_loss: 71857.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62548.3320; val_chrom_access_recon_loss: 2398951.3750; val_global_loss: 15890839.7500; val_optim_loss: 15890839.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9266; val_auprc_score: 0.8937; val_best_acc_score: 0.8745; val_best_f1_score: 0.8812; train_kl_reg_loss: 61338.4664; train_edge_recon_loss: 2722235.6326; train_gene_expr_recon_loss: 10432303.0455; train_masked_gp_l1_reg_loss: 71180.6580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62554.7557; train_chrom_access_recon_loss: 2374451.7992; train_global_loss: 15724064.4394; train_optim_loss: 15724064.4394; val_kl_reg_loss: 35568.0225; val_edge_recon_loss: 2763514.9375; val_gene_expr_recon_loss: 10368802.0000; val_masked_gp_l1_reg_loss: 70409.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62626.0820; val_chrom_access_recon_loss: 2348955.1250; val_global_loss: 15649875.1250; val_optim_loss: 15649875.1250
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9201; val_auprc_score: 0.8877; val_best_acc_score: 0.8638; val_best_f1_score: 0.8731; train_kl_reg_loss: 56199.9483; train_edge_recon_loss: 2728016.6477; train_gene_expr_recon_loss: 10417435.4091; train_masked_gp_l1_reg_loss: 69674.1192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62514.1416; train_chrom_access_recon_loss: 2369786.6742; train_global_loss: 15703626.9394; train_optim_loss: 15703626.9394; val_kl_reg_loss: 35854.4165; val_edge_recon_loss: 2757010.0312; val_gene_expr_recon_loss: 10309389.8750; val_masked_gp_l1_reg_loss: 69005.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62526.5469; val_chrom_access_recon_loss: 2344296.5312; val_global_loss: 15578082.6250; val_optim_loss: 15578082.6250
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9315; val_auprc_score: 0.9027; val_best_acc_score: 0.8823; val_best_f1_score: 0.8887; train_kl_reg_loss: 54810.1415; train_edge_recon_loss: 2706805.2083; train_gene_expr_recon_loss: 10389132.0152; train_masked_gp_l1_reg_loss: 68415.5069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62418.7608; train_chrom_access_recon_loss: 2365764.8523; train_global_loss: 15647346.3788; train_optim_loss: 15647346.3788; val_kl_reg_loss: 39746.1382; val_edge_recon_loss: 2711141.2812; val_gene_expr_recon_loss: 10363095.2500; val_masked_gp_l1_reg_loss: 67762.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62194.6445; val_chrom_access_recon_loss: 2374684.6562; val_global_loss: 15618625.2500; val_optim_loss: 15618625.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9204; val_auprc_score: 0.8891; val_best_acc_score: 0.8654; val_best_f1_score: 0.8754; train_kl_reg_loss: 54336.0926; train_edge_recon_loss: 2721540.3371; train_gene_expr_recon_loss: 10384007.4242; train_masked_gp_l1_reg_loss: 67164.9851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62338.4096; train_chrom_access_recon_loss: 2362251.8864; train_global_loss: 15651639.0303; train_optim_loss: 15651639.0303; val_kl_reg_loss: 41028.6948; val_edge_recon_loss: 2743974.9062; val_gene_expr_recon_loss: 10351352.1250; val_masked_gp_l1_reg_loss: 66588.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62513.9336; val_chrom_access_recon_loss: 2345511.2188; val_global_loss: 15610969.7500; val_optim_loss: 15610969.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9247; val_auprc_score: 0.8959; val_best_acc_score: 0.8753; val_best_f1_score: 0.8838; train_kl_reg_loss: 52562.3320; train_edge_recon_loss: 2719047.1553; train_gene_expr_recon_loss: 10351563.9545; train_masked_gp_l1_reg_loss: 66063.3937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62484.3180; train_chrom_access_recon_loss: 2356251.8333; train_global_loss: 15607972.8636; train_optim_loss: 15607972.8636; val_kl_reg_loss: 41168.5137; val_edge_recon_loss: 2740384.6562; val_gene_expr_recon_loss: 10411378.6250; val_masked_gp_l1_reg_loss: 65495.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62476.2773; val_chrom_access_recon_loss: 2350194.3750; val_global_loss: 15671097.3750; val_optim_loss: 15671097.3750
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9231; val_auprc_score: 0.8996; val_best_acc_score: 0.8667; val_best_f1_score: 0.8762; train_kl_reg_loss: 52822.0571; train_edge_recon_loss: 2705581.0152; train_gene_expr_recon_loss: 10332935.9091; train_masked_gp_l1_reg_loss: 64959.1002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62375.7207; train_chrom_access_recon_loss: 2350637.7803; train_global_loss: 15569311.6515; train_optim_loss: 15569311.6515; val_kl_reg_loss: 41944.7456; val_edge_recon_loss: 2770397.3438; val_gene_expr_recon_loss: 10230168.7500; val_masked_gp_l1_reg_loss: 64447.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62261.0703; val_chrom_access_recon_loss: 2345807.1250; val_global_loss: 15515025.8750; val_optim_loss: 15515025.8750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9164; val_auprc_score: 0.8787; val_best_acc_score: 0.8624; val_best_f1_score: 0.8729; train_kl_reg_loss: 51375.6080; train_edge_recon_loss: 2716291.6553; train_gene_expr_recon_loss: 10324449.6515; train_masked_gp_l1_reg_loss: 64005.1528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62252.6358; train_chrom_access_recon_loss: 2347477.9508; train_global_loss: 15565852.6061; train_optim_loss: 15565852.6061; val_kl_reg_loss: 43206.1489; val_edge_recon_loss: 2753399.4062; val_gene_expr_recon_loss: 10247806.0000; val_masked_gp_l1_reg_loss: 63567.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62288.3594; val_chrom_access_recon_loss: 2315688.3750; val_global_loss: 15485956.0000; val_optim_loss: 15485956.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9284; val_auprc_score: 0.9024; val_best_acc_score: 0.8684; val_best_f1_score: 0.8789; train_kl_reg_loss: 52022.6222; train_edge_recon_loss: 2694574.6250; train_gene_expr_recon_loss: 10308846.9091; train_masked_gp_l1_reg_loss: 63183.5887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62147.5244; train_chrom_access_recon_loss: 2345664.2689; train_global_loss: 15526439.6212; train_optim_loss: 15526439.6212; val_kl_reg_loss: 46398.7666; val_edge_recon_loss: 2751231.3750; val_gene_expr_recon_loss: 10281119.6250; val_masked_gp_l1_reg_loss: 62816.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61879.3867; val_chrom_access_recon_loss: 2333157.4375; val_global_loss: 15536603.1250; val_optim_loss: 15536603.1250
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9282; val_auprc_score: 0.9041; val_best_acc_score: 0.8743; val_best_f1_score: 0.8821; train_kl_reg_loss: 52475.7878; train_edge_recon_loss: 2705490.4962; train_gene_expr_recon_loss: 10300829.4697; train_masked_gp_l1_reg_loss: 62416.7700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61861.8794; train_chrom_access_recon_loss: 2344127.5114; train_global_loss: 15527202.0606; train_optim_loss: 15527202.0606; val_kl_reg_loss: 41705.6987; val_edge_recon_loss: 2737355.9375; val_gene_expr_recon_loss: 10245870.8750; val_masked_gp_l1_reg_loss: 62080.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62038.6680; val_chrom_access_recon_loss: 2342440.3750; val_global_loss: 15491492.8750; val_optim_loss: 15491492.8750
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9238; val_auprc_score: 0.8899; val_best_acc_score: 0.8641; val_best_f1_score: 0.8747; train_kl_reg_loss: 52042.3165; train_edge_recon_loss: 2696264.8447; train_gene_expr_recon_loss: 10294900.3788; train_masked_gp_l1_reg_loss: 61842.5513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61950.7221; train_chrom_access_recon_loss: 2341488.5152; train_global_loss: 15508489.4848; train_optim_loss: 15508489.4848; val_kl_reg_loss: 40324.3267; val_edge_recon_loss: 2749646.0000; val_gene_expr_recon_loss: 10187738.8750; val_masked_gp_l1_reg_loss: 61675.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62230.5078; val_chrom_access_recon_loss: 2308305.1875; val_global_loss: 15409921.2500; val_optim_loss: 15409921.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9315; val_auprc_score: 0.9054; val_best_acc_score: 0.8783; val_best_f1_score: 0.8862; train_kl_reg_loss: 50642.5157; train_edge_recon_loss: 2706565.1061; train_gene_expr_recon_loss: 10276220.0455; train_masked_gp_l1_reg_loss: 61462.3053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61988.9934; train_chrom_access_recon_loss: 2338097.0644; train_global_loss: 15494976.1061; train_optim_loss: 15494976.1061; val_kl_reg_loss: 42738.4614; val_edge_recon_loss: 2710314.5000; val_gene_expr_recon_loss: 10272872.0000; val_masked_gp_l1_reg_loss: 61222.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61974.3711; val_chrom_access_recon_loss: 2330665.7500; val_global_loss: 15479786.6250; val_optim_loss: 15479786.6250
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9337; val_auprc_score: 0.9161; val_best_acc_score: 0.8764; val_best_f1_score: 0.8826; train_kl_reg_loss: 51861.8076; train_edge_recon_loss: 2714727.2386; train_gene_expr_recon_loss: 10277707.4545; train_masked_gp_l1_reg_loss: 60977.3912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61921.4728; train_chrom_access_recon_loss: 2339716.5985; train_global_loss: 15506911.9848; train_optim_loss: 15506911.9848; val_kl_reg_loss: 43668.2827; val_edge_recon_loss: 2736932.2812; val_gene_expr_recon_loss: 10219418.7500; val_masked_gp_l1_reg_loss: 60733.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61875.5508; val_chrom_access_recon_loss: 2305694.3438; val_global_loss: 15428323.5000; val_optim_loss: 15428323.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9348; val_auprc_score: 0.9157; val_best_acc_score: 0.8778; val_best_f1_score: 0.8850; train_kl_reg_loss: 50409.4200; train_edge_recon_loss: 2702315.7424; train_gene_expr_recon_loss: 10242970.8939; train_masked_gp_l1_reg_loss: 60471.0024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61800.7792; train_chrom_access_recon_loss: 2328976.8447; train_global_loss: 15446944.8182; train_optim_loss: 15446944.8182; val_kl_reg_loss: 42604.3799; val_edge_recon_loss: 2722868.5000; val_gene_expr_recon_loss: 10230314.0000; val_masked_gp_l1_reg_loss: 60300.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61965.3164; val_chrom_access_recon_loss: 2336919.3750; val_global_loss: 15454971.3750; val_optim_loss: 15454971.3750
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9299; val_auprc_score: 0.8983; val_best_acc_score: 0.8694; val_best_f1_score: 0.8795; train_kl_reg_loss: 49637.0027; train_edge_recon_loss: 2711990.9053; train_gene_expr_recon_loss: 10223741.2424; train_masked_gp_l1_reg_loss: 60045.7333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61909.5397; train_chrom_access_recon_loss: 2318717.1061; train_global_loss: 15426041.5455; train_optim_loss: 15426041.5455; val_kl_reg_loss: 42328.7339; val_edge_recon_loss: 2738558.8438; val_gene_expr_recon_loss: 10081294.1250; val_masked_gp_l1_reg_loss: 59831.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61830.3594; val_chrom_access_recon_loss: 2289206.6250; val_global_loss: 15273050.3750; val_optim_loss: 15273050.3750
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9324; val_auprc_score: 0.9078; val_best_acc_score: 0.8761; val_best_f1_score: 0.8832; train_kl_reg_loss: 50025.7783; train_edge_recon_loss: 2688842.0985; train_gene_expr_recon_loss: 10213875.1212; train_masked_gp_l1_reg_loss: 59654.5157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61709.8309; train_chrom_access_recon_loss: 2313414.0966; train_global_loss: 15387521.3182; train_optim_loss: 15387521.3182; val_kl_reg_loss: 45158.2759; val_edge_recon_loss: 2714036.5625; val_gene_expr_recon_loss: 10144843.7500; val_masked_gp_l1_reg_loss: 59447.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61772.4883; val_chrom_access_recon_loss: 2283734.8750; val_global_loss: 15308993.7500; val_optim_loss: 15308993.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9294; val_auprc_score: 0.8950; val_best_acc_score: 0.8726; val_best_f1_score: 0.8798; train_kl_reg_loss: 50199.2385; train_edge_recon_loss: 2700205.2311; train_gene_expr_recon_loss: 10206314.5152; train_masked_gp_l1_reg_loss: 59249.2044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61607.5926; train_chrom_access_recon_loss: 2308813.1402; train_global_loss: 15386388.8788; train_optim_loss: 15386388.8788; val_kl_reg_loss: 43839.0503; val_edge_recon_loss: 2726613.6562; val_gene_expr_recon_loss: 10153236.0000; val_masked_gp_l1_reg_loss: 59076.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61689.9492; val_chrom_access_recon_loss: 2295654.0625; val_global_loss: 15340109.0000; val_optim_loss: 15340109.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9221; val_auprc_score: 0.8881; val_best_acc_score: 0.8662; val_best_f1_score: 0.8746; train_kl_reg_loss: 49671.6715; train_edge_recon_loss: 2684458.7197; train_gene_expr_recon_loss: 10199379.8788; train_masked_gp_l1_reg_loss: 58901.9951; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61598.4312; train_chrom_access_recon_loss: 2306944.6250; train_global_loss: 15360955.4091; train_optim_loss: 15360955.4091; val_kl_reg_loss: 44299.3433; val_edge_recon_loss: 2748787.8125; val_gene_expr_recon_loss: 10200890.5000; val_masked_gp_l1_reg_loss: 58724.6445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61659.8320; val_chrom_access_recon_loss: 2286660.8125; val_global_loss: 15401023.8750; val_optim_loss: 15401023.8750
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9324; val_auprc_score: 0.9079; val_best_acc_score: 0.8783; val_best_f1_score: 0.8868; train_kl_reg_loss: 48992.4660; train_edge_recon_loss: 2693242.5606; train_gene_expr_recon_loss: 10193507.9091; train_masked_gp_l1_reg_loss: 58575.7862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61644.4577; train_chrom_access_recon_loss: 2305967.8750; train_global_loss: 15361931.0455; train_optim_loss: 15361931.0455; val_kl_reg_loss: 44385.2998; val_edge_recon_loss: 2737910.3125; val_gene_expr_recon_loss: 10114633.0000; val_masked_gp_l1_reg_loss: 58412.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61629.9531; val_chrom_access_recon_loss: 2281874.6562; val_global_loss: 15298845.2500; val_optim_loss: 15298845.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9347; val_auprc_score: 0.9038; val_best_acc_score: 0.8834; val_best_f1_score: 0.8901; train_kl_reg_loss: 49158.6458; train_edge_recon_loss: 2690572.5455; train_gene_expr_recon_loss: 10187662.6364; train_masked_gp_l1_reg_loss: 58131.5971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52552.2359; train_chrom_access_recon_loss: 2305011.8864; train_global_loss: 15343089.6061; train_optim_loss: 15343089.6061; val_kl_reg_loss: 45087.6807; val_edge_recon_loss: 2707590.4062; val_gene_expr_recon_loss: 10066652.0000; val_masked_gp_l1_reg_loss: 58020.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50808.5625; val_chrom_access_recon_loss: 2270535.7812; val_global_loss: 15198695.5000; val_optim_loss: 15198695.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9339; val_auprc_score: 0.9092; val_best_acc_score: 0.8745; val_best_f1_score: 0.8818; train_kl_reg_loss: 49848.2547; train_edge_recon_loss: 2695504.3106; train_gene_expr_recon_loss: 10182167.4697; train_masked_gp_l1_reg_loss: 57985.8749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50655.2288; train_chrom_access_recon_loss: 2301414.7386; train_global_loss: 15337575.9091; train_optim_loss: 15337575.9091; val_kl_reg_loss: 44669.7539; val_edge_recon_loss: 2743206.3125; val_gene_expr_recon_loss: 10159060.0000; val_masked_gp_l1_reg_loss: 57957.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50504.5742; val_chrom_access_recon_loss: 2300842.2188; val_global_loss: 15356240.2500; val_optim_loss: 15356240.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9294; val_auprc_score: 0.9038; val_best_acc_score: 0.8713; val_best_f1_score: 0.8771; train_kl_reg_loss: 49742.2127; train_edge_recon_loss: 2682233.5417; train_gene_expr_recon_loss: 10181830.4394; train_masked_gp_l1_reg_loss: 57937.2796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50417.9774; train_chrom_access_recon_loss: 2303213.3447; train_global_loss: 15325374.7727; train_optim_loss: 15325374.7727; val_kl_reg_loss: 44976.1455; val_edge_recon_loss: 2744739.6875; val_gene_expr_recon_loss: 10139916.8750; val_masked_gp_l1_reg_loss: 57917.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50292.6914; val_chrom_access_recon_loss: 2272714.2188; val_global_loss: 15310557.0000; val_optim_loss: 15310557.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9388; val_auprc_score: 0.9196; val_best_acc_score: 0.8799; val_best_f1_score: 0.8861; train_kl_reg_loss: 49603.3525; train_edge_recon_loss: 2688991.3864; train_gene_expr_recon_loss: 10177586.1667; train_masked_gp_l1_reg_loss: 57901.5401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50240.3730; train_chrom_access_recon_loss: 2301560.4167; train_global_loss: 15325883.2273; train_optim_loss: 15325883.2273; val_kl_reg_loss: 45081.4736; val_edge_recon_loss: 2733212.0625; val_gene_expr_recon_loss: 10155251.5000; val_masked_gp_l1_reg_loss: 57883.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50160.8086; val_chrom_access_recon_loss: 2287774.6250; val_global_loss: 15329364.6250; val_optim_loss: 15329364.6250
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9300; val_auprc_score: 0.9025; val_best_acc_score: 0.8751; val_best_f1_score: 0.8815; train_kl_reg_loss: 49896.0806; train_edge_recon_loss: 2692931.7841; train_gene_expr_recon_loss: 10175426.7273; train_masked_gp_l1_reg_loss: 57867.5511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50099.7992; train_chrom_access_recon_loss: 2302595.1932; train_global_loss: 15328817.0455; train_optim_loss: 15328817.0455; val_kl_reg_loss: 45729.2085; val_edge_recon_loss: 2719372.7188; val_gene_expr_recon_loss: 10118838.8750; val_masked_gp_l1_reg_loss: 57852.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50044.0352; val_chrom_access_recon_loss: 2270247.3750; val_global_loss: 15262084.1250; val_optim_loss: 15262084.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9389; val_auprc_score: 0.9175; val_best_acc_score: 0.8783; val_best_f1_score: 0.8853; train_kl_reg_loss: 50029.8282; train_edge_recon_loss: 2696822.6250; train_gene_expr_recon_loss: 10172946.2727; train_masked_gp_l1_reg_loss: 57822.1584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49061.5437; train_chrom_access_recon_loss: 2302297.0152; train_global_loss: 15328979.4545; train_optim_loss: 15328979.4545; val_kl_reg_loss: 46191.3267; val_edge_recon_loss: 2700515.5312; val_gene_expr_recon_loss: 10196792.6250; val_masked_gp_l1_reg_loss: 57810.4648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48874.9922; val_chrom_access_recon_loss: 2280514.8750; val_global_loss: 15330699.2500; val_optim_loss: 15330699.2500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9311; val_auprc_score: 0.9051; val_best_acc_score: 0.8729; val_best_f1_score: 0.8798; train_kl_reg_loss: 49905.9719; train_edge_recon_loss: 2691083.0644; train_gene_expr_recon_loss: 10182445.5909; train_masked_gp_l1_reg_loss: 57806.5465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48861.7487; train_chrom_access_recon_loss: 2305308.9280; train_global_loss: 15335411.8788; train_optim_loss: 15335411.8788; val_kl_reg_loss: 45546.1748; val_edge_recon_loss: 2720259.6875; val_gene_expr_recon_loss: 10236589.8750; val_masked_gp_l1_reg_loss: 57803.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48846.9180; val_chrom_access_recon_loss: 2296670.8438; val_global_loss: 15405716.5000; val_optim_loss: 15405716.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9375; val_auprc_score: 0.9124; val_best_acc_score: 0.8756; val_best_f1_score: 0.8832; train_kl_reg_loss: 50045.9972; train_edge_recon_loss: 2691868.7538; train_gene_expr_recon_loss: 10175015.4697; train_masked_gp_l1_reg_loss: 57800.0574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48834.6341; train_chrom_access_recon_loss: 2300403.0152; train_global_loss: 15323967.9091; train_optim_loss: 15323967.9091; val_kl_reg_loss: 45917.3804; val_edge_recon_loss: 2690169.5000; val_gene_expr_recon_loss: 10078876.0000; val_masked_gp_l1_reg_loss: 57796.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48820.8438; val_chrom_access_recon_loss: 2274584.9688; val_global_loss: 15196166.0000; val_optim_loss: 15196166.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9294; val_auprc_score: 0.9021; val_best_acc_score: 0.8705; val_best_f1_score: 0.8775; train_kl_reg_loss: 50124.9789; train_edge_recon_loss: 2688781.2008; train_gene_expr_recon_loss: 10175115.7576; train_masked_gp_l1_reg_loss: 57794.0720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48810.4955; train_chrom_access_recon_loss: 2300538.5909; train_global_loss: 15321165.0758; train_optim_loss: 15321165.0758; val_kl_reg_loss: 45531.9126; val_edge_recon_loss: 2773536.4062; val_gene_expr_recon_loss: 10190376.8750; val_masked_gp_l1_reg_loss: 57791.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48800.5547; val_chrom_access_recon_loss: 2294614.4062; val_global_loss: 15410652.6250; val_optim_loss: 15410652.6250
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9356; val_auprc_score: 0.9081; val_best_acc_score: 0.8761; val_best_f1_score: 0.8848; train_kl_reg_loss: 49996.9488; train_edge_recon_loss: 2692412.9621; train_gene_expr_recon_loss: 10180634.3182; train_masked_gp_l1_reg_loss: 57789.3610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48788.3238; train_chrom_access_recon_loss: 2304325.9508; train_global_loss: 15333947.9394; train_optim_loss: 15333947.9394; val_kl_reg_loss: 45659.4390; val_edge_recon_loss: 2697721.8750; val_gene_expr_recon_loss: 10116339.5000; val_masked_gp_l1_reg_loss: 57787.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48782.3633; val_chrom_access_recon_loss: 2261324.7812; val_global_loss: 15227614.6250; val_optim_loss: 15227614.6250
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9323; val_auprc_score: 0.9066; val_best_acc_score: 0.8710; val_best_f1_score: 0.8795; train_kl_reg_loss: 50003.0699; train_edge_recon_loss: 2689703.4886; train_gene_expr_recon_loss: 10183684.5909; train_masked_gp_l1_reg_loss: 57785.5588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48770.4138; train_chrom_access_recon_loss: 2303762.9205; train_global_loss: 15333710.1061; train_optim_loss: 15333710.1061; val_kl_reg_loss: 45310.5635; val_edge_recon_loss: 2727533.2812; val_gene_expr_recon_loss: 10135434.1250; val_masked_gp_l1_reg_loss: 57783.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48761.8086; val_chrom_access_recon_loss: 2291013.2188; val_global_loss: 15305836.2500; val_optim_loss: 15305836.2500
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9358; val_auprc_score: 0.9073; val_best_acc_score: 0.8791; val_best_f1_score: 0.8825; train_kl_reg_loss: 50036.1373; train_edge_recon_loss: 2687471.6023; train_gene_expr_recon_loss: 10175928.3485; train_masked_gp_l1_reg_loss: 57782.1077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48756.9393; train_chrom_access_recon_loss: 2303122.5189; train_global_loss: 15323097.5758; train_optim_loss: 15323097.5758; val_kl_reg_loss: 45804.1802; val_edge_recon_loss: 2704069.9688; val_gene_expr_recon_loss: 10058714.0000; val_masked_gp_l1_reg_loss: 57779.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48746.3984; val_chrom_access_recon_loss: 2283636.1562; val_global_loss: 15198750.3750; val_optim_loss: 15198750.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9295; val_auprc_score: 0.8994; val_best_acc_score: 0.8713; val_best_f1_score: 0.8800; train_kl_reg_loss: 49995.3742; train_edge_recon_loss: 2688821.6364; train_gene_expr_recon_loss: 10181073.7576; train_masked_gp_l1_reg_loss: 57776.3774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48649.2137; train_chrom_access_recon_loss: 2304273.6515; train_global_loss: 15330589.8485; train_optim_loss: 15330589.8485; val_kl_reg_loss: 45439.0981; val_edge_recon_loss: 2716533.6562; val_gene_expr_recon_loss: 10132887.6250; val_masked_gp_l1_reg_loss: 57775.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48631.1172; val_chrom_access_recon_loss: 2293158.1250; val_global_loss: 15294424.6250; val_optim_loss: 15294424.6250
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9345; val_auprc_score: 0.9071; val_best_acc_score: 0.8772; val_best_f1_score: 0.8826; train_kl_reg_loss: 50089.6328; train_edge_recon_loss: 2690335.5985; train_gene_expr_recon_loss: 10181020.8333; train_masked_gp_l1_reg_loss: 57774.8446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48629.4499; train_chrom_access_recon_loss: 2303692.9621; train_global_loss: 15331543.3333; train_optim_loss: 15331543.3333; val_kl_reg_loss: 45686.0679; val_edge_recon_loss: 2717861.2812; val_gene_expr_recon_loss: 10072173.6250; val_masked_gp_l1_reg_loss: 57774.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48628.3086; val_chrom_access_recon_loss: 2278551.6875; val_global_loss: 15220674.6250; val_optim_loss: 15220674.6250
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9366; val_auprc_score: 0.9067; val_best_acc_score: 0.8823; val_best_f1_score: 0.8874; train_kl_reg_loss: 49950.4087; train_edge_recon_loss: 2689186.3409; train_gene_expr_recon_loss: 10183249.9394; train_masked_gp_l1_reg_loss: 57774.1894; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48627.0165; train_chrom_access_recon_loss: 2303598.5530; train_global_loss: 15332386.2424; train_optim_loss: 15332386.2424; val_kl_reg_loss: 46197.3892; val_edge_recon_loss: 2711813.7188; val_gene_expr_recon_loss: 10181390.3750; val_masked_gp_l1_reg_loss: 57773.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48625.5977; val_chrom_access_recon_loss: 2313072.6875; val_global_loss: 15358874.1250; val_optim_loss: 15358874.1250
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9361; val_auprc_score: 0.9165; val_best_acc_score: 0.8716; val_best_f1_score: 0.8781; train_kl_reg_loss: 50017.7303; train_edge_recon_loss: 2689178.3068; train_gene_expr_recon_loss: 10184755.2273; train_masked_gp_l1_reg_loss: 57773.6261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48624.6793; train_chrom_access_recon_loss: 2304046.5114; train_global_loss: 15334396.3485; train_optim_loss: 15334396.3485; val_kl_reg_loss: 46232.1177; val_edge_recon_loss: 2733035.0938; val_gene_expr_recon_loss: 10073710.3750; val_masked_gp_l1_reg_loss: 57773.4102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48623.4609; val_chrom_access_recon_loss: 2283419.0625; val_global_loss: 15242792.3750; val_optim_loss: 15242792.3750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 11 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9385
val AUPRC score: 0.9158
val best accuracy score: 0.8815
val best F1 score: 0.8867
val target rna MSE score: 2.4019
val source rna MSE score: 1.0142
val target atac MSE score: 0.4767
val source atac MSE score: 0.1901
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
