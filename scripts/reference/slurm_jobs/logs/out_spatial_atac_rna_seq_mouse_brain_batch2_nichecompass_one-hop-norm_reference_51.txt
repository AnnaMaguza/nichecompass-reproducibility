[True]
Run timestamp: 24072023_165118_51.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_51']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8856; val_auprc_score: 0.8971; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 11279.1608; train_edge_recon_loss: 3493077.1389; train_gene_expr_recon_loss: 32184543.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10820648.5556; train_global_loss: 46509547.5556; train_optim_loss: 46509547.5556; val_kl_reg_loss: 33580.3203; val_edge_recon_loss: 4065865.2500; val_gene_expr_recon_loss: 29686948.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10567107.0000; val_global_loss: 44353500.0000; val_optim_loss: 44353500.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8657; val_auprc_score: 0.8747; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 63701.8633; train_edge_recon_loss: 3563319.9444; train_gene_expr_recon_loss: 29116133.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10712995.5556; train_global_loss: 43456150.6667; train_optim_loss: 43456150.6667; val_kl_reg_loss: 60328.8047; val_edge_recon_loss: 4065888.5000; val_gene_expr_recon_loss: 26838164.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10359651.0000; val_global_loss: 41324032.0000; val_optim_loss: 41324032.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8360; val_auprc_score: 0.8473; val_best_acc_score: 0.5032; val_best_f1_score: 0.6680; train_kl_reg_loss: 105686.4002; train_edge_recon_loss: 3612377.7222; train_gene_expr_recon_loss: 26045258.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10411722.6667; train_global_loss: 40175045.3333; train_optim_loss: 40175045.3333; val_kl_reg_loss: 128342.1250; val_edge_recon_loss: 4065693.0000; val_gene_expr_recon_loss: 24359638.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10139859.0000; val_global_loss: 38693532.0000; val_optim_loss: 38693532.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8656; val_auprc_score: 0.8660; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 153809.7648; train_edge_recon_loss: 3661881.7778; train_gene_expr_recon_loss: 24284459.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10234614.5556; train_global_loss: 38334765.7778; train_optim_loss: 38334765.7778; val_kl_reg_loss: 130860.2812; val_edge_recon_loss: 4065694.2500; val_gene_expr_recon_loss: 23160532.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9955176.0000; val_global_loss: 37312264.0000; val_optim_loss: 37312264.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8610; val_auprc_score: 0.8587; val_best_acc_score: 0.5032; val_best_f1_score: 0.6681; train_kl_reg_loss: 180690.4288; train_edge_recon_loss: 3645834.0278; train_gene_expr_recon_loss: 23232277.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10024819.0000; train_global_loss: 37083621.3333; train_optim_loss: 37083621.3333; val_kl_reg_loss: 165164.4844; val_edge_recon_loss: 4065513.5000; val_gene_expr_recon_loss: 22312758.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9858831.0000; val_global_loss: 36402268.0000; val_optim_loss: 36402268.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8642; val_auprc_score: 0.8542; val_best_acc_score: 0.5066; val_best_f1_score: 0.6695; train_kl_reg_loss: 196464.1701; train_edge_recon_loss: 3655110.9167; train_gene_expr_recon_loss: 22478162.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9968517.3333; train_global_loss: 36298255.5556; train_optim_loss: 36298255.5556; val_kl_reg_loss: 176335.4531; val_edge_recon_loss: 4065207.2500; val_gene_expr_recon_loss: 21777590.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9773621.0000; val_global_loss: 35792752.0000; val_optim_loss: 35792752.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8660; val_auprc_score: 0.8584; val_best_acc_score: 0.5151; val_best_f1_score: 0.6733; train_kl_reg_loss: 216473.1944; train_edge_recon_loss: 3643447.2778; train_gene_expr_recon_loss: 22098461.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9921797.1111; train_global_loss: 35880179.5556; train_optim_loss: 35880179.5556; val_kl_reg_loss: 172199.1875; val_edge_recon_loss: 4064724.5000; val_gene_expr_recon_loss: 21398166.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9726961.0000; val_global_loss: 35362052.0000; val_optim_loss: 35362052.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8659; val_auprc_score: 0.8602; val_best_acc_score: 0.5217; val_best_f1_score: 0.6761; train_kl_reg_loss: 217959.7708; train_edge_recon_loss: 3643104.4722; train_gene_expr_recon_loss: 21585562.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9757856.8889; train_global_loss: 35204484.0000; train_optim_loss: 35204484.0000; val_kl_reg_loss: 194254.1406; val_edge_recon_loss: 4064189.0000; val_gene_expr_recon_loss: 21105988.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9685707.0000; val_global_loss: 35050140.0000; val_optim_loss: 35050140.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8703; val_auprc_score: 0.8588; val_best_acc_score: 0.5362; val_best_f1_score: 0.6826; train_kl_reg_loss: 226032.0573; train_edge_recon_loss: 3634540.1667; train_gene_expr_recon_loss: 21490896.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9800481.7778; train_global_loss: 35151951.5556; train_optim_loss: 35151951.5556; val_kl_reg_loss: 185437.3594; val_edge_recon_loss: 4063151.7500; val_gene_expr_recon_loss: 20967862.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9666292.0000; val_global_loss: 34882744.0000; val_optim_loss: 34882744.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8785; val_auprc_score: 0.8722; val_best_acc_score: 0.5663; val_best_f1_score: 0.6965; train_kl_reg_loss: 216129.2795; train_edge_recon_loss: 3631984.9167; train_gene_expr_recon_loss: 21167514.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9753761.2222; train_global_loss: 34769390.2222; train_optim_loss: 34769390.2222; val_kl_reg_loss: 179779.3125; val_edge_recon_loss: 4061550.0000; val_gene_expr_recon_loss: 20869366.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9646600.0000; val_global_loss: 34757296.0000; val_optim_loss: 34757296.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8724; val_auprc_score: 0.8626; val_best_acc_score: 0.6043; val_best_f1_score: 0.7143; train_kl_reg_loss: 212988.6163; train_edge_recon_loss: 3621348.3333; train_gene_expr_recon_loss: 21149780.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9762734.5556; train_global_loss: 34746852.4444; train_optim_loss: 34746852.4444; val_kl_reg_loss: 190910.7812; val_edge_recon_loss: 4059539.2500; val_gene_expr_recon_loss: 20769570.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9634391.0000; val_global_loss: 34654412.0000; val_optim_loss: 34654412.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8680; val_auprc_score: 0.8555; val_best_acc_score: 0.6440; val_best_f1_score: 0.7334; train_kl_reg_loss: 214095.6389; train_edge_recon_loss: 3607839.7222; train_gene_expr_recon_loss: 20937318.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9726648.1111; train_global_loss: 34485901.7778; train_optim_loss: 34485901.7778; val_kl_reg_loss: 182316.2812; val_edge_recon_loss: 4057121.7500; val_gene_expr_recon_loss: 20724792.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9622985.0000; val_global_loss: 34587216.0000; val_optim_loss: 34587216.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8665; val_auprc_score: 0.8506; val_best_acc_score: 0.6827; val_best_f1_score: 0.7534; train_kl_reg_loss: 208203.5608; train_edge_recon_loss: 3606713.5556; train_gene_expr_recon_loss: 20951384.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9734357.1111; train_global_loss: 34500658.2222; train_optim_loss: 34500658.2222; val_kl_reg_loss: 185111.2188; val_edge_recon_loss: 4052996.0000; val_gene_expr_recon_loss: 20657798.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9616583.0000; val_global_loss: 34512488.0000; val_optim_loss: 34512488.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8649; val_auprc_score: 0.8480; val_best_acc_score: 0.7257; val_best_f1_score: 0.7770; train_kl_reg_loss: 206217.5503; train_edge_recon_loss: 3599668.8333; train_gene_expr_recon_loss: 20927402.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9704684.2222; train_global_loss: 34437973.3333; train_optim_loss: 34437973.3333; val_kl_reg_loss: 165422.5625; val_edge_recon_loss: 4047827.7500; val_gene_expr_recon_loss: 20612682.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9611481.0000; val_global_loss: 34437412.0000; val_optim_loss: 34437412.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8753; val_auprc_score: 0.8676; val_best_acc_score: 0.7573; val_best_f1_score: 0.7943; train_kl_reg_loss: 195072.9549; train_edge_recon_loss: 3598132.5833; train_gene_expr_recon_loss: 20866823.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9693816.7778; train_global_loss: 34353845.7778; train_optim_loss: 34353845.7778; val_kl_reg_loss: 189055.5938; val_edge_recon_loss: 4041338.5000; val_gene_expr_recon_loss: 20569512.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9575938.0000; val_global_loss: 34375844.0000; val_optim_loss: 34375844.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8733; val_auprc_score: 0.8618; val_best_acc_score: 0.7807; val_best_f1_score: 0.8048; train_kl_reg_loss: 200056.1319; train_edge_recon_loss: 3586164.2778; train_gene_expr_recon_loss: 20890246.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9733419.6667; train_global_loss: 34409886.6667; train_optim_loss: 34409886.6667; val_kl_reg_loss: 148196.3438; val_edge_recon_loss: 4031715.5000; val_gene_expr_recon_loss: 20517638.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9566606.0000; val_global_loss: 34264156.0000; val_optim_loss: 34264156.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8713; val_auprc_score: 0.8599; val_best_acc_score: 0.7832; val_best_f1_score: 0.8002; train_kl_reg_loss: 189205.3194; train_edge_recon_loss: 3586777.5833; train_gene_expr_recon_loss: 20703620.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9641366.7778; train_global_loss: 34120970.0000; train_optim_loss: 34120970.0000; val_kl_reg_loss: 173573.7812; val_edge_recon_loss: 4021726.7500; val_gene_expr_recon_loss: 20500018.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9562167.0000; val_global_loss: 34257484.0000; val_optim_loss: 34257484.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8774; val_auprc_score: 0.8623; val_best_acc_score: 0.7992; val_best_f1_score: 0.8020; train_kl_reg_loss: 188822.2448; train_edge_recon_loss: 3575607.5278; train_gene_expr_recon_loss: 20883116.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9717658.2222; train_global_loss: 34365204.0000; train_optim_loss: 34365204.0000; val_kl_reg_loss: 152217.6875; val_edge_recon_loss: 4003073.2500; val_gene_expr_recon_loss: 20469858.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9558144.0000; val_global_loss: 34183292.0000; val_optim_loss: 34183292.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8818; val_auprc_score: 0.8723; val_best_acc_score: 0.7924; val_best_f1_score: 0.7830; train_kl_reg_loss: 182347.8802; train_edge_recon_loss: 3571991.8889; train_gene_expr_recon_loss: 20785574.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9648269.2222; train_global_loss: 34188183.1111; train_optim_loss: 34188183.1111; val_kl_reg_loss: 158181.1406; val_edge_recon_loss: 3981051.7500; val_gene_expr_recon_loss: 20429974.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9548016.0000; val_global_loss: 34117224.0000; val_optim_loss: 34117224.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8783; val_auprc_score: 0.8663; val_best_acc_score: 0.7731; val_best_f1_score: 0.7940; train_kl_reg_loss: 176030.0503; train_edge_recon_loss: 3562909.4167; train_gene_expr_recon_loss: 20681261.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9682482.3333; train_global_loss: 34102683.5556; train_optim_loss: 34102683.5556; val_kl_reg_loss: 153990.5312; val_edge_recon_loss: 3951852.2500; val_gene_expr_recon_loss: 20401030.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9536158.0000; val_global_loss: 34043032.0000; val_optim_loss: 34043032.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8871; val_auprc_score: 0.8758; val_best_acc_score: 0.7816; val_best_f1_score: 0.8090; train_kl_reg_loss: 173341.7986; train_edge_recon_loss: 3548695.0278; train_gene_expr_recon_loss: 20617787.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9651138.6667; train_global_loss: 33990962.6667; train_optim_loss: 33990962.6667; val_kl_reg_loss: 136407.9375; val_edge_recon_loss: 3903803.7500; val_gene_expr_recon_loss: 20396170.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9532417.0000; val_global_loss: 33968800.0000; val_optim_loss: 33968800.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8881; val_auprc_score: 0.8747; val_best_acc_score: 0.8033; val_best_f1_score: 0.8188; train_kl_reg_loss: 162438.6632; train_edge_recon_loss: 3535959.6667; train_gene_expr_recon_loss: 20691654.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9628799.4444; train_global_loss: 34018852.8889; train_optim_loss: 34018852.8889; val_kl_reg_loss: 146660.2812; val_edge_recon_loss: 3837215.2500; val_gene_expr_recon_loss: 20357254.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9513718.0000; val_global_loss: 33854848.0000; val_optim_loss: 33854848.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8829; val_auprc_score: 0.8672; val_best_acc_score: 0.8037; val_best_f1_score: 0.8144; train_kl_reg_loss: 161549.5573; train_edge_recon_loss: 3504356.4167; train_gene_expr_recon_loss: 20584712.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9622665.6667; train_global_loss: 33873284.8889; train_optim_loss: 33873284.8889; val_kl_reg_loss: 136707.4688; val_edge_recon_loss: 3757079.0000; val_gene_expr_recon_loss: 20351766.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9517007.0000; val_global_loss: 33762560.0000; val_optim_loss: 33762560.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8902; val_auprc_score: 0.8721; val_best_acc_score: 0.8069; val_best_f1_score: 0.8216; train_kl_reg_loss: 151232.8941; train_edge_recon_loss: 3469779.0278; train_gene_expr_recon_loss: 20636720.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9600408.3333; train_global_loss: 33858140.8889; train_optim_loss: 33858140.8889; val_kl_reg_loss: 132867.4844; val_edge_recon_loss: 3645622.2500; val_gene_expr_recon_loss: 20319052.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9509317.0000; val_global_loss: 33606860.0000; val_optim_loss: 33606860.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9005; val_auprc_score: 0.8873; val_best_acc_score: 0.8209; val_best_f1_score: 0.8286; train_kl_reg_loss: 148996.0642; train_edge_recon_loss: 3408964.8611; train_gene_expr_recon_loss: 20572953.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9603723.3333; train_global_loss: 33734638.6667; train_optim_loss: 33734638.6667; val_kl_reg_loss: 133371.1094; val_edge_recon_loss: 3509651.5000; val_gene_expr_recon_loss: 20298706.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9506495.0000; val_global_loss: 33448224.0000; val_optim_loss: 33448224.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9087; val_auprc_score: 0.8921; val_best_acc_score: 0.8134; val_best_f1_score: 0.8361; train_kl_reg_loss: 138610.6345; train_edge_recon_loss: 3715394.0000; train_gene_expr_recon_loss: 21212164.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9685981.2222; train_global_loss: 34752149.7778; train_optim_loss: 34752149.7778; val_kl_reg_loss: 99694.4219; val_edge_recon_loss: 3863148.5000; val_gene_expr_recon_loss: 20776564.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9536844.0000; val_global_loss: 34276252.0000; val_optim_loss: 34276252.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8857; val_auprc_score: 0.8690; val_best_acc_score: 0.8076; val_best_f1_score: 0.8173; train_kl_reg_loss: 79248.5768; train_edge_recon_loss: 3830097.5278; train_gene_expr_recon_loss: 21905131.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9752094.1111; train_global_loss: 35566572.4444; train_optim_loss: 35566572.4444; val_kl_reg_loss: 46372.2070; val_edge_recon_loss: 4001266.7500; val_gene_expr_recon_loss: 21039100.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9567018.0000; val_global_loss: 34653760.0000; val_optim_loss: 34653760.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8576; val_auprc_score: 0.8505; val_best_acc_score: 0.6889; val_best_f1_score: 0.7532; train_kl_reg_loss: 47412.4748; train_edge_recon_loss: 3892483.0556; train_gene_expr_recon_loss: 21670106.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9698961.1111; train_global_loss: 35308963.1111; train_optim_loss: 35308963.1111; val_kl_reg_loss: 42295.8594; val_edge_recon_loss: 4045450.0000; val_gene_expr_recon_loss: 20969286.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9554744.0000; val_global_loss: 34611776.0000; val_optim_loss: 34611776.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8547; val_auprc_score: 0.8423; val_best_acc_score: 0.6745; val_best_f1_score: 0.7478; train_kl_reg_loss: 51204.0139; train_edge_recon_loss: 3854132.2222; train_gene_expr_recon_loss: 21320092.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9686983.1111; train_global_loss: 34912412.0000; train_optim_loss: 34912412.0000; val_kl_reg_loss: 59629.2031; val_edge_recon_loss: 4049735.7500; val_gene_expr_recon_loss: 20806736.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9534829.0000; val_global_loss: 34450928.0000; val_optim_loss: 34450928.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8592; val_auprc_score: 0.8496; val_best_acc_score: 0.6780; val_best_f1_score: 0.7499; train_kl_reg_loss: 58070.6489; train_edge_recon_loss: 3824171.8056; train_gene_expr_recon_loss: 21137031.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9653316.6667; train_global_loss: 34672589.3333; train_optim_loss: 34672589.3333; val_kl_reg_loss: 49502.7031; val_edge_recon_loss: 4050735.0000; val_gene_expr_recon_loss: 20812900.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9535437.0000; val_global_loss: 34448576.0000; val_optim_loss: 34448576.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8621; val_auprc_score: 0.8547; val_best_acc_score: 0.6853; val_best_f1_score: 0.7542; train_kl_reg_loss: 57065.1016; train_edge_recon_loss: 3841721.3889; train_gene_expr_recon_loss: 21053237.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9645601.8889; train_global_loss: 34597625.7778; train_optim_loss: 34597625.7778; val_kl_reg_loss: 53871.8516; val_edge_recon_loss: 4049517.7500; val_gene_expr_recon_loss: 20772200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9532435.0000; val_global_loss: 34408024.0000; val_optim_loss: 34408024.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8599; val_auprc_score: 0.8509; val_best_acc_score: 0.6820; val_best_f1_score: 0.7523; train_kl_reg_loss: 59779.1345; train_edge_recon_loss: 3819320.9722; train_gene_expr_recon_loss: 21147756.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9670536.1111; train_global_loss: 34697392.4444; train_optim_loss: 34697392.4444; val_kl_reg_loss: 57652.0781; val_edge_recon_loss: 4050071.2500; val_gene_expr_recon_loss: 20742210.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9515143.0000; val_global_loss: 34365076.0000; val_optim_loss: 34365076.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8617; val_auprc_score: 0.8504; val_best_acc_score: 0.6801; val_best_f1_score: 0.7512; train_kl_reg_loss: 64564.2478; train_edge_recon_loss: 3781942.2500; train_gene_expr_recon_loss: 21092977.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9636066.7778; train_global_loss: 34575551.5556; train_optim_loss: 34575551.5556; val_kl_reg_loss: 59335.7188; val_edge_recon_loss: 4049642.5000; val_gene_expr_recon_loss: 20725754.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9521338.0000; val_global_loss: 34356072.0000; val_optim_loss: 34356072.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 57 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9043
Val AUPRC score: 0.8888
Val best accuracy score: 0.8200
Val best F1 score: 0.8359
Val gene expr MSE score: 0.3894
Val chrom access MSE score: 0.0834
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
