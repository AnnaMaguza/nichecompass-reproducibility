[True]
Run timestamp: 07082023_185140_51.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_51']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8890; val_auprc_score: 0.9069; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 9650.2751; train_edge_recon_loss: 36145.4180; train_gene_expr_recon_loss: 1198321.8472; train_masked_gp_l1_reg_loss: 8285.6381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166566.8854; train_chrom_access_recon_loss: 776196.3021; train_global_loss: 2195166.3611; train_optim_loss: 2195166.3611; val_kl_reg_loss: 8082.1064; val_edge_recon_loss: 40659.6172; val_gene_expr_recon_loss: 978866.6875; val_masked_gp_l1_reg_loss: 6355.8345; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161735.9219; val_chrom_access_recon_loss: 508705.7188; val_global_loss: 1704405.8750; val_optim_loss: 1704405.8750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8915; val_auprc_score: 0.9078; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 9835.1330; train_edge_recon_loss: 37310.3681; train_gene_expr_recon_loss: 902411.5694; train_masked_gp_l1_reg_loss: 5846.6754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158807.8125; train_chrom_access_recon_loss: 493106.9931; train_global_loss: 1607318.5278; train_optim_loss: 1607318.5278; val_kl_reg_loss: 12930.5781; val_edge_recon_loss: 40660.6328; val_gene_expr_recon_loss: 814693.0625; val_masked_gp_l1_reg_loss: 5639.6377; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155206.8594; val_chrom_access_recon_loss: 462628.8125; val_global_loss: 1491759.5000; val_optim_loss: 1491759.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8752; val_auprc_score: 0.8934; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16415.7210; train_edge_recon_loss: 38324.9427; train_gene_expr_recon_loss: 790825.6944; train_masked_gp_l1_reg_loss: 5891.9938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152065.3056; train_chrom_access_recon_loss: 470208.9688; train_global_loss: 1473732.6389; train_optim_loss: 1473732.6389; val_kl_reg_loss: 15988.1973; val_edge_recon_loss: 40659.7930; val_gene_expr_recon_loss: 756669.9375; val_masked_gp_l1_reg_loss: 6104.9795; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147831.6875; val_chrom_access_recon_loss: 449142.2812; val_global_loss: 1416396.8750; val_optim_loss: 1416396.8750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8706; val_auprc_score: 0.8878; val_best_acc_score: 0.5038; val_best_f1_score: 0.6683; train_kl_reg_loss: 17189.6109; train_edge_recon_loss: 38471.4588; train_gene_expr_recon_loss: 749338.1042; train_masked_gp_l1_reg_loss: 6149.6241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144048.8750; train_chrom_access_recon_loss: 456392.1632; train_global_loss: 1411589.8194; train_optim_loss: 1411589.8194; val_kl_reg_loss: 19103.5391; val_edge_recon_loss: 40658.0781; val_gene_expr_recon_loss: 726758.5000; val_masked_gp_l1_reg_loss: 6225.8691; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139168.7812; val_chrom_access_recon_loss: 442803.4062; val_global_loss: 1374718.1250; val_optim_loss: 1374718.1250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8745; val_auprc_score: 0.8885; val_best_acc_score: 0.5094; val_best_f1_score: 0.6708; train_kl_reg_loss: 20354.7839; train_edge_recon_loss: 38776.9132; train_gene_expr_recon_loss: 722306.4097; train_masked_gp_l1_reg_loss: 6240.2196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135082.0868; train_chrom_access_recon_loss: 453084.9028; train_global_loss: 1375845.3194; train_optim_loss: 1375845.3194; val_kl_reg_loss: 17615.6445; val_edge_recon_loss: 40654.9844; val_gene_expr_recon_loss: 710324.6250; val_masked_gp_l1_reg_loss: 6227.0176; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129899.4219; val_chrom_access_recon_loss: 439215.1875; val_global_loss: 1343936.8750; val_optim_loss: 1343936.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8766; val_auprc_score: 0.8814; val_best_acc_score: 0.5113; val_best_f1_score: 0.6714; train_kl_reg_loss: 19796.4052; train_edge_recon_loss: 38734.1953; train_gene_expr_recon_loss: 710759.7847; train_masked_gp_l1_reg_loss: 6243.4802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125749.0425; train_chrom_access_recon_loss: 448710.7778; train_global_loss: 1349993.6667; train_optim_loss: 1349993.6667; val_kl_reg_loss: 19057.5117; val_edge_recon_loss: 40651.6367; val_gene_expr_recon_loss: 695039.9375; val_masked_gp_l1_reg_loss: 6239.6357; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120583.9922; val_chrom_access_recon_loss: 436309.1250; val_global_loss: 1317881.7500; val_optim_loss: 1317881.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8782; val_auprc_score: 0.8795; val_best_acc_score: 0.5190; val_best_f1_score: 0.6746; train_kl_reg_loss: 20982.5462; train_edge_recon_loss: 38864.0794; train_gene_expr_recon_loss: 694003.9444; train_masked_gp_l1_reg_loss: 6237.3872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116544.2578; train_chrom_access_recon_loss: 447166.9062; train_global_loss: 1323799.1250; train_optim_loss: 1323799.1250; val_kl_reg_loss: 18881.3301; val_edge_recon_loss: 40643.0664; val_gene_expr_recon_loss: 685038.5000; val_masked_gp_l1_reg_loss: 6216.6670; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111542.6641; val_chrom_access_recon_loss: 434332.4375; val_global_loss: 1296654.7500; val_optim_loss: 1296654.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8708; val_auprc_score: 0.8735; val_best_acc_score: 0.5221; val_best_f1_score: 0.6759; train_kl_reg_loss: 20961.1359; train_edge_recon_loss: 38911.3299; train_gene_expr_recon_loss: 683243.8403; train_masked_gp_l1_reg_loss: 6214.9490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107679.3498; train_chrom_access_recon_loss: 444021.2778; train_global_loss: 1301031.8750; train_optim_loss: 1301031.8750; val_kl_reg_loss: 20661.0078; val_edge_recon_loss: 40639.5391; val_gene_expr_recon_loss: 674147.9375; val_masked_gp_l1_reg_loss: 6201.0376; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102932.6406; val_chrom_access_recon_loss: 432417.4375; val_global_loss: 1276999.6250; val_optim_loss: 1276999.6250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8696; val_auprc_score: 0.8747; val_best_acc_score: 0.5303; val_best_f1_score: 0.6792; train_kl_reg_loss: 21584.6291; train_edge_recon_loss: 38940.0269; train_gene_expr_recon_loss: 677860.6944; train_masked_gp_l1_reg_loss: 6192.4796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99305.1554; train_chrom_access_recon_loss: 444166.7465; train_global_loss: 1288049.7222; train_optim_loss: 1288049.7222; val_kl_reg_loss: 20612.2598; val_edge_recon_loss: 40632.4219; val_gene_expr_recon_loss: 667506.0625; val_masked_gp_l1_reg_loss: 6174.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94883.0469; val_chrom_access_recon_loss: 430961.8125; val_global_loss: 1260770.6250; val_optim_loss: 1260770.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8779; val_auprc_score: 0.8837; val_best_acc_score: 0.5447; val_best_f1_score: 0.6855; train_kl_reg_loss: 21540.5888; train_edge_recon_loss: 38969.3711; train_gene_expr_recon_loss: 671602.9444; train_masked_gp_l1_reg_loss: 6168.2858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91554.6189; train_chrom_access_recon_loss: 442143.4236; train_global_loss: 1271979.2361; train_optim_loss: 1271979.2361; val_kl_reg_loss: 20729.3047; val_edge_recon_loss: 40621.9258; val_gene_expr_recon_loss: 662230.5625; val_masked_gp_l1_reg_loss: 6149.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87509.1562; val_chrom_access_recon_loss: 429779.2500; val_global_loss: 1247019.8750; val_optim_loss: 1247019.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8779; val_auprc_score: 0.8792; val_best_acc_score: 0.5695; val_best_f1_score: 0.6968; train_kl_reg_loss: 21469.2695; train_edge_recon_loss: 38954.8346; train_gene_expr_recon_loss: 666855.7361; train_masked_gp_l1_reg_loss: 6146.4449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84485.5842; train_chrom_access_recon_loss: 439548.4688; train_global_loss: 1257460.3333; train_optim_loss: 1257460.3333; val_kl_reg_loss: 20563.7148; val_edge_recon_loss: 40609.5195; val_gene_expr_recon_loss: 658160.3750; val_masked_gp_l1_reg_loss: 6137.3535; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80830.8906; val_chrom_access_recon_loss: 428676.0312; val_global_loss: 1234977.8750; val_optim_loss: 1234977.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8901; val_auprc_score: 0.8885; val_best_acc_score: 0.6032; val_best_f1_score: 0.7132; train_kl_reg_loss: 21209.2925; train_edge_recon_loss: 38958.3628; train_gene_expr_recon_loss: 660396.0625; train_masked_gp_l1_reg_loss: 6131.9136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78128.1997; train_chrom_access_recon_loss: 438492.8750; train_global_loss: 1243316.7361; train_optim_loss: 1243316.7361; val_kl_reg_loss: 20278.4844; val_edge_recon_loss: 40592.7109; val_gene_expr_recon_loss: 654737.6250; val_masked_gp_l1_reg_loss: 6117.9092; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74864.0938; val_chrom_access_recon_loss: 427563.8750; val_global_loss: 1224154.7500; val_optim_loss: 1224154.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9019; val_auprc_score: 0.8990; val_best_acc_score: 0.6543; val_best_f1_score: 0.7395; train_kl_reg_loss: 20956.3902; train_edge_recon_loss: 38941.5595; train_gene_expr_recon_loss: 658281.7431; train_masked_gp_l1_reg_loss: 6115.2573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72445.3689; train_chrom_access_recon_loss: 436374.8750; train_global_loss: 1233115.1944; train_optim_loss: 1233115.1944; val_kl_reg_loss: 20757.7852; val_edge_recon_loss: 40570.2812; val_gene_expr_recon_loss: 651443.5000; val_masked_gp_l1_reg_loss: 6107.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69524.4141; val_chrom_access_recon_loss: 426452.1875; val_global_loss: 1214856.1250; val_optim_loss: 1214856.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9074; val_auprc_score: 0.8989; val_best_acc_score: 0.7157; val_best_f1_score: 0.7740; train_kl_reg_loss: 20847.0458; train_edge_recon_loss: 38913.3134; train_gene_expr_recon_loss: 653434.2569; train_masked_gp_l1_reg_loss: 6106.9816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67357.5577; train_chrom_access_recon_loss: 435598.9410; train_global_loss: 1222258.1250; train_optim_loss: 1222258.1250; val_kl_reg_loss: 19798.2812; val_edge_recon_loss: 40531.4219; val_gene_expr_recon_loss: 649199.3750; val_masked_gp_l1_reg_loss: 6100.5020; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64732.7656; val_chrom_access_recon_loss: 425738.6250; val_global_loss: 1206101.0000; val_optim_loss: 1206101.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9163; val_auprc_score: 0.9091; val_best_acc_score: 0.7642; val_best_f1_score: 0.8034; train_kl_reg_loss: 20374.9338; train_edge_recon_loss: 38877.2378; train_gene_expr_recon_loss: 652342.3889; train_masked_gp_l1_reg_loss: 6101.6039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62778.2144; train_chrom_access_recon_loss: 436727.0382; train_global_loss: 1217201.4028; train_optim_loss: 1217201.4028; val_kl_reg_loss: 19055.4258; val_edge_recon_loss: 40491.1367; val_gene_expr_recon_loss: 647774.1250; val_masked_gp_l1_reg_loss: 6098.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60406.7266; val_chrom_access_recon_loss: 424917.5312; val_global_loss: 1198743.7500; val_optim_loss: 1198743.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9160; val_auprc_score: 0.9068; val_best_acc_score: 0.8013; val_best_f1_score: 0.8276; train_kl_reg_loss: 20126.1706; train_edge_recon_loss: 38847.0538; train_gene_expr_recon_loss: 652110.1181; train_masked_gp_l1_reg_loss: 6105.4609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58646.6970; train_chrom_access_recon_loss: 433964.5382; train_global_loss: 1209800.0417; train_optim_loss: 1209800.0417; val_kl_reg_loss: 19151.0078; val_edge_recon_loss: 40448.0703; val_gene_expr_recon_loss: 645156.7500; val_masked_gp_l1_reg_loss: 6105.2256; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56513.7070; val_chrom_access_recon_loss: 424120.1562; val_global_loss: 1191494.8750; val_optim_loss: 1191494.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9263; val_auprc_score: 0.9221; val_best_acc_score: 0.8279; val_best_f1_score: 0.8449; train_kl_reg_loss: 19931.1725; train_edge_recon_loss: 38807.7569; train_gene_expr_recon_loss: 647779.7361; train_masked_gp_l1_reg_loss: 6113.3153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54924.1124; train_chrom_access_recon_loss: 433742.5139; train_global_loss: 1201298.5972; train_optim_loss: 1201298.5972; val_kl_reg_loss: 18869.8711; val_edge_recon_loss: 40383.6602; val_gene_expr_recon_loss: 643353.6250; val_masked_gp_l1_reg_loss: 6112.8169; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52981.4102; val_chrom_access_recon_loss: 423339.2500; val_global_loss: 1185040.6250; val_optim_loss: 1185040.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9217; val_auprc_score: 0.9108; val_best_acc_score: 0.8436; val_best_f1_score: 0.8545; train_kl_reg_loss: 19635.7279; train_edge_recon_loss: 38726.1758; train_gene_expr_recon_loss: 648104.5069; train_masked_gp_l1_reg_loss: 6119.5703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51529.9635; train_chrom_access_recon_loss: 434952.2153; train_global_loss: 1199068.1667; train_optim_loss: 1199068.1667; val_kl_reg_loss: 18660.5195; val_edge_recon_loss: 40321.5391; val_gene_expr_recon_loss: 641653.1250; val_masked_gp_l1_reg_loss: 6121.6040; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49760.4297; val_chrom_access_recon_loss: 423434.3750; val_global_loss: 1179951.6250; val_optim_loss: 1179951.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9240; val_auprc_score: 0.9130; val_best_acc_score: 0.8503; val_best_f1_score: 0.8568; train_kl_reg_loss: 19290.5931; train_edge_recon_loss: 38667.5282; train_gene_expr_recon_loss: 645602.4653; train_masked_gp_l1_reg_loss: 6128.7082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48440.5790; train_chrom_access_recon_loss: 432989.1146; train_global_loss: 1191118.9861; train_optim_loss: 1191118.9861; val_kl_reg_loss: 18325.8711; val_edge_recon_loss: 40249.9453; val_gene_expr_recon_loss: 640140.8750; val_masked_gp_l1_reg_loss: 6132.3833; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46827.5312; val_chrom_access_recon_loss: 422761.0938; val_global_loss: 1174437.7500; val_optim_loss: 1174437.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9303; val_auprc_score: 0.9193; val_best_acc_score: 0.8554; val_best_f1_score: 0.8574; train_kl_reg_loss: 19064.1057; train_edge_recon_loss: 38606.2891; train_gene_expr_recon_loss: 646055.8472; train_masked_gp_l1_reg_loss: 6142.1298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45622.4753; train_chrom_access_recon_loss: 433582.9479; train_global_loss: 1189073.8056; train_optim_loss: 1189073.8056; val_kl_reg_loss: 17499.8086; val_edge_recon_loss: 40159.3516; val_gene_expr_recon_loss: 639718.5625; val_masked_gp_l1_reg_loss: 6146.6660; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44142.3633; val_chrom_access_recon_loss: 422166.3125; val_global_loss: 1169833.1250; val_optim_loss: 1169833.1250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9310; val_auprc_score: 0.9190; val_best_acc_score: 0.8573; val_best_f1_score: 0.8573; train_kl_reg_loss: 18677.8969; train_edge_recon_loss: 38522.0508; train_gene_expr_recon_loss: 641447.0347; train_masked_gp_l1_reg_loss: 6155.5667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43042.9015; train_chrom_access_recon_loss: 432142.6771; train_global_loss: 1179988.1250; train_optim_loss: 1179988.1250; val_kl_reg_loss: 18223.0801; val_edge_recon_loss: 40088.5938; val_gene_expr_recon_loss: 636803.2500; val_masked_gp_l1_reg_loss: 6156.1523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41690.7734; val_chrom_access_recon_loss: 421345.4062; val_global_loss: 1164307.2500; val_optim_loss: 1164307.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9354; val_auprc_score: 0.9234; val_best_acc_score: 0.8604; val_best_f1_score: 0.8568; train_kl_reg_loss: 18592.0451; train_edge_recon_loss: 38463.2062; train_gene_expr_recon_loss: 639780.7361; train_masked_gp_l1_reg_loss: 6162.5640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40673.1441; train_chrom_access_recon_loss: 432961.5382; train_global_loss: 1176633.2222; train_optim_loss: 1176633.2222; val_kl_reg_loss: 17974.5430; val_edge_recon_loss: 40011.7188; val_gene_expr_recon_loss: 635677.2500; val_masked_gp_l1_reg_loss: 6168.2295; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39425.4609; val_chrom_access_recon_loss: 420715.1250; val_global_loss: 1159972.2500; val_optim_loss: 1159972.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9371; val_auprc_score: 0.9274; val_best_acc_score: 0.8550; val_best_f1_score: 0.8475; train_kl_reg_loss: 18395.0488; train_edge_recon_loss: 38377.9123; train_gene_expr_recon_loss: 640897.0833; train_masked_gp_l1_reg_loss: 6178.0732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38489.0109; train_chrom_access_recon_loss: 432086.5729; train_global_loss: 1174423.6944; train_optim_loss: 1174423.6944; val_kl_reg_loss: 17617.3418; val_edge_recon_loss: 39903.2148; val_gene_expr_recon_loss: 634517.7500; val_masked_gp_l1_reg_loss: 6180.2412; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37342.6250; val_chrom_access_recon_loss: 419871.0312; val_global_loss: 1155432.2500; val_optim_loss: 1155432.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9374; val_auprc_score: 0.9275; val_best_acc_score: 0.8453; val_best_f1_score: 0.8341; train_kl_reg_loss: 18157.2752; train_edge_recon_loss: 38293.8255; train_gene_expr_recon_loss: 640413.9653; train_masked_gp_l1_reg_loss: 6188.6392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36478.4753; train_chrom_access_recon_loss: 431655.4722; train_global_loss: 1171187.6806; train_optim_loss: 1171187.6806; val_kl_reg_loss: 17073.9688; val_edge_recon_loss: 39818.3047; val_gene_expr_recon_loss: 633950.1250; val_masked_gp_l1_reg_loss: 6190.6812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35412.7422; val_chrom_access_recon_loss: 419494.6250; val_global_loss: 1151940.5000; val_optim_loss: 1151940.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9387; val_auprc_score: 0.9300; val_best_acc_score: 0.8406; val_best_f1_score: 0.8326; train_kl_reg_loss: 18001.3811; train_edge_recon_loss: 38235.9154; train_gene_expr_recon_loss: 638488.7847; train_masked_gp_l1_reg_loss: 6201.7748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34618.6758; train_chrom_access_recon_loss: 430930.0486; train_global_loss: 1166476.5833; train_optim_loss: 1166476.5833; val_kl_reg_loss: 17198.5625; val_edge_recon_loss: 39758.5352; val_gene_expr_recon_loss: 632405.1875; val_masked_gp_l1_reg_loss: 6204.9585; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33627.7188; val_chrom_access_recon_loss: 418762.0000; val_global_loss: 1147957.0000; val_optim_loss: 1147957.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9420; val_auprc_score: 0.9288; val_best_acc_score: 0.8709; val_best_f1_score: 0.8788; train_kl_reg_loss: 15117.0337; train_edge_recon_loss: 40012.1797; train_gene_expr_recon_loss: 926813.4444; train_masked_gp_l1_reg_loss: 6309.4703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32763.0777; train_chrom_access_recon_loss: 455075.6910; train_global_loss: 1476090.8472; train_optim_loss: 1476090.8472; val_kl_reg_loss: 11466.6191; val_edge_recon_loss: 40330.9922; val_gene_expr_recon_loss: 911612.0000; val_masked_gp_l1_reg_loss: 6499.0449; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31594.0332; val_chrom_access_recon_loss: 443805.6250; val_global_loss: 1445308.3750; val_optim_loss: 1445308.3750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9374; val_auprc_score: 0.9272; val_best_acc_score: 0.8579; val_best_f1_score: 0.8687; train_kl_reg_loss: 13222.2971; train_edge_recon_loss: 40097.3941; train_gene_expr_recon_loss: 922446.5208; train_masked_gp_l1_reg_loss: 6669.5715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30634.7980; train_chrom_access_recon_loss: 454779.5208; train_global_loss: 1467850.1111; train_optim_loss: 1467850.1111; val_kl_reg_loss: 11028.0684; val_edge_recon_loss: 40380.3789; val_gene_expr_recon_loss: 904838.0000; val_masked_gp_l1_reg_loss: 6863.3472; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29461.1152; val_chrom_access_recon_loss: 443085.8750; val_global_loss: 1435656.7500; val_optim_loss: 1435656.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9341; val_auprc_score: 0.9236; val_best_acc_score: 0.8545; val_best_f1_score: 0.8654; train_kl_reg_loss: 12520.3636; train_edge_recon_loss: 40134.6554; train_gene_expr_recon_loss: 911896.7153; train_masked_gp_l1_reg_loss: 6984.5685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28573.3516; train_chrom_access_recon_loss: 454515.2153; train_global_loss: 1454624.8889; train_optim_loss: 1454624.8889; val_kl_reg_loss: 10737.8408; val_edge_recon_loss: 40371.6133; val_gene_expr_recon_loss: 899821.4375; val_masked_gp_l1_reg_loss: 7109.0410; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27494.8828; val_chrom_access_recon_loss: 442390.8125; val_global_loss: 1427925.6250; val_optim_loss: 1427925.6250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9338; val_auprc_score: 0.9249; val_best_acc_score: 0.8593; val_best_f1_score: 0.8676; train_kl_reg_loss: 12146.3462; train_edge_recon_loss: 40106.1176; train_gene_expr_recon_loss: 908969.6806; train_masked_gp_l1_reg_loss: 7179.5022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26689.3576; train_chrom_access_recon_loss: 455158.9062; train_global_loss: 1450249.9167; train_optim_loss: 1450249.9167; val_kl_reg_loss: 10705.6309; val_edge_recon_loss: 40347.1758; val_gene_expr_recon_loss: 895739.9375; val_masked_gp_l1_reg_loss: 7249.5869; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25715.1758; val_chrom_access_recon_loss: 441845.8438; val_global_loss: 1421603.3750; val_optim_loss: 1421603.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9396; val_auprc_score: 0.9295; val_best_acc_score: 0.8681; val_best_f1_score: 0.8750; train_kl_reg_loss: 11933.0552; train_edge_recon_loss: 40102.7622; train_gene_expr_recon_loss: 903096.5556; train_masked_gp_l1_reg_loss: 7218.1657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25551.2941; train_chrom_access_recon_loss: 452417.7396; train_global_loss: 1440319.5417; train_optim_loss: 1440319.5417; val_kl_reg_loss: 11067.0840; val_edge_recon_loss: 40337.1406; val_gene_expr_recon_loss: 894922.2500; val_masked_gp_l1_reg_loss: 7192.8730; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25373.2773; val_chrom_access_recon_loss: 441754.2500; val_global_loss: 1420646.8750; val_optim_loss: 1420646.8750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9344; val_auprc_score: 0.9255; val_best_acc_score: 0.8608; val_best_f1_score: 0.8686; train_kl_reg_loss: 12222.2961; train_edge_recon_loss: 40104.0495; train_gene_expr_recon_loss: 906008.1458; train_masked_gp_l1_reg_loss: 7188.5534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25271.5525; train_chrom_access_recon_loss: 452888.2535; train_global_loss: 1443682.8472; train_optim_loss: 1443682.8472; val_kl_reg_loss: 11060.1279; val_edge_recon_loss: 40336.5508; val_gene_expr_recon_loss: 894580.8750; val_masked_gp_l1_reg_loss: 7179.0684; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25138.5059; val_chrom_access_recon_loss: 441713.5625; val_global_loss: 1420008.7500; val_optim_loss: 1420008.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9376; val_auprc_score: 0.9289; val_best_acc_score: 0.8580; val_best_f1_score: 0.8661; train_kl_reg_loss: 12101.9476; train_edge_recon_loss: 40098.9592; train_gene_expr_recon_loss: 900287.8333; train_masked_gp_l1_reg_loss: 7174.5188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25043.2582; train_chrom_access_recon_loss: 453526.5417; train_global_loss: 1438233.0417; train_optim_loss: 1438233.0417; val_kl_reg_loss: 10985.3164; val_edge_recon_loss: 40331.2148; val_gene_expr_recon_loss: 894333.6875; val_masked_gp_l1_reg_loss: 7169.5269; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24926.8066; val_chrom_access_recon_loss: 441643.8125; val_global_loss: 1419390.3750; val_optim_loss: 1419390.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9385; val_auprc_score: 0.9321; val_best_acc_score: 0.8639; val_best_f1_score: 0.8707; train_kl_reg_loss: 12116.6649; train_edge_recon_loss: 40088.0664; train_gene_expr_recon_loss: 905119.0139; train_masked_gp_l1_reg_loss: 7166.9307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24838.5250; train_chrom_access_recon_loss: 453785.6215; train_global_loss: 1443114.7917; train_optim_loss: 1443114.7917; val_kl_reg_loss: 11059.2793; val_edge_recon_loss: 40317.5508; val_gene_expr_recon_loss: 893937.0000; val_masked_gp_l1_reg_loss: 7164.4312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24732.7773; val_chrom_access_recon_loss: 441598.9375; val_global_loss: 1418810.0000; val_optim_loss: 1418810.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9388
val AUPRC score: 0.9309
val best accuracy score: 0.8643
val best F1 score: 0.8732
val target rna MSE score: 3.8049
val source rna MSE score: 3.1720
val target atac MSE score: 0.1288
val source atac MSE score: 0.0198
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
