[True]
Run timestamp: 10102023_081008_199.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_199']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6515; val_auprc_score: 0.6500; val_best_acc_score: 0.5019; val_best_f1_score: 0.6671; train_kl_reg_loss: 53859.9354; train_edge_recon_loss: 748850.9508; train_gene_expr_recon_loss: 23285946.5152; train_masked_gp_l1_reg_loss: 41748.7903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4002961.3598; train_chrom_access_recon_loss: 6963002.8636; train_global_loss: 35096370.4242; train_optim_loss: 35096370.4242; val_kl_reg_loss: 63590.6089; val_edge_recon_loss: 813047.3203; val_gene_expr_recon_loss: 21546894.7500; val_masked_gp_l1_reg_loss: 48863.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2658266.0000; val_chrom_access_recon_loss: 6780010.1250; val_global_loss: 31910673.0000; val_optim_loss: 31910673.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7099; val_auprc_score: 0.6887; val_best_acc_score: 0.5465; val_best_f1_score: 0.6842; train_kl_reg_loss: 65829.9527; train_edge_recon_loss: 746778.5492; train_gene_expr_recon_loss: 21493258.8485; train_masked_gp_l1_reg_loss: 51476.2676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1721294.0530; train_chrom_access_recon_loss: 6652842.9621; train_global_loss: 30731480.9091; train_optim_loss: 30731480.9091; val_kl_reg_loss: 85834.0049; val_edge_recon_loss: 812531.3359; val_gene_expr_recon_loss: 21153517.0000; val_masked_gp_l1_reg_loss: 53751.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1020997.1250; val_chrom_access_recon_loss: 6662114.3750; val_global_loss: 29788746.5000; val_optim_loss: 29788746.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7120; val_auprc_score: 0.7019; val_best_acc_score: 0.6067; val_best_f1_score: 0.6947; train_kl_reg_loss: 68356.3830; train_edge_recon_loss: 734548.4138; train_gene_expr_recon_loss: 21121551.3030; train_masked_gp_l1_reg_loss: 53696.8926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 703142.3868; train_chrom_access_recon_loss: 6574470.4848; train_global_loss: 29255766.0000; train_optim_loss: 29255766.0000; val_kl_reg_loss: 69425.2959; val_edge_recon_loss: 811536.9844; val_gene_expr_recon_loss: 20980640.5000; val_masked_gp_l1_reg_loss: 53794.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 477260.2188; val_chrom_access_recon_loss: 6657975.7500; val_global_loss: 29050632.2500; val_optim_loss: 29050632.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7978; val_auprc_score: 0.7835; val_best_acc_score: 0.7160; val_best_f1_score: 0.7441; train_kl_reg_loss: 64930.5638; train_edge_recon_loss: 731022.9034; train_gene_expr_recon_loss: 20930232.2121; train_masked_gp_l1_reg_loss: 53675.3343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 368772.3594; train_chrom_access_recon_loss: 6539327.2803; train_global_loss: 28687960.6970; train_optim_loss: 28687960.6970; val_kl_reg_loss: 61423.9961; val_edge_recon_loss: 808881.7109; val_gene_expr_recon_loss: 20849683.0000; val_masked_gp_l1_reg_loss: 53847.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 286782.9375; val_chrom_access_recon_loss: 6605748.1875; val_global_loss: 28666366.7500; val_optim_loss: 28666366.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8482; val_auprc_score: 0.8241; val_best_acc_score: 0.7477; val_best_f1_score: 0.7314; train_kl_reg_loss: 60844.4257; train_edge_recon_loss: 726329.5265; train_gene_expr_recon_loss: 20762067.2121; train_masked_gp_l1_reg_loss: 54178.1119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 246290.4290; train_chrom_access_recon_loss: 6477058.7727; train_global_loss: 28326768.5152; train_optim_loss: 28326768.5152; val_kl_reg_loss: 56466.8208; val_edge_recon_loss: 801430.9375; val_gene_expr_recon_loss: 20644561.7500; val_masked_gp_l1_reg_loss: 54537.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 216765.0469; val_chrom_access_recon_loss: 6573168.3125; val_global_loss: 28346931.7500; val_optim_loss: 28346931.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8786; val_auprc_score: 0.8517; val_best_acc_score: 0.8133; val_best_f1_score: 0.8270; train_kl_reg_loss: 56708.4014; train_edge_recon_loss: 720440.1686; train_gene_expr_recon_loss: 20612587.0000; train_masked_gp_l1_reg_loss: 55090.8040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200470.4032; train_chrom_access_recon_loss: 6450549.0758; train_global_loss: 28095845.6364; train_optim_loss: 28095845.6364; val_kl_reg_loss: 53838.0708; val_edge_recon_loss: 775904.4531; val_gene_expr_recon_loss: 20372737.2500; val_masked_gp_l1_reg_loss: 55782.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 185624.5312; val_chrom_access_recon_loss: 6492995.5000; val_global_loss: 27936881.0000; val_optim_loss: 27936881.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8842; val_auprc_score: 0.8512; val_best_acc_score: 0.8160; val_best_f1_score: 0.8303; train_kl_reg_loss: 54654.8373; train_edge_recon_loss: 698722.0464; train_gene_expr_recon_loss: 20506878.3333; train_masked_gp_l1_reg_loss: 56511.5746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171736.2434; train_chrom_access_recon_loss: 6427461.5682; train_global_loss: 27915964.5455; train_optim_loss: 27915964.5455; val_kl_reg_loss: 58482.4766; val_edge_recon_loss: 679396.1406; val_gene_expr_recon_loss: 20433834.2500; val_masked_gp_l1_reg_loss: 57437.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159760.2969; val_chrom_access_recon_loss: 6541959.7500; val_global_loss: 27930870.7500; val_optim_loss: 27930870.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8689; val_auprc_score: 0.8254; val_best_acc_score: 0.8047; val_best_f1_score: 0.8277; train_kl_reg_loss: 64739.9539; train_edge_recon_loss: 646781.9214; train_gene_expr_recon_loss: 20388211.1212; train_masked_gp_l1_reg_loss: 58249.4749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148791.4529; train_chrom_access_recon_loss: 6394421.3409; train_global_loss: 27701195.3636; train_optim_loss: 27701195.3636; val_kl_reg_loss: 68540.7480; val_edge_recon_loss: 632762.4062; val_gene_expr_recon_loss: 20154852.7500; val_masked_gp_l1_reg_loss: 59095.2383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139030.2500; val_chrom_access_recon_loss: 6476866.5625; val_global_loss: 27531148.2500; val_optim_loss: 27531148.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8911; val_auprc_score: 0.8658; val_best_acc_score: 0.8100; val_best_f1_score: 0.8301; train_kl_reg_loss: 69137.9431; train_edge_recon_loss: 626203.0843; train_gene_expr_recon_loss: 20305599.0303; train_masked_gp_l1_reg_loss: 59743.7201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132039.9743; train_chrom_access_recon_loss: 6366766.1591; train_global_loss: 27559490.0909; train_optim_loss: 27559490.0909; val_kl_reg_loss: 67671.7090; val_edge_recon_loss: 624626.9609; val_gene_expr_recon_loss: 20305608.2500; val_masked_gp_l1_reg_loss: 60332.5898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125848.0625; val_chrom_access_recon_loss: 6452747.3125; val_global_loss: 27636834.5000; val_optim_loss: 27636834.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8827; val_auprc_score: 0.8505; val_best_acc_score: 0.8100; val_best_f1_score: 0.8271; train_kl_reg_loss: 69192.5678; train_edge_recon_loss: 615366.5218; train_gene_expr_recon_loss: 20201363.2727; train_masked_gp_l1_reg_loss: 60891.9480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121202.7138; train_chrom_access_recon_loss: 6334985.7576; train_global_loss: 27403002.6061; train_optim_loss: 27403002.6061; val_kl_reg_loss: 69741.1953; val_edge_recon_loss: 618513.9688; val_gene_expr_recon_loss: 20170004.2500; val_masked_gp_l1_reg_loss: 61454.5820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116991.8906; val_chrom_access_recon_loss: 6398750.6875; val_global_loss: 27435456.2500; val_optim_loss: 27435456.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9014; val_auprc_score: 0.8759; val_best_acc_score: 0.8267; val_best_f1_score: 0.8400; train_kl_reg_loss: 67070.8296; train_edge_recon_loss: 613255.0833; train_gene_expr_recon_loss: 20138760.5758; train_masked_gp_l1_reg_loss: 61901.9151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113395.7016; train_chrom_access_recon_loss: 6320554.3333; train_global_loss: 27314938.4242; train_optim_loss: 27314938.4242; val_kl_reg_loss: 66545.5576; val_edge_recon_loss: 609666.9922; val_gene_expr_recon_loss: 19967459.5000; val_masked_gp_l1_reg_loss: 62361.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110985.9062; val_chrom_access_recon_loss: 6362817.2500; val_global_loss: 27179837.5000; val_optim_loss: 27179837.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9093; val_auprc_score: 0.8849; val_best_acc_score: 0.8409; val_best_f1_score: 0.8518; train_kl_reg_loss: 66556.0668; train_edge_recon_loss: 608232.3002; train_gene_expr_recon_loss: 20063552.8182; train_masked_gp_l1_reg_loss: 62736.8935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107904.4076; train_chrom_access_recon_loss: 6296745.1742; train_global_loss: 27205727.6667; train_optim_loss: 27205727.6667; val_kl_reg_loss: 65957.3208; val_edge_recon_loss: 606999.1484; val_gene_expr_recon_loss: 20019945.0000; val_masked_gp_l1_reg_loss: 63150.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105668.0625; val_chrom_access_recon_loss: 6375823.6875; val_global_loss: 27237543.2500; val_optim_loss: 27237543.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9151; val_auprc_score: 0.8918; val_best_acc_score: 0.8471; val_best_f1_score: 0.8555; train_kl_reg_loss: 65559.3852; train_edge_recon_loss: 602073.0777; train_gene_expr_recon_loss: 19977223.9697; train_masked_gp_l1_reg_loss: 63525.7420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102730.0444; train_chrom_access_recon_loss: 6274925.5530; train_global_loss: 27086037.5758; train_optim_loss: 27086037.5758; val_kl_reg_loss: 65584.3809; val_edge_recon_loss: 608274.1484; val_gene_expr_recon_loss: 19909411.2500; val_masked_gp_l1_reg_loss: 63937.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101141.0781; val_chrom_access_recon_loss: 6325240.6250; val_global_loss: 27073590.2500; val_optim_loss: 27073590.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9211; val_auprc_score: 0.8969; val_best_acc_score: 0.8541; val_best_f1_score: 0.8623; train_kl_reg_loss: 64214.6149; train_edge_recon_loss: 601108.6714; train_gene_expr_recon_loss: 19916800.2727; train_masked_gp_l1_reg_loss: 64238.7481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98509.8061; train_chrom_access_recon_loss: 6247560.8106; train_global_loss: 26992432.6364; train_optim_loss: 26992432.6364; val_kl_reg_loss: 62700.6333; val_edge_recon_loss: 608663.3750; val_gene_expr_recon_loss: 19836752.0000; val_masked_gp_l1_reg_loss: 64646.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96740.7656; val_chrom_access_recon_loss: 6325091.6875; val_global_loss: 26994594.0000; val_optim_loss: 26994594.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9229; val_auprc_score: 0.8977; val_best_acc_score: 0.8560; val_best_f1_score: 0.8649; train_kl_reg_loss: 63675.1665; train_edge_recon_loss: 597872.9309; train_gene_expr_recon_loss: 19874599.8485; train_masked_gp_l1_reg_loss: 64871.8471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94933.9492; train_chrom_access_recon_loss: 6240590.9470; train_global_loss: 26936544.6667; train_optim_loss: 26936544.6667; val_kl_reg_loss: 62440.4121; val_edge_recon_loss: 599083.4609; val_gene_expr_recon_loss: 19813303.2500; val_masked_gp_l1_reg_loss: 65315.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93614.7344; val_chrom_access_recon_loss: 6302859.8750; val_global_loss: 26936617.2500; val_optim_loss: 26936617.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9237; val_auprc_score: 0.9022; val_best_acc_score: 0.8525; val_best_f1_score: 0.8617; train_kl_reg_loss: 63451.7336; train_edge_recon_loss: 594714.2566; train_gene_expr_recon_loss: 19791264.6970; train_masked_gp_l1_reg_loss: 65479.9441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91923.7416; train_chrom_access_recon_loss: 6212037.0682; train_global_loss: 26818871.3939; train_optim_loss: 26818871.3939; val_kl_reg_loss: 61991.2476; val_edge_recon_loss: 604956.3438; val_gene_expr_recon_loss: 19517047.2500; val_masked_gp_l1_reg_loss: 65711.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91294.2266; val_chrom_access_recon_loss: 6332973.8750; val_global_loss: 26673974.7500; val_optim_loss: 26673974.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9302; val_auprc_score: 0.9047; val_best_acc_score: 0.8622; val_best_f1_score: 0.8702; train_kl_reg_loss: 62252.5178; train_edge_recon_loss: 593526.0701; train_gene_expr_recon_loss: 19752001.8485; train_masked_gp_l1_reg_loss: 65974.1330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89696.8041; train_chrom_access_recon_loss: 6201647.9091; train_global_loss: 26765099.0000; train_optim_loss: 26765099.0000; val_kl_reg_loss: 62839.0596; val_edge_recon_loss: 596998.5859; val_gene_expr_recon_loss: 19592909.2500; val_masked_gp_l1_reg_loss: 66201.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88717.6562; val_chrom_access_recon_loss: 6264659.9375; val_global_loss: 26672327.0000; val_optim_loss: 26672327.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9396; val_auprc_score: 0.9246; val_best_acc_score: 0.8721; val_best_f1_score: 0.8792; train_kl_reg_loss: 61672.1425; train_edge_recon_loss: 591031.2576; train_gene_expr_recon_loss: 19715800.8182; train_masked_gp_l1_reg_loss: 66482.6026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87583.7715; train_chrom_access_recon_loss: 6189466.6591; train_global_loss: 26712037.3939; train_optim_loss: 26712037.3939; val_kl_reg_loss: 61120.7568; val_edge_recon_loss: 590398.0312; val_gene_expr_recon_loss: 19708143.5000; val_masked_gp_l1_reg_loss: 66780.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86723.9297; val_chrom_access_recon_loss: 6325266.6875; val_global_loss: 26838433.2500; val_optim_loss: 26838433.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9396; val_auprc_score: 0.9221; val_best_acc_score: 0.8780; val_best_f1_score: 0.8828; train_kl_reg_loss: 60956.9986; train_edge_recon_loss: 587045.5975; train_gene_expr_recon_loss: 19654801.7273; train_masked_gp_l1_reg_loss: 66995.2408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85794.7809; train_chrom_access_recon_loss: 6166687.3636; train_global_loss: 26622281.9394; train_optim_loss: 26622281.9394; val_kl_reg_loss: 61878.0566; val_edge_recon_loss: 599301.0625; val_gene_expr_recon_loss: 19513002.7500; val_masked_gp_l1_reg_loss: 67175.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85607.4453; val_chrom_access_recon_loss: 6304101.4375; val_global_loss: 26631067.2500; val_optim_loss: 26631067.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9361; val_auprc_score: 0.9132; val_best_acc_score: 0.8756; val_best_f1_score: 0.8833; train_kl_reg_loss: 60810.2311; train_edge_recon_loss: 585678.2169; train_gene_expr_recon_loss: 19612044.7576; train_masked_gp_l1_reg_loss: 67425.0857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84533.2972; train_chrom_access_recon_loss: 6146908.8333; train_global_loss: 26557400.4242; train_optim_loss: 26557400.4242; val_kl_reg_loss: 61095.2749; val_edge_recon_loss: 587624.7969; val_gene_expr_recon_loss: 19695220.5000; val_masked_gp_l1_reg_loss: 67759.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84537.8594; val_chrom_access_recon_loss: 6249019.6250; val_global_loss: 26745258.5000; val_optim_loss: 26745258.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9389; val_auprc_score: 0.9143; val_best_acc_score: 0.8786; val_best_f1_score: 0.8838; train_kl_reg_loss: 60036.9836; train_edge_recon_loss: 585030.4763; train_gene_expr_recon_loss: 19561222.1515; train_masked_gp_l1_reg_loss: 67908.3614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83666.0439; train_chrom_access_recon_loss: 6132343.4242; train_global_loss: 26490207.3333; train_optim_loss: 26490207.3333; val_kl_reg_loss: 60804.8228; val_edge_recon_loss: 589227.3672; val_gene_expr_recon_loss: 19367540.0000; val_masked_gp_l1_reg_loss: 68158.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83619.9297; val_chrom_access_recon_loss: 6146950.4375; val_global_loss: 26316300.7500; val_optim_loss: 26316300.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9363; val_auprc_score: 0.9126; val_best_acc_score: 0.8775; val_best_f1_score: 0.8842; train_kl_reg_loss: 59552.5668; train_edge_recon_loss: 586929.0634; train_gene_expr_recon_loss: 19508282.5152; train_masked_gp_l1_reg_loss: 68345.9053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83035.7544; train_chrom_access_recon_loss: 6110167.2576; train_global_loss: 26416313.0606; train_optim_loss: 26416313.0606; val_kl_reg_loss: 59522.8120; val_edge_recon_loss: 595108.9141; val_gene_expr_recon_loss: 19344324.7500; val_masked_gp_l1_reg_loss: 68608.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82929.6953; val_chrom_access_recon_loss: 6216771.5000; val_global_loss: 26367265.7500; val_optim_loss: 26367265.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9467; val_auprc_score: 0.9287; val_best_acc_score: 0.8877; val_best_f1_score: 0.8928; train_kl_reg_loss: 58868.2635; train_edge_recon_loss: 583273.0445; train_gene_expr_recon_loss: 19485501.0909; train_masked_gp_l1_reg_loss: 68828.6826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82470.6830; train_chrom_access_recon_loss: 6103576.1970; train_global_loss: 26382517.8182; train_optim_loss: 26382517.8182; val_kl_reg_loss: 59027.0161; val_edge_recon_loss: 585178.0469; val_gene_expr_recon_loss: 19478357.0000; val_masked_gp_l1_reg_loss: 69020.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81896.5391; val_chrom_access_recon_loss: 6240532.6250; val_global_loss: 26514010.7500; val_optim_loss: 26514010.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9471; val_auprc_score: 0.9309; val_best_acc_score: 0.8904; val_best_f1_score: 0.8942; train_kl_reg_loss: 58539.2712; train_edge_recon_loss: 582543.3598; train_gene_expr_recon_loss: 19434309.1212; train_masked_gp_l1_reg_loss: 69216.3807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81675.6170; train_chrom_access_recon_loss: 6090734.7803; train_global_loss: 26317018.6061; train_optim_loss: 26317018.6061; val_kl_reg_loss: 57923.6792; val_edge_recon_loss: 586996.0078; val_gene_expr_recon_loss: 19294855.7500; val_masked_gp_l1_reg_loss: 69507.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82056.8516; val_chrom_access_recon_loss: 6211338.9375; val_global_loss: 26302677.7500; val_optim_loss: 26302677.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9497; val_auprc_score: 0.9341; val_best_acc_score: 0.8917; val_best_f1_score: 0.8974; train_kl_reg_loss: 57964.9222; train_edge_recon_loss: 581178.1884; train_gene_expr_recon_loss: 19423377.3030; train_masked_gp_l1_reg_loss: 69640.6919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81710.1735; train_chrom_access_recon_loss: 6074039.8409; train_global_loss: 26287911.1212; train_optim_loss: 26287911.1212; val_kl_reg_loss: 58597.7783; val_edge_recon_loss: 583305.1172; val_gene_expr_recon_loss: 19185472.0000; val_masked_gp_l1_reg_loss: 69901.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81550.8516; val_chrom_access_recon_loss: 6187768.7500; val_global_loss: 26166595.7500; val_optim_loss: 26166595.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8575; val_auprc_score: 0.8236; val_best_acc_score: 0.7877; val_best_f1_score: 0.8076; train_kl_reg_loss: 38534.5758; train_edge_recon_loss: 720328.9186; train_gene_expr_recon_loss: 18016779.3333; train_masked_gp_l1_reg_loss: 70565.2899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85926.1239; train_chrom_access_recon_loss: 5630805.2879; train_global_loss: 24562939.3333; train_optim_loss: 24562939.3333; val_kl_reg_loss: 6124.1761; val_edge_recon_loss: 759212.4453; val_gene_expr_recon_loss: 17903622.7500; val_masked_gp_l1_reg_loss: 73610.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102070.3984; val_chrom_access_recon_loss: 5703212.3750; val_global_loss: 24547852.0000; val_optim_loss: 24547852.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8559; val_auprc_score: 0.8088; val_best_acc_score: 0.7877; val_best_f1_score: 0.8064; train_kl_reg_loss: 18763.3086; train_edge_recon_loss: 741303.5985; train_gene_expr_recon_loss: 17783995.1515; train_masked_gp_l1_reg_loss: 73051.3443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101373.2925; train_chrom_access_recon_loss: 5540503.7879; train_global_loss: 24258990.3636; train_optim_loss: 24258990.3636; val_kl_reg_loss: 5956.5446; val_edge_recon_loss: 764657.4453; val_gene_expr_recon_loss: 17719490.0000; val_masked_gp_l1_reg_loss: 72335.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100871.3672; val_chrom_access_recon_loss: 5617255.2500; val_global_loss: 24280567.5000; val_optim_loss: 24280567.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8343; val_auprc_score: 0.7848; val_best_acc_score: 0.7773; val_best_f1_score: 0.8104; train_kl_reg_loss: 18974.7463; train_edge_recon_loss: 726841.7831; train_gene_expr_recon_loss: 17674439.1970; train_masked_gp_l1_reg_loss: 71616.9909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99786.7066; train_chrom_access_recon_loss: 5506060.4848; train_global_loss: 24097719.7273; train_optim_loss: 24097719.7273; val_kl_reg_loss: 10681.9442; val_edge_recon_loss: 721130.4375; val_gene_expr_recon_loss: 17560563.2500; val_masked_gp_l1_reg_loss: 70408.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95715.7109; val_chrom_access_recon_loss: 5620138.6875; val_global_loss: 24078638.2500; val_optim_loss: 24078638.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8308; val_auprc_score: 0.7824; val_best_acc_score: 0.7773; val_best_f1_score: 0.8109; train_kl_reg_loss: 17866.5331; train_edge_recon_loss: 711681.6534; train_gene_expr_recon_loss: 17533445.9091; train_masked_gp_l1_reg_loss: 69323.6303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93501.1463; train_chrom_access_recon_loss: 5492713.5379; train_global_loss: 23918532.5152; train_optim_loss: 23918532.5152; val_kl_reg_loss: 11264.6512; val_edge_recon_loss: 709906.4844; val_gene_expr_recon_loss: 17428234.8750; val_masked_gp_l1_reg_loss: 68212.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92171.8359; val_chrom_access_recon_loss: 5574082.8125; val_global_loss: 23883873.0000; val_optim_loss: 23883873.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8454; val_auprc_score: 0.7978; val_best_acc_score: 0.7939; val_best_f1_score: 0.8213; train_kl_reg_loss: 19746.7521; train_edge_recon_loss: 684681.0028; train_gene_expr_recon_loss: 17473575.8636; train_masked_gp_l1_reg_loss: 67486.9992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91096.3345; train_chrom_access_recon_loss: 5472666.4924; train_global_loss: 23809253.5152; train_optim_loss: 23809253.5152; val_kl_reg_loss: 11120.5588; val_edge_recon_loss: 679947.5234; val_gene_expr_recon_loss: 17441120.7500; val_masked_gp_l1_reg_loss: 66776.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90340.1016; val_chrom_access_recon_loss: 5534139.7500; val_global_loss: 23823444.7500; val_optim_loss: 23823444.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8470; val_auprc_score: 0.8024; val_best_acc_score: 0.7912; val_best_f1_score: 0.8177; train_kl_reg_loss: 18878.1934; train_edge_recon_loss: 667073.4290; train_gene_expr_recon_loss: 17430646.7424; train_masked_gp_l1_reg_loss: 66061.7862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90289.6314; train_chrom_access_recon_loss: 5465375.4848; train_global_loss: 23738325.1212; train_optim_loss: 23738325.1212; val_kl_reg_loss: 13170.1194; val_edge_recon_loss: 657471.7266; val_gene_expr_recon_loss: 17481518.5000; val_masked_gp_l1_reg_loss: 65392.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89430.3125; val_chrom_access_recon_loss: 5540363.1875; val_global_loss: 23847346.0000; val_optim_loss: 23847346.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8454; val_auprc_score: 0.8044; val_best_acc_score: 0.7918; val_best_f1_score: 0.8221; train_kl_reg_loss: 20579.6555; train_edge_recon_loss: 641920.2528; train_gene_expr_recon_loss: 17408493.2121; train_masked_gp_l1_reg_loss: 64796.0331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87936.4710; train_chrom_access_recon_loss: 5449909.9167; train_global_loss: 23673635.4848; train_optim_loss: 23673635.4848; val_kl_reg_loss: 15013.4678; val_edge_recon_loss: 631442.2578; val_gene_expr_recon_loss: 17236137.7500; val_masked_gp_l1_reg_loss: 64189.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87112.1328; val_chrom_access_recon_loss: 5483785.2500; val_global_loss: 23517680.5000; val_optim_loss: 23517680.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8500; val_auprc_score: 0.8150; val_best_acc_score: 0.7853; val_best_f1_score: 0.8181; train_kl_reg_loss: 22893.9254; train_edge_recon_loss: 624083.4962; train_gene_expr_recon_loss: 17349783.1970; train_masked_gp_l1_reg_loss: 63612.9036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85964.1014; train_chrom_access_recon_loss: 5438015.2955; train_global_loss: 23584353.0303; train_optim_loss: 23584353.0303; val_kl_reg_loss: 18557.4739; val_edge_recon_loss: 622256.7656; val_gene_expr_recon_loss: 17394622.1250; val_masked_gp_l1_reg_loss: 62983.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84786.5078; val_chrom_access_recon_loss: 5504773.1875; val_global_loss: 23687979.5000; val_optim_loss: 23687979.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8543; val_auprc_score: 0.8221; val_best_acc_score: 0.7907; val_best_f1_score: 0.8195; train_kl_reg_loss: 23018.3940; train_edge_recon_loss: 617926.2500; train_gene_expr_recon_loss: 17315097.6212; train_masked_gp_l1_reg_loss: 62460.1710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84174.6645; train_chrom_access_recon_loss: 5422703.6818; train_global_loss: 23525380.6061; train_optim_loss: 23525380.6061; val_kl_reg_loss: 17078.6277; val_edge_recon_loss: 627267.4844; val_gene_expr_recon_loss: 17346303.3750; val_masked_gp_l1_reg_loss: 61998.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84048.0469; val_chrom_access_recon_loss: 5483624.0625; val_global_loss: 23620319.7500; val_optim_loss: 23620319.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8496; val_auprc_score: 0.8088; val_best_acc_score: 0.7896; val_best_f1_score: 0.8195; train_kl_reg_loss: 22634.0049; train_edge_recon_loss: 614034.6487; train_gene_expr_recon_loss: 17308785.7121; train_masked_gp_l1_reg_loss: 61488.8327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83112.9422; train_chrom_access_recon_loss: 5422738.6591; train_global_loss: 23512795.1212; train_optim_loss: 23512795.1212; val_kl_reg_loss: 20660.8086; val_edge_recon_loss: 613222.3672; val_gene_expr_recon_loss: 17271437.0000; val_masked_gp_l1_reg_loss: 61001.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82230.7266; val_chrom_access_recon_loss: 5503869.9375; val_global_loss: 23552422.2500; val_optim_loss: 23552422.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8657; val_auprc_score: 0.8387; val_best_acc_score: 0.7958; val_best_f1_score: 0.8205; train_kl_reg_loss: 24830.6407; train_edge_recon_loss: 608271.4470; train_gene_expr_recon_loss: 17261142.9697; train_masked_gp_l1_reg_loss: 60482.6625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81270.5292; train_chrom_access_recon_loss: 5399751.4621; train_global_loss: 23435749.5455; train_optim_loss: 23435749.5455; val_kl_reg_loss: 22322.5322; val_edge_recon_loss: 605885.6250; val_gene_expr_recon_loss: 17123649.2500; val_masked_gp_l1_reg_loss: 59909.7305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80255.9141; val_chrom_access_recon_loss: 5419777.5000; val_global_loss: 23311801.0000; val_optim_loss: 23311801.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8681; val_auprc_score: 0.8376; val_best_acc_score: 0.7955; val_best_f1_score: 0.8222; train_kl_reg_loss: 26220.6995; train_edge_recon_loss: 602276.1723; train_gene_expr_recon_loss: 17249608.9697; train_masked_gp_l1_reg_loss: 59510.4125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79528.8275; train_chrom_access_recon_loss: 5396275.0833; train_global_loss: 23413420.2121; train_optim_loss: 23413420.2121; val_kl_reg_loss: 24681.7141; val_edge_recon_loss: 607215.6797; val_gene_expr_recon_loss: 17153274.5000; val_masked_gp_l1_reg_loss: 59112.4961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79114.8984; val_chrom_access_recon_loss: 5494083.5625; val_global_loss: 23417481.2500; val_optim_loss: 23417481.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8628; val_auprc_score: 0.8234; val_best_acc_score: 0.8001; val_best_f1_score: 0.8251; train_kl_reg_loss: 28185.2996; train_edge_recon_loss: 599483.1667; train_gene_expr_recon_loss: 17204218.9091; train_masked_gp_l1_reg_loss: 58691.7610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78261.1136; train_chrom_access_recon_loss: 5385403.2652; train_global_loss: 23354243.4242; train_optim_loss: 23354243.4242; val_kl_reg_loss: 23975.2866; val_edge_recon_loss: 603491.5078; val_gene_expr_recon_loss: 17254237.6250; val_masked_gp_l1_reg_loss: 58352.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77644.2422; val_chrom_access_recon_loss: 5447410.4375; val_global_loss: 23465110.7500; val_optim_loss: 23465110.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8687; val_auprc_score: 0.8370; val_best_acc_score: 0.7977; val_best_f1_score: 0.8225; train_kl_reg_loss: 29321.8741; train_edge_recon_loss: 594932.0256; train_gene_expr_recon_loss: 17187590.7727; train_masked_gp_l1_reg_loss: 57980.1504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77010.8983; train_chrom_access_recon_loss: 5379884.5227; train_global_loss: 23326720.1515; train_optim_loss: 23326720.1515; val_kl_reg_loss: 24998.4868; val_edge_recon_loss: 598786.2500; val_gene_expr_recon_loss: 17222243.2500; val_masked_gp_l1_reg_loss: 57656.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76285.5234; val_chrom_access_recon_loss: 5454479.0000; val_global_loss: 23434449.0000; val_optim_loss: 23434449.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8609; val_auprc_score: 0.8259; val_best_acc_score: 0.7929; val_best_f1_score: 0.8173; train_kl_reg_loss: 30075.7824; train_edge_recon_loss: 592910.7794; train_gene_expr_recon_loss: 17174364.8030; train_masked_gp_l1_reg_loss: 57307.3331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75835.7282; train_chrom_access_recon_loss: 5376976.8106; train_global_loss: 23307471.1515; train_optim_loss: 23307471.1515; val_kl_reg_loss: 26365.7886; val_edge_recon_loss: 607060.3906; val_gene_expr_recon_loss: 17225087.7500; val_masked_gp_l1_reg_loss: 57017.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75363.5625; val_chrom_access_recon_loss: 5488236.7500; val_global_loss: 23479132.5000; val_optim_loss: 23479132.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8736; val_auprc_score: 0.8312; val_best_acc_score: 0.8087; val_best_f1_score: 0.8313; train_kl_reg_loss: 30973.2229; train_edge_recon_loss: 589915.4413; train_gene_expr_recon_loss: 17200151.7576; train_masked_gp_l1_reg_loss: 56714.3536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66148.1850; train_chrom_access_recon_loss: 5445867.5076; train_global_loss: 23389770.5758; train_optim_loss: 23389770.5758; val_kl_reg_loss: 27600.4167; val_edge_recon_loss: 592763.8906; val_gene_expr_recon_loss: 17097478.5000; val_masked_gp_l1_reg_loss: 56502.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63440.6328; val_chrom_access_recon_loss: 5540363.6250; val_global_loss: 23378148.2500; val_optim_loss: 23378148.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8705; val_auprc_score: 0.8351; val_best_acc_score: 0.8079; val_best_f1_score: 0.8298; train_kl_reg_loss: 31372.2054; train_edge_recon_loss: 594024.3191; train_gene_expr_recon_loss: 17181401.1667; train_masked_gp_l1_reg_loss: 56420.4405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62489.6402; train_chrom_access_recon_loss: 5402282.2197; train_global_loss: 23327990.0606; train_optim_loss: 23327990.0606; val_kl_reg_loss: 27571.7600; val_edge_recon_loss: 589068.4062; val_gene_expr_recon_loss: 17332107.0000; val_masked_gp_l1_reg_loss: 56343.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61773.9805; val_chrom_access_recon_loss: 5495964.3125; val_global_loss: 23562829.7500; val_optim_loss: 23562829.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8709; val_auprc_score: 0.8377; val_best_acc_score: 0.8076; val_best_f1_score: 0.8283; train_kl_reg_loss: 31406.3825; train_edge_recon_loss: 591459.7775; train_gene_expr_recon_loss: 17148915.8788; train_masked_gp_l1_reg_loss: 56288.3351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61332.8483; train_chrom_access_recon_loss: 5376947.6364; train_global_loss: 23266350.8182; train_optim_loss: 23266350.8182; val_kl_reg_loss: 27521.2891; val_edge_recon_loss: 595112.4922; val_gene_expr_recon_loss: 17040646.0000; val_masked_gp_l1_reg_loss: 56227.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60892.3750; val_chrom_access_recon_loss: 5453996.4375; val_global_loss: 23234396.0000; val_optim_loss: 23234396.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8703; val_auprc_score: 0.8365; val_best_acc_score: 0.8057; val_best_f1_score: 0.8280; train_kl_reg_loss: 31410.6706; train_edge_recon_loss: 590329.4754; train_gene_expr_recon_loss: 17152959.8636; train_masked_gp_l1_reg_loss: 56173.6748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60622.0334; train_chrom_access_recon_loss: 5374216.5303; train_global_loss: 23265712.2424; train_optim_loss: 23265712.2424; val_kl_reg_loss: 27847.1992; val_edge_recon_loss: 597800.7656; val_gene_expr_recon_loss: 17110804.0000; val_masked_gp_l1_reg_loss: 56115.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60345.8711; val_chrom_access_recon_loss: 5460402.8125; val_global_loss: 23313316.7500; val_optim_loss: 23313316.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8789; val_auprc_score: 0.8422; val_best_acc_score: 0.8130; val_best_f1_score: 0.8321; train_kl_reg_loss: 31525.3814; train_edge_recon_loss: 591453.6222; train_gene_expr_recon_loss: 17141006.8636; train_masked_gp_l1_reg_loss: 56070.2863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60152.1894; train_chrom_access_recon_loss: 5371664.3864; train_global_loss: 23251872.6667; train_optim_loss: 23251872.6667; val_kl_reg_loss: 27586.4292; val_edge_recon_loss: 593328.5156; val_gene_expr_recon_loss: 17007446.5000; val_masked_gp_l1_reg_loss: 56020.2383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59957.7578; val_chrom_access_recon_loss: 5406498.3750; val_global_loss: 23150838.0000; val_optim_loss: 23150838.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8813; val_auprc_score: 0.8442; val_best_acc_score: 0.8122; val_best_f1_score: 0.8337; train_kl_reg_loss: 31774.0226; train_edge_recon_loss: 591710.1345; train_gene_expr_recon_loss: 17146321.0152; train_masked_gp_l1_reg_loss: 55975.0968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59773.7048; train_chrom_access_recon_loss: 5373162.5303; train_global_loss: 23258716.5152; train_optim_loss: 23258716.5152; val_kl_reg_loss: 27575.3584; val_edge_recon_loss: 590248.9297; val_gene_expr_recon_loss: 17014810.0000; val_masked_gp_l1_reg_loss: 55928.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59603.9531; val_chrom_access_recon_loss: 5422979.7500; val_global_loss: 23171146.2500; val_optim_loss: 23171146.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8752; val_auprc_score: 0.8397; val_best_acc_score: 0.8076; val_best_f1_score: 0.8278; train_kl_reg_loss: 31673.2755; train_edge_recon_loss: 592379.0758; train_gene_expr_recon_loss: 17165422.6970; train_masked_gp_l1_reg_loss: 55891.8859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59458.8981; train_chrom_access_recon_loss: 5373440.0682; train_global_loss: 23278265.4545; train_optim_loss: 23278265.4545; val_kl_reg_loss: 28260.3926; val_edge_recon_loss: 594095.8906; val_gene_expr_recon_loss: 16972496.1250; val_masked_gp_l1_reg_loss: 55846.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59340.1602; val_chrom_access_recon_loss: 5415286.1250; val_global_loss: 23125324.5000; val_optim_loss: 23125324.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8790; val_auprc_score: 0.8488; val_best_acc_score: 0.8066; val_best_f1_score: 0.8290; train_kl_reg_loss: 31880.6101; train_edge_recon_loss: 589609.3968; train_gene_expr_recon_loss: 17145256.0303; train_masked_gp_l1_reg_loss: 55798.1510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59206.5516; train_chrom_access_recon_loss: 5366040.3030; train_global_loss: 23247791.1212; train_optim_loss: 23247791.1212; val_kl_reg_loss: 28294.2200; val_edge_recon_loss: 589144.6172; val_gene_expr_recon_loss: 17016285.8750; val_masked_gp_l1_reg_loss: 55758.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59069.7148; val_chrom_access_recon_loss: 5463643.4375; val_global_loss: 23212196.5000; val_optim_loss: 23212196.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8772; val_auprc_score: 0.8385; val_best_acc_score: 0.8149; val_best_f1_score: 0.8333; train_kl_reg_loss: 31958.4094; train_edge_recon_loss: 590760.1496; train_gene_expr_recon_loss: 17146632.2121; train_masked_gp_l1_reg_loss: 55720.4796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58968.1384; train_chrom_access_recon_loss: 5370441.1591; train_global_loss: 23254480.5758; train_optim_loss: 23254480.5758; val_kl_reg_loss: 28255.2246; val_edge_recon_loss: 594947.3047; val_gene_expr_recon_loss: 17219880.3750; val_masked_gp_l1_reg_loss: 55676.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58868.4180; val_chrom_access_recon_loss: 5428746.9375; val_global_loss: 23386374.2500; val_optim_loss: 23386374.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8596; val_auprc_score: 0.8148; val_best_acc_score: 0.7950; val_best_f1_score: 0.8208; train_kl_reg_loss: 32006.1681; train_edge_recon_loss: 590899.2566; train_gene_expr_recon_loss: 17145352.7727; train_masked_gp_l1_reg_loss: 55634.4437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58765.4999; train_chrom_access_recon_loss: 5366465.4545; train_global_loss: 23249123.8182; train_optim_loss: 23249123.8182; val_kl_reg_loss: 28245.3003; val_edge_recon_loss: 603868.3672; val_gene_expr_recon_loss: 16991017.3750; val_masked_gp_l1_reg_loss: 55581.2305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58622.9727; val_chrom_access_recon_loss: 5389871.0625; val_global_loss: 23127205.7500; val_optim_loss: 23127205.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8765; val_auprc_score: 0.8442; val_best_acc_score: 0.8090; val_best_f1_score: 0.8294; train_kl_reg_loss: 32137.2837; train_edge_recon_loss: 589987.9053; train_gene_expr_recon_loss: 17145954.5455; train_masked_gp_l1_reg_loss: 55548.8739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58512.5757; train_chrom_access_recon_loss: 5362940.3182; train_global_loss: 23245081.3030; train_optim_loss: 23245081.3030; val_kl_reg_loss: 29021.3811; val_edge_recon_loss: 595742.1953; val_gene_expr_recon_loss: 16993050.5000; val_masked_gp_l1_reg_loss: 55504.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58400.3320; val_chrom_access_recon_loss: 5450848.6875; val_global_loss: 23182567.2500; val_optim_loss: 23182567.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8726; val_auprc_score: 0.8310; val_best_acc_score: 0.8079; val_best_f1_score: 0.8298; train_kl_reg_loss: 32366.6274; train_edge_recon_loss: 589726.1657; train_gene_expr_recon_loss: 17134835.8182; train_masked_gp_l1_reg_loss: 55477.9196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57495.8248; train_chrom_access_recon_loss: 5366468.4621; train_global_loss: 23236370.7576; train_optim_loss: 23236370.7576; val_kl_reg_loss: 28608.6016; val_edge_recon_loss: 587918.3359; val_gene_expr_recon_loss: 17096861.2500; val_masked_gp_l1_reg_loss: 55461.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57312.8555; val_chrom_access_recon_loss: 5442240.5625; val_global_loss: 23268402.7500; val_optim_loss: 23268402.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8715; val_auprc_score: 0.8312; val_best_acc_score: 0.8052; val_best_f1_score: 0.8274; train_kl_reg_loss: 32234.4779; train_edge_recon_loss: 588621.0455; train_gene_expr_recon_loss: 17137612.3182; train_masked_gp_l1_reg_loss: 55453.8618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57286.9787; train_chrom_access_recon_loss: 5367839.8030; train_global_loss: 23239048.2424; train_optim_loss: 23239048.2424; val_kl_reg_loss: 28812.0740; val_edge_recon_loss: 588133.9062; val_gene_expr_recon_loss: 17114360.3750; val_masked_gp_l1_reg_loss: 55446.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57262.0938; val_chrom_access_recon_loss: 5488388.1250; val_global_loss: 23332402.2500; val_optim_loss: 23332402.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8798; val_auprc_score: 0.8433; val_best_acc_score: 0.8138; val_best_f1_score: 0.8318; train_kl_reg_loss: 32221.1291; train_edge_recon_loss: 589754.5881; train_gene_expr_recon_loss: 17143404.4848; train_masked_gp_l1_reg_loss: 55440.4252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57239.6303; train_chrom_access_recon_loss: 5368379.5758; train_global_loss: 23246439.8182; train_optim_loss: 23246439.8182; val_kl_reg_loss: 28353.3645; val_edge_recon_loss: 585425.4531; val_gene_expr_recon_loss: 17058217.6250; val_masked_gp_l1_reg_loss: 55433.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57218.0586; val_chrom_access_recon_loss: 5387173.4375; val_global_loss: 23171821.7500; val_optim_loss: 23171821.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8805; val_auprc_score: 0.8453; val_best_acc_score: 0.8170; val_best_f1_score: 0.8345; train_kl_reg_loss: 32188.9176; train_edge_recon_loss: 588072.6439; train_gene_expr_recon_loss: 17133079.1667; train_masked_gp_l1_reg_loss: 55427.9329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57201.2727; train_chrom_access_recon_loss: 5364830.2197; train_global_loss: 23230800.0606; train_optim_loss: 23230800.0606; val_kl_reg_loss: 28699.3601; val_edge_recon_loss: 586480.9453; val_gene_expr_recon_loss: 17160456.0000; val_masked_gp_l1_reg_loss: 55422.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57181.6758; val_chrom_access_recon_loss: 5502022.6875; val_global_loss: 23390263.2500; val_optim_loss: 23390263.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 4 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.8728
val AUPRC score: 0.8375
val best accuracy score: 0.8049
val best F1 score: 0.8274
val target rna MSE score: 2.1725
val source rna MSE score: 1.8738
val target atac MSE score: 0.3307
val source atac MSE score: 0.1394
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
