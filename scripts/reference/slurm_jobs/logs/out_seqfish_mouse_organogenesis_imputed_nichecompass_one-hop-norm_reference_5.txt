[True]
Run timestamp: 02082023_021426_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '5', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8904; val_auprc_score: 0.9781; val_best_acc_score: 0.8788; val_best_f1_score: 0.9315; train_kl_reg_loss: 45729.0137; train_edge_recon_loss: 112217.6028; train_gene_expr_recon_loss: 2377997.5157; train_masked_gp_l1_reg_loss: 5722.1677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36899.9683; train_global_loss: 2578566.2616; train_optim_loss: 2578566.2616; val_kl_reg_loss: 29314.7996; val_edge_recon_loss: 106551.9501; val_gene_expr_recon_loss: 1995773.9288; val_masked_gp_l1_reg_loss: 6656.4551; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29139.6387; val_global_loss: 2167436.9194; val_optim_loss: 2167436.9194
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9308; val_auprc_score: 0.9852; val_best_acc_score: 0.9223; val_best_f1_score: 0.9555; train_kl_reg_loss: 25077.3892; train_edge_recon_loss: 100547.4867; train_gene_expr_recon_loss: 1898873.1033; train_masked_gp_l1_reg_loss: 7526.7178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24726.4161; train_global_loss: 2056751.1136; train_optim_loss: 2056751.1136; val_kl_reg_loss: 22338.8061; val_edge_recon_loss: 97403.2145; val_gene_expr_recon_loss: 1817999.0484; val_masked_gp_l1_reg_loss: 8272.2832; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20869.2070; val_global_loss: 1966882.5659; val_optim_loss: 1966882.5659
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9489; val_auprc_score: 0.9889; val_best_acc_score: 0.9412; val_best_f1_score: 0.9663; train_kl_reg_loss: 19231.2133; train_edge_recon_loss: 94292.3154; train_gene_expr_recon_loss: 1756564.7563; train_masked_gp_l1_reg_loss: 8746.7495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18225.4039; train_global_loss: 1897060.4386; train_optim_loss: 1897060.4386; val_kl_reg_loss: 16837.5918; val_edge_recon_loss: 90378.3785; val_gene_expr_recon_loss: 1701695.6734; val_masked_gp_l1_reg_loss: 9091.9551; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16070.6396; val_global_loss: 1834074.2675; val_optim_loss: 1834074.2675
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9605; val_auprc_score: 0.9915; val_best_acc_score: 0.9533; val_best_f1_score: 0.9731; train_kl_reg_loss: 14859.9808; train_edge_recon_loss: 89605.1848; train_gene_expr_recon_loss: 1659224.1389; train_masked_gp_l1_reg_loss: 9069.4266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14641.0197; train_global_loss: 1787399.7525; train_optim_loss: 1787399.7525; val_kl_reg_loss: 12757.6625; val_edge_recon_loss: 85628.2608; val_gene_expr_recon_loss: 1621387.4449; val_masked_gp_l1_reg_loss: 8863.7295; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13429.7217; val_global_loss: 1742066.8710; val_optim_loss: 1742066.8710
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9606; val_auprc_score: 0.9913; val_best_acc_score: 0.9526; val_best_f1_score: 0.9727; train_kl_reg_loss: 11712.1815; train_edge_recon_loss: 84465.2220; train_gene_expr_recon_loss: 1588486.4137; train_masked_gp_l1_reg_loss: 8388.2074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12480.9067; train_global_loss: 1705532.9277; train_optim_loss: 1705532.9277; val_kl_reg_loss: 10922.3714; val_edge_recon_loss: 83565.0975; val_gene_expr_recon_loss: 1563654.3871; val_masked_gp_l1_reg_loss: 7833.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11614.6270; val_global_loss: 1677590.3535; val_optim_loss: 1677590.3535
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9573; val_auprc_score: 0.9904; val_best_acc_score: 0.9481; val_best_f1_score: 0.9701; train_kl_reg_loss: 10131.9310; train_edge_recon_loss: 82642.4631; train_gene_expr_recon_loss: 1536556.6716; train_masked_gp_l1_reg_loss: 7300.7194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10765.2919; train_global_loss: 1647397.0805; train_optim_loss: 1647397.0805; val_kl_reg_loss: 10736.9150; val_edge_recon_loss: 84044.5088; val_gene_expr_recon_loss: 1524730.5901; val_masked_gp_l1_reg_loss: 6831.4053; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9851.8545; val_global_loss: 1636195.2648; val_optim_loss: 1636195.2648
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9625; val_auprc_score: 0.9915; val_best_acc_score: 0.9553; val_best_f1_score: 0.9742; train_kl_reg_loss: 9416.8192; train_edge_recon_loss: 81918.0516; train_gene_expr_recon_loss: 1501838.8575; train_masked_gp_l1_reg_loss: 6502.0604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8988.1489; train_global_loss: 1608663.9410; train_optim_loss: 1608663.9410; val_kl_reg_loss: 10030.5726; val_edge_recon_loss: 81805.7875; val_gene_expr_recon_loss: 1495219.5901; val_masked_gp_l1_reg_loss: 6223.3760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8148.9639; val_global_loss: 1601428.3280; val_optim_loss: 1601428.3280
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9638; val_auprc_score: 0.9921; val_best_acc_score: 0.9578; val_best_f1_score: 0.9757; train_kl_reg_loss: 9016.7180; train_edge_recon_loss: 81331.2142; train_gene_expr_recon_loss: 1476360.6263; train_masked_gp_l1_reg_loss: 6052.2401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7528.3772; train_global_loss: 1580289.1777; train_optim_loss: 1580289.1777; val_kl_reg_loss: 9133.8751; val_edge_recon_loss: 79354.5780; val_gene_expr_recon_loss: 1467376.0242; val_masked_gp_l1_reg_loss: 5900.2026; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7017.9448; val_global_loss: 1568782.7285; val_optim_loss: 1568782.7285
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9678; val_auprc_score: 0.9924; val_best_acc_score: 0.9589; val_best_f1_score: 0.9762; train_kl_reg_loss: 8774.9240; train_edge_recon_loss: 80417.3442; train_gene_expr_recon_loss: 1457386.0860; train_masked_gp_l1_reg_loss: 5797.7945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6642.2728; train_global_loss: 1559018.4214; train_optim_loss: 1559018.4214; val_kl_reg_loss: 8592.2415; val_edge_recon_loss: 80747.2814; val_gene_expr_recon_loss: 1451288.5242; val_masked_gp_l1_reg_loss: 5705.7134; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6308.5669; val_global_loss: 1552642.4261; val_optim_loss: 1552642.4261
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9672; val_auprc_score: 0.9920; val_best_acc_score: 0.9597; val_best_f1_score: 0.9766; train_kl_reg_loss: 8605.3933; train_edge_recon_loss: 80525.5949; train_gene_expr_recon_loss: 1445445.0933; train_masked_gp_l1_reg_loss: 5652.3653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6061.5508; train_global_loss: 1546289.9936; train_optim_loss: 1546289.9936; val_kl_reg_loss: 8512.0640; val_edge_recon_loss: 80773.4349; val_gene_expr_recon_loss: 1442203.9530; val_masked_gp_l1_reg_loss: 5591.9556; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5850.0156; val_global_loss: 1542931.4489; val_optim_loss: 1542931.4489
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9639; val_auprc_score: 0.9912; val_best_acc_score: 0.9578; val_best_f1_score: 0.9756; train_kl_reg_loss: 8482.5861; train_edge_recon_loss: 79781.4872; train_gene_expr_recon_loss: 1437786.8185; train_masked_gp_l1_reg_loss: 5554.2685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5684.5821; train_global_loss: 1537289.7451; train_optim_loss: 1537289.7451; val_kl_reg_loss: 8517.3595; val_edge_recon_loss: 80953.4207; val_gene_expr_recon_loss: 1435066.8387; val_masked_gp_l1_reg_loss: 5514.4897; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5528.4746; val_global_loss: 1535580.6196; val_optim_loss: 1535580.6196
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9656; val_auprc_score: 0.9918; val_best_acc_score: 0.9606; val_best_f1_score: 0.9772; train_kl_reg_loss: 8455.9904; train_edge_recon_loss: 79926.6752; train_gene_expr_recon_loss: 1431529.7200; train_masked_gp_l1_reg_loss: 5504.9383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5432.4708; train_global_loss: 1530849.7958; train_optim_loss: 1530849.7958; val_kl_reg_loss: 8158.3193; val_edge_recon_loss: 80137.8830; val_gene_expr_recon_loss: 1429833.5941; val_masked_gp_l1_reg_loss: 5487.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5348.6738; val_global_loss: 1528965.9261; val_optim_loss: 1528965.9261
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9639; val_auprc_score: 0.9911; val_best_acc_score: 0.9590; val_best_f1_score: 0.9762; train_kl_reg_loss: 8394.0743; train_edge_recon_loss: 79268.1796; train_gene_expr_recon_loss: 1427221.8984; train_masked_gp_l1_reg_loss: 5472.4404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5253.0038; train_global_loss: 1525609.5951; train_optim_loss: 1525609.5951; val_kl_reg_loss: 8470.2785; val_edge_recon_loss: 82584.8317; val_gene_expr_recon_loss: 1429116.3898; val_masked_gp_l1_reg_loss: 5443.9966; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5133.2808; val_global_loss: 1530748.7527; val_optim_loss: 1530748.7527
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9624; val_auprc_score: 0.9914; val_best_acc_score: 0.9585; val_best_f1_score: 0.9760; train_kl_reg_loss: 8372.8958; train_edge_recon_loss: 80561.2910; train_gene_expr_recon_loss: 1424618.3359; train_masked_gp_l1_reg_loss: 5454.0377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5024.7682; train_global_loss: 1524031.3281; train_optim_loss: 1524031.3281; val_kl_reg_loss: 8489.4776; val_edge_recon_loss: 79372.0278; val_gene_expr_recon_loss: 1427190.7836; val_masked_gp_l1_reg_loss: 5451.8350; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4904.2930; val_global_loss: 1525408.4113; val_optim_loss: 1525408.4113
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9670; val_auprc_score: 0.9924; val_best_acc_score: 0.9586; val_best_f1_score: 0.9760; train_kl_reg_loss: 8366.6023; train_edge_recon_loss: 79977.7789; train_gene_expr_recon_loss: 1422456.1595; train_masked_gp_l1_reg_loss: 5446.5054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4800.6593; train_global_loss: 1521047.7042; train_optim_loss: 1521047.7042; val_kl_reg_loss: 8556.2682; val_edge_recon_loss: 79664.0526; val_gene_expr_recon_loss: 1425310.9892; val_masked_gp_l1_reg_loss: 5432.2485; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4680.6182; val_global_loss: 1523644.1882; val_optim_loss: 1523644.1882
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9632; val_auprc_score: 0.9915; val_best_acc_score: 0.9549; val_best_f1_score: 0.9738; train_kl_reg_loss: 8467.4023; train_edge_recon_loss: 80132.8634; train_gene_expr_recon_loss: 1427462.5476; train_masked_gp_l1_reg_loss: 5475.7721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4649.6051; train_global_loss: 1526188.1901; train_optim_loss: 1526188.1901; val_kl_reg_loss: 8406.3325; val_edge_recon_loss: 83640.1893; val_gene_expr_recon_loss: 1428959.6828; val_masked_gp_l1_reg_loss: 5353.7314; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4557.7910; val_global_loss: 1530917.7016; val_optim_loss: 1530917.7016
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9651; val_auprc_score: 0.9918; val_best_acc_score: 0.9575; val_best_f1_score: 0.9753; train_kl_reg_loss: 8309.4616; train_edge_recon_loss: 80108.3090; train_gene_expr_recon_loss: 1422037.8899; train_masked_gp_l1_reg_loss: 5351.7035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4466.1139; train_global_loss: 1520273.4779; train_optim_loss: 1520273.4779; val_kl_reg_loss: 8291.9662; val_edge_recon_loss: 81092.6497; val_gene_expr_recon_loss: 1422688.9261; val_masked_gp_l1_reg_loss: 5361.4331; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4382.3042; val_global_loss: 1521817.1613; val_optim_loss: 1521817.1613
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9672; val_auprc_score: 0.9922; val_best_acc_score: 0.9572; val_best_f1_score: 0.9752; train_kl_reg_loss: 8237.6896; train_edge_recon_loss: 79621.7404; train_gene_expr_recon_loss: 1420564.6640; train_masked_gp_l1_reg_loss: 5377.2269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4311.5416; train_global_loss: 1518112.8622; train_optim_loss: 1518112.8622; val_kl_reg_loss: 8296.5605; val_edge_recon_loss: 81247.0932; val_gene_expr_recon_loss: 1423016.4946; val_masked_gp_l1_reg_loss: 5383.4512; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4235.5547; val_global_loss: 1522179.1505; val_optim_loss: 1522179.1505
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9662; val_auprc_score: 0.9921; val_best_acc_score: 0.9593; val_best_f1_score: 0.9764; train_kl_reg_loss: 8175.8715; train_edge_recon_loss: 79763.7254; train_gene_expr_recon_loss: 1425994.5052; train_masked_gp_l1_reg_loss: 5442.8658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4247.5017; train_global_loss: 1523624.4671; train_optim_loss: 1523624.4671; val_kl_reg_loss: 8010.5685; val_edge_recon_loss: 81209.2644; val_gene_expr_recon_loss: 1421142.5538; val_masked_gp_l1_reg_loss: 5390.7363; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4169.4053; val_global_loss: 1519922.5121; val_optim_loss: 1519922.5121
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9643; val_auprc_score: 0.9922; val_best_acc_score: 0.9569; val_best_f1_score: 0.9752; train_kl_reg_loss: 8127.3347; train_edge_recon_loss: 79776.1401; train_gene_expr_recon_loss: 1420516.8532; train_masked_gp_l1_reg_loss: 5399.5349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4107.0432; train_global_loss: 1517926.9074; train_optim_loss: 1517926.9074; val_kl_reg_loss: 8357.8116; val_edge_recon_loss: 78886.1924; val_gene_expr_recon_loss: 1423903.8159; val_masked_gp_l1_reg_loss: 5414.6802; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4060.1074; val_global_loss: 1520622.5712; val_optim_loss: 1520622.5712
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9669; val_auprc_score: 0.9923; val_best_acc_score: 0.9592; val_best_f1_score: 0.9764; train_kl_reg_loss: 8113.8796; train_edge_recon_loss: 79662.3923; train_gene_expr_recon_loss: 1419731.4158; train_masked_gp_l1_reg_loss: 5412.6553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4005.5223; train_global_loss: 1516925.8654; train_optim_loss: 1516925.8654; val_kl_reg_loss: 8081.5813; val_edge_recon_loss: 78311.2820; val_gene_expr_recon_loss: 1420804.8266; val_masked_gp_l1_reg_loss: 5420.7959; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3960.6001; val_global_loss: 1516579.0591; val_optim_loss: 1516579.0591
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9667; val_auprc_score: 0.9925; val_best_acc_score: 0.9595; val_best_f1_score: 0.9766; train_kl_reg_loss: 8091.4449; train_edge_recon_loss: 79746.2580; train_gene_expr_recon_loss: 1420357.4295; train_masked_gp_l1_reg_loss: 5445.6831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3929.0825; train_global_loss: 1517569.8976; train_optim_loss: 1517569.8976; val_kl_reg_loss: 7920.9259; val_edge_recon_loss: 78718.1551; val_gene_expr_recon_loss: 1421683.8185; val_masked_gp_l1_reg_loss: 5447.4756; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3898.5981; val_global_loss: 1517669.0296; val_optim_loss: 1517669.0296
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9676; val_auprc_score: 0.9925; val_best_acc_score: 0.9585; val_best_f1_score: 0.9759; train_kl_reg_loss: 8036.9294; train_edge_recon_loss: 80027.3374; train_gene_expr_recon_loss: 1420505.0660; train_masked_gp_l1_reg_loss: 5439.9823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3862.1636; train_global_loss: 1517871.4783; train_optim_loss: 1517871.4783; val_kl_reg_loss: 8243.6427; val_edge_recon_loss: 80290.4669; val_gene_expr_recon_loss: 1422628.9422; val_masked_gp_l1_reg_loss: 5405.7998; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3817.8970; val_global_loss: 1520386.6774; val_optim_loss: 1520386.6774
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9681; val_auprc_score: 0.9929; val_best_acc_score: 0.9588; val_best_f1_score: 0.9761; train_kl_reg_loss: 8017.8577; train_edge_recon_loss: 79386.1192; train_gene_expr_recon_loss: 1419540.0729; train_masked_gp_l1_reg_loss: 5426.8178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3784.3305; train_global_loss: 1516155.1991; train_optim_loss: 1516155.1991; val_kl_reg_loss: 8337.3948; val_edge_recon_loss: 79558.9776; val_gene_expr_recon_loss: 1422600.4718; val_masked_gp_l1_reg_loss: 5422.7593; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3745.8181; val_global_loss: 1519665.4731; val_optim_loss: 1519665.4731
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9623; val_auprc_score: 0.9910; val_best_acc_score: 0.9537; val_best_f1_score: 0.9731; train_kl_reg_loss: 8011.9417; train_edge_recon_loss: 79256.6243; train_gene_expr_recon_loss: 1419028.3929; train_masked_gp_l1_reg_loss: 5446.7437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3723.2009; train_global_loss: 1515466.9019; train_optim_loss: 1515466.9019; val_kl_reg_loss: 8551.3988; val_edge_recon_loss: 82240.7100; val_gene_expr_recon_loss: 1429371.6935; val_masked_gp_l1_reg_loss: 5451.7305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3707.0618; val_global_loss: 1529322.5565; val_optim_loss: 1529322.5565

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9660; val_auprc_score: 0.9923; val_best_acc_score: 0.9577; val_best_f1_score: 0.9755; train_kl_reg_loss: 7221.5029; train_edge_recon_loss: 80157.9513; train_gene_expr_recon_loss: 1670406.4794; train_masked_gp_l1_reg_loss: 5277.3581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3304.6757; train_global_loss: 1766367.9682; train_optim_loss: 1766367.9682; val_kl_reg_loss: 6286.1154; val_edge_recon_loss: 79829.3960; val_gene_expr_recon_loss: 1639176.3226; val_masked_gp_l1_reg_loss: 5266.6104; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2970.9355; val_global_loss: 1733529.3347; val_optim_loss: 1733529.3347
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9646; val_auprc_score: 0.9917; val_best_acc_score: 0.9588; val_best_f1_score: 0.9762; train_kl_reg_loss: 7011.2304; train_edge_recon_loss: 79260.5352; train_gene_expr_recon_loss: 1627714.0367; train_masked_gp_l1_reg_loss: 5264.9054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2663.6027; train_global_loss: 1721914.3068; train_optim_loss: 1721914.3068; val_kl_reg_loss: 6317.7205; val_edge_recon_loss: 79038.4314; val_gene_expr_recon_loss: 1622271.8589; val_masked_gp_l1_reg_loss: 5260.3721; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2366.2490; val_global_loss: 1715254.6344; val_optim_loss: 1715254.6344
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9648; val_auprc_score: 0.9917; val_best_acc_score: 0.9591; val_best_f1_score: 0.9763; train_kl_reg_loss: 6911.6483; train_edge_recon_loss: 79382.7806; train_gene_expr_recon_loss: 1618250.2842; train_masked_gp_l1_reg_loss: 5256.7805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2090.9552; train_global_loss: 1711892.4488; train_optim_loss: 1711892.4488; val_kl_reg_loss: 6341.8259; val_edge_recon_loss: 80576.9693; val_gene_expr_recon_loss: 1617050.1613; val_masked_gp_l1_reg_loss: 5255.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1827.0356; val_global_loss: 1711051.7097; val_optim_loss: 1711051.7097
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9634; val_auprc_score: 0.9913; val_best_acc_score: 0.9577; val_best_f1_score: 0.9755; train_kl_reg_loss: 6834.5990; train_edge_recon_loss: 79928.6251; train_gene_expr_recon_loss: 1613210.7676; train_masked_gp_l1_reg_loss: 5252.3737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1591.8635; train_global_loss: 1706818.2257; train_optim_loss: 1706818.2257; val_kl_reg_loss: 6418.8189; val_edge_recon_loss: 79872.1475; val_gene_expr_recon_loss: 1614762.9718; val_masked_gp_l1_reg_loss: 5249.9941; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1370.7900; val_global_loss: 1707674.6841; val_optim_loss: 1707674.6841

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 162 min 17 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
val AUROC score: 0.9586
val AUPRC score: 0.9907
val best accuracy score: 0.9564
val best F1 score: 0.9749
val target rna MSE score: 1.0833
val source rna MSE score: 0.5002
Val cat covariate0 mean sim diff: -0.0049

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
