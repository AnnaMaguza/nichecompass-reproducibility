[True]
Run timestamp: 10082023_223757_81.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_81']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7671; val_auprc_score: 0.7922; val_best_acc_score: 0.5022; val_best_f1_score: 0.6675; train_kl_reg_loss: 129458.2739; train_edge_recon_loss: 3837520.4027; train_gene_expr_recon_loss: 45839050.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16491278.6641; train_global_loss: 66297308.3969; train_optim_loss: 66297308.3969; val_kl_reg_loss: 262209.2667; val_edge_recon_loss: 4065081.6167; val_gene_expr_recon_loss: 38857771.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15631739.4000; val_global_loss: 58816801.3333; val_optim_loss: 58816801.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7792; val_auprc_score: 0.8054; val_best_acc_score: 0.5012; val_best_f1_score: 0.6671; train_kl_reg_loss: 98297.9656; train_edge_recon_loss: 3829123.7786; train_gene_expr_recon_loss: 39180029.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15625852.6107; train_global_loss: 58733303.6641; train_optim_loss: 58733303.6641; val_kl_reg_loss: 126847.5333; val_edge_recon_loss: 4065005.2500; val_gene_expr_recon_loss: 37984049.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15424011.6000; val_global_loss: 57599913.6000; val_optim_loss: 57599913.6000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7756; val_auprc_score: 0.8011; val_best_acc_score: 0.6405; val_best_f1_score: 0.7123; train_kl_reg_loss: 163886.0980; train_edge_recon_loss: 3599152.1393; train_gene_expr_recon_loss: 37554462.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15390208.5344; train_global_loss: 56707709.6183; train_optim_loss: 56707709.6183; val_kl_reg_loss: 174435.7594; val_edge_recon_loss: 4055521.4333; val_gene_expr_recon_loss: 37184220.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15299999.6000; val_global_loss: 56714176.8000; val_optim_loss: 56714176.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8639; val_auprc_score: 0.8678; val_best_acc_score: 0.7731; val_best_f1_score: 0.7959; train_kl_reg_loss: 155489.5018; train_edge_recon_loss: 3548094.6202; train_gene_expr_recon_loss: 36838935.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15245996.0382; train_global_loss: 55788516.2137; train_optim_loss: 55788516.2137; val_kl_reg_loss: 150087.0375; val_edge_recon_loss: 3923706.1000; val_gene_expr_recon_loss: 36497750.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15150327.6000; val_global_loss: 55721870.9333; val_optim_loss: 55721870.9333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8847; val_auprc_score: 0.8717; val_best_acc_score: 0.8022; val_best_f1_score: 0.8144; train_kl_reg_loss: 135238.6476; train_edge_recon_loss: 3368499.2729; train_gene_expr_recon_loss: 36490419.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15165610.8473; train_global_loss: 55159768.3664; train_optim_loss: 55159768.3664; val_kl_reg_loss: 148910.5792; val_edge_recon_loss: 3146289.5000; val_gene_expr_recon_loss: 36287746.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15104723.2000; val_global_loss: 54687669.6000; val_optim_loss: 54687669.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8997; val_auprc_score: 0.8883; val_best_acc_score: 0.8145; val_best_f1_score: 0.8269; train_kl_reg_loss: 172651.5163; train_edge_recon_loss: 3040406.8626; train_gene_expr_recon_loss: 36283848.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15097110.7328; train_global_loss: 54594018.3817; train_optim_loss: 54594018.3817; val_kl_reg_loss: 169250.1375; val_edge_recon_loss: 2995387.7000; val_gene_expr_recon_loss: 36150905.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15039289.9333; val_global_loss: 54354832.5333; val_optim_loss: 54354832.5333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9050; val_auprc_score: 0.8920; val_best_acc_score: 0.8230; val_best_f1_score: 0.8358; train_kl_reg_loss: 166439.5669; train_edge_recon_loss: 2983224.8836; train_gene_expr_recon_loss: 36001241.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15010125.8168; train_global_loss: 54161032.0305; train_optim_loss: 54161032.0305; val_kl_reg_loss: 168623.3594; val_edge_recon_loss: 2970084.8667; val_gene_expr_recon_loss: 35850927.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14970026.8000; val_global_loss: 53959661.8667; val_optim_loss: 53959661.8667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9269; val_auprc_score: 0.9154; val_best_acc_score: 0.8518; val_best_f1_score: 0.8598; train_kl_reg_loss: 163977.7078; train_edge_recon_loss: 2926644.1966; train_gene_expr_recon_loss: 35803976.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14949599.4809; train_global_loss: 53844198.1985; train_optim_loss: 53844198.1985; val_kl_reg_loss: 153725.6865; val_edge_recon_loss: 2907825.1833; val_gene_expr_recon_loss: 35691987.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14849482.2667; val_global_loss: 53603020.2667; val_optim_loss: 53603020.2667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9316; val_auprc_score: 0.9171; val_best_acc_score: 0.8597; val_best_f1_score: 0.8677; train_kl_reg_loss: 158690.5592; train_edge_recon_loss: 2903303.3435; train_gene_expr_recon_loss: 35640135.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14895967.1527; train_global_loss: 53598096.2443; train_optim_loss: 53598096.2443; val_kl_reg_loss: 154992.1708; val_edge_recon_loss: 2914027.3667; val_gene_expr_recon_loss: 35464889.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14861415.2667; val_global_loss: 53395324.0000; val_optim_loss: 53395324.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9357; val_auprc_score: 0.9248; val_best_acc_score: 0.8690; val_best_f1_score: 0.8773; train_kl_reg_loss: 155380.4871; train_edge_recon_loss: 2870747.6126; train_gene_expr_recon_loss: 35508246.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14870375.7786; train_global_loss: 53404750.6565; train_optim_loss: 53404750.6565; val_kl_reg_loss: 154529.3385; val_edge_recon_loss: 2853244.4000; val_gene_expr_recon_loss: 35535141.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14914941.6667; val_global_loss: 53457856.8000; val_optim_loss: 53457856.8000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9449; val_auprc_score: 0.9377; val_best_acc_score: 0.8764; val_best_f1_score: 0.8833; train_kl_reg_loss: 151836.3918; train_edge_recon_loss: 2852584.0477; train_gene_expr_recon_loss: 35339619.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14812343.0076; train_global_loss: 53156382.7176; train_optim_loss: 53156382.7176; val_kl_reg_loss: 149191.7510; val_edge_recon_loss: 2846471.1000; val_gene_expr_recon_loss: 35386750.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14830173.8000; val_global_loss: 53212587.7333; val_optim_loss: 53212587.7333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9471; val_auprc_score: 0.9347; val_best_acc_score: 0.8821; val_best_f1_score: 0.8885; train_kl_reg_loss: 147260.2512; train_edge_recon_loss: 2840661.9122; train_gene_expr_recon_loss: 35256541.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14786296.0534; train_global_loss: 53030760.0916; train_optim_loss: 53030760.0916; val_kl_reg_loss: 146819.5375; val_edge_recon_loss: 2816236.4667; val_gene_expr_recon_loss: 35154805.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14743332.3333; val_global_loss: 52861193.8667; val_optim_loss: 52861193.8667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9485; val_auprc_score: 0.9388; val_best_acc_score: 0.8810; val_best_f1_score: 0.8882; train_kl_reg_loss: 144593.2106; train_edge_recon_loss: 2826461.7118; train_gene_expr_recon_loss: 35149776.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14758080.6489; train_global_loss: 52878912.4275; train_optim_loss: 52878912.4275; val_kl_reg_loss: 140573.7938; val_edge_recon_loss: 2835508.5833; val_gene_expr_recon_loss: 35050881.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14669201.8667; val_global_loss: 52696165.8667; val_optim_loss: 52696165.8667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9500; val_auprc_score: 0.9375; val_best_acc_score: 0.8856; val_best_f1_score: 0.8899; train_kl_reg_loss: 141437.7574; train_edge_recon_loss: 2812769.0763; train_gene_expr_recon_loss: 34997076.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14704891.5649; train_global_loss: 52656174.5954; train_optim_loss: 52656174.5954; val_kl_reg_loss: 136120.2594; val_edge_recon_loss: 2823449.5333; val_gene_expr_recon_loss: 35023556.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14711916.8667; val_global_loss: 52695043.2000; val_optim_loss: 52695043.2000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9521; val_auprc_score: 0.9424; val_best_acc_score: 0.8921; val_best_f1_score: 0.8977; train_kl_reg_loss: 138590.7188; train_edge_recon_loss: 2801981.3149; train_gene_expr_recon_loss: 34943486.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14694428.2366; train_global_loss: 52578486.8092; train_optim_loss: 52578486.8092; val_kl_reg_loss: 134722.2807; val_edge_recon_loss: 2803122.1667; val_gene_expr_recon_loss: 34934975.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14683012.9333; val_global_loss: 52555833.0667; val_optim_loss: 52555833.0667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9574; val_auprc_score: 0.9470; val_best_acc_score: 0.8988; val_best_f1_score: 0.9031; train_kl_reg_loss: 134434.8712; train_edge_recon_loss: 2791831.3397; train_gene_expr_recon_loss: 34855660.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14662766.3206; train_global_loss: 52444693.6183; train_optim_loss: 52444693.6183; val_kl_reg_loss: 133153.5641; val_edge_recon_loss: 2792243.5667; val_gene_expr_recon_loss: 34839837.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14653920.8000; val_global_loss: 52419155.7333; val_optim_loss: 52419155.7333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9581; val_auprc_score: 0.9504; val_best_acc_score: 0.8961; val_best_f1_score: 0.9011; train_kl_reg_loss: 131098.5977; train_edge_recon_loss: 2780320.3130; train_gene_expr_recon_loss: 34790567.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14656798.0382; train_global_loss: 52358784.7939; train_optim_loss: 52358784.7939; val_kl_reg_loss: 131466.1521; val_edge_recon_loss: 2794381.9000; val_gene_expr_recon_loss: 34758249.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14646110.3333; val_global_loss: 52330208.0000; val_optim_loss: 52330208.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9592; val_auprc_score: 0.9502; val_best_acc_score: 0.9007; val_best_f1_score: 0.9056; train_kl_reg_loss: 128543.0701; train_edge_recon_loss: 2774808.8378; train_gene_expr_recon_loss: 34685100.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14620251.3740; train_global_loss: 52208703.9389; train_optim_loss: 52208703.9389; val_kl_reg_loss: 127721.2526; val_edge_recon_loss: 2775729.4500; val_gene_expr_recon_loss: 34689652.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14597813.1333; val_global_loss: 52190916.5333; val_optim_loss: 52190916.5333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9629; val_auprc_score: 0.9561; val_best_acc_score: 0.9031; val_best_f1_score: 0.9062; train_kl_reg_loss: 125849.0330; train_edge_recon_loss: 2777984.5496; train_gene_expr_recon_loss: 34650778.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14607766.5420; train_global_loss: 52162378.2595; train_optim_loss: 52162378.2595; val_kl_reg_loss: 123825.2594; val_edge_recon_loss: 2785337.8500; val_gene_expr_recon_loss: 34679209.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14616016.3333; val_global_loss: 52204388.2667; val_optim_loss: 52204388.2667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9613; val_auprc_score: 0.9539; val_best_acc_score: 0.9026; val_best_f1_score: 0.9059; train_kl_reg_loss: 122740.1484; train_edge_recon_loss: 2765269.8607; train_gene_expr_recon_loss: 34547984.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14574923.2824; train_global_loss: 52010917.7405; train_optim_loss: 52010917.7405; val_kl_reg_loss: 123788.2219; val_edge_recon_loss: 2778438.3000; val_gene_expr_recon_loss: 34650588.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14648354.0667; val_global_loss: 52201169.6000; val_optim_loss: 52201169.6000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9630; val_auprc_score: 0.9555; val_best_acc_score: 0.9000; val_best_f1_score: 0.9046; train_kl_reg_loss: 121356.8511; train_edge_recon_loss: 2764167.1088; train_gene_expr_recon_loss: 34513288.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14581473.0000; train_global_loss: 51980285.9847; train_optim_loss: 51980285.9847; val_kl_reg_loss: 120033.2016; val_edge_recon_loss: 2777723.1500; val_gene_expr_recon_loss: 34465538.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14528141.3333; val_global_loss: 51891435.7333; val_optim_loss: 51891435.7333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9668; val_auprc_score: 0.9622; val_best_acc_score: 0.9046; val_best_f1_score: 0.9079; train_kl_reg_loss: 117736.8789; train_edge_recon_loss: 2766898.3092; train_gene_expr_recon_loss: 34422554.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14542805.0534; train_global_loss: 51849994.2901; train_optim_loss: 51849994.2901; val_kl_reg_loss: 116147.2740; val_edge_recon_loss: 2768140.5333; val_gene_expr_recon_loss: 34545626.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14579820.2667; val_global_loss: 52009734.6667; val_optim_loss: 52009734.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9656; val_auprc_score: 0.9596; val_best_acc_score: 0.9066; val_best_f1_score: 0.9101; train_kl_reg_loss: 116968.8142; train_edge_recon_loss: 2750419.8550; train_gene_expr_recon_loss: 34394684.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14551760.7557; train_global_loss: 51813833.8626; train_optim_loss: 51813833.8626; val_kl_reg_loss: 115403.5318; val_edge_recon_loss: 2765573.1167; val_gene_expr_recon_loss: 34441242.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14569748.4000; val_global_loss: 51891967.2000; val_optim_loss: 51891967.2000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9684; val_auprc_score: 0.9629; val_best_acc_score: 0.9104; val_best_f1_score: 0.9136; train_kl_reg_loss: 114076.8714; train_edge_recon_loss: 2742119.6431; train_gene_expr_recon_loss: 34349310.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14551204.1298; train_global_loss: 51756710.8702; train_optim_loss: 51756710.8702; val_kl_reg_loss: 117747.8734; val_edge_recon_loss: 2752498.2667; val_gene_expr_recon_loss: 34370494.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14504393.3333; val_global_loss: 51745133.8667; val_optim_loss: 51745133.8667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9636; val_auprc_score: 0.9573; val_best_acc_score: 0.9023; val_best_f1_score: 0.9060; train_kl_reg_loss: 113050.0435; train_edge_recon_loss: 2750959.4408; train_gene_expr_recon_loss: 34305652.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14532029.7252; train_global_loss: 51701691.8473; train_optim_loss: 51701691.8473; val_kl_reg_loss: 112691.4401; val_edge_recon_loss: 2770335.0333; val_gene_expr_recon_loss: 34225580.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14489522.8000; val_global_loss: 51598129.0667; val_optim_loss: 51598129.0667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9661; val_auprc_score: 0.9594; val_best_acc_score: 0.9086; val_best_f1_score: 0.9121; train_kl_reg_loss: 123415.8813; train_edge_recon_loss: 2818519.3950; train_gene_expr_recon_loss: 36124698.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14822676.2901; train_global_loss: 53889309.8321; train_optim_loss: 53889309.8321; val_kl_reg_loss: 40792.4464; val_edge_recon_loss: 2849754.9000; val_gene_expr_recon_loss: 36794729.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14921924.1333; val_global_loss: 54607201.3333; val_optim_loss: 54607201.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9499; val_auprc_score: 0.9405; val_best_acc_score: 0.8856; val_best_f1_score: 0.8887; train_kl_reg_loss: 147675.9293; train_edge_recon_loss: 2898450.5973; train_gene_expr_recon_loss: 37250933.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14899038.7634; train_global_loss: 55196098.9618; train_optim_loss: 55196098.9618; val_kl_reg_loss: 30008.4749; val_edge_recon_loss: 2910702.6333; val_gene_expr_recon_loss: 37587066.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14919041.5333; val_global_loss: 55446819.4667; val_optim_loss: 55446819.4667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9401; val_auprc_score: 0.9270; val_best_acc_score: 0.8736; val_best_f1_score: 0.8794; train_kl_reg_loss: 117653.3842; train_edge_recon_loss: 2897093.1985; train_gene_expr_recon_loss: 37577086.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14886035.9160; train_global_loss: 55477868.6412; train_optim_loss: 55477868.6412; val_kl_reg_loss: 38270.0391; val_edge_recon_loss: 2830574.0167; val_gene_expr_recon_loss: 37367256.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14850677.0000; val_global_loss: 55086778.1333; val_optim_loss: 55086778.1333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9465; val_auprc_score: 0.9365; val_best_acc_score: 0.8806; val_best_f1_score: 0.8865; train_kl_reg_loss: 83776.0701; train_edge_recon_loss: 2788174.2500; train_gene_expr_recon_loss: 37266795.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14873010.4580; train_global_loss: 55011756.2443; train_optim_loss: 55011756.2443; val_kl_reg_loss: 46348.1398; val_edge_recon_loss: 2790866.5333; val_gene_expr_recon_loss: 37163458.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14821275.4000; val_global_loss: 54821948.8000; val_optim_loss: 54821948.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9507; val_auprc_score: 0.9377; val_best_acc_score: 0.8901; val_best_f1_score: 0.8930; train_kl_reg_loss: 78240.7605; train_edge_recon_loss: 2766342.5057; train_gene_expr_recon_loss: 37074774.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14826187.9771; train_global_loss: 54745545.8626; train_optim_loss: 54745545.8626; val_kl_reg_loss: 49211.3331; val_edge_recon_loss: 2760212.2167; val_gene_expr_recon_loss: 37200049.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14862537.3333; val_global_loss: 54872009.6000; val_optim_loss: 54872009.6000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9491; val_auprc_score: 0.9375; val_best_acc_score: 0.8853; val_best_f1_score: 0.8908; train_kl_reg_loss: 78662.8966; train_edge_recon_loss: 2764869.4370; train_gene_expr_recon_loss: 37060824.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14825367.7099; train_global_loss: 54729725.0382; train_optim_loss: 54729725.0382; val_kl_reg_loss: 50633.9143; val_edge_recon_loss: 2775268.1333; val_gene_expr_recon_loss: 37143691.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14830955.6667; val_global_loss: 54800549.6000; val_optim_loss: 54800549.6000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9493; val_auprc_score: 0.9382; val_best_acc_score: 0.8853; val_best_f1_score: 0.8914; train_kl_reg_loss: 79601.2803; train_edge_recon_loss: 2756792.1164; train_gene_expr_recon_loss: 37085675.6031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14845906.5725; train_global_loss: 54767975.4504; train_optim_loss: 54767975.4504; val_kl_reg_loss: 44464.7620; val_edge_recon_loss: 2768124.4500; val_gene_expr_recon_loss: 36980272.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14793647.9333; val_global_loss: 54586509.8667; val_optim_loss: 54586509.8667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9490; val_auprc_score: 0.9346; val_best_acc_score: 0.8876; val_best_f1_score: 0.8916; train_kl_reg_loss: 81322.4858; train_edge_recon_loss: 2756596.7481; train_gene_expr_recon_loss: 37035243.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14834970.3969; train_global_loss: 54708133.4046; train_optim_loss: 54708133.4046; val_kl_reg_loss: 46224.9310; val_edge_recon_loss: 2758443.4167; val_gene_expr_recon_loss: 37172396.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14861148.2667; val_global_loss: 54838212.8000; val_optim_loss: 54838212.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 50 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9690
val AUPRC score: 0.9634
val best accuracy score: 0.9123
val best F1 score: 0.9153
val target rna MSE score: 1.1285
val source rna MSE score: 19.5329
val target atac MSE score: 0.3456
val source atac MSE score: 2.9209
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
