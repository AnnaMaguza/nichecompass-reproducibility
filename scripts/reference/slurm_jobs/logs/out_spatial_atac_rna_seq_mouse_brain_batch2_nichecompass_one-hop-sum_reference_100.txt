[True]
Run timestamp: 10082023_233705_100.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_100']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7650; val_auprc_score: 0.7907; val_best_acc_score: 0.5284; val_best_f1_score: 0.6767; train_kl_reg_loss: 217730.6816; train_edge_recon_loss: 3975362.4427; train_gene_expr_recon_loss: 48785857.1908; train_masked_gp_l1_reg_loss: 82120.5063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 243832.8010; train_chrom_access_recon_loss: 128386856.4885; train_global_loss: 181691760.4885; train_optim_loss: 181691760.4885; val_kl_reg_loss: 187487.3240; val_edge_recon_loss: 4063136.6333; val_gene_expr_recon_loss: 39247656.2667; val_masked_gp_l1_reg_loss: 79185.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 240998.5781; val_chrom_access_recon_loss: 115119048.5333; val_global_loss: 158937511.4667; val_optim_loss: 158937511.4667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7707; val_auprc_score: 0.7976; val_best_acc_score: 0.6067; val_best_f1_score: 0.7020; train_kl_reg_loss: 226141.4719; train_edge_recon_loss: 3906499.4580; train_gene_expr_recon_loss: 38896158.4427; train_masked_gp_l1_reg_loss: 76011.3665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 237579.6159; train_chrom_access_recon_loss: 116048230.0458; train_global_loss: 159390620.9466; train_optim_loss: 159390620.9466; val_kl_reg_loss: 153859.9583; val_edge_recon_loss: 4057761.5833; val_gene_expr_recon_loss: 37688083.7333; val_masked_gp_l1_reg_loss: 74726.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 233547.0469; val_chrom_access_recon_loss: 114372313.6000; val_global_loss: 156580293.3333; val_optim_loss: 156580293.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8322; val_auprc_score: 0.8443; val_best_acc_score: 0.7161; val_best_f1_score: 0.7577; train_kl_reg_loss: 191968.9015; train_edge_recon_loss: 3798862.2405; train_gene_expr_recon_loss: 37805345.4656; train_masked_gp_l1_reg_loss: 75993.2753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 229114.2634; train_chrom_access_recon_loss: 115306837.1908; train_global_loss: 157408121.0382; train_optim_loss: 157408121.0382; val_kl_reg_loss: 248403.0240; val_edge_recon_loss: 3972921.4000; val_gene_expr_recon_loss: 36809818.9333; val_masked_gp_l1_reg_loss: 75695.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224003.9844; val_chrom_access_recon_loss: 112582576.0000; val_global_loss: 153913420.8000; val_optim_loss: 153913420.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8925; val_auprc_score: 0.8876; val_best_acc_score: 0.8061; val_best_f1_score: 0.8187; train_kl_reg_loss: 209854.9367; train_edge_recon_loss: 3556091.5916; train_gene_expr_recon_loss: 36854904.4885; train_masked_gp_l1_reg_loss: 76317.9400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 218824.2352; train_chrom_access_recon_loss: 114213714.2595; train_global_loss: 155129707.2366; train_optim_loss: 155129707.2366; val_kl_reg_loss: 185556.7917; val_edge_recon_loss: 3626632.7167; val_gene_expr_recon_loss: 36574197.6000; val_masked_gp_l1_reg_loss: 77232.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 213500.0000; val_chrom_access_recon_loss: 112443020.8000; val_global_loss: 153120140.8000; val_optim_loss: 153120140.8000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8899; val_auprc_score: 0.8809; val_best_acc_score: 0.8067; val_best_f1_score: 0.8200; train_kl_reg_loss: 205451.4994; train_edge_recon_loss: 3247116.4332; train_gene_expr_recon_loss: 36550759.0840; train_masked_gp_l1_reg_loss: 78052.9940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 208277.9994; train_chrom_access_recon_loss: 113479911.7557; train_global_loss: 153769570.0763; train_optim_loss: 153769570.0763; val_kl_reg_loss: 231941.0458; val_edge_recon_loss: 3143869.1667; val_gene_expr_recon_loss: 36144826.1333; val_masked_gp_l1_reg_loss: 79082.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 203009.9062; val_chrom_access_recon_loss: 111648345.0667; val_global_loss: 151451072.0000; val_optim_loss: 151451072.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9045; val_auprc_score: 0.8961; val_best_acc_score: 0.8200; val_best_f1_score: 0.8346; train_kl_reg_loss: 240970.9043; train_edge_recon_loss: 3064432.6240; train_gene_expr_recon_loss: 36313833.7405; train_masked_gp_l1_reg_loss: 79723.3699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 197940.5026; train_chrom_access_recon_loss: 112944602.9924; train_global_loss: 152841504.1221; train_optim_loss: 152841504.1221; val_kl_reg_loss: 236359.7396; val_edge_recon_loss: 3052070.5167; val_gene_expr_recon_loss: 35997579.7333; val_masked_gp_l1_reg_loss: 80469.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 193004.7344; val_chrom_access_recon_loss: 111165947.2000; val_global_loss: 150725429.3333; val_optim_loss: 150725429.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9191; val_auprc_score: 0.9091; val_best_acc_score: 0.8401; val_best_f1_score: 0.8519; train_kl_reg_loss: 236916.3577; train_edge_recon_loss: 3002112.2863; train_gene_expr_recon_loss: 36078966.6870; train_masked_gp_l1_reg_loss: 81217.4344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 188248.7449; train_chrom_access_recon_loss: 112249691.0534; train_global_loss: 151837153.2214; train_optim_loss: 151837153.2214; val_kl_reg_loss: 230083.3865; val_edge_recon_loss: 3001225.6667; val_gene_expr_recon_loss: 35714194.0000; val_masked_gp_l1_reg_loss: 82027.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 183449.3438; val_chrom_access_recon_loss: 109867768.5333; val_global_loss: 149078748.8000; val_optim_loss: 149078748.8000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9241; val_auprc_score: 0.9121; val_best_acc_score: 0.8515; val_best_f1_score: 0.8617; train_kl_reg_loss: 229690.3302; train_edge_recon_loss: 2964646.9714; train_gene_expr_recon_loss: 35878246.9008; train_masked_gp_l1_reg_loss: 83430.8095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 178853.9241; train_chrom_access_recon_loss: 111608112.7328; train_global_loss: 150942981.4962; train_optim_loss: 150942981.4962; val_kl_reg_loss: 229703.9167; val_edge_recon_loss: 2946187.3667; val_gene_expr_recon_loss: 35614695.2000; val_masked_gp_l1_reg_loss: 84577.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174432.4375; val_chrom_access_recon_loss: 109783768.0000; val_global_loss: 148833363.2000; val_optim_loss: 148833363.2000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9344; val_auprc_score: 0.9248; val_best_acc_score: 0.8622; val_best_f1_score: 0.8716; train_kl_reg_loss: 219114.2549; train_edge_recon_loss: 2942808.4427; train_gene_expr_recon_loss: 35675270.1832; train_masked_gp_l1_reg_loss: 85417.2120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170219.6619; train_chrom_access_recon_loss: 110880964.5191; train_global_loss: 149973795.4198; train_optim_loss: 149973795.4198; val_kl_reg_loss: 216762.1854; val_edge_recon_loss: 2928091.3000; val_gene_expr_recon_loss: 35357237.8667; val_masked_gp_l1_reg_loss: 86154.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 166139.5312; val_chrom_access_recon_loss: 109208328.5333; val_global_loss: 147962714.6667; val_optim_loss: 147962714.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9369; val_auprc_score: 0.9255; val_best_acc_score: 0.8654; val_best_f1_score: 0.8730; train_kl_reg_loss: 215726.5279; train_edge_recon_loss: 2923451.0725; train_gene_expr_recon_loss: 35541212.0458; train_masked_gp_l1_reg_loss: 86969.5969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 162199.5528; train_chrom_access_recon_loss: 110599818.7481; train_global_loss: 149529377.8321; train_optim_loss: 149529377.8321; val_kl_reg_loss: 207488.6531; val_edge_recon_loss: 2924173.1500; val_gene_expr_recon_loss: 35410090.6667; val_masked_gp_l1_reg_loss: 87923.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158363.5938; val_chrom_access_recon_loss: 109396782.9333; val_global_loss: 148184822.4000; val_optim_loss: 148184822.4000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9406; val_auprc_score: 0.9309; val_best_acc_score: 0.8716; val_best_f1_score: 0.8797; train_kl_reg_loss: 209700.6827; train_edge_recon_loss: 2899189.2061; train_gene_expr_recon_loss: 35469272.1985; train_masked_gp_l1_reg_loss: 88679.5996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154703.6434; train_chrom_access_recon_loss: 110447685.8626; train_global_loss: 149269231.3893; train_optim_loss: 149269231.3893; val_kl_reg_loss: 209617.4010; val_edge_recon_loss: 2919703.6833; val_gene_expr_recon_loss: 35266461.3333; val_masked_gp_l1_reg_loss: 89296.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151048.8750; val_chrom_access_recon_loss: 109242235.2000; val_global_loss: 147878361.6000; val_optim_loss: 147878361.6000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9409; val_auprc_score: 0.9298; val_best_acc_score: 0.8758; val_best_f1_score: 0.8835; train_kl_reg_loss: 205176.1473; train_edge_recon_loss: 2893487.3969; train_gene_expr_recon_loss: 35335781.5115; train_masked_gp_l1_reg_loss: 90165.9486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147487.8634; train_chrom_access_recon_loss: 109936306.5038; train_global_loss: 148608405.3740; train_optim_loss: 148608405.3740; val_kl_reg_loss: 198648.8740; val_edge_recon_loss: 2881270.1000; val_gene_expr_recon_loss: 35171072.8000; val_masked_gp_l1_reg_loss: 91032.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144112.2812; val_chrom_access_recon_loss: 108371632.0000; val_global_loss: 146857768.5333; val_optim_loss: 146857768.5333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9459; val_auprc_score: 0.9336; val_best_acc_score: 0.8857; val_best_f1_score: 0.8917; train_kl_reg_loss: 200254.8714; train_edge_recon_loss: 2870783.1221; train_gene_expr_recon_loss: 35188871.1756; train_masked_gp_l1_reg_loss: 92023.3399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140864.0321; train_chrom_access_recon_loss: 109350737.7710; train_global_loss: 147843534.1679; train_optim_loss: 147843534.1679; val_kl_reg_loss: 198682.8375; val_edge_recon_loss: 2866906.5167; val_gene_expr_recon_loss: 35007433.8667; val_masked_gp_l1_reg_loss: 92822.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137757.1875; val_chrom_access_recon_loss: 107996128.0000; val_global_loss: 146299731.2000; val_optim_loss: 146299731.2000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9475; val_auprc_score: 0.9368; val_best_acc_score: 0.8824; val_best_f1_score: 0.8885; train_kl_reg_loss: 195358.8323; train_edge_recon_loss: 2855091.9618; train_gene_expr_recon_loss: 35133494.5954; train_masked_gp_l1_reg_loss: 93855.4194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134830.9567; train_chrom_access_recon_loss: 109282166.7786; train_global_loss: 147694798.9008; train_optim_loss: 147694798.9008; val_kl_reg_loss: 196949.0146; val_edge_recon_loss: 2873989.6667; val_gene_expr_recon_loss: 34795980.2667; val_masked_gp_l1_reg_loss: 94688.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131945.1719; val_chrom_access_recon_loss: 106919547.7333; val_global_loss: 145013097.6000; val_optim_loss: 145013097.6000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9519; val_auprc_score: 0.9427; val_best_acc_score: 0.8853; val_best_f1_score: 0.8929; train_kl_reg_loss: 191227.6793; train_edge_recon_loss: 2846255.0916; train_gene_expr_recon_loss: 35052932.6107; train_masked_gp_l1_reg_loss: 95586.3743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129337.7750; train_chrom_access_recon_loss: 109033448.1832; train_global_loss: 147348787.1756; train_optim_loss: 147348787.1756; val_kl_reg_loss: 184983.4365; val_edge_recon_loss: 2837536.4000; val_gene_expr_recon_loss: 34882124.8000; val_masked_gp_l1_reg_loss: 96536.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126738.0156; val_chrom_access_recon_loss: 107590348.2667; val_global_loss: 145718267.7333; val_optim_loss: 145718267.7333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9545; val_auprc_score: 0.9466; val_best_acc_score: 0.8897; val_best_f1_score: 0.8957; train_kl_reg_loss: 187923.5825; train_edge_recon_loss: 2834163.8664; train_gene_expr_recon_loss: 34968662.3206; train_masked_gp_l1_reg_loss: 97314.4566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124325.5472; train_chrom_access_recon_loss: 108691600.2443; train_global_loss: 146903990.1069; train_optim_loss: 146903990.1069; val_kl_reg_loss: 186632.7771; val_edge_recon_loss: 2833730.3833; val_gene_expr_recon_loss: 34852834.1333; val_masked_gp_l1_reg_loss: 98123.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121996.1797; val_chrom_access_recon_loss: 107504195.2000; val_global_loss: 145597511.4667; val_optim_loss: 145597511.4667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9461; val_auprc_score: 0.9342; val_best_acc_score: 0.8821; val_best_f1_score: 0.8903; train_kl_reg_loss: 198378.0555; train_edge_recon_loss: 2876247.2672; train_gene_expr_recon_loss: 36025673.0840; train_masked_gp_l1_reg_loss: 98761.1931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119927.0562; train_chrom_access_recon_loss: 109297425.0992; train_global_loss: 148616412.0916; train_optim_loss: 148616412.0916; val_kl_reg_loss: 152137.0490; val_edge_recon_loss: 2958499.3167; val_gene_expr_recon_loss: 35225621.6000; val_masked_gp_l1_reg_loss: 98238.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117685.2422; val_chrom_access_recon_loss: 107557024.0000; val_global_loss: 146109205.3333; val_optim_loss: 146109205.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9469; val_auprc_score: 0.9346; val_best_acc_score: 0.8829; val_best_f1_score: 0.8895; train_kl_reg_loss: 194641.7205; train_edge_recon_loss: 2900124.9294; train_gene_expr_recon_loss: 35533577.7252; train_masked_gp_l1_reg_loss: 97458.7809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113427.8927; train_chrom_access_recon_loss: 109186942.7786; train_global_loss: 148026173.9237; train_optim_loss: 148026173.9237; val_kl_reg_loss: 204309.3438; val_edge_recon_loss: 2969358.0333; val_gene_expr_recon_loss: 34919456.5333; val_masked_gp_l1_reg_loss: 100546.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109474.9766; val_chrom_access_recon_loss: 106829682.1333; val_global_loss: 145132827.7333; val_optim_loss: 145132827.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9500; val_auprc_score: 0.9414; val_best_acc_score: 0.8866; val_best_f1_score: 0.8937; train_kl_reg_loss: 197955.8670; train_edge_recon_loss: 2907412.1450; train_gene_expr_recon_loss: 34918934.9771; train_masked_gp_l1_reg_loss: 98237.0842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108800.1926; train_chrom_access_recon_loss: 108243533.7405; train_global_loss: 146474874.0153; train_optim_loss: 146474874.0153; val_kl_reg_loss: 198587.0156; val_edge_recon_loss: 2868068.8333; val_gene_expr_recon_loss: 34727169.0667; val_masked_gp_l1_reg_loss: 96801.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108193.7344; val_chrom_access_recon_loss: 107359488.0000; val_global_loss: 145358306.1333; val_optim_loss: 145358306.1333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9487; val_auprc_score: 0.9366; val_best_acc_score: 0.8860; val_best_f1_score: 0.8924; train_kl_reg_loss: 199531.7737; train_edge_recon_loss: 2863211.5573; train_gene_expr_recon_loss: 34853370.0763; train_masked_gp_l1_reg_loss: 96175.1168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107729.0063; train_chrom_access_recon_loss: 108027448.2443; train_global_loss: 146147465.1603; train_optim_loss: 146147465.1603; val_kl_reg_loss: 199224.8396; val_edge_recon_loss: 2852901.0833; val_gene_expr_recon_loss: 34768262.9333; val_masked_gp_l1_reg_loss: 95690.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107273.5625; val_chrom_access_recon_loss: 106884949.8667; val_global_loss: 144908302.9333; val_optim_loss: 144908302.9333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9466; val_auprc_score: 0.9356; val_best_acc_score: 0.8793; val_best_f1_score: 0.8855; train_kl_reg_loss: 201609.5409; train_edge_recon_loss: 2850608.6107; train_gene_expr_recon_loss: 34835389.2214; train_masked_gp_l1_reg_loss: 95347.5004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106859.5821; train_chrom_access_recon_loss: 107973139.1756; train_global_loss: 146062954.0153; train_optim_loss: 146062954.0153; val_kl_reg_loss: 199533.5771; val_edge_recon_loss: 2886479.6667; val_gene_expr_recon_loss: 34476578.9333; val_masked_gp_l1_reg_loss: 95096.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106464.9922; val_chrom_access_recon_loss: 105616800.0000; val_global_loss: 143380951.4667; val_optim_loss: 143380951.4667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9423; val_auprc_score: 0.9279; val_best_acc_score: 0.8762; val_best_f1_score: 0.8832; train_kl_reg_loss: 202730.1800; train_edge_recon_loss: 2846056.2576; train_gene_expr_recon_loss: 34869293.3435; train_masked_gp_l1_reg_loss: 94897.7298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106081.4480; train_chrom_access_recon_loss: 108200824.9771; train_global_loss: 146319884.3359; train_optim_loss: 146319884.3359; val_kl_reg_loss: 201261.3594; val_edge_recon_loss: 2875711.2000; val_gene_expr_recon_loss: 34633370.0000; val_masked_gp_l1_reg_loss: 94778.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105703.6875; val_chrom_access_recon_loss: 106716777.6000; val_global_loss: 144627603.2000; val_optim_loss: 144627603.2000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9507; val_auprc_score: 0.9433; val_best_acc_score: 0.8861; val_best_f1_score: 0.8929; train_kl_reg_loss: 202571.0128; train_edge_recon_loss: 2838443.4962; train_gene_expr_recon_loss: 34796313.1450; train_masked_gp_l1_reg_loss: 94683.7644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105343.0144; train_chrom_access_recon_loss: 107954249.5878; train_global_loss: 145991604.0305; train_optim_loss: 145991604.0305; val_kl_reg_loss: 201622.0438; val_edge_recon_loss: 2843327.9833; val_gene_expr_recon_loss: 34741272.8000; val_masked_gp_l1_reg_loss: 94578.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104975.7344; val_chrom_access_recon_loss: 106719523.7333; val_global_loss: 144705300.2667; val_optim_loss: 144705300.2667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9511; val_auprc_score: 0.9408; val_best_acc_score: 0.8875; val_best_f1_score: 0.8935; train_kl_reg_loss: 202421.2143; train_edge_recon_loss: 2836103.5363; train_gene_expr_recon_loss: 34835179.6336; train_masked_gp_l1_reg_loss: 94569.9705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104624.1331; train_chrom_access_recon_loss: 108103362.9924; train_global_loss: 146176261.4962; train_optim_loss: 146176261.4962; val_kl_reg_loss: 200712.5625; val_edge_recon_loss: 2821472.2167; val_gene_expr_recon_loss: 34524743.2000; val_masked_gp_l1_reg_loss: 94536.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104265.7188; val_chrom_access_recon_loss: 106372618.1333; val_global_loss: 144118346.6667; val_optim_loss: 144118346.6667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9526; val_auprc_score: 0.9412; val_best_acc_score: 0.8878; val_best_f1_score: 0.8932; train_kl_reg_loss: 202874.6078; train_edge_recon_loss: 2830381.8092; train_gene_expr_recon_loss: 34823612.5802; train_masked_gp_l1_reg_loss: 94531.5327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103934.1224; train_chrom_access_recon_loss: 108105537.4046; train_global_loss: 146160871.2061; train_optim_loss: 146160871.2061; val_kl_reg_loss: 201012.6531; val_edge_recon_loss: 2832977.4000; val_gene_expr_recon_loss: 34623624.5333; val_masked_gp_l1_reg_loss: 94464.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103586.1562; val_chrom_access_recon_loss: 106275479.4667; val_global_loss: 144131145.6000; val_optim_loss: 144131145.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9550; val_auprc_score: 0.9477; val_best_acc_score: 0.8878; val_best_f1_score: 0.8926; train_kl_reg_loss: 202447.2232; train_edge_recon_loss: 3032438.5954; train_gene_expr_recon_loss: 36993806.5649; train_masked_gp_l1_reg_loss: 94352.1532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103524.4003; train_chrom_access_recon_loss: 109848715.4809; train_global_loss: 150275284.1527; train_optim_loss: 150275284.1527; val_kl_reg_loss: 69157.4557; val_edge_recon_loss: 3056303.2500; val_gene_expr_recon_loss: 36522795.7333; val_masked_gp_l1_reg_loss: 94298.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103508.3281; val_chrom_access_recon_loss: 107977859.2000; val_global_loss: 147823922.1333; val_optim_loss: 147823922.1333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9546; val_auprc_score: 0.9460; val_best_acc_score: 0.8936; val_best_f1_score: 0.8986; train_kl_reg_loss: 203167.5367; train_edge_recon_loss: 3026890.0725; train_gene_expr_recon_loss: 36705780.4580; train_masked_gp_l1_reg_loss: 94280.6579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103514.0748; train_chrom_access_recon_loss: 109526544.9160; train_global_loss: 149660177.0992; train_optim_loss: 149660177.0992; val_kl_reg_loss: 71569.3109; val_edge_recon_loss: 3039348.4333; val_gene_expr_recon_loss: 36451051.7333; val_masked_gp_l1_reg_loss: 94270.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103522.5469; val_chrom_access_recon_loss: 108283499.2000; val_global_loss: 148043266.1333; val_optim_loss: 148043266.1333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9544; val_auprc_score: 0.9463; val_best_acc_score: 0.8899; val_best_f1_score: 0.8938; train_kl_reg_loss: 203480.9530; train_edge_recon_loss: 3032476.5420; train_gene_expr_recon_loss: 36623281.9237; train_masked_gp_l1_reg_loss: 94260.9346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103531.3628; train_chrom_access_recon_loss: 109531121.8931; train_global_loss: 149588154.3817; train_optim_loss: 149588154.3817; val_kl_reg_loss: 72024.2516; val_edge_recon_loss: 3060535.2167; val_gene_expr_recon_loss: 36281821.6000; val_masked_gp_l1_reg_loss: 94251.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103539.7500; val_chrom_access_recon_loss: 107816158.4000; val_global_loss: 147428331.7333; val_optim_loss: 147428331.7333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9533; val_auprc_score: 0.9456; val_best_acc_score: 0.8903; val_best_f1_score: 0.8958; train_kl_reg_loss: 203684.2575; train_edge_recon_loss: 3035090.0973; train_gene_expr_recon_loss: 36599811.2672; train_masked_gp_l1_reg_loss: 94243.9431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103546.5523; train_chrom_access_recon_loss: 109623724.4580; train_global_loss: 149660100.6412; train_optim_loss: 149660100.6412; val_kl_reg_loss: 74316.6438; val_edge_recon_loss: 3028772.6667; val_gene_expr_recon_loss: 36313356.5333; val_masked_gp_l1_reg_loss: 94236.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103552.3047; val_chrom_access_recon_loss: 107739823.4667; val_global_loss: 147354056.5333; val_optim_loss: 147354056.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 46 min 46 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
val AUROC score: 0.9500
val AUPRC score: 0.9416
val best accuracy score: 0.8835
val best F1 score: 0.8892
val target rna MSE score: 1.8370
val source rna MSE score: 129.4074
val target atac MSE score: 0.1208
val source atac MSE score: 1.0694
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
