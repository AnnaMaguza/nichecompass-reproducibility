[True]
Run timestamp: 10082023_191617_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7575; val_auprc_score: 0.7865; val_best_acc_score: 0.5129; val_best_f1_score: 0.6720; train_kl_reg_loss: 109891.7317; train_edge_recon_loss: 3689263.3416; train_gene_expr_recon_loss: 27114575.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5506824.4084; train_global_loss: 36420555.4809; train_optim_loss: 36420555.4809; val_kl_reg_loss: 177123.8271; val_edge_recon_loss: 4064437.6500; val_gene_expr_recon_loss: 23342202.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5245503.5333; val_global_loss: 32829267.4667; val_optim_loss: 32829267.4667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7897; val_auprc_score: 0.8054; val_best_acc_score: 0.6978; val_best_f1_score: 0.7295; train_kl_reg_loss: 171769.5627; train_edge_recon_loss: 3576317.7538; train_gene_expr_recon_loss: 22624049.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5148952.3664; train_global_loss: 31521088.9924; train_optim_loss: 31521088.9924; val_kl_reg_loss: 173730.2917; val_edge_recon_loss: 4044696.8000; val_gene_expr_recon_loss: 22456806.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5152966.1000; val_global_loss: 31828199.8667; val_optim_loss: 31828199.8667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8869; val_auprc_score: 0.8825; val_best_acc_score: 0.8045; val_best_f1_score: 0.8200; train_kl_reg_loss: 146406.7154; train_edge_recon_loss: 3533157.0267; train_gene_expr_recon_loss: 22160346.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5102835.5725; train_global_loss: 30942745.6031; train_optim_loss: 30942745.6031; val_kl_reg_loss: 127691.8313; val_edge_recon_loss: 3819002.9167; val_gene_expr_recon_loss: 22061660.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5085438.6333; val_global_loss: 31093794.1333; val_optim_loss: 31093794.1333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8981; val_auprc_score: 0.8855; val_best_acc_score: 0.8127; val_best_f1_score: 0.8259; train_kl_reg_loss: 139367.1474; train_edge_recon_loss: 3181786.5172; train_gene_expr_recon_loss: 22003552.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5081069.7214; train_global_loss: 30405775.8779; train_optim_loss: 30405775.8779; val_kl_reg_loss: 164857.6802; val_edge_recon_loss: 2989087.7500; val_gene_expr_recon_loss: 21967648.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5092261.3667; val_global_loss: 30213855.7333; val_optim_loss: 30213855.7333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9052; val_auprc_score: 0.8914; val_best_acc_score: 0.8254; val_best_f1_score: 0.8405; train_kl_reg_loss: 159192.9265; train_edge_recon_loss: 2968632.6889; train_gene_expr_recon_loss: 21826234.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5051439.7595; train_global_loss: 30005500.3206; train_optim_loss: 30005500.3206; val_kl_reg_loss: 155877.6281; val_edge_recon_loss: 2941412.3000; val_gene_expr_recon_loss: 21816276.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5053432.0000; val_global_loss: 29966998.1333; val_optim_loss: 29966998.1333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9225; val_auprc_score: 0.9052; val_best_acc_score: 0.8534; val_best_f1_score: 0.8635; train_kl_reg_loss: 151876.6243; train_edge_recon_loss: 2905291.2595; train_gene_expr_recon_loss: 21698079.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5031684.8550; train_global_loss: 29786931.8626; train_optim_loss: 29786931.8626; val_kl_reg_loss: 156543.3010; val_edge_recon_loss: 2883805.2333; val_gene_expr_recon_loss: 21684094.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5035205.9000; val_global_loss: 29759649.0667; val_optim_loss: 29759649.0667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9326; val_auprc_score: 0.9190; val_best_acc_score: 0.8666; val_best_f1_score: 0.8749; train_kl_reg_loss: 148342.9165; train_edge_recon_loss: 2860917.6966; train_gene_expr_recon_loss: 21551905.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5003957.0687; train_global_loss: 29565123.4046; train_optim_loss: 29565123.4046; val_kl_reg_loss: 144172.9010; val_edge_recon_loss: 2857803.1000; val_gene_expr_recon_loss: 21607076.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5034542.1000; val_global_loss: 29643595.3333; val_optim_loss: 29643595.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9331; val_auprc_score: 0.9175; val_best_acc_score: 0.8665; val_best_f1_score: 0.8748; train_kl_reg_loss: 138974.8353; train_edge_recon_loss: 2846803.7691; train_gene_expr_recon_loss: 21447514.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4981184.3511; train_global_loss: 29414477.1756; train_optim_loss: 29414477.1756; val_kl_reg_loss: 137630.0083; val_edge_recon_loss: 2869000.2667; val_gene_expr_recon_loss: 21407357.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4977172.6333; val_global_loss: 29391160.2667; val_optim_loss: 29391160.2667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9437; val_auprc_score: 0.9272; val_best_acc_score: 0.8818; val_best_f1_score: 0.8886; train_kl_reg_loss: 134604.2323; train_edge_recon_loss: 2826551.3397; train_gene_expr_recon_loss: 21349220.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4965548.5534; train_global_loss: 29275924.9618; train_optim_loss: 29275924.9618; val_kl_reg_loss: 130005.6521; val_edge_recon_loss: 2825411.8167; val_gene_expr_recon_loss: 21388506.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5000068.1667; val_global_loss: 29343992.0000; val_optim_loss: 29343992.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9490; val_auprc_score: 0.9365; val_best_acc_score: 0.8882; val_best_f1_score: 0.8926; train_kl_reg_loss: 129820.0939; train_edge_recon_loss: 2801483.4618; train_gene_expr_recon_loss: 21271012.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4952316.9389; train_global_loss: 29154632.5954; train_optim_loss: 29154632.5954; val_kl_reg_loss: 126972.1281; val_edge_recon_loss: 2803106.7667; val_gene_expr_recon_loss: 21256506.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4951147.8333; val_global_loss: 29137733.2000; val_optim_loss: 29137733.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9494; val_auprc_score: 0.9362; val_best_acc_score: 0.8905; val_best_f1_score: 0.8941; train_kl_reg_loss: 127107.8581; train_edge_recon_loss: 2798656.1374; train_gene_expr_recon_loss: 21183539.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4933067.1832; train_global_loss: 29042371.1145; train_optim_loss: 29042371.1145; val_kl_reg_loss: 121059.5099; val_edge_recon_loss: 2788588.2833; val_gene_expr_recon_loss: 21199971.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4945441.9667; val_global_loss: 29055060.9333; val_optim_loss: 29055060.9333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9557; val_auprc_score: 0.9449; val_best_acc_score: 0.8976; val_best_f1_score: 0.9020; train_kl_reg_loss: 121487.1711; train_edge_recon_loss: 2781164.9313; train_gene_expr_recon_loss: 21151897.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4932811.2977; train_global_loss: 28987361.2672; train_optim_loss: 28987361.2672; val_kl_reg_loss: 119145.4146; val_edge_recon_loss: 2766811.1500; val_gene_expr_recon_loss: 21177005.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4951191.2000; val_global_loss: 29014153.6000; val_optim_loss: 29014153.6000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9533; val_auprc_score: 0.9437; val_best_acc_score: 0.8902; val_best_f1_score: 0.8943; train_kl_reg_loss: 118653.1832; train_edge_recon_loss: 2766764.2634; train_gene_expr_recon_loss: 21083820.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4921999.3740; train_global_loss: 28891237.7099; train_optim_loss: 28891237.7099; val_kl_reg_loss: 114011.6891; val_edge_recon_loss: 2797833.5500; val_gene_expr_recon_loss: 21113723.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4951772.5000; val_global_loss: 28977341.0667; val_optim_loss: 28977341.0667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9586; val_auprc_score: 0.9486; val_best_acc_score: 0.9007; val_best_f1_score: 0.9062; train_kl_reg_loss: 115350.1529; train_edge_recon_loss: 2762527.5496; train_gene_expr_recon_loss: 21016794.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4907767.5725; train_global_loss: 28802439.3435; train_optim_loss: 28802439.3435; val_kl_reg_loss: 111059.0604; val_edge_recon_loss: 2758919.5000; val_gene_expr_recon_loss: 21041314.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4922627.8333; val_global_loss: 28833920.9333; val_optim_loss: 28833920.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9609; val_auprc_score: 0.9499; val_best_acc_score: 0.9057; val_best_f1_score: 0.9094; train_kl_reg_loss: 112379.7533; train_edge_recon_loss: 2748512.9924; train_gene_expr_recon_loss: 20962455.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4903299.2672; train_global_loss: 28726647.3435; train_optim_loss: 28726647.3435; val_kl_reg_loss: 111345.9708; val_edge_recon_loss: 2763708.0667; val_gene_expr_recon_loss: 21040244.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4929739.5333; val_global_loss: 28845037.3333; val_optim_loss: 28845037.3333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9661; val_auprc_score: 0.9571; val_best_acc_score: 0.9101; val_best_f1_score: 0.9137; train_kl_reg_loss: 108193.2561; train_edge_recon_loss: 2748346.8473; train_gene_expr_recon_loss: 20907736.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4890966.5344; train_global_loss: 28655242.9618; train_optim_loss: 28655242.9618; val_kl_reg_loss: 107973.9271; val_edge_recon_loss: 2742483.6833; val_gene_expr_recon_loss: 20868253.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4905262.9333; val_global_loss: 28623974.2667; val_optim_loss: 28623974.2667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9676; val_auprc_score: 0.9592; val_best_acc_score: 0.9140; val_best_f1_score: 0.9172; train_kl_reg_loss: 105654.8516; train_edge_recon_loss: 2737913.6908; train_gene_expr_recon_loss: 20854105.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4881248.9237; train_global_loss: 28578922.4885; train_optim_loss: 28578922.4885; val_kl_reg_loss: 105663.8302; val_edge_recon_loss: 2734468.9667; val_gene_expr_recon_loss: 20953068.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4913850.5000; val_global_loss: 28707052.0000; val_optim_loss: 28707052.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9687; val_auprc_score: 0.9618; val_best_acc_score: 0.9173; val_best_f1_score: 0.9193; train_kl_reg_loss: 103390.8509; train_edge_recon_loss: 2737111.8302; train_gene_expr_recon_loss: 20834274.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4882336.4542; train_global_loss: 28557113.8168; train_optim_loss: 28557113.8168; val_kl_reg_loss: 103265.5849; val_edge_recon_loss: 2735455.6333; val_gene_expr_recon_loss: 20769852.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4876210.8000; val_global_loss: 28484784.4000; val_optim_loss: 28484784.4000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9689; val_auprc_score: 0.9598; val_best_acc_score: 0.9140; val_best_f1_score: 0.9173; train_kl_reg_loss: 101547.3784; train_edge_recon_loss: 2729277.0916; train_gene_expr_recon_loss: 20791599.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4875177.2061; train_global_loss: 28497600.9466; train_optim_loss: 28497600.9466; val_kl_reg_loss: 98526.4641; val_edge_recon_loss: 2742475.3667; val_gene_expr_recon_loss: 20966867.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4924660.0667; val_global_loss: 28732529.8667; val_optim_loss: 28732529.8667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9732; val_auprc_score: 0.9679; val_best_acc_score: 0.9214; val_best_f1_score: 0.9242; train_kl_reg_loss: 97729.5224; train_edge_recon_loss: 2726917.0534; train_gene_expr_recon_loss: 20731438.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4862818.6374; train_global_loss: 28418903.4656; train_optim_loss: 28418903.4656; val_kl_reg_loss: 95812.4885; val_edge_recon_loss: 2709790.3167; val_gene_expr_recon_loss: 20810354.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4892844.4667; val_global_loss: 28508800.9333; val_optim_loss: 28508800.9333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9716; val_auprc_score: 0.9654; val_best_acc_score: 0.9181; val_best_f1_score: 0.9205; train_kl_reg_loss: 96329.7422; train_edge_recon_loss: 2720240.7538; train_gene_expr_recon_loss: 20713372.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4866548.7176; train_global_loss: 28396492.0305; train_optim_loss: 28396492.0305; val_kl_reg_loss: 94608.4604; val_edge_recon_loss: 2712363.5833; val_gene_expr_recon_loss: 20843522.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4897926.7000; val_global_loss: 28548421.3333; val_optim_loss: 28548421.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9712; val_auprc_score: 0.9618; val_best_acc_score: 0.9198; val_best_f1_score: 0.9227; train_kl_reg_loss: 94066.2783; train_edge_recon_loss: 2720624.3969; train_gene_expr_recon_loss: 20680384.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4858946.4733; train_global_loss: 28354022.0153; train_optim_loss: 28354022.0153; val_kl_reg_loss: 93538.6323; val_edge_recon_loss: 2719844.9667; val_gene_expr_recon_loss: 20753747.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4856857.6333; val_global_loss: 28423988.8000; val_optim_loss: 28423988.8000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9756; val_auprc_score: 0.9669; val_best_acc_score: 0.9286; val_best_f1_score: 0.9295; train_kl_reg_loss: 92557.4773; train_edge_recon_loss: 2707839.2080; train_gene_expr_recon_loss: 20641499.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4859080.3168; train_global_loss: 28300976.1832; train_optim_loss: 28300976.1832; val_kl_reg_loss: 90928.6719; val_edge_recon_loss: 2715174.2167; val_gene_expr_recon_loss: 20712016.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4885485.9667; val_global_loss: 28403605.4667; val_optim_loss: 28403605.4667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9767; val_auprc_score: 0.9721; val_best_acc_score: 0.9271; val_best_f1_score: 0.9291; train_kl_reg_loss: 91251.5828; train_edge_recon_loss: 2712479.5305; train_gene_expr_recon_loss: 20614246.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4857120.4389; train_global_loss: 28275097.7252; train_optim_loss: 28275097.7252; val_kl_reg_loss: 90104.8557; val_edge_recon_loss: 2709801.4833; val_gene_expr_recon_loss: 20801390.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4877775.2333; val_global_loss: 28479071.8667; val_optim_loss: 28479071.8667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9777; val_auprc_score: 0.9716; val_best_acc_score: 0.9314; val_best_f1_score: 0.9332; train_kl_reg_loss: 89511.6382; train_edge_recon_loss: 2701371.2366; train_gene_expr_recon_loss: 20579386.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4849159.1794; train_global_loss: 28219428.6260; train_optim_loss: 28219428.6260; val_kl_reg_loss: 88428.0656; val_edge_recon_loss: 2712685.7333; val_gene_expr_recon_loss: 20702465.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4874268.5333; val_global_loss: 28377847.6000; val_optim_loss: 28377847.6000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9676; val_auprc_score: 0.9593; val_best_acc_score: 0.9177; val_best_f1_score: 0.9210; train_kl_reg_loss: 112131.6203; train_edge_recon_loss: 2811508.0496; train_gene_expr_recon_loss: 22524347.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4978637.7481; train_global_loss: 30426625.3740; train_optim_loss: 30426625.3740; val_kl_reg_loss: 16334.2152; val_edge_recon_loss: 2850394.6667; val_gene_expr_recon_loss: 23089834.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5000216.9000; val_global_loss: 30956780.6667; val_optim_loss: 30956780.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9510; val_auprc_score: 0.9366; val_best_acc_score: 0.8932; val_best_f1_score: 0.8976; train_kl_reg_loss: 126864.5796; train_edge_recon_loss: 2880421.1279; train_gene_expr_recon_loss: 24293040.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5044477.5496; train_global_loss: 32344804.1221; train_optim_loss: 32344804.1221; val_kl_reg_loss: 10828.7820; val_edge_recon_loss: 2802305.5500; val_gene_expr_recon_loss: 24288446.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5059349.0333; val_global_loss: 32160929.4667; val_optim_loss: 32160929.4667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9588; val_auprc_score: 0.9468; val_best_acc_score: 0.9061; val_best_f1_score: 0.9097; train_kl_reg_loss: 62800.1806; train_edge_recon_loss: 2744507.5534; train_gene_expr_recon_loss: 23985223.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5024518.0954; train_global_loss: 31817049.4046; train_optim_loss: 31817049.4046; val_kl_reg_loss: 16514.4405; val_edge_recon_loss: 2710576.9333; val_gene_expr_recon_loss: 23912341.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5052960.7333; val_global_loss: 31692393.3333; val_optim_loss: 31692393.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9573; val_auprc_score: 0.9431; val_best_acc_score: 0.9030; val_best_f1_score: 0.9083; train_kl_reg_loss: 44305.1313; train_edge_recon_loss: 2702068.4905; train_gene_expr_recon_loss: 23634606.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5014028.3015; train_global_loss: 31395008.3206; train_optim_loss: 31395008.3206; val_kl_reg_loss: 20538.9262; val_edge_recon_loss: 2723659.1000; val_gene_expr_recon_loss: 23504426.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5026726.8333; val_global_loss: 31275351.7333; val_optim_loss: 31275351.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9606; val_auprc_score: 0.9477; val_best_acc_score: 0.9073; val_best_f1_score: 0.9120; train_kl_reg_loss: 40724.6551; train_edge_recon_loss: 2695014.1546; train_gene_expr_recon_loss: 23467804.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5003532.8435; train_global_loss: 31207076.6718; train_optim_loss: 31207076.6718; val_kl_reg_loss: 21000.2536; val_edge_recon_loss: 2707069.0833; val_gene_expr_recon_loss: 23524627.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5051011.0333; val_global_loss: 31303707.4667; val_optim_loss: 31303707.4667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9620; val_auprc_score: 0.9517; val_best_acc_score: 0.9107; val_best_f1_score: 0.9144; train_kl_reg_loss: 39947.0598; train_edge_recon_loss: 2694471.8817; train_gene_expr_recon_loss: 23457882.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5009482.8550; train_global_loss: 31201784.4580; train_optim_loss: 31201784.4580; val_kl_reg_loss: 21258.1944; val_edge_recon_loss: 2689180.2167; val_gene_expr_recon_loss: 23520073.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5020449.2667; val_global_loss: 31250961.2000; val_optim_loss: 31250961.2000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9633; val_auprc_score: 0.9491; val_best_acc_score: 0.9109; val_best_f1_score: 0.9144; train_kl_reg_loss: 39121.8567; train_edge_recon_loss: 2690116.0038; train_gene_expr_recon_loss: 23435455.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5006644.7328; train_global_loss: 31171338.1221; train_optim_loss: 31171338.1221; val_kl_reg_loss: 21821.1616; val_edge_recon_loss: 2697384.5500; val_gene_expr_recon_loss: 23394940.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5019471.9000; val_global_loss: 31133618.0000; val_optim_loss: 31133618.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9599; val_auprc_score: 0.9439; val_best_acc_score: 0.9089; val_best_f1_score: 0.9128; train_kl_reg_loss: 38541.9416; train_edge_recon_loss: 2685790.4256; train_gene_expr_recon_loss: 23383039.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4998027.1527; train_global_loss: 31105398.7634; train_optim_loss: 31105398.7634; val_kl_reg_loss: 21976.6905; val_edge_recon_loss: 2712307.4000; val_gene_expr_recon_loss: 23496801.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5045942.1667; val_global_loss: 31277027.0667; val_optim_loss: 31277027.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9731
val AUPRC score: 0.9669
val best accuracy score: 0.9205
val best F1 score: 0.9228
val target rna MSE score: 1.3930
val source rna MSE score: 50.5790
val target atac MSE score: 0.3659
val source atac MSE score: 3.1150
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
