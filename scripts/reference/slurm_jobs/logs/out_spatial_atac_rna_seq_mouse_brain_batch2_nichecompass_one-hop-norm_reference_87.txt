[True]
Run timestamp: 29072023_120923_87.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_87']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8878; val_auprc_score: 0.9031; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 31708.5757; train_edge_recon_loss: 3514666.3333; train_gene_expr_recon_loss: 7415348.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 182780961.7778; train_global_loss: 193742686.2222; train_optim_loss: 193742686.2222; val_kl_reg_loss: 85181.8594; val_edge_recon_loss: 4066046.0000; val_gene_expr_recon_loss: 6782882.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 171675616.0000; val_global_loss: 182609728.0000; val_optim_loss: 182609728.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8943; val_auprc_score: 0.9111; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 54737.0872; train_edge_recon_loss: 3652919.5000; train_gene_expr_recon_loss: 7009143.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 174711368.8889; train_global_loss: 185428168.8889; train_optim_loss: 185428168.8889; val_kl_reg_loss: 36236.7148; val_edge_recon_loss: 4066159.7500; val_gene_expr_recon_loss: 6617368.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 168754800.0000; val_global_loss: 179474560.0000; val_optim_loss: 179474560.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8913; val_auprc_score: 0.9048; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 56239.0521; train_edge_recon_loss: 3721056.2500; train_gene_expr_recon_loss: 6552123.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 169706792.8889; train_global_loss: 180036213.3333; train_optim_loss: 180036213.3333; val_kl_reg_loss: 50897.5391; val_edge_recon_loss: 4066207.0000; val_gene_expr_recon_loss: 6354338.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 166876256.0000; val_global_loss: 177347696.0000; val_optim_loss: 177347696.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8923; val_auprc_score: 0.9042; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 66807.7109; train_edge_recon_loss: 3748016.8056; train_gene_expr_recon_loss: 6420781.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 167382236.4444; train_global_loss: 177617845.3333; train_optim_loss: 177617845.3333; val_kl_reg_loss: 85430.1875; val_edge_recon_loss: 4066217.5000; val_gene_expr_recon_loss: 6263085.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 164932704.0000; val_global_loss: 175347440.0000; val_optim_loss: 175347440.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8762; val_auprc_score: 0.8891; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 95545.7960; train_edge_recon_loss: 3746042.2778; train_gene_expr_recon_loss: 6250157.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 165514158.2222; train_global_loss: 175605904.0000; train_optim_loss: 175605904.0000; val_kl_reg_loss: 89774.1250; val_edge_recon_loss: 4066218.7500; val_gene_expr_recon_loss: 6083745.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 163273472.0000; val_global_loss: 173513216.0000; val_optim_loss: 173513216.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8627; val_auprc_score: 0.8763; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 125305.3993; train_edge_recon_loss: 3719949.4722; train_gene_expr_recon_loss: 6147824.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 164399088.0000; train_global_loss: 174392168.8889; train_optim_loss: 174392168.8889; val_kl_reg_loss: 114629.3594; val_edge_recon_loss: 4066188.0000; val_gene_expr_recon_loss: 6032984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 162714336.0000; val_global_loss: 172928144.0000; val_optim_loss: 172928144.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8432; val_auprc_score: 0.8591; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 133472.3576; train_edge_recon_loss: 3701958.2778; train_gene_expr_recon_loss: 6054604.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 163387205.3333; train_global_loss: 173277237.3333; train_optim_loss: 173277237.3333; val_kl_reg_loss: 128064.2812; val_edge_recon_loss: 4066168.0000; val_gene_expr_recon_loss: 5918363.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 161455904.0000; val_global_loss: 171568496.0000; val_optim_loss: 171568496.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8457; val_auprc_score: 0.8632; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 144924.7326; train_edge_recon_loss: 3680687.8611; train_gene_expr_recon_loss: 5947824.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 162771105.7778; train_global_loss: 172544544.0000; train_optim_loss: 172544544.0000; val_kl_reg_loss: 136453.3594; val_edge_recon_loss: 4066107.0000; val_gene_expr_recon_loss: 5837564.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 160932144.0000; val_global_loss: 170972272.0000; val_optim_loss: 170972272.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8531; val_auprc_score: 0.8629; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 159044.1910; train_edge_recon_loss: 3650954.3056; train_gene_expr_recon_loss: 5855379.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 161884549.3333; train_global_loss: 171549927.1111; train_optim_loss: 171549927.1111; val_kl_reg_loss: 129228.3984; val_edge_recon_loss: 4065947.7500; val_gene_expr_recon_loss: 5732734.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 160547296.0000; val_global_loss: 170475200.0000; val_optim_loss: 170475200.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8526; val_auprc_score: 0.8552; val_best_acc_score: 0.5049; val_best_f1_score: 0.6688; train_kl_reg_loss: 158000.3142; train_edge_recon_loss: 3626117.1667; train_gene_expr_recon_loss: 5735366.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 161299203.5556; train_global_loss: 170818686.2222; train_optim_loss: 170818686.2222; val_kl_reg_loss: 129240.9062; val_edge_recon_loss: 4065558.2500; val_gene_expr_recon_loss: 5600113.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 159793504.0000; val_global_loss: 169588416.0000; val_optim_loss: 169588416.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8447; val_auprc_score: 0.8406; val_best_acc_score: 0.5132; val_best_f1_score: 0.6725; train_kl_reg_loss: 155157.9948; train_edge_recon_loss: 3612093.9722; train_gene_expr_recon_loss: 5570571.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 160768478.2222; train_global_loss: 170106300.4444; train_optim_loss: 170106300.4444; val_kl_reg_loss: 153752.2500; val_edge_recon_loss: 4064884.7500; val_gene_expr_recon_loss: 5417269.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 159109584.0000; val_global_loss: 168745488.0000; val_optim_loss: 168745488.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8348; val_auprc_score: 0.8288; val_best_acc_score: 0.5306; val_best_f1_score: 0.6801; train_kl_reg_loss: 165002.8021; train_edge_recon_loss: 3594489.6389; train_gene_expr_recon_loss: 5404585.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 160513527.1111; train_global_loss: 169677603.5556; train_optim_loss: 169677603.5556; val_kl_reg_loss: 144408.6719; val_edge_recon_loss: 4063621.5000; val_gene_expr_recon_loss: 5223125.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 158033024.0000; val_global_loss: 167464176.0000; val_optim_loss: 167464176.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8136; val_auprc_score: 0.8039; val_best_acc_score: 0.5443; val_best_f1_score: 0.6850; train_kl_reg_loss: 160309.1562; train_edge_recon_loss: 3588746.7222; train_gene_expr_recon_loss: 5175838.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 158399582.2222; train_global_loss: 167324476.4444; train_optim_loss: 167324476.4444; val_kl_reg_loss: 140265.2344; val_edge_recon_loss: 4062467.7500; val_gene_expr_recon_loss: 5010854.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156768768.0000; val_global_loss: 165982352.0000; val_optim_loss: 165982352.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8007; val_auprc_score: 0.7912; val_best_acc_score: 0.5682; val_best_f1_score: 0.6950; train_kl_reg_loss: 161765.4219; train_edge_recon_loss: 3586361.1111; train_gene_expr_recon_loss: 5012369.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 159073955.5556; train_global_loss: 167834451.5556; train_optim_loss: 167834451.5556; val_kl_reg_loss: 130415.2969; val_edge_recon_loss: 4060613.0000; val_gene_expr_recon_loss: 4835622.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155833152.0000; val_global_loss: 164859808.0000; val_optim_loss: 164859808.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7929; val_auprc_score: 0.7805; val_best_acc_score: 0.5838; val_best_f1_score: 0.7015; train_kl_reg_loss: 156759.5747; train_edge_recon_loss: 3579133.3056; train_gene_expr_recon_loss: 4800936.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156896561.7778; train_global_loss: 165433390.2222; train_optim_loss: 165433390.2222; val_kl_reg_loss: 120429.7500; val_edge_recon_loss: 4059513.0000; val_gene_expr_recon_loss: 4677488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154903680.0000; val_global_loss: 163761104.0000; val_optim_loss: 163761104.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7886; val_auprc_score: 0.7802; val_best_acc_score: 0.6016; val_best_f1_score: 0.7090; train_kl_reg_loss: 154539.9019; train_edge_recon_loss: 3581569.9444; train_gene_expr_recon_loss: 4656749.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156003783.1111; train_global_loss: 164396641.7778; train_optim_loss: 164396641.7778; val_kl_reg_loss: 123074.1875; val_edge_recon_loss: 4057984.7500; val_gene_expr_recon_loss: 4504637.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154080672.0000; val_global_loss: 162766368.0000; val_optim_loss: 162766368.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7777; val_auprc_score: 0.7648; val_best_acc_score: 0.6118; val_best_f1_score: 0.7130; train_kl_reg_loss: 155854.3438; train_edge_recon_loss: 3574534.3611; train_gene_expr_recon_loss: 4511811.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155887372.4444; train_global_loss: 164129569.7778; train_optim_loss: 164129569.7778; val_kl_reg_loss: 122701.8594; val_edge_recon_loss: 4056823.2500; val_gene_expr_recon_loss: 4382275.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153217904.0000; val_global_loss: 161779712.0000; val_optim_loss: 161779712.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7808; val_auprc_score: 0.7720; val_best_acc_score: 0.6249; val_best_f1_score: 0.7191; train_kl_reg_loss: 150348.8559; train_edge_recon_loss: 3570610.3056; train_gene_expr_recon_loss: 4377903.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154166672.0000; train_global_loss: 162265536.0000; train_optim_loss: 162265536.0000; val_kl_reg_loss: 123649.4766; val_edge_recon_loss: 4055218.7500; val_gene_expr_recon_loss: 4277648.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152962624.0000; val_global_loss: 161419136.0000; val_optim_loss: 161419136.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7790; val_auprc_score: 0.7669; val_best_acc_score: 0.6366; val_best_f1_score: 0.7236; train_kl_reg_loss: 147093.3116; train_edge_recon_loss: 3571645.4722; train_gene_expr_recon_loss: 4282387.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155050181.3333; train_global_loss: 163051306.6667; train_optim_loss: 163051306.6667; val_kl_reg_loss: 130509.4688; val_edge_recon_loss: 4053087.2500; val_gene_expr_recon_loss: 4180086.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152554048.0000; val_global_loss: 160917728.0000; val_optim_loss: 160917728.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.7851; val_auprc_score: 0.7757; val_best_acc_score: 0.6610; val_best_f1_score: 0.7353; train_kl_reg_loss: 146680.5417; train_edge_recon_loss: 3564278.1944; train_gene_expr_recon_loss: 4205283.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153621984.0000; train_global_loss: 161538229.3333; train_optim_loss: 161538229.3333; val_kl_reg_loss: 127419.0938; val_edge_recon_loss: 4050779.0000; val_gene_expr_recon_loss: 4113770.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152064096.0000; val_global_loss: 160356064.0000; val_optim_loss: 160356064.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7830; val_auprc_score: 0.7752; val_best_acc_score: 0.6571; val_best_f1_score: 0.7315; train_kl_reg_loss: 143085.8056; train_edge_recon_loss: 3564077.4722; train_gene_expr_recon_loss: 4131750.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152736894.2222; train_global_loss: 160575811.5556; train_optim_loss: 160575811.5556; val_kl_reg_loss: 135139.9219; val_edge_recon_loss: 4049451.2500; val_gene_expr_recon_loss: 4055527.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152006880.0000; val_global_loss: 160246992.0000; val_optim_loss: 160246992.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.7868; val_auprc_score: 0.7761; val_best_acc_score: 0.6733; val_best_f1_score: 0.7380; train_kl_reg_loss: 143963.9809; train_edge_recon_loss: 3558223.9444; train_gene_expr_recon_loss: 4101350.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153237863.1111; train_global_loss: 161041400.8889; train_optim_loss: 161041400.8889; val_kl_reg_loss: 119419.0625; val_edge_recon_loss: 4047182.7500; val_gene_expr_recon_loss: 4018232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151568704.0000; val_global_loss: 159753536.0000; val_optim_loss: 159753536.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.7914; val_auprc_score: 0.7820; val_best_acc_score: 0.6849; val_best_f1_score: 0.7423; train_kl_reg_loss: 137797.8776; train_edge_recon_loss: 3561159.6667; train_gene_expr_recon_loss: 4044350.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152710624.0000; train_global_loss: 160453934.2222; train_optim_loss: 160453934.2222; val_kl_reg_loss: 116212.3828; val_edge_recon_loss: 4045178.0000; val_gene_expr_recon_loss: 3979583.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151397472.0000; val_global_loss: 159538448.0000; val_optim_loss: 159538448.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.7937; val_auprc_score: 0.7811; val_best_acc_score: 0.6929; val_best_f1_score: 0.7441; train_kl_reg_loss: 140997.5026; train_edge_recon_loss: 3554722.3333; train_gene_expr_recon_loss: 4007240.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152737415.1111; train_global_loss: 160440376.8889; train_optim_loss: 160440376.8889; val_kl_reg_loss: 115531.9844; val_edge_recon_loss: 4042272.2500; val_gene_expr_recon_loss: 3943635.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151098816.0000; val_global_loss: 159200256.0000; val_optim_loss: 159200256.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.7927; val_auprc_score: 0.7726; val_best_acc_score: 0.7094; val_best_f1_score: 0.7524; train_kl_reg_loss: 137444.7943; train_edge_recon_loss: 3552032.5000; train_gene_expr_recon_loss: 3986994.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152877404.4444; train_global_loss: 160553875.5556; train_optim_loss: 160553875.5556; val_kl_reg_loss: 116561.7812; val_edge_recon_loss: 4039729.7500; val_gene_expr_recon_loss: 3912089.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 150962432.0000; val_global_loss: 159030816.0000; val_optim_loss: 159030816.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8061; val_auprc_score: 0.7971; val_best_acc_score: 0.7041; val_best_f1_score: 0.7499; train_kl_reg_loss: 123092.0339; train_edge_recon_loss: 3861093.1111; train_gene_expr_recon_loss: 4049636.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152717367.1111; train_global_loss: 160751189.3333; train_optim_loss: 160751189.3333; val_kl_reg_loss: 59208.0078; val_edge_recon_loss: 4038285.2500; val_gene_expr_recon_loss: 3898128.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151325824.0000; val_global_loss: 159321440.0000; val_optim_loss: 159321440.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.7931; val_auprc_score: 0.7970; val_best_acc_score: 0.5798; val_best_f1_score: 0.6989; train_kl_reg_loss: 67155.4436; train_edge_recon_loss: 3884235.8056; train_gene_expr_recon_loss: 4153107.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154692250.6667; train_global_loss: 162796750.2222; train_optim_loss: 162796750.2222; val_kl_reg_loss: 74288.7656; val_edge_recon_loss: 4059924.2500; val_gene_expr_recon_loss: 3928773.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151667968.0000; val_global_loss: 159730960.0000; val_optim_loss: 159730960.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8053; val_auprc_score: 0.8125; val_best_acc_score: 0.5400; val_best_f1_score: 0.6832; train_kl_reg_loss: 69969.1662; train_edge_recon_loss: 3797398.5278; train_gene_expr_recon_loss: 4044025.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154003288.8889; train_global_loss: 161914682.6667; train_optim_loss: 161914682.6667; val_kl_reg_loss: 44047.6719; val_edge_recon_loss: 4062720.7500; val_gene_expr_recon_loss: 3991888.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151836288.0000; val_global_loss: 159934944.0000; val_optim_loss: 159934944.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8324; val_auprc_score: 0.8393; val_best_acc_score: 0.5287; val_best_f1_score: 0.6771; train_kl_reg_loss: 66756.5187; train_edge_recon_loss: 3711239.3611; train_gene_expr_recon_loss: 4070280.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153959480.8889; train_global_loss: 161807758.2222; train_optim_loss: 161807758.2222; val_kl_reg_loss: 82673.7812; val_edge_recon_loss: 4062808.7500; val_gene_expr_recon_loss: 3896616.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151606336.0000; val_global_loss: 159648432.0000; val_optim_loss: 159648432.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8304; val_auprc_score: 0.8309; val_best_acc_score: 0.5271; val_best_f1_score: 0.6764; train_kl_reg_loss: 91112.4792; train_edge_recon_loss: 3620197.3611; train_gene_expr_recon_loss: 3977238.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153496158.2222; train_global_loss: 161184707.5556; train_optim_loss: 161184707.5556; val_kl_reg_loss: 80846.0312; val_edge_recon_loss: 4062829.0000; val_gene_expr_recon_loss: 3897883.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151644736.0000; val_global_loss: 159686288.0000; val_optim_loss: 159686288.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8291; val_auprc_score: 0.8301; val_best_acc_score: 0.5274; val_best_f1_score: 0.6767; train_kl_reg_loss: 90552.8134; train_edge_recon_loss: 3619730.3333; train_gene_expr_recon_loss: 3960945.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152306147.5556; train_global_loss: 159977376.0000; train_optim_loss: 159977376.0000; val_kl_reg_loss: 93592.7031; val_edge_recon_loss: 4062728.5000; val_gene_expr_recon_loss: 3905613.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151517168.0000; val_global_loss: 159579104.0000; val_optim_loss: 159579104.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8347; val_auprc_score: 0.8373; val_best_acc_score: 0.5288; val_best_f1_score: 0.6776; train_kl_reg_loss: 112810.9644; train_edge_recon_loss: 3606388.2778; train_gene_expr_recon_loss: 3974085.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152580556.4444; train_global_loss: 160273841.7778; train_optim_loss: 160273841.7778; val_kl_reg_loss: 113127.5234; val_edge_recon_loss: 4062668.0000; val_gene_expr_recon_loss: 3891910.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151384896.0000; val_global_loss: 159452608.0000; val_optim_loss: 159452608.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8320; val_auprc_score: 0.8377; val_best_acc_score: 0.5338; val_best_f1_score: 0.6800; train_kl_reg_loss: 120177.8646; train_edge_recon_loss: 3592958.8889; train_gene_expr_recon_loss: 3959035.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152794871.1111; train_global_loss: 160467041.7778; train_optim_loss: 160467041.7778; val_kl_reg_loss: 102913.7422; val_edge_recon_loss: 4062609.2500; val_gene_expr_recon_loss: 3886445.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 151152768.0000; val_global_loss: 159204736.0000; val_optim_loss: 159204736.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 44 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8053
val AUPRC score: 0.7994
val best accuracy score: 0.6901
val best F1 score: 0.7443
val target rna MSE score: 7.5551
val source rna MSE score: 7.9269
val target atac MSE score: 0.1187
val source atac MSE score: 0.0174
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
