[True]
Run timestamp: 10102023_003247_87.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_87']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6829; val_auprc_score: 0.6532; val_best_acc_score: 0.5054; val_best_f1_score: 0.6685; train_kl_reg_loss: 55641.9567; train_edge_recon_loss: 3517206.9015; train_gene_expr_recon_loss: 14022573.4545; train_masked_gp_l1_reg_loss: 30200.2764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3669436.3258; train_chrom_access_recon_loss: 6935696.9242; train_global_loss: 28230755.8182; train_optim_loss: 28230755.8182; val_kl_reg_loss: 109335.9844; val_edge_recon_loss: 4064847.7500; val_gene_expr_recon_loss: 13040791.1250; val_masked_gp_l1_reg_loss: 35722.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2077253.3750; val_chrom_access_recon_loss: 6744977.6875; val_global_loss: 26072928.7500; val_optim_loss: 26072928.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6885; val_auprc_score: 0.6718; val_best_acc_score: 0.5505; val_best_f1_score: 0.6840; train_kl_reg_loss: 95037.7232; train_edge_recon_loss: 3521304.0985; train_gene_expr_recon_loss: 12866208.0455; train_masked_gp_l1_reg_loss: 38313.2328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1151996.3040; train_chrom_access_recon_loss: 6610899.4091; train_global_loss: 24283758.5152; train_optim_loss: 24283758.5152; val_kl_reg_loss: 112522.2500; val_edge_recon_loss: 4062191.4375; val_gene_expr_recon_loss: 12893882.8750; val_masked_gp_l1_reg_loss: 40694.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 570802.3125; val_chrom_access_recon_loss: 6683735.3125; val_global_loss: 24363827.7500; val_optim_loss: 24363827.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7201; val_auprc_score: 0.7082; val_best_acc_score: 0.6572; val_best_f1_score: 0.6870; train_kl_reg_loss: 89221.1908; train_edge_recon_loss: 3512401.4129; train_gene_expr_recon_loss: 12700811.3939; train_masked_gp_l1_reg_loss: 42005.6964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 380505.3487; train_chrom_access_recon_loss: 6547333.3864; train_global_loss: 23272278.3636; train_optim_loss: 23272278.3636; val_kl_reg_loss: 79060.8701; val_edge_recon_loss: 4047265.2812; val_gene_expr_recon_loss: 12776230.8750; val_masked_gp_l1_reg_loss: 43428.6445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 256347.1406; val_chrom_access_recon_loss: 6653326.8750; val_global_loss: 23855659.5000; val_optim_loss: 23855659.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8005; val_auprc_score: 0.7771; val_best_acc_score: 0.7249; val_best_f1_score: 0.7502; train_kl_reg_loss: 77250.7188; train_edge_recon_loss: 3495498.3598; train_gene_expr_recon_loss: 12620963.3788; train_masked_gp_l1_reg_loss: 44715.4924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200540.1823; train_chrom_access_recon_loss: 6522697.7500; train_global_loss: 22961665.6970; train_optim_loss: 22961665.6970; val_kl_reg_loss: 66863.9434; val_edge_recon_loss: 3836359.4375; val_gene_expr_recon_loss: 12657941.3750; val_masked_gp_l1_reg_loss: 46176.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159829.0781; val_chrom_access_recon_loss: 6667146.5000; val_global_loss: 23434316.7500; val_optim_loss: 23434316.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8683; val_auprc_score: 0.8414; val_best_acc_score: 0.7953; val_best_f1_score: 0.8178; train_kl_reg_loss: 66441.9827; train_edge_recon_loss: 3207552.4621; train_gene_expr_recon_loss: 12555506.6212; train_masked_gp_l1_reg_loss: 48658.0657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140513.3933; train_chrom_access_recon_loss: 6480160.8485; train_global_loss: 22498833.3333; train_optim_loss: 22498833.3333; val_kl_reg_loss: 89914.5566; val_edge_recon_loss: 2985727.0000; val_gene_expr_recon_loss: 12589572.0000; val_masked_gp_l1_reg_loss: 51576.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126612.9844; val_chrom_access_recon_loss: 6603821.3750; val_global_loss: 22447224.2500; val_optim_loss: 22447224.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8804; val_auprc_score: 0.8384; val_best_acc_score: 0.8240; val_best_f1_score: 0.8382; train_kl_reg_loss: 102516.7204; train_edge_recon_loss: 2875607.7311; train_gene_expr_recon_loss: 12477794.3333; train_masked_gp_l1_reg_loss: 53605.4209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117897.4805; train_chrom_access_recon_loss: 6442067.9091; train_global_loss: 22069489.4545; train_optim_loss: 22069489.4545; val_kl_reg_loss: 107593.7139; val_edge_recon_loss: 2882122.0000; val_gene_expr_recon_loss: 12469278.2500; val_masked_gp_l1_reg_loss: 55090.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111541.2500; val_chrom_access_recon_loss: 6471992.8125; val_global_loss: 22097617.5000; val_optim_loss: 22097617.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9009; val_auprc_score: 0.8696; val_best_acc_score: 0.8350; val_best_f1_score: 0.8480; train_kl_reg_loss: 106369.5343; train_edge_recon_loss: 2821442.0303; train_gene_expr_recon_loss: 12382424.1061; train_masked_gp_l1_reg_loss: 56265.4705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106451.3464; train_chrom_access_recon_loss: 6413414.2576; train_global_loss: 21886366.5758; train_optim_loss: 21886366.5758; val_kl_reg_loss: 102578.7549; val_edge_recon_loss: 2869485.9375; val_gene_expr_recon_loss: 12393668.6250; val_masked_gp_l1_reg_loss: 57449.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102325.9766; val_chrom_access_recon_loss: 6470601.5000; val_global_loss: 21996110.5000; val_optim_loss: 21996110.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8958; val_auprc_score: 0.8655; val_best_acc_score: 0.8224; val_best_f1_score: 0.8398; train_kl_reg_loss: 102048.7917; train_edge_recon_loss: 2820309.1439; train_gene_expr_recon_loss: 12312213.7727; train_masked_gp_l1_reg_loss: 58622.8863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98604.0736; train_chrom_access_recon_loss: 6372413.2955; train_global_loss: 21764212.1515; train_optim_loss: 21764212.1515; val_kl_reg_loss: 100879.2256; val_edge_recon_loss: 2864464.0938; val_gene_expr_recon_loss: 12407524.8750; val_masked_gp_l1_reg_loss: 59801.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96019.9062; val_chrom_access_recon_loss: 6418763.8750; val_global_loss: 21947454.0000; val_optim_loss: 21947454.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8939; val_auprc_score: 0.8598; val_best_acc_score: 0.8326; val_best_f1_score: 0.8450; train_kl_reg_loss: 101122.9492; train_edge_recon_loss: 2821583.9886; train_gene_expr_recon_loss: 12268806.2424; train_masked_gp_l1_reg_loss: 60672.1450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93311.2415; train_chrom_access_recon_loss: 6358623.4015; train_global_loss: 21704119.9394; train_optim_loss: 21704119.9394; val_kl_reg_loss: 102572.4531; val_edge_recon_loss: 2839090.6250; val_gene_expr_recon_loss: 12332162.7500; val_masked_gp_l1_reg_loss: 61498.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91064.6797; val_chrom_access_recon_loss: 6439051.0000; val_global_loss: 21865440.0000; val_optim_loss: 21865440.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9085; val_auprc_score: 0.8840; val_best_acc_score: 0.8444; val_best_f1_score: 0.8543; train_kl_reg_loss: 97438.0460; train_edge_recon_loss: 2810606.6515; train_gene_expr_recon_loss: 12208820.8182; train_masked_gp_l1_reg_loss: 62323.0876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89352.2367; train_chrom_access_recon_loss: 6328535.7803; train_global_loss: 21597076.6364; train_optim_loss: 21597076.6364; val_kl_reg_loss: 90864.9541; val_edge_recon_loss: 2854294.9688; val_gene_expr_recon_loss: 12340047.5000; val_masked_gp_l1_reg_loss: 63176.9727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87858.1094; val_chrom_access_recon_loss: 6466328.2500; val_global_loss: 21902570.5000; val_optim_loss: 21902570.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9093; val_auprc_score: 0.8790; val_best_acc_score: 0.8498; val_best_f1_score: 0.8564; train_kl_reg_loss: 94791.9268; train_edge_recon_loss: 2797130.4129; train_gene_expr_recon_loss: 12157144.1818; train_masked_gp_l1_reg_loss: 63817.3348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85908.9012; train_chrom_access_recon_loss: 6308517.3409; train_global_loss: 21507310.0909; train_optim_loss: 21507310.0909; val_kl_reg_loss: 94718.4297; val_edge_recon_loss: 2819945.5938; val_gene_expr_recon_loss: 12218971.8750; val_masked_gp_l1_reg_loss: 64515.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84193.3203; val_chrom_access_recon_loss: 6409828.3125; val_global_loss: 21692173.5000; val_optim_loss: 21692173.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9061; val_auprc_score: 0.8763; val_best_acc_score: 0.8477; val_best_f1_score: 0.8574; train_kl_reg_loss: 93365.4324; train_edge_recon_loss: 2783570.7992; train_gene_expr_recon_loss: 12119186.9545; train_masked_gp_l1_reg_loss: 65140.3865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82811.3759; train_chrom_access_recon_loss: 6286440.7652; train_global_loss: 21430515.6061; train_optim_loss: 21430515.6061; val_kl_reg_loss: 95030.8018; val_edge_recon_loss: 2823578.5000; val_gene_expr_recon_loss: 12236861.3750; val_masked_gp_l1_reg_loss: 65800.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81836.8281; val_chrom_access_recon_loss: 6406325.0625; val_global_loss: 21709434.0000; val_optim_loss: 21709434.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9107; val_auprc_score: 0.8808; val_best_acc_score: 0.8530; val_best_f1_score: 0.8623; train_kl_reg_loss: 91581.7522; train_edge_recon_loss: 2780602.3902; train_gene_expr_recon_loss: 12067564.7273; train_masked_gp_l1_reg_loss: 66223.8054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80567.8726; train_chrom_access_recon_loss: 6268229.1818; train_global_loss: 21354769.8182; train_optim_loss: 21354769.8182; val_kl_reg_loss: 89006.8711; val_edge_recon_loss: 2840343.1875; val_gene_expr_recon_loss: 12109788.0000; val_masked_gp_l1_reg_loss: 66752.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79940.5938; val_chrom_access_recon_loss: 6295029.6875; val_global_loss: 21480860.2500; val_optim_loss: 21480860.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9070; val_auprc_score: 0.8740; val_best_acc_score: 0.8485; val_best_f1_score: 0.8605; train_kl_reg_loss: 87571.2364; train_edge_recon_loss: 2783566.2955; train_gene_expr_recon_loss: 12022882.3333; train_masked_gp_l1_reg_loss: 67353.9772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78780.9522; train_chrom_access_recon_loss: 6240003.0833; train_global_loss: 21280157.9091; train_optim_loss: 21280157.9091; val_kl_reg_loss: 85321.2764; val_edge_recon_loss: 2830332.8125; val_gene_expr_recon_loss: 12070176.2500; val_masked_gp_l1_reg_loss: 67893.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78265.5234; val_chrom_access_recon_loss: 6303974.5625; val_global_loss: 21435965.0000; val_optim_loss: 21435965.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9232; val_auprc_score: 0.8999; val_best_acc_score: 0.8592; val_best_f1_score: 0.8668; train_kl_reg_loss: 86900.4712; train_edge_recon_loss: 2763861.4129; train_gene_expr_recon_loss: 12002353.3485; train_masked_gp_l1_reg_loss: 68330.3250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77302.6848; train_chrom_access_recon_loss: 6228690.2121; train_global_loss: 21227438.4242; train_optim_loss: 21227438.4242; val_kl_reg_loss: 86576.7656; val_edge_recon_loss: 2797624.4375; val_gene_expr_recon_loss: 12044927.2500; val_masked_gp_l1_reg_loss: 68960.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77282.7969; val_chrom_access_recon_loss: 6337740.8125; val_global_loss: 21413112.2500; val_optim_loss: 21413112.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9237; val_auprc_score: 0.8937; val_best_acc_score: 0.8659; val_best_f1_score: 0.8741; train_kl_reg_loss: 86487.0683; train_edge_recon_loss: 2757650.0076; train_gene_expr_recon_loss: 11964092.0758; train_masked_gp_l1_reg_loss: 69293.0193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76449.2956; train_chrom_access_recon_loss: 6209716.3712; train_global_loss: 21163687.8788; train_optim_loss: 21163687.8788; val_kl_reg_loss: 87440.8936; val_edge_recon_loss: 2799452.5625; val_gene_expr_recon_loss: 12001214.5000; val_masked_gp_l1_reg_loss: 69704.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75831.9844; val_chrom_access_recon_loss: 6318998.1250; val_global_loss: 21352643.0000; val_optim_loss: 21352643.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9261; val_auprc_score: 0.9004; val_best_acc_score: 0.8718; val_best_f1_score: 0.8772; train_kl_reg_loss: 87619.9362; train_edge_recon_loss: 2742959.6667; train_gene_expr_recon_loss: 11928500.3485; train_masked_gp_l1_reg_loss: 70052.2913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75438.2441; train_chrom_access_recon_loss: 6186148.8712; train_global_loss: 21090719.5455; train_optim_loss: 21090719.5455; val_kl_reg_loss: 85074.8740; val_edge_recon_loss: 2785143.6875; val_gene_expr_recon_loss: 12040431.7500; val_masked_gp_l1_reg_loss: 70475.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75368.4609; val_chrom_access_recon_loss: 6286022.8750; val_global_loss: 21342517.5000; val_optim_loss: 21342517.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9192; val_auprc_score: 0.8901; val_best_acc_score: 0.8555; val_best_f1_score: 0.8661; train_kl_reg_loss: 86107.1293; train_edge_recon_loss: 2747850.0038; train_gene_expr_recon_loss: 11908047.8182; train_masked_gp_l1_reg_loss: 70861.5458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75297.8222; train_chrom_access_recon_loss: 6180820.3864; train_global_loss: 21068984.8485; train_optim_loss: 21068984.8485; val_kl_reg_loss: 85729.3320; val_edge_recon_loss: 2826691.0000; val_gene_expr_recon_loss: 11995884.6250; val_masked_gp_l1_reg_loss: 71247.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75210.7656; val_chrom_access_recon_loss: 6255850.9375; val_global_loss: 21310613.5000; val_optim_loss: 21310613.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9306; val_auprc_score: 0.9095; val_best_acc_score: 0.8700; val_best_f1_score: 0.8771; train_kl_reg_loss: 83780.6876; train_edge_recon_loss: 2740153.8106; train_gene_expr_recon_loss: 11872287.8333; train_masked_gp_l1_reg_loss: 71550.5977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75209.9524; train_chrom_access_recon_loss: 6163495.2348; train_global_loss: 21006478.1515; train_optim_loss: 21006478.1515; val_kl_reg_loss: 84935.8809; val_edge_recon_loss: 2768583.3438; val_gene_expr_recon_loss: 11898676.1250; val_masked_gp_l1_reg_loss: 71840.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75581.9844; val_chrom_access_recon_loss: 6255341.3125; val_global_loss: 21154959.5000; val_optim_loss: 21154959.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9329; val_auprc_score: 0.9117; val_best_acc_score: 0.8740; val_best_f1_score: 0.8806; train_kl_reg_loss: 84533.3505; train_edge_recon_loss: 2737442.5076; train_gene_expr_recon_loss: 11848913.4848; train_masked_gp_l1_reg_loss: 72198.4160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75453.1257; train_chrom_access_recon_loss: 6145687.4015; train_global_loss: 20964228.3030; train_optim_loss: 20964228.3030; val_kl_reg_loss: 83797.8369; val_edge_recon_loss: 2768297.6875; val_gene_expr_recon_loss: 11956920.6250; val_masked_gp_l1_reg_loss: 72545.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75792.1250; val_chrom_access_recon_loss: 6249979.4375; val_global_loss: 21207333.0000; val_optim_loss: 21207333.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9281; val_auprc_score: 0.9067; val_best_acc_score: 0.8718; val_best_f1_score: 0.8780; train_kl_reg_loss: 82654.0289; train_edge_recon_loss: 2731581.4053; train_gene_expr_recon_loss: 11828033.5455; train_masked_gp_l1_reg_loss: 72788.5451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76130.0537; train_chrom_access_recon_loss: 6136093.6136; train_global_loss: 20927281.1212; train_optim_loss: 20927281.1212; val_kl_reg_loss: 85405.9219; val_edge_recon_loss: 2778433.7500; val_gene_expr_recon_loss: 11939946.3750; val_masked_gp_l1_reg_loss: 73094.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76492.8750; val_chrom_access_recon_loss: 6245687.8750; val_global_loss: 21199061.5000; val_optim_loss: 21199061.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9319; val_auprc_score: 0.9046; val_best_acc_score: 0.8751; val_best_f1_score: 0.8828; train_kl_reg_loss: 81986.3847; train_edge_recon_loss: 2728515.6326; train_gene_expr_recon_loss: 11788551.0303; train_masked_gp_l1_reg_loss: 73297.8190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76564.2550; train_chrom_access_recon_loss: 6108571.3636; train_global_loss: 20857486.4545; train_optim_loss: 20857486.4545; val_kl_reg_loss: 80649.9932; val_edge_recon_loss: 2749150.3438; val_gene_expr_recon_loss: 11877671.1250; val_masked_gp_l1_reg_loss: 73492.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76829.7188; val_chrom_access_recon_loss: 6248553.2500; val_global_loss: 21106348.0000; val_optim_loss: 21106348.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9381; val_auprc_score: 0.9124; val_best_acc_score: 0.8802; val_best_f1_score: 0.8867; train_kl_reg_loss: 81671.0515; train_edge_recon_loss: 2723931.8409; train_gene_expr_recon_loss: 11768648.5303; train_masked_gp_l1_reg_loss: 73804.0799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76944.4303; train_chrom_access_recon_loss: 6105047.0530; train_global_loss: 20830046.8485; train_optim_loss: 20830046.8485; val_kl_reg_loss: 82180.3418; val_edge_recon_loss: 2731524.9062; val_gene_expr_recon_loss: 11788201.8750; val_masked_gp_l1_reg_loss: 74004.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76876.9375; val_chrom_access_recon_loss: 6203163.7500; val_global_loss: 20955951.7500; val_optim_loss: 20955951.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9365; val_auprc_score: 0.9155; val_best_acc_score: 0.8845; val_best_f1_score: 0.8883; train_kl_reg_loss: 81359.8745; train_edge_recon_loss: 2717465.1250; train_gene_expr_recon_loss: 11737391.1212; train_masked_gp_l1_reg_loss: 74210.0865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76778.8596; train_chrom_access_recon_loss: 6087237.7121; train_global_loss: 20774442.6667; train_optim_loss: 20774442.6667; val_kl_reg_loss: 82603.7012; val_edge_recon_loss: 2767150.2188; val_gene_expr_recon_loss: 11909029.2500; val_masked_gp_l1_reg_loss: 74452.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77099.1953; val_chrom_access_recon_loss: 6232911.9375; val_global_loss: 21143247.0000; val_optim_loss: 21143247.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9379; val_auprc_score: 0.9114; val_best_acc_score: 0.8855; val_best_f1_score: 0.8907; train_kl_reg_loss: 80352.0189; train_edge_recon_loss: 2715042.9621; train_gene_expr_recon_loss: 11721383.5000; train_masked_gp_l1_reg_loss: 74570.1708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77043.7752; train_chrom_access_recon_loss: 6071702.0303; train_global_loss: 20740094.3636; train_optim_loss: 20740094.3636; val_kl_reg_loss: 79666.3662; val_edge_recon_loss: 2746744.4062; val_gene_expr_recon_loss: 11766675.7500; val_masked_gp_l1_reg_loss: 74965.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77328.5156; val_chrom_access_recon_loss: 6152704.1875; val_global_loss: 20898085.7500; val_optim_loss: 20898085.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9418; val_auprc_score: 0.9159; val_best_acc_score: 0.8861; val_best_f1_score: 0.8900; train_kl_reg_loss: 80864.6712; train_edge_recon_loss: 2713840.4167; train_gene_expr_recon_loss: 11700676.9848; train_masked_gp_l1_reg_loss: 75010.2450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76936.2557; train_chrom_access_recon_loss: 6063129.9394; train_global_loss: 20710458.5152; train_optim_loss: 20710458.5152; val_kl_reg_loss: 82420.4883; val_edge_recon_loss: 2746545.4688; val_gene_expr_recon_loss: 11856941.2500; val_masked_gp_l1_reg_loss: 75217.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77088.2969; val_chrom_access_recon_loss: 6215007.8750; val_global_loss: 21053221.5000; val_optim_loss: 21053221.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9463; val_auprc_score: 0.9296; val_best_acc_score: 0.8939; val_best_f1_score: 0.8983; train_kl_reg_loss: 81350.9930; train_edge_recon_loss: 2706653.3371; train_gene_expr_recon_loss: 11672617.1970; train_masked_gp_l1_reg_loss: 75352.9798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76758.7264; train_chrom_access_recon_loss: 6044975.8182; train_global_loss: 20657709.0000; train_optim_loss: 20657709.0000; val_kl_reg_loss: 81806.3486; val_edge_recon_loss: 2709566.6875; val_gene_expr_recon_loss: 11837915.5000; val_masked_gp_l1_reg_loss: 75632.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76807.5625; val_chrom_access_recon_loss: 6141367.1250; val_global_loss: 20923096.7500; val_optim_loss: 20923096.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9365; val_auprc_score: 0.9087; val_best_acc_score: 0.8821; val_best_f1_score: 0.8883; train_kl_reg_loss: 79592.9051; train_edge_recon_loss: 2708688.7159; train_gene_expr_recon_loss: 11658903.7121; train_masked_gp_l1_reg_loss: 75725.9650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76642.2910; train_chrom_access_recon_loss: 6034763.1061; train_global_loss: 20634316.8788; train_optim_loss: 20634316.8788; val_kl_reg_loss: 80489.9199; val_edge_recon_loss: 2773215.0938; val_gene_expr_recon_loss: 11676870.2500; val_masked_gp_l1_reg_loss: 75889.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76689.8047; val_chrom_access_recon_loss: 6094860.8125; val_global_loss: 20778016.0000; val_optim_loss: 20778016.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9426; val_auprc_score: 0.9239; val_best_acc_score: 0.8885; val_best_f1_score: 0.8937; train_kl_reg_loss: 79526.3401; train_edge_recon_loss: 2712723.5000; train_gene_expr_recon_loss: 11650798.4242; train_masked_gp_l1_reg_loss: 76017.3704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76443.9162; train_chrom_access_recon_loss: 6026480.7652; train_global_loss: 20621990.2121; train_optim_loss: 20621990.2121; val_kl_reg_loss: 78518.3633; val_edge_recon_loss: 2759095.4375; val_gene_expr_recon_loss: 11781164.3750; val_masked_gp_l1_reg_loss: 76102.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76335.1328; val_chrom_access_recon_loss: 6120704.1250; val_global_loss: 20891919.2500; val_optim_loss: 20891919.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9462; val_auprc_score: 0.9248; val_best_acc_score: 0.8968; val_best_f1_score: 0.9013; train_kl_reg_loss: 79439.3899; train_edge_recon_loss: 2697942.8106; train_gene_expr_recon_loss: 11622154.3788; train_masked_gp_l1_reg_loss: 76237.7964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76166.8884; train_chrom_access_recon_loss: 6008241.1894; train_global_loss: 20560182.3636; train_optim_loss: 20560182.3636; val_kl_reg_loss: 77737.1348; val_edge_recon_loss: 2740227.8750; val_gene_expr_recon_loss: 11759147.2500; val_masked_gp_l1_reg_loss: 76422.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76348.8516; val_chrom_access_recon_loss: 6123452.9375; val_global_loss: 20853336.7500; val_optim_loss: 20853336.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9485; val_auprc_score: 0.9262; val_best_acc_score: 0.8987; val_best_f1_score: 0.9042; train_kl_reg_loss: 79629.6263; train_edge_recon_loss: 2694719.5682; train_gene_expr_recon_loss: 11610140.0303; train_masked_gp_l1_reg_loss: 76525.9736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76089.8211; train_chrom_access_recon_loss: 6000364.6515; train_global_loss: 20537469.7879; train_optim_loss: 20537469.7879; val_kl_reg_loss: 76568.2588; val_edge_recon_loss: 2719681.7500; val_gene_expr_recon_loss: 11762226.5000; val_masked_gp_l1_reg_loss: 76622.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76256.8672; val_chrom_access_recon_loss: 6129894.1250; val_global_loss: 20841250.7500; val_optim_loss: 20841250.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9545; val_auprc_score: 0.9379; val_best_acc_score: 0.9003; val_best_f1_score: 0.9022; train_kl_reg_loss: 77411.5246; train_edge_recon_loss: 2698721.9848; train_gene_expr_recon_loss: 11591338.9697; train_masked_gp_l1_reg_loss: 76753.9723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76064.2520; train_chrom_access_recon_loss: 5989072.6515; train_global_loss: 20509363.4242; train_optim_loss: 20509363.4242; val_kl_reg_loss: 78373.0713; val_edge_recon_loss: 2706822.4375; val_gene_expr_recon_loss: 11583501.2500; val_masked_gp_l1_reg_loss: 76962.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76168.9453; val_chrom_access_recon_loss: 6127680.8750; val_global_loss: 20649509.0000; val_optim_loss: 20649509.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9464; val_auprc_score: 0.9266; val_best_acc_score: 0.8936; val_best_f1_score: 0.8974; train_kl_reg_loss: 77886.1196; train_edge_recon_loss: 2693850.9091; train_gene_expr_recon_loss: 11583269.0303; train_masked_gp_l1_reg_loss: 76994.1058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76036.9212; train_chrom_access_recon_loss: 5974223.7803; train_global_loss: 20482260.8788; train_optim_loss: 20482260.8788; val_kl_reg_loss: 77172.9365; val_edge_recon_loss: 2713026.8125; val_gene_expr_recon_loss: 11750845.7500; val_masked_gp_l1_reg_loss: 77093.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75898.7422; val_chrom_access_recon_loss: 6082614.8750; val_global_loss: 20776653.2500; val_optim_loss: 20776653.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9494; val_auprc_score: 0.9296; val_best_acc_score: 0.8958; val_best_f1_score: 0.8990; train_kl_reg_loss: 77793.8698; train_edge_recon_loss: 2697117.9659; train_gene_expr_recon_loss: 11560895.4848; train_masked_gp_l1_reg_loss: 77162.2852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75693.7029; train_chrom_access_recon_loss: 5965235.8106; train_global_loss: 20453899.2121; train_optim_loss: 20453899.2121; val_kl_reg_loss: 79861.1504; val_edge_recon_loss: 2769446.4688; val_gene_expr_recon_loss: 11699626.8750; val_masked_gp_l1_reg_loss: 77190.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75538.5078; val_chrom_access_recon_loss: 6101478.2500; val_global_loss: 20803142.7500; val_optim_loss: 20803142.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9480; val_auprc_score: 0.9270; val_best_acc_score: 0.8912; val_best_f1_score: 0.8964; train_kl_reg_loss: 77548.2514; train_edge_recon_loss: 2695845.0227; train_gene_expr_recon_loss: 11552371.0303; train_masked_gp_l1_reg_loss: 77236.4097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75478.0144; train_chrom_access_recon_loss: 5951503.1212; train_global_loss: 20429981.9091; train_optim_loss: 20429981.9091; val_kl_reg_loss: 76904.4414; val_edge_recon_loss: 2739109.0625; val_gene_expr_recon_loss: 11661483.3750; val_masked_gp_l1_reg_loss: 77249.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75652.9375; val_chrom_access_recon_loss: 6078205.1250; val_global_loss: 20708605.2500; val_optim_loss: 20708605.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9550; val_auprc_score: 0.9353; val_best_acc_score: 0.9030; val_best_f1_score: 0.9081; train_kl_reg_loss: 77391.5079; train_edge_recon_loss: 2693504.6136; train_gene_expr_recon_loss: 11525661.9697; train_masked_gp_l1_reg_loss: 77219.9890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75323.1081; train_chrom_access_recon_loss: 5934850.3939; train_global_loss: 20383951.6061; train_optim_loss: 20383951.6061; val_kl_reg_loss: 75514.2207; val_edge_recon_loss: 2724466.6250; val_gene_expr_recon_loss: 11650345.7500; val_masked_gp_l1_reg_loss: 77307.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75638.2188; val_chrom_access_recon_loss: 6052793.4375; val_global_loss: 20656066.0000; val_optim_loss: 20656066.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9494; val_auprc_score: 0.9289; val_best_acc_score: 0.8974; val_best_f1_score: 0.9022; train_kl_reg_loss: 75767.6965; train_edge_recon_loss: 2699091.7121; train_gene_expr_recon_loss: 11513850.7727; train_masked_gp_l1_reg_loss: 76651.3883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63531.4941; train_chrom_access_recon_loss: 5917958.9848; train_global_loss: 20346852.1515; train_optim_loss: 20346852.1515; val_kl_reg_loss: 77333.3359; val_edge_recon_loss: 2745672.4688; val_gene_expr_recon_loss: 11637869.0000; val_masked_gp_l1_reg_loss: 76316.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60490.4297; val_chrom_access_recon_loss: 6084821.9375; val_global_loss: 20682504.0000; val_optim_loss: 20682504.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9538; val_auprc_score: 0.9355; val_best_acc_score: 0.9033; val_best_f1_score: 0.9072; train_kl_reg_loss: 77486.6294; train_edge_recon_loss: 2690861.4697; train_gene_expr_recon_loss: 11516609.0758; train_masked_gp_l1_reg_loss: 76250.9322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60028.8964; train_chrom_access_recon_loss: 5919210.8258; train_global_loss: 20340448.0303; train_optim_loss: 20340448.0303; val_kl_reg_loss: 77460.7393; val_edge_recon_loss: 2728833.4688; val_gene_expr_recon_loss: 11568067.1250; val_masked_gp_l1_reg_loss: 76208.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59686.2305; val_chrom_access_recon_loss: 6071741.6875; val_global_loss: 20581997.2500; val_optim_loss: 20581997.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9504; val_auprc_score: 0.9309; val_best_acc_score: 0.9022; val_best_f1_score: 0.9047; train_kl_reg_loss: 77888.8384; train_edge_recon_loss: 2689246.7462; train_gene_expr_recon_loss: 11504768.7576; train_masked_gp_l1_reg_loss: 76195.9537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59438.3308; train_chrom_access_recon_loss: 5913539.0985; train_global_loss: 20321077.8182; train_optim_loss: 20321077.8182; val_kl_reg_loss: 78213.5527; val_edge_recon_loss: 2743890.9688; val_gene_expr_recon_loss: 11625351.1250; val_masked_gp_l1_reg_loss: 76187.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59248.6445; val_chrom_access_recon_loss: 6077202.3125; val_global_loss: 20660095.5000; val_optim_loss: 20660095.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9507; val_auprc_score: 0.9247; val_best_acc_score: 0.9017; val_best_f1_score: 0.9043; train_kl_reg_loss: 77738.3873; train_edge_recon_loss: 2696172.7121; train_gene_expr_recon_loss: 11497327.3485; train_masked_gp_l1_reg_loss: 76184.8830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59078.7748; train_chrom_access_recon_loss: 5910786.4545; train_global_loss: 20317288.6364; train_optim_loss: 20317288.6364; val_kl_reg_loss: 78325.4961; val_edge_recon_loss: 2729843.7812; val_gene_expr_recon_loss: 11600707.6250; val_masked_gp_l1_reg_loss: 76189.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58943.7109; val_chrom_access_recon_loss: 6037210.7500; val_global_loss: 20581220.5000; val_optim_loss: 20581220.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9491; val_auprc_score: 0.9248; val_best_acc_score: 0.8960; val_best_f1_score: 0.8995; train_kl_reg_loss: 77914.6842; train_edge_recon_loss: 2684928.0152; train_gene_expr_recon_loss: 11507246.0606; train_masked_gp_l1_reg_loss: 76190.1436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58821.5535; train_chrom_access_recon_loss: 5915747.1515; train_global_loss: 20320847.5758; train_optim_loss: 20320847.5758; val_kl_reg_loss: 78758.0957; val_edge_recon_loss: 2767066.3125; val_gene_expr_recon_loss: 11743177.5000; val_masked_gp_l1_reg_loss: 76191.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58671.0586; val_chrom_access_recon_loss: 6129616.5625; val_global_loss: 20853480.2500; val_optim_loss: 20853480.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9539; val_auprc_score: 0.9331; val_best_acc_score: 0.9022; val_best_f1_score: 0.9049; train_kl_reg_loss: 77927.3305; train_edge_recon_loss: 2694850.7159; train_gene_expr_recon_loss: 11503963.5455; train_masked_gp_l1_reg_loss: 76199.5017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58592.4032; train_chrom_access_recon_loss: 5912524.7500; train_global_loss: 20324058.2121; train_optim_loss: 20324058.2121; val_kl_reg_loss: 78201.4365; val_edge_recon_loss: 2715530.9688; val_gene_expr_recon_loss: 11609649.3750; val_masked_gp_l1_reg_loss: 76194.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58412.1914; val_chrom_access_recon_loss: 6099552.5000; val_global_loss: 20637541.0000; val_optim_loss: 20637541.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9511; val_auprc_score: 0.9283; val_best_acc_score: 0.9022; val_best_f1_score: 0.9048; train_kl_reg_loss: 77591.1159; train_edge_recon_loss: 2679279.0076; train_gene_expr_recon_loss: 11507262.4697; train_masked_gp_l1_reg_loss: 76211.2009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58346.0891; train_chrom_access_recon_loss: 5915202.0303; train_global_loss: 20313891.9091; train_optim_loss: 20313891.9091; val_kl_reg_loss: 78900.6797; val_edge_recon_loss: 2711814.1250; val_gene_expr_recon_loss: 11676377.5000; val_masked_gp_l1_reg_loss: 76211.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58220.8867; val_chrom_access_recon_loss: 6054074.3125; val_global_loss: 20655599.7500; val_optim_loss: 20655599.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9563; val_auprc_score: 0.9400; val_best_acc_score: 0.9060; val_best_f1_score: 0.9091; train_kl_reg_loss: 78409.3930; train_edge_recon_loss: 2686480.8864; train_gene_expr_recon_loss: 11503950.7121; train_masked_gp_l1_reg_loss: 76219.1713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58095.6825; train_chrom_access_recon_loss: 5911187.9242; train_global_loss: 20314343.9091; train_optim_loss: 20314343.9091; val_kl_reg_loss: 78509.0049; val_edge_recon_loss: 2723417.2812; val_gene_expr_recon_loss: 11521606.2500; val_masked_gp_l1_reg_loss: 76210.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58000.9336; val_chrom_access_recon_loss: 6040712.5625; val_global_loss: 20498456.2500; val_optim_loss: 20498456.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9593; val_auprc_score: 0.9458; val_best_acc_score: 0.9111; val_best_f1_score: 0.9136; train_kl_reg_loss: 78387.8209; train_edge_recon_loss: 2683737.6439; train_gene_expr_recon_loss: 11506907.8030; train_masked_gp_l1_reg_loss: 76227.1320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57940.7597; train_chrom_access_recon_loss: 5908380.6742; train_global_loss: 20311582.1212; train_optim_loss: 20311582.1212; val_kl_reg_loss: 79561.4521; val_edge_recon_loss: 2698847.3438; val_gene_expr_recon_loss: 11581419.6250; val_masked_gp_l1_reg_loss: 76228.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57851.2578; val_chrom_access_recon_loss: 6042353.5000; val_global_loss: 20536260.7500; val_optim_loss: 20536260.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9532; val_auprc_score: 0.9340; val_best_acc_score: 0.9046; val_best_f1_score: 0.9080; train_kl_reg_loss: 78664.0128; train_edge_recon_loss: 2689700.6023; train_gene_expr_recon_loss: 11502811.5455; train_masked_gp_l1_reg_loss: 76241.0617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57715.1892; train_chrom_access_recon_loss: 5906823.5985; train_global_loss: 20311955.8182; train_optim_loss: 20311955.8182; val_kl_reg_loss: 78998.1074; val_edge_recon_loss: 2738737.0938; val_gene_expr_recon_loss: 11729365.3750; val_masked_gp_l1_reg_loss: 76240.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57624.4062; val_chrom_access_recon_loss: 6076412.5625; val_global_loss: 20757377.0000; val_optim_loss: 20757377.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9583; val_auprc_score: 0.9416; val_best_acc_score: 0.9103; val_best_f1_score: 0.9128; train_kl_reg_loss: 78066.2788; train_edge_recon_loss: 2687389.8636; train_gene_expr_recon_loss: 11497322.3182; train_masked_gp_l1_reg_loss: 76247.9786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57534.6657; train_chrom_access_recon_loss: 5905247.8258; train_global_loss: 20301808.7576; train_optim_loss: 20301808.7576; val_kl_reg_loss: 78324.6797; val_edge_recon_loss: 2703780.7812; val_gene_expr_recon_loss: 11595199.0000; val_masked_gp_l1_reg_loss: 76265.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57465.5000; val_chrom_access_recon_loss: 6049378.6875; val_global_loss: 20560413.7500; val_optim_loss: 20560413.7500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9581; val_auprc_score: 0.9416; val_best_acc_score: 0.9108; val_best_f1_score: 0.9116; train_kl_reg_loss: 78209.1354; train_edge_recon_loss: 2682740.9394; train_gene_expr_recon_loss: 11494992.9091; train_masked_gp_l1_reg_loss: 76270.5756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57387.0951; train_chrom_access_recon_loss: 5901637.3561; train_global_loss: 20291238.0909; train_optim_loss: 20291238.0909; val_kl_reg_loss: 79192.4766; val_edge_recon_loss: 2702360.8125; val_gene_expr_recon_loss: 11732967.1250; val_masked_gp_l1_reg_loss: 76279.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57302.4062; val_chrom_access_recon_loss: 6072356.0000; val_global_loss: 20720457.2500; val_optim_loss: 20720457.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9607; val_auprc_score: 0.9469; val_best_acc_score: 0.9113; val_best_f1_score: 0.9145; train_kl_reg_loss: 78297.3736; train_edge_recon_loss: 2690373.4167; train_gene_expr_recon_loss: 11494949.0303; train_masked_gp_l1_reg_loss: 76208.0606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56097.2643; train_chrom_access_recon_loss: 5904499.7879; train_global_loss: 20300424.6970; train_optim_loss: 20300424.6970; val_kl_reg_loss: 79137.7734; val_edge_recon_loss: 2680405.2500; val_gene_expr_recon_loss: 11641671.1250; val_masked_gp_l1_reg_loss: 76167.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55804.6875; val_chrom_access_recon_loss: 6130584.0625; val_global_loss: 20663771.7500; val_optim_loss: 20663771.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9621; val_auprc_score: 0.9522; val_best_acc_score: 0.9108; val_best_f1_score: 0.9136; train_kl_reg_loss: 78314.0092; train_edge_recon_loss: 2678105.2273; train_gene_expr_recon_loss: 11490142.3030; train_masked_gp_l1_reg_loss: 76155.5018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55752.3174; train_chrom_access_recon_loss: 5899868.1364; train_global_loss: 20278337.4545; train_optim_loss: 20278337.4545; val_kl_reg_loss: 79181.4229; val_edge_recon_loss: 2702264.0312; val_gene_expr_recon_loss: 11561774.5000; val_masked_gp_l1_reg_loss: 76147.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55710.0898; val_chrom_access_recon_loss: 6003726.5625; val_global_loss: 20478804.0000; val_optim_loss: 20478804.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9517; val_auprc_score: 0.9259; val_best_acc_score: 0.9060; val_best_f1_score: 0.9093; train_kl_reg_loss: 78583.4458; train_edge_recon_loss: 2676942.9811; train_gene_expr_recon_loss: 11500446.5152; train_masked_gp_l1_reg_loss: 76141.8512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55679.1601; train_chrom_access_recon_loss: 5903016.2045; train_global_loss: 20290810.0303; train_optim_loss: 20290810.0303; val_kl_reg_loss: 79410.7598; val_edge_recon_loss: 2712255.2188; val_gene_expr_recon_loss: 11600243.2500; val_masked_gp_l1_reg_loss: 76139.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55651.6172; val_chrom_access_recon_loss: 6073396.0000; val_global_loss: 20597096.5000; val_optim_loss: 20597096.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9520; val_auprc_score: 0.9362; val_best_acc_score: 0.9009; val_best_f1_score: 0.9048; train_kl_reg_loss: 78391.8804; train_edge_recon_loss: 2678830.7727; train_gene_expr_recon_loss: 11495695.7273; train_masked_gp_l1_reg_loss: 76136.5784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55631.4852; train_chrom_access_recon_loss: 5902807.2803; train_global_loss: 20287493.9697; train_optim_loss: 20287493.9697; val_kl_reg_loss: 79315.0850; val_edge_recon_loss: 2749493.5938; val_gene_expr_recon_loss: 11618492.5000; val_masked_gp_l1_reg_loss: 76134.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55610.2891; val_chrom_access_recon_loss: 6009530.6875; val_global_loss: 20588575.5000; val_optim_loss: 20588575.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9582; val_auprc_score: 0.9437; val_best_acc_score: 0.9046; val_best_f1_score: 0.9073; train_kl_reg_loss: 78370.9471; train_edge_recon_loss: 2686139.5833; train_gene_expr_recon_loss: 11490915.0758; train_masked_gp_l1_reg_loss: 76134.5182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55591.3153; train_chrom_access_recon_loss: 5896554.4091; train_global_loss: 20283705.8182; train_optim_loss: 20283705.8182; val_kl_reg_loss: 78524.6719; val_edge_recon_loss: 2740982.1562; val_gene_expr_recon_loss: 11591156.5000; val_masked_gp_l1_reg_loss: 76133.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55573.8125; val_chrom_access_recon_loss: 6056960.5000; val_global_loss: 20599330.5000; val_optim_loss: 20599330.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9530; val_auprc_score: 0.9337; val_best_acc_score: 0.9017; val_best_f1_score: 0.9033; train_kl_reg_loss: 78425.0381; train_edge_recon_loss: 2683745.7273; train_gene_expr_recon_loss: 11493714.0909; train_masked_gp_l1_reg_loss: 76133.0990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55558.7070; train_chrom_access_recon_loss: 5902264.1364; train_global_loss: 20289840.5152; train_optim_loss: 20289840.5152; val_kl_reg_loss: 78605.2344; val_edge_recon_loss: 2748609.2500; val_gene_expr_recon_loss: 11642204.7500; val_masked_gp_l1_reg_loss: 76133.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55542.8750; val_chrom_access_recon_loss: 6039089.6250; val_global_loss: 20640186.0000; val_optim_loss: 20640186.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9593; val_auprc_score: 0.9423; val_best_acc_score: 0.9100; val_best_f1_score: 0.9124; train_kl_reg_loss: 78233.8535; train_edge_recon_loss: 2688521.1364; train_gene_expr_recon_loss: 11499860.3333; train_masked_gp_l1_reg_loss: 76126.5969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55423.2731; train_chrom_access_recon_loss: 5903535.9470; train_global_loss: 20301701.0909; train_optim_loss: 20301701.0909; val_kl_reg_loss: 79717.0020; val_edge_recon_loss: 2692227.7188; val_gene_expr_recon_loss: 11666881.8750; val_masked_gp_l1_reg_loss: 76122.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55395.2852; val_chrom_access_recon_loss: 6062531.6250; val_global_loss: 20632875.2500; val_optim_loss: 20632875.2500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9535; val_auprc_score: 0.9341; val_best_acc_score: 0.9017; val_best_f1_score: 0.9053; train_kl_reg_loss: 78312.8905; train_edge_recon_loss: 2690805.1629; train_gene_expr_recon_loss: 11501682.2576; train_masked_gp_l1_reg_loss: 76120.9092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55391.1002; train_chrom_access_recon_loss: 5904669.0303; train_global_loss: 20306981.3636; train_optim_loss: 20306981.3636; val_kl_reg_loss: 78977.6367; val_edge_recon_loss: 2724767.0000; val_gene_expr_recon_loss: 11599454.7500; val_masked_gp_l1_reg_loss: 76119.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55386.9492; val_chrom_access_recon_loss: 5977192.3125; val_global_loss: 20511898.5000; val_optim_loss: 20511898.5000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9594; val_auprc_score: 0.9464; val_best_acc_score: 0.9065; val_best_f1_score: 0.9103; train_kl_reg_loss: 78287.0747; train_edge_recon_loss: 2684134.0833; train_gene_expr_recon_loss: 11493099.3788; train_masked_gp_l1_reg_loss: 76119.0121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55384.6370; train_chrom_access_recon_loss: 5900908.2803; train_global_loss: 20287932.6667; train_optim_loss: 20287932.6667; val_kl_reg_loss: 78897.2061; val_edge_recon_loss: 2713604.3438; val_gene_expr_recon_loss: 11635461.2500; val_masked_gp_l1_reg_loss: 76118.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55381.7227; val_chrom_access_recon_loss: 6049740.6250; val_global_loss: 20609204.0000; val_optim_loss: 20609204.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9562; val_auprc_score: 0.9380; val_best_acc_score: 0.9062; val_best_f1_score: 0.9093; train_kl_reg_loss: 78337.8461; train_edge_recon_loss: 2686185.0833; train_gene_expr_recon_loss: 11495864.6515; train_masked_gp_l1_reg_loss: 76118.3065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55379.3255; train_chrom_access_recon_loss: 5902446.3485; train_global_loss: 20294331.4545; train_optim_loss: 20294331.4545; val_kl_reg_loss: 79397.3682; val_edge_recon_loss: 2716212.0312; val_gene_expr_recon_loss: 11628534.7500; val_masked_gp_l1_reg_loss: 76118.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55376.9297; val_chrom_access_recon_loss: 6009919.8750; val_global_loss: 20565559.5000; val_optim_loss: 20565559.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 26 min 27 sec.
Using best model state, which was in epoch 50.

--- MODEL EVALUATION ---
val AUROC score: 0.9601
val AUPRC score: 0.9455
val best accuracy score: 0.9084
val best F1 score: 0.9114
val target rna MSE score: 1.2588
val source rna MSE score: 0.6809
val target atac MSE score: 0.3300
val source atac MSE score: 0.1321
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
