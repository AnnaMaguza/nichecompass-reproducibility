[True]
Run timestamp: 07092023_191126_87.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_87']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3433 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7954, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4521
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3433
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3433

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7632; val_auprc_score: 0.7864; val_best_acc_score: 0.5090; val_best_f1_score: 0.6703; train_kl_reg_loss: 99081.9439; train_edge_recon_loss: 3543073.5229; train_gene_expr_recon_loss: 28001134.1374; train_masked_gp_l1_reg_loss: 98083.4730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1361840.3387; train_chrom_access_recon_loss: 15642120.3130; train_global_loss: 48745334.0153; train_optim_loss: 48745334.0153; val_kl_reg_loss: 99020.8401; val_edge_recon_loss: 4064824.0000; val_gene_expr_recon_loss: 26054527.4667; val_masked_gp_l1_reg_loss: 86293.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 919694.9375; val_chrom_access_recon_loss: 15056286.5333; val_global_loss: 46280647.2000; val_optim_loss: 46280647.2000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8592; val_auprc_score: 0.8667; val_best_acc_score: 0.5675; val_best_f1_score: 0.6960; train_kl_reg_loss: 121987.5397; train_edge_recon_loss: 3535672.2309; train_gene_expr_recon_loss: 25874299.1298; train_masked_gp_l1_reg_loss: 81855.4599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 636703.1553; train_chrom_access_recon_loss: 15038619.0611; train_global_loss: 45289136.3664; train_optim_loss: 45289136.3664; val_kl_reg_loss: 110606.1896; val_edge_recon_loss: 4061085.5167; val_gene_expr_recon_loss: 25710760.8000; val_masked_gp_l1_reg_loss: 79922.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 429079.1875; val_chrom_access_recon_loss: 14997610.2000; val_global_loss: 45389064.8000; val_optim_loss: 45389064.8000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8998; val_auprc_score: 0.8956; val_best_acc_score: 0.8120; val_best_f1_score: 0.8164; train_kl_reg_loss: 102399.6530; train_edge_recon_loss: 3520801.0076; train_gene_expr_recon_loss: 25505553.3282; train_masked_gp_l1_reg_loss: 81004.5809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 323780.1796; train_chrom_access_recon_loss: 14838158.2672; train_global_loss: 44371696.9160; train_optim_loss: 44371696.9160; val_kl_reg_loss: 91818.3292; val_edge_recon_loss: 3994746.6833; val_gene_expr_recon_loss: 25438833.6000; val_masked_gp_l1_reg_loss: 83210.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 245763.6250; val_chrom_access_recon_loss: 14801696.3333; val_global_loss: 44656068.8000; val_optim_loss: 44656068.8000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8701; val_auprc_score: 0.8631; val_best_acc_score: 0.7813; val_best_f1_score: 0.8005; train_kl_reg_loss: 79010.9832; train_edge_recon_loss: 3411183.0057; train_gene_expr_recon_loss: 25191222.4275; train_masked_gp_l1_reg_loss: 86490.5054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200644.6558; train_chrom_access_recon_loss: 14653773.9542; train_global_loss: 43622325.4962; train_optim_loss: 43622325.4962; val_kl_reg_loss: 80697.2380; val_edge_recon_loss: 3123201.0333; val_gene_expr_recon_loss: 25104597.2000; val_masked_gp_l1_reg_loss: 90651.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 165103.3438; val_chrom_access_recon_loss: 14595000.6000; val_global_loss: 43159251.7333; val_optim_loss: 43159251.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8800; val_auprc_score: 0.8722; val_best_acc_score: 0.7782; val_best_f1_score: 0.8024; train_kl_reg_loss: 105091.3645; train_edge_recon_loss: 3006291.4351; train_gene_expr_recon_loss: 24967654.7481; train_masked_gp_l1_reg_loss: 92963.4476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141028.5884; train_chrom_access_recon_loss: 14524537.3817; train_global_loss: 42837566.9924; train_optim_loss: 42837566.9924; val_kl_reg_loss: 106922.9417; val_edge_recon_loss: 2992186.2333; val_gene_expr_recon_loss: 24879358.1333; val_masked_gp_l1_reg_loss: 94868.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121651.5156; val_chrom_access_recon_loss: 14452724.7333; val_global_loss: 42647712.0000; val_optim_loss: 42647712.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8982; val_auprc_score: 0.8912; val_best_acc_score: 0.8002; val_best_f1_score: 0.8154; train_kl_reg_loss: 110284.0698; train_edge_recon_loss: 2951144.3645; train_gene_expr_recon_loss: 24733806.4885; train_masked_gp_l1_reg_loss: 96658.9358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108262.1249; train_chrom_access_recon_loss: 14382225.4962; train_global_loss: 42382381.2519; train_optim_loss: 42382381.2519; val_kl_reg_loss: 110374.0891; val_edge_recon_loss: 2931146.2000; val_gene_expr_recon_loss: 24752897.8667; val_masked_gp_l1_reg_loss: 98499.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96853.1641; val_chrom_access_recon_loss: 14389027.8667; val_global_loss: 42378800.0000; val_optim_loss: 42378800.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9095; val_auprc_score: 0.9033; val_best_acc_score: 0.8186; val_best_f1_score: 0.8300; train_kl_reg_loss: 106249.9794; train_edge_recon_loss: 2910117.9427; train_gene_expr_recon_loss: 24544560.9924; train_masked_gp_l1_reg_loss: 100172.4999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89358.2381; train_chrom_access_recon_loss: 14276596.8321; train_global_loss: 42027056.4580; train_optim_loss: 42027056.4580; val_kl_reg_loss: 102893.4719; val_edge_recon_loss: 2903810.0167; val_gene_expr_recon_loss: 24474726.9333; val_masked_gp_l1_reg_loss: 101697.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82764.7422; val_chrom_access_recon_loss: 14165166.8667; val_global_loss: 41831059.2000; val_optim_loss: 41831059.2000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9157; val_auprc_score: 0.9075; val_best_acc_score: 0.8262; val_best_f1_score: 0.8391; train_kl_reg_loss: 105346.8754; train_edge_recon_loss: 2868754.4714; train_gene_expr_recon_loss: 24367580.7481; train_masked_gp_l1_reg_loss: 103339.1524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78003.4956; train_chrom_access_recon_loss: 14164880.2061; train_global_loss: 41687904.8855; train_optim_loss: 41687904.8855; val_kl_reg_loss: 105020.6115; val_edge_recon_loss: 2887616.7167; val_gene_expr_recon_loss: 24397094.4000; val_masked_gp_l1_reg_loss: 104873.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73452.9062; val_chrom_access_recon_loss: 14154853.0667; val_global_loss: 41722910.4000; val_optim_loss: 41722910.4000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9384; val_auprc_score: 0.9250; val_best_acc_score: 0.8689; val_best_f1_score: 0.8758; train_kl_reg_loss: 104440.1456; train_edge_recon_loss: 2835646.2023; train_gene_expr_recon_loss: 24209847.2977; train_masked_gp_l1_reg_loss: 106381.5369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70679.2014; train_chrom_access_recon_loss: 14071172.5267; train_global_loss: 41398166.9313; train_optim_loss: 41398166.9313; val_kl_reg_loss: 104298.0328; val_edge_recon_loss: 2817323.7333; val_gene_expr_recon_loss: 24318412.0000; val_masked_gp_l1_reg_loss: 108001.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67720.3359; val_chrom_access_recon_loss: 14142179.8667; val_global_loss: 41557936.0000; val_optim_loss: 41557936.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9464; val_auprc_score: 0.9346; val_best_acc_score: 0.8820; val_best_f1_score: 0.8868; train_kl_reg_loss: 104428.6438; train_edge_recon_loss: 2799853.4141; train_gene_expr_recon_loss: 24086048.2137; train_masked_gp_l1_reg_loss: 109254.5119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65652.7090; train_chrom_access_recon_loss: 13984296.6641; train_global_loss: 41149534.1679; train_optim_loss: 41149534.1679; val_kl_reg_loss: 103445.9500; val_edge_recon_loss: 2814391.8167; val_gene_expr_recon_loss: 24125463.8667; val_masked_gp_l1_reg_loss: 110497.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63291.9258; val_chrom_access_recon_loss: 13964417.3333; val_global_loss: 41181509.3333; val_optim_loss: 41181509.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9463; val_auprc_score: 0.9339; val_best_acc_score: 0.8849; val_best_f1_score: 0.8895; train_kl_reg_loss: 105022.5474; train_edge_recon_loss: 2778253.6603; train_gene_expr_recon_loss: 23954153.9084; train_masked_gp_l1_reg_loss: 111644.1471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61716.5056; train_chrom_access_recon_loss: 13893280.2595; train_global_loss: 40904071.0229; train_optim_loss: 40904071.0229; val_kl_reg_loss: 102785.1438; val_edge_recon_loss: 2787506.6667; val_gene_expr_recon_loss: 23957262.5333; val_masked_gp_l1_reg_loss: 112894.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60675.5742; val_chrom_access_recon_loss: 13849342.6000; val_global_loss: 40870466.6667; val_optim_loss: 40870466.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9530; val_auprc_score: 0.9411; val_best_acc_score: 0.8911; val_best_f1_score: 0.8956; train_kl_reg_loss: 103843.0375; train_edge_recon_loss: 2765047.0000; train_gene_expr_recon_loss: 23843884.0763; train_masked_gp_l1_reg_loss: 113722.1574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59109.9382; train_chrom_access_recon_loss: 13826732.0458; train_global_loss: 40712338.4122; train_optim_loss: 40712338.4122; val_kl_reg_loss: 101956.0391; val_edge_recon_loss: 2756165.4833; val_gene_expr_recon_loss: 23925646.1333; val_masked_gp_l1_reg_loss: 114856.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57928.6758; val_chrom_access_recon_loss: 13832576.0667; val_global_loss: 40789127.7333; val_optim_loss: 40789127.7333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9528; val_auprc_score: 0.9418; val_best_acc_score: 0.8909; val_best_f1_score: 0.8958; train_kl_reg_loss: 102264.9408; train_edge_recon_loss: 2756984.7595; train_gene_expr_recon_loss: 23771287.6489; train_masked_gp_l1_reg_loss: 115668.8504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57061.1554; train_chrom_access_recon_loss: 13778979.6794; train_global_loss: 40582247.0229; train_optim_loss: 40582247.0229; val_kl_reg_loss: 102376.4312; val_edge_recon_loss: 2764973.5167; val_gene_expr_recon_loss: 23802848.8000; val_masked_gp_l1_reg_loss: 116512.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56173.8516; val_chrom_access_recon_loss: 13750204.9333; val_global_loss: 40593090.1333; val_optim_loss: 40593090.1333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9573; val_auprc_score: 0.9451; val_best_acc_score: 0.8987; val_best_f1_score: 0.9031; train_kl_reg_loss: 100738.0414; train_edge_recon_loss: 2743971.6240; train_gene_expr_recon_loss: 23660557.4962; train_masked_gp_l1_reg_loss: 117365.4311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55366.6121; train_chrom_access_recon_loss: 13702840.4122; train_global_loss: 40380839.7557; train_optim_loss: 40380839.7557; val_kl_reg_loss: 99478.3964; val_edge_recon_loss: 2751538.8833; val_gene_expr_recon_loss: 23804913.3333; val_masked_gp_l1_reg_loss: 118330.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54768.8594; val_chrom_access_recon_loss: 13787706.9333; val_global_loss: 40616735.2000; val_optim_loss: 40616735.2000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9554; val_auprc_score: 0.9442; val_best_acc_score: 0.9004; val_best_f1_score: 0.9053; train_kl_reg_loss: 99669.5571; train_edge_recon_loss: 2736213.7767; train_gene_expr_recon_loss: 23574787.4809; train_masked_gp_l1_reg_loss: 119052.5991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54163.0065; train_chrom_access_recon_loss: 13647769.6031; train_global_loss: 40231655.9084; train_optim_loss: 40231655.9084; val_kl_reg_loss: 99828.9401; val_edge_recon_loss: 2749374.0833; val_gene_expr_recon_loss: 23628340.0000; val_masked_gp_l1_reg_loss: 120071.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53919.5977; val_chrom_access_recon_loss: 13700689.6667; val_global_loss: 40352224.2667; val_optim_loss: 40352224.2667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9635; val_auprc_score: 0.9552; val_best_acc_score: 0.9095; val_best_f1_score: 0.9136; train_kl_reg_loss: 97617.0627; train_edge_recon_loss: 2733574.0248; train_gene_expr_recon_loss: 23486222.9771; train_masked_gp_l1_reg_loss: 120743.5194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53310.9942; train_chrom_access_recon_loss: 13592521.7023; train_global_loss: 40083990.6870; train_optim_loss: 40083990.6870; val_kl_reg_loss: 95834.9771; val_edge_recon_loss: 2729928.1500; val_gene_expr_recon_loss: 23611981.6000; val_masked_gp_l1_reg_loss: 121565.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53050.3438; val_chrom_access_recon_loss: 13659923.7333; val_global_loss: 40272284.5333; val_optim_loss: 40272284.5333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9640; val_auprc_score: 0.9550; val_best_acc_score: 0.9078; val_best_f1_score: 0.9115; train_kl_reg_loss: 96322.3198; train_edge_recon_loss: 2731310.5802; train_gene_expr_recon_loss: 23460986.7481; train_masked_gp_l1_reg_loss: 122262.3909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52720.8740; train_chrom_access_recon_loss: 13567527.4122; train_global_loss: 40031130.3817; train_optim_loss: 40031130.3817; val_kl_reg_loss: 94875.4333; val_edge_recon_loss: 2735139.6000; val_gene_expr_recon_loss: 23404842.1333; val_masked_gp_l1_reg_loss: 123032.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52611.7812; val_chrom_access_recon_loss: 13527637.4667; val_global_loss: 39938138.6667; val_optim_loss: 39938138.6667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9674; val_auprc_score: 0.9594; val_best_acc_score: 0.9132; val_best_f1_score: 0.9164; train_kl_reg_loss: 94846.1050; train_edge_recon_loss: 2717055.6393; train_gene_expr_recon_loss: 23356334.9466; train_masked_gp_l1_reg_loss: 123649.1596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52415.9382; train_chrom_access_recon_loss: 13497120.8092; train_global_loss: 39841422.6870; train_optim_loss: 39841422.6870; val_kl_reg_loss: 98061.3646; val_edge_recon_loss: 2722891.0667; val_gene_expr_recon_loss: 23391350.5333; val_masked_gp_l1_reg_loss: 124461.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52178.3320; val_chrom_access_recon_loss: 13503034.6667; val_global_loss: 39891977.3333; val_optim_loss: 39891977.3333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9696; val_auprc_score: 0.9625; val_best_acc_score: 0.9181; val_best_f1_score: 0.9214; train_kl_reg_loss: 94726.2310; train_edge_recon_loss: 2716461.8969; train_gene_expr_recon_loss: 23317254.3359; train_masked_gp_l1_reg_loss: 125012.7023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52051.4259; train_chrom_access_recon_loss: 13472256.8931; train_global_loss: 39777763.4809; train_optim_loss: 39777763.4809; val_kl_reg_loss: 93946.2151; val_edge_recon_loss: 2709398.1333; val_gene_expr_recon_loss: 23324290.0000; val_masked_gp_l1_reg_loss: 125735.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52338.4570; val_chrom_access_recon_loss: 13480643.0000; val_global_loss: 39786352.0000; val_optim_loss: 39786352.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9704; val_auprc_score: 0.9639; val_best_acc_score: 0.9209; val_best_f1_score: 0.9235; train_kl_reg_loss: 93556.5767; train_edge_recon_loss: 2717350.9084; train_gene_expr_recon_loss: 23249246.3969; train_masked_gp_l1_reg_loss: 126459.7121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52226.4923; train_chrom_access_recon_loss: 13418030.4122; train_global_loss: 39656870.3511; train_optim_loss: 39656870.3511; val_kl_reg_loss: 95127.8870; val_edge_recon_loss: 2724019.9500; val_gene_expr_recon_loss: 23337686.6667; val_masked_gp_l1_reg_loss: 127023.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51753.2969; val_chrom_access_recon_loss: 13422979.7333; val_global_loss: 39758592.8000; val_optim_loss: 39758592.8000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9730; val_auprc_score: 0.9643; val_best_acc_score: 0.9236; val_best_f1_score: 0.9258; train_kl_reg_loss: 92614.9404; train_edge_recon_loss: 2710860.1775; train_gene_expr_recon_loss: 23184631.0229; train_masked_gp_l1_reg_loss: 127638.1560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52010.4777; train_chrom_access_recon_loss: 13377767.7328; train_global_loss: 39545522.4427; train_optim_loss: 39545522.4427; val_kl_reg_loss: 93455.4240; val_edge_recon_loss: 2723776.8833; val_gene_expr_recon_loss: 23344874.6667; val_masked_gp_l1_reg_loss: 128408.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52111.0117; val_chrom_access_recon_loss: 13431097.1333; val_global_loss: 39773724.2667; val_optim_loss: 39773724.2667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9726; val_auprc_score: 0.9667; val_best_acc_score: 0.9228; val_best_f1_score: 0.9251; train_kl_reg_loss: 92351.6427; train_edge_recon_loss: 2702079.4351; train_gene_expr_recon_loss: 23151910.8092; train_masked_gp_l1_reg_loss: 128960.7111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52293.7315; train_chrom_access_recon_loss: 13352966.9847; train_global_loss: 39480563.0840; train_optim_loss: 39480563.0840; val_kl_reg_loss: 93376.2083; val_edge_recon_loss: 2712871.3500; val_gene_expr_recon_loss: 23270299.0667; val_masked_gp_l1_reg_loss: 129620.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52538.7461; val_chrom_access_recon_loss: 13446913.2667; val_global_loss: 39705618.1333; val_optim_loss: 39705618.1333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9733; val_auprc_score: 0.9671; val_best_acc_score: 0.9267; val_best_f1_score: 0.9289; train_kl_reg_loss: 92038.0527; train_edge_recon_loss: 2698034.2023; train_gene_expr_recon_loss: 23117552.6107; train_masked_gp_l1_reg_loss: 130102.9006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52546.2373; train_chrom_access_recon_loss: 13326654.7710; train_global_loss: 39416928.7023; train_optim_loss: 39416928.7023; val_kl_reg_loss: 91557.9542; val_edge_recon_loss: 2707770.3500; val_gene_expr_recon_loss: 23199982.0000; val_masked_gp_l1_reg_loss: 130707.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52428.0898; val_chrom_access_recon_loss: 13323141.6667; val_global_loss: 39505588.5333; val_optim_loss: 39505588.5333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9759; val_auprc_score: 0.9699; val_best_acc_score: 0.9302; val_best_f1_score: 0.9323; train_kl_reg_loss: 91020.3489; train_edge_recon_loss: 2701886.6832; train_gene_expr_recon_loss: 23078550.0458; train_masked_gp_l1_reg_loss: 131308.3522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52984.6806; train_chrom_access_recon_loss: 13289301.4885; train_global_loss: 39345051.4198; train_optim_loss: 39345051.4198; val_kl_reg_loss: 92315.9943; val_edge_recon_loss: 2702075.8167; val_gene_expr_recon_loss: 23143625.7333; val_masked_gp_l1_reg_loss: 131900.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52906.4883; val_chrom_access_recon_loss: 13344308.2000; val_global_loss: 39467130.6667; val_optim_loss: 39467130.6667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9776; val_auprc_score: 0.9729; val_best_acc_score: 0.9278; val_best_f1_score: 0.9309; train_kl_reg_loss: 90504.5737; train_edge_recon_loss: 2702872.7767; train_gene_expr_recon_loss: 23024168.0611; train_masked_gp_l1_reg_loss: 132376.3596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53335.5431; train_chrom_access_recon_loss: 13260349.6947; train_global_loss: 39263607.1450; train_optim_loss: 39263607.1450; val_kl_reg_loss: 92267.4167; val_edge_recon_loss: 2697176.6500; val_gene_expr_recon_loss: 23156645.8667; val_masked_gp_l1_reg_loss: 132959.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53946.5820; val_chrom_access_recon_loss: 13323629.2667; val_global_loss: 39456625.3333; val_optim_loss: 39456625.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9761; val_auprc_score: 0.9709; val_best_acc_score: 0.9290; val_best_f1_score: 0.9309; train_kl_reg_loss: 94421.1938; train_edge_recon_loss: 2718838.4828; train_gene_expr_recon_loss: 22596233.7405; train_masked_gp_l1_reg_loss: 130027.7966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43629.0254; train_chrom_access_recon_loss: 13084599.4962; train_global_loss: 38667749.5878; train_optim_loss: 38667749.5878; val_kl_reg_loss: 67948.7719; val_edge_recon_loss: 2732246.6167; val_gene_expr_recon_loss: 22596957.4667; val_masked_gp_l1_reg_loss: 129343.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41395.5078; val_chrom_access_recon_loss: 13043944.4667; val_global_loss: 38611837.0667; val_optim_loss: 38611837.0667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9775; val_auprc_score: 0.9713; val_best_acc_score: 0.9333; val_best_f1_score: 0.9352; train_kl_reg_loss: 93549.0118; train_edge_recon_loss: 2705972.7004; train_gene_expr_recon_loss: 22540449.6489; train_masked_gp_l1_reg_loss: 129336.1013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41221.2535; train_chrom_access_recon_loss: 13045248.6107; train_global_loss: 38555777.2519; train_optim_loss: 38555777.2519; val_kl_reg_loss: 71541.2661; val_edge_recon_loss: 2716770.0500; val_gene_expr_recon_loss: 22699438.4000; val_masked_gp_l1_reg_loss: 129473.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41051.7930; val_chrom_access_recon_loss: 13047885.9333; val_global_loss: 38706161.3333; val_optim_loss: 38706161.3333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9790; val_auprc_score: 0.9755; val_best_acc_score: 0.9285; val_best_f1_score: 0.9306; train_kl_reg_loss: 90384.5037; train_edge_recon_loss: 2701796.5000; train_gene_expr_recon_loss: 22498897.5267; train_masked_gp_l1_reg_loss: 129491.5089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41047.7495; train_chrom_access_recon_loss: 13013228.3588; train_global_loss: 38474846.3206; train_optim_loss: 38474846.3206; val_kl_reg_loss: 74480.4714; val_edge_recon_loss: 2716855.9000; val_gene_expr_recon_loss: 22542879.0667; val_masked_gp_l1_reg_loss: 129469.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41087.4805; val_chrom_access_recon_loss: 13000184.0000; val_global_loss: 38504957.0667; val_optim_loss: 38504957.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9778; val_auprc_score: 0.9727; val_best_acc_score: 0.9342; val_best_f1_score: 0.9363; train_kl_reg_loss: 87165.0273; train_edge_recon_loss: 2703158.0286; train_gene_expr_recon_loss: 22465267.8168; train_masked_gp_l1_reg_loss: 129567.5417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40984.4421; train_chrom_access_recon_loss: 13007713.2443; train_global_loss: 38433856.2137; train_optim_loss: 38433856.2137; val_kl_reg_loss: 72346.3469; val_edge_recon_loss: 2721596.8333; val_gene_expr_recon_loss: 22485470.4000; val_masked_gp_l1_reg_loss: 129617.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40908.3125; val_chrom_access_recon_loss: 12986785.2000; val_global_loss: 38436725.0667; val_optim_loss: 38436725.0667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9809; val_auprc_score: 0.9763; val_best_acc_score: 0.9375; val_best_f1_score: 0.9392; train_kl_reg_loss: 85144.1582; train_edge_recon_loss: 2691123.0095; train_gene_expr_recon_loss: 22445160.8702; train_masked_gp_l1_reg_loss: 129727.5407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40901.5089; train_chrom_access_recon_loss: 12991870.7863; train_global_loss: 38383928.0000; train_optim_loss: 38383928.0000; val_kl_reg_loss: 74549.9656; val_edge_recon_loss: 2690944.5833; val_gene_expr_recon_loss: 22453176.0000; val_masked_gp_l1_reg_loss: 129851.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40879.2109; val_chrom_access_recon_loss: 13005817.6667; val_global_loss: 38395220.5333; val_optim_loss: 38395220.5333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9777; val_auprc_score: 0.9695; val_best_acc_score: 0.9342; val_best_f1_score: 0.9360; train_kl_reg_loss: 83869.4725; train_edge_recon_loss: 2693512.7500; train_gene_expr_recon_loss: 22399065.3740; train_masked_gp_l1_reg_loss: 129997.2803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40881.7784; train_chrom_access_recon_loss: 12977687.4580; train_global_loss: 38325014.1374; train_optim_loss: 38325014.1374; val_kl_reg_loss: 77558.7099; val_edge_recon_loss: 2714292.7333; val_gene_expr_recon_loss: 22584056.4000; val_masked_gp_l1_reg_loss: 130074.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40826.8867; val_chrom_access_recon_loss: 13029531.4000; val_global_loss: 38576338.9333; val_optim_loss: 38576338.9333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9803; val_auprc_score: 0.9758; val_best_acc_score: 0.9379; val_best_f1_score: 0.9401; train_kl_reg_loss: 83022.0875; train_edge_recon_loss: 2687376.4084; train_gene_expr_recon_loss: 22366161.4962; train_masked_gp_l1_reg_loss: 130207.0385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40787.6187; train_chrom_access_recon_loss: 12946553.2214; train_global_loss: 38254107.9084; train_optim_loss: 38254107.9084; val_kl_reg_loss: 77087.5927; val_edge_recon_loss: 2707424.0333; val_gene_expr_recon_loss: 22504818.6667; val_masked_gp_l1_reg_loss: 130410.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40717.0664; val_chrom_access_recon_loss: 12964383.6000; val_global_loss: 38424841.6000; val_optim_loss: 38424841.6000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9821; val_auprc_score: 0.9780; val_best_acc_score: 0.9386; val_best_f1_score: 0.9402; train_kl_reg_loss: 81469.7516; train_edge_recon_loss: 2687551.4561; train_gene_expr_recon_loss: 22349072.8244; train_masked_gp_l1_reg_loss: 130586.6432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40677.9955; train_chrom_access_recon_loss: 12935464.4962; train_global_loss: 38224823.2061; train_optim_loss: 38224823.2061; val_kl_reg_loss: 75802.2099; val_edge_recon_loss: 2718711.2333; val_gene_expr_recon_loss: 22501076.9333; val_masked_gp_l1_reg_loss: 130808.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40587.9453; val_chrom_access_recon_loss: 13000595.6000; val_global_loss: 38467582.1333; val_optim_loss: 38467582.1333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9819; val_auprc_score: 0.9759; val_best_acc_score: 0.9418; val_best_f1_score: 0.9437; train_kl_reg_loss: 80412.2760; train_edge_recon_loss: 2686636.6050; train_gene_expr_recon_loss: 22328920.7328; train_masked_gp_l1_reg_loss: 130845.6431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40555.5977; train_chrom_access_recon_loss: 12924793.6336; train_global_loss: 38192164.3664; train_optim_loss: 38192164.3664; val_kl_reg_loss: 77003.1026; val_edge_recon_loss: 2681145.7167; val_gene_expr_recon_loss: 22492245.6000; val_masked_gp_l1_reg_loss: 131057.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40519.2266; val_chrom_access_recon_loss: 12963263.6667; val_global_loss: 38385235.7333; val_optim_loss: 38385235.7333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9830; val_auprc_score: 0.9794; val_best_acc_score: 0.9395; val_best_f1_score: 0.9416; train_kl_reg_loss: 80148.0355; train_edge_recon_loss: 2682682.6927; train_gene_expr_recon_loss: 22303260.5038; train_masked_gp_l1_reg_loss: 131234.3942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40518.3726; train_chrom_access_recon_loss: 12903348.2443; train_global_loss: 38141192.2443; train_optim_loss: 38141192.2443; val_kl_reg_loss: 77757.5667; val_edge_recon_loss: 2675995.8333; val_gene_expr_recon_loss: 22493343.4667; val_masked_gp_l1_reg_loss: 131363.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40433.0234; val_chrom_access_recon_loss: 12942188.7333; val_global_loss: 38361083.4667; val_optim_loss: 38361083.4667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9788; val_auprc_score: 0.9710; val_best_acc_score: 0.9351; val_best_f1_score: 0.9374; train_kl_reg_loss: 79259.1953; train_edge_recon_loss: 2689363.8779; train_gene_expr_recon_loss: 22294903.9389; train_masked_gp_l1_reg_loss: 131527.8401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40396.4897; train_chrom_access_recon_loss: 12900643.7176; train_global_loss: 38136095.1145; train_optim_loss: 38136095.1145; val_kl_reg_loss: 76303.2943; val_edge_recon_loss: 2704466.1333; val_gene_expr_recon_loss: 22460426.0000; val_masked_gp_l1_reg_loss: 131567.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40328.5703; val_chrom_access_recon_loss: 12964552.8667; val_global_loss: 38377644.0000; val_optim_loss: 38377644.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9846; val_auprc_score: 0.9810; val_best_acc_score: 0.9442; val_best_f1_score: 0.9459; train_kl_reg_loss: 79254.8371; train_edge_recon_loss: 2679807.2557; train_gene_expr_recon_loss: 22248593.9695; train_masked_gp_l1_reg_loss: 131758.3189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40249.5961; train_chrom_access_recon_loss: 12881396.3588; train_global_loss: 38061060.5496; train_optim_loss: 38061060.5496; val_kl_reg_loss: 76487.0594; val_edge_recon_loss: 2691383.9500; val_gene_expr_recon_loss: 22347191.2000; val_masked_gp_l1_reg_loss: 132025.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40250.5078; val_chrom_access_recon_loss: 12886742.6667; val_global_loss: 38174080.5333; val_optim_loss: 38174080.5333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9840; val_auprc_score: 0.9783; val_best_acc_score: 0.9487; val_best_f1_score: 0.9499; train_kl_reg_loss: 78198.9612; train_edge_recon_loss: 2689076.9160; train_gene_expr_recon_loss: 22230924.1679; train_masked_gp_l1_reg_loss: 132183.1741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40217.9584; train_chrom_access_recon_loss: 12869662.4580; train_global_loss: 38040263.4504; train_optim_loss: 38040263.4504; val_kl_reg_loss: 73971.6672; val_edge_recon_loss: 2680801.9833; val_gene_expr_recon_loss: 22342861.6000; val_masked_gp_l1_reg_loss: 132202.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40126.9531; val_chrom_access_recon_loss: 12896824.8667; val_global_loss: 38166788.0000; val_optim_loss: 38166788.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9851; val_auprc_score: 0.9814; val_best_acc_score: 0.9444; val_best_f1_score: 0.9456; train_kl_reg_loss: 78087.1188; train_edge_recon_loss: 2688048.4179; train_gene_expr_recon_loss: 22203499.5115; train_masked_gp_l1_reg_loss: 132393.3504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40099.3275; train_chrom_access_recon_loss: 12858451.1832; train_global_loss: 38000579.0840; train_optim_loss: 38000579.0840; val_kl_reg_loss: 75445.3036; val_edge_recon_loss: 2682606.0167; val_gene_expr_recon_loss: 22375916.8000; val_masked_gp_l1_reg_loss: 132641.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39991.1484; val_chrom_access_recon_loss: 12895663.0667; val_global_loss: 38202264.2667; val_optim_loss: 38202264.2667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9840; val_auprc_score: 0.9795; val_best_acc_score: 0.9468; val_best_f1_score: 0.9479; train_kl_reg_loss: 78125.8219; train_edge_recon_loss: 2683751.0363; train_gene_expr_recon_loss: 22199989.7863; train_masked_gp_l1_reg_loss: 132779.4048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39931.1598; train_chrom_access_recon_loss: 12856284.8702; train_global_loss: 37990862.0153; train_optim_loss: 37990862.0153; val_kl_reg_loss: 75892.9448; val_edge_recon_loss: 2690276.3167; val_gene_expr_recon_loss: 22363488.0000; val_masked_gp_l1_reg_loss: 132902.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40014.8594; val_chrom_access_recon_loss: 12932476.8000; val_global_loss: 38235049.6000; val_optim_loss: 38235049.6000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9861; val_auprc_score: 0.9810; val_best_acc_score: 0.9491; val_best_f1_score: 0.9501; train_kl_reg_loss: 77678.8101; train_edge_recon_loss: 2684022.4466; train_gene_expr_recon_loss: 22182726.0458; train_masked_gp_l1_reg_loss: 133108.1778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39872.4922; train_chrom_access_recon_loss: 12852587.5573; train_global_loss: 37969995.3588; train_optim_loss: 37969995.3588; val_kl_reg_loss: 74554.9672; val_edge_recon_loss: 2692415.6167; val_gene_expr_recon_loss: 22400479.4667; val_masked_gp_l1_reg_loss: 133346.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39808.2422; val_chrom_access_recon_loss: 12881027.8667; val_global_loss: 38221632.5333; val_optim_loss: 38221632.5333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9860; val_auprc_score: 0.9815; val_best_acc_score: 0.9492; val_best_f1_score: 0.9498; train_kl_reg_loss: 77673.5818; train_edge_recon_loss: 2678902.3569; train_gene_expr_recon_loss: 22161206.4580; train_masked_gp_l1_reg_loss: 133529.2038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39785.2209; train_chrom_access_recon_loss: 12837830.6336; train_global_loss: 37928927.3893; train_optim_loss: 37928927.3893; val_kl_reg_loss: 74925.1161; val_edge_recon_loss: 2704336.4500; val_gene_expr_recon_loss: 22345538.8000; val_masked_gp_l1_reg_loss: 133637.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39706.2031; val_chrom_access_recon_loss: 12905158.7333; val_global_loss: 38203303.2000; val_optim_loss: 38203303.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9848; val_auprc_score: 0.9803; val_best_acc_score: 0.9496; val_best_f1_score: 0.9508; train_kl_reg_loss: 77505.1967; train_edge_recon_loss: 2677531.0267; train_gene_expr_recon_loss: 22117864.9313; train_masked_gp_l1_reg_loss: 132302.5010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36162.1460; train_chrom_access_recon_loss: 12809465.0076; train_global_loss: 37850830.9313; train_optim_loss: 37850830.9313; val_kl_reg_loss: 76165.9182; val_edge_recon_loss: 2665176.6667; val_gene_expr_recon_loss: 22322648.1333; val_masked_gp_l1_reg_loss: 131784.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35525.0352; val_chrom_access_recon_loss: 12858431.5333; val_global_loss: 38089731.7333; val_optim_loss: 38089731.7333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9850; val_auprc_score: 0.9818; val_best_acc_score: 0.9448; val_best_f1_score: 0.9455; train_kl_reg_loss: 78594.9893; train_edge_recon_loss: 2676127.0477; train_gene_expr_recon_loss: 22116865.6489; train_masked_gp_l1_reg_loss: 131607.5646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35311.4888; train_chrom_access_recon_loss: 12818765.2901; train_global_loss: 37857272.0305; train_optim_loss: 37857272.0305; val_kl_reg_loss: 76647.6271; val_edge_recon_loss: 2690079.4500; val_gene_expr_recon_loss: 22247800.0000; val_masked_gp_l1_reg_loss: 131482.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35093.8750; val_chrom_access_recon_loss: 12845327.2667; val_global_loss: 38026430.6667; val_optim_loss: 38026430.6667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9853; val_auprc_score: 0.9826; val_best_acc_score: 0.9465; val_best_f1_score: 0.9479; train_kl_reg_loss: 78871.4973; train_edge_recon_loss: 2675546.0706; train_gene_expr_recon_loss: 22110082.5344; train_masked_gp_l1_reg_loss: 131435.3389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34956.9904; train_chrom_access_recon_loss: 12819568.7023; train_global_loss: 37850461.2824; train_optim_loss: 37850461.2824; val_kl_reg_loss: 77310.0661; val_edge_recon_loss: 2694871.5333; val_gene_expr_recon_loss: 22189337.0667; val_masked_gp_l1_reg_loss: 131391.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34804.0273; val_chrom_access_recon_loss: 12826785.2000; val_global_loss: 37954499.7333; val_optim_loss: 37954499.7333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9871; val_auprc_score: 0.9844; val_best_acc_score: 0.9495; val_best_f1_score: 0.9509; train_kl_reg_loss: 78827.8055; train_edge_recon_loss: 2679420.7958; train_gene_expr_recon_loss: 22107414.0458; train_masked_gp_l1_reg_loss: 131379.0957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34703.4092; train_chrom_access_recon_loss: 12815033.4580; train_global_loss: 37846778.5954; train_optim_loss: 37846778.5954; val_kl_reg_loss: 77150.9906; val_edge_recon_loss: 2685780.4333; val_gene_expr_recon_loss: 22267065.6000; val_masked_gp_l1_reg_loss: 131353.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34580.6758; val_chrom_access_recon_loss: 12850487.0667; val_global_loss: 38046418.1333; val_optim_loss: 38046418.1333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9852; val_auprc_score: 0.9795; val_best_acc_score: 0.9495; val_best_f1_score: 0.9510; train_kl_reg_loss: 78809.4948; train_edge_recon_loss: 2685589.1775; train_gene_expr_recon_loss: 22112362.6870; train_masked_gp_l1_reg_loss: 131357.4587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34487.0448; train_chrom_access_recon_loss: 12812561.8397; train_global_loss: 37855167.5725; train_optim_loss: 37855167.5725; val_kl_reg_loss: 77482.6417; val_edge_recon_loss: 2695597.6667; val_gene_expr_recon_loss: 22292281.0667; val_masked_gp_l1_reg_loss: 131358.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34393.1328; val_chrom_access_recon_loss: 12866656.4000; val_global_loss: 38097769.6000; val_optim_loss: 38097769.6000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9877; val_auprc_score: 0.9842; val_best_acc_score: 0.9518; val_best_f1_score: 0.9527; train_kl_reg_loss: 78656.4948; train_edge_recon_loss: 2675396.0973; train_gene_expr_recon_loss: 22112263.1908; train_masked_gp_l1_reg_loss: 131374.6039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34338.5141; train_chrom_access_recon_loss: 12817765.4733; train_global_loss: 37849794.4122; train_optim_loss: 37849794.4122; val_kl_reg_loss: 77078.9641; val_edge_recon_loss: 2675814.2500; val_gene_expr_recon_loss: 22287026.8000; val_masked_gp_l1_reg_loss: 131375.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34235.5703; val_chrom_access_recon_loss: 12835068.6667; val_global_loss: 38040601.6000; val_optim_loss: 38040601.6000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9870; val_auprc_score: 0.9829; val_best_acc_score: 0.9504; val_best_f1_score: 0.9516; train_kl_reg_loss: 78680.3489; train_edge_recon_loss: 2675735.7844; train_gene_expr_recon_loss: 22115325.8321; train_masked_gp_l1_reg_loss: 131386.8610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34160.1071; train_chrom_access_recon_loss: 12821185.4885; train_global_loss: 37856474.5038; train_optim_loss: 37856474.5038; val_kl_reg_loss: 76926.9937; val_edge_recon_loss: 2681436.9833; val_gene_expr_recon_loss: 22303285.4667; val_masked_gp_l1_reg_loss: 131390.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34063.5742; val_chrom_access_recon_loss: 12885151.8667; val_global_loss: 38112255.2000; val_optim_loss: 38112255.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9859; val_auprc_score: 0.9826; val_best_acc_score: 0.9493; val_best_f1_score: 0.9506; train_kl_reg_loss: 78765.5687; train_edge_recon_loss: 2669797.0401; train_gene_expr_recon_loss: 22102545.9084; train_masked_gp_l1_reg_loss: 131254.6146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33707.3101; train_chrom_access_recon_loss: 12816054.3206; train_global_loss: 37832124.6107; train_optim_loss: 37832124.6107; val_kl_reg_loss: 77214.6036; val_edge_recon_loss: 2690927.8667; val_gene_expr_recon_loss: 22262892.8000; val_masked_gp_l1_reg_loss: 131185.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33650.8750; val_chrom_access_recon_loss: 12815521.6667; val_global_loss: 38011392.8000; val_optim_loss: 38011392.8000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9851; val_auprc_score: 0.9806; val_best_acc_score: 0.9470; val_best_f1_score: 0.9484; train_kl_reg_loss: 78818.1913; train_edge_recon_loss: 2679426.5878; train_gene_expr_recon_loss: 22095519.4962; train_masked_gp_l1_reg_loss: 131160.9481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33630.7554; train_chrom_access_recon_loss: 12806751.2595; train_global_loss: 37825306.9924; train_optim_loss: 37825306.9924; val_kl_reg_loss: 76923.2120; val_edge_recon_loss: 2681209.5167; val_gene_expr_recon_loss: 22256383.2000; val_masked_gp_l1_reg_loss: 131138.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33606.3125; val_chrom_access_recon_loss: 12845399.0000; val_global_loss: 38024659.2000; val_optim_loss: 38024659.2000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9851; val_auprc_score: 0.9816; val_best_acc_score: 0.9453; val_best_f1_score: 0.9472; train_kl_reg_loss: 78788.1648; train_edge_recon_loss: 2676041.4084; train_gene_expr_recon_loss: 22102302.7023; train_masked_gp_l1_reg_loss: 131128.1143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33590.5911; train_chrom_access_recon_loss: 12812815.1603; train_global_loss: 37834666.0153; train_optim_loss: 37834666.0153; val_kl_reg_loss: 77166.4021; val_edge_recon_loss: 2699499.5167; val_gene_expr_recon_loss: 22264955.2000; val_masked_gp_l1_reg_loss: 131115.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33572.4414; val_chrom_access_recon_loss: 12835324.5333; val_global_loss: 38041633.8667; val_optim_loss: 38041633.8667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9859; val_auprc_score: 0.9825; val_best_acc_score: 0.9488; val_best_f1_score: 0.9504; train_kl_reg_loss: 78920.7071; train_edge_recon_loss: 2674316.5802; train_gene_expr_recon_loss: 22100644.3511; train_masked_gp_l1_reg_loss: 131111.9438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33559.0457; train_chrom_access_recon_loss: 12819150.4351; train_global_loss: 37837703.1145; train_optim_loss: 37837703.1145; val_kl_reg_loss: 77535.8109; val_edge_recon_loss: 2678572.3833; val_gene_expr_recon_loss: 22317354.5333; val_masked_gp_l1_reg_loss: 131104.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33543.8711; val_chrom_access_recon_loss: 12889766.9333; val_global_loss: 38127877.6000; val_optim_loss: 38127877.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 75 min 23 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9853
val AUPRC score: 0.9798
val best accuracy score: 0.9495
val best F1 score: 0.9505
val target rna MSE score: 0.8391
val source rna MSE score: 0.1769
val target atac MSE score: 0.3413
val source atac MSE score: 0.0554
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
