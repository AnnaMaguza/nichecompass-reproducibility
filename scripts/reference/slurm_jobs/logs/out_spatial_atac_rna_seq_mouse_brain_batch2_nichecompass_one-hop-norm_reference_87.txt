[True]
Run timestamp: 07082023_200608_87.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_87']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8748; val_auprc_score: 0.8835; val_best_acc_score: 0.5164; val_best_f1_score: 0.6739; train_kl_reg_loss: 39349.9807; train_edge_recon_loss: 351695.5417; train_gene_expr_recon_loss: 1143411.5833; train_masked_gp_l1_reg_loss: 8740.6369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167126.3733; train_chrom_access_recon_loss: 696552.8403; train_global_loss: 2406877.0139; train_optim_loss: 2406877.0139; val_kl_reg_loss: 15234.4355; val_edge_recon_loss: 406433.6562; val_gene_expr_recon_loss: 949347.3750; val_masked_gp_l1_reg_loss: 7536.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162416.2969; val_chrom_access_recon_loss: 516466.2500; val_global_loss: 2057434.2500; val_optim_loss: 2057434.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8774; val_auprc_score: 0.8848; val_best_acc_score: 0.5128; val_best_f1_score: 0.6723; train_kl_reg_loss: 13890.4230; train_edge_recon_loss: 356760.1667; train_gene_expr_recon_loss: 884803.7639; train_masked_gp_l1_reg_loss: 7253.3345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159244.8715; train_chrom_access_recon_loss: 487375.3715; train_global_loss: 1909327.9861; train_optim_loss: 1909327.9861; val_kl_reg_loss: 17501.6211; val_edge_recon_loss: 406457.4688; val_gene_expr_recon_loss: 831388.8750; val_masked_gp_l1_reg_loss: 7126.2627; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155255.7031; val_chrom_access_recon_loss: 470513.4688; val_global_loss: 1888243.5000; val_optim_loss: 1888243.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8637; val_auprc_score: 0.8710; val_best_acc_score: 0.5259; val_best_f1_score: 0.6782; train_kl_reg_loss: 18261.1283; train_edge_recon_loss: 359547.3438; train_gene_expr_recon_loss: 805026.7083; train_masked_gp_l1_reg_loss: 7265.7520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151820.0781; train_chrom_access_recon_loss: 463344.1701; train_global_loss: 1805265.2083; train_optim_loss: 1805265.2083; val_kl_reg_loss: 19938.2461; val_edge_recon_loss: 406411.5000; val_gene_expr_recon_loss: 779241.1875; val_masked_gp_l1_reg_loss: 7402.0996; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147268.1875; val_chrom_access_recon_loss: 459248.9688; val_global_loss: 1819510.2500; val_optim_loss: 1819510.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8545; val_auprc_score: 0.8602; val_best_acc_score: 0.5443; val_best_f1_score: 0.6862; train_kl_reg_loss: 20328.2177; train_edge_recon_loss: 359498.4132; train_gene_expr_recon_loss: 762162.5000; train_masked_gp_l1_reg_loss: 7397.4298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143245.5833; train_chrom_access_recon_loss: 453338.7049; train_global_loss: 1745970.8333; train_optim_loss: 1745970.8333; val_kl_reg_loss: 20962.4316; val_edge_recon_loss: 406246.1250; val_gene_expr_recon_loss: 747375.1250; val_masked_gp_l1_reg_loss: 7362.1558; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138042.3281; val_chrom_access_recon_loss: 452885.2188; val_global_loss: 1772873.5000; val_optim_loss: 1772873.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8400; val_auprc_score: 0.8432; val_best_acc_score: 0.5830; val_best_f1_score: 0.7026; train_kl_reg_loss: 20494.5699; train_edge_recon_loss: 358950.1562; train_gene_expr_recon_loss: 738911.4306; train_masked_gp_l1_reg_loss: 7322.9896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133688.7778; train_chrom_access_recon_loss: 451379.0903; train_global_loss: 1710747.0417; train_optim_loss: 1710747.0417; val_kl_reg_loss: 19530.1758; val_edge_recon_loss: 405750.4062; val_gene_expr_recon_loss: 726736.2500; val_masked_gp_l1_reg_loss: 7262.1772; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128195.8750; val_chrom_access_recon_loss: 448712.6562; val_global_loss: 1736187.5000; val_optim_loss: 1736187.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8366; val_auprc_score: 0.8361; val_best_acc_score: 0.6248; val_best_f1_score: 0.7202; train_kl_reg_loss: 19780.2174; train_edge_recon_loss: 358206.9757; train_gene_expr_recon_loss: 722843.6875; train_masked_gp_l1_reg_loss: 7221.4298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123794.6215; train_chrom_access_recon_loss: 448573.9653; train_global_loss: 1680420.8750; train_optim_loss: 1680420.8750; val_kl_reg_loss: 18760.9492; val_edge_recon_loss: 405040.1562; val_gene_expr_recon_loss: 710335.5625; val_masked_gp_l1_reg_loss: 7164.8774; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118319.6406; val_chrom_access_recon_loss: 446018.9062; val_global_loss: 1705640.0000; val_optim_loss: 1705640.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8445; val_auprc_score: 0.8380; val_best_acc_score: 0.6913; val_best_f1_score: 0.7530; train_kl_reg_loss: 19632.1582; train_edge_recon_loss: 357728.9688; train_gene_expr_recon_loss: 709949.9236; train_masked_gp_l1_reg_loss: 7134.6730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114039.7465; train_chrom_access_recon_loss: 447665.5104; train_global_loss: 1656150.9583; train_optim_loss: 1656150.9583; val_kl_reg_loss: 19532.8125; val_edge_recon_loss: 403410.3750; val_gene_expr_recon_loss: 697591.5000; val_masked_gp_l1_reg_loss: 7088.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108762.9609; val_chrom_access_recon_loss: 444101.6250; val_global_loss: 1680488.2500; val_optim_loss: 1680488.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8312; val_auprc_score: 0.8267; val_best_acc_score: 0.7133; val_best_f1_score: 0.7608; train_kl_reg_loss: 19998.0948; train_edge_recon_loss: 357047.2465; train_gene_expr_recon_loss: 698594.1875; train_masked_gp_l1_reg_loss: 7066.3978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104700.9280; train_chrom_access_recon_loss: 443112.1979; train_global_loss: 1630519.1111; train_optim_loss: 1630519.1111; val_kl_reg_loss: 19891.4473; val_edge_recon_loss: 402458.4062; val_gene_expr_recon_loss: 688403.5000; val_masked_gp_l1_reg_loss: 7029.7515; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99731.0625; val_chrom_access_recon_loss: 442409.6562; val_global_loss: 1659923.8750; val_optim_loss: 1659923.8750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8318; val_auprc_score: 0.8285; val_best_acc_score: 0.7427; val_best_f1_score: 0.7678; train_kl_reg_loss: 20274.2585; train_edge_recon_loss: 356646.7083; train_gene_expr_recon_loss: 688957.3472; train_masked_gp_l1_reg_loss: 7017.1366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95957.6736; train_chrom_access_recon_loss: 442626.6319; train_global_loss: 1611479.7361; train_optim_loss: 1611479.7361; val_kl_reg_loss: 18438.7285; val_edge_recon_loss: 400323.9688; val_gene_expr_recon_loss: 682690.5000; val_masked_gp_l1_reg_loss: 6989.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91359.2656; val_chrom_access_recon_loss: 441008.1875; val_global_loss: 1640810.5000; val_optim_loss: 1640810.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8318; val_auprc_score: 0.8319; val_best_acc_score: 0.7506; val_best_f1_score: 0.7508; train_kl_reg_loss: 20143.6018; train_edge_recon_loss: 355831.4514; train_gene_expr_recon_loss: 683212.2847; train_masked_gp_l1_reg_loss: 6982.2342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87905.0911; train_chrom_access_recon_loss: 439723.8333; train_global_loss: 1593798.5278; train_optim_loss: 1593798.5278; val_kl_reg_loss: 18922.4219; val_edge_recon_loss: 397802.5000; val_gene_expr_recon_loss: 677379.9375; val_masked_gp_l1_reg_loss: 6963.1543; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83712.2500; val_chrom_access_recon_loss: 439790.7812; val_global_loss: 1624571.0000; val_optim_loss: 1624571.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8377; val_auprc_score: 0.8352; val_best_acc_score: 0.7502; val_best_f1_score: 0.7501; train_kl_reg_loss: 20051.0723; train_edge_recon_loss: 355036.6389; train_gene_expr_recon_loss: 677892.9722; train_masked_gp_l1_reg_loss: 6965.6689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80598.6016; train_chrom_access_recon_loss: 440568.2153; train_global_loss: 1581113.1528; train_optim_loss: 1581113.1528; val_kl_reg_loss: 19277.8711; val_edge_recon_loss: 394510.8125; val_gene_expr_recon_loss: 673291.0000; val_masked_gp_l1_reg_loss: 6953.5249; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76844.3281; val_chrom_access_recon_loss: 438674.1562; val_global_loss: 1609551.7500; val_optim_loss: 1609551.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8413; val_auprc_score: 0.8328; val_best_acc_score: 0.7332; val_best_f1_score: 0.7675; train_kl_reg_loss: 20062.2862; train_edge_recon_loss: 353686.4931; train_gene_expr_recon_loss: 676773.2500; train_masked_gp_l1_reg_loss: 6959.6444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74088.4106; train_chrom_access_recon_loss: 439617.9688; train_global_loss: 1571188.0278; train_optim_loss: 1571188.0278; val_kl_reg_loss: 19345.5605; val_edge_recon_loss: 390875.5625; val_gene_expr_recon_loss: 669548.9375; val_masked_gp_l1_reg_loss: 6953.6221; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70760.7344; val_chrom_access_recon_loss: 437749.4688; val_global_loss: 1595233.8750; val_optim_loss: 1595233.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8578; val_auprc_score: 0.8512; val_best_acc_score: 0.7676; val_best_f1_score: 0.7847; train_kl_reg_loss: 19743.6808; train_edge_recon_loss: 352194.9722; train_gene_expr_recon_loss: 671737.3125; train_masked_gp_l1_reg_loss: 6961.8712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68309.7934; train_chrom_access_recon_loss: 439293.9757; train_global_loss: 1558241.6111; train_optim_loss: 1558241.6111; val_kl_reg_loss: 19163.8633; val_edge_recon_loss: 383147.4688; val_gene_expr_recon_loss: 667066.3750; val_masked_gp_l1_reg_loss: 6960.6895; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65349.4141; val_chrom_access_recon_loss: 436817.6875; val_global_loss: 1578505.5000; val_optim_loss: 1578505.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8732; val_auprc_score: 0.8631; val_best_acc_score: 0.7860; val_best_f1_score: 0.8013; train_kl_reg_loss: 19305.3961; train_edge_recon_loss: 348349.9271; train_gene_expr_recon_loss: 667500.6736; train_masked_gp_l1_reg_loss: 6976.0811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63151.5951; train_chrom_access_recon_loss: 436515.9097; train_global_loss: 1541799.5833; train_optim_loss: 1541799.5833; val_kl_reg_loss: 18253.2539; val_edge_recon_loss: 366471.0000; val_gene_expr_recon_loss: 666239.1250; val_masked_gp_l1_reg_loss: 6979.6587; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60496.2969; val_chrom_access_recon_loss: 436140.6250; val_global_loss: 1554579.8750; val_optim_loss: 1554579.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8816; val_auprc_score: 0.8724; val_best_acc_score: 0.7944; val_best_f1_score: 0.8071; train_kl_reg_loss: 19542.9688; train_edge_recon_loss: 337896.8507; train_gene_expr_recon_loss: 669241.1042; train_masked_gp_l1_reg_loss: 7000.0336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58541.3333; train_chrom_access_recon_loss: 437169.6042; train_global_loss: 1529391.9306; train_optim_loss: 1529391.9306; val_kl_reg_loss: 21285.2012; val_edge_recon_loss: 339123.3750; val_gene_expr_recon_loss: 665089.7500; val_masked_gp_l1_reg_loss: 7023.1025; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56169.4492; val_chrom_access_recon_loss: 435777.0625; val_global_loss: 1524468.0000; val_optim_loss: 1524468.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8877; val_auprc_score: 0.8741; val_best_acc_score: 0.7961; val_best_f1_score: 0.8145; train_kl_reg_loss: 25205.1174; train_edge_recon_loss: 322298.6736; train_gene_expr_recon_loss: 664342.2708; train_masked_gp_l1_reg_loss: 7058.3554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54409.4657; train_chrom_access_recon_loss: 435819.5104; train_global_loss: 1509133.3889; train_optim_loss: 1509133.3889; val_kl_reg_loss: 29776.4922; val_edge_recon_loss: 317320.7188; val_gene_expr_recon_loss: 663095.3750; val_masked_gp_l1_reg_loss: 7093.6436; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52278.7422; val_chrom_access_recon_loss: 434885.7500; val_global_loss: 1504450.7500; val_optim_loss: 1504450.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8970; val_auprc_score: 0.8833; val_best_acc_score: 0.8034; val_best_f1_score: 0.8207; train_kl_reg_loss: 29438.3806; train_edge_recon_loss: 313021.7396; train_gene_expr_recon_loss: 663306.8889; train_masked_gp_l1_reg_loss: 7126.6363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50702.1970; train_chrom_access_recon_loss: 434961.9757; train_global_loss: 1498557.8056; train_optim_loss: 1498557.8056; val_kl_reg_loss: 27948.5625; val_edge_recon_loss: 313249.9062; val_gene_expr_recon_loss: 661412.8125; val_masked_gp_l1_reg_loss: 7158.8335; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48789.0703; val_chrom_access_recon_loss: 434188.6875; val_global_loss: 1492747.7500; val_optim_loss: 1492747.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9045; val_auprc_score: 0.8892; val_best_acc_score: 0.8181; val_best_f1_score: 0.8260; train_kl_reg_loss: 28443.7600; train_edge_recon_loss: 310109.9236; train_gene_expr_recon_loss: 663642.3542; train_masked_gp_l1_reg_loss: 7191.1538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47366.0399; train_chrom_access_recon_loss: 435582.1250; train_global_loss: 1492335.3889; train_optim_loss: 1492335.3889; val_kl_reg_loss: 27350.0898; val_edge_recon_loss: 309085.5625; val_gene_expr_recon_loss: 660042.6875; val_masked_gp_l1_reg_loss: 7221.8027; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45640.9727; val_chrom_access_recon_loss: 433358.6562; val_global_loss: 1482699.7500; val_optim_loss: 1482699.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9130; val_auprc_score: 0.8998; val_best_acc_score: 0.8298; val_best_f1_score: 0.8375; train_kl_reg_loss: 27261.6107; train_edge_recon_loss: 307545.8021; train_gene_expr_recon_loss: 659676.5972; train_masked_gp_l1_reg_loss: 7250.5075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44363.5273; train_chrom_access_recon_loss: 434561.7500; train_global_loss: 1480659.7778; train_optim_loss: 1480659.7778; val_kl_reg_loss: 26133.5273; val_edge_recon_loss: 309092.3750; val_gene_expr_recon_loss: 658496.3750; val_masked_gp_l1_reg_loss: 7283.9785; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42800.0859; val_chrom_access_recon_loss: 432560.8750; val_global_loss: 1476367.2500; val_optim_loss: 1476367.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9164; val_auprc_score: 0.9021; val_best_acc_score: 0.8390; val_best_f1_score: 0.8461; train_kl_reg_loss: 26911.9149; train_edge_recon_loss: 304634.8438; train_gene_expr_recon_loss: 658527.2917; train_masked_gp_l1_reg_loss: 7312.3154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41632.2201; train_chrom_access_recon_loss: 432557.8646; train_global_loss: 1471576.4306; train_optim_loss: 1471576.4306; val_kl_reg_loss: 26457.3418; val_edge_recon_loss: 306507.8125; val_gene_expr_recon_loss: 657102.7500; val_masked_gp_l1_reg_loss: 7341.8252; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40209.4062; val_chrom_access_recon_loss: 431722.7188; val_global_loss: 1469341.8750; val_optim_loss: 1469341.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9346; val_auprc_score: 0.9176; val_best_acc_score: 0.8651; val_best_f1_score: 0.8712; train_kl_reg_loss: 26853.4629; train_edge_recon_loss: 302698.1840; train_gene_expr_recon_loss: 655160.0694; train_masked_gp_l1_reg_loss: 7368.3866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39152.6589; train_chrom_access_recon_loss: 431683.2396; train_global_loss: 1462916.0139; train_optim_loss: 1462916.0139; val_kl_reg_loss: 26094.7461; val_edge_recon_loss: 301173.8125; val_gene_expr_recon_loss: 654407.8750; val_masked_gp_l1_reg_loss: 7382.0127; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37854.1250; val_chrom_access_recon_loss: 430989.0000; val_global_loss: 1457901.5000; val_optim_loss: 1457901.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9392; val_auprc_score: 0.9235; val_best_acc_score: 0.8725; val_best_f1_score: 0.8776; train_kl_reg_loss: 26140.9622; train_edge_recon_loss: 300485.4028; train_gene_expr_recon_loss: 653442.9444; train_masked_gp_l1_reg_loss: 7402.6647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36883.9570; train_chrom_access_recon_loss: 429926.9132; train_global_loss: 1454282.8194; train_optim_loss: 1454282.8194; val_kl_reg_loss: 27161.6172; val_edge_recon_loss: 298946.3125; val_gene_expr_recon_loss: 654360.6250; val_masked_gp_l1_reg_loss: 7416.1763; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35690.1758; val_chrom_access_recon_loss: 430398.3750; val_global_loss: 1453973.2500; val_optim_loss: 1453973.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9475; val_auprc_score: 0.9316; val_best_acc_score: 0.8863; val_best_f1_score: 0.8887; train_kl_reg_loss: 26697.8887; train_edge_recon_loss: 298782.8576; train_gene_expr_recon_loss: 651962.6181; train_masked_gp_l1_reg_loss: 7433.4299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34805.0122; train_chrom_access_recon_loss: 430365.9757; train_global_loss: 1450047.7778; train_optim_loss: 1450047.7778; val_kl_reg_loss: 26272.9883; val_edge_recon_loss: 297145.7500; val_gene_expr_recon_loss: 651799.4375; val_masked_gp_l1_reg_loss: 7449.6387; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33714.7969; val_chrom_access_recon_loss: 429738.6250; val_global_loss: 1446121.2500; val_optim_loss: 1446121.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9513; val_auprc_score: 0.9356; val_best_acc_score: 0.8946; val_best_f1_score: 0.8980; train_kl_reg_loss: 27153.2142; train_edge_recon_loss: 295251.2049; train_gene_expr_recon_loss: 655267.4444; train_masked_gp_l1_reg_loss: 7464.2661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32895.3173; train_chrom_access_recon_loss: 430887.1181; train_global_loss: 1448918.5556; train_optim_loss: 1448918.5556; val_kl_reg_loss: 26584.7227; val_edge_recon_loss: 294352.2188; val_gene_expr_recon_loss: 651237.8750; val_masked_gp_l1_reg_loss: 7482.3706; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31888.9629; val_chrom_access_recon_loss: 429226.0625; val_global_loss: 1440772.2500; val_optim_loss: 1440772.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9520; val_auprc_score: 0.9366; val_best_acc_score: 0.8891; val_best_f1_score: 0.8945; train_kl_reg_loss: 27153.7663; train_edge_recon_loss: 295038.8542; train_gene_expr_recon_loss: 654113.2847; train_masked_gp_l1_reg_loss: 7505.0347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31142.4084; train_chrom_access_recon_loss: 429400.1007; train_global_loss: 1444353.4583; train_optim_loss: 1444353.4583; val_kl_reg_loss: 26649.4590; val_edge_recon_loss: 294551.2500; val_gene_expr_recon_loss: 650226.0625; val_masked_gp_l1_reg_loss: 7523.1743; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30223.5156; val_chrom_access_recon_loss: 428469.4375; val_global_loss: 1437642.8750; val_optim_loss: 1437642.8750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9510; val_auprc_score: 0.9376; val_best_acc_score: 0.8897; val_best_f1_score: 0.8939; train_kl_reg_loss: 25095.1426; train_edge_recon_loss: 296155.7569; train_gene_expr_recon_loss: 913717.9653; train_masked_gp_l1_reg_loss: 7634.0687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29372.7691; train_chrom_access_recon_loss: 453457.3160; train_global_loss: 1725432.9861; train_optim_loss: 1725432.9861; val_kl_reg_loss: 16690.6250; val_edge_recon_loss: 292723.3750; val_gene_expr_recon_loss: 909179.1875; val_masked_gp_l1_reg_loss: 7818.6748; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28212.3926; val_chrom_access_recon_loss: 452549.5000; val_global_loss: 1707173.7500; val_optim_loss: 1707173.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9478; val_auprc_score: 0.9295; val_best_acc_score: 0.8876; val_best_f1_score: 0.8913; train_kl_reg_loss: 23300.8056; train_edge_recon_loss: 292835.5868; train_gene_expr_recon_loss: 909366.8472; train_masked_gp_l1_reg_loss: 7986.4182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27250.1547; train_chrom_access_recon_loss: 453411.7569; train_global_loss: 1714151.5278; train_optim_loss: 1714151.5278; val_kl_reg_loss: 18175.5977; val_edge_recon_loss: 294149.5625; val_gene_expr_recon_loss: 901314.2500; val_masked_gp_l1_reg_loss: 8185.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26065.3730; val_chrom_access_recon_loss: 451264.9375; val_global_loss: 1699155.0000; val_optim_loss: 1699155.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9528; val_auprc_score: 0.9405; val_best_acc_score: 0.8928; val_best_f1_score: 0.8960; train_kl_reg_loss: 22658.7309; train_edge_recon_loss: 290363.2361; train_gene_expr_recon_loss: 899095.1736; train_masked_gp_l1_reg_loss: 8335.3330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25170.7724; train_chrom_access_recon_loss: 453582.6111; train_global_loss: 1699205.8472; train_optim_loss: 1699205.8472; val_kl_reg_loss: 19353.2676; val_edge_recon_loss: 291340.7500; val_gene_expr_recon_loss: 896109.8750; val_masked_gp_l1_reg_loss: 8509.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24088.0645; val_chrom_access_recon_loss: 450566.3125; val_global_loss: 1689967.7500; val_optim_loss: 1689967.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9548; val_auprc_score: 0.9432; val_best_acc_score: 0.8933; val_best_f1_score: 0.8970; train_kl_reg_loss: 22319.9058; train_edge_recon_loss: 288850.6736; train_gene_expr_recon_loss: 895884.7569; train_masked_gp_l1_reg_loss: 8630.8523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23284.5163; train_chrom_access_recon_loss: 452009.0903; train_global_loss: 1690979.8194; train_optim_loss: 1690979.8194; val_kl_reg_loss: 19727.5938; val_edge_recon_loss: 289317.5312; val_gene_expr_recon_loss: 892885.7500; val_masked_gp_l1_reg_loss: 8768.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22317.1914; val_chrom_access_recon_loss: 449959.6250; val_global_loss: 1682975.8750; val_optim_loss: 1682975.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9551; val_auprc_score: 0.9428; val_best_acc_score: 0.8933; val_best_f1_score: 0.8973; train_kl_reg_loss: 22045.2305; train_edge_recon_loss: 288031.9549; train_gene_expr_recon_loss: 896645.6111; train_masked_gp_l1_reg_loss: 8749.8847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22149.2135; train_chrom_access_recon_loss: 450104.1215; train_global_loss: 1687726.0417; train_optim_loss: 1687726.0417; val_kl_reg_loss: 19799.9883; val_edge_recon_loss: 288996.2812; val_gene_expr_recon_loss: 892233.6875; val_masked_gp_l1_reg_loss: 8733.3145; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21967.6406; val_chrom_access_recon_loss: 449871.6875; val_global_loss: 1681602.7500; val_optim_loss: 1681602.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9534; val_auprc_score: 0.9363; val_best_acc_score: 0.8973; val_best_f1_score: 0.9008; train_kl_reg_loss: 22089.8600; train_edge_recon_loss: 287737.3021; train_gene_expr_recon_loss: 895915.9097; train_masked_gp_l1_reg_loss: 8733.1768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21864.9731; train_chrom_access_recon_loss: 450838.2569; train_global_loss: 1687179.5000; train_optim_loss: 1687179.5000; val_kl_reg_loss: 19892.7207; val_edge_recon_loss: 288519.5938; val_gene_expr_recon_loss: 891765.6250; val_masked_gp_l1_reg_loss: 8730.9980; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21730.6211; val_chrom_access_recon_loss: 449736.0312; val_global_loss: 1680375.6250; val_optim_loss: 1680375.6250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9564; val_auprc_score: 0.9429; val_best_acc_score: 0.8981; val_best_f1_score: 0.9011; train_kl_reg_loss: 21991.7420; train_edge_recon_loss: 288039.2361; train_gene_expr_recon_loss: 892451.0417; train_masked_gp_l1_reg_loss: 8732.4929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21634.6842; train_chrom_access_recon_loss: 448822.3438; train_global_loss: 1681671.5278; train_optim_loss: 1681671.5278; val_kl_reg_loss: 19880.0566; val_edge_recon_loss: 287629.0938; val_gene_expr_recon_loss: 891632.1250; val_masked_gp_l1_reg_loss: 8734.9004; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21517.7695; val_chrom_access_recon_loss: 449775.2500; val_global_loss: 1679169.1250; val_optim_loss: 1679169.1250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9572; val_auprc_score: 0.9445; val_best_acc_score: 0.8957; val_best_f1_score: 0.8979; train_kl_reg_loss: 22021.6584; train_edge_recon_loss: 288304.0451; train_gene_expr_recon_loss: 892886.5208; train_masked_gp_l1_reg_loss: 8738.3472; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21429.8168; train_chrom_access_recon_loss: 449777.6840; train_global_loss: 1683158.0972; train_optim_loss: 1683158.0972; val_kl_reg_loss: 19955.7773; val_edge_recon_loss: 287616.1250; val_gene_expr_recon_loss: 891187.3125; val_masked_gp_l1_reg_loss: 8743.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21324.9414; val_chrom_access_recon_loss: 449695.5625; val_global_loss: 1678523.0000; val_optim_loss: 1678523.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 43 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9494
val AUPRC score: 0.9356
val best accuracy score: 0.8884
val best F1 score: 0.8932
val target rna MSE score: 3.7858
val source rna MSE score: 3.1368
val target atac MSE score: 0.1327
val source atac MSE score: 0.0204
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
