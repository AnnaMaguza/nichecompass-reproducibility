[True]
Run timestamp: 07082023_214524_140.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_140']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8863; val_auprc_score: 0.8995; val_best_acc_score: 0.5666; val_best_f1_score: 0.6958; train_kl_reg_loss: 31006.7552; train_edge_recon_loss: 3473294.1944; train_gene_expr_recon_loss: 1218921.6250; train_masked_gp_l1_reg_loss: 8474.8896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119408.5408; train_chrom_access_recon_loss: 720239.1458; train_global_loss: 5571345.1667; train_optim_loss: 5571345.1667; val_kl_reg_loss: 9648.8711; val_edge_recon_loss: 4060628.0000; val_gene_expr_recon_loss: 1068361.8750; val_masked_gp_l1_reg_loss: 6817.5532; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117132.0469; val_chrom_access_recon_loss: 511649.7500; val_global_loss: 5774238.0000; val_optim_loss: 5774238.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8888; val_auprc_score: 0.8974; val_best_acc_score: 0.5683; val_best_f1_score: 0.6964; train_kl_reg_loss: 9078.2157; train_edge_recon_loss: 3473320.2222; train_gene_expr_recon_loss: 1007246.7639; train_masked_gp_l1_reg_loss: 6225.0201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115760.6528; train_chrom_access_recon_loss: 500006.7153; train_global_loss: 5111637.7778; train_optim_loss: 5111637.7778; val_kl_reg_loss: 6294.2891; val_edge_recon_loss: 4060274.7500; val_gene_expr_recon_loss: 941123.2500; val_masked_gp_l1_reg_loss: 5725.3096; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114077.7812; val_chrom_access_recon_loss: 489169.9375; val_global_loss: 5616665.5000; val_optim_loss: 5616665.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8810; val_auprc_score: 0.8893; val_best_acc_score: 0.5755; val_best_f1_score: 0.6999; train_kl_reg_loss: 10230.4112; train_edge_recon_loss: 3476033.3889; train_gene_expr_recon_loss: 904739.4167; train_masked_gp_l1_reg_loss: 5664.9688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112688.6849; train_chrom_access_recon_loss: 480338.6493; train_global_loss: 4989695.3889; train_optim_loss: 4989695.3889; val_kl_reg_loss: 14854.3516; val_edge_recon_loss: 4059831.5000; val_gene_expr_recon_loss: 857464.6250; val_masked_gp_l1_reg_loss: 5660.0947; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110878.2109; val_chrom_access_recon_loss: 477880.6250; val_global_loss: 5526569.0000; val_optim_loss: 5526569.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8770; val_auprc_score: 0.8805; val_best_acc_score: 0.6002; val_best_f1_score: 0.7104; train_kl_reg_loss: 15315.8553; train_edge_recon_loss: 3478742.8611; train_gene_expr_recon_loss: 827374.4514; train_masked_gp_l1_reg_loss: 5639.3045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109253.2283; train_chrom_access_recon_loss: 465924.5764; train_global_loss: 4902250.3889; train_optim_loss: 4902250.3889; val_kl_reg_loss: 15031.5713; val_edge_recon_loss: 4056041.0000; val_gene_expr_recon_loss: 808070.2500; val_masked_gp_l1_reg_loss: 5602.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107093.8438; val_chrom_access_recon_loss: 464236.7188; val_global_loss: 5456076.5000; val_optim_loss: 5456076.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8752; val_auprc_score: 0.8765; val_best_acc_score: 0.6339; val_best_f1_score: 0.7256; train_kl_reg_loss: 16513.1394; train_edge_recon_loss: 3477628.9722; train_gene_expr_recon_loss: 790188.1806; train_masked_gp_l1_reg_loss: 5595.7871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105190.7873; train_chrom_access_recon_loss: 456942.0556; train_global_loss: 4852058.7222; train_optim_loss: 4852058.7222; val_kl_reg_loss: 14710.6992; val_edge_recon_loss: 4050203.7500; val_gene_expr_recon_loss: 774944.7500; val_masked_gp_l1_reg_loss: 5604.5708; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102721.0078; val_chrom_access_recon_loss: 457786.7812; val_global_loss: 5405971.5000; val_optim_loss: 5405971.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8647; val_auprc_score: 0.8657; val_best_acc_score: 0.7040; val_best_f1_score: 0.7605; train_kl_reg_loss: 17648.1545; train_edge_recon_loss: 3477307.6667; train_gene_expr_recon_loss: 763999.3681; train_masked_gp_l1_reg_loss: 5637.1493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100643.1467; train_chrom_access_recon_loss: 452167.1632; train_global_loss: 4817402.6667; train_optim_loss: 4817402.6667; val_kl_reg_loss: 15789.4824; val_edge_recon_loss: 4034574.7500; val_gene_expr_recon_loss: 752681.0625; val_masked_gp_l1_reg_loss: 5675.9307; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97999.4141; val_chrom_access_recon_loss: 454423.3750; val_global_loss: 5361144.5000; val_optim_loss: 5361144.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8502; val_auprc_score: 0.8465; val_best_acc_score: 0.7710; val_best_f1_score: 0.7833; train_kl_reg_loss: 16979.3745; train_edge_recon_loss: 3474272.3333; train_gene_expr_recon_loss: 745743.7153; train_masked_gp_l1_reg_loss: 5724.2786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95847.8021; train_chrom_access_recon_loss: 451501.0764; train_global_loss: 4790068.7222; train_optim_loss: 4790068.7222; val_kl_reg_loss: 14479.0117; val_edge_recon_loss: 3990541.0000; val_gene_expr_recon_loss: 738417.8125; val_masked_gp_l1_reg_loss: 5780.2056; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93148.0000; val_chrom_access_recon_loss: 452382.7500; val_global_loss: 5294749.0000; val_optim_loss: 5294749.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8414; val_auprc_score: 0.8267; val_best_acc_score: 0.7649; val_best_f1_score: 0.7839; train_kl_reg_loss: 13446.1764; train_edge_recon_loss: 3452437.9722; train_gene_expr_recon_loss: 734182.0694; train_masked_gp_l1_reg_loss: 5841.1940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90991.4974; train_chrom_access_recon_loss: 448178.5243; train_global_loss: 4745077.4444; train_optim_loss: 4745077.4444; val_kl_reg_loss: 9543.6738; val_edge_recon_loss: 3731762.7500; val_gene_expr_recon_loss: 741285.8125; val_masked_gp_l1_reg_loss: 5911.8853; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88307.5000; val_chrom_access_recon_loss: 452308.4375; val_global_loss: 5029120.5000; val_optim_loss: 5029120.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8514; val_auprc_score: 0.8347; val_best_acc_score: 0.7749; val_best_f1_score: 0.7954; train_kl_reg_loss: 8072.9319; train_edge_recon_loss: 3292250.4167; train_gene_expr_recon_loss: 748931.8333; train_masked_gp_l1_reg_loss: 5995.1169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86229.5790; train_chrom_access_recon_loss: 449497.1597; train_global_loss: 4590977.0556; train_optim_loss: 4590977.0556; val_kl_reg_loss: 11330.0635; val_edge_recon_loss: 3047865.0000; val_gene_expr_recon_loss: 788260.2500; val_masked_gp_l1_reg_loss: 6107.3384; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83704.6172; val_chrom_access_recon_loss: 456255.6562; val_global_loss: 4393522.5000; val_optim_loss: 4393522.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8634; val_auprc_score: 0.8453; val_best_acc_score: 0.7763; val_best_f1_score: 0.8007; train_kl_reg_loss: 23603.6211; train_edge_recon_loss: 2961299.7778; train_gene_expr_recon_loss: 780367.4931; train_masked_gp_l1_reg_loss: 6232.7931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81754.6345; train_chrom_access_recon_loss: 452477.7604; train_global_loss: 4305736.1111; train_optim_loss: 4305736.1111; val_kl_reg_loss: 37683.2500; val_edge_recon_loss: 2873022.0000; val_gene_expr_recon_loss: 765055.6250; val_masked_gp_l1_reg_loss: 6365.8799; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79311.2188; val_chrom_access_recon_loss: 453928.8125; val_global_loss: 4215367.0000; val_optim_loss: 4215367.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8841; val_auprc_score: 0.8694; val_best_acc_score: 0.7991; val_best_f1_score: 0.8039; train_kl_reg_loss: 47416.3251; train_edge_recon_loss: 2879314.0000; train_gene_expr_recon_loss: 749279.5347; train_masked_gp_l1_reg_loss: 6429.1369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77389.4696; train_chrom_access_recon_loss: 448797.9444; train_global_loss: 4208626.3889; train_optim_loss: 4208626.3889; val_kl_reg_loss: 48429.3594; val_edge_recon_loss: 2867747.0000; val_gene_expr_recon_loss: 739274.6250; val_masked_gp_l1_reg_loss: 6503.7988; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74990.7344; val_chrom_access_recon_loss: 450679.6875; val_global_loss: 4187625.2500; val_optim_loss: 4187625.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8997; val_auprc_score: 0.8880; val_best_acc_score: 0.8064; val_best_f1_score: 0.8204; train_kl_reg_loss: 44607.9197; train_edge_recon_loss: 2859350.7222; train_gene_expr_recon_loss: 736478.0139; train_masked_gp_l1_reg_loss: 6540.2204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73089.3741; train_chrom_access_recon_loss: 449341.7257; train_global_loss: 4169407.9444; train_optim_loss: 4169407.9444; val_kl_reg_loss: 35952.5000; val_edge_recon_loss: 2857032.0000; val_gene_expr_recon_loss: 736601.5625; val_masked_gp_l1_reg_loss: 6561.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70729.0000; val_chrom_access_recon_loss: 449708.5938; val_global_loss: 4156585.5000; val_optim_loss: 4156585.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9088; val_auprc_score: 0.8884; val_best_acc_score: 0.8343; val_best_f1_score: 0.8465; train_kl_reg_loss: 32279.4462; train_edge_recon_loss: 2829751.1389; train_gene_expr_recon_loss: 734132.0208; train_masked_gp_l1_reg_loss: 6583.1917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68890.8568; train_chrom_access_recon_loss: 445424.9340; train_global_loss: 4117061.6111; train_optim_loss: 4117061.6111; val_kl_reg_loss: 29074.8984; val_edge_recon_loss: 2807987.2500; val_gene_expr_recon_loss: 739180.5000; val_masked_gp_l1_reg_loss: 6603.0854; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66630.1641; val_chrom_access_recon_loss: 449617.9062; val_global_loss: 4099094.0000; val_optim_loss: 4099094.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9164; val_auprc_score: 0.8929; val_best_acc_score: 0.8526; val_best_f1_score: 0.8647; train_kl_reg_loss: 30131.0584; train_edge_recon_loss: 2778226.6944; train_gene_expr_recon_loss: 737667.4306; train_masked_gp_l1_reg_loss: 6604.8867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64899.4123; train_chrom_access_recon_loss: 446046.8646; train_global_loss: 4063576.2778; train_optim_loss: 4063576.2778; val_kl_reg_loss: 31030.1348; val_edge_recon_loss: 2791245.5000; val_gene_expr_recon_loss: 742490.3750; val_masked_gp_l1_reg_loss: 6613.4189; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62790.7266; val_chrom_access_recon_loss: 449011.5625; val_global_loss: 4083181.7500; val_optim_loss: 4083181.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9309; val_auprc_score: 0.9086; val_best_acc_score: 0.8688; val_best_f1_score: 0.8777; train_kl_reg_loss: 33698.1141; train_edge_recon_loss: 2745184.3889; train_gene_expr_recon_loss: 737196.2500; train_masked_gp_l1_reg_loss: 6634.0169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61192.3316; train_chrom_access_recon_loss: 447515.5312; train_global_loss: 4031420.6944; train_optim_loss: 4031420.6944; val_kl_reg_loss: 34763.0352; val_edge_recon_loss: 2737439.5000; val_gene_expr_recon_loss: 731438.6250; val_masked_gp_l1_reg_loss: 6651.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59233.3555; val_chrom_access_recon_loss: 447272.0625; val_global_loss: 4016798.0000; val_optim_loss: 4016798.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9375; val_auprc_score: 0.9181; val_best_acc_score: 0.8762; val_best_f1_score: 0.8850; train_kl_reg_loss: 36926.2326; train_edge_recon_loss: 2721809.4722; train_gene_expr_recon_loss: 724754.7083; train_masked_gp_l1_reg_loss: 6665.7109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57748.0534; train_chrom_access_recon_loss: 444466.9549; train_global_loss: 3992371.1944; train_optim_loss: 3992371.1944; val_kl_reg_loss: 36932.4062; val_edge_recon_loss: 2743102.5000; val_gene_expr_recon_loss: 725253.6250; val_masked_gp_l1_reg_loss: 6665.6401; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55924.7891; val_chrom_access_recon_loss: 446077.4062; val_global_loss: 4013956.5000; val_optim_loss: 4013956.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9406; val_auprc_score: 0.9173; val_best_acc_score: 0.8860; val_best_f1_score: 0.8939; train_kl_reg_loss: 38781.4180; train_edge_recon_loss: 2723248.1389; train_gene_expr_recon_loss: 721122.2569; train_masked_gp_l1_reg_loss: 6669.0809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54528.5833; train_chrom_access_recon_loss: 442563.2500; train_global_loss: 3986912.8889; train_optim_loss: 3986912.8889; val_kl_reg_loss: 39211.7969; val_edge_recon_loss: 2720600.0000; val_gene_expr_recon_loss: 720963.6250; val_masked_gp_l1_reg_loss: 6675.1816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52816.8281; val_chrom_access_recon_loss: 445230.1875; val_global_loss: 3985497.7500; val_optim_loss: 3985497.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9435; val_auprc_score: 0.9248; val_best_acc_score: 0.8851; val_best_f1_score: 0.8935; train_kl_reg_loss: 40140.9766; train_edge_recon_loss: 2708750.5833; train_gene_expr_recon_loss: 716020.7153; train_masked_gp_l1_reg_loss: 6682.1176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51517.8546; train_chrom_access_recon_loss: 442779.9201; train_global_loss: 3965892.2222; train_optim_loss: 3965892.2222; val_kl_reg_loss: 36410.8516; val_edge_recon_loss: 2709539.7500; val_gene_expr_recon_loss: 719333.0000; val_masked_gp_l1_reg_loss: 6687.9663; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49929.6406; val_chrom_access_recon_loss: 444297.8125; val_global_loss: 3966199.0000; val_optim_loss: 3966199.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9465; val_auprc_score: 0.9315; val_best_acc_score: 0.8880; val_best_f1_score: 0.8955; train_kl_reg_loss: 37243.6176; train_edge_recon_loss: 2709987.5833; train_gene_expr_recon_loss: 713225.3889; train_masked_gp_l1_reg_loss: 6705.4313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48733.4084; train_chrom_access_recon_loss: 442086.1181; train_global_loss: 3957981.5833; train_optim_loss: 3957981.5833; val_kl_reg_loss: 36282.3516; val_edge_recon_loss: 2726882.7500; val_gene_expr_recon_loss: 713387.7500; val_masked_gp_l1_reg_loss: 6724.6216; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47268.3555; val_chrom_access_recon_loss: 443743.1562; val_global_loss: 3974288.7500; val_optim_loss: 3974288.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9502; val_auprc_score: 0.9359; val_best_acc_score: 0.8940; val_best_f1_score: 0.9011; train_kl_reg_loss: 37456.9557; train_edge_recon_loss: 2717695.0833; train_gene_expr_recon_loss: 709953.4514; train_masked_gp_l1_reg_loss: 6740.2214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46157.2687; train_chrom_access_recon_loss: 440882.4583; train_global_loss: 3958885.3611; train_optim_loss: 3958885.3611; val_kl_reg_loss: 36998.7578; val_edge_recon_loss: 2727040.2500; val_gene_expr_recon_loss: 711486.3750; val_masked_gp_l1_reg_loss: 6760.6929; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44798.5898; val_chrom_access_recon_loss: 442713.5625; val_global_loss: 3969798.2500; val_optim_loss: 3969798.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9532; val_auprc_score: 0.9369; val_best_acc_score: 0.8988; val_best_f1_score: 0.9044; train_kl_reg_loss: 38230.8945; train_edge_recon_loss: 2708954.0833; train_gene_expr_recon_loss: 708122.4375; train_masked_gp_l1_reg_loss: 6786.8025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43772.3563; train_chrom_access_recon_loss: 439000.0312; train_global_loss: 3944866.5833; train_optim_loss: 3944866.5833; val_kl_reg_loss: 36279.6016; val_edge_recon_loss: 2726691.2500; val_gene_expr_recon_loss: 706043.8125; val_masked_gp_l1_reg_loss: 6808.9395; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42525.0156; val_chrom_access_recon_loss: 441644.0000; val_global_loss: 3959992.5000; val_optim_loss: 3959992.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9536; val_auprc_score: 0.9408; val_best_acc_score: 0.8975; val_best_f1_score: 0.9032; train_kl_reg_loss: 36406.7140; train_edge_recon_loss: 2717076.1667; train_gene_expr_recon_loss: 703758.8403; train_masked_gp_l1_reg_loss: 6840.1580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41583.4071; train_chrom_access_recon_loss: 438226.1944; train_global_loss: 3943891.3611; train_optim_loss: 3943891.3611; val_kl_reg_loss: 35171.4297; val_edge_recon_loss: 2747024.0000; val_gene_expr_recon_loss: 707494.8750; val_masked_gp_l1_reg_loss: 6868.0039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40428.9961; val_chrom_access_recon_loss: 441294.0938; val_global_loss: 3978281.5000; val_optim_loss: 3978281.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9586; val_auprc_score: 0.9456; val_best_acc_score: 0.9043; val_best_f1_score: 0.9094; train_kl_reg_loss: 35988.9006; train_edge_recon_loss: 2707707.5278; train_gene_expr_recon_loss: 701111.9097; train_masked_gp_l1_reg_loss: 6889.9703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39552.6402; train_chrom_access_recon_loss: 437052.7292; train_global_loss: 3928303.5833; train_optim_loss: 3928303.5833; val_kl_reg_loss: 35810.6484; val_edge_recon_loss: 2712683.0000; val_gene_expr_recon_loss: 704437.8750; val_masked_gp_l1_reg_loss: 6916.0576; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38481.1562; val_chrom_access_recon_loss: 440724.5625; val_global_loss: 3939053.2500; val_optim_loss: 3939053.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9621; val_auprc_score: 0.9494; val_best_acc_score: 0.9132; val_best_f1_score: 0.9171; train_kl_reg_loss: 36162.1063; train_edge_recon_loss: 2702375.2222; train_gene_expr_recon_loss: 700121.0833; train_masked_gp_l1_reg_loss: 6935.7668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37669.4076; train_chrom_access_recon_loss: 437673.7639; train_global_loss: 3920937.3611; train_optim_loss: 3920937.3611; val_kl_reg_loss: 34126.9141; val_edge_recon_loss: 2687865.7500; val_gene_expr_recon_loss: 705823.7500; val_masked_gp_l1_reg_loss: 6956.5962; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36682.0742; val_chrom_access_recon_loss: 440286.9062; val_global_loss: 3911742.0000; val_optim_loss: 3911742.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9641; val_auprc_score: 0.9509; val_best_acc_score: 0.9093; val_best_f1_score: 0.9126; train_kl_reg_loss: 34207.2109; train_edge_recon_loss: 2704123.3333; train_gene_expr_recon_loss: 699067.4097; train_masked_gp_l1_reg_loss: 6979.1896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35939.4119; train_chrom_access_recon_loss: 436643.9583; train_global_loss: 3916960.5833; train_optim_loss: 3916960.5833; val_kl_reg_loss: 33902.7148; val_edge_recon_loss: 2698826.5000; val_gene_expr_recon_loss: 700769.2500; val_masked_gp_l1_reg_loss: 6999.1787; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35029.8008; val_chrom_access_recon_loss: 439608.8750; val_global_loss: 3915136.5000; val_optim_loss: 3915136.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9690; val_auprc_score: 0.9553; val_best_acc_score: 0.9228; val_best_f1_score: 0.9248; train_kl_reg_loss: 31292.9175; train_edge_recon_loss: 2685796.3611; train_gene_expr_recon_loss: 995855.1667; train_masked_gp_l1_reg_loss: 7056.6193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34141.7465; train_chrom_access_recon_loss: 459245.8507; train_global_loss: 4213388.6944; train_optim_loss: 4213388.6944; val_kl_reg_loss: 19462.4629; val_edge_recon_loss: 2672604.2500; val_gene_expr_recon_loss: 995698.1250; val_masked_gp_l1_reg_loss: 7126.1699; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32920.6094; val_chrom_access_recon_loss: 462961.0312; val_global_loss: 4190772.7500; val_optim_loss: 4190772.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9709; val_auprc_score: 0.9600; val_best_acc_score: 0.9243; val_best_f1_score: 0.9271; train_kl_reg_loss: 25096.9008; train_edge_recon_loss: 2667072.0556; train_gene_expr_recon_loss: 999608.3611; train_masked_gp_l1_reg_loss: 7203.3615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31878.3253; train_chrom_access_recon_loss: 461975.3576; train_global_loss: 4192834.3611; train_optim_loss: 4192834.3611; val_kl_reg_loss: 16719.6621; val_edge_recon_loss: 2685451.0000; val_gene_expr_recon_loss: 1002008.2500; val_masked_gp_l1_reg_loss: 7292.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30583.7539; val_chrom_access_recon_loss: 463486.8750; val_global_loss: 4205542.0000; val_optim_loss: 4205542.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9718; val_auprc_score: 0.9592; val_best_acc_score: 0.9275; val_best_f1_score: 0.9302; train_kl_reg_loss: 23171.1786; train_edge_recon_loss: 2657039.2222; train_gene_expr_recon_loss: 992827.4097; train_masked_gp_l1_reg_loss: 7363.9928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29589.7582; train_chrom_access_recon_loss: 460089.5069; train_global_loss: 4170081.0000; train_optim_loss: 4170081.0000; val_kl_reg_loss: 17772.7812; val_edge_recon_loss: 2667744.7500; val_gene_expr_recon_loss: 1001415.2500; val_masked_gp_l1_reg_loss: 7444.0947; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28378.5977; val_chrom_access_recon_loss: 463436.6562; val_global_loss: 4186192.0000; val_optim_loss: 4186192.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9723; val_auprc_score: 0.9624; val_best_acc_score: 0.9276; val_best_f1_score: 0.9308; train_kl_reg_loss: 23757.1523; train_edge_recon_loss: 2661679.1944; train_gene_expr_recon_loss: 991690.4028; train_masked_gp_l1_reg_loss: 7420.5643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28242.9260; train_chrom_access_recon_loss: 457578.1146; train_global_loss: 4170368.4444; train_optim_loss: 4170368.4444; val_kl_reg_loss: 17853.6562; val_edge_recon_loss: 2650670.5000; val_gene_expr_recon_loss: 997182.3750; val_masked_gp_l1_reg_loss: 7396.8389; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28077.3281; val_chrom_access_recon_loss: 462948.5938; val_global_loss: 4164129.0000; val_optim_loss: 4164129.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9725; val_auprc_score: 0.9599; val_best_acc_score: 0.9289; val_best_f1_score: 0.9313; train_kl_reg_loss: 23720.6970; train_edge_recon_loss: 2655550.3611; train_gene_expr_recon_loss: 991115.1667; train_masked_gp_l1_reg_loss: 7392.7854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27958.0775; train_chrom_access_recon_loss: 458136.5938; train_global_loss: 4163873.6111; train_optim_loss: 4163873.6111; val_kl_reg_loss: 17695.1738; val_edge_recon_loss: 2680906.7500; val_gene_expr_recon_loss: 998328.1875; val_masked_gp_l1_reg_loss: 7385.7642; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27808.7793; val_chrom_access_recon_loss: 463046.4375; val_global_loss: 4195171.0000; val_optim_loss: 4195171.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9728; val_auprc_score: 0.9632; val_best_acc_score: 0.9282; val_best_f1_score: 0.9314; train_kl_reg_loss: 23583.9824; train_edge_recon_loss: 2658728.7778; train_gene_expr_recon_loss: 994252.8889; train_masked_gp_l1_reg_loss: 7383.5027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27696.0328; train_chrom_access_recon_loss: 460417.6215; train_global_loss: 4172062.8333; train_optim_loss: 4172062.8333; val_kl_reg_loss: 17692.7969; val_edge_recon_loss: 2655850.0000; val_gene_expr_recon_loss: 997332.5625; val_masked_gp_l1_reg_loss: 7381.6401; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27557.3535; val_chrom_access_recon_loss: 462874.3125; val_global_loss: 4168688.5000; val_optim_loss: 4168688.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9759; val_auprc_score: 0.9674; val_best_acc_score: 0.9282; val_best_f1_score: 0.9302; train_kl_reg_loss: 23592.0102; train_edge_recon_loss: 2657550.0833; train_gene_expr_recon_loss: 994466.0972; train_masked_gp_l1_reg_loss: 7382.4124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27451.8518; train_chrom_access_recon_loss: 460216.5382; train_global_loss: 4170659.1111; train_optim_loss: 4170659.1111; val_kl_reg_loss: 17755.2441; val_edge_recon_loss: 2647178.2500; val_gene_expr_recon_loss: 996467.5000; val_masked_gp_l1_reg_loss: 7384.0459; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27324.7480; val_chrom_access_recon_loss: 462662.1562; val_global_loss: 4158772.0000; val_optim_loss: 4158772.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 17 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9631
val AUPRC score: 0.9536
val best accuracy score: 0.9088
val best F1 score: 0.9133
val target rna MSE score: 4.0715
val source rna MSE score: 3.1834
val target atac MSE score: 0.1346
val source atac MSE score: 0.0216
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
