[True]
Run timestamp: 10102023_042303_140.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_140']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7048; val_auprc_score: 0.6768; val_best_acc_score: 0.5011; val_best_f1_score: 0.6667; train_kl_reg_loss: 51303.8287; train_edge_recon_loss: 3522298.7386; train_gene_expr_recon_loss: 14125085.8030; train_masked_gp_l1_reg_loss: 124685.2008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4618584.7197; train_chrom_access_recon_loss: 4969074.8106; train_global_loss: 27411033.1212; train_optim_loss: 27411033.1212; val_kl_reg_loss: 104221.1934; val_edge_recon_loss: 4064985.5625; val_gene_expr_recon_loss: 12742319.8750; val_masked_gp_l1_reg_loss: 99173.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2214195.5000; val_chrom_access_recon_loss: 4685055.0625; val_global_loss: 23909952.0000; val_optim_loss: 23909952.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6725; val_auprc_score: 0.6560; val_best_acc_score: 0.5723; val_best_f1_score: 0.6883; train_kl_reg_loss: 101137.0787; train_edge_recon_loss: 3522666.0114; train_gene_expr_recon_loss: 12841462.4848; train_masked_gp_l1_reg_loss: 94992.5803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1052533.5597; train_chrom_access_recon_loss: 4715534.1288; train_global_loss: 22328325.9091; train_optim_loss: 22328325.9091; val_kl_reg_loss: 92998.4531; val_edge_recon_loss: 4061044.0312; val_gene_expr_recon_loss: 12690541.1250; val_masked_gp_l1_reg_loss: 93813.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 435176.3125; val_chrom_access_recon_loss: 4660318.1250; val_global_loss: 22033892.0000; val_optim_loss: 22033892.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7110; val_auprc_score: 0.6834; val_best_acc_score: 0.6515; val_best_f1_score: 0.6916; train_kl_reg_loss: 92522.6360; train_edge_recon_loss: 3520060.4583; train_gene_expr_recon_loss: 12697612.3636; train_masked_gp_l1_reg_loss: 94262.9708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 290202.2502; train_chrom_access_recon_loss: 4680178.6515; train_global_loss: 21374839.4545; train_optim_loss: 21374839.4545; val_kl_reg_loss: 89405.7139; val_edge_recon_loss: 4040955.5938; val_gene_expr_recon_loss: 12554896.3750; val_masked_gp_l1_reg_loss: 94905.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 200218.4688; val_chrom_access_recon_loss: 4630227.8125; val_global_loss: 21610608.5000; val_optim_loss: 21610608.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7426; val_auprc_score: 0.7145; val_best_acc_score: 0.6771; val_best_f1_score: 0.7224; train_kl_reg_loss: 79737.3158; train_edge_recon_loss: 3488524.9470; train_gene_expr_recon_loss: 12616064.1667; train_masked_gp_l1_reg_loss: 95974.9727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163463.3390; train_chrom_access_recon_loss: 4655979.4242; train_global_loss: 21099744.0606; train_optim_loss: 21099744.0606; val_kl_reg_loss: 53209.3911; val_edge_recon_loss: 3609890.3125; val_gene_expr_recon_loss: 12503372.5000; val_masked_gp_l1_reg_loss: 98350.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136315.2969; val_chrom_access_recon_loss: 4582810.5000; val_global_loss: 20983948.0000; val_optim_loss: 20983948.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7989; val_auprc_score: 0.7607; val_best_acc_score: 0.7297; val_best_f1_score: 0.7644; train_kl_reg_loss: 79061.0696; train_edge_recon_loss: 3197063.3977; train_gene_expr_recon_loss: 12578799.1364; train_masked_gp_l1_reg_loss: 103745.0182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122637.8607; train_chrom_access_recon_loss: 4636405.4470; train_global_loss: 20717711.9091; train_optim_loss: 20717711.9091; val_kl_reg_loss: 87783.3477; val_edge_recon_loss: 3122295.1562; val_gene_expr_recon_loss: 12401930.6250; val_masked_gp_l1_reg_loss: 108176.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111461.1406; val_chrom_access_recon_loss: 4627293.8750; val_global_loss: 20458940.5000; val_optim_loss: 20458940.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8455; val_auprc_score: 0.8129; val_best_acc_score: 0.7714; val_best_f1_score: 0.8002; train_kl_reg_loss: 103499.8436; train_edge_recon_loss: 2990192.6098; train_gene_expr_recon_loss: 12495377.1061; train_masked_gp_l1_reg_loss: 111140.4479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104286.7229; train_chrom_access_recon_loss: 4610219.9015; train_global_loss: 20414716.7273; train_optim_loss: 20414716.7273; val_kl_reg_loss: 103751.2783; val_edge_recon_loss: 2968792.6875; val_gene_expr_recon_loss: 12351591.2500; val_masked_gp_l1_reg_loss: 114029.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98876.1953; val_chrom_access_recon_loss: 4519537.4062; val_global_loss: 20156577.2500; val_optim_loss: 20156577.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8716; val_auprc_score: 0.8368; val_best_acc_score: 0.7996; val_best_f1_score: 0.8181; train_kl_reg_loss: 106334.6971; train_edge_recon_loss: 2905784.0341; train_gene_expr_recon_loss: 12414248.6061; train_masked_gp_l1_reg_loss: 115634.3582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95805.9561; train_chrom_access_recon_loss: 4581129.6136; train_global_loss: 20218937.0606; train_optim_loss: 20218937.0606; val_kl_reg_loss: 107850.1514; val_edge_recon_loss: 2922844.7188; val_gene_expr_recon_loss: 12237848.6250; val_masked_gp_l1_reg_loss: 117398.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94548.0938; val_chrom_access_recon_loss: 4524589.4375; val_global_loss: 20005079.2500; val_optim_loss: 20005079.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8920; val_auprc_score: 0.8492; val_best_acc_score: 0.8278; val_best_f1_score: 0.8407; train_kl_reg_loss: 103629.8422; train_edge_recon_loss: 2859784.6212; train_gene_expr_recon_loss: 12347304.8636; train_masked_gp_l1_reg_loss: 118649.2212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93571.4884; train_chrom_access_recon_loss: 4565884.3333; train_global_loss: 20088824.4242; train_optim_loss: 20088824.4242; val_kl_reg_loss: 102821.0537; val_edge_recon_loss: 2875040.2500; val_gene_expr_recon_loss: 12158508.8750; val_masked_gp_l1_reg_loss: 120159.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92873.4844; val_chrom_access_recon_loss: 4507977.3125; val_global_loss: 19857381.0000; val_optim_loss: 19857381.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9033; val_auprc_score: 0.8742; val_best_acc_score: 0.8444; val_best_f1_score: 0.8557; train_kl_reg_loss: 106842.2362; train_edge_recon_loss: 2836811.2121; train_gene_expr_recon_loss: 12292167.4394; train_masked_gp_l1_reg_loss: 120593.3377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91499.0080; train_chrom_access_recon_loss: 4548859.7500; train_global_loss: 19996773.0606; train_optim_loss: 19996773.0606; val_kl_reg_loss: 103355.4561; val_edge_recon_loss: 2832179.4375; val_gene_expr_recon_loss: 12211021.1250; val_masked_gp_l1_reg_loss: 121566.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90531.8672; val_chrom_access_recon_loss: 4534348.3125; val_global_loss: 19893003.2500; val_optim_loss: 19893003.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8980; val_auprc_score: 0.8655; val_best_acc_score: 0.8345; val_best_f1_score: 0.8465; train_kl_reg_loss: 104542.1589; train_edge_recon_loss: 2831569.2311; train_gene_expr_recon_loss: 12248413.9242; train_masked_gp_l1_reg_loss: 122071.8871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89646.1523; train_chrom_access_recon_loss: 4532256.3182; train_global_loss: 19928499.8182; train_optim_loss: 19928499.8182; val_kl_reg_loss: 100573.2920; val_edge_recon_loss: 2868664.9688; val_gene_expr_recon_loss: 12070784.8750; val_masked_gp_l1_reg_loss: 123193.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88700.4219; val_chrom_access_recon_loss: 4470867.7500; val_global_loss: 19722783.7500; val_optim_loss: 19722783.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9086; val_auprc_score: 0.8740; val_best_acc_score: 0.8474; val_best_f1_score: 0.8589; train_kl_reg_loss: 105052.3643; train_edge_recon_loss: 2813984.7803; train_gene_expr_recon_loss: 12194983.0000; train_masked_gp_l1_reg_loss: 123392.3526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88788.0767; train_chrom_access_recon_loss: 4511754.9091; train_global_loss: 19837955.5152; train_optim_loss: 19837955.5152; val_kl_reg_loss: 106416.9229; val_edge_recon_loss: 2825682.5938; val_gene_expr_recon_loss: 12030640.6250; val_masked_gp_l1_reg_loss: 123877.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88896.0312; val_chrom_access_recon_loss: 4462763.3750; val_global_loss: 19638277.5000; val_optim_loss: 19638277.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9080; val_auprc_score: 0.8732; val_best_acc_score: 0.8479; val_best_f1_score: 0.8566; train_kl_reg_loss: 102989.6811; train_edge_recon_loss: 2808465.7841; train_gene_expr_recon_loss: 12152572.2424; train_masked_gp_l1_reg_loss: 124192.5343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88774.8110; train_chrom_access_recon_loss: 4499074.4697; train_global_loss: 19776069.5152; train_optim_loss: 19776069.5152; val_kl_reg_loss: 99610.6660; val_edge_recon_loss: 2854054.2812; val_gene_expr_recon_loss: 11913243.8750; val_masked_gp_l1_reg_loss: 124819.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89012.9531; val_chrom_access_recon_loss: 4418787.4688; val_global_loss: 19499528.5000; val_optim_loss: 19499528.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9091; val_auprc_score: 0.8748; val_best_acc_score: 0.8466; val_best_f1_score: 0.8583; train_kl_reg_loss: 102835.8480; train_edge_recon_loss: 2788027.7576; train_gene_expr_recon_loss: 12112099.6667; train_masked_gp_l1_reg_loss: 124918.5588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88648.5773; train_chrom_access_recon_loss: 4486083.5530; train_global_loss: 19702613.9091; train_optim_loss: 19702613.9091; val_kl_reg_loss: 98774.0830; val_edge_recon_loss: 2864261.1250; val_gene_expr_recon_loss: 11903526.5000; val_masked_gp_l1_reg_loss: 125264.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88165.9766; val_chrom_access_recon_loss: 4417264.2500; val_global_loss: 19497256.0000; val_optim_loss: 19497256.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9154; val_auprc_score: 0.8859; val_best_acc_score: 0.8589; val_best_f1_score: 0.8668; train_kl_reg_loss: 100697.3759; train_edge_recon_loss: 2804401.6742; train_gene_expr_recon_loss: 12067143.3182; train_masked_gp_l1_reg_loss: 125747.7609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87679.3840; train_chrom_access_recon_loss: 4473945.9924; train_global_loss: 19659615.5455; train_optim_loss: 19659615.5455; val_kl_reg_loss: 96691.8193; val_edge_recon_loss: 2803768.2188; val_gene_expr_recon_loss: 11931233.7500; val_masked_gp_l1_reg_loss: 125930.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87384.8203; val_chrom_access_recon_loss: 4422391.5000; val_global_loss: 19467400.5000; val_optim_loss: 19467400.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9253; val_auprc_score: 0.8954; val_best_acc_score: 0.8667; val_best_f1_score: 0.8761; train_kl_reg_loss: 98303.3589; train_edge_recon_loss: 2790040.9356; train_gene_expr_recon_loss: 12033883.1970; train_masked_gp_l1_reg_loss: 126422.8807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87048.9756; train_chrom_access_recon_loss: 4458886.5682; train_global_loss: 19594586.1212; train_optim_loss: 19594586.1212; val_kl_reg_loss: 101463.1924; val_edge_recon_loss: 2794276.1250; val_gene_expr_recon_loss: 11786167.2500; val_masked_gp_l1_reg_loss: 126794.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86778.1328; val_chrom_access_recon_loss: 4452685.9375; val_global_loss: 19348165.5000; val_optim_loss: 19348165.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9165; val_auprc_score: 0.8807; val_best_acc_score: 0.8651; val_best_f1_score: 0.8741; train_kl_reg_loss: 99742.4728; train_edge_recon_loss: 2795807.7462; train_gene_expr_recon_loss: 11993113.0152; train_masked_gp_l1_reg_loss: 127071.9433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85911.6826; train_chrom_access_recon_loss: 4443169.5530; train_global_loss: 19544816.5152; train_optim_loss: 19544816.5152; val_kl_reg_loss: 96936.8555; val_edge_recon_loss: 2810238.5312; val_gene_expr_recon_loss: 11788817.6250; val_masked_gp_l1_reg_loss: 127444.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85589.9922; val_chrom_access_recon_loss: 4391066.6875; val_global_loss: 19300094.7500; val_optim_loss: 19300094.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9201; val_auprc_score: 0.8853; val_best_acc_score: 0.8630; val_best_f1_score: 0.8721; train_kl_reg_loss: 99217.7436; train_edge_recon_loss: 2772062.3561; train_gene_expr_recon_loss: 11958958.0606; train_masked_gp_l1_reg_loss: 127672.1594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85140.6460; train_chrom_access_recon_loss: 4430883.5758; train_global_loss: 19473934.5455; train_optim_loss: 19473934.5455; val_kl_reg_loss: 98443.6973; val_edge_recon_loss: 2760452.7188; val_gene_expr_recon_loss: 11860921.5000; val_masked_gp_l1_reg_loss: 127942.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85172.4688; val_chrom_access_recon_loss: 4366732.3750; val_global_loss: 19299664.5000; val_optim_loss: 19299664.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9194; val_auprc_score: 0.8902; val_best_acc_score: 0.8603; val_best_f1_score: 0.8674; train_kl_reg_loss: 98460.1973; train_edge_recon_loss: 2756564.3598; train_gene_expr_recon_loss: 11933598.7273; train_masked_gp_l1_reg_loss: 127864.7274; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84803.1010; train_chrom_access_recon_loss: 4420272.7803; train_global_loss: 19421563.7273; train_optim_loss: 19421563.7273; val_kl_reg_loss: 99149.5859; val_edge_recon_loss: 2806308.4375; val_gene_expr_recon_loss: 11646657.7500; val_masked_gp_l1_reg_loss: 128134.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83794.5703; val_chrom_access_recon_loss: 4348789.5000; val_global_loss: 19112834.0000; val_optim_loss: 19112834.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9288; val_auprc_score: 0.8998; val_best_acc_score: 0.8724; val_best_f1_score: 0.8768; train_kl_reg_loss: 96131.2340; train_edge_recon_loss: 2764746.6250; train_gene_expr_recon_loss: 11902051.8636; train_masked_gp_l1_reg_loss: 128386.0528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84015.3595; train_chrom_access_recon_loss: 4410273.9545; train_global_loss: 19385605.0303; train_optim_loss: 19385605.0303; val_kl_reg_loss: 91929.4316; val_edge_recon_loss: 2790018.4375; val_gene_expr_recon_loss: 11700001.6250; val_masked_gp_l1_reg_loss: 128572.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83763.2422; val_chrom_access_recon_loss: 4353179.2500; val_global_loss: 19147463.7500; val_optim_loss: 19147463.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9232; val_auprc_score: 0.8861; val_best_acc_score: 0.8751; val_best_f1_score: 0.8816; train_kl_reg_loss: 96969.3568; train_edge_recon_loss: 2757322.2917; train_gene_expr_recon_loss: 11884856.7273; train_masked_gp_l1_reg_loss: 128692.6128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83619.2080; train_chrom_access_recon_loss: 4402923.9735; train_global_loss: 19354384.2727; train_optim_loss: 19354384.2727; val_kl_reg_loss: 96895.6924; val_edge_recon_loss: 2767623.6250; val_gene_expr_recon_loss: 11734105.7500; val_masked_gp_l1_reg_loss: 129134.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83485.7969; val_chrom_access_recon_loss: 4373565.9375; val_global_loss: 19184811.0000; val_optim_loss: 19184811.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9249; val_auprc_score: 0.8976; val_best_acc_score: 0.8667; val_best_f1_score: 0.8751; train_kl_reg_loss: 95999.9759; train_edge_recon_loss: 2755454.7500; train_gene_expr_recon_loss: 11852801.3788; train_masked_gp_l1_reg_loss: 129184.0733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83427.7359; train_chrom_access_recon_loss: 4388188.2235; train_global_loss: 19305056.1212; train_optim_loss: 19305056.1212; val_kl_reg_loss: 95142.2646; val_edge_recon_loss: 2792671.6250; val_gene_expr_recon_loss: 11706487.3750; val_masked_gp_l1_reg_loss: 129237.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83412.4297; val_chrom_access_recon_loss: 4333130.1250; val_global_loss: 19140081.0000; val_optim_loss: 19140081.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9230; val_auprc_score: 0.8888; val_best_acc_score: 0.8641; val_best_f1_score: 0.8748; train_kl_reg_loss: 96392.2208; train_edge_recon_loss: 2748244.7008; train_gene_expr_recon_loss: 11832515.8788; train_masked_gp_l1_reg_loss: 129409.9254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83521.2895; train_chrom_access_recon_loss: 4380091.9962; train_global_loss: 19270176.0000; train_optim_loss: 19270176.0000; val_kl_reg_loss: 94169.2930; val_edge_recon_loss: 2800567.6875; val_gene_expr_recon_loss: 11762332.2500; val_masked_gp_l1_reg_loss: 129686.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84015.6484; val_chrom_access_recon_loss: 4358359.0625; val_global_loss: 19229131.0000; val_optim_loss: 19229131.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9228; val_auprc_score: 0.8916; val_best_acc_score: 0.8627; val_best_f1_score: 0.8734; train_kl_reg_loss: 96024.4393; train_edge_recon_loss: 2746742.0682; train_gene_expr_recon_loss: 11806966.5758; train_masked_gp_l1_reg_loss: 125160.2834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67381.9630; train_chrom_access_recon_loss: 4368375.6402; train_global_loss: 19210651.1212; train_optim_loss: 19210651.1212; val_kl_reg_loss: 95103.9590; val_edge_recon_loss: 2790010.5312; val_gene_expr_recon_loss: 11725279.3750; val_masked_gp_l1_reg_loss: 123642.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63631.2539; val_chrom_access_recon_loss: 4357958.0625; val_global_loss: 19155626.0000; val_optim_loss: 19155626.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9307; val_auprc_score: 0.9053; val_best_acc_score: 0.8705; val_best_f1_score: 0.8800; train_kl_reg_loss: 97370.4045; train_edge_recon_loss: 2752419.1553; train_gene_expr_recon_loss: 11802500.0455; train_masked_gp_l1_reg_loss: 123473.5721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63212.7609; train_chrom_access_recon_loss: 4363447.6742; train_global_loss: 19202423.6061; train_optim_loss: 19202423.6061; val_kl_reg_loss: 95349.3721; val_edge_recon_loss: 2776968.0938; val_gene_expr_recon_loss: 11647367.2500; val_masked_gp_l1_reg_loss: 123380.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62905.5000; val_chrom_access_recon_loss: 4315115.8750; val_global_loss: 19021087.2500; val_optim_loss: 19021087.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9229; val_auprc_score: 0.8892; val_best_acc_score: 0.8665; val_best_f1_score: 0.8764; train_kl_reg_loss: 97948.8937; train_edge_recon_loss: 2756441.9773; train_gene_expr_recon_loss: 11790816.3030; train_masked_gp_l1_reg_loss: 123347.9901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62694.6429; train_chrom_access_recon_loss: 4360211.6515; train_global_loss: 19191461.4545; train_optim_loss: 19191461.4545; val_kl_reg_loss: 96035.3623; val_edge_recon_loss: 2795711.7500; val_gene_expr_recon_loss: 11651703.7500; val_masked_gp_l1_reg_loss: 123313.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62540.5977; val_chrom_access_recon_loss: 4350068.6875; val_global_loss: 19079374.7500; val_optim_loss: 19079374.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9298; val_auprc_score: 0.9025; val_best_acc_score: 0.8756; val_best_f1_score: 0.8841; train_kl_reg_loss: 97696.0309; train_edge_recon_loss: 2749967.0076; train_gene_expr_recon_loss: 11792422.2424; train_masked_gp_l1_reg_loss: 123312.6206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62450.7266; train_chrom_access_recon_loss: 4362354.3598; train_global_loss: 19188203.0000; train_optim_loss: 19188203.0000; val_kl_reg_loss: 96298.3682; val_edge_recon_loss: 2752056.0625; val_gene_expr_recon_loss: 11549820.3750; val_masked_gp_l1_reg_loss: 123314.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62229.5078; val_chrom_access_recon_loss: 4274878.0000; val_global_loss: 18858596.7500; val_optim_loss: 18858596.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9283; val_auprc_score: 0.8958; val_best_acc_score: 0.8673; val_best_f1_score: 0.8779; train_kl_reg_loss: 98250.6357; train_edge_recon_loss: 2744622.8333; train_gene_expr_recon_loss: 11794748.3485; train_masked_gp_l1_reg_loss: 123284.9941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62081.7006; train_chrom_access_recon_loss: 4361703.0417; train_global_loss: 19184691.8788; train_optim_loss: 19184691.8788; val_kl_reg_loss: 96813.0156; val_edge_recon_loss: 2789198.9375; val_gene_expr_recon_loss: 11612785.0000; val_masked_gp_l1_reg_loss: 123328.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62046.2812; val_chrom_access_recon_loss: 4293805.8750; val_global_loss: 18977977.7500; val_optim_loss: 18977977.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9290; val_auprc_score: 0.8982; val_best_acc_score: 0.8694; val_best_f1_score: 0.8769; train_kl_reg_loss: 97917.3226; train_edge_recon_loss: 2751684.6023; train_gene_expr_recon_loss: 11794447.8636; train_masked_gp_l1_reg_loss: 123319.2963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61961.3412; train_chrom_access_recon_loss: 4359587.4091; train_global_loss: 19188917.7273; train_optim_loss: 19188917.7273; val_kl_reg_loss: 96886.8145; val_edge_recon_loss: 2781708.7812; val_gene_expr_recon_loss: 11715219.1250; val_masked_gp_l1_reg_loss: 123352.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61874.0703; val_chrom_access_recon_loss: 4366619.5625; val_global_loss: 19145660.7500; val_optim_loss: 19145660.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9285; val_auprc_score: 0.8940; val_best_acc_score: 0.8743; val_best_f1_score: 0.8824; train_kl_reg_loss: 97609.7238; train_edge_recon_loss: 2748922.3333; train_gene_expr_recon_loss: 11793188.8939; train_masked_gp_l1_reg_loss: 123334.7280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61783.1213; train_chrom_access_recon_loss: 4359819.6212; train_global_loss: 19184658.4848; train_optim_loss: 19184658.4848; val_kl_reg_loss: 95646.8047; val_edge_recon_loss: 2770553.1250; val_gene_expr_recon_loss: 11648193.8750; val_masked_gp_l1_reg_loss: 123334.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61670.5938; val_chrom_access_recon_loss: 4354976.5938; val_global_loss: 19054375.2500; val_optim_loss: 19054375.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9175; val_auprc_score: 0.8823; val_best_acc_score: 0.8619; val_best_f1_score: 0.8731; train_kl_reg_loss: 97607.7730; train_edge_recon_loss: 2740544.4356; train_gene_expr_recon_loss: 11790978.0758; train_masked_gp_l1_reg_loss: 123346.5105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61560.2623; train_chrom_access_recon_loss: 4359686.0152; train_global_loss: 19173723.0303; train_optim_loss: 19173723.0303; val_kl_reg_loss: 96671.3525; val_edge_recon_loss: 2805308.7500; val_gene_expr_recon_loss: 11629611.6250; val_masked_gp_l1_reg_loss: 123421.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61555.5547; val_chrom_access_recon_loss: 4347823.2500; val_global_loss: 19064391.7500; val_optim_loss: 19064391.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9270; val_auprc_score: 0.9013; val_best_acc_score: 0.8641; val_best_f1_score: 0.8749; train_kl_reg_loss: 98009.0281; train_edge_recon_loss: 2750549.1023; train_gene_expr_recon_loss: 11780437.9091; train_masked_gp_l1_reg_loss: 122914.9716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59973.3088; train_chrom_access_recon_loss: 4353374.8371; train_global_loss: 19165259.1515; train_optim_loss: 19165259.1515; val_kl_reg_loss: 96266.7158; val_edge_recon_loss: 2801482.6562; val_gene_expr_recon_loss: 11697401.2500; val_masked_gp_l1_reg_loss: 122701.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59619.6367; val_chrom_access_recon_loss: 4321782.7812; val_global_loss: 19099255.5000; val_optim_loss: 19099255.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9293; val_auprc_score: 0.9002; val_best_acc_score: 0.8721; val_best_f1_score: 0.8820; train_kl_reg_loss: 97917.0526; train_edge_recon_loss: 2741927.2992; train_gene_expr_recon_loss: 11769808.0152; train_masked_gp_l1_reg_loss: 122658.4740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59569.9442; train_chrom_access_recon_loss: 4351664.7386; train_global_loss: 19143545.3333; train_optim_loss: 19143545.3333; val_kl_reg_loss: 97181.5957; val_edge_recon_loss: 2770832.4688; val_gene_expr_recon_loss: 11558478.3750; val_masked_gp_l1_reg_loss: 122630.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59532.0391; val_chrom_access_recon_loss: 4313212.4062; val_global_loss: 18921867.7500; val_optim_loss: 18921867.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9298; val_auprc_score: 0.8946; val_best_acc_score: 0.8761; val_best_f1_score: 0.8848; train_kl_reg_loss: 98072.5800; train_edge_recon_loss: 2742926.5720; train_gene_expr_recon_loss: 11784565.4697; train_masked_gp_l1_reg_loss: 122616.4213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59501.6478; train_chrom_access_recon_loss: 4361435.6250; train_global_loss: 19169118.4242; train_optim_loss: 19169118.4242; val_kl_reg_loss: 96620.4805; val_edge_recon_loss: 2744960.3438; val_gene_expr_recon_loss: 11593135.0000; val_masked_gp_l1_reg_loss: 122608.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59476.7109; val_chrom_access_recon_loss: 4356008.0938; val_global_loss: 18972808.7500; val_optim_loss: 18972808.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9249; val_auprc_score: 0.8957; val_best_acc_score: 0.8646; val_best_f1_score: 0.8742; train_kl_reg_loss: 97900.8587; train_edge_recon_loss: 2748288.0758; train_gene_expr_recon_loss: 11772440.0455; train_masked_gp_l1_reg_loss: 122602.8853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59457.0186; train_chrom_access_recon_loss: 4356945.8712; train_global_loss: 19157634.6667; train_optim_loss: 19157634.6667; val_kl_reg_loss: 95834.0830; val_edge_recon_loss: 2805432.2500; val_gene_expr_recon_loss: 11673809.5000; val_masked_gp_l1_reg_loss: 122598.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59436.5859; val_chrom_access_recon_loss: 4337471.6250; val_global_loss: 19094583.7500; val_optim_loss: 19094583.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 42 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
val AUROC score: 0.9233
val AUPRC score: 0.8996
val best accuracy score: 0.8603
val best F1 score: 0.8708
val target rna MSE score: 1.2498
val source rna MSE score: 0.8627
val target atac MSE score: 0.4724
val source atac MSE score: 0.1909
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
