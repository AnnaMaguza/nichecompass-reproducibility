[True]
Run timestamp: 10102023_085810_208.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_208']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6709; val_auprc_score: 0.6490; val_best_acc_score: 0.5024; val_best_f1_score: 0.6674; train_kl_reg_loss: 47673.4809; train_edge_recon_loss: 746255.3949; train_gene_expr_recon_loss: 23368645.7576; train_masked_gp_l1_reg_loss: 153233.4749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4996163.2803; train_chrom_access_recon_loss: 6962766.5455; train_global_loss: 36274737.9091; train_optim_loss: 36274737.9091; val_kl_reg_loss: 91077.8604; val_edge_recon_loss: 813029.8594; val_gene_expr_recon_loss: 21483502.2500; val_masked_gp_l1_reg_loss: 120070.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2832526.2500; val_chrom_access_recon_loss: 6560145.6875; val_global_loss: 31900352.2500; val_optim_loss: 31900352.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6982; val_auprc_score: 0.6880; val_best_acc_score: 0.5747; val_best_f1_score: 0.6922; train_kl_reg_loss: 81440.8759; train_edge_recon_loss: 748112.7074; train_gene_expr_recon_loss: 21377942.6970; train_masked_gp_l1_reg_loss: 110447.1493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1566271.7358; train_chrom_access_recon_loss: 6622627.2121; train_global_loss: 30506842.4242; train_optim_loss: 30506842.4242; val_kl_reg_loss: 81698.9717; val_edge_recon_loss: 812074.9141; val_gene_expr_recon_loss: 21025828.0000; val_masked_gp_l1_reg_loss: 105384.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 763148.7500; val_chrom_access_recon_loss: 6467636.2500; val_global_loss: 29255770.2500; val_optim_loss: 29255770.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7526; val_auprc_score: 0.7395; val_best_acc_score: 0.6572; val_best_f1_score: 0.7135; train_kl_reg_loss: 81014.8510; train_edge_recon_loss: 741450.7169; train_gene_expr_recon_loss: 21132946.9394; train_masked_gp_l1_reg_loss: 103372.9402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 504765.3783; train_chrom_access_recon_loss: 6576728.6818; train_global_loss: 29140279.6061; train_optim_loss: 29140279.6061; val_kl_reg_loss: 77701.0498; val_edge_recon_loss: 810033.4062; val_gene_expr_recon_loss: 20752202.5000; val_masked_gp_l1_reg_loss: 102479.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 337172.0625; val_chrom_access_recon_loss: 6450700.4375; val_global_loss: 28530289.2500; val_optim_loss: 28530289.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8296; val_auprc_score: 0.8124; val_best_acc_score: 0.7294; val_best_f1_score: 0.7412; train_kl_reg_loss: 75906.9336; train_edge_recon_loss: 735067.5218; train_gene_expr_recon_loss: 20985799.9697; train_masked_gp_l1_reg_loss: 102727.4872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 265471.2289; train_chrom_access_recon_loss: 6535137.4318; train_global_loss: 28700110.4242; train_optim_loss: 28700110.4242; val_kl_reg_loss: 72234.4951; val_edge_recon_loss: 797734.5234; val_gene_expr_recon_loss: 20684879.7500; val_masked_gp_l1_reg_loss: 103934.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 213303.8438; val_chrom_access_recon_loss: 6344310.0625; val_global_loss: 28216396.2500; val_optim_loss: 28216396.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8693; val_auprc_score: 0.8472; val_best_acc_score: 0.7990; val_best_f1_score: 0.8062; train_kl_reg_loss: 71134.6547; train_edge_recon_loss: 724967.3722; train_gene_expr_recon_loss: 20828481.2121; train_masked_gp_l1_reg_loss: 105417.1294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186358.7377; train_chrom_access_recon_loss: 6481569.1136; train_global_loss: 28397928.1515; train_optim_loss: 28397928.1515; val_kl_reg_loss: 65223.1084; val_edge_recon_loss: 765002.8750; val_gene_expr_recon_loss: 20538404.5000; val_masked_gp_l1_reg_loss: 106372.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 165694.3281; val_chrom_access_recon_loss: 6324773.4375; val_global_loss: 27965469.7500; val_optim_loss: 27965469.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8803; val_auprc_score: 0.8486; val_best_acc_score: 0.8170; val_best_f1_score: 0.8296; train_kl_reg_loss: 69070.4100; train_edge_recon_loss: 704818.5795; train_gene_expr_recon_loss: 20704208.1818; train_masked_gp_l1_reg_loss: 108081.3166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155336.2550; train_chrom_access_recon_loss: 6454505.3485; train_global_loss: 28196020.2424; train_optim_loss: 28196020.2424; val_kl_reg_loss: 67485.3364; val_edge_recon_loss: 713654.1797; val_gene_expr_recon_loss: 20471097.2500; val_masked_gp_l1_reg_loss: 109772.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145655.8438; val_chrom_access_recon_loss: 6332081.2500; val_global_loss: 27839746.0000; val_optim_loss: 27839746.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9005; val_auprc_score: 0.8733; val_best_acc_score: 0.8280; val_best_f1_score: 0.8408; train_kl_reg_loss: 74780.3925; train_edge_recon_loss: 662636.7112; train_gene_expr_recon_loss: 20589086.3333; train_masked_gp_l1_reg_loss: 110697.9712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138060.0166; train_chrom_access_recon_loss: 6425827.6667; train_global_loss: 28001089.3030; train_optim_loss: 28001089.3030; val_kl_reg_loss: 77925.3105; val_edge_recon_loss: 647964.8672; val_gene_expr_recon_loss: 20412187.5000; val_masked_gp_l1_reg_loss: 112058.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131812.8594; val_chrom_access_recon_loss: 6309120.3750; val_global_loss: 27691067.7500; val_optim_loss: 27691067.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9064; val_auprc_score: 0.8749; val_best_acc_score: 0.8471; val_best_f1_score: 0.8540; train_kl_reg_loss: 81817.6317; train_edge_recon_loss: 636306.8873; train_gene_expr_recon_loss: 20472559.7273; train_masked_gp_l1_reg_loss: 112943.3892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125640.2965; train_chrom_access_recon_loss: 6396055.2652; train_global_loss: 27825323.3030; train_optim_loss: 27825323.3030; val_kl_reg_loss: 82768.6025; val_edge_recon_loss: 639482.6484; val_gene_expr_recon_loss: 20060020.5000; val_masked_gp_l1_reg_loss: 113847.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120278.9609; val_chrom_access_recon_loss: 6277553.6875; val_global_loss: 27293951.7500; val_optim_loss: 27293951.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9124; val_auprc_score: 0.8885; val_best_acc_score: 0.8450; val_best_f1_score: 0.8544; train_kl_reg_loss: 82984.3498; train_edge_recon_loss: 626342.9763; train_gene_expr_recon_loss: 20384464.9394; train_masked_gp_l1_reg_loss: 114663.7616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115304.5703; train_chrom_access_recon_loss: 6367995.3939; train_global_loss: 27691756.0303; train_optim_loss: 27691756.0303; val_kl_reg_loss: 80980.1074; val_edge_recon_loss: 624945.6484; val_gene_expr_recon_loss: 20049904.7500; val_masked_gp_l1_reg_loss: 115282.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111582.1328; val_chrom_access_recon_loss: 6239212.6250; val_global_loss: 27221907.2500; val_optim_loss: 27221907.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9130; val_auprc_score: 0.8824; val_best_acc_score: 0.8546; val_best_f1_score: 0.8624; train_kl_reg_loss: 81527.1392; train_edge_recon_loss: 619349.5066; train_gene_expr_recon_loss: 20292261.6667; train_masked_gp_l1_reg_loss: 115972.3772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107877.8474; train_chrom_access_recon_loss: 6348350.6288; train_global_loss: 27565339.2424; train_optim_loss: 27565339.2424; val_kl_reg_loss: 80661.6318; val_edge_recon_loss: 624148.2344; val_gene_expr_recon_loss: 20070796.0000; val_masked_gp_l1_reg_loss: 116496.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104361.1875; val_chrom_access_recon_loss: 6230777.3125; val_global_loss: 27227240.7500; val_optim_loss: 27227240.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9110; val_auprc_score: 0.8703; val_best_acc_score: 0.8568; val_best_f1_score: 0.8661; train_kl_reg_loss: 81164.9850; train_edge_recon_loss: 614083.3902; train_gene_expr_recon_loss: 20219536.9091; train_masked_gp_l1_reg_loss: 117042.0540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102214.3132; train_chrom_access_recon_loss: 6323963.9394; train_global_loss: 27458005.4848; train_optim_loss: 27458005.4848; val_kl_reg_loss: 78941.2139; val_edge_recon_loss: 620520.4531; val_gene_expr_recon_loss: 19958047.5000; val_masked_gp_l1_reg_loss: 117634.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100142.7266; val_chrom_access_recon_loss: 6151419.1875; val_global_loss: 27026704.0000; val_optim_loss: 27026704.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9198; val_auprc_score: 0.8904; val_best_acc_score: 0.8587; val_best_f1_score: 0.8655; train_kl_reg_loss: 79723.1166; train_edge_recon_loss: 613059.2576; train_gene_expr_recon_loss: 20156026.9697; train_masked_gp_l1_reg_loss: 118012.4369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98236.8741; train_chrom_access_recon_loss: 6310167.7197; train_global_loss: 27375226.3636; train_optim_loss: 27375226.3636; val_kl_reg_loss: 78720.2109; val_edge_recon_loss: 612382.9922; val_gene_expr_recon_loss: 20016707.5000; val_masked_gp_l1_reg_loss: 118485.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96244.2109; val_chrom_access_recon_loss: 6225561.8125; val_global_loss: 27148103.0000; val_optim_loss: 27148103.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9207; val_auprc_score: 0.8886; val_best_acc_score: 0.8678; val_best_f1_score: 0.8752; train_kl_reg_loss: 78752.1679; train_edge_recon_loss: 610005.4081; train_gene_expr_recon_loss: 20076536.6970; train_masked_gp_l1_reg_loss: 118691.8862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95281.5651; train_chrom_access_recon_loss: 6281975.2424; train_global_loss: 27261242.7576; train_optim_loss: 27261242.7576; val_kl_reg_loss: 77471.4736; val_edge_recon_loss: 610405.1250; val_gene_expr_recon_loss: 19868903.0000; val_masked_gp_l1_reg_loss: 119071.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94288.2266; val_chrom_access_recon_loss: 6204906.6875; val_global_loss: 26975046.7500; val_optim_loss: 26975046.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9252; val_auprc_score: 0.9006; val_best_acc_score: 0.8673; val_best_f1_score: 0.8749; train_kl_reg_loss: 77848.9808; train_edge_recon_loss: 608586.3362; train_gene_expr_recon_loss: 20025102.9091; train_masked_gp_l1_reg_loss: 119544.6805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93598.1348; train_chrom_access_recon_loss: 6269824.4242; train_global_loss: 27194505.3030; train_optim_loss: 27194505.3030; val_kl_reg_loss: 76553.5557; val_edge_recon_loss: 614100.9922; val_gene_expr_recon_loss: 19621732.7500; val_masked_gp_l1_reg_loss: 119877.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93135.3984; val_chrom_access_recon_loss: 6145499.7500; val_global_loss: 26670901.5000; val_optim_loss: 26670901.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9300; val_auprc_score: 0.9122; val_best_acc_score: 0.8708; val_best_f1_score: 0.8773; train_kl_reg_loss: 77079.1374; train_edge_recon_loss: 606369.1572; train_gene_expr_recon_loss: 19953107.9697; train_masked_gp_l1_reg_loss: 120106.7835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92852.1384; train_chrom_access_recon_loss: 6246309.2803; train_global_loss: 27095824.4848; train_optim_loss: 27095824.4848; val_kl_reg_loss: 76380.0156; val_edge_recon_loss: 608661.9531; val_gene_expr_recon_loss: 19879163.0000; val_masked_gp_l1_reg_loss: 120118.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92544.0078; val_chrom_access_recon_loss: 6178494.4375; val_global_loss: 26955361.5000; val_optim_loss: 26955361.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9317; val_auprc_score: 0.9058; val_best_acc_score: 0.8721; val_best_f1_score: 0.8785; train_kl_reg_loss: 76306.9052; train_edge_recon_loss: 604911.4650; train_gene_expr_recon_loss: 19891672.5758; train_masked_gp_l1_reg_loss: 120579.7962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91995.0304; train_chrom_access_recon_loss: 6226973.8939; train_global_loss: 27012439.6364; train_optim_loss: 27012439.6364; val_kl_reg_loss: 75250.3369; val_edge_recon_loss: 607341.4453; val_gene_expr_recon_loss: 19631693.0000; val_masked_gp_l1_reg_loss: 121054.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92101.3047; val_chrom_access_recon_loss: 6155716.7500; val_global_loss: 26683157.0000; val_optim_loss: 26683157.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9316; val_auprc_score: 0.9082; val_best_acc_score: 0.8745; val_best_f1_score: 0.8817; train_kl_reg_loss: 75837.9289; train_edge_recon_loss: 602791.3797; train_gene_expr_recon_loss: 19817976.4848; train_masked_gp_l1_reg_loss: 121203.2077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91361.4892; train_chrom_access_recon_loss: 6207003.6591; train_global_loss: 26916174.3333; train_optim_loss: 26916174.3333; val_kl_reg_loss: 75378.7637; val_edge_recon_loss: 610455.2266; val_gene_expr_recon_loss: 19677951.2500; val_masked_gp_l1_reg_loss: 121742.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91115.1953; val_chrom_access_recon_loss: 6195735.5000; val_global_loss: 26772378.7500; val_optim_loss: 26772378.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9301; val_auprc_score: 0.9068; val_best_acc_score: 0.8675; val_best_f1_score: 0.8743; train_kl_reg_loss: 75355.8965; train_edge_recon_loss: 601030.2812; train_gene_expr_recon_loss: 19794197.9697; train_masked_gp_l1_reg_loss: 121706.4954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90335.4954; train_chrom_access_recon_loss: 6191114.2500; train_global_loss: 26873740.4848; train_optim_loss: 26873740.4848; val_kl_reg_loss: 73677.8096; val_edge_recon_loss: 612262.4141; val_gene_expr_recon_loss: 19560800.7500; val_masked_gp_l1_reg_loss: 122014.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90096.0312; val_chrom_access_recon_loss: 6100598.1250; val_global_loss: 26559449.0000; val_optim_loss: 26559449.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9357; val_auprc_score: 0.9141; val_best_acc_score: 0.8735; val_best_f1_score: 0.8812; train_kl_reg_loss: 74674.8951; train_edge_recon_loss: 600981.1979; train_gene_expr_recon_loss: 19722836.4848; train_masked_gp_l1_reg_loss: 122174.5945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89204.9813; train_chrom_access_recon_loss: 6164179.0530; train_global_loss: 26774051.3939; train_optim_loss: 26774051.3939; val_kl_reg_loss: 72583.8848; val_edge_recon_loss: 602552.9219; val_gene_expr_recon_loss: 19493826.2500; val_masked_gp_l1_reg_loss: 122629.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88688.6016; val_chrom_access_recon_loss: 6040622.0000; val_global_loss: 26420903.0000; val_optim_loss: 26420903.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9317; val_auprc_score: 0.9105; val_best_acc_score: 0.8694; val_best_f1_score: 0.8777; train_kl_reg_loss: 73926.2926; train_edge_recon_loss: 601165.6723; train_gene_expr_recon_loss: 19677960.8788; train_masked_gp_l1_reg_loss: 122825.0138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88193.4318; train_chrom_access_recon_loss: 6150620.5152; train_global_loss: 26714691.9394; train_optim_loss: 26714691.9394; val_kl_reg_loss: 74175.6592; val_edge_recon_loss: 612584.8516; val_gene_expr_recon_loss: 19604979.0000; val_masked_gp_l1_reg_loss: 123134.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87789.4688; val_chrom_access_recon_loss: 6015693.4375; val_global_loss: 26518357.2500; val_optim_loss: 26518357.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9390; val_auprc_score: 0.9217; val_best_acc_score: 0.8769; val_best_f1_score: 0.8832; train_kl_reg_loss: 73478.3435; train_edge_recon_loss: 600213.5701; train_gene_expr_recon_loss: 19637151.5455; train_masked_gp_l1_reg_loss: 123242.0335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87235.6579; train_chrom_access_recon_loss: 6136405.8485; train_global_loss: 26657727.1515; train_optim_loss: 26657727.1515; val_kl_reg_loss: 73982.8633; val_edge_recon_loss: 608069.9922; val_gene_expr_recon_loss: 19357358.2500; val_masked_gp_l1_reg_loss: 123452.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87221.1250; val_chrom_access_recon_loss: 5959181.7500; val_global_loss: 26209266.7500; val_optim_loss: 26209266.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9351; val_auprc_score: 0.9121; val_best_acc_score: 0.8778; val_best_f1_score: 0.8848; train_kl_reg_loss: 73285.1370; train_edge_recon_loss: 597648.0540; train_gene_expr_recon_loss: 19585812.6970; train_masked_gp_l1_reg_loss: 123614.5046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86301.5954; train_chrom_access_recon_loss: 6119459.0000; train_global_loss: 26586120.9394; train_optim_loss: 26586120.9394; val_kl_reg_loss: 73067.3408; val_edge_recon_loss: 603541.8672; val_gene_expr_recon_loss: 19302710.7500; val_masked_gp_l1_reg_loss: 124092.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86352.7188; val_chrom_access_recon_loss: 6100467.5000; val_global_loss: 26290231.2500; val_optim_loss: 26290231.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9394; val_auprc_score: 0.9211; val_best_acc_score: 0.8775; val_best_f1_score: 0.8839; train_kl_reg_loss: 72820.3227; train_edge_recon_loss: 597180.9290; train_gene_expr_recon_loss: 19540527.6364; train_masked_gp_l1_reg_loss: 124172.1136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85521.7191; train_chrom_access_recon_loss: 6101123.7576; train_global_loss: 26521346.4848; train_optim_loss: 26521346.4848; val_kl_reg_loss: 73190.5996; val_edge_recon_loss: 605925.1484; val_gene_expr_recon_loss: 19559379.2500; val_masked_gp_l1_reg_loss: 124436.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84982.0703; val_chrom_access_recon_loss: 6095615.4375; val_global_loss: 26543528.5000; val_optim_loss: 26543528.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9382; val_auprc_score: 0.9187; val_best_acc_score: 0.8759; val_best_f1_score: 0.8829; train_kl_reg_loss: 72707.1366; train_edge_recon_loss: 596069.8106; train_gene_expr_recon_loss: 19520538.5758; train_masked_gp_l1_reg_loss: 124564.7071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84728.5469; train_chrom_access_recon_loss: 6088825.0909; train_global_loss: 26487433.6061; train_optim_loss: 26487433.6061; val_kl_reg_loss: 71331.5645; val_edge_recon_loss: 608136.6406; val_gene_expr_recon_loss: 19349650.0000; val_masked_gp_l1_reg_loss: 124818.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84444.5000; val_chrom_access_recon_loss: 6014479.8125; val_global_loss: 26252859.7500; val_optim_loss: 26252859.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9448; val_auprc_score: 0.9289; val_best_acc_score: 0.8904; val_best_f1_score: 0.8952; train_kl_reg_loss: 72163.8978; train_edge_recon_loss: 595804.6534; train_gene_expr_recon_loss: 19474740.6970; train_masked_gp_l1_reg_loss: 125098.0160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84184.1263; train_chrom_access_recon_loss: 6078361.9545; train_global_loss: 26430353.0303; train_optim_loss: 26430353.0303; val_kl_reg_loss: 71809.4434; val_edge_recon_loss: 598948.7344; val_gene_expr_recon_loss: 19337269.5000; val_masked_gp_l1_reg_loss: 125196.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83704.2109; val_chrom_access_recon_loss: 5999677.2500; val_global_loss: 26216604.5000; val_optim_loss: 26216604.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9355; val_auprc_score: 0.9101; val_best_acc_score: 0.8708; val_best_f1_score: 0.8749; train_kl_reg_loss: 68022.2975; train_edge_recon_loss: 751669.3097; train_gene_expr_recon_loss: 18117666.6667; train_masked_gp_l1_reg_loss: 120352.8356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63645.9366; train_chrom_access_recon_loss: 5978490.7500; train_global_loss: 25099848.0000; train_optim_loss: 25099848.0000; val_kl_reg_loss: 31877.0400; val_edge_recon_loss: 766292.6016; val_gene_expr_recon_loss: 17757059.0000; val_masked_gp_l1_reg_loss: 118295.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58844.4062; val_chrom_access_recon_loss: 5633631.4375; val_global_loss: 24366000.2500; val_optim_loss: 24366000.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9335; val_auprc_score: 0.9079; val_best_acc_score: 0.8775; val_best_f1_score: 0.8830; train_kl_reg_loss: 59926.6123; train_edge_recon_loss: 736614.5521; train_gene_expr_recon_loss: 17983685.9697; train_masked_gp_l1_reg_loss: 117659.3926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58884.3791; train_chrom_access_recon_loss: 5715810.4773; train_global_loss: 24672581.5455; train_optim_loss: 24672581.5455; val_kl_reg_loss: 33864.4033; val_edge_recon_loss: 771345.2734; val_gene_expr_recon_loss: 17842332.7500; val_masked_gp_l1_reg_loss: 117089.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59093.9609; val_chrom_access_recon_loss: 5609756.7500; val_global_loss: 24433483.0000; val_optim_loss: 24433483.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9317; val_auprc_score: 0.9100; val_best_acc_score: 0.8745; val_best_f1_score: 0.8802; train_kl_reg_loss: 64434.6413; train_edge_recon_loss: 725638.0616; train_gene_expr_recon_loss: 17955442.8788; train_masked_gp_l1_reg_loss: 116500.1071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59081.4721; train_chrom_access_recon_loss: 5692789.1439; train_global_loss: 24613886.4545; train_optim_loss: 24613886.4545; val_kl_reg_loss: 35975.2466; val_edge_recon_loss: 773049.7891; val_gene_expr_recon_loss: 17737655.5000; val_masked_gp_l1_reg_loss: 115864.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59062.3047; val_chrom_access_recon_loss: 5586957.2500; val_global_loss: 24308563.7500; val_optim_loss: 24308563.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9346; val_auprc_score: 0.9134; val_best_acc_score: 0.8716; val_best_f1_score: 0.8780; train_kl_reg_loss: 61776.0443; train_edge_recon_loss: 729173.8627; train_gene_expr_recon_loss: 17934262.8182; train_masked_gp_l1_reg_loss: 115301.9860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58952.5324; train_chrom_access_recon_loss: 5674200.4394; train_global_loss: 24573667.8182; train_optim_loss: 24573667.8182; val_kl_reg_loss: 35441.4805; val_edge_recon_loss: 772727.4219; val_gene_expr_recon_loss: 17816483.7500; val_masked_gp_l1_reg_loss: 114772.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58892.6523; val_chrom_access_recon_loss: 5625516.8125; val_global_loss: 24423833.2500; val_optim_loss: 24423833.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9353; val_auprc_score: 0.9175; val_best_acc_score: 0.8753; val_best_f1_score: 0.8811; train_kl_reg_loss: 61100.3747; train_edge_recon_loss: 726137.1714; train_gene_expr_recon_loss: 17921437.9697; train_masked_gp_l1_reg_loss: 114212.4776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58707.5219; train_chrom_access_recon_loss: 5666353.1515; train_global_loss: 24547948.8485; train_optim_loss: 24547948.8485; val_kl_reg_loss: 34833.8008; val_edge_recon_loss: 775705.0234; val_gene_expr_recon_loss: 17605233.8750; val_masked_gp_l1_reg_loss: 113646.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58562.2383; val_chrom_access_recon_loss: 5512544.9375; val_global_loss: 24100525.7500; val_optim_loss: 24100525.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9318; val_auprc_score: 0.9129; val_best_acc_score: 0.8638; val_best_f1_score: 0.8708; train_kl_reg_loss: 59755.5534; train_edge_recon_loss: 724116.8778; train_gene_expr_recon_loss: 17922624.6970; train_masked_gp_l1_reg_loss: 113111.1089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58358.5198; train_chrom_access_recon_loss: 5664314.6061; train_global_loss: 24542281.2727; train_optim_loss: 24542281.2727; val_kl_reg_loss: 36511.7983; val_edge_recon_loss: 774694.7500; val_gene_expr_recon_loss: 17738132.5000; val_masked_gp_l1_reg_loss: 112554.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58226.3945; val_chrom_access_recon_loss: 5590141.1250; val_global_loss: 24310259.7500; val_optim_loss: 24310259.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9362; val_auprc_score: 0.9161; val_best_acc_score: 0.8740; val_best_f1_score: 0.8789; train_kl_reg_loss: 59004.5160; train_edge_recon_loss: 723774.8854; train_gene_expr_recon_loss: 17916329.6667; train_masked_gp_l1_reg_loss: 112012.3849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58061.8100; train_chrom_access_recon_loss: 5659169.6515; train_global_loss: 24528353.1818; train_optim_loss: 24528353.1818; val_kl_reg_loss: 35849.7837; val_edge_recon_loss: 772147.4688; val_gene_expr_recon_loss: 17770250.2500; val_masked_gp_l1_reg_loss: 111484.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57904.9727; val_chrom_access_recon_loss: 5542196.5000; val_global_loss: 24289831.7500; val_optim_loss: 24289831.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9325; val_auprc_score: 0.9128; val_best_acc_score: 0.8686; val_best_f1_score: 0.8735; train_kl_reg_loss: 57829.8278; train_edge_recon_loss: 722739.4081; train_gene_expr_recon_loss: 17900340.4242; train_masked_gp_l1_reg_loss: 110960.7470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57700.8910; train_chrom_access_recon_loss: 5660817.3864; train_global_loss: 24510388.4545; train_optim_loss: 24510388.4545; val_kl_reg_loss: 34581.9224; val_edge_recon_loss: 771465.9766; val_gene_expr_recon_loss: 17749969.0000; val_masked_gp_l1_reg_loss: 110425.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57544.1758; val_chrom_access_recon_loss: 5573362.0000; val_global_loss: 24297349.0000; val_optim_loss: 24297349.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9258; val_auprc_score: 0.9019; val_best_acc_score: 0.8589; val_best_f1_score: 0.8652; train_kl_reg_loss: 56561.0602; train_edge_recon_loss: 721839.9508; train_gene_expr_recon_loss: 17909688.2727; train_masked_gp_l1_reg_loss: 109923.3558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57402.2499; train_chrom_access_recon_loss: 5653914.6894; train_global_loss: 24509329.5152; train_optim_loss: 24509329.5152; val_kl_reg_loss: 36811.0786; val_edge_recon_loss: 770765.3438; val_gene_expr_recon_loss: 17760498.2500; val_masked_gp_l1_reg_loss: 109453.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57267.5625; val_chrom_access_recon_loss: 5560965.7500; val_global_loss: 24295762.5000; val_optim_loss: 24295762.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9288; val_auprc_score: 0.9080; val_best_acc_score: 0.8624; val_best_f1_score: 0.8671; train_kl_reg_loss: 56408.1773; train_edge_recon_loss: 720846.8561; train_gene_expr_recon_loss: 17881278.5455; train_masked_gp_l1_reg_loss: 109144.5971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55938.2225; train_chrom_access_recon_loss: 5646267.2652; train_global_loss: 24469883.7879; train_optim_loss: 24469883.7879; val_kl_reg_loss: 36327.6240; val_edge_recon_loss: 770772.1172; val_gene_expr_recon_loss: 17727601.5000; val_masked_gp_l1_reg_loss: 109001.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55645.7031; val_chrom_access_recon_loss: 5543477.6250; val_global_loss: 24242827.0000; val_optim_loss: 24242827.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9238; val_auprc_score: 0.8971; val_best_acc_score: 0.8627; val_best_f1_score: 0.8675; train_kl_reg_loss: 56196.8394; train_edge_recon_loss: 721431.8826; train_gene_expr_recon_loss: 17881218.9697; train_masked_gp_l1_reg_loss: 108926.4061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55594.8919; train_chrom_access_recon_loss: 5644044.5833; train_global_loss: 24467413.7273; train_optim_loss: 24467413.7273; val_kl_reg_loss: 36316.3892; val_edge_recon_loss: 770371.3438; val_gene_expr_recon_loss: 17699193.5000; val_masked_gp_l1_reg_loss: 108853.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55548.7461; val_chrom_access_recon_loss: 5584902.6250; val_global_loss: 24255186.5000; val_optim_loss: 24255186.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9360; val_auprc_score: 0.9163; val_best_acc_score: 0.8713; val_best_f1_score: 0.8745; train_kl_reg_loss: 56461.3632; train_edge_recon_loss: 720670.8551; train_gene_expr_recon_loss: 17891056.3333; train_masked_gp_l1_reg_loss: 108790.4556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55514.6527; train_chrom_access_recon_loss: 5646965.8636; train_global_loss: 24479459.6061; train_optim_loss: 24479459.6061; val_kl_reg_loss: 36250.3164; val_edge_recon_loss: 768273.4375; val_gene_expr_recon_loss: 17604856.5000; val_masked_gp_l1_reg_loss: 108728.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55474.5273; val_chrom_access_recon_loss: 5563035.9375; val_global_loss: 24136618.2500; val_optim_loss: 24136618.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9372; val_auprc_score: 0.9215; val_best_acc_score: 0.8732; val_best_f1_score: 0.8764; train_kl_reg_loss: 55554.2509; train_edge_recon_loss: 722434.7083; train_gene_expr_recon_loss: 17897987.0303; train_masked_gp_l1_reg_loss: 108673.7998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55446.7230; train_chrom_access_recon_loss: 5652626.4697; train_global_loss: 24492722.9394; train_optim_loss: 24492722.9394; val_kl_reg_loss: 36011.2246; val_edge_recon_loss: 769747.6953; val_gene_expr_recon_loss: 17717692.2500; val_masked_gp_l1_reg_loss: 108618.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55422.4609; val_chrom_access_recon_loss: 5599138.8125; val_global_loss: 24286630.2500; val_optim_loss: 24286630.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 12 min 17 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9311
val AUPRC score: 0.9127
val best accuracy score: 0.8716
val best F1 score: 0.8780
val target rna MSE score: 1.8837
val source rna MSE score: 1.6159
val target atac MSE score: 0.3107
val source atac MSE score: 0.1344
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
