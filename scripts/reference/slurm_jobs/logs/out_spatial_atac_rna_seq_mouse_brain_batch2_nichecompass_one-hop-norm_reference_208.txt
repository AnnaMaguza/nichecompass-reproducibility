[True]
Run timestamp: 08082023_081152_208.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_208']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7034; val_auprc_score: 0.7277; val_best_acc_score: 0.5601; val_best_f1_score: 0.6771; train_kl_reg_loss: 11571.5494; train_edge_recon_loss: 353630.6785; train_gene_expr_recon_loss: 851452.6979; train_masked_gp_l1_reg_loss: 4468.5347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105154.2643; train_chrom_access_recon_loss: 490794.1108; train_global_loss: 1817071.8428; train_optim_loss: 1817071.8428; val_kl_reg_loss: 17332.6577; val_edge_recon_loss: 405894.1758; val_gene_expr_recon_loss: 703417.4062; val_masked_gp_l1_reg_loss: 4767.7305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85716.8906; val_chrom_access_recon_loss: 455882.6602; val_global_loss: 1673011.5156; val_optim_loss: 1673011.5156
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7596; val_auprc_score: 0.7699; val_best_acc_score: 0.6896; val_best_f1_score: 0.7031; train_kl_reg_loss: 17971.4925; train_edge_recon_loss: 357435.6937; train_gene_expr_recon_loss: 687488.4612; train_masked_gp_l1_reg_loss: 4825.1384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67172.5741; train_chrom_access_recon_loss: 452306.4337; train_global_loss: 1587199.7917; train_optim_loss: 1587199.7917; val_kl_reg_loss: 19890.0674; val_edge_recon_loss: 401740.4531; val_gene_expr_recon_loss: 670284.0391; val_masked_gp_l1_reg_loss: 4881.5366; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50392.5391; val_chrom_access_recon_loss: 448377.5625; val_global_loss: 1595566.1250; val_optim_loss: 1595566.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8213; val_auprc_score: 0.8194; val_best_acc_score: 0.7250; val_best_f1_score: 0.7575; train_kl_reg_loss: 18704.3444; train_edge_recon_loss: 343024.4626; train_gene_expr_recon_loss: 668369.3902; train_masked_gp_l1_reg_loss: 4957.0136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39274.0488; train_chrom_access_recon_loss: 446599.3007; train_global_loss: 1520928.5473; train_optim_loss: 1520928.5473; val_kl_reg_loss: 23438.5640; val_edge_recon_loss: 322605.1562; val_gene_expr_recon_loss: 668983.8438; val_masked_gp_l1_reg_loss: 5066.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30267.4297; val_chrom_access_recon_loss: 449574.6406; val_global_loss: 1499936.1406; val_optim_loss: 1499936.1406
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8776; val_auprc_score: 0.8664; val_best_acc_score: 0.7940; val_best_f1_score: 0.8011; train_kl_reg_loss: 23330.2444; train_edge_recon_loss: 310884.6098; train_gene_expr_recon_loss: 661181.8759; train_masked_gp_l1_reg_loss: 5168.0349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24820.3528; train_chrom_access_recon_loss: 442920.1283; train_global_loss: 1468305.2330; train_optim_loss: 1468305.2330; val_kl_reg_loss: 22440.8079; val_edge_recon_loss: 306962.6602; val_gene_expr_recon_loss: 655819.7109; val_masked_gp_l1_reg_loss: 5277.9302; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20271.2910; val_chrom_access_recon_loss: 444284.1914; val_global_loss: 1455056.6094; val_optim_loss: 1455056.6094
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9192; val_auprc_score: 0.9013; val_best_acc_score: 0.8486; val_best_f1_score: 0.8575; train_kl_reg_loss: 22833.4644; train_edge_recon_loss: 300451.2680; train_gene_expr_recon_loss: 654229.2661; train_masked_gp_l1_reg_loss: 5392.0876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17381.9567; train_chrom_access_recon_loss: 438848.6780; train_global_loss: 1439136.7140; train_optim_loss: 1439136.7140; val_kl_reg_loss: 23015.5259; val_edge_recon_loss: 298147.2695; val_gene_expr_recon_loss: 648550.5469; val_masked_gp_l1_reg_loss: 5522.5742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14932.7197; val_chrom_access_recon_loss: 439780.4531; val_global_loss: 1429949.1094; val_optim_loss: 1429949.1094
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9377; val_auprc_score: 0.9240; val_best_acc_score: 0.8709; val_best_f1_score: 0.8788; train_kl_reg_loss: 23925.4535; train_edge_recon_loss: 292652.9872; train_gene_expr_recon_loss: 648193.6506; train_masked_gp_l1_reg_loss: 5622.8715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13226.2293; train_chrom_access_recon_loss: 435008.0573; train_global_loss: 1418629.2538; train_optim_loss: 1418629.2538; val_kl_reg_loss: 24425.7571; val_edge_recon_loss: 290385.1055; val_gene_expr_recon_loss: 638963.6562; val_masked_gp_l1_reg_loss: 5734.7827; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11723.6348; val_chrom_access_recon_loss: 429847.7422; val_global_loss: 1401080.7344; val_optim_loss: 1401080.7344
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9429; val_auprc_score: 0.9282; val_best_acc_score: 0.8777; val_best_f1_score: 0.8860; train_kl_reg_loss: 23722.8118; train_edge_recon_loss: 289177.0871; train_gene_expr_recon_loss: 642983.3845; train_masked_gp_l1_reg_loss: 5812.9724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10628.7696; train_chrom_access_recon_loss: 431324.7135; train_global_loss: 1403649.7481; train_optim_loss: 1403649.7481; val_kl_reg_loss: 23464.3459; val_edge_recon_loss: 288582.2539; val_gene_expr_recon_loss: 639452.8516; val_masked_gp_l1_reg_loss: 5896.3701; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9663.4141; val_chrom_access_recon_loss: 431402.8906; val_global_loss: 1398462.1562; val_optim_loss: 1398462.1562
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9505; val_auprc_score: 0.9389; val_best_acc_score: 0.8871; val_best_f1_score: 0.8917; train_kl_reg_loss: 23315.8760; train_edge_recon_loss: 287504.1449; train_gene_expr_recon_loss: 638160.9508; train_masked_gp_l1_reg_loss: 5959.9748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8928.7032; train_chrom_access_recon_loss: 428525.8466; train_global_loss: 1392395.4981; train_optim_loss: 1392395.4981; val_kl_reg_loss: 23141.6484; val_edge_recon_loss: 287921.9531; val_gene_expr_recon_loss: 633254.7266; val_masked_gp_l1_reg_loss: 6043.9385; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8287.1494; val_chrom_access_recon_loss: 427956.5781; val_global_loss: 1386605.9844; val_optim_loss: 1386605.9844
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9590; val_auprc_score: 0.9472; val_best_acc_score: 0.9018; val_best_f1_score: 0.9066; train_kl_reg_loss: 22816.4260; train_edge_recon_loss: 286507.5076; train_gene_expr_recon_loss: 634663.6439; train_masked_gp_l1_reg_loss: 6101.8887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7773.2840; train_chrom_access_recon_loss: 426252.9384; train_global_loss: 1384115.6799; train_optim_loss: 1384115.6799; val_kl_reg_loss: 22246.9448; val_edge_recon_loss: 285053.6797; val_gene_expr_recon_loss: 626736.8516; val_masked_gp_l1_reg_loss: 6163.3809; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7320.5723; val_chrom_access_recon_loss: 424535.6758; val_global_loss: 1372057.1094; val_optim_loss: 1372057.1094
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9584; val_auprc_score: 0.9472; val_best_acc_score: 0.9033; val_best_f1_score: 0.9081; train_kl_reg_loss: 22384.2967; train_edge_recon_loss: 284800.4370; train_gene_expr_recon_loss: 630824.5161; train_masked_gp_l1_reg_loss: 6216.6367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6971.4043; train_chrom_access_recon_loss: 423378.5232; train_global_loss: 1374575.8277; train_optim_loss: 1374575.8277; val_kl_reg_loss: 22354.0103; val_edge_recon_loss: 284434.2852; val_gene_expr_recon_loss: 624819.3672; val_masked_gp_l1_reg_loss: 6276.0986; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6663.4326; val_chrom_access_recon_loss: 420220.7383; val_global_loss: 1364767.9531; val_optim_loss: 1364767.9531
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9606; val_auprc_score: 0.9505; val_best_acc_score: 0.9099; val_best_f1_score: 0.9137; train_kl_reg_loss: 21997.4281; train_edge_recon_loss: 283889.0952; train_gene_expr_recon_loss: 627402.0066; train_masked_gp_l1_reg_loss: 6332.1721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6407.9975; train_chrom_access_recon_loss: 421418.2940; train_global_loss: 1367447.0019; train_optim_loss: 1367447.0019; val_kl_reg_loss: 21886.6582; val_edge_recon_loss: 283089.4023; val_gene_expr_recon_loss: 620787.9922; val_masked_gp_l1_reg_loss: 6380.9580; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6190.4404; val_chrom_access_recon_loss: 421321.9102; val_global_loss: 1359657.3438; val_optim_loss: 1359657.3438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9600; val_auprc_score: 0.9444; val_best_acc_score: 0.9108; val_best_f1_score: 0.9146; train_kl_reg_loss: 21648.6304; train_edge_recon_loss: 282691.8210; train_gene_expr_recon_loss: 624303.0369; train_masked_gp_l1_reg_loss: 6426.3566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6020.5803; train_chrom_access_recon_loss: 419287.5734; train_global_loss: 1360377.9962; train_optim_loss: 1360377.9962; val_kl_reg_loss: 21552.8972; val_edge_recon_loss: 282685.8008; val_gene_expr_recon_loss: 626309.9297; val_masked_gp_l1_reg_loss: 6476.8027; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5882.0190; val_chrom_access_recon_loss: 421557.2539; val_global_loss: 1364464.6875; val_optim_loss: 1364464.6875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9680; val_auprc_score: 0.9577; val_best_acc_score: 0.9198; val_best_f1_score: 0.9238; train_kl_reg_loss: 21359.9201; train_edge_recon_loss: 282040.7538; train_gene_expr_recon_loss: 621052.4811; train_masked_gp_l1_reg_loss: 6520.4601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5739.3872; train_chrom_access_recon_loss: 417489.6946; train_global_loss: 1354202.7008; train_optim_loss: 1354202.7008; val_kl_reg_loss: 21131.5100; val_edge_recon_loss: 280465.9180; val_gene_expr_recon_loss: 624109.6172; val_masked_gp_l1_reg_loss: 6565.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5593.8228; val_chrom_access_recon_loss: 420125.3359; val_global_loss: 1357991.6250; val_optim_loss: 1357991.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9684; val_auprc_score: 0.9588; val_best_acc_score: 0.9221; val_best_f1_score: 0.9251; train_kl_reg_loss: 20931.3807; train_edge_recon_loss: 281190.1212; train_gene_expr_recon_loss: 617513.6241; train_masked_gp_l1_reg_loss: 6602.5248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5485.8842; train_chrom_access_recon_loss: 414226.7495; train_global_loss: 1345950.2765; train_optim_loss: 1345950.2765; val_kl_reg_loss: 20941.8809; val_edge_recon_loss: 280505.7266; val_gene_expr_recon_loss: 622754.8125; val_masked_gp_l1_reg_loss: 6641.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5396.3867; val_chrom_access_recon_loss: 419214.2656; val_global_loss: 1355454.6875; val_optim_loss: 1355454.6875
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9686; val_auprc_score: 0.9582; val_best_acc_score: 0.9194; val_best_f1_score: 0.9233; train_kl_reg_loss: 20628.8328; train_edge_recon_loss: 280928.7675; train_gene_expr_recon_loss: 614943.6922; train_masked_gp_l1_reg_loss: 6679.5206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5312.1987; train_chrom_access_recon_loss: 412679.0767; train_global_loss: 1341172.0928; train_optim_loss: 1341172.0928; val_kl_reg_loss: 20019.6003; val_edge_recon_loss: 281226.0508; val_gene_expr_recon_loss: 609381.1562; val_masked_gp_l1_reg_loss: 6716.1357; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5246.9263; val_chrom_access_recon_loss: 410519.1328; val_global_loss: 1333109.0156; val_optim_loss: 1333109.0156
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9720; val_auprc_score: 0.9619; val_best_acc_score: 0.9305; val_best_f1_score: 0.9326; train_kl_reg_loss: 20378.7868; train_edge_recon_loss: 279761.7192; train_gene_expr_recon_loss: 613193.8731; train_masked_gp_l1_reg_loss: 6755.6243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5169.7458; train_chrom_access_recon_loss: 411937.8040; train_global_loss: 1337197.5417; train_optim_loss: 1337197.5417; val_kl_reg_loss: 20689.3633; val_edge_recon_loss: 279466.9414; val_gene_expr_recon_loss: 613628.7656; val_masked_gp_l1_reg_loss: 6794.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5094.2505; val_chrom_access_recon_loss: 413772.1914; val_global_loss: 1339446.0000; val_optim_loss: 1339446.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9726; val_auprc_score: 0.9629; val_best_acc_score: 0.9299; val_best_f1_score: 0.9327; train_kl_reg_loss: 20299.7627; train_edge_recon_loss: 279223.5549; train_gene_expr_recon_loss: 610573.0824; train_masked_gp_l1_reg_loss: 6822.6139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5052.1732; train_chrom_access_recon_loss: 410515.6444; train_global_loss: 1332486.8277; train_optim_loss: 1332486.8277; val_kl_reg_loss: 19964.8831; val_edge_recon_loss: 280272.1016; val_gene_expr_recon_loss: 613016.9844; val_masked_gp_l1_reg_loss: 6857.3286; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5013.7280; val_chrom_access_recon_loss: 412618.7305; val_global_loss: 1337743.7812; val_optim_loss: 1337743.7812
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9750; val_auprc_score: 0.9665; val_best_acc_score: 0.9309; val_best_f1_score: 0.9329; train_kl_reg_loss: 20069.5647; train_edge_recon_loss: 278414.9446; train_gene_expr_recon_loss: 607800.5483; train_masked_gp_l1_reg_loss: 6890.0246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4963.8682; train_chrom_access_recon_loss: 408313.7159; train_global_loss: 1326452.6591; train_optim_loss: 1326452.6591; val_kl_reg_loss: 20459.5308; val_edge_recon_loss: 278586.0742; val_gene_expr_recon_loss: 614744.6719; val_masked_gp_l1_reg_loss: 6916.6152; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4922.4438; val_chrom_access_recon_loss: 409609.7148; val_global_loss: 1335239.0469; val_optim_loss: 1335239.0469
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9779; val_auprc_score: 0.9722; val_best_acc_score: 0.9322; val_best_f1_score: 0.9345; train_kl_reg_loss: 19805.6788; train_edge_recon_loss: 278654.9058; train_gene_expr_recon_loss: 605498.6051; train_masked_gp_l1_reg_loss: 6944.2213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4875.6202; train_chrom_access_recon_loss: 407198.9200; train_global_loss: 1322977.9451; train_optim_loss: 1322977.9451; val_kl_reg_loss: 19700.8115; val_edge_recon_loss: 279143.9219; val_gene_expr_recon_loss: 607769.7734; val_masked_gp_l1_reg_loss: 6978.2783; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4846.7236; val_chrom_access_recon_loss: 407312.3281; val_global_loss: 1325751.8438; val_optim_loss: 1325751.8438
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9774; val_auprc_score: 0.9717; val_best_acc_score: 0.9314; val_best_f1_score: 0.9336; train_kl_reg_loss: 19702.9398; train_edge_recon_loss: 277368.2585; train_gene_expr_recon_loss: 603429.5189; train_masked_gp_l1_reg_loss: 7004.1982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4807.9751; train_chrom_access_recon_loss: 406425.3840; train_global_loss: 1318738.2689; train_optim_loss: 1318738.2689; val_kl_reg_loss: 19682.7844; val_edge_recon_loss: 279324.2500; val_gene_expr_recon_loss: 600082.6484; val_masked_gp_l1_reg_loss: 7026.6807; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4774.4897; val_chrom_access_recon_loss: 407595.4023; val_global_loss: 1318486.2812; val_optim_loss: 1318486.2812
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9816; val_auprc_score: 0.9780; val_best_acc_score: 0.9423; val_best_f1_score: 0.9441; train_kl_reg_loss: 19338.0411; train_edge_recon_loss: 277462.6383; train_gene_expr_recon_loss: 600823.9072; train_masked_gp_l1_reg_loss: 7055.9130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4746.4650; train_chrom_access_recon_loss: 404870.2221; train_global_loss: 1314297.1856; train_optim_loss: 1314297.1856; val_kl_reg_loss: 19309.1140; val_edge_recon_loss: 275463.9492; val_gene_expr_recon_loss: 599863.3047; val_masked_gp_l1_reg_loss: 7078.9897; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4724.1982; val_chrom_access_recon_loss: 402926.7148; val_global_loss: 1309366.2500; val_optim_loss: 1309366.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9806; val_auprc_score: 0.9760; val_best_acc_score: 0.9395; val_best_f1_score: 0.9412; train_kl_reg_loss: 19260.8642; train_edge_recon_loss: 276562.9176; train_gene_expr_recon_loss: 599172.7216; train_masked_gp_l1_reg_loss: 7106.5412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4697.5799; train_chrom_access_recon_loss: 403836.5668; train_global_loss: 1310637.1951; train_optim_loss: 1310637.1951; val_kl_reg_loss: 19319.5015; val_edge_recon_loss: 277382.6836; val_gene_expr_recon_loss: 599892.4922; val_masked_gp_l1_reg_loss: 7132.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4685.4443; val_chrom_access_recon_loss: 407858.2695; val_global_loss: 1316270.9375; val_optim_loss: 1316270.9375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9797; val_auprc_score: 0.9716; val_best_acc_score: 0.9391; val_best_f1_score: 0.9412; train_kl_reg_loss: 19012.5293; train_edge_recon_loss: 276907.4763; train_gene_expr_recon_loss: 596975.2481; train_masked_gp_l1_reg_loss: 7157.8290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4666.3901; train_chrom_access_recon_loss: 402540.2320; train_global_loss: 1307259.7083; train_optim_loss: 1307259.7083; val_kl_reg_loss: 19257.1543; val_edge_recon_loss: 277057.0117; val_gene_expr_recon_loss: 602450.0625; val_masked_gp_l1_reg_loss: 7186.1226; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4644.2324; val_chrom_access_recon_loss: 407204.2891; val_global_loss: 1317798.9062; val_optim_loss: 1317798.9062
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9818; val_auprc_score: 0.9770; val_best_acc_score: 0.9431; val_best_f1_score: 0.9450; train_kl_reg_loss: 18899.1784; train_edge_recon_loss: 276368.2429; train_gene_expr_recon_loss: 594962.4186; train_masked_gp_l1_reg_loss: 7209.2296; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4620.5648; train_chrom_access_recon_loss: 402065.1686; train_global_loss: 1304124.8087; train_optim_loss: 1304124.8087; val_kl_reg_loss: 18743.5195; val_edge_recon_loss: 275659.4336; val_gene_expr_recon_loss: 596543.6172; val_masked_gp_l1_reg_loss: 7234.2520; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4621.0703; val_chrom_access_recon_loss: 403966.7383; val_global_loss: 1306768.6250; val_optim_loss: 1306768.6250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9850; val_auprc_score: 0.9801; val_best_acc_score: 0.9464; val_best_f1_score: 0.9474; train_kl_reg_loss: 18724.6652; train_edge_recon_loss: 275953.3357; train_gene_expr_recon_loss: 592532.2405; train_masked_gp_l1_reg_loss: 7249.8128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4605.4826; train_chrom_access_recon_loss: 400798.3182; train_global_loss: 1299863.8485; train_optim_loss: 1299863.8485; val_kl_reg_loss: 19131.2681; val_edge_recon_loss: 276258.9727; val_gene_expr_recon_loss: 596342.5156; val_masked_gp_l1_reg_loss: 7268.9575; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4591.9385; val_chrom_access_recon_loss: 401298.5898; val_global_loss: 1304892.2188; val_optim_loss: 1304892.2188
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9801; val_auprc_score: 0.9739; val_best_acc_score: 0.9371; val_best_f1_score: 0.9394; train_kl_reg_loss: 14559.3458; train_edge_recon_loss: 274765.1501; train_gene_expr_recon_loss: 929712.2585; train_masked_gp_l1_reg_loss: 7861.1462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3746.6434; train_chrom_access_recon_loss: 434256.2557; train_global_loss: 1664900.7917; train_optim_loss: 1664900.7917; val_kl_reg_loss: 10127.5890; val_edge_recon_loss: 273188.3789; val_gene_expr_recon_loss: 908544.5703; val_masked_gp_l1_reg_loss: 8433.2998; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3053.3101; val_chrom_access_recon_loss: 433463.8398; val_global_loss: 1636810.8750; val_optim_loss: 1636810.8750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9835; val_auprc_score: 0.9804; val_best_acc_score: 0.9423; val_best_f1_score: 0.9436; train_kl_reg_loss: 13125.1708; train_edge_recon_loss: 272014.7936; train_gene_expr_recon_loss: 896904.7992; train_masked_gp_l1_reg_loss: 8718.1709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2580.7651; train_chrom_access_recon_loss: 432074.0540; train_global_loss: 1625417.7500; train_optim_loss: 1625417.7500; val_kl_reg_loss: 10572.5599; val_edge_recon_loss: 273375.4453; val_gene_expr_recon_loss: 876091.2344; val_masked_gp_l1_reg_loss: 8946.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2142.3743; val_chrom_access_recon_loss: 429555.0000; val_global_loss: 1600683.5000; val_optim_loss: 1600683.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9847; val_auprc_score: 0.9807; val_best_acc_score: 0.9444; val_best_f1_score: 0.9461; train_kl_reg_loss: 12805.6445; train_edge_recon_loss: 270648.0350; train_gene_expr_recon_loss: 877948.9886; train_masked_gp_l1_reg_loss: 9093.1951; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1811.9420; train_chrom_access_recon_loss: 431109.9957; train_global_loss: 1603417.8201; train_optim_loss: 1603417.8201; val_kl_reg_loss: 10915.0114; val_edge_recon_loss: 271353.2773; val_gene_expr_recon_loss: 866542.2422; val_masked_gp_l1_reg_loss: 9220.4248; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1527.1141; val_chrom_access_recon_loss: 432122.1445; val_global_loss: 1591680.1875; val_optim_loss: 1591680.1875
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9858; val_auprc_score: 0.9797; val_best_acc_score: 0.9488; val_best_f1_score: 0.9505; train_kl_reg_loss: 12631.2528; train_edge_recon_loss: 271040.4257; train_gene_expr_recon_loss: 863563.8627; train_masked_gp_l1_reg_loss: 9312.9687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1358.8801; train_chrom_access_recon_loss: 430276.9205; train_global_loss: 1588184.3106; train_optim_loss: 1588184.3106; val_kl_reg_loss: 10809.4362; val_edge_recon_loss: 271764.8047; val_gene_expr_recon_loss: 862386.1562; val_masked_gp_l1_reg_loss: 9394.2393; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1219.0123; val_chrom_access_recon_loss: 436757.0977; val_global_loss: 1592330.7344; val_optim_loss: 1592330.7344

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9849; val_auprc_score: 0.9814; val_best_acc_score: 0.9456; val_best_f1_score: 0.9473; train_kl_reg_loss: 12583.6267; train_edge_recon_loss: 270810.5824; train_gene_expr_recon_loss: 856957.4091; train_masked_gp_l1_reg_loss: 9367.4153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1088.6009; train_chrom_access_recon_loss: 430548.1690; train_global_loss: 1581355.8011; train_optim_loss: 1581355.8011; val_kl_reg_loss: 10981.3730; val_edge_recon_loss: 270055.1758; val_gene_expr_recon_loss: 860150.8047; val_masked_gp_l1_reg_loss: 9365.7285; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1056.8907; val_chrom_access_recon_loss: 432368.5703; val_global_loss: 1583978.5469; val_optim_loss: 1583978.5469
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9851; val_auprc_score: 0.9801; val_best_acc_score: 0.9491; val_best_f1_score: 0.9506; train_kl_reg_loss: 12592.9946; train_edge_recon_loss: 270536.6572; train_gene_expr_recon_loss: 854932.4678; train_masked_gp_l1_reg_loss: 9370.8064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1045.4895; train_chrom_access_recon_loss: 429862.3660; train_global_loss: 1578340.7879; train_optim_loss: 1578340.7879; val_kl_reg_loss: 11014.0688; val_edge_recon_loss: 270800.3555; val_gene_expr_recon_loss: 858304.6641; val_masked_gp_l1_reg_loss: 9376.8760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1034.1238; val_chrom_access_recon_loss: 431340.3477; val_global_loss: 1581870.4375; val_optim_loss: 1581870.4375
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9837; val_auprc_score: 0.9793; val_best_acc_score: 0.9495; val_best_f1_score: 0.9510; train_kl_reg_loss: 12474.9877; train_edge_recon_loss: 269924.1766; train_gene_expr_recon_loss: 853220.5133; train_masked_gp_l1_reg_loss: 9382.9551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1022.8768; train_chrom_access_recon_loss: 429170.3608; train_global_loss: 1575195.8542; train_optim_loss: 1575195.8542; val_kl_reg_loss: 11164.5461; val_edge_recon_loss: 272670.5898; val_gene_expr_recon_loss: 849781.5391; val_masked_gp_l1_reg_loss: 9389.3623; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1011.2798; val_chrom_access_recon_loss: 429144.4727; val_global_loss: 1573161.7969; val_optim_loss: 1573161.7969
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9857; val_auprc_score: 0.9808; val_best_acc_score: 0.9491; val_best_f1_score: 0.9501; train_kl_reg_loss: 12461.8849; train_edge_recon_loss: 270651.9380; train_gene_expr_recon_loss: 852965.6203; train_masked_gp_l1_reg_loss: 9394.8321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1000.4261; train_chrom_access_recon_loss: 430207.8693; train_global_loss: 1576682.5833; train_optim_loss: 1576682.5833; val_kl_reg_loss: 11095.4996; val_edge_recon_loss: 272067.4062; val_gene_expr_recon_loss: 855794.0234; val_masked_gp_l1_reg_loss: 9401.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 989.1078; val_chrom_access_recon_loss: 431939.3398; val_global_loss: 1581287.0312; val_optim_loss: 1581287.0312

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 32 min 51 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9829
val AUPRC score: 0.9794
val best accuracy score: 0.9426
val best F1 score: 0.9438
val target rna MSE score: 4.0697
val source rna MSE score: 3.6343
val target atac MSE score: 0.1347
val source atac MSE score: 0.0269
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
