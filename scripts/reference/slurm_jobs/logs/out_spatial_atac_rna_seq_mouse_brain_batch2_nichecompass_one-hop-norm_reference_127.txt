[True]
Run timestamp: 07082023_212405_127.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_127']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9661; val_auprc_score: 0.9675; val_best_acc_score: 0.8840; val_best_f1_score: 0.8754; train_kl_reg_loss: 3169.9074; train_edge_recon_loss: 3467268.3333; train_gene_expr_recon_loss: 626627.6181; train_masked_gp_l1_reg_loss: 4578.9345; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 794370.8611; train_global_loss: 4896015.5556; train_optim_loss: 4896015.5556; val_kl_reg_loss: 743.6553; val_edge_recon_loss: 4032043.7500; val_gene_expr_recon_loss: 623078.5000; val_masked_gp_l1_reg_loss: 3909.2544; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 788301.8125; val_global_loss: 5448077.5000; val_optim_loss: 5448077.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9429; val_auprc_score: 0.9342; val_best_acc_score: 0.8717; val_best_f1_score: 0.8801; train_kl_reg_loss: 1137.0867; train_edge_recon_loss: 3457471.6389; train_gene_expr_recon_loss: 612472.7083; train_masked_gp_l1_reg_loss: 3592.8195; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 793110.3681; train_global_loss: 4867784.6111; train_optim_loss: 4867784.6111; val_kl_reg_loss: 1332.6370; val_edge_recon_loss: 3700460.5000; val_gene_expr_recon_loss: 599639.7500; val_masked_gp_l1_reg_loss: 3340.8218; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 782540.3750; val_global_loss: 5087314.5000; val_optim_loss: 5087314.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9117; val_auprc_score: 0.8912; val_best_acc_score: 0.8473; val_best_f1_score: 0.8599; train_kl_reg_loss: 3552.6718; train_edge_recon_loss: 3223480.8889; train_gene_expr_recon_loss: 588131.7083; train_masked_gp_l1_reg_loss: 3322.5068; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 787916.0486; train_global_loss: 4606403.7778; train_optim_loss: 4606403.7778; val_kl_reg_loss: 11047.0332; val_edge_recon_loss: 2860309.2500; val_gene_expr_recon_loss: 579910.1875; val_masked_gp_l1_reg_loss: 3336.6714; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 776036.8750; val_global_loss: 4230640.0000; val_optim_loss: 4230640.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9252; val_auprc_score: 0.8997; val_best_acc_score: 0.8700; val_best_f1_score: 0.8775; train_kl_reg_loss: 26899.5426; train_edge_recon_loss: 2755408.3889; train_gene_expr_recon_loss: 580014.2500; train_masked_gp_l1_reg_loss: 3299.1978; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 782570.5069; train_global_loss: 4148191.9167; train_optim_loss: 4148191.9167; val_kl_reg_loss: 43410.1289; val_edge_recon_loss: 2737421.7500; val_gene_expr_recon_loss: 570118.3125; val_masked_gp_l1_reg_loss: 3235.8945; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 772531.5625; val_global_loss: 4126717.7500; val_optim_loss: 4126717.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9298; val_auprc_score: 0.9079; val_best_acc_score: 0.8712; val_best_f1_score: 0.8783; train_kl_reg_loss: 47128.9371; train_edge_recon_loss: 2719303.0556; train_gene_expr_recon_loss: 558378.0486; train_masked_gp_l1_reg_loss: 3232.7283; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 777671.2431; train_global_loss: 4105714.0833; train_optim_loss: 4105714.0833; val_kl_reg_loss: 42944.1406; val_edge_recon_loss: 2720769.2500; val_gene_expr_recon_loss: 549627.1875; val_masked_gp_l1_reg_loss: 3240.0674; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 765505.9375; val_global_loss: 4082086.7500; val_optim_loss: 4082086.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9349; val_auprc_score: 0.9142; val_best_acc_score: 0.8758; val_best_f1_score: 0.8837; train_kl_reg_loss: 40012.2804; train_edge_recon_loss: 2721808.7778; train_gene_expr_recon_loss: 546620.2847; train_masked_gp_l1_reg_loss: 3250.3928; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 771580.8681; train_global_loss: 4083272.5833; train_optim_loss: 4083272.5833; val_kl_reg_loss: 34749.0781; val_edge_recon_loss: 2733558.5000; val_gene_expr_recon_loss: 540633.1250; val_masked_gp_l1_reg_loss: 3264.2874; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 761313.0000; val_global_loss: 4073517.7500; val_optim_loss: 4073517.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9409; val_auprc_score: 0.9218; val_best_acc_score: 0.8870; val_best_f1_score: 0.8928; train_kl_reg_loss: 35822.8342; train_edge_recon_loss: 2710291.6667; train_gene_expr_recon_loss: 533301.9792; train_masked_gp_l1_reg_loss: 3293.2723; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 767207.4792; train_global_loss: 4049917.2500; train_optim_loss: 4049917.2500; val_kl_reg_loss: 34930.5000; val_edge_recon_loss: 2716222.7500; val_gene_expr_recon_loss: 528322.0000; val_masked_gp_l1_reg_loss: 3327.9568; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 756716.5000; val_global_loss: 4039519.7500; val_optim_loss: 4039519.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9416; val_auprc_score: 0.9215; val_best_acc_score: 0.8897; val_best_f1_score: 0.8964; train_kl_reg_loss: 36524.3247; train_edge_recon_loss: 2714504.8889; train_gene_expr_recon_loss: 522684.9792; train_masked_gp_l1_reg_loss: 3360.1180; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 762602.5278; train_global_loss: 4039676.8611; train_optim_loss: 4039676.8611; val_kl_reg_loss: 34232.7891; val_edge_recon_loss: 2717587.2500; val_gene_expr_recon_loss: 519875.1250; val_masked_gp_l1_reg_loss: 3402.2021; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 753059.5625; val_global_loss: 4028156.7500; val_optim_loss: 4028156.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9400; val_auprc_score: 0.9174; val_best_acc_score: 0.8856; val_best_f1_score: 0.8917; train_kl_reg_loss: 35079.5299; train_edge_recon_loss: 2710199.5278; train_gene_expr_recon_loss: 513078.4236; train_masked_gp_l1_reg_loss: 3443.8684; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 756674.6875; train_global_loss: 4018476.0278; train_optim_loss: 4018476.0278; val_kl_reg_loss: 33240.3594; val_edge_recon_loss: 2736224.0000; val_gene_expr_recon_loss: 509592.5938; val_masked_gp_l1_reg_loss: 3495.0938; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 748973.8750; val_global_loss: 4031525.5000; val_optim_loss: 4031525.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9513; val_auprc_score: 0.9352; val_best_acc_score: 0.8933; val_best_f1_score: 0.8991; train_kl_reg_loss: 34378.6680; train_edge_recon_loss: 2704418.8889; train_gene_expr_recon_loss: 507940.7847; train_masked_gp_l1_reg_loss: 3543.7238; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 753719.3611; train_global_loss: 4004001.4167; train_optim_loss: 4004001.4167; val_kl_reg_loss: 32752.2773; val_edge_recon_loss: 2709939.2500; val_gene_expr_recon_loss: 502121.9375; val_masked_gp_l1_reg_loss: 3599.3179; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 745860.5000; val_global_loss: 3994273.2500; val_optim_loss: 3994273.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9542; val_auprc_score: 0.9352; val_best_acc_score: 0.9007; val_best_f1_score: 0.9048; train_kl_reg_loss: 32818.2936; train_edge_recon_loss: 2704268.6944; train_gene_expr_recon_loss: 498323.3646; train_masked_gp_l1_reg_loss: 3650.5145; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 750704.2778; train_global_loss: 3989765.1667; train_optim_loss: 3989765.1667; val_kl_reg_loss: 31963.6035; val_edge_recon_loss: 2703612.2500; val_gene_expr_recon_loss: 498552.1250; val_masked_gp_l1_reg_loss: 3704.2671; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 743242.0625; val_global_loss: 3981074.2500; val_optim_loss: 3981074.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9595; val_auprc_score: 0.9430; val_best_acc_score: 0.9115; val_best_f1_score: 0.9159; train_kl_reg_loss: 33169.3915; train_edge_recon_loss: 2692202.8889; train_gene_expr_recon_loss: 495247.2569; train_masked_gp_l1_reg_loss: 3748.1991; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 749532.5903; train_global_loss: 3973900.3889; train_optim_loss: 3973900.3889; val_kl_reg_loss: 32898.6992; val_edge_recon_loss: 2670573.0000; val_gene_expr_recon_loss: 493435.3125; val_masked_gp_l1_reg_loss: 3793.7327; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 741399.6250; val_global_loss: 3942100.5000; val_optim_loss: 3942100.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9645; val_auprc_score: 0.9500; val_best_acc_score: 0.9120; val_best_f1_score: 0.9165; train_kl_reg_loss: 35458.1189; train_edge_recon_loss: 2671761.6389; train_gene_expr_recon_loss: 492035.5069; train_masked_gp_l1_reg_loss: 3834.6603; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 748475.8819; train_global_loss: 3951565.9444; train_optim_loss: 3951565.9444; val_kl_reg_loss: 35275.2812; val_edge_recon_loss: 2675594.7500; val_gene_expr_recon_loss: 485416.1250; val_masked_gp_l1_reg_loss: 3885.4221; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 737700.0000; val_global_loss: 3937871.5000; val_optim_loss: 3937871.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9620; val_auprc_score: 0.9440; val_best_acc_score: 0.9146; val_best_f1_score: 0.9183; train_kl_reg_loss: 35732.5755; train_edge_recon_loss: 2676629.1389; train_gene_expr_recon_loss: 485188.8368; train_masked_gp_l1_reg_loss: 3927.4507; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 742180.5486; train_global_loss: 3943658.5556; train_optim_loss: 3943658.5556; val_kl_reg_loss: 33976.8125; val_edge_recon_loss: 2671041.0000; val_gene_expr_recon_loss: 484776.7500; val_masked_gp_l1_reg_loss: 3969.9143; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 735461.5625; val_global_loss: 3929226.0000; val_optim_loss: 3929226.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9637; val_auprc_score: 0.9503; val_best_acc_score: 0.9163; val_best_f1_score: 0.9200; train_kl_reg_loss: 34753.6576; train_edge_recon_loss: 2659752.5556; train_gene_expr_recon_loss: 482225.8681; train_masked_gp_l1_reg_loss: 4009.6655; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 737735.8472; train_global_loss: 3918477.5833; train_optim_loss: 3918477.5833; val_kl_reg_loss: 33814.4023; val_edge_recon_loss: 2678994.0000; val_gene_expr_recon_loss: 487216.7500; val_masked_gp_l1_reg_loss: 4055.9519; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 735006.3125; val_global_loss: 3939087.5000; val_optim_loss: 3939087.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9669; val_auprc_score: 0.9556; val_best_acc_score: 0.9190; val_best_f1_score: 0.9216; train_kl_reg_loss: 34981.7096; train_edge_recon_loss: 2667067.3056; train_gene_expr_recon_loss: 479744.7604; train_masked_gp_l1_reg_loss: 4087.6746; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 737484.9306; train_global_loss: 3923366.4167; train_optim_loss: 3923366.4167; val_kl_reg_loss: 34209.5859; val_edge_recon_loss: 2685504.2500; val_gene_expr_recon_loss: 481491.9688; val_masked_gp_l1_reg_loss: 4125.1123; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 732758.0000; val_global_loss: 3938088.7500; val_optim_loss: 3938088.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9705; val_auprc_score: 0.9586; val_best_acc_score: 0.9260; val_best_f1_score: 0.9290; train_kl_reg_loss: 34395.8047; train_edge_recon_loss: 2659731.3611; train_gene_expr_recon_loss: 476925.8333; train_masked_gp_l1_reg_loss: 4166.3609; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 738256.9236; train_global_loss: 3913476.2778; train_optim_loss: 3913476.2778; val_kl_reg_loss: 32738.3125; val_edge_recon_loss: 2650637.2500; val_gene_expr_recon_loss: 472807.8125; val_masked_gp_l1_reg_loss: 4199.3198; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 729860.0000; val_global_loss: 3890242.5000; val_optim_loss: 3890242.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9716; val_auprc_score: 0.9613; val_best_acc_score: 0.9255; val_best_f1_score: 0.9288; train_kl_reg_loss: 33399.0078; train_edge_recon_loss: 2660656.7500; train_gene_expr_recon_loss: 473687.0417; train_masked_gp_l1_reg_loss: 4231.1912; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 733059.4444; train_global_loss: 3905033.4444; train_optim_loss: 3905033.4444; val_kl_reg_loss: 31192.6523; val_edge_recon_loss: 2663777.5000; val_gene_expr_recon_loss: 473629.5000; val_masked_gp_l1_reg_loss: 4258.4331; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 728569.6875; val_global_loss: 3901428.0000; val_optim_loss: 3901428.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9710; val_auprc_score: 0.9586; val_best_acc_score: 0.9256; val_best_f1_score: 0.9292; train_kl_reg_loss: 32316.0302; train_edge_recon_loss: 2655282.0556; train_gene_expr_recon_loss: 470463.5208; train_masked_gp_l1_reg_loss: 4292.5814; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 735896.9167; train_global_loss: 3898251.0833; train_optim_loss: 3898251.0833; val_kl_reg_loss: 32107.3203; val_edge_recon_loss: 2676371.0000; val_gene_expr_recon_loss: 472819.8125; val_masked_gp_l1_reg_loss: 4318.7642; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 728047.0000; val_global_loss: 3913663.7500; val_optim_loss: 3913663.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9760; val_auprc_score: 0.9669; val_best_acc_score: 0.9334; val_best_f1_score: 0.9355; train_kl_reg_loss: 32920.0441; train_edge_recon_loss: 2651850.0278; train_gene_expr_recon_loss: 467050.7257; train_masked_gp_l1_reg_loss: 4342.0303; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 733851.5833; train_global_loss: 3890014.4722; train_optim_loss: 3890014.4722; val_kl_reg_loss: 32320.1367; val_edge_recon_loss: 2647024.0000; val_gene_expr_recon_loss: 470421.4375; val_masked_gp_l1_reg_loss: 4364.7988; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 725707.5000; val_global_loss: 3879838.0000; val_optim_loss: 3879838.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9768; val_auprc_score: 0.9656; val_best_acc_score: 0.9349; val_best_f1_score: 0.9369; train_kl_reg_loss: 33178.5773; train_edge_recon_loss: 2652947.5278; train_gene_expr_recon_loss: 465512.0590; train_masked_gp_l1_reg_loss: 4386.6298; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 732208.5347; train_global_loss: 3888233.3611; train_optim_loss: 3888233.3611; val_kl_reg_loss: 31561.4609; val_edge_recon_loss: 2658670.7500; val_gene_expr_recon_loss: 467362.5625; val_masked_gp_l1_reg_loss: 4407.1230; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 723445.3125; val_global_loss: 3885447.0000; val_optim_loss: 3885447.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9772; val_auprc_score: 0.9694; val_best_acc_score: 0.9380; val_best_f1_score: 0.9396; train_kl_reg_loss: 32714.6319; train_edge_recon_loss: 2640765.2778; train_gene_expr_recon_loss: 464093.6771; train_masked_gp_l1_reg_loss: 4426.7478; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 730691.6389; train_global_loss: 3872691.9722; train_optim_loss: 3872691.9722; val_kl_reg_loss: 33042.3867; val_edge_recon_loss: 2656492.0000; val_gene_expr_recon_loss: 465563.5000; val_masked_gp_l1_reg_loss: 4441.6128; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722568.2500; val_global_loss: 3882107.7500; val_optim_loss: 3882107.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9791; val_auprc_score: 0.9732; val_best_acc_score: 0.9357; val_best_f1_score: 0.9379; train_kl_reg_loss: 33035.6678; train_edge_recon_loss: 2642917.8056; train_gene_expr_recon_loss: 460239.9236; train_masked_gp_l1_reg_loss: 4462.5256; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 725970.7361; train_global_loss: 3866626.6667; train_optim_loss: 3866626.6667; val_kl_reg_loss: 31597.6641; val_edge_recon_loss: 2650949.0000; val_gene_expr_recon_loss: 464892.7188; val_masked_gp_l1_reg_loss: 4482.6768; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 721721.1250; val_global_loss: 3873643.5000; val_optim_loss: 3873643.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9766; val_auprc_score: 0.9675; val_best_acc_score: 0.9367; val_best_f1_score: 0.9388; train_kl_reg_loss: 33609.6925; train_edge_recon_loss: 2641761.0278; train_gene_expr_recon_loss: 459583.7222; train_masked_gp_l1_reg_loss: 4502.0404; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 726320.5833; train_global_loss: 3865777.0556; train_optim_loss: 3865777.0556; val_kl_reg_loss: 34475.1562; val_edge_recon_loss: 2645745.7500; val_gene_expr_recon_loss: 459467.8750; val_masked_gp_l1_reg_loss: 4516.3696; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 718765.8750; val_global_loss: 3862971.0000; val_optim_loss: 3862971.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9776; val_auprc_score: 0.9688; val_best_acc_score: 0.9345; val_best_f1_score: 0.9372; train_kl_reg_loss: 33891.9049; train_edge_recon_loss: 2635094.1389; train_gene_expr_recon_loss: 456156.9792; train_masked_gp_l1_reg_loss: 4533.9465; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 721715.6042; train_global_loss: 3851392.5556; train_optim_loss: 3851392.5556; val_kl_reg_loss: 31686.7539; val_edge_recon_loss: 2666944.2500; val_gene_expr_recon_loss: 458730.8750; val_masked_gp_l1_reg_loss: 4549.7798; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 717506.5000; val_global_loss: 3879418.2500; val_optim_loss: 3879418.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9798; val_auprc_score: 0.9720; val_best_acc_score: 0.9391; val_best_f1_score: 0.9403; train_kl_reg_loss: 33393.8405; train_edge_recon_loss: 2662898.3056; train_gene_expr_recon_loss: 481749.9896; train_masked_gp_l1_reg_loss: 4569.7337; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 736432.3403; train_global_loss: 3919044.2222; train_optim_loss: 3919044.2222; val_kl_reg_loss: 15315.4717; val_edge_recon_loss: 2659013.7500; val_gene_expr_recon_loss: 479320.4062; val_masked_gp_l1_reg_loss: 4570.5962; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 726068.1250; val_global_loss: 3884288.5000; val_optim_loss: 3884288.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9771; val_auprc_score: 0.9668; val_best_acc_score: 0.9410; val_best_f1_score: 0.9427; train_kl_reg_loss: 33170.2044; train_edge_recon_loss: 2648241.9722; train_gene_expr_recon_loss: 477163.0799; train_masked_gp_l1_reg_loss: 4563.2890; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 729411.5417; train_global_loss: 3892550.0833; train_optim_loss: 3892550.0833; val_kl_reg_loss: 15241.6113; val_edge_recon_loss: 2635730.5000; val_gene_expr_recon_loss: 485330.5000; val_masked_gp_l1_reg_loss: 4552.0059; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 728306.6250; val_global_loss: 3869161.0000; val_optim_loss: 3869161.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9797; val_auprc_score: 0.9731; val_best_acc_score: 0.9411; val_best_f1_score: 0.9428; train_kl_reg_loss: 30756.3997; train_edge_recon_loss: 2634197.1389; train_gene_expr_recon_loss: 474736.3819; train_masked_gp_l1_reg_loss: 4548.2687; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 729557.7569; train_global_loss: 3873795.8611; train_optim_loss: 3873795.8611; val_kl_reg_loss: 16090.4414; val_edge_recon_loss: 2645688.7500; val_gene_expr_recon_loss: 474082.9375; val_masked_gp_l1_reg_loss: 4542.4355; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722841.5000; val_global_loss: 3863246.2500; val_optim_loss: 3863246.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9791; val_auprc_score: 0.9705; val_best_acc_score: 0.9413; val_best_f1_score: 0.9428; train_kl_reg_loss: 29466.9514; train_edge_recon_loss: 2631142.0000; train_gene_expr_recon_loss: 469107.7014; train_masked_gp_l1_reg_loss: 4528.1121; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 728596.5208; train_global_loss: 3862841.3333; train_optim_loss: 3862841.3333; val_kl_reg_loss: 16237.9629; val_edge_recon_loss: 2640001.2500; val_gene_expr_recon_loss: 475564.0000; val_masked_gp_l1_reg_loss: 4511.9756; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 724175.8750; val_global_loss: 3860491.0000; val_optim_loss: 3860491.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9806; val_auprc_score: 0.9712; val_best_acc_score: 0.9394; val_best_f1_score: 0.9407; train_kl_reg_loss: 29388.4186; train_edge_recon_loss: 2629493.4444; train_gene_expr_recon_loss: 469108.8021; train_masked_gp_l1_reg_loss: 4505.7583; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 727846.4236; train_global_loss: 3860342.8333; train_optim_loss: 3860342.8333; val_kl_reg_loss: 16276.2061; val_edge_recon_loss: 2650030.7500; val_gene_expr_recon_loss: 474552.5938; val_masked_gp_l1_reg_loss: 4497.4482; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 723441.0625; val_global_loss: 3868798.0000; val_optim_loss: 3868798.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9781; val_auprc_score: 0.9661; val_best_acc_score: 0.9398; val_best_f1_score: 0.9417; train_kl_reg_loss: 29117.0790; train_edge_recon_loss: 2634164.0556; train_gene_expr_recon_loss: 469688.2292; train_masked_gp_l1_reg_loss: 4492.3134; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 725665.7708; train_global_loss: 3863127.4722; train_optim_loss: 3863127.4722; val_kl_reg_loss: 16196.3789; val_edge_recon_loss: 2648482.5000; val_gene_expr_recon_loss: 474568.2188; val_masked_gp_l1_reg_loss: 4486.6421; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 723536.7500; val_global_loss: 3867270.7500; val_optim_loss: 3867270.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9793; val_auprc_score: 0.9714; val_best_acc_score: 0.9422; val_best_f1_score: 0.9438; train_kl_reg_loss: 28814.4306; train_edge_recon_loss: 2636815.1111; train_gene_expr_recon_loss: 469381.1701; train_masked_gp_l1_reg_loss: 4483.4840; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 728200.1944; train_global_loss: 3867694.4167; train_optim_loss: 3867694.4167; val_kl_reg_loss: 16077.6455; val_edge_recon_loss: 2616532.5000; val_gene_expr_recon_loss: 473833.2500; val_masked_gp_l1_reg_loss: 4480.0615; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 723286.9375; val_global_loss: 3834210.5000; val_optim_loss: 3834210.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9795; val_auprc_score: 0.9710; val_best_acc_score: 0.9403; val_best_f1_score: 0.9418; train_kl_reg_loss: 28373.2493; train_edge_recon_loss: 2624520.8889; train_gene_expr_recon_loss: 467610.5868; train_masked_gp_l1_reg_loss: 4478.0349; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 726525.5903; train_global_loss: 3851508.3056; train_optim_loss: 3851508.3056; val_kl_reg_loss: 16159.8994; val_edge_recon_loss: 2648743.7500; val_gene_expr_recon_loss: 474162.4375; val_masked_gp_l1_reg_loss: 4475.3979; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 723258.3125; val_global_loss: 3866800.0000; val_optim_loss: 3866800.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9799; val_auprc_score: 0.9716; val_best_acc_score: 0.9421; val_best_f1_score: 0.9438; train_kl_reg_loss: 28517.8201; train_edge_recon_loss: 2627240.0833; train_gene_expr_recon_loss: 469023.2674; train_masked_gp_l1_reg_loss: 4473.6284; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 727397.1528; train_global_loss: 3856652.0278; train_optim_loss: 3856652.0278; val_kl_reg_loss: 16557.4727; val_edge_recon_loss: 2642917.2500; val_gene_expr_recon_loss: 473136.3750; val_masked_gp_l1_reg_loss: 4471.4751; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722891.8125; val_global_loss: 3859974.2500; val_optim_loss: 3859974.2500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9803; val_auprc_score: 0.9722; val_best_acc_score: 0.9422; val_best_f1_score: 0.9440; train_kl_reg_loss: 28722.7042; train_edge_recon_loss: 2631476.0278; train_gene_expr_recon_loss: 469500.8750; train_masked_gp_l1_reg_loss: 4469.9913; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 727687.9306; train_global_loss: 3861857.5000; train_optim_loss: 3861857.5000; val_kl_reg_loss: 16543.7148; val_edge_recon_loss: 2623581.5000; val_gene_expr_recon_loss: 473791.4062; val_masked_gp_l1_reg_loss: 4468.2021; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 723150.3750; val_global_loss: 3841535.5000; val_optim_loss: 3841535.5000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9774; val_auprc_score: 0.9665; val_best_acc_score: 0.9400; val_best_f1_score: 0.9420; train_kl_reg_loss: 28422.6176; train_edge_recon_loss: 2627264.6944; train_gene_expr_recon_loss: 470859.7674; train_masked_gp_l1_reg_loss: 4466.8594; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 727470.1806; train_global_loss: 3858484.1111; train_optim_loss: 3858484.1111; val_kl_reg_loss: 16624.5352; val_edge_recon_loss: 2660282.7500; val_gene_expr_recon_loss: 473155.7812; val_masked_gp_l1_reg_loss: 4465.1548; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722733.2500; val_global_loss: 3877261.5000; val_optim_loss: 3877261.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9825; val_auprc_score: 0.9757; val_best_acc_score: 0.9457; val_best_f1_score: 0.9474; train_kl_reg_loss: 28420.7413; train_edge_recon_loss: 2629926.8056; train_gene_expr_recon_loss: 466957.1875; train_masked_gp_l1_reg_loss: 4463.7272; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 727801.4931; train_global_loss: 3857569.9722; train_optim_loss: 3857569.9722; val_kl_reg_loss: 16608.3711; val_edge_recon_loss: 2616399.0000; val_gene_expr_recon_loss: 473034.6875; val_masked_gp_l1_reg_loss: 4462.3921; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722555.8125; val_global_loss: 3833060.2500; val_optim_loss: 3833060.2500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9808; val_auprc_score: 0.9744; val_best_acc_score: 0.9410; val_best_f1_score: 0.9431; train_kl_reg_loss: 28280.6736; train_edge_recon_loss: 2624744.8056; train_gene_expr_recon_loss: 466410.6597; train_masked_gp_l1_reg_loss: 4462.0299; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 725666.9236; train_global_loss: 3849565.0556; train_optim_loss: 3849565.0556; val_kl_reg_loss: 16593.1113; val_edge_recon_loss: 2640212.0000; val_gene_expr_recon_loss: 473099.6250; val_masked_gp_l1_reg_loss: 4461.4448; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722530.8125; val_global_loss: 3856896.7500; val_optim_loss: 3856896.7500
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9789; val_auprc_score: 0.9707; val_best_acc_score: 0.9386; val_best_f1_score: 0.9411; train_kl_reg_loss: 28484.1612; train_edge_recon_loss: 2623767.2778; train_gene_expr_recon_loss: 468398.1736; train_masked_gp_l1_reg_loss: 4461.0725; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 726398.4028; train_global_loss: 3851509.0278; train_optim_loss: 3851509.0278; val_kl_reg_loss: 16618.4473; val_edge_recon_loss: 2634803.7500; val_gene_expr_recon_loss: 473128.0000; val_masked_gp_l1_reg_loss: 4460.6597; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722620.7500; val_global_loss: 3851631.7500; val_optim_loss: 3851631.7500
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9790; val_auprc_score: 0.9714; val_best_acc_score: 0.9394; val_best_f1_score: 0.9418; train_kl_reg_loss: 28280.4512; train_edge_recon_loss: 2627445.4444; train_gene_expr_recon_loss: 466752.7014; train_masked_gp_l1_reg_loss: 4460.4019; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 724581.7153; train_global_loss: 3851520.7222; train_optim_loss: 3851520.7222; val_kl_reg_loss: 16694.1348; val_edge_recon_loss: 2654358.5000; val_gene_expr_recon_loss: 473065.0625; val_masked_gp_l1_reg_loss: 4460.1001; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722687.6250; val_global_loss: 3871265.5000; val_optim_loss: 3871265.5000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9813; val_auprc_score: 0.9730; val_best_acc_score: 0.9438; val_best_f1_score: 0.9459; train_kl_reg_loss: 28409.5675; train_edge_recon_loss: 2625148.7500; train_gene_expr_recon_loss: 467410.1111; train_masked_gp_l1_reg_loss: 4459.9178; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 727238.1944; train_global_loss: 3852666.5000; train_optim_loss: 3852666.5000; val_kl_reg_loss: 16711.2402; val_edge_recon_loss: 2625589.7500; val_gene_expr_recon_loss: 473054.7500; val_masked_gp_l1_reg_loss: 4459.6670; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722729.3125; val_global_loss: 3842544.7500; val_optim_loss: 3842544.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9798; val_auprc_score: 0.9737; val_best_acc_score: 0.9396; val_best_f1_score: 0.9416; train_kl_reg_loss: 28205.1487; train_edge_recon_loss: 2628200.1667; train_gene_expr_recon_loss: 465597.8229; train_masked_gp_l1_reg_loss: 4459.5056; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 724225.6042; train_global_loss: 3850688.2778; train_optim_loss: 3850688.2778; val_kl_reg_loss: 16693.1289; val_edge_recon_loss: 2642592.0000; val_gene_expr_recon_loss: 472935.3750; val_masked_gp_l1_reg_loss: 4459.3516; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722685.5000; val_global_loss: 3859365.2500; val_optim_loss: 3859365.2500
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9815; val_auprc_score: 0.9755; val_best_acc_score: 0.9437; val_best_f1_score: 0.9453; train_kl_reg_loss: 28337.4021; train_edge_recon_loss: 2634166.5278; train_gene_expr_recon_loss: 466948.7847; train_masked_gp_l1_reg_loss: 4459.3093; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 727907.0278; train_global_loss: 3861818.9167; train_optim_loss: 3861818.9167; val_kl_reg_loss: 16677.1836; val_edge_recon_loss: 2651312.2500; val_gene_expr_recon_loss: 473034.0312; val_masked_gp_l1_reg_loss: 4459.2402; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722697.1875; val_global_loss: 3868180.0000; val_optim_loss: 3868180.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9795; val_auprc_score: 0.9692; val_best_acc_score: 0.9396; val_best_f1_score: 0.9418; train_kl_reg_loss: 28306.2565; train_edge_recon_loss: 2627518.2778; train_gene_expr_recon_loss: 466413.5833; train_masked_gp_l1_reg_loss: 4459.1969; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 727350.2986; train_global_loss: 3854047.6389; train_optim_loss: 3854047.6389; val_kl_reg_loss: 16683.9336; val_edge_recon_loss: 2647845.5000; val_gene_expr_recon_loss: 473033.0000; val_masked_gp_l1_reg_loss: 4459.1465; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722798.5625; val_global_loss: 3864820.2500; val_optim_loss: 3864820.2500
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9831; val_auprc_score: 0.9764; val_best_acc_score: 0.9440; val_best_f1_score: 0.9460; train_kl_reg_loss: 28303.8735; train_edge_recon_loss: 2626525.4722; train_gene_expr_recon_loss: 467024.4271; train_masked_gp_l1_reg_loss: 4459.1148; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 727773.4792; train_global_loss: 3854086.3333; train_optim_loss: 3854086.3333; val_kl_reg_loss: 16671.6973; val_edge_recon_loss: 2654651.7500; val_gene_expr_recon_loss: 473043.3750; val_masked_gp_l1_reg_loss: 4459.0781; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 722779.5625; val_global_loss: 3871605.5000; val_optim_loss: 3871605.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 5 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9817
val AUPRC score: 0.9757
val best accuracy score: 0.9429
val best F1 score: 0.9450
val target rna MSE score: 0.4328
val source rna MSE score: 0.2747
val target atac MSE score: 0.1350
val source atac MSE score: 0.0206
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
