[True]
Run timestamp: 29072023_130006_127.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_127']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9076; val_auprc_score: 0.9177; val_best_acc_score: 0.5187; val_best_f1_score: 0.6749; train_kl_reg_loss: 4682.3481; train_edge_recon_loss: 34688297.3333; train_gene_expr_recon_loss: 8002808.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1863273.9722; train_global_loss: 44559061.7778; train_optim_loss: 44559061.7778; val_kl_reg_loss: 3709.3066; val_edge_recon_loss: 40622912.0000; val_gene_expr_recon_loss: 7166713.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1727921.7500; val_global_loss: 49521252.0000; val_optim_loss: 49521252.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9256; val_auprc_score: 0.9353; val_best_acc_score: 0.5127; val_best_f1_score: 0.6723; train_kl_reg_loss: 10817.1873; train_edge_recon_loss: 34687912.4444; train_gene_expr_recon_loss: 6986787.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1790113.6944; train_global_loss: 43475631.1111; train_optim_loss: 43475631.1111; val_kl_reg_loss: 7840.0146; val_edge_recon_loss: 40640344.0000; val_gene_expr_recon_loss: 6823354.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1760260.5000; val_global_loss: 49231796.0000; val_optim_loss: 49231796.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9239; val_auprc_score: 0.9353; val_best_acc_score: 0.5181; val_best_f1_score: 0.6748; train_kl_reg_loss: 13148.1896; train_edge_recon_loss: 34688204.4444; train_gene_expr_recon_loss: 6714686.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1775487.3611; train_global_loss: 43191526.6667; train_optim_loss: 43191526.6667; val_kl_reg_loss: 23432.8574; val_edge_recon_loss: 40640604.0000; val_gene_expr_recon_loss: 6522143.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1734794.2500; val_global_loss: 48920976.0000; val_optim_loss: 48920976.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9214; val_auprc_score: 0.9324; val_best_acc_score: 0.5264; val_best_f1_score: 0.6784; train_kl_reg_loss: 30021.1988; train_edge_recon_loss: 34711894.6667; train_gene_expr_recon_loss: 6383668.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1746585.8611; train_global_loss: 42872170.6667; train_optim_loss: 42872170.6667; val_kl_reg_loss: 42877.1484; val_edge_recon_loss: 40637068.0000; val_gene_expr_recon_loss: 6161748.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1728355.3750; val_global_loss: 48570048.0000; val_optim_loss: 48570048.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9127; val_auprc_score: 0.9212; val_best_acc_score: 0.5521; val_best_f1_score: 0.6899; train_kl_reg_loss: 56875.1202; train_edge_recon_loss: 34707617.3333; train_gene_expr_recon_loss: 6044145.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1760661.8750; train_global_loss: 42569300.8889; train_optim_loss: 42569300.8889; val_kl_reg_loss: 26358.9336; val_edge_recon_loss: 40622436.0000; val_gene_expr_recon_loss: 5860905.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1704756.2500; val_global_loss: 48214456.0000; val_optim_loss: 48214456.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9214; val_auprc_score: 0.9283; val_best_acc_score: 0.5512; val_best_f1_score: 0.6896; train_kl_reg_loss: 48887.6523; train_edge_recon_loss: 34737568.4444; train_gene_expr_recon_loss: 5745780.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1730866.7083; train_global_loss: 42263103.1111; train_optim_loss: 42263103.1111; val_kl_reg_loss: 62473.2734; val_edge_recon_loss: 40620152.0000; val_gene_expr_recon_loss: 5488157.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1710417.0000; val_global_loss: 47881196.0000; val_optim_loss: 47881196.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9161; val_auprc_score: 0.9196; val_best_acc_score: 0.5651; val_best_f1_score: 0.6963; train_kl_reg_loss: 61601.0720; train_edge_recon_loss: 34720012.8889; train_gene_expr_recon_loss: 5383677.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1724209.9861; train_global_loss: 41889501.7778; train_optim_loss: 41889501.7778; val_kl_reg_loss: 57418.3438; val_edge_recon_loss: 40615696.0000; val_gene_expr_recon_loss: 5161725.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1681282.7500; val_global_loss: 47516124.0000; val_optim_loss: 47516124.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9072; val_auprc_score: 0.9095; val_best_acc_score: 0.5943; val_best_f1_score: 0.7105; train_kl_reg_loss: 77309.8598; train_edge_recon_loss: 34694738.6667; train_gene_expr_recon_loss: 5019066.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1690668.6389; train_global_loss: 41481783.1111; train_optim_loss: 41481783.1111; val_kl_reg_loss: 47891.7891; val_edge_recon_loss: 40601416.0000; val_gene_expr_recon_loss: 4904586.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1648501.6250; val_global_loss: 47202396.0000; val_optim_loss: 47202396.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9046; val_auprc_score: 0.9104; val_best_acc_score: 0.6095; val_best_f1_score: 0.7175; train_kl_reg_loss: 80577.4848; train_edge_recon_loss: 34721976.4444; train_gene_expr_recon_loss: 4768598.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1677950.6528; train_global_loss: 41249103.5556; train_optim_loss: 41249103.5556; val_kl_reg_loss: 49760.0000; val_edge_recon_loss: 40592544.0000; val_gene_expr_recon_loss: 4673035.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1631140.2500; val_global_loss: 46946480.0000; val_optim_loss: 46946480.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8925; val_auprc_score: 0.8924; val_best_acc_score: 0.6440; val_best_f1_score: 0.7346; train_kl_reg_loss: 82288.0078; train_edge_recon_loss: 34714526.2222; train_gene_expr_recon_loss: 4567981.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1647394.9306; train_global_loss: 41012189.7778; train_optim_loss: 41012189.7778; val_kl_reg_loss: 62795.4414; val_edge_recon_loss: 40571476.0000; val_gene_expr_recon_loss: 4472429.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1611722.0000; val_global_loss: 46718424.0000; val_optim_loss: 46718424.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8836; val_auprc_score: 0.8840; val_best_acc_score: 0.6827; val_best_f1_score: 0.7545; train_kl_reg_loss: 86947.6315; train_edge_recon_loss: 34728864.0000; train_gene_expr_recon_loss: 4417637.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1629095.7083; train_global_loss: 40862546.2222; train_optim_loss: 40862546.2222; val_kl_reg_loss: 63066.9609; val_edge_recon_loss: 40539796.0000; val_gene_expr_recon_loss: 4337175.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1591504.5000; val_global_loss: 46531544.0000; val_optim_loss: 46531544.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8722; val_auprc_score: 0.8720; val_best_acc_score: 0.7246; val_best_f1_score: 0.7765; train_kl_reg_loss: 81868.0894; train_edge_recon_loss: 34727307.5556; train_gene_expr_recon_loss: 4278483.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1601881.1528; train_global_loss: 40689539.5556; train_optim_loss: 40689539.5556; val_kl_reg_loss: 55982.6172; val_edge_recon_loss: 40477792.0000; val_gene_expr_recon_loss: 4243149.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1576947.5000; val_global_loss: 46353872.0000; val_optim_loss: 46353872.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8607; val_auprc_score: 0.8533; val_best_acc_score: 0.7629; val_best_f1_score: 0.7942; train_kl_reg_loss: 84099.2613; train_edge_recon_loss: 34710732.8889; train_gene_expr_recon_loss: 4206329.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1611572.9167; train_global_loss: 40612733.3333; train_optim_loss: 40612733.3333; val_kl_reg_loss: 65782.0391; val_edge_recon_loss: 40356448.0000; val_gene_expr_recon_loss: 4162636.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1570196.6250; val_global_loss: 46155064.0000; val_optim_loss: 46155064.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8676; val_auprc_score: 0.8564; val_best_acc_score: 0.7836; val_best_f1_score: 0.7944; train_kl_reg_loss: 83817.5608; train_edge_recon_loss: 34713624.0000; train_gene_expr_recon_loss: 4130682.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1590597.8472; train_global_loss: 40518722.6667; train_optim_loss: 40518722.6667; val_kl_reg_loss: 64794.2500; val_edge_recon_loss: 40081920.0000; val_gene_expr_recon_loss: 4100510.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1560585.2500; val_global_loss: 45807808.0000; val_optim_loss: 45807808.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8680; val_auprc_score: 0.8519; val_best_acc_score: 0.7649; val_best_f1_score: 0.8015; train_kl_reg_loss: 71305.7509; train_edge_recon_loss: 34681051.1111; train_gene_expr_recon_loss: 4067800.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1576414.7500; train_global_loss: 40396572.8889; train_optim_loss: 40396572.8889; val_kl_reg_loss: 54312.2344; val_edge_recon_loss: 39216164.0000; val_gene_expr_recon_loss: 4066555.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1555427.3750; val_global_loss: 44892460.0000; val_optim_loss: 44892460.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8768; val_auprc_score: 0.8575; val_best_acc_score: 0.7987; val_best_f1_score: 0.8158; train_kl_reg_loss: 51144.8082; train_edge_recon_loss: 34466906.2222; train_gene_expr_recon_loss: 4084928.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1580553.5833; train_global_loss: 40183532.4444; train_optim_loss: 40183532.4444; val_kl_reg_loss: 23336.0605; val_edge_recon_loss: 35722852.0000; val_gene_expr_recon_loss: 4150490.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1560369.5000; val_global_loss: 41457048.0000; val_optim_loss: 41457048.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8379; val_auprc_score: 0.8245; val_best_acc_score: 0.7400; val_best_f1_score: 0.7785; train_kl_reg_loss: 13253.3133; train_edge_recon_loss: 32251876.4444; train_gene_expr_recon_loss: 4426303.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1600852.4861; train_global_loss: 38292286.6667; train_optim_loss: 38292286.6667; val_kl_reg_loss: 10830.3867; val_edge_recon_loss: 30018548.0000; val_gene_expr_recon_loss: 4554174.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1600317.0000; val_global_loss: 36183868.0000; val_optim_loss: 36183868.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8508; val_auprc_score: 0.8370; val_best_acc_score: 0.7518; val_best_f1_score: 0.7833; train_kl_reg_loss: 19137.7920; train_edge_recon_loss: 29321298.2222; train_gene_expr_recon_loss: 4567390.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1623641.3889; train_global_loss: 35531468.8889; train_optim_loss: 35531468.8889; val_kl_reg_loss: 24707.7480; val_edge_recon_loss: 29061986.0000; val_gene_expr_recon_loss: 4481549.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1594965.5000; val_global_loss: 35163208.0000; val_optim_loss: 35163208.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8545; val_auprc_score: 0.8412; val_best_acc_score: 0.7549; val_best_f1_score: 0.7853; train_kl_reg_loss: 35278.2051; train_edge_recon_loss: 28963100.0000; train_gene_expr_recon_loss: 4361901.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1607151.4583; train_global_loss: 34967431.5556; train_optim_loss: 34967431.5556; val_kl_reg_loss: 39099.0312; val_edge_recon_loss: 29105982.0000; val_gene_expr_recon_loss: 4311060.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1580579.0000; val_global_loss: 35036720.0000; val_optim_loss: 35036720.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8707; val_auprc_score: 0.8569; val_best_acc_score: 0.7705; val_best_f1_score: 0.7927; train_kl_reg_loss: 49612.7561; train_edge_recon_loss: 28814525.1111; train_gene_expr_recon_loss: 4264350.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1599665.5000; train_global_loss: 34728154.2222; train_optim_loss: 34728154.2222; val_kl_reg_loss: 56955.5156; val_edge_recon_loss: 28572768.0000; val_gene_expr_recon_loss: 4221868.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1575059.7500; val_global_loss: 34426652.0000; val_optim_loss: 34426652.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8782; val_auprc_score: 0.8668; val_best_acc_score: 0.7835; val_best_f1_score: 0.7980; train_kl_reg_loss: 60940.4557; train_edge_recon_loss: 28615165.1111; train_gene_expr_recon_loss: 4196736.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1592338.0000; train_global_loss: 34465180.0000; train_optim_loss: 34465180.0000; val_kl_reg_loss: 63873.9062; val_edge_recon_loss: 28463998.0000; val_gene_expr_recon_loss: 4179213.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1570424.7500; val_global_loss: 34277512.0000; val_optim_loss: 34277512.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8758; val_auprc_score: 0.8622; val_best_acc_score: 0.7850; val_best_f1_score: 0.7929; train_kl_reg_loss: 66348.5503; train_edge_recon_loss: 28468461.5556; train_gene_expr_recon_loss: 4182902.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1581479.4583; train_global_loss: 34299191.5556; train_optim_loss: 34299191.5556; val_kl_reg_loss: 65442.3359; val_edge_recon_loss: 28864146.0000; val_gene_expr_recon_loss: 4165629.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1566793.8750; val_global_loss: 34662008.0000; val_optim_loss: 34662008.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8848; val_auprc_score: 0.8693; val_best_acc_score: 0.7920; val_best_f1_score: 0.8052; train_kl_reg_loss: 70760.8898; train_edge_recon_loss: 28192166.8889; train_gene_expr_recon_loss: 4138714.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1573274.2778; train_global_loss: 33974916.4444; train_optim_loss: 33974916.4444; val_kl_reg_loss: 64996.0625; val_edge_recon_loss: 28142202.0000; val_gene_expr_recon_loss: 4173031.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1566204.5000; val_global_loss: 33946436.0000; val_optim_loss: 33946436.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8973; val_auprc_score: 0.8803; val_best_acc_score: 0.8036; val_best_f1_score: 0.8192; train_kl_reg_loss: 68354.7231; train_edge_recon_loss: 28253157.7778; train_gene_expr_recon_loss: 4167238.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1591998.2361; train_global_loss: 34080748.8889; train_optim_loss: 34080748.8889; val_kl_reg_loss: 67501.3281; val_edge_recon_loss: 28135550.0000; val_gene_expr_recon_loss: 4152835.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1562738.3750; val_global_loss: 33918628.0000; val_optim_loss: 33918628.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9079; val_auprc_score: 0.8850; val_best_acc_score: 0.8325; val_best_f1_score: 0.8442; train_kl_reg_loss: 66938.0026; train_edge_recon_loss: 28021361.5556; train_gene_expr_recon_loss: 4140032.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1574323.3333; train_global_loss: 33802655.7778; train_optim_loss: 33802655.7778; val_kl_reg_loss: 62085.1016; val_edge_recon_loss: 27482876.0000; val_gene_expr_recon_loss: 4162161.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1563630.0000; val_global_loss: 33270754.0000; val_optim_loss: 33270754.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9219; val_auprc_score: 0.8963; val_best_acc_score: 0.8549; val_best_f1_score: 0.8636; train_kl_reg_loss: 63177.3911; train_edge_recon_loss: 27691945.3333; train_gene_expr_recon_loss: 4108670.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1572339.0556; train_global_loss: 33436132.2222; train_optim_loss: 33436132.2222; val_kl_reg_loss: 60641.8125; val_edge_recon_loss: 27590004.0000; val_gene_expr_recon_loss: 4161457.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1563969.7500; val_global_loss: 33376074.0000; val_optim_loss: 33376074.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9322; val_auprc_score: 0.9095; val_best_acc_score: 0.8682; val_best_f1_score: 0.8749; train_kl_reg_loss: 62270.5764; train_edge_recon_loss: 27271328.4444; train_gene_expr_recon_loss: 4124945.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1577628.1944; train_global_loss: 33036172.6667; train_optim_loss: 33036172.6667; val_kl_reg_loss: 60524.6328; val_edge_recon_loss: 27466210.0000; val_gene_expr_recon_loss: 4162290.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1560525.7500; val_global_loss: 33249550.0000; val_optim_loss: 33249550.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9360; val_auprc_score: 0.9136; val_best_acc_score: 0.8766; val_best_f1_score: 0.8824; train_kl_reg_loss: 67401.0152; train_edge_recon_loss: 27121900.4444; train_gene_expr_recon_loss: 4115954.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1576278.0417; train_global_loss: 32881534.0000; train_optim_loss: 32881534.0000; val_kl_reg_loss: 68463.0000; val_edge_recon_loss: 27210820.0000; val_gene_expr_recon_loss: 4129825.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1555823.5000; val_global_loss: 32964934.0000; val_optim_loss: 32964934.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9420; val_auprc_score: 0.9237; val_best_acc_score: 0.8797; val_best_f1_score: 0.8859; train_kl_reg_loss: 74198.4983; train_edge_recon_loss: 27072013.5556; train_gene_expr_recon_loss: 4102040.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1574593.0000; train_global_loss: 32822844.8889; train_optim_loss: 32822844.8889; val_kl_reg_loss: 75986.5000; val_edge_recon_loss: 27074688.0000; val_gene_expr_recon_loss: 4096024.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1554508.3750; val_global_loss: 32801206.0000; val_optim_loss: 32801206.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9439; val_auprc_score: 0.9296; val_best_acc_score: 0.8810; val_best_f1_score: 0.8865; train_kl_reg_loss: 81177.5321; train_edge_recon_loss: 27061044.0000; train_gene_expr_recon_loss: 4051598.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1560905.8056; train_global_loss: 32754725.7778; train_optim_loss: 32754725.7778; val_kl_reg_loss: 81828.1719; val_edge_recon_loss: 27269814.0000; val_gene_expr_recon_loss: 4071046.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1549969.2500; val_global_loss: 32972658.0000; val_optim_loss: 32972658.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9465; val_auprc_score: 0.9316; val_best_acc_score: 0.8818; val_best_f1_score: 0.8875; train_kl_reg_loss: 86052.8689; train_edge_recon_loss: 26856576.6667; train_gene_expr_recon_loss: 4054924.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1575590.9167; train_global_loss: 32573144.0000; train_optim_loss: 32573144.0000; val_kl_reg_loss: 82940.0312; val_edge_recon_loss: 26934696.0000; val_gene_expr_recon_loss: 4058825.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1546524.7500; val_global_loss: 32622984.0000; val_optim_loss: 32622984.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9541; val_auprc_score: 0.9352; val_best_acc_score: 0.8979; val_best_f1_score: 0.9014; train_kl_reg_loss: 86354.0851; train_edge_recon_loss: 26794122.2222; train_gene_expr_recon_loss: 4048708.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1563475.7361; train_global_loss: 32492660.8889; train_optim_loss: 32492660.8889; val_kl_reg_loss: 82334.7031; val_edge_recon_loss: 26671564.0000; val_gene_expr_recon_loss: 4052901.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1545315.7500; val_global_loss: 32352116.0000; val_optim_loss: 32352116.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9485; val_auprc_score: 0.9292; val_best_acc_score: 0.8928; val_best_f1_score: 0.8990; train_kl_reg_loss: 86008.1979; train_edge_recon_loss: 26764583.7778; train_gene_expr_recon_loss: 4039211.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1555423.9722; train_global_loss: 32445227.3333; train_optim_loss: 32445227.3333; val_kl_reg_loss: 82855.0000; val_edge_recon_loss: 26920694.0000; val_gene_expr_recon_loss: 4047252.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1545225.2500; val_global_loss: 32596026.0000; val_optim_loss: 32596026.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9525; val_auprc_score: 0.9348; val_best_acc_score: 0.8994; val_best_f1_score: 0.9039; train_kl_reg_loss: 84333.4731; train_edge_recon_loss: 26847290.0000; train_gene_expr_recon_loss: 4036147.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1566318.7917; train_global_loss: 32534088.8889; train_optim_loss: 32534088.8889; val_kl_reg_loss: 81209.9844; val_edge_recon_loss: 26932108.0000; val_gene_expr_recon_loss: 4034589.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1543666.0000; val_global_loss: 32591574.0000; val_optim_loss: 32591574.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9527; val_auprc_score: 0.9287; val_best_acc_score: 0.8998; val_best_f1_score: 0.9045; train_kl_reg_loss: 82349.4002; train_edge_recon_loss: 26660280.6667; train_gene_expr_recon_loss: 4000691.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1553825.2222; train_global_loss: 32297145.7778; train_optim_loss: 32297145.7778; val_kl_reg_loss: 79863.9688; val_edge_recon_loss: 26934438.0000; val_gene_expr_recon_loss: 4017537.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1540159.0000; val_global_loss: 32572000.0000; val_optim_loss: 32572000.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9552; val_auprc_score: 0.9327; val_best_acc_score: 0.9051; val_best_f1_score: 0.9106; train_kl_reg_loss: 83365.0842; train_edge_recon_loss: 26629380.4444; train_gene_expr_recon_loss: 4003510.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1554080.4028; train_global_loss: 32270336.8889; train_optim_loss: 32270336.8889; val_kl_reg_loss: 81394.3828; val_edge_recon_loss: 26771184.0000; val_gene_expr_recon_loss: 4001195.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1536895.5000; val_global_loss: 32390670.0000; val_optim_loss: 32390670.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9585; val_auprc_score: 0.9369; val_best_acc_score: 0.9127; val_best_f1_score: 0.9169; train_kl_reg_loss: 83651.2257; train_edge_recon_loss: 26472369.7778; train_gene_expr_recon_loss: 4011534.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1551505.7083; train_global_loss: 32119061.3333; train_optim_loss: 32119061.3333; val_kl_reg_loss: 81854.2500; val_edge_recon_loss: 26521742.0000; val_gene_expr_recon_loss: 3992774.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1536746.0000; val_global_loss: 32133116.0000; val_optim_loss: 32133116.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9541; val_auprc_score: 0.9359; val_best_acc_score: 0.9016; val_best_f1_score: 0.9072; train_kl_reg_loss: 85021.5920; train_edge_recon_loss: 26665526.4444; train_gene_expr_recon_loss: 4001383.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1551566.3472; train_global_loss: 32303497.7778; train_optim_loss: 32303497.7778; val_kl_reg_loss: 82438.1484; val_edge_recon_loss: 27040592.0000; val_gene_expr_recon_loss: 3995502.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1538028.2500; val_global_loss: 32656560.0000; val_optim_loss: 32656560.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9608; val_auprc_score: 0.9465; val_best_acc_score: 0.9097; val_best_f1_score: 0.9144; train_kl_reg_loss: 84610.0660; train_edge_recon_loss: 26724208.0000; train_gene_expr_recon_loss: 3966911.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1556322.6528; train_global_loss: 32332051.7778; train_optim_loss: 32332051.7778; val_kl_reg_loss: 83014.7969; val_edge_recon_loss: 26678442.0000; val_gene_expr_recon_loss: 3996524.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1537591.5000; val_global_loss: 32295572.0000; val_optim_loss: 32295572.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9565; val_auprc_score: 0.9379; val_best_acc_score: 0.9043; val_best_f1_score: 0.9097; train_kl_reg_loss: 84736.5373; train_edge_recon_loss: 26607578.2222; train_gene_expr_recon_loss: 3982569.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1551580.5833; train_global_loss: 32226464.4444; train_optim_loss: 32226464.4444; val_kl_reg_loss: 83165.6953; val_edge_recon_loss: 26807358.0000; val_gene_expr_recon_loss: 3991274.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1537726.2500; val_global_loss: 32419524.0000; val_optim_loss: 32419524.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9586; val_auprc_score: 0.9425; val_best_acc_score: 0.9078; val_best_f1_score: 0.9128; train_kl_reg_loss: 86252.6050; train_edge_recon_loss: 26701456.4444; train_gene_expr_recon_loss: 3993944.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1554652.2917; train_global_loss: 32336305.7778; train_optim_loss: 32336305.7778; val_kl_reg_loss: 82340.7578; val_edge_recon_loss: 26839960.0000; val_gene_expr_recon_loss: 3994029.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1535982.1250; val_global_loss: 32452312.0000; val_optim_loss: 32452312.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9608; val_auprc_score: 0.9443; val_best_acc_score: 0.9116; val_best_f1_score: 0.9152; train_kl_reg_loss: 84763.8767; train_edge_recon_loss: 26533947.3333; train_gene_expr_recon_loss: 3985632.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1548610.9167; train_global_loss: 32152954.0000; train_optim_loss: 32152954.0000; val_kl_reg_loss: 82799.8125; val_edge_recon_loss: 26784000.0000; val_gene_expr_recon_loss: 3994339.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1535472.6250; val_global_loss: 32396612.0000; val_optim_loss: 32396612.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9592; val_auprc_score: 0.9433; val_best_acc_score: 0.9107; val_best_f1_score: 0.9152; train_kl_reg_loss: 85372.6302; train_edge_recon_loss: 26450207.1111; train_gene_expr_recon_loss: 3986397.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1556366.9167; train_global_loss: 32078343.7778; train_optim_loss: 32078343.7778; val_kl_reg_loss: 83029.0781; val_edge_recon_loss: 26743832.0000; val_gene_expr_recon_loss: 3990660.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1537427.7500; val_global_loss: 32354950.0000; val_optim_loss: 32354950.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9595; val_auprc_score: 0.9420; val_best_acc_score: 0.9093; val_best_f1_score: 0.9141; train_kl_reg_loss: 85586.3750; train_edge_recon_loss: 26499294.0000; train_gene_expr_recon_loss: 3997665.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1564416.6111; train_global_loss: 32146962.8889; train_optim_loss: 32146962.8889; val_kl_reg_loss: 82914.5156; val_edge_recon_loss: 26668194.0000; val_gene_expr_recon_loss: 3991473.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1535027.0000; val_global_loss: 32277608.0000; val_optim_loss: 32277608.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9589; val_auprc_score: 0.9428; val_best_acc_score: 0.9105; val_best_f1_score: 0.9151; train_kl_reg_loss: 85379.8490; train_edge_recon_loss: 26642245.1111; train_gene_expr_recon_loss: 3993624.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1550445.2222; train_global_loss: 32271694.4444; train_optim_loss: 32271694.4444; val_kl_reg_loss: 82907.1406; val_edge_recon_loss: 26713144.0000; val_gene_expr_recon_loss: 3994364.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1536954.6250; val_global_loss: 32327370.0000; val_optim_loss: 32327370.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 38 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9589
val AUPRC score: 0.9416
val best accuracy score: 0.9103
val best F1 score: 0.9143
val target rna MSE score: 2.2638
val source rna MSE score: 1.1941
val target atac MSE score: 0.1222
val source atac MSE score: 0.0205
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
