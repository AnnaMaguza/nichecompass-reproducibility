[True]
Run timestamp: 10102023_032859_127.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_127']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7038; val_auprc_score: 0.6715; val_best_acc_score: 0.5129; val_best_f1_score: 0.6719; train_kl_reg_loss: 48249.8839; train_edge_recon_loss: 3522169.3220; train_gene_expr_recon_loss: 14254911.7121; train_masked_gp_l1_reg_loss: 44857.3269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5656361.5038; train_chrom_access_recon_loss: 11573600.3788; train_global_loss: 35100149.9091; train_optim_loss: 35100149.9091; val_kl_reg_loss: 55457.4468; val_edge_recon_loss: 4064435.7500; val_gene_expr_recon_loss: 13347429.8750; val_masked_gp_l1_reg_loss: 54238.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2721806.2500; val_chrom_access_recon_loss: 11301297.1250; val_global_loss: 31544664.2500; val_optim_loss: 31544664.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6911; val_auprc_score: 0.6610; val_best_acc_score: 0.6222; val_best_f1_score: 0.6993; train_kl_reg_loss: 92852.8491; train_edge_recon_loss: 3522881.5985; train_gene_expr_recon_loss: 12911156.0152; train_masked_gp_l1_reg_loss: 57520.6948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1310571.2311; train_chrom_access_recon_loss: 11044182.9697; train_global_loss: 28939165.2424; train_optim_loss: 28939165.2424; val_kl_reg_loss: 89052.8311; val_edge_recon_loss: 4056279.2500; val_gene_expr_recon_loss: 12818304.7500; val_masked_gp_l1_reg_loss: 59047.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 557589.6875; val_chrom_access_recon_loss: 11133134.3750; val_global_loss: 28713409.0000; val_optim_loss: 28713409.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6906; val_auprc_score: 0.6618; val_best_acc_score: 0.6413; val_best_f1_score: 0.6897; train_kl_reg_loss: 91406.8137; train_edge_recon_loss: 3512986.3333; train_gene_expr_recon_loss: 12709018.6061; train_masked_gp_l1_reg_loss: 60480.6031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 380583.2670; train_chrom_access_recon_loss: 10948157.3333; train_global_loss: 27702632.8485; train_optim_loss: 27702632.8485; val_kl_reg_loss: 90704.0938; val_edge_recon_loss: 4043380.6562; val_gene_expr_recon_loss: 12680906.2500; val_masked_gp_l1_reg_loss: 61959.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 270065.8125; val_chrom_access_recon_loss: 10942489.2500; val_global_loss: 28089505.7500; val_optim_loss: 28089505.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7532; val_auprc_score: 0.7319; val_best_acc_score: 0.6908; val_best_f1_score: 0.7267; train_kl_reg_loss: 81929.0763; train_edge_recon_loss: 3503424.8333; train_gene_expr_recon_loss: 12604603.4091; train_masked_gp_l1_reg_loss: 62946.7939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 221291.6598; train_chrom_access_recon_loss: 10884207.3485; train_global_loss: 27358403.2727; train_optim_loss: 27358403.2727; val_kl_reg_loss: 74958.0420; val_edge_recon_loss: 3931894.9062; val_gene_expr_recon_loss: 12730646.3750; val_masked_gp_l1_reg_loss: 64114.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 187007.3281; val_chrom_access_recon_loss: 10989175.8750; val_global_loss: 27977796.7500; val_optim_loss: 27977796.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7722; val_auprc_score: 0.7606; val_best_acc_score: 0.6959; val_best_f1_score: 0.7319; train_kl_reg_loss: 65268.4000; train_edge_recon_loss: 3382560.9848; train_gene_expr_recon_loss: 12541361.2576; train_masked_gp_l1_reg_loss: 65721.0700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166969.0213; train_chrom_access_recon_loss: 10817496.6212; train_global_loss: 27039377.4545; train_optim_loss: 27039377.4545; val_kl_reg_loss: 75608.1113; val_edge_recon_loss: 3302629.5000; val_gene_expr_recon_loss: 12628004.7500; val_masked_gp_l1_reg_loss: 68096.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150587.6875; val_chrom_access_recon_loss: 10905701.0000; val_global_loss: 27130628.5000; val_optim_loss: 27130628.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8167; val_auprc_score: 0.7881; val_best_acc_score: 0.7367; val_best_f1_score: 0.7755; train_kl_reg_loss: 83609.5856; train_edge_recon_loss: 3114929.2045; train_gene_expr_recon_loss: 12480654.4848; train_masked_gp_l1_reg_loss: 70211.0779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140129.4948; train_chrom_access_recon_loss: 10751429.7879; train_global_loss: 26640963.6061; train_optim_loss: 26640963.6061; val_kl_reg_loss: 90842.3545; val_edge_recon_loss: 3071965.2500; val_gene_expr_recon_loss: 12580998.7500; val_masked_gp_l1_reg_loss: 72246.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131348.5938; val_chrom_access_recon_loss: 10852640.6250; val_global_loss: 26800043.0000; val_optim_loss: 26800043.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8762; val_auprc_score: 0.8450; val_best_acc_score: 0.8066; val_best_f1_score: 0.8275; train_kl_reg_loss: 98559.0608; train_edge_recon_loss: 2950978.7803; train_gene_expr_recon_loss: 12410771.7424; train_masked_gp_l1_reg_loss: 74294.5268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126815.4529; train_chrom_access_recon_loss: 10683801.4242; train_global_loss: 26345221.0303; train_optim_loss: 26345221.0303; val_kl_reg_loss: 99737.2354; val_edge_recon_loss: 2912046.1250; val_gene_expr_recon_loss: 12516689.1250; val_masked_gp_l1_reg_loss: 76285.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122232.0391; val_chrom_access_recon_loss: 10826207.3750; val_global_loss: 26553197.5000; val_optim_loss: 26553197.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8949; val_auprc_score: 0.8636; val_best_acc_score: 0.8318; val_best_f1_score: 0.8438; train_kl_reg_loss: 102082.6404; train_edge_recon_loss: 2892573.0000; train_gene_expr_recon_loss: 12341009.6061; train_masked_gp_l1_reg_loss: 77637.8473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119115.3106; train_chrom_access_recon_loss: 10631089.7121; train_global_loss: 26163508.3030; train_optim_loss: 26163508.3030; val_kl_reg_loss: 104627.0000; val_edge_recon_loss: 2889509.7188; val_gene_expr_recon_loss: 12378679.6250; val_masked_gp_l1_reg_loss: 78991.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116147.7969; val_chrom_access_recon_loss: 10827178.6250; val_global_loss: 26395134.0000; val_optim_loss: 26395134.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8983; val_auprc_score: 0.8556; val_best_acc_score: 0.8428; val_best_f1_score: 0.8549; train_kl_reg_loss: 105649.3537; train_edge_recon_loss: 2840663.7235; train_gene_expr_recon_loss: 12288928.9091; train_masked_gp_l1_reg_loss: 79775.8815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114203.4566; train_chrom_access_recon_loss: 10601891.2121; train_global_loss: 26031112.7273; train_optim_loss: 26031112.7273; val_kl_reg_loss: 108716.3223; val_edge_recon_loss: 2838490.1875; val_gene_expr_recon_loss: 12379953.0000; val_masked_gp_l1_reg_loss: 80844.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112881.1094; val_chrom_access_recon_loss: 10708163.7500; val_global_loss: 26229048.2500; val_optim_loss: 26229048.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8957; val_auprc_score: 0.8616; val_best_acc_score: 0.8307; val_best_f1_score: 0.8456; train_kl_reg_loss: 104385.2126; train_edge_recon_loss: 2819416.2045; train_gene_expr_recon_loss: 12241860.5152; train_masked_gp_l1_reg_loss: 81598.9311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111983.4203; train_chrom_access_recon_loss: 10562888.7273; train_global_loss: 25922133.1818; train_optim_loss: 25922133.1818; val_kl_reg_loss: 103605.6543; val_edge_recon_loss: 2859411.9062; val_gene_expr_recon_loss: 12406873.8750; val_masked_gp_l1_reg_loss: 82292.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110729.9531; val_chrom_access_recon_loss: 10761790.7500; val_global_loss: 26324704.0000; val_optim_loss: 26324704.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9036; val_auprc_score: 0.8675; val_best_acc_score: 0.8428; val_best_f1_score: 0.8537; train_kl_reg_loss: 102961.5813; train_edge_recon_loss: 2815658.4811; train_gene_expr_recon_loss: 12179158.2727; train_masked_gp_l1_reg_loss: 82878.1346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110038.1991; train_chrom_access_recon_loss: 10514020.8182; train_global_loss: 25804715.4848; train_optim_loss: 25804715.4848; val_kl_reg_loss: 99464.9443; val_edge_recon_loss: 2852938.0312; val_gene_expr_recon_loss: 12210942.3750; val_masked_gp_l1_reg_loss: 83598.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109331.2344; val_chrom_access_recon_loss: 10640770.5000; val_global_loss: 25997044.5000; val_optim_loss: 25997044.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9034; val_auprc_score: 0.8732; val_best_acc_score: 0.8458; val_best_f1_score: 0.8542; train_kl_reg_loss: 100652.9498; train_edge_recon_loss: 2817892.5417; train_gene_expr_recon_loss: 12134360.8182; train_masked_gp_l1_reg_loss: 84118.6023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108772.3550; train_chrom_access_recon_loss: 10484402.2424; train_global_loss: 25730199.3636; train_optim_loss: 25730199.3636; val_kl_reg_loss: 100242.4912; val_edge_recon_loss: 2826922.6875; val_gene_expr_recon_loss: 12157525.7500; val_masked_gp_l1_reg_loss: 84718.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107823.5156; val_chrom_access_recon_loss: 10548904.3750; val_global_loss: 25826137.2500; val_optim_loss: 25826137.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9160; val_auprc_score: 0.8788; val_best_acc_score: 0.8592; val_best_f1_score: 0.8668; train_kl_reg_loss: 98986.5200; train_edge_recon_loss: 2814057.5568; train_gene_expr_recon_loss: 12102847.8485; train_masked_gp_l1_reg_loss: 85091.2544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107247.9921; train_chrom_access_recon_loss: 10463771.0455; train_global_loss: 25672002.0000; train_optim_loss: 25672002.0000; val_kl_reg_loss: 96415.8750; val_edge_recon_loss: 2801456.3125; val_gene_expr_recon_loss: 12175595.2500; val_masked_gp_l1_reg_loss: 85552.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107509.6094; val_chrom_access_recon_loss: 10522650.5000; val_global_loss: 25789181.0000; val_optim_loss: 25789181.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9112; val_auprc_score: 0.8760; val_best_acc_score: 0.8571; val_best_f1_score: 0.8644; train_kl_reg_loss: 96657.1679; train_edge_recon_loss: 2796921.2045; train_gene_expr_recon_loss: 12057816.8030; train_masked_gp_l1_reg_loss: 85901.1164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106622.7457; train_chrom_access_recon_loss: 10427019.9545; train_global_loss: 25570938.9091; train_optim_loss: 25570938.9091; val_kl_reg_loss: 94601.0645; val_edge_recon_loss: 2843230.2188; val_gene_expr_recon_loss: 12126984.2500; val_masked_gp_l1_reg_loss: 86320.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106090.4922; val_chrom_access_recon_loss: 10495504.8750; val_global_loss: 25752731.0000; val_optim_loss: 25752731.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9140; val_auprc_score: 0.8828; val_best_acc_score: 0.8576; val_best_f1_score: 0.8682; train_kl_reg_loss: 95800.8248; train_edge_recon_loss: 2806153.9470; train_gene_expr_recon_loss: 12018815.9394; train_masked_gp_l1_reg_loss: 86661.9500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105273.6897; train_chrom_access_recon_loss: 10396884.1515; train_global_loss: 25509590.3939; train_optim_loss: 25509590.3939; val_kl_reg_loss: 94821.1328; val_edge_recon_loss: 2807075.2812; val_gene_expr_recon_loss: 11956998.7500; val_masked_gp_l1_reg_loss: 87074.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104806.2891; val_chrom_access_recon_loss: 10468095.1250; val_global_loss: 25518870.0000; val_optim_loss: 25518870.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9162; val_auprc_score: 0.8879; val_best_acc_score: 0.8584; val_best_f1_score: 0.8667; train_kl_reg_loss: 94390.4130; train_edge_recon_loss: 2772055.0871; train_gene_expr_recon_loss: 11964903.3939; train_masked_gp_l1_reg_loss: 87322.1842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103657.1306; train_chrom_access_recon_loss: 10348646.3939; train_global_loss: 25370974.4848; train_optim_loss: 25370974.4848; val_kl_reg_loss: 95541.4131; val_edge_recon_loss: 2821273.4062; val_gene_expr_recon_loss: 12022049.5000; val_masked_gp_l1_reg_loss: 87613.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103296.8047; val_chrom_access_recon_loss: 10496052.5000; val_global_loss: 25625826.5000; val_optim_loss: 25625826.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9109; val_auprc_score: 0.8860; val_best_acc_score: 0.8541; val_best_f1_score: 0.8638; train_kl_reg_loss: 94237.1754; train_edge_recon_loss: 2772353.0152; train_gene_expr_recon_loss: 11935868.0758; train_masked_gp_l1_reg_loss: 87896.6108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102339.7391; train_chrom_access_recon_loss: 10312288.2576; train_global_loss: 25304982.7879; train_optim_loss: 25304982.7879; val_kl_reg_loss: 94572.7129; val_edge_recon_loss: 2840568.4375; val_gene_expr_recon_loss: 12074663.5000; val_masked_gp_l1_reg_loss: 88217.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102290.5312; val_chrom_access_recon_loss: 10483892.0000; val_global_loss: 25684204.5000; val_optim_loss: 25684204.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9243; val_auprc_score: 0.8963; val_best_acc_score: 0.8710; val_best_f1_score: 0.8782; train_kl_reg_loss: 91980.4534; train_edge_recon_loss: 2767161.5530; train_gene_expr_recon_loss: 11900640.1212; train_masked_gp_l1_reg_loss: 88375.1696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101036.3482; train_chrom_access_recon_loss: 10287446.0606; train_global_loss: 25236639.7879; train_optim_loss: 25236639.7879; val_kl_reg_loss: 91957.4990; val_edge_recon_loss: 2765169.6562; val_gene_expr_recon_loss: 12091639.3750; val_masked_gp_l1_reg_loss: 88594.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100060.8125; val_chrom_access_recon_loss: 10501071.6250; val_global_loss: 25638492.7500; val_optim_loss: 25638492.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9199; val_auprc_score: 0.8950; val_best_acc_score: 0.8576; val_best_f1_score: 0.8675; train_kl_reg_loss: 90899.5073; train_edge_recon_loss: 2776987.9886; train_gene_expr_recon_loss: 11889046.2273; train_masked_gp_l1_reg_loss: 88718.9167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99480.8867; train_chrom_access_recon_loss: 10270998.9848; train_global_loss: 25216132.6364; train_optim_loss: 25216132.6364; val_kl_reg_loss: 85828.3057; val_edge_recon_loss: 2842569.0000; val_gene_expr_recon_loss: 11889085.1250; val_masked_gp_l1_reg_loss: 89089.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99107.2031; val_chrom_access_recon_loss: 10326905.8750; val_global_loss: 25332585.0000; val_optim_loss: 25332585.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9229; val_auprc_score: 0.8952; val_best_acc_score: 0.8627; val_best_f1_score: 0.8715; train_kl_reg_loss: 90445.6184; train_edge_recon_loss: 2772063.5038; train_gene_expr_recon_loss: 11857026.4848; train_masked_gp_l1_reg_loss: 89365.1129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98591.7725; train_chrom_access_recon_loss: 10249090.7727; train_global_loss: 25156583.2727; train_optim_loss: 25156583.2727; val_kl_reg_loss: 90817.3564; val_edge_recon_loss: 2819623.4375; val_gene_expr_recon_loss: 11891276.3750; val_masked_gp_l1_reg_loss: 89500.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97936.2266; val_chrom_access_recon_loss: 10399906.7500; val_global_loss: 25389060.2500; val_optim_loss: 25389060.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9284; val_auprc_score: 0.8988; val_best_acc_score: 0.8748; val_best_f1_score: 0.8801; train_kl_reg_loss: 88885.2199; train_edge_recon_loss: 2760269.2500; train_gene_expr_recon_loss: 11832705.2121; train_masked_gp_l1_reg_loss: 89708.4715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97404.6326; train_chrom_access_recon_loss: 10217907.6667; train_global_loss: 25086880.4848; train_optim_loss: 25086880.4848; val_kl_reg_loss: 87455.2588; val_edge_recon_loss: 2747004.9688; val_gene_expr_recon_loss: 12005365.6250; val_masked_gp_l1_reg_loss: 90109.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97483.0469; val_chrom_access_recon_loss: 10399598.6250; val_global_loss: 25427017.2500; val_optim_loss: 25427017.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9299; val_auprc_score: 0.9023; val_best_acc_score: 0.8724; val_best_f1_score: 0.8801; train_kl_reg_loss: 88800.5188; train_edge_recon_loss: 2751137.6894; train_gene_expr_recon_loss: 11802340.6818; train_masked_gp_l1_reg_loss: 90207.5774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96544.3082; train_chrom_access_recon_loss: 10197759.8333; train_global_loss: 25026790.6364; train_optim_loss: 25026790.6364; val_kl_reg_loss: 88298.4541; val_edge_recon_loss: 2760650.9062; val_gene_expr_recon_loss: 11904686.5000; val_masked_gp_l1_reg_loss: 90340.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96070.1250; val_chrom_access_recon_loss: 10370587.0000; val_global_loss: 25310634.2500; val_optim_loss: 25310634.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9304; val_auprc_score: 0.9068; val_best_acc_score: 0.8708; val_best_f1_score: 0.8765; train_kl_reg_loss: 87780.3030; train_edge_recon_loss: 2755119.3636; train_gene_expr_recon_loss: 11776910.3485; train_masked_gp_l1_reg_loss: 90475.4879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95927.7411; train_chrom_access_recon_loss: 10165616.2424; train_global_loss: 24971829.4848; train_optim_loss: 24971829.4848; val_kl_reg_loss: 91426.3535; val_edge_recon_loss: 2784773.6250; val_gene_expr_recon_loss: 11770463.1250; val_masked_gp_l1_reg_loss: 90585.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94963.4375; val_chrom_access_recon_loss: 10243328.1250; val_global_loss: 25075540.5000; val_optim_loss: 25075540.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9238; val_auprc_score: 0.8988; val_best_acc_score: 0.8627; val_best_f1_score: 0.8703; train_kl_reg_loss: 89618.9254; train_edge_recon_loss: 2746282.2879; train_gene_expr_recon_loss: 11767732.3182; train_masked_gp_l1_reg_loss: 90645.1903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94885.7089; train_chrom_access_recon_loss: 10147362.0758; train_global_loss: 24936526.3333; train_optim_loss: 24936526.3333; val_kl_reg_loss: 89501.5518; val_edge_recon_loss: 2805693.3750; val_gene_expr_recon_loss: 11761198.6250; val_masked_gp_l1_reg_loss: 90708.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95014.3516; val_chrom_access_recon_loss: 10240198.2500; val_global_loss: 25082315.0000; val_optim_loss: 25082315.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9324; val_auprc_score: 0.9096; val_best_acc_score: 0.8718; val_best_f1_score: 0.8789; train_kl_reg_loss: 86324.2546; train_edge_recon_loss: 2752031.2841; train_gene_expr_recon_loss: 11735273.7121; train_masked_gp_l1_reg_loss: 90834.8084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94411.4544; train_chrom_access_recon_loss: 10128041.0606; train_global_loss: 24886916.3939; train_optim_loss: 24886916.3939; val_kl_reg_loss: 85239.6816; val_edge_recon_loss: 2755721.2812; val_gene_expr_recon_loss: 11864193.0000; val_masked_gp_l1_reg_loss: 91018.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94830.1406; val_chrom_access_recon_loss: 10305160.6250; val_global_loss: 25196163.5000; val_optim_loss: 25196163.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9270; val_auprc_score: 0.9015; val_best_acc_score: 0.8708; val_best_f1_score: 0.8783; train_kl_reg_loss: 112009.7654; train_edge_recon_loss: 2857565.3902; train_gene_expr_recon_loss: 10811617.2121; train_masked_gp_l1_reg_loss: 91120.5458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95974.7968; train_chrom_access_recon_loss: 9485515.8182; train_global_loss: 23453803.5152; train_optim_loss: 23453803.5152; val_kl_reg_loss: 36516.9834; val_edge_recon_loss: 2809192.6250; val_gene_expr_recon_loss: 10752515.7500; val_masked_gp_l1_reg_loss: 90853.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98232.4531; val_chrom_access_recon_loss: 9433035.3750; val_global_loss: 23220345.7500; val_optim_loss: 23220345.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9305; val_auprc_score: 0.9036; val_best_acc_score: 0.8756; val_best_f1_score: 0.8814; train_kl_reg_loss: 97580.3098; train_edge_recon_loss: 2770192.7538; train_gene_expr_recon_loss: 10763504.0758; train_masked_gp_l1_reg_loss: 90201.8526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97662.5929; train_chrom_access_recon_loss: 9376338.3333; train_global_loss: 23195479.9394; train_optim_loss: 23195479.9394; val_kl_reg_loss: 42676.1084; val_edge_recon_loss: 2810285.5000; val_gene_expr_recon_loss: 10935716.2500; val_masked_gp_l1_reg_loss: 89535.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96652.8672; val_chrom_access_recon_loss: 9678903.7500; val_global_loss: 23653769.2500; val_optim_loss: 23653769.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9305; val_auprc_score: 0.9049; val_best_acc_score: 0.8751; val_best_f1_score: 0.8830; train_kl_reg_loss: 82952.1431; train_edge_recon_loss: 2748553.3295; train_gene_expr_recon_loss: 10747169.9545; train_masked_gp_l1_reg_loss: 88805.3588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95986.7054; train_chrom_access_recon_loss: 9355537.9545; train_global_loss: 23119005.3030; train_optim_loss: 23119005.3030; val_kl_reg_loss: 47323.1851; val_edge_recon_loss: 2775564.7812; val_gene_expr_recon_loss: 10835459.8750; val_masked_gp_l1_reg_loss: 87931.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95877.7031; val_chrom_access_recon_loss: 9537460.5000; val_global_loss: 23379617.5000; val_optim_loss: 23379617.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9330; val_auprc_score: 0.9134; val_best_acc_score: 0.8740; val_best_f1_score: 0.8830; train_kl_reg_loss: 76511.2507; train_edge_recon_loss: 2733427.8712; train_gene_expr_recon_loss: 10713609.4242; train_masked_gp_l1_reg_loss: 87169.0773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95176.5620; train_chrom_access_recon_loss: 9322953.8939; train_global_loss: 23028848.1818; train_optim_loss: 23028848.1818; val_kl_reg_loss: 52707.2446; val_edge_recon_loss: 2763535.5312; val_gene_expr_recon_loss: 10838307.5000; val_masked_gp_l1_reg_loss: 86444.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94904.0547; val_chrom_access_recon_loss: 9495246.6250; val_global_loss: 23331145.5000; val_optim_loss: 23331145.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9224; val_auprc_score: 0.8881; val_best_acc_score: 0.8662; val_best_f1_score: 0.8768; train_kl_reg_loss: 73935.9454; train_edge_recon_loss: 2726409.7879; train_gene_expr_recon_loss: 10698947.9242; train_masked_gp_l1_reg_loss: 85709.6929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94360.5020; train_chrom_access_recon_loss: 9307719.6364; train_global_loss: 22987083.5152; train_optim_loss: 22987083.5152; val_kl_reg_loss: 55962.3506; val_edge_recon_loss: 2766615.5312; val_gene_expr_recon_loss: 10812951.2500; val_masked_gp_l1_reg_loss: 84854.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93695.8906; val_chrom_access_recon_loss: 9479898.6250; val_global_loss: 23293978.7500; val_optim_loss: 23293978.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9258; val_auprc_score: 0.8975; val_best_acc_score: 0.8684; val_best_f1_score: 0.8774; train_kl_reg_loss: 73331.7871; train_edge_recon_loss: 2724777.3333; train_gene_expr_recon_loss: 10680721.1970; train_masked_gp_l1_reg_loss: 84220.9594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78007.9809; train_chrom_access_recon_loss: 9384221.3939; train_global_loss: 23025280.6667; train_optim_loss: 23025280.6667; val_kl_reg_loss: 57217.1064; val_edge_recon_loss: 2762108.4375; val_gene_expr_recon_loss: 10785041.0000; val_masked_gp_l1_reg_loss: 83940.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74197.7109; val_chrom_access_recon_loss: 9573433.6250; val_global_loss: 23335939.2500; val_optim_loss: 23335939.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9306; val_auprc_score: 0.9046; val_best_acc_score: 0.8721; val_best_f1_score: 0.8816; train_kl_reg_loss: 73072.5376; train_edge_recon_loss: 2728130.8864; train_gene_expr_recon_loss: 10667068.2273; train_masked_gp_l1_reg_loss: 83836.9809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73764.0638; train_chrom_access_recon_loss: 9318091.3636; train_global_loss: 22943964.0000; train_optim_loss: 22943964.0000; val_kl_reg_loss: 56090.0205; val_edge_recon_loss: 2713055.5938; val_gene_expr_recon_loss: 10703861.5000; val_masked_gp_l1_reg_loss: 83742.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73489.3359; val_chrom_access_recon_loss: 9372381.2500; val_global_loss: 23002619.7500; val_optim_loss: 23002619.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9227; val_auprc_score: 0.8891; val_best_acc_score: 0.8643; val_best_f1_score: 0.8745; train_kl_reg_loss: 72085.9141; train_edge_recon_loss: 2726589.3333; train_gene_expr_recon_loss: 10666001.7273; train_masked_gp_l1_reg_loss: 83661.3052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73352.2888; train_chrom_access_recon_loss: 9293194.8788; train_global_loss: 22914885.3939; train_optim_loss: 22914885.3939; val_kl_reg_loss: 56936.1729; val_edge_recon_loss: 2770103.9375; val_gene_expr_recon_loss: 10721225.8750; val_masked_gp_l1_reg_loss: 83577.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73166.5078; val_chrom_access_recon_loss: 9441095.3750; val_global_loss: 23146105.0000; val_optim_loss: 23146105.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9287; val_auprc_score: 0.9056; val_best_acc_score: 0.8692; val_best_f1_score: 0.8770; train_kl_reg_loss: 71820.3082; train_edge_recon_loss: 2711625.5114; train_gene_expr_recon_loss: 10657568.4545; train_masked_gp_l1_reg_loss: 83509.8361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73019.0760; train_chrom_access_recon_loss: 9284039.8182; train_global_loss: 22881583.1212; train_optim_loss: 22881583.1212; val_kl_reg_loss: 57173.8506; val_edge_recon_loss: 2770270.2500; val_gene_expr_recon_loss: 10724042.6250; val_masked_gp_l1_reg_loss: 83430.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72823.7578; val_chrom_access_recon_loss: 9429354.8750; val_global_loss: 23137096.7500; val_optim_loss: 23137096.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9270; val_auprc_score: 0.9012; val_best_acc_score: 0.8700; val_best_f1_score: 0.8791; train_kl_reg_loss: 71744.8565; train_edge_recon_loss: 2712053.2045; train_gene_expr_recon_loss: 10661806.1667; train_masked_gp_l1_reg_loss: 83346.4825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72641.8169; train_chrom_access_recon_loss: 9285925.3636; train_global_loss: 22887518.0303; train_optim_loss: 22887518.0303; val_kl_reg_loss: 57457.5718; val_edge_recon_loss: 2755114.0000; val_gene_expr_recon_loss: 10789886.5000; val_masked_gp_l1_reg_loss: 83269.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72573.5547; val_chrom_access_recon_loss: 9417500.0000; val_global_loss: 23175800.7500; val_optim_loss: 23175800.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9289; val_auprc_score: 0.9004; val_best_acc_score: 0.8721; val_best_f1_score: 0.8802; train_kl_reg_loss: 71999.7339; train_edge_recon_loss: 2714147.3939; train_gene_expr_recon_loss: 10651258.6818; train_masked_gp_l1_reg_loss: 83185.8801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72412.8819; train_chrom_access_recon_loss: 9271182.5758; train_global_loss: 22864187.1212; train_optim_loss: 22864187.1212; val_kl_reg_loss: 58057.1978; val_edge_recon_loss: 2777432.9375; val_gene_expr_recon_loss: 10723218.0000; val_masked_gp_l1_reg_loss: 83097.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72235.7109; val_chrom_access_recon_loss: 9461051.8750; val_global_loss: 23175093.7500; val_optim_loss: 23175093.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9276; val_auprc_score: 0.8937; val_best_acc_score: 0.8726; val_best_f1_score: 0.8821; train_kl_reg_loss: 71732.6914; train_edge_recon_loss: 2722105.7159; train_gene_expr_recon_loss: 10663973.7424; train_masked_gp_l1_reg_loss: 83037.6232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70603.7971; train_chrom_access_recon_loss: 9280921.5303; train_global_loss: 22892375.1212; train_optim_loss: 22892375.1212; val_kl_reg_loss: 57472.8213; val_edge_recon_loss: 2741229.2500; val_gene_expr_recon_loss: 10678092.5000; val_masked_gp_l1_reg_loss: 83010.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70278.7188; val_chrom_access_recon_loss: 9338753.3750; val_global_loss: 22968837.2500; val_optim_loss: 22968837.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9248; val_auprc_score: 0.8990; val_best_acc_score: 0.8659; val_best_f1_score: 0.8759; train_kl_reg_loss: 71706.1426; train_edge_recon_loss: 2717687.5379; train_gene_expr_recon_loss: 10659556.3636; train_masked_gp_l1_reg_loss: 82997.2668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70243.9028; train_chrom_access_recon_loss: 9272388.1515; train_global_loss: 22874579.4545; train_optim_loss: 22874579.4545; val_kl_reg_loss: 58165.7866; val_edge_recon_loss: 2765770.6875; val_gene_expr_recon_loss: 10783470.8750; val_masked_gp_l1_reg_loss: 82984.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70209.5781; val_chrom_access_recon_loss: 9429630.1250; val_global_loss: 23190231.5000; val_optim_loss: 23190231.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9252; val_auprc_score: 0.8979; val_best_acc_score: 0.8622; val_best_f1_score: 0.8736; train_kl_reg_loss: 71669.1100; train_edge_recon_loss: 2724381.3447; train_gene_expr_recon_loss: 10665588.1667; train_masked_gp_l1_reg_loss: 82973.8994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70181.8556; train_chrom_access_recon_loss: 9284212.1818; train_global_loss: 22899006.5758; train_optim_loss: 22899006.5758; val_kl_reg_loss: 58319.5552; val_edge_recon_loss: 2774991.4688; val_gene_expr_recon_loss: 10716170.7500; val_masked_gp_l1_reg_loss: 82963.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70156.3828; val_chrom_access_recon_loss: 9467113.1250; val_global_loss: 23169714.7500; val_optim_loss: 23169714.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9292; val_auprc_score: 0.9025; val_best_acc_score: 0.8748; val_best_f1_score: 0.8839; train_kl_reg_loss: 71670.1035; train_edge_recon_loss: 2719293.1780; train_gene_expr_recon_loss: 10654120.4545; train_masked_gp_l1_reg_loss: 82952.3219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70138.3217; train_chrom_access_recon_loss: 9267494.9848; train_global_loss: 22865669.3030; train_optim_loss: 22865669.3030; val_kl_reg_loss: 57932.4146; val_edge_recon_loss: 2749354.8438; val_gene_expr_recon_loss: 10738418.1250; val_masked_gp_l1_reg_loss: 82941.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70114.8281; val_chrom_access_recon_loss: 9371418.8750; val_global_loss: 23070181.0000; val_optim_loss: 23070181.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9349; val_auprc_score: 0.9064; val_best_acc_score: 0.8769; val_best_f1_score: 0.8851; train_kl_reg_loss: 71552.1740; train_edge_recon_loss: 2715954.6932; train_gene_expr_recon_loss: 10657865.2121; train_masked_gp_l1_reg_loss: 82932.2337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70091.6750; train_chrom_access_recon_loss: 9282126.4091; train_global_loss: 22880522.3333; train_optim_loss: 22880522.3333; val_kl_reg_loss: 58259.0405; val_edge_recon_loss: 2739982.4375; val_gene_expr_recon_loss: 10819646.8750; val_masked_gp_l1_reg_loss: 82923.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70082.9375; val_chrom_access_recon_loss: 9529465.1250; val_global_loss: 23300360.7500; val_optim_loss: 23300360.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9368; val_auprc_score: 0.9125; val_best_acc_score: 0.8743; val_best_f1_score: 0.8822; train_kl_reg_loss: 71544.2553; train_edge_recon_loss: 2712668.3864; train_gene_expr_recon_loss: 10645782.0000; train_masked_gp_l1_reg_loss: 82917.4946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69914.2867; train_chrom_access_recon_loss: 9264397.0606; train_global_loss: 22847223.3636; train_optim_loss: 22847223.3636; val_kl_reg_loss: 57880.4751; val_edge_recon_loss: 2743930.5938; val_gene_expr_recon_loss: 10775006.0000; val_masked_gp_l1_reg_loss: 82914.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69881.2969; val_chrom_access_recon_loss: 9371979.0000; val_global_loss: 23101592.5000; val_optim_loss: 23101592.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9334; val_auprc_score: 0.9119; val_best_acc_score: 0.8705; val_best_f1_score: 0.8797; train_kl_reg_loss: 71564.8313; train_edge_recon_loss: 2719242.3788; train_gene_expr_recon_loss: 10652015.1364; train_masked_gp_l1_reg_loss: 82913.0295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69877.4519; train_chrom_access_recon_loss: 9270706.0909; train_global_loss: 22866319.0000; train_optim_loss: 22866319.0000; val_kl_reg_loss: 58325.6035; val_edge_recon_loss: 2746382.9062; val_gene_expr_recon_loss: 10833885.5000; val_masked_gp_l1_reg_loss: 82911.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69874.2031; val_chrom_access_recon_loss: 9503197.7500; val_global_loss: 23294577.7500; val_optim_loss: 23294577.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9332; val_auprc_score: 0.9043; val_best_acc_score: 0.8721; val_best_f1_score: 0.8801; train_kl_reg_loss: 71473.3166; train_edge_recon_loss: 2721670.0758; train_gene_expr_recon_loss: 10656222.7576; train_masked_gp_l1_reg_loss: 82910.5573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69871.4094; train_chrom_access_recon_loss: 9267232.5303; train_global_loss: 22869380.6970; train_optim_loss: 22869380.6970; val_kl_reg_loss: 58202.8130; val_edge_recon_loss: 2740967.6875; val_gene_expr_recon_loss: 10867219.5000; val_masked_gp_l1_reg_loss: 82909.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69868.2188; val_chrom_access_recon_loss: 9539738.3750; val_global_loss: 23358905.2500; val_optim_loss: 23358905.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9301; val_auprc_score: 0.9070; val_best_acc_score: 0.8710; val_best_f1_score: 0.8798; train_kl_reg_loss: 71599.5687; train_edge_recon_loss: 2717560.6023; train_gene_expr_recon_loss: 10661040.8182; train_masked_gp_l1_reg_loss: 82908.3125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69866.6901; train_chrom_access_recon_loss: 9282590.1970; train_global_loss: 22885566.1515; train_optim_loss: 22885566.1515; val_kl_reg_loss: 58484.6279; val_edge_recon_loss: 2748405.8750; val_gene_expr_recon_loss: 10836727.2500; val_masked_gp_l1_reg_loss: 82907.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69864.0312; val_chrom_access_recon_loss: 9459718.2500; val_global_loss: 23256107.0000; val_optim_loss: 23256107.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 17 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9286
val AUPRC score: 0.8986
val best accuracy score: 0.8702
val best F1 score: 0.8795
val target rna MSE score: 1.8971
val source rna MSE score: 0.9725
val target atac MSE score: 0.3320
val source atac MSE score: 0.1370
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
