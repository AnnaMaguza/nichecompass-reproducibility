[True]
Run timestamp: 10082023_214815_65.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_65']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7062; val_auprc_score: 0.7442; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 144339.5645; train_edge_recon_loss: 3744149.7824; train_gene_expr_recon_loss: 44206186.1679; train_masked_gp_l1_reg_loss: 86283.0852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245750.8884; train_chrom_access_recon_loss: 1369752.6794; train_global_loss: 49796462.2290; train_optim_loss: 49796462.2290; val_kl_reg_loss: 96258.7948; val_edge_recon_loss: 4065800.0500; val_gene_expr_recon_loss: 39065725.0667; val_masked_gp_l1_reg_loss: 85426.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 240991.5469; val_chrom_access_recon_loss: 1302272.7000; val_global_loss: 44856476.8000; val_optim_loss: 44856476.8000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7539; val_auprc_score: 0.7786; val_best_acc_score: 0.5203; val_best_f1_score: 0.6738; train_kl_reg_loss: 178148.7739; train_edge_recon_loss: 3655894.0477; train_gene_expr_recon_loss: 37809048.8855; train_masked_gp_l1_reg_loss: 81595.4940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 234267.1746; train_chrom_access_recon_loss: 1281030.6450; train_global_loss: 43239985.0076; train_optim_loss: 43239985.0076; val_kl_reg_loss: 178488.5344; val_edge_recon_loss: 4063415.2500; val_gene_expr_recon_loss: 37545528.2667; val_masked_gp_l1_reg_loss: 79066.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 227284.0156; val_chrom_access_recon_loss: 1273575.2167; val_global_loss: 43367359.4667; val_optim_loss: 43367359.4667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8558; val_auprc_score: 0.8572; val_best_acc_score: 0.7679; val_best_f1_score: 0.7921; train_kl_reg_loss: 180963.8391; train_edge_recon_loss: 3572136.6202; train_gene_expr_recon_loss: 36958207.2977; train_masked_gp_l1_reg_loss: 77877.6050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 220254.2698; train_chrom_access_recon_loss: 1266137.1679; train_global_loss: 42275576.8855; train_optim_loss: 42275576.8855; val_kl_reg_loss: 170846.2188; val_edge_recon_loss: 4040493.7167; val_gene_expr_recon_loss: 37014426.1333; val_masked_gp_l1_reg_loss: 78123.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 213227.0938; val_chrom_access_recon_loss: 1270253.8333; val_global_loss: 42787371.2000; val_optim_loss: 42787371.2000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8952; val_auprc_score: 0.8907; val_best_acc_score: 0.7904; val_best_f1_score: 0.8182; train_kl_reg_loss: 158839.2842; train_edge_recon_loss: 3541713.7290; train_gene_expr_recon_loss: 36608397.8626; train_masked_gp_l1_reg_loss: 79054.9586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 206591.3144; train_chrom_access_recon_loss: 1259118.6307; train_global_loss: 41853715.6641; train_optim_loss: 41853715.6641; val_kl_reg_loss: 154847.3750; val_edge_recon_loss: 3911956.6833; val_gene_expr_recon_loss: 36792143.2000; val_masked_gp_l1_reg_loss: 80197.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 200071.0625; val_chrom_access_recon_loss: 1260648.6083; val_global_loss: 42399864.0000; val_optim_loss: 42399864.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8820; val_auprc_score: 0.8714; val_best_acc_score: 0.8002; val_best_f1_score: 0.8173; train_kl_reg_loss: 134094.8571; train_edge_recon_loss: 3382748.2233; train_gene_expr_recon_loss: 36332188.7481; train_masked_gp_l1_reg_loss: 81935.9498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 194105.5570; train_chrom_access_recon_loss: 1253628.1918; train_global_loss: 41378701.3740; train_optim_loss: 41378701.3740; val_kl_reg_loss: 153062.3719; val_edge_recon_loss: 3128274.5667; val_gene_expr_recon_loss: 36453342.9333; val_masked_gp_l1_reg_loss: 84140.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 188223.4219; val_chrom_access_recon_loss: 1251449.4333; val_global_loss: 41258492.8000; val_optim_loss: 41258492.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8895; val_auprc_score: 0.8756; val_best_acc_score: 0.8009; val_best_f1_score: 0.8203; train_kl_reg_loss: 169306.2137; train_edge_recon_loss: 3046849.2538; train_gene_expr_recon_loss: 36144455.0687; train_masked_gp_l1_reg_loss: 85691.4701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 182919.4623; train_chrom_access_recon_loss: 1249441.8082; train_global_loss: 40878663.3282; train_optim_loss: 40878663.3282; val_kl_reg_loss: 170421.6250; val_edge_recon_loss: 3024757.2333; val_gene_expr_recon_loss: 36136869.8667; val_masked_gp_l1_reg_loss: 86864.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 177778.0938; val_chrom_access_recon_loss: 1243466.4417; val_global_loss: 40840158.9333; val_optim_loss: 40840158.9333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9178; val_auprc_score: 0.9075; val_best_acc_score: 0.8402; val_best_f1_score: 0.8479; train_kl_reg_loss: 167412.3236; train_edge_recon_loss: 2984863.1221; train_gene_expr_recon_loss: 35863931.2977; train_masked_gp_l1_reg_loss: 88206.3998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 173036.1268; train_chrom_access_recon_loss: 1241916.5611; train_global_loss: 40519365.8321; train_optim_loss: 40519365.8321; val_kl_reg_loss: 164776.5573; val_edge_recon_loss: 2933266.3000; val_gene_expr_recon_loss: 36006789.6000; val_masked_gp_l1_reg_loss: 89372.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168336.5000; val_chrom_access_recon_loss: 1243947.7833; val_global_loss: 40606488.2667; val_optim_loss: 40606488.2667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9169; val_auprc_score: 0.9059; val_best_acc_score: 0.8375; val_best_f1_score: 0.8481; train_kl_reg_loss: 161839.2483; train_edge_recon_loss: 2959724.3130; train_gene_expr_recon_loss: 35669946.9924; train_masked_gp_l1_reg_loss: 90626.9733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163918.2001; train_chrom_access_recon_loss: 1237828.4590; train_global_loss: 40283883.7557; train_optim_loss: 40283883.7557; val_kl_reg_loss: 164656.5125; val_edge_recon_loss: 2928280.7833; val_gene_expr_recon_loss: 35831040.0000; val_masked_gp_l1_reg_loss: 92237.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159567.2969; val_chrom_access_recon_loss: 1244125.5500; val_global_loss: 40419906.4000; val_optim_loss: 40419906.4000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9169; val_auprc_score: 0.9051; val_best_acc_score: 0.8421; val_best_f1_score: 0.8545; train_kl_reg_loss: 159463.7892; train_edge_recon_loss: 2917472.9809; train_gene_expr_recon_loss: 35509237.5878; train_masked_gp_l1_reg_loss: 93176.7702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155517.0881; train_chrom_access_recon_loss: 1234266.2395; train_global_loss: 40069134.5038; train_optim_loss: 40069134.5038; val_kl_reg_loss: 161203.4813; val_edge_recon_loss: 2914158.9500; val_gene_expr_recon_loss: 35760508.2667; val_masked_gp_l1_reg_loss: 94187.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151454.9531; val_chrom_access_recon_loss: 1239652.4167; val_global_loss: 40321167.4667; val_optim_loss: 40321167.4667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9345; val_auprc_score: 0.9238; val_best_acc_score: 0.8661; val_best_f1_score: 0.8739; train_kl_reg_loss: 155689.5188; train_edge_recon_loss: 2876879.6679; train_gene_expr_recon_loss: 35352138.2901; train_masked_gp_l1_reg_loss: 95556.0009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147677.9257; train_chrom_access_recon_loss: 1230060.2844; train_global_loss: 39858001.8321; train_optim_loss: 39858001.8321; val_kl_reg_loss: 155931.8875; val_edge_recon_loss: 2832365.2500; val_gene_expr_recon_loss: 35417438.4000; val_masked_gp_l1_reg_loss: 96818.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143927.2656; val_chrom_access_recon_loss: 1228126.3833; val_global_loss: 39874609.6000; val_optim_loss: 39874609.6000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9338; val_auprc_score: 0.9206; val_best_acc_score: 0.8610; val_best_f1_score: 0.8687; train_kl_reg_loss: 153224.7579; train_edge_recon_loss: 2860374.1412; train_gene_expr_recon_loss: 35215308.0153; train_masked_gp_l1_reg_loss: 98011.6426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140519.9219; train_chrom_access_recon_loss: 1226011.4742; train_global_loss: 39693449.9542; train_optim_loss: 39693449.9542; val_kl_reg_loss: 152358.6135; val_edge_recon_loss: 2879073.4000; val_gene_expr_recon_loss: 35384855.4667; val_masked_gp_l1_reg_loss: 98970.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137081.4219; val_chrom_access_recon_loss: 1226115.3417; val_global_loss: 39878454.9333; val_optim_loss: 39878454.9333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9401; val_auprc_score: 0.9310; val_best_acc_score: 0.8690; val_best_f1_score: 0.8772; train_kl_reg_loss: 149759.2660; train_edge_recon_loss: 2840877.5687; train_gene_expr_recon_loss: 35146845.9237; train_masked_gp_l1_reg_loss: 100223.6641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134034.6436; train_chrom_access_recon_loss: 1225868.4990; train_global_loss: 39597609.6794; train_optim_loss: 39597609.6794; val_kl_reg_loss: 144435.7052; val_edge_recon_loss: 2840113.6333; val_gene_expr_recon_loss: 35443598.4000; val_masked_gp_l1_reg_loss: 101464.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131085.0625; val_chrom_access_recon_loss: 1232800.4667; val_global_loss: 39893496.0000; val_optim_loss: 39893496.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9481; val_auprc_score: 0.9398; val_best_acc_score: 0.8748; val_best_f1_score: 0.8802; train_kl_reg_loss: 146349.1559; train_edge_recon_loss: 2827164.3550; train_gene_expr_recon_loss: 34983946.6260; train_masked_gp_l1_reg_loss: 102514.3059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128219.1340; train_chrom_access_recon_loss: 1221544.8626; train_global_loss: 39409738.7481; train_optim_loss: 39409738.7481; val_kl_reg_loss: 144545.1406; val_edge_recon_loss: 2838847.4000; val_gene_expr_recon_loss: 35316701.0667; val_masked_gp_l1_reg_loss: 103501.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125405.0078; val_chrom_access_recon_loss: 1228548.3000; val_global_loss: 39757545.8667; val_optim_loss: 39757545.8667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9499; val_auprc_score: 0.9397; val_best_acc_score: 0.8824; val_best_f1_score: 0.8883; train_kl_reg_loss: 143841.5748; train_edge_recon_loss: 2814811.1775; train_gene_expr_recon_loss: 34936757.7710; train_masked_gp_l1_reg_loss: 104557.1555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122711.5263; train_chrom_access_recon_loss: 1220661.9418; train_global_loss: 39343341.0382; train_optim_loss: 39343341.0382; val_kl_reg_loss: 142865.9969; val_edge_recon_loss: 2825599.7000; val_gene_expr_recon_loss: 35201683.7333; val_masked_gp_l1_reg_loss: 105733.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120004.9922; val_chrom_access_recon_loss: 1225400.0667; val_global_loss: 39621285.8667; val_optim_loss: 39621285.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9553; val_auprc_score: 0.9446; val_best_acc_score: 0.8922; val_best_f1_score: 0.8965; train_kl_reg_loss: 142277.9240; train_edge_recon_loss: 2801705.0305; train_gene_expr_recon_loss: 34875099.6336; train_masked_gp_l1_reg_loss: 106670.5287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117495.2518; train_chrom_access_recon_loss: 1219043.6212; train_global_loss: 39262291.6947; train_optim_loss: 39262291.6947; val_kl_reg_loss: 140924.6063; val_edge_recon_loss: 2812385.1833; val_gene_expr_recon_loss: 34942054.6667; val_masked_gp_l1_reg_loss: 107501.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114943.2891; val_chrom_access_recon_loss: 1216842.3167; val_global_loss: 39334651.2000; val_optim_loss: 39334651.2000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9573; val_auprc_score: 0.9476; val_best_acc_score: 0.8948; val_best_f1_score: 0.8970; train_kl_reg_loss: 138650.1238; train_edge_recon_loss: 2796634.8263; train_gene_expr_recon_loss: 34765067.3130; train_masked_gp_l1_reg_loss: 108665.7647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112672.9482; train_chrom_access_recon_loss: 1216000.3865; train_global_loss: 39137691.4198; train_optim_loss: 39137691.4198; val_kl_reg_loss: 138252.2391; val_edge_recon_loss: 2795130.8333; val_gene_expr_recon_loss: 35063445.3333; val_masked_gp_l1_reg_loss: 109582.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110332.8984; val_chrom_access_recon_loss: 1223743.9750; val_global_loss: 39440488.0000; val_optim_loss: 39440488.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9563; val_auprc_score: 0.9464; val_best_acc_score: 0.8949; val_best_f1_score: 0.8994; train_kl_reg_loss: 136196.3504; train_edge_recon_loss: 2785329.2748; train_gene_expr_recon_loss: 34696166.4275; train_masked_gp_l1_reg_loss: 110615.5923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108192.5713; train_chrom_access_recon_loss: 1214496.0916; train_global_loss: 39050996.5496; train_optim_loss: 39050996.5496; val_kl_reg_loss: 130720.6151; val_edge_recon_loss: 2809733.5833; val_gene_expr_recon_loss: 35037057.7333; val_masked_gp_l1_reg_loss: 111524.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106095.8359; val_chrom_access_recon_loss: 1220266.8583; val_global_loss: 39415399.4667; val_optim_loss: 39415399.4667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9608; val_auprc_score: 0.9510; val_best_acc_score: 0.8992; val_best_f1_score: 0.9032; train_kl_reg_loss: 134293.8198; train_edge_recon_loss: 2779278.2214; train_gene_expr_recon_loss: 34648906.4122; train_masked_gp_l1_reg_loss: 112534.4119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104130.8074; train_chrom_access_recon_loss: 1214067.1956; train_global_loss: 38993210.6870; train_optim_loss: 38993210.6870; val_kl_reg_loss: 132056.7766; val_edge_recon_loss: 2779646.2833; val_gene_expr_recon_loss: 34741494.6667; val_masked_gp_l1_reg_loss: 113443.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102273.7812; val_chrom_access_recon_loss: 1215470.5417; val_global_loss: 39084384.8000; val_optim_loss: 39084384.8000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9630; val_auprc_score: 0.9568; val_best_acc_score: 0.9014; val_best_f1_score: 0.9049; train_kl_reg_loss: 132526.7572; train_edge_recon_loss: 2767825.8302; train_gene_expr_recon_loss: 34575560.0458; train_masked_gp_l1_reg_loss: 114389.2000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100530.1037; train_chrom_access_recon_loss: 1212107.1565; train_global_loss: 38902939.2061; train_optim_loss: 38902939.2061; val_kl_reg_loss: 133825.6078; val_edge_recon_loss: 2786161.9333; val_gene_expr_recon_loss: 34778913.0667; val_masked_gp_l1_reg_loss: 115494.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98817.7656; val_chrom_access_recon_loss: 1215252.1833; val_global_loss: 39128465.3333; val_optim_loss: 39128465.3333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9630; val_auprc_score: 0.9555; val_best_acc_score: 0.9049; val_best_f1_score: 0.9079; train_kl_reg_loss: 129436.4998; train_edge_recon_loss: 2761582.7824; train_gene_expr_recon_loss: 34518347.2519; train_masked_gp_l1_reg_loss: 116312.8340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97251.4165; train_chrom_access_recon_loss: 1211425.7195; train_global_loss: 38834356.3969; train_optim_loss: 38834356.3969; val_kl_reg_loss: 129369.8484; val_edge_recon_loss: 2768191.9167; val_gene_expr_recon_loss: 34620518.5333; val_masked_gp_l1_reg_loss: 117443.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95673.6016; val_chrom_access_recon_loss: 1214111.4083; val_global_loss: 38945307.7333; val_optim_loss: 38945307.7333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9673; val_auprc_score: 0.9589; val_best_acc_score: 0.9150; val_best_f1_score: 0.9183; train_kl_reg_loss: 128218.9905; train_edge_recon_loss: 2759918.4084; train_gene_expr_recon_loss: 34451606.6565; train_masked_gp_l1_reg_loss: 118193.1339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94197.6716; train_chrom_access_recon_loss: 1209957.3015; train_global_loss: 38762092.0305; train_optim_loss: 38762092.0305; val_kl_reg_loss: 127445.0516; val_edge_recon_loss: 2738436.5000; val_gene_expr_recon_loss: 34788333.8667; val_masked_gp_l1_reg_loss: 119075.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92783.9141; val_chrom_access_recon_loss: 1216566.2000; val_global_loss: 39082641.6000; val_optim_loss: 39082641.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9630; val_auprc_score: 0.9520; val_best_acc_score: 0.9053; val_best_f1_score: 0.9094; train_kl_reg_loss: 126329.7640; train_edge_recon_loss: 2760753.1431; train_gene_expr_recon_loss: 34408647.8321; train_masked_gp_l1_reg_loss: 119926.2542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91329.3673; train_chrom_access_recon_loss: 1210037.6097; train_global_loss: 38717023.8168; train_optim_loss: 38717023.8168; val_kl_reg_loss: 129183.4281; val_edge_recon_loss: 2767309.7333; val_gene_expr_recon_loss: 34446367.3333; val_masked_gp_l1_reg_loss: 120965.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89999.7109; val_chrom_access_recon_loss: 1206141.3833; val_global_loss: 38759965.8667; val_optim_loss: 38759965.8667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9677; val_auprc_score: 0.9578; val_best_acc_score: 0.9144; val_best_f1_score: 0.9176; train_kl_reg_loss: 124498.7973; train_edge_recon_loss: 2748931.8359; train_gene_expr_recon_loss: 34342266.1527; train_masked_gp_l1_reg_loss: 121767.7268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88680.5581; train_chrom_access_recon_loss: 1208318.4008; train_global_loss: 38634463.5115; train_optim_loss: 38634463.5115; val_kl_reg_loss: 125690.4094; val_edge_recon_loss: 2733942.8000; val_gene_expr_recon_loss: 34500813.0667; val_masked_gp_l1_reg_loss: 122842.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87464.3984; val_chrom_access_recon_loss: 1213575.1167; val_global_loss: 38784328.8000; val_optim_loss: 38784328.8000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9701; val_auprc_score: 0.9631; val_best_acc_score: 0.9155; val_best_f1_score: 0.9183; train_kl_reg_loss: 122959.3365; train_edge_recon_loss: 2748146.0573; train_gene_expr_recon_loss: 34261411.6489; train_masked_gp_l1_reg_loss: 123730.9522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86214.1743; train_chrom_access_recon_loss: 1207084.9237; train_global_loss: 38549547.3893; train_optim_loss: 38549547.3893; val_kl_reg_loss: 121386.8771; val_edge_recon_loss: 2747715.4833; val_gene_expr_recon_loss: 34610505.6000; val_masked_gp_l1_reg_loss: 124448.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85041.7266; val_chrom_access_recon_loss: 1218684.3167; val_global_loss: 38907780.0000; val_optim_loss: 38907780.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9691; val_auprc_score: 0.9603; val_best_acc_score: 0.9159; val_best_f1_score: 0.9193; train_kl_reg_loss: 121072.0407; train_edge_recon_loss: 2745582.0630; train_gene_expr_recon_loss: 34258111.1908; train_masked_gp_l1_reg_loss: 125438.4045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83944.0184; train_chrom_access_recon_loss: 1207666.1603; train_global_loss: 38541813.9542; train_optim_loss: 38541813.9542; val_kl_reg_loss: 117597.8083; val_edge_recon_loss: 2757059.2333; val_gene_expr_recon_loss: 34461560.4000; val_masked_gp_l1_reg_loss: 126456.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82795.3516; val_chrom_access_recon_loss: 1208782.6333; val_global_loss: 38754252.2667; val_optim_loss: 38754252.2667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9684; val_auprc_score: 0.9629; val_best_acc_score: 0.9113; val_best_f1_score: 0.9140; train_kl_reg_loss: 142173.9936; train_edge_recon_loss: 2884245.6164; train_gene_expr_recon_loss: 36268541.4962; train_masked_gp_l1_reg_loss: 127972.9701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85507.3856; train_chrom_access_recon_loss: 1241080.4122; train_global_loss: 40749522.0153; train_optim_loss: 40749522.0153; val_kl_reg_loss: 39531.3917; val_edge_recon_loss: 2849316.1833; val_gene_expr_recon_loss: 36720862.4000; val_masked_gp_l1_reg_loss: 129697.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86690.1406; val_chrom_access_recon_loss: 1241733.2667; val_global_loss: 41067831.4667; val_optim_loss: 41067831.4667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9568; val_auprc_score: 0.9479; val_best_acc_score: 0.8977; val_best_f1_score: 0.9009; train_kl_reg_loss: 150472.6605; train_edge_recon_loss: 2896204.3607; train_gene_expr_recon_loss: 37899137.2519; train_masked_gp_l1_reg_loss: 132423.6192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88930.7899; train_chrom_access_recon_loss: 1249841.6641; train_global_loss: 42417010.1374; train_optim_loss: 42417010.1374; val_kl_reg_loss: 24108.5630; val_edge_recon_loss: 2870652.0500; val_gene_expr_recon_loss: 39925484.0000; val_masked_gp_l1_reg_loss: 134395.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90919.2109; val_chrom_access_recon_loss: 1261303.1583; val_global_loss: 44306863.4667; val_optim_loss: 44306863.4667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9540; val_auprc_score: 0.9429; val_best_acc_score: 0.8932; val_best_f1_score: 0.8982; train_kl_reg_loss: 114574.2939; train_edge_recon_loss: 2794780.3931; train_gene_expr_recon_loss: 39194015.7557; train_masked_gp_l1_reg_loss: 132616.8379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89443.9849; train_chrom_access_recon_loss: 1255052.1479; train_global_loss: 43580483.3893; train_optim_loss: 43580483.3893; val_kl_reg_loss: 36361.2445; val_edge_recon_loss: 2787197.1667; val_gene_expr_recon_loss: 39332452.0000; val_masked_gp_l1_reg_loss: 130302.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87567.7344; val_chrom_access_recon_loss: 1265129.2833; val_global_loss: 43639011.7333; val_optim_loss: 43639011.7333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9652; val_auprc_score: 0.9566; val_best_acc_score: 0.9078; val_best_f1_score: 0.9111; train_kl_reg_loss: 82630.8258; train_edge_recon_loss: 2743273.9523; train_gene_expr_recon_loss: 38740208.3969; train_masked_gp_l1_reg_loss: 127852.3643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85533.3939; train_chrom_access_recon_loss: 1252566.6279; train_global_loss: 43032065.3130; train_optim_loss: 43032065.3130; val_kl_reg_loss: 42130.5799; val_edge_recon_loss: 2721144.7667; val_gene_expr_recon_loss: 38688964.5333; val_masked_gp_l1_reg_loss: 125367.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83542.5625; val_chrom_access_recon_loss: 1253005.6500; val_global_loss: 42914157.6000; val_optim_loss: 42914157.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9644; val_auprc_score: 0.9547; val_best_acc_score: 0.9053; val_best_f1_score: 0.9094; train_kl_reg_loss: 75122.7790; train_edge_recon_loss: 2725854.8989; train_gene_expr_recon_loss: 38449998.3817; train_masked_gp_l1_reg_loss: 124858.6815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83192.7155; train_chrom_access_recon_loss: 1248648.9237; train_global_loss: 42707676.5802; train_optim_loss: 42707676.5802; val_kl_reg_loss: 43359.1633; val_edge_recon_loss: 2724324.2500; val_gene_expr_recon_loss: 38770334.4000; val_masked_gp_l1_reg_loss: 124565.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82869.5000; val_chrom_access_recon_loss: 1256395.8500; val_global_loss: 43001845.6000; val_optim_loss: 43001845.6000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9636; val_auprc_score: 0.9525; val_best_acc_score: 0.9026; val_best_f1_score: 0.9065; train_kl_reg_loss: 73825.8994; train_edge_recon_loss: 2729485.4313; train_gene_expr_recon_loss: 38388393.3130; train_masked_gp_l1_reg_loss: 124284.2983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82572.0677; train_chrom_access_recon_loss: 1248448.5105; train_global_loss: 42647009.0687; train_optim_loss: 42647009.0687; val_kl_reg_loss: 43755.7221; val_edge_recon_loss: 2733959.2833; val_gene_expr_recon_loss: 38713465.0667; val_masked_gp_l1_reg_loss: 124001.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82270.1016; val_chrom_access_recon_loss: 1253890.3083; val_global_loss: 42951342.9333; val_optim_loss: 42951342.9333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9610; val_auprc_score: 0.9531; val_best_acc_score: 0.8998; val_best_f1_score: 0.9047; train_kl_reg_loss: 72500.9667; train_edge_recon_loss: 2724567.9504; train_gene_expr_recon_loss: 38432369.0382; train_masked_gp_l1_reg_loss: 123708.9764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81978.3575; train_chrom_access_recon_loss: 1249471.6011; train_global_loss: 42684596.9160; train_optim_loss: 42684596.9160; val_kl_reg_loss: 44060.0857; val_edge_recon_loss: 2737139.8500; val_gene_expr_recon_loss: 38680361.6000; val_masked_gp_l1_reg_loss: 123413.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81691.0625; val_chrom_access_recon_loss: 1253731.5000; val_global_loss: 42920396.5333; val_optim_loss: 42920396.5333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9618; val_auprc_score: 0.9497; val_best_acc_score: 0.9046; val_best_f1_score: 0.9093; train_kl_reg_loss: 71820.7186; train_edge_recon_loss: 2724465.8550; train_gene_expr_recon_loss: 38393920.3359; train_masked_gp_l1_reg_loss: 123106.6499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81398.2099; train_chrom_access_recon_loss: 1247688.4990; train_global_loss: 42642400.1221; train_optim_loss: 42642400.1221; val_kl_reg_loss: 44325.9789; val_edge_recon_loss: 2725285.8333; val_gene_expr_recon_loss: 39081038.6667; val_masked_gp_l1_reg_loss: 122788.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81092.5312; val_chrom_access_recon_loss: 1254807.0417; val_global_loss: 43309337.8667; val_optim_loss: 43309337.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 40 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9714
val AUPRC score: 0.9666
val best accuracy score: 0.9169
val best F1 score: 0.9193
val target rna MSE score: 1.2242
val source rna MSE score: 39.7174
val target atac MSE score: 0.5704
val source atac MSE score: 6.5850
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
