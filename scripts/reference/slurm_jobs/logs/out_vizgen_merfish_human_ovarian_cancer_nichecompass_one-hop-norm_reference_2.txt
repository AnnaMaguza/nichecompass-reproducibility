[True]
Run timestamp: 17082023_083324_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '4', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 500, n_cat_covariates_embed_input: 0, n_hidden: 500, n_latent: 1385, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 4, n_output: 500
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1385, n_addon_gp_input: 10, n_cat_covariates_embed_input: 4, n_output: 500

--- INITIALIZING TRAINER ---
Number of training nodes: 759633
Number of validation nodes: 84404
Number of training edges: 3524470
Number of validation edges: 391607
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9803; val_auprc_score: 0.9933; val_best_acc_score: 0.9438; val_best_f1_score: 0.9637; train_kl_reg_loss: 17780.1575; train_edge_recon_loss: 1279309.4332; train_gene_expr_recon_loss: 2055619.8086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3352709.3959; train_optim_loss: 3352709.3959; val_kl_reg_loss: 10145.4844; val_edge_recon_loss: 1248964.6873; val_gene_expr_recon_loss: 1898088.2125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3157198.3838; val_optim_loss: 3157198.3838
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9851; val_auprc_score: 0.9950; val_best_acc_score: 0.9528; val_best_f1_score: 0.9694; train_kl_reg_loss: 9946.7662; train_edge_recon_loss: 1228060.8285; train_gene_expr_recon_loss: 1862080.7498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3100088.3470; train_optim_loss: 3100088.3470; val_kl_reg_loss: 9672.1717; val_edge_recon_loss: 1245371.3029; val_gene_expr_recon_loss: 1840662.2037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3095705.6815; val_optim_loss: 3095705.6815
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9865; val_auprc_score: 0.9954; val_best_acc_score: 0.9559; val_best_f1_score: 0.9714; train_kl_reg_loss: 9974.3722; train_edge_recon_loss: 1225775.5874; train_gene_expr_recon_loss: 1831885.8461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3067635.8069; train_optim_loss: 3067635.8069; val_kl_reg_loss: 9961.7690; val_edge_recon_loss: 1245059.5578; val_gene_expr_recon_loss: 1826274.9856; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3081296.3081; val_optim_loss: 3081296.3081
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9875; val_auprc_score: 0.9958; val_best_acc_score: 0.9576; val_best_f1_score: 0.9726; train_kl_reg_loss: 10138.7372; train_edge_recon_loss: 1226104.5416; train_gene_expr_recon_loss: 1821264.4831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3057507.7607; train_optim_loss: 3057507.7607; val_kl_reg_loss: 10279.4277; val_edge_recon_loss: 1238799.6880; val_gene_expr_recon_loss: 1819115.1948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3068194.3107; val_optim_loss: 3068194.3107
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9875; val_auprc_score: 0.9957; val_best_acc_score: 0.9580; val_best_f1_score: 0.9728; train_kl_reg_loss: 10281.9867; train_edge_recon_loss: 1225099.0934; train_gene_expr_recon_loss: 1815781.8043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3051162.8838; train_optim_loss: 3051162.8838; val_kl_reg_loss: 10219.4048; val_edge_recon_loss: 1238687.2820; val_gene_expr_recon_loss: 1815634.0920; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3064540.7774; val_optim_loss: 3064540.7774
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9886; val_auprc_score: 0.9962; val_best_acc_score: 0.9601; val_best_f1_score: 0.9741; train_kl_reg_loss: 10417.8140; train_edge_recon_loss: 1224197.2804; train_gene_expr_recon_loss: 1812994.4712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3047609.5659; train_optim_loss: 3047609.5659; val_kl_reg_loss: 10133.5789; val_edge_recon_loss: 1235808.9047; val_gene_expr_recon_loss: 1813114.2836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3059056.7631; val_optim_loss: 3059056.7631
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9887; val_auprc_score: 0.9962; val_best_acc_score: 0.9598; val_best_f1_score: 0.9740; train_kl_reg_loss: 10497.9499; train_edge_recon_loss: 1222957.7686; train_gene_expr_recon_loss: 1811016.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3044472.2927; train_optim_loss: 3044472.2927; val_kl_reg_loss: 10506.2613; val_edge_recon_loss: 1236209.1142; val_gene_expr_recon_loss: 1811536.1818; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3058251.5587; val_optim_loss: 3058251.5587
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9887; val_auprc_score: 0.9962; val_best_acc_score: 0.9600; val_best_f1_score: 0.9740; train_kl_reg_loss: 10572.6015; train_edge_recon_loss: 1222863.5503; train_gene_expr_recon_loss: 1809253.1007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3042689.2558; train_optim_loss: 3042689.2558; val_kl_reg_loss: 10593.6144; val_edge_recon_loss: 1239616.8515; val_gene_expr_recon_loss: 1810250.0787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3060460.5437; val_optim_loss: 3060460.5437
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9891; val_auprc_score: 0.9963; val_best_acc_score: 0.9607; val_best_f1_score: 0.9745; train_kl_reg_loss: 10612.9519; train_edge_recon_loss: 1221023.6373; train_gene_expr_recon_loss: 1808415.7837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3040052.3722; train_optim_loss: 3040052.3722; val_kl_reg_loss: 10470.2321; val_edge_recon_loss: 1238811.0007; val_gene_expr_recon_loss: 1811162.2924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3060443.5235; val_optim_loss: 3060443.5235
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9888; val_auprc_score: 0.9962; val_best_acc_score: 0.9605; val_best_f1_score: 0.9744; train_kl_reg_loss: 10632.3369; train_edge_recon_loss: 1222657.7073; train_gene_expr_recon_loss: 1806903.8749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3040193.9197; train_optim_loss: 3040193.9197; val_kl_reg_loss: 10600.7474; val_edge_recon_loss: 1241112.1064; val_gene_expr_recon_loss: 1808795.2347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3060508.0901; val_optim_loss: 3060508.0901
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9897; val_auprc_score: 0.9965; val_best_acc_score: 0.9626; val_best_f1_score: 0.9757; train_kl_reg_loss: 10660.4433; train_edge_recon_loss: 1222329.5146; train_gene_expr_recon_loss: 1807062.7490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3040052.7090; train_optim_loss: 3040052.7090; val_kl_reg_loss: 10471.8787; val_edge_recon_loss: 1243219.9351; val_gene_expr_recon_loss: 1806990.7360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3060682.5477; val_optim_loss: 3060682.5477

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9902; val_auprc_score: 0.9966; val_best_acc_score: 0.9633; val_best_f1_score: 0.9762; train_kl_reg_loss: 10465.3302; train_edge_recon_loss: 1219106.5053; train_gene_expr_recon_loss: 1797782.2831; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3027354.1203; train_optim_loss: 3027354.1203; val_kl_reg_loss: 10374.1170; val_edge_recon_loss: 1233306.1808; val_gene_expr_recon_loss: 1798839.3508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3042519.6501; val_optim_loss: 3042519.6501
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9899; val_auprc_score: 0.9966; val_best_acc_score: 0.9631; val_best_f1_score: 0.9761; train_kl_reg_loss: 10459.8572; train_edge_recon_loss: 1219143.5543; train_gene_expr_recon_loss: 1796641.4468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3026244.8588; train_optim_loss: 3026244.8588; val_kl_reg_loss: 10223.3622; val_edge_recon_loss: 1234888.6325; val_gene_expr_recon_loss: 1798074.4207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3043186.4164; val_optim_loss: 3043186.4164
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9900; val_auprc_score: 0.9965; val_best_acc_score: 0.9634; val_best_f1_score: 0.9763; train_kl_reg_loss: 10434.9180; train_edge_recon_loss: 1218814.5830; train_gene_expr_recon_loss: 1796190.8419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3025440.3412; train_optim_loss: 3025440.3412; val_kl_reg_loss: 10236.1411; val_edge_recon_loss: 1233945.7012; val_gene_expr_recon_loss: 1798272.9403; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3042454.7794; val_optim_loss: 3042454.7794
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9902; val_auprc_score: 0.9967; val_best_acc_score: 0.9635; val_best_f1_score: 0.9764; train_kl_reg_loss: 10370.3460; train_edge_recon_loss: 1218038.8211; train_gene_expr_recon_loss: 1796118.4435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3024527.6132; train_optim_loss: 3024527.6132; val_kl_reg_loss: 10177.6345; val_edge_recon_loss: 1234293.1113; val_gene_expr_recon_loss: 1798600.1279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3043070.8740; val_optim_loss: 3043070.8740
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9904; val_auprc_score: 0.9967; val_best_acc_score: 0.9638; val_best_f1_score: 0.9765; train_kl_reg_loss: 10333.7826; train_edge_recon_loss: 1217829.2756; train_gene_expr_recon_loss: 1795704.4681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3023867.5277; train_optim_loss: 3023867.5277; val_kl_reg_loss: 10258.9360; val_edge_recon_loss: 1234880.5822; val_gene_expr_recon_loss: 1797403.9883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3042543.4954; val_optim_loss: 3042543.4954
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9901; val_auprc_score: 0.9965; val_best_acc_score: 0.9640; val_best_f1_score: 0.9766; train_kl_reg_loss: 10316.7101; train_edge_recon_loss: 1220105.4363; train_gene_expr_recon_loss: 1795710.2608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3026132.4104; train_optim_loss: 3026132.4104; val_kl_reg_loss: 10166.8015; val_edge_recon_loss: 1238559.9445; val_gene_expr_recon_loss: 1795935.4899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3044662.2389; val_optim_loss: 3044662.2389
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9906; val_auprc_score: 0.9968; val_best_acc_score: 0.9639; val_best_f1_score: 0.9766; train_kl_reg_loss: 10280.5642; train_edge_recon_loss: 1218649.9554; train_gene_expr_recon_loss: 1795487.5063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3024418.0237; train_optim_loss: 3024418.0237; val_kl_reg_loss: 10086.1078; val_edge_recon_loss: 1236087.8619; val_gene_expr_recon_loss: 1796740.3149; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3042914.2833; val_optim_loss: 3042914.2833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9905; val_auprc_score: 0.9968; val_best_acc_score: 0.9643; val_best_f1_score: 0.9768; train_kl_reg_loss: 10216.4106; train_edge_recon_loss: 1218605.9837; train_gene_expr_recon_loss: 1794148.2403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022970.6338; train_optim_loss: 3022970.6338; val_kl_reg_loss: 10092.1460; val_edge_recon_loss: 1236160.1482; val_gene_expr_recon_loss: 1796162.6655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3042414.9563; val_optim_loss: 3042414.9563
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9907; val_auprc_score: 0.9968; val_best_acc_score: 0.9646; val_best_f1_score: 0.9770; train_kl_reg_loss: 10220.0199; train_edge_recon_loss: 1218411.1465; train_gene_expr_recon_loss: 1793951.0301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022582.1963; train_optim_loss: 3022582.1963; val_kl_reg_loss: 10085.2218; val_edge_recon_loss: 1231467.0953; val_gene_expr_recon_loss: 1796485.3688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3038037.6815; val_optim_loss: 3038037.6815
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9906; val_auprc_score: 0.9968; val_best_acc_score: 0.9643; val_best_f1_score: 0.9768; train_kl_reg_loss: 10223.3975; train_edge_recon_loss: 1217843.3580; train_gene_expr_recon_loss: 1793973.6895; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022040.4474; train_optim_loss: 3022040.4474; val_kl_reg_loss: 10095.8846; val_edge_recon_loss: 1234572.9383; val_gene_expr_recon_loss: 1794992.9599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3039661.7813; val_optim_loss: 3039661.7813
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9905; val_auprc_score: 0.9967; val_best_acc_score: 0.9645; val_best_f1_score: 0.9770; train_kl_reg_loss: 10220.8731; train_edge_recon_loss: 1219463.9944; train_gene_expr_recon_loss: 1794114.5500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3023799.4179; train_optim_loss: 3023799.4179; val_kl_reg_loss: 10093.7578; val_edge_recon_loss: 1232809.6361; val_gene_expr_recon_loss: 1796561.2474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3039464.6416; val_optim_loss: 3039464.6416
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9905; val_auprc_score: 0.9968; val_best_acc_score: 0.9642; val_best_f1_score: 0.9768; train_kl_reg_loss: 10218.0911; train_edge_recon_loss: 1217362.9614; train_gene_expr_recon_loss: 1794376.6798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3021957.7334; train_optim_loss: 3021957.7334; val_kl_reg_loss: 10081.8770; val_edge_recon_loss: 1235170.6070; val_gene_expr_recon_loss: 1796383.5898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3041636.0777; val_optim_loss: 3041636.0777
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9906; val_auprc_score: 0.9968; val_best_acc_score: 0.9648; val_best_f1_score: 0.9772; train_kl_reg_loss: 10208.8961; train_edge_recon_loss: 1217741.2840; train_gene_expr_recon_loss: 1793961.3754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3021911.5564; train_optim_loss: 3021911.5564; val_kl_reg_loss: 10078.9242; val_edge_recon_loss: 1232656.6302; val_gene_expr_recon_loss: 1797201.4638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3039937.0150; val_optim_loss: 3039937.0150

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9906; val_auprc_score: 0.9968; val_best_acc_score: 0.9647; val_best_f1_score: 0.9772; train_kl_reg_loss: 10204.2170; train_edge_recon_loss: 1217962.4329; train_gene_expr_recon_loss: 1793488.8448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3021655.4918; train_optim_loss: 3021655.4918; val_kl_reg_loss: 10065.4445; val_edge_recon_loss: 1230953.0659; val_gene_expr_recon_loss: 1796023.8851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3037042.3956; val_optim_loss: 3037042.3956
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9906; val_auprc_score: 0.9968; val_best_acc_score: 0.9645; val_best_f1_score: 0.9770; train_kl_reg_loss: 10202.5566; train_edge_recon_loss: 1217477.2605; train_gene_expr_recon_loss: 1793588.4643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3021268.2835; train_optim_loss: 3021268.2835; val_kl_reg_loss: 10065.0263; val_edge_recon_loss: 1235742.2255; val_gene_expr_recon_loss: 1796625.0516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3042432.3016; val_optim_loss: 3042432.3016
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9906; val_auprc_score: 0.9968; val_best_acc_score: 0.9643; val_best_f1_score: 0.9769; train_kl_reg_loss: 10202.2573; train_edge_recon_loss: 1219042.5254; train_gene_expr_recon_loss: 1793886.2452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3023131.0279; train_optim_loss: 3023131.0279; val_kl_reg_loss: 10066.3572; val_edge_recon_loss: 1236352.0677; val_gene_expr_recon_loss: 1795621.5424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3042039.9634; val_optim_loss: 3042039.9634
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9907; val_auprc_score: 0.9968; val_best_acc_score: 0.9647; val_best_f1_score: 0.9771; train_kl_reg_loss: 10202.7321; train_edge_recon_loss: 1218275.1725; train_gene_expr_recon_loss: 1793775.8680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022253.7745; train_optim_loss: 3022253.7745; val_kl_reg_loss: 10067.6348; val_edge_recon_loss: 1233537.8995; val_gene_expr_recon_loss: 1795789.5369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3039395.0614; val_optim_loss: 3039395.0614
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9906; val_auprc_score: 0.9968; val_best_acc_score: 0.9645; val_best_f1_score: 0.9770; train_kl_reg_loss: 10203.5289; train_edge_recon_loss: 1218057.3777; train_gene_expr_recon_loss: 1794100.3001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022361.2066; train_optim_loss: 3022361.2066; val_kl_reg_loss: 10064.9237; val_edge_recon_loss: 1237847.4801; val_gene_expr_recon_loss: 1795784.5604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3043696.9693; val_optim_loss: 3043696.9693

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9905; val_auprc_score: 0.9967; val_best_acc_score: 0.9645; val_best_f1_score: 0.9770; train_kl_reg_loss: 10200.8370; train_edge_recon_loss: 1217628.4692; train_gene_expr_recon_loss: 1793465.4475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3021294.7554; train_optim_loss: 3021294.7554; val_kl_reg_loss: 10066.4743; val_edge_recon_loss: 1234771.4618; val_gene_expr_recon_loss: 1794890.8792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3039728.8179; val_optim_loss: 3039728.8179
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9906; val_auprc_score: 0.9968; val_best_acc_score: 0.9645; val_best_f1_score: 0.9770; train_kl_reg_loss: 10200.6185; train_edge_recon_loss: 1218033.8039; train_gene_expr_recon_loss: 1793987.8658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022222.2842; train_optim_loss: 3022222.2842; val_kl_reg_loss: 10068.6629; val_edge_recon_loss: 1233490.3708; val_gene_expr_recon_loss: 1796316.6867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3039875.7187; val_optim_loss: 3039875.7187
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9906; val_auprc_score: 0.9968; val_best_acc_score: 0.9646; val_best_f1_score: 0.9771; train_kl_reg_loss: 10200.6181; train_edge_recon_loss: 1218901.7913; train_gene_expr_recon_loss: 1793953.8377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3023056.2453; train_optim_loss: 3023056.2453; val_kl_reg_loss: 10064.4246; val_edge_recon_loss: 1232724.8071; val_gene_expr_recon_loss: 1796359.4413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3039148.6671; val_optim_loss: 3039148.6671
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9904; val_auprc_score: 0.9967; val_best_acc_score: 0.9644; val_best_f1_score: 0.9769; train_kl_reg_loss: 10199.2446; train_edge_recon_loss: 1219257.5786; train_gene_expr_recon_loss: 1793760.9381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3023217.7602; train_optim_loss: 3023217.7602; val_kl_reg_loss: 10067.0656; val_edge_recon_loss: 1231423.5669; val_gene_expr_recon_loss: 1795229.8022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3036720.4295; val_optim_loss: 3036720.4295
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9905; val_auprc_score: 0.9967; val_best_acc_score: 0.9648; val_best_f1_score: 0.9772; train_kl_reg_loss: 10200.4501; train_edge_recon_loss: 1218359.5987; train_gene_expr_recon_loss: 1793696.5040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022256.5505; train_optim_loss: 3022256.5505; val_kl_reg_loss: 10064.5264; val_edge_recon_loss: 1235497.9631; val_gene_expr_recon_loss: 1796895.1968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3042457.6834; val_optim_loss: 3042457.6834
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9904; val_auprc_score: 0.9967; val_best_acc_score: 0.9641; val_best_f1_score: 0.9767; train_kl_reg_loss: 10200.4754; train_edge_recon_loss: 1218869.8361; train_gene_expr_recon_loss: 1793667.1496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022737.4571; train_optim_loss: 3022737.4571; val_kl_reg_loss: 10065.6606; val_edge_recon_loss: 1238038.7239; val_gene_expr_recon_loss: 1796487.4566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3044591.8466; val_optim_loss: 3044591.8466
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9905; val_auprc_score: 0.9968; val_best_acc_score: 0.9642; val_best_f1_score: 0.9768; train_kl_reg_loss: 10198.6207; train_edge_recon_loss: 1220211.7403; train_gene_expr_recon_loss: 1793793.1722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3024203.5333; train_optim_loss: 3024203.5333; val_kl_reg_loss: 10065.5641; val_edge_recon_loss: 1238895.4517; val_gene_expr_recon_loss: 1796658.2804; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3045619.2944; val_optim_loss: 3045619.2944
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9901; val_auprc_score: 0.9966; val_best_acc_score: 0.9642; val_best_f1_score: 0.9768; train_kl_reg_loss: 10197.9517; train_edge_recon_loss: 1218472.3584; train_gene_expr_recon_loss: 1793753.2034; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022423.5129; train_optim_loss: 3022423.5129; val_kl_reg_loss: 10068.2444; val_edge_recon_loss: 1235898.8965; val_gene_expr_recon_loss: 1796759.1802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3042726.3225; val_optim_loss: 3042726.3225

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9905; val_auprc_score: 0.9968; val_best_acc_score: 0.9647; val_best_f1_score: 0.9771; train_kl_reg_loss: 10197.0454; train_edge_recon_loss: 1218802.5953; train_gene_expr_recon_loss: 1793650.3876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022650.0280; train_optim_loss: 3022650.0280; val_kl_reg_loss: 10065.9249; val_edge_recon_loss: 1233495.0666; val_gene_expr_recon_loss: 1796096.7582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3039657.7591; val_optim_loss: 3039657.7591
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9904; val_auprc_score: 0.9967; val_best_acc_score: 0.9643; val_best_f1_score: 0.9768; train_kl_reg_loss: 10199.2414; train_edge_recon_loss: 1218329.3037; train_gene_expr_recon_loss: 1793931.1687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022459.7138; train_optim_loss: 3022459.7138; val_kl_reg_loss: 10067.0390; val_edge_recon_loss: 1237612.3437; val_gene_expr_recon_loss: 1796465.4272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3044144.8153; val_optim_loss: 3044144.8153
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9905; val_auprc_score: 0.9967; val_best_acc_score: 0.9646; val_best_f1_score: 0.9770; train_kl_reg_loss: 10199.3141; train_edge_recon_loss: 1218808.3764; train_gene_expr_recon_loss: 1793670.0324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022677.7229; train_optim_loss: 3022677.7229; val_kl_reg_loss: 10061.9560; val_edge_recon_loss: 1238213.7304; val_gene_expr_recon_loss: 1795405.3668; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3043681.0490; val_optim_loss: 3043681.0490
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9906; val_auprc_score: 0.9968; val_best_acc_score: 0.9646; val_best_f1_score: 0.9771; train_kl_reg_loss: 10199.2498; train_edge_recon_loss: 1218212.5692; train_gene_expr_recon_loss: 1793647.2378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3022059.0595; train_optim_loss: 3022059.0595; val_kl_reg_loss: 10066.1193; val_edge_recon_loss: 1235440.9922; val_gene_expr_recon_loss: 1795992.4259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3041499.5392; val_optim_loss: 3041499.5392

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 967 min 15 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.9905
val AUPRC score: 0.9968
val best accuracy score: 0.9648
val best F1 score: 0.9772
val target rna MSE score: 4.7002
val source rna MSE score: 0.6977
Val cat covariate0 mean sim diff: 0.0001

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
