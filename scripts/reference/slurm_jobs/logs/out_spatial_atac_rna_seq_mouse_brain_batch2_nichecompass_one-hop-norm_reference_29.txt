[True]
Run timestamp: 26072023_013155_29.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_29']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8943; val_auprc_score: 0.9040; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 20973.7406; train_edge_recon_loss: 353518.8611; train_gene_expr_recon_loss: 3143333.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10989121.1111; train_global_loss: 14506947.4444; train_optim_loss: 14506947.4444; val_kl_reg_loss: 42651.2305; val_edge_recon_loss: 406607.2188; val_gene_expr_recon_loss: 2899773.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10722107.0000; val_global_loss: 14071139.0000; val_optim_loss: 14071139.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8922; val_auprc_score: 0.9009; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 40982.3574; train_edge_recon_loss: 373420.2708; train_gene_expr_recon_loss: 2912667.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10856095.1111; train_global_loss: 14183164.7778; train_optim_loss: 14183164.7778; val_kl_reg_loss: 33675.5312; val_edge_recon_loss: 406609.1875; val_gene_expr_recon_loss: 2707195.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10532917.0000; val_global_loss: 13680398.0000; val_optim_loss: 13680398.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8951; val_auprc_score: 0.9005; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 39410.5391; train_edge_recon_loss: 383188.1181; train_gene_expr_recon_loss: 2663040.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10376889.8889; train_global_loss: 13462529.1111; train_optim_loss: 13462529.1111; val_kl_reg_loss: 45700.0508; val_edge_recon_loss: 406599.2812; val_gene_expr_recon_loss: 2550430.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10316407.0000; val_global_loss: 13319136.0000; val_optim_loss: 13319136.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8800; val_auprc_score: 0.8817; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 53726.6680; train_edge_recon_loss: 389884.3576; train_gene_expr_recon_loss: 2496836.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10215560.4444; train_global_loss: 13156007.8889; train_optim_loss: 13156007.8889; val_kl_reg_loss: 58390.4648; val_edge_recon_loss: 406581.1562; val_gene_expr_recon_loss: 2408006.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10163120.0000; val_global_loss: 13036098.0000; val_optim_loss: 13036098.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8787; val_auprc_score: 0.8757; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 60655.6215; train_edge_recon_loss: 392226.2500; train_gene_expr_recon_loss: 2388116.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9998713.2222; train_global_loss: 12839711.1111; train_optim_loss: 12839711.1111; val_kl_reg_loss: 66522.5859; val_edge_recon_loss: 406558.4062; val_gene_expr_recon_loss: 2330854.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10041033.0000; val_global_loss: 12844968.0000; val_optim_loss: 12844968.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8880; val_auprc_score: 0.8821; val_best_acc_score: 0.5109; val_best_f1_score: 0.6715; train_kl_reg_loss: 69180.0720; train_edge_recon_loss: 392476.7535; train_gene_expr_recon_loss: 2320525.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9946383.7778; train_global_loss: 12728565.8889; train_optim_loss: 12728565.8889; val_kl_reg_loss: 67069.5859; val_edge_recon_loss: 406465.6875; val_gene_expr_recon_loss: 2261750.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9962568.0000; val_global_loss: 12697853.0000; val_optim_loss: 12697853.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8857; val_auprc_score: 0.8738; val_best_acc_score: 0.5432; val_best_f1_score: 0.6861; train_kl_reg_loss: 72332.4358; train_edge_recon_loss: 392907.9931; train_gene_expr_recon_loss: 2241075.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9857479.7778; train_global_loss: 12563795.6667; train_optim_loss: 12563795.6667; val_kl_reg_loss: 72525.0000; val_edge_recon_loss: 406282.1562; val_gene_expr_recon_loss: 2202119.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9902779.0000; val_global_loss: 12583706.0000; val_optim_loss: 12583706.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8765; val_auprc_score: 0.8666; val_best_acc_score: 0.5984; val_best_f1_score: 0.7119; train_kl_reg_loss: 76455.0286; train_edge_recon_loss: 393578.1910; train_gene_expr_recon_loss: 2189666.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9816301.7778; train_global_loss: 12476001.6667; train_optim_loss: 12476001.6667; val_kl_reg_loss: 74064.0000; val_edge_recon_loss: 406004.5312; val_gene_expr_recon_loss: 2160011.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9874435.0000; val_global_loss: 12514515.0000; val_optim_loss: 12514515.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8691; val_auprc_score: 0.8540; val_best_acc_score: 0.6772; val_best_f1_score: 0.7525; train_kl_reg_loss: 79029.2839; train_edge_recon_loss: 394080.5972; train_gene_expr_recon_loss: 2168929.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9844136.1111; train_global_loss: 12486175.7778; train_optim_loss: 12486175.7778; val_kl_reg_loss: 72277.3594; val_edge_recon_loss: 405508.0938; val_gene_expr_recon_loss: 2133914.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9846266.0000; val_global_loss: 12457966.0000; val_optim_loss: 12457966.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8565; val_auprc_score: 0.8458; val_best_acc_score: 0.6989; val_best_f1_score: 0.7619; train_kl_reg_loss: 79205.5009; train_edge_recon_loss: 391934.9097; train_gene_expr_recon_loss: 2136733.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9774345.2222; train_global_loss: 12382218.7778; train_optim_loss: 12382218.7778; val_kl_reg_loss: 69997.6406; val_edge_recon_loss: 405112.5625; val_gene_expr_recon_loss: 2112948.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9811709.0000; val_global_loss: 12399767.0000; val_optim_loss: 12399767.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8604; val_auprc_score: 0.8507; val_best_acc_score: 0.7300; val_best_f1_score: 0.7780; train_kl_reg_loss: 77615.8785; train_edge_recon_loss: 392808.8507; train_gene_expr_recon_loss: 2112883.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9765584.4444; train_global_loss: 12348892.6667; train_optim_loss: 12348892.6667; val_kl_reg_loss: 70881.2734; val_edge_recon_loss: 404615.1562; val_gene_expr_recon_loss: 2101903.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9789800.0000; val_global_loss: 12367200.0000; val_optim_loss: 12367200.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8657; val_auprc_score: 0.8579; val_best_acc_score: 0.7599; val_best_f1_score: 0.7924; train_kl_reg_loss: 76927.1719; train_edge_recon_loss: 391477.9792; train_gene_expr_recon_loss: 2113820.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9758384.7778; train_global_loss: 12340610.7778; train_optim_loss: 12340610.7778; val_kl_reg_loss: 68199.9297; val_edge_recon_loss: 403747.1562; val_gene_expr_recon_loss: 2094056.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9776856.0000; val_global_loss: 12342860.0000; val_optim_loss: 12342860.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8627; val_auprc_score: 0.8559; val_best_acc_score: 0.7718; val_best_f1_score: 0.7937; train_kl_reg_loss: 75116.7231; train_edge_recon_loss: 390075.1111; train_gene_expr_recon_loss: 2107918.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9748026.6667; train_global_loss: 12321136.6667; train_optim_loss: 12321136.6667; val_kl_reg_loss: 65705.9453; val_edge_recon_loss: 403068.8125; val_gene_expr_recon_loss: 2083898.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9757084.0000; val_global_loss: 12309757.0000; val_optim_loss: 12309757.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8640; val_auprc_score: 0.8557; val_best_acc_score: 0.7767; val_best_f1_score: 0.7883; train_kl_reg_loss: 73072.0616; train_edge_recon_loss: 388734.3125; train_gene_expr_recon_loss: 2106469.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9748206.7778; train_global_loss: 12316482.1111; train_optim_loss: 12316482.1111; val_kl_reg_loss: 66733.6016; val_edge_recon_loss: 401999.9688; val_gene_expr_recon_loss: 2078520.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9748586.0000; val_global_loss: 12295840.0000; val_optim_loss: 12295840.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8607; val_auprc_score: 0.8561; val_best_acc_score: 0.7738; val_best_f1_score: 0.7739; train_kl_reg_loss: 71868.9748; train_edge_recon_loss: 386269.1076; train_gene_expr_recon_loss: 2086570.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9702099.4444; train_global_loss: 12246807.8889; train_optim_loss: 12246807.8889; val_kl_reg_loss: 65358.6484; val_edge_recon_loss: 400399.1250; val_gene_expr_recon_loss: 2072845.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9743257.0000; val_global_loss: 12281860.0000; val_optim_loss: 12281860.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8602; val_auprc_score: 0.8497; val_best_acc_score: 0.7662; val_best_f1_score: 0.7658; train_kl_reg_loss: 70572.4792; train_edge_recon_loss: 384659.2917; train_gene_expr_recon_loss: 2099008.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9724754.8889; train_global_loss: 12278995.7778; train_optim_loss: 12278995.7778; val_kl_reg_loss: 61705.4219; val_edge_recon_loss: 398466.2812; val_gene_expr_recon_loss: 2069507.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9726196.0000; val_global_loss: 12255875.0000; val_optim_loss: 12255875.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8700; val_auprc_score: 0.8630; val_best_acc_score: 0.7639; val_best_f1_score: 0.7856; train_kl_reg_loss: 68248.6736; train_edge_recon_loss: 382965.8576; train_gene_expr_recon_loss: 2078594.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9663613.3333; train_global_loss: 12193422.2222; train_optim_loss: 12193422.2222; val_kl_reg_loss: 61461.8086; val_edge_recon_loss: 395829.1875; val_gene_expr_recon_loss: 2066939.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9726513.0000; val_global_loss: 12250743.0000; val_optim_loss: 12250743.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8676; val_auprc_score: 0.8560; val_best_acc_score: 0.7674; val_best_f1_score: 0.7973; train_kl_reg_loss: 67601.8633; train_edge_recon_loss: 380609.6736; train_gene_expr_recon_loss: 2083692.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9667041.8889; train_global_loss: 12198946.1111; train_optim_loss: 12198946.1111; val_kl_reg_loss: 61297.9688; val_edge_recon_loss: 392656.5938; val_gene_expr_recon_loss: 2062629.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9716213.0000; val_global_loss: 12232798.0000; val_optim_loss: 12232798.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8718; val_auprc_score: 0.8626; val_best_acc_score: 0.7750; val_best_f1_score: 0.7975; train_kl_reg_loss: 66115.7912; train_edge_recon_loss: 377771.0069; train_gene_expr_recon_loss: 2078804.1528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9647514.4444; train_global_loss: 12170205.5556; train_optim_loss: 12170205.5556; val_kl_reg_loss: 60577.3711; val_edge_recon_loss: 389517.4375; val_gene_expr_recon_loss: 2057806.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9696680.0000; val_global_loss: 12204581.0000; val_optim_loss: 12204581.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8733; val_auprc_score: 0.8634; val_best_acc_score: 0.7874; val_best_f1_score: 0.8016; train_kl_reg_loss: 65524.8012; train_edge_recon_loss: 374827.6007; train_gene_expr_recon_loss: 2068727.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9647593.8889; train_global_loss: 12156674.3333; train_optim_loss: 12156674.3333; val_kl_reg_loss: 59812.6406; val_edge_recon_loss: 384606.6875; val_gene_expr_recon_loss: 2055143.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9696137.0000; val_global_loss: 12195700.0000; val_optim_loss: 12195700.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8713; val_auprc_score: 0.8577; val_best_acc_score: 0.7862; val_best_f1_score: 0.7994; train_kl_reg_loss: 63785.9961; train_edge_recon_loss: 372762.3472; train_gene_expr_recon_loss: 2064500.4306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9580789.3333; train_global_loss: 12081838.2222; train_optim_loss: 12081838.2222; val_kl_reg_loss: 61332.7500; val_edge_recon_loss: 381005.8750; val_gene_expr_recon_loss: 2053780.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9683478.0000; val_global_loss: 12179596.0000; val_optim_loss: 12179596.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8729; val_auprc_score: 0.8630; val_best_acc_score: 0.7838; val_best_f1_score: 0.8043; train_kl_reg_loss: 64441.3021; train_edge_recon_loss: 369065.0868; train_gene_expr_recon_loss: 2056938.9028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9590797.5556; train_global_loss: 12081242.8889; train_optim_loss: 12081242.8889; val_kl_reg_loss: 59894.1406; val_edge_recon_loss: 376660.5938; val_gene_expr_recon_loss: 2051747.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9680572.0000; val_global_loss: 12168874.0000; val_optim_loss: 12168874.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8812; val_auprc_score: 0.8699; val_best_acc_score: 0.7908; val_best_f1_score: 0.8087; train_kl_reg_loss: 64046.4071; train_edge_recon_loss: 366500.0764; train_gene_expr_recon_loss: 2062647.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9647552.6667; train_global_loss: 12140746.4444; train_optim_loss: 12140746.4444; val_kl_reg_loss: 60512.8281; val_edge_recon_loss: 371941.3125; val_gene_expr_recon_loss: 2048621.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9673840.0000; val_global_loss: 12154916.0000; val_optim_loss: 12154916.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8720; val_auprc_score: 0.8572; val_best_acc_score: 0.7868; val_best_f1_score: 0.8042; train_kl_reg_loss: 63924.6359; train_edge_recon_loss: 363210.6319; train_gene_expr_recon_loss: 2045800.0139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9545317.3333; train_global_loss: 12018252.6667; train_optim_loss: 12018252.6667; val_kl_reg_loss: 62006.0000; val_edge_recon_loss: 368820.2812; val_gene_expr_recon_loss: 2046244.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9670015.0000; val_global_loss: 12147086.0000; val_optim_loss: 12147086.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8817; val_auprc_score: 0.8655; val_best_acc_score: 0.7959; val_best_f1_score: 0.8099; train_kl_reg_loss: 64260.1992; train_edge_recon_loss: 359251.9201; train_gene_expr_recon_loss: 2058773.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9517705.1111; train_global_loss: 11999991.1111; train_optim_loss: 11999991.1111; val_kl_reg_loss: 61398.9375; val_edge_recon_loss: 363156.5000; val_gene_expr_recon_loss: 2042918.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9649355.0000; val_global_loss: 12116828.0000; val_optim_loss: 12116828.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8982; val_auprc_score: 0.8839; val_best_acc_score: 0.8178; val_best_f1_score: 0.8262; train_kl_reg_loss: 69439.9223; train_edge_recon_loss: 374194.5451; train_gene_expr_recon_loss: 2102715.9861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9658272.1111; train_global_loss: 12204622.6667; train_optim_loss: 12204622.6667; val_kl_reg_loss: 48021.6250; val_edge_recon_loss: 380065.9688; val_gene_expr_recon_loss: 2087184.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9705155.0000; val_global_loss: 12220427.0000; val_optim_loss: 12220427.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9012; val_auprc_score: 0.8897; val_best_acc_score: 0.8205; val_best_f1_score: 0.8291; train_kl_reg_loss: 68294.3220; train_edge_recon_loss: 369808.6771; train_gene_expr_recon_loss: 2106601.9028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9689984.3333; train_global_loss: 12234689.2222; train_optim_loss: 12234689.2222; val_kl_reg_loss: 46085.0625; val_edge_recon_loss: 380232.9375; val_gene_expr_recon_loss: 2084775.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9688433.0000; val_global_loss: 12199526.0000; val_optim_loss: 12199526.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9035; val_auprc_score: 0.8881; val_best_acc_score: 0.8244; val_best_f1_score: 0.8345; train_kl_reg_loss: 63545.6571; train_edge_recon_loss: 371565.7847; train_gene_expr_recon_loss: 2100104.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9652519.0000; train_global_loss: 12187734.8889; train_optim_loss: 12187734.8889; val_kl_reg_loss: 44500.2969; val_edge_recon_loss: 382430.2500; val_gene_expr_recon_loss: 2080578.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9673397.0000; val_global_loss: 12180906.0000; val_optim_loss: 12180906.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9068; val_auprc_score: 0.8902; val_best_acc_score: 0.8281; val_best_f1_score: 0.8375; train_kl_reg_loss: 61889.7378; train_edge_recon_loss: 371810.5938; train_gene_expr_recon_loss: 2099887.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9648770.2222; train_global_loss: 12182358.5556; train_optim_loss: 12182358.5556; val_kl_reg_loss: 40971.1953; val_edge_recon_loss: 381193.7812; val_gene_expr_recon_loss: 2080171.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9675952.0000; val_global_loss: 12178288.0000; val_optim_loss: 12178288.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9039; val_auprc_score: 0.8895; val_best_acc_score: 0.8195; val_best_f1_score: 0.8314; train_kl_reg_loss: 54622.6328; train_edge_recon_loss: 373497.3507; train_gene_expr_recon_loss: 2100064.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9616616.8889; train_global_loss: 12144801.4444; train_optim_loss: 12144801.4444; val_kl_reg_loss: 49161.7188; val_edge_recon_loss: 382794.4688; val_gene_expr_recon_loss: 2074418.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9663368.0000; val_global_loss: 12169743.0000; val_optim_loss: 12169743.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9081; val_auprc_score: 0.8965; val_best_acc_score: 0.8217; val_best_f1_score: 0.8334; train_kl_reg_loss: 62515.5807; train_edge_recon_loss: 369756.6007; train_gene_expr_recon_loss: 2085130.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9533696.3333; train_global_loss: 12051099.1111; train_optim_loss: 12051099.1111; val_kl_reg_loss: 48376.4141; val_edge_recon_loss: 382359.1562; val_gene_expr_recon_loss: 2073237.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9673264.0000; val_global_loss: 12177237.0000; val_optim_loss: 12177237.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9117; val_auprc_score: 0.8994; val_best_acc_score: 0.8296; val_best_f1_score: 0.8397; train_kl_reg_loss: 58131.5564; train_edge_recon_loss: 372395.5833; train_gene_expr_recon_loss: 2081298.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9605077.2222; train_global_loss: 12116902.7778; train_optim_loss: 12116902.7778; val_kl_reg_loss: 46094.8047; val_edge_recon_loss: 382387.9062; val_gene_expr_recon_loss: 2074048.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9663713.0000; val_global_loss: 12166244.0000; val_optim_loss: 12166244.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9081; val_auprc_score: 0.8950; val_best_acc_score: 0.8230; val_best_f1_score: 0.8345; train_kl_reg_loss: 60003.1567; train_edge_recon_loss: 370326.6875; train_gene_expr_recon_loss: 2093755.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9622004.2222; train_global_loss: 12146089.7778; train_optim_loss: 12146089.7778; val_kl_reg_loss: 48473.3906; val_edge_recon_loss: 382982.3125; val_gene_expr_recon_loss: 2073456.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9649956.0000; val_global_loss: 12154868.0000; val_optim_loss: 12154868.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 41 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.8971
Val AUPRC score: 0.8882
Val best accuracy score: 0.8091
Val best F1 score: 0.8207
Val gene expr MSE score: 0.5111
Val chrom access MSE score: 0.0877
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
