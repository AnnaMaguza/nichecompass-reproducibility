[True]
Run timestamp: 07082023_180012_29.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_29']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8905; val_auprc_score: 0.9051; val_best_acc_score: 0.5012; val_best_f1_score: 0.6672; train_kl_reg_loss: 12938.6203; train_edge_recon_loss: 35470.2626; train_gene_expr_recon_loss: 1228443.4167; train_masked_gp_l1_reg_loss: 4540.4029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119050.5859; train_chrom_access_recon_loss: 898785.1424; train_global_loss: 2299228.4028; train_optim_loss: 2299228.4028; val_kl_reg_loss: 3517.5244; val_edge_recon_loss: 40654.4062; val_gene_expr_recon_loss: 1071749.0000; val_masked_gp_l1_reg_loss: 4024.7439; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116796.8906; val_chrom_access_recon_loss: 509342.4375; val_global_loss: 1746085.0000; val_optim_loss: 1746085.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8932; val_auprc_score: 0.9063; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3816.6249; train_edge_recon_loss: 35866.3845; train_gene_expr_recon_loss: 1018421.6319; train_masked_gp_l1_reg_loss: 3949.9325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115418.3915; train_chrom_access_recon_loss: 499743.7396; train_global_loss: 1677216.6944; train_optim_loss: 1677216.6944; val_kl_reg_loss: 5595.6377; val_edge_recon_loss: 40658.3125; val_gene_expr_recon_loss: 959406.8750; val_masked_gp_l1_reg_loss: 3976.1235; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113755.6406; val_chrom_access_recon_loss: 485493.9062; val_global_loss: 1608886.5000; val_optim_loss: 1608886.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8917; val_auprc_score: 0.9031; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 10136.4767; train_edge_recon_loss: 37374.8220; train_gene_expr_recon_loss: 897872.6736; train_masked_gp_l1_reg_loss: 4121.8209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112459.7465; train_chrom_access_recon_loss: 485358.0556; train_global_loss: 1547323.5833; train_optim_loss: 1547323.5833; val_kl_reg_loss: 15716.5049; val_edge_recon_loss: 40660.7852; val_gene_expr_recon_loss: 850301.8750; val_masked_gp_l1_reg_loss: 4267.3154; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110817.0469; val_chrom_access_recon_loss: 476524.8125; val_global_loss: 1498288.3750; val_optim_loss: 1498288.3750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8825; val_auprc_score: 0.8937; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17104.7421; train_edge_recon_loss: 38456.7617; train_gene_expr_recon_loss: 812031.7639; train_masked_gp_l1_reg_loss: 4280.2511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109412.3082; train_chrom_access_recon_loss: 472253.4688; train_global_loss: 1453539.2917; train_optim_loss: 1453539.2917; val_kl_reg_loss: 17072.0996; val_edge_recon_loss: 40660.0391; val_gene_expr_recon_loss: 789587.0000; val_masked_gp_l1_reg_loss: 4268.2603; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107581.9922; val_chrom_access_recon_loss: 459943.5938; val_global_loss: 1419113.0000; val_optim_loss: 1419113.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8702; val_auprc_score: 0.8790; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 18297.2522; train_edge_recon_loss: 38580.8303; train_gene_expr_recon_loss: 767355.8681; train_masked_gp_l1_reg_loss: 4256.0182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105990.1866; train_chrom_access_recon_loss: 456964.5243; train_global_loss: 1391444.6944; train_optim_loss: 1391444.6944; val_kl_reg_loss: 19185.2969; val_edge_recon_loss: 40658.7305; val_gene_expr_recon_loss: 752056.6250; val_masked_gp_l1_reg_loss: 4232.5562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103917.9688; val_chrom_access_recon_loss: 450709.3750; val_global_loss: 1370760.5000; val_optim_loss: 1370760.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8676; val_auprc_score: 0.8783; val_best_acc_score: 0.5073; val_best_f1_score: 0.6699; train_kl_reg_loss: 19791.0740; train_edge_recon_loss: 38727.5599; train_gene_expr_recon_loss: 737693.6944; train_masked_gp_l1_reg_loss: 4208.1917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102139.9036; train_chrom_access_recon_loss: 452048.9861; train_global_loss: 1354609.4028; train_optim_loss: 1354609.4028; val_kl_reg_loss: 18672.9609; val_edge_recon_loss: 40655.9805; val_gene_expr_recon_loss: 729311.7500; val_masked_gp_l1_reg_loss: 4174.8613; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99860.7969; val_chrom_access_recon_loss: 445837.7500; val_global_loss: 1338514.1250; val_optim_loss: 1338514.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8710; val_auprc_score: 0.8751; val_best_acc_score: 0.5150; val_best_f1_score: 0.6733; train_kl_reg_loss: 19326.5208; train_edge_recon_loss: 38677.6849; train_gene_expr_recon_loss: 716956.9097; train_masked_gp_l1_reg_loss: 4162.5962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97979.9167; train_chrom_access_recon_loss: 448512.0278; train_global_loss: 1325615.6528; train_optim_loss: 1325615.6528; val_kl_reg_loss: 19565.5039; val_edge_recon_loss: 40650.7305; val_gene_expr_recon_loss: 711837.4375; val_masked_gp_l1_reg_loss: 4146.2275; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95604.2812; val_chrom_access_recon_loss: 443098.5000; val_global_loss: 1314902.7500; val_optim_loss: 1314902.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8659; val_auprc_score: 0.8650; val_best_acc_score: 0.5187; val_best_f1_score: 0.6743; train_kl_reg_loss: 19900.5985; train_edge_recon_loss: 38792.7700; train_gene_expr_recon_loss: 698193.4306; train_masked_gp_l1_reg_loss: 4134.7521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93683.4453; train_chrom_access_recon_loss: 444311.8993; train_global_loss: 1299016.9028; train_optim_loss: 1299016.9028; val_kl_reg_loss: 19606.9238; val_edge_recon_loss: 40642.1680; val_gene_expr_recon_loss: 698829.5000; val_masked_gp_l1_reg_loss: 4112.9233; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91276.2109; val_chrom_access_recon_loss: 441007.8125; val_global_loss: 1295475.5000; val_optim_loss: 1295475.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8593; val_auprc_score: 0.8572; val_best_acc_score: 0.5325; val_best_f1_score: 0.6797; train_kl_reg_loss: 19973.2220; train_edge_recon_loss: 38783.7687; train_gene_expr_recon_loss: 687991.0000; train_masked_gp_l1_reg_loss: 4103.7397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89351.7778; train_chrom_access_recon_loss: 443565.0868; train_global_loss: 1283768.5972; train_optim_loss: 1283768.5972; val_kl_reg_loss: 19305.4766; val_edge_recon_loss: 40627.9336; val_gene_expr_recon_loss: 688493.7500; val_masked_gp_l1_reg_loss: 4086.6572; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86951.2109; val_chrom_access_recon_loss: 439095.5000; val_global_loss: 1278560.5000; val_optim_loss: 1278560.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8603; val_auprc_score: 0.8656; val_best_acc_score: 0.5551; val_best_f1_score: 0.6891; train_kl_reg_loss: 19917.9388; train_edge_recon_loss: 38793.8316; train_gene_expr_recon_loss: 677910.2361; train_masked_gp_l1_reg_loss: 4078.6501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85056.1606; train_chrom_access_recon_loss: 440972.0590; train_global_loss: 1266728.8750; train_optim_loss: 1266728.8750; val_kl_reg_loss: 19701.0488; val_edge_recon_loss: 40611.9844; val_gene_expr_recon_loss: 679689.3750; val_masked_gp_l1_reg_loss: 4065.8508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82702.1016; val_chrom_access_recon_loss: 437701.0312; val_global_loss: 1264471.3750; val_optim_loss: 1264471.3750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8532; val_auprc_score: 0.8575; val_best_acc_score: 0.5821; val_best_f1_score: 0.7013; train_kl_reg_loss: 20165.8702; train_edge_recon_loss: 38851.0707; train_gene_expr_recon_loss: 670889.3125; train_masked_gp_l1_reg_loss: 4058.9924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80854.7778; train_chrom_access_recon_loss: 439171.0000; train_global_loss: 1253991.0278; train_optim_loss: 1253991.0278; val_kl_reg_loss: 19503.5781; val_edge_recon_loss: 40593.4922; val_gene_expr_recon_loss: 672916.1250; val_masked_gp_l1_reg_loss: 4046.2065; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78566.8750; val_chrom_access_recon_loss: 436372.0625; val_global_loss: 1251998.2500; val_optim_loss: 1251998.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8488; val_auprc_score: 0.8529; val_best_acc_score: 0.6268; val_best_f1_score: 0.7227; train_kl_reg_loss: 20150.8270; train_edge_recon_loss: 38842.7209; train_gene_expr_recon_loss: 664603.5278; train_masked_gp_l1_reg_loss: 4042.9677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76780.9123; train_chrom_access_recon_loss: 439272.9062; train_global_loss: 1243693.8333; train_optim_loss: 1243693.8333; val_kl_reg_loss: 19074.3320; val_edge_recon_loss: 40562.9922; val_gene_expr_recon_loss: 668140.1250; val_masked_gp_l1_reg_loss: 4034.2139; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74570.8594; val_chrom_access_recon_loss: 435085.8438; val_global_loss: 1241468.3750; val_optim_loss: 1241468.3750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8489; val_auprc_score: 0.8449; val_best_acc_score: 0.6601; val_best_f1_score: 0.7395; train_kl_reg_loss: 19907.2819; train_edge_recon_loss: 38845.9128; train_gene_expr_recon_loss: 660891.2569; train_masked_gp_l1_reg_loss: 4030.6345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72858.9826; train_chrom_access_recon_loss: 436828.5174; train_global_loss: 1233362.5694; train_optim_loss: 1233362.5694; val_kl_reg_loss: 18946.5859; val_edge_recon_loss: 40544.4492; val_gene_expr_recon_loss: 664154.5000; val_masked_gp_l1_reg_loss: 4022.4197; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70746.2109; val_chrom_access_recon_loss: 434115.3438; val_global_loss: 1232529.5000; val_optim_loss: 1232529.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8565; val_auprc_score: 0.8529; val_best_acc_score: 0.6850; val_best_f1_score: 0.7525; train_kl_reg_loss: 19660.3958; train_edge_recon_loss: 38816.3733; train_gene_expr_recon_loss: 656710.6181; train_masked_gp_l1_reg_loss: 4023.3721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69115.3776; train_chrom_access_recon_loss: 435820.8993; train_global_loss: 1224147.0278; train_optim_loss: 1224147.0278; val_kl_reg_loss: 18782.8984; val_edge_recon_loss: 40533.2305; val_gene_expr_recon_loss: 660866.5625; val_masked_gp_l1_reg_loss: 4014.3198; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67106.4219; val_chrom_access_recon_loss: 433156.2500; val_global_loss: 1224459.7500; val_optim_loss: 1224459.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8807; val_auprc_score: 0.8774; val_best_acc_score: 0.7437; val_best_f1_score: 0.7870; train_kl_reg_loss: 19263.0354; train_edge_recon_loss: 38795.2036; train_gene_expr_recon_loss: 651626.3056; train_masked_gp_l1_reg_loss: 4014.4282; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65561.8056; train_chrom_access_recon_loss: 435641.5694; train_global_loss: 1214902.3472; train_optim_loss: 1214902.3472; val_kl_reg_loss: 18782.4609; val_edge_recon_loss: 40500.4531; val_gene_expr_recon_loss: 658037.5000; val_masked_gp_l1_reg_loss: 4009.5063; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63664.0625; val_chrom_access_recon_loss: 432116.5625; val_global_loss: 1217110.5000; val_optim_loss: 1217110.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8979; val_auprc_score: 0.8865; val_best_acc_score: 0.7921; val_best_f1_score: 0.8165; train_kl_reg_loss: 18963.2483; train_edge_recon_loss: 38757.7695; train_gene_expr_recon_loss: 651599.4583; train_masked_gp_l1_reg_loss: 4012.1739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62210.9718; train_chrom_access_recon_loss: 434809.1424; train_global_loss: 1210352.7639; train_optim_loss: 1210352.7639; val_kl_reg_loss: 17434.2617; val_edge_recon_loss: 40423.1914; val_gene_expr_recon_loss: 657274.6250; val_masked_gp_l1_reg_loss: 4010.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60424.0938; val_chrom_access_recon_loss: 431453.0625; val_global_loss: 1211019.5000; val_optim_loss: 1211019.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9133; val_auprc_score: 0.9046; val_best_acc_score: 0.8289; val_best_f1_score: 0.8411; train_kl_reg_loss: 18633.2682; train_edge_recon_loss: 38705.2995; train_gene_expr_recon_loss: 649224.2014; train_masked_gp_l1_reg_loss: 4018.2506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59062.1198; train_chrom_access_recon_loss: 434735.5833; train_global_loss: 1204378.7222; train_optim_loss: 1204378.7222; val_kl_reg_loss: 17713.6641; val_edge_recon_loss: 40349.4102; val_gene_expr_recon_loss: 654156.9375; val_masked_gp_l1_reg_loss: 4020.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57391.7148; val_chrom_access_recon_loss: 430515.9062; val_global_loss: 1204148.2500; val_optim_loss: 1204148.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9201; val_auprc_score: 0.9056; val_best_acc_score: 0.8486; val_best_f1_score: 0.8534; train_kl_reg_loss: 18360.3498; train_edge_recon_loss: 38614.7478; train_gene_expr_recon_loss: 650631.3889; train_masked_gp_l1_reg_loss: 4027.3254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56120.9362; train_chrom_access_recon_loss: 433917.5660; train_global_loss: 1201672.3056; train_optim_loss: 1201672.3056; val_kl_reg_loss: 17658.3809; val_edge_recon_loss: 40264.4492; val_gene_expr_recon_loss: 652047.1875; val_masked_gp_l1_reg_loss: 4030.2822; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54560.2656; val_chrom_access_recon_loss: 429760.4375; val_global_loss: 1198321.0000; val_optim_loss: 1198321.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9250; val_auprc_score: 0.9110; val_best_acc_score: 0.8530; val_best_f1_score: 0.8532; train_kl_reg_loss: 18123.1109; train_edge_recon_loss: 38544.9931; train_gene_expr_recon_loss: 644014.2569; train_masked_gp_l1_reg_loss: 4036.9496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53374.8572; train_chrom_access_recon_loss: 432188.4062; train_global_loss: 1190282.5694; train_optim_loss: 1190282.5694; val_kl_reg_loss: 17199.6523; val_edge_recon_loss: 40166.1562; val_gene_expr_recon_loss: 650726.6250; val_masked_gp_l1_reg_loss: 4041.4233; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51919.1406; val_chrom_access_recon_loss: 428900.5938; val_global_loss: 1192953.6250; val_optim_loss: 1192953.6250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9346; val_auprc_score: 0.9232; val_best_acc_score: 0.8588; val_best_f1_score: 0.8555; train_kl_reg_loss: 17851.3112; train_edge_recon_loss: 38457.7986; train_gene_expr_recon_loss: 645044.4444; train_masked_gp_l1_reg_loss: 4050.8718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50815.4544; train_chrom_access_recon_loss: 432945.8229; train_global_loss: 1189165.6806; train_optim_loss: 1189165.6806; val_kl_reg_loss: 17273.3379; val_edge_recon_loss: 40068.7266; val_gene_expr_recon_loss: 648842.1875; val_masked_gp_l1_reg_loss: 4055.7622; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49457.4648; val_chrom_access_recon_loss: 428247.1250; val_global_loss: 1187944.5000; val_optim_loss: 1187944.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9320; val_auprc_score: 0.9213; val_best_acc_score: 0.8504; val_best_f1_score: 0.8454; train_kl_reg_loss: 17595.9935; train_edge_recon_loss: 38378.7791; train_gene_expr_recon_loss: 642893.2083; train_masked_gp_l1_reg_loss: 4066.0902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48422.1905; train_chrom_access_recon_loss: 431007.4618; train_global_loss: 1182363.7361; train_optim_loss: 1182363.7361; val_kl_reg_loss: 16712.5410; val_edge_recon_loss: 40001.0234; val_gene_expr_recon_loss: 647965.3750; val_masked_gp_l1_reg_loss: 4072.4343; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47153.5547; val_chrom_access_recon_loss: 427716.4688; val_global_loss: 1183621.3750; val_optim_loss: 1183621.3750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9349; val_auprc_score: 0.9205; val_best_acc_score: 0.8496; val_best_f1_score: 0.8423; train_kl_reg_loss: 17343.1519; train_edge_recon_loss: 38316.1159; train_gene_expr_recon_loss: 641344.1042; train_masked_gp_l1_reg_loss: 4082.2374; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46192.6458; train_chrom_access_recon_loss: 428617.0590; train_global_loss: 1175895.3333; train_optim_loss: 1175895.3333; val_kl_reg_loss: 16810.2031; val_edge_recon_loss: 39922.6758; val_gene_expr_recon_loss: 646224.7500; val_masked_gp_l1_reg_loss: 4088.3618; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45008.4609; val_chrom_access_recon_loss: 427106.8750; val_global_loss: 1179161.2500; val_optim_loss: 1179161.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9343; val_auprc_score: 0.9219; val_best_acc_score: 0.8382; val_best_f1_score: 0.8305; train_kl_reg_loss: 17137.7029; train_edge_recon_loss: 38219.4870; train_gene_expr_recon_loss: 637554.8542; train_masked_gp_l1_reg_loss: 4100.0837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44110.7387; train_chrom_access_recon_loss: 431122.7396; train_global_loss: 1172245.5972; train_optim_loss: 1172245.5972; val_kl_reg_loss: 16111.3340; val_edge_recon_loss: 39798.4062; val_gene_expr_recon_loss: 645806.5000; val_masked_gp_l1_reg_loss: 4103.7217; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43002.4961; val_chrom_access_recon_loss: 426618.9062; val_global_loss: 1175441.3750; val_optim_loss: 1175441.3750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9403; val_auprc_score: 0.9287; val_best_acc_score: 0.8442; val_best_f1_score: 0.8370; train_kl_reg_loss: 16938.0582; train_edge_recon_loss: 38146.4900; train_gene_expr_recon_loss: 637636.0764; train_masked_gp_l1_reg_loss: 4110.8404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42162.9696; train_chrom_access_recon_loss: 428717.7292; train_global_loss: 1167712.1667; train_optim_loss: 1167712.1667; val_kl_reg_loss: 16242.2383; val_edge_recon_loss: 39742.7422; val_gene_expr_recon_loss: 644091.6875; val_masked_gp_l1_reg_loss: 4113.2490; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41129.2578; val_chrom_access_recon_loss: 425714.4375; val_global_loss: 1171033.6250; val_optim_loss: 1171033.6250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9453; val_auprc_score: 0.9371; val_best_acc_score: 0.8389; val_best_f1_score: 0.8466; train_kl_reg_loss: 16726.7645; train_edge_recon_loss: 38073.3186; train_gene_expr_recon_loss: 636465.9236; train_masked_gp_l1_reg_loss: 4120.6972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40346.4015; train_chrom_access_recon_loss: 428638.7326; train_global_loss: 1164371.8611; train_optim_loss: 1164371.8611; val_kl_reg_loss: 16262.6758; val_edge_recon_loss: 39653.8438; val_gene_expr_recon_loss: 642742.5000; val_masked_gp_l1_reg_loss: 4121.6265; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39375.2109; val_chrom_access_recon_loss: 425159.0000; val_global_loss: 1167314.7500; val_optim_loss: 1167314.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9416; val_auprc_score: 0.9306; val_best_acc_score: 0.8603; val_best_f1_score: 0.8547; train_kl_reg_loss: 13809.2132; train_edge_recon_loss: 39207.6654; train_gene_expr_recon_loss: 910052.9375; train_masked_gp_l1_reg_loss: 4195.9221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38531.4978; train_chrom_access_recon_loss: 452038.7535; train_global_loss: 1457835.9583; train_optim_loss: 1457835.9583; val_kl_reg_loss: 12669.7578; val_edge_recon_loss: 39915.6875; val_gene_expr_recon_loss: 909261.8125; val_masked_gp_l1_reg_loss: 4336.2407; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37421.4961; val_chrom_access_recon_loss: 447815.9688; val_global_loss: 1451421.0000; val_optim_loss: 1451421.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9387; val_auprc_score: 0.9258; val_best_acc_score: 0.8557; val_best_f1_score: 0.8491; train_kl_reg_loss: 13494.8823; train_edge_recon_loss: 39276.8268; train_gene_expr_recon_loss: 899194.9167; train_masked_gp_l1_reg_loss: 4450.7677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36514.6589; train_chrom_access_recon_loss: 450919.9444; train_global_loss: 1443852.0000; train_optim_loss: 1443852.0000; val_kl_reg_loss: 12536.0234; val_edge_recon_loss: 39889.4336; val_gene_expr_recon_loss: 902581.1250; val_masked_gp_l1_reg_loss: 4590.5151; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35399.0273; val_chrom_access_recon_loss: 447189.2188; val_global_loss: 1442185.2500; val_optim_loss: 1442185.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9364; val_auprc_score: 0.9188; val_best_acc_score: 0.8432; val_best_f1_score: 0.8427; train_kl_reg_loss: 13396.3446; train_edge_recon_loss: 39130.3225; train_gene_expr_recon_loss: 890782.4375; train_masked_gp_l1_reg_loss: 4681.5956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34541.4358; train_chrom_access_recon_loss: 447439.3229; train_global_loss: 1429971.4583; train_optim_loss: 1429971.4583; val_kl_reg_loss: 12625.5186; val_edge_recon_loss: 39713.1680; val_gene_expr_recon_loss: 897680.8750; val_masked_gp_l1_reg_loss: 4780.5864; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33494.3594; val_chrom_access_recon_loss: 446450.5938; val_global_loss: 1434745.1250; val_optim_loss: 1434745.1250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9430; val_auprc_score: 0.9272; val_best_acc_score: 0.8444; val_best_f1_score: 0.8549; train_kl_reg_loss: 13472.7139; train_edge_recon_loss: 39081.1337; train_gene_expr_recon_loss: 893643.3889; train_masked_gp_l1_reg_loss: 4839.4430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32699.6554; train_chrom_access_recon_loss: 449986.2535; train_global_loss: 1433722.5972; train_optim_loss: 1433722.5972; val_kl_reg_loss: 12374.6387; val_edge_recon_loss: 39547.6953; val_gene_expr_recon_loss: 894038.3125; val_masked_gp_l1_reg_loss: 4901.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31733.2129; val_chrom_access_recon_loss: 445949.2812; val_global_loss: 1428544.7500; val_optim_loss: 1428544.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9418; val_auprc_score: 0.9272; val_best_acc_score: 0.8420; val_best_f1_score: 0.8544; train_kl_reg_loss: 13267.5713; train_edge_recon_loss: 38966.4809; train_gene_expr_recon_loss: 887574.0278; train_masked_gp_l1_reg_loss: 4891.3539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31621.2016; train_chrom_access_recon_loss: 447834.4931; train_global_loss: 1424155.1250; train_optim_loss: 1424155.1250; val_kl_reg_loss: 12585.5879; val_edge_recon_loss: 39554.4336; val_gene_expr_recon_loss: 893436.0000; val_masked_gp_l1_reg_loss: 4882.2017; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31486.1680; val_chrom_access_recon_loss: 445802.6250; val_global_loss: 1427747.0000; val_optim_loss: 1427747.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9420; val_auprc_score: 0.9306; val_best_acc_score: 0.8413; val_best_f1_score: 0.8510; train_kl_reg_loss: 13524.2087; train_edge_recon_loss: 38960.2509; train_gene_expr_recon_loss: 888673.8611; train_masked_gp_l1_reg_loss: 4880.9663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31393.0228; train_chrom_access_recon_loss: 451624.9132; train_global_loss: 1429057.2083; train_optim_loss: 1429057.2083; val_kl_reg_loss: 12684.3887; val_edge_recon_loss: 39557.9180; val_gene_expr_recon_loss: 892958.6875; val_masked_gp_l1_reg_loss: 4878.1733; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31275.7148; val_chrom_access_recon_loss: 445733.1875; val_global_loss: 1427088.0000; val_optim_loss: 1427088.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9437; val_auprc_score: 0.9292; val_best_acc_score: 0.8428; val_best_f1_score: 0.8553; train_kl_reg_loss: 13503.0851; train_edge_recon_loss: 38962.4592; train_gene_expr_recon_loss: 885632.1667; train_masked_gp_l1_reg_loss: 4877.2049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31187.0998; train_chrom_access_recon_loss: 448035.2500; train_global_loss: 1422197.2500; train_optim_loss: 1422197.2500; val_kl_reg_loss: 12593.6719; val_edge_recon_loss: 39536.2344; val_gene_expr_recon_loss: 892741.0625; val_masked_gp_l1_reg_loss: 4876.3794; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31078.2070; val_chrom_access_recon_loss: 445661.7812; val_global_loss: 1426487.3750; val_optim_loss: 1426487.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9449; val_auprc_score: 0.9310; val_best_acc_score: 0.8414; val_best_f1_score: 0.8609; train_kl_reg_loss: 13427.1215; train_edge_recon_loss: 38944.5734; train_gene_expr_recon_loss: 884749.2153; train_masked_gp_l1_reg_loss: 4876.6850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30993.5668; train_chrom_access_recon_loss: 446883.8194; train_global_loss: 1419874.9861; train_optim_loss: 1419874.9861; val_kl_reg_loss: 12629.9766; val_edge_recon_loss: 39500.9570; val_gene_expr_recon_loss: 892441.1250; val_masked_gp_l1_reg_loss: 4877.2935; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30890.7520; val_chrom_access_recon_loss: 445623.6250; val_global_loss: 1425963.7500; val_optim_loss: 1425963.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9385
val AUPRC score: 0.9294
val best accuracy score: 0.8562
val best F1 score: 0.8515
val target rna MSE score: 3.9411
val source rna MSE score: 3.1737
val target atac MSE score: 0.1372
val source atac MSE score: 0.0192
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
