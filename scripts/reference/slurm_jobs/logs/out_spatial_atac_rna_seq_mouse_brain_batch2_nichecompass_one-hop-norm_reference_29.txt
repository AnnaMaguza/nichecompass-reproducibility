[True]
Run timestamp: 09102023_203658_29.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_29']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7491; val_auprc_score: 0.7730; val_best_acc_score: 0.5267; val_best_f1_score: 0.6763; train_kl_reg_loss: 58629.9420; train_edge_recon_loss: 3500279.6546; train_gene_expr_recon_loss: 13475741.4122; train_masked_gp_l1_reg_loss: 48681.6886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3438271.4289; train_chrom_access_recon_loss: 2255520.4571; train_global_loss: 22777124.5038; train_optim_loss: 22777124.5038; val_kl_reg_loss: 75056.2750; val_edge_recon_loss: 4063237.8833; val_gene_expr_recon_loss: 12661993.2000; val_masked_gp_l1_reg_loss: 55529.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 550610.8750; val_chrom_access_recon_loss: 2177574.3750; val_global_loss: 19584001.6000; val_optim_loss: 19584001.6000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8487; val_auprc_score: 0.8496; val_best_acc_score: 0.7568; val_best_f1_score: 0.7762; train_kl_reg_loss: 70809.3384; train_edge_recon_loss: 3484127.3321; train_gene_expr_recon_loss: 12592767.4275; train_masked_gp_l1_reg_loss: 58082.3126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 289042.7105; train_chrom_access_recon_loss: 2168744.2939; train_global_loss: 18663573.4351; train_optim_loss: 18663573.4351; val_kl_reg_loss: 48961.1513; val_edge_recon_loss: 3576873.9500; val_gene_expr_recon_loss: 12509238.6667; val_masked_gp_l1_reg_loss: 61356.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173329.7500; val_chrom_access_recon_loss: 2164607.3583; val_global_loss: 18534367.2000; val_optim_loss: 18534367.2000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8724; val_auprc_score: 0.8663; val_best_acc_score: 0.7633; val_best_f1_score: 0.7948; train_kl_reg_loss: 85065.9223; train_edge_recon_loss: 3015401.4542; train_gene_expr_recon_loss: 12452484.4427; train_masked_gp_l1_reg_loss: 67753.4545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143624.0808; train_chrom_access_recon_loss: 2145883.9323; train_global_loss: 17910213.3359; train_optim_loss: 17910213.3359; val_kl_reg_loss: 96307.4031; val_edge_recon_loss: 2932822.0167; val_gene_expr_recon_loss: 12281741.9333; val_masked_gp_l1_reg_loss: 70769.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127447.0391; val_chrom_access_recon_loss: 2125266.2667; val_global_loss: 17634354.8000; val_optim_loss: 17634354.8000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8996; val_auprc_score: 0.8878; val_best_acc_score: 0.8154; val_best_f1_score: 0.8296; train_kl_reg_loss: 91465.8773; train_edge_recon_loss: 2904919.8760; train_gene_expr_recon_loss: 12294428.1450; train_masked_gp_l1_reg_loss: 72480.9962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117506.9688; train_chrom_access_recon_loss: 2122116.4370; train_global_loss: 17602918.3206; train_optim_loss: 17602918.3206; val_kl_reg_loss: 86786.7870; val_edge_recon_loss: 2867256.7667; val_gene_expr_recon_loss: 12177176.6667; val_masked_gp_l1_reg_loss: 74107.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109129.8203; val_chrom_access_recon_loss: 2110168.5000; val_global_loss: 17424626.7333; val_optim_loss: 17424626.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9135; val_auprc_score: 0.8970; val_best_acc_score: 0.8389; val_best_f1_score: 0.8500; train_kl_reg_loss: 88506.4419; train_edge_recon_loss: 2842781.5000; train_gene_expr_recon_loss: 12177384.6412; train_masked_gp_l1_reg_loss: 75491.5684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105373.0672; train_chrom_access_recon_loss: 2102946.7615; train_global_loss: 17392484.0382; train_optim_loss: 17392484.0382; val_kl_reg_loss: 88501.0708; val_edge_recon_loss: 2819746.7000; val_gene_expr_recon_loss: 12051576.3333; val_masked_gp_l1_reg_loss: 76982.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103890.8984; val_chrom_access_recon_loss: 2093929.3167; val_global_loss: 17234626.4000; val_optim_loss: 17234626.4000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9258; val_auprc_score: 0.9100; val_best_acc_score: 0.8535; val_best_f1_score: 0.8653; train_kl_reg_loss: 86561.3489; train_edge_recon_loss: 2801832.7424; train_gene_expr_recon_loss: 12060748.4504; train_masked_gp_l1_reg_loss: 78255.8729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102083.6905; train_chrom_access_recon_loss: 2084441.9380; train_global_loss: 17213924.0458; train_optim_loss: 17213924.0458; val_kl_reg_loss: 84641.6599; val_edge_recon_loss: 2817900.5167; val_gene_expr_recon_loss: 11931192.5333; val_masked_gp_l1_reg_loss: 79562.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100265.2891; val_chrom_access_recon_loss: 2077275.2750; val_global_loss: 17090836.8667; val_optim_loss: 17090836.8667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9333; val_auprc_score: 0.9197; val_best_acc_score: 0.8645; val_best_f1_score: 0.8745; train_kl_reg_loss: 86028.4230; train_edge_recon_loss: 2774298.1183; train_gene_expr_recon_loss: 11986806.3282; train_masked_gp_l1_reg_loss: 80608.6206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98038.6611; train_chrom_access_recon_loss: 2072728.7910; train_global_loss: 17098508.9389; train_optim_loss: 17098508.9389; val_kl_reg_loss: 82332.9234; val_edge_recon_loss: 2804013.3000; val_gene_expr_recon_loss: 11862561.4000; val_masked_gp_l1_reg_loss: 81756.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96558.7188; val_chrom_access_recon_loss: 2061227.7667; val_global_loss: 16988451.4000; val_optim_loss: 16988451.4000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9441; val_auprc_score: 0.9317; val_best_acc_score: 0.8773; val_best_f1_score: 0.8847; train_kl_reg_loss: 84536.8476; train_edge_recon_loss: 2752253.4008; train_gene_expr_recon_loss: 11913498.9466; train_masked_gp_l1_reg_loss: 82647.7338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94994.6137; train_chrom_access_recon_loss: 2057871.1250; train_global_loss: 16985802.6794; train_optim_loss: 16985802.6794; val_kl_reg_loss: 86268.5495; val_edge_recon_loss: 2758988.1667; val_gene_expr_recon_loss: 11812702.1333; val_masked_gp_l1_reg_loss: 83557.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94025.2969; val_chrom_access_recon_loss: 2047255.1167; val_global_loss: 16882795.8000; val_optim_loss: 16882795.8000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9414; val_auprc_score: 0.9237; val_best_acc_score: 0.8810; val_best_f1_score: 0.8863; train_kl_reg_loss: 83280.3739; train_edge_recon_loss: 2747631.7214; train_gene_expr_recon_loss: 11843270.2137; train_masked_gp_l1_reg_loss: 84035.2872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92721.1286; train_chrom_access_recon_loss: 2047099.6441; train_global_loss: 16898038.3588; train_optim_loss: 16898038.3588; val_kl_reg_loss: 81018.4385; val_edge_recon_loss: 2776858.0000; val_gene_expr_recon_loss: 11725954.6667; val_masked_gp_l1_reg_loss: 84929.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92608.6484; val_chrom_access_recon_loss: 2029388.1333; val_global_loss: 16790758.2667; val_optim_loss: 16790758.2667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9487; val_auprc_score: 0.9337; val_best_acc_score: 0.8872; val_best_f1_score: 0.8923; train_kl_reg_loss: 83092.9767; train_edge_recon_loss: 2735654.6794; train_gene_expr_recon_loss: 11784296.8702; train_masked_gp_l1_reg_loss: 85301.8892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91064.4578; train_chrom_access_recon_loss: 2033788.8445; train_global_loss: 16813199.6641; train_optim_loss: 16813199.6641; val_kl_reg_loss: 80767.5219; val_edge_recon_loss: 2744426.0000; val_gene_expr_recon_loss: 11699769.9333; val_masked_gp_l1_reg_loss: 85613.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89885.2422; val_chrom_access_recon_loss: 2024422.7583; val_global_loss: 16724885.0667; val_optim_loss: 16724885.0667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9524; val_auprc_score: 0.9397; val_best_acc_score: 0.8892; val_best_f1_score: 0.8959; train_kl_reg_loss: 81530.9900; train_edge_recon_loss: 2730905.4676; train_gene_expr_recon_loss: 11732070.1069; train_masked_gp_l1_reg_loss: 86143.2291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89780.5929; train_chrom_access_recon_loss: 2024876.1202; train_global_loss: 16745306.4427; train_optim_loss: 16745306.4427; val_kl_reg_loss: 81374.7896; val_edge_recon_loss: 2735121.2000; val_gene_expr_recon_loss: 11685530.1333; val_masked_gp_l1_reg_loss: 86625.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89549.0391; val_chrom_access_recon_loss: 2025337.0667; val_global_loss: 16703537.9333; val_optim_loss: 16703537.9333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9602; val_auprc_score: 0.9512; val_best_acc_score: 0.9029; val_best_f1_score: 0.9072; train_kl_reg_loss: 81293.2775; train_edge_recon_loss: 2719074.3034; train_gene_expr_recon_loss: 11701411.1069; train_masked_gp_l1_reg_loss: 86754.4442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89115.2896; train_chrom_access_recon_loss: 2018138.9046; train_global_loss: 16695787.3053; train_optim_loss: 16695787.3053; val_kl_reg_loss: 78795.3479; val_edge_recon_loss: 2714366.1667; val_gene_expr_recon_loss: 11604016.5333; val_masked_gp_l1_reg_loss: 87010.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88774.1641; val_chrom_access_recon_loss: 2007661.2667; val_global_loss: 16580623.2667; val_optim_loss: 16580623.2667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9561; val_auprc_score: 0.9441; val_best_acc_score: 0.8959; val_best_f1_score: 0.9014; train_kl_reg_loss: 79740.2635; train_edge_recon_loss: 2725867.5611; train_gene_expr_recon_loss: 11652541.8931; train_masked_gp_l1_reg_loss: 87160.8646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88189.0750; train_chrom_access_recon_loss: 2008107.5038; train_global_loss: 16641607.1679; train_optim_loss: 16641607.1679; val_kl_reg_loss: 79317.4385; val_edge_recon_loss: 2729992.4500; val_gene_expr_recon_loss: 11615191.6667; val_masked_gp_l1_reg_loss: 87555.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87748.5938; val_chrom_access_recon_loss: 2012293.0417; val_global_loss: 16612098.8000; val_optim_loss: 16612098.8000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9639; val_auprc_score: 0.9535; val_best_acc_score: 0.9099; val_best_f1_score: 0.9142; train_kl_reg_loss: 77758.6084; train_edge_recon_loss: 2714387.7424; train_gene_expr_recon_loss: 11618195.1069; train_masked_gp_l1_reg_loss: 87707.5142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87816.7254; train_chrom_access_recon_loss: 2000974.9218; train_global_loss: 16586840.5802; train_optim_loss: 16586840.5802; val_kl_reg_loss: 75204.6698; val_edge_recon_loss: 2723986.1333; val_gene_expr_recon_loss: 11541756.8667; val_masked_gp_l1_reg_loss: 87880.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88505.7188; val_chrom_access_recon_loss: 1998519.2250; val_global_loss: 16515853.7333; val_optim_loss: 16515853.7333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9610; val_auprc_score: 0.9473; val_best_acc_score: 0.9056; val_best_f1_score: 0.9108; train_kl_reg_loss: 76091.5603; train_edge_recon_loss: 2708441.6164; train_gene_expr_recon_loss: 11585359.5725; train_masked_gp_l1_reg_loss: 88157.2762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87991.4412; train_chrom_access_recon_loss: 1996050.5305; train_global_loss: 16542092.0000; train_optim_loss: 16542092.0000; val_kl_reg_loss: 74932.4078; val_edge_recon_loss: 2719888.3000; val_gene_expr_recon_loss: 11529503.6000; val_masked_gp_l1_reg_loss: 88256.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88993.7656; val_chrom_access_recon_loss: 1998681.1917; val_global_loss: 16500256.5333; val_optim_loss: 16500256.5333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9657; val_auprc_score: 0.9572; val_best_acc_score: 0.9144; val_best_f1_score: 0.9171; train_kl_reg_loss: 76542.3056; train_edge_recon_loss: 2702090.9237; train_gene_expr_recon_loss: 11554096.0916; train_masked_gp_l1_reg_loss: 88237.7514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88991.3959; train_chrom_access_recon_loss: 1988759.5906; train_global_loss: 16498717.9618; train_optim_loss: 16498717.9618; val_kl_reg_loss: 79001.9229; val_edge_recon_loss: 2703690.5833; val_gene_expr_recon_loss: 11483697.8000; val_masked_gp_l1_reg_loss: 88330.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90449.1250; val_chrom_access_recon_loss: 1983275.0667; val_global_loss: 16428445.4000; val_optim_loss: 16428445.4000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9678; val_auprc_score: 0.9575; val_best_acc_score: 0.9144; val_best_f1_score: 0.9178; train_kl_reg_loss: 76425.7260; train_edge_recon_loss: 2697879.2653; train_gene_expr_recon_loss: 11518320.7099; train_masked_gp_l1_reg_loss: 88275.3237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91326.3343; train_chrom_access_recon_loss: 1983793.4981; train_global_loss: 16456020.9237; train_optim_loss: 16456020.9237; val_kl_reg_loss: 77409.9906; val_edge_recon_loss: 2703203.9000; val_gene_expr_recon_loss: 11444673.2667; val_masked_gp_l1_reg_loss: 88206.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92548.6484; val_chrom_access_recon_loss: 1982208.2167; val_global_loss: 16388251.4000; val_optim_loss: 16388251.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9685; val_auprc_score: 0.9596; val_best_acc_score: 0.9198; val_best_f1_score: 0.9224; train_kl_reg_loss: 76882.5109; train_edge_recon_loss: 2696200.6679; train_gene_expr_recon_loss: 11479709.6031; train_masked_gp_l1_reg_loss: 88026.4393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92724.4758; train_chrom_access_recon_loss: 1976226.2662; train_global_loss: 16409769.9618; train_optim_loss: 16409769.9618; val_kl_reg_loss: 81641.0651; val_edge_recon_loss: 2695037.0667; val_gene_expr_recon_loss: 11387988.7333; val_masked_gp_l1_reg_loss: 88020.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93961.0234; val_chrom_access_recon_loss: 1970081.5500; val_global_loss: 16316730.3333; val_optim_loss: 16316730.3333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9716; val_auprc_score: 0.9639; val_best_acc_score: 0.9221; val_best_f1_score: 0.9247; train_kl_reg_loss: 75709.3864; train_edge_recon_loss: 2699647.2366; train_gene_expr_recon_loss: 11464940.3740; train_masked_gp_l1_reg_loss: 87786.4621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93236.1746; train_chrom_access_recon_loss: 1972513.3120; train_global_loss: 16393832.9618; train_optim_loss: 16393832.9618; val_kl_reg_loss: 78214.6250; val_edge_recon_loss: 2700825.8667; val_gene_expr_recon_loss: 11420744.6667; val_masked_gp_l1_reg_loss: 87804.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93923.1094; val_chrom_access_recon_loss: 1968276.2083; val_global_loss: 16349788.4667; val_optim_loss: 16349788.4667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9692; val_auprc_score: 0.9584; val_best_acc_score: 0.9244; val_best_f1_score: 0.9269; train_kl_reg_loss: 75769.3724; train_edge_recon_loss: 2694894.5515; train_gene_expr_recon_loss: 11431753.4427; train_masked_gp_l1_reg_loss: 87687.3727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93232.3393; train_chrom_access_recon_loss: 1966946.4790; train_global_loss: 16350283.5038; train_optim_loss: 16350283.5038; val_kl_reg_loss: 77109.5026; val_edge_recon_loss: 2697686.3167; val_gene_expr_recon_loss: 11394245.8667; val_masked_gp_l1_reg_loss: 87280.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92768.1406; val_chrom_access_recon_loss: 1963986.1917; val_global_loss: 16313076.9333; val_optim_loss: 16313076.9333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9706; val_auprc_score: 0.9617; val_best_acc_score: 0.9252; val_best_f1_score: 0.9274; train_kl_reg_loss: 74972.1743; train_edge_recon_loss: 2685995.0229; train_gene_expr_recon_loss: 11422086.3359; train_masked_gp_l1_reg_loss: 87367.6948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93046.8253; train_chrom_access_recon_loss: 1963026.9819; train_global_loss: 16326494.9924; train_optim_loss: 16326494.9924; val_kl_reg_loss: 75640.9214; val_edge_recon_loss: 2709178.7000; val_gene_expr_recon_loss: 11347838.8667; val_masked_gp_l1_reg_loss: 87174.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93294.5859; val_chrom_access_recon_loss: 1959066.3417; val_global_loss: 16272193.8000; val_optim_loss: 16272193.8000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9711; val_auprc_score: 0.9586; val_best_acc_score: 0.9267; val_best_f1_score: 0.9296; train_kl_reg_loss: 73771.6211; train_edge_recon_loss: 2686603.7443; train_gene_expr_recon_loss: 11395083.0305; train_masked_gp_l1_reg_loss: 87134.4357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93220.5738; train_chrom_access_recon_loss: 1957897.2004; train_global_loss: 16293710.5267; train_optim_loss: 16293710.5267; val_kl_reg_loss: 77210.0932; val_edge_recon_loss: 2687583.2167; val_gene_expr_recon_loss: 11355107.8000; val_masked_gp_l1_reg_loss: 87073.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93172.6953; val_chrom_access_recon_loss: 1957156.7083; val_global_loss: 16257303.8667; val_optim_loss: 16257303.8667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9748; val_auprc_score: 0.9677; val_best_acc_score: 0.9303; val_best_f1_score: 0.9327; train_kl_reg_loss: 73831.5484; train_edge_recon_loss: 2685768.1546; train_gene_expr_recon_loss: 11381831.4046; train_masked_gp_l1_reg_loss: 86851.3175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92982.0766; train_chrom_access_recon_loss: 1954947.2538; train_global_loss: 16276211.8092; train_optim_loss: 16276211.8092; val_kl_reg_loss: 76573.3906; val_edge_recon_loss: 2690325.2333; val_gene_expr_recon_loss: 11300044.3333; val_masked_gp_l1_reg_loss: 86912.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93234.2812; val_chrom_access_recon_loss: 1948928.8083; val_global_loss: 16196017.8667; val_optim_loss: 16196017.8667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9738; val_auprc_score: 0.9665; val_best_acc_score: 0.9248; val_best_f1_score: 0.9275; train_kl_reg_loss: 73895.9758; train_edge_recon_loss: 2686787.5553; train_gene_expr_recon_loss: 11359317.4122; train_masked_gp_l1_reg_loss: 86537.4679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93028.8570; train_chrom_access_recon_loss: 1951939.8721; train_global_loss: 16251507.1527; train_optim_loss: 16251507.1527; val_kl_reg_loss: 74989.6708; val_edge_recon_loss: 2721294.3667; val_gene_expr_recon_loss: 11297266.9333; val_masked_gp_l1_reg_loss: 86456.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93467.9922; val_chrom_access_recon_loss: 1953404.2667; val_global_loss: 16226879.4000; val_optim_loss: 16226879.4000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9721; val_auprc_score: 0.9636; val_best_acc_score: 0.9248; val_best_f1_score: 0.9272; train_kl_reg_loss: 74247.5107; train_edge_recon_loss: 2678667.4962; train_gene_expr_recon_loss: 11356335.0076; train_masked_gp_l1_reg_loss: 86338.7255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93129.3784; train_chrom_access_recon_loss: 1950496.6527; train_global_loss: 16239214.7786; train_optim_loss: 16239214.7786; val_kl_reg_loss: 75354.5672; val_edge_recon_loss: 2713690.1167; val_gene_expr_recon_loss: 11282019.9333; val_masked_gp_l1_reg_loss: 86382.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92608.8516; val_chrom_access_recon_loss: 1952872.9333; val_global_loss: 16202929.2667; val_optim_loss: 16202929.2667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9735; val_auprc_score: 0.9659; val_best_acc_score: 0.9294; val_best_f1_score: 0.9315; train_kl_reg_loss: 85522.0358; train_edge_recon_loss: 2736053.4408; train_gene_expr_recon_loss: 10343032.5802; train_masked_gp_l1_reg_loss: 86133.4416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90330.6226; train_chrom_access_recon_loss: 1774774.3435; train_global_loss: 15115846.4198; train_optim_loss: 15115846.4198; val_kl_reg_loss: 34965.4706; val_edge_recon_loss: 2702376.0667; val_gene_expr_recon_loss: 10245221.3333; val_masked_gp_l1_reg_loss: 85049.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90376.6016; val_chrom_access_recon_loss: 1758815.4167; val_global_loss: 14916804.4000; val_optim_loss: 14916804.4000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9727; val_auprc_score: 0.9626; val_best_acc_score: 0.9297; val_best_f1_score: 0.9316; train_kl_reg_loss: 69595.4534; train_edge_recon_loss: 2699536.6107; train_gene_expr_recon_loss: 10307584.7710; train_masked_gp_l1_reg_loss: 83522.7304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90623.7418; train_chrom_access_recon_loss: 1763288.7586; train_global_loss: 15014151.9542; train_optim_loss: 15014151.9542; val_kl_reg_loss: 40216.3133; val_edge_recon_loss: 2698468.8500; val_gene_expr_recon_loss: 10271855.4000; val_masked_gp_l1_reg_loss: 82051.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91055.1719; val_chrom_access_recon_loss: 1757054.2667; val_global_loss: 14940701.9333; val_optim_loss: 14940701.9333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9717; val_auprc_score: 0.9643; val_best_acc_score: 0.9256; val_best_f1_score: 0.9278; train_kl_reg_loss: 62214.3508; train_edge_recon_loss: 2693589.8740; train_gene_expr_recon_loss: 10296968.9466; train_masked_gp_l1_reg_loss: 80316.1483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91146.0592; train_chrom_access_recon_loss: 1761002.8950; train_global_loss: 14985238.2595; train_optim_loss: 14985238.2595; val_kl_reg_loss: 44373.2156; val_edge_recon_loss: 2701732.7833; val_gene_expr_recon_loss: 10204793.6667; val_masked_gp_l1_reg_loss: 78685.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90745.6250; val_chrom_access_recon_loss: 1755428.1333; val_global_loss: 14875759.8667; val_optim_loss: 14875759.8667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9733; val_auprc_score: 0.9644; val_best_acc_score: 0.9245; val_best_f1_score: 0.9270; train_kl_reg_loss: 59825.8478; train_edge_recon_loss: 2679056.9160; train_gene_expr_recon_loss: 10277419.6565; train_masked_gp_l1_reg_loss: 77091.4311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90665.9729; train_chrom_access_recon_loss: 1757070.0782; train_global_loss: 14941129.8550; train_optim_loss: 14941129.8550; val_kl_reg_loss: 49644.7971; val_edge_recon_loss: 2691438.3833; val_gene_expr_recon_loss: 10145683.5333; val_masked_gp_l1_reg_loss: 75857.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90516.6328; val_chrom_access_recon_loss: 1745058.4833; val_global_loss: 14798200.2667; val_optim_loss: 14798200.2667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9768; val_auprc_score: 0.9695; val_best_acc_score: 0.9307; val_best_f1_score: 0.9337; train_kl_reg_loss: 59090.4705; train_edge_recon_loss: 2681803.9981; train_gene_expr_recon_loss: 10261066.4122; train_masked_gp_l1_reg_loss: 74625.6189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90413.6500; train_chrom_access_recon_loss: 1753538.7223; train_global_loss: 14920538.7863; train_optim_loss: 14920538.7863; val_kl_reg_loss: 50092.2021; val_edge_recon_loss: 2665079.5000; val_gene_expr_recon_loss: 10214199.2667; val_masked_gp_l1_reg_loss: 73620.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90104.2344; val_chrom_access_recon_loss: 1750837.5000; val_global_loss: 14843932.6667; val_optim_loss: 14843932.6667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9755; val_auprc_score: 0.9674; val_best_acc_score: 0.9318; val_best_f1_score: 0.9341; train_kl_reg_loss: 57810.3776; train_edge_recon_loss: 2676125.3416; train_gene_expr_recon_loss: 10247291.0305; train_masked_gp_l1_reg_loss: 72848.3358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90077.7075; train_chrom_access_recon_loss: 1750283.5763; train_global_loss: 14894436.3511; train_optim_loss: 14894436.3511; val_kl_reg_loss: 53432.9164; val_edge_recon_loss: 2688067.8167; val_gene_expr_recon_loss: 10231230.0000; val_masked_gp_l1_reg_loss: 72078.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89650.0859; val_chrom_access_recon_loss: 1749333.9333; val_global_loss: 14883793.6667; val_optim_loss: 14883793.6667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9768; val_auprc_score: 0.9698; val_best_acc_score: 0.9348; val_best_f1_score: 0.9367; train_kl_reg_loss: 57675.6342; train_edge_recon_loss: 2670853.3168; train_gene_expr_recon_loss: 10220092.6718; train_masked_gp_l1_reg_loss: 71537.9327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89700.9820; train_chrom_access_recon_loss: 1743430.4866; train_global_loss: 14853290.9695; train_optim_loss: 14853290.9695; val_kl_reg_loss: 51943.5794; val_edge_recon_loss: 2677505.3833; val_gene_expr_recon_loss: 10181484.8000; val_masked_gp_l1_reg_loss: 70878.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89504.9453; val_chrom_access_recon_loss: 1743330.1417; val_global_loss: 14814646.9333; val_optim_loss: 14814646.9333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9769; val_auprc_score: 0.9674; val_best_acc_score: 0.9334; val_best_f1_score: 0.9358; train_kl_reg_loss: 56742.3993; train_edge_recon_loss: 2672614.9447; train_gene_expr_recon_loss: 10218369.0000; train_masked_gp_l1_reg_loss: 70343.4721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89456.1122; train_chrom_access_recon_loss: 1745159.0782; train_global_loss: 14852685.0534; train_optim_loss: 14852685.0534; val_kl_reg_loss: 51900.6294; val_edge_recon_loss: 2665013.4167; val_gene_expr_recon_loss: 10166692.9333; val_masked_gp_l1_reg_loss: 69872.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89316.8828; val_chrom_access_recon_loss: 1742855.7083; val_global_loss: 14785652.8667; val_optim_loss: 14785652.8667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9757; val_auprc_score: 0.9649; val_best_acc_score: 0.9318; val_best_f1_score: 0.9344; train_kl_reg_loss: 56079.9543; train_edge_recon_loss: 2678123.3244; train_gene_expr_recon_loss: 10215798.8092; train_masked_gp_l1_reg_loss: 69449.0013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89189.0540; train_chrom_access_recon_loss: 1745351.7939; train_global_loss: 14853991.9542; train_optim_loss: 14853991.9542; val_kl_reg_loss: 53923.3526; val_edge_recon_loss: 2666567.4167; val_gene_expr_recon_loss: 10127510.6667; val_masked_gp_l1_reg_loss: 69098.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89139.6016; val_chrom_access_recon_loss: 1738941.8167; val_global_loss: 14745182.2000; val_optim_loss: 14745182.2000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9777; val_auprc_score: 0.9711; val_best_acc_score: 0.9347; val_best_f1_score: 0.9361; train_kl_reg_loss: 56636.5873; train_edge_recon_loss: 2667897.5286; train_gene_expr_recon_loss: 10207676.4427; train_masked_gp_l1_reg_loss: 68692.3303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88997.8609; train_chrom_access_recon_loss: 1742721.8683; train_global_loss: 14832622.6183; train_optim_loss: 14832622.6183; val_kl_reg_loss: 55150.4909; val_edge_recon_loss: 2673790.6667; val_gene_expr_recon_loss: 10196910.2667; val_masked_gp_l1_reg_loss: 68502.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89181.2344; val_chrom_access_recon_loss: 1750531.0333; val_global_loss: 14834066.4667; val_optim_loss: 14834066.4667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9729; val_auprc_score: 0.9616; val_best_acc_score: 0.9294; val_best_f1_score: 0.9312; train_kl_reg_loss: 57111.0366; train_edge_recon_loss: 2677625.6107; train_gene_expr_recon_loss: 10200260.8855; train_masked_gp_l1_reg_loss: 68130.8895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88706.3305; train_chrom_access_recon_loss: 1740548.9924; train_global_loss: 14832383.8244; train_optim_loss: 14832383.8244; val_kl_reg_loss: 52743.7151; val_edge_recon_loss: 2696412.1500; val_gene_expr_recon_loss: 10182815.2000; val_masked_gp_l1_reg_loss: 67841.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88824.4297; val_chrom_access_recon_loss: 1750561.0417; val_global_loss: 14839197.1333; val_optim_loss: 14839197.1333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9789; val_auprc_score: 0.9730; val_best_acc_score: 0.9352; val_best_f1_score: 0.9371; train_kl_reg_loss: 57213.5810; train_edge_recon_loss: 2667851.7424; train_gene_expr_recon_loss: 10198604.0000; train_masked_gp_l1_reg_loss: 67605.8959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88654.2583; train_chrom_access_recon_loss: 1740527.8445; train_global_loss: 14820457.3282; train_optim_loss: 14820457.3282; val_kl_reg_loss: 55026.5826; val_edge_recon_loss: 2668614.6167; val_gene_expr_recon_loss: 10167350.3333; val_masked_gp_l1_reg_loss: 67605.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88914.3594; val_chrom_access_recon_loss: 1744516.5250; val_global_loss: 14792028.0667; val_optim_loss: 14792028.0667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9746; val_auprc_score: 0.9634; val_best_acc_score: 0.9320; val_best_f1_score: 0.9346; train_kl_reg_loss: 56317.0914; train_edge_recon_loss: 2670393.0649; train_gene_expr_recon_loss: 10184933.8244; train_masked_gp_l1_reg_loss: 67317.7620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88728.0150; train_chrom_access_recon_loss: 1739600.1422; train_global_loss: 14807289.9160; train_optim_loss: 14807289.9160; val_kl_reg_loss: 50530.2240; val_edge_recon_loss: 2684040.4333; val_gene_expr_recon_loss: 10113082.0667; val_masked_gp_l1_reg_loss: 67071.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88062.3359; val_chrom_access_recon_loss: 1735320.3833; val_global_loss: 14738107.2667; val_optim_loss: 14738107.2667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9790; val_auprc_score: 0.9725; val_best_acc_score: 0.9375; val_best_f1_score: 0.9397; train_kl_reg_loss: 54972.5654; train_edge_recon_loss: 2669152.7347; train_gene_expr_recon_loss: 10177386.0916; train_masked_gp_l1_reg_loss: 66985.3242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88753.1238; train_chrom_access_recon_loss: 1738542.9819; train_global_loss: 14795792.8550; train_optim_loss: 14795792.8550; val_kl_reg_loss: 53875.9526; val_edge_recon_loss: 2666366.1500; val_gene_expr_recon_loss: 10131987.4000; val_masked_gp_l1_reg_loss: 66846.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88594.1641; val_chrom_access_recon_loss: 1738652.5583; val_global_loss: 14746322.8000; val_optim_loss: 14746322.8000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9784; val_auprc_score: 0.9720; val_best_acc_score: 0.9359; val_best_f1_score: 0.9380; train_kl_reg_loss: 56736.7125; train_edge_recon_loss: 2662257.3569; train_gene_expr_recon_loss: 10164358.2901; train_masked_gp_l1_reg_loss: 66673.8743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88642.4252; train_chrom_access_recon_loss: 1737116.6279; train_global_loss: 14775785.2977; train_optim_loss: 14775785.2977; val_kl_reg_loss: 54015.0987; val_edge_recon_loss: 2676213.8667; val_gene_expr_recon_loss: 10143498.6000; val_masked_gp_l1_reg_loss: 66489.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89020.0156; val_chrom_access_recon_loss: 1737162.6083; val_global_loss: 14766399.1333; val_optim_loss: 14766399.1333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9756; val_auprc_score: 0.9653; val_best_acc_score: 0.9307; val_best_f1_score: 0.9332; train_kl_reg_loss: 55377.6500; train_edge_recon_loss: 2671679.8244; train_gene_expr_recon_loss: 10171417.3969; train_masked_gp_l1_reg_loss: 66271.4722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88692.5966; train_chrom_access_recon_loss: 1738032.6756; train_global_loss: 14791471.6183; train_optim_loss: 14791471.6183; val_kl_reg_loss: 55016.7151; val_edge_recon_loss: 2694778.2167; val_gene_expr_recon_loss: 10100942.7333; val_masked_gp_l1_reg_loss: 66184.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88594.6797; val_chrom_access_recon_loss: 1731799.8083; val_global_loss: 14737317.5333; val_optim_loss: 14737317.5333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9767; val_auprc_score: 0.9674; val_best_acc_score: 0.9368; val_best_f1_score: 0.9387; train_kl_reg_loss: 55151.7755; train_edge_recon_loss: 2673346.3263; train_gene_expr_recon_loss: 10161125.6183; train_masked_gp_l1_reg_loss: 66026.2300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88683.4605; train_chrom_access_recon_loss: 1736948.8731; train_global_loss: 14781282.2595; train_optim_loss: 14781282.2595; val_kl_reg_loss: 51318.6760; val_edge_recon_loss: 2664990.1333; val_gene_expr_recon_loss: 10100983.7333; val_masked_gp_l1_reg_loss: 65911.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88805.7266; val_chrom_access_recon_loss: 1740150.2250; val_global_loss: 14712159.6000; val_optim_loss: 14712159.6000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9803; val_auprc_score: 0.9738; val_best_acc_score: 0.9400; val_best_f1_score: 0.9412; train_kl_reg_loss: 54939.4782; train_edge_recon_loss: 2664469.7309; train_gene_expr_recon_loss: 10155907.6794; train_masked_gp_l1_reg_loss: 65783.5600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88612.7019; train_chrom_access_recon_loss: 1734491.7710; train_global_loss: 14764204.9466; train_optim_loss: 14764204.9466; val_kl_reg_loss: 54242.5888; val_edge_recon_loss: 2660941.4667; val_gene_expr_recon_loss: 10115613.0667; val_masked_gp_l1_reg_loss: 65721.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88516.2812; val_chrom_access_recon_loss: 1733754.1417; val_global_loss: 14718789.4000; val_optim_loss: 14718789.4000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9754; val_auprc_score: 0.9668; val_best_acc_score: 0.9320; val_best_f1_score: 0.9341; train_kl_reg_loss: 56073.7343; train_edge_recon_loss: 2661410.3492; train_gene_expr_recon_loss: 10161717.3969; train_masked_gp_l1_reg_loss: 65607.7309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88767.5524; train_chrom_access_recon_loss: 1735851.9141; train_global_loss: 14769428.7176; train_optim_loss: 14769428.7176; val_kl_reg_loss: 53702.2682; val_edge_recon_loss: 2698438.5167; val_gene_expr_recon_loss: 10096403.7333; val_masked_gp_l1_reg_loss: 65341.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88544.2344; val_chrom_access_recon_loss: 1732317.1417; val_global_loss: 14734747.6000; val_optim_loss: 14734747.6000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9780; val_auprc_score: 0.9708; val_best_acc_score: 0.9351; val_best_f1_score: 0.9364; train_kl_reg_loss: 55796.0845; train_edge_recon_loss: 2658609.9351; train_gene_expr_recon_loss: 10146461.3511; train_masked_gp_l1_reg_loss: 65173.1840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88673.2628; train_chrom_access_recon_loss: 1733799.9265; train_global_loss: 14748513.7786; train_optim_loss: 14748513.7786; val_kl_reg_loss: 56902.1602; val_edge_recon_loss: 2679964.8833; val_gene_expr_recon_loss: 10083968.4667; val_masked_gp_l1_reg_loss: 65046.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88772.7734; val_chrom_access_recon_loss: 1735016.6250; val_global_loss: 14709671.8000; val_optim_loss: 14709671.8000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9808; val_auprc_score: 0.9727; val_best_acc_score: 0.9400; val_best_f1_score: 0.9416; train_kl_reg_loss: 56274.3388; train_edge_recon_loss: 2659987.6279; train_gene_expr_recon_loss: 10129539.1527; train_masked_gp_l1_reg_loss: 64872.1158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88455.1363; train_chrom_access_recon_loss: 1730809.4656; train_global_loss: 14729937.7939; train_optim_loss: 14729937.7939; val_kl_reg_loss: 52813.9190; val_edge_recon_loss: 2664474.9500; val_gene_expr_recon_loss: 10078549.0667; val_masked_gp_l1_reg_loss: 64775.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88262.0703; val_chrom_access_recon_loss: 1728991.2500; val_global_loss: 14677866.4000; val_optim_loss: 14677866.4000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9767; val_auprc_score: 0.9701; val_best_acc_score: 0.9318; val_best_f1_score: 0.9348; train_kl_reg_loss: 54862.2185; train_edge_recon_loss: 2664271.1431; train_gene_expr_recon_loss: 10138885.4122; train_masked_gp_l1_reg_loss: 64664.2354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88654.1259; train_chrom_access_recon_loss: 1732645.8865; train_global_loss: 14743982.9924; train_optim_loss: 14743982.9924; val_kl_reg_loss: 55769.2242; val_edge_recon_loss: 2683871.8500; val_gene_expr_recon_loss: 10103328.6000; val_masked_gp_l1_reg_loss: 64598.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88310.2891; val_chrom_access_recon_loss: 1733035.4083; val_global_loss: 14728912.9333; val_optim_loss: 14728912.9333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9780; val_auprc_score: 0.9714; val_best_acc_score: 0.9348; val_best_f1_score: 0.9375; train_kl_reg_loss: 55331.9142; train_edge_recon_loss: 2664091.5267; train_gene_expr_recon_loss: 10130073.7099; train_masked_gp_l1_reg_loss: 64348.4861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88713.8427; train_chrom_access_recon_loss: 1730172.0992; train_global_loss: 14732731.5878; train_optim_loss: 14732731.5878; val_kl_reg_loss: 53382.8526; val_edge_recon_loss: 2681802.1667; val_gene_expr_recon_loss: 10091845.8667; val_masked_gp_l1_reg_loss: 64142.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88998.8594; val_chrom_access_recon_loss: 1732670.7750; val_global_loss: 14712842.6667; val_optim_loss: 14712842.6667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9789; val_auprc_score: 0.9725; val_best_acc_score: 0.9402; val_best_f1_score: 0.9415; train_kl_reg_loss: 54447.3504; train_edge_recon_loss: 2656459.6126; train_gene_expr_recon_loss: 10124560.2214; train_masked_gp_l1_reg_loss: 64031.3810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88734.3972; train_chrom_access_recon_loss: 1729624.4685; train_global_loss: 14717857.4962; train_optim_loss: 14717857.4962; val_kl_reg_loss: 51680.8648; val_edge_recon_loss: 2668913.8167; val_gene_expr_recon_loss: 10013136.2667; val_masked_gp_l1_reg_loss: 64157.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88669.3672; val_chrom_access_recon_loss: 1718757.4083; val_global_loss: 14605314.4000; val_optim_loss: 14605314.4000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9785; val_auprc_score: 0.9705; val_best_acc_score: 0.9410; val_best_f1_score: 0.9421; train_kl_reg_loss: 54492.1419; train_edge_recon_loss: 2662985.6832; train_gene_expr_recon_loss: 10131701.4198; train_masked_gp_l1_reg_loss: 64023.4493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88955.3429; train_chrom_access_recon_loss: 1732140.9246; train_global_loss: 14734298.9084; train_optim_loss: 14734298.9084; val_kl_reg_loss: 51452.6664; val_edge_recon_loss: 2673300.0833; val_gene_expr_recon_loss: 10031553.4000; val_masked_gp_l1_reg_loss: 63976.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88918.5000; val_chrom_access_recon_loss: 1719990.3167; val_global_loss: 14629192.2000; val_optim_loss: 14629192.2000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9787; val_auprc_score: 0.9699; val_best_acc_score: 0.9411; val_best_f1_score: 0.9427; train_kl_reg_loss: 54904.8793; train_edge_recon_loss: 2665459.8702; train_gene_expr_recon_loss: 10109868.8473; train_masked_gp_l1_reg_loss: 63792.3008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88973.1372; train_chrom_access_recon_loss: 1728082.7739; train_global_loss: 14711081.8092; train_optim_loss: 14711081.8092; val_kl_reg_loss: 53762.0862; val_edge_recon_loss: 2661656.4000; val_gene_expr_recon_loss: 10096694.8000; val_masked_gp_l1_reg_loss: 63545.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89166.5703; val_chrom_access_recon_loss: 1727957.1667; val_global_loss: 14692782.3333; val_optim_loss: 14692782.3333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9822; val_auprc_score: 0.9765; val_best_acc_score: 0.9415; val_best_f1_score: 0.9430; train_kl_reg_loss: 54397.5934; train_edge_recon_loss: 2660704.6813; train_gene_expr_recon_loss: 10111098.3664; train_masked_gp_l1_reg_loss: 63510.8681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88855.1969; train_chrom_access_recon_loss: 1728890.8235; train_global_loss: 14707457.4809; train_optim_loss: 14707457.4809; val_kl_reg_loss: 51694.1669; val_edge_recon_loss: 2667084.0667; val_gene_expr_recon_loss: 10068239.4667; val_masked_gp_l1_reg_loss: 63483.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88601.3984; val_chrom_access_recon_loss: 1721301.2500; val_global_loss: 14660404.0667; val_optim_loss: 14660404.0667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9815; val_auprc_score: 0.9740; val_best_acc_score: 0.9404; val_best_f1_score: 0.9422; train_kl_reg_loss: 54579.9532; train_edge_recon_loss: 2663145.0859; train_gene_expr_recon_loss: 10113167.7023; train_masked_gp_l1_reg_loss: 63546.4706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88851.1390; train_chrom_access_recon_loss: 1728556.4523; train_global_loss: 14711846.7710; train_optim_loss: 14711846.7710; val_kl_reg_loss: 53771.9448; val_edge_recon_loss: 2674788.0333; val_gene_expr_recon_loss: 10093279.7333; val_masked_gp_l1_reg_loss: 63474.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88702.0938; val_chrom_access_recon_loss: 1730754.1167; val_global_loss: 14704770.8667; val_optim_loss: 14704770.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9804; val_auprc_score: 0.9748; val_best_acc_score: 0.9396; val_best_f1_score: 0.9416; train_kl_reg_loss: 55650.1642; train_edge_recon_loss: 2657127.1469; train_gene_expr_recon_loss: 10091757.5038; train_masked_gp_l1_reg_loss: 62642.4840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71315.3498; train_chrom_access_recon_loss: 1726313.6489; train_global_loss: 14664806.2824; train_optim_loss: 14664806.2824; val_kl_reg_loss: 54131.2977; val_edge_recon_loss: 2658459.8333; val_gene_expr_recon_loss: 10058468.9333; val_masked_gp_l1_reg_loss: 62394.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68937.2891; val_chrom_access_recon_loss: 1727267.7000; val_global_loss: 14629659.6667; val_optim_loss: 14629659.6667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9813; val_auprc_score: 0.9737; val_best_acc_score: 0.9449; val_best_f1_score: 0.9463; train_kl_reg_loss: 56500.6822; train_edge_recon_loss: 2664214.9313; train_gene_expr_recon_loss: 10102638.5038; train_masked_gp_l1_reg_loss: 62341.6870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68385.1004; train_chrom_access_recon_loss: 1727379.4437; train_global_loss: 14681460.3053; train_optim_loss: 14681460.3053; val_kl_reg_loss: 54887.3555; val_edge_recon_loss: 2672872.3667; val_gene_expr_recon_loss: 10033195.5333; val_masked_gp_l1_reg_loss: 62307.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67953.1250; val_chrom_access_recon_loss: 1720461.0167; val_global_loss: 14611677.2000; val_optim_loss: 14611677.2000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9818; val_auprc_score: 0.9743; val_best_acc_score: 0.9454; val_best_f1_score: 0.9466; train_kl_reg_loss: 56937.5365; train_edge_recon_loss: 2659165.2023; train_gene_expr_recon_loss: 10095760.3130; train_masked_gp_l1_reg_loss: 62274.1451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67618.1715; train_chrom_access_recon_loss: 1727152.5735; train_global_loss: 14668907.9389; train_optim_loss: 14668907.9389; val_kl_reg_loss: 55841.0732; val_edge_recon_loss: 2652047.0667; val_gene_expr_recon_loss: 9996366.0000; val_masked_gp_l1_reg_loss: 62256.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67394.9297; val_chrom_access_recon_loss: 1719809.4500; val_global_loss: 14553715.4667; val_optim_loss: 14553715.4667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9823; val_auprc_score: 0.9762; val_best_acc_score: 0.9437; val_best_f1_score: 0.9456; train_kl_reg_loss: 57358.0129; train_edge_recon_loss: 2656930.4275; train_gene_expr_recon_loss: 10082531.4733; train_masked_gp_l1_reg_loss: 62222.9308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67118.1723; train_chrom_access_recon_loss: 1725939.7452; train_global_loss: 14652100.7481; train_optim_loss: 14652100.7481; val_kl_reg_loss: 55554.4169; val_edge_recon_loss: 2667014.4167; val_gene_expr_recon_loss: 10030434.4667; val_masked_gp_l1_reg_loss: 62189.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66825.8828; val_chrom_access_recon_loss: 1720868.7750; val_global_loss: 14602887.9333; val_optim_loss: 14602887.9333
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9789; val_auprc_score: 0.9707; val_best_acc_score: 0.9422; val_best_f1_score: 0.9441; train_kl_reg_loss: 57198.7496; train_edge_recon_loss: 2654578.6718; train_gene_expr_recon_loss: 10093354.5496; train_masked_gp_l1_reg_loss: 62164.4493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66647.8643; train_chrom_access_recon_loss: 1724869.8597; train_global_loss: 14658814.1450; train_optim_loss: 14658814.1450; val_kl_reg_loss: 55057.8268; val_edge_recon_loss: 2666267.3500; val_gene_expr_recon_loss: 10046203.8667; val_masked_gp_l1_reg_loss: 62141.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66435.4062; val_chrom_access_recon_loss: 1724028.8917; val_global_loss: 14620134.9333; val_optim_loss: 14620134.9333
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9799; val_auprc_score: 0.9696; val_best_acc_score: 0.9434; val_best_f1_score: 0.9450; train_kl_reg_loss: 57320.5464; train_edge_recon_loss: 2652822.7958; train_gene_expr_recon_loss: 10088888.4580; train_masked_gp_l1_reg_loss: 62113.1308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66237.8507; train_chrom_access_recon_loss: 1726271.0029; train_global_loss: 14653653.7710; train_optim_loss: 14653653.7710; val_kl_reg_loss: 55839.3953; val_edge_recon_loss: 2664245.3500; val_gene_expr_recon_loss: 10040500.2667; val_masked_gp_l1_reg_loss: 62102.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65978.5156; val_chrom_access_recon_loss: 1722020.1917; val_global_loss: 14610686.2000; val_optim_loss: 14610686.2000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9830; val_auprc_score: 0.9778; val_best_acc_score: 0.9442; val_best_f1_score: 0.9458; train_kl_reg_loss: 57960.4879; train_edge_recon_loss: 2652004.1508; train_gene_expr_recon_loss: 10079768.3130; train_masked_gp_l1_reg_loss: 62078.6531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65800.4618; train_chrom_access_recon_loss: 1725207.3139; train_global_loss: 14642819.4046; train_optim_loss: 14642819.4046; val_kl_reg_loss: 57088.5083; val_edge_recon_loss: 2661538.6333; val_gene_expr_recon_loss: 10028059.4667; val_masked_gp_l1_reg_loss: 62050.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65614.1641; val_chrom_access_recon_loss: 1724651.4750; val_global_loss: 14599002.9333; val_optim_loss: 14599002.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9826; val_auprc_score: 0.9762; val_best_acc_score: 0.9440; val_best_f1_score: 0.9453; train_kl_reg_loss: 58422.6562; train_edge_recon_loss: 2649975.0248; train_gene_expr_recon_loss: 10088045.9008; train_masked_gp_l1_reg_loss: 61969.3767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63786.4888; train_chrom_access_recon_loss: 1726159.2958; train_global_loss: 14648358.6794; train_optim_loss: 14648358.6794; val_kl_reg_loss: 57033.9216; val_edge_recon_loss: 2672181.0833; val_gene_expr_recon_loss: 10061198.4000; val_masked_gp_l1_reg_loss: 61941.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63548.0664; val_chrom_access_recon_loss: 1728439.1667; val_global_loss: 14644341.5333; val_optim_loss: 14644341.5333
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9800; val_auprc_score: 0.9738; val_best_acc_score: 0.9438; val_best_f1_score: 0.9457; train_kl_reg_loss: 58300.7950; train_edge_recon_loss: 2648303.2996; train_gene_expr_recon_loss: 10081605.7939; train_masked_gp_l1_reg_loss: 61928.8268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63478.8704; train_chrom_access_recon_loss: 1724859.2538; train_global_loss: 14638476.9313; train_optim_loss: 14638476.9313; val_kl_reg_loss: 56804.5451; val_edge_recon_loss: 2646902.9333; val_gene_expr_recon_loss: 10013254.5333; val_masked_gp_l1_reg_loss: 61921.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63426.5352; val_chrom_access_recon_loss: 1717042.7417; val_global_loss: 14559353.8667; val_optim_loss: 14559353.8667
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9817; val_auprc_score: 0.9741; val_best_acc_score: 0.9434; val_best_f1_score: 0.9446; train_kl_reg_loss: 58286.0326; train_edge_recon_loss: 2652269.1069; train_gene_expr_recon_loss: 10089437.6260; train_masked_gp_l1_reg_loss: 61917.0734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63379.1219; train_chrom_access_recon_loss: 1726338.4828; train_global_loss: 14651627.4427; train_optim_loss: 14651627.4427; val_kl_reg_loss: 56588.3250; val_edge_recon_loss: 2660302.2000; val_gene_expr_recon_loss: 10008102.4000; val_masked_gp_l1_reg_loss: 61910.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63339.2539; val_chrom_access_recon_loss: 1720041.9667; val_global_loss: 14570284.8667; val_optim_loss: 14570284.8667
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9793; val_auprc_score: 0.9704; val_best_acc_score: 0.9379; val_best_f1_score: 0.9397; train_kl_reg_loss: 58312.1690; train_edge_recon_loss: 2656419.4866; train_gene_expr_recon_loss: 10092720.3206; train_masked_gp_l1_reg_loss: 61906.2039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63304.4631; train_chrom_access_recon_loss: 1726198.7872; train_global_loss: 14658861.4504; train_optim_loss: 14658861.4504; val_kl_reg_loss: 56791.9789; val_edge_recon_loss: 2679781.8167; val_gene_expr_recon_loss: 10040243.6000; val_masked_gp_l1_reg_loss: 61901.7461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63267.5234; val_chrom_access_recon_loss: 1728214.2417; val_global_loss: 14630201.7333; val_optim_loss: 14630201.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 55 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.9798
val AUPRC score: 0.9725
val best accuracy score: 0.9392
val best F1 score: 0.9409
val target rna MSE score: 1.6263
val source rna MSE score: 0.4774
val target atac MSE score: 0.3377
val source atac MSE score: 0.1044
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
