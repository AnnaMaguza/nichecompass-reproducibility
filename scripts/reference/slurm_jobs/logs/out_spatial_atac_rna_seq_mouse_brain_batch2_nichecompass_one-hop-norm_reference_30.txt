[True]
Run timestamp: 26072023_013330_30.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_30']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8990; val_auprc_score: 0.9065; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 20441.5301; train_edge_recon_loss: 352742.7812; train_gene_expr_recon_loss: 3131469.4722; train_masked_gp_l1_reg_loss: 1893.8465; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10808926.2222; train_global_loss: 14315474.0000; train_optim_loss: 14315474.0000; val_kl_reg_loss: 35403.9688; val_edge_recon_loss: 406580.0000; val_gene_expr_recon_loss: 2991348.2500; val_masked_gp_l1_reg_loss: 1948.3799; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10632543.0000; val_global_loss: 14067824.0000; val_optim_loss: 14067824.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8836; val_auprc_score: 0.8853; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 31488.0128; train_edge_recon_loss: 371310.2396; train_gene_expr_recon_loss: 2860015.1389; train_masked_gp_l1_reg_loss: 2043.0791; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10597945.8889; train_global_loss: 13862802.2222; train_optim_loss: 13862802.2222; val_kl_reg_loss: 39633.1914; val_edge_recon_loss: 406593.1250; val_gene_expr_recon_loss: 2689629.0000; val_masked_gp_l1_reg_loss: 2172.7747; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10349972.0000; val_global_loss: 13488000.0000; val_optim_loss: 13488000.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8778; val_auprc_score: 0.8804; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 51289.4957; train_edge_recon_loss: 387368.5312; train_gene_expr_recon_loss: 2567316.2500; train_masked_gp_l1_reg_loss: 2273.3882; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10262111.7778; train_global_loss: 13270359.5556; train_optim_loss: 13270359.5556; val_kl_reg_loss: 66571.7812; val_edge_recon_loss: 406593.1562; val_gene_expr_recon_loss: 2466437.5000; val_masked_gp_l1_reg_loss: 2382.4014; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10132846.0000; val_global_loss: 13074831.0000; val_optim_loss: 13074831.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8994; val_auprc_score: 0.8953; val_best_acc_score: 0.5012; val_best_f1_score: 0.6672; train_kl_reg_loss: 72695.6146; train_edge_recon_loss: 396633.9826; train_gene_expr_recon_loss: 2406236.8611; train_masked_gp_l1_reg_loss: 2430.1484; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10093644.6667; train_global_loss: 12971641.2222; train_optim_loss: 12971641.2222; val_kl_reg_loss: 71295.2969; val_edge_recon_loss: 406564.4375; val_gene_expr_recon_loss: 2347630.0000; val_masked_gp_l1_reg_loss: 2469.3430; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9990987.0000; val_global_loss: 12818946.0000; val_optim_loss: 12818946.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8916; val_auprc_score: 0.8798; val_best_acc_score: 0.5046; val_best_f1_score: 0.6686; train_kl_reg_loss: 78569.8906; train_edge_recon_loss: 396286.3438; train_gene_expr_recon_loss: 2317495.8611; train_masked_gp_l1_reg_loss: 2478.7967; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9990208.5556; train_global_loss: 12785039.3333; train_optim_loss: 12785039.3333; val_kl_reg_loss: 80599.6562; val_edge_recon_loss: 406509.3750; val_gene_expr_recon_loss: 2271509.0000; val_masked_gp_l1_reg_loss: 2480.3481; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9894592.0000; val_global_loss: 12655690.0000; val_optim_loss: 12655690.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8881; val_auprc_score: 0.8782; val_best_acc_score: 0.5166; val_best_f1_score: 0.6739; train_kl_reg_loss: 84668.6840; train_edge_recon_loss: 398315.1771; train_gene_expr_recon_loss: 2237391.6944; train_masked_gp_l1_reg_loss: 2469.8773; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9857267.8889; train_global_loss: 12580113.2222; train_optim_loss: 12580113.2222; val_kl_reg_loss: 86482.9531; val_edge_recon_loss: 406412.8125; val_gene_expr_recon_loss: 2215533.0000; val_masked_gp_l1_reg_loss: 2452.6814; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9839216.0000; val_global_loss: 12550098.0000; val_optim_loss: 12550098.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8795; val_auprc_score: 0.8699; val_best_acc_score: 0.5442; val_best_f1_score: 0.6865; train_kl_reg_loss: 87771.9523; train_edge_recon_loss: 398371.5451; train_gene_expr_recon_loss: 2185426.7222; train_masked_gp_l1_reg_loss: 2436.2424; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9799001.2222; train_global_loss: 12473007.5556; train_optim_loss: 12473007.5556; val_kl_reg_loss: 81886.5000; val_edge_recon_loss: 406267.2812; val_gene_expr_recon_loss: 2177821.5000; val_masked_gp_l1_reg_loss: 2413.3857; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9792392.0000; val_global_loss: 12460781.0000; val_optim_loss: 12460781.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8831; val_auprc_score: 0.8740; val_best_acc_score: 0.5880; val_best_f1_score: 0.7072; train_kl_reg_loss: 88571.4227; train_edge_recon_loss: 397117.8819; train_gene_expr_recon_loss: 2173595.1667; train_masked_gp_l1_reg_loss: 2396.6455; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9823292.2222; train_global_loss: 12484973.3333; train_optim_loss: 12484973.3333; val_kl_reg_loss: 81068.1406; val_edge_recon_loss: 406063.0312; val_gene_expr_recon_loss: 2155034.5000; val_masked_gp_l1_reg_loss: 2375.9456; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9774045.0000; val_global_loss: 12418587.0000; val_optim_loss: 12418587.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8865; val_auprc_score: 0.8779; val_best_acc_score: 0.6279; val_best_f1_score: 0.7267; train_kl_reg_loss: 86699.7934; train_edge_recon_loss: 396133.2951; train_gene_expr_recon_loss: 2130322.1250; train_masked_gp_l1_reg_loss: 2363.2645; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9747161.3333; train_global_loss: 12362679.8889; train_optim_loss: 12362679.8889; val_kl_reg_loss: 82079.9062; val_edge_recon_loss: 405838.2500; val_gene_expr_recon_loss: 2137674.2500; val_masked_gp_l1_reg_loss: 2348.2263; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9756918.0000; val_global_loss: 12384859.0000; val_optim_loss: 12384859.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9002; val_auprc_score: 0.8885; val_best_acc_score: 0.7030; val_best_f1_score: 0.7676; train_kl_reg_loss: 85752.2969; train_edge_recon_loss: 395059.8681; train_gene_expr_recon_loss: 2129167.4167; train_masked_gp_l1_reg_loss: 2339.0378; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9813084.2222; train_global_loss: 12425402.6667; train_optim_loss: 12425402.6667; val_kl_reg_loss: 76204.3438; val_edge_recon_loss: 405373.5312; val_gene_expr_recon_loss: 2125493.0000; val_masked_gp_l1_reg_loss: 2326.8467; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9729790.0000; val_global_loss: 12339188.0000; val_optim_loss: 12339188.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8959; val_auprc_score: 0.8836; val_best_acc_score: 0.7520; val_best_f1_score: 0.7952; train_kl_reg_loss: 82587.3984; train_edge_recon_loss: 393175.5069; train_gene_expr_recon_loss: 2124502.5972; train_masked_gp_l1_reg_loss: 2318.9806; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9762549.7778; train_global_loss: 12365134.1111; train_optim_loss: 12365134.1111; val_kl_reg_loss: 72888.7188; val_edge_recon_loss: 404747.8750; val_gene_expr_recon_loss: 2118145.0000; val_masked_gp_l1_reg_loss: 2308.2781; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9717420.0000; val_global_loss: 12315510.0000; val_optim_loss: 12315510.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9007; val_auprc_score: 0.8859; val_best_acc_score: 0.7966; val_best_f1_score: 0.8212; train_kl_reg_loss: 80217.3247; train_edge_recon_loss: 392122.6389; train_gene_expr_recon_loss: 2093962.2639; train_masked_gp_l1_reg_loss: 2303.0708; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9697618.5556; train_global_loss: 12266224.0000; train_optim_loss: 12266224.0000; val_kl_reg_loss: 69652.5391; val_edge_recon_loss: 403709.8438; val_gene_expr_recon_loss: 2110180.0000; val_masked_gp_l1_reg_loss: 2297.0977; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9699325.0000; val_global_loss: 12285164.0000; val_optim_loss: 12285164.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9080; val_auprc_score: 0.8988; val_best_acc_score: 0.8174; val_best_f1_score: 0.8299; train_kl_reg_loss: 77858.0720; train_edge_recon_loss: 390671.1389; train_gene_expr_recon_loss: 2092498.1806; train_masked_gp_l1_reg_loss: 2295.4110; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9653095.8889; train_global_loss: 12216418.6667; train_optim_loss: 12216418.6667; val_kl_reg_loss: 66147.7578; val_edge_recon_loss: 402165.3125; val_gene_expr_recon_loss: 2104972.5000; val_masked_gp_l1_reg_loss: 2291.9214; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9690132.0000; val_global_loss: 12265710.0000; val_optim_loss: 12265710.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9110; val_auprc_score: 0.9003; val_best_acc_score: 0.8285; val_best_f1_score: 0.8292; train_kl_reg_loss: 75430.2891; train_edge_recon_loss: 389459.1910; train_gene_expr_recon_loss: 2083658.5694; train_masked_gp_l1_reg_loss: 2291.7581; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9669417.3333; train_global_loss: 12220257.2222; train_optim_loss: 12220257.2222; val_kl_reg_loss: 64844.0898; val_edge_recon_loss: 399862.4375; val_gene_expr_recon_loss: 2101608.5000; val_masked_gp_l1_reg_loss: 2288.6206; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9691758.0000; val_global_loss: 12260362.0000; val_optim_loss: 12260362.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9049; val_auprc_score: 0.8941; val_best_acc_score: 0.8169; val_best_f1_score: 0.8081; train_kl_reg_loss: 73873.3359; train_edge_recon_loss: 386942.1667; train_gene_expr_recon_loss: 2081498.1528; train_masked_gp_l1_reg_loss: 2289.7148; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9700535.0000; train_global_loss: 12245138.2222; train_optim_loss: 12245138.2222; val_kl_reg_loss: 64030.6172; val_edge_recon_loss: 397201.4375; val_gene_expr_recon_loss: 2095378.0000; val_masked_gp_l1_reg_loss: 2286.5149; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9663064.0000; val_global_loss: 12221960.0000; val_optim_loss: 12221960.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9011; val_auprc_score: 0.8851; val_best_acc_score: 0.7955; val_best_f1_score: 0.8119; train_kl_reg_loss: 72801.0191; train_edge_recon_loss: 383774.6667; train_gene_expr_recon_loss: 2075353.7222; train_masked_gp_l1_reg_loss: 2287.8612; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9627337.7778; train_global_loss: 12161555.0000; train_optim_loss: 12161555.0000; val_kl_reg_loss: 63891.0938; val_edge_recon_loss: 393270.0312; val_gene_expr_recon_loss: 2093421.3750; val_masked_gp_l1_reg_loss: 2286.0928; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9674407.0000; val_global_loss: 12227276.0000; val_optim_loss: 12227276.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9013; val_auprc_score: 0.8850; val_best_acc_score: 0.8032; val_best_f1_score: 0.8271; train_kl_reg_loss: 71898.2865; train_edge_recon_loss: 380679.8611; train_gene_expr_recon_loss: 2077089.6806; train_masked_gp_l1_reg_loss: 2287.0322; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9645776.1111; train_global_loss: 12177730.8889; train_optim_loss: 12177730.8889; val_kl_reg_loss: 64618.9961; val_edge_recon_loss: 388960.0000; val_gene_expr_recon_loss: 2087260.2500; val_masked_gp_l1_reg_loss: 2286.0388; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9664220.0000; val_global_loss: 12207345.0000; val_optim_loss: 12207345.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9086; val_auprc_score: 0.8927; val_best_acc_score: 0.8170; val_best_f1_score: 0.8329; train_kl_reg_loss: 71613.6458; train_edge_recon_loss: 376727.0903; train_gene_expr_recon_loss: 2080430.2639; train_masked_gp_l1_reg_loss: 2288.4347; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9639258.5556; train_global_loss: 12170318.2222; train_optim_loss: 12170318.2222; val_kl_reg_loss: 64492.7695; val_edge_recon_loss: 382375.1875; val_gene_expr_recon_loss: 2084455.6250; val_masked_gp_l1_reg_loss: 2288.9114; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9644769.0000; val_global_loss: 12178382.0000; val_optim_loss: 12178382.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9056; val_auprc_score: 0.8898; val_best_acc_score: 0.8211; val_best_f1_score: 0.8322; train_kl_reg_loss: 71594.0582; train_edge_recon_loss: 372616.1979; train_gene_expr_recon_loss: 2079743.1528; train_masked_gp_l1_reg_loss: 2293.7077; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9619098.4444; train_global_loss: 12145345.4444; train_optim_loss: 12145345.4444; val_kl_reg_loss: 65812.3750; val_edge_recon_loss: 376895.5625; val_gene_expr_recon_loss: 2083275.3750; val_masked_gp_l1_reg_loss: 2295.0801; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9647974.0000; val_global_loss: 12176252.0000; val_optim_loss: 12176252.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9025; val_auprc_score: 0.8877; val_best_acc_score: 0.8153; val_best_f1_score: 0.8242; train_kl_reg_loss: 72164.2335; train_edge_recon_loss: 367911.0035; train_gene_expr_recon_loss: 2073139.1528; train_masked_gp_l1_reg_loss: 2300.8104; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9635092.3333; train_global_loss: 12150607.4444; train_optim_loss: 12150607.4444; val_kl_reg_loss: 65857.0625; val_edge_recon_loss: 371240.7188; val_gene_expr_recon_loss: 2078361.3750; val_masked_gp_l1_reg_loss: 2305.6003; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9615051.0000; val_global_loss: 12132816.0000; val_optim_loss: 12132816.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9059; val_auprc_score: 0.8927; val_best_acc_score: 0.8193; val_best_f1_score: 0.8268; train_kl_reg_loss: 72666.6571; train_edge_recon_loss: 362254.9271; train_gene_expr_recon_loss: 2073986.8194; train_masked_gp_l1_reg_loss: 2311.9160; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9645084.1111; train_global_loss: 12156304.3333; train_optim_loss: 12156304.3333; val_kl_reg_loss: 66729.5859; val_edge_recon_loss: 362846.8750; val_gene_expr_recon_loss: 2077202.1250; val_masked_gp_l1_reg_loss: 2316.7732; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9616601.0000; val_global_loss: 12125696.0000; val_optim_loss: 12125696.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9062; val_auprc_score: 0.8971; val_best_acc_score: 0.8200; val_best_f1_score: 0.8243; train_kl_reg_loss: 74024.5694; train_edge_recon_loss: 357333.4236; train_gene_expr_recon_loss: 2069825.3056; train_masked_gp_l1_reg_loss: 2320.9812; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9632476.2222; train_global_loss: 12135980.4444; train_optim_loss: 12135980.4444; val_kl_reg_loss: 66497.1797; val_edge_recon_loss: 357668.0938; val_gene_expr_recon_loss: 2075741.8750; val_masked_gp_l1_reg_loss: 2324.4534; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9611255.0000; val_global_loss: 12113487.0000; val_optim_loss: 12113487.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9064; val_auprc_score: 0.8938; val_best_acc_score: 0.8219; val_best_f1_score: 0.8296; train_kl_reg_loss: 73531.2196; train_edge_recon_loss: 352973.3681; train_gene_expr_recon_loss: 2055519.6528; train_masked_gp_l1_reg_loss: 2333.1704; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9628760.2222; train_global_loss: 12113117.4444; train_optim_loss: 12113117.4444; val_kl_reg_loss: 66886.7656; val_edge_recon_loss: 353573.7188; val_gene_expr_recon_loss: 2074075.3750; val_masked_gp_l1_reg_loss: 2339.1685; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9598635.0000; val_global_loss: 12095510.0000; val_optim_loss: 12095510.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9137; val_auprc_score: 0.9048; val_best_acc_score: 0.8294; val_best_f1_score: 0.8340; train_kl_reg_loss: 73435.2786; train_edge_recon_loss: 349484.0000; train_gene_expr_recon_loss: 2052990.3611; train_masked_gp_l1_reg_loss: 2345.6255; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9604215.3333; train_global_loss: 12082470.6667; train_optim_loss: 12082470.6667; val_kl_reg_loss: 68796.7969; val_edge_recon_loss: 350482.7500; val_gene_expr_recon_loss: 2070545.2500; val_masked_gp_l1_reg_loss: 2349.6326; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9595377.0000; val_global_loss: 12087552.0000; val_optim_loss: 12087552.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9099; val_auprc_score: 0.8946; val_best_acc_score: 0.8288; val_best_f1_score: 0.8342; train_kl_reg_loss: 73123.3255; train_edge_recon_loss: 347147.9861; train_gene_expr_recon_loss: 2049776.7500; train_masked_gp_l1_reg_loss: 2354.3466; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9574879.3333; train_global_loss: 12047281.7778; train_optim_loss: 12047281.7778; val_kl_reg_loss: 68954.6406; val_edge_recon_loss: 348625.6562; val_gene_expr_recon_loss: 2066757.0000; val_masked_gp_l1_reg_loss: 2357.9614; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9579674.0000; val_global_loss: 12066369.0000; val_optim_loss: 12066369.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9267; val_auprc_score: 0.9107; val_best_acc_score: 0.8386; val_best_f1_score: 0.8539; train_kl_reg_loss: 76225.4983; train_edge_recon_loss: 375706.2361; train_gene_expr_recon_loss: 2139622.1111; train_masked_gp_l1_reg_loss: 2371.0226; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9682708.6667; train_global_loss: 12276633.5556; train_optim_loss: 12276633.5556; val_kl_reg_loss: 50397.7109; val_edge_recon_loss: 378346.3750; val_gene_expr_recon_loss: 2120614.2500; val_masked_gp_l1_reg_loss: 2383.8594; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9633152.0000; val_global_loss: 12184894.0000; val_optim_loss: 12184894.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9293; val_auprc_score: 0.9136; val_best_acc_score: 0.8416; val_best_f1_score: 0.8569; train_kl_reg_loss: 74327.8620; train_edge_recon_loss: 370709.2674; train_gene_expr_recon_loss: 2111112.4167; train_masked_gp_l1_reg_loss: 2387.2498; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9685367.5556; train_global_loss: 12243904.2222; train_optim_loss: 12243904.2222; val_kl_reg_loss: 45883.1250; val_edge_recon_loss: 380756.2812; val_gene_expr_recon_loss: 2113305.2500; val_masked_gp_l1_reg_loss: 2387.4956; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9638797.0000; val_global_loss: 12181129.0000; val_optim_loss: 12181129.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9310; val_auprc_score: 0.9142; val_best_acc_score: 0.8477; val_best_f1_score: 0.8609; train_kl_reg_loss: 65590.6606; train_edge_recon_loss: 373704.1458; train_gene_expr_recon_loss: 2094249.0833; train_masked_gp_l1_reg_loss: 2388.2854; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9635488.6667; train_global_loss: 12171421.1111; train_optim_loss: 12171421.1111; val_kl_reg_loss: 45646.3203; val_edge_recon_loss: 377927.3438; val_gene_expr_recon_loss: 2108661.5000; val_masked_gp_l1_reg_loss: 2387.0110; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9618770.0000; val_global_loss: 12153392.0000; val_optim_loss: 12153392.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9256; val_auprc_score: 0.9050; val_best_acc_score: 0.8426; val_best_f1_score: 0.8563; train_kl_reg_loss: 63308.0894; train_edge_recon_loss: 370759.7188; train_gene_expr_recon_loss: 2098836.8333; train_masked_gp_l1_reg_loss: 2385.7671; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9592880.5556; train_global_loss: 12128171.2222; train_optim_loss: 12128171.2222; val_kl_reg_loss: 46051.0781; val_edge_recon_loss: 374769.3438; val_gene_expr_recon_loss: 2111292.7500; val_masked_gp_l1_reg_loss: 2383.1116; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9605169.0000; val_global_loss: 12139665.0000; val_optim_loss: 12139665.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9319; val_auprc_score: 0.9189; val_best_acc_score: 0.8482; val_best_f1_score: 0.8607; train_kl_reg_loss: 60185.4887; train_edge_recon_loss: 369915.7812; train_gene_expr_recon_loss: 2107501.2083; train_masked_gp_l1_reg_loss: 2382.3837; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9609092.7778; train_global_loss: 12149077.6667; train_optim_loss: 12149077.6667; val_kl_reg_loss: 49920.5117; val_edge_recon_loss: 374064.3438; val_gene_expr_recon_loss: 2109030.2500; val_masked_gp_l1_reg_loss: 2381.2319; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9614970.0000; val_global_loss: 12150366.0000; val_optim_loss: 12150366.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9317; val_auprc_score: 0.9162; val_best_acc_score: 0.8487; val_best_f1_score: 0.8608; train_kl_reg_loss: 63107.3750; train_edge_recon_loss: 368297.0451; train_gene_expr_recon_loss: 2096542.0278; train_masked_gp_l1_reg_loss: 2380.2282; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9604705.2222; train_global_loss: 12135031.7778; train_optim_loss: 12135031.7778; val_kl_reg_loss: 49431.6797; val_edge_recon_loss: 373349.1875; val_gene_expr_recon_loss: 2108327.2500; val_masked_gp_l1_reg_loss: 2378.9131; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9609229.0000; val_global_loss: 12142716.0000; val_optim_loss: 12142716.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9320; val_auprc_score: 0.9173; val_best_acc_score: 0.8442; val_best_f1_score: 0.8572; train_kl_reg_loss: 62202.7057; train_edge_recon_loss: 367776.4653; train_gene_expr_recon_loss: 2106659.2083; train_masked_gp_l1_reg_loss: 2377.9310; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9608523.2222; train_global_loss: 12147539.3333; train_optim_loss: 12147539.3333; val_kl_reg_loss: 49333.5195; val_edge_recon_loss: 372814.9688; val_gene_expr_recon_loss: 2109701.0000; val_masked_gp_l1_reg_loss: 2376.8145; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9617613.0000; val_global_loss: 12151839.0000; val_optim_loss: 12151839.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9293; val_auprc_score: 0.9163; val_best_acc_score: 0.8447; val_best_f1_score: 0.8578; train_kl_reg_loss: 62092.1228; train_edge_recon_loss: 368229.5035; train_gene_expr_recon_loss: 2107221.0833; train_masked_gp_l1_reg_loss: 2375.9992; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9630224.2222; train_global_loss: 12170142.6667; train_optim_loss: 12170142.6667; val_kl_reg_loss: 49187.8867; val_edge_recon_loss: 373256.6875; val_gene_expr_recon_loss: 2107314.2500; val_masked_gp_l1_reg_loss: 2375.1770; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9608698.0000; val_global_loss: 12140832.0000; val_optim_loss: 12140832.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 36 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9220
Val AUPRC score: 0.9070
Val best accuracy score: 0.8366
Val best F1 score: 0.8509
Val gene expr MSE score: 0.6160
Val chrom access MSE score: 0.0864
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
