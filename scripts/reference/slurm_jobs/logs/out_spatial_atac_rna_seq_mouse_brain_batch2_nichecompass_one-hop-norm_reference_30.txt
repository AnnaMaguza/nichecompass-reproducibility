[True]
Run timestamp: 07082023_180617_30.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_30']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8783; val_auprc_score: 0.8943; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 15272.9769; train_edge_recon_loss: 35945.2556; train_gene_expr_recon_loss: 1140701.6389; train_masked_gp_l1_reg_loss: 4547.5618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166810.7465; train_chrom_access_recon_loss: 816451.9375; train_global_loss: 2179730.1389; train_optim_loss: 2179730.1389; val_kl_reg_loss: 8604.3066; val_edge_recon_loss: 40657.3438; val_gene_expr_recon_loss: 971188.3750; val_masked_gp_l1_reg_loss: 4041.3269; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162179.1719; val_chrom_access_recon_loss: 532572.5625; val_global_loss: 1719243.0000; val_optim_loss: 1719243.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8712; val_auprc_score: 0.8870; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 10950.0231; train_edge_recon_loss: 37513.4180; train_gene_expr_recon_loss: 903707.9583; train_masked_gp_l1_reg_loss: 3935.8419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159317.0885; train_chrom_access_recon_loss: 500799.3889; train_global_loss: 1616223.6806; train_optim_loss: 1616223.6806; val_kl_reg_loss: 14160.7744; val_edge_recon_loss: 40658.8594; val_gene_expr_recon_loss: 820834.1250; val_masked_gp_l1_reg_loss: 3903.8354; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155744.6562; val_chrom_access_recon_loss: 474281.3125; val_global_loss: 1509583.5000; val_optim_loss: 1509583.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8650; val_auprc_score: 0.8776; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 17755.9495; train_edge_recon_loss: 38545.7079; train_gene_expr_recon_loss: 793691.2708; train_masked_gp_l1_reg_loss: 3977.6435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152604.1684; train_chrom_access_recon_loss: 467909.1736; train_global_loss: 1474483.9167; train_optim_loss: 1474483.9167; val_kl_reg_loss: 18785.1250; val_edge_recon_loss: 40658.5352; val_gene_expr_recon_loss: 762679.5000; val_masked_gp_l1_reg_loss: 4052.7544; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148393.6875; val_chrom_access_recon_loss: 460749.4688; val_global_loss: 1435319.1250; val_optim_loss: 1435319.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8620; val_auprc_score: 0.8744; val_best_acc_score: 0.5069; val_best_f1_score: 0.6697; train_kl_reg_loss: 19293.9036; train_edge_recon_loss: 38693.9813; train_gene_expr_recon_loss: 752518.2222; train_masked_gp_l1_reg_loss: 4069.2983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144672.0972; train_chrom_access_recon_loss: 456991.1285; train_global_loss: 1416238.6250; train_optim_loss: 1416238.6250; val_kl_reg_loss: 19411.6133; val_edge_recon_loss: 40655.2148; val_gene_expr_recon_loss: 732570.1250; val_masked_gp_l1_reg_loss: 4078.3037; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139885.6719; val_chrom_access_recon_loss: 453362.6562; val_global_loss: 1389963.6250; val_optim_loss: 1389963.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8563; val_auprc_score: 0.8629; val_best_acc_score: 0.5170; val_best_f1_score: 0.6741; train_kl_reg_loss: 20825.9894; train_edge_recon_loss: 38792.6597; train_gene_expr_recon_loss: 724654.4236; train_masked_gp_l1_reg_loss: 4071.8399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135923.4045; train_chrom_access_recon_loss: 453416.6771; train_global_loss: 1377685.0139; train_optim_loss: 1377685.0139; val_kl_reg_loss: 19940.5469; val_edge_recon_loss: 40648.1406; val_gene_expr_recon_loss: 712539.2500; val_masked_gp_l1_reg_loss: 4050.4519; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130921.4688; val_chrom_access_recon_loss: 449262.4062; val_global_loss: 1357362.2500; val_optim_loss: 1357362.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8661; val_auprc_score: 0.8690; val_best_acc_score: 0.5244; val_best_f1_score: 0.6769; train_kl_reg_loss: 20540.2261; train_edge_recon_loss: 38806.6102; train_gene_expr_recon_loss: 707660.6597; train_masked_gp_l1_reg_loss: 4037.4013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126900.0616; train_chrom_access_recon_loss: 449280.7986; train_global_loss: 1347225.7361; train_optim_loss: 1347225.7361; val_kl_reg_loss: 19838.1094; val_edge_recon_loss: 40636.2188; val_gene_expr_recon_loss: 696680.1250; val_masked_gp_l1_reg_loss: 4019.4199; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121880.5859; val_chrom_access_recon_loss: 446273.7812; val_global_loss: 1329328.2500; val_optim_loss: 1329328.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8670; val_auprc_score: 0.8638; val_best_acc_score: 0.5321; val_best_f1_score: 0.6790; train_kl_reg_loss: 21083.7875; train_edge_recon_loss: 38837.7283; train_gene_expr_recon_loss: 696027.1181; train_masked_gp_l1_reg_loss: 4006.6140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117917.9384; train_chrom_access_recon_loss: 445599.1181; train_global_loss: 1323472.3056; train_optim_loss: 1323472.3056; val_kl_reg_loss: 19995.6641; val_edge_recon_loss: 40618.9844; val_gene_expr_recon_loss: 683630.3750; val_masked_gp_l1_reg_loss: 3983.8208; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113012.2031; val_chrom_access_recon_loss: 444066.8125; val_global_loss: 1305307.7500; val_optim_loss: 1305307.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8625; val_auprc_score: 0.8660; val_best_acc_score: 0.5494; val_best_f1_score: 0.6862; train_kl_reg_loss: 21271.7218; train_edge_recon_loss: 38844.3008; train_gene_expr_recon_loss: 683122.6181; train_masked_gp_l1_reg_loss: 3972.2900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109212.7153; train_chrom_access_recon_loss: 444987.5972; train_global_loss: 1301411.2500; train_optim_loss: 1301411.2500; val_kl_reg_loss: 20423.3086; val_edge_recon_loss: 40607.1133; val_gene_expr_recon_loss: 673400.2500; val_masked_gp_l1_reg_loss: 3955.0786; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104548.8359; val_chrom_access_recon_loss: 442093.4062; val_global_loss: 1285028.0000; val_optim_loss: 1285028.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8614; val_auprc_score: 0.8627; val_best_acc_score: 0.5838; val_best_f1_score: 0.7020; train_kl_reg_loss: 21348.6879; train_edge_recon_loss: 38878.6276; train_gene_expr_recon_loss: 673793.5278; train_masked_gp_l1_reg_loss: 3948.4626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100985.4054; train_chrom_access_recon_loss: 440459.8507; train_global_loss: 1279414.5833; train_optim_loss: 1279414.5833; val_kl_reg_loss: 20805.2695; val_edge_recon_loss: 40584.6484; val_gene_expr_recon_loss: 666105.4375; val_masked_gp_l1_reg_loss: 3937.9441; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96631.8438; val_chrom_access_recon_loss: 440499.0312; val_global_loss: 1268564.1250; val_optim_loss: 1268564.1250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8736; val_auprc_score: 0.8719; val_best_acc_score: 0.6236; val_best_f1_score: 0.7213; train_kl_reg_loss: 21697.8357; train_edge_recon_loss: 38897.0165; train_gene_expr_recon_loss: 668607.0069; train_masked_gp_l1_reg_loss: 3933.9875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93335.4002; train_chrom_access_recon_loss: 440892.7222; train_global_loss: 1267363.9583; train_optim_loss: 1267363.9583; val_kl_reg_loss: 20101.1445; val_edge_recon_loss: 40559.6602; val_gene_expr_recon_loss: 662032.2500; val_masked_gp_l1_reg_loss: 3922.2715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89324.7656; val_chrom_access_recon_loss: 439250.0938; val_global_loss: 1255190.1250; val_optim_loss: 1255190.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8805; val_auprc_score: 0.8757; val_best_acc_score: 0.6717; val_best_f1_score: 0.7461; train_kl_reg_loss: 21520.7747; train_edge_recon_loss: 38915.1701; train_gene_expr_recon_loss: 665564.5694; train_masked_gp_l1_reg_loss: 3922.0781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86321.4922; train_chrom_access_recon_loss: 439684.5035; train_global_loss: 1255928.5833; train_optim_loss: 1255928.5833; val_kl_reg_loss: 20388.3398; val_edge_recon_loss: 40529.7383; val_gene_expr_recon_loss: 657074.9375; val_masked_gp_l1_reg_loss: 3915.6650; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82678.7344; val_chrom_access_recon_loss: 438030.1875; val_global_loss: 1242617.6250; val_optim_loss: 1242617.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8971; val_auprc_score: 0.8909; val_best_acc_score: 0.7418; val_best_f1_score: 0.7876; train_kl_reg_loss: 21415.8503; train_edge_recon_loss: 38900.6962; train_gene_expr_recon_loss: 658028.9722; train_masked_gp_l1_reg_loss: 3915.7751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79981.9653; train_chrom_access_recon_loss: 437120.9062; train_global_loss: 1239364.1667; train_optim_loss: 1239364.1667; val_kl_reg_loss: 20375.6133; val_edge_recon_loss: 40490.4648; val_gene_expr_recon_loss: 653337.1250; val_masked_gp_l1_reg_loss: 3913.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76714.8281; val_chrom_access_recon_loss: 436888.2812; val_global_loss: 1231719.8750; val_optim_loss: 1231719.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9036; val_auprc_score: 0.8939; val_best_acc_score: 0.7882; val_best_f1_score: 0.8162; train_kl_reg_loss: 21036.8424; train_edge_recon_loss: 38847.3247; train_gene_expr_recon_loss: 656810.5486; train_masked_gp_l1_reg_loss: 3918.4421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74281.4583; train_chrom_access_recon_loss: 437206.7604; train_global_loss: 1232101.3472; train_optim_loss: 1232101.3472; val_kl_reg_loss: 19425.3867; val_edge_recon_loss: 40428.7383; val_gene_expr_recon_loss: 651591.5000; val_masked_gp_l1_reg_loss: 3914.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71333.1562; val_chrom_access_recon_loss: 436002.0625; val_global_loss: 1222695.2500; val_optim_loss: 1222695.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9176; val_auprc_score: 0.9106; val_best_acc_score: 0.8220; val_best_f1_score: 0.8392; train_kl_reg_loss: 20727.1536; train_edge_recon_loss: 38806.3142; train_gene_expr_recon_loss: 653631.9167; train_masked_gp_l1_reg_loss: 3918.7031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69145.4470; train_chrom_access_recon_loss: 437377.9618; train_global_loss: 1223607.5139; train_optim_loss: 1223607.5139; val_kl_reg_loss: 20290.0352; val_edge_recon_loss: 40376.4453; val_gene_expr_recon_loss: 647748.7500; val_masked_gp_l1_reg_loss: 3919.1616; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66492.5156; val_chrom_access_recon_loss: 434960.0625; val_global_loss: 1213787.0000; val_optim_loss: 1213787.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9221; val_auprc_score: 0.9101; val_best_acc_score: 0.8447; val_best_f1_score: 0.8531; train_kl_reg_loss: 20531.8427; train_edge_recon_loss: 38750.6680; train_gene_expr_recon_loss: 651712.3542; train_masked_gp_l1_reg_loss: 3924.3843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64513.2782; train_chrom_access_recon_loss: 434709.1493; train_global_loss: 1214141.6806; train_optim_loss: 1214141.6806; val_kl_reg_loss: 19319.8672; val_edge_recon_loss: 40287.1289; val_gene_expr_recon_loss: 646236.6250; val_masked_gp_l1_reg_loss: 3929.6799; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62107.2734; val_chrom_access_recon_loss: 434011.8750; val_global_loss: 1205892.5000; val_optim_loss: 1205892.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9222; val_auprc_score: 0.9107; val_best_acc_score: 0.8500; val_best_f1_score: 0.8553; train_kl_reg_loss: 20199.3173; train_edge_recon_loss: 38697.6476; train_gene_expr_recon_loss: 648513.7014; train_masked_gp_l1_reg_loss: 3939.0475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60316.3945; train_chrom_access_recon_loss: 433036.8819; train_global_loss: 1204702.9722; train_optim_loss: 1204702.9722; val_kl_reg_loss: 19616.0742; val_edge_recon_loss: 40224.6680; val_gene_expr_recon_loss: 643637.6250; val_masked_gp_l1_reg_loss: 3942.1262; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58138.1328; val_chrom_access_recon_loss: 433146.9688; val_global_loss: 1198705.6250; val_optim_loss: 1198705.6250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9274; val_auprc_score: 0.9161; val_best_acc_score: 0.8573; val_best_f1_score: 0.8573; train_kl_reg_loss: 19998.3270; train_edge_recon_loss: 38611.3095; train_gene_expr_recon_loss: 649383.9375; train_masked_gp_l1_reg_loss: 3948.6820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56500.7565; train_chrom_access_recon_loss: 433755.1944; train_global_loss: 1202198.2222; train_optim_loss: 1202198.2222; val_kl_reg_loss: 18864.7188; val_edge_recon_loss: 40127.0820; val_gene_expr_recon_loss: 642237.0000; val_masked_gp_l1_reg_loss: 3952.4045; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54512.4609; val_chrom_access_recon_loss: 432643.1250; val_global_loss: 1192336.7500; val_optim_loss: 1192336.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9288; val_auprc_score: 0.9140; val_best_acc_score: 0.8558; val_best_f1_score: 0.8534; train_kl_reg_loss: 19688.2975; train_edge_recon_loss: 38565.5890; train_gene_expr_recon_loss: 642615.5903; train_masked_gp_l1_reg_loss: 3962.1379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53031.8498; train_chrom_access_recon_loss: 430641.5660; train_global_loss: 1188504.9861; train_optim_loss: 1188504.9861; val_kl_reg_loss: 18985.5430; val_edge_recon_loss: 40075.3555; val_gene_expr_recon_loss: 640252.0000; val_masked_gp_l1_reg_loss: 3966.7686; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51215.9922; val_chrom_access_recon_loss: 431791.1562; val_global_loss: 1186286.7500; val_optim_loss: 1186286.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9315; val_auprc_score: 0.9182; val_best_acc_score: 0.8502; val_best_f1_score: 0.8444; train_kl_reg_loss: 19452.1165; train_edge_recon_loss: 38490.7396; train_gene_expr_recon_loss: 645625.2431; train_masked_gp_l1_reg_loss: 3973.1355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49857.1871; train_chrom_access_recon_loss: 432706.9583; train_global_loss: 1190105.3889; train_optim_loss: 1190105.3889; val_kl_reg_loss: 18327.2910; val_edge_recon_loss: 39988.3984; val_gene_expr_recon_loss: 639231.8125; val_masked_gp_l1_reg_loss: 3975.6440; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48197.4414; val_chrom_access_recon_loss: 431036.9688; val_global_loss: 1180757.5000; val_optim_loss: 1180757.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9331; val_auprc_score: 0.9207; val_best_acc_score: 0.8448; val_best_f1_score: 0.8353; train_kl_reg_loss: 19216.9171; train_edge_recon_loss: 38426.0022; train_gene_expr_recon_loss: 638959.8472; train_masked_gp_l1_reg_loss: 3984.1058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46955.5195; train_chrom_access_recon_loss: 430488.4306; train_global_loss: 1178030.8333; train_optim_loss: 1178030.8333; val_kl_reg_loss: 17893.1680; val_edge_recon_loss: 39888.2109; val_gene_expr_recon_loss: 638285.7500; val_masked_gp_l1_reg_loss: 3988.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45435.1914; val_chrom_access_recon_loss: 430344.1875; val_global_loss: 1175835.1250; val_optim_loss: 1175835.1250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9334; val_auprc_score: 0.9188; val_best_acc_score: 0.8394; val_best_f1_score: 0.8277; train_kl_reg_loss: 18952.9922; train_edge_recon_loss: 38351.9002; train_gene_expr_recon_loss: 639917.6250; train_masked_gp_l1_reg_loss: 3995.4394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44295.2079; train_chrom_access_recon_loss: 430771.4826; train_global_loss: 1176284.6528; train_optim_loss: 1176284.6528; val_kl_reg_loss: 17582.4121; val_edge_recon_loss: 39819.7930; val_gene_expr_recon_loss: 637135.0000; val_masked_gp_l1_reg_loss: 3999.9338; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42899.3281; val_chrom_access_recon_loss: 430533.6562; val_global_loss: 1171970.1250; val_optim_loss: 1171970.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9384; val_auprc_score: 0.9263; val_best_acc_score: 0.8359; val_best_f1_score: 0.8365; train_kl_reg_loss: 18649.8409; train_edge_recon_loss: 38281.4128; train_gene_expr_recon_loss: 644022.4375; train_masked_gp_l1_reg_loss: 4010.2298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41858.9062; train_chrom_access_recon_loss: 431503.0000; train_global_loss: 1178325.8333; train_optim_loss: 1178325.8333; val_kl_reg_loss: 17930.2031; val_edge_recon_loss: 39737.4531; val_gene_expr_recon_loss: 634870.1875; val_masked_gp_l1_reg_loss: 4014.0767; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40583.0156; val_chrom_access_recon_loss: 429888.0000; val_global_loss: 1167023.0000; val_optim_loss: 1167023.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9361; val_auprc_score: 0.9244; val_best_acc_score: 0.8226; val_best_f1_score: 0.8464; train_kl_reg_loss: 18423.0148; train_edge_recon_loss: 38187.8602; train_gene_expr_recon_loss: 637575.2708; train_masked_gp_l1_reg_loss: 4024.4773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39622.3746; train_chrom_access_recon_loss: 428634.6979; train_global_loss: 1166467.6944; train_optim_loss: 1166467.6944; val_kl_reg_loss: 17403.5625; val_edge_recon_loss: 39644.1836; val_gene_expr_recon_loss: 634065.6250; val_masked_gp_l1_reg_loss: 4031.1812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38439.5156; val_chrom_access_recon_loss: 429276.7188; val_global_loss: 1162860.7500; val_optim_loss: 1162860.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9447; val_auprc_score: 0.9375; val_best_acc_score: 0.8399; val_best_f1_score: 0.8589; train_kl_reg_loss: 18209.9136; train_edge_recon_loss: 38106.9757; train_gene_expr_recon_loss: 638497.6389; train_masked_gp_l1_reg_loss: 4042.7120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37546.9553; train_chrom_access_recon_loss: 430038.8403; train_global_loss: 1166443.0417; train_optim_loss: 1166443.0417; val_kl_reg_loss: 16823.1250; val_edge_recon_loss: 39541.8906; val_gene_expr_recon_loss: 633719.6250; val_masked_gp_l1_reg_loss: 4049.5691; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36450.0039; val_chrom_access_recon_loss: 428646.3750; val_global_loss: 1159230.5000; val_optim_loss: 1159230.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9454; val_auprc_score: 0.9381; val_best_acc_score: 0.8445; val_best_f1_score: 0.8623; train_kl_reg_loss: 18027.6068; train_edge_recon_loss: 38076.6033; train_gene_expr_recon_loss: 636903.4028; train_masked_gp_l1_reg_loss: 4058.3213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35632.6706; train_chrom_access_recon_loss: 427814.9965; train_global_loss: 1160513.6111; train_optim_loss: 1160513.6111; val_kl_reg_loss: 17293.9043; val_edge_recon_loss: 39501.2969; val_gene_expr_recon_loss: 631660.2500; val_masked_gp_l1_reg_loss: 4061.5161; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34617.3086; val_chrom_access_recon_loss: 427861.0938; val_global_loss: 1154995.3750; val_optim_loss: 1154995.3750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9348; val_auprc_score: 0.9233; val_best_acc_score: 0.8386; val_best_f1_score: 0.8367; train_kl_reg_loss: 14953.0980; train_edge_recon_loss: 39036.3815; train_gene_expr_recon_loss: 903700.1319; train_masked_gp_l1_reg_loss: 4143.2163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33706.0243; train_chrom_access_recon_loss: 452102.2847; train_global_loss: 1447641.1250; train_optim_loss: 1447641.1250; val_kl_reg_loss: 12677.1377; val_edge_recon_loss: 39746.9258; val_gene_expr_recon_loss: 890640.6250; val_masked_gp_l1_reg_loss: 4293.1426; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32466.5254; val_chrom_access_recon_loss: 451199.3750; val_global_loss: 1431023.7500; val_optim_loss: 1431023.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9329; val_auprc_score: 0.9161; val_best_acc_score: 0.8321; val_best_f1_score: 0.8476; train_kl_reg_loss: 14233.5176; train_edge_recon_loss: 39122.8767; train_gene_expr_recon_loss: 897314.5694; train_masked_gp_l1_reg_loss: 4424.3517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31442.9653; train_chrom_access_recon_loss: 451689.9618; train_global_loss: 1438228.2083; train_optim_loss: 1438228.2083; val_kl_reg_loss: 12337.8584; val_edge_recon_loss: 39693.3555; val_gene_expr_recon_loss: 884518.2500; val_masked_gp_l1_reg_loss: 4573.8389; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30190.7578; val_chrom_access_recon_loss: 450488.5625; val_global_loss: 1421802.5000; val_optim_loss: 1421802.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9381; val_auprc_score: 0.9280; val_best_acc_score: 0.8348; val_best_f1_score: 0.8556; train_kl_reg_loss: 14229.9732; train_edge_recon_loss: 39068.8442; train_gene_expr_recon_loss: 887301.7500; train_masked_gp_l1_reg_loss: 4673.5556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29249.0467; train_chrom_access_recon_loss: 449366.4236; train_global_loss: 1423889.5833; train_optim_loss: 1423889.5833; val_kl_reg_loss: 12642.8740; val_edge_recon_loss: 39590.7422; val_gene_expr_recon_loss: 878940.5000; val_masked_gp_l1_reg_loss: 4780.0396; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28112.8223; val_chrom_access_recon_loss: 449596.1562; val_global_loss: 1413663.1250; val_optim_loss: 1413663.1250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9432; val_auprc_score: 0.9295; val_best_acc_score: 0.8499; val_best_f1_score: 0.8665; train_kl_reg_loss: 14228.9145; train_edge_recon_loss: 38969.0660; train_gene_expr_recon_loss: 882234.8958; train_masked_gp_l1_reg_loss: 4846.4716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27273.2702; train_chrom_access_recon_loss: 450767.4965; train_global_loss: 1418320.1111; train_optim_loss: 1418320.1111; val_kl_reg_loss: 13068.1240; val_edge_recon_loss: 39427.2969; val_gene_expr_recon_loss: 874395.1875; val_masked_gp_l1_reg_loss: 4916.0757; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26261.8945; val_chrom_access_recon_loss: 448841.4688; val_global_loss: 1406910.0000; val_optim_loss: 1406910.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9436; val_auprc_score: 0.9338; val_best_acc_score: 0.8507; val_best_f1_score: 0.8671; train_kl_reg_loss: 14351.9929; train_edge_recon_loss: 38880.5395; train_gene_expr_recon_loss: 880810.2569; train_masked_gp_l1_reg_loss: 4906.5873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26096.6385; train_chrom_access_recon_loss: 449236.6979; train_global_loss: 1414282.6944; train_optim_loss: 1414282.6944; val_kl_reg_loss: 13306.4775; val_edge_recon_loss: 39411.0742; val_gene_expr_recon_loss: 873754.8125; val_masked_gp_l1_reg_loss: 4897.9243; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25914.8145; val_chrom_access_recon_loss: 448722.8125; val_global_loss: 1406008.0000; val_optim_loss: 1406008.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9470; val_auprc_score: 0.9394; val_best_acc_score: 0.8507; val_best_f1_score: 0.8671; train_kl_reg_loss: 14446.2666; train_edge_recon_loss: 38881.6580; train_gene_expr_recon_loss: 882271.0694; train_masked_gp_l1_reg_loss: 4897.6962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25808.2648; train_chrom_access_recon_loss: 449338.0833; train_global_loss: 1415643.0556; train_optim_loss: 1415643.0556; val_kl_reg_loss: 13189.8691; val_edge_recon_loss: 39404.7188; val_gene_expr_recon_loss: 873567.0000; val_masked_gp_l1_reg_loss: 4896.0278; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25669.9453; val_chrom_access_recon_loss: 448737.9375; val_global_loss: 1405465.5000; val_optim_loss: 1405465.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9420; val_auprc_score: 0.9285; val_best_acc_score: 0.8503; val_best_f1_score: 0.8667; train_kl_reg_loss: 14337.0452; train_edge_recon_loss: 38878.3707; train_gene_expr_recon_loss: 879586.8194; train_masked_gp_l1_reg_loss: 4895.7862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25570.6725; train_chrom_access_recon_loss: 449420.9340; train_global_loss: 1412689.6528; train_optim_loss: 1412689.6528; val_kl_reg_loss: 13201.9902; val_edge_recon_loss: 39401.2891; val_gene_expr_recon_loss: 873209.1250; val_masked_gp_l1_reg_loss: 4895.7432; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25449.5078; val_chrom_access_recon_loss: 448613.0938; val_global_loss: 1404770.7500; val_optim_loss: 1404770.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9437; val_auprc_score: 0.9325; val_best_acc_score: 0.8508; val_best_f1_score: 0.8671; train_kl_reg_loss: 14365.7432; train_edge_recon_loss: 38864.9922; train_gene_expr_recon_loss: 880864.1736; train_masked_gp_l1_reg_loss: 4896.4278; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25358.0391; train_chrom_access_recon_loss: 448528.5278; train_global_loss: 1412877.9028; train_optim_loss: 1412877.9028; val_kl_reg_loss: 13197.4453; val_edge_recon_loss: 39378.8828; val_gene_expr_recon_loss: 872918.7500; val_masked_gp_l1_reg_loss: 4897.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25248.8770; val_chrom_access_recon_loss: 448622.1562; val_global_loss: 1404263.8750; val_optim_loss: 1404263.8750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9427
val AUPRC score: 0.9335
val best accuracy score: 0.8448
val best F1 score: 0.8428
val target rna MSE score: 3.7154
val source rna MSE score: 3.1974
val target atac MSE score: 0.1313
val source atac MSE score: 0.0199
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
