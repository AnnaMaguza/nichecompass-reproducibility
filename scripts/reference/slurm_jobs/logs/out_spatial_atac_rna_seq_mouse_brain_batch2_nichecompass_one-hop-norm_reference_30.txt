[True]
Run timestamp: 07092023_150515_30.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_30']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1125 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5628, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6704; val_auprc_score: 0.6580; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 62112.5060; train_edge_recon_loss: 3534807.9280; train_gene_expr_recon_loss: 16822256.4394; train_masked_gp_l1_reg_loss: 169579.4564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9773704.1970; train_chrom_access_recon_loss: 3780670.6591; train_global_loss: 34143131.2424; train_optim_loss: 34143131.2424; val_kl_reg_loss: 88672.6973; val_edge_recon_loss: 4065336.0312; val_gene_expr_recon_loss: 15351495.2500; val_masked_gp_l1_reg_loss: 162011.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3316237.7500; val_chrom_access_recon_loss: 3643622.0312; val_global_loss: 26627376.0000; val_optim_loss: 26627376.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7208; val_auprc_score: 0.6936; val_best_acc_score: 0.5516; val_best_f1_score: 0.6882; train_kl_reg_loss: 117484.0411; train_edge_recon_loss: 3543749.9318; train_gene_expr_recon_loss: 15051141.4545; train_masked_gp_l1_reg_loss: 153528.1643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1163356.5772; train_chrom_access_recon_loss: 3593208.7235; train_global_loss: 23622468.6364; train_optim_loss: 23622468.6364; val_kl_reg_loss: 134170.4297; val_edge_recon_loss: 4062518.0625; val_gene_expr_recon_loss: 14618475.5000; val_masked_gp_l1_reg_loss: 148171.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 375624.0625; val_chrom_access_recon_loss: 3546605.4688; val_global_loss: 22885565.5000; val_optim_loss: 22885565.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7496; val_auprc_score: 0.7223; val_best_acc_score: 0.6424; val_best_f1_score: 0.7222; train_kl_reg_loss: 123738.3258; train_edge_recon_loss: 3537110.5568; train_gene_expr_recon_loss: 14715812.7121; train_masked_gp_l1_reg_loss: 145964.9676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 280176.2159; train_chrom_access_recon_loss: 3550399.9356; train_global_loss: 22353202.5455; train_optim_loss: 22353202.5455; val_kl_reg_loss: 152438.3145; val_edge_recon_loss: 4055899.0938; val_gene_expr_recon_loss: 14717079.1250; val_masked_gp_l1_reg_loss: 145430.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 227288.2344; val_chrom_access_recon_loss: 3569810.3750; val_global_loss: 22867945.0000; val_optim_loss: 22867945.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7772; val_auprc_score: 0.7518; val_best_acc_score: 0.7093; val_best_f1_score: 0.7331; train_kl_reg_loss: 115132.2591; train_edge_recon_loss: 3529588.9773; train_gene_expr_recon_loss: 14587205.5455; train_masked_gp_l1_reg_loss: 146520.0741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 206976.1250; train_chrom_access_recon_loss: 3527910.6705; train_global_loss: 22113333.7273; train_optim_loss: 22113333.7273; val_kl_reg_loss: 108813.8096; val_edge_recon_loss: 4038301.9688; val_gene_expr_recon_loss: 14357783.5000; val_masked_gp_l1_reg_loss: 146861.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189717.7500; val_chrom_access_recon_loss: 3502369.4375; val_global_loss: 22343849.5000; val_optim_loss: 22343849.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8258; val_auprc_score: 0.8048; val_best_acc_score: 0.7112; val_best_f1_score: 0.7624; train_kl_reg_loss: 107850.2157; train_edge_recon_loss: 3517831.7348; train_gene_expr_recon_loss: 14495816.0758; train_masked_gp_l1_reg_loss: 147818.3248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 177702.1577; train_chrom_access_recon_loss: 3506726.1061; train_global_loss: 21953744.7576; train_optim_loss: 21953744.7576; val_kl_reg_loss: 103127.5430; val_edge_recon_loss: 3959898.2812; val_gene_expr_recon_loss: 14256094.3750; val_masked_gp_l1_reg_loss: 149339.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168444.9844; val_chrom_access_recon_loss: 3483329.8750; val_global_loss: 22120233.7500; val_optim_loss: 22120233.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8765; val_auprc_score: 0.8561; val_best_acc_score: 0.7982; val_best_f1_score: 0.8109; train_kl_reg_loss: 93829.5397; train_edge_recon_loss: 3438619.2879; train_gene_expr_recon_loss: 14415489.3182; train_masked_gp_l1_reg_loss: 151441.1482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163137.8336; train_chrom_access_recon_loss: 3489040.4697; train_global_loss: 21751557.7273; train_optim_loss: 21751557.7273; val_kl_reg_loss: 86805.8154; val_edge_recon_loss: 3382474.8125; val_gene_expr_recon_loss: 14317284.8750; val_masked_gp_l1_reg_loss: 154814.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158593.2656; val_chrom_access_recon_loss: 3495093.2188; val_global_loss: 21595067.5000; val_optim_loss: 21595067.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8494; val_auprc_score: 0.8057; val_best_acc_score: 0.7700; val_best_f1_score: 0.7956; train_kl_reg_loss: 118934.4504; train_edge_recon_loss: 3063568.3333; train_gene_expr_recon_loss: 14367858.9848; train_masked_gp_l1_reg_loss: 159616.2500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153915.3736; train_chrom_access_recon_loss: 3470304.8750; train_global_loss: 21334198.2121; train_optim_loss: 21334198.2121; val_kl_reg_loss: 133481.2480; val_edge_recon_loss: 2973177.0625; val_gene_expr_recon_loss: 14169509.7500; val_masked_gp_l1_reg_loss: 163799.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149498.1562; val_chrom_access_recon_loss: 3461218.4062; val_global_loss: 21050685.0000; val_optim_loss: 21050685.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8566; val_auprc_score: 0.8200; val_best_acc_score: 0.7891; val_best_f1_score: 0.8137; train_kl_reg_loss: 132304.2835; train_edge_recon_loss: 2956595.3447; train_gene_expr_recon_loss: 14293518.0152; train_masked_gp_l1_reg_loss: 165469.3087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144097.4598; train_chrom_access_recon_loss: 3456595.9697; train_global_loss: 21148580.1515; train_optim_loss: 21148580.1515; val_kl_reg_loss: 135164.5781; val_edge_recon_loss: 2914647.4375; val_gene_expr_recon_loss: 14128366.7500; val_masked_gp_l1_reg_loss: 167608.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139687.0625; val_chrom_access_recon_loss: 3429156.1250; val_global_loss: 20914631.5000; val_optim_loss: 20914631.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8719; val_auprc_score: 0.8335; val_best_acc_score: 0.8055; val_best_f1_score: 0.8226; train_kl_reg_loss: 137734.8806; train_edge_recon_loss: 2901712.1818; train_gene_expr_recon_loss: 14232944.6061; train_masked_gp_l1_reg_loss: 169406.3672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137225.1113; train_chrom_access_recon_loss: 3441466.2917; train_global_loss: 21020489.3333; train_optim_loss: 21020489.3333; val_kl_reg_loss: 137299.7969; val_edge_recon_loss: 2902520.9688; val_gene_expr_recon_loss: 14040994.5000; val_masked_gp_l1_reg_loss: 170758.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134956.9375; val_chrom_access_recon_loss: 3427616.5312; val_global_loss: 20814146.5000; val_optim_loss: 20814146.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8689; val_auprc_score: 0.8271; val_best_acc_score: 0.8006; val_best_f1_score: 0.8221; train_kl_reg_loss: 137727.1948; train_edge_recon_loss: 2895753.1439; train_gene_expr_recon_loss: 14165817.9848; train_masked_gp_l1_reg_loss: 172225.8733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133358.8696; train_chrom_access_recon_loss: 3426569.5000; train_global_loss: 20931452.7879; train_optim_loss: 20931452.7879; val_kl_reg_loss: 137845.0977; val_edge_recon_loss: 2913657.4375; val_gene_expr_recon_loss: 13865738.3750; val_masked_gp_l1_reg_loss: 173753.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132691.4062; val_chrom_access_recon_loss: 3411028.5312; val_global_loss: 20634714.7500; val_optim_loss: 20634714.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8787; val_auprc_score: 0.8445; val_best_acc_score: 0.8060; val_best_f1_score: 0.8210; train_kl_reg_loss: 138021.7428; train_edge_recon_loss: 2879024.9053; train_gene_expr_recon_loss: 14105082.3788; train_masked_gp_l1_reg_loss: 174885.6783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131380.7908; train_chrom_access_recon_loss: 3414708.5076; train_global_loss: 20843104.0909; train_optim_loss: 20843104.0909; val_kl_reg_loss: 135796.9121; val_edge_recon_loss: 2927613.6875; val_gene_expr_recon_loss: 13830336.6250; val_masked_gp_l1_reg_loss: 176430.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130767.6719; val_chrom_access_recon_loss: 3364079.4688; val_global_loss: 20565025.0000; val_optim_loss: 20565025.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8892; val_auprc_score: 0.8480; val_best_acc_score: 0.8305; val_best_f1_score: 0.8422; train_kl_reg_loss: 135905.0601; train_edge_recon_loss: 2864241.8902; train_gene_expr_recon_loss: 14049749.5606; train_masked_gp_l1_reg_loss: 177155.4723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129842.6193; train_chrom_access_recon_loss: 3402172.6705; train_global_loss: 20759067.2424; train_optim_loss: 20759067.2424; val_kl_reg_loss: 136118.3145; val_edge_recon_loss: 2850912.4062; val_gene_expr_recon_loss: 13783734.5000; val_masked_gp_l1_reg_loss: 178578.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129077.0547; val_chrom_access_recon_loss: 3367637.5312; val_global_loss: 20446058.5000; val_optim_loss: 20446058.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8910; val_auprc_score: 0.8510; val_best_acc_score: 0.8345; val_best_f1_score: 0.8479; train_kl_reg_loss: 134471.9737; train_edge_recon_loss: 2843875.8750; train_gene_expr_recon_loss: 14006739.5000; train_masked_gp_l1_reg_loss: 179665.4545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128096.8840; train_chrom_access_recon_loss: 3388047.9697; train_global_loss: 20680897.6667; train_optim_loss: 20680897.6667; val_kl_reg_loss: 135626.8926; val_edge_recon_loss: 2871473.9062; val_gene_expr_recon_loss: 13892827.5000; val_masked_gp_l1_reg_loss: 180796.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127448.3047; val_chrom_access_recon_loss: 3383864.6875; val_global_loss: 20592037.2500; val_optim_loss: 20592037.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9082; val_auprc_score: 0.8794; val_best_acc_score: 0.8434; val_best_f1_score: 0.8533; train_kl_reg_loss: 133296.1397; train_edge_recon_loss: 2852695.4091; train_gene_expr_recon_loss: 13940764.1818; train_masked_gp_l1_reg_loss: 181862.9841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127093.9451; train_chrom_access_recon_loss: 3375425.6288; train_global_loss: 20611138.3333; train_optim_loss: 20611138.3333; val_kl_reg_loss: 134300.0938; val_edge_recon_loss: 2873822.1250; val_gene_expr_recon_loss: 13877740.6250; val_masked_gp_l1_reg_loss: 182617.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125782.2422; val_chrom_access_recon_loss: 3359093.9375; val_global_loss: 20553356.7500; val_optim_loss: 20553356.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9089; val_auprc_score: 0.8785; val_best_acc_score: 0.8469; val_best_f1_score: 0.8557; train_kl_reg_loss: 133369.6245; train_edge_recon_loss: 2829654.2311; train_gene_expr_recon_loss: 13924839.6061; train_masked_gp_l1_reg_loss: 183425.8783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125266.1142; train_chrom_access_recon_loss: 3370394.8333; train_global_loss: 20566950.0606; train_optim_loss: 20566950.0606; val_kl_reg_loss: 127870.7354; val_edge_recon_loss: 2868980.7812; val_gene_expr_recon_loss: 13795302.6250; val_masked_gp_l1_reg_loss: 184304.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125400.3125; val_chrom_access_recon_loss: 3400980.8438; val_global_loss: 20502839.0000; val_optim_loss: 20502839.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9090; val_auprc_score: 0.8792; val_best_acc_score: 0.8495; val_best_f1_score: 0.8582; train_kl_reg_loss: 134250.3043; train_edge_recon_loss: 2826647.6174; train_gene_expr_recon_loss: 13879000.7727; train_masked_gp_l1_reg_loss: 184884.7079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124267.4033; train_chrom_access_recon_loss: 3359190.9659; train_global_loss: 20508241.7273; train_optim_loss: 20508241.7273; val_kl_reg_loss: 138577.5566; val_edge_recon_loss: 2838445.4375; val_gene_expr_recon_loss: 13714838.2500; val_masked_gp_l1_reg_loss: 185142.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122804.4141; val_chrom_access_recon_loss: 3364612.1562; val_global_loss: 20364420.0000; val_optim_loss: 20364420.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9174; val_auprc_score: 0.8968; val_best_acc_score: 0.8525; val_best_f1_score: 0.8612; train_kl_reg_loss: 130613.7095; train_edge_recon_loss: 2816787.1970; train_gene_expr_recon_loss: 13845515.1515; train_masked_gp_l1_reg_loss: 185960.0376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122719.1064; train_chrom_access_recon_loss: 3349382.9356; train_global_loss: 20450978.1818; train_optim_loss: 20450978.1818; val_kl_reg_loss: 131384.6562; val_edge_recon_loss: 2845985.2500; val_gene_expr_recon_loss: 13661231.3750; val_masked_gp_l1_reg_loss: 186731.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122525.9688; val_chrom_access_recon_loss: 3342639.6562; val_global_loss: 20290498.0000; val_optim_loss: 20290498.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9165; val_auprc_score: 0.8843; val_best_acc_score: 0.8581; val_best_f1_score: 0.8671; train_kl_reg_loss: 132262.6222; train_edge_recon_loss: 2815636.4205; train_gene_expr_recon_loss: 13806662.9545; train_masked_gp_l1_reg_loss: 187183.7218; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121992.3674; train_chrom_access_recon_loss: 3338860.1174; train_global_loss: 20402598.0606; train_optim_loss: 20402598.0606; val_kl_reg_loss: 139591.4883; val_edge_recon_loss: 2839936.0000; val_gene_expr_recon_loss: 13646045.8750; val_masked_gp_l1_reg_loss: 187404.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121675.0469; val_chrom_access_recon_loss: 3356758.6562; val_global_loss: 20291412.0000; val_optim_loss: 20291412.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9162; val_auprc_score: 0.8816; val_best_acc_score: 0.8573; val_best_f1_score: 0.8653; train_kl_reg_loss: 132141.1694; train_edge_recon_loss: 2802702.8674; train_gene_expr_recon_loss: 13768034.5000; train_masked_gp_l1_reg_loss: 187840.2455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121344.5328; train_chrom_access_recon_loss: 3334132.6932; train_global_loss: 20346196.0303; train_optim_loss: 20346196.0303; val_kl_reg_loss: 128231.3418; val_edge_recon_loss: 2854157.9375; val_gene_expr_recon_loss: 13576884.6250; val_masked_gp_l1_reg_loss: 188497.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121171.1875; val_chrom_access_recon_loss: 3334456.2500; val_global_loss: 20203399.2500; val_optim_loss: 20203399.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9187; val_auprc_score: 0.8891; val_best_acc_score: 0.8587; val_best_f1_score: 0.8692; train_kl_reg_loss: 130069.2108; train_edge_recon_loss: 2800572.2273; train_gene_expr_recon_loss: 13726119.9545; train_masked_gp_l1_reg_loss: 188804.0634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120896.4575; train_chrom_access_recon_loss: 3323244.0833; train_global_loss: 20289706.0000; train_optim_loss: 20289706.0000; val_kl_reg_loss: 131757.6416; val_edge_recon_loss: 2816737.0312; val_gene_expr_recon_loss: 13582213.6250; val_masked_gp_l1_reg_loss: 188903.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120849.1328; val_chrom_access_recon_loss: 3311831.9688; val_global_loss: 20152293.0000; val_optim_loss: 20152293.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9280; val_auprc_score: 0.9099; val_best_acc_score: 0.8614; val_best_f1_score: 0.8681; train_kl_reg_loss: 131718.9611; train_edge_recon_loss: 2792921.9659; train_gene_expr_recon_loss: 13710796.4091; train_masked_gp_l1_reg_loss: 189174.7259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120568.3068; train_chrom_access_recon_loss: 3318060.5644; train_global_loss: 20263241.1515; train_optim_loss: 20263241.1515; val_kl_reg_loss: 133143.7930; val_edge_recon_loss: 2823153.4688; val_gene_expr_recon_loss: 13597305.6250; val_masked_gp_l1_reg_loss: 189915.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120335.7969; val_chrom_access_recon_loss: 3339607.4688; val_global_loss: 20203462.0000; val_optim_loss: 20203462.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9264; val_auprc_score: 0.9021; val_best_acc_score: 0.8646; val_best_f1_score: 0.8735; train_kl_reg_loss: 130795.7966; train_edge_recon_loss: 2787719.0038; train_gene_expr_recon_loss: 13673571.2273; train_masked_gp_l1_reg_loss: 189792.9865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120246.3281; train_chrom_access_recon_loss: 3307479.4583; train_global_loss: 20209604.6061; train_optim_loss: 20209604.6061; val_kl_reg_loss: 128005.3760; val_edge_recon_loss: 2811822.2812; val_gene_expr_recon_loss: 13544035.3750; val_masked_gp_l1_reg_loss: 190294.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120481.8672; val_chrom_access_recon_loss: 3298671.9062; val_global_loss: 20093311.5000; val_optim_loss: 20093311.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9322; val_auprc_score: 0.9147; val_best_acc_score: 0.8673; val_best_f1_score: 0.8742; train_kl_reg_loss: 130808.7802; train_edge_recon_loss: 2776667.1023; train_gene_expr_recon_loss: 13655163.7879; train_masked_gp_l1_reg_loss: 190296.6456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120460.2615; train_chrom_access_recon_loss: 3301486.2083; train_global_loss: 20174882.6970; train_optim_loss: 20174882.6970; val_kl_reg_loss: 131497.9766; val_edge_recon_loss: 2800405.5000; val_gene_expr_recon_loss: 13609748.7500; val_masked_gp_l1_reg_loss: 190678.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120651.1562; val_chrom_access_recon_loss: 3339488.3750; val_global_loss: 20192470.7500; val_optim_loss: 20192470.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9356; val_auprc_score: 0.9140; val_best_acc_score: 0.8735; val_best_f1_score: 0.8780; train_kl_reg_loss: 128031.2573; train_edge_recon_loss: 2783751.3068; train_gene_expr_recon_loss: 13628815.1818; train_masked_gp_l1_reg_loss: 190897.3170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121060.3722; train_chrom_access_recon_loss: 3295179.1061; train_global_loss: 20147734.8788; train_optim_loss: 20147734.8788; val_kl_reg_loss: 128949.3135; val_edge_recon_loss: 2810793.2812; val_gene_expr_recon_loss: 13579074.5000; val_masked_gp_l1_reg_loss: 191468.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121363.8516; val_chrom_access_recon_loss: 3314346.6875; val_global_loss: 20145996.0000; val_optim_loss: 20145996.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9296; val_auprc_score: 0.9026; val_best_acc_score: 0.8708; val_best_f1_score: 0.8768; train_kl_reg_loss: 128894.1164; train_edge_recon_loss: 2788274.0000; train_gene_expr_recon_loss: 13595108.9545; train_masked_gp_l1_reg_loss: 191560.3584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121630.9276; train_chrom_access_recon_loss: 3287794.1856; train_global_loss: 20113262.5152; train_optim_loss: 20113262.5152; val_kl_reg_loss: 127346.7520; val_edge_recon_loss: 2805739.6875; val_gene_expr_recon_loss: 13433751.6250; val_masked_gp_l1_reg_loss: 191622.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121996.9062; val_chrom_access_recon_loss: 3276618.7812; val_global_loss: 19957076.2500; val_optim_loss: 19957076.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9374; val_auprc_score: 0.9133; val_best_acc_score: 0.8807; val_best_f1_score: 0.8865; train_kl_reg_loss: 140154.5677; train_edge_recon_loss: 2830258.0568; train_gene_expr_recon_loss: 13171039.1515; train_masked_gp_l1_reg_loss: 190000.1084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121536.9345; train_chrom_access_recon_loss: 3211832.5682; train_global_loss: 19664821.3030; train_optim_loss: 19664821.3030; val_kl_reg_loss: 91259.2422; val_edge_recon_loss: 2826105.0938; val_gene_expr_recon_loss: 13041094.3750; val_masked_gp_l1_reg_loss: 189843.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120810.8750; val_chrom_access_recon_loss: 3180051.6562; val_global_loss: 19449165.2500; val_optim_loss: 19449165.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9398; val_auprc_score: 0.9094; val_best_acc_score: 0.8904; val_best_f1_score: 0.8951; train_kl_reg_loss: 135758.6921; train_edge_recon_loss: 2796129.5530; train_gene_expr_recon_loss: 13124628.7273; train_masked_gp_l1_reg_loss: 190000.7929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119666.1990; train_chrom_access_recon_loss: 3177662.3295; train_global_loss: 19543846.3636; train_optim_loss: 19543846.3636; val_kl_reg_loss: 95018.5254; val_edge_recon_loss: 2787108.9062; val_gene_expr_recon_loss: 13051113.1250; val_masked_gp_l1_reg_loss: 190058.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119217.3125; val_chrom_access_recon_loss: 3206600.2500; val_global_loss: 19449116.0000; val_optim_loss: 19449116.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9373; val_auprc_score: 0.9144; val_best_acc_score: 0.8823; val_best_f1_score: 0.8884; train_kl_reg_loss: 127670.1410; train_edge_recon_loss: 2783021.0114; train_gene_expr_recon_loss: 13080890.9848; train_masked_gp_l1_reg_loss: 189606.0412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118677.9111; train_chrom_access_recon_loss: 3168875.8295; train_global_loss: 19468741.8182; train_optim_loss: 19468741.8182; val_kl_reg_loss: 102100.5420; val_edge_recon_loss: 2820744.3438; val_gene_expr_recon_loss: 13027272.2500; val_masked_gp_l1_reg_loss: 189439.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117929.8281; val_chrom_access_recon_loss: 3176669.7500; val_global_loss: 19434157.0000; val_optim_loss: 19434157.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9422; val_auprc_score: 0.9223; val_best_acc_score: 0.8837; val_best_f1_score: 0.8910; train_kl_reg_loss: 125314.2976; train_edge_recon_loss: 2780247.8864; train_gene_expr_recon_loss: 13063827.8788; train_masked_gp_l1_reg_loss: 188763.5999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117503.0165; train_chrom_access_recon_loss: 3163018.4545; train_global_loss: 19438675.1212; train_optim_loss: 19438675.1212; val_kl_reg_loss: 108640.2666; val_edge_recon_loss: 2785271.9062; val_gene_expr_recon_loss: 13058955.0000; val_masked_gp_l1_reg_loss: 188057.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117019.6328; val_chrom_access_recon_loss: 3189342.0000; val_global_loss: 19447286.2500; val_optim_loss: 19447286.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9411; val_auprc_score: 0.9211; val_best_acc_score: 0.8853; val_best_f1_score: 0.8909; train_kl_reg_loss: 120676.7281; train_edge_recon_loss: 2766902.6477; train_gene_expr_recon_loss: 13024355.1970; train_masked_gp_l1_reg_loss: 187433.3542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117171.4598; train_chrom_access_recon_loss: 3156108.0568; train_global_loss: 19372647.3030; train_optim_loss: 19372647.3030; val_kl_reg_loss: 108390.0791; val_edge_recon_loss: 2806533.0000; val_gene_expr_recon_loss: 12864441.0000; val_masked_gp_l1_reg_loss: 187143.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116220.5781; val_chrom_access_recon_loss: 3139555.5625; val_global_loss: 19222284.2500; val_optim_loss: 19222284.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9433; val_auprc_score: 0.9222; val_best_acc_score: 0.8850; val_best_f1_score: 0.8897; train_kl_reg_loss: 118868.3117; train_edge_recon_loss: 2758759.7500; train_gene_expr_recon_loss: 13016438.5152; train_masked_gp_l1_reg_loss: 186638.4065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116278.9022; train_chrom_access_recon_loss: 3150916.9924; train_global_loss: 19347900.8485; train_optim_loss: 19347900.8485; val_kl_reg_loss: 109311.4561; val_edge_recon_loss: 2783560.7188; val_gene_expr_recon_loss: 12823923.2500; val_masked_gp_l1_reg_loss: 186312.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116301.2812; val_chrom_access_recon_loss: 3143645.9062; val_global_loss: 19163054.2500; val_optim_loss: 19163054.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9417; val_auprc_score: 0.9183; val_best_acc_score: 0.8880; val_best_f1_score: 0.8943; train_kl_reg_loss: 119023.0322; train_edge_recon_loss: 2766516.7083; train_gene_expr_recon_loss: 12994096.0758; train_masked_gp_l1_reg_loss: 185781.4882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115734.1723; train_chrom_access_recon_loss: 3146499.1591; train_global_loss: 19327650.5758; train_optim_loss: 19327650.5758; val_kl_reg_loss: 112617.6279; val_edge_recon_loss: 2785129.2188; val_gene_expr_recon_loss: 12827814.2500; val_masked_gp_l1_reg_loss: 185435.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116045.1719; val_chrom_access_recon_loss: 3145380.3438; val_global_loss: 19172421.5000; val_optim_loss: 19172421.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9425; val_auprc_score: 0.9227; val_best_acc_score: 0.8882; val_best_f1_score: 0.8943; train_kl_reg_loss: 118902.8184; train_edge_recon_loss: 2757651.7273; train_gene_expr_recon_loss: 12982041.2121; train_masked_gp_l1_reg_loss: 185051.0286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115283.5041; train_chrom_access_recon_loss: 3142527.6591; train_global_loss: 19301457.7879; train_optim_loss: 19301457.7879; val_kl_reg_loss: 115753.5566; val_edge_recon_loss: 2793584.1562; val_gene_expr_recon_loss: 12964538.8750; val_masked_gp_l1_reg_loss: 184782.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115140.8984; val_chrom_access_recon_loss: 3143356.2812; val_global_loss: 19317156.2500; val_optim_loss: 19317156.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9428; val_auprc_score: 0.9194; val_best_acc_score: 0.8893; val_best_f1_score: 0.8958; train_kl_reg_loss: 119458.3482; train_edge_recon_loss: 2750548.5947; train_gene_expr_recon_loss: 12958330.2424; train_masked_gp_l1_reg_loss: 184366.7848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115070.2738; train_chrom_access_recon_loss: 3140346.8598; train_global_loss: 19268121.0606; train_optim_loss: 19268121.0606; val_kl_reg_loss: 114641.9883; val_edge_recon_loss: 2810599.3438; val_gene_expr_recon_loss: 12708732.8750; val_masked_gp_l1_reg_loss: 184294.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114640.8203; val_chrom_access_recon_loss: 3120826.8125; val_global_loss: 19053736.2500; val_optim_loss: 19053736.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9551; val_auprc_score: 0.9412; val_best_acc_score: 0.9003; val_best_f1_score: 0.9040; train_kl_reg_loss: 119690.8426; train_edge_recon_loss: 2746057.2311; train_gene_expr_recon_loss: 12933916.5455; train_masked_gp_l1_reg_loss: 183912.4759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114676.9530; train_chrom_access_recon_loss: 3136176.3788; train_global_loss: 19234430.4848; train_optim_loss: 19234430.4848; val_kl_reg_loss: 116876.6826; val_edge_recon_loss: 2779548.0000; val_gene_expr_recon_loss: 12825162.5000; val_masked_gp_l1_reg_loss: 183659.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114611.4688; val_chrom_access_recon_loss: 3138862.5625; val_global_loss: 19158720.7500; val_optim_loss: 19158720.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9440; val_auprc_score: 0.9224; val_best_acc_score: 0.8931; val_best_f1_score: 0.8991; train_kl_reg_loss: 117827.2934; train_edge_recon_loss: 2753656.7576; train_gene_expr_recon_loss: 12928453.4697; train_masked_gp_l1_reg_loss: 183546.4631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114649.1178; train_chrom_access_recon_loss: 3134380.4735; train_global_loss: 19232513.5455; train_optim_loss: 19232513.5455; val_kl_reg_loss: 120737.5459; val_edge_recon_loss: 2791419.4375; val_gene_expr_recon_loss: 12720805.8750; val_masked_gp_l1_reg_loss: 183547.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114897.7031; val_chrom_access_recon_loss: 3115003.9688; val_global_loss: 19046411.7500; val_optim_loss: 19046411.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9497; val_auprc_score: 0.9301; val_best_acc_score: 0.9022; val_best_f1_score: 0.9046; train_kl_reg_loss: 121019.1676; train_edge_recon_loss: 2741627.7121; train_gene_expr_recon_loss: 12916211.7879; train_masked_gp_l1_reg_loss: 183326.9420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114678.3492; train_chrom_access_recon_loss: 3130557.6212; train_global_loss: 19207421.6061; train_optim_loss: 19207421.6061; val_kl_reg_loss: 118611.5625; val_edge_recon_loss: 2743804.2188; val_gene_expr_recon_loss: 12737183.5000; val_masked_gp_l1_reg_loss: 183143.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115071.2109; val_chrom_access_recon_loss: 3110311.5938; val_global_loss: 19008124.7500; val_optim_loss: 19008124.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9538; val_auprc_score: 0.9362; val_best_acc_score: 0.8984; val_best_f1_score: 0.9032; train_kl_reg_loss: 118568.8493; train_edge_recon_loss: 2741671.1818; train_gene_expr_recon_loss: 12893903.7727; train_masked_gp_l1_reg_loss: 183093.0715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114664.8014; train_chrom_access_recon_loss: 3125434.4242; train_global_loss: 19177336.1515; train_optim_loss: 19177336.1515; val_kl_reg_loss: 120430.3271; val_edge_recon_loss: 2763388.7500; val_gene_expr_recon_loss: 12715953.0000; val_masked_gp_l1_reg_loss: 182852.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113974.4141; val_chrom_access_recon_loss: 3120930.0312; val_global_loss: 19017528.0000; val_optim_loss: 19017528.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9541; val_auprc_score: 0.9404; val_best_acc_score: 0.8982; val_best_f1_score: 0.9032; train_kl_reg_loss: 118974.7848; train_edge_recon_loss: 2739999.1326; train_gene_expr_recon_loss: 12878051.5000; train_masked_gp_l1_reg_loss: 182737.5417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114357.8311; train_chrom_access_recon_loss: 3122464.6402; train_global_loss: 19156585.4242; train_optim_loss: 19156585.4242; val_kl_reg_loss: 117676.4854; val_edge_recon_loss: 2778171.1562; val_gene_expr_recon_loss: 12733269.1250; val_masked_gp_l1_reg_loss: 182567.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114040.8594; val_chrom_access_recon_loss: 3123211.8438; val_global_loss: 19048937.2500; val_optim_loss: 19048937.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9518; val_auprc_score: 0.9289; val_best_acc_score: 0.8990; val_best_f1_score: 0.9040; train_kl_reg_loss: 117463.0719; train_edge_recon_loss: 2742644.3295; train_gene_expr_recon_loss: 12862854.6061; train_masked_gp_l1_reg_loss: 182508.2431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114412.6387; train_chrom_access_recon_loss: 3115379.5909; train_global_loss: 19135262.5758; train_optim_loss: 19135262.5758; val_kl_reg_loss: 115475.9473; val_edge_recon_loss: 2760388.9688; val_gene_expr_recon_loss: 12733079.3750; val_masked_gp_l1_reg_loss: 182620.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114628.0234; val_chrom_access_recon_loss: 3110014.8438; val_global_loss: 19016208.2500; val_optim_loss: 19016208.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9491; val_auprc_score: 0.9297; val_best_acc_score: 0.8992; val_best_f1_score: 0.9039; train_kl_reg_loss: 118736.1688; train_edge_recon_loss: 2740213.5341; train_gene_expr_recon_loss: 12837003.3182; train_masked_gp_l1_reg_loss: 182343.6418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114286.0206; train_chrom_access_recon_loss: 3109817.7121; train_global_loss: 19102400.4242; train_optim_loss: 19102400.4242; val_kl_reg_loss: 120236.1631; val_edge_recon_loss: 2772051.2188; val_gene_expr_recon_loss: 12732396.7500; val_masked_gp_l1_reg_loss: 182416.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114121.3672; val_chrom_access_recon_loss: 3115421.7500; val_global_loss: 19036644.0000; val_optim_loss: 19036644.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9505; val_auprc_score: 0.9320; val_best_acc_score: 0.8971; val_best_f1_score: 0.9018; train_kl_reg_loss: 120311.6437; train_edge_recon_loss: 2739833.1212; train_gene_expr_recon_loss: 12827904.0455; train_masked_gp_l1_reg_loss: 179164.3880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84224.9981; train_chrom_access_recon_loss: 3105114.3674; train_global_loss: 19056552.6364; train_optim_loss: 19056552.6364; val_kl_reg_loss: 120262.9785; val_edge_recon_loss: 2777446.5625; val_gene_expr_recon_loss: 12753230.6250; val_masked_gp_l1_reg_loss: 177969.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78773.0078; val_chrom_access_recon_loss: 3112176.7188; val_global_loss: 19019859.5000; val_optim_loss: 19019859.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9539; val_auprc_score: 0.9373; val_best_acc_score: 0.9033; val_best_f1_score: 0.9074; train_kl_reg_loss: 120401.0936; train_edge_recon_loss: 2737113.4470; train_gene_expr_recon_loss: 12817956.0152; train_masked_gp_l1_reg_loss: 177720.1359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78454.9020; train_chrom_access_recon_loss: 3096630.6818; train_global_loss: 19028276.3636; train_optim_loss: 19028276.3636; val_kl_reg_loss: 122256.2236; val_edge_recon_loss: 2739874.5000; val_gene_expr_recon_loss: 12623074.2500; val_masked_gp_l1_reg_loss: 177573.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78233.1797; val_chrom_access_recon_loss: 3077398.0000; val_global_loss: 18818410.5000; val_optim_loss: 18818410.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9550; val_auprc_score: 0.9340; val_best_acc_score: 0.9022; val_best_f1_score: 0.9064; train_kl_reg_loss: 121430.2189; train_edge_recon_loss: 2743542.9318; train_gene_expr_recon_loss: 12818718.7424; train_masked_gp_l1_reg_loss: 177450.0331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78019.5212; train_chrom_access_recon_loss: 3096414.1818; train_global_loss: 19035575.6061; train_optim_loss: 19035575.6061; val_kl_reg_loss: 121496.1934; val_edge_recon_loss: 2763820.9688; val_gene_expr_recon_loss: 12788711.0000; val_masked_gp_l1_reg_loss: 177364.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77783.5859; val_chrom_access_recon_loss: 3166000.2500; val_global_loss: 19095176.2500; val_optim_loss: 19095176.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9570; val_auprc_score: 0.9390; val_best_acc_score: 0.9065; val_best_f1_score: 0.9087; train_kl_reg_loss: 121175.9688; train_edge_recon_loss: 2730412.9848; train_gene_expr_recon_loss: 12812633.9545; train_masked_gp_l1_reg_loss: 177332.6998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77720.7276; train_chrom_access_recon_loss: 3099129.7614; train_global_loss: 19018406.1212; train_optim_loss: 19018406.1212; val_kl_reg_loss: 122276.8301; val_edge_recon_loss: 2750478.0938; val_gene_expr_recon_loss: 12766138.8750; val_masked_gp_l1_reg_loss: 177260.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77577.4766; val_chrom_access_recon_loss: 3094802.5000; val_global_loss: 18988534.2500; val_optim_loss: 18988534.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9516; val_auprc_score: 0.9333; val_best_acc_score: 0.9035; val_best_f1_score: 0.9072; train_kl_reg_loss: 121322.1539; train_edge_recon_loss: 2742441.1667; train_gene_expr_recon_loss: 12805431.0758; train_masked_gp_l1_reg_loss: 177184.9718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77453.6261; train_chrom_access_recon_loss: 3095452.3144; train_global_loss: 19019285.2121; train_optim_loss: 19019285.2121; val_kl_reg_loss: 120488.3633; val_edge_recon_loss: 2789129.5938; val_gene_expr_recon_loss: 12769817.7500; val_masked_gp_l1_reg_loss: 177161.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77485.6562; val_chrom_access_recon_loss: 3080793.3125; val_global_loss: 19014877.0000; val_optim_loss: 19014877.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9510; val_auprc_score: 0.9351; val_best_acc_score: 0.8995; val_best_f1_score: 0.9042; train_kl_reg_loss: 120830.8864; train_edge_recon_loss: 2735535.3636; train_gene_expr_recon_loss: 12797074.9697; train_masked_gp_l1_reg_loss: 177108.5419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77289.3095; train_chrom_access_recon_loss: 3094623.8220; train_global_loss: 19002462.9394; train_optim_loss: 19002462.9394; val_kl_reg_loss: 120285.4277; val_edge_recon_loss: 2780220.6875; val_gene_expr_recon_loss: 12702714.6250; val_masked_gp_l1_reg_loss: 177077.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77208.3438; val_chrom_access_recon_loss: 3105712.7188; val_global_loss: 18963219.5000; val_optim_loss: 18963219.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9506; val_auprc_score: 0.9328; val_best_acc_score: 0.8984; val_best_f1_score: 0.9026; train_kl_reg_loss: 120603.9949; train_edge_recon_loss: 2734190.3598; train_gene_expr_recon_loss: 12793049.6970; train_masked_gp_l1_reg_loss: 176748.9827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73873.9097; train_chrom_access_recon_loss: 3093043.7879; train_global_loss: 18991510.7879; train_optim_loss: 18991510.7879; val_kl_reg_loss: 120955.3350; val_edge_recon_loss: 2781434.6250; val_gene_expr_recon_loss: 12584732.5000; val_masked_gp_l1_reg_loss: 176620.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73257.3984; val_chrom_access_recon_loss: 3095671.9688; val_global_loss: 18832672.5000; val_optim_loss: 18832672.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9493; val_auprc_score: 0.9266; val_best_acc_score: 0.8995; val_best_f1_score: 0.9042; train_kl_reg_loss: 121005.5309; train_edge_recon_loss: 2729065.1288; train_gene_expr_recon_loss: 12802629.2576; train_masked_gp_l1_reg_loss: 176582.5294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73211.4078; train_chrom_access_recon_loss: 3095917.0227; train_global_loss: 18998410.8788; train_optim_loss: 18998410.8788; val_kl_reg_loss: 121576.9512; val_edge_recon_loss: 2768397.1250; val_gene_expr_recon_loss: 12762441.3750; val_masked_gp_l1_reg_loss: 176552.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73182.4375; val_chrom_access_recon_loss: 3090928.0625; val_global_loss: 18993078.5000; val_optim_loss: 18993078.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9520; val_auprc_score: 0.9315; val_best_acc_score: 0.9025; val_best_f1_score: 0.9065; train_kl_reg_loss: 121218.4547; train_edge_recon_loss: 2730646.0947; train_gene_expr_recon_loss: 12803209.5758; train_masked_gp_l1_reg_loss: 176534.9534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73155.7360; train_chrom_access_recon_loss: 3093627.7462; train_global_loss: 18998392.4848; train_optim_loss: 18998392.4848; val_kl_reg_loss: 121092.8408; val_edge_recon_loss: 2768974.2812; val_gene_expr_recon_loss: 12728208.0000; val_masked_gp_l1_reg_loss: 176518.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73126.7891; val_chrom_access_recon_loss: 3082818.5000; val_global_loss: 18950739.7500; val_optim_loss: 18950739.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9510; val_auprc_score: 0.9256; val_best_acc_score: 0.9011; val_best_f1_score: 0.9046; train_kl_reg_loss: 121406.4593; train_edge_recon_loss: 2736896.5530; train_gene_expr_recon_loss: 12791009.4848; train_masked_gp_l1_reg_loss: 176509.3655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73113.0033; train_chrom_access_recon_loss: 3091836.3939; train_global_loss: 18990771.3333; train_optim_loss: 18990771.3333; val_kl_reg_loss: 120616.0537; val_edge_recon_loss: 2776923.8750; val_gene_expr_recon_loss: 12725072.1250; val_masked_gp_l1_reg_loss: 176498.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73099.6406; val_chrom_access_recon_loss: 3102762.0000; val_global_loss: 18974972.0000; val_optim_loss: 18974972.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 30 min 46 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9490
val AUPRC score: 0.9218
val best accuracy score: 0.9022
val best F1 score: 0.9057
val target rna MSE score: 1.1012
val source rna MSE score: 0.4034
val target atac MSE score: 0.4821
val source atac MSE score: 0.1045
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
