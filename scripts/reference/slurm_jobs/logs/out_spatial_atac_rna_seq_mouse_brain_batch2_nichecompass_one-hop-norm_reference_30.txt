[True]
Run timestamp: 09102023_203714_30.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_30']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7304; val_auprc_score: 0.7564; val_best_acc_score: 0.5492; val_best_f1_score: 0.6836; train_kl_reg_loss: 46273.2821; train_edge_recon_loss: 3503122.1069; train_gene_expr_recon_loss: 13513887.4733; train_masked_gp_l1_reg_loss: 123251.4692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2810653.5623; train_chrom_access_recon_loss: 2255551.4771; train_global_loss: 22252739.2977; train_optim_loss: 22252739.2977; val_kl_reg_loss: 81398.9026; val_edge_recon_loss: 4062166.0667; val_gene_expr_recon_loss: 12774313.0667; val_masked_gp_l1_reg_loss: 111847.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 459624.1250; val_chrom_access_recon_loss: 2171919.4417; val_global_loss: 19661269.6000; val_optim_loss: 19661269.6000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7932; val_auprc_score: 0.8104; val_best_acc_score: 0.7094; val_best_f1_score: 0.7171; train_kl_reg_loss: 70831.2128; train_edge_recon_loss: 3494264.5954; train_gene_expr_recon_loss: 12682408.9847; train_masked_gp_l1_reg_loss: 108534.1430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 248570.5926; train_chrom_access_recon_loss: 2167546.8702; train_global_loss: 18772156.3206; train_optim_loss: 18772156.3206; val_kl_reg_loss: 86652.5396; val_edge_recon_loss: 4016714.2500; val_gene_expr_recon_loss: 12536866.4000; val_masked_gp_l1_reg_loss: 106861.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149349.9062; val_chrom_access_recon_loss: 2143813.2250; val_global_loss: 19040258.4000; val_optim_loss: 19040258.4000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8684; val_auprc_score: 0.8632; val_best_acc_score: 0.7753; val_best_f1_score: 0.8008; train_kl_reg_loss: 66802.0533; train_edge_recon_loss: 3269809.6202; train_gene_expr_recon_loss: 12503246.2519; train_masked_gp_l1_reg_loss: 110828.9586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119852.8732; train_chrom_access_recon_loss: 2144158.3969; train_global_loss: 18214698.2137; train_optim_loss: 18214698.2137; val_kl_reg_loss: 89300.0813; val_edge_recon_loss: 3017324.9167; val_gene_expr_recon_loss: 12408419.4000; val_masked_gp_l1_reg_loss: 117769.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102017.8281; val_chrom_access_recon_loss: 2118672.6500; val_global_loss: 17853505.0667; val_optim_loss: 17853505.0667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9081; val_auprc_score: 0.8931; val_best_acc_score: 0.8313; val_best_f1_score: 0.8434; train_kl_reg_loss: 90777.8371; train_edge_recon_loss: 2895497.5382; train_gene_expr_recon_loss: 12360485.2824; train_masked_gp_l1_reg_loss: 121665.7284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96406.7725; train_chrom_access_recon_loss: 2120611.9866; train_global_loss: 17685445.1756; train_optim_loss: 17685445.1756; val_kl_reg_loss: 95931.7240; val_edge_recon_loss: 2865921.2667; val_gene_expr_recon_loss: 12301405.0000; val_masked_gp_l1_reg_loss: 123840.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92092.7422; val_chrom_access_recon_loss: 2110218.6333; val_global_loss: 17589410.5333; val_optim_loss: 17589410.5333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9261; val_auprc_score: 0.9144; val_best_acc_score: 0.8579; val_best_f1_score: 0.8663; train_kl_reg_loss: 93049.0964; train_edge_recon_loss: 2819706.1355; train_gene_expr_recon_loss: 12235309.6260; train_masked_gp_l1_reg_loss: 124626.4346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88482.1447; train_chrom_access_recon_loss: 2100022.0487; train_global_loss: 17461195.5267; train_optim_loss: 17461195.5267; val_kl_reg_loss: 93306.4042; val_edge_recon_loss: 2816105.7833; val_gene_expr_recon_loss: 12162069.5333; val_masked_gp_l1_reg_loss: 125294.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86084.5312; val_chrom_access_recon_loss: 2077708.9167; val_global_loss: 17360570.7333; val_optim_loss: 17360570.7333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9269; val_auprc_score: 0.9106; val_best_acc_score: 0.8570; val_best_f1_score: 0.8656; train_kl_reg_loss: 93594.9726; train_edge_recon_loss: 2797251.8550; train_gene_expr_recon_loss: 12136173.2748; train_masked_gp_l1_reg_loss: 125929.2973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85786.5587; train_chrom_access_recon_loss: 2086963.3817; train_global_loss: 17325699.3969; train_optim_loss: 17325699.3969; val_kl_reg_loss: 91950.0161; val_edge_recon_loss: 2841162.4000; val_gene_expr_recon_loss: 12037123.4000; val_masked_gp_l1_reg_loss: 126078.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84626.1406; val_chrom_access_recon_loss: 2061669.9083; val_global_loss: 17242610.8000; val_optim_loss: 17242610.8000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9291; val_auprc_score: 0.9144; val_best_acc_score: 0.8631; val_best_f1_score: 0.8719; train_kl_reg_loss: 91782.9129; train_edge_recon_loss: 2788856.0992; train_gene_expr_recon_loss: 12032639.0076; train_masked_gp_l1_reg_loss: 126545.3673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83189.9179; train_chrom_access_recon_loss: 2068912.3473; train_global_loss: 17191925.7099; train_optim_loss: 17191925.7099; val_kl_reg_loss: 91393.0276; val_edge_recon_loss: 2819147.7333; val_gene_expr_recon_loss: 11957582.4667; val_masked_gp_l1_reg_loss: 126821.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81980.5703; val_chrom_access_recon_loss: 2060952.5250; val_global_loss: 17137877.9333; val_optim_loss: 17137877.9333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9347; val_auprc_score: 0.9217; val_best_acc_score: 0.8674; val_best_f1_score: 0.8747; train_kl_reg_loss: 91691.2381; train_edge_recon_loss: 2791531.7462; train_gene_expr_recon_loss: 11949784.4427; train_masked_gp_l1_reg_loss: 127070.9395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80229.4758; train_chrom_access_recon_loss: 2055848.5353; train_global_loss: 17096156.3130; train_optim_loss: 17096156.3130; val_kl_reg_loss: 90561.7391; val_edge_recon_loss: 2788341.2333; val_gene_expr_recon_loss: 11910961.2000; val_masked_gp_l1_reg_loss: 127597.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79646.6797; val_chrom_access_recon_loss: 2046402.8833; val_global_loss: 17043510.8667; val_optim_loss: 17043510.8667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9383; val_auprc_score: 0.9253; val_best_acc_score: 0.8724; val_best_f1_score: 0.8802; train_kl_reg_loss: 89294.1064; train_edge_recon_loss: 2771049.8683; train_gene_expr_recon_loss: 11892337.2519; train_masked_gp_l1_reg_loss: 127738.6859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78216.5548; train_chrom_access_recon_loss: 2046316.3655; train_global_loss: 17004952.7023; train_optim_loss: 17004952.7023; val_kl_reg_loss: 85265.5359; val_edge_recon_loss: 2798964.7000; val_gene_expr_recon_loss: 11837972.9333; val_masked_gp_l1_reg_loss: 128190.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77075.4844; val_chrom_access_recon_loss: 2025902.2083; val_global_loss: 16953371.4667; val_optim_loss: 16953371.4667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9361; val_auprc_score: 0.9216; val_best_acc_score: 0.8721; val_best_f1_score: 0.8790; train_kl_reg_loss: 87872.2656; train_edge_recon_loss: 2771950.8149; train_gene_expr_recon_loss: 11836614.9924; train_masked_gp_l1_reg_loss: 128525.8615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76394.8737; train_chrom_access_recon_loss: 2037756.6345; train_global_loss: 16939115.3435; train_optim_loss: 16939115.3435; val_kl_reg_loss: 86953.6250; val_edge_recon_loss: 2806491.2000; val_gene_expr_recon_loss: 11789028.6000; val_masked_gp_l1_reg_loss: 128919.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75824.2578; val_chrom_access_recon_loss: 2043596.0083; val_global_loss: 16930813.6667; val_optim_loss: 16930813.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9457; val_auprc_score: 0.9295; val_best_acc_score: 0.8868; val_best_f1_score: 0.8914; train_kl_reg_loss: 86066.6373; train_edge_recon_loss: 2769137.3721; train_gene_expr_recon_loss: 11766108.3893; train_masked_gp_l1_reg_loss: 129027.7678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75173.1056; train_chrom_access_recon_loss: 2022298.6498; train_global_loss: 16847811.8168; train_optim_loss: 16847811.8168; val_kl_reg_loss: 90338.2286; val_edge_recon_loss: 2765626.2000; val_gene_expr_recon_loss: 11753833.2667; val_masked_gp_l1_reg_loss: 129560.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74283.1719; val_chrom_access_recon_loss: 2023709.2667; val_global_loss: 16837350.8000; val_optim_loss: 16837350.8000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9449; val_auprc_score: 0.9346; val_best_acc_score: 0.8798; val_best_f1_score: 0.8857; train_kl_reg_loss: 88613.8066; train_edge_recon_loss: 2752332.8187; train_gene_expr_recon_loss: 11724921.7252; train_masked_gp_l1_reg_loss: 129445.0757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73966.3268; train_chrom_access_recon_loss: 2016009.2481; train_global_loss: 16785288.9008; train_optim_loss: 16785288.9008; val_kl_reg_loss: 86717.6068; val_edge_recon_loss: 2767660.8000; val_gene_expr_recon_loss: 11725657.6667; val_masked_gp_l1_reg_loss: 128914.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73188.9844; val_chrom_access_recon_loss: 2007622.6583; val_global_loss: 16789761.9333; val_optim_loss: 16789761.9333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9489; val_auprc_score: 0.9359; val_best_acc_score: 0.8836; val_best_f1_score: 0.8901; train_kl_reg_loss: 86347.9911; train_edge_recon_loss: 2745107.7443; train_gene_expr_recon_loss: 11676960.8168; train_masked_gp_l1_reg_loss: 129340.4049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73168.6453; train_chrom_access_recon_loss: 2007647.6918; train_global_loss: 16718573.3130; train_optim_loss: 16718573.3130; val_kl_reg_loss: 84628.2594; val_edge_recon_loss: 2755263.4000; val_gene_expr_recon_loss: 11645092.0000; val_masked_gp_l1_reg_loss: 129173.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73076.7891; val_chrom_access_recon_loss: 1993190.3333; val_global_loss: 16680424.8000; val_optim_loss: 16680424.8000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9493; val_auprc_score: 0.9377; val_best_acc_score: 0.8890; val_best_f1_score: 0.8941; train_kl_reg_loss: 84976.7862; train_edge_recon_loss: 2739136.7290; train_gene_expr_recon_loss: 11637625.2366; train_masked_gp_l1_reg_loss: 129072.2917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72491.2996; train_chrom_access_recon_loss: 1999056.7672; train_global_loss: 16662359.0611; train_optim_loss: 16662359.0611; val_kl_reg_loss: 84490.0286; val_edge_recon_loss: 2741826.1333; val_gene_expr_recon_loss: 11637886.9333; val_masked_gp_l1_reg_loss: 129196.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72540.8516; val_chrom_access_recon_loss: 1986162.0917; val_global_loss: 16652102.4000; val_optim_loss: 16652102.4000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9543; val_auprc_score: 0.9421; val_best_acc_score: 0.8969; val_best_f1_score: 0.9010; train_kl_reg_loss: 84087.1695; train_edge_recon_loss: 2735971.0038; train_gene_expr_recon_loss: 11617405.1832; train_masked_gp_l1_reg_loss: 129241.4662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72112.5907; train_chrom_access_recon_loss: 1995934.2195; train_global_loss: 16634751.5802; train_optim_loss: 16634751.5802; val_kl_reg_loss: 85194.9062; val_edge_recon_loss: 2734065.7667; val_gene_expr_recon_loss: 11565272.9333; val_masked_gp_l1_reg_loss: 129631.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71806.5000; val_chrom_access_recon_loss: 1984963.0250; val_global_loss: 16570935.1333; val_optim_loss: 16570935.1333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9511; val_auprc_score: 0.9387; val_best_acc_score: 0.8906; val_best_f1_score: 0.8975; train_kl_reg_loss: 83460.7417; train_edge_recon_loss: 2733918.0821; train_gene_expr_recon_loss: 11572737.3740; train_masked_gp_l1_reg_loss: 129088.9733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71941.6314; train_chrom_access_recon_loss: 1987659.3483; train_global_loss: 16578806.0992; train_optim_loss: 16578806.0992; val_kl_reg_loss: 82699.0677; val_edge_recon_loss: 2745851.5500; val_gene_expr_recon_loss: 11493613.0000; val_masked_gp_l1_reg_loss: 128858.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71787.1250; val_chrom_access_recon_loss: 1977017.0333; val_global_loss: 16499826.6667; val_optim_loss: 16499826.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9532; val_auprc_score: 0.9407; val_best_acc_score: 0.8957; val_best_f1_score: 0.9006; train_kl_reg_loss: 84359.6081; train_edge_recon_loss: 2724139.0573; train_gene_expr_recon_loss: 11535607.4733; train_masked_gp_l1_reg_loss: 128918.1714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72063.5570; train_chrom_access_recon_loss: 1980786.4800; train_global_loss: 16525874.3359; train_optim_loss: 16525874.3359; val_kl_reg_loss: 85747.1479; val_edge_recon_loss: 2719210.0167; val_gene_expr_recon_loss: 11469265.8000; val_masked_gp_l1_reg_loss: 129094.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72736.4844; val_chrom_access_recon_loss: 1960726.8583; val_global_loss: 16436780.9333; val_optim_loss: 16436780.9333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9572; val_auprc_score: 0.9444; val_best_acc_score: 0.9027; val_best_f1_score: 0.9059; train_kl_reg_loss: 83748.4086; train_edge_recon_loss: 2718817.7080; train_gene_expr_recon_loss: 11512808.5267; train_masked_gp_l1_reg_loss: 128967.6054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74270.2905; train_chrom_access_recon_loss: 1976317.5315; train_global_loss: 16494930.0229; train_optim_loss: 16494930.0229; val_kl_reg_loss: 81836.9385; val_edge_recon_loss: 2717425.8833; val_gene_expr_recon_loss: 11447401.1333; val_masked_gp_l1_reg_loss: 129032.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76570.9531; val_chrom_access_recon_loss: 1969408.1417; val_global_loss: 16421675.9333; val_optim_loss: 16421675.9333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9599; val_auprc_score: 0.9478; val_best_acc_score: 0.9046; val_best_f1_score: 0.9089; train_kl_reg_loss: 82336.4298; train_edge_recon_loss: 2712619.3053; train_gene_expr_recon_loss: 11489138.4809; train_masked_gp_l1_reg_loss: 128731.2276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76485.0258; train_chrom_access_recon_loss: 1972356.4723; train_global_loss: 16461666.9924; train_optim_loss: 16461666.9924; val_kl_reg_loss: 83374.1432; val_edge_recon_loss: 2715194.3167; val_gene_expr_recon_loss: 11517558.8000; val_masked_gp_l1_reg_loss: 128534.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77084.9922; val_chrom_access_recon_loss: 1977280.1083; val_global_loss: 16499027.2667; val_optim_loss: 16499027.2667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9642; val_auprc_score: 0.9530; val_best_acc_score: 0.9093; val_best_f1_score: 0.9134; train_kl_reg_loss: 82545.7617; train_edge_recon_loss: 2713766.2901; train_gene_expr_recon_loss: 11465920.0305; train_masked_gp_l1_reg_loss: 128401.6985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76712.3963; train_chrom_access_recon_loss: 1968468.6985; train_global_loss: 16435814.8626; train_optim_loss: 16435814.8626; val_kl_reg_loss: 86592.5250; val_edge_recon_loss: 2701165.3333; val_gene_expr_recon_loss: 11402695.0667; val_masked_gp_l1_reg_loss: 128252.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77005.7188; val_chrom_access_recon_loss: 1962414.6833; val_global_loss: 16358126.7333; val_optim_loss: 16358126.7333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9647; val_auprc_score: 0.9576; val_best_acc_score: 0.9085; val_best_f1_score: 0.9120; train_kl_reg_loss: 82142.1338; train_edge_recon_loss: 2711547.8588; train_gene_expr_recon_loss: 11441349.0382; train_masked_gp_l1_reg_loss: 127972.1732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76797.4984; train_chrom_access_recon_loss: 1964295.7557; train_global_loss: 16404104.4733; train_optim_loss: 16404104.4733; val_kl_reg_loss: 84781.2531; val_edge_recon_loss: 2712220.1167; val_gene_expr_recon_loss: 11436114.7333; val_masked_gp_l1_reg_loss: 128071.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77237.0156; val_chrom_access_recon_loss: 1960366.7917; val_global_loss: 16398790.6000; val_optim_loss: 16398790.6000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9650; val_auprc_score: 0.9533; val_best_acc_score: 0.9103; val_best_f1_score: 0.9133; train_kl_reg_loss: 84386.9675; train_edge_recon_loss: 2696561.8416; train_gene_expr_recon_loss: 11416059.4046; train_masked_gp_l1_reg_loss: 127359.7947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76647.5508; train_chrom_access_recon_loss: 1959653.3731; train_global_loss: 16360668.9237; train_optim_loss: 16360668.9237; val_kl_reg_loss: 83011.8620; val_edge_recon_loss: 2710317.4833; val_gene_expr_recon_loss: 11376743.8667; val_masked_gp_l1_reg_loss: 127369.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77296.0781; val_chrom_access_recon_loss: 1952359.1333; val_global_loss: 16327097.4000; val_optim_loss: 16327097.4000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9651; val_auprc_score: 0.9544; val_best_acc_score: 0.9086; val_best_f1_score: 0.9122; train_kl_reg_loss: 81989.8349; train_edge_recon_loss: 2706828.8950; train_gene_expr_recon_loss: 11401680.9313; train_masked_gp_l1_reg_loss: 126821.2199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76567.1125; train_chrom_access_recon_loss: 1957099.1584; train_global_loss: 16350987.0305; train_optim_loss: 16350987.0305; val_kl_reg_loss: 83697.4750; val_edge_recon_loss: 2714032.4667; val_gene_expr_recon_loss: 11360338.9333; val_masked_gp_l1_reg_loss: 126314.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75775.3125; val_chrom_access_recon_loss: 1952651.2917; val_global_loss: 16312809.2000; val_optim_loss: 16312809.2000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9643; val_auprc_score: 0.9560; val_best_acc_score: 0.9046; val_best_f1_score: 0.9094; train_kl_reg_loss: 83195.3934; train_edge_recon_loss: 2699820.5153; train_gene_expr_recon_loss: 11375990.0458; train_masked_gp_l1_reg_loss: 126057.3526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76483.0090; train_chrom_access_recon_loss: 1950583.9952; train_global_loss: 16312130.3130; train_optim_loss: 16312130.3130; val_kl_reg_loss: 84562.9438; val_edge_recon_loss: 2723054.2167; val_gene_expr_recon_loss: 11326881.0667; val_masked_gp_l1_reg_loss: 125750.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76788.1406; val_chrom_access_recon_loss: 1942456.7000; val_global_loss: 16279493.9333; val_optim_loss: 16279493.9333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9669; val_auprc_score: 0.9584; val_best_acc_score: 0.9153; val_best_f1_score: 0.9176; train_kl_reg_loss: 82443.6315; train_edge_recon_loss: 2697878.8092; train_gene_expr_recon_loss: 11372628.7176; train_masked_gp_l1_reg_loss: 125418.4948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76594.1568; train_chrom_access_recon_loss: 1949805.0382; train_global_loss: 16304768.7786; train_optim_loss: 16304768.7786; val_kl_reg_loss: 86197.2130; val_edge_recon_loss: 2702758.4833; val_gene_expr_recon_loss: 11344337.6667; val_masked_gp_l1_reg_loss: 125507.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76352.4297; val_chrom_access_recon_loss: 1938858.8667; val_global_loss: 16274011.5333; val_optim_loss: 16274011.5333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9648; val_auprc_score: 0.9559; val_best_acc_score: 0.9111; val_best_f1_score: 0.9152; train_kl_reg_loss: 94331.3288; train_edge_recon_loss: 2745131.9676; train_gene_expr_recon_loss: 10736870.2748; train_masked_gp_l1_reg_loss: 124763.2989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73247.0360; train_chrom_access_recon_loss: 1858962.3330; train_global_loss: 15633306.2137; train_optim_loss: 15633306.2137; val_kl_reg_loss: 48733.3411; val_edge_recon_loss: 2741164.7333; val_gene_expr_recon_loss: 10640999.8667; val_masked_gp_l1_reg_loss: 124759.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73286.7031; val_chrom_access_recon_loss: 1835946.2250; val_global_loss: 15464891.4667; val_optim_loss: 15464891.4667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9704; val_auprc_score: 0.9641; val_best_acc_score: 0.9184; val_best_f1_score: 0.9204; train_kl_reg_loss: 82566.6854; train_edge_recon_loss: 2708911.7481; train_gene_expr_recon_loss: 10677658.8550; train_masked_gp_l1_reg_loss: 123969.6150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74021.5884; train_chrom_access_recon_loss: 1845983.4275; train_global_loss: 15513111.8779; train_optim_loss: 15513111.8779; val_kl_reg_loss: 55130.7469; val_edge_recon_loss: 2689984.2667; val_gene_expr_recon_loss: 10597559.8000; val_masked_gp_l1_reg_loss: 122879.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73664.3125; val_chrom_access_recon_loss: 1822970.7000; val_global_loss: 15362188.3333; val_optim_loss: 15362188.3333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9667; val_auprc_score: 0.9582; val_best_acc_score: 0.9169; val_best_f1_score: 0.9209; train_kl_reg_loss: 76216.5505; train_edge_recon_loss: 2702119.6450; train_gene_expr_recon_loss: 10657003.3740; train_masked_gp_l1_reg_loss: 121300.6189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73986.7914; train_chrom_access_recon_loss: 1842892.0067; train_global_loss: 15473518.9542; train_optim_loss: 15473518.9542; val_kl_reg_loss: 59441.6492; val_edge_recon_loss: 2709912.9667; val_gene_expr_recon_loss: 10597673.5333; val_masked_gp_l1_reg_loss: 119663.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73619.3359; val_chrom_access_recon_loss: 1833277.1083; val_global_loss: 15393587.2000; val_optim_loss: 15393587.2000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9710; val_auprc_score: 0.9600; val_best_acc_score: 0.9224; val_best_f1_score: 0.9256; train_kl_reg_loss: 72526.0646; train_edge_recon_loss: 2696094.2137; train_gene_expr_recon_loss: 10627639.3359; train_masked_gp_l1_reg_loss: 118364.4178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73989.8704; train_chrom_access_recon_loss: 1837348.1765; train_global_loss: 15425962.0458; train_optim_loss: 15425962.0458; val_kl_reg_loss: 59687.4505; val_edge_recon_loss: 2709883.7167; val_gene_expr_recon_loss: 10587312.9333; val_masked_gp_l1_reg_loss: 117502.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74029.8984; val_chrom_access_recon_loss: 1828685.3000; val_global_loss: 15377102.4667; val_optim_loss: 15377102.4667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9715; val_auprc_score: 0.9636; val_best_acc_score: 0.9235; val_best_f1_score: 0.9265; train_kl_reg_loss: 71023.1708; train_edge_recon_loss: 2686507.9084; train_gene_expr_recon_loss: 10600147.2137; train_masked_gp_l1_reg_loss: 116359.5725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73844.9860; train_chrom_access_recon_loss: 1833364.1985; train_global_loss: 15381247.0000; train_optim_loss: 15381247.0000; val_kl_reg_loss: 59524.2094; val_edge_recon_loss: 2712996.2833; val_gene_expr_recon_loss: 10546644.8667; val_masked_gp_l1_reg_loss: 115343.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74013.1797; val_chrom_access_recon_loss: 1820452.9667; val_global_loss: 15328975.2667; val_optim_loss: 15328975.2667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9680; val_auprc_score: 0.9549; val_best_acc_score: 0.9208; val_best_f1_score: 0.9245; train_kl_reg_loss: 69317.2147; train_edge_recon_loss: 2687300.1641; train_gene_expr_recon_loss: 10579430.9924; train_masked_gp_l1_reg_loss: 114759.0997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73685.0280; train_chrom_access_recon_loss: 1830450.8960; train_global_loss: 15354943.3588; train_optim_loss: 15354943.3588; val_kl_reg_loss: 64932.2742; val_edge_recon_loss: 2708359.0167; val_gene_expr_recon_loss: 10518592.2667; val_masked_gp_l1_reg_loss: 114159.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73333.5547; val_chrom_access_recon_loss: 1818205.5667; val_global_loss: 15297582.0000; val_optim_loss: 15297582.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9728; val_auprc_score: 0.9642; val_best_acc_score: 0.9259; val_best_f1_score: 0.9287; train_kl_reg_loss: 70006.8124; train_edge_recon_loss: 2685216.5382; train_gene_expr_recon_loss: 10568872.4809; train_masked_gp_l1_reg_loss: 113196.5642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73420.6125; train_chrom_access_recon_loss: 1829343.3731; train_global_loss: 15340056.3053; train_optim_loss: 15340056.3053; val_kl_reg_loss: 65022.9016; val_edge_recon_loss: 2689114.8333; val_gene_expr_recon_loss: 10539379.0000; val_masked_gp_l1_reg_loss: 112670.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73513.5078; val_chrom_access_recon_loss: 1810293.6250; val_global_loss: 15289994.4000; val_optim_loss: 15289994.4000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9724; val_auprc_score: 0.9617; val_best_acc_score: 0.9264; val_best_f1_score: 0.9285; train_kl_reg_loss: 69026.6938; train_edge_recon_loss: 2684178.1947; train_gene_expr_recon_loss: 10566810.7481; train_masked_gp_l1_reg_loss: 111953.4495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73270.1475; train_chrom_access_recon_loss: 1828645.8655; train_global_loss: 15333885.0840; train_optim_loss: 15333885.0840; val_kl_reg_loss: 65827.0539; val_edge_recon_loss: 2693017.8833; val_gene_expr_recon_loss: 10496367.4000; val_masked_gp_l1_reg_loss: 111424.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73253.6250; val_chrom_access_recon_loss: 1810067.1167; val_global_loss: 15249958.5333; val_optim_loss: 15249958.5333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9721; val_auprc_score: 0.9641; val_best_acc_score: 0.9251; val_best_f1_score: 0.9282; train_kl_reg_loss: 68956.7764; train_edge_recon_loss: 2690397.4752; train_gene_expr_recon_loss: 10546703.8244; train_masked_gp_l1_reg_loss: 110746.4859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73100.8013; train_chrom_access_recon_loss: 1825536.7834; train_global_loss: 15315442.0229; train_optim_loss: 15315442.0229; val_kl_reg_loss: 64383.6479; val_edge_recon_loss: 2688365.9167; val_gene_expr_recon_loss: 10519286.5333; val_masked_gp_l1_reg_loss: 110349.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72778.2266; val_chrom_access_recon_loss: 1813270.7167; val_global_loss: 15268434.8667; val_optim_loss: 15268434.8667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9728; val_auprc_score: 0.9655; val_best_acc_score: 0.9248; val_best_f1_score: 0.9272; train_kl_reg_loss: 69182.3782; train_edge_recon_loss: 2682071.8969; train_gene_expr_recon_loss: 10531978.4809; train_masked_gp_l1_reg_loss: 109658.5924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73118.3594; train_chrom_access_recon_loss: 1824027.3607; train_global_loss: 15290037.1527; train_optim_loss: 15290037.1527; val_kl_reg_loss: 64423.5240; val_edge_recon_loss: 2705065.9333; val_gene_expr_recon_loss: 10529331.0667; val_masked_gp_l1_reg_loss: 109001.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72878.9219; val_chrom_access_recon_loss: 1815033.1500; val_global_loss: 15295735.0000; val_optim_loss: 15295735.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9721; val_auprc_score: 0.9600; val_best_acc_score: 0.9272; val_best_f1_score: 0.9302; train_kl_reg_loss: 68042.6215; train_edge_recon_loss: 2682708.2576; train_gene_expr_recon_loss: 10520404.2595; train_masked_gp_l1_reg_loss: 108691.6957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72989.8449; train_chrom_access_recon_loss: 1820256.6107; train_global_loss: 15273093.2977; train_optim_loss: 15273093.2977; val_kl_reg_loss: 67414.4404; val_edge_recon_loss: 2677692.6167; val_gene_expr_recon_loss: 10471300.0000; val_masked_gp_l1_reg_loss: 108310.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73009.0625; val_chrom_access_recon_loss: 1806913.6917; val_global_loss: 15204639.6000; val_optim_loss: 15204639.6000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9765; val_auprc_score: 0.9691; val_best_acc_score: 0.9326; val_best_f1_score: 0.9353; train_kl_reg_loss: 68839.0453; train_edge_recon_loss: 2675289.1202; train_gene_expr_recon_loss: 10503414.2901; train_masked_gp_l1_reg_loss: 107687.3247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72982.8397; train_chrom_access_recon_loss: 1813726.5344; train_global_loss: 15241939.1298; train_optim_loss: 15241939.1298; val_kl_reg_loss: 64976.5357; val_edge_recon_loss: 2670690.9000; val_gene_expr_recon_loss: 10455954.0667; val_masked_gp_l1_reg_loss: 107145.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73442.7188; val_chrom_access_recon_loss: 1793940.0167; val_global_loss: 15166150.4667; val_optim_loss: 15166150.4667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9746; val_auprc_score: 0.9669; val_best_acc_score: 0.9293; val_best_f1_score: 0.9312; train_kl_reg_loss: 66858.5441; train_edge_recon_loss: 2683859.7748; train_gene_expr_recon_loss: 10484927.7328; train_masked_gp_l1_reg_loss: 106807.4773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72964.2745; train_chrom_access_recon_loss: 1807876.3521; train_global_loss: 15223294.1298; train_optim_loss: 15223294.1298; val_kl_reg_loss: 65231.6531; val_edge_recon_loss: 2686587.6000; val_gene_expr_recon_loss: 10462388.8667; val_masked_gp_l1_reg_loss: 106731.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73076.9844; val_chrom_access_recon_loss: 1798995.1833; val_global_loss: 15193012.4000; val_optim_loss: 15193012.4000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9736; val_auprc_score: 0.9658; val_best_acc_score: 0.9263; val_best_f1_score: 0.9290; train_kl_reg_loss: 68248.0201; train_edge_recon_loss: 2684525.4008; train_gene_expr_recon_loss: 10478168.7939; train_masked_gp_l1_reg_loss: 105991.8805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72852.1059; train_chrom_access_recon_loss: 1807649.4704; train_global_loss: 15217435.5649; train_optim_loss: 15217435.5649; val_kl_reg_loss: 64766.9547; val_edge_recon_loss: 2698289.5500; val_gene_expr_recon_loss: 10443024.0000; val_masked_gp_l1_reg_loss: 105438.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72519.0312; val_chrom_access_recon_loss: 1794892.4833; val_global_loss: 15178930.0000; val_optim_loss: 15178930.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9729; val_auprc_score: 0.9658; val_best_acc_score: 0.9250; val_best_f1_score: 0.9283; train_kl_reg_loss: 66968.7788; train_edge_recon_loss: 2675756.0973; train_gene_expr_recon_loss: 10471068.3664; train_masked_gp_l1_reg_loss: 105156.9268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72885.2129; train_chrom_access_recon_loss: 1807249.3282; train_global_loss: 15199084.7023; train_optim_loss: 15199084.7023; val_kl_reg_loss: 63955.9750; val_edge_recon_loss: 2715987.1167; val_gene_expr_recon_loss: 10441721.3333; val_masked_gp_l1_reg_loss: 104602.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72831.2891; val_chrom_access_recon_loss: 1796743.5417; val_global_loss: 15195841.8667; val_optim_loss: 15195841.8667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9785; val_auprc_score: 0.9734; val_best_acc_score: 0.9352; val_best_f1_score: 0.9370; train_kl_reg_loss: 67345.0010; train_edge_recon_loss: 2677143.2557; train_gene_expr_recon_loss: 10459597.2519; train_masked_gp_l1_reg_loss: 104281.3787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72970.8489; train_chrom_access_recon_loss: 1805428.0544; train_global_loss: 15186765.8397; train_optim_loss: 15186765.8397; val_kl_reg_loss: 64501.6740; val_edge_recon_loss: 2689019.2333; val_gene_expr_recon_loss: 10449257.4000; val_masked_gp_l1_reg_loss: 103976.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72636.9766; val_chrom_access_recon_loss: 1796400.5333; val_global_loss: 15175791.8000; val_optim_loss: 15175791.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9755; val_auprc_score: 0.9661; val_best_acc_score: 0.9334; val_best_f1_score: 0.9357; train_kl_reg_loss: 67673.1854; train_edge_recon_loss: 2674258.0744; train_gene_expr_recon_loss: 10448324.5496; train_masked_gp_l1_reg_loss: 100280.1135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58610.9164; train_chrom_access_recon_loss: 1803322.2252; train_global_loss: 15152469.0763; train_optim_loss: 15152469.0763; val_kl_reg_loss: 65781.4065; val_edge_recon_loss: 2683592.0667; val_gene_expr_recon_loss: 10426097.2667; val_masked_gp_l1_reg_loss: 99438.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56791.6797; val_chrom_access_recon_loss: 1799422.1750; val_global_loss: 15131123.8667; val_optim_loss: 15131123.8667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9797; val_auprc_score: 0.9747; val_best_acc_score: 0.9351; val_best_f1_score: 0.9363; train_kl_reg_loss: 68867.3709; train_edge_recon_loss: 2675425.0630; train_gene_expr_recon_loss: 10433345.0916; train_masked_gp_l1_reg_loss: 99305.1288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56364.9969; train_chrom_access_recon_loss: 1802823.8158; train_global_loss: 15136131.4351; train_optim_loss: 15136131.4351; val_kl_reg_loss: 66970.8318; val_edge_recon_loss: 2674268.2500; val_gene_expr_recon_loss: 10400313.4667; val_masked_gp_l1_reg_loss: 99239.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56121.0039; val_chrom_access_recon_loss: 1790561.0667; val_global_loss: 15087473.9333; val_optim_loss: 15087473.9333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9793; val_auprc_score: 0.9743; val_best_acc_score: 0.9342; val_best_f1_score: 0.9364; train_kl_reg_loss: 69743.7191; train_edge_recon_loss: 2678192.0802; train_gene_expr_recon_loss: 10425122.1603; train_masked_gp_l1_reg_loss: 99155.6310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55901.3091; train_chrom_access_recon_loss: 1802297.4141; train_global_loss: 15130412.2672; train_optim_loss: 15130412.2672; val_kl_reg_loss: 66882.1763; val_edge_recon_loss: 2671945.5333; val_gene_expr_recon_loss: 10408210.8667; val_masked_gp_l1_reg_loss: 99058.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55643.4023; val_chrom_access_recon_loss: 1793836.1750; val_global_loss: 15095576.8667; val_optim_loss: 15095576.8667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9768; val_auprc_score: 0.9706; val_best_acc_score: 0.9302; val_best_f1_score: 0.9319; train_kl_reg_loss: 70195.0784; train_edge_recon_loss: 2670124.2901; train_gene_expr_recon_loss: 10417221.4504; train_masked_gp_l1_reg_loss: 98981.7860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55410.6169; train_chrom_access_recon_loss: 1798910.5725; train_global_loss: 15110843.7863; train_optim_loss: 15110843.7863; val_kl_reg_loss: 68034.0859; val_edge_recon_loss: 2688009.3667; val_gene_expr_recon_loss: 10456643.4667; val_masked_gp_l1_reg_loss: 98920.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55196.5234; val_chrom_access_recon_loss: 1800114.0167; val_global_loss: 15166919.0000; val_optim_loss: 15166919.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9774; val_auprc_score: 0.9716; val_best_acc_score: 0.9357; val_best_f1_score: 0.9381; train_kl_reg_loss: 70700.9156; train_edge_recon_loss: 2672895.3836; train_gene_expr_recon_loss: 10416570.5115; train_masked_gp_l1_reg_loss: 98855.2709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55014.5234; train_chrom_access_recon_loss: 1800412.2252; train_global_loss: 15114448.9008; train_optim_loss: 15114448.9008; val_kl_reg_loss: 67544.7380; val_edge_recon_loss: 2674936.0000; val_gene_expr_recon_loss: 10418091.4000; val_masked_gp_l1_reg_loss: 98793.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54809.3398; val_chrom_access_recon_loss: 1797009.2667; val_global_loss: 15111183.4000; val_optim_loss: 15111183.4000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9768; val_auprc_score: 0.9705; val_best_acc_score: 0.9324; val_best_f1_score: 0.9340; train_kl_reg_loss: 71095.6287; train_edge_recon_loss: 2669595.6107; train_gene_expr_recon_loss: 10428311.8779; train_masked_gp_l1_reg_loss: 98739.6792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54687.6876; train_chrom_access_recon_loss: 1802706.0811; train_global_loss: 15125136.5802; train_optim_loss: 15125136.5802; val_kl_reg_loss: 67504.3177; val_edge_recon_loss: 2688175.0833; val_gene_expr_recon_loss: 10405548.2000; val_masked_gp_l1_reg_loss: 98669.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54557.8359; val_chrom_access_recon_loss: 1792892.0083; val_global_loss: 15107346.7333; val_optim_loss: 15107346.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9773; val_auprc_score: 0.9695; val_best_acc_score: 0.9365; val_best_f1_score: 0.9385; train_kl_reg_loss: 70939.0060; train_edge_recon_loss: 2678988.1775; train_gene_expr_recon_loss: 10411335.3435; train_masked_gp_l1_reg_loss: 98283.3208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53049.6281; train_chrom_access_recon_loss: 1799365.0926; train_global_loss: 15111960.6031; train_optim_loss: 15111960.6031; val_kl_reg_loss: 67383.3677; val_edge_recon_loss: 2662774.5167; val_gene_expr_recon_loss: 10368763.8667; val_masked_gp_l1_reg_loss: 98176.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52854.6289; val_chrom_access_recon_loss: 1783957.6417; val_global_loss: 15033911.3333; val_optim_loss: 15033911.3333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9760; val_auprc_score: 0.9679; val_best_acc_score: 0.9330; val_best_f1_score: 0.9347; train_kl_reg_loss: 71013.0836; train_edge_recon_loss: 2676759.1202; train_gene_expr_recon_loss: 10416773.1145; train_masked_gp_l1_reg_loss: 98142.7315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52805.6071; train_chrom_access_recon_loss: 1801456.9389; train_global_loss: 15116950.5649; train_optim_loss: 15116950.5649; val_kl_reg_loss: 67138.9104; val_edge_recon_loss: 2688957.1500; val_gene_expr_recon_loss: 10432287.9333; val_masked_gp_l1_reg_loss: 98116.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52755.3867; val_chrom_access_recon_loss: 1798539.2500; val_global_loss: 15137795.2667; val_optim_loss: 15137795.2667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9784; val_auprc_score: 0.9720; val_best_acc_score: 0.9368; val_best_f1_score: 0.9387; train_kl_reg_loss: 70986.8040; train_edge_recon_loss: 2670983.4351; train_gene_expr_recon_loss: 10413716.3130; train_masked_gp_l1_reg_loss: 98100.6460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52718.2419; train_chrom_access_recon_loss: 1800633.0372; train_global_loss: 15107138.5115; train_optim_loss: 15107138.5115; val_kl_reg_loss: 67118.5492; val_edge_recon_loss: 2673208.6667; val_gene_expr_recon_loss: 10399597.2667; val_masked_gp_l1_reg_loss: 98083.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52685.8789; val_chrom_access_recon_loss: 1792594.0000; val_global_loss: 15083287.4667; val_optim_loss: 15083287.4667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9778; val_auprc_score: 0.9697; val_best_acc_score: 0.9342; val_best_f1_score: 0.9361; train_kl_reg_loss: 71205.8678; train_edge_recon_loss: 2672808.4370; train_gene_expr_recon_loss: 10408432.5344; train_masked_gp_l1_reg_loss: 98071.7698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52652.3534; train_chrom_access_recon_loss: 1798665.5630; train_global_loss: 15101836.4733; train_optim_loss: 15101836.4733; val_kl_reg_loss: 67855.6323; val_edge_recon_loss: 2673999.5000; val_gene_expr_recon_loss: 10414803.6667; val_masked_gp_l1_reg_loss: 98059.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52624.5938; val_chrom_access_recon_loss: 1790673.2000; val_global_loss: 15098017.2000; val_optim_loss: 15098017.2000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9779; val_auprc_score: 0.9692; val_best_acc_score: 0.9341; val_best_f1_score: 0.9364; train_kl_reg_loss: 71279.9176; train_edge_recon_loss: 2670124.5458; train_gene_expr_recon_loss: 10411151.5344; train_masked_gp_l1_reg_loss: 98048.2293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52595.0497; train_chrom_access_recon_loss: 1800448.9113; train_global_loss: 15103648.2290; train_optim_loss: 15103648.2290; val_kl_reg_loss: 67147.8477; val_edge_recon_loss: 2678762.4000; val_gene_expr_recon_loss: 10410993.2667; val_masked_gp_l1_reg_loss: 98040.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52568.8125; val_chrom_access_recon_loss: 1789445.5250; val_global_loss: 15096959.1333; val_optim_loss: 15096959.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9744; val_auprc_score: 0.9655; val_best_acc_score: 0.9324; val_best_f1_score: 0.9338; train_kl_reg_loss: 71302.2654; train_edge_recon_loss: 2673492.1546; train_gene_expr_recon_loss: 10418753.5038; train_masked_gp_l1_reg_loss: 98002.2387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52418.7244; train_chrom_access_recon_loss: 1803377.6555; train_global_loss: 15117346.4504; train_optim_loss: 15117346.4504; val_kl_reg_loss: 67067.4182; val_edge_recon_loss: 2678331.7167; val_gene_expr_recon_loss: 10399453.5333; val_masked_gp_l1_reg_loss: 97991.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52401.0938; val_chrom_access_recon_loss: 1797183.0417; val_global_loss: 15092427.8000; val_optim_loss: 15092427.8000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9775; val_auprc_score: 0.9695; val_best_acc_score: 0.9329; val_best_f1_score: 0.9335; train_kl_reg_loss: 71360.2612; train_edge_recon_loss: 2670580.4256; train_gene_expr_recon_loss: 10408322.2290; train_masked_gp_l1_reg_loss: 97987.4281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52396.2678; train_chrom_access_recon_loss: 1799554.8521; train_global_loss: 15100201.5038; train_optim_loss: 15100201.5038; val_kl_reg_loss: 67423.0401; val_edge_recon_loss: 2681607.7000; val_gene_expr_recon_loss: 10426819.0667; val_masked_gp_l1_reg_loss: 97984.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52391.1797; val_chrom_access_recon_loss: 1802299.5250; val_global_loss: 15128524.3333; val_optim_loss: 15128524.3333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9745; val_auprc_score: 0.9628; val_best_acc_score: 0.9318; val_best_f1_score: 0.9341; train_kl_reg_loss: 71289.4015; train_edge_recon_loss: 2673557.4905; train_gene_expr_recon_loss: 10417423.1985; train_masked_gp_l1_reg_loss: 97981.5058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52386.9314; train_chrom_access_recon_loss: 1799928.6040; train_global_loss: 15112567.1756; train_optim_loss: 15112567.1756; val_kl_reg_loss: 67333.0672; val_edge_recon_loss: 2697728.3667; val_gene_expr_recon_loss: 10408740.1333; val_masked_gp_l1_reg_loss: 97979.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52383.0391; val_chrom_access_recon_loss: 1793886.3667; val_global_loss: 15118049.9333; val_optim_loss: 15118049.9333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9773; val_auprc_score: 0.9694; val_best_acc_score: 0.9349; val_best_f1_score: 0.9363; train_kl_reg_loss: 71403.9308; train_edge_recon_loss: 2672903.6317; train_gene_expr_recon_loss: 10413161.1527; train_masked_gp_l1_reg_loss: 97977.9284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52379.9221; train_chrom_access_recon_loss: 1801334.0019; train_global_loss: 15109160.5344; train_optim_loss: 15109160.5344; val_kl_reg_loss: 67526.8651; val_edge_recon_loss: 2687159.7167; val_gene_expr_recon_loss: 10347804.2000; val_masked_gp_l1_reg_loss: 97975.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52375.6172; val_chrom_access_recon_loss: 1783857.5167; val_global_loss: 15036700.4667; val_optim_loss: 15036700.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 51 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9779
val AUPRC score: 0.9716
val best accuracy score: 0.9326
val best F1 score: 0.9351
val target rna MSE score: 1.6080
val source rna MSE score: 0.5360
val target atac MSE score: 0.3346
val source atac MSE score: 0.1049
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
