[True]
Run timestamp: 09102023_235408_77.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_77']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7573; val_auprc_score: 0.7853; val_best_acc_score: 0.5392; val_best_f1_score: 0.6807; train_kl_reg_loss: 56295.3068; train_edge_recon_loss: 3505049.6298; train_gene_expr_recon_loss: 13561796.5573; train_masked_gp_l1_reg_loss: 53152.0878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3375025.0809; train_chrom_access_recon_loss: 6745824.6718; train_global_loss: 27297143.6031; train_optim_loss: 27297143.6031; val_kl_reg_loss: 79497.4698; val_edge_recon_loss: 4062683.6333; val_gene_expr_recon_loss: 12471565.0000; val_masked_gp_l1_reg_loss: 62318.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 502068.4375; val_chrom_access_recon_loss: 6450715.6667; val_global_loss: 23628848.8000; val_optim_loss: 23628848.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7953; val_auprc_score: 0.8092; val_best_acc_score: 0.7087; val_best_f1_score: 0.7183; train_kl_reg_loss: 76899.5850; train_edge_recon_loss: 3496723.8836; train_gene_expr_recon_loss: 12625257.8779; train_masked_gp_l1_reg_loss: 64073.0114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 270012.5518; train_chrom_access_recon_loss: 6495988.0840; train_global_loss: 23028954.8855; train_optim_loss: 23028954.8855; val_kl_reg_loss: 65293.4302; val_edge_recon_loss: 4035600.0500; val_gene_expr_recon_loss: 12259557.0667; val_masked_gp_l1_reg_loss: 65754.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 166864.7812; val_chrom_access_recon_loss: 6372775.7000; val_global_loss: 22965845.6000; val_optim_loss: 22965845.6000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8809; val_auprc_score: 0.8695; val_best_acc_score: 0.7967; val_best_f1_score: 0.8123; train_kl_reg_loss: 67767.3852; train_edge_recon_loss: 3284584.3874; train_gene_expr_recon_loss: 12476425.0458; train_masked_gp_l1_reg_loss: 68731.9531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138710.8498; train_chrom_access_recon_loss: 6426560.5992; train_global_loss: 22462780.1527; train_optim_loss: 22462780.1527; val_kl_reg_loss: 91046.3130; val_edge_recon_loss: 2943879.4667; val_gene_expr_recon_loss: 12136631.2667; val_masked_gp_l1_reg_loss: 73784.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120986.1562; val_chrom_access_recon_loss: 6281766.7333; val_global_loss: 21648094.8000; val_optim_loss: 21648094.8000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9272; val_auprc_score: 0.9117; val_best_acc_score: 0.8562; val_best_f1_score: 0.8643; train_kl_reg_loss: 90897.4518; train_edge_recon_loss: 2882501.2863; train_gene_expr_recon_loss: 12344401.3893; train_masked_gp_l1_reg_loss: 77308.9064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112485.1910; train_chrom_access_recon_loss: 6352712.6565; train_global_loss: 21860306.9008; train_optim_loss: 21860306.9008; val_kl_reg_loss: 90727.7240; val_edge_recon_loss: 2841150.9333; val_gene_expr_recon_loss: 12013097.1333; val_masked_gp_l1_reg_loss: 79710.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108259.6719; val_chrom_access_recon_loss: 6205110.0000; val_global_loss: 21338055.7333; val_optim_loss: 21338055.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9270; val_auprc_score: 0.9107; val_best_acc_score: 0.8583; val_best_f1_score: 0.8687; train_kl_reg_loss: 95795.0849; train_edge_recon_loss: 2806241.2080; train_gene_expr_recon_loss: 12210710.3282; train_masked_gp_l1_reg_loss: 81269.8961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106854.8338; train_chrom_access_recon_loss: 6299338.4847; train_global_loss: 21600209.8168; train_optim_loss: 21600209.8168; val_kl_reg_loss: 91033.2333; val_edge_recon_loss: 2825154.9667; val_gene_expr_recon_loss: 11908785.1333; val_masked_gp_l1_reg_loss: 82864.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107129.4375; val_chrom_access_recon_loss: 6205061.6333; val_global_loss: 21220027.8667; val_optim_loss: 21220027.8667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9266; val_auprc_score: 0.9073; val_best_acc_score: 0.8599; val_best_f1_score: 0.8678; train_kl_reg_loss: 91813.3571; train_edge_recon_loss: 2812955.2653; train_gene_expr_recon_loss: 12102654.0153; train_masked_gp_l1_reg_loss: 83500.2756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105556.8903; train_chrom_access_recon_loss: 6237549.2061; train_global_loss: 21434028.9466; train_optim_loss: 21434028.9466; val_kl_reg_loss: 89375.4964; val_edge_recon_loss: 2834891.6500; val_gene_expr_recon_loss: 11810687.0667; val_masked_gp_l1_reg_loss: 84079.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104796.8672; val_chrom_access_recon_loss: 6156532.6000; val_global_loss: 21080362.8000; val_optim_loss: 21080362.8000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9317; val_auprc_score: 0.9164; val_best_acc_score: 0.8667; val_best_f1_score: 0.8737; train_kl_reg_loss: 90260.7909; train_edge_recon_loss: 2798196.5878; train_gene_expr_recon_loss: 12027328.9771; train_masked_gp_l1_reg_loss: 84636.2469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103904.9040; train_chrom_access_recon_loss: 6210544.2214; train_global_loss: 21314871.7863; train_optim_loss: 21314871.7863; val_kl_reg_loss: 87138.2271; val_edge_recon_loss: 2824731.0667; val_gene_expr_recon_loss: 11732873.4000; val_masked_gp_l1_reg_loss: 85304.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103624.2500; val_chrom_access_recon_loss: 6096662.5000; val_global_loss: 20930334.0000; val_optim_loss: 20930334.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9340; val_auprc_score: 0.9227; val_best_acc_score: 0.8682; val_best_f1_score: 0.8767; train_kl_reg_loss: 86431.4693; train_edge_recon_loss: 2781732.2805; train_gene_expr_recon_loss: 11947534.5267; train_masked_gp_l1_reg_loss: 85580.7483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102487.3722; train_chrom_access_recon_loss: 6164425.5115; train_global_loss: 21168191.9542; train_optim_loss: 21168191.9542; val_kl_reg_loss: 86118.8188; val_edge_recon_loss: 2804834.1667; val_gene_expr_recon_loss: 11671153.1333; val_masked_gp_l1_reg_loss: 86087.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102276.1562; val_chrom_access_recon_loss: 6021111.6667; val_global_loss: 20771580.8000; val_optim_loss: 20771580.8000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9447; val_auprc_score: 0.9325; val_best_acc_score: 0.8828; val_best_f1_score: 0.8887; train_kl_reg_loss: 84139.3496; train_edge_recon_loss: 2774189.0210; train_gene_expr_recon_loss: 11880681.2977; train_masked_gp_l1_reg_loss: 86252.0161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100533.5050; train_chrom_access_recon_loss: 6139183.7595; train_global_loss: 21064978.8550; train_optim_loss: 21064978.8550; val_kl_reg_loss: 83566.6130; val_edge_recon_loss: 2760447.7833; val_gene_expr_recon_loss: 11563735.4000; val_masked_gp_l1_reg_loss: 86628.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99586.1328; val_chrom_access_recon_loss: 5998716.6000; val_global_loss: 20592681.4667; val_optim_loss: 20592681.4667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9433; val_auprc_score: 0.9306; val_best_acc_score: 0.8779; val_best_f1_score: 0.8846; train_kl_reg_loss: 82068.0514; train_edge_recon_loss: 2767622.6985; train_gene_expr_recon_loss: 11815921.6489; train_masked_gp_l1_reg_loss: 86796.3822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98332.0774; train_chrom_access_recon_loss: 6106981.9122; train_global_loss: 20957722.6870; train_optim_loss: 20957722.6870; val_kl_reg_loss: 82865.9344; val_edge_recon_loss: 2778147.3000; val_gene_expr_recon_loss: 11530095.4667; val_masked_gp_l1_reg_loss: 87131.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97207.1484; val_chrom_access_recon_loss: 5994592.6667; val_global_loss: 20570040.4000; val_optim_loss: 20570040.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9454; val_auprc_score: 0.9302; val_best_acc_score: 0.8833; val_best_f1_score: 0.8899; train_kl_reg_loss: 82302.6740; train_edge_recon_loss: 2751017.5057; train_gene_expr_recon_loss: 11773411.5725; train_masked_gp_l1_reg_loss: 87072.2128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96395.0499; train_chrom_access_recon_loss: 6075295.8626; train_global_loss: 20865494.8702; train_optim_loss: 20865494.8702; val_kl_reg_loss: 80827.5589; val_edge_recon_loss: 2755025.1000; val_gene_expr_recon_loss: 11462326.2667; val_masked_gp_l1_reg_loss: 87545.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96264.2031; val_chrom_access_recon_loss: 5949757.8000; val_global_loss: 20431745.8667; val_optim_loss: 20431745.8667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9470; val_auprc_score: 0.9348; val_best_acc_score: 0.8857; val_best_f1_score: 0.8907; train_kl_reg_loss: 81935.4141; train_edge_recon_loss: 2738587.1737; train_gene_expr_recon_loss: 11713857.9313; train_masked_gp_l1_reg_loss: 87526.7137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94981.4618; train_chrom_access_recon_loss: 6040148.3015; train_global_loss: 20757036.9160; train_optim_loss: 20757036.9160; val_kl_reg_loss: 81615.8062; val_edge_recon_loss: 2746802.9833; val_gene_expr_recon_loss: 11451137.9333; val_masked_gp_l1_reg_loss: 87783.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94531.7266; val_chrom_access_recon_loss: 5935807.8667; val_global_loss: 20397680.4000; val_optim_loss: 20397680.4000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9538; val_auprc_score: 0.9417; val_best_acc_score: 0.8936; val_best_f1_score: 0.8977; train_kl_reg_loss: 80870.5649; train_edge_recon_loss: 2741009.9389; train_gene_expr_recon_loss: 11680721.4580; train_masked_gp_l1_reg_loss: 87837.3562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93737.7201; train_chrom_access_recon_loss: 6022558.6145; train_global_loss: 20706735.6031; train_optim_loss: 20706735.6031; val_kl_reg_loss: 81114.4141; val_edge_recon_loss: 2723060.5167; val_gene_expr_recon_loss: 11444674.5333; val_masked_gp_l1_reg_loss: 87816.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93146.2344; val_chrom_access_recon_loss: 5928548.9333; val_global_loss: 20358360.9333; val_optim_loss: 20358360.9333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9549; val_auprc_score: 0.9410; val_best_acc_score: 0.8956; val_best_f1_score: 0.9013; train_kl_reg_loss: 78611.8693; train_edge_recon_loss: 2727048.1469; train_gene_expr_recon_loss: 11630343.4656; train_masked_gp_l1_reg_loss: 88019.4096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92991.4648; train_chrom_access_recon_loss: 5988369.7595; train_global_loss: 20605384.1832; train_optim_loss: 20605384.1832; val_kl_reg_loss: 78677.0214; val_edge_recon_loss: 2724718.6000; val_gene_expr_recon_loss: 11355326.8000; val_masked_gp_l1_reg_loss: 88169.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92633.9531; val_chrom_access_recon_loss: 5881912.1333; val_global_loss: 20221437.8667; val_optim_loss: 20221437.8667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9503; val_auprc_score: 0.9379; val_best_acc_score: 0.8874; val_best_f1_score: 0.8935; train_kl_reg_loss: 78584.3457; train_edge_recon_loss: 2727980.7595; train_gene_expr_recon_loss: 11610391.5420; train_masked_gp_l1_reg_loss: 88083.7168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92175.4815; train_chrom_access_recon_loss: 5976533.1985; train_global_loss: 20573749.1756; train_optim_loss: 20573749.1756; val_kl_reg_loss: 78146.0682; val_edge_recon_loss: 2747169.2000; val_gene_expr_recon_loss: 11389422.2667; val_masked_gp_l1_reg_loss: 88213.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92355.7031; val_chrom_access_recon_loss: 5908955.7333; val_global_loss: 20304262.2667; val_optim_loss: 20304262.2667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9556; val_auprc_score: 0.9438; val_best_acc_score: 0.8930; val_best_f1_score: 0.8989; train_kl_reg_loss: 78891.6177; train_edge_recon_loss: 2716699.7710; train_gene_expr_recon_loss: 11564034.3740; train_masked_gp_l1_reg_loss: 88046.7740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91459.8637; train_chrom_access_recon_loss: 5952288.7710; train_global_loss: 20491421.2672; train_optim_loss: 20491421.2672; val_kl_reg_loss: 79857.8250; val_edge_recon_loss: 2712726.1000; val_gene_expr_recon_loss: 11289804.5333; val_masked_gp_l1_reg_loss: 88054.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91167.7422; val_chrom_access_recon_loss: 5847970.0333; val_global_loss: 20109581.4667; val_optim_loss: 20109581.4667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9604; val_auprc_score: 0.9488; val_best_acc_score: 0.9038; val_best_f1_score: 0.9067; train_kl_reg_loss: 77385.7447; train_edge_recon_loss: 2710657.1050; train_gene_expr_recon_loss: 11531032.3435; train_masked_gp_l1_reg_loss: 87914.2728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90877.9002; train_chrom_access_recon_loss: 5931204.6527; train_global_loss: 20429071.9542; train_optim_loss: 20429071.9542; val_kl_reg_loss: 77870.4906; val_edge_recon_loss: 2720441.6000; val_gene_expr_recon_loss: 11236449.1333; val_masked_gp_l1_reg_loss: 87829.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90671.6953; val_chrom_access_recon_loss: 5844904.3000; val_global_loss: 20058166.6667; val_optim_loss: 20058166.6667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9568; val_auprc_score: 0.9461; val_best_acc_score: 0.8960; val_best_f1_score: 0.9012; train_kl_reg_loss: 77198.6963; train_edge_recon_loss: 2712957.3874; train_gene_expr_recon_loss: 11512867.5878; train_masked_gp_l1_reg_loss: 87685.0466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90503.3717; train_chrom_access_recon_loss: 5917302.6260; train_global_loss: 20398514.5954; train_optim_loss: 20398514.5954; val_kl_reg_loss: 78251.5437; val_edge_recon_loss: 2717802.0333; val_gene_expr_recon_loss: 11275722.8000; val_masked_gp_l1_reg_loss: 87624.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90353.5469; val_chrom_access_recon_loss: 5840343.7333; val_global_loss: 20090097.8667; val_optim_loss: 20090097.8667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9592; val_auprc_score: 0.9496; val_best_acc_score: 0.8989; val_best_f1_score: 0.9033; train_kl_reg_loss: 76659.6011; train_edge_recon_loss: 2704092.8969; train_gene_expr_recon_loss: 11488706.9160; train_masked_gp_l1_reg_loss: 87330.0358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90317.5572; train_chrom_access_recon_loss: 5904149.3053; train_global_loss: 20351256.2595; train_optim_loss: 20351256.2595; val_kl_reg_loss: 74661.7667; val_edge_recon_loss: 2726811.3000; val_gene_expr_recon_loss: 11224565.0000; val_masked_gp_l1_reg_loss: 87242.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90755.7188; val_chrom_access_recon_loss: 5810664.8667; val_global_loss: 20014700.6667; val_optim_loss: 20014700.6667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9583; val_auprc_score: 0.9452; val_best_acc_score: 0.9046; val_best_f1_score: 0.9090; train_kl_reg_loss: 75777.7523; train_edge_recon_loss: 2703679.4447; train_gene_expr_recon_loss: 11466444.0534; train_masked_gp_l1_reg_loss: 87039.0299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90511.4727; train_chrom_access_recon_loss: 5885640.9733; train_global_loss: 20309092.7328; train_optim_loss: 20309092.7328; val_kl_reg_loss: 75049.5990; val_edge_recon_loss: 2722903.2333; val_gene_expr_recon_loss: 11202259.0667; val_masked_gp_l1_reg_loss: 87011.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90933.8672; val_chrom_access_recon_loss: 5797011.9333; val_global_loss: 19975169.8667; val_optim_loss: 19975169.8667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9631; val_auprc_score: 0.9520; val_best_acc_score: 0.9082; val_best_f1_score: 0.9121; train_kl_reg_loss: 76482.3121; train_edge_recon_loss: 2697824.0763; train_gene_expr_recon_loss: 11452172.0458; train_masked_gp_l1_reg_loss: 86697.7456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90624.4522; train_chrom_access_recon_loss: 5874948.2634; train_global_loss: 20278748.8397; train_optim_loss: 20278748.8397; val_kl_reg_loss: 75337.4974; val_edge_recon_loss: 2713345.3833; val_gene_expr_recon_loss: 11192686.1333; val_masked_gp_l1_reg_loss: 86568.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91818.1719; val_chrom_access_recon_loss: 5783521.5667; val_global_loss: 19943276.6667; val_optim_loss: 19943276.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9667; val_auprc_score: 0.9559; val_best_acc_score: 0.9132; val_best_f1_score: 0.9175; train_kl_reg_loss: 75813.4299; train_edge_recon_loss: 2701079.2920; train_gene_expr_recon_loss: 11427669.0382; train_masked_gp_l1_reg_loss: 86192.6843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91601.9976; train_chrom_access_recon_loss: 5856328.8359; train_global_loss: 20238685.1908; train_optim_loss: 20238685.1908; val_kl_reg_loss: 73936.7677; val_edge_recon_loss: 2708073.3500; val_gene_expr_recon_loss: 11173753.6000; val_masked_gp_l1_reg_loss: 85981.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92065.6562; val_chrom_access_recon_loss: 5764257.0000; val_global_loss: 19898067.7333; val_optim_loss: 19898067.7333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9660; val_auprc_score: 0.9582; val_best_acc_score: 0.9150; val_best_f1_score: 0.9184; train_kl_reg_loss: 75212.7452; train_edge_recon_loss: 2700214.6832; train_gene_expr_recon_loss: 11403989.0611; train_masked_gp_l1_reg_loss: 85856.3473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92370.6529; train_chrom_access_recon_loss: 5843018.0496; train_global_loss: 20200661.4504; train_optim_loss: 20200661.4504; val_kl_reg_loss: 75698.6047; val_edge_recon_loss: 2716344.0833; val_gene_expr_recon_loss: 11116171.0000; val_masked_gp_l1_reg_loss: 85811.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93559.5859; val_chrom_access_recon_loss: 5743747.8000; val_global_loss: 19831333.3333; val_optim_loss: 19831333.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9655; val_auprc_score: 0.9548; val_best_acc_score: 0.9142; val_best_f1_score: 0.9173; train_kl_reg_loss: 75089.4760; train_edge_recon_loss: 2694986.0420; train_gene_expr_recon_loss: 11384735.2061; train_masked_gp_l1_reg_loss: 85700.8556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93167.5960; train_chrom_access_recon_loss: 5833228.4809; train_global_loss: 20166907.6183; train_optim_loss: 20166907.6183; val_kl_reg_loss: 74309.4474; val_edge_recon_loss: 2700790.9000; val_gene_expr_recon_loss: 11143624.3333; val_masked_gp_l1_reg_loss: 85506.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93932.8438; val_chrom_access_recon_loss: 5765747.0000; val_global_loss: 19863910.9333; val_optim_loss: 19863910.9333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9657; val_auprc_score: 0.9542; val_best_acc_score: 0.9148; val_best_f1_score: 0.9183; train_kl_reg_loss: 73844.2933; train_edge_recon_loss: 2693992.7462; train_gene_expr_recon_loss: 11380447.5038; train_masked_gp_l1_reg_loss: 85456.2963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93919.7174; train_chrom_access_recon_loss: 5824029.8130; train_global_loss: 20151690.4427; train_optim_loss: 20151690.4427; val_kl_reg_loss: 74081.2578; val_edge_recon_loss: 2704360.6000; val_gene_expr_recon_loss: 11089856.9333; val_masked_gp_l1_reg_loss: 85347.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93956.7500; val_chrom_access_recon_loss: 5718465.1000; val_global_loss: 19766068.0000; val_optim_loss: 19766068.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9648; val_auprc_score: 0.9546; val_best_acc_score: 0.9117; val_best_f1_score: 0.9147; train_kl_reg_loss: 91175.8978; train_edge_recon_loss: 2755778.0973; train_gene_expr_recon_loss: 10380539.5496; train_masked_gp_l1_reg_loss: 84919.1019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91862.9184; train_chrom_access_recon_loss: 5351136.5382; train_global_loss: 18755412.1374; train_optim_loss: 18755412.1374; val_kl_reg_loss: 34997.8953; val_edge_recon_loss: 2726377.7833; val_gene_expr_recon_loss: 10157882.4667; val_masked_gp_l1_reg_loss: 83746.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93770.7500; val_chrom_access_recon_loss: 5266194.2000; val_global_loss: 18362970.5333; val_optim_loss: 18362970.5333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9656; val_auprc_score: 0.9547; val_best_acc_score: 0.9120; val_best_f1_score: 0.9158; train_kl_reg_loss: 69060.9596; train_edge_recon_loss: 2700962.6679; train_gene_expr_recon_loss: 10345774.0229; train_masked_gp_l1_reg_loss: 82201.9788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94289.8974; train_chrom_access_recon_loss: 5323454.2176; train_global_loss: 18615743.7710; train_optim_loss: 18615743.7710; val_kl_reg_loss: 40681.7526; val_edge_recon_loss: 2722974.7667; val_gene_expr_recon_loss: 10101055.6000; val_masked_gp_l1_reg_loss: 80499.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94550.6094; val_chrom_access_recon_loss: 5225296.9667; val_global_loss: 18265059.8667; val_optim_loss: 18265059.8667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9711; val_auprc_score: 0.9628; val_best_acc_score: 0.9193; val_best_f1_score: 0.9217; train_kl_reg_loss: 63591.1342; train_edge_recon_loss: 2693822.8378; train_gene_expr_recon_loss: 10320845.3588; train_masked_gp_l1_reg_loss: 78743.2626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94669.1927; train_chrom_access_recon_loss: 5311482.5802; train_global_loss: 18563154.2748; train_optim_loss: 18563154.2748; val_kl_reg_loss: 44952.4245; val_edge_recon_loss: 2702280.2667; val_gene_expr_recon_loss: 10086468.5333; val_masked_gp_l1_reg_loss: 77168.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94350.8906; val_chrom_access_recon_loss: 5210502.2333; val_global_loss: 18215723.7333; val_optim_loss: 18215723.7333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9695; val_auprc_score: 0.9583; val_best_acc_score: 0.9205; val_best_f1_score: 0.9225; train_kl_reg_loss: 60612.3910; train_edge_recon_loss: 2691080.3511; train_gene_expr_recon_loss: 10295721.5420; train_masked_gp_l1_reg_loss: 75934.0163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94659.0737; train_chrom_access_recon_loss: 5291689.3321; train_global_loss: 18509696.8092; train_optim_loss: 18509696.8092; val_kl_reg_loss: 46332.3104; val_edge_recon_loss: 2700354.6500; val_gene_expr_recon_loss: 10029209.6000; val_masked_gp_l1_reg_loss: 74797.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95131.5625; val_chrom_access_recon_loss: 5178268.5000; val_global_loss: 18124093.7333; val_optim_loss: 18124093.7333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9684; val_auprc_score: 0.9574; val_best_acc_score: 0.9196; val_best_f1_score: 0.9221; train_kl_reg_loss: 59668.1747; train_edge_recon_loss: 2678964.3874; train_gene_expr_recon_loss: 10282359.0382; train_masked_gp_l1_reg_loss: 73809.7310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94738.8016; train_chrom_access_recon_loss: 5282625.8740; train_global_loss: 18472166.0763; train_optim_loss: 18472166.0763; val_kl_reg_loss: 49034.3385; val_edge_recon_loss: 2695186.4500; val_gene_expr_recon_loss: 10027863.1333; val_masked_gp_l1_reg_loss: 72870.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94186.8750; val_chrom_access_recon_loss: 5200977.9333; val_global_loss: 18140119.0667; val_optim_loss: 18140119.0667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9702; val_auprc_score: 0.9630; val_best_acc_score: 0.9209; val_best_f1_score: 0.9240; train_kl_reg_loss: 59085.9908; train_edge_recon_loss: 2679352.8359; train_gene_expr_recon_loss: 10266592.5649; train_masked_gp_l1_reg_loss: 72077.2581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94093.7003; train_chrom_access_recon_loss: 5266454.6794; train_global_loss: 18437656.9924; train_optim_loss: 18437656.9924; val_kl_reg_loss: 49977.1836; val_edge_recon_loss: 2689140.4667; val_gene_expr_recon_loss: 10060626.5333; val_masked_gp_l1_reg_loss: 71383.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94143.0156; val_chrom_access_recon_loss: 5189035.7333; val_global_loss: 18154306.6667; val_optim_loss: 18154306.6667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9688; val_auprc_score: 0.9598; val_best_acc_score: 0.9155; val_best_f1_score: 0.9185; train_kl_reg_loss: 57794.3789; train_edge_recon_loss: 2675717.5782; train_gene_expr_recon_loss: 10253785.4580; train_masked_gp_l1_reg_loss: 70818.6540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94058.7054; train_chrom_access_recon_loss: 5260837.2519; train_global_loss: 18413011.8321; train_optim_loss: 18413011.8321; val_kl_reg_loss: 51086.3148; val_edge_recon_loss: 2709716.3833; val_gene_expr_recon_loss: 10060337.4667; val_masked_gp_l1_reg_loss: 70306.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93900.2812; val_chrom_access_recon_loss: 5215184.1000; val_global_loss: 18200530.4000; val_optim_loss: 18200530.4000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9717; val_auprc_score: 0.9639; val_best_acc_score: 0.9229; val_best_f1_score: 0.9258; train_kl_reg_loss: 57377.7216; train_edge_recon_loss: 2681380.9198; train_gene_expr_recon_loss: 10248931.8931; train_masked_gp_l1_reg_loss: 69751.3219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93678.4154; train_chrom_access_recon_loss: 5260970.5496; train_global_loss: 18412090.8397; train_optim_loss: 18412090.8397; val_kl_reg_loss: 52295.1690; val_edge_recon_loss: 2678601.8333; val_gene_expr_recon_loss: 10042462.4667; val_masked_gp_l1_reg_loss: 69247.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93670.0859; val_chrom_access_recon_loss: 5181400.9333; val_global_loss: 18117677.4667; val_optim_loss: 18117677.4667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9724; val_auprc_score: 0.9645; val_best_acc_score: 0.9227; val_best_f1_score: 0.9254; train_kl_reg_loss: 57435.6828; train_edge_recon_loss: 2671599.0057; train_gene_expr_recon_loss: 10240129.3969; train_masked_gp_l1_reg_loss: 68763.1213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93410.9087; train_chrom_access_recon_loss: 5252050.5802; train_global_loss: 18383388.7023; train_optim_loss: 18383388.7023; val_kl_reg_loss: 52233.1385; val_edge_recon_loss: 2686534.9167; val_gene_expr_recon_loss: 10011240.6667; val_masked_gp_l1_reg_loss: 68357.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93450.5000; val_chrom_access_recon_loss: 5162180.3667; val_global_loss: 18073997.4667; val_optim_loss: 18073997.4667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9754; val_auprc_score: 0.9685; val_best_acc_score: 0.9289; val_best_f1_score: 0.9312; train_kl_reg_loss: 56753.2011; train_edge_recon_loss: 2675388.3531; train_gene_expr_recon_loss: 10228675.7786; train_masked_gp_l1_reg_loss: 67910.5754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93084.1099; train_chrom_access_recon_loss: 5242313.1221; train_global_loss: 18364125.1908; train_optim_loss: 18364125.1908; val_kl_reg_loss: 51803.4867; val_edge_recon_loss: 2678452.6500; val_gene_expr_recon_loss: 9974269.4000; val_masked_gp_l1_reg_loss: 67645.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93292.1484; val_chrom_access_recon_loss: 5146543.2667; val_global_loss: 18012006.8000; val_optim_loss: 18012006.8000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9754; val_auprc_score: 0.9682; val_best_acc_score: 0.9314; val_best_f1_score: 0.9332; train_kl_reg_loss: 56836.3090; train_edge_recon_loss: 2667091.4294; train_gene_expr_recon_loss: 10210145.7786; train_masked_gp_l1_reg_loss: 67256.1976; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92909.1344; train_chrom_access_recon_loss: 5236138.0000; train_global_loss: 18330376.8855; train_optim_loss: 18330376.8855; val_kl_reg_loss: 52991.5086; val_edge_recon_loss: 2674549.4667; val_gene_expr_recon_loss: 9995994.0667; val_masked_gp_l1_reg_loss: 66911.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93220.5391; val_chrom_access_recon_loss: 5144345.6667; val_global_loss: 18028013.4667; val_optim_loss: 18028013.4667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9731; val_auprc_score: 0.9644; val_best_acc_score: 0.9283; val_best_f1_score: 0.9309; train_kl_reg_loss: 56555.3215; train_edge_recon_loss: 2665650.4237; train_gene_expr_recon_loss: 10207062.9542; train_masked_gp_l1_reg_loss: 66601.4396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92972.6084; train_chrom_access_recon_loss: 5237247.0076; train_global_loss: 18326089.8321; train_optim_loss: 18326089.8321; val_kl_reg_loss: 53542.3914; val_edge_recon_loss: 2667101.3333; val_gene_expr_recon_loss: 9950397.2667; val_masked_gp_l1_reg_loss: 66282.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92948.9531; val_chrom_access_recon_loss: 5107995.2333; val_global_loss: 17938267.0667; val_optim_loss: 17938267.0667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9727; val_auprc_score: 0.9645; val_best_acc_score: 0.9255; val_best_f1_score: 0.9276; train_kl_reg_loss: 56706.9759; train_edge_recon_loss: 2670306.2424; train_gene_expr_recon_loss: 10199227.8779; train_masked_gp_l1_reg_loss: 66051.6812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92698.4962; train_chrom_access_recon_loss: 5229412.0305; train_global_loss: 18314403.2977; train_optim_loss: 18314403.2977; val_kl_reg_loss: 52697.8727; val_edge_recon_loss: 2676363.4333; val_gene_expr_recon_loss: 9981964.1333; val_masked_gp_l1_reg_loss: 65906.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92498.8438; val_chrom_access_recon_loss: 5162027.2667; val_global_loss: 18031458.9333; val_optim_loss: 18031458.9333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9773; val_auprc_score: 0.9714; val_best_acc_score: 0.9316; val_best_f1_score: 0.9338; train_kl_reg_loss: 55603.5201; train_edge_recon_loss: 2671087.0210; train_gene_expr_recon_loss: 10190898.2595; train_masked_gp_l1_reg_loss: 65697.1247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92471.7578; train_chrom_access_recon_loss: 5222983.6450; train_global_loss: 18298741.2366; train_optim_loss: 18298741.2366; val_kl_reg_loss: 51036.0411; val_edge_recon_loss: 2665424.4333; val_gene_expr_recon_loss: 9999430.4667; val_masked_gp_l1_reg_loss: 65443.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92828.6562; val_chrom_access_recon_loss: 5153709.6333; val_global_loss: 18027872.6667; val_optim_loss: 18027872.6667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9730; val_auprc_score: 0.9640; val_best_acc_score: 0.9282; val_best_f1_score: 0.9307; train_kl_reg_loss: 56404.3917; train_edge_recon_loss: 2663832.6489; train_gene_expr_recon_loss: 10192187.0611; train_masked_gp_l1_reg_loss: 65260.4935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92287.6869; train_chrom_access_recon_loss: 5218316.5878; train_global_loss: 18288288.9008; train_optim_loss: 18288288.9008; val_kl_reg_loss: 54614.0388; val_edge_recon_loss: 2691028.4333; val_gene_expr_recon_loss: 9924983.4000; val_masked_gp_l1_reg_loss: 64974.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92270.9844; val_chrom_access_recon_loss: 5125728.5333; val_global_loss: 17953599.2000; val_optim_loss: 17953599.2000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9757; val_auprc_score: 0.9681; val_best_acc_score: 0.9310; val_best_f1_score: 0.9322; train_kl_reg_loss: 55971.9837; train_edge_recon_loss: 2665574.2767; train_gene_expr_recon_loss: 10186292.4504; train_masked_gp_l1_reg_loss: 64812.9920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92357.7583; train_chrom_access_recon_loss: 5219146.2481; train_global_loss: 18284155.7557; train_optim_loss: 18284155.7557; val_kl_reg_loss: 52335.8630; val_edge_recon_loss: 2679472.3833; val_gene_expr_recon_loss: 9973147.9333; val_masked_gp_l1_reg_loss: 64767.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92142.0469; val_chrom_access_recon_loss: 5158827.9667; val_global_loss: 18020692.8000; val_optim_loss: 18020692.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9721; val_auprc_score: 0.9637; val_best_acc_score: 0.9221; val_best_f1_score: 0.9248; train_kl_reg_loss: 55488.2266; train_edge_recon_loss: 2667161.0592; train_gene_expr_recon_loss: 10166526.0840; train_masked_gp_l1_reg_loss: 64068.9628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74703.3121; train_chrom_access_recon_loss: 5209404.6870; train_global_loss: 18237352.3817; train_optim_loss: 18237352.3817; val_kl_reg_loss: 53914.7898; val_edge_recon_loss: 2698660.2000; val_gene_expr_recon_loss: 10005652.0000; val_masked_gp_l1_reg_loss: 63864.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72335.5078; val_chrom_access_recon_loss: 5171407.7000; val_global_loss: 18065835.6000; val_optim_loss: 18065835.6000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9781; val_auprc_score: 0.9731; val_best_acc_score: 0.9317; val_best_f1_score: 0.9335; train_kl_reg_loss: 56994.0153; train_edge_recon_loss: 2662445.3721; train_gene_expr_recon_loss: 10145911.1374; train_masked_gp_l1_reg_loss: 63810.8601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71685.1275; train_chrom_access_recon_loss: 5197123.6603; train_global_loss: 18197970.0611; train_optim_loss: 18197970.0611; val_kl_reg_loss: 53989.2445; val_edge_recon_loss: 2677599.9333; val_gene_expr_recon_loss: 9942091.4000; val_masked_gp_l1_reg_loss: 63784.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71360.8125; val_chrom_access_recon_loss: 5111495.0667; val_global_loss: 17920321.7333; val_optim_loss: 17920321.7333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9760; val_auprc_score: 0.9672; val_best_acc_score: 0.9309; val_best_f1_score: 0.9327; train_kl_reg_loss: 57574.2738; train_edge_recon_loss: 2657991.4580; train_gene_expr_recon_loss: 10158150.9389; train_masked_gp_l1_reg_loss: 63736.2754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71039.1334; train_chrom_access_recon_loss: 5203967.5115; train_global_loss: 18212459.6794; train_optim_loss: 18212459.6794; val_kl_reg_loss: 54972.7568; val_edge_recon_loss: 2676961.5833; val_gene_expr_recon_loss: 9958718.8000; val_masked_gp_l1_reg_loss: 63705.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70726.3906; val_chrom_access_recon_loss: 5123881.2333; val_global_loss: 17948965.4667; val_optim_loss: 17948965.4667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9734; val_auprc_score: 0.9621; val_best_acc_score: 0.9270; val_best_f1_score: 0.9292; train_kl_reg_loss: 57902.1316; train_edge_recon_loss: 2668068.8473; train_gene_expr_recon_loss: 10148884.7252; train_masked_gp_l1_reg_loss: 63691.9618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70536.8486; train_chrom_access_recon_loss: 5199669.6374; train_global_loss: 18208754.0305; train_optim_loss: 18208754.0305; val_kl_reg_loss: 55631.2565; val_edge_recon_loss: 2678154.4833; val_gene_expr_recon_loss: 9914273.2667; val_masked_gp_l1_reg_loss: 63652.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70205.8203; val_chrom_access_recon_loss: 5117311.9667; val_global_loss: 17899230.0000; val_optim_loss: 17899230.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9774; val_auprc_score: 0.9680; val_best_acc_score: 0.9312; val_best_f1_score: 0.9332; train_kl_reg_loss: 58641.6594; train_edge_recon_loss: 2655281.1813; train_gene_expr_recon_loss: 10148738.5649; train_masked_gp_l1_reg_loss: 63620.3537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70022.4613; train_chrom_access_recon_loss: 5199754.5763; train_global_loss: 18196058.7481; train_optim_loss: 18196058.7481; val_kl_reg_loss: 56233.3716; val_edge_recon_loss: 2664565.1833; val_gene_expr_recon_loss: 9934002.6000; val_masked_gp_l1_reg_loss: 63595.7617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69771.0547; val_chrom_access_recon_loss: 5117457.0333; val_global_loss: 17905625.2000; val_optim_loss: 17905625.2000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9747; val_auprc_score: 0.9650; val_best_acc_score: 0.9285; val_best_f1_score: 0.9299; train_kl_reg_loss: 58011.2380; train_edge_recon_loss: 2664561.2710; train_gene_expr_recon_loss: 10151029.9237; train_masked_gp_l1_reg_loss: 63552.7659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69541.3495; train_chrom_access_recon_loss: 5195899.2328; train_global_loss: 18202595.8168; train_optim_loss: 18202595.8168; val_kl_reg_loss: 54998.0224; val_edge_recon_loss: 2688792.8333; val_gene_expr_recon_loss: 9932695.7333; val_masked_gp_l1_reg_loss: 63525.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69519.0078; val_chrom_access_recon_loss: 5098522.3333; val_global_loss: 17908052.9333; val_optim_loss: 17908052.9333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9714; val_auprc_score: 0.9604; val_best_acc_score: 0.9281; val_best_f1_score: 0.9305; train_kl_reg_loss: 57647.9723; train_edge_recon_loss: 2659745.3721; train_gene_expr_recon_loss: 10143282.9618; train_masked_gp_l1_reg_loss: 63495.4671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69337.7517; train_chrom_access_recon_loss: 5196686.3702; train_global_loss: 18190195.8931; train_optim_loss: 18190195.8931; val_kl_reg_loss: 55457.5823; val_edge_recon_loss: 2676518.2000; val_gene_expr_recon_loss: 9964254.4000; val_masked_gp_l1_reg_loss: 63465.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69072.0703; val_chrom_access_recon_loss: 5132127.1333; val_global_loss: 17960894.1333; val_optim_loss: 17960894.1333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9759; val_auprc_score: 0.9646; val_best_acc_score: 0.9316; val_best_f1_score: 0.9340; train_kl_reg_loss: 58175.2000; train_edge_recon_loss: 2662715.4046; train_gene_expr_recon_loss: 10159765.3130; train_masked_gp_l1_reg_loss: 63437.1157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68905.6804; train_chrom_access_recon_loss: 5208270.4198; train_global_loss: 18221269.0840; train_optim_loss: 18221269.0840; val_kl_reg_loss: 55743.9393; val_edge_recon_loss: 2655586.6500; val_gene_expr_recon_loss: 9964698.4000; val_masked_gp_l1_reg_loss: 63407.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68687.4453; val_chrom_access_recon_loss: 5137663.5000; val_global_loss: 17945786.2667; val_optim_loss: 17945786.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9745; val_auprc_score: 0.9655; val_best_acc_score: 0.9262; val_best_f1_score: 0.9291; train_kl_reg_loss: 58138.7037; train_edge_recon_loss: 2658560.2443; train_gene_expr_recon_loss: 10143977.3817; train_masked_gp_l1_reg_loss: 63333.9318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66877.7801; train_chrom_access_recon_loss: 5194631.3015; train_global_loss: 18185519.3130; train_optim_loss: 18185519.3130; val_kl_reg_loss: 55794.4021; val_edge_recon_loss: 2684825.8500; val_gene_expr_recon_loss: 9932576.3333; val_masked_gp_l1_reg_loss: 63307.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66637.1484; val_chrom_access_recon_loss: 5119699.3667; val_global_loss: 17922841.2000; val_optim_loss: 17922841.2000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9772; val_auprc_score: 0.9715; val_best_acc_score: 0.9307; val_best_f1_score: 0.9327; train_kl_reg_loss: 58292.2658; train_edge_recon_loss: 2659345.3893; train_gene_expr_recon_loss: 10136758.0611; train_masked_gp_l1_reg_loss: 63298.3119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66571.4559; train_chrom_access_recon_loss: 5191760.5076; train_global_loss: 18176025.9542; train_optim_loss: 18176025.9542; val_kl_reg_loss: 55668.2365; val_edge_recon_loss: 2668638.5500; val_gene_expr_recon_loss: 9934601.7333; val_masked_gp_l1_reg_loss: 63290.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66514.2344; val_chrom_access_recon_loss: 5133070.4333; val_global_loss: 17921783.0667; val_optim_loss: 17921783.0667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9744; val_auprc_score: 0.9671; val_best_acc_score: 0.9289; val_best_f1_score: 0.9312; train_kl_reg_loss: 58201.0774; train_edge_recon_loss: 2662275.7557; train_gene_expr_recon_loss: 10145394.2519; train_masked_gp_l1_reg_loss: 63284.4593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66462.5374; train_chrom_access_recon_loss: 5198839.5573; train_global_loss: 18194457.6336; train_optim_loss: 18194457.6336; val_kl_reg_loss: 55468.4862; val_edge_recon_loss: 2684032.3500; val_gene_expr_recon_loss: 9910436.0667; val_masked_gp_l1_reg_loss: 63279.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66411.8203; val_chrom_access_recon_loss: 5095218.4667; val_global_loss: 17874846.4000; val_optim_loss: 17874846.4000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9780; val_auprc_score: 0.9716; val_best_acc_score: 0.9328; val_best_f1_score: 0.9339; train_kl_reg_loss: 58141.5567; train_edge_recon_loss: 2662754.1412; train_gene_expr_recon_loss: 10144120.7405; train_masked_gp_l1_reg_loss: 63274.9315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66368.7059; train_chrom_access_recon_loss: 5196532.0038; train_global_loss: 18191192.1985; train_optim_loss: 18191192.1985; val_kl_reg_loss: 55576.8164; val_edge_recon_loss: 2670713.0833; val_gene_expr_recon_loss: 9921471.0000; val_masked_gp_l1_reg_loss: 63266.7461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66326.4922; val_chrom_access_recon_loss: 5128141.3667; val_global_loss: 17905495.6000; val_optim_loss: 17905495.6000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9732; val_auprc_score: 0.9659; val_best_acc_score: 0.9260; val_best_f1_score: 0.9286; train_kl_reg_loss: 58210.9449; train_edge_recon_loss: 2667193.1088; train_gene_expr_recon_loss: 10150927.5496; train_masked_gp_l1_reg_loss: 63264.0684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66299.0843; train_chrom_access_recon_loss: 5195273.5802; train_global_loss: 18201168.2901; train_optim_loss: 18201168.2901; val_kl_reg_loss: 55913.3911; val_edge_recon_loss: 2678938.3333; val_gene_expr_recon_loss: 10008061.4000; val_masked_gp_l1_reg_loss: 63258.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66275.4219; val_chrom_access_recon_loss: 5163121.8667; val_global_loss: 18035569.0667; val_optim_loss: 18035569.0667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9753; val_auprc_score: 0.9667; val_best_acc_score: 0.9310; val_best_f1_score: 0.9331; train_kl_reg_loss: 58155.4970; train_edge_recon_loss: 2662592.6317; train_gene_expr_recon_loss: 10143778.0305; train_masked_gp_l1_reg_loss: 63255.7701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66253.1426; train_chrom_access_recon_loss: 5199113.8282; train_global_loss: 18193148.9466; train_optim_loss: 18193148.9466; val_kl_reg_loss: 55943.7831; val_edge_recon_loss: 2668588.0167; val_gene_expr_recon_loss: 9922913.5333; val_masked_gp_l1_reg_loss: 63253.0586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66222.9609; val_chrom_access_recon_loss: 5108772.8000; val_global_loss: 17885694.0000; val_optim_loss: 17885694.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9729; val_auprc_score: 0.9613; val_best_acc_score: 0.9306; val_best_f1_score: 0.9328; train_kl_reg_loss: 58172.4855; train_edge_recon_loss: 2664655.6889; train_gene_expr_recon_loss: 10136644.7557; train_masked_gp_l1_reg_loss: 63248.5724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66194.3732; train_chrom_access_recon_loss: 5197558.6947; train_global_loss: 18186474.6107; train_optim_loss: 18186474.6107; val_kl_reg_loss: 56004.2312; val_edge_recon_loss: 2687133.4667; val_gene_expr_recon_loss: 9934851.0667; val_masked_gp_l1_reg_loss: 63245.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66161.9141; val_chrom_access_recon_loss: 5121737.4333; val_global_loss: 17929133.0667; val_optim_loss: 17929133.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9805; val_auprc_score: 0.9718; val_best_acc_score: 0.9388; val_best_f1_score: 0.9404; train_kl_reg_loss: 58179.5838; train_edge_recon_loss: 2663330.4160; train_gene_expr_recon_loss: 10149928.0763; train_masked_gp_l1_reg_loss: 63237.5601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65981.0353; train_chrom_access_recon_loss: 5201912.5534; train_global_loss: 18202569.2519; train_optim_loss: 18202569.2519; val_kl_reg_loss: 56155.3383; val_edge_recon_loss: 2649182.3667; val_gene_expr_recon_loss: 9934483.0667; val_masked_gp_l1_reg_loss: 63235.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65958.3047; val_chrom_access_recon_loss: 5108942.7333; val_global_loss: 17877956.5333; val_optim_loss: 17877956.5333
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9756; val_auprc_score: 0.9664; val_best_acc_score: 0.9310; val_best_f1_score: 0.9332; train_kl_reg_loss: 58318.9845; train_edge_recon_loss: 2658839.0859; train_gene_expr_recon_loss: 10148737.5344; train_masked_gp_l1_reg_loss: 63234.2673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65952.4639; train_chrom_access_recon_loss: 5203924.4313; train_global_loss: 18199006.8550; train_optim_loss: 18199006.8550; val_kl_reg_loss: 56008.6940; val_edge_recon_loss: 2681024.2667; val_gene_expr_recon_loss: 9946233.0667; val_masked_gp_l1_reg_loss: 63233.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65947.1094; val_chrom_access_recon_loss: 5131762.7000; val_global_loss: 17944208.9333; val_optim_loss: 17944208.9333
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9739; val_auprc_score: 0.9655; val_best_acc_score: 0.9221; val_best_f1_score: 0.9238; train_kl_reg_loss: 58162.8595; train_edge_recon_loss: 2664979.4332; train_gene_expr_recon_loss: 10149046.3130; train_masked_gp_l1_reg_loss: 63232.7007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65942.2948; train_chrom_access_recon_loss: 5198396.5649; train_global_loss: 18199760.0000; train_optim_loss: 18199760.0000; val_kl_reg_loss: 55905.4497; val_edge_recon_loss: 2702717.8833; val_gene_expr_recon_loss: 9916201.4667; val_masked_gp_l1_reg_loss: 63232.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65938.2500; val_chrom_access_recon_loss: 5110911.0667; val_global_loss: 17914906.1333; val_optim_loss: 17914906.1333
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9754; val_auprc_score: 0.9678; val_best_acc_score: 0.9318; val_best_f1_score: 0.9335; train_kl_reg_loss: 58293.5944; train_edge_recon_loss: 2658825.7882; train_gene_expr_recon_loss: 10150792.0611; train_masked_gp_l1_reg_loss: 63231.6330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65935.1144; train_chrom_access_recon_loss: 5199780.5763; train_global_loss: 18196858.6107; train_optim_loss: 18196858.6107; val_kl_reg_loss: 56070.5003; val_edge_recon_loss: 2682554.0500; val_gene_expr_recon_loss: 9909112.2000; val_masked_gp_l1_reg_loss: 63231.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65931.2109; val_chrom_access_recon_loss: 5121765.9333; val_global_loss: 17898664.9333; val_optim_loss: 17898664.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 31 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9719
val AUPRC score: 0.9588
val best accuracy score: 0.9271
val best F1 score: 0.9298
val target rna MSE score: 1.7112
val source rna MSE score: 0.4722
val target atac MSE score: 0.3260
val source atac MSE score: 0.1024
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
