[True]
Run timestamp: 24072023_171534_77.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_77']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9188; val_auprc_score: 0.9332; val_best_acc_score: 0.5036; val_best_f1_score: 0.6683; train_kl_reg_loss: 11432.9384; train_edge_recon_loss: 34743083.5556; train_gene_expr_recon_loss: 30555754.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10859182.0000; train_global_loss: 76169454.2222; train_optim_loss: 76169454.2222; val_kl_reg_loss: 18885.1367; val_edge_recon_loss: 40648000.0000; val_gene_expr_recon_loss: 29273468.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10680858.0000; val_global_loss: 80621208.0000; val_optim_loss: 80621208.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8967; val_auprc_score: 0.9099; val_best_acc_score: 0.5074; val_best_f1_score: 0.6700; train_kl_reg_loss: 65072.6144; train_edge_recon_loss: 34781377.3333; train_gene_expr_recon_loss: 28813952.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10738342.1111; train_global_loss: 74398743.1111; train_optim_loss: 74398743.1111; val_kl_reg_loss: 83071.9062; val_edge_recon_loss: 40651152.0000; val_gene_expr_recon_loss: 27271932.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10523801.0000; val_global_loss: 78529960.0000; val_optim_loss: 78529960.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8844; val_auprc_score: 0.9017; val_best_acc_score: 0.5075; val_best_f1_score: 0.6700; train_kl_reg_loss: 142183.5087; train_edge_recon_loss: 34789842.2222; train_gene_expr_recon_loss: 26740313.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10506664.6667; train_global_loss: 72179003.5556; train_optim_loss: 72179003.5556; val_kl_reg_loss: 149689.1094; val_edge_recon_loss: 40652392.0000; val_gene_expr_recon_loss: 25408332.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10317068.0000; val_global_loss: 76527480.0000; val_optim_loss: 76527480.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8973; val_auprc_score: 0.9111; val_best_acc_score: 0.5043; val_best_f1_score: 0.6686; train_kl_reg_loss: 245326.1094; train_edge_recon_loss: 34812924.4444; train_gene_expr_recon_loss: 24962628.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10323926.0000; train_global_loss: 70344806.2222; train_optim_loss: 70344806.2222; val_kl_reg_loss: 164970.6875; val_edge_recon_loss: 40654796.0000; val_gene_expr_recon_loss: 24040084.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10149246.0000; val_global_loss: 75009096.0000; val_optim_loss: 75009096.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8926; val_auprc_score: 0.8985; val_best_acc_score: 0.5043; val_best_f1_score: 0.6686; train_kl_reg_loss: 289701.3021; train_edge_recon_loss: 34841414.6667; train_gene_expr_recon_loss: 23819854.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10098251.4444; train_global_loss: 69049220.4444; train_optim_loss: 69049220.4444; val_kl_reg_loss: 174634.2812; val_edge_recon_loss: 40653696.0000; val_gene_expr_recon_loss: 23218964.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10061624.0000; val_global_loss: 74108920.0000; val_optim_loss: 74108920.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8939; val_auprc_score: 0.8974; val_best_acc_score: 0.5094; val_best_f1_score: 0.6709; train_kl_reg_loss: 322471.1285; train_edge_recon_loss: 34844899.1111; train_gene_expr_recon_loss: 22964726.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10068189.4444; train_global_loss: 68200284.4444; train_optim_loss: 68200284.4444; val_kl_reg_loss: 226779.7500; val_edge_recon_loss: 40650508.0000; val_gene_expr_recon_loss: 22571372.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9965458.0000; val_global_loss: 73414120.0000; val_optim_loss: 73414120.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8816; val_auprc_score: 0.8847; val_best_acc_score: 0.5174; val_best_f1_score: 0.6744; train_kl_reg_loss: 357156.1701; train_edge_recon_loss: 34824399.1111; train_gene_expr_recon_loss: 22785679.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10019820.6667; train_global_loss: 67987056.0000; train_optim_loss: 67987056.0000; val_kl_reg_loss: 277508.4062; val_edge_recon_loss: 40644020.0000; val_gene_expr_recon_loss: 22082888.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9900999.0000; val_global_loss: 72905416.0000; val_optim_loss: 72905416.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8819; val_auprc_score: 0.8862; val_best_acc_score: 0.5181; val_best_f1_score: 0.6744; train_kl_reg_loss: 355794.8299; train_edge_recon_loss: 34855403.1111; train_gene_expr_recon_loss: 22013148.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9890389.7778; train_global_loss: 67114738.2222; train_optim_loss: 67114738.2222; val_kl_reg_loss: 351980.7188; val_edge_recon_loss: 40640732.0000; val_gene_expr_recon_loss: 21716836.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9838270.0000; val_global_loss: 72547816.0000; val_optim_loss: 72547816.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8882; val_auprc_score: 0.8901; val_best_acc_score: 0.5319; val_best_f1_score: 0.6807; train_kl_reg_loss: 371995.0625; train_edge_recon_loss: 34830502.6667; train_gene_expr_recon_loss: 21760624.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9866865.8889; train_global_loss: 66829988.4444; train_optim_loss: 66829988.4444; val_kl_reg_loss: 318559.4375; val_edge_recon_loss: 40631524.0000; val_gene_expr_recon_loss: 21482374.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9809704.0000; val_global_loss: 72242160.0000; val_optim_loss: 72242160.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8922; val_auprc_score: 0.8868; val_best_acc_score: 0.5536; val_best_f1_score: 0.6905; train_kl_reg_loss: 374818.4479; train_edge_recon_loss: 34830091.1111; train_gene_expr_recon_loss: 21470514.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9804104.3333; train_global_loss: 66479528.8889; train_optim_loss: 66479528.8889; val_kl_reg_loss: 314080.1875; val_edge_recon_loss: 40619540.0000; val_gene_expr_recon_loss: 21307316.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9785057.0000; val_global_loss: 72025992.0000; val_optim_loss: 72025992.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9021; val_auprc_score: 0.9013; val_best_acc_score: 0.5757; val_best_f1_score: 0.7008; train_kl_reg_loss: 357148.8472; train_edge_recon_loss: 34847450.2222; train_gene_expr_recon_loss: 21451972.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9848705.0000; train_global_loss: 66505276.0000; train_optim_loss: 66505276.0000; val_kl_reg_loss: 272314.6562; val_edge_recon_loss: 40607348.0000; val_gene_expr_recon_loss: 21248570.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9764417.0000; val_global_loss: 71892648.0000; val_optim_loss: 71892648.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9115; val_auprc_score: 0.9050; val_best_acc_score: 0.6351; val_best_f1_score: 0.7307; train_kl_reg_loss: 347517.2604; train_edge_recon_loss: 34832472.0000; train_gene_expr_recon_loss: 21364341.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9873708.1111; train_global_loss: 66418038.2222; train_optim_loss: 66418038.2222; val_kl_reg_loss: 292298.5625; val_edge_recon_loss: 40578376.0000; val_gene_expr_recon_loss: 21128920.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9748618.0000; val_global_loss: 71748216.0000; val_optim_loss: 71748216.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9159; val_auprc_score: 0.9091; val_best_acc_score: 0.7061; val_best_f1_score: 0.7694; train_kl_reg_loss: 338539.7812; train_edge_recon_loss: 34832442.6667; train_gene_expr_recon_loss: 21197586.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9756213.3333; train_global_loss: 66124781.3333; train_optim_loss: 66124781.3333; val_kl_reg_loss: 262078.3438; val_edge_recon_loss: 40532444.0000; val_gene_expr_recon_loss: 21052324.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9717024.0000; val_global_loss: 71563872.0000; val_optim_loss: 71563872.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9167; val_auprc_score: 0.9124; val_best_acc_score: 0.7657; val_best_f1_score: 0.8045; train_kl_reg_loss: 323845.9549; train_edge_recon_loss: 34850960.4444; train_gene_expr_recon_loss: 21085195.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9754043.5556; train_global_loss: 66014045.7778; train_optim_loss: 66014045.7778; val_kl_reg_loss: 286065.5625; val_edge_recon_loss: 40469028.0000; val_gene_expr_recon_loss: 20990806.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9708330.0000; val_global_loss: 71454224.0000; val_optim_loss: 71454224.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9241; val_auprc_score: 0.9202; val_best_acc_score: 0.8228; val_best_f1_score: 0.8414; train_kl_reg_loss: 311589.2569; train_edge_recon_loss: 34797540.0000; train_gene_expr_recon_loss: 21039840.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9737259.0000; train_global_loss: 65886228.0000; train_optim_loss: 65886228.0000; val_kl_reg_loss: 271018.2500; val_edge_recon_loss: 40372260.0000; val_gene_expr_recon_loss: 20959184.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9712594.0000; val_global_loss: 71315056.0000; val_optim_loss: 71315056.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9251; val_auprc_score: 0.9140; val_best_acc_score: 0.8550; val_best_f1_score: 0.8607; train_kl_reg_loss: 310851.2153; train_edge_recon_loss: 34802465.3333; train_gene_expr_recon_loss: 21010078.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9736822.1111; train_global_loss: 65860218.2222; train_optim_loss: 65860218.2222; val_kl_reg_loss: 249772.5000; val_edge_recon_loss: 40183828.0000; val_gene_expr_recon_loss: 20916104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9703890.0000; val_global_loss: 71053592.0000; val_optim_loss: 71053592.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9284; val_auprc_score: 0.9113; val_best_acc_score: 0.8533; val_best_f1_score: 0.8494; train_kl_reg_loss: 294415.1198; train_edge_recon_loss: 34752205.3333; train_gene_expr_recon_loss: 20982409.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9737340.6667; train_global_loss: 65766369.7778; train_optim_loss: 65766369.7778; val_kl_reg_loss: 229615.9375; val_edge_recon_loss: 39928248.0000; val_gene_expr_recon_loss: 20887232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9683772.0000; val_global_loss: 70728864.0000; val_optim_loss: 70728864.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9259; val_auprc_score: 0.9113; val_best_acc_score: 0.8142; val_best_f1_score: 0.8375; train_kl_reg_loss: 284894.9288; train_edge_recon_loss: 34714182.2222; train_gene_expr_recon_loss: 20884942.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9721987.4444; train_global_loss: 65606007.1111; train_optim_loss: 65606007.1111; val_kl_reg_loss: 223657.4062; val_edge_recon_loss: 39471868.0000; val_gene_expr_recon_loss: 20871574.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9682645.0000; val_global_loss: 70249744.0000; val_optim_loss: 70249744.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9293; val_auprc_score: 0.9139; val_best_acc_score: 0.8587; val_best_f1_score: 0.8693; train_kl_reg_loss: 269739.3941; train_edge_recon_loss: 34563301.7778; train_gene_expr_recon_loss: 20965866.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9743782.0000; train_global_loss: 65542690.6667; train_optim_loss: 65542690.6667; val_kl_reg_loss: 200043.5312; val_edge_recon_loss: 38451044.0000; val_gene_expr_recon_loss: 20881748.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9679241.0000; val_global_loss: 69212080.0000; val_optim_loss: 69212080.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9341; val_auprc_score: 0.9200; val_best_acc_score: 0.8636; val_best_f1_score: 0.8722; train_kl_reg_loss: 214764.3559; train_edge_recon_loss: 34288210.6667; train_gene_expr_recon_loss: 21034198.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9694022.3333; train_global_loss: 65231195.5556; train_optim_loss: 65231195.5556; val_kl_reg_loss: 186844.2188; val_edge_recon_loss: 36163492.0000; val_gene_expr_recon_loss: 20943968.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9681780.0000; val_global_loss: 66976084.0000; val_optim_loss: 66976084.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9183; val_auprc_score: 0.9036; val_best_acc_score: 0.8417; val_best_f1_score: 0.8502; train_kl_reg_loss: 121121.6762; train_edge_recon_loss: 33051508.8889; train_gene_expr_recon_loss: 21264304.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9782760.4444; train_global_loss: 64219696.0000; train_optim_loss: 64219696.0000; val_kl_reg_loss: 60380.5391; val_edge_recon_loss: 31472818.0000; val_gene_expr_recon_loss: 21488566.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9768316.0000; val_global_loss: 62790080.0000; val_optim_loss: 62790080.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9109; val_auprc_score: 0.8922; val_best_acc_score: 0.8375; val_best_f1_score: 0.8471; train_kl_reg_loss: 78258.1801; train_edge_recon_loss: 30081728.2222; train_gene_expr_recon_loss: 21761415.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9875937.8889; train_global_loss: 61797339.5556; train_optim_loss: 61797339.5556; val_kl_reg_loss: 116105.0781; val_edge_recon_loss: 28954414.0000; val_gene_expr_recon_loss: 21943612.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9950982.0000; val_global_loss: 60965112.0000; val_optim_loss: 60965112.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9112; val_auprc_score: 0.8921; val_best_acc_score: 0.8359; val_best_f1_score: 0.8439; train_kl_reg_loss: 131091.0035; train_edge_recon_loss: 29080203.1111; train_gene_expr_recon_loss: 21463359.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9816505.6667; train_global_loss: 60491159.5556; train_optim_loss: 60491159.5556; val_kl_reg_loss: 125721.5156; val_edge_recon_loss: 29044098.0000; val_gene_expr_recon_loss: 21417116.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9747527.0000; val_global_loss: 60334464.0000; val_optim_loss: 60334464.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9052; val_auprc_score: 0.8757; val_best_acc_score: 0.8370; val_best_f1_score: 0.8521; train_kl_reg_loss: 163173.6745; train_edge_recon_loss: 28764204.0000; train_gene_expr_recon_loss: 21285303.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9740151.4444; train_global_loss: 59952832.8889; train_optim_loss: 59952832.8889; val_kl_reg_loss: 183330.7969; val_edge_recon_loss: 28358250.0000; val_gene_expr_recon_loss: 21210488.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9713195.0000; val_global_loss: 59465264.0000; val_optim_loss: 59465264.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9092; val_auprc_score: 0.8828; val_best_acc_score: 0.8406; val_best_f1_score: 0.8535; train_kl_reg_loss: 199839.4375; train_edge_recon_loss: 28417292.6667; train_gene_expr_recon_loss: 21141332.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9760587.4444; train_global_loss: 59519050.6667; train_optim_loss: 59519050.6667; val_kl_reg_loss: 207575.3906; val_edge_recon_loss: 28040346.0000; val_gene_expr_recon_loss: 21099818.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9717835.0000; val_global_loss: 59065576.0000; val_optim_loss: 59065576.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9162; val_auprc_score: 0.8931; val_best_acc_score: 0.8448; val_best_f1_score: 0.8558; train_kl_reg_loss: 232597.5503; train_edge_recon_loss: 28308180.8889; train_gene_expr_recon_loss: 21145024.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9759436.0000; train_global_loss: 59445238.6667; train_optim_loss: 59445238.6667; val_kl_reg_loss: 168921.6719; val_edge_recon_loss: 28078396.0000; val_gene_expr_recon_loss: 21073718.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9681003.0000; val_global_loss: 59002040.0000; val_optim_loss: 59002040.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9083; val_auprc_score: 0.8799; val_best_acc_score: 0.8397; val_best_f1_score: 0.8510; train_kl_reg_loss: 251024.7917; train_edge_recon_loss: 28123162.0000; train_gene_expr_recon_loss: 21225528.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9773359.7778; train_global_loss: 59373074.2222; train_optim_loss: 59373074.2222; val_kl_reg_loss: 186086.3594; val_edge_recon_loss: 28324818.0000; val_gene_expr_recon_loss: 21017070.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9682882.0000; val_global_loss: 59210856.0000; val_optim_loss: 59210856.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9188; val_auprc_score: 0.8935; val_best_acc_score: 0.8469; val_best_f1_score: 0.8594; train_kl_reg_loss: 276507.2083; train_edge_recon_loss: 27977721.7778; train_gene_expr_recon_loss: 20928922.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9642926.0000; train_global_loss: 58826076.4444; train_optim_loss: 58826076.4444; val_kl_reg_loss: 199601.4375; val_edge_recon_loss: 27950916.0000; val_gene_expr_recon_loss: 20952802.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9656446.0000; val_global_loss: 58759768.0000; val_optim_loss: 58759768.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9153; val_auprc_score: 0.8921; val_best_acc_score: 0.8480; val_best_f1_score: 0.8571; train_kl_reg_loss: 290009.6979; train_edge_recon_loss: 27910212.2222; train_gene_expr_recon_loss: 21164229.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9730748.0000; train_global_loss: 59095200.0000; train_optim_loss: 59095200.0000; val_kl_reg_loss: 204624.6250; val_edge_recon_loss: 28200254.0000; val_gene_expr_recon_loss: 21112980.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9647903.0000; val_global_loss: 59165760.0000; val_optim_loss: 59165760.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9209; val_auprc_score: 0.9006; val_best_acc_score: 0.8498; val_best_f1_score: 0.8602; train_kl_reg_loss: 284521.8715; train_edge_recon_loss: 27947507.5556; train_gene_expr_recon_loss: 21252508.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9675085.2222; train_global_loss: 59159622.2222; train_optim_loss: 59159622.2222; val_kl_reg_loss: 196052.1094; val_edge_recon_loss: 27968126.0000; val_gene_expr_recon_loss: 21181890.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9643852.0000; val_global_loss: 58989920.0000; val_optim_loss: 58989920.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9203; val_auprc_score: 0.8997; val_best_acc_score: 0.8504; val_best_f1_score: 0.8610; train_kl_reg_loss: 281496.4931; train_edge_recon_loss: 27825176.0000; train_gene_expr_recon_loss: 21159755.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9638443.7778; train_global_loss: 58904872.4444; train_optim_loss: 58904872.4444; val_kl_reg_loss: 203554.4844; val_edge_recon_loss: 28027422.0000; val_gene_expr_recon_loss: 21110386.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9645285.0000; val_global_loss: 58986644.0000; val_optim_loss: 58986644.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9209; val_auprc_score: 0.8981; val_best_acc_score: 0.8529; val_best_f1_score: 0.8625; train_kl_reg_loss: 292055.8056; train_edge_recon_loss: 27734290.2222; train_gene_expr_recon_loss: 21126518.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9655454.1111; train_global_loss: 58808318.2222; train_optim_loss: 58808318.2222; val_kl_reg_loss: 204997.9375; val_edge_recon_loss: 27663838.0000; val_gene_expr_recon_loss: 21071536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9628306.0000; val_global_loss: 58568680.0000; val_optim_loss: 58568680.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9234; val_auprc_score: 0.9039; val_best_acc_score: 0.8550; val_best_f1_score: 0.8653; train_kl_reg_loss: 301417.1285; train_edge_recon_loss: 27726455.5556; train_gene_expr_recon_loss: 21109575.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9675412.5556; train_global_loss: 58812860.8889; train_optim_loss: 58812860.8889; val_kl_reg_loss: 211398.3125; val_edge_recon_loss: 27787274.0000; val_gene_expr_recon_loss: 21059552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9628481.0000; val_global_loss: 58686704.0000; val_optim_loss: 58686704.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9279; val_auprc_score: 0.9069; val_best_acc_score: 0.8635; val_best_f1_score: 0.8711; train_kl_reg_loss: 311038.0903; train_edge_recon_loss: 27601383.5556; train_gene_expr_recon_loss: 20996509.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9634779.6667; train_global_loss: 58543711.1111; train_optim_loss: 58543711.1111; val_kl_reg_loss: 216247.4844; val_edge_recon_loss: 27341350.0000; val_gene_expr_recon_loss: 20998700.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9602987.0000; val_global_loss: 58159284.0000; val_optim_loss: 58159284.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9289; val_auprc_score: 0.9060; val_best_acc_score: 0.8632; val_best_f1_score: 0.8696; train_kl_reg_loss: 323715.9792; train_edge_recon_loss: 27515304.8889; train_gene_expr_recon_loss: 21008540.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9614914.0000; train_global_loss: 58462475.1111; train_optim_loss: 58462475.1111; val_kl_reg_loss: 215597.5938; val_edge_recon_loss: 27564150.0000; val_gene_expr_recon_loss: 20981324.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9609365.0000; val_global_loss: 58370436.0000; val_optim_loss: 58370436.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9204; val_auprc_score: 0.8965; val_best_acc_score: 0.8544; val_best_f1_score: 0.8633; train_kl_reg_loss: 327108.8264; train_edge_recon_loss: 27457952.6667; train_gene_expr_recon_loss: 20867207.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9631991.2222; train_global_loss: 58284261.3333; train_optim_loss: 58284261.3333; val_kl_reg_loss: 222589.9531; val_edge_recon_loss: 27927106.0000; val_gene_expr_recon_loss: 20915776.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9594111.0000; val_global_loss: 58659584.0000; val_optim_loss: 58659584.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9333; val_auprc_score: 0.9149; val_best_acc_score: 0.8661; val_best_f1_score: 0.8744; train_kl_reg_loss: 335625.1806; train_edge_recon_loss: 27388213.5556; train_gene_expr_recon_loss: 20855893.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9639990.8889; train_global_loss: 58219723.5556; train_optim_loss: 58219723.5556; val_kl_reg_loss: 225058.6250; val_edge_recon_loss: 27325984.0000; val_gene_expr_recon_loss: 20877450.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9587205.0000; val_global_loss: 58015696.0000; val_optim_loss: 58015696.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9280; val_auprc_score: 0.9074; val_best_acc_score: 0.8605; val_best_f1_score: 0.8700; train_kl_reg_loss: 334334.6562; train_edge_recon_loss: 27458289.1111; train_gene_expr_recon_loss: 20959176.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9593737.8889; train_global_loss: 58345538.2222; train_optim_loss: 58345538.2222; val_kl_reg_loss: 226932.9531; val_edge_recon_loss: 27674416.0000; val_gene_expr_recon_loss: 20828328.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9573615.0000; val_global_loss: 58303292.0000; val_optim_loss: 58303292.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9304; val_auprc_score: 0.9106; val_best_acc_score: 0.8667; val_best_f1_score: 0.8759; train_kl_reg_loss: 337330.0764; train_edge_recon_loss: 27312171.1111; train_gene_expr_recon_loss: 20785811.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9596135.0000; train_global_loss: 58031446.2222; train_optim_loss: 58031446.2222; val_kl_reg_loss: 221815.0625; val_edge_recon_loss: 27430108.0000; val_gene_expr_recon_loss: 20803268.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9570405.0000; val_global_loss: 58025596.0000; val_optim_loss: 58025596.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9298; val_auprc_score: 0.9108; val_best_acc_score: 0.8684; val_best_f1_score: 0.8764; train_kl_reg_loss: 341985.0243; train_edge_recon_loss: 27434657.7778; train_gene_expr_recon_loss: 20718264.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9573414.2222; train_global_loss: 58068321.3333; train_optim_loss: 58068321.3333; val_kl_reg_loss: 225120.7812; val_edge_recon_loss: 27517966.0000; val_gene_expr_recon_loss: 20765658.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9548531.0000; val_global_loss: 58057276.0000; val_optim_loss: 58057276.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9336; val_auprc_score: 0.9154; val_best_acc_score: 0.8704; val_best_f1_score: 0.8791; train_kl_reg_loss: 345818.7014; train_edge_recon_loss: 27391660.2222; train_gene_expr_recon_loss: 20648706.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9518638.7778; train_global_loss: 57904826.2222; train_optim_loss: 57904826.2222; val_kl_reg_loss: 218839.8906; val_edge_recon_loss: 27543262.0000; val_gene_expr_recon_loss: 20728788.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9562991.0000; val_global_loss: 58053880.0000; val_optim_loss: 58053880.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9302; val_auprc_score: 0.9099; val_best_acc_score: 0.8688; val_best_f1_score: 0.8780; train_kl_reg_loss: 338564.3438; train_edge_recon_loss: 27310465.5556; train_gene_expr_recon_loss: 20649057.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9587970.5556; train_global_loss: 57886057.3333; train_optim_loss: 57886057.3333; val_kl_reg_loss: 220019.1562; val_edge_recon_loss: 27333730.0000; val_gene_expr_recon_loss: 20640338.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9550119.0000; val_global_loss: 57744208.0000; val_optim_loss: 57744208.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9373; val_auprc_score: 0.9183; val_best_acc_score: 0.8759; val_best_f1_score: 0.8833; train_kl_reg_loss: 342376.7917; train_edge_recon_loss: 27341168.8889; train_gene_expr_recon_loss: 20695756.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9582072.1111; train_global_loss: 57961374.2222; train_optim_loss: 57961374.2222; val_kl_reg_loss: 223625.4688; val_edge_recon_loss: 27394832.0000; val_gene_expr_recon_loss: 20636832.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9567542.0000; val_global_loss: 57822832.0000; val_optim_loss: 57822832.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9337; val_auprc_score: 0.9151; val_best_acc_score: 0.8700; val_best_f1_score: 0.8795; train_kl_reg_loss: 341101.0347; train_edge_recon_loss: 27390326.0000; train_gene_expr_recon_loss: 20629204.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9553212.7778; train_global_loss: 57913843.5556; train_optim_loss: 57913843.5556; val_kl_reg_loss: 222625.9688; val_edge_recon_loss: 27528570.0000; val_gene_expr_recon_loss: 20622272.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9548352.0000; val_global_loss: 57921820.0000; val_optim_loss: 57921820.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9322; val_auprc_score: 0.9128; val_best_acc_score: 0.8698; val_best_f1_score: 0.8784; train_kl_reg_loss: 343263.6667; train_edge_recon_loss: 27275004.6667; train_gene_expr_recon_loss: 20609434.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9570953.8889; train_global_loss: 57798656.4444; train_optim_loss: 57798656.4444; val_kl_reg_loss: 223549.8750; val_edge_recon_loss: 27594962.0000; val_gene_expr_recon_loss: 20587766.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9551484.0000; val_global_loss: 57957764.0000; val_optim_loss: 57957764.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9326; val_auprc_score: 0.9143; val_best_acc_score: 0.8689; val_best_f1_score: 0.8762; train_kl_reg_loss: 344848.2986; train_edge_recon_loss: 27307150.0000; train_gene_expr_recon_loss: 20609312.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9580605.0000; train_global_loss: 57841917.7778; train_optim_loss: 57841917.7778; val_kl_reg_loss: 224201.9062; val_edge_recon_loss: 27623114.0000; val_gene_expr_recon_loss: 20579368.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9544323.0000; val_global_loss: 57971008.0000; val_optim_loss: 57971008.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9315; val_auprc_score: 0.9128; val_best_acc_score: 0.8685; val_best_f1_score: 0.8778; train_kl_reg_loss: 345325.8438; train_edge_recon_loss: 27486979.1111; train_gene_expr_recon_loss: 20550014.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9517911.0000; train_global_loss: 57900230.6667; train_optim_loss: 57900230.6667; val_kl_reg_loss: 223814.1875; val_edge_recon_loss: 27544486.0000; val_gene_expr_recon_loss: 20561888.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9535712.0000; val_global_loss: 57865900.0000; val_optim_loss: 57865900.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9366; val_auprc_score: 0.9197; val_best_acc_score: 0.8724; val_best_f1_score: 0.8808; train_kl_reg_loss: 346011.1146; train_edge_recon_loss: 27354080.8889; train_gene_expr_recon_loss: 20514462.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9559625.5556; train_global_loss: 57774180.4444; train_optim_loss: 57774180.4444; val_kl_reg_loss: 224327.1250; val_edge_recon_loss: 27411292.0000; val_gene_expr_recon_loss: 20563190.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9542546.0000; val_global_loss: 57741352.0000; val_optim_loss: 57741352.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9336; val_auprc_score: 0.9153; val_best_acc_score: 0.8680; val_best_f1_score: 0.8769; train_kl_reg_loss: 346791.8090; train_edge_recon_loss: 27352940.8889; train_gene_expr_recon_loss: 20675053.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9607413.3333; train_global_loss: 57982200.4444; train_optim_loss: 57982200.4444; val_kl_reg_loss: 225133.1406; val_edge_recon_loss: 27742430.0000; val_gene_expr_recon_loss: 20560352.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9534859.0000; val_global_loss: 58062776.0000; val_optim_loss: 58062776.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9294; val_auprc_score: 0.9100; val_best_acc_score: 0.8657; val_best_f1_score: 0.8759; train_kl_reg_loss: 344932.2014; train_edge_recon_loss: 27428582.4444; train_gene_expr_recon_loss: 20522079.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9520079.7778; train_global_loss: 57815672.8889; train_optim_loss: 57815672.8889; val_kl_reg_loss: 225052.6562; val_edge_recon_loss: 27739788.0000; val_gene_expr_recon_loss: 20561630.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9538312.0000; val_global_loss: 58064784.0000; val_optim_loss: 58064784.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9336; val_auprc_score: 0.9129; val_best_acc_score: 0.8696; val_best_f1_score: 0.8779; train_kl_reg_loss: 345721.3750; train_edge_recon_loss: 27245466.6667; train_gene_expr_recon_loss: 20589664.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9552386.0000; train_global_loss: 57733240.0000; train_optim_loss: 57733240.0000; val_kl_reg_loss: 225036.8438; val_edge_recon_loss: 27597818.0000; val_gene_expr_recon_loss: 20558654.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9539356.0000; val_global_loss: 57920864.0000; val_optim_loss: 57920864.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9335; val_auprc_score: 0.9152; val_best_acc_score: 0.8738; val_best_f1_score: 0.8818; train_kl_reg_loss: 346111.1910; train_edge_recon_loss: 27293621.3333; train_gene_expr_recon_loss: 20549962.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9521148.1111; train_global_loss: 57710843.1111; train_optim_loss: 57710843.1111; val_kl_reg_loss: 224502.8750; val_edge_recon_loss: 27542708.0000; val_gene_expr_recon_loss: 20579528.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9542935.0000; val_global_loss: 57889672.0000; val_optim_loss: 57889672.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9307; val_auprc_score: 0.9103; val_best_acc_score: 0.8698; val_best_f1_score: 0.8785; train_kl_reg_loss: 345753.8403; train_edge_recon_loss: 27379541.1111; train_gene_expr_recon_loss: 20657730.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9589617.8889; train_global_loss: 57972643.1111; train_optim_loss: 57972643.1111; val_kl_reg_loss: 225129.6094; val_edge_recon_loss: 27761110.0000; val_gene_expr_recon_loss: 20572324.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9546350.0000; val_global_loss: 58104912.0000; val_optim_loss: 58104912.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9333; val_auprc_score: 0.9146; val_best_acc_score: 0.8696; val_best_f1_score: 0.8781; train_kl_reg_loss: 346246.7847; train_edge_recon_loss: 27322633.7778; train_gene_expr_recon_loss: 20528109.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9554225.4444; train_global_loss: 57751214.2222; train_optim_loss: 57751214.2222; val_kl_reg_loss: 224176.7500; val_edge_recon_loss: 27451474.0000; val_gene_expr_recon_loss: 20578168.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9532808.0000; val_global_loss: 57786624.0000; val_optim_loss: 57786624.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9297; val_auprc_score: 0.9087; val_best_acc_score: 0.8677; val_best_f1_score: 0.8776; train_kl_reg_loss: 346527.9097; train_edge_recon_loss: 27317117.3333; train_gene_expr_recon_loss: 20666362.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9602861.0000; train_global_loss: 57932868.4444; train_optim_loss: 57932868.4444; val_kl_reg_loss: 224774.5156; val_edge_recon_loss: 27640032.0000; val_gene_expr_recon_loss: 20571450.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9544137.0000; val_global_loss: 57980392.0000; val_optim_loss: 57980392.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9358; val_auprc_score: 0.9170; val_best_acc_score: 0.8752; val_best_f1_score: 0.8826; train_kl_reg_loss: 345412.6979; train_edge_recon_loss: 27361408.6667; train_gene_expr_recon_loss: 20574697.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9515595.1111; train_global_loss: 57797114.6667; train_optim_loss: 57797114.6667; val_kl_reg_loss: 224606.6406; val_edge_recon_loss: 27416926.0000; val_gene_expr_recon_loss: 20572128.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9537323.0000; val_global_loss: 57750984.0000; val_optim_loss: 57750984.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 27 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
Val AUROC score: 0.9328
Val AUPRC score: 0.9140
Val best accuracy score: 0.8673
Val best F1 score: 0.8761
Val gene expr MSE score: 0.3998
Val chrom access MSE score: 0.0859
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
