[True]
Run timestamp: 07082023_194645_77.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_77']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8825; val_auprc_score: 0.8998; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 23349.7674; train_edge_recon_loss: 350841.7118; train_gene_expr_recon_loss: 1470246.4167; train_masked_gp_l1_reg_loss: 8496.4057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119290.9748; train_chrom_access_recon_loss: 2640595.7361; train_global_loss: 4612821.1389; train_optim_loss: 4612821.1389; val_kl_reg_loss: 7542.6060; val_edge_recon_loss: 406574.5000; val_gene_expr_recon_loss: 1310423.7500; val_masked_gp_l1_reg_loss: 6831.7061; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117068.5312; val_chrom_access_recon_loss: 1708964.3750; val_global_loss: 3557405.5000; val_optim_loss: 3557405.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8864; val_auprc_score: 0.9026; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 6146.8787; train_edge_recon_loss: 351373.5035; train_gene_expr_recon_loss: 1154929.2292; train_masked_gp_l1_reg_loss: 6401.0971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115837.4618; train_chrom_access_recon_loss: 1545186.8194; train_global_loss: 3179874.9722; train_optim_loss: 3179874.9722; val_kl_reg_loss: 4525.8350; val_edge_recon_loss: 406568.4062; val_gene_expr_recon_loss: 1045140.9375; val_masked_gp_l1_reg_loss: 6243.3369; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114431.9531; val_chrom_access_recon_loss: 1456884.5000; val_global_loss: 3033795.0000; val_optim_loss: 3033795.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8830; val_auprc_score: 0.9019; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5819.1571; train_edge_recon_loss: 351503.4375; train_gene_expr_recon_loss: 997460.4583; train_masked_gp_l1_reg_loss: 6576.3591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113418.2170; train_chrom_access_recon_loss: 1431813.9583; train_global_loss: 2906591.5833; train_optim_loss: 2906591.5833; val_kl_reg_loss: 8989.8467; val_edge_recon_loss: 406598.7188; val_gene_expr_recon_loss: 925467.1250; val_masked_gp_l1_reg_loss: 6985.7832; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112169.9141; val_chrom_access_recon_loss: 1423740.8750; val_global_loss: 2883952.2500; val_optim_loss: 2883952.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8815; val_auprc_score: 0.9017; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13556.9796; train_edge_recon_loss: 356445.9375; train_gene_expr_recon_loss: 874681.8819; train_masked_gp_l1_reg_loss: 7133.4858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111141.0156; train_chrom_access_recon_loss: 1397151.8750; train_global_loss: 2760111.0833; train_optim_loss: 2760111.0833; val_kl_reg_loss: 16961.1914; val_edge_recon_loss: 406611.4688; val_gene_expr_recon_loss: 816035.3750; val_masked_gp_l1_reg_loss: 7233.3418; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109788.4453; val_chrom_access_recon_loss: 1399962.5000; val_global_loss: 2756592.5000; val_optim_loss: 2756592.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8753; val_auprc_score: 0.8951; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 18651.7452; train_edge_recon_loss: 359843.6979; train_gene_expr_recon_loss: 793615.6736; train_masked_gp_l1_reg_loss: 7261.7855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108545.7378; train_chrom_access_recon_loss: 1383226.3333; train_global_loss: 2671145.0000; train_optim_loss: 2671145.0000; val_kl_reg_loss: 18065.4531; val_edge_recon_loss: 406607.0938; val_gene_expr_recon_loss: 766813.5000; val_masked_gp_l1_reg_loss: 7266.3877; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106873.2734; val_chrom_access_recon_loss: 1370675.3750; val_global_loss: 2676301.0000; val_optim_loss: 2676301.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8748; val_auprc_score: 0.8976; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 19402.7676; train_edge_recon_loss: 359553.8056; train_gene_expr_recon_loss: 763467.2153; train_masked_gp_l1_reg_loss: 7261.5697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105374.1927; train_chrom_access_recon_loss: 1357375.7778; train_global_loss: 2612435.3056; train_optim_loss: 2612435.3056; val_kl_reg_loss: 18488.4668; val_edge_recon_loss: 406600.7812; val_gene_expr_recon_loss: 740160.1875; val_masked_gp_l1_reg_loss: 7245.7627; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103428.4375; val_chrom_access_recon_loss: 1351516.0000; val_global_loss: 2627439.7500; val_optim_loss: 2627439.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8809; val_auprc_score: 0.8939; val_best_acc_score: 0.5011; val_best_f1_score: 0.6671; train_kl_reg_loss: 20265.9364; train_edge_recon_loss: 360254.0694; train_gene_expr_recon_loss: 736099.3264; train_masked_gp_l1_reg_loss: 7235.9927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101784.4688; train_chrom_access_recon_loss: 1339330.1806; train_global_loss: 2564969.9444; train_optim_loss: 2564969.9444; val_kl_reg_loss: 19881.2148; val_edge_recon_loss: 406585.5000; val_gene_expr_recon_loss: 721692.1250; val_masked_gp_l1_reg_loss: 7205.6299; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99691.5469; val_chrom_access_recon_loss: 1342146.2500; val_global_loss: 2597202.2500; val_optim_loss: 2597202.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8803; val_auprc_score: 0.8832; val_best_acc_score: 0.5059; val_best_f1_score: 0.6693; train_kl_reg_loss: 21122.6037; train_edge_recon_loss: 360637.7535; train_gene_expr_recon_loss: 719898.5972; train_masked_gp_l1_reg_loss: 7183.1832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97979.4201; train_chrom_access_recon_loss: 1327993.3889; train_global_loss: 2534814.8889; train_optim_loss: 2534814.8889; val_kl_reg_loss: 21158.8809; val_edge_recon_loss: 406527.0625; val_gene_expr_recon_loss: 707668.0000; val_masked_gp_l1_reg_loss: 7140.3135; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95824.6250; val_chrom_access_recon_loss: 1334610.3750; val_global_loss: 2572929.5000; val_optim_loss: 2572929.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8654; val_auprc_score: 0.8641; val_best_acc_score: 0.5229; val_best_f1_score: 0.6766; train_kl_reg_loss: 22175.9531; train_edge_recon_loss: 360205.3576; train_gene_expr_recon_loss: 709494.8750; train_masked_gp_l1_reg_loss: 7120.5129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94088.9141; train_chrom_access_recon_loss: 1330309.5694; train_global_loss: 2523395.1667; train_optim_loss: 2523395.1667; val_kl_reg_loss: 21044.8535; val_edge_recon_loss: 406369.6875; val_gene_expr_recon_loss: 696186.6250; val_masked_gp_l1_reg_loss: 7081.1455; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91908.4688; val_chrom_access_recon_loss: 1328372.1250; val_global_loss: 2550963.0000; val_optim_loss: 2550963.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8636; val_auprc_score: 0.8612; val_best_acc_score: 0.5690; val_best_f1_score: 0.6967; train_kl_reg_loss: 22299.4881; train_edge_recon_loss: 359723.7674; train_gene_expr_recon_loss: 693432.0625; train_masked_gp_l1_reg_loss: 7073.6264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90167.2153; train_chrom_access_recon_loss: 1319088.4444; train_global_loss: 2491784.5833; train_optim_loss: 2491784.5833; val_kl_reg_loss: 20377.2617; val_edge_recon_loss: 406131.7812; val_gene_expr_recon_loss: 686249.7500; val_masked_gp_l1_reg_loss: 7042.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87993.5625; val_chrom_access_recon_loss: 1323501.5000; val_global_loss: 2531296.5000; val_optim_loss: 2531296.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8739; val_auprc_score: 0.8674; val_best_acc_score: 0.6462; val_best_f1_score: 0.7345; train_kl_reg_loss: 22220.7982; train_edge_recon_loss: 359773.0347; train_gene_expr_recon_loss: 680841.8333; train_masked_gp_l1_reg_loss: 7023.0252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86268.4826; train_chrom_access_recon_loss: 1310819.7361; train_global_loss: 2466946.8889; train_optim_loss: 2466946.8889; val_kl_reg_loss: 23895.1484; val_edge_recon_loss: 405676.3125; val_gene_expr_recon_loss: 677558.8750; val_masked_gp_l1_reg_loss: 6995.1650; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84127.6250; val_chrom_access_recon_loss: 1319333.7500; val_global_loss: 2517587.0000; val_optim_loss: 2517587.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8708; val_auprc_score: 0.8654; val_best_acc_score: 0.7292; val_best_f1_score: 0.7775; train_kl_reg_loss: 22745.9477; train_edge_recon_loss: 359775.0208; train_gene_expr_recon_loss: 677138.3542; train_masked_gp_l1_reg_loss: 6987.2954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82446.5530; train_chrom_access_recon_loss: 1306148.6944; train_global_loss: 2455241.8889; train_optim_loss: 2455241.8889; val_kl_reg_loss: 22541.9258; val_edge_recon_loss: 404815.5625; val_gene_expr_recon_loss: 671464.0625; val_masked_gp_l1_reg_loss: 6963.8955; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80366.2422; val_chrom_access_recon_loss: 1314735.6250; val_global_loss: 2500887.2500; val_optim_loss: 2500887.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8628; val_auprc_score: 0.8539; val_best_acc_score: 0.7661; val_best_f1_score: 0.7898; train_kl_reg_loss: 22751.0299; train_edge_recon_loss: 359131.4688; train_gene_expr_recon_loss: 668092.8542; train_masked_gp_l1_reg_loss: 6958.1065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78742.9601; train_chrom_access_recon_loss: 1304537.9028; train_global_loss: 2440214.3611; train_optim_loss: 2440214.3611; val_kl_reg_loss: 22204.4609; val_edge_recon_loss: 403621.5625; val_gene_expr_recon_loss: 666388.1875; val_masked_gp_l1_reg_loss: 6933.9326; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76734.9531; val_chrom_access_recon_loss: 1311476.1250; val_global_loss: 2487359.2500; val_optim_loss: 2487359.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8636; val_auprc_score: 0.8530; val_best_acc_score: 0.7792; val_best_f1_score: 0.7798; train_kl_reg_loss: 22634.8114; train_edge_recon_loss: 358761.5104; train_gene_expr_recon_loss: 667016.1458; train_masked_gp_l1_reg_loss: 6922.8834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75180.6858; train_chrom_access_recon_loss: 1299731.0694; train_global_loss: 2430247.1111; train_optim_loss: 2430247.1111; val_kl_reg_loss: 22598.6074; val_edge_recon_loss: 401875.2500; val_gene_expr_recon_loss: 662704.3125; val_masked_gp_l1_reg_loss: 6904.7749; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73264.6016; val_chrom_access_recon_loss: 1308600.1250; val_global_loss: 2475947.5000; val_optim_loss: 2475947.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8710; val_auprc_score: 0.8644; val_best_acc_score: 0.7691; val_best_f1_score: 0.7712; train_kl_reg_loss: 22444.6984; train_edge_recon_loss: 358057.5729; train_gene_expr_recon_loss: 660600.4583; train_masked_gp_l1_reg_loss: 6908.9538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71781.7448; train_chrom_access_recon_loss: 1301139.0972; train_global_loss: 2420932.5278; train_optim_loss: 2420932.5278; val_kl_reg_loss: 21666.4551; val_edge_recon_loss: 398868.8750; val_gene_expr_recon_loss: 660069.9375; val_masked_gp_l1_reg_loss: 6895.6792; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69955.9219; val_chrom_access_recon_loss: 1305203.1250; val_global_loss: 2462660.0000; val_optim_loss: 2462660.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8641; val_auprc_score: 0.8511; val_best_acc_score: 0.7680; val_best_f1_score: 0.7982; train_kl_reg_loss: 21932.4036; train_edge_recon_loss: 356990.3854; train_gene_expr_recon_loss: 661425.1250; train_masked_gp_l1_reg_loss: 6897.9125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68553.5590; train_chrom_access_recon_loss: 1300991.4167; train_global_loss: 2416790.8056; train_optim_loss: 2416790.8056; val_kl_reg_loss: 20792.3027; val_edge_recon_loss: 394647.0938; val_gene_expr_recon_loss: 658108.2500; val_masked_gp_l1_reg_loss: 6889.9639; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66825.9297; val_chrom_access_recon_loss: 1303314.7500; val_global_loss: 2450578.2500; val_optim_loss: 2450578.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8810; val_auprc_score: 0.8641; val_best_acc_score: 0.8052; val_best_f1_score: 0.8134; train_kl_reg_loss: 21374.2402; train_edge_recon_loss: 355381.0486; train_gene_expr_recon_loss: 658445.3958; train_masked_gp_l1_reg_loss: 6898.7646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65499.1476; train_chrom_access_recon_loss: 1294782.9861; train_global_loss: 2402381.5556; train_optim_loss: 2402381.5556; val_kl_reg_loss: 19826.5859; val_edge_recon_loss: 385646.5312; val_gene_expr_recon_loss: 656783.3750; val_masked_gp_l1_reg_loss: 6898.3501; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63863.6875; val_chrom_access_recon_loss: 1301048.2500; val_global_loss: 2434066.7500; val_optim_loss: 2434066.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8911; val_auprc_score: 0.8755; val_best_acc_score: 0.8137; val_best_f1_score: 0.8241; train_kl_reg_loss: 20394.8201; train_edge_recon_loss: 351571.9479; train_gene_expr_recon_loss: 657495.8542; train_masked_gp_l1_reg_loss: 6909.6494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62607.9123; train_chrom_access_recon_loss: 1297294.4722; train_global_loss: 2396274.6667; train_optim_loss: 2396274.6667; val_kl_reg_loss: 18859.8594; val_edge_recon_loss: 371514.0000; val_gene_expr_recon_loss: 656005.6250; val_masked_gp_l1_reg_loss: 6916.8457; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61063.0000; val_chrom_access_recon_loss: 1299363.2500; val_global_loss: 2413722.5000; val_optim_loss: 2413722.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9036; val_auprc_score: 0.8849; val_best_acc_score: 0.8300; val_best_f1_score: 0.8375; train_kl_reg_loss: 19458.2244; train_edge_recon_loss: 343588.2951; train_gene_expr_recon_loss: 660548.7708; train_masked_gp_l1_reg_loss: 6937.2525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59881.4288; train_chrom_access_recon_loss: 1296019.1806; train_global_loss: 2386433.1667; train_optim_loss: 2386433.1667; val_kl_reg_loss: 19230.8125; val_edge_recon_loss: 347308.0938; val_gene_expr_recon_loss: 656908.7500; val_masked_gp_l1_reg_loss: 6954.7632; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58433.8203; val_chrom_access_recon_loss: 1298636.7500; val_global_loss: 2387473.0000; val_optim_loss: 2387473.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9075; val_auprc_score: 0.8892; val_best_acc_score: 0.8333; val_best_f1_score: 0.8424; train_kl_reg_loss: 21486.8455; train_edge_recon_loss: 327894.6424; train_gene_expr_recon_loss: 662020.3125; train_masked_gp_l1_reg_loss: 6984.6281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57333.6949; train_chrom_access_recon_loss: 1293623.3611; train_global_loss: 2369343.5556; train_optim_loss: 2369343.5556; val_kl_reg_loss: 24503.2773; val_edge_recon_loss: 319155.5312; val_gene_expr_recon_loss: 657786.8750; val_masked_gp_l1_reg_loss: 7018.0024; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55982.1406; val_chrom_access_recon_loss: 1297645.8750; val_global_loss: 2362091.7500; val_optim_loss: 2362091.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9005; val_auprc_score: 0.8724; val_best_acc_score: 0.8325; val_best_f1_score: 0.8410; train_kl_reg_loss: 28038.6402; train_edge_recon_loss: 312481.7743; train_gene_expr_recon_loss: 656399.9236; train_masked_gp_l1_reg_loss: 7051.8047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54956.7700; train_chrom_access_recon_loss: 1292466.8750; train_global_loss: 2351395.8056; train_optim_loss: 2351395.8056; val_kl_reg_loss: 29535.0723; val_edge_recon_loss: 311557.0625; val_gene_expr_recon_loss: 655339.7500; val_masked_gp_l1_reg_loss: 7087.6929; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53693.4844; val_chrom_access_recon_loss: 1294665.6250; val_global_loss: 2351878.5000; val_optim_loss: 2351878.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9076; val_auprc_score: 0.8848; val_best_acc_score: 0.8344; val_best_f1_score: 0.8445; train_kl_reg_loss: 29937.4757; train_edge_recon_loss: 307358.1042; train_gene_expr_recon_loss: 658928.6111; train_masked_gp_l1_reg_loss: 7119.9709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52728.7413; train_chrom_access_recon_loss: 1285910.4583; train_global_loss: 2341983.3333; train_optim_loss: 2341983.3333; val_kl_reg_loss: 28862.2832; val_edge_recon_loss: 305590.3750; val_gene_expr_recon_loss: 654375.5000; val_masked_gp_l1_reg_loss: 7156.6221; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51540.9570; val_chrom_access_recon_loss: 1292929.2500; val_global_loss: 2340455.0000; val_optim_loss: 2340455.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9082; val_auprc_score: 0.8849; val_best_acc_score: 0.8378; val_best_f1_score: 0.8482; train_kl_reg_loss: 29298.9733; train_edge_recon_loss: 304094.3507; train_gene_expr_recon_loss: 654534.8264; train_masked_gp_l1_reg_loss: 7186.2760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50637.5191; train_chrom_access_recon_loss: 1282010.9028; train_global_loss: 2327762.8611; train_optim_loss: 2327762.8611; val_kl_reg_loss: 28713.4238; val_edge_recon_loss: 305391.6250; val_gene_expr_recon_loss: 653029.8750; val_masked_gp_l1_reg_loss: 7204.3115; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49520.5547; val_chrom_access_recon_loss: 1290398.0000; val_global_loss: 2334257.7500; val_optim_loss: 2334257.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9109; val_auprc_score: 0.8864; val_best_acc_score: 0.8425; val_best_f1_score: 0.8534; train_kl_reg_loss: 29592.2949; train_edge_recon_loss: 302147.5312; train_gene_expr_recon_loss: 655769.6042; train_masked_gp_l1_reg_loss: 7225.1247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48667.0707; train_chrom_access_recon_loss: 1288918.9028; train_global_loss: 2332320.5000; train_optim_loss: 2332320.5000; val_kl_reg_loss: 28799.2422; val_edge_recon_loss: 300900.0000; val_gene_expr_recon_loss: 651756.0000; val_masked_gp_l1_reg_loss: 7251.2041; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47609.9922; val_chrom_access_recon_loss: 1288601.1250; val_global_loss: 2324917.5000; val_optim_loss: 2324917.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9136; val_auprc_score: 0.8905; val_best_acc_score: 0.8394; val_best_f1_score: 0.8519; train_kl_reg_loss: 29280.2732; train_edge_recon_loss: 301975.0382; train_gene_expr_recon_loss: 653743.1389; train_masked_gp_l1_reg_loss: 7268.2153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46804.4596; train_chrom_access_recon_loss: 1280292.0139; train_global_loss: 2319363.1667; train_optim_loss: 2319363.1667; val_kl_reg_loss: 28710.7227; val_edge_recon_loss: 301130.3438; val_gene_expr_recon_loss: 650443.1875; val_masked_gp_l1_reg_loss: 7287.4941; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45801.7773; val_chrom_access_recon_loss: 1286716.1250; val_global_loss: 2320089.5000; val_optim_loss: 2320089.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9170; val_auprc_score: 0.8917; val_best_acc_score: 0.8482; val_best_f1_score: 0.8572; train_kl_reg_loss: 28271.4438; train_edge_recon_loss: 323786.8056; train_gene_expr_recon_loss: 994475.6250; train_masked_gp_l1_reg_loss: 7390.5227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44899.1406; train_chrom_access_recon_loss: 1355432.4444; train_global_loss: 2754255.9167; train_optim_loss: 2754255.9167; val_kl_reg_loss: 10694.6562; val_edge_recon_loss: 310332.0938; val_gene_expr_recon_loss: 987304.1875; val_masked_gp_l1_reg_loss: 7553.7998; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43698.6133; val_chrom_access_recon_loss: 1362310.7500; val_global_loss: 2721894.0000; val_optim_loss: 2721894.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9167; val_auprc_score: 0.8878; val_best_acc_score: 0.8504; val_best_f1_score: 0.8607; train_kl_reg_loss: 26663.1228; train_edge_recon_loss: 309762.7778; train_gene_expr_recon_loss: 988162.5208; train_masked_gp_l1_reg_loss: 7727.6807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42700.5712; train_chrom_access_recon_loss: 1356677.1806; train_global_loss: 2731693.8056; train_optim_loss: 2731693.8056; val_kl_reg_loss: 12817.7734; val_edge_recon_loss: 307363.7500; val_gene_expr_recon_loss: 979996.8750; val_masked_gp_l1_reg_loss: 7942.5806; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41462.2969; val_chrom_access_recon_loss: 1358077.5000; val_global_loss: 2707660.7500; val_optim_loss: 2707660.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9184; val_auprc_score: 0.8964; val_best_acc_score: 0.8441; val_best_f1_score: 0.8523; train_kl_reg_loss: 24973.0749; train_edge_recon_loss: 303456.0382; train_gene_expr_recon_loss: 979038.6806; train_masked_gp_l1_reg_loss: 8086.3003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40506.3750; train_chrom_access_recon_loss: 1349317.6528; train_global_loss: 2705378.0833; train_optim_loss: 2705378.0833; val_kl_reg_loss: 14507.5557; val_edge_recon_loss: 303452.4062; val_gene_expr_recon_loss: 975743.8750; val_masked_gp_l1_reg_loss: 8246.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39340.0156; val_chrom_access_recon_loss: 1356407.3750; val_global_loss: 2697698.0000; val_optim_loss: 2697698.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9157; val_auprc_score: 0.8909; val_best_acc_score: 0.8433; val_best_f1_score: 0.8537; train_kl_reg_loss: 23079.2144; train_edge_recon_loss: 299968.5972; train_gene_expr_recon_loss: 980138.2778; train_masked_gp_l1_reg_loss: 8349.3661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38458.0447; train_chrom_access_recon_loss: 1351966.8194; train_global_loss: 2701960.3333; train_optim_loss: 2701960.3333; val_kl_reg_loss: 16112.8799; val_edge_recon_loss: 300397.2188; val_gene_expr_recon_loss: 970660.0000; val_masked_gp_l1_reg_loss: 8466.8662; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37383.6172; val_chrom_access_recon_loss: 1354259.1250; val_global_loss: 2687279.7500; val_optim_loss: 2687279.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9119; val_auprc_score: 0.8868; val_best_acc_score: 0.8421; val_best_f1_score: 0.8513; train_kl_reg_loss: 22532.1877; train_edge_recon_loss: 298161.0208; train_gene_expr_recon_loss: 973587.0556; train_masked_gp_l1_reg_loss: 8442.6851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37267.1545; train_chrom_access_recon_loss: 1343528.0556; train_global_loss: 2683518.0556; train_optim_loss: 2683518.0556; val_kl_reg_loss: 16641.0273; val_edge_recon_loss: 300869.3750; val_gene_expr_recon_loss: 970198.6250; val_masked_gp_l1_reg_loss: 8420.9658; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37123.6133; val_chrom_access_recon_loss: 1354077.2500; val_global_loss: 2687331.0000; val_optim_loss: 2687331.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9141; val_auprc_score: 0.8877; val_best_acc_score: 0.8426; val_best_f1_score: 0.8518; train_kl_reg_loss: 22491.0072; train_edge_recon_loss: 297622.5799; train_gene_expr_recon_loss: 969221.6528; train_masked_gp_l1_reg_loss: 8419.0545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37020.7674; train_chrom_access_recon_loss: 1344810.7917; train_global_loss: 2679585.8889; train_optim_loss: 2679585.8889; val_kl_reg_loss: 16715.0332; val_edge_recon_loss: 299442.0625; val_gene_expr_recon_loss: 969926.6875; val_masked_gp_l1_reg_loss: 8413.6934; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36891.8203; val_chrom_access_recon_loss: 1353948.8750; val_global_loss: 2685338.2500; val_optim_loss: 2685338.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9154; val_auprc_score: 0.8931; val_best_acc_score: 0.8417; val_best_f1_score: 0.8516; train_kl_reg_loss: 22264.4479; train_edge_recon_loss: 298038.5069; train_gene_expr_recon_loss: 973420.0069; train_masked_gp_l1_reg_loss: 8412.0505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36793.8889; train_chrom_access_recon_loss: 1342882.2639; train_global_loss: 2681811.1389; train_optim_loss: 2681811.1389; val_kl_reg_loss: 16903.4062; val_edge_recon_loss: 299743.5625; val_gene_expr_recon_loss: 969496.7500; val_masked_gp_l1_reg_loss: 8410.9160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36673.2852; val_chrom_access_recon_loss: 1353734.0000; val_global_loss: 2684962.0000; val_optim_loss: 2684962.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9163; val_auprc_score: 0.8887; val_best_acc_score: 0.8475; val_best_f1_score: 0.8567; train_kl_reg_loss: 22273.8694; train_edge_recon_loss: 298469.3681; train_gene_expr_recon_loss: 969902.1181; train_masked_gp_l1_reg_loss: 8411.4026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36579.4379; train_chrom_access_recon_loss: 1346194.0694; train_global_loss: 2681830.2778; train_optim_loss: 2681830.2778; val_kl_reg_loss: 17115.9316; val_edge_recon_loss: 297792.7812; val_gene_expr_recon_loss: 968977.6875; val_masked_gp_l1_reg_loss: 8412.9014; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36465.5859; val_chrom_access_recon_loss: 1353649.6250; val_global_loss: 2682414.5000; val_optim_loss: 2682414.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 39 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9122
val AUPRC score: 0.8877
val best accuracy score: 0.8389
val best F1 score: 0.8513
val target rna MSE score: 3.9625
val source rna MSE score: 3.1544
val target atac MSE score: 0.1362
val source atac MSE score: 0.0196
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
