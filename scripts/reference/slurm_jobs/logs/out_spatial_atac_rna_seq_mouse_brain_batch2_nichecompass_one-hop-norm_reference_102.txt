[True]
Run timestamp: 26072023_030646_102.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_102']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8948; val_auprc_score: 0.9051; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 10826.8526; train_edge_recon_loss: 3488187.1667; train_gene_expr_recon_loss: 31574686.6667; train_masked_gp_l1_reg_loss: 1936.0026; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10784050.8889; train_global_loss: 45859686.2222; train_optim_loss: 45859686.2222; val_kl_reg_loss: 57158.9844; val_edge_recon_loss: 4065539.2500; val_gene_expr_recon_loss: 30152526.0000; val_masked_gp_l1_reg_loss: 2010.5780; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10844997.0000; val_global_loss: 45122232.0000; val_optim_loss: 45122232.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8752; val_auprc_score: 0.8819; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 61285.6398; train_edge_recon_loss: 3557736.7222; train_gene_expr_recon_loss: 28584642.0000; train_masked_gp_l1_reg_loss: 2121.9761; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10636406.7778; train_global_loss: 42842193.3333; train_optim_loss: 42842193.3333; val_kl_reg_loss: 67822.2500; val_edge_recon_loss: 4065640.0000; val_gene_expr_recon_loss: 27121158.0000; val_masked_gp_l1_reg_loss: 2279.3291; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10640538.0000; val_global_loss: 41897440.0000; val_optim_loss: 41897440.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8699; val_auprc_score: 0.8785; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 109225.0104; train_edge_recon_loss: 3600208.6667; train_gene_expr_recon_loss: 25910215.3333; train_masked_gp_l1_reg_loss: 2412.8686; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10329805.5556; train_global_loss: 39951867.1111; train_optim_loss: 39951867.1111; val_kl_reg_loss: 84793.5938; val_edge_recon_loss: 4065764.7500; val_gene_expr_recon_loss: 24993718.0000; val_masked_gp_l1_reg_loss: 2564.8657; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10425900.0000; val_global_loss: 39572740.0000; val_optim_loss: 39572740.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8762; val_auprc_score: 0.8793; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 120104.1050; train_edge_recon_loss: 3647533.8056; train_gene_expr_recon_loss: 24263601.5556; train_masked_gp_l1_reg_loss: 2648.0261; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10169284.5556; train_global_loss: 38203172.8889; train_optim_loss: 38203172.8889; val_kl_reg_loss: 133096.7031; val_edge_recon_loss: 4065661.7500; val_gene_expr_recon_loss: 23917652.0000; val_masked_gp_l1_reg_loss: 2730.8271; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10268748.0000; val_global_loss: 38387888.0000; val_optim_loss: 38387888.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8713; val_auprc_score: 0.8705; val_best_acc_score: 0.5027; val_best_f1_score: 0.6679; train_kl_reg_loss: 167982.2917; train_edge_recon_loss: 3628841.9444; train_gene_expr_recon_loss: 23308276.0000; train_masked_gp_l1_reg_loss: 2770.9392; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10049080.4444; train_global_loss: 37156952.4444; train_optim_loss: 37156952.4444; val_kl_reg_loss: 144552.2656; val_edge_recon_loss: 4065402.5000; val_gene_expr_recon_loss: 22939152.0000; val_masked_gp_l1_reg_loss: 2806.1855; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10164432.0000; val_global_loss: 37316344.0000; val_optim_loss: 37316344.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8765; val_auprc_score: 0.8744; val_best_acc_score: 0.5092; val_best_f1_score: 0.6708; train_kl_reg_loss: 186759.0226; train_edge_recon_loss: 3646550.5000; train_gene_expr_recon_loss: 22405510.0000; train_masked_gp_l1_reg_loss: 2818.6303; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9925774.5556; train_global_loss: 36167412.4444; train_optim_loss: 36167412.4444; val_kl_reg_loss: 168565.5469; val_edge_recon_loss: 4064855.7500; val_gene_expr_recon_loss: 22266822.0000; val_masked_gp_l1_reg_loss: 2825.9121; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10067298.0000; val_global_loss: 36570368.0000; val_optim_loss: 36570368.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8732; val_auprc_score: 0.8673; val_best_acc_score: 0.5140; val_best_f1_score: 0.6729; train_kl_reg_loss: 204426.9375; train_edge_recon_loss: 3637143.3889; train_gene_expr_recon_loss: 21871456.8889; train_masked_gp_l1_reg_loss: 2825.2007; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9851700.3333; train_global_loss: 35567552.0000; train_optim_loss: 35567552.0000; val_kl_reg_loss: 183058.2656; val_edge_recon_loss: 4064527.5000; val_gene_expr_recon_loss: 21864728.0000; val_masked_gp_l1_reg_loss: 2823.3999; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10026623.0000; val_global_loss: 36141760.0000; val_optim_loss: 36141760.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8722; val_auprc_score: 0.8638; val_best_acc_score: 0.5274; val_best_f1_score: 0.6789; train_kl_reg_loss: 214691.5295; train_edge_recon_loss: 3636042.0000; train_gene_expr_recon_loss: 21579966.4444; train_masked_gp_l1_reg_loss: 2820.3668; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9827544.2222; train_global_loss: 35261064.8889; train_optim_loss: 35261064.8889; val_kl_reg_loss: 181198.1562; val_edge_recon_loss: 4063606.7500; val_gene_expr_recon_loss: 21601904.0000; val_masked_gp_l1_reg_loss: 2816.6990; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9979965.0000; val_global_loss: 35829488.0000; val_optim_loss: 35829488.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8734; val_auprc_score: 0.8669; val_best_acc_score: 0.5556; val_best_f1_score: 0.6921; train_kl_reg_loss: 214179.7726; train_edge_recon_loss: 3626407.4444; train_gene_expr_recon_loss: 21358768.8889; train_masked_gp_l1_reg_loss: 2815.2590; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9806044.6667; train_global_loss: 35008216.0000; train_optim_loss: 35008216.0000; val_kl_reg_loss: 189403.5312; val_edge_recon_loss: 4062187.7500; val_gene_expr_recon_loss: 21430912.0000; val_masked_gp_l1_reg_loss: 2814.6025; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9942331.0000; val_global_loss: 35627648.0000; val_optim_loss: 35627648.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8837; val_auprc_score: 0.8727; val_best_acc_score: 0.6188; val_best_f1_score: 0.7229; train_kl_reg_loss: 213670.8281; train_edge_recon_loss: 3620363.1944; train_gene_expr_recon_loss: 21140756.4444; train_masked_gp_l1_reg_loss: 2815.8456; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9776309.6667; train_global_loss: 34753915.5556; train_optim_loss: 34753915.5556; val_kl_reg_loss: 167343.2500; val_edge_recon_loss: 4059217.7500; val_gene_expr_recon_loss: 21339946.0000; val_masked_gp_l1_reg_loss: 2817.3767; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9935175.0000; val_global_loss: 35504500.0000; val_optim_loss: 35504500.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8760; val_auprc_score: 0.8594; val_best_acc_score: 0.6734; val_best_f1_score: 0.7511; train_kl_reg_loss: 205690.4705; train_edge_recon_loss: 3617892.6944; train_gene_expr_recon_loss: 21088390.6667; train_masked_gp_l1_reg_loss: 2820.5223; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9805083.7778; train_global_loss: 34719878.6667; train_optim_loss: 34719878.6667; val_kl_reg_loss: 184899.6094; val_edge_recon_loss: 4055192.2500; val_gene_expr_recon_loss: 21239464.0000; val_masked_gp_l1_reg_loss: 2824.9546; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9919629.0000; val_global_loss: 35402008.0000; val_optim_loss: 35402008.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8867; val_auprc_score: 0.8814; val_best_acc_score: 0.7183; val_best_f1_score: 0.7745; train_kl_reg_loss: 206274.4149; train_edge_recon_loss: 3603087.8056; train_gene_expr_recon_loss: 21110249.1111; train_masked_gp_l1_reg_loss: 2829.8995; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9770230.2222; train_global_loss: 34692672.0000; train_optim_loss: 34692672.0000; val_kl_reg_loss: 173475.5000; val_edge_recon_loss: 4049708.2500; val_gene_expr_recon_loss: 21172524.0000; val_masked_gp_l1_reg_loss: 2836.1992; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9892645.0000; val_global_loss: 35291188.0000; val_optim_loss: 35291188.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8894; val_auprc_score: 0.8802; val_best_acc_score: 0.7583; val_best_f1_score: 0.7967; train_kl_reg_loss: 202749.6580; train_edge_recon_loss: 3596761.6667; train_gene_expr_recon_loss: 21040959.3333; train_masked_gp_l1_reg_loss: 2841.8200; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9776787.7778; train_global_loss: 34620099.5556; train_optim_loss: 34620099.5556; val_kl_reg_loss: 166032.1094; val_edge_recon_loss: 4042584.2500; val_gene_expr_recon_loss: 21134346.0000; val_masked_gp_l1_reg_loss: 2848.9795; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9885866.0000; val_global_loss: 35231676.0000; val_optim_loss: 35231676.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8878; val_auprc_score: 0.8780; val_best_acc_score: 0.7808; val_best_f1_score: 0.8070; train_kl_reg_loss: 196507.3611; train_edge_recon_loss: 3595642.1944; train_gene_expr_recon_loss: 20887091.1111; train_masked_gp_l1_reg_loss: 2855.2549; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9726591.1111; train_global_loss: 34408686.6667; train_optim_loss: 34408686.6667; val_kl_reg_loss: 166220.4844; val_edge_recon_loss: 4034117.5000; val_gene_expr_recon_loss: 21117234.0000; val_masked_gp_l1_reg_loss: 2862.9863; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9889904.0000; val_global_loss: 35210336.0000; val_optim_loss: 35210336.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8935; val_auprc_score: 0.8819; val_best_acc_score: 0.8046; val_best_f1_score: 0.8167; train_kl_reg_loss: 190739.0139; train_edge_recon_loss: 3586473.2222; train_gene_expr_recon_loss: 20822635.7778; train_masked_gp_l1_reg_loss: 2870.0733; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9641430.1111; train_global_loss: 34244148.8889; train_optim_loss: 34244148.8889; val_kl_reg_loss: 182105.6875; val_edge_recon_loss: 4018615.7500; val_gene_expr_recon_loss: 21037842.0000; val_masked_gp_l1_reg_loss: 2879.2527; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9865097.0000; val_global_loss: 35106540.0000; val_optim_loss: 35106540.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8961; val_auprc_score: 0.8840; val_best_acc_score: 0.8116; val_best_f1_score: 0.8105; train_kl_reg_loss: 192465.8733; train_edge_recon_loss: 3576563.9722; train_gene_expr_recon_loss: 20877841.7778; train_masked_gp_l1_reg_loss: 2886.8590; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9730288.0000; train_global_loss: 34380045.3333; train_optim_loss: 34380045.3333; val_kl_reg_loss: 147179.0312; val_edge_recon_loss: 3998140.0000; val_gene_expr_recon_loss: 21012934.0000; val_masked_gp_l1_reg_loss: 2895.4421; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9862666.0000; val_global_loss: 35023816.0000; val_optim_loss: 35023816.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8923; val_auprc_score: 0.8775; val_best_acc_score: 0.8015; val_best_f1_score: 0.7891; train_kl_reg_loss: 180026.7743; train_edge_recon_loss: 3575201.3611; train_gene_expr_recon_loss: 20619378.6667; train_masked_gp_l1_reg_loss: 2902.5289; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9686192.6667; train_global_loss: 34063701.5556; train_optim_loss: 34063701.5556; val_kl_reg_loss: 171000.6875; val_edge_recon_loss: 3973396.7500; val_gene_expr_recon_loss: 20958740.0000; val_masked_gp_l1_reg_loss: 2912.2488; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9840363.0000; val_global_loss: 34946412.0000; val_optim_loss: 34946412.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8963; val_auprc_score: 0.8834; val_best_acc_score: 0.7839; val_best_f1_score: 0.8149; train_kl_reg_loss: 181519.7986; train_edge_recon_loss: 3551807.2222; train_gene_expr_recon_loss: 20673350.8889; train_masked_gp_l1_reg_loss: 2920.3591; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9626272.6667; train_global_loss: 34035870.4444; train_optim_loss: 34035870.4444; val_kl_reg_loss: 144352.0312; val_edge_recon_loss: 3923118.5000; val_gene_expr_recon_loss: 20950578.0000; val_masked_gp_l1_reg_loss: 2929.5032; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9841055.0000; val_global_loss: 34862032.0000; val_optim_loss: 34862032.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8934; val_auprc_score: 0.8762; val_best_acc_score: 0.8027; val_best_f1_score: 0.8226; train_kl_reg_loss: 169210.9913; train_edge_recon_loss: 3545356.8611; train_gene_expr_recon_loss: 20684373.3333; train_masked_gp_l1_reg_loss: 2936.7527; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9627175.3333; train_global_loss: 34029053.5556; train_optim_loss: 34029053.5556; val_kl_reg_loss: 146052.0781; val_edge_recon_loss: 3860274.7500; val_gene_expr_recon_loss: 20925766.0000; val_masked_gp_l1_reg_loss: 2944.8560; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9826524.0000; val_global_loss: 34761560.0000; val_optim_loss: 34761560.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8966; val_auprc_score: 0.8798; val_best_acc_score: 0.8106; val_best_f1_score: 0.8242; train_kl_reg_loss: 161558.0712; train_edge_recon_loss: 3513361.2500; train_gene_expr_recon_loss: 20560476.6667; train_masked_gp_l1_reg_loss: 2952.0893; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9597466.2222; train_global_loss: 33835814.2222; train_optim_loss: 33835814.2222; val_kl_reg_loss: 147473.7031; val_edge_recon_loss: 3770949.2500; val_gene_expr_recon_loss: 20909642.0000; val_masked_gp_l1_reg_loss: 2960.9036; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9819072.0000; val_global_loss: 34650096.0000; val_optim_loss: 34650096.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8974; val_auprc_score: 0.8828; val_best_acc_score: 0.8122; val_best_f1_score: 0.8262; train_kl_reg_loss: 157577.4740; train_edge_recon_loss: 3472691.3333; train_gene_expr_recon_loss: 20587637.3333; train_masked_gp_l1_reg_loss: 2967.8493; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9632092.8889; train_global_loss: 33852966.6667; train_optim_loss: 33852966.6667; val_kl_reg_loss: 139017.4688; val_edge_recon_loss: 3652690.7500; val_gene_expr_recon_loss: 20875372.0000; val_masked_gp_l1_reg_loss: 2976.3318; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9800670.0000; val_global_loss: 34470728.0000; val_optim_loss: 34470728.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8972; val_auprc_score: 0.8796; val_best_acc_score: 0.8107; val_best_f1_score: 0.8282; train_kl_reg_loss: 151093.6788; train_edge_recon_loss: 3417331.8333; train_gene_expr_recon_loss: 20648005.7778; train_masked_gp_l1_reg_loss: 2984.7102; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9596897.8889; train_global_loss: 33816313.3333; train_optim_loss: 33816313.3333; val_kl_reg_loss: 132453.1406; val_edge_recon_loss: 3491791.2500; val_gene_expr_recon_loss: 20875892.0000; val_masked_gp_l1_reg_loss: 2993.4143; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9810323.0000; val_global_loss: 34313452.0000; val_optim_loss: 34313452.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8934; val_auprc_score: 0.8835; val_best_acc_score: 0.8053; val_best_f1_score: 0.8174; train_kl_reg_loss: 152481.5330; train_edge_recon_loss: 3336899.2778; train_gene_expr_recon_loss: 20604578.0000; train_masked_gp_l1_reg_loss: 3001.9920; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9599570.3333; train_global_loss: 33696531.3333; train_optim_loss: 33696531.3333; val_kl_reg_loss: 139991.7812; val_edge_recon_loss: 3372591.7500; val_gene_expr_recon_loss: 20856252.0000; val_masked_gp_l1_reg_loss: 3012.6704; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9794284.0000; val_global_loss: 34166132.0000; val_optim_loss: 34166132.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8924; val_auprc_score: 0.8801; val_best_acc_score: 0.8065; val_best_f1_score: 0.8149; train_kl_reg_loss: 163618.6771; train_edge_recon_loss: 3249496.0278; train_gene_expr_recon_loss: 20529257.3333; train_masked_gp_l1_reg_loss: 3022.7477; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9575820.1111; train_global_loss: 33521214.6667; train_optim_loss: 33521214.6667; val_kl_reg_loss: 165424.0312; val_edge_recon_loss: 3223487.2500; val_gene_expr_recon_loss: 20851718.0000; val_masked_gp_l1_reg_loss: 3034.0078; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9788198.0000; val_global_loss: 34031864.0000; val_optim_loss: 34031864.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8925; val_auprc_score: 0.8771; val_best_acc_score: 0.8098; val_best_f1_score: 0.8145; train_kl_reg_loss: 189686.0642; train_edge_recon_loss: 3158395.4722; train_gene_expr_recon_loss: 20507434.8889; train_masked_gp_l1_reg_loss: 3044.5484; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9603823.3333; train_global_loss: 33462384.2222; train_optim_loss: 33462384.2222; val_kl_reg_loss: 188702.5938; val_edge_recon_loss: 3122232.0000; val_gene_expr_recon_loss: 20826594.0000; val_masked_gp_l1_reg_loss: 3055.2930; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9781761.0000; val_global_loss: 33922344.0000; val_optim_loss: 33922344.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9064; val_auprc_score: 0.8911; val_best_acc_score: 0.8289; val_best_f1_score: 0.8347; train_kl_reg_loss: 218846.6979; train_edge_recon_loss: 3479222.2222; train_gene_expr_recon_loss: 20989714.6667; train_masked_gp_l1_reg_loss: 3067.1568; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9622067.1111; train_global_loss: 34312917.3333; train_optim_loss: 34312917.3333; val_kl_reg_loss: 93665.0781; val_edge_recon_loss: 3443732.5000; val_gene_expr_recon_loss: 21318634.0000; val_masked_gp_l1_reg_loss: 3083.6892; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9834866.0000; val_global_loss: 34693984.0000; val_optim_loss: 34693984.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9152; val_auprc_score: 0.9039; val_best_acc_score: 0.8321; val_best_f1_score: 0.8409; train_kl_reg_loss: 209691.5920; train_edge_recon_loss: 3404369.3611; train_gene_expr_recon_loss: 21033232.2222; train_masked_gp_l1_reg_loss: 3106.0387; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9630306.8889; train_global_loss: 34280706.2222; train_optim_loss: 34280706.2222; val_kl_reg_loss: 69777.2969; val_edge_recon_loss: 3533237.2500; val_gene_expr_recon_loss: 21266254.0000; val_masked_gp_l1_reg_loss: 3131.3489; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9803019.0000; val_global_loss: 34675420.0000; val_optim_loss: 34675420.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9163; val_auprc_score: 0.9049; val_best_acc_score: 0.8274; val_best_f1_score: 0.8418; train_kl_reg_loss: 142910.1484; train_edge_recon_loss: 3519376.7500; train_gene_expr_recon_loss: 21493238.6667; train_masked_gp_l1_reg_loss: 3154.6471; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9641806.2222; train_global_loss: 34800486.6667; train_optim_loss: 34800486.6667; val_kl_reg_loss: 48350.0273; val_edge_recon_loss: 3613366.0000; val_gene_expr_recon_loss: 21524850.0000; val_masked_gp_l1_reg_loss: 3188.4814; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9838392.0000; val_global_loss: 35028144.0000; val_optim_loss: 35028144.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9088; val_auprc_score: 0.8944; val_best_acc_score: 0.8049; val_best_f1_score: 0.8282; train_kl_reg_loss: 85323.3056; train_edge_recon_loss: 3641108.1944; train_gene_expr_recon_loss: 21475778.2222; train_masked_gp_l1_reg_loss: 3223.5096; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9730306.8889; train_global_loss: 34935740.4444; train_optim_loss: 34935740.4444; val_kl_reg_loss: 43199.3438; val_edge_recon_loss: 3745273.0000; val_gene_expr_recon_loss: 21477450.0000; val_masked_gp_l1_reg_loss: 3266.1304; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9825812.0000; val_global_loss: 35095000.0000; val_optim_loss: 35095000.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9068; val_auprc_score: 0.8899; val_best_acc_score: 0.8060; val_best_f1_score: 0.8237; train_kl_reg_loss: 68515.8455; train_edge_recon_loss: 3691336.7222; train_gene_expr_recon_loss: 21198263.5556; train_masked_gp_l1_reg_loss: 3268.7278; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9634663.2222; train_global_loss: 34596048.0000; train_optim_loss: 34596048.0000; val_kl_reg_loss: 45320.9336; val_edge_recon_loss: 3764407.7500; val_gene_expr_recon_loss: 21470544.0000; val_masked_gp_l1_reg_loss: 3271.7908; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9827621.0000; val_global_loss: 35111164.0000; val_optim_loss: 35111164.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9124; val_auprc_score: 0.8981; val_best_acc_score: 0.8091; val_best_f1_score: 0.8322; train_kl_reg_loss: 75934.8021; train_edge_recon_loss: 3688282.5556; train_gene_expr_recon_loss: 21225026.0000; train_masked_gp_l1_reg_loss: 3273.9917; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9671986.6667; train_global_loss: 34664503.5556; train_optim_loss: 34664503.5556; val_kl_reg_loss: 51890.7656; val_edge_recon_loss: 3754574.2500; val_gene_expr_recon_loss: 21405254.0000; val_masked_gp_l1_reg_loss: 3276.5271; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9809762.0000; val_global_loss: 35024760.0000; val_optim_loss: 35024760.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9117; val_auprc_score: 0.8974; val_best_acc_score: 0.8102; val_best_f1_score: 0.8327; train_kl_reg_loss: 78268.7431; train_edge_recon_loss: 3680891.0556; train_gene_expr_recon_loss: 21153757.3333; train_masked_gp_l1_reg_loss: 3278.1083; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9611511.0000; train_global_loss: 34527706.6667; train_optim_loss: 34527706.6667; val_kl_reg_loss: 51868.6953; val_edge_recon_loss: 3755956.2500; val_gene_expr_recon_loss: 21364166.0000; val_masked_gp_l1_reg_loss: 3279.9175; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9809484.0000; val_global_loss: 34984756.0000; val_optim_loss: 34984756.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9123; val_auprc_score: 0.8969; val_best_acc_score: 0.8092; val_best_f1_score: 0.8314; train_kl_reg_loss: 80022.8082; train_edge_recon_loss: 3655840.0833; train_gene_expr_recon_loss: 21151307.3333; train_masked_gp_l1_reg_loss: 3280.9717; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9640834.3333; train_global_loss: 34531285.3333; train_optim_loss: 34531285.3333; val_kl_reg_loss: 50882.9297; val_edge_recon_loss: 3737405.2500; val_gene_expr_recon_loss: 21340978.0000; val_masked_gp_l1_reg_loss: 3282.2800; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9815635.0000; val_global_loss: 34948184.0000; val_optim_loss: 34948184.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 43 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9102
Val AUPRC score: 0.8954
Val best accuracy score: 0.8270
Val best F1 score: 0.8342
Val gene expr MSE score: 0.5439
Val chrom access MSE score: 0.0898
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
