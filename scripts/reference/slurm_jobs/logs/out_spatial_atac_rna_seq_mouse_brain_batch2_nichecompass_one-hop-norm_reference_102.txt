[True]
Run timestamp: 07082023_204040_102.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_102']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8882; val_auprc_score: 0.9042; val_best_acc_score: 0.5071; val_best_f1_score: 0.6699; train_kl_reg_loss: 15753.1032; train_edge_recon_loss: 350240.3299; train_gene_expr_recon_loss: 1211326.2778; train_masked_gp_l1_reg_loss: 4548.3693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167133.4792; train_chrom_access_recon_loss: 789627.4931; train_global_loss: 2538629.0556; train_optim_loss: 2538629.0556; val_kl_reg_loss: 7288.7510; val_edge_recon_loss: 406516.9375; val_gene_expr_recon_loss: 1041219.6250; val_masked_gp_l1_reg_loss: 4025.5544; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162924.2812; val_chrom_access_recon_loss: 523171.2812; val_global_loss: 2145146.2500; val_optim_loss: 2145146.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8956; val_auprc_score: 0.9096; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 9528.3164; train_edge_recon_loss: 353433.7917; train_gene_expr_recon_loss: 938673.3819; train_masked_gp_l1_reg_loss: 3920.3560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160285.4253; train_chrom_access_recon_loss: 496991.7014; train_global_loss: 1962832.9444; train_optim_loss: 1962832.9444; val_kl_reg_loss: 11807.7061; val_edge_recon_loss: 406570.8750; val_gene_expr_recon_loss: 831858.0000; val_masked_gp_l1_reg_loss: 3894.7622; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156932.0156; val_chrom_access_recon_loss: 474666.5938; val_global_loss: 1885730.0000; val_optim_loss: 1885730.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8935; val_auprc_score: 0.9041; val_best_acc_score: 0.5067; val_best_f1_score: 0.6697; train_kl_reg_loss: 14047.9414; train_edge_recon_loss: 356890.5451; train_gene_expr_recon_loss: 811795.9375; train_masked_gp_l1_reg_loss: 3983.1717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153909.2240; train_chrom_access_recon_loss: 464690.4653; train_global_loss: 1805317.3056; train_optim_loss: 1805317.3056; val_kl_reg_loss: 14892.2480; val_edge_recon_loss: 406540.5625; val_gene_expr_recon_loss: 776811.0000; val_masked_gp_l1_reg_loss: 4089.4187; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149863.5625; val_chrom_access_recon_loss: 460278.5625; val_global_loss: 1812475.2500; val_optim_loss: 1812475.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8860; val_auprc_score: 0.8958; val_best_acc_score: 0.5159; val_best_f1_score: 0.6736; train_kl_reg_loss: 16337.1298; train_edge_recon_loss: 357294.4028; train_gene_expr_recon_loss: 764347.4236; train_masked_gp_l1_reg_loss: 4133.8733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146280.1736; train_chrom_access_recon_loss: 454920.8264; train_global_loss: 1743313.8056; train_optim_loss: 1743313.8056; val_kl_reg_loss: 18010.8613; val_edge_recon_loss: 406482.9375; val_gene_expr_recon_loss: 746030.9375; val_masked_gp_l1_reg_loss: 4168.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141650.9375; val_chrom_access_recon_loss: 454932.5312; val_global_loss: 1771276.2500; val_optim_loss: 1771276.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8858; val_auprc_score: 0.8911; val_best_acc_score: 0.5199; val_best_f1_score: 0.6746; train_kl_reg_loss: 17619.5193; train_edge_recon_loss: 357727.4271; train_gene_expr_recon_loss: 740124.2153; train_masked_gp_l1_reg_loss: 4178.5564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137775.6233; train_chrom_access_recon_loss: 452147.2292; train_global_loss: 1709572.5694; train_optim_loss: 1709572.5694; val_kl_reg_loss: 17248.5938; val_edge_recon_loss: 406366.1562; val_gene_expr_recon_loss: 726219.6875; val_masked_gp_l1_reg_loss: 4185.3608; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132874.3438; val_chrom_access_recon_loss: 450754.4375; val_global_loss: 1737648.7500; val_optim_loss: 1737648.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8801; val_auprc_score: 0.8786; val_best_acc_score: 0.5362; val_best_f1_score: 0.6813; train_kl_reg_loss: 17865.4138; train_edge_recon_loss: 357850.5799; train_gene_expr_recon_loss: 723780.6944; train_masked_gp_l1_reg_loss: 4197.9085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128922.5964; train_chrom_access_recon_loss: 447455.1771; train_global_loss: 1680072.4028; train_optim_loss: 1680072.4028; val_kl_reg_loss: 17182.6484; val_edge_recon_loss: 406213.0000; val_gene_expr_recon_loss: 710113.8750; val_masked_gp_l1_reg_loss: 4203.2300; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123983.9766; val_chrom_access_recon_loss: 447985.8750; val_global_loss: 1709682.6250; val_optim_loss: 1709682.6250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8776; val_auprc_score: 0.8804; val_best_acc_score: 0.5625; val_best_f1_score: 0.6915; train_kl_reg_loss: 18336.6608; train_edge_recon_loss: 358094.8299; train_gene_expr_recon_loss: 705961.1042; train_masked_gp_l1_reg_loss: 4215.5630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120082.5981; train_chrom_access_recon_loss: 444112.0729; train_global_loss: 1650802.8472; train_optim_loss: 1650802.8472; val_kl_reg_loss: 17327.3438; val_edge_recon_loss: 405949.6250; val_gene_expr_recon_loss: 698852.1250; val_masked_gp_l1_reg_loss: 4218.7847; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115248.3984; val_chrom_access_recon_loss: 446088.0312; val_global_loss: 1687684.2500; val_optim_loss: 1687684.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8755; val_auprc_score: 0.8767; val_best_acc_score: 0.6163; val_best_f1_score: 0.7166; train_kl_reg_loss: 18868.8201; train_edge_recon_loss: 357826.4236; train_gene_expr_recon_loss: 696639.3403; train_masked_gp_l1_reg_loss: 4224.9825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111494.7214; train_chrom_access_recon_loss: 444049.2292; train_global_loss: 1633103.5556; train_optim_loss: 1633103.5556; val_kl_reg_loss: 18349.0000; val_edge_recon_loss: 405542.8125; val_gene_expr_recon_loss: 690107.3125; val_masked_gp_l1_reg_loss: 4224.1528; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106874.7656; val_chrom_access_recon_loss: 444404.3438; val_global_loss: 1669502.3750; val_optim_loss: 1669502.3750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8702; val_auprc_score: 0.8676; val_best_acc_score: 0.6911; val_best_f1_score: 0.7545; train_kl_reg_loss: 18811.5931; train_edge_recon_loss: 357595.2500; train_gene_expr_recon_loss: 687428.7639; train_masked_gp_l1_reg_loss: 4234.9250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103333.8993; train_chrom_access_recon_loss: 440846.7500; train_global_loss: 1612251.1806; train_optim_loss: 1612251.1806; val_kl_reg_loss: 17548.4883; val_edge_recon_loss: 404834.2188; val_gene_expr_recon_loss: 683962.3750; val_masked_gp_l1_reg_loss: 4239.8296; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98999.0781; val_chrom_access_recon_loss: 442991.3125; val_global_loss: 1652575.5000; val_optim_loss: 1652575.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8720; val_auprc_score: 0.8647; val_best_acc_score: 0.7567; val_best_f1_score: 0.7896; train_kl_reg_loss: 18908.5590; train_edge_recon_loss: 357310.2396; train_gene_expr_recon_loss: 686399.8125; train_masked_gp_l1_reg_loss: 4252.8168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95702.7031; train_chrom_access_recon_loss: 443633.7778; train_global_loss: 1606207.9167; train_optim_loss: 1606207.9167; val_kl_reg_loss: 18283.3008; val_edge_recon_loss: 403707.0000; val_gene_expr_recon_loss: 677601.7500; val_masked_gp_l1_reg_loss: 4260.1245; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91685.2344; val_chrom_access_recon_loss: 441725.9375; val_global_loss: 1637263.2500; val_optim_loss: 1637263.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8811; val_auprc_score: 0.8756; val_best_acc_score: 0.8026; val_best_f1_score: 0.8077; train_kl_reg_loss: 19046.9032; train_edge_recon_loss: 357059.3299; train_gene_expr_recon_loss: 678375.3264; train_masked_gp_l1_reg_loss: 4276.4771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88657.3524; train_chrom_access_recon_loss: 437433.5451; train_global_loss: 1584848.9722; train_optim_loss: 1584848.9722; val_kl_reg_loss: 17967.4180; val_edge_recon_loss: 401236.8438; val_gene_expr_recon_loss: 673371.4375; val_masked_gp_l1_reg_loss: 4286.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84982.7500; val_chrom_access_recon_loss: 440654.5312; val_global_loss: 1622499.7500; val_optim_loss: 1622499.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8848; val_auprc_score: 0.8770; val_best_acc_score: 0.7863; val_best_f1_score: 0.7848; train_kl_reg_loss: 18936.8702; train_edge_recon_loss: 355938.6840; train_gene_expr_recon_loss: 673982.7778; train_masked_gp_l1_reg_loss: 4301.4510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82244.6111; train_chrom_access_recon_loss: 439908.1042; train_global_loss: 1575312.5000; train_optim_loss: 1575312.5000; val_kl_reg_loss: 17774.0078; val_edge_recon_loss: 395699.7500; val_gene_expr_recon_loss: 669852.6250; val_masked_gp_l1_reg_loss: 4310.6133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78918.9531; val_chrom_access_recon_loss: 439657.1250; val_global_loss: 1606213.1250; val_optim_loss: 1606213.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8965; val_auprc_score: 0.8877; val_best_acc_score: 0.8107; val_best_f1_score: 0.8229; train_kl_reg_loss: 18439.0211; train_edge_recon_loss: 353549.2361; train_gene_expr_recon_loss: 671132.7778; train_masked_gp_l1_reg_loss: 4324.1855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76435.2986; train_chrom_access_recon_loss: 437278.8819; train_global_loss: 1561159.4444; train_optim_loss: 1561159.4444; val_kl_reg_loss: 17239.8027; val_edge_recon_loss: 383312.5312; val_gene_expr_recon_loss: 667601.4375; val_masked_gp_l1_reg_loss: 4333.9321; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73425.2266; val_chrom_access_recon_loss: 438782.1250; val_global_loss: 1584695.0000; val_optim_loss: 1584695.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8918; val_auprc_score: 0.8758; val_best_acc_score: 0.8116; val_best_f1_score: 0.8238; train_kl_reg_loss: 17668.7828; train_edge_recon_loss: 346618.5972; train_gene_expr_recon_loss: 666613.3611; train_masked_gp_l1_reg_loss: 4354.7453; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71185.0356; train_chrom_access_recon_loss: 437204.6562; train_global_loss: 1543645.1806; train_optim_loss: 1543645.1806; val_kl_reg_loss: 17122.8594; val_edge_recon_loss: 355020.4688; val_gene_expr_recon_loss: 667516.9375; val_masked_gp_l1_reg_loss: 4373.7485; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68466.7969; val_chrom_access_recon_loss: 438343.2500; val_global_loss: 1550844.0000; val_optim_loss: 1550844.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8880; val_auprc_score: 0.8688; val_best_acc_score: 0.8068; val_best_f1_score: 0.8212; train_kl_reg_loss: 19530.4388; train_edge_recon_loss: 330966.1042; train_gene_expr_recon_loss: 668808.1042; train_masked_gp_l1_reg_loss: 4401.4533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66438.6554; train_chrom_access_recon_loss: 437892.0312; train_global_loss: 1528036.7639; train_optim_loss: 1528036.7639; val_kl_reg_loss: 22259.7070; val_edge_recon_loss: 322615.3750; val_gene_expr_recon_loss: 668935.7500; val_masked_gp_l1_reg_loss: 4435.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63982.6367; val_chrom_access_recon_loss: 438297.9375; val_global_loss: 1520526.5000; val_optim_loss: 1520526.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8824; val_auprc_score: 0.8634; val_best_acc_score: 0.7975; val_best_f1_score: 0.8168; train_kl_reg_loss: 26544.1207; train_edge_recon_loss: 316361.4062; train_gene_expr_recon_loss: 669288.0764; train_masked_gp_l1_reg_loss: 4467.3424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62165.5204; train_chrom_access_recon_loss: 437979.4618; train_global_loss: 1516805.9722; train_optim_loss: 1516805.9722; val_kl_reg_loss: 27230.1797; val_edge_recon_loss: 315544.3125; val_gene_expr_recon_loss: 665090.0000; val_masked_gp_l1_reg_loss: 4504.7095; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59953.0039; val_chrom_access_recon_loss: 437098.0625; val_global_loss: 1509420.2500; val_optim_loss: 1509420.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8972; val_auprc_score: 0.8765; val_best_acc_score: 0.8089; val_best_f1_score: 0.8238; train_kl_reg_loss: 26349.5367; train_edge_recon_loss: 312961.7812; train_gene_expr_recon_loss: 664633.0903; train_masked_gp_l1_reg_loss: 4537.5071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58301.7578; train_chrom_access_recon_loss: 435766.2847; train_global_loss: 1502549.9583; train_optim_loss: 1502549.9583; val_kl_reg_loss: 24784.3086; val_edge_recon_loss: 310761.2500; val_gene_expr_recon_loss: 663513.0625; val_masked_gp_l1_reg_loss: 4569.0869; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56288.1094; val_chrom_access_recon_loss: 436246.0938; val_global_loss: 1496161.8750; val_optim_loss: 1496161.8750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9062; val_auprc_score: 0.8882; val_best_acc_score: 0.8211; val_best_f1_score: 0.8289; train_kl_reg_loss: 25584.2498; train_edge_recon_loss: 308563.0312; train_gene_expr_recon_loss: 660237.1319; train_masked_gp_l1_reg_loss: 4599.1882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54771.5903; train_chrom_access_recon_loss: 434119.5278; train_global_loss: 1487874.7361; train_optim_loss: 1487874.7361; val_kl_reg_loss: 25268.3828; val_edge_recon_loss: 305947.6875; val_gene_expr_recon_loss: 662449.5000; val_masked_gp_l1_reg_loss: 4625.3428; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52924.4727; val_chrom_access_recon_loss: 435419.6250; val_global_loss: 1486635.0000; val_optim_loss: 1486635.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9145; val_auprc_score: 0.8966; val_best_acc_score: 0.8341; val_best_f1_score: 0.8394; train_kl_reg_loss: 26063.5931; train_edge_recon_loss: 304831.3160; train_gene_expr_recon_loss: 664349.9028; train_masked_gp_l1_reg_loss: 4649.4806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51536.7526; train_chrom_access_recon_loss: 434492.4931; train_global_loss: 1485923.5417; train_optim_loss: 1485923.5417; val_kl_reg_loss: 24563.9414; val_edge_recon_loss: 303624.4688; val_gene_expr_recon_loss: 660545.7500; val_masked_gp_l1_reg_loss: 4677.4849; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49838.2109; val_chrom_access_recon_loss: 434720.2188; val_global_loss: 1477970.0000; val_optim_loss: 1477970.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9219; val_auprc_score: 0.9056; val_best_acc_score: 0.8452; val_best_f1_score: 0.8522; train_kl_reg_loss: 25533.9212; train_edge_recon_loss: 303657.0035; train_gene_expr_recon_loss: 662708.5556; train_masked_gp_l1_reg_loss: 4703.9973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48559.2986; train_chrom_access_recon_loss: 433689.2222; train_global_loss: 1478852.0000; train_optim_loss: 1478852.0000; val_kl_reg_loss: 25043.8867; val_edge_recon_loss: 303493.3438; val_gene_expr_recon_loss: 658230.6250; val_masked_gp_l1_reg_loss: 4730.9565; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46996.8828; val_chrom_access_recon_loss: 433847.6562; val_global_loss: 1472343.3750; val_optim_loss: 1472343.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9300; val_auprc_score: 0.9147; val_best_acc_score: 0.8570; val_best_f1_score: 0.8625; train_kl_reg_loss: 25507.8201; train_edge_recon_loss: 301545.5625; train_gene_expr_recon_loss: 658603.5069; train_masked_gp_l1_reg_loss: 4751.3905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45824.7561; train_chrom_access_recon_loss: 432970.0243; train_global_loss: 1469203.0833; train_optim_loss: 1469203.0833; val_kl_reg_loss: 24806.5723; val_edge_recon_loss: 298591.2500; val_gene_expr_recon_loss: 657163.5625; val_masked_gp_l1_reg_loss: 4776.8208; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44380.9297; val_chrom_access_recon_loss: 433362.5000; val_global_loss: 1463081.6250; val_optim_loss: 1463081.6250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9434; val_auprc_score: 0.9285; val_best_acc_score: 0.8747; val_best_f1_score: 0.8794; train_kl_reg_loss: 25559.3223; train_edge_recon_loss: 298703.1979; train_gene_expr_recon_loss: 657874.2500; train_masked_gp_l1_reg_loss: 4799.7897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43293.8108; train_chrom_access_recon_loss: 430383.4062; train_global_loss: 1460613.7917; train_optim_loss: 1460613.7917; val_kl_reg_loss: 25239.1328; val_edge_recon_loss: 294618.7188; val_gene_expr_recon_loss: 656588.0625; val_masked_gp_l1_reg_loss: 4820.2471; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41960.8008; val_chrom_access_recon_loss: 432632.7500; val_global_loss: 1455859.7500; val_optim_loss: 1455859.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9420; val_auprc_score: 0.9210; val_best_acc_score: 0.8779; val_best_f1_score: 0.8835; train_kl_reg_loss: 25799.3188; train_edge_recon_loss: 296068.1181; train_gene_expr_recon_loss: 652827.7083; train_masked_gp_l1_reg_loss: 4842.0826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40965.9167; train_chrom_access_recon_loss: 429280.3056; train_global_loss: 1449783.4444; train_optim_loss: 1449783.4444; val_kl_reg_loss: 25869.2656; val_edge_recon_loss: 295367.0938; val_gene_expr_recon_loss: 654696.5000; val_masked_gp_l1_reg_loss: 4863.9458; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39739.3906; val_chrom_access_recon_loss: 432102.3438; val_global_loss: 1452638.5000; val_optim_loss: 1452638.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9525; val_auprc_score: 0.9376; val_best_acc_score: 0.8926; val_best_f1_score: 0.8975; train_kl_reg_loss: 26428.4191; train_edge_recon_loss: 294436.8438; train_gene_expr_recon_loss: 655404.4444; train_masked_gp_l1_reg_loss: 4885.9709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38813.8012; train_chrom_access_recon_loss: 430452.7847; train_global_loss: 1450422.2361; train_optim_loss: 1450422.2361; val_kl_reg_loss: 25705.1875; val_edge_recon_loss: 292477.4375; val_gene_expr_recon_loss: 654268.6250; val_masked_gp_l1_reg_loss: 4905.7041; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37677.6992; val_chrom_access_recon_loss: 431433.9375; val_global_loss: 1446468.5000; val_optim_loss: 1446468.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9476; val_auprc_score: 0.9299; val_best_acc_score: 0.8882; val_best_f1_score: 0.8938; train_kl_reg_loss: 26183.6094; train_edge_recon_loss: 293594.5729; train_gene_expr_recon_loss: 655805.9722; train_masked_gp_l1_reg_loss: 4926.1686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36833.1419; train_chrom_access_recon_loss: 431064.0590; train_global_loss: 1448407.5278; train_optim_loss: 1448407.5278; val_kl_reg_loss: 26262.4883; val_edge_recon_loss: 295153.0000; val_gene_expr_recon_loss: 652040.9375; val_masked_gp_l1_reg_loss: 4945.9795; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35793.9766; val_chrom_access_recon_loss: 430719.7188; val_global_loss: 1444916.1250; val_optim_loss: 1444916.1250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9515; val_auprc_score: 0.9364; val_best_acc_score: 0.8929; val_best_f1_score: 0.8947; train_kl_reg_loss: 25342.2615; train_edge_recon_loss: 303901.9410; train_gene_expr_recon_loss: 1000313.9583; train_masked_gp_l1_reg_loss: 5014.6749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34851.6194; train_chrom_access_recon_loss: 456635.0833; train_global_loss: 1826059.5417; train_optim_loss: 1826059.5417; val_kl_reg_loss: 11759.4023; val_edge_recon_loss: 297928.7188; val_gene_expr_recon_loss: 990898.5000; val_masked_gp_l1_reg_loss: 5128.9707; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33576.0508; val_chrom_access_recon_loss: 455566.4062; val_global_loss: 1794858.0000; val_optim_loss: 1794858.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9513; val_auprc_score: 0.9355; val_best_acc_score: 0.8903; val_best_f1_score: 0.8928; train_kl_reg_loss: 22800.9816; train_edge_recon_loss: 296083.1944; train_gene_expr_recon_loss: 992753.1042; train_masked_gp_l1_reg_loss: 5242.2936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32516.7418; train_chrom_access_recon_loss: 455238.4306; train_global_loss: 1804634.7361; train_optim_loss: 1804634.7361; val_kl_reg_loss: 12713.3184; val_edge_recon_loss: 294222.3125; val_gene_expr_recon_loss: 987134.3750; val_masked_gp_l1_reg_loss: 5383.7012; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31214.7656; val_chrom_access_recon_loss: 454963.4688; val_global_loss: 1785632.0000; val_optim_loss: 1785632.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9577; val_auprc_score: 0.9461; val_best_acc_score: 0.8965; val_best_f1_score: 0.8993; train_kl_reg_loss: 20724.6411; train_edge_recon_loss: 292183.7500; train_gene_expr_recon_loss: 983288.1111; train_masked_gp_l1_reg_loss: 5476.6313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30226.9056; train_chrom_access_recon_loss: 452002.6146; train_global_loss: 1783902.6250; train_optim_loss: 1783902.6250; val_kl_reg_loss: 14427.4160; val_edge_recon_loss: 292527.2188; val_gene_expr_recon_loss: 980484.2500; val_masked_gp_l1_reg_loss: 5581.7275; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29026.0527; val_chrom_access_recon_loss: 454167.6250; val_global_loss: 1776214.2500; val_optim_loss: 1776214.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9593; val_auprc_score: 0.9464; val_best_acc_score: 0.8996; val_best_f1_score: 0.9036; train_kl_reg_loss: 19930.1821; train_edge_recon_loss: 288550.4792; train_gene_expr_recon_loss: 981994.3125; train_masked_gp_l1_reg_loss: 5647.3098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28130.8596; train_chrom_access_recon_loss: 452895.7604; train_global_loss: 1777148.8750; train_optim_loss: 1777148.8750; val_kl_reg_loss: 16375.9277; val_edge_recon_loss: 288689.7188; val_gene_expr_recon_loss: 976449.9375; val_masked_gp_l1_reg_loss: 5721.7324; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27051.9102; val_chrom_access_recon_loss: 453600.3750; val_global_loss: 1767889.6250; val_optim_loss: 1767889.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9552; val_auprc_score: 0.9412; val_best_acc_score: 0.8987; val_best_f1_score: 0.9021; train_kl_reg_loss: 19966.9933; train_edge_recon_loss: 287139.6701; train_gene_expr_recon_loss: 976594.3958; train_masked_gp_l1_reg_loss: 5713.0567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26882.6380; train_chrom_access_recon_loss: 452021.0104; train_global_loss: 1768317.7778; train_optim_loss: 1768317.7778; val_kl_reg_loss: 16515.3242; val_edge_recon_loss: 289521.0938; val_gene_expr_recon_loss: 975538.8750; val_masked_gp_l1_reg_loss: 5705.1929; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26694.9004; val_chrom_access_recon_loss: 453422.1562; val_global_loss: 1767397.5000; val_optim_loss: 1767397.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9600; val_auprc_score: 0.9460; val_best_acc_score: 0.9026; val_best_f1_score: 0.9058; train_kl_reg_loss: 19784.0551; train_edge_recon_loss: 287676.7049; train_gene_expr_recon_loss: 975870.9028; train_masked_gp_l1_reg_loss: 5705.7728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26582.6389; train_chrom_access_recon_loss: 451062.0799; train_global_loss: 1766682.1528; train_optim_loss: 1766682.1528; val_kl_reg_loss: 16542.1133; val_edge_recon_loss: 287302.5000; val_gene_expr_recon_loss: 975448.3750; val_masked_gp_l1_reg_loss: 5705.3760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26437.3203; val_chrom_access_recon_loss: 453429.9688; val_global_loss: 1764865.7500; val_optim_loss: 1764865.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9593; val_auprc_score: 0.9456; val_best_acc_score: 0.9064; val_best_f1_score: 0.9089; train_kl_reg_loss: 19779.5026; train_edge_recon_loss: 287537.1771; train_gene_expr_recon_loss: 980556.9444; train_masked_gp_l1_reg_loss: 5706.0912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26332.2624; train_chrom_access_recon_loss: 452350.5347; train_global_loss: 1772262.5694; train_optim_loss: 1772262.5694; val_kl_reg_loss: 16590.1914; val_edge_recon_loss: 286567.0312; val_gene_expr_recon_loss: 974821.6250; val_masked_gp_l1_reg_loss: 5707.2749; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26204.0273; val_chrom_access_recon_loss: 453322.2500; val_global_loss: 1763212.3750; val_optim_loss: 1763212.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9549; val_auprc_score: 0.9384; val_best_acc_score: 0.9010; val_best_f1_score: 0.9053; train_kl_reg_loss: 19595.2062; train_edge_recon_loss: 286843.1285; train_gene_expr_recon_loss: 976197.8333; train_masked_gp_l1_reg_loss: 5708.9300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26106.5736; train_chrom_access_recon_loss: 450839.7812; train_global_loss: 1765291.4583; train_optim_loss: 1765291.4583; val_kl_reg_loss: 16539.5566; val_edge_recon_loss: 288616.1250; val_gene_expr_recon_loss: 974814.1250; val_masked_gp_l1_reg_loss: 5711.4692; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25990.0410; val_chrom_access_recon_loss: 453416.5625; val_global_loss: 1765087.7500; val_optim_loss: 1765087.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 37 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9473
val AUPRC score: 0.9278
val best accuracy score: 0.8872
val best F1 score: 0.8915
val target rna MSE score: 3.8891
val source rna MSE score: 3.1935
val target atac MSE score: 0.1349
val source atac MSE score: 0.0204
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
