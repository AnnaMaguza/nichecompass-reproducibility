[True, False, True]
Run timestamp: 06092023_134843_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '1000.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 556628
Number of validation nodes: 61848
Number of training edges: 1316511
Number of validation edges: 146278
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8939; val_auprc_score: 0.9787; val_best_acc_score: 0.9182; val_best_f1_score: 0.9543; train_kl_reg_loss: 18509.9965; train_edge_recon_loss: 724980.6309; train_cat_covariates_contrastive_loss: 945143.7770; train_gene_expr_recon_loss: 2749543.7680; train_masked_gp_l1_reg_loss: 43307.5352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57032.0593; train_global_loss: 4538517.7714; train_optim_loss: 4538517.7714; val_kl_reg_loss: 15199.8840; val_edge_recon_loss: 717939.8551; val_cat_covariates_contrastive_loss: 942302.1165; val_gene_expr_recon_loss: 2616163.6766; val_masked_gp_l1_reg_loss: 31169.1621; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12895.2158; val_global_loss: 4335669.5629; val_optim_loss: 4335669.5629
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9139; val_auprc_score: 0.9827; val_best_acc_score: 0.9242; val_best_f1_score: 0.9574; train_kl_reg_loss: 15754.0235; train_edge_recon_loss: 695452.6197; train_cat_covariates_contrastive_loss: 943032.8702; train_gene_expr_recon_loss: 2577561.1201; train_masked_gp_l1_reg_loss: 32264.5600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13546.6023; train_global_loss: 4277611.7924; train_optim_loss: 4277611.7924; val_kl_reg_loss: 16243.5581; val_edge_recon_loss: 716056.8573; val_cat_covariates_contrastive_loss: 942586.7544; val_gene_expr_recon_loss: 2548991.6329; val_masked_gp_l1_reg_loss: 33824.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13982.8320; val_global_loss: 4271685.8243; val_optim_loss: 4271685.8243
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9191; val_auprc_score: 0.9829; val_best_acc_score: 0.9285; val_best_f1_score: 0.9597; train_kl_reg_loss: 17189.6958; train_edge_recon_loss: 691478.5430; train_cat_covariates_contrastive_loss: 944491.0346; train_gene_expr_recon_loss: 2526306.4835; train_masked_gp_l1_reg_loss: 36070.9618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14344.6480; train_global_loss: 4229881.3663; train_optim_loss: 4229881.3663; val_kl_reg_loss: 18066.0618; val_edge_recon_loss: 723688.4122; val_cat_covariates_contrastive_loss: 944612.1591; val_gene_expr_recon_loss: 2505840.7640; val_masked_gp_l1_reg_loss: 38469.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14945.9648; val_global_loss: 4245622.9904; val_optim_loss: 4245622.9904
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9267; val_auprc_score: 0.9846; val_best_acc_score: 0.9332; val_best_f1_score: 0.9623; train_kl_reg_loss: 19084.1047; train_edge_recon_loss: 688867.0666; train_cat_covariates_contrastive_loss: 946086.9095; train_gene_expr_recon_loss: 2492560.0784; train_masked_gp_l1_reg_loss: 39813.0169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15419.7474; train_global_loss: 4201830.9278; train_optim_loss: 4201830.9278; val_kl_reg_loss: 20067.3570; val_edge_recon_loss: 715892.0109; val_cat_covariates_contrastive_loss: 945741.7183; val_gene_expr_recon_loss: 2481314.5760; val_masked_gp_l1_reg_loss: 41341.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15887.9775; val_global_loss: 4220245.6294; val_optim_loss: 4220245.6294
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9385; val_auprc_score: 0.9873; val_best_acc_score: 0.9374; val_best_f1_score: 0.9647; train_kl_reg_loss: 20683.8010; train_edge_recon_loss: 688566.5864; train_cat_covariates_contrastive_loss: 947016.8094; train_gene_expr_recon_loss: 2470850.7707; train_masked_gp_l1_reg_loss: 42269.1823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16014.0408; train_global_loss: 4185401.1908; train_optim_loss: 4185401.1908; val_kl_reg_loss: 21067.5155; val_edge_recon_loss: 713309.4635; val_cat_covariates_contrastive_loss: 949038.6025; val_gene_expr_recon_loss: 2465095.6066; val_masked_gp_l1_reg_loss: 43414.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16222.8164; val_global_loss: 4208148.5997; val_optim_loss: 4208148.5997
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9351; val_auprc_score: 0.9865; val_best_acc_score: 0.9340; val_best_f1_score: 0.9628; train_kl_reg_loss: 21850.2123; train_edge_recon_loss: 688594.9522; train_cat_covariates_contrastive_loss: 947666.3819; train_gene_expr_recon_loss: 2456481.8890; train_masked_gp_l1_reg_loss: 44134.1695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16338.8346; train_global_loss: 4175066.4377; train_optim_loss: 4175066.4377; val_kl_reg_loss: 22143.0374; val_edge_recon_loss: 716169.2603; val_cat_covariates_contrastive_loss: 947560.2015; val_gene_expr_recon_loss: 2455310.5166; val_masked_gp_l1_reg_loss: 45061.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16428.9961; val_global_loss: 4202673.0411; val_optim_loss: 4202673.0411
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9356; val_auprc_score: 0.9865; val_best_acc_score: 0.9369; val_best_f1_score: 0.9644; train_kl_reg_loss: 22806.0544; train_edge_recon_loss: 688948.8326; train_cat_covariates_contrastive_loss: 948059.6637; train_gene_expr_recon_loss: 2446847.9752; train_masked_gp_l1_reg_loss: 45508.0883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16571.2979; train_global_loss: 4168741.9104; train_optim_loss: 4168741.9104; val_kl_reg_loss: 23653.2053; val_edge_recon_loss: 710174.0162; val_cat_covariates_contrastive_loss: 947939.3995; val_gene_expr_recon_loss: 2443117.5306; val_masked_gp_l1_reg_loss: 46254.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16731.7441; val_global_loss: 4187870.3042; val_optim_loss: 4187870.3042
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9359; val_auprc_score: 0.9861; val_best_acc_score: 0.9355; val_best_f1_score: 0.9635; train_kl_reg_loss: 23603.6880; train_edge_recon_loss: 688074.2006; train_cat_covariates_contrastive_loss: 948450.8075; train_gene_expr_recon_loss: 2438761.0998; train_masked_gp_l1_reg_loss: 46793.6024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16723.6376; train_global_loss: 4162407.0358; train_optim_loss: 4162407.0358; val_kl_reg_loss: 23808.3190; val_edge_recon_loss: 717534.4538; val_cat_covariates_contrastive_loss: 947604.8896; val_gene_expr_recon_loss: 2438339.7561; val_masked_gp_l1_reg_loss: 47390.7305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16790.9473; val_global_loss: 4191469.0656; val_optim_loss: 4191469.0656
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9374; val_auprc_score: 0.9867; val_best_acc_score: 0.9390; val_best_f1_score: 0.9656; train_kl_reg_loss: 24281.9874; train_edge_recon_loss: 686937.4063; train_cat_covariates_contrastive_loss: 948605.8966; train_gene_expr_recon_loss: 2430787.3619; train_masked_gp_l1_reg_loss: 48126.7344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16738.1042; train_global_loss: 4155477.4886; train_optim_loss: 4155477.4886; val_kl_reg_loss: 24680.2187; val_edge_recon_loss: 707015.2539; val_cat_covariates_contrastive_loss: 948178.4351; val_gene_expr_recon_loss: 2429093.0271; val_masked_gp_l1_reg_loss: 48834.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16856.3906; val_global_loss: 4174657.9152; val_optim_loss: 4174657.9152
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9357; val_auprc_score: 0.9861; val_best_acc_score: 0.9380; val_best_f1_score: 0.9650; train_kl_reg_loss: 25066.9795; train_edge_recon_loss: 691078.2275; train_cat_covariates_contrastive_loss: 948927.0622; train_gene_expr_recon_loss: 2423287.9741; train_masked_gp_l1_reg_loss: 49425.5271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16919.4639; train_global_loss: 4154705.2320; train_optim_loss: 4154705.2320; val_kl_reg_loss: 25967.0947; val_edge_recon_loss: 717809.2879; val_cat_covariates_contrastive_loss: 947291.1818; val_gene_expr_recon_loss: 2425395.6320; val_masked_gp_l1_reg_loss: 49512.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16989.7832; val_global_loss: 4182965.7168; val_optim_loss: 4182965.7168
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9383; val_auprc_score: 0.9869; val_best_acc_score: 0.9370; val_best_f1_score: 0.9643; train_kl_reg_loss: 25604.4990; train_edge_recon_loss: 688947.0924; train_cat_covariates_contrastive_loss: 948945.1001; train_gene_expr_recon_loss: 2416746.8036; train_masked_gp_l1_reg_loss: 50123.5386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17152.0047; train_global_loss: 4147519.0397; train_optim_loss: 4147519.0397; val_kl_reg_loss: 25667.8234; val_edge_recon_loss: 711029.9352; val_cat_covariates_contrastive_loss: 948839.1980; val_gene_expr_recon_loss: 2416028.9554; val_masked_gp_l1_reg_loss: 50370.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17357.5430; val_global_loss: 4169294.2413; val_optim_loss: 4169294.2413
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9390; val_auprc_score: 0.9870; val_best_acc_score: 0.9369; val_best_f1_score: 0.9643; train_kl_reg_loss: 26057.7374; train_edge_recon_loss: 687837.1350; train_cat_covariates_contrastive_loss: 949206.7083; train_gene_expr_recon_loss: 2411936.3280; train_masked_gp_l1_reg_loss: 50742.6520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17327.7262; train_global_loss: 4143108.2858; train_optim_loss: 4143108.2858; val_kl_reg_loss: 26845.6826; val_edge_recon_loss: 718677.5413; val_cat_covariates_contrastive_loss: 948547.6302; val_gene_expr_recon_loss: 2412317.2850; val_masked_gp_l1_reg_loss: 50936.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17329.6816; val_global_loss: 4174654.4694; val_optim_loss: 4174654.4694
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9380; val_auprc_score: 0.9866; val_best_acc_score: 0.9391; val_best_f1_score: 0.9656; train_kl_reg_loss: 26473.9178; train_edge_recon_loss: 689368.6302; train_cat_covariates_contrastive_loss: 949175.2655; train_gene_expr_recon_loss: 2408309.6560; train_masked_gp_l1_reg_loss: 51483.5858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17433.0771; train_global_loss: 4142244.1337; train_optim_loss: 4142244.1337; val_kl_reg_loss: 26682.7205; val_edge_recon_loss: 711239.0160; val_cat_covariates_contrastive_loss: 949398.0474; val_gene_expr_recon_loss: 2404739.0778; val_masked_gp_l1_reg_loss: 51730.5742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17446.9844; val_global_loss: 4161236.3706; val_optim_loss: 4161236.3706
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9429; val_auprc_score: 0.9880; val_best_acc_score: 0.9408; val_best_f1_score: 0.9664; train_kl_reg_loss: 26867.8965; train_edge_recon_loss: 689559.5555; train_cat_covariates_contrastive_loss: 949371.3251; train_gene_expr_recon_loss: 2403680.6545; train_masked_gp_l1_reg_loss: 52125.4381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17534.7145; train_global_loss: 4139139.5865; train_optim_loss: 4139139.5865; val_kl_reg_loss: 27283.3969; val_edge_recon_loss: 713409.7061; val_cat_covariates_contrastive_loss: 950764.0479; val_gene_expr_recon_loss: 2403650.6600; val_masked_gp_l1_reg_loss: 52357.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17673.3965; val_global_loss: 4165139.2955; val_optim_loss: 4165139.2955
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9422; val_auprc_score: 0.9876; val_best_acc_score: 0.9409; val_best_f1_score: 0.9666; train_kl_reg_loss: 27153.9316; train_edge_recon_loss: 686430.8670; train_cat_covariates_contrastive_loss: 949503.4218; train_gene_expr_recon_loss: 2400833.2884; train_masked_gp_l1_reg_loss: 52449.8569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17590.4287; train_global_loss: 4133961.7984; train_optim_loss: 4133961.7984; val_kl_reg_loss: 27360.2148; val_edge_recon_loss: 710375.3737; val_cat_covariates_contrastive_loss: 949489.9679; val_gene_expr_recon_loss: 2401497.6722; val_masked_gp_l1_reg_loss: 52737.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17596.6074; val_global_loss: 4159057.2142; val_optim_loss: 4159057.2142
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9433; val_auprc_score: 0.9878; val_best_acc_score: 0.9420; val_best_f1_score: 0.9672; train_kl_reg_loss: 27358.8224; train_edge_recon_loss: 687765.2796; train_cat_covariates_contrastive_loss: 949520.9090; train_gene_expr_recon_loss: 2397490.3152; train_masked_gp_l1_reg_loss: 52971.2284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17634.9648; train_global_loss: 4132741.5202; train_optim_loss: 4132741.5202; val_kl_reg_loss: 28310.9016; val_edge_recon_loss: 710081.7555; val_cat_covariates_contrastive_loss: 948958.9141; val_gene_expr_recon_loss: 2399336.4816; val_masked_gp_l1_reg_loss: 53292.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17702.6660; val_global_loss: 4157682.7203; val_optim_loss: 4157682.7203
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9407; val_auprc_score: 0.9871; val_best_acc_score: 0.9418; val_best_f1_score: 0.9671; train_kl_reg_loss: 27751.0157; train_edge_recon_loss: 690168.9544; train_cat_covariates_contrastive_loss: 949673.5983; train_gene_expr_recon_loss: 2395534.9428; train_masked_gp_l1_reg_loss: 53493.9597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17727.8003; train_global_loss: 4134350.2722; train_optim_loss: 4134350.2722; val_kl_reg_loss: 28615.4025; val_edge_recon_loss: 714029.4056; val_cat_covariates_contrastive_loss: 949003.7139; val_gene_expr_recon_loss: 2397221.9747; val_masked_gp_l1_reg_loss: 53929.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18032.5547; val_global_loss: 4160832.8164; val_optim_loss: 4160832.8164
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9421; val_auprc_score: 0.9876; val_best_acc_score: 0.9416; val_best_f1_score: 0.9670; train_kl_reg_loss: 27881.5892; train_edge_recon_loss: 689072.6638; train_cat_covariates_contrastive_loss: 949767.5327; train_gene_expr_recon_loss: 2392521.1340; train_masked_gp_l1_reg_loss: 53824.7184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17779.8767; train_global_loss: 4130847.5130; train_optim_loss: 4130847.5130; val_kl_reg_loss: 27970.7201; val_edge_recon_loss: 715354.3447; val_cat_covariates_contrastive_loss: 950473.4451; val_gene_expr_recon_loss: 2393543.3549; val_masked_gp_l1_reg_loss: 53857.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17840.7051; val_global_loss: 4159039.5612; val_optim_loss: 4159039.5612
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9444; val_auprc_score: 0.9883; val_best_acc_score: 0.9423; val_best_f1_score: 0.9674; train_kl_reg_loss: 28079.7703; train_edge_recon_loss: 691101.4282; train_cat_covariates_contrastive_loss: 949700.0432; train_gene_expr_recon_loss: 2391947.8780; train_masked_gp_l1_reg_loss: 53947.6666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17834.7095; train_global_loss: 4132611.4952; train_optim_loss: 4132611.4952; val_kl_reg_loss: 28386.2187; val_edge_recon_loss: 709617.1996; val_cat_covariates_contrastive_loss: 950019.7688; val_gene_expr_recon_loss: 2393517.0315; val_masked_gp_l1_reg_loss: 54160.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17893.8730; val_global_loss: 4153594.8138; val_optim_loss: 4153594.8138
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9450; val_auprc_score: 0.9884; val_best_acc_score: 0.9424; val_best_f1_score: 0.9674; train_kl_reg_loss: 28168.1475; train_edge_recon_loss: 690629.4261; train_cat_covariates_contrastive_loss: 949580.0464; train_gene_expr_recon_loss: 2390177.4110; train_masked_gp_l1_reg_loss: 54151.9961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17894.6932; train_global_loss: 4130601.7187; train_optim_loss: 4130601.7187; val_kl_reg_loss: 27644.8865; val_edge_recon_loss: 710825.7158; val_cat_covariates_contrastive_loss: 950840.0465; val_gene_expr_recon_loss: 2393088.9152; val_masked_gp_l1_reg_loss: 54408.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17908.9043; val_global_loss: 4154717.0481; val_optim_loss: 4154717.0481
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9379; val_auprc_score: 0.9864; val_best_acc_score: 0.9405; val_best_f1_score: 0.9663; train_kl_reg_loss: 28283.5378; train_edge_recon_loss: 689504.3504; train_cat_covariates_contrastive_loss: 949807.9704; train_gene_expr_recon_loss: 2389579.4542; train_masked_gp_l1_reg_loss: 54405.2847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17940.6502; train_global_loss: 4129521.2467; train_optim_loss: 4129521.2467; val_kl_reg_loss: 29289.5397; val_edge_recon_loss: 711477.8833; val_cat_covariates_contrastive_loss: 948131.2183; val_gene_expr_recon_loss: 2391500.3549; val_masked_gp_l1_reg_loss: 54628.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17898.5742; val_global_loss: 4152926.0175; val_optim_loss: 4152926.0175
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9452; val_auprc_score: 0.9879; val_best_acc_score: 0.9422; val_best_f1_score: 0.9672; train_kl_reg_loss: 28377.3707; train_edge_recon_loss: 691989.6804; train_cat_covariates_contrastive_loss: 949729.1617; train_gene_expr_recon_loss: 2388107.5635; train_masked_gp_l1_reg_loss: 54656.7658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17984.9101; train_global_loss: 4130845.4485; train_optim_loss: 4130845.4485; val_kl_reg_loss: 28488.5161; val_edge_recon_loss: 721081.9823; val_cat_covariates_contrastive_loss: 949159.2854; val_gene_expr_recon_loss: 2388981.1163; val_masked_gp_l1_reg_loss: 54634.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17897.5391; val_global_loss: 4160242.9292; val_optim_loss: 4160242.9292
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9431; val_auprc_score: 0.9876; val_best_acc_score: 0.9434; val_best_f1_score: 0.9679; train_kl_reg_loss: 28525.1129; train_edge_recon_loss: 686782.1453; train_cat_covariates_contrastive_loss: 949821.7778; train_gene_expr_recon_loss: 2387019.1099; train_masked_gp_l1_reg_loss: 54857.5623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18031.3055; train_global_loss: 4125037.0157; train_optim_loss: 4125037.0157; val_kl_reg_loss: 29006.2413; val_edge_recon_loss: 714681.0894; val_cat_covariates_contrastive_loss: 948865.9358; val_gene_expr_recon_loss: 2388007.7587; val_masked_gp_l1_reg_loss: 55067.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18082.5801; val_global_loss: 4153710.5428; val_optim_loss: 4153710.5428
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9447; val_auprc_score: 0.9880; val_best_acc_score: 0.9432; val_best_f1_score: 0.9679; train_kl_reg_loss: 28746.1706; train_edge_recon_loss: 690259.1361; train_cat_covariates_contrastive_loss: 949713.3511; train_gene_expr_recon_loss: 2385552.9754; train_masked_gp_l1_reg_loss: 55025.6936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18052.7165; train_global_loss: 4127350.0417; train_optim_loss: 4127350.0417; val_kl_reg_loss: 29979.8730; val_edge_recon_loss: 710714.1431; val_cat_covariates_contrastive_loss: 948675.7677; val_gene_expr_recon_loss: 2387275.1128; val_masked_gp_l1_reg_loss: 55073.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18021.9414; val_global_loss: 4149740.1748; val_optim_loss: 4149740.1748
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9466; val_auprc_score: 0.9885; val_best_acc_score: 0.9447; val_best_f1_score: 0.9687; train_kl_reg_loss: 28825.3799; train_edge_recon_loss: 690000.3703; train_cat_covariates_contrastive_loss: 949832.2942; train_gene_expr_recon_loss: 2384656.6167; train_masked_gp_l1_reg_loss: 55128.0871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18082.1498; train_global_loss: 4126524.9002; train_optim_loss: 4126524.9002; val_kl_reg_loss: 29670.3629; val_edge_recon_loss: 714290.4325; val_cat_covariates_contrastive_loss: 948811.7867; val_gene_expr_recon_loss: 2384736.2264; val_masked_gp_l1_reg_loss: 55136.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18187.1914; val_global_loss: 4150832.6993; val_optim_loss: 4150832.6993
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9365; val_auprc_score: 0.9866; val_best_acc_score: 0.9364; val_best_f1_score: 0.9641; train_kl_reg_loss: 24179.9096; train_edge_recon_loss: 696000.5008; train_cat_covariates_contrastive_loss: 949267.3178; train_gene_expr_recon_loss: 1909376.7329; train_masked_gp_l1_reg_loss: 52815.0677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16847.0245; train_global_loss: 3648486.5523; train_optim_loss: 3648486.5523; val_kl_reg_loss: 23383.5839; val_edge_recon_loss: 718361.5650; val_cat_covariates_contrastive_loss: 949639.5983; val_gene_expr_recon_loss: 1909837.8304; val_masked_gp_l1_reg_loss: 52671.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17020.8750; val_global_loss: 3670915.1731; val_optim_loss: 3670915.1731
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9428; val_auprc_score: 0.9879; val_best_acc_score: 0.9416; val_best_f1_score: 0.9670; train_kl_reg_loss: 24100.3664; train_edge_recon_loss: 690926.3750; train_cat_covariates_contrastive_loss: 949208.0396; train_gene_expr_recon_loss: 1907801.7585; train_masked_gp_l1_reg_loss: 52819.1550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17035.9763; train_global_loss: 3641891.6706; train_optim_loss: 3641891.6706; val_kl_reg_loss: 23723.1433; val_edge_recon_loss: 712464.9742; val_cat_covariates_contrastive_loss: 950436.6989; val_gene_expr_recon_loss: 1910690.7255; val_masked_gp_l1_reg_loss: 52930.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17118.2285; val_global_loss: 3667364.2937; val_optim_loss: 3667364.2937
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9373; val_auprc_score: 0.9861; val_best_acc_score: 0.9381; val_best_f1_score: 0.9648; train_kl_reg_loss: 24226.0955; train_edge_recon_loss: 687411.7625; train_cat_covariates_contrastive_loss: 949206.2606; train_gene_expr_recon_loss: 1906591.6134; train_masked_gp_l1_reg_loss: 52945.3095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17123.4743; train_global_loss: 3637504.5183; train_optim_loss: 3637504.5183; val_kl_reg_loss: 25019.7461; val_edge_recon_loss: 726426.4419; val_cat_covariates_contrastive_loss: 948306.3783; val_gene_expr_recon_loss: 1909175.4956; val_masked_gp_l1_reg_loss: 52970.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17095.4336; val_global_loss: 3678993.8129; val_optim_loss: 3678993.8129
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9440; val_auprc_score: 0.9883; val_best_acc_score: 0.9414; val_best_f1_score: 0.9669; train_kl_reg_loss: 24387.9607; train_edge_recon_loss: 690564.5525; train_cat_covariates_contrastive_loss: 949521.1771; train_gene_expr_recon_loss: 1906387.2674; train_masked_gp_l1_reg_loss: 53113.8254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17147.2153; train_global_loss: 3641121.9984; train_optim_loss: 3641121.9984; val_kl_reg_loss: 24196.3971; val_edge_recon_loss: 710727.4890; val_cat_covariates_contrastive_loss: 950577.0597; val_gene_expr_recon_loss: 1907141.9851; val_masked_gp_l1_reg_loss: 53204.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17110.5469; val_global_loss: 3662958.4283; val_optim_loss: 3662958.4283
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9417; val_auprc_score: 0.9875; val_best_acc_score: 0.9416; val_best_f1_score: 0.9670; train_kl_reg_loss: 24426.7920; train_edge_recon_loss: 688185.7930; train_cat_covariates_contrastive_loss: 949319.8352; train_gene_expr_recon_loss: 1905233.0827; train_masked_gp_l1_reg_loss: 53143.4853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17176.6244; train_global_loss: 3637485.6128; train_optim_loss: 3637485.6128; val_kl_reg_loss: 24531.5954; val_edge_recon_loss: 712169.5679; val_cat_covariates_contrastive_loss: 949184.1471; val_gene_expr_recon_loss: 1907673.3173; val_masked_gp_l1_reg_loss: 53195.7617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17329.9766; val_global_loss: 3664084.3750; val_optim_loss: 3664084.3750
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9432; val_auprc_score: 0.9879; val_best_acc_score: 0.9412; val_best_f1_score: 0.9666; train_kl_reg_loss: 24570.1868; train_edge_recon_loss: 687572.7293; train_cat_covariates_contrastive_loss: 949275.2223; train_gene_expr_recon_loss: 1904450.0077; train_masked_gp_l1_reg_loss: 53271.6804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17219.4303; train_global_loss: 3636359.2597; train_optim_loss: 3636359.2597; val_kl_reg_loss: 23953.0845; val_edge_recon_loss: 718537.9266; val_cat_covariates_contrastive_loss: 951616.4709; val_gene_expr_recon_loss: 1906604.1285; val_masked_gp_l1_reg_loss: 53304.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17395.9004; val_global_loss: 3671412.3610; val_optim_loss: 3671412.3610
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9443; val_auprc_score: 0.9881; val_best_acc_score: 0.9428; val_best_f1_score: 0.9676; train_kl_reg_loss: 24576.6618; train_edge_recon_loss: 688607.6679; train_cat_covariates_contrastive_loss: 949424.9913; train_gene_expr_recon_loss: 1904526.7189; train_masked_gp_l1_reg_loss: 53356.2015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17222.3627; train_global_loss: 3637714.6061; train_optim_loss: 3637714.6061; val_kl_reg_loss: 24286.9920; val_edge_recon_loss: 714327.0290; val_cat_covariates_contrastive_loss: 949694.5920; val_gene_expr_recon_loss: 1905655.3387; val_masked_gp_l1_reg_loss: 53461.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17311.9746; val_global_loss: 3664737.2054; val_optim_loss: 3664737.2054
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9425; val_auprc_score: 0.9875; val_best_acc_score: 0.9425; val_best_f1_score: 0.9674; train_kl_reg_loss: 24708.4052; train_edge_recon_loss: 691403.5799; train_cat_covariates_contrastive_loss: 949295.2400; train_gene_expr_recon_loss: 1903790.2620; train_masked_gp_l1_reg_loss: 53419.2650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17250.1682; train_global_loss: 3639866.9214; train_optim_loss: 3639866.9214; val_kl_reg_loss: 24911.6738; val_edge_recon_loss: 714445.2426; val_cat_covariates_contrastive_loss: 949490.9679; val_gene_expr_recon_loss: 1905082.6809; val_masked_gp_l1_reg_loss: 53393.5820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17156.4141; val_global_loss: 3664480.5542; val_optim_loss: 3664480.5542

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9449; val_auprc_score: 0.9882; val_best_acc_score: 0.9433; val_best_f1_score: 0.9680; train_kl_reg_loss: 25027.2094; train_edge_recon_loss: 687319.1085; train_cat_covariates_contrastive_loss: 949175.3205; train_gene_expr_recon_loss: 1901244.7426; train_masked_gp_l1_reg_loss: 41853.9203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9172.7143; train_global_loss: 3613793.0126; train_optim_loss: 3613793.0126; val_kl_reg_loss: 25040.8784; val_edge_recon_loss: 708175.6962; val_cat_covariates_contrastive_loss: 949110.8267; val_gene_expr_recon_loss: 1902840.8282; val_masked_gp_l1_reg_loss: 41926.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9081.8662; val_global_loss: 3636176.7281; val_optim_loss: 3636176.7281
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9447; val_auprc_score: 0.9878; val_best_acc_score: 0.9430; val_best_f1_score: 0.9678; train_kl_reg_loss: 25071.6911; train_edge_recon_loss: 686651.0478; train_cat_covariates_contrastive_loss: 949036.6356; train_gene_expr_recon_loss: 1900383.4548; train_masked_gp_l1_reg_loss: 41939.8280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9050.2985; train_global_loss: 3612132.9594; train_optim_loss: 3612132.9594; val_kl_reg_loss: 25071.6117; val_edge_recon_loss: 716233.9318; val_cat_covariates_contrastive_loss: 948514.3092; val_gene_expr_recon_loss: 1901512.4017; val_masked_gp_l1_reg_loss: 41938.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9014.3584; val_global_loss: 3642285.4336; val_optim_loss: 3642285.4336
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9452; val_auprc_score: 0.9883; val_best_acc_score: 0.9441; val_best_f1_score: 0.9684; train_kl_reg_loss: 25072.4271; train_edge_recon_loss: 687030.5637; train_cat_covariates_contrastive_loss: 949036.1094; train_gene_expr_recon_loss: 1900821.1455; train_masked_gp_l1_reg_loss: 42021.6082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9044.8655; train_global_loss: 3613026.7124; train_optim_loss: 3613026.7124; val_kl_reg_loss: 25099.4810; val_edge_recon_loss: 704996.8118; val_cat_covariates_contrastive_loss: 949107.7522; val_gene_expr_recon_loss: 1901414.5913; val_masked_gp_l1_reg_loss: 42038.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9058.0723; val_global_loss: 3631714.8855; val_optim_loss: 3631714.8855
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9439; val_auprc_score: 0.9879; val_best_acc_score: 0.9439; val_best_f1_score: 0.9683; train_kl_reg_loss: 25081.1545; train_edge_recon_loss: 685492.7324; train_cat_covariates_contrastive_loss: 949115.8162; train_gene_expr_recon_loss: 1900112.0328; train_masked_gp_l1_reg_loss: 42141.9024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9042.5342; train_global_loss: 3610986.1715; train_optim_loss: 3610986.1715; val_kl_reg_loss: 25161.4046; val_edge_recon_loss: 702046.6507; val_cat_covariates_contrastive_loss: 948653.2115; val_gene_expr_recon_loss: 1903506.6648; val_masked_gp_l1_reg_loss: 42148.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9023.3643; val_global_loss: 3630539.6906; val_optim_loss: 3630539.6906
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9448; val_auprc_score: 0.9879; val_best_acc_score: 0.9434; val_best_f1_score: 0.9680; train_kl_reg_loss: 24941.1585; train_edge_recon_loss: 684622.3420; train_cat_covariates_contrastive_loss: 948917.8806; train_gene_expr_recon_loss: 1900104.4105; train_masked_gp_l1_reg_loss: 42204.3342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9046.2709; train_global_loss: 3609836.3986; train_optim_loss: 3609836.3986; val_kl_reg_loss: 24935.3192; val_edge_recon_loss: 713451.0252; val_cat_covariates_contrastive_loss: 948828.7432; val_gene_expr_recon_loss: 1901514.0280; val_masked_gp_l1_reg_loss: 42197.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9033.5674; val_global_loss: 3639959.8636; val_optim_loss: 3639959.8636
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9459; val_auprc_score: 0.9885; val_best_acc_score: 0.9435; val_best_f1_score: 0.9680; train_kl_reg_loss: 24945.3633; train_edge_recon_loss: 685106.8783; train_cat_covariates_contrastive_loss: 949121.6300; train_gene_expr_recon_loss: 1899315.9751; train_masked_gp_l1_reg_loss: 42254.7112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9054.2976; train_global_loss: 3609798.8541; train_optim_loss: 3609798.8541; val_kl_reg_loss: 25240.2090; val_edge_recon_loss: 707447.8582; val_cat_covariates_contrastive_loss: 949326.9224; val_gene_expr_recon_loss: 1901564.0905; val_masked_gp_l1_reg_loss: 42283.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9074.9424; val_global_loss: 3634937.5874; val_optim_loss: 3634937.5874
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9453; val_auprc_score: 0.9881; val_best_acc_score: 0.9439; val_best_f1_score: 0.9682; train_kl_reg_loss: 24941.8892; train_edge_recon_loss: 685268.9309; train_cat_covariates_contrastive_loss: 948995.0325; train_gene_expr_recon_loss: 1899154.2180; train_masked_gp_l1_reg_loss: 42310.5558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9052.7849; train_global_loss: 3609723.4117; train_optim_loss: 3609723.4117; val_kl_reg_loss: 25040.2003; val_edge_recon_loss: 712153.5900; val_cat_covariates_contrastive_loss: 949900.7694; val_gene_expr_recon_loss: 1901978.6184; val_masked_gp_l1_reg_loss: 42379.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9062.0986; val_global_loss: 3640514.9344; val_optim_loss: 3640514.9344
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9471; val_auprc_score: 0.9885; val_best_acc_score: 0.9443; val_best_f1_score: 0.9685; train_kl_reg_loss: 24927.2840; train_edge_recon_loss: 683469.4517; train_cat_covariates_contrastive_loss: 949158.6058; train_gene_expr_recon_loss: 1899365.8728; train_masked_gp_l1_reg_loss: 42376.3830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9066.9820; train_global_loss: 3608364.5777; train_optim_loss: 3608364.5777; val_kl_reg_loss: 24957.1758; val_edge_recon_loss: 711406.5226; val_cat_covariates_contrastive_loss: 949537.2059; val_gene_expr_recon_loss: 1900416.5621; val_masked_gp_l1_reg_loss: 42399.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9084.9082; val_global_loss: 3637802.4633; val_optim_loss: 3637802.4633

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9444; val_auprc_score: 0.9880; val_best_acc_score: 0.9434; val_best_f1_score: 0.9679; train_kl_reg_loss: 24939.4246; train_edge_recon_loss: 686272.3239; train_cat_covariates_contrastive_loss: 949126.2869; train_gene_expr_recon_loss: 1898436.7851; train_masked_gp_l1_reg_loss: 41086.4671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8124.1547; train_global_loss: 3607985.4415; train_optim_loss: 3607985.4415; val_kl_reg_loss: 25062.4746; val_edge_recon_loss: 707620.9269; val_cat_covariates_contrastive_loss: 948680.1820; val_gene_expr_recon_loss: 1901760.5131; val_masked_gp_l1_reg_loss: 41084.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8115.4136; val_global_loss: 3632324.3514; val_optim_loss: 3632324.3514
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9442; val_auprc_score: 0.9876; val_best_acc_score: 0.9430; val_best_f1_score: 0.9677; train_kl_reg_loss: 24939.8854; train_edge_recon_loss: 686656.2305; train_cat_covariates_contrastive_loss: 949031.8724; train_gene_expr_recon_loss: 1898846.5232; train_masked_gp_l1_reg_loss: 41090.6475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8117.0924; train_global_loss: 3608682.2512; train_optim_loss: 3608682.2512; val_kl_reg_loss: 25036.0689; val_edge_recon_loss: 717042.2710; val_cat_covariates_contrastive_loss: 948446.1877; val_gene_expr_recon_loss: 1900357.5441; val_masked_gp_l1_reg_loss: 41097.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8112.1567; val_global_loss: 3640091.8199; val_optim_loss: 3640091.8199
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9449; val_auprc_score: 0.9877; val_best_acc_score: 0.9435; val_best_f1_score: 0.9680; train_kl_reg_loss: 24926.7830; train_edge_recon_loss: 684708.6849; train_cat_covariates_contrastive_loss: 949039.4560; train_gene_expr_recon_loss: 1898447.6688; train_masked_gp_l1_reg_loss: 41106.1860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8114.8156; train_global_loss: 3606343.5937; train_optim_loss: 3606343.5937; val_kl_reg_loss: 24933.6917; val_edge_recon_loss: 715167.3005; val_cat_covariates_contrastive_loss: 948636.1488; val_gene_expr_recon_loss: 1900643.8357; val_masked_gp_l1_reg_loss: 41113.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8118.9614; val_global_loss: 3638613.4738; val_optim_loss: 3638613.4738
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9467; val_auprc_score: 0.9886; val_best_acc_score: 0.9435; val_best_f1_score: 0.9680; train_kl_reg_loss: 24909.2526; train_edge_recon_loss: 684898.9253; train_cat_covariates_contrastive_loss: 949003.4856; train_gene_expr_recon_loss: 1899072.9079; train_masked_gp_l1_reg_loss: 41122.2845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8112.1650; train_global_loss: 3607119.0212; train_optim_loss: 3607119.0212; val_kl_reg_loss: 25037.8398; val_edge_recon_loss: 708084.3071; val_cat_covariates_contrastive_loss: 949647.8783; val_gene_expr_recon_loss: 1900841.3287; val_masked_gp_l1_reg_loss: 41111.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8104.9185; val_global_loss: 3632828.1040; val_optim_loss: 3632828.1040

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1040 min 3 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9292
val AUPRC score: 0.9812
val best accuracy score: 0.9413
val best F1 score: 0.9667
val target rna MSE score: 0.3558
val source rna MSE score: 0.1252
Val cat covariate0 mean sim diff: -0.0001
Val cat covariate1 mean sim diff: -0.0428
Val cat covariate2 mean sim diff: 0.0001

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
