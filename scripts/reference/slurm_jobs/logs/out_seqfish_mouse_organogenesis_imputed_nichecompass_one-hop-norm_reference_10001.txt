[True]
Run timestamp: 27072023_105126_10001.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_10001']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9079; val_auprc_score: 0.9809; val_best_acc_score: 0.8550; val_best_f1_score: 0.9219; train_kl_reg_loss: 352980609.9494; train_edge_recon_loss: 113544.6183; train_gene_expr_recon_loss: 21486194.7037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374580366.3704; train_optim_loss: 374580366.3704; val_kl_reg_loss: 795960.5833; val_edge_recon_loss: 117852.4245; val_gene_expr_recon_loss: 7029250.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7943063.3333; val_optim_loss: 7943063.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9011; val_auprc_score: 0.9792; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 792297.7731; train_edge_recon_loss: 119004.6285; train_gene_expr_recon_loss: 5233333.6852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6144636.1296; train_optim_loss: 6144636.1296; val_kl_reg_loss: 651680.1875; val_edge_recon_loss: 119649.7604; val_gene_expr_recon_loss: 4176309.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4947639.6667; val_optim_loss: 4947639.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8996; val_auprc_score: 0.9797; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 598297.1620; train_edge_recon_loss: 117705.4274; train_gene_expr_recon_loss: 3759393.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4475396.4537; train_optim_loss: 4475396.4537; val_kl_reg_loss: 515814.5938; val_edge_recon_loss: 118239.4349; val_gene_expr_recon_loss: 3355312.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3989366.8333; val_optim_loss: 3989366.8333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8973; val_auprc_score: 0.9796; val_best_acc_score: 0.8570; val_best_f1_score: 0.9230; train_kl_reg_loss: 507869.1944; train_edge_recon_loss: 119643.6155; train_gene_expr_recon_loss: 3245324.1759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3872836.9907; train_optim_loss: 3872836.9907; val_kl_reg_loss: 494337.1771; val_edge_recon_loss: 116287.8620; val_gene_expr_recon_loss: 3126517.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3737142.9167; val_optim_loss: 3737142.9167
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8994; val_auprc_score: 0.9802; val_best_acc_score: 0.8538; val_best_f1_score: 0.9211; train_kl_reg_loss: 510956.9410; train_edge_recon_loss: 118834.6447; train_gene_expr_recon_loss: 2738112.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3367903.6296; train_optim_loss: 3367903.6296; val_kl_reg_loss: 477341.6042; val_edge_recon_loss: 118915.5938; val_gene_expr_recon_loss: 2474845.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3071102.6667; val_optim_loss: 3071102.6667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9027; val_auprc_score: 0.9807; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 478025.2650; train_edge_recon_loss: 119421.2659; train_gene_expr_recon_loss: 2412575.1574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3010021.6759; train_optim_loss: 3010021.6759; val_kl_reg_loss: 453411.2500; val_edge_recon_loss: 119393.6849; val_gene_expr_recon_loss: 2347028.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2919833.5000; val_optim_loss: 2919833.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8960; val_auprc_score: 0.9785; val_best_acc_score: 0.8511; val_best_f1_score: 0.9196; train_kl_reg_loss: 458094.7743; train_edge_recon_loss: 119904.7899; train_gene_expr_recon_loss: 2305455.4815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2883455.0370; train_optim_loss: 2883455.0370; val_kl_reg_loss: 422255.1458; val_edge_recon_loss: 121066.4141; val_gene_expr_recon_loss: 2276995.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2820317.3333; val_optim_loss: 2820317.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8997; val_auprc_score: 0.9806; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 425765.6007; train_edge_recon_loss: 119792.3108; train_gene_expr_recon_loss: 2245830.9352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2791388.8056; train_optim_loss: 2791388.8056; val_kl_reg_loss: 393055.6667; val_edge_recon_loss: 118959.2161; val_gene_expr_recon_loss: 2218494.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2730509.5000; val_optim_loss: 2730509.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8952; val_auprc_score: 0.9790; val_best_acc_score: 0.8535; val_best_f1_score: 0.9210; train_kl_reg_loss: 397620.1829; train_edge_recon_loss: 118009.2546; train_gene_expr_recon_loss: 2196435.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2712064.4722; train_optim_loss: 2712064.4722; val_kl_reg_loss: 374034.2708; val_edge_recon_loss: 119062.4714; val_gene_expr_recon_loss: 2170481.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2663578.6667; val_optim_loss: 2663578.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8931; val_auprc_score: 0.9785; val_best_acc_score: 0.8505; val_best_f1_score: 0.9192; train_kl_reg_loss: 379679.3519; train_edge_recon_loss: 119787.7844; train_gene_expr_recon_loss: 2138424.5741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2637891.6852; train_optim_loss: 2637891.6852; val_kl_reg_loss: 355713.3750; val_edge_recon_loss: 121579.7109; val_gene_expr_recon_loss: 2102685.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2579978.6667; val_optim_loss: 2579978.6667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8959; val_auprc_score: 0.9792; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 360838.4525; train_edge_recon_loss: 119400.0041; train_gene_expr_recon_loss: 2085102.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2565341.2593; train_optim_loss: 2565341.2593; val_kl_reg_loss: 340174.9896; val_edge_recon_loss: 121004.7734; val_gene_expr_recon_loss: 2063806.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2524985.7500; val_optim_loss: 2524985.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8937; val_auprc_score: 0.9786; val_best_acc_score: 0.8489; val_best_f1_score: 0.9183; train_kl_reg_loss: 520653.2836; train_edge_recon_loss: 118757.1438; train_gene_expr_recon_loss: 2062593.4398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2702003.8426; train_optim_loss: 2702003.8426; val_kl_reg_loss: 354100.8542; val_edge_recon_loss: 122841.2578; val_gene_expr_recon_loss: 2023739.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2500682.0833; val_optim_loss: 2500682.0833
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8910; val_auprc_score: 0.9778; val_best_acc_score: 0.8518; val_best_f1_score: 0.9199; train_kl_reg_loss: 364759.8738; train_edge_recon_loss: 119921.9210; train_gene_expr_recon_loss: 2000416.5741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2485098.3704; train_optim_loss: 2485098.3704; val_kl_reg_loss: 327698.5312; val_edge_recon_loss: 120550.5026; val_gene_expr_recon_loss: 1979733.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2427982.4167; val_optim_loss: 2427982.4167
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8874; val_auprc_score: 0.9771; val_best_acc_score: 0.8495; val_best_f1_score: 0.9186; train_kl_reg_loss: 345115.1516; train_edge_recon_loss: 119751.3848; train_gene_expr_recon_loss: 1975428.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2440295.4259; train_optim_loss: 2440295.4259; val_kl_reg_loss: 345058.0729; val_edge_recon_loss: 122346.3073; val_gene_expr_recon_loss: 1956424.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2423828.5000; val_optim_loss: 2423828.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8892; val_auprc_score: 0.9784; val_best_acc_score: 0.8550; val_best_f1_score: 0.9219; train_kl_reg_loss: 389757.1493; train_edge_recon_loss: 119248.4172; train_gene_expr_recon_loss: 1944004.9491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2453010.5093; train_optim_loss: 2453010.5093; val_kl_reg_loss: 348931.4271; val_edge_recon_loss: 117887.4427; val_gene_expr_recon_loss: 1915886.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2382705.5833; val_optim_loss: 2382705.5833
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8934; val_auprc_score: 0.9784; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 457681.6331; train_edge_recon_loss: 117647.4285; train_gene_expr_recon_loss: 1921348.2361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2496677.2870; train_optim_loss: 2496677.2870; val_kl_reg_loss: 318380.6875; val_edge_recon_loss: 120055.6224; val_gene_expr_recon_loss: 1882507.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2320943.4167; val_optim_loss: 2320943.4167
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8894; val_auprc_score: 0.9772; val_best_acc_score: 0.8500; val_best_f1_score: 0.9189; train_kl_reg_loss: 323611.3704; train_edge_recon_loss: 119475.5333; train_gene_expr_recon_loss: 1865758.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2308845.5093; train_optim_loss: 2308845.5093; val_kl_reg_loss: 301387.9167; val_edge_recon_loss: 121995.5938; val_gene_expr_recon_loss: 1847807.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2271191.4167; val_optim_loss: 2271191.4167
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8877; val_auprc_score: 0.9778; val_best_acc_score: 0.8552; val_best_f1_score: 0.9219; train_kl_reg_loss: 303332.5394; train_edge_recon_loss: 118498.6603; train_gene_expr_recon_loss: 1832924.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2254755.8889; train_optim_loss: 2254755.8889; val_kl_reg_loss: 281622.9062; val_edge_recon_loss: 117756.2734; val_gene_expr_recon_loss: 1821535.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2220914.2500; val_optim_loss: 2220914.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8878; val_auprc_score: 0.9771; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 291319.0833; train_edge_recon_loss: 118864.8351; train_gene_expr_recon_loss: 1809240.1065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2219424.0278; train_optim_loss: 2219424.0278; val_kl_reg_loss: 276823.6250; val_edge_recon_loss: 120521.3438; val_gene_expr_recon_loss: 1802032.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2199377.0833; val_optim_loss: 2199377.0833
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8871; val_auprc_score: 0.9774; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 285620.7361; train_edge_recon_loss: 120088.6655; train_gene_expr_recon_loss: 1790166.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2195875.7685; train_optim_loss: 2195875.7685; val_kl_reg_loss: 272010.0625; val_edge_recon_loss: 120350.7917; val_gene_expr_recon_loss: 1784628.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2176989.6667; val_optim_loss: 2176989.6667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8887; val_auprc_score: 0.9785; val_best_acc_score: 0.8574; val_best_f1_score: 0.9230; train_kl_reg_loss: 278020.8032; train_edge_recon_loss: 118859.3877; train_gene_expr_recon_loss: 1775096.4769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2171976.6574; train_optim_loss: 2171976.6574; val_kl_reg_loss: 260101.2448; val_edge_recon_loss: 118188.4922; val_gene_expr_recon_loss: 1767808.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2146098.0833; val_optim_loss: 2146098.0833
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8777; val_auprc_score: 0.9755; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 351487.4375; train_edge_recon_loss: 118077.6432; train_gene_expr_recon_loss: 1771748.9861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2241314.0648; train_optim_loss: 2241314.0648; val_kl_reg_loss: 306025.8958; val_edge_recon_loss: 118996.2240; val_gene_expr_recon_loss: 1747853.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2172875.9167; val_optim_loss: 2172875.9167
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8791; val_auprc_score: 0.9750; val_best_acc_score: 0.8474; val_best_f1_score: 0.9174; train_kl_reg_loss: 311535.3750; train_edge_recon_loss: 119318.7749; train_gene_expr_recon_loss: 1733476.7685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2164330.8981; train_optim_loss: 2164330.8981; val_kl_reg_loss: 271679.0729; val_edge_recon_loss: 124170.4688; val_gene_expr_recon_loss: 1718393.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2114242.7500; val_optim_loss: 2114242.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8768; val_auprc_score: 0.9755; val_best_acc_score: 0.8519; val_best_f1_score: 0.9199; train_kl_reg_loss: 271984.3137; train_edge_recon_loss: 118920.5385; train_gene_expr_recon_loss: 1707551.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2098456.7176; train_optim_loss: 2098456.7176; val_kl_reg_loss: 252887.2708; val_edge_recon_loss: 121578.6380; val_gene_expr_recon_loss: 1700225.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2074690.8750; val_optim_loss: 2074690.8750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8739; val_auprc_score: 0.9757; val_best_acc_score: 0.8581; val_best_f1_score: 0.9234; train_kl_reg_loss: 268644.3715; train_edge_recon_loss: 117014.0498; train_gene_expr_recon_loss: 1694376.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2080034.6343; train_optim_loss: 2080034.6343; val_kl_reg_loss: 243969.9323; val_edge_recon_loss: 117769.6094; val_gene_expr_recon_loss: 1683222.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2044961.5417; val_optim_loss: 2044961.5417
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8792; val_auprc_score: 0.9768; val_best_acc_score: 0.8543; val_best_f1_score: 0.9214; train_kl_reg_loss: 6900152.9520; train_edge_recon_loss: 118771.5344; train_gene_expr_recon_loss: 1917157.7407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8936082.1759; train_optim_loss: 8936082.1759; val_kl_reg_loss: 155725322.6667; val_edge_recon_loss: 118453.5443; val_gene_expr_recon_loss: 1655859.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 157499637.3333; val_optim_loss: 157499637.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8839; val_auprc_score: 0.9770; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 8740261.4340; train_edge_recon_loss: 118105.5914; train_gene_expr_recon_loss: 1723742.5787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10582109.7222; train_optim_loss: 10582109.7222; val_kl_reg_loss: 302174.8542; val_edge_recon_loss: 120353.6068; val_gene_expr_recon_loss: 1620337.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2042865.8333; val_optim_loss: 2042865.8333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8711; val_auprc_score: 0.9753; val_best_acc_score: 0.8550; val_best_f1_score: 0.9219; train_kl_reg_loss: 87444194.0185; train_edge_recon_loss: 117022.4809; train_gene_expr_recon_loss: 1759922.4537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89321136.5324; train_optim_loss: 89321136.5324; val_kl_reg_loss: 392067.8854; val_edge_recon_loss: 117884.3828; val_gene_expr_recon_loss: 1595401.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2105353.9167; val_optim_loss: 2105353.9167
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8674; val_auprc_score: 0.9736; val_best_acc_score: 0.8498; val_best_f1_score: 0.9188; train_kl_reg_loss: 30424669.7384; train_edge_recon_loss: 117361.6392; train_gene_expr_recon_loss: 1765633.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32307664.9537; train_optim_loss: 32307664.9537; val_kl_reg_loss: 670850.1250; val_edge_recon_loss: 122134.2526; val_gene_expr_recon_loss: 1640770.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2433755.2500; val_optim_loss: 2433755.2500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8896; val_auprc_score: 0.9762; val_best_acc_score: 0.8538; val_best_f1_score: 0.9211; train_kl_reg_loss: 11881700.4421; train_edge_recon_loss: 118186.1910; train_gene_expr_recon_loss: 1715051.3009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13714938.0926; train_optim_loss: 13714938.0926; val_kl_reg_loss: 1097865.5000; val_edge_recon_loss: 118917.3125; val_gene_expr_recon_loss: 1709182.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2925965.1667; val_optim_loss: 2925965.1667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8866; val_auprc_score: 0.9757; val_best_acc_score: 0.8518; val_best_f1_score: 0.9199; train_kl_reg_loss: 1487251.6296; train_edge_recon_loss: 118800.0830; train_gene_expr_recon_loss: 1734856.3657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3340908.0093; train_optim_loss: 3340908.0093; val_kl_reg_loss: 1036717.6875; val_edge_recon_loss: 120552.4297; val_gene_expr_recon_loss: 1711103.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2868373.5833; val_optim_loss: 2868373.5833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8877; val_auprc_score: 0.9763; val_best_acc_score: 0.8580; val_best_f1_score: 0.9236; train_kl_reg_loss: 1067389.2593; train_edge_recon_loss: 119690.6753; train_gene_expr_recon_loss: 1708675.8981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2895755.8519; train_optim_loss: 2895755.8519; val_kl_reg_loss: 1023390.5833; val_edge_recon_loss: 115443.5573; val_gene_expr_recon_loss: 1704948.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2843783.0833; val_optim_loss: 2843783.0833
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8840; val_auprc_score: 0.9746; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 1055555.5046; train_edge_recon_loss: 120157.6293; train_gene_expr_recon_loss: 1702657.7824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2878370.8889; train_optim_loss: 2878370.8889; val_kl_reg_loss: 1014797.1458; val_edge_recon_loss: 119409.5208; val_gene_expr_recon_loss: 1702690.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2836897.3333; val_optim_loss: 2836897.3333
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8916; val_auprc_score: 0.9765; val_best_acc_score: 0.8482; val_best_f1_score: 0.9179; train_kl_reg_loss: 1047966.2755; train_edge_recon_loss: 119789.9398; train_gene_expr_recon_loss: 1697934.6019; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2865690.8241; train_optim_loss: 2865690.8241; val_kl_reg_loss: 1007987.2292; val_edge_recon_loss: 123444.9141; val_gene_expr_recon_loss: 1697185.4583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2828617.5833; val_optim_loss: 2828617.5833
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8893; val_auprc_score: 0.9768; val_best_acc_score: 0.8540; val_best_f1_score: 0.9212; train_kl_reg_loss: 1041236.9838; train_edge_recon_loss: 120050.8927; train_gene_expr_recon_loss: 1696535.0185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2857822.8519; train_optim_loss: 2857822.8519; val_kl_reg_loss: 1001552.6042; val_edge_recon_loss: 118743.4271; val_gene_expr_recon_loss: 1695605.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2815901.8333; val_optim_loss: 2815901.8333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 10 min 1 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.8809
Val AUPRC score: 0.9769
Val best accuracy score: 0.8527
Val best F1 score: 0.9205
Val gene expr MSE score: 4482.1884
Val cat covariate0 mean sim diff: -0.0000

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
