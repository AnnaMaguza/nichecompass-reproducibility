[True]
Run timestamp: 07082023_221951_160.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_160']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9542; val_auprc_score: 0.9572; val_best_acc_score: 0.6523; val_best_f1_score: 0.7408; train_kl_reg_loss: 7917.7013; train_edge_recon_loss: 3469784.7778; train_gene_expr_recon_loss: 628962.6875; train_masked_gp_l1_reg_loss: 15925.4531; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 266848.6562; train_global_loss: 4389439.2778; train_optim_loss: 4389439.2778; val_kl_reg_loss: 4103.3091; val_edge_recon_loss: 4058017.2500; val_gene_expr_recon_loss: 622222.6250; val_masked_gp_l1_reg_loss: 10663.8389; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 262514.5938; val_global_loss: 4957521.5000; val_optim_loss: 4957521.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9441; val_auprc_score: 0.9406; val_best_acc_score: 0.8672; val_best_f1_score: 0.8649; train_kl_reg_loss: 3649.2353; train_edge_recon_loss: 3467719.1389; train_gene_expr_recon_loss: 608999.1875; train_masked_gp_l1_reg_loss: 8382.1835; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 264830.8576; train_global_loss: 4353580.5556; train_optim_loss: 4353580.5556; val_kl_reg_loss: 1526.5276; val_edge_recon_loss: 4023687.5000; val_gene_expr_recon_loss: 605496.6250; val_masked_gp_l1_reg_loss: 6575.8896; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 260964.4219; val_global_loss: 4898251.0000; val_optim_loss: 4898251.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9227; val_auprc_score: 0.9080; val_best_acc_score: 0.8496; val_best_f1_score: 0.8591; train_kl_reg_loss: 1974.0821; train_edge_recon_loss: 3453785.8889; train_gene_expr_recon_loss: 588919.6736; train_masked_gp_l1_reg_loss: 6520.1725; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 262775.4653; train_global_loss: 4313975.2778; train_optim_loss: 4313975.2778; val_kl_reg_loss: 1896.0413; val_edge_recon_loss: 3602749.0000; val_gene_expr_recon_loss: 580870.3750; val_masked_gp_l1_reg_loss: 6464.7388; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 258901.3438; val_global_loss: 4450881.5000; val_optim_loss: 4450881.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8809; val_auprc_score: 0.8668; val_best_acc_score: 0.7909; val_best_f1_score: 0.8024; train_kl_reg_loss: 4673.1618; train_edge_recon_loss: 3185427.4722; train_gene_expr_recon_loss: 576124.8333; train_masked_gp_l1_reg_loss: 6247.5720; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 261318.9358; train_global_loss: 4033791.9722; train_optim_loss: 4033791.9722; val_kl_reg_loss: 15227.9111; val_edge_recon_loss: 2872308.2500; val_gene_expr_recon_loss: 578851.0625; val_masked_gp_l1_reg_loss: 6069.7969; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 257825.0469; val_global_loss: 3730282.0000; val_optim_loss: 3730282.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9032; val_auprc_score: 0.8845; val_best_acc_score: 0.8240; val_best_f1_score: 0.8350; train_kl_reg_loss: 31405.9684; train_edge_recon_loss: 2825926.8889; train_gene_expr_recon_loss: 573998.3819; train_masked_gp_l1_reg_loss: 6005.4017; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 259898.9323; train_global_loss: 3697235.5556; train_optim_loss: 3697235.5556; val_kl_reg_loss: 43104.3789; val_edge_recon_loss: 2802395.5000; val_gene_expr_recon_loss: 564648.9375; val_masked_gp_l1_reg_loss: 5967.8662; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 256316.2188; val_global_loss: 3672433.0000; val_optim_loss: 3672433.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9265; val_auprc_score: 0.9045; val_best_acc_score: 0.8654; val_best_f1_score: 0.8733; train_kl_reg_loss: 39758.4097; train_edge_recon_loss: 2755262.8056; train_gene_expr_recon_loss: 551495.9167; train_masked_gp_l1_reg_loss: 5934.5822; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 258473.9792; train_global_loss: 3610925.7500; train_optim_loss: 3610925.7500; val_kl_reg_loss: 32782.0430; val_edge_recon_loss: 2704794.5000; val_gene_expr_recon_loss: 553739.1250; val_masked_gp_l1_reg_loss: 5887.7695; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 255218.0938; val_global_loss: 3552421.2500; val_optim_loss: 3552421.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9272; val_auprc_score: 0.9041; val_best_acc_score: 0.8720; val_best_f1_score: 0.8774; train_kl_reg_loss: 33679.6775; train_edge_recon_loss: 2728600.3056; train_gene_expr_recon_loss: 546805.4583; train_masked_gp_l1_reg_loss: 5881.3959; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 257454.8681; train_global_loss: 3572421.8056; train_optim_loss: 3572421.8056; val_kl_reg_loss: 35276.2109; val_edge_recon_loss: 2727196.2500; val_gene_expr_recon_loss: 542707.4375; val_masked_gp_l1_reg_loss: 5893.1343; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253826.5938; val_global_loss: 3564899.7500; val_optim_loss: 3564899.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9269; val_auprc_score: 0.9019; val_best_acc_score: 0.8654; val_best_f1_score: 0.8723; train_kl_reg_loss: 35868.0451; train_edge_recon_loss: 2712179.3056; train_gene_expr_recon_loss: 534091.4583; train_masked_gp_l1_reg_loss: 5920.1248; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256489.3941; train_global_loss: 3544548.3611; train_optim_loss: 3544548.3611; val_kl_reg_loss: 34840.4062; val_edge_recon_loss: 2729163.7500; val_gene_expr_recon_loss: 533105.0000; val_masked_gp_l1_reg_loss: 5938.6846; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252528.0938; val_global_loss: 3555576.0000; val_optim_loss: 3555576.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9310; val_auprc_score: 0.9057; val_best_acc_score: 0.8738; val_best_f1_score: 0.8801; train_kl_reg_loss: 33294.7387; train_edge_recon_loss: 2717669.6944; train_gene_expr_recon_loss: 525110.5729; train_masked_gp_l1_reg_loss: 5985.4465; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 254496.5139; train_global_loss: 3536557.0278; train_optim_loss: 3536557.0278; val_kl_reg_loss: 31782.2500; val_edge_recon_loss: 2722970.0000; val_gene_expr_recon_loss: 523218.4375; val_masked_gp_l1_reg_loss: 6045.5156; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251623.3594; val_global_loss: 3535639.5000; val_optim_loss: 3535639.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9370; val_auprc_score: 0.9114; val_best_acc_score: 0.8786; val_best_f1_score: 0.8847; train_kl_reg_loss: 32105.3793; train_edge_recon_loss: 2716230.6389; train_gene_expr_recon_loss: 518515.3889; train_masked_gp_l1_reg_loss: 6096.9680; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 253758.7066; train_global_loss: 3526707.1944; train_optim_loss: 3526707.1944; val_kl_reg_loss: 32252.2480; val_edge_recon_loss: 2736399.2500; val_gene_expr_recon_loss: 516526.3438; val_masked_gp_l1_reg_loss: 6165.5146; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250883.0312; val_global_loss: 3542226.2500; val_optim_loss: 3542226.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9352; val_auprc_score: 0.9146; val_best_acc_score: 0.8736; val_best_f1_score: 0.8798; train_kl_reg_loss: 31343.2077; train_edge_recon_loss: 2717519.2500; train_gene_expr_recon_loss: 510496.8889; train_masked_gp_l1_reg_loss: 6250.3946; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252606.6840; train_global_loss: 3518216.5000; train_optim_loss: 3518216.5000; val_kl_reg_loss: 29918.5000; val_edge_recon_loss: 2729106.0000; val_gene_expr_recon_loss: 517081.7812; val_masked_gp_l1_reg_loss: 6314.7549; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250102.0781; val_global_loss: 3532523.0000; val_optim_loss: 3532523.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9474; val_auprc_score: 0.9277; val_best_acc_score: 0.8891; val_best_f1_score: 0.8951; train_kl_reg_loss: 30107.7899; train_edge_recon_loss: 2715776.1111; train_gene_expr_recon_loss: 506529.9757; train_masked_gp_l1_reg_loss: 6363.7880; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252053.6719; train_global_loss: 3510831.2778; train_optim_loss: 3510831.2778; val_kl_reg_loss: 30206.4941; val_edge_recon_loss: 2709709.5000; val_gene_expr_recon_loss: 507796.4062; val_masked_gp_l1_reg_loss: 6434.8999; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249430.4375; val_global_loss: 3503578.0000; val_optim_loss: 3503578.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9517; val_auprc_score: 0.9381; val_best_acc_score: 0.8930; val_best_f1_score: 0.8969; train_kl_reg_loss: 29953.2891; train_edge_recon_loss: 2698399.9722; train_gene_expr_recon_loss: 504488.1597; train_masked_gp_l1_reg_loss: 6491.3894; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252100.7049; train_global_loss: 3491433.5000; train_optim_loss: 3491433.5000; val_kl_reg_loss: 28127.8301; val_edge_recon_loss: 2706366.2500; val_gene_expr_recon_loss: 508890.4062; val_masked_gp_l1_reg_loss: 6572.1528; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248946.7344; val_global_loss: 3498903.5000; val_optim_loss: 3498903.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9541; val_auprc_score: 0.9348; val_best_acc_score: 0.8988; val_best_f1_score: 0.9038; train_kl_reg_loss: 28429.3468; train_edge_recon_loss: 2684330.9722; train_gene_expr_recon_loss: 502494.8056; train_masked_gp_l1_reg_loss: 6637.1462; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250502.4792; train_global_loss: 3472394.8056; train_optim_loss: 3472394.8056; val_kl_reg_loss: 28823.7266; val_edge_recon_loss: 2681142.5000; val_gene_expr_recon_loss: 504575.5312; val_masked_gp_l1_reg_loss: 6703.6133; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248328.6875; val_global_loss: 3469574.0000; val_optim_loss: 3469574.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9540; val_auprc_score: 0.9362; val_best_acc_score: 0.9050; val_best_f1_score: 0.9097; train_kl_reg_loss: 29388.4570; train_edge_recon_loss: 2683523.3611; train_gene_expr_recon_loss: 501439.7882; train_masked_gp_l1_reg_loss: 6764.7963; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251464.1927; train_global_loss: 3472580.4722; train_optim_loss: 3472580.4722; val_kl_reg_loss: 27902.3613; val_edge_recon_loss: 2693692.2500; val_gene_expr_recon_loss: 498752.3125; val_masked_gp_l1_reg_loss: 6843.7568; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247607.4219; val_global_loss: 3474798.0000; val_optim_loss: 3474798.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9591; val_auprc_score: 0.9419; val_best_acc_score: 0.9089; val_best_f1_score: 0.9131; train_kl_reg_loss: 29564.6918; train_edge_recon_loss: 2674540.6389; train_gene_expr_recon_loss: 493193.6250; train_masked_gp_l1_reg_loss: 6916.9529; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249354.1458; train_global_loss: 3453570.1111; train_optim_loss: 3453570.1111; val_kl_reg_loss: 30187.6680; val_edge_recon_loss: 2662271.2500; val_gene_expr_recon_loss: 501165.9375; val_masked_gp_l1_reg_loss: 6977.1445; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247280.9531; val_global_loss: 3447883.2500; val_optim_loss: 3447883.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9611; val_auprc_score: 0.9463; val_best_acc_score: 0.9112; val_best_f1_score: 0.9154; train_kl_reg_loss: 30304.0065; train_edge_recon_loss: 2668573.0000; train_gene_expr_recon_loss: 492660.7639; train_masked_gp_l1_reg_loss: 7005.2641; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249206.2691; train_global_loss: 3447749.3056; train_optim_loss: 3447749.3056; val_kl_reg_loss: 28161.2930; val_edge_recon_loss: 2659394.2500; val_gene_expr_recon_loss: 495601.2188; val_masked_gp_l1_reg_loss: 7051.5874; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246446.8438; val_global_loss: 3436655.0000; val_optim_loss: 3436655.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9661; val_auprc_score: 0.9533; val_best_acc_score: 0.9138; val_best_f1_score: 0.9180; train_kl_reg_loss: 29011.0983; train_edge_recon_loss: 2663066.2222; train_gene_expr_recon_loss: 490091.7153; train_masked_gp_l1_reg_loss: 7098.0127; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249204.4340; train_global_loss: 3438471.5278; train_optim_loss: 3438471.5278; val_kl_reg_loss: 28884.5234; val_edge_recon_loss: 2670464.5000; val_gene_expr_recon_loss: 492744.0938; val_masked_gp_l1_reg_loss: 7146.9536; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246138.7969; val_global_loss: 3445378.7500; val_optim_loss: 3445378.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9671; val_auprc_score: 0.9547; val_best_acc_score: 0.9200; val_best_f1_score: 0.9220; train_kl_reg_loss: 29850.3637; train_edge_recon_loss: 2652321.6389; train_gene_expr_recon_loss: 485076.7604; train_masked_gp_l1_reg_loss: 7195.0847; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248157.8229; train_global_loss: 3422601.6944; train_optim_loss: 3422601.6944; val_kl_reg_loss: 27782.6953; val_edge_recon_loss: 2667032.5000; val_gene_expr_recon_loss: 494402.8750; val_masked_gp_l1_reg_loss: 7239.9326; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246182.2812; val_global_loss: 3442640.2500; val_optim_loss: 3442640.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9676; val_auprc_score: 0.9558; val_best_acc_score: 0.9192; val_best_f1_score: 0.9225; train_kl_reg_loss: 28646.4377; train_edge_recon_loss: 2651506.5000; train_gene_expr_recon_loss: 484445.0174; train_masked_gp_l1_reg_loss: 7280.0674; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248142.3872; train_global_loss: 3420020.4167; train_optim_loss: 3420020.4167; val_kl_reg_loss: 28428.4805; val_edge_recon_loss: 2681117.2500; val_gene_expr_recon_loss: 488364.1875; val_masked_gp_l1_reg_loss: 7330.0044; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245269.6250; val_global_loss: 3450509.5000; val_optim_loss: 3450509.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9681; val_auprc_score: 0.9532; val_best_acc_score: 0.9198; val_best_f1_score: 0.9226; train_kl_reg_loss: 29428.7839; train_edge_recon_loss: 2656675.0556; train_gene_expr_recon_loss: 482522.2257; train_masked_gp_l1_reg_loss: 7375.7877; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247119.7326; train_global_loss: 3423121.6389; train_optim_loss: 3423121.6389; val_kl_reg_loss: 27768.5352; val_edge_recon_loss: 2660325.2500; val_gene_expr_recon_loss: 485446.7500; val_masked_gp_l1_reg_loss: 7415.1172; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244663.0156; val_global_loss: 3425618.5000; val_optim_loss: 3425618.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9705; val_auprc_score: 0.9558; val_best_acc_score: 0.9263; val_best_f1_score: 0.9281; train_kl_reg_loss: 28195.9672; train_edge_recon_loss: 2649504.5833; train_gene_expr_recon_loss: 479304.2639; train_masked_gp_l1_reg_loss: 7463.5824; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246627.3993; train_global_loss: 3411095.6944; train_optim_loss: 3411095.6944; val_kl_reg_loss: 27673.3164; val_edge_recon_loss: 2638324.5000; val_gene_expr_recon_loss: 483205.2500; val_masked_gp_l1_reg_loss: 7515.3867; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244109.8594; val_global_loss: 3400828.2500; val_optim_loss: 3400828.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9666; val_auprc_score: 0.9528; val_best_acc_score: 0.9165; val_best_f1_score: 0.9203; train_kl_reg_loss: 28358.5202; train_edge_recon_loss: 2636722.3611; train_gene_expr_recon_loss: 475473.7361; train_masked_gp_l1_reg_loss: 7549.6754; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246467.9705; train_global_loss: 3394572.2500; train_optim_loss: 3394572.2500; val_kl_reg_loss: 28026.6465; val_edge_recon_loss: 2660825.7500; val_gene_expr_recon_loss: 485000.3125; val_masked_gp_l1_reg_loss: 7587.1924; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244206.1250; val_global_loss: 3425646.0000; val_optim_loss: 3425646.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9710; val_auprc_score: 0.9578; val_best_acc_score: 0.9250; val_best_f1_score: 0.9269; train_kl_reg_loss: 27547.7348; train_edge_recon_loss: 2639457.9167; train_gene_expr_recon_loss: 474275.8090; train_masked_gp_l1_reg_loss: 7623.2423; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245116.8455; train_global_loss: 3394021.5556; train_optim_loss: 3394021.5556; val_kl_reg_loss: 26042.2070; val_edge_recon_loss: 2664686.2500; val_gene_expr_recon_loss: 482830.4688; val_masked_gp_l1_reg_loss: 7664.9785; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244091.9219; val_global_loss: 3425316.0000; val_optim_loss: 3425316.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9746; val_auprc_score: 0.9638; val_best_acc_score: 0.9317; val_best_f1_score: 0.9344; train_kl_reg_loss: 27423.7969; train_edge_recon_loss: 2641902.3889; train_gene_expr_recon_loss: 473149.5694; train_masked_gp_l1_reg_loss: 7703.9077; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244062.3628; train_global_loss: 3394242.0278; train_optim_loss: 3394242.0278; val_kl_reg_loss: 27076.0820; val_edge_recon_loss: 2656675.5000; val_gene_expr_recon_loss: 481134.1250; val_masked_gp_l1_reg_loss: 7754.2505; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243360.5938; val_global_loss: 3416000.2500; val_optim_loss: 3416000.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9750; val_auprc_score: 0.9671; val_best_acc_score: 0.9303; val_best_f1_score: 0.9323; train_kl_reg_loss: 27073.4076; train_edge_recon_loss: 2662216.4167; train_gene_expr_recon_loss: 508266.3854; train_masked_gp_l1_reg_loss: 7755.3540; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250086.8611; train_global_loss: 3455398.3611; train_optim_loss: 3455398.3611; val_kl_reg_loss: 10940.9121; val_edge_recon_loss: 2673399.2500; val_gene_expr_recon_loss: 502575.6875; val_masked_gp_l1_reg_loss: 7711.8237; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246309.4531; val_global_loss: 3440937.2500; val_optim_loss: 3440937.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9774; val_auprc_score: 0.9703; val_best_acc_score: 0.9330; val_best_f1_score: 0.9346; train_kl_reg_loss: 27236.5054; train_edge_recon_loss: 2656601.8056; train_gene_expr_recon_loss: 499567.0660; train_masked_gp_l1_reg_loss: 7622.8630; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249661.3889; train_global_loss: 3440689.6111; train_optim_loss: 3440689.6111; val_kl_reg_loss: 10277.6113; val_edge_recon_loss: 2645002.2500; val_gene_expr_recon_loss: 511489.4688; val_masked_gp_l1_reg_loss: 7530.2246; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247255.3438; val_global_loss: 3421554.7500; val_optim_loss: 3421554.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9736; val_auprc_score: 0.9595; val_best_acc_score: 0.9295; val_best_f1_score: 0.9316; train_kl_reg_loss: 25648.0601; train_edge_recon_loss: 2640095.1111; train_gene_expr_recon_loss: 502108.0903; train_masked_gp_l1_reg_loss: 7508.6085; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248511.8872; train_global_loss: 3423871.6944; train_optim_loss: 3423871.6944; val_kl_reg_loss: 9547.3066; val_edge_recon_loss: 2647378.7500; val_gene_expr_recon_loss: 511423.5000; val_masked_gp_l1_reg_loss: 7475.9678; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247179.0469; val_global_loss: 3423004.5000; val_optim_loss: 3423004.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9723; val_auprc_score: 0.9580; val_best_acc_score: 0.9266; val_best_f1_score: 0.9291; train_kl_reg_loss: 24965.8535; train_edge_recon_loss: 2631861.8333; train_gene_expr_recon_loss: 504664.3576; train_masked_gp_l1_reg_loss: 7457.5202; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249185.6024; train_global_loss: 3418135.0556; train_optim_loss: 3418135.0556; val_kl_reg_loss: 9429.0137; val_edge_recon_loss: 2656657.7500; val_gene_expr_recon_loss: 512066.8125; val_masked_gp_l1_reg_loss: 7437.4097; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247110.6875; val_global_loss: 3432701.7500; val_optim_loss: 3432701.7500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9727; val_auprc_score: 0.9582; val_best_acc_score: 0.9322; val_best_f1_score: 0.9345; train_kl_reg_loss: 24754.5523; train_edge_recon_loss: 2640317.1111; train_gene_expr_recon_loss: 501895.7535; train_masked_gp_l1_reg_loss: 7425.8617; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249367.3299; train_global_loss: 3423760.6111; train_optim_loss: 3423760.6111; val_kl_reg_loss: 9381.6855; val_edge_recon_loss: 2650073.5000; val_gene_expr_recon_loss: 509141.1875; val_masked_gp_l1_reg_loss: 7413.6548; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246890.2031; val_global_loss: 3422900.5000; val_optim_loss: 3422900.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 26 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9700
val AUPRC score: 0.9580
val best accuracy score: 0.9219
val best F1 score: 0.9232
val target rna MSE score: 0.5790
val source rna MSE score: 0.3729
val target atac MSE score: 0.1343
val source atac MSE score: 0.0217
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
