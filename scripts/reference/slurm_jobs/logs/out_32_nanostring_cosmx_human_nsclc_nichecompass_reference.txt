[True, False, True]
Run timestamp: 12102023_161937_32.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000000.0', '--lambda_gene_expr_recon', '300000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100.0', '--lambda_l1_addon', '100.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_32']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 631979
Number of validation nodes: 70220
Number of training edges: 1492281
Number of validation edges: 165809
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8812; val_auprc_score: 0.9798; val_best_acc_score: 0.9111; val_best_f1_score: 0.9514; train_kl_reg_loss: 47639.4242; train_edge_recon_loss: 63967641.5190; train_gene_expr_recon_loss: 260333822.5290; train_masked_gp_l1_reg_loss: 8984.0296; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 399791.5423; train_global_loss: 324757879.0532; train_optim_loss: 324757879.0532; val_kl_reg_loss: 51374.5976; val_edge_recon_loss: 65130068.6790; val_gene_expr_recon_loss: 228397047.0123; val_masked_gp_l1_reg_loss: 13027.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 420678.5000; val_global_loss: 294012186.2716; val_optim_loss: 294012186.2716
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8964; val_auprc_score: 0.9822; val_best_acc_score: 0.9185; val_best_f1_score: 0.9550; train_kl_reg_loss: 59998.8113; train_edge_recon_loss: 62137803.9890; train_gene_expr_recon_loss: 218736966.1530; train_masked_gp_l1_reg_loss: 14654.7947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 402836.7395; train_global_loss: 281352260.3417; train_optim_loss: 281352260.3417; val_kl_reg_loss: 70685.2574; val_edge_recon_loss: 65027537.3704; val_gene_expr_recon_loss: 213496542.4198; val_masked_gp_l1_reg_loss: 15325.8848; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 381655.0625; val_global_loss: 278991754.2716; val_optim_loss: 278991754.2716
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9007; val_auprc_score: 0.9834; val_best_acc_score: 0.9199; val_best_f1_score: 0.9559; train_kl_reg_loss: 81606.0929; train_edge_recon_loss: 61428691.6816; train_gene_expr_recon_loss: 210518367.9067; train_masked_gp_l1_reg_loss: 15139.7113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 364322.4344; train_global_loss: 272408128.2086; train_optim_loss: 272408128.2086; val_kl_reg_loss: 91100.1669; val_edge_recon_loss: 64350050.4198; val_gene_expr_recon_loss: 208853635.7531; val_masked_gp_l1_reg_loss: 14806.0986; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 348602.1562; val_global_loss: 273658204.9877; val_optim_loss: 273658204.9877
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9033; val_auprc_score: 0.9836; val_best_acc_score: 0.9223; val_best_f1_score: 0.9571; train_kl_reg_loss: 7361438632287.4287; train_edge_recon_loss: 61404998.1214; train_gene_expr_recon_loss: 208120881.3283; train_masked_gp_l1_reg_loss: 14520.5349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 334988.3769; train_global_loss: 7361708408925.9961; train_optim_loss: 7361708408925.9961; val_kl_reg_loss: 115894.6078; val_edge_recon_loss: 63699255.6296; val_gene_expr_recon_loss: 207705003.1605; val_masked_gp_l1_reg_loss: 13957.0127; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 318170.2188; val_global_loss: 271852281.5802; val_optim_loss: 271852281.5802
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9054; val_auprc_score: 0.9841; val_best_acc_score: 0.9225; val_best_f1_score: 0.9571; train_kl_reg_loss: 8261125.6745; train_edge_recon_loss: 61484981.3942; train_gene_expr_recon_loss: 206370565.2748; train_masked_gp_l1_reg_loss: 13728.6402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 312680.5108; train_global_loss: 276443082.5715; train_optim_loss: 276443082.5715; val_kl_reg_loss: 126181.0735; val_edge_recon_loss: 64342405.0370; val_gene_expr_recon_loss: 206193796.3951; val_masked_gp_l1_reg_loss: 13432.0605; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 308158.9375; val_global_loss: 270983982.2716; val_optim_loss: 270983982.2716
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9070; val_auprc_score: 0.9842; val_best_acc_score: 0.9235; val_best_f1_score: 0.9578; train_kl_reg_loss: 36570632.8284; train_edge_recon_loss: 61339230.0748; train_gene_expr_recon_loss: 205586117.9719; train_masked_gp_l1_reg_loss: 13115.6541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 302566.0152; train_global_loss: 303811661.3269; train_optim_loss: 303811661.3269; val_kl_reg_loss: 145163.9542; val_edge_recon_loss: 64133856.6420; val_gene_expr_recon_loss: 205744754.1235; val_masked_gp_l1_reg_loss: 12933.7803; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 298089.5938; val_global_loss: 270334789.4321; val_optim_loss: 270334789.4321
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9095; val_auprc_score: 0.9847; val_best_acc_score: 0.9246; val_best_f1_score: 0.9583; train_kl_reg_loss: 4298765706090275.5000; train_edge_recon_loss: 61397577.1184; train_gene_expr_recon_loss: 205160842.2477; train_masked_gp_l1_reg_loss: 12781.8969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 293245.6311; train_global_loss: 4298765972868567.0000; train_optim_loss: 4298765972868567.0000; val_kl_reg_loss: 140685.6469; val_edge_recon_loss: 63850835.3704; val_gene_expr_recon_loss: 207721996.3951; val_masked_gp_l1_reg_loss: 12608.6621; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 289469.4062; val_global_loss: 272015597.5309; val_optim_loss: 272015597.5309
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9117; val_auprc_score: 0.9853; val_best_acc_score: 0.9248; val_best_f1_score: 0.9584; train_kl_reg_loss: 150642.9151; train_edge_recon_loss: 61581145.8827; train_gene_expr_recon_loss: 204901585.9540; train_masked_gp_l1_reg_loss: 12243.1109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 284005.1282; train_global_loss: 266929622.0981; train_optim_loss: 266929622.0981; val_kl_reg_loss: 157753.8175; val_edge_recon_loss: 63802643.3827; val_gene_expr_recon_loss: 204732620.7407; val_masked_gp_l1_reg_loss: 11979.3271; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 281008.5938; val_global_loss: 268986010.4691; val_optim_loss: 268986010.4691
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9121; val_auprc_score: 0.9852; val_best_acc_score: 0.9258; val_best_f1_score: 0.9590; train_kl_reg_loss: 161151443.0516; train_edge_recon_loss: 61184302.6854; train_gene_expr_recon_loss: 204219469.7880; train_masked_gp_l1_reg_loss: 11883.7105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 277905.2677; train_global_loss: 426845013.8566; train_optim_loss: 426845013.8566; val_kl_reg_loss: 168270.2281; val_edge_recon_loss: 64016349.9259; val_gene_expr_recon_loss: 204905932.2963; val_masked_gp_l1_reg_loss: 11793.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 274080.2500; val_global_loss: 269376432.9383; val_optim_loss: 269376432.9383
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9115; val_auprc_score: 0.9850; val_best_acc_score: 0.9247; val_best_f1_score: 0.9583; train_kl_reg_loss: 23663745.2395; train_edge_recon_loss: 61353031.1849; train_gene_expr_recon_loss: 203981280.6038; train_masked_gp_l1_reg_loss: 11541.1936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 271732.4578; train_global_loss: 289281331.4415; train_optim_loss: 289281331.4415; val_kl_reg_loss: 182931.3718; val_edge_recon_loss: 64190539.9259; val_gene_expr_recon_loss: 204225891.3580; val_masked_gp_l1_reg_loss: 11372.4473; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 267736.5625; val_global_loss: 268878474.2222; val_optim_loss: 268878474.2222
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9152; val_auprc_score: 0.9858; val_best_acc_score: 0.9274; val_best_f1_score: 0.9598; train_kl_reg_loss: 202727.1288; train_edge_recon_loss: 61136225.5492; train_gene_expr_recon_loss: 203333906.2449; train_masked_gp_l1_reg_loss: 11224.0338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 265836.9725; train_global_loss: 264949920.3238; train_optim_loss: 264949920.3238; val_kl_reg_loss: 188514.9039; val_edge_recon_loss: 63646450.8642; val_gene_expr_recon_loss: 203619934.9136; val_masked_gp_l1_reg_loss: 11042.2383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 264001.8125; val_global_loss: 267729940.2963; val_optim_loss: 267729940.2963
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9001; val_auprc_score: 0.9833; val_best_acc_score: 0.9199; val_best_f1_score: 0.9559; train_kl_reg_loss: 249177.1262; train_edge_recon_loss: 62372275.4786; train_gene_expr_recon_loss: 235331953.1142; train_masked_gp_l1_reg_loss: 10674.7619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 289191.4380; train_global_loss: 298253271.8875; train_optim_loss: 298253271.8875; val_kl_reg_loss: 117956.2183; val_edge_recon_loss: 65029614.0741; val_gene_expr_recon_loss: 225820392.3457; val_masked_gp_l1_reg_loss: 10569.2412; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 343590.9062; val_global_loss: 291322106.7654; val_optim_loss: 291322106.7654
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9116; val_auprc_score: 0.9853; val_best_acc_score: 0.9243; val_best_f1_score: 0.9581; train_kl_reg_loss: 1086985.5355; train_edge_recon_loss: 61650136.0206; train_gene_expr_recon_loss: 215780317.5959; train_masked_gp_l1_reg_loss: 11039.3552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 300947.9247; train_global_loss: 278829426.0309; train_optim_loss: 278829426.0309; val_kl_reg_loss: 209332.6336; val_edge_recon_loss: 64166973.0247; val_gene_expr_recon_loss: 205052415.8519; val_masked_gp_l1_reg_loss: 10747.2207; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 274262.0312; val_global_loss: 269713738.6173; val_optim_loss: 269713738.6173
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9126; val_auprc_score: 0.9853; val_best_acc_score: 0.9256; val_best_f1_score: 0.9589; train_kl_reg_loss: 223319.4927; train_edge_recon_loss: 61331213.8552; train_gene_expr_recon_loss: 203596581.6755; train_masked_gp_l1_reg_loss: 10418.8994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 261101.1766; train_global_loss: 265422635.2467; train_optim_loss: 265422635.2467; val_kl_reg_loss: 240762.1756; val_edge_recon_loss: 64016588.6420; val_gene_expr_recon_loss: 203406656.7901; val_masked_gp_l1_reg_loss: 10387.9619; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 254162.1094; val_global_loss: 267928567.1605; val_optim_loss: 267928567.1605
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9165; val_auprc_score: 0.9863; val_best_acc_score: 0.9275; val_best_f1_score: 0.9599; train_kl_reg_loss: 245030.5286; train_edge_recon_loss: 61320109.1815; train_gene_expr_recon_loss: 202843997.7057; train_masked_gp_l1_reg_loss: 10174.1557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 251303.1872; train_global_loss: 264670614.8775; train_optim_loss: 264670614.8775; val_kl_reg_loss: 251372.5712; val_edge_recon_loss: 63289023.8148; val_gene_expr_recon_loss: 204228187.6543; val_masked_gp_l1_reg_loss: 9957.3301; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 248882.8125; val_global_loss: 268027424.1975; val_optim_loss: 268027424.1975

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9148; val_auprc_score: 0.9857; val_best_acc_score: 0.9268; val_best_f1_score: 0.9595; train_kl_reg_loss: 250880.3020; train_edge_recon_loss: 61233579.8161; train_gene_expr_recon_loss: 200070489.1444; train_masked_gp_l1_reg_loss: 10020.3844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244185.9810; train_global_loss: 261809155.5623; train_optim_loss: 261809155.5623; val_kl_reg_loss: 250624.9822; val_edge_recon_loss: 64041288.9753; val_gene_expr_recon_loss: 200538623.2593; val_masked_gp_l1_reg_loss: 10012.6416; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 242444.7969; val_global_loss: 265082995.2099; val_optim_loss: 265082995.2099
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9153; val_auprc_score: 0.9859; val_best_acc_score: 0.9273; val_best_f1_score: 0.9598; train_kl_reg_loss: 250455.3028; train_edge_recon_loss: 60999778.1695; train_gene_expr_recon_loss: 199457524.9015; train_masked_gp_l1_reg_loss: 10018.4741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 241361.8823; train_global_loss: 260959140.1111; train_optim_loss: 260959140.1111; val_kl_reg_loss: 253418.1810; val_edge_recon_loss: 63759163.9383; val_gene_expr_recon_loss: 200103216.7407; val_masked_gp_l1_reg_loss: 10008.7754; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 240406.3438; val_global_loss: 264366219.5062; val_optim_loss: 264366219.5062
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9180; val_auprc_score: 0.9864; val_best_acc_score: 0.9280; val_best_f1_score: 0.9601; train_kl_reg_loss: 251833.5352; train_edge_recon_loss: 61146542.6196; train_gene_expr_recon_loss: 199091566.4851; train_masked_gp_l1_reg_loss: 10013.4440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 239766.5942; train_global_loss: 260739721.9623; train_optim_loss: 260739721.9623; val_kl_reg_loss: 252037.3559; val_edge_recon_loss: 63696978.7037; val_gene_expr_recon_loss: 199708576.2963; val_masked_gp_l1_reg_loss: 10013.9541; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 239147.0938; val_global_loss: 263906756.0000; val_optim_loss: 263906756.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9165; val_auprc_score: 0.9860; val_best_acc_score: 0.9281; val_best_f1_score: 0.9602; train_kl_reg_loss: 252959.5766; train_edge_recon_loss: 61243327.2590; train_gene_expr_recon_loss: 198879243.6583; train_masked_gp_l1_reg_loss: 10018.8903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 238460.8661; train_global_loss: 260624010.6209; train_optim_loss: 260624010.6209; val_kl_reg_loss: 252640.5380; val_edge_recon_loss: 63822447.8272; val_gene_expr_recon_loss: 199603931.9506; val_masked_gp_l1_reg_loss: 10020.0850; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 237811.6250; val_global_loss: 263926848.4444; val_optim_loss: 263926848.4444
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9182; val_auprc_score: 0.9865; val_best_acc_score: 0.9280; val_best_f1_score: 0.9600; train_kl_reg_loss: 252521.9517; train_edge_recon_loss: 61237809.2419; train_gene_expr_recon_loss: 198731319.9479; train_masked_gp_l1_reg_loss: 10052.7355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 237358.5297; train_global_loss: 260469062.1036; train_optim_loss: 260469062.1036; val_kl_reg_loss: 252413.4312; val_edge_recon_loss: 63879290.6420; val_gene_expr_recon_loss: 199370809.9753; val_masked_gp_l1_reg_loss: 10025.4258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 236857.8438; val_global_loss: 263749405.1358; val_optim_loss: 263749405.1358
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9188; val_auprc_score: 0.9866; val_best_acc_score: 0.9284; val_best_f1_score: 0.9603; train_kl_reg_loss: 253105.5464; train_edge_recon_loss: 61131015.1520; train_gene_expr_recon_loss: 198532312.4199; train_masked_gp_l1_reg_loss: 9994.3031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 236364.4139; train_global_loss: 260162791.7118; train_optim_loss: 260162791.7118; val_kl_reg_loss: 251264.1147; val_edge_recon_loss: 63557335.1111; val_gene_expr_recon_loss: 199449768.8395; val_masked_gp_l1_reg_loss: 10020.8975; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 235977.4375; val_global_loss: 263504363.6543; val_optim_loss: 263504363.6543
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9182; val_auprc_score: 0.9864; val_best_acc_score: 0.9288; val_best_f1_score: 0.9605; train_kl_reg_loss: 253277.4087; train_edge_recon_loss: 61246842.3355; train_gene_expr_recon_loss: 198292470.9105; train_masked_gp_l1_reg_loss: 10071.0363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 235473.8805; train_global_loss: 260038135.0477; train_optim_loss: 260038135.0477; val_kl_reg_loss: 251842.0577; val_edge_recon_loss: 63765101.4074; val_gene_expr_recon_loss: 199106673.3333; val_masked_gp_l1_reg_loss: 10117.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 235122.4062; val_global_loss: 263368852.3951; val_optim_loss: 263368852.3951
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9192; val_auprc_score: 0.9864; val_best_acc_score: 0.9295; val_best_f1_score: 0.9610; train_kl_reg_loss: 253296.8569; train_edge_recon_loss: 61237370.9269; train_gene_expr_recon_loss: 198269935.0065; train_masked_gp_l1_reg_loss: 10122.2978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 234515.8578; train_global_loss: 260005239.8875; train_optim_loss: 260005239.8875; val_kl_reg_loss: 256642.7243; val_edge_recon_loss: 63557825.1605; val_gene_expr_recon_loss: 198899876.3951; val_masked_gp_l1_reg_loss: 10120.6826; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 233810.8125; val_global_loss: 262958280.2469; val_optim_loss: 262958280.2469
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9200; val_auprc_score: 0.9867; val_best_acc_score: 0.9304; val_best_f1_score: 0.9614; train_kl_reg_loss: 255097.4309; train_edge_recon_loss: 60957896.8988; train_gene_expr_recon_loss: 198013722.7691; train_masked_gp_l1_reg_loss: 10124.4137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 233534.3008; train_global_loss: 259470374.9818; train_optim_loss: 259470374.9818; val_kl_reg_loss: 257033.7514; val_edge_recon_loss: 63353591.2222; val_gene_expr_recon_loss: 198979539.2593; val_masked_gp_l1_reg_loss: 10125.3506; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 233108.9375; val_global_loss: 262833396.4444; val_optim_loss: 262833396.4444
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9201; val_auprc_score: 0.9867; val_best_acc_score: 0.9297; val_best_f1_score: 0.9611; train_kl_reg_loss: 257701.8730; train_edge_recon_loss: 60848494.4467; train_gene_expr_recon_loss: 198007702.7952; train_masked_gp_l1_reg_loss: 10135.8525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 232704.2636; train_global_loss: 259356739.4799; train_optim_loss: 259356739.4799; val_kl_reg_loss: 258867.1739; val_edge_recon_loss: 63539764.6296; val_gene_expr_recon_loss: 198807105.9753; val_masked_gp_l1_reg_loss: 10180.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 232214.7031; val_global_loss: 262848125.0370; val_optim_loss: 262848125.0370
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9188; val_auprc_score: 0.9864; val_best_acc_score: 0.9294; val_best_f1_score: 0.9610; train_kl_reg_loss: 262251.8062; train_edge_recon_loss: 61523370.5386; train_gene_expr_recon_loss: 195683310.1832; train_masked_gp_l1_reg_loss: 10201.7847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 231973.1945; train_global_loss: 257711107.9136; train_optim_loss: 257711107.9136; val_kl_reg_loss: 132430.3696; val_edge_recon_loss: 63688039.6049; val_gene_expr_recon_loss: 196455084.2963; val_masked_gp_l1_reg_loss: 10208.5557; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 231586.5312; val_global_loss: 260517346.7654; val_optim_loss: 260517346.7654
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9191; val_auprc_score: 0.9863; val_best_acc_score: 0.9293; val_best_f1_score: 0.9609; train_kl_reg_loss: 268884.2636; train_edge_recon_loss: 61219783.2041; train_gene_expr_recon_loss: 195509665.6631; train_masked_gp_l1_reg_loss: 10214.9266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 231176.7323; train_global_loss: 257239725.5794; train_optim_loss: 257239725.5794; val_kl_reg_loss: 134058.4978; val_edge_recon_loss: 63969120.9383; val_gene_expr_recon_loss: 196551770.8642; val_masked_gp_l1_reg_loss: 10242.1504; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 230800.9531; val_global_loss: 260895993.4815; val_optim_loss: 260895993.4815
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9202; val_auprc_score: 0.9868; val_best_acc_score: 0.9302; val_best_f1_score: 0.9614; train_kl_reg_loss: 264357.5086; train_edge_recon_loss: 61405003.0792; train_gene_expr_recon_loss: 195363811.2274; train_masked_gp_l1_reg_loss: 10231.1758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 230396.8709; train_global_loss: 257273800.2607; train_optim_loss: 257273800.2607; val_kl_reg_loss: 136994.3812; val_edge_recon_loss: 63109368.9753; val_gene_expr_recon_loss: 196271776.1975; val_masked_gp_l1_reg_loss: 10220.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 229925.5938; val_global_loss: 259758281.6296; val_optim_loss: 259758281.6296
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9217; val_auprc_score: 0.9870; val_best_acc_score: 0.9310; val_best_f1_score: 0.9618; train_kl_reg_loss: 260096.5906; train_edge_recon_loss: 60969813.4600; train_gene_expr_recon_loss: 195296561.0703; train_masked_gp_l1_reg_loss: 10201.4168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 229357.2661; train_global_loss: 256766030.4412; train_optim_loss: 256766030.4412; val_kl_reg_loss: 140945.2917; val_edge_recon_loss: 63253913.7778; val_gene_expr_recon_loss: 196011605.2346; val_masked_gp_l1_reg_loss: 10225.6318; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 229099.2656; val_global_loss: 259645792.6420; val_optim_loss: 259645792.6420
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9200; val_auprc_score: 0.9864; val_best_acc_score: 0.9301; val_best_f1_score: 0.9612; train_kl_reg_loss: 253797.4514; train_edge_recon_loss: 61072890.9708; train_gene_expr_recon_loss: 195184011.6034; train_masked_gp_l1_reg_loss: 10228.9526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 228555.3730; train_global_loss: 256749484.2237; train_optim_loss: 256749484.2237; val_kl_reg_loss: 147645.8247; val_edge_recon_loss: 64335950.3704; val_gene_expr_recon_loss: 196072317.6790; val_masked_gp_l1_reg_loss: 10229.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 228008.4531; val_global_loss: 260794153.4815; val_optim_loss: 260794153.4815
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9208; val_auprc_score: 0.9866; val_best_acc_score: 0.9299; val_best_f1_score: 0.9612; train_kl_reg_loss: 248387.0731; train_edge_recon_loss: 61458511.7791; train_gene_expr_recon_loss: 195047368.8700; train_masked_gp_l1_reg_loss: 10253.8055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 227602.1178; train_global_loss: 256992123.8998; train_optim_loss: 256992123.8998; val_kl_reg_loss: 144548.5958; val_edge_recon_loss: 64230307.2469; val_gene_expr_recon_loss: 195936664.8889; val_masked_gp_l1_reg_loss: 10318.2900; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 227297.0156; val_global_loss: 260549133.9259; val_optim_loss: 260549133.9259
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9225; val_auprc_score: 0.9870; val_best_acc_score: 0.9308; val_best_f1_score: 0.9617; train_kl_reg_loss: 243176.5896; train_edge_recon_loss: 61161805.0593; train_gene_expr_recon_loss: 194994832.5928; train_masked_gp_l1_reg_loss: 10311.1166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 226972.3898; train_global_loss: 256637096.5681; train_optim_loss: 256637096.5681; val_kl_reg_loss: 144122.9056; val_edge_recon_loss: 63911966.7037; val_gene_expr_recon_loss: 195864305.4321; val_masked_gp_l1_reg_loss: 10332.2705; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 226769.3125; val_global_loss: 260157501.4321; val_optim_loss: 260157501.4321
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9206; val_auprc_score: 0.9867; val_best_acc_score: 0.9309; val_best_f1_score: 0.9618; train_kl_reg_loss: 243477.2602; train_edge_recon_loss: 61173613.1280; train_gene_expr_recon_loss: 194938421.5437; train_masked_gp_l1_reg_loss: 10316.6463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 226424.6724; train_global_loss: 256592252.9262; train_optim_loss: 256592252.9262; val_kl_reg_loss: 150773.2241; val_edge_recon_loss: 63697163.6543; val_gene_expr_recon_loss: 195849545.9753; val_masked_gp_l1_reg_loss: 10310.5850; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 226075.9062; val_global_loss: 259933866.7160; val_optim_loss: 259933866.7160

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9221; val_auprc_score: 0.9868; val_best_acc_score: 0.9306; val_best_f1_score: 0.9616; train_kl_reg_loss: 243502.1201; train_edge_recon_loss: 61382701.2830; train_gene_expr_recon_loss: 194526599.4868; train_masked_gp_l1_reg_loss: 10319.5003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225852.3279; train_global_loss: 256388974.3204; train_optim_loss: 256388974.3204; val_kl_reg_loss: 149869.2609; val_edge_recon_loss: 64006520.2593; val_gene_expr_recon_loss: 195427700.9877; val_masked_gp_l1_reg_loss: 10326.9746; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225687.2500; val_global_loss: 259820095.5062; val_optim_loss: 259820095.5062
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9208; val_auprc_score: 0.9866; val_best_acc_score: 0.9306; val_best_f1_score: 0.9615; train_kl_reg_loss: 242637.6102; train_edge_recon_loss: 61109008.7931; train_gene_expr_recon_loss: 194485795.9245; train_masked_gp_l1_reg_loss: 10331.8011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225593.3363; train_global_loss: 256073370.2642; train_optim_loss: 256073370.2642; val_kl_reg_loss: 150032.2020; val_edge_recon_loss: 64135417.4938; val_gene_expr_recon_loss: 195472081.8765; val_masked_gp_l1_reg_loss: 10335.0996; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225514.5000; val_global_loss: 259993384.9383; val_optim_loss: 259993384.9383
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9233; val_auprc_score: 0.9872; val_best_acc_score: 0.9308; val_best_f1_score: 0.9616; train_kl_reg_loss: 242385.4131; train_edge_recon_loss: 61434135.5993; train_gene_expr_recon_loss: 194461139.2220; train_masked_gp_l1_reg_loss: 10337.0989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225447.1814; train_global_loss: 256373444.1386; train_optim_loss: 256373444.1386; val_kl_reg_loss: 150662.0149; val_edge_recon_loss: 63942589.4198; val_gene_expr_recon_loss: 195674665.0370; val_masked_gp_l1_reg_loss: 10338.6123; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225387.5469; val_global_loss: 260003642.6667; val_optim_loss: 260003642.6667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9218; val_auprc_score: 0.9870; val_best_acc_score: 0.9318; val_best_f1_score: 0.9622; train_kl_reg_loss: 242138.9337; train_edge_recon_loss: 61099821.3901; train_gene_expr_recon_loss: 194417799.9863; train_masked_gp_l1_reg_loss: 10338.4687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225323.1675; train_global_loss: 255995419.2906; train_optim_loss: 255995419.2906; val_kl_reg_loss: 151091.9301; val_edge_recon_loss: 63356397.2840; val_gene_expr_recon_loss: 195553416.1481; val_masked_gp_l1_reg_loss: 10338.8779; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225269.4062; val_global_loss: 259296507.6543; val_optim_loss: 259296507.6543
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9229; val_auprc_score: 0.9871; val_best_acc_score: 0.9315; val_best_f1_score: 0.9620; train_kl_reg_loss: 240771.5737; train_edge_recon_loss: 61063268.7973; train_gene_expr_recon_loss: 194434792.4144; train_masked_gp_l1_reg_loss: 10341.5798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225233.5831; train_global_loss: 255974405.4614; train_optim_loss: 255974405.4614; val_kl_reg_loss: 151090.8731; val_edge_recon_loss: 63392630.8148; val_gene_expr_recon_loss: 195411187.1605; val_masked_gp_l1_reg_loss: 10344.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225200.6875; val_global_loss: 259190460.7407; val_optim_loss: 259190460.7407
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9218; val_auprc_score: 0.9869; val_best_acc_score: 0.9312; val_best_f1_score: 0.9619; train_kl_reg_loss: 239313.1838; train_edge_recon_loss: 61004569.9925; train_gene_expr_recon_loss: 194430245.1979; train_masked_gp_l1_reg_loss: 10349.6408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225158.4251; train_global_loss: 255909638.3286; train_optim_loss: 255909638.3286; val_kl_reg_loss: 151210.1073; val_edge_recon_loss: 63554894.3580; val_gene_expr_recon_loss: 195470372.3951; val_masked_gp_l1_reg_loss: 10353.4150; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225124.3125; val_global_loss: 259411950.7654; val_optim_loss: 259411950.7654
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9227; val_auprc_score: 0.9870; val_best_acc_score: 0.9309; val_best_f1_score: 0.9617; train_kl_reg_loss: 238788.2244; train_edge_recon_loss: 61242894.3945; train_gene_expr_recon_loss: 194424003.6172; train_masked_gp_l1_reg_loss: 10353.1392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225096.0242; train_global_loss: 256141133.5520; train_optim_loss: 256141133.5520; val_kl_reg_loss: 151624.9826; val_edge_recon_loss: 64037240.8642; val_gene_expr_recon_loss: 195487675.7037; val_masked_gp_l1_reg_loss: 10356.3037; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225067.0625; val_global_loss: 259911965.0864; val_optim_loss: 259911965.0864
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9216; val_auprc_score: 0.9868; val_best_acc_score: 0.9309; val_best_f1_score: 0.9618; train_kl_reg_loss: 238681.4912; train_edge_recon_loss: 61032061.6590; train_gene_expr_recon_loss: 194418697.3036; train_masked_gp_l1_reg_loss: 10357.4510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 225029.9515; train_global_loss: 255924822.7348; train_optim_loss: 255924822.7348; val_kl_reg_loss: 151724.3364; val_edge_recon_loss: 63876500.9012; val_gene_expr_recon_loss: 195492309.2840; val_masked_gp_l1_reg_loss: 10358.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224986.7188; val_global_loss: 259755880.6420; val_optim_loss: 259755880.6420
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9198; val_auprc_score: 0.9865; val_best_acc_score: 0.9306; val_best_f1_score: 0.9616; train_kl_reg_loss: 238281.6239; train_edge_recon_loss: 61238825.8662; train_gene_expr_recon_loss: 194323931.5815; train_masked_gp_l1_reg_loss: 10357.0558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224936.3902; train_global_loss: 256036329.2652; train_optim_loss: 256036329.2652; val_kl_reg_loss: 152620.1297; val_edge_recon_loss: 63736418.2222; val_gene_expr_recon_loss: 195464845.3333; val_masked_gp_l1_reg_loss: 10356.3389; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224890.7031; val_global_loss: 259589133.2346; val_optim_loss: 259589133.2346

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9237; val_auprc_score: 0.9873; val_best_acc_score: 0.9310; val_best_f1_score: 0.9618; train_kl_reg_loss: 238236.0273; train_edge_recon_loss: 61131830.3039; train_gene_expr_recon_loss: 194306607.0724; train_masked_gp_l1_reg_loss: 10356.0691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224878.6422; train_global_loss: 255911903.9890; train_optim_loss: 255911903.9890; val_kl_reg_loss: 152391.2679; val_edge_recon_loss: 63654003.0617; val_gene_expr_recon_loss: 195330075.2099; val_masked_gp_l1_reg_loss: 10355.8174; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224867.0000; val_global_loss: 259371687.7037; val_optim_loss: 259371687.7037
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9235; val_auprc_score: 0.9873; val_best_acc_score: 0.9320; val_best_f1_score: 0.9624; train_kl_reg_loss: 238041.0260; train_edge_recon_loss: 60974344.1331; train_gene_expr_recon_loss: 194273814.0652; train_masked_gp_l1_reg_loss: 10355.8961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224858.4290; train_global_loss: 255721410.4096; train_optim_loss: 255721410.4096; val_kl_reg_loss: 152389.1390; val_edge_recon_loss: 62851090.2346; val_gene_expr_recon_loss: 195513602.8642; val_masked_gp_l1_reg_loss: 10355.8975; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224849.0938; val_global_loss: 258752286.0741; val_optim_loss: 258752286.0741
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9215; val_auprc_score: 0.9868; val_best_acc_score: 0.9309; val_best_f1_score: 0.9617; train_kl_reg_loss: 237833.7890; train_edge_recon_loss: 61131725.2569; train_gene_expr_recon_loss: 194332332.2676; train_masked_gp_l1_reg_loss: 10355.9530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224842.3938; train_global_loss: 255937086.2875; train_optim_loss: 255937086.2875; val_kl_reg_loss: 152112.0000; val_edge_recon_loss: 63720915.4198; val_gene_expr_recon_loss: 195105802.6173; val_masked_gp_l1_reg_loss: 10356.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224836.3281; val_global_loss: 259214016.1481; val_optim_loss: 259214016.1481
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9224; val_auprc_score: 0.9867; val_best_acc_score: 0.9306; val_best_f1_score: 0.9615; train_kl_reg_loss: 237716.7966; train_edge_recon_loss: 61175035.6432; train_gene_expr_recon_loss: 194295406.5235; train_masked_gp_l1_reg_loss: 10356.1520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224831.2107; train_global_loss: 255943343.7804; train_optim_loss: 255943343.7804; val_kl_reg_loss: 152108.4693; val_edge_recon_loss: 64457351.3951; val_gene_expr_recon_loss: 195441702.7160; val_masked_gp_l1_reg_loss: 10356.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224823.9219; val_global_loss: 260286335.3580; val_optim_loss: 260286335.3580
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9217; val_auprc_score: 0.9868; val_best_acc_score: 0.9304; val_best_f1_score: 0.9615; train_kl_reg_loss: 237558.6495; train_edge_recon_loss: 61240184.1235; train_gene_expr_recon_loss: 194310669.7002; train_masked_gp_l1_reg_loss: 10356.5537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224818.0990; train_global_loss: 256023581.4422; train_optim_loss: 256023581.4422; val_kl_reg_loss: 152453.8380; val_edge_recon_loss: 63929469.5309; val_gene_expr_recon_loss: 195124264.0000; val_masked_gp_l1_reg_loss: 10356.6572; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224813.8750; val_global_loss: 259441354.9136; val_optim_loss: 259441354.9136
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9229; val_auprc_score: 0.9870; val_best_acc_score: 0.9310; val_best_f1_score: 0.9618; train_kl_reg_loss: 237511.3235; train_edge_recon_loss: 60968564.4597; train_gene_expr_recon_loss: 194278248.6779; train_masked_gp_l1_reg_loss: 10356.7864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224807.5096; train_global_loss: 255719483.2796; train_optim_loss: 255719483.2796; val_kl_reg_loss: 152471.1190; val_edge_recon_loss: 63563525.4444; val_gene_expr_recon_loss: 195498500.1975; val_masked_gp_l1_reg_loss: 10357.0605; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224803.4219; val_global_loss: 259449650.5185; val_optim_loss: 259449650.5185

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9210; val_auprc_score: 0.9869; val_best_acc_score: 0.9305; val_best_f1_score: 0.9616; train_kl_reg_loss: 237361.6713; train_edge_recon_loss: 61075435.0285; train_gene_expr_recon_loss: 194300415.7091; train_masked_gp_l1_reg_loss: 10357.0746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224802.4767; train_global_loss: 255848365.2556; train_optim_loss: 255848365.2556; val_kl_reg_loss: 152309.2517; val_edge_recon_loss: 63593816.9753; val_gene_expr_recon_loss: 195292097.5309; val_masked_gp_l1_reg_loss: 10357.1074; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224801.5625; val_global_loss: 259273378.1728; val_optim_loss: 259273378.1728
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9221; val_auprc_score: 0.9869; val_best_acc_score: 0.9311; val_best_f1_score: 0.9619; train_kl_reg_loss: 237285.0835; train_edge_recon_loss: 60883887.1136; train_gene_expr_recon_loss: 194309705.9293; train_masked_gp_l1_reg_loss: 10357.1214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224800.8235; train_global_loss: 255666031.0120; train_optim_loss: 255666031.0120; val_kl_reg_loss: 152463.3849; val_edge_recon_loss: 63812009.7407; val_gene_expr_recon_loss: 195341300.6420; val_masked_gp_l1_reg_loss: 10357.1279; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224800.0781; val_global_loss: 259540927.0123; val_optim_loss: 259540927.0123
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9208; val_auprc_score: 0.9865; val_best_acc_score: 0.9313; val_best_f1_score: 0.9620; train_kl_reg_loss: 237366.6702; train_edge_recon_loss: 61084517.7400; train_gene_expr_recon_loss: 194304107.5815; train_masked_gp_l1_reg_loss: 10357.1452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224799.2029; train_global_loss: 255861144.8425; train_optim_loss: 255861144.8425; val_kl_reg_loss: 152236.2958; val_edge_recon_loss: 64065833.7531; val_gene_expr_recon_loss: 195333953.9259; val_masked_gp_l1_reg_loss: 10357.1514; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224798.4844; val_global_loss: 259787177.8765; val_optim_loss: 259787177.8765
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9226; val_auprc_score: 0.9869; val_best_acc_score: 0.9312; val_best_f1_score: 0.9619; train_kl_reg_loss: 237337.4921; train_edge_recon_loss: 61110434.9283; train_gene_expr_recon_loss: 194322362.8295; train_masked_gp_l1_reg_loss: 10357.1687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 224797.8067; train_global_loss: 255905287.7887; train_optim_loss: 255905287.7887; val_kl_reg_loss: 152347.7087; val_edge_recon_loss: 63622904.7654; val_gene_expr_recon_loss: 195494165.6790; val_masked_gp_l1_reg_loss: 10357.1777; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224796.8438; val_global_loss: 259504572.5432; val_optim_loss: 259504572.5432

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 619 min 50 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9227
val AUPRC score: 0.9870
val best accuracy score: 0.9315
val best F1 score: 0.9621
val target rna MSE score: 0.6211
val source rna MSE score: 0.1692
Val cat covariate0 mean sim diff: -0.0003
Val cat covariate1 mean sim diff: -0.0543
Val cat covariate2 mean sim diff: -0.0006

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
