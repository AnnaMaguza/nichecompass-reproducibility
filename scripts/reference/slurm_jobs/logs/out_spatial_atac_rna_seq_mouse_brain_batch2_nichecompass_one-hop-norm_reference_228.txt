[True]
Run timestamp: 10102023_101415_228.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_228']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6471; val_auprc_score: 0.6294; val_best_acc_score: 0.5048; val_best_f1_score: 0.6688; train_kl_reg_loss: 45488.5166; train_edge_recon_loss: 744985.2188; train_gene_expr_recon_loss: 23457966.1212; train_masked_gp_l1_reg_loss: 111557.5842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3319714.3295; train_chrom_access_recon_loss: 2999139.7765; train_global_loss: 30678851.4242; train_optim_loss: 30678851.4242; val_kl_reg_loss: 68358.5908; val_edge_recon_loss: 813042.6875; val_gene_expr_recon_loss: 21859470.7500; val_masked_gp_l1_reg_loss: 94901.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2240631.2500; val_chrom_access_recon_loss: 2843635.1250; val_global_loss: 27920040.7500; val_optim_loss: 27920040.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6916; val_auprc_score: 0.6763; val_best_acc_score: 0.5621; val_best_f1_score: 0.6874; train_kl_reg_loss: 73294.8137; train_edge_recon_loss: 741932.5341; train_gene_expr_recon_loss: 21384940.7879; train_masked_gp_l1_reg_loss: 86514.5994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1449630.6600; train_chrom_access_recon_loss: 2834392.4205; train_global_loss: 26570706.0000; train_optim_loss: 26570706.0000; val_kl_reg_loss: 73484.9707; val_edge_recon_loss: 812258.4453; val_gene_expr_recon_loss: 21171573.7500; val_masked_gp_l1_reg_loss: 81161.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 849264.5625; val_chrom_access_recon_loss: 2786227.7812; val_global_loss: 25773970.2500; val_optim_loss: 25773970.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7263; val_auprc_score: 0.7071; val_best_acc_score: 0.6526; val_best_f1_score: 0.7160; train_kl_reg_loss: 73694.0392; train_edge_recon_loss: 736535.1345; train_gene_expr_recon_loss: 21097170.5152; train_masked_gp_l1_reg_loss: 79309.4299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 575737.2491; train_chrom_access_recon_loss: 2805415.2955; train_global_loss: 25367861.5152; train_optim_loss: 25367861.5152; val_kl_reg_loss: 74003.7373; val_edge_recon_loss: 810058.5781; val_gene_expr_recon_loss: 21010272.5000; val_masked_gp_l1_reg_loss: 78262.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 383554.8125; val_chrom_access_recon_loss: 2791116.1250; val_global_loss: 25147266.5000; val_optim_loss: 25147266.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7789; val_auprc_score: 0.7689; val_best_acc_score: 0.7023; val_best_f1_score: 0.7128; train_kl_reg_loss: 68413.5307; train_edge_recon_loss: 729778.5767; train_gene_expr_recon_loss: 20949434.0909; train_masked_gp_l1_reg_loss: 78574.6738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 291027.1162; train_chrom_access_recon_loss: 2792150.7727; train_global_loss: 24909378.8788; train_optim_loss: 24909378.8788; val_kl_reg_loss: 63950.2676; val_edge_recon_loss: 799527.7891; val_gene_expr_recon_loss: 20704852.7500; val_masked_gp_l1_reg_loss: 79596.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 222192.7031; val_chrom_access_recon_loss: 2734342.7500; val_global_loss: 24604462.0000; val_optim_loss: 24604462.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8493; val_auprc_score: 0.8226; val_best_acc_score: 0.7869; val_best_f1_score: 0.7968; train_kl_reg_loss: 64028.5419; train_edge_recon_loss: 721033.5161; train_gene_expr_recon_loss: 20792951.2121; train_masked_gp_l1_reg_loss: 80156.5299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186546.1082; train_chrom_access_recon_loss: 2776778.4811; train_global_loss: 24621494.6364; train_optim_loss: 24621494.6364; val_kl_reg_loss: 60471.5273; val_edge_recon_loss: 767562.1562; val_gene_expr_recon_loss: 20843226.0000; val_masked_gp_l1_reg_loss: 81177.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162191.5312; val_chrom_access_recon_loss: 2779507.2500; val_global_loss: 24694137.0000; val_optim_loss: 24694137.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8809; val_auprc_score: 0.8513; val_best_acc_score: 0.8087; val_best_f1_score: 0.8238; train_kl_reg_loss: 62418.6391; train_edge_recon_loss: 697915.3797; train_gene_expr_recon_loss: 20651833.3333; train_masked_gp_l1_reg_loss: 82368.2978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150278.0717; train_chrom_access_recon_loss: 2762422.3598; train_global_loss: 24407236.1515; train_optim_loss: 24407236.1515; val_kl_reg_loss: 64139.2837; val_edge_recon_loss: 688418.9922; val_gene_expr_recon_loss: 20600285.7500; val_masked_gp_l1_reg_loss: 83467.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138194.7812; val_chrom_access_recon_loss: 2735835.6250; val_global_loss: 24310342.0000; val_optim_loss: 24310342.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8878; val_auprc_score: 0.8564; val_best_acc_score: 0.8133; val_best_f1_score: 0.8323; train_kl_reg_loss: 68798.5933; train_edge_recon_loss: 652609.1108; train_gene_expr_recon_loss: 20518693.5455; train_masked_gp_l1_reg_loss: 84301.3249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127566.2230; train_chrom_access_recon_loss: 2750248.0417; train_global_loss: 24202216.8485; train_optim_loss: 24202216.8485; val_kl_reg_loss: 70063.9561; val_edge_recon_loss: 637786.9844; val_gene_expr_recon_loss: 20371533.0000; val_masked_gp_l1_reg_loss: 85131.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117891.9766; val_chrom_access_recon_loss: 2730809.5625; val_global_loss: 24013217.5000; val_optim_loss: 24013217.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8832; val_auprc_score: 0.8451; val_best_acc_score: 0.8211; val_best_f1_score: 0.8363; train_kl_reg_loss: 73161.6457; train_edge_recon_loss: 628929.9129; train_gene_expr_recon_loss: 20409158.4242; train_masked_gp_l1_reg_loss: 85909.0689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111423.4141; train_chrom_access_recon_loss: 2738301.7083; train_global_loss: 24046884.0606; train_optim_loss: 24046884.0606; val_kl_reg_loss: 73737.8105; val_edge_recon_loss: 627279.9375; val_gene_expr_recon_loss: 20347445.2500; val_masked_gp_l1_reg_loss: 86774.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106501.7656; val_chrom_access_recon_loss: 2733153.2500; val_global_loss: 23974892.2500; val_optim_loss: 23974892.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9081; val_auprc_score: 0.8799; val_best_acc_score: 0.8409; val_best_f1_score: 0.8484; train_kl_reg_loss: 72296.9008; train_edge_recon_loss: 620687.3551; train_gene_expr_recon_loss: 20295777.8788; train_masked_gp_l1_reg_loss: 87541.3870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101680.6997; train_chrom_access_recon_loss: 2725090.4583; train_global_loss: 23903074.4242; train_optim_loss: 23903074.4242; val_kl_reg_loss: 70257.4258; val_edge_recon_loss: 622475.2734; val_gene_expr_recon_loss: 20371749.7500; val_masked_gp_l1_reg_loss: 88236.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97206.0938; val_chrom_access_recon_loss: 2722469.9375; val_global_loss: 23972393.7500; val_optim_loss: 23972393.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9094; val_auprc_score: 0.8843; val_best_acc_score: 0.8388; val_best_f1_score: 0.8512; train_kl_reg_loss: 71709.3232; train_edge_recon_loss: 614077.8864; train_gene_expr_recon_loss: 20219258.6061; train_masked_gp_l1_reg_loss: 88876.9605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93671.2891; train_chrom_access_recon_loss: 2716957.5871; train_global_loss: 23804551.7879; train_optim_loss: 23804551.7879; val_kl_reg_loss: 72021.8076; val_edge_recon_loss: 615101.1094; val_gene_expr_recon_loss: 19996445.5000; val_masked_gp_l1_reg_loss: 89703.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91040.9531; val_chrom_access_recon_loss: 2681934.1875; val_global_loss: 23546246.5000; val_optim_loss: 23546246.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9097; val_auprc_score: 0.8828; val_best_acc_score: 0.8407; val_best_f1_score: 0.8522; train_kl_reg_loss: 71041.7002; train_edge_recon_loss: 607785.4498; train_gene_expr_recon_loss: 20140544.9091; train_masked_gp_l1_reg_loss: 89914.1139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88089.2203; train_chrom_access_recon_loss: 2708715.0795; train_global_loss: 23706090.5455; train_optim_loss: 23706090.5455; val_kl_reg_loss: 70478.3701; val_edge_recon_loss: 618537.8281; val_gene_expr_recon_loss: 20063674.7500; val_masked_gp_l1_reg_loss: 90502.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85935.3984; val_chrom_access_recon_loss: 2690461.1562; val_global_loss: 23619590.2500; val_optim_loss: 23619590.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9136; val_auprc_score: 0.8850; val_best_acc_score: 0.8466; val_best_f1_score: 0.8551; train_kl_reg_loss: 70151.2224; train_edge_recon_loss: 606787.7746; train_gene_expr_recon_loss: 20062401.1212; train_masked_gp_l1_reg_loss: 90790.0196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83478.4592; train_chrom_access_recon_loss: 2698069.8939; train_global_loss: 23611678.4242; train_optim_loss: 23611678.4242; val_kl_reg_loss: 71039.1504; val_edge_recon_loss: 612340.4922; val_gene_expr_recon_loss: 19999642.0000; val_masked_gp_l1_reg_loss: 91050.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81146.7891; val_chrom_access_recon_loss: 2665718.9375; val_global_loss: 23520936.5000; val_optim_loss: 23520936.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9211; val_auprc_score: 0.8952; val_best_acc_score: 0.8533; val_best_f1_score: 0.8648; train_kl_reg_loss: 69218.9741; train_edge_recon_loss: 602623.0606; train_gene_expr_recon_loss: 20030287.5455; train_masked_gp_l1_reg_loss: 91500.1686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79820.9176; train_chrom_access_recon_loss: 2691675.4924; train_global_loss: 23565126.0606; train_optim_loss: 23565126.0606; val_kl_reg_loss: 68669.4648; val_edge_recon_loss: 602749.8047; val_gene_expr_recon_loss: 20106888.2500; val_masked_gp_l1_reg_loss: 92088.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78802.6641; val_chrom_access_recon_loss: 2692832.8125; val_global_loss: 23642030.7500; val_optim_loss: 23642030.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9181; val_auprc_score: 0.8943; val_best_acc_score: 0.8514; val_best_f1_score: 0.8591; train_kl_reg_loss: 68302.7798; train_edge_recon_loss: 602583.8371; train_gene_expr_recon_loss: 19972381.2727; train_masked_gp_l1_reg_loss: 92307.5585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77548.0442; train_chrom_access_recon_loss: 2685533.2879; train_global_loss: 23498656.7576; train_optim_loss: 23498656.7576; val_kl_reg_loss: 68635.1553; val_edge_recon_loss: 610334.2891; val_gene_expr_recon_loss: 19913134.0000; val_masked_gp_l1_reg_loss: 92779.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76500.4609; val_chrom_access_recon_loss: 2664976.0938; val_global_loss: 23426360.0000; val_optim_loss: 23426360.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9222; val_auprc_score: 0.8936; val_best_acc_score: 0.8573; val_best_f1_score: 0.8661; train_kl_reg_loss: 67356.2804; train_edge_recon_loss: 599576.2206; train_gene_expr_recon_loss: 19892814.5152; train_masked_gp_l1_reg_loss: 92929.9273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75346.1889; train_chrom_access_recon_loss: 2675590.0833; train_global_loss: 23403613.1515; train_optim_loss: 23403613.1515; val_kl_reg_loss: 66927.2881; val_edge_recon_loss: 607016.7344; val_gene_expr_recon_loss: 19860983.2500; val_masked_gp_l1_reg_loss: 93409.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74836.7422; val_chrom_access_recon_loss: 2680004.9062; val_global_loss: 23383178.0000; val_optim_loss: 23383178.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9282; val_auprc_score: 0.9024; val_best_acc_score: 0.8614; val_best_f1_score: 0.8680; train_kl_reg_loss: 66517.9529; train_edge_recon_loss: 596637.4669; train_gene_expr_recon_loss: 19828319.7879; train_masked_gp_l1_reg_loss: 93630.6474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73778.0079; train_chrom_access_recon_loss: 2666622.4508; train_global_loss: 23325506.3939; train_optim_loss: 23325506.3939; val_kl_reg_loss: 67498.6670; val_edge_recon_loss: 601072.6250; val_gene_expr_recon_loss: 20027788.0000; val_masked_gp_l1_reg_loss: 94107.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73574.3906; val_chrom_access_recon_loss: 2657469.5312; val_global_loss: 23521511.0000; val_optim_loss: 23521511.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9241; val_auprc_score: 0.9017; val_best_acc_score: 0.8592; val_best_f1_score: 0.8653; train_kl_reg_loss: 65939.4702; train_edge_recon_loss: 595072.8712; train_gene_expr_recon_loss: 19764112.3030; train_masked_gp_l1_reg_loss: 94363.6714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72610.6536; train_chrom_access_recon_loss: 2658504.9167; train_global_loss: 23250603.8788; train_optim_loss: 23250603.8788; val_kl_reg_loss: 67210.5938; val_edge_recon_loss: 601818.0469; val_gene_expr_recon_loss: 20015929.2500; val_masked_gp_l1_reg_loss: 94575.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72437.1953; val_chrom_access_recon_loss: 2649943.7500; val_global_loss: 23501915.7500; val_optim_loss: 23501915.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9252; val_auprc_score: 0.9007; val_best_acc_score: 0.8622; val_best_f1_score: 0.8679; train_kl_reg_loss: 65500.5626; train_edge_recon_loss: 592793.2841; train_gene_expr_recon_loss: 19713628.4545; train_masked_gp_l1_reg_loss: 94953.1332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71851.7398; train_chrom_access_recon_loss: 2651386.2462; train_global_loss: 23190113.3636; train_optim_loss: 23190113.3636; val_kl_reg_loss: 65614.9478; val_edge_recon_loss: 601831.5469; val_gene_expr_recon_loss: 19755560.2500; val_masked_gp_l1_reg_loss: 95618.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71931.5547; val_chrom_access_recon_loss: 2647877.9375; val_global_loss: 23238434.5000; val_optim_loss: 23238434.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9315; val_auprc_score: 0.9071; val_best_acc_score: 0.8667; val_best_f1_score: 0.8749; train_kl_reg_loss: 64673.5303; train_edge_recon_loss: 592855.5237; train_gene_expr_recon_loss: 19679501.5455; train_masked_gp_l1_reg_loss: 95844.8055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71428.5099; train_chrom_access_recon_loss: 2648029.2803; train_global_loss: 23152333.1212; train_optim_loss: 23152333.1212; val_kl_reg_loss: 64391.9272; val_edge_recon_loss: 597996.0156; val_gene_expr_recon_loss: 19710622.2500; val_masked_gp_l1_reg_loss: 96151.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71520.1875; val_chrom_access_recon_loss: 2630224.7188; val_global_loss: 23170906.2500; val_optim_loss: 23170906.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9374; val_auprc_score: 0.9161; val_best_acc_score: 0.8799; val_best_f1_score: 0.8854; train_kl_reg_loss: 63896.5141; train_edge_recon_loss: 593192.6790; train_gene_expr_recon_loss: 19620567.2121; train_masked_gp_l1_reg_loss: 96337.7229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71131.8891; train_chrom_access_recon_loss: 2638256.2348; train_global_loss: 23083382.2121; train_optim_loss: 23083382.2121; val_kl_reg_loss: 65497.7324; val_edge_recon_loss: 593050.3828; val_gene_expr_recon_loss: 19629933.5000; val_masked_gp_l1_reg_loss: 96873.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70899.8047; val_chrom_access_recon_loss: 2621470.1250; val_global_loss: 23077725.7500; val_optim_loss: 23077725.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9362; val_auprc_score: 0.9078; val_best_acc_score: 0.8802; val_best_f1_score: 0.8852; train_kl_reg_loss: 63990.6280; train_edge_recon_loss: 589373.7292; train_gene_expr_recon_loss: 19553249.9697; train_masked_gp_l1_reg_loss: 97041.1348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70557.3943; train_chrom_access_recon_loss: 2630539.5076; train_global_loss: 23004752.3636; train_optim_loss: 23004752.3636; val_kl_reg_loss: 64101.7197; val_edge_recon_loss: 595082.0000; val_gene_expr_recon_loss: 19587921.0000; val_masked_gp_l1_reg_loss: 97400.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70274.9844; val_chrom_access_recon_loss: 2592174.8750; val_global_loss: 23006954.0000; val_optim_loss: 23006954.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9386; val_auprc_score: 0.9212; val_best_acc_score: 0.8772; val_best_f1_score: 0.8819; train_kl_reg_loss: 63559.8266; train_edge_recon_loss: 586910.9119; train_gene_expr_recon_loss: 19517708.9091; train_masked_gp_l1_reg_loss: 97679.9197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70136.0513; train_chrom_access_recon_loss: 2627484.3409; train_global_loss: 22963480.1515; train_optim_loss: 22963480.1515; val_kl_reg_loss: 63915.1748; val_edge_recon_loss: 596000.4141; val_gene_expr_recon_loss: 19556298.7500; val_masked_gp_l1_reg_loss: 98127.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69821.3906; val_chrom_access_recon_loss: 2617134.5000; val_global_loss: 23001298.7500; val_optim_loss: 23001298.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9364; val_auprc_score: 0.9129; val_best_acc_score: 0.8823; val_best_f1_score: 0.8883; train_kl_reg_loss: 62758.4410; train_edge_recon_loss: 588024.6108; train_gene_expr_recon_loss: 19489868.5758; train_masked_gp_l1_reg_loss: 98370.7667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69539.7550; train_chrom_access_recon_loss: 2621304.8447; train_global_loss: 22929867.3636; train_optim_loss: 22929867.3636; val_kl_reg_loss: 62789.4556; val_edge_recon_loss: 595186.1016; val_gene_expr_recon_loss: 19589025.0000; val_masked_gp_l1_reg_loss: 98992.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69924.2188; val_chrom_access_recon_loss: 2592695.1875; val_global_loss: 23008611.7500; val_optim_loss: 23008611.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9404; val_auprc_score: 0.9187; val_best_acc_score: 0.8815; val_best_f1_score: 0.8882; train_kl_reg_loss: 62078.7613; train_edge_recon_loss: 589591.2652; train_gene_expr_recon_loss: 19455860.9394; train_masked_gp_l1_reg_loss: 99205.5489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69282.4809; train_chrom_access_recon_loss: 2616224.5568; train_global_loss: 22892243.2424; train_optim_loss: 22892243.2424; val_kl_reg_loss: 63017.5610; val_edge_recon_loss: 592246.7578; val_gene_expr_recon_loss: 19381303.7500; val_masked_gp_l1_reg_loss: 99655.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69240.2891; val_chrom_access_recon_loss: 2593059.4375; val_global_loss: 22798523.5000; val_optim_loss: 22798523.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9498; val_auprc_score: 0.9306; val_best_acc_score: 0.8941; val_best_f1_score: 0.8985; train_kl_reg_loss: 61677.2391; train_edge_recon_loss: 587407.5331; train_gene_expr_recon_loss: 19402032.8182; train_masked_gp_l1_reg_loss: 99903.4083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68835.5243; train_chrom_access_recon_loss: 2609734.7614; train_global_loss: 22829591.2727; train_optim_loss: 22829591.2727; val_kl_reg_loss: 62530.7456; val_edge_recon_loss: 589111.1484; val_gene_expr_recon_loss: 19441444.0000; val_masked_gp_l1_reg_loss: 100401.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68462.2344; val_chrom_access_recon_loss: 2607257.3438; val_global_loss: 22869207.2500; val_optim_loss: 22869207.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9431; val_auprc_score: 0.9184; val_best_acc_score: 0.8917; val_best_f1_score: 0.8972; train_kl_reg_loss: 61340.8482; train_edge_recon_loss: 587173.0814; train_gene_expr_recon_loss: 19353171.0909; train_masked_gp_l1_reg_loss: 100780.3603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68255.2988; train_chrom_access_recon_loss: 2602726.3902; train_global_loss: 22773447.2727; train_optim_loss: 22773447.2727; val_kl_reg_loss: 60201.9990; val_edge_recon_loss: 588104.5000; val_gene_expr_recon_loss: 19182597.2500; val_masked_gp_l1_reg_loss: 101478.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67843.6406; val_chrom_access_recon_loss: 2564471.9062; val_global_loss: 22564697.2500; val_optim_loss: 22564697.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9467; val_auprc_score: 0.9279; val_best_acc_score: 0.8907; val_best_f1_score: 0.8965; train_kl_reg_loss: 60851.3436; train_edge_recon_loss: 585041.4498; train_gene_expr_recon_loss: 19308210.5152; train_masked_gp_l1_reg_loss: 101712.0189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67879.9686; train_chrom_access_recon_loss: 2595526.0758; train_global_loss: 22719221.4242; train_optim_loss: 22719221.4242; val_kl_reg_loss: 60255.4316; val_edge_recon_loss: 589149.0312; val_gene_expr_recon_loss: 19375382.5000; val_masked_gp_l1_reg_loss: 102243.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67872.5391; val_chrom_access_recon_loss: 2585198.0000; val_global_loss: 22780101.5000; val_optim_loss: 22780101.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9471; val_auprc_score: 0.9223; val_best_acc_score: 0.8890; val_best_f1_score: 0.8950; train_kl_reg_loss: 60302.0017; train_edge_recon_loss: 585009.9934; train_gene_expr_recon_loss: 19259614.1212; train_masked_gp_l1_reg_loss: 102666.8732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67484.0627; train_chrom_access_recon_loss: 2589449.3902; train_global_loss: 22664526.5152; train_optim_loss: 22664526.5152; val_kl_reg_loss: 61714.2017; val_edge_recon_loss: 589880.6953; val_gene_expr_recon_loss: 19124201.0000; val_masked_gp_l1_reg_loss: 103419.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67431.8828; val_chrom_access_recon_loss: 2565416.2500; val_global_loss: 22512064.0000; val_optim_loss: 22512064.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9488; val_auprc_score: 0.9347; val_best_acc_score: 0.8931; val_best_f1_score: 0.8984; train_kl_reg_loss: 59828.4922; train_edge_recon_loss: 586067.2396; train_gene_expr_recon_loss: 19226579.3030; train_masked_gp_l1_reg_loss: 103840.1668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67258.6533; train_chrom_access_recon_loss: 2582178.9621; train_global_loss: 22625752.7879; train_optim_loss: 22625752.7879; val_kl_reg_loss: 60786.0479; val_edge_recon_loss: 589341.9766; val_gene_expr_recon_loss: 19438677.5000; val_masked_gp_l1_reg_loss: 104454.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67558.9531; val_chrom_access_recon_loss: 2609379.6250; val_global_loss: 22870197.0000; val_optim_loss: 22870197.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9418; val_auprc_score: 0.9177; val_best_acc_score: 0.8877; val_best_f1_score: 0.8948; train_kl_reg_loss: 59432.3018; train_edge_recon_loss: 584930.3741; train_gene_expr_recon_loss: 19172813.6667; train_masked_gp_l1_reg_loss: 104924.8610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67129.6819; train_chrom_access_recon_loss: 2579238.8864; train_global_loss: 22568469.9091; train_optim_loss: 22568469.9091; val_kl_reg_loss: 59879.9009; val_edge_recon_loss: 590814.6016; val_gene_expr_recon_loss: 19136136.0000; val_masked_gp_l1_reg_loss: 105409.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66778.2109; val_chrom_access_recon_loss: 2563921.6875; val_global_loss: 22522940.2500; val_optim_loss: 22522940.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9461; val_auprc_score: 0.9223; val_best_acc_score: 0.8960; val_best_f1_score: 0.9013; train_kl_reg_loss: 58884.3246; train_edge_recon_loss: 584310.0559; train_gene_expr_recon_loss: 19139294.3333; train_masked_gp_l1_reg_loss: 105987.1771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66703.1359; train_chrom_access_recon_loss: 2572087.2121; train_global_loss: 22527266.2727; train_optim_loss: 22527266.2727; val_kl_reg_loss: 59679.9897; val_edge_recon_loss: 588931.1875; val_gene_expr_recon_loss: 19415381.0000; val_masked_gp_l1_reg_loss: 106898.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67043.9922; val_chrom_access_recon_loss: 2606424.1562; val_global_loss: 22844359.0000; val_optim_loss: 22844359.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9494; val_auprc_score: 0.9338; val_best_acc_score: 0.8971; val_best_f1_score: 0.9023; train_kl_reg_loss: 58703.5147; train_edge_recon_loss: 585011.4479; train_gene_expr_recon_loss: 19100584.9697; train_masked_gp_l1_reg_loss: 107252.4698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66588.0453; train_chrom_access_recon_loss: 2567524.7008; train_global_loss: 22485665.0303; train_optim_loss: 22485665.0303; val_kl_reg_loss: 56486.9619; val_edge_recon_loss: 584374.0625; val_gene_expr_recon_loss: 19189882.7500; val_masked_gp_l1_reg_loss: 107813.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66793.8594; val_chrom_access_recon_loss: 2563782.5938; val_global_loss: 22569134.0000; val_optim_loss: 22569134.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9442; val_auprc_score: 0.9256; val_best_acc_score: 0.8845; val_best_f1_score: 0.8927; train_kl_reg_loss: 58687.9110; train_edge_recon_loss: 582714.9640; train_gene_expr_recon_loss: 19058964.7576; train_masked_gp_l1_reg_loss: 104703.2388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53595.1955; train_chrom_access_recon_loss: 2559953.5833; train_global_loss: 22418619.5455; train_optim_loss: 22418619.5455; val_kl_reg_loss: 59558.9780; val_edge_recon_loss: 589607.0469; val_gene_expr_recon_loss: 19127029.2500; val_masked_gp_l1_reg_loss: 103338.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49474.1836; val_chrom_access_recon_loss: 2567095.1250; val_global_loss: 22496102.5000; val_optim_loss: 22496102.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9495; val_auprc_score: 0.9311; val_best_acc_score: 0.9009; val_best_f1_score: 0.9055; train_kl_reg_loss: 59093.8308; train_edge_recon_loss: 583082.0767; train_gene_expr_recon_loss: 19038117.0606; train_masked_gp_l1_reg_loss: 103174.1989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48853.2064; train_chrom_access_recon_loss: 2556526.8788; train_global_loss: 22388847.4545; train_optim_loss: 22388847.4545; val_kl_reg_loss: 60322.5806; val_edge_recon_loss: 584027.2500; val_gene_expr_recon_loss: 19106701.7500; val_masked_gp_l1_reg_loss: 103106.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48428.4180; val_chrom_access_recon_loss: 2551144.3750; val_global_loss: 22453730.2500; val_optim_loss: 22453730.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9433; val_auprc_score: 0.9194; val_best_acc_score: 0.8925; val_best_f1_score: 0.8981; train_kl_reg_loss: 59407.8175; train_edge_recon_loss: 579952.4621; train_gene_expr_recon_loss: 19042075.2727; train_masked_gp_l1_reg_loss: 103055.7283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48174.2870; train_chrom_access_recon_loss: 2558369.2803; train_global_loss: 22391034.7273; train_optim_loss: 22391034.7273; val_kl_reg_loss: 60461.7485; val_edge_recon_loss: 589202.2188; val_gene_expr_recon_loss: 19260828.0000; val_masked_gp_l1_reg_loss: 103045.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47934.5898; val_chrom_access_recon_loss: 2549698.7500; val_global_loss: 22611170.2500; val_optim_loss: 22611170.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9526; val_auprc_score: 0.9373; val_best_acc_score: 0.8952; val_best_f1_score: 0.9008; train_kl_reg_loss: 59624.8353; train_edge_recon_loss: 581078.5909; train_gene_expr_recon_loss: 19028800.1515; train_masked_gp_l1_reg_loss: 103093.8632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47780.1067; train_chrom_access_recon_loss: 2554482.1212; train_global_loss: 22374859.6061; train_optim_loss: 22374859.6061; val_kl_reg_loss: 60313.8667; val_edge_recon_loss: 586175.2578; val_gene_expr_recon_loss: 19118704.7500; val_masked_gp_l1_reg_loss: 103143.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47678.6953; val_chrom_access_recon_loss: 2539001.7812; val_global_loss: 22455017.5000; val_optim_loss: 22455017.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9497; val_auprc_score: 0.9318; val_best_acc_score: 0.8971; val_best_f1_score: 0.9035; train_kl_reg_loss: 59644.8745; train_edge_recon_loss: 581453.2661; train_gene_expr_recon_loss: 19018632.7879; train_masked_gp_l1_reg_loss: 103199.0347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47515.9646; train_chrom_access_recon_loss: 2554124.7311; train_global_loss: 22364570.5758; train_optim_loss: 22364570.5758; val_kl_reg_loss: 60297.0073; val_edge_recon_loss: 581542.3203; val_gene_expr_recon_loss: 19113304.7500; val_masked_gp_l1_reg_loss: 103240.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47351.0000; val_chrom_access_recon_loss: 2549629.4062; val_global_loss: 22455364.5000; val_optim_loss: 22455364.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9468; val_auprc_score: 0.9260; val_best_acc_score: 0.8949; val_best_f1_score: 0.9013; train_kl_reg_loss: 59735.3516; train_edge_recon_loss: 581907.5256; train_gene_expr_recon_loss: 19019957.6061; train_masked_gp_l1_reg_loss: 103286.7102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47245.7959; train_chrom_access_recon_loss: 2556146.9470; train_global_loss: 22368280.1212; train_optim_loss: 22368280.1212; val_kl_reg_loss: 60347.6548; val_edge_recon_loss: 586398.8281; val_gene_expr_recon_loss: 19136727.2500; val_masked_gp_l1_reg_loss: 103339.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47154.1680; val_chrom_access_recon_loss: 2549386.5625; val_global_loss: 22483354.7500; val_optim_loss: 22483354.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9515; val_auprc_score: 0.9299; val_best_acc_score: 0.9009; val_best_f1_score: 0.9044; train_kl_reg_loss: 59782.1692; train_edge_recon_loss: 579821.7680; train_gene_expr_recon_loss: 19027715.8485; train_masked_gp_l1_reg_loss: 103029.4869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45916.2330; train_chrom_access_recon_loss: 2556675.1705; train_global_loss: 22372940.7273; train_optim_loss: 22372940.7273; val_kl_reg_loss: 60788.5229; val_edge_recon_loss: 580793.9844; val_gene_expr_recon_loss: 19233085.2500; val_masked_gp_l1_reg_loss: 102866.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45552.8789; val_chrom_access_recon_loss: 2576829.4062; val_global_loss: 22599915.5000; val_optim_loss: 22599915.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9397; val_auprc_score: 0.9116; val_best_acc_score: 0.8890; val_best_f1_score: 0.8955; train_kl_reg_loss: 59735.9360; train_edge_recon_loss: 581951.1269; train_gene_expr_recon_loss: 18990535.3030; train_masked_gp_l1_reg_loss: 102827.3497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45485.4734; train_chrom_access_recon_loss: 2550941.1818; train_global_loss: 22331476.3333; train_optim_loss: 22331476.3333; val_kl_reg_loss: 60372.3145; val_edge_recon_loss: 589037.5625; val_gene_expr_recon_loss: 19114072.0000; val_masked_gp_l1_reg_loss: 102799.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45427.5469; val_chrom_access_recon_loss: 2542116.0625; val_global_loss: 22453826.0000; val_optim_loss: 22453826.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9482; val_auprc_score: 0.9310; val_best_acc_score: 0.8944; val_best_f1_score: 0.9001; train_kl_reg_loss: 59775.9031; train_edge_recon_loss: 581265.2083; train_gene_expr_recon_loss: 19008672.5455; train_masked_gp_l1_reg_loss: 102787.8892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45391.8688; train_chrom_access_recon_loss: 2554187.7803; train_global_loss: 22352081.3636; train_optim_loss: 22352081.3636; val_kl_reg_loss: 60416.0562; val_edge_recon_loss: 591036.6328; val_gene_expr_recon_loss: 18990977.5000; val_masked_gp_l1_reg_loss: 102780.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45356.0352; val_chrom_access_recon_loss: 2527933.3750; val_global_loss: 22318499.2500; val_optim_loss: 22318499.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9478; val_auprc_score: 0.9290; val_best_acc_score: 0.8944; val_best_f1_score: 0.8996; train_kl_reg_loss: 59788.0483; train_edge_recon_loss: 580283.7689; train_gene_expr_recon_loss: 19008604.4848; train_masked_gp_l1_reg_loss: 102779.2865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45328.3513; train_chrom_access_recon_loss: 2553199.1023; train_global_loss: 22349983.2424; train_optim_loss: 22349983.2424; val_kl_reg_loss: 60708.3750; val_edge_recon_loss: 588543.1641; val_gene_expr_recon_loss: 19228791.2500; val_masked_gp_l1_reg_loss: 102776.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45297.8125; val_chrom_access_recon_loss: 2582684.4688; val_global_loss: 22608801.0000; val_optim_loss: 22608801.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9488; val_auprc_score: 0.9293; val_best_acc_score: 0.9022; val_best_f1_score: 0.9068; train_kl_reg_loss: 59795.5325; train_edge_recon_loss: 580193.7216; train_gene_expr_recon_loss: 19006702.2424; train_masked_gp_l1_reg_loss: 102779.7105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45274.8921; train_chrom_access_recon_loss: 2553789.7083; train_global_loss: 22348535.6667; train_optim_loss: 22348535.6667; val_kl_reg_loss: 60822.2402; val_edge_recon_loss: 584669.3984; val_gene_expr_recon_loss: 19214016.5000; val_masked_gp_l1_reg_loss: 102779.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45248.2852; val_chrom_access_recon_loss: 2548361.7500; val_global_loss: 22555897.7500; val_optim_loss: 22555897.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9487; val_auprc_score: 0.9270; val_best_acc_score: 0.8907; val_best_f1_score: 0.8978; train_kl_reg_loss: 59820.0786; train_edge_recon_loss: 582492.5104; train_gene_expr_recon_loss: 19011952.8182; train_masked_gp_l1_reg_loss: 102782.6888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45233.4195; train_chrom_access_recon_loss: 2553410.1932; train_global_loss: 22355691.6970; train_optim_loss: 22355691.6970; val_kl_reg_loss: 60726.4653; val_edge_recon_loss: 584952.2969; val_gene_expr_recon_loss: 19066712.5000; val_masked_gp_l1_reg_loss: 102786.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45210.5078; val_chrom_access_recon_loss: 2547440.0625; val_global_loss: 22407827.0000; val_optim_loss: 22407827.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9496; val_auprc_score: 0.9337; val_best_acc_score: 0.8941; val_best_f1_score: 0.8986; train_kl_reg_loss: 59808.1280; train_edge_recon_loss: 580674.3816; train_gene_expr_recon_loss: 18981501.3939; train_masked_gp_l1_reg_loss: 102793.0889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45190.8404; train_chrom_access_recon_loss: 2549263.7008; train_global_loss: 22319231.5758; train_optim_loss: 22319231.5758; val_kl_reg_loss: 60393.7617; val_edge_recon_loss: 581734.1797; val_gene_expr_recon_loss: 19087460.0000; val_masked_gp_l1_reg_loss: 102795.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45167.7188; val_chrom_access_recon_loss: 2533234.3438; val_global_loss: 22410786.7500; val_optim_loss: 22410786.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9411; val_auprc_score: 0.9169; val_best_acc_score: 0.8939; val_best_f1_score: 0.8987; train_kl_reg_loss: 59832.0802; train_edge_recon_loss: 580693.8106; train_gene_expr_recon_loss: 19009839.3030; train_masked_gp_l1_reg_loss: 102764.3242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45044.3304; train_chrom_access_recon_loss: 2551068.1742; train_global_loss: 22349242.0606; train_optim_loss: 22349242.0606; val_kl_reg_loss: 60891.7085; val_edge_recon_loss: 584530.0859; val_gene_expr_recon_loss: 19269629.7500; val_masked_gp_l1_reg_loss: 102747.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45009.2734; val_chrom_access_recon_loss: 2558834.4375; val_global_loss: 22621643.7500; val_optim_loss: 22621643.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9524; val_auprc_score: 0.9339; val_best_acc_score: 0.9033; val_best_f1_score: 0.9072; train_kl_reg_loss: 59873.0504; train_edge_recon_loss: 581249.7566; train_gene_expr_recon_loss: 18999303.9394; train_masked_gp_l1_reg_loss: 102743.0488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45003.1459; train_chrom_access_recon_loss: 2549660.4015; train_global_loss: 22337833.4242; train_optim_loss: 22337833.4242; val_kl_reg_loss: 60998.7817; val_edge_recon_loss: 581097.8984; val_gene_expr_recon_loss: 19304673.2500; val_masked_gp_l1_reg_loss: 102739.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44997.9648; val_chrom_access_recon_loss: 2599034.2812; val_global_loss: 22693542.2500; val_optim_loss: 22693542.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9445; val_auprc_score: 0.9218; val_best_acc_score: 0.8920; val_best_f1_score: 0.8987; train_kl_reg_loss: 59820.8866; train_edge_recon_loss: 582779.1629; train_gene_expr_recon_loss: 19007808.5455; train_masked_gp_l1_reg_loss: 102737.5939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44994.2061; train_chrom_access_recon_loss: 2552594.1970; train_global_loss: 22350734.3939; train_optim_loss: 22350734.3939; val_kl_reg_loss: 60818.7881; val_edge_recon_loss: 589357.1094; val_gene_expr_recon_loss: 19024962.7500; val_masked_gp_l1_reg_loss: 102736.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44990.8828; val_chrom_access_recon_loss: 2540411.5312; val_global_loss: 22363276.2500; val_optim_loss: 22363276.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9489; val_auprc_score: 0.9313; val_best_acc_score: 0.8947; val_best_f1_score: 0.8990; train_kl_reg_loss: 59810.5265; train_edge_recon_loss: 581448.4318; train_gene_expr_recon_loss: 19020629.1515; train_masked_gp_l1_reg_loss: 102735.5884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44987.9853; train_chrom_access_recon_loss: 2555309.4015; train_global_loss: 22364921.3030; train_optim_loss: 22364921.3030; val_kl_reg_loss: 60654.2866; val_edge_recon_loss: 586595.6172; val_gene_expr_recon_loss: 19040079.5000; val_masked_gp_l1_reg_loss: 102734.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44984.9258; val_chrom_access_recon_loss: 2538442.7812; val_global_loss: 22373490.2500; val_optim_loss: 22373490.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 57 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9492
val AUPRC score: 0.9346
val best accuracy score: 0.8955
val best F1 score: 0.8997
val target rna MSE score: 1.2317
val source rna MSE score: 0.5803
val target atac MSE score: 0.4704
val source atac MSE score: 0.1928
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
