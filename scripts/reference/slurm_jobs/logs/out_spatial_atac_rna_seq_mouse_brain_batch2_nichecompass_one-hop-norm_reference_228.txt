[True]
Run timestamp: 07092023_011309_228.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_228']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2863 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 6459, n_cat_covariates_embed_input: 0, n_hidden: 2392, n_latent: 2292, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2863
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2863

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6169; val_auprc_score: 0.6042; val_best_acc_score: 0.5005; val_best_f1_score: 0.6667; train_kl_reg_loss: 43940.2816; train_edge_recon_loss: 3557653.1780; train_gene_expr_recon_loss: 14993364.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1135011.6818; train_chrom_access_recon_loss: 12528040.3333; train_global_loss: 32258009.9394; train_optim_loss: 32258009.9394; val_kl_reg_loss: 58813.8271; val_edge_recon_loss: 4065166.2500; val_gene_expr_recon_loss: 13646168.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 877831.8125; val_chrom_access_recon_loss: 11999221.6250; val_global_loss: 30647202.2500; val_optim_loss: 30647202.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6906; val_auprc_score: 0.6782; val_best_acc_score: 0.5545; val_best_f1_score: 0.6841; train_kl_reg_loss: 92522.4161; train_edge_recon_loss: 3533695.3485; train_gene_expr_recon_loss: 13262214.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 649962.5990; train_chrom_access_recon_loss: 11839330.0000; train_global_loss: 29377724.5152; train_optim_loss: 29377724.5152; val_kl_reg_loss: 118456.1221; val_edge_recon_loss: 4061706.5000; val_gene_expr_recon_loss: 13110862.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 455558.7812; val_chrom_access_recon_loss: 11886586.5000; val_global_loss: 29633169.0000; val_optim_loss: 29633169.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7143; val_auprc_score: 0.7110; val_best_acc_score: 0.6145; val_best_f1_score: 0.6999; train_kl_reg_loss: 96434.9850; train_edge_recon_loss: 3520926.1402; train_gene_expr_recon_loss: 12997867.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 341790.4588; train_chrom_access_recon_loss: 11712536.0606; train_global_loss: 28669555.1515; train_optim_loss: 28669555.1515; val_kl_reg_loss: 94389.2383; val_edge_recon_loss: 4056538.5938; val_gene_expr_recon_loss: 12986467.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 253078.8750; val_chrom_access_recon_loss: 11792643.0000; val_global_loss: 29183117.2500; val_optim_loss: 29183117.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7780; val_auprc_score: 0.7664; val_best_acc_score: 0.7034; val_best_f1_score: 0.7131; train_kl_reg_loss: 87707.1296; train_edge_recon_loss: 3510496.8409; train_gene_expr_recon_loss: 12873576.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 202168.5608; train_chrom_access_recon_loss: 11625877.5303; train_global_loss: 28299826.2727; train_optim_loss: 28299826.2727; val_kl_reg_loss: 88662.6973; val_edge_recon_loss: 4027908.8750; val_gene_expr_recon_loss: 12802036.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161451.3750; val_chrom_access_recon_loss: 11690195.2500; val_global_loss: 28770254.5000; val_optim_loss: 28770254.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8322; val_auprc_score: 0.8008; val_best_acc_score: 0.7638; val_best_f1_score: 0.7812; train_kl_reg_loss: 76419.2047; train_edge_recon_loss: 3491376.1667; train_gene_expr_recon_loss: 12778124.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136783.8282; train_chrom_access_recon_loss: 11551084.5000; train_global_loss: 28033787.9697; train_optim_loss: 28033787.9697; val_kl_reg_loss: 65927.0508; val_edge_recon_loss: 3813460.0625; val_gene_expr_recon_loss: 12869733.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116388.6094; val_chrom_access_recon_loss: 11642173.5000; val_global_loss: 28507682.5000; val_optim_loss: 28507682.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8336; val_auprc_score: 0.7990; val_best_acc_score: 0.7603; val_best_f1_score: 0.7957; train_kl_reg_loss: 60801.9908; train_edge_recon_loss: 3274481.2083; train_gene_expr_recon_loss: 12724986.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102521.6383; train_chrom_access_recon_loss: 11491746.5455; train_global_loss: 27654537.8788; train_optim_loss: 27654537.8788; val_kl_reg_loss: 70002.8496; val_edge_recon_loss: 3075664.4062; val_gene_expr_recon_loss: 12819641.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91208.2500; val_chrom_access_recon_loss: 11524626.5000; val_global_loss: 27581143.2500; val_optim_loss: 27581143.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8399; val_auprc_score: 0.7997; val_best_acc_score: 0.7638; val_best_f1_score: 0.7987; train_kl_reg_loss: 86873.8930; train_edge_recon_loss: 3014268.2083; train_gene_expr_recon_loss: 12648700.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81460.0514; train_chrom_access_recon_loss: 11443987.6667; train_global_loss: 27275290.2727; train_optim_loss: 27275290.2727; val_kl_reg_loss: 95152.8721; val_edge_recon_loss: 2956643.0000; val_gene_expr_recon_loss: 12752899.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73002.0391; val_chrom_access_recon_loss: 11659195.8750; val_global_loss: 27536894.0000; val_optim_loss: 27536894.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8413; val_auprc_score: 0.8031; val_best_acc_score: 0.7671; val_best_f1_score: 0.7908; train_kl_reg_loss: 92781.6352; train_edge_recon_loss: 2950201.5909; train_gene_expr_recon_loss: 12566364.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66785.5429; train_chrom_access_recon_loss: 11368080.4242; train_global_loss: 27044214.2424; train_optim_loss: 27044214.2424; val_kl_reg_loss: 94399.0938; val_edge_recon_loss: 2954133.0312; val_gene_expr_recon_loss: 12660630.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61076.2031; val_chrom_access_recon_loss: 11583176.8750; val_global_loss: 27353415.2500; val_optim_loss: 27353415.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8581; val_auprc_score: 0.8238; val_best_acc_score: 0.7754; val_best_f1_score: 0.8042; train_kl_reg_loss: 92626.3461; train_edge_recon_loss: 2925459.8826; train_gene_expr_recon_loss: 12512243.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56630.4824; train_chrom_access_recon_loss: 11326253.2424; train_global_loss: 26913213.3939; train_optim_loss: 26913213.3939; val_kl_reg_loss: 86345.0986; val_edge_recon_loss: 2901569.1562; val_gene_expr_recon_loss: 12595653.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52538.3672; val_chrom_access_recon_loss: 11507334.7500; val_global_loss: 27143440.7500; val_optim_loss: 27143440.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8657; val_auprc_score: 0.8244; val_best_acc_score: 0.7851; val_best_f1_score: 0.8138; train_kl_reg_loss: 90424.9693; train_edge_recon_loss: 2908697.4091; train_gene_expr_recon_loss: 12456943.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49584.1362; train_chrom_access_recon_loss: 11275004.8030; train_global_loss: 26780655.0909; train_optim_loss: 26780655.0909; val_kl_reg_loss: 85854.2295; val_edge_recon_loss: 2897923.8125; val_gene_expr_recon_loss: 12489915.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46803.8203; val_chrom_access_recon_loss: 11410766.3750; val_global_loss: 26931264.2500; val_optim_loss: 26931264.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8690; val_auprc_score: 0.8323; val_best_acc_score: 0.7993; val_best_f1_score: 0.8213; train_kl_reg_loss: 85347.3585; train_edge_recon_loss: 2883202.9545; train_gene_expr_recon_loss: 12408520.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44690.4060; train_chrom_access_recon_loss: 11237895.6818; train_global_loss: 26659657.0303; train_optim_loss: 26659657.0303; val_kl_reg_loss: 85225.9756; val_edge_recon_loss: 2894778.7188; val_gene_expr_recon_loss: 12544398.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43036.2734; val_chrom_access_recon_loss: 11323890.6250; val_global_loss: 26891330.2500; val_optim_loss: 26891330.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8919; val_auprc_score: 0.8537; val_best_acc_score: 0.8165; val_best_f1_score: 0.8367; train_kl_reg_loss: 85840.3414; train_edge_recon_loss: 2843113.8826; train_gene_expr_recon_loss: 12341664.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41638.4918; train_chrom_access_recon_loss: 11178269.6970; train_global_loss: 26490526.7879; train_optim_loss: 26490526.7879; val_kl_reg_loss: 81940.9824; val_edge_recon_loss: 2822145.1250; val_gene_expr_recon_loss: 12451386.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40324.3477; val_chrom_access_recon_loss: 11173403.0000; val_global_loss: 26569199.2500; val_optim_loss: 26569199.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9005; val_auprc_score: 0.8679; val_best_acc_score: 0.8321; val_best_f1_score: 0.8453; train_kl_reg_loss: 86454.4089; train_edge_recon_loss: 2811793.7576; train_gene_expr_recon_loss: 12305162.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39429.1317; train_chrom_access_recon_loss: 11146740.1061; train_global_loss: 26389579.8485; train_optim_loss: 26389579.8485; val_kl_reg_loss: 84132.4170; val_edge_recon_loss: 2833428.2812; val_gene_expr_recon_loss: 12347939.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38691.0156; val_chrom_access_recon_loss: 11219853.3750; val_global_loss: 26524045.2500; val_optim_loss: 26524045.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9043; val_auprc_score: 0.8673; val_best_acc_score: 0.8420; val_best_f1_score: 0.8578; train_kl_reg_loss: 85979.7598; train_edge_recon_loss: 2798317.5909; train_gene_expr_recon_loss: 12261221.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37931.3638; train_chrom_access_recon_loss: 11104750.0455; train_global_loss: 26288200.4242; train_optim_loss: 26288200.4242; val_kl_reg_loss: 84309.4443; val_edge_recon_loss: 2837219.6562; val_gene_expr_recon_loss: 12307821.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37441.6992; val_chrom_access_recon_loss: 11165250.1250; val_global_loss: 26432043.2500; val_optim_loss: 26432043.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9132; val_auprc_score: 0.8834; val_best_acc_score: 0.8522; val_best_f1_score: 0.8636; train_kl_reg_loss: 86124.4324; train_edge_recon_loss: 2792263.8258; train_gene_expr_recon_loss: 12238141.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37019.3973; train_chrom_access_recon_loss: 11083023.0606; train_global_loss: 26236571.8788; train_optim_loss: 26236571.8788; val_kl_reg_loss: 82023.5723; val_edge_recon_loss: 2817917.0000; val_gene_expr_recon_loss: 12352681.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36701.6055; val_chrom_access_recon_loss: 11118085.2500; val_global_loss: 26407409.5000; val_optim_loss: 26407409.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9118; val_auprc_score: 0.8756; val_best_acc_score: 0.8471; val_best_f1_score: 0.8583; train_kl_reg_loss: 85015.7602; train_edge_recon_loss: 2777304.7348; train_gene_expr_recon_loss: 12196240.4394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36303.5745; train_chrom_access_recon_loss: 11049818.0758; train_global_loss: 26144682.5758; train_optim_loss: 26144682.5758; val_kl_reg_loss: 83277.0166; val_edge_recon_loss: 2808374.1562; val_gene_expr_recon_loss: 12256672.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36104.3203; val_chrom_access_recon_loss: 11166136.6250; val_global_loss: 26350564.2500; val_optim_loss: 26350564.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9255; val_auprc_score: 0.8904; val_best_acc_score: 0.8665; val_best_f1_score: 0.8731; train_kl_reg_loss: 84055.8836; train_edge_recon_loss: 2759322.8902; train_gene_expr_recon_loss: 12164777.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35902.5808; train_chrom_access_recon_loss: 11010873.0455; train_global_loss: 26054932.1515; train_optim_loss: 26054932.1515; val_kl_reg_loss: 82145.2715; val_edge_recon_loss: 2772747.9688; val_gene_expr_recon_loss: 12309407.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35657.4492; val_chrom_access_recon_loss: 11165012.6250; val_global_loss: 26364971.0000; val_optim_loss: 26364971.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9267; val_auprc_score: 0.9059; val_best_acc_score: 0.8659; val_best_f1_score: 0.8739; train_kl_reg_loss: 83396.0211; train_edge_recon_loss: 2748894.3485; train_gene_expr_recon_loss: 12129890.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35471.3859; train_chrom_access_recon_loss: 10991988.9848; train_global_loss: 25989641.0303; train_optim_loss: 25989641.0303; val_kl_reg_loss: 79866.5547; val_edge_recon_loss: 2771412.8125; val_gene_expr_recon_loss: 12207640.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35332.4570; val_chrom_access_recon_loss: 11103635.2500; val_global_loss: 26197887.2500; val_optim_loss: 26197887.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9270; val_auprc_score: 0.8953; val_best_acc_score: 0.8710; val_best_f1_score: 0.8787; train_kl_reg_loss: 81756.3279; train_edge_recon_loss: 2742352.9811; train_gene_expr_recon_loss: 12101325.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35099.6423; train_chrom_access_recon_loss: 10949434.7424; train_global_loss: 25909969.4545; train_optim_loss: 25909969.4545; val_kl_reg_loss: 79702.3145; val_edge_recon_loss: 2751451.0625; val_gene_expr_recon_loss: 12158816.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34894.7812; val_chrom_access_recon_loss: 11027276.1250; val_global_loss: 26052141.0000; val_optim_loss: 26052141.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9302; val_auprc_score: 0.9013; val_best_acc_score: 0.8759; val_best_f1_score: 0.8814; train_kl_reg_loss: 80654.6194; train_edge_recon_loss: 2748040.7538; train_gene_expr_recon_loss: 12071833.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34721.3841; train_chrom_access_recon_loss: 10926876.0455; train_global_loss: 25862126.6061; train_optim_loss: 25862126.6061; val_kl_reg_loss: 79595.6045; val_edge_recon_loss: 2750383.0312; val_gene_expr_recon_loss: 12128564.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34433.4219; val_chrom_access_recon_loss: 11033787.3750; val_global_loss: 26026763.5000; val_optim_loss: 26026763.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9299; val_auprc_score: 0.9070; val_best_acc_score: 0.8753; val_best_f1_score: 0.8811; train_kl_reg_loss: 79185.4161; train_edge_recon_loss: 2731523.5379; train_gene_expr_recon_loss: 12038051.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34216.3799; train_chrom_access_recon_loss: 10892867.2576; train_global_loss: 25775843.7273; train_optim_loss: 25775843.7273; val_kl_reg_loss: 77293.2666; val_edge_recon_loss: 2756223.9375; val_gene_expr_recon_loss: 12125343.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34075.1094; val_chrom_access_recon_loss: 11004670.3750; val_global_loss: 25997605.7500; val_optim_loss: 25997605.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9267; val_auprc_score: 0.9024; val_best_acc_score: 0.8681; val_best_f1_score: 0.8767; train_kl_reg_loss: 77742.2960; train_edge_recon_loss: 2738490.2576; train_gene_expr_recon_loss: 12017182.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33904.3461; train_chrom_access_recon_loss: 10871031.1364; train_global_loss: 25738350.6061; train_optim_loss: 25738350.6061; val_kl_reg_loss: 77136.5361; val_edge_recon_loss: 2788982.2812; val_gene_expr_recon_loss: 12033209.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33754.7461; val_chrom_access_recon_loss: 10985726.0000; val_global_loss: 25918809.2500; val_optim_loss: 25918809.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9338; val_auprc_score: 0.9089; val_best_acc_score: 0.8761; val_best_f1_score: 0.8833; train_kl_reg_loss: 76191.3224; train_edge_recon_loss: 2719286.7159; train_gene_expr_recon_loss: 11991757.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33631.6206; train_chrom_access_recon_loss: 10839026.1364; train_global_loss: 25659893.9091; train_optim_loss: 25659893.9091; val_kl_reg_loss: 76398.0645; val_edge_recon_loss: 2770845.3125; val_gene_expr_recon_loss: 12081587.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33513.5742; val_chrom_access_recon_loss: 10962052.5000; val_global_loss: 25924397.2500; val_optim_loss: 25924397.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9351; val_auprc_score: 0.9106; val_best_acc_score: 0.8764; val_best_f1_score: 0.8826; train_kl_reg_loss: 76749.6289; train_edge_recon_loss: 2719956.7765; train_gene_expr_recon_loss: 11961123.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33378.4154; train_chrom_access_recon_loss: 10809854.5909; train_global_loss: 25601063.2424; train_optim_loss: 25601063.2424; val_kl_reg_loss: 74608.8848; val_edge_recon_loss: 2766579.9375; val_gene_expr_recon_loss: 11982163.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33327.8828; val_chrom_access_recon_loss: 10918166.7500; val_global_loss: 25774846.2500; val_optim_loss: 25774846.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9406; val_auprc_score: 0.9178; val_best_acc_score: 0.8855; val_best_f1_score: 0.8920; train_kl_reg_loss: 75182.2250; train_edge_recon_loss: 2702236.9129; train_gene_expr_recon_loss: 11948874.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33136.0811; train_chrom_access_recon_loss: 10801195.0000; train_global_loss: 25560624.3636; train_optim_loss: 25560624.3636; val_kl_reg_loss: 74199.6465; val_edge_recon_loss: 2717390.5938; val_gene_expr_recon_loss: 12058232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32984.9258; val_chrom_access_recon_loss: 10935341.5000; val_global_loss: 25818148.5000; val_optim_loss: 25818148.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9390; val_auprc_score: 0.9189; val_best_acc_score: 0.8794; val_best_f1_score: 0.8856; train_kl_reg_loss: 73017.0901; train_edge_recon_loss: 2723138.3258; train_gene_expr_recon_loss: 11927629.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32947.0421; train_chrom_access_recon_loss: 10778550.7727; train_global_loss: 25535282.9394; train_optim_loss: 25535282.9394; val_kl_reg_loss: 71163.1221; val_edge_recon_loss: 2781849.2812; val_gene_expr_recon_loss: 12068822.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32941.9297; val_chrom_access_recon_loss: 10915406.1250; val_global_loss: 25870182.7500; val_optim_loss: 25870182.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9371; val_auprc_score: 0.9055; val_best_acc_score: 0.8877; val_best_f1_score: 0.8922; train_kl_reg_loss: 71543.4947; train_edge_recon_loss: 2706531.0076; train_gene_expr_recon_loss: 11906402.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32787.7834; train_chrom_access_recon_loss: 10764328.0303; train_global_loss: 25481592.6970; train_optim_loss: 25481592.6970; val_kl_reg_loss: 71470.8447; val_edge_recon_loss: 2728186.7812; val_gene_expr_recon_loss: 12063138.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32706.5742; val_chrom_access_recon_loss: 10952601.3750; val_global_loss: 25848104.5000; val_optim_loss: 25848104.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9410; val_auprc_score: 0.9189; val_best_acc_score: 0.8893; val_best_f1_score: 0.8937; train_kl_reg_loss: 72162.8436; train_edge_recon_loss: 2696696.4356; train_gene_expr_recon_loss: 11888298.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32554.1821; train_chrom_access_recon_loss: 10733764.1818; train_global_loss: 25423476.7273; train_optim_loss: 25423476.7273; val_kl_reg_loss: 70027.4902; val_edge_recon_loss: 2737997.2188; val_gene_expr_recon_loss: 12007924.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32573.2949; val_chrom_access_recon_loss: 10801500.1250; val_global_loss: 25650021.5000; val_optim_loss: 25650021.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9445; val_auprc_score: 0.9241; val_best_acc_score: 0.8882; val_best_f1_score: 0.8935; train_kl_reg_loss: 70741.4018; train_edge_recon_loss: 2707067.7008; train_gene_expr_recon_loss: 11861896.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32432.2617; train_chrom_access_recon_loss: 10700665.8182; train_global_loss: 25372804.0303; train_optim_loss: 25372804.0303; val_kl_reg_loss: 70093.6289; val_edge_recon_loss: 2720938.6250; val_gene_expr_recon_loss: 11987680.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32419.4609; val_chrom_access_recon_loss: 10901502.2500; val_global_loss: 25712633.7500; val_optim_loss: 25712633.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9446; val_auprc_score: 0.9268; val_best_acc_score: 0.8877; val_best_f1_score: 0.8929; train_kl_reg_loss: 70566.2544; train_edge_recon_loss: 2693418.1288; train_gene_expr_recon_loss: 11837474.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32327.1978; train_chrom_access_recon_loss: 10679757.8788; train_global_loss: 25313543.5758; train_optim_loss: 25313543.5758; val_kl_reg_loss: 69820.3447; val_edge_recon_loss: 2733509.7812; val_gene_expr_recon_loss: 11922306.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32288.8301; val_chrom_access_recon_loss: 10869333.6250; val_global_loss: 25627259.5000; val_optim_loss: 25627259.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9423; val_auprc_score: 0.9162; val_best_acc_score: 0.8858; val_best_f1_score: 0.8922; train_kl_reg_loss: 68974.7210; train_edge_recon_loss: 2703632.6780; train_gene_expr_recon_loss: 11831018.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32243.0227; train_chrom_access_recon_loss: 10675356.4697; train_global_loss: 25311225.9091; train_optim_loss: 25311225.9091; val_kl_reg_loss: 69666.7744; val_edge_recon_loss: 2727402.0000; val_gene_expr_recon_loss: 11912835.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32308.0195; val_chrom_access_recon_loss: 10751200.6250; val_global_loss: 25493413.0000; val_optim_loss: 25493413.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9460; val_auprc_score: 0.9254; val_best_acc_score: 0.8917; val_best_f1_score: 0.8974; train_kl_reg_loss: 68416.8623; train_edge_recon_loss: 2703651.3674; train_gene_expr_recon_loss: 11814812.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32196.7987; train_chrom_access_recon_loss: 10660302.9394; train_global_loss: 25279380.8788; train_optim_loss: 25279380.8788; val_kl_reg_loss: 67963.5645; val_edge_recon_loss: 2733161.9062; val_gene_expr_recon_loss: 11832196.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32168.2891; val_chrom_access_recon_loss: 10767330.1250; val_global_loss: 25432820.2500; val_optim_loss: 25432820.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9446; val_auprc_score: 0.9259; val_best_acc_score: 0.8861; val_best_f1_score: 0.8907; train_kl_reg_loss: 68536.6764; train_edge_recon_loss: 2700046.1705; train_gene_expr_recon_loss: 11799657.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32130.5123; train_chrom_access_recon_loss: 10645769.4394; train_global_loss: 25246140.4545; train_optim_loss: 25246140.4545; val_kl_reg_loss: 67727.1738; val_edge_recon_loss: 2744812.5938; val_gene_expr_recon_loss: 11894133.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32268.0547; val_chrom_access_recon_loss: 10768095.2500; val_global_loss: 25507036.0000; val_optim_loss: 25507036.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9509; val_auprc_score: 0.9301; val_best_acc_score: 0.9017; val_best_f1_score: 0.9042; train_kl_reg_loss: 67690.8308; train_edge_recon_loss: 2695603.2765; train_gene_expr_recon_loss: 11768143.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32111.9126; train_chrom_access_recon_loss: 10609835.4848; train_global_loss: 25173384.8485; train_optim_loss: 25173384.8485; val_kl_reg_loss: 66853.6934; val_edge_recon_loss: 2697485.1875; val_gene_expr_recon_loss: 11938329.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32051.4219; val_chrom_access_recon_loss: 10794123.6250; val_global_loss: 25528842.7500; val_optim_loss: 25528842.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9498; val_auprc_score: 0.9305; val_best_acc_score: 0.8958; val_best_f1_score: 0.8987; train_kl_reg_loss: 67845.9643; train_edge_recon_loss: 2692205.1250; train_gene_expr_recon_loss: 11767997.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31999.4941; train_chrom_access_recon_loss: 10609719.5909; train_global_loss: 25169767.9697; train_optim_loss: 25169767.9697; val_kl_reg_loss: 67128.8765; val_edge_recon_loss: 2710863.9688; val_gene_expr_recon_loss: 11898206.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32006.2559; val_chrom_access_recon_loss: 10815181.3750; val_global_loss: 25523386.0000; val_optim_loss: 25523386.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9464; val_auprc_score: 0.9277; val_best_acc_score: 0.8941; val_best_f1_score: 0.8972; train_kl_reg_loss: 66927.4725; train_edge_recon_loss: 2679865.4129; train_gene_expr_recon_loss: 11745860.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31981.5610; train_chrom_access_recon_loss: 10581031.0758; train_global_loss: 25105666.2121; train_optim_loss: 25105666.2121; val_kl_reg_loss: 66933.6357; val_edge_recon_loss: 2732264.1875; val_gene_expr_recon_loss: 11834808.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32008.8047; val_chrom_access_recon_loss: 10701240.1250; val_global_loss: 25367255.5000; val_optim_loss: 25367255.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9491; val_auprc_score: 0.9298; val_best_acc_score: 0.8931; val_best_f1_score: 0.8974; train_kl_reg_loss: 65798.2140; train_edge_recon_loss: 2686589.3523; train_gene_expr_recon_loss: 11732636.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32008.9783; train_chrom_access_recon_loss: 10575924.6515; train_global_loss: 25092957.4545; train_optim_loss: 25092957.4545; val_kl_reg_loss: 65866.6807; val_edge_recon_loss: 2725996.7500; val_gene_expr_recon_loss: 11726191.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31958.1641; val_chrom_access_recon_loss: 10579810.0000; val_global_loss: 25129822.7500; val_optim_loss: 25129822.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9475; val_auprc_score: 0.9233; val_best_acc_score: 0.8936; val_best_f1_score: 0.8968; train_kl_reg_loss: 65499.0350; train_edge_recon_loss: 2682136.7273; train_gene_expr_recon_loss: 11722194.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31996.2389; train_chrom_access_recon_loss: 10542765.5000; train_global_loss: 25044592.3333; train_optim_loss: 25044592.3333; val_kl_reg_loss: 66978.2783; val_edge_recon_loss: 2734831.0625; val_gene_expr_recon_loss: 11706044.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32105.6465; val_chrom_access_recon_loss: 10590418.8750; val_global_loss: 25130379.2500; val_optim_loss: 25130379.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9527; val_auprc_score: 0.9363; val_best_acc_score: 0.8971; val_best_f1_score: 0.9015; train_kl_reg_loss: 65256.6781; train_edge_recon_loss: 2684121.0303; train_gene_expr_recon_loss: 11713371.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32029.1417; train_chrom_access_recon_loss: 10547320.7576; train_global_loss: 25042098.9697; train_optim_loss: 25042098.9697; val_kl_reg_loss: 64986.1118; val_edge_recon_loss: 2717233.1562; val_gene_expr_recon_loss: 11804314.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32162.6348; val_chrom_access_recon_loss: 10698563.2500; val_global_loss: 25317260.7500; val_optim_loss: 25317260.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9566; val_auprc_score: 0.9413; val_best_acc_score: 0.9046; val_best_f1_score: 0.9070; train_kl_reg_loss: 64188.8604; train_edge_recon_loss: 2679575.8788; train_gene_expr_recon_loss: 11694664.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32105.9637; train_chrom_access_recon_loss: 10521704.4242; train_global_loss: 24992239.6970; train_optim_loss: 24992239.6970; val_kl_reg_loss: 63013.2856; val_edge_recon_loss: 2721861.2188; val_gene_expr_recon_loss: 11839553.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32092.8945; val_chrom_access_recon_loss: 10694788.1250; val_global_loss: 25351308.7500; val_optim_loss: 25351308.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9546; val_auprc_score: 0.9374; val_best_acc_score: 0.9027; val_best_f1_score: 0.9070; train_kl_reg_loss: 64111.2855; train_edge_recon_loss: 2680798.0000; train_gene_expr_recon_loss: 11688231.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32015.9898; train_chrom_access_recon_loss: 10507168.5000; train_global_loss: 24972325.1515; train_optim_loss: 24972325.1515; val_kl_reg_loss: 62839.6123; val_edge_recon_loss: 2724922.2500; val_gene_expr_recon_loss: 11801743.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31997.4980; val_chrom_access_recon_loss: 10672170.5000; val_global_loss: 25293672.5000; val_optim_loss: 25293672.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9517; val_auprc_score: 0.9276; val_best_acc_score: 0.8998; val_best_f1_score: 0.9028; train_kl_reg_loss: 64046.9078; train_edge_recon_loss: 2675094.6591; train_gene_expr_recon_loss: 11675727.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28159.6892; train_chrom_access_recon_loss: 10497323.0606; train_global_loss: 24940351.8182; train_optim_loss: 24940351.8182; val_kl_reg_loss: 63991.3970; val_edge_recon_loss: 2732420.2812; val_gene_expr_recon_loss: 11745407.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27068.0840; val_chrom_access_recon_loss: 10660432.8750; val_global_loss: 25229319.7500; val_optim_loss: 25229319.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9576; val_auprc_score: 0.9451; val_best_acc_score: 0.9057; val_best_f1_score: 0.9078; train_kl_reg_loss: 64627.8301; train_edge_recon_loss: 2672538.7424; train_gene_expr_recon_loss: 11666390.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26945.7755; train_chrom_access_recon_loss: 10483213.2273; train_global_loss: 24913715.6364; train_optim_loss: 24913715.6364; val_kl_reg_loss: 64240.5083; val_edge_recon_loss: 2702477.8750; val_gene_expr_recon_loss: 11730683.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26856.6777; val_chrom_access_recon_loss: 10616836.2500; val_global_loss: 25141095.2500; val_optim_loss: 25141095.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9563; val_auprc_score: 0.9418; val_best_acc_score: 0.9035; val_best_f1_score: 0.9059; train_kl_reg_loss: 64537.9840; train_edge_recon_loss: 2676062.5795; train_gene_expr_recon_loss: 11657682.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26807.6495; train_chrom_access_recon_loss: 10479083.4697; train_global_loss: 24904174.3333; train_optim_loss: 24904174.3333; val_kl_reg_loss: 64623.4697; val_edge_recon_loss: 2700689.8438; val_gene_expr_recon_loss: 11890552.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26771.1855; val_chrom_access_recon_loss: 10805496.7500; val_global_loss: 25488134.0000; val_optim_loss: 25488134.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9545; val_auprc_score: 0.9380; val_best_acc_score: 0.9017; val_best_f1_score: 0.9053; train_kl_reg_loss: 64784.3323; train_edge_recon_loss: 2684736.6364; train_gene_expr_recon_loss: 11667227.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26734.8589; train_chrom_access_recon_loss: 10494322.1818; train_global_loss: 24937805.8182; train_optim_loss: 24937805.8182; val_kl_reg_loss: 64829.1284; val_edge_recon_loss: 2722466.0938; val_gene_expr_recon_loss: 11846885.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26712.4668; val_chrom_access_recon_loss: 10691103.7500; val_global_loss: 25351996.5000; val_optim_loss: 25351996.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 25 min 40 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9496
val AUPRC score: 0.9332
val best accuracy score: 0.8941
val best F1 score: 0.8973
val target rna MSE score: 1.0195
val source rna MSE score: 0.3101
val target atac MSE score: 0.3301
val source atac MSE score: 0.0727
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
