Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9795; val_auprc_score: 0.9931; val_best_acc_score: 0.9436; val_best_f1_score: 0.9635; train_kl_reg_loss: 4590.5936; train_edge_recon_loss: 124297.7481; train_gene_expr_recon_loss: 123292.8904; train_masked_gp_l1_reg_loss: 2146.6716; train_group_lasso_reg_loss: 0.0000; train_global_loss: 254327.9039; train_optim_loss: 254327.9039; val_kl_reg_loss: 4485.2406; val_edge_recon_loss: 127512.5533; val_gene_expr_recon_loss: 122875.9763; val_masked_gp_l1_reg_loss: 2150.3806; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257024.1455; val_optim_loss: 257024.1455
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9800; val_auprc_score: 0.9931; val_best_acc_score: 0.9458; val_best_f1_score: 0.9649; train_kl_reg_loss: 4585.2567; train_edge_recon_loss: 124318.4586; train_gene_expr_recon_loss: 123152.0159; train_masked_gp_l1_reg_loss: 2154.0467; train_group_lasso_reg_loss: 0.0000; train_global_loss: 254209.7780; train_optim_loss: 254209.7780; val_kl_reg_loss: 4464.4394; val_edge_recon_loss: 127839.6102; val_gene_expr_recon_loss: 122756.3816; val_masked_gp_l1_reg_loss: 2159.6707; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257220.1004; val_optim_loss: 257220.1004
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9804; val_auprc_score: 0.9932; val_best_acc_score: 0.9464; val_best_f1_score: 0.9654; train_kl_reg_loss: 4587.3416; train_edge_recon_loss: 124472.2660; train_gene_expr_recon_loss: 123077.7025; train_masked_gp_l1_reg_loss: 2159.3805; train_group_lasso_reg_loss: 0.0000; train_global_loss: 254296.6906; train_optim_loss: 254296.6906; val_kl_reg_loss: 4433.2911; val_edge_recon_loss: 127330.0778; val_gene_expr_recon_loss: 122640.5554; val_masked_gp_l1_reg_loss: 2162.5996; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256566.5177; val_optim_loss: 256566.5177
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9901; val_auprc_score: 0.9967; val_best_acc_score: 0.9619; val_best_f1_score: 0.9753; train_kl_reg_loss: 4498.9238; train_edge_recon_loss: 124529.4689; train_gene_expr_recon_loss: 129349.1357; train_masked_gp_l1_reg_loss: 2041.8151; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260419.3434; train_optim_loss: 260419.3434; val_kl_reg_loss: 4408.4109; val_edge_recon_loss: 125657.9108; val_gene_expr_recon_loss: 128633.0880; val_masked_gp_l1_reg_loss: 2059.4072; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260758.8171; val_optim_loss: 260758.8171
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9807; val_auprc_score: 0.9934; val_best_acc_score: 0.9468; val_best_f1_score: 0.9656; train_kl_reg_loss: 4576.2125; train_edge_recon_loss: 124331.8349; train_gene_expr_recon_loss: 122976.7148; train_masked_gp_l1_reg_loss: 2163.2409; train_group_lasso_reg_loss: 0.0000; train_global_loss: 254048.0030; train_optim_loss: 254048.0030; val_kl_reg_loss: 4510.5139; val_edge_recon_loss: 127355.8078; val_gene_expr_recon_loss: 122648.9562; val_masked_gp_l1_reg_loss: 2164.6519; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256679.9334; val_optim_loss: 256679.9334
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9808; val_auprc_score: 0.9935; val_best_acc_score: 0.9459; val_best_f1_score: 0.9650; train_kl_reg_loss: 4578.0645; train_edge_recon_loss: 124309.5837; train_gene_expr_recon_loss: 122932.5835; train_masked_gp_l1_reg_loss: 2167.4012; train_group_lasso_reg_loss: 0.0000; train_global_loss: 253987.6329; train_optim_loss: 253987.6329; val_kl_reg_loss: 4425.5878; val_edge_recon_loss: 127249.8393; val_gene_expr_recon_loss: 122529.1611; val_masked_gp_l1_reg_loss: 2168.4255; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256373.0112; val_optim_loss: 256373.0112
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9806; val_auprc_score: 0.9934; val_best_acc_score: 0.9451; val_best_f1_score: 0.9645; train_kl_reg_loss: 4572.7834; train_edge_recon_loss: 124206.8352; train_gene_expr_recon_loss: 122867.3619; train_masked_gp_l1_reg_loss: 2169.1796; train_group_lasso_reg_loss: 0.0000; train_global_loss: 253816.1601; train_optim_loss: 253816.1601; val_kl_reg_loss: 4494.0348; val_edge_recon_loss: 127855.5865; val_gene_expr_recon_loss: 122537.7089; val_masked_gp_l1_reg_loss: 2167.7634; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257055.0941; val_optim_loss: 257055.0941
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9928; val_auprc_score: 0.9976; val_best_acc_score: 0.9682; val_best_f1_score: 0.9794; train_kl_reg_loss: 4604.6213; train_edge_recon_loss: 124857.3604; train_gene_expr_recon_loss: 132300.3459; train_masked_gp_l1_reg_loss: 1996.5143; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263758.8424; train_optim_loss: 263758.8424; val_kl_reg_loss: 4422.3399; val_edge_recon_loss: 125062.8972; val_gene_expr_recon_loss: 131673.9620; val_masked_gp_l1_reg_loss: 2024.0134; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263183.2071; val_optim_loss: 263183.2071
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9912; val_auprc_score: 0.9971; val_best_acc_score: 0.9641; val_best_f1_score: 0.9767; train_kl_reg_loss: 4459.8607; train_edge_recon_loss: 124320.7851; train_gene_expr_recon_loss: 128958.1273; train_masked_gp_l1_reg_loss: 2069.2516; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259808.0247; train_optim_loss: 259808.0247; val_kl_reg_loss: 4399.4651; val_edge_recon_loss: 124924.6976; val_gene_expr_recon_loss: 128268.0849; val_masked_gp_l1_reg_loss: 2076.9492; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259669.1969; val_optim_loss: 259669.1969
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9800; val_auprc_score: 0.9932; val_best_acc_score: 0.9449; val_best_f1_score: 0.9644; train_kl_reg_loss: 4570.4669; train_edge_recon_loss: 124162.0066; train_gene_expr_recon_loss: 122807.3596; train_masked_gp_l1_reg_loss: 2170.9474; train_group_lasso_reg_loss: 0.0000; train_global_loss: 253710.7807; train_optim_loss: 253710.7807; val_kl_reg_loss: 4536.8516; val_edge_recon_loss: 127301.6957; val_gene_expr_recon_loss: 122279.6114; val_masked_gp_l1_reg_loss: 2169.0977; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256287.2529; val_optim_loss: 256287.2529
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9661; val_auprc_score: 0.9839; val_best_acc_score: 0.9499; val_best_f1_score: 0.9677; train_kl_reg_loss: 4949.8392; train_edge_recon_loss: 125777.2320; train_cond_contrastive_loss: 32092.6497; train_gene_expr_recon_loss: 132369.8105; train_masked_gp_l1_reg_loss: 2061.6975; train_group_lasso_reg_loss: 0.0000; train_global_loss: 297251.2289; train_optim_loss: 297251.2289; val_kl_reg_loss: 4817.8826; val_edge_recon_loss: 126108.9996; val_cond_contrastive_loss: 31967.2844; val_gene_expr_recon_loss: 131775.3623; val_masked_gp_l1_reg_loss: 2089.5210; val_group_lasso_reg_loss: 0.0000; val_global_loss: 296759.0601; val_optim_loss: 296759.0601
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9811; val_auprc_score: 0.9935; val_best_acc_score: 0.9467; val_best_f1_score: 0.9655; train_kl_reg_loss: 4573.5602; train_edge_recon_loss: 124330.8375; train_gene_expr_recon_loss: 122763.1236; train_masked_gp_l1_reg_loss: 2172.5544; train_group_lasso_reg_loss: 0.0000; train_global_loss: 253840.0757; train_optim_loss: 253840.0757; val_kl_reg_loss: 4469.6934; val_edge_recon_loss: 128132.2076; val_gene_expr_recon_loss: 122486.1986; val_masked_gp_l1_reg_loss: 2174.3025; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257262.3978; val_optim_loss: 257262.3978
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9800; val_auprc_score: 0.9932; val_best_acc_score: 0.9453; val_best_f1_score: 0.9646; train_kl_reg_loss: 4562.8974; train_edge_recon_loss: 123990.9103; train_gene_expr_recon_loss: 122708.9754; train_masked_gp_l1_reg_loss: 2174.0521; train_group_lasso_reg_loss: 0.0000; train_global_loss: 253436.8351; train_optim_loss: 253436.8351; val_kl_reg_loss: 4527.2647; val_edge_recon_loss: 127234.9848; val_gene_expr_recon_loss: 122300.7278; val_masked_gp_l1_reg_loss: 2175.5889; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256238.5707; val_optim_loss: 256238.5707
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9914; val_auprc_score: 0.9971; val_best_acc_score: 0.9651; val_best_f1_score: 0.9773; train_kl_reg_loss: 4446.6182; train_edge_recon_loss: 124269.8122; train_gene_expr_recon_loss: 128683.6265; train_masked_gp_l1_reg_loss: 2089.2248; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259489.2816; train_optim_loss: 259489.2816; val_kl_reg_loss: 4388.5865; val_edge_recon_loss: 125334.3714; val_gene_expr_recon_loss: 128220.7501; val_masked_gp_l1_reg_loss: 2097.6606; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260041.3645; val_optim_loss: 260041.3645
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9805; val_auprc_score: 0.9934; val_best_acc_score: 0.9468; val_best_f1_score: 0.9657; train_kl_reg_loss: 4564.6708; train_edge_recon_loss: 124125.4428; train_gene_expr_recon_loss: 122695.3891; train_masked_gp_l1_reg_loss: 2177.1957; train_group_lasso_reg_loss: 0.0000; train_global_loss: 253562.6981; train_optim_loss: 253562.6981; val_kl_reg_loss: 4468.0102; val_edge_recon_loss: 126940.9857; val_gene_expr_recon_loss: 122173.0877; val_masked_gp_l1_reg_loss: 2179.6323; val_group_lasso_reg_loss: 0.0000; val_global_loss: 255761.7084; val_optim_loss: 255761.7084
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9813; val_auprc_score: 0.9936; val_best_acc_score: 0.9472; val_best_f1_score: 0.9659; train_kl_reg_loss: 4564.7315; train_edge_recon_loss: 124314.9339; train_gene_expr_recon_loss: 122635.4225; train_masked_gp_l1_reg_loss: 2179.4085; train_group_lasso_reg_loss: 0.0000; train_global_loss: 253694.4963; train_optim_loss: 253694.4963; val_kl_reg_loss: 4504.1742; val_edge_recon_loss: 126914.0171; val_gene_expr_recon_loss: 122292.4218; val_masked_gp_l1_reg_loss: 2183.3838; val_group_lasso_reg_loss: 0.0000; val_global_loss: 255894.0021; val_optim_loss: 255894.0021
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9815; val_auprc_score: 0.9936; val_best_acc_score: 0.9479; val_best_f1_score: 0.9663; train_kl_reg_loss: 4565.3340; train_edge_recon_loss: 124277.9881; train_gene_expr_recon_loss: 122586.3500; train_masked_gp_l1_reg_loss: 2184.5905; train_group_lasso_reg_loss: 0.0000; train_global_loss: 253614.2623; train_optim_loss: 253614.2623; val_kl_reg_loss: 4464.7517; val_edge_recon_loss: 127185.6194; val_gene_expr_recon_loss: 122090.9785; val_masked_gp_l1_reg_loss: 2187.2109; val_group_lasso_reg_loss: 0.0000; val_global_loss: 255928.5639; val_optim_loss: 255928.5639
Run timestamp: 16062023_175352_6.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'vizgen_merfish_human_ovarian_cancer', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', '--n_neighbors', '12', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '1000', '--include_mebocost_gps', '--mebocost_species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', '[encoder,', 'gene_expr_decoder]', '--n_cond_embed', '4', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '100000.0', '--contrastive_logits_pos_ratio', '0.125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5.', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--timestamp_suffix', '_6']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1726.
Number of gene programs after filtering and combining: 1585.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['[encoder,', 'gene_expr_decoder]']
ENCODER -> n_input: 500, n_cond_embed_input: 0, n_layers: 1, n_hidden: 500, n_latent: 803, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 803, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 803, n_cond_embed_input: 0, n_addon_input: 0, n_output: 1000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 759633
Number of validation nodes: 84404
Number of training edges: 5242555
Number of validation edges: 582506
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9374; val_auprc_score: 0.9769; val_best_acc_score: 0.9100; val_best_f1_score: 0.9430; train_kl_reg_loss: 6397.0658; train_edge_recon_loss: 131566.6976; train_cond_contrastive_loss: 33322.9031; train_gene_expr_recon_loss: 140213.5310; train_masked_gp_l1_reg_loss: 1799.0341; train_group_lasso_reg_loss: 0.0000; train_global_loss: 313299.2313; train_optim_loss: 313299.2313; val_kl_reg_loss: 5494.2978; val_edge_recon_loss: 129032.7415; val_cond_contrastive_loss: 32826.6694; val_gene_expr_recon_loss: 132840.5796; val_masked_gp_l1_reg_loss: 2037.7452; val_group_lasso_reg_loss: 0.0000; val_global_loss: 302232.0385; val_optim_loss: 302232.0385
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9812; val_auprc_score: 0.9936; val_best_acc_score: 0.9469; val_best_f1_score: 0.9656; train_kl_reg_loss: 4557.7784; train_edge_recon_loss: 124153.4271; train_gene_expr_recon_loss: 122560.9999; train_masked_gp_l1_reg_loss: 2187.5596; train_group_lasso_reg_loss: 0.0000; train_global_loss: 253459.7649; train_optim_loss: 253459.7649; val_kl_reg_loss: 4502.0812; val_edge_recon_loss: 127678.6870; val_gene_expr_recon_loss: 122158.8163; val_masked_gp_l1_reg_loss: 2185.7324; val_group_lasso_reg_loss: 0.0000; val_global_loss: 256525.3167; val_optim_loss: 256525.3167
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9914; val_auprc_score: 0.9971; val_best_acc_score: 0.9650; val_best_f1_score: 0.9772; train_kl_reg_loss: 4430.0269; train_edge_recon_loss: 124130.0145; train_gene_expr_recon_loss: 128496.1097; train_masked_gp_l1_reg_loss: 2101.9113; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259158.0624; train_optim_loss: 259158.0624; val_kl_reg_loss: 4312.9239; val_edge_recon_loss: 125232.2373; val_gene_expr_recon_loss: 127962.0150; val_masked_gp_l1_reg_loss: 2102.1694; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259609.3437; val_optim_loss: 259609.3437

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9820; val_auprc_score: 0.9939; val_best_acc_score: 0.9489; val_best_f1_score: 0.9669; train_kl_reg_loss: 4541.5809; train_edge_recon_loss: 123793.3112; train_gene_expr_recon_loss: 122004.4387; train_masked_gp_l1_reg_loss: 2147.1201; train_group_lasso_reg_loss: 0.0000; train_global_loss: 252486.4512; train_optim_loss: 252486.4512; val_kl_reg_loss: 4464.5231; val_edge_recon_loss: 126934.5973; val_gene_expr_recon_loss: 121549.9452; val_masked_gp_l1_reg_loss: 2145.1694; val_group_lasso_reg_loss: 0.0000; val_global_loss: 255094.2356; val_optim_loss: 255094.2356
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9935; val_auprc_score: 0.9978; val_best_acc_score: 0.9699; val_best_f1_score: 0.9804; train_kl_reg_loss: 4411.7103; train_edge_recon_loss: 124327.5418; train_gene_expr_recon_loss: 131506.8364; train_masked_gp_l1_reg_loss: 2041.2606; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262287.3487; train_optim_loss: 262287.3487; val_kl_reg_loss: 4350.5919; val_edge_recon_loss: 124341.4764; val_gene_expr_recon_loss: 131159.5115; val_masked_gp_l1_reg_loss: 2053.7144; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261905.2969; val_optim_loss: 261905.2969
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9678; val_auprc_score: 0.9887; val_best_acc_score: 0.9272; val_best_f1_score: 0.9531; train_kl_reg_loss: 3745.6225; train_edge_recon_loss: 126284.6763; train_gene_expr_recon_loss: 135354.7256; train_masked_gp_l1_reg_loss: 2238.7619; train_group_lasso_reg_loss: 0.0000; train_global_loss: 267623.7862; train_optim_loss: 267623.7862; val_kl_reg_loss: 2047.6820; val_edge_recon_loss: 128339.5307; val_gene_expr_recon_loss: 133495.4873; val_masked_gp_l1_reg_loss: 2229.0017; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266111.6996; val_optim_loss: 266111.6996
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9674; val_auprc_score: 0.9841; val_best_acc_score: 0.9540; val_best_f1_score: 0.9704; train_kl_reg_loss: 4775.2679; train_edge_recon_loss: 125118.7133; train_cond_contrastive_loss: 32069.8821; train_gene_expr_recon_loss: 131636.7684; train_masked_gp_l1_reg_loss: 2100.6120; train_group_lasso_reg_loss: 0.0000; train_global_loss: 295701.2438; train_optim_loss: 295701.2438; val_kl_reg_loss: 4554.8813; val_edge_recon_loss: 124984.9646; val_cond_contrastive_loss: 31976.3795; val_gene_expr_recon_loss: 131657.8667; val_masked_gp_l1_reg_loss: 2118.2507; val_group_lasso_reg_loss: 0.0000; val_global_loss: 295292.3417; val_optim_loss: 295292.3417
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9916; val_auprc_score: 0.9972; val_best_acc_score: 0.9657; val_best_f1_score: 0.9777; train_kl_reg_loss: 4424.7039; train_edge_recon_loss: 124015.9271; train_gene_expr_recon_loss: 128364.0580; train_masked_gp_l1_reg_loss: 2113.5843; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258918.2735; train_optim_loss: 258918.2735; val_kl_reg_loss: 4280.8706; val_edge_recon_loss: 125120.9206; val_gene_expr_recon_loss: 127936.9957; val_masked_gp_l1_reg_loss: 2117.3818; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259456.1622; val_optim_loss: 259456.1622
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9695; val_auprc_score: 0.9894; val_best_acc_score: 0.9291; val_best_f1_score: 0.9544; train_kl_reg_loss: 3136.4075; train_edge_recon_loss: 125064.3119; train_gene_expr_recon_loss: 134646.1962; train_masked_gp_l1_reg_loss: 2183.2390; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265030.1546; train_optim_loss: 265030.1546; val_kl_reg_loss: 2227.5045; val_edge_recon_loss: 127822.9883; val_gene_expr_recon_loss: 133900.1994; val_masked_gp_l1_reg_loss: 2132.1650; val_group_lasso_reg_loss: 0.0000; val_global_loss: 266082.8510; val_optim_loss: 266082.8510
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9712; val_auprc_score: 0.9900; val_best_acc_score: 0.9323; val_best_f1_score: 0.9563; train_kl_reg_loss: 2800.6150; train_edge_recon_loss: 124586.2870; train_gene_expr_recon_loss: 133981.7839; train_masked_gp_l1_reg_loss: 2078.8089; train_group_lasso_reg_loss: 0.0000; train_global_loss: 263447.4947; train_optim_loss: 263447.4947; val_kl_reg_loss: 2307.8530; val_edge_recon_loss: 127124.6688; val_gene_expr_recon_loss: 133181.1172; val_masked_gp_l1_reg_loss: 2025.8193; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264639.4513; val_optim_loss: 264639.4513

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9715; val_auprc_score: 0.9900; val_best_acc_score: 0.9326; val_best_f1_score: 0.9564; train_kl_reg_loss: 2694.2780; train_edge_recon_loss: 124281.2130; train_gene_expr_recon_loss: 133459.3675; train_masked_gp_l1_reg_loss: 2019.7569; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262454.6152; train_optim_loss: 262454.6152; val_kl_reg_loss: 2320.5329; val_edge_recon_loss: 127347.1101; val_gene_expr_recon_loss: 133057.1827; val_masked_gp_l1_reg_loss: 2014.5730; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264739.3932; val_optim_loss: 264739.3932
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9922; val_auprc_score: 0.9974; val_best_acc_score: 0.9670; val_best_f1_score: 0.9785; train_kl_reg_loss: 4423.4328; train_edge_recon_loss: 123947.6610; train_gene_expr_recon_loss: 128196.8922; train_masked_gp_l1_reg_loss: 2123.2039; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258691.1902; train_optim_loss: 258691.1902; val_kl_reg_loss: 4374.8562; val_edge_recon_loss: 124852.0502; val_gene_expr_recon_loss: 127768.8340; val_masked_gp_l1_reg_loss: 2128.8848; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259124.6267; val_optim_loss: 259124.6267
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9718; val_auprc_score: 0.9902; val_best_acc_score: 0.9331; val_best_f1_score: 0.9569; train_kl_reg_loss: 2672.0832; train_edge_recon_loss: 124261.0049; train_gene_expr_recon_loss: 133369.9473; train_masked_gp_l1_reg_loss: 2009.6660; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262312.7014; train_optim_loss: 262312.7014; val_kl_reg_loss: 2330.0623; val_edge_recon_loss: 127594.5016; val_gene_expr_recon_loss: 133064.1112; val_masked_gp_l1_reg_loss: 2004.9147; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264993.5872; val_optim_loss: 264993.5872
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9716; val_auprc_score: 0.9902; val_best_acc_score: 0.9328; val_best_f1_score: 0.9567; train_kl_reg_loss: 2643.7178; train_edge_recon_loss: 123963.1507; train_gene_expr_recon_loss: 133299.4762; train_masked_gp_l1_reg_loss: 2000.1300; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261906.4749; train_optim_loss: 261906.4749; val_kl_reg_loss: 2333.9331; val_edge_recon_loss: 127042.7187; val_gene_expr_recon_loss: 132931.4068; val_masked_gp_l1_reg_loss: 1995.3647; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264303.4295; val_optim_loss: 264303.4295
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9942; val_auprc_score: 0.9981; val_best_acc_score: 0.9720; val_best_f1_score: 0.9818; train_kl_reg_loss: 4350.4480; train_edge_recon_loss: 123972.0524; train_gene_expr_recon_loss: 131139.4365; train_masked_gp_l1_reg_loss: 2065.6545; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261527.5913; train_optim_loss: 261527.5913; val_kl_reg_loss: 4265.7704; val_edge_recon_loss: 124529.0236; val_gene_expr_recon_loss: 131033.2802; val_masked_gp_l1_reg_loss: 2069.4619; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261897.5422; val_optim_loss: 261897.5422
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9393; val_auprc_score: 0.9771; val_best_acc_score: 0.9156; val_best_f1_score: 0.9464; train_kl_reg_loss: 5194.2480; train_edge_recon_loss: 127550.2865; train_cond_contrastive_loss: 33200.2770; train_gene_expr_recon_loss: 132236.2904; train_masked_gp_l1_reg_loss: 2076.8203; train_group_lasso_reg_loss: 0.0000; train_global_loss: 300257.9224; train_optim_loss: 300257.9224; val_kl_reg_loss: 5160.7356; val_edge_recon_loss: 127791.9354; val_cond_contrastive_loss: 32874.1003; val_gene_expr_recon_loss: 131362.8111; val_masked_gp_l1_reg_loss: 2105.8123; val_group_lasso_reg_loss: 0.0000; val_global_loss: 299295.3941; val_optim_loss: 299295.3941
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9921; val_auprc_score: 0.9974; val_best_acc_score: 0.9668; val_best_f1_score: 0.9784; train_kl_reg_loss: 4420.2327; train_edge_recon_loss: 123887.7985; train_gene_expr_recon_loss: 128144.7008; train_masked_gp_l1_reg_loss: 2131.2482; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258583.9801; train_optim_loss: 258583.9801; val_kl_reg_loss: 4340.7589; val_edge_recon_loss: 124869.3701; val_gene_expr_recon_loss: 127616.3806; val_masked_gp_l1_reg_loss: 2134.4248; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258960.9354; val_optim_loss: 258960.9354
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9681; val_auprc_score: 0.9844; val_best_acc_score: 0.9548; val_best_f1_score: 0.9709; train_kl_reg_loss: 4722.1868; train_edge_recon_loss: 124788.9961; train_cond_contrastive_loss: 32060.7649; train_gene_expr_recon_loss: 131303.9691; train_masked_gp_l1_reg_loss: 2127.1856; train_group_lasso_reg_loss: 0.0000; train_global_loss: 295003.1025; train_optim_loss: 295003.1025; val_kl_reg_loss: 4556.0132; val_edge_recon_loss: 124681.6137; val_cond_contrastive_loss: 31986.8696; val_gene_expr_recon_loss: 131159.5962; val_masked_gp_l1_reg_loss: 2140.0693; val_group_lasso_reg_loss: 0.0000; val_global_loss: 294524.1553; val_optim_loss: 294524.1553
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9921; val_auprc_score: 0.9973; val_best_acc_score: 0.9672; val_best_f1_score: 0.9787; train_kl_reg_loss: 4418.2900; train_edge_recon_loss: 123824.2208; train_gene_expr_recon_loss: 128069.3646; train_masked_gp_l1_reg_loss: 2138.6224; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258450.4976; train_optim_loss: 258450.4976; val_kl_reg_loss: 4328.2837; val_edge_recon_loss: 124695.2012; val_gene_expr_recon_loss: 127566.9111; val_masked_gp_l1_reg_loss: 2138.8252; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258729.2209; val_optim_loss: 258729.2209

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 129 min 12 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9760
Val AUPRC score: 0.9913
Val best accuracy score: 0.9401
Val best F1 score: 0.9613
Val gene expr MSE score: 15.5073

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9923; val_auprc_score: 0.9974; val_best_acc_score: 0.9679; val_best_f1_score: 0.9792; train_kl_reg_loss: 4422.9195; train_edge_recon_loss: 123985.3666; train_gene_expr_recon_loss: 127988.6849; train_masked_gp_l1_reg_loss: 2144.3242; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258541.2953; train_optim_loss: 258541.2953; val_kl_reg_loss: 4332.5779; val_edge_recon_loss: 124727.5882; val_gene_expr_recon_loss: 127548.4004; val_masked_gp_l1_reg_loss: 2146.9204; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258755.4852; val_optim_loss: 258755.4852
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9943; val_auprc_score: 0.9981; val_best_acc_score: 0.9725; val_best_f1_score: 0.9821; train_kl_reg_loss: 4333.3843; train_edge_recon_loss: 123993.8730; train_gene_expr_recon_loss: 130909.2696; train_masked_gp_l1_reg_loss: 2074.7858; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261311.3125; train_optim_loss: 261311.3125; val_kl_reg_loss: 4211.5702; val_edge_recon_loss: 124315.9488; val_gene_expr_recon_loss: 130730.9171; val_masked_gp_l1_reg_loss: 2075.0305; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261333.4670; val_optim_loss: 261333.4670
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9664; val_auprc_score: 0.9831; val_best_acc_score: 0.9556; val_best_f1_score: 0.9713; train_kl_reg_loss: 4704.8672; train_edge_recon_loss: 124441.3236; train_cond_contrastive_loss: 32046.5680; train_gene_expr_recon_loss: 131091.6000; train_masked_gp_l1_reg_loss: 2143.8011; train_group_lasso_reg_loss: 0.0000; train_global_loss: 294428.1600; train_optim_loss: 294428.1600; val_kl_reg_loss: 4738.1040; val_edge_recon_loss: 124819.0467; val_cond_contrastive_loss: 31818.9789; val_gene_expr_recon_loss: 130986.4645; val_masked_gp_l1_reg_loss: 2145.7422; val_group_lasso_reg_loss: 0.0000; val_global_loss: 294508.3448; val_optim_loss: 294508.3448
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9922; val_auprc_score: 0.9974; val_best_acc_score: 0.9671; val_best_f1_score: 0.9786; train_kl_reg_loss: 4421.4744; train_edge_recon_loss: 123706.0724; train_gene_expr_recon_loss: 127925.2429; train_masked_gp_l1_reg_loss: 2149.7209; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258202.5105; train_optim_loss: 258202.5105; val_kl_reg_loss: 4309.6591; val_edge_recon_loss: 124988.1055; val_gene_expr_recon_loss: 127489.8750; val_masked_gp_l1_reg_loss: 2152.2800; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258939.9210; val_optim_loss: 258939.9210
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9418; val_auprc_score: 0.9778; val_best_acc_score: 0.9214; val_best_f1_score: 0.9501; train_kl_reg_loss: 4991.5573; train_edge_recon_loss: 126734.1286; train_cond_contrastive_loss: 33167.3304; train_gene_expr_recon_loss: 131443.7407; train_masked_gp_l1_reg_loss: 2120.8550; train_group_lasso_reg_loss: 0.0000; train_global_loss: 298457.6122; train_optim_loss: 298457.6122; val_kl_reg_loss: 4911.0824; val_edge_recon_loss: 127291.5620; val_cond_contrastive_loss: 32880.2074; val_gene_expr_recon_loss: 131106.9815; val_masked_gp_l1_reg_loss: 2130.4485; val_group_lasso_reg_loss: 0.0000; val_global_loss: 298320.2706; val_optim_loss: 298320.2706
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9925; val_auprc_score: 0.9975; val_best_acc_score: 0.9683; val_best_f1_score: 0.9794; train_kl_reg_loss: 4416.1712; train_edge_recon_loss: 123761.9081; train_gene_expr_recon_loss: 127859.2740; train_masked_gp_l1_reg_loss: 2153.1247; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258190.4784; train_optim_loss: 258190.4784; val_kl_reg_loss: 4370.5897; val_edge_recon_loss: 124720.0467; val_gene_expr_recon_loss: 127441.3605; val_masked_gp_l1_reg_loss: 2158.4253; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258690.4221; val_optim_loss: 258690.4221
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9945; val_auprc_score: 0.9982; val_best_acc_score: 0.9732; val_best_f1_score: 0.9826; train_kl_reg_loss: 4321.3369; train_edge_recon_loss: 123761.3218; train_gene_expr_recon_loss: 130741.2056; train_masked_gp_l1_reg_loss: 2076.2340; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260900.0982; train_optim_loss: 260900.0982; val_kl_reg_loss: 4289.3097; val_edge_recon_loss: 124228.8061; val_gene_expr_recon_loss: 130594.2825; val_masked_gp_l1_reg_loss: 2076.3196; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261188.7109; val_optim_loss: 261188.7109
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9926; val_auprc_score: 0.9975; val_best_acc_score: 0.9687; val_best_f1_score: 0.9797; train_kl_reg_loss: 4420.7900; train_edge_recon_loss: 123935.4420; train_gene_expr_recon_loss: 127831.2389; train_masked_gp_l1_reg_loss: 2157.0220; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258344.4926; train_optim_loss: 258344.4926; val_kl_reg_loss: 4337.4274; val_edge_recon_loss: 124657.0121; val_gene_expr_recon_loss: 127351.9530; val_masked_gp_l1_reg_loss: 2162.4070; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258508.7996; val_optim_loss: 258508.7996
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9665; val_auprc_score: 0.9832; val_best_acc_score: 0.9559; val_best_f1_score: 0.9715; train_kl_reg_loss: 4690.4703; train_edge_recon_loss: 124380.2256; train_cond_contrastive_loss: 32037.2332; train_gene_expr_recon_loss: 130958.2847; train_masked_gp_l1_reg_loss: 2150.1768; train_group_lasso_reg_loss: 0.0000; train_global_loss: 294216.3903; train_optim_loss: 294216.3903; val_kl_reg_loss: 4671.5227; val_edge_recon_loss: 124797.9408; val_cond_contrastive_loss: 31847.2737; val_gene_expr_recon_loss: 130913.3905; val_masked_gp_l1_reg_loss: 2154.2964; val_group_lasso_reg_loss: 0.0000; val_global_loss: 294384.4093; val_optim_loss: 294384.4093
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9927; val_auprc_score: 0.9975; val_best_acc_score: 0.9693; val_best_f1_score: 0.9801; train_kl_reg_loss: 4421.5697; train_edge_recon_loss: 123683.4625; train_gene_expr_recon_loss: 127798.8524; train_masked_gp_l1_reg_loss: 2159.7275; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258063.6121; train_optim_loss: 258063.6121; val_kl_reg_loss: 4295.0185; val_edge_recon_loss: 125238.0514; val_gene_expr_recon_loss: 127292.2863; val_masked_gp_l1_reg_loss: 2160.0100; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258985.3684; val_optim_loss: 258985.3684
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9415; val_auprc_score: 0.9775; val_best_acc_score: 0.9220; val_best_f1_score: 0.9505; train_kl_reg_loss: 4929.0288; train_edge_recon_loss: 126343.6055; train_cond_contrastive_loss: 33099.1274; train_gene_expr_recon_loss: 131106.3290; train_masked_gp_l1_reg_loss: 2136.0588; train_group_lasso_reg_loss: 0.0000; train_global_loss: 297614.1497; train_optim_loss: 297614.1497; val_kl_reg_loss: 4940.7133; val_edge_recon_loss: 126859.2706; val_cond_contrastive_loss: 32777.6840; val_gene_expr_recon_loss: 130767.3384; val_masked_gp_l1_reg_loss: 2141.4263; val_group_lasso_reg_loss: 0.0000; val_global_loss: 297486.4432; val_optim_loss: 297486.4432
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9928; val_auprc_score: 0.9976; val_best_acc_score: 0.9691; val_best_f1_score: 0.9799; train_kl_reg_loss: 4424.0250; train_edge_recon_loss: 123778.2187; train_gene_expr_recon_loss: 127770.6377; train_masked_gp_l1_reg_loss: 2161.5280; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258134.4092; train_optim_loss: 258134.4092; val_kl_reg_loss: 4361.9301; val_edge_recon_loss: 124959.0224; val_gene_expr_recon_loss: 127384.0004; val_masked_gp_l1_reg_loss: 2169.1233; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258874.0776; val_optim_loss: 258874.0776
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9946; val_auprc_score: 0.9982; val_best_acc_score: 0.9732; val_best_f1_score: 0.9826; train_kl_reg_loss: 4316.0197; train_edge_recon_loss: 123669.3243; train_gene_expr_recon_loss: 130622.9617; train_masked_gp_l1_reg_loss: 2081.1240; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260689.4297; train_optim_loss: 260689.4297; val_kl_reg_loss: 4339.1356; val_edge_recon_loss: 124278.7333; val_gene_expr_recon_loss: 130591.5983; val_masked_gp_l1_reg_loss: 2087.9966; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261297.4667; val_optim_loss: 261297.4667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9689; val_auprc_score: 0.9848; val_best_acc_score: 0.9578; val_best_f1_score: 0.9728; train_kl_reg_loss: 4683.0486; train_edge_recon_loss: 124347.1734; train_cond_contrastive_loss: 32024.9551; train_gene_expr_recon_loss: 130874.2116; train_masked_gp_l1_reg_loss: 2156.8427; train_group_lasso_reg_loss: 0.0000; train_global_loss: 294086.2312; train_optim_loss: 294086.2312; val_kl_reg_loss: 4566.2786; val_edge_recon_loss: 124407.7018; val_cond_contrastive_loss: 31979.9587; val_gene_expr_recon_loss: 130841.7711; val_masked_gp_l1_reg_loss: 2160.3967; val_group_lasso_reg_loss: 0.0000; val_global_loss: 293956.1158; val_optim_loss: 293956.1158
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9926; val_auprc_score: 0.9975; val_best_acc_score: 0.9693; val_best_f1_score: 0.9800; train_kl_reg_loss: 4423.1105; train_edge_recon_loss: 123840.7694; train_gene_expr_recon_loss: 127726.6154; train_masked_gp_l1_reg_loss: 2163.0608; train_group_lasso_reg_loss: 0.0000; train_global_loss: 258153.5560; train_optim_loss: 258153.5560; val_kl_reg_loss: 4399.0791; val_edge_recon_loss: 124885.1751; val_gene_expr_recon_loss: 127344.2803; val_masked_gp_l1_reg_loss: 2159.9192; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258788.4527; val_optim_loss: 258788.4527

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9933; val_auprc_score: 0.9977; val_best_acc_score: 0.9703; val_best_f1_score: 0.9807; train_kl_reg_loss: 4428.3405; train_edge_recon_loss: 123556.1796; train_gene_expr_recon_loss: 127123.0398; train_masked_gp_l1_reg_loss: 2109.8047; train_group_lasso_reg_loss: 0.0000; train_global_loss: 257217.3642; train_optim_loss: 257217.3642; val_kl_reg_loss: 4365.5087; val_edge_recon_loss: 124925.0632; val_gene_expr_recon_loss: 126833.2749; val_masked_gp_l1_reg_loss: 2106.7017; val_group_lasso_reg_loss: 0.0000; val_global_loss: 258230.5468; val_optim_loss: 258230.5468
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9948; val_auprc_score: 0.9983; val_best_acc_score: 0.9741; val_best_f1_score: 0.9832; train_kl_reg_loss: 4309.0772; train_edge_recon_loss: 123622.2512; train_gene_expr_recon_loss: 130558.2689; train_masked_gp_l1_reg_loss: 2087.0065; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260576.6038; train_optim_loss: 260576.6038; val_kl_reg_loss: 4290.2900; val_edge_recon_loss: 123814.6861; val_gene_expr_recon_loss: 130482.2262; val_masked_gp_l1_reg_loss: 2084.1084; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260671.3054; val_optim_loss: 260671.3054
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9443; val_auprc_score: 0.9791; val_best_acc_score: 0.9240; val_best_f1_score: 0.9517; train_kl_reg_loss: 4897.6874; train_edge_recon_loss: 126186.4598; train_cond_contrastive_loss: 33063.4378; train_gene_expr_recon_loss: 130934.2921; train_masked_gp_l1_reg_loss: 2144.3075; train_group_lasso_reg_loss: 0.0000; train_global_loss: 297226.1844; train_optim_loss: 297226.1844; val_kl_reg_loss: 4796.2942; val_edge_recon_loss: 126382.1872; val_cond_contrastive_loss: 32892.6822; val_gene_expr_recon_loss: 130839.3663; val_masked_gp_l1_reg_loss: 2154.3699; val_group_lasso_reg_loss: 0.0000; val_global_loss: 297064.9055; val_optim_loss: 297064.9055
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9933; val_auprc_score: 0.9977; val_best_acc_score: 0.9706; val_best_f1_score: 0.9809; train_kl_reg_loss: 4430.3886; train_edge_recon_loss: 123423.1811; train_gene_expr_recon_loss: 127055.8885; train_masked_gp_l1_reg_loss: 2107.4366; train_group_lasso_reg_loss: 0.0000; train_global_loss: 257016.8948; train_optim_loss: 257016.8948; val_kl_reg_loss: 4379.4955; val_edge_recon_loss: 124528.3856; val_gene_expr_recon_loss: 126711.2201; val_masked_gp_l1_reg_loss: 2108.7468; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257727.8504; val_optim_loss: 257727.8504
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9696; val_auprc_score: 0.9849; val_best_acc_score: 0.9581; val_best_f1_score: 0.9729; train_kl_reg_loss: 4676.4047; train_edge_recon_loss: 124254.4236; train_cond_contrastive_loss: 32021.6499; train_gene_expr_recon_loss: 130752.1896; train_masked_gp_l1_reg_loss: 2155.4878; train_group_lasso_reg_loss: 0.0000; train_global_loss: 293860.1558; train_optim_loss: 293860.1558; val_kl_reg_loss: 4533.6536; val_edge_recon_loss: 124763.7816; val_cond_contrastive_loss: 32010.9433; val_gene_expr_recon_loss: 130919.3162; val_masked_gp_l1_reg_loss: 2153.6602; val_group_lasso_reg_loss: 0.0000; val_global_loss: 294381.3507; val_optim_loss: 294381.3507
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9936; val_auprc_score: 0.9978; val_best_acc_score: 0.9713; val_best_f1_score: 0.9813; train_kl_reg_loss: 4421.5451; train_edge_recon_loss: 123510.5907; train_gene_expr_recon_loss: 127017.9873; train_masked_gp_l1_reg_loss: 2109.7442; train_group_lasso_reg_loss: 0.0000; train_global_loss: 257059.8673; train_optim_loss: 257059.8673; val_kl_reg_loss: 4361.0091; val_edge_recon_loss: 124679.2014; val_gene_expr_recon_loss: 126713.4361; val_masked_gp_l1_reg_loss: 2111.3164; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257864.9603; val_optim_loss: 257864.9603
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9936; val_auprc_score: 0.9978; val_best_acc_score: 0.9715; val_best_f1_score: 0.9815; train_kl_reg_loss: 4418.6478; train_edge_recon_loss: 123423.6382; train_gene_expr_recon_loss: 126989.6696; train_masked_gp_l1_reg_loss: 2112.5544; train_group_lasso_reg_loss: 0.0000; train_global_loss: 256944.5097; train_optim_loss: 256944.5097; val_kl_reg_loss: 4348.3478; val_edge_recon_loss: 124266.9268; val_gene_expr_recon_loss: 126683.3301; val_masked_gp_l1_reg_loss: 2115.0771; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257413.6808; val_optim_loss: 257413.6808
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9951; val_auprc_score: 0.9983; val_best_acc_score: 0.9751; val_best_f1_score: 0.9838; train_kl_reg_loss: 4305.9180; train_edge_recon_loss: 123668.2110; train_gene_expr_recon_loss: 130490.2693; train_masked_gp_l1_reg_loss: 2091.4668; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260555.8650; train_optim_loss: 260555.8650; val_kl_reg_loss: 4223.6663; val_edge_recon_loss: 124158.0065; val_gene_expr_recon_loss: 130378.6975; val_masked_gp_l1_reg_loss: 2092.8193; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260853.1828; val_optim_loss: 260853.1828
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9400; val_auprc_score: 0.9767; val_best_acc_score: 0.9243; val_best_f1_score: 0.9520; train_kl_reg_loss: 4870.7249; train_edge_recon_loss: 126116.6227; train_cond_contrastive_loss: 33032.8256; train_gene_expr_recon_loss: 130811.3050; train_masked_gp_l1_reg_loss: 2159.5248; train_group_lasso_reg_loss: 0.0000; train_global_loss: 296991.0034; train_optim_loss: 296991.0034; val_kl_reg_loss: 4897.2745; val_edge_recon_loss: 126535.3993; val_cond_contrastive_loss: 32720.0505; val_gene_expr_recon_loss: 130611.6961; val_masked_gp_l1_reg_loss: 2162.3611; val_group_lasso_reg_loss: 0.0000; val_global_loss: 296926.7948; val_optim_loss: 296926.7948
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9935; val_auprc_score: 0.9977; val_best_acc_score: 0.9714; val_best_f1_score: 0.9814; train_kl_reg_loss: 4405.0805; train_edge_recon_loss: 123351.3393; train_gene_expr_recon_loss: 126972.2780; train_masked_gp_l1_reg_loss: 2116.6095; train_group_lasso_reg_loss: 0.0000; train_global_loss: 256845.3074; train_optim_loss: 256845.3074; val_kl_reg_loss: 4346.1028; val_edge_recon_loss: 124754.7182; val_gene_expr_recon_loss: 126669.5645; val_masked_gp_l1_reg_loss: 2117.7542; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257888.1358; val_optim_loss: 257888.1358
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9692; val_auprc_score: 0.9846; val_best_acc_score: 0.9591; val_best_f1_score: 0.9736; train_kl_reg_loss: 4671.1610; train_edge_recon_loss: 124081.9839; train_cond_contrastive_loss: 32019.3499; train_gene_expr_recon_loss: 130741.2888; train_masked_gp_l1_reg_loss: 2151.0938; train_group_lasso_reg_loss: 0.0000; train_global_loss: 293664.8773; train_optim_loss: 293664.8773; val_kl_reg_loss: 4505.1076; val_edge_recon_loss: 124699.2058; val_cond_contrastive_loss: 31970.3664; val_gene_expr_recon_loss: 130769.2028; val_masked_gp_l1_reg_loss: 2146.8625; val_group_lasso_reg_loss: 0.0000; val_global_loss: 294090.7571; val_optim_loss: 294090.7571
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9936; val_auprc_score: 0.9978; val_best_acc_score: 0.9713; val_best_f1_score: 0.9814; train_kl_reg_loss: 4400.8023; train_edge_recon_loss: 123323.4977; train_gene_expr_recon_loss: 126991.7875; train_masked_gp_l1_reg_loss: 2120.0437; train_group_lasso_reg_loss: 0.0000; train_global_loss: 256836.1311; train_optim_loss: 256836.1311; val_kl_reg_loss: 4344.4417; val_edge_recon_loss: 124496.7135; val_gene_expr_recon_loss: 126602.0651; val_masked_gp_l1_reg_loss: 2121.7190; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257564.9397; val_optim_loss: 257564.9397
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9948; val_auprc_score: 0.9983; val_best_acc_score: 0.9740; val_best_f1_score: 0.9831; train_kl_reg_loss: 4304.4786; train_edge_recon_loss: 123566.6419; train_gene_expr_recon_loss: 130411.1808; train_masked_gp_l1_reg_loss: 2095.5298; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260377.8312; train_optim_loss: 260377.8312; val_kl_reg_loss: 4259.7875; val_edge_recon_loss: 124278.0154; val_gene_expr_recon_loss: 130298.7213; val_masked_gp_l1_reg_loss: 2097.2229; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260933.7437; val_optim_loss: 260933.7437
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9936; val_auprc_score: 0.9978; val_best_acc_score: 0.9716; val_best_f1_score: 0.9816; train_kl_reg_loss: 4399.3281; train_edge_recon_loss: 123409.8135; train_gene_expr_recon_loss: 126922.3829; train_masked_gp_l1_reg_loss: 2123.3318; train_group_lasso_reg_loss: 0.0000; train_global_loss: 256854.8562; train_optim_loss: 256854.8562; val_kl_reg_loss: 4330.4014; val_edge_recon_loss: 124358.9695; val_gene_expr_recon_loss: 126569.4726; val_masked_gp_l1_reg_loss: 2124.4248; val_group_lasso_reg_loss: 0.0000; val_global_loss: 257383.2680; val_optim_loss: 257383.2680
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9682; val_auprc_score: 0.9840; val_best_acc_score: 0.9585; val_best_f1_score: 0.9732; train_kl_reg_loss: 4667.3323; train_edge_recon_loss: 124001.0491; train_cond_contrastive_loss: 32015.8525; train_gene_expr_recon_loss: 130697.7410; train_masked_gp_l1_reg_loss: 2148.4869; train_group_lasso_reg_loss: 0.0000; train_global_loss: 293530.4618; train_optim_loss: 293530.4618; val_kl_reg_loss: 4570.8962; val_edge_recon_loss: 124575.3980; val_cond_contrastive_loss: 31936.4341; val_gene_expr_recon_loss: 130634.8511; val_masked_gp_l1_reg_loss: 2145.3689; val_group_lasso_reg_loss: 0.0000; val_global_loss: 293862.9544; val_optim_loss: 293862.9544
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9430; val_auprc_score: 0.9781; val_best_acc_score: 0.9262; val_best_f1_score: 0.9531; train_kl_reg_loss: 4860.9058; train_edge_recon_loss: 125715.2379; train_cond_contrastive_loss: 33006.6221; train_gene_expr_recon_loss: 130737.2137; train_masked_gp_l1_reg_loss: 2172.9525; train_group_lasso_reg_loss: 0.0000; train_global_loss: 296492.9320; train_optim_loss: 296492.9320; val_kl_reg_loss: 4745.4663; val_edge_recon_loss: 126473.0771; val_cond_contrastive_loss: 32792.1935; val_gene_expr_recon_loss: 130652.7732; val_masked_gp_l1_reg_loss: 2181.8040; val_group_lasso_reg_loss: 0.0000; val_global_loss: 296845.3211; val_optim_loss: 296845.3211
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9832; val_auprc_score: 0.9943; val_best_acc_score: 0.9484; val_best_f1_score: 0.9666; train_kl_reg_loss: 3550.7758; train_edge_recon_loss: 125455.9343; train_gene_expr_recon_loss: 134910.9688; train_masked_gp_l1_reg_loss: 2177.4488; train_group_lasso_reg_loss: 0.0000; train_global_loss: 266095.1280; train_optim_loss: 266095.1280; val_kl_reg_loss: 2119.5102; val_edge_recon_loss: 125718.4417; val_gene_expr_recon_loss: 133710.9451; val_masked_gp_l1_reg_loss: 2108.8911; val_group_lasso_reg_loss: 0.0000; val_global_loss: 263657.7960; val_optim_loss: 263657.7960
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9949; val_auprc_score: 0.9983; val_best_acc_score: 0.9748; val_best_f1_score: 0.9837; train_kl_reg_loss: 4306.8681; train_edge_recon_loss: 123494.8062; train_gene_expr_recon_loss: 130382.0742; train_masked_gp_l1_reg_loss: 2096.8519; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260280.6004; train_optim_loss: 260280.6004; val_kl_reg_loss: 4310.7427; val_edge_recon_loss: 123760.4915; val_gene_expr_recon_loss: 130466.3393; val_masked_gp_l1_reg_loss: 2098.3450; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260635.9177; val_optim_loss: 260635.9177
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9858; val_auprc_score: 0.9952; val_best_acc_score: 0.9536; val_best_f1_score: 0.9700; train_kl_reg_loss: 2750.1682; train_edge_recon_loss: 124198.6876; train_gene_expr_recon_loss: 133705.7109; train_masked_gp_l1_reg_loss: 2016.7488; train_group_lasso_reg_loss: 0.0000; train_global_loss: 262671.3158; train_optim_loss: 262671.3158; val_kl_reg_loss: 2329.0767; val_edge_recon_loss: 124978.0059; val_gene_expr_recon_loss: 133112.6546; val_masked_gp_l1_reg_loss: 1940.9500; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262360.6824; val_optim_loss: 262360.6824
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9674; val_auprc_score: 0.9832; val_best_acc_score: 0.9583; val_best_f1_score: 0.9731; train_kl_reg_loss: 4663.3038; train_edge_recon_loss: 123998.2313; train_cond_contrastive_loss: 32004.9243; train_gene_expr_recon_loss: 130628.7713; train_masked_gp_l1_reg_loss: 2143.9599; train_group_lasso_reg_loss: 0.0000; train_global_loss: 293439.1909; train_optim_loss: 293439.1909; val_kl_reg_loss: 4758.4104; val_edge_recon_loss: 124666.4522; val_cond_contrastive_loss: 31834.9023; val_gene_expr_recon_loss: 130581.2111; val_masked_gp_l1_reg_loss: 2144.0620; val_group_lasso_reg_loss: 0.0000; val_global_loss: 293985.0386; val_optim_loss: 293985.0386
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9869; val_auprc_score: 0.9955; val_best_acc_score: 0.9558; val_best_f1_score: 0.9714; train_kl_reg_loss: 2554.4674; train_edge_recon_loss: 123733.5017; train_gene_expr_recon_loss: 133210.6668; train_masked_gp_l1_reg_loss: 1917.1554; train_group_lasso_reg_loss: 0.0000; train_global_loss: 261415.7913; train_optim_loss: 261415.7913; val_kl_reg_loss: 2380.4318; val_edge_recon_loss: 125092.2224; val_gene_expr_recon_loss: 132687.3502; val_masked_gp_l1_reg_loss: 1913.7463; val_group_lasso_reg_loss: 0.0000; val_global_loss: 262073.7538; val_optim_loss: 262073.7538
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9423; val_auprc_score: 0.9779; val_best_acc_score: 0.9247; val_best_f1_score: 0.9521; train_kl_reg_loss: 4851.0572; train_edge_recon_loss: 125845.8655; train_cond_contrastive_loss: 32995.6004; train_gene_expr_recon_loss: 130687.0030; train_masked_gp_l1_reg_loss: 2188.0547; train_group_lasso_reg_loss: 0.0000; train_global_loss: 296567.5807; train_optim_loss: 296567.5807; val_kl_reg_loss: 4707.5017; val_edge_recon_loss: 126841.5135; val_cond_contrastive_loss: 32718.3216; val_gene_expr_recon_loss: 130620.3880; val_masked_gp_l1_reg_loss: 2194.8550; val_group_lasso_reg_loss: 0.0000; val_global_loss: 297082.5683; val_optim_loss: 297082.5683
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9950; val_auprc_score: 0.9983; val_best_acc_score: 0.9757; val_best_f1_score: 0.9842; train_kl_reg_loss: 4306.6403; train_edge_recon_loss: 123472.6028; train_gene_expr_recon_loss: 130344.0741; train_masked_gp_l1_reg_loss: 2097.4473; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260220.7644; train_optim_loss: 260220.7644; val_kl_reg_loss: 4302.1012; val_edge_recon_loss: 124115.7303; val_gene_expr_recon_loss: 130326.6197; val_masked_gp_l1_reg_loss: 2100.6191; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260845.0754; val_optim_loss: 260845.0754

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9870; val_auprc_score: 0.9955; val_best_acc_score: 0.9565; val_best_f1_score: 0.9718; train_kl_reg_loss: 2513.1510; train_edge_recon_loss: 123574.5875; train_gene_expr_recon_loss: 132955.8822; train_masked_gp_l1_reg_loss: 1913.1330; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260956.7537; train_optim_loss: 260956.7537; val_kl_reg_loss: 2383.9061; val_edge_recon_loss: 124812.8601; val_gene_expr_recon_loss: 132693.2807; val_masked_gp_l1_reg_loss: 1913.7487; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261803.7972; val_optim_loss: 261803.7972
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9692; val_auprc_score: 0.9844; val_best_acc_score: 0.9597; val_best_f1_score: 0.9740; train_kl_reg_loss: 4664.0973; train_edge_recon_loss: 124016.8027; train_cond_contrastive_loss: 32003.3302; train_gene_expr_recon_loss: 130623.8071; train_masked_gp_l1_reg_loss: 2144.6456; train_group_lasso_reg_loss: 0.0000; train_global_loss: 293452.6829; train_optim_loss: 293452.6829; val_kl_reg_loss: 4540.4637; val_edge_recon_loss: 124423.3893; val_cond_contrastive_loss: 31906.5161; val_gene_expr_recon_loss: 130598.0849; val_masked_gp_l1_reg_loss: 2142.0117; val_group_lasso_reg_loss: 0.0000; val_global_loss: 293610.4541; val_optim_loss: 293610.4541
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9876; val_auprc_score: 0.9958; val_best_acc_score: 0.9567; val_best_f1_score: 0.9719; train_kl_reg_loss: 2504.3135; train_edge_recon_loss: 123612.2050; train_gene_expr_recon_loss: 132894.9317; train_masked_gp_l1_reg_loss: 1914.5761; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260926.0264; train_optim_loss: 260926.0264; val_kl_reg_loss: 2391.2914; val_edge_recon_loss: 125055.6622; val_gene_expr_recon_loss: 132569.2827; val_masked_gp_l1_reg_loss: 1915.3367; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261931.5795; val_optim_loss: 261931.5795
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9876; val_auprc_score: 0.9957; val_best_acc_score: 0.9571; val_best_f1_score: 0.9722; train_kl_reg_loss: 2498.5396; train_edge_recon_loss: 123526.1987; train_gene_expr_recon_loss: 132855.8278; train_masked_gp_l1_reg_loss: 1916.0858; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260796.6518; train_optim_loss: 260796.6518; val_kl_reg_loss: 2402.3725; val_edge_recon_loss: 125010.3949; val_gene_expr_recon_loss: 132507.8868; val_masked_gp_l1_reg_loss: 1916.9017; val_group_lasso_reg_loss: 0.0000; val_global_loss: 261837.5597; val_optim_loss: 261837.5597
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9431; val_auprc_score: 0.9781; val_best_acc_score: 0.9266; val_best_f1_score: 0.9534; train_kl_reg_loss: 4847.0180; train_edge_recon_loss: 125761.9659; train_cond_contrastive_loss: 32970.9561; train_gene_expr_recon_loss: 130645.2833; train_masked_gp_l1_reg_loss: 2199.4703; train_group_lasso_reg_loss: 0.0000; train_global_loss: 296424.6937; train_optim_loss: 296424.6937; val_kl_reg_loss: 4678.2166; val_edge_recon_loss: 126235.7863; val_cond_contrastive_loss: 32704.4671; val_gene_expr_recon_loss: 130444.1447; val_masked_gp_l1_reg_loss: 2201.3318; val_group_lasso_reg_loss: 0.0000; val_global_loss: 296263.9587; val_optim_loss: 296263.9587
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9952; val_auprc_score: 0.9984; val_best_acc_score: 0.9759; val_best_f1_score: 0.9843; train_kl_reg_loss: 4311.7474; train_edge_recon_loss: 123581.7633; train_gene_expr_recon_loss: 130274.5715; train_masked_gp_l1_reg_loss: 2098.3887; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260266.4708; train_optim_loss: 260266.4708; val_kl_reg_loss: 4238.4004; val_edge_recon_loss: 123764.4701; val_gene_expr_recon_loss: 130421.6539; val_masked_gp_l1_reg_loss: 2101.6633; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260526.1810; val_optim_loss: 260526.1810
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9690; val_auprc_score: 0.9843; val_best_acc_score: 0.9589; val_best_f1_score: 0.9735; train_kl_reg_loss: 4660.2714; train_edge_recon_loss: 124036.3719; train_cond_contrastive_loss: 31996.8717; train_gene_expr_recon_loss: 130568.4898; train_masked_gp_l1_reg_loss: 2149.8837; train_group_lasso_reg_loss: 0.0000; train_global_loss: 293411.8884; train_optim_loss: 293411.8884; val_kl_reg_loss: 4635.6690; val_edge_recon_loss: 124364.2940; val_cond_contrastive_loss: 31933.9206; val_gene_expr_recon_loss: 130540.3203; val_masked_gp_l1_reg_loss: 2151.7883; val_group_lasso_reg_loss: 0.0000; val_global_loss: 293625.9849; val_optim_loss: 293625.9849

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 434 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9899
Val AUPRC score: 0.9964
Val best accuracy score: 0.9608
Val best F1 score: 0.9745
Val gene expr MSE score: 11.5623

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9951; val_auprc_score: 0.9983; val_best_acc_score: 0.9752; val_best_f1_score: 0.9839; train_kl_reg_loss: 4313.0415; train_edge_recon_loss: 123424.3294; train_gene_expr_recon_loss: 130251.8943; train_masked_gp_l1_reg_loss: 2099.0578; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260088.3231; train_optim_loss: 260088.3231; val_kl_reg_loss: 4267.0187; val_edge_recon_loss: 123599.5962; val_gene_expr_recon_loss: 130268.8489; val_masked_gp_l1_reg_loss: 2103.0645; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260238.5269; val_optim_loss: 260238.5269
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9693; val_auprc_score: 0.9844; val_best_acc_score: 0.9595; val_best_f1_score: 0.9739; train_kl_reg_loss: 4659.5518; train_edge_recon_loss: 124069.0753; train_cond_contrastive_loss: 31994.4411; train_gene_expr_recon_loss: 130565.1983; train_masked_gp_l1_reg_loss: 2153.3122; train_group_lasso_reg_loss: 0.0000; train_global_loss: 293441.5787; train_optim_loss: 293441.5787; val_kl_reg_loss: 4531.2025; val_edge_recon_loss: 124605.8549; val_cond_contrastive_loss: 31986.0486; val_gene_expr_recon_loss: 130573.9557; val_masked_gp_l1_reg_loss: 2153.7178; val_group_lasso_reg_loss: 0.0000; val_global_loss: 293850.7802; val_optim_loss: 293850.7802
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9449; val_auprc_score: 0.9788; val_best_acc_score: 0.9291; val_best_f1_score: 0.9549; train_kl_reg_loss: 4838.5371; train_edge_recon_loss: 125657.1643; train_cond_contrastive_loss: 32962.9831; train_gene_expr_recon_loss: 130601.4702; train_masked_gp_l1_reg_loss: 2207.9255; train_group_lasso_reg_loss: 0.0000; train_global_loss: 296268.0800; train_optim_loss: 296268.0800; val_kl_reg_loss: 4843.5917; val_edge_recon_loss: 125875.3197; val_cond_contrastive_loss: 32748.8402; val_gene_expr_recon_loss: 130362.3076; val_masked_gp_l1_reg_loss: 2213.8149; val_group_lasso_reg_loss: 0.0000; val_global_loss: 296043.8721; val_optim_loss: 296043.8721
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9953; val_auprc_score: 0.9984; val_best_acc_score: 0.9761; val_best_f1_score: 0.9845; train_kl_reg_loss: 4312.6161; train_edge_recon_loss: 123361.7077; train_gene_expr_recon_loss: 130202.4225; train_masked_gp_l1_reg_loss: 2099.1561; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259975.9022; train_optim_loss: 259975.9022; val_kl_reg_loss: 4330.5238; val_edge_recon_loss: 123504.7417; val_gene_expr_recon_loss: 130201.5673; val_masked_gp_l1_reg_loss: 2097.5657; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260134.3960; val_optim_loss: 260134.3960
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9689; val_auprc_score: 0.9841; val_best_acc_score: 0.9593; val_best_f1_score: 0.9737; train_kl_reg_loss: 4659.7576; train_edge_recon_loss: 124027.2648; train_cond_contrastive_loss: 31994.5004; train_gene_expr_recon_loss: 130521.7093; train_masked_gp_l1_reg_loss: 2154.2122; train_group_lasso_reg_loss: 0.0000; train_global_loss: 293357.4444; train_optim_loss: 293357.4444; val_kl_reg_loss: 4619.4040; val_edge_recon_loss: 124671.5294; val_cond_contrastive_loss: 31937.1341; val_gene_expr_recon_loss: 130517.9885; val_masked_gp_l1_reg_loss: 2152.5278; val_group_lasso_reg_loss: 0.0000; val_global_loss: 293898.5873; val_optim_loss: 293898.5873
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9441; val_auprc_score: 0.9785; val_best_acc_score: 0.9291; val_best_f1_score: 0.9549; train_kl_reg_loss: 4838.1613; train_edge_recon_loss: 125615.2850; train_cond_contrastive_loss: 32941.3272; train_gene_expr_recon_loss: 130576.8837; train_masked_gp_l1_reg_loss: 2217.0444; train_group_lasso_reg_loss: 0.0000; train_global_loss: 296188.7017; train_optim_loss: 296188.7017; val_kl_reg_loss: 4700.5052; val_edge_recon_loss: 125983.2142; val_cond_contrastive_loss: 32693.7262; val_gene_expr_recon_loss: 130482.8461; val_masked_gp_l1_reg_loss: 2220.9795; val_group_lasso_reg_loss: 0.0000; val_global_loss: 296081.2608; val_optim_loss: 296081.2608
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9956; val_auprc_score: 0.9985; val_best_acc_score: 0.9769; val_best_f1_score: 0.9850; train_kl_reg_loss: 4312.2196; train_edge_recon_loss: 123452.7584; train_gene_expr_recon_loss: 130171.3048; train_masked_gp_l1_reg_loss: 2099.0399; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260035.3229; train_optim_loss: 260035.3229; val_kl_reg_loss: 4279.7102; val_edge_recon_loss: 123950.2741; val_gene_expr_recon_loss: 130443.6012; val_masked_gp_l1_reg_loss: 2099.9697; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260773.5548; val_optim_loss: 260773.5548

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9697; val_auprc_score: 0.9845; val_best_acc_score: 0.9618; val_best_f1_score: 0.9753; train_kl_reg_loss: 4668.1167; train_edge_recon_loss: 123769.9662; train_cond_contrastive_loss: 32009.0827; train_gene_expr_recon_loss: 129919.7536; train_masked_gp_l1_reg_loss: 2100.9848; train_group_lasso_reg_loss: 0.0000; train_global_loss: 292467.9042; train_optim_loss: 292467.9042; val_kl_reg_loss: 4584.7788; val_edge_recon_loss: 124267.5535; val_cond_contrastive_loss: 31950.3602; val_gene_expr_recon_loss: 129919.1948; val_masked_gp_l1_reg_loss: 2098.9490; val_group_lasso_reg_loss: 0.0000; val_global_loss: 292820.8245; val_optim_loss: 292820.8245
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9423; val_auprc_score: 0.9774; val_best_acc_score: 0.9287; val_best_f1_score: 0.9546; train_kl_reg_loss: 4830.5023; train_edge_recon_loss: 125548.3005; train_cond_contrastive_loss: 32930.8685; train_gene_expr_recon_loss: 130556.9401; train_masked_gp_l1_reg_loss: 2221.2002; train_group_lasso_reg_loss: 0.0000; train_global_loss: 296087.8116; train_optim_loss: 296087.8116; val_kl_reg_loss: 4847.5530; val_edge_recon_loss: 126010.9737; val_cond_contrastive_loss: 32611.4855; val_gene_expr_recon_loss: 130395.9622; val_masked_gp_l1_reg_loss: 2222.2866; val_group_lasso_reg_loss: 0.0000; val_global_loss: 296088.2567; val_optim_loss: 296088.2567
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9952; val_auprc_score: 0.9984; val_best_acc_score: 0.9761; val_best_f1_score: 0.9845; train_kl_reg_loss: 4315.7121; train_edge_recon_loss: 123432.9821; train_gene_expr_recon_loss: 130176.0447; train_masked_gp_l1_reg_loss: 2100.6689; train_group_lasso_reg_loss: 0.0000; train_global_loss: 260025.4078; train_optim_loss: 260025.4078; val_kl_reg_loss: 4343.0825; val_edge_recon_loss: 123733.4001; val_gene_expr_recon_loss: 130067.3688; val_masked_gp_l1_reg_loss: 2098.8323; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260242.6851; val_optim_loss: 260242.6851
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9682; val_auprc_score: 0.9836; val_best_acc_score: 0.9613; val_best_f1_score: 0.9750; train_kl_reg_loss: 4664.6154; train_edge_recon_loss: 123670.1175; train_cond_contrastive_loss: 32008.0581; train_gene_expr_recon_loss: 129865.2515; train_masked_gp_l1_reg_loss: 2099.2083; train_group_lasso_reg_loss: 0.0000; train_global_loss: 292307.2509; train_optim_loss: 292307.2509; val_kl_reg_loss: 4612.0879; val_edge_recon_loss: 124082.4944; val_cond_contrastive_loss: 31884.8106; val_gene_expr_recon_loss: 129932.2465; val_masked_gp_l1_reg_loss: 2099.6460; val_group_lasso_reg_loss: 0.0000; val_global_loss: 292611.2957; val_optim_loss: 292611.2957
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9454; val_auprc_score: 0.9790; val_best_acc_score: 0.9311; val_best_f1_score: 0.9561; train_kl_reg_loss: 4834.3209; train_edge_recon_loss: 125363.0382; train_cond_contrastive_loss: 32904.5940; train_gene_expr_recon_loss: 130546.4550; train_masked_gp_l1_reg_loss: 2224.4926; train_group_lasso_reg_loss: 0.0000; train_global_loss: 295872.9005; train_optim_loss: 295872.9005; val_kl_reg_loss: 4731.9703; val_edge_recon_loss: 125771.1265; val_cond_contrastive_loss: 32725.5052; val_gene_expr_recon_loss: 130330.2731; val_masked_gp_l1_reg_loss: 2226.9771; val_group_lasso_reg_loss: 0.0000; val_global_loss: 295785.8444; val_optim_loss: 295785.8444
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9954; val_auprc_score: 0.9985; val_best_acc_score: 0.9770; val_best_f1_score: 0.9851; train_kl_reg_loss: 4320.1176; train_edge_recon_loss: 123361.2513; train_gene_expr_recon_loss: 130142.6497; train_masked_gp_l1_reg_loss: 2102.0135; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259926.0319; train_optim_loss: 259926.0319; val_kl_reg_loss: 4245.4082; val_edge_recon_loss: 123664.9232; val_gene_expr_recon_loss: 130084.2476; val_masked_gp_l1_reg_loss: 2104.8589; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260099.4336; val_optim_loss: 260099.4336
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9684; val_auprc_score: 0.9834; val_best_acc_score: 0.9614; val_best_f1_score: 0.9751; train_kl_reg_loss: 4659.5979; train_edge_recon_loss: 123779.2173; train_cond_contrastive_loss: 32003.8421; train_gene_expr_recon_loss: 129786.1547; train_masked_gp_l1_reg_loss: 2101.5995; train_group_lasso_reg_loss: 0.0000; train_global_loss: 292330.4113; train_optim_loss: 292330.4113; val_kl_reg_loss: 4669.1902; val_edge_recon_loss: 124123.1670; val_cond_contrastive_loss: 31831.1067; val_gene_expr_recon_loss: 129903.0661; val_masked_gp_l1_reg_loss: 2103.1177; val_group_lasso_reg_loss: 0.0000; val_global_loss: 292629.6552; val_optim_loss: 292629.6552
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9692; val_auprc_score: 0.9840; val_best_acc_score: 0.9618; val_best_f1_score: 0.9753; train_kl_reg_loss: 4653.2739; train_edge_recon_loss: 123784.4139; train_cond_contrastive_loss: 32004.3445; train_gene_expr_recon_loss: 129781.7183; train_masked_gp_l1_reg_loss: 2105.4843; train_group_lasso_reg_loss: 0.0000; train_global_loss: 292329.2346; train_optim_loss: 292329.2346; val_kl_reg_loss: 4627.3194; val_edge_recon_loss: 124281.6296; val_cond_contrastive_loss: 31915.4963; val_gene_expr_recon_loss: 129870.5634; val_masked_gp_l1_reg_loss: 2107.8938; val_group_lasso_reg_loss: 0.0000; val_global_loss: 292802.9143; val_optim_loss: 292802.9143
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9953; val_auprc_score: 0.9984; val_best_acc_score: 0.9766; val_best_f1_score: 0.9848; train_kl_reg_loss: 4319.8228; train_edge_recon_loss: 123345.7216; train_gene_expr_recon_loss: 130118.8775; train_masked_gp_l1_reg_loss: 2101.9234; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259886.3454; train_optim_loss: 259886.3454; val_kl_reg_loss: 4330.2746; val_edge_recon_loss: 123746.3530; val_gene_expr_recon_loss: 130026.0617; val_masked_gp_l1_reg_loss: 2107.3594; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260210.0493; val_optim_loss: 260210.0493
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9452; val_auprc_score: 0.9791; val_best_acc_score: 0.9297; val_best_f1_score: 0.9554; train_kl_reg_loss: 4832.2032; train_edge_recon_loss: 125449.1435; train_cond_contrastive_loss: 32892.4667; train_gene_expr_recon_loss: 130510.8949; train_masked_gp_l1_reg_loss: 2225.7535; train_group_lasso_reg_loss: 0.0000; train_global_loss: 295910.4615; train_optim_loss: 295910.4615; val_kl_reg_loss: 4679.1784; val_edge_recon_loss: 125791.6507; val_cond_contrastive_loss: 32694.3775; val_gene_expr_recon_loss: 130723.9045; val_masked_gp_l1_reg_loss: 2228.6006; val_group_lasso_reg_loss: 0.0000; val_global_loss: 296117.7056; val_optim_loss: 296117.7056
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9687; val_auprc_score: 0.9837; val_best_acc_score: 0.9617; val_best_f1_score: 0.9753; train_kl_reg_loss: 4650.8530; train_edge_recon_loss: 123801.8724; train_cond_contrastive_loss: 32001.4053; train_gene_expr_recon_loss: 129760.5276; train_masked_gp_l1_reg_loss: 2109.9694; train_group_lasso_reg_loss: 0.0000; train_global_loss: 292324.6280; train_optim_loss: 292324.6280; val_kl_reg_loss: 4617.3088; val_edge_recon_loss: 123778.9426; val_cond_contrastive_loss: 31888.0538; val_gene_expr_recon_loss: 129916.7886; val_masked_gp_l1_reg_loss: 2111.7026; val_group_lasso_reg_loss: 0.0000; val_global_loss: 292312.7821; val_optim_loss: 292312.7821
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9956; val_auprc_score: 0.9985; val_best_acc_score: 0.9771; val_best_f1_score: 0.9851; train_kl_reg_loss: 4320.2110; train_edge_recon_loss: 123283.8056; train_gene_expr_recon_loss: 130104.0423; train_masked_gp_l1_reg_loss: 2103.4097; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259811.4684; train_optim_loss: 259811.4684; val_kl_reg_loss: 4213.9579; val_edge_recon_loss: 123657.7305; val_gene_expr_recon_loss: 130081.3639; val_masked_gp_l1_reg_loss: 2106.9917; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260060.0412; val_optim_loss: 260060.0412
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9414; val_auprc_score: 0.9771; val_best_acc_score: 0.9285; val_best_f1_score: 0.9545; train_kl_reg_loss: 4829.3073; train_edge_recon_loss: 125414.3039; train_cond_contrastive_loss: 32889.6597; train_gene_expr_recon_loss: 130528.2668; train_masked_gp_l1_reg_loss: 2228.6756; train_group_lasso_reg_loss: 0.0000; train_global_loss: 295890.2132; train_optim_loss: 295890.2132; val_kl_reg_loss: 4816.8153; val_edge_recon_loss: 126149.2564; val_cond_contrastive_loss: 32574.7236; val_gene_expr_recon_loss: 130395.4693; val_masked_gp_l1_reg_loss: 2229.3357; val_group_lasso_reg_loss: 0.0000; val_global_loss: 296165.6081; val_optim_loss: 296165.6081
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9683; val_auprc_score: 0.9834; val_best_acc_score: 0.9617; val_best_f1_score: 0.9753; train_kl_reg_loss: 4648.7236; train_edge_recon_loss: 123743.8092; train_cond_contrastive_loss: 31997.4217; train_gene_expr_recon_loss: 129761.3009; train_masked_gp_l1_reg_loss: 2114.0604; train_group_lasso_reg_loss: 0.0000; train_global_loss: 292265.3156; train_optim_loss: 292265.3156; val_kl_reg_loss: 4608.7026; val_edge_recon_loss: 124068.3339; val_cond_contrastive_loss: 31877.7343; val_gene_expr_recon_loss: 129804.3447; val_masked_gp_l1_reg_loss: 2115.9365; val_group_lasso_reg_loss: 0.0000; val_global_loss: 292475.0537; val_optim_loss: 292475.0537
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9957; val_auprc_score: 0.9985; val_best_acc_score: 0.9776; val_best_f1_score: 0.9854; train_kl_reg_loss: 4319.6719; train_edge_recon_loss: 123173.2527; train_gene_expr_recon_loss: 130058.6270; train_masked_gp_l1_reg_loss: 2104.8995; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259656.4510; train_optim_loss: 259656.4510; val_kl_reg_loss: 4224.7647; val_edge_recon_loss: 123826.0408; val_gene_expr_recon_loss: 130068.5319; val_masked_gp_l1_reg_loss: 2101.6543; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260220.9924; val_optim_loss: 260220.9924
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9432; val_auprc_score: 0.9778; val_best_acc_score: 0.9315; val_best_f1_score: 0.9565; train_kl_reg_loss: 4830.3498; train_edge_recon_loss: 125270.8654; train_cond_contrastive_loss: 32877.8949; train_gene_expr_recon_loss: 130463.1590; train_masked_gp_l1_reg_loss: 2232.3184; train_group_lasso_reg_loss: 0.0000; train_global_loss: 295674.5873; train_optim_loss: 295674.5873; val_kl_reg_loss: 4691.5942; val_edge_recon_loss: 125955.3217; val_cond_contrastive_loss: 32650.8625; val_gene_expr_recon_loss: 130405.1077; val_masked_gp_l1_reg_loss: 2232.0632; val_group_lasso_reg_loss: 0.0000; val_global_loss: 295934.9490; val_optim_loss: 295934.9490
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9691; val_auprc_score: 0.9839; val_best_acc_score: 0.9620; val_best_f1_score: 0.9755; train_kl_reg_loss: 4644.8999; train_edge_recon_loss: 123721.7664; train_cond_contrastive_loss: 31988.7942; train_gene_expr_recon_loss: 129734.4762; train_masked_gp_l1_reg_loss: 2117.7635; train_group_lasso_reg_loss: 0.0000; train_global_loss: 292207.7002; train_optim_loss: 292207.7002; val_kl_reg_loss: 4603.0554; val_edge_recon_loss: 124181.9297; val_cond_contrastive_loss: 31876.6263; val_gene_expr_recon_loss: 129814.7425; val_masked_gp_l1_reg_loss: 2119.0051; val_group_lasso_reg_loss: 0.0000; val_global_loss: 292595.3539; val_optim_loss: 292595.3539
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9955; val_auprc_score: 0.9985; val_best_acc_score: 0.9771; val_best_f1_score: 0.9851; train_kl_reg_loss: 4317.9497; train_edge_recon_loss: 123289.5258; train_gene_expr_recon_loss: 130055.6329; train_masked_gp_l1_reg_loss: 2103.0575; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259766.1659; train_optim_loss: 259766.1659; val_kl_reg_loss: 4277.6722; val_edge_recon_loss: 123607.5059; val_gene_expr_recon_loss: 130091.1664; val_masked_gp_l1_reg_loss: 2105.9299; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260082.2810; val_optim_loss: 260082.2810

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9440; val_auprc_score: 0.9783; val_best_acc_score: 0.9314; val_best_f1_score: 0.9563; train_kl_reg_loss: 4808.8590; train_edge_recon_loss: 125228.3738; train_cond_contrastive_loss: 32885.5516; train_gene_expr_recon_loss: 129881.1266; train_masked_gp_l1_reg_loss: 2188.8543; train_group_lasso_reg_loss: 0.0000; train_global_loss: 294992.7650; train_optim_loss: 294992.7650; val_kl_reg_loss: 4799.8302; val_edge_recon_loss: 125817.0612; val_cond_contrastive_loss: 32614.2835; val_gene_expr_recon_loss: 129765.0305; val_masked_gp_l1_reg_loss: 2187.6526; val_group_lasso_reg_loss: 0.0000; val_global_loss: 295183.8615; val_optim_loss: 295183.8615
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9688; val_auprc_score: 0.9836; val_best_acc_score: 0.9619; val_best_f1_score: 0.9754; train_kl_reg_loss: 4642.2536; train_edge_recon_loss: 123670.4032; train_cond_contrastive_loss: 31995.1305; train_gene_expr_recon_loss: 129734.7582; train_masked_gp_l1_reg_loss: 2121.7995; train_group_lasso_reg_loss: 0.0000; train_global_loss: 292164.3450; train_optim_loss: 292164.3450; val_kl_reg_loss: 4602.4565; val_edge_recon_loss: 124313.9263; val_cond_contrastive_loss: 31858.7894; val_gene_expr_recon_loss: 129886.6020; val_masked_gp_l1_reg_loss: 2123.9241; val_group_lasso_reg_loss: 0.0000; val_global_loss: 292785.7117; val_optim_loss: 292785.7117
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9955; val_auprc_score: 0.9984; val_best_acc_score: 0.9767; val_best_f1_score: 0.9849; train_kl_reg_loss: 4322.0616; train_edge_recon_loss: 123293.4115; train_gene_expr_recon_loss: 130051.5862; train_masked_gp_l1_reg_loss: 2102.6825; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259769.7422; train_optim_loss: 259769.7422; val_kl_reg_loss: 4299.8806; val_edge_recon_loss: 123357.5682; val_gene_expr_recon_loss: 130055.5491; val_masked_gp_l1_reg_loss: 2104.5537; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259817.5495; val_optim_loss: 259817.5495

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9687; val_auprc_score: 0.9838; val_best_acc_score: 0.9621; val_best_f1_score: 0.9755; train_kl_reg_loss: 4639.1526; train_edge_recon_loss: 123769.0712; train_cond_contrastive_loss: 32001.9092; train_gene_expr_recon_loss: 129660.4277; train_masked_gp_l1_reg_loss: 2116.8787; train_group_lasso_reg_loss: 0.0000; train_global_loss: 292187.4395; train_optim_loss: 292187.4395; val_kl_reg_loss: 4602.6260; val_edge_recon_loss: 123880.1436; val_cond_contrastive_loss: 31863.8416; val_gene_expr_recon_loss: 129739.0178; val_masked_gp_l1_reg_loss: 2116.7036; val_group_lasso_reg_loss: 0.0000; val_global_loss: 292202.3478; val_optim_loss: 292202.3478
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9447; val_auprc_score: 0.9787; val_best_acc_score: 0.9322; val_best_f1_score: 0.9569; train_kl_reg_loss: 4814.1347; train_edge_recon_loss: 125066.6136; train_cond_contrastive_loss: 32877.7675; train_gene_expr_recon_loss: 129793.6834; train_masked_gp_l1_reg_loss: 2189.7666; train_group_lasso_reg_loss: 0.0000; train_global_loss: 294741.9658; train_optim_loss: 294741.9658; val_kl_reg_loss: 4745.2395; val_edge_recon_loss: 125498.8466; val_cond_contrastive_loss: 32676.3029; val_gene_expr_recon_loss: 129748.1319; val_masked_gp_l1_reg_loss: 2191.7458; val_group_lasso_reg_loss: 0.0000; val_global_loss: 294860.2713; val_optim_loss: 294860.2713
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9956; val_auprc_score: 0.9985; val_best_acc_score: 0.9777; val_best_f1_score: 0.9855; train_kl_reg_loss: 4324.3808; train_edge_recon_loss: 123424.5245; train_gene_expr_recon_loss: 130014.2775; train_masked_gp_l1_reg_loss: 2103.4633; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259866.6462; train_optim_loss: 259866.6462; val_kl_reg_loss: 4267.5161; val_edge_recon_loss: 123387.3497; val_gene_expr_recon_loss: 129925.3386; val_masked_gp_l1_reg_loss: 2104.4407; val_group_lasso_reg_loss: 0.0000; val_global_loss: 259684.6425; val_optim_loss: 259684.6425
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9689; val_auprc_score: 0.9838; val_best_acc_score: 0.9623; val_best_f1_score: 0.9756; train_kl_reg_loss: 4639.5705; train_edge_recon_loss: 123680.0511; train_cond_contrastive_loss: 31993.7859; train_gene_expr_recon_loss: 129657.0597; train_masked_gp_l1_reg_loss: 2116.9064; train_group_lasso_reg_loss: 0.0000; train_global_loss: 292087.3740; train_optim_loss: 292087.3740; val_kl_reg_loss: 4599.4669; val_edge_recon_loss: 123816.9870; val_cond_contrastive_loss: 31889.2733; val_gene_expr_recon_loss: 129663.1602; val_masked_gp_l1_reg_loss: 2117.0513; val_group_lasso_reg_loss: 0.0000; val_global_loss: 292085.9505; val_optim_loss: 292085.9505
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9953; val_auprc_score: 0.9984; val_best_acc_score: 0.9768; val_best_f1_score: 0.9849; train_kl_reg_loss: 4323.9464; train_edge_recon_loss: 123206.3405; train_gene_expr_recon_loss: 130017.3281; train_masked_gp_l1_reg_loss: 2100.7707; train_group_lasso_reg_loss: 0.0000; train_global_loss: 259648.3857; train_optim_loss: 259648.3857; val_kl_reg_loss: 4307.1841; val_edge_recon_loss: 123579.8917; val_gene_expr_recon_loss: 130126.5736; val_masked_gp_l1_reg_loss: 2097.6406; val_group_lasso_reg_loss: 0.0000; val_global_loss: 260111.2895; val_optim_loss: 260111.2895
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9445; val_auprc_score: 0.9786; val_best_acc_score: 0.9318; val_best_f1_score: 0.9567; train_kl_reg_loss: 4811.7576; train_edge_recon_loss: 125076.8974; train_cond_contrastive_loss: 32883.7028; train_gene_expr_recon_loss: 129769.6068; train_masked_gp_l1_reg_loss: 2194.1773; train_group_lasso_reg_loss: 0.0000; train_global_loss: 294736.1421; train_optim_loss: 294736.1421; val_kl_reg_loss: 4762.3209; val_edge_recon_loss: 125622.8254; val_cond_contrastive_loss: 32629.2119; val_gene_expr_recon_loss: 129807.9215; val_masked_gp_l1_reg_loss: 2196.3286; val_group_lasso_reg_loss: 0.0000; val_global_loss: 295018.6233; val_optim_loss: 295018.6233
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9608; val_auprc_score: 0.9822; val_best_acc_score: 0.9415; val_best_f1_score: 0.9624; train_kl_reg_loss: 4454.4545; train_edge_recon_loss: 129138.5344; train_cond_contrastive_loss: 31924.8519; train_gene_expr_recon_loss: 140467.7356; train_masked_gp_l1_reg_loss: 2147.2498; train_group_lasso_reg_loss: 0.0000; train_global_loss: 308132.8261; train_optim_loss: 308132.8261; val_kl_reg_loss: 1813.8381; val_edge_recon_loss: 128438.7296; val_cond_contrastive_loss: 31876.6428; val_gene_expr_recon_loss: 139904.1749; val_masked_gp_l1_reg_loss: 2143.5408; val_group_lasso_reg_loss: 0.0000; val_global_loss: 304176.9168; val_optim_loss: 304176.9168
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9871; val_auprc_score: 0.9956; val_best_acc_score: 0.9588; val_best_f1_score: 0.9733; train_kl_reg_loss: 2501.1202; train_edge_recon_loss: 124223.1152; train_gene_expr_recon_loss: 137112.1249; train_masked_gp_l1_reg_loss: 2112.2186; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265948.5790; train_optim_loss: 265948.5790; val_kl_reg_loss: 1974.5789; val_edge_recon_loss: 124687.5061; val_gene_expr_recon_loss: 137117.1149; val_masked_gp_l1_reg_loss: 2048.8442; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265828.0441; val_optim_loss: 265828.0441
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9446; val_auprc_score: 0.9786; val_best_acc_score: 0.9323; val_best_f1_score: 0.9569; train_kl_reg_loss: 4800.8485; train_edge_recon_loss: 125083.5348; train_cond_contrastive_loss: 32864.0597; train_gene_expr_recon_loss: 129724.4494; train_masked_gp_l1_reg_loss: 2198.7650; train_group_lasso_reg_loss: 0.0000; train_global_loss: 294671.6575; train_optim_loss: 294671.6575; val_kl_reg_loss: 4714.5600; val_edge_recon_loss: 125791.1872; val_cond_contrastive_loss: 32630.8724; val_gene_expr_recon_loss: 129695.6974; val_masked_gp_l1_reg_loss: 2200.6216; val_group_lasso_reg_loss: 0.0000; val_global_loss: 295032.9422; val_optim_loss: 295032.9422
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9600; val_auprc_score: 0.9815; val_best_acc_score: 0.9409; val_best_f1_score: 0.9620; train_kl_reg_loss: 3744.8929; train_edge_recon_loss: 127565.4797; train_cond_contrastive_loss: 31858.7170; train_gene_expr_recon_loss: 139331.2207; train_masked_gp_l1_reg_loss: 2121.3036; train_group_lasso_reg_loss: 0.0000; train_global_loss: 304621.6137; train_optim_loss: 304621.6137; val_kl_reg_loss: 1905.2537; val_edge_recon_loss: 127991.3476; val_cond_contrastive_loss: 31795.2210; val_gene_expr_recon_loss: 139210.5960; val_masked_gp_l1_reg_loss: 2099.4348; val_group_lasso_reg_loss: 0.0000; val_global_loss: 303001.8565; val_optim_loss: 303001.8565
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9864; val_auprc_score: 0.9953; val_best_acc_score: 0.9573; val_best_f1_score: 0.9724; train_kl_reg_loss: 2158.2119; train_edge_recon_loss: 123966.4809; train_gene_expr_recon_loss: 137194.3634; train_masked_gp_l1_reg_loss: 2045.1188; train_group_lasso_reg_loss: 0.0000; train_global_loss: 265364.1750; train_optim_loss: 265364.1750; val_kl_reg_loss: 2039.8988; val_edge_recon_loss: 123948.6911; val_gene_expr_recon_loss: 137332.4135; val_masked_gp_l1_reg_loss: 2002.4219; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265323.4287; val_optim_loss: 265323.4287
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9436; val_auprc_score: 0.9781; val_best_acc_score: 0.9321; val_best_f1_score: 0.9569; train_kl_reg_loss: 4797.6019; train_edge_recon_loss: 125085.9784; train_cond_contrastive_loss: 32862.5715; train_gene_expr_recon_loss: 129712.1360; train_masked_gp_l1_reg_loss: 2203.5539; train_group_lasso_reg_loss: 0.0000; train_global_loss: 294661.8421; train_optim_loss: 294661.8421; val_kl_reg_loss: 4744.3839; val_edge_recon_loss: 125452.5507; val_cond_contrastive_loss: 32605.1492; val_gene_expr_recon_loss: 129745.0784; val_masked_gp_l1_reg_loss: 2206.8088; val_group_lasso_reg_loss: 0.0000; val_global_loss: 294753.9754; val_optim_loss: 294753.9754
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9597; val_auprc_score: 0.9812; val_best_acc_score: 0.9408; val_best_f1_score: 0.9619; train_kl_reg_loss: 3304.0300; train_edge_recon_loss: 126870.2216; train_cond_contrastive_loss: 31803.8442; train_gene_expr_recon_loss: 138787.7502; train_masked_gp_l1_reg_loss: 2081.5623; train_group_lasso_reg_loss: 0.0000; train_global_loss: 302847.4084; train_optim_loss: 302847.4084; val_kl_reg_loss: 1993.9472; val_edge_recon_loss: 127517.6469; val_cond_contrastive_loss: 31770.9703; val_gene_expr_recon_loss: 138655.3046; val_masked_gp_l1_reg_loss: 2065.8457; val_group_lasso_reg_loss: 0.0000; val_global_loss: 302003.7127; val_optim_loss: 302003.7127

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9875; val_auprc_score: 0.9956; val_best_acc_score: 0.9587; val_best_f1_score: 0.9732; train_kl_reg_loss: 2132.7431; train_edge_recon_loss: 123586.9773; train_gene_expr_recon_loss: 136898.6341; train_masked_gp_l1_reg_loss: 1984.2282; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264602.5825; train_optim_loss: 264602.5825; val_kl_reg_loss: 2084.1000; val_edge_recon_loss: 124254.5735; val_gene_expr_recon_loss: 136940.4532; val_masked_gp_l1_reg_loss: 1977.8708; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265257.0015; val_optim_loss: 265257.0015
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9446; val_auprc_score: 0.9786; val_best_acc_score: 0.9321; val_best_f1_score: 0.9568; train_kl_reg_loss: 4795.6907; train_edge_recon_loss: 125012.2483; train_cond_contrastive_loss: 32853.4616; train_gene_expr_recon_loss: 129703.8281; train_masked_gp_l1_reg_loss: 2208.6751; train_group_lasso_reg_loss: 0.0000; train_global_loss: 294573.9039; train_optim_loss: 294573.9039; val_kl_reg_loss: 4778.9249; val_edge_recon_loss: 125481.5606; val_cond_contrastive_loss: 32603.9128; val_gene_expr_recon_loss: 129694.0541; val_masked_gp_l1_reg_loss: 2210.9883; val_group_lasso_reg_loss: 0.0000; val_global_loss: 294769.4525; val_optim_loss: 294769.4525

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9600; val_auprc_score: 0.9814; val_best_acc_score: 0.9407; val_best_f1_score: 0.9619; train_kl_reg_loss: 3169.9473; train_edge_recon_loss: 126600.0415; train_cond_contrastive_loss: 31794.8459; train_gene_expr_recon_loss: 138517.0354; train_masked_gp_l1_reg_loss: 2064.3746; train_group_lasso_reg_loss: 0.0000; train_global_loss: 302146.2446; train_optim_loss: 302146.2446; val_kl_reg_loss: 2001.2905; val_edge_recon_loss: 127390.0987; val_cond_contrastive_loss: 31787.5228; val_gene_expr_recon_loss: 138713.4792; val_masked_gp_l1_reg_loss: 2063.0278; val_group_lasso_reg_loss: 0.0000; val_global_loss: 301955.4229; val_optim_loss: 301955.4229
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9878; val_auprc_score: 0.9957; val_best_acc_score: 0.9600; val_best_f1_score: 0.9741; train_kl_reg_loss: 2124.6662; train_edge_recon_loss: 123574.7545; train_gene_expr_recon_loss: 136775.2027; train_masked_gp_l1_reg_loss: 1973.9519; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264448.5753; train_optim_loss: 264448.5753; val_kl_reg_loss: 2082.1100; val_edge_recon_loss: 124296.3213; val_gene_expr_recon_loss: 136894.6835; val_masked_gp_l1_reg_loss: 1971.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 265244.1152; val_optim_loss: 265244.1152
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9445; val_auprc_score: 0.9785; val_best_acc_score: 0.9321; val_best_f1_score: 0.9569; train_kl_reg_loss: 4790.8586; train_edge_recon_loss: 125089.2860; train_cond_contrastive_loss: 32845.4584; train_gene_expr_recon_loss: 129681.2658; train_masked_gp_l1_reg_loss: 2213.1920; train_group_lasso_reg_loss: 0.0000; train_global_loss: 294620.0609; train_optim_loss: 294620.0609; val_kl_reg_loss: 4774.3469; val_edge_recon_loss: 125639.0194; val_cond_contrastive_loss: 32582.9733; val_gene_expr_recon_loss: 129640.6433; val_masked_gp_l1_reg_loss: 2214.7505; val_group_lasso_reg_loss: 0.0000; val_global_loss: 294851.7323; val_optim_loss: 294851.7323
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9604; val_auprc_score: 0.9816; val_best_acc_score: 0.9411; val_best_f1_score: 0.9621; train_kl_reg_loss: 3149.9812; train_edge_recon_loss: 126583.3786; train_cond_contrastive_loss: 31790.5918; train_gene_expr_recon_loss: 138454.3797; train_masked_gp_l1_reg_loss: 2061.7018; train_group_lasso_reg_loss: 0.0000; train_global_loss: 302040.0329; train_optim_loss: 302040.0329; val_kl_reg_loss: 2011.7240; val_edge_recon_loss: 127135.8322; val_cond_contrastive_loss: 31767.2813; val_gene_expr_recon_loss: 138369.0327; val_masked_gp_l1_reg_loss: 2060.3831; val_group_lasso_reg_loss: 0.0000; val_global_loss: 301344.2455; val_optim_loss: 301344.2455
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9876; val_auprc_score: 0.9957; val_best_acc_score: 0.9601; val_best_f1_score: 0.9741; train_kl_reg_loss: 2116.8504; train_edge_recon_loss: 123451.8876; train_gene_expr_recon_loss: 136718.2251; train_masked_gp_l1_reg_loss: 1968.1556; train_group_lasso_reg_loss: 0.0000; train_global_loss: 264255.1187; train_optim_loss: 264255.1187; val_kl_reg_loss: 2093.3743; val_edge_recon_loss: 124005.8637; val_gene_expr_recon_loss: 136809.6522; val_masked_gp_l1_reg_loss: 1966.2039; val_group_lasso_reg_loss: 0.0000; val_global_loss: 264875.1039; val_optim_loss: 264875.1039
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9450; val_auprc_score: 0.9787; val_best_acc_score: 0.9332; val_best_f1_score: 0.9575; train_kl_reg_loss: 4790.5063; train_edge_recon_loss: 125085.8025; train_cond_contrastive_loss: 32841.0986; train_gene_expr_recon_loss: 129682.9572; train_masked_gp_l1_reg_loss: 2217.2457; train_group_lasso_reg_loss: 0.0000; train_global_loss: 294617.6105; train_optim_loss: 294617.6105; val_kl_reg_loss: 4739.9678; val_edge_recon_loss: 125498.7510; val_cond_contrastive_loss: 32607.8837; val_gene_expr_recon_loss: 129667.6113; val_masked_gp_l1_reg_loss: 2219.6963; val_group_lasso_reg_loss: 0.0000; val_global_loss: 294733.9017; val_optim_loss: 294733.9017
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9600; val_auprc_score: 0.9814; val_best_acc_score: 0.9412; val_best_f1_score: 0.9623; train_kl_reg_loss: 3130.3218; train_edge_recon_loss: 126390.9370; train_cond_contrastive_loss: 31789.7632; train_gene_expr_recon_loss: 138396.3943; train_masked_gp_l1_reg_loss: 2059.0666; train_group_lasso_reg_loss: 0.0000; train_global_loss: 301766.4828; train_optim_loss: 301766.4828; val_kl_reg_loss: 2022.1540; val_edge_recon_loss: 127007.5259; val_cond_contrastive_loss: 31784.1842; val_gene_expr_recon_loss: 138456.1127; val_masked_gp_l1_reg_loss: 2057.7739; val_group_lasso_reg_loss: 0.0000; val_global_loss: 301327.7581; val_optim_loss: 301327.7581

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1061 min 3 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9932
Val AUPRC score: 0.9976
Val best accuracy score: 0.9696
Val best F1 score: 0.9802
Val gene expr MSE score: 14.9263

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1088 min 3 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9661
Val AUPRC score: 0.9841
Val best accuracy score: 0.9509
Val best F1 score: 0.9683
Val gene expr MSE score: 11.1702

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9453; val_auprc_score: 0.9787; val_best_acc_score: 0.9328; val_best_f1_score: 0.9572; train_kl_reg_loss: 4788.4872; train_edge_recon_loss: 125082.1559; train_cond_contrastive_loss: 32830.8990; train_gene_expr_recon_loss: 129673.8940; train_masked_gp_l1_reg_loss: 2221.3924; train_group_lasso_reg_loss: 0.0000; train_global_loss: 294596.8283; train_optim_loss: 294596.8283; val_kl_reg_loss: 4750.7749; val_edge_recon_loss: 125565.1864; val_cond_contrastive_loss: 32606.5767; val_gene_expr_recon_loss: 129634.7359; val_masked_gp_l1_reg_loss: 2223.2595; val_group_lasso_reg_loss: 0.0000; val_global_loss: 294780.5243; val_optim_loss: 294780.5243
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9383; val_auprc_score: 0.9767; val_best_acc_score: 0.9128; val_best_f1_score: 0.9446; train_kl_reg_loss: 3320.1487; train_edge_recon_loss: 128872.4202; train_cond_contrastive_loss: 32554.2628; train_gene_expr_recon_loss: 136741.2043; train_masked_gp_l1_reg_loss: 2278.9042; train_group_lasso_reg_loss: 0.0000; train_global_loss: 303766.9404; train_optim_loss: 303766.9404; val_kl_reg_loss: 2291.9393; val_edge_recon_loss: 128012.5758; val_cond_contrastive_loss: 32642.6654; val_gene_expr_recon_loss: 134990.5512; val_masked_gp_l1_reg_loss: 2192.7563; val_group_lasso_reg_loss: 0.0000; val_global_loss: 300130.4828; val_optim_loss: 300130.4828
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9409; val_auprc_score: 0.9769; val_best_acc_score: 0.9195; val_best_f1_score: 0.9488; train_kl_reg_loss: 2781.1463; train_edge_recon_loss: 126513.9258; train_cond_contrastive_loss: 32653.2269; train_gene_expr_recon_loss: 134576.5025; train_masked_gp_l1_reg_loss: 2105.7314; train_group_lasso_reg_loss: 0.0000; train_global_loss: 298630.5325; train_optim_loss: 298630.5325; val_kl_reg_loss: 2510.9741; val_edge_recon_loss: 126812.8297; val_cond_contrastive_loss: 32583.9698; val_gene_expr_recon_loss: 134322.1807; val_masked_gp_l1_reg_loss: 2040.3733; val_group_lasso_reg_loss: 0.0000; val_global_loss: 298270.3297; val_optim_loss: 298270.3297

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9419; val_auprc_score: 0.9772; val_best_acc_score: 0.9203; val_best_f1_score: 0.9494; train_kl_reg_loss: 2699.4627; train_edge_recon_loss: 126105.1775; train_cond_contrastive_loss: 32635.6022; train_gene_expr_recon_loss: 134212.8612; train_masked_gp_l1_reg_loss: 2035.3378; train_group_lasso_reg_loss: 0.0000; train_global_loss: 297688.4413; train_optim_loss: 297688.4413; val_kl_reg_loss: 2524.1842; val_edge_recon_loss: 126730.3111; val_cond_contrastive_loss: 32612.3589; val_gene_expr_recon_loss: 134171.3000; val_masked_gp_l1_reg_loss: 2032.0813; val_group_lasso_reg_loss: 0.0000; val_global_loss: 298070.2472; val_optim_loss: 298070.2472
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9416; val_auprc_score: 0.9773; val_best_acc_score: 0.9200; val_best_f1_score: 0.9493; train_kl_reg_loss: 2685.4823; train_edge_recon_loss: 126121.0753; train_cond_contrastive_loss: 32630.3429; train_gene_expr_recon_loss: 134151.0093; train_masked_gp_l1_reg_loss: 2029.6802; train_group_lasso_reg_loss: 0.0000; train_global_loss: 297617.5897; train_optim_loss: 297617.5897; val_kl_reg_loss: 2538.9293; val_edge_recon_loss: 126634.7490; val_cond_contrastive_loss: 32581.4053; val_gene_expr_recon_loss: 134040.0881; val_masked_gp_l1_reg_loss: 2027.5874; val_group_lasso_reg_loss: 0.0000; val_global_loss: 297822.7653; val_optim_loss: 297822.7653
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9412; val_auprc_score: 0.9770; val_best_acc_score: 0.9209; val_best_f1_score: 0.9498; train_kl_reg_loss: 2675.5310; train_edge_recon_loss: 126001.9854; train_cond_contrastive_loss: 32628.3340; train_gene_expr_recon_loss: 134110.3863; train_masked_gp_l1_reg_loss: 2026.3319; train_group_lasso_reg_loss: 0.0000; train_global_loss: 297442.5683; train_optim_loss: 297442.5683; val_kl_reg_loss: 2542.3371; val_edge_recon_loss: 126404.7344; val_cond_contrastive_loss: 32596.9722; val_gene_expr_recon_loss: 134034.5694; val_masked_gp_l1_reg_loss: 2025.0624; val_group_lasso_reg_loss: 0.0000; val_global_loss: 297603.6767; val_optim_loss: 297603.6767

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1323 min 1 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9475
Val AUPRC score: 0.9801
Val best accuracy score: 0.9272
Val best F1 score: 0.9536
Val gene expr MSE score: 11.1991

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
