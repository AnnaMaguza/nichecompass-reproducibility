[True]
Run timestamp: 10102023_085009_207.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_207']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6453; val_auprc_score: 0.6212; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 61231.1918; train_edge_recon_loss: 748169.2642; train_gene_expr_recon_loss: 23365921.0000; train_masked_gp_l1_reg_loss: 61183.2330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6207041.9773; train_chrom_access_recon_loss: 6938057.6591; train_global_loss: 37381604.5152; train_optim_loss: 37381604.5152; val_kl_reg_loss: 87069.4551; val_edge_recon_loss: 813098.1641; val_gene_expr_recon_loss: 21718742.0000; val_masked_gp_l1_reg_loss: 70594.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3629673.0000; val_chrom_access_recon_loss: 6702204.5625; val_global_loss: 33021381.7500; val_optim_loss: 33021381.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6874; val_auprc_score: 0.6702; val_best_acc_score: 0.5626; val_best_f1_score: 0.6905; train_kl_reg_loss: 87731.2573; train_edge_recon_loss: 751652.6714; train_gene_expr_recon_loss: 21418469.6061; train_masked_gp_l1_reg_loss: 68995.7667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2074872.9015; train_chrom_access_recon_loss: 6612827.8636; train_global_loss: 31014550.2727; train_optim_loss: 31014550.2727; val_kl_reg_loss: 82011.1738; val_edge_recon_loss: 812448.4609; val_gene_expr_recon_loss: 21281025.0000; val_masked_gp_l1_reg_loss: 68118.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1056296.3750; val_chrom_access_recon_loss: 6625447.5000; val_global_loss: 29925346.2500; val_optim_loss: 29925346.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7590; val_auprc_score: 0.7476; val_best_acc_score: 0.6655; val_best_f1_score: 0.7219; train_kl_reg_loss: 82156.4350; train_edge_recon_loss: 741101.6515; train_gene_expr_recon_loss: 21150684.0000; train_masked_gp_l1_reg_loss: 68111.4350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 701056.2249; train_chrom_access_recon_loss: 6560909.1364; train_global_loss: 29304018.8182; train_optim_loss: 29304018.8182; val_kl_reg_loss: 78942.4775; val_edge_recon_loss: 810072.6797; val_gene_expr_recon_loss: 21014284.5000; val_masked_gp_l1_reg_loss: 68319.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 460677.5625; val_chrom_access_recon_loss: 6592860.5000; val_global_loss: 29025158.0000; val_optim_loss: 29025158.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8285; val_auprc_score: 0.8075; val_best_acc_score: 0.7039; val_best_f1_score: 0.7500; train_kl_reg_loss: 74436.9329; train_edge_recon_loss: 732697.1866; train_gene_expr_recon_loss: 20976649.2727; train_masked_gp_l1_reg_loss: 68431.4506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 348386.5852; train_chrom_access_recon_loss: 6521385.1439; train_global_loss: 28721986.5758; train_optim_loss: 28721986.5758; val_kl_reg_loss: 68825.8467; val_edge_recon_loss: 798119.3203; val_gene_expr_recon_loss: 20763495.5000; val_masked_gp_l1_reg_loss: 69003.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 265492.0625; val_chrom_access_recon_loss: 6528048.4375; val_global_loss: 28492984.7500; val_optim_loss: 28492984.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8759; val_auprc_score: 0.8435; val_best_acc_score: 0.8041; val_best_f1_score: 0.8202; train_kl_reg_loss: 68172.0352; train_edge_recon_loss: 721639.3456; train_gene_expr_recon_loss: 20845750.3939; train_masked_gp_l1_reg_loss: 69646.4611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 221612.8042; train_chrom_access_recon_loss: 6472608.1061; train_global_loss: 28399429.0303; train_optim_loss: 28399429.0303; val_kl_reg_loss: 63892.0269; val_edge_recon_loss: 753926.7734; val_gene_expr_recon_loss: 20898969.5000; val_masked_gp_l1_reg_loss: 70630.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189420.0469; val_chrom_access_recon_loss: 6552984.5625; val_global_loss: 28529822.5000; val_optim_loss: 28529822.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8792; val_auprc_score: 0.8532; val_best_acc_score: 0.8020; val_best_f1_score: 0.8154; train_kl_reg_loss: 69193.2766; train_edge_recon_loss: 680881.8239; train_gene_expr_recon_loss: 20710723.5758; train_masked_gp_l1_reg_loss: 71939.1522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 175779.6790; train_chrom_access_recon_loss: 6436760.9242; train_global_loss: 28145278.4242; train_optim_loss: 28145278.4242; val_kl_reg_loss: 77791.7705; val_edge_recon_loss: 654279.2656; val_gene_expr_recon_loss: 20662852.0000; val_masked_gp_l1_reg_loss: 73456.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167226.2344; val_chrom_access_recon_loss: 6521693.1250; val_global_loss: 28157298.5000; val_optim_loss: 28157298.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8811; val_auprc_score: 0.8404; val_best_acc_score: 0.8143; val_best_f1_score: 0.8264; train_kl_reg_loss: 80350.4438; train_edge_recon_loss: 635688.5426; train_gene_expr_recon_loss: 20587391.6970; train_masked_gp_l1_reg_loss: 74696.7688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160524.0272; train_chrom_access_recon_loss: 6411257.9470; train_global_loss: 27949909.2424; train_optim_loss: 27949909.2424; val_kl_reg_loss: 79264.5215; val_edge_recon_loss: 634624.4453; val_gene_expr_recon_loss: 20652825.5000; val_masked_gp_l1_reg_loss: 75891.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153351.8906; val_chrom_access_recon_loss: 6443382.1250; val_global_loss: 28039340.7500; val_optim_loss: 28039340.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8895; val_auprc_score: 0.8549; val_best_acc_score: 0.8211; val_best_f1_score: 0.8365; train_kl_reg_loss: 78983.9482; train_edge_recon_loss: 625860.8712; train_gene_expr_recon_loss: 20467543.6970; train_masked_gp_l1_reg_loss: 76832.4329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146715.0523; train_chrom_access_recon_loss: 6385891.4924; train_global_loss: 27781827.3939; train_optim_loss: 27781827.3939; val_kl_reg_loss: 75818.6592; val_edge_recon_loss: 634158.8594; val_gene_expr_recon_loss: 20564674.0000; val_masked_gp_l1_reg_loss: 77620.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140467.0312; val_chrom_access_recon_loss: 6488233.7500; val_global_loss: 27980973.2500; val_optim_loss: 27980973.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9016; val_auprc_score: 0.8724; val_best_acc_score: 0.8348; val_best_f1_score: 0.8463; train_kl_reg_loss: 78436.5531; train_edge_recon_loss: 618738.7206; train_gene_expr_recon_loss: 20345220.5758; train_masked_gp_l1_reg_loss: 78229.2860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134891.4575; train_chrom_access_recon_loss: 6346534.2652; train_global_loss: 27602050.8485; train_optim_loss: 27602050.8485; val_kl_reg_loss: 74661.8125; val_edge_recon_loss: 618273.7891; val_gene_expr_recon_loss: 20306584.0000; val_masked_gp_l1_reg_loss: 78922.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131080.2656; val_chrom_access_recon_loss: 6412178.5000; val_global_loss: 27621700.5000; val_optim_loss: 27621700.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8994; val_auprc_score: 0.8713; val_best_acc_score: 0.8310; val_best_f1_score: 0.8422; train_kl_reg_loss: 77021.6650; train_edge_recon_loss: 614548.1383; train_gene_expr_recon_loss: 20275564.0606; train_masked_gp_l1_reg_loss: 79524.5903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126142.0162; train_chrom_access_recon_loss: 6324422.9470; train_global_loss: 27497223.3030; train_optim_loss: 27497223.3030; val_kl_reg_loss: 73913.8076; val_edge_recon_loss: 621469.6641; val_gene_expr_recon_loss: 20271244.7500; val_masked_gp_l1_reg_loss: 80236.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122774.4531; val_chrom_access_recon_loss: 6378956.4375; val_global_loss: 27548594.5000; val_optim_loss: 27548594.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9065; val_auprc_score: 0.8757; val_best_acc_score: 0.8372; val_best_f1_score: 0.8490; train_kl_reg_loss: 76105.0874; train_edge_recon_loss: 608705.2585; train_gene_expr_recon_loss: 20211234.4242; train_masked_gp_l1_reg_loss: 80622.1625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119614.2134; train_chrom_access_recon_loss: 6308891.4167; train_global_loss: 27405172.6061; train_optim_loss: 27405172.6061; val_kl_reg_loss: 73721.7139; val_edge_recon_loss: 612515.1328; val_gene_expr_recon_loss: 20073638.7500; val_masked_gp_l1_reg_loss: 81110.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117589.8281; val_chrom_access_recon_loss: 6323309.8125; val_global_loss: 27281885.0000; val_optim_loss: 27281885.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9079; val_auprc_score: 0.8797; val_best_acc_score: 0.8393; val_best_f1_score: 0.8505; train_kl_reg_loss: 74194.6068; train_edge_recon_loss: 608695.7822; train_gene_expr_recon_loss: 20133938.3030; train_masked_gp_l1_reg_loss: 81608.9759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115116.5626; train_chrom_access_recon_loss: 6284474.6439; train_global_loss: 27298028.8788; train_optim_loss: 27298028.8788; val_kl_reg_loss: 74385.1328; val_edge_recon_loss: 614352.8516; val_gene_expr_recon_loss: 20116961.7500; val_masked_gp_l1_reg_loss: 82204.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112894.9844; val_chrom_access_recon_loss: 6329476.1250; val_global_loss: 27330273.5000; val_optim_loss: 27330273.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9137; val_auprc_score: 0.8893; val_best_acc_score: 0.8493; val_best_f1_score: 0.8579; train_kl_reg_loss: 73381.1567; train_edge_recon_loss: 605170.5019; train_gene_expr_recon_loss: 20055504.1818; train_masked_gp_l1_reg_loss: 82556.5794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111372.1728; train_chrom_access_recon_loss: 6261945.8636; train_global_loss: 27189930.3030; train_optim_loss: 27189930.3030; val_kl_reg_loss: 71469.9756; val_edge_recon_loss: 610682.3984; val_gene_expr_recon_loss: 20180201.7500; val_masked_gp_l1_reg_loss: 82954.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110069.9375; val_chrom_access_recon_loss: 6358797.1875; val_global_loss: 27414175.0000; val_optim_loss: 27414175.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9178; val_auprc_score: 0.8930; val_best_acc_score: 0.8461; val_best_f1_score: 0.8586; train_kl_reg_loss: 71801.2657; train_edge_recon_loss: 602286.8381; train_gene_expr_recon_loss: 20004440.9091; train_masked_gp_l1_reg_loss: 83248.8525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108833.8217; train_chrom_access_recon_loss: 6246716.8409; train_global_loss: 27117328.6364; train_optim_loss: 27117328.6364; val_kl_reg_loss: 72245.7109; val_edge_recon_loss: 609913.3203; val_gene_expr_recon_loss: 20111102.2500; val_masked_gp_l1_reg_loss: 83592.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108171.7969; val_chrom_access_recon_loss: 6327393.7500; val_global_loss: 27312419.0000; val_optim_loss: 27312419.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9128; val_auprc_score: 0.8827; val_best_acc_score: 0.8501; val_best_f1_score: 0.8580; train_kl_reg_loss: 70651.0684; train_edge_recon_loss: 602341.4309; train_gene_expr_recon_loss: 19935387.6364; train_masked_gp_l1_reg_loss: 83931.6469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107744.8250; train_chrom_access_recon_loss: 6229556.8864; train_global_loss: 27029613.6061; train_optim_loss: 27029613.6061; val_kl_reg_loss: 70090.4277; val_edge_recon_loss: 606466.6953; val_gene_expr_recon_loss: 19956586.5000; val_masked_gp_l1_reg_loss: 84407.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108178.0547; val_chrom_access_recon_loss: 6270329.3125; val_global_loss: 27096058.2500; val_optim_loss: 27096058.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9199; val_auprc_score: 0.8958; val_best_acc_score: 0.8581; val_best_f1_score: 0.8672; train_kl_reg_loss: 70941.1886; train_edge_recon_loss: 597787.7652; train_gene_expr_recon_loss: 19887575.6667; train_masked_gp_l1_reg_loss: 84576.6977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107235.6366; train_chrom_access_recon_loss: 6210460.8258; train_global_loss: 26958577.7879; train_optim_loss: 26958577.7879; val_kl_reg_loss: 69525.1113; val_edge_recon_loss: 603957.7500; val_gene_expr_recon_loss: 19815166.7500; val_masked_gp_l1_reg_loss: 84867.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107198.7891; val_chrom_access_recon_loss: 6240398.0000; val_global_loss: 26921113.5000; val_optim_loss: 26921113.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9307; val_auprc_score: 0.9151; val_best_acc_score: 0.8641; val_best_f1_score: 0.8698; train_kl_reg_loss: 69682.6586; train_edge_recon_loss: 599275.6061; train_gene_expr_recon_loss: 19807025.7879; train_masked_gp_l1_reg_loss: 85070.7785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107112.6103; train_chrom_access_recon_loss: 6185832.4091; train_global_loss: 26853999.9394; train_optim_loss: 26853999.9394; val_kl_reg_loss: 70681.1006; val_edge_recon_loss: 604500.7266; val_gene_expr_recon_loss: 19695696.7500; val_masked_gp_l1_reg_loss: 85376.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106799.6094; val_chrom_access_recon_loss: 6217464.5000; val_global_loss: 26780518.7500; val_optim_loss: 26780518.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9329; val_auprc_score: 0.9114; val_best_acc_score: 0.8681; val_best_f1_score: 0.8746; train_kl_reg_loss: 69072.1531; train_edge_recon_loss: 595227.1023; train_gene_expr_recon_loss: 19773411.0606; train_masked_gp_l1_reg_loss: 85728.0732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106316.8413; train_chrom_access_recon_loss: 6174043.8561; train_global_loss: 26803798.9697; train_optim_loss: 26803798.9697; val_kl_reg_loss: 69716.5264; val_edge_recon_loss: 601638.0312; val_gene_expr_recon_loss: 19709323.5000; val_masked_gp_l1_reg_loss: 86008.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106040.5391; val_chrom_access_recon_loss: 6183605.8125; val_global_loss: 26756332.0000; val_optim_loss: 26756332.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9455; val_auprc_score: 0.9337; val_best_acc_score: 0.8804; val_best_f1_score: 0.8841; train_kl_reg_loss: 68482.1013; train_edge_recon_loss: 595295.1941; train_gene_expr_recon_loss: 19714579.2727; train_masked_gp_l1_reg_loss: 86254.5975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105568.3176; train_chrom_access_recon_loss: 6159386.0606; train_global_loss: 26729565.2727; train_optim_loss: 26729565.2727; val_kl_reg_loss: 68565.7803; val_edge_recon_loss: 595935.5078; val_gene_expr_recon_loss: 19728858.7500; val_masked_gp_l1_reg_loss: 86687.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104874.9219; val_chrom_access_recon_loss: 6205557.2500; val_global_loss: 26790479.5000; val_optim_loss: 26790479.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9355; val_auprc_score: 0.9148; val_best_acc_score: 0.8756; val_best_f1_score: 0.8824; train_kl_reg_loss: 67815.7473; train_edge_recon_loss: 593051.0473; train_gene_expr_recon_loss: 19661080.8485; train_masked_gp_l1_reg_loss: 86798.3246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104216.7649; train_chrom_access_recon_loss: 6133458.1818; train_global_loss: 26646421.0606; train_optim_loss: 26646421.0606; val_kl_reg_loss: 70494.5713; val_edge_recon_loss: 599030.3828; val_gene_expr_recon_loss: 19436093.2500; val_masked_gp_l1_reg_loss: 87251.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104453.7344; val_chrom_access_recon_loss: 6126727.8125; val_global_loss: 26424052.2500; val_optim_loss: 26424052.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9450; val_auprc_score: 0.9308; val_best_acc_score: 0.8842; val_best_f1_score: 0.8887; train_kl_reg_loss: 67531.1102; train_edge_recon_loss: 591780.5294; train_gene_expr_recon_loss: 19607650.9091; train_masked_gp_l1_reg_loss: 87419.9384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103132.3394; train_chrom_access_recon_loss: 6115831.6136; train_global_loss: 26573346.6364; train_optim_loss: 26573346.6364; val_kl_reg_loss: 67720.4424; val_edge_recon_loss: 597694.1094; val_gene_expr_recon_loss: 19608272.5000; val_masked_gp_l1_reg_loss: 87748.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102926.4844; val_chrom_access_recon_loss: 6179878.2500; val_global_loss: 26644240.0000; val_optim_loss: 26644240.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9483; val_auprc_score: 0.9309; val_best_acc_score: 0.8960; val_best_f1_score: 0.8996; train_kl_reg_loss: 66751.7960; train_edge_recon_loss: 592707.5928; train_gene_expr_recon_loss: 19572480.5455; train_masked_gp_l1_reg_loss: 88045.6224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102398.1384; train_chrom_access_recon_loss: 6104500.8333; train_global_loss: 26526884.5758; train_optim_loss: 26526884.5758; val_kl_reg_loss: 67678.4092; val_edge_recon_loss: 595353.7656; val_gene_expr_recon_loss: 19701778.7500; val_masked_gp_l1_reg_loss: 88380.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102012.4141; val_chrom_access_recon_loss: 6205685.6250; val_global_loss: 26760888.7500; val_optim_loss: 26760888.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9497; val_auprc_score: 0.9337; val_best_acc_score: 0.8963; val_best_f1_score: 0.8996; train_kl_reg_loss: 66640.6776; train_edge_recon_loss: 589019.0312; train_gene_expr_recon_loss: 19541741.3636; train_masked_gp_l1_reg_loss: 88656.2269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101362.1713; train_chrom_access_recon_loss: 6089016.4091; train_global_loss: 26476435.9697; train_optim_loss: 26476435.9697; val_kl_reg_loss: 66534.3008; val_edge_recon_loss: 593794.9375; val_gene_expr_recon_loss: 19602404.7500; val_masked_gp_l1_reg_loss: 89019.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100721.5625; val_chrom_access_recon_loss: 6161327.5000; val_global_loss: 26613803.2500; val_optim_loss: 26613803.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9507; val_auprc_score: 0.9344; val_best_acc_score: 0.8963; val_best_f1_score: 0.8995; train_kl_reg_loss: 66014.2312; train_edge_recon_loss: 588397.9536; train_gene_expr_recon_loss: 19493670.0606; train_masked_gp_l1_reg_loss: 89314.3153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100384.5795; train_chrom_access_recon_loss: 6079144.1288; train_global_loss: 26416925.2424; train_optim_loss: 26416925.2424; val_kl_reg_loss: 67054.5605; val_edge_recon_loss: 592018.7734; val_gene_expr_recon_loss: 19299117.7500; val_masked_gp_l1_reg_loss: 89714.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100456.4844; val_chrom_access_recon_loss: 6068820.6250; val_global_loss: 26217181.2500; val_optim_loss: 26217181.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9470; val_auprc_score: 0.9253; val_best_acc_score: 0.8931; val_best_f1_score: 0.8976; train_kl_reg_loss: 65182.2230; train_edge_recon_loss: 588613.9820; train_gene_expr_recon_loss: 19440731.5455; train_masked_gp_l1_reg_loss: 89919.7190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99903.9483; train_chrom_access_recon_loss: 6052792.1894; train_global_loss: 26337143.9091; train_optim_loss: 26337143.9091; val_kl_reg_loss: 65130.9009; val_edge_recon_loss: 593030.0703; val_gene_expr_recon_loss: 19457172.7500; val_masked_gp_l1_reg_loss: 90280.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99787.8906; val_chrom_access_recon_loss: 6137999.7500; val_global_loss: 26443401.0000; val_optim_loss: 26443401.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8940; val_auprc_score: 0.8578; val_best_acc_score: 0.8133; val_best_f1_score: 0.8370; train_kl_reg_loss: 32848.7457; train_edge_recon_loss: 765750.9811; train_gene_expr_recon_loss: 18210872.9091; train_masked_gp_l1_reg_loss: 91859.9274; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106020.0329; train_chrom_access_recon_loss: 5673052.4924; train_global_loss: 24880405.1212; train_optim_loss: 24880405.1212; val_kl_reg_loss: 12156.3413; val_edge_recon_loss: 791942.6172; val_gene_expr_recon_loss: 17866606.2500; val_masked_gp_l1_reg_loss: 92249.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117574.6016; val_chrom_access_recon_loss: 5572595.7500; val_global_loss: 24453125.2500; val_optim_loss: 24453125.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8886; val_auprc_score: 0.8515; val_best_acc_score: 0.8186; val_best_f1_score: 0.8335; train_kl_reg_loss: 17571.6824; train_edge_recon_loss: 775471.6278; train_gene_expr_recon_loss: 17657009.1818; train_masked_gp_l1_reg_loss: 90168.0221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117737.6140; train_chrom_access_recon_loss: 5520412.6061; train_global_loss: 24178370.8182; train_optim_loss: 24178370.8182; val_kl_reg_loss: 11726.2388; val_edge_recon_loss: 775572.9922; val_gene_expr_recon_loss: 17609848.5000; val_masked_gp_l1_reg_loss: 86957.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116719.4453; val_chrom_access_recon_loss: 5567912.8125; val_global_loss: 24168738.5000; val_optim_loss: 24168738.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8778; val_auprc_score: 0.8338; val_best_acc_score: 0.8098; val_best_f1_score: 0.8258; train_kl_reg_loss: 16821.1340; train_edge_recon_loss: 766609.2727; train_gene_expr_recon_loss: 17587630.7576; train_masked_gp_l1_reg_loss: 84140.6310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117519.5394; train_chrom_access_recon_loss: 5497621.6818; train_global_loss: 24070343.2121; train_optim_loss: 24070343.2121; val_kl_reg_loss: 11638.3837; val_edge_recon_loss: 774574.2500; val_gene_expr_recon_loss: 17390682.2500; val_masked_gp_l1_reg_loss: 81894.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118211.1250; val_chrom_access_recon_loss: 5478274.2500; val_global_loss: 23855275.2500; val_optim_loss: 23855275.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8777; val_auprc_score: 0.8388; val_best_acc_score: 0.8138; val_best_f1_score: 0.8353; train_kl_reg_loss: 16655.9850; train_edge_recon_loss: 746546.1212; train_gene_expr_recon_loss: 17511817.2273; train_masked_gp_l1_reg_loss: 80368.2396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117904.3864; train_chrom_access_recon_loss: 5479328.0909; train_global_loss: 23952620.0303; train_optim_loss: 23952620.0303; val_kl_reg_loss: 11964.9216; val_edge_recon_loss: 736533.0625; val_gene_expr_recon_loss: 17455448.7500; val_masked_gp_l1_reg_loss: 78805.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115721.8047; val_chrom_access_recon_loss: 5491432.9375; val_global_loss: 23889907.7500; val_optim_loss: 23889907.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8877; val_auprc_score: 0.8515; val_best_acc_score: 0.8178; val_best_f1_score: 0.8375; train_kl_reg_loss: 17731.2268; train_edge_recon_loss: 706323.8362; train_gene_expr_recon_loss: 17446336.5909; train_masked_gp_l1_reg_loss: 77497.7045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114437.7494; train_chrom_access_recon_loss: 5473800.7727; train_global_loss: 23836127.7576; train_optim_loss: 23836127.7576; val_kl_reg_loss: 15671.6350; val_edge_recon_loss: 679945.3906; val_gene_expr_recon_loss: 17436051.0000; val_masked_gp_l1_reg_loss: 76264.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112866.5156; val_chrom_access_recon_loss: 5481411.1875; val_global_loss: 23802209.7500; val_optim_loss: 23802209.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8762; val_auprc_score: 0.8400; val_best_acc_score: 0.8052; val_best_f1_score: 0.8267; train_kl_reg_loss: 20673.7836; train_edge_recon_loss: 665192.2064; train_gene_expr_recon_loss: 17393510.3030; train_masked_gp_l1_reg_loss: 75309.8170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110712.2795; train_chrom_access_recon_loss: 5453396.9621; train_global_loss: 23718795.3030; train_optim_loss: 23718795.3030; val_kl_reg_loss: 18422.4451; val_edge_recon_loss: 652323.6562; val_gene_expr_recon_loss: 17406292.5000; val_masked_gp_l1_reg_loss: 74468.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108889.7031; val_chrom_access_recon_loss: 5476837.4375; val_global_loss: 23737234.0000; val_optim_loss: 23737234.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8796; val_auprc_score: 0.8494; val_best_acc_score: 0.8049; val_best_f1_score: 0.8254; train_kl_reg_loss: 23665.4592; train_edge_recon_loss: 640369.0388; train_gene_expr_recon_loss: 17375400.4091; train_masked_gp_l1_reg_loss: 73771.1040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107876.4498; train_chrom_access_recon_loss: 5442521.3106; train_global_loss: 23663603.5152; train_optim_loss: 23663603.5152; val_kl_reg_loss: 21689.6333; val_edge_recon_loss: 625227.1875; val_gene_expr_recon_loss: 17220723.7500; val_masked_gp_l1_reg_loss: 73095.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107083.5156; val_chrom_access_recon_loss: 5472444.5000; val_global_loss: 23520265.0000; val_optim_loss: 23520265.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8797; val_auprc_score: 0.8451; val_best_acc_score: 0.8025; val_best_f1_score: 0.8242; train_kl_reg_loss: 26752.4054; train_edge_recon_loss: 624517.0587; train_gene_expr_recon_loss: 17353889.3333; train_masked_gp_l1_reg_loss: 72481.3094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105045.3285; train_chrom_access_recon_loss: 5437077.3712; train_global_loss: 23619762.7576; train_optim_loss: 23619762.7576; val_kl_reg_loss: 24101.4392; val_edge_recon_loss: 621630.2109; val_gene_expr_recon_loss: 17144149.5000; val_masked_gp_l1_reg_loss: 72022.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103900.4531; val_chrom_access_recon_loss: 5438106.6250; val_global_loss: 23403910.0000; val_optim_loss: 23403910.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8849; val_auprc_score: 0.8535; val_best_acc_score: 0.8109; val_best_f1_score: 0.8297; train_kl_reg_loss: 29668.6205; train_edge_recon_loss: 614021.8021; train_gene_expr_recon_loss: 17347209.0455; train_masked_gp_l1_reg_loss: 71542.4717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102977.3894; train_chrom_access_recon_loss: 5432184.0227; train_global_loss: 23597603.2121; train_optim_loss: 23597603.2121; val_kl_reg_loss: 26042.7402; val_edge_recon_loss: 602948.0781; val_gene_expr_recon_loss: 17247533.5000; val_masked_gp_l1_reg_loss: 71034.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102195.0000; val_chrom_access_recon_loss: 5453508.5000; val_global_loss: 23503261.2500; val_optim_loss: 23503261.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8868; val_auprc_score: 0.8573; val_best_acc_score: 0.8127; val_best_f1_score: 0.8326; train_kl_reg_loss: 31469.3057; train_edge_recon_loss: 605994.7907; train_gene_expr_recon_loss: 17279989.5758; train_masked_gp_l1_reg_loss: 70518.5244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101850.0786; train_chrom_access_recon_loss: 5420460.9470; train_global_loss: 23510283.3030; train_optim_loss: 23510283.3030; val_kl_reg_loss: 28633.3989; val_edge_recon_loss: 601220.5391; val_gene_expr_recon_loss: 17304895.0000; val_masked_gp_l1_reg_loss: 70085.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101673.2969; val_chrom_access_recon_loss: 5389245.5000; val_global_loss: 23495754.2500; val_optim_loss: 23495754.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8780; val_auprc_score: 0.8397; val_best_acc_score: 0.8004; val_best_f1_score: 0.8211; train_kl_reg_loss: 32883.5890; train_edge_recon_loss: 600937.4792; train_gene_expr_recon_loss: 17248679.8788; train_masked_gp_l1_reg_loss: 69601.2134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101370.8820; train_chrom_access_recon_loss: 5406625.0909; train_global_loss: 23460098.1818; train_optim_loss: 23460098.1818; val_kl_reg_loss: 31416.2424; val_edge_recon_loss: 604790.3438; val_gene_expr_recon_loss: 17264876.5000; val_masked_gp_l1_reg_loss: 69195.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101016.7812; val_chrom_access_recon_loss: 5390554.4375; val_global_loss: 23461849.7500; val_optim_loss: 23461849.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8860; val_auprc_score: 0.8585; val_best_acc_score: 0.8111; val_best_f1_score: 0.8224; train_kl_reg_loss: 34697.5001; train_edge_recon_loss: 596509.1534; train_gene_expr_recon_loss: 17223150.5758; train_masked_gp_l1_reg_loss: 68698.5017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100749.0273; train_chrom_access_recon_loss: 5402441.4167; train_global_loss: 23426246.1515; train_optim_loss: 23426246.1515; val_kl_reg_loss: 32358.7434; val_edge_recon_loss: 602206.3828; val_gene_expr_recon_loss: 17213467.7500; val_masked_gp_l1_reg_loss: 68255.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100623.8750; val_chrom_access_recon_loss: 5421754.6250; val_global_loss: 23438667.7500; val_optim_loss: 23438667.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8824; val_auprc_score: 0.8530; val_best_acc_score: 0.8017; val_best_f1_score: 0.8203; train_kl_reg_loss: 34678.7984; train_edge_recon_loss: 596854.5786; train_gene_expr_recon_loss: 17200281.4242; train_masked_gp_l1_reg_loss: 67799.0120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85297.6125; train_chrom_access_recon_loss: 5396708.3106; train_global_loss: 23381619.7576; train_optim_loss: 23381619.7576; val_kl_reg_loss: 33182.1257; val_edge_recon_loss: 603607.8594; val_gene_expr_recon_loss: 17290266.2500; val_masked_gp_l1_reg_loss: 67576.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81967.5312; val_chrom_access_recon_loss: 5472080.9375; val_global_loss: 23548681.2500; val_optim_loss: 23548681.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8736; val_auprc_score: 0.8435; val_best_acc_score: 0.7988; val_best_f1_score: 0.8174; train_kl_reg_loss: 34956.7571; train_edge_recon_loss: 595808.9309; train_gene_expr_recon_loss: 17177125.6818; train_masked_gp_l1_reg_loss: 67486.2390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81451.8595; train_chrom_access_recon_loss: 5387924.0606; train_global_loss: 23344753.2121; train_optim_loss: 23344753.2121; val_kl_reg_loss: 32480.4385; val_edge_recon_loss: 612320.9531; val_gene_expr_recon_loss: 17275688.2500; val_masked_gp_l1_reg_loss: 67420.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81116.3125; val_chrom_access_recon_loss: 5489623.1875; val_global_loss: 23558648.7500; val_optim_loss: 23558648.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8755; val_auprc_score: 0.8383; val_best_acc_score: 0.8031; val_best_f1_score: 0.8226; train_kl_reg_loss: 34997.0221; train_edge_recon_loss: 598807.1600; train_gene_expr_recon_loss: 17187498.2576; train_masked_gp_l1_reg_loss: 67350.7988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80892.1045; train_chrom_access_recon_loss: 5396364.7424; train_global_loss: 23365909.9091; train_optim_loss: 23365909.9091; val_kl_reg_loss: 33316.8696; val_edge_recon_loss: 601433.4297; val_gene_expr_recon_loss: 17293547.5000; val_masked_gp_l1_reg_loss: 67297.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80623.2578; val_chrom_access_recon_loss: 5461800.9375; val_global_loss: 23538021.0000; val_optim_loss: 23538021.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8777; val_auprc_score: 0.8392; val_best_acc_score: 0.8055; val_best_f1_score: 0.8278; train_kl_reg_loss: 35383.6816; train_edge_recon_loss: 595299.8864; train_gene_expr_recon_loss: 17174115.8788; train_masked_gp_l1_reg_loss: 67232.3050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80477.9399; train_chrom_access_recon_loss: 5387102.0833; train_global_loss: 23339612.0303; train_optim_loss: 23339612.0303; val_kl_reg_loss: 33373.5679; val_edge_recon_loss: 592660.8828; val_gene_expr_recon_loss: 17130640.3750; val_masked_gp_l1_reg_loss: 67174.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80261.6250; val_chrom_access_recon_loss: 5387179.3125; val_global_loss: 23291290.0000; val_optim_loss: 23291290.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8813; val_auprc_score: 0.8454; val_best_acc_score: 0.8057; val_best_f1_score: 0.8259; train_kl_reg_loss: 35445.8882; train_edge_recon_loss: 594955.7784; train_gene_expr_recon_loss: 17171965.2727; train_masked_gp_l1_reg_loss: 67120.3340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80120.7370; train_chrom_access_recon_loss: 5386302.7879; train_global_loss: 23335910.6061; train_optim_loss: 23335910.6061; val_kl_reg_loss: 33578.5347; val_edge_recon_loss: 602576.0234; val_gene_expr_recon_loss: 17132361.5000; val_masked_gp_l1_reg_loss: 67062.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79978.5625; val_chrom_access_recon_loss: 5395951.5625; val_global_loss: 23311507.5000; val_optim_loss: 23311507.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8834; val_auprc_score: 0.8495; val_best_acc_score: 0.8076; val_best_f1_score: 0.8273; train_kl_reg_loss: 35649.8571; train_edge_recon_loss: 593494.1316; train_gene_expr_recon_loss: 17176408.2879; train_masked_gp_l1_reg_loss: 66995.6049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79840.3823; train_chrom_access_recon_loss: 5383054.8788; train_global_loss: 23335442.9697; train_optim_loss: 23335442.9697; val_kl_reg_loss: 33850.2922; val_edge_recon_loss: 597046.0234; val_gene_expr_recon_loss: 17159602.6250; val_masked_gp_l1_reg_loss: 66935.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79634.0391; val_chrom_access_recon_loss: 5462754.0000; val_global_loss: 23399823.2500; val_optim_loss: 23399823.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8949; val_auprc_score: 0.8623; val_best_acc_score: 0.8157; val_best_f1_score: 0.8325; train_kl_reg_loss: 35720.7604; train_edge_recon_loss: 592890.0114; train_gene_expr_recon_loss: 17160999.8485; train_masked_gp_l1_reg_loss: 66885.2179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79533.6987; train_chrom_access_recon_loss: 5381267.2348; train_global_loss: 23317296.8182; train_optim_loss: 23317296.8182; val_kl_reg_loss: 34130.1294; val_edge_recon_loss: 590331.9766; val_gene_expr_recon_loss: 17175139.0000; val_masked_gp_l1_reg_loss: 66834.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79368.6562; val_chrom_access_recon_loss: 5430319.0000; val_global_loss: 23376122.0000; val_optim_loss: 23376122.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8812; val_auprc_score: 0.8429; val_best_acc_score: 0.8071; val_best_f1_score: 0.8241; train_kl_reg_loss: 35961.1674; train_edge_recon_loss: 593638.8362; train_gene_expr_recon_loss: 17166256.3485; train_masked_gp_l1_reg_loss: 66773.5528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79257.3710; train_chrom_access_recon_loss: 5385135.5227; train_global_loss: 23327022.5758; train_optim_loss: 23327022.5758; val_kl_reg_loss: 34504.1108; val_edge_recon_loss: 601362.8359; val_gene_expr_recon_loss: 17298979.6250; val_masked_gp_l1_reg_loss: 66701.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79095.3438; val_chrom_access_recon_loss: 5477495.3750; val_global_loss: 23558139.7500; val_optim_loss: 23558139.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8829; val_auprc_score: 0.8492; val_best_acc_score: 0.8044; val_best_f1_score: 0.8249; train_kl_reg_loss: 35914.4084; train_edge_recon_loss: 595253.5587; train_gene_expr_recon_loss: 17167752.0152; train_masked_gp_l1_reg_loss: 66654.5490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77506.5094; train_chrom_access_recon_loss: 5390322.4848; train_global_loss: 23333403.8182; train_optim_loss: 23333403.8182; val_kl_reg_loss: 34257.1289; val_edge_recon_loss: 592297.3125; val_gene_expr_recon_loss: 17009460.2500; val_masked_gp_l1_reg_loss: 66630.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77169.7266; val_chrom_access_recon_loss: 5358260.6250; val_global_loss: 23138075.0000; val_optim_loss: 23138075.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8805; val_auprc_score: 0.8481; val_best_acc_score: 0.8039; val_best_f1_score: 0.8246; train_kl_reg_loss: 36023.1250; train_edge_recon_loss: 596638.1809; train_gene_expr_recon_loss: 17163934.6212; train_masked_gp_l1_reg_loss: 66617.0032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77115.2512; train_chrom_access_recon_loss: 5384577.3030; train_global_loss: 23324905.6364; train_optim_loss: 23324905.6364; val_kl_reg_loss: 34199.3430; val_edge_recon_loss: 599392.9766; val_gene_expr_recon_loss: 17179537.5000; val_masked_gp_l1_reg_loss: 66605.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77064.7969; val_chrom_access_recon_loss: 5424523.1250; val_global_loss: 23381322.2500; val_optim_loss: 23381322.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8826; val_auprc_score: 0.8537; val_best_acc_score: 0.8095; val_best_f1_score: 0.8256; train_kl_reg_loss: 35965.8037; train_edge_recon_loss: 594186.9470; train_gene_expr_recon_loss: 17158697.1364; train_masked_gp_l1_reg_loss: 66595.4418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77028.7580; train_chrom_access_recon_loss: 5382561.4621; train_global_loss: 23315035.7576; train_optim_loss: 23315035.7576; val_kl_reg_loss: 34236.2046; val_edge_recon_loss: 602469.6484; val_gene_expr_recon_loss: 17074976.0000; val_masked_gp_l1_reg_loss: 66586.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76985.7812; val_chrom_access_recon_loss: 5390051.1250; val_global_loss: 23245304.7500; val_optim_loss: 23245304.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8929; val_auprc_score: 0.8648; val_best_acc_score: 0.8127; val_best_f1_score: 0.8305; train_kl_reg_loss: 36015.1004; train_edge_recon_loss: 594738.9470; train_gene_expr_recon_loss: 17176242.6667; train_masked_gp_l1_reg_loss: 66578.3406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76960.3313; train_chrom_access_recon_loss: 5385733.9470; train_global_loss: 23336269.2727; train_optim_loss: 23336269.2727; val_kl_reg_loss: 33927.3984; val_edge_recon_loss: 593630.5781; val_gene_expr_recon_loss: 16986328.5000; val_masked_gp_l1_reg_loss: 66570.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76934.4766; val_chrom_access_recon_loss: 5363843.8125; val_global_loss: 23121234.5000; val_optim_loss: 23121234.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8818; val_auprc_score: 0.8540; val_best_acc_score: 0.8060; val_best_f1_score: 0.8237; train_kl_reg_loss: 36105.4867; train_edge_recon_loss: 592690.3040; train_gene_expr_recon_loss: 17157308.7879; train_masked_gp_l1_reg_loss: 66563.2406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76914.1746; train_chrom_access_recon_loss: 5381759.6212; train_global_loss: 23311341.6364; train_optim_loss: 23311341.6364; val_kl_reg_loss: 34629.9741; val_edge_recon_loss: 596613.0781; val_gene_expr_recon_loss: 17245474.8750; val_masked_gp_l1_reg_loss: 66556.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76890.0156; val_chrom_access_recon_loss: 5489101.1250; val_global_loss: 23509265.2500; val_optim_loss: 23509265.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8867; val_auprc_score: 0.8584; val_best_acc_score: 0.8092; val_best_f1_score: 0.8278; train_kl_reg_loss: 36054.2434; train_edge_recon_loss: 596017.4100; train_gene_expr_recon_loss: 17162360.9545; train_masked_gp_l1_reg_loss: 66549.0786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76862.0198; train_chrom_access_recon_loss: 5384005.6818; train_global_loss: 23321849.4545; train_optim_loss: 23321849.4545; val_kl_reg_loss: 34322.4751; val_edge_recon_loss: 598763.3047; val_gene_expr_recon_loss: 17026866.0000; val_masked_gp_l1_reg_loss: 66541.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76839.9844; val_chrom_access_recon_loss: 5493055.0000; val_global_loss: 23296389.2500; val_optim_loss: 23296389.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8858; val_auprc_score: 0.8582; val_best_acc_score: 0.8063; val_best_f1_score: 0.8247; train_kl_reg_loss: 36011.4803; train_edge_recon_loss: 594415.6989; train_gene_expr_recon_loss: 17148846.9848; train_masked_gp_l1_reg_loss: 66534.1629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76819.5182; train_chrom_access_recon_loss: 5381899.2197; train_global_loss: 23304527.2121; train_optim_loss: 23304527.2121; val_kl_reg_loss: 34463.4717; val_edge_recon_loss: 595345.1562; val_gene_expr_recon_loss: 17199115.2500; val_masked_gp_l1_reg_loss: 66527.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76796.1875; val_chrom_access_recon_loss: 5416896.1250; val_global_loss: 23389143.7500; val_optim_loss: 23389143.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8854; val_auprc_score: 0.8612; val_best_acc_score: 0.8033; val_best_f1_score: 0.8229; train_kl_reg_loss: 36053.6313; train_edge_recon_loss: 592172.9981; train_gene_expr_recon_loss: 17165141.9394; train_masked_gp_l1_reg_loss: 66519.7044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76781.2569; train_chrom_access_recon_loss: 5382003.6970; train_global_loss: 23318673.0909; train_optim_loss: 23318673.0909; val_kl_reg_loss: 34443.8496; val_edge_recon_loss: 608407.7578; val_gene_expr_recon_loss: 17211095.2500; val_masked_gp_l1_reg_loss: 66512.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76760.3984; val_chrom_access_recon_loss: 5446945.6875; val_global_loss: 23444164.7500; val_optim_loss: 23444164.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8821; val_auprc_score: 0.8508; val_best_acc_score: 0.8079; val_best_f1_score: 0.8297; train_kl_reg_loss: 36110.1844; train_edge_recon_loss: 595425.9176; train_gene_expr_recon_loss: 17162219.6364; train_masked_gp_l1_reg_loss: 66507.8365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76598.7944; train_chrom_access_recon_loss: 5381066.4015; train_global_loss: 23317928.8182; train_optim_loss: 23317928.8182; val_kl_reg_loss: 34492.0264; val_edge_recon_loss: 589484.6250; val_gene_expr_recon_loss: 17173258.7500; val_masked_gp_l1_reg_loss: 66505.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76565.6406; val_chrom_access_recon_loss: 5415518.1875; val_global_loss: 23355825.5000; val_optim_loss: 23355825.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8894; val_auprc_score: 0.8567; val_best_acc_score: 0.8154; val_best_f1_score: 0.8248; train_kl_reg_loss: 36050.6493; train_edge_recon_loss: 594681.2879; train_gene_expr_recon_loss: 17159005.2121; train_masked_gp_l1_reg_loss: 66503.6952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76560.5490; train_chrom_access_recon_loss: 5377456.8864; train_global_loss: 23310258.3939; train_optim_loss: 23310258.3939; val_kl_reg_loss: 34277.5688; val_edge_recon_loss: 600754.1016; val_gene_expr_recon_loss: 17104412.7500; val_masked_gp_l1_reg_loss: 66502.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76556.1250; val_chrom_access_recon_loss: 5435599.3750; val_global_loss: 23318102.7500; val_optim_loss: 23318102.7500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8759; val_auprc_score: 0.8379; val_best_acc_score: 0.8004; val_best_f1_score: 0.8218; train_kl_reg_loss: 36041.5053; train_edge_recon_loss: 594966.5833; train_gene_expr_recon_loss: 17173250.5606; train_masked_gp_l1_reg_loss: 66501.4878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76553.0161; train_chrom_access_recon_loss: 5384634.5076; train_global_loss: 23331947.5455; train_optim_loss: 23331947.5455; val_kl_reg_loss: 34587.3315; val_edge_recon_loss: 600444.7969; val_gene_expr_recon_loss: 17308666.5000; val_masked_gp_l1_reg_loss: 66500.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76548.8516; val_chrom_access_recon_loss: 5512817.8750; val_global_loss: 23599564.5000; val_optim_loss: 23599564.5000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.8829; val_auprc_score: 0.8477; val_best_acc_score: 0.8071; val_best_f1_score: 0.8257; train_kl_reg_loss: 36068.8962; train_edge_recon_loss: 595983.2434; train_gene_expr_recon_loss: 17172987.5303; train_masked_gp_l1_reg_loss: 66499.5503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76546.5004; train_chrom_access_recon_loss: 5385876.1439; train_global_loss: 23333961.8485; train_optim_loss: 23333961.8485; val_kl_reg_loss: 34591.9116; val_edge_recon_loss: 598284.5078; val_gene_expr_recon_loss: 17209599.8750; val_masked_gp_l1_reg_loss: 66498.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76543.1484; val_chrom_access_recon_loss: 5436887.3750; val_global_loss: 23422405.7500; val_optim_loss: 23422405.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 18 min 32 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.8822
val AUPRC score: 0.8453
val best accuracy score: 0.8133
val best F1 score: 0.8315
val target rna MSE score: 1.6426
val source rna MSE score: 1.0266
val target atac MSE score: 0.3313
val source atac MSE score: 0.1391
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
