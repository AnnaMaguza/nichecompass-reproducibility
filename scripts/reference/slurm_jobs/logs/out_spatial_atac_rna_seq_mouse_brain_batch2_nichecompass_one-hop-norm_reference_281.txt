[True]
Run timestamp: 07092023_061751_281.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_281']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2944 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 6573, n_cat_covariates_embed_input: 0, n_hidden: 2386, n_latent: 2286, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3629
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2944
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2944

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7824; val_auprc_score: 0.7927; val_best_acc_score: 0.5058; val_best_f1_score: 0.6689; train_kl_reg_loss: 75216.0811; train_edge_recon_loss: 3530897.8416; train_gene_expr_recon_loss: 15062012.9084; train_masked_gp_l1_reg_loss: 40948.7687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4479226.1758; train_chrom_access_recon_loss: 13532672.5267; train_global_loss: 36720974.2748; train_optim_loss: 36720974.2748; val_kl_reg_loss: 124408.5844; val_edge_recon_loss: 4064378.3500; val_gene_expr_recon_loss: 14074040.0000; val_masked_gp_l1_reg_loss: 37187.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 364058.1562; val_chrom_access_recon_loss: 13182775.6000; val_global_loss: 31846848.5333; val_optim_loss: 31846848.5333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8678; val_auprc_score: 0.8716; val_best_acc_score: 0.5625; val_best_f1_score: 0.6942; train_kl_reg_loss: 102297.4364; train_edge_recon_loss: 3524953.1260; train_gene_expr_recon_loss: 13839209.0382; train_masked_gp_l1_reg_loss: 36132.1139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 217425.3119; train_chrom_access_recon_loss: 12898055.0458; train_global_loss: 30618072.0305; train_optim_loss: 30618072.0305; val_kl_reg_loss: 86965.0693; val_edge_recon_loss: 4061435.4667; val_gene_expr_recon_loss: 13853262.8667; val_masked_gp_l1_reg_loss: 36137.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155841.4062; val_chrom_access_recon_loss: 12977170.7333; val_global_loss: 31170814.0000; val_optim_loss: 31170814.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9062; val_auprc_score: 0.8994; val_best_acc_score: 0.8211; val_best_f1_score: 0.8248; train_kl_reg_loss: 86254.2901; train_edge_recon_loss: 3512951.2176; train_gene_expr_recon_loss: 13634490.1527; train_masked_gp_l1_reg_loss: 37412.2974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139623.6054; train_chrom_access_recon_loss: 12719190.0305; train_global_loss: 30129921.4046; train_optim_loss: 30129921.4046; val_kl_reg_loss: 81653.6219; val_edge_recon_loss: 3992205.9000; val_gene_expr_recon_loss: 13716256.0000; val_masked_gp_l1_reg_loss: 38983.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129231.5859; val_chrom_access_recon_loss: 12816049.2000; val_global_loss: 30774380.9333; val_optim_loss: 30774380.9333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8735; val_auprc_score: 0.8660; val_best_acc_score: 0.7705; val_best_f1_score: 0.7963; train_kl_reg_loss: 71139.1316; train_edge_recon_loss: 3290657.2977; train_gene_expr_recon_loss: 13481051.8092; train_masked_gp_l1_reg_loss: 41196.2734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124297.5922; train_chrom_access_recon_loss: 12567316.8473; train_global_loss: 29575658.9008; train_optim_loss: 29575658.9008; val_kl_reg_loss: 90990.6828; val_edge_recon_loss: 2983487.7000; val_gene_expr_recon_loss: 13566581.6667; val_masked_gp_l1_reg_loss: 43443.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121019.7266; val_chrom_access_recon_loss: 12693618.9333; val_global_loss: 29499142.5333; val_optim_loss: 29499142.5333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8859; val_auprc_score: 0.8740; val_best_acc_score: 0.7917; val_best_f1_score: 0.8123; train_kl_reg_loss: 98903.2930; train_edge_recon_loss: 2960861.6832; train_gene_expr_recon_loss: 13348232.7023; train_masked_gp_l1_reg_loss: 44637.1752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116648.0839; train_chrom_access_recon_loss: 12441357.3588; train_global_loss: 29010640.3359; train_optim_loss: 29010640.3359; val_kl_reg_loss: 105972.9146; val_edge_recon_loss: 2922863.2500; val_gene_expr_recon_loss: 13404314.3333; val_masked_gp_l1_reg_loss: 45757.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113863.4531; val_chrom_access_recon_loss: 12488397.0667; val_global_loss: 29081169.0667; val_optim_loss: 29081169.0667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9054; val_auprc_score: 0.8980; val_best_acc_score: 0.8197; val_best_f1_score: 0.8329; train_kl_reg_loss: 97238.3194; train_edge_recon_loss: 2920724.8149; train_gene_expr_recon_loss: 13231826.4122; train_masked_gp_l1_reg_loss: 46907.1806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111167.1395; train_chrom_access_recon_loss: 12331103.6489; train_global_loss: 28738967.6947; train_optim_loss: 28738967.6947; val_kl_reg_loss: 95009.4812; val_edge_recon_loss: 2882203.3667; val_gene_expr_recon_loss: 13277147.5333; val_masked_gp_l1_reg_loss: 47972.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109585.3281; val_chrom_access_recon_loss: 12364313.8667; val_global_loss: 28776232.4000; val_optim_loss: 28776232.4000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9177; val_auprc_score: 0.9038; val_best_acc_score: 0.8420; val_best_f1_score: 0.8523; train_kl_reg_loss: 93244.5171; train_edge_recon_loss: 2870635.8225; train_gene_expr_recon_loss: 13134566.7939; train_masked_gp_l1_reg_loss: 49143.7371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108136.1525; train_chrom_access_recon_loss: 12234748.0229; train_global_loss: 28490475.0076; train_optim_loss: 28490475.0076; val_kl_reg_loss: 93127.7427; val_edge_recon_loss: 2861758.7667; val_gene_expr_recon_loss: 13252949.4000; val_masked_gp_l1_reg_loss: 50133.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107506.5469; val_chrom_access_recon_loss: 12346285.4000; val_global_loss: 28711761.0667; val_optim_loss: 28711761.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9403; val_auprc_score: 0.9272; val_best_acc_score: 0.8759; val_best_f1_score: 0.8826; train_kl_reg_loss: 97248.1690; train_edge_recon_loss: 2803558.5611; train_gene_expr_recon_loss: 13034410.1756; train_masked_gp_l1_reg_loss: 51217.2954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106964.6183; train_chrom_access_recon_loss: 12154138.3282; train_global_loss: 28247537.2519; train_optim_loss: 28247537.2519; val_kl_reg_loss: 95359.9812; val_edge_recon_loss: 2796725.1167; val_gene_expr_recon_loss: 13200559.8000; val_masked_gp_l1_reg_loss: 52087.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106510.6797; val_chrom_access_recon_loss: 12343174.4000; val_global_loss: 28594417.6000; val_optim_loss: 28594417.6000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9397; val_auprc_score: 0.9276; val_best_acc_score: 0.8703; val_best_f1_score: 0.8792; train_kl_reg_loss: 97273.0955; train_edge_recon_loss: 2784740.8454; train_gene_expr_recon_loss: 12962148.8244; train_masked_gp_l1_reg_loss: 53019.8515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106217.8732; train_chrom_access_recon_loss: 12063034.4656; train_global_loss: 28066435.0229; train_optim_loss: 28066435.0229; val_kl_reg_loss: 98062.9125; val_edge_recon_loss: 2781356.4333; val_gene_expr_recon_loss: 13040488.0667; val_masked_gp_l1_reg_loss: 53893.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106115.7109; val_chrom_access_recon_loss: 12213424.0667; val_global_loss: 28293341.3333; val_optim_loss: 28293341.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9408; val_auprc_score: 0.9270; val_best_acc_score: 0.8770; val_best_f1_score: 0.8834; train_kl_reg_loss: 98072.1588; train_edge_recon_loss: 2767951.9905; train_gene_expr_recon_loss: 12887296.6718; train_masked_gp_l1_reg_loss: 54612.4841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105893.9918; train_chrom_access_recon_loss: 11993318.4046; train_global_loss: 27907145.6947; train_optim_loss: 27907145.6947; val_kl_reg_loss: 98796.7620; val_edge_recon_loss: 2784993.7333; val_gene_expr_recon_loss: 12961535.8667; val_masked_gp_l1_reg_loss: 55370.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105987.3047; val_chrom_access_recon_loss: 12102092.2667; val_global_loss: 28108775.7333; val_optim_loss: 28108775.7333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9495; val_auprc_score: 0.9360; val_best_acc_score: 0.8867; val_best_f1_score: 0.8901; train_kl_reg_loss: 96476.2376; train_edge_recon_loss: 2754441.6546; train_gene_expr_recon_loss: 12819523.8550; train_masked_gp_l1_reg_loss: 56049.6065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105494.0881; train_chrom_access_recon_loss: 11923454.9771; train_global_loss: 27755440.5649; train_optim_loss: 27755440.5649; val_kl_reg_loss: 97876.9240; val_edge_recon_loss: 2738966.8167; val_gene_expr_recon_loss: 12879968.8000; val_masked_gp_l1_reg_loss: 56892.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105215.0547; val_chrom_access_recon_loss: 12008016.3333; val_global_loss: 27886935.8667; val_optim_loss: 27886935.8667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9481; val_auprc_score: 0.9344; val_best_acc_score: 0.8887; val_best_f1_score: 0.8954; train_kl_reg_loss: 94624.6494; train_edge_recon_loss: 2739790.1737; train_gene_expr_recon_loss: 12757794.1756; train_masked_gp_l1_reg_loss: 57465.1620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104966.0497; train_chrom_access_recon_loss: 11866144.8168; train_global_loss: 27620785.1298; train_optim_loss: 27620785.1298; val_kl_reg_loss: 92354.2135; val_edge_recon_loss: 2752511.7000; val_gene_expr_recon_loss: 12802506.1333; val_masked_gp_l1_reg_loss: 58050.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104824.8359; val_chrom_access_recon_loss: 11973766.6667; val_global_loss: 27784014.5333; val_optim_loss: 27784014.5333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9529; val_auprc_score: 0.9416; val_best_acc_score: 0.8926; val_best_f1_score: 0.8987; train_kl_reg_loss: 92395.2694; train_edge_recon_loss: 2743285.5000; train_gene_expr_recon_loss: 12702434.3740; train_masked_gp_l1_reg_loss: 58671.4713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104708.2798; train_chrom_access_recon_loss: 11809119.5267; train_global_loss: 27510614.4275; train_optim_loss: 27510614.4275; val_kl_reg_loss: 94299.8734; val_edge_recon_loss: 2726262.2833; val_gene_expr_recon_loss: 12783044.0667; val_masked_gp_l1_reg_loss: 59296.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104904.2969; val_chrom_access_recon_loss: 11902245.0000; val_global_loss: 27670052.1333; val_optim_loss: 27670052.1333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9564; val_auprc_score: 0.9441; val_best_acc_score: 0.8975; val_best_f1_score: 0.9016; train_kl_reg_loss: 91761.4377; train_edge_recon_loss: 2727861.3607; train_gene_expr_recon_loss: 12652744.4504; train_masked_gp_l1_reg_loss: 59829.7857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104719.8417; train_chrom_access_recon_loss: 11758163.9008; train_global_loss: 27395080.8092; train_optim_loss: 27395080.8092; val_kl_reg_loss: 91966.1187; val_edge_recon_loss: 2742241.1500; val_gene_expr_recon_loss: 12783468.4000; val_masked_gp_l1_reg_loss: 60382.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104789.2500; val_chrom_access_recon_loss: 11891776.6000; val_global_loss: 27674624.2667; val_optim_loss: 27674624.2667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9589; val_auprc_score: 0.9481; val_best_acc_score: 0.8998; val_best_f1_score: 0.9030; train_kl_reg_loss: 89606.4771; train_edge_recon_loss: 2734041.2214; train_gene_expr_recon_loss: 12596701.5573; train_masked_gp_l1_reg_loss: 60871.7322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104535.7551; train_chrom_access_recon_loss: 11699066.1527; train_global_loss: 27284823.0076; train_optim_loss: 27284823.0076; val_kl_reg_loss: 88349.3469; val_edge_recon_loss: 2736061.6667; val_gene_expr_recon_loss: 12722516.1333; val_masked_gp_l1_reg_loss: 61352.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105131.9062; val_chrom_access_recon_loss: 11867154.1333; val_global_loss: 27580565.4667; val_optim_loss: 27580565.4667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9556; val_auprc_score: 0.9407; val_best_acc_score: 0.8979; val_best_f1_score: 0.9016; train_kl_reg_loss: 88244.6126; train_edge_recon_loss: 2722413.9962; train_gene_expr_recon_loss: 12566585.4046; train_masked_gp_l1_reg_loss: 61843.3154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105029.8544; train_chrom_access_recon_loss: 11659927.1756; train_global_loss: 27204044.4122; train_optim_loss: 27204044.4122; val_kl_reg_loss: 88853.7036; val_edge_recon_loss: 2725405.2833; val_gene_expr_recon_loss: 12686620.6667; val_masked_gp_l1_reg_loss: 62373.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105369.2500; val_chrom_access_recon_loss: 11781929.9333; val_global_loss: 27450552.5333; val_optim_loss: 27450552.5333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9619; val_auprc_score: 0.9491; val_best_acc_score: 0.9074; val_best_f1_score: 0.9113; train_kl_reg_loss: 87362.0267; train_edge_recon_loss: 2722008.8779; train_gene_expr_recon_loss: 12539472.6412; train_masked_gp_l1_reg_loss: 62740.1852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105442.8929; train_chrom_access_recon_loss: 11630041.2519; train_global_loss: 27147067.8473; train_optim_loss: 27147067.8473; val_kl_reg_loss: 85813.3693; val_edge_recon_loss: 2708407.1000; val_gene_expr_recon_loss: 12634323.0000; val_masked_gp_l1_reg_loss: 63151.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105546.0078; val_chrom_access_recon_loss: 11783400.0667; val_global_loss: 27380640.6667; val_optim_loss: 27380640.6667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9624; val_auprc_score: 0.9496; val_best_acc_score: 0.9085; val_best_f1_score: 0.9127; train_kl_reg_loss: 86396.6011; train_edge_recon_loss: 2708904.8168; train_gene_expr_recon_loss: 12487281.3588; train_masked_gp_l1_reg_loss: 63585.7295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105860.0735; train_chrom_access_recon_loss: 11567890.2519; train_global_loss: 27019918.8092; train_optim_loss: 27019918.8092; val_kl_reg_loss: 86574.8271; val_edge_recon_loss: 2726764.2333; val_gene_expr_recon_loss: 12608269.3333; val_masked_gp_l1_reg_loss: 64006.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106443.5234; val_chrom_access_recon_loss: 11699065.5333; val_global_loss: 27291125.2000; val_optim_loss: 27291125.2000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9651; val_auprc_score: 0.9564; val_best_acc_score: 0.9101; val_best_f1_score: 0.9143; train_kl_reg_loss: 85893.7366; train_edge_recon_loss: 2710408.8111; train_gene_expr_recon_loss: 12452952.5115; train_masked_gp_l1_reg_loss: 64377.0480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106766.4520; train_chrom_access_recon_loss: 11536717.1374; train_global_loss: 26957115.7405; train_optim_loss: 26957115.7405; val_kl_reg_loss: 85762.9995; val_edge_recon_loss: 2720805.5000; val_gene_expr_recon_loss: 12515804.0000; val_masked_gp_l1_reg_loss: 64806.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107401.7734; val_chrom_access_recon_loss: 11638355.2000; val_global_loss: 27132936.0000; val_optim_loss: 27132936.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9688; val_auprc_score: 0.9566; val_best_acc_score: 0.9189; val_best_f1_score: 0.9218; train_kl_reg_loss: 84804.6848; train_edge_recon_loss: 2710930.6966; train_gene_expr_recon_loss: 12430386.8473; train_masked_gp_l1_reg_loss: 65099.1291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107767.1048; train_chrom_access_recon_loss: 11503702.1374; train_global_loss: 26902690.5496; train_optim_loss: 26902690.5496; val_kl_reg_loss: 84358.5443; val_edge_recon_loss: 2704908.5333; val_gene_expr_recon_loss: 12562192.8000; val_masked_gp_l1_reg_loss: 65462.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107597.6641; val_chrom_access_recon_loss: 11688211.8000; val_global_loss: 27212732.5333; val_optim_loss: 27212732.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9665; val_auprc_score: 0.9575; val_best_acc_score: 0.9135; val_best_f1_score: 0.9179; train_kl_reg_loss: 84098.0286; train_edge_recon_loss: 2702712.7347; train_gene_expr_recon_loss: 12400480.8779; train_masked_gp_l1_reg_loss: 65847.2641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108618.1764; train_chrom_access_recon_loss: 11459149.9237; train_global_loss: 26820907.1450; train_optim_loss: 26820907.1450; val_kl_reg_loss: 82708.2365; val_edge_recon_loss: 2718310.1000; val_gene_expr_recon_loss: 12511566.0000; val_masked_gp_l1_reg_loss: 66254.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108392.9453; val_chrom_access_recon_loss: 11621121.8667; val_global_loss: 27108354.1333; val_optim_loss: 27108354.1333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9687; val_auprc_score: 0.9618; val_best_acc_score: 0.9185; val_best_f1_score: 0.9226; train_kl_reg_loss: 83949.4267; train_edge_recon_loss: 2696066.8302; train_gene_expr_recon_loss: 12378710.7405; train_masked_gp_l1_reg_loss: 66446.4647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108967.2001; train_chrom_access_recon_loss: 11433896.9084; train_global_loss: 26768037.6489; train_optim_loss: 26768037.6489; val_kl_reg_loss: 84548.8464; val_edge_recon_loss: 2717896.3000; val_gene_expr_recon_loss: 12488492.4667; val_masked_gp_l1_reg_loss: 66747.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109585.5078; val_chrom_access_recon_loss: 11622704.1333; val_global_loss: 27089975.6000; val_optim_loss: 27089975.6000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9707; val_auprc_score: 0.9609; val_best_acc_score: 0.9223; val_best_f1_score: 0.9248; train_kl_reg_loss: 82901.6919; train_edge_recon_loss: 2699393.3588; train_gene_expr_recon_loss: 12348581.6412; train_masked_gp_l1_reg_loss: 67102.9068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109316.0635; train_chrom_access_recon_loss: 11404106.5573; train_global_loss: 26711402.2595; train_optim_loss: 26711402.2595; val_kl_reg_loss: 81679.0396; val_edge_recon_loss: 2706923.7167; val_gene_expr_recon_loss: 12461765.6000; val_masked_gp_l1_reg_loss: 67408.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109675.4609; val_chrom_access_recon_loss: 11596983.3333; val_global_loss: 27024435.7333; val_optim_loss: 27024435.7333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9760; val_auprc_score: 0.9716; val_best_acc_score: 0.9266; val_best_f1_score: 0.9287; train_kl_reg_loss: 81939.3029; train_edge_recon_loss: 2698143.9256; train_gene_expr_recon_loss: 12322726.0076; train_masked_gp_l1_reg_loss: 67731.2966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109812.4220; train_chrom_access_recon_loss: 11362982.2519; train_global_loss: 26643335.2977; train_optim_loss: 26643335.2977; val_kl_reg_loss: 82675.5984; val_edge_recon_loss: 2707064.0667; val_gene_expr_recon_loss: 12467947.3333; val_masked_gp_l1_reg_loss: 68094.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110049.9297; val_chrom_access_recon_loss: 11526184.6667; val_global_loss: 26962015.4667; val_optim_loss: 26962015.4667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9724; val_auprc_score: 0.9614; val_best_acc_score: 0.9220; val_best_f1_score: 0.9253; train_kl_reg_loss: 82409.1679; train_edge_recon_loss: 2691672.2920; train_gene_expr_recon_loss: 12305800.5496; train_masked_gp_l1_reg_loss: 68319.2314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109896.8530; train_chrom_access_recon_loss: 11345460.5344; train_global_loss: 26603558.5496; train_optim_loss: 26603558.5496; val_kl_reg_loss: 81765.9807; val_edge_recon_loss: 2720957.0833; val_gene_expr_recon_loss: 12438193.9333; val_masked_gp_l1_reg_loss: 68649.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110011.7344; val_chrom_access_recon_loss: 11588519.4000; val_global_loss: 27008098.4000; val_optim_loss: 27008098.4000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9741; val_auprc_score: 0.9612; val_best_acc_score: 0.9286; val_best_f1_score: 0.9301; train_kl_reg_loss: 84862.9095; train_edge_recon_loss: 2710850.1183; train_gene_expr_recon_loss: 12064697.5649; train_masked_gp_l1_reg_loss: 67291.8135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107111.4386; train_chrom_access_recon_loss: 11184583.2214; train_global_loss: 26219397.0840; train_optim_loss: 26219397.0840; val_kl_reg_loss: 63010.1164; val_edge_recon_loss: 2720615.8333; val_gene_expr_recon_loss: 12175940.4667; val_masked_gp_l1_reg_loss: 66812.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107453.6406; val_chrom_access_recon_loss: 11323242.8000; val_global_loss: 26457075.2000; val_optim_loss: 26457075.2000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9730; val_auprc_score: 0.9673; val_best_acc_score: 0.9219; val_best_f1_score: 0.9253; train_kl_reg_loss: 83684.9637; train_edge_recon_loss: 2701046.3645; train_gene_expr_recon_loss: 12009992.4809; train_masked_gp_l1_reg_loss: 66746.7888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107637.9242; train_chrom_access_recon_loss: 11112014.3206; train_global_loss: 26081122.8397; train_optim_loss: 26081122.8397; val_kl_reg_loss: 67194.7089; val_edge_recon_loss: 2710813.8000; val_gene_expr_recon_loss: 12156985.7333; val_masked_gp_l1_reg_loss: 66653.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108410.5000; val_chrom_access_recon_loss: 11258301.5333; val_global_loss: 26368359.3333; val_optim_loss: 26368359.3333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9751; val_auprc_score: 0.9671; val_best_acc_score: 0.9295; val_best_f1_score: 0.9317; train_kl_reg_loss: 81671.0856; train_edge_recon_loss: 2694101.0439; train_gene_expr_recon_loss: 11989289.2061; train_masked_gp_l1_reg_loss: 66577.5884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107881.9117; train_chrom_access_recon_loss: 11100015.5420; train_global_loss: 26039536.3511; train_optim_loss: 26039536.3511; val_kl_reg_loss: 69267.4521; val_edge_recon_loss: 2698005.2167; val_gene_expr_recon_loss: 12139445.2667; val_masked_gp_l1_reg_loss: 66499.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108017.1172; val_chrom_access_recon_loss: 11272362.4667; val_global_loss: 26353596.4000; val_optim_loss: 26353596.4000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9784; val_auprc_score: 0.9733; val_best_acc_score: 0.9337; val_best_f1_score: 0.9355; train_kl_reg_loss: 79358.2902; train_edge_recon_loss: 2687154.4275; train_gene_expr_recon_loss: 11965967.1069; train_masked_gp_l1_reg_loss: 66503.0866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107970.1784; train_chrom_access_recon_loss: 11081330.7710; train_global_loss: 25988283.8168; train_optim_loss: 25988283.8168; val_kl_reg_loss: 69429.6547; val_edge_recon_loss: 2689837.5667; val_gene_expr_recon_loss: 12080818.5333; val_masked_gp_l1_reg_loss: 66442.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106984.8047; val_chrom_access_recon_loss: 11205048.6000; val_global_loss: 26218562.4000; val_optim_loss: 26218562.4000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9778; val_auprc_score: 0.9714; val_best_acc_score: 0.9298; val_best_f1_score: 0.9319; train_kl_reg_loss: 77628.8057; train_edge_recon_loss: 2686439.5324; train_gene_expr_recon_loss: 11948105.3969; train_masked_gp_l1_reg_loss: 66462.9176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107646.8519; train_chrom_access_recon_loss: 11056102.6794; train_global_loss: 25942386.3206; train_optim_loss: 25942386.3206; val_kl_reg_loss: 72058.8547; val_edge_recon_loss: 2683172.7500; val_gene_expr_recon_loss: 12103266.3333; val_masked_gp_l1_reg_loss: 66425.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107373.3828; val_chrom_access_recon_loss: 11248702.5333; val_global_loss: 26280998.6667; val_optim_loss: 26280998.6667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9784; val_auprc_score: 0.9734; val_best_acc_score: 0.9328; val_best_f1_score: 0.9346; train_kl_reg_loss: 76431.5042; train_edge_recon_loss: 2685762.8340; train_gene_expr_recon_loss: 11925635.4809; train_masked_gp_l1_reg_loss: 66443.6802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107550.8197; train_chrom_access_recon_loss: 11026281.0229; train_global_loss: 25888105.3130; train_optim_loss: 25888105.3130; val_kl_reg_loss: 72370.2729; val_edge_recon_loss: 2676225.0000; val_gene_expr_recon_loss: 12051923.9333; val_masked_gp_l1_reg_loss: 66484.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107376.1406; val_chrom_access_recon_loss: 11159182.4000; val_global_loss: 26133562.6667; val_optim_loss: 26133562.6667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9781; val_auprc_score: 0.9701; val_best_acc_score: 0.9320; val_best_f1_score: 0.9344; train_kl_reg_loss: 75819.5023; train_edge_recon_loss: 2681699.0973; train_gene_expr_recon_loss: 11906119.0916; train_masked_gp_l1_reg_loss: 66510.4519; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107675.7889; train_chrom_access_recon_loss: 11013954.0611; train_global_loss: 25851777.8931; train_optim_loss: 25851777.8931; val_kl_reg_loss: 70939.4698; val_edge_recon_loss: 2700120.9333; val_gene_expr_recon_loss: 12057162.4000; val_masked_gp_l1_reg_loss: 66507.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106644.5781; val_chrom_access_recon_loss: 11171583.0000; val_global_loss: 26172957.7333; val_optim_loss: 26172957.7333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9809; val_auprc_score: 0.9752; val_best_acc_score: 0.9378; val_best_f1_score: 0.9392; train_kl_reg_loss: 75186.1109; train_edge_recon_loss: 2681332.2672; train_gene_expr_recon_loss: 11899939.9160; train_masked_gp_l1_reg_loss: 66536.1974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107297.9507; train_chrom_access_recon_loss: 11010595.5267; train_global_loss: 25840887.9695; train_optim_loss: 25840887.9695; val_kl_reg_loss: 69914.1547; val_edge_recon_loss: 2685179.3333; val_gene_expr_recon_loss: 12077108.0667; val_masked_gp_l1_reg_loss: 66621.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108351.6016; val_chrom_access_recon_loss: 11181629.7333; val_global_loss: 26188805.0667; val_optim_loss: 26188805.0667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9813; val_auprc_score: 0.9771; val_best_acc_score: 0.9382; val_best_f1_score: 0.9396; train_kl_reg_loss: 74965.5769; train_edge_recon_loss: 2680006.5095; train_gene_expr_recon_loss: 11884824.8779; train_masked_gp_l1_reg_loss: 66658.3566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107724.8849; train_chrom_access_recon_loss: 10986048.4504; train_global_loss: 25800228.7023; train_optim_loss: 25800228.7023; val_kl_reg_loss: 70622.8891; val_edge_recon_loss: 2691686.5667; val_gene_expr_recon_loss: 12016716.8667; val_masked_gp_l1_reg_loss: 66697.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107416.7188; val_chrom_access_recon_loss: 11158869.5333; val_global_loss: 26112011.0667; val_optim_loss: 26112011.0667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9814; val_auprc_score: 0.9738; val_best_acc_score: 0.9425; val_best_f1_score: 0.9438; train_kl_reg_loss: 74523.2338; train_edge_recon_loss: 2679261.2901; train_gene_expr_recon_loss: 11871895.7557; train_masked_gp_l1_reg_loss: 66757.4422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107683.2074; train_chrom_access_recon_loss: 10986075.0076; train_global_loss: 25786196.0000; train_optim_loss: 25786196.0000; val_kl_reg_loss: 70782.2708; val_edge_recon_loss: 2673305.7000; val_gene_expr_recon_loss: 12018848.9333; val_masked_gp_l1_reg_loss: 66744.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107367.2969; val_chrom_access_recon_loss: 11148789.4667; val_global_loss: 26085837.4667; val_optim_loss: 26085837.4667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9796; val_auprc_score: 0.9739; val_best_acc_score: 0.9322; val_best_f1_score: 0.9349; train_kl_reg_loss: 74030.4952; train_edge_recon_loss: 2671677.9122; train_gene_expr_recon_loss: 11855383.5420; train_masked_gp_l1_reg_loss: 66780.9390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107562.4153; train_chrom_access_recon_loss: 10964347.9618; train_global_loss: 25739783.2824; train_optim_loss: 25739783.2824; val_kl_reg_loss: 72260.5328; val_edge_recon_loss: 2707839.1667; val_gene_expr_recon_loss: 12026575.6000; val_masked_gp_l1_reg_loss: 66791.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107670.2109; val_chrom_access_recon_loss: 11168652.5333; val_global_loss: 26149788.5333; val_optim_loss: 26149788.5333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9836; val_auprc_score: 0.9804; val_best_acc_score: 0.9426; val_best_f1_score: 0.9439; train_kl_reg_loss: 73348.1744; train_edge_recon_loss: 2680361.9122; train_gene_expr_recon_loss: 11853944.6947; train_masked_gp_l1_reg_loss: 66859.5708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107633.1215; train_chrom_access_recon_loss: 10969554.2824; train_global_loss: 25751701.6641; train_optim_loss: 25751701.6641; val_kl_reg_loss: 69838.7016; val_edge_recon_loss: 2687546.5500; val_gene_expr_recon_loss: 12014374.9333; val_masked_gp_l1_reg_loss: 66886.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108378.6172; val_chrom_access_recon_loss: 11146520.4667; val_global_loss: 26093545.4667; val_optim_loss: 26093545.4667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9840; val_auprc_score: 0.9785; val_best_acc_score: 0.9466; val_best_f1_score: 0.9472; train_kl_reg_loss: 73260.3663; train_edge_recon_loss: 2672012.1546; train_gene_expr_recon_loss: 11844182.2748; train_masked_gp_l1_reg_loss: 66904.4319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107646.3096; train_chrom_access_recon_loss: 10947818.8092; train_global_loss: 25711824.4275; train_optim_loss: 25711824.4275; val_kl_reg_loss: 70222.3010; val_edge_recon_loss: 2708096.8500; val_gene_expr_recon_loss: 11985113.6667; val_masked_gp_l1_reg_loss: 66944.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107188.0938; val_chrom_access_recon_loss: 11137932.8667; val_global_loss: 26075497.4667; val_optim_loss: 26075497.4667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9853; val_auprc_score: 0.9817; val_best_acc_score: 0.9457; val_best_f1_score: 0.9461; train_kl_reg_loss: 73197.8149; train_edge_recon_loss: 2680154.2347; train_gene_expr_recon_loss: 11832858.5725; train_masked_gp_l1_reg_loss: 67024.3856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107695.4871; train_chrom_access_recon_loss: 10954307.7863; train_global_loss: 25715238.3359; train_optim_loss: 25715238.3359; val_kl_reg_loss: 69697.3990; val_edge_recon_loss: 2687941.1500; val_gene_expr_recon_loss: 12002770.9333; val_masked_gp_l1_reg_loss: 67086.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106964.8281; val_chrom_access_recon_loss: 11129625.0667; val_global_loss: 26064084.9333; val_optim_loss: 26064084.9333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9834; val_auprc_score: 0.9768; val_best_acc_score: 0.9454; val_best_f1_score: 0.9470; train_kl_reg_loss: 73479.2968; train_edge_recon_loss: 2672210.5496; train_gene_expr_recon_loss: 11827031.7557; train_masked_gp_l1_reg_loss: 67087.0914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107652.4077; train_chrom_access_recon_loss: 10945907.5649; train_global_loss: 25693368.6412; train_optim_loss: 25693368.6412; val_kl_reg_loss: 70564.5365; val_edge_recon_loss: 2674900.3667; val_gene_expr_recon_loss: 11968452.4000; val_masked_gp_l1_reg_loss: 67192.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107207.4688; val_chrom_access_recon_loss: 11089995.2667; val_global_loss: 25978312.4000; val_optim_loss: 25978312.4000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9831; val_auprc_score: 0.9777; val_best_acc_score: 0.9458; val_best_f1_score: 0.9469; train_kl_reg_loss: 72781.1069; train_edge_recon_loss: 2672736.8645; train_gene_expr_recon_loss: 11819698.3511; train_masked_gp_l1_reg_loss: 67227.5858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107679.2494; train_chrom_access_recon_loss: 10926515.4198; train_global_loss: 25666638.5496; train_optim_loss: 25666638.5496; val_kl_reg_loss: 71302.7396; val_edge_recon_loss: 2699887.8000; val_gene_expr_recon_loss: 11965835.0000; val_masked_gp_l1_reg_loss: 67238.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106282.0703; val_chrom_access_recon_loss: 11097365.8000; val_global_loss: 26007911.3333; val_optim_loss: 26007911.3333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9835; val_auprc_score: 0.9783; val_best_acc_score: 0.9429; val_best_f1_score: 0.9441; train_kl_reg_loss: 73048.9309; train_edge_recon_loss: 2671879.7824; train_gene_expr_recon_loss: 11818803.0840; train_masked_gp_l1_reg_loss: 67263.7628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107738.0131; train_chrom_access_recon_loss: 10930497.3588; train_global_loss: 25669230.9924; train_optim_loss: 25669230.9924; val_kl_reg_loss: 70531.3693; val_edge_recon_loss: 2687729.1167; val_gene_expr_recon_loss: 11946638.5333; val_masked_gp_l1_reg_loss: 67307.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107290.3594; val_chrom_access_recon_loss: 11054049.1333; val_global_loss: 25933546.4000; val_optim_loss: 25933546.4000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9868; val_auprc_score: 0.9839; val_best_acc_score: 0.9499; val_best_f1_score: 0.9507; train_kl_reg_loss: 72641.9875; train_edge_recon_loss: 2669743.7176; train_gene_expr_recon_loss: 11807892.8702; train_masked_gp_l1_reg_loss: 67307.7090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107547.8581; train_chrom_access_recon_loss: 10927658.2901; train_global_loss: 25652792.3359; train_optim_loss: 25652792.3359; val_kl_reg_loss: 69347.7307; val_edge_recon_loss: 2686462.2000; val_gene_expr_recon_loss: 11981132.0000; val_masked_gp_l1_reg_loss: 67313.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108945.7969; val_chrom_access_recon_loss: 11107958.2000; val_global_loss: 26021159.0667; val_optim_loss: 26021159.0667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9866; val_auprc_score: 0.9828; val_best_acc_score: 0.9512; val_best_f1_score: 0.9526; train_kl_reg_loss: 72230.5078; train_edge_recon_loss: 2668868.8740; train_gene_expr_recon_loss: 11793387.6336; train_masked_gp_l1_reg_loss: 67401.6156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107916.5521; train_chrom_access_recon_loss: 10923928.9466; train_global_loss: 25633734.1679; train_optim_loss: 25633734.1679; val_kl_reg_loss: 69636.7052; val_edge_recon_loss: 2661340.1500; val_gene_expr_recon_loss: 11972917.5333; val_masked_gp_l1_reg_loss: 67460.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107176.1406; val_chrom_access_recon_loss: 11135949.6667; val_global_loss: 26014480.1333; val_optim_loss: 26014480.1333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9859; val_auprc_score: 0.9829; val_best_acc_score: 0.9499; val_best_f1_score: 0.9513; train_kl_reg_loss: 72358.9761; train_edge_recon_loss: 2661606.8874; train_gene_expr_recon_loss: 11787112.0916; train_masked_gp_l1_reg_loss: 67515.1418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107814.0542; train_chrom_access_recon_loss: 10905219.5191; train_global_loss: 25601626.7023; train_optim_loss: 25601626.7023; val_kl_reg_loss: 69941.6359; val_edge_recon_loss: 2677303.9500; val_gene_expr_recon_loss: 11982443.1333; val_masked_gp_l1_reg_loss: 67556.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107836.3047; val_chrom_access_recon_loss: 11081315.4000; val_global_loss: 25986396.9333; val_optim_loss: 25986396.9333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9867; val_auprc_score: 0.9796; val_best_acc_score: 0.9524; val_best_f1_score: 0.9536; train_kl_reg_loss: 71917.9181; train_edge_recon_loss: 2673442.7443; train_gene_expr_recon_loss: 11774281.0000; train_masked_gp_l1_reg_loss: 67577.7888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107811.7817; train_chrom_access_recon_loss: 10901645.0076; train_global_loss: 25596676.1985; train_optim_loss: 25596676.1985; val_kl_reg_loss: 69590.0307; val_edge_recon_loss: 2684080.1667; val_gene_expr_recon_loss: 11954029.6667; val_masked_gp_l1_reg_loss: 67665.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107931.7812; val_chrom_access_recon_loss: 11123372.4000; val_global_loss: 26006669.0667; val_optim_loss: 26006669.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9869; val_auprc_score: 0.9807; val_best_acc_score: 0.9531; val_best_f1_score: 0.9546; train_kl_reg_loss: 72374.9882; train_edge_recon_loss: 2667359.3454; train_gene_expr_recon_loss: 11757326.9160; train_masked_gp_l1_reg_loss: 67174.0437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81395.4853; train_chrom_access_recon_loss: 10895777.2901; train_global_loss: 25541408.0458; train_optim_loss: 25541408.0458; val_kl_reg_loss: 71831.3495; val_edge_recon_loss: 2663740.8167; val_gene_expr_recon_loss: 11888391.8000; val_masked_gp_l1_reg_loss: 66960.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78064.2891; val_chrom_access_recon_loss: 11066423.2000; val_global_loss: 25835412.2667; val_optim_loss: 25835412.2667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9877; val_auprc_score: 0.9859; val_best_acc_score: 0.9512; val_best_f1_score: 0.9525; train_kl_reg_loss: 73349.4138; train_edge_recon_loss: 2664566.9313; train_gene_expr_recon_loss: 11753883.1298; train_masked_gp_l1_reg_loss: 66890.8640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77740.3775; train_chrom_access_recon_loss: 10875924.8092; train_global_loss: 25512355.4351; train_optim_loss: 25512355.4351; val_kl_reg_loss: 73171.8604; val_edge_recon_loss: 2659639.9667; val_gene_expr_recon_loss: 11992653.2667; val_masked_gp_l1_reg_loss: 66827.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77544.2109; val_chrom_access_recon_loss: 11172021.2000; val_global_loss: 26041857.2000; val_optim_loss: 26041857.2000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9873; val_auprc_score: 0.9845; val_best_acc_score: 0.9489; val_best_f1_score: 0.9503; train_kl_reg_loss: 73859.7560; train_edge_recon_loss: 2663604.2080; train_gene_expr_recon_loss: 11749545.3664; train_masked_gp_l1_reg_loss: 66803.7255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77332.6048; train_chrom_access_recon_loss: 10871169.2366; train_global_loss: 25502314.8550; train_optim_loss: 25502314.8550; val_kl_reg_loss: 72174.8224; val_edge_recon_loss: 2675377.0000; val_gene_expr_recon_loss: 11957797.6667; val_masked_gp_l1_reg_loss: 66767.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76926.7344; val_chrom_access_recon_loss: 11077700.1333; val_global_loss: 25926743.4667; val_optim_loss: 25926743.4667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9846; val_auprc_score: 0.9803; val_best_acc_score: 0.9484; val_best_f1_score: 0.9502; train_kl_reg_loss: 74086.0569; train_edge_recon_loss: 2665070.4905; train_gene_expr_recon_loss: 11754882.0763; train_masked_gp_l1_reg_loss: 66755.6296; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76825.0680; train_chrom_access_recon_loss: 10883362.1985; train_global_loss: 25520981.5725; train_optim_loss: 25520981.5725; val_kl_reg_loss: 72746.4016; val_edge_recon_loss: 2673456.7667; val_gene_expr_recon_loss: 11942617.1333; val_masked_gp_l1_reg_loss: 66739.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76679.6641; val_chrom_access_recon_loss: 11085104.7333; val_global_loss: 25917344.1333; val_optim_loss: 25917344.1333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9878; val_auprc_score: 0.9845; val_best_acc_score: 0.9527; val_best_f1_score: 0.9535; train_kl_reg_loss: 74516.8051; train_edge_recon_loss: 2667096.4046; train_gene_expr_recon_loss: 11759523.0305; train_masked_gp_l1_reg_loss: 66736.5401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76508.4393; train_chrom_access_recon_loss: 10890809.7176; train_global_loss: 25535190.9313; train_optim_loss: 25535190.9313; val_kl_reg_loss: 73478.4620; val_edge_recon_loss: 2668879.7000; val_gene_expr_recon_loss: 11903384.1333; val_masked_gp_l1_reg_loss: 66721.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76321.5156; val_chrom_access_recon_loss: 11056196.4667; val_global_loss: 25844982.1333; val_optim_loss: 25844982.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9873; val_auprc_score: 0.9829; val_best_acc_score: 0.9515; val_best_f1_score: 0.9528; train_kl_reg_loss: 74850.5629; train_edge_recon_loss: 2662052.3073; train_gene_expr_recon_loss: 11755696.9466; train_masked_gp_l1_reg_loss: 66674.0649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73411.2849; train_chrom_access_recon_loss: 10887954.7328; train_global_loss: 25520639.7710; train_optim_loss: 25520639.7710; val_kl_reg_loss: 73250.6672; val_edge_recon_loss: 2673133.4167; val_gene_expr_recon_loss: 11977778.3333; val_masked_gp_l1_reg_loss: 66651.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73081.2656; val_chrom_access_recon_loss: 11133438.9333; val_global_loss: 25997333.6000; val_optim_loss: 25997333.6000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9886; val_auprc_score: 0.9866; val_best_acc_score: 0.9542; val_best_f1_score: 0.9553; train_kl_reg_loss: 74732.7816; train_edge_recon_loss: 2659612.2767; train_gene_expr_recon_loss: 11750060.0382; train_masked_gp_l1_reg_loss: 66641.3383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73032.7887; train_chrom_access_recon_loss: 10882209.1221; train_global_loss: 25506288.2290; train_optim_loss: 25506288.2290; val_kl_reg_loss: 73406.2953; val_edge_recon_loss: 2660888.0500; val_gene_expr_recon_loss: 11922554.0667; val_masked_gp_l1_reg_loss: 66632.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72993.1484; val_chrom_access_recon_loss: 11090105.4000; val_global_loss: 25886579.8667; val_optim_loss: 25886579.8667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9862; val_auprc_score: 0.9816; val_best_acc_score: 0.9488; val_best_f1_score: 0.9499; train_kl_reg_loss: 74722.6795; train_edge_recon_loss: 2661440.5439; train_gene_expr_recon_loss: 11741933.7939; train_masked_gp_l1_reg_loss: 66627.3346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72944.4361; train_chrom_access_recon_loss: 10871252.1527; train_global_loss: 25488920.7786; train_optim_loss: 25488920.7786; val_kl_reg_loss: 73393.8391; val_edge_recon_loss: 2684553.7333; val_gene_expr_recon_loss: 11932615.5333; val_masked_gp_l1_reg_loss: 66621.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72917.7344; val_chrom_access_recon_loss: 11076232.4667; val_global_loss: 25906334.2667; val_optim_loss: 25906334.2667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9892; val_auprc_score: 0.9869; val_best_acc_score: 0.9551; val_best_f1_score: 0.9558; train_kl_reg_loss: 74780.9699; train_edge_recon_loss: 2663048.8416; train_gene_expr_recon_loss: 11745657.2519; train_masked_gp_l1_reg_loss: 66618.7007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72891.9623; train_chrom_access_recon_loss: 10879205.4885; train_global_loss: 25502203.1756; train_optim_loss: 25502203.1756; val_kl_reg_loss: 73435.1089; val_edge_recon_loss: 2660970.6667; val_gene_expr_recon_loss: 11965379.1333; val_masked_gp_l1_reg_loss: 66615.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72875.4062; val_chrom_access_recon_loss: 11120840.3333; val_global_loss: 25960116.5333; val_optim_loss: 25960116.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 94 min 12 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9883
val AUPRC score: 0.9845
val best accuracy score: 0.9535
val best F1 score: 0.9547
val target rna MSE score: 1.0771
val source rna MSE score: 0.2964
val target atac MSE score: 0.3486
val source atac MSE score: 0.0563
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
