[True]
Run timestamp: 10102023_134418_281.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_281']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7607; val_auprc_score: 0.7788; val_best_acc_score: 0.5757; val_best_f1_score: 0.6970; train_kl_reg_loss: 72083.9352; train_edge_recon_loss: 746218.3392; train_gene_expr_recon_loss: 22145694.9466; train_masked_gp_l1_reg_loss: 61382.4155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4026324.5978; train_chrom_access_recon_loss: 4734209.4427; train_global_loss: 31785913.6489; train_optim_loss: 31785913.6489; val_kl_reg_loss: 91539.4484; val_edge_recon_loss: 812244.9750; val_gene_expr_recon_loss: 20979558.2667; val_masked_gp_l1_reg_loss: 65292.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 964645.0000; val_chrom_access_recon_loss: 4578188.5333; val_global_loss: 27491468.2667; val_optim_loss: 27491468.2667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8542; val_auprc_score: 0.8599; val_best_acc_score: 0.7424; val_best_f1_score: 0.7640; train_kl_reg_loss: 75880.8624; train_edge_recon_loss: 732756.4117; train_gene_expr_recon_loss: 20882104.0611; train_masked_gp_l1_reg_loss: 65791.1577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 492154.1985; train_chrom_access_recon_loss: 4568426.3206; train_global_loss: 26817113.0076; train_optim_loss: 26817113.0076; val_kl_reg_loss: 70926.3161; val_edge_recon_loss: 792646.3292; val_gene_expr_recon_loss: 20686878.0000; val_masked_gp_l1_reg_loss: 66790.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 272393.1875; val_chrom_access_recon_loss: 4516139.0667; val_global_loss: 26405773.4667; val_optim_loss: 26405773.4667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9130; val_auprc_score: 0.9064; val_best_acc_score: 0.8304; val_best_f1_score: 0.8438; train_kl_reg_loss: 66368.3980; train_edge_recon_loss: 698628.7691; train_gene_expr_recon_loss: 20619060.8855; train_masked_gp_l1_reg_loss: 68870.0552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 210723.4905; train_chrom_access_recon_loss: 4524539.3206; train_global_loss: 26188191.0534; train_optim_loss: 26188191.0534; val_kl_reg_loss: 73713.9792; val_edge_recon_loss: 657532.4083; val_gene_expr_recon_loss: 20352245.4667; val_masked_gp_l1_reg_loss: 71341.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174583.3281; val_chrom_access_recon_loss: 4454761.7667; val_global_loss: 25784179.6000; val_optim_loss: 25784179.6000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9249; val_auprc_score: 0.9134; val_best_acc_score: 0.8522; val_best_f1_score: 0.8597; train_kl_reg_loss: 77566.8806; train_edge_recon_loss: 629170.3888; train_gene_expr_recon_loss: 20351823.2366; train_masked_gp_l1_reg_loss: 73687.3811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166291.9356; train_chrom_access_recon_loss: 4478222.9046; train_global_loss: 25776762.7481; train_optim_loss: 25776762.7481; val_kl_reg_loss: 76100.3792; val_edge_recon_loss: 618227.7208; val_gene_expr_recon_loss: 20229628.0000; val_masked_gp_l1_reg_loss: 75481.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154582.3594; val_chrom_access_recon_loss: 4441612.7500; val_global_loss: 25595632.9333; val_optim_loss: 25595632.9333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9242; val_auprc_score: 0.9113; val_best_acc_score: 0.8510; val_best_f1_score: 0.8588; train_kl_reg_loss: 76196.1913; train_edge_recon_loss: 612372.8406; train_gene_expr_recon_loss: 20158165.5725; train_masked_gp_l1_reg_loss: 77090.3770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144732.4900; train_chrom_access_recon_loss: 4442012.3721; train_global_loss: 25510569.8015; train_optim_loss: 25510569.8015; val_kl_reg_loss: 73766.1896; val_edge_recon_loss: 614738.7917; val_gene_expr_recon_loss: 20110892.4000; val_masked_gp_l1_reg_loss: 78526.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135380.5312; val_chrom_access_recon_loss: 4417855.4333; val_global_loss: 25431158.9333; val_optim_loss: 25431158.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9280; val_auprc_score: 0.9164; val_best_acc_score: 0.8550; val_best_f1_score: 0.8644; train_kl_reg_loss: 72874.8332; train_edge_recon_loss: 605846.7925; train_gene_expr_recon_loss: 19987878.1985; train_masked_gp_l1_reg_loss: 79682.4736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129463.9998; train_chrom_access_recon_loss: 4405111.4332; train_global_loss: 25280857.4962; train_optim_loss: 25280857.4962; val_kl_reg_loss: 70115.9635; val_edge_recon_loss: 610059.0875; val_gene_expr_recon_loss: 19901264.8000; val_masked_gp_l1_reg_loss: 80422.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125011.2500; val_chrom_access_recon_loss: 4378550.0667; val_global_loss: 25165423.4667; val_optim_loss: 25165423.4667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9382; val_auprc_score: 0.9277; val_best_acc_score: 0.8662; val_best_f1_score: 0.8727; train_kl_reg_loss: 70069.4751; train_edge_recon_loss: 603161.1913; train_gene_expr_recon_loss: 19858684.3664; train_masked_gp_l1_reg_loss: 81333.7925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120721.6393; train_chrom_access_recon_loss: 4374888.6469; train_global_loss: 25108859.0840; train_optim_loss: 25108859.0840; val_kl_reg_loss: 67729.9276; val_edge_recon_loss: 602850.4792; val_gene_expr_recon_loss: 19894012.8000; val_masked_gp_l1_reg_loss: 82061.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118509.1641; val_chrom_access_recon_loss: 4384284.3333; val_global_loss: 25149449.7333; val_optim_loss: 25149449.7333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9461; val_auprc_score: 0.9385; val_best_acc_score: 0.8760; val_best_f1_score: 0.8821; train_kl_reg_loss: 68343.8488; train_edge_recon_loss: 599157.2319; train_gene_expr_recon_loss: 19759225.6641; train_masked_gp_l1_reg_loss: 82745.0626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116412.5581; train_chrom_access_recon_loss: 4356354.5706; train_global_loss: 24982239.1450; train_optim_loss: 24982239.1450; val_kl_reg_loss: 67321.2766; val_edge_recon_loss: 595630.1792; val_gene_expr_recon_loss: 19548176.2667; val_masked_gp_l1_reg_loss: 83258.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115309.0547; val_chrom_access_recon_loss: 4314492.1000; val_global_loss: 24724188.1333; val_optim_loss: 24724188.1333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9495; val_auprc_score: 0.9370; val_best_acc_score: 0.8871; val_best_f1_score: 0.8922; train_kl_reg_loss: 66893.6207; train_edge_recon_loss: 596783.0868; train_gene_expr_recon_loss: 19616952.9008; train_masked_gp_l1_reg_loss: 83766.5491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114361.5664; train_chrom_access_recon_loss: 4325517.4504; train_global_loss: 24804275.0992; train_optim_loss: 24804275.0992; val_kl_reg_loss: 65556.7604; val_edge_recon_loss: 591754.4792; val_gene_expr_recon_loss: 19581064.8000; val_masked_gp_l1_reg_loss: 84451.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114269.5391; val_chrom_access_recon_loss: 4328351.8167; val_global_loss: 24765449.8667; val_optim_loss: 24765449.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9554; val_auprc_score: 0.9436; val_best_acc_score: 0.8907; val_best_f1_score: 0.8947; train_kl_reg_loss: 65785.1194; train_edge_recon_loss: 592136.1279; train_gene_expr_recon_loss: 19510004.2443; train_masked_gp_l1_reg_loss: 84889.6426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112284.8016; train_chrom_access_recon_loss: 4299236.5458; train_global_loss: 24664336.5344; train_optim_loss: 24664336.5344; val_kl_reg_loss: 63726.1331; val_edge_recon_loss: 589653.0125; val_gene_expr_recon_loss: 19482537.0667; val_masked_gp_l1_reg_loss: 85518.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112001.2969; val_chrom_access_recon_loss: 4285185.9500; val_global_loss: 24618622.2667; val_optim_loss: 24618622.2667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9530; val_auprc_score: 0.9412; val_best_acc_score: 0.8929; val_best_f1_score: 0.8988; train_kl_reg_loss: 65073.7280; train_edge_recon_loss: 589779.9089; train_gene_expr_recon_loss: 19452385.8626; train_masked_gp_l1_reg_loss: 85944.8975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109711.6172; train_chrom_access_recon_loss: 4282590.5821; train_global_loss: 24585486.6260; train_optim_loss: 24585486.6260; val_kl_reg_loss: 63811.4424; val_edge_recon_loss: 591958.8583; val_gene_expr_recon_loss: 19304477.4667; val_masked_gp_l1_reg_loss: 86310.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109865.6406; val_chrom_access_recon_loss: 4254814.3667; val_global_loss: 24411238.4000; val_optim_loss: 24411238.4000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9593; val_auprc_score: 0.9490; val_best_acc_score: 0.9033; val_best_f1_score: 0.9083; train_kl_reg_loss: 63927.0412; train_edge_recon_loss: 587712.7853; train_gene_expr_recon_loss: 19332658.5344; train_masked_gp_l1_reg_loss: 86812.4707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107572.4807; train_chrom_access_recon_loss: 4253148.3931; train_global_loss: 24431831.8168; train_optim_loss: 24431831.8168; val_kl_reg_loss: 64575.1544; val_edge_recon_loss: 588295.7167; val_gene_expr_recon_loss: 19278207.7333; val_masked_gp_l1_reg_loss: 87521.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105936.8984; val_chrom_access_recon_loss: 4231046.5833; val_global_loss: 24355583.4667; val_optim_loss: 24355583.4667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9639; val_auprc_score: 0.9568; val_best_acc_score: 0.9080; val_best_f1_score: 0.9112; train_kl_reg_loss: 63302.9349; train_edge_recon_loss: 586765.3154; train_gene_expr_recon_loss: 19275196.0458; train_masked_gp_l1_reg_loss: 87803.9303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105635.3501; train_chrom_access_recon_loss: 4232924.0363; train_global_loss: 24351627.5267; train_optim_loss: 24351627.5267; val_kl_reg_loss: 62769.0352; val_edge_recon_loss: 581544.4000; val_gene_expr_recon_loss: 19293954.5333; val_masked_gp_l1_reg_loss: 88276.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105060.6719; val_chrom_access_recon_loss: 4229050.3167; val_global_loss: 24360654.0000; val_optim_loss: 24360654.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9661; val_auprc_score: 0.9560; val_best_acc_score: 0.9091; val_best_f1_score: 0.9132; train_kl_reg_loss: 62349.6175; train_edge_recon_loss: 584783.9843; train_gene_expr_recon_loss: 19195047.0229; train_masked_gp_l1_reg_loss: 88699.9716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104185.7059; train_chrom_access_recon_loss: 4209890.2156; train_global_loss: 24244956.3817; train_optim_loss: 24244956.3817; val_kl_reg_loss: 63840.3500; val_edge_recon_loss: 583294.5083; val_gene_expr_recon_loss: 19173229.8667; val_masked_gp_l1_reg_loss: 89001.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103178.8516; val_chrom_access_recon_loss: 4208953.6333; val_global_loss: 24221498.2667; val_optim_loss: 24221498.2667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9673; val_auprc_score: 0.9612; val_best_acc_score: 0.9104; val_best_f1_score: 0.9144; train_kl_reg_loss: 61704.8434; train_edge_recon_loss: 584321.7729; train_gene_expr_recon_loss: 19144553.3282; train_masked_gp_l1_reg_loss: 89571.9366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103004.5825; train_chrom_access_recon_loss: 4190173.2538; train_global_loss: 24173329.6489; train_optim_loss: 24173329.6489; val_kl_reg_loss: 61649.0125; val_edge_recon_loss: 587227.1250; val_gene_expr_recon_loss: 19100056.9333; val_masked_gp_l1_reg_loss: 90064.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103192.8828; val_chrom_access_recon_loss: 4199663.6667; val_global_loss: 24141852.5333; val_optim_loss: 24141852.5333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9667; val_auprc_score: 0.9598; val_best_acc_score: 0.9122; val_best_f1_score: 0.9161; train_kl_reg_loss: 61506.9173; train_edge_recon_loss: 581963.2977; train_gene_expr_recon_loss: 19066193.2519; train_masked_gp_l1_reg_loss: 90599.7874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101707.1045; train_chrom_access_recon_loss: 4166559.7195; train_global_loss: 24068529.9542; train_optim_loss: 24068529.9542; val_kl_reg_loss: 60935.1414; val_edge_recon_loss: 584414.8375; val_gene_expr_recon_loss: 18988391.6000; val_masked_gp_l1_reg_loss: 91088.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103665.1562; val_chrom_access_recon_loss: 4150333.6333; val_global_loss: 23978828.8000; val_optim_loss: 23978828.8000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9660; val_auprc_score: 0.9574; val_best_acc_score: 0.9104; val_best_f1_score: 0.9140; train_kl_reg_loss: 60924.1665; train_edge_recon_loss: 581126.2242; train_gene_expr_recon_loss: 19025308.8244; train_masked_gp_l1_reg_loss: 91778.5391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101281.6005; train_chrom_access_recon_loss: 4146683.5344; train_global_loss: 24007102.8397; train_optim_loss: 24007102.8397; val_kl_reg_loss: 60871.5266; val_edge_recon_loss: 581477.5250; val_gene_expr_recon_loss: 19062361.4667; val_masked_gp_l1_reg_loss: 92433.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101353.1016; val_chrom_access_recon_loss: 4149347.8333; val_global_loss: 24047846.4000; val_optim_loss: 24047846.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9669; val_auprc_score: 0.9577; val_best_acc_score: 0.9166; val_best_f1_score: 0.9199; train_kl_reg_loss: 60017.7260; train_edge_recon_loss: 581708.6746; train_gene_expr_recon_loss: 18942512.6107; train_masked_gp_l1_reg_loss: 93067.0757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100722.5606; train_chrom_access_recon_loss: 4119219.5763; train_global_loss: 23897248.2137; train_optim_loss: 23897248.2137; val_kl_reg_loss: 57508.5083; val_edge_recon_loss: 582848.2417; val_gene_expr_recon_loss: 18895496.1333; val_masked_gp_l1_reg_loss: 93621.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100659.6953; val_chrom_access_recon_loss: 4129773.2000; val_global_loss: 23859908.1333; val_optim_loss: 23859908.1333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9673; val_auprc_score: 0.9584; val_best_acc_score: 0.9201; val_best_f1_score: 0.9231; train_kl_reg_loss: 59796.8822; train_edge_recon_loss: 580599.6107; train_gene_expr_recon_loss: 18896854.7328; train_masked_gp_l1_reg_loss: 94270.7705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100438.0821; train_chrom_access_recon_loss: 4102290.2118; train_global_loss: 23834250.1985; train_optim_loss: 23834250.1985; val_kl_reg_loss: 58420.5135; val_edge_recon_loss: 584090.3958; val_gene_expr_recon_loss: 18897719.7333; val_masked_gp_l1_reg_loss: 94904.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101631.9141; val_chrom_access_recon_loss: 4095399.1500; val_global_loss: 23832165.6000; val_optim_loss: 23832165.6000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9660; val_auprc_score: 0.9550; val_best_acc_score: 0.9136; val_best_f1_score: 0.9174; train_kl_reg_loss: 59491.6856; train_edge_recon_loss: 578986.5816; train_gene_expr_recon_loss: 18844282.9924; train_masked_gp_l1_reg_loss: 95613.0575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100867.4074; train_chrom_access_recon_loss: 4085762.2748; train_global_loss: 23765004.1527; train_optim_loss: 23765004.1527; val_kl_reg_loss: 59281.0240; val_edge_recon_loss: 583921.7708; val_gene_expr_recon_loss: 18829624.5333; val_masked_gp_l1_reg_loss: 96049.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101277.1875; val_chrom_access_recon_loss: 4092335.8500; val_global_loss: 23762491.2000; val_optim_loss: 23762491.2000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9670; val_auprc_score: 0.9571; val_best_acc_score: 0.9116; val_best_f1_score: 0.9159; train_kl_reg_loss: 59795.0390; train_edge_recon_loss: 578671.6851; train_gene_expr_recon_loss: 18784918.7023; train_masked_gp_l1_reg_loss: 96704.1874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100615.2427; train_chrom_access_recon_loss: 4061054.1317; train_global_loss: 23681758.8702; train_optim_loss: 23681758.8702; val_kl_reg_loss: 59003.7099; val_edge_recon_loss: 579918.4292; val_gene_expr_recon_loss: 18742379.3333; val_masked_gp_l1_reg_loss: 97347.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101392.6094; val_chrom_access_recon_loss: 4077066.1167; val_global_loss: 23657107.7333; val_optim_loss: 23657107.7333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9673; val_auprc_score: 0.9577; val_best_acc_score: 0.9138; val_best_f1_score: 0.9160; train_kl_reg_loss: 59427.3418; train_edge_recon_loss: 579530.4661; train_gene_expr_recon_loss: 18697153.6947; train_masked_gp_l1_reg_loss: 97872.2635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100645.9931; train_chrom_access_recon_loss: 4033569.9828; train_global_loss: 23568199.7252; train_optim_loss: 23568199.7252; val_kl_reg_loss: 57670.9302; val_edge_recon_loss: 583288.5167; val_gene_expr_recon_loss: 18738164.2667; val_masked_gp_l1_reg_loss: 98489.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101784.4219; val_chrom_access_recon_loss: 4059527.2667; val_global_loss: 23638924.8000; val_optim_loss: 23638924.8000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9626; val_auprc_score: 0.9525; val_best_acc_score: 0.9101; val_best_f1_score: 0.9135; train_kl_reg_loss: 59066.0810; train_edge_recon_loss: 579701.6832; train_gene_expr_recon_loss: 18662225.4656; train_masked_gp_l1_reg_loss: 99058.5655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101226.8430; train_chrom_access_recon_loss: 4015713.6183; train_global_loss: 23516992.3664; train_optim_loss: 23516992.3664; val_kl_reg_loss: 58629.0302; val_edge_recon_loss: 584706.0667; val_gene_expr_recon_loss: 18661545.6000; val_masked_gp_l1_reg_loss: 99525.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100458.5781; val_chrom_access_recon_loss: 4060536.7500; val_global_loss: 23565401.2000; val_optim_loss: 23565401.2000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9645; val_auprc_score: 0.9568; val_best_acc_score: 0.9115; val_best_f1_score: 0.9153; train_kl_reg_loss: 59872.4455; train_edge_recon_loss: 577860.8387; train_gene_expr_recon_loss: 18623544.4427; train_masked_gp_l1_reg_loss: 99862.4111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101358.6218; train_chrom_access_recon_loss: 4006453.7996; train_global_loss: 23468952.4122; train_optim_loss: 23468952.4122; val_kl_reg_loss: 59528.7320; val_edge_recon_loss: 582394.3500; val_gene_expr_recon_loss: 18710553.2000; val_masked_gp_l1_reg_loss: 100241.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102910.8281; val_chrom_access_recon_loss: 4053849.7500; val_global_loss: 23609478.1333; val_optim_loss: 23609478.1333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9628; val_auprc_score: 0.9537; val_best_acc_score: 0.9076; val_best_f1_score: 0.9123; train_kl_reg_loss: 59396.9342; train_edge_recon_loss: 579384.7109; train_gene_expr_recon_loss: 18566831.1450; train_masked_gp_l1_reg_loss: 100690.3692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102445.4217; train_chrom_access_recon_loss: 3979433.8969; train_global_loss: 23388182.5191; train_optim_loss: 23388182.5191; val_kl_reg_loss: 59127.0219; val_edge_recon_loss: 583802.0375; val_gene_expr_recon_loss: 18671766.2667; val_masked_gp_l1_reg_loss: 101083.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102697.6719; val_chrom_access_recon_loss: 4036881.7667; val_global_loss: 23555359.2000; val_optim_loss: 23555359.2000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9619; val_auprc_score: 0.9494; val_best_acc_score: 0.9132; val_best_f1_score: 0.9172; train_kl_reg_loss: 59794.9823; train_edge_recon_loss: 578961.1622; train_gene_expr_recon_loss: 18542127.5115; train_masked_gp_l1_reg_loss: 101414.3021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103010.8059; train_chrom_access_recon_loss: 3969246.0038; train_global_loss: 23354554.8092; train_optim_loss: 23354554.8092; val_kl_reg_loss: 58873.1188; val_edge_recon_loss: 584998.3708; val_gene_expr_recon_loss: 18651734.4000; val_masked_gp_l1_reg_loss: 101811.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104141.8984; val_chrom_access_recon_loss: 4024201.6333; val_global_loss: 23525761.7333; val_optim_loss: 23525761.7333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9668; val_auprc_score: 0.9577; val_best_acc_score: 0.9167; val_best_f1_score: 0.9194; train_kl_reg_loss: 60282.0305; train_edge_recon_loss: 579084.6489; train_gene_expr_recon_loss: 18491071.5115; train_masked_gp_l1_reg_loss: 102003.8050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103388.2559; train_chrom_access_recon_loss: 3955232.6508; train_global_loss: 23291062.9008; train_optim_loss: 23291062.9008; val_kl_reg_loss: 59765.1758; val_edge_recon_loss: 583437.8750; val_gene_expr_recon_loss: 18621328.5333; val_masked_gp_l1_reg_loss: 102246.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105408.1797; val_chrom_access_recon_loss: 4007250.3167; val_global_loss: 23479436.0000; val_optim_loss: 23479436.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9633; val_auprc_score: 0.9549; val_best_acc_score: 0.9095; val_best_f1_score: 0.9134; train_kl_reg_loss: 60828.3604; train_edge_recon_loss: 578534.9928; train_gene_expr_recon_loss: 18448981.5267; train_masked_gp_l1_reg_loss: 102228.9045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104491.7019; train_chrom_access_recon_loss: 3940850.6794; train_global_loss: 23235916.0763; train_optim_loss: 23235916.0763; val_kl_reg_loss: 59306.3870; val_edge_recon_loss: 582723.7417; val_gene_expr_recon_loss: 18581901.7333; val_masked_gp_l1_reg_loss: 102189.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105421.6953; val_chrom_access_recon_loss: 3993604.9833; val_global_loss: 23425148.8000; val_optim_loss: 23425148.8000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9634; val_auprc_score: 0.9525; val_best_acc_score: 0.9123; val_best_f1_score: 0.9157; train_kl_reg_loss: 60631.7462; train_edge_recon_loss: 578657.2400; train_gene_expr_recon_loss: 18413938.6107; train_masked_gp_l1_reg_loss: 102482.6287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105003.7508; train_chrom_access_recon_loss: 3925169.8511; train_global_loss: 23185883.9084; train_optim_loss: 23185883.9084; val_kl_reg_loss: 60437.3802; val_edge_recon_loss: 584980.6417; val_gene_expr_recon_loss: 18529320.1333; val_masked_gp_l1_reg_loss: 102607.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106485.0312; val_chrom_access_recon_loss: 3987071.7333; val_global_loss: 23370904.2667; val_optim_loss: 23370904.2667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9630; val_auprc_score: 0.9552; val_best_acc_score: 0.9091; val_best_f1_score: 0.9126; train_kl_reg_loss: 61202.7515; train_edge_recon_loss: 579248.8650; train_gene_expr_recon_loss: 18385207.6947; train_masked_gp_l1_reg_loss: 102761.6065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105824.1969; train_chrom_access_recon_loss: 3915536.5095; train_global_loss: 23149781.5878; train_optim_loss: 23149781.5878; val_kl_reg_loss: 60397.9062; val_edge_recon_loss: 583928.6250; val_gene_expr_recon_loss: 18485052.9333; val_masked_gp_l1_reg_loss: 102854.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107339.3125; val_chrom_access_recon_loss: 3996407.3667; val_global_loss: 23335980.8000; val_optim_loss: 23335980.8000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9651; val_auprc_score: 0.9545; val_best_acc_score: 0.9130; val_best_f1_score: 0.9165; train_kl_reg_loss: 61007.4944; train_edge_recon_loss: 578554.5458; train_gene_expr_recon_loss: 18337253.8550; train_masked_gp_l1_reg_loss: 103042.0180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106778.2412; train_chrom_access_recon_loss: 3902148.6889; train_global_loss: 23088784.8244; train_optim_loss: 23088784.8244; val_kl_reg_loss: 61768.3740; val_edge_recon_loss: 585424.7375; val_gene_expr_recon_loss: 18515766.9333; val_masked_gp_l1_reg_loss: 103055.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105644.7656; val_chrom_access_recon_loss: 3971267.1167; val_global_loss: 23342927.2000; val_optim_loss: 23342927.2000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9630; val_auprc_score: 0.9509; val_best_acc_score: 0.9130; val_best_f1_score: 0.9169; train_kl_reg_loss: 61822.3566; train_edge_recon_loss: 580119.0143; train_gene_expr_recon_loss: 18330828.4733; train_masked_gp_l1_reg_loss: 103147.1059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106690.7344; train_chrom_access_recon_loss: 3897918.3149; train_global_loss: 23080526.1374; train_optim_loss: 23080526.1374; val_kl_reg_loss: 61333.3820; val_edge_recon_loss: 582248.9417; val_gene_expr_recon_loss: 18473338.4000; val_masked_gp_l1_reg_loss: 103045.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108498.9219; val_chrom_access_recon_loss: 3978573.5833; val_global_loss: 23307038.5333; val_optim_loss: 23307038.5333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9591; val_auprc_score: 0.9492; val_best_acc_score: 0.9082; val_best_f1_score: 0.9124; train_kl_reg_loss: 103499.5890; train_edge_recon_loss: 591588.3177; train_gene_expr_recon_loss: 18576416.5038; train_masked_gp_l1_reg_loss: 101914.1042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110501.6675; train_chrom_access_recon_loss: 4042565.0611; train_global_loss: 23526485.1450; train_optim_loss: 23526485.1450; val_kl_reg_loss: 60365.0813; val_edge_recon_loss: 595359.2500; val_gene_expr_recon_loss: 18688657.8667; val_masked_gp_l1_reg_loss: 98517.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109135.9219; val_chrom_access_recon_loss: 4099787.3167; val_global_loss: 23651823.7333; val_optim_loss: 23651823.7333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9487; val_auprc_score: 0.9328; val_best_acc_score: 0.8860; val_best_f1_score: 0.8923; train_kl_reg_loss: 665113.4455; train_edge_recon_loss: 609866.8416; train_gene_expr_recon_loss: 18734484.5649; train_masked_gp_l1_reg_loss: 95176.9053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110602.7957; train_chrom_access_recon_loss: 4120207.1431; train_global_loss: 24335451.6794; train_optim_loss: 24335451.6794; val_kl_reg_loss: 82927.5203; val_edge_recon_loss: 609288.8708; val_gene_expr_recon_loss: 18716858.0000; val_masked_gp_l1_reg_loss: 90283.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109928.9375; val_chrom_access_recon_loss: 4120956.5000; val_global_loss: 23730243.0667; val_optim_loss: 23730243.0667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9538; val_auprc_score: 0.9414; val_best_acc_score: 0.8942; val_best_f1_score: 0.8982; train_kl_reg_loss: 80260.1594; train_edge_recon_loss: 601574.7605; train_gene_expr_recon_loss: 18773926.1527; train_masked_gp_l1_reg_loss: 88932.3456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112835.3098; train_chrom_access_recon_loss: 4139469.1622; train_global_loss: 23796997.9084; train_optim_loss: 23796997.9084; val_kl_reg_loss: 73307.8380; val_edge_recon_loss: 609942.8833; val_gene_expr_recon_loss: 18659730.5333; val_masked_gp_l1_reg_loss: 87878.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109320.1016; val_chrom_access_recon_loss: 4109435.3500; val_global_loss: 23649614.1333; val_optim_loss: 23649614.1333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9515; val_auprc_score: 0.9409; val_best_acc_score: 0.8895; val_best_f1_score: 0.8949; train_kl_reg_loss: 87011.6708; train_edge_recon_loss: 602442.8039; train_gene_expr_recon_loss: 18742250.4885; train_masked_gp_l1_reg_loss: 87598.8398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110168.0736; train_chrom_access_recon_loss: 4113590.7176; train_global_loss: 23743062.4427; train_optim_loss: 23743062.4427; val_kl_reg_loss: 90014.5198; val_edge_recon_loss: 609405.2500; val_gene_expr_recon_loss: 18661412.8000; val_masked_gp_l1_reg_loss: 86342.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112628.0234; val_chrom_access_recon_loss: 4120181.8333; val_global_loss: 23679984.1333; val_optim_loss: 23679984.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9527; val_auprc_score: 0.9408; val_best_acc_score: 0.8936; val_best_f1_score: 0.9005; train_kl_reg_loss: 87256.9119; train_edge_recon_loss: 596645.7791; train_gene_expr_recon_loss: 18673381.4656; train_masked_gp_l1_reg_loss: 84521.5876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79140.1849; train_chrom_access_recon_loss: 4057964.4847; train_global_loss: 23578910.2443; train_optim_loss: 23578910.2443; val_kl_reg_loss: 85313.8219; val_edge_recon_loss: 595571.7125; val_gene_expr_recon_loss: 18650251.0667; val_masked_gp_l1_reg_loss: 83789.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73535.1953; val_chrom_access_recon_loss: 4082856.9500; val_global_loss: 23571319.7333; val_optim_loss: 23571319.7333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9499; val_auprc_score: 0.9348; val_best_acc_score: 0.8901; val_best_f1_score: 0.8957; train_kl_reg_loss: 84877.5565; train_edge_recon_loss: 590480.8449; train_gene_expr_recon_loss: 18618452.5802; train_masked_gp_l1_reg_loss: 83660.4438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72459.9791; train_chrom_access_recon_loss: 4050398.7767; train_global_loss: 23500330.2443; train_optim_loss: 23500330.2443; val_kl_reg_loss: 84156.3854; val_edge_recon_loss: 595149.6917; val_gene_expr_recon_loss: 18592463.8667; val_masked_gp_l1_reg_loss: 83535.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71518.3750; val_chrom_access_recon_loss: 4077824.2167; val_global_loss: 23504648.2667; val_optim_loss: 23504648.2667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9506; val_auprc_score: 0.9366; val_best_acc_score: 0.8922; val_best_f1_score: 0.8968; train_kl_reg_loss: 82842.4042; train_edge_recon_loss: 586677.8626; train_gene_expr_recon_loss: 18576098.9924; train_masked_gp_l1_reg_loss: 83492.2843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70824.7527; train_chrom_access_recon_loss: 4036474.4332; train_global_loss: 23436410.7023; train_optim_loss: 23436410.7023; val_kl_reg_loss: 82477.8474; val_edge_recon_loss: 591996.0458; val_gene_expr_recon_loss: 18672666.1333; val_masked_gp_l1_reg_loss: 83462.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70310.5469; val_chrom_access_recon_loss: 4081341.1500; val_global_loss: 23582252.9333; val_optim_loss: 23582252.9333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9529; val_auprc_score: 0.9403; val_best_acc_score: 0.8987; val_best_f1_score: 0.9029; train_kl_reg_loss: 81088.9241; train_edge_recon_loss: 584162.5301; train_gene_expr_recon_loss: 18576631.4046; train_masked_gp_l1_reg_loss: 83480.5154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69790.0695; train_chrom_access_recon_loss: 4036936.6756; train_global_loss: 23432089.9847; train_optim_loss: 23432089.9847; val_kl_reg_loss: 80317.8229; val_edge_recon_loss: 587295.2167; val_gene_expr_recon_loss: 18653003.7333; val_masked_gp_l1_reg_loss: 83489.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69370.6719; val_chrom_access_recon_loss: 4068085.6333; val_global_loss: 23541562.5333; val_optim_loss: 23541562.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 32 min 36 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9628
val AUPRC score: 0.9533
val best accuracy score: 0.9096
val best F1 score: 0.9133
val target rna MSE score: 1.1107
val source rna MSE score: 0.4369
val target atac MSE score: 0.5515
val source atac MSE score: 0.1332
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
