[True]
Run timestamp: 07082023_184851_49.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_49']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8954; val_auprc_score: 0.8997; val_best_acc_score: 0.5042; val_best_f1_score: 0.6685; train_kl_reg_loss: 8211.2070; train_edge_recon_loss: 35797.4670; train_gene_expr_recon_loss: 632822.7986; train_masked_gp_l1_reg_loss: 8510.0439; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 264924.3194; train_global_loss: 950265.8403; train_optim_loss: 950265.8403; val_kl_reg_loss: 11519.6406; val_edge_recon_loss: 40651.3125; val_gene_expr_recon_loss: 564646.5000; val_masked_gp_l1_reg_loss: 6872.9531; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 258617.1875; val_global_loss: 882307.5625; val_optim_loss: 882307.5625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8760; val_auprc_score: 0.8737; val_best_acc_score: 0.5183; val_best_f1_score: 0.6749; train_kl_reg_loss: 17335.8611; train_edge_recon_loss: 38409.7218; train_gene_expr_recon_loss: 554446.6528; train_masked_gp_l1_reg_loss: 6292.2543; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 261005.6354; train_global_loss: 877490.1111; train_optim_loss: 877490.1111; val_kl_reg_loss: 16912.2305; val_edge_recon_loss: 40642.9922; val_gene_expr_recon_loss: 516191.5000; val_masked_gp_l1_reg_loss: 5837.6606; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253815.5469; val_global_loss: 833400.0000; val_optim_loss: 833400.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8688; val_auprc_score: 0.8651; val_best_acc_score: 0.5267; val_best_f1_score: 0.6783; train_kl_reg_loss: 19642.2036; train_edge_recon_loss: 38570.4523; train_gene_expr_recon_loss: 512342.5069; train_masked_gp_l1_reg_loss: 5894.4920; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256456.6372; train_global_loss: 832906.3056; train_optim_loss: 832906.3056; val_kl_reg_loss: 22892.0918; val_edge_recon_loss: 40636.1055; val_gene_expr_recon_loss: 479963.9375; val_masked_gp_l1_reg_loss: 6000.4292; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249580.9375; val_global_loss: 799073.5000; val_optim_loss: 799073.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8746; val_auprc_score: 0.8727; val_best_acc_score: 0.5364; val_best_f1_score: 0.6821; train_kl_reg_loss: 22866.2415; train_edge_recon_loss: 38971.9870; train_gene_expr_recon_loss: 482833.3125; train_masked_gp_l1_reg_loss: 5950.7371; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252453.3542; train_global_loss: 803075.6458; train_optim_loss: 803075.6458; val_kl_reg_loss: 21174.8477; val_edge_recon_loss: 40625.5859; val_gene_expr_recon_loss: 462984.5000; val_masked_gp_l1_reg_loss: 5858.9165; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247011.4531; val_global_loss: 777655.3125; val_optim_loss: 777655.3125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8738; val_auprc_score: 0.8713; val_best_acc_score: 0.5441; val_best_f1_score: 0.6838; train_kl_reg_loss: 22252.9078; train_edge_recon_loss: 38891.3681; train_gene_expr_recon_loss: 467283.5382; train_masked_gp_l1_reg_loss: 5801.4373; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249339.1493; train_global_loss: 783568.3889; train_optim_loss: 783568.3889; val_kl_reg_loss: 21746.8281; val_edge_recon_loss: 40610.4336; val_gene_expr_recon_loss: 449704.0000; val_masked_gp_l1_reg_loss: 5729.4819; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244867.1562; val_global_loss: 762657.8750; val_optim_loss: 762657.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8823; val_auprc_score: 0.8820; val_best_acc_score: 0.5567; val_best_f1_score: 0.6882; train_kl_reg_loss: 22316.2815; train_edge_recon_loss: 38916.1367; train_gene_expr_recon_loss: 455251.0069; train_masked_gp_l1_reg_loss: 5679.5038; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247574.5781; train_global_loss: 769737.5208; train_optim_loss: 769737.5208; val_kl_reg_loss: 21456.4590; val_edge_recon_loss: 40587.4609; val_gene_expr_recon_loss: 440983.8750; val_masked_gp_l1_reg_loss: 5622.4971; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243242.2344; val_global_loss: 751892.5625; val_optim_loss: 751892.5625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9109; val_auprc_score: 0.9078; val_best_acc_score: 0.6330; val_best_f1_score: 0.7266; train_kl_reg_loss: 22746.1044; train_edge_recon_loss: 38931.4714; train_gene_expr_recon_loss: 448246.2153; train_masked_gp_l1_reg_loss: 5595.4563; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247155.4514; train_global_loss: 762674.7014; train_optim_loss: 762674.7014; val_kl_reg_loss: 21937.2344; val_edge_recon_loss: 40550.6953; val_gene_expr_recon_loss: 433167.6875; val_masked_gp_l1_reg_loss: 5556.3350; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241705.4688; val_global_loss: 742917.4375; val_optim_loss: 742917.4375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9184; val_auprc_score: 0.9089; val_best_acc_score: 0.7573; val_best_f1_score: 0.7993; train_kl_reg_loss: 23242.0206; train_edge_recon_loss: 38945.1128; train_gene_expr_recon_loss: 440899.2674; train_masked_gp_l1_reg_loss: 5542.3529; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245087.8090; train_global_loss: 753716.5694; train_optim_loss: 753716.5694; val_kl_reg_loss: 22780.6328; val_edge_recon_loss: 40459.0742; val_gene_expr_recon_loss: 426289.0312; val_masked_gp_l1_reg_loss: 5527.8320; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240210.0312; val_global_loss: 735266.6250; val_optim_loss: 735266.6250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9237; val_auprc_score: 0.9152; val_best_acc_score: 0.8251; val_best_f1_score: 0.8438; train_kl_reg_loss: 23632.5927; train_edge_recon_loss: 38928.1727; train_gene_expr_recon_loss: 435680.3715; train_masked_gp_l1_reg_loss: 5529.1560; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243779.3247; train_global_loss: 747549.6111; train_optim_loss: 747549.6111; val_kl_reg_loss: 22286.6445; val_edge_recon_loss: 40351.7891; val_gene_expr_recon_loss: 421871.7500; val_masked_gp_l1_reg_loss: 5527.1733; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239024.0469; val_global_loss: 729061.4375; val_optim_loss: 729061.4375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9274; val_auprc_score: 0.9201; val_best_acc_score: 0.8495; val_best_f1_score: 0.8583; train_kl_reg_loss: 23568.2263; train_edge_recon_loss: 38874.5707; train_gene_expr_recon_loss: 427721.9549; train_masked_gp_l1_reg_loss: 5534.2065; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241628.8628; train_global_loss: 737327.8125; train_optim_loss: 737327.8125; val_kl_reg_loss: 21922.7578; val_edge_recon_loss: 40239.7109; val_gene_expr_recon_loss: 418313.5625; val_masked_gp_l1_reg_loss: 5533.9038; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237985.8438; val_global_loss: 723995.7500; val_optim_loss: 723995.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9333; val_auprc_score: 0.9267; val_best_acc_score: 0.8657; val_best_f1_score: 0.8687; train_kl_reg_loss: 23400.7326; train_edge_recon_loss: 38796.4470; train_gene_expr_recon_loss: 425266.4236; train_masked_gp_l1_reg_loss: 5541.9227; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240723.2188; train_global_loss: 733728.7431; train_optim_loss: 733728.7431; val_kl_reg_loss: 22709.4980; val_edge_recon_loss: 40162.6445; val_gene_expr_recon_loss: 414063.0000; val_masked_gp_l1_reg_loss: 5550.1133; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 236738.6719; val_global_loss: 719223.9375; val_optim_loss: 719223.9375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9343; val_auprc_score: 0.9254; val_best_acc_score: 0.8654; val_best_f1_score: 0.8653; train_kl_reg_loss: 23341.6300; train_edge_recon_loss: 38745.2444; train_gene_expr_recon_loss: 422041.5764; train_masked_gp_l1_reg_loss: 5563.0840; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239513.3247; train_global_loss: 729204.8611; train_optim_loss: 729204.8611; val_kl_reg_loss: 22245.7871; val_edge_recon_loss: 40089.3672; val_gene_expr_recon_loss: 411627.0000; val_masked_gp_l1_reg_loss: 5573.1270; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235653.9531; val_global_loss: 715189.2500; val_optim_loss: 715189.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9431; val_auprc_score: 0.9361; val_best_acc_score: 0.8740; val_best_f1_score: 0.8710; train_kl_reg_loss: 23128.9878; train_edge_recon_loss: 38693.4414; train_gene_expr_recon_loss: 420684.6979; train_masked_gp_l1_reg_loss: 5583.3785; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239688.8993; train_global_loss: 727779.4097; train_optim_loss: 727779.4097; val_kl_reg_loss: 22028.5312; val_edge_recon_loss: 40020.9023; val_gene_expr_recon_loss: 409335.8750; val_masked_gp_l1_reg_loss: 5594.3213; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 234741.3750; val_global_loss: 711721.0000; val_optim_loss: 711721.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9356; val_auprc_score: 0.9229; val_best_acc_score: 0.8577; val_best_f1_score: 0.8536; train_kl_reg_loss: 22906.8424; train_edge_recon_loss: 38654.4909; train_gene_expr_recon_loss: 416299.8403; train_masked_gp_l1_reg_loss: 5607.1233; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237603.7535; train_global_loss: 721072.0556; train_optim_loss: 721072.0556; val_kl_reg_loss: 21260.8633; val_edge_recon_loss: 39962.3359; val_gene_expr_recon_loss: 407849.3750; val_masked_gp_l1_reg_loss: 5616.7266; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233994.0000; val_global_loss: 708683.2500; val_optim_loss: 708683.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9402; val_auprc_score: 0.9349; val_best_acc_score: 0.8576; val_best_f1_score: 0.8519; train_kl_reg_loss: 22513.4902; train_edge_recon_loss: 38588.9397; train_gene_expr_recon_loss: 415446.8924; train_masked_gp_l1_reg_loss: 5632.0215; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 238491.0399; train_global_loss: 720672.3819; train_optim_loss: 720672.3819; val_kl_reg_loss: 21399.0703; val_edge_recon_loss: 39892.2656; val_gene_expr_recon_loss: 405667.6875; val_masked_gp_l1_reg_loss: 5642.6606; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233129.3906; val_global_loss: 705731.0625; val_optim_loss: 705731.0625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9395; val_auprc_score: 0.9273; val_best_acc_score: 0.8550; val_best_f1_score: 0.8470; train_kl_reg_loss: 22287.8904; train_edge_recon_loss: 38534.2470; train_gene_expr_recon_loss: 413739.1806; train_masked_gp_l1_reg_loss: 5654.4373; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236761.9601; train_global_loss: 716977.7222; train_optim_loss: 716977.7222; val_kl_reg_loss: 20872.8340; val_edge_recon_loss: 39824.1836; val_gene_expr_recon_loss: 404376.8125; val_masked_gp_l1_reg_loss: 5664.1309; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232555.9375; val_global_loss: 703293.8750; val_optim_loss: 703293.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9423; val_auprc_score: 0.9367; val_best_acc_score: 0.8514; val_best_f1_score: 0.8414; train_kl_reg_loss: 21958.6680; train_edge_recon_loss: 38488.0343; train_gene_expr_recon_loss: 413200.7222; train_masked_gp_l1_reg_loss: 5678.2666; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236877.7292; train_global_loss: 716203.4236; train_optim_loss: 716203.4236; val_kl_reg_loss: 20327.2227; val_edge_recon_loss: 39795.8633; val_gene_expr_recon_loss: 403368.7188; val_masked_gp_l1_reg_loss: 5686.2739; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231869.5625; val_global_loss: 701047.6250; val_optim_loss: 701047.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9380; val_auprc_score: 0.9277; val_best_acc_score: 0.8491; val_best_f1_score: 0.8391; train_kl_reg_loss: 21582.3644; train_edge_recon_loss: 38459.3876; train_gene_expr_recon_loss: 406946.8368; train_masked_gp_l1_reg_loss: 5700.3295; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234229.3438; train_global_loss: 706918.2569; train_optim_loss: 706918.2569; val_kl_reg_loss: 20321.4199; val_edge_recon_loss: 39774.3906; val_gene_expr_recon_loss: 401820.5000; val_masked_gp_l1_reg_loss: 5703.9688; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231211.5000; val_global_loss: 698831.7500; val_optim_loss: 698831.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9410; val_auprc_score: 0.9344; val_best_acc_score: 0.8480; val_best_f1_score: 0.8369; train_kl_reg_loss: 21350.7563; train_edge_recon_loss: 38419.5469; train_gene_expr_recon_loss: 412214.4479; train_masked_gp_l1_reg_loss: 5712.3016; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 235076.8056; train_global_loss: 712773.8542; train_optim_loss: 712773.8542; val_kl_reg_loss: 20798.5664; val_edge_recon_loss: 39752.6523; val_gene_expr_recon_loss: 399966.6250; val_masked_gp_l1_reg_loss: 5724.6138; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 230459.6719; val_global_loss: 696702.1250; val_optim_loss: 696702.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9458; val_auprc_score: 0.9401; val_best_acc_score: 0.8441; val_best_f1_score: 0.8416; train_kl_reg_loss: 21186.3522; train_edge_recon_loss: 38382.7730; train_gene_expr_recon_loss: 407722.3646; train_masked_gp_l1_reg_loss: 5738.7214; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233612.5451; train_global_loss: 706642.7639; train_optim_loss: 706642.7639; val_kl_reg_loss: 19109.7734; val_edge_recon_loss: 39679.3711; val_gene_expr_recon_loss: 400538.1250; val_masked_gp_l1_reg_loss: 5744.2183; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 230164.5938; val_global_loss: 695236.1250; val_optim_loss: 695236.1250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9460; val_auprc_score: 0.9367; val_best_acc_score: 0.8457; val_best_f1_score: 0.8504; train_kl_reg_loss: 20726.8704; train_edge_recon_loss: 38347.4353; train_gene_expr_recon_loss: 408700.2222; train_masked_gp_l1_reg_loss: 5754.8855; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233499.9427; train_global_loss: 707029.3611; train_optim_loss: 707029.3611; val_kl_reg_loss: 19574.7812; val_edge_recon_loss: 39669.8164; val_gene_expr_recon_loss: 398662.9375; val_masked_gp_l1_reg_loss: 5763.4180; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 229411.9844; val_global_loss: 693082.9375; val_optim_loss: 693082.9375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9452; val_auprc_score: 0.9403; val_best_acc_score: 0.8428; val_best_f1_score: 0.8429; train_kl_reg_loss: 20563.3444; train_edge_recon_loss: 38320.6819; train_gene_expr_recon_loss: 405880.0660; train_masked_gp_l1_reg_loss: 5775.7171; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233159.4514; train_global_loss: 703699.2569; train_optim_loss: 703699.2569; val_kl_reg_loss: 19560.2109; val_edge_recon_loss: 39684.5781; val_gene_expr_recon_loss: 397523.1875; val_masked_gp_l1_reg_loss: 5785.3638; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 228805.0312; val_global_loss: 691358.3750; val_optim_loss: 691358.3750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9482; val_auprc_score: 0.9424; val_best_acc_score: 0.8378; val_best_f1_score: 0.8534; train_kl_reg_loss: 20344.7871; train_edge_recon_loss: 38287.6115; train_gene_expr_recon_loss: 406407.6181; train_masked_gp_l1_reg_loss: 5796.8142; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233746.2934; train_global_loss: 704583.1319; train_optim_loss: 704583.1319; val_kl_reg_loss: 18912.4277; val_edge_recon_loss: 39615.3438; val_gene_expr_recon_loss: 397110.8750; val_masked_gp_l1_reg_loss: 5802.5151; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 228494.3594; val_global_loss: 689935.5000; val_optim_loss: 689935.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9526; val_auprc_score: 0.9470; val_best_acc_score: 0.8403; val_best_f1_score: 0.8592; train_kl_reg_loss: 20048.8743; train_edge_recon_loss: 38240.0412; train_gene_expr_recon_loss: 404008.4271; train_masked_gp_l1_reg_loss: 5815.0522; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 231223.9306; train_global_loss: 699336.3333; train_optim_loss: 699336.3333; val_kl_reg_loss: 18704.5137; val_edge_recon_loss: 39543.9258; val_gene_expr_recon_loss: 396272.0312; val_masked_gp_l1_reg_loss: 5821.9375; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 228039.1094; val_global_loss: 688381.5000; val_optim_loss: 688381.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9546; val_auprc_score: 0.9509; val_best_acc_score: 0.8424; val_best_f1_score: 0.8607; train_kl_reg_loss: 19834.4375; train_edge_recon_loss: 38190.1237; train_gene_expr_recon_loss: 405283.2326; train_masked_gp_l1_reg_loss: 5833.2122; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 231541.4323; train_global_loss: 700682.4444; train_optim_loss: 700682.4444; val_kl_reg_loss: 18920.9375; val_edge_recon_loss: 39547.1367; val_gene_expr_recon_loss: 395065.5312; val_masked_gp_l1_reg_loss: 5842.0986; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 227452.1562; val_global_loss: 686827.8750; val_optim_loss: 686827.8750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9552; val_auprc_score: 0.9475; val_best_acc_score: 0.8774; val_best_f1_score: 0.8864; train_kl_reg_loss: 19810.6886; train_edge_recon_loss: 40169.1046; train_gene_expr_recon_loss: 422946.5799; train_masked_gp_l1_reg_loss: 5862.4356; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236335.5260; train_global_loss: 725124.3264; train_optim_loss: 725124.3264; val_kl_reg_loss: 15195.9531; val_edge_recon_loss: 40390.4062; val_gene_expr_recon_loss: 409937.7188; val_masked_gp_l1_reg_loss: 5859.9297; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231211.5781; val_global_loss: 702595.5625; val_optim_loss: 702595.5625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9553; val_auprc_score: 0.9511; val_best_acc_score: 0.8717; val_best_f1_score: 0.8819; train_kl_reg_loss: 17456.0521; train_edge_recon_loss: 40265.2513; train_gene_expr_recon_loss: 417440.6597; train_masked_gp_l1_reg_loss: 5847.3637; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234854.7899; train_global_loss: 715864.1250; train_optim_loss: 715864.1250; val_kl_reg_loss: 14628.8857; val_edge_recon_loss: 40377.2188; val_gene_expr_recon_loss: 408127.0000; val_masked_gp_l1_reg_loss: 5820.8809; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 230684.2344; val_global_loss: 699638.1875; val_optim_loss: 699638.1875
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9529; val_auprc_score: 0.9453; val_best_acc_score: 0.8828; val_best_f1_score: 0.8890; train_kl_reg_loss: 16641.5881; train_edge_recon_loss: 40194.2847; train_gene_expr_recon_loss: 414724.8681; train_masked_gp_l1_reg_loss: 5799.7873; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233837.1545; train_global_loss: 711197.6736; train_optim_loss: 711197.6736; val_kl_reg_loss: 14477.9199; val_edge_recon_loss: 40283.9922; val_gene_expr_recon_loss: 406722.8750; val_masked_gp_l1_reg_loss: 5769.5557; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 230283.3438; val_global_loss: 697537.6875; val_optim_loss: 697537.6875
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9520; val_auprc_score: 0.9473; val_best_acc_score: 0.8841; val_best_f1_score: 0.8885; train_kl_reg_loss: 16180.7581; train_edge_recon_loss: 40129.9566; train_gene_expr_recon_loss: 413693.5486; train_masked_gp_l1_reg_loss: 5752.3720; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233136.0347; train_global_loss: 708892.6806; train_optim_loss: 708892.6806; val_kl_reg_loss: 13982.8008; val_edge_recon_loss: 40227.1523; val_gene_expr_recon_loss: 406702.5938; val_masked_gp_l1_reg_loss: 5725.6943; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 229996.0938; val_global_loss: 696634.3750; val_optim_loss: 696634.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9546; val_auprc_score: 0.9479; val_best_acc_score: 0.8884; val_best_f1_score: 0.8929; train_kl_reg_loss: 15894.3612; train_edge_recon_loss: 40100.5035; train_gene_expr_recon_loss: 414665.0417; train_masked_gp_l1_reg_loss: 5688.7189; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233113.2587; train_global_loss: 709461.8889; train_optim_loss: 709461.8889; val_kl_reg_loss: 15163.2383; val_edge_recon_loss: 40238.7617; val_gene_expr_recon_loss: 405161.5312; val_masked_gp_l1_reg_loss: 5656.3389; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 229713.5469; val_global_loss: 695933.4375; val_optim_loss: 695933.4375
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9530; val_auprc_score: 0.9462; val_best_acc_score: 0.8844; val_best_f1_score: 0.8891; train_kl_reg_loss: 15726.3677; train_edge_recon_loss: 40092.4323; train_gene_expr_recon_loss: 414846.1910; train_masked_gp_l1_reg_loss: 5646.8388; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233551.3611; train_global_loss: 709863.1944; train_optim_loss: 709863.1944; val_kl_reg_loss: 14634.2148; val_edge_recon_loss: 40225.4062; val_gene_expr_recon_loss: 405595.5000; val_masked_gp_l1_reg_loss: 5632.2773; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 229775.4844; val_global_loss: 695862.8750; val_optim_loss: 695862.8750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9564; val_auprc_score: 0.9513; val_best_acc_score: 0.8890; val_best_f1_score: 0.8930; train_kl_reg_loss: 15945.5388; train_edge_recon_loss: 40093.4010; train_gene_expr_recon_loss: 417079.7431; train_masked_gp_l1_reg_loss: 5624.6603; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234269.2361; train_global_loss: 713012.5764; train_optim_loss: 713012.5764; val_kl_reg_loss: 14636.8008; val_edge_recon_loss: 40222.5039; val_gene_expr_recon_loss: 405434.3750; val_masked_gp_l1_reg_loss: 5615.5107; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 229751.5156; val_global_loss: 695660.6875; val_optim_loss: 695660.6875
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9553; val_auprc_score: 0.9505; val_best_acc_score: 0.8882; val_best_f1_score: 0.8923; train_kl_reg_loss: 15719.1182; train_edge_recon_loss: 40086.1871; train_gene_expr_recon_loss: 413516.0868; train_masked_gp_l1_reg_loss: 5609.8553; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234226.2639; train_global_loss: 709157.5139; train_optim_loss: 709157.5139; val_kl_reg_loss: 14769.2070; val_edge_recon_loss: 40236.4453; val_gene_expr_recon_loss: 405178.1875; val_masked_gp_l1_reg_loss: 5603.7549; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 229659.5000; val_global_loss: 695447.1250; val_optim_loss: 695447.1250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 23 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9556
val AUPRC score: 0.9501
val best accuracy score: 0.8867
val best F1 score: 0.8903
val target rna MSE score: 0.5156
val source rna MSE score: 0.3476
val target atac MSE score: 0.1272
val source atac MSE score: 0.0180
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
