[True]
Run timestamp: 09102023_215332_49.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_49']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7883; val_auprc_score: 0.8071; val_best_acc_score: 0.5237; val_best_f1_score: 0.6762; train_kl_reg_loss: 56898.8011; train_edge_recon_loss: 3497925.6584; train_gene_expr_recon_loss: 13454671.3053; train_masked_gp_l1_reg_loss: 35525.0529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2378054.0635; train_chrom_access_recon_loss: 2867357.0859; train_global_loss: 22290431.9695; train_optim_loss: 22290431.9695; val_kl_reg_loss: 98626.6422; val_edge_recon_loss: 4063403.6500; val_gene_expr_recon_loss: 12615337.8667; val_masked_gp_l1_reg_loss: 42001.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 563722.9375; val_chrom_access_recon_loss: 2770827.9833; val_global_loss: 20153920.4000; val_optim_loss: 20153920.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7937; val_auprc_score: 0.8114; val_best_acc_score: 0.7018; val_best_f1_score: 0.7117; train_kl_reg_loss: 70313.8581; train_edge_recon_loss: 3494714.9771; train_gene_expr_recon_loss: 12648437.4504; train_masked_gp_l1_reg_loss: 45770.9345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 305963.8545; train_chrom_access_recon_loss: 2758375.5000; train_global_loss: 19323576.6107; train_optim_loss: 19323576.6107; val_kl_reg_loss: 68803.1797; val_edge_recon_loss: 4023620.2167; val_gene_expr_recon_loss: 12491306.2667; val_masked_gp_l1_reg_loss: 47730.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178471.6875; val_chrom_access_recon_loss: 2752525.0833; val_global_loss: 19562457.7333; val_optim_loss: 19562457.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7837; val_auprc_score: 0.7950; val_best_acc_score: 0.6906; val_best_f1_score: 0.7300; train_kl_reg_loss: 64103.8126; train_edge_recon_loss: 3270555.8073; train_gene_expr_recon_loss: 12465670.6870; train_masked_gp_l1_reg_loss: 50492.9950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140041.1565; train_chrom_access_recon_loss: 2728884.8531; train_global_loss: 18719749.3130; train_optim_loss: 18719749.3130; val_kl_reg_loss: 80297.8484; val_edge_recon_loss: 3270694.8833; val_gene_expr_recon_loss: 12367851.3333; val_masked_gp_l1_reg_loss: 53964.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112526.3672; val_chrom_access_recon_loss: 2716510.2500; val_global_loss: 18601844.4000; val_optim_loss: 18601844.4000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8383; val_auprc_score: 0.8371; val_best_acc_score: 0.7420; val_best_f1_score: 0.7706; train_kl_reg_loss: 83026.9929; train_edge_recon_loss: 3025045.6202; train_gene_expr_recon_loss: 12339307.4962; train_masked_gp_l1_reg_loss: 55922.2118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99298.6562; train_chrom_access_recon_loss: 2702957.7137; train_global_loss: 18305558.7176; train_optim_loss: 18305558.7176; val_kl_reg_loss: 79133.2854; val_edge_recon_loss: 3028229.8333; val_gene_expr_recon_loss: 12243034.5333; val_masked_gp_l1_reg_loss: 57676.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90153.4219; val_chrom_access_recon_loss: 2699571.1500; val_global_loss: 18197797.8667; val_optim_loss: 18197797.8667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9092; val_auprc_score: 0.8974; val_best_acc_score: 0.8331; val_best_f1_score: 0.8424; train_kl_reg_loss: 76776.7727; train_edge_recon_loss: 2953515.3111; train_gene_expr_recon_loss: 12206023.5038; train_masked_gp_l1_reg_loss: 59306.6974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87691.2801; train_chrom_access_recon_loss: 2675481.3550; train_global_loss: 18058794.9618; train_optim_loss: 18058794.9618; val_kl_reg_loss: 76677.4432; val_edge_recon_loss: 2853518.7333; val_gene_expr_recon_loss: 12120546.4667; val_masked_gp_l1_reg_loss: 61116.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88464.7031; val_chrom_access_recon_loss: 2673308.1000; val_global_loss: 17873631.8667; val_optim_loss: 17873631.8667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9242; val_auprc_score: 0.9048; val_best_acc_score: 0.8601; val_best_f1_score: 0.8676; train_kl_reg_loss: 83634.9196; train_edge_recon_loss: 2808769.2290; train_gene_expr_recon_loss: 12091225.8626; train_masked_gp_l1_reg_loss: 62912.2948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88150.7579; train_chrom_access_recon_loss: 2656598.9103; train_global_loss: 17791292.0687; train_optim_loss: 17791292.0687; val_kl_reg_loss: 82235.0401; val_edge_recon_loss: 2826866.9000; val_gene_expr_recon_loss: 11996894.9333; val_masked_gp_l1_reg_loss: 64260.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86726.0078; val_chrom_access_recon_loss: 2647847.5167; val_global_loss: 17704830.4000; val_optim_loss: 17704830.4000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9297; val_auprc_score: 0.9150; val_best_acc_score: 0.8647; val_best_f1_score: 0.8743; train_kl_reg_loss: 81837.9879; train_edge_recon_loss: 2791820.2882; train_gene_expr_recon_loss: 12002915.8855; train_masked_gp_l1_reg_loss: 65342.6080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84334.8155; train_chrom_access_recon_loss: 2637813.1908; train_global_loss: 17664064.8168; train_optim_loss: 17664064.8168; val_kl_reg_loss: 76399.0562; val_edge_recon_loss: 2820097.9500; val_gene_expr_recon_loss: 11974904.0667; val_masked_gp_l1_reg_loss: 66307.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81885.1719; val_chrom_access_recon_loss: 2652851.2500; val_global_loss: 17672444.4000; val_optim_loss: 17672444.4000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9342; val_auprc_score: 0.9202; val_best_acc_score: 0.8738; val_best_f1_score: 0.8785; train_kl_reg_loss: 79306.3337; train_edge_recon_loss: 2774791.4828; train_gene_expr_recon_loss: 11914485.2519; train_masked_gp_l1_reg_loss: 67172.3101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79382.9505; train_chrom_access_recon_loss: 2620311.6660; train_global_loss: 17535450.0763; train_optim_loss: 17535450.0763; val_kl_reg_loss: 77826.2995; val_edge_recon_loss: 2787406.9000; val_gene_expr_recon_loss: 11794484.8667; val_masked_gp_l1_reg_loss: 67848.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77863.6719; val_chrom_access_recon_loss: 2613462.7500; val_global_loss: 17418893.7333; val_optim_loss: 17418893.7333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9338; val_auprc_score: 0.9189; val_best_acc_score: 0.8708; val_best_f1_score: 0.8783; train_kl_reg_loss: 76503.3900; train_edge_recon_loss: 2776617.0458; train_gene_expr_recon_loss: 11835133.6107; train_masked_gp_l1_reg_loss: 68498.9479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75823.6180; train_chrom_access_recon_loss: 2602030.8740; train_global_loss: 17434607.4885; train_optim_loss: 17434607.4885; val_kl_reg_loss: 74407.3536; val_edge_recon_loss: 2786614.2833; val_gene_expr_recon_loss: 11765702.1333; val_masked_gp_l1_reg_loss: 69253.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74353.6250; val_chrom_access_recon_loss: 2606282.5000; val_global_loss: 17376614.5333; val_optim_loss: 17376614.5333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9400; val_auprc_score: 0.9263; val_best_acc_score: 0.8771; val_best_f1_score: 0.8838; train_kl_reg_loss: 74230.4863; train_edge_recon_loss: 2768499.9504; train_gene_expr_recon_loss: 11789520.9695; train_masked_gp_l1_reg_loss: 69665.8504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73179.4843; train_chrom_access_recon_loss: 2593184.0553; train_global_loss: 17368280.8092; train_optim_loss: 17368280.8092; val_kl_reg_loss: 70804.0807; val_edge_recon_loss: 2782633.7333; val_gene_expr_recon_loss: 11727401.3333; val_masked_gp_l1_reg_loss: 70364.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72853.4297; val_chrom_access_recon_loss: 2595309.0000; val_global_loss: 17319366.4000; val_optim_loss: 17319366.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9388; val_auprc_score: 0.9224; val_best_acc_score: 0.8777; val_best_f1_score: 0.8848; train_kl_reg_loss: 73095.4311; train_edge_recon_loss: 2742531.2366; train_gene_expr_recon_loss: 11743681.8473; train_masked_gp_l1_reg_loss: 70817.0231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71468.7566; train_chrom_access_recon_loss: 2584622.5439; train_global_loss: 17286216.9237; train_optim_loss: 17286216.9237; val_kl_reg_loss: 71247.1297; val_edge_recon_loss: 2756590.4667; val_gene_expr_recon_loss: 11724947.2667; val_masked_gp_l1_reg_loss: 71270.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71623.8906; val_chrom_access_recon_loss: 2583333.4833; val_global_loss: 17279013.2667; val_optim_loss: 17279013.2667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9422; val_auprc_score: 0.9289; val_best_acc_score: 0.8812; val_best_f1_score: 0.8869; train_kl_reg_loss: 73455.4461; train_edge_recon_loss: 2730591.6832; train_gene_expr_recon_loss: 11683707.4504; train_masked_gp_l1_reg_loss: 71571.4872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70287.3495; train_chrom_access_recon_loss: 2569783.6031; train_global_loss: 17199397.1603; train_optim_loss: 17199397.1603; val_kl_reg_loss: 72882.1885; val_edge_recon_loss: 2755126.3833; val_gene_expr_recon_loss: 11691560.6000; val_masked_gp_l1_reg_loss: 72119.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70498.7500; val_chrom_access_recon_loss: 2574119.4500; val_global_loss: 17236307.5333; val_optim_loss: 17236307.5333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9443; val_auprc_score: 0.9292; val_best_acc_score: 0.8878; val_best_f1_score: 0.8933; train_kl_reg_loss: 71771.7119; train_edge_recon_loss: 2726582.4427; train_gene_expr_recon_loss: 11641964.3206; train_masked_gp_l1_reg_loss: 72429.0460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70388.3484; train_chrom_access_recon_loss: 2561596.0821; train_global_loss: 17144731.8702; train_optim_loss: 17144731.8702; val_kl_reg_loss: 72225.7188; val_edge_recon_loss: 2742522.5500; val_gene_expr_recon_loss: 11590873.6000; val_masked_gp_l1_reg_loss: 72992.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71188.7422; val_chrom_access_recon_loss: 2557753.0167; val_global_loss: 17107556.8000; val_optim_loss: 17107556.8000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9539; val_auprc_score: 0.9438; val_best_acc_score: 0.8969; val_best_f1_score: 0.9006; train_kl_reg_loss: 71575.8268; train_edge_recon_loss: 2719958.5115; train_gene_expr_recon_loss: 11595423.0687; train_masked_gp_l1_reg_loss: 73103.7126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71601.9618; train_chrom_access_recon_loss: 2550226.4294; train_global_loss: 17081889.5496; train_optim_loss: 17081889.5496; val_kl_reg_loss: 67638.2380; val_edge_recon_loss: 2724186.6000; val_gene_expr_recon_loss: 11553933.7333; val_masked_gp_l1_reg_loss: 73393.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72315.9531; val_chrom_access_recon_loss: 2561288.7500; val_global_loss: 17052756.3333; val_optim_loss: 17052756.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9543; val_auprc_score: 0.9411; val_best_acc_score: 0.8980; val_best_f1_score: 0.9027; train_kl_reg_loss: 67681.0624; train_edge_recon_loss: 2717812.3187; train_gene_expr_recon_loss: 11566003.4046; train_masked_gp_l1_reg_loss: 73802.6787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72650.3793; train_chrom_access_recon_loss: 2544646.3282; train_global_loss: 17042596.2672; train_optim_loss: 17042596.2672; val_kl_reg_loss: 71248.2630; val_edge_recon_loss: 2700058.3333; val_gene_expr_recon_loss: 11518031.2667; val_masked_gp_l1_reg_loss: 74210.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73076.3359; val_chrom_access_recon_loss: 2553986.5667; val_global_loss: 16990610.4000; val_optim_loss: 16990610.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9577; val_auprc_score: 0.9473; val_best_acc_score: 0.8999; val_best_f1_score: 0.9040; train_kl_reg_loss: 70861.9953; train_edge_recon_loss: 2714738.7004; train_gene_expr_recon_loss: 11527411.9008; train_masked_gp_l1_reg_loss: 74245.2216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72434.5306; train_chrom_access_recon_loss: 2533974.7118; train_global_loss: 16993667.0229; train_optim_loss: 16993667.0229; val_kl_reg_loss: 69370.5766; val_edge_recon_loss: 2725898.6333; val_gene_expr_recon_loss: 11469339.0000; val_masked_gp_l1_reg_loss: 74586.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73123.3438; val_chrom_access_recon_loss: 2528632.2167; val_global_loss: 16940950.4000; val_optim_loss: 16940950.4000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9582; val_auprc_score: 0.9471; val_best_acc_score: 0.8999; val_best_f1_score: 0.9042; train_kl_reg_loss: 69970.8028; train_edge_recon_loss: 2708239.5420; train_gene_expr_recon_loss: 11496467.2443; train_masked_gp_l1_reg_loss: 74632.5655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72083.8737; train_chrom_access_recon_loss: 2529063.0115; train_global_loss: 16950456.9466; train_optim_loss: 16950456.9466; val_kl_reg_loss: 68934.6609; val_edge_recon_loss: 2713366.1000; val_gene_expr_recon_loss: 11434545.9333; val_masked_gp_l1_reg_loss: 74802.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72422.3047; val_chrom_access_recon_loss: 2524431.7333; val_global_loss: 16888502.1333; val_optim_loss: 16888502.1333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9598; val_auprc_score: 0.9462; val_best_acc_score: 0.9049; val_best_f1_score: 0.9081; train_kl_reg_loss: 67477.7307; train_edge_recon_loss: 2701515.0439; train_gene_expr_recon_loss: 11469056.0916; train_masked_gp_l1_reg_loss: 74940.3542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71495.4631; train_chrom_access_recon_loss: 2522278.2405; train_global_loss: 16906762.8626; train_optim_loss: 16906762.8626; val_kl_reg_loss: 69575.0141; val_edge_recon_loss: 2707227.3000; val_gene_expr_recon_loss: 11445792.0000; val_masked_gp_l1_reg_loss: 75179.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71814.5391; val_chrom_access_recon_loss: 2543245.3667; val_global_loss: 16912833.8000; val_optim_loss: 16912833.8000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9635; val_auprc_score: 0.9538; val_best_acc_score: 0.9056; val_best_f1_score: 0.9093; train_kl_reg_loss: 68325.3681; train_edge_recon_loss: 2696725.1221; train_gene_expr_recon_loss: 11434327.8168; train_masked_gp_l1_reg_loss: 75264.0875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71337.9177; train_chrom_access_recon_loss: 2511087.2500; train_global_loss: 16857067.5344; train_optim_loss: 16857067.5344; val_kl_reg_loss: 68929.9797; val_edge_recon_loss: 2704422.0167; val_gene_expr_recon_loss: 11407889.8667; val_masked_gp_l1_reg_loss: 75441.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71060.7891; val_chrom_access_recon_loss: 2537411.9833; val_global_loss: 16865155.7333; val_optim_loss: 16865155.7333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9632; val_auprc_score: 0.9521; val_best_acc_score: 0.9128; val_best_f1_score: 0.9169; train_kl_reg_loss: 67732.8426; train_edge_recon_loss: 2699236.0992; train_gene_expr_recon_loss: 11417486.1450; train_masked_gp_l1_reg_loss: 75488.1700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70948.7638; train_chrom_access_recon_loss: 2509952.2882; train_global_loss: 16840844.3053; train_optim_loss: 16840844.3053; val_kl_reg_loss: 68695.1008; val_edge_recon_loss: 2711083.1333; val_gene_expr_recon_loss: 11362223.4000; val_masked_gp_l1_reg_loss: 75494.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70992.3906; val_chrom_access_recon_loss: 2512796.4833; val_global_loss: 16801283.9333; val_optim_loss: 16801283.9333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9633; val_auprc_score: 0.9537; val_best_acc_score: 0.9080; val_best_f1_score: 0.9108; train_kl_reg_loss: 67497.8999; train_edge_recon_loss: 2694786.5668; train_gene_expr_recon_loss: 11397930.5649; train_masked_gp_l1_reg_loss: 75540.6387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70704.3409; train_chrom_access_recon_loss: 2502445.7233; train_global_loss: 16808905.7557; train_optim_loss: 16808905.7557; val_kl_reg_loss: 67035.9867; val_edge_recon_loss: 2722019.0000; val_gene_expr_recon_loss: 11321778.2000; val_masked_gp_l1_reg_loss: 75653.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70787.4219; val_chrom_access_recon_loss: 2506792.9167; val_global_loss: 16764066.3333; val_optim_loss: 16764066.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9634; val_auprc_score: 0.9538; val_best_acc_score: 0.9107; val_best_f1_score: 0.9137; train_kl_reg_loss: 67188.5576; train_edge_recon_loss: 2688776.6279; train_gene_expr_recon_loss: 11382543.9160; train_masked_gp_l1_reg_loss: 75613.5506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70534.4741; train_chrom_access_recon_loss: 2500624.8702; train_global_loss: 16785282.0840; train_optim_loss: 16785282.0840; val_kl_reg_loss: 67369.9622; val_edge_recon_loss: 2706615.4333; val_gene_expr_recon_loss: 11368891.1333; val_masked_gp_l1_reg_loss: 75568.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70421.3984; val_chrom_access_recon_loss: 2508615.3500; val_global_loss: 16797480.8667; val_optim_loss: 16797480.8667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9608; val_auprc_score: 0.9479; val_best_acc_score: 0.9092; val_best_f1_score: 0.9128; train_kl_reg_loss: 66195.3750; train_edge_recon_loss: 2681419.6966; train_gene_expr_recon_loss: 11365069.2290; train_masked_gp_l1_reg_loss: 75660.6381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70351.0176; train_chrom_access_recon_loss: 2494575.1870; train_global_loss: 16753271.1298; train_optim_loss: 16753271.1298; val_kl_reg_loss: 67052.9992; val_edge_recon_loss: 2701027.8000; val_gene_expr_recon_loss: 11351586.7333; val_masked_gp_l1_reg_loss: 75682.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71070.7031; val_chrom_access_recon_loss: 2507448.8500; val_global_loss: 16773870.3333; val_optim_loss: 16773870.3333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9653; val_auprc_score: 0.9545; val_best_acc_score: 0.9150; val_best_f1_score: 0.9182; train_kl_reg_loss: 65844.9284; train_edge_recon_loss: 2680498.0763; train_gene_expr_recon_loss: 11341976.1221; train_masked_gp_l1_reg_loss: 75634.6964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70518.9006; train_chrom_access_recon_loss: 2489402.9866; train_global_loss: 16723875.8015; train_optim_loss: 16723875.8015; val_kl_reg_loss: 65881.3003; val_edge_recon_loss: 2701708.1333; val_gene_expr_recon_loss: 11278707.2000; val_masked_gp_l1_reg_loss: 75634.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70362.2969; val_chrom_access_recon_loss: 2508912.7500; val_global_loss: 16701205.4000; val_optim_loss: 16701205.4000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9677; val_auprc_score: 0.9611; val_best_acc_score: 0.9155; val_best_f1_score: 0.9179; train_kl_reg_loss: 66540.1300; train_edge_recon_loss: 2685417.1870; train_gene_expr_recon_loss: 11329668.5344; train_masked_gp_l1_reg_loss: 75484.4966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70450.4325; train_chrom_access_recon_loss: 2488017.0363; train_global_loss: 16715577.8321; train_optim_loss: 16715577.8321; val_kl_reg_loss: 65214.4346; val_edge_recon_loss: 2704986.3167; val_gene_expr_recon_loss: 11333189.8667; val_masked_gp_l1_reg_loss: 75320.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71071.7109; val_chrom_access_recon_loss: 2498651.8833; val_global_loss: 16748434.4000; val_optim_loss: 16748434.4000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9628; val_auprc_score: 0.9508; val_best_acc_score: 0.9113; val_best_f1_score: 0.9142; train_kl_reg_loss: 83591.9485; train_edge_recon_loss: 2765632.5248; train_gene_expr_recon_loss: 10200733.0992; train_masked_gp_l1_reg_loss: 74572.9396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65383.6211; train_chrom_access_recon_loss: 2252684.1155; train_global_loss: 15442598.1679; train_optim_loss: 15442598.1679; val_kl_reg_loss: 22584.7250; val_edge_recon_loss: 2743424.9000; val_gene_expr_recon_loss: 10127216.1333; val_masked_gp_l1_reg_loss: 73379.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66043.5703; val_chrom_access_recon_loss: 2245518.0750; val_global_loss: 15278167.6667; val_optim_loss: 15278167.6667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9621; val_auprc_score: 0.9509; val_best_acc_score: 0.9073; val_best_f1_score: 0.9106; train_kl_reg_loss: 59954.9160; train_edge_recon_loss: 2714246.7233; train_gene_expr_recon_loss: 10163614.6412; train_masked_gp_l1_reg_loss: 72095.9979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66819.5084; train_chrom_access_recon_loss: 2240872.3235; train_global_loss: 15317604.2137; train_optim_loss: 15317604.2137; val_kl_reg_loss: 27995.1518; val_edge_recon_loss: 2734460.0833; val_gene_expr_recon_loss: 10118806.0000; val_masked_gp_l1_reg_loss: 70714.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67188.9062; val_chrom_access_recon_loss: 2243333.8250; val_global_loss: 15262499.2000; val_optim_loss: 15262499.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9638; val_auprc_score: 0.9547; val_best_acc_score: 0.9099; val_best_f1_score: 0.9144; train_kl_reg_loss: 53197.2263; train_edge_recon_loss: 2688402.3359; train_gene_expr_recon_loss: 10133637.2443; train_masked_gp_l1_reg_loss: 69464.7868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67479.3008; train_chrom_access_recon_loss: 2235275.1956; train_global_loss: 15247456.0611; train_optim_loss: 15247456.0611; val_kl_reg_loss: 31926.5669; val_edge_recon_loss: 2719855.4667; val_gene_expr_recon_loss: 10081950.4667; val_masked_gp_l1_reg_loss: 68080.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67195.5625; val_chrom_access_recon_loss: 2241104.7500; val_global_loss: 15210114.2000; val_optim_loss: 15210114.2000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9653; val_auprc_score: 0.9557; val_best_acc_score: 0.9122; val_best_f1_score: 0.9161; train_kl_reg_loss: 52239.3635; train_edge_recon_loss: 2682254.9618; train_gene_expr_recon_loss: 10104110.2672; train_masked_gp_l1_reg_loss: 66873.2297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67528.5053; train_chrom_access_recon_loss: 2229057.3101; train_global_loss: 15202063.5649; train_optim_loss: 15202063.5649; val_kl_reg_loss: 35324.3163; val_edge_recon_loss: 2709008.9000; val_gene_expr_recon_loss: 10067688.0000; val_masked_gp_l1_reg_loss: 65596.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67714.8594; val_chrom_access_recon_loss: 2237251.1833; val_global_loss: 15182583.4000; val_optim_loss: 15182583.4000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9623; val_auprc_score: 0.9504; val_best_acc_score: 0.9119; val_best_f1_score: 0.9154; train_kl_reg_loss: 48452.1191; train_edge_recon_loss: 2681096.2824; train_gene_expr_recon_loss: 10089130.0000; train_masked_gp_l1_reg_loss: 64530.1576; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67715.4585; train_chrom_access_recon_loss: 2222749.7090; train_global_loss: 15173673.7252; train_optim_loss: 15173673.7252; val_kl_reg_loss: 33886.1135; val_edge_recon_loss: 2692136.8167; val_gene_expr_recon_loss: 10060205.6667; val_masked_gp_l1_reg_loss: 63523.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68063.9531; val_chrom_access_recon_loss: 2222000.7833; val_global_loss: 15139816.2000; val_optim_loss: 15139816.2000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9643; val_auprc_score: 0.9531; val_best_acc_score: 0.9139; val_best_f1_score: 0.9169; train_kl_reg_loss: 48454.9678; train_edge_recon_loss: 2680511.5515; train_gene_expr_recon_loss: 10063355.8473; train_masked_gp_l1_reg_loss: 62626.1467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67727.5757; train_chrom_access_recon_loss: 2212725.6193; train_global_loss: 15135401.7481; train_optim_loss: 15135401.7481; val_kl_reg_loss: 35451.9602; val_edge_recon_loss: 2693852.5167; val_gene_expr_recon_loss: 10050594.8000; val_masked_gp_l1_reg_loss: 61732.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67662.1641; val_chrom_access_recon_loss: 2220432.0167; val_global_loss: 15129725.4667; val_optim_loss: 15129725.4667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9650; val_auprc_score: 0.9531; val_best_acc_score: 0.9153; val_best_f1_score: 0.9183; train_kl_reg_loss: 47863.7735; train_edge_recon_loss: 2677119.0191; train_gene_expr_recon_loss: 10052900.1908; train_masked_gp_l1_reg_loss: 60990.6428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67760.4090; train_chrom_access_recon_loss: 2211966.8655; train_global_loss: 15118600.8244; train_optim_loss: 15118600.8244; val_kl_reg_loss: 37705.6633; val_edge_recon_loss: 2681808.4167; val_gene_expr_recon_loss: 10022387.8000; val_masked_gp_l1_reg_loss: 60233.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67193.4844; val_chrom_access_recon_loss: 2217728.5833; val_global_loss: 15087056.4667; val_optim_loss: 15087056.4667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9639; val_auprc_score: 0.9533; val_best_acc_score: 0.9126; val_best_f1_score: 0.9148; train_kl_reg_loss: 47208.5427; train_edge_recon_loss: 2670829.5000; train_gene_expr_recon_loss: 10045216.7634; train_masked_gp_l1_reg_loss: 59577.5606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67375.4108; train_chrom_access_recon_loss: 2211215.6784; train_global_loss: 15101423.4046; train_optim_loss: 15101423.4046; val_kl_reg_loss: 38076.5875; val_edge_recon_loss: 2711022.7167; val_gene_expr_recon_loss: 10007113.3333; val_masked_gp_l1_reg_loss: 58974.6445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67578.9297; val_chrom_access_recon_loss: 2213022.4333; val_global_loss: 15095788.9333; val_optim_loss: 15095788.9333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9700; val_auprc_score: 0.9580; val_best_acc_score: 0.9251; val_best_f1_score: 0.9279; train_kl_reg_loss: 46821.8851; train_edge_recon_loss: 2666621.9008; train_gene_expr_recon_loss: 10014665.6718; train_masked_gp_l1_reg_loss: 58388.3322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67334.0426; train_chrom_access_recon_loss: 2206534.3979; train_global_loss: 15060366.2290; train_optim_loss: 15060366.2290; val_kl_reg_loss: 40086.6117; val_edge_recon_loss: 2663636.9500; val_gene_expr_recon_loss: 9941729.2667; val_masked_gp_l1_reg_loss: 57837.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67382.4844; val_chrom_access_recon_loss: 2200730.4750; val_global_loss: 14971403.3333; val_optim_loss: 14971403.3333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9663; val_auprc_score: 0.9574; val_best_acc_score: 0.9135; val_best_f1_score: 0.9167; train_kl_reg_loss: 47307.6809; train_edge_recon_loss: 2661518.7443; train_gene_expr_recon_loss: 10013398.4275; train_masked_gp_l1_reg_loss: 57297.6361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67248.0932; train_chrom_access_recon_loss: 2204166.9847; train_global_loss: 15050937.6412; train_optim_loss: 15050937.6412; val_kl_reg_loss: 39137.7115; val_edge_recon_loss: 2698689.9667; val_gene_expr_recon_loss: 9955537.8000; val_masked_gp_l1_reg_loss: 56831.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67268.0859; val_chrom_access_recon_loss: 2200409.3500; val_global_loss: 15017874.0000; val_optim_loss: 15017874.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9693; val_auprc_score: 0.9581; val_best_acc_score: 0.9220; val_best_f1_score: 0.9243; train_kl_reg_loss: 45410.5679; train_edge_recon_loss: 2665039.4828; train_gene_expr_recon_loss: 10008312.0611; train_masked_gp_l1_reg_loss: 56504.4486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67271.9095; train_chrom_access_recon_loss: 2203253.4008; train_global_loss: 15045791.8626; train_optim_loss: 15045791.8626; val_kl_reg_loss: 39643.5378; val_edge_recon_loss: 2664986.6167; val_gene_expr_recon_loss: 9949009.8667; val_masked_gp_l1_reg_loss: 56130.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67164.5234; val_chrom_access_recon_loss: 2197525.7833; val_global_loss: 14974460.8667; val_optim_loss: 14974460.8667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9691; val_auprc_score: 0.9599; val_best_acc_score: 0.9232; val_best_f1_score: 0.9255; train_kl_reg_loss: 45667.7223; train_edge_recon_loss: 2671632.4046; train_gene_expr_recon_loss: 9993170.4351; train_masked_gp_l1_reg_loss: 55849.0621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67181.8667; train_chrom_access_recon_loss: 2200329.2700; train_global_loss: 15033830.7405; train_optim_loss: 15033830.7405; val_kl_reg_loss: 41196.8867; val_edge_recon_loss: 2666222.1167; val_gene_expr_recon_loss: 9931855.7333; val_masked_gp_l1_reg_loss: 55476.1523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67081.4922; val_chrom_access_recon_loss: 2197506.3583; val_global_loss: 14959338.1333; val_optim_loss: 14959338.1333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9706; val_auprc_score: 0.9600; val_best_acc_score: 0.9241; val_best_f1_score: 0.9267; train_kl_reg_loss: 45913.2984; train_edge_recon_loss: 2671922.5267; train_gene_expr_recon_loss: 9987081.0611; train_masked_gp_l1_reg_loss: 55204.4656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66920.3471; train_chrom_access_recon_loss: 2197560.3655; train_global_loss: 15024601.9847; train_optim_loss: 15024601.9847; val_kl_reg_loss: 40590.4122; val_edge_recon_loss: 2673643.0667; val_gene_expr_recon_loss: 9940217.9333; val_masked_gp_l1_reg_loss: 54959.2070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66849.2031; val_chrom_access_recon_loss: 2193652.9833; val_global_loss: 14969912.0667; val_optim_loss: 14969912.0667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9714; val_auprc_score: 0.9624; val_best_acc_score: 0.9224; val_best_f1_score: 0.9258; train_kl_reg_loss: 45334.0827; train_edge_recon_loss: 2672167.3282; train_gene_expr_recon_loss: 9975864.5267; train_masked_gp_l1_reg_loss: 54670.1477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66949.9570; train_chrom_access_recon_loss: 2199388.5668; train_global_loss: 15014374.6183; train_optim_loss: 15014374.6183; val_kl_reg_loss: 39262.5023; val_edge_recon_loss: 2661449.5167; val_gene_expr_recon_loss: 9959523.9333; val_masked_gp_l1_reg_loss: 54395.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66784.3438; val_chrom_access_recon_loss: 2200629.9750; val_global_loss: 14982045.8667; val_optim_loss: 14982045.8667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9715; val_auprc_score: 0.9619; val_best_acc_score: 0.9240; val_best_f1_score: 0.9264; train_kl_reg_loss: 46144.9292; train_edge_recon_loss: 2663156.6851; train_gene_expr_recon_loss: 9967583.4504; train_masked_gp_l1_reg_loss: 54159.5046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66699.3039; train_chrom_access_recon_loss: 2195007.3435; train_global_loss: 14992751.2214; train_optim_loss: 14992751.2214; val_kl_reg_loss: 40055.1500; val_edge_recon_loss: 2688216.6833; val_gene_expr_recon_loss: 9894137.4000; val_masked_gp_l1_reg_loss: 54035.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66818.1797; val_chrom_access_recon_loss: 2191457.6667; val_global_loss: 14934721.0000; val_optim_loss: 14934721.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9727; val_auprc_score: 0.9631; val_best_acc_score: 0.9237; val_best_f1_score: 0.9256; train_kl_reg_loss: 45515.9298; train_edge_recon_loss: 2658192.6050; train_gene_expr_recon_loss: 9968702.5878; train_masked_gp_l1_reg_loss: 53807.4931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66760.0531; train_chrom_access_recon_loss: 2198065.6469; train_global_loss: 14991044.3053; train_optim_loss: 14991044.3053; val_kl_reg_loss: 40441.9307; val_edge_recon_loss: 2669084.8833; val_gene_expr_recon_loss: 9952179.6667; val_masked_gp_l1_reg_loss: 53568.9414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66711.5000; val_chrom_access_recon_loss: 2198472.2417; val_global_loss: 14980459.0667; val_optim_loss: 14980459.0667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9704; val_auprc_score: 0.9628; val_best_acc_score: 0.9227; val_best_f1_score: 0.9253; train_kl_reg_loss: 43775.4157; train_edge_recon_loss: 2662634.0229; train_gene_expr_recon_loss: 9962415.6412; train_masked_gp_l1_reg_loss: 53449.5649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67017.1934; train_chrom_access_recon_loss: 2195772.2729; train_global_loss: 14985064.0840; train_optim_loss: 14985064.0840; val_kl_reg_loss: 40972.8703; val_edge_recon_loss: 2668182.2000; val_gene_expr_recon_loss: 9958814.2000; val_masked_gp_l1_reg_loss: 53214.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67215.6641; val_chrom_access_recon_loss: 2203474.2417; val_global_loss: 14991874.6667; val_optim_loss: 14991874.6667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9718; val_auprc_score: 0.9623; val_best_acc_score: 0.9248; val_best_f1_score: 0.9268; train_kl_reg_loss: 44348.8630; train_edge_recon_loss: 2660091.5019; train_gene_expr_recon_loss: 9934191.2214; train_masked_gp_l1_reg_loss: 52975.7156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67001.0345; train_chrom_access_recon_loss: 2190524.6813; train_global_loss: 14949133.0458; train_optim_loss: 14949133.0458; val_kl_reg_loss: 40598.7560; val_edge_recon_loss: 2669290.1500; val_gene_expr_recon_loss: 9959329.4000; val_masked_gp_l1_reg_loss: 52709.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67056.0000; val_chrom_access_recon_loss: 2210331.0500; val_global_loss: 14999315.2000; val_optim_loss: 14999315.2000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9718; val_auprc_score: 0.9631; val_best_acc_score: 0.9260; val_best_f1_score: 0.9287; train_kl_reg_loss: 43509.6100; train_edge_recon_loss: 2661625.3187; train_gene_expr_recon_loss: 9934121.7481; train_masked_gp_l1_reg_loss: 52509.7504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66960.6167; train_chrom_access_recon_loss: 2189489.9427; train_global_loss: 14948217.0840; train_optim_loss: 14948217.0840; val_kl_reg_loss: 39997.0667; val_edge_recon_loss: 2652779.0333; val_gene_expr_recon_loss: 9949081.6000; val_masked_gp_l1_reg_loss: 52232.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66930.5938; val_chrom_access_recon_loss: 2197866.0583; val_global_loss: 14958887.7333; val_optim_loss: 14958887.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9724; val_auprc_score: 0.9646; val_best_acc_score: 0.9276; val_best_f1_score: 0.9293; train_kl_reg_loss: 44170.8814; train_edge_recon_loss: 2667205.3740; train_gene_expr_recon_loss: 9919539.1908; train_masked_gp_l1_reg_loss: 51844.1265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56457.6540; train_chrom_access_recon_loss: 2185806.8655; train_global_loss: 14925024.0916; train_optim_loss: 14925024.0916; val_kl_reg_loss: 40645.0763; val_edge_recon_loss: 2668006.7167; val_gene_expr_recon_loss: 9878150.9333; val_masked_gp_l1_reg_loss: 51722.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54984.1367; val_chrom_access_recon_loss: 2182481.5750; val_global_loss: 14875990.4667; val_optim_loss: 14875990.4667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9733; val_auprc_score: 0.9635; val_best_acc_score: 0.9266; val_best_f1_score: 0.9291; train_kl_reg_loss: 45398.9160; train_edge_recon_loss: 2655150.8282; train_gene_expr_recon_loss: 9913869.4351; train_masked_gp_l1_reg_loss: 51679.2132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54656.6639; train_chrom_access_recon_loss: 2185472.4504; train_global_loss: 14906227.6107; train_optim_loss: 14906227.6107; val_kl_reg_loss: 41410.5581; val_edge_recon_loss: 2655446.8000; val_gene_expr_recon_loss: 9897853.3333; val_masked_gp_l1_reg_loss: 51633.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54317.2812; val_chrom_access_recon_loss: 2189982.7667; val_global_loss: 14890643.5333; val_optim_loss: 14890643.5333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9736; val_auprc_score: 0.9654; val_best_acc_score: 0.9268; val_best_f1_score: 0.9293; train_kl_reg_loss: 46016.2684; train_edge_recon_loss: 2656080.5553; train_gene_expr_recon_loss: 9900849.4275; train_masked_gp_l1_reg_loss: 51608.0123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54085.6411; train_chrom_access_recon_loss: 2183265.0973; train_global_loss: 14891905.0763; train_optim_loss: 14891905.0763; val_kl_reg_loss: 42240.7302; val_edge_recon_loss: 2661000.2500; val_gene_expr_recon_loss: 9889147.2000; val_masked_gp_l1_reg_loss: 51576.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53830.2070; val_chrom_access_recon_loss: 2183520.0167; val_global_loss: 14881314.9333; val_optim_loss: 14881314.9333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9674; val_auprc_score: 0.9517; val_best_acc_score: 0.9223; val_best_f1_score: 0.9250; train_kl_reg_loss: 46372.4871; train_edge_recon_loss: 2653721.7328; train_gene_expr_recon_loss: 9896363.9695; train_masked_gp_l1_reg_loss: 51542.7297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53689.1942; train_chrom_access_recon_loss: 2181381.6899; train_global_loss: 14883071.9008; train_optim_loss: 14883071.9008; val_kl_reg_loss: 42400.2521; val_edge_recon_loss: 2667354.5500; val_gene_expr_recon_loss: 9862932.8667; val_masked_gp_l1_reg_loss: 51503.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53475.5000; val_chrom_access_recon_loss: 2184655.1667; val_global_loss: 14862321.2667; val_optim_loss: 14862321.2667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9713; val_auprc_score: 0.9598; val_best_acc_score: 0.9279; val_best_f1_score: 0.9302; train_kl_reg_loss: 47047.1989; train_edge_recon_loss: 2659846.9141; train_gene_expr_recon_loss: 9905359.0153; train_masked_gp_l1_reg_loss: 51473.5142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53350.1010; train_chrom_access_recon_loss: 2183861.0716; train_global_loss: 14900937.8397; train_optim_loss: 14900937.8397; val_kl_reg_loss: 43078.1323; val_edge_recon_loss: 2656997.0000; val_gene_expr_recon_loss: 9893174.5333; val_masked_gp_l1_reg_loss: 51440.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53175.6641; val_chrom_access_recon_loss: 2198134.7500; val_global_loss: 14896001.4000; val_optim_loss: 14896001.4000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9727; val_auprc_score: 0.9611; val_best_acc_score: 0.9244; val_best_f1_score: 0.9263; train_kl_reg_loss: 46909.4126; train_edge_recon_loss: 2655926.2863; train_gene_expr_recon_loss: 9906301.7176; train_masked_gp_l1_reg_loss: 51404.1086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53045.6995; train_chrom_access_recon_loss: 2185499.1040; train_global_loss: 14899086.3969; train_optim_loss: 14899086.3969; val_kl_reg_loss: 43727.3438; val_edge_recon_loss: 2665575.7500; val_gene_expr_recon_loss: 9892156.6667; val_masked_gp_l1_reg_loss: 51369.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52872.3828; val_chrom_access_recon_loss: 2187870.5833; val_global_loss: 14893572.4667; val_optim_loss: 14893572.4667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9737; val_auprc_score: 0.9656; val_best_acc_score: 0.9290; val_best_f1_score: 0.9312; train_kl_reg_loss: 46900.3585; train_edge_recon_loss: 2660068.0267; train_gene_expr_recon_loss: 9909221.8931; train_masked_gp_l1_reg_loss: 51335.1976; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52777.7084; train_chrom_access_recon_loss: 2185130.4332; train_global_loss: 14905433.5954; train_optim_loss: 14905433.5954; val_kl_reg_loss: 42981.1268; val_edge_recon_loss: 2655491.6167; val_gene_expr_recon_loss: 9905961.0000; val_masked_gp_l1_reg_loss: 51300.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52607.3867; val_chrom_access_recon_loss: 2193800.6167; val_global_loss: 14902142.4000; val_optim_loss: 14902142.4000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9754; val_auprc_score: 0.9662; val_best_acc_score: 0.9332; val_best_f1_score: 0.9353; train_kl_reg_loss: 46359.8985; train_edge_recon_loss: 2657743.3626; train_gene_expr_recon_loss: 9894273.4733; train_masked_gp_l1_reg_loss: 51272.1240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52508.5741; train_chrom_access_recon_loss: 2182455.2805; train_global_loss: 14884612.7481; train_optim_loss: 14884612.7481; val_kl_reg_loss: 42525.2872; val_edge_recon_loss: 2650198.7667; val_gene_expr_recon_loss: 9906490.0667; val_masked_gp_l1_reg_loss: 51253.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52374.3438; val_chrom_access_recon_loss: 2189157.9000; val_global_loss: 14891999.0667; val_optim_loss: 14891999.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9724; val_auprc_score: 0.9618; val_best_acc_score: 0.9281; val_best_f1_score: 0.9306; train_kl_reg_loss: 46212.0350; train_edge_recon_loss: 2655021.8168; train_gene_expr_recon_loss: 9886843.0382; train_masked_gp_l1_reg_loss: 51211.0439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51314.0268; train_chrom_access_recon_loss: 2179014.0754; train_global_loss: 14869616.0992; train_optim_loss: 14869616.0992; val_kl_reg_loss: 42795.7586; val_edge_recon_loss: 2670587.3500; val_gene_expr_recon_loss: 9881442.0000; val_masked_gp_l1_reg_loss: 51195.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51180.9531; val_chrom_access_recon_loss: 2189582.8167; val_global_loss: 14886783.8667; val_optim_loss: 14886783.8667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9717; val_auprc_score: 0.9615; val_best_acc_score: 0.9276; val_best_f1_score: 0.9296; train_kl_reg_loss: 46302.2638; train_edge_recon_loss: 2658709.4198; train_gene_expr_recon_loss: 9893668.5344; train_masked_gp_l1_reg_loss: 51188.1628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51144.0333; train_chrom_access_recon_loss: 2182671.5019; train_global_loss: 14883683.8931; train_optim_loss: 14883683.8931; val_kl_reg_loss: 42622.5641; val_edge_recon_loss: 2670530.3167; val_gene_expr_recon_loss: 9823569.0000; val_masked_gp_l1_reg_loss: 51182.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51113.0664; val_chrom_access_recon_loss: 2176022.5417; val_global_loss: 14815040.4000; val_optim_loss: 14815040.4000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9707; val_auprc_score: 0.9603; val_best_acc_score: 0.9247; val_best_f1_score: 0.9270; train_kl_reg_loss: 46347.4638; train_edge_recon_loss: 2653209.8302; train_gene_expr_recon_loss: 9895534.0076; train_masked_gp_l1_reg_loss: 51176.8924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51085.9326; train_chrom_access_recon_loss: 2182265.3082; train_global_loss: 14879619.3435; train_optim_loss: 14879619.3435; val_kl_reg_loss: 42982.5464; val_edge_recon_loss: 2670071.8667; val_gene_expr_recon_loss: 9888586.3333; val_masked_gp_l1_reg_loss: 51173.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51060.0352; val_chrom_access_recon_loss: 2197975.2333; val_global_loss: 14901849.1333; val_optim_loss: 14901849.1333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9727; val_auprc_score: 0.9646; val_best_acc_score: 0.9272; val_best_f1_score: 0.9290; train_kl_reg_loss: 46457.5895; train_edge_recon_loss: 2650698.5706; train_gene_expr_recon_loss: 9900123.0229; train_masked_gp_l1_reg_loss: 51169.2916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51038.9093; train_chrom_access_recon_loss: 2182647.7901; train_global_loss: 14882135.1145; train_optim_loss: 14882135.1145; val_kl_reg_loss: 43065.2312; val_edge_recon_loss: 2697314.2000; val_gene_expr_recon_loss: 9911928.8000; val_masked_gp_l1_reg_loss: 51165.8008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51018.3867; val_chrom_access_recon_loss: 2189701.0167; val_global_loss: 14944193.2667; val_optim_loss: 14944193.2667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9703; val_auprc_score: 0.9612; val_best_acc_score: 0.9217; val_best_f1_score: 0.9246; train_kl_reg_loss: 46444.4915; train_edge_recon_loss: 2660801.6603; train_gene_expr_recon_loss: 9897468.4351; train_masked_gp_l1_reg_loss: 51161.4774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50997.0622; train_chrom_access_recon_loss: 2183215.6698; train_global_loss: 14890088.8397; train_optim_loss: 14890088.8397; val_kl_reg_loss: 42925.7169; val_edge_recon_loss: 2673001.8667; val_gene_expr_recon_loss: 9855765.8000; val_masked_gp_l1_reg_loss: 51158.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50970.9766; val_chrom_access_recon_loss: 2182736.7583; val_global_loss: 14856559.1333; val_optim_loss: 14856559.1333
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9730; val_auprc_score: 0.9646; val_best_acc_score: 0.9276; val_best_f1_score: 0.9294; train_kl_reg_loss: 46486.3626; train_edge_recon_loss: 2652466.1317; train_gene_expr_recon_loss: 9903589.0000; train_masked_gp_l1_reg_loss: 51155.7971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50956.0339; train_chrom_access_recon_loss: 2182720.3282; train_global_loss: 14887373.6412; train_optim_loss: 14887373.6412; val_kl_reg_loss: 42932.4958; val_edge_recon_loss: 2653633.0333; val_gene_expr_recon_loss: 9907083.9333; val_masked_gp_l1_reg_loss: 51152.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50939.5664; val_chrom_access_recon_loss: 2200155.9833; val_global_loss: 14905897.3333; val_optim_loss: 14905897.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9731; val_auprc_score: 0.9636; val_best_acc_score: 0.9275; val_best_f1_score: 0.9294; train_kl_reg_loss: 46623.4660; train_edge_recon_loss: 2651514.0019; train_gene_expr_recon_loss: 9904729.9466; train_masked_gp_l1_reg_loss: 51147.9032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50830.6548; train_chrom_access_recon_loss: 2182952.6527; train_global_loss: 14887798.6107; train_optim_loss: 14887798.6107; val_kl_reg_loss: 43420.7232; val_edge_recon_loss: 2671647.1667; val_gene_expr_recon_loss: 9940481.7333; val_masked_gp_l1_reg_loss: 51146.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50817.6445; val_chrom_access_recon_loss: 2197453.1000; val_global_loss: 14954966.6667; val_optim_loss: 14954966.6667
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9754; val_auprc_score: 0.9666; val_best_acc_score: 0.9293; val_best_f1_score: 0.9310; train_kl_reg_loss: 46520.2222; train_edge_recon_loss: 2656849.4714; train_gene_expr_recon_loss: 9907709.5802; train_masked_gp_l1_reg_loss: 51145.5597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50814.3594; train_chrom_access_recon_loss: 2185216.8521; train_global_loss: 14898256.0305; train_optim_loss: 14898256.0305; val_kl_reg_loss: 42893.7214; val_edge_recon_loss: 2672453.6000; val_gene_expr_recon_loss: 9888353.4667; val_masked_gp_l1_reg_loss: 51144.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50811.2188; val_chrom_access_recon_loss: 2190749.8000; val_global_loss: 14896406.6000; val_optim_loss: 14896406.6000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9719; val_auprc_score: 0.9637; val_best_acc_score: 0.9248; val_best_f1_score: 0.9275; train_kl_reg_loss: 46592.1401; train_edge_recon_loss: 2649360.5038; train_gene_expr_recon_loss: 9899833.8244; train_masked_gp_l1_reg_loss: 51144.3575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50808.5375; train_chrom_access_recon_loss: 2184294.5363; train_global_loss: 14882034.0076; train_optim_loss: 14882034.0076; val_kl_reg_loss: 42942.7951; val_edge_recon_loss: 2661467.2667; val_gene_expr_recon_loss: 9901621.1333; val_masked_gp_l1_reg_loss: 51143.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50805.9375; val_chrom_access_recon_loss: 2197316.7083; val_global_loss: 14905298.0667; val_optim_loss: 14905298.0667
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9726; val_auprc_score: 0.9624; val_best_acc_score: 0.9263; val_best_f1_score: 0.9288; train_kl_reg_loss: 46693.3839; train_edge_recon_loss: 2656845.1279; train_gene_expr_recon_loss: 9906596.9008; train_masked_gp_l1_reg_loss: 51143.3276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50803.5436; train_chrom_access_recon_loss: 2186170.5496; train_global_loss: 14898252.8015; train_optim_loss: 14898252.8015; val_kl_reg_loss: 43151.8966; val_edge_recon_loss: 2672974.4333; val_gene_expr_recon_loss: 9906261.1333; val_masked_gp_l1_reg_loss: 51142.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50800.8633; val_chrom_access_recon_loss: 2204631.0667; val_global_loss: 14928962.3333; val_optim_loss: 14928962.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 58 min 5 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9735
val AUPRC score: 0.9658
val best accuracy score: 0.9289
val best F1 score: 0.9313
val target rna MSE score: 1.8284
val source rna MSE score: 0.5768
val target atac MSE score: 0.4988
val source atac MSE score: 0.1544
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
