[True]
Run timestamp: 26072023_034854_137.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_137']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9659; val_auprc_score: 0.9674; val_best_acc_score: 0.8968; val_best_f1_score: 0.8991; train_kl_reg_loss: 1672.7319; train_edge_recon_loss: 34666697.7778; train_gene_expr_recon_loss: 3129489.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10801893.1111; train_global_loss: 48599752.4444; train_optim_loss: 48599752.4444; val_kl_reg_loss: 1725.0176; val_edge_recon_loss: 40430160.0000; val_gene_expr_recon_loss: 3106865.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10878678.0000; val_global_loss: 54417424.0000; val_optim_loss: 54417424.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9366; val_auprc_score: 0.9320; val_best_acc_score: 0.8288; val_best_f1_score: 0.8492; train_kl_reg_loss: 1461.6362; train_edge_recon_loss: 34640722.2222; train_gene_expr_recon_loss: 3064747.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10755829.7778; train_global_loss: 48462761.3333; train_optim_loss: 48462761.3333; val_kl_reg_loss: 1267.6587; val_edge_recon_loss: 38865432.0000; val_gene_expr_recon_loss: 3016064.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10804886.0000; val_global_loss: 52687648.0000; val_optim_loss: 52687648.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8669; val_auprc_score: 0.8600; val_best_acc_score: 0.7610; val_best_f1_score: 0.7907; train_kl_reg_loss: 1876.4232; train_edge_recon_loss: 33438151.7778; train_gene_expr_recon_loss: 2950864.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10656094.7778; train_global_loss: 47046988.4444; train_optim_loss: 47046988.4444; val_kl_reg_loss: 4673.4277; val_edge_recon_loss: 30385908.0000; val_gene_expr_recon_loss: 2920586.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10748409.0000; val_global_loss: 44059576.0000; val_optim_loss: 44059576.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8798; val_auprc_score: 0.8743; val_best_acc_score: 0.7843; val_best_f1_score: 0.7932; train_kl_reg_loss: 14774.7137; train_edge_recon_loss: 29271577.5556; train_gene_expr_recon_loss: 2950159.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10674420.8889; train_global_loss: 42910932.8889; train_optim_loss: 42910932.8889; val_kl_reg_loss: 32086.1191; val_edge_recon_loss: 28600646.0000; val_gene_expr_recon_loss: 2914638.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10700009.0000; val_global_loss: 42247380.0000; val_optim_loss: 42247380.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8896; val_auprc_score: 0.8757; val_best_acc_score: 0.8032; val_best_f1_score: 0.8066; train_kl_reg_loss: 48599.5534; train_edge_recon_loss: 28457270.4444; train_gene_expr_recon_loss: 2835840.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10563899.2222; train_global_loss: 41905609.3333; train_optim_loss: 41905609.3333; val_kl_reg_loss: 64447.4922; val_edge_recon_loss: 28487680.0000; val_gene_expr_recon_loss: 2757669.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10524325.0000; val_global_loss: 41834124.0000; val_optim_loss: 41834124.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8890; val_auprc_score: 0.8657; val_best_acc_score: 0.8042; val_best_f1_score: 0.8189; train_kl_reg_loss: 73209.4097; train_edge_recon_loss: 28203854.6667; train_gene_expr_recon_loss: 2708057.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10434377.6667; train_global_loss: 41419499.1111; train_optim_loss: 41419499.1111; val_kl_reg_loss: 80475.1172; val_edge_recon_loss: 28037128.0000; val_gene_expr_recon_loss: 2655325.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10443283.0000; val_global_loss: 41216212.0000; val_optim_loss: 41216212.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9082; val_auprc_score: 0.8826; val_best_acc_score: 0.8325; val_best_f1_score: 0.8448; train_kl_reg_loss: 86982.1953; train_edge_recon_loss: 27851116.8889; train_gene_expr_recon_loss: 2623781.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10317534.8889; train_global_loss: 40879414.2222; train_optim_loss: 40879414.2222; val_kl_reg_loss: 90742.5156; val_edge_recon_loss: 27673706.0000; val_gene_expr_recon_loss: 2599912.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10388299.0000; val_global_loss: 40752660.0000; val_optim_loss: 40752660.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9161; val_auprc_score: 0.8894; val_best_acc_score: 0.8537; val_best_f1_score: 0.8640; train_kl_reg_loss: 97577.6875; train_edge_recon_loss: 27499146.0000; train_gene_expr_recon_loss: 2578667.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10292253.5556; train_global_loss: 40467645.3333; train_optim_loss: 40467645.3333; val_kl_reg_loss: 101366.7188; val_edge_recon_loss: 27497370.0000; val_gene_expr_recon_loss: 2549861.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10324456.0000; val_global_loss: 40473056.0000; val_optim_loss: 40473056.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9225; val_auprc_score: 0.8951; val_best_acc_score: 0.8605; val_best_f1_score: 0.8684; train_kl_reg_loss: 107367.9583; train_edge_recon_loss: 27204705.3333; train_gene_expr_recon_loss: 2517856.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10244404.0000; train_global_loss: 40074334.2222; train_optim_loss: 40074334.2222; val_kl_reg_loss: 109639.6250; val_edge_recon_loss: 27488300.0000; val_gene_expr_recon_loss: 2512346.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10292357.0000; val_global_loss: 40402644.0000; val_optim_loss: 40402644.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9308; val_auprc_score: 0.9087; val_best_acc_score: 0.8705; val_best_f1_score: 0.8789; train_kl_reg_loss: 110567.8811; train_edge_recon_loss: 27266405.5556; train_gene_expr_recon_loss: 2479556.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10176802.2222; train_global_loss: 40033333.7778; train_optim_loss: 40033333.7778; val_kl_reg_loss: 110470.3906; val_edge_recon_loss: 27192310.0000; val_gene_expr_recon_loss: 2481982.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10205883.0000; val_global_loss: 39990644.0000; val_optim_loss: 39990644.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9284; val_auprc_score: 0.9057; val_best_acc_score: 0.8665; val_best_f1_score: 0.8752; train_kl_reg_loss: 114527.2083; train_edge_recon_loss: 27199345.7778; train_gene_expr_recon_loss: 2453825.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10145258.5556; train_global_loss: 39912956.4444; train_optim_loss: 39912956.4444; val_kl_reg_loss: 114267.9375; val_edge_recon_loss: 27480862.0000; val_gene_expr_recon_loss: 2466305.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10183108.0000; val_global_loss: 40244544.0000; val_optim_loss: 40244544.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9304; val_auprc_score: 0.9059; val_best_acc_score: 0.8742; val_best_f1_score: 0.8817; train_kl_reg_loss: 115138.3455; train_edge_recon_loss: 27131644.6667; train_gene_expr_recon_loss: 2449825.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10111967.1111; train_global_loss: 39808576.0000; train_optim_loss: 39808576.0000; val_kl_reg_loss: 110987.1875; val_edge_recon_loss: 27239576.0000; val_gene_expr_recon_loss: 2449621.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10165559.0000; val_global_loss: 39965744.0000; val_optim_loss: 39965744.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9296; val_auprc_score: 0.9067; val_best_acc_score: 0.8739; val_best_f1_score: 0.8825; train_kl_reg_loss: 114583.4618; train_edge_recon_loss: 27109860.0000; train_gene_expr_recon_loss: 2408515.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10057795.6667; train_global_loss: 39690755.5556; train_optim_loss: 39690755.5556; val_kl_reg_loss: 114766.1562; val_edge_recon_loss: 27343466.0000; val_gene_expr_recon_loss: 2406617.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10124170.0000; val_global_loss: 39989016.0000; val_optim_loss: 39989016.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9348; val_auprc_score: 0.9126; val_best_acc_score: 0.8758; val_best_f1_score: 0.8832; train_kl_reg_loss: 120455.9601; train_edge_recon_loss: 27137210.2222; train_gene_expr_recon_loss: 2367366.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9974812.4444; train_global_loss: 39599844.0000; train_optim_loss: 39599844.0000; val_kl_reg_loss: 123019.1172; val_edge_recon_loss: 27273494.0000; val_gene_expr_recon_loss: 2380944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10093211.0000; val_global_loss: 39870668.0000; val_optim_loss: 39870668.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9364; val_auprc_score: 0.9134; val_best_acc_score: 0.8802; val_best_f1_score: 0.8873; train_kl_reg_loss: 129347.3377; train_edge_recon_loss: 27100290.4444; train_gene_expr_recon_loss: 2355715.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9959040.0000; train_global_loss: 39544393.7778; train_optim_loss: 39544393.7778; val_kl_reg_loss: 131627.1094; val_edge_recon_loss: 27125188.0000; val_gene_expr_recon_loss: 2342187.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10060222.0000; val_global_loss: 39659224.0000; val_optim_loss: 39659224.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9367; val_auprc_score: 0.9125; val_best_acc_score: 0.8770; val_best_f1_score: 0.8857; train_kl_reg_loss: 137251.9306; train_edge_recon_loss: 27106311.1111; train_gene_expr_recon_loss: 2320513.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9914728.5556; train_global_loss: 39478804.4444; train_optim_loss: 39478804.4444; val_kl_reg_loss: 138013.9531; val_edge_recon_loss: 27082870.0000; val_gene_expr_recon_loss: 2340338.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10045505.0000; val_global_loss: 39606728.0000; val_optim_loss: 39606728.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9364; val_auprc_score: 0.9124; val_best_acc_score: 0.8801; val_best_f1_score: 0.8876; train_kl_reg_loss: 140920.9653; train_edge_recon_loss: 27002790.8889; train_gene_expr_recon_loss: 2288485.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9956316.2222; train_global_loss: 39388513.7778; train_optim_loss: 39388513.7778; val_kl_reg_loss: 139613.1875; val_edge_recon_loss: 27080902.0000; val_gene_expr_recon_loss: 2329384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10012075.0000; val_global_loss: 39561976.0000; val_optim_loss: 39561976.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9421; val_auprc_score: 0.9216; val_best_acc_score: 0.8882; val_best_f1_score: 0.8944; train_kl_reg_loss: 143237.7413; train_edge_recon_loss: 26962178.4444; train_gene_expr_recon_loss: 2315300.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9987327.3333; train_global_loss: 39408044.0000; train_optim_loss: 39408044.0000; val_kl_reg_loss: 138643.0938; val_edge_recon_loss: 27127584.0000; val_gene_expr_recon_loss: 2300980.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9986509.0000; val_global_loss: 39553716.0000; val_optim_loss: 39553716.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9500; val_auprc_score: 0.9329; val_best_acc_score: 0.8934; val_best_f1_score: 0.9001; train_kl_reg_loss: 139546.5938; train_edge_recon_loss: 26998837.3333; train_gene_expr_recon_loss: 2275611.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9840739.6667; train_global_loss: 39254735.1111; train_optim_loss: 39254735.1111; val_kl_reg_loss: 136242.1562; val_edge_recon_loss: 26895070.0000; val_gene_expr_recon_loss: 2280736.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9963623.0000; val_global_loss: 39275672.0000; val_optim_loss: 39275672.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9488; val_auprc_score: 0.9262; val_best_acc_score: 0.8967; val_best_f1_score: 0.9028; train_kl_reg_loss: 138535.3281; train_edge_recon_loss: 26900068.4444; train_gene_expr_recon_loss: 2262228.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9835103.7778; train_global_loss: 39135936.0000; train_optim_loss: 39135936.0000; val_kl_reg_loss: 136523.6406; val_edge_recon_loss: 26855064.0000; val_gene_expr_recon_loss: 2280405.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9961912.0000; val_global_loss: 39233904.0000; val_optim_loss: 39233904.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9510; val_auprc_score: 0.9321; val_best_acc_score: 0.8965; val_best_f1_score: 0.9016; train_kl_reg_loss: 137066.4080; train_edge_recon_loss: 26787943.5556; train_gene_expr_recon_loss: 2253773.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9820975.1111; train_global_loss: 38999757.7778; train_optim_loss: 38999757.7778; val_kl_reg_loss: 136009.8281; val_edge_recon_loss: 27001380.0000; val_gene_expr_recon_loss: 2269783.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9940961.0000; val_global_loss: 39348136.0000; val_optim_loss: 39348136.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9455; val_auprc_score: 0.9231; val_best_acc_score: 0.8911; val_best_f1_score: 0.8976; train_kl_reg_loss: 139224.6858; train_edge_recon_loss: 26685107.5556; train_gene_expr_recon_loss: 2250205.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9797503.2222; train_global_loss: 38872041.3333; train_optim_loss: 38872041.3333; val_kl_reg_loss: 140802.0625; val_edge_recon_loss: 27046152.0000; val_gene_expr_recon_loss: 2265109.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9929909.0000; val_global_loss: 39381972.0000; val_optim_loss: 39381972.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9544; val_auprc_score: 0.9372; val_best_acc_score: 0.9016; val_best_f1_score: 0.9055; train_kl_reg_loss: 144904.2274; train_edge_recon_loss: 26595518.6667; train_gene_expr_recon_loss: 2247618.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9819890.6667; train_global_loss: 38807932.8889; train_optim_loss: 38807932.8889; val_kl_reg_loss: 142669.7500; val_edge_recon_loss: 26689058.0000; val_gene_expr_recon_loss: 2242386.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9876712.0000; val_global_loss: 38950824.0000; val_optim_loss: 38950824.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9582; val_auprc_score: 0.9431; val_best_acc_score: 0.9035; val_best_f1_score: 0.9087; train_kl_reg_loss: 147595.7188; train_edge_recon_loss: 26643543.7778; train_gene_expr_recon_loss: 2232725.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9803748.8889; train_global_loss: 38827614.6667; train_optim_loss: 38827614.6667; val_kl_reg_loss: 148697.7031; val_edge_recon_loss: 26852030.0000; val_gene_expr_recon_loss: 2259138.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9886286.0000; val_global_loss: 39146152.0000; val_optim_loss: 39146152.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9565; val_auprc_score: 0.9419; val_best_acc_score: 0.9034; val_best_f1_score: 0.9081; train_kl_reg_loss: 148137.0955; train_edge_recon_loss: 26615981.5556; train_gene_expr_recon_loss: 2236665.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9760549.8889; train_global_loss: 38761334.2222; train_optim_loss: 38761334.2222; val_kl_reg_loss: 146036.7812; val_edge_recon_loss: 26772540.0000; val_gene_expr_recon_loss: 2238737.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9871994.0000; val_global_loss: 39029308.0000; val_optim_loss: 39029308.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9624; val_auprc_score: 0.9494; val_best_acc_score: 0.9116; val_best_f1_score: 0.9153; train_kl_reg_loss: 149858.4722; train_edge_recon_loss: 26673038.2222; train_gene_expr_recon_loss: 2269202.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9813127.1111; train_global_loss: 38905226.6667; train_optim_loss: 38905226.6667; val_kl_reg_loss: 68853.1328; val_edge_recon_loss: 26585808.0000; val_gene_expr_recon_loss: 2309060.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9958744.0000; val_global_loss: 38922464.0000; val_optim_loss: 38922464.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9607; val_auprc_score: 0.9429; val_best_acc_score: 0.9101; val_best_f1_score: 0.9132; train_kl_reg_loss: 159402.5382; train_edge_recon_loss: 26679176.8889; train_gene_expr_recon_loss: 2268157.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9821299.1111; train_global_loss: 38928036.0000; train_optim_loss: 38928036.0000; val_kl_reg_loss: 71806.5078; val_edge_recon_loss: 26566570.0000; val_gene_expr_recon_loss: 2268206.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9917952.0000; val_global_loss: 38824536.0000; val_optim_loss: 38824536.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9634; val_auprc_score: 0.9502; val_best_acc_score: 0.9135; val_best_f1_score: 0.9169; train_kl_reg_loss: 168410.7795; train_edge_recon_loss: 26628179.5556; train_gene_expr_recon_loss: 2253971.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9815057.3333; train_global_loss: 38865620.0000; train_optim_loss: 38865620.0000; val_kl_reg_loss: 71933.0938; val_edge_recon_loss: 26692342.0000; val_gene_expr_recon_loss: 2289785.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9920964.0000; val_global_loss: 38975024.0000; val_optim_loss: 38975024.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9595; val_auprc_score: 0.9424; val_best_acc_score: 0.9080; val_best_f1_score: 0.9117; train_kl_reg_loss: 171935.8698; train_edge_recon_loss: 26555988.2222; train_gene_expr_recon_loss: 2255970.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9795956.0000; train_global_loss: 38779850.6667; train_optim_loss: 38779850.6667; val_kl_reg_loss: 71595.2578; val_edge_recon_loss: 26772628.0000; val_gene_expr_recon_loss: 2267401.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9888699.0000; val_global_loss: 39000324.0000; val_optim_loss: 39000324.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9649; val_auprc_score: 0.9506; val_best_acc_score: 0.9165; val_best_f1_score: 0.9192; train_kl_reg_loss: 170811.8351; train_edge_recon_loss: 26562456.6667; train_gene_expr_recon_loss: 2235929.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9770328.0000; train_global_loss: 38739526.2222; train_optim_loss: 38739526.2222; val_kl_reg_loss: 72886.5000; val_edge_recon_loss: 26564350.0000; val_gene_expr_recon_loss: 2259645.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9896129.0000; val_global_loss: 38793012.0000; val_optim_loss: 38793012.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9641; val_auprc_score: 0.9506; val_best_acc_score: 0.9182; val_best_f1_score: 0.9209; train_kl_reg_loss: 168620.7483; train_edge_recon_loss: 26496322.2222; train_gene_expr_recon_loss: 2244335.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9815133.1111; train_global_loss: 38724411.1111; train_optim_loss: 38724411.1111; val_kl_reg_loss: 69301.7031; val_edge_recon_loss: 26589506.0000; val_gene_expr_recon_loss: 2264393.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9884788.0000; val_global_loss: 38807992.0000; val_optim_loss: 38807992.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9670; val_auprc_score: 0.9554; val_best_acc_score: 0.9173; val_best_f1_score: 0.9208; train_kl_reg_loss: 166505.4219; train_edge_recon_loss: 26435561.7778; train_gene_expr_recon_loss: 2246499.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9777001.8889; train_global_loss: 38625568.0000; train_optim_loss: 38625568.0000; val_kl_reg_loss: 67895.2109; val_edge_recon_loss: 26464414.0000; val_gene_expr_recon_loss: 2271915.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9876121.0000; val_global_loss: 38680348.0000; val_optim_loss: 38680348.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9681; val_auprc_score: 0.9554; val_best_acc_score: 0.9167; val_best_f1_score: 0.9205; train_kl_reg_loss: 163258.7188; train_edge_recon_loss: 26456329.3333; train_gene_expr_recon_loss: 2223212.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9734338.3333; train_global_loss: 38577139.1111; train_optim_loss: 38577139.1111; val_kl_reg_loss: 64785.2656; val_edge_recon_loss: 26636884.0000; val_gene_expr_recon_loss: 2261871.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9880898.0000; val_global_loss: 38844440.0000; val_optim_loss: 38844440.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9697; val_auprc_score: 0.9588; val_best_acc_score: 0.9204; val_best_f1_score: 0.9236; train_kl_reg_loss: 159620.5382; train_edge_recon_loss: 26483047.7778; train_gene_expr_recon_loss: 2225066.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9779661.5556; train_global_loss: 38647396.0000; train_optim_loss: 38647396.0000; val_kl_reg_loss: 62467.2344; val_edge_recon_loss: 26380270.0000; val_gene_expr_recon_loss: 2270497.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9882991.0000; val_global_loss: 38596228.0000; val_optim_loss: 38596228.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9692; val_auprc_score: 0.9556; val_best_acc_score: 0.9240; val_best_f1_score: 0.9266; train_kl_reg_loss: 153516.1476; train_edge_recon_loss: 26608256.2222; train_gene_expr_recon_loss: 2225014.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9714635.6667; train_global_loss: 38701421.3333; train_optim_loss: 38701421.3333; val_kl_reg_loss: 63239.8359; val_edge_recon_loss: 26540634.0000; val_gene_expr_recon_loss: 2273137.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9875093.0000; val_global_loss: 38752104.0000; val_optim_loss: 38752104.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9713; val_auprc_score: 0.9606; val_best_acc_score: 0.9243; val_best_f1_score: 0.9266; train_kl_reg_loss: 151958.0243; train_edge_recon_loss: 26420572.2222; train_gene_expr_recon_loss: 2229639.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9770636.1111; train_global_loss: 38572806.6667; train_optim_loss: 38572806.6667; val_kl_reg_loss: 63282.9062; val_edge_recon_loss: 26702568.0000; val_gene_expr_recon_loss: 2259422.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9861140.0000; val_global_loss: 38886412.0000; val_optim_loss: 38886412.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9714; val_auprc_score: 0.9586; val_best_acc_score: 0.9270; val_best_f1_score: 0.9302; train_kl_reg_loss: 151574.3628; train_edge_recon_loss: 26454519.7778; train_gene_expr_recon_loss: 2221444.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9746841.3333; train_global_loss: 38574380.4444; train_optim_loss: 38574380.4444; val_kl_reg_loss: 62946.2031; val_edge_recon_loss: 26406714.0000; val_gene_expr_recon_loss: 2260871.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9860759.0000; val_global_loss: 38591292.0000; val_optim_loss: 38591292.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9688; val_auprc_score: 0.9542; val_best_acc_score: 0.9216; val_best_f1_score: 0.9245; train_kl_reg_loss: 145805.3542; train_edge_recon_loss: 26359860.0000; train_gene_expr_recon_loss: 2234563.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9748989.1111; train_global_loss: 38489217.7778; train_optim_loss: 38489217.7778; val_kl_reg_loss: 60004.2969; val_edge_recon_loss: 26751080.0000; val_gene_expr_recon_loss: 2260569.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9831106.0000; val_global_loss: 38902760.0000; val_optim_loss: 38902760.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9726; val_auprc_score: 0.9642; val_best_acc_score: 0.9267; val_best_f1_score: 0.9288; train_kl_reg_loss: 136415.4097; train_edge_recon_loss: 26515888.0000; train_gene_expr_recon_loss: 2231247.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9730286.8889; train_global_loss: 38613838.2222; train_optim_loss: 38613838.2222; val_kl_reg_loss: 55090.9766; val_edge_recon_loss: 26577086.0000; val_gene_expr_recon_loss: 2276610.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9854492.0000; val_global_loss: 38763280.0000; val_optim_loss: 38763280.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9727; val_auprc_score: 0.9616; val_best_acc_score: 0.9279; val_best_f1_score: 0.9302; train_kl_reg_loss: 128396.0339; train_edge_recon_loss: 26523940.6667; train_gene_expr_recon_loss: 2238002.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9749920.0000; train_global_loss: 38640258.6667; train_optim_loss: 38640258.6667; val_kl_reg_loss: 53563.6602; val_edge_recon_loss: 26607978.0000; val_gene_expr_recon_loss: 2260810.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9848637.0000; val_global_loss: 38770988.0000; val_optim_loss: 38770988.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9754; val_auprc_score: 0.9662; val_best_acc_score: 0.9336; val_best_f1_score: 0.9359; train_kl_reg_loss: 125008.0043; train_edge_recon_loss: 26466248.0000; train_gene_expr_recon_loss: 2227263.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9710127.8889; train_global_loss: 38528647.5556; train_optim_loss: 38528647.5556; val_kl_reg_loss: 51365.0625; val_edge_recon_loss: 26416544.0000; val_gene_expr_recon_loss: 2266237.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9838956.0000; val_global_loss: 38573104.0000; val_optim_loss: 38573104.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9766; val_auprc_score: 0.9693; val_best_acc_score: 0.9301; val_best_f1_score: 0.9321; train_kl_reg_loss: 122903.5660; train_edge_recon_loss: 26405093.3333; train_gene_expr_recon_loss: 2244154.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9736649.6667; train_global_loss: 38508800.8889; train_optim_loss: 38508800.8889; val_kl_reg_loss: 50603.0859; val_edge_recon_loss: 26601226.0000; val_gene_expr_recon_loss: 2273444.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9839698.0000; val_global_loss: 38764972.0000; val_optim_loss: 38764972.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9758; val_auprc_score: 0.9672; val_best_acc_score: 0.9310; val_best_f1_score: 0.9331; train_kl_reg_loss: 120917.0981; train_edge_recon_loss: 26421326.6667; train_gene_expr_recon_loss: 2222003.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9701316.1111; train_global_loss: 38465563.5556; train_optim_loss: 38465563.5556; val_kl_reg_loss: 51458.6328; val_edge_recon_loss: 26468160.0000; val_gene_expr_recon_loss: 2267836.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9824233.0000; val_global_loss: 38611688.0000; val_optim_loss: 38611688.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9767; val_auprc_score: 0.9695; val_best_acc_score: 0.9324; val_best_f1_score: 0.9346; train_kl_reg_loss: 118758.1528; train_edge_recon_loss: 26456472.4444; train_gene_expr_recon_loss: 2216277.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9667869.8889; train_global_loss: 38459377.7778; train_optim_loss: 38459377.7778; val_kl_reg_loss: 50976.6523; val_edge_recon_loss: 26705134.0000; val_gene_expr_recon_loss: 2271649.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9823490.0000; val_global_loss: 38851248.0000; val_optim_loss: 38851248.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9770; val_auprc_score: 0.9666; val_best_acc_score: 0.9394; val_best_f1_score: 0.9407; train_kl_reg_loss: 118541.1927; train_edge_recon_loss: 26445016.2222; train_gene_expr_recon_loss: 2221603.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9674172.4444; train_global_loss: 38459334.2222; train_optim_loss: 38459334.2222; val_kl_reg_loss: 49104.1250; val_edge_recon_loss: 26452240.0000; val_gene_expr_recon_loss: 2285902.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9851584.0000; val_global_loss: 38638832.0000; val_optim_loss: 38638832.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9757; val_auprc_score: 0.9653; val_best_acc_score: 0.9345; val_best_f1_score: 0.9373; train_kl_reg_loss: 118211.1589; train_edge_recon_loss: 26329183.7778; train_gene_expr_recon_loss: 2230099.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9709169.4444; train_global_loss: 38386663.5556; train_optim_loss: 38386663.5556; val_kl_reg_loss: 48024.3516; val_edge_recon_loss: 26618176.0000; val_gene_expr_recon_loss: 2259343.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9804541.0000; val_global_loss: 38730084.0000; val_optim_loss: 38730084.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9765; val_auprc_score: 0.9661; val_best_acc_score: 0.9340; val_best_f1_score: 0.9368; train_kl_reg_loss: 117642.4661; train_edge_recon_loss: 26403504.8889; train_gene_expr_recon_loss: 2237478.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9740363.6667; train_global_loss: 38498989.7778; train_optim_loss: 38498989.7778; val_kl_reg_loss: 48221.5234; val_edge_recon_loss: 26361930.0000; val_gene_expr_recon_loss: 2267395.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9830258.0000; val_global_loss: 38507808.0000; val_optim_loss: 38507808.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9752; val_auprc_score: 0.9634; val_best_acc_score: 0.9309; val_best_f1_score: 0.9328; train_kl_reg_loss: 117393.3819; train_edge_recon_loss: 26341316.8889; train_gene_expr_recon_loss: 2229306.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9690930.7778; train_global_loss: 38378948.0000; train_optim_loss: 38378948.0000; val_kl_reg_loss: 48462.5273; val_edge_recon_loss: 26392984.0000; val_gene_expr_recon_loss: 2270196.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9833981.0000; val_global_loss: 38545624.0000; val_optim_loss: 38545624.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9765; val_auprc_score: 0.9659; val_best_acc_score: 0.9361; val_best_f1_score: 0.9381; train_kl_reg_loss: 117068.2240; train_edge_recon_loss: 26348693.5556; train_gene_expr_recon_loss: 2232634.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9720508.7778; train_global_loss: 38418904.0000; train_optim_loss: 38418904.0000; val_kl_reg_loss: 47927.4141; val_edge_recon_loss: 26445040.0000; val_gene_expr_recon_loss: 2264300.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9822817.0000; val_global_loss: 38580084.0000; val_optim_loss: 38580084.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9770; val_auprc_score: 0.9669; val_best_acc_score: 0.9348; val_best_f1_score: 0.9370; train_kl_reg_loss: 116650.9470; train_edge_recon_loss: 26389067.7778; train_gene_expr_recon_loss: 2233830.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9745501.3333; train_global_loss: 38485050.6667; train_optim_loss: 38485050.6667; val_kl_reg_loss: 47905.0273; val_edge_recon_loss: 26287464.0000; val_gene_expr_recon_loss: 2268786.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9816125.0000; val_global_loss: 38420280.0000; val_optim_loss: 38420280.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9789; val_auprc_score: 0.9687; val_best_acc_score: 0.9357; val_best_f1_score: 0.9373; train_kl_reg_loss: 116238.0495; train_edge_recon_loss: 26278479.3333; train_gene_expr_recon_loss: 2227623.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9663358.1111; train_global_loss: 38285698.6667; train_optim_loss: 38285698.6667; val_kl_reg_loss: 47558.9922; val_edge_recon_loss: 26555628.0000; val_gene_expr_recon_loss: 2263226.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9818351.0000; val_global_loss: 38684764.0000; val_optim_loss: 38684764.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9764; val_auprc_score: 0.9669; val_best_acc_score: 0.9334; val_best_f1_score: 0.9360; train_kl_reg_loss: 115723.3819; train_edge_recon_loss: 26319140.2222; train_gene_expr_recon_loss: 2230327.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9690491.8889; train_global_loss: 38355684.0000; train_optim_loss: 38355684.0000; val_kl_reg_loss: 46556.5000; val_edge_recon_loss: 26505036.0000; val_gene_expr_recon_loss: 2266721.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9816513.0000; val_global_loss: 38634828.0000; val_optim_loss: 38634828.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9757; val_auprc_score: 0.9643; val_best_acc_score: 0.9349; val_best_f1_score: 0.9373; train_kl_reg_loss: 116696.0156; train_edge_recon_loss: 26362305.7778; train_gene_expr_recon_loss: 2245970.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9719649.7778; train_global_loss: 38444622.6667; train_optim_loss: 38444622.6667; val_kl_reg_loss: 46935.0078; val_edge_recon_loss: 26325806.0000; val_gene_expr_recon_loss: 2264157.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9804946.0000; val_global_loss: 38441848.0000; val_optim_loss: 38441848.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9750; val_auprc_score: 0.9663; val_best_acc_score: 0.9310; val_best_f1_score: 0.9335; train_kl_reg_loss: 115550.4800; train_edge_recon_loss: 26399246.4444; train_gene_expr_recon_loss: 2227615.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9725538.1111; train_global_loss: 38467952.0000; train_optim_loss: 38467952.0000; val_kl_reg_loss: 46616.2500; val_edge_recon_loss: 26729592.0000; val_gene_expr_recon_loss: 2267607.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9828085.0000; val_global_loss: 38871900.0000; val_optim_loss: 38871900.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9774; val_auprc_score: 0.9697; val_best_acc_score: 0.9345; val_best_f1_score: 0.9361; train_kl_reg_loss: 115654.6675; train_edge_recon_loss: 26372510.6667; train_gene_expr_recon_loss: 2222061.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9668986.6667; train_global_loss: 38379213.3333; train_optim_loss: 38379213.3333; val_kl_reg_loss: 46683.4141; val_edge_recon_loss: 26524756.0000; val_gene_expr_recon_loss: 2267863.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9819719.0000; val_global_loss: 38659024.0000; val_optim_loss: 38659024.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9744; val_auprc_score: 0.9619; val_best_acc_score: 0.9318; val_best_f1_score: 0.9337; train_kl_reg_loss: 115192.5538; train_edge_recon_loss: 26253332.2222; train_gene_expr_recon_loss: 2230945.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9676659.8889; train_global_loss: 38276130.2222; train_optim_loss: 38276130.2222; val_kl_reg_loss: 46716.4766; val_edge_recon_loss: 26645822.0000; val_gene_expr_recon_loss: 2268694.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9818307.0000; val_global_loss: 38779540.0000; val_optim_loss: 38779540.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9771; val_auprc_score: 0.9673; val_best_acc_score: 0.9347; val_best_f1_score: 0.9367; train_kl_reg_loss: 115031.9531; train_edge_recon_loss: 26335911.1111; train_gene_expr_recon_loss: 2216957.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9660813.0000; train_global_loss: 38328714.2222; train_optim_loss: 38328714.2222; val_kl_reg_loss: 46638.3984; val_edge_recon_loss: 26473504.0000; val_gene_expr_recon_loss: 2268154.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9816265.0000; val_global_loss: 38604560.0000; val_optim_loss: 38604560.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9760; val_auprc_score: 0.9607; val_best_acc_score: 0.9364; val_best_f1_score: 0.9384; train_kl_reg_loss: 115897.0990; train_edge_recon_loss: 26325620.0000; train_gene_expr_recon_loss: 2237501.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9695968.0000; train_global_loss: 38374986.6667; train_optim_loss: 38374986.6667; val_kl_reg_loss: 46239.2734; val_edge_recon_loss: 26522968.0000; val_gene_expr_recon_loss: 2268869.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9815586.0000; val_global_loss: 38653664.0000; val_optim_loss: 38653664.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 43 sec.
Using best model state, which was in epoch 50.

--- MODEL EVALUATION ---
Val AUROC score: 0.9740
Val AUPRC score: 0.9646
Val best accuracy score: 0.9297
Val best F1 score: 0.9322
Val gene expr MSE score: 0.5903
Val chrom access MSE score: 0.0892
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
