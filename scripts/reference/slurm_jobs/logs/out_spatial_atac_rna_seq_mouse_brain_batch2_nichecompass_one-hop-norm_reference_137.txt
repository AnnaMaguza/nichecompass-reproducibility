[True]
Run timestamp: 10102023_041000_137.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_137']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7507; val_auprc_score: 0.7732; val_best_acc_score: 0.5847; val_best_f1_score: 0.6983; train_kl_reg_loss: 61053.0633; train_edge_recon_loss: 3501425.4313; train_gene_expr_recon_loss: 13396297.6336; train_masked_gp_l1_reg_loss: 49785.3776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3326900.6608; train_chrom_access_recon_loss: 4737214.6985; train_global_loss: 25072677.0076; train_optim_loss: 25072677.0076; val_kl_reg_loss: 79029.1771; val_edge_recon_loss: 4060501.6667; val_gene_expr_recon_loss: 12709401.5333; val_masked_gp_l1_reg_loss: 56853.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 469620.8750; val_chrom_access_recon_loss: 4616190.2667; val_global_loss: 21991596.8000; val_optim_loss: 21991596.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8276; val_auprc_score: 0.8286; val_best_acc_score: 0.7409; val_best_f1_score: 0.7624; train_kl_reg_loss: 75313.9596; train_edge_recon_loss: 3490751.8073; train_gene_expr_recon_loss: 12608517.7939; train_masked_gp_l1_reg_loss: 59084.2725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 255434.5118; train_chrom_access_recon_loss: 4572633.0477; train_global_loss: 21061735.2977; train_optim_loss: 21061735.2977; val_kl_reg_loss: 53444.0109; val_edge_recon_loss: 3808865.9833; val_gene_expr_recon_loss: 12531362.8667; val_masked_gp_l1_reg_loss: 61511.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162782.5938; val_chrom_access_recon_loss: 4547020.7667; val_global_loss: 21164987.4667; val_optim_loss: 21164987.4667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8814; val_auprc_score: 0.8693; val_best_acc_score: 0.7990; val_best_f1_score: 0.8160; train_kl_reg_loss: 70054.6277; train_edge_recon_loss: 3115706.1031; train_gene_expr_recon_loss: 12475519.5344; train_masked_gp_l1_reg_loss: 66427.1098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134763.0269; train_chrom_access_recon_loss: 4533163.4332; train_global_loss: 20395633.9084; train_optim_loss: 20395633.9084; val_kl_reg_loss: 85999.2609; val_edge_recon_loss: 2937161.0667; val_gene_expr_recon_loss: 12390332.1333; val_masked_gp_l1_reg_loss: 71439.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117455.3359; val_chrom_access_recon_loss: 4511518.6500; val_global_loss: 20113905.2000; val_optim_loss: 20113905.2000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9129; val_auprc_score: 0.8972; val_best_acc_score: 0.8393; val_best_f1_score: 0.8521; train_kl_reg_loss: 96769.9541; train_edge_recon_loss: 2829300.5420; train_gene_expr_recon_loss: 12307651.2672; train_masked_gp_l1_reg_loss: 74948.0869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115346.9522; train_chrom_access_recon_loss: 4477662.4676; train_global_loss: 19901679.2519; train_optim_loss: 19901679.2519; val_kl_reg_loss: 96433.0781; val_edge_recon_loss: 2840932.6333; val_gene_expr_recon_loss: 12294414.4000; val_masked_gp_l1_reg_loss: 77147.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113880.8125; val_chrom_access_recon_loss: 4471944.4667; val_global_loss: 19894753.6000; val_optim_loss: 19894753.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9247; val_auprc_score: 0.9081; val_best_acc_score: 0.8584; val_best_f1_score: 0.8661; train_kl_reg_loss: 94839.5166; train_edge_recon_loss: 2800902.6469; train_gene_expr_recon_loss: 12180297.0840; train_masked_gp_l1_reg_loss: 78651.3223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111764.6276; train_chrom_access_recon_loss: 4434100.6813; train_global_loss: 19700555.8931; train_optim_loss: 19700555.8931; val_kl_reg_loss: 96778.5891; val_edge_recon_loss: 2796375.7333; val_gene_expr_recon_loss: 12140766.7333; val_masked_gp_l1_reg_loss: 79894.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109495.1562; val_chrom_access_recon_loss: 4440535.9000; val_global_loss: 19663847.3333; val_optim_loss: 19663847.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9230; val_auprc_score: 0.9053; val_best_acc_score: 0.8549; val_best_f1_score: 0.8639; train_kl_reg_loss: 93697.8916; train_edge_recon_loss: 2789845.8340; train_gene_expr_recon_loss: 12082136.8626; train_masked_gp_l1_reg_loss: 80883.7673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107551.5038; train_chrom_access_recon_loss: 4407049.3836; train_global_loss: 19561165.2214; train_optim_loss: 19561165.2214; val_kl_reg_loss: 89183.2573; val_edge_recon_loss: 2833415.0333; val_gene_expr_recon_loss: 12107659.2000; val_masked_gp_l1_reg_loss: 81897.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105561.9844; val_chrom_access_recon_loss: 4410494.8667; val_global_loss: 19628212.4000; val_optim_loss: 19628212.4000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9263; val_auprc_score: 0.9095; val_best_acc_score: 0.8624; val_best_f1_score: 0.8681; train_kl_reg_loss: 88923.6204; train_edge_recon_loss: 2788932.7939; train_gene_expr_recon_loss: 11990283.2519; train_masked_gp_l1_reg_loss: 82535.2260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103831.6078; train_chrom_access_recon_loss: 4378730.3569; train_global_loss: 19433236.8855; train_optim_loss: 19433236.8855; val_kl_reg_loss: 85845.8646; val_edge_recon_loss: 2812767.9667; val_gene_expr_recon_loss: 11968501.7333; val_masked_gp_l1_reg_loss: 83188.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101932.7969; val_chrom_access_recon_loss: 4394434.7667; val_global_loss: 19446671.3333; val_optim_loss: 19446671.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9331; val_auprc_score: 0.9136; val_best_acc_score: 0.8697; val_best_f1_score: 0.8776; train_kl_reg_loss: 86328.9318; train_edge_recon_loss: 2786165.6813; train_gene_expr_recon_loss: 11907743.5954; train_masked_gp_l1_reg_loss: 83798.5913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100473.8467; train_chrom_access_recon_loss: 4349574.3950; train_global_loss: 19314085.0534; train_optim_loss: 19314085.0534; val_kl_reg_loss: 88807.8396; val_edge_recon_loss: 2800173.3167; val_gene_expr_recon_loss: 11946902.2667; val_masked_gp_l1_reg_loss: 84422.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98530.9609; val_chrom_access_recon_loss: 4365198.3833; val_global_loss: 19384035.7333; val_optim_loss: 19384035.7333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9411; val_auprc_score: 0.9269; val_best_acc_score: 0.8833; val_best_f1_score: 0.8878; train_kl_reg_loss: 83339.8170; train_edge_recon_loss: 2773187.1069; train_gene_expr_recon_loss: 11851024.8168; train_masked_gp_l1_reg_loss: 84866.4934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96820.8829; train_chrom_access_recon_loss: 4328467.8378; train_global_loss: 19217706.8855; train_optim_loss: 19217706.8855; val_kl_reg_loss: 77825.9000; val_edge_recon_loss: 2786047.3000; val_gene_expr_recon_loss: 11847583.5333; val_masked_gp_l1_reg_loss: 85607.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96110.5938; val_chrom_access_recon_loss: 4333746.0333; val_global_loss: 19226920.8000; val_optim_loss: 19226920.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9406; val_auprc_score: 0.9285; val_best_acc_score: 0.8770; val_best_f1_score: 0.8820; train_kl_reg_loss: 81374.9596; train_edge_recon_loss: 2760366.9676; train_gene_expr_recon_loss: 11800354.7405; train_masked_gp_l1_reg_loss: 85970.2774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94569.9266; train_chrom_access_recon_loss: 4309982.9198; train_global_loss: 19132619.7405; train_optim_loss: 19132619.7405; val_kl_reg_loss: 78120.9240; val_edge_recon_loss: 2778824.3833; val_gene_expr_recon_loss: 11775639.6667; val_masked_gp_l1_reg_loss: 86594.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94259.0156; val_chrom_access_recon_loss: 4313330.8500; val_global_loss: 19126769.8667; val_optim_loss: 19126769.8667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9451; val_auprc_score: 0.9328; val_best_acc_score: 0.8859; val_best_f1_score: 0.8910; train_kl_reg_loss: 80912.9430; train_edge_recon_loss: 2754045.5878; train_gene_expr_recon_loss: 11738675.8931; train_masked_gp_l1_reg_loss: 86882.2422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92657.8610; train_chrom_access_recon_loss: 4282814.6240; train_global_loss: 19035989.1603; train_optim_loss: 19035989.1603; val_kl_reg_loss: 81054.5031; val_edge_recon_loss: 2741553.3667; val_gene_expr_recon_loss: 11731742.2000; val_masked_gp_l1_reg_loss: 87101.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91939.6797; val_chrom_access_recon_loss: 4288858.9667; val_global_loss: 19022251.2000; val_optim_loss: 19022251.2000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9439; val_auprc_score: 0.9302; val_best_acc_score: 0.8837; val_best_f1_score: 0.8889; train_kl_reg_loss: 82259.8478; train_edge_recon_loss: 2739050.5401; train_gene_expr_recon_loss: 11688122.2290; train_masked_gp_l1_reg_loss: 87198.2208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91149.6490; train_chrom_access_recon_loss: 4267041.8969; train_global_loss: 18954822.2748; train_optim_loss: 18954822.2748; val_kl_reg_loss: 81732.3125; val_edge_recon_loss: 2737717.5167; val_gene_expr_recon_loss: 11719688.6667; val_masked_gp_l1_reg_loss: 87449.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90522.3359; val_chrom_access_recon_loss: 4293479.6167; val_global_loss: 19010590.0000; val_optim_loss: 19010590.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9472; val_auprc_score: 0.9360; val_best_acc_score: 0.8836; val_best_f1_score: 0.8907; train_kl_reg_loss: 80556.9857; train_edge_recon_loss: 2741848.4523; train_gene_expr_recon_loss: 11655066.8015; train_masked_gp_l1_reg_loss: 87358.9530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89930.2496; train_chrom_access_recon_loss: 4250033.2844; train_global_loss: 18904794.7328; train_optim_loss: 18904794.7328; val_kl_reg_loss: 79524.1828; val_edge_recon_loss: 2755895.7500; val_gene_expr_recon_loss: 11625295.5333; val_masked_gp_l1_reg_loss: 87597.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89294.8594; val_chrom_access_recon_loss: 4253435.0000; val_global_loss: 18891042.9333; val_optim_loss: 18891042.9333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9513; val_auprc_score: 0.9406; val_best_acc_score: 0.8880; val_best_f1_score: 0.8929; train_kl_reg_loss: 79420.2742; train_edge_recon_loss: 2738914.6794; train_gene_expr_recon_loss: 11612100.1374; train_masked_gp_l1_reg_loss: 87597.5698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88705.6586; train_chrom_access_recon_loss: 4240703.1603; train_global_loss: 18847441.5573; train_optim_loss: 18847441.5573; val_kl_reg_loss: 76662.8318; val_edge_recon_loss: 2738087.5000; val_gene_expr_recon_loss: 11627139.6667; val_masked_gp_l1_reg_loss: 87715.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88468.1562; val_chrom_access_recon_loss: 4253857.7167; val_global_loss: 18871930.6667; val_optim_loss: 18871930.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9479; val_auprc_score: 0.9324; val_best_acc_score: 0.8901; val_best_f1_score: 0.8936; train_kl_reg_loss: 78803.1282; train_edge_recon_loss: 2728830.2385; train_gene_expr_recon_loss: 11586919.6718; train_masked_gp_l1_reg_loss: 87653.5633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87996.0475; train_chrom_access_recon_loss: 4225302.4676; train_global_loss: 18795505.1145; train_optim_loss: 18795505.1145; val_kl_reg_loss: 75309.4510; val_edge_recon_loss: 2745951.0500; val_gene_expr_recon_loss: 11541847.8000; val_masked_gp_l1_reg_loss: 87595.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88186.0781; val_chrom_access_recon_loss: 4224192.0167; val_global_loss: 18763082.4000; val_optim_loss: 18763082.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9510; val_auprc_score: 0.9391; val_best_acc_score: 0.8919; val_best_f1_score: 0.8961; train_kl_reg_loss: 77009.8788; train_edge_recon_loss: 2729781.0706; train_gene_expr_recon_loss: 11541156.4122; train_masked_gp_l1_reg_loss: 87687.4711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87834.4943; train_chrom_access_recon_loss: 4200910.0534; train_global_loss: 18724379.3130; train_optim_loss: 18724379.3130; val_kl_reg_loss: 77103.2708; val_edge_recon_loss: 2742420.3333; val_gene_expr_recon_loss: 11562859.5333; val_masked_gp_l1_reg_loss: 87793.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87759.2734; val_chrom_access_recon_loss: 4227802.8167; val_global_loss: 18785737.8667; val_optim_loss: 18785737.8667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9554; val_auprc_score: 0.9441; val_best_acc_score: 0.8985; val_best_f1_score: 0.9028; train_kl_reg_loss: 76247.4915; train_edge_recon_loss: 2717349.4065; train_gene_expr_recon_loss: 11515965.4656; train_masked_gp_l1_reg_loss: 87850.0841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87528.5669; train_chrom_access_recon_loss: 4194003.6718; train_global_loss: 18678944.6870; train_optim_loss: 18678944.6870; val_kl_reg_loss: 77540.5495; val_edge_recon_loss: 2712985.2167; val_gene_expr_recon_loss: 11502825.2667; val_masked_gp_l1_reg_loss: 87906.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87643.0625; val_chrom_access_recon_loss: 4211464.6667; val_global_loss: 18680364.5333; val_optim_loss: 18680364.5333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9565; val_auprc_score: 0.9426; val_best_acc_score: 0.8972; val_best_f1_score: 0.9020; train_kl_reg_loss: 75469.5042; train_edge_recon_loss: 2715360.4447; train_gene_expr_recon_loss: 11492313.5649; train_masked_gp_l1_reg_loss: 87867.6328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87789.7821; train_chrom_access_recon_loss: 4179524.3244; train_global_loss: 18638325.2672; train_optim_loss: 18638325.2672; val_kl_reg_loss: 74207.8344; val_edge_recon_loss: 2744640.6000; val_gene_expr_recon_loss: 11531220.9333; val_masked_gp_l1_reg_loss: 87980.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88722.0391; val_chrom_access_recon_loss: 4208540.6167; val_global_loss: 18735313.0667; val_optim_loss: 18735313.0667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9590; val_auprc_score: 0.9432; val_best_acc_score: 0.9031; val_best_f1_score: 0.9066; train_kl_reg_loss: 75639.4661; train_edge_recon_loss: 2715823.6489; train_gene_expr_recon_loss: 11462743.6031; train_masked_gp_l1_reg_loss: 87965.8424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88473.0020; train_chrom_access_recon_loss: 4168044.7786; train_global_loss: 18598690.3817; train_optim_loss: 18598690.3817; val_kl_reg_loss: 74417.1906; val_edge_recon_loss: 2734088.8000; val_gene_expr_recon_loss: 11473309.0000; val_masked_gp_l1_reg_loss: 87849.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89218.4766; val_chrom_access_recon_loss: 4181639.6667; val_global_loss: 18640522.8000; val_optim_loss: 18640522.8000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9653; val_auprc_score: 0.9578; val_best_acc_score: 0.9128; val_best_f1_score: 0.9155; train_kl_reg_loss: 75099.1010; train_edge_recon_loss: 2706861.0821; train_gene_expr_recon_loss: 11442493.8702; train_masked_gp_l1_reg_loss: 87766.3641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89810.0406; train_chrom_access_recon_loss: 4159743.4447; train_global_loss: 18561773.8473; train_optim_loss: 18561773.8473; val_kl_reg_loss: 72354.4510; val_edge_recon_loss: 2713434.3000; val_gene_expr_recon_loss: 11408361.2000; val_masked_gp_l1_reg_loss: 87678.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90586.4531; val_chrom_access_recon_loss: 4165804.2833; val_global_loss: 18538219.2000; val_optim_loss: 18538219.2000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9633; val_auprc_score: 0.9516; val_best_acc_score: 0.9104; val_best_f1_score: 0.9135; train_kl_reg_loss: 75351.0701; train_edge_recon_loss: 2699699.9408; train_gene_expr_recon_loss: 11413871.8397; train_masked_gp_l1_reg_loss: 87550.7661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90733.3689; train_chrom_access_recon_loss: 4143272.7385; train_global_loss: 18510479.5115; train_optim_loss: 18510479.5115; val_kl_reg_loss: 74562.7156; val_edge_recon_loss: 2715884.9167; val_gene_expr_recon_loss: 11454464.4000; val_masked_gp_l1_reg_loss: 87494.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91216.3672; val_chrom_access_recon_loss: 4167977.6000; val_global_loss: 18591600.6667; val_optim_loss: 18591600.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9693; val_auprc_score: 0.9606; val_best_acc_score: 0.9124; val_best_f1_score: 0.9145; train_kl_reg_loss: 74879.2421; train_edge_recon_loss: 2700147.8950; train_gene_expr_recon_loss: 11404200.5344; train_masked_gp_l1_reg_loss: 87344.9027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91512.4099; train_chrom_access_recon_loss: 4141786.3187; train_global_loss: 18499871.2824; train_optim_loss: 18499871.2824; val_kl_reg_loss: 76115.6833; val_edge_recon_loss: 2700057.7500; val_gene_expr_recon_loss: 11397032.8667; val_masked_gp_l1_reg_loss: 87263.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91204.9609; val_chrom_access_recon_loss: 4155398.6167; val_global_loss: 18507074.2667; val_optim_loss: 18507074.2667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9677; val_auprc_score: 0.9584; val_best_acc_score: 0.9167; val_best_f1_score: 0.9184; train_kl_reg_loss: 75241.4968; train_edge_recon_loss: 2699508.5363; train_gene_expr_recon_loss: 11373986.0076; train_masked_gp_l1_reg_loss: 87004.6232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91645.4361; train_chrom_access_recon_loss: 4127639.7672; train_global_loss: 18455025.8015; train_optim_loss: 18455025.8015; val_kl_reg_loss: 74800.5146; val_edge_recon_loss: 2714971.1500; val_gene_expr_recon_loss: 11394257.6000; val_masked_gp_l1_reg_loss: 86996.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92090.0859; val_chrom_access_recon_loss: 4156847.3667; val_global_loss: 18519962.9333; val_optim_loss: 18519962.9333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9686; val_auprc_score: 0.9601; val_best_acc_score: 0.9161; val_best_f1_score: 0.9192; train_kl_reg_loss: 75584.3263; train_edge_recon_loss: 2695000.1336; train_gene_expr_recon_loss: 11363687.9466; train_masked_gp_l1_reg_loss: 86739.5726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91936.4605; train_chrom_access_recon_loss: 4116750.2424; train_global_loss: 18429698.6565; train_optim_loss: 18429698.6565; val_kl_reg_loss: 73504.3010; val_edge_recon_loss: 2698224.3167; val_gene_expr_recon_loss: 11345591.0667; val_masked_gp_l1_reg_loss: 86334.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91471.9688; val_chrom_access_recon_loss: 4128135.2000; val_global_loss: 18423260.8000; val_optim_loss: 18423260.8000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9646; val_auprc_score: 0.9539; val_best_acc_score: 0.9143; val_best_f1_score: 0.9188; train_kl_reg_loss: 75986.8251; train_edge_recon_loss: 2691309.7023; train_gene_expr_recon_loss: 11349879.0687; train_masked_gp_l1_reg_loss: 86295.2795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91883.5681; train_chrom_access_recon_loss: 4105458.2156; train_global_loss: 18400812.7176; train_optim_loss: 18400812.7176; val_kl_reg_loss: 74648.9625; val_edge_recon_loss: 2729043.3833; val_gene_expr_recon_loss: 11367229.0667; val_masked_gp_l1_reg_loss: 85943.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92156.3359; val_chrom_access_recon_loss: 4136246.5167; val_global_loss: 18485266.9333; val_optim_loss: 18485266.9333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9708; val_auprc_score: 0.9641; val_best_acc_score: 0.9188; val_best_f1_score: 0.9206; train_kl_reg_loss: 74630.8135; train_edge_recon_loss: 2691099.7385; train_gene_expr_recon_loss: 11336522.8015; train_masked_gp_l1_reg_loss: 85835.6568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92099.6499; train_chrom_access_recon_loss: 4095946.8912; train_global_loss: 18376135.6336; train_optim_loss: 18376135.6336; val_kl_reg_loss: 73812.1307; val_edge_recon_loss: 2701032.2833; val_gene_expr_recon_loss: 11344144.8667; val_masked_gp_l1_reg_loss: 85904.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92369.9766; val_chrom_access_recon_loss: 4124581.1000; val_global_loss: 18421844.4000; val_optim_loss: 18421844.4000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9722; val_auprc_score: 0.9641; val_best_acc_score: 0.9252; val_best_f1_score: 0.9283; train_kl_reg_loss: 73614.0643; train_edge_recon_loss: 2698535.9103; train_gene_expr_recon_loss: 11325963.3511; train_masked_gp_l1_reg_loss: 85827.8242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92353.4009; train_chrom_access_recon_loss: 4088183.3187; train_global_loss: 18364477.8626; train_optim_loss: 18364477.8626; val_kl_reg_loss: 73463.4969; val_edge_recon_loss: 2684739.1833; val_gene_expr_recon_loss: 11300693.0000; val_masked_gp_l1_reg_loss: 85921.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92848.3906; val_chrom_access_recon_loss: 4109924.4167; val_global_loss: 18347589.0667; val_optim_loss: 18347589.0667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9716; val_auprc_score: 0.9658; val_best_acc_score: 0.9194; val_best_f1_score: 0.9236; train_kl_reg_loss: 72939.9543; train_edge_recon_loss: 2687550.6489; train_gene_expr_recon_loss: 11306840.3359; train_masked_gp_l1_reg_loss: 85709.0396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92486.9294; train_chrom_access_recon_loss: 4074788.3302; train_global_loss: 18320315.1908; train_optim_loss: 18320315.1908; val_kl_reg_loss: 70956.0688; val_edge_recon_loss: 2720350.6167; val_gene_expr_recon_loss: 11362608.2667; val_masked_gp_l1_reg_loss: 85750.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92708.1719; val_chrom_access_recon_loss: 4139429.3167; val_global_loss: 18471803.4667; val_optim_loss: 18471803.4667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9728; val_auprc_score: 0.9654; val_best_acc_score: 0.9258; val_best_f1_score: 0.9278; train_kl_reg_loss: 73459.7672; train_edge_recon_loss: 2690106.7500; train_gene_expr_recon_loss: 11296456.4885; train_masked_gp_l1_reg_loss: 85519.6829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92483.9631; train_chrom_access_recon_loss: 4065670.3740; train_global_loss: 18303697.0382; train_optim_loss: 18303697.0382; val_kl_reg_loss: 72559.7156; val_edge_recon_loss: 2699713.3333; val_gene_expr_recon_loss: 11308683.1333; val_masked_gp_l1_reg_loss: 85351.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92415.3438; val_chrom_access_recon_loss: 4114351.7500; val_global_loss: 18373074.8000; val_optim_loss: 18373074.8000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9719; val_auprc_score: 0.9648; val_best_acc_score: 0.9224; val_best_f1_score: 0.9247; train_kl_reg_loss: 72493.7656; train_edge_recon_loss: 2690940.9447; train_gene_expr_recon_loss: 11281759.5496; train_masked_gp_l1_reg_loss: 85186.5352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92591.7193; train_chrom_access_recon_loss: 4058868.3683; train_global_loss: 18281840.7786; train_optim_loss: 18281840.7786; val_kl_reg_loss: 72075.0255; val_edge_recon_loss: 2713925.0167; val_gene_expr_recon_loss: 11304904.3333; val_masked_gp_l1_reg_loss: 84857.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92478.0000; val_chrom_access_recon_loss: 4101565.6667; val_global_loss: 18369805.0667; val_optim_loss: 18369805.0667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9729; val_auprc_score: 0.9622; val_best_acc_score: 0.9251; val_best_f1_score: 0.9276; train_kl_reg_loss: 71966.2582; train_edge_recon_loss: 2689734.6431; train_gene_expr_recon_loss: 11280938.4733; train_masked_gp_l1_reg_loss: 84956.4863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92973.6210; train_chrom_access_recon_loss: 4047913.2710; train_global_loss: 18268482.6260; train_optim_loss: 18268482.6260; val_kl_reg_loss: 72460.6099; val_edge_recon_loss: 2706081.1000; val_gene_expr_recon_loss: 11313620.4667; val_masked_gp_l1_reg_loss: 84821.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92684.4297; val_chrom_access_recon_loss: 4077239.8667; val_global_loss: 18346906.9333; val_optim_loss: 18346906.9333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9765; val_auprc_score: 0.9692; val_best_acc_score: 0.9322; val_best_f1_score: 0.9339; train_kl_reg_loss: 71555.1715; train_edge_recon_loss: 2686967.4122; train_gene_expr_recon_loss: 11267971.6183; train_masked_gp_l1_reg_loss: 84591.7111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92894.9398; train_chrom_access_recon_loss: 4040690.9714; train_global_loss: 18244671.8168; train_optim_loss: 18244671.8168; val_kl_reg_loss: 74915.9172; val_edge_recon_loss: 2670079.8500; val_gene_expr_recon_loss: 11301875.5333; val_masked_gp_l1_reg_loss: 84338.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93309.7969; val_chrom_access_recon_loss: 4091293.6500; val_global_loss: 18315813.8667; val_optim_loss: 18315813.8667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9750; val_auprc_score: 0.9671; val_best_acc_score: 0.9302; val_best_f1_score: 0.9318; train_kl_reg_loss: 71736.5929; train_edge_recon_loss: 2682464.3798; train_gene_expr_recon_loss: 11260563.3435; train_masked_gp_l1_reg_loss: 84140.9852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93174.4225; train_chrom_access_recon_loss: 4030337.9294; train_global_loss: 18222417.7710; train_optim_loss: 18222417.7710; val_kl_reg_loss: 73188.0021; val_edge_recon_loss: 2690750.9833; val_gene_expr_recon_loss: 11351412.8000; val_masked_gp_l1_reg_loss: 83996.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93147.3750; val_chrom_access_recon_loss: 4092325.4167; val_global_loss: 18384820.1333; val_optim_loss: 18384820.1333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9736; val_auprc_score: 0.9657; val_best_acc_score: 0.9258; val_best_f1_score: 0.9287; train_kl_reg_loss: 71663.7938; train_edge_recon_loss: 2677162.2939; train_gene_expr_recon_loss: 11246422.5420; train_masked_gp_l1_reg_loss: 83736.9785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93414.8705; train_chrom_access_recon_loss: 4018107.6279; train_global_loss: 18190508.0916; train_optim_loss: 18190508.0916; val_kl_reg_loss: 71511.9839; val_edge_recon_loss: 2709752.9833; val_gene_expr_recon_loss: 11274634.9333; val_masked_gp_l1_reg_loss: 83539.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93674.4922; val_chrom_access_recon_loss: 4066487.9000; val_global_loss: 18299600.9333; val_optim_loss: 18299600.9333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9762; val_auprc_score: 0.9693; val_best_acc_score: 0.9325; val_best_f1_score: 0.9348; train_kl_reg_loss: 71598.1916; train_edge_recon_loss: 2680425.1183; train_gene_expr_recon_loss: 11242055.2672; train_masked_gp_l1_reg_loss: 83340.9670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93406.6578; train_chrom_access_recon_loss: 4013617.1298; train_global_loss: 18184443.2672; train_optim_loss: 18184443.2672; val_kl_reg_loss: 71117.5448; val_edge_recon_loss: 2684127.7667; val_gene_expr_recon_loss: 11233625.4667; val_masked_gp_l1_reg_loss: 83229.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94209.7734; val_chrom_access_recon_loss: 4047179.0500; val_global_loss: 18213489.6000; val_optim_loss: 18213489.6000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9768; val_auprc_score: 0.9698; val_best_acc_score: 0.9356; val_best_f1_score: 0.9370; train_kl_reg_loss: 72665.1189; train_edge_recon_loss: 2675100.7252; train_gene_expr_recon_loss: 11241788.2443; train_masked_gp_l1_reg_loss: 82872.4589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93680.0655; train_chrom_access_recon_loss: 4001338.5057; train_global_loss: 18167445.0229; train_optim_loss: 18167445.0229; val_kl_reg_loss: 73839.1427; val_edge_recon_loss: 2698133.7667; val_gene_expr_recon_loss: 11279198.4000; val_masked_gp_l1_reg_loss: 82664.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93792.0781; val_chrom_access_recon_loss: 4057219.4500; val_global_loss: 18284847.7333; val_optim_loss: 18284847.7333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9742; val_auprc_score: 0.9665; val_best_acc_score: 0.9290; val_best_f1_score: 0.9313; train_kl_reg_loss: 71372.9509; train_edge_recon_loss: 2679208.2824; train_gene_expr_recon_loss: 11239048.4733; train_masked_gp_l1_reg_loss: 82554.6109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93840.5893; train_chrom_access_recon_loss: 3998801.9027; train_global_loss: 18164826.7939; train_optim_loss: 18164826.7939; val_kl_reg_loss: 69164.6307; val_edge_recon_loss: 2699264.5333; val_gene_expr_recon_loss: 11244053.7333; val_masked_gp_l1_reg_loss: 82650.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94044.7891; val_chrom_access_recon_loss: 4040619.3500; val_global_loss: 18229798.4000; val_optim_loss: 18229798.4000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9765; val_auprc_score: 0.9701; val_best_acc_score: 0.9322; val_best_f1_score: 0.9344; train_kl_reg_loss: 70640.8964; train_edge_recon_loss: 2681226.7519; train_gene_expr_recon_loss: 11235808.5649; train_masked_gp_l1_reg_loss: 82528.4760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94239.3946; train_chrom_access_recon_loss: 3994644.9313; train_global_loss: 18159089.0992; train_optim_loss: 18159089.0992; val_kl_reg_loss: 75123.1156; val_edge_recon_loss: 2712725.8167; val_gene_expr_recon_loss: 11266809.8000; val_masked_gp_l1_reg_loss: 82477.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94298.2422; val_chrom_access_recon_loss: 4050923.8500; val_global_loss: 18282358.5333; val_optim_loss: 18282358.5333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9785; val_auprc_score: 0.9705; val_best_acc_score: 0.9375; val_best_f1_score: 0.9388; train_kl_reg_loss: 71402.4376; train_edge_recon_loss: 2678986.9427; train_gene_expr_recon_loss: 11216126.3817; train_masked_gp_l1_reg_loss: 82226.9321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94419.3996; train_chrom_access_recon_loss: 3977590.0630; train_global_loss: 18120752.1527; train_optim_loss: 18120752.1527; val_kl_reg_loss: 70047.5021; val_edge_recon_loss: 2684407.7000; val_gene_expr_recon_loss: 11284961.9333; val_masked_gp_l1_reg_loss: 82067.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95050.8672; val_chrom_access_recon_loss: 4049063.2333; val_global_loss: 18265599.7333; val_optim_loss: 18265599.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9788; val_auprc_score: 0.9710; val_best_acc_score: 0.9359; val_best_f1_score: 0.9374; train_kl_reg_loss: 71977.5180; train_edge_recon_loss: 2678242.1393; train_gene_expr_recon_loss: 11201546.6183; train_masked_gp_l1_reg_loss: 80539.8180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71864.1148; train_chrom_access_recon_loss: 3957768.5592; train_global_loss: 18061938.7786; train_optim_loss: 18061938.7786; val_kl_reg_loss: 73040.1479; val_edge_recon_loss: 2679931.6167; val_gene_expr_recon_loss: 11222894.1333; val_masked_gp_l1_reg_loss: 80091.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68665.1641; val_chrom_access_recon_loss: 4042526.7500; val_global_loss: 18167149.7333; val_optim_loss: 18167149.7333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9777; val_auprc_score: 0.9699; val_best_acc_score: 0.9376; val_best_f1_score: 0.9387; train_kl_reg_loss: 73749.4474; train_edge_recon_loss: 2671748.4618; train_gene_expr_recon_loss: 11203314.1756; train_masked_gp_l1_reg_loss: 80003.4256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68091.7954; train_chrom_access_recon_loss: 3956892.3015; train_global_loss: 18053799.6641; train_optim_loss: 18053799.6641; val_kl_reg_loss: 74519.1562; val_edge_recon_loss: 2694410.5667; val_gene_expr_recon_loss: 11252028.3333; val_masked_gp_l1_reg_loss: 79954.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67680.3750; val_chrom_access_recon_loss: 4020127.2167; val_global_loss: 18188719.4667; val_optim_loss: 18188719.4667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9783; val_auprc_score: 0.9723; val_best_acc_score: 0.9365; val_best_f1_score: 0.9386; train_kl_reg_loss: 74247.0875; train_edge_recon_loss: 2675785.1374; train_gene_expr_recon_loss: 11200693.8473; train_masked_gp_l1_reg_loss: 79895.9238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67359.4541; train_chrom_access_recon_loss: 3955326.1202; train_global_loss: 18053307.5115; train_optim_loss: 18053307.5115; val_kl_reg_loss: 74022.9271; val_edge_recon_loss: 2691479.7500; val_gene_expr_recon_loss: 11258968.6000; val_masked_gp_l1_reg_loss: 79870.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67117.2109; val_chrom_access_recon_loss: 4038441.2167; val_global_loss: 18209899.4667; val_optim_loss: 18209899.4667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9786; val_auprc_score: 0.9717; val_best_acc_score: 0.9349; val_best_f1_score: 0.9368; train_kl_reg_loss: 74649.7633; train_edge_recon_loss: 2669267.1927; train_gene_expr_recon_loss: 11200051.2290; train_masked_gp_l1_reg_loss: 79828.6437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66957.8902; train_chrom_access_recon_loss: 3953193.5057; train_global_loss: 18043948.2290; train_optim_loss: 18043948.2290; val_kl_reg_loss: 74613.9620; val_edge_recon_loss: 2694582.9667; val_gene_expr_recon_loss: 11282605.7333; val_masked_gp_l1_reg_loss: 79796.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66686.2344; val_chrom_access_recon_loss: 4021009.9000; val_global_loss: 18219295.3333; val_optim_loss: 18219295.3333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9765; val_auprc_score: 0.9696; val_best_acc_score: 0.9368; val_best_f1_score: 0.9378; train_kl_reg_loss: 74504.7124; train_edge_recon_loss: 2677918.9828; train_gene_expr_recon_loss: 11194228.5802; train_masked_gp_l1_reg_loss: 79750.0339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66436.7323; train_chrom_access_recon_loss: 3948783.7748; train_global_loss: 18041622.6870; train_optim_loss: 18041622.6870; val_kl_reg_loss: 74375.3984; val_edge_recon_loss: 2703736.3000; val_gene_expr_recon_loss: 11226075.5333; val_masked_gp_l1_reg_loss: 79720.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66321.1016; val_chrom_access_recon_loss: 4023904.0833; val_global_loss: 18174132.5333; val_optim_loss: 18174132.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9806; val_auprc_score: 0.9756; val_best_acc_score: 0.9368; val_best_f1_score: 0.9384; train_kl_reg_loss: 74517.1897; train_edge_recon_loss: 2668581.8187; train_gene_expr_recon_loss: 11195075.4275; train_masked_gp_l1_reg_loss: 79564.2317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64024.7912; train_chrom_access_recon_loss: 3950067.0744; train_global_loss: 18031830.5649; train_optim_loss: 18031830.5649; val_kl_reg_loss: 74716.5365; val_edge_recon_loss: 2684886.6833; val_gene_expr_recon_loss: 11252485.4000; val_masked_gp_l1_reg_loss: 79504.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63718.3438; val_chrom_access_recon_loss: 4029044.9500; val_global_loss: 18184355.6000; val_optim_loss: 18184355.6000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9793; val_auprc_score: 0.9735; val_best_acc_score: 0.9394; val_best_f1_score: 0.9407; train_kl_reg_loss: 74526.9060; train_edge_recon_loss: 2665496.7595; train_gene_expr_recon_loss: 11190289.8244; train_masked_gp_l1_reg_loss: 79488.7959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63650.9978; train_chrom_access_recon_loss: 3948210.1317; train_global_loss: 18021663.2977; train_optim_loss: 18021663.2977; val_kl_reg_loss: 74897.4839; val_edge_recon_loss: 2685439.1500; val_gene_expr_recon_loss: 11245089.4000; val_masked_gp_l1_reg_loss: 79476.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63594.1328; val_chrom_access_recon_loss: 4028774.8667; val_global_loss: 18177270.9333; val_optim_loss: 18177270.9333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9781; val_auprc_score: 0.9710; val_best_acc_score: 0.9364; val_best_f1_score: 0.9387; train_kl_reg_loss: 74638.9377; train_edge_recon_loss: 2667326.1737; train_gene_expr_recon_loss: 11182442.3969; train_masked_gp_l1_reg_loss: 79470.0503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63540.3661; train_chrom_access_recon_loss: 3943664.1889; train_global_loss: 18011082.1069; train_optim_loss: 18011082.1069; val_kl_reg_loss: 74506.9625; val_edge_recon_loss: 2691550.0167; val_gene_expr_recon_loss: 11202403.2667; val_masked_gp_l1_reg_loss: 79466.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63511.0742; val_chrom_access_recon_loss: 4003655.5167; val_global_loss: 18115092.6667; val_optim_loss: 18115092.6667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9795; val_auprc_score: 0.9739; val_best_acc_score: 0.9359; val_best_f1_score: 0.9375; train_kl_reg_loss: 74743.2598; train_edge_recon_loss: 2671410.9103; train_gene_expr_recon_loss: 11184637.7176; train_masked_gp_l1_reg_loss: 79457.2709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63472.2721; train_chrom_access_recon_loss: 3942962.3473; train_global_loss: 18016683.7710; train_optim_loss: 18016683.7710; val_kl_reg_loss: 74604.6583; val_edge_recon_loss: 2688910.4167; val_gene_expr_recon_loss: 11231261.6000; val_masked_gp_l1_reg_loss: 79453.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63434.4922; val_chrom_access_recon_loss: 4013029.8000; val_global_loss: 18150693.4667; val_optim_loss: 18150693.4667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9795; val_auprc_score: 0.9720; val_best_acc_score: 0.9372; val_best_f1_score: 0.9382; train_kl_reg_loss: 74743.0939; train_edge_recon_loss: 2676240.0057; train_gene_expr_recon_loss: 11194967.8244; train_masked_gp_l1_reg_loss: 79447.0193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63398.6142; train_chrom_access_recon_loss: 3946622.9771; train_global_loss: 18035419.5344; train_optim_loss: 18035419.5344; val_kl_reg_loss: 74756.8094; val_edge_recon_loss: 2700088.5000; val_gene_expr_recon_loss: 11232381.6667; val_masked_gp_l1_reg_loss: 79440.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63377.3438; val_chrom_access_recon_loss: 4019346.2833; val_global_loss: 18169390.1333; val_optim_loss: 18169390.1333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9792; val_auprc_score: 0.9740; val_best_acc_score: 0.9359; val_best_f1_score: 0.9375; train_kl_reg_loss: 74662.6461; train_edge_recon_loss: 2672126.1527; train_gene_expr_recon_loss: 11191372.5954; train_masked_gp_l1_reg_loss: 79436.6784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63353.1722; train_chrom_access_recon_loss: 3947487.6832; train_global_loss: 18028438.8855; train_optim_loss: 18028438.8855; val_kl_reg_loss: 75389.5031; val_edge_recon_loss: 2695789.8167; val_gene_expr_recon_loss: 11231309.9333; val_masked_gp_l1_reg_loss: 79433.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63319.9805; val_chrom_access_recon_loss: 4024959.5167; val_global_loss: 18170201.7333; val_optim_loss: 18170201.7333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9773; val_auprc_score: 0.9698; val_best_acc_score: 0.9340; val_best_f1_score: 0.9356; train_kl_reg_loss: 74690.1323; train_edge_recon_loss: 2675063.5821; train_gene_expr_recon_loss: 11192134.0534; train_masked_gp_l1_reg_loss: 79428.5154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63284.1069; train_chrom_access_recon_loss: 3946625.0324; train_global_loss: 18031225.4656; train_optim_loss: 18031225.4656; val_kl_reg_loss: 74797.6708; val_edge_recon_loss: 2676244.8833; val_gene_expr_recon_loss: 11213900.0667; val_masked_gp_l1_reg_loss: 79424.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63260.9805; val_chrom_access_recon_loss: 4020775.0833; val_global_loss: 18128403.5333; val_optim_loss: 18128403.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9821; val_auprc_score: 0.9765; val_best_acc_score: 0.9390; val_best_f1_score: 0.9404; train_kl_reg_loss: 74673.5926; train_edge_recon_loss: 2674809.4504; train_gene_expr_recon_loss: 11191683.8702; train_masked_gp_l1_reg_loss: 79408.0500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63034.9149; train_chrom_access_recon_loss: 3947793.5782; train_global_loss: 18031403.4809; train_optim_loss: 18031403.4809; val_kl_reg_loss: 74842.1620; val_edge_recon_loss: 2680090.5333; val_gene_expr_recon_loss: 11231427.0667; val_masked_gp_l1_reg_loss: 79401.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63005.8008; val_chrom_access_recon_loss: 4019062.0667; val_global_loss: 18147829.6000; val_optim_loss: 18147829.6000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9802; val_auprc_score: 0.9747; val_best_acc_score: 0.9384; val_best_f1_score: 0.9399; train_kl_reg_loss: 74772.1598; train_edge_recon_loss: 2674870.8454; train_gene_expr_recon_loss: 11191515.5267; train_masked_gp_l1_reg_loss: 79399.6953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62998.5219; train_chrom_access_recon_loss: 3941849.4714; train_global_loss: 18025406.3053; train_optim_loss: 18025406.3053; val_kl_reg_loss: 74489.0370; val_edge_recon_loss: 2699883.3333; val_gene_expr_recon_loss: 11246978.2667; val_masked_gp_l1_reg_loss: 79398.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62993.0781; val_chrom_access_recon_loss: 4025248.3000; val_global_loss: 18188989.8667; val_optim_loss: 18188989.8667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9784; val_auprc_score: 0.9731; val_best_acc_score: 0.9369; val_best_f1_score: 0.9389; train_kl_reg_loss: 74806.3503; train_edge_recon_loss: 2673300.4618; train_gene_expr_recon_loss: 11185011.5802; train_masked_gp_l1_reg_loss: 79397.4869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62987.4824; train_chrom_access_recon_loss: 3944150.0477; train_global_loss: 18019653.2061; train_optim_loss: 18019653.2061; val_kl_reg_loss: 74896.0422; val_edge_recon_loss: 2686791.8500; val_gene_expr_recon_loss: 11222901.5333; val_masked_gp_l1_reg_loss: 79396.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62982.5742; val_chrom_access_recon_loss: 4017897.0667; val_global_loss: 18144865.4667; val_optim_loss: 18144865.4667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9788; val_auprc_score: 0.9735; val_best_acc_score: 0.9375; val_best_f1_score: 0.9388; train_kl_reg_loss: 74886.9315; train_edge_recon_loss: 2673966.2347; train_gene_expr_recon_loss: 11191309.9237; train_masked_gp_l1_reg_loss: 79395.5877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62977.4709; train_chrom_access_recon_loss: 3945316.0592; train_global_loss: 18027852.1679; train_optim_loss: 18027852.1679; val_kl_reg_loss: 74640.0979; val_edge_recon_loss: 2680681.9000; val_gene_expr_recon_loss: 11222508.6000; val_masked_gp_l1_reg_loss: 79395.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62974.0352; val_chrom_access_recon_loss: 4018718.8833; val_global_loss: 18138918.6667; val_optim_loss: 18138918.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 43 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9810
val AUPRC score: 0.9770
val best accuracy score: 0.9395
val best F1 score: 0.9415
val target rna MSE score: 1.2219
val source rna MSE score: 0.4628
val target atac MSE score: 0.4867
val source atac MSE score: 0.1308
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
