[True]
Run timestamp: 27072023_030636_137.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_137']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8798; val_auprc_score: 0.9762; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 346588.2051; train_edge_recon_loss: 10791677.9721; train_gene_expr_recon_loss: 21453829.1256; train_masked_gp_l1_reg_loss: 16441.5915; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32608536.9860; train_optim_loss: 32608536.9860; val_kl_reg_loss: 259519.5514; val_edge_recon_loss: 12029307.8750; val_gene_expr_recon_loss: 10825653.1667; val_masked_gp_l1_reg_loss: 17408.5273; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23131888.3333; val_optim_loss: 23131888.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8723; val_auprc_score: 0.9754; val_best_acc_score: 0.8583; val_best_f1_score: 0.9238; train_kl_reg_loss: 287062.1561; train_edge_recon_loss: 10713236.6000; train_gene_expr_recon_loss: 10564780.5395; train_masked_gp_l1_reg_loss: 17814.6721; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21582893.9721; train_optim_loss: 21582893.9721; val_kl_reg_loss: 243589.5391; val_edge_recon_loss: 11509842.3750; val_gene_expr_recon_loss: 10231117.4583; val_masked_gp_l1_reg_loss: 18148.9961; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22002697.7500; val_optim_loss: 22002697.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8491; val_auprc_score: 0.9697; val_best_acc_score: 0.8651; val_best_f1_score: 0.9260; train_kl_reg_loss: 256352.2573; train_edge_recon_loss: 10568318.6047; train_gene_expr_recon_loss: 10051950.1302; train_masked_gp_l1_reg_loss: 18560.5143; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20895181.4977; train_optim_loss: 20895181.4977; val_kl_reg_loss: 197360.7565; val_edge_recon_loss: 11747850.8750; val_gene_expr_recon_loss: 9850485.0000; val_masked_gp_l1_reg_loss: 19079.0625; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21814776.5833; val_optim_loss: 21814776.5833
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8555; val_auprc_score: 0.9680; val_best_acc_score: 0.8887; val_best_f1_score: 0.9376; train_kl_reg_loss: 215016.5735; train_edge_recon_loss: 10439014.8837; train_gene_expr_recon_loss: 9680903.1349; train_masked_gp_l1_reg_loss: 19728.6938; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20354663.1628; train_optim_loss: 20354663.1628; val_kl_reg_loss: 175362.3145; val_edge_recon_loss: 11043334.9583; val_gene_expr_recon_loss: 9511748.0000; val_masked_gp_l1_reg_loss: 20408.2754; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20750853.1667; val_optim_loss: 20750853.1667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8426; val_auprc_score: 0.9657; val_best_acc_score: 0.8892; val_best_f1_score: 0.9383; train_kl_reg_loss: 138704.8919; train_edge_recon_loss: 9838995.6512; train_gene_expr_recon_loss: 9529104.3814; train_masked_gp_l1_reg_loss: 21163.6926; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19527968.5860; train_optim_loss: 19527968.5860; val_kl_reg_loss: 152255.1309; val_edge_recon_loss: 9002525.1667; val_gene_expr_recon_loss: 9291307.2083; val_masked_gp_l1_reg_loss: 21994.7227; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18468081.5417; val_optim_loss: 18468081.5417
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8310; val_auprc_score: 0.9607; val_best_acc_score: 0.8859; val_best_f1_score: 0.9364; train_kl_reg_loss: 195552.7424; train_edge_recon_loss: 9029867.0349; train_gene_expr_recon_loss: 9128183.9628; train_masked_gp_l1_reg_loss: 22747.6710; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18376351.3814; train_optim_loss: 18376351.3814; val_kl_reg_loss: 207766.9362; val_edge_recon_loss: 9172951.7292; val_gene_expr_recon_loss: 8982039.9167; val_masked_gp_l1_reg_loss: 23450.0098; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18386208.5833; val_optim_loss: 18386208.5833
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8473; val_auprc_score: 0.9654; val_best_acc_score: 0.8927; val_best_f1_score: 0.9404; train_kl_reg_loss: 216257.5807; train_edge_recon_loss: 8791164.2651; train_gene_expr_recon_loss: 8870290.9256; train_masked_gp_l1_reg_loss: 24114.3442; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17901827.0558; train_optim_loss: 17901827.0558; val_kl_reg_loss: 207911.6009; val_edge_recon_loss: 8801184.7083; val_gene_expr_recon_loss: 8771900.9167; val_masked_gp_l1_reg_loss: 24773.9863; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17805771.1250; val_optim_loss: 17805771.1250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8602; val_auprc_score: 0.9709; val_best_acc_score: 0.9009; val_best_f1_score: 0.9449; train_kl_reg_loss: 199333.4823; train_edge_recon_loss: 8742125.8814; train_gene_expr_recon_loss: 8671512.4605; train_masked_gp_l1_reg_loss: 25359.0539; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17638330.8698; train_optim_loss: 17638330.8698; val_kl_reg_loss: 193845.9043; val_edge_recon_loss: 8499121.2083; val_gene_expr_recon_loss: 8581355.6250; val_masked_gp_l1_reg_loss: 25906.1914; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17300228.8333; val_optim_loss: 17300228.8333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8629; val_auprc_score: 0.9698; val_best_acc_score: 0.9031; val_best_f1_score: 0.9451; train_kl_reg_loss: 180512.7137; train_edge_recon_loss: 8530611.2744; train_gene_expr_recon_loss: 8502458.4233; train_masked_gp_l1_reg_loss: 26353.8250; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17239936.2651; train_optim_loss: 17239936.2651; val_kl_reg_loss: 168131.7500; val_edge_recon_loss: 8570016.1250; val_gene_expr_recon_loss: 8420612.4583; val_masked_gp_l1_reg_loss: 26767.7305; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17185528.4583; val_optim_loss: 17185528.4583
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8732; val_auprc_score: 0.9716; val_best_acc_score: 0.9049; val_best_f1_score: 0.9460; train_kl_reg_loss: 162729.2533; train_edge_recon_loss: 8454437.1209; train_gene_expr_recon_loss: 8351587.9209; train_masked_gp_l1_reg_loss: 27144.6988; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16995898.9860; train_optim_loss: 16995898.9860; val_kl_reg_loss: 153258.8503; val_edge_recon_loss: 8543912.5625; val_gene_expr_recon_loss: 8288587.0208; val_masked_gp_l1_reg_loss: 27503.8105; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17013262.4167; val_optim_loss: 17013262.4167
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8883; val_auprc_score: 0.9751; val_best_acc_score: 0.9072; val_best_f1_score: 0.9477; train_kl_reg_loss: 149560.2925; train_edge_recon_loss: 8361966.5302; train_gene_expr_recon_loss: 8226309.9279; train_masked_gp_l1_reg_loss: 27878.3617; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16765715.1116; train_optim_loss: 16765715.1116; val_kl_reg_loss: 136336.5713; val_edge_recon_loss: 8261211.7292; val_gene_expr_recon_loss: 8170839.3958; val_masked_gp_l1_reg_loss: 28247.9688; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16596635.8333; val_optim_loss: 16596635.8333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8999; val_auprc_score: 0.9759; val_best_acc_score: 0.9135; val_best_f1_score: 0.9502; train_kl_reg_loss: 130340.5533; train_edge_recon_loss: 8101334.4256; train_gene_expr_recon_loss: 8111012.1930; train_masked_gp_l1_reg_loss: 28628.8502; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16371316.0326; train_optim_loss: 16371316.0326; val_kl_reg_loss: 121506.7266; val_edge_recon_loss: 8459233.2083; val_gene_expr_recon_loss: 8052588.1667; val_masked_gp_l1_reg_loss: 29024.3789; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16662352.1250; val_optim_loss: 16662352.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8995; val_auprc_score: 0.9770; val_best_acc_score: 0.9160; val_best_f1_score: 0.9520; train_kl_reg_loss: 119925.0976; train_edge_recon_loss: 8102478.3698; train_gene_expr_recon_loss: 8004887.9302; train_masked_gp_l1_reg_loss: 29422.3292; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16256713.7070; train_optim_loss: 16256713.7070; val_kl_reg_loss: 115274.6618; val_edge_recon_loss: 8355338.0833; val_gene_expr_recon_loss: 7946143.8542; val_masked_gp_l1_reg_loss: 29780.9062; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16446537.3750; val_optim_loss: 16446537.3750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9142; val_auprc_score: 0.9796; val_best_acc_score: 0.9229; val_best_f1_score: 0.9557; train_kl_reg_loss: 113269.5919; train_edge_recon_loss: 8075004.9326; train_gene_expr_recon_loss: 7904948.0047; train_masked_gp_l1_reg_loss: 30122.6149; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16123345.1814; train_optim_loss: 16123345.1814; val_kl_reg_loss: 104581.2376; val_edge_recon_loss: 8307438.3958; val_gene_expr_recon_loss: 7856110.1875; val_masked_gp_l1_reg_loss: 30460.0781; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16298589.9583; val_optim_loss: 16298589.9583
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9108; val_auprc_score: 0.9806; val_best_acc_score: 0.9251; val_best_f1_score: 0.9575; train_kl_reg_loss: 105539.5676; train_edge_recon_loss: 7927158.3674; train_gene_expr_recon_loss: 7809340.7744; train_masked_gp_l1_reg_loss: 30727.7563; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15872766.4558; train_optim_loss: 15872766.4558; val_kl_reg_loss: 95196.4528; val_edge_recon_loss: 7872613.0000; val_gene_expr_recon_loss: 7779056.3750; val_masked_gp_l1_reg_loss: 30999.9570; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15777865.7917; val_optim_loss: 15777865.7917
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9156; val_auprc_score: 0.9800; val_best_acc_score: 0.9230; val_best_f1_score: 0.9561; train_kl_reg_loss: 95372.4484; train_edge_recon_loss: 7882748.1140; train_gene_expr_recon_loss: 7731311.9581; train_masked_gp_l1_reg_loss: 31249.1415; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15740681.6605; train_optim_loss: 15740681.6605; val_kl_reg_loss: 90271.7575; val_edge_recon_loss: 8109478.7917; val_gene_expr_recon_loss: 7697633.7292; val_masked_gp_l1_reg_loss: 31460.6035; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15928845.2917; val_optim_loss: 15928845.2917
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9294; val_auprc_score: 0.9836; val_best_acc_score: 0.9295; val_best_f1_score: 0.9596; train_kl_reg_loss: 88315.6576; train_edge_recon_loss: 7943224.3093; train_gene_expr_recon_loss: 7655574.4442; train_masked_gp_l1_reg_loss: 31623.8333; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15718738.2372; train_optim_loss: 15718738.2372; val_kl_reg_loss: 78641.5114; val_edge_recon_loss: 8139310.6042; val_gene_expr_recon_loss: 7615037.7500; val_masked_gp_l1_reg_loss: 31781.4238; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15864770.9167; val_optim_loss: 15864770.9167
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9320; val_auprc_score: 0.9848; val_best_acc_score: 0.9329; val_best_f1_score: 0.9615; train_kl_reg_loss: 78532.1884; train_edge_recon_loss: 7988965.8047; train_gene_expr_recon_loss: 7585864.0977; train_masked_gp_l1_reg_loss: 31918.0590; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15685280.1535; train_optim_loss: 15685280.1535; val_kl_reg_loss: 69761.9365; val_edge_recon_loss: 7980552.2917; val_gene_expr_recon_loss: 7557374.6250; val_masked_gp_l1_reg_loss: 32026.0117; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15639714.8750; val_optim_loss: 15639714.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9390; val_auprc_score: 0.9864; val_best_acc_score: 0.9325; val_best_f1_score: 0.9610; train_kl_reg_loss: 70838.3669; train_edge_recon_loss: 7873546.6628; train_gene_expr_recon_loss: 7528096.0581; train_masked_gp_l1_reg_loss: 32054.7389; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15504535.7814; train_optim_loss: 15504535.7814; val_kl_reg_loss: 63304.0495; val_edge_recon_loss: 8099293.3750; val_gene_expr_recon_loss: 7497762.5417; val_masked_gp_l1_reg_loss: 32075.9355; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15692436.0000; val_optim_loss: 15692436.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9461; val_auprc_score: 0.9879; val_best_acc_score: 0.9360; val_best_f1_score: 0.9629; train_kl_reg_loss: 63044.0881; train_edge_recon_loss: 7834630.6256; train_gene_expr_recon_loss: 7470915.8814; train_masked_gp_l1_reg_loss: 32069.1482; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15400659.7721; train_optim_loss: 15400659.7721; val_kl_reg_loss: 58293.3503; val_edge_recon_loss: 8006341.2917; val_gene_expr_recon_loss: 7443142.0000; val_masked_gp_l1_reg_loss: 32025.1211; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15539801.7083; val_optim_loss: 15539801.7083
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9431; val_auprc_score: 0.9861; val_best_acc_score: 0.9367; val_best_f1_score: 0.9635; train_kl_reg_loss: 60579.1680; train_edge_recon_loss: 7797490.9767; train_gene_expr_recon_loss: 7422736.5047; train_masked_gp_l1_reg_loss: 31907.6822; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15312714.3488; train_optim_loss: 15312714.3488; val_kl_reg_loss: 56293.7933; val_edge_recon_loss: 7997569.8333; val_gene_expr_recon_loss: 7388793.9375; val_masked_gp_l1_reg_loss: 31750.1055; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15474407.5417; val_optim_loss: 15474407.5417
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9456; val_auprc_score: 0.9867; val_best_acc_score: 0.9373; val_best_f1_score: 0.9638; train_kl_reg_loss: 56326.4464; train_edge_recon_loss: 7751056.2093; train_gene_expr_recon_loss: 7372478.0163; train_masked_gp_l1_reg_loss: 31549.5286; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15211410.1953; train_optim_loss: 15211410.1953; val_kl_reg_loss: 54945.4668; val_edge_recon_loss: 8234733.2083; val_gene_expr_recon_loss: 7367498.7708; val_masked_gp_l1_reg_loss: 31293.4219; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15688470.5000; val_optim_loss: 15688470.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9513; val_auprc_score: 0.9893; val_best_acc_score: 0.9394; val_best_f1_score: 0.9650; train_kl_reg_loss: 53142.0144; train_edge_recon_loss: 7847359.0302; train_gene_expr_recon_loss: 7325782.4070; train_masked_gp_l1_reg_loss: 31025.8512; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15257309.3163; train_optim_loss: 15257309.3163; val_kl_reg_loss: 51183.8408; val_edge_recon_loss: 7855659.2500; val_gene_expr_recon_loss: 7314223.7083; val_masked_gp_l1_reg_loss: 30727.0605; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15251793.7917; val_optim_loss: 15251793.7917
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9529; val_auprc_score: 0.9891; val_best_acc_score: 0.9446; val_best_f1_score: 0.9680; train_kl_reg_loss: 50702.6085; train_edge_recon_loss: 7816068.1907; train_gene_expr_recon_loss: 7282408.9977; train_masked_gp_l1_reg_loss: 30406.2457; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15179586.0000; train_optim_loss: 15179586.0000; val_kl_reg_loss: 46498.7933; val_edge_recon_loss: 7743541.5208; val_gene_expr_recon_loss: 7265973.2708; val_masked_gp_l1_reg_loss: 30097.4609; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15086110.7917; val_optim_loss: 15086110.7917
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9568; val_auprc_score: 0.9903; val_best_acc_score: 0.9456; val_best_f1_score: 0.9682; train_kl_reg_loss: 47236.4546; train_edge_recon_loss: 7731263.0116; train_gene_expr_recon_loss: 7253067.0442; train_masked_gp_l1_reg_loss: 29737.7137; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15061304.2186; train_optim_loss: 15061304.2186; val_kl_reg_loss: 43789.0164; val_edge_recon_loss: 7986729.4583; val_gene_expr_recon_loss: 7225277.8958; val_masked_gp_l1_reg_loss: 29364.1016; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15285160.3750; val_optim_loss: 15285160.3750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9532; val_auprc_score: 0.9876; val_best_acc_score: 0.9442; val_best_f1_score: 0.9677; train_kl_reg_loss: 46927.1632; train_edge_recon_loss: 7795104.0860; train_gene_expr_recon_loss: 7243474.3395; train_masked_gp_l1_reg_loss: 29134.4876; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15114640.1488; train_optim_loss: 15114640.1488; val_kl_reg_loss: 19285.2481; val_edge_recon_loss: 7924016.8333; val_gene_expr_recon_loss: 7226154.5417; val_masked_gp_l1_reg_loss: 28750.7617; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15198207.6250; val_optim_loss: 15198207.6250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9555; val_auprc_score: 0.9894; val_best_acc_score: 0.9455; val_best_f1_score: 0.9685; train_kl_reg_loss: 44373.4144; train_edge_recon_loss: 7755669.3326; train_gene_expr_recon_loss: 7208012.4163; train_masked_gp_l1_reg_loss: 28327.2977; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15036382.3953; train_optim_loss: 15036382.3953; val_kl_reg_loss: 18090.0634; val_edge_recon_loss: 7899427.5417; val_gene_expr_recon_loss: 7201836.5625; val_masked_gp_l1_reg_loss: 27909.2344; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15147263.2917; val_optim_loss: 15147263.2917
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9570; val_auprc_score: 0.9895; val_best_acc_score: 0.9456; val_best_f1_score: 0.9686; train_kl_reg_loss: 40977.3256; train_edge_recon_loss: 7736793.3767; train_gene_expr_recon_loss: 7180539.0000; train_masked_gp_l1_reg_loss: 27485.2350; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14985794.9442; train_optim_loss: 14985794.9442; val_kl_reg_loss: 18299.4038; val_edge_recon_loss: 7792882.6458; val_gene_expr_recon_loss: 7167642.3333; val_masked_gp_l1_reg_loss: 27031.1719; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15005855.4167; val_optim_loss: 15005855.4167
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9647; val_auprc_score: 0.9924; val_best_acc_score: 0.9491; val_best_f1_score: 0.9706; train_kl_reg_loss: 37312.7222; train_edge_recon_loss: 7652738.6465; train_gene_expr_recon_loss: 7155064.8023; train_masked_gp_l1_reg_loss: 26608.0598; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14871724.2279; train_optim_loss: 14871724.2279; val_kl_reg_loss: 16383.9153; val_edge_recon_loss: 7738059.3958; val_gene_expr_recon_loss: 7142037.2083; val_masked_gp_l1_reg_loss: 26182.5293; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14922663.5833; val_optim_loss: 14922663.5833
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9633; val_auprc_score: 0.9918; val_best_acc_score: 0.9509; val_best_f1_score: 0.9715; train_kl_reg_loss: 34293.4295; train_edge_recon_loss: 7696857.6744; train_gene_expr_recon_loss: 7135134.0744; train_masked_gp_l1_reg_loss: 25760.4626; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14892045.6419; train_optim_loss: 14892045.6419; val_kl_reg_loss: 16377.4207; val_edge_recon_loss: 7739944.4792; val_gene_expr_recon_loss: 7114840.6458; val_masked_gp_l1_reg_loss: 25323.7988; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14896486.3750; val_optim_loss: 14896486.3750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9636; val_auprc_score: 0.9919; val_best_acc_score: 0.9498; val_best_f1_score: 0.9709; train_kl_reg_loss: 32874.1176; train_edge_recon_loss: 7750605.7674; train_gene_expr_recon_loss: 7114591.0814; train_masked_gp_l1_reg_loss: 24853.6237; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14922924.5767; train_optim_loss: 14922924.5767; val_kl_reg_loss: 16680.0048; val_edge_recon_loss: 7814707.3958; val_gene_expr_recon_loss: 7103666.3125; val_masked_gp_l1_reg_loss: 24399.2734; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14959452.6667; val_optim_loss: 14959452.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9632; val_auprc_score: 0.9920; val_best_acc_score: 0.9515; val_best_f1_score: 0.9721; train_kl_reg_loss: 31444.8973; train_edge_recon_loss: 7673881.9767; train_gene_expr_recon_loss: 7089154.6326; train_masked_gp_l1_reg_loss: 23969.9987; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14818451.4744; train_optim_loss: 14818451.4744; val_kl_reg_loss: 16660.9972; val_edge_recon_loss: 7629118.3958; val_gene_expr_recon_loss: 7080761.2292; val_masked_gp_l1_reg_loss: 23551.7793; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14750092.5000; val_optim_loss: 14750092.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9650; val_auprc_score: 0.9925; val_best_acc_score: 0.9520; val_best_f1_score: 0.9722; train_kl_reg_loss: 29927.7275; train_edge_recon_loss: 7666972.7512; train_gene_expr_recon_loss: 7072600.0023; train_masked_gp_l1_reg_loss: 23131.7299; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14792632.1953; train_optim_loss: 14792632.1953; val_kl_reg_loss: 16029.1809; val_edge_recon_loss: 7649964.2917; val_gene_expr_recon_loss: 7100219.4167; val_masked_gp_l1_reg_loss: 22762.5742; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14788975.8750; val_optim_loss: 14788975.8750
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9628; val_auprc_score: 0.9910; val_best_acc_score: 0.9509; val_best_f1_score: 0.9717; train_kl_reg_loss: 28623.3040; train_edge_recon_loss: 7732817.7093; train_gene_expr_recon_loss: 7069094.2605; train_masked_gp_l1_reg_loss: 22400.6480; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14852935.9302; train_optim_loss: 14852935.9302; val_kl_reg_loss: 15933.1108; val_edge_recon_loss: 7869855.7917; val_gene_expr_recon_loss: 7089119.4792; val_masked_gp_l1_reg_loss: 22068.8281; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14996977.5833; val_optim_loss: 14996977.5833
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9636; val_auprc_score: 0.9917; val_best_acc_score: 0.9536; val_best_f1_score: 0.9731; train_kl_reg_loss: 27902.7700; train_edge_recon_loss: 7676271.2047; train_gene_expr_recon_loss: 7062936.4326; train_masked_gp_l1_reg_loss: 21631.2412; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14788741.6279; train_optim_loss: 14788741.6279; val_kl_reg_loss: 15911.5197; val_edge_recon_loss: 7813167.6250; val_gene_expr_recon_loss: 7057532.5833; val_masked_gp_l1_reg_loss: 21228.1543; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14907839.7917; val_optim_loss: 14907839.7917
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9622; val_auprc_score: 0.9902; val_best_acc_score: 0.9510; val_best_f1_score: 0.9716; train_kl_reg_loss: 27092.7257; train_edge_recon_loss: 7667046.5837; train_gene_expr_recon_loss: 7053871.5326; train_masked_gp_l1_reg_loss: 20954.7284; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14768965.5767; train_optim_loss: 14768965.5767; val_kl_reg_loss: 16145.6112; val_edge_recon_loss: 7634751.3333; val_gene_expr_recon_loss: 7064215.0417; val_masked_gp_l1_reg_loss: 20628.7793; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14735741.0000; val_optim_loss: 14735741.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9647; val_auprc_score: 0.9904; val_best_acc_score: 0.9554; val_best_f1_score: 0.9741; train_kl_reg_loss: 26523.7694; train_edge_recon_loss: 7600563.3372; train_gene_expr_recon_loss: 7040774.5558; train_masked_gp_l1_reg_loss: 20312.0658; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14688173.7256; train_optim_loss: 14688173.7256; val_kl_reg_loss: 16433.8763; val_edge_recon_loss: 7929469.5833; val_gene_expr_recon_loss: 7038614.9792; val_masked_gp_l1_reg_loss: 19998.7109; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15004517.3333; val_optim_loss: 15004517.3333
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9640; val_auprc_score: 0.9914; val_best_acc_score: 0.9553; val_best_f1_score: 0.9741; train_kl_reg_loss: 25244.1064; train_edge_recon_loss: 7685062.9628; train_gene_expr_recon_loss: 7031687.1837; train_masked_gp_l1_reg_loss: 19702.3011; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14761696.5395; train_optim_loss: 14761696.5395; val_kl_reg_loss: 15941.9127; val_edge_recon_loss: 7761720.4375; val_gene_expr_recon_loss: 7025625.9375; val_masked_gp_l1_reg_loss: 19421.3652; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14822709.2917; val_optim_loss: 14822709.2917
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9657; val_auprc_score: 0.9917; val_best_acc_score: 0.9563; val_best_f1_score: 0.9746; train_kl_reg_loss: 23888.5727; train_edge_recon_loss: 7625451.4744; train_gene_expr_recon_loss: 7021828.9395; train_masked_gp_l1_reg_loss: 19154.1709; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14690323.1395; train_optim_loss: 14690323.1395; val_kl_reg_loss: 15625.7460; val_edge_recon_loss: 7876608.3542; val_gene_expr_recon_loss: 7026095.1250; val_masked_gp_l1_reg_loss: 18876.9902; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14937206.2500; val_optim_loss: 14937206.2500
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9688; val_auprc_score: 0.9929; val_best_acc_score: 0.9563; val_best_f1_score: 0.9745; train_kl_reg_loss: 23635.6562; train_edge_recon_loss: 7634645.9395; train_gene_expr_recon_loss: 7008999.2395; train_masked_gp_l1_reg_loss: 18643.2448; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14685924.0279; train_optim_loss: 14685924.0279; val_kl_reg_loss: 15397.5799; val_edge_recon_loss: 7934410.0208; val_gene_expr_recon_loss: 7011542.7708; val_masked_gp_l1_reg_loss: 18392.4531; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14979742.2083; val_optim_loss: 14979742.2083

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9686; val_auprc_score: 0.9923; val_best_acc_score: 0.9596; val_best_f1_score: 0.9766; train_kl_reg_loss: 23184.3097; train_edge_recon_loss: 7619497.7302; train_gene_expr_recon_loss: 6977403.2023; train_masked_gp_l1_reg_loss: 18311.4921; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14638396.7023; train_optim_loss: 14638396.7023; val_kl_reg_loss: 16319.3438; val_edge_recon_loss: 7605412.0208; val_gene_expr_recon_loss: 6983394.1042; val_masked_gp_l1_reg_loss: 18266.7695; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14623392.3333; val_optim_loss: 14623392.3333
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9715; val_auprc_score: 0.9935; val_best_acc_score: 0.9568; val_best_f1_score: 0.9749; train_kl_reg_loss: 23354.3369; train_edge_recon_loss: 7633447.7326; train_gene_expr_recon_loss: 6970652.2093; train_masked_gp_l1_reg_loss: 18247.8243; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14645702.1163; train_optim_loss: 14645702.1163; val_kl_reg_loss: 16136.4152; val_edge_recon_loss: 7823526.7708; val_gene_expr_recon_loss: 6987874.0625; val_masked_gp_l1_reg_loss: 18225.0195; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14845762.2917; val_optim_loss: 14845762.2917
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9668; val_auprc_score: 0.9926; val_best_acc_score: 0.9587; val_best_f1_score: 0.9761; train_kl_reg_loss: 23491.0760; train_edge_recon_loss: 7604981.2163; train_gene_expr_recon_loss: 6972365.2558; train_masked_gp_l1_reg_loss: 18198.6077; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14619036.1860; train_optim_loss: 14619036.1860; val_kl_reg_loss: 16354.5745; val_edge_recon_loss: 7682888.0208; val_gene_expr_recon_loss: 6982144.7292; val_masked_gp_l1_reg_loss: 18175.6816; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14699563.3750; val_optim_loss: 14699563.3750
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9696; val_auprc_score: 0.9928; val_best_acc_score: 0.9597; val_best_f1_score: 0.9766; train_kl_reg_loss: 23669.0968; train_edge_recon_loss: 7624796.4209; train_gene_expr_recon_loss: 6967928.0488; train_masked_gp_l1_reg_loss: 18147.9219; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14634541.4698; train_optim_loss: 14634541.4698; val_kl_reg_loss: 16522.8346; val_edge_recon_loss: 7802851.0833; val_gene_expr_recon_loss: 6982435.3333; val_masked_gp_l1_reg_loss: 18126.5137; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14819936.1667; val_optim_loss: 14819936.1667
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9646; val_auprc_score: 0.9905; val_best_acc_score: 0.9581; val_best_f1_score: 0.9758; train_kl_reg_loss: 23668.8568; train_edge_recon_loss: 7631601.0233; train_gene_expr_recon_loss: 6968228.0395; train_masked_gp_l1_reg_loss: 18108.7716; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14641606.6465; train_optim_loss: 14641606.6465; val_kl_reg_loss: 16247.2921; val_edge_recon_loss: 7693326.5417; val_gene_expr_recon_loss: 6983598.5208; val_masked_gp_l1_reg_loss: 18085.1367; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14711257.2917; val_optim_loss: 14711257.2917

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9696; val_auprc_score: 0.9927; val_best_acc_score: 0.9584; val_best_f1_score: 0.9758; train_kl_reg_loss: 23393.3015; train_edge_recon_loss: 7635289.8837; train_gene_expr_recon_loss: 6963969.6535; train_masked_gp_l1_reg_loss: 18072.8974; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14640725.7395; train_optim_loss: 14640725.7395; val_kl_reg_loss: 16300.4517; val_edge_recon_loss: 7730908.3750; val_gene_expr_recon_loss: 6981347.4792; val_masked_gp_l1_reg_loss: 18065.3477; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14746621.1667; val_optim_loss: 14746621.1667
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9646; val_auprc_score: 0.9907; val_best_acc_score: 0.9581; val_best_f1_score: 0.9756; train_kl_reg_loss: 23389.0821; train_edge_recon_loss: 7616889.0837; train_gene_expr_recon_loss: 6964169.3233; train_masked_gp_l1_reg_loss: 18061.5087; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14622508.9349; train_optim_loss: 14622508.9349; val_kl_reg_loss: 16355.9938; val_edge_recon_loss: 7993820.4167; val_gene_expr_recon_loss: 6979860.2083; val_masked_gp_l1_reg_loss: 18056.9902; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15008093.5833; val_optim_loss: 15008093.5833
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9647; val_auprc_score: 0.9907; val_best_acc_score: 0.9569; val_best_f1_score: 0.9750; train_kl_reg_loss: 23485.3465; train_edge_recon_loss: 7599762.5349; train_gene_expr_recon_loss: 6964389.9651; train_masked_gp_l1_reg_loss: 18053.7131; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14605691.5767; train_optim_loss: 14605691.5767; val_kl_reg_loss: 16383.3946; val_edge_recon_loss: 7774963.1042; val_gene_expr_recon_loss: 6972737.6875; val_masked_gp_l1_reg_loss: 18049.6484; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14782134.2083; val_optim_loss: 14782134.2083
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9683; val_auprc_score: 0.9923; val_best_acc_score: 0.9583; val_best_f1_score: 0.9757; train_kl_reg_loss: 23471.8468; train_edge_recon_loss: 7720189.9558; train_gene_expr_recon_loss: 6964851.1140; train_masked_gp_l1_reg_loss: 18046.8355; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14726559.8698; train_optim_loss: 14726559.8698; val_kl_reg_loss: 16350.1010; val_edge_recon_loss: 7904267.1458; val_gene_expr_recon_loss: 6965951.2917; val_masked_gp_l1_reg_loss: 18043.5195; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14904612.5417; val_optim_loss: 14904612.5417

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 60 min 39 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9676
Val AUPRC score: 0.9924
Val best accuracy score: 0.9594
Val best F1 score: 0.9765
Val gene expr MSE score: 85865.6422
Val cat covariate0 mean sim diff: -0.0008

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
