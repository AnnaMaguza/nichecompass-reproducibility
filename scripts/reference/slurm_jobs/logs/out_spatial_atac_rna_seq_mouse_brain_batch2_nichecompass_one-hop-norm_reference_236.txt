[True]
Run timestamp: 07092023_020017_236.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_236']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 18606 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 21320, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 18606
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 18606

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6802; val_auprc_score: 0.6687; val_best_acc_score: 0.5134; val_best_f1_score: 0.6716; train_kl_reg_loss: 57245.0049; train_edge_recon_loss: 3578880.2386; train_gene_expr_recon_loss: 12972000.1667; train_masked_gp_l1_reg_loss: 34868.1113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5826688.1250; train_chrom_access_recon_loss: 41156229.1515; train_global_loss: 63625910.7879; train_optim_loss: 63625910.7879; val_kl_reg_loss: 136833.0303; val_edge_recon_loss: 4064307.9062; val_gene_expr_recon_loss: 11648715.7500; val_masked_gp_l1_reg_loss: 32728.5527; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2357374.7500; val_chrom_access_recon_loss: 39608967.5000; val_global_loss: 57848927.5000; val_optim_loss: 57848927.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7279; val_auprc_score: 0.7179; val_best_acc_score: 0.5540; val_best_f1_score: 0.6854; train_kl_reg_loss: 127108.5120; train_edge_recon_loss: 3552612.1402; train_gene_expr_recon_loss: 11460663.2879; train_masked_gp_l1_reg_loss: 29325.0484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 995794.8267; train_chrom_access_recon_loss: 39259835.4545; train_global_loss: 55425339.2121; train_optim_loss: 55425339.2121; val_kl_reg_loss: 159163.6855; val_edge_recon_loss: 4061748.3438; val_gene_expr_recon_loss: 11245395.5000; val_masked_gp_l1_reg_loss: 27047.0645; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 409470.3438; val_chrom_access_recon_loss: 38893318.0000; val_global_loss: 54796143.0000; val_optim_loss: 54796143.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7864; val_auprc_score: 0.7747; val_best_acc_score: 0.7147; val_best_f1_score: 0.7103; train_kl_reg_loss: 120958.9092; train_edge_recon_loss: 3535852.3826; train_gene_expr_recon_loss: 11204820.8485; train_masked_gp_l1_reg_loss: 26561.1218; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 306367.5774; train_chrom_access_recon_loss: 38920807.8182; train_global_loss: 54115368.6061; train_optim_loss: 54115368.6061; val_kl_reg_loss: 105690.5654; val_edge_recon_loss: 4032302.7188; val_gene_expr_recon_loss: 11210909.8750; val_masked_gp_l1_reg_loss: 26666.2070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 234588.6719; val_chrom_access_recon_loss: 39603818.0000; val_global_loss: 55213976.5000; val_optim_loss: 55213976.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8262; val_auprc_score: 0.8002; val_best_acc_score: 0.7458; val_best_f1_score: 0.7794; train_kl_reg_loss: 103897.5729; train_edge_recon_loss: 3508226.3864; train_gene_expr_recon_loss: 11068435.3182; train_masked_gp_l1_reg_loss: 27419.1519; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200324.8097; train_chrom_access_recon_loss: 38624166.2424; train_global_loss: 53532469.6364; train_optim_loss: 53532469.6364; val_kl_reg_loss: 86674.8525; val_edge_recon_loss: 3731158.7188; val_gene_expr_recon_loss: 11057373.2500; val_masked_gp_l1_reg_loss: 28202.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173823.4531; val_chrom_access_recon_loss: 38617118.5000; val_global_loss: 53694350.5000; val_optim_loss: 53694350.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8247; val_auprc_score: 0.7734; val_best_acc_score: 0.7657; val_best_f1_score: 0.7892; train_kl_reg_loss: 95271.1955; train_edge_recon_loss: 3208873.8258; train_gene_expr_recon_loss: 10996595.1061; train_masked_gp_l1_reg_loss: 29226.2045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156881.9091; train_chrom_access_recon_loss: 38433811.9394; train_global_loss: 52920660.1212; train_optim_loss: 52920660.1212; val_kl_reg_loss: 125470.6787; val_edge_recon_loss: 3048135.8750; val_gene_expr_recon_loss: 10945019.8750; val_masked_gp_l1_reg_loss: 30145.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143014.1094; val_chrom_access_recon_loss: 38426864.5000; val_global_loss: 52718649.5000; val_optim_loss: 52718649.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8346; val_auprc_score: 0.7947; val_best_acc_score: 0.7770; val_best_f1_score: 0.7997; train_kl_reg_loss: 124717.3849; train_edge_recon_loss: 3001717.3295; train_gene_expr_recon_loss: 10920115.3030; train_masked_gp_l1_reg_loss: 30803.1020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133941.9483; train_chrom_access_recon_loss: 38226361.2121; train_global_loss: 52437656.1818; train_optim_loss: 52437656.1818; val_kl_reg_loss: 128527.7578; val_edge_recon_loss: 2975075.3125; val_gene_expr_recon_loss: 10842351.6250; val_masked_gp_l1_reg_loss: 31467.1348; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125968.3516; val_chrom_access_recon_loss: 38218927.0000; val_global_loss: 52322316.0000; val_optim_loss: 52322316.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8510; val_auprc_score: 0.8149; val_best_acc_score: 0.7869; val_best_f1_score: 0.8111; train_kl_reg_loss: 124849.8888; train_edge_recon_loss: 2935177.4356; train_gene_expr_recon_loss: 10861563.0455; train_masked_gp_l1_reg_loss: 31984.8849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121025.2556; train_chrom_access_recon_loss: 38026637.4545; train_global_loss: 52101237.6364; train_optim_loss: 52101237.6364; val_kl_reg_loss: 121265.3789; val_edge_recon_loss: 2967630.8438; val_gene_expr_recon_loss: 10824898.0000; val_masked_gp_l1_reg_loss: 32573.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116860.5703; val_chrom_access_recon_loss: 38019724.0000; val_global_loss: 52082951.5000; val_optim_loss: 52082951.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8494; val_auprc_score: 0.8113; val_best_acc_score: 0.7845; val_best_f1_score: 0.8166; train_kl_reg_loss: 118029.6860; train_edge_recon_loss: 2923437.9924; train_gene_expr_recon_loss: 10807542.8788; train_masked_gp_l1_reg_loss: 33056.8309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113555.7532; train_chrom_access_recon_loss: 37864203.2121; train_global_loss: 51859826.5455; train_optim_loss: 51859826.5455; val_kl_reg_loss: 114448.9824; val_edge_recon_loss: 2971926.3438; val_gene_expr_recon_loss: 10679032.2500; val_masked_gp_l1_reg_loss: 33718.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111068.6250; val_chrom_access_recon_loss: 37424846.5000; val_global_loss: 51335041.0000; val_optim_loss: 51335041.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8573; val_auprc_score: 0.8174; val_best_acc_score: 0.7931; val_best_f1_score: 0.8206; train_kl_reg_loss: 118065.3582; train_edge_recon_loss: 2877342.8674; train_gene_expr_recon_loss: 10752111.2121; train_masked_gp_l1_reg_loss: 34169.4578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108811.9304; train_chrom_access_recon_loss: 37705554.8485; train_global_loss: 51596055.8182; train_optim_loss: 51596055.8182; val_kl_reg_loss: 112131.3096; val_edge_recon_loss: 2918739.4375; val_gene_expr_recon_loss: 10674873.3750; val_masked_gp_l1_reg_loss: 34664.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107029.7734; val_chrom_access_recon_loss: 37806826.5000; val_global_loss: 51654263.5000; val_optim_loss: 51654263.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8753; val_auprc_score: 0.8373; val_best_acc_score: 0.8100; val_best_f1_score: 0.8329; train_kl_reg_loss: 115919.2138; train_edge_recon_loss: 2856452.8485; train_gene_expr_recon_loss: 10706002.7879; train_masked_gp_l1_reg_loss: 35121.1415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105325.8789; train_chrom_access_recon_loss: 37561041.5152; train_global_loss: 51379863.2121; train_optim_loss: 51379863.2121; val_kl_reg_loss: 116543.2500; val_edge_recon_loss: 2878531.7500; val_gene_expr_recon_loss: 10639143.5000; val_masked_gp_l1_reg_loss: 35690.0430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103910.3672; val_chrom_access_recon_loss: 37296829.0000; val_global_loss: 51070647.0000; val_optim_loss: 51070647.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8858; val_auprc_score: 0.8580; val_best_acc_score: 0.8122; val_best_f1_score: 0.8343; train_kl_reg_loss: 114546.5975; train_edge_recon_loss: 2844540.9962; train_gene_expr_recon_loss: 10664715.1061; train_masked_gp_l1_reg_loss: 36149.0826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102855.5676; train_chrom_access_recon_loss: 37424760.3636; train_global_loss: 51187567.5758; train_optim_loss: 51187567.5758; val_kl_reg_loss: 114385.3037; val_edge_recon_loss: 2879031.9688; val_gene_expr_recon_loss: 10565506.2500; val_masked_gp_l1_reg_loss: 36791.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101803.1172; val_chrom_access_recon_loss: 37289475.5000; val_global_loss: 50986993.0000; val_optim_loss: 50986993.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8924; val_auprc_score: 0.8572; val_best_acc_score: 0.8200; val_best_f1_score: 0.8352; train_kl_reg_loss: 114614.2299; train_edge_recon_loss: 2835839.1629; train_gene_expr_recon_loss: 10628905.9394; train_masked_gp_l1_reg_loss: 37097.1582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100810.3162; train_chrom_access_recon_loss: 37316402.2424; train_global_loss: 51033669.2727; train_optim_loss: 51033669.2727; val_kl_reg_loss: 108823.0029; val_edge_recon_loss: 2866870.6250; val_gene_expr_recon_loss: 10623091.3750; val_masked_gp_l1_reg_loss: 37618.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99844.9219; val_chrom_access_recon_loss: 37957937.0000; val_global_loss: 51694185.5000; val_optim_loss: 51694185.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8954; val_auprc_score: 0.8564; val_best_acc_score: 0.8321; val_best_f1_score: 0.8466; train_kl_reg_loss: 111692.7607; train_edge_recon_loss: 2819010.9091; train_gene_expr_recon_loss: 10594834.0000; train_masked_gp_l1_reg_loss: 38078.7206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99135.2554; train_chrom_access_recon_loss: 37153172.8485; train_global_loss: 50815924.3030; train_optim_loss: 50815924.3030; val_kl_reg_loss: 111282.3232; val_edge_recon_loss: 2876730.4375; val_gene_expr_recon_loss: 10585181.1250; val_masked_gp_l1_reg_loss: 38530.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98633.5000; val_chrom_access_recon_loss: 37767829.0000; val_global_loss: 51478186.0000; val_optim_loss: 51478186.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9035; val_auprc_score: 0.8718; val_best_acc_score: 0.8450; val_best_f1_score: 0.8543; train_kl_reg_loss: 110908.6664; train_edge_recon_loss: 2800461.1629; train_gene_expr_recon_loss: 10560905.6515; train_masked_gp_l1_reg_loss: 38920.0430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97852.6134; train_chrom_access_recon_loss: 37010356.2424; train_global_loss: 50619404.3636; train_optim_loss: 50619404.3636; val_kl_reg_loss: 114141.5977; val_edge_recon_loss: 2835032.0312; val_gene_expr_recon_loss: 10602593.2500; val_masked_gp_l1_reg_loss: 39403.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97234.1484; val_chrom_access_recon_loss: 37637335.0000; val_global_loss: 51325738.5000; val_optim_loss: 51325738.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9113; val_auprc_score: 0.8769; val_best_acc_score: 0.8517; val_best_f1_score: 0.8642; train_kl_reg_loss: 112351.8960; train_edge_recon_loss: 2787192.6136; train_gene_expr_recon_loss: 10529838.0606; train_masked_gp_l1_reg_loss: 39817.8037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96533.5360; train_chrom_access_recon_loss: 36919424.3636; train_global_loss: 50485158.3030; train_optim_loss: 50485158.3030; val_kl_reg_loss: 111636.4385; val_edge_recon_loss: 2800533.5312; val_gene_expr_recon_loss: 10512013.2500; val_masked_gp_l1_reg_loss: 40155.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96351.9922; val_chrom_access_recon_loss: 36815424.5000; val_global_loss: 50376116.0000; val_optim_loss: 50376116.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9128; val_auprc_score: 0.8812; val_best_acc_score: 0.8493; val_best_f1_score: 0.8615; train_kl_reg_loss: 110406.7911; train_edge_recon_loss: 2773670.1856; train_gene_expr_recon_loss: 10486211.2424; train_masked_gp_l1_reg_loss: 40560.5108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95511.1937; train_chrom_access_recon_loss: 36774656.3636; train_global_loss: 50281016.3030; train_optim_loss: 50281016.3030; val_kl_reg_loss: 109305.2793; val_edge_recon_loss: 2841732.7812; val_gene_expr_recon_loss: 10485381.0000; val_masked_gp_l1_reg_loss: 41000.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95045.0781; val_chrom_access_recon_loss: 37226338.0000; val_global_loss: 50798802.0000; val_optim_loss: 50798802.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9198; val_auprc_score: 0.8877; val_best_acc_score: 0.8608; val_best_f1_score: 0.8711; train_kl_reg_loss: 108760.5037; train_edge_recon_loss: 2766083.4811; train_gene_expr_recon_loss: 10472501.0152; train_masked_gp_l1_reg_loss: 41333.1533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94478.8538; train_chrom_access_recon_loss: 36721467.6364; train_global_loss: 50204624.4242; train_optim_loss: 50204624.4242; val_kl_reg_loss: 110586.2139; val_edge_recon_loss: 2766725.5625; val_gene_expr_recon_loss: 10418180.6250; val_masked_gp_l1_reg_loss: 41705.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94135.3281; val_chrom_access_recon_loss: 36874690.5000; val_global_loss: 50306022.5000; val_optim_loss: 50306022.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9220; val_auprc_score: 0.8915; val_best_acc_score: 0.8611; val_best_f1_score: 0.8699; train_kl_reg_loss: 108666.0324; train_edge_recon_loss: 2764934.8561; train_gene_expr_recon_loss: 10438884.3788; train_masked_gp_l1_reg_loss: 42053.6835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93479.6758; train_chrom_access_recon_loss: 36554197.6970; train_global_loss: 50002216.2424; train_optim_loss: 50002216.2424; val_kl_reg_loss: 107471.5576; val_edge_recon_loss: 2796165.9375; val_gene_expr_recon_loss: 10382124.3750; val_masked_gp_l1_reg_loss: 42368.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93268.4375; val_chrom_access_recon_loss: 36672759.5000; val_global_loss: 50094158.0000; val_optim_loss: 50094158.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9254; val_auprc_score: 0.8997; val_best_acc_score: 0.8630; val_best_f1_score: 0.8736; train_kl_reg_loss: 107690.7950; train_edge_recon_loss: 2751216.0758; train_gene_expr_recon_loss: 10412272.5303; train_masked_gp_l1_reg_loss: 42717.6445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92831.0072; train_chrom_access_recon_loss: 36475482.1818; train_global_loss: 49882210.1818; train_optim_loss: 49882210.1818; val_kl_reg_loss: 107215.9883; val_edge_recon_loss: 2798745.4688; val_gene_expr_recon_loss: 10498523.5000; val_masked_gp_l1_reg_loss: 43067.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92447.1250; val_chrom_access_recon_loss: 37035133.5000; val_global_loss: 50575132.0000; val_optim_loss: 50575132.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9197; val_auprc_score: 0.8854; val_best_acc_score: 0.8606; val_best_f1_score: 0.8688; train_kl_reg_loss: 105504.5388; train_edge_recon_loss: 2756235.2008; train_gene_expr_recon_loss: 10386330.5455; train_masked_gp_l1_reg_loss: 43342.1948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92021.6463; train_chrom_access_recon_loss: 36332697.2727; train_global_loss: 49716131.2727; train_optim_loss: 49716131.2727; val_kl_reg_loss: 105032.6934; val_edge_recon_loss: 2801247.8125; val_gene_expr_recon_loss: 10335767.6250; val_masked_gp_l1_reg_loss: 43641.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92060.1328; val_chrom_access_recon_loss: 36522285.5000; val_global_loss: 49900035.5000; val_optim_loss: 49900035.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9221; val_auprc_score: 0.8924; val_best_acc_score: 0.8622; val_best_f1_score: 0.8731; train_kl_reg_loss: 104932.7134; train_edge_recon_loss: 2746092.4735; train_gene_expr_recon_loss: 10367022.9242; train_masked_gp_l1_reg_loss: 43942.5397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91690.0110; train_chrom_access_recon_loss: 36205507.3939; train_global_loss: 49559187.9394; train_optim_loss: 49559187.9394; val_kl_reg_loss: 103948.6855; val_edge_recon_loss: 2777735.7188; val_gene_expr_recon_loss: 10292044.6250; val_masked_gp_l1_reg_loss: 44279.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91608.1562; val_chrom_access_recon_loss: 36222407.5000; val_global_loss: 49532023.5000; val_optim_loss: 49532023.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9258; val_auprc_score: 0.9043; val_best_acc_score: 0.8587; val_best_f1_score: 0.8696; train_kl_reg_loss: 104332.0967; train_edge_recon_loss: 2747394.0000; train_gene_expr_recon_loss: 10340625.2273; train_masked_gp_l1_reg_loss: 44578.4978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91044.3532; train_chrom_access_recon_loss: 36110213.7879; train_global_loss: 49438188.0606; train_optim_loss: 49438188.0606; val_kl_reg_loss: 104236.9756; val_edge_recon_loss: 2796382.6250; val_gene_expr_recon_loss: 10291677.7500; val_masked_gp_l1_reg_loss: 44848.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90823.5391; val_chrom_access_recon_loss: 36132452.0000; val_global_loss: 49460422.0000; val_optim_loss: 49460422.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9217; val_auprc_score: 0.8872; val_best_acc_score: 0.8581; val_best_f1_score: 0.8682; train_kl_reg_loss: 103564.0289; train_edge_recon_loss: 2748879.3068; train_gene_expr_recon_loss: 10317773.2273; train_masked_gp_l1_reg_loss: 45113.7140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90599.2185; train_chrom_access_recon_loss: 35979746.6061; train_global_loss: 49285676.1212; train_optim_loss: 49285676.1212; val_kl_reg_loss: 103173.9961; val_edge_recon_loss: 2800348.5312; val_gene_expr_recon_loss: 10383018.1250; val_masked_gp_l1_reg_loss: 45360.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90418.8828; val_chrom_access_recon_loss: 36513781.0000; val_global_loss: 49936101.5000; val_optim_loss: 49936101.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9241; val_auprc_score: 0.8986; val_best_acc_score: 0.8619; val_best_f1_score: 0.8715; train_kl_reg_loss: 102143.5322; train_edge_recon_loss: 2737998.6667; train_gene_expr_recon_loss: 10301534.7121; train_masked_gp_l1_reg_loss: 45651.3875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90177.9000; train_chrom_access_recon_loss: 35866303.6364; train_global_loss: 49143810.1212; train_optim_loss: 49143810.1212; val_kl_reg_loss: 101481.9346; val_edge_recon_loss: 2800472.0000; val_gene_expr_recon_loss: 10260127.1250; val_masked_gp_l1_reg_loss: 45925.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90118.6094; val_chrom_access_recon_loss: 36373687.0000; val_global_loss: 49671812.0000; val_optim_loss: 49671812.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9319; val_auprc_score: 0.9024; val_best_acc_score: 0.8740; val_best_f1_score: 0.8803; train_kl_reg_loss: 101639.2643; train_edge_recon_loss: 2732244.6553; train_gene_expr_recon_loss: 10276514.5758; train_masked_gp_l1_reg_loss: 46170.9742; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89787.0318; train_chrom_access_recon_loss: 35738285.9697; train_global_loss: 48984642.4848; train_optim_loss: 48984642.4848; val_kl_reg_loss: 102259.5840; val_edge_recon_loss: 2767744.3125; val_gene_expr_recon_loss: 10316826.3750; val_masked_gp_l1_reg_loss: 46370.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89649.2734; val_chrom_access_recon_loss: 36430506.5000; val_global_loss: 49753355.5000; val_optim_loss: 49753355.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9270; val_auprc_score: 0.9003; val_best_acc_score: 0.8657; val_best_f1_score: 0.8743; train_kl_reg_loss: 100751.3465; train_edge_recon_loss: 2739500.1894; train_gene_expr_recon_loss: 10259192.7273; train_masked_gp_l1_reg_loss: 46624.1683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89395.0541; train_chrom_access_recon_loss: 35651329.8182; train_global_loss: 48886793.3333; train_optim_loss: 48886793.3333; val_kl_reg_loss: 97917.3291; val_edge_recon_loss: 2802328.1875; val_gene_expr_recon_loss: 10323165.0000; val_masked_gp_l1_reg_loss: 46844.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89452.6250; val_chrom_access_recon_loss: 36261362.5000; val_global_loss: 49621070.5000; val_optim_loss: 49621070.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9353; val_auprc_score: 0.9099; val_best_acc_score: 0.8748; val_best_f1_score: 0.8809; train_kl_reg_loss: 99269.5460; train_edge_recon_loss: 2732884.4205; train_gene_expr_recon_loss: 10246143.4848; train_masked_gp_l1_reg_loss: 46201.5212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69654.0917; train_chrom_access_recon_loss: 35569046.3333; train_global_loss: 48763199.3939; train_optim_loss: 48763199.3939; val_kl_reg_loss: 101975.3926; val_edge_recon_loss: 2777916.8438; val_gene_expr_recon_loss: 10180589.3750; val_masked_gp_l1_reg_loss: 45739.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66037.9219; val_chrom_access_recon_loss: 35971800.5000; val_global_loss: 49144060.0000; val_optim_loss: 49144060.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9351; val_auprc_score: 0.9146; val_best_acc_score: 0.8713; val_best_f1_score: 0.8788; train_kl_reg_loss: 101810.6223; train_edge_recon_loss: 2731052.3826; train_gene_expr_recon_loss: 10246208.2727; train_masked_gp_l1_reg_loss: 45594.9028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65743.0915; train_chrom_access_recon_loss: 35521921.7879; train_global_loss: 48712331.3939; train_optim_loss: 48712331.3939; val_kl_reg_loss: 102841.6748; val_edge_recon_loss: 2774222.1250; val_gene_expr_recon_loss: 10255518.5000; val_masked_gp_l1_reg_loss: 45494.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65508.5898; val_chrom_access_recon_loss: 36014266.5000; val_global_loss: 49257853.5000; val_optim_loss: 49257853.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9367; val_auprc_score: 0.9144; val_best_acc_score: 0.8756; val_best_f1_score: 0.8834; train_kl_reg_loss: 102009.0785; train_edge_recon_loss: 2729344.3333; train_gene_expr_recon_loss: 10232182.8939; train_masked_gp_l1_reg_loss: 45446.9184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65293.8234; train_chrom_access_recon_loss: 35502911.9697; train_global_loss: 48677189.0909; train_optim_loss: 48677189.0909; val_kl_reg_loss: 103281.1016; val_edge_recon_loss: 2776044.7812; val_gene_expr_recon_loss: 10335712.3750; val_masked_gp_l1_reg_loss: 45418.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65143.9805; val_chrom_access_recon_loss: 36217730.5000; val_global_loss: 49543330.5000; val_optim_loss: 49543330.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9353; val_auprc_score: 0.9143; val_best_acc_score: 0.8753; val_best_f1_score: 0.8813; train_kl_reg_loss: 102000.3113; train_edge_recon_loss: 2734642.6629; train_gene_expr_recon_loss: 10237324.0152; train_masked_gp_l1_reg_loss: 45409.0428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64975.6759; train_chrom_access_recon_loss: 35504392.6667; train_global_loss: 48688744.3636; train_optim_loss: 48688744.3636; val_kl_reg_loss: 102528.8564; val_edge_recon_loss: 2758935.9375; val_gene_expr_recon_loss: 10220199.3750; val_masked_gp_l1_reg_loss: 45396.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64807.3750; val_chrom_access_recon_loss: 35697570.2500; val_global_loss: 48889438.5000; val_optim_loss: 48889438.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9356; val_auprc_score: 0.9081; val_best_acc_score: 0.8761; val_best_f1_score: 0.8817; train_kl_reg_loss: 102217.0083; train_edge_recon_loss: 2729559.9697; train_gene_expr_recon_loss: 10231051.4848; train_masked_gp_l1_reg_loss: 45399.9067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64646.8889; train_chrom_access_recon_loss: 35464833.7879; train_global_loss: 48637708.9697; train_optim_loss: 48637708.9697; val_kl_reg_loss: 102993.7363; val_edge_recon_loss: 2777921.8125; val_gene_expr_recon_loss: 10232306.3750; val_masked_gp_l1_reg_loss: 45401.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64464.8359; val_chrom_access_recon_loss: 35797646.0000; val_global_loss: 49020734.5000; val_optim_loss: 49020734.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9352; val_auprc_score: 0.9152; val_best_acc_score: 0.8745; val_best_f1_score: 0.8805; train_kl_reg_loss: 101779.1281; train_edge_recon_loss: 2742291.9356; train_gene_expr_recon_loss: 10227683.9394; train_masked_gp_l1_reg_loss: 45410.6667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64311.3575; train_chrom_access_recon_loss: 35458914.9697; train_global_loss: 48640391.9394; train_optim_loss: 48640391.9394; val_kl_reg_loss: 102914.9316; val_edge_recon_loss: 2754738.0312; val_gene_expr_recon_loss: 10210756.0000; val_masked_gp_l1_reg_loss: 45412.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64161.7188; val_chrom_access_recon_loss: 35953242.5000; val_global_loss: 49131226.5000; val_optim_loss: 49131226.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9334; val_auprc_score: 0.9123; val_best_acc_score: 0.8735; val_best_f1_score: 0.8800; train_kl_reg_loss: 102020.1849; train_edge_recon_loss: 2725971.8409; train_gene_expr_recon_loss: 10224710.8788; train_masked_gp_l1_reg_loss: 45425.1502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64003.1212; train_chrom_access_recon_loss: 35453475.3333; train_global_loss: 48615606.5455; train_optim_loss: 48615606.5455; val_kl_reg_loss: 102933.1904; val_edge_recon_loss: 2786421.7812; val_gene_expr_recon_loss: 10245853.5000; val_masked_gp_l1_reg_loss: 45431.2305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63899.8711; val_chrom_access_recon_loss: 35663605.7500; val_global_loss: 48908145.0000; val_optim_loss: 48908145.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9388; val_auprc_score: 0.9129; val_best_acc_score: 0.8794; val_best_f1_score: 0.8855; train_kl_reg_loss: 101968.4551; train_edge_recon_loss: 2730377.7273; train_gene_expr_recon_loss: 10228663.1061; train_masked_gp_l1_reg_loss: 45454.6911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63773.7599; train_chrom_access_recon_loss: 35443471.8788; train_global_loss: 48613709.6364; train_optim_loss: 48613709.6364; val_kl_reg_loss: 102904.7900; val_edge_recon_loss: 2735004.4375; val_gene_expr_recon_loss: 10198179.3750; val_masked_gp_l1_reg_loss: 45454.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63616.1055; val_chrom_access_recon_loss: 35680167.2500; val_global_loss: 48825325.5000; val_optim_loss: 48825325.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9348; val_auprc_score: 0.9135; val_best_acc_score: 0.8710; val_best_f1_score: 0.8790; train_kl_reg_loss: 101623.9379; train_edge_recon_loss: 2742242.0379; train_gene_expr_recon_loss: 10223861.3485; train_masked_gp_l1_reg_loss: 45472.6111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63497.5136; train_chrom_access_recon_loss: 35424094.2424; train_global_loss: 48600791.5758; train_optim_loss: 48600791.5758; val_kl_reg_loss: 103239.7959; val_edge_recon_loss: 2775574.6250; val_gene_expr_recon_loss: 10271762.3750; val_masked_gp_l1_reg_loss: 45497.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63382.3086; val_chrom_access_recon_loss: 36093078.5000; val_global_loss: 49352534.0000; val_optim_loss: 49352534.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9422; val_auprc_score: 0.9260; val_best_acc_score: 0.8823; val_best_f1_score: 0.8880; train_kl_reg_loss: 101571.0767; train_edge_recon_loss: 2726445.6780; train_gene_expr_recon_loss: 10223041.2879; train_masked_gp_l1_reg_loss: 45523.3568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63266.4721; train_chrom_access_recon_loss: 35411761.6364; train_global_loss: 48571609.4545; train_optim_loss: 48571609.4545; val_kl_reg_loss: 103030.7119; val_edge_recon_loss: 2750680.6875; val_gene_expr_recon_loss: 10168298.7500; val_masked_gp_l1_reg_loss: 45529.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63150.9219; val_chrom_access_recon_loss: 35684932.5000; val_global_loss: 48815623.5000; val_optim_loss: 48815623.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9349; val_auprc_score: 0.9154; val_best_acc_score: 0.8726; val_best_f1_score: 0.8801; train_kl_reg_loss: 101854.3978; train_edge_recon_loss: 2735630.6780; train_gene_expr_recon_loss: 10220507.4545; train_masked_gp_l1_reg_loss: 45553.0558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63038.5215; train_chrom_access_recon_loss: 35413258.6970; train_global_loss: 48579842.9697; train_optim_loss: 48579842.9697; val_kl_reg_loss: 102763.2900; val_edge_recon_loss: 2771382.5938; val_gene_expr_recon_loss: 10144588.7500; val_masked_gp_l1_reg_loss: 45561.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62915.7930; val_chrom_access_recon_loss: 35749302.0000; val_global_loss: 48876514.0000; val_optim_loss: 48876514.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9380; val_auprc_score: 0.9167; val_best_acc_score: 0.8735; val_best_f1_score: 0.8811; train_kl_reg_loss: 101524.6138; train_edge_recon_loss: 2730539.9811; train_gene_expr_recon_loss: 10222106.2121; train_masked_gp_l1_reg_loss: 45582.4892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62785.9905; train_chrom_access_recon_loss: 35396465.5455; train_global_loss: 48559005.0303; train_optim_loss: 48559005.0303; val_kl_reg_loss: 102964.4375; val_edge_recon_loss: 2776705.3438; val_gene_expr_recon_loss: 10302408.6250; val_masked_gp_l1_reg_loss: 45592.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62677.4961; val_chrom_access_recon_loss: 36222040.5000; val_global_loss: 49512389.5000; val_optim_loss: 49512389.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9354; val_auprc_score: 0.9109; val_best_acc_score: 0.8759; val_best_f1_score: 0.8829; train_kl_reg_loss: 101703.1791; train_edge_recon_loss: 2717837.0947; train_gene_expr_recon_loss: 10229559.4242; train_masked_gp_l1_reg_loss: 45623.2880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62558.0022; train_chrom_access_recon_loss: 35416402.7273; train_global_loss: 48573684.0000; train_optim_loss: 48573684.0000; val_kl_reg_loss: 103351.8047; val_edge_recon_loss: 2780222.1875; val_gene_expr_recon_loss: 10292286.6250; val_masked_gp_l1_reg_loss: 45629.5117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62450.2656; val_chrom_access_recon_loss: 36108659.5000; val_global_loss: 49392600.5000; val_optim_loss: 49392600.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9425; val_auprc_score: 0.9215; val_best_acc_score: 0.8804; val_best_f1_score: 0.8860; train_kl_reg_loss: 101667.6983; train_edge_recon_loss: 2725310.3712; train_gene_expr_recon_loss: 10214218.5909; train_masked_gp_l1_reg_loss: 45655.9019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62320.0878; train_chrom_access_recon_loss: 35381217.4545; train_global_loss: 48530390.0606; train_optim_loss: 48530390.0606; val_kl_reg_loss: 101064.6279; val_edge_recon_loss: 2754131.9375; val_gene_expr_recon_loss: 10242415.2500; val_masked_gp_l1_reg_loss: 45671.6367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62245.5977; val_chrom_access_recon_loss: 35965808.0000; val_global_loss: 49171338.0000; val_optim_loss: 49171338.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9311; val_auprc_score: 0.8971; val_best_acc_score: 0.8772; val_best_f1_score: 0.8830; train_kl_reg_loss: 100908.4160; train_edge_recon_loss: 2726546.7311; train_gene_expr_recon_loss: 10217401.6818; train_masked_gp_l1_reg_loss: 45606.1915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60277.9393; train_chrom_access_recon_loss: 35373596.3030; train_global_loss: 48524337.1515; train_optim_loss: 48524337.1515; val_kl_reg_loss: 102028.6025; val_edge_recon_loss: 2790305.5625; val_gene_expr_recon_loss: 10286187.3750; val_masked_gp_l1_reg_loss: 45549.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59924.5234; val_chrom_access_recon_loss: 35733824.0000; val_global_loss: 49017820.5000; val_optim_loss: 49017820.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9422; val_auprc_score: 0.9228; val_best_acc_score: 0.8847; val_best_f1_score: 0.8910; train_kl_reg_loss: 101130.2311; train_edge_recon_loss: 2729775.0833; train_gene_expr_recon_loss: 10214538.0758; train_masked_gp_l1_reg_loss: 45525.4081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59906.8768; train_chrom_access_recon_loss: 35336436.3939; train_global_loss: 48487312.0606; train_optim_loss: 48487312.0606; val_kl_reg_loss: 102966.0010; val_edge_recon_loss: 2759556.1562; val_gene_expr_recon_loss: 10242039.3750; val_masked_gp_l1_reg_loss: 45505.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59889.9883; val_chrom_access_recon_loss: 35962050.0000; val_global_loss: 49172006.5000; val_optim_loss: 49172006.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9431; val_auprc_score: 0.9207; val_best_acc_score: 0.8850; val_best_f1_score: 0.8896; train_kl_reg_loss: 101191.4128; train_edge_recon_loss: 2731344.7462; train_gene_expr_recon_loss: 10214660.2727; train_masked_gp_l1_reg_loss: 45497.0781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59879.2973; train_chrom_access_recon_loss: 35369611.6970; train_global_loss: 48522184.3030; train_optim_loss: 48522184.3030; val_kl_reg_loss: 102832.7227; val_edge_recon_loss: 2749737.2812; val_gene_expr_recon_loss: 10243256.1250; val_masked_gp_l1_reg_loss: 45488.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59863.7266; val_chrom_access_recon_loss: 36159074.5000; val_global_loss: 49360252.5000; val_optim_loss: 49360252.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9335; val_auprc_score: 0.9108; val_best_acc_score: 0.8732; val_best_f1_score: 0.8798; train_kl_reg_loss: 101223.5200; train_edge_recon_loss: 2724198.5758; train_gene_expr_recon_loss: 10205873.5152; train_masked_gp_l1_reg_loss: 45483.7013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59848.5105; train_chrom_access_recon_loss: 35319853.2727; train_global_loss: 48456481.2121; train_optim_loss: 48456481.2121; val_kl_reg_loss: 102199.8936; val_edge_recon_loss: 2765889.6250; val_gene_expr_recon_loss: 10283715.3750; val_masked_gp_l1_reg_loss: 45478.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59833.4258; val_chrom_access_recon_loss: 36044813.5000; val_global_loss: 49301930.0000; val_optim_loss: 49301930.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 46 min 56 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9378
val AUPRC score: 0.9203
val best accuracy score: 0.8700
val best F1 score: 0.8778
val target rna MSE score: 1.3853
val source rna MSE score: 0.4718
val target atac MSE score: 0.1219
val source atac MSE score: 0.0271
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
