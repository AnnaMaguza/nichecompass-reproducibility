[True]
Run timestamp: 10102023_103800_236.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_236']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6691; val_auprc_score: 0.6535; val_best_acc_score: 0.5137; val_best_f1_score: 0.6723; train_kl_reg_loss: 69557.6482; train_edge_recon_loss: 749338.2396; train_gene_expr_recon_loss: 22742445.3939; train_masked_gp_l1_reg_loss: 144388.7788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4904411.5076; train_chrom_access_recon_loss: 2960909.7727; train_global_loss: 31571051.0909; train_optim_loss: 31571051.0909; val_kl_reg_loss: 117987.2100; val_edge_recon_loss: 812959.9531; val_gene_expr_recon_loss: 21322927.0000; val_masked_gp_l1_reg_loss: 105247.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2698068.7500; val_chrom_access_recon_loss: 2817001.3750; val_global_loss: 27874192.0000; val_optim_loss: 27874192.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7086; val_auprc_score: 0.6928; val_best_acc_score: 0.5742; val_best_f1_score: 0.6937; train_kl_reg_loss: 98254.8997; train_edge_recon_loss: 752987.7992; train_gene_expr_recon_loss: 21232103.6364; train_masked_gp_l1_reg_loss: 98087.1425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1463602.5625; train_chrom_access_recon_loss: 2823407.6894; train_global_loss: 26468444.0303; train_optim_loss: 26468444.0303; val_kl_reg_loss: 87602.2109; val_edge_recon_loss: 812234.1484; val_gene_expr_recon_loss: 21062280.2500; val_masked_gp_l1_reg_loss: 95303.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 699248.2500; val_chrom_access_recon_loss: 2772677.2500; val_global_loss: 25529345.0000; val_optim_loss: 25529345.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8261; val_auprc_score: 0.8076; val_best_acc_score: 0.7539; val_best_f1_score: 0.7579; train_kl_reg_loss: 88214.9416; train_edge_recon_loss: 742819.1553; train_gene_expr_recon_loss: 21059262.6970; train_masked_gp_l1_reg_loss: 95053.1797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 459212.6719; train_chrom_access_recon_loss: 2805618.1288; train_global_loss: 25250180.5152; train_optim_loss: 25250180.5152; val_kl_reg_loss: 89890.2666; val_edge_recon_loss: 804512.1484; val_gene_expr_recon_loss: 20893731.2500; val_masked_gp_l1_reg_loss: 96082.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 306454.8125; val_chrom_access_recon_loss: 2746039.2188; val_global_loss: 24936709.0000; val_optim_loss: 24936709.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8695; val_auprc_score: 0.8364; val_best_acc_score: 0.8082; val_best_f1_score: 0.8161; train_kl_reg_loss: 79829.3396; train_edge_recon_loss: 731827.3333; train_gene_expr_recon_loss: 20913032.6364; train_masked_gp_l1_reg_loss: 97607.9802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244910.0099; train_chrom_access_recon_loss: 2787963.4205; train_global_loss: 24855170.6364; train_optim_loss: 24855170.6364; val_kl_reg_loss: 73790.3730; val_edge_recon_loss: 772539.3438; val_gene_expr_recon_loss: 20914069.7500; val_masked_gp_l1_reg_loss: 99529.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 202866.0469; val_chrom_access_recon_loss: 2750664.0000; val_global_loss: 24813459.7500; val_optim_loss: 24813459.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8914; val_auprc_score: 0.8664; val_best_acc_score: 0.8192; val_best_f1_score: 0.8344; train_kl_reg_loss: 75893.7984; train_edge_recon_loss: 704040.9441; train_gene_expr_recon_loss: 20756365.0303; train_masked_gp_l1_reg_loss: 101048.3756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 184089.2344; train_chrom_access_recon_loss: 2771560.0038; train_global_loss: 24592996.9091; train_optim_loss: 24592996.9091; val_kl_reg_loss: 80581.2783; val_edge_recon_loss: 688546.6484; val_gene_expr_recon_loss: 20698776.7500; val_masked_gp_l1_reg_loss: 102790.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168874.2344; val_chrom_access_recon_loss: 2735059.3438; val_global_loss: 24474628.5000; val_optim_loss: 24474628.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9001; val_auprc_score: 0.8699; val_best_acc_score: 0.8353; val_best_f1_score: 0.8450; train_kl_reg_loss: 87092.7878; train_edge_recon_loss: 649425.1761; train_gene_expr_recon_loss: 20618662.1818; train_masked_gp_l1_reg_loss: 103919.4161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154464.1536; train_chrom_access_recon_loss: 2757308.6174; train_global_loss: 24370872.6364; train_optim_loss: 24370872.6364; val_kl_reg_loss: 91470.7100; val_edge_recon_loss: 636860.3984; val_gene_expr_recon_loss: 20417203.5000; val_masked_gp_l1_reg_loss: 105667.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142630.6562; val_chrom_access_recon_loss: 2717159.1250; val_global_loss: 24110991.5000; val_optim_loss: 24110991.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9098; val_auprc_score: 0.8830; val_best_acc_score: 0.8415; val_best_f1_score: 0.8538; train_kl_reg_loss: 89744.5263; train_edge_recon_loss: 629560.4782; train_gene_expr_recon_loss: 20522119.0909; train_masked_gp_l1_reg_loss: 107166.8285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132901.7277; train_chrom_access_recon_loss: 2746180.5114; train_global_loss: 24227673.1818; train_optim_loss: 24227673.1818; val_kl_reg_loss: 88300.3896; val_edge_recon_loss: 632809.8047; val_gene_expr_recon_loss: 20530639.5000; val_masked_gp_l1_reg_loss: 108531.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123878.0234; val_chrom_access_recon_loss: 2723173.2500; val_global_loss: 24207333.2500; val_optim_loss: 24207333.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9038; val_auprc_score: 0.8679; val_best_acc_score: 0.8399; val_best_f1_score: 0.8543; train_kl_reg_loss: 87720.1821; train_edge_recon_loss: 623205.9583; train_gene_expr_recon_loss: 20420489.6970; train_masked_gp_l1_reg_loss: 109621.6261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117829.6796; train_chrom_access_recon_loss: 2734401.9621; train_global_loss: 24093269.4545; train_optim_loss: 24093269.4545; val_kl_reg_loss: 88210.7988; val_edge_recon_loss: 629583.4609; val_gene_expr_recon_loss: 20462283.2500; val_masked_gp_l1_reg_loss: 110908.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112742.6719; val_chrom_access_recon_loss: 2707779.7188; val_global_loss: 24111507.0000; val_optim_loss: 24111507.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9096; val_auprc_score: 0.8798; val_best_acc_score: 0.8436; val_best_f1_score: 0.8562; train_kl_reg_loss: 85860.0662; train_edge_recon_loss: 616013.1960; train_gene_expr_recon_loss: 20340305.0303; train_masked_gp_l1_reg_loss: 111472.9195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107950.9190; train_chrom_access_recon_loss: 2723650.4697; train_global_loss: 23985252.4848; train_optim_loss: 23985252.4848; val_kl_reg_loss: 83639.5645; val_edge_recon_loss: 621120.2422; val_gene_expr_recon_loss: 20498229.2500; val_masked_gp_l1_reg_loss: 112830.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104998.3359; val_chrom_access_recon_loss: 2701754.9062; val_global_loss: 24122571.5000; val_optim_loss: 24122571.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9121; val_auprc_score: 0.8797; val_best_acc_score: 0.8498; val_best_f1_score: 0.8601; train_kl_reg_loss: 83766.2608; train_edge_recon_loss: 615739.7633; train_gene_expr_recon_loss: 20254296.7273; train_masked_gp_l1_reg_loss: 113192.3764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101860.8802; train_chrom_access_recon_loss: 2712825.2879; train_global_loss: 23881681.4848; train_optim_loss: 23881681.4848; val_kl_reg_loss: 82386.6582; val_edge_recon_loss: 616025.0469; val_gene_expr_recon_loss: 20251813.2500; val_masked_gp_l1_reg_loss: 114137.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99889.8984; val_chrom_access_recon_loss: 2675158.8750; val_global_loss: 23839412.0000; val_optim_loss: 23839412.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9264; val_auprc_score: 0.9056; val_best_acc_score: 0.8576; val_best_f1_score: 0.8664; train_kl_reg_loss: 82392.7771; train_edge_recon_loss: 613069.3390; train_gene_expr_recon_loss: 20172726.7576; train_masked_gp_l1_reg_loss: 114427.0262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98238.7450; train_chrom_access_recon_loss: 2702813.5758; train_global_loss: 23783668.3333; train_optim_loss: 23783668.3333; val_kl_reg_loss: 80971.8652; val_edge_recon_loss: 611749.6172; val_gene_expr_recon_loss: 20086126.2500; val_masked_gp_l1_reg_loss: 114802.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96928.6172; val_chrom_access_recon_loss: 2680416.6562; val_global_loss: 23670994.5000; val_optim_loss: 23670994.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9276; val_auprc_score: 0.9036; val_best_acc_score: 0.8608; val_best_f1_score: 0.8677; train_kl_reg_loss: 81308.9175; train_edge_recon_loss: 609136.1515; train_gene_expr_recon_loss: 20093249.5758; train_masked_gp_l1_reg_loss: 115595.0684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95450.9998; train_chrom_access_recon_loss: 2691983.8030; train_global_loss: 23686724.4848; train_optim_loss: 23686724.4848; val_kl_reg_loss: 78956.3721; val_edge_recon_loss: 610555.3516; val_gene_expr_recon_loss: 20000956.5000; val_masked_gp_l1_reg_loss: 116633.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94394.3984; val_chrom_access_recon_loss: 2691479.1250; val_global_loss: 23592975.2500; val_optim_loss: 23592975.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9208; val_auprc_score: 0.8935; val_best_acc_score: 0.8533; val_best_f1_score: 0.8630; train_kl_reg_loss: 79906.7312; train_edge_recon_loss: 607584.9574; train_gene_expr_recon_loss: 20026653.6061; train_masked_gp_l1_reg_loss: 116765.1431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92780.5070; train_chrom_access_recon_loss: 2684023.0000; train_global_loss: 23607714.0909; train_optim_loss: 23607714.0909; val_kl_reg_loss: 79659.6748; val_edge_recon_loss: 612958.8125; val_gene_expr_recon_loss: 20043589.2500; val_masked_gp_l1_reg_loss: 117129.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91576.9375; val_chrom_access_recon_loss: 2661538.9062; val_global_loss: 23606452.7500; val_optim_loss: 23606452.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9371; val_auprc_score: 0.9204; val_best_acc_score: 0.8740; val_best_f1_score: 0.8785; train_kl_reg_loss: 78887.4723; train_edge_recon_loss: 605740.1932; train_gene_expr_recon_loss: 19988467.3939; train_masked_gp_l1_reg_loss: 117775.7892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90320.7514; train_chrom_access_recon_loss: 2678579.4621; train_global_loss: 23559771.0909; train_optim_loss: 23559771.0909; val_kl_reg_loss: 80030.3867; val_edge_recon_loss: 609769.7188; val_gene_expr_recon_loss: 19972705.5000; val_masked_gp_l1_reg_loss: 118292.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88217.9531; val_chrom_access_recon_loss: 2655037.6250; val_global_loss: 23524053.2500; val_optim_loss: 23524053.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9314; val_auprc_score: 0.9081; val_best_acc_score: 0.8662; val_best_f1_score: 0.8749; train_kl_reg_loss: 78161.9621; train_edge_recon_loss: 602996.1449; train_gene_expr_recon_loss: 19898040.3939; train_masked_gp_l1_reg_loss: 118770.7537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87894.4523; train_chrom_access_recon_loss: 2664109.0758; train_global_loss: 23449972.8182; train_optim_loss: 23449972.8182; val_kl_reg_loss: 77338.4678; val_edge_recon_loss: 609813.0703; val_gene_expr_recon_loss: 20000570.0000; val_masked_gp_l1_reg_loss: 119509.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87356.4297; val_chrom_access_recon_loss: 2657423.0938; val_global_loss: 23552010.5000; val_optim_loss: 23552010.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9370; val_auprc_score: 0.9155; val_best_acc_score: 0.8756; val_best_f1_score: 0.8835; train_kl_reg_loss: 77855.4031; train_edge_recon_loss: 600276.2566; train_gene_expr_recon_loss: 19847833.5152; train_masked_gp_l1_reg_loss: 119943.6829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86165.7768; train_chrom_access_recon_loss: 2658555.5758; train_global_loss: 23390630.4545; train_optim_loss: 23390630.4545; val_kl_reg_loss: 76004.5137; val_edge_recon_loss: 603522.8203; val_gene_expr_recon_loss: 20012588.2500; val_masked_gp_l1_reg_loss: 120511.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85955.5625; val_chrom_access_recon_loss: 2648942.0625; val_global_loss: 23547525.7500; val_optim_loss: 23547525.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9411; val_auprc_score: 0.9190; val_best_acc_score: 0.8780; val_best_f1_score: 0.8828; train_kl_reg_loss: 76651.0362; train_edge_recon_loss: 599787.5161; train_gene_expr_recon_loss: 19796448.5152; train_masked_gp_l1_reg_loss: 120844.0629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84677.8056; train_chrom_access_recon_loss: 2649951.4659; train_global_loss: 23328360.5152; train_optim_loss: 23328360.5152; val_kl_reg_loss: 78963.9189; val_edge_recon_loss: 606675.2734; val_gene_expr_recon_loss: 19885680.7500; val_masked_gp_l1_reg_loss: 121699.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84132.8516; val_chrom_access_recon_loss: 2638122.5625; val_global_loss: 23415274.5000; val_optim_loss: 23415274.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9436; val_auprc_score: 0.9271; val_best_acc_score: 0.8821; val_best_f1_score: 0.8879; train_kl_reg_loss: 76217.8563; train_edge_recon_loss: 598347.0625; train_gene_expr_recon_loss: 19715219.1818; train_masked_gp_l1_reg_loss: 122084.3067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83166.0960; train_chrom_access_recon_loss: 2636975.9053; train_global_loss: 23232010.5152; train_optim_loss: 23232010.5152; val_kl_reg_loss: 75858.1279; val_edge_recon_loss: 605419.0547; val_gene_expr_recon_loss: 19591858.0000; val_masked_gp_l1_reg_loss: 122903.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82832.4375; val_chrom_access_recon_loss: 2620103.2812; val_global_loss: 23098974.7500; val_optim_loss: 23098974.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9523; val_auprc_score: 0.9387; val_best_acc_score: 0.8920; val_best_f1_score: 0.8933; train_kl_reg_loss: 75269.1573; train_edge_recon_loss: 596034.0473; train_gene_expr_recon_loss: 19663890.7273; train_masked_gp_l1_reg_loss: 123220.6161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81899.6352; train_chrom_access_recon_loss: 2630296.5758; train_global_loss: 23170610.6364; train_optim_loss: 23170610.6364; val_kl_reg_loss: 74553.6914; val_edge_recon_loss: 598970.7344; val_gene_expr_recon_loss: 19559275.7500; val_masked_gp_l1_reg_loss: 123953.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81550.8125; val_chrom_access_recon_loss: 2614981.5000; val_global_loss: 23053285.7500; val_optim_loss: 23053285.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9468; val_auprc_score: 0.9291; val_best_acc_score: 0.8936; val_best_f1_score: 0.8970; train_kl_reg_loss: 74580.0568; train_edge_recon_loss: 597013.6619; train_gene_expr_recon_loss: 19613335.1818; train_masked_gp_l1_reg_loss: 124619.5678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81064.2402; train_chrom_access_recon_loss: 2619895.3674; train_global_loss: 23110508.1515; train_optim_loss: 23110508.1515; val_kl_reg_loss: 72664.4287; val_edge_recon_loss: 596694.6719; val_gene_expr_recon_loss: 19629865.2500; val_masked_gp_l1_reg_loss: 125280.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80625.1797; val_chrom_access_recon_loss: 2640193.2812; val_global_loss: 23145323.7500; val_optim_loss: 23145323.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9449; val_auprc_score: 0.9296; val_best_acc_score: 0.8823; val_best_f1_score: 0.8888; train_kl_reg_loss: 73544.0587; train_edge_recon_loss: 595867.6686; train_gene_expr_recon_loss: 19539810.4545; train_masked_gp_l1_reg_loss: 126073.5464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80236.6013; train_chrom_access_recon_loss: 2608543.2235; train_global_loss: 23024075.5152; train_optim_loss: 23024075.5152; val_kl_reg_loss: 73578.7754; val_edge_recon_loss: 600924.9844; val_gene_expr_recon_loss: 19558398.5000; val_masked_gp_l1_reg_loss: 126998.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80652.7656; val_chrom_access_recon_loss: 2614526.3750; val_global_loss: 23055078.5000; val_optim_loss: 23055078.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9434; val_auprc_score: 0.9266; val_best_acc_score: 0.8821; val_best_f1_score: 0.8867; train_kl_reg_loss: 73082.6925; train_edge_recon_loss: 593449.3778; train_gene_expr_recon_loss: 19491356.6970; train_masked_gp_l1_reg_loss: 127690.9331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79780.4180; train_chrom_access_recon_loss: 2600758.9735; train_global_loss: 22966119.0303; train_optim_loss: 22966119.0303; val_kl_reg_loss: 72204.8301; val_edge_recon_loss: 604383.1719; val_gene_expr_recon_loss: 19495087.7500; val_masked_gp_l1_reg_loss: 128547.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79556.7891; val_chrom_access_recon_loss: 2604201.7188; val_global_loss: 22983981.2500; val_optim_loss: 22983981.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9417; val_auprc_score: 0.9202; val_best_acc_score: 0.8829; val_best_f1_score: 0.8890; train_kl_reg_loss: 72117.4152; train_edge_recon_loss: 592685.8390; train_gene_expr_recon_loss: 19427058.8182; train_masked_gp_l1_reg_loss: 129395.8150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79263.6799; train_chrom_access_recon_loss: 2589953.3977; train_global_loss: 22890475.1212; train_optim_loss: 22890475.1212; val_kl_reg_loss: 73067.7988; val_edge_recon_loss: 602738.0234; val_gene_expr_recon_loss: 19485078.0000; val_masked_gp_l1_reg_loss: 130184.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79462.8281; val_chrom_access_recon_loss: 2589675.6562; val_global_loss: 22960205.5000; val_optim_loss: 22960205.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9443; val_auprc_score: 0.9249; val_best_acc_score: 0.8888; val_best_f1_score: 0.8945; train_kl_reg_loss: 71881.2203; train_edge_recon_loss: 592086.0843; train_gene_expr_recon_loss: 19358505.9394; train_masked_gp_l1_reg_loss: 131093.8777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79040.2126; train_chrom_access_recon_loss: 2576633.0152; train_global_loss: 22809240.1212; train_optim_loss: 22809240.1212; val_kl_reg_loss: 71174.3545; val_edge_recon_loss: 597338.9844; val_gene_expr_recon_loss: 19229732.2500; val_masked_gp_l1_reg_loss: 131898.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78926.5859; val_chrom_access_recon_loss: 2557463.1562; val_global_loss: 22666532.7500; val_optim_loss: 22666532.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9435; val_auprc_score: 0.9246; val_best_acc_score: 0.8880; val_best_f1_score: 0.8941; train_kl_reg_loss: 71748.9524; train_edge_recon_loss: 590913.8570; train_gene_expr_recon_loss: 19316458.3939; train_masked_gp_l1_reg_loss: 132803.0684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78879.3597; train_chrom_access_recon_loss: 2568001.5265; train_global_loss: 22758804.8182; train_optim_loss: 22758804.8182; val_kl_reg_loss: 71712.5098; val_edge_recon_loss: 599347.7578; val_gene_expr_recon_loss: 19580545.7500; val_masked_gp_l1_reg_loss: 133623.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79230.4297; val_chrom_access_recon_loss: 2587970.5625; val_global_loss: 23052430.5000; val_optim_loss: 23052430.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9487; val_auprc_score: 0.9321; val_best_acc_score: 0.8952; val_best_f1_score: 0.9002; train_kl_reg_loss: 71368.5846; train_edge_recon_loss: 590219.8598; train_gene_expr_recon_loss: 19257619.0303; train_masked_gp_l1_reg_loss: 134306.0701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78735.7622; train_chrom_access_recon_loss: 2559015.1250; train_global_loss: 22691264.3636; train_optim_loss: 22691264.3636; val_kl_reg_loss: 72259.3506; val_edge_recon_loss: 593984.5312; val_gene_expr_recon_loss: 19301291.0000; val_masked_gp_l1_reg_loss: 135605.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79668.6562; val_chrom_access_recon_loss: 2580690.2500; val_global_loss: 22763499.0000; val_optim_loss: 22763499.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9485; val_auprc_score: 0.9290; val_best_acc_score: 0.8936; val_best_f1_score: 0.8994; train_kl_reg_loss: 70603.5459; train_edge_recon_loss: 591175.6629; train_gene_expr_recon_loss: 19191279.5152; train_masked_gp_l1_reg_loss: 136292.2692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78887.9115; train_chrom_access_recon_loss: 2542855.4205; train_global_loss: 22611094.4242; train_optim_loss: 22611094.4242; val_kl_reg_loss: 70462.8760; val_edge_recon_loss: 596215.3750; val_gene_expr_recon_loss: 19346168.5000; val_masked_gp_l1_reg_loss: 137098.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78893.4297; val_chrom_access_recon_loss: 2544244.4062; val_global_loss: 22773083.7500; val_optim_loss: 22773083.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9464; val_auprc_score: 0.9233; val_best_acc_score: 0.8917; val_best_f1_score: 0.8965; train_kl_reg_loss: 70680.4039; train_edge_recon_loss: 588320.3693; train_gene_expr_recon_loss: 19145796.2424; train_masked_gp_l1_reg_loss: 137923.1136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78774.9641; train_chrom_access_recon_loss: 2535023.6364; train_global_loss: 22556518.4545; train_optim_loss: 22556518.4545; val_kl_reg_loss: 70268.6123; val_edge_recon_loss: 592815.4141; val_gene_expr_recon_loss: 19245554.0000; val_masked_gp_l1_reg_loss: 138926.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78787.6641; val_chrom_access_recon_loss: 2530950.5000; val_global_loss: 22657302.2500; val_optim_loss: 22657302.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9496; val_auprc_score: 0.9304; val_best_acc_score: 0.8960; val_best_f1_score: 0.8996; train_kl_reg_loss: 70205.1155; train_edge_recon_loss: 589724.6023; train_gene_expr_recon_loss: 19076572.1818; train_masked_gp_l1_reg_loss: 139702.2884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78828.7785; train_chrom_access_recon_loss: 2521202.5417; train_global_loss: 22476235.1818; train_optim_loss: 22476235.1818; val_kl_reg_loss: 71696.6064; val_edge_recon_loss: 596164.9219; val_gene_expr_recon_loss: 19267461.0000; val_masked_gp_l1_reg_loss: 140495.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79019.8828; val_chrom_access_recon_loss: 2538697.0312; val_global_loss: 22693535.0000; val_optim_loss: 22693535.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9489; val_auprc_score: 0.9326; val_best_acc_score: 0.8925; val_best_f1_score: 0.8958; train_kl_reg_loss: 70580.3388; train_edge_recon_loss: 588316.0142; train_gene_expr_recon_loss: 19030064.2121; train_masked_gp_l1_reg_loss: 141062.8826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78925.2124; train_chrom_access_recon_loss: 2511938.1970; train_global_loss: 22420887.0909; train_optim_loss: 22420887.0909; val_kl_reg_loss: 69112.1055; val_edge_recon_loss: 592527.5234; val_gene_expr_recon_loss: 19241147.7500; val_masked_gp_l1_reg_loss: 141916.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78896.9531; val_chrom_access_recon_loss: 2539444.0000; val_global_loss: 22663043.5000; val_optim_loss: 22663043.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9490; val_auprc_score: 0.9283; val_best_acc_score: 0.8952; val_best_f1_score: 0.9001; train_kl_reg_loss: 70062.1153; train_edge_recon_loss: 590966.3665; train_gene_expr_recon_loss: 18978881.7879; train_masked_gp_l1_reg_loss: 142512.2718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78884.9304; train_chrom_access_recon_loss: 2499494.5227; train_global_loss: 22360802.0303; train_optim_loss: 22360802.0303; val_kl_reg_loss: 69603.8350; val_edge_recon_loss: 593401.0156; val_gene_expr_recon_loss: 19202119.5000; val_masked_gp_l1_reg_loss: 143382.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79476.1328; val_chrom_access_recon_loss: 2531536.5625; val_global_loss: 22619519.2500; val_optim_loss: 22619519.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9485; val_auprc_score: 0.9284; val_best_acc_score: 0.8872; val_best_f1_score: 0.8934; train_kl_reg_loss: 70300.0996; train_edge_recon_loss: 589995.5540; train_gene_expr_recon_loss: 18942152.6667; train_masked_gp_l1_reg_loss: 143871.1172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79272.4826; train_chrom_access_recon_loss: 2493103.5758; train_global_loss: 22318695.5758; train_optim_loss: 22318695.5758; val_kl_reg_loss: 69391.2451; val_edge_recon_loss: 593403.5078; val_gene_expr_recon_loss: 18999340.7500; val_masked_gp_l1_reg_loss: 144186.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79735.1172; val_chrom_access_recon_loss: 2521646.8125; val_global_loss: 22407704.7500; val_optim_loss: 22407704.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9415; val_auprc_score: 0.9163; val_best_acc_score: 0.8839; val_best_f1_score: 0.8910; train_kl_reg_loss: 69995.1300; train_edge_recon_loss: 590059.2348; train_gene_expr_recon_loss: 18884948.6364; train_masked_gp_l1_reg_loss: 144959.1967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79174.3836; train_chrom_access_recon_loss: 2478221.7273; train_global_loss: 22247358.6364; train_optim_loss: 22247358.6364; val_kl_reg_loss: 71027.1475; val_edge_recon_loss: 594925.4453; val_gene_expr_recon_loss: 19201038.7500; val_masked_gp_l1_reg_loss: 145655.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79470.2734; val_chrom_access_recon_loss: 2560474.1875; val_global_loss: 22652591.7500; val_optim_loss: 22652591.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9433; val_auprc_score: 0.9264; val_best_acc_score: 0.8740; val_best_f1_score: 0.8819; train_kl_reg_loss: 70714.2583; train_edge_recon_loss: 589330.0379; train_gene_expr_recon_loss: 18837048.8485; train_masked_gp_l1_reg_loss: 146182.8575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79350.0917; train_chrom_access_recon_loss: 2469757.0038; train_global_loss: 22192383.1515; train_optim_loss: 22192383.1515; val_kl_reg_loss: 70858.9131; val_edge_recon_loss: 599574.8594; val_gene_expr_recon_loss: 19002622.5000; val_masked_gp_l1_reg_loss: 146806.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79551.1719; val_chrom_access_recon_loss: 2529640.5312; val_global_loss: 22429055.0000; val_optim_loss: 22429055.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9419; val_auprc_score: 0.9204; val_best_acc_score: 0.8842; val_best_f1_score: 0.8904; train_kl_reg_loss: 70612.7988; train_edge_recon_loss: 590344.1420; train_gene_expr_recon_loss: 18776642.0000; train_masked_gp_l1_reg_loss: 147148.4619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79553.0969; train_chrom_access_recon_loss: 2455945.1818; train_global_loss: 22120245.6970; train_optim_loss: 22120245.6970; val_kl_reg_loss: 69629.2305; val_edge_recon_loss: 601006.3516; val_gene_expr_recon_loss: 18770589.6250; val_masked_gp_l1_reg_loss: 147674.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79325.4062; val_chrom_access_recon_loss: 2522840.9375; val_global_loss: 22191065.7500; val_optim_loss: 22191065.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9415; val_auprc_score: 0.9178; val_best_acc_score: 0.8907; val_best_f1_score: 0.8958; train_kl_reg_loss: 70781.2599; train_edge_recon_loss: 590945.1629; train_gene_expr_recon_loss: 18730497.0909; train_masked_gp_l1_reg_loss: 148214.1697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79524.6437; train_chrom_access_recon_loss: 2449988.9886; train_global_loss: 22069951.3030; train_optim_loss: 22069951.3030; val_kl_reg_loss: 72850.4170; val_edge_recon_loss: 599020.6797; val_gene_expr_recon_loss: 19000238.7500; val_masked_gp_l1_reg_loss: 148275.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79697.3594; val_chrom_access_recon_loss: 2508853.3125; val_global_loss: 22408937.0000; val_optim_loss: 22408937.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9452; val_auprc_score: 0.9244; val_best_acc_score: 0.8936; val_best_f1_score: 0.8991; train_kl_reg_loss: 71775.3496; train_edge_recon_loss: 592695.9157; train_gene_expr_recon_loss: 18694573.5455; train_masked_gp_l1_reg_loss: 148528.2571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79594.5727; train_chrom_access_recon_loss: 2442417.6212; train_global_loss: 22029585.3030; train_optim_loss: 22029585.3030; val_kl_reg_loss: 71078.0273; val_edge_recon_loss: 596085.0859; val_gene_expr_recon_loss: 18970535.7500; val_masked_gp_l1_reg_loss: 149135.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80299.3516; val_chrom_access_recon_loss: 2486720.5000; val_global_loss: 22353855.5000; val_optim_loss: 22353855.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9346; val_auprc_score: 0.9061; val_best_acc_score: 0.8831; val_best_f1_score: 0.8903; train_kl_reg_loss: 71684.5929; train_edge_recon_loss: 591750.7396; train_gene_expr_recon_loss: 18627526.7273; train_masked_gp_l1_reg_loss: 149482.7959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79744.3363; train_chrom_access_recon_loss: 2430034.2538; train_global_loss: 21950223.3333; train_optim_loss: 21950223.3333; val_kl_reg_loss: 70903.7822; val_edge_recon_loss: 602448.1562; val_gene_expr_recon_loss: 18743980.0000; val_masked_gp_l1_reg_loss: 149867.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80101.3828; val_chrom_access_recon_loss: 2464126.0938; val_global_loss: 22111428.5000; val_optim_loss: 22111428.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9458; val_auprc_score: 0.9256; val_best_acc_score: 0.8890; val_best_f1_score: 0.8943; train_kl_reg_loss: 71793.1591; train_edge_recon_loss: 591409.3636; train_gene_expr_recon_loss: 18614459.6667; train_masked_gp_l1_reg_loss: 150239.6631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79901.1344; train_chrom_access_recon_loss: 2420602.0303; train_global_loss: 21928405.2727; train_optim_loss: 21928405.2727; val_kl_reg_loss: 71803.5000; val_edge_recon_loss: 598694.4297; val_gene_expr_recon_loss: 18803225.5000; val_masked_gp_l1_reg_loss: 150591.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80065.1953; val_chrom_access_recon_loss: 2494637.8438; val_global_loss: 22199019.2500; val_optim_loss: 22199019.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9396; val_auprc_score: 0.9186; val_best_acc_score: 0.8847; val_best_f1_score: 0.8907; train_kl_reg_loss: 72369.0388; train_edge_recon_loss: 591636.6420; train_gene_expr_recon_loss: 18551995.0606; train_masked_gp_l1_reg_loss: 150979.2100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80101.3680; train_chrom_access_recon_loss: 2409508.4735; train_global_loss: 21856589.7576; train_optim_loss: 21856589.7576; val_kl_reg_loss: 72660.3389; val_edge_recon_loss: 597662.5078; val_gene_expr_recon_loss: 18771013.7500; val_masked_gp_l1_reg_loss: 151358.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80274.9375; val_chrom_access_recon_loss: 2487252.9688; val_global_loss: 22160221.7500; val_optim_loss: 22160221.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9440; val_auprc_score: 0.9269; val_best_acc_score: 0.8861; val_best_f1_score: 0.8930; train_kl_reg_loss: 72124.2882; train_edge_recon_loss: 592484.7860; train_gene_expr_recon_loss: 18512299.3030; train_masked_gp_l1_reg_loss: 151650.1977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80401.1629; train_chrom_access_recon_loss: 2399607.6780; train_global_loss: 21808567.3939; train_optim_loss: 21808567.3939; val_kl_reg_loss: 74029.8223; val_edge_recon_loss: 600952.1875; val_gene_expr_recon_loss: 18783873.0000; val_masked_gp_l1_reg_loss: 152121.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80541.9141; val_chrom_access_recon_loss: 2520317.0312; val_global_loss: 22211836.2500; val_optim_loss: 22211836.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9331; val_auprc_score: 0.9069; val_best_acc_score: 0.8737; val_best_f1_score: 0.8837; train_kl_reg_loss: 72934.5956; train_edge_recon_loss: 590821.2225; train_gene_expr_recon_loss: 18472426.8485; train_masked_gp_l1_reg_loss: 152382.4522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80295.9354; train_chrom_access_recon_loss: 2390846.4962; train_global_loss: 21759707.5455; train_optim_loss: 21759707.5455; val_kl_reg_loss: 73741.0527; val_edge_recon_loss: 603106.2266; val_gene_expr_recon_loss: 18700937.7500; val_masked_gp_l1_reg_loss: 152536.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80303.6562; val_chrom_access_recon_loss: 2459973.7188; val_global_loss: 22070598.5000; val_optim_loss: 22070598.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9391; val_auprc_score: 0.9201; val_best_acc_score: 0.8823; val_best_f1_score: 0.8906; train_kl_reg_loss: 73146.5737; train_edge_recon_loss: 592299.5777; train_gene_expr_recon_loss: 18441253.2121; train_masked_gp_l1_reg_loss: 153051.7786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80606.4329; train_chrom_access_recon_loss: 2381759.5303; train_global_loss: 21722116.9697; train_optim_loss: 21722116.9697; val_kl_reg_loss: 73717.8535; val_edge_recon_loss: 601691.1328; val_gene_expr_recon_loss: 18756595.7500; val_masked_gp_l1_reg_loss: 153461.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80440.4297; val_chrom_access_recon_loss: 2466239.6875; val_global_loss: 22132146.2500; val_optim_loss: 22132146.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9415; val_auprc_score: 0.9193; val_best_acc_score: 0.8861; val_best_f1_score: 0.8926; train_kl_reg_loss: 72954.3926; train_edge_recon_loss: 591610.2992; train_gene_expr_recon_loss: 18395252.3636; train_masked_gp_l1_reg_loss: 153659.4219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80698.1083; train_chrom_access_recon_loss: 2376601.3182; train_global_loss: 21670775.7879; train_optim_loss: 21670775.7879; val_kl_reg_loss: 74249.4922; val_edge_recon_loss: 601973.7891; val_gene_expr_recon_loss: 18686969.0000; val_masked_gp_l1_reg_loss: 154228.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80638.9609; val_chrom_access_recon_loss: 2451277.5625; val_global_loss: 22049335.7500; val_optim_loss: 22049335.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9157; val_auprc_score: 0.8820; val_best_acc_score: 0.8536; val_best_f1_score: 0.8654; train_kl_reg_loss: 76578.0399; train_edge_recon_loss: 617251.8163; train_gene_expr_recon_loss: 18859588.0303; train_masked_gp_l1_reg_loss: 159203.1319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83704.2408; train_chrom_access_recon_loss: 2582233.6439; train_global_loss: 22378558.9394; train_optim_loss: 22378558.9394; val_kl_reg_loss: 78897.8076; val_edge_recon_loss: 741362.2109; val_gene_expr_recon_loss: 20119278.0000; val_masked_gp_l1_reg_loss: 195052.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100554.8828; val_chrom_access_recon_loss: 2984297.4688; val_global_loss: 24219441.7500; val_optim_loss: 24219441.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9253; val_auprc_score: 0.8915; val_best_acc_score: 0.8622; val_best_f1_score: 0.8732; train_kl_reg_loss: 49268.5083; train_edge_recon_loss: 691270.2244; train_gene_expr_recon_loss: 19598467.2727; train_masked_gp_l1_reg_loss: 221092.6385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117582.9621; train_chrom_access_recon_loss: 2724471.1250; train_global_loss: 23402152.6970; train_optim_loss: 23402152.6970; val_kl_reg_loss: 40513.0459; val_edge_recon_loss: 656266.3203; val_gene_expr_recon_loss: 19244015.5000; val_masked_gp_l1_reg_loss: 208293.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107055.6016; val_chrom_access_recon_loss: 2570845.9375; val_global_loss: 22826990.7500; val_optim_loss: 22826990.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9082; val_auprc_score: 0.8699; val_best_acc_score: 0.8487; val_best_f1_score: 0.8602; train_kl_reg_loss: 47158.2770; train_edge_recon_loss: 638555.1070; train_gene_expr_recon_loss: 19355078.9394; train_masked_gp_l1_reg_loss: 200361.3617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101278.2746; train_chrom_access_recon_loss: 2589835.3523; train_global_loss: 22932267.0303; train_optim_loss: 22932267.0303; val_kl_reg_loss: 63290.5229; val_edge_recon_loss: 663170.4531; val_gene_expr_recon_loss: 19599199.5000; val_masked_gp_l1_reg_loss: 192722.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95704.6641; val_chrom_access_recon_loss: 2689084.5312; val_global_loss: 23303171.2500; val_optim_loss: 23303171.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9227; val_auprc_score: 0.8941; val_best_acc_score: 0.8624; val_best_f1_score: 0.8711; train_kl_reg_loss: 60212.0114; train_edge_recon_loss: 651721.1222; train_gene_expr_recon_loss: 19477685.7576; train_masked_gp_l1_reg_loss: 187734.8184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98143.7098; train_chrom_access_recon_loss: 2646260.8030; train_global_loss: 23121758.1818; train_optim_loss: 23121758.1818; val_kl_reg_loss: 64767.7144; val_edge_recon_loss: 627951.3047; val_gene_expr_recon_loss: 19443514.2500; val_masked_gp_l1_reg_loss: 179616.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93732.9141; val_chrom_access_recon_loss: 2560737.5312; val_global_loss: 22970318.5000; val_optim_loss: 22970318.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9126; val_auprc_score: 0.8763; val_best_acc_score: 0.8522; val_best_f1_score: 0.8623; train_kl_reg_loss: 64200.0975; train_edge_recon_loss: 618290.0767; train_gene_expr_recon_loss: 19284015.6364; train_masked_gp_l1_reg_loss: 174038.1534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75155.0031; train_chrom_access_recon_loss: 2567033.5720; train_global_loss: 22782732.4242; train_optim_loss: 22782732.4242; val_kl_reg_loss: 64423.3833; val_edge_recon_loss: 623726.2656; val_gene_expr_recon_loss: 19387289.7500; val_masked_gp_l1_reg_loss: 171307.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70354.5781; val_chrom_access_recon_loss: 2560346.2812; val_global_loss: 22877447.2500; val_optim_loss: 22877447.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9160; val_auprc_score: 0.8752; val_best_acc_score: 0.8555; val_best_f1_score: 0.8667; train_kl_reg_loss: 64174.0057; train_edge_recon_loss: 611072.1828; train_gene_expr_recon_loss: 19225610.9697; train_masked_gp_l1_reg_loss: 170366.2753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69532.8619; train_chrom_access_recon_loss: 2552950.4167; train_global_loss: 22693706.6667; train_optim_loss: 22693706.6667; val_kl_reg_loss: 64122.3130; val_edge_recon_loss: 618892.5781; val_gene_expr_recon_loss: 19164413.5000; val_masked_gp_l1_reg_loss: 169677.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68896.0000; val_chrom_access_recon_loss: 2570859.1875; val_global_loss: 22656861.5000; val_optim_loss: 22656861.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9242; val_auprc_score: 0.8905; val_best_acc_score: 0.8627; val_best_f1_score: 0.8703; train_kl_reg_loss: 64209.4006; train_edge_recon_loss: 610499.9527; train_gene_expr_recon_loss: 19221607.5152; train_masked_gp_l1_reg_loss: 169091.7093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68483.9440; train_chrom_access_recon_loss: 2549767.9583; train_global_loss: 22683660.6061; train_optim_loss: 22683660.6061; val_kl_reg_loss: 64165.0332; val_edge_recon_loss: 609885.5859; val_gene_expr_recon_loss: 19246713.5000; val_masked_gp_l1_reg_loss: 168528.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68106.0625; val_chrom_access_recon_loss: 2529477.2188; val_global_loss: 22686875.2500; val_optim_loss: 22686875.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9188; val_auprc_score: 0.8860; val_best_acc_score: 0.8563; val_best_f1_score: 0.8640; train_kl_reg_loss: 64356.5387; train_edge_recon_loss: 609740.0133; train_gene_expr_recon_loss: 19177784.8788; train_masked_gp_l1_reg_loss: 168077.9822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67747.7321; train_chrom_access_recon_loss: 2541959.1629; train_global_loss: 22629666.0606; train_optim_loss: 22629666.0606; val_kl_reg_loss: 64409.2773; val_edge_recon_loss: 617081.7188; val_gene_expr_recon_loss: 19256969.2500; val_masked_gp_l1_reg_loss: 167698.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67464.3828; val_chrom_access_recon_loss: 2585371.9688; val_global_loss: 22758994.2500; val_optim_loss: 22758994.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 16 min 6 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9419
val AUPRC score: 0.9122
val best accuracy score: 0.8907
val best F1 score: 0.8959
val target rna MSE score: 1.3362
val source rna MSE score: 0.6522
val target atac MSE score: 0.6189
val source atac MSE score: 0.1763
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
