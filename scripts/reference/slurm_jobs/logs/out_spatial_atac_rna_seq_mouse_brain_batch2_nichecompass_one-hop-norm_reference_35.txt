[True]
Run timestamp: 29072023_104116_35.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_35']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8767; val_auprc_score: 0.8972; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 15283.4523; train_edge_recon_loss: 357137.3090; train_gene_expr_recon_loss: 8134701.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 180403061.3333; train_global_loss: 188910184.8889; train_optim_loss: 188910184.8889; val_kl_reg_loss: 25551.2207; val_edge_recon_loss: 406603.6562; val_gene_expr_recon_loss: 7699020.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 173462912.0000; val_global_loss: 181594080.0000; val_optim_loss: 181594080.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8829; val_auprc_score: 0.8975; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 23331.2711; train_edge_recon_loss: 379466.6458; train_gene_expr_recon_loss: 7633437.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 172379301.3333; train_global_loss: 180415536.0000; train_optim_loss: 180415536.0000; val_kl_reg_loss: 26709.0215; val_edge_recon_loss: 406619.8750; val_gene_expr_recon_loss: 7234434.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 171026080.0000; val_global_loss: 178693840.0000; val_optim_loss: 178693840.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8802; val_auprc_score: 0.8950; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 32986.4523; train_edge_recon_loss: 390541.5139; train_gene_expr_recon_loss: 7281810.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 170733772.4444; train_global_loss: 178439112.8889; train_optim_loss: 178439112.8889; val_kl_reg_loss: 31359.8750; val_edge_recon_loss: 406622.1562; val_gene_expr_recon_loss: 7205170.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 168339872.0000; val_global_loss: 175983024.0000; val_optim_loss: 175983024.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8672; val_auprc_score: 0.8787; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 36272.9316; train_edge_recon_loss: 396109.0833; train_gene_expr_recon_loss: 7168712.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 168077351.1111; train_global_loss: 175678448.0000; train_optim_loss: 175678448.0000; val_kl_reg_loss: 42827.2969; val_edge_recon_loss: 406622.5625; val_gene_expr_recon_loss: 6951912.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 167129984.0000; val_global_loss: 174531344.0000; val_optim_loss: 174531344.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8512; val_auprc_score: 0.8636; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 52828.0551; train_edge_recon_loss: 397531.9444; train_gene_expr_recon_loss: 6910866.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 165453669.3333; train_global_loss: 172814896.0000; train_optim_loss: 172814896.0000; val_kl_reg_loss: 61307.8203; val_edge_recon_loss: 406620.8438; val_gene_expr_recon_loss: 6849196.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 165361808.0000; val_global_loss: 172678928.0000; val_optim_loss: 172678928.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8471; val_auprc_score: 0.8625; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 63645.0833; train_edge_recon_loss: 400429.7986; train_gene_expr_recon_loss: 6809898.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 164702172.4444; train_global_loss: 171976144.0000; train_optim_loss: 171976144.0000; val_kl_reg_loss: 65420.4844; val_edge_recon_loss: 406619.1875; val_gene_expr_recon_loss: 6691396.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 164112192.0000; val_global_loss: 171275632.0000; val_optim_loss: 171275632.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8342; val_auprc_score: 0.8484; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 70472.6441; train_edge_recon_loss: 401248.9861; train_gene_expr_recon_loss: 6647156.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 163520320.0000; train_global_loss: 170639198.2222; train_optim_loss: 170639198.2222; val_kl_reg_loss: 74351.1562; val_edge_recon_loss: 406618.3750; val_gene_expr_recon_loss: 6580881.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 163605344.0000; val_global_loss: 170667200.0000; val_optim_loss: 170667200.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8383; val_auprc_score: 0.8503; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 78156.1762; train_edge_recon_loss: 401535.3472; train_gene_expr_recon_loss: 6498470.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 162883532.4444; train_global_loss: 169861694.2222; train_optim_loss: 169861694.2222; val_kl_reg_loss: 78804.8281; val_edge_recon_loss: 406613.6562; val_gene_expr_recon_loss: 6396559.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 162680032.0000; val_global_loss: 169562016.0000; val_optim_loss: 169562016.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8379; val_auprc_score: 0.8466; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 83291.4905; train_edge_recon_loss: 401694.0382; train_gene_expr_recon_loss: 6325137.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 162209560.8889; train_global_loss: 169019685.3333; train_optim_loss: 169019685.3333; val_kl_reg_loss: 79966.4219; val_edge_recon_loss: 406610.6562; val_gene_expr_recon_loss: 6223260.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 161863072.0000; val_global_loss: 168572912.0000; val_optim_loss: 168572912.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8388; val_auprc_score: 0.8492; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 80587.3229; train_edge_recon_loss: 401991.7222; train_gene_expr_recon_loss: 6135712.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 161050385.7778; train_global_loss: 167668680.8889; train_optim_loss: 167668680.8889; val_kl_reg_loss: 81340.6562; val_edge_recon_loss: 406599.0000; val_gene_expr_recon_loss: 5970226.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 161183488.0000; val_global_loss: 167641648.0000; val_optim_loss: 167641648.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8387; val_auprc_score: 0.8458; val_best_acc_score: 0.5031; val_best_f1_score: 0.6680; train_kl_reg_loss: 84703.9392; train_edge_recon_loss: 400989.5972; train_gene_expr_recon_loss: 5856925.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 161026956.4444; train_global_loss: 167369578.6667; train_optim_loss: 167369578.6667; val_kl_reg_loss: 78944.4844; val_edge_recon_loss: 406582.8750; val_gene_expr_recon_loss: 5709304.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 159743280.0000; val_global_loss: 165938112.0000; val_optim_loss: 165938112.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8270; val_auprc_score: 0.8327; val_best_acc_score: 0.5040; val_best_f1_score: 0.6685; train_kl_reg_loss: 79896.1970; train_edge_recon_loss: 400696.8958; train_gene_expr_recon_loss: 5532994.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 158759523.5556; train_global_loss: 164773112.8889; train_optim_loss: 164773112.8889; val_kl_reg_loss: 82534.6094; val_edge_recon_loss: 406569.2500; val_gene_expr_recon_loss: 5370705.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 158404560.0000; val_global_loss: 164264368.0000; val_optim_loss: 164264368.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8253; val_auprc_score: 0.8289; val_best_acc_score: 0.5131; val_best_f1_score: 0.6725; train_kl_reg_loss: 85512.0894; train_edge_recon_loss: 398581.7882; train_gene_expr_recon_loss: 5235010.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 157635155.5556; train_global_loss: 163354257.7778; train_optim_loss: 163354257.7778; val_kl_reg_loss: 78790.7344; val_edge_recon_loss: 406511.2812; val_gene_expr_recon_loss: 5105199.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 157409536.0000; val_global_loss: 163000032.0000; val_optim_loss: 163000032.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8229; val_auprc_score: 0.8229; val_best_acc_score: 0.5178; val_best_f1_score: 0.6743; train_kl_reg_loss: 82557.9010; train_edge_recon_loss: 398661.3333; train_gene_expr_recon_loss: 4945672.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156324078.2222; train_global_loss: 161750970.6667; train_optim_loss: 161750970.6667; val_kl_reg_loss: 82234.8125; val_edge_recon_loss: 406474.2812; val_gene_expr_recon_loss: 4833419.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156326400.0000; val_global_loss: 161648528.0000; val_optim_loss: 161648528.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8196; val_auprc_score: 0.8236; val_best_acc_score: 0.5272; val_best_f1_score: 0.6783; train_kl_reg_loss: 83403.0512; train_edge_recon_loss: 397842.6597; train_gene_expr_recon_loss: 4728476.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156012106.6667; train_global_loss: 161221827.5556; train_optim_loss: 161221827.5556; val_kl_reg_loss: 80108.5781; val_edge_recon_loss: 406392.7812; val_gene_expr_recon_loss: 4616076.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155424992.0000; val_global_loss: 160527568.0000; val_optim_loss: 160527568.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8132; val_auprc_score: 0.8148; val_best_acc_score: 0.5365; val_best_f1_score: 0.6820; train_kl_reg_loss: 83237.8524; train_edge_recon_loss: 396203.4618; train_gene_expr_recon_loss: 4521351.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154892056.8889; train_global_loss: 159892851.5556; train_optim_loss: 159892851.5556; val_kl_reg_loss: 78949.0312; val_edge_recon_loss: 406306.1875; val_gene_expr_recon_loss: 4460887.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154777312.0000; val_global_loss: 159723456.0000; val_optim_loss: 159723456.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8143; val_auprc_score: 0.8144; val_best_acc_score: 0.5539; val_best_f1_score: 0.6894; train_kl_reg_loss: 82944.2613; train_edge_recon_loss: 395330.4375; train_gene_expr_recon_loss: 4380136.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153968359.1111; train_global_loss: 158826769.7778; train_optim_loss: 158826769.7778; val_kl_reg_loss: 77373.0781; val_edge_recon_loss: 406186.3750; val_gene_expr_recon_loss: 4347308.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154405392.0000; val_global_loss: 159236256.0000; val_optim_loss: 159236256.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8076; val_auprc_score: 0.8063; val_best_acc_score: 0.5582; val_best_f1_score: 0.6907; train_kl_reg_loss: 81838.2804; train_edge_recon_loss: 395295.9479; train_gene_expr_recon_loss: 4271459.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153525470.2222; train_global_loss: 158274064.0000; train_optim_loss: 158274064.0000; val_kl_reg_loss: 79389.2109; val_edge_recon_loss: 406160.1875; val_gene_expr_recon_loss: 4225714.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153984448.0000; val_global_loss: 158695712.0000; val_optim_loss: 158695712.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8096; val_auprc_score: 0.8145; val_best_acc_score: 0.5684; val_best_f1_score: 0.6951; train_kl_reg_loss: 82358.9236; train_edge_recon_loss: 393847.1111; train_gene_expr_recon_loss: 4168774.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153341335.1111; train_global_loss: 157986316.4444; train_optim_loss: 157986316.4444; val_kl_reg_loss: 76996.9375; val_edge_recon_loss: 406072.0938; val_gene_expr_recon_loss: 4160873.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153855616.0000; val_global_loss: 158499552.0000; val_optim_loss: 158499552.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8101; val_auprc_score: 0.8095; val_best_acc_score: 0.5781; val_best_f1_score: 0.6991; train_kl_reg_loss: 81606.6337; train_edge_recon_loss: 392996.7917; train_gene_expr_recon_loss: 4109637.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152842433.7778; train_global_loss: 157426673.7778; train_optim_loss: 157426673.7778; val_kl_reg_loss: 75867.7188; val_edge_recon_loss: 405972.4062; val_gene_expr_recon_loss: 4095493.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153524416.0000; val_global_loss: 158101744.0000; val_optim_loss: 158101744.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8189; val_auprc_score: 0.8208; val_best_acc_score: 0.5936; val_best_f1_score: 0.7061; train_kl_reg_loss: 80172.8012; train_edge_recon_loss: 392396.6458; train_gene_expr_recon_loss: 4075385.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153378208.0000; train_global_loss: 157926163.5556; train_optim_loss: 157926163.5556; val_kl_reg_loss: 77662.9688; val_edge_recon_loss: 405882.4062; val_gene_expr_recon_loss: 4032976.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153338032.0000; val_global_loss: 157854560.0000; val_optim_loss: 157854560.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8193; val_auprc_score: 0.8257; val_best_acc_score: 0.6002; val_best_f1_score: 0.7086; train_kl_reg_loss: 79848.2622; train_edge_recon_loss: 391951.3542; train_gene_expr_recon_loss: 4054558.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153663948.4444; train_global_loss: 158190305.7778; train_optim_loss: 158190305.7778; val_kl_reg_loss: 74663.5156; val_edge_recon_loss: 405803.0312; val_gene_expr_recon_loss: 4005769.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152957632.0000; val_global_loss: 157443872.0000; val_optim_loss: 157443872.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8222; val_auprc_score: 0.8265; val_best_acc_score: 0.6108; val_best_f1_score: 0.7133; train_kl_reg_loss: 79739.5764; train_edge_recon_loss: 390744.4583; train_gene_expr_recon_loss: 3992153.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153534152.8889; train_global_loss: 157996789.3333; train_optim_loss: 157996789.3333; val_kl_reg_loss: 73581.7422; val_edge_recon_loss: 405663.0000; val_gene_expr_recon_loss: 3972758.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152912096.0000; val_global_loss: 157364096.0000; val_optim_loss: 157364096.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8301; val_auprc_score: 0.8357; val_best_acc_score: 0.6196; val_best_f1_score: 0.7164; train_kl_reg_loss: 78804.0017; train_edge_recon_loss: 390326.9028; train_gene_expr_recon_loss: 3973094.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152691994.6667; train_global_loss: 157134220.4444; train_optim_loss: 157134220.4444; val_kl_reg_loss: 71803.1094; val_edge_recon_loss: 405594.1250; val_gene_expr_recon_loss: 3960124.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152887088.0000; val_global_loss: 157324608.0000; val_optim_loss: 157324608.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8451; val_auprc_score: 0.8466; val_best_acc_score: 0.6279; val_best_f1_score: 0.7206; train_kl_reg_loss: 77619.7135; train_edge_recon_loss: 390057.3090; train_gene_expr_recon_loss: 3932077.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152598305.7778; train_global_loss: 156998058.6667; train_optim_loss: 156998058.6667; val_kl_reg_loss: 75581.2969; val_edge_recon_loss: 405446.9062; val_gene_expr_recon_loss: 3917925.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152475856.0000; val_global_loss: 156874816.0000; val_optim_loss: 156874816.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8492; val_auprc_score: 0.8473; val_best_acc_score: 0.6174; val_best_f1_score: 0.7163; train_kl_reg_loss: 79515.8845; train_edge_recon_loss: 394810.5729; train_gene_expr_recon_loss: 3935586.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153248947.5556; train_global_loss: 157658862.2222; train_optim_loss: 157658862.2222; val_kl_reg_loss: 67447.0547; val_edge_recon_loss: 405494.2500; val_gene_expr_recon_loss: 3919200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153091296.0000; val_global_loss: 157483440.0000; val_optim_loss: 157483440.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8564; val_auprc_score: 0.8517; val_best_acc_score: 0.6390; val_best_f1_score: 0.7269; train_kl_reg_loss: 79093.3108; train_edge_recon_loss: 391802.3854; train_gene_expr_recon_loss: 3907187.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153491047.1111; train_global_loss: 157869128.8889; train_optim_loss: 157869128.8889; val_kl_reg_loss: 61848.3594; val_edge_recon_loss: 405268.3750; val_gene_expr_recon_loss: 3912870.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153014368.0000; val_global_loss: 157394352.0000; val_optim_loss: 157394352.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8616; val_auprc_score: 0.8534; val_best_acc_score: 0.6555; val_best_f1_score: 0.7358; train_kl_reg_loss: 76615.6328; train_edge_recon_loss: 392587.8368; train_gene_expr_recon_loss: 3897937.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152313360.0000; train_global_loss: 156680501.3333; train_optim_loss: 156680501.3333; val_kl_reg_loss: 64359.0469; val_edge_recon_loss: 405169.9688; val_gene_expr_recon_loss: 3899647.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152942560.0000; val_global_loss: 157311744.0000; val_optim_loss: 157311744.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8716; val_auprc_score: 0.8655; val_best_acc_score: 0.6847; val_best_f1_score: 0.7522; train_kl_reg_loss: 72913.6832; train_edge_recon_loss: 397023.4618; train_gene_expr_recon_loss: 3914731.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153418547.5556; train_global_loss: 157803214.2222; train_optim_loss: 157803214.2222; val_kl_reg_loss: 59614.3750; val_edge_recon_loss: 404934.8125; val_gene_expr_recon_loss: 3881345.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152707312.0000; val_global_loss: 157053200.0000; val_optim_loss: 157053200.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8731; val_auprc_score: 0.8640; val_best_acc_score: 0.6795; val_best_f1_score: 0.7495; train_kl_reg_loss: 68715.4358; train_edge_recon_loss: 399598.2604; train_gene_expr_recon_loss: 3879171.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151917477.3333; train_global_loss: 156264965.3333; train_optim_loss: 156264965.3333; val_kl_reg_loss: 60698.9531; val_edge_recon_loss: 405037.6875; val_gene_expr_recon_loss: 3877196.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152862352.0000; val_global_loss: 157205280.0000; val_optim_loss: 157205280.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8770; val_auprc_score: 0.8732; val_best_acc_score: 0.6921; val_best_f1_score: 0.7569; train_kl_reg_loss: 69673.1146; train_edge_recon_loss: 398178.2188; train_gene_expr_recon_loss: 3869070.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152127576.8889; train_global_loss: 156464499.5556; train_optim_loss: 156464499.5556; val_kl_reg_loss: 61829.5195; val_edge_recon_loss: 404918.7500; val_gene_expr_recon_loss: 3867220.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152442528.0000; val_global_loss: 156776496.0000; val_optim_loss: 156776496.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8734; val_auprc_score: 0.8638; val_best_acc_score: 0.6784; val_best_f1_score: 0.7487; train_kl_reg_loss: 71919.3689; train_edge_recon_loss: 398765.9271; train_gene_expr_recon_loss: 3873557.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152373312.0000; train_global_loss: 156717553.7778; train_optim_loss: 156717553.7778; val_kl_reg_loss: 62082.1328; val_edge_recon_loss: 405072.4375; val_gene_expr_recon_loss: 3882010.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153012224.0000; val_global_loss: 157361392.0000; val_optim_loss: 157361392.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8756; val_auprc_score: 0.8651; val_best_acc_score: 0.6939; val_best_f1_score: 0.7579; train_kl_reg_loss: 70835.9436; train_edge_recon_loss: 397057.1632; train_gene_expr_recon_loss: 3878597.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151898640.0000; train_global_loss: 156245132.4444; train_optim_loss: 156245132.4444; val_kl_reg_loss: 63086.6094; val_edge_recon_loss: 404912.0000; val_gene_expr_recon_loss: 3875380.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152862560.0000; val_global_loss: 157205936.0000; val_optim_loss: 157205936.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8724; val_auprc_score: 0.8607; val_best_acc_score: 0.6900; val_best_f1_score: 0.7554; train_kl_reg_loss: 73008.1953; train_edge_recon_loss: 394912.1771; train_gene_expr_recon_loss: 3879746.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152409804.4444; train_global_loss: 156757470.2222; train_optim_loss: 156757470.2222; val_kl_reg_loss: 63435.2227; val_edge_recon_loss: 405005.9062; val_gene_expr_recon_loss: 3880130.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152903664.0000; val_global_loss: 157252240.0000; val_optim_loss: 157252240.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8796; val_auprc_score: 0.8738; val_best_acc_score: 0.6970; val_best_f1_score: 0.7594; train_kl_reg_loss: 71595.5339; train_edge_recon_loss: 395405.3750; train_gene_expr_recon_loss: 3900725.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152613920.0000; train_global_loss: 156981646.2222; train_optim_loss: 156981646.2222; val_kl_reg_loss: 63044.7656; val_edge_recon_loss: 404881.3438; val_gene_expr_recon_loss: 3873777.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152780096.0000; val_global_loss: 157121792.0000; val_optim_loss: 157121792.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.8784; val_auprc_score: 0.8736; val_best_acc_score: 0.6905; val_best_f1_score: 0.7555; train_kl_reg_loss: 72432.6814; train_edge_recon_loss: 395065.2361; train_gene_expr_recon_loss: 3857227.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152144108.4444; train_global_loss: 156468832.0000; train_optim_loss: 156468832.0000; val_kl_reg_loss: 63036.6875; val_edge_recon_loss: 404984.3438; val_gene_expr_recon_loss: 3873784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152758832.0000; val_global_loss: 157100640.0000; val_optim_loss: 157100640.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8800; val_auprc_score: 0.8754; val_best_acc_score: 0.6986; val_best_f1_score: 0.7602; train_kl_reg_loss: 72417.9688; train_edge_recon_loss: 395003.8924; train_gene_expr_recon_loss: 3879139.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152579991.1111; train_global_loss: 156926554.6667; train_optim_loss: 156926554.6667; val_kl_reg_loss: 62517.0156; val_edge_recon_loss: 405101.9375; val_gene_expr_recon_loss: 3867935.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152443680.0000; val_global_loss: 156779232.0000; val_optim_loss: 156779232.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.8762; val_auprc_score: 0.8691; val_best_acc_score: 0.6959; val_best_f1_score: 0.7585; train_kl_reg_loss: 72070.8142; train_edge_recon_loss: 395176.9757; train_gene_expr_recon_loss: 3867648.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152557221.3333; train_global_loss: 156892117.3333; train_optim_loss: 156892117.3333; val_kl_reg_loss: 62266.5703; val_edge_recon_loss: 404881.8125; val_gene_expr_recon_loss: 3876636.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152886560.0000; val_global_loss: 157230352.0000; val_optim_loss: 157230352.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.8776; val_auprc_score: 0.8684; val_best_acc_score: 0.6973; val_best_f1_score: 0.7594; train_kl_reg_loss: 71765.7135; train_edge_recon_loss: 395445.3715; train_gene_expr_recon_loss: 3889881.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151940021.3333; train_global_loss: 156297112.8889; train_optim_loss: 156297112.8889; val_kl_reg_loss: 61877.3828; val_edge_recon_loss: 404855.5625; val_gene_expr_recon_loss: 3869521.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152558784.0000; val_global_loss: 156895040.0000; val_optim_loss: 156895040.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 48 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
val AUROC score: 0.8752
val AUPRC score: 0.8698
val best accuracy score: 0.6861
val best F1 score: 0.7533
val target rna MSE score: 4.3244
val source rna MSE score: 4.7804
val target atac MSE score: 0.1204
val source atac MSE score: 0.0179
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
