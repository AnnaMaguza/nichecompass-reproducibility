[True]
Run timestamp: 07082023_181546_35.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_35']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8898; val_auprc_score: 0.9089; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6680.8085; train_edge_recon_loss: 35387.6341; train_gene_expr_recon_loss: 1259757.0139; train_masked_gp_l1_reg_loss: 15813.6922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119453.2726; train_chrom_access_recon_loss: 854787.8715; train_global_loss: 2291880.2778; train_optim_loss: 2291880.2778; val_kl_reg_loss: 3200.3501; val_edge_recon_loss: 40656.2578; val_gene_expr_recon_loss: 1100572.1250; val_masked_gp_l1_reg_loss: 10865.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117347.5391; val_chrom_access_recon_loss: 533705.5000; val_global_loss: 1806346.8750; val_optim_loss: 1806346.8750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8951; val_auprc_score: 0.9096; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3242.4107; train_edge_recon_loss: 35710.0243; train_gene_expr_recon_loss: 1041866.5486; train_masked_gp_l1_reg_loss: 9317.2355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116132.0156; train_chrom_access_recon_loss: 495818.3889; train_global_loss: 1702086.6111; train_optim_loss: 1702086.6111; val_kl_reg_loss: 4517.7783; val_edge_recon_loss: 40659.2383; val_gene_expr_recon_loss: 982859.5000; val_masked_gp_l1_reg_loss: 8544.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114671.6250; val_chrom_access_recon_loss: 488295.6562; val_global_loss: 1639547.8750; val_optim_loss: 1639547.8750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9000; val_auprc_score: 0.9136; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 9079.4436; train_edge_recon_loss: 37111.3772; train_gene_expr_recon_loss: 914822.1667; train_masked_gp_l1_reg_loss: 9213.7580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113521.8984; train_chrom_access_recon_loss: 481412.3264; train_global_loss: 1565160.9722; train_optim_loss: 1565160.9722; val_kl_reg_loss: 15421.7764; val_edge_recon_loss: 40661.6250; val_gene_expr_recon_loss: 849848.9375; val_masked_gp_l1_reg_loss: 9774.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112054.0234; val_chrom_access_recon_loss: 482480.6250; val_global_loss: 1510241.3750; val_optim_loss: 1510241.3750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8904; val_auprc_score: 0.9056; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16848.2292; train_edge_recon_loss: 38457.0447; train_gene_expr_recon_loss: 808160.0000; train_masked_gp_l1_reg_loss: 9810.8987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110760.7752; train_chrom_access_recon_loss: 472789.7917; train_global_loss: 1456826.7222; train_optim_loss: 1456826.7222; val_kl_reg_loss: 16759.6094; val_edge_recon_loss: 40661.2852; val_gene_expr_recon_loss: 782866.8750; val_masked_gp_l1_reg_loss: 9897.9092; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109045.2422; val_chrom_access_recon_loss: 465666.5938; val_global_loss: 1424897.5000; val_optim_loss: 1424897.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8883; val_auprc_score: 0.9020; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 18062.3939; train_edge_recon_loss: 38528.7326; train_gene_expr_recon_loss: 761787.4792; train_masked_gp_l1_reg_loss: 9969.4684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107523.2023; train_chrom_access_recon_loss: 457379.1840; train_global_loss: 1393250.4444; train_optim_loss: 1393250.4444; val_kl_reg_loss: 18938.5996; val_edge_recon_loss: 40660.4336; val_gene_expr_recon_loss: 744053.8750; val_masked_gp_l1_reg_loss: 10004.1855; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105531.5312; val_chrom_access_recon_loss: 455426.3750; val_global_loss: 1374615.0000; val_optim_loss: 1374615.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8858; val_auprc_score: 0.8945; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 19631.0206; train_edge_recon_loss: 38698.9440; train_gene_expr_recon_loss: 730331.0625; train_masked_gp_l1_reg_loss: 9975.3628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103817.9826; train_chrom_access_recon_loss: 450817.7326; train_global_loss: 1353272.0972; train_optim_loss: 1353272.0972; val_kl_reg_loss: 18988.4648; val_edge_recon_loss: 40658.3320; val_gene_expr_recon_loss: 721451.3750; val_masked_gp_l1_reg_loss: 9902.7744; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101616.9531; val_chrom_access_recon_loss: 451025.6250; val_global_loss: 1343643.5000; val_optim_loss: 1343643.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8791; val_auprc_score: 0.8861; val_best_acc_score: 0.5054; val_best_f1_score: 0.6691; train_kl_reg_loss: 19491.0430; train_edge_recon_loss: 38692.5291; train_gene_expr_recon_loss: 711115.0278; train_masked_gp_l1_reg_loss: 9853.5566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99787.8411; train_chrom_access_recon_loss: 446714.4340; train_global_loss: 1325654.4306; train_optim_loss: 1325654.4306; val_kl_reg_loss: 19206.2148; val_edge_recon_loss: 40654.5430; val_gene_expr_recon_loss: 706636.6250; val_masked_gp_l1_reg_loss: 9792.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97474.8750; val_chrom_access_recon_loss: 448026.8125; val_global_loss: 1321791.2500; val_optim_loss: 1321791.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8677; val_auprc_score: 0.8715; val_best_acc_score: 0.5132; val_best_f1_score: 0.6725; train_kl_reg_loss: 19977.2995; train_edge_recon_loss: 38754.0365; train_gene_expr_recon_loss: 698387.2292; train_masked_gp_l1_reg_loss: 9734.5669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95603.7457; train_chrom_access_recon_loss: 445198.6493; train_global_loss: 1307655.5278; train_optim_loss: 1307655.5278; val_kl_reg_loss: 19157.5977; val_edge_recon_loss: 40649.0234; val_gene_expr_recon_loss: 695794.7500; val_masked_gp_l1_reg_loss: 9657.4795; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93254.3438; val_chrom_access_recon_loss: 446139.1562; val_global_loss: 1304652.3750; val_optim_loss: 1304652.3750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8670; val_auprc_score: 0.8705; val_best_acc_score: 0.5229; val_best_f1_score: 0.6767; train_kl_reg_loss: 20044.6421; train_edge_recon_loss: 38772.9792; train_gene_expr_recon_loss: 686805.7153; train_masked_gp_l1_reg_loss: 9607.7335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91372.0521; train_chrom_access_recon_loss: 443584.8056; train_global_loss: 1290187.9028; train_optim_loss: 1290187.9028; val_kl_reg_loss: 19583.9648; val_edge_recon_loss: 40640.6445; val_gene_expr_recon_loss: 686843.0000; val_masked_gp_l1_reg_loss: 9542.8525; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89021.8359; val_chrom_access_recon_loss: 444581.2500; val_global_loss: 1290213.5000; val_optim_loss: 1290213.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8631; val_auprc_score: 0.8673; val_best_acc_score: 0.5311; val_best_f1_score: 0.6803; train_kl_reg_loss: 20415.1359; train_edge_recon_loss: 38827.0056; train_gene_expr_recon_loss: 676917.3125; train_masked_gp_l1_reg_loss: 9498.3354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87160.4766; train_chrom_access_recon_loss: 442060.3576; train_global_loss: 1274878.6250; train_optim_loss: 1274878.6250; val_kl_reg_loss: 20041.0195; val_edge_recon_loss: 40635.4727; val_gene_expr_recon_loss: 680148.6250; val_masked_gp_l1_reg_loss: 9433.4561; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84847.8047; val_chrom_access_recon_loss: 443198.6250; val_global_loss: 1278305.0000; val_optim_loss: 1278305.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8516; val_auprc_score: 0.8544; val_best_acc_score: 0.5515; val_best_f1_score: 0.6894; train_kl_reg_loss: 20527.8687; train_edge_recon_loss: 38849.8047; train_gene_expr_recon_loss: 671451.8264; train_masked_gp_l1_reg_loss: 9396.7246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83030.5625; train_chrom_access_recon_loss: 440786.7639; train_global_loss: 1264043.5556; train_optim_loss: 1264043.5556; val_kl_reg_loss: 20063.8301; val_edge_recon_loss: 40623.9375; val_gene_expr_recon_loss: 674905.3750; val_masked_gp_l1_reg_loss: 9349.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80776.7266; val_chrom_access_recon_loss: 442083.4062; val_global_loss: 1267803.0000; val_optim_loss: 1267803.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8355; val_auprc_score: 0.8339; val_best_acc_score: 0.5740; val_best_f1_score: 0.6994; train_kl_reg_loss: 20442.8134; train_edge_recon_loss: 38882.9444; train_gene_expr_recon_loss: 669641.1042; train_masked_gp_l1_reg_loss: 9312.9261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79010.2179; train_chrom_access_recon_loss: 440152.4306; train_global_loss: 1257442.4167; train_optim_loss: 1257442.4167; val_kl_reg_loss: 19544.8613; val_edge_recon_loss: 40609.9766; val_gene_expr_recon_loss: 671237.3750; val_masked_gp_l1_reg_loss: 9268.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76821.1328; val_chrom_access_recon_loss: 441040.1875; val_global_loss: 1258522.2500; val_optim_loss: 1258522.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8381; val_auprc_score: 0.8356; val_best_acc_score: 0.5900; val_best_f1_score: 0.7071; train_kl_reg_loss: 20348.4952; train_edge_recon_loss: 38886.0846; train_gene_expr_recon_loss: 662660.6389; train_masked_gp_l1_reg_loss: 9247.5011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75118.0503; train_chrom_access_recon_loss: 437508.1042; train_global_loss: 1243768.8611; train_optim_loss: 1243768.8611; val_kl_reg_loss: 20015.9023; val_edge_recon_loss: 40603.1680; val_gene_expr_recon_loss: 667404.8750; val_masked_gp_l1_reg_loss: 9214.9180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73010.0625; val_chrom_access_recon_loss: 439936.8125; val_global_loss: 1250185.7500; val_optim_loss: 1250185.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8436; val_auprc_score: 0.8404; val_best_acc_score: 0.6311; val_best_f1_score: 0.7271; train_kl_reg_loss: 20043.6608; train_edge_recon_loss: 38855.4240; train_gene_expr_recon_loss: 664591.0972; train_masked_gp_l1_reg_loss: 9190.0793; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71367.5243; train_chrom_access_recon_loss: 436928.6285; train_global_loss: 1240976.4028; train_optim_loss: 1240976.4028; val_kl_reg_loss: 19344.0859; val_edge_recon_loss: 40581.1562; val_gene_expr_recon_loss: 664574.3750; val_masked_gp_l1_reg_loss: 9159.9619; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69337.9219; val_chrom_access_recon_loss: 438908.4062; val_global_loss: 1241905.8750; val_optim_loss: 1241905.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8454; val_auprc_score: 0.8400; val_best_acc_score: 0.6568; val_best_f1_score: 0.7390; train_kl_reg_loss: 19706.0918; train_edge_recon_loss: 38819.3290; train_gene_expr_recon_loss: 656963.2153; train_masked_gp_l1_reg_loss: 9136.7087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67767.7335; train_chrom_access_recon_loss: 436606.2708; train_global_loss: 1228999.3472; train_optim_loss: 1228999.3472; val_kl_reg_loss: 18847.0195; val_edge_recon_loss: 40561.4453; val_gene_expr_recon_loss: 662359.7500; val_masked_gp_l1_reg_loss: 9110.2363; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65829.2656; val_chrom_access_recon_loss: 438631.3438; val_global_loss: 1235339.0000; val_optim_loss: 1235339.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8672; val_auprc_score: 0.8658; val_best_acc_score: 0.7065; val_best_f1_score: 0.7646; train_kl_reg_loss: 19321.0673; train_edge_recon_loss: 38795.4757; train_gene_expr_recon_loss: 659202.0764; train_masked_gp_l1_reg_loss: 9097.5026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64334.7266; train_chrom_access_recon_loss: 437101.9514; train_global_loss: 1227852.8056; train_optim_loss: 1227852.8056; val_kl_reg_loss: 18425.7422; val_edge_recon_loss: 40524.9141; val_gene_expr_recon_loss: 660193.5000; val_masked_gp_l1_reg_loss: 9082.3311; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62494.9141; val_chrom_access_recon_loss: 437862.4375; val_global_loss: 1228583.7500; val_optim_loss: 1228583.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8887; val_auprc_score: 0.8828; val_best_acc_score: 0.7650; val_best_f1_score: 0.7986; train_kl_reg_loss: 18968.4501; train_edge_recon_loss: 38750.9696; train_gene_expr_recon_loss: 650404.5278; train_masked_gp_l1_reg_loss: 9073.7041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61085.4132; train_chrom_access_recon_loss: 436073.1771; train_global_loss: 1214356.2500; train_optim_loss: 1214356.2500; val_kl_reg_loss: 18145.2910; val_edge_recon_loss: 40476.4492; val_gene_expr_recon_loss: 658207.5000; val_masked_gp_l1_reg_loss: 9054.3818; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59345.0430; val_chrom_access_recon_loss: 437097.1250; val_global_loss: 1222325.7500; val_optim_loss: 1222325.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8900; val_auprc_score: 0.8810; val_best_acc_score: 0.7933; val_best_f1_score: 0.8133; train_kl_reg_loss: 18817.3874; train_edge_recon_loss: 38708.2487; train_gene_expr_recon_loss: 655163.6389; train_masked_gp_l1_reg_loss: 9043.9175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58011.0716; train_chrom_access_recon_loss: 435994.2986; train_global_loss: 1215738.5556; train_optim_loss: 1215738.5556; val_kl_reg_loss: 17696.7656; val_edge_recon_loss: 40415.1758; val_gene_expr_recon_loss: 656770.5000; val_masked_gp_l1_reg_loss: 9025.2285; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56368.4297; val_chrom_access_recon_loss: 436431.5000; val_global_loss: 1216707.6250; val_optim_loss: 1216707.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9045; val_auprc_score: 0.8962; val_best_acc_score: 0.8255; val_best_f1_score: 0.8350; train_kl_reg_loss: 18375.3472; train_edge_recon_loss: 38635.0547; train_gene_expr_recon_loss: 649995.6458; train_masked_gp_l1_reg_loss: 9018.5305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55113.2105; train_chrom_access_recon_loss: 432540.2847; train_global_loss: 1203678.0833; train_optim_loss: 1203678.0833; val_kl_reg_loss: 17751.5488; val_edge_recon_loss: 40356.9023; val_gene_expr_recon_loss: 654701.9375; val_masked_gp_l1_reg_loss: 9012.2832; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53567.4141; val_chrom_access_recon_loss: 435654.8438; val_global_loss: 1211045.0000; val_optim_loss: 1211045.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9081; val_auprc_score: 0.8963; val_best_acc_score: 0.8324; val_best_f1_score: 0.8353; train_kl_reg_loss: 18243.3937; train_edge_recon_loss: 38577.7678; train_gene_expr_recon_loss: 646792.1389; train_masked_gp_l1_reg_loss: 9010.7947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52389.6107; train_chrom_access_recon_loss: 433596.4931; train_global_loss: 1198610.2083; train_optim_loss: 1198610.2083; val_kl_reg_loss: 17099.2617; val_edge_recon_loss: 40275.0742; val_gene_expr_recon_loss: 653982.0000; val_masked_gp_l1_reg_loss: 9000.4834; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50941.3867; val_chrom_access_recon_loss: 434802.5938; val_global_loss: 1206100.7500; val_optim_loss: 1206100.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9110; val_auprc_score: 0.9038; val_best_acc_score: 0.8319; val_best_f1_score: 0.8342; train_kl_reg_loss: 17948.6892; train_edge_recon_loss: 38531.8199; train_gene_expr_recon_loss: 646532.4028; train_masked_gp_l1_reg_loss: 8994.4481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49842.3112; train_chrom_access_recon_loss: 431658.4792; train_global_loss: 1193508.1528; train_optim_loss: 1193508.1528; val_kl_reg_loss: 17498.0508; val_edge_recon_loss: 40261.7344; val_gene_expr_recon_loss: 651853.9375; val_masked_gp_l1_reg_loss: 8984.0566; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48489.2383; val_chrom_access_recon_loss: 434392.0312; val_global_loss: 1201479.1250; val_optim_loss: 1201479.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9179; val_auprc_score: 0.9100; val_best_acc_score: 0.8363; val_best_f1_score: 0.8341; train_kl_reg_loss: 17718.2348; train_edge_recon_loss: 38473.3624; train_gene_expr_recon_loss: 645356.1458; train_masked_gp_l1_reg_loss: 8974.0056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47455.4301; train_chrom_access_recon_loss: 432275.7674; train_global_loss: 1190252.9722; train_optim_loss: 1190252.9722; val_kl_reg_loss: 16953.9453; val_edge_recon_loss: 40179.1055; val_gene_expr_recon_loss: 651032.6250; val_masked_gp_l1_reg_loss: 8965.2334; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46181.0234; val_chrom_access_recon_loss: 433755.8125; val_global_loss: 1197067.7500; val_optim_loss: 1197067.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9206; val_auprc_score: 0.9094; val_best_acc_score: 0.8393; val_best_f1_score: 0.8339; train_kl_reg_loss: 17553.4423; train_edge_recon_loss: 38429.0877; train_gene_expr_recon_loss: 643903.7917; train_masked_gp_l1_reg_loss: 8957.8367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45217.7079; train_chrom_access_recon_loss: 429706.0451; train_global_loss: 1183767.8889; train_optim_loss: 1183767.8889; val_kl_reg_loss: 16979.6289; val_edge_recon_loss: 40119.1016; val_gene_expr_recon_loss: 649717.4375; val_masked_gp_l1_reg_loss: 8951.2607; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44032.1680; val_chrom_access_recon_loss: 433110.2188; val_global_loss: 1192909.8750; val_optim_loss: 1192909.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9225; val_auprc_score: 0.9160; val_best_acc_score: 0.8341; val_best_f1_score: 0.8269; train_kl_reg_loss: 17432.2580; train_edge_recon_loss: 38381.4336; train_gene_expr_recon_loss: 646979.0417; train_masked_gp_l1_reg_loss: 8951.0755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43131.4093; train_chrom_access_recon_loss: 430586.7882; train_global_loss: 1185462.0000; train_optim_loss: 1185462.0000; val_kl_reg_loss: 16675.5625; val_edge_recon_loss: 40065.7383; val_gene_expr_recon_loss: 648760.3125; val_masked_gp_l1_reg_loss: 8945.9414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42021.7773; val_chrom_access_recon_loss: 432342.1875; val_global_loss: 1188811.5000; val_optim_loss: 1188811.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9282; val_auprc_score: 0.9212; val_best_acc_score: 0.8371; val_best_f1_score: 0.8265; train_kl_reg_loss: 17259.9872; train_edge_recon_loss: 38332.6471; train_gene_expr_recon_loss: 642522.9792; train_masked_gp_l1_reg_loss: 8945.6795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41180.4523; train_chrom_access_recon_loss: 428716.2917; train_global_loss: 1176958.0556; train_optim_loss: 1176958.0556; val_kl_reg_loss: 16327.7402; val_edge_recon_loss: 39989.6406; val_gene_expr_recon_loss: 648223.1250; val_masked_gp_l1_reg_loss: 8942.7451; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40137.6992; val_chrom_access_recon_loss: 431587.4375; val_global_loss: 1185208.3750; val_optim_loss: 1185208.3750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9284; val_auprc_score: 0.9190; val_best_acc_score: 0.8573; val_best_f1_score: 0.8605; train_kl_reg_loss: 13862.2541; train_edge_recon_loss: 39707.1311; train_gene_expr_recon_loss: 930988.8750; train_masked_gp_l1_reg_loss: 9147.6746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39249.9440; train_chrom_access_recon_loss: 453424.9236; train_global_loss: 1486380.7778; train_optim_loss: 1486380.7778; val_kl_reg_loss: 12416.6934; val_edge_recon_loss: 40257.0234; val_gene_expr_recon_loss: 929532.1250; val_masked_gp_l1_reg_loss: 9534.0986; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38085.1406; val_chrom_access_recon_loss: 454995.1562; val_global_loss: 1484820.2500; val_optim_loss: 1484820.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9291; val_auprc_score: 0.9150; val_best_acc_score: 0.8573; val_best_f1_score: 0.8606; train_kl_reg_loss: 12883.9831; train_edge_recon_loss: 39734.7227; train_gene_expr_recon_loss: 919191.4861; train_masked_gp_l1_reg_loss: 9870.7298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37137.8451; train_chrom_access_recon_loss: 451318.9201; train_global_loss: 1470137.6944; train_optim_loss: 1470137.6944; val_kl_reg_loss: 12253.2402; val_edge_recon_loss: 40247.6992; val_gene_expr_recon_loss: 922412.1250; val_masked_gp_l1_reg_loss: 10274.0957; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35969.5859; val_chrom_access_recon_loss: 454292.2812; val_global_loss: 1475449.0000; val_optim_loss: 1475449.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9361; val_auprc_score: 0.9271; val_best_acc_score: 0.8601; val_best_f1_score: 0.8599; train_kl_reg_loss: 13119.5719; train_edge_recon_loss: 39685.0981; train_gene_expr_recon_loss: 912311.8264; train_masked_gp_l1_reg_loss: 10536.1306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35069.8286; train_chrom_access_recon_loss: 452317.4618; train_global_loss: 1463039.9167; train_optim_loss: 1463039.9167; val_kl_reg_loss: 12197.8682; val_edge_recon_loss: 40138.1250; val_gene_expr_recon_loss: 916923.7500; val_masked_gp_l1_reg_loss: 10812.2559; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33970.6719; val_chrom_access_recon_loss: 453505.0312; val_global_loss: 1467547.7500; val_optim_loss: 1467547.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9371; val_auprc_score: 0.9230; val_best_acc_score: 0.8624; val_best_f1_score: 0.8588; train_kl_reg_loss: 13041.1518; train_edge_recon_loss: 39636.6124; train_gene_expr_recon_loss: 910502.0903; train_masked_gp_l1_reg_loss: 10972.3506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33134.3806; train_chrom_access_recon_loss: 452059.5278; train_global_loss: 1459346.1111; train_optim_loss: 1459346.1111; val_kl_reg_loss: 12296.4014; val_edge_recon_loss: 40049.1719; val_gene_expr_recon_loss: 912476.6250; val_masked_gp_l1_reg_loss: 11149.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32115.3516; val_chrom_access_recon_loss: 452878.1250; val_global_loss: 1460965.7500; val_optim_loss: 1460965.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9384; val_auprc_score: 0.9302; val_best_acc_score: 0.8572; val_best_f1_score: 0.8536; train_kl_reg_loss: 13187.3711; train_edge_recon_loss: 39588.7422; train_gene_expr_recon_loss: 904945.2153; train_masked_gp_l1_reg_loss: 11083.1055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32001.2281; train_chrom_access_recon_loss: 449748.4757; train_global_loss: 1450554.1250; train_optim_loss: 1450554.1250; val_kl_reg_loss: 12316.2246; val_edge_recon_loss: 40002.8984; val_gene_expr_recon_loss: 912016.0625; val_masked_gp_l1_reg_loss: 11029.9863; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31862.2363; val_chrom_access_recon_loss: 452684.1250; val_global_loss: 1459911.5000; val_optim_loss: 1459911.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9415; val_auprc_score: 0.9303; val_best_acc_score: 0.8642; val_best_f1_score: 0.8596; train_kl_reg_loss: 13275.2172; train_edge_recon_loss: 39568.6580; train_gene_expr_recon_loss: 907381.1736; train_masked_gp_l1_reg_loss: 11019.5086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31764.8659; train_chrom_access_recon_loss: 450149.2431; train_global_loss: 1453158.6806; train_optim_loss: 1453158.6806; val_kl_reg_loss: 12410.1592; val_edge_recon_loss: 39986.8828; val_gene_expr_recon_loss: 911609.3125; val_masked_gp_l1_reg_loss: 10999.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31642.6465; val_chrom_access_recon_loss: 452643.0312; val_global_loss: 1459291.8750; val_optim_loss: 1459291.8750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9324; val_auprc_score: 0.9183; val_best_acc_score: 0.8542; val_best_f1_score: 0.8502; train_kl_reg_loss: 13288.4531; train_edge_recon_loss: 39556.3494; train_gene_expr_recon_loss: 904570.4375; train_masked_gp_l1_reg_loss: 10992.1705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31549.9807; train_chrom_access_recon_loss: 449748.3646; train_global_loss: 1449705.7500; train_optim_loss: 1449705.7500; val_kl_reg_loss: 12374.5723; val_edge_recon_loss: 40000.8320; val_gene_expr_recon_loss: 911324.2500; val_masked_gp_l1_reg_loss: 10984.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31435.7715; val_chrom_access_recon_loss: 452590.5312; val_global_loss: 1458710.1250; val_optim_loss: 1458710.1250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9391; val_auprc_score: 0.9279; val_best_acc_score: 0.8581; val_best_f1_score: 0.8532; train_kl_reg_loss: 13260.5599; train_edge_recon_loss: 39532.2830; train_gene_expr_recon_loss: 908452.4931; train_masked_gp_l1_reg_loss: 10981.3367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31347.0412; train_chrom_access_recon_loss: 450105.1076; train_global_loss: 1453678.8056; train_optim_loss: 1453678.8056; val_kl_reg_loss: 12400.1123; val_edge_recon_loss: 39963.6328; val_gene_expr_recon_loss: 910953.6250; val_masked_gp_l1_reg_loss: 10979.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31239.1641; val_chrom_access_recon_loss: 452508.9375; val_global_loss: 1458045.0000; val_optim_loss: 1458045.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 38 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9279
val AUPRC score: 0.9177
val best accuracy score: 0.8500
val best F1 score: 0.8561
val target rna MSE score: 4.0069
val source rna MSE score: 3.2079
val target atac MSE score: 0.1379
val source atac MSE score: 0.0206
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
