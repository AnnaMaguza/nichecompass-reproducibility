[True]
Run timestamp: 26072023_014019_35.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_35']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8872; val_auprc_score: 0.9018; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 4516.6010; train_edge_recon_loss: 351206.0417; train_gene_expr_recon_loss: 3218489.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 107645581.3333; train_global_loss: 111219792.8889; train_optim_loss: 111219792.8889; val_kl_reg_loss: 15533.3428; val_edge_recon_loss: 406572.0312; val_gene_expr_recon_loss: 3093911.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 106312240.0000; val_global_loss: 109828256.0000; val_optim_loss: 109828256.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8574; val_auprc_score: 0.8653; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 24482.5002; train_edge_recon_loss: 369532.5868; train_gene_expr_recon_loss: 2983096.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 106166152.0000; train_global_loss: 109543264.8889; train_optim_loss: 109543264.8889; val_kl_reg_loss: 33489.0469; val_edge_recon_loss: 406581.4062; val_gene_expr_recon_loss: 2783823.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 104155728.0000; val_global_loss: 107379624.0000; val_optim_loss: 107379624.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8525; val_auprc_score: 0.8635; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 47989.9253; train_edge_recon_loss: 386074.1632; train_gene_expr_recon_loss: 2683371.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 103351528.8889; train_global_loss: 106468964.4444; train_optim_loss: 106468964.4444; val_kl_reg_loss: 61894.5078; val_edge_recon_loss: 406595.4375; val_gene_expr_recon_loss: 2570905.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101962536.0000; val_global_loss: 105001928.0000; val_optim_loss: 105001928.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8626; val_auprc_score: 0.8729; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 74055.9983; train_edge_recon_loss: 399133.2535; train_gene_expr_recon_loss: 2510134.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101059058.6667; train_global_loss: 104042382.2222; train_optim_loss: 104042382.2222; val_kl_reg_loss: 84677.7344; val_edge_recon_loss: 406594.8438; val_gene_expr_recon_loss: 2418018.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100027976.0000; val_global_loss: 102937264.0000; val_optim_loss: 102937264.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8776; val_auprc_score: 0.8816; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 96857.2682; train_edge_recon_loss: 403161.3056; train_gene_expr_recon_loss: 2394148.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99783240.8889; train_global_loss: 102677407.1111; train_optim_loss: 102677407.1111; val_kl_reg_loss: 106154.1250; val_edge_recon_loss: 406589.0625; val_gene_expr_recon_loss: 2324052.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99055712.0000; val_global_loss: 101892504.0000; val_optim_loss: 101892504.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8866; val_auprc_score: 0.8831; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 114682.8941; train_edge_recon_loss: 404456.3611; train_gene_expr_recon_loss: 2283720.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98425394.6667; train_global_loss: 101228254.2222; train_optim_loss: 101228254.2222; val_kl_reg_loss: 118113.6562; val_edge_recon_loss: 406558.2188; val_gene_expr_recon_loss: 2249988.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98398480.0000; val_global_loss: 101173144.0000; val_optim_loss: 101173144.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8739; val_auprc_score: 0.8691; val_best_acc_score: 0.5018; val_best_f1_score: 0.6674; train_kl_reg_loss: 126875.1910; train_edge_recon_loss: 404796.6389; train_gene_expr_recon_loss: 2245318.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98496028.4444; train_global_loss: 101273018.6667; train_optim_loss: 101273018.6667; val_kl_reg_loss: 125737.0781; val_edge_recon_loss: 406503.1875; val_gene_expr_recon_loss: 2199055.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97825968.0000; val_global_loss: 100557264.0000; val_optim_loss: 100557264.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8582; val_auprc_score: 0.8514; val_best_acc_score: 0.5135; val_best_f1_score: 0.6727; train_kl_reg_loss: 135058.6059; train_edge_recon_loss: 404909.1215; train_gene_expr_recon_loss: 2192663.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97941607.1111; train_global_loss: 100674239.1111; train_optim_loss: 100674239.1111; val_kl_reg_loss: 130483.8906; val_edge_recon_loss: 406430.5625; val_gene_expr_recon_loss: 2165799.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97487368.0000; val_global_loss: 100190080.0000; val_optim_loss: 100190080.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8497; val_auprc_score: 0.8429; val_best_acc_score: 0.5333; val_best_f1_score: 0.6817; train_kl_reg_loss: 139944.1250; train_edge_recon_loss: 405080.2847; train_gene_expr_recon_loss: 2178303.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98116717.3333; train_global_loss: 100840045.3333; train_optim_loss: 100840045.3333; val_kl_reg_loss: 131838.6875; val_edge_recon_loss: 406339.7500; val_gene_expr_recon_loss: 2147223.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97420448.0000; val_global_loss: 100105848.0000; val_optim_loss: 100105848.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8449; val_auprc_score: 0.8399; val_best_acc_score: 0.5546; val_best_f1_score: 0.6913; train_kl_reg_loss: 140217.5139; train_edge_recon_loss: 404964.0556; train_gene_expr_recon_loss: 2152849.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97957496.8889; train_global_loss: 100655528.8889; train_optim_loss: 100655528.8889; val_kl_reg_loss: 129958.2031; val_edge_recon_loss: 406243.6875; val_gene_expr_recon_loss: 2133300.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97347800.0000; val_global_loss: 100017304.0000; val_optim_loss: 100017304.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8483; val_auprc_score: 0.8471; val_best_acc_score: 0.5787; val_best_f1_score: 0.7025; train_kl_reg_loss: 138670.4705; train_edge_recon_loss: 404935.7014; train_gene_expr_recon_loss: 2134189.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97321945.7778; train_global_loss: 99999741.3333; train_optim_loss: 99999741.3333; val_kl_reg_loss: 128016.2578; val_edge_recon_loss: 406136.2500; val_gene_expr_recon_loss: 2124001.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97240128.0000; val_global_loss: 99898280.0000; val_optim_loss: 99898280.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8509; val_auprc_score: 0.8511; val_best_acc_score: 0.5969; val_best_f1_score: 0.7111; train_kl_reg_loss: 138989.2170; train_edge_recon_loss: 404805.3472; train_gene_expr_recon_loss: 2127049.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96710015.1111; train_global_loss: 99380859.5556; train_optim_loss: 99380859.5556; val_kl_reg_loss: 129295.8516; val_edge_recon_loss: 406042.1250; val_gene_expr_recon_loss: 2115319.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97004432.0000; val_global_loss: 99655088.0000; val_optim_loss: 99655088.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8620; val_auprc_score: 0.8604; val_best_acc_score: 0.6284; val_best_f1_score: 0.7256; train_kl_reg_loss: 139113.6771; train_edge_recon_loss: 404744.1389; train_gene_expr_recon_loss: 2122366.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97283676.4444; train_global_loss: 99949901.3333; train_optim_loss: 99949901.3333; val_kl_reg_loss: 124215.0703; val_edge_recon_loss: 405815.4375; val_gene_expr_recon_loss: 2107483.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96837592.0000; val_global_loss: 99475104.0000; val_optim_loss: 99475104.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8674; val_auprc_score: 0.8608; val_best_acc_score: 0.6668; val_best_f1_score: 0.7442; train_kl_reg_loss: 135759.8646; train_edge_recon_loss: 404304.1424; train_gene_expr_recon_loss: 2112569.8472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96150794.6667; train_global_loss: 98803428.4444; train_optim_loss: 98803428.4444; val_kl_reg_loss: 124697.7891; val_edge_recon_loss: 405571.6250; val_gene_expr_recon_loss: 2104364.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96796320.0000; val_global_loss: 99430952.0000; val_optim_loss: 99430952.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8757; val_auprc_score: 0.8694; val_best_acc_score: 0.7184; val_best_f1_score: 0.7720; train_kl_reg_loss: 134299.0009; train_edge_recon_loss: 404014.3924; train_gene_expr_recon_loss: 2112603.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96906736.0000; train_global_loss: 99557652.4444; train_optim_loss: 99557652.4444; val_kl_reg_loss: 121362.8281; val_edge_recon_loss: 405081.0312; val_gene_expr_recon_loss: 2098067.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96687184.0000; val_global_loss: 99311696.0000; val_optim_loss: 99311696.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8885; val_auprc_score: 0.8823; val_best_acc_score: 0.7596; val_best_f1_score: 0.7954; train_kl_reg_loss: 131494.5304; train_edge_recon_loss: 403392.2465; train_gene_expr_recon_loss: 2110821.1806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96459824.8889; train_global_loss: 99105533.3333; train_optim_loss: 99105533.3333; val_kl_reg_loss: 119540.5156; val_edge_recon_loss: 404410.4062; val_gene_expr_recon_loss: 2093520.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96421600.0000; val_global_loss: 99039072.0000; val_optim_loss: 99039072.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8936; val_auprc_score: 0.8842; val_best_acc_score: 0.7966; val_best_f1_score: 0.8182; train_kl_reg_loss: 129786.9670; train_edge_recon_loss: 402858.3785; train_gene_expr_recon_loss: 2091988.5972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96299224.0000; train_global_loss: 98923857.7778; train_optim_loss: 98923857.7778; val_kl_reg_loss: 121075.2734; val_edge_recon_loss: 403814.0938; val_gene_expr_recon_loss: 2091002.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96667920.0000; val_global_loss: 99283808.0000; val_optim_loss: 99283808.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8965; val_auprc_score: 0.8869; val_best_acc_score: 0.8107; val_best_f1_score: 0.8251; train_kl_reg_loss: 128713.5694; train_edge_recon_loss: 402043.4340; train_gene_expr_recon_loss: 2097708.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96589320.8889; train_global_loss: 99217785.7778; train_optim_loss: 99217785.7778; val_kl_reg_loss: 116573.6641; val_edge_recon_loss: 402973.8438; val_gene_expr_recon_loss: 2085700.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96359704.0000; val_global_loss: 98964952.0000; val_optim_loss: 98964952.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9022; val_auprc_score: 0.8892; val_best_acc_score: 0.8184; val_best_f1_score: 0.8275; train_kl_reg_loss: 126422.3047; train_edge_recon_loss: 401113.3299; train_gene_expr_recon_loss: 2085994.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96260145.7778; train_global_loss: 98873675.5556; train_optim_loss: 98873675.5556; val_kl_reg_loss: 116649.9531; val_edge_recon_loss: 402045.6250; val_gene_expr_recon_loss: 2084617.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96384064.0000; val_global_loss: 98987376.0000; val_optim_loss: 98987376.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9082; val_auprc_score: 0.8915; val_best_acc_score: 0.8319; val_best_f1_score: 0.8357; train_kl_reg_loss: 125279.6042; train_edge_recon_loss: 400272.5035; train_gene_expr_recon_loss: 2090639.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95968469.3333; train_global_loss: 98584660.4444; train_optim_loss: 98584660.4444; val_kl_reg_loss: 118469.2969; val_edge_recon_loss: 400998.5625; val_gene_expr_recon_loss: 2080582.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96281872.0000; val_global_loss: 98881920.0000; val_optim_loss: 98881920.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9120; val_auprc_score: 0.8985; val_best_acc_score: 0.8302; val_best_f1_score: 0.8300; train_kl_reg_loss: 123919.6076; train_edge_recon_loss: 399202.2396; train_gene_expr_recon_loss: 2082867.1806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95836164.4444; train_global_loss: 98442152.8889; train_optim_loss: 98442152.8889; val_kl_reg_loss: 115822.2656; val_edge_recon_loss: 399788.1250; val_gene_expr_recon_loss: 2076945.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96090840.0000; val_global_loss: 98683392.0000; val_optim_loss: 98683392.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9121; val_auprc_score: 0.8965; val_best_acc_score: 0.8255; val_best_f1_score: 0.8215; train_kl_reg_loss: 122532.6224; train_edge_recon_loss: 397830.7604; train_gene_expr_recon_loss: 2084592.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96224941.3333; train_global_loss: 98829896.8889; train_optim_loss: 98829896.8889; val_kl_reg_loss: 113582.5469; val_edge_recon_loss: 398305.3125; val_gene_expr_recon_loss: 2075813.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96075096.0000; val_global_loss: 98662800.0000; val_optim_loss: 98662800.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9175; val_auprc_score: 0.9044; val_best_acc_score: 0.8216; val_best_f1_score: 0.8247; train_kl_reg_loss: 121242.7057; train_edge_recon_loss: 396474.6424; train_gene_expr_recon_loss: 2081485.0972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95834230.2222; train_global_loss: 98433432.0000; train_optim_loss: 98433432.0000; val_kl_reg_loss: 111354.6016; val_edge_recon_loss: 396439.8750; val_gene_expr_recon_loss: 2070989.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95948736.0000; val_global_loss: 98527520.0000; val_optim_loss: 98527520.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9179; val_auprc_score: 0.9039; val_best_acc_score: 0.8154; val_best_f1_score: 0.8324; train_kl_reg_loss: 120528.9965; train_edge_recon_loss: 395110.5000; train_gene_expr_recon_loss: 2077695.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96053808.8889; train_global_loss: 98647143.1111; train_optim_loss: 98647143.1111; val_kl_reg_loss: 108402.6875; val_edge_recon_loss: 395247.3438; val_gene_expr_recon_loss: 2071131.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95910064.0000; val_global_loss: 98484848.0000; val_optim_loss: 98484848.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9149; val_auprc_score: 0.8993; val_best_acc_score: 0.8084; val_best_f1_score: 0.8356; train_kl_reg_loss: 118813.9184; train_edge_recon_loss: 393756.7604; train_gene_expr_recon_loss: 2069008.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95081141.3333; train_global_loss: 97662720.8889; train_optim_loss: 97662720.8889; val_kl_reg_loss: 109626.0156; val_edge_recon_loss: 394164.3125; val_gene_expr_recon_loss: 2067522.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95845840.0000; val_global_loss: 98417152.0000; val_optim_loss: 98417152.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9178; val_auprc_score: 0.9002; val_best_acc_score: 0.8212; val_best_f1_score: 0.8260; train_kl_reg_loss: 127880.9575; train_edge_recon_loss: 394939.7778; train_gene_expr_recon_loss: 2181748.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97805037.3333; train_global_loss: 100509606.2222; train_optim_loss: 100509606.2222; val_kl_reg_loss: 88128.1875; val_edge_recon_loss: 396027.1875; val_gene_expr_recon_loss: 2140541.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96870344.0000; val_global_loss: 99495040.0000; val_optim_loss: 99495040.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9171; val_auprc_score: 0.8998; val_best_acc_score: 0.8201; val_best_f1_score: 0.8288; train_kl_reg_loss: 129655.3203; train_edge_recon_loss: 394215.7639; train_gene_expr_recon_loss: 2145690.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96834776.0000; train_global_loss: 99504337.7778; train_optim_loss: 99504337.7778; val_kl_reg_loss: 86819.7344; val_edge_recon_loss: 395956.5938; val_gene_expr_recon_loss: 2130768.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96802432.0000; val_global_loss: 99415976.0000; val_optim_loss: 99415976.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9160; val_auprc_score: 0.8981; val_best_acc_score: 0.8151; val_best_f1_score: 0.8334; train_kl_reg_loss: 125172.8984; train_edge_recon_loss: 394011.7917; train_gene_expr_recon_loss: 2134597.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96712088.0000; train_global_loss: 99365872.0000; train_optim_loss: 99365872.0000; val_kl_reg_loss: 86198.7656; val_edge_recon_loss: 394697.9375; val_gene_expr_recon_loss: 2125152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96585408.0000; val_global_loss: 99191456.0000; val_optim_loss: 99191456.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9183; val_auprc_score: 0.9035; val_best_acc_score: 0.8172; val_best_f1_score: 0.8341; train_kl_reg_loss: 122058.8889; train_edge_recon_loss: 393079.6250; train_gene_expr_recon_loss: 2145381.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96748151.1111; train_global_loss: 99408672.8889; train_optim_loss: 99408672.8889; val_kl_reg_loss: 86826.6094; val_edge_recon_loss: 394395.1562; val_gene_expr_recon_loss: 2121114.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96533024.0000; val_global_loss: 99135360.0000; val_optim_loss: 99135360.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9172; val_auprc_score: 0.9002; val_best_acc_score: 0.8173; val_best_f1_score: 0.8354; train_kl_reg_loss: 119151.8264; train_edge_recon_loss: 392706.2153; train_gene_expr_recon_loss: 2140200.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96565714.6667; train_global_loss: 99217772.4444; train_optim_loss: 99217772.4444; val_kl_reg_loss: 90339.3359; val_edge_recon_loss: 394764.0000; val_gene_expr_recon_loss: 2120418.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96519616.0000; val_global_loss: 99125136.0000; val_optim_loss: 99125136.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9189; val_auprc_score: 0.9019; val_best_acc_score: 0.8165; val_best_f1_score: 0.8382; train_kl_reg_loss: 121556.2448; train_edge_recon_loss: 393113.8576; train_gene_expr_recon_loss: 2130648.5972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96175101.3333; train_global_loss: 98820419.5556; train_optim_loss: 98820419.5556; val_kl_reg_loss: 89113.7344; val_edge_recon_loss: 394391.0000; val_gene_expr_recon_loss: 2117440.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96517848.0000; val_global_loss: 99118792.0000; val_optim_loss: 99118792.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9194; val_auprc_score: 0.9051; val_best_acc_score: 0.8161; val_best_f1_score: 0.8414; train_kl_reg_loss: 119087.0000; train_edge_recon_loss: 392974.6076; train_gene_expr_recon_loss: 2136332.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96947267.5556; train_global_loss: 99595660.4444; train_optim_loss: 99595660.4444; val_kl_reg_loss: 88329.5547; val_edge_recon_loss: 394128.5938; val_gene_expr_recon_loss: 2118863.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96517576.0000; val_global_loss: 99118896.0000; val_optim_loss: 99118896.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9188; val_auprc_score: 0.9011; val_best_acc_score: 0.8174; val_best_f1_score: 0.8356; train_kl_reg_loss: 120059.3333; train_edge_recon_loss: 392924.2882; train_gene_expr_recon_loss: 2132801.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96393190.2222; train_global_loss: 99038976.0000; train_optim_loss: 99038976.0000; val_kl_reg_loss: 89486.7344; val_edge_recon_loss: 394353.2188; val_gene_expr_recon_loss: 2119123.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96490160.0000; val_global_loss: 99093120.0000; val_optim_loss: 99093120.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 3 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9199
Val AUPRC score: 0.9050
Val best accuracy score: 0.8228
Val best F1 score: 0.8291
Val gene expr MSE score: 0.5874
Val chrom access MSE score: 0.0874
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
