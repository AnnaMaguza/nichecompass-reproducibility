[True]
Run timestamp: 07082023_170333_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8753; val_auprc_score: 0.8972; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 9921.0239; train_edge_recon_loss: 36184.5269; train_gene_expr_recon_loss: 1462284.5972; train_masked_gp_l1_reg_loss: 8420.1206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119223.7552; train_chrom_access_recon_loss: 3307208.1528; train_global_loss: 4943242.2222; train_optim_loss: 4943242.2222; val_kl_reg_loss: 8747.2959; val_edge_recon_loss: 40661.0625; val_gene_expr_recon_loss: 1212364.8750; val_masked_gp_l1_reg_loss: 6411.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116979.2656; val_chrom_access_recon_loss: 1846377.1250; val_global_loss: 3231540.7500; val_optim_loss: 3231540.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9017; val_auprc_score: 0.9183; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 6849.7458; train_edge_recon_loss: 36828.4536; train_gene_expr_recon_loss: 1107723.7014; train_masked_gp_l1_reg_loss: 5828.0284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115730.3099; train_chrom_access_recon_loss: 1570890.5278; train_global_loss: 2843850.7778; train_optim_loss: 2843850.7778; val_kl_reg_loss: 5341.6865; val_edge_recon_loss: 40660.6445; val_gene_expr_recon_loss: 1038900.1250; val_masked_gp_l1_reg_loss: 5622.4912; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114311.6562; val_chrom_access_recon_loss: 1468474.3750; val_global_loss: 2673311.0000; val_optim_loss: 2673311.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9055; val_auprc_score: 0.9189; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 6281.2610; train_edge_recon_loss: 36668.2535; train_gene_expr_recon_loss: 1000784.7708; train_masked_gp_l1_reg_loss: 6062.4838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113270.9054; train_chrom_access_recon_loss: 1440603.7917; train_global_loss: 2603671.4722; train_optim_loss: 2603671.4722; val_kl_reg_loss: 8358.3027; val_edge_recon_loss: 40661.3906; val_gene_expr_recon_loss: 951763.0625; val_masked_gp_l1_reg_loss: 6588.8745; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111984.6484; val_chrom_access_recon_loss: 1427972.5000; val_global_loss: 2547328.7500; val_optim_loss: 2547328.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9046; val_auprc_score: 0.9184; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 12254.7504; train_edge_recon_loss: 37746.3368; train_gene_expr_recon_loss: 910987.5625; train_masked_gp_l1_reg_loss: 6780.7388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110947.9479; train_chrom_access_recon_loss: 1401468.3333; train_global_loss: 2480185.6944; train_optim_loss: 2480185.6944; val_kl_reg_loss: 16869.3711; val_edge_recon_loss: 40662.0547; val_gene_expr_recon_loss: 853467.5000; val_masked_gp_l1_reg_loss: 6928.9058; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109627.4375; val_chrom_access_recon_loss: 1395726.0000; val_global_loss: 2423281.2500; val_optim_loss: 2423281.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8998; val_auprc_score: 0.9083; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 20351.5202; train_edge_recon_loss: 38772.9891; train_gene_expr_recon_loss: 816196.3750; train_masked_gp_l1_reg_loss: 6964.3778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108497.1111; train_chrom_access_recon_loss: 1371733.2222; train_global_loss: 2362515.5833; train_optim_loss: 2362515.5833; val_kl_reg_loss: 22447.2910; val_edge_recon_loss: 40662.0234; val_gene_expr_recon_loss: 778542.8125; val_masked_gp_l1_reg_loss: 6959.4331; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107003.7891; val_chrom_access_recon_loss: 1374386.8750; val_global_loss: 2330002.2500; val_optim_loss: 2330002.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8896; val_auprc_score: 0.9020; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 22891.5966; train_edge_recon_loss: 38995.6337; train_gene_expr_recon_loss: 761870.5625; train_masked_gp_l1_reg_loss: 6926.4737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105657.6528; train_chrom_access_recon_loss: 1358337.7222; train_global_loss: 2294679.6944; train_optim_loss: 2294679.6944; val_kl_reg_loss: 22392.7500; val_edge_recon_loss: 40660.8867; val_gene_expr_recon_loss: 741740.3125; val_masked_gp_l1_reg_loss: 6880.6929; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103883.7109; val_chrom_access_recon_loss: 1352577.3750; val_global_loss: 2268135.7500; val_optim_loss: 2268135.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8714; val_auprc_score: 0.8808; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 22994.8631; train_edge_recon_loss: 38968.3885; train_gene_expr_recon_loss: 728916.6042; train_masked_gp_l1_reg_loss: 6853.3592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102341.5512; train_chrom_access_recon_loss: 1338640.6806; train_global_loss: 2238715.4167; train_optim_loss: 2238715.4167; val_kl_reg_loss: 22729.2383; val_edge_recon_loss: 40658.0820; val_gene_expr_recon_loss: 716716.2500; val_masked_gp_l1_reg_loss: 6817.1934; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100354.5391; val_chrom_access_recon_loss: 1340165.0000; val_global_loss: 2227440.2500; val_optim_loss: 2227440.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8529; val_auprc_score: 0.8564; val_best_acc_score: 0.5155; val_best_f1_score: 0.6734; train_kl_reg_loss: 23372.7973; train_edge_recon_loss: 39024.3129; train_gene_expr_recon_loss: 710243.5069; train_masked_gp_l1_reg_loss: 6790.0050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98699.9774; train_chrom_access_recon_loss: 1328932.6111; train_global_loss: 2207063.2222; train_optim_loss: 2207063.2222; val_kl_reg_loss: 23195.3828; val_edge_recon_loss: 40649.8242; val_gene_expr_recon_loss: 699341.0000; val_masked_gp_l1_reg_loss: 6751.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96606.2500; val_chrom_access_recon_loss: 1332261.1250; val_global_loss: 2198805.0000; val_optim_loss: 2198805.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8424; val_auprc_score: 0.8389; val_best_acc_score: 0.5397; val_best_f1_score: 0.6831; train_kl_reg_loss: 23946.4108; train_edge_recon_loss: 39053.8702; train_gene_expr_recon_loss: 693394.0972; train_masked_gp_l1_reg_loss: 6722.2455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94901.0347; train_chrom_access_recon_loss: 1324020.7639; train_global_loss: 2182038.4444; train_optim_loss: 2182038.4444; val_kl_reg_loss: 23331.8086; val_edge_recon_loss: 40625.0391; val_gene_expr_recon_loss: 686391.6250; val_masked_gp_l1_reg_loss: 6683.7910; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92757.0156; val_chrom_access_recon_loss: 1326000.5000; val_global_loss: 2175789.7500; val_optim_loss: 2175789.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8238; val_auprc_score: 0.8190; val_best_acc_score: 0.5858; val_best_f1_score: 0.7031; train_kl_reg_loss: 23904.2142; train_edge_recon_loss: 39056.1944; train_gene_expr_recon_loss: 682009.0972; train_masked_gp_l1_reg_loss: 6657.4511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91034.8550; train_chrom_access_recon_loss: 1311381.5694; train_global_loss: 2154043.3611; train_optim_loss: 2154043.3611; val_kl_reg_loss: 23510.9102; val_edge_recon_loss: 40593.6016; val_gene_expr_recon_loss: 676261.5000; val_masked_gp_l1_reg_loss: 6622.3530; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88885.6719; val_chrom_access_recon_loss: 1321119.1250; val_global_loss: 2156993.2500; val_optim_loss: 2156993.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8155; val_auprc_score: 0.8101; val_best_acc_score: 0.6187; val_best_f1_score: 0.7175; train_kl_reg_loss: 24171.5345; train_edge_recon_loss: 39076.7522; train_gene_expr_recon_loss: 671268.2778; train_masked_gp_l1_reg_loss: 6599.6608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87183.6163; train_chrom_access_recon_loss: 1308777.6389; train_global_loss: 2137077.5000; train_optim_loss: 2137077.5000; val_kl_reg_loss: 23371.9727; val_edge_recon_loss: 40560.4492; val_gene_expr_recon_loss: 669409.0000; val_masked_gp_l1_reg_loss: 6562.6572; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85072.4375; val_chrom_access_recon_loss: 1316087.2500; val_global_loss: 2141063.7500; val_optim_loss: 2141063.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8064; val_auprc_score: 0.7974; val_best_acc_score: 0.6473; val_best_f1_score: 0.7301; train_kl_reg_loss: 23879.2765; train_edge_recon_loss: 39080.9692; train_gene_expr_recon_loss: 666090.4722; train_masked_gp_l1_reg_loss: 6542.3203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83422.4887; train_chrom_access_recon_loss: 1307529.3611; train_global_loss: 2126544.9444; train_optim_loss: 2126544.9444; val_kl_reg_loss: 22786.6484; val_edge_recon_loss: 40518.6133; val_gene_expr_recon_loss: 664952.9375; val_masked_gp_l1_reg_loss: 6520.1504; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81386.3438; val_chrom_access_recon_loss: 1312591.2500; val_global_loss: 2128756.0000; val_optim_loss: 2128756.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8172; val_auprc_score: 0.8117; val_best_acc_score: 0.6450; val_best_f1_score: 0.7284; train_kl_reg_loss: 23483.2665; train_edge_recon_loss: 39072.7713; train_gene_expr_recon_loss: 661104.8056; train_masked_gp_l1_reg_loss: 6507.7958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79803.1415; train_chrom_access_recon_loss: 1293918.9444; train_global_loss: 2103890.6528; train_optim_loss: 2103890.6528; val_kl_reg_loss: 23291.3887; val_edge_recon_loss: 40522.4844; val_gene_expr_recon_loss: 660413.5000; val_masked_gp_l1_reg_loss: 6484.3613; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77845.2656; val_chrom_access_recon_loss: 1309801.7500; val_global_loss: 2118358.7500; val_optim_loss: 2118358.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8278; val_auprc_score: 0.8227; val_best_acc_score: 0.6820; val_best_f1_score: 0.7473; train_kl_reg_loss: 23105.1536; train_edge_recon_loss: 39045.3016; train_gene_expr_recon_loss: 659887.1181; train_masked_gp_l1_reg_loss: 6472.9468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76322.0148; train_chrom_access_recon_loss: 1301197.2500; train_global_loss: 2106029.7778; train_optim_loss: 2106029.7778; val_kl_reg_loss: 22136.3945; val_edge_recon_loss: 40482.1367; val_gene_expr_recon_loss: 658024.3750; val_masked_gp_l1_reg_loss: 6459.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74443.6094; val_chrom_access_recon_loss: 1307252.5000; val_global_loss: 2108799.0000; val_optim_loss: 2108799.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8449; val_auprc_score: 0.8398; val_best_acc_score: 0.7084; val_best_f1_score: 0.7607; train_kl_reg_loss: 22673.5310; train_edge_recon_loss: 39038.5516; train_gene_expr_recon_loss: 653184.6875; train_masked_gp_l1_reg_loss: 6452.3294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72988.1753; train_chrom_access_recon_loss: 1297792.0278; train_global_loss: 2092129.2917; train_optim_loss: 2092129.2917; val_kl_reg_loss: 21424.2852; val_edge_recon_loss: 40459.9531; val_gene_expr_recon_loss: 655655.2500; val_masked_gp_l1_reg_loss: 6437.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71193.1328; val_chrom_access_recon_loss: 1304758.6250; val_global_loss: 2099928.5000; val_optim_loss: 2099928.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8537; val_auprc_score: 0.8487; val_best_acc_score: 0.7339; val_best_f1_score: 0.7742; train_kl_reg_loss: 22033.6502; train_edge_recon_loss: 38997.4219; train_gene_expr_recon_loss: 651596.1597; train_masked_gp_l1_reg_loss: 6432.6731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69809.7613; train_chrom_access_recon_loss: 1292336.0972; train_global_loss: 2081205.7639; train_optim_loss: 2081205.7639; val_kl_reg_loss: 21118.1074; val_edge_recon_loss: 40434.8516; val_gene_expr_recon_loss: 653169.0000; val_masked_gp_l1_reg_loss: 6421.8076; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68105.2344; val_chrom_access_recon_loss: 1302370.8750; val_global_loss: 2091619.8750; val_optim_loss: 2091619.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8656; val_auprc_score: 0.8598; val_best_acc_score: 0.7718; val_best_f1_score: 0.7966; train_kl_reg_loss: 21658.6719; train_edge_recon_loss: 38920.7157; train_gene_expr_recon_loss: 651064.6736; train_masked_gp_l1_reg_loss: 6419.1997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66791.7049; train_chrom_access_recon_loss: 1297838.3889; train_global_loss: 2082693.3194; train_optim_loss: 2082693.3194; val_kl_reg_loss: 20482.0508; val_edge_recon_loss: 40383.2656; val_gene_expr_recon_loss: 651534.5000; val_masked_gp_l1_reg_loss: 6410.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65172.2656; val_chrom_access_recon_loss: 1299960.6250; val_global_loss: 2083943.5000; val_optim_loss: 2083943.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8806; val_auprc_score: 0.8742; val_best_acc_score: 0.7947; val_best_f1_score: 0.8105; train_kl_reg_loss: 21332.4032; train_edge_recon_loss: 38887.6437; train_gene_expr_recon_loss: 653842.4167; train_masked_gp_l1_reg_loss: 6411.5162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63928.3763; train_chrom_access_recon_loss: 1292704.0556; train_global_loss: 2077106.4167; train_optim_loss: 2077106.4167; val_kl_reg_loss: 20237.5664; val_edge_recon_loss: 40325.9570; val_gene_expr_recon_loss: 649546.9375; val_masked_gp_l1_reg_loss: 6406.0249; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62397.5977; val_chrom_access_recon_loss: 1297744.3750; val_global_loss: 2076658.5000; val_optim_loss: 2076658.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8874; val_auprc_score: 0.8834; val_best_acc_score: 0.8080; val_best_f1_score: 0.8179; train_kl_reg_loss: 20912.7995; train_edge_recon_loss: 38843.7834; train_gene_expr_recon_loss: 647602.8264; train_masked_gp_l1_reg_loss: 6405.3550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61227.6267; train_chrom_access_recon_loss: 1289874.3056; train_global_loss: 2064866.6806; train_optim_loss: 2064866.6806; val_kl_reg_loss: 20017.4180; val_edge_recon_loss: 40290.7891; val_gene_expr_recon_loss: 647771.2500; val_masked_gp_l1_reg_loss: 6398.5503; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59784.6562; val_chrom_access_recon_loss: 1297756.8750; val_global_loss: 2072019.5000; val_optim_loss: 2072019.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8942; val_auprc_score: 0.8863; val_best_acc_score: 0.8199; val_best_f1_score: 0.8231; train_kl_reg_loss: 20642.0239; train_edge_recon_loss: 38786.6806; train_gene_expr_recon_loss: 650132.2500; train_masked_gp_l1_reg_loss: 6400.4987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58676.1220; train_chrom_access_recon_loss: 1289179.0833; train_global_loss: 2063816.6389; train_optim_loss: 2063816.6389; val_kl_reg_loss: 19352.0000; val_edge_recon_loss: 40204.7188; val_gene_expr_recon_loss: 646787.6250; val_masked_gp_l1_reg_loss: 6400.2480; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57314.0430; val_chrom_access_recon_loss: 1295683.7500; val_global_loss: 2065742.5000; val_optim_loss: 2065742.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8964; val_auprc_score: 0.8857; val_best_acc_score: 0.8257; val_best_f1_score: 0.8257; train_kl_reg_loss: 20183.0751; train_edge_recon_loss: 38725.6936; train_gene_expr_recon_loss: 646078.3472; train_masked_gp_l1_reg_loss: 6408.5698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56273.7839; train_chrom_access_recon_loss: 1287756.1389; train_global_loss: 2055425.5833; train_optim_loss: 2055425.5833; val_kl_reg_loss: 19483.1016; val_edge_recon_loss: 40183.5586; val_gene_expr_recon_loss: 644860.0625; val_masked_gp_l1_reg_loss: 6405.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54988.6523; val_chrom_access_recon_loss: 1293497.0000; val_global_loss: 2059418.2500; val_optim_loss: 2059418.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9012; val_auprc_score: 0.8936; val_best_acc_score: 0.8279; val_best_f1_score: 0.8238; train_kl_reg_loss: 19991.0859; train_edge_recon_loss: 38683.5473; train_gene_expr_recon_loss: 648814.2292; train_masked_gp_l1_reg_loss: 6410.9909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54007.4288; train_chrom_access_recon_loss: 1283110.3056; train_global_loss: 2051017.5694; train_optim_loss: 2051017.5694; val_kl_reg_loss: 19010.0352; val_edge_recon_loss: 40121.1758; val_gene_expr_recon_loss: 643941.0625; val_masked_gp_l1_reg_loss: 6410.6357; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52797.8828; val_chrom_access_recon_loss: 1291601.1250; val_global_loss: 2053881.8750; val_optim_loss: 2053881.8750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9030; val_auprc_score: 0.8964; val_best_acc_score: 0.8239; val_best_f1_score: 0.8155; train_kl_reg_loss: 19645.5707; train_edge_recon_loss: 38613.9779; train_gene_expr_recon_loss: 644102.1667; train_masked_gp_l1_reg_loss: 6417.1815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51872.4991; train_chrom_access_recon_loss: 1282445.0417; train_global_loss: 2043096.4167; train_optim_loss: 2043096.4167; val_kl_reg_loss: 18501.2910; val_edge_recon_loss: 40053.2266; val_gene_expr_recon_loss: 643123.6875; val_masked_gp_l1_reg_loss: 6412.2119; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50727.2695; val_chrom_access_recon_loss: 1289791.2500; val_global_loss: 2048608.8750; val_optim_loss: 2048608.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9060; val_auprc_score: 0.9013; val_best_acc_score: 0.8170; val_best_f1_score: 0.8047; train_kl_reg_loss: 19427.6291; train_edge_recon_loss: 38565.3407; train_gene_expr_recon_loss: 640465.3611; train_masked_gp_l1_reg_loss: 6414.4913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49857.9839; train_chrom_access_recon_loss: 1282416.4583; train_global_loss: 2037147.2778; train_optim_loss: 2037147.2778; val_kl_reg_loss: 18124.1250; val_edge_recon_loss: 40000.0703; val_gene_expr_recon_loss: 642499.7500; val_masked_gp_l1_reg_loss: 6409.8530; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48782.0898; val_chrom_access_recon_loss: 1288147.1250; val_global_loss: 2043963.0000; val_optim_loss: 2043963.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9107; val_auprc_score: 0.9022; val_best_acc_score: 0.8197; val_best_f1_score: 0.8061; train_kl_reg_loss: 19189.7151; train_edge_recon_loss: 38506.7192; train_gene_expr_recon_loss: 641380.6111; train_masked_gp_l1_reg_loss: 6408.7747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47957.6059; train_chrom_access_recon_loss: 1280760.5833; train_global_loss: 2034204.0139; train_optim_loss: 2034204.0139; val_kl_reg_loss: 18643.4199; val_edge_recon_loss: 39945.8359; val_gene_expr_recon_loss: 640451.6875; val_masked_gp_l1_reg_loss: 6403.2817; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46936.8945; val_chrom_access_recon_loss: 1286096.6250; val_global_loss: 2038477.7500; val_optim_loss: 2038477.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9033; val_auprc_score: 0.8984; val_best_acc_score: 0.8234; val_best_f1_score: 0.8187; train_kl_reg_loss: 16702.1959; train_edge_recon_loss: 39658.7118; train_gene_expr_recon_loss: 936085.8611; train_masked_gp_l1_reg_loss: 6522.3051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46033.7600; train_chrom_access_recon_loss: 1345025.8889; train_global_loss: 2390028.6944; train_optim_loss: 2390028.6944; val_kl_reg_loss: 14665.2695; val_edge_recon_loss: 40115.2539; val_gene_expr_recon_loss: 935060.6875; val_masked_gp_l1_reg_loss: 6759.6113; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44850.3438; val_chrom_access_recon_loss: 1355663.3750; val_global_loss: 2397114.5000; val_optim_loss: 2397114.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9182; val_auprc_score: 0.9092; val_best_acc_score: 0.8379; val_best_f1_score: 0.8304; train_kl_reg_loss: 16155.1939; train_edge_recon_loss: 39683.1879; train_gene_expr_recon_loss: 930196.0833; train_masked_gp_l1_reg_loss: 6978.5526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43877.8329; train_chrom_access_recon_loss: 1341856.5139; train_global_loss: 2378747.4167; train_optim_loss: 2378747.4167; val_kl_reg_loss: 14122.9336; val_edge_recon_loss: 40049.8242; val_gene_expr_recon_loss: 928540.0625; val_masked_gp_l1_reg_loss: 7224.2261; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42677.1953; val_chrom_access_recon_loss: 1353477.1250; val_global_loss: 2386091.5000; val_optim_loss: 2386091.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9251; val_auprc_score: 0.9157; val_best_acc_score: 0.8476; val_best_f1_score: 0.8388; train_kl_reg_loss: 16029.4566; train_edge_recon_loss: 39620.8498; train_gene_expr_recon_loss: 920884.9444; train_masked_gp_l1_reg_loss: 7393.3672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41752.4210; train_chrom_access_recon_loss: 1338587.2778; train_global_loss: 2364268.3056; train_optim_loss: 2364268.3056; val_kl_reg_loss: 14312.2402; val_edge_recon_loss: 40026.3750; val_gene_expr_recon_loss: 922906.0000; val_masked_gp_l1_reg_loss: 7572.2686; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40620.9922; val_chrom_access_recon_loss: 1351553.5000; val_global_loss: 2376991.5000; val_optim_loss: 2376991.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9211; val_auprc_score: 0.9101; val_best_acc_score: 0.8355; val_best_f1_score: 0.8255; train_kl_reg_loss: 15995.5920; train_edge_recon_loss: 39595.0213; train_gene_expr_recon_loss: 917055.2986; train_masked_gp_l1_reg_loss: 7685.6216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39758.7153; train_chrom_access_recon_loss: 1336885.1667; train_global_loss: 2356975.3611; train_optim_loss: 2356975.3611; val_kl_reg_loss: 14791.3604; val_edge_recon_loss: 40004.1953; val_gene_expr_recon_loss: 918036.6250; val_masked_gp_l1_reg_loss: 7801.8301; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38709.0430; val_chrom_access_recon_loss: 1349470.0000; val_global_loss: 2368813.0000; val_optim_loss: 2368813.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9304; val_auprc_score: 0.9216; val_best_acc_score: 0.8424; val_best_f1_score: 0.8335; train_kl_reg_loss: 15995.0194; train_edge_recon_loss: 39547.1545; train_gene_expr_recon_loss: 916767.4444; train_masked_gp_l1_reg_loss: 7775.3909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38595.4674; train_chrom_access_recon_loss: 1337726.8056; train_global_loss: 2356407.2778; train_optim_loss: 2356407.2778; val_kl_reg_loss: 15339.7334; val_edge_recon_loss: 39973.0625; val_gene_expr_recon_loss: 917186.1250; val_masked_gp_l1_reg_loss: 7752.7588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38455.6172; val_chrom_access_recon_loss: 1349298.8750; val_global_loss: 2368006.2500; val_optim_loss: 2368006.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9294; val_auprc_score: 0.9205; val_best_acc_score: 0.8436; val_best_f1_score: 0.8334; train_kl_reg_loss: 16361.9956; train_edge_recon_loss: 39570.2192; train_gene_expr_recon_loss: 920379.9097; train_masked_gp_l1_reg_loss: 7749.1521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38355.8524; train_chrom_access_recon_loss: 1342649.5972; train_global_loss: 2365066.7500; train_optim_loss: 2365066.7500; val_kl_reg_loss: 15212.6514; val_edge_recon_loss: 39975.5898; val_gene_expr_recon_loss: 916898.0000; val_masked_gp_l1_reg_loss: 7740.8535; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38230.9727; val_chrom_access_recon_loss: 1349105.2500; val_global_loss: 2367163.5000; val_optim_loss: 2367163.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9264; val_auprc_score: 0.9172; val_best_acc_score: 0.8370; val_best_f1_score: 0.8264; train_kl_reg_loss: 16040.8867; train_edge_recon_loss: 39553.6766; train_gene_expr_recon_loss: 911306.3333; train_masked_gp_l1_reg_loss: 7738.1688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38135.7257; train_chrom_access_recon_loss: 1333097.6389; train_global_loss: 2345872.4167; train_optim_loss: 2345872.4167; val_kl_reg_loss: 15084.1387; val_edge_recon_loss: 39942.3594; val_gene_expr_recon_loss: 916657.0000; val_masked_gp_l1_reg_loss: 7735.4106; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38018.3008; val_chrom_access_recon_loss: 1349012.7500; val_global_loss: 2366450.0000; val_optim_loss: 2366450.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9273; val_auprc_score: 0.9170; val_best_acc_score: 0.8403; val_best_f1_score: 0.8296; train_kl_reg_loss: 16113.0422; train_edge_recon_loss: 39527.2713; train_gene_expr_recon_loss: 914502.6250; train_masked_gp_l1_reg_loss: 7734.8781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37926.9102; train_chrom_access_recon_loss: 1342916.4167; train_global_loss: 2358721.1667; train_optim_loss: 2358721.1667; val_kl_reg_loss: 15246.9561; val_edge_recon_loss: 39942.0508; val_gene_expr_recon_loss: 916186.6875; val_masked_gp_l1_reg_loss: 7735.3569; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37815.6406; val_chrom_access_recon_loss: 1348809.6250; val_global_loss: 2365736.2500; val_optim_loss: 2365736.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 15 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9144
val AUPRC score: 0.9064
val best accuracy score: 0.8430
val best F1 score: 0.8466
val target rna MSE score: 3.8781
val source rna MSE score: 3.2481
val target atac MSE score: 0.1376
val source atac MSE score: 0.0198
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
