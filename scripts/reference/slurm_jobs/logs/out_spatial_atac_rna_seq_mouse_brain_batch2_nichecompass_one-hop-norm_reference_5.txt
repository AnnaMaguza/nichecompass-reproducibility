[True]
Run timestamp: 10082023_145555_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7997; val_auprc_score: 0.8108; val_best_acc_score: 0.6362; val_best_f1_score: 0.7199; train_kl_reg_loss: 80520.4623; train_edge_recon_loss: 3602054.6947; train_gene_expr_recon_loss: 15472644.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 11257313.2595; train_global_loss: 30412533.1450; train_optim_loss: 30412533.1450; val_kl_reg_loss: 68376.5888; val_edge_recon_loss: 4058110.1333; val_gene_expr_recon_loss: 12938312.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 10410348.7333; val_global_loss: 27475148.0000; val_optim_loss: 27475148.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8246; val_auprc_score: 0.8381; val_best_acc_score: 0.7418; val_best_f1_score: 0.7187; train_kl_reg_loss: 113335.7072; train_edge_recon_loss: 3544108.2595; train_gene_expr_recon_loss: 12732797.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 10361199.7176; train_global_loss: 26751440.8397; train_optim_loss: 26751440.8397; val_kl_reg_loss: 110174.3526; val_edge_recon_loss: 4032105.1667; val_gene_expr_recon_loss: 12388359.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 10157229.3333; val_global_loss: 26687868.6667; val_optim_loss: 26687868.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8602; val_auprc_score: 0.8606; val_best_acc_score: 0.7544; val_best_f1_score: 0.7784; train_kl_reg_loss: 97452.6423; train_edge_recon_loss: 3418051.6679; train_gene_expr_recon_loss: 12418078.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 10221393.9771; train_global_loss: 26154976.5496; train_optim_loss: 26154976.5496; val_kl_reg_loss: 122095.5813; val_edge_recon_loss: 3086316.9333; val_gene_expr_recon_loss: 12235356.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 10114918.2000; val_global_loss: 25558687.2000; val_optim_loss: 25558687.2000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8940; val_auprc_score: 0.8870; val_best_acc_score: 0.8022; val_best_f1_score: 0.8175; train_kl_reg_loss: 127615.2339; train_edge_recon_loss: 2980149.7195; train_gene_expr_recon_loss: 12255727.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 10115163.8168; train_global_loss: 25478656.0916; train_optim_loss: 25478656.0916; val_kl_reg_loss: 119098.4312; val_edge_recon_loss: 2943512.3167; val_gene_expr_recon_loss: 12049343.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9969822.0667; val_global_loss: 25081775.7333; val_optim_loss: 25081775.7333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9180; val_auprc_score: 0.9054; val_best_acc_score: 0.8430; val_best_f1_score: 0.8542; train_kl_reg_loss: 117112.4656; train_edge_recon_loss: 2911746.9065; train_gene_expr_recon_loss: 12119049.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 10013189.5573; train_global_loss: 25161097.9542; train_optim_loss: 25161097.9542; val_kl_reg_loss: 114328.8438; val_edge_recon_loss: 2843011.8167; val_gene_expr_recon_loss: 11955268.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9914871.8667; val_global_loss: 24827481.3333; val_optim_loss: 24827481.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9270; val_auprc_score: 0.9113; val_best_acc_score: 0.8595; val_best_f1_score: 0.8675; train_kl_reg_loss: 114495.4672; train_edge_recon_loss: 2850897.4847; train_gene_expr_recon_loss: 12019810.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9942275.8931; train_global_loss: 24927479.1145; train_optim_loss: 24927479.1145; val_kl_reg_loss: 113348.1594; val_edge_recon_loss: 2828938.3667; val_gene_expr_recon_loss: 11817042.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9807540.4667; val_global_loss: 24566869.3333; val_optim_loss: 24566869.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9364; val_auprc_score: 0.9232; val_best_acc_score: 0.8707; val_best_f1_score: 0.8780; train_kl_reg_loss: 111632.1883; train_edge_recon_loss: 2812363.0420; train_gene_expr_recon_loss: 11913483.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9870373.1832; train_global_loss: 24707851.6183; train_optim_loss: 24707851.6183; val_kl_reg_loss: 110958.8557; val_edge_recon_loss: 2790789.1167; val_gene_expr_recon_loss: 11748348.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9753565.3333; val_global_loss: 24403661.7333; val_optim_loss: 24403661.7333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9446; val_auprc_score: 0.9303; val_best_acc_score: 0.8870; val_best_f1_score: 0.8934; train_kl_reg_loss: 107679.6184; train_edge_recon_loss: 2787412.2576; train_gene_expr_recon_loss: 11816358.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9793285.9542; train_global_loss: 24504735.9847; train_optim_loss: 24504735.9847; val_kl_reg_loss: 103421.0302; val_edge_recon_loss: 2776943.9833; val_gene_expr_recon_loss: 11653269.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9707603.0000; val_global_loss: 24241237.6000; val_optim_loss: 24241237.6000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9515; val_auprc_score: 0.9375; val_best_acc_score: 0.8941; val_best_f1_score: 0.8991; train_kl_reg_loss: 104110.9442; train_edge_recon_loss: 2755339.4256; train_gene_expr_recon_loss: 11741785.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9730796.4733; train_global_loss: 24332032.5649; train_optim_loss: 24332032.5649; val_kl_reg_loss: 100873.5599; val_edge_recon_loss: 2753081.1000; val_gene_expr_recon_loss: 11576825.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9644976.0667; val_global_loss: 24075756.5333; val_optim_loss: 24075756.5333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9477; val_auprc_score: 0.9353; val_best_acc_score: 0.8895; val_best_f1_score: 0.8943; train_kl_reg_loss: 100560.7601; train_edge_recon_loss: 2748784.5992; train_gene_expr_recon_loss: 11669855.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9674832.4809; train_global_loss: 24194032.9008; train_optim_loss: 24194032.9008; val_kl_reg_loss: 100514.0724; val_edge_recon_loss: 2766424.6167; val_gene_expr_recon_loss: 11520608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9557167.1333; val_global_loss: 23944713.4667; val_optim_loss: 23944713.4667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9506; val_auprc_score: 0.9359; val_best_acc_score: 0.8909; val_best_f1_score: 0.8963; train_kl_reg_loss: 97463.1639; train_edge_recon_loss: 2749177.4103; train_gene_expr_recon_loss: 11607362.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9625349.4580; train_global_loss: 24079352.4885; train_optim_loss: 24079352.4885; val_kl_reg_loss: 94451.9047; val_edge_recon_loss: 2762888.1000; val_gene_expr_recon_loss: 11477154.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9539497.8667; val_global_loss: 23873992.4000; val_optim_loss: 23873992.4000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9540; val_auprc_score: 0.9414; val_best_acc_score: 0.8954; val_best_f1_score: 0.9014; train_kl_reg_loss: 93783.5223; train_edge_recon_loss: 2733644.7767; train_gene_expr_recon_loss: 11553494.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9583172.3626; train_global_loss: 23964094.9771; train_optim_loss: 23964094.9771; val_kl_reg_loss: 95188.7099; val_edge_recon_loss: 2742309.4500; val_gene_expr_recon_loss: 11369835.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9476409.0000; val_global_loss: 23683742.8000; val_optim_loss: 23683742.8000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9622; val_auprc_score: 0.9526; val_best_acc_score: 0.9073; val_best_f1_score: 0.9114; train_kl_reg_loss: 91529.3544; train_edge_recon_loss: 2726592.8569; train_gene_expr_recon_loss: 11496244.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9527121.0458; train_global_loss: 23841487.7099; train_optim_loss: 23841487.7099; val_kl_reg_loss: 93333.6562; val_edge_recon_loss: 2706132.2500; val_gene_expr_recon_loss: 11378359.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9454892.5333; val_global_loss: 23632717.6000; val_optim_loss: 23632717.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9619; val_auprc_score: 0.9482; val_best_acc_score: 0.9097; val_best_f1_score: 0.9145; train_kl_reg_loss: 90592.0731; train_edge_recon_loss: 2715068.9542; train_gene_expr_recon_loss: 11441600.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9480517.4275; train_global_loss: 23727778.8092; train_optim_loss: 23727778.8092; val_kl_reg_loss: 87756.8703; val_edge_recon_loss: 2728366.1167; val_gene_expr_recon_loss: 11321297.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9382842.4667; val_global_loss: 23520262.5333; val_optim_loss: 23520262.5333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9616; val_auprc_score: 0.9487; val_best_acc_score: 0.9066; val_best_f1_score: 0.9110; train_kl_reg_loss: 86265.3627; train_edge_recon_loss: 2720866.8740; train_gene_expr_recon_loss: 11404935.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9446718.8473; train_global_loss: 23658786.2290; train_optim_loss: 23658786.2290; val_kl_reg_loss: 85201.5406; val_edge_recon_loss: 2724570.3167; val_gene_expr_recon_loss: 11303465.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9337456.0000; val_global_loss: 23450693.4667; val_optim_loss: 23450693.4667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9660; val_auprc_score: 0.9555; val_best_acc_score: 0.9140; val_best_f1_score: 0.9167; train_kl_reg_loss: 85100.4187; train_edge_recon_loss: 2709057.6775; train_gene_expr_recon_loss: 11357250.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9397129.3740; train_global_loss: 23548537.9847; train_optim_loss: 23548537.9847; val_kl_reg_loss: 84004.7615; val_edge_recon_loss: 2716971.3667; val_gene_expr_recon_loss: 11249509.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9333486.0000; val_global_loss: 23383972.0000; val_optim_loss: 23383972.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9683; val_auprc_score: 0.9583; val_best_acc_score: 0.9162; val_best_f1_score: 0.9206; train_kl_reg_loss: 82846.5828; train_edge_recon_loss: 2705733.5706; train_gene_expr_recon_loss: 11322767.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9371826.9847; train_global_loss: 23483174.6260; train_optim_loss: 23483174.6260; val_kl_reg_loss: 80935.6797; val_edge_recon_loss: 2709138.3167; val_gene_expr_recon_loss: 11224353.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9297755.0000; val_global_loss: 23312182.9333; val_optim_loss: 23312182.9333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9686; val_auprc_score: 0.9593; val_best_acc_score: 0.9200; val_best_f1_score: 0.9227; train_kl_reg_loss: 80637.3932; train_edge_recon_loss: 2695563.1050; train_gene_expr_recon_loss: 11295126.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9346252.1450; train_global_loss: 23417579.4046; train_optim_loss: 23417579.4046; val_kl_reg_loss: 80830.3125; val_edge_recon_loss: 2697914.5667; val_gene_expr_recon_loss: 11201724.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9258536.0000; val_global_loss: 23239005.3333; val_optim_loss: 23239005.3333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9694; val_auprc_score: 0.9623; val_best_acc_score: 0.9232; val_best_f1_score: 0.9264; train_kl_reg_loss: 78392.5609; train_edge_recon_loss: 2696444.7290; train_gene_expr_recon_loss: 11249768.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9296616.9046; train_global_loss: 23321222.5496; train_optim_loss: 23321222.5496; val_kl_reg_loss: 80018.5870; val_edge_recon_loss: 2712984.4333; val_gene_expr_recon_loss: 11108686.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9220345.8667; val_global_loss: 23122035.0667; val_optim_loss: 23122035.0667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9733; val_auprc_score: 0.9648; val_best_acc_score: 0.9275; val_best_f1_score: 0.9301; train_kl_reg_loss: 78164.0103; train_edge_recon_loss: 2684687.2328; train_gene_expr_recon_loss: 11222508.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9267570.3740; train_global_loss: 23252929.6947; train_optim_loss: 23252929.6947; val_kl_reg_loss: 75864.6641; val_edge_recon_loss: 2695871.5833; val_gene_expr_recon_loss: 11112512.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9166659.5667; val_global_loss: 23050908.5333; val_optim_loss: 23050908.5333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9743; val_auprc_score: 0.9672; val_best_acc_score: 0.9305; val_best_f1_score: 0.9328; train_kl_reg_loss: 77018.4803; train_edge_recon_loss: 2686954.9885; train_gene_expr_recon_loss: 11197977.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9244574.1985; train_global_loss: 23206525.0076; train_optim_loss: 23206525.0076; val_kl_reg_loss: 75708.3167; val_edge_recon_loss: 2691156.0167; val_gene_expr_recon_loss: 11091031.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9146617.4667; val_global_loss: 23004513.2000; val_optim_loss: 23004513.2000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9754; val_auprc_score: 0.9695; val_best_acc_score: 0.9299; val_best_f1_score: 0.9321; train_kl_reg_loss: 75744.5054; train_edge_recon_loss: 2687642.4695; train_gene_expr_recon_loss: 11172896.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9222086.7786; train_global_loss: 23158369.8473; train_optim_loss: 23158369.8473; val_kl_reg_loss: 75107.3521; val_edge_recon_loss: 2689842.3833; val_gene_expr_recon_loss: 11061263.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9115823.8000; val_global_loss: 22942036.9333; val_optim_loss: 22942036.9333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9777; val_auprc_score: 0.9725; val_best_acc_score: 0.9325; val_best_f1_score: 0.9345; train_kl_reg_loss: 74746.5529; train_edge_recon_loss: 2683437.9332; train_gene_expr_recon_loss: 11143715.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9193035.3855; train_global_loss: 23094934.8550; train_optim_loss: 23094934.8550; val_kl_reg_loss: 72808.3214; val_edge_recon_loss: 2691644.7667; val_gene_expr_recon_loss: 11018350.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9087293.3333; val_global_loss: 22870096.5333; val_optim_loss: 22870096.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9766; val_auprc_score: 0.9708; val_best_acc_score: 0.9301; val_best_f1_score: 0.9328; train_kl_reg_loss: 73099.0622; train_edge_recon_loss: 2667052.5840; train_gene_expr_recon_loss: 11120212.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9169706.3740; train_global_loss: 23030070.3817; train_optim_loss: 23030070.3817; val_kl_reg_loss: 71338.3380; val_edge_recon_loss: 2706838.6833; val_gene_expr_recon_loss: 11053831.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9126069.3333; val_global_loss: 22958077.4667; val_optim_loss: 22958077.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9801; val_auprc_score: 0.9746; val_best_acc_score: 0.9376; val_best_f1_score: 0.9397; train_kl_reg_loss: 72119.0792; train_edge_recon_loss: 2674665.1737; train_gene_expr_recon_loss: 11108138.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9150513.1527; train_global_loss: 23005435.6794; train_optim_loss: 23005435.6794; val_kl_reg_loss: 72203.9286; val_edge_recon_loss: 2683405.3167; val_gene_expr_recon_loss: 11013893.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9122031.1333; val_global_loss: 22891533.7333; val_optim_loss: 22891533.7333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9493; val_auprc_score: 0.9372; val_best_acc_score: 0.8866; val_best_f1_score: 0.8936; train_kl_reg_loss: 94808.5682; train_edge_recon_loss: 2838094.4561; train_gene_expr_recon_loss: 13160038.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9590238.4809; train_global_loss: 25683180.0305; train_optim_loss: 25683180.0305; val_kl_reg_loss: 9622.6733; val_edge_recon_loss: 2754415.9333; val_gene_expr_recon_loss: 13220037.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9587432.3333; val_global_loss: 25571507.7333; val_optim_loss: 25571507.7333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9557; val_auprc_score: 0.9405; val_best_acc_score: 0.9026; val_best_f1_score: 0.9065; train_kl_reg_loss: 44356.1402; train_edge_recon_loss: 2731522.1031; train_gene_expr_recon_loss: 13279938.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9597267.9618; train_global_loss: 25653084.9924; train_optim_loss: 25653084.9924; val_kl_reg_loss: 12574.2563; val_edge_recon_loss: 2726224.3167; val_gene_expr_recon_loss: 13042178.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9484158.5333; val_global_loss: 25265136.1333; val_optim_loss: 25265136.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9599; val_auprc_score: 0.9468; val_best_acc_score: 0.9113; val_best_f1_score: 0.9157; train_kl_reg_loss: 39292.7581; train_edge_recon_loss: 2701737.8779; train_gene_expr_recon_loss: 13160405.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9563487.3740; train_global_loss: 25464923.0992; train_optim_loss: 25464923.0992; val_kl_reg_loss: 12485.7846; val_edge_recon_loss: 2696604.7333; val_gene_expr_recon_loss: 13010140.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9498988.8667; val_global_loss: 25218219.6000; val_optim_loss: 25218219.6000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9620; val_auprc_score: 0.9514; val_best_acc_score: 0.9078; val_best_f1_score: 0.9127; train_kl_reg_loss: 37054.9125; train_edge_recon_loss: 2704009.3282; train_gene_expr_recon_loss: 13150542.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9559430.0153; train_global_loss: 25451036.7481; train_optim_loss: 25451036.7481; val_kl_reg_loss: 12796.8435; val_edge_recon_loss: 2697122.1833; val_gene_expr_recon_loss: 13028650.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9522881.0000; val_global_loss: 25261450.1333; val_optim_loss: 25261450.1333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9622; val_auprc_score: 0.9477; val_best_acc_score: 0.9136; val_best_f1_score: 0.9160; train_kl_reg_loss: 35810.7039; train_edge_recon_loss: 2689156.1985; train_gene_expr_recon_loss: 13128210.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9548631.3130; train_global_loss: 25401808.9771; train_optim_loss: 25401808.9771; val_kl_reg_loss: 13285.6024; val_edge_recon_loss: 2671044.7500; val_gene_expr_recon_loss: 12944697.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9477124.8667; val_global_loss: 25106152.5333; val_optim_loss: 25106152.5333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9582; val_auprc_score: 0.9442; val_best_acc_score: 0.9035; val_best_f1_score: 0.9080; train_kl_reg_loss: 34618.0378; train_edge_recon_loss: 2690796.6527; train_gene_expr_recon_loss: 13132485.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 9561333.6489; train_global_loss: 25419233.9084; train_optim_loss: 25419233.9084; val_kl_reg_loss: 13339.9785; val_edge_recon_loss: 2706371.6667; val_gene_expr_recon_loss: 13017464.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 9512259.2667; val_global_loss: 25249435.0667; val_optim_loss: 25249435.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 39 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9757
val AUPRC score: 0.9677
val best accuracy score: 0.9301
val best F1 score: 0.9328
val target rna MSE score: 1.2556
val source rna MSE score: 0.4438
val target atac MSE score: 0.1252
val source atac MSE score: 0.1176
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
