[True]
Run timestamp: 24072023_165436_53.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_53']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9034; val_auprc_score: 0.9105; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 15969.0320; train_edge_recon_loss: 3505847.6667; train_gene_expr_recon_loss: 31256270.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 107268181.3333; train_global_loss: 142046272.0000; train_optim_loss: 142046272.0000; val_kl_reg_loss: 85018.5781; val_edge_recon_loss: 4065815.0000; val_gene_expr_recon_loss: 30524806.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 107867560.0000; val_global_loss: 142543200.0000; val_optim_loss: 142543200.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8964; val_auprc_score: 0.9034; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 82339.3177; train_edge_recon_loss: 3612750.5278; train_gene_expr_recon_loss: 28373297.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 104967203.5556; train_global_loss: 137035590.2222; train_optim_loss: 137035590.2222; val_kl_reg_loss: 84604.9688; val_edge_recon_loss: 4065957.0000; val_gene_expr_recon_loss: 27601188.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 105108016.0000; val_global_loss: 136859760.0000; val_optim_loss: 136859760.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8858; val_auprc_score: 0.8891; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 119759.0703; train_edge_recon_loss: 3682724.5000; train_gene_expr_recon_loss: 25792082.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102334704.0000; train_global_loss: 131929272.0000; train_optim_loss: 131929272.0000; val_kl_reg_loss: 168769.9219; val_edge_recon_loss: 4065958.2500; val_gene_expr_recon_loss: 25478496.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 103481584.0000; val_global_loss: 133194808.0000; val_optim_loss: 133194808.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8916; val_auprc_score: 0.8949; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 175571.6406; train_edge_recon_loss: 3701752.5833; train_gene_expr_recon_loss: 24211706.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101374066.6667; train_global_loss: 129463096.8889; train_optim_loss: 129463096.8889; val_kl_reg_loss: 167512.5000; val_edge_recon_loss: 4065932.7500; val_gene_expr_recon_loss: 24164188.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101710280.0000; val_global_loss: 130107912.0000; val_optim_loss: 130107912.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9016; val_auprc_score: 0.9049; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 201146.3941; train_edge_recon_loss: 3706251.3889; train_gene_expr_recon_loss: 23352922.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100003883.5556; train_global_loss: 127264201.7778; train_optim_loss: 127264201.7778; val_kl_reg_loss: 206135.4844; val_edge_recon_loss: 4065872.7500; val_gene_expr_recon_loss: 23288304.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100642776.0000; val_global_loss: 128203088.0000; val_optim_loss: 128203088.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9012; val_auprc_score: 0.8951; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 227782.3819; train_edge_recon_loss: 3697947.9722; train_gene_expr_recon_loss: 22344503.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99220432.0000; train_global_loss: 125490665.7778; train_optim_loss: 125490665.7778; val_kl_reg_loss: 231155.0312; val_edge_recon_loss: 4065785.7500; val_gene_expr_recon_loss: 22672750.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99840272.0000; val_global_loss: 126809968.0000; val_optim_loss: 126809968.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8964; val_auprc_score: 0.8921; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 248487.6441; train_edge_recon_loss: 3698261.1389; train_gene_expr_recon_loss: 21912491.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98102488.8889; train_global_loss: 123961729.7778; train_optim_loss: 123961729.7778; val_kl_reg_loss: 226327.7969; val_edge_recon_loss: 4065589.5000; val_gene_expr_recon_loss: 22217284.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99575824.0000; val_global_loss: 126085024.0000; val_optim_loss: 126085024.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8896; val_auprc_score: 0.8853; val_best_acc_score: 0.5050; val_best_f1_score: 0.6689; train_kl_reg_loss: 267162.0833; train_edge_recon_loss: 3683641.8333; train_gene_expr_recon_loss: 21373453.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98033887.1111; train_global_loss: 123358143.1111; train_optim_loss: 123358143.1111; val_kl_reg_loss: 228353.1875; val_edge_recon_loss: 4065222.2500; val_gene_expr_recon_loss: 21920352.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99154464.0000; val_global_loss: 125368392.0000; val_optim_loss: 125368392.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8869; val_auprc_score: 0.8852; val_best_acc_score: 0.5135; val_best_f1_score: 0.6727; train_kl_reg_loss: 269271.0799; train_edge_recon_loss: 3684731.8889; train_gene_expr_recon_loss: 21266380.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97744893.3333; train_global_loss: 122965277.3333; train_optim_loss: 122965277.3333; val_kl_reg_loss: 214137.5625; val_edge_recon_loss: 4064549.7500; val_gene_expr_recon_loss: 21777472.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99032392.0000; val_global_loss: 125088552.0000; val_optim_loss: 125088552.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8926; val_auprc_score: 0.8913; val_best_acc_score: 0.5220; val_best_f1_score: 0.6765; train_kl_reg_loss: 262416.1424; train_edge_recon_loss: 3688284.3611; train_gene_expr_recon_loss: 21142526.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97480165.3333; train_global_loss: 122573392.0000; train_optim_loss: 122573392.0000; val_kl_reg_loss: 236907.6562; val_edge_recon_loss: 4063785.2500; val_gene_expr_recon_loss: 21641896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98806416.0000; val_global_loss: 124749008.0000; val_optim_loss: 124749008.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8969; val_auprc_score: 0.8947; val_best_acc_score: 0.5418; val_best_f1_score: 0.6851; train_kl_reg_loss: 278791.2639; train_edge_recon_loss: 3657351.7500; train_gene_expr_recon_loss: 20941856.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96659697.7778; train_global_loss: 121537696.8889; train_optim_loss: 121537696.8889; val_kl_reg_loss: 220372.7344; val_edge_recon_loss: 4062671.7500; val_gene_expr_recon_loss: 21556068.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98560336.0000; val_global_loss: 124399448.0000; val_optim_loss: 124399448.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8997; val_auprc_score: 0.8896; val_best_acc_score: 0.5775; val_best_f1_score: 0.7016; train_kl_reg_loss: 266692.4931; train_edge_recon_loss: 3664179.1389; train_gene_expr_recon_loss: 20932131.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97100327.1111; train_global_loss: 121963331.5556; train_optim_loss: 121963331.5556; val_kl_reg_loss: 215907.4062; val_edge_recon_loss: 4061148.2500; val_gene_expr_recon_loss: 21501216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98386112.0000; val_global_loss: 124164384.0000; val_optim_loss: 124164384.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9017; val_auprc_score: 0.8899; val_best_acc_score: 0.6072; val_best_f1_score: 0.7165; train_kl_reg_loss: 251819.9462; train_edge_recon_loss: 3672096.3056; train_gene_expr_recon_loss: 20880622.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96485491.5556; train_global_loss: 121290030.2222; train_optim_loss: 121290030.2222; val_kl_reg_loss: 218214.6562; val_edge_recon_loss: 4059853.5000; val_gene_expr_recon_loss: 21426264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98159104.0000; val_global_loss: 123863440.0000; val_optim_loss: 123863440.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9064; val_auprc_score: 0.8979; val_best_acc_score: 0.6521; val_best_f1_score: 0.7393; train_kl_reg_loss: 267388.9080; train_edge_recon_loss: 3646111.9444; train_gene_expr_recon_loss: 20892544.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97316706.6667; train_global_loss: 122122751.1111; train_optim_loss: 122122751.1111; val_kl_reg_loss: 229083.1875; val_edge_recon_loss: 4057299.0000; val_gene_expr_recon_loss: 21405004.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98230448.0000; val_global_loss: 123921832.0000; val_optim_loss: 123921832.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9089; val_auprc_score: 0.8957; val_best_acc_score: 0.7123; val_best_f1_score: 0.7730; train_kl_reg_loss: 255168.9931; train_edge_recon_loss: 3645240.3056; train_gene_expr_recon_loss: 20737206.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96548067.5556; train_global_loss: 121185682.6667; train_optim_loss: 121185682.6667; val_kl_reg_loss: 208278.9219; val_edge_recon_loss: 4053385.0000; val_gene_expr_recon_loss: 21333550.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97836432.0000; val_global_loss: 123431648.0000; val_optim_loss: 123431648.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9081; val_auprc_score: 0.8940; val_best_acc_score: 0.7619; val_best_f1_score: 0.8019; train_kl_reg_loss: 257933.8490; train_edge_recon_loss: 3637280.6111; train_gene_expr_recon_loss: 20921505.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96999786.6667; train_global_loss: 121816507.5556; train_optim_loss: 121816507.5556; val_kl_reg_loss: 205655.8750; val_edge_recon_loss: 4047902.0000; val_gene_expr_recon_loss: 21322436.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98052872.0000; val_global_loss: 123628864.0000; val_optim_loss: 123628864.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9054; val_auprc_score: 0.8912; val_best_acc_score: 0.7944; val_best_f1_score: 0.8219; train_kl_reg_loss: 246961.2639; train_edge_recon_loss: 3638309.3611; train_gene_expr_recon_loss: 20878101.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97164552.0000; train_global_loss: 121927924.4444; train_optim_loss: 121927924.4444; val_kl_reg_loss: 213066.6562; val_edge_recon_loss: 4041276.7500; val_gene_expr_recon_loss: 21269098.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97854256.0000; val_global_loss: 123377696.0000; val_optim_loss: 123377696.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9181; val_auprc_score: 0.9075; val_best_acc_score: 0.8354; val_best_f1_score: 0.8494; train_kl_reg_loss: 255434.2153; train_edge_recon_loss: 3618903.8889; train_gene_expr_recon_loss: 20837188.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96801822.2222; train_global_loss: 121513351.1111; train_optim_loss: 121513351.1111; val_kl_reg_loss: 199939.2188; val_edge_recon_loss: 4031094.2500; val_gene_expr_recon_loss: 21237942.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97717536.0000; val_global_loss: 123186512.0000; val_optim_loss: 123186512.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9142; val_auprc_score: 0.9029; val_best_acc_score: 0.8424; val_best_f1_score: 0.8505; train_kl_reg_loss: 242638.7934; train_edge_recon_loss: 3626628.8333; train_gene_expr_recon_loss: 20640917.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96396946.6667; train_global_loss: 120907130.6667; train_optim_loss: 120907130.6667; val_kl_reg_loss: 206564.0625; val_edge_recon_loss: 4020898.0000; val_gene_expr_recon_loss: 21192816.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97544696.0000; val_global_loss: 122964976.0000; val_optim_loss: 122964976.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9156; val_auprc_score: 0.9037; val_best_acc_score: 0.8407; val_best_f1_score: 0.8430; train_kl_reg_loss: 240680.1476; train_edge_recon_loss: 3615689.7500; train_gene_expr_recon_loss: 20625428.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95820338.6667; train_global_loss: 120302136.8889; train_optim_loss: 120302136.8889; val_kl_reg_loss: 212380.1875; val_edge_recon_loss: 4005153.0000; val_gene_expr_recon_loss: 21185230.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97626584.0000; val_global_loss: 123029344.0000; val_optim_loss: 123029344.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9166; val_auprc_score: 0.9008; val_best_acc_score: 0.8406; val_best_f1_score: 0.8357; train_kl_reg_loss: 238949.3715; train_edge_recon_loss: 3605196.7778; train_gene_expr_recon_loss: 20538015.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96307144.8889; train_global_loss: 120689304.8889; train_optim_loss: 120689304.8889; val_kl_reg_loss: 201886.0000; val_edge_recon_loss: 3989341.5000; val_gene_expr_recon_loss: 21138898.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97337984.0000; val_global_loss: 122668112.0000; val_optim_loss: 122668112.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9186; val_auprc_score: 0.9094; val_best_acc_score: 0.8235; val_best_f1_score: 0.8090; train_kl_reg_loss: 232797.3056; train_edge_recon_loss: 3601426.8333; train_gene_expr_recon_loss: 20706693.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96205224.8889; train_global_loss: 120746143.1111; train_optim_loss: 120746143.1111; val_kl_reg_loss: 191060.3906; val_edge_recon_loss: 3960676.0000; val_gene_expr_recon_loss: 21124868.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97380184.0000; val_global_loss: 122656784.0000; val_optim_loss: 122656784.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9172; val_auprc_score: 0.9032; val_best_acc_score: 0.8050; val_best_f1_score: 0.8275; train_kl_reg_loss: 226577.0955; train_edge_recon_loss: 3594308.9444; train_gene_expr_recon_loss: 20451390.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96015945.7778; train_global_loss: 120288223.1111; train_optim_loss: 120288223.1111; val_kl_reg_loss: 200391.6719; val_edge_recon_loss: 3928320.5000; val_gene_expr_recon_loss: 21111704.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97400216.0000; val_global_loss: 122640632.0000; val_optim_loss: 122640632.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9138; val_auprc_score: 0.8987; val_best_acc_score: 0.8153; val_best_f1_score: 0.8366; train_kl_reg_loss: 229663.5434; train_edge_recon_loss: 3571450.7778; train_gene_expr_recon_loss: 20555634.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95584784.0000; train_global_loss: 119941530.6667; train_optim_loss: 119941530.6667; val_kl_reg_loss: 190142.7812; val_edge_recon_loss: 3885860.7500; val_gene_expr_recon_loss: 21065922.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97208416.0000; val_global_loss: 122350344.0000; val_optim_loss: 122350344.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9153; val_auprc_score: 0.9006; val_best_acc_score: 0.8243; val_best_f1_score: 0.8407; train_kl_reg_loss: 213294.2049; train_edge_recon_loss: 3564425.3333; train_gene_expr_recon_loss: 20547169.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95529377.7778; train_global_loss: 119854264.8889; train_optim_loss: 119854264.8889; val_kl_reg_loss: 189610.5938; val_edge_recon_loss: 3839008.2500; val_gene_expr_recon_loss: 21036668.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96904800.0000; val_global_loss: 121970088.0000; val_optim_loss: 121970088.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9240; val_auprc_score: 0.9073; val_best_acc_score: 0.8309; val_best_f1_score: 0.8258; train_kl_reg_loss: 230006.8924; train_edge_recon_loss: 3717870.1667; train_gene_expr_recon_loss: 20549356.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95299154.6667; train_global_loss: 119796386.6667; train_optim_loss: 119796386.6667; val_kl_reg_loss: 136780.7656; val_edge_recon_loss: 3945192.5000; val_gene_expr_recon_loss: 21087398.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97115184.0000; val_global_loss: 122284560.0000; val_optim_loss: 122284560.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9293; val_auprc_score: 0.9134; val_best_acc_score: 0.8573; val_best_f1_score: 0.8581; train_kl_reg_loss: 210489.6233; train_edge_recon_loss: 3679709.0000; train_gene_expr_recon_loss: 20617435.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95777177.7778; train_global_loss: 120284811.5556; train_optim_loss: 120284811.5556; val_kl_reg_loss: 152893.3750; val_edge_recon_loss: 3990141.5000; val_gene_expr_recon_loss: 21097964.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97041200.0000; val_global_loss: 122282200.0000; val_optim_loss: 122282200.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9282; val_auprc_score: 0.9081; val_best_acc_score: 0.8538; val_best_f1_score: 0.8516; train_kl_reg_loss: 179732.6554; train_edge_recon_loss: 3785347.8889; train_gene_expr_recon_loss: 20470214.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95328115.5556; train_global_loss: 119763409.7778; train_optim_loss: 119763409.7778; val_kl_reg_loss: 102974.1953; val_edge_recon_loss: 3979030.2500; val_gene_expr_recon_loss: 21065764.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97064280.0000; val_global_loss: 122212048.0000; val_optim_loss: 122212048.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9264; val_auprc_score: 0.9056; val_best_acc_score: 0.8507; val_best_f1_score: 0.8465; train_kl_reg_loss: 121567.8325; train_edge_recon_loss: 3817548.8889; train_gene_expr_recon_loss: 20529272.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95216105.7778; train_global_loss: 119684495.1111; train_optim_loss: 119684495.1111; val_kl_reg_loss: 91644.1016; val_edge_recon_loss: 3972248.7500; val_gene_expr_recon_loss: 21063966.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96882944.0000; val_global_loss: 122010800.0000; val_optim_loss: 122010800.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9311; val_auprc_score: 0.9166; val_best_acc_score: 0.8537; val_best_f1_score: 0.8498; train_kl_reg_loss: 97164.3967; train_edge_recon_loss: 3866705.3611; train_gene_expr_recon_loss: 20628142.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95636195.5556; train_global_loss: 120228208.0000; train_optim_loss: 120228208.0000; val_kl_reg_loss: 98899.2266; val_edge_recon_loss: 3975076.7500; val_gene_expr_recon_loss: 21051362.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96979312.0000; val_global_loss: 122104648.0000; val_optim_loss: 122104648.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9225; val_auprc_score: 0.9023; val_best_acc_score: 0.8464; val_best_f1_score: 0.8439; train_kl_reg_loss: 138748.4340; train_edge_recon_loss: 3778897.3889; train_gene_expr_recon_loss: 20559164.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95512790.2222; train_global_loss: 119989600.8889; train_optim_loss: 119989600.8889; val_kl_reg_loss: 137406.3750; val_edge_recon_loss: 3973419.7500; val_gene_expr_recon_loss: 21019664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96930296.0000; val_global_loss: 122060784.0000; val_optim_loss: 122060784.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9259; val_auprc_score: 0.9065; val_best_acc_score: 0.8486; val_best_f1_score: 0.8452; train_kl_reg_loss: 135681.4844; train_edge_recon_loss: 3761608.2222; train_gene_expr_recon_loss: 20617127.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95880910.2222; train_global_loss: 120395328.8889; train_optim_loss: 120395328.8889; val_kl_reg_loss: 121451.4375; val_edge_recon_loss: 3972332.0000; val_gene_expr_recon_loss: 21033392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96894648.0000; val_global_loss: 122021824.0000; val_optim_loss: 122021824.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9260; val_auprc_score: 0.9089; val_best_acc_score: 0.8475; val_best_f1_score: 0.8439; train_kl_reg_loss: 143114.3941; train_edge_recon_loss: 3739977.8611; train_gene_expr_recon_loss: 20427927.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95682986.6667; train_global_loss: 119994007.1111; train_optim_loss: 119994007.1111; val_kl_reg_loss: 139979.1719; val_edge_recon_loss: 3969565.7500; val_gene_expr_recon_loss: 21022836.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96957368.0000; val_global_loss: 122089744.0000; val_optim_loss: 122089744.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 50 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9246
Val AUPRC score: 0.9100
Val best accuracy score: 0.8238
Val best F1 score: 0.8297
Val gene expr MSE score: 0.4140
Val chrom access MSE score: 0.0876
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
