[True]
Run timestamp: 26072023_020412_53.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_53']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9119; val_auprc_score: 0.9192; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7613.4883; train_edge_recon_loss: 356879.8958; train_gene_expr_recon_loss: 31541245.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 107224197.3333; train_global_loss: 139129940.4444; train_optim_loss: 139129940.4444; val_kl_reg_loss: 18129.1680; val_edge_recon_loss: 406590.7500; val_gene_expr_recon_loss: 30008786.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 106195368.0000; val_global_loss: 136628880.0000; val_optim_loss: 136628880.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8934; val_auprc_score: 0.8961; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 33618.4603; train_edge_recon_loss: 378381.7535; train_gene_expr_recon_loss: 28634257.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 105611787.5556; train_global_loss: 134658045.3333; train_optim_loss: 134658045.3333; val_kl_reg_loss: 50993.4219; val_edge_recon_loss: 406599.4688; val_gene_expr_recon_loss: 27069982.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 103517992.0000; val_global_loss: 131045568.0000; val_optim_loss: 131045568.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8891; val_auprc_score: 0.8902; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 68814.2192; train_edge_recon_loss: 398747.4375; train_gene_expr_recon_loss: 25753217.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102770703.1111; train_global_loss: 128991480.8889; train_optim_loss: 128991480.8889; val_kl_reg_loss: 105381.9219; val_edge_recon_loss: 406607.7812; val_gene_expr_recon_loss: 24564628.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101167096.0000; val_global_loss: 126243712.0000; val_optim_loss: 126243712.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8860; val_auprc_score: 0.8889; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 118046.8090; train_edge_recon_loss: 403333.5903; train_gene_expr_recon_loss: 23968392.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101171995.5556; train_global_loss: 125661768.0000; train_optim_loss: 125661768.0000; val_kl_reg_loss: 127577.8125; val_edge_recon_loss: 406605.6250; val_gene_expr_recon_loss: 23515750.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99727728.0000; val_global_loss: 123777664.0000; val_optim_loss: 123777664.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8787; val_auprc_score: 0.8852; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 130137.4688; train_edge_recon_loss: 404087.6667; train_gene_expr_recon_loss: 23201160.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99902339.5556; train_global_loss: 123637725.3333; train_optim_loss: 123637725.3333; val_kl_reg_loss: 137391.0000; val_edge_recon_loss: 406604.7188; val_gene_expr_recon_loss: 22773722.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98706832.0000; val_global_loss: 122024552.0000; val_optim_loss: 122024552.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8859; val_auprc_score: 0.8899; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 148879.7795; train_edge_recon_loss: 405342.8750; train_gene_expr_recon_loss: 22511051.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98694682.6667; train_global_loss: 121759957.3333; train_optim_loss: 121759957.3333; val_kl_reg_loss: 154734.5312; val_edge_recon_loss: 406599.6562; val_gene_expr_recon_loss: 22268182.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98064128.0000; val_global_loss: 120893648.0000; val_optim_loss: 120893648.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8877; val_auprc_score: 0.8903; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 163017.5903; train_edge_recon_loss: 405849.2326; train_gene_expr_recon_loss: 21985250.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98176215.1111; train_global_loss: 120730331.5556; train_optim_loss: 120730331.5556; val_kl_reg_loss: 167770.5625; val_edge_recon_loss: 406584.3750; val_gene_expr_recon_loss: 21882806.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97799088.0000; val_global_loss: 120256248.0000; val_optim_loss: 120256248.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8850; val_auprc_score: 0.8774; val_best_acc_score: 0.5020; val_best_f1_score: 0.6676; train_kl_reg_loss: 172449.6111; train_edge_recon_loss: 405936.8229; train_gene_expr_recon_loss: 21780412.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98525283.5556; train_global_loss: 120884082.6667; train_optim_loss: 120884082.6667; val_kl_reg_loss: 165086.1250; val_edge_recon_loss: 406552.3125; val_gene_expr_recon_loss: 21589234.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97312816.0000; val_global_loss: 119473688.0000; val_optim_loss: 119473688.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8899; val_auprc_score: 0.8812; val_best_acc_score: 0.5110; val_best_f1_score: 0.6716; train_kl_reg_loss: 171416.6510; train_edge_recon_loss: 405902.1979; train_gene_expr_recon_loss: 21415561.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97745902.2222; train_global_loss: 119738782.2222; train_optim_loss: 119738782.2222; val_kl_reg_loss: 172266.0781; val_edge_recon_loss: 406495.2812; val_gene_expr_recon_loss: 21400694.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97098168.0000; val_global_loss: 119077624.0000; val_optim_loss: 119077624.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8870; val_auprc_score: 0.8812; val_best_acc_score: 0.5175; val_best_f1_score: 0.6744; train_kl_reg_loss: 176406.3056; train_edge_recon_loss: 405802.9653; train_gene_expr_recon_loss: 21254072.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97567043.5556; train_global_loss: 119403325.3333; train_optim_loss: 119403325.3333; val_kl_reg_loss: 173227.3281; val_edge_recon_loss: 406425.3750; val_gene_expr_recon_loss: 21252640.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96968544.0000; val_global_loss: 118800832.0000; val_optim_loss: 118800832.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8831; val_auprc_score: 0.8709; val_best_acc_score: 0.5300; val_best_f1_score: 0.6799; train_kl_reg_loss: 177087.8090; train_edge_recon_loss: 405813.5000; train_gene_expr_recon_loss: 21266025.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97451925.3333; train_global_loss: 119300851.5556; train_optim_loss: 119300851.5556; val_kl_reg_loss: 170442.8125; val_edge_recon_loss: 406322.9688; val_gene_expr_recon_loss: 21145916.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96745040.0000; val_global_loss: 118467720.0000; val_optim_loss: 118467720.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8830; val_auprc_score: 0.8731; val_best_acc_score: 0.5543; val_best_f1_score: 0.6911; train_kl_reg_loss: 174055.4132; train_edge_recon_loss: 405668.2882; train_gene_expr_recon_loss: 21076089.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97073600.8889; train_global_loss: 118729413.3333; train_optim_loss: 118729413.3333; val_kl_reg_loss: 170283.7188; val_edge_recon_loss: 406210.6250; val_gene_expr_recon_loss: 21093286.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96572848.0000; val_global_loss: 118242624.0000; val_optim_loss: 118242624.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8874; val_auprc_score: 0.8795; val_best_acc_score: 0.5825; val_best_f1_score: 0.7040; train_kl_reg_loss: 172133.3160; train_edge_recon_loss: 405506.5278; train_gene_expr_recon_loss: 20977571.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96670248.8889; train_global_loss: 118225459.5556; train_optim_loss: 118225459.5556; val_kl_reg_loss: 169875.0156; val_edge_recon_loss: 406069.1875; val_gene_expr_recon_loss: 21037338.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96552904.0000; val_global_loss: 118166184.0000; val_optim_loss: 118166184.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8885; val_auprc_score: 0.8790; val_best_acc_score: 0.6188; val_best_f1_score: 0.7217; train_kl_reg_loss: 169672.4201; train_edge_recon_loss: 405335.7326; train_gene_expr_recon_loss: 20901566.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96684859.5556; train_global_loss: 118161433.7778; train_optim_loss: 118161433.7778; val_kl_reg_loss: 164921.2188; val_edge_recon_loss: 405854.2188; val_gene_expr_recon_loss: 20978012.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96459392.0000; val_global_loss: 118008176.0000; val_optim_loss: 118008176.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8938; val_auprc_score: 0.8789; val_best_acc_score: 0.6672; val_best_f1_score: 0.7472; train_kl_reg_loss: 167026.8646; train_edge_recon_loss: 405116.6181; train_gene_expr_recon_loss: 20946939.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96714864.0000; train_global_loss: 118233946.6667; train_optim_loss: 118233946.6667; val_kl_reg_loss: 158767.2500; val_edge_recon_loss: 405495.3125; val_gene_expr_recon_loss: 20957188.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96321720.0000; val_global_loss: 117843168.0000; val_optim_loss: 117843168.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9008; val_auprc_score: 0.8932; val_best_acc_score: 0.7065; val_best_f1_score: 0.7690; train_kl_reg_loss: 164833.5312; train_edge_recon_loss: 404843.1285; train_gene_expr_recon_loss: 20930354.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96685192.0000; train_global_loss: 118185223.1111; train_optim_loss: 118185223.1111; val_kl_reg_loss: 152602.0781; val_edge_recon_loss: 405150.5625; val_gene_expr_recon_loss: 20878032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96097656.0000; val_global_loss: 117533440.0000; val_optim_loss: 117533440.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9040; val_auprc_score: 0.8951; val_best_acc_score: 0.7351; val_best_f1_score: 0.7852; train_kl_reg_loss: 161176.5417; train_edge_recon_loss: 404415.7569; train_gene_expr_recon_loss: 20816966.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96561467.5556; train_global_loss: 117944026.6667; train_optim_loss: 117944026.6667; val_kl_reg_loss: 151479.9375; val_edge_recon_loss: 404819.1250; val_gene_expr_recon_loss: 20868986.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96236872.0000; val_global_loss: 117662160.0000; val_optim_loss: 117662160.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9095; val_auprc_score: 0.9003; val_best_acc_score: 0.7680; val_best_f1_score: 0.8054; train_kl_reg_loss: 159849.2378; train_edge_recon_loss: 404179.5347; train_gene_expr_recon_loss: 20747914.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96423691.5556; train_global_loss: 117735634.6667; train_optim_loss: 117735634.6667; val_kl_reg_loss: 149743.3125; val_edge_recon_loss: 404504.5625; val_gene_expr_recon_loss: 20853096.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96165384.0000; val_global_loss: 117572728.0000; val_optim_loss: 117572728.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9075; val_auprc_score: 0.8880; val_best_acc_score: 0.7916; val_best_f1_score: 0.8204; train_kl_reg_loss: 159798.8368; train_edge_recon_loss: 403778.1250; train_gene_expr_recon_loss: 20851501.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97069877.3333; train_global_loss: 118484954.6667; train_optim_loss: 118484954.6667; val_kl_reg_loss: 146101.9531; val_edge_recon_loss: 404015.8750; val_gene_expr_recon_loss: 20820790.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96037256.0000; val_global_loss: 117408160.0000; val_optim_loss: 117408160.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9161; val_auprc_score: 0.9012; val_best_acc_score: 0.8123; val_best_f1_score: 0.8343; train_kl_reg_loss: 155577.4167; train_edge_recon_loss: 403427.8611; train_gene_expr_recon_loss: 20772512.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96665716.4444; train_global_loss: 117997233.7778; train_optim_loss: 117997233.7778; val_kl_reg_loss: 145773.5000; val_edge_recon_loss: 403589.5312; val_gene_expr_recon_loss: 20776506.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95866696.0000; val_global_loss: 117192560.0000; val_optim_loss: 117192560.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9177; val_auprc_score: 0.9060; val_best_acc_score: 0.8312; val_best_f1_score: 0.8474; train_kl_reg_loss: 153757.2517; train_edge_recon_loss: 403023.2882; train_gene_expr_recon_loss: 20596187.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95699611.5556; train_global_loss: 116852581.3333; train_optim_loss: 116852581.3333; val_kl_reg_loss: 145639.6562; val_edge_recon_loss: 403212.2188; val_gene_expr_recon_loss: 20753586.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95720160.0000; val_global_loss: 117022600.0000; val_optim_loss: 117022600.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9232; val_auprc_score: 0.9082; val_best_acc_score: 0.8483; val_best_f1_score: 0.8589; train_kl_reg_loss: 152532.5226; train_edge_recon_loss: 402553.9931; train_gene_expr_recon_loss: 20758681.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96280610.6667; train_global_loss: 117594379.5556; train_optim_loss: 117594379.5556; val_kl_reg_loss: 142805.1875; val_edge_recon_loss: 402560.1250; val_gene_expr_recon_loss: 20731994.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95751888.0000; val_global_loss: 117029248.0000; val_optim_loss: 117029248.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9208; val_auprc_score: 0.9023; val_best_acc_score: 0.8492; val_best_f1_score: 0.8587; train_kl_reg_loss: 150419.7552; train_edge_recon_loss: 401987.3160; train_gene_expr_recon_loss: 20866907.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96181947.5556; train_global_loss: 117601262.2222; train_optim_loss: 117601262.2222; val_kl_reg_loss: 142716.7812; val_edge_recon_loss: 402189.0000; val_gene_expr_recon_loss: 20707376.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95672360.0000; val_global_loss: 116924640.0000; val_optim_loss: 116924640.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9215; val_auprc_score: 0.9012; val_best_acc_score: 0.8534; val_best_f1_score: 0.8608; train_kl_reg_loss: 148880.9965; train_edge_recon_loss: 401321.5417; train_gene_expr_recon_loss: 20852431.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96588708.4444; train_global_loss: 117991341.3333; train_optim_loss: 117991341.3333; val_kl_reg_loss: 142311.9062; val_edge_recon_loss: 401738.3438; val_gene_expr_recon_loss: 20690832.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95716536.0000; val_global_loss: 116951416.0000; val_optim_loss: 116951416.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9231; val_auprc_score: 0.9094; val_best_acc_score: 0.8506; val_best_f1_score: 0.8577; train_kl_reg_loss: 146536.3628; train_edge_recon_loss: 401042.8993; train_gene_expr_recon_loss: 20694187.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96053822.2222; train_global_loss: 117295590.2222; train_optim_loss: 117295590.2222; val_kl_reg_loss: 141161.1094; val_edge_recon_loss: 401288.0312; val_gene_expr_recon_loss: 20644954.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95433576.0000; val_global_loss: 116620976.0000; val_optim_loss: 116620976.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9272; val_auprc_score: 0.9109; val_best_acc_score: 0.8591; val_best_f1_score: 0.8643; train_kl_reg_loss: 145454.0920; train_edge_recon_loss: 400845.3542; train_gene_expr_recon_loss: 20858854.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95999512.0000; train_global_loss: 117404665.7778; train_optim_loss: 117404665.7778; val_kl_reg_loss: 131286.9844; val_edge_recon_loss: 400900.7188; val_gene_expr_recon_loss: 20940772.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95594344.0000; val_global_loss: 117067304.0000; val_optim_loss: 117067304.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9226; val_auprc_score: 0.9069; val_best_acc_score: 0.8526; val_best_f1_score: 0.8573; train_kl_reg_loss: 142518.2760; train_edge_recon_loss: 400181.3924; train_gene_expr_recon_loss: 20824116.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95973183.1111; train_global_loss: 117339998.2222; train_optim_loss: 117339998.2222; val_kl_reg_loss: 129886.2969; val_edge_recon_loss: 400544.6875; val_gene_expr_recon_loss: 20884060.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95629248.0000; val_global_loss: 117043744.0000; val_optim_loss: 117043744.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9244; val_auprc_score: 0.9080; val_best_acc_score: 0.8526; val_best_f1_score: 0.8568; train_kl_reg_loss: 140419.2517; train_edge_recon_loss: 399866.3993; train_gene_expr_recon_loss: 20836775.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96056280.0000; train_global_loss: 117433340.4444; train_optim_loss: 117433340.4444; val_kl_reg_loss: 125889.4844; val_edge_recon_loss: 400390.0938; val_gene_expr_recon_loss: 20846632.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95473640.0000; val_global_loss: 116846552.0000; val_optim_loss: 116846552.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9242; val_auprc_score: 0.9066; val_best_acc_score: 0.8526; val_best_f1_score: 0.8548; train_kl_reg_loss: 138335.2604; train_edge_recon_loss: 399585.8542; train_gene_expr_recon_loss: 20782468.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95835797.3333; train_global_loss: 117156185.7778; train_optim_loss: 117156185.7778; val_kl_reg_loss: 121323.8672; val_edge_recon_loss: 399699.8125; val_gene_expr_recon_loss: 20865824.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95514144.0000; val_global_loss: 116900992.0000; val_optim_loss: 116900992.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9271; val_auprc_score: 0.9098; val_best_acc_score: 0.8534; val_best_f1_score: 0.8555; train_kl_reg_loss: 134969.0799; train_edge_recon_loss: 399092.6840; train_gene_expr_recon_loss: 20834163.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96110744.0000; train_global_loss: 117478968.0000; train_optim_loss: 117478968.0000; val_kl_reg_loss: 121716.3125; val_edge_recon_loss: 399521.6562; val_gene_expr_recon_loss: 20855814.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95500720.0000; val_global_loss: 116877776.0000; val_optim_loss: 116877776.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9347; val_auprc_score: 0.9205; val_best_acc_score: 0.8618; val_best_f1_score: 0.8627; train_kl_reg_loss: 137380.3177; train_edge_recon_loss: 399170.1667; train_gene_expr_recon_loss: 20915727.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96536973.3333; train_global_loss: 117989250.6667; train_optim_loss: 117989250.6667; val_kl_reg_loss: 123756.4062; val_edge_recon_loss: 399353.0000; val_gene_expr_recon_loss: 20828716.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95466832.0000; val_global_loss: 116818656.0000; val_optim_loss: 116818656.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9291; val_auprc_score: 0.9124; val_best_acc_score: 0.8569; val_best_f1_score: 0.8583; train_kl_reg_loss: 137501.6337; train_edge_recon_loss: 399114.4479; train_gene_expr_recon_loss: 20777316.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95582194.6667; train_global_loss: 116896126.2222; train_optim_loss: 116896126.2222; val_kl_reg_loss: 123583.5938; val_edge_recon_loss: 399405.5625; val_gene_expr_recon_loss: 20837680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95528104.0000; val_global_loss: 116888776.0000; val_optim_loss: 116888776.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9257; val_auprc_score: 0.9104; val_best_acc_score: 0.8525; val_best_f1_score: 0.8542; train_kl_reg_loss: 137331.2031; train_edge_recon_loss: 399032.2951; train_gene_expr_recon_loss: 20843394.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95666875.5556; train_global_loss: 117046632.8889; train_optim_loss: 117046632.8889; val_kl_reg_loss: 123844.3594; val_edge_recon_loss: 399330.0938; val_gene_expr_recon_loss: 20842518.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95574752.0000; val_global_loss: 116940448.0000; val_optim_loss: 116940448.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 38 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9218
Val AUPRC score: 0.9054
Val best accuracy score: 0.8482
Val best F1 score: 0.8568
Val gene expr MSE score: 0.4311
Val chrom access MSE score: 0.0860
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
