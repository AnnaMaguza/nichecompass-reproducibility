[True]
Run timestamp: 29072023_111419_53.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_53']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8602; val_auprc_score: 0.8852; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6709.7132; train_edge_recon_loss: 356718.4479; train_gene_expr_recon_loss: 84825047.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 182241070.2222; train_global_loss: 267429544.8889; train_optim_loss: 267429544.8889; val_kl_reg_loss: 20592.6855; val_edge_recon_loss: 406610.2188; val_gene_expr_recon_loss: 72730080.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 182725520.0000; val_global_loss: 255882800.0000; val_optim_loss: 255882800.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8814; val_auprc_score: 0.8984; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 19414.1651; train_edge_recon_loss: 378153.7396; train_gene_expr_recon_loss: 72654522.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 177371740.4444; train_global_loss: 250423827.5556; train_optim_loss: 250423827.5556; val_kl_reg_loss: 25583.8516; val_edge_recon_loss: 406618.8750; val_gene_expr_recon_loss: 73589832.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 170018768.0000; val_global_loss: 244040800.0000; val_optim_loss: 244040800.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8885; val_auprc_score: 0.9021; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 45850.1204; train_edge_recon_loss: 391212.5521; train_gene_expr_recon_loss: 71852923.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 168859320.8889; train_global_loss: 241149306.6667; train_optim_loss: 241149306.6667; val_kl_reg_loss: 65830.5625; val_edge_recon_loss: 406623.7188; val_gene_expr_recon_loss: 68001944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 168434880.0000; val_global_loss: 236909280.0000; val_optim_loss: 236909280.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8835; val_auprc_score: 0.8982; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 82300.2778; train_edge_recon_loss: 401651.6875; train_gene_expr_recon_loss: 65717492.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 168625173.3333; train_global_loss: 234826618.6667; train_optim_loss: 234826618.6667; val_kl_reg_loss: 94957.3281; val_edge_recon_loss: 406622.3125; val_gene_expr_recon_loss: 63860320.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 167266720.0000; val_global_loss: 231628624.0000; val_optim_loss: 231628624.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8789; val_auprc_score: 0.8905; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 115038.4479; train_edge_recon_loss: 404624.1875; train_gene_expr_recon_loss: 63178957.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 166331623.1111; train_global_loss: 230030243.5556; train_optim_loss: 230030243.5556; val_kl_reg_loss: 133903.2500; val_edge_recon_loss: 406621.4375; val_gene_expr_recon_loss: 61351360.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 164261472.0000; val_global_loss: 226153360.0000; val_optim_loss: 226153360.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8795; val_auprc_score: 0.8915; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 148314.1476; train_edge_recon_loss: 405565.1042; train_gene_expr_recon_loss: 59158301.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 164055342.2222; train_global_loss: 223767523.5556; train_optim_loss: 223767523.5556; val_kl_reg_loss: 150397.7031; val_edge_recon_loss: 406617.6562; val_gene_expr_recon_loss: 57141448.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 163812656.0000; val_global_loss: 221511120.0000; val_optim_loss: 221511120.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8789; val_auprc_score: 0.8908; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 163757.1597; train_edge_recon_loss: 405864.8889; train_gene_expr_recon_loss: 55670621.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 163409891.5556; train_global_loss: 219650133.3333; train_optim_loss: 219650133.3333; val_kl_reg_loss: 173881.1875; val_edge_recon_loss: 406613.9062; val_gene_expr_recon_loss: 53705604.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 162867296.0000; val_global_loss: 217153392.0000; val_optim_loss: 217153392.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8684; val_auprc_score: 0.8773; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 182253.7274; train_edge_recon_loss: 405994.2708; train_gene_expr_recon_loss: 52309060.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 162934049.7778; train_global_loss: 215831358.2222; train_optim_loss: 215831358.2222; val_kl_reg_loss: 171378.4062; val_edge_recon_loss: 406606.8125; val_gene_expr_recon_loss: 50592304.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 160914480.0000; val_global_loss: 212084768.0000; val_optim_loss: 212084768.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8616; val_auprc_score: 0.8718; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 182518.1181; train_edge_recon_loss: 406052.6736; train_gene_expr_recon_loss: 49102007.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 160792670.2222; train_global_loss: 210483248.0000; train_optim_loss: 210483248.0000; val_kl_reg_loss: 178456.8594; val_edge_recon_loss: 406603.1250; val_gene_expr_recon_loss: 47592504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 159747840.0000; val_global_loss: 207925408.0000; val_optim_loss: 207925408.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8447; val_auprc_score: 0.8572; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 184698.3403; train_edge_recon_loss: 406063.6181; train_gene_expr_recon_loss: 46599006.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 160156780.4444; train_global_loss: 207346547.5556; train_optim_loss: 207346547.5556; val_kl_reg_loss: 174161.2969; val_edge_recon_loss: 406597.6250; val_gene_expr_recon_loss: 45252784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 158312736.0000; val_global_loss: 204146272.0000; val_optim_loss: 204146272.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8362; val_auprc_score: 0.8487; val_best_acc_score: 0.5015; val_best_f1_score: 0.6673; train_kl_reg_loss: 181368.5521; train_edge_recon_loss: 406070.9271; train_gene_expr_recon_loss: 44414324.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 157755729.7778; train_global_loss: 202757493.3333; train_optim_loss: 202757493.3333; val_kl_reg_loss: 174339.5469; val_edge_recon_loss: 406588.1875; val_gene_expr_recon_loss: 43436188.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156989504.0000; val_global_loss: 201006624.0000; val_optim_loss: 201006624.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8250; val_auprc_score: 0.8358; val_best_acc_score: 0.5020; val_best_f1_score: 0.6676; train_kl_reg_loss: 180292.4757; train_edge_recon_loss: 406068.6910; train_gene_expr_recon_loss: 42777697.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 157102704.0000; train_global_loss: 200466762.6667; train_optim_loss: 200466762.6667; val_kl_reg_loss: 169022.8438; val_edge_recon_loss: 406577.3438; val_gene_expr_recon_loss: 42159152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156215504.0000; val_global_loss: 198950256.0000; val_optim_loss: 198950256.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8163; val_auprc_score: 0.8312; val_best_acc_score: 0.5044; val_best_f1_score: 0.6686; train_kl_reg_loss: 177282.3767; train_edge_recon_loss: 406059.4549; train_gene_expr_recon_loss: 41530201.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155614618.6667; train_global_loss: 197728160.0000; train_optim_loss: 197728160.0000; val_kl_reg_loss: 170536.5312; val_edge_recon_loss: 406560.4375; val_gene_expr_recon_loss: 41120380.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155431376.0000; val_global_loss: 197128848.0000; val_optim_loss: 197128848.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8092; val_auprc_score: 0.8219; val_best_acc_score: 0.5073; val_best_f1_score: 0.6699; train_kl_reg_loss: 176367.7083; train_edge_recon_loss: 406065.3993; train_gene_expr_recon_loss: 40977364.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155364558.2222; train_global_loss: 196924357.3333; train_optim_loss: 196924357.3333; val_kl_reg_loss: 160368.6875; val_edge_recon_loss: 406544.3125; val_gene_expr_recon_loss: 40459264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154936704.0000; val_global_loss: 195962880.0000; val_optim_loss: 195962880.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7985; val_auprc_score: 0.8105; val_best_acc_score: 0.5089; val_best_f1_score: 0.6706; train_kl_reg_loss: 170310.8333; train_edge_recon_loss: 406046.2431; train_gene_expr_recon_loss: 40309254.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155405164.4444; train_global_loss: 196290778.6667; train_optim_loss: 196290778.6667; val_kl_reg_loss: 153438.4375; val_edge_recon_loss: 406523.1562; val_gene_expr_recon_loss: 40084496.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154590304.0000; val_global_loss: 195234752.0000; val_optim_loss: 195234752.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8055; val_auprc_score: 0.8155; val_best_acc_score: 0.5131; val_best_f1_score: 0.6725; train_kl_reg_loss: 166194.1354; train_edge_recon_loss: 405993.3576; train_gene_expr_recon_loss: 39831951.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155009594.6667; train_global_loss: 195413731.5556; train_optim_loss: 195413731.5556; val_kl_reg_loss: 159337.5000; val_edge_recon_loss: 406504.4375; val_gene_expr_recon_loss: 39426696.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154218784.0000; val_global_loss: 194211328.0000; val_optim_loss: 194211328.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8007; val_auprc_score: 0.8090; val_best_acc_score: 0.5179; val_best_f1_score: 0.6745; train_kl_reg_loss: 165403.7326; train_edge_recon_loss: 405992.6667; train_gene_expr_recon_loss: 39535829.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154779080.8889; train_global_loss: 194886305.7778; train_optim_loss: 194886305.7778; val_kl_reg_loss: 149136.1719; val_edge_recon_loss: 406472.4062; val_gene_expr_recon_loss: 39313192.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153792672.0000; val_global_loss: 193661472.0000; val_optim_loss: 193661472.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7993; val_auprc_score: 0.8058; val_best_acc_score: 0.5185; val_best_f1_score: 0.6745; train_kl_reg_loss: 158837.0608; train_edge_recon_loss: 405921.6840; train_gene_expr_recon_loss: 39144282.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153667141.3333; train_global_loss: 193376183.1111; train_optim_loss: 193376183.1111; val_kl_reg_loss: 150090.9062; val_edge_recon_loss: 406455.0000; val_gene_expr_recon_loss: 38966404.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153519728.0000; val_global_loss: 193042672.0000; val_optim_loss: 193042672.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8092; val_auprc_score: 0.8155; val_best_acc_score: 0.5210; val_best_f1_score: 0.6757; train_kl_reg_loss: 157114.4410; train_edge_recon_loss: 405885.2639; train_gene_expr_recon_loss: 38993565.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153714400.0000; train_global_loss: 193270967.1111; train_optim_loss: 193270967.1111; val_kl_reg_loss: 150859.5625; val_edge_recon_loss: 406434.7812; val_gene_expr_recon_loss: 38707916.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153320784.0000; val_global_loss: 192586000.0000; val_optim_loss: 192586000.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8103; val_auprc_score: 0.8123; val_best_acc_score: 0.5282; val_best_f1_score: 0.6787; train_kl_reg_loss: 154436.3715; train_edge_recon_loss: 405846.4062; train_gene_expr_recon_loss: 38763369.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154085832.8889; train_global_loss: 193409486.2222; train_optim_loss: 193409486.2222; val_kl_reg_loss: 140355.5938; val_edge_recon_loss: 406384.8438; val_gene_expr_recon_loss: 38638748.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152945296.0000; val_global_loss: 192130784.0000; val_optim_loss: 192130784.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8070; val_auprc_score: 0.8129; val_best_acc_score: 0.5299; val_best_f1_score: 0.6795; train_kl_reg_loss: 149779.1076; train_edge_recon_loss: 405789.7014; train_gene_expr_recon_loss: 38741114.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153575836.4444; train_global_loss: 192872520.8889; train_optim_loss: 192872520.8889; val_kl_reg_loss: 138437.3594; val_edge_recon_loss: 406368.4375; val_gene_expr_recon_loss: 38505936.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152772080.0000; val_global_loss: 191822816.0000; val_optim_loss: 191822816.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8168; val_auprc_score: 0.8184; val_best_acc_score: 0.5342; val_best_f1_score: 0.6812; train_kl_reg_loss: 147314.5955; train_edge_recon_loss: 405754.6632; train_gene_expr_recon_loss: 38642085.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153510984.8889; train_global_loss: 192706138.6667; train_optim_loss: 192706138.6667; val_kl_reg_loss: 139289.4219; val_edge_recon_loss: 406324.5625; val_gene_expr_recon_loss: 38392956.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152877248.0000; val_global_loss: 191815808.0000; val_optim_loss: 191815808.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8194; val_auprc_score: 0.8192; val_best_acc_score: 0.5430; val_best_f1_score: 0.6848; train_kl_reg_loss: 145188.0000; train_edge_recon_loss: 405719.8854; train_gene_expr_recon_loss: 38290668.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152559534.2222; train_global_loss: 191401111.1111; train_optim_loss: 191401111.1111; val_kl_reg_loss: 131650.9688; val_edge_recon_loss: 406254.9062; val_gene_expr_recon_loss: 38342984.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152424896.0000; val_global_loss: 191305792.0000; val_optim_loss: 191305792.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8278; val_auprc_score: 0.8280; val_best_acc_score: 0.5434; val_best_f1_score: 0.6844; train_kl_reg_loss: 141760.1267; train_edge_recon_loss: 405630.8160; train_gene_expr_recon_loss: 38388347.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152111274.6667; train_global_loss: 191047011.5556; train_optim_loss: 191047011.5556; val_kl_reg_loss: 133970.7188; val_edge_recon_loss: 406218.7188; val_gene_expr_recon_loss: 38262688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152669280.0000; val_global_loss: 191472160.0000; val_optim_loss: 191472160.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8327; val_auprc_score: 0.8314; val_best_acc_score: 0.5594; val_best_f1_score: 0.6917; train_kl_reg_loss: 140133.7934; train_edge_recon_loss: 405515.0521; train_gene_expr_recon_loss: 38400052.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152659505.7778; train_global_loss: 191605205.3333; train_optim_loss: 191605205.3333; val_kl_reg_loss: 128190.8047; val_edge_recon_loss: 406099.5625; val_gene_expr_recon_loss: 38161008.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152093952.0000; val_global_loss: 190789248.0000; val_optim_loss: 190789248.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8396; val_auprc_score: 0.8340; val_best_acc_score: 0.5559; val_best_f1_score: 0.6897; train_kl_reg_loss: 138488.0833; train_edge_recon_loss: 405669.7222; train_gene_expr_recon_loss: 38409124.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153063934.2222; train_global_loss: 192017216.0000; train_optim_loss: 192017216.0000; val_kl_reg_loss: 120283.3594; val_edge_recon_loss: 406085.9062; val_gene_expr_recon_loss: 38306704.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152685120.0000; val_global_loss: 191518192.0000; val_optim_loss: 191518192.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8429; val_auprc_score: 0.8369; val_best_acc_score: 0.5779; val_best_f1_score: 0.6996; train_kl_reg_loss: 138466.7222; train_edge_recon_loss: 405564.5556; train_gene_expr_recon_loss: 38190316.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151670471.1111; train_global_loss: 190404817.7778; train_optim_loss: 190404817.7778; val_kl_reg_loss: 114645.4844; val_edge_recon_loss: 405944.4062; val_gene_expr_recon_loss: 38307120.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152988320.0000; val_global_loss: 191816032.0000; val_optim_loss: 191816032.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8522; val_auprc_score: 0.8474; val_best_acc_score: 0.5833; val_best_f1_score: 0.7021; train_kl_reg_loss: 134093.9227; train_edge_recon_loss: 405406.8611; train_gene_expr_recon_loss: 38307967.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153004496.0000; train_global_loss: 191851964.4444; train_optim_loss: 191851964.4444; val_kl_reg_loss: 118347.0469; val_edge_recon_loss: 405935.1562; val_gene_expr_recon_loss: 38185056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152462944.0000; val_global_loss: 191172288.0000; val_optim_loss: 191172288.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8580; val_auprc_score: 0.8517; val_best_acc_score: 0.6218; val_best_f1_score: 0.7208; train_kl_reg_loss: 132414.0434; train_edge_recon_loss: 405279.7014; train_gene_expr_recon_loss: 38286307.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153129872.0000; train_global_loss: 191953872.0000; train_optim_loss: 191953872.0000; val_kl_reg_loss: 107404.7344; val_edge_recon_loss: 405648.8750; val_gene_expr_recon_loss: 38253540.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152865904.0000; val_global_loss: 191632496.0000; val_optim_loss: 191632496.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8533; val_auprc_score: 0.8470; val_best_acc_score: 0.6041; val_best_f1_score: 0.7122; train_kl_reg_loss: 127098.9453; train_edge_recon_loss: 405115.4271; train_gene_expr_recon_loss: 38503135.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152896481.7778; train_global_loss: 191931831.1111; train_optim_loss: 191931831.1111; val_kl_reg_loss: 119387.6094; val_edge_recon_loss: 405760.7188; val_gene_expr_recon_loss: 38177160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152592064.0000; val_global_loss: 191294368.0000; val_optim_loss: 191294368.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8573; val_auprc_score: 0.8512; val_best_acc_score: 0.6153; val_best_f1_score: 0.7176; train_kl_reg_loss: 131281.1155; train_edge_recon_loss: 405159.1285; train_gene_expr_recon_loss: 38175556.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152482572.4444; train_global_loss: 191194572.4444; train_optim_loss: 191194572.4444; val_kl_reg_loss: 113417.0000; val_edge_recon_loss: 405712.6875; val_gene_expr_recon_loss: 38149192.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152557872.0000; val_global_loss: 191226192.0000; val_optim_loss: 191226192.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8596; val_auprc_score: 0.8509; val_best_acc_score: 0.6153; val_best_f1_score: 0.7177; train_kl_reg_loss: 128326.0538; train_edge_recon_loss: 405132.3125; train_gene_expr_recon_loss: 38221796.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152058531.5556; train_global_loss: 190813786.6667; train_optim_loss: 190813786.6667; val_kl_reg_loss: 116304.3438; val_edge_recon_loss: 405700.4375; val_gene_expr_recon_loss: 38131072.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152625888.0000; val_global_loss: 191278960.0000; val_optim_loss: 191278960.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8557; val_auprc_score: 0.8449; val_best_acc_score: 0.6184; val_best_f1_score: 0.7191; train_kl_reg_loss: 129917.9462; train_edge_recon_loss: 405132.7257; train_gene_expr_recon_loss: 38225644.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152569937.7778; train_global_loss: 191330636.4444; train_optim_loss: 191330636.4444; val_kl_reg_loss: 114652.9688; val_edge_recon_loss: 405589.0000; val_gene_expr_recon_loss: 38106844.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152319648.0000; val_global_loss: 190946736.0000; val_optim_loss: 190946736.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 37 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8376
val AUPRC score: 0.8333
val best accuracy score: 0.5547
val best F1 score: 0.6896
val target rna MSE score: 1.4050
val source rna MSE score: 0.6282
val target atac MSE score: 0.1197
val source atac MSE score: 0.0176
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
