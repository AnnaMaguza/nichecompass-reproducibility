[True]
Run timestamp: 07082023_185408_53.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_53']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8942; val_auprc_score: 0.9112; val_best_acc_score: 0.5009; val_best_f1_score: 0.6671; train_kl_reg_loss: 7418.5906; train_edge_recon_loss: 35413.2604; train_gene_expr_recon_loss: 1253812.9722; train_masked_gp_l1_reg_loss: 15672.1809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119573.5443; train_chrom_access_recon_loss: 869143.0590; train_global_loss: 2301033.5972; train_optim_loss: 2301033.5972; val_kl_reg_loss: 3203.9932; val_edge_recon_loss: 40655.8633; val_gene_expr_recon_loss: 1076614.8750; val_masked_gp_l1_reg_loss: 10337.5645; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117252.1406; val_chrom_access_recon_loss: 519255.3750; val_global_loss: 1767319.8750; val_optim_loss: 1767319.8750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9062; val_auprc_score: 0.9214; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 3358.4501; train_edge_recon_loss: 35727.9362; train_gene_expr_recon_loss: 1026809.5347; train_masked_gp_l1_reg_loss: 8666.2542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115837.0712; train_chrom_access_recon_loss: 498497.2500; train_global_loss: 1688896.4722; train_optim_loss: 1688896.4722; val_kl_reg_loss: 4330.8252; val_edge_recon_loss: 40659.2031; val_gene_expr_recon_loss: 942108.6250; val_masked_gp_l1_reg_loss: 7842.9272; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114141.7891; val_chrom_access_recon_loss: 484827.7812; val_global_loss: 1593911.1250; val_optim_loss: 1593911.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9139; val_auprc_score: 0.9243; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 8561.2716; train_edge_recon_loss: 36974.3924; train_gene_expr_recon_loss: 902048.0069; train_masked_gp_l1_reg_loss: 8545.7326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112829.4748; train_chrom_access_recon_loss: 484091.7986; train_global_loss: 1553050.6944; train_optim_loss: 1553050.6944; val_kl_reg_loss: 13538.0078; val_edge_recon_loss: 40661.1211; val_gene_expr_recon_loss: 831069.7500; val_masked_gp_l1_reg_loss: 9130.5752; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111168.8203; val_chrom_access_recon_loss: 474991.8125; val_global_loss: 1480560.0000; val_optim_loss: 1480560.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9017; val_auprc_score: 0.9085; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 15112.6986; train_edge_recon_loss: 38225.3889; train_gene_expr_recon_loss: 814833.6528; train_masked_gp_l1_reg_loss: 9230.1886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109748.2682; train_chrom_access_recon_loss: 468322.1458; train_global_loss: 1455472.3333; train_optim_loss: 1455472.3333; val_kl_reg_loss: 15309.2891; val_edge_recon_loss: 40659.2852; val_gene_expr_recon_loss: 770255.0000; val_masked_gp_l1_reg_loss: 9435.4404; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107901.2500; val_chrom_access_recon_loss: 458228.4688; val_global_loss: 1401788.7500; val_optim_loss: 1401788.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8983; val_auprc_score: 0.9057; val_best_acc_score: 0.5022; val_best_f1_score: 0.6676; train_kl_reg_loss: 18520.0334; train_edge_recon_loss: 38549.5417; train_gene_expr_recon_loss: 759201.1458; train_masked_gp_l1_reg_loss: 9593.9157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106296.1892; train_chrom_access_recon_loss: 455439.0417; train_global_loss: 1387599.8889; train_optim_loss: 1387599.8889; val_kl_reg_loss: 19639.4062; val_edge_recon_loss: 40657.0742; val_gene_expr_recon_loss: 726987.5625; val_masked_gp_l1_reg_loss: 9692.9209; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104193.7812; val_chrom_access_recon_loss: 450136.7188; val_global_loss: 1351307.5000; val_optim_loss: 1351307.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8893; val_auprc_score: 0.8892; val_best_acc_score: 0.5089; val_best_f1_score: 0.6706; train_kl_reg_loss: 20274.6769; train_edge_recon_loss: 38749.2283; train_gene_expr_recon_loss: 727968.1597; train_masked_gp_l1_reg_loss: 9697.7974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102378.5009; train_chrom_access_recon_loss: 451163.0972; train_global_loss: 1350231.4722; train_optim_loss: 1350231.4722; val_kl_reg_loss: 18786.8516; val_edge_recon_loss: 40649.4961; val_gene_expr_recon_loss: 704222.7500; val_masked_gp_l1_reg_loss: 9690.0498; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100044.9297; val_chrom_access_recon_loss: 445791.2188; val_global_loss: 1319185.3750; val_optim_loss: 1319185.3750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8801; val_auprc_score: 0.8738; val_best_acc_score: 0.5238; val_best_f1_score: 0.6771; train_kl_reg_loss: 20252.8003; train_edge_recon_loss: 38736.8585; train_gene_expr_recon_loss: 706905.5694; train_masked_gp_l1_reg_loss: 9691.8261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98106.7101; train_chrom_access_recon_loss: 446190.1528; train_global_loss: 1319883.9167; train_optim_loss: 1319883.9167; val_kl_reg_loss: 19869.7793; val_edge_recon_loss: 40638.6172; val_gene_expr_recon_loss: 686439.5000; val_masked_gp_l1_reg_loss: 9664.4473; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95650.4062; val_chrom_access_recon_loss: 442900.0000; val_global_loss: 1295162.7500; val_optim_loss: 1295162.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8723; val_auprc_score: 0.8651; val_best_acc_score: 0.5480; val_best_f1_score: 0.6876; train_kl_reg_loss: 21068.3355; train_edge_recon_loss: 38853.5707; train_gene_expr_recon_loss: 688958.2986; train_masked_gp_l1_reg_loss: 9623.2875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93656.8021; train_chrom_access_recon_loss: 443231.0694; train_global_loss: 1295391.3611; train_optim_loss: 1295391.3611; val_kl_reg_loss: 20647.6641; val_edge_recon_loss: 40625.2305; val_gene_expr_recon_loss: 674098.5625; val_masked_gp_l1_reg_loss: 9566.6543; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91154.7656; val_chrom_access_recon_loss: 440792.1250; val_global_loss: 1276885.0000; val_optim_loss: 1276885.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8627; val_auprc_score: 0.8636; val_best_acc_score: 0.5710; val_best_f1_score: 0.6973; train_kl_reg_loss: 21106.7932; train_edge_recon_loss: 38898.5573; train_gene_expr_recon_loss: 678862.8958; train_masked_gp_l1_reg_loss: 9514.6823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89158.2700; train_chrom_access_recon_loss: 440524.4201; train_global_loss: 1278065.6111; train_optim_loss: 1278065.6111; val_kl_reg_loss: 20744.4414; val_edge_recon_loss: 40611.7930; val_gene_expr_recon_loss: 665672.0000; val_masked_gp_l1_reg_loss: 9449.9814; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86670.6875; val_chrom_access_recon_loss: 439100.2500; val_global_loss: 1262249.2500; val_optim_loss: 1262249.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8615; val_auprc_score: 0.8620; val_best_acc_score: 0.6056; val_best_f1_score: 0.7142; train_kl_reg_loss: 21514.4284; train_edge_recon_loss: 38937.9770; train_gene_expr_recon_loss: 676410.4722; train_masked_gp_l1_reg_loss: 9410.9730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84707.0868; train_chrom_access_recon_loss: 441627.9062; train_global_loss: 1272608.8472; train_optim_loss: 1272608.8472; val_kl_reg_loss: 20684.6992; val_edge_recon_loss: 40592.9883; val_gene_expr_recon_loss: 659684.3750; val_masked_gp_l1_reg_loss: 9359.4932; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82271.8359; val_chrom_access_recon_loss: 437788.7812; val_global_loss: 1250382.1250; val_optim_loss: 1250382.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8524; val_auprc_score: 0.8501; val_best_acc_score: 0.6233; val_best_f1_score: 0.7225; train_kl_reg_loss: 21454.6495; train_edge_recon_loss: 38946.0438; train_gene_expr_recon_loss: 664939.6389; train_masked_gp_l1_reg_loss: 9331.7032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80362.2795; train_chrom_access_recon_loss: 437265.6632; train_global_loss: 1252299.9583; train_optim_loss: 1252299.9583; val_kl_reg_loss: 21179.0664; val_edge_recon_loss: 40583.1367; val_gene_expr_recon_loss: 654718.6250; val_masked_gp_l1_reg_loss: 9295.6943; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77995.0703; val_chrom_access_recon_loss: 436794.0312; val_global_loss: 1240565.6250; val_optim_loss: 1240565.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8609; val_auprc_score: 0.8549; val_best_acc_score: 0.6653; val_best_f1_score: 0.7434; train_kl_reg_loss: 21370.0423; train_edge_recon_loss: 38948.5716; train_gene_expr_recon_loss: 662840.2500; train_masked_gp_l1_reg_loss: 9261.3868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76142.5295; train_chrom_access_recon_loss: 434694.9965; train_global_loss: 1243257.7639; train_optim_loss: 1243257.7639; val_kl_reg_loss: 20030.0742; val_edge_recon_loss: 40559.1797; val_gene_expr_recon_loss: 652036.8750; val_masked_gp_l1_reg_loss: 9215.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73854.0625; val_chrom_access_recon_loss: 435711.4375; val_global_loss: 1231407.5000; val_optim_loss: 1231407.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8792; val_auprc_score: 0.8689; val_best_acc_score: 0.7070; val_best_f1_score: 0.7669; train_kl_reg_loss: 21047.1871; train_edge_recon_loss: 38921.4679; train_gene_expr_recon_loss: 660078.4514; train_masked_gp_l1_reg_loss: 9198.1336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72082.2708; train_chrom_access_recon_loss: 436344.6215; train_global_loss: 1237672.1389; train_optim_loss: 1237672.1389; val_kl_reg_loss: 20308.3242; val_edge_recon_loss: 40529.6133; val_gene_expr_recon_loss: 648457.8750; val_masked_gp_l1_reg_loss: 9163.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69895.3281; val_chrom_access_recon_loss: 434937.8750; val_global_loss: 1223292.7500; val_optim_loss: 1223292.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8990; val_auprc_score: 0.8908; val_best_acc_score: 0.7630; val_best_f1_score: 0.8008; train_kl_reg_loss: 20726.4824; train_edge_recon_loss: 38895.3385; train_gene_expr_recon_loss: 656091.5069; train_masked_gp_l1_reg_loss: 9148.5366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68199.5078; train_chrom_access_recon_loss: 435294.8403; train_global_loss: 1228356.1806; train_optim_loss: 1228356.1806; val_kl_reg_loss: 19682.1289; val_edge_recon_loss: 40492.8516; val_gene_expr_recon_loss: 646259.2500; val_masked_gp_l1_reg_loss: 9121.8604; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66106.6797; val_chrom_access_recon_loss: 434005.9688; val_global_loss: 1215668.7500; val_optim_loss: 1215668.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9136; val_auprc_score: 0.8997; val_best_acc_score: 0.8238; val_best_f1_score: 0.8421; train_kl_reg_loss: 20466.0974; train_edge_recon_loss: 38854.3372; train_gene_expr_recon_loss: 658291.0625; train_masked_gp_l1_reg_loss: 9107.9525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64495.3824; train_chrom_access_recon_loss: 436180.1493; train_global_loss: 1227394.9861; train_optim_loss: 1227394.9861; val_kl_reg_loss: 19011.1836; val_edge_recon_loss: 40436.1016; val_gene_expr_recon_loss: 644774.6250; val_masked_gp_l1_reg_loss: 9086.2920; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62512.2344; val_chrom_access_recon_loss: 433170.4062; val_global_loss: 1208990.8750; val_optim_loss: 1208990.8750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9172; val_auprc_score: 0.9051; val_best_acc_score: 0.8438; val_best_f1_score: 0.8555; train_kl_reg_loss: 20160.7593; train_edge_recon_loss: 38800.4206; train_gene_expr_recon_loss: 655409.9306; train_masked_gp_l1_reg_loss: 9075.9081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60998.1189; train_chrom_access_recon_loss: 436579.0729; train_global_loss: 1221024.2083; train_optim_loss: 1221024.2083; val_kl_reg_loss: 19337.9609; val_edge_recon_loss: 40370.5586; val_gene_expr_recon_loss: 641958.0000; val_masked_gp_l1_reg_loss: 9056.7949; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59132.2656; val_chrom_access_recon_loss: 433120.8438; val_global_loss: 1202976.3750; val_optim_loss: 1202976.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9246; val_auprc_score: 0.9146; val_best_acc_score: 0.8539; val_best_f1_score: 0.8598; train_kl_reg_loss: 19881.8969; train_edge_recon_loss: 38727.4891; train_gene_expr_recon_loss: 652952.2292; train_masked_gp_l1_reg_loss: 9051.1980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57708.0082; train_chrom_access_recon_loss: 434404.6528; train_global_loss: 1212725.4583; train_optim_loss: 1212725.4583; val_kl_reg_loss: 18155.4121; val_edge_recon_loss: 40277.0742; val_gene_expr_recon_loss: 641590.0625; val_masked_gp_l1_reg_loss: 9039.0889; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55958.6250; val_chrom_access_recon_loss: 432433.0000; val_global_loss: 1197453.2500; val_optim_loss: 1197453.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9250; val_auprc_score: 0.9117; val_best_acc_score: 0.8550; val_best_f1_score: 0.8590; train_kl_reg_loss: 19316.2936; train_edge_recon_loss: 38649.1367; train_gene_expr_recon_loss: 649676.0000; train_masked_gp_l1_reg_loss: 9037.0227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54630.7335; train_chrom_access_recon_loss: 434167.0556; train_global_loss: 1205476.2361; train_optim_loss: 1205476.2361; val_kl_reg_loss: 18922.9492; val_edge_recon_loss: 40232.4297; val_gene_expr_recon_loss: 638649.8750; val_masked_gp_l1_reg_loss: 9028.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52998.0000; val_chrom_access_recon_loss: 431544.5312; val_global_loss: 1191376.0000; val_optim_loss: 1191376.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9329; val_auprc_score: 0.9216; val_best_acc_score: 0.8581; val_best_f1_score: 0.8580; train_kl_reg_loss: 19234.7817; train_edge_recon_loss: 38594.2869; train_gene_expr_recon_loss: 650889.8958; train_masked_gp_l1_reg_loss: 9019.3427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51757.5043; train_chrom_access_recon_loss: 433858.3785; train_global_loss: 1203354.1944; train_optim_loss: 1203354.1944; val_kl_reg_loss: 17976.0664; val_edge_recon_loss: 40158.2969; val_gene_expr_recon_loss: 638038.6250; val_masked_gp_l1_reg_loss: 9009.0732; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50232.2109; val_chrom_access_recon_loss: 430951.0625; val_global_loss: 1186365.2500; val_optim_loss: 1186365.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9315; val_auprc_score: 0.9225; val_best_acc_score: 0.8522; val_best_f1_score: 0.8505; train_kl_reg_loss: 18835.4379; train_edge_recon_loss: 38531.0690; train_gene_expr_recon_loss: 645994.6875; train_masked_gp_l1_reg_loss: 9006.9773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49075.3737; train_chrom_access_recon_loss: 433014.7951; train_global_loss: 1194458.3472; train_optim_loss: 1194458.3472; val_kl_reg_loss: 18045.4199; val_edge_recon_loss: 40098.5352; val_gene_expr_recon_loss: 636302.3750; val_masked_gp_l1_reg_loss: 9003.8955; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47653.3203; val_chrom_access_recon_loss: 430389.8438; val_global_loss: 1181493.3750; val_optim_loss: 1181493.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9398; val_auprc_score: 0.9280; val_best_acc_score: 0.8623; val_best_f1_score: 0.8573; train_kl_reg_loss: 18675.3440; train_edge_recon_loss: 38468.0308; train_gene_expr_recon_loss: 645593.3889; train_masked_gp_l1_reg_loss: 8997.2376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46576.0269; train_chrom_access_recon_loss: 432921.3090; train_global_loss: 1191231.3472; train_optim_loss: 1191231.3472; val_kl_reg_loss: 17737.1816; val_edge_recon_loss: 40030.9570; val_gene_expr_recon_loss: 635161.3125; val_masked_gp_l1_reg_loss: 8984.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45250.7227; val_chrom_access_recon_loss: 429627.3438; val_global_loss: 1176792.2500; val_optim_loss: 1176792.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9403; val_auprc_score: 0.9272; val_best_acc_score: 0.8585; val_best_f1_score: 0.8511; train_kl_reg_loss: 18394.1523; train_edge_recon_loss: 38395.6597; train_gene_expr_recon_loss: 643857.4861; train_masked_gp_l1_reg_loss: 8980.9288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44245.3698; train_chrom_access_recon_loss: 430736.7292; train_global_loss: 1184610.3333; train_optim_loss: 1184610.3333; val_kl_reg_loss: 17596.5645; val_edge_recon_loss: 39947.2266; val_gene_expr_recon_loss: 634019.5000; val_masked_gp_l1_reg_loss: 8975.0332; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43013.7305; val_chrom_access_recon_loss: 429018.1562; val_global_loss: 1172570.2500; val_optim_loss: 1172570.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9418; val_auprc_score: 0.9323; val_best_acc_score: 0.8546; val_best_f1_score: 0.8458; train_kl_reg_loss: 18196.9716; train_edge_recon_loss: 38327.6832; train_gene_expr_recon_loss: 642183.2014; train_masked_gp_l1_reg_loss: 8973.7918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42080.2613; train_chrom_access_recon_loss: 428516.4688; train_global_loss: 1178278.4028; train_optim_loss: 1178278.4028; val_kl_reg_loss: 17636.7500; val_edge_recon_loss: 39870.8867; val_gene_expr_recon_loss: 632707.1250; val_masked_gp_l1_reg_loss: 8967.0605; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40927.2578; val_chrom_access_recon_loss: 428403.5625; val_global_loss: 1168512.6250; val_optim_loss: 1168512.6250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9473; val_auprc_score: 0.9373; val_best_acc_score: 0.8488; val_best_f1_score: 0.8477; train_kl_reg_loss: 18159.8522; train_edge_recon_loss: 38262.7079; train_gene_expr_recon_loss: 645560.1181; train_masked_gp_l1_reg_loss: 8964.3506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40055.1476; train_chrom_access_recon_loss: 429375.7708; train_global_loss: 1180377.9722; train_optim_loss: 1180377.9722; val_kl_reg_loss: 16769.6855; val_edge_recon_loss: 39746.9883; val_gene_expr_recon_loss: 632867.3750; val_masked_gp_l1_reg_loss: 8955.5059; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38978.2031; val_chrom_access_recon_loss: 427550.7188; val_global_loss: 1164868.5000; val_optim_loss: 1164868.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9471; val_auprc_score: 0.9396; val_best_acc_score: 0.8487; val_best_f1_score: 0.8433; train_kl_reg_loss: 17861.0859; train_edge_recon_loss: 38186.9427; train_gene_expr_recon_loss: 639961.7778; train_masked_gp_l1_reg_loss: 8959.3621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38173.4136; train_chrom_access_recon_loss: 429294.1979; train_global_loss: 1172436.7778; train_optim_loss: 1172436.7778; val_kl_reg_loss: 17249.4141; val_edge_recon_loss: 39718.2812; val_gene_expr_recon_loss: 630877.7500; val_masked_gp_l1_reg_loss: 8953.6006; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37175.9297; val_chrom_access_recon_loss: 426829.8750; val_global_loss: 1160804.8750; val_optim_loss: 1160804.8750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9487; val_auprc_score: 0.9404; val_best_acc_score: 0.8806; val_best_f1_score: 0.8876; train_kl_reg_loss: 14486.8382; train_edge_recon_loss: 39974.5877; train_gene_expr_recon_loss: 915099.7917; train_masked_gp_l1_reg_loss: 9108.9717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36302.6819; train_chrom_access_recon_loss: 456249.8854; train_global_loss: 1471222.7639; train_optim_loss: 1471222.7639; val_kl_reg_loss: 11422.9180; val_edge_recon_loss: 40316.2461; val_gene_expr_recon_loss: 892876.5000; val_masked_gp_l1_reg_loss: 9421.5957; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35145.2031; val_chrom_access_recon_loss: 452820.7500; val_global_loss: 1442003.2500; val_optim_loss: 1442003.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9475; val_auprc_score: 0.9405; val_best_acc_score: 0.8760; val_best_f1_score: 0.8841; train_kl_reg_loss: 12816.1296; train_edge_recon_loss: 40102.3598; train_gene_expr_recon_loss: 899158.9583; train_masked_gp_l1_reg_loss: 9680.2939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34196.2452; train_chrom_access_recon_loss: 453993.0139; train_global_loss: 1449946.9861; train_optim_loss: 1449946.9861; val_kl_reg_loss: 10380.5723; val_edge_recon_loss: 40345.8047; val_gene_expr_recon_loss: 886498.5000; val_masked_gp_l1_reg_loss: 9966.0479; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33028.7539; val_chrom_access_recon_loss: 452107.9688; val_global_loss: 1432327.6250; val_optim_loss: 1432327.6250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9465; val_auprc_score: 0.9393; val_best_acc_score: 0.8789; val_best_f1_score: 0.8858; train_kl_reg_loss: 11907.7435; train_edge_recon_loss: 40109.5039; train_gene_expr_recon_loss: 899358.8750; train_masked_gp_l1_reg_loss: 10125.1425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32139.7830; train_chrom_access_recon_loss: 452499.5208; train_global_loss: 1446140.6111; train_optim_loss: 1446140.6111; val_kl_reg_loss: 10354.6797; val_edge_recon_loss: 40319.6367; val_gene_expr_recon_loss: 881332.6250; val_masked_gp_l1_reg_loss: 10278.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31059.9766; val_chrom_access_recon_loss: 451496.4375; val_global_loss: 1424841.7500; val_optim_loss: 1424841.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9495; val_auprc_score: 0.9415; val_best_acc_score: 0.8841; val_best_f1_score: 0.8881; train_kl_reg_loss: 11587.1719; train_edge_recon_loss: 40072.2183; train_gene_expr_recon_loss: 896171.6319; train_masked_gp_l1_reg_loss: 10352.7881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30247.2266; train_chrom_access_recon_loss: 453168.7431; train_global_loss: 1441599.7778; train_optim_loss: 1441599.7778; val_kl_reg_loss: 10149.3799; val_edge_recon_loss: 40259.8086; val_gene_expr_recon_loss: 877539.2500; val_masked_gp_l1_reg_loss: 10423.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29261.4414; val_chrom_access_recon_loss: 450914.1250; val_global_loss: 1418547.5000; val_optim_loss: 1418547.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9484; val_auprc_score: 0.9405; val_best_acc_score: 0.8816; val_best_f1_score: 0.8861; train_kl_reg_loss: 11367.2241; train_edge_recon_loss: 40047.2817; train_gene_expr_recon_loss: 893754.2569; train_masked_gp_l1_reg_loss: 10347.6902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29146.7847; train_chrom_access_recon_loss: 454978.7118; train_global_loss: 1439641.9444; train_optim_loss: 1439641.9444; val_kl_reg_loss: 10521.5938; val_edge_recon_loss: 40254.1797; val_gene_expr_recon_loss: 876650.0000; val_masked_gp_l1_reg_loss: 10288.3311; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29007.2617; val_chrom_access_recon_loss: 450744.1250; val_global_loss: 1417465.5000; val_optim_loss: 1417465.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9461; val_auprc_score: 0.9383; val_best_acc_score: 0.8775; val_best_f1_score: 0.8825; train_kl_reg_loss: 11630.5818; train_edge_recon_loss: 40051.7817; train_gene_expr_recon_loss: 885123.2569; train_masked_gp_l1_reg_loss: 10273.6497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28910.9507; train_chrom_access_recon_loss: 451069.6215; train_global_loss: 1427059.8472; train_optim_loss: 1427059.8472; val_kl_reg_loss: 10506.4395; val_edge_recon_loss: 40257.3672; val_gene_expr_recon_loss: 876391.2500; val_masked_gp_l1_reg_loss: 10247.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28789.8340; val_chrom_access_recon_loss: 450771.6875; val_global_loss: 1416963.7500; val_optim_loss: 1416963.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9516; val_auprc_score: 0.9463; val_best_acc_score: 0.8892; val_best_f1_score: 0.8922; train_kl_reg_loss: 11500.1200; train_edge_recon_loss: 40038.4583; train_gene_expr_recon_loss: 892087.2569; train_masked_gp_l1_reg_loss: 10233.4185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28698.6851; train_chrom_access_recon_loss: 452602.1354; train_global_loss: 1435160.0694; train_optim_loss: 1435160.0694; val_kl_reg_loss: 10374.3770; val_edge_recon_loss: 40241.9961; val_gene_expr_recon_loss: 876212.3750; val_masked_gp_l1_reg_loss: 10218.1357; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28586.7148; val_chrom_access_recon_loss: 450699.7500; val_global_loss: 1416333.2500; val_optim_loss: 1416333.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9447; val_auprc_score: 0.9364; val_best_acc_score: 0.8779; val_best_f1_score: 0.8826; train_kl_reg_loss: 11445.7235; train_edge_recon_loss: 40032.5911; train_gene_expr_recon_loss: 893594.7500; train_masked_gp_l1_reg_loss: 10209.5553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28499.9008; train_chrom_access_recon_loss: 453613.5486; train_global_loss: 1437396.0556; train_optim_loss: 1437396.0556; val_kl_reg_loss: 10452.7656; val_edge_recon_loss: 40246.6016; val_gene_expr_recon_loss: 875863.0000; val_masked_gp_l1_reg_loss: 10200.6533; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28394.9316; val_chrom_access_recon_loss: 450639.5938; val_global_loss: 1415797.5000; val_optim_loss: 1415797.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 32 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9475
val AUPRC score: 0.9382
val best accuracy score: 0.8797
val best F1 score: 0.8863
val target rna MSE score: 3.8018
val source rna MSE score: 3.0881
val target atac MSE score: 0.1314
val source atac MSE score: 0.0202
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
