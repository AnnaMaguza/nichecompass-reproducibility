[True]
Run timestamp: 10082023_225424_87.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_87']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7469; val_auprc_score: 0.7774; val_best_acc_score: 0.5050; val_best_f1_score: 0.6684; train_kl_reg_loss: 130150.9026; train_edge_recon_loss: 3849208.6107; train_gene_expr_recon_loss: 46163204.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16719165.2443; train_global_loss: 66861729.2519; train_optim_loss: 66861729.2519; val_kl_reg_loss: 90536.8328; val_edge_recon_loss: 4064975.3333; val_gene_expr_recon_loss: 39321742.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15886170.7333; val_global_loss: 59363425.0667; val_optim_loss: 59363425.0667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7246; val_auprc_score: 0.7657; val_best_acc_score: 0.5240; val_best_f1_score: 0.6736; train_kl_reg_loss: 126117.9526; train_edge_recon_loss: 3775289.9447; train_gene_expr_recon_loss: 39119821.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15604473.3435; train_global_loss: 58625703.1450; train_optim_loss: 58625703.1450; val_kl_reg_loss: 111487.3438; val_edge_recon_loss: 4063419.7500; val_gene_expr_recon_loss: 38028829.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15646319.2667; val_global_loss: 57850055.4667; val_optim_loss: 57850055.4667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7428; val_auprc_score: 0.7745; val_best_acc_score: 0.5951; val_best_f1_score: 0.6948; train_kl_reg_loss: 161227.9838; train_edge_recon_loss: 3625969.7786; train_gene_expr_recon_loss: 37400966.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15415414.1832; train_global_loss: 56603577.8321; train_optim_loss: 56603577.8321; val_kl_reg_loss: 105333.5234; val_edge_recon_loss: 4054283.4333; val_gene_expr_recon_loss: 37122053.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15588006.8000; val_global_loss: 56869676.8000; val_optim_loss: 56869676.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8242; val_auprc_score: 0.8311; val_best_acc_score: 0.7241; val_best_f1_score: 0.7345; train_kl_reg_loss: 155911.2979; train_edge_recon_loss: 3565521.4676; train_gene_expr_recon_loss: 36792427.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15289465.1145; train_global_loss: 55803324.9466; train_optim_loss: 55803324.9466; val_kl_reg_loss: 150515.0885; val_edge_recon_loss: 3979285.7167; val_gene_expr_recon_loss: 36645292.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15421060.6667; val_global_loss: 56196154.1333; val_optim_loss: 56196154.1333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8639; val_auprc_score: 0.8652; val_best_acc_score: 0.7735; val_best_f1_score: 0.7870; train_kl_reg_loss: 140007.3488; train_edge_recon_loss: 3496326.6889; train_gene_expr_recon_loss: 36395001.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15188587.6489; train_global_loss: 55219923.7557; train_optim_loss: 55219923.7557; val_kl_reg_loss: 129652.9484; val_edge_recon_loss: 3691717.0833; val_gene_expr_recon_loss: 36179381.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15259976.3333; val_global_loss: 55260728.2667; val_optim_loss: 55260728.2667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9004; val_auprc_score: 0.8939; val_best_acc_score: 0.8172; val_best_f1_score: 0.8297; train_kl_reg_loss: 134668.2466; train_edge_recon_loss: 3297126.7901; train_gene_expr_recon_loss: 36164716.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15113719.5725; train_global_loss: 54710230.8092; train_optim_loss: 54710230.8092; val_kl_reg_loss: 161342.8250; val_edge_recon_loss: 3118527.0333; val_gene_expr_recon_loss: 36218418.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15314134.3333; val_global_loss: 54812423.4667; val_optim_loss: 54812423.4667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9089; val_auprc_score: 0.8940; val_best_acc_score: 0.8358; val_best_f1_score: 0.8448; train_kl_reg_loss: 170363.6423; train_edge_recon_loss: 3005479.6393; train_gene_expr_recon_loss: 35935068.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15038730.0992; train_global_loss: 54149641.6183; train_optim_loss: 54149641.6183; val_kl_reg_loss: 175719.1615; val_edge_recon_loss: 2981630.2167; val_gene_expr_recon_loss: 35908236.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15204085.0667; val_global_loss: 54269671.2000; val_optim_loss: 54269671.2000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9206; val_auprc_score: 0.9062; val_best_acc_score: 0.8546; val_best_f1_score: 0.8648; train_kl_reg_loss: 172950.0491; train_edge_recon_loss: 2927398.0019; train_gene_expr_recon_loss: 35746532.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14969835.1908; train_global_loss: 53816715.7252; train_optim_loss: 53816715.7252; val_kl_reg_loss: 175010.1156; val_edge_recon_loss: 2913746.4167; val_gene_expr_recon_loss: 35739892.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15088691.1333; val_global_loss: 53917340.2667; val_optim_loss: 53917340.2667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9317; val_auprc_score: 0.9196; val_best_acc_score: 0.8662; val_best_f1_score: 0.8737; train_kl_reg_loss: 167363.9851; train_edge_recon_loss: 2894375.5878; train_gene_expr_recon_loss: 35604383.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14934629.5191; train_global_loss: 53600752.9771; train_optim_loss: 53600752.9771; val_kl_reg_loss: 166118.5771; val_edge_recon_loss: 2899333.1833; val_gene_expr_recon_loss: 35584892.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15037673.2000; val_global_loss: 53688016.8000; val_optim_loss: 53688016.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9426; val_auprc_score: 0.9331; val_best_acc_score: 0.8783; val_best_f1_score: 0.8850; train_kl_reg_loss: 162425.9313; train_edge_recon_loss: 2874625.0649; train_gene_expr_recon_loss: 35437189.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14876505.9237; train_global_loss: 53350746.6260; train_optim_loss: 53350746.6260; val_kl_reg_loss: 162225.3896; val_edge_recon_loss: 2843072.6833; val_gene_expr_recon_loss: 35611748.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15122836.8667; val_global_loss: 53739884.0000; val_optim_loss: 53739884.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9422; val_auprc_score: 0.9308; val_best_acc_score: 0.8771; val_best_f1_score: 0.8840; train_kl_reg_loss: 156139.5208; train_edge_recon_loss: 2856838.0496; train_gene_expr_recon_loss: 35244445.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14795449.2290; train_global_loss: 53052872.6107; train_optim_loss: 53052872.6107; val_kl_reg_loss: 161853.3615; val_edge_recon_loss: 2851035.2500; val_gene_expr_recon_loss: 35397332.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14992801.6000; val_global_loss: 53403022.1333; val_optim_loss: 53403022.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9454; val_auprc_score: 0.9339; val_best_acc_score: 0.8762; val_best_f1_score: 0.8839; train_kl_reg_loss: 152463.5650; train_edge_recon_loss: 2848181.9924; train_gene_expr_recon_loss: 35170438.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14770969.3740; train_global_loss: 52942053.7099; train_optim_loss: 52942053.7099; val_kl_reg_loss: 150910.4542; val_edge_recon_loss: 2845305.7500; val_gene_expr_recon_loss: 35160934.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14844524.7333; val_global_loss: 53001675.2000; val_optim_loss: 53001675.2000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9473; val_auprc_score: 0.9340; val_best_acc_score: 0.8817; val_best_f1_score: 0.8885; train_kl_reg_loss: 147143.2770; train_edge_recon_loss: 2825670.6565; train_gene_expr_recon_loss: 35111513.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14749646.9771; train_global_loss: 52833974.5649; train_optim_loss: 52833974.5649; val_kl_reg_loss: 150249.2906; val_edge_recon_loss: 2819482.3000; val_gene_expr_recon_loss: 35038691.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14893901.0000; val_global_loss: 52902324.0000; val_optim_loss: 52902324.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9463; val_auprc_score: 0.9355; val_best_acc_score: 0.8813; val_best_f1_score: 0.8872; train_kl_reg_loss: 144249.1270; train_edge_recon_loss: 2818044.2519; train_gene_expr_recon_loss: 34966670.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14699198.2824; train_global_loss: 52628162.3511; train_optim_loss: 52628162.3511; val_kl_reg_loss: 140543.4500; val_edge_recon_loss: 2835414.2833; val_gene_expr_recon_loss: 34968644.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14819289.0000; val_global_loss: 52763890.6667; val_optim_loss: 52763890.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9511; val_auprc_score: 0.9403; val_best_acc_score: 0.8859; val_best_f1_score: 0.8915; train_kl_reg_loss: 139575.9846; train_edge_recon_loss: 2807953.9351; train_gene_expr_recon_loss: 34903059.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14677386.6947; train_global_loss: 52527976.3053; train_optim_loss: 52527976.3053; val_kl_reg_loss: 136854.2958; val_edge_recon_loss: 2811841.0000; val_gene_expr_recon_loss: 34905351.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14828014.2000; val_global_loss: 52682061.3333; val_optim_loss: 52682061.3333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9572; val_auprc_score: 0.9484; val_best_acc_score: 0.8980; val_best_f1_score: 0.9015; train_kl_reg_loss: 136739.3312; train_edge_recon_loss: 2794464.4943; train_gene_expr_recon_loss: 34831092.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14651568.4122; train_global_loss: 52413864.7634; train_optim_loss: 52413864.7634; val_kl_reg_loss: 136966.2651; val_edge_recon_loss: 2800299.0333; val_gene_expr_recon_loss: 34877663.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14795840.1333; val_global_loss: 52610769.8667; val_optim_loss: 52610769.8667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9597; val_auprc_score: 0.9515; val_best_acc_score: 0.8984; val_best_f1_score: 0.9026; train_kl_reg_loss: 132640.0458; train_edge_recon_loss: 2788613.7118; train_gene_expr_recon_loss: 34710186.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14612744.3893; train_global_loss: 52244184.4580; train_optim_loss: 52244184.4580; val_kl_reg_loss: 129809.0161; val_edge_recon_loss: 2813393.5167; val_gene_expr_recon_loss: 34911493.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14825588.7333; val_global_loss: 52680285.0667; val_optim_loss: 52680285.0667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9591; val_auprc_score: 0.9507; val_best_acc_score: 0.8965; val_best_f1_score: 0.9009; train_kl_reg_loss: 130633.7301; train_edge_recon_loss: 2784508.9008; train_gene_expr_recon_loss: 34656695.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14593010.8015; train_global_loss: 52164848.7328; train_optim_loss: 52164848.7328; val_kl_reg_loss: 128431.4760; val_edge_recon_loss: 2795043.7000; val_gene_expr_recon_loss: 34667821.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14751093.6667; val_global_loss: 52342391.2000; val_optim_loss: 52342391.2000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9600; val_auprc_score: 0.9504; val_best_acc_score: 0.8998; val_best_f1_score: 0.9025; train_kl_reg_loss: 127591.9893; train_edge_recon_loss: 2784102.0095; train_gene_expr_recon_loss: 34624237.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14592672.0153; train_global_loss: 52128603.7863; train_optim_loss: 52128603.7863; val_kl_reg_loss: 126140.6583; val_edge_recon_loss: 2787089.9000; val_gene_expr_recon_loss: 34540991.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14702911.4000; val_global_loss: 52157133.8667; val_optim_loss: 52157133.8667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9640; val_auprc_score: 0.9568; val_best_acc_score: 0.9031; val_best_f1_score: 0.9070; train_kl_reg_loss: 125065.7562; train_edge_recon_loss: 2780986.7462; train_gene_expr_recon_loss: 34563770.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14580301.2061; train_global_loss: 52050123.8168; train_optim_loss: 52050123.8168; val_kl_reg_loss: 124241.1526; val_edge_recon_loss: 2773764.4000; val_gene_expr_recon_loss: 34602177.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14676406.1333; val_global_loss: 52176588.2667; val_optim_loss: 52176588.2667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9660; val_auprc_score: 0.9583; val_best_acc_score: 0.9073; val_best_f1_score: 0.9101; train_kl_reg_loss: 121860.7971; train_edge_recon_loss: 2768252.6450; train_gene_expr_recon_loss: 34529997.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14568522.3511; train_global_loss: 51988633.5878; train_optim_loss: 51988633.5878; val_kl_reg_loss: 120289.1432; val_edge_recon_loss: 2760590.2833; val_gene_expr_recon_loss: 34761332.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14804673.0000; val_global_loss: 52446885.0667; val_optim_loss: 52446885.0667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9671; val_auprc_score: 0.9603; val_best_acc_score: 0.9123; val_best_f1_score: 0.9145; train_kl_reg_loss: 120783.4686; train_edge_recon_loss: 2763445.5840; train_gene_expr_recon_loss: 34475626.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14555466.8321; train_global_loss: 51915322.2901; train_optim_loss: 51915322.2901; val_kl_reg_loss: 117586.6297; val_edge_recon_loss: 2750459.2833; val_gene_expr_recon_loss: 34752362.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14835594.3333; val_global_loss: 52456003.2000; val_optim_loss: 52456003.2000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9663; val_auprc_score: 0.9597; val_best_acc_score: 0.9132; val_best_f1_score: 0.9154; train_kl_reg_loss: 117165.9761; train_edge_recon_loss: 2756649.2595; train_gene_expr_recon_loss: 34418680.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14537517.0229; train_global_loss: 51830013.0076; train_optim_loss: 51830013.0076; val_kl_reg_loss: 116465.5292; val_edge_recon_loss: 2756420.0000; val_gene_expr_recon_loss: 34648698.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14780659.3333; val_global_loss: 52302242.9333; val_optim_loss: 52302242.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9689; val_auprc_score: 0.9631; val_best_acc_score: 0.9115; val_best_f1_score: 0.9146; train_kl_reg_loss: 117653.3627; train_edge_recon_loss: 2751388.6832; train_gene_expr_recon_loss: 34324614.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14528255.0076; train_global_loss: 51721911.8168; train_optim_loss: 51721911.8168; val_kl_reg_loss: 118868.6609; val_edge_recon_loss: 2773534.4500; val_gene_expr_recon_loss: 34416782.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14639465.3333; val_global_loss: 51948651.7333; val_optim_loss: 51948651.7333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9655; val_auprc_score: 0.9564; val_best_acc_score: 0.9103; val_best_f1_score: 0.9127; train_kl_reg_loss: 118883.2016; train_edge_recon_loss: 2746476.2328; train_gene_expr_recon_loss: 34320250.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 14513341.0000; train_global_loss: 51698951.3588; train_optim_loss: 51698951.3588; val_kl_reg_loss: 120070.5266; val_edge_recon_loss: 2765217.9167; val_gene_expr_recon_loss: 34546337.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 14706970.6000; val_global_loss: 52138595.4667; val_optim_loss: 52138595.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9633; val_auprc_score: 0.9544; val_best_acc_score: 0.9089; val_best_f1_score: 0.9128; train_kl_reg_loss: 130354.3632; train_edge_recon_loss: 2921720.9561; train_gene_expr_recon_loss: 38601950.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15073351.1832; train_global_loss: 56727377.0687; train_optim_loss: 56727377.0687; val_kl_reg_loss: 34332.9297; val_edge_recon_loss: 2942839.9500; val_gene_expr_recon_loss: 38099294.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15172017.6000; val_global_loss: 56248485.3333; val_optim_loss: 56248485.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9650; val_auprc_score: 0.9550; val_best_acc_score: 0.9100; val_best_f1_score: 0.9126; train_kl_reg_loss: 146515.8323; train_edge_recon_loss: 2943773.1088; train_gene_expr_recon_loss: 38139039.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15025365.3206; train_global_loss: 56254693.3740; train_optim_loss: 56254693.3740; val_kl_reg_loss: 31246.6539; val_edge_recon_loss: 2947419.6167; val_gene_expr_recon_loss: 38405484.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15207526.0000; val_global_loss: 56591675.7333; val_optim_loss: 56591675.7333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9664; val_auprc_score: 0.9591; val_best_acc_score: 0.9111; val_best_f1_score: 0.9136; train_kl_reg_loss: 154802.8913; train_edge_recon_loss: 2945900.6183; train_gene_expr_recon_loss: 38152834.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15025366.7939; train_global_loss: 56278904.8550; train_optim_loss: 56278904.8550; val_kl_reg_loss: 29933.8814; val_edge_recon_loss: 2958128.0500; val_gene_expr_recon_loss: 38421184.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15234449.5333; val_global_loss: 56643696.5333; val_optim_loss: 56643696.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9633; val_auprc_score: 0.9526; val_best_acc_score: 0.9054; val_best_f1_score: 0.9096; train_kl_reg_loss: 158404.2281; train_edge_recon_loss: 2945133.7023; train_gene_expr_recon_loss: 38366237.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15087697.4580; train_global_loss: 56557473.0382; train_optim_loss: 56557473.0382; val_kl_reg_loss: 30310.6842; val_edge_recon_loss: 2941632.4167; val_gene_expr_recon_loss: 38337273.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15199373.6667; val_global_loss: 56508590.4000; val_optim_loss: 56508590.4000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9649; val_auprc_score: 0.9540; val_best_acc_score: 0.9116; val_best_f1_score: 0.9140; train_kl_reg_loss: 158614.1405; train_edge_recon_loss: 2943962.7462; train_gene_expr_recon_loss: 38389983.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15084698.3817; train_global_loss: 56577259.1450; train_optim_loss: 56577259.1450; val_kl_reg_loss: 30740.5579; val_edge_recon_loss: 2943216.9833; val_gene_expr_recon_loss: 38449021.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15224061.6000; val_global_loss: 56647040.5333; val_optim_loss: 56647040.5333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9625; val_auprc_score: 0.9549; val_best_acc_score: 0.9033; val_best_f1_score: 0.9074; train_kl_reg_loss: 159184.2591; train_edge_recon_loss: 2935010.5019; train_gene_expr_recon_loss: 38436969.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15088234.1985; train_global_loss: 56619398.4427; train_optim_loss: 56619398.4427; val_kl_reg_loss: 28609.3618; val_edge_recon_loss: 2984833.4167; val_gene_expr_recon_loss: 38749495.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15368670.3333; val_global_loss: 57131609.3333; val_optim_loss: 57131609.3333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9665; val_auprc_score: 0.9582; val_best_acc_score: 0.9091; val_best_f1_score: 0.9121; train_kl_reg_loss: 159392.4089; train_edge_recon_loss: 2949741.0458; train_gene_expr_recon_loss: 38549759.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15108961.6794; train_global_loss: 56767854.4122; train_optim_loss: 56767854.4122; val_kl_reg_loss: 30546.6725; val_edge_recon_loss: 2924467.0667; val_gene_expr_recon_loss: 38513169.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15297322.2000; val_global_loss: 56765505.8667; val_optim_loss: 56765505.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 33 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9664
val AUPRC score: 0.9548
val best accuracy score: 0.9124
val best F1 score: 0.9155
val target rna MSE score: 1.5664
val source rna MSE score: 30.3749
val target atac MSE score: 0.3754
val source atac MSE score: 3.3053
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
