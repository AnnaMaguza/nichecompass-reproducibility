[True]
Run timestamp: 10082023_191902_19.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_19']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7966; val_auprc_score: 0.8123; val_best_acc_score: 0.5253; val_best_f1_score: 0.6765; train_kl_reg_loss: 107233.9694; train_edge_recon_loss: 3817558.1660; train_gene_expr_recon_loss: 29779651.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 77920983.7557; train_global_loss: 111625427.1756; train_optim_loss: 111625427.1756; val_kl_reg_loss: 84112.9391; val_edge_recon_loss: 4063319.1167; val_gene_expr_recon_loss: 24224682.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 70691809.6000; val_global_loss: 99063923.7333; val_optim_loss: 99063923.7333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7721; val_auprc_score: 0.7929; val_best_acc_score: 0.6483; val_best_f1_score: 0.7149; train_kl_reg_loss: 138061.4113; train_edge_recon_loss: 3763842.5191; train_gene_expr_recon_loss: 23446344.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 69576975.8779; train_global_loss: 96925225.2214; train_optim_loss: 96925225.2214; val_kl_reg_loss: 174470.0271; val_edge_recon_loss: 4054999.4000; val_gene_expr_recon_loss: 22887393.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 69957519.4667; val_global_loss: 97074381.8667; val_optim_loss: 97074381.8667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8499; val_auprc_score: 0.8507; val_best_acc_score: 0.7328; val_best_f1_score: 0.7749; train_kl_reg_loss: 166537.1063; train_edge_recon_loss: 3577036.0935; train_gene_expr_recon_loss: 22346963.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 68762317.8321; train_global_loss: 94852855.0229; train_optim_loss: 94852855.0229; val_kl_reg_loss: 161271.3979; val_edge_recon_loss: 3970714.0500; val_gene_expr_recon_loss: 22295000.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 68671837.0667; val_global_loss: 95098823.4667; val_optim_loss: 95098823.4667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8734; val_auprc_score: 0.8657; val_best_acc_score: 0.7890; val_best_f1_score: 0.8026; train_kl_reg_loss: 142612.6830; train_edge_recon_loss: 3395116.5038; train_gene_expr_recon_loss: 22120437.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 68513695.5115; train_global_loss: 94171862.2290; train_optim_loss: 94171862.2290; val_kl_reg_loss: 170407.9813; val_edge_recon_loss: 3122851.9833; val_gene_expr_recon_loss: 22137426.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 68434959.7333; val_global_loss: 93865646.4000; val_optim_loss: 93865646.4000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8806; val_auprc_score: 0.8676; val_best_acc_score: 0.7986; val_best_f1_score: 0.8140; train_kl_reg_loss: 179935.8768; train_edge_recon_loss: 3045773.3053; train_gene_expr_recon_loss: 21906969.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67929810.4122; train_global_loss: 93062489.0992; train_optim_loss: 93062489.0992; val_kl_reg_loss: 187533.5552; val_edge_recon_loss: 3006044.1500; val_gene_expr_recon_loss: 21947921.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67951310.9333; val_global_loss: 93092810.1333; val_optim_loss: 93092810.1333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8838; val_auprc_score: 0.8691; val_best_acc_score: 0.8027; val_best_f1_score: 0.8233; train_kl_reg_loss: 177012.7385; train_edge_recon_loss: 2978203.8645; train_gene_expr_recon_loss: 21738038.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67424991.4504; train_global_loss: 92318246.1069; train_optim_loss: 92318246.1069; val_kl_reg_loss: 177076.2750; val_edge_recon_loss: 2982041.3500; val_gene_expr_recon_loss: 21859042.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67970560.2667; val_global_loss: 92988719.4667; val_optim_loss: 92988719.4667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8961; val_auprc_score: 0.8812; val_best_acc_score: 0.8141; val_best_f1_score: 0.8346; train_kl_reg_loss: 169693.1994; train_edge_recon_loss: 2933553.0363; train_gene_expr_recon_loss: 21632527.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67181282.1374; train_global_loss: 91917055.2061; train_optim_loss: 91917055.2061; val_kl_reg_loss: 160933.0531; val_edge_recon_loss: 2935049.9167; val_gene_expr_recon_loss: 21639320.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66738022.1333; val_global_loss: 91473325.3333; val_optim_loss: 91473325.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9100; val_auprc_score: 0.8960; val_best_acc_score: 0.8257; val_best_f1_score: 0.8421; train_kl_reg_loss: 164722.3646; train_edge_recon_loss: 2911670.8989; train_gene_expr_recon_loss: 21494954.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66799129.4962; train_global_loss: 91370477.8626; train_optim_loss: 91370477.8626; val_kl_reg_loss: 166831.7875; val_edge_recon_loss: 2888474.1000; val_gene_expr_recon_loss: 21677383.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67297040.8000; val_global_loss: 92029729.6000; val_optim_loss: 92029729.6000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9178; val_auprc_score: 0.9053; val_best_acc_score: 0.8389; val_best_f1_score: 0.8474; train_kl_reg_loss: 161078.0533; train_edge_recon_loss: 2887018.3855; train_gene_expr_recon_loss: 21406067.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66497561.0076; train_global_loss: 90951725.3130; train_optim_loss: 90951725.3130; val_kl_reg_loss: 158076.7323; val_edge_recon_loss: 2887187.2833; val_gene_expr_recon_loss: 21556216.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67172965.6000; val_global_loss: 91774445.8667; val_optim_loss: 91774445.8667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9279; val_auprc_score: 0.9138; val_best_acc_score: 0.8522; val_best_f1_score: 0.8602; train_kl_reg_loss: 154840.1311; train_edge_recon_loss: 2863806.6584; train_gene_expr_recon_loss: 21329267.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66310853.1908; train_global_loss: 90658767.6947; train_optim_loss: 90658767.6947; val_kl_reg_loss: 152295.3302; val_edge_recon_loss: 2880950.9833; val_gene_expr_recon_loss: 21522192.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66790879.4667; val_global_loss: 91346318.4000; val_optim_loss: 91346318.4000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9380; val_auprc_score: 0.9227; val_best_acc_score: 0.8733; val_best_f1_score: 0.8807; train_kl_reg_loss: 150868.1845; train_edge_recon_loss: 2839137.4313; train_gene_expr_recon_loss: 21246782.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66008110.9008; train_global_loss: 90244898.9313; train_optim_loss: 90244898.9313; val_kl_reg_loss: 146060.0073; val_edge_recon_loss: 2845531.7167; val_gene_expr_recon_loss: 21329491.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65994189.3333; val_global_loss: 90315271.4667; val_optim_loss: 90315271.4667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9434; val_auprc_score: 0.9305; val_best_acc_score: 0.8766; val_best_f1_score: 0.8833; train_kl_reg_loss: 146296.1567; train_edge_recon_loss: 2834980.3492; train_gene_expr_recon_loss: 21164656.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65763946.3511; train_global_loss: 89909878.9618; train_optim_loss: 89909878.9618; val_kl_reg_loss: 144675.6875; val_edge_recon_loss: 2822945.3500; val_gene_expr_recon_loss: 21295373.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65975318.1333; val_global_loss: 90238313.6000; val_optim_loss: 90238313.6000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9495; val_auprc_score: 0.9372; val_best_acc_score: 0.8897; val_best_f1_score: 0.8953; train_kl_reg_loss: 143832.3600; train_edge_recon_loss: 2807075.5649; train_gene_expr_recon_loss: 21133826.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65656437.1298; train_global_loss: 89741171.9084; train_optim_loss: 89741171.9084; val_kl_reg_loss: 140736.5385; val_edge_recon_loss: 2816920.4667; val_gene_expr_recon_loss: 21298762.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66085028.8000; val_global_loss: 90341448.0000; val_optim_loss: 90341448.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9492; val_auprc_score: 0.9388; val_best_acc_score: 0.8857; val_best_f1_score: 0.8920; train_kl_reg_loss: 139599.8672; train_edge_recon_loss: 2798357.4847; train_gene_expr_recon_loss: 21067569.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65485577.9237; train_global_loss: 89491104.9771; train_optim_loss: 89491104.9771; val_kl_reg_loss: 137897.1323; val_edge_recon_loss: 2821931.8167; val_gene_expr_recon_loss: 21113968.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65461873.8667; val_global_loss: 89535672.0000; val_optim_loss: 89535672.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9559; val_auprc_score: 0.9437; val_best_acc_score: 0.8985; val_best_f1_score: 0.9034; train_kl_reg_loss: 136681.6704; train_edge_recon_loss: 2782444.4885; train_gene_expr_recon_loss: 21004212.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65191006.8702; train_global_loss: 89114344.7939; train_optim_loss: 89114344.7939; val_kl_reg_loss: 135252.2156; val_edge_recon_loss: 2777929.0833; val_gene_expr_recon_loss: 21129623.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65482862.6667; val_global_loss: 89525668.2667; val_optim_loss: 89525668.2667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9559; val_auprc_score: 0.9445; val_best_acc_score: 0.8999; val_best_f1_score: 0.9042; train_kl_reg_loss: 133274.4481; train_edge_recon_loss: 2777192.3912; train_gene_expr_recon_loss: 20949177.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65023562.5954; train_global_loss: 88883206.9618; train_optim_loss: 88883206.9618; val_kl_reg_loss: 129294.6656; val_edge_recon_loss: 2794931.1000; val_gene_expr_recon_loss: 21149566.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65627782.4000; val_global_loss: 89701575.4667; val_optim_loss: 89701575.4667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9617; val_auprc_score: 0.9533; val_best_acc_score: 0.9039; val_best_f1_score: 0.9080; train_kl_reg_loss: 130457.8413; train_edge_recon_loss: 2769323.3263; train_gene_expr_recon_loss: 20899841.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64822605.7099; train_global_loss: 88622228.1527; train_optim_loss: 88622228.1527; val_kl_reg_loss: 127037.6911; val_edge_recon_loss: 2782910.8000; val_gene_expr_recon_loss: 21100091.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65222571.7333; val_global_loss: 89232611.7333; val_optim_loss: 89232611.7333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9639; val_auprc_score: 0.9550; val_best_acc_score: 0.9162; val_best_f1_score: 0.9199; train_kl_reg_loss: 128862.9906; train_edge_recon_loss: 2756292.2672; train_gene_expr_recon_loss: 20875201.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64792854.3206; train_global_loss: 88553211.6031; train_optim_loss: 88553211.6031; val_kl_reg_loss: 125415.8052; val_edge_recon_loss: 2762746.1167; val_gene_expr_recon_loss: 21054816.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65498635.4667; val_global_loss: 89441614.4000; val_optim_loss: 89441614.4000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9664; val_auprc_score: 0.9593; val_best_acc_score: 0.9122; val_best_f1_score: 0.9159; train_kl_reg_loss: 125707.3991; train_edge_recon_loss: 2755245.7500; train_gene_expr_recon_loss: 20838247.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64626200.3359; train_global_loss: 88345400.6718; train_optim_loss: 88345400.6718; val_kl_reg_loss: 122955.4094; val_edge_recon_loss: 2763045.2500; val_gene_expr_recon_loss: 21017589.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65235642.6667; val_global_loss: 89139232.5333; val_optim_loss: 89139232.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9669; val_auprc_score: 0.9582; val_best_acc_score: 0.9162; val_best_f1_score: 0.9198; train_kl_reg_loss: 123288.1217; train_edge_recon_loss: 2752559.4809; train_gene_expr_recon_loss: 20800957.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64517743.5725; train_global_loss: 88194548.7023; train_optim_loss: 88194548.7023; val_kl_reg_loss: 123646.2109; val_edge_recon_loss: 2748001.1667; val_gene_expr_recon_loss: 20909085.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64461519.7333; val_global_loss: 88242252.8000; val_optim_loss: 88242252.8000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9714; val_auprc_score: 0.9655; val_best_acc_score: 0.9214; val_best_f1_score: 0.9237; train_kl_reg_loss: 121584.0461; train_edge_recon_loss: 2743118.7195; train_gene_expr_recon_loss: 20774207.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64507213.2214; train_global_loss: 88146123.2977; train_optim_loss: 88146123.2977; val_kl_reg_loss: 120240.9604; val_edge_recon_loss: 2745436.8833; val_gene_expr_recon_loss: 20949468.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64712187.2000; val_global_loss: 88527333.3333; val_optim_loss: 88527333.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9699; val_auprc_score: 0.9631; val_best_acc_score: 0.9184; val_best_f1_score: 0.9213; train_kl_reg_loss: 119794.9977; train_edge_recon_loss: 2733089.0573; train_gene_expr_recon_loss: 20723703.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64280648.8855; train_global_loss: 87857237.1908; train_optim_loss: 87857237.1908; val_kl_reg_loss: 119427.4901; val_edge_recon_loss: 2756185.6833; val_gene_expr_recon_loss: 20852684.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64679088.2667; val_global_loss: 88407386.6667; val_optim_loss: 88407386.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9693; val_auprc_score: 0.9622; val_best_acc_score: 0.9189; val_best_f1_score: 0.9220; train_kl_reg_loss: 117353.8828; train_edge_recon_loss: 2735665.3683; train_gene_expr_recon_loss: 20744689.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64294555.7252; train_global_loss: 87892264.7328; train_optim_loss: 87892264.7328; val_kl_reg_loss: 115371.3036; val_edge_recon_loss: 2733247.4333; val_gene_expr_recon_loss: 20914553.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64816345.3333; val_global_loss: 88579517.3333; val_optim_loss: 88579517.3333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9730; val_auprc_score: 0.9672; val_best_acc_score: 0.9259; val_best_f1_score: 0.9286; train_kl_reg_loss: 115927.2667; train_edge_recon_loss: 2729945.9122; train_gene_expr_recon_loss: 20681381.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64068723.8779; train_global_loss: 87595978.3206; train_optim_loss: 87595978.3206; val_kl_reg_loss: 116200.8385; val_edge_recon_loss: 2724952.2000; val_gene_expr_recon_loss: 20823218.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64581973.6000; val_global_loss: 88246345.6000; val_optim_loss: 88246345.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9731; val_auprc_score: 0.9662; val_best_acc_score: 0.9244; val_best_f1_score: 0.9269; train_kl_reg_loss: 116627.3292; train_edge_recon_loss: 2722288.4427; train_gene_expr_recon_loss: 20640694.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64030664.4275; train_global_loss: 87510274.3817; train_optim_loss: 87510274.3817; val_kl_reg_loss: 117415.9839; val_edge_recon_loss: 2733499.1500; val_gene_expr_recon_loss: 20840630.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64442579.4667; val_global_loss: 88134125.8667; val_optim_loss: 88134125.8667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9743; val_auprc_score: 0.9687; val_best_acc_score: 0.9285; val_best_f1_score: 0.9313; train_kl_reg_loss: 115692.3891; train_edge_recon_loss: 2793801.7290; train_gene_expr_recon_loss: 21645693.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65133621.4656; train_global_loss: 89688808.6718; train_optim_loss: 89688808.6718; val_kl_reg_loss: 58017.9534; val_edge_recon_loss: 2806824.9667; val_gene_expr_recon_loss: 21849025.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65841660.0000; val_global_loss: 90555527.4667; val_optim_loss: 90555527.4667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9741; val_auprc_score: 0.9690; val_best_acc_score: 0.9237; val_best_f1_score: 0.9262; train_kl_reg_loss: 123405.8358; train_edge_recon_loss: 2782365.8931; train_gene_expr_recon_loss: 21549976.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65025461.8321; train_global_loss: 89481209.9542; train_optim_loss: 89481209.9542; val_kl_reg_loss: 59926.4643; val_edge_recon_loss: 2789100.5333; val_gene_expr_recon_loss: 21684904.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65581533.3333; val_global_loss: 90115465.0667; val_optim_loss: 90115465.0667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9730; val_auprc_score: 0.9667; val_best_acc_score: 0.9279; val_best_f1_score: 0.9306; train_kl_reg_loss: 127136.4518; train_edge_recon_loss: 2782916.6374; train_gene_expr_recon_loss: 21559989.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65142833.2519; train_global_loss: 89612875.4198; train_optim_loss: 89612875.4198; val_kl_reg_loss: 61201.5477; val_edge_recon_loss: 2785523.8500; val_gene_expr_recon_loss: 21666643.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65467859.4667; val_global_loss: 89981228.2667; val_optim_loss: 89981228.2667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9722; val_auprc_score: 0.9669; val_best_acc_score: 0.9224; val_best_f1_score: 0.9254; train_kl_reg_loss: 128534.8359; train_edge_recon_loss: 2768643.8740; train_gene_expr_recon_loss: 21521769.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64920505.0382; train_global_loss: 89339453.8626; train_optim_loss: 89339453.8626; val_kl_reg_loss: 63121.2107; val_edge_recon_loss: 2785218.8333; val_gene_expr_recon_loss: 21624916.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65063533.3333; val_global_loss: 89536789.3333; val_optim_loss: 89536789.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9729; val_auprc_score: 0.9649; val_best_acc_score: 0.9275; val_best_f1_score: 0.9300; train_kl_reg_loss: 129009.0875; train_edge_recon_loss: 2776196.1183; train_gene_expr_recon_loss: 21538514.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65040479.2672; train_global_loss: 89484199.3282; train_optim_loss: 89484199.3282; val_kl_reg_loss: 62389.1531; val_edge_recon_loss: 2778804.3167; val_gene_expr_recon_loss: 21733372.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65552309.6000; val_global_loss: 90126875.7333; val_optim_loss: 90126875.7333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9708; val_auprc_score: 0.9621; val_best_acc_score: 0.9188; val_best_f1_score: 0.9214; train_kl_reg_loss: 128653.8828; train_edge_recon_loss: 2776251.5534; train_gene_expr_recon_loss: 21521838.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64946880.0305; train_global_loss: 89373624.0611; train_optim_loss: 89373624.0611; val_kl_reg_loss: 63263.3826; val_edge_recon_loss: 2801216.1833; val_gene_expr_recon_loss: 21676375.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65358177.8667; val_global_loss: 89899032.5333; val_optim_loss: 89899032.5333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9747; val_auprc_score: 0.9705; val_best_acc_score: 0.9254; val_best_f1_score: 0.9279; train_kl_reg_loss: 128924.2677; train_edge_recon_loss: 2772079.8912; train_gene_expr_recon_loss: 21525783.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64958135.5420; train_global_loss: 89384922.8702; train_optim_loss: 89384922.8702; val_kl_reg_loss: 62476.1273; val_edge_recon_loss: 2784052.2500; val_gene_expr_recon_loss: 21707619.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65125236.2667; val_global_loss: 89679382.9333; val_optim_loss: 89679382.9333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9724; val_auprc_score: 0.9652; val_best_acc_score: 0.9236; val_best_f1_score: 0.9264; train_kl_reg_loss: 128916.5311; train_edge_recon_loss: 2767008.8931; train_gene_expr_recon_loss: 21527166.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65026490.4122; train_global_loss: 89449582.5954; train_optim_loss: 89449582.5954; val_kl_reg_loss: 63861.4047; val_edge_recon_loss: 2769632.0667; val_gene_expr_recon_loss: 21687645.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65603408.0000; val_global_loss: 90124546.6667; val_optim_loss: 90124546.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 15 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9736
val AUPRC score: 0.9669
val best accuracy score: 0.9282
val best F1 score: 0.9312
val target rna MSE score: 1.1552
val source rna MSE score: 39.3293
val target atac MSE score: 0.1269
val source atac MSE score: 0.9587
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
