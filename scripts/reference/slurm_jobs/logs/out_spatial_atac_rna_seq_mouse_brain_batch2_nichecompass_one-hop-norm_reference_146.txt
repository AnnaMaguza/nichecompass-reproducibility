[True]
Run timestamp: 10102023_044201_146.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_146']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7582; val_auprc_score: 0.7786; val_best_acc_score: 0.5772; val_best_f1_score: 0.6987; train_kl_reg_loss: 46721.1503; train_edge_recon_loss: 735725.8039; train_gene_expr_recon_loss: 22246321.4504; train_masked_gp_l1_reg_loss: 103926.0391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2367935.7505; train_chrom_access_recon_loss: 958898.6446; train_global_loss: 26459528.9466; train_optim_loss: 26459528.9466; val_kl_reg_loss: 72986.0292; val_edge_recon_loss: 812258.1083; val_gene_expr_recon_loss: 21513414.6667; val_masked_gp_l1_reg_loss: 87755.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 867888.7500; val_chrom_access_recon_loss: 929881.2625; val_global_loss: 24284184.1333; val_optim_loss: 24284184.1333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8442; val_auprc_score: 0.8526; val_best_acc_score: 0.7565; val_best_f1_score: 0.7718; train_kl_reg_loss: 61895.0045; train_edge_recon_loss: 727056.5716; train_gene_expr_recon_loss: 20897054.6412; train_masked_gp_l1_reg_loss: 85041.5182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 457214.4844; train_chrom_access_recon_loss: 919271.8421; train_global_loss: 23147534.2137; train_optim_loss: 23147534.2137; val_kl_reg_loss: 55260.0924; val_edge_recon_loss: 801748.1375; val_gene_expr_recon_loss: 21080960.0000; val_masked_gp_l1_reg_loss: 85059.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 246524.1562; val_chrom_access_recon_loss: 918495.8000; val_global_loss: 23188048.4000; val_optim_loss: 23188048.4000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9013; val_auprc_score: 0.8927; val_best_acc_score: 0.8205; val_best_f1_score: 0.8329; train_kl_reg_loss: 54430.1335; train_edge_recon_loss: 711884.4919; train_gene_expr_recon_loss: 20586283.2977; train_masked_gp_l1_reg_loss: 85728.6480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 185871.3845; train_chrom_access_recon_loss: 908238.7142; train_global_loss: 22532436.6565; train_optim_loss: 22532436.6565; val_kl_reg_loss: 52899.1724; val_edge_recon_loss: 740477.1375; val_gene_expr_recon_loss: 20817927.8667; val_masked_gp_l1_reg_loss: 87041.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145601.3906; val_chrom_access_recon_loss: 903769.3958; val_global_loss: 22747717.7333; val_optim_loss: 22747717.7333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9154; val_auprc_score: 0.9039; val_best_acc_score: 0.8379; val_best_f1_score: 0.8460; train_kl_reg_loss: 56555.4507; train_edge_recon_loss: 658508.6947; train_gene_expr_recon_loss: 20364743.3588; train_masked_gp_l1_reg_loss: 88225.1497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129224.9360; train_chrom_access_recon_loss: 901186.6317; train_global_loss: 22198444.1679; train_optim_loss: 22198444.1679; val_kl_reg_loss: 59121.8870; val_edge_recon_loss: 637545.8083; val_gene_expr_recon_loss: 20517782.5333; val_masked_gp_l1_reg_loss: 89700.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116343.6562; val_chrom_access_recon_loss: 897402.8375; val_global_loss: 22317897.2000; val_optim_loss: 22317897.2000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9262; val_auprc_score: 0.9150; val_best_acc_score: 0.8515; val_best_f1_score: 0.8594; train_kl_reg_loss: 63310.9556; train_edge_recon_loss: 619214.0854; train_gene_expr_recon_loss: 20172387.4198; train_masked_gp_l1_reg_loss: 90192.6474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106123.7617; train_chrom_access_recon_loss: 893092.1011; train_global_loss: 21944321.0382; train_optim_loss: 21944321.0382; val_kl_reg_loss: 65167.2505; val_edge_recon_loss: 609607.3333; val_gene_expr_recon_loss: 20385268.5333; val_masked_gp_l1_reg_loss: 91072.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100037.4141; val_chrom_access_recon_loss: 886926.1125; val_global_loss: 22138079.3333; val_optim_loss: 22138079.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9292; val_auprc_score: 0.9167; val_best_acc_score: 0.8557; val_best_f1_score: 0.8618; train_kl_reg_loss: 63688.0035; train_edge_recon_loss: 605253.6622; train_gene_expr_recon_loss: 19976608.9924; train_masked_gp_l1_reg_loss: 91753.1362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93245.9417; train_chrom_access_recon_loss: 884925.6207; train_global_loss: 21715475.4351; train_optim_loss: 21715475.4351; val_kl_reg_loss: 61630.3378; val_edge_recon_loss: 605159.8583; val_gene_expr_recon_loss: 20287064.6667; val_masked_gp_l1_reg_loss: 92945.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88944.8750; val_chrom_access_recon_loss: 884643.4708; val_global_loss: 22020388.2667; val_optim_loss: 22020388.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9354; val_auprc_score: 0.9246; val_best_acc_score: 0.8632; val_best_f1_score: 0.8691; train_kl_reg_loss: 62380.7427; train_edge_recon_loss: 601027.1541; train_gene_expr_recon_loss: 19852037.6794; train_masked_gp_l1_reg_loss: 93080.2196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84656.2911; train_chrom_access_recon_loss: 881136.2801; train_global_loss: 21574318.5649; train_optim_loss: 21574318.5649; val_kl_reg_loss: 60625.6661; val_edge_recon_loss: 600718.8458; val_gene_expr_recon_loss: 20160835.7333; val_masked_gp_l1_reg_loss: 93485.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81809.0000; val_chrom_access_recon_loss: 879261.4500; val_global_loss: 21876737.3333; val_optim_loss: 21876737.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9373; val_auprc_score: 0.9248; val_best_acc_score: 0.8690; val_best_f1_score: 0.8754; train_kl_reg_loss: 61183.1633; train_edge_recon_loss: 597215.1660; train_gene_expr_recon_loss: 19728494.1221; train_masked_gp_l1_reg_loss: 93791.9553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79351.6854; train_chrom_access_recon_loss: 874219.5625; train_global_loss: 21434255.7252; train_optim_loss: 21434255.7252; val_kl_reg_loss: 60921.3727; val_edge_recon_loss: 596398.1583; val_gene_expr_recon_loss: 19972995.6000; val_masked_gp_l1_reg_loss: 94095.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77245.6953; val_chrom_access_recon_loss: 870169.0417; val_global_loss: 21671826.0000; val_optim_loss: 21671826.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9385; val_auprc_score: 0.9281; val_best_acc_score: 0.8669; val_best_f1_score: 0.8733; train_kl_reg_loss: 60208.4013; train_edge_recon_loss: 594565.8478; train_gene_expr_recon_loss: 19601522.8092; train_masked_gp_l1_reg_loss: 94350.1497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76172.5317; train_chrom_access_recon_loss: 869136.5334; train_global_loss: 21295956.2901; train_optim_loss: 21295956.2901; val_kl_reg_loss: 60144.0763; val_edge_recon_loss: 597724.2958; val_gene_expr_recon_loss: 19968268.0000; val_masked_gp_l1_reg_loss: 95077.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75897.9297; val_chrom_access_recon_loss: 869550.3667; val_global_loss: 21666662.9333; val_optim_loss: 21666662.9333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9420; val_auprc_score: 0.9295; val_best_acc_score: 0.8732; val_best_f1_score: 0.8796; train_kl_reg_loss: 59180.0054; train_edge_recon_loss: 591882.7176; train_gene_expr_recon_loss: 19509058.3664; train_masked_gp_l1_reg_loss: 95173.2904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74018.6435; train_chrom_access_recon_loss: 865046.4776; train_global_loss: 21194359.6641; train_optim_loss: 21194359.6641; val_kl_reg_loss: 59425.4073; val_edge_recon_loss: 594510.0167; val_gene_expr_recon_loss: 19870093.4667; val_masked_gp_l1_reg_loss: 95335.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72252.4922; val_chrom_access_recon_loss: 866853.1917; val_global_loss: 21558470.2667; val_optim_loss: 21558470.2667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9460; val_auprc_score: 0.9363; val_best_acc_score: 0.8767; val_best_f1_score: 0.8843; train_kl_reg_loss: 58628.8560; train_edge_recon_loss: 589821.7338; train_gene_expr_recon_loss: 19412865.6947; train_masked_gp_l1_reg_loss: 95521.1293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71511.4208; train_chrom_access_recon_loss: 861654.2524; train_global_loss: 21090003.2061; train_optim_loss: 21090003.2061; val_kl_reg_loss: 57591.5612; val_edge_recon_loss: 593394.4583; val_gene_expr_recon_loss: 19677197.0667; val_masked_gp_l1_reg_loss: 96330.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71701.9688; val_chrom_access_recon_loss: 856511.3500; val_global_loss: 21352726.2667; val_optim_loss: 21352726.2667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9486; val_auprc_score: 0.9394; val_best_acc_score: 0.8804; val_best_f1_score: 0.8860; train_kl_reg_loss: 57684.8709; train_edge_recon_loss: 587803.4828; train_gene_expr_recon_loss: 19343042.3359; train_masked_gp_l1_reg_loss: 96206.0088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69824.1104; train_chrom_access_recon_loss: 858011.3335; train_global_loss: 21012572.1985; train_optim_loss: 21012572.1985; val_kl_reg_loss: 57425.4099; val_edge_recon_loss: 589656.7458; val_gene_expr_recon_loss: 19619445.0667; val_masked_gp_l1_reg_loss: 96561.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69799.7578; val_chrom_access_recon_loss: 851264.1458; val_global_loss: 21284153.2000; val_optim_loss: 21284153.2000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9502; val_auprc_score: 0.9390; val_best_acc_score: 0.8855; val_best_f1_score: 0.8902; train_kl_reg_loss: 57207.5278; train_edge_recon_loss: 586107.7510; train_gene_expr_recon_loss: 19264523.5267; train_masked_gp_l1_reg_loss: 96792.2061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68212.2160; train_chrom_access_recon_loss: 854327.2247; train_global_loss: 20927170.4275; train_optim_loss: 20927170.4275; val_kl_reg_loss: 57209.5826; val_edge_recon_loss: 589205.8750; val_gene_expr_recon_loss: 19583659.3333; val_masked_gp_l1_reg_loss: 97328.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68223.6172; val_chrom_access_recon_loss: 852412.8708; val_global_loss: 21248039.8667; val_optim_loss: 21248039.8667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9573; val_auprc_score: 0.9494; val_best_acc_score: 0.8963; val_best_f1_score: 0.9013; train_kl_reg_loss: 56670.2507; train_edge_recon_loss: 584473.6269; train_gene_expr_recon_loss: 19189005.8321; train_masked_gp_l1_reg_loss: 97384.7770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66856.3588; train_chrom_access_recon_loss: 852162.3268; train_global_loss: 20846553.2672; train_optim_loss: 20846553.2672; val_kl_reg_loss: 55955.7211; val_edge_recon_loss: 583173.5125; val_gene_expr_recon_loss: 19461156.2667; val_masked_gp_l1_reg_loss: 97762.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66906.1562; val_chrom_access_recon_loss: 848819.9125; val_global_loss: 21113773.6000; val_optim_loss: 21113773.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9574; val_auprc_score: 0.9473; val_best_acc_score: 0.8936; val_best_f1_score: 0.8977; train_kl_reg_loss: 56296.2501; train_edge_recon_loss: 583020.0601; train_gene_expr_recon_loss: 19137713.9847; train_masked_gp_l1_reg_loss: 98092.6401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65586.3333; train_chrom_access_recon_loss: 848733.9065; train_global_loss: 20789443.0992; train_optim_loss: 20789443.0992; val_kl_reg_loss: 55489.1128; val_edge_recon_loss: 587423.4292; val_gene_expr_recon_loss: 19522831.8667; val_masked_gp_l1_reg_loss: 98642.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65829.6172; val_chrom_access_recon_loss: 850019.1958; val_global_loss: 21180235.3333; val_optim_loss: 21180235.3333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9567; val_auprc_score: 0.9466; val_best_acc_score: 0.8988; val_best_f1_score: 0.9024; train_kl_reg_loss: 56165.9037; train_edge_recon_loss: 579980.8559; train_gene_expr_recon_loss: 19074148.2290; train_masked_gp_l1_reg_loss: 98796.1053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64783.9198; train_chrom_access_recon_loss: 846215.8960; train_global_loss: 20720090.9924; train_optim_loss: 20720090.9924; val_kl_reg_loss: 57093.3792; val_edge_recon_loss: 585533.6250; val_gene_expr_recon_loss: 19376192.1333; val_masked_gp_l1_reg_loss: 99068.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64261.0781; val_chrom_access_recon_loss: 844108.8333; val_global_loss: 21026258.0000; val_optim_loss: 21026258.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9578; val_auprc_score: 0.9464; val_best_acc_score: 0.9020; val_best_f1_score: 0.9060; train_kl_reg_loss: 55578.9440; train_edge_recon_loss: 580705.2252; train_gene_expr_recon_loss: 19003153.5420; train_masked_gp_l1_reg_loss: 99445.4106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64062.0098; train_chrom_access_recon_loss: 843070.6531; train_global_loss: 20646015.7405; train_optim_loss: 20646015.7405; val_kl_reg_loss: 54185.9935; val_edge_recon_loss: 580535.6125; val_gene_expr_recon_loss: 19402245.4667; val_masked_gp_l1_reg_loss: 99988.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64332.0195; val_chrom_access_recon_loss: 844418.7958; val_global_loss: 21045705.8667; val_optim_loss: 21045705.8667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9575; val_auprc_score: 0.9466; val_best_acc_score: 0.8996; val_best_f1_score: 0.9050; train_kl_reg_loss: 55135.5484; train_edge_recon_loss: 579239.4709; train_gene_expr_recon_loss: 18945903.8015; train_masked_gp_l1_reg_loss: 100393.4308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64460.6716; train_chrom_access_recon_loss: 841323.2209; train_global_loss: 20586456.1374; train_optim_loss: 20586456.1374; val_kl_reg_loss: 55894.4667; val_edge_recon_loss: 581598.1792; val_gene_expr_recon_loss: 19320077.4667; val_masked_gp_l1_reg_loss: 100813.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65535.4141; val_chrom_access_recon_loss: 843531.1417; val_global_loss: 20967451.3333; val_optim_loss: 20967451.3333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9602; val_auprc_score: 0.9486; val_best_acc_score: 0.9120; val_best_f1_score: 0.9144; train_kl_reg_loss: 54896.4871; train_edge_recon_loss: 579358.3745; train_gene_expr_recon_loss: 18888754.2901; train_masked_gp_l1_reg_loss: 101307.1891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65368.0742; train_chrom_access_recon_loss: 839706.4709; train_global_loss: 20529390.7634; train_optim_loss: 20529390.7634; val_kl_reg_loss: 55172.1302; val_edge_recon_loss: 582678.1250; val_gene_expr_recon_loss: 19279640.8000; val_masked_gp_l1_reg_loss: 101922.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66153.0547; val_chrom_access_recon_loss: 840983.5208; val_global_loss: 20926550.9333; val_optim_loss: 20926550.9333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9603; val_auprc_score: 0.9467; val_best_acc_score: 0.9100; val_best_f1_score: 0.9132; train_kl_reg_loss: 54651.7479; train_edge_recon_loss: 577811.2309; train_gene_expr_recon_loss: 18829693.6031; train_masked_gp_l1_reg_loss: 102355.1691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65954.6892; train_chrom_access_recon_loss: 838010.2982; train_global_loss: 20468476.6718; train_optim_loss: 20468476.6718; val_kl_reg_loss: 53457.1612; val_edge_recon_loss: 577429.3667; val_gene_expr_recon_loss: 19194493.7333; val_masked_gp_l1_reg_loss: 103038.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66060.2812; val_chrom_access_recon_loss: 839385.8500; val_global_loss: 20833864.5333; val_optim_loss: 20833864.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9602; val_auprc_score: 0.9452; val_best_acc_score: 0.9127; val_best_f1_score: 0.9157; train_kl_reg_loss: 54149.3842; train_edge_recon_loss: 578155.8745; train_gene_expr_recon_loss: 18761990.2290; train_masked_gp_l1_reg_loss: 103732.6831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66285.1705; train_chrom_access_recon_loss: 836048.3502; train_global_loss: 20400361.7252; train_optim_loss: 20400361.7252; val_kl_reg_loss: 55052.7760; val_edge_recon_loss: 577643.7417; val_gene_expr_recon_loss: 19146711.7333; val_masked_gp_l1_reg_loss: 104641.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65544.4375; val_chrom_access_recon_loss: 838595.7417; val_global_loss: 20788190.2667; val_optim_loss: 20788190.2667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9634; val_auprc_score: 0.9546; val_best_acc_score: 0.9108; val_best_f1_score: 0.9138; train_kl_reg_loss: 53885.5248; train_edge_recon_loss: 578251.3025; train_gene_expr_recon_loss: 18710832.2901; train_masked_gp_l1_reg_loss: 105269.1566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65749.4799; train_chrom_access_recon_loss: 835189.8879; train_global_loss: 20349177.6031; train_optim_loss: 20349177.6031; val_kl_reg_loss: 54032.5797; val_edge_recon_loss: 580103.8917; val_gene_expr_recon_loss: 19053032.4000; val_masked_gp_l1_reg_loss: 106048.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66862.6016; val_chrom_access_recon_loss: 835466.0167; val_global_loss: 20695544.8000; val_optim_loss: 20695544.8000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9613; val_auprc_score: 0.9498; val_best_acc_score: 0.9072; val_best_f1_score: 0.9115; train_kl_reg_loss: 53250.9181; train_edge_recon_loss: 577389.5177; train_gene_expr_recon_loss: 18650713.3588; train_masked_gp_l1_reg_loss: 106813.0802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66470.0862; train_chrom_access_recon_loss: 832787.8621; train_global_loss: 20287424.6260; train_optim_loss: 20287424.6260; val_kl_reg_loss: 52026.6062; val_edge_recon_loss: 578416.6792; val_gene_expr_recon_loss: 19047699.2000; val_masked_gp_l1_reg_loss: 107946.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66429.2422; val_chrom_access_recon_loss: 833691.5250; val_global_loss: 20686210.0000; val_optim_loss: 20686210.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9650; val_auprc_score: 0.9563; val_best_acc_score: 0.9167; val_best_f1_score: 0.9199; train_kl_reg_loss: 53288.2646; train_edge_recon_loss: 576770.6746; train_gene_expr_recon_loss: 18571779.2214; train_masked_gp_l1_reg_loss: 108528.8997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66963.0647; train_chrom_access_recon_loss: 831468.8941; train_global_loss: 20208799.0534; train_optim_loss: 20208799.0534; val_kl_reg_loss: 52838.9414; val_edge_recon_loss: 577760.1917; val_gene_expr_recon_loss: 18964532.5333; val_masked_gp_l1_reg_loss: 109327.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68285.7188; val_chrom_access_recon_loss: 834830.4083; val_global_loss: 20607576.2667; val_optim_loss: 20607576.2667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9593; val_auprc_score: 0.9460; val_best_acc_score: 0.9116; val_best_f1_score: 0.9160; train_kl_reg_loss: 53238.0434; train_edge_recon_loss: 574895.2276; train_gene_expr_recon_loss: 18521397.6641; train_masked_gp_l1_reg_loss: 110005.2216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67887.5426; train_chrom_access_recon_loss: 830740.7052; train_global_loss: 20158164.3664; train_optim_loss: 20158164.3664; val_kl_reg_loss: 53520.1979; val_edge_recon_loss: 582034.1167; val_gene_expr_recon_loss: 18993489.6000; val_masked_gp_l1_reg_loss: 110852.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68802.1719; val_chrom_access_recon_loss: 831182.0333; val_global_loss: 20639880.0000; val_optim_loss: 20639880.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9358; val_auprc_score: 0.9222; val_best_acc_score: 0.8636; val_best_f1_score: 0.8710; train_kl_reg_loss: 38426.6884; train_edge_recon_loss: 680946.0048; train_gene_expr_recon_loss: 17611830.0458; train_masked_gp_l1_reg_loss: 107752.9570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61322.5187; train_chrom_access_recon_loss: 782889.0038; train_global_loss: 19283167.2672; train_optim_loss: 19283167.2672; val_kl_reg_loss: 18344.8848; val_edge_recon_loss: 641602.3375; val_gene_expr_recon_loss: 17716495.7333; val_masked_gp_l1_reg_loss: 105095.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60310.1250; val_chrom_access_recon_loss: 776501.0250; val_global_loss: 19318349.8667; val_optim_loss: 19318349.8667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9319; val_auprc_score: 0.9184; val_best_acc_score: 0.8607; val_best_f1_score: 0.8674; train_kl_reg_loss: 36616.0950; train_edge_recon_loss: 614135.7114; train_gene_expr_recon_loss: 17433073.7023; train_masked_gp_l1_reg_loss: 102420.2152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59144.5797; train_chrom_access_recon_loss: 777533.0110; train_global_loss: 19022923.1603; train_optim_loss: 19022923.1603; val_kl_reg_loss: 28181.4576; val_edge_recon_loss: 600010.1333; val_gene_expr_recon_loss: 17716193.6000; val_masked_gp_l1_reg_loss: 99963.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58837.7383; val_chrom_access_recon_loss: 777257.1958; val_global_loss: 19280444.5333; val_optim_loss: 19280444.5333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9320; val_auprc_score: 0.9134; val_best_acc_score: 0.8638; val_best_f1_score: 0.8716; train_kl_reg_loss: 38822.9037; train_edge_recon_loss: 592395.6617; train_gene_expr_recon_loss: 17378317.9084; train_masked_gp_l1_reg_loss: 97850.1405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58506.3904; train_chrom_access_recon_loss: 776352.3330; train_global_loss: 18942245.3130; train_optim_loss: 18942245.3130; val_kl_reg_loss: 34097.2832; val_edge_recon_loss: 587872.2833; val_gene_expr_recon_loss: 17640478.6667; val_masked_gp_l1_reg_loss: 95945.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58349.0391; val_chrom_access_recon_loss: 773101.9125; val_global_loss: 19189846.1333; val_optim_loss: 19189846.1333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9334; val_auprc_score: 0.9157; val_best_acc_score: 0.8676; val_best_f1_score: 0.8748; train_kl_reg_loss: 40198.4993; train_edge_recon_loss: 585907.9332; train_gene_expr_recon_loss: 17353816.8168; train_masked_gp_l1_reg_loss: 94418.1715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58102.0236; train_chrom_access_recon_loss: 776109.5153; train_global_loss: 18908553.0840; train_optim_loss: 18908553.0840; val_kl_reg_loss: 35453.0253; val_edge_recon_loss: 589109.1958; val_gene_expr_recon_loss: 17630747.0667; val_masked_gp_l1_reg_loss: 93161.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58216.9375; val_chrom_access_recon_loss: 772719.7333; val_global_loss: 19179407.3333; val_optim_loss: 19179407.3333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9441; val_auprc_score: 0.9278; val_best_acc_score: 0.8782; val_best_f1_score: 0.8828; train_kl_reg_loss: 40549.7177; train_edge_recon_loss: 583287.3125; train_gene_expr_recon_loss: 17310896.0305; train_masked_gp_l1_reg_loss: 92103.6112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58027.1876; train_chrom_access_recon_loss: 773871.4361; train_global_loss: 18858735.2824; train_optim_loss: 18858735.2824; val_kl_reg_loss: 36227.2336; val_edge_recon_loss: 583963.4083; val_gene_expr_recon_loss: 17598548.5333; val_masked_gp_l1_reg_loss: 91074.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57631.7422; val_chrom_access_recon_loss: 770814.8000; val_global_loss: 19138260.1333; val_optim_loss: 19138260.1333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9443; val_auprc_score: 0.9316; val_best_acc_score: 0.8810; val_best_f1_score: 0.8856; train_kl_reg_loss: 41290.1857; train_edge_recon_loss: 579409.5797; train_gene_expr_recon_loss: 17278259.6336; train_masked_gp_l1_reg_loss: 90393.3443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57638.2996; train_chrom_access_recon_loss: 774574.6269; train_global_loss: 18821565.6947; train_optim_loss: 18821565.6947; val_kl_reg_loss: 37828.1456; val_edge_recon_loss: 577912.6333; val_gene_expr_recon_loss: 17553641.3333; val_masked_gp_l1_reg_loss: 89628.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57499.7305; val_chrom_access_recon_loss: 769640.1500; val_global_loss: 19086150.4000; val_optim_loss: 19086150.4000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9448; val_auprc_score: 0.9303; val_best_acc_score: 0.8809; val_best_f1_score: 0.8860; train_kl_reg_loss: 41337.3514; train_edge_recon_loss: 578100.7901; train_gene_expr_recon_loss: 17241969.5344; train_masked_gp_l1_reg_loss: 89133.1711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57565.9132; train_chrom_access_recon_loss: 772749.8511; train_global_loss: 18780856.6412; train_optim_loss: 18780856.6412; val_kl_reg_loss: 39133.9740; val_edge_recon_loss: 580896.0125; val_gene_expr_recon_loss: 17541921.4667; val_masked_gp_l1_reg_loss: 88771.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57192.8633; val_chrom_access_recon_loss: 772731.0167; val_global_loss: 19080646.1333; val_optim_loss: 19080646.1333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9508; val_auprc_score: 0.9386; val_best_acc_score: 0.8882; val_best_f1_score: 0.8928; train_kl_reg_loss: 41588.9641; train_edge_recon_loss: 575968.2872; train_gene_expr_recon_loss: 17202995.1450; train_masked_gp_l1_reg_loss: 88333.6651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57509.9352; train_chrom_access_recon_loss: 771860.9251; train_global_loss: 18738256.8855; train_optim_loss: 18738256.8855; val_kl_reg_loss: 38548.9414; val_edge_recon_loss: 576341.5833; val_gene_expr_recon_loss: 17583664.1333; val_masked_gp_l1_reg_loss: 88079.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57435.1914; val_chrom_access_recon_loss: 773697.2250; val_global_loss: 19117768.2667; val_optim_loss: 19117768.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9533; val_auprc_score: 0.9414; val_best_acc_score: 0.8926; val_best_f1_score: 0.8970; train_kl_reg_loss: 41372.9811; train_edge_recon_loss: 575653.4652; train_gene_expr_recon_loss: 17182711.2366; train_masked_gp_l1_reg_loss: 87862.1315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57520.9409; train_chrom_access_recon_loss: 772540.7347; train_global_loss: 18717661.4656; train_optim_loss: 18717661.4656; val_kl_reg_loss: 38687.6060; val_edge_recon_loss: 574353.1375; val_gene_expr_recon_loss: 17487920.0000; val_masked_gp_l1_reg_loss: 87736.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57684.4492; val_chrom_access_recon_loss: 773644.6292; val_global_loss: 19020025.4667; val_optim_loss: 19020025.4667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9500; val_auprc_score: 0.9367; val_best_acc_score: 0.8891; val_best_f1_score: 0.8935; train_kl_reg_loss: 41593.1726; train_edge_recon_loss: 573189.2018; train_gene_expr_recon_loss: 17180941.5954; train_masked_gp_l1_reg_loss: 87620.0589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57529.1696; train_chrom_access_recon_loss: 772699.9938; train_global_loss: 18713573.1908; train_optim_loss: 18713573.1908; val_kl_reg_loss: 39384.0031; val_edge_recon_loss: 577004.2667; val_gene_expr_recon_loss: 17597361.1333; val_masked_gp_l1_reg_loss: 87508.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57273.1211; val_chrom_access_recon_loss: 780161.5125; val_global_loss: 19138693.2000; val_optim_loss: 19138693.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9503; val_auprc_score: 0.9356; val_best_acc_score: 0.8852; val_best_f1_score: 0.8908; train_kl_reg_loss: 40020.7458; train_edge_recon_loss: 576799.8946; train_gene_expr_recon_loss: 17179385.8015; train_masked_gp_l1_reg_loss: 87147.4642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57304.9532; train_chrom_access_recon_loss: 770660.3192; train_global_loss: 18711319.2672; train_optim_loss: 18711319.2672; val_kl_reg_loss: 38748.0776; val_edge_recon_loss: 581335.0750; val_gene_expr_recon_loss: 17551757.0000; val_masked_gp_l1_reg_loss: 86415.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57521.7852; val_chrom_access_recon_loss: 774195.5792; val_global_loss: 19089973.4667; val_optim_loss: 19089973.4667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9557; val_auprc_score: 0.9425; val_best_acc_score: 0.8979; val_best_f1_score: 0.9015; train_kl_reg_loss: 42415.4739; train_edge_recon_loss: 573226.6966; train_gene_expr_recon_loss: 17148538.3969; train_masked_gp_l1_reg_loss: 85846.7518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56978.2654; train_chrom_access_recon_loss: 770904.3936; train_global_loss: 18677909.9237; train_optim_loss: 18677909.9237; val_kl_reg_loss: 39787.5466; val_edge_recon_loss: 574936.4750; val_gene_expr_recon_loss: 17499833.8667; val_masked_gp_l1_reg_loss: 85452.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57218.4453; val_chrom_access_recon_loss: 771639.7917; val_global_loss: 19028867.6000; val_optim_loss: 19028867.6000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9550; val_auprc_score: 0.9439; val_best_acc_score: 0.8973; val_best_f1_score: 0.9023; train_kl_reg_loss: 43538.0658; train_edge_recon_loss: 577035.5549; train_gene_expr_recon_loss: 17185509.4275; train_masked_gp_l1_reg_loss: 84729.0543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56445.9219; train_chrom_access_recon_loss: 770874.3402; train_global_loss: 18718132.3206; train_optim_loss: 18718132.3206; val_kl_reg_loss: 32461.6349; val_edge_recon_loss: 595035.7875; val_gene_expr_recon_loss: 17518322.8000; val_masked_gp_l1_reg_loss: 83179.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55648.9258; val_chrom_access_recon_loss: 770465.6125; val_global_loss: 19055113.7333; val_optim_loss: 19055113.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9476; val_auprc_score: 0.9308; val_best_acc_score: 0.8890; val_best_f1_score: 0.8935; train_kl_reg_loss: 39253.5660; train_edge_recon_loss: 588643.8946; train_gene_expr_recon_loss: 17169445.3588; train_masked_gp_l1_reg_loss: 81016.4640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46541.2172; train_chrom_access_recon_loss: 769101.5234; train_global_loss: 18694001.9389; train_optim_loss: 18694001.9389; val_kl_reg_loss: 36451.3049; val_edge_recon_loss: 589505.2083; val_gene_expr_recon_loss: 17491330.6000; val_masked_gp_l1_reg_loss: 80343.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44806.8867; val_chrom_access_recon_loss: 773402.0875; val_global_loss: 19015839.2000; val_optim_loss: 19015839.2000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9462; val_auprc_score: 0.9295; val_best_acc_score: 0.8847; val_best_f1_score: 0.8900; train_kl_reg_loss: 41360.7539; train_edge_recon_loss: 583390.6803; train_gene_expr_recon_loss: 17114199.4656; train_masked_gp_l1_reg_loss: 80154.2931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44303.3089; train_chrom_access_recon_loss: 768556.6040; train_global_loss: 18631964.9695; train_optim_loss: 18631964.9695; val_kl_reg_loss: 39181.1672; val_edge_recon_loss: 584068.8667; val_gene_expr_recon_loss: 17483170.4000; val_masked_gp_l1_reg_loss: 79959.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43829.3164; val_chrom_access_recon_loss: 766154.3042; val_global_loss: 18996364.4000; val_optim_loss: 18996364.4000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9475; val_auprc_score: 0.9350; val_best_acc_score: 0.8831; val_best_f1_score: 0.8883; train_kl_reg_loss: 43410.7045; train_edge_recon_loss: 578227.4156; train_gene_expr_recon_loss: 17135189.5954; train_masked_gp_l1_reg_loss: 79832.2852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43550.5595; train_chrom_access_recon_loss: 769355.2705; train_global_loss: 18649565.8550; train_optim_loss: 18649565.8550; val_kl_reg_loss: 40741.8599; val_edge_recon_loss: 586277.8417; val_gene_expr_recon_loss: 17490886.0000; val_masked_gp_l1_reg_loss: 79728.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43250.2305; val_chrom_access_recon_loss: 768102.0792; val_global_loss: 19008985.3333; val_optim_loss: 19008985.3333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9480; val_auprc_score: 0.9328; val_best_acc_score: 0.8867; val_best_f1_score: 0.8930; train_kl_reg_loss: 44479.3327; train_edge_recon_loss: 575963.9265; train_gene_expr_recon_loss: 17111806.4733; train_masked_gp_l1_reg_loss: 79628.2497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43003.1360; train_chrom_access_recon_loss: 769341.5868; train_global_loss: 18624222.7328; train_optim_loss: 18624222.7328; val_kl_reg_loss: 42011.9630; val_edge_recon_loss: 579286.5792; val_gene_expr_recon_loss: 17475151.2000; val_masked_gp_l1_reg_loss: 79548.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42851.3828; val_chrom_access_recon_loss: 770039.0833; val_global_loss: 18988888.8000; val_optim_loss: 18988888.8000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9506; val_auprc_score: 0.9345; val_best_acc_score: 0.8878; val_best_f1_score: 0.8924; train_kl_reg_loss: 45418.9441; train_edge_recon_loss: 575604.0253; train_gene_expr_recon_loss: 17112672.1908; train_masked_gp_l1_reg_loss: 79476.5818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42631.6377; train_chrom_access_recon_loss: 768433.6064; train_global_loss: 18624237.1145; train_optim_loss: 18624237.1145; val_kl_reg_loss: 42783.3214; val_edge_recon_loss: 576455.0375; val_gene_expr_recon_loss: 17527972.8667; val_masked_gp_l1_reg_loss: 79376.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42457.2930; val_chrom_access_recon_loss: 771737.5458; val_global_loss: 19040782.9333; val_optim_loss: 19040782.9333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9519; val_auprc_score: 0.9374; val_best_acc_score: 0.8876; val_best_f1_score: 0.8938; train_kl_reg_loss: 46266.0860; train_edge_recon_loss: 574713.3626; train_gene_expr_recon_loss: 17100229.9389; train_masked_gp_l1_reg_loss: 79323.9717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42288.8961; train_chrom_access_recon_loss: 768622.3616; train_global_loss: 18611444.6107; train_optim_loss: 18611444.6107; val_kl_reg_loss: 43092.7940; val_edge_recon_loss: 575484.3958; val_gene_expr_recon_loss: 17413131.8000; val_masked_gp_l1_reg_loss: 79247.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42114.8672; val_chrom_access_recon_loss: 766796.6250; val_global_loss: 18919868.0000; val_optim_loss: 18919868.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9499; val_auprc_score: 0.9359; val_best_acc_score: 0.8906; val_best_f1_score: 0.8948; train_kl_reg_loss: 46675.1203; train_edge_recon_loss: 573884.8526; train_gene_expr_recon_loss: 17108197.9924; train_masked_gp_l1_reg_loss: 79213.9161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41960.6039; train_chrom_access_recon_loss: 769021.4518; train_global_loss: 18618953.8779; train_optim_loss: 18618953.8779; val_kl_reg_loss: 43810.1180; val_edge_recon_loss: 578926.4458; val_gene_expr_recon_loss: 17530490.9333; val_masked_gp_l1_reg_loss: 79158.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41806.6602; val_chrom_access_recon_loss: 775133.6292; val_global_loss: 19049325.2000; val_optim_loss: 19049325.2000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9547; val_auprc_score: 0.9419; val_best_acc_score: 0.8952; val_best_f1_score: 0.8991; train_kl_reg_loss: 46914.7989; train_edge_recon_loss: 572293.5553; train_gene_expr_recon_loss: 17092978.5802; train_masked_gp_l1_reg_loss: 79108.2080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41709.9188; train_chrom_access_recon_loss: 768232.9194; train_global_loss: 18601238.0153; train_optim_loss: 18601238.0153; val_kl_reg_loss: 44124.0495; val_edge_recon_loss: 572359.7792; val_gene_expr_recon_loss: 17484449.6667; val_masked_gp_l1_reg_loss: 79056.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41544.3750; val_chrom_access_recon_loss: 772924.0667; val_global_loss: 18994457.6000; val_optim_loss: 18994457.6000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9521; val_auprc_score: 0.9366; val_best_acc_score: 0.8918; val_best_f1_score: 0.8963; train_kl_reg_loss: 47239.3821; train_edge_recon_loss: 572502.1498; train_gene_expr_recon_loss: 17092212.5267; train_masked_gp_l1_reg_loss: 79015.8307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41495.7068; train_chrom_access_recon_loss: 769035.6589; train_global_loss: 18601501.2214; train_optim_loss: 18601501.2214; val_kl_reg_loss: 44121.9857; val_edge_recon_loss: 574458.8417; val_gene_expr_recon_loss: 17420768.5333; val_masked_gp_l1_reg_loss: 78977.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41368.0977; val_chrom_access_recon_loss: 768351.9042; val_global_loss: 18928047.3333; val_optim_loss: 18928047.3333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9533; val_auprc_score: 0.9382; val_best_acc_score: 0.8964; val_best_f1_score: 0.9004; train_kl_reg_loss: 47375.7761; train_edge_recon_loss: 573049.9227; train_gene_expr_recon_loss: 17085915.9466; train_masked_gp_l1_reg_loss: 78928.9778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41317.1290; train_chrom_access_recon_loss: 767881.7586; train_global_loss: 18594469.6336; train_optim_loss: 18594469.6336; val_kl_reg_loss: 44722.6078; val_edge_recon_loss: 575308.1125; val_gene_expr_recon_loss: 17444383.8667; val_masked_gp_l1_reg_loss: 78914.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41186.3984; val_chrom_access_recon_loss: 767356.9458; val_global_loss: 18951871.7333; val_optim_loss: 18951871.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9510; val_auprc_score: 0.9369; val_best_acc_score: 0.8933; val_best_f1_score: 0.8990; train_kl_reg_loss: 47389.2793; train_edge_recon_loss: 573550.7882; train_gene_expr_recon_loss: 17092715.2748; train_masked_gp_l1_reg_loss: 78693.2248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40280.4741; train_chrom_access_recon_loss: 768572.5821; train_global_loss: 18601201.6183; train_optim_loss: 18601201.6183; val_kl_reg_loss: 44349.5294; val_edge_recon_loss: 575006.7292; val_gene_expr_recon_loss: 17406914.7333; val_masked_gp_l1_reg_loss: 78607.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40143.2422; val_chrom_access_recon_loss: 766591.1917; val_global_loss: 18911614.5333; val_optim_loss: 18911614.5333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9543; val_auprc_score: 0.9406; val_best_acc_score: 0.8991; val_best_f1_score: 0.9038; train_kl_reg_loss: 47376.7714; train_edge_recon_loss: 573477.5673; train_gene_expr_recon_loss: 17078466.2214; train_masked_gp_l1_reg_loss: 78578.1846; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40100.1936; train_chrom_access_recon_loss: 768742.2781; train_global_loss: 18586741.2977; train_optim_loss: 18586741.2977; val_kl_reg_loss: 44610.0740; val_edge_recon_loss: 570464.9083; val_gene_expr_recon_loss: 17466187.2667; val_masked_gp_l1_reg_loss: 78553.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40058.9531; val_chrom_access_recon_loss: 769886.2667; val_global_loss: 18969760.5333; val_optim_loss: 18969760.5333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9490; val_auprc_score: 0.9320; val_best_acc_score: 0.8883; val_best_f1_score: 0.8938; train_kl_reg_loss: 47390.5361; train_edge_recon_loss: 572312.0844; train_gene_expr_recon_loss: 17080623.0382; train_masked_gp_l1_reg_loss: 78537.9074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40021.8312; train_chrom_access_recon_loss: 768505.7266; train_global_loss: 18587390.9924; train_optim_loss: 18587390.9924; val_kl_reg_loss: 44511.5492; val_edge_recon_loss: 576280.2792; val_gene_expr_recon_loss: 17430838.4000; val_masked_gp_l1_reg_loss: 78524.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39990.6016; val_chrom_access_recon_loss: 769625.8042; val_global_loss: 18939770.2667; val_optim_loss: 18939770.2667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9526; val_auprc_score: 0.9408; val_best_acc_score: 0.8917; val_best_f1_score: 0.8975; train_kl_reg_loss: 47331.2279; train_edge_recon_loss: 574283.8540; train_gene_expr_recon_loss: 17066560.8550; train_masked_gp_l1_reg_loss: 78514.8764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39962.0984; train_chrom_access_recon_loss: 767616.9313; train_global_loss: 18574269.8779; train_optim_loss: 18574269.8779; val_kl_reg_loss: 44404.8414; val_edge_recon_loss: 573414.4833; val_gene_expr_recon_loss: 17425331.0667; val_masked_gp_l1_reg_loss: 78505.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39933.6367; val_chrom_access_recon_loss: 770809.6250; val_global_loss: 18932400.2667; val_optim_loss: 18932400.2667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9514; val_auprc_score: 0.9369; val_best_acc_score: 0.8926; val_best_f1_score: 0.8976; train_kl_reg_loss: 47402.2835; train_edge_recon_loss: 572526.8755; train_gene_expr_recon_loss: 17076172.5725; train_masked_gp_l1_reg_loss: 78499.9984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39911.9237; train_chrom_access_recon_loss: 767888.0491; train_global_loss: 18582401.8321; train_optim_loss: 18582401.8321; val_kl_reg_loss: 44822.5060; val_edge_recon_loss: 577285.5333; val_gene_expr_recon_loss: 17515252.6667; val_masked_gp_l1_reg_loss: 78489.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39887.5039; val_chrom_access_recon_loss: 768225.4458; val_global_loss: 19023964.0000; val_optim_loss: 19023964.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9533; val_auprc_score: 0.9398; val_best_acc_score: 0.8918; val_best_f1_score: 0.8962; train_kl_reg_loss: 47427.4766; train_edge_recon_loss: 573037.8593; train_gene_expr_recon_loss: 17072579.2824; train_masked_gp_l1_reg_loss: 78468.9043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39798.0836; train_chrom_access_recon_loss: 767973.8760; train_global_loss: 18579285.6489; train_optim_loss: 18579285.6489; val_kl_reg_loss: 44422.8521; val_edge_recon_loss: 579615.4667; val_gene_expr_recon_loss: 17409261.3333; val_masked_gp_l1_reg_loss: 78461.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39785.6875; val_chrom_access_recon_loss: 764707.6375; val_global_loss: 18916255.2000; val_optim_loss: 18916255.2000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9521; val_auprc_score: 0.9377; val_best_acc_score: 0.8905; val_best_f1_score: 0.8958; train_kl_reg_loss: 47416.1568; train_edge_recon_loss: 572592.6689; train_gene_expr_recon_loss: 17073749.7481; train_masked_gp_l1_reg_loss: 78458.4504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39781.7279; train_chrom_access_recon_loss: 767937.3631; train_global_loss: 18579936.1374; train_optim_loss: 18579936.1374; val_kl_reg_loss: 44550.9565; val_edge_recon_loss: 577710.5500; val_gene_expr_recon_loss: 17456195.7333; val_masked_gp_l1_reg_loss: 78455.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39777.3555; val_chrom_access_recon_loss: 767479.9833; val_global_loss: 18964171.4667; val_optim_loss: 18964171.4667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9535; val_auprc_score: 0.9394; val_best_acc_score: 0.8922; val_best_f1_score: 0.8977; train_kl_reg_loss: 47393.0897; train_edge_recon_loss: 571091.6107; train_gene_expr_recon_loss: 17078329.2366; train_masked_gp_l1_reg_loss: 78453.5470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39773.9867; train_chrom_access_recon_loss: 768012.0840; train_global_loss: 18583053.6489; train_optim_loss: 18583053.6489; val_kl_reg_loss: 44441.9318; val_edge_recon_loss: 574180.5958; val_gene_expr_recon_loss: 17464844.3333; val_masked_gp_l1_reg_loss: 78451.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39770.5000; val_chrom_access_recon_loss: 771873.4708; val_global_loss: 18973562.1333; val_optim_loss: 18973562.1333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9542; val_auprc_score: 0.9433; val_best_acc_score: 0.8933; val_best_f1_score: 0.8976; train_kl_reg_loss: 47491.1124; train_edge_recon_loss: 571783.2805; train_gene_expr_recon_loss: 17084926.0382; train_masked_gp_l1_reg_loss: 78450.3733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39767.4222; train_chrom_access_recon_loss: 768029.1112; train_global_loss: 18590447.1908; train_optim_loss: 18590447.1908; val_kl_reg_loss: 44525.6844; val_edge_recon_loss: 577176.7083; val_gene_expr_recon_loss: 17444882.2667; val_masked_gp_l1_reg_loss: 78448.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39764.2695; val_chrom_access_recon_loss: 768420.8083; val_global_loss: 18953217.7333; val_optim_loss: 18953217.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 27 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9514
val AUPRC score: 0.9394
val best accuracy score: 0.8863
val best F1 score: 0.8910
val target rna MSE score: 1.4233
val source rna MSE score: 0.5552
val target atac MSE score: 0.5013
val source atac MSE score: 0.1531
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
