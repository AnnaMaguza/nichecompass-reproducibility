[True]
Run timestamp: 07082023_215552_146.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_146']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8914; val_auprc_score: 0.9049; val_best_acc_score: 0.5451; val_best_f1_score: 0.6864; train_kl_reg_loss: 20136.1144; train_edge_recon_loss: 3473818.5278; train_gene_expr_recon_loss: 1204699.0278; train_masked_gp_l1_reg_loss: 4571.4073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119225.4036; train_chrom_access_recon_loss: 742607.3507; train_global_loss: 5565057.7778; train_optim_loss: 5565057.7778; val_kl_reg_loss: 7256.4854; val_edge_recon_loss: 4061956.0000; val_gene_expr_recon_loss: 1128403.0000; val_masked_gp_l1_reg_loss: 4101.2212; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116919.0625; val_chrom_access_recon_loss: 527344.6250; val_global_loss: 5845980.0000; val_optim_loss: 5845980.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9046; val_auprc_score: 0.9188; val_best_acc_score: 0.5329; val_best_f1_score: 0.6808; train_kl_reg_loss: 4729.4392; train_edge_recon_loss: 3470538.6944; train_gene_expr_recon_loss: 1041436.2847; train_masked_gp_l1_reg_loss: 3980.4197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115460.0859; train_chrom_access_recon_loss: 500897.5625; train_global_loss: 5137042.5556; train_optim_loss: 5137042.5556; val_kl_reg_loss: 5178.4229; val_edge_recon_loss: 4062659.2500; val_gene_expr_recon_loss: 972385.3125; val_masked_gp_l1_reg_loss: 3908.1230; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113704.2812; val_chrom_access_recon_loss: 490266.9375; val_global_loss: 5648102.5000; val_optim_loss: 5648102.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8960; val_auprc_score: 0.9051; val_best_acc_score: 0.5190; val_best_f1_score: 0.6748; train_kl_reg_loss: 9931.2590; train_edge_recon_loss: 3474647.5833; train_gene_expr_recon_loss: 913893.4444; train_masked_gp_l1_reg_loss: 3948.0437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112318.4184; train_chrom_access_recon_loss: 484797.1458; train_global_loss: 4999535.9444; train_optim_loss: 4999535.9444; val_kl_reg_loss: 12169.8779; val_edge_recon_loss: 4063936.5000; val_gene_expr_recon_loss: 872316.8750; val_masked_gp_l1_reg_loss: 4010.2795; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110548.6406; val_chrom_access_recon_loss: 481065.0000; val_global_loss: 5544047.5000; val_optim_loss: 5544047.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8766; val_auprc_score: 0.8910; val_best_acc_score: 0.5375; val_best_f1_score: 0.6817; train_kl_reg_loss: 13680.6284; train_edge_recon_loss: 3477787.0833; train_gene_expr_recon_loss: 845349.7917; train_masked_gp_l1_reg_loss: 4044.8812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109031.7031; train_chrom_access_recon_loss: 471416.4549; train_global_loss: 4921310.6667; train_optim_loss: 4921310.6667; val_kl_reg_loss: 13850.8047; val_edge_recon_loss: 4062063.7500; val_gene_expr_recon_loss: 819744.3125; val_masked_gp_l1_reg_loss: 4075.1885; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107055.2812; val_chrom_access_recon_loss: 465622.2188; val_global_loss: 5472411.5000; val_optim_loss: 5472411.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8629; val_auprc_score: 0.8759; val_best_acc_score: 0.5426; val_best_f1_score: 0.6827; train_kl_reg_loss: 17055.7875; train_edge_recon_loss: 3477703.1111; train_gene_expr_recon_loss: 797458.3403; train_masked_gp_l1_reg_loss: 4100.8302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105340.1936; train_chrom_access_recon_loss: 460865.7708; train_global_loss: 4862524.1111; train_optim_loss: 4862524.1111; val_kl_reg_loss: 15030.3457; val_edge_recon_loss: 4059926.2500; val_gene_expr_recon_loss: 783059.7500; val_masked_gp_l1_reg_loss: 4131.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103112.6094; val_chrom_access_recon_loss: 458534.1250; val_global_loss: 5423794.0000; val_optim_loss: 5423794.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8542; val_auprc_score: 0.8655; val_best_acc_score: 0.5786; val_best_f1_score: 0.6968; train_kl_reg_loss: 16936.2696; train_edge_recon_loss: 3478037.6389; train_gene_expr_recon_loss: 762967.3542; train_masked_gp_l1_reg_loss: 4163.9718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101229.4401; train_chrom_access_recon_loss: 452241.7882; train_global_loss: 4815576.3333; train_optim_loss: 4815576.3333; val_kl_reg_loss: 18257.1777; val_edge_recon_loss: 4053028.5000; val_gene_expr_recon_loss: 758379.2500; val_masked_gp_l1_reg_loss: 4201.8130; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98835.0625; val_chrom_access_recon_loss: 454767.2812; val_global_loss: 5387469.5000; val_optim_loss: 5387469.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8340; val_auprc_score: 0.8315; val_best_acc_score: 0.6700; val_best_f1_score: 0.7387; train_kl_reg_loss: 17713.1196; train_edge_recon_loss: 3478091.2222; train_gene_expr_recon_loss: 746270.2361; train_masked_gp_l1_reg_loss: 4231.5139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96869.7717; train_chrom_access_recon_loss: 450733.1771; train_global_loss: 4793909.0556; train_optim_loss: 4793909.0556; val_kl_reg_loss: 17131.0273; val_edge_recon_loss: 4030870.5000; val_gene_expr_recon_loss: 742881.9375; val_masked_gp_l1_reg_loss: 4266.8965; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94399.4141; val_chrom_access_recon_loss: 452149.4688; val_global_loss: 5341699.5000; val_optim_loss: 5341699.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8149; val_auprc_score: 0.8109; val_best_acc_score: 0.7261; val_best_f1_score: 0.7479; train_kl_reg_loss: 16312.3950; train_edge_recon_loss: 3470685.8333; train_gene_expr_recon_loss: 734502.5347; train_masked_gp_l1_reg_loss: 4307.7368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92415.7578; train_chrom_access_recon_loss: 447779.3924; train_global_loss: 4766003.7778; train_optim_loss: 4766003.7778; val_kl_reg_loss: 13186.1611; val_edge_recon_loss: 3929535.7500; val_gene_expr_recon_loss: 736705.3125; val_masked_gp_l1_reg_loss: 4354.1846; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89940.9219; val_chrom_access_recon_loss: 450994.8125; val_global_loss: 5224717.5000; val_optim_loss: 5224717.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8014; val_auprc_score: 0.7847; val_best_acc_score: 0.7231; val_best_f1_score: 0.7630; train_kl_reg_loss: 11454.4262; train_edge_recon_loss: 3422092.3333; train_gene_expr_recon_loss: 735866.1875; train_masked_gp_l1_reg_loss: 4415.6201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87993.2309; train_chrom_access_recon_loss: 450742.0590; train_global_loss: 4712563.8333; train_optim_loss: 4712563.8333; val_kl_reg_loss: 7207.5107; val_edge_recon_loss: 3516973.0000; val_gene_expr_recon_loss: 753520.0000; val_masked_gp_l1_reg_loss: 4519.0503; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85586.6016; val_chrom_access_recon_loss: 451941.2500; val_global_loss: 4819747.0000; val_optim_loss: 4819747.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8207; val_auprc_score: 0.8142; val_best_acc_score: 0.7238; val_best_f1_score: 0.7608; train_kl_reg_loss: 10999.2124; train_edge_recon_loss: 3163152.4167; train_gene_expr_recon_loss: 768617.6042; train_masked_gp_l1_reg_loss: 4651.6529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83747.1059; train_chrom_access_recon_loss: 453830.4583; train_global_loss: 4484998.3333; train_optim_loss: 4484998.3333; val_kl_reg_loss: 18797.2773; val_edge_recon_loss: 3057604.5000; val_gene_expr_recon_loss: 788134.3750; val_masked_gp_l1_reg_loss: 4815.1323; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81510.7344; val_chrom_access_recon_loss: 454994.2500; val_global_loss: 4405856.0000; val_optim_loss: 4405856.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8526; val_auprc_score: 0.8471; val_best_acc_score: 0.7485; val_best_f1_score: 0.7812; train_kl_reg_loss: 28295.1252; train_edge_recon_loss: 2964921.6111; train_gene_expr_recon_loss: 779586.9306; train_masked_gp_l1_reg_loss: 4879.3489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79783.6849; train_chrom_access_recon_loss: 452705.9062; train_global_loss: 4310172.7222; train_optim_loss: 4310172.7222; val_kl_reg_loss: 33443.1250; val_edge_recon_loss: 2927406.5000; val_gene_expr_recon_loss: 776946.1875; val_masked_gp_l1_reg_loss: 4931.6299; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77644.8594; val_chrom_access_recon_loss: 451941.5625; val_global_loss: 4272314.0000; val_optim_loss: 4272314.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8836; val_auprc_score: 0.8718; val_best_acc_score: 0.7984; val_best_f1_score: 0.8056; train_kl_reg_loss: 36561.4709; train_edge_recon_loss: 2890798.3056; train_gene_expr_recon_loss: 759840.2778; train_masked_gp_l1_reg_loss: 4949.6263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75969.1155; train_chrom_access_recon_loss: 450367.6979; train_global_loss: 4218486.5278; train_optim_loss: 4218486.5278; val_kl_reg_loss: 35013.9141; val_edge_recon_loss: 2885705.7500; val_gene_expr_recon_loss: 760287.6250; val_masked_gp_l1_reg_loss: 4956.5332; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73900.0859; val_chrom_access_recon_loss: 450789.0625; val_global_loss: 4210653.0000; val_optim_loss: 4210653.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9223; val_auprc_score: 0.8975; val_best_acc_score: 0.8604; val_best_f1_score: 0.8708; train_kl_reg_loss: 35220.1962; train_edge_recon_loss: 2798634.8056; train_gene_expr_recon_loss: 755732.5000; train_masked_gp_l1_reg_loss: 4962.7080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72291.7865; train_chrom_access_recon_loss: 448347.3681; train_global_loss: 4115189.3889; train_optim_loss: 4115189.3889; val_kl_reg_loss: 31014.3340; val_edge_recon_loss: 2760454.7500; val_gene_expr_recon_loss: 769963.8750; val_masked_gp_l1_reg_loss: 4977.2949; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70317.4297; val_chrom_access_recon_loss: 450455.8125; val_global_loss: 4087183.5000; val_optim_loss: 4087183.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9293; val_auprc_score: 0.9050; val_best_acc_score: 0.8700; val_best_f1_score: 0.8776; train_kl_reg_loss: 33460.3134; train_edge_recon_loss: 2741269.8889; train_gene_expr_recon_loss: 756657.4028; train_masked_gp_l1_reg_loss: 4996.2043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68798.5868; train_chrom_access_recon_loss: 447059.9896; train_global_loss: 4052242.4444; train_optim_loss: 4052242.4444; val_kl_reg_loss: 34401.5547; val_edge_recon_loss: 2740939.0000; val_gene_expr_recon_loss: 755256.8750; val_masked_gp_l1_reg_loss: 5019.6387; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66922.1797; val_chrom_access_recon_loss: 448435.4062; val_global_loss: 4050975.0000; val_optim_loss: 4050975.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9350; val_auprc_score: 0.9127; val_best_acc_score: 0.8735; val_best_f1_score: 0.8822; train_kl_reg_loss: 37791.4310; train_edge_recon_loss: 2730940.7500; train_gene_expr_recon_loss: 736692.7222; train_masked_gp_l1_reg_loss: 5024.5029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65461.3924; train_chrom_access_recon_loss: 445826.0938; train_global_loss: 4021736.9444; train_optim_loss: 4021736.9444; val_kl_reg_loss: 38768.0430; val_edge_recon_loss: 2731998.5000; val_gene_expr_recon_loss: 740849.6250; val_masked_gp_l1_reg_loss: 5017.3823; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63652.0312; val_chrom_access_recon_loss: 446964.4375; val_global_loss: 4027250.0000; val_optim_loss: 4027250.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9338; val_auprc_score: 0.9100; val_best_acc_score: 0.8795; val_best_f1_score: 0.8874; train_kl_reg_loss: 39727.6302; train_edge_recon_loss: 2727963.3333; train_gene_expr_recon_loss: 727185.3125; train_masked_gp_l1_reg_loss: 5018.3068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62244.6285; train_chrom_access_recon_loss: 444846.7431; train_global_loss: 4006985.9722; train_optim_loss: 4006985.9722; val_kl_reg_loss: 36925.4180; val_edge_recon_loss: 2736566.0000; val_gene_expr_recon_loss: 735100.1875; val_masked_gp_l1_reg_loss: 5017.7124; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60511.9062; val_chrom_access_recon_loss: 445810.1562; val_global_loss: 4019931.7500; val_optim_loss: 4019931.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9352; val_auprc_score: 0.9106; val_best_acc_score: 0.8791; val_best_f1_score: 0.8876; train_kl_reg_loss: 37213.0668; train_edge_recon_loss: 2720237.6111; train_gene_expr_recon_loss: 726144.5000; train_masked_gp_l1_reg_loss: 5021.0338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59185.1055; train_chrom_access_recon_loss: 442432.9410; train_global_loss: 3990234.3056; train_optim_loss: 3990234.3056; val_kl_reg_loss: 35333.5781; val_edge_recon_loss: 2735065.0000; val_gene_expr_recon_loss: 729692.8750; val_masked_gp_l1_reg_loss: 5021.7915; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57572.7930; val_chrom_access_recon_loss: 444782.2812; val_global_loss: 4007468.2500; val_optim_loss: 4007468.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9368; val_auprc_score: 0.9095; val_best_acc_score: 0.8849; val_best_f1_score: 0.8929; train_kl_reg_loss: 36768.9484; train_edge_recon_loss: 2723812.9444; train_gene_expr_recon_loss: 717956.5417; train_masked_gp_l1_reg_loss: 5029.6081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56351.2248; train_chrom_access_recon_loss: 443787.4028; train_global_loss: 3983706.6667; train_optim_loss: 3983706.6667; val_kl_reg_loss: 35318.6719; val_edge_recon_loss: 2722717.0000; val_gene_expr_recon_loss: 727351.1250; val_masked_gp_l1_reg_loss: 5037.4712; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54854.8633; val_chrom_access_recon_loss: 444080.3750; val_global_loss: 3989359.5000; val_optim_loss: 3989359.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9425; val_auprc_score: 0.9243; val_best_acc_score: 0.8849; val_best_f1_score: 0.8912; train_kl_reg_loss: 36348.4201; train_edge_recon_loss: 2723824.9167; train_gene_expr_recon_loss: 713693.4028; train_masked_gp_l1_reg_loss: 5050.5368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53719.7665; train_chrom_access_recon_loss: 440685.5868; train_global_loss: 3973322.6944; train_optim_loss: 3973322.6944; val_kl_reg_loss: 34841.7656; val_edge_recon_loss: 2745984.2500; val_gene_expr_recon_loss: 722437.7500; val_masked_gp_l1_reg_loss: 5061.8218; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52332.8594; val_chrom_access_recon_loss: 443301.4062; val_global_loss: 4003959.7500; val_optim_loss: 4003959.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9479; val_auprc_score: 0.9236; val_best_acc_score: 0.8965; val_best_f1_score: 0.9011; train_kl_reg_loss: 35846.4926; train_edge_recon_loss: 2718540.2500; train_gene_expr_recon_loss: 712137.2361; train_masked_gp_l1_reg_loss: 5075.5601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51273.7873; train_chrom_access_recon_loss: 440410.8889; train_global_loss: 3963284.1667; train_optim_loss: 3963284.1667; val_kl_reg_loss: 34520.3945; val_edge_recon_loss: 2695139.7500; val_gene_expr_recon_loss: 719158.9375; val_masked_gp_l1_reg_loss: 5090.7974; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49976.6094; val_chrom_access_recon_loss: 442596.5312; val_global_loss: 3946483.0000; val_optim_loss: 3946483.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9485; val_auprc_score: 0.9300; val_best_acc_score: 0.8933; val_best_f1_score: 0.8997; train_kl_reg_loss: 35941.9831; train_edge_recon_loss: 2706449.4167; train_gene_expr_recon_loss: 707791.6319; train_masked_gp_l1_reg_loss: 5106.6149; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48989.3477; train_chrom_access_recon_loss: 438991.9583; train_global_loss: 3943270.9167; train_optim_loss: 3943270.9167; val_kl_reg_loss: 34963.7695; val_edge_recon_loss: 2711211.5000; val_gene_expr_recon_loss: 716039.9375; val_masked_gp_l1_reg_loss: 5123.5771; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47776.7539; val_chrom_access_recon_loss: 441831.9375; val_global_loss: 3956947.5000; val_optim_loss: 3956947.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9455; val_auprc_score: 0.9243; val_best_acc_score: 0.8898; val_best_f1_score: 0.8967; train_kl_reg_loss: 36387.1636; train_edge_recon_loss: 2711358.3611; train_gene_expr_recon_loss: 707077.4306; train_masked_gp_l1_reg_loss: 5138.1079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46852.0104; train_chrom_access_recon_loss: 439530.4722; train_global_loss: 3946343.5000; train_optim_loss: 3946343.5000; val_kl_reg_loss: 34978.8281; val_edge_recon_loss: 2727483.0000; val_gene_expr_recon_loss: 713175.8750; val_masked_gp_l1_reg_loss: 5155.4014; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45713.8086; val_chrom_access_recon_loss: 440898.5000; val_global_loss: 3967405.2500; val_optim_loss: 3967405.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9477; val_auprc_score: 0.9257; val_best_acc_score: 0.8950; val_best_f1_score: 0.9000; train_kl_reg_loss: 35639.3377; train_edge_recon_loss: 2705008.0000; train_gene_expr_recon_loss: 700823.2986; train_masked_gp_l1_reg_loss: 5175.6776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44854.5825; train_chrom_access_recon_loss: 437843.1840; train_global_loss: 3929344.0833; train_optim_loss: 3929344.0833; val_kl_reg_loss: 34151.3438; val_edge_recon_loss: 2717092.2500; val_gene_expr_recon_loss: 709493.8750; val_masked_gp_l1_reg_loss: 5194.1802; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43802.1016; val_chrom_access_recon_loss: 440282.0312; val_global_loss: 3950015.7500; val_optim_loss: 3950015.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9500; val_auprc_score: 0.9262; val_best_acc_score: 0.8994; val_best_f1_score: 0.9054; train_kl_reg_loss: 34865.3759; train_edge_recon_loss: 2702864.3889; train_gene_expr_recon_loss: 702453.2708; train_masked_gp_l1_reg_loss: 5217.8626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42990.3850; train_chrom_access_recon_loss: 438024.0903; train_global_loss: 3926415.3333; train_optim_loss: 3926415.3333; val_kl_reg_loss: 34206.7422; val_edge_recon_loss: 2710726.2500; val_gene_expr_recon_loss: 706814.0000; val_masked_gp_l1_reg_loss: 5239.2119; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41997.8125; val_chrom_access_recon_loss: 439871.9375; val_global_loss: 3938856.0000; val_optim_loss: 3938856.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9560; val_auprc_score: 0.9384; val_best_acc_score: 0.9012; val_best_f1_score: 0.9054; train_kl_reg_loss: 35187.0716; train_edge_recon_loss: 2708151.8611; train_gene_expr_recon_loss: 697240.9931; train_masked_gp_l1_reg_loss: 5258.5933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41240.5686; train_chrom_access_recon_loss: 436189.3681; train_global_loss: 3923268.4722; train_optim_loss: 3923268.4722; val_kl_reg_loss: 34445.4570; val_edge_recon_loss: 2721673.0000; val_gene_expr_recon_loss: 706241.3750; val_masked_gp_l1_reg_loss: 5273.7212; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40306.9844; val_chrom_access_recon_loss: 439150.0000; val_global_loss: 3947090.7500; val_optim_loss: 3947090.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9592; val_auprc_score: 0.9431; val_best_acc_score: 0.9076; val_best_f1_score: 0.9127; train_kl_reg_loss: 32497.2810; train_edge_recon_loss: 2701484.2500; train_gene_expr_recon_loss: 992628.5972; train_masked_gp_l1_reg_loss: 5314.4639; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39395.2348; train_chrom_access_recon_loss: 460608.9792; train_global_loss: 4231928.7222; train_optim_loss: 4231928.7222; val_kl_reg_loss: 16130.2793; val_edge_recon_loss: 2709341.0000; val_gene_expr_recon_loss: 1000724.3750; val_masked_gp_l1_reg_loss: 5364.0972; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38153.8047; val_chrom_access_recon_loss: 462917.4688; val_global_loss: 4232630.5000; val_optim_loss: 4232630.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9652; val_auprc_score: 0.9532; val_best_acc_score: 0.9138; val_best_f1_score: 0.9170; train_kl_reg_loss: 28193.4171; train_edge_recon_loss: 2696970.1389; train_gene_expr_recon_loss: 987715.9167; train_masked_gp_l1_reg_loss: 5411.2772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37099.6576; train_chrom_access_recon_loss: 460428.8333; train_global_loss: 4215819.3056; train_optim_loss: 4215819.3056; val_kl_reg_loss: 14556.9551; val_edge_recon_loss: 2685104.0000; val_gene_expr_recon_loss: 1005114.5000; val_masked_gp_l1_reg_loss: 5469.5527; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35787.2891; val_chrom_access_recon_loss: 463091.1250; val_global_loss: 4209123.5000; val_optim_loss: 4209123.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9664; val_auprc_score: 0.9540; val_best_acc_score: 0.9193; val_best_f1_score: 0.9235; train_kl_reg_loss: 25555.1595; train_edge_recon_loss: 2688053.3333; train_gene_expr_recon_loss: 991384.3264; train_masked_gp_l1_reg_loss: 5513.8955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34774.4592; train_chrom_access_recon_loss: 462778.3056; train_global_loss: 4208059.4444; train_optim_loss: 4208059.4444; val_kl_reg_loss: 14034.8438; val_edge_recon_loss: 2693804.0000; val_gene_expr_recon_loss: 997226.7500; val_masked_gp_l1_reg_loss: 5566.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33541.3008; val_chrom_access_recon_loss: 462320.6875; val_global_loss: 4206494.0000; val_optim_loss: 4206494.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9685; val_auprc_score: 0.9535; val_best_acc_score: 0.9233; val_best_f1_score: 0.9258; train_kl_reg_loss: 23803.3819; train_edge_recon_loss: 2690933.4167; train_gene_expr_recon_loss: 986096.2569; train_masked_gp_l1_reg_loss: 5560.2877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33406.6211; train_chrom_access_recon_loss: 462241.0799; train_global_loss: 4202041.0278; train_optim_loss: 4202041.0278; val_kl_reg_loss: 13732.4375; val_edge_recon_loss: 2687291.2500; val_gene_expr_recon_loss: 1000784.8750; val_masked_gp_l1_reg_loss: 5552.9009; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33241.3125; val_chrom_access_recon_loss: 462587.1250; val_global_loss: 4203190.0000; val_optim_loss: 4203190.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9667; val_auprc_score: 0.9502; val_best_acc_score: 0.9208; val_best_f1_score: 0.9247; train_kl_reg_loss: 23260.4714; train_edge_recon_loss: 2671063.2222; train_gene_expr_recon_loss: 992689.6944; train_masked_gp_l1_reg_loss: 5551.3586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33121.7504; train_chrom_access_recon_loss: 461967.5312; train_global_loss: 4187654.0833; train_optim_loss: 4187654.0833; val_kl_reg_loss: 13341.0879; val_edge_recon_loss: 2690782.5000; val_gene_expr_recon_loss: 999171.6875; val_masked_gp_l1_reg_loss: 5549.0503; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32971.6133; val_chrom_access_recon_loss: 462540.8125; val_global_loss: 4204356.5000; val_optim_loss: 4204356.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9663; val_auprc_score: 0.9537; val_best_acc_score: 0.9201; val_best_f1_score: 0.9237; train_kl_reg_loss: 22712.1013; train_edge_recon_loss: 2680457.2778; train_gene_expr_recon_loss: 989913.8264; train_masked_gp_l1_reg_loss: 5548.6090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32857.9301; train_chrom_access_recon_loss: 459763.1076; train_global_loss: 4191252.7778; train_optim_loss: 4191252.7778; val_kl_reg_loss: 13147.6504; val_edge_recon_loss: 2689476.2500; val_gene_expr_recon_loss: 999954.8125; val_masked_gp_l1_reg_loss: 5548.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32718.0742; val_chrom_access_recon_loss: 462557.1875; val_global_loss: 4203402.5000; val_optim_loss: 4203402.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9686; val_auprc_score: 0.9541; val_best_acc_score: 0.9209; val_best_f1_score: 0.9243; train_kl_reg_loss: 22236.7394; train_edge_recon_loss: 2673286.5000; train_gene_expr_recon_loss: 994257.5000; train_masked_gp_l1_reg_loss: 5549.4366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32610.9468; train_chrom_access_recon_loss: 461515.2535; train_global_loss: 4189456.3333; train_optim_loss: 4189456.3333; val_kl_reg_loss: 12830.6504; val_edge_recon_loss: 2681168.2500; val_gene_expr_recon_loss: 1000626.0000; val_masked_gp_l1_reg_loss: 5550.7417; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32481.6172; val_chrom_access_recon_loss: 462670.2500; val_global_loss: 4195327.5000; val_optim_loss: 4195327.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 22 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9534
val AUPRC score: 0.9338
val best accuracy score: 0.9008
val best F1 score: 0.9067
val target rna MSE score: 3.9508
val source rna MSE score: 3.2554
val target atac MSE score: 0.1385
val source atac MSE score: 0.0213
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
