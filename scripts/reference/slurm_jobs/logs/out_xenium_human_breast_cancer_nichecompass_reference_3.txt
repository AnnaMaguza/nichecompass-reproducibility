Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9749; val_auprc_score: 0.9835; val_best_acc_score: 0.9408; val_best_f1_score: 0.9561; train_kl_reg_loss: 9372.8784; train_edge_recon_loss: 1763825.2262; train_gene_expr_recon_loss: 1021602.7494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2794800.8520; train_optim_loss: 2794800.8520; val_kl_reg_loss: 9147.0946; val_edge_recon_loss: 1807741.7955; val_gene_expr_recon_loss: 1019284.9299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2836173.8106; val_optim_loss: 2836173.8106
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9739; val_auprc_score: 0.9824; val_best_acc_score: 0.9405; val_best_f1_score: 0.9559; train_kl_reg_loss: 9381.2104; train_edge_recon_loss: 1764433.4690; train_gene_expr_recon_loss: 1019513.2898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2793327.9694; train_optim_loss: 2793327.9694; val_kl_reg_loss: 9313.3190; val_edge_recon_loss: 1812302.3485; val_gene_expr_recon_loss: 1016618.4205; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2838234.0985; val_optim_loss: 2838234.0985
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9748; val_auprc_score: 0.9834; val_best_acc_score: 0.9411; val_best_f1_score: 0.9564; train_kl_reg_loss: 9362.9132; train_edge_recon_loss: 1761474.5944; train_gene_expr_recon_loss: 1017616.2079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2788453.7253; train_optim_loss: 2788453.7253; val_kl_reg_loss: 9234.8664; val_edge_recon_loss: 1797170.1439; val_gene_expr_recon_loss: 1014633.8239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2821038.8258; val_optim_loss: 2821038.8258
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9744; val_auprc_score: 0.9831; val_best_acc_score: 0.9412; val_best_f1_score: 0.9565; train_kl_reg_loss: 9360.4494; train_edge_recon_loss: 1764224.4515; train_gene_expr_recon_loss: 1016095.1558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2789680.0604; train_optim_loss: 2789680.0604; val_kl_reg_loss: 9206.2294; val_edge_recon_loss: 1798859.1667; val_gene_expr_recon_loss: 1013349.9186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2821415.3258; val_optim_loss: 2821415.3258
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9733; val_auprc_score: 0.9819; val_best_acc_score: 0.9404; val_best_f1_score: 0.9560; train_kl_reg_loss: 9341.2292; train_edge_recon_loss: 1764049.0068; train_gene_expr_recon_loss: 1014417.2389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2787807.4804; train_optim_loss: 2787807.4804; val_kl_reg_loss: 9162.0605; val_edge_recon_loss: 1798391.7538; val_gene_expr_recon_loss: 1012903.8011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2820457.6061; val_optim_loss: 2820457.6061
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9754; val_auprc_score: 0.9838; val_best_acc_score: 0.9422; val_best_f1_score: 0.9571; train_kl_reg_loss: 9328.2240; train_edge_recon_loss: 1763637.0412; train_gene_expr_recon_loss: 1013085.0963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2786050.3563; train_optim_loss: 2786050.3563; val_kl_reg_loss: 9232.6855; val_edge_recon_loss: 1801465.2008; val_gene_expr_recon_loss: 1011985.9318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2822683.8333; val_optim_loss: 2822683.8333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9753; val_auprc_score: 0.9834; val_best_acc_score: 0.9422; val_best_f1_score: 0.9571; train_kl_reg_loss: 9337.5351; train_edge_recon_loss: 1762288.8631; train_gene_expr_recon_loss: 1012229.8858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2783856.2832; train_optim_loss: 2783856.2832; val_kl_reg_loss: 9054.1586; val_edge_recon_loss: 1811221.0682; val_gene_expr_recon_loss: 1010468.3163; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2830743.5379; val_optim_loss: 2830743.5379
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9762; val_auprc_score: 0.9841; val_best_acc_score: 0.9433; val_best_f1_score: 0.9578; train_kl_reg_loss: 9323.7502; train_edge_recon_loss: 1766298.2551; train_gene_expr_recon_loss: 1011490.3824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2787112.3878; train_optim_loss: 2787112.3878; val_kl_reg_loss: 9219.3646; val_edge_recon_loss: 1801518.4659; val_gene_expr_recon_loss: 1009632.2140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2820370.0758; val_optim_loss: 2820370.0758
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9759; val_auprc_score: 0.9843; val_best_acc_score: 0.9413; val_best_f1_score: 0.9566; train_kl_reg_loss: 8209.0630; train_edge_recon_loss: 1761323.1110; train_gene_expr_recon_loss: 1008882.3746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2778414.5434; train_optim_loss: 2778414.5434; val_kl_reg_loss: 7519.4621; val_edge_recon_loss: 1800091.9318; val_gene_expr_recon_loss: 1007154.4905; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2814765.9015; val_optim_loss: 2814765.9015
[True]
Run timestamp: 28082023_182430_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'xenium_human_breast_cancer', '--reference_batches', 'batch1', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '2', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 313, n_cat_covariates_embed_input: 0, n_hidden: 313, n_latent: 1302, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 2, n_output: 313
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1302, n_addon_gp_input: 10, n_cat_covariates_embed_input: 2, n_output: 313

--- INITIALIZING TRAINER ---
Number of training nodes: 254127
Number of validation nodes: 28236
Number of training edges: 1155480
Number of validation edges: 128386
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9620; val_auprc_score: 0.9736; val_best_acc_score: 0.9259; val_best_f1_score: 0.9456; train_kl_reg_loss: 13204.1751; train_edge_recon_loss: 1824853.3985; train_gene_expr_recon_loss: 1192334.3126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3030391.8849; train_optim_loss: 3030391.8849; val_kl_reg_loss: 10486.3673; val_edge_recon_loss: 1808416.3147; val_gene_expr_recon_loss: 1027481.0715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2846383.7510; val_optim_loss: 2846383.7510
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9761; val_auprc_score: 0.9842; val_best_acc_score: 0.9436; val_best_f1_score: 0.9582; train_kl_reg_loss: 8080.9483; train_edge_recon_loss: 1762897.7338; train_gene_expr_recon_loss: 1007225.7881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2778204.4745; train_optim_loss: 2778204.4745; val_kl_reg_loss: 7499.0453; val_edge_recon_loss: 1801873.4053; val_gene_expr_recon_loss: 1005213.5284; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2814585.9621; val_optim_loss: 2814585.9621
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9756; val_auprc_score: 0.9836; val_best_acc_score: 0.9421; val_best_f1_score: 0.9570; train_kl_reg_loss: 8044.1877; train_edge_recon_loss: 1764427.0357; train_gene_expr_recon_loss: 1006250.2079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2778721.4388; train_optim_loss: 2778721.4388; val_kl_reg_loss: 7526.3723; val_edge_recon_loss: 1798673.5871; val_gene_expr_recon_loss: 1005090.2784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2811290.2273; val_optim_loss: 2811290.2273
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9757; val_auprc_score: 0.9833; val_best_acc_score: 0.9431; val_best_f1_score: 0.9577; train_kl_reg_loss: 7960.5238; train_edge_recon_loss: 1759203.9643; train_gene_expr_recon_loss: 1005185.9843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2772350.4702; train_optim_loss: 2772350.4702; val_kl_reg_loss: 7509.2494; val_edge_recon_loss: 1805984.3826; val_gene_expr_recon_loss: 1003983.3106; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2817476.9242; val_optim_loss: 2817476.9242
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9755; val_auprc_score: 0.9835; val_best_acc_score: 0.9440; val_best_f1_score: 0.9584; train_kl_reg_loss: 7943.6520; train_edge_recon_loss: 1759500.6679; train_gene_expr_recon_loss: 1004876.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2772320.9881; train_optim_loss: 2772320.9881; val_kl_reg_loss: 7550.7435; val_edge_recon_loss: 1804530.0758; val_gene_expr_recon_loss: 1003943.7519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2816024.5833; val_optim_loss: 2816024.5833
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9761; val_auprc_score: 0.9843; val_best_acc_score: 0.9438; val_best_f1_score: 0.9584; train_kl_reg_loss: 7944.9539; train_edge_recon_loss: 1761547.3121; train_gene_expr_recon_loss: 1004829.3280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2774321.5876; train_optim_loss: 2774321.5876; val_kl_reg_loss: 7568.5734; val_edge_recon_loss: 1793699.9242; val_gene_expr_recon_loss: 1002940.3352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2804208.8333; val_optim_loss: 2804208.8333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9782; val_auprc_score: 0.9857; val_best_acc_score: 0.9450; val_best_f1_score: 0.9593; train_kl_reg_loss: 10557.4775; train_edge_recon_loss: 1780193.4212; train_gene_expr_recon_loss: 955078.0488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2745828.9505; train_optim_loss: 2745828.9505; val_kl_reg_loss: 10706.2328; val_edge_recon_loss: 1796040.2146; val_gene_expr_recon_loss: 908697.8782; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2715444.3177; val_optim_loss: 2715444.3177
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9759; val_auprc_score: 0.9835; val_best_acc_score: 0.9442; val_best_f1_score: 0.9586; train_kl_reg_loss: 7908.6691; train_edge_recon_loss: 1762792.1909; train_gene_expr_recon_loss: 1003819.5064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2774520.3639; train_optim_loss: 2774520.3639; val_kl_reg_loss: 7568.8296; val_edge_recon_loss: 1796571.6894; val_gene_expr_recon_loss: 1003262.0473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2807402.5758; val_optim_loss: 2807402.5758
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9771; val_auprc_score: 0.9847; val_best_acc_score: 0.9447; val_best_f1_score: 0.9590; train_kl_reg_loss: 7810.6087; train_edge_recon_loss: 1764379.5485; train_gene_expr_recon_loss: 1004051.2073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2776241.3673; train_optim_loss: 2776241.3673; val_kl_reg_loss: 7531.0008; val_edge_recon_loss: 1797137.7841; val_gene_expr_recon_loss: 1002268.6534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2806937.4318; val_optim_loss: 2806937.4318
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9770; val_auprc_score: 0.9847; val_best_acc_score: 0.9442; val_best_f1_score: 0.9587; train_kl_reg_loss: 7798.0231; train_edge_recon_loss: 1764213.8265; train_gene_expr_recon_loss: 1003331.2202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2775343.0595; train_optim_loss: 2775343.0595; val_kl_reg_loss: 7501.4318; val_edge_recon_loss: 1796201.0114; val_gene_expr_recon_loss: 1002518.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2806221.2273; val_optim_loss: 2806221.2273
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9768; val_auprc_score: 0.9845; val_best_acc_score: 0.9449; val_best_f1_score: 0.9593; train_kl_reg_loss: 7810.5081; train_edge_recon_loss: 1761746.5034; train_gene_expr_recon_loss: 1002985.3308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2772542.3393; train_optim_loss: 2772542.3393; val_kl_reg_loss: 7477.9579; val_edge_recon_loss: 1798196.1136; val_gene_expr_recon_loss: 1001060.6534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2806734.7121; val_optim_loss: 2806734.7121

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9773; val_auprc_score: 0.9848; val_best_acc_score: 0.9458; val_best_f1_score: 0.9597; train_kl_reg_loss: 7724.7427; train_edge_recon_loss: 1760026.2258; train_gene_expr_recon_loss: 1000546.2409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2768297.2007; train_optim_loss: 2768297.2007; val_kl_reg_loss: 7456.2708; val_edge_recon_loss: 1799553.0682; val_gene_expr_recon_loss: 999748.0322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2806757.3409; val_optim_loss: 2806757.3409
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9773; val_auprc_score: 0.9850; val_best_acc_score: 0.9440; val_best_f1_score: 0.9585; train_kl_reg_loss: 7703.5995; train_edge_recon_loss: 1760832.7730; train_gene_expr_recon_loss: 1000693.6063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2769229.9804; train_optim_loss: 2769229.9804; val_kl_reg_loss: 7396.7482; val_edge_recon_loss: 1803164.9697; val_gene_expr_recon_loss: 999758.3958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2810320.0909; val_optim_loss: 2810320.0909
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9811; val_auprc_score: 0.9878; val_best_acc_score: 0.9490; val_best_f1_score: 0.9622; train_kl_reg_loss: 10903.1284; train_edge_recon_loss: 1775025.4301; train_gene_expr_recon_loss: 887708.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2673637.4612; train_optim_loss: 2673637.4612; val_kl_reg_loss: 10758.1658; val_edge_recon_loss: 1784221.7983; val_gene_expr_recon_loss: 875676.0737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2670656.0339; val_optim_loss: 2670656.0339
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9777; val_auprc_score: 0.9853; val_best_acc_score: 0.9459; val_best_f1_score: 0.9598; train_kl_reg_loss: 7694.4619; train_edge_recon_loss: 1758480.1909; train_gene_expr_recon_loss: 1000376.9741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2766551.6318; train_optim_loss: 2766551.6318; val_kl_reg_loss: 7464.1675; val_edge_recon_loss: 1790912.5114; val_gene_expr_recon_loss: 999795.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2798171.9394; val_optim_loss: 2798171.9394
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9770; val_auprc_score: 0.9845; val_best_acc_score: 0.9447; val_best_f1_score: 0.9590; train_kl_reg_loss: 7702.9760; train_edge_recon_loss: 1762294.3078; train_gene_expr_recon_loss: 1000563.3937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2770560.6862; train_optim_loss: 2770560.6862; val_kl_reg_loss: 7456.9991; val_edge_recon_loss: 1803400.5682; val_gene_expr_recon_loss: 999916.5095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2810774.0758; val_optim_loss: 2810774.0758
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9774; val_auprc_score: 0.9847; val_best_acc_score: 0.9447; val_best_f1_score: 0.9589; train_kl_reg_loss: 7705.7507; train_edge_recon_loss: 1762067.8878; train_gene_expr_recon_loss: 1000350.0032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2770123.6378; train_optim_loss: 2770123.6378; val_kl_reg_loss: 7419.2978; val_edge_recon_loss: 1807475.7803; val_gene_expr_recon_loss: 998169.6534; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2813064.7424; val_optim_loss: 2813064.7424
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9762; val_auprc_score: 0.9842; val_best_acc_score: 0.9440; val_best_f1_score: 0.9586; train_kl_reg_loss: 7694.2875; train_edge_recon_loss: 1761646.6437; train_gene_expr_recon_loss: 999762.3433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2769103.2849; train_optim_loss: 2769103.2849; val_kl_reg_loss: 7438.9279; val_edge_recon_loss: 1795774.7727; val_gene_expr_recon_loss: 999033.9640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2802247.6970; val_optim_loss: 2802247.6970
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9769; val_auprc_score: 0.9845; val_best_acc_score: 0.9448; val_best_f1_score: 0.9589; train_kl_reg_loss: 7690.9187; train_edge_recon_loss: 1760467.0408; train_gene_expr_recon_loss: 1000143.4634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2768301.4260; train_optim_loss: 2768301.4260; val_kl_reg_loss: 7420.5662; val_edge_recon_loss: 1800121.2273; val_gene_expr_recon_loss: 999471.4716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2807013.2500; val_optim_loss: 2807013.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9813; val_auprc_score: 0.9879; val_best_acc_score: 0.9497; val_best_f1_score: 0.9626; train_kl_reg_loss: 11020.1915; train_edge_recon_loss: 1769775.3032; train_gene_expr_recon_loss: 866147.0776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2646942.5701; train_optim_loss: 2646942.5701; val_kl_reg_loss: 11217.7852; val_edge_recon_loss: 1788859.8043; val_gene_expr_recon_loss: 858738.0396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2658815.6245; val_optim_loss: 2658815.6245

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9775; val_auprc_score: 0.9854; val_best_acc_score: 0.9451; val_best_f1_score: 0.9593; train_kl_reg_loss: 7688.3059; train_edge_recon_loss: 1758356.9877; train_gene_expr_recon_loss: 1000113.3112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2766158.5978; train_optim_loss: 2766158.5978; val_kl_reg_loss: 7437.8803; val_edge_recon_loss: 1791538.4205; val_gene_expr_recon_loss: 998939.7197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2797916.0152; val_optim_loss: 2797916.0152
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9777; val_auprc_score: 0.9854; val_best_acc_score: 0.9452; val_best_f1_score: 0.9593; train_kl_reg_loss: 7688.2842; train_edge_recon_loss: 1760276.8818; train_gene_expr_recon_loss: 999701.2041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2767666.3699; train_optim_loss: 2767666.3699; val_kl_reg_loss: 7439.9668; val_edge_recon_loss: 1799417.7386; val_gene_expr_recon_loss: 1000925.4072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2807783.1061; val_optim_loss: 2807783.1061
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9771; val_auprc_score: 0.9849; val_best_acc_score: 0.9443; val_best_f1_score: 0.9587; train_kl_reg_loss: 7685.0425; train_edge_recon_loss: 1760442.3112; train_gene_expr_recon_loss: 999884.0011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2768011.3512; train_optim_loss: 2768011.3512; val_kl_reg_loss: 7438.7279; val_edge_recon_loss: 1797052.9886; val_gene_expr_recon_loss: 998017.9261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2802509.6591; val_optim_loss: 2802509.6591
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9771; val_auprc_score: 0.9849; val_best_acc_score: 0.9453; val_best_f1_score: 0.9594; train_kl_reg_loss: 7683.0651; train_edge_recon_loss: 1758215.4800; train_gene_expr_recon_loss: 1000009.8486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2765908.3878; train_optim_loss: 2765908.3878; val_kl_reg_loss: 7427.2617; val_edge_recon_loss: 1794110.1591; val_gene_expr_recon_loss: 998930.1004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2800467.5455; val_optim_loss: 2800467.5455
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9773; val_auprc_score: 0.9851; val_best_acc_score: 0.9447; val_best_f1_score: 0.9590; train_kl_reg_loss: 7674.8257; train_edge_recon_loss: 1760397.9145; train_gene_expr_recon_loss: 999832.9345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2767905.6769; train_optim_loss: 2767905.6769; val_kl_reg_loss: 7430.6437; val_edge_recon_loss: 1793271.7273; val_gene_expr_recon_loss: 999047.0947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2799749.4697; val_optim_loss: 2799749.4697

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9771; val_auprc_score: 0.9850; val_best_acc_score: 0.9445; val_best_f1_score: 0.9587; train_kl_reg_loss: 7673.5320; train_edge_recon_loss: 1758027.2258; train_gene_expr_recon_loss: 999862.4031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2765563.1607; train_optim_loss: 2765563.1607; val_kl_reg_loss: 7429.8718; val_edge_recon_loss: 1803404.6705; val_gene_expr_recon_loss: 999627.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2810462.3409; val_optim_loss: 2810462.3409
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9829; val_auprc_score: 0.9889; val_best_acc_score: 0.9523; val_best_f1_score: 0.9645; train_kl_reg_loss: 11111.8249; train_edge_recon_loss: 1767118.4461; train_gene_expr_recon_loss: 856122.0870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2634352.3567; train_optim_loss: 2634352.3567; val_kl_reg_loss: 11195.2834; val_edge_recon_loss: 1782294.5403; val_gene_expr_recon_loss: 852695.0401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2646184.8566; val_optim_loss: 2646184.8566
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9772; val_auprc_score: 0.9847; val_best_acc_score: 0.9447; val_best_f1_score: 0.9590; train_kl_reg_loss: 7676.2729; train_edge_recon_loss: 1759323.7679; train_gene_expr_recon_loss: 999762.4904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2766762.5315; train_optim_loss: 2766762.5315; val_kl_reg_loss: 7429.3618; val_edge_recon_loss: 1799858.7197; val_gene_expr_recon_loss: 998112.7803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2805400.8712; val_optim_loss: 2805400.8712
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9766; val_auprc_score: 0.9841; val_best_acc_score: 0.9448; val_best_f1_score: 0.9590; train_kl_reg_loss: 7675.4757; train_edge_recon_loss: 1758715.9452; train_gene_expr_recon_loss: 999646.9573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2766038.3869; train_optim_loss: 2766038.3869; val_kl_reg_loss: 7433.1037; val_edge_recon_loss: 1803660.0682; val_gene_expr_recon_loss: 999609.5436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2810702.6970; val_optim_loss: 2810702.6970
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9778; val_auprc_score: 0.9852; val_best_acc_score: 0.9458; val_best_f1_score: 0.9598; train_kl_reg_loss: 7675.4686; train_edge_recon_loss: 1758865.4906; train_gene_expr_recon_loss: 999322.2574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2765863.2219; train_optim_loss: 2765863.2219; val_kl_reg_loss: 7428.7299; val_edge_recon_loss: 1800557.5303; val_gene_expr_recon_loss: 999126.8258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2807113.1136; val_optim_loss: 2807113.1136
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9835; val_auprc_score: 0.9894; val_best_acc_score: 0.9521; val_best_f1_score: 0.9644; train_kl_reg_loss: 11146.7797; train_edge_recon_loss: 1766292.1762; train_gene_expr_recon_loss: 849563.9904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2627002.9485; train_optim_loss: 2627002.9485; val_kl_reg_loss: 11299.2204; val_edge_recon_loss: 1781929.0802; val_gene_expr_recon_loss: 850718.3257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2643946.6345; val_optim_loss: 2643946.6345

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 98 min 37 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9781
val AUPRC score: 0.9854
val best accuracy score: 0.9460
val best F1 score: 0.9599
val target rna MSE score: 1.3338
val source rna MSE score: 0.2990
Val cat covariate0 mean sim diff: 0.0013

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9846; val_auprc_score: 0.9901; val_best_acc_score: 0.9544; val_best_f1_score: 0.9661; train_kl_reg_loss: 11220.4627; train_edge_recon_loss: 1766504.2322; train_gene_expr_recon_loss: 844790.6206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2622515.3157; train_optim_loss: 2622515.3157; val_kl_reg_loss: 11210.5757; val_edge_recon_loss: 1779626.9617; val_gene_expr_recon_loss: 842831.2014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2633668.7361; val_optim_loss: 2633668.7361
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9841; val_auprc_score: 0.9897; val_best_acc_score: 0.9535; val_best_f1_score: 0.9654; train_kl_reg_loss: 11279.6334; train_edge_recon_loss: 1765174.2437; train_gene_expr_recon_loss: 840480.4756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2616934.3519; train_optim_loss: 2616934.3519; val_kl_reg_loss: 11322.7308; val_edge_recon_loss: 1779868.8481; val_gene_expr_recon_loss: 839846.3924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2631037.9781; val_optim_loss: 2631037.9781
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9843; val_auprc_score: 0.9899; val_best_acc_score: 0.9544; val_best_f1_score: 0.9660; train_kl_reg_loss: 11347.5354; train_edge_recon_loss: 1763316.8401; train_gene_expr_recon_loss: 837612.0760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2612276.4510; train_optim_loss: 2612276.4510; val_kl_reg_loss: 11317.5201; val_edge_recon_loss: 1784167.3028; val_gene_expr_recon_loss: 835568.7221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2631053.5388; val_optim_loss: 2631053.5388
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9840; val_auprc_score: 0.9895; val_best_acc_score: 0.9560; val_best_f1_score: 0.9673; train_kl_reg_loss: 11407.1892; train_edge_recon_loss: 1763178.3046; train_gene_expr_recon_loss: 835637.1517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2610222.6451; train_optim_loss: 2610222.6451; val_kl_reg_loss: 11371.4141; val_edge_recon_loss: 1776778.4333; val_gene_expr_recon_loss: 834997.2689; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2623147.1165; val_optim_loss: 2623147.1165
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9850; val_auprc_score: 0.9904; val_best_acc_score: 0.9567; val_best_f1_score: 0.9679; train_kl_reg_loss: 11408.3382; train_edge_recon_loss: 1763088.3684; train_gene_expr_recon_loss: 833102.3164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2607599.0206; train_optim_loss: 2607599.0206; val_kl_reg_loss: 11243.4250; val_edge_recon_loss: 1772780.3347; val_gene_expr_recon_loss: 832142.3705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2616166.1275; val_optim_loss: 2616166.1275
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9848; val_auprc_score: 0.9901; val_best_acc_score: 0.9558; val_best_f1_score: 0.9671; train_kl_reg_loss: 11433.2505; train_edge_recon_loss: 1763229.0321; train_gene_expr_recon_loss: 831280.8283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2605943.1082; train_optim_loss: 2605943.1082; val_kl_reg_loss: 11326.1040; val_edge_recon_loss: 1782242.8068; val_gene_expr_recon_loss: 830625.4729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2624194.3845; val_optim_loss: 2624194.3845
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9844; val_auprc_score: 0.9899; val_best_acc_score: 0.9553; val_best_f1_score: 0.9667; train_kl_reg_loss: 11478.3159; train_edge_recon_loss: 1763024.3901; train_gene_expr_recon_loss: 829317.1062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2603819.8099; train_optim_loss: 2603819.8099; val_kl_reg_loss: 11349.4431; val_edge_recon_loss: 1782841.1922; val_gene_expr_recon_loss: 830418.6038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2624609.2510; val_optim_loss: 2624609.2510
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9841; val_auprc_score: 0.9895; val_best_acc_score: 0.9552; val_best_f1_score: 0.9667; train_kl_reg_loss: 11471.6301; train_edge_recon_loss: 1759573.6321; train_gene_expr_recon_loss: 827862.6341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2598907.9011; train_optim_loss: 2598907.9011; val_kl_reg_loss: 11583.1917; val_edge_recon_loss: 1780141.0822; val_gene_expr_recon_loss: 827009.1111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2618733.3855; val_optim_loss: 2618733.3855
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9860; val_auprc_score: 0.9909; val_best_acc_score: 0.9572; val_best_f1_score: 0.9681; train_kl_reg_loss: 11520.8066; train_edge_recon_loss: 1760755.0737; train_gene_expr_recon_loss: 825872.2920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2598148.1719; train_optim_loss: 2598148.1719; val_kl_reg_loss: 11397.6433; val_edge_recon_loss: 1782744.0498; val_gene_expr_recon_loss: 826633.6011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2620775.2908; val_optim_loss: 2620775.2908

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9857; val_auprc_score: 0.9907; val_best_acc_score: 0.9580; val_best_f1_score: 0.9687; train_kl_reg_loss: 11499.2052; train_edge_recon_loss: 1759608.7967; train_gene_expr_recon_loss: 817226.8475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2588334.8456; train_optim_loss: 2588334.8456; val_kl_reg_loss: 11582.9435; val_edge_recon_loss: 1776880.9278; val_gene_expr_recon_loss: 818129.6340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2606593.5080; val_optim_loss: 2606593.5080
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9868; val_auprc_score: 0.9914; val_best_acc_score: 0.9598; val_best_f1_score: 0.9701; train_kl_reg_loss: 11588.7082; train_edge_recon_loss: 1759787.5178; train_gene_expr_recon_loss: 816231.5999; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2587607.8249; train_optim_loss: 2587607.8249; val_kl_reg_loss: 11641.6448; val_edge_recon_loss: 1771136.4831; val_gene_expr_recon_loss: 817266.9285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2600045.0657; val_optim_loss: 2600045.0657
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9871; val_auprc_score: 0.9917; val_best_acc_score: 0.9596; val_best_f1_score: 0.9699; train_kl_reg_loss: 11599.9371; train_edge_recon_loss: 1757982.5748; train_gene_expr_recon_loss: 815780.9962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2585363.5106; train_optim_loss: 2585363.5106; val_kl_reg_loss: 11617.0358; val_edge_recon_loss: 1775229.3929; val_gene_expr_recon_loss: 817306.6469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2604153.0847; val_optim_loss: 2604153.0847
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9870; val_auprc_score: 0.9917; val_best_acc_score: 0.9603; val_best_f1_score: 0.9704; train_kl_reg_loss: 11554.3482; train_edge_recon_loss: 1756363.4571; train_gene_expr_recon_loss: 815406.5016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2583324.3056; train_optim_loss: 2583324.3056; val_kl_reg_loss: 11549.8937; val_edge_recon_loss: 1771896.7844; val_gene_expr_recon_loss: 817267.3997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2600714.0677; val_optim_loss: 2600714.0677
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9863; val_auprc_score: 0.9910; val_best_acc_score: 0.9590; val_best_f1_score: 0.9695; train_kl_reg_loss: 11542.2945; train_edge_recon_loss: 1757537.3676; train_gene_expr_recon_loss: 815136.0260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2584215.6868; train_optim_loss: 2584215.6868; val_kl_reg_loss: 11588.0885; val_edge_recon_loss: 1777835.1718; val_gene_expr_recon_loss: 816774.2049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2606197.4691; val_optim_loss: 2606197.4691
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9870; val_auprc_score: 0.9917; val_best_acc_score: 0.9594; val_best_f1_score: 0.9697; train_kl_reg_loss: 11556.0527; train_edge_recon_loss: 1754653.5503; train_gene_expr_recon_loss: 814862.7172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2581072.3211; train_optim_loss: 2581072.3211; val_kl_reg_loss: 11556.4353; val_edge_recon_loss: 1771969.1225; val_gene_expr_recon_loss: 817209.7796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2600735.3376; val_optim_loss: 2600735.3376

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9871; val_auprc_score: 0.9916; val_best_acc_score: 0.9604; val_best_f1_score: 0.9704; train_kl_reg_loss: 11523.0225; train_edge_recon_loss: 1756476.6383; train_gene_expr_recon_loss: 814170.1497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2582169.8097; train_optim_loss: 2582169.8097; val_kl_reg_loss: 11557.9657; val_edge_recon_loss: 1771707.8835; val_gene_expr_recon_loss: 815697.6357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2598963.4821; val_optim_loss: 2598963.4821
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9871; val_auprc_score: 0.9916; val_best_acc_score: 0.9600; val_best_f1_score: 0.9701; train_kl_reg_loss: 11547.9173; train_edge_recon_loss: 1756219.6891; train_gene_expr_recon_loss: 814184.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2581951.6973; train_optim_loss: 2581951.6973; val_kl_reg_loss: 11571.5042; val_edge_recon_loss: 1777098.0886; val_gene_expr_recon_loss: 815098.0012; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2603767.5876; val_optim_loss: 2603767.5876
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9866; val_auprc_score: 0.9913; val_best_acc_score: 0.9596; val_best_f1_score: 0.9699; train_kl_reg_loss: 11539.3047; train_edge_recon_loss: 1758293.3331; train_gene_expr_recon_loss: 813832.6755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2583665.3111; train_optim_loss: 2583665.3111; val_kl_reg_loss: 11574.1826; val_edge_recon_loss: 1774516.2455; val_gene_expr_recon_loss: 815220.2737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2601310.6972; val_optim_loss: 2601310.6972
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9872; val_auprc_score: 0.9918; val_best_acc_score: 0.9600; val_best_f1_score: 0.9701; train_kl_reg_loss: 11550.0932; train_edge_recon_loss: 1756778.0974; train_gene_expr_recon_loss: 813709.7112; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2582037.8965; train_optim_loss: 2582037.8965; val_kl_reg_loss: 11571.0780; val_edge_recon_loss: 1778080.4268; val_gene_expr_recon_loss: 815300.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2604951.8048; val_optim_loss: 2604951.8048
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9848; val_auprc_score: 0.9899; val_best_acc_score: 0.9561; val_best_f1_score: 0.9672; train_kl_reg_loss: 10291.6091; train_edge_recon_loss: 1759670.1200; train_gene_expr_recon_loss: 813775.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2583736.8570; train_optim_loss: 2583736.8570; val_kl_reg_loss: 8701.1800; val_edge_recon_loss: 1783241.4801; val_gene_expr_recon_loss: 815288.8782; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2607231.5309; val_optim_loss: 2607231.5309

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9847; val_auprc_score: 0.9898; val_best_acc_score: 0.9568; val_best_f1_score: 0.9679; train_kl_reg_loss: 10048.2657; train_edge_recon_loss: 1758766.6933; train_gene_expr_recon_loss: 813450.4752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2582265.4354; train_optim_loss: 2582265.4354; val_kl_reg_loss: 8704.5064; val_edge_recon_loss: 1778009.5623; val_gene_expr_recon_loss: 814539.9430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2601254.0129; val_optim_loss: 2601254.0129
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9850; val_auprc_score: 0.9901; val_best_acc_score: 0.9566; val_best_f1_score: 0.9676; train_kl_reg_loss: 10043.5469; train_edge_recon_loss: 1760924.2962; train_gene_expr_recon_loss: 813222.9595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2584190.8044; train_optim_loss: 2584190.8044; val_kl_reg_loss: 8699.4386; val_edge_recon_loss: 1777417.9582; val_gene_expr_recon_loss: 814508.2727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2600625.6614; val_optim_loss: 2600625.6614
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9850; val_auprc_score: 0.9900; val_best_acc_score: 0.9568; val_best_f1_score: 0.9678; train_kl_reg_loss: 10027.2718; train_edge_recon_loss: 1759077.0104; train_gene_expr_recon_loss: 813230.7777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2582335.0583; train_optim_loss: 2582335.0583; val_kl_reg_loss: 8690.2381; val_edge_recon_loss: 1779831.5901; val_gene_expr_recon_loss: 814717.2117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2603239.0478; val_optim_loss: 2603239.0478
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9848; val_auprc_score: 0.9901; val_best_acc_score: 0.9562; val_best_f1_score: 0.9673; train_kl_reg_loss: 10007.5950; train_edge_recon_loss: 1759052.9637; train_gene_expr_recon_loss: 812932.4856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 2581993.0442; train_optim_loss: 2581993.0442; val_kl_reg_loss: 8684.0469; val_edge_recon_loss: 1778920.6041; val_gene_expr_recon_loss: 814060.9676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 2601665.6175; val_optim_loss: 2601665.6175

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 379 min 46 sec.
Using best model state, which was in epoch 22.

--- MODEL EVALUATION ---
val AUROC score: 0.9847
val AUPRC score: 0.9900
val best accuracy score: 0.9560
val best F1 score: 0.9672
val target rna MSE score: 0.3265
val source rna MSE score: 0.1960
Val cat covariate0 mean sim diff: -0.0008

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
