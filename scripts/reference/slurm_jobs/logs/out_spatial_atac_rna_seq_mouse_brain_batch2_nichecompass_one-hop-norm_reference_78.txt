[True]
Run timestamp: 26072023_023645_78.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_78']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9051; val_auprc_score: 0.9143; val_best_acc_score: 0.5170; val_best_f1_score: 0.6741; train_kl_reg_loss: 10040.5978; train_edge_recon_loss: 3473781.1667; train_gene_expr_recon_loss: 3162035.0556; train_masked_gp_l1_reg_loss: 1878.9929; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1102514.6528; train_global_loss: 7750250.4444; train_optim_loss: 7750250.4444; val_kl_reg_loss: 17906.0352; val_edge_recon_loss: 4063951.7500; val_gene_expr_recon_loss: 2950245.2500; val_masked_gp_l1_reg_loss: 1905.1459; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1056597.1250; val_global_loss: 8090605.0000; val_optim_loss: 8090605.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8861; val_auprc_score: 0.8975; val_best_acc_score: 0.5257; val_best_f1_score: 0.6780; train_kl_reg_loss: 26272.5412; train_edge_recon_loss: 3490535.4167; train_gene_expr_recon_loss: 2872160.8056; train_masked_gp_l1_reg_loss: 1991.8242; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1065277.5764; train_global_loss: 7456238.0556; train_optim_loss: 7456238.0556; val_kl_reg_loss: 26147.4688; val_edge_recon_loss: 4063703.0000; val_gene_expr_recon_loss: 2721731.7500; val_masked_gp_l1_reg_loss: 2127.2937; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1041573.9375; val_global_loss: 7855283.5000; val_optim_loss: 7855283.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8844; val_auprc_score: 0.8925; val_best_acc_score: 0.5243; val_best_f1_score: 0.6769; train_kl_reg_loss: 43799.6597; train_edge_recon_loss: 3499879.4444; train_gene_expr_recon_loss: 2679225.5556; train_masked_gp_l1_reg_loss: 2257.1482; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1051220.1389; train_global_loss: 7276382.0556; train_optim_loss: 7276382.0556; val_kl_reg_loss: 39604.1641; val_edge_recon_loss: 4063531.5000; val_gene_expr_recon_loss: 2548752.0000; val_masked_gp_l1_reg_loss: 2415.7554; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1023138.3750; val_global_loss: 7677442.5000; val_optim_loss: 7677442.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8987; val_auprc_score: 0.9006; val_best_acc_score: 0.5150; val_best_f1_score: 0.6732; train_kl_reg_loss: 56181.8325; train_edge_recon_loss: 3510937.0000; train_gene_expr_recon_loss: 2510394.4722; train_masked_gp_l1_reg_loss: 2515.8347; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1034888.7014; train_global_loss: 7114917.7778; train_optim_loss: 7114917.7778; val_kl_reg_loss: 52652.1172; val_edge_recon_loss: 4064097.7500; val_gene_expr_recon_loss: 2413210.0000; val_masked_gp_l1_reg_loss: 2617.6953; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1007469.0000; val_global_loss: 7540046.5000; val_optim_loss: 7540046.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9050; val_auprc_score: 0.9057; val_best_acc_score: 0.5311; val_best_f1_score: 0.6803; train_kl_reg_loss: 64356.8789; train_edge_recon_loss: 3512031.8333; train_gene_expr_recon_loss: 2400336.5833; train_masked_gp_l1_reg_loss: 2672.9248; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1015342.5347; train_global_loss: 6994740.7222; train_optim_loss: 6994740.7222; val_kl_reg_loss: 57286.8672; val_edge_recon_loss: 4063021.5000; val_gene_expr_recon_loss: 2338077.2500; val_masked_gp_l1_reg_loss: 2731.1138; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 998359.5000; val_global_loss: 7459476.0000; val_optim_loss: 7459476.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8920; val_auprc_score: 0.8908; val_best_acc_score: 0.5710; val_best_f1_score: 0.6981; train_kl_reg_loss: 69646.3806; train_edge_recon_loss: 3514378.9444; train_gene_expr_recon_loss: 2346077.1389; train_masked_gp_l1_reg_loss: 2761.7819; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1016994.1736; train_global_loss: 6949858.3889; train_optim_loss: 6949858.3889; val_kl_reg_loss: 51107.7852; val_edge_recon_loss: 4060728.7500; val_gene_expr_recon_loss: 2285475.5000; val_masked_gp_l1_reg_loss: 2790.4355; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 991871.1250; val_global_loss: 7391973.5000; val_optim_loss: 7391973.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8951; val_auprc_score: 0.8972; val_best_acc_score: 0.6039; val_best_f1_score: 0.7129; train_kl_reg_loss: 67660.3641; train_edge_recon_loss: 3514841.3889; train_gene_expr_recon_loss: 2290914.1667; train_masked_gp_l1_reg_loss: 2809.0391; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1005925.2014; train_global_loss: 6882150.0556; train_optim_loss: 6882150.0556; val_kl_reg_loss: 64756.4961; val_edge_recon_loss: 4058441.7500; val_gene_expr_recon_loss: 2234162.7500; val_masked_gp_l1_reg_loss: 2831.5735; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 983578.6250; val_global_loss: 7343771.0000; val_optim_loss: 7343771.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8986; val_auprc_score: 0.8971; val_best_acc_score: 0.6801; val_best_f1_score: 0.7526; train_kl_reg_loss: 71094.3377; train_edge_recon_loss: 3512038.1944; train_gene_expr_recon_loss: 2249916.1944; train_masked_gp_l1_reg_loss: 2847.5129; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 999172.8472; train_global_loss: 6835069.0000; train_optim_loss: 6835069.0000; val_kl_reg_loss: 65138.3984; val_edge_recon_loss: 4054317.5000; val_gene_expr_recon_loss: 2206455.0000; val_masked_gp_l1_reg_loss: 2865.7612; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 981995.1875; val_global_loss: 7310772.0000; val_optim_loss: 7310772.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9013; val_auprc_score: 0.8959; val_best_acc_score: 0.7674; val_best_f1_score: 0.8039; train_kl_reg_loss: 70208.0052; train_edge_recon_loss: 3511052.3611; train_gene_expr_recon_loss: 2217988.6944; train_masked_gp_l1_reg_loss: 2882.0812; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 994901.5278; train_global_loss: 6797032.6667; train_optim_loss: 6797032.6667; val_kl_reg_loss: 67248.5469; val_edge_recon_loss: 4044502.0000; val_gene_expr_recon_loss: 2178836.0000; val_masked_gp_l1_reg_loss: 2900.6323; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978899.0000; val_global_loss: 7272386.0000; val_optim_loss: 7272386.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8988; val_auprc_score: 0.8855; val_best_acc_score: 0.8212; val_best_f1_score: 0.8290; train_kl_reg_loss: 71482.6610; train_edge_recon_loss: 3507899.0000; train_gene_expr_recon_loss: 2183851.5000; train_masked_gp_l1_reg_loss: 2912.8086; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 987010.2431; train_global_loss: 6753156.2222; train_optim_loss: 6753156.2222; val_kl_reg_loss: 52980.1406; val_edge_recon_loss: 4017815.2500; val_gene_expr_recon_loss: 2164820.7500; val_masked_gp_l1_reg_loss: 2926.5059; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 975489.3750; val_global_loss: 7214032.0000; val_optim_loss: 7214032.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9038; val_auprc_score: 0.8920; val_best_acc_score: 0.8011; val_best_f1_score: 0.8033; train_kl_reg_loss: 65166.2148; train_edge_recon_loss: 3501023.1389; train_gene_expr_recon_loss: 2185455.3611; train_masked_gp_l1_reg_loss: 2940.6717; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 990071.2500; train_global_loss: 6744656.6111; train_optim_loss: 6744656.6111; val_kl_reg_loss: 51356.0508; val_edge_recon_loss: 3950543.5000; val_gene_expr_recon_loss: 2153649.2500; val_masked_gp_l1_reg_loss: 2958.4634; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974387.1875; val_global_loss: 7132894.5000; val_optim_loss: 7132894.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9081; val_auprc_score: 0.8927; val_best_acc_score: 0.8296; val_best_f1_score: 0.8392; train_kl_reg_loss: 57270.1376; train_edge_recon_loss: 3480062.1667; train_gene_expr_recon_loss: 2172774.3611; train_masked_gp_l1_reg_loss: 2972.8236; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 994351.6944; train_global_loss: 6707431.0556; train_optim_loss: 6707431.0556; val_kl_reg_loss: 48704.4766; val_edge_recon_loss: 3760353.2500; val_gene_expr_recon_loss: 2153118.5000; val_masked_gp_l1_reg_loss: 2990.8574; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974867.5625; val_global_loss: 6940034.5000; val_optim_loss: 6940034.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8951; val_auprc_score: 0.8765; val_best_acc_score: 0.8123; val_best_f1_score: 0.8242; train_kl_reg_loss: 39826.9727; train_edge_recon_loss: 3375248.7222; train_gene_expr_recon_loss: 2175743.1528; train_masked_gp_l1_reg_loss: 3009.2112; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 989653.9444; train_global_loss: 6583482.1111; train_optim_loss: 6583482.1111; val_kl_reg_loss: 31146.6992; val_edge_recon_loss: 3279981.0000; val_gene_expr_recon_loss: 2192999.7500; val_masked_gp_l1_reg_loss: 3036.5076; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979170.9375; val_global_loss: 6486335.0000; val_optim_loss: 6486335.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8810; val_auprc_score: 0.8677; val_best_acc_score: 0.7905; val_best_f1_score: 0.8041; train_kl_reg_loss: 43721.8913; train_edge_recon_loss: 3083091.2778; train_gene_expr_recon_loss: 2227104.3889; train_masked_gp_l1_reg_loss: 3069.9862; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 994793.2917; train_global_loss: 6351780.8333; train_optim_loss: 6351780.8333; val_kl_reg_loss: 66649.8281; val_edge_recon_loss: 2981386.7500; val_gene_expr_recon_loss: 2205035.2500; val_masked_gp_l1_reg_loss: 3118.0935; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979664.3750; val_global_loss: 6235854.5000; val_optim_loss: 6235854.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8807; val_auprc_score: 0.8611; val_best_acc_score: 0.7864; val_best_f1_score: 0.8051; train_kl_reg_loss: 86742.3281; train_edge_recon_loss: 2951921.7778; train_gene_expr_recon_loss: 2203488.2222; train_masked_gp_l1_reg_loss: 3151.7167; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 988461.9028; train_global_loss: 6233766.0556; train_optim_loss: 6233766.0556; val_kl_reg_loss: 95891.0391; val_edge_recon_loss: 2917669.7500; val_gene_expr_recon_loss: 2167792.5000; val_masked_gp_l1_reg_loss: 3184.1257; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973829.5625; val_global_loss: 6158366.5000; val_optim_loss: 6158366.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8895; val_auprc_score: 0.8763; val_best_acc_score: 0.7912; val_best_f1_score: 0.8100; train_kl_reg_loss: 94329.4089; train_edge_recon_loss: 2918286.5278; train_gene_expr_recon_loss: 2169011.2639; train_masked_gp_l1_reg_loss: 3201.5652; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 986542.6528; train_global_loss: 6171371.5000; train_optim_loss: 6171371.5000; val_kl_reg_loss: 83361.2344; val_edge_recon_loss: 2946145.0000; val_gene_expr_recon_loss: 2156110.0000; val_masked_gp_l1_reg_loss: 3220.4773; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972247.5000; val_global_loss: 6161084.0000; val_optim_loss: 6161084.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8938; val_auprc_score: 0.8763; val_best_acc_score: 0.8038; val_best_f1_score: 0.8187; train_kl_reg_loss: 84470.2153; train_edge_recon_loss: 2915317.4444; train_gene_expr_recon_loss: 2161800.0556; train_masked_gp_l1_reg_loss: 3235.6501; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982660.8681; train_global_loss: 6147484.2778; train_optim_loss: 6147484.2778; val_kl_reg_loss: 82933.0859; val_edge_recon_loss: 2926764.5000; val_gene_expr_recon_loss: 2147118.2500; val_masked_gp_l1_reg_loss: 3253.7144; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971709.9375; val_global_loss: 6131779.5000; val_optim_loss: 6131779.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8997; val_auprc_score: 0.8808; val_best_acc_score: 0.8164; val_best_f1_score: 0.8293; train_kl_reg_loss: 85731.9549; train_edge_recon_loss: 2895291.3889; train_gene_expr_recon_loss: 2162796.8056; train_masked_gp_l1_reg_loss: 3270.6107; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 985278.2569; train_global_loss: 6132369.1111; train_optim_loss: 6132369.1111; val_kl_reg_loss: 81024.7031; val_edge_recon_loss: 2892221.0000; val_gene_expr_recon_loss: 2137189.7500; val_masked_gp_l1_reg_loss: 3287.2515; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969375.0000; val_global_loss: 6083098.0000; val_optim_loss: 6083098.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9127; val_auprc_score: 0.8919; val_best_acc_score: 0.8371; val_best_f1_score: 0.8509; train_kl_reg_loss: 81633.2856; train_edge_recon_loss: 2858690.0556; train_gene_expr_recon_loss: 2161289.8056; train_masked_gp_l1_reg_loss: 3303.2845; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 986192.1528; train_global_loss: 6091108.5556; train_optim_loss: 6091108.5556; val_kl_reg_loss: 78178.7656; val_edge_recon_loss: 2840110.0000; val_gene_expr_recon_loss: 2138388.0000; val_masked_gp_l1_reg_loss: 3322.4387; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968245.6250; val_global_loss: 6028245.0000; val_optim_loss: 6028245.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9170; val_auprc_score: 0.8931; val_best_acc_score: 0.8480; val_best_f1_score: 0.8589; train_kl_reg_loss: 82745.0929; train_edge_recon_loss: 2828317.5833; train_gene_expr_recon_loss: 2154663.0278; train_masked_gp_l1_reg_loss: 3341.2180; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 983792.9306; train_global_loss: 6052859.8889; train_optim_loss: 6052859.8889; val_kl_reg_loss: 84599.2734; val_edge_recon_loss: 2828551.7500; val_gene_expr_recon_loss: 2132520.2500; val_masked_gp_l1_reg_loss: 3362.1489; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967875.0625; val_global_loss: 6016908.0000; val_optim_loss: 6016908.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9298; val_auprc_score: 0.9137; val_best_acc_score: 0.8604; val_best_f1_score: 0.8709; train_kl_reg_loss: 88022.0495; train_edge_recon_loss: 2802072.3056; train_gene_expr_recon_loss: 2138457.5000; train_masked_gp_l1_reg_loss: 3378.1924; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977534.3056; train_global_loss: 6009464.3333; train_optim_loss: 6009464.3333; val_kl_reg_loss: 83322.7188; val_edge_recon_loss: 2791940.2500; val_gene_expr_recon_loss: 2127560.0000; val_masked_gp_l1_reg_loss: 3397.7305; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966064.3750; val_global_loss: 5972285.0000; val_optim_loss: 5972285.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9379; val_auprc_score: 0.9184; val_best_acc_score: 0.8729; val_best_f1_score: 0.8813; train_kl_reg_loss: 84859.9505; train_edge_recon_loss: 2788987.3889; train_gene_expr_recon_loss: 2127354.1806; train_masked_gp_l1_reg_loss: 3415.3572; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 977704.6736; train_global_loss: 5982321.6667; train_optim_loss: 5982321.6667; val_kl_reg_loss: 81961.1250; val_edge_recon_loss: 2779259.7500; val_gene_expr_recon_loss: 2125921.0000; val_masked_gp_l1_reg_loss: 3434.3403; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965759.9375; val_global_loss: 5956336.5000; val_optim_loss: 5956336.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9519; val_auprc_score: 0.9354; val_best_acc_score: 0.8929; val_best_f1_score: 0.8985; train_kl_reg_loss: 84130.9262; train_edge_recon_loss: 2776116.8611; train_gene_expr_recon_loss: 2148942.9167; train_masked_gp_l1_reg_loss: 3452.0214; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982315.3958; train_global_loss: 5994958.0556; train_optim_loss: 5994958.0556; val_kl_reg_loss: 78609.9375; val_edge_recon_loss: 2754160.2500; val_gene_expr_recon_loss: 2124748.2500; val_masked_gp_l1_reg_loss: 3472.5469; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966441.8750; val_global_loss: 5927433.0000; val_optim_loss: 5927433.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9567; val_auprc_score: 0.9405; val_best_acc_score: 0.9025; val_best_f1_score: 0.9056; train_kl_reg_loss: 79850.6450; train_edge_recon_loss: 2766577.8056; train_gene_expr_recon_loss: 2132643.5000; train_masked_gp_l1_reg_loss: 3491.4480; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976469.1111; train_global_loss: 5959032.5556; train_optim_loss: 5959032.5556; val_kl_reg_loss: 81125.5469; val_edge_recon_loss: 2755585.0000; val_gene_expr_recon_loss: 2120196.2500; val_masked_gp_l1_reg_loss: 3512.0308; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965555.0000; val_global_loss: 5925974.0000; val_optim_loss: 5925974.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9582; val_auprc_score: 0.9389; val_best_acc_score: 0.9116; val_best_f1_score: 0.9152; train_kl_reg_loss: 84555.4913; train_edge_recon_loss: 2744948.5000; train_gene_expr_recon_loss: 2122674.0556; train_masked_gp_l1_reg_loss: 3531.3603; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972533.9722; train_global_loss: 5928243.4444; train_optim_loss: 5928243.4444; val_kl_reg_loss: 83237.4844; val_edge_recon_loss: 2717641.5000; val_gene_expr_recon_loss: 2114303.0000; val_masked_gp_l1_reg_loss: 3551.8418; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964949.0625; val_global_loss: 5883683.0000; val_optim_loss: 5883683.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9588; val_auprc_score: 0.9441; val_best_acc_score: 0.9037; val_best_f1_score: 0.9068; train_kl_reg_loss: 102770.9609; train_edge_recon_loss: 2913510.1667; train_gene_expr_recon_loss: 2202830.3611; train_masked_gp_l1_reg_loss: 3581.0481; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 986457.6528; train_global_loss: 6209150.2222; train_optim_loss: 6209150.2222; val_kl_reg_loss: 27842.1328; val_edge_recon_loss: 2880058.0000; val_gene_expr_recon_loss: 2163088.0000; val_masked_gp_l1_reg_loss: 3626.6646; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970734.7500; val_global_loss: 6045349.0000; val_optim_loss: 6045349.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9648; val_auprc_score: 0.9505; val_best_acc_score: 0.9116; val_best_f1_score: 0.9150; train_kl_reg_loss: 121927.0304; train_edge_recon_loss: 2828585.3611; train_gene_expr_recon_loss: 2183728.3889; train_masked_gp_l1_reg_loss: 3659.7540; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 987636.8958; train_global_loss: 6125537.4444; train_optim_loss: 6125537.4444; val_kl_reg_loss: 24773.5879; val_edge_recon_loss: 2842124.5000; val_gene_expr_recon_loss: 2171783.2500; val_masked_gp_l1_reg_loss: 3699.2520; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972489.3750; val_global_loss: 6014870.0000; val_optim_loss: 6014870.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9677; val_auprc_score: 0.9569; val_best_acc_score: 0.9154; val_best_f1_score: 0.9179; train_kl_reg_loss: 96861.1510; train_edge_recon_loss: 2810600.8889; train_gene_expr_recon_loss: 2182006.5278; train_masked_gp_l1_reg_loss: 3728.4860; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 986046.2222; train_global_loss: 6079243.3889; train_optim_loss: 6079243.3889; val_kl_reg_loss: 24638.6680; val_edge_recon_loss: 2816062.7500; val_gene_expr_recon_loss: 2176322.2500; val_masked_gp_l1_reg_loss: 3764.1929; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972305.3750; val_global_loss: 5993093.5000; val_optim_loss: 5993093.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9636; val_auprc_score: 0.9450; val_best_acc_score: 0.9177; val_best_f1_score: 0.9209; train_kl_reg_loss: 87230.0859; train_edge_recon_loss: 2791565.5833; train_gene_expr_recon_loss: 2181169.3333; train_masked_gp_l1_reg_loss: 3788.4308; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 984384.2361; train_global_loss: 6048137.6111; train_optim_loss: 6048137.6111; val_kl_reg_loss: 26675.4434; val_edge_recon_loss: 2782493.7500; val_gene_expr_recon_loss: 2182442.0000; val_masked_gp_l1_reg_loss: 3815.6179; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974185.0625; val_global_loss: 5969611.5000; val_optim_loss: 5969611.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9688; val_auprc_score: 0.9563; val_best_acc_score: 0.9233; val_best_f1_score: 0.9257; train_kl_reg_loss: 83250.9418; train_edge_recon_loss: 2768055.2500; train_gene_expr_recon_loss: 2181460.6389; train_masked_gp_l1_reg_loss: 3817.1143; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 987989.7708; train_global_loss: 6024573.6667; train_optim_loss: 6024573.6667; val_kl_reg_loss: 27568.3125; val_edge_recon_loss: 2774065.5000; val_gene_expr_recon_loss: 2169788.2500; val_masked_gp_l1_reg_loss: 3818.6145; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971522.5625; val_global_loss: 5946763.0000; val_optim_loss: 5946763.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9650; val_auprc_score: 0.9516; val_best_acc_score: 0.9174; val_best_f1_score: 0.9207; train_kl_reg_loss: 83302.5174; train_edge_recon_loss: 2775625.9167; train_gene_expr_recon_loss: 2172480.9444; train_masked_gp_l1_reg_loss: 3819.4319; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 984296.7431; train_global_loss: 6019525.5000; train_optim_loss: 6019525.5000; val_kl_reg_loss: 27937.6250; val_edge_recon_loss: 2793028.0000; val_gene_expr_recon_loss: 2165743.5000; val_masked_gp_l1_reg_loss: 3820.3799; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970903.2500; val_global_loss: 5961433.0000; val_optim_loss: 5961433.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9672; val_auprc_score: 0.9536; val_best_acc_score: 0.9201; val_best_f1_score: 0.9231; train_kl_reg_loss: 81481.7188; train_edge_recon_loss: 2775175.3333; train_gene_expr_recon_loss: 2179060.6389; train_masked_gp_l1_reg_loss: 3821.1378; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 985994.6528; train_global_loss: 6025533.5556; train_optim_loss: 6025533.5556; val_kl_reg_loss: 27376.4707; val_edge_recon_loss: 2786028.7500; val_gene_expr_recon_loss: 2168553.7500; val_masked_gp_l1_reg_loss: 3822.0967; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971677.3125; val_global_loss: 5957458.5000; val_optim_loss: 5957458.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9650; val_auprc_score: 0.9519; val_best_acc_score: 0.9155; val_best_f1_score: 0.9189; train_kl_reg_loss: 80042.2161; train_edge_recon_loss: 2782190.5000; train_gene_expr_recon_loss: 2175462.9167; train_masked_gp_l1_reg_loss: 3822.9266; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978461.8611; train_global_loss: 6019980.5000; train_optim_loss: 6019980.5000; val_kl_reg_loss: 27773.8711; val_edge_recon_loss: 2812361.5000; val_gene_expr_recon_loss: 2167648.5000; val_masked_gp_l1_reg_loss: 3824.0662; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971811.7500; val_global_loss: 5983420.0000; val_optim_loss: 5983420.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 40 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9658
Val AUPRC score: 0.9514
Val best accuracy score: 0.9173
Val best F1 score: 0.9211
Val gene expr MSE score: 0.4493
Val chrom access MSE score: 0.0851
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
