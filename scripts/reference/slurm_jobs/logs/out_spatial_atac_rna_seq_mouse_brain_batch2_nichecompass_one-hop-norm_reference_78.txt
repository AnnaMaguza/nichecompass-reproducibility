[True]
Run timestamp: 07092023_183407_78.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_78']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1125 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5628, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6160; val_auprc_score: 0.6120; val_best_acc_score: 0.5011; val_best_f1_score: 0.6671; train_kl_reg_loss: 67603.4045; train_edge_recon_loss: 3564516.1402; train_gene_expr_recon_loss: 28034666.7576; train_masked_gp_l1_reg_loss: 208214.6764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10585478.6667; train_chrom_access_recon_loss: 3818711.0682; train_global_loss: 46279190.6061; train_optim_loss: 46279190.6061; val_kl_reg_loss: 140987.8105; val_edge_recon_loss: 4065633.8750; val_gene_expr_recon_loss: 25036942.5000; val_masked_gp_l1_reg_loss: 190209.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4318582.0000; val_chrom_access_recon_loss: 3612419.2188; val_global_loss: 37364775.5000; val_optim_loss: 37364775.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6840; val_auprc_score: 0.6608; val_best_acc_score: 0.5776; val_best_f1_score: 0.6928; train_kl_reg_loss: 152565.0053; train_edge_recon_loss: 3565910.1780; train_gene_expr_recon_loss: 24817262.4848; train_masked_gp_l1_reg_loss: 172007.1634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1787018.7661; train_chrom_access_recon_loss: 3610910.7879; train_global_loss: 34105674.6364; train_optim_loss: 34105674.6364; val_kl_reg_loss: 158328.5605; val_edge_recon_loss: 4060605.7500; val_gene_expr_recon_loss: 24280494.7500; val_masked_gp_l1_reg_loss: 162609.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 641102.6875; val_chrom_access_recon_loss: 3560183.7812; val_global_loss: 32863325.0000; val_optim_loss: 32863325.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7342; val_auprc_score: 0.7196; val_best_acc_score: 0.6628; val_best_f1_score: 0.6935; train_kl_reg_loss: 151098.2855; train_edge_recon_loss: 3550890.1856; train_gene_expr_recon_loss: 24435281.4848; train_masked_gp_l1_reg_loss: 160378.7135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 441841.0739; train_chrom_access_recon_loss: 3572993.7841; train_global_loss: 32312483.3939; train_optim_loss: 32312483.3939; val_kl_reg_loss: 140700.5703; val_edge_recon_loss: 4046999.6875; val_gene_expr_recon_loss: 24231061.5000; val_masked_gp_l1_reg_loss: 161041.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 327384.1875; val_chrom_access_recon_loss: 3610279.5938; val_global_loss: 32517467.2500; val_optim_loss: 32517467.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7542; val_auprc_score: 0.7323; val_best_acc_score: 0.6628; val_best_f1_score: 0.7231; train_kl_reg_loss: 136208.8422; train_edge_recon_loss: 3539246.6288; train_gene_expr_recon_loss: 24241617.7879; train_masked_gp_l1_reg_loss: 161712.7644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 276724.6600; train_chrom_access_recon_loss: 3548651.7841; train_global_loss: 31904162.2727; train_optim_loss: 31904162.2727; val_kl_reg_loss: 131050.8770; val_edge_recon_loss: 4005049.5938; val_gene_expr_recon_loss: 24165690.0000; val_masked_gp_l1_reg_loss: 163191.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 239965.4688; val_chrom_access_recon_loss: 3526498.8125; val_global_loss: 32231447.0000; val_optim_loss: 32231447.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7624; val_auprc_score: 0.7476; val_best_acc_score: 0.6886; val_best_f1_score: 0.7327; train_kl_reg_loss: 121031.4602; train_edge_recon_loss: 3515463.4962; train_gene_expr_recon_loss: 24070846.4848; train_masked_gp_l1_reg_loss: 165798.6645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 219292.0954; train_chrom_access_recon_loss: 3528275.6818; train_global_loss: 31620708.0000; train_optim_loss: 31620708.0000; val_kl_reg_loss: 108228.0449; val_edge_recon_loss: 3789924.5938; val_gene_expr_recon_loss: 23926024.5000; val_masked_gp_l1_reg_loss: 168967.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 201111.4531; val_chrom_access_recon_loss: 3518893.4375; val_global_loss: 31713150.5000; val_optim_loss: 31713150.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7845; val_auprc_score: 0.7811; val_best_acc_score: 0.7128; val_best_f1_score: 0.7327; train_kl_reg_loss: 104840.1979; train_edge_recon_loss: 3355268.7045; train_gene_expr_recon_loss: 23971981.9697; train_masked_gp_l1_reg_loss: 172568.1127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186544.9550; train_chrom_access_recon_loss: 3513169.8674; train_global_loss: 31304374.1212; train_optim_loss: 31304374.1212; val_kl_reg_loss: 125509.8135; val_edge_recon_loss: 3366512.8438; val_gene_expr_recon_loss: 23554768.7500; val_masked_gp_l1_reg_loss: 176067.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174329.5469; val_chrom_access_recon_loss: 3466944.6250; val_global_loss: 30864134.2500; val_optim_loss: 30864134.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8301; val_auprc_score: 0.8036; val_best_acc_score: 0.7536; val_best_f1_score: 0.7765; train_kl_reg_loss: 123002.4940; train_edge_recon_loss: 3144971.3826; train_gene_expr_recon_loss: 23850737.6970; train_masked_gp_l1_reg_loss: 180494.4957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167068.8814; train_chrom_access_recon_loss: 3495431.8977; train_global_loss: 30961706.7576; train_optim_loss: 30961706.7576; val_kl_reg_loss: 136952.8379; val_edge_recon_loss: 3101688.6250; val_gene_expr_recon_loss: 23522731.2500; val_masked_gp_l1_reg_loss: 185916.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159616.2656; val_chrom_access_recon_loss: 3470307.7812; val_global_loss: 30577213.0000; val_optim_loss: 30577213.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8515; val_auprc_score: 0.8120; val_best_acc_score: 0.7781; val_best_f1_score: 0.8021; train_kl_reg_loss: 140793.0433; train_edge_recon_loss: 3005788.2235; train_gene_expr_recon_loss: 23763389.4545; train_masked_gp_l1_reg_loss: 192055.0059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156313.5698; train_chrom_access_recon_loss: 3475989.8561; train_global_loss: 30734329.1515; train_optim_loss: 30734329.1515; val_kl_reg_loss: 142491.7598; val_edge_recon_loss: 3020542.3750; val_gene_expr_recon_loss: 23224698.5000; val_masked_gp_l1_reg_loss: 196259.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153182.9844; val_chrom_access_recon_loss: 3438869.3438; val_global_loss: 30176044.0000; val_optim_loss: 30176044.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8852; val_auprc_score: 0.8572; val_best_acc_score: 0.8117; val_best_f1_score: 0.8272; train_kl_reg_loss: 148507.9751; train_edge_recon_loss: 2929010.7462; train_gene_expr_recon_loss: 23640324.4242; train_masked_gp_l1_reg_loss: 196665.6709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150297.3864; train_chrom_access_recon_loss: 3458818.1742; train_global_loss: 30523624.2121; train_optim_loss: 30523624.2121; val_kl_reg_loss: 145850.0098; val_edge_recon_loss: 2944322.5000; val_gene_expr_recon_loss: 23328490.0000; val_masked_gp_l1_reg_loss: 197411.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148120.6094; val_chrom_access_recon_loss: 3406872.9062; val_global_loss: 30171067.5000; val_optim_loss: 30171067.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8894; val_auprc_score: 0.8528; val_best_acc_score: 0.8213; val_best_f1_score: 0.8371; train_kl_reg_loss: 155187.7081; train_edge_recon_loss: 2886847.3295; train_gene_expr_recon_loss: 23547630.8485; train_masked_gp_l1_reg_loss: 198038.2124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148002.2779; train_chrom_access_recon_loss: 3446394.7462; train_global_loss: 30382101.0000; train_optim_loss: 30382101.0000; val_kl_reg_loss: 154156.2285; val_edge_recon_loss: 2935657.2812; val_gene_expr_recon_loss: 23379514.0000; val_masked_gp_l1_reg_loss: 198759.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149171.1406; val_chrom_access_recon_loss: 3437656.8750; val_global_loss: 30254916.5000; val_optim_loss: 30254916.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9039; val_auprc_score: 0.8748; val_best_acc_score: 0.8396; val_best_f1_score: 0.8499; train_kl_reg_loss: 153016.0971; train_edge_recon_loss: 2879088.3788; train_gene_expr_recon_loss: 23435314.4242; train_masked_gp_l1_reg_loss: 199965.3172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150534.1506; train_chrom_access_recon_loss: 3433515.0758; train_global_loss: 30251433.3333; train_optim_loss: 30251433.3333; val_kl_reg_loss: 149208.6973; val_edge_recon_loss: 2912768.8438; val_gene_expr_recon_loss: 23257920.5000; val_masked_gp_l1_reg_loss: 201251.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150008.7656; val_chrom_access_recon_loss: 3413442.2500; val_global_loss: 30084600.7500; val_optim_loss: 30084600.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9041; val_auprc_score: 0.8785; val_best_acc_score: 0.8393; val_best_f1_score: 0.8531; train_kl_reg_loss: 150677.1371; train_edge_recon_loss: 2863123.9848; train_gene_expr_recon_loss: 23339205.7879; train_masked_gp_l1_reg_loss: 202261.2812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149111.9664; train_chrom_access_recon_loss: 3419198.7386; train_global_loss: 30123578.6061; train_optim_loss: 30123578.6061; val_kl_reg_loss: 163209.2324; val_edge_recon_loss: 2882192.2812; val_gene_expr_recon_loss: 23132620.2500; val_masked_gp_l1_reg_loss: 203502.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148156.2500; val_chrom_access_recon_loss: 3396255.1250; val_global_loss: 29925935.0000; val_optim_loss: 29925935.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9078; val_auprc_score: 0.8811; val_best_acc_score: 0.8477; val_best_f1_score: 0.8578; train_kl_reg_loss: 154617.5537; train_edge_recon_loss: 2859143.4356; train_gene_expr_recon_loss: 23270334.1818; train_masked_gp_l1_reg_loss: 203600.6612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147458.4756; train_chrom_access_recon_loss: 3408431.7576; train_global_loss: 30043585.8788; train_optim_loss: 30043585.8788; val_kl_reg_loss: 150375.1973; val_edge_recon_loss: 2884234.3125; val_gene_expr_recon_loss: 22926961.7500; val_masked_gp_l1_reg_loss: 204373.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146939.8281; val_chrom_access_recon_loss: 3395907.6562; val_global_loss: 29708793.0000; val_optim_loss: 29708793.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9075; val_auprc_score: 0.8778; val_best_acc_score: 0.8466; val_best_f1_score: 0.8583; train_kl_reg_loss: 148812.8759; train_edge_recon_loss: 2857634.1477; train_gene_expr_recon_loss: 23168713.8182; train_masked_gp_l1_reg_loss: 204844.3620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147207.9884; train_chrom_access_recon_loss: 3393615.2424; train_global_loss: 29920828.2424; train_optim_loss: 29920828.2424; val_kl_reg_loss: 147756.8574; val_edge_recon_loss: 2883395.9062; val_gene_expr_recon_loss: 22881830.5000; val_masked_gp_l1_reg_loss: 205337.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147410.4844; val_chrom_access_recon_loss: 3363088.2188; val_global_loss: 29628819.7500; val_optim_loss: 29628819.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9065; val_auprc_score: 0.8792; val_best_acc_score: 0.8498; val_best_f1_score: 0.8582; train_kl_reg_loss: 148325.7384; train_edge_recon_loss: 2854851.8068; train_gene_expr_recon_loss: 23098225.3636; train_masked_gp_l1_reg_loss: 206088.2562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147819.7995; train_chrom_access_recon_loss: 3385136.7235; train_global_loss: 29840447.5758; train_optim_loss: 29840447.5758; val_kl_reg_loss: 151411.0684; val_edge_recon_loss: 2887910.0625; val_gene_expr_recon_loss: 22899188.5000; val_masked_gp_l1_reg_loss: 206865.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148493.5312; val_chrom_access_recon_loss: 3351051.4062; val_global_loss: 29644920.5000; val_optim_loss: 29644920.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9042; val_auprc_score: 0.8668; val_best_acc_score: 0.8466; val_best_f1_score: 0.8579; train_kl_reg_loss: 148522.5895; train_edge_recon_loss: 2838689.0985; train_gene_expr_recon_loss: 23033017.0000; train_masked_gp_l1_reg_loss: 207222.9962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148529.0492; train_chrom_access_recon_loss: 3378439.6856; train_global_loss: 29754420.2424; train_optim_loss: 29754420.2424; val_kl_reg_loss: 150018.9785; val_edge_recon_loss: 2880292.9375; val_gene_expr_recon_loss: 22821181.7500; val_masked_gp_l1_reg_loss: 207525.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147536.9531; val_chrom_access_recon_loss: 3350111.1250; val_global_loss: 29556666.7500; val_optim_loss: 29556666.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9123; val_auprc_score: 0.8809; val_best_acc_score: 0.8571; val_best_f1_score: 0.8664; train_kl_reg_loss: 145176.9943; train_edge_recon_loss: 2836389.9015; train_gene_expr_recon_loss: 22971981.9091; train_masked_gp_l1_reg_loss: 208362.6948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148556.7150; train_chrom_access_recon_loss: 3367697.6023; train_global_loss: 29678165.8788; train_optim_loss: 29678165.8788; val_kl_reg_loss: 143970.1152; val_edge_recon_loss: 2880297.2500; val_gene_expr_recon_loss: 22638748.7500; val_masked_gp_l1_reg_loss: 209196.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148556.1250; val_chrom_access_recon_loss: 3337937.8750; val_global_loss: 29358706.5000; val_optim_loss: 29358706.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9156; val_auprc_score: 0.8868; val_best_acc_score: 0.8630; val_best_f1_score: 0.8731; train_kl_reg_loss: 144354.3937; train_edge_recon_loss: 2827845.9167; train_gene_expr_recon_loss: 22899140.8182; train_masked_gp_l1_reg_loss: 209815.7578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148238.6868; train_chrom_access_recon_loss: 3356959.8902; train_global_loss: 29586355.7879; train_optim_loss: 29586355.7879; val_kl_reg_loss: 145634.7930; val_edge_recon_loss: 2844533.5312; val_gene_expr_recon_loss: 22567599.2500; val_masked_gp_l1_reg_loss: 210284.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146910.2188; val_chrom_access_recon_loss: 3325055.2188; val_global_loss: 29240016.2500; val_optim_loss: 29240016.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9282; val_auprc_score: 0.9032; val_best_acc_score: 0.8761; val_best_f1_score: 0.8819; train_kl_reg_loss: 144067.0083; train_edge_recon_loss: 2831351.6856; train_gene_expr_recon_loss: 22849838.3333; train_masked_gp_l1_reg_loss: 210917.6776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147200.4022; train_chrom_access_recon_loss: 3346812.8561; train_global_loss: 29530188.1515; train_optim_loss: 29530188.1515; val_kl_reg_loss: 146613.4297; val_edge_recon_loss: 2840705.9062; val_gene_expr_recon_loss: 22779834.5000; val_masked_gp_l1_reg_loss: 211943.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147173.1406; val_chrom_access_recon_loss: 3331184.4375; val_global_loss: 29457456.0000; val_optim_loss: 29457456.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9236; val_auprc_score: 0.9006; val_best_acc_score: 0.8673; val_best_f1_score: 0.8763; train_kl_reg_loss: 143286.9806; train_edge_recon_loss: 2824918.3598; train_gene_expr_recon_loss: 22785787.3939; train_masked_gp_l1_reg_loss: 212423.5481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146852.8198; train_chrom_access_recon_loss: 3336449.1553; train_global_loss: 29449718.2727; train_optim_loss: 29449718.2727; val_kl_reg_loss: 144467.0840; val_edge_recon_loss: 2840580.4062; val_gene_expr_recon_loss: 22555542.5000; val_masked_gp_l1_reg_loss: 213109.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146642.2500; val_chrom_access_recon_loss: 3316507.9062; val_global_loss: 29216850.0000; val_optim_loss: 29216850.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9196; val_auprc_score: 0.8852; val_best_acc_score: 0.8667; val_best_f1_score: 0.8765; train_kl_reg_loss: 144152.5812; train_edge_recon_loss: 2807783.5568; train_gene_expr_recon_loss: 22725192.5152; train_masked_gp_l1_reg_loss: 213430.3840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146491.4313; train_chrom_access_recon_loss: 3329811.2159; train_global_loss: 29366861.6061; train_optim_loss: 29366861.6061; val_kl_reg_loss: 142089.2031; val_edge_recon_loss: 2831594.0000; val_gene_expr_recon_loss: 22099420.0000; val_masked_gp_l1_reg_loss: 213567.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144982.3594; val_chrom_access_recon_loss: 3284656.1250; val_global_loss: 28716309.5000; val_optim_loss: 28716309.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9228; val_auprc_score: 0.9014; val_best_acc_score: 0.8627; val_best_f1_score: 0.8732; train_kl_reg_loss: 143365.4735; train_edge_recon_loss: 2812634.1136; train_gene_expr_recon_loss: 22691394.3333; train_masked_gp_l1_reg_loss: 214168.3821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144797.4373; train_chrom_access_recon_loss: 3326314.0606; train_global_loss: 29332673.8485; train_optim_loss: 29332673.8485; val_kl_reg_loss: 141545.6699; val_edge_recon_loss: 2863584.0625; val_gene_expr_recon_loss: 22523083.0000; val_masked_gp_l1_reg_loss: 214507.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145009.5781; val_chrom_access_recon_loss: 3306105.7188; val_global_loss: 29193835.7500; val_optim_loss: 29193835.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9306; val_auprc_score: 0.9070; val_best_acc_score: 0.8767; val_best_f1_score: 0.8842; train_kl_reg_loss: 143106.5052; train_edge_recon_loss: 2803065.4924; train_gene_expr_recon_loss: 22636456.2727; train_masked_gp_l1_reg_loss: 214989.1098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144995.6780; train_chrom_access_recon_loss: 3313738.5682; train_global_loss: 29256351.6061; train_optim_loss: 29256351.6061; val_kl_reg_loss: 144070.6816; val_edge_recon_loss: 2826930.0000; val_gene_expr_recon_loss: 22637242.5000; val_masked_gp_l1_reg_loss: 215644.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146156.8906; val_chrom_access_recon_loss: 3295305.6562; val_global_loss: 29265348.5000; val_optim_loss: 29265348.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9276; val_auprc_score: 0.9016; val_best_acc_score: 0.8748; val_best_f1_score: 0.8812; train_kl_reg_loss: 141352.9571; train_edge_recon_loss: 2808307.9773; train_gene_expr_recon_loss: 22601275.3636; train_masked_gp_l1_reg_loss: 215912.9181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145099.2133; train_chrom_access_recon_loss: 3306406.9583; train_global_loss: 29218355.5152; train_optim_loss: 29218355.5152; val_kl_reg_loss: 143050.2148; val_edge_recon_loss: 2835582.3438; val_gene_expr_recon_loss: 22351209.2500; val_masked_gp_l1_reg_loss: 216970.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145676.8750; val_chrom_access_recon_loss: 3269839.1562; val_global_loss: 28962327.0000; val_optim_loss: 28962327.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9313; val_auprc_score: 0.9110; val_best_acc_score: 0.8769; val_best_f1_score: 0.8850; train_kl_reg_loss: 141305.6679; train_edge_recon_loss: 2798823.3182; train_gene_expr_recon_loss: 22557406.7576; train_masked_gp_l1_reg_loss: 216963.3085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144719.5938; train_chrom_access_recon_loss: 3304113.5341; train_global_loss: 29163332.1818; train_optim_loss: 29163332.1818; val_kl_reg_loss: 140366.0840; val_edge_recon_loss: 2815437.8438; val_gene_expr_recon_loss: 22408025.0000; val_masked_gp_l1_reg_loss: 217254.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144212.5312; val_chrom_access_recon_loss: 3279023.5312; val_global_loss: 29004317.7500; val_optim_loss: 29004317.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9339; val_auprc_score: 0.9092; val_best_acc_score: 0.8823; val_best_f1_score: 0.8874; train_kl_reg_loss: 140848.8598; train_edge_recon_loss: 2836479.1742; train_gene_expr_recon_loss: 22149564.9697; train_masked_gp_l1_reg_loss: 211429.4309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103707.0643; train_chrom_access_recon_loss: 3372142.5265; train_global_loss: 28814171.9394; train_optim_loss: 28814171.9394; val_kl_reg_loss: 96982.6641; val_edge_recon_loss: 2867164.1250; val_gene_expr_recon_loss: 21942801.7500; val_masked_gp_l1_reg_loss: 208674.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94458.6328; val_chrom_access_recon_loss: 3269736.6875; val_global_loss: 28479817.5000; val_optim_loss: 28479817.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9236; val_auprc_score: 0.8969; val_best_acc_score: 0.8702; val_best_f1_score: 0.8773; train_kl_reg_loss: 145637.5604; train_edge_recon_loss: 2849424.7803; train_gene_expr_recon_loss: 22081079.2424; train_masked_gp_l1_reg_loss: 208111.8804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93630.8137; train_chrom_access_recon_loss: 3256271.6402; train_global_loss: 28634155.9697; train_optim_loss: 28634155.9697; val_kl_reg_loss: 100335.6113; val_edge_recon_loss: 2926420.1875; val_gene_expr_recon_loss: 21736294.2500; val_masked_gp_l1_reg_loss: 207699.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93164.8750; val_chrom_access_recon_loss: 3197758.7500; val_global_loss: 28261672.7500; val_optim_loss: 28261672.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9257; val_auprc_score: 0.9032; val_best_acc_score: 0.8718; val_best_f1_score: 0.8785; train_kl_reg_loss: 152408.3738; train_edge_recon_loss: 2830451.7424; train_gene_expr_recon_loss: 22070062.2727; train_masked_gp_l1_reg_loss: 207479.6948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92788.4619; train_chrom_access_recon_loss: 3242499.2538; train_global_loss: 28595690.0303; train_optim_loss: 28595690.0303; val_kl_reg_loss: 103687.1045; val_edge_recon_loss: 2903219.4062; val_gene_expr_recon_loss: 21928253.2500; val_masked_gp_l1_reg_loss: 207337.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92556.4766; val_chrom_access_recon_loss: 3202926.3438; val_global_loss: 28437980.5000; val_optim_loss: 28437980.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9277; val_auprc_score: 0.9059; val_best_acc_score: 0.8678; val_best_f1_score: 0.8772; train_kl_reg_loss: 154507.9429; train_edge_recon_loss: 2838053.4205; train_gene_expr_recon_loss: 22059999.5455; train_masked_gp_l1_reg_loss: 207220.3627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92411.3851; train_chrom_access_recon_loss: 3240070.1402; train_global_loss: 28592262.7879; train_optim_loss: 28592262.7879; val_kl_reg_loss: 105677.3359; val_edge_recon_loss: 2877610.1562; val_gene_expr_recon_loss: 21750704.7500; val_masked_gp_l1_reg_loss: 207112.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92193.9375; val_chrom_access_recon_loss: 3218576.3750; val_global_loss: 28251874.5000; val_optim_loss: 28251874.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9371; val_auprc_score: 0.9164; val_best_acc_score: 0.8799; val_best_f1_score: 0.8878; train_kl_reg_loss: 155723.0239; train_edge_recon_loss: 2812687.0720; train_gene_expr_recon_loss: 22062959.0000; train_masked_gp_l1_reg_loss: 207058.2512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92056.5687; train_chrom_access_recon_loss: 3237210.4811; train_global_loss: 28567694.2424; train_optim_loss: 28567694.2424; val_kl_reg_loss: 108333.5723; val_edge_recon_loss: 2846951.9688; val_gene_expr_recon_loss: 21769948.5000; val_masked_gp_l1_reg_loss: 206997.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91968.1172; val_chrom_access_recon_loss: 3209628.5625; val_global_loss: 28233828.7500; val_optim_loss: 28233828.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9374; val_auprc_score: 0.9177; val_best_acc_score: 0.8799; val_best_f1_score: 0.8865; train_kl_reg_loss: 155074.1290; train_edge_recon_loss: 2819590.4508; train_gene_expr_recon_loss: 22060515.3939; train_masked_gp_l1_reg_loss: 206985.2782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91864.2680; train_chrom_access_recon_loss: 3234926.3826; train_global_loss: 28568956.0909; train_optim_loss: 28568956.0909; val_kl_reg_loss: 110011.1748; val_edge_recon_loss: 2846699.2500; val_gene_expr_recon_loss: 21861789.0000; val_masked_gp_l1_reg_loss: 206923.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91713.8516; val_chrom_access_recon_loss: 3190731.5938; val_global_loss: 28307869.2500; val_optim_loss: 28307869.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9291; val_auprc_score: 0.9063; val_best_acc_score: 0.8764; val_best_f1_score: 0.8844; train_kl_reg_loss: 155679.7696; train_edge_recon_loss: 2811880.9470; train_gene_expr_recon_loss: 22056032.8182; train_masked_gp_l1_reg_loss: 206875.6271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91571.0691; train_chrom_access_recon_loss: 3234599.6515; train_global_loss: 28556640.0606; train_optim_loss: 28556640.0606; val_kl_reg_loss: 110924.8340; val_edge_recon_loss: 2862568.4375; val_gene_expr_recon_loss: 21611888.7500; val_masked_gp_l1_reg_loss: 206838.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91556.2812; val_chrom_access_recon_loss: 3208092.9375; val_global_loss: 28091868.5000; val_optim_loss: 28091868.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9298; val_auprc_score: 0.9056; val_best_acc_score: 0.8769; val_best_f1_score: 0.8838; train_kl_reg_loss: 155992.8632; train_edge_recon_loss: 2801419.4583; train_gene_expr_recon_loss: 22022370.3030; train_masked_gp_l1_reg_loss: 206818.1011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91371.5762; train_chrom_access_recon_loss: 3227112.4659; train_global_loss: 28505084.9394; train_optim_loss: 28505084.9394; val_kl_reg_loss: 113077.9131; val_edge_recon_loss: 2860177.4688; val_gene_expr_recon_loss: 21789353.7500; val_masked_gp_l1_reg_loss: 206790.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91203.7344; val_chrom_access_recon_loss: 3220273.0938; val_global_loss: 28280876.5000; val_optim_loss: 28280876.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9314; val_auprc_score: 0.9095; val_best_acc_score: 0.8753; val_best_f1_score: 0.8835; train_kl_reg_loss: 155951.0611; train_edge_recon_loss: 2815863.6136; train_gene_expr_recon_loss: 22054918.7273; train_masked_gp_l1_reg_loss: 206741.9640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91286.0606; train_chrom_access_recon_loss: 3232757.3333; train_global_loss: 28557518.6970; train_optim_loss: 28557518.6970; val_kl_reg_loss: 114206.8281; val_edge_recon_loss: 2859418.2500; val_gene_expr_recon_loss: 21916280.7500; val_masked_gp_l1_reg_loss: 206692.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91246.3047; val_chrom_access_recon_loss: 3192748.2188; val_global_loss: 28380592.2500; val_optim_loss: 28380592.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9368; val_auprc_score: 0.9151; val_best_acc_score: 0.8834; val_best_f1_score: 0.8902; train_kl_reg_loss: 154453.0601; train_edge_recon_loss: 2806844.0000; train_gene_expr_recon_loss: 22021329.8485; train_masked_gp_l1_reg_loss: 206708.1816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91108.9155; train_chrom_access_recon_loss: 3225965.6856; train_global_loss: 28506409.6667; train_optim_loss: 28506409.6667; val_kl_reg_loss: 115010.3311; val_edge_recon_loss: 2833797.2500; val_gene_expr_recon_loss: 21730995.2500; val_masked_gp_l1_reg_loss: 206692.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91089.5391; val_chrom_access_recon_loss: 3208708.8125; val_global_loss: 28186294.0000; val_optim_loss: 28186294.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9284; val_auprc_score: 0.9022; val_best_acc_score: 0.8743; val_best_f1_score: 0.8819; train_kl_reg_loss: 153499.1591; train_edge_recon_loss: 2803866.3485; train_gene_expr_recon_loss: 22033918.8788; train_masked_gp_l1_reg_loss: 206663.7126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91084.2964; train_chrom_access_recon_loss: 3230127.5379; train_global_loss: 28519160.0303; train_optim_loss: 28519160.0303; val_kl_reg_loss: 117035.7490; val_edge_recon_loss: 2842817.2812; val_gene_expr_recon_loss: 22095144.0000; val_masked_gp_l1_reg_loss: 206626.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90883.0703; val_chrom_access_recon_loss: 3231981.1250; val_global_loss: 28584488.5000; val_optim_loss: 28584488.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9368; val_auprc_score: 0.9158; val_best_acc_score: 0.8850; val_best_f1_score: 0.8910; train_kl_reg_loss: 153243.0909; train_edge_recon_loss: 2802424.8902; train_gene_expr_recon_loss: 22030373.6061; train_masked_gp_l1_reg_loss: 206320.7891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87543.5689; train_chrom_access_recon_loss: 3228009.7348; train_global_loss: 28507915.6061; train_optim_loss: 28507915.6061; val_kl_reg_loss: 115916.1445; val_edge_recon_loss: 2827470.0625; val_gene_expr_recon_loss: 21876464.7500; val_masked_gp_l1_reg_loss: 206161.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86895.6641; val_chrom_access_recon_loss: 3253536.1562; val_global_loss: 28366445.7500; val_optim_loss: 28366445.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9247; val_auprc_score: 0.9044; val_best_acc_score: 0.8654; val_best_f1_score: 0.8743; train_kl_reg_loss: 153009.8243; train_edge_recon_loss: 2791699.1136; train_gene_expr_recon_loss: 22013337.6667; train_masked_gp_l1_reg_loss: 206102.9991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86837.2250; train_chrom_access_recon_loss: 3222960.3447; train_global_loss: 28473947.0303; train_optim_loss: 28473947.0303; val_kl_reg_loss: 116437.6709; val_edge_recon_loss: 2874540.6250; val_gene_expr_recon_loss: 21905850.2500; val_masked_gp_l1_reg_loss: 206061.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86797.4219; val_chrom_access_recon_loss: 3212092.3750; val_global_loss: 28401781.0000; val_optim_loss: 28401781.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9328; val_auprc_score: 0.9049; val_best_acc_score: 0.8818; val_best_f1_score: 0.8883; train_kl_reg_loss: 153306.5002; train_edge_recon_loss: 2806026.5227; train_gene_expr_recon_loss: 22017460.7879; train_masked_gp_l1_reg_loss: 206037.1792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86777.4774; train_chrom_access_recon_loss: 3225643.2689; train_global_loss: 28495251.8788; train_optim_loss: 28495251.8788; val_kl_reg_loss: 115721.2510; val_edge_recon_loss: 2834395.9375; val_gene_expr_recon_loss: 21913332.0000; val_masked_gp_l1_reg_loss: 206011.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86746.4141; val_chrom_access_recon_loss: 3228416.6250; val_global_loss: 28384623.7500; val_optim_loss: 28384623.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9293; val_auprc_score: 0.9051; val_best_acc_score: 0.8745; val_best_f1_score: 0.8822; train_kl_reg_loss: 153374.2502; train_edge_recon_loss: 2797392.6629; train_gene_expr_recon_loss: 22022265.6970; train_masked_gp_l1_reg_loss: 205992.8823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86712.0450; train_chrom_access_recon_loss: 3223989.0947; train_global_loss: 28489726.7576; train_optim_loss: 28489726.7576; val_kl_reg_loss: 116126.0410; val_edge_recon_loss: 2852115.8750; val_gene_expr_recon_loss: 21834146.5000; val_masked_gp_l1_reg_loss: 205978.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86699.3828; val_chrom_access_recon_loss: 3213412.9062; val_global_loss: 28308479.5000; val_optim_loss: 28308479.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 25 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9333
val AUPRC score: 0.9085
val best accuracy score: 0.8778
val best F1 score: 0.8857
val target rna MSE score: 0.8747
val source rna MSE score: 0.2981
val target atac MSE score: 0.4791
val source atac MSE score: 0.1059
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
