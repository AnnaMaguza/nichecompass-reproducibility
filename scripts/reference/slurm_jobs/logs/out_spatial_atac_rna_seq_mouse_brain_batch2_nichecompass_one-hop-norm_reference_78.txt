[True]
Run timestamp: 07082023_194724_78.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_78']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8868; val_auprc_score: 0.9041; val_best_acc_score: 0.5016; val_best_f1_score: 0.6674; train_kl_reg_loss: 21022.2333; train_edge_recon_loss: 351513.3090; train_gene_expr_recon_loss: 1150041.2917; train_masked_gp_l1_reg_loss: 8617.1179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167225.9705; train_chrom_access_recon_loss: 1877271.8889; train_global_loss: 3575691.8333; train_optim_loss: 3575691.8333; val_kl_reg_loss: 6645.6748; val_edge_recon_loss: 406535.4375; val_gene_expr_recon_loss: 965367.2500; val_masked_gp_l1_reg_loss: 7022.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162799.0469; val_chrom_access_recon_loss: 1519748.2500; val_global_loss: 3068117.7500; val_optim_loss: 3068117.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8947; val_auprc_score: 0.9050; val_best_acc_score: 0.5012; val_best_f1_score: 0.6672; train_kl_reg_loss: 6075.6335; train_edge_recon_loss: 351548.1389; train_gene_expr_recon_loss: 929024.5208; train_masked_gp_l1_reg_loss: 6545.5593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160131.4861; train_chrom_access_recon_loss: 1461207.7083; train_global_loss: 2914533.0278; train_optim_loss: 2914533.0278; val_kl_reg_loss: 7437.0156; val_edge_recon_loss: 406562.7500; val_gene_expr_recon_loss: 867872.1250; val_masked_gp_l1_reg_loss: 6275.0928; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156879.5938; val_chrom_access_recon_loss: 1424019.3750; val_global_loss: 2869046.0000; val_optim_loss: 2869046.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8987; val_auprc_score: 0.9123; val_best_acc_score: 0.5012; val_best_f1_score: 0.6672; train_kl_reg_loss: 11804.8154; train_edge_recon_loss: 355750.2500; train_gene_expr_recon_loss: 823080.9792; train_masked_gp_l1_reg_loss: 6440.1013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154149.9722; train_chrom_access_recon_loss: 1402709.2639; train_global_loss: 2753935.4167; train_optim_loss: 2753935.4167; val_kl_reg_loss: 15917.4736; val_edge_recon_loss: 406580.1250; val_gene_expr_recon_loss: 793158.6250; val_masked_gp_l1_reg_loss: 6616.5015; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150483.2188; val_chrom_access_recon_loss: 1388820.5000; val_global_loss: 2761576.5000; val_optim_loss: 2761576.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8895; val_auprc_score: 0.8993; val_best_acc_score: 0.5070; val_best_f1_score: 0.6697; train_kl_reg_loss: 16354.0729; train_edge_recon_loss: 358375.8056; train_gene_expr_recon_loss: 769131.4514; train_masked_gp_l1_reg_loss: 6638.6026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147082.1684; train_chrom_access_recon_loss: 1373758.4722; train_global_loss: 2671340.5833; train_optim_loss: 2671340.5833; val_kl_reg_loss: 17954.2148; val_edge_recon_loss: 406540.3125; val_gene_expr_recon_loss: 755472.5625; val_masked_gp_l1_reg_loss: 6651.9170; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142600.6875; val_chrom_access_recon_loss: 1363906.7500; val_global_loss: 2693126.5000; val_optim_loss: 2693126.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8786; val_auprc_score: 0.8891; val_best_acc_score: 0.5163; val_best_f1_score: 0.6738; train_kl_reg_loss: 19524.6968; train_edge_recon_loss: 359317.8646; train_gene_expr_recon_loss: 744118.5972; train_masked_gp_l1_reg_loss: 6683.0632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138770.0694; train_chrom_access_recon_loss: 1359603.8750; train_global_loss: 2628018.1111; train_optim_loss: 2628018.1111; val_kl_reg_loss: 20054.9648; val_edge_recon_loss: 406483.5312; val_gene_expr_recon_loss: 727656.1250; val_masked_gp_l1_reg_loss: 6695.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133881.2812; val_chrom_access_recon_loss: 1351268.0000; val_global_loss: 2646039.7500; val_optim_loss: 2646039.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8652; val_auprc_score: 0.8700; val_best_acc_score: 0.5299; val_best_f1_score: 0.6787; train_kl_reg_loss: 21551.1914; train_edge_recon_loss: 359971.8194; train_gene_expr_recon_loss: 719542.7361; train_masked_gp_l1_reg_loss: 6696.8132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129897.6936; train_chrom_access_recon_loss: 1344252.7917; train_global_loss: 2581913.0278; train_optim_loss: 2581913.0278; val_kl_reg_loss: 19711.9160; val_edge_recon_loss: 406272.2500; val_gene_expr_recon_loss: 709898.8125; val_masked_gp_l1_reg_loss: 6685.4238; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124908.5938; val_chrom_access_recon_loss: 1341466.0000; val_global_loss: 2608943.0000; val_optim_loss: 2608943.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8520; val_auprc_score: 0.8559; val_best_acc_score: 0.5806; val_best_f1_score: 0.6998; train_kl_reg_loss: 22142.3177; train_edge_recon_loss: 359944.5590; train_gene_expr_recon_loss: 703576.5278; train_masked_gp_l1_reg_loss: 6684.5415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120955.8255; train_chrom_access_recon_loss: 1341703.5556; train_global_loss: 2555007.3611; train_optim_loss: 2555007.3611; val_kl_reg_loss: 21020.8477; val_edge_recon_loss: 405935.0625; val_gene_expr_recon_loss: 696134.8750; val_masked_gp_l1_reg_loss: 6661.8301; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116052.7500; val_chrom_access_recon_loss: 1334076.8750; val_global_loss: 2579882.2500; val_optim_loss: 2579882.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8316; val_auprc_score: 0.8361; val_best_acc_score: 0.6409; val_best_f1_score: 0.7272; train_kl_reg_loss: 23004.3611; train_edge_recon_loss: 359966.3854; train_gene_expr_recon_loss: 691269.2847; train_masked_gp_l1_reg_loss: 6648.9150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112223.7969; train_chrom_access_recon_loss: 1329784.0972; train_global_loss: 2522896.8889; train_optim_loss: 2522896.8889; val_kl_reg_loss: 21031.6426; val_edge_recon_loss: 405223.7500; val_gene_expr_recon_loss: 687467.8750; val_masked_gp_l1_reg_loss: 6618.4424; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107508.6094; val_chrom_access_recon_loss: 1328387.5000; val_global_loss: 2556238.0000; val_optim_loss: 2556238.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8305; val_auprc_score: 0.8355; val_best_acc_score: 0.6892; val_best_f1_score: 0.7474; train_kl_reg_loss: 23789.2142; train_edge_recon_loss: 359956.2986; train_gene_expr_recon_loss: 685231.1667; train_masked_gp_l1_reg_loss: 6604.0551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103897.9818; train_chrom_access_recon_loss: 1327135.4167; train_global_loss: 2506614.1667; train_optim_loss: 2506614.1667; val_kl_reg_loss: 21671.7539; val_edge_recon_loss: 404368.7812; val_gene_expr_recon_loss: 680860.3750; val_masked_gp_l1_reg_loss: 6573.6182; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99477.6562; val_chrom_access_recon_loss: 1323661.6250; val_global_loss: 2536613.7500; val_optim_loss: 2536613.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8270; val_auprc_score: 0.8288; val_best_acc_score: 0.7308; val_best_f1_score: 0.7607; train_kl_reg_loss: 24108.3561; train_edge_recon_loss: 359701.0069; train_gene_expr_recon_loss: 672336.8056; train_masked_gp_l1_reg_loss: 6570.3303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96116.7092; train_chrom_access_recon_loss: 1316775.3889; train_global_loss: 2475608.6389; train_optim_loss: 2475608.6389; val_kl_reg_loss: 21740.6074; val_edge_recon_loss: 403146.5625; val_gene_expr_recon_loss: 676019.2500; val_masked_gp_l1_reg_loss: 6550.0586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92020.3281; val_chrom_access_recon_loss: 1319734.1250; val_global_loss: 2519211.0000; val_optim_loss: 2519211.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8349; val_auprc_score: 0.8357; val_best_acc_score: 0.7518; val_best_f1_score: 0.7551; train_kl_reg_loss: 24015.3244; train_edge_recon_loss: 359313.0208; train_gene_expr_recon_loss: 671434.0625; train_masked_gp_l1_reg_loss: 6543.7502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88937.7804; train_chrom_access_recon_loss: 1312862.7361; train_global_loss: 2463106.6389; train_optim_loss: 2463106.6389; val_kl_reg_loss: 22086.6367; val_edge_recon_loss: 401050.8438; val_gene_expr_recon_loss: 671187.2500; val_masked_gp_l1_reg_loss: 6524.8091; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85198.4375; val_chrom_access_recon_loss: 1316175.0000; val_global_loss: 2502223.0000; val_optim_loss: 2502223.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8432; val_auprc_score: 0.8375; val_best_acc_score: 0.7456; val_best_f1_score: 0.7595; train_kl_reg_loss: 23720.8698; train_edge_recon_loss: 358235.4410; train_gene_expr_recon_loss: 666834.4722; train_masked_gp_l1_reg_loss: 6532.0158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82409.8724; train_chrom_access_recon_loss: 1310443.7778; train_global_loss: 2448176.4444; train_optim_loss: 2448176.4444; val_kl_reg_loss: 21646.1367; val_edge_recon_loss: 397458.9375; val_gene_expr_recon_loss: 667995.2500; val_masked_gp_l1_reg_loss: 6526.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79034.7578; val_chrom_access_recon_loss: 1313231.8750; val_global_loss: 2485893.0000; val_optim_loss: 2485893.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8525; val_auprc_score: 0.8464; val_best_acc_score: 0.7540; val_best_f1_score: 0.7851; train_kl_reg_loss: 23248.3550; train_edge_recon_loss: 356946.5417; train_gene_expr_recon_loss: 664841.9792; train_masked_gp_l1_reg_loss: 6532.8349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76519.7561; train_chrom_access_recon_loss: 1308048.2222; train_global_loss: 2436137.7222; train_optim_loss: 2436137.7222; val_kl_reg_loss: 22927.0645; val_edge_recon_loss: 392435.4062; val_gene_expr_recon_loss: 664540.5000; val_masked_gp_l1_reg_loss: 6536.1123; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73473.2500; val_chrom_access_recon_loss: 1311013.3750; val_global_loss: 2470925.7500; val_optim_loss: 2470925.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8770; val_auprc_score: 0.8678; val_best_acc_score: 0.7922; val_best_f1_score: 0.8032; train_kl_reg_loss: 22751.9379; train_edge_recon_loss: 354260.2049; train_gene_expr_recon_loss: 659050.4792; train_masked_gp_l1_reg_loss: 6553.4728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71203.3273; train_chrom_access_recon_loss: 1306294.0694; train_global_loss: 2420113.5000; train_optim_loss: 2420113.5000; val_kl_reg_loss: 21553.0469; val_edge_recon_loss: 381497.4688; val_gene_expr_recon_loss: 663045.4375; val_masked_gp_l1_reg_loss: 6562.5269; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68451.8672; val_chrom_access_recon_loss: 1308394.7500; val_global_loss: 2449505.0000; val_optim_loss: 2449505.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8910; val_auprc_score: 0.8827; val_best_acc_score: 0.8054; val_best_f1_score: 0.8213; train_kl_reg_loss: 22197.7522; train_edge_recon_loss: 349503.3299; train_gene_expr_recon_loss: 664237.2569; train_masked_gp_l1_reg_loss: 6582.2094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66401.6120; train_chrom_access_recon_loss: 1309034.6944; train_global_loss: 2417956.8333; train_optim_loss: 2417956.8333; val_kl_reg_loss: 21240.7969; val_edge_recon_loss: 364283.2188; val_gene_expr_recon_loss: 662406.1875; val_masked_gp_l1_reg_loss: 6599.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63920.9531; val_chrom_access_recon_loss: 1306833.5000; val_global_loss: 2425284.5000; val_optim_loss: 2425284.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8966; val_auprc_score: 0.8887; val_best_acc_score: 0.8135; val_best_f1_score: 0.8210; train_kl_reg_loss: 22652.4227; train_edge_recon_loss: 339823.8542; train_gene_expr_recon_loss: 660284.3750; train_masked_gp_l1_reg_loss: 6636.5810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62081.6376; train_chrom_access_recon_loss: 1301521.1667; train_global_loss: 2393000.0556; train_optim_loss: 2393000.0556; val_kl_reg_loss: 23860.1328; val_edge_recon_loss: 339211.3125; val_gene_expr_recon_loss: 662727.0000; val_masked_gp_l1_reg_loss: 6669.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59841.7500; val_chrom_access_recon_loss: 1305348.7500; val_global_loss: 2397658.2500; val_optim_loss: 2397658.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8987; val_auprc_score: 0.8893; val_best_acc_score: 0.8071; val_best_f1_score: 0.8210; train_kl_reg_loss: 27324.5252; train_edge_recon_loss: 324858.9271; train_gene_expr_recon_loss: 660112.7986; train_masked_gp_l1_reg_loss: 6707.7107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58183.1415; train_chrom_access_recon_loss: 1299985.6250; train_global_loss: 2377172.6667; train_optim_loss: 2377172.6667; val_kl_reg_loss: 30819.7578; val_edge_recon_loss: 320598.2188; val_gene_expr_recon_loss: 661662.3125; val_masked_gp_l1_reg_loss: 6746.5962; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56160.8906; val_chrom_access_recon_loss: 1303054.3750; val_global_loss: 2379042.0000; val_optim_loss: 2379042.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9012; val_auprc_score: 0.8871; val_best_acc_score: 0.8157; val_best_f1_score: 0.8281; train_kl_reg_loss: 32816.0306; train_edge_recon_loss: 314382.7812; train_gene_expr_recon_loss: 658171.2361; train_masked_gp_l1_reg_loss: 6785.5327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54658.0182; train_chrom_access_recon_loss: 1302416.5833; train_global_loss: 2369230.1944; train_optim_loss: 2369230.1944; val_kl_reg_loss: 32504.3242; val_edge_recon_loss: 313822.2188; val_gene_expr_recon_loss: 659108.0000; val_masked_gp_l1_reg_loss: 6821.0503; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52825.5156; val_chrom_access_recon_loss: 1300555.5000; val_global_loss: 2365636.5000; val_optim_loss: 2365636.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9042; val_auprc_score: 0.8823; val_best_acc_score: 0.8270; val_best_f1_score: 0.8386; train_kl_reg_loss: 31720.3770; train_edge_recon_loss: 309875.2569; train_gene_expr_recon_loss: 655949.4444; train_masked_gp_l1_reg_loss: 6853.7100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51454.3919; train_chrom_access_recon_loss: 1295522.6667; train_global_loss: 2351375.8611; train_optim_loss: 2351375.8611; val_kl_reg_loss: 30581.8125; val_edge_recon_loss: 310041.6875; val_gene_expr_recon_loss: 659065.5000; val_masked_gp_l1_reg_loss: 6886.3623; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49778.3633; val_chrom_access_recon_loss: 1298717.8750; val_global_loss: 2355071.5000; val_optim_loss: 2355071.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9194; val_auprc_score: 0.9023; val_best_acc_score: 0.8437; val_best_f1_score: 0.8521; train_kl_reg_loss: 31031.0679; train_edge_recon_loss: 306401.1319; train_gene_expr_recon_loss: 654409.0139; train_masked_gp_l1_reg_loss: 6918.6860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48530.4475; train_chrom_access_recon_loss: 1291818.5278; train_global_loss: 2339108.8611; train_optim_loss: 2339108.8611; val_kl_reg_loss: 30528.5391; val_edge_recon_loss: 308244.1875; val_gene_expr_recon_loss: 656797.7500; val_masked_gp_l1_reg_loss: 6955.1611; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46997.3047; val_chrom_access_recon_loss: 1296122.5000; val_global_loss: 2345645.5000; val_optim_loss: 2345645.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9248; val_auprc_score: 0.9098; val_best_acc_score: 0.8508; val_best_f1_score: 0.8596; train_kl_reg_loss: 30902.4572; train_edge_recon_loss: 304467.6597; train_gene_expr_recon_loss: 652657.4653; train_masked_gp_l1_reg_loss: 6973.0280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45849.6311; train_chrom_access_recon_loss: 1295770.5278; train_global_loss: 2336620.8056; train_optim_loss: 2336620.8056; val_kl_reg_loss: 30365.3047; val_edge_recon_loss: 306045.5000; val_gene_expr_recon_loss: 655469.3125; val_masked_gp_l1_reg_loss: 7000.0107; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44447.5391; val_chrom_access_recon_loss: 1293847.2500; val_global_loss: 2337175.0000; val_optim_loss: 2337175.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9278; val_auprc_score: 0.9102; val_best_acc_score: 0.8575; val_best_f1_score: 0.8651; train_kl_reg_loss: 30362.1042; train_edge_recon_loss: 303277.1944; train_gene_expr_recon_loss: 653743.1528; train_masked_gp_l1_reg_loss: 7021.8327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43395.5447; train_chrom_access_recon_loss: 1291275.7500; train_global_loss: 2329075.5556; train_optim_loss: 2329075.5556; val_kl_reg_loss: 30086.0117; val_edge_recon_loss: 301735.6875; val_gene_expr_recon_loss: 654272.1250; val_masked_gp_l1_reg_loss: 7045.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42106.8945; val_chrom_access_recon_loss: 1291697.7500; val_global_loss: 2326944.2500; val_optim_loss: 2326944.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9289; val_auprc_score: 0.9074; val_best_acc_score: 0.8599; val_best_f1_score: 0.8702; train_kl_reg_loss: 30888.0017; train_edge_recon_loss: 301353.2882; train_gene_expr_recon_loss: 653869.4792; train_masked_gp_l1_reg_loss: 7072.8364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41139.6593; train_chrom_access_recon_loss: 1290572.8333; train_global_loss: 2324896.1111; train_optim_loss: 2324896.1111; val_kl_reg_loss: 30551.9629; val_edge_recon_loss: 299741.2812; val_gene_expr_recon_loss: 653232.3750; val_masked_gp_l1_reg_loss: 7096.6543; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39950.0352; val_chrom_access_recon_loss: 1289637.8750; val_global_loss: 2320210.2500; val_optim_loss: 2320210.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9340; val_auprc_score: 0.9185; val_best_acc_score: 0.8684; val_best_f1_score: 0.8732; train_kl_reg_loss: 30767.1931; train_edge_recon_loss: 300408.2118; train_gene_expr_recon_loss: 650111.7014; train_masked_gp_l1_reg_loss: 7124.7499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39062.9349; train_chrom_access_recon_loss: 1281910.7361; train_global_loss: 2309385.5000; train_optim_loss: 2309385.5000; val_kl_reg_loss: 30202.5977; val_edge_recon_loss: 301214.1250; val_gene_expr_recon_loss: 651682.2500; val_masked_gp_l1_reg_loss: 7144.7861; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37965.5781; val_chrom_access_recon_loss: 1287856.6250; val_global_loss: 2316066.0000; val_optim_loss: 2316066.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9292; val_auprc_score: 0.9101; val_best_acc_score: 0.8601; val_best_f1_score: 0.8685; train_kl_reg_loss: 30454.6430; train_edge_recon_loss: 300087.6701; train_gene_expr_recon_loss: 645382.6597; train_masked_gp_l1_reg_loss: 7167.1437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37140.3507; train_chrom_access_recon_loss: 1280302.0833; train_global_loss: 2300534.5278; train_optim_loss: 2300534.5278; val_kl_reg_loss: 29800.2578; val_edge_recon_loss: 300566.5000; val_gene_expr_recon_loss: 650709.0000; val_masked_gp_l1_reg_loss: 7177.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36125.2266; val_chrom_access_recon_loss: 1285769.0000; val_global_loss: 2310147.0000; val_optim_loss: 2310147.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9301; val_auprc_score: 0.9130; val_best_acc_score: 0.8610; val_best_f1_score: 0.8675; train_kl_reg_loss: 28118.1565; train_edge_recon_loss: 320378.4479; train_gene_expr_recon_loss: 914987.3750; train_masked_gp_l1_reg_loss: 7271.7498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35148.8872; train_chrom_access_recon_loss: 1365979.2778; train_global_loss: 2671883.8889; train_optim_loss: 2671883.8889; val_kl_reg_loss: 13405.6504; val_edge_recon_loss: 313779.7188; val_gene_expr_recon_loss: 911339.8750; val_masked_gp_l1_reg_loss: 7443.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33812.2188; val_chrom_access_recon_loss: 1362007.0000; val_global_loss: 2641788.0000; val_optim_loss: 2641788.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9313; val_auprc_score: 0.9161; val_best_acc_score: 0.8587; val_best_f1_score: 0.8663; train_kl_reg_loss: 28116.6625; train_edge_recon_loss: 305851.4688; train_gene_expr_recon_loss: 907547.3472; train_masked_gp_l1_reg_loss: 7611.8684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32693.3240; train_chrom_access_recon_loss: 1356340.8333; train_global_loss: 2638161.4722; train_optim_loss: 2638161.4722; val_kl_reg_loss: 16106.8672; val_edge_recon_loss: 304777.8750; val_gene_expr_recon_loss: 905707.1250; val_masked_gp_l1_reg_loss: 7814.5518; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31316.7383; val_chrom_access_recon_loss: 1360117.5000; val_global_loss: 2625840.5000; val_optim_loss: 2625840.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9341; val_auprc_score: 0.9197; val_best_acc_score: 0.8635; val_best_f1_score: 0.8689; train_kl_reg_loss: 25108.3576; train_edge_recon_loss: 299736.6840; train_gene_expr_recon_loss: 902720.5833; train_masked_gp_l1_reg_loss: 7941.9084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30275.9933; train_chrom_access_recon_loss: 1352573.3333; train_global_loss: 2618356.8611; train_optim_loss: 2618356.8611; val_kl_reg_loss: 18141.4453; val_edge_recon_loss: 299792.3750; val_gene_expr_recon_loss: 901160.7500; val_masked_gp_l1_reg_loss: 8085.8662; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29025.8770; val_chrom_access_recon_loss: 1358168.0000; val_global_loss: 2614374.2500; val_optim_loss: 2614374.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9307; val_auprc_score: 0.9115; val_best_acc_score: 0.8624; val_best_f1_score: 0.8670; train_kl_reg_loss: 23673.7140; train_edge_recon_loss: 296338.4792; train_gene_expr_recon_loss: 895396.9236; train_masked_gp_l1_reg_loss: 8176.9836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28111.6378; train_chrom_access_recon_loss: 1351388.2361; train_global_loss: 2603086.0278; train_optim_loss: 2603086.0278; val_kl_reg_loss: 19654.3379; val_edge_recon_loss: 295340.1875; val_gene_expr_recon_loss: 897379.6875; val_masked_gp_l1_reg_loss: 8279.2295; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27015.2637; val_chrom_access_recon_loss: 1356305.7500; val_global_loss: 2603974.5000; val_optim_loss: 2603974.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9298; val_auprc_score: 0.9111; val_best_acc_score: 0.8548; val_best_f1_score: 0.8625; train_kl_reg_loss: 23812.5866; train_edge_recon_loss: 295422.8194; train_gene_expr_recon_loss: 890964.6667; train_masked_gp_l1_reg_loss: 8253.3729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26843.1322; train_chrom_access_recon_loss: 1348062.9583; train_global_loss: 2593359.5000; train_optim_loss: 2593359.5000; val_kl_reg_loss: 19683.4863; val_edge_recon_loss: 295152.1250; val_gene_expr_recon_loss: 896750.9375; val_masked_gp_l1_reg_loss: 8230.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26650.6016; val_chrom_access_recon_loss: 1355940.5000; val_global_loss: 2602408.0000; val_optim_loss: 2602408.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9355; val_auprc_score: 0.9210; val_best_acc_score: 0.8628; val_best_f1_score: 0.8684; train_kl_reg_loss: 23678.7211; train_edge_recon_loss: 295959.5972; train_gene_expr_recon_loss: 890220.0903; train_masked_gp_l1_reg_loss: 8228.0418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26534.1984; train_chrom_access_recon_loss: 1349486.9167; train_global_loss: 2594107.5556; train_optim_loss: 2594107.5556; val_kl_reg_loss: 19523.9199; val_edge_recon_loss: 296770.4375; val_gene_expr_recon_loss: 896464.1250; val_masked_gp_l1_reg_loss: 8221.7510; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26384.2012; val_chrom_access_recon_loss: 1355775.5000; val_global_loss: 2603140.0000; val_optim_loss: 2603140.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9376; val_auprc_score: 0.9255; val_best_acc_score: 0.8646; val_best_f1_score: 0.8713; train_kl_reg_loss: 23505.4464; train_edge_recon_loss: 295884.2361; train_gene_expr_recon_loss: 896022.9861; train_masked_gp_l1_reg_loss: 8219.6071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26276.4690; train_chrom_access_recon_loss: 1353483.1806; train_global_loss: 2603391.9444; train_optim_loss: 2603391.9444; val_kl_reg_loss: 19456.2676; val_edge_recon_loss: 296939.7188; val_gene_expr_recon_loss: 896106.1250; val_masked_gp_l1_reg_loss: 8217.7793; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26145.4609; val_chrom_access_recon_loss: 1355460.0000; val_global_loss: 2602325.5000; val_optim_loss: 2602325.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9346; val_auprc_score: 0.9186; val_best_acc_score: 0.8641; val_best_f1_score: 0.8697; train_kl_reg_loss: 23368.2409; train_edge_recon_loss: 296563.2431; train_gene_expr_recon_loss: 898115.8333; train_masked_gp_l1_reg_loss: 8217.8202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26046.8735; train_chrom_access_recon_loss: 1359561.0417; train_global_loss: 2611873.1111; train_optim_loss: 2611873.1111; val_kl_reg_loss: 19355.1680; val_edge_recon_loss: 297351.5625; val_gene_expr_recon_loss: 895863.6875; val_masked_gp_l1_reg_loss: 8218.6348; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25929.4238; val_chrom_access_recon_loss: 1355775.0000; val_global_loss: 2602493.5000; val_optim_loss: 2602493.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 37 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9366
val AUPRC score: 0.9222
val best accuracy score: 0.8636
val best F1 score: 0.8717
val target rna MSE score: 3.9057
val source rna MSE score: 3.2178
val target atac MSE score: 0.1378
val source atac MSE score: 0.0200
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
