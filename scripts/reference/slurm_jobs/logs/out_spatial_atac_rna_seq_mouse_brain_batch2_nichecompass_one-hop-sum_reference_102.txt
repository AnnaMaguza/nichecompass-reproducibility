[True]
Run timestamp: 10082023_234127_102.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_102']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7724; val_auprc_score: 0.7934; val_best_acc_score: 0.5098; val_best_f1_score: 0.6699; train_kl_reg_loss: 99588.7004; train_edge_recon_loss: 3825990.0630; train_gene_expr_recon_loss: 45638973.7710; train_masked_gp_l1_reg_loss: 90150.5467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245903.9921; train_chrom_access_recon_loss: 27575650.1985; train_global_loss: 77476257.0992; train_optim_loss: 77476257.0992; val_kl_reg_loss: 146037.7984; val_edge_recon_loss: 4064239.2000; val_gene_expr_recon_loss: 38612836.5333; val_masked_gp_l1_reg_loss: 88066.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 241588.3281; val_chrom_access_recon_loss: 26112568.1333; val_global_loss: 69265337.8667; val_optim_loss: 69265337.8667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7909; val_auprc_score: 0.8111; val_best_acc_score: 0.6322; val_best_f1_score: 0.7163; train_kl_reg_loss: 170970.5438; train_edge_recon_loss: 3693578.7901; train_gene_expr_recon_loss: 38181853.7405; train_masked_gp_l1_reg_loss: 85039.7594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 235402.7741; train_chrom_access_recon_loss: 25842753.6336; train_global_loss: 68209599.7557; train_optim_loss: 68209599.7557; val_kl_reg_loss: 213609.1677; val_edge_recon_loss: 4057053.3000; val_gene_expr_recon_loss: 37108873.3333; val_masked_gp_l1_reg_loss: 81804.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 228394.7500; val_chrom_access_recon_loss: 25709301.7333; val_global_loss: 67399037.8667; val_optim_loss: 67399037.8667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8663; val_auprc_score: 0.8662; val_best_acc_score: 0.7529; val_best_f1_score: 0.7544; train_kl_reg_loss: 190660.4482; train_edge_recon_loss: 3570870.4218; train_gene_expr_recon_loss: 37061533.8321; train_masked_gp_l1_reg_loss: 80833.6096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 221225.9645; train_chrom_access_recon_loss: 25551695.2977; train_global_loss: 66676820.0000; train_optim_loss: 66676820.0000; val_kl_reg_loss: 167675.1333; val_edge_recon_loss: 4000746.1833; val_gene_expr_recon_loss: 36603144.8000; val_masked_gp_l1_reg_loss: 80775.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 214022.0156; val_chrom_access_recon_loss: 25554713.8667; val_global_loss: 66621078.9333; val_optim_loss: 66621078.9333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9002; val_auprc_score: 0.8934; val_best_acc_score: 0.8146; val_best_f1_score: 0.8287; train_kl_reg_loss: 161036.1106; train_edge_recon_loss: 3507833.8111; train_gene_expr_recon_loss: 36670268.9771; train_masked_gp_l1_reg_loss: 82126.4111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 207143.9255; train_chrom_access_recon_loss: 25370595.8321; train_global_loss: 65999005.0992; train_optim_loss: 65999005.0992; val_kl_reg_loss: 137614.6458; val_edge_recon_loss: 3489632.7500; val_gene_expr_recon_loss: 36553772.2667; val_masked_gp_l1_reg_loss: 83609.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 200351.3750; val_chrom_access_recon_loss: 25522613.6000; val_global_loss: 65987593.3333; val_optim_loss: 65987593.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8993; val_auprc_score: 0.8865; val_best_acc_score: 0.8174; val_best_f1_score: 0.8309; train_kl_reg_loss: 174971.4301; train_edge_recon_loss: 3118160.1527; train_gene_expr_recon_loss: 36412483.3588; train_masked_gp_l1_reg_loss: 85174.7604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 194300.1688; train_chrom_access_recon_loss: 25234510.5344; train_global_loss: 65219600.3359; train_optim_loss: 65219600.3359; val_kl_reg_loss: 191766.1094; val_edge_recon_loss: 3045487.2000; val_gene_expr_recon_loss: 36237208.5333; val_masked_gp_l1_reg_loss: 86289.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 188584.1875; val_chrom_access_recon_loss: 25328435.7333; val_global_loss: 65077768.8000; val_optim_loss: 65077768.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9114; val_auprc_score: 0.9019; val_best_acc_score: 0.8270; val_best_f1_score: 0.8419; train_kl_reg_loss: 188719.6758; train_edge_recon_loss: 2988659.0324; train_gene_expr_recon_loss: 36153000.4580; train_masked_gp_l1_reg_loss: 87092.8841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 183378.6100; train_chrom_access_recon_loss: 25073954.9313; train_global_loss: 64674805.8321; train_optim_loss: 64674805.8321; val_kl_reg_loss: 184487.6490; val_edge_recon_loss: 3000850.0500; val_gene_expr_recon_loss: 35753637.2000; val_masked_gp_l1_reg_loss: 88171.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178225.7188; val_chrom_access_recon_loss: 25051202.0000; val_global_loss: 64256572.5333; val_optim_loss: 64256572.5333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9222; val_auprc_score: 0.9082; val_best_acc_score: 0.8518; val_best_f1_score: 0.8577; train_kl_reg_loss: 185517.1827; train_edge_recon_loss: 2941892.9580; train_gene_expr_recon_loss: 35927930.7176; train_masked_gp_l1_reg_loss: 89169.1481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 173037.2925; train_chrom_access_recon_loss: 24975867.8626; train_global_loss: 64293415.2977; train_optim_loss: 64293415.2977; val_kl_reg_loss: 182723.7771; val_edge_recon_loss: 2952959.3833; val_gene_expr_recon_loss: 35675744.8000; val_masked_gp_l1_reg_loss: 90369.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167811.7188; val_chrom_access_recon_loss: 24942606.5333; val_global_loss: 64012214.6667; val_optim_loss: 64012214.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9321; val_auprc_score: 0.9209; val_best_acc_score: 0.8600; val_best_f1_score: 0.8691; train_kl_reg_loss: 181903.4275; train_edge_recon_loss: 2898309.4351; train_gene_expr_recon_loss: 35774375.3282; train_masked_gp_l1_reg_loss: 91514.0246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 162873.7267; train_chrom_access_recon_loss: 24885433.6031; train_global_loss: 63994409.6183; train_optim_loss: 63994409.6183; val_kl_reg_loss: 177226.9979; val_edge_recon_loss: 2911900.6833; val_gene_expr_recon_loss: 35369572.8000; val_masked_gp_l1_reg_loss: 92762.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158087.5000; val_chrom_access_recon_loss: 24910753.6000; val_global_loss: 63620305.6000; val_optim_loss: 63620305.6000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9306; val_auprc_score: 0.9199; val_best_acc_score: 0.8600; val_best_f1_score: 0.8674; train_kl_reg_loss: 178216.1360; train_edge_recon_loss: 2875536.2824; train_gene_expr_recon_loss: 35574613.1450; train_masked_gp_l1_reg_loss: 93604.1913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153553.8671; train_chrom_access_recon_loss: 24770956.2290; train_global_loss: 63646479.7252; train_optim_loss: 63646479.7252; val_kl_reg_loss: 174112.2375; val_edge_recon_loss: 2917561.3333; val_gene_expr_recon_loss: 35311272.2667; val_masked_gp_l1_reg_loss: 94562.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149122.0312; val_chrom_access_recon_loss: 24805104.0000; val_global_loss: 63451738.4000; val_optim_loss: 63451738.4000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9400; val_auprc_score: 0.9302; val_best_acc_score: 0.8688; val_best_f1_score: 0.8765; train_kl_reg_loss: 171929.5887; train_edge_recon_loss: 2864402.9790; train_gene_expr_recon_loss: 35481376.3969; train_masked_gp_l1_reg_loss: 95681.3491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145052.1540; train_chrom_access_recon_loss: 24740048.8702; train_global_loss: 63498491.5420; train_optim_loss: 63498491.5420; val_kl_reg_loss: 164562.8552; val_edge_recon_loss: 2868313.1000; val_gene_expr_recon_loss: 35368543.7333; val_masked_gp_l1_reg_loss: 96809.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141012.7969; val_chrom_access_recon_loss: 24816768.6667; val_global_loss: 63456008.8000; val_optim_loss: 63456008.8000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9456; val_auprc_score: 0.9352; val_best_acc_score: 0.8759; val_best_f1_score: 0.8818; train_kl_reg_loss: 165157.6464; train_edge_recon_loss: 2853788.4294; train_gene_expr_recon_loss: 35373304.7176; train_masked_gp_l1_reg_loss: 97914.2579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137340.3451; train_chrom_access_recon_loss: 24679727.0687; train_global_loss: 63307232.4580; train_optim_loss: 63307232.4580; val_kl_reg_loss: 161945.3260; val_edge_recon_loss: 2869146.6167; val_gene_expr_recon_loss: 35127955.4667; val_masked_gp_l1_reg_loss: 98809.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133786.6406; val_chrom_access_recon_loss: 24690287.7333; val_global_loss: 63081930.4000; val_optim_loss: 63081930.4000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9471; val_auprc_score: 0.9375; val_best_acc_score: 0.8798; val_best_f1_score: 0.8847; train_kl_reg_loss: 162202.7148; train_edge_recon_loss: 2842577.4771; train_gene_expr_recon_loss: 35195022.5954; train_masked_gp_l1_reg_loss: 99880.0086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130540.8626; train_chrom_access_recon_loss: 24573761.8626; train_global_loss: 63003985.2824; train_optim_loss: 63003985.2824; val_kl_reg_loss: 158804.3750; val_edge_recon_loss: 2842482.5000; val_gene_expr_recon_loss: 35023780.8000; val_masked_gp_l1_reg_loss: 101073.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127392.1641; val_chrom_access_recon_loss: 24652699.4667; val_global_loss: 62906230.9333; val_optim_loss: 62906230.9333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9503; val_auprc_score: 0.9420; val_best_acc_score: 0.8864; val_best_f1_score: 0.8921; train_kl_reg_loss: 159145.2767; train_edge_recon_loss: 2822086.3588; train_gene_expr_recon_loss: 35149694.8092; train_masked_gp_l1_reg_loss: 101877.9875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124539.2372; train_chrom_access_recon_loss: 24559253.3893; train_global_loss: 62916597.1298; train_optim_loss: 62916597.1298; val_kl_reg_loss: 158542.1375; val_edge_recon_loss: 2826657.3167; val_gene_expr_recon_loss: 34841045.3333; val_masked_gp_l1_reg_loss: 102703.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121751.1719; val_chrom_access_recon_loss: 24578107.4667; val_global_loss: 62628808.2667; val_optim_loss: 62628808.2667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9524; val_auprc_score: 0.9414; val_best_acc_score: 0.8856; val_best_f1_score: 0.8922; train_kl_reg_loss: 155636.0893; train_edge_recon_loss: 2808827.4485; train_gene_expr_recon_loss: 35015060.8092; train_masked_gp_l1_reg_loss: 103737.7789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119126.1261; train_chrom_access_recon_loss: 24489923.4656; train_global_loss: 62692311.9695; train_optim_loss: 62692311.9695; val_kl_reg_loss: 156522.9156; val_edge_recon_loss: 2811288.1500; val_gene_expr_recon_loss: 34728456.6667; val_masked_gp_l1_reg_loss: 104841.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116584.0547; val_chrom_access_recon_loss: 24502196.2667; val_global_loss: 62419888.5333; val_optim_loss: 62419888.5333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9581; val_auprc_score: 0.9482; val_best_acc_score: 0.8960; val_best_f1_score: 0.8999; train_kl_reg_loss: 152266.3705; train_edge_recon_loss: 2805823.7137; train_gene_expr_recon_loss: 34945327.9847; train_masked_gp_l1_reg_loss: 105620.2620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114176.0599; train_chrom_access_recon_loss: 24446883.2366; train_global_loss: 62570097.5573; train_optim_loss: 62570097.5573; val_kl_reg_loss: 151525.6115; val_edge_recon_loss: 2809279.4667; val_gene_expr_recon_loss: 34845519.4667; val_masked_gp_l1_reg_loss: 106449.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111750.9766; val_chrom_access_recon_loss: 24662022.8000; val_global_loss: 62686547.4667; val_optim_loss: 62686547.4667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9595; val_auprc_score: 0.9505; val_best_acc_score: 0.8983; val_best_f1_score: 0.9012; train_kl_reg_loss: 148315.1333; train_edge_recon_loss: 2801128.1221; train_gene_expr_recon_loss: 34855719.6794; train_masked_gp_l1_reg_loss: 107283.2706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109403.5957; train_chrom_access_recon_loss: 24395626.4275; train_global_loss: 62417476.3969; train_optim_loss: 62417476.3969; val_kl_reg_loss: 146370.0896; val_edge_recon_loss: 2800016.4500; val_gene_expr_recon_loss: 34711165.0667; val_masked_gp_l1_reg_loss: 108344.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107088.5156; val_chrom_access_recon_loss: 24542176.0000; val_global_loss: 62415160.0000; val_optim_loss: 62415160.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9617; val_auprc_score: 0.9558; val_best_acc_score: 0.8988; val_best_f1_score: 0.9022; train_kl_reg_loss: 145331.0302; train_edge_recon_loss: 2788348.8073; train_gene_expr_recon_loss: 34779651.0382; train_masked_gp_l1_reg_loss: 109130.1936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104921.9507; train_chrom_access_recon_loss: 24359693.3435; train_global_loss: 62287076.3664; train_optim_loss: 62287076.3664; val_kl_reg_loss: 142301.5375; val_edge_recon_loss: 2797441.2167; val_gene_expr_recon_loss: 34567571.2000; val_masked_gp_l1_reg_loss: 110170.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102769.7422; val_chrom_access_recon_loss: 24291552.2667; val_global_loss: 62011806.4000; val_optim_loss: 62011806.4000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9617; val_auprc_score: 0.9550; val_best_acc_score: 0.8976; val_best_f1_score: 0.9021; train_kl_reg_loss: 143921.2043; train_edge_recon_loss: 2775390.2424; train_gene_expr_recon_loss: 34745966.3511; train_masked_gp_l1_reg_loss: 110974.8302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100695.9228; train_chrom_access_recon_loss: 24360404.8855; train_global_loss: 62237353.8015; train_optim_loss: 62237353.8015; val_kl_reg_loss: 143603.6708; val_edge_recon_loss: 2789935.5833; val_gene_expr_recon_loss: 34559329.6000; val_masked_gp_l1_reg_loss: 111945.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98732.1562; val_chrom_access_recon_loss: 24382092.8000; val_global_loss: 62085638.1333; val_optim_loss: 62085638.1333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9631; val_auprc_score: 0.9547; val_best_acc_score: 0.9030; val_best_f1_score: 0.9073; train_kl_reg_loss: 140640.5283; train_edge_recon_loss: 2781847.5821; train_gene_expr_recon_loss: 34665294.9008; train_masked_gp_l1_reg_loss: 112695.3733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96900.5411; train_chrom_access_recon_loss: 24323227.6641; train_global_loss: 62120606.6870; train_optim_loss: 62120606.6870; val_kl_reg_loss: 138575.5594; val_edge_recon_loss: 2778688.2333; val_gene_expr_recon_loss: 34402247.6000; val_masked_gp_l1_reg_loss: 113377.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94992.4688; val_chrom_access_recon_loss: 24399780.8000; val_global_loss: 61927660.5333; val_optim_loss: 61927660.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9655; val_auprc_score: 0.9593; val_best_acc_score: 0.9069; val_best_f1_score: 0.9109; train_kl_reg_loss: 136782.7823; train_edge_recon_loss: 2782465.0172; train_gene_expr_recon_loss: 34642666.1527; train_masked_gp_l1_reg_loss: 114399.3799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93343.6840; train_chrom_access_recon_loss: 24320059.4962; train_global_loss: 62089716.7023; train_optim_loss: 62089716.7023; val_kl_reg_loss: 132266.8297; val_edge_recon_loss: 2760759.5500; val_gene_expr_recon_loss: 34515638.1333; val_masked_gp_l1_reg_loss: 115224.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91776.9688; val_chrom_access_recon_loss: 24432025.8667; val_global_loss: 62047689.6000; val_optim_loss: 62047689.6000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9649; val_auprc_score: 0.9540; val_best_acc_score: 0.9086; val_best_f1_score: 0.9121; train_kl_reg_loss: 135338.6778; train_edge_recon_loss: 2767765.6221; train_gene_expr_recon_loss: 34549364.5954; train_masked_gp_l1_reg_loss: 116129.6651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90242.1511; train_chrom_access_recon_loss: 24243195.9847; train_global_loss: 61902036.7634; train_optim_loss: 61902036.7634; val_kl_reg_loss: 131693.9255; val_edge_recon_loss: 2775154.5500; val_gene_expr_recon_loss: 34389835.4667; val_masked_gp_l1_reg_loss: 116916.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88809.7891; val_chrom_access_recon_loss: 24382695.7333; val_global_loss: 61885103.7333; val_optim_loss: 61885103.7333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9658; val_auprc_score: 0.9588; val_best_acc_score: 0.9127; val_best_f1_score: 0.9140; train_kl_reg_loss: 134264.8961; train_edge_recon_loss: 2762529.3435; train_gene_expr_recon_loss: 34521127.6641; train_masked_gp_l1_reg_loss: 117766.9789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87464.9565; train_chrom_access_recon_loss: 24256664.2290; train_global_loss: 61879818.1069; train_optim_loss: 61879818.1069; val_kl_reg_loss: 130730.9698; val_edge_recon_loss: 2775091.1500; val_gene_expr_recon_loss: 34305154.8000; val_masked_gp_l1_reg_loss: 118679.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86122.0156; val_chrom_access_recon_loss: 24271559.3333; val_global_loss: 61687340.0000; val_optim_loss: 61687340.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9712; val_auprc_score: 0.9651; val_best_acc_score: 0.9153; val_best_f1_score: 0.9184; train_kl_reg_loss: 131111.5751; train_edge_recon_loss: 2754550.7195; train_gene_expr_recon_loss: 34399593.2977; train_masked_gp_l1_reg_loss: 119582.2086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84923.2247; train_chrom_access_recon_loss: 24169359.5573; train_global_loss: 61659120.7023; train_optim_loss: 61659120.7023; val_kl_reg_loss: 130446.5250; val_edge_recon_loss: 2756070.8833; val_gene_expr_recon_loss: 34453710.4000; val_masked_gp_l1_reg_loss: 120363.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83692.1641; val_chrom_access_recon_loss: 24464558.1333; val_global_loss: 62008841.8667; val_optim_loss: 62008841.8667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9698; val_auprc_score: 0.9641; val_best_acc_score: 0.9140; val_best_f1_score: 0.9176; train_kl_reg_loss: 130447.8009; train_edge_recon_loss: 2752563.3015; train_gene_expr_recon_loss: 34394340.6107; train_masked_gp_l1_reg_loss: 121205.0291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82553.9915; train_chrom_access_recon_loss: 24187314.8397; train_global_loss: 61668425.7099; train_optim_loss: 61668425.7099; val_kl_reg_loss: 127784.3146; val_edge_recon_loss: 2763657.5000; val_gene_expr_recon_loss: 34269994.9333; val_masked_gp_l1_reg_loss: 122109.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81439.7734; val_chrom_access_recon_loss: 24259710.0000; val_global_loss: 61624694.4000; val_optim_loss: 61624694.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9723; val_auprc_score: 0.9660; val_best_acc_score: 0.9201; val_best_f1_score: 0.9226; train_kl_reg_loss: 129163.0928; train_edge_recon_loss: 2748570.4179; train_gene_expr_recon_loss: 34349904.3664; train_masked_gp_l1_reg_loss: 122858.8948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80423.2038; train_chrom_access_recon_loss: 24175677.2061; train_global_loss: 61606597.1908; train_optim_loss: 61606597.1908; val_kl_reg_loss: 127210.4828; val_edge_recon_loss: 2758173.0667; val_gene_expr_recon_loss: 34191911.6000; val_masked_gp_l1_reg_loss: 123659.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79405.4297; val_chrom_access_recon_loss: 24325672.1333; val_global_loss: 61606031.4667; val_optim_loss: 61606031.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9697; val_auprc_score: 0.9650; val_best_acc_score: 0.9091; val_best_f1_score: 0.9118; train_kl_reg_loss: 143389.7865; train_edge_recon_loss: 2837631.0668; train_gene_expr_recon_loss: 36295343.9389; train_masked_gp_l1_reg_loss: 124095.4567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80877.2514; train_chrom_access_recon_loss: 24675403.2061; train_global_loss: 64156740.6412; train_optim_loss: 64156740.6412; val_kl_reg_loss: 61340.0052; val_edge_recon_loss: 2819533.8167; val_gene_expr_recon_loss: 35959742.1333; val_masked_gp_l1_reg_loss: 124373.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81138.8438; val_chrom_access_recon_loss: 24695200.4000; val_global_loss: 63741328.8000; val_optim_loss: 63741328.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9670; val_auprc_score: 0.9607; val_best_acc_score: 0.9107; val_best_f1_score: 0.9131; train_kl_reg_loss: 135374.0775; train_edge_recon_loss: 2785521.5782; train_gene_expr_recon_loss: 35934028.0000; train_masked_gp_l1_reg_loss: 124317.9599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80171.5420; train_chrom_access_recon_loss: 24548580.1221; train_global_loss: 63607993.3435; train_optim_loss: 63607993.3435; val_kl_reg_loss: 70171.5620; val_edge_recon_loss: 2788960.7000; val_gene_expr_recon_loss: 35695586.4000; val_masked_gp_l1_reg_loss: 124149.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79076.0391; val_chrom_access_recon_loss: 24610422.2667; val_global_loss: 63368364.8000; val_optim_loss: 63368364.8000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9643; val_auprc_score: 0.9567; val_best_acc_score: 0.9060; val_best_f1_score: 0.9097; train_kl_reg_loss: 125198.2044; train_edge_recon_loss: 2762908.6279; train_gene_expr_recon_loss: 35806220.1069; train_masked_gp_l1_reg_loss: 123731.7403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77858.0308; train_chrom_access_recon_loss: 24507801.8473; train_global_loss: 63403718.5344; train_optim_loss: 63403718.5344; val_kl_reg_loss: 75626.3198; val_edge_recon_loss: 2775141.0167; val_gene_expr_recon_loss: 35733574.1333; val_masked_gp_l1_reg_loss: 123318.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76724.1562; val_chrom_access_recon_loss: 24686091.3333; val_global_loss: 63470476.2667; val_optim_loss: 63470476.2667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9653; val_auprc_score: 0.9586; val_best_acc_score: 0.9056; val_best_f1_score: 0.9100; train_kl_reg_loss: 117279.9664; train_edge_recon_loss: 2759245.7328; train_gene_expr_recon_loss: 35730369.0687; train_masked_gp_l1_reg_loss: 122868.8890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75542.1769; train_chrom_access_recon_loss: 24456962.1527; train_global_loss: 63262267.9389; train_optim_loss: 63262267.9389; val_kl_reg_loss: 72142.8167; val_edge_recon_loss: 2772069.9333; val_gene_expr_recon_loss: 35565260.8000; val_masked_gp_l1_reg_loss: 122414.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74175.2422; val_chrom_access_recon_loss: 24502208.6667; val_global_loss: 63108274.9333; val_optim_loss: 63108274.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9688; val_auprc_score: 0.9606; val_best_acc_score: 0.9108; val_best_f1_score: 0.9142; train_kl_reg_loss: 111020.6948; train_edge_recon_loss: 2747441.5115; train_gene_expr_recon_loss: 35624341.8015; train_masked_gp_l1_reg_loss: 122045.0615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73876.8836; train_chrom_access_recon_loss: 24435523.6336; train_global_loss: 63114249.1603; train_optim_loss: 63114249.1603; val_kl_reg_loss: 80205.0333; val_edge_recon_loss: 2749140.1500; val_gene_expr_recon_loss: 35656646.6667; val_masked_gp_l1_reg_loss: 121879.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73617.8828; val_chrom_access_recon_loss: 24705965.8667; val_global_loss: 63387453.6000; val_optim_loss: 63387453.6000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9670; val_auprc_score: 0.9599; val_best_acc_score: 0.9105; val_best_f1_score: 0.9140; train_kl_reg_loss: 113768.8640; train_edge_recon_loss: 2743237.7939; train_gene_expr_recon_loss: 35638100.6412; train_masked_gp_l1_reg_loss: 121764.6710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73392.9169; train_chrom_access_recon_loss: 24458606.7023; train_global_loss: 63148871.5115; train_optim_loss: 63148871.5115; val_kl_reg_loss: 80880.6000; val_edge_recon_loss: 2756686.0000; val_gene_expr_recon_loss: 35505413.3333; val_masked_gp_l1_reg_loss: 121661.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73159.7812; val_chrom_access_recon_loss: 24591453.7333; val_global_loss: 63129253.6000; val_optim_loss: 63129253.6000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9705; val_auprc_score: 0.9654; val_best_acc_score: 0.9112; val_best_f1_score: 0.9147; train_kl_reg_loss: 113773.1020; train_edge_recon_loss: 2742409.5706; train_gene_expr_recon_loss: 35583361.7252; train_masked_gp_l1_reg_loss: 121567.2319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72945.8311; train_chrom_access_recon_loss: 24439664.8092; train_global_loss: 63073722.0153; train_optim_loss: 63073722.0153; val_kl_reg_loss: 81517.3323; val_edge_recon_loss: 2752281.3667; val_gene_expr_recon_loss: 35432676.8000; val_masked_gp_l1_reg_loss: 121465.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72722.8984; val_chrom_access_recon_loss: 24504458.4000; val_global_loss: 62965120.5333; val_optim_loss: 62965120.5333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9665; val_auprc_score: 0.9603; val_best_acc_score: 0.9099; val_best_f1_score: 0.9136; train_kl_reg_loss: 113003.8839; train_edge_recon_loss: 2740375.6889; train_gene_expr_recon_loss: 35585378.2290; train_masked_gp_l1_reg_loss: 121356.2030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72506.3964; train_chrom_access_recon_loss: 24421140.8092; train_global_loss: 63053761.0382; train_optim_loss: 63053761.0382; val_kl_reg_loss: 82971.6104; val_edge_recon_loss: 2766865.6667; val_gene_expr_recon_loss: 35399083.4667; val_masked_gp_l1_reg_loss: 121252.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72274.6328; val_chrom_access_recon_loss: 24512021.4667; val_global_loss: 62954470.9333; val_optim_loss: 62954470.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 33 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9706
val AUPRC score: 0.9656
val best accuracy score: 0.9174
val best F1 score: 0.9195
val target rna MSE score: 1.6852
val source rna MSE score: 78.5943
val target atac MSE score: 0.3552
val source atac MSE score: 3.2521
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
