[True]
Run timestamp: 07092023_135041_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3394 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7897, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6712; val_auprc_score: 0.6458; val_best_acc_score: 0.5083; val_best_f1_score: 0.6702; train_kl_reg_loss: 58005.2342; train_edge_recon_loss: 3532981.1515; train_gene_expr_recon_loss: 16555939.7879; train_masked_gp_l1_reg_loss: 85347.7356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1464549.6250; train_chrom_access_recon_loss: 2996070.2614; train_global_loss: 24692893.6970; train_optim_loss: 24692893.6970; val_kl_reg_loss: 110603.6533; val_edge_recon_loss: 4064847.5312; val_gene_expr_recon_loss: 14969100.3750; val_masked_gp_l1_reg_loss: 79624.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1111164.7500; val_chrom_access_recon_loss: 2900572.7500; val_global_loss: 23235912.2500; val_optim_loss: 23235912.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6909; val_auprc_score: 0.6779; val_best_acc_score: 0.5634; val_best_f1_score: 0.6902; train_kl_reg_loss: 113081.1888; train_edge_recon_loss: 3535319.8220; train_gene_expr_recon_loss: 14793652.2121; train_masked_gp_l1_reg_loss: 74848.7380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 815612.3011; train_chrom_access_recon_loss: 2823339.8030; train_global_loss: 22155853.9697; train_optim_loss: 22155853.9697; val_kl_reg_loss: 105433.3740; val_edge_recon_loss: 4061368.7500; val_gene_expr_recon_loss: 14794676.7500; val_masked_gp_l1_reg_loss: 72687.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 569648.0625; val_chrom_access_recon_loss: 2905802.6875; val_global_loss: 22509617.2500; val_optim_loss: 22509617.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7877; val_auprc_score: 0.7740; val_best_acc_score: 0.6760; val_best_f1_score: 0.7352; train_kl_reg_loss: 103579.2720; train_edge_recon_loss: 3524297.5985; train_gene_expr_recon_loss: 14593893.6970; train_masked_gp_l1_reg_loss: 72592.9413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 428941.1406; train_chrom_access_recon_loss: 2797694.8750; train_global_loss: 21520999.5758; train_optim_loss: 21520999.5758; val_kl_reg_loss: 103991.9521; val_edge_recon_loss: 4050228.9688; val_gene_expr_recon_loss: 14485315.7500; val_masked_gp_l1_reg_loss: 73278.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 317849.5625; val_chrom_access_recon_loss: 2847219.9688; val_global_loss: 21877884.5000; val_optim_loss: 21877884.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8324; val_auprc_score: 0.8144; val_best_acc_score: 0.7200; val_best_f1_score: 0.7644; train_kl_reg_loss: 92395.4228; train_edge_recon_loss: 3511154.8864; train_gene_expr_recon_loss: 14481066.7879; train_masked_gp_l1_reg_loss: 74861.5904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 254003.0897; train_chrom_access_recon_loss: 2778839.5682; train_global_loss: 21192321.2727; train_optim_loss: 21192321.2727; val_kl_reg_loss: 79796.0811; val_edge_recon_loss: 3924128.5312; val_gene_expr_recon_loss: 14533408.0000; val_masked_gp_l1_reg_loss: 76989.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 203349.2344; val_chrom_access_recon_loss: 2856583.3750; val_global_loss: 21674256.0000; val_optim_loss: 21674256.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8269; val_auprc_score: 0.7922; val_best_acc_score: 0.7491; val_best_f1_score: 0.7901; train_kl_reg_loss: 73224.5577; train_edge_recon_loss: 3353167.6818; train_gene_expr_recon_loss: 14405454.7424; train_masked_gp_l1_reg_loss: 80018.3422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 173135.0866; train_chrom_access_recon_loss: 2766790.0568; train_global_loss: 20851790.6364; train_optim_loss: 20851790.6364; val_kl_reg_loss: 75587.5107; val_edge_recon_loss: 3173561.3125; val_gene_expr_recon_loss: 14520081.7500; val_masked_gp_l1_reg_loss: 83806.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147940.5469; val_chrom_access_recon_loss: 2859443.8125; val_global_loss: 20860420.0000; val_optim_loss: 20860420.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8450; val_auprc_score: 0.8059; val_best_acc_score: 0.7630; val_best_f1_score: 0.7926; train_kl_reg_loss: 77892.4579; train_edge_recon_loss: 3141300.9659; train_gene_expr_recon_loss: 14417681.8636; train_masked_gp_l1_reg_loss: 88486.2056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133516.5620; train_chrom_access_recon_loss: 2764755.7121; train_global_loss: 20623633.5758; train_optim_loss: 20623633.5758; val_kl_reg_loss: 89104.3506; val_edge_recon_loss: 3043849.1562; val_gene_expr_recon_loss: 14303874.0000; val_masked_gp_l1_reg_loss: 91602.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118945.8281; val_chrom_access_recon_loss: 2800500.9062; val_global_loss: 20447876.7500; val_optim_loss: 20447876.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8431; val_auprc_score: 0.8006; val_best_acc_score: 0.7644; val_best_f1_score: 0.7881; train_kl_reg_loss: 102315.5201; train_edge_recon_loss: 2960982.7273; train_gene_expr_recon_loss: 14275177.5152; train_masked_gp_l1_reg_loss: 91925.0840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105686.1087; train_chrom_access_recon_loss: 2742509.6818; train_global_loss: 20278596.7576; train_optim_loss: 20278596.7576; val_kl_reg_loss: 105640.7354; val_edge_recon_loss: 2981012.2500; val_gene_expr_recon_loss: 14329697.5000; val_masked_gp_l1_reg_loss: 93407.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95242.7031; val_chrom_access_recon_loss: 2781948.8438; val_global_loss: 20386949.7500; val_optim_loss: 20386949.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8536; val_auprc_score: 0.8065; val_best_acc_score: 0.7778; val_best_f1_score: 0.7996; train_kl_reg_loss: 104855.5166; train_edge_recon_loss: 2947927.4697; train_gene_expr_recon_loss: 14187453.0758; train_masked_gp_l1_reg_loss: 94443.2466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87737.2599; train_chrom_access_recon_loss: 2725752.3598; train_global_loss: 20148168.9394; train_optim_loss: 20148168.9394; val_kl_reg_loss: 106097.8984; val_edge_recon_loss: 2962060.0000; val_gene_expr_recon_loss: 14243247.1250; val_masked_gp_l1_reg_loss: 95468.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80611.2500; val_chrom_access_recon_loss: 2760754.2188; val_global_loss: 20248239.2500; val_optim_loss: 20248239.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8638; val_auprc_score: 0.8235; val_best_acc_score: 0.7918; val_best_f1_score: 0.8135; train_kl_reg_loss: 103011.1928; train_edge_recon_loss: 2930531.4848; train_gene_expr_recon_loss: 14118362.7727; train_masked_gp_l1_reg_loss: 96455.1083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75379.3537; train_chrom_access_recon_loss: 2715220.2235; train_global_loss: 20038959.9394; train_optim_loss: 20038959.9394; val_kl_reg_loss: 103727.1035; val_edge_recon_loss: 2928701.0938; val_gene_expr_recon_loss: 14084002.0000; val_masked_gp_l1_reg_loss: 97524.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70754.1172; val_chrom_access_recon_loss: 2784374.3125; val_global_loss: 20069082.0000; val_optim_loss: 20069082.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8861; val_auprc_score: 0.8517; val_best_acc_score: 0.8173; val_best_f1_score: 0.8337; train_kl_reg_loss: 103896.2508; train_edge_recon_loss: 2864960.3182; train_gene_expr_recon_loss: 14054904.7879; train_masked_gp_l1_reg_loss: 98516.2537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67276.6668; train_chrom_access_recon_loss: 2702872.5076; train_global_loss: 19892426.7879; train_optim_loss: 19892426.7879; val_kl_reg_loss: 106470.5254; val_edge_recon_loss: 2890873.6875; val_gene_expr_recon_loss: 14173576.6250; val_masked_gp_l1_reg_loss: 99364.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64124.9883; val_chrom_access_recon_loss: 2778734.1875; val_global_loss: 20113143.7500; val_optim_loss: 20113143.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9023; val_auprc_score: 0.8738; val_best_acc_score: 0.8391; val_best_f1_score: 0.8527; train_kl_reg_loss: 103598.5675; train_edge_recon_loss: 2859025.7159; train_gene_expr_recon_loss: 14008428.3788; train_masked_gp_l1_reg_loss: 100312.1272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61405.0855; train_chrom_access_recon_loss: 2693553.5455; train_global_loss: 19826323.3939; train_optim_loss: 19826323.3939; val_kl_reg_loss: 103448.2676; val_edge_recon_loss: 2850587.5000; val_gene_expr_recon_loss: 13959053.6250; val_masked_gp_l1_reg_loss: 101468.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59311.0352; val_chrom_access_recon_loss: 2738027.6250; val_global_loss: 19811897.0000; val_optim_loss: 19811897.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8987; val_auprc_score: 0.8639; val_best_acc_score: 0.8358; val_best_f1_score: 0.8481; train_kl_reg_loss: 103453.3700; train_edge_recon_loss: 2830407.4432; train_gene_expr_recon_loss: 13944954.1515; train_masked_gp_l1_reg_loss: 102100.1370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57301.0033; train_chrom_access_recon_loss: 2679713.9773; train_global_loss: 19717929.8788; train_optim_loss: 19717929.8788; val_kl_reg_loss: 104310.9941; val_edge_recon_loss: 2892313.8438; val_gene_expr_recon_loss: 13901579.7500; val_masked_gp_l1_reg_loss: 102838.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55586.4492; val_chrom_access_recon_loss: 2732114.3438; val_global_loss: 19788743.0000; val_optim_loss: 19788743.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9008; val_auprc_score: 0.8609; val_best_acc_score: 0.8401; val_best_f1_score: 0.8536; train_kl_reg_loss: 103077.8789; train_edge_recon_loss: 2807283.2765; train_gene_expr_recon_loss: 13904710.6818; train_masked_gp_l1_reg_loss: 103430.2075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54235.8787; train_chrom_access_recon_loss: 2674169.8106; train_global_loss: 19646907.6061; train_optim_loss: 19646907.6061; val_kl_reg_loss: 103197.8740; val_edge_recon_loss: 2861150.8438; val_gene_expr_recon_loss: 14009216.6250; val_masked_gp_l1_reg_loss: 104266.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53217.1445; val_chrom_access_recon_loss: 2736780.0938; val_global_loss: 19867828.7500; val_optim_loss: 19867828.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9136; val_auprc_score: 0.8824; val_best_acc_score: 0.8544; val_best_f1_score: 0.8646; train_kl_reg_loss: 98935.6328; train_edge_recon_loss: 2801806.3712; train_gene_expr_recon_loss: 13856464.1818; train_masked_gp_l1_reg_loss: 104880.3203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51867.8323; train_chrom_access_recon_loss: 2661939.0871; train_global_loss: 19575893.4545; train_optim_loss: 19575893.4545; val_kl_reg_loss: 99349.5723; val_edge_recon_loss: 2833976.3125; val_gene_expr_recon_loss: 14037818.1250; val_masked_gp_l1_reg_loss: 105589.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51085.5508; val_chrom_access_recon_loss: 2756312.7188; val_global_loss: 19884132.7500; val_optim_loss: 19884132.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9165; val_auprc_score: 0.8820; val_best_acc_score: 0.8589; val_best_f1_score: 0.8707; train_kl_reg_loss: 100858.6072; train_edge_recon_loss: 2786876.8750; train_gene_expr_recon_loss: 13815375.0909; train_masked_gp_l1_reg_loss: 106123.9027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50039.0655; train_chrom_access_recon_loss: 2653434.9242; train_global_loss: 19512708.4242; train_optim_loss: 19512708.4242; val_kl_reg_loss: 97147.1592; val_edge_recon_loss: 2813698.0312; val_gene_expr_recon_loss: 13902320.2500; val_masked_gp_l1_reg_loss: 106827.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49244.2344; val_chrom_access_recon_loss: 2715984.2500; val_global_loss: 19685221.5000; val_optim_loss: 19685221.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9127; val_auprc_score: 0.8785; val_best_acc_score: 0.8525; val_best_f1_score: 0.8640; train_kl_reg_loss: 99288.1299; train_edge_recon_loss: 2782991.1364; train_gene_expr_recon_loss: 13766216.7121; train_masked_gp_l1_reg_loss: 107222.4015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48425.8431; train_chrom_access_recon_loss: 2643690.8333; train_global_loss: 19447835.1818; train_optim_loss: 19447835.1818; val_kl_reg_loss: 94804.2256; val_edge_recon_loss: 2826406.9062; val_gene_expr_recon_loss: 13807488.6250; val_masked_gp_l1_reg_loss: 107817.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47956.8008; val_chrom_access_recon_loss: 2706623.9375; val_global_loss: 19591097.7500; val_optim_loss: 19591097.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9239; val_auprc_score: 0.8984; val_best_acc_score: 0.8608; val_best_f1_score: 0.8720; train_kl_reg_loss: 96788.5739; train_edge_recon_loss: 2770798.8258; train_gene_expr_recon_loss: 13741495.8333; train_masked_gp_l1_reg_loss: 108359.8693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47117.1667; train_chrom_access_recon_loss: 2638372.9735; train_global_loss: 19402933.3333; train_optim_loss: 19402933.3333; val_kl_reg_loss: 96632.4473; val_edge_recon_loss: 2814058.6562; val_gene_expr_recon_loss: 13796660.7500; val_masked_gp_l1_reg_loss: 108802.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46435.5547; val_chrom_access_recon_loss: 2696516.1875; val_global_loss: 19559106.2500; val_optim_loss: 19559106.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9242; val_auprc_score: 0.8954; val_best_acc_score: 0.8665; val_best_f1_score: 0.8747; train_kl_reg_loss: 97716.2347; train_edge_recon_loss: 2755419.3030; train_gene_expr_recon_loss: 13715585.0909; train_masked_gp_l1_reg_loss: 109296.0110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45874.4698; train_chrom_access_recon_loss: 2635305.8485; train_global_loss: 19359197.0606; train_optim_loss: 19359197.0606; val_kl_reg_loss: 95111.5537; val_edge_recon_loss: 2767204.5000; val_gene_expr_recon_loss: 13814224.2500; val_masked_gp_l1_reg_loss: 109864.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45546.2109; val_chrom_access_recon_loss: 2706522.6875; val_global_loss: 19538473.0000; val_optim_loss: 19538473.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9292; val_auprc_score: 0.9025; val_best_acc_score: 0.8716; val_best_f1_score: 0.8779; train_kl_reg_loss: 94098.7412; train_edge_recon_loss: 2753824.0455; train_gene_expr_recon_loss: 13673225.6364; train_masked_gp_l1_reg_loss: 110383.4841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45132.9708; train_chrom_access_recon_loss: 2625074.3902; train_global_loss: 19301739.1212; train_optim_loss: 19301739.1212; val_kl_reg_loss: 91713.3535; val_edge_recon_loss: 2781294.3125; val_gene_expr_recon_loss: 13685732.3750; val_masked_gp_l1_reg_loss: 110927.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44530.0312; val_chrom_access_recon_loss: 2668549.0312; val_global_loss: 19382747.2500; val_optim_loss: 19382747.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9275; val_auprc_score: 0.9004; val_best_acc_score: 0.8697; val_best_f1_score: 0.8799; train_kl_reg_loss: 95302.6017; train_edge_recon_loss: 2754315.8598; train_gene_expr_recon_loss: 13630964.2121; train_masked_gp_l1_reg_loss: 111422.5605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44174.7354; train_chrom_access_recon_loss: 2615791.2462; train_global_loss: 19251971.3030; train_optim_loss: 19251971.3030; val_kl_reg_loss: 94484.3408; val_edge_recon_loss: 2780264.6250; val_gene_expr_recon_loss: 13678221.8750; val_masked_gp_l1_reg_loss: 112039.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43892.1094; val_chrom_access_recon_loss: 2681859.8125; val_global_loss: 19390762.7500; val_optim_loss: 19390762.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9367; val_auprc_score: 0.9159; val_best_acc_score: 0.8726; val_best_f1_score: 0.8805; train_kl_reg_loss: 92673.9122; train_edge_recon_loss: 2742980.9583; train_gene_expr_recon_loss: 13615718.9697; train_masked_gp_l1_reg_loss: 112424.5986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43501.9147; train_chrom_access_recon_loss: 2612067.6818; train_global_loss: 19219367.9697; train_optim_loss: 19219367.9697; val_kl_reg_loss: 93111.3291; val_edge_recon_loss: 2779084.6250; val_gene_expr_recon_loss: 13639994.7500; val_masked_gp_l1_reg_loss: 113147.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43256.5938; val_chrom_access_recon_loss: 2672704.9688; val_global_loss: 19341300.0000; val_optim_loss: 19341300.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9393; val_auprc_score: 0.9150; val_best_acc_score: 0.8858; val_best_f1_score: 0.8917; train_kl_reg_loss: 91962.8447; train_edge_recon_loss: 2747114.6591; train_gene_expr_recon_loss: 13568020.8636; train_masked_gp_l1_reg_loss: 113457.8439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42909.8711; train_chrom_access_recon_loss: 2602236.4848; train_global_loss: 19165702.6970; train_optim_loss: 19165702.6970; val_kl_reg_loss: 90052.1650; val_edge_recon_loss: 2745370.6562; val_gene_expr_recon_loss: 13708598.5000; val_masked_gp_l1_reg_loss: 114028.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42591.8242; val_chrom_access_recon_loss: 2677885.3750; val_global_loss: 19378526.5000; val_optim_loss: 19378526.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9372; val_auprc_score: 0.9147; val_best_acc_score: 0.8786; val_best_f1_score: 0.8863; train_kl_reg_loss: 90038.5250; train_edge_recon_loss: 2748846.9659; train_gene_expr_recon_loss: 13546625.9242; train_masked_gp_l1_reg_loss: 114354.9157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42217.4183; train_chrom_access_recon_loss: 2599196.9394; train_global_loss: 19141280.4545; train_optim_loss: 19141280.4545; val_kl_reg_loss: 89136.5234; val_edge_recon_loss: 2777169.3750; val_gene_expr_recon_loss: 13725432.3750; val_masked_gp_l1_reg_loss: 114844.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41955.7656; val_chrom_access_recon_loss: 2681306.2812; val_global_loss: 19429844.5000; val_optim_loss: 19429844.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9343; val_auprc_score: 0.9072; val_best_acc_score: 0.8823; val_best_f1_score: 0.8885; train_kl_reg_loss: 91275.6835; train_edge_recon_loss: 2735432.2273; train_gene_expr_recon_loss: 13524571.5606; train_masked_gp_l1_reg_loss: 115140.1731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41602.7601; train_chrom_access_recon_loss: 2593747.6742; train_global_loss: 19101770.1818; train_optim_loss: 19101770.1818; val_kl_reg_loss: 91635.2490; val_edge_recon_loss: 2772700.4375; val_gene_expr_recon_loss: 13576011.0000; val_masked_gp_l1_reg_loss: 115589.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41443.8516; val_chrom_access_recon_loss: 2662004.9375; val_global_loss: 19259385.2500; val_optim_loss: 19259385.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9433; val_auprc_score: 0.9255; val_best_acc_score: 0.8861; val_best_f1_score: 0.8923; train_kl_reg_loss: 90642.3036; train_edge_recon_loss: 2748726.8144; train_gene_expr_recon_loss: 13507472.4394; train_masked_gp_l1_reg_loss: 115909.0804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41099.2288; train_chrom_access_recon_loss: 2588028.5833; train_global_loss: 19091878.2424; train_optim_loss: 19091878.2424; val_kl_reg_loss: 89910.5156; val_edge_recon_loss: 2766170.4688; val_gene_expr_recon_loss: 13559635.7500; val_masked_gp_l1_reg_loss: 116203.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40861.6211; val_chrom_access_recon_loss: 2652565.3438; val_global_loss: 19225347.7500; val_optim_loss: 19225347.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9340; val_auprc_score: 0.9067; val_best_acc_score: 0.8807; val_best_f1_score: 0.8872; train_kl_reg_loss: 98857.2984; train_edge_recon_loss: 2757631.9773; train_gene_expr_recon_loss: 13250455.7121; train_masked_gp_l1_reg_loss: 115360.8920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37214.5071; train_chrom_access_recon_loss: 2548423.9811; train_global_loss: 18807944.4545; train_optim_loss: 18807944.4545; val_kl_reg_loss: 65885.3223; val_edge_recon_loss: 2792646.1562; val_gene_expr_recon_loss: 13310040.5000; val_masked_gp_l1_reg_loss: 115066.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36503.8555; val_chrom_access_recon_loss: 2603592.3125; val_global_loss: 18923735.0000; val_optim_loss: 18923735.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9491; val_auprc_score: 0.9320; val_best_acc_score: 0.8936; val_best_f1_score: 0.8970; train_kl_reg_loss: 98983.5561; train_edge_recon_loss: 2751988.2765; train_gene_expr_recon_loss: 13201438.1364; train_masked_gp_l1_reg_loss: 115316.1148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36519.4947; train_chrom_access_recon_loss: 2527287.9886; train_global_loss: 18731533.4848; train_optim_loss: 18731533.4848; val_kl_reg_loss: 67181.0151; val_edge_recon_loss: 2750885.1562; val_gene_expr_recon_loss: 13292356.6250; val_masked_gp_l1_reg_loss: 115730.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36565.4922; val_chrom_access_recon_loss: 2582381.5312; val_global_loss: 18845100.7500; val_optim_loss: 18845100.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9472; val_auprc_score: 0.9297; val_best_acc_score: 0.8928; val_best_f1_score: 0.8963; train_kl_reg_loss: 95348.2254; train_edge_recon_loss: 2733170.4886; train_gene_expr_recon_loss: 13180423.8182; train_masked_gp_l1_reg_loss: 115921.5836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36389.3710; train_chrom_access_recon_loss: 2520010.8598; train_global_loss: 18681264.3939; train_optim_loss: 18681264.3939; val_kl_reg_loss: 70209.0117; val_edge_recon_loss: 2754295.5625; val_gene_expr_recon_loss: 13206710.2500; val_masked_gp_l1_reg_loss: 116242.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36364.6875; val_chrom_access_recon_loss: 2572379.1875; val_global_loss: 18756202.0000; val_optim_loss: 18756202.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9449; val_auprc_score: 0.9173; val_best_acc_score: 0.8936; val_best_f1_score: 0.8978; train_kl_reg_loss: 91476.4299; train_edge_recon_loss: 2737770.9962; train_gene_expr_recon_loss: 13164207.6515; train_masked_gp_l1_reg_loss: 116439.6579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36281.0556; train_chrom_access_recon_loss: 2515253.9924; train_global_loss: 18661429.8182; train_optim_loss: 18661429.8182; val_kl_reg_loss: 72042.6240; val_edge_recon_loss: 2730266.9062; val_gene_expr_recon_loss: 13273608.8750; val_masked_gp_l1_reg_loss: 116653.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36231.5938; val_chrom_access_recon_loss: 2568566.0938; val_global_loss: 18797370.7500; val_optim_loss: 18797370.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9486; val_auprc_score: 0.9274; val_best_acc_score: 0.8952; val_best_f1_score: 0.9002; train_kl_reg_loss: 87675.1642; train_edge_recon_loss: 2734398.7500; train_gene_expr_recon_loss: 13132966.2121; train_masked_gp_l1_reg_loss: 116970.1245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36006.7407; train_chrom_access_recon_loss: 2511119.6174; train_global_loss: 18619136.5455; train_optim_loss: 18619136.5455; val_kl_reg_loss: 73282.0254; val_edge_recon_loss: 2742872.0625; val_gene_expr_recon_loss: 13327372.0000; val_masked_gp_l1_reg_loss: 117179.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35581.2031; val_chrom_access_recon_loss: 2580107.6250; val_global_loss: 18876394.0000; val_optim_loss: 18876394.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9447; val_auprc_score: 0.9167; val_best_acc_score: 0.8931; val_best_f1_score: 0.8978; train_kl_reg_loss: 87791.7924; train_edge_recon_loss: 2721968.1136; train_gene_expr_recon_loss: 13125222.4545; train_masked_gp_l1_reg_loss: 117287.9699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35481.7357; train_chrom_access_recon_loss: 2510731.2311; train_global_loss: 18598483.2121; train_optim_loss: 18598483.2121; val_kl_reg_loss: 75037.4824; val_edge_recon_loss: 2748559.0312; val_gene_expr_recon_loss: 13190379.0000; val_masked_gp_l1_reg_loss: 117470.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35245.9766; val_chrom_access_recon_loss: 2565807.8125; val_global_loss: 18732499.5000; val_optim_loss: 18732499.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9531; val_auprc_score: 0.9347; val_best_acc_score: 0.8998; val_best_f1_score: 0.9028; train_kl_reg_loss: 85935.3015; train_edge_recon_loss: 2719461.1288; train_gene_expr_recon_loss: 13097957.8788; train_masked_gp_l1_reg_loss: 117562.8121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35170.6619; train_chrom_access_recon_loss: 2501465.5455; train_global_loss: 18557553.4242; train_optim_loss: 18557553.4242; val_kl_reg_loss: 74891.8721; val_edge_recon_loss: 2744976.4062; val_gene_expr_recon_loss: 13208525.0000; val_masked_gp_l1_reg_loss: 117713.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35014.8203; val_chrom_access_recon_loss: 2582717.1250; val_global_loss: 18763838.0000; val_optim_loss: 18763838.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9518; val_auprc_score: 0.9319; val_best_acc_score: 0.8917; val_best_f1_score: 0.8984; train_kl_reg_loss: 84146.7057; train_edge_recon_loss: 2701273.2008; train_gene_expr_recon_loss: 13082987.6212; train_masked_gp_l1_reg_loss: 117882.7818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34875.0221; train_chrom_access_recon_loss: 2499119.4205; train_global_loss: 18520284.7273; train_optim_loss: 18520284.7273; val_kl_reg_loss: 74555.0400; val_edge_recon_loss: 2751002.4062; val_gene_expr_recon_loss: 13110689.0000; val_masked_gp_l1_reg_loss: 118036.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34817.4297; val_chrom_access_recon_loss: 2565206.3438; val_global_loss: 18654306.0000; val_optim_loss: 18654306.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9485; val_auprc_score: 0.9271; val_best_acc_score: 0.8933; val_best_f1_score: 0.8992; train_kl_reg_loss: 82827.8014; train_edge_recon_loss: 2713567.2803; train_gene_expr_recon_loss: 13066871.0455; train_masked_gp_l1_reg_loss: 118126.5691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34685.4471; train_chrom_access_recon_loss: 2495384.5758; train_global_loss: 18511462.7576; train_optim_loss: 18511462.7576; val_kl_reg_loss: 74191.6416; val_edge_recon_loss: 2755973.5938; val_gene_expr_recon_loss: 13136899.5000; val_masked_gp_l1_reg_loss: 118260.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34503.9414; val_chrom_access_recon_loss: 2560104.6562; val_global_loss: 18679934.2500; val_optim_loss: 18679934.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9512; val_auprc_score: 0.9315; val_best_acc_score: 0.8971; val_best_f1_score: 0.9008; train_kl_reg_loss: 81853.2849; train_edge_recon_loss: 2706400.5909; train_gene_expr_recon_loss: 13046850.2121; train_masked_gp_l1_reg_loss: 118385.8616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34419.5440; train_chrom_access_recon_loss: 2494487.2500; train_global_loss: 18482396.6061; train_optim_loss: 18482396.6061; val_kl_reg_loss: 74112.6436; val_edge_recon_loss: 2752010.4375; val_gene_expr_recon_loss: 13160935.1250; val_masked_gp_l1_reg_loss: 118578.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34243.1445; val_chrom_access_recon_loss: 2575117.0312; val_global_loss: 18714996.0000; val_optim_loss: 18714996.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9567; val_auprc_score: 0.9360; val_best_acc_score: 0.9084; val_best_f1_score: 0.9133; train_kl_reg_loss: 81289.0697; train_edge_recon_loss: 2709665.9470; train_gene_expr_recon_loss: 13035730.0606; train_masked_gp_l1_reg_loss: 118609.0984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34163.5864; train_chrom_access_recon_loss: 2489630.6742; train_global_loss: 18469088.4242; train_optim_loss: 18469088.4242; val_kl_reg_loss: 74967.2354; val_edge_recon_loss: 2721520.5000; val_gene_expr_recon_loss: 13305507.1250; val_masked_gp_l1_reg_loss: 118870.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34104.0039; val_chrom_access_recon_loss: 2573162.8750; val_global_loss: 18828132.0000; val_optim_loss: 18828132.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9536; val_auprc_score: 0.9344; val_best_acc_score: 0.9019; val_best_f1_score: 0.9064; train_kl_reg_loss: 80471.5819; train_edge_recon_loss: 2710084.0076; train_gene_expr_recon_loss: 13024631.3485; train_masked_gp_l1_reg_loss: 118897.5552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33901.6692; train_chrom_access_recon_loss: 2488793.5871; train_global_loss: 18456779.7576; train_optim_loss: 18456779.7576; val_kl_reg_loss: 74073.7295; val_edge_recon_loss: 2744051.5000; val_gene_expr_recon_loss: 13221131.1250; val_masked_gp_l1_reg_loss: 119102.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33941.0039; val_chrom_access_recon_loss: 2555021.8750; val_global_loss: 18747322.0000; val_optim_loss: 18747322.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9550; val_auprc_score: 0.9375; val_best_acc_score: 0.9052; val_best_f1_score: 0.9095; train_kl_reg_loss: 79884.3432; train_edge_recon_loss: 2689604.6326; train_gene_expr_recon_loss: 13000720.2879; train_masked_gp_l1_reg_loss: 118213.3948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31084.7807; train_chrom_access_recon_loss: 2485169.9962; train_global_loss: 18404677.3333; train_optim_loss: 18404677.3333; val_kl_reg_loss: 76412.0283; val_edge_recon_loss: 2723031.2188; val_gene_expr_recon_loss: 13236635.6250; val_masked_gp_l1_reg_loss: 117763.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30321.2793; val_chrom_access_recon_loss: 2562390.3438; val_global_loss: 18746554.2500; val_optim_loss: 18746554.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9550; val_auprc_score: 0.9327; val_best_acc_score: 0.9057; val_best_f1_score: 0.9097; train_kl_reg_loss: 80753.6173; train_edge_recon_loss: 2690678.0606; train_gene_expr_recon_loss: 12989153.9545; train_masked_gp_l1_reg_loss: 117634.7409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30119.9798; train_chrom_access_recon_loss: 2482987.9280; train_global_loss: 18391328.3636; train_optim_loss: 18391328.3636; val_kl_reg_loss: 76575.9570; val_edge_recon_loss: 2728953.8125; val_gene_expr_recon_loss: 13028087.6250; val_masked_gp_l1_reg_loss: 117541.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29954.3633; val_chrom_access_recon_loss: 2545052.2500; val_global_loss: 18526165.5000; val_optim_loss: 18526165.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9573; val_auprc_score: 0.9384; val_best_acc_score: 0.9046; val_best_f1_score: 0.9092; train_kl_reg_loss: 81406.7550; train_edge_recon_loss: 2701528.9962; train_gene_expr_recon_loss: 13001873.6061; train_masked_gp_l1_reg_loss: 117487.0877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29845.0607; train_chrom_access_recon_loss: 2484000.2197; train_global_loss: 18416141.8485; train_optim_loss: 18416141.8485; val_kl_reg_loss: 76426.2520; val_edge_recon_loss: 2725484.3750; val_gene_expr_recon_loss: 12979913.0000; val_masked_gp_l1_reg_loss: 117442.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29727.7520; val_chrom_access_recon_loss: 2511609.0312; val_global_loss: 18440603.0000; val_optim_loss: 18440603.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9549; val_auprc_score: 0.9292; val_best_acc_score: 0.9121; val_best_f1_score: 0.9160; train_kl_reg_loss: 81621.1562; train_edge_recon_loss: 2695631.4924; train_gene_expr_recon_loss: 12985786.4394; train_masked_gp_l1_reg_loss: 117429.0509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29661.9385; train_chrom_access_recon_loss: 2482935.0417; train_global_loss: 18393065.0909; train_optim_loss: 18393065.0909; val_kl_reg_loss: 76984.8389; val_edge_recon_loss: 2693774.0938; val_gene_expr_recon_loss: 13078061.1250; val_masked_gp_l1_reg_loss: 117419.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29574.5566; val_chrom_access_recon_loss: 2532942.1250; val_global_loss: 18528757.5000; val_optim_loss: 18528757.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9533; val_auprc_score: 0.9369; val_best_acc_score: 0.9006; val_best_f1_score: 0.9059; train_kl_reg_loss: 81655.6515; train_edge_recon_loss: 2694462.7614; train_gene_expr_recon_loss: 12978185.0303; train_masked_gp_l1_reg_loss: 117416.0400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29518.3205; train_chrom_access_recon_loss: 2481262.4848; train_global_loss: 18382500.3939; train_optim_loss: 18382500.3939; val_kl_reg_loss: 77152.7070; val_edge_recon_loss: 2737279.1562; val_gene_expr_recon_loss: 13181547.3750; val_masked_gp_l1_reg_loss: 117419.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29453.1367; val_chrom_access_recon_loss: 2563105.2812; val_global_loss: 18705957.0000; val_optim_loss: 18705957.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9581; val_auprc_score: 0.9400; val_best_acc_score: 0.9065; val_best_f1_score: 0.9105; train_kl_reg_loss: 81873.3403; train_edge_recon_loss: 2695383.4848; train_gene_expr_recon_loss: 12984159.1364; train_masked_gp_l1_reg_loss: 117419.0095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29395.0309; train_chrom_access_recon_loss: 2482269.5758; train_global_loss: 18390499.5455; train_optim_loss: 18390499.5455; val_kl_reg_loss: 78063.2188; val_edge_recon_loss: 2722543.3125; val_gene_expr_recon_loss: 12939064.8750; val_masked_gp_l1_reg_loss: 117413.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29332.0215; val_chrom_access_recon_loss: 2517794.4062; val_global_loss: 18404211.2500; val_optim_loss: 18404211.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9525; val_auprc_score: 0.9305; val_best_acc_score: 0.9014; val_best_f1_score: 0.9058; train_kl_reg_loss: 81412.4951; train_edge_recon_loss: 2698210.6439; train_gene_expr_recon_loss: 12987506.0455; train_masked_gp_l1_reg_loss: 117422.3201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29291.4231; train_chrom_access_recon_loss: 2482251.4394; train_global_loss: 18396094.4545; train_optim_loss: 18396094.4545; val_kl_reg_loss: 76860.6953; val_edge_recon_loss: 2744510.6875; val_gene_expr_recon_loss: 13150197.1250; val_masked_gp_l1_reg_loss: 117431.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29231.7383; val_chrom_access_recon_loss: 2546867.5625; val_global_loss: 18665098.7500; val_optim_loss: 18665098.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9595; val_auprc_score: 0.9483; val_best_acc_score: 0.9081; val_best_f1_score: 0.9117; train_kl_reg_loss: 82092.6462; train_edge_recon_loss: 2696018.8788; train_gene_expr_recon_loss: 12984899.6212; train_masked_gp_l1_reg_loss: 117437.8294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29176.6406; train_chrom_access_recon_loss: 2480843.0303; train_global_loss: 18390468.6970; train_optim_loss: 18390468.6970; val_kl_reg_loss: 77822.1025; val_edge_recon_loss: 2693812.2188; val_gene_expr_recon_loss: 13126099.7500; val_masked_gp_l1_reg_loss: 117443.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29111.8398; val_chrom_access_recon_loss: 2560146.5625; val_global_loss: 18604436.7500; val_optim_loss: 18604436.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9601; val_auprc_score: 0.9441; val_best_acc_score: 0.9095; val_best_f1_score: 0.9132; train_kl_reg_loss: 82205.2420; train_edge_recon_loss: 2688610.2462; train_gene_expr_recon_loss: 12985428.8182; train_masked_gp_l1_reg_loss: 117461.0320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29086.1048; train_chrom_access_recon_loss: 2483174.5985; train_global_loss: 18385966.0000; train_optim_loss: 18385966.0000; val_kl_reg_loss: 78543.9902; val_edge_recon_loss: 2728072.7812; val_gene_expr_recon_loss: 13054233.5000; val_masked_gp_l1_reg_loss: 117457.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29039.4922; val_chrom_access_recon_loss: 2540777.7188; val_global_loss: 18548124.0000; val_optim_loss: 18548124.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9580; val_auprc_score: 0.9421; val_best_acc_score: 0.9065; val_best_f1_score: 0.9099; train_kl_reg_loss: 82017.8720; train_edge_recon_loss: 2704424.3258; train_gene_expr_recon_loss: 12984054.9848; train_masked_gp_l1_reg_loss: 117461.9975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28992.3442; train_chrom_access_recon_loss: 2481668.5189; train_global_loss: 18398620.0000; train_optim_loss: 18398620.0000; val_kl_reg_loss: 77798.2734; val_edge_recon_loss: 2744355.4062; val_gene_expr_recon_loss: 13076790.6250; val_masked_gp_l1_reg_loss: 117462.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28946.1484; val_chrom_access_recon_loss: 2526187.1562; val_global_loss: 18571539.5000; val_optim_loss: 18571539.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9521; val_auprc_score: 0.9307; val_best_acc_score: 0.9019; val_best_f1_score: 0.9066; train_kl_reg_loss: 81587.8691; train_edge_recon_loss: 2691512.1477; train_gene_expr_recon_loss: 12983815.9545; train_masked_gp_l1_reg_loss: 117372.5231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28644.6913; train_chrom_access_recon_loss: 2481067.5909; train_global_loss: 18384000.8182; train_optim_loss: 18384000.8182; val_kl_reg_loss: 78274.0527; val_edge_recon_loss: 2754984.1562; val_gene_expr_recon_loss: 13121088.8750; val_masked_gp_l1_reg_loss: 117324.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28573.9688; val_chrom_access_recon_loss: 2562210.5938; val_global_loss: 18662456.5000; val_optim_loss: 18662456.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9553; val_auprc_score: 0.9349; val_best_acc_score: 0.9054; val_best_f1_score: 0.9099; train_kl_reg_loss: 81567.5497; train_edge_recon_loss: 2699242.8636; train_gene_expr_recon_loss: 12974660.9091; train_masked_gp_l1_reg_loss: 117307.8177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28559.2788; train_chrom_access_recon_loss: 2479354.7462; train_global_loss: 18380693.0909; train_optim_loss: 18380693.0909; val_kl_reg_loss: 77827.6592; val_edge_recon_loss: 2740182.2188; val_gene_expr_recon_loss: 13038857.2500; val_masked_gp_l1_reg_loss: 117293.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28544.0547; val_chrom_access_recon_loss: 2529129.8438; val_global_loss: 18531834.5000; val_optim_loss: 18531834.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9589; val_auprc_score: 0.9447; val_best_acc_score: 0.9124; val_best_f1_score: 0.9157; train_kl_reg_loss: 81641.1919; train_edge_recon_loss: 2692394.9470; train_gene_expr_recon_loss: 12980814.8182; train_masked_gp_l1_reg_loss: 117286.4007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28534.2782; train_chrom_access_recon_loss: 2481061.8182; train_global_loss: 18381733.5455; train_optim_loss: 18381733.5455; val_kl_reg_loss: 77403.0957; val_edge_recon_loss: 2699563.1250; val_gene_expr_recon_loss: 13125384.5000; val_masked_gp_l1_reg_loss: 117279.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28522.6250; val_chrom_access_recon_loss: 2546659.6250; val_global_loss: 18594812.5000; val_optim_loss: 18594812.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9575; val_auprc_score: 0.9402; val_best_acc_score: 0.9154; val_best_f1_score: 0.9178; train_kl_reg_loss: 81641.1068; train_edge_recon_loss: 2697439.4583; train_gene_expr_recon_loss: 12982809.5152; train_masked_gp_l1_reg_loss: 117277.0430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28514.2450; train_chrom_access_recon_loss: 2483344.9091; train_global_loss: 18391026.2424; train_optim_loss: 18391026.2424; val_kl_reg_loss: 78243.9326; val_edge_recon_loss: 2721029.7812; val_gene_expr_recon_loss: 13134462.5000; val_masked_gp_l1_reg_loss: 117273.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28505.2969; val_chrom_access_recon_loss: 2579919.0625; val_global_loss: 18659434.2500; val_optim_loss: 18659434.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 33 min 13 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9551
val AUPRC score: 0.9324
val best accuracy score: 0.9054
val best F1 score: 0.9089
val target rna MSE score: 0.8871
val source rna MSE score: 0.2736
val target atac MSE score: 0.3437
val source atac MSE score: 0.0771
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
