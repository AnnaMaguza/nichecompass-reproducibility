[True]
Run timestamp: 10082023_145555_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7850; val_auprc_score: 0.8049; val_best_acc_score: 0.5695; val_best_f1_score: 0.6942; train_kl_reg_loss: 101511.7828; train_edge_recon_loss: 3637025.7672; train_gene_expr_recon_loss: 15595208.6107; train_masked_gp_l1_reg_loss: 78440.6465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 240032.8526; train_chrom_access_recon_loss: 33502446.1374; train_global_loss: 53154665.6489; train_optim_loss: 53154665.6489; val_kl_reg_loss: 207417.4688; val_edge_recon_loss: 4061212.5000; val_gene_expr_recon_loss: 13121646.8667; val_masked_gp_l1_reg_loss: 72395.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 229571.1406; val_chrom_access_recon_loss: 31678413.8667; val_global_loss: 49370658.9333; val_optim_loss: 49370658.9333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8259; val_auprc_score: 0.8337; val_best_acc_score: 0.7447; val_best_f1_score: 0.7558; train_kl_reg_loss: 142797.6756; train_edge_recon_loss: 3557597.7595; train_gene_expr_recon_loss: 12705136.8168; train_masked_gp_l1_reg_loss: 68590.9790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 216314.7795; train_chrom_access_recon_loss: 30985947.9237; train_global_loss: 47676385.9847; train_optim_loss: 47676385.9847; val_kl_reg_loss: 118042.3089; val_edge_recon_loss: 4043040.9667; val_gene_expr_recon_loss: 12611146.6667; val_masked_gp_l1_reg_loss: 67176.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 202486.1250; val_chrom_access_recon_loss: 30758816.8000; val_global_loss: 47800708.2667; val_optim_loss: 47800708.2667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8547; val_auprc_score: 0.8504; val_best_acc_score: 0.7576; val_best_f1_score: 0.7827; train_kl_reg_loss: 119306.5905; train_edge_recon_loss: 3473829.6393; train_gene_expr_recon_loss: 12445410.6260; train_masked_gp_l1_reg_loss: 68110.3708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 188908.3869; train_chrom_access_recon_loss: 30616922.9313; train_global_loss: 46912488.4275; train_optim_loss: 46912488.4275; val_kl_reg_loss: 119725.4062; val_edge_recon_loss: 3170893.9667; val_gene_expr_recon_loss: 12490395.2667; val_masked_gp_l1_reg_loss: 70726.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175459.7812; val_chrom_access_recon_loss: 30568642.1333; val_global_loss: 46595842.9333; val_optim_loss: 46595842.9333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8770; val_auprc_score: 0.8631; val_best_acc_score: 0.7910; val_best_f1_score: 0.8094; train_kl_reg_loss: 150303.6113; train_edge_recon_loss: 3020525.6622; train_gene_expr_recon_loss: 12285817.6718; train_masked_gp_l1_reg_loss: 72671.2377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163150.2389; train_chrom_access_recon_loss: 30320712.1985; train_global_loss: 46013180.6718; train_optim_loss: 46013180.6718; val_kl_reg_loss: 150198.7375; val_edge_recon_loss: 2981805.6833; val_gene_expr_recon_loss: 12386403.6667; val_masked_gp_l1_reg_loss: 74596.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151231.5469; val_chrom_access_recon_loss: 30609447.8667; val_global_loss: 46353685.3333; val_optim_loss: 46353685.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9041; val_auprc_score: 0.8908; val_best_acc_score: 0.8204; val_best_f1_score: 0.8341; train_kl_reg_loss: 144679.2184; train_edge_recon_loss: 2947810.0134; train_gene_expr_recon_loss: 12151168.0534; train_masked_gp_l1_reg_loss: 76271.8735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140776.3078; train_chrom_access_recon_loss: 30038362.9160; train_global_loss: 45499068.5496; train_optim_loss: 45499068.5496; val_kl_reg_loss: 140877.6365; val_edge_recon_loss: 2918732.5833; val_gene_expr_recon_loss: 12203023.2667; val_masked_gp_l1_reg_loss: 77729.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130954.2344; val_chrom_access_recon_loss: 30065067.8667; val_global_loss: 45536384.2667; val_optim_loss: 45536384.2667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9261; val_auprc_score: 0.9108; val_best_acc_score: 0.8647; val_best_f1_score: 0.8722; train_kl_reg_loss: 139055.6913; train_edge_recon_loss: 2891031.7977; train_gene_expr_recon_loss: 12042012.8931; train_masked_gp_l1_reg_loss: 79088.1653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122729.7461; train_chrom_access_recon_loss: 29803731.9084; train_global_loss: 45077650.1679; train_optim_loss: 45077650.1679; val_kl_reg_loss: 139535.1229; val_edge_recon_loss: 2866705.7167; val_gene_expr_recon_loss: 12108768.3333; val_masked_gp_l1_reg_loss: 80574.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115038.6250; val_chrom_access_recon_loss: 30043757.2000; val_global_loss: 45354380.5333; val_optim_loss: 45354380.5333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9376; val_auprc_score: 0.9244; val_best_acc_score: 0.8751; val_best_f1_score: 0.8806; train_kl_reg_loss: 141328.5415; train_edge_recon_loss: 2832482.1240; train_gene_expr_recon_loss: 11937200.2443; train_masked_gp_l1_reg_loss: 81653.0097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108412.9992; train_chrom_access_recon_loss: 29579221.2977; train_global_loss: 44680298.2901; train_optim_loss: 44680298.2901; val_kl_reg_loss: 139201.1031; val_edge_recon_loss: 2823706.3500; val_gene_expr_recon_loss: 11980588.6000; val_masked_gp_l1_reg_loss: 82753.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102108.0312; val_chrom_access_recon_loss: 29725124.0000; val_global_loss: 44853481.3333; val_optim_loss: 44853481.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9429; val_auprc_score: 0.9284; val_best_acc_score: 0.8785; val_best_f1_score: 0.8831; train_kl_reg_loss: 137734.1449; train_edge_recon_loss: 2814761.5458; train_gene_expr_recon_loss: 11850160.7786; train_masked_gp_l1_reg_loss: 83827.4040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96736.4586; train_chrom_access_recon_loss: 29403290.0611; train_global_loss: 44386510.3511; train_optim_loss: 44386510.3511; val_kl_reg_loss: 136840.4490; val_edge_recon_loss: 2810173.1333; val_gene_expr_recon_loss: 11929161.0000; val_masked_gp_l1_reg_loss: 84874.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91825.0078; val_chrom_access_recon_loss: 29520682.6667; val_global_loss: 44573556.0000; val_optim_loss: 44573556.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9447; val_auprc_score: 0.9322; val_best_acc_score: 0.8795; val_best_f1_score: 0.8867; train_kl_reg_loss: 134184.1298; train_edge_recon_loss: 2801242.4637; train_gene_expr_recon_loss: 11769561.6183; train_masked_gp_l1_reg_loss: 85849.6642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87538.6478; train_chrom_access_recon_loss: 29204709.7863; train_global_loss: 44083086.4122; train_optim_loss: 44083086.4122; val_kl_reg_loss: 134020.1094; val_edge_recon_loss: 2804432.4667; val_gene_expr_recon_loss: 11843427.6000; val_masked_gp_l1_reg_loss: 86928.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83342.5000; val_chrom_access_recon_loss: 29364879.7333; val_global_loss: 44317030.6667; val_optim_loss: 44317030.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9484; val_auprc_score: 0.9375; val_best_acc_score: 0.8856; val_best_f1_score: 0.8914; train_kl_reg_loss: 131282.5897; train_edge_recon_loss: 2780870.5859; train_gene_expr_recon_loss: 11703722.6336; train_masked_gp_l1_reg_loss: 87821.0214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79718.7806; train_chrom_access_recon_loss: 29062896.1221; train_global_loss: 43846311.7557; train_optim_loss: 43846311.7557; val_kl_reg_loss: 131270.8026; val_edge_recon_loss: 2772664.5167; val_gene_expr_recon_loss: 11716383.3333; val_masked_gp_l1_reg_loss: 88804.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76318.3438; val_chrom_access_recon_loss: 28983506.6667; val_global_loss: 43768948.5333; val_optim_loss: 43768948.5333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9504; val_auprc_score: 0.9389; val_best_acc_score: 0.8905; val_best_f1_score: 0.8950; train_kl_reg_loss: 127029.2820; train_edge_recon_loss: 2771582.2767; train_gene_expr_recon_loss: 11635405.8397; train_masked_gp_l1_reg_loss: 89689.4025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73173.7010; train_chrom_access_recon_loss: 28853677.3740; train_global_loss: 43550557.9542; train_optim_loss: 43550557.9542; val_kl_reg_loss: 125900.8401; val_edge_recon_loss: 2790508.2500; val_gene_expr_recon_loss: 11713106.8667; val_masked_gp_l1_reg_loss: 90657.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70315.1094; val_chrom_access_recon_loss: 28989014.0000; val_global_loss: 43779502.4000; val_optim_loss: 43779502.4000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9532; val_auprc_score: 0.9407; val_best_acc_score: 0.8969; val_best_f1_score: 0.9011; train_kl_reg_loss: 122872.3796; train_edge_recon_loss: 2768455.6011; train_gene_expr_recon_loss: 11571560.3206; train_masked_gp_l1_reg_loss: 91469.5328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67647.5284; train_chrom_access_recon_loss: 28685622.1832; train_global_loss: 43307627.5420; train_optim_loss: 43307627.5420; val_kl_reg_loss: 122568.2953; val_edge_recon_loss: 2773794.9833; val_gene_expr_recon_loss: 11694265.5333; val_masked_gp_l1_reg_loss: 92288.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65191.4492; val_chrom_access_recon_loss: 28948101.3333; val_global_loss: 43696209.8667; val_optim_loss: 43696209.8667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9539; val_auprc_score: 0.9413; val_best_acc_score: 0.8932; val_best_f1_score: 0.8983; train_kl_reg_loss: 119834.9259; train_edge_recon_loss: 2768606.2271; train_gene_expr_recon_loss: 11516798.9237; train_masked_gp_l1_reg_loss: 93099.3914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62914.8829; train_chrom_access_recon_loss: 28522014.9771; train_global_loss: 43083269.0687; train_optim_loss: 43083269.0687; val_kl_reg_loss: 120572.2135; val_edge_recon_loss: 2769740.7333; val_gene_expr_recon_loss: 11590852.9333; val_masked_gp_l1_reg_loss: 93876.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60791.2344; val_chrom_access_recon_loss: 28701946.9333; val_global_loss: 43337781.3333; val_optim_loss: 43337781.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9579; val_auprc_score: 0.9455; val_best_acc_score: 0.9020; val_best_f1_score: 0.9055; train_kl_reg_loss: 118693.9250; train_edge_recon_loss: 2752536.3225; train_gene_expr_recon_loss: 11474471.2977; train_masked_gp_l1_reg_loss: 94631.8887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58916.3407; train_chrom_access_recon_loss: 28425016.3664; train_global_loss: 42924266.1069; train_optim_loss: 42924266.1069; val_kl_reg_loss: 116220.0354; val_edge_recon_loss: 2765268.8667; val_gene_expr_recon_loss: 11599640.6000; val_masked_gp_l1_reg_loss: 95331.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57045.5000; val_chrom_access_recon_loss: 28651355.0667; val_global_loss: 43284860.5333; val_optim_loss: 43284860.5333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9612; val_auprc_score: 0.9533; val_best_acc_score: 0.9070; val_best_f1_score: 0.9109; train_kl_reg_loss: 115854.2879; train_edge_recon_loss: 2751952.6317; train_gene_expr_recon_loss: 11432375.3740; train_masked_gp_l1_reg_loss: 96110.6351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55452.0872; train_chrom_access_recon_loss: 28302975.8626; train_global_loss: 42754720.9466; train_optim_loss: 42754720.9466; val_kl_reg_loss: 114026.3359; val_edge_recon_loss: 2743225.6667; val_gene_expr_recon_loss: 11515680.2667; val_masked_gp_l1_reg_loss: 96948.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53870.9727; val_chrom_access_recon_loss: 28510976.4000; val_global_loss: 43034728.5333; val_optim_loss: 43034728.5333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9601; val_auprc_score: 0.9471; val_best_acc_score: 0.9097; val_best_f1_score: 0.9125; train_kl_reg_loss: 113029.5792; train_edge_recon_loss: 2746314.4618; train_gene_expr_recon_loss: 11396598.4275; train_masked_gp_l1_reg_loss: 97618.2075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52469.3993; train_chrom_access_recon_loss: 28202386.6412; train_global_loss: 42608416.6718; train_optim_loss: 42608416.6718; val_kl_reg_loss: 112304.6182; val_edge_recon_loss: 2753112.8500; val_gene_expr_recon_loss: 11458656.8667; val_masked_gp_l1_reg_loss: 98302.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51181.3477; val_chrom_access_recon_loss: 28284806.9333; val_global_loss: 42758365.0667; val_optim_loss: 42758365.0667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9592; val_auprc_score: 0.9487; val_best_acc_score: 0.9066; val_best_f1_score: 0.9109; train_kl_reg_loss: 112218.6676; train_edge_recon_loss: 2736641.7882; train_gene_expr_recon_loss: 11360981.0076; train_masked_gp_l1_reg_loss: 98981.8921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49839.4120; train_chrom_access_recon_loss: 28102586.7786; train_global_loss: 42461249.4962; train_optim_loss: 42461249.4962; val_kl_reg_loss: 110390.2208; val_edge_recon_loss: 2765801.7667; val_gene_expr_recon_loss: 11444628.2667; val_masked_gp_l1_reg_loss: 99771.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48633.3242; val_chrom_access_recon_loss: 28289502.5333; val_global_loss: 42758728.2667; val_optim_loss: 42758728.2667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9664; val_auprc_score: 0.9557; val_best_acc_score: 0.9186; val_best_f1_score: 0.9211; train_kl_reg_loss: 110575.8191; train_edge_recon_loss: 2728437.9733; train_gene_expr_recon_loss: 11325354.7176; train_masked_gp_l1_reg_loss: 100421.3433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47430.9688; train_chrom_access_recon_loss: 27979131.9847; train_global_loss: 42291352.8550; train_optim_loss: 42291352.8550; val_kl_reg_loss: 110464.0031; val_edge_recon_loss: 2740774.1833; val_gene_expr_recon_loss: 11445082.3333; val_masked_gp_l1_reg_loss: 101006.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46306.1445; val_chrom_access_recon_loss: 28270442.1333; val_global_loss: 42714074.1333; val_optim_loss: 42714074.1333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9678; val_auprc_score: 0.9563; val_best_acc_score: 0.9171; val_best_f1_score: 0.9202; train_kl_reg_loss: 108714.1914; train_edge_recon_loss: 2723145.6508; train_gene_expr_recon_loss: 11292392.2672; train_masked_gp_l1_reg_loss: 101662.3668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45244.9231; train_chrom_access_recon_loss: 27867457.8321; train_global_loss: 42138617.0992; train_optim_loss: 42138617.0992; val_kl_reg_loss: 106641.4219; val_edge_recon_loss: 2725321.7833; val_gene_expr_recon_loss: 11342925.3333; val_masked_gp_l1_reg_loss: 102414.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44136.3750; val_chrom_access_recon_loss: 28013364.9333; val_global_loss: 42334803.4667; val_optim_loss: 42334803.4667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9706; val_auprc_score: 0.9633; val_best_acc_score: 0.9221; val_best_f1_score: 0.9247; train_kl_reg_loss: 108589.7105; train_edge_recon_loss: 2718080.2061; train_gene_expr_recon_loss: 11266081.8015; train_masked_gp_l1_reg_loss: 102979.8315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43175.6836; train_chrom_access_recon_loss: 27797813.6947; train_global_loss: 42036720.9771; train_optim_loss: 42036720.9771; val_kl_reg_loss: 108770.6005; val_edge_recon_loss: 2732945.2500; val_gene_expr_recon_loss: 11356891.3333; val_masked_gp_l1_reg_loss: 103580.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42298.9922; val_chrom_access_recon_loss: 27975828.0000; val_global_loss: 42320315.2000; val_optim_loss: 42320315.2000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9722; val_auprc_score: 0.9664; val_best_acc_score: 0.9232; val_best_f1_score: 0.9254; train_kl_reg_loss: 106718.1973; train_edge_recon_loss: 2719968.7901; train_gene_expr_recon_loss: 11244668.5420; train_masked_gp_l1_reg_loss: 104121.7940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41390.0120; train_chrom_access_recon_loss: 27725499.1756; train_global_loss: 41942366.8702; train_optim_loss: 41942366.8702; val_kl_reg_loss: 107212.4240; val_edge_recon_loss: 2722846.7833; val_gene_expr_recon_loss: 11317333.2000; val_masked_gp_l1_reg_loss: 104907.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40544.3594; val_chrom_access_recon_loss: 28028342.0000; val_global_loss: 42321186.4000; val_optim_loss: 42321186.4000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9730; val_auprc_score: 0.9659; val_best_acc_score: 0.9229; val_best_f1_score: 0.9252; train_kl_reg_loss: 104963.8718; train_edge_recon_loss: 2718369.8454; train_gene_expr_recon_loss: 11221787.6718; train_masked_gp_l1_reg_loss: 105417.1351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39853.3355; train_chrom_access_recon_loss: 27629521.4351; train_global_loss: 41819913.5267; train_optim_loss: 41819913.5267; val_kl_reg_loss: 104776.1844; val_edge_recon_loss: 2735510.4333; val_gene_expr_recon_loss: 11314620.6667; val_masked_gp_l1_reg_loss: 105927.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39177.4219; val_chrom_access_recon_loss: 27781929.0667; val_global_loss: 42081940.2667; val_optim_loss: 42081940.2667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9745; val_auprc_score: 0.9679; val_best_acc_score: 0.9252; val_best_f1_score: 0.9285; train_kl_reg_loss: 104564.3481; train_edge_recon_loss: 2707406.2615; train_gene_expr_recon_loss: 11186570.9695; train_masked_gp_l1_reg_loss: 106616.4143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38599.3922; train_chrom_access_recon_loss: 27535984.1221; train_global_loss: 41679741.5267; train_optim_loss: 41679741.5267; val_kl_reg_loss: 104176.1047; val_edge_recon_loss: 2725192.0500; val_gene_expr_recon_loss: 11278549.0000; val_masked_gp_l1_reg_loss: 107129.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38077.9688; val_chrom_access_recon_loss: 27722057.3333; val_global_loss: 41975180.8000; val_optim_loss: 41975180.8000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9759; val_auprc_score: 0.9687; val_best_acc_score: 0.9298; val_best_f1_score: 0.9327; train_kl_reg_loss: 104755.3569; train_edge_recon_loss: 2700557.7634; train_gene_expr_recon_loss: 11166822.1832; train_masked_gp_l1_reg_loss: 107689.9327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37501.0627; train_chrom_access_recon_loss: 27476193.1756; train_global_loss: 41593519.5420; train_optim_loss: 41593519.5420; val_kl_reg_loss: 105545.5099; val_edge_recon_loss: 2706362.2000; val_gene_expr_recon_loss: 11240897.0667; val_masked_gp_l1_reg_loss: 108237.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37016.6914; val_chrom_access_recon_loss: 27642925.0667; val_global_loss: 41840983.4667; val_optim_loss: 41840983.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9777; val_auprc_score: 0.9714; val_best_acc_score: 0.9332; val_best_f1_score: 0.9355; train_kl_reg_loss: 104029.7406; train_edge_recon_loss: 2701655.1107; train_gene_expr_recon_loss: 11146781.6031; train_masked_gp_l1_reg_loss: 108697.7530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36481.9924; train_chrom_access_recon_loss: 27387789.2824; train_global_loss: 41485435.4504; train_optim_loss: 41485435.4504; val_kl_reg_loss: 103947.2063; val_edge_recon_loss: 2728684.7000; val_gene_expr_recon_loss: 11241101.0667; val_masked_gp_l1_reg_loss: 109018.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35925.3359; val_chrom_access_recon_loss: 27738076.4000; val_global_loss: 41956752.0000; val_optim_loss: 41956752.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9821; val_auprc_score: 0.9779; val_best_acc_score: 0.9402; val_best_f1_score: 0.9412; train_kl_reg_loss: 113785.4009; train_edge_recon_loss: 2748180.6737; train_gene_expr_recon_loss: 11396055.7863; train_masked_gp_l1_reg_loss: 106730.9369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33969.6959; train_chrom_access_recon_loss: 27662621.9084; train_global_loss: 42061344.4885; train_optim_loss: 42061344.4885; val_kl_reg_loss: 60762.3263; val_edge_recon_loss: 2725990.4167; val_gene_expr_recon_loss: 11515921.5333; val_masked_gp_l1_reg_loss: 105741.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32718.1582; val_chrom_access_recon_loss: 27919195.2000; val_global_loss: 42360328.5333; val_optim_loss: 42360328.5333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9775; val_auprc_score: 0.9682; val_best_acc_score: 0.9356; val_best_f1_score: 0.9376; train_kl_reg_loss: 101781.4996; train_edge_recon_loss: 2710116.0477; train_gene_expr_recon_loss: 11355785.9466; train_masked_gp_l1_reg_loss: 105213.8853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31971.4897; train_chrom_access_recon_loss: 27557603.5115; train_global_loss: 41862472.2748; train_optim_loss: 41862472.2748; val_kl_reg_loss: 68803.8260; val_edge_recon_loss: 2713559.7833; val_gene_expr_recon_loss: 11470888.4667; val_masked_gp_l1_reg_loss: 104651.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31284.3984; val_chrom_access_recon_loss: 27690033.4667; val_global_loss: 42079221.8667; val_optim_loss: 42079221.8667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9777; val_auprc_score: 0.9692; val_best_acc_score: 0.9360; val_best_f1_score: 0.9383; train_kl_reg_loss: 94312.1331; train_edge_recon_loss: 2697391.1794; train_gene_expr_recon_loss: 11354439.1756; train_masked_gp_l1_reg_loss: 104149.3420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30657.7645; train_chrom_access_recon_loss: 27523998.4885; train_global_loss: 41804948.0000; train_optim_loss: 41804948.0000; val_kl_reg_loss: 69194.4490; val_edge_recon_loss: 2712810.8333; val_gene_expr_recon_loss: 11480824.2667; val_masked_gp_l1_reg_loss: 103729.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30084.6309; val_chrom_access_recon_loss: 27899054.6667; val_global_loss: 42295699.2000; val_optim_loss: 42295699.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9794; val_auprc_score: 0.9729; val_best_acc_score: 0.9365; val_best_f1_score: 0.9391; train_kl_reg_loss: 92190.3000; train_edge_recon_loss: 2695703.7385; train_gene_expr_recon_loss: 11343450.0229; train_masked_gp_l1_reg_loss: 103074.4282; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29693.2785; train_chrom_access_recon_loss: 27489718.3664; train_global_loss: 41753830.3817; train_optim_loss: 41753830.3817; val_kl_reg_loss: 72172.0188; val_edge_recon_loss: 2702008.8667; val_gene_expr_recon_loss: 11451818.3333; val_masked_gp_l1_reg_loss: 102824.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29488.7695; val_chrom_access_recon_loss: 27773150.6667; val_global_loss: 42131463.2000; val_optim_loss: 42131463.2000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9791; val_auprc_score: 0.9731; val_best_acc_score: 0.9390; val_best_f1_score: 0.9416; train_kl_reg_loss: 93017.6489; train_edge_recon_loss: 2692759.4447; train_gene_expr_recon_loss: 11336411.1450; train_masked_gp_l1_reg_loss: 102718.7520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29414.9893; train_chrom_access_recon_loss: 27482132.9008; train_global_loss: 41736455.0229; train_optim_loss: 41736455.0229; val_kl_reg_loss: 72568.1635; val_edge_recon_loss: 2699753.6333; val_gene_expr_recon_loss: 11447647.0667; val_masked_gp_l1_reg_loss: 102602.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29290.3164; val_chrom_access_recon_loss: 27744730.9333; val_global_loss: 42096592.8000; val_optim_loss: 42096592.8000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9797; val_auprc_score: 0.9715; val_best_acc_score: 0.9390; val_best_f1_score: 0.9408; train_kl_reg_loss: 92529.6623; train_edge_recon_loss: 2685802.1622; train_gene_expr_recon_loss: 11338213.1985; train_masked_gp_l1_reg_loss: 102500.3433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29159.7236; train_chrom_access_recon_loss: 27478819.6641; train_global_loss: 41727024.8244; train_optim_loss: 41727024.8244; val_kl_reg_loss: 72982.2979; val_edge_recon_loss: 2703544.7500; val_gene_expr_recon_loss: 11455940.5333; val_masked_gp_l1_reg_loss: 102406.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29023.4375; val_chrom_access_recon_loss: 27734420.5333; val_global_loss: 42098316.5333; val_optim_loss: 42098316.5333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9796; val_auprc_score: 0.9744; val_best_acc_score: 0.9392; val_best_f1_score: 0.9413; train_kl_reg_loss: 91327.8062; train_edge_recon_loss: 2693645.9160; train_gene_expr_recon_loss: 11347175.8092; train_masked_gp_l1_reg_loss: 102308.2684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28906.4912; train_chrom_access_recon_loss: 27509755.6947; train_global_loss: 41773120.0305; train_optim_loss: 41773120.0305; val_kl_reg_loss: 72912.8135; val_edge_recon_loss: 2727656.1167; val_gene_expr_recon_loss: 11463631.6000; val_masked_gp_l1_reg_loss: 102220.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28806.4180; val_chrom_access_recon_loss: 27700386.6667; val_global_loss: 42095612.8000; val_optim_loss: 42095612.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 49 min 33 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9771
val AUPRC score: 0.9697
val best accuracy score: 0.9295
val best F1 score: 0.9310
val target rna MSE score: 3.1937
val source rna MSE score: 1.0098
val target atac MSE score: 0.1249
val source atac MSE score: 0.0218
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
