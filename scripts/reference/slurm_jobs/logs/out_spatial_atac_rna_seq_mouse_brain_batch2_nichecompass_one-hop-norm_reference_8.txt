[True]
Run timestamp: 09102023_190808_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6488; val_auprc_score: 0.6380; val_best_acc_score: 0.5129; val_best_f1_score: 0.6708; train_kl_reg_loss: 35433.6479; train_edge_recon_loss: 3507608.9508; train_gene_expr_recon_loss: 14128003.3485; train_masked_gp_l1_reg_loss: 89039.4717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3028732.1932; train_chrom_access_recon_loss: 2339144.5568; train_global_loss: 23127962.0000; train_optim_loss: 23127962.0000; val_kl_reg_loss: 14689.2188; val_edge_recon_loss: 4064009.5938; val_gene_expr_recon_loss: 13490316.6250; val_masked_gp_l1_reg_loss: 83403.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1764299.8750; val_chrom_access_recon_loss: 2301349.4688; val_global_loss: 21718069.7500; val_optim_loss: 21718069.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7212; val_auprc_score: 0.6910; val_best_acc_score: 0.5618; val_best_f1_score: 0.6908; train_kl_reg_loss: 62733.5372; train_edge_recon_loss: 3513273.4394; train_gene_expr_recon_loss: 12920985.7273; train_masked_gp_l1_reg_loss: 83235.6787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1010826.0114; train_chrom_access_recon_loss: 2216045.2500; train_global_loss: 19807099.6667; train_optim_loss: 19807099.6667; val_kl_reg_loss: 81040.8193; val_edge_recon_loss: 4061953.3750; val_gene_expr_recon_loss: 13010770.3750; val_masked_gp_l1_reg_loss: 80221.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 516181.8750; val_chrom_access_recon_loss: 2246270.2188; val_global_loss: 19996438.5000; val_optim_loss: 19996438.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7626; val_auprc_score: 0.7505; val_best_acc_score: 0.6373; val_best_f1_score: 0.7183; train_kl_reg_loss: 74089.9042; train_edge_recon_loss: 3506114.7386; train_gene_expr_recon_loss: 12687148.1364; train_masked_gp_l1_reg_loss: 79450.9943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 344246.0540; train_chrom_access_recon_loss: 2190453.8201; train_global_loss: 18881503.6364; train_optim_loss: 18881503.6364; val_kl_reg_loss: 77610.2861; val_edge_recon_loss: 4055978.2500; val_gene_expr_recon_loss: 12782085.7500; val_masked_gp_l1_reg_loss: 79262.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 231471.6250; val_chrom_access_recon_loss: 2227318.6250; val_global_loss: 19453727.0000; val_optim_loss: 19453727.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8165; val_auprc_score: 0.7907; val_best_acc_score: 0.7480; val_best_f1_score: 0.7365; train_kl_reg_loss: 69876.4157; train_edge_recon_loss: 3502695.0985; train_gene_expr_recon_loss: 12556493.8030; train_masked_gp_l1_reg_loss: 79878.5767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180031.7460; train_chrom_access_recon_loss: 2175101.6136; train_global_loss: 18564077.2424; train_optim_loss: 18564077.2424; val_kl_reg_loss: 67681.1719; val_edge_recon_loss: 4014901.3125; val_gene_expr_recon_loss: 12768162.0000; val_masked_gp_l1_reg_loss: 80582.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142034.0156; val_chrom_access_recon_loss: 2216090.5625; val_global_loss: 19289451.2500; val_optim_loss: 19289451.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8384; val_auprc_score: 0.8154; val_best_acc_score: 0.7598; val_best_f1_score: 0.7849; train_kl_reg_loss: 60173.8279; train_edge_recon_loss: 3463454.6894; train_gene_expr_recon_loss: 12494528.7273; train_masked_gp_l1_reg_loss: 81910.0290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122743.7715; train_chrom_access_recon_loss: 2164299.0966; train_global_loss: 18387110.0909; train_optim_loss: 18387110.0909; val_kl_reg_loss: 48567.0278; val_edge_recon_loss: 3570776.0938; val_gene_expr_recon_loss: 12671350.5000; val_masked_gp_l1_reg_loss: 84212.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107757.1406; val_chrom_access_recon_loss: 2219827.5625; val_global_loss: 18702491.0000; val_optim_loss: 18702491.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8468; val_auprc_score: 0.8122; val_best_acc_score: 0.7606; val_best_f1_score: 0.8002; train_kl_reg_loss: 67696.3668; train_edge_recon_loss: 3077125.4356; train_gene_expr_recon_loss: 12445587.8636; train_masked_gp_l1_reg_loss: 88459.7850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102152.2309; train_chrom_access_recon_loss: 2156036.8295; train_global_loss: 17937058.2727; train_optim_loss: 17937058.2727; val_kl_reg_loss: 91340.0059; val_edge_recon_loss: 2887689.3438; val_gene_expr_recon_loss: 12534799.0000; val_masked_gp_l1_reg_loss: 91144.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97213.6562; val_chrom_access_recon_loss: 2202976.0312; val_global_loss: 17905163.7500; val_optim_loss: 17905163.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8461; val_auprc_score: 0.8112; val_best_acc_score: 0.7577; val_best_f1_score: 0.7954; train_kl_reg_loss: 89434.2692; train_edge_recon_loss: 2940914.1364; train_gene_expr_recon_loss: 12348631.3636; train_masked_gp_l1_reg_loss: 91545.7612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92192.4328; train_chrom_access_recon_loss: 2139765.9205; train_global_loss: 17702484.0303; train_optim_loss: 17702484.0303; val_kl_reg_loss: 89228.2666; val_edge_recon_loss: 2934164.0938; val_gene_expr_recon_loss: 12544948.6250; val_masked_gp_l1_reg_loss: 92775.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87935.2656; val_chrom_access_recon_loss: 2217211.6250; val_global_loss: 17966263.5000; val_optim_loss: 17966263.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8662; val_auprc_score: 0.8372; val_best_acc_score: 0.7915; val_best_f1_score: 0.8033; train_kl_reg_loss: 86961.2461; train_edge_recon_loss: 2908582.4394; train_gene_expr_recon_loss: 12287104.3182; train_masked_gp_l1_reg_loss: 93359.5400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84100.6222; train_chrom_access_recon_loss: 2132722.0587; train_global_loss: 17592830.2424; train_optim_loss: 17592830.2424; val_kl_reg_loss: 88055.2891; val_edge_recon_loss: 2924866.0000; val_gene_expr_recon_loss: 12545825.1250; val_masked_gp_l1_reg_loss: 94430.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80926.0703; val_chrom_access_recon_loss: 2204775.6875; val_global_loss: 17938878.2500; val_optim_loss: 17938878.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8624; val_auprc_score: 0.8230; val_best_acc_score: 0.7920; val_best_f1_score: 0.8109; train_kl_reg_loss: 85650.2517; train_edge_recon_loss: 2877554.2727; train_gene_expr_recon_loss: 12213688.6818; train_masked_gp_l1_reg_loss: 95274.5442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78866.3794; train_chrom_access_recon_loss: 2120481.0663; train_global_loss: 17471515.2727; train_optim_loss: 17471515.2727; val_kl_reg_loss: 86502.0986; val_edge_recon_loss: 2924150.9688; val_gene_expr_recon_loss: 12279824.1250; val_masked_gp_l1_reg_loss: 96507.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76981.9062; val_chrom_access_recon_loss: 2172951.2031; val_global_loss: 17636917.5000; val_optim_loss: 17636917.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8789; val_auprc_score: 0.8400; val_best_acc_score: 0.8157; val_best_f1_score: 0.8338; train_kl_reg_loss: 84363.1011; train_edge_recon_loss: 2857600.6970; train_gene_expr_recon_loss: 12171866.8636; train_masked_gp_l1_reg_loss: 97555.7250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74977.3752; train_chrom_access_recon_loss: 2115426.9981; train_global_loss: 17401790.6970; train_optim_loss: 17401790.6970; val_kl_reg_loss: 84689.0176; val_edge_recon_loss: 2876341.5938; val_gene_expr_recon_loss: 12398483.0000; val_masked_gp_l1_reg_loss: 98395.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72944.7578; val_chrom_access_recon_loss: 2188593.4062; val_global_loss: 17719448.0000; val_optim_loss: 17719448.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8963; val_auprc_score: 0.8637; val_best_acc_score: 0.8305; val_best_f1_score: 0.8459; train_kl_reg_loss: 87165.4188; train_edge_recon_loss: 2821606.0038; train_gene_expr_recon_loss: 12121792.9697; train_masked_gp_l1_reg_loss: 99484.5548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71537.4621; train_chrom_access_recon_loss: 2106781.5530; train_global_loss: 17308367.9242; train_optim_loss: 17308367.9242; val_kl_reg_loss: 86898.0254; val_edge_recon_loss: 2858684.6875; val_gene_expr_recon_loss: 12307325.0000; val_masked_gp_l1_reg_loss: 100393.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70393.6094; val_chrom_access_recon_loss: 2181051.9062; val_global_loss: 17604746.7500; val_optim_loss: 17604746.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9008; val_auprc_score: 0.8700; val_best_acc_score: 0.8340; val_best_f1_score: 0.8512; train_kl_reg_loss: 87805.9490; train_edge_recon_loss: 2797341.9205; train_gene_expr_recon_loss: 12078885.8333; train_masked_gp_l1_reg_loss: 101109.7667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69311.0069; train_chrom_access_recon_loss: 2101538.5606; train_global_loss: 17235993.0758; train_optim_loss: 17235993.0758; val_kl_reg_loss: 86531.8184; val_edge_recon_loss: 2834748.5625; val_gene_expr_recon_loss: 12223026.8750; val_masked_gp_l1_reg_loss: 101839.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68930.9141; val_chrom_access_recon_loss: 2150416.4688; val_global_loss: 17465495.0000; val_optim_loss: 17465495.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9124; val_auprc_score: 0.8831; val_best_acc_score: 0.8541; val_best_f1_score: 0.8642; train_kl_reg_loss: 86937.2289; train_edge_recon_loss: 2790110.4848; train_gene_expr_recon_loss: 12036430.0455; train_masked_gp_l1_reg_loss: 102650.3423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68214.4933; train_chrom_access_recon_loss: 2093482.0985; train_global_loss: 17177824.7273; train_optim_loss: 17177824.7273; val_kl_reg_loss: 84738.5742; val_edge_recon_loss: 2775498.6562; val_gene_expr_recon_loss: 12158726.3750; val_masked_gp_l1_reg_loss: 103153.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67565.3516; val_chrom_access_recon_loss: 2142320.5000; val_global_loss: 17332003.3750; val_optim_loss: 17332003.3750
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9086; val_auprc_score: 0.8775; val_best_acc_score: 0.8455; val_best_f1_score: 0.8574; train_kl_reg_loss: 84435.6984; train_edge_recon_loss: 2777029.8182; train_gene_expr_recon_loss: 12012861.9848; train_masked_gp_l1_reg_loss: 103735.1592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67309.8133; train_chrom_access_recon_loss: 2090171.0189; train_global_loss: 17135543.4394; train_optim_loss: 17135543.4394; val_kl_reg_loss: 86403.9854; val_edge_recon_loss: 2817558.2188; val_gene_expr_recon_loss: 12102906.5000; val_masked_gp_l1_reg_loss: 104353.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67408.0000; val_chrom_access_recon_loss: 2121562.7812; val_global_loss: 17300193.6250; val_optim_loss: 17300193.6250
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9222; val_auprc_score: 0.8916; val_best_acc_score: 0.8624; val_best_f1_score: 0.8714; train_kl_reg_loss: 85826.1657; train_edge_recon_loss: 2766958.7386; train_gene_expr_recon_loss: 11966859.5000; train_masked_gp_l1_reg_loss: 104694.7315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66301.0977; train_chrom_access_recon_loss: 2080378.9337; train_global_loss: 17071019.1667; train_optim_loss: 17071019.1667; val_kl_reg_loss: 82830.1475; val_edge_recon_loss: 2781978.3125; val_gene_expr_recon_loss: 12169591.8750; val_masked_gp_l1_reg_loss: 105342.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66791.5859; val_chrom_access_recon_loss: 2140572.5312; val_global_loss: 17347107.0000; val_optim_loss: 17347107.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9220; val_auprc_score: 0.8969; val_best_acc_score: 0.8689; val_best_f1_score: 0.8767; train_kl_reg_loss: 84951.7679; train_edge_recon_loss: 2746130.9356; train_gene_expr_recon_loss: 11933710.4242; train_masked_gp_l1_reg_loss: 105569.7657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66158.8801; train_chrom_access_recon_loss: 2074130.5606; train_global_loss: 17010652.3333; train_optim_loss: 17010652.3333; val_kl_reg_loss: 85648.1318; val_edge_recon_loss: 2741890.5938; val_gene_expr_recon_loss: 12093830.6250; val_masked_gp_l1_reg_loss: 106091.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66029.0000; val_chrom_access_recon_loss: 2108370.2969; val_global_loss: 17201859.7500; val_optim_loss: 17201859.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9162; val_auprc_score: 0.8800; val_best_acc_score: 0.8595; val_best_f1_score: 0.8690; train_kl_reg_loss: 83923.8459; train_edge_recon_loss: 2754699.9735; train_gene_expr_recon_loss: 11905350.0303; train_masked_gp_l1_reg_loss: 106139.9068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65403.0558; train_chrom_access_recon_loss: 2068187.1269; train_global_loss: 16983703.9848; train_optim_loss: 16983703.9848; val_kl_reg_loss: 88262.9658; val_edge_recon_loss: 2785384.3125; val_gene_expr_recon_loss: 12074005.0000; val_masked_gp_l1_reg_loss: 106422.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65724.5156; val_chrom_access_recon_loss: 2102776.0781; val_global_loss: 17222575.3750; val_optim_loss: 17222575.3750
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9142; val_auprc_score: 0.8761; val_best_acc_score: 0.8603; val_best_f1_score: 0.8697; train_kl_reg_loss: 84554.3414; train_edge_recon_loss: 2749839.2273; train_gene_expr_recon_loss: 11872824.6364; train_masked_gp_l1_reg_loss: 106737.1029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64844.5915; train_chrom_access_recon_loss: 2064301.4413; train_global_loss: 16943101.3636; train_optim_loss: 16943101.3636; val_kl_reg_loss: 85786.7236; val_edge_recon_loss: 2792706.2500; val_gene_expr_recon_loss: 12039850.3750; val_masked_gp_l1_reg_loss: 107028.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64660.5820; val_chrom_access_recon_loss: 2121709.4062; val_global_loss: 17211742.2500; val_optim_loss: 17211742.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9241; val_auprc_score: 0.8942; val_best_acc_score: 0.8700; val_best_f1_score: 0.8782; train_kl_reg_loss: 84746.2358; train_edge_recon_loss: 2739630.0379; train_gene_expr_recon_loss: 11844905.7576; train_masked_gp_l1_reg_loss: 107186.8812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64373.1470; train_chrom_access_recon_loss: 2059224.6364; train_global_loss: 16900066.6667; train_optim_loss: 16900066.6667; val_kl_reg_loss: 86870.7617; val_edge_recon_loss: 2767659.4062; val_gene_expr_recon_loss: 11954632.3750; val_masked_gp_l1_reg_loss: 107473.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64175.1836; val_chrom_access_recon_loss: 2108712.0312; val_global_loss: 17089523.5000; val_optim_loss: 17089523.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9242; val_auprc_score: 0.8900; val_best_acc_score: 0.8662; val_best_f1_score: 0.8733; train_kl_reg_loss: 83407.5926; train_edge_recon_loss: 2741171.8295; train_gene_expr_recon_loss: 11814402.1515; train_masked_gp_l1_reg_loss: 107444.7584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64017.1509; train_chrom_access_recon_loss: 2053442.5795; train_global_loss: 16863886.1061; train_optim_loss: 16863886.1061; val_kl_reg_loss: 83967.0518; val_edge_recon_loss: 2757235.7188; val_gene_expr_recon_loss: 11960463.5000; val_masked_gp_l1_reg_loss: 107624.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63455.8320; val_chrom_access_recon_loss: 2109745.5312; val_global_loss: 17082492.7500; val_optim_loss: 17082492.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9309; val_auprc_score: 0.9051; val_best_acc_score: 0.8772; val_best_f1_score: 0.8842; train_kl_reg_loss: 81996.1909; train_edge_recon_loss: 2733716.5758; train_gene_expr_recon_loss: 11785799.5000; train_masked_gp_l1_reg_loss: 107919.7450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63412.0195; train_chrom_access_recon_loss: 2049098.4811; train_global_loss: 16821942.5606; train_optim_loss: 16821942.5606; val_kl_reg_loss: 83149.5146; val_edge_recon_loss: 2739960.8125; val_gene_expr_recon_loss: 12066971.5000; val_masked_gp_l1_reg_loss: 108230.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63228.0000; val_chrom_access_recon_loss: 2125764.9062; val_global_loss: 17187304.7500; val_optim_loss: 17187304.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9296; val_auprc_score: 0.9004; val_best_acc_score: 0.8740; val_best_f1_score: 0.8820; train_kl_reg_loss: 80793.9281; train_edge_recon_loss: 2731727.1439; train_gene_expr_recon_loss: 11762025.5606; train_masked_gp_l1_reg_loss: 108502.3655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62970.6533; train_chrom_access_recon_loss: 2043212.5152; train_global_loss: 16789232.2424; train_optim_loss: 16789232.2424; val_kl_reg_loss: 81571.2627; val_edge_recon_loss: 2760847.0938; val_gene_expr_recon_loss: 11931587.7500; val_masked_gp_l1_reg_loss: 108856.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62919.5078; val_chrom_access_recon_loss: 2106168.0469; val_global_loss: 17051951.2500; val_optim_loss: 17051951.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9399; val_auprc_score: 0.9182; val_best_acc_score: 0.8855; val_best_f1_score: 0.8925; train_kl_reg_loss: 80600.1011; train_edge_recon_loss: 2731469.2917; train_gene_expr_recon_loss: 11732193.0152; train_masked_gp_l1_reg_loss: 108904.1946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62563.7304; train_chrom_access_recon_loss: 2040208.0019; train_global_loss: 16755938.5152; train_optim_loss: 16755938.5152; val_kl_reg_loss: 83042.8018; val_edge_recon_loss: 2739246.6562; val_gene_expr_recon_loss: 11938012.1250; val_masked_gp_l1_reg_loss: 109140.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62852.0039; val_chrom_access_recon_loss: 2094894.1406; val_global_loss: 17027188.8750; val_optim_loss: 17027188.8750
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9353; val_auprc_score: 0.9062; val_best_acc_score: 0.8807; val_best_f1_score: 0.8876; train_kl_reg_loss: 81154.2246; train_edge_recon_loss: 2728823.1023; train_gene_expr_recon_loss: 11716713.2576; train_masked_gp_l1_reg_loss: 109121.1944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62528.0460; train_chrom_access_recon_loss: 2035145.5246; train_global_loss: 16733485.4394; train_optim_loss: 16733485.4394; val_kl_reg_loss: 79764.4199; val_edge_recon_loss: 2755841.1250; val_gene_expr_recon_loss: 11905081.0000; val_masked_gp_l1_reg_loss: 109381.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62415.0859; val_chrom_access_recon_loss: 2082629.4219; val_global_loss: 16995112.8750; val_optim_loss: 16995112.8750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9368; val_auprc_score: 0.9062; val_best_acc_score: 0.8901; val_best_f1_score: 0.8968; train_kl_reg_loss: 80925.3338; train_edge_recon_loss: 2725633.8826; train_gene_expr_recon_loss: 11702783.3939; train_masked_gp_l1_reg_loss: 109354.7728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62052.2576; train_chrom_access_recon_loss: 2032426.0701; train_global_loss: 16713175.7424; train_optim_loss: 16713175.7424; val_kl_reg_loss: 84371.6074; val_edge_recon_loss: 2744851.0938; val_gene_expr_recon_loss: 11998213.6250; val_masked_gp_l1_reg_loss: 109489.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62316.6602; val_chrom_access_recon_loss: 2109982.8125; val_global_loss: 17109226.1250; val_optim_loss: 17109226.1250
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9340; val_auprc_score: 0.9074; val_best_acc_score: 0.8788; val_best_f1_score: 0.8869; train_kl_reg_loss: 104858.9096; train_edge_recon_loss: 2853450.7576; train_gene_expr_recon_loss: 10800441.2727; train_masked_gp_l1_reg_loss: 109434.9767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58601.0344; train_chrom_access_recon_loss: 1901619.6799; train_global_loss: 15828406.5303; train_optim_loss: 15828406.5303; val_kl_reg_loss: 31253.0366; val_edge_recon_loss: 2812182.5000; val_gene_expr_recon_loss: 10971134.6250; val_masked_gp_l1_reg_loss: 109079.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57909.2422; val_chrom_access_recon_loss: 1919762.0312; val_global_loss: 15901321.1250; val_optim_loss: 15901321.1250
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9345; val_auprc_score: 0.9089; val_best_acc_score: 0.8788; val_best_f1_score: 0.8844; train_kl_reg_loss: 89267.7850; train_edge_recon_loss: 2774473.9508; train_gene_expr_recon_loss: 10736375.6970; train_masked_gp_l1_reg_loss: 108508.6689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57858.5275; train_chrom_access_recon_loss: 1871274.8352; train_global_loss: 15637759.5000; train_optim_loss: 15637759.5000; val_kl_reg_loss: 36718.8110; val_edge_recon_loss: 2786531.3125; val_gene_expr_recon_loss: 10854212.0000; val_masked_gp_l1_reg_loss: 107939.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57893.5352; val_chrom_access_recon_loss: 1914288.3906; val_global_loss: 15757584.2500; val_optim_loss: 15757584.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9397; val_auprc_score: 0.9182; val_best_acc_score: 0.8796; val_best_f1_score: 0.8878; train_kl_reg_loss: 77239.6036; train_edge_recon_loss: 2744710.1591; train_gene_expr_recon_loss: 10710004.5152; train_masked_gp_l1_reg_loss: 107248.0349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57685.6422; train_chrom_access_recon_loss: 1867804.7027; train_global_loss: 15564692.5606; train_optim_loss: 15564692.5606; val_kl_reg_loss: 42656.7324; val_edge_recon_loss: 2764269.5312; val_gene_expr_recon_loss: 10771459.2500; val_masked_gp_l1_reg_loss: 106458.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57781.8164; val_chrom_access_recon_loss: 1907824.5938; val_global_loss: 15650450.1250; val_optim_loss: 15650450.1250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9327; val_auprc_score: 0.9028; val_best_acc_score: 0.8812; val_best_f1_score: 0.8866; train_kl_reg_loss: 67361.7789; train_edge_recon_loss: 2731035.6250; train_gene_expr_recon_loss: 10682879.6970; train_masked_gp_l1_reg_loss: 105598.1100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57634.0324; train_chrom_access_recon_loss: 1862488.5455; train_global_loss: 15506997.6970; train_optim_loss: 15506997.6970; val_kl_reg_loss: 47816.7944; val_edge_recon_loss: 2761576.0625; val_gene_expr_recon_loss: 10887821.8750; val_masked_gp_l1_reg_loss: 104928.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57424.0938; val_chrom_access_recon_loss: 1906438.4219; val_global_loss: 15766006.2500; val_optim_loss: 15766006.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9343; val_auprc_score: 0.8993; val_best_acc_score: 0.8858; val_best_f1_score: 0.8895; train_kl_reg_loss: 70199.1468; train_edge_recon_loss: 2729840.1174; train_gene_expr_recon_loss: 10660862.3788; train_masked_gp_l1_reg_loss: 104109.6519; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57426.4750; train_chrom_access_recon_loss: 1860741.9981; train_global_loss: 15483179.7424; train_optim_loss: 15483179.7424; val_kl_reg_loss: 45371.8848; val_edge_recon_loss: 2756691.2500; val_gene_expr_recon_loss: 10823462.0000; val_masked_gp_l1_reg_loss: 103431.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56886.7852; val_chrom_access_recon_loss: 1924264.1719; val_global_loss: 15710108.2500; val_optim_loss: 15710108.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9382; val_auprc_score: 0.9119; val_best_acc_score: 0.8823; val_best_f1_score: 0.8874; train_kl_reg_loss: 68607.4126; train_edge_recon_loss: 2718141.4962; train_gene_expr_recon_loss: 10628032.2727; train_masked_gp_l1_reg_loss: 102866.1011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57023.6177; train_chrom_access_recon_loss: 1854551.8144; train_global_loss: 15429222.7273; train_optim_loss: 15429222.7273; val_kl_reg_loss: 48190.3828; val_edge_recon_loss: 2768413.3750; val_gene_expr_recon_loss: 10818850.3750; val_masked_gp_l1_reg_loss: 102386.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57301.6250; val_chrom_access_recon_loss: 1902891.9844; val_global_loss: 15698035.2500; val_optim_loss: 15698035.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9411; val_auprc_score: 0.9153; val_best_acc_score: 0.8880; val_best_f1_score: 0.8923; train_kl_reg_loss: 63776.1286; train_edge_recon_loss: 2718392.0795; train_gene_expr_recon_loss: 10596534.4697; train_masked_gp_l1_reg_loss: 101759.8737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57025.4640; train_chrom_access_recon_loss: 1850660.4678; train_global_loss: 15388148.4545; train_optim_loss: 15388148.4545; val_kl_reg_loss: 51309.6689; val_edge_recon_loss: 2738108.8125; val_gene_expr_recon_loss: 10727554.2500; val_masked_gp_l1_reg_loss: 101268.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57080.7734; val_chrom_access_recon_loss: 1889124.4531; val_global_loss: 15564446.0000; val_optim_loss: 15564446.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9469; val_auprc_score: 0.9276; val_best_acc_score: 0.8920; val_best_f1_score: 0.8954; train_kl_reg_loss: 64880.6132; train_edge_recon_loss: 2718795.1326; train_gene_expr_recon_loss: 10578488.0606; train_masked_gp_l1_reg_loss: 100505.4332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56556.2789; train_chrom_access_recon_loss: 1846653.6439; train_global_loss: 15365879.2121; train_optim_loss: 15365879.2121; val_kl_reg_loss: 53946.5361; val_edge_recon_loss: 2715734.7500; val_gene_expr_recon_loss: 10726712.8750; val_masked_gp_l1_reg_loss: 99857.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56784.3594; val_chrom_access_recon_loss: 1888152.4531; val_global_loss: 15541187.7500; val_optim_loss: 15541187.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9432; val_auprc_score: 0.9138; val_best_acc_score: 0.8982; val_best_f1_score: 0.9032; train_kl_reg_loss: 62894.5177; train_edge_recon_loss: 2703955.9318; train_gene_expr_recon_loss: 10556518.7424; train_masked_gp_l1_reg_loss: 99267.4792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56549.7373; train_chrom_access_recon_loss: 1841995.4811; train_global_loss: 15321181.8636; train_optim_loss: 15321181.8636; val_kl_reg_loss: 52665.5898; val_edge_recon_loss: 2703321.2188; val_gene_expr_recon_loss: 10780873.5000; val_masked_gp_l1_reg_loss: 98813.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56393.1562; val_chrom_access_recon_loss: 1914373.7969; val_global_loss: 15606441.1250; val_optim_loss: 15606441.1250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9438; val_auprc_score: 0.9210; val_best_acc_score: 0.8925; val_best_f1_score: 0.8969; train_kl_reg_loss: 62680.0212; train_edge_recon_loss: 2712153.5947; train_gene_expr_recon_loss: 10543452.4091; train_masked_gp_l1_reg_loss: 98482.2952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56185.7051; train_chrom_access_recon_loss: 1840069.7235; train_global_loss: 15313023.7424; train_optim_loss: 15313023.7424; val_kl_reg_loss: 53710.5996; val_edge_recon_loss: 2741232.5000; val_gene_expr_recon_loss: 10724329.5000; val_masked_gp_l1_reg_loss: 98053.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55947.8320; val_chrom_access_recon_loss: 1885097.5000; val_global_loss: 15558372.0000; val_optim_loss: 15558372.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9441; val_auprc_score: 0.9148; val_best_acc_score: 0.8955; val_best_f1_score: 0.9011; train_kl_reg_loss: 61764.7578; train_edge_recon_loss: 2705608.4470; train_gene_expr_recon_loss: 10536981.3030; train_masked_gp_l1_reg_loss: 97674.1712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56071.7429; train_chrom_access_recon_loss: 1839661.7292; train_global_loss: 15297762.0000; train_optim_loss: 15297762.0000; val_kl_reg_loss: 53811.8633; val_edge_recon_loss: 2739881.5000; val_gene_expr_recon_loss: 10712379.0000; val_masked_gp_l1_reg_loss: 97373.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55843.5156; val_chrom_access_recon_loss: 1894629.9062; val_global_loss: 15553920.1250; val_optim_loss: 15553920.1250
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9434; val_auprc_score: 0.9169; val_best_acc_score: 0.8904; val_best_f1_score: 0.8950; train_kl_reg_loss: 62733.1552; train_edge_recon_loss: 2685513.4735; train_gene_expr_recon_loss: 10509439.9394; train_masked_gp_l1_reg_loss: 97012.8058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55708.3065; train_chrom_access_recon_loss: 1834673.7027; train_global_loss: 15245081.3030; train_optim_loss: 15245081.3030; val_kl_reg_loss: 53655.0312; val_edge_recon_loss: 2725266.4062; val_gene_expr_recon_loss: 10748464.8750; val_masked_gp_l1_reg_loss: 96749.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55890.5469; val_chrom_access_recon_loss: 1905732.6875; val_global_loss: 15585760.2500; val_optim_loss: 15585760.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9523; val_auprc_score: 0.9342; val_best_acc_score: 0.8979; val_best_f1_score: 0.9031; train_kl_reg_loss: 62641.8688; train_edge_recon_loss: 2700887.1326; train_gene_expr_recon_loss: 10500240.3485; train_masked_gp_l1_reg_loss: 95265.2579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48203.3915; train_chrom_access_recon_loss: 1830755.5606; train_global_loss: 15237993.3636; train_optim_loss: 15237993.3636; val_kl_reg_loss: 53726.9507; val_edge_recon_loss: 2705331.8125; val_gene_expr_recon_loss: 10727019.0000; val_masked_gp_l1_reg_loss: 94786.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46439.0156; val_chrom_access_recon_loss: 1876101.6250; val_global_loss: 15503405.5000; val_optim_loss: 15503405.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9456; val_auprc_score: 0.9177; val_best_acc_score: 0.9001; val_best_f1_score: 0.9054; train_kl_reg_loss: 62753.3613; train_edge_recon_loss: 2693607.1780; train_gene_expr_recon_loss: 10499704.0758; train_masked_gp_l1_reg_loss: 94713.1594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46152.5951; train_chrom_access_recon_loss: 1831027.3920; train_global_loss: 15227957.7424; train_optim_loss: 15227957.7424; val_kl_reg_loss: 55089.3154; val_edge_recon_loss: 2704580.8438; val_gene_expr_recon_loss: 10767012.3750; val_masked_gp_l1_reg_loss: 94653.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45950.7891; val_chrom_access_recon_loss: 1891379.6562; val_global_loss: 15558666.0000; val_optim_loss: 15558666.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9500; val_auprc_score: 0.9277; val_best_acc_score: 0.8952; val_best_f1_score: 0.9009; train_kl_reg_loss: 63044.0077; train_edge_recon_loss: 2702275.9924; train_gene_expr_recon_loss: 10490618.4848; train_masked_gp_l1_reg_loss: 94603.6404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45810.9772; train_chrom_access_recon_loss: 1828202.5227; train_global_loss: 15224555.6061; train_optim_loss: 15224555.6061; val_kl_reg_loss: 54951.2017; val_edge_recon_loss: 2724373.7812; val_gene_expr_recon_loss: 10808819.2500; val_masked_gp_l1_reg_loss: 94551.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45684.6719; val_chrom_access_recon_loss: 1894101.3438; val_global_loss: 15622481.6250; val_optim_loss: 15622481.6250
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9493; val_auprc_score: 0.9254; val_best_acc_score: 0.8958; val_best_f1_score: 0.9014; train_kl_reg_loss: 63249.3249; train_edge_recon_loss: 2691635.4924; train_gene_expr_recon_loss: 10491746.9091; train_masked_gp_l1_reg_loss: 94516.2547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45640.0364; train_chrom_access_recon_loss: 1829526.7841; train_global_loss: 15216314.7727; train_optim_loss: 15216314.7727; val_kl_reg_loss: 55203.5366; val_edge_recon_loss: 2696874.8125; val_gene_expr_recon_loss: 10724065.3750; val_masked_gp_l1_reg_loss: 94476.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45521.3555; val_chrom_access_recon_loss: 1879921.6406; val_global_loss: 15496062.3750; val_optim_loss: 15496062.3750
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9445; val_auprc_score: 0.9175; val_best_acc_score: 0.8955; val_best_f1_score: 0.8988; train_kl_reg_loss: 63352.1203; train_edge_recon_loss: 2695894.7841; train_gene_expr_recon_loss: 10484355.8333; train_masked_gp_l1_reg_loss: 94444.3808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45434.9319; train_chrom_access_recon_loss: 1828293.1402; train_global_loss: 15211775.1061; train_optim_loss: 15211775.1061; val_kl_reg_loss: 55094.9390; val_edge_recon_loss: 2732112.5625; val_gene_expr_recon_loss: 10642543.1250; val_masked_gp_l1_reg_loss: 94414.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45386.2617; val_chrom_access_recon_loss: 1881310.5156; val_global_loss: 15450861.0000; val_optim_loss: 15450861.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9448; val_auprc_score: 0.9211; val_best_acc_score: 0.8949; val_best_f1_score: 0.9010; train_kl_reg_loss: 63374.8831; train_edge_recon_loss: 2684403.2348; train_gene_expr_recon_loss: 10492589.4848; train_masked_gp_l1_reg_loss: 94376.6908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45324.3236; train_chrom_access_recon_loss: 1828924.8731; train_global_loss: 15208993.5303; train_optim_loss: 15208993.5303; val_kl_reg_loss: 54974.4141; val_edge_recon_loss: 2727449.2500; val_gene_expr_recon_loss: 10630326.6250; val_masked_gp_l1_reg_loss: 94335.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45240.9766; val_chrom_access_recon_loss: 1871218.9844; val_global_loss: 15423546.2500; val_optim_loss: 15423546.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9447; val_auprc_score: 0.9216; val_best_acc_score: 0.8939; val_best_f1_score: 0.8986; train_kl_reg_loss: 63285.7466; train_edge_recon_loss: 2693779.6894; train_gene_expr_recon_loss: 10484886.2424; train_masked_gp_l1_reg_loss: 94300.5573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45203.9566; train_chrom_access_recon_loss: 1827358.7008; train_global_loss: 15208814.8485; train_optim_loss: 15208814.8485; val_kl_reg_loss: 55811.7666; val_edge_recon_loss: 2731344.6250; val_gene_expr_recon_loss: 10764699.5000; val_masked_gp_l1_reg_loss: 94266.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45094.8945; val_chrom_access_recon_loss: 1883564.5000; val_global_loss: 15574781.3750; val_optim_loss: 15574781.3750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9443; val_auprc_score: 0.9217; val_best_acc_score: 0.8947; val_best_f1_score: 0.8991; train_kl_reg_loss: 63257.4222; train_edge_recon_loss: 2695927.3333; train_gene_expr_recon_loss: 10489237.6818; train_masked_gp_l1_reg_loss: 94236.0160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45058.6715; train_chrom_access_recon_loss: 1829972.0587; train_global_loss: 15217689.2576; train_optim_loss: 15217689.2576; val_kl_reg_loss: 55389.4653; val_edge_recon_loss: 2740073.1250; val_gene_expr_recon_loss: 10656629.0000; val_masked_gp_l1_reg_loss: 94205.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44993.1211; val_chrom_access_recon_loss: 1883306.5156; val_global_loss: 15474597.1250; val_optim_loss: 15474597.1250
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9463; val_auprc_score: 0.9190; val_best_acc_score: 0.8982; val_best_f1_score: 0.9030; train_kl_reg_loss: 62784.6213; train_edge_recon_loss: 2694565.8598; train_gene_expr_recon_loss: 10488004.8636; train_masked_gp_l1_reg_loss: 94169.2640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44938.8070; train_chrom_access_recon_loss: 1829474.4886; train_global_loss: 15213937.8485; train_optim_loss: 15213937.8485; val_kl_reg_loss: 55142.4702; val_edge_recon_loss: 2710696.0625; val_gene_expr_recon_loss: 10611571.2500; val_masked_gp_l1_reg_loss: 94131.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44888.8203; val_chrom_access_recon_loss: 1878869.7969; val_global_loss: 15395300.3750; val_optim_loss: 15395300.3750
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9486; val_auprc_score: 0.9283; val_best_acc_score: 0.9011; val_best_f1_score: 0.9070; train_kl_reg_loss: 62573.9261; train_edge_recon_loss: 2691972.5000; train_gene_expr_recon_loss: 10485889.5606; train_masked_gp_l1_reg_loss: 94086.2272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44835.1993; train_chrom_access_recon_loss: 1827363.4792; train_global_loss: 15206720.8485; train_optim_loss: 15206720.8485; val_kl_reg_loss: 55826.6807; val_edge_recon_loss: 2696688.9375; val_gene_expr_recon_loss: 10562605.0000; val_masked_gp_l1_reg_loss: 94056.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44757.9922; val_chrom_access_recon_loss: 1868630.1562; val_global_loss: 15322565.6250; val_optim_loss: 15322565.6250
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9491; val_auprc_score: 0.9258; val_best_acc_score: 0.8987; val_best_f1_score: 0.9047; train_kl_reg_loss: 62774.8497; train_edge_recon_loss: 2693011.6705; train_gene_expr_recon_loss: 10482024.8485; train_masked_gp_l1_reg_loss: 94020.6177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44761.8171; train_chrom_access_recon_loss: 1826136.2008; train_global_loss: 15202730.0455; train_optim_loss: 15202730.0455; val_kl_reg_loss: 55870.0874; val_edge_recon_loss: 2695327.6562; val_gene_expr_recon_loss: 10741551.8750; val_masked_gp_l1_reg_loss: 93977.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44660.7148; val_chrom_access_recon_loss: 1888478.1562; val_global_loss: 15519866.8750; val_optim_loss: 15519866.8750
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9459; val_auprc_score: 0.9260; val_best_acc_score: 0.8982; val_best_f1_score: 0.9014; train_kl_reg_loss: 62689.3981; train_edge_recon_loss: 2697507.2803; train_gene_expr_recon_loss: 10484947.1515; train_masked_gp_l1_reg_loss: 93940.1622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44638.9793; train_chrom_access_recon_loss: 1828733.4867; train_global_loss: 15212456.4091; train_optim_loss: 15212456.4091; val_kl_reg_loss: 56146.3193; val_edge_recon_loss: 2737886.0938; val_gene_expr_recon_loss: 10639332.2500; val_masked_gp_l1_reg_loss: 93906.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44614.0195; val_chrom_access_recon_loss: 1881520.5156; val_global_loss: 15453405.1250; val_optim_loss: 15453405.1250
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9474; val_auprc_score: 0.9243; val_best_acc_score: 0.8915; val_best_f1_score: 0.8974; train_kl_reg_loss: 62635.2121; train_edge_recon_loss: 2695519.4205; train_gene_expr_recon_loss: 10483694.3485; train_masked_gp_l1_reg_loss: 93859.3970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44547.2771; train_chrom_access_recon_loss: 1827776.4621; train_global_loss: 15208032.1970; train_optim_loss: 15208032.1970; val_kl_reg_loss: 55474.1128; val_edge_recon_loss: 2735345.7188; val_gene_expr_recon_loss: 10549134.2500; val_masked_gp_l1_reg_loss: 93820.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44479.6797; val_chrom_access_recon_loss: 1858710.3594; val_global_loss: 15336965.3750; val_optim_loss: 15336965.3750
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9472; val_auprc_score: 0.9230; val_best_acc_score: 0.8974; val_best_f1_score: 0.9031; train_kl_reg_loss: 62628.5790; train_edge_recon_loss: 2693543.6174; train_gene_expr_recon_loss: 10487928.3182; train_masked_gp_l1_reg_loss: 93783.8666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44455.2691; train_chrom_access_recon_loss: 1828867.4867; train_global_loss: 15211207.1667; train_optim_loss: 15211207.1667; val_kl_reg_loss: 56279.1963; val_edge_recon_loss: 2714114.0312; val_gene_expr_recon_loss: 10808070.3750; val_masked_gp_l1_reg_loss: 93744.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44409.8984; val_chrom_access_recon_loss: 1896500.2812; val_global_loss: 15613118.0000; val_optim_loss: 15613118.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9530; val_auprc_score: 0.9293; val_best_acc_score: 0.9046; val_best_f1_score: 0.9070; train_kl_reg_loss: 62618.2538; train_edge_recon_loss: 2692923.2045; train_gene_expr_recon_loss: 10481933.4697; train_masked_gp_l1_reg_loss: 93584.0595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43597.1214; train_chrom_access_recon_loss: 1827730.6610; train_global_loss: 15202386.7424; train_optim_loss: 15202386.7424; val_kl_reg_loss: 55890.2871; val_edge_recon_loss: 2717230.0625; val_gene_expr_recon_loss: 10710816.3750; val_masked_gp_l1_reg_loss: 93528.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43417.1992; val_chrom_access_recon_loss: 1882933.7812; val_global_loss: 15503815.3750; val_optim_loss: 15503815.3750
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9500; val_auprc_score: 0.9287; val_best_acc_score: 0.9014; val_best_f1_score: 0.9057; train_kl_reg_loss: 62739.5410; train_edge_recon_loss: 2685856.1364; train_gene_expr_recon_loss: 10474435.1212; train_masked_gp_l1_reg_loss: 93512.5282; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43383.7686; train_chrom_access_recon_loss: 1825152.7879; train_global_loss: 15185079.8485; train_optim_loss: 15185079.8485; val_kl_reg_loss: 55861.1265; val_edge_recon_loss: 2708845.4375; val_gene_expr_recon_loss: 10675841.1250; val_masked_gp_l1_reg_loss: 93498.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43356.7305; val_chrom_access_recon_loss: 1881324.2500; val_global_loss: 15458727.1250; val_optim_loss: 15458727.1250
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9483; val_auprc_score: 0.9267; val_best_acc_score: 0.9006; val_best_f1_score: 0.9034; train_kl_reg_loss: 62713.0082; train_edge_recon_loss: 2679710.5644; train_gene_expr_recon_loss: 10469888.9242; train_masked_gp_l1_reg_loss: 93489.5427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43334.5585; train_chrom_access_recon_loss: 1825068.8807; train_global_loss: 15174205.4697; train_optim_loss: 15174205.4697; val_kl_reg_loss: 56218.1787; val_edge_recon_loss: 2713724.3125; val_gene_expr_recon_loss: 10683536.6250; val_masked_gp_l1_reg_loss: 93480.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43312.5742; val_chrom_access_recon_loss: 1877813.8438; val_global_loss: 15468086.7500; val_optim_loss: 15468086.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9469; val_auprc_score: 0.9268; val_best_acc_score: 0.8947; val_best_f1_score: 0.8987; train_kl_reg_loss: 62746.1828; train_edge_recon_loss: 2692800.6742; train_gene_expr_recon_loss: 10483220.3636; train_masked_gp_l1_reg_loss: 93473.5645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43296.4181; train_chrom_access_recon_loss: 1828045.9886; train_global_loss: 15203583.0909; train_optim_loss: 15203583.0909; val_kl_reg_loss: 56200.3877; val_edge_recon_loss: 2729380.7812; val_gene_expr_recon_loss: 10612752.0000; val_masked_gp_l1_reg_loss: 93468.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43284.5586; val_chrom_access_recon_loss: 1868358.4375; val_global_loss: 15403445.7500; val_optim_loss: 15403445.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 18 min 1 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9415
val AUPRC score: 0.9167
val best accuracy score: 0.8904
val best F1 score: 0.8962
val target rna MSE score: 1.9711
val source rna MSE score: 1.1677
val target atac MSE score: 0.3387
val source atac MSE score: 0.1386
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
