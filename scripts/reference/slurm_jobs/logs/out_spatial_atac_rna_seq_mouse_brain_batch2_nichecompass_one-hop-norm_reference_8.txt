[True]
Run timestamp: 07082023_171720_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8669; val_auprc_score: 0.8869; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13386.2419; train_edge_recon_loss: 35879.4470; train_gene_expr_recon_loss: 1602453.1389; train_masked_gp_l1_reg_loss: 15710.4081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119260.3411; train_chrom_access_recon_loss: 3376533.5694; train_global_loss: 5163223.1111; train_optim_loss: 5163223.1111; val_kl_reg_loss: 6324.3848; val_edge_recon_loss: 40660.5117; val_gene_expr_recon_loss: 1379542.7500; val_masked_gp_l1_reg_loss: 10619.9121; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116994.2344; val_chrom_access_recon_loss: 1721919.3750; val_global_loss: 3276061.0000; val_optim_loss: 3276061.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8821; val_auprc_score: 0.9009; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5238.6601; train_edge_recon_loss: 36301.7227; train_gene_expr_recon_loss: 1239155.9028; train_masked_gp_l1_reg_loss: 9220.3822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115710.2665; train_chrom_access_recon_loss: 1540781.4583; train_global_loss: 2946408.4167; train_optim_loss: 2946408.4167; val_kl_reg_loss: 4390.7266; val_edge_recon_loss: 40660.5469; val_gene_expr_recon_loss: 1153876.2500; val_masked_gp_l1_reg_loss: 8612.8135; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114223.8438; val_chrom_access_recon_loss: 1469617.3750; val_global_loss: 2791381.5000; val_optim_loss: 2791381.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8879; val_auprc_score: 0.9073; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5015.6611; train_edge_recon_loss: 36331.8273; train_gene_expr_recon_loss: 1085799.0000; train_masked_gp_l1_reg_loss: 9371.2752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113127.4774; train_chrom_access_recon_loss: 1439828.6389; train_global_loss: 2689473.8889; train_optim_loss: 2689473.8889; val_kl_reg_loss: 7090.8711; val_edge_recon_loss: 40661.4023; val_gene_expr_recon_loss: 1028162.0000; val_masked_gp_l1_reg_loss: 10147.0879; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111761.8125; val_chrom_access_recon_loss: 1436216.2500; val_global_loss: 2634039.5000; val_optim_loss: 2634039.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8896; val_auprc_score: 0.9055; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 11467.7476; train_edge_recon_loss: 37588.0308; train_gene_expr_recon_loss: 954152.5556; train_masked_gp_l1_reg_loss: 10432.7599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110648.7543; train_chrom_access_recon_loss: 1412814.0139; train_global_loss: 2537103.9167; train_optim_loss: 2537103.9167; val_kl_reg_loss: 17203.5469; val_edge_recon_loss: 40662.1680; val_gene_expr_recon_loss: 890137.5000; val_masked_gp_l1_reg_loss: 10714.0957; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109230.8438; val_chrom_access_recon_loss: 1412895.1250; val_global_loss: 2480843.2500; val_optim_loss: 2480843.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8988; val_auprc_score: 0.9107; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 20408.9065; train_edge_recon_loss: 38789.1845; train_gene_expr_recon_loss: 835555.7431; train_masked_gp_l1_reg_loss: 10810.1365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108006.0807; train_chrom_access_recon_loss: 1386121.8056; train_global_loss: 2399691.8611; train_optim_loss: 2399691.8611; val_kl_reg_loss: 21928.6953; val_edge_recon_loss: 40661.9180; val_gene_expr_recon_loss: 797884.6875; val_masked_gp_l1_reg_loss: 10864.0439; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106388.1641; val_chrom_access_recon_loss: 1384221.2500; val_global_loss: 2361948.7500; val_optim_loss: 2361948.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8948; val_auprc_score: 0.9020; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 22500.2185; train_edge_recon_loss: 38948.0521; train_gene_expr_recon_loss: 768399.6181; train_masked_gp_l1_reg_loss: 10864.1733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104953.8420; train_chrom_access_recon_loss: 1356365.2222; train_global_loss: 2302031.1389; train_optim_loss: 2302031.1389; val_kl_reg_loss: 22824.1875; val_edge_recon_loss: 40661.2812; val_gene_expr_recon_loss: 756218.4375; val_masked_gp_l1_reg_loss: 10819.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103079.9062; val_chrom_access_recon_loss: 1356436.3750; val_global_loss: 2290040.0000; val_optim_loss: 2290040.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8883; val_auprc_score: 0.8941; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 23220.1011; train_edge_recon_loss: 39011.8594; train_gene_expr_recon_loss: 733452.5694; train_masked_gp_l1_reg_loss: 10789.1508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101473.6311; train_chrom_access_recon_loss: 1336014.7778; train_global_loss: 2243962.0000; train_optim_loss: 2243962.0000; val_kl_reg_loss: 23164.7930; val_edge_recon_loss: 40660.1367; val_gene_expr_recon_loss: 732410.0000; val_masked_gp_l1_reg_loss: 10742.4102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99415.7422; val_chrom_access_recon_loss: 1342236.3750; val_global_loss: 2248629.5000; val_optim_loss: 2248629.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8779; val_auprc_score: 0.8837; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 23778.3874; train_edge_recon_loss: 39036.6211; train_gene_expr_recon_loss: 713561.7708; train_masked_gp_l1_reg_loss: 10692.0681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97715.6528; train_chrom_access_recon_loss: 1328648.7778; train_global_loss: 2213433.3056; train_optim_loss: 2213433.3056; val_kl_reg_loss: 23402.6523; val_edge_recon_loss: 40657.6289; val_gene_expr_recon_loss: 716255.7500; val_masked_gp_l1_reg_loss: 10616.4512; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95570.4062; val_chrom_access_recon_loss: 1333690.2500; val_global_loss: 2220193.0000; val_optim_loss: 2220193.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8560; val_auprc_score: 0.8614; val_best_acc_score: 0.5046; val_best_f1_score: 0.6686; train_kl_reg_loss: 23665.4449; train_edge_recon_loss: 39056.4158; train_gene_expr_recon_loss: 698453.3472; train_masked_gp_l1_reg_loss: 10542.6783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93840.0460; train_chrom_access_recon_loss: 1317580.9306; train_global_loss: 2183138.8889; train_optim_loss: 2183138.8889; val_kl_reg_loss: 23432.2422; val_edge_recon_loss: 40653.2422; val_gene_expr_recon_loss: 703325.9375; val_masked_gp_l1_reg_loss: 10445.7412; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91669.9375; val_chrom_access_recon_loss: 1327668.0000; val_global_loss: 2197195.0000; val_optim_loss: 2197195.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8447; val_auprc_score: 0.8430; val_best_acc_score: 0.5230; val_best_f1_score: 0.6768; train_kl_reg_loss: 23640.2958; train_edge_recon_loss: 39077.7027; train_gene_expr_recon_loss: 683810.4653; train_masked_gp_l1_reg_loss: 10370.8697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89926.3915; train_chrom_access_recon_loss: 1313076.9861; train_global_loss: 2159902.7222; train_optim_loss: 2159902.7222; val_kl_reg_loss: 23159.9785; val_edge_recon_loss: 40640.8359; val_gene_expr_recon_loss: 691979.1875; val_masked_gp_l1_reg_loss: 10280.5059; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87751.2656; val_chrom_access_recon_loss: 1323110.2500; val_global_loss: 2176922.0000; val_optim_loss: 2176922.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8485; val_auprc_score: 0.8476; val_best_acc_score: 0.5555; val_best_f1_score: 0.6908; train_kl_reg_loss: 23797.0501; train_edge_recon_loss: 39093.9484; train_gene_expr_recon_loss: 676516.3194; train_masked_gp_l1_reg_loss: 10207.4016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86030.8932; train_chrom_access_recon_loss: 1305469.9028; train_global_loss: 2141115.5000; train_optim_loss: 2141115.5000; val_kl_reg_loss: 23623.7344; val_edge_recon_loss: 40622.8047; val_gene_expr_recon_loss: 682066.2500; val_masked_gp_l1_reg_loss: 10121.3164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83893.0391; val_chrom_access_recon_loss: 1319284.2500; val_global_loss: 2159611.5000; val_optim_loss: 2159611.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8520; val_auprc_score: 0.8506; val_best_acc_score: 0.5951; val_best_f1_score: 0.7084; train_kl_reg_loss: 24050.7604; train_edge_recon_loss: 39128.5582; train_gene_expr_recon_loss: 672082.0208; train_masked_gp_l1_reg_loss: 10047.3684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82216.9253; train_chrom_access_recon_loss: 1299850.3333; train_global_loss: 2127375.9722; train_optim_loss: 2127375.9722; val_kl_reg_loss: 24393.9609; val_edge_recon_loss: 40597.3555; val_gene_expr_recon_loss: 674624.7500; val_masked_gp_l1_reg_loss: 9964.6367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80141.6484; val_chrom_access_recon_loss: 1316262.1250; val_global_loss: 2145984.5000; val_optim_loss: 2145984.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8505; val_auprc_score: 0.8487; val_best_acc_score: 0.6423; val_best_f1_score: 0.7315; train_kl_reg_loss: 24009.7374; train_edge_recon_loss: 39142.6710; train_gene_expr_recon_loss: 662400.3611; train_masked_gp_l1_reg_loss: 9913.7515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78521.5469; train_chrom_access_recon_loss: 1300732.4861; train_global_loss: 2114720.6111; train_optim_loss: 2114720.6111; val_kl_reg_loss: 23386.8086; val_edge_recon_loss: 40561.4805; val_gene_expr_recon_loss: 670183.6250; val_masked_gp_l1_reg_loss: 9848.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76519.7969; val_chrom_access_recon_loss: 1312695.7500; val_global_loss: 2133195.7500; val_optim_loss: 2133195.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8564; val_auprc_score: 0.8538; val_best_acc_score: 0.6737; val_best_f1_score: 0.7467; train_kl_reg_loss: 23716.8570; train_edge_recon_loss: 39130.4770; train_gene_expr_recon_loss: 660665.6389; train_masked_gp_l1_reg_loss: 9791.5565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74962.0399; train_chrom_access_recon_loss: 1300538.2778; train_global_loss: 2108804.8472; train_optim_loss: 2108804.8472; val_kl_reg_loss: 22479.7305; val_edge_recon_loss: 40540.3086; val_gene_expr_recon_loss: 667366.7500; val_masked_gp_l1_reg_loss: 9725.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73034.3984; val_chrom_access_recon_loss: 1309856.7500; val_global_loss: 2123003.5000; val_optim_loss: 2123003.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8633; val_auprc_score: 0.8621; val_best_acc_score: 0.6977; val_best_f1_score: 0.7585; train_kl_reg_loss: 23203.5792; train_edge_recon_loss: 39104.5694; train_gene_expr_recon_loss: 655826.6944; train_masked_gp_l1_reg_loss: 9688.7083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71536.8594; train_chrom_access_recon_loss: 1291695.2222; train_global_loss: 2091055.6389; train_optim_loss: 2091055.6389; val_kl_reg_loss: 22282.7266; val_edge_recon_loss: 40523.0859; val_gene_expr_recon_loss: 664179.6250; val_masked_gp_l1_reg_loss: 9640.3887; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69692.6719; val_chrom_access_recon_loss: 1306904.2500; val_global_loss: 2113222.7500; val_optim_loss: 2113222.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8692; val_auprc_score: 0.8607; val_best_acc_score: 0.7474; val_best_f1_score: 0.7871; train_kl_reg_loss: 22861.4293; train_edge_recon_loss: 39077.1528; train_gene_expr_recon_loss: 653911.9653; train_masked_gp_l1_reg_loss: 9608.5910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68269.2908; train_chrom_access_recon_loss: 1291009.5278; train_global_loss: 2084737.9722; train_optim_loss: 2084737.9722; val_kl_reg_loss: 21922.7148; val_edge_recon_loss: 40478.8203; val_gene_expr_recon_loss: 661822.5000; val_masked_gp_l1_reg_loss: 9564.7549; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66515.0703; val_chrom_access_recon_loss: 1304875.5000; val_global_loss: 2105179.5000; val_optim_loss: 2105179.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8784; val_auprc_score: 0.8728; val_best_acc_score: 0.7720; val_best_f1_score: 0.7998; train_kl_reg_loss: 22567.1756; train_edge_recon_loss: 39033.3351; train_gene_expr_recon_loss: 650357.7778; train_masked_gp_l1_reg_loss: 9546.6144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65165.9770; train_chrom_access_recon_loss: 1293736.7361; train_global_loss: 2080407.6528; train_optim_loss: 2080407.6528; val_kl_reg_loss: 21322.1934; val_edge_recon_loss: 40432.8164; val_gene_expr_recon_loss: 660045.1250; val_masked_gp_l1_reg_loss: 9517.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63507.4141; val_chrom_access_recon_loss: 1302817.3750; val_global_loss: 2097642.5000; val_optim_loss: 2097642.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8838; val_auprc_score: 0.8774; val_best_acc_score: 0.7906; val_best_f1_score: 0.8101; train_kl_reg_loss: 22192.2263; train_edge_recon_loss: 38998.5816; train_gene_expr_recon_loss: 650212.3264; train_masked_gp_l1_reg_loss: 9497.2295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62231.4379; train_chrom_access_recon_loss: 1293782.5000; train_global_loss: 2076914.3333; train_optim_loss: 2076914.3333; val_kl_reg_loss: 21098.3613; val_edge_recon_loss: 40391.0352; val_gene_expr_recon_loss: 658138.8125; val_masked_gp_l1_reg_loss: 9464.2021; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60661.2188; val_chrom_access_recon_loss: 1300529.7500; val_global_loss: 2090283.3750; val_optim_loss: 2090283.3750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8928; val_auprc_score: 0.8872; val_best_acc_score: 0.8050; val_best_f1_score: 0.8181; train_kl_reg_loss: 21753.6181; train_edge_recon_loss: 38945.6189; train_gene_expr_recon_loss: 648561.5069; train_masked_gp_l1_reg_loss: 9446.6542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59457.1341; train_chrom_access_recon_loss: 1291026.0000; train_global_loss: 2069190.5139; train_optim_loss: 2069190.5139; val_kl_reg_loss: 20606.5625; val_edge_recon_loss: 40355.3633; val_gene_expr_recon_loss: 656717.1250; val_masked_gp_l1_reg_loss: 9430.4756; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57974.7344; val_chrom_access_recon_loss: 1300660.2500; val_global_loss: 2085744.5000; val_optim_loss: 2085744.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8955; val_auprc_score: 0.8905; val_best_acc_score: 0.8176; val_best_f1_score: 0.8260; train_kl_reg_loss: 21370.5640; train_edge_recon_loss: 38912.1923; train_gene_expr_recon_loss: 644794.8403; train_masked_gp_l1_reg_loss: 9412.9148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56839.9158; train_chrom_access_recon_loss: 1284859.8611; train_global_loss: 2056190.2778; train_optim_loss: 2056190.2778; val_kl_reg_loss: 20504.4688; val_edge_recon_loss: 40310.2031; val_gene_expr_recon_loss: 655028.8125; val_masked_gp_l1_reg_loss: 9395.0674; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55442.4805; val_chrom_access_recon_loss: 1298431.2500; val_global_loss: 2079112.2500; val_optim_loss: 2079112.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9016; val_auprc_score: 0.8934; val_best_acc_score: 0.8285; val_best_f1_score: 0.8320; train_kl_reg_loss: 21009.6760; train_edge_recon_loss: 38854.6497; train_gene_expr_recon_loss: 645332.7986; train_masked_gp_l1_reg_loss: 9375.1908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54372.2378; train_chrom_access_recon_loss: 1287163.3750; train_global_loss: 2056107.9306; train_optim_loss: 2056107.9306; val_kl_reg_loss: 19904.5566; val_edge_recon_loss: 40269.3477; val_gene_expr_recon_loss: 653872.1250; val_masked_gp_l1_reg_loss: 9350.7041; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53057.1797; val_chrom_access_recon_loss: 1296128.8750; val_global_loss: 2072582.7500; val_optim_loss: 2072582.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9077; val_auprc_score: 0.9032; val_best_acc_score: 0.8310; val_best_f1_score: 0.8309; train_kl_reg_loss: 20655.2750; train_edge_recon_loss: 38803.3459; train_gene_expr_recon_loss: 643484.9653; train_masked_gp_l1_reg_loss: 9335.7297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52049.2418; train_chrom_access_recon_loss: 1282748.8750; train_global_loss: 2047077.4583; train_optim_loss: 2047077.4583; val_kl_reg_loss: 19693.2129; val_edge_recon_loss: 40213.7422; val_gene_expr_recon_loss: 652569.2500; val_masked_gp_l1_reg_loss: 9313.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50807.3125; val_chrom_access_recon_loss: 1294637.8750; val_global_loss: 2067234.5000; val_optim_loss: 2067234.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9068; val_auprc_score: 0.8958; val_best_acc_score: 0.8325; val_best_f1_score: 0.8284; train_kl_reg_loss: 20333.1204; train_edge_recon_loss: 38743.8220; train_gene_expr_recon_loss: 642470.9931; train_masked_gp_l1_reg_loss: 9304.0457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49859.0898; train_chrom_access_recon_loss: 1283994.0556; train_global_loss: 2044705.1111; train_optim_loss: 2044705.1111; val_kl_reg_loss: 19105.3789; val_edge_recon_loss: 40162.9414; val_gene_expr_recon_loss: 651880.2500; val_masked_gp_l1_reg_loss: 9291.8809; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48691.7344; val_chrom_access_recon_loss: 1293414.1250; val_global_loss: 2062546.2500; val_optim_loss: 2062546.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9171; val_auprc_score: 0.9088; val_best_acc_score: 0.8370; val_best_f1_score: 0.8291; train_kl_reg_loss: 20102.9883; train_edge_recon_loss: 38691.1185; train_gene_expr_recon_loss: 640512.7986; train_masked_gp_l1_reg_loss: 9283.2329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47798.4158; train_chrom_access_recon_loss: 1282549.1250; train_global_loss: 2038937.6667; train_optim_loss: 2038937.6667; val_kl_reg_loss: 19129.8535; val_edge_recon_loss: 40080.7656; val_gene_expr_recon_loss: 650560.5625; val_masked_gp_l1_reg_loss: 9265.1865; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46697.4688; val_chrom_access_recon_loss: 1290842.1250; val_global_loss: 2056576.0000; val_optim_loss: 2056576.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9198; val_auprc_score: 0.9113; val_best_acc_score: 0.8332; val_best_f1_score: 0.8216; train_kl_reg_loss: 19931.0054; train_edge_recon_loss: 38639.4575; train_gene_expr_recon_loss: 640155.9653; train_masked_gp_l1_reg_loss: 9250.9819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45858.4006; train_chrom_access_recon_loss: 1278667.9444; train_global_loss: 2032503.7639; train_optim_loss: 2032503.7639; val_kl_reg_loss: 18715.9805; val_edge_recon_loss: 40015.1680; val_gene_expr_recon_loss: 649862.0000; val_masked_gp_l1_reg_loss: 9223.4785; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44822.5469; val_chrom_access_recon_loss: 1289106.2500; val_global_loss: 2051745.5000; val_optim_loss: 2051745.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9114; val_auprc_score: 0.9030; val_best_acc_score: 0.8371; val_best_f1_score: 0.8435; train_kl_reg_loss: 16293.3553; train_edge_recon_loss: 39852.9266; train_gene_expr_recon_loss: 1006623.2569; train_masked_gp_l1_reg_loss: 9423.3955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43942.8793; train_chrom_access_recon_loss: 1348501.2500; train_global_loss: 2464637.0000; train_optim_loss: 2464637.0000; val_kl_reg_loss: 14445.5781; val_edge_recon_loss: 40290.7031; val_gene_expr_recon_loss: 1017579.3125; val_masked_gp_l1_reg_loss: 9800.3301; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42801.2461; val_chrom_access_recon_loss: 1357195.7500; val_global_loss: 2482113.0000; val_optim_loss: 2482113.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9127; val_auprc_score: 0.9004; val_best_acc_score: 0.8410; val_best_f1_score: 0.8471; train_kl_reg_loss: 15643.3049; train_edge_recon_loss: 39871.2717; train_gene_expr_recon_loss: 1002021.3472; train_masked_gp_l1_reg_loss: 10145.1689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41877.1437; train_chrom_access_recon_loss: 1346164.6667; train_global_loss: 2455722.8611; train_optim_loss: 2455722.8611; val_kl_reg_loss: 14458.6484; val_edge_recon_loss: 40296.2734; val_gene_expr_recon_loss: 1009732.1250; val_masked_gp_l1_reg_loss: 10573.2275; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40738.1562; val_chrom_access_recon_loss: 1355006.8750; val_global_loss: 2470805.2500; val_optim_loss: 2470805.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9182; val_auprc_score: 0.9107; val_best_acc_score: 0.8456; val_best_f1_score: 0.8484; train_kl_reg_loss: 16014.6049; train_edge_recon_loss: 39883.8446; train_gene_expr_recon_loss: 991957.5694; train_masked_gp_l1_reg_loss: 10868.2260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39861.2760; train_chrom_access_recon_loss: 1340844.8611; train_global_loss: 2439430.4167; train_optim_loss: 2439430.4167; val_kl_reg_loss: 14948.0449; val_edge_recon_loss: 40235.6562; val_gene_expr_recon_loss: 1002880.8750; val_masked_gp_l1_reg_loss: 11186.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38786.1719; val_chrom_access_recon_loss: 1352810.5000; val_global_loss: 2460848.0000; val_optim_loss: 2460848.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9214; val_auprc_score: 0.9132; val_best_acc_score: 0.8504; val_best_f1_score: 0.8489; train_kl_reg_loss: 16223.8030; train_edge_recon_loss: 39866.7335; train_gene_expr_recon_loss: 983239.0694; train_masked_gp_l1_reg_loss: 11383.1540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37964.5599; train_chrom_access_recon_loss: 1340773.8611; train_global_loss: 2429451.1389; train_optim_loss: 2429451.1389; val_kl_reg_loss: 15057.1602; val_edge_recon_loss: 40187.1719; val_gene_expr_recon_loss: 997737.8750; val_masked_gp_l1_reg_loss: 11588.8066; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36959.6914; val_chrom_access_recon_loss: 1351101.5000; val_global_loss: 2452632.2500; val_optim_loss: 2452632.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9208; val_auprc_score: 0.9063; val_best_acc_score: 0.8499; val_best_f1_score: 0.8488; train_kl_reg_loss: 16183.6827; train_edge_recon_loss: 39831.7279; train_gene_expr_recon_loss: 979245.8819; train_masked_gp_l1_reg_loss: 11524.7922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36849.0391; train_chrom_access_recon_loss: 1332737.0694; train_global_loss: 2416372.1944; train_optim_loss: 2416372.1944; val_kl_reg_loss: 15356.7119; val_edge_recon_loss: 40190.8477; val_gene_expr_recon_loss: 997044.3750; val_masked_gp_l1_reg_loss: 11473.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36714.1758; val_chrom_access_recon_loss: 1350768.5000; val_global_loss: 2451548.0000; val_optim_loss: 2451548.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9217; val_auprc_score: 0.9096; val_best_acc_score: 0.8495; val_best_f1_score: 0.8481; train_kl_reg_loss: 16428.7091; train_edge_recon_loss: 39835.9158; train_gene_expr_recon_loss: 983220.7083; train_masked_gp_l1_reg_loss: 11462.6785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36618.8194; train_chrom_access_recon_loss: 1341122.8611; train_global_loss: 2428689.6944; train_optim_loss: 2428689.6944; val_kl_reg_loss: 15337.8262; val_edge_recon_loss: 40171.9258; val_gene_expr_recon_loss: 996638.5000; val_masked_gp_l1_reg_loss: 11443.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36499.0664; val_chrom_access_recon_loss: 1350674.0000; val_global_loss: 2450765.0000; val_optim_loss: 2450765.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9236; val_auprc_score: 0.9151; val_best_acc_score: 0.8504; val_best_f1_score: 0.8487; train_kl_reg_loss: 16357.1273; train_edge_recon_loss: 39827.9049; train_gene_expr_recon_loss: 985207.3333; train_masked_gp_l1_reg_loss: 11436.5118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36407.9774; train_chrom_access_recon_loss: 1340219.0556; train_global_loss: 2429455.8611; train_optim_loss: 2429455.8611; val_kl_reg_loss: 15305.3730; val_edge_recon_loss: 40178.5859; val_gene_expr_recon_loss: 996229.3750; val_masked_gp_l1_reg_loss: 11429.3447; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36295.5508; val_chrom_access_recon_loss: 1350470.5000; val_global_loss: 2449908.7500; val_optim_loss: 2449908.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9201; val_auprc_score: 0.9052; val_best_acc_score: 0.8519; val_best_f1_score: 0.8499; train_kl_reg_loss: 16378.8021; train_edge_recon_loss: 39832.6749; train_gene_expr_recon_loss: 981832.2431; train_masked_gp_l1_reg_loss: 11427.9575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36207.7743; train_chrom_access_recon_loss: 1339911.7361; train_global_loss: 2425591.1944; train_optim_loss: 2425591.1944; val_kl_reg_loss: 15376.3301; val_edge_recon_loss: 40180.7031; val_gene_expr_recon_loss: 995801.3125; val_masked_gp_l1_reg_loss: 11427.4600; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36100.8242; val_chrom_access_recon_loss: 1350515.0000; val_global_loss: 2449401.7500; val_optim_loss: 2449401.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 6 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9124
val AUPRC score: 0.8981
val best accuracy score: 0.8421
val best F1 score: 0.8501
val target rna MSE score: 4.1159
val source rna MSE score: 3.2613
val target atac MSE score: 0.1394
val source atac MSE score: 0.0198
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
