[True]
Run timestamp: 29072023_114455_71.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_71']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8697; val_auprc_score: 0.8893; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 28504.3052; train_edge_recon_loss: 3509877.2222; train_gene_expr_recon_loss: 819277.9236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 183335989.3333; train_global_loss: 187693648.0000; train_optim_loss: 187693648.0000; val_kl_reg_loss: 71033.9219; val_edge_recon_loss: 4065978.0000; val_gene_expr_recon_loss: 779490.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 173372288.0000; val_global_loss: 178288784.0000; val_optim_loss: 178288784.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8727; val_auprc_score: 0.8934; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 47642.1163; train_edge_recon_loss: 3613039.6667; train_gene_expr_recon_loss: 790362.9097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 173493614.2222; train_global_loss: 177944661.3333; train_optim_loss: 177944661.3333; val_kl_reg_loss: 73000.9375; val_edge_recon_loss: 4066142.5000; val_gene_expr_recon_loss: 746669.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 171292400.0000; val_global_loss: 176178208.0000; val_optim_loss: 176178208.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8707; val_auprc_score: 0.8888; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 63935.6484; train_edge_recon_loss: 3662342.9722; train_gene_expr_recon_loss: 727324.7847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 170365025.7778; train_global_loss: 174818629.3333; train_optim_loss: 174818629.3333; val_kl_reg_loss: 48657.5000; val_edge_recon_loss: 4066167.5000; val_gene_expr_recon_loss: 723911.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 168878976.0000; val_global_loss: 173717712.0000; val_optim_loss: 173717712.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8633; val_auprc_score: 0.8817; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 76906.5152; train_edge_recon_loss: 3689483.2500; train_gene_expr_recon_loss: 718811.2431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 168347783.1111; train_global_loss: 172832984.8889; train_optim_loss: 172832984.8889; val_kl_reg_loss: 69249.7109; val_edge_recon_loss: 4066194.5000; val_gene_expr_recon_loss: 719206.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 167323136.0000; val_global_loss: 172177792.0000; val_optim_loss: 172177792.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8604; val_auprc_score: 0.8762; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 71548.8498; train_edge_recon_loss: 3719527.1389; train_gene_expr_recon_loss: 694966.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 166271605.3333; train_global_loss: 170757646.2222; train_optim_loss: 170757646.2222; val_kl_reg_loss: 137890.0000; val_edge_recon_loss: 4066194.5000; val_gene_expr_recon_loss: 690837.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 166014352.0000; val_global_loss: 170909280.0000; val_optim_loss: 170909280.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8564; val_auprc_score: 0.8761; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 114515.7977; train_edge_recon_loss: 3674910.2500; train_gene_expr_recon_loss: 680820.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 165113157.3333; train_global_loss: 169583404.4444; train_optim_loss: 169583404.4444; val_kl_reg_loss: 136906.1875; val_edge_recon_loss: 4066188.0000; val_gene_expr_recon_loss: 682202.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 164543808.0000; val_global_loss: 169429104.0000; val_optim_loss: 169429104.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8482; val_auprc_score: 0.8682; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 117155.0512; train_edge_recon_loss: 3665991.2222; train_gene_expr_recon_loss: 669288.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 163628725.3333; train_global_loss: 168081159.1111; train_optim_loss: 168081159.1111; val_kl_reg_loss: 129494.1250; val_edge_recon_loss: 4066157.7500; val_gene_expr_recon_loss: 663356.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 163832896.0000; val_global_loss: 168691904.0000; val_optim_loss: 168691904.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8534; val_auprc_score: 0.8696; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 144125.6962; train_edge_recon_loss: 3628285.3333; train_gene_expr_recon_loss: 646537.2014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 163062488.8889; train_global_loss: 167481436.4444; train_optim_loss: 167481436.4444; val_kl_reg_loss: 98960.6875; val_edge_recon_loss: 4066140.7500; val_gene_expr_recon_loss: 643210.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 162772960.0000; val_global_loss: 167581280.0000; val_optim_loss: 167581280.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8494; val_auprc_score: 0.8654; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 127064.1007; train_edge_recon_loss: 3640183.1944; train_gene_expr_recon_loss: 627037.0486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 161246544.0000; train_global_loss: 165640828.4444; train_optim_loss: 165640828.4444; val_kl_reg_loss: 148237.9062; val_edge_recon_loss: 4066101.0000; val_gene_expr_recon_loss: 619084.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 161564064.0000; val_global_loss: 166397488.0000; val_optim_loss: 166397488.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8588; val_auprc_score: 0.8679; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 143999.7873; train_edge_recon_loss: 3606162.3611; train_gene_expr_recon_loss: 601709.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 160071866.6667; train_global_loss: 164423738.6667; train_optim_loss: 164423738.6667; val_kl_reg_loss: 124522.1562; val_edge_recon_loss: 4065974.2500; val_gene_expr_recon_loss: 594601.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 160661152.0000; val_global_loss: 165446256.0000; val_optim_loss: 165446256.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8450; val_auprc_score: 0.8505; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 137873.7726; train_edge_recon_loss: 3591475.0833; train_gene_expr_recon_loss: 575526.2153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 159533500.4444; train_global_loss: 163838375.1111; train_optim_loss: 163838375.1111; val_kl_reg_loss: 131901.9062; val_edge_recon_loss: 4065788.5000; val_gene_expr_recon_loss: 567913.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 159535984.0000; val_global_loss: 164301584.0000; val_optim_loss: 164301584.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8404; val_auprc_score: 0.8458; val_best_acc_score: 0.5030; val_best_f1_score: 0.6680; train_kl_reg_loss: 139068.1059; train_edge_recon_loss: 3583990.3889; train_gene_expr_recon_loss: 548894.5694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 158064755.5556; train_global_loss: 162336707.5556; train_optim_loss: 162336707.5556; val_kl_reg_loss: 130425.6719; val_edge_recon_loss: 4065457.0000; val_gene_expr_recon_loss: 542088.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 158468320.0000; val_global_loss: 163206288.0000; val_optim_loss: 163206288.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8189; val_auprc_score: 0.8178; val_best_acc_score: 0.5120; val_best_f1_score: 0.6720; train_kl_reg_loss: 140678.6571; train_edge_recon_loss: 3575462.0278; train_gene_expr_recon_loss: 524214.5972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 157325425.7778; train_global_loss: 161565781.3333; train_optim_loss: 161565781.3333; val_kl_reg_loss: 124580.5938; val_edge_recon_loss: 4064962.7500; val_gene_expr_recon_loss: 519669.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 157056064.0000; val_global_loss: 161765280.0000; val_optim_loss: 161765280.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7999; val_auprc_score: 0.7978; val_best_acc_score: 0.5205; val_best_f1_score: 0.6754; train_kl_reg_loss: 141730.5035; train_edge_recon_loss: 3569224.2778; train_gene_expr_recon_loss: 502011.6424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155668248.8889; train_global_loss: 159881216.0000; train_optim_loss: 159881216.0000; val_kl_reg_loss: 115511.3281; val_edge_recon_loss: 4064363.2500; val_gene_expr_recon_loss: 500868.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156177776.0000; val_global_loss: 160858512.0000; val_optim_loss: 160858512.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7938; val_auprc_score: 0.7868; val_best_acc_score: 0.5344; val_best_f1_score: 0.6812; train_kl_reg_loss: 137495.2656; train_edge_recon_loss: 3567345.8333; train_gene_expr_recon_loss: 485397.6528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155315628.4444; train_global_loss: 159505868.4444; train_optim_loss: 159505868.4444; val_kl_reg_loss: 122007.3906; val_edge_recon_loss: 4063570.7500; val_gene_expr_recon_loss: 484391.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155832176.0000; val_global_loss: 160502144.0000; val_optim_loss: 160502144.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7830; val_auprc_score: 0.7801; val_best_acc_score: 0.5458; val_best_f1_score: 0.6857; train_kl_reg_loss: 133526.9297; train_edge_recon_loss: 3564498.1111; train_gene_expr_recon_loss: 472510.8368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155688670.2222; train_global_loss: 159859208.8889; train_optim_loss: 159859208.8889; val_kl_reg_loss: 124148.3516; val_edge_recon_loss: 4062855.2500; val_gene_expr_recon_loss: 468448.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155023904.0000; val_global_loss: 159679360.0000; val_optim_loss: 159679360.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7768; val_auprc_score: 0.7753; val_best_acc_score: 0.5539; val_best_f1_score: 0.6883; train_kl_reg_loss: 136464.6155; train_edge_recon_loss: 3554375.8056; train_gene_expr_recon_loss: 456227.6354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154224876.4444; train_global_loss: 158371943.1111; train_optim_loss: 158371943.1111; val_kl_reg_loss: 120200.2812; val_edge_recon_loss: 4062215.0000; val_gene_expr_recon_loss: 456768.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154660800.0000; val_global_loss: 159299984.0000; val_optim_loss: 159299984.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7696; val_auprc_score: 0.7643; val_best_acc_score: 0.5682; val_best_f1_score: 0.6943; train_kl_reg_loss: 132461.8524; train_edge_recon_loss: 3555583.4444; train_gene_expr_recon_loss: 445341.7569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154033552.0000; train_global_loss: 158166942.2222; train_optim_loss: 158166942.2222; val_kl_reg_loss: 118999.0625; val_edge_recon_loss: 4061358.0000; val_gene_expr_recon_loss: 448074.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154286288.0000; val_global_loss: 158914720.0000; val_optim_loss: 158914720.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7843; val_auprc_score: 0.7807; val_best_acc_score: 0.5841; val_best_f1_score: 0.7012; train_kl_reg_loss: 131647.4410; train_edge_recon_loss: 3552711.0278; train_gene_expr_recon_loss: 438457.2292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153433276.4444; train_global_loss: 157556090.6667; train_optim_loss: 157556090.6667; val_kl_reg_loss: 116959.0234; val_edge_recon_loss: 4059887.5000; val_gene_expr_recon_loss: 440405.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154086272.0000; val_global_loss: 158703520.0000; val_optim_loss: 158703520.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.7699; val_auprc_score: 0.7623; val_best_acc_score: 0.5934; val_best_f1_score: 0.7053; train_kl_reg_loss: 128690.9045; train_edge_recon_loss: 3553325.1667; train_gene_expr_recon_loss: 430246.3924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152585690.6667; train_global_loss: 156697953.7778; train_optim_loss: 156697953.7778; val_kl_reg_loss: 112243.8281; val_edge_recon_loss: 4059433.2500; val_gene_expr_recon_loss: 433692.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153709344.0000; val_global_loss: 158314720.0000; val_optim_loss: 158314720.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7819; val_auprc_score: 0.7776; val_best_acc_score: 0.5973; val_best_f1_score: 0.7065; train_kl_reg_loss: 128262.1866; train_edge_recon_loss: 3547378.3889; train_gene_expr_recon_loss: 427505.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153620067.5556; train_global_loss: 157723212.4444; train_optim_loss: 157723212.4444; val_kl_reg_loss: 114255.2734; val_edge_recon_loss: 4058832.2500; val_gene_expr_recon_loss: 427534.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153665136.0000; val_global_loss: 158265760.0000; val_optim_loss: 158265760.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.7793; val_auprc_score: 0.7728; val_best_acc_score: 0.6093; val_best_f1_score: 0.7112; train_kl_reg_loss: 125811.3689; train_edge_recon_loss: 3546886.2222; train_gene_expr_recon_loss: 419461.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153010295.1111; train_global_loss: 157102456.8889; train_optim_loss: 157102456.8889; val_kl_reg_loss: 111738.5312; val_edge_recon_loss: 4057436.0000; val_gene_expr_recon_loss: 423678.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153378240.0000; val_global_loss: 157971088.0000; val_optim_loss: 157971088.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.7884; val_auprc_score: 0.7793; val_best_acc_score: 0.6280; val_best_f1_score: 0.7194; train_kl_reg_loss: 123085.5868; train_edge_recon_loss: 3544842.0556; train_gene_expr_recon_loss: 417410.3646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153352755.5556; train_global_loss: 157438094.2222; train_optim_loss: 157438094.2222; val_kl_reg_loss: 99745.5000; val_edge_recon_loss: 4055954.7500; val_gene_expr_recon_loss: 420584.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153037920.0000; val_global_loss: 157614208.0000; val_optim_loss: 157614208.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.7933; val_auprc_score: 0.7863; val_best_acc_score: 0.6358; val_best_f1_score: 0.7217; train_kl_reg_loss: 121933.0842; train_edge_recon_loss: 3542674.4167; train_gene_expr_recon_loss: 413536.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154002161.7778; train_global_loss: 158080305.7778; train_optim_loss: 158080305.7778; val_kl_reg_loss: 100230.2812; val_edge_recon_loss: 4054792.7500; val_gene_expr_recon_loss: 416850.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152835680.0000; val_global_loss: 157407552.0000; val_optim_loss: 157407552.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.7930; val_auprc_score: 0.7871; val_best_acc_score: 0.6478; val_best_f1_score: 0.7272; train_kl_reg_loss: 118525.6910; train_edge_recon_loss: 3539814.3056; train_gene_expr_recon_loss: 407355.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152045338.6667; train_global_loss: 156111034.6667; train_optim_loss: 156111034.6667; val_kl_reg_loss: 107102.3906; val_edge_recon_loss: 4053412.0000; val_gene_expr_recon_loss: 412492.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152748512.0000; val_global_loss: 157321520.0000; val_optim_loss: 157321520.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8043; val_auprc_score: 0.8010; val_best_acc_score: 0.6234; val_best_f1_score: 0.7173; train_kl_reg_loss: 123792.2465; train_edge_recon_loss: 3917928.0556; train_gene_expr_recon_loss: 418748.9097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152029914.6667; train_global_loss: 156490384.0000; train_optim_loss: 156490384.0000; val_kl_reg_loss: 69337.6172; val_edge_recon_loss: 4056027.2500; val_gene_expr_recon_loss: 410473.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153189056.0000; val_global_loss: 157724896.0000; val_optim_loss: 157724896.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.7906; val_auprc_score: 0.7841; val_best_acc_score: 0.6231; val_best_f1_score: 0.7167; train_kl_reg_loss: 63465.7066; train_edge_recon_loss: 3957604.4444; train_gene_expr_recon_loss: 419658.6736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153580030.2222; train_global_loss: 158020757.3333; train_optim_loss: 158020757.3333; val_kl_reg_loss: 38196.6641; val_edge_recon_loss: 4056584.7500; val_gene_expr_recon_loss: 410033.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153026016.0000; val_global_loss: 157530832.0000; val_optim_loss: 157530832.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.7844; val_auprc_score: 0.7802; val_best_acc_score: 0.6210; val_best_f1_score: 0.7142; train_kl_reg_loss: 77882.4744; train_edge_recon_loss: 3870178.4722; train_gene_expr_recon_loss: 417247.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152764993.7778; train_global_loss: 157130300.4444; train_optim_loss: 157130300.4444; val_kl_reg_loss: 28833.4375; val_edge_recon_loss: 4055469.2500; val_gene_expr_recon_loss: 426654.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153479968.0000; val_global_loss: 157990928.0000; val_optim_loss: 157990928.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8422; val_auprc_score: 0.8394; val_best_acc_score: 0.5094; val_best_f1_score: 0.6708; train_kl_reg_loss: 42258.9468; train_edge_recon_loss: 3890928.5833; train_gene_expr_recon_loss: 435315.3993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152729697.7778; train_global_loss: 157098199.1111; train_optim_loss: 157098199.1111; val_kl_reg_loss: 36063.2344; val_edge_recon_loss: 4064941.0000; val_gene_expr_recon_loss: 419295.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153455232.0000; val_global_loss: 157975536.0000; val_optim_loss: 157975536.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8491; val_auprc_score: 0.8451; val_best_acc_score: 0.5094; val_best_f1_score: 0.6708; train_kl_reg_loss: 39609.9727; train_edge_recon_loss: 3828427.1389; train_gene_expr_recon_loss: 420585.3090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153271472.0000; train_global_loss: 157560094.2222; train_optim_loss: 157560094.2222; val_kl_reg_loss: 37397.4062; val_edge_recon_loss: 4064981.0000; val_gene_expr_recon_loss: 414411.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153186400.0000; val_global_loss: 157703184.0000; val_optim_loss: 157703184.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8326; val_auprc_score: 0.8286; val_best_acc_score: 0.5100; val_best_f1_score: 0.6710; train_kl_reg_loss: 41270.7057; train_edge_recon_loss: 3809965.4167; train_gene_expr_recon_loss: 408533.0660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152455079.1111; train_global_loss: 156714848.0000; train_optim_loss: 156714848.0000; val_kl_reg_loss: 42958.8633; val_edge_recon_loss: 4065000.0000; val_gene_expr_recon_loss: 405825.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153088096.0000; val_global_loss: 157601888.0000; val_optim_loss: 157601888.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8397; val_auprc_score: 0.8369; val_best_acc_score: 0.5117; val_best_f1_score: 0.6718; train_kl_reg_loss: 53381.5612; train_edge_recon_loss: 3739886.7500; train_gene_expr_recon_loss: 404883.0035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152596992.0000; train_global_loss: 156795144.8889; train_optim_loss: 156795144.8889; val_kl_reg_loss: 55389.7891; val_edge_recon_loss: 4064942.5000; val_gene_expr_recon_loss: 403839.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 152976880.0000; val_global_loss: 157501056.0000; val_optim_loss: 157501056.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8404; val_auprc_score: 0.8393; val_best_acc_score: 0.5133; val_best_f1_score: 0.6725; train_kl_reg_loss: 62279.1454; train_edge_recon_loss: 3696446.6111; train_gene_expr_recon_loss: 405195.7465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152486069.3333; train_global_loss: 156649989.3333; train_optim_loss: 156649989.3333; val_kl_reg_loss: 59437.0391; val_edge_recon_loss: 4064809.0000; val_gene_expr_recon_loss: 405568.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 153039264.0000; val_global_loss: 157569072.0000; val_optim_loss: 157569072.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 46 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.7967
val AUPRC score: 0.7913
val best accuracy score: 0.6085
val best F1 score: 0.7111
val target rna MSE score: 7.0714
val source rna MSE score: 4.2957
val target atac MSE score: 0.1218
val source atac MSE score: 0.0179
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
