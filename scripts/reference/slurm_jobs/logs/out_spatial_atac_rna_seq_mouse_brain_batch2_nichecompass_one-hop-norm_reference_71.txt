[True]
Run timestamp: 26072023_022648_71.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_71']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9048; val_auprc_score: 0.9145; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 11292.6401; train_edge_recon_loss: 3492060.6667; train_gene_expr_recon_loss: 322629.7604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 108259457.7778; train_global_loss: 112085441.7778; train_optim_loss: 112085441.7778; val_kl_reg_loss: 30947.6641; val_edge_recon_loss: 4065700.5000; val_gene_expr_recon_loss: 315480.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 107838336.0000; val_global_loss: 112250464.0000; val_optim_loss: 112250464.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8885; val_auprc_score: 0.8898; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 40690.3891; train_edge_recon_loss: 3546739.4167; train_gene_expr_recon_loss: 306458.4271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 106982594.6667; train_global_loss: 110876482.6667; train_optim_loss: 110876482.6667; val_kl_reg_loss: 38102.8906; val_edge_recon_loss: 4065677.7500; val_gene_expr_recon_loss: 296315.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 105988760.0000; val_global_loss: 110388856.0000; val_optim_loss: 110388856.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8588; val_auprc_score: 0.8596; val_best_acc_score: 0.5015; val_best_f1_score: 0.6673; train_kl_reg_loss: 69680.9392; train_edge_recon_loss: 3551307.2500; train_gene_expr_recon_loss: 281324.5208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 104198539.5556; train_global_loss: 108100851.5556; train_optim_loss: 108100851.5556; val_kl_reg_loss: 85652.4219; val_edge_recon_loss: 4065676.0000; val_gene_expr_recon_loss: 271722.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 103874096.0000; val_global_loss: 108297144.0000; val_optim_loss: 108297144.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8544; val_auprc_score: 0.8551; val_best_acc_score: 0.5011; val_best_f1_score: 0.6671; train_kl_reg_loss: 105238.4002; train_edge_recon_loss: 3606959.8889; train_gene_expr_recon_loss: 259636.2604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101939656.8889; train_global_loss: 105911492.4444; train_optim_loss: 105911492.4444; val_kl_reg_loss: 101141.1953; val_edge_recon_loss: 4065779.5000; val_gene_expr_recon_loss: 255224.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 102174784.0000; val_global_loss: 106596928.0000; val_optim_loss: 106596928.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8573; val_auprc_score: 0.8616; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 133735.4219; train_edge_recon_loss: 3615251.9722; train_gene_expr_recon_loss: 253515.5799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101206422.2222; train_global_loss: 105208924.4444; train_optim_loss: 105208924.4444; val_kl_reg_loss: 95663.5625; val_edge_recon_loss: 4065810.5000; val_gene_expr_recon_loss: 246749.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100925952.0000; val_global_loss: 105334176.0000; val_optim_loss: 105334176.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8630; val_auprc_score: 0.8659; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 118751.9540; train_edge_recon_loss: 3634185.8056; train_gene_expr_recon_loss: 243556.9670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100045046.2222; train_global_loss: 104041541.3333; train_optim_loss: 104041541.3333; val_kl_reg_loss: 132992.4219; val_edge_recon_loss: 4065837.2500; val_gene_expr_recon_loss: 241366.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100589496.0000; val_global_loss: 105029696.0000; val_optim_loss: 105029696.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8649; val_auprc_score: 0.8655; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 137374.7865; train_edge_recon_loss: 3621321.8889; train_gene_expr_recon_loss: 236424.7292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99213274.6667; train_global_loss: 103208395.5556; train_optim_loss: 103208395.5556; val_kl_reg_loss: 141276.2031; val_edge_recon_loss: 4065866.2500; val_gene_expr_recon_loss: 236424.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99846024.0000; val_global_loss: 104289592.0000; val_optim_loss: 104289592.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8782; val_auprc_score: 0.8762; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 152940.8872; train_edge_recon_loss: 3614183.3056; train_gene_expr_recon_loss: 231740.1285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98541147.5556; train_global_loss: 102540012.4444; train_optim_loss: 102540012.4444; val_kl_reg_loss: 138761.9531; val_edge_recon_loss: 4065711.0000; val_gene_expr_recon_loss: 231876.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99314112.0000; val_global_loss: 103750464.0000; val_optim_loss: 103750464.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8881; val_auprc_score: 0.8833; val_best_acc_score: 0.5009; val_best_f1_score: 0.6671; train_kl_reg_loss: 155447.3655; train_edge_recon_loss: 3609559.6667; train_gene_expr_recon_loss: 226815.4792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98005505.7778; train_global_loss: 101997328.0000; train_optim_loss: 101997328.0000; val_kl_reg_loss: 149685.0625; val_edge_recon_loss: 4065379.5000; val_gene_expr_recon_loss: 228095.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99055416.0000; val_global_loss: 103498576.0000; val_optim_loss: 103498576.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8830; val_auprc_score: 0.8690; val_best_acc_score: 0.5067; val_best_f1_score: 0.6696; train_kl_reg_loss: 166676.3715; train_edge_recon_loss: 3601922.0000; train_gene_expr_recon_loss: 223740.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97803648.0000; train_global_loss: 101795988.4444; train_optim_loss: 101795988.4444; val_kl_reg_loss: 142918.5156; val_edge_recon_loss: 4064669.0000; val_gene_expr_recon_loss: 224473.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98700960.0000; val_global_loss: 103133024.0000; val_optim_loss: 103133024.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8721; val_auprc_score: 0.8575; val_best_acc_score: 0.5201; val_best_f1_score: 0.6757; train_kl_reg_loss: 171627.1042; train_edge_recon_loss: 3597073.3611; train_gene_expr_recon_loss: 219921.6233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97524290.6667; train_global_loss: 101512912.0000; train_optim_loss: 101512912.0000; val_kl_reg_loss: 153276.1562; val_edge_recon_loss: 4063790.2500; val_gene_expr_recon_loss: 221544.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98488928.0000; val_global_loss: 102927536.0000; val_optim_loss: 102927536.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8596; val_auprc_score: 0.8498; val_best_acc_score: 0.5472; val_best_f1_score: 0.6880; train_kl_reg_loss: 174459.0538; train_edge_recon_loss: 3594116.5278; train_gene_expr_recon_loss: 218410.3003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97217047.1111; train_global_loss: 101204033.7778; train_optim_loss: 101204033.7778; val_kl_reg_loss: 150268.0312; val_edge_recon_loss: 4062612.2500; val_gene_expr_recon_loss: 219751.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98187456.0000; val_global_loss: 102620088.0000; val_optim_loss: 102620088.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8580; val_auprc_score: 0.8512; val_best_acc_score: 0.5800; val_best_f1_score: 0.7028; train_kl_reg_loss: 174618.1597; train_edge_recon_loss: 3587672.6944; train_gene_expr_recon_loss: 215584.1788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97086413.3333; train_global_loss: 101064288.0000; train_optim_loss: 101064288.0000; val_kl_reg_loss: 159947.1875; val_edge_recon_loss: 4061163.0000; val_gene_expr_recon_loss: 218238.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98112936.0000; val_global_loss: 102552288.0000; val_optim_loss: 102552288.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8525; val_auprc_score: 0.8465; val_best_acc_score: 0.6136; val_best_f1_score: 0.7182; train_kl_reg_loss: 175639.0903; train_edge_recon_loss: 3586095.4444; train_gene_expr_recon_loss: 215265.8299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96904987.5556; train_global_loss: 100881987.5556; train_optim_loss: 100881987.5556; val_kl_reg_loss: 129832.1016; val_edge_recon_loss: 4059200.0000; val_gene_expr_recon_loss: 217471.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97998120.0000; val_global_loss: 102404624.0000; val_optim_loss: 102404624.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8518; val_auprc_score: 0.8460; val_best_acc_score: 0.6355; val_best_f1_score: 0.7283; train_kl_reg_loss: 169600.5139; train_edge_recon_loss: 3591120.8056; train_gene_expr_recon_loss: 214878.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96972305.7778; train_global_loss: 100947905.7778; train_optim_loss: 100947905.7778; val_kl_reg_loss: 141020.1250; val_edge_recon_loss: 4057833.2500; val_gene_expr_recon_loss: 216221.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97872240.0000; val_global_loss: 102287312.0000; val_optim_loss: 102287312.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8637; val_auprc_score: 0.8611; val_best_acc_score: 0.6730; val_best_f1_score: 0.7472; train_kl_reg_loss: 173939.0382; train_edge_recon_loss: 3580661.1944; train_gene_expr_recon_loss: 212903.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96713894.2222; train_global_loss: 100681397.3333; train_optim_loss: 100681397.3333; val_kl_reg_loss: 139525.3594; val_edge_recon_loss: 4055321.0000; val_gene_expr_recon_loss: 215591.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97736456.0000; val_global_loss: 102146896.0000; val_optim_loss: 102146896.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8608; val_auprc_score: 0.8500; val_best_acc_score: 0.7022; val_best_f1_score: 0.7618; train_kl_reg_loss: 170860.7240; train_edge_recon_loss: 3578567.7500; train_gene_expr_recon_loss: 213996.9757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96934290.6667; train_global_loss: 100897715.5556; train_optim_loss: 100897715.5556; val_kl_reg_loss: 135395.1562; val_edge_recon_loss: 4053031.2500; val_gene_expr_recon_loss: 215161.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97651664.0000; val_global_loss: 102055248.0000; val_optim_loss: 102055248.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8635; val_auprc_score: 0.8544; val_best_acc_score: 0.7290; val_best_f1_score: 0.7762; train_kl_reg_loss: 168864.7361; train_edge_recon_loss: 3574307.0833; train_gene_expr_recon_loss: 211843.4410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96174531.5556; train_global_loss: 100129547.5556; train_optim_loss: 100129547.5556; val_kl_reg_loss: 152113.7500; val_edge_recon_loss: 4050854.7500; val_gene_expr_recon_loss: 214155.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97468512.0000; val_global_loss: 101885632.0000; val_optim_loss: 101885632.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8683; val_auprc_score: 0.8620; val_best_acc_score: 0.7607; val_best_f1_score: 0.7932; train_kl_reg_loss: 171522.3247; train_edge_recon_loss: 3568915.6944; train_gene_expr_recon_loss: 212206.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96620976.0000; train_global_loss: 100573620.4444; train_optim_loss: 100573620.4444; val_kl_reg_loss: 135132.4219; val_edge_recon_loss: 4045929.0000; val_gene_expr_recon_loss: 214159.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97533080.0000; val_global_loss: 101928304.0000; val_optim_loss: 101928304.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8729; val_auprc_score: 0.8629; val_best_acc_score: 0.7789; val_best_f1_score: 0.8015; train_kl_reg_loss: 161831.0417; train_edge_recon_loss: 3570634.0556; train_gene_expr_recon_loss: 212229.5642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96844577.7778; train_global_loss: 100789272.0000; train_optim_loss: 100789272.0000; val_kl_reg_loss: 148096.9062; val_edge_recon_loss: 4042274.7500; val_gene_expr_recon_loss: 213401.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97308280.0000; val_global_loss: 101712056.0000; val_optim_loss: 101712056.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8801; val_auprc_score: 0.8642; val_best_acc_score: 0.8036; val_best_f1_score: 0.8129; train_kl_reg_loss: 166834.5712; train_edge_recon_loss: 3564748.9444; train_gene_expr_recon_loss: 210111.1198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95949456.0000; train_global_loss: 99891151.1111; train_optim_loss: 99891151.1111; val_kl_reg_loss: 142214.5625; val_edge_recon_loss: 4034745.7500; val_gene_expr_recon_loss: 213240.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97269552.0000; val_global_loss: 101659752.0000; val_optim_loss: 101659752.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8873; val_auprc_score: 0.8740; val_best_acc_score: 0.8094; val_best_f1_score: 0.8092; train_kl_reg_loss: 162334.1545; train_edge_recon_loss: 3563280.2500; train_gene_expr_recon_loss: 210609.7830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96122117.3333; train_global_loss: 100058342.2222; train_optim_loss: 100058342.2222; val_kl_reg_loss: 148646.6406; val_edge_recon_loss: 4022376.2500; val_gene_expr_recon_loss: 212656.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97137704.0000; val_global_loss: 101521384.0000; val_optim_loss: 101521384.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8882; val_auprc_score: 0.8711; val_best_acc_score: 0.7978; val_best_f1_score: 0.7875; train_kl_reg_loss: 159497.8611; train_edge_recon_loss: 3556595.4444; train_gene_expr_recon_loss: 209773.0660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95960693.3333; train_global_loss: 99886560.8889; train_optim_loss: 99886560.8889; val_kl_reg_loss: 142570.0000; val_edge_recon_loss: 4004514.0000; val_gene_expr_recon_loss: 212311.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96839760.0000; val_global_loss: 101199152.0000; val_optim_loss: 101199152.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8913; val_auprc_score: 0.8745; val_best_acc_score: 0.7802; val_best_f1_score: 0.8040; train_kl_reg_loss: 158532.2170; train_edge_recon_loss: 3552476.7500; train_gene_expr_recon_loss: 210308.2448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96014400.8889; train_global_loss: 99935718.2222; train_optim_loss: 99935718.2222; val_kl_reg_loss: 126761.3516; val_edge_recon_loss: 3981605.2500; val_gene_expr_recon_loss: 212453.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96963680.0000; val_global_loss: 101284496.0000; val_optim_loss: 101284496.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8875; val_auprc_score: 0.8680; val_best_acc_score: 0.7855; val_best_f1_score: 0.8163; train_kl_reg_loss: 150242.6198; train_edge_recon_loss: 3551899.3611; train_gene_expr_recon_loss: 209255.2396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95240385.7778; train_global_loss: 99151784.0000; train_optim_loss: 99151784.0000; val_kl_reg_loss: 119910.3594; val_edge_recon_loss: 3954285.0000; val_gene_expr_recon_loss: 212052.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96828792.0000; val_global_loss: 101115040.0000; val_optim_loss: 101115040.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9133; val_auprc_score: 0.8963; val_best_acc_score: 0.8243; val_best_f1_score: 0.8176; train_kl_reg_loss: 126833.9410; train_edge_recon_loss: 3925025.5278; train_gene_expr_recon_loss: 215560.3628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97202729.7778; train_global_loss: 101470150.2222; train_optim_loss: 101470150.2222; val_kl_reg_loss: 89783.6016; val_edge_recon_loss: 3985203.7500; val_gene_expr_recon_loss: 213323.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97242512.0000; val_global_loss: 101530824.0000; val_optim_loss: 101530824.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9106; val_auprc_score: 0.8900; val_best_acc_score: 0.8362; val_best_f1_score: 0.8433; train_kl_reg_loss: 102442.8906; train_edge_recon_loss: 3811561.8611; train_gene_expr_recon_loss: 225299.3316; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96508773.3333; train_global_loss: 100648077.3333; train_optim_loss: 100648077.3333; val_kl_reg_loss: 55237.3516; val_edge_recon_loss: 4016675.0000; val_gene_expr_recon_loss: 213627.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97053168.0000; val_global_loss: 101338704.0000; val_optim_loss: 101338704.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9138; val_auprc_score: 0.8925; val_best_acc_score: 0.8389; val_best_f1_score: 0.8484; train_kl_reg_loss: 59912.8338; train_edge_recon_loss: 3895439.6944; train_gene_expr_recon_loss: 219859.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95947107.5556; train_global_loss: 100122320.0000; train_optim_loss: 100122320.0000; val_kl_reg_loss: 60892.3516; val_edge_recon_loss: 4024627.5000; val_gene_expr_recon_loss: 213499.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97024080.0000; val_global_loss: 101323096.0000; val_optim_loss: 101323096.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9054; val_auprc_score: 0.8879; val_best_acc_score: 0.8259; val_best_f1_score: 0.8326; train_kl_reg_loss: 70413.2930; train_edge_recon_loss: 3773935.0833; train_gene_expr_recon_loss: 221907.7934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95616644.4444; train_global_loss: 99682901.3333; train_optim_loss: 99682901.3333; val_kl_reg_loss: 70630.6719; val_edge_recon_loss: 4020005.2500; val_gene_expr_recon_loss: 212999.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96909648.0000; val_global_loss: 101213280.0000; val_optim_loss: 101213280.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8993; val_auprc_score: 0.8782; val_best_acc_score: 0.8242; val_best_f1_score: 0.8318; train_kl_reg_loss: 78380.8533; train_edge_recon_loss: 3694059.0833; train_gene_expr_recon_loss: 223408.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96604851.5556; train_global_loss: 100600698.6667; train_optim_loss: 100600698.6667; val_kl_reg_loss: 75413.0781; val_edge_recon_loss: 4022320.5000; val_gene_expr_recon_loss: 212843.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96957840.0000; val_global_loss: 101268416.0000; val_optim_loss: 101268416.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9011; val_auprc_score: 0.8841; val_best_acc_score: 0.8178; val_best_f1_score: 0.8267; train_kl_reg_loss: 83929.3342; train_edge_recon_loss: 3728779.6111; train_gene_expr_recon_loss: 212985.9861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95857237.3333; train_global_loss: 99882931.5556; train_optim_loss: 99882931.5556; val_kl_reg_loss: 83863.4609; val_edge_recon_loss: 4021030.0000; val_gene_expr_recon_loss: 212487.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96819072.0000; val_global_loss: 101136456.0000; val_optim_loss: 101136456.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8966; val_auprc_score: 0.8798; val_best_acc_score: 0.8124; val_best_f1_score: 0.8228; train_kl_reg_loss: 98861.1163; train_edge_recon_loss: 3722398.0833; train_gene_expr_recon_loss: 213054.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95812878.2222; train_global_loss: 99847191.1111; train_optim_loss: 99847191.1111; val_kl_reg_loss: 102126.7031; val_edge_recon_loss: 4021486.7500; val_gene_expr_recon_loss: 212400.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96881360.0000; val_global_loss: 101217376.0000; val_optim_loss: 101217376.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9000; val_auprc_score: 0.8798; val_best_acc_score: 0.8215; val_best_f1_score: 0.8289; train_kl_reg_loss: 107234.6016; train_edge_recon_loss: 3693476.7500; train_gene_expr_recon_loss: 216693.6580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95977861.3333; train_global_loss: 99995265.7778; train_optim_loss: 99995265.7778; val_kl_reg_loss: 95352.0938; val_edge_recon_loss: 4018839.2500; val_gene_expr_recon_loss: 212215.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96882360.0000; val_global_loss: 101208768.0000; val_optim_loss: 101208768.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 40 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9070
Val AUPRC score: 0.8897
Val best accuracy score: 0.8290
Val best F1 score: 0.8291
Val gene expr MSE score: 0.5098
Val chrom access MSE score: 0.0883
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
