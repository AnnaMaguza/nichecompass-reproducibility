[True]
Run timestamp: 07082023_193151_71.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_71']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8856; val_auprc_score: 0.8996; val_best_acc_score: 0.5109; val_best_f1_score: 0.6716; train_kl_reg_loss: 21306.5590; train_edge_recon_loss: 349715.9306; train_gene_expr_recon_loss: 1291141.5833; train_masked_gp_l1_reg_loss: 16066.6802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119324.6658; train_chrom_access_recon_loss: 2245182.5139; train_global_loss: 4042737.9444; train_optim_loss: 4042737.9444; val_kl_reg_loss: 5043.0762; val_edge_recon_loss: 406465.7812; val_gene_expr_recon_loss: 1104702.2500; val_masked_gp_l1_reg_loss: 11300.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116998.6094; val_chrom_access_recon_loss: 1554687.5000; val_global_loss: 3199197.7500; val_optim_loss: 3199197.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8920; val_auprc_score: 0.9027; val_best_acc_score: 0.5108; val_best_f1_score: 0.6715; train_kl_reg_loss: 4349.7827; train_edge_recon_loss: 350190.7778; train_gene_expr_recon_loss: 1026601.6944; train_masked_gp_l1_reg_loss: 9651.9697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115604.9418; train_chrom_access_recon_loss: 1492603.5972; train_global_loss: 2999002.7778; train_optim_loss: 2999002.7778; val_kl_reg_loss: 4711.4600; val_edge_recon_loss: 406493.1562; val_gene_expr_recon_loss: 970599.6250; val_masked_gp_l1_reg_loss: 8594.9346; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113926.4219; val_chrom_access_recon_loss: 1439054.7500; val_global_loss: 2943380.2500; val_optim_loss: 2943380.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8890; val_auprc_score: 0.8995; val_best_acc_score: 0.5031; val_best_f1_score: 0.6680; train_kl_reg_loss: 7799.8541; train_edge_recon_loss: 352797.0174; train_gene_expr_recon_loss: 922740.6528; train_masked_gp_l1_reg_loss: 8947.4220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112592.9115; train_chrom_access_recon_loss: 1443237.2778; train_global_loss: 2848115.0833; train_optim_loss: 2848115.0833; val_kl_reg_loss: 12229.4766; val_edge_recon_loss: 406562.7188; val_gene_expr_recon_loss: 865587.0000; val_masked_gp_l1_reg_loss: 9310.7480; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110898.5781; val_chrom_access_recon_loss: 1408355.1250; val_global_loss: 2812943.7500; val_optim_loss: 2812943.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8832; val_auprc_score: 0.8916; val_best_acc_score: 0.5053; val_best_f1_score: 0.6690; train_kl_reg_loss: 15276.7642; train_edge_recon_loss: 357517.2257; train_gene_expr_recon_loss: 833134.5139; train_masked_gp_l1_reg_loss: 9376.5302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109459.1580; train_chrom_access_recon_loss: 1413546.4444; train_global_loss: 2738310.6389; train_optim_loss: 2738310.6389; val_kl_reg_loss: 15731.3867; val_edge_recon_loss: 406558.0000; val_gene_expr_recon_loss: 799842.4375; val_masked_gp_l1_reg_loss: 9468.2598; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107578.0625; val_chrom_access_recon_loss: 1369822.0000; val_global_loss: 2709000.0000; val_optim_loss: 2709000.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8756; val_auprc_score: 0.8858; val_best_acc_score: 0.5105; val_best_f1_score: 0.6714; train_kl_reg_loss: 17517.0658; train_edge_recon_loss: 358373.9132; train_gene_expr_recon_loss: 779502.0764; train_masked_gp_l1_reg_loss: 9567.2280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105935.7196; train_chrom_access_recon_loss: 1378888.6250; train_global_loss: 2649784.6389; train_optim_loss: 2649784.6389; val_kl_reg_loss: 17521.3594; val_edge_recon_loss: 406532.7500; val_gene_expr_recon_loss: 762329.8750; val_masked_gp_l1_reg_loss: 9666.8936; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103799.9297; val_chrom_access_recon_loss: 1344174.1250; val_global_loss: 2644025.0000; val_optim_loss: 2644025.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8811; val_auprc_score: 0.8865; val_best_acc_score: 0.5150; val_best_f1_score: 0.6733; train_kl_reg_loss: 19655.5744; train_edge_recon_loss: 359660.4028; train_gene_expr_recon_loss: 747469.1597; train_masked_gp_l1_reg_loss: 9708.5769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101969.8281; train_chrom_access_recon_loss: 1362429.6389; train_global_loss: 2600893.1944; train_optim_loss: 2600893.1944; val_kl_reg_loss: 19446.0156; val_edge_recon_loss: 406486.5312; val_gene_expr_recon_loss: 735701.8750; val_masked_gp_l1_reg_loss: 9721.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99621.0781; val_chrom_access_recon_loss: 1330403.3750; val_global_loss: 2601380.5000; val_optim_loss: 2601380.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8771; val_auprc_score: 0.8784; val_best_acc_score: 0.5201; val_best_f1_score: 0.6749; train_kl_reg_loss: 20626.2700; train_edge_recon_loss: 359739.2535; train_gene_expr_recon_loss: 728452.6389; train_masked_gp_l1_reg_loss: 9718.2591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97669.3116; train_chrom_access_recon_loss: 1341204.8611; train_global_loss: 2557410.5556; train_optim_loss: 2557410.5556; val_kl_reg_loss: 19704.8867; val_edge_recon_loss: 406377.3438; val_gene_expr_recon_loss: 718481.0000; val_masked_gp_l1_reg_loss: 9695.2119; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95199.3750; val_chrom_access_recon_loss: 1321294.7500; val_global_loss: 2570752.5000; val_optim_loss: 2570752.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8704; val_auprc_score: 0.8709; val_best_acc_score: 0.5415; val_best_f1_score: 0.6838; train_kl_reg_loss: 21092.5408; train_edge_recon_loss: 359656.4514; train_gene_expr_recon_loss: 709513.4583; train_masked_gp_l1_reg_loss: 9684.3966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93198.4297; train_chrom_access_recon_loss: 1333424.3333; train_global_loss: 2526569.5556; train_optim_loss: 2526569.5556; val_kl_reg_loss: 21121.1543; val_edge_recon_loss: 406185.4688; val_gene_expr_recon_loss: 703652.3750; val_masked_gp_l1_reg_loss: 9654.0439; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90687.8828; val_chrom_access_recon_loss: 1314324.0000; val_global_loss: 2545625.0000; val_optim_loss: 2545625.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8635; val_auprc_score: 0.8606; val_best_acc_score: 0.5873; val_best_f1_score: 0.7034; train_kl_reg_loss: 22392.5762; train_edge_recon_loss: 359432.3299; train_gene_expr_recon_loss: 701439.8611; train_masked_gp_l1_reg_loss: 9623.0203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88673.5998; train_chrom_access_recon_loss: 1334269.8472; train_global_loss: 2515831.2778; train_optim_loss: 2515831.2778; val_kl_reg_loss: 20954.9766; val_edge_recon_loss: 405817.6250; val_gene_expr_recon_loss: 694189.0000; val_masked_gp_l1_reg_loss: 9576.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86161.6250; val_chrom_access_recon_loss: 1309121.7500; val_global_loss: 2525821.5000; val_optim_loss: 2525821.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8484; val_auprc_score: 0.8431; val_best_acc_score: 0.6291; val_best_f1_score: 0.7222; train_kl_reg_loss: 22258.0987; train_edge_recon_loss: 359859.2778; train_gene_expr_recon_loss: 688457.3194; train_masked_gp_l1_reg_loss: 9566.7556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84178.7161; train_chrom_access_recon_loss: 1322986.2083; train_global_loss: 2487306.3611; train_optim_loss: 2487306.3611; val_kl_reg_loss: 22364.9688; val_edge_recon_loss: 405449.4688; val_gene_expr_recon_loss: 685444.1875; val_masked_gp_l1_reg_loss: 9535.6396; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81722.5859; val_chrom_access_recon_loss: 1304902.2500; val_global_loss: 2509419.0000; val_optim_loss: 2509419.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8387; val_auprc_score: 0.8378; val_best_acc_score: 0.6853; val_best_f1_score: 0.7495; train_kl_reg_loss: 23186.0569; train_edge_recon_loss: 359579.7396; train_gene_expr_recon_loss: 683114.9861; train_masked_gp_l1_reg_loss: 9528.6462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79805.5946; train_chrom_access_recon_loss: 1318347.6944; train_global_loss: 2473562.7500; train_optim_loss: 2473562.7500; val_kl_reg_loss: 22074.8750; val_edge_recon_loss: 404666.0625; val_gene_expr_recon_loss: 678924.3750; val_masked_gp_l1_reg_loss: 9497.6777; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77437.5859; val_chrom_access_recon_loss: 1300555.1250; val_global_loss: 2493155.5000; val_optim_loss: 2493155.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8305; val_auprc_score: 0.8178; val_best_acc_score: 0.7348; val_best_f1_score: 0.7691; train_kl_reg_loss: 23684.4939; train_edge_recon_loss: 359463.9444; train_gene_expr_recon_loss: 678296.5833; train_masked_gp_l1_reg_loss: 9483.8288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75594.2188; train_chrom_access_recon_loss: 1316516.2361; train_global_loss: 2463039.2778; train_optim_loss: 2463039.2778; val_kl_reg_loss: 21104.0195; val_edge_recon_loss: 403300.4688; val_gene_expr_recon_loss: 674902.8125; val_masked_gp_l1_reg_loss: 9455.6357; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73315.3047; val_chrom_access_recon_loss: 1296975.2500; val_global_loss: 2479053.5000; val_optim_loss: 2479053.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8289; val_auprc_score: 0.8235; val_best_acc_score: 0.7431; val_best_f1_score: 0.7618; train_kl_reg_loss: 23466.4963; train_edge_recon_loss: 359204.2431; train_gene_expr_recon_loss: 672882.8889; train_masked_gp_l1_reg_loss: 9463.0118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71553.0512; train_chrom_access_recon_loss: 1314712.4722; train_global_loss: 2451282.1389; train_optim_loss: 2451282.1389; val_kl_reg_loss: 22494.7930; val_edge_recon_loss: 402246.1562; val_gene_expr_recon_loss: 669517.8750; val_masked_gp_l1_reg_loss: 9438.5244; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69379.1406; val_chrom_access_recon_loss: 1294283.7500; val_global_loss: 2467360.0000; val_optim_loss: 2467360.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8248; val_auprc_score: 0.8155; val_best_acc_score: 0.7405; val_best_f1_score: 0.7413; train_kl_reg_loss: 23293.1576; train_edge_recon_loss: 358611.2951; train_gene_expr_recon_loss: 667899.5278; train_masked_gp_l1_reg_loss: 9425.5424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67703.4974; train_chrom_access_recon_loss: 1316155.4444; train_global_loss: 2443088.4722; train_optim_loss: 2443088.4722; val_kl_reg_loss: 21899.4531; val_edge_recon_loss: 400258.5625; val_gene_expr_recon_loss: 666627.8125; val_masked_gp_l1_reg_loss: 9395.1436; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65642.8828; val_chrom_access_recon_loss: 1291180.7500; val_global_loss: 2455004.5000; val_optim_loss: 2455004.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8327; val_auprc_score: 0.8245; val_best_acc_score: 0.7346; val_best_f1_score: 0.7607; train_kl_reg_loss: 23107.4878; train_edge_recon_loss: 357700.8438; train_gene_expr_recon_loss: 663811.8889; train_masked_gp_l1_reg_loss: 9394.8484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64062.2782; train_chrom_access_recon_loss: 1305216.9167; train_global_loss: 2423294.3056; train_optim_loss: 2423294.3056; val_kl_reg_loss: 21419.3203; val_edge_recon_loss: 397244.2188; val_gene_expr_recon_loss: 664155.0625; val_masked_gp_l1_reg_loss: 9378.9941; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62122.2070; val_chrom_access_recon_loss: 1288687.2500; val_global_loss: 2443007.0000; val_optim_loss: 2443007.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8387; val_auprc_score: 0.8327; val_best_acc_score: 0.7361; val_best_f1_score: 0.7727; train_kl_reg_loss: 22604.6868; train_edge_recon_loss: 356484.2153; train_gene_expr_recon_loss: 663725.7986; train_masked_gp_l1_reg_loss: 9378.8393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60640.1276; train_chrom_access_recon_loss: 1306233.5139; train_global_loss: 2419067.2222; train_optim_loss: 2419067.2222; val_kl_reg_loss: 20598.7246; val_edge_recon_loss: 393295.4688; val_gene_expr_recon_loss: 662101.0000; val_masked_gp_l1_reg_loss: 9371.1904; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58820.1523; val_chrom_access_recon_loss: 1286579.7500; val_global_loss: 2430766.5000; val_optim_loss: 2430766.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8571; val_auprc_score: 0.8485; val_best_acc_score: 0.7683; val_best_f1_score: 0.7808; train_kl_reg_loss: 21882.8331; train_edge_recon_loss: 355094.1493; train_gene_expr_recon_loss: 657402.2639; train_masked_gp_l1_reg_loss: 9376.4259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57436.2760; train_chrom_access_recon_loss: 1301248.1389; train_global_loss: 2402440.0833; train_optim_loss: 2402440.0833; val_kl_reg_loss: 20392.5938; val_edge_recon_loss: 386432.2188; val_gene_expr_recon_loss: 660639.0000; val_masked_gp_l1_reg_loss: 9372.4834; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55736.7266; val_chrom_access_recon_loss: 1284587.8750; val_global_loss: 2417161.0000; val_optim_loss: 2417161.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8863; val_auprc_score: 0.8786; val_best_acc_score: 0.8007; val_best_f1_score: 0.8120; train_kl_reg_loss: 21205.3537; train_edge_recon_loss: 351917.0764; train_gene_expr_recon_loss: 657002.6944; train_masked_gp_l1_reg_loss: 9390.0457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54444.8937; train_chrom_access_recon_loss: 1298669.7639; train_global_loss: 2392629.8611; train_optim_loss: 2392629.8611; val_kl_reg_loss: 19896.0000; val_edge_recon_loss: 372945.8750; val_gene_expr_recon_loss: 659612.6875; val_masked_gp_l1_reg_loss: 9395.8184; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52860.1562; val_chrom_access_recon_loss: 1282854.2500; val_global_loss: 2397564.7500; val_optim_loss: 2397564.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9102; val_auprc_score: 0.9012; val_best_acc_score: 0.8265; val_best_f1_score: 0.8367; train_kl_reg_loss: 20776.9963; train_edge_recon_loss: 344212.6042; train_gene_expr_recon_loss: 659944.4444; train_masked_gp_l1_reg_loss: 9418.7839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51658.3885; train_chrom_access_recon_loss: 1293358.5833; train_global_loss: 2379369.7778; train_optim_loss: 2379369.7778; val_kl_reg_loss: 20442.7031; val_edge_recon_loss: 348055.5938; val_gene_expr_recon_loss: 659896.3750; val_masked_gp_l1_reg_loss: 9443.5166; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50191.7383; val_chrom_access_recon_loss: 1282143.0000; val_global_loss: 2370173.0000; val_optim_loss: 2370173.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9133; val_auprc_score: 0.9014; val_best_acc_score: 0.8288; val_best_f1_score: 0.8360; train_kl_reg_loss: 23836.0308; train_edge_recon_loss: 328472.7049; train_gene_expr_recon_loss: 657678.5903; train_masked_gp_l1_reg_loss: 9487.2527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49087.5022; train_chrom_access_recon_loss: 1297310.9861; train_global_loss: 2365873.0278; train_optim_loss: 2365873.0278; val_kl_reg_loss: 27291.4297; val_edge_recon_loss: 319924.1250; val_gene_expr_recon_loss: 659746.0625; val_masked_gp_l1_reg_loss: 9539.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47733.2461; val_chrom_access_recon_loss: 1280452.8750; val_global_loss: 2344687.0000; val_optim_loss: 2344687.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9158; val_auprc_score: 0.9041; val_best_acc_score: 0.8289; val_best_f1_score: 0.8384; train_kl_reg_loss: 31201.9753; train_edge_recon_loss: 313985.1667; train_gene_expr_recon_loss: 659296.1319; train_masked_gp_l1_reg_loss: 9583.3158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46711.3668; train_chrom_access_recon_loss: 1294183.8056; train_global_loss: 2354961.7222; train_optim_loss: 2354961.7222; val_kl_reg_loss: 31468.3027; val_edge_recon_loss: 312330.4375; val_gene_expr_recon_loss: 657320.1250; val_masked_gp_l1_reg_loss: 9627.8691; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45458.7070; val_chrom_access_recon_loss: 1277822.7500; val_global_loss: 2334028.2500; val_optim_loss: 2334028.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9186; val_auprc_score: 0.9078; val_best_acc_score: 0.8390; val_best_f1_score: 0.8474; train_kl_reg_loss: 31395.1447; train_edge_recon_loss: 308803.8611; train_gene_expr_recon_loss: 657250.2222; train_masked_gp_l1_reg_loss: 9662.8661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44511.5781; train_chrom_access_recon_loss: 1293872.4028; train_global_loss: 2345496.0833; train_optim_loss: 2345496.0833; val_kl_reg_loss: 29400.8379; val_edge_recon_loss: 308261.9062; val_gene_expr_recon_loss: 656624.2500; val_masked_gp_l1_reg_loss: 9709.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43350.4766; val_chrom_access_recon_loss: 1276372.1250; val_global_loss: 2323719.2500; val_optim_loss: 2323719.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9184; val_auprc_score: 0.9002; val_best_acc_score: 0.8420; val_best_f1_score: 0.8528; train_kl_reg_loss: 30176.6430; train_edge_recon_loss: 305939.8750; train_gene_expr_recon_loss: 654753.5000; train_masked_gp_l1_reg_loss: 9743.4361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42472.3867; train_chrom_access_recon_loss: 1292112.1111; train_global_loss: 2335198.0000; train_optim_loss: 2335198.0000; val_kl_reg_loss: 29600.2734; val_edge_recon_loss: 306807.4688; val_gene_expr_recon_loss: 655406.8750; val_masked_gp_l1_reg_loss: 9779.7803; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41389.1406; val_chrom_access_recon_loss: 1274386.1250; val_global_loss: 2317369.5000; val_optim_loss: 2317369.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9216; val_auprc_score: 0.9010; val_best_acc_score: 0.8511; val_best_f1_score: 0.8608; train_kl_reg_loss: 30447.2231; train_edge_recon_loss: 304029.5833; train_gene_expr_recon_loss: 650681.1944; train_masked_gp_l1_reg_loss: 9800.6787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40563.3164; train_chrom_access_recon_loss: 1290406.2500; train_global_loss: 2325928.2222; train_optim_loss: 2325928.2222; val_kl_reg_loss: 29624.4688; val_edge_recon_loss: 302548.7188; val_gene_expr_recon_loss: 654162.1250; val_masked_gp_l1_reg_loss: 9829.1006; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39548.0391; val_chrom_access_recon_loss: 1272416.5000; val_global_loss: 2308129.0000; val_optim_loss: 2308129.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9242; val_auprc_score: 0.9054; val_best_acc_score: 0.8550; val_best_f1_score: 0.8641; train_kl_reg_loss: 29812.1510; train_edge_recon_loss: 302529.9340; train_gene_expr_recon_loss: 652236.4931; train_masked_gp_l1_reg_loss: 9845.6660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38781.8056; train_chrom_access_recon_loss: 1289136.1528; train_global_loss: 2322342.1944; train_optim_loss: 2322342.1944; val_kl_reg_loss: 29052.9609; val_edge_recon_loss: 302131.1562; val_gene_expr_recon_loss: 653018.7500; val_masked_gp_l1_reg_loss: 9862.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37835.3438; val_chrom_access_recon_loss: 1270853.5000; val_global_loss: 2302754.0000; val_optim_loss: 2302754.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9306; val_auprc_score: 0.9136; val_best_acc_score: 0.8580; val_best_f1_score: 0.8672; train_kl_reg_loss: 27756.5543; train_edge_recon_loss: 313636.1840; train_gene_expr_recon_loss: 959739.2153; train_masked_gp_l1_reg_loss: 10009.7428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36977.6801; train_chrom_access_recon_loss: 1365585.8194; train_global_loss: 2713705.1944; train_optim_loss: 2713705.1944; val_kl_reg_loss: 14655.7520; val_edge_recon_loss: 311063.1562; val_gene_expr_recon_loss: 952437.0000; val_masked_gp_l1_reg_loss: 10291.2754; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35834.8711; val_chrom_access_recon_loss: 1341643.6250; val_global_loss: 2665925.5000; val_optim_loss: 2665925.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9300; val_auprc_score: 0.9130; val_best_acc_score: 0.8565; val_best_f1_score: 0.8650; train_kl_reg_loss: 26662.9868; train_edge_recon_loss: 303162.3056; train_gene_expr_recon_loss: 952149.8264; train_masked_gp_l1_reg_loss: 10558.9213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34882.7322; train_chrom_access_recon_loss: 1362453.2639; train_global_loss: 2689870.0000; train_optim_loss: 2689870.0000; val_kl_reg_loss: 16853.8457; val_edge_recon_loss: 305449.7812; val_gene_expr_recon_loss: 946733.7500; val_masked_gp_l1_reg_loss: 10880.1846; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33705.4766; val_chrom_access_recon_loss: 1339604.1250; val_global_loss: 2653227.0000; val_optim_loss: 2653227.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9311; val_auprc_score: 0.9120; val_best_acc_score: 0.8572; val_best_f1_score: 0.8642; train_kl_reg_loss: 24790.5369; train_edge_recon_loss: 301051.8993; train_gene_expr_recon_loss: 942777.0139; train_masked_gp_l1_reg_loss: 11089.9049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32806.1797; train_chrom_access_recon_loss: 1356084.2500; train_global_loss: 2668599.8333; train_optim_loss: 2668599.8333; val_kl_reg_loss: 17821.1602; val_edge_recon_loss: 301131.3438; val_gene_expr_recon_loss: 942666.5625; val_masked_gp_l1_reg_loss: 11331.6973; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31710.2539; val_chrom_access_recon_loss: 1337786.7500; val_global_loss: 2642447.7500; val_optim_loss: 2642447.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9332; val_auprc_score: 0.9193; val_best_acc_score: 0.8612; val_best_f1_score: 0.8677; train_kl_reg_loss: 23552.4789; train_edge_recon_loss: 298497.4896; train_gene_expr_recon_loss: 941096.7569; train_masked_gp_l1_reg_loss: 11495.6757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30878.6808; train_chrom_access_recon_loss: 1356678.2361; train_global_loss: 2662199.3056; train_optim_loss: 2662199.3056; val_kl_reg_loss: 19242.1934; val_edge_recon_loss: 297507.0312; val_gene_expr_recon_loss: 938584.0625; val_masked_gp_l1_reg_loss: 11686.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29868.3203; val_chrom_access_recon_loss: 1335606.8750; val_global_loss: 2632494.7500; val_optim_loss: 2632494.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9332; val_auprc_score: 0.9176; val_best_acc_score: 0.8589; val_best_f1_score: 0.8661; train_kl_reg_loss: 23257.2550; train_edge_recon_loss: 297558.2847; train_gene_expr_recon_loss: 934725.8819; train_masked_gp_l1_reg_loss: 11623.2631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29750.9972; train_chrom_access_recon_loss: 1350460.4444; train_global_loss: 2647376.1389; train_optim_loss: 2647376.1389; val_kl_reg_loss: 19544.7324; val_edge_recon_loss: 298093.5312; val_gene_expr_recon_loss: 938486.0000; val_masked_gp_l1_reg_loss: 11571.9971; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29609.3984; val_chrom_access_recon_loss: 1335532.3750; val_global_loss: 2632838.0000; val_optim_loss: 2632838.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9302; val_auprc_score: 0.9113; val_best_acc_score: 0.8593; val_best_f1_score: 0.8656; train_kl_reg_loss: 23353.0558; train_edge_recon_loss: 296116.4722; train_gene_expr_recon_loss: 935772.8750; train_masked_gp_l1_reg_loss: 11565.3443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29511.0193; train_chrom_access_recon_loss: 1356181.0694; train_global_loss: 2652499.8889; train_optim_loss: 2652499.8889; val_kl_reg_loss: 19628.4434; val_edge_recon_loss: 296807.2812; val_gene_expr_recon_loss: 938319.7500; val_masked_gp_l1_reg_loss: 11550.6748; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29387.2695; val_chrom_access_recon_loss: 1335271.3750; val_global_loss: 2630964.7500; val_optim_loss: 2630964.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9345; val_auprc_score: 0.9185; val_best_acc_score: 0.8583; val_best_f1_score: 0.8649; train_kl_reg_loss: 23215.8366; train_edge_recon_loss: 296888.1042; train_gene_expr_recon_loss: 932184.3681; train_masked_gp_l1_reg_loss: 11547.1549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29294.4371; train_chrom_access_recon_loss: 1347176.4306; train_global_loss: 2640306.3889; train_optim_loss: 2640306.3889; val_kl_reg_loss: 19700.4375; val_edge_recon_loss: 298688.6875; val_gene_expr_recon_loss: 937821.3750; val_masked_gp_l1_reg_loss: 11543.9736; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29180.4258; val_chrom_access_recon_loss: 1335352.0000; val_global_loss: 2632287.0000; val_optim_loss: 2632287.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9338; val_auprc_score: 0.9125; val_best_acc_score: 0.8634; val_best_f1_score: 0.8705; train_kl_reg_loss: 23115.8034; train_edge_recon_loss: 297076.8090; train_gene_expr_recon_loss: 933737.0069; train_masked_gp_l1_reg_loss: 11544.0119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29092.0109; train_chrom_access_recon_loss: 1348751.8056; train_global_loss: 2643317.4167; train_optim_loss: 2643317.4167; val_kl_reg_loss: 19667.2129; val_edge_recon_loss: 295967.8438; val_gene_expr_recon_loss: 937460.3125; val_masked_gp_l1_reg_loss: 11546.0684; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28984.9141; val_chrom_access_recon_loss: 1335256.2500; val_global_loss: 2628882.5000; val_optim_loss: 2628882.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 31 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9347
val AUPRC score: 0.9156
val best accuracy score: 0.8665
val best F1 score: 0.8747
val target rna MSE score: 3.7925
val source rna MSE score: 3.1837
val target atac MSE score: 0.1322
val source atac MSE score: 0.0194
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
