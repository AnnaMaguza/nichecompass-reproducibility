[True]
Run timestamp: 10082023_204627_42.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_42']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7228; val_auprc_score: 0.7662; val_best_acc_score: 0.5233; val_best_f1_score: 0.6738; train_kl_reg_loss: 137637.4704; train_edge_recon_loss: 3714286.2443; train_gene_expr_recon_loss: 26776536.3664; train_masked_gp_l1_reg_loss: 77923.5949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 240945.9880; train_chrom_access_recon_loss: 27215903.3893; train_global_loss: 58163233.3740; train_optim_loss: 58163233.3740; val_kl_reg_loss: 179369.1750; val_edge_recon_loss: 4063841.2333; val_gene_expr_recon_loss: 22983937.4667; val_masked_gp_l1_reg_loss: 73043.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 230713.2344; val_chrom_access_recon_loss: 25950541.8667; val_global_loss: 53481447.4667; val_optim_loss: 53481447.4667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7694; val_auprc_score: 0.7942; val_best_acc_score: 0.6536; val_best_f1_score: 0.7121; train_kl_reg_loss: 199169.6659; train_edge_recon_loss: 3600338.4141; train_gene_expr_recon_loss: 22594062.2595; train_masked_gp_l1_reg_loss: 69997.9221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 218686.5926; train_chrom_access_recon_loss: 25695099.2061; train_global_loss: 52377353.9237; train_optim_loss: 52377353.9237; val_kl_reg_loss: 207186.3979; val_edge_recon_loss: 4045624.9667; val_gene_expr_recon_loss: 22382185.8667; val_masked_gp_l1_reg_loss: 68944.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 206401.5156; val_chrom_access_recon_loss: 25797369.4667; val_global_loss: 52707713.0667; val_optim_loss: 52707713.0667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8522; val_auprc_score: 0.8525; val_best_acc_score: 0.7619; val_best_f1_score: 0.7782; train_kl_reg_loss: 168878.1381; train_edge_recon_loss: 3515553.1469; train_gene_expr_recon_loss: 22227181.7405; train_masked_gp_l1_reg_loss: 69964.8534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 194740.5380; train_chrom_access_recon_loss: 25459074.1985; train_global_loss: 51635392.5802; train_optim_loss: 51635392.5802; val_kl_reg_loss: 157182.2656; val_edge_recon_loss: 3514688.2333; val_gene_expr_recon_loss: 22083793.2000; val_masked_gp_l1_reg_loss: 71770.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 183262.7969; val_chrom_access_recon_loss: 25449049.7333; val_global_loss: 51459745.8667; val_optim_loss: 51459745.8667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9133; val_auprc_score: 0.9044; val_best_acc_score: 0.8362; val_best_f1_score: 0.8452; train_kl_reg_loss: 174020.5567; train_edge_recon_loss: 3168041.7844; train_gene_expr_recon_loss: 22072957.9237; train_masked_gp_l1_reg_loss: 73944.3144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 173243.8898; train_chrom_access_recon_loss: 25329768.4122; train_global_loss: 50991977.1298; train_optim_loss: 50991977.1298; val_kl_reg_loss: 195208.1167; val_edge_recon_loss: 3021077.5333; val_gene_expr_recon_loss: 21914405.4667; val_masked_gp_l1_reg_loss: 75231.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163816.1406; val_chrom_access_recon_loss: 25427238.8000; val_global_loss: 50796977.8667; val_optim_loss: 50796977.8667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9304; val_auprc_score: 0.9171; val_best_acc_score: 0.8601; val_best_f1_score: 0.8667; train_kl_reg_loss: 194997.6627; train_edge_recon_loss: 2941513.9847; train_gene_expr_recon_loss: 21863809.4809; train_masked_gp_l1_reg_loss: 76877.3788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155477.3401; train_chrom_access_recon_loss: 25131544.0916; train_global_loss: 50364220.0611; train_optim_loss: 50364220.0611; val_kl_reg_loss: 185257.4958; val_edge_recon_loss: 2931648.6167; val_gene_expr_recon_loss: 21727212.6667; val_masked_gp_l1_reg_loss: 78377.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147358.0938; val_chrom_access_recon_loss: 25189595.3333; val_global_loss: 50259450.1333; val_optim_loss: 50259450.1333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9328; val_auprc_score: 0.9161; val_best_acc_score: 0.8682; val_best_f1_score: 0.8733; train_kl_reg_loss: 182280.8129; train_edge_recon_loss: 2915194.8053; train_gene_expr_recon_loss: 21721766.7176; train_masked_gp_l1_reg_loss: 80114.7431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140558.2093; train_chrom_access_recon_loss: 25025261.3893; train_global_loss: 50065176.6718; train_optim_loss: 50065176.6718; val_kl_reg_loss: 174085.9188; val_edge_recon_loss: 2900196.1333; val_gene_expr_recon_loss: 21623957.0667; val_masked_gp_l1_reg_loss: 81738.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134323.5156; val_chrom_access_recon_loss: 25077717.3333; val_global_loss: 49992018.4000; val_optim_loss: 49992018.4000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9332; val_auprc_score: 0.9164; val_best_acc_score: 0.8670; val_best_f1_score: 0.8735; train_kl_reg_loss: 174235.0520; train_edge_recon_loss: 2875128.6622; train_gene_expr_recon_loss: 21596141.9237; train_masked_gp_l1_reg_loss: 83134.4396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128887.9047; train_chrom_access_recon_loss: 24909140.1374; train_global_loss: 49766668.0916; train_optim_loss: 49766668.0916; val_kl_reg_loss: 165792.7656; val_edge_recon_loss: 2899295.6500; val_gene_expr_recon_loss: 21525759.3333; val_masked_gp_l1_reg_loss: 84434.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123264.6719; val_chrom_access_recon_loss: 25025945.8667; val_global_loss: 49824490.9333; val_optim_loss: 49824490.9333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9395; val_auprc_score: 0.9236; val_best_acc_score: 0.8763; val_best_f1_score: 0.8845; train_kl_reg_loss: 167488.7115; train_edge_recon_loss: 2853132.6240; train_gene_expr_recon_loss: 21492167.9084; train_masked_gp_l1_reg_loss: 85749.9791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118151.1302; train_chrom_access_recon_loss: 24824984.2137; train_global_loss: 49541674.5954; train_optim_loss: 49541674.5954; val_kl_reg_loss: 163756.5781; val_edge_recon_loss: 2867780.3667; val_gene_expr_recon_loss: 21402565.2000; val_masked_gp_l1_reg_loss: 86932.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113216.9922; val_chrom_access_recon_loss: 24865010.2667; val_global_loss: 49499260.0000; val_optim_loss: 49499260.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9420; val_auprc_score: 0.9243; val_best_acc_score: 0.8801; val_best_f1_score: 0.8873; train_kl_reg_loss: 160685.4363; train_edge_recon_loss: 2844049.4447; train_gene_expr_recon_loss: 21402114.5496; train_masked_gp_l1_reg_loss: 88446.4787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108852.1420; train_chrom_access_recon_loss: 24742687.0076; train_global_loss: 49346834.8702; train_optim_loss: 49346834.8702; val_kl_reg_loss: 161381.5490; val_edge_recon_loss: 2847181.5167; val_gene_expr_recon_loss: 21400700.4000; val_masked_gp_l1_reg_loss: 90359.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104772.7812; val_chrom_access_recon_loss: 24869494.9333; val_global_loss: 49473890.1333; val_optim_loss: 49473890.1333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9474; val_auprc_score: 0.9357; val_best_acc_score: 0.8841; val_best_f1_score: 0.8901; train_kl_reg_loss: 153504.6115; train_edge_recon_loss: 2828352.5229; train_gene_expr_recon_loss: 21335476.6870; train_masked_gp_l1_reg_loss: 91228.9308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101289.1814; train_chrom_access_recon_loss: 24698317.5115; train_global_loss: 49208169.5573; train_optim_loss: 49208169.5573; val_kl_reg_loss: 148168.7260; val_edge_recon_loss: 2834827.9000; val_gene_expr_recon_loss: 21291770.6667; val_masked_gp_l1_reg_loss: 92182.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98093.5703; val_chrom_access_recon_loss: 24782205.0667; val_global_loss: 49247248.5333; val_optim_loss: 49247248.5333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9499; val_auprc_score: 0.9370; val_best_acc_score: 0.8872; val_best_f1_score: 0.8912; train_kl_reg_loss: 149149.1496; train_edge_recon_loss: 2817298.1679; train_gene_expr_recon_loss: 21273838.1221; train_masked_gp_l1_reg_loss: 93042.2170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95107.6129; train_chrom_access_recon_loss: 24647207.6489; train_global_loss: 49075642.8397; train_optim_loss: 49075642.8397; val_kl_reg_loss: 143552.6375; val_edge_recon_loss: 2831395.0167; val_gene_expr_recon_loss: 21166758.9333; val_masked_gp_l1_reg_loss: 93870.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92121.7891; val_chrom_access_recon_loss: 24595732.9333; val_global_loss: 48923431.7333; val_optim_loss: 48923431.7333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9527; val_auprc_score: 0.9420; val_best_acc_score: 0.8907; val_best_f1_score: 0.8973; train_kl_reg_loss: 144930.4414; train_edge_recon_loss: 2807631.0706; train_gene_expr_recon_loss: 21206712.9313; train_masked_gp_l1_reg_loss: 94999.4144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89605.8255; train_chrom_access_recon_loss: 24594044.6565; train_global_loss: 48937924.2443; train_optim_loss: 48937924.2443; val_kl_reg_loss: 130372.6672; val_edge_recon_loss: 2809534.7500; val_gene_expr_recon_loss: 21179332.5333; val_masked_gp_l1_reg_loss: 95921.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87397.4141; val_chrom_access_recon_loss: 24643525.4667; val_global_loss: 48946085.3333; val_optim_loss: 48946085.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9558; val_auprc_score: 0.9465; val_best_acc_score: 0.8919; val_best_f1_score: 0.8974; train_kl_reg_loss: 143946.1735; train_edge_recon_loss: 2805524.0954; train_gene_expr_recon_loss: 21149947.9542; train_masked_gp_l1_reg_loss: 96495.3678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83971.3743; train_chrom_access_recon_loss: 24548574.2748; train_global_loss: 48828459.2061; train_optim_loss: 48828459.2061; val_kl_reg_loss: 323341.1885; val_edge_recon_loss: 2801160.4333; val_gene_expr_recon_loss: 21083306.9333; val_masked_gp_l1_reg_loss: 96915.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80628.6875; val_chrom_access_recon_loss: 24694145.0667; val_global_loss: 49079498.1333; val_optim_loss: 49079498.1333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9490; val_auprc_score: 0.9381; val_best_acc_score: 0.8855; val_best_f1_score: 0.8916; train_kl_reg_loss: 144852.5285; train_edge_recon_loss: 2795393.1908; train_gene_expr_recon_loss: 21151472.1985; train_masked_gp_l1_reg_loss: 97738.4384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78386.6798; train_chrom_access_recon_loss: 24475284.3511; train_global_loss: 48743127.0534; train_optim_loss: 48743127.0534; val_kl_reg_loss: 145262.2615; val_edge_recon_loss: 2816855.4167; val_gene_expr_recon_loss: 21300765.7333; val_masked_gp_l1_reg_loss: 98145.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76232.9062; val_chrom_access_recon_loss: 24665562.6667; val_global_loss: 49102824.0000; val_optim_loss: 49102824.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9528; val_auprc_score: 0.9389; val_best_acc_score: 0.8910; val_best_f1_score: 0.8959; train_kl_reg_loss: 303468.6067; train_edge_recon_loss: 2819791.8989; train_gene_expr_recon_loss: 21418323.8168; train_masked_gp_l1_reg_loss: 98246.7416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74512.5986; train_chrom_access_recon_loss: 24702026.4122; train_global_loss: 49416369.9847; train_optim_loss: 49416369.9847; val_kl_reg_loss: 150151.3656; val_edge_recon_loss: 2804687.4667; val_gene_expr_recon_loss: 21015904.2667; val_masked_gp_l1_reg_loss: 97849.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71883.5000; val_chrom_access_recon_loss: 24510037.8667; val_global_loss: 48650515.2000; val_optim_loss: 48650515.2000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9557; val_auprc_score: 0.9444; val_best_acc_score: 0.8909; val_best_f1_score: 0.8967; train_kl_reg_loss: 147818.9099; train_edge_recon_loss: 2780357.9962; train_gene_expr_recon_loss: 20967478.9771; train_masked_gp_l1_reg_loss: 98146.1424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68858.7761; train_chrom_access_recon_loss: 24392424.8855; train_global_loss: 48455085.6183; train_optim_loss: 48455085.6183; val_kl_reg_loss: 143808.5448; val_edge_recon_loss: 2788459.3000; val_gene_expr_recon_loss: 20822841.4667; val_masked_gp_l1_reg_loss: 98742.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66573.4609; val_chrom_access_recon_loss: 24317064.6667; val_global_loss: 48237490.1333; val_optim_loss: 48237490.1333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9603; val_auprc_score: 0.9532; val_best_acc_score: 0.8989; val_best_f1_score: 0.9033; train_kl_reg_loss: 142464.6413; train_edge_recon_loss: 2779375.4542; train_gene_expr_recon_loss: 20940432.5496; train_masked_gp_l1_reg_loss: 99508.2880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65216.2665; train_chrom_access_recon_loss: 24377939.5725; train_global_loss: 48404936.6718; train_optim_loss: 48404936.6718; val_kl_reg_loss: 142313.1604; val_edge_recon_loss: 2790549.9667; val_gene_expr_recon_loss: 20880627.8667; val_masked_gp_l1_reg_loss: 100510.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63852.4297; val_chrom_access_recon_loss: 24485786.2667; val_global_loss: 48463639.4667; val_optim_loss: 48463639.4667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9612; val_auprc_score: 0.9511; val_best_acc_score: 0.9031; val_best_f1_score: 0.9072; train_kl_reg_loss: 138057.5988; train_edge_recon_loss: 2771995.0210; train_gene_expr_recon_loss: 20882354.0000; train_masked_gp_l1_reg_loss: 101070.9035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62633.1740; train_chrom_access_recon_loss: 24340717.6489; train_global_loss: 48296828.2748; train_optim_loss: 48296828.2748; val_kl_reg_loss: 138073.3646; val_edge_recon_loss: 2777826.6500; val_gene_expr_recon_loss: 20878997.6000; val_masked_gp_l1_reg_loss: 101663.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61516.4414; val_chrom_access_recon_loss: 24422640.1333; val_global_loss: 48380718.1333; val_optim_loss: 48380718.1333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9651; val_auprc_score: 0.9574; val_best_acc_score: 0.9092; val_best_f1_score: 0.9120; train_kl_reg_loss: 136264.8349; train_edge_recon_loss: 2764865.2443; train_gene_expr_recon_loss: 20833599.6031; train_masked_gp_l1_reg_loss: 102452.2088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60557.0937; train_chrom_access_recon_loss: 24285659.0382; train_global_loss: 48183398.0763; train_optim_loss: 48183398.0763; val_kl_reg_loss: 134768.9625; val_edge_recon_loss: 2795889.4667; val_gene_expr_recon_loss: 20772778.5333; val_masked_gp_l1_reg_loss: 103310.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59609.1133; val_chrom_access_recon_loss: 24357725.2000; val_global_loss: 48224082.1333; val_optim_loss: 48224082.1333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9619; val_auprc_score: 0.9518; val_best_acc_score: 0.9022; val_best_f1_score: 0.9071; train_kl_reg_loss: 132981.0096; train_edge_recon_loss: 2762560.4580; train_gene_expr_recon_loss: 20807397.9695; train_masked_gp_l1_reg_loss: 104041.4911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58748.9648; train_chrom_access_recon_loss: 24269061.7557; train_global_loss: 48134791.6641; train_optim_loss: 48134791.6641; val_kl_reg_loss: 133765.1276; val_edge_recon_loss: 2793745.8500; val_gene_expr_recon_loss: 20846284.0000; val_masked_gp_l1_reg_loss: 104947.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57917.8945; val_chrom_access_recon_loss: 24562090.0000; val_global_loss: 48498750.1333; val_optim_loss: 48498750.1333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9669; val_auprc_score: 0.9568; val_best_acc_score: 0.9109; val_best_f1_score: 0.9134; train_kl_reg_loss: 130440.1384; train_edge_recon_loss: 2754896.3092; train_gene_expr_recon_loss: 20763833.4656; train_masked_gp_l1_reg_loss: 105732.5837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57082.7897; train_chrom_access_recon_loss: 24239018.8092; train_global_loss: 48051004.1832; train_optim_loss: 48051004.1832; val_kl_reg_loss: 131290.8740; val_edge_recon_loss: 2775289.9667; val_gene_expr_recon_loss: 20752457.6000; val_masked_gp_l1_reg_loss: 106479.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56213.2070; val_chrom_access_recon_loss: 24354888.8000; val_global_loss: 48176621.0667; val_optim_loss: 48176621.0667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9663; val_auprc_score: 0.9594; val_best_acc_score: 0.9111; val_best_f1_score: 0.9150; train_kl_reg_loss: 127897.0379; train_edge_recon_loss: 2753281.2977; train_gene_expr_recon_loss: 20750623.6336; train_masked_gp_l1_reg_loss: 107285.1472; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55487.5450; train_chrom_access_recon_loss: 24226834.6565; train_global_loss: 48021409.4046; train_optim_loss: 48021409.4046; val_kl_reg_loss: 125101.6115; val_edge_recon_loss: 2773306.9500; val_gene_expr_recon_loss: 20674730.0000; val_masked_gp_l1_reg_loss: 107910.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54539.6836; val_chrom_access_recon_loss: 24173298.9333; val_global_loss: 47908887.2000; val_optim_loss: 47908887.2000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9705; val_auprc_score: 0.9625; val_best_acc_score: 0.9193; val_best_f1_score: 0.9224; train_kl_reg_loss: 125314.6635; train_edge_recon_loss: 2754466.3607; train_gene_expr_recon_loss: 20693456.9160; train_masked_gp_l1_reg_loss: 108692.6121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53867.5132; train_chrom_access_recon_loss: 24165024.0458; train_global_loss: 47900822.2595; train_optim_loss: 47900822.2595; val_kl_reg_loss: 126361.9276; val_edge_recon_loss: 2750884.2500; val_gene_expr_recon_loss: 20749806.6667; val_masked_gp_l1_reg_loss: 109605.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53275.2148; val_chrom_access_recon_loss: 24394685.4667; val_global_loss: 48184620.2667; val_optim_loss: 48184620.2667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9694; val_auprc_score: 0.9620; val_best_acc_score: 0.9155; val_best_f1_score: 0.9186; train_kl_reg_loss: 150508.6437; train_edge_recon_loss: 2751295.6775; train_gene_expr_recon_loss: 20702359.3130; train_masked_gp_l1_reg_loss: 110306.5633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52713.8136; train_chrom_access_recon_loss: 24191108.2901; train_global_loss: 47958292.4275; train_optim_loss: 47958292.4275; val_kl_reg_loss: 123497.0568; val_edge_recon_loss: 2764237.1833; val_gene_expr_recon_loss: 20638308.0000; val_masked_gp_l1_reg_loss: 110957.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52122.2031; val_chrom_access_recon_loss: 24309156.5333; val_global_loss: 47998279.4667; val_optim_loss: 47998279.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9696; val_auprc_score: 0.9627; val_best_acc_score: 0.9178; val_best_f1_score: 0.9201; train_kl_reg_loss: 123193.9603; train_edge_recon_loss: 2741825.9351; train_gene_expr_recon_loss: 20638828.3969; train_masked_gp_l1_reg_loss: 111669.3537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51537.4403; train_chrom_access_recon_loss: 24122229.1298; train_global_loss: 47789284.3359; train_optim_loss: 47789284.3359; val_kl_reg_loss: 123019.5224; val_edge_recon_loss: 2748903.4333; val_gene_expr_recon_loss: 20614718.0000; val_masked_gp_l1_reg_loss: 112570.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51207.1797; val_chrom_access_recon_loss: 24202741.2000; val_global_loss: 47853159.4667; val_optim_loss: 47853159.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9687; val_auprc_score: 0.9604; val_best_acc_score: 0.9185; val_best_f1_score: 0.9224; train_kl_reg_loss: 132732.7248; train_edge_recon_loss: 2792717.9313; train_gene_expr_recon_loss: 21474184.3817; train_masked_gp_l1_reg_loss: 111863.0858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51249.3168; train_chrom_access_recon_loss: 24459727.2366; train_global_loss: 49022474.5344; train_optim_loss: 49022474.5344; val_kl_reg_loss: 68290.8677; val_edge_recon_loss: 2777538.2000; val_gene_expr_recon_loss: 21329409.8667; val_masked_gp_l1_reg_loss: 112072.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51025.9961; val_chrom_access_recon_loss: 24496514.9333; val_global_loss: 48834851.7333; val_optim_loss: 48834851.7333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9716; val_auprc_score: 0.9643; val_best_acc_score: 0.9201; val_best_f1_score: 0.9239; train_kl_reg_loss: 119801.2641; train_edge_recon_loss: 2756350.9504; train_gene_expr_recon_loss: 21338389.4656; train_masked_gp_l1_reg_loss: 112125.6047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50578.7301; train_chrom_access_recon_loss: 24432888.4427; train_global_loss: 48810134.5038; train_optim_loss: 48810134.5038; val_kl_reg_loss: 75725.0766; val_edge_recon_loss: 2771876.8500; val_gene_expr_recon_loss: 21392608.4000; val_masked_gp_l1_reg_loss: 111998.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50051.2266; val_chrom_access_recon_loss: 24650487.0667; val_global_loss: 49052746.9333; val_optim_loss: 49052746.9333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9718; val_auprc_score: 0.9657; val_best_acc_score: 0.9179; val_best_f1_score: 0.9210; train_kl_reg_loss: 109442.3203; train_edge_recon_loss: 2737358.1832; train_gene_expr_recon_loss: 21305041.7405; train_masked_gp_l1_reg_loss: 111976.1219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49669.9691; train_chrom_access_recon_loss: 24438501.8015; train_global_loss: 48751990.2290; train_optim_loss: 48751990.2290; val_kl_reg_loss: 81036.6219; val_edge_recon_loss: 2756474.9333; val_gene_expr_recon_loss: 21314888.6667; val_masked_gp_l1_reg_loss: 111881.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49200.0781; val_chrom_access_recon_loss: 24573149.6000; val_global_loss: 48886631.7333; val_optim_loss: 48886631.7333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9740; val_auprc_score: 0.9683; val_best_acc_score: 0.9229; val_best_f1_score: 0.9253; train_kl_reg_loss: 104407.9818; train_edge_recon_loss: 2723342.4103; train_gene_expr_recon_loss: 21293341.5267; train_masked_gp_l1_reg_loss: 112091.7776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48824.1263; train_chrom_access_recon_loss: 24378000.1374; train_global_loss: 48660008.1527; train_optim_loss: 48660008.1527; val_kl_reg_loss: 81022.1057; val_edge_recon_loss: 2731150.8500; val_gene_expr_recon_loss: 21289962.0000; val_masked_gp_l1_reg_loss: 112308.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48462.0469; val_chrom_access_recon_loss: 24449006.2667; val_global_loss: 48711911.7333; val_optim_loss: 48711911.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9709; val_auprc_score: 0.9644; val_best_acc_score: 0.9184; val_best_f1_score: 0.9216; train_kl_reg_loss: 102184.0525; train_edge_recon_loss: 2728213.3378; train_gene_expr_recon_loss: 21273427.7863; train_masked_gp_l1_reg_loss: 111852.3616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48212.9871; train_chrom_access_recon_loss: 24383505.0840; train_global_loss: 48647395.6947; train_optim_loss: 48647395.6947; val_kl_reg_loss: 82300.5156; val_edge_recon_loss: 2754400.9333; val_gene_expr_recon_loss: 21263380.5333; val_masked_gp_l1_reg_loss: 111726.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48019.0312; val_chrom_access_recon_loss: 24524601.3333; val_global_loss: 48784428.8000; val_optim_loss: 48784428.8000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9710; val_auprc_score: 0.9638; val_best_acc_score: 0.9204; val_best_f1_score: 0.9232; train_kl_reg_loss: 102225.6388; train_edge_recon_loss: 2720358.1622; train_gene_expr_recon_loss: 21273773.9695; train_masked_gp_l1_reg_loss: 111689.7086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47881.8771; train_chrom_access_recon_loss: 24391594.8855; train_global_loss: 48647524.1527; train_optim_loss: 48647524.1527; val_kl_reg_loss: 83303.5995; val_edge_recon_loss: 2725872.2833; val_gene_expr_recon_loss: 21323555.6000; val_masked_gp_l1_reg_loss: 111672.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47748.6250; val_chrom_access_recon_loss: 24598376.0000; val_global_loss: 48890526.9333; val_optim_loss: 48890526.9333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9756; val_auprc_score: 0.9691; val_best_acc_score: 0.9254; val_best_f1_score: 0.9274; train_kl_reg_loss: 102080.8887; train_edge_recon_loss: 2721205.9332; train_gene_expr_recon_loss: 21251081.1145; train_masked_gp_l1_reg_loss: 111651.6224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47636.3830; train_chrom_access_recon_loss: 24425470.9924; train_global_loss: 48659126.9313; train_optim_loss: 48659126.9313; val_kl_reg_loss: 83507.5312; val_edge_recon_loss: 2724260.6333; val_gene_expr_recon_loss: 21277804.9333; val_masked_gp_l1_reg_loss: 111624.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47525.2305; val_chrom_access_recon_loss: 24587430.4000; val_global_loss: 48832154.1333; val_optim_loss: 48832154.1333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9716; val_auprc_score: 0.9642; val_best_acc_score: 0.9225; val_best_f1_score: 0.9250; train_kl_reg_loss: 101598.4213; train_edge_recon_loss: 2723521.5172; train_gene_expr_recon_loss: 21257515.4351; train_masked_gp_l1_reg_loss: 111601.2976; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47419.3437; train_chrom_access_recon_loss: 24448243.0076; train_global_loss: 48689899.0840; train_optim_loss: 48689899.0840; val_kl_reg_loss: 83837.6365; val_edge_recon_loss: 2735535.4167; val_gene_expr_recon_loss: 21299908.4000; val_masked_gp_l1_reg_loss: 111579.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47309.0195; val_chrom_access_recon_loss: 24655255.2000; val_global_loss: 48933426.9333; val_optim_loss: 48933426.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 17 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9710
val AUPRC score: 0.9640
val best accuracy score: 0.9169
val best F1 score: 0.9191
val target rna MSE score: 1.2690
val source rna MSE score: 78.2263
val target atac MSE score: 0.3459
val source atac MSE score: 4.8639
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
