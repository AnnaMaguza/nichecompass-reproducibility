[True]
Run timestamp: 27072023_012235_109.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_109']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8998; val_auprc_score: 0.9784; val_best_acc_score: 0.8541; val_best_f1_score: 0.9213; train_kl_reg_loss: 20745799.8983; train_edge_recon_loss: 11619428.9256; train_gene_expr_recon_loss: 15282120.2860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 47647349.0372; train_optim_loss: 47647349.0372; val_kl_reg_loss: 7425495.3333; val_edge_recon_loss: 11848561.0000; val_gene_expr_recon_loss: 5169279.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24443335.4167; val_optim_loss: 24443335.4167
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8924; val_auprc_score: 0.9772; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 7998289.8392; train_edge_recon_loss: 11734757.7442; train_gene_expr_recon_loss: 17949168.6884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37682216.1907; train_optim_loss: 37682216.1907; val_kl_reg_loss: 2096312.7188; val_edge_recon_loss: 11992279.0833; val_gene_expr_recon_loss: 7200205.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21288797.6667; val_optim_loss: 21288797.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8850; val_auprc_score: 0.9765; val_best_acc_score: 0.8526; val_best_f1_score: 0.9204; train_kl_reg_loss: 2990623.3049; train_edge_recon_loss: 11843204.6140; train_gene_expr_recon_loss: 13389666.6744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28223494.6372; train_optim_loss: 28223494.6372; val_kl_reg_loss: 5474856.1250; val_edge_recon_loss: 11968876.6667; val_gene_expr_recon_loss: 5226791.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22670524.3333; val_optim_loss: 22670524.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8733; val_auprc_score: 0.9736; val_best_acc_score: 0.8524; val_best_f1_score: 0.9203; train_kl_reg_loss: 1785074.2583; train_edge_recon_loss: 11732957.1628; train_gene_expr_recon_loss: 9075596.2581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22593627.6233; train_optim_loss: 22593627.6233; val_kl_reg_loss: 1650379.4792; val_edge_recon_loss: 11991515.8333; val_gene_expr_recon_loss: 4601444.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18243339.2500; val_optim_loss: 18243339.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8552; val_auprc_score: 0.9687; val_best_acc_score: 0.8725; val_best_f1_score: 0.9282; train_kl_reg_loss: 450107.0270; train_edge_recon_loss: 11775586.7070; train_gene_expr_recon_loss: 6707408.8547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18933102.5488; train_optim_loss: 18933102.5488; val_kl_reg_loss: 135129.0990; val_edge_recon_loss: 12038041.1250; val_gene_expr_recon_loss: 3704458.1771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15877628.3750; val_optim_loss: 15877628.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8542; val_auprc_score: 0.9675; val_best_acc_score: 0.8884; val_best_f1_score: 0.9373; train_kl_reg_loss: 157511.9012; train_edge_recon_loss: 11294041.6279; train_gene_expr_recon_loss: 3042442.1674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14493995.6744; train_optim_loss: 14493995.6744; val_kl_reg_loss: 188081.0339; val_edge_recon_loss: 10953597.6667; val_gene_expr_recon_loss: 2131916.1771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13273594.8750; val_optim_loss: 13273594.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8460; val_auprc_score: 0.9646; val_best_acc_score: 0.8885; val_best_f1_score: 0.9370; train_kl_reg_loss: 83080.1945; train_edge_recon_loss: 9815371.9814; train_gene_expr_recon_loss: 1792739.2064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11691191.3860; train_optim_loss: 11691191.3860; val_kl_reg_loss: 77960.3363; val_edge_recon_loss: 9170649.8125; val_gene_expr_recon_loss: 1329656.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10578266.5833; val_optim_loss: 10578266.5833
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8349; val_auprc_score: 0.9627; val_best_acc_score: 0.8845; val_best_f1_score: 0.9353; train_kl_reg_loss: 88297.4665; train_edge_recon_loss: 8877004.2558; train_gene_expr_recon_loss: 1250007.4099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10215309.1488; train_optim_loss: 10215309.1488; val_kl_reg_loss: 87985.1393; val_edge_recon_loss: 9206978.6875; val_gene_expr_recon_loss: 1185084.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10480048.1250; val_optim_loss: 10480048.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8462; val_auprc_score: 0.9669; val_best_acc_score: 0.8928; val_best_f1_score: 0.9399; train_kl_reg_loss: 93872.0585; train_edge_recon_loss: 8674621.3907; train_gene_expr_recon_loss: 1151315.7442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9919809.2186; train_optim_loss: 9919809.2186; val_kl_reg_loss: 89864.1764; val_edge_recon_loss: 8845435.9167; val_gene_expr_recon_loss: 1117763.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10053063.9583; val_optim_loss: 10053063.9583
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8491; val_auprc_score: 0.9680; val_best_acc_score: 0.8973; val_best_f1_score: 0.9426; train_kl_reg_loss: 93661.0190; train_edge_recon_loss: 8700486.9535; train_gene_expr_recon_loss: 1090539.0058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9884686.9907; train_optim_loss: 9884686.9907; val_kl_reg_loss: 88987.6576; val_edge_recon_loss: 8644545.3125; val_gene_expr_recon_loss: 1064079.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9797612.0833; val_optim_loss: 9797612.0833
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8512; val_auprc_score: 0.9691; val_best_acc_score: 0.8989; val_best_f1_score: 0.9435; train_kl_reg_loss: 87854.5950; train_edge_recon_loss: 8676357.7372; train_gene_expr_recon_loss: 1054115.0090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9818327.3488; train_optim_loss: 9818327.3488; val_kl_reg_loss: 79919.3255; val_edge_recon_loss: 8573408.5833; val_gene_expr_recon_loss: 1034565.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9687893.3125; val_optim_loss: 9687893.3125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8492; val_auprc_score: 0.9662; val_best_acc_score: 0.8929; val_best_f1_score: 0.9399; train_kl_reg_loss: 79585.3060; train_edge_recon_loss: 8581567.8605; train_gene_expr_recon_loss: 1029000.4599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9690153.6465; train_optim_loss: 9690153.6465; val_kl_reg_loss: 70576.6706; val_edge_recon_loss: 8966643.0417; val_gene_expr_recon_loss: 1015098.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10052318.1250; val_optim_loss: 10052318.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8442; val_auprc_score: 0.9660; val_best_acc_score: 0.8937; val_best_f1_score: 0.9407; train_kl_reg_loss: 68081.5210; train_edge_recon_loss: 8453874.5884; train_gene_expr_recon_loss: 1014254.8901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9536211.0116; train_optim_loss: 9536211.0116; val_kl_reg_loss: 58202.1523; val_edge_recon_loss: 8631291.0625; val_gene_expr_recon_loss: 1002564.0339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9692057.2500; val_optim_loss: 9692057.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8542; val_auprc_score: 0.9666; val_best_acc_score: 0.8890; val_best_f1_score: 0.9378; train_kl_reg_loss: 53736.9945; train_edge_recon_loss: 8333981.6163; train_gene_expr_recon_loss: 996993.7369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9384712.3651; train_optim_loss: 9384712.3651; val_kl_reg_loss: 45776.4404; val_edge_recon_loss: 8679419.7083; val_gene_expr_recon_loss: 985806.6979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9711002.7500; val_optim_loss: 9711002.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8686; val_auprc_score: 0.9695; val_best_acc_score: 0.8862; val_best_f1_score: 0.9357; train_kl_reg_loss: 43699.7172; train_edge_recon_loss: 8207119.9558; train_gene_expr_recon_loss: 978864.8235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9229684.5419; train_optim_loss: 9229684.5419; val_kl_reg_loss: 39394.4686; val_edge_recon_loss: 8439411.0000; val_gene_expr_recon_loss: 965818.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9444623.8958; val_optim_loss: 9444623.8958
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8843; val_auprc_score: 0.9741; val_best_acc_score: 0.8921; val_best_f1_score: 0.9394; train_kl_reg_loss: 40068.3058; train_edge_recon_loss: 8191229.3605; train_gene_expr_recon_loss: 958669.8797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9189967.5535; train_optim_loss: 9189967.5535; val_kl_reg_loss: 36304.4906; val_edge_recon_loss: 8364880.2083; val_gene_expr_recon_loss: 948874.0755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9350058.7917; val_optim_loss: 9350058.7917
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9001; val_auprc_score: 0.9770; val_best_acc_score: 0.9099; val_best_f1_score: 0.9484; train_kl_reg_loss: 34963.3510; train_edge_recon_loss: 7974787.8884; train_gene_expr_recon_loss: 942235.4253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8951986.6605; train_optim_loss: 8951986.6605; val_kl_reg_loss: 31435.8570; val_edge_recon_loss: 8161429.5417; val_gene_expr_recon_loss: 932910.2865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9125775.6250; val_optim_loss: 9125775.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9103; val_auprc_score: 0.9801; val_best_acc_score: 0.9214; val_best_f1_score: 0.9550; train_kl_reg_loss: 29529.1502; train_edge_recon_loss: 7953328.5558; train_gene_expr_recon_loss: 926155.9648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8909013.6814; train_optim_loss: 8909013.6814; val_kl_reg_loss: 26146.1387; val_edge_recon_loss: 7980888.4583; val_gene_expr_recon_loss: 917332.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8924367.2083; val_optim_loss: 8924367.2083
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9265; val_auprc_score: 0.9841; val_best_acc_score: 0.9208; val_best_f1_score: 0.9544; train_kl_reg_loss: 25946.8194; train_edge_recon_loss: 7858744.9535; train_gene_expr_recon_loss: 912672.7090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8797364.5070; train_optim_loss: 8797364.5070; val_kl_reg_loss: 24295.9699; val_edge_recon_loss: 7963394.3125; val_gene_expr_recon_loss: 904513.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8892203.8750; val_optim_loss: 8892203.8750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9386; val_auprc_score: 0.9855; val_best_acc_score: 0.9246; val_best_f1_score: 0.9562; train_kl_reg_loss: 23826.6996; train_edge_recon_loss: 7885150.9512; train_gene_expr_recon_loss: 899937.2980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8808914.9767; train_optim_loss: 8808914.9767; val_kl_reg_loss: 21841.3805; val_edge_recon_loss: 8322667.0625; val_gene_expr_recon_loss: 891958.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9236467.2917; val_optim_loss: 9236467.2917
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9410; val_auprc_score: 0.9866; val_best_acc_score: 0.9349; val_best_f1_score: 0.9624; train_kl_reg_loss: 22862.3841; train_edge_recon_loss: 7828703.7558; train_gene_expr_recon_loss: 887732.0910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8739298.2256; train_optim_loss: 8739298.2256; val_kl_reg_loss: 22502.4832; val_edge_recon_loss: 7766200.7708; val_gene_expr_recon_loss: 879602.7865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8668306.0000; val_optim_loss: 8668306.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9456; val_auprc_score: 0.9871; val_best_acc_score: 0.9330; val_best_f1_score: 0.9612; train_kl_reg_loss: 22486.9718; train_edge_recon_loss: 7772326.4907; train_gene_expr_recon_loss: 876729.3041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8671542.7698; train_optim_loss: 8671542.7698; val_kl_reg_loss: 21573.7388; val_edge_recon_loss: 8110791.8750; val_gene_expr_recon_loss: 869538.9635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9001904.6042; val_optim_loss: 9001904.6042
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9425; val_auprc_score: 0.9867; val_best_acc_score: 0.9336; val_best_f1_score: 0.9616; train_kl_reg_loss: 21928.4444; train_edge_recon_loss: 7807973.1488; train_gene_expr_recon_loss: 866536.0799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8696437.6930; train_optim_loss: 8696437.6930; val_kl_reg_loss: 20619.5212; val_edge_recon_loss: 8039072.1250; val_gene_expr_recon_loss: 861465.0990; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8921156.6875; val_optim_loss: 8921156.6875
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9510; val_auprc_score: 0.9884; val_best_acc_score: 0.9419; val_best_f1_score: 0.9665; train_kl_reg_loss: 22170.3997; train_edge_recon_loss: 7852220.6744; train_gene_expr_recon_loss: 857319.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8731711.0442; train_optim_loss: 8731711.0442; val_kl_reg_loss: 21395.6259; val_edge_recon_loss: 7774944.1667; val_gene_expr_recon_loss: 852199.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8648539.0833; val_optim_loss: 8648539.0833
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9479; val_auprc_score: 0.9873; val_best_acc_score: 0.9384; val_best_f1_score: 0.9642; train_kl_reg_loss: 21816.7117; train_edge_recon_loss: 7743095.7605; train_gene_expr_recon_loss: 848878.0029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8613790.4419; train_optim_loss: 8613790.4419; val_kl_reg_loss: 20992.7836; val_edge_recon_loss: 8054591.6458; val_gene_expr_recon_loss: 843536.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8919120.4167; val_optim_loss: 8919120.4167
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9449; val_auprc_score: 0.9875; val_best_acc_score: 0.9372; val_best_f1_score: 0.9638; train_kl_reg_loss: 21520.4160; train_edge_recon_loss: 7774497.0558; train_gene_expr_recon_loss: 840561.9799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8636579.4140; train_optim_loss: 8636579.4140; val_kl_reg_loss: 21636.6390; val_edge_recon_loss: 7917425.3542; val_gene_expr_recon_loss: 834513.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8773575.5000; val_optim_loss: 8773575.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9496; val_auprc_score: 0.9882; val_best_acc_score: 0.9376; val_best_f1_score: 0.9640; train_kl_reg_loss: 22577.0773; train_edge_recon_loss: 7755893.3256; train_gene_expr_recon_loss: 832707.9666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8611178.3465; train_optim_loss: 8611178.3465; val_kl_reg_loss: 22409.0950; val_edge_recon_loss: 7793205.2292; val_gene_expr_recon_loss: 826624.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8642238.5208; val_optim_loss: 8642238.5208
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9516; val_auprc_score: 0.9893; val_best_acc_score: 0.9370; val_best_f1_score: 0.9634; train_kl_reg_loss: 22595.9451; train_edge_recon_loss: 7773770.0930; train_gene_expr_recon_loss: 824593.1573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8620959.1907; train_optim_loss: 8620959.1907; val_kl_reg_loss: 21532.8489; val_edge_recon_loss: 8082906.4583; val_gene_expr_recon_loss: 819308.9948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8923748.3750; val_optim_loss: 8923748.3750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9518; val_auprc_score: 0.9890; val_best_acc_score: 0.9398; val_best_f1_score: 0.9652; train_kl_reg_loss: 22806.6125; train_edge_recon_loss: 7681990.6000; train_gene_expr_recon_loss: 817904.9137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8522702.1000; train_optim_loss: 8522702.1000; val_kl_reg_loss: 22734.8845; val_edge_recon_loss: 7927924.0625; val_gene_expr_recon_loss: 813114.3802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8763773.3542; val_optim_loss: 8763773.3542
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9527; val_auprc_score: 0.9898; val_best_acc_score: 0.9440; val_best_f1_score: 0.9677; train_kl_reg_loss: 23640.3264; train_edge_recon_loss: 7767917.1605; train_gene_expr_recon_loss: 811065.3875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8602622.8721; train_optim_loss: 8602622.8721; val_kl_reg_loss: 23029.3494; val_edge_recon_loss: 7824064.1250; val_gene_expr_recon_loss: 805175.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8652268.9167; val_optim_loss: 8652268.9167
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9516; val_auprc_score: 0.9881; val_best_acc_score: 0.9403; val_best_f1_score: 0.9655; train_kl_reg_loss: 24185.2282; train_edge_recon_loss: 7645450.7651; train_gene_expr_recon_loss: 804562.8247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8474198.8233; train_optim_loss: 8474198.8233; val_kl_reg_loss: 23411.7492; val_edge_recon_loss: 8024027.0000; val_gene_expr_recon_loss: 799701.3932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8847140.1458; val_optim_loss: 8847140.1458

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9532; val_auprc_score: 0.9892; val_best_acc_score: 0.9419; val_best_f1_score: 0.9664; train_kl_reg_loss: 23869.9815; train_edge_recon_loss: 7703812.8884; train_gene_expr_recon_loss: 800344.7462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8528027.5930; train_optim_loss: 8528027.5930; val_kl_reg_loss: 22717.0482; val_edge_recon_loss: 7844296.0625; val_gene_expr_recon_loss: 799020.7865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8666033.9375; val_optim_loss: 8666033.9375
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9538; val_auprc_score: 0.9896; val_best_acc_score: 0.9437; val_best_f1_score: 0.9674; train_kl_reg_loss: 23347.4863; train_edge_recon_loss: 7760144.7233; train_gene_expr_recon_loss: 799756.3948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8583248.6279; train_optim_loss: 8583248.6279; val_kl_reg_loss: 22497.8577; val_edge_recon_loss: 7772169.7708; val_gene_expr_recon_loss: 797594.1901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8592261.8125; val_optim_loss: 8592261.8125
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9515; val_auprc_score: 0.9886; val_best_acc_score: 0.9410; val_best_f1_score: 0.9656; train_kl_reg_loss: 22932.7284; train_edge_recon_loss: 7668696.0116; train_gene_expr_recon_loss: 798898.7235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8490527.4581; train_optim_loss: 8490527.4581; val_kl_reg_loss: 22004.6055; val_edge_recon_loss: 8005065.6667; val_gene_expr_recon_loss: 796427.0755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8823497.3542; val_optim_loss: 8823497.3542
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9504; val_auprc_score: 0.9888; val_best_acc_score: 0.9426; val_best_f1_score: 0.9667; train_kl_reg_loss: 22764.2925; train_edge_recon_loss: 7820034.4953; train_gene_expr_recon_loss: 798213.1448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8641011.9186; train_optim_loss: 8641011.9186; val_kl_reg_loss: 21926.3726; val_edge_recon_loss: 7840408.9583; val_gene_expr_recon_loss: 795847.9948; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8658183.2917; val_optim_loss: 8658183.2917
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9574; val_auprc_score: 0.9906; val_best_acc_score: 0.9461; val_best_f1_score: 0.9689; train_kl_reg_loss: 22444.3385; train_edge_recon_loss: 7660854.4581; train_gene_expr_recon_loss: 797419.6073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8480718.3860; train_optim_loss: 8480718.3860; val_kl_reg_loss: 21467.7264; val_edge_recon_loss: 7619793.3125; val_gene_expr_recon_loss: 795153.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8436414.6667; val_optim_loss: 8436414.6667
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9559; val_auprc_score: 0.9900; val_best_acc_score: 0.9427; val_best_f1_score: 0.9667; train_kl_reg_loss: 22004.7586; train_edge_recon_loss: 7690975.7465; train_gene_expr_recon_loss: 796782.2939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8509762.8070; train_optim_loss: 8509762.8070; val_kl_reg_loss: 21303.0668; val_edge_recon_loss: 8090556.1042; val_gene_expr_recon_loss: 794062.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8905921.7500; val_optim_loss: 8905921.7500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9536; val_auprc_score: 0.9891; val_best_acc_score: 0.9441; val_best_f1_score: 0.9677; train_kl_reg_loss: 21909.2958; train_edge_recon_loss: 7637543.3279; train_gene_expr_recon_loss: 795719.0695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8455171.6907; train_optim_loss: 8455171.6907; val_kl_reg_loss: 21148.9413; val_edge_recon_loss: 7908201.4167; val_gene_expr_recon_loss: 792973.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8722323.9375; val_optim_loss: 8722323.9375
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9504; val_auprc_score: 0.9888; val_best_acc_score: 0.9427; val_best_f1_score: 0.9670; train_kl_reg_loss: 21649.2534; train_edge_recon_loss: 7670938.2674; train_gene_expr_recon_loss: 794858.8599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8487446.3953; train_optim_loss: 8487446.3953; val_kl_reg_loss: 20766.8343; val_edge_recon_loss: 7771339.2917; val_gene_expr_recon_loss: 793952.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8586059.0833; val_optim_loss: 8586059.0833
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9543; val_auprc_score: 0.9888; val_best_acc_score: 0.9420; val_best_f1_score: 0.9663; train_kl_reg_loss: 21258.5276; train_edge_recon_loss: 7656117.0930; train_gene_expr_recon_loss: 793760.5628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8471136.1977; train_optim_loss: 8471136.1977; val_kl_reg_loss: 20172.1803; val_edge_recon_loss: 8087032.4792; val_gene_expr_recon_loss: 792888.4974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8900093.1458; val_optim_loss: 8900093.1458

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9565; val_auprc_score: 0.9899; val_best_acc_score: 0.9479; val_best_f1_score: 0.9699; train_kl_reg_loss: 20988.6070; train_edge_recon_loss: 7703393.7047; train_gene_expr_recon_loss: 793405.1346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8517787.4256; train_optim_loss: 8517787.4256; val_kl_reg_loss: 20423.4172; val_edge_recon_loss: 7598539.5625; val_gene_expr_recon_loss: 791952.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8410915.5417; val_optim_loss: 8410915.5417
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9552; val_auprc_score: 0.9893; val_best_acc_score: 0.9469; val_best_f1_score: 0.9694; train_kl_reg_loss: 20981.2803; train_edge_recon_loss: 7659426.3488; train_gene_expr_recon_loss: 793321.4169; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8473729.0116; train_optim_loss: 8473729.0116; val_kl_reg_loss: 20344.2076; val_edge_recon_loss: 7807689.0417; val_gene_expr_recon_loss: 791605.1510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8619638.2917; val_optim_loss: 8619638.2917
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9540; val_auprc_score: 0.9887; val_best_acc_score: 0.9438; val_best_f1_score: 0.9674; train_kl_reg_loss: 20897.5535; train_edge_recon_loss: 7766718.1791; train_gene_expr_recon_loss: 792917.1265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8580532.8698; train_optim_loss: 8580532.8698; val_kl_reg_loss: 20214.6192; val_edge_recon_loss: 7945828.6667; val_gene_expr_recon_loss: 791789.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8757832.6250; val_optim_loss: 8757832.6250
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9541; val_auprc_score: 0.9885; val_best_acc_score: 0.9445; val_best_f1_score: 0.9679; train_kl_reg_loss: 20868.9876; train_edge_recon_loss: 7678355.1837; train_gene_expr_recon_loss: 792794.4570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8492018.6395; train_optim_loss: 8492018.6395; val_kl_reg_loss: 20311.7819; val_edge_recon_loss: 7738849.8958; val_gene_expr_recon_loss: 791490.7135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8550652.4375; val_optim_loss: 8550652.4375
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9484; val_auprc_score: 0.9879; val_best_acc_score: 0.9453; val_best_f1_score: 0.9685; train_kl_reg_loss: 20814.7279; train_edge_recon_loss: 7713552.6605; train_gene_expr_recon_loss: 792773.6337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8527141.0512; train_optim_loss: 8527141.0512; val_kl_reg_loss: 20129.8678; val_edge_recon_loss: 7656581.8750; val_gene_expr_recon_loss: 790934.8307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8467646.5417; val_optim_loss: 8467646.5417

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9558; val_auprc_score: 0.9903; val_best_acc_score: 0.9408; val_best_f1_score: 0.9659; train_kl_reg_loss: 20748.2199; train_edge_recon_loss: 7750849.1140; train_gene_expr_recon_loss: 792654.8532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8564252.1884; train_optim_loss: 8564252.1884; val_kl_reg_loss: 20160.0688; val_edge_recon_loss: 7808100.0208; val_gene_expr_recon_loss: 791553.7474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8619813.7708; val_optim_loss: 8619813.7708
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9504; val_auprc_score: 0.9875; val_best_acc_score: 0.9418; val_best_f1_score: 0.9665; train_kl_reg_loss: 20742.9503; train_edge_recon_loss: 7775883.7140; train_gene_expr_recon_loss: 792475.4913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8589102.1442; train_optim_loss: 8589102.1442; val_kl_reg_loss: 20135.7358; val_edge_recon_loss: 7860485.7292; val_gene_expr_recon_loss: 791149.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8671770.6458; val_optim_loss: 8671770.6458
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9537; val_auprc_score: 0.9893; val_best_acc_score: 0.9423; val_best_f1_score: 0.9666; train_kl_reg_loss: 20757.1652; train_edge_recon_loss: 7810048.8814; train_gene_expr_recon_loss: 792734.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8623540.6977; train_optim_loss: 8623540.6977; val_kl_reg_loss: 20136.1999; val_edge_recon_loss: 7920572.7500; val_gene_expr_recon_loss: 791581.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8732290.6042; val_optim_loss: 8732290.6042
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9544; val_auprc_score: 0.9892; val_best_acc_score: 0.9444; val_best_f1_score: 0.9680; train_kl_reg_loss: 20739.7005; train_edge_recon_loss: 7695972.0070; train_gene_expr_recon_loss: 792489.0875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8509200.7837; train_optim_loss: 8509200.7837; val_kl_reg_loss: 20104.7212; val_edge_recon_loss: 7739923.6667; val_gene_expr_recon_loss: 791348.9271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8551377.3750; val_optim_loss: 8551377.3750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 59 min 28 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
Val AUROC score: 0.9581
Val AUPRC score: 0.9909
Val best accuracy score: 0.9449
Val best F1 score: 0.9681
Val gene expr MSE score: 28561.1727
Val cat covariate0 mean sim diff: 0.0026

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
