[True]
Run timestamp: 07082023_211535_122.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_122']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8780; val_auprc_score: 0.8979; val_best_acc_score: 0.5066; val_best_f1_score: 0.6696; train_kl_reg_loss: 36591.6338; train_edge_recon_loss: 3475979.9167; train_gene_expr_recon_loss: 1409675.4028; train_masked_gp_l1_reg_loss: 8555.2744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119676.6641; train_chrom_access_recon_loss: 3445322.9444; train_global_loss: 8495801.8889; train_optim_loss: 8495801.8889; val_kl_reg_loss: 9247.5586; val_edge_recon_loss: 4064819.0000; val_gene_expr_recon_loss: 1167597.0000; val_masked_gp_l1_reg_loss: 6778.2075; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117444.2266; val_chrom_access_recon_loss: 1747140.5000; val_global_loss: 7113026.0000; val_optim_loss: 7113026.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8850; val_auprc_score: 0.9000; val_best_acc_score: 0.5132; val_best_f1_score: 0.6726; train_kl_reg_loss: 6631.6107; train_edge_recon_loss: 3472371.1111; train_gene_expr_recon_loss: 1092652.6875; train_masked_gp_l1_reg_loss: 6066.0049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116143.1632; train_chrom_access_recon_loss: 1556780.6250; train_global_loss: 6250645.0556; train_optim_loss: 6250645.0556; val_kl_reg_loss: 4104.7344; val_edge_recon_loss: 4064435.7500; val_gene_expr_recon_loss: 1044168.0000; val_masked_gp_l1_reg_loss: 5497.9517; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114636.5234; val_chrom_access_recon_loss: 1483477.1250; val_global_loss: 6716320.0000; val_optim_loss: 6716320.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8808; val_auprc_score: 0.8973; val_best_acc_score: 0.5127; val_best_f1_score: 0.6723; train_kl_reg_loss: 4315.7834; train_edge_recon_loss: 3472776.9722; train_gene_expr_recon_loss: 1008059.3958; train_masked_gp_l1_reg_loss: 5511.1925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113530.6050; train_chrom_access_recon_loss: 1436152.5278; train_global_loss: 6040346.5556; train_optim_loss: 6040346.5556; val_kl_reg_loss: 5658.7305; val_edge_recon_loss: 4064855.2500; val_gene_expr_recon_loss: 962724.4375; val_masked_gp_l1_reg_loss: 5622.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112156.4453; val_chrom_access_recon_loss: 1445104.5000; val_global_loss: 6596122.5000; val_optim_loss: 6596122.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8841; val_auprc_score: 0.9007; val_best_acc_score: 0.5043; val_best_f1_score: 0.6686; train_kl_reg_loss: 11087.0521; train_edge_recon_loss: 3476306.3056; train_gene_expr_recon_loss: 912050.0417; train_masked_gp_l1_reg_loss: 5686.0586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111027.0530; train_chrom_access_recon_loss: 1413479.0139; train_global_loss: 5929635.6111; train_optim_loss: 5929635.6111; val_kl_reg_loss: 16808.1602; val_edge_recon_loss: 4065585.5000; val_gene_expr_recon_loss: 869520.0000; val_masked_gp_l1_reg_loss: 5735.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109568.9062; val_chrom_access_recon_loss: 1418366.1250; val_global_loss: 6485584.5000; val_optim_loss: 6485584.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8815; val_auprc_score: 0.8984; val_best_acc_score: 0.5047; val_best_f1_score: 0.6688; train_kl_reg_loss: 17850.9881; train_edge_recon_loss: 3478283.0000; train_gene_expr_recon_loss: 841482.2222; train_masked_gp_l1_reg_loss: 5777.4786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108289.8811; train_chrom_access_recon_loss: 1384892.8333; train_global_loss: 5836576.4444; train_optim_loss: 5836576.4444; val_kl_reg_loss: 16954.4492; val_edge_recon_loss: 4065595.7500; val_gene_expr_recon_loss: 813086.1250; val_masked_gp_l1_reg_loss: 5837.9043; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106603.5547; val_chrom_access_recon_loss: 1395374.0000; val_global_loss: 6403452.0000; val_optim_loss: 6403452.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8865; val_auprc_score: 0.9003; val_best_acc_score: 0.5133; val_best_f1_score: 0.6725; train_kl_reg_loss: 18058.5460; train_edge_recon_loss: 3480250.2778; train_gene_expr_recon_loss: 793255.7153; train_masked_gp_l1_reg_loss: 5899.4663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105119.6215; train_chrom_access_recon_loss: 1362762.7500; train_global_loss: 5765346.3889; train_optim_loss: 5765346.3889; val_kl_reg_loss: 18712.4492; val_edge_recon_loss: 4064865.7500; val_gene_expr_recon_loss: 780988.7500; val_masked_gp_l1_reg_loss: 5966.5869; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103190.9766; val_chrom_access_recon_loss: 1378451.7500; val_global_loss: 6352176.0000; val_optim_loss: 6352176.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8785; val_auprc_score: 0.8778; val_best_acc_score: 0.5280; val_best_f1_score: 0.6782; train_kl_reg_loss: 19185.6664; train_edge_recon_loss: 3480205.2778; train_gene_expr_recon_loss: 765694.3056; train_masked_gp_l1_reg_loss: 6013.3829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101545.5885; train_chrom_access_recon_loss: 1349728.2917; train_global_loss: 5722372.3333; train_optim_loss: 5722372.3333; val_kl_reg_loss: 20091.3066; val_edge_recon_loss: 4062742.0000; val_gene_expr_recon_loss: 758625.0625; val_masked_gp_l1_reg_loss: 6061.5752; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99444.8359; val_chrom_access_recon_loss: 1367069.8750; val_global_loss: 6314035.0000; val_optim_loss: 6314035.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8712; val_auprc_score: 0.8667; val_best_acc_score: 0.5873; val_best_f1_score: 0.7046; train_kl_reg_loss: 20174.0024; train_edge_recon_loss: 3480286.1111; train_gene_expr_recon_loss: 749234.4097; train_masked_gp_l1_reg_loss: 6104.1140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97713.9384; train_chrom_access_recon_loss: 1345328.6389; train_global_loss: 5698841.3889; train_optim_loss: 5698841.3889; val_kl_reg_loss: 19153.8984; val_edge_recon_loss: 4058411.7500; val_gene_expr_recon_loss: 742403.4375; val_masked_gp_l1_reg_loss: 6146.1260; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95533.4766; val_chrom_access_recon_loss: 1359744.6250; val_global_loss: 6281393.0000; val_optim_loss: 6281393.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8565; val_auprc_score: 0.8466; val_best_acc_score: 0.6776; val_best_f1_score: 0.7488; train_kl_reg_loss: 20060.2810; train_edge_recon_loss: 3479400.3611; train_gene_expr_recon_loss: 732506.5139; train_masked_gp_l1_reg_loss: 6189.1331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93777.0929; train_chrom_access_recon_loss: 1333300.6944; train_global_loss: 5665234.0000; train_optim_loss: 5665234.0000; val_kl_reg_loss: 19087.3633; val_edge_recon_loss: 4051422.5000; val_gene_expr_recon_loss: 728979.6250; val_masked_gp_l1_reg_loss: 6227.8955; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91580.8594; val_chrom_access_recon_loss: 1353994.0000; val_global_loss: 6251292.5000; val_optim_loss: 6251292.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8454; val_auprc_score: 0.8320; val_best_acc_score: 0.7459; val_best_f1_score: 0.7820; train_kl_reg_loss: 20625.6287; train_edge_recon_loss: 3479327.7778; train_gene_expr_recon_loss: 724056.3889; train_masked_gp_l1_reg_loss: 6262.4322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89832.4384; train_chrom_access_recon_loss: 1332861.6944; train_global_loss: 5652966.5000; train_optim_loss: 5652966.5000; val_kl_reg_loss: 19296.3457; val_edge_recon_loss: 4033422.7500; val_gene_expr_recon_loss: 719412.3750; val_masked_gp_l1_reg_loss: 6299.7910; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87660.5000; val_chrom_access_recon_loss: 1349510.5000; val_global_loss: 6215602.5000; val_optim_loss: 6215602.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8334; val_auprc_score: 0.8169; val_best_acc_score: 0.7548; val_best_f1_score: 0.7580; train_kl_reg_loss: 19465.2899; train_edge_recon_loss: 3477177.0278; train_gene_expr_recon_loss: 710973.4306; train_masked_gp_l1_reg_loss: 6344.7963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85948.5564; train_chrom_access_recon_loss: 1329722.8889; train_global_loss: 5629632.0556; train_optim_loss: 5629632.0556; val_kl_reg_loss: 17536.7344; val_edge_recon_loss: 3987290.2500; val_gene_expr_recon_loss: 713716.9375; val_masked_gp_l1_reg_loss: 6385.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83826.9922; val_chrom_access_recon_loss: 1346055.1250; val_global_loss: 6154811.5000; val_optim_loss: 6154811.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8383; val_auprc_score: 0.8153; val_best_acc_score: 0.7653; val_best_f1_score: 0.7904; train_kl_reg_loss: 16701.1772; train_edge_recon_loss: 3459946.3056; train_gene_expr_recon_loss: 710530.7431; train_masked_gp_l1_reg_loss: 6434.2794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82171.4375; train_chrom_access_recon_loss: 1324381.2083; train_global_loss: 5600165.2222; train_optim_loss: 5600165.2222; val_kl_reg_loss: 11793.5811; val_edge_recon_loss: 3745729.7500; val_gene_expr_recon_loss: 716295.2500; val_masked_gp_l1_reg_loss: 6492.8369; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80128.7031; val_chrom_access_recon_loss: 1344964.8750; val_global_loss: 5905405.0000; val_optim_loss: 5905405.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8370; val_auprc_score: 0.8213; val_best_acc_score: 0.7464; val_best_f1_score: 0.7808; train_kl_reg_loss: 9562.8116; train_edge_recon_loss: 3316264.8056; train_gene_expr_recon_loss: 722364.3333; train_masked_gp_l1_reg_loss: 6577.8115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78550.1406; train_chrom_access_recon_loss: 1328699.8472; train_global_loss: 5462019.8333; train_optim_loss: 5462019.8333; val_kl_reg_loss: 8801.9746; val_edge_recon_loss: 3063085.7500; val_gene_expr_recon_loss: 754995.3750; val_masked_gp_l1_reg_loss: 6692.7324; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76612.2031; val_chrom_access_recon_loss: 1358592.5000; val_global_loss: 5268780.5000; val_optim_loss: 5268780.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8401; val_auprc_score: 0.8251; val_best_acc_score: 0.7476; val_best_f1_score: 0.7753; train_kl_reg_loss: 15319.4262; train_edge_recon_loss: 2999388.3889; train_gene_expr_recon_loss: 756596.7431; train_masked_gp_l1_reg_loss: 6812.8232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75127.4557; train_chrom_access_recon_loss: 1345923.3333; train_global_loss: 5199168.2222; train_optim_loss: 5199168.2222; val_kl_reg_loss: 24402.6621; val_edge_recon_loss: 2976344.0000; val_gene_expr_recon_loss: 744262.6250; val_masked_gp_l1_reg_loss: 6971.9897; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73302.6484; val_chrom_access_recon_loss: 1351951.6250; val_global_loss: 5177236.0000; val_optim_loss: 5177236.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8461; val_auprc_score: 0.8283; val_best_acc_score: 0.7563; val_best_f1_score: 0.7804; train_kl_reg_loss: 32076.7871; train_edge_recon_loss: 2913598.8056; train_gene_expr_recon_loss: 728895.9444; train_masked_gp_l1_reg_loss: 7062.6166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71899.0720; train_chrom_access_recon_loss: 1324395.5972; train_global_loss: 5077929.0000; train_optim_loss: 5077929.0000; val_kl_reg_loss: 38031.4688; val_edge_recon_loss: 2944653.0000; val_gene_expr_recon_loss: 730172.3750; val_masked_gp_l1_reg_loss: 7141.7573; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70175.0859; val_chrom_access_recon_loss: 1345055.8750; val_global_loss: 5135229.5000; val_optim_loss: 5135229.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8689; val_auprc_score: 0.8537; val_best_acc_score: 0.7785; val_best_f1_score: 0.7920; train_kl_reg_loss: 42293.8320; train_edge_recon_loss: 2879393.9722; train_gene_expr_recon_loss: 720005.0347; train_masked_gp_l1_reg_loss: 7165.4353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68841.5278; train_chrom_access_recon_loss: 1321320.6667; train_global_loss: 5039020.4444; train_optim_loss: 5039020.4444; val_kl_reg_loss: 46753.1602; val_edge_recon_loss: 2880670.5000; val_gene_expr_recon_loss: 723787.3125; val_masked_gp_l1_reg_loss: 7183.4238; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67204.4766; val_chrom_access_recon_loss: 1341140.1250; val_global_loss: 5066739.0000; val_optim_loss: 5066739.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8796; val_auprc_score: 0.8561; val_best_acc_score: 0.7858; val_best_f1_score: 0.8023; train_kl_reg_loss: 46771.9974; train_edge_recon_loss: 2862829.2222; train_gene_expr_recon_loss: 713903.9444; train_masked_gp_l1_reg_loss: 7211.3822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65939.6363; train_chrom_access_recon_loss: 1318801.7639; train_global_loss: 5015458.0556; train_optim_loss: 5015458.0556; val_kl_reg_loss: 43062.8906; val_edge_recon_loss: 2841237.2500; val_gene_expr_recon_loss: 719903.0000; val_masked_gp_l1_reg_loss: 7240.9199; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64378.2188; val_chrom_access_recon_loss: 1338797.0000; val_global_loss: 5014619.5000; val_optim_loss: 5014619.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9088; val_auprc_score: 0.8872; val_best_acc_score: 0.8252; val_best_f1_score: 0.8355; train_kl_reg_loss: 42251.3325; train_edge_recon_loss: 2822540.5833; train_gene_expr_recon_loss: 717040.3194; train_masked_gp_l1_reg_loss: 7253.5670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63175.6254; train_chrom_access_recon_loss: 1322231.9583; train_global_loss: 4974493.5556; train_optim_loss: 4974493.5556; val_kl_reg_loss: 39033.9336; val_edge_recon_loss: 2796297.7500; val_gene_expr_recon_loss: 716732.1250; val_masked_gp_l1_reg_loss: 7284.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61702.5977; val_chrom_access_recon_loss: 1336409.1250; val_global_loss: 4957460.0000; val_optim_loss: 4957460.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9178; val_auprc_score: 0.8937; val_best_acc_score: 0.8511; val_best_f1_score: 0.8601; train_kl_reg_loss: 39540.2396; train_edge_recon_loss: 2782572.5278; train_gene_expr_recon_loss: 712494.3056; train_masked_gp_l1_reg_loss: 7311.6947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60580.6437; train_chrom_access_recon_loss: 1314667.2639; train_global_loss: 4917166.5556; train_optim_loss: 4917166.5556; val_kl_reg_loss: 39944.5156; val_edge_recon_loss: 2799264.7500; val_gene_expr_recon_loss: 717097.5000; val_masked_gp_l1_reg_loss: 7321.2559; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59208.3672; val_chrom_access_recon_loss: 1334977.2500; val_global_loss: 4957813.5000; val_optim_loss: 4957813.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9307; val_auprc_score: 0.9120; val_best_acc_score: 0.8639; val_best_f1_score: 0.8707; train_kl_reg_loss: 41804.0065; train_edge_recon_loss: 2744111.0833; train_gene_expr_recon_loss: 712301.7431; train_masked_gp_l1_reg_loss: 7322.0627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58160.9297; train_chrom_access_recon_loss: 1309192.9028; train_global_loss: 4872892.8333; train_optim_loss: 4872892.8333; val_kl_reg_loss: 43444.3984; val_edge_recon_loss: 2742537.5000; val_gene_expr_recon_loss: 714426.4375; val_masked_gp_l1_reg_loss: 7332.3579; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56877.0469; val_chrom_access_recon_loss: 1332160.5000; val_global_loss: 4896778.0000; val_optim_loss: 4896778.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9317; val_auprc_score: 0.9121; val_best_acc_score: 0.8681; val_best_f1_score: 0.8759; train_kl_reg_loss: 44762.8220; train_edge_recon_loss: 2744226.3611; train_gene_expr_recon_loss: 706375.9375; train_masked_gp_l1_reg_loss: 7339.5705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55897.8003; train_chrom_access_recon_loss: 1310704.9028; train_global_loss: 4869307.4444; train_optim_loss: 4869307.4444; val_kl_reg_loss: 44953.0781; val_edge_recon_loss: 2755229.7500; val_gene_expr_recon_loss: 706266.5000; val_masked_gp_l1_reg_loss: 7348.8076; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54687.4219; val_chrom_access_recon_loss: 1329368.8750; val_global_loss: 4897854.5000; val_optim_loss: 4897854.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9311; val_auprc_score: 0.9085; val_best_acc_score: 0.8689; val_best_f1_score: 0.8755; train_kl_reg_loss: 45902.9640; train_edge_recon_loss: 2729573.9167; train_gene_expr_recon_loss: 702655.4306; train_masked_gp_l1_reg_loss: 7366.8421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53753.0768; train_chrom_access_recon_loss: 1309252.3472; train_global_loss: 4848504.5000; train_optim_loss: 4848504.5000; val_kl_reg_loss: 44692.4219; val_edge_recon_loss: 2745932.2500; val_gene_expr_recon_loss: 704766.1250; val_masked_gp_l1_reg_loss: 7379.0161; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52601.9883; val_chrom_access_recon_loss: 1326601.0000; val_global_loss: 4881973.0000; val_optim_loss: 4881973.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9376; val_auprc_score: 0.9217; val_best_acc_score: 0.8708; val_best_f1_score: 0.8789; train_kl_reg_loss: 44653.9340; train_edge_recon_loss: 2733423.1667; train_gene_expr_recon_loss: 699572.8125; train_masked_gp_l1_reg_loss: 7393.7055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51710.8003; train_chrom_access_recon_loss: 1307548.6111; train_global_loss: 4844303.0000; train_optim_loss: 4844303.0000; val_kl_reg_loss: 42299.6914; val_edge_recon_loss: 2741322.5000; val_gene_expr_recon_loss: 705271.5000; val_masked_gp_l1_reg_loss: 7409.4536; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50609.8125; val_chrom_access_recon_loss: 1325333.3750; val_global_loss: 4872246.5000; val_optim_loss: 4872246.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9376; val_auprc_score: 0.9195; val_best_acc_score: 0.8723; val_best_f1_score: 0.8806; train_kl_reg_loss: 42273.1806; train_edge_recon_loss: 2719703.4167; train_gene_expr_recon_loss: 698649.1250; train_masked_gp_l1_reg_loss: 7424.8512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49773.2292; train_chrom_access_recon_loss: 1302233.7917; train_global_loss: 4820057.6667; train_optim_loss: 4820057.6667; val_kl_reg_loss: 40683.8398; val_edge_recon_loss: 2751641.2500; val_gene_expr_recon_loss: 701724.4375; val_masked_gp_l1_reg_loss: 7439.5415; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48737.8203; val_chrom_access_recon_loss: 1322448.0000; val_global_loss: 4872675.0000; val_optim_loss: 4872675.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9388; val_auprc_score: 0.9222; val_best_acc_score: 0.8727; val_best_f1_score: 0.8795; train_kl_reg_loss: 41004.9453; train_edge_recon_loss: 2727605.0278; train_gene_expr_recon_loss: 696817.2500; train_masked_gp_l1_reg_loss: 7453.7365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47949.2496; train_chrom_access_recon_loss: 1300047.4861; train_global_loss: 4820877.7778; train_optim_loss: 4820877.7778; val_kl_reg_loss: 39900.5000; val_edge_recon_loss: 2749926.7500; val_gene_expr_recon_loss: 701141.5000; val_masked_gp_l1_reg_loss: 7474.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46970.8789; val_chrom_access_recon_loss: 1321086.0000; val_global_loss: 4866500.0000; val_optim_loss: 4866500.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9454; val_auprc_score: 0.9302; val_best_acc_score: 0.8824; val_best_f1_score: 0.8880; train_kl_reg_loss: 38887.5004; train_edge_recon_loss: 2722719.1667; train_gene_expr_recon_loss: 997172.7986; train_masked_gp_l1_reg_loss: 7518.0435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46069.3902; train_chrom_access_recon_loss: 1375185.3750; train_global_loss: 5187552.2778; train_optim_loss: 5187552.2778; val_kl_reg_loss: 16015.7832; val_edge_recon_loss: 2749529.7500; val_gene_expr_recon_loss: 991055.6250; val_masked_gp_l1_reg_loss: 7551.1543; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44864.1719; val_chrom_access_recon_loss: 1395780.1250; val_global_loss: 5204796.5000; val_optim_loss: 5204796.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9417; val_auprc_score: 0.9249; val_best_acc_score: 0.8800; val_best_f1_score: 0.8866; train_kl_reg_loss: 36038.7717; train_edge_recon_loss: 2721646.0556; train_gene_expr_recon_loss: 988384.2639; train_masked_gp_l1_reg_loss: 7597.1297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43851.0130; train_chrom_access_recon_loss: 1374703.1528; train_global_loss: 5172220.4444; train_optim_loss: 5172220.4444; val_kl_reg_loss: 15723.8662; val_edge_recon_loss: 2754146.2500; val_gene_expr_recon_loss: 991432.1250; val_masked_gp_l1_reg_loss: 7659.8677; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42587.0625; val_chrom_access_recon_loss: 1394325.0000; val_global_loss: 5205874.0000; val_optim_loss: 5205874.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9481; val_auprc_score: 0.9310; val_best_acc_score: 0.8911; val_best_f1_score: 0.8968; train_kl_reg_loss: 33320.8613; train_edge_recon_loss: 2705498.7222; train_gene_expr_recon_loss: 986173.0625; train_masked_gp_l1_reg_loss: 7710.0240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41601.3971; train_chrom_access_recon_loss: 1383270.2917; train_global_loss: 5157574.4444; train_optim_loss: 5157574.4444; val_kl_reg_loss: 15750.6484; val_edge_recon_loss: 2729286.0000; val_gene_expr_recon_loss: 988758.1250; val_masked_gp_l1_reg_loss: 7772.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40393.5586; val_chrom_access_recon_loss: 1393119.8750; val_global_loss: 5175081.5000; val_optim_loss: 5175081.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9530; val_auprc_score: 0.9378; val_best_acc_score: 0.8929; val_best_f1_score: 0.8975; train_kl_reg_loss: 30412.2313; train_edge_recon_loss: 2700559.8056; train_gene_expr_recon_loss: 983266.5694; train_masked_gp_l1_reg_loss: 7823.9697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39470.5451; train_chrom_access_recon_loss: 1371260.7778; train_global_loss: 5132793.8889; train_optim_loss: 5132793.8889; val_kl_reg_loss: 15235.9814; val_edge_recon_loss: 2737832.7500; val_gene_expr_recon_loss: 986336.3125; val_masked_gp_l1_reg_loss: 7884.3096; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38346.6250; val_chrom_access_recon_loss: 1392000.0000; val_global_loss: 5177636.0000; val_optim_loss: 5177636.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9527; val_auprc_score: 0.9358; val_best_acc_score: 0.8976; val_best_f1_score: 0.9018; train_kl_reg_loss: 29430.8218; train_edge_recon_loss: 2683929.1389; train_gene_expr_recon_loss: 978173.3819; train_masked_gp_l1_reg_loss: 7859.0034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38226.0977; train_chrom_access_recon_loss: 1373805.5833; train_global_loss: 5111424.0556; train_optim_loss: 5111424.0556; val_kl_reg_loss: 15414.1475; val_edge_recon_loss: 2700827.0000; val_gene_expr_recon_loss: 984678.4375; val_masked_gp_l1_reg_loss: 7835.1265; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38078.6484; val_chrom_access_recon_loss: 1391329.1250; val_global_loss: 5138163.0000; val_optim_loss: 5138163.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9533; val_auprc_score: 0.9368; val_best_acc_score: 0.8945; val_best_f1_score: 0.8990; train_kl_reg_loss: 29337.1855; train_edge_recon_loss: 2703644.4167; train_gene_expr_recon_loss: 977649.9514; train_masked_gp_l1_reg_loss: 7831.6257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37971.9870; train_chrom_access_recon_loss: 1365188.8611; train_global_loss: 5121624.0000; train_optim_loss: 5121624.0000; val_kl_reg_loss: 15405.8457; val_edge_recon_loss: 2712641.0000; val_gene_expr_recon_loss: 982850.1250; val_masked_gp_l1_reg_loss: 7824.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37838.2188; val_chrom_access_recon_loss: 1390318.1250; val_global_loss: 5146878.5000; val_optim_loss: 5146878.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9523; val_auprc_score: 0.9386; val_best_acc_score: 0.8929; val_best_f1_score: 0.8972; train_kl_reg_loss: 28905.0666; train_edge_recon_loss: 2699217.3056; train_gene_expr_recon_loss: 975991.4236; train_masked_gp_l1_reg_loss: 7822.4627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37736.4648; train_chrom_access_recon_loss: 1365203.5833; train_global_loss: 5114876.4444; train_optim_loss: 5114876.4444; val_kl_reg_loss: 15342.2627; val_edge_recon_loss: 2714726.2500; val_gene_expr_recon_loss: 982609.4375; val_masked_gp_l1_reg_loss: 7820.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37610.8984; val_chrom_access_recon_loss: 1390354.3750; val_global_loss: 5148463.5000; val_optim_loss: 5148463.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9530; val_auprc_score: 0.9372; val_best_acc_score: 0.8945; val_best_f1_score: 0.8995; train_kl_reg_loss: 28648.4444; train_edge_recon_loss: 2703745.1944; train_gene_expr_recon_loss: 980235.3819; train_masked_gp_l1_reg_loss: 7820.0812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37512.9922; train_chrom_access_recon_loss: 1361838.5139; train_global_loss: 5119800.6111; train_optim_loss: 5119800.6111; val_kl_reg_loss: 15218.0332; val_edge_recon_loss: 2719872.0000; val_gene_expr_recon_loss: 983431.0000; val_masked_gp_l1_reg_loss: 7821.0493; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37393.9414; val_chrom_access_recon_loss: 1390694.8750; val_global_loss: 5154431.0000; val_optim_loss: 5154431.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9457
val AUPRC score: 0.9294
val best accuracy score: 0.8801
val best F1 score: 0.8872
val target rna MSE score: 3.9280
val source rna MSE score: 3.3155
val target atac MSE score: 0.1353
val source atac MSE score: 0.0218
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
