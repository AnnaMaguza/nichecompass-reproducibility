[True]
Run timestamp: 10102023_004239_90.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_90']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7735; val_auprc_score: 0.7928; val_best_acc_score: 0.5404; val_best_f1_score: 0.6830; train_kl_reg_loss: 63138.1737; train_edge_recon_loss: 3506410.9008; train_gene_expr_recon_loss: 13394946.1985; train_masked_gp_l1_reg_loss: 117737.7668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2701763.6839; train_chrom_access_recon_loss: 2855797.6336; train_global_loss: 22639794.2290; train_optim_loss: 22639794.2290; val_kl_reg_loss: 100789.7510; val_edge_recon_loss: 4062911.3167; val_gene_expr_recon_loss: 12713450.3333; val_masked_gp_l1_reg_loss: 102626.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 379919.9688; val_chrom_access_recon_loss: 2783604.1167; val_global_loss: 20143301.6000; val_optim_loss: 20143301.6000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8227; val_auprc_score: 0.8366; val_best_acc_score: 0.7188; val_best_f1_score: 0.7463; train_kl_reg_loss: 81740.0522; train_edge_recon_loss: 3499810.6107; train_gene_expr_recon_loss: 12594090.4046; train_masked_gp_l1_reg_loss: 101194.7701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 212448.8421; train_chrom_access_recon_loss: 2743454.9790; train_global_loss: 19232739.7099; train_optim_loss: 19232739.7099; val_kl_reg_loss: 64909.4490; val_edge_recon_loss: 3892477.3333; val_gene_expr_recon_loss: 12565517.2667; val_masked_gp_l1_reg_loss: 102344.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138389.0000; val_chrom_access_recon_loss: 2752558.2500; val_global_loss: 19516195.8667; val_optim_loss: 19516195.8667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8518; val_auprc_score: 0.8571; val_best_acc_score: 0.7577; val_best_f1_score: 0.7694; train_kl_reg_loss: 74265.4450; train_edge_recon_loss: 3166708.1641; train_gene_expr_recon_loss: 12473320.1450; train_masked_gp_l1_reg_loss: 108574.0841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116130.3079; train_chrom_access_recon_loss: 2715848.1947; train_global_loss: 18654846.3511; train_optim_loss: 18654846.3511; val_kl_reg_loss: 85167.6104; val_edge_recon_loss: 3040170.5167; val_gene_expr_recon_loss: 12464371.4667; val_masked_gp_l1_reg_loss: 114464.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102271.9453; val_chrom_access_recon_loss: 2734651.2667; val_global_loss: 18541098.0000; val_optim_loss: 18541098.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9160; val_auprc_score: 0.9000; val_best_acc_score: 0.8444; val_best_f1_score: 0.8569; train_kl_reg_loss: 86223.0365; train_edge_recon_loss: 2904401.1202; train_gene_expr_recon_loss: 12337054.3130; train_masked_gp_l1_reg_loss: 121181.5609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98922.7515; train_chrom_access_recon_loss: 2690298.7920; train_global_loss: 18238081.6336; train_optim_loss: 18238081.6336; val_kl_reg_loss: 91846.0557; val_edge_recon_loss: 2865144.0833; val_gene_expr_recon_loss: 12227495.2000; val_masked_gp_l1_reg_loss: 125313.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95849.2109; val_chrom_access_recon_loss: 2690646.0667; val_global_loss: 18096293.2000; val_optim_loss: 18096293.2000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9264; val_auprc_score: 0.9136; val_best_acc_score: 0.8589; val_best_f1_score: 0.8678; train_kl_reg_loss: 95708.7325; train_edge_recon_loss: 2831690.8550; train_gene_expr_recon_loss: 12194714.2901; train_masked_gp_l1_reg_loss: 125289.7630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90992.9681; train_chrom_access_recon_loss: 2665589.3435; train_global_loss: 18003985.9542; train_optim_loss: 18003985.9542; val_kl_reg_loss: 95872.8870; val_edge_recon_loss: 2818716.1333; val_gene_expr_recon_loss: 12169640.2667; val_masked_gp_l1_reg_loss: 125356.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87262.8438; val_chrom_access_recon_loss: 2678870.1333; val_global_loss: 17975718.4000; val_optim_loss: 17975718.4000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9321; val_auprc_score: 0.9194; val_best_acc_score: 0.8662; val_best_f1_score: 0.8746; train_kl_reg_loss: 98057.5988; train_edge_recon_loss: 2808180.3034; train_gene_expr_recon_loss: 12106745.3664; train_masked_gp_l1_reg_loss: 125070.2227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85021.6573; train_chrom_access_recon_loss: 2644784.9752; train_global_loss: 17867860.1145; train_optim_loss: 17867860.1145; val_kl_reg_loss: 96324.2323; val_edge_recon_loss: 2815787.4833; val_gene_expr_recon_loss: 12097100.9333; val_masked_gp_l1_reg_loss: 124644.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83481.1406; val_chrom_access_recon_loss: 2652698.9333; val_global_loss: 17870036.9333; val_optim_loss: 17870036.9333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9351; val_auprc_score: 0.9236; val_best_acc_score: 0.8689; val_best_f1_score: 0.8764; train_kl_reg_loss: 95339.7814; train_edge_recon_loss: 2805397.4370; train_gene_expr_recon_loss: 12017225.8015; train_masked_gp_l1_reg_loss: 124886.4655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83481.0818; train_chrom_access_recon_loss: 2626344.7366; train_global_loss: 17752675.2366; train_optim_loss: 17752675.2366; val_kl_reg_loss: 90299.4875; val_edge_recon_loss: 2810902.4667; val_gene_expr_recon_loss: 11993439.0667; val_masked_gp_l1_reg_loss: 124984.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84696.5000; val_chrom_access_recon_loss: 2646518.8167; val_global_loss: 17750840.2667; val_optim_loss: 17750840.2667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9373; val_auprc_score: 0.9245; val_best_acc_score: 0.8752; val_best_f1_score: 0.8816; train_kl_reg_loss: 93589.4594; train_edge_recon_loss: 2789591.6756; train_gene_expr_recon_loss: 11923510.4885; train_masked_gp_l1_reg_loss: 124882.5708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83310.0156; train_chrom_access_recon_loss: 2610034.0840; train_global_loss: 17624918.3206; train_optim_loss: 17624918.3206; val_kl_reg_loss: 91293.9573; val_edge_recon_loss: 2821808.1500; val_gene_expr_recon_loss: 11948993.2000; val_masked_gp_l1_reg_loss: 125159.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83302.9922; val_chrom_access_recon_loss: 2633238.9500; val_global_loss: 17703797.2000; val_optim_loss: 17703797.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9401; val_auprc_score: 0.9274; val_best_acc_score: 0.8794; val_best_f1_score: 0.8843; train_kl_reg_loss: 91412.2790; train_edge_recon_loss: 2779444.6221; train_gene_expr_recon_loss: 11860898.5115; train_masked_gp_l1_reg_loss: 125313.1663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82027.6994; train_chrom_access_recon_loss: 2598251.6011; train_global_loss: 17537348.0534; train_optim_loss: 17537348.0534; val_kl_reg_loss: 91889.2385; val_edge_recon_loss: 2804305.8833; val_gene_expr_recon_loss: 11875470.2000; val_masked_gp_l1_reg_loss: 125584.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81610.3516; val_chrom_access_recon_loss: 2610756.0000; val_global_loss: 17589616.1333; val_optim_loss: 17589616.1333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9419; val_auprc_score: 0.9293; val_best_acc_score: 0.8804; val_best_f1_score: 0.8876; train_kl_reg_loss: 89026.5462; train_edge_recon_loss: 2776835.0840; train_gene_expr_recon_loss: 11804899.1145; train_masked_gp_l1_reg_loss: 125700.7492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80261.1686; train_chrom_access_recon_loss: 2583753.2958; train_global_loss: 17460475.9466; train_optim_loss: 17460475.9466; val_kl_reg_loss: 91774.1776; val_edge_recon_loss: 2775802.0833; val_gene_expr_recon_loss: 11770537.2000; val_masked_gp_l1_reg_loss: 126160.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79064.8750; val_chrom_access_recon_loss: 2605191.0333; val_global_loss: 17448529.3333; val_optim_loss: 17448529.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9434; val_auprc_score: 0.9302; val_best_acc_score: 0.8809; val_best_f1_score: 0.8850; train_kl_reg_loss: 89972.5113; train_edge_recon_loss: 2773144.7271; train_gene_expr_recon_loss: 11751570.3130; train_masked_gp_l1_reg_loss: 126278.1960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78062.3826; train_chrom_access_recon_loss: 2573060.2958; train_global_loss: 17392088.4427; train_optim_loss: 17392088.4427; val_kl_reg_loss: 87976.7443; val_edge_recon_loss: 2794658.7500; val_gene_expr_recon_loss: 11731130.4000; val_masked_gp_l1_reg_loss: 126469.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77445.9062; val_chrom_access_recon_loss: 2604509.4167; val_global_loss: 17422191.2000; val_optim_loss: 17422191.2000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9482; val_auprc_score: 0.9373; val_best_acc_score: 0.8832; val_best_f1_score: 0.8896; train_kl_reg_loss: 88712.9981; train_edge_recon_loss: 2762651.3302; train_gene_expr_recon_loss: 11702176.6718; train_masked_gp_l1_reg_loss: 126591.7239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76761.4832; train_chrom_access_recon_loss: 2564493.4008; train_global_loss: 17321387.5954; train_optim_loss: 17321387.5954; val_kl_reg_loss: 86821.7396; val_edge_recon_loss: 2763146.4333; val_gene_expr_recon_loss: 11743350.0000; val_masked_gp_l1_reg_loss: 126820.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75894.5625; val_chrom_access_recon_loss: 2583258.2000; val_global_loss: 17379292.6000; val_optim_loss: 17379292.6000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9533; val_auprc_score: 0.9429; val_best_acc_score: 0.8967; val_best_f1_score: 0.9006; train_kl_reg_loss: 87466.6319; train_edge_recon_loss: 2755182.7176; train_gene_expr_recon_loss: 11669540.5573; train_masked_gp_l1_reg_loss: 127056.0701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75591.4441; train_chrom_access_recon_loss: 2556771.7958; train_global_loss: 17271609.2824; train_optim_loss: 17271609.2824; val_kl_reg_loss: 82865.7964; val_edge_recon_loss: 2751796.3500; val_gene_expr_recon_loss: 11634043.4000; val_masked_gp_l1_reg_loss: 126992.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74966.7969; val_chrom_access_recon_loss: 2568247.1500; val_global_loss: 17238912.8000; val_optim_loss: 17238912.8000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9511; val_auprc_score: 0.9406; val_best_acc_score: 0.8890; val_best_f1_score: 0.8947; train_kl_reg_loss: 87284.9181; train_edge_recon_loss: 2741679.6489; train_gene_expr_recon_loss: 11615882.4275; train_masked_gp_l1_reg_loss: 127135.1705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74728.4887; train_chrom_access_recon_loss: 2543146.4885; train_global_loss: 17189857.1145; train_optim_loss: 17189857.1145; val_kl_reg_loss: 86600.0839; val_edge_recon_loss: 2761607.9333; val_gene_expr_recon_loss: 11646556.1333; val_masked_gp_l1_reg_loss: 127168.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74078.6406; val_chrom_access_recon_loss: 2554452.5833; val_global_loss: 17250464.0000; val_optim_loss: 17250464.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9517; val_auprc_score: 0.9425; val_best_acc_score: 0.8936; val_best_f1_score: 0.8979; train_kl_reg_loss: 87527.4977; train_edge_recon_loss: 2734057.4542; train_gene_expr_recon_loss: 11590634.0229; train_masked_gp_l1_reg_loss: 127366.1214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73810.8283; train_chrom_access_recon_loss: 2537661.8416; train_global_loss: 17151057.7786; train_optim_loss: 17151057.7786; val_kl_reg_loss: 87986.0495; val_edge_recon_loss: 2760217.4000; val_gene_expr_recon_loss: 11584916.2667; val_masked_gp_l1_reg_loss: 127546.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74179.9609; val_chrom_access_recon_loss: 2568169.1833; val_global_loss: 17203015.0000; val_optim_loss: 17203015.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9573; val_auprc_score: 0.9478; val_best_acc_score: 0.8984; val_best_f1_score: 0.9029; train_kl_reg_loss: 85349.2125; train_edge_recon_loss: 2729945.9122; train_gene_expr_recon_loss: 11553132.2748; train_masked_gp_l1_reg_loss: 127387.0400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73869.2803; train_chrom_access_recon_loss: 2526996.1832; train_global_loss: 17096679.9847; train_optim_loss: 17096679.9847; val_kl_reg_loss: 86001.8359; val_edge_recon_loss: 2726839.9667; val_gene_expr_recon_loss: 11561742.1333; val_masked_gp_l1_reg_loss: 127705.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74084.6875; val_chrom_access_recon_loss: 2542013.7167; val_global_loss: 17118387.7333; val_optim_loss: 17118387.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9578; val_auprc_score: 0.9494; val_best_acc_score: 0.8930; val_best_f1_score: 0.8971; train_kl_reg_loss: 84688.7549; train_edge_recon_loss: 2732029.7786; train_gene_expr_recon_loss: 11523989.7557; train_masked_gp_l1_reg_loss: 127391.7657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74340.2793; train_chrom_access_recon_loss: 2521187.5363; train_global_loss: 17063627.8779; train_optim_loss: 17063627.8779; val_kl_reg_loss: 85535.8323; val_edge_recon_loss: 2735349.4333; val_gene_expr_recon_loss: 11560822.4667; val_masked_gp_l1_reg_loss: 127658.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75336.7500; val_chrom_access_recon_loss: 2549761.3000; val_global_loss: 17134464.0000; val_optim_loss: 17134464.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9574; val_auprc_score: 0.9467; val_best_acc_score: 0.8965; val_best_f1_score: 0.9000; train_kl_reg_loss: 85393.2919; train_edge_recon_loss: 2718872.3588; train_gene_expr_recon_loss: 11496099.2748; train_masked_gp_l1_reg_loss: 127476.3325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75028.3074; train_chrom_access_recon_loss: 2514915.0534; train_global_loss: 17017784.5267; train_optim_loss: 17017784.5267; val_kl_reg_loss: 83013.5875; val_edge_recon_loss: 2748305.8333; val_gene_expr_recon_loss: 11493735.9333; val_masked_gp_l1_reg_loss: 127419.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75741.6328; val_chrom_access_recon_loss: 2538503.0333; val_global_loss: 17066720.1333; val_optim_loss: 17066720.1333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9632; val_auprc_score: 0.9546; val_best_acc_score: 0.9042; val_best_f1_score: 0.9057; train_kl_reg_loss: 84378.9135; train_edge_recon_loss: 2719479.9924; train_gene_expr_recon_loss: 11474781.7634; train_masked_gp_l1_reg_loss: 127211.9906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76182.7245; train_chrom_access_recon_loss: 2511409.2634; train_global_loss: 16993444.7786; train_optim_loss: 16993444.7786; val_kl_reg_loss: 83359.9078; val_edge_recon_loss: 2724025.5167; val_gene_expr_recon_loss: 11471713.0000; val_masked_gp_l1_reg_loss: 126899.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76010.7344; val_chrom_access_recon_loss: 2523853.7500; val_global_loss: 17005863.2000; val_optim_loss: 17005863.2000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9646; val_auprc_score: 0.9542; val_best_acc_score: 0.9081; val_best_f1_score: 0.9115; train_kl_reg_loss: 84192.9607; train_edge_recon_loss: 2708492.8187; train_gene_expr_recon_loss: 11444202.4885; train_masked_gp_l1_reg_loss: 126755.5958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76793.4800; train_chrom_access_recon_loss: 2506181.0515; train_global_loss: 16946618.3130; train_optim_loss: 16946618.3130; val_kl_reg_loss: 85305.2604; val_edge_recon_loss: 2723422.0000; val_gene_expr_recon_loss: 11453785.8667; val_masked_gp_l1_reg_loss: 126818.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77765.7109; val_chrom_access_recon_loss: 2523721.2000; val_global_loss: 16990819.6667; val_optim_loss: 16990819.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9657; val_auprc_score: 0.9571; val_best_acc_score: 0.9136; val_best_f1_score: 0.9157; train_kl_reg_loss: 83506.8779; train_edge_recon_loss: 2713267.9790; train_gene_expr_recon_loss: 11437224.2824; train_masked_gp_l1_reg_loss: 126297.4490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77461.3748; train_chrom_access_recon_loss: 2503243.0649; train_global_loss: 16941001.1221; train_optim_loss: 16941001.1221; val_kl_reg_loss: 85937.2214; val_edge_recon_loss: 2706014.3500; val_gene_expr_recon_loss: 11473184.9333; val_masked_gp_l1_reg_loss: 126182.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77774.2734; val_chrom_access_recon_loss: 2527891.2167; val_global_loss: 16996984.0000; val_optim_loss: 16996984.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9673; val_auprc_score: 0.9582; val_best_acc_score: 0.9113; val_best_f1_score: 0.9153; train_kl_reg_loss: 82995.2246; train_edge_recon_loss: 2707109.0630; train_gene_expr_recon_loss: 11397548.5420; train_masked_gp_l1_reg_loss: 125859.7975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77521.9104; train_chrom_access_recon_loss: 2492093.2748; train_global_loss: 16883127.8244; train_optim_loss: 16883127.8244; val_kl_reg_loss: 81775.9635; val_edge_recon_loss: 2702124.2000; val_gene_expr_recon_loss: 11393433.8667; val_masked_gp_l1_reg_loss: 125434.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77821.4297; val_chrom_access_recon_loss: 2507684.6000; val_global_loss: 16888273.2667; val_optim_loss: 16888273.2667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9672; val_auprc_score: 0.9567; val_best_acc_score: 0.9157; val_best_f1_score: 0.9174; train_kl_reg_loss: 83364.8812; train_edge_recon_loss: 2702400.9122; train_gene_expr_recon_loss: 11390183.3053; train_masked_gp_l1_reg_loss: 125113.0773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77607.1605; train_chrom_access_recon_loss: 2487886.8168; train_global_loss: 16866556.2443; train_optim_loss: 16866556.2443; val_kl_reg_loss: 82620.9641; val_edge_recon_loss: 2719817.3333; val_gene_expr_recon_loss: 11370206.0667; val_masked_gp_l1_reg_loss: 125069.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77662.1719; val_chrom_access_recon_loss: 2515062.4000; val_global_loss: 16890438.0000; val_optim_loss: 16890438.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9690; val_auprc_score: 0.9611; val_best_acc_score: 0.9196; val_best_f1_score: 0.9220; train_kl_reg_loss: 82603.3163; train_edge_recon_loss: 2705787.3798; train_gene_expr_recon_loss: 11376246.0153; train_masked_gp_l1_reg_loss: 124592.2808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77631.2583; train_chrom_access_recon_loss: 2484297.7786; train_global_loss: 16851158.0382; train_optim_loss: 16851158.0382; val_kl_reg_loss: 82140.7531; val_edge_recon_loss: 2695540.2667; val_gene_expr_recon_loss: 11395739.2667; val_masked_gp_l1_reg_loss: 124390.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77776.2656; val_chrom_access_recon_loss: 2512870.8833; val_global_loss: 16888457.8667; val_optim_loss: 16888457.8667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9638; val_auprc_score: 0.9534; val_best_acc_score: 0.9104; val_best_f1_score: 0.9138; train_kl_reg_loss: 81094.5464; train_edge_recon_loss: 2692207.2347; train_gene_expr_recon_loss: 11362774.0534; train_masked_gp_l1_reg_loss: 124114.0663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77668.6036; train_chrom_access_recon_loss: 2483276.7958; train_global_loss: 16821135.2366; train_optim_loss: 16821135.2366; val_kl_reg_loss: 82439.5740; val_edge_recon_loss: 2721950.8167; val_gene_expr_recon_loss: 11416009.0667; val_masked_gp_l1_reg_loss: 124213.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77355.9531; val_chrom_access_recon_loss: 2497627.0000; val_global_loss: 16919596.3333; val_optim_loss: 16919596.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9692; val_auprc_score: 0.9612; val_best_acc_score: 0.9189; val_best_f1_score: 0.9221; train_kl_reg_loss: 80442.9742; train_edge_recon_loss: 2708905.3416; train_gene_expr_recon_loss: 11349917.1298; train_masked_gp_l1_reg_loss: 123582.5713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77778.0500; train_chrom_access_recon_loss: 2479155.5821; train_global_loss: 16819781.7099; train_optim_loss: 16819781.7099; val_kl_reg_loss: 82961.2828; val_edge_recon_loss: 2694425.9500; val_gene_expr_recon_loss: 11359196.9333; val_masked_gp_l1_reg_loss: 123491.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77570.4922; val_chrom_access_recon_loss: 2497086.5000; val_global_loss: 16834731.7333; val_optim_loss: 16834731.7333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9710; val_auprc_score: 0.9643; val_best_acc_score: 0.9206; val_best_f1_score: 0.9229; train_kl_reg_loss: 81132.9478; train_edge_recon_loss: 2700262.2118; train_gene_expr_recon_loss: 11335422.6794; train_masked_gp_l1_reg_loss: 122889.6772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77728.4151; train_chrom_access_recon_loss: 2471458.0668; train_global_loss: 16788894.1450; train_optim_loss: 16788894.1450; val_kl_reg_loss: 81494.4135; val_edge_recon_loss: 2709894.4333; val_gene_expr_recon_loss: 11388151.9333; val_masked_gp_l1_reg_loss: 122743.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77678.8047; val_chrom_access_recon_loss: 2514925.2833; val_global_loss: 16894889.2000; val_optim_loss: 16894889.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9689; val_auprc_score: 0.9634; val_best_acc_score: 0.9159; val_best_f1_score: 0.9186; train_kl_reg_loss: 80036.2918; train_edge_recon_loss: 2700274.2176; train_gene_expr_recon_loss: 11322341.4962; train_masked_gp_l1_reg_loss: 122388.1984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77611.5815; train_chrom_access_recon_loss: 2467784.6641; train_global_loss: 16770436.4198; train_optim_loss: 16770436.4198; val_kl_reg_loss: 82725.5375; val_edge_recon_loss: 2724060.8167; val_gene_expr_recon_loss: 11332441.0667; val_masked_gp_l1_reg_loss: 122278.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77913.5312; val_chrom_access_recon_loss: 2494203.0833; val_global_loss: 16833623.4000; val_optim_loss: 16833623.4000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9722; val_auprc_score: 0.9650; val_best_acc_score: 0.9208; val_best_f1_score: 0.9232; train_kl_reg_loss: 81055.1464; train_edge_recon_loss: 2694858.2767; train_gene_expr_recon_loss: 11308591.9389; train_masked_gp_l1_reg_loss: 121775.4507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77733.4982; train_chrom_access_recon_loss: 2466006.9256; train_global_loss: 16750021.3664; train_optim_loss: 16750021.3664; val_kl_reg_loss: 79885.0661; val_edge_recon_loss: 2703244.4000; val_gene_expr_recon_loss: 11351265.9333; val_masked_gp_l1_reg_loss: 121537.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77499.2344; val_chrom_access_recon_loss: 2495745.6667; val_global_loss: 16829177.0000; val_optim_loss: 16829177.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9737; val_auprc_score: 0.9656; val_best_acc_score: 0.9252; val_best_f1_score: 0.9271; train_kl_reg_loss: 79968.8238; train_edge_recon_loss: 2702941.0382; train_gene_expr_recon_loss: 11307019.2977; train_masked_gp_l1_reg_loss: 121226.4465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77712.8652; train_chrom_access_recon_loss: 2463552.1794; train_global_loss: 16752420.5344; train_optim_loss: 16752420.5344; val_kl_reg_loss: 80318.1484; val_edge_recon_loss: 2698811.1000; val_gene_expr_recon_loss: 11312810.9333; val_masked_gp_l1_reg_loss: 121142.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77889.1172; val_chrom_access_recon_loss: 2488765.3333; val_global_loss: 16779736.2667; val_optim_loss: 16779736.2667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9728; val_auprc_score: 0.9639; val_best_acc_score: 0.9233; val_best_f1_score: 0.9253; train_kl_reg_loss: 78149.4921; train_edge_recon_loss: 2699905.3702; train_gene_expr_recon_loss: 11293779.8550; train_masked_gp_l1_reg_loss: 120986.2623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78118.1769; train_chrom_access_recon_loss: 2460643.4618; train_global_loss: 16731582.6412; train_optim_loss: 16731582.6412; val_kl_reg_loss: 80561.6234; val_edge_recon_loss: 2694189.1667; val_gene_expr_recon_loss: 11291815.6667; val_masked_gp_l1_reg_loss: 121082.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78403.1172; val_chrom_access_recon_loss: 2478151.0667; val_global_loss: 16744203.4667; val_optim_loss: 16744203.4667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9742; val_auprc_score: 0.9683; val_best_acc_score: 0.9268; val_best_f1_score: 0.9292; train_kl_reg_loss: 81005.7341; train_edge_recon_loss: 2687139.9580; train_gene_expr_recon_loss: 11274994.6947; train_masked_gp_l1_reg_loss: 120534.2235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78317.2186; train_chrom_access_recon_loss: 2455647.0401; train_global_loss: 16697638.9084; train_optim_loss: 16697638.9084; val_kl_reg_loss: 82121.0385; val_edge_recon_loss: 2709673.1833; val_gene_expr_recon_loss: 11361026.8000; val_masked_gp_l1_reg_loss: 120420.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78959.1562; val_chrom_access_recon_loss: 2487334.8167; val_global_loss: 16839535.0000; val_optim_loss: 16839535.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9747; val_auprc_score: 0.9680; val_best_acc_score: 0.9283; val_best_f1_score: 0.9310; train_kl_reg_loss: 80134.4074; train_edge_recon_loss: 2685374.7385; train_gene_expr_recon_loss: 11270486.8168; train_masked_gp_l1_reg_loss: 119727.4316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78593.6956; train_chrom_access_recon_loss: 2450524.5115; train_global_loss: 16684841.5038; train_optim_loss: 16684841.5038; val_kl_reg_loss: 80210.8542; val_edge_recon_loss: 2692220.6167; val_gene_expr_recon_loss: 11348387.4667; val_masked_gp_l1_reg_loss: 119568.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78363.1562; val_chrom_access_recon_loss: 2485735.3333; val_global_loss: 16804485.0667; val_optim_loss: 16804485.0667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9736; val_auprc_score: 0.9668; val_best_acc_score: 0.9221; val_best_f1_score: 0.9254; train_kl_reg_loss: 79732.4384; train_edge_recon_loss: 2681254.9618; train_gene_expr_recon_loss: 11262623.5038; train_masked_gp_l1_reg_loss: 119301.3499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78660.2734; train_chrom_access_recon_loss: 2449277.9905; train_global_loss: 16670850.5573; train_optim_loss: 16670850.5573; val_kl_reg_loss: 76526.1344; val_edge_recon_loss: 2715553.1333; val_gene_expr_recon_loss: 11306193.9333; val_masked_gp_l1_reg_loss: 119149.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78542.9062; val_chrom_access_recon_loss: 2475252.9833; val_global_loss: 16771219.3333; val_optim_loss: 16771219.3333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9757; val_auprc_score: 0.9671; val_best_acc_score: 0.9310; val_best_f1_score: 0.9335; train_kl_reg_loss: 77802.9905; train_edge_recon_loss: 2690983.7786; train_gene_expr_recon_loss: 11260035.3664; train_masked_gp_l1_reg_loss: 119157.9594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79022.0230; train_chrom_access_recon_loss: 2445362.6813; train_global_loss: 16672364.8931; train_optim_loss: 16672364.8931; val_kl_reg_loss: 79534.7000; val_edge_recon_loss: 2708371.0167; val_gene_expr_recon_loss: 11297061.0667; val_masked_gp_l1_reg_loss: 119071.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79377.5859; val_chrom_access_recon_loss: 2473958.6500; val_global_loss: 16757374.2667; val_optim_loss: 16757374.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9751; val_auprc_score: 0.9682; val_best_acc_score: 0.9318; val_best_f1_score: 0.9337; train_kl_reg_loss: 79675.9883; train_edge_recon_loss: 2684930.3034; train_gene_expr_recon_loss: 11238355.1145; train_masked_gp_l1_reg_loss: 113091.4534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60631.7107; train_chrom_access_recon_loss: 2438404.1832; train_global_loss: 16615088.6947; train_optim_loss: 16615088.6947; val_kl_reg_loss: 82530.4151; val_edge_recon_loss: 2706845.6833; val_gene_expr_recon_loss: 11275882.9333; val_masked_gp_l1_reg_loss: 111747.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57998.6367; val_chrom_access_recon_loss: 2478623.3833; val_global_loss: 16713629.0667; val_optim_loss: 16713629.0667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9760; val_auprc_score: 0.9672; val_best_acc_score: 0.9321; val_best_f1_score: 0.9345; train_kl_reg_loss: 81731.6045; train_edge_recon_loss: 2681271.9523; train_gene_expr_recon_loss: 11238020.8855; train_masked_gp_l1_reg_loss: 111613.4865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57592.3022; train_chrom_access_recon_loss: 2437031.5458; train_global_loss: 16607261.7405; train_optim_loss: 16607261.7405; val_kl_reg_loss: 82711.6823; val_edge_recon_loss: 2684715.6500; val_gene_expr_recon_loss: 11273285.0667; val_masked_gp_l1_reg_loss: 111461.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57246.5586; val_chrom_access_recon_loss: 2470230.5000; val_global_loss: 16679652.2000; val_optim_loss: 16679652.2000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9749; val_auprc_score: 0.9692; val_best_acc_score: 0.9282; val_best_f1_score: 0.9310; train_kl_reg_loss: 82222.1644; train_edge_recon_loss: 2682097.1031; train_gene_expr_recon_loss: 11233602.0458; train_masked_gp_l1_reg_loss: 111383.3062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57045.0980; train_chrom_access_recon_loss: 2434438.4370; train_global_loss: 16600788.1908; train_optim_loss: 16600788.1908; val_kl_reg_loss: 83558.7906; val_edge_recon_loss: 2699958.1667; val_gene_expr_recon_loss: 11245825.5333; val_masked_gp_l1_reg_loss: 111342.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56836.0781; val_chrom_access_recon_loss: 2451358.1000; val_global_loss: 16648878.4000; val_optim_loss: 16648878.4000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9775; val_auprc_score: 0.9713; val_best_acc_score: 0.9336; val_best_f1_score: 0.9356; train_kl_reg_loss: 82368.9262; train_edge_recon_loss: 2682833.1737; train_gene_expr_recon_loss: 11233077.6565; train_masked_gp_l1_reg_loss: 111279.4477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56718.7153; train_chrom_access_recon_loss: 2435815.2901; train_global_loss: 16602093.2137; train_optim_loss: 16602093.2137; val_kl_reg_loss: 82583.1339; val_edge_recon_loss: 2701544.2000; val_gene_expr_recon_loss: 11254618.8000; val_masked_gp_l1_reg_loss: 111229.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56534.9141; val_chrom_access_recon_loss: 2461709.3500; val_global_loss: 16668220.3333; val_optim_loss: 16668220.3333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9762; val_auprc_score: 0.9687; val_best_acc_score: 0.9297; val_best_f1_score: 0.9322; train_kl_reg_loss: 82730.5237; train_edge_recon_loss: 2680427.9962; train_gene_expr_recon_loss: 11229688.8855; train_masked_gp_l1_reg_loss: 111146.8962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56326.7594; train_chrom_access_recon_loss: 2435417.7366; train_global_loss: 16595738.7176; train_optim_loss: 16595738.7176; val_kl_reg_loss: 83835.3750; val_edge_recon_loss: 2692727.9167; val_gene_expr_recon_loss: 11274193.0667; val_masked_gp_l1_reg_loss: 111104.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56263.4805; val_chrom_access_recon_loss: 2465388.2833; val_global_loss: 16683512.5333; val_optim_loss: 16683512.5333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9773; val_auprc_score: 0.9709; val_best_acc_score: 0.9344; val_best_f1_score: 0.9364; train_kl_reg_loss: 82632.4789; train_edge_recon_loss: 2681392.6107; train_gene_expr_recon_loss: 11235137.3511; train_masked_gp_l1_reg_loss: 111010.8686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56128.0099; train_chrom_access_recon_loss: 2434095.3492; train_global_loss: 16600396.6794; train_optim_loss: 16600396.6794; val_kl_reg_loss: 83514.8396; val_edge_recon_loss: 2694362.9500; val_gene_expr_recon_loss: 11261336.6000; val_masked_gp_l1_reg_loss: 111008.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56143.1445; val_chrom_access_recon_loss: 2465036.7333; val_global_loss: 16671402.0667; val_optim_loss: 16671402.0667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9787; val_auprc_score: 0.9740; val_best_acc_score: 0.9332; val_best_f1_score: 0.9360; train_kl_reg_loss: 82364.9964; train_edge_recon_loss: 2681687.8969; train_gene_expr_recon_loss: 11241301.0382; train_masked_gp_l1_reg_loss: 110967.4674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55956.7926; train_chrom_access_recon_loss: 2435058.2977; train_global_loss: 16607336.4351; train_optim_loss: 16607336.4351; val_kl_reg_loss: 84105.6010; val_edge_recon_loss: 2690769.8500; val_gene_expr_recon_loss: 11261282.7333; val_masked_gp_l1_reg_loss: 110913.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55820.0039; val_chrom_access_recon_loss: 2459830.4000; val_global_loss: 16662721.9333; val_optim_loss: 16662721.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9798; val_auprc_score: 0.9749; val_best_acc_score: 0.9356; val_best_f1_score: 0.9372; train_kl_reg_loss: 83192.2338; train_edge_recon_loss: 2680280.8588; train_gene_expr_recon_loss: 11234481.5344; train_masked_gp_l1_reg_loss: 110246.5249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53970.3465; train_chrom_access_recon_loss: 2432664.2080; train_global_loss: 16594835.6412; train_optim_loss: 16594835.6412; val_kl_reg_loss: 84304.9771; val_edge_recon_loss: 2675677.9167; val_gene_expr_recon_loss: 11274178.7333; val_masked_gp_l1_reg_loss: 110051.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53688.8438; val_chrom_access_recon_loss: 2474743.9000; val_global_loss: 16672646.6667; val_optim_loss: 16672646.6667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9782; val_auprc_score: 0.9730; val_best_acc_score: 0.9341; val_best_f1_score: 0.9361; train_kl_reg_loss: 83268.6599; train_edge_recon_loss: 2683282.6336; train_gene_expr_recon_loss: 11230291.4580; train_masked_gp_l1_reg_loss: 110004.8368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53620.9098; train_chrom_access_recon_loss: 2430318.3912; train_global_loss: 16590786.9466; train_optim_loss: 16590786.9466; val_kl_reg_loss: 83663.8943; val_edge_recon_loss: 2682430.1500; val_gene_expr_recon_loss: 11302978.9333; val_masked_gp_l1_reg_loss: 109966.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53547.4648; val_chrom_access_recon_loss: 2474515.1500; val_global_loss: 16707102.5333; val_optim_loss: 16707102.5333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9779; val_auprc_score: 0.9693; val_best_acc_score: 0.9357; val_best_f1_score: 0.9376; train_kl_reg_loss: 82976.4609; train_edge_recon_loss: 2682404.2595; train_gene_expr_recon_loss: 11220388.8473; train_masked_gp_l1_reg_loss: 109946.8282; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53491.2031; train_chrom_access_recon_loss: 2431539.7004; train_global_loss: 16580747.3282; train_optim_loss: 16580747.3282; val_kl_reg_loss: 83911.8510; val_edge_recon_loss: 2690142.2667; val_gene_expr_recon_loss: 11260019.3333; val_masked_gp_l1_reg_loss: 109930.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53463.7969; val_chrom_access_recon_loss: 2468128.8333; val_global_loss: 16665596.6667; val_optim_loss: 16665596.6667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9764; val_auprc_score: 0.9692; val_best_acc_score: 0.9313; val_best_f1_score: 0.9333; train_kl_reg_loss: 83238.6477; train_edge_recon_loss: 2678669.8015; train_gene_expr_recon_loss: 11230240.9237; train_masked_gp_l1_reg_loss: 109919.9095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53433.3819; train_chrom_access_recon_loss: 2432001.7595; train_global_loss: 16587504.4656; train_optim_loss: 16587504.4656; val_kl_reg_loss: 83866.4599; val_edge_recon_loss: 2702392.8833; val_gene_expr_recon_loss: 11266154.1333; val_masked_gp_l1_reg_loss: 109904.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53397.0195; val_chrom_access_recon_loss: 2465468.6333; val_global_loss: 16681183.1333; val_optim_loss: 16681183.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 16 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9769
val AUPRC score: 0.9712
val best accuracy score: 0.9333
val best F1 score: 0.9355
val target rna MSE score: 1.2282
val source rna MSE score: 0.4645
val target atac MSE score: 0.4972
val source atac MSE score: 0.1427
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
