[True]
Run timestamp: 07082023_200927_90.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_90']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8742; val_auprc_score: 0.8886; val_best_acc_score: 0.5155; val_best_f1_score: 0.6734; train_kl_reg_loss: 22638.4383; train_edge_recon_loss: 349917.2014; train_gene_expr_recon_loss: 1167407.0972; train_masked_gp_l1_reg_loss: 16064.7215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166666.7014; train_chrom_access_recon_loss: 709419.2569; train_global_loss: 2432113.4167; train_optim_loss: 2432113.4167; val_kl_reg_loss: 7100.9546; val_edge_recon_loss: 406441.2188; val_gene_expr_recon_loss: 1000460.8750; val_masked_gp_l1_reg_loss: 11282.1084; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162041.7344; val_chrom_access_recon_loss: 510410.5938; val_global_loss: 2097737.5000; val_optim_loss: 2097737.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8701; val_auprc_score: 0.8843; val_best_acc_score: 0.5133; val_best_f1_score: 0.6725; train_kl_reg_loss: 10206.4521; train_edge_recon_loss: 353829.5625; train_gene_expr_recon_loss: 909270.7639; train_masked_gp_l1_reg_loss: 9591.6531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159086.1875; train_chrom_access_recon_loss: 486019.8090; train_global_loss: 1928004.4306; train_optim_loss: 1928004.4306; val_kl_reg_loss: 13461.8184; val_edge_recon_loss: 406482.2500; val_gene_expr_recon_loss: 836775.0625; val_masked_gp_l1_reg_loss: 8506.1924; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155302.2031; val_chrom_access_recon_loss: 475867.7188; val_global_loss: 1896395.3750; val_optim_loss: 1896395.3750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8570; val_auprc_score: 0.8701; val_best_acc_score: 0.5232; val_best_f1_score: 0.6767; train_kl_reg_loss: 14487.0571; train_edge_recon_loss: 356382.9201; train_gene_expr_recon_loss: 809236.1806; train_masked_gp_l1_reg_loss: 8785.7544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151863.2674; train_chrom_access_recon_loss: 464367.5174; train_global_loss: 1805122.7222; train_optim_loss: 1805122.7222; val_kl_reg_loss: 15133.9736; val_edge_recon_loss: 406407.6250; val_gene_expr_recon_loss: 784802.2500; val_masked_gp_l1_reg_loss: 9004.1670; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147261.1875; val_chrom_access_recon_loss: 462322.0625; val_global_loss: 1824931.2500; val_optim_loss: 1824931.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8490; val_auprc_score: 0.8601; val_best_acc_score: 0.5372; val_best_f1_score: 0.6821; train_kl_reg_loss: 16902.0702; train_edge_recon_loss: 357497.3854; train_gene_expr_recon_loss: 767830.1597; train_masked_gp_l1_reg_loss: 8942.0645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143215.0677; train_chrom_access_recon_loss: 455875.1007; train_global_loss: 1750261.8056; train_optim_loss: 1750261.8056; val_kl_reg_loss: 17374.9023; val_edge_recon_loss: 406264.6562; val_gene_expr_recon_loss: 751408.5000; val_masked_gp_l1_reg_loss: 8905.9316; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137990.8750; val_chrom_access_recon_loss: 456847.2188; val_global_loss: 1778792.0000; val_optim_loss: 1778792.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8423; val_auprc_score: 0.8500; val_best_acc_score: 0.5523; val_best_f1_score: 0.6869; train_kl_reg_loss: 17964.4416; train_edge_recon_loss: 357849.6354; train_gene_expr_recon_loss: 736262.9931; train_masked_gp_l1_reg_loss: 8911.9748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133653.9097; train_chrom_access_recon_loss: 450105.4549; train_global_loss: 1704748.4444; train_optim_loss: 1704748.4444; val_kl_reg_loss: 17937.0312; val_edge_recon_loss: 405917.9375; val_gene_expr_recon_loss: 731375.6250; val_masked_gp_l1_reg_loss: 8908.3691; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128202.3594; val_chrom_access_recon_loss: 453318.6875; val_global_loss: 1745660.0000; val_optim_loss: 1745660.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8495; val_auprc_score: 0.8451; val_best_acc_score: 0.5717; val_best_f1_score: 0.6941; train_kl_reg_loss: 18458.4436; train_edge_recon_loss: 357653.3264; train_gene_expr_recon_loss: 717429.5764; train_masked_gp_l1_reg_loss: 8914.3927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123838.7170; train_chrom_access_recon_loss: 446812.1181; train_global_loss: 1673106.5833; train_optim_loss: 1673106.5833; val_kl_reg_loss: 18038.7031; val_edge_recon_loss: 405537.6562; val_gene_expr_recon_loss: 716985.7500; val_masked_gp_l1_reg_loss: 8917.2910; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118406.7891; val_chrom_access_recon_loss: 450845.8125; val_global_loss: 1718732.0000; val_optim_loss: 1718732.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8532; val_auprc_score: 0.8513; val_best_acc_score: 0.6241; val_best_f1_score: 0.7185; train_kl_reg_loss: 18509.0206; train_edge_recon_loss: 357507.3194; train_gene_expr_recon_loss: 709847.3889; train_masked_gp_l1_reg_loss: 8926.6404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114143.7769; train_chrom_access_recon_loss: 447594.5347; train_global_loss: 1656528.6528; train_optim_loss: 1656528.6528; val_kl_reg_loss: 17192.7852; val_edge_recon_loss: 404722.0625; val_gene_expr_recon_loss: 706618.1250; val_masked_gp_l1_reg_loss: 8925.1279; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108882.4375; val_chrom_access_recon_loss: 448897.3750; val_global_loss: 1695237.8750; val_optim_loss: 1695237.8750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8419; val_auprc_score: 0.8387; val_best_acc_score: 0.6634; val_best_f1_score: 0.7369; train_kl_reg_loss: 18868.5471; train_edge_recon_loss: 357273.5694; train_gene_expr_recon_loss: 699023.3611; train_masked_gp_l1_reg_loss: 8943.4871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104819.4679; train_chrom_access_recon_loss: 444478.2396; train_global_loss: 1633406.6389; train_optim_loss: 1633406.6389; val_kl_reg_loss: 18567.6797; val_edge_recon_loss: 404028.1250; val_gene_expr_recon_loss: 697490.8750; val_masked_gp_l1_reg_loss: 8951.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99838.2188; val_chrom_access_recon_loss: 447276.3750; val_global_loss: 1676153.3750; val_optim_loss: 1676153.3750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8324; val_auprc_score: 0.8320; val_best_acc_score: 0.7074; val_best_f1_score: 0.7573; train_kl_reg_loss: 19054.0009; train_edge_recon_loss: 356916.7500; train_gene_expr_recon_loss: 692721.0347; train_masked_gp_l1_reg_loss: 8965.4419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96050.7856; train_chrom_access_recon_loss: 443427.1181; train_global_loss: 1617135.1806; train_optim_loss: 1617135.1806; val_kl_reg_loss: 18496.7402; val_edge_recon_loss: 402547.6250; val_gene_expr_recon_loss: 691423.6875; val_masked_gp_l1_reg_loss: 8969.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91431.1875; val_chrom_access_recon_loss: 445953.4062; val_global_loss: 1658821.8750; val_optim_loss: 1658821.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8337; val_auprc_score: 0.8364; val_best_acc_score: 0.7425; val_best_f1_score: 0.7671; train_kl_reg_loss: 19269.6523; train_edge_recon_loss: 356384.1250; train_gene_expr_recon_loss: 682134.2222; train_masked_gp_l1_reg_loss: 8979.3906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87947.9036; train_chrom_access_recon_loss: 439988.2986; train_global_loss: 1594703.5694; train_optim_loss: 1594703.5694; val_kl_reg_loss: 18666.8477; val_edge_recon_loss: 400278.0938; val_gene_expr_recon_loss: 685824.3750; val_masked_gp_l1_reg_loss: 8983.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83722.1875; val_chrom_access_recon_loss: 444674.8438; val_global_loss: 1642150.1250; val_optim_loss: 1642150.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8372; val_auprc_score: 0.8364; val_best_acc_score: 0.7610; val_best_f1_score: 0.7552; train_kl_reg_loss: 19365.9703; train_edge_recon_loss: 355820.3542; train_gene_expr_recon_loss: 676449.2292; train_masked_gp_l1_reg_loss: 8996.3295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80563.7595; train_chrom_access_recon_loss: 439513.4201; train_global_loss: 1580709.0556; train_optim_loss: 1580709.0556; val_kl_reg_loss: 19022.1016; val_edge_recon_loss: 397887.0000; val_gene_expr_recon_loss: 681346.3125; val_masked_gp_l1_reg_loss: 9005.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76753.3906; val_chrom_access_recon_loss: 443470.2500; val_global_loss: 1627484.0000; val_optim_loss: 1627484.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8454; val_auprc_score: 0.8435; val_best_acc_score: 0.7452; val_best_f1_score: 0.7579; train_kl_reg_loss: 19523.2057; train_edge_recon_loss: 354690.5035; train_gene_expr_recon_loss: 673021.9861; train_masked_gp_l1_reg_loss: 9017.1203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73934.1250; train_chrom_access_recon_loss: 438377.9479; train_global_loss: 1568564.8611; train_optim_loss: 1568564.8611; val_kl_reg_loss: 18384.3652; val_edge_recon_loss: 394772.3438; val_gene_expr_recon_loss: 678244.2500; val_masked_gp_l1_reg_loss: 9031.8369; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70538.0625; val_chrom_access_recon_loss: 442529.3125; val_global_loss: 1613500.2500; val_optim_loss: 1613500.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8592; val_auprc_score: 0.8521; val_best_acc_score: 0.7657; val_best_f1_score: 0.7871; train_kl_reg_loss: 19308.8663; train_edge_recon_loss: 352972.5590; train_gene_expr_recon_loss: 671031.0000; train_masked_gp_l1_reg_loss: 9056.5800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68031.5122; train_chrom_access_recon_loss: 438095.9965; train_global_loss: 1558496.5556; train_optim_loss: 1558496.5556; val_kl_reg_loss: 17765.4629; val_edge_recon_loss: 386697.9688; val_gene_expr_recon_loss: 675855.2500; val_masked_gp_l1_reg_loss: 9072.4697; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65001.2969; val_chrom_access_recon_loss: 441503.4062; val_global_loss: 1595895.8750; val_optim_loss: 1595895.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8704; val_auprc_score: 0.8608; val_best_acc_score: 0.7906; val_best_f1_score: 0.7982; train_kl_reg_loss: 18852.4293; train_edge_recon_loss: 350123.2674; train_gene_expr_recon_loss: 670489.8958; train_masked_gp_l1_reg_loss: 9091.5614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62766.4688; train_chrom_access_recon_loss: 436644.6146; train_global_loss: 1547968.2222; train_optim_loss: 1547968.2222; val_kl_reg_loss: 18333.6836; val_edge_recon_loss: 375065.7188; val_gene_expr_recon_loss: 673563.5000; val_masked_gp_l1_reg_loss: 9107.5996; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60062.0000; val_chrom_access_recon_loss: 440871.6250; val_global_loss: 1577004.1250; val_optim_loss: 1577004.1250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8789; val_auprc_score: 0.8700; val_best_acc_score: 0.7970; val_best_f1_score: 0.8072; train_kl_reg_loss: 18667.8984; train_edge_recon_loss: 343517.3819; train_gene_expr_recon_loss: 669216.8819; train_masked_gp_l1_reg_loss: 9134.9977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58062.3238; train_chrom_access_recon_loss: 435886.1910; train_global_loss: 1534485.6528; train_optim_loss: 1534485.6528; val_kl_reg_loss: 18026.0469; val_edge_recon_loss: 351885.7188; val_gene_expr_recon_loss: 674345.3750; val_masked_gp_l1_reg_loss: 9168.7910; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55641.1328; val_chrom_access_recon_loss: 440315.5312; val_global_loss: 1549382.5000; val_optim_loss: 1549382.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8763; val_auprc_score: 0.8629; val_best_acc_score: 0.7893; val_best_f1_score: 0.8100; train_kl_reg_loss: 20623.9538; train_edge_recon_loss: 330117.7812; train_gene_expr_recon_loss: 669790.5208; train_masked_gp_l1_reg_loss: 9218.8202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53859.7886; train_chrom_access_recon_loss: 436214.2083; train_global_loss: 1519825.0833; train_optim_loss: 1519825.0833; val_kl_reg_loss: 22381.0977; val_edge_recon_loss: 326091.0938; val_gene_expr_recon_loss: 674825.3750; val_masked_gp_l1_reg_loss: 9273.7988; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51701.2578; val_chrom_access_recon_loss: 440014.5000; val_global_loss: 1524287.1250; val_optim_loss: 1524287.1250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8817; val_auprc_score: 0.8668; val_best_acc_score: 0.7920; val_best_f1_score: 0.8112; train_kl_reg_loss: 26336.8121; train_edge_recon_loss: 315506.6632; train_gene_expr_recon_loss: 666568.1944; train_masked_gp_l1_reg_loss: 9323.6852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50103.3663; train_chrom_access_recon_loss: 434630.2465; train_global_loss: 1502468.9722; train_optim_loss: 1502468.9722; val_kl_reg_loss: 27480.6543; val_edge_recon_loss: 314814.6250; val_gene_expr_recon_loss: 672076.1250; val_masked_gp_l1_reg_loss: 9373.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48161.6328; val_chrom_access_recon_loss: 438914.5625; val_global_loss: 1510821.0000; val_optim_loss: 1510821.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8939; val_auprc_score: 0.8812; val_best_acc_score: 0.8046; val_best_f1_score: 0.8156; train_kl_reg_loss: 28862.8090; train_edge_recon_loss: 311110.5938; train_gene_expr_recon_loss: 666191.0208; train_masked_gp_l1_reg_loss: 9418.1095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46720.0703; train_chrom_access_recon_loss: 434751.2153; train_global_loss: 1497053.8333; train_optim_loss: 1497053.8333; val_kl_reg_loss: 26343.1426; val_edge_recon_loss: 311776.6875; val_gene_expr_recon_loss: 669803.5000; val_masked_gp_l1_reg_loss: 9468.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44952.4023; val_chrom_access_recon_loss: 438217.9062; val_global_loss: 1500561.7500; val_optim_loss: 1500561.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9059; val_auprc_score: 0.8917; val_best_acc_score: 0.8223; val_best_f1_score: 0.8292; train_kl_reg_loss: 26792.4390; train_edge_recon_loss: 308999.3472; train_gene_expr_recon_loss: 661341.5208; train_masked_gp_l1_reg_loss: 9511.5831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43636.0443; train_chrom_access_recon_loss: 432999.1771; train_global_loss: 1483280.1250; train_optim_loss: 1483280.1250; val_kl_reg_loss: 26170.2422; val_edge_recon_loss: 308027.6875; val_gene_expr_recon_loss: 668364.1250; val_masked_gp_l1_reg_loss: 9563.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42030.1602; val_chrom_access_recon_loss: 437404.7500; val_global_loss: 1491560.1250; val_optim_loss: 1491560.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9177; val_auprc_score: 0.9028; val_best_acc_score: 0.8376; val_best_f1_score: 0.8455; train_kl_reg_loss: 26982.1743; train_edge_recon_loss: 306079.0208; train_gene_expr_recon_loss: 663387.9028; train_masked_gp_l1_reg_loss: 9593.4443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40834.7092; train_chrom_access_recon_loss: 432743.4340; train_global_loss: 1479620.6806; train_optim_loss: 1479620.6806; val_kl_reg_loss: 26207.9453; val_edge_recon_loss: 304718.9688; val_gene_expr_recon_loss: 666615.8750; val_masked_gp_l1_reg_loss: 9630.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39371.2852; val_chrom_access_recon_loss: 436569.2812; val_global_loss: 1483114.2500; val_optim_loss: 1483114.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9230; val_auprc_score: 0.9060; val_best_acc_score: 0.8480; val_best_f1_score: 0.8546; train_kl_reg_loss: 26705.8401; train_edge_recon_loss: 303465.2188; train_gene_expr_recon_loss: 658847.4861; train_masked_gp_l1_reg_loss: 9663.7932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38282.3464; train_chrom_access_recon_loss: 432095.5556; train_global_loss: 1469060.2083; train_optim_loss: 1469060.2083; val_kl_reg_loss: 25898.1406; val_edge_recon_loss: 303943.8125; val_gene_expr_recon_loss: 664910.3125; val_masked_gp_l1_reg_loss: 9700.6074; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36946.3359; val_chrom_access_recon_loss: 435933.3125; val_global_loss: 1477332.5000; val_optim_loss: 1477332.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9379; val_auprc_score: 0.9262; val_best_acc_score: 0.8642; val_best_f1_score: 0.8707; train_kl_reg_loss: 26517.3062; train_edge_recon_loss: 299853.5417; train_gene_expr_recon_loss: 661620.0347; train_masked_gp_l1_reg_loss: 9726.3185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35947.9731; train_chrom_access_recon_loss: 431909.4653; train_global_loss: 1465574.6528; train_optim_loss: 1465574.6528; val_kl_reg_loss: 25804.1250; val_edge_recon_loss: 298341.0938; val_gene_expr_recon_loss: 664585.3750; val_masked_gp_l1_reg_loss: 9760.5215; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34721.5430; val_chrom_access_recon_loss: 435377.9688; val_global_loss: 1468590.6250; val_optim_loss: 1468590.6250
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9403; val_auprc_score: 0.9273; val_best_acc_score: 0.8724; val_best_f1_score: 0.8778; train_kl_reg_loss: 26685.4373; train_edge_recon_loss: 298072.6701; train_gene_expr_recon_loss: 659506.5625; train_masked_gp_l1_reg_loss: 9790.2878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33816.5343; train_chrom_access_recon_loss: 431804.8681; train_global_loss: 1459676.3333; train_optim_loss: 1459676.3333; val_kl_reg_loss: 25773.6621; val_edge_recon_loss: 298810.3125; val_gene_expr_recon_loss: 662730.8750; val_masked_gp_l1_reg_loss: 9822.8232; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32694.3984; val_chrom_access_recon_loss: 434558.4375; val_global_loss: 1464390.5000; val_optim_loss: 1464390.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9483; val_auprc_score: 0.9359; val_best_acc_score: 0.8848; val_best_f1_score: 0.8884; train_kl_reg_loss: 26893.1664; train_edge_recon_loss: 295425.9514; train_gene_expr_recon_loss: 654039.3125; train_masked_gp_l1_reg_loss: 9846.3995; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31859.6576; train_chrom_access_recon_loss: 428528.0035; train_global_loss: 1446592.4861; train_optim_loss: 1446592.4861; val_kl_reg_loss: 26836.0605; val_edge_recon_loss: 296190.5000; val_gene_expr_recon_loss: 661337.7500; val_masked_gp_l1_reg_loss: 9876.6182; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30828.0898; val_chrom_access_recon_loss: 433956.6250; val_global_loss: 1459025.6250; val_optim_loss: 1459025.6250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9547; val_auprc_score: 0.9441; val_best_acc_score: 0.8952; val_best_f1_score: 0.8981; train_kl_reg_loss: 26912.2793; train_edge_recon_loss: 294829.5972; train_gene_expr_recon_loss: 653848.2847; train_masked_gp_l1_reg_loss: 9898.0017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30058.7413; train_chrom_access_recon_loss: 428866.3507; train_global_loss: 1444413.2639; train_optim_loss: 1444413.2639; val_kl_reg_loss: 26580.9023; val_edge_recon_loss: 293882.3750; val_gene_expr_recon_loss: 660062.1875; val_masked_gp_l1_reg_loss: 9913.2236; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29119.7031; val_chrom_access_recon_loss: 433238.1250; val_global_loss: 1452796.5000; val_optim_loss: 1452796.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9497; val_auprc_score: 0.9360; val_best_acc_score: 0.8898; val_best_f1_score: 0.8929; train_kl_reg_loss: 24318.2285; train_edge_recon_loss: 294194.9931; train_gene_expr_recon_loss: 975254.1319; train_masked_gp_l1_reg_loss: 10053.3582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28227.4520; train_chrom_access_recon_loss: 454202.4479; train_global_loss: 1786250.6111; train_optim_loss: 1786250.6111; val_kl_reg_loss: 16689.8477; val_edge_recon_loss: 295315.0312; val_gene_expr_recon_loss: 975268.6250; val_masked_gp_l1_reg_loss: 10302.7979; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27012.7734; val_chrom_access_recon_loss: 457759.7500; val_global_loss: 1782348.7500; val_optim_loss: 1782348.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9510; val_auprc_score: 0.9386; val_best_acc_score: 0.8864; val_best_f1_score: 0.8904; train_kl_reg_loss: 22497.8390; train_edge_recon_loss: 291107.2847; train_gene_expr_recon_loss: 971476.7431; train_masked_gp_l1_reg_loss: 10536.8581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26006.0109; train_chrom_access_recon_loss: 452114.5938; train_global_loss: 1773739.3056; train_optim_loss: 1773739.3056; val_kl_reg_loss: 17125.9902; val_edge_recon_loss: 291899.7188; val_gene_expr_recon_loss: 970604.1875; val_masked_gp_l1_reg_loss: 10824.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24772.7383; val_chrom_access_recon_loss: 457091.4688; val_global_loss: 1772319.1250; val_optim_loss: 1772319.1250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9530; val_auprc_score: 0.9377; val_best_acc_score: 0.8928; val_best_f1_score: 0.8960; train_kl_reg_loss: 21905.5977; train_edge_recon_loss: 288397.9549; train_gene_expr_recon_loss: 961212.1875; train_masked_gp_l1_reg_loss: 11030.4621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23851.3316; train_chrom_access_recon_loss: 450223.5000; train_global_loss: 1756621.0417; train_optim_loss: 1756621.0417; val_kl_reg_loss: 18244.8340; val_edge_recon_loss: 289637.0938; val_gene_expr_recon_loss: 965013.7500; val_masked_gp_l1_reg_loss: 11268.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22742.4375; val_chrom_access_recon_loss: 456335.2500; val_global_loss: 1763241.7500; val_optim_loss: 1763241.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9619; val_auprc_score: 0.9524; val_best_acc_score: 0.9057; val_best_f1_score: 0.9085; train_kl_reg_loss: 21529.5187; train_edge_recon_loss: 287611.6667; train_gene_expr_recon_loss: 958524.6111; train_masked_gp_l1_reg_loss: 11438.1901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21930.2899; train_chrom_access_recon_loss: 452083.0000; train_global_loss: 1753117.2778; train_optim_loss: 1753117.2778; val_kl_reg_loss: 18445.5820; val_edge_recon_loss: 287372.9062; val_gene_expr_recon_loss: 961962.1250; val_masked_gp_l1_reg_loss: 11639.5361; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20959.1367; val_chrom_access_recon_loss: 455783.4062; val_global_loss: 1756162.6250; val_optim_loss: 1756162.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9617; val_auprc_score: 0.9542; val_best_acc_score: 0.9019; val_best_f1_score: 0.9046; train_kl_reg_loss: 21207.9763; train_edge_recon_loss: 286213.4514; train_gene_expr_recon_loss: 952833.9514; train_masked_gp_l1_reg_loss: 11576.5246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20789.3288; train_chrom_access_recon_loss: 450416.4097; train_global_loss: 1743037.6250; train_optim_loss: 1743037.6250; val_kl_reg_loss: 18473.9316; val_edge_recon_loss: 289645.4375; val_gene_expr_recon_loss: 961219.0625; val_masked_gp_l1_reg_loss: 11524.7090; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20604.2363; val_chrom_access_recon_loss: 455687.8438; val_global_loss: 1757155.3750; val_optim_loss: 1757155.3750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9604; val_auprc_score: 0.9486; val_best_acc_score: 0.9038; val_best_f1_score: 0.9076; train_kl_reg_loss: 21183.7617; train_edge_recon_loss: 286609.1181; train_gene_expr_recon_loss: 953989.9792; train_masked_gp_l1_reg_loss: 11520.2968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20498.3216; train_chrom_access_recon_loss: 452117.2083; train_global_loss: 1745918.7222; train_optim_loss: 1745918.7222; val_kl_reg_loss: 18461.1484; val_edge_recon_loss: 288316.6250; val_gene_expr_recon_loss: 961163.1875; val_masked_gp_l1_reg_loss: 11508.6660; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20360.5977; val_chrom_access_recon_loss: 455713.3750; val_global_loss: 1755523.6250; val_optim_loss: 1755523.6250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9608; val_auprc_score: 0.9503; val_best_acc_score: 0.9029; val_best_f1_score: 0.9053; train_kl_reg_loss: 21283.6686; train_edge_recon_loss: 286881.0000; train_gene_expr_recon_loss: 957945.0069; train_masked_gp_l1_reg_loss: 11507.5051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20262.8991; train_chrom_access_recon_loss: 452473.2604; train_global_loss: 1750353.3194; train_optim_loss: 1750353.3194; val_kl_reg_loss: 18617.6641; val_edge_recon_loss: 287347.2500; val_gene_expr_recon_loss: 960482.9375; val_masked_gp_l1_reg_loss: 11507.5332; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20144.0938; val_chrom_access_recon_loss: 455531.3125; val_global_loss: 1753630.7500; val_optim_loss: 1753630.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9587; val_auprc_score: 0.9440; val_best_acc_score: 0.9014; val_best_f1_score: 0.9051; train_kl_reg_loss: 21180.2663; train_edge_recon_loss: 287289.5868; train_gene_expr_recon_loss: 953953.3681; train_masked_gp_l1_reg_loss: 11511.3805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20054.5996; train_chrom_access_recon_loss: 451705.8785; train_global_loss: 1745695.0694; train_optim_loss: 1745695.0694; val_kl_reg_loss: 18525.6523; val_edge_recon_loss: 289639.9375; val_gene_expr_recon_loss: 960325.6250; val_masked_gp_l1_reg_loss: 11517.3965; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19948.5703; val_chrom_access_recon_loss: 455525.7812; val_global_loss: 1755483.0000; val_optim_loss: 1755483.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9472
val AUPRC score: 0.9362
val best accuracy score: 0.8828
val best F1 score: 0.8861
val target rna MSE score: 3.9248
val source rna MSE score: 3.1937
val target atac MSE score: 0.1382
val source atac MSE score: 0.0207
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
