[True]
Run timestamp: 26072023_025045_90.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_90']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9058; val_auprc_score: 0.9191; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17576.3627; train_edge_recon_loss: 3495843.8889; train_gene_expr_recon_loss: 3169818.4444; train_masked_gp_l1_reg_loss: 1885.1980; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 108207668.4444; train_global_loss: 114892792.0000; train_optim_loss: 114892792.0000; val_kl_reg_loss: 41498.9922; val_edge_recon_loss: 4065922.7500; val_gene_expr_recon_loss: 3086306.5000; val_masked_gp_l1_reg_loss: 1926.5948; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 107597728.0000; val_global_loss: 114793384.0000; val_optim_loss: 114793384.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9000; val_auprc_score: 0.9054; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 43807.4742; train_edge_recon_loss: 3557502.3611; train_gene_expr_recon_loss: 2977787.7500; train_masked_gp_l1_reg_loss: 2028.3522; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 106669295.1111; train_global_loss: 113250421.3333; train_optim_loss: 113250421.3333; val_kl_reg_loss: 60417.8281; val_edge_recon_loss: 4065811.0000; val_gene_expr_recon_loss: 2851038.0000; val_masked_gp_l1_reg_loss: 2182.2434; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 105667760.0000; val_global_loss: 112647208.0000; val_optim_loss: 112647208.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8805; val_auprc_score: 0.8830; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 84843.6094; train_edge_recon_loss: 3587476.3889; train_gene_expr_recon_loss: 2717656.3611; train_masked_gp_l1_reg_loss: 2322.4919; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 103590432.0000; train_global_loss: 109982730.6667; train_optim_loss: 109982730.6667; val_kl_reg_loss: 90144.7656; val_edge_recon_loss: 4065863.7500; val_gene_expr_recon_loss: 2652132.2500; val_masked_gp_l1_reg_loss: 2485.9585; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 103305784.0000; val_global_loss: 110116408.0000; val_optim_loss: 110116408.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8775; val_auprc_score: 0.8794; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 119707.6979; train_edge_recon_loss: 3618633.9722; train_gene_expr_recon_loss: 2546236.2500; train_masked_gp_l1_reg_loss: 2578.7735; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102127824.8889; train_global_loss: 108414981.3333; train_optim_loss: 108414981.3333; val_kl_reg_loss: 107973.9062; val_edge_recon_loss: 4065933.5000; val_gene_expr_recon_loss: 2489712.5000; val_masked_gp_l1_reg_loss: 2667.8779; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101613864.0000; val_global_loss: 108280152.0000; val_optim_loss: 108280152.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8927; val_auprc_score: 0.8950; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 140652.4271; train_edge_recon_loss: 3645358.6111; train_gene_expr_recon_loss: 2407694.0833; train_masked_gp_l1_reg_loss: 2705.2553; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100529117.3333; train_global_loss: 106725528.0000; train_optim_loss: 106725528.0000; val_kl_reg_loss: 124592.8047; val_edge_recon_loss: 4065886.7500; val_gene_expr_recon_loss: 2390547.2500; val_masked_gp_l1_reg_loss: 2735.6196; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100533088.0000; val_global_loss: 107116848.0000; val_optim_loss: 107116848.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9028; val_auprc_score: 0.9046; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 170404.9427; train_edge_recon_loss: 3631792.6389; train_gene_expr_recon_loss: 2334280.7222; train_masked_gp_l1_reg_loss: 2740.2358; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100134440.0000; train_global_loss: 106273657.7778; train_optim_loss: 106273657.7778; val_kl_reg_loss: 143465.5312; val_edge_recon_loss: 4065863.5000; val_gene_expr_recon_loss: 2320819.2500; val_masked_gp_l1_reg_loss: 2737.0266; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99570104.0000; val_global_loss: 106102992.0000; val_optim_loss: 106102992.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9044; val_auprc_score: 0.9037; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 179083.0694; train_edge_recon_loss: 3631166.5833; train_gene_expr_recon_loss: 2268568.7778; train_masked_gp_l1_reg_loss: 2725.6681; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98888060.4444; train_global_loss: 104969604.4444; train_optim_loss: 104969604.4444; val_kl_reg_loss: 135677.1250; val_edge_recon_loss: 4065702.7500; val_gene_expr_recon_loss: 2271630.7500; val_masked_gp_l1_reg_loss: 2707.7490; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99172088.0000; val_global_loss: 105647808.0000; val_optim_loss: 105647808.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8933; val_auprc_score: 0.8915; val_best_acc_score: 0.5022; val_best_f1_score: 0.6676; train_kl_reg_loss: 182390.1788; train_edge_recon_loss: 3631856.1111; train_gene_expr_recon_loss: 2217064.6944; train_masked_gp_l1_reg_loss: 2690.7906; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98213272.8889; train_global_loss: 104247274.6667; train_optim_loss: 104247274.6667; val_kl_reg_loss: 173015.8438; val_edge_recon_loss: 4065488.5000; val_gene_expr_recon_loss: 2234630.7500; val_masked_gp_l1_reg_loss: 2668.6260; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98715784.0000; val_global_loss: 105191584.0000; val_optim_loss: 105191584.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8830; val_auprc_score: 0.8812; val_best_acc_score: 0.5053; val_best_f1_score: 0.6690; train_kl_reg_loss: 199200.9392; train_edge_recon_loss: 3616862.1944; train_gene_expr_recon_loss: 2188383.2222; train_masked_gp_l1_reg_loss: 2649.2282; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97138632.0000; train_global_loss: 103145727.1111; train_optim_loss: 103145727.1111; val_kl_reg_loss: 182175.1250; val_edge_recon_loss: 4065135.5000; val_gene_expr_recon_loss: 2206879.0000; val_masked_gp_l1_reg_loss: 2622.1357; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98581856.0000; val_global_loss: 105038664.0000; val_optim_loss: 105038664.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8740; val_auprc_score: 0.8739; val_best_acc_score: 0.5148; val_best_f1_score: 0.6733; train_kl_reg_loss: 195019.3698; train_edge_recon_loss: 3612886.6667; train_gene_expr_recon_loss: 2165985.4722; train_masked_gp_l1_reg_loss: 2600.1917; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97601864.8889; train_global_loss: 103578356.4444; train_optim_loss: 103578356.4444; val_kl_reg_loss: 188309.0625; val_edge_recon_loss: 4064579.2500; val_gene_expr_recon_loss: 2189047.7500; val_masked_gp_l1_reg_loss: 2572.6001; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98306136.0000; val_global_loss: 104750648.0000; val_optim_loss: 104750648.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8656; val_auprc_score: 0.8613; val_best_acc_score: 0.5315; val_best_f1_score: 0.6809; train_kl_reg_loss: 206038.7066; train_edge_recon_loss: 3604632.6389; train_gene_expr_recon_loss: 2169497.7222; train_masked_gp_l1_reg_loss: 2553.4588; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98057374.2222; train_global_loss: 104040096.8889; train_optim_loss: 104040096.8889; val_kl_reg_loss: 136979.8750; val_edge_recon_loss: 4063448.5000; val_gene_expr_recon_loss: 2181824.0000; val_masked_gp_l1_reg_loss: 2529.0601; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98290664.0000; val_global_loss: 104675448.0000; val_optim_loss: 104675448.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8713; val_auprc_score: 0.8714; val_best_acc_score: 0.5408; val_best_f1_score: 0.6849; train_kl_reg_loss: 188770.4358; train_edge_recon_loss: 3625639.4444; train_gene_expr_recon_loss: 2134550.9444; train_masked_gp_l1_reg_loss: 2512.6615; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97268544.0000; train_global_loss: 103220018.6667; train_optim_loss: 103220018.6667; val_kl_reg_loss: 172707.5625; val_edge_recon_loss: 4062806.0000; val_gene_expr_recon_loss: 2168084.7500; val_masked_gp_l1_reg_loss: 2491.7119; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98095752.0000; val_global_loss: 104501840.0000; val_optim_loss: 104501840.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8747; val_auprc_score: 0.8730; val_best_acc_score: 0.5675; val_best_f1_score: 0.6971; train_kl_reg_loss: 209191.5503; train_edge_recon_loss: 3593618.8611; train_gene_expr_recon_loss: 2133789.1667; train_masked_gp_l1_reg_loss: 2477.4344; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97096768.0000; train_global_loss: 103035845.3333; train_optim_loss: 103035845.3333; val_kl_reg_loss: 181628.2188; val_edge_recon_loss: 4061489.7500; val_gene_expr_recon_loss: 2160164.0000; val_masked_gp_l1_reg_loss: 2460.3931; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97954672.0000; val_global_loss: 104360416.0000; val_optim_loss: 104360416.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8815; val_auprc_score: 0.8770; val_best_acc_score: 0.5967; val_best_f1_score: 0.7107; train_kl_reg_loss: 193112.5156; train_edge_recon_loss: 3601639.3056; train_gene_expr_recon_loss: 2134743.0972; train_masked_gp_l1_reg_loss: 2449.5267; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97147715.5556; train_global_loss: 103079658.6667; train_optim_loss: 103079658.6667; val_kl_reg_loss: 161114.4375; val_edge_recon_loss: 4059811.0000; val_gene_expr_recon_loss: 2152532.2500; val_masked_gp_l1_reg_loss: 2434.1538; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97657488.0000; val_global_loss: 104033376.0000; val_optim_loss: 104033376.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8849; val_auprc_score: 0.8811; val_best_acc_score: 0.6300; val_best_f1_score: 0.7271; train_kl_reg_loss: 197843.3490; train_edge_recon_loss: 3593376.1111; train_gene_expr_recon_loss: 2122698.3333; train_masked_gp_l1_reg_loss: 2424.5359; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96823069.3333; train_global_loss: 102739410.6667; train_optim_loss: 102739410.6667; val_kl_reg_loss: 181719.6562; val_edge_recon_loss: 4058286.2500; val_gene_expr_recon_loss: 2148534.5000; val_masked_gp_l1_reg_loss: 2412.6418; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97737680.0000; val_global_loss: 104128632.0000; val_optim_loss: 104128632.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8863; val_auprc_score: 0.8713; val_best_acc_score: 0.6902; val_best_f1_score: 0.7581; train_kl_reg_loss: 196202.8160; train_edge_recon_loss: 3588844.1111; train_gene_expr_recon_loss: 2129918.0278; train_masked_gp_l1_reg_loss: 2404.6704; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97672946.6667; train_global_loss: 103590315.5556; train_optim_loss: 103590315.5556; val_kl_reg_loss: 148327.0312; val_edge_recon_loss: 4054210.2500; val_gene_expr_recon_loss: 2144503.7500; val_masked_gp_l1_reg_loss: 2393.6699; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97503792.0000; val_global_loss: 103853224.0000; val_optim_loss: 103853224.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8895; val_auprc_score: 0.8783; val_best_acc_score: 0.7363; val_best_f1_score: 0.7846; train_kl_reg_loss: 184740.2847; train_edge_recon_loss: 3595358.0278; train_gene_expr_recon_loss: 2112663.6250; train_masked_gp_l1_reg_loss: 2389.4818; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96806224.8889; train_global_loss: 102701376.0000; train_optim_loss: 102701376.0000; val_kl_reg_loss: 169646.0000; val_edge_recon_loss: 4050896.7500; val_gene_expr_recon_loss: 2134591.5000; val_masked_gp_l1_reg_loss: 2382.8723; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97423000.0000; val_global_loss: 103780520.0000; val_optim_loss: 103780520.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9003; val_auprc_score: 0.8925; val_best_acc_score: 0.7909; val_best_f1_score: 0.8172; train_kl_reg_loss: 196489.0486; train_edge_recon_loss: 3575253.7222; train_gene_expr_recon_loss: 2108570.4167; train_masked_gp_l1_reg_loss: 2378.1369; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96874148.4444; train_global_loss: 102756840.0000; train_optim_loss: 102756840.0000; val_kl_reg_loss: 147334.5312; val_edge_recon_loss: 4044374.5000; val_gene_expr_recon_loss: 2134010.5000; val_masked_gp_l1_reg_loss: 2370.8928; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97450856.0000; val_global_loss: 103778944.0000; val_optim_loss: 103778944.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9076; val_auprc_score: 0.8982; val_best_acc_score: 0.8235; val_best_f1_score: 0.8371; train_kl_reg_loss: 180835.1215; train_edge_recon_loss: 3587381.4444; train_gene_expr_recon_loss: 2111043.3194; train_masked_gp_l1_reg_loss: 2366.8695; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96525450.6667; train_global_loss: 102407078.2222; train_optim_loss: 102407078.2222; val_kl_reg_loss: 162897.6250; val_edge_recon_loss: 4034666.7500; val_gene_expr_recon_loss: 2126943.0000; val_masked_gp_l1_reg_loss: 2360.9629; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97186984.0000; val_global_loss: 103513856.0000; val_optim_loss: 103513856.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9015; val_auprc_score: 0.8898; val_best_acc_score: 0.8257; val_best_f1_score: 0.8336; train_kl_reg_loss: 185041.7778; train_edge_recon_loss: 3573038.3889; train_gene_expr_recon_loss: 2104760.3750; train_masked_gp_l1_reg_loss: 2359.7919; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96884577.7778; train_global_loss: 102749777.7778; train_optim_loss: 102749777.7778; val_kl_reg_loss: 153161.3750; val_edge_recon_loss: 4024636.7500; val_gene_expr_recon_loss: 2125431.7500; val_masked_gp_l1_reg_loss: 2357.0349; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97232352.0000; val_global_loss: 103537936.0000; val_optim_loss: 103537936.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9071; val_auprc_score: 0.8932; val_best_acc_score: 0.8302; val_best_f1_score: 0.8300; train_kl_reg_loss: 176891.8438; train_edge_recon_loss: 3574666.1111; train_gene_expr_recon_loss: 2104435.8333; train_masked_gp_l1_reg_loss: 2357.1704; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96425513.7778; train_global_loss: 102283864.8889; train_optim_loss: 102283864.8889; val_kl_reg_loss: 156426.2188; val_edge_recon_loss: 4008367.0000; val_gene_expr_recon_loss: 2118857.0000; val_masked_gp_l1_reg_loss: 2354.4604; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97005768.0000; val_global_loss: 103291776.0000; val_optim_loss: 103291776.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9066; val_auprc_score: 0.8867; val_best_acc_score: 0.8174; val_best_f1_score: 0.8076; train_kl_reg_loss: 179320.7500; train_edge_recon_loss: 3562013.3611; train_gene_expr_recon_loss: 2109304.8194; train_masked_gp_l1_reg_loss: 2352.3040; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96193448.8889; train_global_loss: 102046440.0000; train_optim_loss: 102046440.0000; val_kl_reg_loss: 145805.9375; val_edge_recon_loss: 3986015.5000; val_gene_expr_recon_loss: 2119315.7500; val_masked_gp_l1_reg_loss: 2348.5667; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97174032.0000; val_global_loss: 103427520.0000; val_optim_loss: 103427520.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9153; val_auprc_score: 0.9008; val_best_acc_score: 0.8076; val_best_f1_score: 0.8210; train_kl_reg_loss: 170398.5625; train_edge_recon_loss: 3561169.0833; train_gene_expr_recon_loss: 2081147.2500; train_masked_gp_l1_reg_loss: 2346.9446; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95795919.1111; train_global_loss: 101610980.4444; train_optim_loss: 101610980.4444; val_kl_reg_loss: 153004.7656; val_edge_recon_loss: 3957318.0000; val_gene_expr_recon_loss: 2113814.0000; val_masked_gp_l1_reg_loss: 2342.8091; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96925704.0000; val_global_loss: 103152184.0000; val_optim_loss: 103152184.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9130; val_auprc_score: 0.8928; val_best_acc_score: 0.8112; val_best_f1_score: 0.8353; train_kl_reg_loss: 171171.0729; train_edge_recon_loss: 3543967.3056; train_gene_expr_recon_loss: 2106159.6111; train_masked_gp_l1_reg_loss: 2340.4298; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97152324.4444; train_global_loss: 102975962.6667; train_optim_loss: 102975962.6667; val_kl_reg_loss: 139734.3594; val_edge_recon_loss: 3913842.7500; val_gene_expr_recon_loss: 2112801.7500; val_masked_gp_l1_reg_loss: 2336.6260; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96887024.0000; val_global_loss: 103055736.0000; val_optim_loss: 103055736.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9138; val_auprc_score: 0.8916; val_best_acc_score: 0.8309; val_best_f1_score: 0.8465; train_kl_reg_loss: 162445.7934; train_edge_recon_loss: 3535807.2778; train_gene_expr_recon_loss: 2090321.7639; train_masked_gp_l1_reg_loss: 2339.0325; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96284792.0000; train_global_loss: 102075705.7778; train_optim_loss: 102075705.7778; val_kl_reg_loss: 136767.0156; val_edge_recon_loss: 3853483.0000; val_gene_expr_recon_loss: 2106742.0000; val_masked_gp_l1_reg_loss: 2337.9429; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96720720.0000; val_global_loss: 102820048.0000; val_optim_loss: 102820048.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9210; val_auprc_score: 0.9045; val_best_acc_score: 0.8355; val_best_f1_score: 0.8295; train_kl_reg_loss: 143085.9410; train_edge_recon_loss: 3853277.8333; train_gene_expr_recon_loss: 2108594.8056; train_masked_gp_l1_reg_loss: 2341.1058; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96280324.4444; train_global_loss: 102387624.0000; train_optim_loss: 102387624.0000; val_kl_reg_loss: 101645.0156; val_edge_recon_loss: 3971091.0000; val_gene_expr_recon_loss: 2116367.5000; val_masked_gp_l1_reg_loss: 2347.3459; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96936184.0000; val_global_loss: 103127632.0000; val_optim_loss: 103127632.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9172; val_auprc_score: 0.8962; val_best_acc_score: 0.8436; val_best_f1_score: 0.8488; train_kl_reg_loss: 119395.8707; train_edge_recon_loss: 3783899.5000; train_gene_expr_recon_loss: 2129108.2639; train_masked_gp_l1_reg_loss: 2356.1376; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96276502.2222; train_global_loss: 102311261.3333; train_optim_loss: 102311261.3333; val_kl_reg_loss: 96248.3516; val_edge_recon_loss: 3999583.7500; val_gene_expr_recon_loss: 2118161.5000; val_masked_gp_l1_reg_loss: 2368.3494; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96990824.0000; val_global_loss: 103207184.0000; val_optim_loss: 103207184.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9179; val_auprc_score: 0.9005; val_best_acc_score: 0.8386; val_best_f1_score: 0.8404; train_kl_reg_loss: 113261.3776; train_edge_recon_loss: 3795968.8056; train_gene_expr_recon_loss: 2095033.0833; train_masked_gp_l1_reg_loss: 2372.9336; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95985365.3333; train_global_loss: 101992000.0000; train_optim_loss: 101992000.0000; val_kl_reg_loss: 66385.8125; val_edge_recon_loss: 3990950.2500; val_gene_expr_recon_loss: 2118568.2500; val_masked_gp_l1_reg_loss: 2376.1895; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96940400.0000; val_global_loss: 103118680.0000; val_optim_loss: 103118680.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9123; val_auprc_score: 0.8928; val_best_acc_score: 0.8324; val_best_f1_score: 0.8302; train_kl_reg_loss: 116075.7318; train_edge_recon_loss: 3794709.1944; train_gene_expr_recon_loss: 2113533.0278; train_masked_gp_l1_reg_loss: 2377.4789; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96641029.3333; train_global_loss: 102667725.3333; train_optim_loss: 102667725.3333; val_kl_reg_loss: 59082.1016; val_edge_recon_loss: 3977186.7500; val_gene_expr_recon_loss: 2118021.2500; val_masked_gp_l1_reg_loss: 2377.0757; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96835752.0000; val_global_loss: 102992416.0000; val_optim_loss: 102992416.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9125; val_auprc_score: 0.8938; val_best_acc_score: 0.8297; val_best_f1_score: 0.8291; train_kl_reg_loss: 68394.8043; train_edge_recon_loss: 3917052.8889; train_gene_expr_recon_loss: 2097536.3750; train_masked_gp_l1_reg_loss: 2377.0704; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96182679.1111; train_global_loss: 102268040.0000; train_optim_loss: 102268040.0000; val_kl_reg_loss: 66386.2266; val_edge_recon_loss: 3974338.2500; val_gene_expr_recon_loss: 2111557.2500; val_masked_gp_l1_reg_loss: 2377.1033; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96828760.0000; val_global_loss: 102983416.0000; val_optim_loss: 102983416.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9086; val_auprc_score: 0.8838; val_best_acc_score: 0.8283; val_best_f1_score: 0.8282; train_kl_reg_loss: 86687.2821; train_edge_recon_loss: 3845769.1389; train_gene_expr_recon_loss: 2083066.0139; train_masked_gp_l1_reg_loss: 2376.9127; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95563362.6667; train_global_loss: 101581261.3333; train_optim_loss: 101581261.3333; val_kl_reg_loss: 80039.1562; val_edge_recon_loss: 3975346.0000; val_gene_expr_recon_loss: 2108342.0000; val_masked_gp_l1_reg_loss: 2376.1887; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96653424.0000; val_global_loss: 102819528.0000; val_optim_loss: 102819528.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9073; val_auprc_score: 0.8838; val_best_acc_score: 0.8243; val_best_f1_score: 0.8229; train_kl_reg_loss: 85037.7977; train_edge_recon_loss: 3797858.3611; train_gene_expr_recon_loss: 2085337.2778; train_masked_gp_l1_reg_loss: 2375.1409; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96023591.1111; train_global_loss: 101994199.1111; train_optim_loss: 101994199.1111; val_kl_reg_loss: 73738.8125; val_edge_recon_loss: 3970550.0000; val_gene_expr_recon_loss: 2111246.2500; val_masked_gp_l1_reg_loss: 2373.9480; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96692200.0000; val_global_loss: 102850112.0000; val_optim_loss: 102850112.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9123; val_auprc_score: 0.8923; val_best_acc_score: 0.8271; val_best_f1_score: 0.8248; train_kl_reg_loss: 88596.0295; train_edge_recon_loss: 3773798.1944; train_gene_expr_recon_loss: 2108075.3889; train_masked_gp_l1_reg_loss: 2373.3614; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96267717.3333; train_global_loss: 102240560.8889; train_optim_loss: 102240560.8889; val_kl_reg_loss: 83537.7500; val_edge_recon_loss: 3967599.5000; val_gene_expr_recon_loss: 2111256.5000; val_masked_gp_l1_reg_loss: 2372.7339; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96895400.0000; val_global_loss: 103060168.0000; val_optim_loss: 103060168.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9120; val_auprc_score: 0.8925; val_best_acc_score: 0.8243; val_best_f1_score: 0.8215; train_kl_reg_loss: 93459.5920; train_edge_recon_loss: 3812183.8056; train_gene_expr_recon_loss: 2097433.9861; train_masked_gp_l1_reg_loss: 2372.3376; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95998652.4444; train_global_loss: 102004102.2222; train_optim_loss: 102004102.2222; val_kl_reg_loss: 82946.8125; val_edge_recon_loss: 3966310.0000; val_gene_expr_recon_loss: 2108961.2500; val_masked_gp_l1_reg_loss: 2371.7759; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96794792.0000; val_global_loss: 102955384.0000; val_optim_loss: 102955384.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9156; val_auprc_score: 0.8988; val_best_acc_score: 0.8278; val_best_f1_score: 0.8234; train_kl_reg_loss: 96011.5495; train_edge_recon_loss: 3787197.9722; train_gene_expr_recon_loss: 2097163.2639; train_masked_gp_l1_reg_loss: 2371.1641; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96202154.6667; train_global_loss: 102184898.6667; train_optim_loss: 102184898.6667; val_kl_reg_loss: 86196.0000; val_edge_recon_loss: 3961600.2500; val_gene_expr_recon_loss: 2109126.0000; val_masked_gp_l1_reg_loss: 2370.2180; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96708336.0000; val_global_loss: 102867632.0000; val_optim_loss: 102867632.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9110; val_auprc_score: 0.8894; val_best_acc_score: 0.8224; val_best_f1_score: 0.8187; train_kl_reg_loss: 97028.9045; train_edge_recon_loss: 3757214.8333; train_gene_expr_recon_loss: 2123661.1250; train_masked_gp_l1_reg_loss: 2370.0820; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97029105.7778; train_global_loss: 103009379.5556; train_optim_loss: 103009379.5556; val_kl_reg_loss: 85628.6953; val_edge_recon_loss: 3960877.7500; val_gene_expr_recon_loss: 2107358.7500; val_masked_gp_l1_reg_loss: 2369.9199; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96652432.0000; val_global_loss: 102808664.0000; val_optim_loss: 102808664.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9132; val_auprc_score: 0.8884; val_best_acc_score: 0.8277; val_best_f1_score: 0.8231; train_kl_reg_loss: 95946.2951; train_edge_recon_loss: 3762674.7778; train_gene_expr_recon_loss: 2099669.2222; train_masked_gp_l1_reg_loss: 2369.8288; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95691941.3333; train_global_loss: 101652601.7778; train_optim_loss: 101652601.7778; val_kl_reg_loss: 83413.1094; val_edge_recon_loss: 3961816.2500; val_gene_expr_recon_loss: 2108455.5000; val_masked_gp_l1_reg_loss: 2369.7109; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96775752.0000; val_global_loss: 102931808.0000; val_optim_loss: 102931808.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9115; val_auprc_score: 0.8884; val_best_acc_score: 0.8266; val_best_f1_score: 0.8220; train_kl_reg_loss: 94259.6849; train_edge_recon_loss: 3762855.6389; train_gene_expr_recon_loss: 2100990.4167; train_masked_gp_l1_reg_loss: 2369.6271; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96140025.7778; train_global_loss: 102100499.5556; train_optim_loss: 102100499.5556; val_kl_reg_loss: 82573.9375; val_edge_recon_loss: 3962127.7500; val_gene_expr_recon_loss: 2107951.5000; val_masked_gp_l1_reg_loss: 2369.5205; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96722360.0000; val_global_loss: 102877384.0000; val_optim_loss: 102877384.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9144; val_auprc_score: 0.8906; val_best_acc_score: 0.8278; val_best_f1_score: 0.8231; train_kl_reg_loss: 93592.8125; train_edge_recon_loss: 3764700.5000; train_gene_expr_recon_loss: 2104208.0000; train_masked_gp_l1_reg_loss: 2369.4302; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95885188.4444; train_global_loss: 101850059.5556; train_optim_loss: 101850059.5556; val_kl_reg_loss: 82498.8672; val_edge_recon_loss: 3957651.2500; val_gene_expr_recon_loss: 2109295.0000; val_masked_gp_l1_reg_loss: 2369.3193; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96706064.0000; val_global_loss: 102857880.0000; val_optim_loss: 102857880.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9093; val_auprc_score: 0.8891; val_best_acc_score: 0.8212; val_best_f1_score: 0.8174; train_kl_reg_loss: 93729.5156; train_edge_recon_loss: 3762556.7500; train_gene_expr_recon_loss: 2093492.1944; train_masked_gp_l1_reg_loss: 2369.2305; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96165844.4444; train_global_loss: 102117992.0000; train_optim_loss: 102117992.0000; val_kl_reg_loss: 82057.2500; val_edge_recon_loss: 3962620.0000; val_gene_expr_recon_loss: 2106949.5000; val_masked_gp_l1_reg_loss: 2369.1216; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96576136.0000; val_global_loss: 102730128.0000; val_optim_loss: 102730128.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9095; val_auprc_score: 0.8847; val_best_acc_score: 0.8223; val_best_f1_score: 0.8183; train_kl_reg_loss: 94371.5269; train_edge_recon_loss: 3758207.3611; train_gene_expr_recon_loss: 2093780.8194; train_masked_gp_l1_reg_loss: 2369.0339; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95789237.3333; train_global_loss: 101737967.1111; train_optim_loss: 101737967.1111; val_kl_reg_loss: 82715.8516; val_edge_recon_loss: 3960321.2500; val_gene_expr_recon_loss: 2107556.2500; val_masked_gp_l1_reg_loss: 2368.9248; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96749960.0000; val_global_loss: 102902920.0000; val_optim_loss: 102902920.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9137; val_auprc_score: 0.8963; val_best_acc_score: 0.8254; val_best_f1_score: 0.8206; train_kl_reg_loss: 93968.1441; train_edge_recon_loss: 3759775.2222; train_gene_expr_recon_loss: 2090787.9028; train_masked_gp_l1_reg_loss: 2368.8346; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95820902.2222; train_global_loss: 101767803.5556; train_optim_loss: 101767803.5556; val_kl_reg_loss: 81766.0234; val_edge_recon_loss: 3958307.0000; val_gene_expr_recon_loss: 2106768.0000; val_masked_gp_l1_reg_loss: 2368.7222; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96537824.0000; val_global_loss: 102687032.0000; val_optim_loss: 102687032.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9100; val_auprc_score: 0.8907; val_best_acc_score: 0.8230; val_best_f1_score: 0.8188; train_kl_reg_loss: 94203.7726; train_edge_recon_loss: 3756494.7222; train_gene_expr_recon_loss: 2091446.0972; train_masked_gp_l1_reg_loss: 2368.6310; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96081049.7778; train_global_loss: 102025563.5556; train_optim_loss: 102025563.5556; val_kl_reg_loss: 83103.1641; val_edge_recon_loss: 3959329.2500; val_gene_expr_recon_loss: 2108154.7500; val_masked_gp_l1_reg_loss: 2368.5144; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96707832.0000; val_global_loss: 102860784.0000; val_optim_loss: 102860784.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9124; val_auprc_score: 0.8942; val_best_acc_score: 0.8234; val_best_f1_score: 0.8190; train_kl_reg_loss: 94733.9653; train_edge_recon_loss: 3752864.7222; train_gene_expr_recon_loss: 2098094.8333; train_masked_gp_l1_reg_loss: 2368.4208; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95693588.4444; train_global_loss: 101641649.7778; train_optim_loss: 101641649.7778; val_kl_reg_loss: 83638.7188; val_edge_recon_loss: 3958251.0000; val_gene_expr_recon_loss: 2109037.0000; val_masked_gp_l1_reg_loss: 2368.3035; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96719368.0000; val_global_loss: 102872664.0000; val_optim_loss: 102872664.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9112; val_auprc_score: 0.8906; val_best_acc_score: 0.8228; val_best_f1_score: 0.8184; train_kl_reg_loss: 95657.3238; train_edge_recon_loss: 3755882.3889; train_gene_expr_recon_loss: 2099040.9028; train_masked_gp_l1_reg_loss: 2368.2118; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95843052.4444; train_global_loss: 101796002.6667; train_optim_loss: 101796002.6667; val_kl_reg_loss: 83639.2031; val_edge_recon_loss: 3959073.5000; val_gene_expr_recon_loss: 2110222.2500; val_masked_gp_l1_reg_loss: 2368.0967; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96793968.0000; val_global_loss: 102949272.0000; val_optim_loss: 102949272.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9186; val_auprc_score: 0.9016; val_best_acc_score: 0.8319; val_best_f1_score: 0.8260; train_kl_reg_loss: 94699.8438; train_edge_recon_loss: 3751809.7222; train_gene_expr_recon_loss: 2101302.0833; train_masked_gp_l1_reg_loss: 2368.0213; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96198760.8889; train_global_loss: 102148939.5556; train_optim_loss: 102148939.5556; val_kl_reg_loss: 82134.6719; val_edge_recon_loss: 3958678.0000; val_gene_expr_recon_loss: 2106794.7500; val_masked_gp_l1_reg_loss: 2367.9199; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96547712.0000; val_global_loss: 102697688.0000; val_optim_loss: 102697688.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9167; val_auprc_score: 0.9002; val_best_acc_score: 0.8267; val_best_f1_score: 0.8217; train_kl_reg_loss: 94180.2031; train_edge_recon_loss: 3751800.8611; train_gene_expr_recon_loss: 2095085.5278; train_masked_gp_l1_reg_loss: 2367.9072; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96377169.7778; train_global_loss: 102320605.3333; train_optim_loss: 102320605.3333; val_kl_reg_loss: 82610.7969; val_edge_recon_loss: 3956237.2500; val_gene_expr_recon_loss: 2107536.0000; val_masked_gp_l1_reg_loss: 2367.8923; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96695160.0000; val_global_loss: 102843912.0000; val_optim_loss: 102843912.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9126; val_auprc_score: 0.8925; val_best_acc_score: 0.8261; val_best_f1_score: 0.8212; train_kl_reg_loss: 93791.6476; train_edge_recon_loss: 3753313.6944; train_gene_expr_recon_loss: 2111572.0417; train_masked_gp_l1_reg_loss: 2367.8810; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95934767.1111; train_global_loss: 101895812.4444; train_optim_loss: 101895812.4444; val_kl_reg_loss: 81996.5859; val_edge_recon_loss: 3957960.2500; val_gene_expr_recon_loss: 2105188.2500; val_masked_gp_l1_reg_loss: 2367.8677; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96552536.0000; val_global_loss: 102700048.0000; val_optim_loss: 102700048.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9117; val_auprc_score: 0.8936; val_best_acc_score: 0.8232; val_best_f1_score: 0.8188; train_kl_reg_loss: 93944.6345; train_edge_recon_loss: 3753410.1944; train_gene_expr_recon_loss: 2076624.9028; train_masked_gp_l1_reg_loss: 2367.8587; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95399072.0000; train_global_loss: 101325420.4444; train_optim_loss: 101325420.4444; val_kl_reg_loss: 82621.7656; val_edge_recon_loss: 3958615.2500; val_gene_expr_recon_loss: 2108757.2500; val_masked_gp_l1_reg_loss: 2367.8464; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96823976.0000; val_global_loss: 102976336.0000; val_optim_loss: 102976336.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9136; val_auprc_score: 0.8943; val_best_acc_score: 0.8262; val_best_f1_score: 0.8212; train_kl_reg_loss: 94317.4557; train_edge_recon_loss: 3755275.7778; train_gene_expr_recon_loss: 2102601.3056; train_masked_gp_l1_reg_loss: 2367.8364; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96259368.8889; train_global_loss: 102213932.4444; train_optim_loss: 102213932.4444; val_kl_reg_loss: 82179.9219; val_edge_recon_loss: 3956082.5000; val_gene_expr_recon_loss: 2108784.7500; val_masked_gp_l1_reg_loss: 2367.8237; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96669112.0000; val_global_loss: 102818528.0000; val_optim_loss: 102818528.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 26 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
Val AUROC score: 0.9141
Val AUPRC score: 0.8963
Val best accuracy score: 0.8269
Val best F1 score: 0.8222
Val gene expr MSE score: 0.4429
Val chrom access MSE score: 0.0877
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
