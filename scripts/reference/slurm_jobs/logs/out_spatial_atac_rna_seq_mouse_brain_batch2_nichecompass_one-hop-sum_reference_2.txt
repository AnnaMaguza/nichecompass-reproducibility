[True]
Run timestamp: 10082023_182707_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6931; val_auprc_score: 0.7298; val_best_acc_score: 0.5038; val_best_f1_score: 0.6682; train_kl_reg_loss: 86292.3725; train_edge_recon_loss: 3658577.5134; train_gene_expr_recon_loss: 27408816.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1386554.2214; train_global_loss: 32540240.9160; train_optim_loss: 32540240.9160; val_kl_reg_loss: 148281.0839; val_edge_recon_loss: 4065279.2833; val_gene_expr_recon_loss: 23329299.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1301885.4583; val_global_loss: 28844744.8000; val_optim_loss: 28844744.8000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7758; val_auprc_score: 0.7909; val_best_acc_score: 0.6555; val_best_f1_score: 0.7248; train_kl_reg_loss: 123430.0470; train_edge_recon_loss: 3600327.2920; train_gene_expr_recon_loss: 23287026.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1291291.0601; train_global_loss: 28302075.0992; train_optim_loss: 28302075.0992; val_kl_reg_loss: 125621.6948; val_edge_recon_loss: 4052662.8000; val_gene_expr_recon_loss: 22441282.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1278481.0083; val_global_loss: 27898047.8667; val_optim_loss: 27898047.8667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7840; val_auprc_score: 0.7885; val_best_acc_score: 0.6993; val_best_f1_score: 0.7259; train_kl_reg_loss: 136422.4388; train_edge_recon_loss: 3538808.7309; train_gene_expr_recon_loss: 22379632.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1269182.7405; train_global_loss: 27324046.5954; train_optim_loss: 27324046.5954; val_kl_reg_loss: 129211.6313; val_edge_recon_loss: 4017073.2000; val_gene_expr_recon_loss: 22091865.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1266920.4917; val_global_loss: 27505070.2667; val_optim_loss: 27505070.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7991; val_auprc_score: 0.8001; val_best_acc_score: 0.7206; val_best_f1_score: 0.7497; train_kl_reg_loss: 116166.7789; train_edge_recon_loss: 3504186.5954; train_gene_expr_recon_loss: 22119385.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1259157.2519; train_global_loss: 26998896.3511; train_optim_loss: 26998896.3511; val_kl_reg_loss: 91408.7151; val_edge_recon_loss: 3744326.2500; val_gene_expr_recon_loss: 21938104.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1262599.4833; val_global_loss: 27036439.3333; val_optim_loss: 27036439.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8131; val_auprc_score: 0.8183; val_best_acc_score: 0.7192; val_best_f1_score: 0.7531; train_kl_reg_loss: 95998.9173; train_edge_recon_loss: 3330165.3053; train_gene_expr_recon_loss: 21965022.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1254069.8559; train_global_loss: 26645257.0076; train_optim_loss: 26645257.0076; val_kl_reg_loss: 99983.3083; val_edge_recon_loss: 3307621.9833; val_gene_expr_recon_loss: 21720595.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1253900.5500; val_global_loss: 26382101.4667; val_optim_loss: 26382101.4667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8242; val_auprc_score: 0.8331; val_best_acc_score: 0.7418; val_best_f1_score: 0.7449; train_kl_reg_loss: 112586.6353; train_edge_recon_loss: 3168331.8969; train_gene_expr_recon_loss: 21827626.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1250045.4599; train_global_loss: 26358590.3511; train_optim_loss: 26358590.3511; val_kl_reg_loss: 110161.2635; val_edge_recon_loss: 3201353.5667; val_gene_expr_recon_loss: 21576891.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1248058.6083; val_global_loss: 26136464.9333; val_optim_loss: 26136464.9333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8442; val_auprc_score: 0.8518; val_best_acc_score: 0.7571; val_best_f1_score: 0.7564; train_kl_reg_loss: 117062.5642; train_edge_recon_loss: 3103315.2042; train_gene_expr_recon_loss: 21673554.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1244697.3989; train_global_loss: 26138629.4046; train_optim_loss: 26138629.4046; val_kl_reg_loss: 111462.6875; val_edge_recon_loss: 3130218.7167; val_gene_expr_recon_loss: 21424480.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1242651.2000; val_global_loss: 25908812.5333; val_optim_loss: 25908812.5333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8582; val_auprc_score: 0.8592; val_best_acc_score: 0.7693; val_best_f1_score: 0.7727; train_kl_reg_loss: 112552.7375; train_edge_recon_loss: 3049058.3435; train_gene_expr_recon_loss: 21523982.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1238781.3788; train_global_loss: 25924374.3359; train_optim_loss: 25924374.3359; val_kl_reg_loss: 118591.1906; val_edge_recon_loss: 3072362.1500; val_gene_expr_recon_loss: 21373492.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1239344.9083; val_global_loss: 25803790.6667; val_optim_loss: 25803790.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9146; val_auprc_score: 0.9044; val_best_acc_score: 0.8378; val_best_f1_score: 0.8463; train_kl_reg_loss: 109673.7545; train_edge_recon_loss: 2939703.1221; train_gene_expr_recon_loss: 21426648.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1234612.9790; train_global_loss: 25710638.1069; train_optim_loss: 25710638.1069; val_kl_reg_loss: 110374.8573; val_edge_recon_loss: 2928812.8333; val_gene_expr_recon_loss: 21318964.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1236655.9000; val_global_loss: 25594808.0000; val_optim_loss: 25594808.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9226; val_auprc_score: 0.9118; val_best_acc_score: 0.8518; val_best_f1_score: 0.8605; train_kl_reg_loss: 117216.3250; train_edge_recon_loss: 2861057.8645; train_gene_expr_recon_loss: 21332748.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1230995.3817; train_global_loss: 25542017.9237; train_optim_loss: 25542017.9237; val_kl_reg_loss: 115411.5432; val_edge_recon_loss: 2870385.5833; val_gene_expr_recon_loss: 21159496.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1229759.5083; val_global_loss: 25375053.4667; val_optim_loss: 25375053.4667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9265; val_auprc_score: 0.9115; val_best_acc_score: 0.8649; val_best_f1_score: 0.8715; train_kl_reg_loss: 117531.0141; train_edge_recon_loss: 2829734.2939; train_gene_expr_recon_loss: 21240361.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1227296.8101; train_global_loss: 25414923.4504; train_optim_loss: 25414923.4504; val_kl_reg_loss: 112145.8474; val_edge_recon_loss: 2843417.3167; val_gene_expr_recon_loss: 21024722.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1223482.0667; val_global_loss: 25203768.0000; val_optim_loss: 25203768.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9317; val_auprc_score: 0.9198; val_best_acc_score: 0.8646; val_best_f1_score: 0.8712; train_kl_reg_loss: 114512.5437; train_edge_recon_loss: 2832218.6088; train_gene_expr_recon_loss: 21158098.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1223412.0382; train_global_loss: 25328241.6947; train_optim_loss: 25328241.6947; val_kl_reg_loss: 110333.7057; val_edge_recon_loss: 2821095.6000; val_gene_expr_recon_loss: 21094528.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1229432.1250; val_global_loss: 25255389.7333; val_optim_loss: 25255389.7333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9325; val_auprc_score: 0.9200; val_best_acc_score: 0.8692; val_best_f1_score: 0.8756; train_kl_reg_loss: 112418.0898; train_edge_recon_loss: 2818755.8282; train_gene_expr_recon_loss: 21110537.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1221661.5754; train_global_loss: 25263372.5954; train_optim_loss: 25263372.5954; val_kl_reg_loss: 109729.2677; val_edge_recon_loss: 2831862.6667; val_gene_expr_recon_loss: 21028509.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1226573.3833; val_global_loss: 25196674.1333; val_optim_loss: 25196674.1333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9408; val_auprc_score: 0.9299; val_best_acc_score: 0.8782; val_best_f1_score: 0.8818; train_kl_reg_loss: 108876.2004; train_edge_recon_loss: 2812198.8015; train_gene_expr_recon_loss: 21063952.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1220593.3044; train_global_loss: 25205620.5954; train_optim_loss: 25205620.5954; val_kl_reg_loss: 104029.6740; val_edge_recon_loss: 2807057.6167; val_gene_expr_recon_loss: 20895243.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1217118.4583; val_global_loss: 25023449.6000; val_optim_loss: 25023449.6000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9448; val_auprc_score: 0.9334; val_best_acc_score: 0.8855; val_best_f1_score: 0.8889; train_kl_reg_loss: 104786.2276; train_edge_recon_loss: 2805726.9485; train_gene_expr_recon_loss: 20984602.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1216487.2948; train_global_loss: 25111603.4656; train_optim_loss: 25111603.4656; val_kl_reg_loss: 100766.1802; val_edge_recon_loss: 2814300.1333; val_gene_expr_recon_loss: 20912896.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1221753.4000; val_global_loss: 25049716.0000; val_optim_loss: 25049716.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9447; val_auprc_score: 0.9321; val_best_acc_score: 0.8856; val_best_f1_score: 0.8908; train_kl_reg_loss: 100933.6707; train_edge_recon_loss: 2792418.2309; train_gene_expr_recon_loss: 20958667.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1215759.9552; train_global_loss: 25067778.8702; train_optim_loss: 25067778.8702; val_kl_reg_loss: 97533.5328; val_edge_recon_loss: 2780999.8000; val_gene_expr_recon_loss: 20856066.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1219589.2250; val_global_loss: 24954188.8000; val_optim_loss: 24954188.8000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9468; val_auprc_score: 0.9337; val_best_acc_score: 0.8855; val_best_f1_score: 0.8896; train_kl_reg_loss: 100082.2767; train_edge_recon_loss: 2776343.2576; train_gene_expr_recon_loss: 20926260.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1213960.1536; train_global_loss: 25016645.9389; train_optim_loss: 25016645.9389; val_kl_reg_loss: 96223.3703; val_edge_recon_loss: 2793372.1500; val_gene_expr_recon_loss: 20860981.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1221145.8417; val_global_loss: 24971722.2667; val_optim_loss: 24971722.2667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9544; val_auprc_score: 0.9416; val_best_acc_score: 0.8967; val_best_f1_score: 0.9012; train_kl_reg_loss: 96753.9107; train_edge_recon_loss: 2775187.7863; train_gene_expr_recon_loss: 20900285.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1214533.7595; train_global_loss: 24986761.5420; train_optim_loss: 24986761.5420; val_kl_reg_loss: 97286.7990; val_edge_recon_loss: 2772171.5333; val_gene_expr_recon_loss: 20757555.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1213652.8417; val_global_loss: 24840666.4000; val_optim_loss: 24840666.4000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9568; val_auprc_score: 0.9472; val_best_acc_score: 0.8985; val_best_f1_score: 0.9016; train_kl_reg_loss: 95136.7610; train_edge_recon_loss: 2762089.7195; train_gene_expr_recon_loss: 20875685.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1212823.7948; train_global_loss: 24945736.2595; train_optim_loss: 24945736.2595; val_kl_reg_loss: 94785.2891; val_edge_recon_loss: 2768250.6167; val_gene_expr_recon_loss: 20735022.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1215799.0750; val_global_loss: 24813857.7333; val_optim_loss: 24813857.7333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9620; val_auprc_score: 0.9537; val_best_acc_score: 0.9041; val_best_f1_score: 0.9082; train_kl_reg_loss: 92561.0945; train_edge_recon_loss: 2753617.8626; train_gene_expr_recon_loss: 20828872.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1211050.9990; train_global_loss: 24886103.0076; train_optim_loss: 24886103.0076; val_kl_reg_loss: 93478.4438; val_edge_recon_loss: 2757180.3000; val_gene_expr_recon_loss: 20782573.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1218413.3500; val_global_loss: 24851645.3333; val_optim_loss: 24851645.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9647; val_auprc_score: 0.9549; val_best_acc_score: 0.9127; val_best_f1_score: 0.9155; train_kl_reg_loss: 91295.1242; train_edge_recon_loss: 2742093.0458; train_gene_expr_recon_loss: 20793512.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1208951.2147; train_global_loss: 24835851.8626; train_optim_loss: 24835851.8626; val_kl_reg_loss: 89880.8505; val_edge_recon_loss: 2727215.2000; val_gene_expr_recon_loss: 20713058.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1212927.6750; val_global_loss: 24743081.6000; val_optim_loss: 24743081.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9632; val_auprc_score: 0.9538; val_best_acc_score: 0.9078; val_best_f1_score: 0.9105; train_kl_reg_loss: 90237.2919; train_edge_recon_loss: 2738415.8454; train_gene_expr_recon_loss: 20769847.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1209446.2786; train_global_loss: 24807946.6260; train_optim_loss: 24807946.6260; val_kl_reg_loss: 92440.4333; val_edge_recon_loss: 2757005.8333; val_gene_expr_recon_loss: 20645820.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1211366.4500; val_global_loss: 24706633.0667; val_optim_loss: 24706633.0667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9650; val_auprc_score: 0.9552; val_best_acc_score: 0.9140; val_best_f1_score: 0.9173; train_kl_reg_loss: 89708.3950; train_edge_recon_loss: 2731346.4313; train_gene_expr_recon_loss: 20768489.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1209956.8836; train_global_loss: 24799501.0992; train_optim_loss: 24799501.0992; val_kl_reg_loss: 88718.0005; val_edge_recon_loss: 2744561.8667; val_gene_expr_recon_loss: 20568528.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1204107.9167; val_global_loss: 24605916.9333; val_optim_loss: 24605916.9333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9673; val_auprc_score: 0.9601; val_best_acc_score: 0.9148; val_best_f1_score: 0.9167; train_kl_reg_loss: 87236.0608; train_edge_recon_loss: 2728312.0019; train_gene_expr_recon_loss: 20727045.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1207827.8387; train_global_loss: 24750421.4504; train_optim_loss: 24750421.4504; val_kl_reg_loss: 85383.8719; val_edge_recon_loss: 2742275.3667; val_gene_expr_recon_loss: 20664533.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1214119.4083; val_global_loss: 24706312.2667; val_optim_loss: 24706312.2667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9683; val_auprc_score: 0.9570; val_best_acc_score: 0.9192; val_best_f1_score: 0.9228; train_kl_reg_loss: 86451.0960; train_edge_recon_loss: 2727352.1469; train_gene_expr_recon_loss: 20705610.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1207958.7557; train_global_loss: 24727372.5649; train_optim_loss: 24727372.5649; val_kl_reg_loss: 84788.4880; val_edge_recon_loss: 2744727.2833; val_gene_expr_recon_loss: 20580342.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1211373.1083; val_global_loss: 24621231.4667; val_optim_loss: 24621231.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9717; val_auprc_score: 0.9633; val_best_acc_score: 0.9232; val_best_f1_score: 0.9258; train_kl_reg_loss: 88793.4874; train_edge_recon_loss: 2753681.4790; train_gene_expr_recon_loss: 21101418.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1234660.6155; train_global_loss: 25178554.4427; train_optim_loss: 25178554.4427; val_kl_reg_loss: 52690.5661; val_edge_recon_loss: 2739760.7667; val_gene_expr_recon_loss: 20987310.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1231480.3417; val_global_loss: 25011241.3333; val_optim_loss: 25011241.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9666; val_auprc_score: 0.9552; val_best_acc_score: 0.9159; val_best_f1_score: 0.9189; train_kl_reg_loss: 88992.4187; train_edge_recon_loss: 2734588.9370; train_gene_expr_recon_loss: 21057769.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1226843.3550; train_global_loss: 25108194.4427; train_optim_loss: 25108194.4427; val_kl_reg_loss: 54690.4172; val_edge_recon_loss: 2756701.7500; val_gene_expr_recon_loss: 20949573.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1226369.7500; val_global_loss: 24987335.6000; val_optim_loss: 24987335.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9696; val_auprc_score: 0.9597; val_best_acc_score: 0.9193; val_best_f1_score: 0.9214; train_kl_reg_loss: 87829.4122; train_edge_recon_loss: 2723588.6756; train_gene_expr_recon_loss: 21025640.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1222924.1317; train_global_loss: 25059982.8702; train_optim_loss: 25059982.8702; val_kl_reg_loss: 55681.1682; val_edge_recon_loss: 2737998.4833; val_gene_expr_recon_loss: 20901054.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1219896.6833; val_global_loss: 24914631.0667; val_optim_loss: 24914631.0667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9668; val_auprc_score: 0.9575; val_best_acc_score: 0.9159; val_best_f1_score: 0.9180; train_kl_reg_loss: 87540.0825; train_edge_recon_loss: 2725119.6240; train_gene_expr_recon_loss: 21063646.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1225699.9151; train_global_loss: 25102005.5573; train_optim_loss: 25102005.5573; val_kl_reg_loss: 55089.9411; val_edge_recon_loss: 2739339.4667; val_gene_expr_recon_loss: 20919190.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1227061.1667; val_global_loss: 24940680.9333; val_optim_loss: 24940680.9333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9673; val_auprc_score: 0.9565; val_best_acc_score: 0.9205; val_best_f1_score: 0.9223; train_kl_reg_loss: 87503.0211; train_edge_recon_loss: 2723039.4580; train_gene_expr_recon_loss: 21057677.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1223651.6794; train_global_loss: 25091871.8168; train_optim_loss: 25091871.8168; val_kl_reg_loss: 55540.9273; val_edge_recon_loss: 2754135.9500; val_gene_expr_recon_loss: 20805123.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1217605.3667; val_global_loss: 24832405.8667; val_optim_loss: 24832405.8667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9699; val_auprc_score: 0.9603; val_best_acc_score: 0.9227; val_best_f1_score: 0.9253; train_kl_reg_loss: 86630.3600; train_edge_recon_loss: 2720437.5344; train_gene_expr_recon_loss: 21040133.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1222483.6975; train_global_loss: 25069684.7023; train_optim_loss: 25069684.7023; val_kl_reg_loss: 56259.1094; val_edge_recon_loss: 2739848.8333; val_gene_expr_recon_loss: 20984062.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1228539.6167; val_global_loss: 25008710.5333; val_optim_loss: 25008710.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 37 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9651
val AUPRC score: 0.9554
val best accuracy score: 0.9109
val best F1 score: 0.9143
val target rna MSE score: 0.9818
val source rna MSE score: 75.7873
val target atac MSE score: 0.5595
val source atac MSE score: 6.0920
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
