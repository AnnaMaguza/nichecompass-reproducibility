[True]
Run timestamp: 26072023_222452_58.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_58']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8739; val_auprc_score: 0.9749; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 341794.7959; train_edge_recon_loss: 1170854.5041; train_gene_expr_recon_loss: 3504406.0180; train_masked_gp_l1_reg_loss: 7256.3985; train_group_lasso_reg_loss: 0.0000; train_global_loss: 5024311.7302; train_optim_loss: 5024311.7302; val_kl_reg_loss: 439839.8451; val_edge_recon_loss: 1180259.0833; val_gene_expr_recon_loss: 3260464.9583; val_masked_gp_l1_reg_loss: 7770.0298; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4888333.9167; val_optim_loss: 4888333.9167
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8714; val_auprc_score: 0.9750; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 301673.0807; train_edge_recon_loss: 1166599.2692; train_gene_expr_recon_loss: 3440317.2337; train_masked_gp_l1_reg_loss: 7799.7258; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4916389.3035; train_optim_loss: 4916389.3035; val_kl_reg_loss: 158691.0911; val_edge_recon_loss: 1193023.5625; val_gene_expr_recon_loss: 2958426.2396; val_masked_gp_l1_reg_loss: 7879.8662; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4318020.8854; val_optim_loss: 4318020.8854
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8763; val_auprc_score: 0.9772; val_best_acc_score: 0.8564; val_best_f1_score: 0.9225; train_kl_reg_loss: 133362.6406; train_edge_recon_loss: 1127991.3544; train_gene_expr_recon_loss: 3139783.9128; train_masked_gp_l1_reg_loss: 8323.0282; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4409460.9256; train_optim_loss: 4409460.9256; val_kl_reg_loss: 63420.7354; val_edge_recon_loss: 1171889.3646; val_gene_expr_recon_loss: 2611536.4896; val_masked_gp_l1_reg_loss: 8820.4844; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3855667.1042; val_optim_loss: 3855667.1042
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8681; val_auprc_score: 0.9741; val_best_acc_score: 0.8615; val_best_f1_score: 0.9249; train_kl_reg_loss: 57721.4552; train_edge_recon_loss: 1072129.7669; train_gene_expr_recon_loss: 1310861.0738; train_masked_gp_l1_reg_loss: 9417.5403; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2450129.8343; train_optim_loss: 2450129.8343; val_kl_reg_loss: 55070.4935; val_edge_recon_loss: 1188268.0182; val_gene_expr_recon_loss: 1026887.1562; val_masked_gp_l1_reg_loss: 9563.4688; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2279789.1667; val_optim_loss: 2279789.1667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8501; val_auprc_score: 0.9703; val_best_acc_score: 0.8604; val_best_f1_score: 0.9231; train_kl_reg_loss: 55928.5218; train_edge_recon_loss: 1071306.9311; train_gene_expr_recon_loss: 1007250.0000; train_masked_gp_l1_reg_loss: 9552.2182; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2144037.6686; train_optim_loss: 2144037.6686; val_kl_reg_loss: 44637.3285; val_edge_recon_loss: 1188711.8880; val_gene_expr_recon_loss: 990724.1406; val_masked_gp_l1_reg_loss: 9552.3672; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2233625.6250; val_optim_loss: 2233625.6250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8384; val_auprc_score: 0.9683; val_best_acc_score: 0.8664; val_best_f1_score: 0.9270; train_kl_reg_loss: 49778.1041; train_edge_recon_loss: 1069581.2985; train_gene_expr_recon_loss: 977917.0474; train_masked_gp_l1_reg_loss: 9583.5571; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2106860.0087; train_optim_loss: 2106860.0087; val_kl_reg_loss: 40743.3034; val_edge_recon_loss: 1164100.7109; val_gene_expr_recon_loss: 964332.5521; val_masked_gp_l1_reg_loss: 9625.5068; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2178802.0677; val_optim_loss: 2178802.0677
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8576; val_auprc_score: 0.9689; val_best_acc_score: 0.8644; val_best_f1_score: 0.9254; train_kl_reg_loss: 41579.1046; train_edge_recon_loss: 1057256.4378; train_gene_expr_recon_loss: 954121.9654; train_masked_gp_l1_reg_loss: 9697.6949; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2062655.1959; train_optim_loss: 2062655.1959; val_kl_reg_loss: 36802.1509; val_edge_recon_loss: 1168013.4271; val_gene_expr_recon_loss: 940877.2656; val_masked_gp_l1_reg_loss: 9791.7021; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2155484.6198; val_optim_loss: 2155484.6198
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8816; val_auprc_score: 0.9737; val_best_acc_score: 0.8980; val_best_f1_score: 0.9426; train_kl_reg_loss: 35362.7201; train_edge_recon_loss: 1004716.9398; train_gene_expr_recon_loss: 932715.3997; train_masked_gp_l1_reg_loss: 9947.7566; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1982742.8105; train_optim_loss: 1982742.8105; val_kl_reg_loss: 36754.6411; val_edge_recon_loss: 909013.5052; val_gene_expr_recon_loss: 925331.5859; val_masked_gp_l1_reg_loss: 10174.0078; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1881273.7344; val_optim_loss: 1881273.7344
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8720; val_auprc_score: 0.9717; val_best_acc_score: 0.9004; val_best_f1_score: 0.9444; train_kl_reg_loss: 42830.5810; train_edge_recon_loss: 904262.7407; train_gene_expr_recon_loss: 914678.2029; train_masked_gp_l1_reg_loss: 10434.2894; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1872205.8105; train_optim_loss: 1872205.8105; val_kl_reg_loss: 42668.6585; val_edge_recon_loss: 865790.1042; val_gene_expr_recon_loss: 905008.8359; val_masked_gp_l1_reg_loss: 10667.8848; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1824135.4792; val_optim_loss: 1824135.4792
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8739; val_auprc_score: 0.9701; val_best_acc_score: 0.9017; val_best_f1_score: 0.9447; train_kl_reg_loss: 40827.8131; train_edge_recon_loss: 887784.3459; train_gene_expr_recon_loss: 896200.2503; train_masked_gp_l1_reg_loss: 10845.9753; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1835658.3779; train_optim_loss: 1835658.3779; val_kl_reg_loss: 37355.7264; val_edge_recon_loss: 867637.8698; val_gene_expr_recon_loss: 888301.5208; val_masked_gp_l1_reg_loss: 10999.0723; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1804294.2344; val_optim_loss: 1804294.2344
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8751; val_auprc_score: 0.9712; val_best_acc_score: 0.8957; val_best_f1_score: 0.9410; train_kl_reg_loss: 35267.8369; train_edge_recon_loss: 859188.2515; train_gene_expr_recon_loss: 880220.8294; train_masked_gp_l1_reg_loss: 11100.7728; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1785777.6895; train_optim_loss: 1785777.6895; val_kl_reg_loss: 32245.0330; val_edge_recon_loss: 868704.5312; val_gene_expr_recon_loss: 873878.8281; val_masked_gp_l1_reg_loss: 11181.3877; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1786009.7708; val_optim_loss: 1786009.7708
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8848; val_auprc_score: 0.9741; val_best_acc_score: 0.8988; val_best_f1_score: 0.9426; train_kl_reg_loss: 30095.1056; train_edge_recon_loss: 838941.1672; train_gene_expr_recon_loss: 866659.3407; train_masked_gp_l1_reg_loss: 11209.2464; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1746904.8640; train_optim_loss: 1746904.8640; val_kl_reg_loss: 26288.3981; val_edge_recon_loss: 853728.3906; val_gene_expr_recon_loss: 860857.8698; val_masked_gp_l1_reg_loss: 11217.4111; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1752092.0312; val_optim_loss: 1752092.0312
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8904; val_auprc_score: 0.9759; val_best_acc_score: 0.9010; val_best_f1_score: 0.9433; train_kl_reg_loss: 24962.8500; train_edge_recon_loss: 832086.3997; train_gene_expr_recon_loss: 855032.4631; train_masked_gp_l1_reg_loss: 11190.2542; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1723271.9657; train_optim_loss: 1723271.9657; val_kl_reg_loss: 22410.7076; val_edge_recon_loss: 823976.0339; val_gene_expr_recon_loss: 849092.5234; val_masked_gp_l1_reg_loss: 11145.3760; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1706624.6562; val_optim_loss: 1706624.6562
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8922; val_auprc_score: 0.9761; val_best_acc_score: 0.9031; val_best_f1_score: 0.9441; train_kl_reg_loss: 21299.4105; train_edge_recon_loss: 820970.2201; train_gene_expr_recon_loss: 843360.8596; train_masked_gp_l1_reg_loss: 11053.6394; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1696684.1267; train_optim_loss: 1696684.1267; val_kl_reg_loss: 18893.4024; val_edge_recon_loss: 839930.0365; val_gene_expr_recon_loss: 838102.1120; val_masked_gp_l1_reg_loss: 10943.5879; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1707869.1771; val_optim_loss: 1707869.1771
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9041; val_auprc_score: 0.9786; val_best_acc_score: 0.9181; val_best_f1_score: 0.9531; train_kl_reg_loss: 17728.7689; train_edge_recon_loss: 816466.2125; train_gene_expr_recon_loss: 833357.0610; train_masked_gp_l1_reg_loss: 10825.5676; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1678377.6093; train_optim_loss: 1678377.6093; val_kl_reg_loss: 14547.6612; val_edge_recon_loss: 833093.5859; val_gene_expr_recon_loss: 827875.0156; val_masked_gp_l1_reg_loss: 10689.6084; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1686205.8854; val_optim_loss: 1686205.8854
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9060; val_auprc_score: 0.9791; val_best_acc_score: 0.9177; val_best_f1_score: 0.9531; train_kl_reg_loss: 15801.3591; train_edge_recon_loss: 807568.4122; train_gene_expr_recon_loss: 823083.1535; train_masked_gp_l1_reg_loss: 10537.7810; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1656990.7047; train_optim_loss: 1656990.7047; val_kl_reg_loss: 14415.5552; val_edge_recon_loss: 820230.4635; val_gene_expr_recon_loss: 817899.2839; val_masked_gp_l1_reg_loss: 10377.6758; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1662922.9323; val_optim_loss: 1662922.9323
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9188; val_auprc_score: 0.9821; val_best_acc_score: 0.9238; val_best_f1_score: 0.9565; train_kl_reg_loss: 14397.7550; train_edge_recon_loss: 799723.0782; train_gene_expr_recon_loss: 813764.1387; train_masked_gp_l1_reg_loss: 10218.5669; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1638103.5297; train_optim_loss: 1638103.5297; val_kl_reg_loss: 13243.2038; val_edge_recon_loss: 802132.4219; val_gene_expr_recon_loss: 809510.2526; val_masked_gp_l1_reg_loss: 10046.1221; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1634932.0260; val_optim_loss: 1634932.0260
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9174; val_auprc_score: 0.9819; val_best_acc_score: 0.9231; val_best_f1_score: 0.9561; train_kl_reg_loss: 13451.7442; train_edge_recon_loss: 797087.7323; train_gene_expr_recon_loss: 805117.5456; train_masked_gp_l1_reg_loss: 9880.4349; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1625537.4547; train_optim_loss: 1625537.4547; val_kl_reg_loss: 13239.0826; val_edge_recon_loss: 811122.2995; val_gene_expr_recon_loss: 801427.6797; val_masked_gp_l1_reg_loss: 9710.4551; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1635499.5625; val_optim_loss: 1635499.5625
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9207; val_auprc_score: 0.9824; val_best_acc_score: 0.9178; val_best_f1_score: 0.9529; train_kl_reg_loss: 12983.8167; train_edge_recon_loss: 788028.4241; train_gene_expr_recon_loss: 797377.9366; train_masked_gp_l1_reg_loss: 9555.1440; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1607945.3244; train_optim_loss: 1607945.3244; val_kl_reg_loss: 12183.6464; val_edge_recon_loss: 824625.7630; val_gene_expr_recon_loss: 794280.1562; val_masked_gp_l1_reg_loss: 9402.5771; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1640492.1875; val_optim_loss: 1640492.1875
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9296; val_auprc_score: 0.9845; val_best_acc_score: 0.9228; val_best_f1_score: 0.9553; train_kl_reg_loss: 11972.5861; train_edge_recon_loss: 790017.5166; train_gene_expr_recon_loss: 790448.0610; train_masked_gp_l1_reg_loss: 9271.8754; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1601710.0360; train_optim_loss: 1601710.0360; val_kl_reg_loss: 11530.9499; val_edge_recon_loss: 808028.8125; val_gene_expr_recon_loss: 787275.9089; val_masked_gp_l1_reg_loss: 9132.2520; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1615967.9375; val_optim_loss: 1615967.9375
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9274; val_auprc_score: 0.9841; val_best_acc_score: 0.9218; val_best_f1_score: 0.9554; train_kl_reg_loss: 11560.5363; train_edge_recon_loss: 800916.8442; train_gene_expr_recon_loss: 784100.4172; train_masked_gp_l1_reg_loss: 9005.5064; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1605583.3023; train_optim_loss: 1605583.3023; val_kl_reg_loss: 10943.1850; val_edge_recon_loss: 779507.4401; val_gene_expr_recon_loss: 781007.3333; val_masked_gp_l1_reg_loss: 8876.6484; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1580334.6042; val_optim_loss: 1580334.6042
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9432; val_auprc_score: 0.9878; val_best_acc_score: 0.9286; val_best_f1_score: 0.9593; train_kl_reg_loss: 11223.5553; train_edge_recon_loss: 784566.0209; train_gene_expr_recon_loss: 777426.0201; train_masked_gp_l1_reg_loss: 8750.9524; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1581966.5483; train_optim_loss: 1581966.5483; val_kl_reg_loss: 10117.2329; val_edge_recon_loss: 775094.3880; val_gene_expr_recon_loss: 773175.5781; val_masked_gp_l1_reg_loss: 8632.1475; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1567019.3281; val_optim_loss: 1567019.3281
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9448; val_auprc_score: 0.9884; val_best_acc_score: 0.9302; val_best_f1_score: 0.9599; train_kl_reg_loss: 10962.3047; train_edge_recon_loss: 792434.7945; train_gene_expr_recon_loss: 770912.6404; train_masked_gp_l1_reg_loss: 8520.0457; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1582829.7866; train_optim_loss: 1582829.7866; val_kl_reg_loss: 10125.1613; val_edge_recon_loss: 786772.5573; val_gene_expr_recon_loss: 766915.6875; val_masked_gp_l1_reg_loss: 8418.0264; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1572231.4010; val_optim_loss: 1572231.4010
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9446; val_auprc_score: 0.9876; val_best_acc_score: 0.9350; val_best_f1_score: 0.9627; train_kl_reg_loss: 10748.7217; train_edge_recon_loss: 782242.7337; train_gene_expr_recon_loss: 764367.9980; train_masked_gp_l1_reg_loss: 8313.1967; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1565672.6506; train_optim_loss: 1565672.6506; val_kl_reg_loss: 10269.4780; val_edge_recon_loss: 790609.8646; val_gene_expr_recon_loss: 761249.8359; val_masked_gp_l1_reg_loss: 8219.6387; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1570348.8125; val_optim_loss: 1570348.8125
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9480; val_auprc_score: 0.9887; val_best_acc_score: 0.9372; val_best_f1_score: 0.9638; train_kl_reg_loss: 10655.0099; train_edge_recon_loss: 783538.0576; train_gene_expr_recon_loss: 758150.3352; train_masked_gp_l1_reg_loss: 8112.5381; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1560455.9477; train_optim_loss: 1560455.9477; val_kl_reg_loss: 10180.1158; val_edge_recon_loss: 781115.6458; val_gene_expr_recon_loss: 754937.7500; val_masked_gp_l1_reg_loss: 8010.6426; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1554244.1354; val_optim_loss: 1554244.1354
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9534; val_auprc_score: 0.9899; val_best_acc_score: 0.9329; val_best_f1_score: 0.9612; train_kl_reg_loss: 10521.7971; train_edge_recon_loss: 773141.1320; train_gene_expr_recon_loss: 752453.0294; train_masked_gp_l1_reg_loss: 7907.0983; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1544023.0581; train_optim_loss: 1544023.0581; val_kl_reg_loss: 9788.5714; val_edge_recon_loss: 801326.3411; val_gene_expr_recon_loss: 749871.8854; val_masked_gp_l1_reg_loss: 7806.9492; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1568793.8229; val_optim_loss: 1568793.8229
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9497; val_auprc_score: 0.9881; val_best_acc_score: 0.9433; val_best_f1_score: 0.9672; train_kl_reg_loss: 10623.5013; train_edge_recon_loss: 776837.9474; train_gene_expr_recon_loss: 747159.8951; train_masked_gp_l1_reg_loss: 7707.2827; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1542328.6297; train_optim_loss: 1542328.6297; val_kl_reg_loss: 10266.2496; val_edge_recon_loss: 792046.7943; val_gene_expr_recon_loss: 743279.0052; val_masked_gp_l1_reg_loss: 7593.7061; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1553185.7917; val_optim_loss: 1553185.7917
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9541; val_auprc_score: 0.9902; val_best_acc_score: 0.9423; val_best_f1_score: 0.9666; train_kl_reg_loss: 10432.2440; train_edge_recon_loss: 776734.5887; train_gene_expr_recon_loss: 742140.2756; train_masked_gp_l1_reg_loss: 7518.6158; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1536825.7233; train_optim_loss: 1536825.7233; val_kl_reg_loss: 10570.3700; val_edge_recon_loss: 779979.8099; val_gene_expr_recon_loss: 739526.8724; val_masked_gp_l1_reg_loss: 7432.2534; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1537509.3125; val_optim_loss: 1537509.3125
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9523; val_auprc_score: 0.9891; val_best_acc_score: 0.9411; val_best_f1_score: 0.9659; train_kl_reg_loss: 10495.5649; train_edge_recon_loss: 773360.8869; train_gene_expr_recon_loss: 737533.3640; train_masked_gp_l1_reg_loss: 7337.6670; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1528727.4849; train_optim_loss: 1528727.4849; val_kl_reg_loss: 10544.2900; val_edge_recon_loss: 788916.1667; val_gene_expr_recon_loss: 736138.7057; val_masked_gp_l1_reg_loss: 7251.2559; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1542850.4062; val_optim_loss: 1542850.4062
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9586; val_auprc_score: 0.9905; val_best_acc_score: 0.9440; val_best_f1_score: 0.9676; train_kl_reg_loss: 10836.2875; train_edge_recon_loss: 781905.3015; train_gene_expr_recon_loss: 733340.5471; train_masked_gp_l1_reg_loss: 7166.1838; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1533248.3209; train_optim_loss: 1533248.3209; val_kl_reg_loss: 10112.1831; val_edge_recon_loss: 773680.5339; val_gene_expr_recon_loss: 731448.0547; val_masked_gp_l1_reg_loss: 7093.2559; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1522334.0365; val_optim_loss: 1522334.0365
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9564; val_auprc_score: 0.9900; val_best_acc_score: 0.9463; val_best_f1_score: 0.9690; train_kl_reg_loss: 10606.4001; train_edge_recon_loss: 764290.2622; train_gene_expr_recon_loss: 729498.8991; train_masked_gp_l1_reg_loss: 7007.1704; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1511402.7297; train_optim_loss: 1511402.7297; val_kl_reg_loss: 10599.0348; val_edge_recon_loss: 772400.6771; val_gene_expr_recon_loss: 726096.2318; val_masked_gp_l1_reg_loss: 6911.0742; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1516007.0677; val_optim_loss: 1516007.0677
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9581; val_auprc_score: 0.9899; val_best_acc_score: 0.9450; val_best_f1_score: 0.9683; train_kl_reg_loss: 10776.9121; train_edge_recon_loss: 768278.5828; train_gene_expr_recon_loss: 725812.1241; train_masked_gp_l1_reg_loss: 6824.4983; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1511692.1198; train_optim_loss: 1511692.1198; val_kl_reg_loss: 10111.8018; val_edge_recon_loss: 788073.8099; val_gene_expr_recon_loss: 724586.1901; val_masked_gp_l1_reg_loss: 6749.1221; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1529520.9219; val_optim_loss: 1529520.9219
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9586; val_auprc_score: 0.9900; val_best_acc_score: 0.9470; val_best_f1_score: 0.9691; train_kl_reg_loss: 10700.2052; train_edge_recon_loss: 773655.5855; train_gene_expr_recon_loss: 722658.4038; train_masked_gp_l1_reg_loss: 6682.5763; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1513696.7756; train_optim_loss: 1513696.7756; val_kl_reg_loss: 10710.9395; val_edge_recon_loss: 798251.3203; val_gene_expr_recon_loss: 721248.3932; val_masked_gp_l1_reg_loss: 6618.8862; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1536829.5312; val_optim_loss: 1536829.5312
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9572; val_auprc_score: 0.9905; val_best_acc_score: 0.9471; val_best_f1_score: 0.9693; train_kl_reg_loss: 10903.5776; train_edge_recon_loss: 772349.8763; train_gene_expr_recon_loss: 719328.4762; train_masked_gp_l1_reg_loss: 6526.8537; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1509108.7843; train_optim_loss: 1509108.7843; val_kl_reg_loss: 10584.2923; val_edge_recon_loss: 771644.1484; val_gene_expr_recon_loss: 718356.6406; val_masked_gp_l1_reg_loss: 6441.8628; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1507026.9427; val_optim_loss: 1507026.9427
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9601; val_auprc_score: 0.9911; val_best_acc_score: 0.9466; val_best_f1_score: 0.9690; train_kl_reg_loss: 10973.2091; train_edge_recon_loss: 767617.9959; train_gene_expr_recon_loss: 716684.6625; train_masked_gp_l1_reg_loss: 6360.7135; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1501636.5872; train_optim_loss: 1501636.5872; val_kl_reg_loss: 10413.4375; val_edge_recon_loss: 798762.8984; val_gene_expr_recon_loss: 714622.4219; val_masked_gp_l1_reg_loss: 6295.0957; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1530093.8646; val_optim_loss: 1530093.8646
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9605; val_auprc_score: 0.9913; val_best_acc_score: 0.9486; val_best_f1_score: 0.9702; train_kl_reg_loss: 10925.1356; train_edge_recon_loss: 769228.8686; train_gene_expr_recon_loss: 714243.6398; train_masked_gp_l1_reg_loss: 6221.4187; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1500619.0593; train_optim_loss: 1500619.0593; val_kl_reg_loss: 10679.3871; val_edge_recon_loss: 769587.5521; val_gene_expr_recon_loss: 712197.7109; val_masked_gp_l1_reg_loss: 6180.2417; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1498644.9062; val_optim_loss: 1498644.9062
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9629; val_auprc_score: 0.9910; val_best_acc_score: 0.9508; val_best_f1_score: 0.9715; train_kl_reg_loss: 10846.1555; train_edge_recon_loss: 775160.8073; train_gene_expr_recon_loss: 712569.2517; train_masked_gp_l1_reg_loss: 6123.1877; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1504699.4093; train_optim_loss: 1504699.4093; val_kl_reg_loss: 10627.8290; val_edge_recon_loss: 789011.9297; val_gene_expr_recon_loss: 710375.0260; val_masked_gp_l1_reg_loss: 6089.1074; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1516103.9115; val_optim_loss: 1516103.9115
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9614; val_auprc_score: 0.9914; val_best_acc_score: 0.9513; val_best_f1_score: 0.9719; train_kl_reg_loss: 10929.7670; train_edge_recon_loss: 766811.8198; train_gene_expr_recon_loss: 709767.0491; train_masked_gp_l1_reg_loss: 6016.6002; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1493525.2326; train_optim_loss: 1493525.2326; val_kl_reg_loss: 10588.4295; val_edge_recon_loss: 767974.0859; val_gene_expr_recon_loss: 708165.4974; val_masked_gp_l1_reg_loss: 5950.6445; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1492678.6354; val_optim_loss: 1492678.6354
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9622; val_auprc_score: 0.9899; val_best_acc_score: 0.9534; val_best_f1_score: 0.9729; train_kl_reg_loss: 10873.7104; train_edge_recon_loss: 770788.5901; train_gene_expr_recon_loss: 707931.6430; train_masked_gp_l1_reg_loss: 5929.7181; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1495523.6517; train_optim_loss: 1495523.6517; val_kl_reg_loss: 10258.5781; val_edge_recon_loss: 786307.4635; val_gene_expr_recon_loss: 706851.2083; val_masked_gp_l1_reg_loss: 5861.0654; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1509278.3542; val_optim_loss: 1509278.3542
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9596; val_auprc_score: 0.9900; val_best_acc_score: 0.9509; val_best_f1_score: 0.9715; train_kl_reg_loss: 10974.4063; train_edge_recon_loss: 770205.4061; train_gene_expr_recon_loss: 706886.7712; train_masked_gp_l1_reg_loss: 5817.1383; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1493883.7262; train_optim_loss: 1493883.7262; val_kl_reg_loss: 10484.1557; val_edge_recon_loss: 805400.6771; val_gene_expr_recon_loss: 704845.7396; val_masked_gp_l1_reg_loss: 5785.4980; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1526516.0677; val_optim_loss: 1526516.0677
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9610; val_auprc_score: 0.9911; val_best_acc_score: 0.9520; val_best_f1_score: 0.9722; train_kl_reg_loss: 10937.7156; train_edge_recon_loss: 769177.3410; train_gene_expr_recon_loss: 705083.7794; train_masked_gp_l1_reg_loss: 5728.3797; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1490927.2198; train_optim_loss: 1490927.2198; val_kl_reg_loss: 10293.0255; val_edge_recon_loss: 780041.6562; val_gene_expr_recon_loss: 704258.0677; val_masked_gp_l1_reg_loss: 5704.5483; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1500297.2552; val_optim_loss: 1500297.2552
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9638; val_auprc_score: 0.9917; val_best_acc_score: 0.9507; val_best_f1_score: 0.9714; train_kl_reg_loss: 10906.3722; train_edge_recon_loss: 774177.8233; train_gene_expr_recon_loss: 703458.2358; train_masked_gp_l1_reg_loss: 5641.4574; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1494183.8843; train_optim_loss: 1494183.8843; val_kl_reg_loss: 10633.6630; val_edge_recon_loss: 782842.4531; val_gene_expr_recon_loss: 702156.7812; val_masked_gp_l1_reg_loss: 5612.0020; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1501244.8854; val_optim_loss: 1501244.8854

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9565; val_auprc_score: 0.9891; val_best_acc_score: 0.9516; val_best_f1_score: 0.9719; train_kl_reg_loss: 10771.8872; train_edge_recon_loss: 760460.4983; train_gene_expr_recon_loss: 701108.5073; train_masked_gp_l1_reg_loss: 5546.5542; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1477887.4442; train_optim_loss: 1477887.4442; val_kl_reg_loss: 10481.9120; val_edge_recon_loss: 787854.0156; val_gene_expr_recon_loss: 699605.8333; val_masked_gp_l1_reg_loss: 5525.5391; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1503467.2448; val_optim_loss: 1503467.2448
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9627; val_auprc_score: 0.9913; val_best_acc_score: 0.9546; val_best_f1_score: 0.9738; train_kl_reg_loss: 10854.3105; train_edge_recon_loss: 768491.1797; train_gene_expr_recon_loss: 700413.7326; train_masked_gp_l1_reg_loss: 5516.9589; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1485276.1826; train_optim_loss: 1485276.1826; val_kl_reg_loss: 10559.9421; val_edge_recon_loss: 778441.4661; val_gene_expr_recon_loss: 699931.9948; val_masked_gp_l1_reg_loss: 5509.3994; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1494442.7865; val_optim_loss: 1494442.7865
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9633; val_auprc_score: 0.9913; val_best_acc_score: 0.9538; val_best_f1_score: 0.9731; train_kl_reg_loss: 10798.6425; train_edge_recon_loss: 766489.2919; train_gene_expr_recon_loss: 700599.6108; train_masked_gp_l1_reg_loss: 5505.0460; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1483392.5924; train_optim_loss: 1483392.5924; val_kl_reg_loss: 10430.8632; val_edge_recon_loss: 793921.3802; val_gene_expr_recon_loss: 699613.8203; val_masked_gp_l1_reg_loss: 5502.9922; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1509469.0573; val_optim_loss: 1509469.0573
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9635; val_auprc_score: 0.9913; val_best_acc_score: 0.9545; val_best_f1_score: 0.9736; train_kl_reg_loss: 10770.3446; train_edge_recon_loss: 767417.9654; train_gene_expr_recon_loss: 700024.1858; train_masked_gp_l1_reg_loss: 5503.3075; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1483715.8081; train_optim_loss: 1483715.8081; val_kl_reg_loss: 10469.0358; val_edge_recon_loss: 784875.0312; val_gene_expr_recon_loss: 699152.4115; val_masked_gp_l1_reg_loss: 5503.8135; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1500000.3333; val_optim_loss: 1500000.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 66 min 55 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9604
Val AUPRC score: 0.9911
Val best accuracy score: 0.9497
Val best F1 score: 0.9709
Val gene expr MSE score: 232549.2022
Val cat covariate0 mean sim diff: -0.0026

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
