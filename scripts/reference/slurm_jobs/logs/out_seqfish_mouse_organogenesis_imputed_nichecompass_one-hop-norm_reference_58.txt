[True]
Run timestamp: 01082023_084750_58.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_58']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9063; val_auprc_score: 0.9818; val_best_acc_score: 0.8543; val_best_f1_score: 0.9214; train_kl_reg_loss: 50486.9992; train_edge_recon_loss: 116309.6461; train_gene_expr_recon_loss: 5014723.4398; train_masked_gp_l1_reg_loss: 6737.7932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117694.2120; train_global_loss: 5305952.0463; train_optim_loss: 5305952.0463; val_kl_reg_loss: 85128.5078; val_edge_recon_loss: 118491.7240; val_gene_expr_recon_loss: 4037509.5833; val_masked_gp_l1_reg_loss: 6778.1963; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108886.5625; val_global_loss: 4356794.3333; val_optim_loss: 4356794.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8934; val_auprc_score: 0.9793; val_best_acc_score: 0.8509; val_best_f1_score: 0.9194; train_kl_reg_loss: 79079.1542; train_edge_recon_loss: 118843.1726; train_gene_expr_recon_loss: 3759776.8889; train_masked_gp_l1_reg_loss: 6314.1211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101630.8607; train_global_loss: 4065644.1944; train_optim_loss: 4065644.1944; val_kl_reg_loss: 69100.5404; val_edge_recon_loss: 121280.0820; val_gene_expr_recon_loss: 3380746.5000; val_masked_gp_l1_reg_loss: 5853.3555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94649.9219; val_global_loss: 3671630.3333; val_optim_loss: 3671630.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8663; val_auprc_score: 0.9744; val_best_acc_score: 0.8641; val_best_f1_score: 0.9265; train_kl_reg_loss: 66776.2035; train_edge_recon_loss: 118621.3890; train_gene_expr_recon_loss: 2920877.6250; train_masked_gp_l1_reg_loss: 5527.8458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88991.5255; train_global_loss: 3200794.5926; train_optim_loss: 3200794.5926; val_kl_reg_loss: 59527.9310; val_edge_recon_loss: 115644.1966; val_gene_expr_recon_loss: 2511061.3750; val_masked_gp_l1_reg_loss: 5261.6230; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83622.8125; val_global_loss: 2775117.7500; val_optim_loss: 2775117.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8463; val_auprc_score: 0.9677; val_best_acc_score: 0.8679; val_best_f1_score: 0.9265; train_kl_reg_loss: 58177.3291; train_edge_recon_loss: 117449.2891; train_gene_expr_recon_loss: 2363109.2222; train_masked_gp_l1_reg_loss: 5122.3320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79316.3817; train_global_loss: 2623174.5324; train_optim_loss: 2623174.5324; val_kl_reg_loss: 52595.3353; val_edge_recon_loss: 122036.5742; val_gene_expr_recon_loss: 2271325.5000; val_masked_gp_l1_reg_loss: 5028.9912; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75300.2500; val_global_loss: 2526286.7083; val_optim_loss: 2526286.7083
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8412; val_auprc_score: 0.9657; val_best_acc_score: 0.8683; val_best_f1_score: 0.9277; train_kl_reg_loss: 51145.7098; train_edge_recon_loss: 117434.3368; train_gene_expr_recon_loss: 2241070.5741; train_masked_gp_l1_reg_loss: 4994.7271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72345.1555; train_global_loss: 2486990.5231; train_optim_loss: 2486990.5231; val_kl_reg_loss: 46111.4766; val_edge_recon_loss: 120963.8451; val_gene_expr_recon_loss: 2209654.5833; val_masked_gp_l1_reg_loss: 4982.2368; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69766.9609; val_global_loss: 2451479.2083; val_optim_loss: 2451479.2083
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8455; val_auprc_score: 0.9674; val_best_acc_score: 0.8788; val_best_f1_score: 0.9332; train_kl_reg_loss: 45517.0998; train_edge_recon_loss: 116847.8600; train_gene_expr_recon_loss: 2198151.7824; train_masked_gp_l1_reg_loss: 5003.1509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68230.0142; train_global_loss: 2433749.8935; train_optim_loss: 2433749.8935; val_kl_reg_loss: 41369.2559; val_edge_recon_loss: 117931.3932; val_gene_expr_recon_loss: 2178233.9583; val_masked_gp_l1_reg_loss: 5040.3389; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67083.3516; val_global_loss: 2409658.1667; val_optim_loss: 2409658.1667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8628; val_auprc_score: 0.9701; val_best_acc_score: 0.8811; val_best_f1_score: 0.9342; train_kl_reg_loss: 41362.1711; train_edge_recon_loss: 115003.3137; train_gene_expr_recon_loss: 2168608.3657; train_masked_gp_l1_reg_loss: 5096.3332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66246.7436; train_global_loss: 2396316.9259; train_optim_loss: 2396316.9259; val_kl_reg_loss: 38211.9701; val_edge_recon_loss: 117334.2240; val_gene_expr_recon_loss: 2150034.8333; val_masked_gp_l1_reg_loss: 5165.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65378.6406; val_global_loss: 2376125.5000; val_optim_loss: 2376125.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8695; val_auprc_score: 0.9724; val_best_acc_score: 0.8868; val_best_f1_score: 0.9368; train_kl_reg_loss: 38392.0221; train_edge_recon_loss: 115230.3909; train_gene_expr_recon_loss: 2144610.6759; train_masked_gp_l1_reg_loss: 5234.6140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64518.8414; train_global_loss: 2367986.5926; train_optim_loss: 2367986.5926; val_kl_reg_loss: 35919.3783; val_edge_recon_loss: 113440.6693; val_gene_expr_recon_loss: 2129800.0417; val_masked_gp_l1_reg_loss: 5309.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63613.3203; val_global_loss: 2348082.8333; val_optim_loss: 2348082.8333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8728; val_auprc_score: 0.9720; val_best_acc_score: 0.8855; val_best_f1_score: 0.9360; train_kl_reg_loss: 36154.9661; train_edge_recon_loss: 113879.6211; train_gene_expr_recon_loss: 2122877.9444; train_masked_gp_l1_reg_loss: 5382.3122; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62722.5883; train_global_loss: 2341017.4306; train_optim_loss: 2341017.4306; val_kl_reg_loss: 33865.2923; val_edge_recon_loss: 114181.2487; val_gene_expr_recon_loss: 2109550.6667; val_masked_gp_l1_reg_loss: 5460.1128; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61789.2188; val_global_loss: 2324846.4167; val_optim_loss: 2324846.4167
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8797; val_auprc_score: 0.9743; val_best_acc_score: 0.8898; val_best_f1_score: 0.9379; train_kl_reg_loss: 34313.0076; train_edge_recon_loss: 111858.6675; train_gene_expr_recon_loss: 2104087.0000; train_masked_gp_l1_reg_loss: 5528.1805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60877.5062; train_global_loss: 2316664.3519; train_optim_loss: 2316664.3519; val_kl_reg_loss: 32339.9349; val_edge_recon_loss: 111648.9688; val_gene_expr_recon_loss: 2089877.6667; val_masked_gp_l1_reg_loss: 5601.5596; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59926.1641; val_global_loss: 2299394.3333; val_optim_loss: 2299394.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8886; val_auprc_score: 0.9760; val_best_acc_score: 0.8963; val_best_f1_score: 0.9408; train_kl_reg_loss: 32781.5693; train_edge_recon_loss: 111685.6671; train_gene_expr_recon_loss: 2086159.0972; train_masked_gp_l1_reg_loss: 5666.5493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59004.6298; train_global_loss: 2295297.5324; train_optim_loss: 2295297.5324; val_kl_reg_loss: 31003.3949; val_edge_recon_loss: 109763.2292; val_gene_expr_recon_loss: 2073567.9583; val_masked_gp_l1_reg_loss: 5740.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58046.8555; val_global_loss: 2278122.3333; val_optim_loss: 2278122.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8928; val_auprc_score: 0.9769; val_best_acc_score: 0.8949; val_best_f1_score: 0.9399; train_kl_reg_loss: 31490.6796; train_edge_recon_loss: 110447.6114; train_gene_expr_recon_loss: 2069792.6852; train_masked_gp_l1_reg_loss: 5807.1205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57129.6487; train_global_loss: 2274667.7593; train_optim_loss: 2274667.7593; val_kl_reg_loss: 29920.9167; val_edge_recon_loss: 112637.8893; val_gene_expr_recon_loss: 2058743.4792; val_masked_gp_l1_reg_loss: 5885.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56184.4883; val_global_loss: 2263372.2917; val_optim_loss: 2263372.2917
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8947; val_auprc_score: 0.9770; val_best_acc_score: 0.9007; val_best_f1_score: 0.9439; train_kl_reg_loss: 30456.8512; train_edge_recon_loss: 108631.9294; train_gene_expr_recon_loss: 2053784.3194; train_masked_gp_l1_reg_loss: 5957.2337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55290.6202; train_global_loss: 2254120.9583; train_optim_loss: 2254120.9583; val_kl_reg_loss: 29142.1631; val_edge_recon_loss: 109015.6237; val_gene_expr_recon_loss: 2043544.7917; val_masked_gp_l1_reg_loss: 6038.0913; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54372.0625; val_global_loss: 2242112.5417; val_optim_loss: 2242112.5417
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9035; val_auprc_score: 0.9792; val_best_acc_score: 0.9058; val_best_f1_score: 0.9461; train_kl_reg_loss: 29597.3961; train_edge_recon_loss: 107511.7681; train_gene_expr_recon_loss: 2038349.3588; train_masked_gp_l1_reg_loss: 6109.6337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53512.6008; train_global_loss: 2235080.7685; train_optim_loss: 2235080.7685; val_kl_reg_loss: 28136.2145; val_edge_recon_loss: 107857.6120; val_gene_expr_recon_loss: 2024878.0833; val_masked_gp_l1_reg_loss: 6186.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52634.0312; val_global_loss: 2219692.1667; val_optim_loss: 2219692.1667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9121; val_auprc_score: 0.9807; val_best_acc_score: 0.9063; val_best_f1_score: 0.9463; train_kl_reg_loss: 28835.1590; train_edge_recon_loss: 106998.0187; train_gene_expr_recon_loss: 2022506.3287; train_masked_gp_l1_reg_loss: 6258.2020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51821.9418; train_global_loss: 2216419.6204; train_optim_loss: 2216419.6204; val_kl_reg_loss: 27532.1234; val_edge_recon_loss: 109541.1419; val_gene_expr_recon_loss: 2010388.5208; val_masked_gp_l1_reg_loss: 6332.4160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50992.8984; val_global_loss: 2204787.2917; val_optim_loss: 2204787.2917
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9109; val_auprc_score: 0.9810; val_best_acc_score: 0.9097; val_best_f1_score: 0.9484; train_kl_reg_loss: 28183.2652; train_edge_recon_loss: 105704.5286; train_gene_expr_recon_loss: 2007366.3310; train_masked_gp_l1_reg_loss: 6400.5617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50216.4585; train_global_loss: 2197871.1528; train_optim_loss: 2197871.1528; val_kl_reg_loss: 26983.1566; val_edge_recon_loss: 106034.9857; val_gene_expr_recon_loss: 1995979.8750; val_masked_gp_l1_reg_loss: 6476.8809; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49421.6406; val_global_loss: 2184896.7500; val_optim_loss: 2184896.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9166; val_auprc_score: 0.9820; val_best_acc_score: 0.9149; val_best_f1_score: 0.9515; train_kl_reg_loss: 27551.3489; train_edge_recon_loss: 104207.4255; train_gene_expr_recon_loss: 1992116.4792; train_masked_gp_l1_reg_loss: 6542.4693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48671.4122; train_global_loss: 2179089.1435; train_optim_loss: 2179089.1435; val_kl_reg_loss: 26267.0023; val_edge_recon_loss: 102624.6784; val_gene_expr_recon_loss: 1984051.8333; val_masked_gp_l1_reg_loss: 6614.1841; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47900.7031; val_global_loss: 2167458.5000; val_optim_loss: 2167458.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9225; val_auprc_score: 0.9832; val_best_acc_score: 0.9176; val_best_f1_score: 0.9529; train_kl_reg_loss: 26994.2248; train_edge_recon_loss: 103997.9113; train_gene_expr_recon_loss: 1977967.6111; train_masked_gp_l1_reg_loss: 6675.8145; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47172.8254; train_global_loss: 2162808.3843; train_optim_loss: 2162808.3843; val_kl_reg_loss: 25823.8027; val_edge_recon_loss: 103897.7669; val_gene_expr_recon_loss: 1963932.8542; val_masked_gp_l1_reg_loss: 6745.8623; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46424.5898; val_global_loss: 2146824.7917; val_optim_loss: 2146824.7917
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9202; val_auprc_score: 0.9826; val_best_acc_score: 0.9210; val_best_f1_score: 0.9547; train_kl_reg_loss: 26504.7964; train_edge_recon_loss: 102425.6476; train_gene_expr_recon_loss: 1963771.0648; train_masked_gp_l1_reg_loss: 6806.9604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45712.1604; train_global_loss: 2145220.6065; train_optim_loss: 2145220.6065; val_kl_reg_loss: 25412.6921; val_edge_recon_loss: 101128.0807; val_gene_expr_recon_loss: 1951583.8125; val_masked_gp_l1_reg_loss: 6875.9204; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44976.5195; val_global_loss: 2129977.0000; val_optim_loss: 2129977.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9274; val_auprc_score: 0.9837; val_best_acc_score: 0.9235; val_best_f1_score: 0.9561; train_kl_reg_loss: 26012.9860; train_edge_recon_loss: 102285.3964; train_gene_expr_recon_loss: 1950061.1736; train_masked_gp_l1_reg_loss: 6935.5209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44278.2525; train_global_loss: 2129573.3333; train_optim_loss: 2129573.3333; val_kl_reg_loss: 24876.2949; val_edge_recon_loss: 101074.6263; val_gene_expr_recon_loss: 1939596.3333; val_masked_gp_l1_reg_loss: 7002.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43558.4297; val_global_loss: 2116108.0417; val_optim_loss: 2116108.0417
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9212; val_auprc_score: 0.9820; val_best_acc_score: 0.9202; val_best_f1_score: 0.9545; train_kl_reg_loss: 25488.7137; train_edge_recon_loss: 101842.1814; train_gene_expr_recon_loss: 1936847.2269; train_masked_gp_l1_reg_loss: 7060.5686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42875.4685; train_global_loss: 2114114.1620; train_optim_loss: 2114114.1620; val_kl_reg_loss: 24562.8301; val_edge_recon_loss: 102093.8672; val_gene_expr_recon_loss: 1925531.5417; val_masked_gp_l1_reg_loss: 7124.9590; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42169.1484; val_global_loss: 2101482.3958; val_optim_loss: 2101482.3958
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9319; val_auprc_score: 0.9860; val_best_acc_score: 0.9258; val_best_f1_score: 0.9577; train_kl_reg_loss: 25019.2922; train_edge_recon_loss: 100412.9835; train_gene_expr_recon_loss: 1924869.7222; train_masked_gp_l1_reg_loss: 7182.4545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41503.0455; train_global_loss: 2098987.4907; train_optim_loss: 2098987.4907; val_kl_reg_loss: 23959.0381; val_edge_recon_loss: 99278.6445; val_gene_expr_recon_loss: 1916421.6667; val_masked_gp_l1_reg_loss: 7246.7134; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40823.4258; val_global_loss: 2087729.4583; val_optim_loss: 2087729.4583
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9276; val_auprc_score: 0.9839; val_best_acc_score: 0.9248; val_best_f1_score: 0.9569; train_kl_reg_loss: 24570.4243; train_edge_recon_loss: 100040.4922; train_gene_expr_recon_loss: 1912856.6829; train_masked_gp_l1_reg_loss: 7299.9349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40183.1881; train_global_loss: 2084950.7222; train_optim_loss: 2084950.7222; val_kl_reg_loss: 23328.3249; val_edge_recon_loss: 102028.5716; val_gene_expr_recon_loss: 1902178.5417; val_masked_gp_l1_reg_loss: 7363.9009; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39530.4531; val_global_loss: 2074429.8333; val_optim_loss: 2074429.8333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9311; val_auprc_score: 0.9849; val_best_acc_score: 0.9259; val_best_f1_score: 0.9572; train_kl_reg_loss: 24180.2036; train_edge_recon_loss: 100065.6872; train_gene_expr_recon_loss: 1901327.7037; train_masked_gp_l1_reg_loss: 7412.7685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38915.2946; train_global_loss: 2071901.6644; train_optim_loss: 2071901.6644; val_kl_reg_loss: 23186.3099; val_edge_recon_loss: 101460.8190; val_gene_expr_recon_loss: 1891656.8125; val_masked_gp_l1_reg_loss: 7471.5801; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38286.9219; val_global_loss: 2062062.4375; val_optim_loss: 2062062.4375
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9386; val_auprc_score: 0.9870; val_best_acc_score: 0.9281; val_best_f1_score: 0.9587; train_kl_reg_loss: 23663.5480; train_edge_recon_loss: 98139.2190; train_gene_expr_recon_loss: 1889833.2153; train_masked_gp_l1_reg_loss: 7519.2064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37697.0160; train_global_loss: 2056852.2106; train_optim_loss: 2056852.2106; val_kl_reg_loss: 22671.3076; val_edge_recon_loss: 100604.9961; val_gene_expr_recon_loss: 1880668.1667; val_masked_gp_l1_reg_loss: 7573.7378; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37092.5430; val_global_loss: 2048610.7500; val_optim_loss: 2048610.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9015; val_auprc_score: 0.9796; val_best_acc_score: 0.8913; val_best_f1_score: 0.9380; train_kl_reg_loss: 20022.3885; train_edge_recon_loss: 113968.2543; train_gene_expr_recon_loss: 3602211.8611; train_masked_gp_l1_reg_loss: 9101.6477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36122.5566; train_global_loss: 3781426.6806; train_optim_loss: 3781426.6806; val_kl_reg_loss: 17132.0195; val_edge_recon_loss: 115423.8060; val_gene_expr_recon_loss: 3167730.7500; val_masked_gp_l1_reg_loss: 9393.4238; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35026.8477; val_global_loss: 3344706.8333; val_optim_loss: 3344706.8333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8960; val_auprc_score: 0.9771; val_best_acc_score: 0.8973; val_best_f1_score: 0.9420; train_kl_reg_loss: 18348.3062; train_edge_recon_loss: 111043.8961; train_gene_expr_recon_loss: 2923047.3241; train_masked_gp_l1_reg_loss: 9235.2312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33999.0054; train_global_loss: 3095673.7130; train_optim_loss: 3095673.7130; val_kl_reg_loss: 16701.9863; val_edge_recon_loss: 109445.4818; val_gene_expr_recon_loss: 2697161.1250; val_masked_gp_l1_reg_loss: 9119.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32956.5781; val_global_loss: 2865384.7917; val_optim_loss: 2865384.7917
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9070; val_auprc_score: 0.9803; val_best_acc_score: 0.9002; val_best_f1_score: 0.9432; train_kl_reg_loss: 17532.5645; train_edge_recon_loss: 106819.6765; train_gene_expr_recon_loss: 2545845.1991; train_masked_gp_l1_reg_loss: 9068.7294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31995.9359; train_global_loss: 2711262.1065; train_optim_loss: 2711262.1065; val_kl_reg_loss: 16456.2445; val_edge_recon_loss: 105456.9779; val_gene_expr_recon_loss: 2400290.8750; val_masked_gp_l1_reg_loss: 9034.2910; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31020.6348; val_global_loss: 2562259.1667; val_optim_loss: 2562259.1667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9067; val_auprc_score: 0.9796; val_best_acc_score: 0.8999; val_best_f1_score: 0.9434; train_kl_reg_loss: 17338.2819; train_edge_recon_loss: 102580.8870; train_gene_expr_recon_loss: 2312950.4120; train_masked_gp_l1_reg_loss: 9025.1574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30119.6606; train_global_loss: 2472014.4028; train_optim_loss: 2472014.4028; val_kl_reg_loss: 16120.1597; val_edge_recon_loss: 101162.7760; val_gene_expr_recon_loss: 2222126.8333; val_masked_gp_l1_reg_loss: 9025.6895; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29203.3945; val_global_loss: 2377638.9583; val_optim_loss: 2377638.9583

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9049; val_auprc_score: 0.9795; val_best_acc_score: 0.8994; val_best_f1_score: 0.9435; train_kl_reg_loss: 16964.5421; train_edge_recon_loss: 100235.6824; train_gene_expr_recon_loss: 2221390.0463; train_masked_gp_l1_reg_loss: 9009.6791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29077.5360; train_global_loss: 2376677.4861; train_optim_loss: 2376677.4861; val_kl_reg_loss: 15948.3613; val_edge_recon_loss: 101687.0990; val_gene_expr_recon_loss: 2207789.1667; val_masked_gp_l1_reg_loss: 9005.0762; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28977.7637; val_global_loss: 2363407.3750; val_optim_loss: 2363407.3750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9074; val_auprc_score: 0.9800; val_best_acc_score: 0.9026; val_best_f1_score: 0.9445; train_kl_reg_loss: 16846.4218; train_edge_recon_loss: 98795.0987; train_gene_expr_recon_loss: 2209187.4537; train_masked_gp_l1_reg_loss: 9004.8648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28888.1213; train_global_loss: 2362721.9815; train_optim_loss: 2362721.9815; val_kl_reg_loss: 15815.4810; val_edge_recon_loss: 101069.9492; val_gene_expr_recon_loss: 2196307.7083; val_masked_gp_l1_reg_loss: 9005.1191; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28794.6895; val_global_loss: 2350992.8750; val_optim_loss: 2350992.8750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9143; val_auprc_score: 0.9824; val_best_acc_score: 0.9069; val_best_f1_score: 0.9473; train_kl_reg_loss: 16760.2184; train_edge_recon_loss: 99418.1198; train_gene_expr_recon_loss: 2197920.9537; train_masked_gp_l1_reg_loss: 9005.6935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28703.5636; train_global_loss: 2351808.5417; train_optim_loss: 2351808.5417; val_kl_reg_loss: 15775.2209; val_edge_recon_loss: 97539.0482; val_gene_expr_recon_loss: 2183509.0833; val_masked_gp_l1_reg_loss: 9006.5498; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28608.4180; val_global_loss: 2334438.3333; val_optim_loss: 2334438.3333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9072; val_auprc_score: 0.9794; val_best_acc_score: 0.9037; val_best_f1_score: 0.9453; train_kl_reg_loss: 16685.3084; train_edge_recon_loss: 99514.4722; train_gene_expr_recon_loss: 2187037.6713; train_masked_gp_l1_reg_loss: 9007.3461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28515.2342; train_global_loss: 2340760.0324; train_optim_loss: 2340760.0324; val_kl_reg_loss: 15691.7062; val_edge_recon_loss: 98936.5443; val_gene_expr_recon_loss: 2176019.7083; val_masked_gp_l1_reg_loss: 9008.1895; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28417.8906; val_global_loss: 2328074.2083; val_optim_loss: 2328074.2083

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 55 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9298
val AUPRC score: 0.9842
val best accuracy score: 0.9249
val best F1 score: 0.9572
val target rna MSE score: 27.5301
val source rna MSE score: 163.5174
Val cat covariate0 mean sim diff: -0.0041

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
