[True]
Run timestamp: 07092023_021649_239.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_239']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2363 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5088, n_cat_covariates_embed_input: 0, n_hidden: 2312, n_latent: 2212, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2363
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2363

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8006; val_auprc_score: 0.8158; val_best_acc_score: 0.5167; val_best_f1_score: 0.6733; train_kl_reg_loss: 75984.1971; train_edge_recon_loss: 3533086.0744; train_gene_expr_recon_loss: 12674058.0840; train_masked_gp_l1_reg_loss: 31269.5773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3075905.8690; train_chrom_access_recon_loss: 10658943.2977; train_global_loss: 30049247.3588; train_optim_loss: 30049247.3588; val_kl_reg_loss: 89385.3901; val_edge_recon_loss: 4063811.6000; val_gene_expr_recon_loss: 11675407.4667; val_masked_gp_l1_reg_loss: 28078.9727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 238479.6406; val_chrom_access_recon_loss: 10270729.2000; val_global_loss: 26365892.5333; val_optim_loss: 26365892.5333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8654; val_auprc_score: 0.8675; val_best_acc_score: 0.7867; val_best_f1_score: 0.7713; train_kl_reg_loss: 92339.1289; train_edge_recon_loss: 3515348.6565; train_gene_expr_recon_loss: 11763504.7481; train_masked_gp_l1_reg_loss: 27529.2861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155202.5798; train_chrom_access_recon_loss: 10222853.8473; train_global_loss: 25776778.2748; train_optim_loss: 25776778.2748; val_kl_reg_loss: 75541.0604; val_edge_recon_loss: 4005493.0500; val_gene_expr_recon_loss: 11516679.5333; val_masked_gp_l1_reg_loss: 28375.1895; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120910.8125; val_chrom_access_recon_loss: 10162301.4000; val_global_loss: 25909301.0667; val_optim_loss: 25909301.0667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8829; val_auprc_score: 0.8697; val_best_acc_score: 0.8015; val_best_f1_score: 0.8145; train_kl_reg_loss: 73750.1163; train_edge_recon_loss: 3290799.0802; train_gene_expr_recon_loss: 11601815.8321; train_masked_gp_l1_reg_loss: 30892.8570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108832.8496; train_chrom_access_recon_loss: 10068601.4885; train_global_loss: 25174692.2748; train_optim_loss: 25174692.2748; val_kl_reg_loss: 87655.3974; val_edge_recon_loss: 3016908.1167; val_gene_expr_recon_loss: 11337014.6000; val_masked_gp_l1_reg_loss: 33642.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100947.0234; val_chrom_access_recon_loss: 9981996.6667; val_global_loss: 24558163.7333; val_optim_loss: 24558163.7333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9151; val_auprc_score: 0.8985; val_best_acc_score: 0.8401; val_best_f1_score: 0.8495; train_kl_reg_loss: 96203.0039; train_edge_recon_loss: 2901723.5229; train_gene_expr_recon_loss: 11464420.5344; train_masked_gp_l1_reg_loss: 34903.5509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95464.9012; train_chrom_access_recon_loss: 9948315.3893; train_global_loss: 24541030.8702; train_optim_loss: 24541030.8702; val_kl_reg_loss: 102617.3438; val_edge_recon_loss: 2870607.7500; val_gene_expr_recon_loss: 11214985.4000; val_masked_gp_l1_reg_loss: 36210.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91275.7344; val_chrom_access_recon_loss: 9929306.9333; val_global_loss: 24245004.5333; val_optim_loss: 24245004.5333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9226; val_auprc_score: 0.9032; val_best_acc_score: 0.8572; val_best_f1_score: 0.8675; train_kl_reg_loss: 97553.0635; train_edge_recon_loss: 2831890.2156; train_gene_expr_recon_loss: 11336087.8092; train_masked_gp_l1_reg_loss: 37466.0258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88974.2721; train_chrom_access_recon_loss: 9841364.4580; train_global_loss: 24233335.9542; train_optim_loss: 24233335.9542; val_kl_reg_loss: 96256.7229; val_edge_recon_loss: 2834894.9833; val_gene_expr_recon_loss: 11142316.2000; val_masked_gp_l1_reg_loss: 38657.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87013.3594; val_chrom_access_recon_loss: 9849751.6000; val_global_loss: 24048889.3333; val_optim_loss: 24048889.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9316; val_auprc_score: 0.9112; val_best_acc_score: 0.8655; val_best_f1_score: 0.8730; train_kl_reg_loss: 96576.9317; train_edge_recon_loss: 2805475.5305; train_gene_expr_recon_loss: 11235615.1450; train_masked_gp_l1_reg_loss: 39676.2459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85652.0980; train_chrom_access_recon_loss: 9754195.6260; train_global_loss: 24017191.4962; train_optim_loss: 24017191.4962; val_kl_reg_loss: 97934.0401; val_edge_recon_loss: 2783961.5000; val_gene_expr_recon_loss: 11033422.0667; val_masked_gp_l1_reg_loss: 40716.9727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84757.6484; val_chrom_access_recon_loss: 9774006.2667; val_global_loss: 23814799.2000; val_optim_loss: 23814799.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9421; val_auprc_score: 0.9292; val_best_acc_score: 0.8736; val_best_f1_score: 0.8807; train_kl_reg_loss: 90873.1841; train_edge_recon_loss: 2788864.5038; train_gene_expr_recon_loss: 11153116.1221; train_masked_gp_l1_reg_loss: 41590.7523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84054.9024; train_chrom_access_recon_loss: 9686458.0992; train_global_loss: 23844957.4504; train_optim_loss: 23844957.4504; val_kl_reg_loss: 93056.1911; val_edge_recon_loss: 2792233.6333; val_gene_expr_recon_loss: 10947642.8667; val_masked_gp_l1_reg_loss: 42487.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83368.8125; val_chrom_access_recon_loss: 9693140.6000; val_global_loss: 23651930.1333; val_optim_loss: 23651930.1333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9459; val_auprc_score: 0.9327; val_best_acc_score: 0.8818; val_best_f1_score: 0.8889; train_kl_reg_loss: 90699.1166; train_edge_recon_loss: 2780968.0821; train_gene_expr_recon_loss: 11069264.7786; train_masked_gp_l1_reg_loss: 43235.0193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83223.9113; train_chrom_access_recon_loss: 9614156.8855; train_global_loss: 23681547.8168; train_optim_loss: 23681547.8168; val_kl_reg_loss: 89659.0776; val_edge_recon_loss: 2768653.9833; val_gene_expr_recon_loss: 10872178.6000; val_masked_gp_l1_reg_loss: 43941.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82946.6875; val_chrom_access_recon_loss: 9611507.8000; val_global_loss: 23468888.1333; val_optim_loss: 23468888.1333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9481; val_auprc_score: 0.9315; val_best_acc_score: 0.8899; val_best_f1_score: 0.8957; train_kl_reg_loss: 89042.8517; train_edge_recon_loss: 2759644.0897; train_gene_expr_recon_loss: 11006849.0840; train_masked_gp_l1_reg_loss: 44660.7989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83072.7286; train_chrom_access_recon_loss: 9551163.7481; train_global_loss: 23534433.2366; train_optim_loss: 23534433.2366; val_kl_reg_loss: 88744.0604; val_edge_recon_loss: 2767696.4167; val_gene_expr_recon_loss: 10807267.0000; val_masked_gp_l1_reg_loss: 45365.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82726.1484; val_chrom_access_recon_loss: 9526402.2667; val_global_loss: 23318201.3333; val_optim_loss: 23318201.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9519; val_auprc_score: 0.9389; val_best_acc_score: 0.8902; val_best_f1_score: 0.8967; train_kl_reg_loss: 88157.9892; train_edge_recon_loss: 2747263.3607; train_gene_expr_recon_loss: 10943481.5038; train_masked_gp_l1_reg_loss: 46033.8287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82828.7500; train_chrom_access_recon_loss: 9489597.7176; train_global_loss: 23397363.1756; train_optim_loss: 23397363.1756; val_kl_reg_loss: 84468.4505; val_edge_recon_loss: 2770507.2167; val_gene_expr_recon_loss: 10748729.6667; val_masked_gp_l1_reg_loss: 46693.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83037.8203; val_chrom_access_recon_loss: 9477110.9333; val_global_loss: 23210547.2000; val_optim_loss: 23210547.2000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9538; val_auprc_score: 0.9381; val_best_acc_score: 0.9002; val_best_f1_score: 0.9045; train_kl_reg_loss: 86024.0344; train_edge_recon_loss: 2730691.3397; train_gene_expr_recon_loss: 10898270.4962; train_masked_gp_l1_reg_loss: 47288.2444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82474.9595; train_chrom_access_recon_loss: 9448677.1298; train_global_loss: 23293426.1527; train_optim_loss: 23293426.1527; val_kl_reg_loss: 84790.3932; val_edge_recon_loss: 2750037.8333; val_gene_expr_recon_loss: 10684478.9333; val_masked_gp_l1_reg_loss: 47967.0586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82224.2109; val_chrom_access_recon_loss: 9426166.4667; val_global_loss: 23075664.4000; val_optim_loss: 23075664.4000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9606; val_auprc_score: 0.9488; val_best_acc_score: 0.9066; val_best_f1_score: 0.9105; train_kl_reg_loss: 84969.8586; train_edge_recon_loss: 2730797.1279; train_gene_expr_recon_loss: 10844112.2595; train_masked_gp_l1_reg_loss: 48485.9744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82422.6468; train_chrom_access_recon_loss: 9389618.5420; train_global_loss: 23180406.4733; train_optim_loss: 23180406.4733; val_kl_reg_loss: 84665.8557; val_edge_recon_loss: 2741158.1833; val_gene_expr_recon_loss: 10647757.2000; val_masked_gp_l1_reg_loss: 49057.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82855.1719; val_chrom_access_recon_loss: 9378807.2000; val_global_loss: 22984301.3333; val_optim_loss: 22984301.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9573; val_auprc_score: 0.9407; val_best_acc_score: 0.9061; val_best_f1_score: 0.9109; train_kl_reg_loss: 82671.3729; train_edge_recon_loss: 2725963.3130; train_gene_expr_recon_loss: 10788651.6641; train_masked_gp_l1_reg_loss: 49562.3567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82382.2812; train_chrom_access_recon_loss: 9332847.3931; train_global_loss: 23062078.5038; train_optim_loss: 23062078.5038; val_kl_reg_loss: 83983.9604; val_edge_recon_loss: 2748592.1167; val_gene_expr_recon_loss: 10638585.1333; val_masked_gp_l1_reg_loss: 50128.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82003.9922; val_chrom_access_recon_loss: 9339480.1333; val_global_loss: 22942773.2000; val_optim_loss: 22942773.2000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9637; val_auprc_score: 0.9523; val_best_acc_score: 0.9122; val_best_f1_score: 0.9167; train_kl_reg_loss: 82244.8067; train_edge_recon_loss: 2714335.1908; train_gene_expr_recon_loss: 10750311.0534; train_masked_gp_l1_reg_loss: 50517.4046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82359.2792; train_chrom_access_recon_loss: 9289445.5496; train_global_loss: 22969213.3435; train_optim_loss: 22969213.3435; val_kl_reg_loss: 82728.6333; val_edge_recon_loss: 2714843.0667; val_gene_expr_recon_loss: 10593947.2667; val_masked_gp_l1_reg_loss: 51032.2305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82576.4766; val_chrom_access_recon_loss: 9304233.4000; val_global_loss: 22829360.5333; val_optim_loss: 22829360.5333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9645; val_auprc_score: 0.9517; val_best_acc_score: 0.9082; val_best_f1_score: 0.9113; train_kl_reg_loss: 80771.2057; train_edge_recon_loss: 2714560.0344; train_gene_expr_recon_loss: 10711912.3511; train_masked_gp_l1_reg_loss: 51442.2172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82673.7260; train_chrom_access_recon_loss: 9254052.3588; train_global_loss: 22895411.7557; train_optim_loss: 22895411.7557; val_kl_reg_loss: 78920.3750; val_edge_recon_loss: 2725915.7833; val_gene_expr_recon_loss: 10519276.8000; val_masked_gp_l1_reg_loss: 51898.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82856.7031; val_chrom_access_recon_loss: 9221177.6667; val_global_loss: 22680046.4000; val_optim_loss: 22680046.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9677; val_auprc_score: 0.9582; val_best_acc_score: 0.9186; val_best_f1_score: 0.9218; train_kl_reg_loss: 79131.7141; train_edge_recon_loss: 2712745.0782; train_gene_expr_recon_loss: 10680022.4733; train_masked_gp_l1_reg_loss: 52312.1179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83197.5326; train_chrom_access_recon_loss: 9221845.0573; train_global_loss: 22829253.8626; train_optim_loss: 22829253.8626; val_kl_reg_loss: 78790.1906; val_edge_recon_loss: 2696203.7333; val_gene_expr_recon_loss: 10494137.6000; val_masked_gp_l1_reg_loss: 52624.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83318.8438; val_chrom_access_recon_loss: 9251358.6000; val_global_loss: 22656434.1333; val_optim_loss: 22656434.1333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9666; val_auprc_score: 0.9550; val_best_acc_score: 0.9174; val_best_f1_score: 0.9209; train_kl_reg_loss: 78417.5576; train_edge_recon_loss: 2704831.2805; train_gene_expr_recon_loss: 10632930.6107; train_masked_gp_l1_reg_loss: 53069.0477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83559.3460; train_chrom_access_recon_loss: 9173828.3435; train_global_loss: 22726636.2137; train_optim_loss: 22726636.2137; val_kl_reg_loss: 76430.8630; val_edge_recon_loss: 2708026.6167; val_gene_expr_recon_loss: 10456919.0000; val_masked_gp_l1_reg_loss: 53361.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83679.3438; val_chrom_access_recon_loss: 9184330.2667; val_global_loss: 22562746.6667; val_optim_loss: 22562746.6667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9664; val_auprc_score: 0.9554; val_best_acc_score: 0.9182; val_best_f1_score: 0.9215; train_kl_reg_loss: 77201.6936; train_edge_recon_loss: 2710285.8664; train_gene_expr_recon_loss: 10613965.1221; train_masked_gp_l1_reg_loss: 53744.5534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84223.5908; train_chrom_access_recon_loss: 9152858.4885; train_global_loss: 22692279.2824; train_optim_loss: 22692279.2824; val_kl_reg_loss: 75637.2380; val_edge_recon_loss: 2709698.9333; val_gene_expr_recon_loss: 10411162.6000; val_masked_gp_l1_reg_loss: 54137.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84995.4688; val_chrom_access_recon_loss: 9138464.3333; val_global_loss: 22474095.7333; val_optim_loss: 22474095.7333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9686; val_auprc_score: 0.9567; val_best_acc_score: 0.9193; val_best_f1_score: 0.9231; train_kl_reg_loss: 76039.0126; train_edge_recon_loss: 2701002.3244; train_gene_expr_recon_loss: 10581273.6336; train_masked_gp_l1_reg_loss: 54451.0974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85213.5702; train_chrom_access_recon_loss: 9111901.4962; train_global_loss: 22609881.0992; train_optim_loss: 22609881.0992; val_kl_reg_loss: 76374.4625; val_edge_recon_loss: 2706976.0333; val_gene_expr_recon_loss: 10425466.0667; val_masked_gp_l1_reg_loss: 54840.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85641.8281; val_chrom_access_recon_loss: 9131448.0667; val_global_loss: 22480747.3333; val_optim_loss: 22480747.3333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9713; val_auprc_score: 0.9598; val_best_acc_score: 0.9235; val_best_f1_score: 0.9264; train_kl_reg_loss: 75738.4929; train_edge_recon_loss: 2697908.1336; train_gene_expr_recon_loss: 10561087.9008; train_masked_gp_l1_reg_loss: 55065.3454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86155.5969; train_chrom_access_recon_loss: 9094410.3511; train_global_loss: 22570365.8321; train_optim_loss: 22570365.8321; val_kl_reg_loss: 76477.3995; val_edge_recon_loss: 2701721.2333; val_gene_expr_recon_loss: 10397288.6000; val_masked_gp_l1_reg_loss: 55380.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86432.2500; val_chrom_access_recon_loss: 9100696.2667; val_global_loss: 22417995.6000; val_optim_loss: 22417995.6000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9687; val_auprc_score: 0.9588; val_best_acc_score: 0.9217; val_best_f1_score: 0.9234; train_kl_reg_loss: 74722.7408; train_edge_recon_loss: 2691787.6737; train_gene_expr_recon_loss: 10542238.4504; train_masked_gp_l1_reg_loss: 55688.5646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86538.0160; train_chrom_access_recon_loss: 9067719.8282; train_global_loss: 22518695.0992; train_optim_loss: 22518695.0992; val_kl_reg_loss: 74106.7776; val_edge_recon_loss: 2718344.8333; val_gene_expr_recon_loss: 10354367.8667; val_masked_gp_l1_reg_loss: 55959.0586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87107.9688; val_chrom_access_recon_loss: 9094042.6000; val_global_loss: 22383929.2000; val_optim_loss: 22383929.2000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9707; val_auprc_score: 0.9632; val_best_acc_score: 0.9208; val_best_f1_score: 0.9240; train_kl_reg_loss: 75511.5887; train_edge_recon_loss: 2693679.5687; train_gene_expr_recon_loss: 10506101.2519; train_masked_gp_l1_reg_loss: 56229.7196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86831.5327; train_chrom_access_recon_loss: 9038348.0344; train_global_loss: 22456701.7252; train_optim_loss: 22456701.7252; val_kl_reg_loss: 76030.1333; val_edge_recon_loss: 2714385.6667; val_gene_expr_recon_loss: 10339024.8667; val_masked_gp_l1_reg_loss: 56511.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87184.1953; val_chrom_access_recon_loss: 9064836.0667; val_global_loss: 22337972.6667; val_optim_loss: 22337972.6667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9706; val_auprc_score: 0.9614; val_best_acc_score: 0.9236; val_best_f1_score: 0.9265; train_kl_reg_loss: 74569.8599; train_edge_recon_loss: 2691890.3302; train_gene_expr_recon_loss: 10495402.5267; train_masked_gp_l1_reg_loss: 56745.6489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87082.1510; train_chrom_access_recon_loss: 9016805.8817; train_global_loss: 22422496.4275; train_optim_loss: 22422496.4275; val_kl_reg_loss: 75710.6057; val_edge_recon_loss: 2697110.8167; val_gene_expr_recon_loss: 10324166.1333; val_masked_gp_l1_reg_loss: 57053.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86599.3516; val_chrom_access_recon_loss: 9024147.9333; val_global_loss: 22264788.2667; val_optim_loss: 22264788.2667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9716; val_auprc_score: 0.9637; val_best_acc_score: 0.9216; val_best_f1_score: 0.9247; train_kl_reg_loss: 74164.4184; train_edge_recon_loss: 2685805.3435; train_gene_expr_recon_loss: 10479025.6947; train_masked_gp_l1_reg_loss: 57311.1429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87229.6150; train_chrom_access_recon_loss: 9000756.6947; train_global_loss: 22384292.8092; train_optim_loss: 22384292.8092; val_kl_reg_loss: 73379.6427; val_edge_recon_loss: 2701940.1833; val_gene_expr_recon_loss: 10280291.0000; val_masked_gp_l1_reg_loss: 57579.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87466.5078; val_chrom_access_recon_loss: 9014230.2667; val_global_loss: 22214888.2667; val_optim_loss: 22214888.2667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9736; val_auprc_score: 0.9607; val_best_acc_score: 0.9307; val_best_f1_score: 0.9334; train_kl_reg_loss: 73156.6922; train_edge_recon_loss: 2683915.1374; train_gene_expr_recon_loss: 10454265.8626; train_masked_gp_l1_reg_loss: 57799.5762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87310.5277; train_chrom_access_recon_loss: 8969001.4733; train_global_loss: 22325449.2214; train_optim_loss: 22325449.2214; val_kl_reg_loss: 71935.0417; val_edge_recon_loss: 2705340.3167; val_gene_expr_recon_loss: 10308247.3333; val_masked_gp_l1_reg_loss: 58063.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88035.1250; val_chrom_access_recon_loss: 9006005.5333; val_global_loss: 22237626.2667; val_optim_loss: 22237626.2667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9760; val_auprc_score: 0.9686; val_best_acc_score: 0.9309; val_best_f1_score: 0.9334; train_kl_reg_loss: 72818.0397; train_edge_recon_loss: 2682321.5992; train_gene_expr_recon_loss: 10436398.0458; train_masked_gp_l1_reg_loss: 58322.9688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87585.6809; train_chrom_access_recon_loss: 8942947.4618; train_global_loss: 22280393.6489; train_optim_loss: 22280393.6489; val_kl_reg_loss: 72069.8896; val_edge_recon_loss: 2704422.4000; val_gene_expr_recon_loss: 10238380.0000; val_masked_gp_l1_reg_loss: 58515.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87384.4141; val_chrom_access_recon_loss: 8957586.4667; val_global_loss: 22118357.3333; val_optim_loss: 22118357.3333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9747; val_auprc_score: 0.9632; val_best_acc_score: 0.9353; val_best_f1_score: 0.9376; train_kl_reg_loss: 72341.7369; train_edge_recon_loss: 2677974.3989; train_gene_expr_recon_loss: 10426475.7023; train_masked_gp_l1_reg_loss: 58787.7239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87360.7897; train_chrom_access_recon_loss: 8924582.2214; train_global_loss: 22247522.6565; train_optim_loss: 22247522.6565; val_kl_reg_loss: 73738.5724; val_edge_recon_loss: 2677305.2000; val_gene_expr_recon_loss: 10270573.6000; val_masked_gp_l1_reg_loss: 59050.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87989.1562; val_chrom_access_recon_loss: 8943427.3333; val_global_loss: 22112084.0000; val_optim_loss: 22112084.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9765; val_auprc_score: 0.9690; val_best_acc_score: 0.9313; val_best_f1_score: 0.9342; train_kl_reg_loss: 72248.8185; train_edge_recon_loss: 2680868.9752; train_gene_expr_recon_loss: 10413828.8702; train_masked_gp_l1_reg_loss: 59261.2530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87609.3833; train_chrom_access_recon_loss: 8912737.6641; train_global_loss: 22226555.0534; train_optim_loss: 22226555.0534; val_kl_reg_loss: 72512.6677; val_edge_recon_loss: 2674568.9333; val_gene_expr_recon_loss: 10274113.2667; val_masked_gp_l1_reg_loss: 59476.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87667.5938; val_chrom_access_recon_loss: 8993450.8667; val_global_loss: 22161789.6000; val_optim_loss: 22161789.6000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9745; val_auprc_score: 0.9678; val_best_acc_score: 0.9320; val_best_f1_score: 0.9349; train_kl_reg_loss: 71779.6580; train_edge_recon_loss: 2678698.4103; train_gene_expr_recon_loss: 10399629.5496; train_masked_gp_l1_reg_loss: 59660.8926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87605.0110; train_chrom_access_recon_loss: 8899802.4275; train_global_loss: 22197175.9084; train_optim_loss: 22197175.9084; val_kl_reg_loss: 73165.5318; val_edge_recon_loss: 2698892.9000; val_gene_expr_recon_loss: 10230986.8000; val_masked_gp_l1_reg_loss: 59836.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88052.3750; val_chrom_access_recon_loss: 8948058.4000; val_global_loss: 22098991.7333; val_optim_loss: 22098991.7333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9761; val_auprc_score: 0.9704; val_best_acc_score: 0.9313; val_best_f1_score: 0.9338; train_kl_reg_loss: 71804.2135; train_edge_recon_loss: 2678661.7156; train_gene_expr_recon_loss: 10385558.6641; train_masked_gp_l1_reg_loss: 60106.9530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87749.0317; train_chrom_access_recon_loss: 8877053.9580; train_global_loss: 22160934.3969; train_optim_loss: 22160934.3969; val_kl_reg_loss: 72605.2266; val_edge_recon_loss: 2703312.0167; val_gene_expr_recon_loss: 10255979.0667; val_masked_gp_l1_reg_loss: 60334.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88334.8984; val_chrom_access_recon_loss: 8953212.2000; val_global_loss: 22133778.5333; val_optim_loss: 22133778.5333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9770; val_auprc_score: 0.9683; val_best_acc_score: 0.9338; val_best_f1_score: 0.9366; train_kl_reg_loss: 71797.6112; train_edge_recon_loss: 2673811.9542; train_gene_expr_recon_loss: 10380471.6489; train_masked_gp_l1_reg_loss: 60491.7295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87988.8294; train_chrom_access_recon_loss: 8871828.4962; train_global_loss: 22146390.3969; train_optim_loss: 22146390.3969; val_kl_reg_loss: 71805.3354; val_edge_recon_loss: 2688243.7500; val_gene_expr_recon_loss: 10248025.0667; val_masked_gp_l1_reg_loss: 60641.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87322.1016; val_chrom_access_recon_loss: 8943828.8000; val_global_loss: 22099866.1333; val_optim_loss: 22099866.1333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9799; val_auprc_score: 0.9737; val_best_acc_score: 0.9375; val_best_f1_score: 0.9393; train_kl_reg_loss: 71504.5532; train_edge_recon_loss: 2676602.3531; train_gene_expr_recon_loss: 10362560.8779; train_masked_gp_l1_reg_loss: 60780.9299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87762.5888; train_chrom_access_recon_loss: 8844165.9351; train_global_loss: 22103377.1908; train_optim_loss: 22103377.1908; val_kl_reg_loss: 70884.6281; val_edge_recon_loss: 2677671.7667; val_gene_expr_recon_loss: 10201242.0000; val_masked_gp_l1_reg_loss: 60973.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88032.9453; val_chrom_access_recon_loss: 8897629.5333; val_global_loss: 21996433.8667; val_optim_loss: 21996433.8667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9789; val_auprc_score: 0.9730; val_best_acc_score: 0.9364; val_best_f1_score: 0.9389; train_kl_reg_loss: 70814.9495; train_edge_recon_loss: 2676733.0038; train_gene_expr_recon_loss: 10348080.9695; train_masked_gp_l1_reg_loss: 61147.8703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88008.5664; train_chrom_access_recon_loss: 8819559.3817; train_global_loss: 22064344.7481; train_optim_loss: 22064344.7481; val_kl_reg_loss: 69271.0964; val_edge_recon_loss: 2660177.8000; val_gene_expr_recon_loss: 10205664.4000; val_masked_gp_l1_reg_loss: 61211.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87961.9453; val_chrom_access_recon_loss: 8894590.4000; val_global_loss: 21978877.0667; val_optim_loss: 21978877.0667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9814; val_auprc_score: 0.9748; val_best_acc_score: 0.9404; val_best_f1_score: 0.9418; train_kl_reg_loss: 71365.3161; train_edge_recon_loss: 2670592.8817; train_gene_expr_recon_loss: 10343314.2901; train_masked_gp_l1_reg_loss: 61413.1957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88103.5905; train_chrom_access_recon_loss: 8816374.9198; train_global_loss: 22051164.2290; train_optim_loss: 22051164.2290; val_kl_reg_loss: 72198.5828; val_edge_recon_loss: 2690052.4000; val_gene_expr_recon_loss: 10198583.8000; val_masked_gp_l1_reg_loss: 61601.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88455.2656; val_chrom_access_recon_loss: 8861791.7667; val_global_loss: 21972682.4000; val_optim_loss: 21972682.4000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9798; val_auprc_score: 0.9745; val_best_acc_score: 0.9372; val_best_f1_score: 0.9391; train_kl_reg_loss: 70919.8962; train_edge_recon_loss: 2676339.3435; train_gene_expr_recon_loss: 10336205.6031; train_masked_gp_l1_reg_loss: 61764.2616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88226.2308; train_chrom_access_recon_loss: 8804765.6031; train_global_loss: 22038221.0076; train_optim_loss: 22038221.0076; val_kl_reg_loss: 70432.4609; val_edge_recon_loss: 2688609.1833; val_gene_expr_recon_loss: 10197488.2000; val_masked_gp_l1_reg_loss: 61949.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88603.0391; val_chrom_access_recon_loss: 8873174.4000; val_global_loss: 21980255.8667; val_optim_loss: 21980255.8667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9821; val_auprc_score: 0.9748; val_best_acc_score: 0.9415; val_best_f1_score: 0.9432; train_kl_reg_loss: 70569.4119; train_edge_recon_loss: 2678819.3225; train_gene_expr_recon_loss: 10323325.4656; train_masked_gp_l1_reg_loss: 62031.5626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88266.5421; train_chrom_access_recon_loss: 8786032.5534; train_global_loss: 22009044.8855; train_optim_loss: 22009044.8855; val_kl_reg_loss: 70084.7115; val_edge_recon_loss: 2679419.9833; val_gene_expr_recon_loss: 10219279.6667; val_masked_gp_l1_reg_loss: 62111.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88404.6797; val_chrom_access_recon_loss: 8892584.9333; val_global_loss: 22011885.3333; val_optim_loss: 22011885.3333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9834; val_auprc_score: 0.9795; val_best_acc_score: 0.9445; val_best_f1_score: 0.9463; train_kl_reg_loss: 70754.2742; train_edge_recon_loss: 2672237.2863; train_gene_expr_recon_loss: 10321739.8168; train_masked_gp_l1_reg_loss: 62296.6816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88405.3841; train_chrom_access_recon_loss: 8782541.4885; train_global_loss: 21997974.8092; train_optim_loss: 21997974.8092; val_kl_reg_loss: 68099.7260; val_edge_recon_loss: 2659065.4167; val_gene_expr_recon_loss: 10160702.3333; val_masked_gp_l1_reg_loss: 62432.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88826.0312; val_chrom_access_recon_loss: 8847204.4667; val_global_loss: 21886329.6000; val_optim_loss: 21886329.6000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9854; val_auprc_score: 0.9823; val_best_acc_score: 0.9457; val_best_f1_score: 0.9474; train_kl_reg_loss: 70570.8528; train_edge_recon_loss: 2675328.9924; train_gene_expr_recon_loss: 10313937.7710; train_masked_gp_l1_reg_loss: 62560.8326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88557.5669; train_chrom_access_recon_loss: 8766128.5115; train_global_loss: 21977084.4733; train_optim_loss: 21977084.4733; val_kl_reg_loss: 69854.2052; val_edge_recon_loss: 2671674.0000; val_gene_expr_recon_loss: 10175094.8667; val_masked_gp_l1_reg_loss: 62702.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88431.8125; val_chrom_access_recon_loss: 8862839.7333; val_global_loss: 21930597.6000; val_optim_loss: 21930597.6000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9837; val_auprc_score: 0.9791; val_best_acc_score: 0.9431; val_best_f1_score: 0.9439; train_kl_reg_loss: 70231.4718; train_edge_recon_loss: 2677335.4771; train_gene_expr_recon_loss: 10306602.5573; train_masked_gp_l1_reg_loss: 62811.5329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88580.2443; train_chrom_access_recon_loss: 8755724.2061; train_global_loss: 21961285.5115; train_optim_loss: 21961285.5115; val_kl_reg_loss: 70832.4432; val_edge_recon_loss: 2671109.1500; val_gene_expr_recon_loss: 10155083.6000; val_masked_gp_l1_reg_loss: 62931.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88458.3906; val_chrom_access_recon_loss: 8841036.4333; val_global_loss: 21889451.7333; val_optim_loss: 21889451.7333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9850; val_auprc_score: 0.9817; val_best_acc_score: 0.9457; val_best_f1_score: 0.9469; train_kl_reg_loss: 70745.7149; train_edge_recon_loss: 2669164.7252; train_gene_expr_recon_loss: 10291712.0687; train_masked_gp_l1_reg_loss: 63045.3402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88658.9724; train_chrom_access_recon_loss: 8736284.3740; train_global_loss: 21919611.2672; train_optim_loss: 21919611.2672; val_kl_reg_loss: 69977.3255; val_edge_recon_loss: 2675893.5167; val_gene_expr_recon_loss: 10125495.6000; val_masked_gp_l1_reg_loss: 63100.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88600.4297; val_chrom_access_recon_loss: 8828265.2333; val_global_loss: 21851331.7333; val_optim_loss: 21851331.7333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9858; val_auprc_score: 0.9817; val_best_acc_score: 0.9464; val_best_f1_score: 0.9476; train_kl_reg_loss: 69987.5731; train_edge_recon_loss: 2670175.6756; train_gene_expr_recon_loss: 10292861.8626; train_masked_gp_l1_reg_loss: 63235.6733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88634.1213; train_chrom_access_recon_loss: 8731325.2405; train_global_loss: 21916220.0916; train_optim_loss: 21916220.0916; val_kl_reg_loss: 70268.2276; val_edge_recon_loss: 2673871.0833; val_gene_expr_recon_loss: 10180152.2667; val_masked_gp_l1_reg_loss: 63491.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88904.0078; val_chrom_access_recon_loss: 8888049.5000; val_global_loss: 21964735.8667; val_optim_loss: 21964735.8667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9842; val_auprc_score: 0.9801; val_best_acc_score: 0.9458; val_best_f1_score: 0.9471; train_kl_reg_loss: 69749.3553; train_edge_recon_loss: 2668145.7996; train_gene_expr_recon_loss: 10284666.8244; train_masked_gp_l1_reg_loss: 63534.3843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89061.9179; train_chrom_access_recon_loss: 8724250.0153; train_global_loss: 21899408.2290; train_optim_loss: 21899408.2290; val_kl_reg_loss: 70394.7109; val_edge_recon_loss: 2664131.9000; val_gene_expr_recon_loss: 10181469.2000; val_masked_gp_l1_reg_loss: 63543.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88757.9062; val_chrom_access_recon_loss: 8864823.7333; val_global_loss: 21933120.4000; val_optim_loss: 21933120.4000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9833; val_auprc_score: 0.9785; val_best_acc_score: 0.9468; val_best_f1_score: 0.9484; train_kl_reg_loss: 70183.1899; train_edge_recon_loss: 2663749.6985; train_gene_expr_recon_loss: 10281502.8244; train_masked_gp_l1_reg_loss: 63662.6986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88989.6635; train_chrom_access_recon_loss: 8718949.2328; train_global_loss: 21887037.3282; train_optim_loss: 21887037.3282; val_kl_reg_loss: 69179.6146; val_edge_recon_loss: 2673456.9667; val_gene_expr_recon_loss: 10146310.8667; val_masked_gp_l1_reg_loss: 63830.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89842.8906; val_chrom_access_recon_loss: 8863693.4000; val_global_loss: 21906314.6667; val_optim_loss: 21906314.6667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9860; val_auprc_score: 0.9827; val_best_acc_score: 0.9496; val_best_f1_score: 0.9507; train_kl_reg_loss: 69999.8186; train_edge_recon_loss: 2670026.3282; train_gene_expr_recon_loss: 10275529.8931; train_masked_gp_l1_reg_loss: 63929.3662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89287.9909; train_chrom_access_recon_loss: 8711245.9008; train_global_loss: 21880019.4504; train_optim_loss: 21880019.4504; val_kl_reg_loss: 70323.3547; val_edge_recon_loss: 2666311.9333; val_gene_expr_recon_loss: 10146898.4000; val_masked_gp_l1_reg_loss: 63946.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89179.8594; val_chrom_access_recon_loss: 8845739.1333; val_global_loss: 21882398.9333; val_optim_loss: 21882398.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9871; val_auprc_score: 0.9846; val_best_acc_score: 0.9479; val_best_f1_score: 0.9491; train_kl_reg_loss: 71678.7817; train_edge_recon_loss: 2664373.3950; train_gene_expr_recon_loss: 10254890.6412; train_masked_gp_l1_reg_loss: 62677.8005; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67380.1069; train_chrom_access_recon_loss: 8674907.5344; train_global_loss: 21795908.3511; train_optim_loss: 21795908.3511; val_kl_reg_loss: 72361.7802; val_edge_recon_loss: 2680192.4333; val_gene_expr_recon_loss: 10129383.6667; val_masked_gp_l1_reg_loss: 62014.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64863.5703; val_chrom_access_recon_loss: 8829893.8000; val_global_loss: 21838709.7333; val_optim_loss: 21838709.7333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9865; val_auprc_score: 0.9840; val_best_acc_score: 0.9477; val_best_f1_score: 0.9489; train_kl_reg_loss: 72599.8058; train_edge_recon_loss: 2666742.5267; train_gene_expr_recon_loss: 10249772.4122; train_masked_gp_l1_reg_loss: 61845.4592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64567.7428; train_chrom_access_recon_loss: 8668682.8588; train_global_loss: 21784210.8702; train_optim_loss: 21784210.8702; val_kl_reg_loss: 73446.5036; val_edge_recon_loss: 2688814.7167; val_gene_expr_recon_loss: 10149371.0667; val_masked_gp_l1_reg_loss: 61709.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64360.1094; val_chrom_access_recon_loss: 8838363.7667; val_global_loss: 21876066.1333; val_optim_loss: 21876066.1333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9870; val_auprc_score: 0.9851; val_best_acc_score: 0.9492; val_best_f1_score: 0.9503; train_kl_reg_loss: 72922.6418; train_edge_recon_loss: 2659828.6660; train_gene_expr_recon_loss: 10245424.2748; train_masked_gp_l1_reg_loss: 61660.6459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64193.6314; train_chrom_access_recon_loss: 8665935.0611; train_global_loss: 21769965.0076; train_optim_loss: 21769965.0076; val_kl_reg_loss: 73094.5349; val_edge_recon_loss: 2679884.6167; val_gene_expr_recon_loss: 10172583.0667; val_masked_gp_l1_reg_loss: 61601.6523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63971.8359; val_chrom_access_recon_loss: 8827871.0333; val_global_loss: 21879007.3333; val_optim_loss: 21879007.3333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9862; val_auprc_score: 0.9835; val_best_acc_score: 0.9479; val_best_f1_score: 0.9494; train_kl_reg_loss: 73125.8460; train_edge_recon_loss: 2666563.9008; train_gene_expr_recon_loss: 10252363.7863; train_masked_gp_l1_reg_loss: 61578.2858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63811.4704; train_chrom_access_recon_loss: 8667148.8282; train_global_loss: 21784592.1679; train_optim_loss: 21784592.1679; val_kl_reg_loss: 73088.0854; val_edge_recon_loss: 2666273.9000; val_gene_expr_recon_loss: 10134738.7333; val_masked_gp_l1_reg_loss: 61555.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63788.2578; val_chrom_access_recon_loss: 8798376.7333; val_global_loss: 21797820.6667; val_optim_loss: 21797820.6667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9865; val_auprc_score: 0.9816; val_best_acc_score: 0.9508; val_best_f1_score: 0.9512; train_kl_reg_loss: 73172.1789; train_edge_recon_loss: 2660426.6508; train_gene_expr_recon_loss: 10253149.5573; train_masked_gp_l1_reg_loss: 61545.9953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63636.8766; train_chrom_access_recon_loss: 8662656.9809; train_global_loss: 21774588.2290; train_optim_loss: 21774588.2290; val_kl_reg_loss: 72866.8750; val_edge_recon_loss: 2667999.7167; val_gene_expr_recon_loss: 10129214.8667; val_masked_gp_l1_reg_loss: 61535.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63557.3125; val_chrom_access_recon_loss: 8829628.4000; val_global_loss: 21824802.1333; val_optim_loss: 21824802.1333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9862; val_auprc_score: 0.9814; val_best_acc_score: 0.9492; val_best_f1_score: 0.9498; train_kl_reg_loss: 73121.4707; train_edge_recon_loss: 2666052.3359; train_gene_expr_recon_loss: 10254179.4122; train_masked_gp_l1_reg_loss: 61533.9674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63389.1605; train_chrom_access_recon_loss: 8674262.2901; train_global_loss: 21792538.5496; train_optim_loss: 21792538.5496; val_kl_reg_loss: 73615.0068; val_edge_recon_loss: 2664862.3667; val_gene_expr_recon_loss: 10163401.3333; val_masked_gp_l1_reg_loss: 61522.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63289.8086; val_chrom_access_recon_loss: 8837276.3667; val_global_loss: 21863968.2667; val_optim_loss: 21863968.2667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9863; val_auprc_score: 0.9835; val_best_acc_score: 0.9507; val_best_f1_score: 0.9518; train_kl_reg_loss: 73195.3498; train_edge_recon_loss: 2665198.1489; train_gene_expr_recon_loss: 10248596.5878; train_masked_gp_l1_reg_loss: 61527.0179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63183.0877; train_chrom_access_recon_loss: 8663745.5229; train_global_loss: 21775445.7557; train_optim_loss: 21775445.7557; val_kl_reg_loss: 73805.2625; val_edge_recon_loss: 2664710.0000; val_gene_expr_recon_loss: 10135885.8000; val_masked_gp_l1_reg_loss: 61534.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63264.2891; val_chrom_access_recon_loss: 8834042.0667; val_global_loss: 21833242.1333; val_optim_loss: 21833242.1333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9855; val_auprc_score: 0.9795; val_best_acc_score: 0.9473; val_best_f1_score: 0.9482; train_kl_reg_loss: 73301.0281; train_edge_recon_loss: 2663934.9294; train_gene_expr_recon_loss: 10241201.8931; train_masked_gp_l1_reg_loss: 61534.6874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63048.1741; train_chrom_access_recon_loss: 8656456.5229; train_global_loss: 21759477.2519; train_optim_loss: 21759477.2519; val_kl_reg_loss: 73342.4396; val_edge_recon_loss: 2685970.0833; val_gene_expr_recon_loss: 10160049.2667; val_masked_gp_l1_reg_loss: 61523.0117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63060.0508; val_chrom_access_recon_loss: 8873378.7333; val_global_loss: 21917323.4667; val_optim_loss: 21917323.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9886; val_auprc_score: 0.9867; val_best_acc_score: 0.9527; val_best_f1_score: 0.9532; train_kl_reg_loss: 73114.5525; train_edge_recon_loss: 2665437.5057; train_gene_expr_recon_loss: 10239476.1756; train_masked_gp_l1_reg_loss: 61397.8994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60879.4211; train_chrom_access_recon_loss: 8652913.0725; train_global_loss: 21753218.6412; train_optim_loss: 21753218.6412; val_kl_reg_loss: 73551.9182; val_edge_recon_loss: 2662421.5000; val_gene_expr_recon_loss: 10138884.7333; val_masked_gp_l1_reg_loss: 61324.4023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60611.2344; val_chrom_access_recon_loss: 8857318.0667; val_global_loss: 21854110.9333; val_optim_loss: 21854110.9333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9863; val_auprc_score: 0.9821; val_best_acc_score: 0.9507; val_best_f1_score: 0.9516; train_kl_reg_loss: 73307.9506; train_edge_recon_loss: 2661863.1336; train_gene_expr_recon_loss: 10244388.6260; train_masked_gp_l1_reg_loss: 61298.1753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60570.0936; train_chrom_access_recon_loss: 8653182.4809; train_global_loss: 21754610.5191; train_optim_loss: 21754610.5191; val_kl_reg_loss: 73492.2094; val_edge_recon_loss: 2675329.5000; val_gene_expr_recon_loss: 10121985.2667; val_masked_gp_l1_reg_loss: 61276.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60529.6289; val_chrom_access_recon_loss: 8821290.1333; val_global_loss: 21813904.2667; val_optim_loss: 21813904.2667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9863; val_auprc_score: 0.9824; val_best_acc_score: 0.9493; val_best_f1_score: 0.9509; train_kl_reg_loss: 73255.2740; train_edge_recon_loss: 2663485.1813; train_gene_expr_recon_loss: 10246998.5191; train_masked_gp_l1_reg_loss: 61265.1725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60500.6908; train_chrom_access_recon_loss: 8658557.4771; train_global_loss: 21764062.2901; train_optim_loss: 21764062.2901; val_kl_reg_loss: 73416.5599; val_edge_recon_loss: 2669818.3500; val_gene_expr_recon_loss: 10161298.7333; val_masked_gp_l1_reg_loss: 61254.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60469.2148; val_chrom_access_recon_loss: 8849518.6667; val_global_loss: 21875775.2000; val_optim_loss: 21875775.2000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9857; val_auprc_score: 0.9803; val_best_acc_score: 0.9491; val_best_f1_score: 0.9502; train_kl_reg_loss: 73348.4251; train_edge_recon_loss: 2665623.0458; train_gene_expr_recon_loss: 10248236.1527; train_masked_gp_l1_reg_loss: 61248.2435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60441.2978; train_chrom_access_recon_loss: 8662315.3626; train_global_loss: 21771212.5344; train_optim_loss: 21771212.5344; val_kl_reg_loss: 73812.5901; val_edge_recon_loss: 2680536.9500; val_gene_expr_recon_loss: 10136899.4667; val_masked_gp_l1_reg_loss: 61241.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60423.1641; val_chrom_access_recon_loss: 8842450.8000; val_global_loss: 21855363.6000; val_optim_loss: 21855363.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 87 min 21 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9850
val AUPRC score: 0.9786
val best accuracy score: 0.9473
val best F1 score: 0.9490
val target rna MSE score: 1.1344
val source rna MSE score: 0.2619
val target atac MSE score: 0.3435
val source atac MSE score: 0.0513
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
