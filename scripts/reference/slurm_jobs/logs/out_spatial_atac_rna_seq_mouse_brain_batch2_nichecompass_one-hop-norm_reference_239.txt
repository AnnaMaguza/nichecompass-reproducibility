[True]
Run timestamp: 10102023_104818_239.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_239']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6900; val_auprc_score: 0.6674; val_best_acc_score: 0.5107; val_best_f1_score: 0.6714; train_kl_reg_loss: 93611.1886; train_edge_recon_loss: 768551.8741; train_gene_expr_recon_loss: 22994368.4242; train_masked_gp_l1_reg_loss: 50318.9519; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6125323.0871; train_chrom_access_recon_loss: 6912953.6061; train_global_loss: 36945127.4848; train_optim_loss: 36945127.4848; val_kl_reg_loss: 101994.6221; val_edge_recon_loss: 812993.6875; val_gene_expr_recon_loss: 21279046.0000; val_masked_gp_l1_reg_loss: 52081.0586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3479216.2500; val_chrom_access_recon_loss: 6538798.6875; val_global_loss: 32264130.7500; val_optim_loss: 32264130.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7047; val_auprc_score: 0.6926; val_best_acc_score: 0.6314; val_best_f1_score: 0.7010; train_kl_reg_loss: 105934.0893; train_edge_recon_loss: 755334.4271; train_gene_expr_recon_loss: 21210784.3333; train_masked_gp_l1_reg_loss: 53307.1166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1945140.3324; train_chrom_access_recon_loss: 6602166.2576; train_global_loss: 30672666.7576; train_optim_loss: 30672666.7576; val_kl_reg_loss: 93668.4170; val_edge_recon_loss: 810480.1094; val_gene_expr_recon_loss: 20953394.7500; val_masked_gp_l1_reg_loss: 54850.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 965118.8125; val_chrom_access_recon_loss: 6511886.1250; val_global_loss: 29389397.5000; val_optim_loss: 29389397.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7744; val_auprc_score: 0.7543; val_best_acc_score: 0.6913; val_best_f1_score: 0.7315; train_kl_reg_loss: 90889.9034; train_edge_recon_loss: 741948.8542; train_gene_expr_recon_loss: 21029431.5758; train_masked_gp_l1_reg_loss: 56268.2675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 637800.5639; train_chrom_access_recon_loss: 6562208.0682; train_global_loss: 29118547.0000; train_optim_loss: 29118547.0000; val_kl_reg_loss: 90354.3477; val_edge_recon_loss: 796884.1953; val_gene_expr_recon_loss: 20809474.5000; val_masked_gp_l1_reg_loss: 57761.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 422835.0312; val_chrom_access_recon_loss: 6501105.7500; val_global_loss: 28678417.0000; val_optim_loss: 28678417.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8423; val_auprc_score: 0.8224; val_best_acc_score: 0.7665; val_best_f1_score: 0.7794; train_kl_reg_loss: 81743.4081; train_edge_recon_loss: 724965.2964; train_gene_expr_recon_loss: 20852108.9697; train_masked_gp_l1_reg_loss: 59341.5259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 331121.3390; train_chrom_access_recon_loss: 6511011.1439; train_global_loss: 28560291.5758; train_optim_loss: 28560291.5758; val_kl_reg_loss: 78572.8662; val_edge_recon_loss: 749532.0391; val_gene_expr_recon_loss: 20573597.0000; val_masked_gp_l1_reg_loss: 61091.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 265832.1562; val_chrom_access_recon_loss: 6428186.9375; val_global_loss: 28156813.2500; val_optim_loss: 28156813.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8727; val_auprc_score: 0.8356; val_best_acc_score: 0.8025; val_best_f1_score: 0.8212; train_kl_reg_loss: 80516.5410; train_edge_recon_loss: 688299.1619; train_gene_expr_recon_loss: 20701686.9697; train_masked_gp_l1_reg_loss: 62733.7669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 232370.5914; train_chrom_access_recon_loss: 6466730.1818; train_global_loss: 28232337.1212; train_optim_loss: 28232337.1212; val_kl_reg_loss: 86471.5195; val_edge_recon_loss: 662399.9453; val_gene_expr_recon_loss: 20491209.7500; val_masked_gp_l1_reg_loss: 64833.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 206555.0625; val_chrom_access_recon_loss: 6405789.9375; val_global_loss: 27917261.5000; val_optim_loss: 27917261.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8803; val_auprc_score: 0.8428; val_best_acc_score: 0.8176; val_best_f1_score: 0.8270; train_kl_reg_loss: 88470.8075; train_edge_recon_loss: 642973.4830; train_gene_expr_recon_loss: 20562381.7879; train_masked_gp_l1_reg_loss: 66404.9209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 190198.8949; train_chrom_access_recon_loss: 6436016.1515; train_global_loss: 27986446.3030; train_optim_loss: 27986446.3030; val_kl_reg_loss: 86900.3916; val_edge_recon_loss: 641686.5625; val_gene_expr_recon_loss: 20299239.0000; val_masked_gp_l1_reg_loss: 68136.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175338.5938; val_chrom_access_recon_loss: 6328084.7500; val_global_loss: 27599384.2500; val_optim_loss: 27599384.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8884; val_auprc_score: 0.8467; val_best_acc_score: 0.8229; val_best_f1_score: 0.8394; train_kl_reg_loss: 86439.0324; train_edge_recon_loss: 631380.7254; train_gene_expr_recon_loss: 20463613.9697; train_masked_gp_l1_reg_loss: 69396.5069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 164166.9200; train_chrom_access_recon_loss: 6406343.1212; train_global_loss: 27821340.3939; train_optim_loss: 27821340.3939; val_kl_reg_loss: 81619.0957; val_edge_recon_loss: 630841.6406; val_gene_expr_recon_loss: 20306323.0000; val_masked_gp_l1_reg_loss: 70719.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154471.2812; val_chrom_access_recon_loss: 6342350.0625; val_global_loss: 27586326.0000; val_optim_loss: 27586326.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8886; val_auprc_score: 0.8513; val_best_acc_score: 0.8208; val_best_f1_score: 0.8348; train_kl_reg_loss: 84913.5810; train_edge_recon_loss: 619394.9015; train_gene_expr_recon_loss: 20379923.8485; train_masked_gp_l1_reg_loss: 71713.9957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147213.0947; train_chrom_access_recon_loss: 6379084.7727; train_global_loss: 27682244.0606; train_optim_loss: 27682244.0606; val_kl_reg_loss: 81514.1045; val_edge_recon_loss: 630960.5391; val_gene_expr_recon_loss: 20275719.0000; val_masked_gp_l1_reg_loss: 72853.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141709.3438; val_chrom_access_recon_loss: 6361244.4375; val_global_loss: 27564002.0000; val_optim_loss: 27564002.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9004; val_auprc_score: 0.8692; val_best_acc_score: 0.8305; val_best_f1_score: 0.8409; train_kl_reg_loss: 83105.8935; train_edge_recon_loss: 616361.4867; train_gene_expr_recon_loss: 20295133.9394; train_masked_gp_l1_reg_loss: 73622.9189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136213.8288; train_chrom_access_recon_loss: 6356505.8712; train_global_loss: 27560944.0909; train_optim_loss: 27560944.0909; val_kl_reg_loss: 79293.2705; val_edge_recon_loss: 621628.5156; val_gene_expr_recon_loss: 20133292.5000; val_masked_gp_l1_reg_loss: 74362.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131798.8906; val_chrom_access_recon_loss: 6273031.3125; val_global_loss: 27313405.5000; val_optim_loss: 27313405.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9031; val_auprc_score: 0.8753; val_best_acc_score: 0.8372; val_best_f1_score: 0.8495; train_kl_reg_loss: 80242.3750; train_edge_recon_loss: 615478.3570; train_gene_expr_recon_loss: 20220498.4848; train_masked_gp_l1_reg_loss: 75267.0676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128390.9846; train_chrom_access_recon_loss: 6334346.6212; train_global_loss: 27454223.7879; train_optim_loss: 27454223.7879; val_kl_reg_loss: 77694.2891; val_edge_recon_loss: 619174.4297; val_gene_expr_recon_loss: 20030686.2500; val_masked_gp_l1_reg_loss: 75910.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125537.7188; val_chrom_access_recon_loss: 6282365.4375; val_global_loss: 27211368.7500; val_optim_loss: 27211368.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9065; val_auprc_score: 0.8807; val_best_acc_score: 0.8434; val_best_f1_score: 0.8515; train_kl_reg_loss: 78267.9595; train_edge_recon_loss: 611664.3551; train_gene_expr_recon_loss: 20142509.7273; train_masked_gp_l1_reg_loss: 76621.8549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122955.8152; train_chrom_access_recon_loss: 6311800.3636; train_global_loss: 27343820.0909; train_optim_loss: 27343820.0909; val_kl_reg_loss: 77256.7139; val_edge_recon_loss: 616808.9141; val_gene_expr_recon_loss: 20181041.5000; val_masked_gp_l1_reg_loss: 77339.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120479.9062; val_chrom_access_recon_loss: 6309651.5625; val_global_loss: 27382578.5000; val_optim_loss: 27382578.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9099; val_auprc_score: 0.8838; val_best_acc_score: 0.8401; val_best_f1_score: 0.8526; train_kl_reg_loss: 76899.8100; train_edge_recon_loss: 606915.8504; train_gene_expr_recon_loss: 20052239.1515; train_masked_gp_l1_reg_loss: 77798.1586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118875.7023; train_chrom_access_recon_loss: 6277472.4470; train_global_loss: 27210201.2424; train_optim_loss: 27210201.2424; val_kl_reg_loss: 75152.6592; val_edge_recon_loss: 606867.9688; val_gene_expr_recon_loss: 19930155.7500; val_masked_gp_l1_reg_loss: 78587.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118398.8281; val_chrom_access_recon_loss: 6203415.5000; val_global_loss: 27012577.5000; val_optim_loss: 27012577.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9167; val_auprc_score: 0.8946; val_best_acc_score: 0.8530; val_best_f1_score: 0.8591; train_kl_reg_loss: 75198.3884; train_edge_recon_loss: 606341.7386; train_gene_expr_recon_loss: 20012857.0303; train_masked_gp_l1_reg_loss: 79075.4840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116970.9273; train_chrom_access_recon_loss: 6265838.0682; train_global_loss: 27156281.8788; train_optim_loss: 27156281.8788; val_kl_reg_loss: 74773.9766; val_edge_recon_loss: 607739.0000; val_gene_expr_recon_loss: 19791122.7500; val_masked_gp_l1_reg_loss: 79761.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116606.0391; val_chrom_access_recon_loss: 6192283.2500; val_global_loss: 26862287.2500; val_optim_loss: 26862287.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9202; val_auprc_score: 0.8986; val_best_acc_score: 0.8506; val_best_f1_score: 0.8574; train_kl_reg_loss: 74007.4902; train_edge_recon_loss: 603328.5701; train_gene_expr_recon_loss: 19933298.0909; train_masked_gp_l1_reg_loss: 80183.8228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116163.8349; train_chrom_access_recon_loss: 6243325.0985; train_global_loss: 27050307.0000; train_optim_loss: 27050307.0000; val_kl_reg_loss: 72398.9619; val_edge_recon_loss: 607535.2500; val_gene_expr_recon_loss: 19700299.2500; val_masked_gp_l1_reg_loss: 80637.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115826.9531; val_chrom_access_recon_loss: 6150632.3125; val_global_loss: 26727330.0000; val_optim_loss: 26727330.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9290; val_auprc_score: 0.9126; val_best_acc_score: 0.8595; val_best_f1_score: 0.8672; train_kl_reg_loss: 72974.2584; train_edge_recon_loss: 603191.8267; train_gene_expr_recon_loss: 19866177.0000; train_masked_gp_l1_reg_loss: 81209.7018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115153.7422; train_chrom_access_recon_loss: 6226312.1212; train_global_loss: 26965018.6970; train_optim_loss: 26965018.6970; val_kl_reg_loss: 71983.5176; val_edge_recon_loss: 605198.7031; val_gene_expr_recon_loss: 19811541.0000; val_masked_gp_l1_reg_loss: 81786.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115382.1562; val_chrom_access_recon_loss: 6171157.9375; val_global_loss: 26857049.2500; val_optim_loss: 26857049.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9356; val_auprc_score: 0.9178; val_best_acc_score: 0.8748; val_best_f1_score: 0.8798; train_kl_reg_loss: 72167.4920; train_edge_recon_loss: 599565.5985; train_gene_expr_recon_loss: 19810707.6364; train_masked_gp_l1_reg_loss: 82195.3166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114187.3220; train_chrom_access_recon_loss: 6205434.4015; train_global_loss: 26884257.7879; train_optim_loss: 26884257.7879; val_kl_reg_loss: 69965.4727; val_edge_recon_loss: 601338.4453; val_gene_expr_recon_loss: 19785502.5000; val_masked_gp_l1_reg_loss: 82720.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113854.2812; val_chrom_access_recon_loss: 6144478.6250; val_global_loss: 26797858.7500; val_optim_loss: 26797858.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9365; val_auprc_score: 0.9197; val_best_acc_score: 0.8694; val_best_f1_score: 0.8750; train_kl_reg_loss: 71409.6450; train_edge_recon_loss: 597740.9574; train_gene_expr_recon_loss: 19759143.8182; train_masked_gp_l1_reg_loss: 83209.8449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112889.6933; train_chrom_access_recon_loss: 6189884.4924; train_global_loss: 26814278.4848; train_optim_loss: 26814278.4848; val_kl_reg_loss: 71430.6582; val_edge_recon_loss: 602711.9219; val_gene_expr_recon_loss: 19677132.5000; val_masked_gp_l1_reg_loss: 83782.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111862.0000; val_chrom_access_recon_loss: 6142795.6250; val_global_loss: 26689715.2500; val_optim_loss: 26689715.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9371; val_auprc_score: 0.9219; val_best_acc_score: 0.8740; val_best_f1_score: 0.8770; train_kl_reg_loss: 70758.1450; train_edge_recon_loss: 594936.2746; train_gene_expr_recon_loss: 19699167.4545; train_masked_gp_l1_reg_loss: 84176.0317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111255.3525; train_chrom_access_recon_loss: 6169578.8106; train_global_loss: 26729871.8485; train_optim_loss: 26729871.8485; val_kl_reg_loss: 70029.4658; val_edge_recon_loss: 605578.0781; val_gene_expr_recon_loss: 19508528.7500; val_masked_gp_l1_reg_loss: 84731.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111138.4766; val_chrom_access_recon_loss: 6073392.6250; val_global_loss: 26453398.7500; val_optim_loss: 26453398.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9401; val_auprc_score: 0.9218; val_best_acc_score: 0.8818; val_best_f1_score: 0.8859; train_kl_reg_loss: 69992.2567; train_edge_recon_loss: 594986.5890; train_gene_expr_recon_loss: 19652778.0000; train_masked_gp_l1_reg_loss: 85178.8082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109910.4602; train_chrom_access_recon_loss: 6149489.4470; train_global_loss: 26662335.4545; train_optim_loss: 26662335.4545; val_kl_reg_loss: 68604.6846; val_edge_recon_loss: 594765.5000; val_gene_expr_recon_loss: 19543242.7500; val_masked_gp_l1_reg_loss: 85747.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110368.2891; val_chrom_access_recon_loss: 6126546.6250; val_global_loss: 26529275.2500; val_optim_loss: 26529275.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9414; val_auprc_score: 0.9243; val_best_acc_score: 0.8847; val_best_f1_score: 0.8891; train_kl_reg_loss: 68917.2289; train_edge_recon_loss: 593639.8277; train_gene_expr_recon_loss: 19600758.4545; train_masked_gp_l1_reg_loss: 86173.7406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109118.5468; train_chrom_access_recon_loss: 6128109.7576; train_global_loss: 26586717.2727; train_optim_loss: 26586717.2727; val_kl_reg_loss: 67990.2773; val_edge_recon_loss: 597476.1250; val_gene_expr_recon_loss: 19386953.0000; val_masked_gp_l1_reg_loss: 86632.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108487.2266; val_chrom_access_recon_loss: 6048510.7500; val_global_loss: 26296050.2500; val_optim_loss: 26296050.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9424; val_auprc_score: 0.9235; val_best_acc_score: 0.8853; val_best_f1_score: 0.8909; train_kl_reg_loss: 68461.8091; train_edge_recon_loss: 590573.4280; train_gene_expr_recon_loss: 19554113.0303; train_masked_gp_l1_reg_loss: 87192.0566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108122.7956; train_chrom_access_recon_loss: 6104282.2197; train_global_loss: 26512745.2121; train_optim_loss: 26512745.2121; val_kl_reg_loss: 68335.5566; val_edge_recon_loss: 594753.0156; val_gene_expr_recon_loss: 19391698.0000; val_masked_gp_l1_reg_loss: 87640.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107597.1406; val_chrom_access_recon_loss: 6129380.0000; val_global_loss: 26379404.5000; val_optim_loss: 26379404.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9438; val_auprc_score: 0.9248; val_best_acc_score: 0.8850; val_best_f1_score: 0.8901; train_kl_reg_loss: 67776.0295; train_edge_recon_loss: 590209.2917; train_gene_expr_recon_loss: 19514716.9394; train_masked_gp_l1_reg_loss: 88155.4985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107405.1579; train_chrom_access_recon_loss: 6091562.7879; train_global_loss: 26459825.6970; train_optim_loss: 26459825.6970; val_kl_reg_loss: 66950.7090; val_edge_recon_loss: 593186.2500; val_gene_expr_recon_loss: 19552615.7500; val_masked_gp_l1_reg_loss: 88675.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106886.4141; val_chrom_access_recon_loss: 6093899.2500; val_global_loss: 26502214.5000; val_optim_loss: 26502214.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9426; val_auprc_score: 0.9227; val_best_acc_score: 0.8872; val_best_f1_score: 0.8930; train_kl_reg_loss: 67648.0334; train_edge_recon_loss: 587667.9574; train_gene_expr_recon_loss: 19447295.5758; train_masked_gp_l1_reg_loss: 89102.8335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106450.2044; train_chrom_access_recon_loss: 6071416.6061; train_global_loss: 26369581.0606; train_optim_loss: 26369581.0606; val_kl_reg_loss: 68278.1650; val_edge_recon_loss: 595284.4609; val_gene_expr_recon_loss: 19259249.7500; val_masked_gp_l1_reg_loss: 89611.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106085.7656; val_chrom_access_recon_loss: 6037202.6250; val_global_loss: 26155712.5000; val_optim_loss: 26155712.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9476; val_auprc_score: 0.9306; val_best_acc_score: 0.8944; val_best_f1_score: 0.8991; train_kl_reg_loss: 66616.6200; train_edge_recon_loss: 587648.9763; train_gene_expr_recon_loss: 19412361.1818; train_masked_gp_l1_reg_loss: 90133.8037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105829.1591; train_chrom_access_recon_loss: 6048795.8864; train_global_loss: 26311385.6364; train_optim_loss: 26311385.6364; val_kl_reg_loss: 66978.8955; val_edge_recon_loss: 592307.1719; val_gene_expr_recon_loss: 19317712.7500; val_masked_gp_l1_reg_loss: 90781.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105452.3125; val_chrom_access_recon_loss: 6009987.4375; val_global_loss: 26183220.0000; val_optim_loss: 26183220.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9487; val_auprc_score: 0.9323; val_best_acc_score: 0.8931; val_best_f1_score: 0.8960; train_kl_reg_loss: 66352.9172; train_edge_recon_loss: 587154.3854; train_gene_expr_recon_loss: 19362644.8788; train_masked_gp_l1_reg_loss: 91182.3622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105353.6751; train_chrom_access_recon_loss: 6028663.9318; train_global_loss: 26241351.5455; train_optim_loss: 26241351.5455; val_kl_reg_loss: 66336.2568; val_edge_recon_loss: 590641.0312; val_gene_expr_recon_loss: 19360509.7500; val_masked_gp_l1_reg_loss: 91693.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105268.7266; val_chrom_access_recon_loss: 5994587.5000; val_global_loss: 26209036.2500; val_optim_loss: 26209036.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9450; val_auprc_score: 0.9290; val_best_acc_score: 0.8874; val_best_f1_score: 0.8922; train_kl_reg_loss: 65640.3201; train_edge_recon_loss: 585621.5331; train_gene_expr_recon_loss: 19342235.2424; train_masked_gp_l1_reg_loss: 92230.4240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104923.8575; train_chrom_access_recon_loss: 6015816.9545; train_global_loss: 26206468.4848; train_optim_loss: 26206468.4848; val_kl_reg_loss: 65014.3926; val_edge_recon_loss: 593579.5312; val_gene_expr_recon_loss: 19395392.0000; val_masked_gp_l1_reg_loss: 92693.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105502.5938; val_chrom_access_recon_loss: 6077766.7500; val_global_loss: 26329948.2500; val_optim_loss: 26329948.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9528; val_auprc_score: 0.9412; val_best_acc_score: 0.9019; val_best_f1_score: 0.9066; train_kl_reg_loss: 65176.6665; train_edge_recon_loss: 585482.9744; train_gene_expr_recon_loss: 19288771.7273; train_masked_gp_l1_reg_loss: 93332.7929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105243.5146; train_chrom_access_recon_loss: 5998265.2197; train_global_loss: 26136273.0303; train_optim_loss: 26136273.0303; val_kl_reg_loss: 65552.8901; val_edge_recon_loss: 590078.9219; val_gene_expr_recon_loss: 19114017.7500; val_masked_gp_l1_reg_loss: 93786.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105045.3906; val_chrom_access_recon_loss: 5949583.5000; val_global_loss: 25918065.0000; val_optim_loss: 25918065.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9499; val_auprc_score: 0.9345; val_best_acc_score: 0.9011; val_best_f1_score: 0.9033; train_kl_reg_loss: 65111.6460; train_edge_recon_loss: 585888.5246; train_gene_expr_recon_loss: 19249157.7273; train_masked_gp_l1_reg_loss: 94363.7655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104787.1630; train_chrom_access_recon_loss: 5982884.0985; train_global_loss: 26082192.6970; train_optim_loss: 26082192.6970; val_kl_reg_loss: 64861.3071; val_edge_recon_loss: 593000.5000; val_gene_expr_recon_loss: 19230482.2500; val_masked_gp_l1_reg_loss: 94972.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105026.7031; val_chrom_access_recon_loss: 6049194.6250; val_global_loss: 26137536.7500; val_optim_loss: 26137536.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9460; val_auprc_score: 0.9310; val_best_acc_score: 0.8944; val_best_f1_score: 0.8986; train_kl_reg_loss: 64949.4428; train_edge_recon_loss: 585279.3769; train_gene_expr_recon_loss: 19188450.3636; train_masked_gp_l1_reg_loss: 95340.3548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104688.8178; train_chrom_access_recon_loss: 5959505.6818; train_global_loss: 25998213.8182; train_optim_loss: 25998213.8182; val_kl_reg_loss: 64532.4873; val_edge_recon_loss: 594846.1953; val_gene_expr_recon_loss: 19033071.7500; val_masked_gp_l1_reg_loss: 95826.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104765.1172; val_chrom_access_recon_loss: 5939713.3750; val_global_loss: 25832755.5000; val_optim_loss: 25832755.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9506; val_auprc_score: 0.9345; val_best_acc_score: 0.8992; val_best_f1_score: 0.9037; train_kl_reg_loss: 64445.5065; train_edge_recon_loss: 586208.3068; train_gene_expr_recon_loss: 19156879.1515; train_masked_gp_l1_reg_loss: 96325.6219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104691.1269; train_chrom_access_recon_loss: 5949228.8333; train_global_loss: 25957778.5455; train_optim_loss: 25957778.5455; val_kl_reg_loss: 62934.7373; val_edge_recon_loss: 585702.8125; val_gene_expr_recon_loss: 19300998.2500; val_masked_gp_l1_reg_loss: 96834.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104603.4766; val_chrom_access_recon_loss: 6015726.8750; val_global_loss: 26166801.5000; val_optim_loss: 26166801.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9483; val_auprc_score: 0.9343; val_best_acc_score: 0.8947; val_best_f1_score: 0.8988; train_kl_reg_loss: 64126.9331; train_edge_recon_loss: 584869.5739; train_gene_expr_recon_loss: 19111668.6364; train_masked_gp_l1_reg_loss: 97313.1625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104643.6360; train_chrom_access_recon_loss: 5923903.5000; train_global_loss: 25886525.2727; train_optim_loss: 25886525.2727; val_kl_reg_loss: 64144.7695; val_edge_recon_loss: 594328.8516; val_gene_expr_recon_loss: 19192101.0000; val_masked_gp_l1_reg_loss: 97799.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104521.7266; val_chrom_access_recon_loss: 6010281.5625; val_global_loss: 26063178.0000; val_optim_loss: 26063178.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9521; val_auprc_score: 0.9341; val_best_acc_score: 0.8984; val_best_f1_score: 0.9035; train_kl_reg_loss: 64131.8597; train_edge_recon_loss: 583507.3580; train_gene_expr_recon_loss: 19081189.8485; train_masked_gp_l1_reg_loss: 98227.6295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104683.4626; train_chrom_access_recon_loss: 5911579.9394; train_global_loss: 25843320.3030; train_optim_loss: 25843320.3030; val_kl_reg_loss: 63770.4458; val_edge_recon_loss: 589962.2266; val_gene_expr_recon_loss: 18992562.7500; val_masked_gp_l1_reg_loss: 98716.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104369.5078; val_chrom_access_recon_loss: 5931505.1250; val_global_loss: 25780887.0000; val_optim_loss: 25780887.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9495; val_auprc_score: 0.9358; val_best_acc_score: 0.8944; val_best_f1_score: 0.8996; train_kl_reg_loss: 64016.2817; train_edge_recon_loss: 584449.4091; train_gene_expr_recon_loss: 19035189.0606; train_masked_gp_l1_reg_loss: 99106.5466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104522.6115; train_chrom_access_recon_loss: 5892747.0985; train_global_loss: 25780031.1818; train_optim_loss: 25780031.1818; val_kl_reg_loss: 64006.9795; val_edge_recon_loss: 594465.5703; val_gene_expr_recon_loss: 19192605.7500; val_masked_gp_l1_reg_loss: 99496.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105093.1719; val_chrom_access_recon_loss: 5963174.7500; val_global_loss: 26018843.0000; val_optim_loss: 26018843.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9542; val_auprc_score: 0.9414; val_best_acc_score: 0.9001; val_best_f1_score: 0.9037; train_kl_reg_loss: 63823.4763; train_edge_recon_loss: 583029.8968; train_gene_expr_recon_loss: 19003595.1818; train_masked_gp_l1_reg_loss: 99986.9477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104826.1849; train_chrom_access_recon_loss: 5881945.8788; train_global_loss: 25737207.4545; train_optim_loss: 25737207.4545; val_kl_reg_loss: 62105.8330; val_edge_recon_loss: 586670.1094; val_gene_expr_recon_loss: 18960144.7500; val_masked_gp_l1_reg_loss: 100470.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104829.5156; val_chrom_access_recon_loss: 5874809.5000; val_global_loss: 25689030.2500; val_optim_loss: 25689030.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9463; val_auprc_score: 0.9275; val_best_acc_score: 0.8904; val_best_f1_score: 0.8962; train_kl_reg_loss: 64096.9688; train_edge_recon_loss: 583379.9943; train_gene_expr_recon_loss: 18958037.1212; train_masked_gp_l1_reg_loss: 100769.7821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104738.5682; train_chrom_access_recon_loss: 5867385.6515; train_global_loss: 25678408.0909; train_optim_loss: 25678408.0909; val_kl_reg_loss: 62777.2114; val_edge_recon_loss: 593480.4219; val_gene_expr_recon_loss: 18796512.5000; val_masked_gp_l1_reg_loss: 101237.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105115.2109; val_chrom_access_recon_loss: 5846978.2500; val_global_loss: 25506102.2500; val_optim_loss: 25506102.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9487; val_auprc_score: 0.9299; val_best_acc_score: 0.8939; val_best_f1_score: 0.8998; train_kl_reg_loss: 64090.5481; train_edge_recon_loss: 582090.7898; train_gene_expr_recon_loss: 18918416.6364; train_masked_gp_l1_reg_loss: 101581.1138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104970.2109; train_chrom_access_recon_loss: 5849659.7424; train_global_loss: 25620809.1515; train_optim_loss: 25620809.1515; val_kl_reg_loss: 64863.8467; val_edge_recon_loss: 591815.2656; val_gene_expr_recon_loss: 18892080.7500; val_masked_gp_l1_reg_loss: 101929.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104983.7266; val_chrom_access_recon_loss: 5868325.1250; val_global_loss: 25623998.7500; val_optim_loss: 25623998.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9469; val_auprc_score: 0.9328; val_best_acc_score: 0.8874; val_best_f1_score: 0.8941; train_kl_reg_loss: 64183.4960; train_edge_recon_loss: 583403.6193; train_gene_expr_recon_loss: 18895838.8182; train_masked_gp_l1_reg_loss: 102245.3402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104970.7192; train_chrom_access_recon_loss: 5843579.7273; train_global_loss: 25594221.8485; train_optim_loss: 25594221.8485; val_kl_reg_loss: 63315.9941; val_edge_recon_loss: 595502.3984; val_gene_expr_recon_loss: 18833511.0000; val_masked_gp_l1_reg_loss: 102580.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104902.3906; val_chrom_access_recon_loss: 5885169.3750; val_global_loss: 25584981.2500; val_optim_loss: 25584981.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9527; val_auprc_score: 0.9395; val_best_acc_score: 0.8987; val_best_f1_score: 0.9038; train_kl_reg_loss: 64078.6303; train_edge_recon_loss: 583352.5530; train_gene_expr_recon_loss: 18867739.5152; train_masked_gp_l1_reg_loss: 102869.7985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104971.2539; train_chrom_access_recon_loss: 5832019.1364; train_global_loss: 25555030.8182; train_optim_loss: 25555030.8182; val_kl_reg_loss: 64377.7715; val_edge_recon_loss: 588615.4453; val_gene_expr_recon_loss: 19064072.7500; val_masked_gp_l1_reg_loss: 103125.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105289.5391; val_chrom_access_recon_loss: 5964841.5000; val_global_loss: 25890323.5000; val_optim_loss: 25890323.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9480; val_auprc_score: 0.9306; val_best_acc_score: 0.8949; val_best_f1_score: 0.9008; train_kl_reg_loss: 64300.4333; train_edge_recon_loss: 582627.8277; train_gene_expr_recon_loss: 18822119.8788; train_masked_gp_l1_reg_loss: 103544.0344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105211.2589; train_chrom_access_recon_loss: 5814410.0000; train_global_loss: 25492213.4545; train_optim_loss: 25492213.4545; val_kl_reg_loss: 63764.8833; val_edge_recon_loss: 591449.3672; val_gene_expr_recon_loss: 18822916.7500; val_masked_gp_l1_reg_loss: 103860.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105423.7422; val_chrom_access_recon_loss: 5862576.6250; val_global_loss: 25549992.0000; val_optim_loss: 25549992.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9510; val_auprc_score: 0.9343; val_best_acc_score: 0.8982; val_best_f1_score: 0.9037; train_kl_reg_loss: 64092.2026; train_edge_recon_loss: 580755.2547; train_gene_expr_recon_loss: 18762134.8788; train_masked_gp_l1_reg_loss: 102810.5683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82262.6276; train_chrom_access_recon_loss: 5789447.7197; train_global_loss: 25381503.3333; train_optim_loss: 25381503.3333; val_kl_reg_loss: 64809.9829; val_edge_recon_loss: 586762.8750; val_gene_expr_recon_loss: 18808549.7500; val_masked_gp_l1_reg_loss: 102357.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76358.8594; val_chrom_access_recon_loss: 5856793.0000; val_global_loss: 25495632.0000; val_optim_loss: 25495632.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9501; val_auprc_score: 0.9320; val_best_acc_score: 0.8939; val_best_f1_score: 0.8987; train_kl_reg_loss: 64648.2230; train_edge_recon_loss: 581892.8333; train_gene_expr_recon_loss: 18745338.8182; train_masked_gp_l1_reg_loss: 102312.9362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75528.4906; train_chrom_access_recon_loss: 5789691.1136; train_global_loss: 25359412.3939; train_optim_loss: 25359412.3939; val_kl_reg_loss: 64925.1597; val_edge_recon_loss: 594723.5234; val_gene_expr_recon_loss: 18748415.5000; val_masked_gp_l1_reg_loss: 102312.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74898.1016; val_chrom_access_recon_loss: 5813924.2500; val_global_loss: 25399198.0000; val_optim_loss: 25399198.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9476; val_auprc_score: 0.9316; val_best_acc_score: 0.8912; val_best_f1_score: 0.8976; train_kl_reg_loss: 64878.4603; train_edge_recon_loss: 583163.7869; train_gene_expr_recon_loss: 18762108.8182; train_masked_gp_l1_reg_loss: 102335.5470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74467.7855; train_chrom_access_recon_loss: 5786728.5303; train_global_loss: 25373682.8485; train_optim_loss: 25373682.8485; val_kl_reg_loss: 64582.6162; val_edge_recon_loss: 591588.3281; val_gene_expr_recon_loss: 18730732.2500; val_masked_gp_l1_reg_loss: 102361.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74115.5703; val_chrom_access_recon_loss: 5807196.8750; val_global_loss: 25370577.5000; val_optim_loss: 25370577.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9471; val_auprc_score: 0.9311; val_best_acc_score: 0.8941; val_best_f1_score: 0.8991; train_kl_reg_loss: 64730.0082; train_edge_recon_loss: 582257.5634; train_gene_expr_recon_loss: 18769980.9697; train_masked_gp_l1_reg_loss: 102394.6181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73833.0382; train_chrom_access_recon_loss: 5794985.8636; train_global_loss: 25388182.0909; train_optim_loss: 25388182.0909; val_kl_reg_loss: 64914.9502; val_edge_recon_loss: 594839.3594; val_gene_expr_recon_loss: 18924382.7500; val_masked_gp_l1_reg_loss: 102434.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73537.2969; val_chrom_access_recon_loss: 5928189.6250; val_global_loss: 25688299.0000; val_optim_loss: 25688299.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9485; val_auprc_score: 0.9329; val_best_acc_score: 0.8968; val_best_f1_score: 0.9028; train_kl_reg_loss: 64855.3835; train_edge_recon_loss: 581438.2898; train_gene_expr_recon_loss: 18742668.0909; train_masked_gp_l1_reg_loss: 102464.0368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73271.5766; train_chrom_access_recon_loss: 5784188.6288; train_global_loss: 25348886.1515; train_optim_loss: 25348886.1515; val_kl_reg_loss: 65315.3340; val_edge_recon_loss: 591521.2578; val_gene_expr_recon_loss: 18891934.5000; val_masked_gp_l1_reg_loss: 102514.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73102.0234; val_chrom_access_recon_loss: 5873472.5000; val_global_loss: 25597860.0000; val_optim_loss: 25597860.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9428; val_auprc_score: 0.9237; val_best_acc_score: 0.8847; val_best_f1_score: 0.8927; train_kl_reg_loss: 64951.3581; train_edge_recon_loss: 580278.6884; train_gene_expr_recon_loss: 18730962.3333; train_masked_gp_l1_reg_loss: 102553.4222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72881.6779; train_chrom_access_recon_loss: 5776383.3333; train_global_loss: 25328010.7576; train_optim_loss: 25328010.7576; val_kl_reg_loss: 65336.4536; val_edge_recon_loss: 593932.8125; val_gene_expr_recon_loss: 18892144.0000; val_masked_gp_l1_reg_loss: 102601.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72649.2891; val_chrom_access_recon_loss: 5865397.5000; val_global_loss: 25592063.2500; val_optim_loss: 25592063.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9506; val_auprc_score: 0.9363; val_best_acc_score: 0.8955; val_best_f1_score: 0.9017; train_kl_reg_loss: 65017.4444; train_edge_recon_loss: 582333.0777; train_gene_expr_recon_loss: 18719957.3636; train_masked_gp_l1_reg_loss: 102651.5598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72442.6490; train_chrom_access_recon_loss: 5772218.3636; train_global_loss: 25314620.3333; train_optim_loss: 25314620.3333; val_kl_reg_loss: 65014.4253; val_edge_recon_loss: 588135.2500; val_gene_expr_recon_loss: 18788896.2500; val_masked_gp_l1_reg_loss: 102708.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72238.8828; val_chrom_access_recon_loss: 5853614.1875; val_global_loss: 25470605.7500; val_optim_loss: 25470605.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9452; val_auprc_score: 0.9217; val_best_acc_score: 0.8941; val_best_f1_score: 0.9006; train_kl_reg_loss: 64958.6303; train_edge_recon_loss: 580845.2670; train_gene_expr_recon_loss: 18719117.1818; train_masked_gp_l1_reg_loss: 102590.8473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69976.6972; train_chrom_access_recon_loss: 5771945.1894; train_global_loss: 25309433.6364; train_optim_loss: 25309433.6364; val_kl_reg_loss: 64928.1743; val_edge_recon_loss: 591675.5703; val_gene_expr_recon_loss: 18736249.7500; val_masked_gp_l1_reg_loss: 102535.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69415.5859; val_chrom_access_recon_loss: 5851190.8750; val_global_loss: 25415996.2500; val_optim_loss: 25415996.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9414; val_auprc_score: 0.9220; val_best_acc_score: 0.8850; val_best_f1_score: 0.8937; train_kl_reg_loss: 64952.1336; train_edge_recon_loss: 581195.0066; train_gene_expr_recon_loss: 18729673.5455; train_masked_gp_l1_reg_loss: 102524.4859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69326.0367; train_chrom_access_recon_loss: 5776473.5833; train_global_loss: 25324144.7273; train_optim_loss: 25324144.7273; val_kl_reg_loss: 65301.4976; val_edge_recon_loss: 595990.5938; val_gene_expr_recon_loss: 19069046.7500; val_masked_gp_l1_reg_loss: 102519.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69247.8047; val_chrom_access_recon_loss: 5917254.3125; val_global_loss: 25819361.2500; val_optim_loss: 25819361.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9529; val_auprc_score: 0.9384; val_best_acc_score: 0.8944; val_best_f1_score: 0.9008; train_kl_reg_loss: 64976.5245; train_edge_recon_loss: 581937.0407; train_gene_expr_recon_loss: 18729859.9091; train_masked_gp_l1_reg_loss: 102518.6989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69192.2765; train_chrom_access_recon_loss: 5769978.6136; train_global_loss: 25318463.2121; train_optim_loss: 25318463.2121; val_kl_reg_loss: 65076.3721; val_edge_recon_loss: 590845.1953; val_gene_expr_recon_loss: 19052497.5000; val_masked_gp_l1_reg_loss: 102521.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69142.8047; val_chrom_access_recon_loss: 5895263.0625; val_global_loss: 25775346.7500; val_optim_loss: 25775346.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9534; val_auprc_score: 0.9396; val_best_acc_score: 0.8995; val_best_f1_score: 0.9051; train_kl_reg_loss: 65045.2454; train_edge_recon_loss: 580231.2434; train_gene_expr_recon_loss: 18723686.8485; train_masked_gp_l1_reg_loss: 102523.8755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69106.5736; train_chrom_access_recon_loss: 5773027.3939; train_global_loss: 25313621.1212; train_optim_loss: 25313621.1212; val_kl_reg_loss: 65330.5713; val_edge_recon_loss: 588301.8906; val_gene_expr_recon_loss: 18942872.7500; val_masked_gp_l1_reg_loss: 102524.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69059.9062; val_chrom_access_recon_loss: 5883211.5000; val_global_loss: 25651301.0000; val_optim_loss: 25651301.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 16 min 16 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9511
val AUPRC score: 0.9357
val best accuracy score: 0.9001
val best F1 score: 0.9061
val target rna MSE score: 1.1786
val source rna MSE score: 0.6583
val target atac MSE score: 0.3189
val source atac MSE score: 0.1246
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
