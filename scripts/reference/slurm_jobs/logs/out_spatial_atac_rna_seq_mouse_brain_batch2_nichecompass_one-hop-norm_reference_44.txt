[True]
Run timestamp: 07082023_184016_44.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_44']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8841; val_auprc_score: 0.9048; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 6682.2147; train_edge_recon_loss: 35468.8329; train_gene_expr_recon_loss: 1282934.7917; train_masked_gp_l1_reg_loss: 15637.6682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119326.2908; train_chrom_access_recon_loss: 876623.5347; train_global_loss: 2336673.3333; train_optim_loss: 2336673.3333; val_kl_reg_loss: 2418.6167; val_edge_recon_loss: 40656.2969; val_gene_expr_recon_loss: 1062553.1250; val_masked_gp_l1_reg_loss: 10367.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117032.3125; val_chrom_access_recon_loss: 502265.9062; val_global_loss: 1735294.1250; val_optim_loss: 1735294.1250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8949; val_auprc_score: 0.9076; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 2520.7562; train_edge_recon_loss: 35487.3451; train_gene_expr_recon_loss: 1021773.2361; train_masked_gp_l1_reg_loss: 8736.8821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115706.8047; train_chrom_access_recon_loss: 490414.1701; train_global_loss: 1674639.2361; train_optim_loss: 1674639.2361; val_kl_reg_loss: 4273.7041; val_edge_recon_loss: 40659.3750; val_gene_expr_recon_loss: 958292.0000; val_masked_gp_l1_reg_loss: 7888.5737; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114106.8750; val_chrom_access_recon_loss: 484086.5625; val_global_loss: 1609307.0000; val_optim_loss: 1609307.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8938; val_auprc_score: 0.9117; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 9236.0789; train_edge_recon_loss: 37137.4280; train_gene_expr_recon_loss: 892156.2708; train_masked_gp_l1_reg_loss: 8510.8422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112865.3012; train_chrom_access_recon_loss: 487606.1215; train_global_loss: 1547512.0278; train_optim_loss: 1547512.0278; val_kl_reg_loss: 13295.4648; val_edge_recon_loss: 40661.3086; val_gene_expr_recon_loss: 828243.9375; val_masked_gp_l1_reg_loss: 9021.7666; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111285.9219; val_chrom_access_recon_loss: 476566.9375; val_global_loss: 1479075.2500; val_optim_loss: 1479075.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8872; val_auprc_score: 0.9002; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 14844.3147; train_edge_recon_loss: 38211.7023; train_gene_expr_recon_loss: 798931.1042; train_masked_gp_l1_reg_loss: 9137.5961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109905.3811; train_chrom_access_recon_loss: 470063.9097; train_global_loss: 1441094.0139; train_optim_loss: 1441094.0139; val_kl_reg_loss: 15634.8691; val_edge_recon_loss: 40660.3906; val_gene_expr_recon_loss: 772429.1250; val_masked_gp_l1_reg_loss: 9374.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108084.1016; val_chrom_access_recon_loss: 458213.1875; val_global_loss: 1404396.6250; val_optim_loss: 1404396.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8828; val_auprc_score: 0.8958; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 17756.9691; train_edge_recon_loss: 38500.6740; train_gene_expr_recon_loss: 754327.9028; train_masked_gp_l1_reg_loss: 9516.2026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106468.5234; train_chrom_access_recon_loss: 455929.3368; train_global_loss: 1382499.6250; train_optim_loss: 1382499.6250; val_kl_reg_loss: 18119.4805; val_edge_recon_loss: 40659.4219; val_gene_expr_recon_loss: 736935.5625; val_masked_gp_l1_reg_loss: 9596.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104347.4219; val_chrom_access_recon_loss: 450336.1250; val_global_loss: 1359995.0000; val_optim_loss: 1359995.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8775; val_auprc_score: 0.8848; val_best_acc_score: 0.5019; val_best_f1_score: 0.6675; train_kl_reg_loss: 18984.8622; train_edge_recon_loss: 38650.2344; train_gene_expr_recon_loss: 727640.5486; train_masked_gp_l1_reg_loss: 9605.4487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102525.2092; train_chrom_access_recon_loss: 450540.6910; train_global_loss: 1347947.0000; train_optim_loss: 1347947.0000; val_kl_reg_loss: 18565.7715; val_edge_recon_loss: 40657.2773; val_gene_expr_recon_loss: 716159.2500; val_masked_gp_l1_reg_loss: 9578.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100188.3594; val_chrom_access_recon_loss: 446302.5312; val_global_loss: 1331451.8750; val_optim_loss: 1331451.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8686; val_auprc_score: 0.8706; val_best_acc_score: 0.5077; val_best_f1_score: 0.6701; train_kl_reg_loss: 18942.4379; train_edge_recon_loss: 38667.9162; train_gene_expr_recon_loss: 708853.3194; train_masked_gp_l1_reg_loss: 9553.2679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98252.3377; train_chrom_access_recon_loss: 447040.2396; train_global_loss: 1321309.5000; train_optim_loss: 1321309.5000; val_kl_reg_loss: 18332.3828; val_edge_recon_loss: 40652.2383; val_gene_expr_recon_loss: 701960.5000; val_masked_gp_l1_reg_loss: 9514.3770; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95804.4219; val_chrom_access_recon_loss: 443400.7188; val_global_loss: 1309664.6250; val_optim_loss: 1309664.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8663; val_auprc_score: 0.8698; val_best_acc_score: 0.5131; val_best_f1_score: 0.6725; train_kl_reg_loss: 18913.1120; train_edge_recon_loss: 38663.8576; train_gene_expr_recon_loss: 693302.0556; train_masked_gp_l1_reg_loss: 9489.2680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93822.7118; train_chrom_access_recon_loss: 445158.8264; train_global_loss: 1299349.8333; train_optim_loss: 1299349.8333; val_kl_reg_loss: 18476.1172; val_edge_recon_loss: 40646.7305; val_gene_expr_recon_loss: 690878.0000; val_masked_gp_l1_reg_loss: 9443.1426; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91339.8359; val_chrom_access_recon_loss: 441212.1250; val_global_loss: 1291996.0000; val_optim_loss: 1291996.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8644; val_auprc_score: 0.8702; val_best_acc_score: 0.5279; val_best_f1_score: 0.6789; train_kl_reg_loss: 19324.4249; train_edge_recon_loss: 38734.2860; train_gene_expr_recon_loss: 690353.2569; train_masked_gp_l1_reg_loss: 9400.3530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89358.2309; train_chrom_access_recon_loss: 442335.5208; train_global_loss: 1289506.0833; train_optim_loss: 1289506.0833; val_kl_reg_loss: 18697.0039; val_edge_recon_loss: 40638.0391; val_gene_expr_recon_loss: 681921.9375; val_masked_gp_l1_reg_loss: 9341.3848; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86891.0781; val_chrom_access_recon_loss: 439522.4062; val_global_loss: 1277011.8750; val_optim_loss: 1277011.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8690; val_auprc_score: 0.8712; val_best_acc_score: 0.5493; val_best_f1_score: 0.6885; train_kl_reg_loss: 19681.3466; train_edge_recon_loss: 38784.4983; train_gene_expr_recon_loss: 680957.4861; train_masked_gp_l1_reg_loss: 9309.7636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84947.7188; train_chrom_access_recon_loss: 441484.2049; train_global_loss: 1275165.0000; train_optim_loss: 1275165.0000; val_kl_reg_loss: 19269.1328; val_edge_recon_loss: 40626.8203; val_gene_expr_recon_loss: 674877.1250; val_masked_gp_l1_reg_loss: 9264.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82533.3594; val_chrom_access_recon_loss: 438162.0000; val_global_loss: 1264732.7500; val_optim_loss: 1264732.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8573; val_auprc_score: 0.8568; val_best_acc_score: 0.5732; val_best_f1_score: 0.6989; train_kl_reg_loss: 20083.2604; train_edge_recon_loss: 38829.5560; train_gene_expr_recon_loss: 672349.0764; train_masked_gp_l1_reg_loss: 9225.8689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80642.6380; train_chrom_access_recon_loss: 440592.1806; train_global_loss: 1261722.5833; train_optim_loss: 1261722.5833; val_kl_reg_loss: 19008.2051; val_edge_recon_loss: 40614.4102; val_gene_expr_recon_loss: 670184.4375; val_masked_gp_l1_reg_loss: 9172.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78302.0547; val_chrom_access_recon_loss: 436618.6875; val_global_loss: 1253900.2500; val_optim_loss: 1253900.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8536; val_auprc_score: 0.8516; val_best_acc_score: 0.5943; val_best_f1_score: 0.7088; train_kl_reg_loss: 19971.0605; train_edge_recon_loss: 38844.4249; train_gene_expr_recon_loss: 670176.7431; train_masked_gp_l1_reg_loss: 9146.3015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76479.4010; train_chrom_access_recon_loss: 436904.5174; train_global_loss: 1251522.4583; train_optim_loss: 1251522.4583; val_kl_reg_loss: 19172.4375; val_edge_recon_loss: 40602.2109; val_gene_expr_recon_loss: 665891.6250; val_masked_gp_l1_reg_loss: 9111.0693; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74227.0156; val_chrom_access_recon_loss: 436214.5938; val_global_loss: 1245218.8750; val_optim_loss: 1245218.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8599; val_auprc_score: 0.8573; val_best_acc_score: 0.6229; val_best_f1_score: 0.7224; train_kl_reg_loss: 20029.8826; train_edge_recon_loss: 38864.3320; train_gene_expr_recon_loss: 666137.2222; train_masked_gp_l1_reg_loss: 9088.6331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72480.5686; train_chrom_access_recon_loss: 439703.5833; train_global_loss: 1246304.2361; train_optim_loss: 1246304.2361; val_kl_reg_loss: 18871.9980; val_edge_recon_loss: 40587.5117; val_gene_expr_recon_loss: 662656.9375; val_masked_gp_l1_reg_loss: 9061.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70330.7891; val_chrom_access_recon_loss: 435190.9688; val_global_loss: 1236700.1250; val_optim_loss: 1236700.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8695; val_auprc_score: 0.8670; val_best_acc_score: 0.6551; val_best_f1_score: 0.7389; train_kl_reg_loss: 19585.9722; train_edge_recon_loss: 38822.4488; train_gene_expr_recon_loss: 661793.7153; train_masked_gp_l1_reg_loss: 9047.6482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68670.1189; train_chrom_access_recon_loss: 436060.9549; train_global_loss: 1233980.8333; train_optim_loss: 1233980.8333; val_kl_reg_loss: 18650.1445; val_edge_recon_loss: 40572.1172; val_gene_expr_recon_loss: 659917.2500; val_masked_gp_l1_reg_loss: 9027.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66618.9766; val_chrom_access_recon_loss: 434084.4375; val_global_loss: 1228871.0000; val_optim_loss: 1228871.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8824; val_auprc_score: 0.8788; val_best_acc_score: 0.6966; val_best_f1_score: 0.7614; train_kl_reg_loss: 19227.2808; train_edge_recon_loss: 38798.7648; train_gene_expr_recon_loss: 655015.2153; train_masked_gp_l1_reg_loss: 9012.2383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65038.0499; train_chrom_access_recon_loss: 435022.1806; train_global_loss: 1222113.7083; train_optim_loss: 1222113.7083; val_kl_reg_loss: 18493.1328; val_edge_recon_loss: 40550.9258; val_gene_expr_recon_loss: 657426.6250; val_masked_gp_l1_reg_loss: 8984.5576; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63093.4219; val_chrom_access_recon_loss: 433269.7188; val_global_loss: 1221818.3750; val_optim_loss: 1221818.3750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8977; val_auprc_score: 0.8965; val_best_acc_score: 0.7505; val_best_f1_score: 0.7930; train_kl_reg_loss: 18971.4546; train_edge_recon_loss: 38766.1918; train_gene_expr_recon_loss: 654466.1667; train_masked_gp_l1_reg_loss: 8970.7245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61603.0343; train_chrom_access_recon_loss: 435120.8819; train_global_loss: 1217898.4444; train_optim_loss: 1217898.4444; val_kl_reg_loss: 18315.0781; val_edge_recon_loss: 40509.9219; val_gene_expr_recon_loss: 655228.8125; val_masked_gp_l1_reg_loss: 8954.2334; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59776.1719; val_chrom_access_recon_loss: 432460.2188; val_global_loss: 1215244.5000; val_optim_loss: 1215244.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9100; val_auprc_score: 0.8993; val_best_acc_score: 0.8058; val_best_f1_score: 0.8282; train_kl_reg_loss: 18602.9436; train_edge_recon_loss: 38744.1328; train_gene_expr_recon_loss: 651926.4861; train_masked_gp_l1_reg_loss: 8945.1909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58381.6120; train_chrom_access_recon_loss: 435132.2396; train_global_loss: 1211732.5833; train_optim_loss: 1211732.5833; val_kl_reg_loss: 17989.4707; val_edge_recon_loss: 40446.5938; val_gene_expr_recon_loss: 653411.8750; val_masked_gp_l1_reg_loss: 8934.0400; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56671.1172; val_chrom_access_recon_loss: 431780.2188; val_global_loss: 1209233.3750; val_optim_loss: 1209233.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9162; val_auprc_score: 0.9066; val_best_acc_score: 0.8319; val_best_f1_score: 0.8446; train_kl_reg_loss: 18461.8741; train_edge_recon_loss: 38663.9167; train_gene_expr_recon_loss: 653355.1250; train_masked_gp_l1_reg_loss: 8928.7604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55369.7882; train_chrom_access_recon_loss: 434381.7188; train_global_loss: 1209161.1667; train_optim_loss: 1209161.1667; val_kl_reg_loss: 17589.3340; val_edge_recon_loss: 40382.0391; val_gene_expr_recon_loss: 651820.1875; val_masked_gp_l1_reg_loss: 8921.5713; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53779.9375; val_chrom_access_recon_loss: 430962.0625; val_global_loss: 1203455.1250; val_optim_loss: 1203455.1250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9207; val_auprc_score: 0.9159; val_best_acc_score: 0.8391; val_best_f1_score: 0.8471; train_kl_reg_loss: 18208.7020; train_edge_recon_loss: 38599.7730; train_gene_expr_recon_loss: 651228.4028; train_masked_gp_l1_reg_loss: 8925.8061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52569.7283; train_chrom_access_recon_loss: 432318.1215; train_global_loss: 1201850.5417; train_optim_loss: 1201850.5417; val_kl_reg_loss: 17630.0020; val_edge_recon_loss: 40315.5703; val_gene_expr_recon_loss: 649963.8750; val_masked_gp_l1_reg_loss: 8919.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51083.7695; val_chrom_access_recon_loss: 430189.7812; val_global_loss: 1198102.1250; val_optim_loss: 1198102.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9245; val_auprc_score: 0.9157; val_best_acc_score: 0.8537; val_best_f1_score: 0.8557; train_kl_reg_loss: 17952.5736; train_edge_recon_loss: 38546.2344; train_gene_expr_recon_loss: 646078.2361; train_masked_gp_l1_reg_loss: 8917.3174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49953.5977; train_chrom_access_recon_loss: 431733.6493; train_global_loss: 1193181.6250; train_optim_loss: 1193181.6250; val_kl_reg_loss: 17132.1113; val_edge_recon_loss: 40215.5117; val_gene_expr_recon_loss: 648865.8750; val_masked_gp_l1_reg_loss: 8915.1260; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48568.5547; val_chrom_access_recon_loss: 429783.4375; val_global_loss: 1193480.6250; val_optim_loss: 1193480.6250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9218; val_auprc_score: 0.9126; val_best_acc_score: 0.8486; val_best_f1_score: 0.8472; train_kl_reg_loss: 17759.1862; train_edge_recon_loss: 38479.2422; train_gene_expr_recon_loss: 650113.7847; train_masked_gp_l1_reg_loss: 8914.9654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47519.6024; train_chrom_access_recon_loss: 432135.1910; train_global_loss: 1194921.9861; train_optim_loss: 1194921.9861; val_kl_reg_loss: 16448.6484; val_edge_recon_loss: 40152.8555; val_gene_expr_recon_loss: 648537.6250; val_masked_gp_l1_reg_loss: 8907.8184; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46232.1562; val_chrom_access_recon_loss: 429164.7500; val_global_loss: 1189443.8750; val_optim_loss: 1189443.8750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9266; val_auprc_score: 0.9177; val_best_acc_score: 0.8534; val_best_f1_score: 0.8513; train_kl_reg_loss: 17503.8845; train_edge_recon_loss: 38417.9019; train_gene_expr_recon_loss: 646979.3681; train_masked_gp_l1_reg_loss: 8912.9329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45260.4935; train_chrom_access_recon_loss: 431979.3160; train_global_loss: 1189053.8889; train_optim_loss: 1189053.8889; val_kl_reg_loss: 17154.7051; val_edge_recon_loss: 40100.7578; val_gene_expr_recon_loss: 645982.5625; val_masked_gp_l1_reg_loss: 8909.6738; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44063.8594; val_chrom_access_recon_loss: 428329.6250; val_global_loss: 1184541.2500; val_optim_loss: 1184541.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9298; val_auprc_score: 0.9209; val_best_acc_score: 0.8455; val_best_f1_score: 0.8384; train_kl_reg_loss: 17424.9870; train_edge_recon_loss: 38359.6463; train_gene_expr_recon_loss: 645616.6042; train_masked_gp_l1_reg_loss: 8904.1068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43153.2400; train_chrom_access_recon_loss: 429053.2674; train_global_loss: 1182511.8333; train_optim_loss: 1182511.8333; val_kl_reg_loss: 16645.6914; val_edge_recon_loss: 40002.6758; val_gene_expr_recon_loss: 645163.7500; val_masked_gp_l1_reg_loss: 8898.7275; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42031.8906; val_chrom_access_recon_loss: 427647.0625; val_global_loss: 1180389.7500; val_optim_loss: 1180389.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9321; val_auprc_score: 0.9237; val_best_acc_score: 0.8445; val_best_f1_score: 0.8346; train_kl_reg_loss: 17210.0356; train_edge_recon_loss: 38284.2300; train_gene_expr_recon_loss: 648342.1250; train_masked_gp_l1_reg_loss: 8897.6053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41180.9171; train_chrom_access_recon_loss: 431573.8333; train_global_loss: 1185488.7361; train_optim_loss: 1185488.7361; val_kl_reg_loss: 16359.0371; val_edge_recon_loss: 39951.4648; val_gene_expr_recon_loss: 644286.3750; val_masked_gp_l1_reg_loss: 8901.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40132.8828; val_chrom_access_recon_loss: 427164.1562; val_global_loss: 1176795.3750; val_optim_loss: 1176795.3750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9349; val_auprc_score: 0.9250; val_best_acc_score: 0.8362; val_best_f1_score: 0.8220; train_kl_reg_loss: 17106.7329; train_edge_recon_loss: 38214.7891; train_gene_expr_recon_loss: 645230.5139; train_masked_gp_l1_reg_loss: 8906.0441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39342.4536; train_chrom_access_recon_loss: 428386.7535; train_global_loss: 1177187.2778; train_optim_loss: 1177187.2778; val_kl_reg_loss: 16089.8242; val_edge_recon_loss: 39844.2852; val_gene_expr_recon_loss: 643451.7500; val_masked_gp_l1_reg_loss: 8902.2637; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38365.2148; val_chrom_access_recon_loss: 426748.3438; val_global_loss: 1173401.6250; val_optim_loss: 1173401.6250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9362; val_auprc_score: 0.9281; val_best_acc_score: 0.8665; val_best_f1_score: 0.8723; train_kl_reg_loss: 13714.3241; train_edge_recon_loss: 39881.4132; train_gene_expr_recon_loss: 925127.1944; train_masked_gp_l1_reg_loss: 9091.0499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37494.4236; train_chrom_access_recon_loss: 454051.9271; train_global_loss: 1479360.3194; train_optim_loss: 1479360.3194; val_kl_reg_loss: 11344.5391; val_edge_recon_loss: 40303.2148; val_gene_expr_recon_loss: 915074.9375; val_masked_gp_l1_reg_loss: 9470.7246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36334.1055; val_chrom_access_recon_loss: 450462.5000; val_global_loss: 1462990.0000; val_optim_loss: 1462990.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9341; val_auprc_score: 0.9276; val_best_acc_score: 0.8585; val_best_f1_score: 0.8664; train_kl_reg_loss: 12746.5854; train_edge_recon_loss: 39982.8559; train_gene_expr_recon_loss: 906881.1111; train_masked_gp_l1_reg_loss: 9796.3745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35386.7795; train_chrom_access_recon_loss: 450495.1007; train_global_loss: 1455288.8333; train_optim_loss: 1455288.8333; val_kl_reg_loss: 11004.7803; val_edge_recon_loss: 40331.1484; val_gene_expr_recon_loss: 908102.7500; val_masked_gp_l1_reg_loss: 10174.0332; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34221.7656; val_chrom_access_recon_loss: 449970.2188; val_global_loss: 1453804.7500; val_optim_loss: 1453804.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9363; val_auprc_score: 0.9246; val_best_acc_score: 0.8705; val_best_f1_score: 0.8751; train_kl_reg_loss: 12208.9202; train_edge_recon_loss: 39985.7305; train_gene_expr_recon_loss: 904691.5486; train_masked_gp_l1_reg_loss: 10406.4793; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33333.5447; train_chrom_access_recon_loss: 450987.1181; train_global_loss: 1451613.3333; train_optim_loss: 1451613.3333; val_kl_reg_loss: 11040.9570; val_edge_recon_loss: 40289.3672; val_gene_expr_recon_loss: 902700.9375; val_masked_gp_l1_reg_loss: 10659.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32253.9414; val_chrom_access_recon_loss: 449256.5938; val_global_loss: 1446201.3750; val_optim_loss: 1446201.3750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9375; val_auprc_score: 0.9272; val_best_acc_score: 0.8719; val_best_f1_score: 0.8743; train_kl_reg_loss: 12147.6965; train_edge_recon_loss: 39932.1636; train_gene_expr_recon_loss: 899932.9028; train_masked_gp_l1_reg_loss: 10809.9371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31441.3329; train_chrom_access_recon_loss: 450738.3715; train_global_loss: 1445002.3750; train_optim_loss: 1445002.3750; val_kl_reg_loss: 10994.6035; val_edge_recon_loss: 40229.0742; val_gene_expr_recon_loss: 898588.0000; val_masked_gp_l1_reg_loss: 10968.4424; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30454.3008; val_chrom_access_recon_loss: 448709.1875; val_global_loss: 1439943.6250; val_optim_loss: 1439943.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9371; val_auprc_score: 0.9268; val_best_acc_score: 0.8724; val_best_f1_score: 0.8747; train_kl_reg_loss: 12020.4610; train_edge_recon_loss: 39913.1780; train_gene_expr_recon_loss: 897576.7292; train_masked_gp_l1_reg_loss: 10898.1928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30339.2878; train_chrom_access_recon_loss: 448969.3715; train_global_loss: 1439717.2361; train_optim_loss: 1439717.2361; val_kl_reg_loss: 11139.3613; val_edge_recon_loss: 40219.9727; val_gene_expr_recon_loss: 898115.3750; val_masked_gp_l1_reg_loss: 10842.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30199.3711; val_chrom_access_recon_loss: 448651.8438; val_global_loss: 1439168.8750; val_optim_loss: 1439168.8750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9418; val_auprc_score: 0.9335; val_best_acc_score: 0.8750; val_best_f1_score: 0.8769; train_kl_reg_loss: 12191.8099; train_edge_recon_loss: 39913.6458; train_gene_expr_recon_loss: 902022.8611; train_masked_gp_l1_reg_loss: 10832.0842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30102.6966; train_chrom_access_recon_loss: 452411.0382; train_global_loss: 1447474.1806; train_optim_loss: 1447474.1806; val_kl_reg_loss: 11239.3105; val_edge_recon_loss: 40217.9375; val_gene_expr_recon_loss: 897689.0625; val_masked_gp_l1_reg_loss: 10811.3076; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29981.5918; val_chrom_access_recon_loss: 448590.2812; val_global_loss: 1438529.5000; val_optim_loss: 1438529.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9361; val_auprc_score: 0.9247; val_best_acc_score: 0.8713; val_best_f1_score: 0.8733; train_kl_reg_loss: 12164.2326; train_edge_recon_loss: 39898.9028; train_gene_expr_recon_loss: 901539.0694; train_masked_gp_l1_reg_loss: 10801.9344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29890.7428; train_chrom_access_recon_loss: 452083.7396; train_global_loss: 1446378.6250; train_optim_loss: 1446378.6250; val_kl_reg_loss: 11187.0801; val_edge_recon_loss: 40224.7188; val_gene_expr_recon_loss: 897360.7500; val_masked_gp_l1_reg_loss: 10791.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29779.1562; val_chrom_access_recon_loss: 448460.0625; val_global_loss: 1437803.7500; val_optim_loss: 1437803.7500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9417; val_auprc_score: 0.9335; val_best_acc_score: 0.8767; val_best_f1_score: 0.8779; train_kl_reg_loss: 12141.2448; train_edge_recon_loss: 39898.7812; train_gene_expr_recon_loss: 898199.4861; train_masked_gp_l1_reg_loss: 10787.7751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29692.8843; train_chrom_access_recon_loss: 451483.0208; train_global_loss: 1442203.1667; train_optim_loss: 1442203.1667; val_kl_reg_loss: 11232.5820; val_edge_recon_loss: 40200.4453; val_gene_expr_recon_loss: 896989.3750; val_masked_gp_l1_reg_loss: 10783.7881; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29588.3438; val_chrom_access_recon_loss: 448411.2812; val_global_loss: 1437205.7500; val_optim_loss: 1437205.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 49 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9365
val AUPRC score: 0.9264
val best accuracy score: 0.8662
val best F1 score: 0.8729
val target rna MSE score: 3.8972
val source rna MSE score: 3.2691
val target atac MSE score: 0.1332
val source atac MSE score: 0.0202
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
