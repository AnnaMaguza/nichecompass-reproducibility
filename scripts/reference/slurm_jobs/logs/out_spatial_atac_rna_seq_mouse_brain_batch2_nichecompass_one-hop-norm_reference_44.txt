[True]
Run timestamp: 07092023_161015_44.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_44']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2398 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5114, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6274; val_auprc_score: 0.6111; val_best_acc_score: 0.5032; val_best_f1_score: 0.6680; train_kl_reg_loss: 45284.9343; train_edge_recon_loss: 3530253.4621; train_gene_expr_recon_loss: 12713158.4242; train_masked_gp_l1_reg_loss: 124291.3124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5482585.8049; train_chrom_access_recon_loss: 10322585.2727; train_global_loss: 32218159.3636; train_optim_loss: 32218159.3636; val_kl_reg_loss: 109199.8232; val_edge_recon_loss: 4065058.0938; val_gene_expr_recon_loss: 11563750.5000; val_masked_gp_l1_reg_loss: 114583.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1899436.6250; val_chrom_access_recon_loss: 9863565.2500; val_global_loss: 27615593.2500; val_optim_loss: 27615593.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6891; val_auprc_score: 0.6753; val_best_acc_score: 0.5269; val_best_f1_score: 0.6767; train_kl_reg_loss: 106349.9853; train_edge_recon_loss: 3529726.9129; train_gene_expr_recon_loss: 11400944.2879; train_masked_gp_l1_reg_loss: 108371.3409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 688720.9223; train_chrom_access_recon_loss: 9796184.9091; train_global_loss: 25630298.2121; train_optim_loss: 25630298.2121; val_kl_reg_loss: 114651.5605; val_edge_recon_loss: 4063620.7500; val_gene_expr_recon_loss: 11413662.2500; val_masked_gp_l1_reg_loss: 104005.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 231592.1094; val_chrom_access_recon_loss: 9855259.7500; val_global_loss: 25782792.2500; val_optim_loss: 25782792.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7407; val_auprc_score: 0.7242; val_best_acc_score: 0.6198; val_best_f1_score: 0.7076; train_kl_reg_loss: 102271.3782; train_edge_recon_loss: 3522447.6136; train_gene_expr_recon_loss: 11196299.6061; train_masked_gp_l1_reg_loss: 103776.7022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171665.9044; train_chrom_access_recon_loss: 9691818.3788; train_global_loss: 24788279.3939; train_optim_loss: 24788279.3939; val_kl_reg_loss: 96433.4941; val_edge_recon_loss: 4055398.0000; val_gene_expr_recon_loss: 11296980.6250; val_masked_gp_l1_reg_loss: 104515.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137426.0938; val_chrom_access_recon_loss: 9858691.1250; val_global_loss: 25549445.2500; val_optim_loss: 25549445.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7902; val_auprc_score: 0.7638; val_best_acc_score: 0.6891; val_best_f1_score: 0.7462; train_kl_reg_loss: 93146.9296; train_edge_recon_loss: 3513172.3598; train_gene_expr_recon_loss: 11100062.6515; train_masked_gp_l1_reg_loss: 105475.4246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122685.3864; train_chrom_access_recon_loss: 9627460.1061; train_global_loss: 24562002.8788; train_optim_loss: 24562002.8788; val_kl_reg_loss: 79217.6289; val_edge_recon_loss: 3959071.8125; val_gene_expr_recon_loss: 11106540.3750; val_masked_gp_l1_reg_loss: 107264.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111719.9766; val_chrom_access_recon_loss: 9612174.1250; val_global_loss: 24975988.7500; val_optim_loss: 24975988.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8174; val_auprc_score: 0.7715; val_best_acc_score: 0.7569; val_best_f1_score: 0.7935; train_kl_reg_loss: 77000.1064; train_edge_recon_loss: 3361230.3144; train_gene_expr_recon_loss: 11021192.6667; train_masked_gp_l1_reg_loss: 110988.1171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106884.8647; train_chrom_access_recon_loss: 9550393.7273; train_global_loss: 24227689.7273; train_optim_loss: 24227689.7273; val_kl_reg_loss: 87252.7539; val_edge_recon_loss: 3124181.9375; val_gene_expr_recon_loss: 11677997.2500; val_masked_gp_l1_reg_loss: 117805.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103540.9453; val_chrom_access_recon_loss: 9549519.5000; val_global_loss: 24660297.0000; val_optim_loss: 24660297.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8139; val_auprc_score: 0.7727; val_best_acc_score: 0.7394; val_best_f1_score: 0.7884; train_kl_reg_loss: 98849.3097; train_edge_recon_loss: 3041792.1667; train_gene_expr_recon_loss: 11037547.5152; train_masked_gp_l1_reg_loss: 122564.0803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102701.3584; train_chrom_access_recon_loss: 9519179.9091; train_global_loss: 23922634.3636; train_optim_loss: 23922634.3636; val_kl_reg_loss: 103832.1875; val_edge_recon_loss: 3028301.7188; val_gene_expr_recon_loss: 10922633.3750; val_masked_gp_l1_reg_loss: 124128.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98698.6719; val_chrom_access_recon_loss: 9426054.6250; val_global_loss: 23703649.0000; val_optim_loss: 23703649.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8313; val_auprc_score: 0.7905; val_best_acc_score: 0.7526; val_best_f1_score: 0.7952; train_kl_reg_loss: 110750.0115; train_edge_recon_loss: 2968888.6250; train_gene_expr_recon_loss: 10945800.9394; train_masked_gp_l1_reg_loss: 124989.8343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95405.0311; train_chrom_access_recon_loss: 9459235.2576; train_global_loss: 23705069.6970; train_optim_loss: 23705069.6970; val_kl_reg_loss: 112608.6543; val_edge_recon_loss: 2961371.4062; val_gene_expr_recon_loss: 10981984.5000; val_masked_gp_l1_reg_loss: 126142.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93122.8828; val_chrom_access_recon_loss: 9589443.7500; val_global_loss: 23864674.7500; val_optim_loss: 23864674.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8431; val_auprc_score: 0.8024; val_best_acc_score: 0.7609; val_best_f1_score: 0.7963; train_kl_reg_loss: 113048.8332; train_edge_recon_loss: 2944565.8826; train_gene_expr_recon_loss: 10864990.0152; train_masked_gp_l1_reg_loss: 127816.9987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91365.3389; train_chrom_access_recon_loss: 9416676.4091; train_global_loss: 23558463.3030; train_optim_loss: 23558463.3030; val_kl_reg_loss: 105654.0635; val_edge_recon_loss: 2926675.2812; val_gene_expr_recon_loss: 10821485.7500; val_masked_gp_l1_reg_loss: 129614.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89755.9375; val_chrom_access_recon_loss: 9351151.1250; val_global_loss: 23424336.7500; val_optim_loss: 23424336.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8554; val_auprc_score: 0.8190; val_best_acc_score: 0.7730; val_best_f1_score: 0.7976; train_kl_reg_loss: 110806.7331; train_edge_recon_loss: 2932058.0265; train_gene_expr_recon_loss: 10798092.1364; train_masked_gp_l1_reg_loss: 130587.6049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88281.5301; train_chrom_access_recon_loss: 9360766.1970; train_global_loss: 23420592.3636; train_optim_loss: 23420592.3636; val_kl_reg_loss: 106520.7354; val_edge_recon_loss: 2978177.4688; val_gene_expr_recon_loss: 10777145.1250; val_masked_gp_l1_reg_loss: 131914.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86979.7188; val_chrom_access_recon_loss: 9412376.1250; val_global_loss: 23493114.2500; val_optim_loss: 23493114.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8737; val_auprc_score: 0.8373; val_best_acc_score: 0.7974; val_best_f1_score: 0.8162; train_kl_reg_loss: 106192.0479; train_edge_recon_loss: 2917793.1136; train_gene_expr_recon_loss: 10761593.8333; train_masked_gp_l1_reg_loss: 132943.9858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86260.6623; train_chrom_access_recon_loss: 9336659.1818; train_global_loss: 23341442.8485; train_optim_loss: 23341442.8485; val_kl_reg_loss: 104103.2236; val_edge_recon_loss: 2880486.3438; val_gene_expr_recon_loss: 10798399.7500; val_masked_gp_l1_reg_loss: 133945.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85719.0781; val_chrom_access_recon_loss: 9378475.2500; val_global_loss: 23381129.5000; val_optim_loss: 23381129.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8955; val_auprc_score: 0.8608; val_best_acc_score: 0.8229; val_best_f1_score: 0.8370; train_kl_reg_loss: 103480.2273; train_edge_recon_loss: 2891907.3106; train_gene_expr_recon_loss: 10718094.5909; train_masked_gp_l1_reg_loss: 135148.1607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84901.0661; train_chrom_access_recon_loss: 9305967.9697; train_global_loss: 23239499.3333; train_optim_loss: 23239499.3333; val_kl_reg_loss: 105328.2627; val_edge_recon_loss: 2881391.8750; val_gene_expr_recon_loss: 10865514.6250; val_masked_gp_l1_reg_loss: 136234.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84911.3750; val_chrom_access_recon_loss: 9404570.1250; val_global_loss: 23477949.5000; val_optim_loss: 23477949.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8987; val_auprc_score: 0.8641; val_best_acc_score: 0.8313; val_best_f1_score: 0.8454; train_kl_reg_loss: 106372.9007; train_edge_recon_loss: 2829506.3295; train_gene_expr_recon_loss: 10671474.3182; train_masked_gp_l1_reg_loss: 137102.0755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83942.0348; train_chrom_access_recon_loss: 9261371.0152; train_global_loss: 23089768.8182; train_optim_loss: 23089768.8182; val_kl_reg_loss: 109326.7715; val_edge_recon_loss: 2857668.1250; val_gene_expr_recon_loss: 10658755.5000; val_masked_gp_l1_reg_loss: 138025.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83835.8047; val_chrom_access_recon_loss: 9318982.6250; val_global_loss: 23166594.0000; val_optim_loss: 23166594.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9002; val_auprc_score: 0.8653; val_best_acc_score: 0.8399; val_best_f1_score: 0.8526; train_kl_reg_loss: 108802.7036; train_edge_recon_loss: 2816976.2992; train_gene_expr_recon_loss: 10644746.9242; train_masked_gp_l1_reg_loss: 138829.1596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83832.7752; train_chrom_access_recon_loss: 9241032.5303; train_global_loss: 23034220.3030; train_optim_loss: 23034220.3030; val_kl_reg_loss: 109471.9033; val_edge_recon_loss: 2865579.3125; val_gene_expr_recon_loss: 10731436.5000; val_masked_gp_l1_reg_loss: 139988.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83875.0156; val_chrom_access_recon_loss: 9273694.0000; val_global_loss: 23204045.5000; val_optim_loss: 23204045.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9088; val_auprc_score: 0.8700; val_best_acc_score: 0.8461; val_best_f1_score: 0.8587; train_kl_reg_loss: 109906.9805; train_edge_recon_loss: 2805082.3295; train_gene_expr_recon_loss: 10607157.6364; train_masked_gp_l1_reg_loss: 140538.5213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83640.9940; train_chrom_access_recon_loss: 9206126.9091; train_global_loss: 22952453.2727; train_optim_loss: 22952453.2727; val_kl_reg_loss: 111053.0957; val_edge_recon_loss: 2842680.1875; val_gene_expr_recon_loss: 10634111.6250; val_masked_gp_l1_reg_loss: 141216.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83760.7891; val_chrom_access_recon_loss: 9291549.2500; val_global_loss: 23104370.7500; val_optim_loss: 23104370.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9122; val_auprc_score: 0.8782; val_best_acc_score: 0.8565; val_best_f1_score: 0.8671; train_kl_reg_loss: 110056.0688; train_edge_recon_loss: 2796949.4924; train_gene_expr_recon_loss: 10567711.5303; train_masked_gp_l1_reg_loss: 141809.6120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83406.0855; train_chrom_access_recon_loss: 9174532.2273; train_global_loss: 22874464.7879; train_optim_loss: 22874464.7879; val_kl_reg_loss: 111429.3672; val_edge_recon_loss: 2825950.0000; val_gene_expr_recon_loss: 10522054.3750; val_masked_gp_l1_reg_loss: 142417.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83131.2812; val_chrom_access_recon_loss: 9129390.5000; val_global_loss: 22814372.7500; val_optim_loss: 22814372.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9215; val_auprc_score: 0.8887; val_best_acc_score: 0.8694; val_best_f1_score: 0.8770; train_kl_reg_loss: 111006.1303; train_edge_recon_loss: 2788896.0114; train_gene_expr_recon_loss: 10532429.6061; train_masked_gp_l1_reg_loss: 142700.0540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83227.4463; train_chrom_access_recon_loss: 9132576.8485; train_global_loss: 22790836.0606; train_optim_loss: 22790836.0606; val_kl_reg_loss: 107691.0068; val_edge_recon_loss: 2816675.4375; val_gene_expr_recon_loss: 10585230.5000; val_masked_gp_l1_reg_loss: 143051.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83404.7344; val_chrom_access_recon_loss: 9221552.7500; val_global_loss: 22957606.7500; val_optim_loss: 22957606.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9202; val_auprc_score: 0.8924; val_best_acc_score: 0.8681; val_best_f1_score: 0.8764; train_kl_reg_loss: 109566.6712; train_edge_recon_loss: 2779379.2689; train_gene_expr_recon_loss: 10502603.7424; train_masked_gp_l1_reg_loss: 143382.3750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83071.4451; train_chrom_access_recon_loss: 9105172.8939; train_global_loss: 22723176.4242; train_optim_loss: 22723176.4242; val_kl_reg_loss: 111252.3105; val_edge_recon_loss: 2792266.3125; val_gene_expr_recon_loss: 10537869.6250; val_masked_gp_l1_reg_loss: 144105.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83051.7812; val_chrom_access_recon_loss: 9129725.5000; val_global_loss: 22798271.2500; val_optim_loss: 22798271.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9197; val_auprc_score: 0.8917; val_best_acc_score: 0.8643; val_best_f1_score: 0.8722; train_kl_reg_loss: 108267.0710; train_edge_recon_loss: 2783517.2197; train_gene_expr_recon_loss: 10480100.0000; train_masked_gp_l1_reg_loss: 144168.3558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82921.6094; train_chrom_access_recon_loss: 9085944.7727; train_global_loss: 22684919.0909; train_optim_loss: 22684919.0909; val_kl_reg_loss: 106069.5186; val_edge_recon_loss: 2806690.5000; val_gene_expr_recon_loss: 10532226.1250; val_masked_gp_l1_reg_loss: 145015.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82959.0234; val_chrom_access_recon_loss: 9121095.8750; val_global_loss: 22794055.7500; val_optim_loss: 22794055.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9271; val_auprc_score: 0.9010; val_best_acc_score: 0.8692; val_best_f1_score: 0.8776; train_kl_reg_loss: 107340.4231; train_edge_recon_loss: 2765073.0265; train_gene_expr_recon_loss: 10457007.2879; train_masked_gp_l1_reg_loss: 144938.4749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82675.0438; train_chrom_access_recon_loss: 9062162.3939; train_global_loss: 22619196.5758; train_optim_loss: 22619196.5758; val_kl_reg_loss: 109557.4863; val_edge_recon_loss: 2799715.0938; val_gene_expr_recon_loss: 10424581.7500; val_masked_gp_l1_reg_loss: 145448.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82989.6250; val_chrom_access_recon_loss: 9068806.2500; val_global_loss: 22631098.7500; val_optim_loss: 22631098.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9218; val_auprc_score: 0.8947; val_best_acc_score: 0.8632; val_best_f1_score: 0.8720; train_kl_reg_loss: 106591.5695; train_edge_recon_loss: 2772223.0530; train_gene_expr_recon_loss: 10431962.5606; train_masked_gp_l1_reg_loss: 145458.2124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82837.2083; train_chrom_access_recon_loss: 9036480.3333; train_global_loss: 22575553.0303; train_optim_loss: 22575553.0303; val_kl_reg_loss: 105622.8408; val_edge_recon_loss: 2828812.7500; val_gene_expr_recon_loss: 10424417.0000; val_masked_gp_l1_reg_loss: 145848.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83238.1719; val_chrom_access_recon_loss: 9016517.1250; val_global_loss: 22604457.0000; val_optim_loss: 22604457.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9262; val_auprc_score: 0.9021; val_best_acc_score: 0.8694; val_best_f1_score: 0.8789; train_kl_reg_loss: 105824.2019; train_edge_recon_loss: 2767056.0076; train_gene_expr_recon_loss: 10401412.5909; train_masked_gp_l1_reg_loss: 146042.4467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82748.0240; train_chrom_access_recon_loss: 9010598.9242; train_global_loss: 22513682.2727; train_optim_loss: 22513682.2727; val_kl_reg_loss: 104911.6504; val_edge_recon_loss: 2812256.8750; val_gene_expr_recon_loss: 10378380.2500; val_masked_gp_l1_reg_loss: 146204.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82436.8984; val_chrom_access_recon_loss: 9089586.8750; val_global_loss: 22613776.7500; val_optim_loss: 22613776.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9254; val_auprc_score: 0.8983; val_best_acc_score: 0.8689; val_best_f1_score: 0.8774; train_kl_reg_loss: 106973.2500; train_edge_recon_loss: 2754445.8977; train_gene_expr_recon_loss: 10371338.2121; train_masked_gp_l1_reg_loss: 146356.7685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82527.7786; train_chrom_access_recon_loss: 8983772.6667; train_global_loss: 22445414.6667; train_optim_loss: 22445414.6667; val_kl_reg_loss: 106292.3232; val_edge_recon_loss: 2806252.8750; val_gene_expr_recon_loss: 10503436.6250; val_masked_gp_l1_reg_loss: 146601.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82522.1406; val_chrom_access_recon_loss: 9215001.7500; val_global_loss: 22860106.2500; val_optim_loss: 22860106.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9237; val_auprc_score: 0.8912; val_best_acc_score: 0.8764; val_best_f1_score: 0.8843; train_kl_reg_loss: 105400.6644; train_edge_recon_loss: 2750787.9508; train_gene_expr_recon_loss: 10355687.8333; train_masked_gp_l1_reg_loss: 146620.4583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82880.6527; train_chrom_access_recon_loss: 8967993.6591; train_global_loss: 22409371.1212; train_optim_loss: 22409371.1212; val_kl_reg_loss: 104406.0303; val_edge_recon_loss: 2792036.0000; val_gene_expr_recon_loss: 10412288.8750; val_masked_gp_l1_reg_loss: 147137.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83587.0312; val_chrom_access_recon_loss: 8972408.3750; val_global_loss: 22511864.0000; val_optim_loss: 22511864.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9323; val_auprc_score: 0.9092; val_best_acc_score: 0.8791; val_best_f1_score: 0.8840; train_kl_reg_loss: 104285.6516; train_edge_recon_loss: 2745168.2538; train_gene_expr_recon_loss: 10337185.9091; train_masked_gp_l1_reg_loss: 147146.1591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83414.3878; train_chrom_access_recon_loss: 8940379.5455; train_global_loss: 22357579.9394; train_optim_loss: 22357579.9394; val_kl_reg_loss: 105680.6318; val_edge_recon_loss: 2775993.9375; val_gene_expr_recon_loss: 10319678.0000; val_masked_gp_l1_reg_loss: 147734.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83668.1250; val_chrom_access_recon_loss: 8907786.9375; val_global_loss: 22340541.2500; val_optim_loss: 22340541.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9316; val_auprc_score: 0.9091; val_best_acc_score: 0.8772; val_best_f1_score: 0.8831; train_kl_reg_loss: 104881.4959; train_edge_recon_loss: 2748619.2614; train_gene_expr_recon_loss: 10311081.1970; train_masked_gp_l1_reg_loss: 147606.6837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83618.9210; train_chrom_access_recon_loss: 8918821.7879; train_global_loss: 22314629.5455; train_optim_loss: 22314629.5455; val_kl_reg_loss: 103584.8223; val_edge_recon_loss: 2798122.6562; val_gene_expr_recon_loss: 10271188.6250; val_masked_gp_l1_reg_loss: 147783.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84095.1719; val_chrom_access_recon_loss: 8865193.2500; val_global_loss: 22269968.7500; val_optim_loss: 22269968.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9319; val_auprc_score: 0.9007; val_best_acc_score: 0.8780; val_best_f1_score: 0.8857; train_kl_reg_loss: 109041.1392; train_edge_recon_loss: 2795512.1780; train_gene_expr_recon_loss: 10045367.1667; train_masked_gp_l1_reg_loss: 147068.4725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85468.5735; train_chrom_access_recon_loss: 8757002.2348; train_global_loss: 21939459.8485; train_optim_loss: 21939459.8485; val_kl_reg_loss: 69293.4346; val_edge_recon_loss: 2786826.3750; val_gene_expr_recon_loss: 10123576.6250; val_masked_gp_l1_reg_loss: 147154.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85865.0703; val_chrom_access_recon_loss: 8752652.6250; val_global_loss: 21965367.5000; val_optim_loss: 21965367.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9334; val_auprc_score: 0.9112; val_best_acc_score: 0.8788; val_best_f1_score: 0.8860; train_kl_reg_loss: 110033.7726; train_edge_recon_loss: 2758720.8712; train_gene_expr_recon_loss: 10008079.9545; train_masked_gp_l1_reg_loss: 147127.9510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84560.7449; train_chrom_access_recon_loss: 8652275.5379; train_global_loss: 21760799.0000; train_optim_loss: 21760799.0000; val_kl_reg_loss: 72399.0381; val_edge_recon_loss: 2776580.4688; val_gene_expr_recon_loss: 10086247.5000; val_masked_gp_l1_reg_loss: 147383.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83881.4531; val_chrom_access_recon_loss: 8666347.8125; val_global_loss: 21832839.0000; val_optim_loss: 21832839.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9320; val_auprc_score: 0.9037; val_best_acc_score: 0.8767; val_best_f1_score: 0.8839; train_kl_reg_loss: 106439.0683; train_edge_recon_loss: 2766697.7273; train_gene_expr_recon_loss: 9976570.1061; train_masked_gp_l1_reg_loss: 147520.7145; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82906.3385; train_chrom_access_recon_loss: 8620813.0455; train_global_loss: 21700946.9091; train_optim_loss: 21700946.9091; val_kl_reg_loss: 77837.7676; val_edge_recon_loss: 2786730.2812; val_gene_expr_recon_loss: 10009079.0000; val_masked_gp_l1_reg_loss: 147552.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82281.4297; val_chrom_access_recon_loss: 8646413.6250; val_global_loss: 21749893.7500; val_optim_loss: 21749893.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9375; val_auprc_score: 0.9191; val_best_acc_score: 0.8767; val_best_f1_score: 0.8828; train_kl_reg_loss: 101940.9862; train_edge_recon_loss: 2746833.7727; train_gene_expr_recon_loss: 9952067.5909; train_masked_gp_l1_reg_loss: 147388.7635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81626.4851; train_chrom_access_recon_loss: 8581429.7424; train_global_loss: 21611287.3636; train_optim_loss: 21611287.3636; val_kl_reg_loss: 82522.5801; val_edge_recon_loss: 2780638.1250; val_gene_expr_recon_loss: 10016940.6250; val_masked_gp_l1_reg_loss: 147336.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80780.3906; val_chrom_access_recon_loss: 8623004.6875; val_global_loss: 21731222.2500; val_optim_loss: 21731222.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9396; val_auprc_score: 0.9191; val_best_acc_score: 0.8850; val_best_f1_score: 0.8908; train_kl_reg_loss: 101447.6471; train_edge_recon_loss: 2744181.9167; train_gene_expr_recon_loss: 9927947.2576; train_masked_gp_l1_reg_loss: 147112.3520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80480.1256; train_chrom_access_recon_loss: 8552483.6061; train_global_loss: 21553652.9091; train_optim_loss: 21553652.9091; val_kl_reg_loss: 83707.2080; val_edge_recon_loss: 2789543.7500; val_gene_expr_recon_loss: 10004468.6250; val_masked_gp_l1_reg_loss: 146912.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79676.2891; val_chrom_access_recon_loss: 8583537.6250; val_global_loss: 21687845.2500; val_optim_loss: 21687845.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9469; val_auprc_score: 0.9304; val_best_acc_score: 0.8947; val_best_f1_score: 0.8991; train_kl_reg_loss: 98793.4103; train_edge_recon_loss: 2739708.6780; train_gene_expr_recon_loss: 9910712.8485; train_masked_gp_l1_reg_loss: 146898.8757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79837.8872; train_chrom_access_recon_loss: 8543093.6515; train_global_loss: 21519045.3636; train_optim_loss: 21519045.3636; val_kl_reg_loss: 81572.2803; val_edge_recon_loss: 2743947.2188; val_gene_expr_recon_loss: 9908072.5000; val_masked_gp_l1_reg_loss: 146899.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79609.6328; val_chrom_access_recon_loss: 8561771.0000; val_global_loss: 21521871.7500; val_optim_loss: 21521871.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9368; val_auprc_score: 0.9152; val_best_acc_score: 0.8818; val_best_f1_score: 0.8872; train_kl_reg_loss: 95103.3767; train_edge_recon_loss: 2742081.8902; train_gene_expr_recon_loss: 9885546.7879; train_masked_gp_l1_reg_loss: 146796.4901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79396.8131; train_chrom_access_recon_loss: 8516128.0909; train_global_loss: 21465053.3030; train_optim_loss: 21465053.3030; val_kl_reg_loss: 87301.2930; val_edge_recon_loss: 2777875.1250; val_gene_expr_recon_loss: 10058086.1250; val_masked_gp_l1_reg_loss: 146819.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79552.6406; val_chrom_access_recon_loss: 8660683.8125; val_global_loss: 21810318.2500; val_optim_loss: 21810318.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9455; val_auprc_score: 0.9224; val_best_acc_score: 0.8907; val_best_f1_score: 0.8950; train_kl_reg_loss: 95327.9092; train_edge_recon_loss: 2736297.9621; train_gene_expr_recon_loss: 9869621.2727; train_masked_gp_l1_reg_loss: 146714.7486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78882.0142; train_chrom_access_recon_loss: 8500025.8712; train_global_loss: 21426869.9091; train_optim_loss: 21426869.9091; val_kl_reg_loss: 88684.0322; val_edge_recon_loss: 2745034.2812; val_gene_expr_recon_loss: 9932990.3750; val_masked_gp_l1_reg_loss: 146734.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78743.8750; val_chrom_access_recon_loss: 8579036.4375; val_global_loss: 21571224.0000; val_optim_loss: 21571224.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9414; val_auprc_score: 0.9180; val_best_acc_score: 0.8909; val_best_f1_score: 0.8943; train_kl_reg_loss: 95254.9388; train_edge_recon_loss: 2739562.8902; train_gene_expr_recon_loss: 9855479.8182; train_masked_gp_l1_reg_loss: 146562.0833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78416.7024; train_chrom_access_recon_loss: 8485409.3788; train_global_loss: 21400685.5455; train_optim_loss: 21400685.5455; val_kl_reg_loss: 86704.0498; val_edge_recon_loss: 2781099.3750; val_gene_expr_recon_loss: 9985686.8750; val_masked_gp_l1_reg_loss: 146410.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78191.5000; val_chrom_access_recon_loss: 8604384.5000; val_global_loss: 21682476.5000; val_optim_loss: 21682476.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9465; val_auprc_score: 0.9224; val_best_acc_score: 0.8936; val_best_f1_score: 0.8967; train_kl_reg_loss: 94780.0386; train_edge_recon_loss: 2739646.3068; train_gene_expr_recon_loss: 9826767.1364; train_masked_gp_l1_reg_loss: 146263.6030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78157.7525; train_chrom_access_recon_loss: 8453524.3106; train_global_loss: 21339139.3636; train_optim_loss: 21339139.3636; val_kl_reg_loss: 86002.7100; val_edge_recon_loss: 2762861.3125; val_gene_expr_recon_loss: 9840768.0000; val_masked_gp_l1_reg_loss: 146083.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77868.6562; val_chrom_access_recon_loss: 8578572.9375; val_global_loss: 21492158.0000; val_optim_loss: 21492158.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9464; val_auprc_score: 0.9263; val_best_acc_score: 0.8952; val_best_f1_score: 0.8993; train_kl_reg_loss: 93353.5478; train_edge_recon_loss: 2726107.2273; train_gene_expr_recon_loss: 9825269.3636; train_masked_gp_l1_reg_loss: 146048.6397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78039.1798; train_chrom_access_recon_loss: 8451542.8712; train_global_loss: 21320361.0303; train_optim_loss: 21320361.0303; val_kl_reg_loss: 86564.4746; val_edge_recon_loss: 2774289.2188; val_gene_expr_recon_loss: 9882837.1250; val_masked_gp_l1_reg_loss: 145981.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77790.8984; val_chrom_access_recon_loss: 8478050.1250; val_global_loss: 21445514.5000; val_optim_loss: 21445514.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9439; val_auprc_score: 0.9256; val_best_acc_score: 0.8896; val_best_f1_score: 0.8946; train_kl_reg_loss: 94843.3701; train_edge_recon_loss: 2715096.4167; train_gene_expr_recon_loss: 9812376.0606; train_masked_gp_l1_reg_loss: 145862.6529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77740.5200; train_chrom_access_recon_loss: 8432148.8636; train_global_loss: 21278067.9697; train_optim_loss: 21278067.9697; val_kl_reg_loss: 90839.5596; val_edge_recon_loss: 2760149.8438; val_gene_expr_recon_loss: 9906736.7500; val_masked_gp_l1_reg_loss: 145901.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77979.6094; val_chrom_access_recon_loss: 8516145.1875; val_global_loss: 21497753.2500; val_optim_loss: 21497753.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9496; val_auprc_score: 0.9346; val_best_acc_score: 0.8966; val_best_f1_score: 0.9016; train_kl_reg_loss: 95245.6388; train_edge_recon_loss: 2717097.5909; train_gene_expr_recon_loss: 9784929.4545; train_masked_gp_l1_reg_loss: 145635.8395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77719.7757; train_chrom_access_recon_loss: 8408581.7045; train_global_loss: 21229210.0909; train_optim_loss: 21229210.0909; val_kl_reg_loss: 91889.2461; val_edge_recon_loss: 2748427.8125; val_gene_expr_recon_loss: 9747747.2500; val_masked_gp_l1_reg_loss: 145517.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77381.6719; val_chrom_access_recon_loss: 8335629.5625; val_global_loss: 21146593.0000; val_optim_loss: 21146593.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9457; val_auprc_score: 0.9265; val_best_acc_score: 0.8933; val_best_f1_score: 0.8979; train_kl_reg_loss: 94534.6862; train_edge_recon_loss: 2719496.4394; train_gene_expr_recon_loss: 9784033.0000; train_masked_gp_l1_reg_loss: 145426.7580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77502.1238; train_chrom_access_recon_loss: 8406351.9015; train_global_loss: 21227345.0606; train_optim_loss: 21227345.0606; val_kl_reg_loss: 91574.1797; val_edge_recon_loss: 2765145.4062; val_gene_expr_recon_loss: 9818482.7500; val_masked_gp_l1_reg_loss: 145285.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77040.1016; val_chrom_access_recon_loss: 8494145.8125; val_global_loss: 21391672.7500; val_optim_loss: 21391672.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9501; val_auprc_score: 0.9297; val_best_acc_score: 0.8976; val_best_f1_score: 0.9016; train_kl_reg_loss: 93748.1354; train_edge_recon_loss: 2720874.3561; train_gene_expr_recon_loss: 9768052.1818; train_masked_gp_l1_reg_loss: 145211.0346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77267.1925; train_chrom_access_recon_loss: 8395169.5076; train_global_loss: 21200322.4545; train_optim_loss: 21200322.4545; val_kl_reg_loss: 89896.1562; val_edge_recon_loss: 2756450.8125; val_gene_expr_recon_loss: 9913447.3750; val_masked_gp_l1_reg_loss: 145056.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77470.9453; val_chrom_access_recon_loss: 8449828.8750; val_global_loss: 21432151.0000; val_optim_loss: 21432151.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9504; val_auprc_score: 0.9335; val_best_acc_score: 0.8984; val_best_f1_score: 0.9019; train_kl_reg_loss: 92703.3098; train_edge_recon_loss: 2726857.9356; train_gene_expr_recon_loss: 9766557.3333; train_masked_gp_l1_reg_loss: 145025.8558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77225.4202; train_chrom_access_recon_loss: 8380651.9015; train_global_loss: 21189021.6970; train_optim_loss: 21189021.6970; val_kl_reg_loss: 89764.2217; val_edge_recon_loss: 2786993.8438; val_gene_expr_recon_loss: 9773794.6250; val_masked_gp_l1_reg_loss: 145013.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77415.5859; val_chrom_access_recon_loss: 8356644.4375; val_global_loss: 21229626.7500; val_optim_loss: 21229626.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9512; val_auprc_score: 0.9293; val_best_acc_score: 0.9014; val_best_f1_score: 0.9044; train_kl_reg_loss: 93931.6688; train_edge_recon_loss: 2722104.7765; train_gene_expr_recon_loss: 9749372.1970; train_masked_gp_l1_reg_loss: 144992.1759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77301.7563; train_chrom_access_recon_loss: 8366282.6742; train_global_loss: 21153985.1515; train_optim_loss: 21153985.1515; val_kl_reg_loss: 91153.0654; val_edge_recon_loss: 2767467.4062; val_gene_expr_recon_loss: 9797851.1250; val_masked_gp_l1_reg_loss: 144786.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76985.3672; val_chrom_access_recon_loss: 8408804.0625; val_global_loss: 21287047.0000; val_optim_loss: 21287047.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9459; val_auprc_score: 0.9238; val_best_acc_score: 0.8963; val_best_f1_score: 0.9008; train_kl_reg_loss: 94893.8089; train_edge_recon_loss: 2702567.5152; train_gene_expr_recon_loss: 9737908.5455; train_masked_gp_l1_reg_loss: 142708.2630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60189.7675; train_chrom_access_recon_loss: 8363301.5303; train_global_loss: 21101569.3939; train_optim_loss: 21101569.3939; val_kl_reg_loss: 92375.1787; val_edge_recon_loss: 2744871.1562; val_gene_expr_recon_loss: 9766514.7500; val_masked_gp_l1_reg_loss: 141935.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57193.5352; val_chrom_access_recon_loss: 8376957.1250; val_global_loss: 21179847.7500; val_optim_loss: 21179847.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9540; val_auprc_score: 0.9385; val_best_acc_score: 0.9033; val_best_f1_score: 0.9062; train_kl_reg_loss: 95676.4336; train_edge_recon_loss: 2724157.5227; train_gene_expr_recon_loss: 9740801.7879; train_masked_gp_l1_reg_loss: 141791.5755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57049.9354; train_chrom_access_recon_loss: 8355647.2121; train_global_loss: 21115124.4848; train_optim_loss: 21115124.4848; val_kl_reg_loss: 91805.3789; val_edge_recon_loss: 2748614.5625; val_gene_expr_recon_loss: 9769507.5000; val_masked_gp_l1_reg_loss: 141697.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56894.6094; val_chrom_access_recon_loss: 8343203.1875; val_global_loss: 21151722.2500; val_optim_loss: 21151722.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9566; val_auprc_score: 0.9439; val_best_acc_score: 0.9014; val_best_f1_score: 0.9042; train_kl_reg_loss: 95069.3423; train_edge_recon_loss: 2718747.5833; train_gene_expr_recon_loss: 9739515.3182; train_masked_gp_l1_reg_loss: 141627.1709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56800.6079; train_chrom_access_recon_loss: 8356772.6818; train_global_loss: 21108532.8182; train_optim_loss: 21108532.8182; val_kl_reg_loss: 92171.4238; val_edge_recon_loss: 2725064.9688; val_gene_expr_recon_loss: 9741575.0000; val_masked_gp_l1_reg_loss: 141580.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56672.3711; val_chrom_access_recon_loss: 8365895.6875; val_global_loss: 21122960.0000; val_optim_loss: 21122960.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9521; val_auprc_score: 0.9322; val_best_acc_score: 0.9052; val_best_f1_score: 0.9077; train_kl_reg_loss: 95716.1516; train_edge_recon_loss: 2705720.8447; train_gene_expr_recon_loss: 9732119.7727; train_masked_gp_l1_reg_loss: 141556.5353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56620.0490; train_chrom_access_recon_loss: 8348872.7424; train_global_loss: 21080606.0303; train_optim_loss: 21080606.0303; val_kl_reg_loss: 93099.3477; val_edge_recon_loss: 2724423.2812; val_gene_expr_recon_loss: 9728783.2500; val_masked_gp_l1_reg_loss: 141528.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56555.8516; val_chrom_access_recon_loss: 8344630.5625; val_global_loss: 21089020.2500; val_optim_loss: 21089020.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9518; val_auprc_score: 0.9317; val_best_acc_score: 0.9035; val_best_f1_score: 0.9069; train_kl_reg_loss: 95712.5626; train_edge_recon_loss: 2700598.5492; train_gene_expr_recon_loss: 9734425.6515; train_masked_gp_l1_reg_loss: 141497.1641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56518.2547; train_chrom_access_recon_loss: 8352665.3788; train_global_loss: 21081417.5758; train_optim_loss: 21081417.5758; val_kl_reg_loss: 93508.1406; val_edge_recon_loss: 2727950.2500; val_gene_expr_recon_loss: 9804869.7500; val_masked_gp_l1_reg_loss: 141486.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56486.5625; val_chrom_access_recon_loss: 8378661.6250; val_global_loss: 21202964.0000; val_optim_loss: 21202964.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9571; val_auprc_score: 0.9399; val_best_acc_score: 0.9046; val_best_f1_score: 0.9070; train_kl_reg_loss: 96963.2852; train_edge_recon_loss: 2704234.1856; train_gene_expr_recon_loss: 9728471.9091; train_masked_gp_l1_reg_loss: 141445.8033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56397.9645; train_chrom_access_recon_loss: 8347061.6061; train_global_loss: 21074574.8182; train_optim_loss: 21074574.8182; val_kl_reg_loss: 93642.5273; val_edge_recon_loss: 2719224.7500; val_gene_expr_recon_loss: 9793649.0000; val_masked_gp_l1_reg_loss: 141417.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56306.9062; val_chrom_access_recon_loss: 8392014.2500; val_global_loss: 21196255.5000; val_optim_loss: 21196255.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9529; val_auprc_score: 0.9322; val_best_acc_score: 0.9046; val_best_f1_score: 0.9065; train_kl_reg_loss: 96356.0715; train_edge_recon_loss: 2704528.9356; train_gene_expr_recon_loss: 9727336.0152; train_masked_gp_l1_reg_loss: 141408.4209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56272.0283; train_chrom_access_recon_loss: 8346717.8182; train_global_loss: 21072619.3636; train_optim_loss: 21072619.3636; val_kl_reg_loss: 93879.6367; val_edge_recon_loss: 2736263.7188; val_gene_expr_recon_loss: 9853611.8750; val_masked_gp_l1_reg_loss: 141388.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56230.5273; val_chrom_access_recon_loss: 8388587.8125; val_global_loss: 21269963.0000; val_optim_loss: 21269963.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9532; val_auprc_score: 0.9376; val_best_acc_score: 0.9006; val_best_f1_score: 0.9027; train_kl_reg_loss: 96560.7056; train_edge_recon_loss: 2715092.6894; train_gene_expr_recon_loss: 9731260.6970; train_masked_gp_l1_reg_loss: 141364.6044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56150.4363; train_chrom_access_recon_loss: 8354518.6667; train_global_loss: 21094947.8788; train_optim_loss: 21094947.8788; val_kl_reg_loss: 93884.1025; val_edge_recon_loss: 2738944.1875; val_gene_expr_recon_loss: 9888124.8750; val_masked_gp_l1_reg_loss: 141342.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56074.2148; val_chrom_access_recon_loss: 8416499.8125; val_global_loss: 21334870.0000; val_optim_loss: 21334870.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9499; val_auprc_score: 0.9271; val_best_acc_score: 0.8998; val_best_f1_score: 0.9030; train_kl_reg_loss: 96242.3681; train_edge_recon_loss: 2707092.4015; train_gene_expr_recon_loss: 9728323.9091; train_masked_gp_l1_reg_loss: 141136.5893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54220.5295; train_chrom_access_recon_loss: 8350152.0076; train_global_loss: 21077167.7576; train_optim_loss: 21077167.7576; val_kl_reg_loss: 94056.6680; val_edge_recon_loss: 2761991.4062; val_gene_expr_recon_loss: 9730399.7500; val_masked_gp_l1_reg_loss: 141055.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53883.3633; val_chrom_access_recon_loss: 8366664.8125; val_global_loss: 21148050.5000; val_optim_loss: 21148050.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9537; val_auprc_score: 0.9390; val_best_acc_score: 0.9049; val_best_f1_score: 0.9087; train_kl_reg_loss: 96329.2042; train_edge_recon_loss: 2716608.4356; train_gene_expr_recon_loss: 9725122.3485; train_masked_gp_l1_reg_loss: 141030.1631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53859.3913; train_chrom_access_recon_loss: 8340687.3106; train_global_loss: 21073636.8788; train_optim_loss: 21073636.8788; val_kl_reg_loss: 93948.8857; val_edge_recon_loss: 2729482.7188; val_gene_expr_recon_loss: 9742200.3750; val_masked_gp_l1_reg_loss: 141014.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53846.0234; val_chrom_access_recon_loss: 8439972.0625; val_global_loss: 21200464.7500; val_optim_loss: 21200464.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9494; val_auprc_score: 0.9304; val_best_acc_score: 0.8982; val_best_f1_score: 0.9011; train_kl_reg_loss: 96145.7493; train_edge_recon_loss: 2717759.8864; train_gene_expr_recon_loss: 9729422.3333; train_masked_gp_l1_reg_loss: 141005.6023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53839.4917; train_chrom_access_recon_loss: 8343843.6818; train_global_loss: 21082016.7273; train_optim_loss: 21082016.7273; val_kl_reg_loss: 94132.4688; val_edge_recon_loss: 2772857.9375; val_gene_expr_recon_loss: 9827901.8750; val_masked_gp_l1_reg_loss: 140993.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53825.0352; val_chrom_access_recon_loss: 8403712.9375; val_global_loss: 21293423.2500; val_optim_loss: 21293423.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9545; val_auprc_score: 0.9360; val_best_acc_score: 0.9038; val_best_f1_score: 0.9056; train_kl_reg_loss: 95892.6491; train_edge_recon_loss: 2723700.8295; train_gene_expr_recon_loss: 9726139.3788; train_masked_gp_l1_reg_loss: 140983.3625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53817.3970; train_chrom_access_recon_loss: 8344424.7955; train_global_loss: 21084958.4545; train_optim_loss: 21084958.4545; val_kl_reg_loss: 94033.6592; val_edge_recon_loss: 2732816.5000; val_gene_expr_recon_loss: 9810800.5000; val_masked_gp_l1_reg_loss: 140976.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53809.0234; val_chrom_access_recon_loss: 8398784.1875; val_global_loss: 21231221.0000; val_optim_loss: 21231221.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 30 min 6 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9526
val AUPRC score: 0.9363
val best accuracy score: 0.9025
val best F1 score: 0.9057
val target rna MSE score: 1.6694
val source rna MSE score: 0.6657
val target atac MSE score: 0.3184
val source atac MSE score: 0.0726
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
