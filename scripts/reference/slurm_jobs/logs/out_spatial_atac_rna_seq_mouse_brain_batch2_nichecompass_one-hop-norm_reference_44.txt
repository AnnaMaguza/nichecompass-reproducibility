[True]
Run timestamp: 09102023_213225_44.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_44']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6717; val_auprc_score: 0.6541; val_best_acc_score: 0.5051; val_best_f1_score: 0.6689; train_kl_reg_loss: 49666.8263; train_edge_recon_loss: 3516498.2235; train_gene_expr_recon_loss: 13967246.4545; train_masked_gp_l1_reg_loss: 126263.3902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4453429.7538; train_chrom_access_recon_loss: 1000632.8864; train_global_loss: 23113737.3636; train_optim_loss: 23113737.3636; val_kl_reg_loss: 112650.9902; val_edge_recon_loss: 4064877.5625; val_gene_expr_recon_loss: 12895053.6250; val_masked_gp_l1_reg_loss: 100600.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1993742.1250; val_chrom_access_recon_loss: 954593.2656; val_global_loss: 20121517.0000; val_optim_loss: 20121517.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7145; val_auprc_score: 0.6902; val_best_acc_score: 0.6096; val_best_f1_score: 0.7018; train_kl_reg_loss: 94790.6912; train_edge_recon_loss: 3521822.6818; train_gene_expr_recon_loss: 12848503.5455; train_masked_gp_l1_reg_loss: 97406.2454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 892678.1420; train_chrom_access_recon_loss: 949221.2169; train_global_loss: 18404422.6061; train_optim_loss: 18404422.6061; val_kl_reg_loss: 81103.6504; val_edge_recon_loss: 4057694.6250; val_gene_expr_recon_loss: 12603198.6250; val_masked_gp_l1_reg_loss: 96046.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 348985.7500; val_chrom_access_recon_loss: 940581.9141; val_global_loss: 18127610.7500; val_optim_loss: 18127610.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7524; val_auprc_score: 0.7316; val_best_acc_score: 0.6733; val_best_f1_score: 0.7313; train_kl_reg_loss: 86975.4776; train_edge_recon_loss: 3509241.9205; train_gene_expr_recon_loss: 12700256.4091; train_masked_gp_l1_reg_loss: 96896.6156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 239501.5372; train_chrom_access_recon_loss: 939694.1146; train_global_loss: 17572566.2121; train_optim_loss: 17572566.2121; val_kl_reg_loss: 71081.1685; val_edge_recon_loss: 3932478.5000; val_gene_expr_recon_loss: 12518313.2500; val_masked_gp_l1_reg_loss: 98720.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174304.6250; val_chrom_access_recon_loss: 942027.5469; val_global_loss: 17736925.2500; val_optim_loss: 17736925.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7732; val_auprc_score: 0.7606; val_best_acc_score: 0.6908; val_best_f1_score: 0.7413; train_kl_reg_loss: 72099.7814; train_edge_recon_loss: 3315868.2386; train_gene_expr_recon_loss: 12657440.0000; train_masked_gp_l1_reg_loss: 103046.3550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148686.7174; train_chrom_access_recon_loss: 935727.0066; train_global_loss: 17232868.0606; train_optim_loss: 17232868.0606; val_kl_reg_loss: 80968.1826; val_edge_recon_loss: 3312203.3125; val_gene_expr_recon_loss: 12516900.1250; val_masked_gp_l1_reg_loss: 109671.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128813.6328; val_chrom_access_recon_loss: 941634.1641; val_global_loss: 17090190.5000; val_optim_loss: 17090190.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7852; val_auprc_score: 0.7800; val_best_acc_score: 0.6969; val_best_f1_score: 0.7413; train_kl_reg_loss: 96138.0475; train_edge_recon_loss: 3116885.9167; train_gene_expr_recon_loss: 12594056.1364; train_masked_gp_l1_reg_loss: 111320.2575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115247.5856; train_chrom_access_recon_loss: 930908.5975; train_global_loss: 16964556.4394; train_optim_loss: 16964556.4394; val_kl_reg_loss: 101290.9492; val_edge_recon_loss: 3175940.3125; val_gene_expr_recon_loss: 12295993.8750; val_masked_gp_l1_reg_loss: 112195.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103517.7031; val_chrom_access_recon_loss: 926077.2969; val_global_loss: 16715015.5000; val_optim_loss: 16715015.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8110; val_auprc_score: 0.8020; val_best_acc_score: 0.7160; val_best_f1_score: 0.7566; train_kl_reg_loss: 99258.3106; train_edge_recon_loss: 3072802.1629; train_gene_expr_recon_loss: 12492783.3939; train_masked_gp_l1_reg_loss: 112203.2438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97965.7367; train_chrom_access_recon_loss: 924191.7718; train_global_loss: 16799204.5909; train_optim_loss: 16799204.5909; val_kl_reg_loss: 97469.0557; val_edge_recon_loss: 3095373.5000; val_gene_expr_recon_loss: 12441672.5000; val_masked_gp_l1_reg_loss: 113029.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94425.0312; val_chrom_access_recon_loss: 924886.9844; val_global_loss: 16766856.3750; val_optim_loss: 16766856.3750
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8214; val_auprc_score: 0.8127; val_best_acc_score: 0.7319; val_best_f1_score: 0.7592; train_kl_reg_loss: 98655.4864; train_edge_recon_loss: 3027766.8068; train_gene_expr_recon_loss: 12424607.0455; train_masked_gp_l1_reg_loss: 113960.7250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92893.8261; train_chrom_access_recon_loss: 921471.9583; train_global_loss: 16679355.8333; train_optim_loss: 16679355.8333; val_kl_reg_loss: 90379.2334; val_edge_recon_loss: 3074031.5000; val_gene_expr_recon_loss: 12326489.8750; val_masked_gp_l1_reg_loss: 114821.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91666.1719; val_chrom_access_recon_loss: 919036.7812; val_global_loss: 16616424.3750; val_optim_loss: 16616424.3750
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8528; val_auprc_score: 0.8302; val_best_acc_score: 0.7706; val_best_f1_score: 0.7955; train_kl_reg_loss: 95967.3266; train_edge_recon_loss: 2983925.1856; train_gene_expr_recon_loss: 12360906.8485; train_masked_gp_l1_reg_loss: 115940.1713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89759.5618; train_chrom_access_recon_loss: 917016.1117; train_global_loss: 16563515.1515; train_optim_loss: 16563515.1515; val_kl_reg_loss: 87657.6367; val_edge_recon_loss: 2987611.0312; val_gene_expr_recon_loss: 12081323.5000; val_masked_gp_l1_reg_loss: 117660.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88924.5156; val_chrom_access_recon_loss: 908496.8203; val_global_loss: 16271673.6250; val_optim_loss: 16271673.6250
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8766; val_auprc_score: 0.8546; val_best_acc_score: 0.8006; val_best_f1_score: 0.8209; train_kl_reg_loss: 93319.2250; train_edge_recon_loss: 2887154.5833; train_gene_expr_recon_loss: 12294275.5303; train_masked_gp_l1_reg_loss: 119744.8388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88873.4045; train_chrom_access_recon_loss: 912242.4223; train_global_loss: 16395610.0000; train_optim_loss: 16395610.0000; val_kl_reg_loss: 92895.0166; val_edge_recon_loss: 2912870.3438; val_gene_expr_recon_loss: 12168278.8750; val_masked_gp_l1_reg_loss: 121779.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88353.9297; val_chrom_access_recon_loss: 911862.4062; val_global_loss: 16296040.6250; val_optim_loss: 16296040.6250
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9009; val_auprc_score: 0.8695; val_best_acc_score: 0.8356; val_best_f1_score: 0.8485; train_kl_reg_loss: 97309.6629; train_edge_recon_loss: 2846138.3030; train_gene_expr_recon_loss: 12233185.0758; train_masked_gp_l1_reg_loss: 122843.3118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88006.2681; train_chrom_access_recon_loss: 909288.5909; train_global_loss: 16296771.1970; train_optim_loss: 16296771.1970; val_kl_reg_loss: 98083.8408; val_edge_recon_loss: 2821510.9375; val_gene_expr_recon_loss: 11977914.7500; val_masked_gp_l1_reg_loss: 123969.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86997.4609; val_chrom_access_recon_loss: 911850.5547; val_global_loss: 16020327.0000; val_optim_loss: 16020327.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9079; val_auprc_score: 0.8810; val_best_acc_score: 0.8399; val_best_f1_score: 0.8513; train_kl_reg_loss: 96956.5672; train_edge_recon_loss: 2817911.6970; train_gene_expr_recon_loss: 12178631.3636; train_masked_gp_l1_reg_loss: 124911.9203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86175.8732; train_chrom_access_recon_loss: 906998.7093; train_global_loss: 16211586.1970; train_optim_loss: 16211586.1970; val_kl_reg_loss: 100111.4492; val_edge_recon_loss: 2837515.1875; val_gene_expr_recon_loss: 12111885.3750; val_masked_gp_l1_reg_loss: 125383.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84392.2266; val_chrom_access_recon_loss: 910314.7031; val_global_loss: 16169601.5000; val_optim_loss: 16169601.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9155; val_auprc_score: 0.8867; val_best_acc_score: 0.8501; val_best_f1_score: 0.8603; train_kl_reg_loss: 100998.0916; train_edge_recon_loss: 2788180.5568; train_gene_expr_recon_loss: 12130960.7273; train_masked_gp_l1_reg_loss: 126503.8974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83911.8671; train_chrom_access_recon_loss: 903085.5208; train_global_loss: 16133640.7424; train_optim_loss: 16133640.7424; val_kl_reg_loss: 99501.8340; val_edge_recon_loss: 2794519.5000; val_gene_expr_recon_loss: 11910140.1250; val_masked_gp_l1_reg_loss: 127419.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83794.6875; val_chrom_access_recon_loss: 893758.2656; val_global_loss: 15909134.0000; val_optim_loss: 15909134.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9039; val_auprc_score: 0.8683; val_best_acc_score: 0.8495; val_best_f1_score: 0.8602; train_kl_reg_loss: 101051.8717; train_edge_recon_loss: 2775813.2689; train_gene_expr_recon_loss: 12094649.9848; train_masked_gp_l1_reg_loss: 127893.5598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82601.7618; train_chrom_access_recon_loss: 900032.2964; train_global_loss: 16082042.8030; train_optim_loss: 16082042.8030; val_kl_reg_loss: 102601.3457; val_edge_recon_loss: 2835231.6875; val_gene_expr_recon_loss: 11974465.0000; val_masked_gp_l1_reg_loss: 128295.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81750.4766; val_chrom_access_recon_loss: 901515.9141; val_global_loss: 16023858.8750; val_optim_loss: 16023858.8750
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9115; val_auprc_score: 0.8839; val_best_acc_score: 0.8541; val_best_f1_score: 0.8648; train_kl_reg_loss: 101973.9440; train_edge_recon_loss: 2764574.9091; train_gene_expr_recon_loss: 12053833.0758; train_masked_gp_l1_reg_loss: 128688.8410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81652.2899; train_chrom_access_recon_loss: 897431.4299; train_global_loss: 16028154.5455; train_optim_loss: 16028154.5455; val_kl_reg_loss: 102799.6123; val_edge_recon_loss: 2792956.1875; val_gene_expr_recon_loss: 11989997.5000; val_masked_gp_l1_reg_loss: 129439.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81797.2266; val_chrom_access_recon_loss: 900860.6328; val_global_loss: 15997849.8750; val_optim_loss: 15997849.8750
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9200; val_auprc_score: 0.8958; val_best_acc_score: 0.8568; val_best_f1_score: 0.8691; train_kl_reg_loss: 100546.9148; train_edge_recon_loss: 2774608.3674; train_gene_expr_recon_loss: 12031374.1364; train_masked_gp_l1_reg_loss: 129473.7235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80803.9536; train_chrom_access_recon_loss: 896455.6383; train_global_loss: 16013262.8485; train_optim_loss: 16013262.8485; val_kl_reg_loss: 100368.3896; val_edge_recon_loss: 2797967.2500; val_gene_expr_recon_loss: 11804594.6250; val_masked_gp_l1_reg_loss: 129674.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80659.7734; val_chrom_access_recon_loss: 897373.5000; val_global_loss: 15810638.7500; val_optim_loss: 15810638.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9054; val_auprc_score: 0.8772; val_best_acc_score: 0.8418; val_best_f1_score: 0.8548; train_kl_reg_loss: 100080.3387; train_edge_recon_loss: 2763469.4924; train_gene_expr_recon_loss: 11983571.8939; train_masked_gp_l1_reg_loss: 129994.3729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80196.9121; train_chrom_access_recon_loss: 892378.0341; train_global_loss: 15949691.0606; train_optim_loss: 15949691.0606; val_kl_reg_loss: 104324.0586; val_edge_recon_loss: 2828007.5625; val_gene_expr_recon_loss: 11763157.3750; val_masked_gp_l1_reg_loss: 130671.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80419.9375; val_chrom_access_recon_loss: 891083.9375; val_global_loss: 15797664.7500; val_optim_loss: 15797664.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9117; val_auprc_score: 0.8801; val_best_acc_score: 0.8501; val_best_f1_score: 0.8601; train_kl_reg_loss: 97456.5651; train_edge_recon_loss: 2764354.7538; train_gene_expr_recon_loss: 11959048.6212; train_masked_gp_l1_reg_loss: 130455.7770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80052.5337; train_chrom_access_recon_loss: 890918.8769; train_global_loss: 15922287.1667; train_optim_loss: 15922287.1667; val_kl_reg_loss: 95625.4912; val_edge_recon_loss: 2820304.5000; val_gene_expr_recon_loss: 11764195.0000; val_masked_gp_l1_reg_loss: 130488.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79707.8984; val_chrom_access_recon_loss: 887786.6953; val_global_loss: 15778108.7500; val_optim_loss: 15778108.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9197; val_auprc_score: 0.8925; val_best_acc_score: 0.8587; val_best_f1_score: 0.8683; train_kl_reg_loss: 98413.6280; train_edge_recon_loss: 2756521.1742; train_gene_expr_recon_loss: 11921255.8636; train_masked_gp_l1_reg_loss: 130952.6309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79590.5949; train_chrom_access_recon_loss: 887547.2273; train_global_loss: 15874280.9697; train_optim_loss: 15874280.9697; val_kl_reg_loss: 98388.6406; val_edge_recon_loss: 2809726.7188; val_gene_expr_recon_loss: 11752938.5000; val_masked_gp_l1_reg_loss: 131187.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79183.0859; val_chrom_access_recon_loss: 883928.4531; val_global_loss: 15755353.3750; val_optim_loss: 15755353.3750
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9208; val_auprc_score: 0.8936; val_best_acc_score: 0.8611; val_best_f1_score: 0.8691; train_kl_reg_loss: 97327.0051; train_edge_recon_loss: 2751033.4773; train_gene_expr_recon_loss: 11902018.5758; train_masked_gp_l1_reg_loss: 131354.7917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79404.3577; train_chrom_access_recon_loss: 886702.9290; train_global_loss: 15847841.1818; train_optim_loss: 15847841.1818; val_kl_reg_loss: 94466.4229; val_edge_recon_loss: 2790966.1250; val_gene_expr_recon_loss: 11745554.0000; val_masked_gp_l1_reg_loss: 131512.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79445.5547; val_chrom_access_recon_loss: 880747.4844; val_global_loss: 15722693.2500; val_optim_loss: 15722693.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9223; val_auprc_score: 0.8939; val_best_acc_score: 0.8638; val_best_f1_score: 0.8702; train_kl_reg_loss: 97093.3492; train_edge_recon_loss: 2745077.9053; train_gene_expr_recon_loss: 11861111.3182; train_masked_gp_l1_reg_loss: 131665.5528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79088.9244; train_chrom_access_recon_loss: 883485.2216; train_global_loss: 15797522.1970; train_optim_loss: 15797522.1970; val_kl_reg_loss: 97733.7090; val_edge_recon_loss: 2801949.8125; val_gene_expr_recon_loss: 11835277.1250; val_masked_gp_l1_reg_loss: 131749.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78845.6875; val_chrom_access_recon_loss: 886316.2031; val_global_loss: 15831872.7500; val_optim_loss: 15831872.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9252; val_auprc_score: 0.8957; val_best_acc_score: 0.8713; val_best_f1_score: 0.8771; train_kl_reg_loss: 96099.7680; train_edge_recon_loss: 2752969.0038; train_gene_expr_recon_loss: 11836744.3788; train_masked_gp_l1_reg_loss: 131664.7822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78493.0083; train_chrom_access_recon_loss: 882191.6686; train_global_loss: 15778162.6364; train_optim_loss: 15778162.6364; val_kl_reg_loss: 97034.8408; val_edge_recon_loss: 2787727.7812; val_gene_expr_recon_loss: 11676787.3750; val_masked_gp_l1_reg_loss: 131765.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77923.9531; val_chrom_access_recon_loss: 878559.6641; val_global_loss: 15649799.6250; val_optim_loss: 15649799.6250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9225; val_auprc_score: 0.8861; val_best_acc_score: 0.8705; val_best_f1_score: 0.8794; train_kl_reg_loss: 95506.2285; train_edge_recon_loss: 2740376.1174; train_gene_expr_recon_loss: 11818446.9242; train_masked_gp_l1_reg_loss: 131827.6278; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78156.3435; train_chrom_access_recon_loss: 880580.9460; train_global_loss: 15744894.2273; train_optim_loss: 15744894.2273; val_kl_reg_loss: 98349.2031; val_edge_recon_loss: 2783613.3125; val_gene_expr_recon_loss: 11657107.7500; val_masked_gp_l1_reg_loss: 131988.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77970.6719; val_chrom_access_recon_loss: 875550.3438; val_global_loss: 15624579.6250; val_optim_loss: 15624579.6250
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9322; val_auprc_score: 0.9086; val_best_acc_score: 0.8759; val_best_f1_score: 0.8810; train_kl_reg_loss: 94393.4077; train_edge_recon_loss: 2753869.7652; train_gene_expr_recon_loss: 11788830.0152; train_masked_gp_l1_reg_loss: 132178.5031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78103.9665; train_chrom_access_recon_loss: 878217.3703; train_global_loss: 15725593.0152; train_optim_loss: 15725593.0152; val_kl_reg_loss: 91222.0068; val_edge_recon_loss: 2764051.1875; val_gene_expr_recon_loss: 11673306.3750; val_masked_gp_l1_reg_loss: 132343.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77488.4141; val_chrom_access_recon_loss: 875805.6797; val_global_loss: 15614216.3750; val_optim_loss: 15614216.3750
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9278; val_auprc_score: 0.8972; val_best_acc_score: 0.8732; val_best_f1_score: 0.8816; train_kl_reg_loss: 91564.2131; train_edge_recon_loss: 2753143.2500; train_gene_expr_recon_loss: 11760409.0455; train_masked_gp_l1_reg_loss: 132439.8000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77959.4637; train_chrom_access_recon_loss: 875711.7169; train_global_loss: 15691227.3333; train_optim_loss: 15691227.3333; val_kl_reg_loss: 91868.3555; val_edge_recon_loss: 2793964.7812; val_gene_expr_recon_loss: 11676837.3750; val_masked_gp_l1_reg_loss: 132756.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77941.9375; val_chrom_access_recon_loss: 886704.5938; val_global_loss: 15660073.0000; val_optim_loss: 15660073.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9317; val_auprc_score: 0.9110; val_best_acc_score: 0.8743; val_best_f1_score: 0.8827; train_kl_reg_loss: 92415.5056; train_edge_recon_loss: 2740134.1553; train_gene_expr_recon_loss: 11748364.8939; train_masked_gp_l1_reg_loss: 132854.2744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77523.2623; train_chrom_access_recon_loss: 874450.9223; train_global_loss: 15665743.0152; train_optim_loss: 15665743.0152; val_kl_reg_loss: 92280.8662; val_edge_recon_loss: 2788652.4688; val_gene_expr_recon_loss: 11606928.8750; val_masked_gp_l1_reg_loss: 132878.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77928.1641; val_chrom_access_recon_loss: 884821.4062; val_global_loss: 15583490.6250; val_optim_loss: 15583490.6250
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9359; val_auprc_score: 0.9081; val_best_acc_score: 0.8845; val_best_f1_score: 0.8895; train_kl_reg_loss: 92568.1396; train_edge_recon_loss: 2728125.9167; train_gene_expr_recon_loss: 11728297.8636; train_masked_gp_l1_reg_loss: 132933.6835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77569.4889; train_chrom_access_recon_loss: 872998.1070; train_global_loss: 15632493.1818; train_optim_loss: 15632493.1818; val_kl_reg_loss: 88404.5635; val_edge_recon_loss: 2773397.3125; val_gene_expr_recon_loss: 11698849.8750; val_masked_gp_l1_reg_loss: 133208.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78310.1016; val_chrom_access_recon_loss: 891336.4844; val_global_loss: 15663506.0000; val_optim_loss: 15663506.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9391; val_auprc_score: 0.9211; val_best_acc_score: 0.8815; val_best_f1_score: 0.8889; train_kl_reg_loss: 90499.1654; train_edge_recon_loss: 2738399.7879; train_gene_expr_recon_loss: 11706760.0303; train_masked_gp_l1_reg_loss: 133343.9451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78002.6805; train_chrom_access_recon_loss: 872157.3134; train_global_loss: 15619163.0455; train_optim_loss: 15619163.0455; val_kl_reg_loss: 89355.7842; val_edge_recon_loss: 2739229.0312; val_gene_expr_recon_loss: 11554386.1250; val_masked_gp_l1_reg_loss: 133653.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77858.8125; val_chrom_access_recon_loss: 870641.4531; val_global_loss: 15465125.3750; val_optim_loss: 15465125.3750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9381; val_auprc_score: 0.9112; val_best_acc_score: 0.8869; val_best_f1_score: 0.8925; train_kl_reg_loss: 92123.6354; train_edge_recon_loss: 2733399.5265; train_gene_expr_recon_loss: 11695914.8485; train_masked_gp_l1_reg_loss: 133374.6567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77460.1617; train_chrom_access_recon_loss: 870679.8229; train_global_loss: 15602952.7424; train_optim_loss: 15602952.7424; val_kl_reg_loss: 91403.8223; val_edge_recon_loss: 2743876.9062; val_gene_expr_recon_loss: 11630808.0000; val_masked_gp_l1_reg_loss: 133558.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77685.6484; val_chrom_access_recon_loss: 873999.5625; val_global_loss: 15551333.1250; val_optim_loss: 15551333.1250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9431; val_auprc_score: 0.9268; val_best_acc_score: 0.8864; val_best_f1_score: 0.8910; train_kl_reg_loss: 91054.8324; train_edge_recon_loss: 2727566.4848; train_gene_expr_recon_loss: 11689196.9545; train_masked_gp_l1_reg_loss: 133379.4387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77691.4035; train_chrom_access_recon_loss: 870356.0341; train_global_loss: 15589245.1818; train_optim_loss: 15589245.1818; val_kl_reg_loss: 90200.1113; val_edge_recon_loss: 2754211.3125; val_gene_expr_recon_loss: 11569961.5000; val_masked_gp_l1_reg_loss: 133228.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77049.4219; val_chrom_access_recon_loss: 874413.9375; val_global_loss: 15499065.0000; val_optim_loss: 15499065.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9399; val_auprc_score: 0.9192; val_best_acc_score: 0.8815; val_best_f1_score: 0.8878; train_kl_reg_loss: 91127.2887; train_edge_recon_loss: 2728328.7879; train_gene_expr_recon_loss: 11654525.6970; train_masked_gp_l1_reg_loss: 133294.6072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77618.6763; train_chrom_access_recon_loss: 867465.2206; train_global_loss: 15552360.2879; train_optim_loss: 15552360.2879; val_kl_reg_loss: 88017.0723; val_edge_recon_loss: 2758843.1250; val_gene_expr_recon_loss: 11443469.6250; val_masked_gp_l1_reg_loss: 133270.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77638.0781; val_chrom_access_recon_loss: 871253.5469; val_global_loss: 15372491.3750; val_optim_loss: 15372491.3750
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9381; val_auprc_score: 0.9084; val_best_acc_score: 0.8815; val_best_f1_score: 0.8876; train_kl_reg_loss: 91152.7506; train_edge_recon_loss: 2721314.9659; train_gene_expr_recon_loss: 11648786.3788; train_masked_gp_l1_reg_loss: 133158.8904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77610.3612; train_chrom_access_recon_loss: 866918.5303; train_global_loss: 15538941.8333; train_optim_loss: 15538941.8333; val_kl_reg_loss: 91238.5557; val_edge_recon_loss: 2749816.3438; val_gene_expr_recon_loss: 11541317.2500; val_masked_gp_l1_reg_loss: 133256.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77649.6172; val_chrom_access_recon_loss: 867979.6484; val_global_loss: 15461258.0000; val_optim_loss: 15461258.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9431; val_auprc_score: 0.9212; val_best_acc_score: 0.8901; val_best_f1_score: 0.8955; train_kl_reg_loss: 89776.9848; train_edge_recon_loss: 2717627.6098; train_gene_expr_recon_loss: 11628195.8485; train_masked_gp_l1_reg_loss: 133058.6113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77674.4163; train_chrom_access_recon_loss: 865563.8996; train_global_loss: 15511897.4242; train_optim_loss: 15511897.4242; val_kl_reg_loss: 91655.6592; val_edge_recon_loss: 2732684.2500; val_gene_expr_recon_loss: 11459993.3750; val_masked_gp_l1_reg_loss: 133020.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77766.5859; val_chrom_access_recon_loss: 857776.8594; val_global_loss: 15352898.0000; val_optim_loss: 15352898.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9442; val_auprc_score: 0.9229; val_best_acc_score: 0.8917; val_best_f1_score: 0.8968; train_kl_reg_loss: 89763.6830; train_edge_recon_loss: 2718344.0114; train_gene_expr_recon_loss: 11621339.5909; train_masked_gp_l1_reg_loss: 132974.6641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77538.6973; train_chrom_access_recon_loss: 865105.1553; train_global_loss: 15505065.7879; train_optim_loss: 15505065.7879; val_kl_reg_loss: 88989.8350; val_edge_recon_loss: 2748023.7812; val_gene_expr_recon_loss: 11536924.1250; val_masked_gp_l1_reg_loss: 133064.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77518.5391; val_chrom_access_recon_loss: 869858.5312; val_global_loss: 15454380.2500; val_optim_loss: 15454380.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9459; val_auprc_score: 0.9202; val_best_acc_score: 0.8931; val_best_f1_score: 0.8969; train_kl_reg_loss: 90054.6294; train_edge_recon_loss: 2724853.7689; train_gene_expr_recon_loss: 11594185.0606; train_masked_gp_l1_reg_loss: 133059.4138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77475.6332; train_chrom_access_recon_loss: 862035.2585; train_global_loss: 15481663.8333; train_optim_loss: 15481663.8333; val_kl_reg_loss: 91279.8838; val_edge_recon_loss: 2723234.5312; val_gene_expr_recon_loss: 11536816.1250; val_masked_gp_l1_reg_loss: 132990.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77658.2578; val_chrom_access_recon_loss: 867420.0234; val_global_loss: 15429399.7500; val_optim_loss: 15429399.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9421; val_auprc_score: 0.9151; val_best_acc_score: 0.8880; val_best_f1_score: 0.8936; train_kl_reg_loss: 89818.2456; train_edge_recon_loss: 2723190.3712; train_gene_expr_recon_loss: 11581682.3636; train_masked_gp_l1_reg_loss: 132836.6714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77327.3384; train_chrom_access_recon_loss: 862024.1951; train_global_loss: 15466879.1364; train_optim_loss: 15466879.1364; val_kl_reg_loss: 87529.7803; val_edge_recon_loss: 2764195.1875; val_gene_expr_recon_loss: 11535625.2500; val_masked_gp_l1_reg_loss: 132984.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77311.4141; val_chrom_access_recon_loss: 861029.8438; val_global_loss: 15458675.0000; val_optim_loss: 15458675.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9419; val_auprc_score: 0.9169; val_best_acc_score: 0.8853; val_best_f1_score: 0.8906; train_kl_reg_loss: 89428.0689; train_edge_recon_loss: 2720887.7841; train_gene_expr_recon_loss: 11583328.9394; train_masked_gp_l1_reg_loss: 132693.1844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77402.0756; train_chrom_access_recon_loss: 861033.9659; train_global_loss: 15464773.9848; train_optim_loss: 15464773.9848; val_kl_reg_loss: 88624.9785; val_edge_recon_loss: 2778547.5000; val_gene_expr_recon_loss: 11515526.5000; val_masked_gp_l1_reg_loss: 132606.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77470.5859; val_chrom_access_recon_loss: 865524.4531; val_global_loss: 15458301.3750; val_optim_loss: 15458301.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9456; val_auprc_score: 0.9257; val_best_acc_score: 0.8882; val_best_f1_score: 0.8927; train_kl_reg_loss: 88459.1652; train_edge_recon_loss: 2708902.0758; train_gene_expr_recon_loss: 11559374.2576; train_masked_gp_l1_reg_loss: 127945.0749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60213.7099; train_chrom_access_recon_loss: 859370.9858; train_global_loss: 15404265.2576; train_optim_loss: 15404265.2576; val_kl_reg_loss: 88612.9434; val_edge_recon_loss: 2768574.0938; val_gene_expr_recon_loss: 11461271.6250; val_masked_gp_l1_reg_loss: 126404.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56085.3398; val_chrom_access_recon_loss: 862446.5469; val_global_loss: 15363395.2500; val_optim_loss: 15363395.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9463; val_auprc_score: 0.9251; val_best_acc_score: 0.8864; val_best_f1_score: 0.8932; train_kl_reg_loss: 90263.5936; train_edge_recon_loss: 2713232.3182; train_gene_expr_recon_loss: 11544292.5758; train_masked_gp_l1_reg_loss: 126193.0085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55633.4289; train_chrom_access_recon_loss: 857096.1061; train_global_loss: 15386710.9242; train_optim_loss: 15386710.9242; val_kl_reg_loss: 91606.8076; val_edge_recon_loss: 2730434.3438; val_gene_expr_recon_loss: 11416559.8750; val_masked_gp_l1_reg_loss: 126102.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55380.6719; val_chrom_access_recon_loss: 860907.7109; val_global_loss: 15280991.6250; val_optim_loss: 15280991.6250
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9417; val_auprc_score: 0.9164; val_best_acc_score: 0.8877; val_best_f1_score: 0.8919; train_kl_reg_loss: 91018.5044; train_edge_recon_loss: 2713529.2992; train_gene_expr_recon_loss: 11557238.2879; train_masked_gp_l1_reg_loss: 126042.7066; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55218.0977; train_chrom_access_recon_loss: 858714.5530; train_global_loss: 15401761.5303; train_optim_loss: 15401761.5303; val_kl_reg_loss: 91707.0293; val_edge_recon_loss: 2765897.4062; val_gene_expr_recon_loss: 11572661.5000; val_masked_gp_l1_reg_loss: 125995.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55114.8438; val_chrom_access_recon_loss: 870387.0391; val_global_loss: 15481764.0000; val_optim_loss: 15481764.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9432; val_auprc_score: 0.9235; val_best_acc_score: 0.8850; val_best_f1_score: 0.8903; train_kl_reg_loss: 91180.4271; train_edge_recon_loss: 2706056.3826; train_gene_expr_recon_loss: 11546764.0909; train_masked_gp_l1_reg_loss: 125984.2553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55035.3415; train_chrom_access_recon_loss: 857121.6231; train_global_loss: 15382142.1515; train_optim_loss: 15382142.1515; val_kl_reg_loss: 91835.8398; val_edge_recon_loss: 2770412.6562; val_gene_expr_recon_loss: 11414946.3750; val_masked_gp_l1_reg_loss: 125950.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54903.0547; val_chrom_access_recon_loss: 864914.2344; val_global_loss: 15322962.0000; val_optim_loss: 15322962.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9542; val_auprc_score: 0.9409; val_best_acc_score: 0.8963; val_best_f1_score: 0.8996; train_kl_reg_loss: 92093.4906; train_edge_recon_loss: 2711742.5152; train_gene_expr_recon_loss: 11545243.1061; train_masked_gp_l1_reg_loss: 125922.4936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54788.9493; train_chrom_access_recon_loss: 857629.5928; train_global_loss: 15387420.0455; train_optim_loss: 15387420.0455; val_kl_reg_loss: 92371.2451; val_edge_recon_loss: 2746538.1875; val_gene_expr_recon_loss: 11437787.7500; val_masked_gp_l1_reg_loss: 125932.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54724.8633; val_chrom_access_recon_loss: 861860.2891; val_global_loss: 15319214.2500; val_optim_loss: 15319214.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9495; val_auprc_score: 0.9329; val_best_acc_score: 0.8925; val_best_f1_score: 0.8964; train_kl_reg_loss: 91896.5572; train_edge_recon_loss: 2707751.3977; train_gene_expr_recon_loss: 11544677.6667; train_masked_gp_l1_reg_loss: 125870.5501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54645.1036; train_chrom_access_recon_loss: 857395.5189; train_global_loss: 15382236.7879; train_optim_loss: 15382236.7879; val_kl_reg_loss: 92898.9570; val_edge_recon_loss: 2736382.9375; val_gene_expr_recon_loss: 11460260.5000; val_masked_gp_l1_reg_loss: 125891.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54640.1719; val_chrom_access_recon_loss: 855656.0547; val_global_loss: 15325730.2500; val_optim_loss: 15325730.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9459; val_auprc_score: 0.9269; val_best_acc_score: 0.8909; val_best_f1_score: 0.8949; train_kl_reg_loss: 92340.4446; train_edge_recon_loss: 2717625.2500; train_gene_expr_recon_loss: 11541765.1818; train_masked_gp_l1_reg_loss: 125392.3603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52982.3030; train_chrom_access_recon_loss: 857241.1449; train_global_loss: 15387346.8485; train_optim_loss: 15387346.8485; val_kl_reg_loss: 92244.3369; val_edge_recon_loss: 2755793.7500; val_gene_expr_recon_loss: 11341740.6250; val_masked_gp_l1_reg_loss: 125181.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52571.2539; val_chrom_access_recon_loss: 856109.3750; val_global_loss: 15223641.5000; val_optim_loss: 15223641.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9450; val_auprc_score: 0.9221; val_best_acc_score: 0.8920; val_best_f1_score: 0.8967; train_kl_reg_loss: 92392.0663; train_edge_recon_loss: 2703255.5455; train_gene_expr_recon_loss: 11543749.4545; train_masked_gp_l1_reg_loss: 125136.9833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52501.0104; train_chrom_access_recon_loss: 857273.9252; train_global_loss: 15374308.9697; train_optim_loss: 15374308.9697; val_kl_reg_loss: 92822.6133; val_edge_recon_loss: 2734466.7500; val_gene_expr_recon_loss: 11437308.8750; val_masked_gp_l1_reg_loss: 125112.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52448.0156; val_chrom_access_recon_loss: 855630.1016; val_global_loss: 15297788.3750; val_optim_loss: 15297788.3750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9429; val_auprc_score: 0.9153; val_best_acc_score: 0.8893; val_best_f1_score: 0.8936; train_kl_reg_loss: 92164.2849; train_edge_recon_loss: 2701548.9318; train_gene_expr_recon_loss: 11543493.3939; train_masked_gp_l1_reg_loss: 125095.3421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52410.7910; train_chrom_access_recon_loss: 856987.9602; train_global_loss: 15371700.5303; train_optim_loss: 15371700.5303; val_kl_reg_loss: 91913.0410; val_edge_recon_loss: 2771090.6875; val_gene_expr_recon_loss: 11472292.5000; val_masked_gp_l1_reg_loss: 125080.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52382.4922; val_chrom_access_recon_loss: 866445.5156; val_global_loss: 15379203.7500; val_optim_loss: 15379203.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9437; val_auprc_score: 0.9223; val_best_acc_score: 0.8912; val_best_f1_score: 0.8952; train_kl_reg_loss: 92101.8984; train_edge_recon_loss: 2708559.8220; train_gene_expr_recon_loss: 11538525.8485; train_masked_gp_l1_reg_loss: 125073.6733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52360.6709; train_chrom_access_recon_loss: 857291.9820; train_global_loss: 15373913.8485; train_optim_loss: 15373913.8485; val_kl_reg_loss: 92791.5137; val_edge_recon_loss: 2747797.1875; val_gene_expr_recon_loss: 11573091.8750; val_masked_gp_l1_reg_loss: 125067.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52335.1836; val_chrom_access_recon_loss: 873543.9609; val_global_loss: 15464627.3750; val_optim_loss: 15464627.3750
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9468; val_auprc_score: 0.9252; val_best_acc_score: 0.8925; val_best_f1_score: 0.8974; train_kl_reg_loss: 92164.7447; train_edge_recon_loss: 2710284.5189; train_gene_expr_recon_loss: 11542313.6061; train_masked_gp_l1_reg_loss: 125063.8891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52318.7020; train_chrom_access_recon_loss: 857988.4271; train_global_loss: 15380133.7727; train_optim_loss: 15380133.7727; val_kl_reg_loss: 92352.3213; val_edge_recon_loss: 2736897.6562; val_gene_expr_recon_loss: 11505098.0000; val_masked_gp_l1_reg_loss: 125058.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52306.6133; val_chrom_access_recon_loss: 854753.8281; val_global_loss: 15366467.8750; val_optim_loss: 15366467.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9455; val_auprc_score: 0.9170; val_best_acc_score: 0.8923; val_best_f1_score: 0.8976; train_kl_reg_loss: 92379.3197; train_edge_recon_loss: 2701434.5341; train_gene_expr_recon_loss: 11543926.5909; train_masked_gp_l1_reg_loss: 125009.4237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52142.3161; train_chrom_access_recon_loss: 857425.4621; train_global_loss: 15372317.6970; train_optim_loss: 15372317.6970; val_kl_reg_loss: 93387.4639; val_edge_recon_loss: 2721360.6562; val_gene_expr_recon_loss: 11538676.3750; val_masked_gp_l1_reg_loss: 124989.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52103.4102; val_chrom_access_recon_loss: 859555.6562; val_global_loss: 15390072.1250; val_optim_loss: 15390072.1250
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9503; val_auprc_score: 0.9329; val_best_acc_score: 0.8952; val_best_f1_score: 0.8997; train_kl_reg_loss: 92296.3073; train_edge_recon_loss: 2709365.8939; train_gene_expr_recon_loss: 11547118.5909; train_masked_gp_l1_reg_loss: 124984.1655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52097.4063; train_chrom_access_recon_loss: 857425.2197; train_global_loss: 15383287.5909; train_optim_loss: 15383287.5909; val_kl_reg_loss: 92727.3291; val_edge_recon_loss: 2747824.7812; val_gene_expr_recon_loss: 11384851.7500; val_masked_gp_l1_reg_loss: 124980.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52092.5820; val_chrom_access_recon_loss: 857978.3750; val_global_loss: 15260455.1250; val_optim_loss: 15260455.1250
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9499; val_auprc_score: 0.9297; val_best_acc_score: 0.9001; val_best_f1_score: 0.9030; train_kl_reg_loss: 92393.2622; train_edge_recon_loss: 2706569.9811; train_gene_expr_recon_loss: 11546840.7879; train_masked_gp_l1_reg_loss: 124978.3046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52088.3319; train_chrom_access_recon_loss: 857422.3295; train_global_loss: 15380293.0152; train_optim_loss: 15380293.0152; val_kl_reg_loss: 92773.5244; val_edge_recon_loss: 2722882.0625; val_gene_expr_recon_loss: 11404441.0000; val_masked_gp_l1_reg_loss: 124976.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52085.4336; val_chrom_access_recon_loss: 852201.1641; val_global_loss: 15249359.7500; val_optim_loss: 15249359.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9547; val_auprc_score: 0.9407; val_best_acc_score: 0.8974; val_best_f1_score: 0.9006; train_kl_reg_loss: 92256.5817; train_edge_recon_loss: 2703808.8333; train_gene_expr_recon_loss: 11531416.9545; train_masked_gp_l1_reg_loss: 124975.1313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52082.2663; train_chrom_access_recon_loss: 856680.1184; train_global_loss: 15361219.7576; train_optim_loss: 15361219.7576; val_kl_reg_loss: 92655.7539; val_edge_recon_loss: 2711327.5312; val_gene_expr_recon_loss: 11451400.5000; val_masked_gp_l1_reg_loss: 124973.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52079.5273; val_chrom_access_recon_loss: 863602.7109; val_global_loss: 15296040.5000; val_optim_loss: 15296040.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 10 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9516
val AUPRC score: 0.9348
val best accuracy score: 0.8939
val best F1 score: 0.8975
val target rna MSE score: 1.1926
val source rna MSE score: 0.6067
val target atac MSE score: 0.4851
val source atac MSE score: 0.1935
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
