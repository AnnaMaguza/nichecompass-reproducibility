[True]
Run timestamp: 07082023_205647_110.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_110']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8833; val_auprc_score: 0.9045; val_best_acc_score: 0.5135; val_best_f1_score: 0.6726; train_kl_reg_loss: 35415.1850; train_edge_recon_loss: 3476467.1389; train_gene_expr_recon_loss: 1357956.2500; train_masked_gp_l1_reg_loss: 4558.9470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119658.8906; train_chrom_access_recon_loss: 2551373.0833; train_global_loss: 7545429.6111; train_optim_loss: 7545429.6111; val_kl_reg_loss: 8546.5596; val_edge_recon_loss: 4064143.5000; val_gene_expr_recon_loss: 1176347.7500; val_masked_gp_l1_reg_loss: 4010.5886; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117450.2734; val_chrom_access_recon_loss: 1629882.7500; val_global_loss: 7000382.0000; val_optim_loss: 7000382.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8812; val_auprc_score: 0.9011; val_best_acc_score: 0.5177; val_best_f1_score: 0.6743; train_kl_reg_loss: 5610.5489; train_edge_recon_loss: 3470802.4444; train_gene_expr_recon_loss: 1076933.4028; train_masked_gp_l1_reg_loss: 3843.2199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116184.1111; train_chrom_access_recon_loss: 1515665.4722; train_global_loss: 6189039.2778; train_optim_loss: 6189039.2778; val_kl_reg_loss: 3357.8459; val_edge_recon_loss: 4064034.0000; val_gene_expr_recon_loss: 1042969.8125; val_masked_gp_l1_reg_loss: 3748.4629; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114690.5156; val_chrom_access_recon_loss: 1456709.6250; val_global_loss: 6685510.0000; val_optim_loss: 6685510.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8773; val_auprc_score: 0.8958; val_best_acc_score: 0.5116; val_best_f1_score: 0.6718; train_kl_reg_loss: 4707.2674; train_edge_recon_loss: 3473549.1944; train_gene_expr_recon_loss: 974181.8611; train_masked_gp_l1_reg_loss: 3831.1667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113525.3941; train_chrom_access_recon_loss: 1445140.8194; train_global_loss: 6014935.5556; train_optim_loss: 6014935.5556; val_kl_reg_loss: 9116.2021; val_edge_recon_loss: 4064975.7500; val_gene_expr_recon_loss: 942450.0625; val_masked_gp_l1_reg_loss: 3964.8411; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112047.2344; val_chrom_access_recon_loss: 1432973.0000; val_global_loss: 6565527.0000; val_optim_loss: 6565527.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8737; val_auprc_score: 0.8937; val_best_acc_score: 0.5077; val_best_f1_score: 0.6701; train_kl_reg_loss: 16205.9634; train_edge_recon_loss: 3478015.8333; train_gene_expr_recon_loss: 880557.2847; train_masked_gp_l1_reg_loss: 4039.8660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110814.4375; train_chrom_access_recon_loss: 1413153.6111; train_global_loss: 5902787.0000; train_optim_loss: 5902787.0000; val_kl_reg_loss: 18501.9434; val_edge_recon_loss: 4065426.0000; val_gene_expr_recon_loss: 861904.0000; val_masked_gp_l1_reg_loss: 4100.4131; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109224.6719; val_chrom_access_recon_loss: 1406072.1250; val_global_loss: 6465229.0000; val_optim_loss: 6465229.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8749; val_auprc_score: 0.8941; val_best_acc_score: 0.5123; val_best_f1_score: 0.6722; train_kl_reg_loss: 18976.5291; train_edge_recon_loss: 3481293.0278; train_gene_expr_recon_loss: 822904.6250; train_masked_gp_l1_reg_loss: 4140.8646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107851.7648; train_chrom_access_recon_loss: 1387638.6111; train_global_loss: 5822805.4444; train_optim_loss: 5822805.4444; val_kl_reg_loss: 18448.2227; val_edge_recon_loss: 4065244.0000; val_gene_expr_recon_loss: 820431.8750; val_masked_gp_l1_reg_loss: 4196.5898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106059.4062; val_chrom_access_recon_loss: 1378450.8750; val_global_loss: 6392831.0000; val_optim_loss: 6392831.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8786; val_auprc_score: 0.8975; val_best_acc_score: 0.5139; val_best_f1_score: 0.6728; train_kl_reg_loss: 19816.5612; train_edge_recon_loss: 3480534.7222; train_gene_expr_recon_loss: 785889.5278; train_masked_gp_l1_reg_loss: 4245.7090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104511.6120; train_chrom_access_recon_loss: 1363028.5278; train_global_loss: 5758026.6111; train_optim_loss: 5758026.6111; val_kl_reg_loss: 21096.9922; val_edge_recon_loss: 4065074.5000; val_gene_expr_recon_loss: 789691.8750; val_masked_gp_l1_reg_loss: 4299.7471; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102513.6406; val_chrom_access_recon_loss: 1361938.5000; val_global_loss: 6344615.0000; val_optim_loss: 6344615.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8907; val_auprc_score: 0.9029; val_best_acc_score: 0.5187; val_best_f1_score: 0.6749; train_kl_reg_loss: 21702.9219; train_edge_recon_loss: 3481744.1667; train_gene_expr_recon_loss: 759533.0556; train_masked_gp_l1_reg_loss: 4340.8446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100830.4167; train_chrom_access_recon_loss: 1349330.8333; train_global_loss: 5717482.2778; train_optim_loss: 5717482.2778; val_kl_reg_loss: 20590.0430; val_edge_recon_loss: 4064472.2500; val_gene_expr_recon_loss: 767592.5000; val_masked_gp_l1_reg_loss: 4386.6084; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98684.1016; val_chrom_access_recon_loss: 1352702.2500; val_global_loss: 6308428.0000; val_optim_loss: 6308428.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8942; val_auprc_score: 0.9002; val_best_acc_score: 0.5272; val_best_f1_score: 0.6784; train_kl_reg_loss: 21774.7977; train_edge_recon_loss: 3482015.1111; train_gene_expr_recon_loss: 735695.0556; train_masked_gp_l1_reg_loss: 4427.6836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96921.9280; train_chrom_access_recon_loss: 1340239.6528; train_global_loss: 5681074.3889; train_optim_loss: 5681074.3889; val_kl_reg_loss: 21470.2930; val_edge_recon_loss: 4063175.5000; val_gene_expr_recon_loss: 750735.1250; val_masked_gp_l1_reg_loss: 4468.3296; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94703.2969; val_chrom_access_recon_loss: 1345553.1250; val_global_loss: 6280106.0000; val_optim_loss: 6280106.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8893; val_auprc_score: 0.8900; val_best_acc_score: 0.5610; val_best_f1_score: 0.6928; train_kl_reg_loss: 21603.5705; train_edge_recon_loss: 3481499.1111; train_gene_expr_recon_loss: 727603.0764; train_masked_gp_l1_reg_loss: 4498.8714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92910.0929; train_chrom_access_recon_loss: 1345209.5139; train_global_loss: 5673324.2222; train_optim_loss: 5673324.2222; val_kl_reg_loss: 21045.0742; val_edge_recon_loss: 4061122.7500; val_gene_expr_recon_loss: 737961.6875; val_masked_gp_l1_reg_loss: 4530.0669; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90667.6406; val_chrom_access_recon_loss: 1339082.7500; val_global_loss: 6254410.0000; val_optim_loss: 6254410.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8832; val_auprc_score: 0.8853; val_best_acc_score: 0.5992; val_best_f1_score: 0.7093; train_kl_reg_loss: 22230.2878; train_edge_recon_loss: 3480890.1389; train_gene_expr_recon_loss: 712651.3542; train_masked_gp_l1_reg_loss: 4561.5452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88879.5616; train_chrom_access_recon_loss: 1325148.1528; train_global_loss: 5634361.0000; train_optim_loss: 5634361.0000; val_kl_reg_loss: 23262.9961; val_edge_recon_loss: 4059013.7500; val_gene_expr_recon_loss: 726824.2500; val_masked_gp_l1_reg_loss: 4593.7168; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86653.1406; val_chrom_access_recon_loss: 1333929.6250; val_global_loss: 6234277.0000; val_optim_loss: 6234277.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8941; val_auprc_score: 0.8936; val_best_acc_score: 0.6946; val_best_f1_score: 0.7585; train_kl_reg_loss: 22251.6174; train_edge_recon_loss: 3480876.3333; train_gene_expr_recon_loss: 707796.7639; train_masked_gp_l1_reg_loss: 4623.9712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84895.7031; train_chrom_access_recon_loss: 1328716.3611; train_global_loss: 5629160.6667; train_optim_loss: 5629160.6667; val_kl_reg_loss: 21387.5938; val_edge_recon_loss: 4052655.5000; val_gene_expr_recon_loss: 719567.8750; val_masked_gp_l1_reg_loss: 4654.1450; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82720.3438; val_chrom_access_recon_loss: 1329768.2500; val_global_loss: 6210754.0000; val_optim_loss: 6210754.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9033; val_auprc_score: 0.8947; val_best_acc_score: 0.8092; val_best_f1_score: 0.8273; train_kl_reg_loss: 21699.8945; train_edge_recon_loss: 3480537.4444; train_gene_expr_recon_loss: 700243.7639; train_masked_gp_l1_reg_loss: 4687.8465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81021.4210; train_chrom_access_recon_loss: 1327051.4722; train_global_loss: 5615241.8333; train_optim_loss: 5615241.8333; val_kl_reg_loss: 21272.8203; val_edge_recon_loss: 4038269.2500; val_gene_expr_recon_loss: 712636.1250; val_masked_gp_l1_reg_loss: 4713.0215; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78922.6406; val_chrom_access_recon_loss: 1326191.6250; val_global_loss: 6182005.0000; val_optim_loss: 6182005.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9216; val_auprc_score: 0.9067; val_best_acc_score: 0.8416; val_best_f1_score: 0.8336; train_kl_reg_loss: 21341.9620; train_edge_recon_loss: 3477077.3889; train_gene_expr_recon_loss: 694078.4375; train_masked_gp_l1_reg_loss: 4736.4078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77291.3299; train_chrom_access_recon_loss: 1325034.9722; train_global_loss: 5599560.4444; train_optim_loss: 5599560.4444; val_kl_reg_loss: 18383.4375; val_edge_recon_loss: 3981309.7500; val_gene_expr_recon_loss: 709454.6250; val_masked_gp_l1_reg_loss: 4760.9409; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75281.8438; val_chrom_access_recon_loss: 1322570.6250; val_global_loss: 6111761.5000; val_optim_loss: 6111761.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9268; val_auprc_score: 0.9089; val_best_acc_score: 0.8599; val_best_f1_score: 0.8658; train_kl_reg_loss: 18659.2091; train_edge_recon_loss: 3459514.3889; train_gene_expr_recon_loss: 688824.9375; train_masked_gp_l1_reg_loss: 4793.4857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73735.1849; train_chrom_access_recon_loss: 1314585.8750; train_global_loss: 5560113.1667; train_optim_loss: 5560113.1667; val_kl_reg_loss: 13209.7246; val_edge_recon_loss: 3650713.5000; val_gene_expr_recon_loss: 712791.3750; val_masked_gp_l1_reg_loss: 4828.3589; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71839.8125; val_chrom_access_recon_loss: 1321666.0000; val_global_loss: 5775049.0000; val_optim_loss: 5775049.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8802; val_auprc_score: 0.8637; val_best_acc_score: 0.7956; val_best_f1_score: 0.8122; train_kl_reg_loss: 11188.0217; train_edge_recon_loss: 3269420.3889; train_gene_expr_recon_loss: 707204.5903; train_masked_gp_l1_reg_loss: 4888.9555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70418.2483; train_chrom_access_recon_loss: 1324046.5833; train_global_loss: 5387166.7222; train_optim_loss: 5387166.7222; val_kl_reg_loss: 13069.6025; val_edge_recon_loss: 2982138.5000; val_gene_expr_recon_loss: 749660.3750; val_masked_gp_l1_reg_loss: 4987.8066; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68707.2031; val_chrom_access_recon_loss: 1333558.1250; val_global_loss: 5152121.5000; val_optim_loss: 5152121.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8756; val_auprc_score: 0.8514; val_best_acc_score: 0.7940; val_best_f1_score: 0.8113; train_kl_reg_loss: 24427.2355; train_edge_recon_loss: 2919258.6944; train_gene_expr_recon_loss: 732029.0833; train_masked_gp_l1_reg_loss: 5103.7121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67400.4479; train_chrom_access_recon_loss: 1332540.5833; train_global_loss: 5080759.7222; train_optim_loss: 5080759.7222; val_kl_reg_loss: 37895.6367; val_edge_recon_loss: 2871792.5000; val_gene_expr_recon_loss: 740208.3750; val_masked_gp_l1_reg_loss: 5231.7329; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65782.2734; val_chrom_access_recon_loss: 1328629.1250; val_global_loss: 5049539.5000; val_optim_loss: 5049539.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8905; val_auprc_score: 0.8602; val_best_acc_score: 0.8137; val_best_f1_score: 0.8306; train_kl_reg_loss: 46414.4510; train_edge_recon_loss: 2828298.6667; train_gene_expr_recon_loss: 714236.5417; train_masked_gp_l1_reg_loss: 5287.8050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64534.5026; train_chrom_access_recon_loss: 1316109.9722; train_global_loss: 4974882.0000; train_optim_loss: 4974882.0000; val_kl_reg_loss: 48127.5625; val_edge_recon_loss: 2815950.5000; val_gene_expr_recon_loss: 726471.3125; val_masked_gp_l1_reg_loss: 5340.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62993.6523; val_chrom_access_recon_loss: 1323291.6250; val_global_loss: 4982175.5000; val_optim_loss: 4982175.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9136; val_auprc_score: 0.8871; val_best_acc_score: 0.8508; val_best_f1_score: 0.8608; train_kl_reg_loss: 46941.1788; train_edge_recon_loss: 2805708.0000; train_gene_expr_recon_loss: 704453.4861; train_masked_gp_l1_reg_loss: 5361.5634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61796.7665; train_chrom_access_recon_loss: 1314557.5556; train_global_loss: 4938818.5000; train_optim_loss: 4938818.5000; val_kl_reg_loss: 41570.2773; val_edge_recon_loss: 2756231.7500; val_gene_expr_recon_loss: 723650.1250; val_masked_gp_l1_reg_loss: 5379.0889; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60320.7109; val_chrom_access_recon_loss: 1321225.2500; val_global_loss: 4908377.0000; val_optim_loss: 4908377.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9256; val_auprc_score: 0.9055; val_best_acc_score: 0.8647; val_best_f1_score: 0.8724; train_kl_reg_loss: 38761.3129; train_edge_recon_loss: 2782265.8056; train_gene_expr_recon_loss: 706307.2361; train_masked_gp_l1_reg_loss: 5385.4754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59191.0091; train_chrom_access_recon_loss: 1314587.7639; train_global_loss: 4906498.4444; train_optim_loss: 4906498.4444; val_kl_reg_loss: 36285.2695; val_edge_recon_loss: 2753518.2500; val_gene_expr_recon_loss: 721694.5625; val_masked_gp_l1_reg_loss: 5392.4033; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57805.7422; val_chrom_access_recon_loss: 1319078.3750; val_global_loss: 4893774.5000; val_optim_loss: 4893774.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9320; val_auprc_score: 0.9114; val_best_acc_score: 0.8719; val_best_f1_score: 0.8796; train_kl_reg_loss: 37488.2049; train_edge_recon_loss: 2749771.6111; train_gene_expr_recon_loss: 700761.5208; train_masked_gp_l1_reg_loss: 5398.6308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56747.1319; train_chrom_access_recon_loss: 1308662.6528; train_global_loss: 4858829.7222; train_optim_loss: 4858829.7222; val_kl_reg_loss: 39251.2383; val_edge_recon_loss: 2740031.5000; val_gene_expr_recon_loss: 717140.4375; val_masked_gp_l1_reg_loss: 5398.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55451.4453; val_chrom_access_recon_loss: 1316021.6250; val_global_loss: 4873294.5000; val_optim_loss: 4873294.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9330; val_auprc_score: 0.9092; val_best_acc_score: 0.8759; val_best_f1_score: 0.8825; train_kl_reg_loss: 41946.9062; train_edge_recon_loss: 2738697.3056; train_gene_expr_recon_loss: 695783.7500; train_masked_gp_l1_reg_loss: 5394.8160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54461.1853; train_chrom_access_recon_loss: 1310658.3889; train_global_loss: 4846942.4444; train_optim_loss: 4846942.4444; val_kl_reg_loss: 42751.4375; val_edge_recon_loss: 2744085.2500; val_gene_expr_recon_loss: 715120.0000; val_masked_gp_l1_reg_loss: 5395.0244; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53242.6719; val_chrom_access_recon_loss: 1312569.6250; val_global_loss: 4873164.0000; val_optim_loss: 4873164.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9415; val_auprc_score: 0.9239; val_best_acc_score: 0.8805; val_best_f1_score: 0.8861; train_kl_reg_loss: 43245.0412; train_edge_recon_loss: 2733263.3889; train_gene_expr_recon_loss: 691865.6667; train_masked_gp_l1_reg_loss: 5395.1162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52318.2287; train_chrom_access_recon_loss: 1303113.5000; train_global_loss: 4829200.9444; train_optim_loss: 4829200.9444; val_kl_reg_loss: 42591.1758; val_edge_recon_loss: 2749267.7500; val_gene_expr_recon_loss: 710202.7500; val_masked_gp_l1_reg_loss: 5393.6128; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51176.9102; val_chrom_access_recon_loss: 1310284.6250; val_global_loss: 4868917.0000; val_optim_loss: 4868917.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9416; val_auprc_score: 0.9218; val_best_acc_score: 0.8812; val_best_f1_score: 0.8880; train_kl_reg_loss: 41833.7817; train_edge_recon_loss: 2722713.4167; train_gene_expr_recon_loss: 690415.3819; train_masked_gp_l1_reg_loss: 5401.1970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50305.3142; train_chrom_access_recon_loss: 1301685.6528; train_global_loss: 4812354.7778; train_optim_loss: 4812354.7778; val_kl_reg_loss: 42025.2930; val_edge_recon_loss: 2735732.0000; val_gene_expr_recon_loss: 708734.0000; val_masked_gp_l1_reg_loss: 5411.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49235.0547; val_chrom_access_recon_loss: 1308785.2500; val_global_loss: 4849922.5000; val_optim_loss: 4849922.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9524; val_auprc_score: 0.9345; val_best_acc_score: 0.8941; val_best_f1_score: 0.8989; train_kl_reg_loss: 41633.7057; train_edge_recon_loss: 2712568.7222; train_gene_expr_recon_loss: 689712.9583; train_masked_gp_l1_reg_loss: 5425.0902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48406.3898; train_chrom_access_recon_loss: 1309342.3333; train_global_loss: 4807089.1111; train_optim_loss: 4807089.1111; val_kl_reg_loss: 41817.9336; val_edge_recon_loss: 2702853.0000; val_gene_expr_recon_loss: 708182.8125; val_masked_gp_l1_reg_loss: 5432.5317; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47391.9336; val_chrom_access_recon_loss: 1306896.5000; val_global_loss: 4812575.0000; val_optim_loss: 4812575.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9485; val_auprc_score: 0.9307; val_best_acc_score: 0.8922; val_best_f1_score: 0.8966; train_kl_reg_loss: 41868.6580; train_edge_recon_loss: 2706205.6111; train_gene_expr_recon_loss: 688509.5972; train_masked_gp_l1_reg_loss: 5447.6741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46615.9362; train_chrom_access_recon_loss: 1297949.9722; train_global_loss: 4786597.5000; train_optim_loss: 4786597.5000; val_kl_reg_loss: 40688.4297; val_edge_recon_loss: 2733057.5000; val_gene_expr_recon_loss: 705274.7500; val_masked_gp_l1_reg_loss: 5460.6270; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45661.7266; val_chrom_access_recon_loss: 1304779.8750; val_global_loss: 4834923.0000; val_optim_loss: 4834923.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9567; val_auprc_score: 0.9423; val_best_acc_score: 0.9026; val_best_f1_score: 0.9058; train_kl_reg_loss: 37590.7860; train_edge_recon_loss: 2714413.1111; train_gene_expr_recon_loss: 960457.6250; train_masked_gp_l1_reg_loss: 5514.7599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44769.5868; train_chrom_access_recon_loss: 1368748.9722; train_global_loss: 5131494.7778; train_optim_loss: 5131494.7778; val_kl_reg_loss: 26824.5605; val_edge_recon_loss: 2705563.5000; val_gene_expr_recon_loss: 984698.1250; val_masked_gp_l1_reg_loss: 5592.1143; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43564.5898; val_chrom_access_recon_loss: 1374599.0000; val_global_loss: 5140841.5000; val_optim_loss: 5140841.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9586; val_auprc_score: 0.9427; val_best_acc_score: 0.9051; val_best_f1_score: 0.9081; train_kl_reg_loss: 34275.5347; train_edge_recon_loss: 2697264.6111; train_gene_expr_recon_loss: 959826.8264; train_masked_gp_l1_reg_loss: 5658.9269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42543.4826; train_chrom_access_recon_loss: 1367711.7361; train_global_loss: 5107281.1111; train_optim_loss: 5107281.1111; val_kl_reg_loss: 26260.4414; val_edge_recon_loss: 2683020.5000; val_gene_expr_recon_loss: 982773.2500; val_masked_gp_l1_reg_loss: 5736.3354; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41271.1484; val_chrom_access_recon_loss: 1373724.6250; val_global_loss: 5112786.5000; val_optim_loss: 5112786.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9613; val_auprc_score: 0.9447; val_best_acc_score: 0.9099; val_best_f1_score: 0.9123; train_kl_reg_loss: 32747.1812; train_edge_recon_loss: 2690035.8333; train_gene_expr_recon_loss: 958987.6389; train_masked_gp_l1_reg_loss: 5797.2931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40281.1914; train_chrom_access_recon_loss: 1369818.8889; train_global_loss: 5097668.1111; train_optim_loss: 5097668.1111; val_kl_reg_loss: 24397.8008; val_edge_recon_loss: 2674934.2500; val_gene_expr_recon_loss: 981550.5000; val_masked_gp_l1_reg_loss: 5874.3218; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39068.0742; val_chrom_access_recon_loss: 1372424.5000; val_global_loss: 5098249.0000; val_optim_loss: 5098249.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9611; val_auprc_score: 0.9479; val_best_acc_score: 0.9082; val_best_f1_score: 0.9106; train_kl_reg_loss: 31359.5720; train_edge_recon_loss: 2680533.6667; train_gene_expr_recon_loss: 953527.1806; train_masked_gp_l1_reg_loss: 5869.0164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38939.9926; train_chrom_access_recon_loss: 1367149.2778; train_global_loss: 5077378.6667; train_optim_loss: 5077378.6667; val_kl_reg_loss: 24563.3418; val_edge_recon_loss: 2687334.5000; val_gene_expr_recon_loss: 980736.8125; val_masked_gp_l1_reg_loss: 5861.0723; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38782.5430; val_chrom_access_recon_loss: 1372488.0000; val_global_loss: 5109766.0000; val_optim_loss: 5109766.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9627; val_auprc_score: 0.9471; val_best_acc_score: 0.9130; val_best_f1_score: 0.9152; train_kl_reg_loss: 31418.4742; train_edge_recon_loss: 2681587.0278; train_gene_expr_recon_loss: 950768.0486; train_masked_gp_l1_reg_loss: 5859.4686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38666.8620; train_chrom_access_recon_loss: 1360382.7500; train_global_loss: 5068682.6111; train_optim_loss: 5068682.6111; val_kl_reg_loss: 24234.1660; val_edge_recon_loss: 2691922.0000; val_gene_expr_recon_loss: 981447.0000; val_masked_gp_l1_reg_loss: 5857.4272; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38521.8516; val_chrom_access_recon_loss: 1372310.7500; val_global_loss: 5114293.0000; val_optim_loss: 5114293.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9596; val_auprc_score: 0.9459; val_best_acc_score: 0.9081; val_best_f1_score: 0.9119; train_kl_reg_loss: 31337.8383; train_edge_recon_loss: 2682764.2778; train_gene_expr_recon_loss: 951696.1667; train_masked_gp_l1_reg_loss: 5857.3162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38411.1168; train_chrom_access_recon_loss: 1361239.4861; train_global_loss: 5071306.3333; train_optim_loss: 5071306.3333; val_kl_reg_loss: 24374.1016; val_edge_recon_loss: 2697728.7500; val_gene_expr_recon_loss: 980668.1875; val_masked_gp_l1_reg_loss: 5857.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38274.6445; val_chrom_access_recon_loss: 1372640.1250; val_global_loss: 5119543.5000; val_optim_loss: 5119543.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9605; val_auprc_score: 0.9424; val_best_acc_score: 0.9089; val_best_f1_score: 0.9125; train_kl_reg_loss: 31510.4403; train_edge_recon_loss: 2678136.3889; train_gene_expr_recon_loss: 953960.7500; train_masked_gp_l1_reg_loss: 5859.4261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38169.5516; train_chrom_access_recon_loss: 1365672.1111; train_global_loss: 5073308.5556; train_optim_loss: 5073308.5556; val_kl_reg_loss: 24205.9551; val_edge_recon_loss: 2683328.0000; val_gene_expr_recon_loss: 979714.1875; val_masked_gp_l1_reg_loss: 5861.9658; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38041.8711; val_chrom_access_recon_loss: 1371799.3750; val_global_loss: 5102951.5000; val_optim_loss: 5102951.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 20 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9524
val AUPRC score: 0.9422
val best accuracy score: 0.8895
val best F1 score: 0.8952
val target rna MSE score: 4.2827
val source rna MSE score: 3.4063
val target atac MSE score: 0.1398
val source atac MSE score: 0.0216
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
