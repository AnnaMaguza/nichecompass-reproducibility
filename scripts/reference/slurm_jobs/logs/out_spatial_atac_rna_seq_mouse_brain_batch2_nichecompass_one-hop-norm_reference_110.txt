[True]
Run timestamp: 26072023_031724_110.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_110']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9623; val_auprc_score: 0.9646; val_best_acc_score: 0.7571; val_best_f1_score: 0.8027; train_kl_reg_loss: 838.4165; train_edge_recon_loss: 34650684.4444; train_gene_expr_recon_loss: 323112.5660; train_masked_gp_l1_reg_loss: 1550.3999; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1077005.3611; train_global_loss: 36053192.0000; train_optim_loss: 36053192.0000; val_kl_reg_loss: 358.6415; val_edge_recon_loss: 39884560.0000; val_gene_expr_recon_loss: 320052.7812; val_masked_gp_l1_reg_loss: 1207.9880; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1079617.5000; val_global_loss: 41285796.0000; val_optim_loss: 41285796.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8922; val_auprc_score: 0.8828; val_best_acc_score: 0.8013; val_best_f1_score: 0.8167; train_kl_reg_loss: 517.3321; train_edge_recon_loss: 34411668.8889; train_gene_expr_recon_loss: 321012.6701; train_masked_gp_l1_reg_loss: 1036.9365; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1078380.3472; train_global_loss: 35812615.5556; train_optim_loss: 35812615.5556; val_kl_reg_loss: 1182.5981; val_edge_recon_loss: 32843258.0000; val_gene_expr_recon_loss: 316730.8750; val_masked_gp_l1_reg_loss: 885.2455; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1076758.6250; val_global_loss: 34238816.0000; val_optim_loss: 34238816.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8720; val_auprc_score: 0.8708; val_best_acc_score: 0.7712; val_best_f1_score: 0.7873; train_kl_reg_loss: 6593.3328; train_edge_recon_loss: 30590306.6667; train_gene_expr_recon_loss: 319139.7743; train_masked_gp_l1_reg_loss: 874.6041; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1076136.2083; train_global_loss: 31993050.6667; train_optim_loss: 31993050.6667; val_kl_reg_loss: 19823.0391; val_edge_recon_loss: 28761200.0000; val_gene_expr_recon_loss: 319536.5938; val_masked_gp_l1_reg_loss: 879.4069; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1078595.6250; val_global_loss: 30180036.0000; val_optim_loss: 30180036.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8786; val_auprc_score: 0.8581; val_best_acc_score: 0.7879; val_best_f1_score: 0.8066; train_kl_reg_loss: 31842.9475; train_edge_recon_loss: 28176249.3333; train_gene_expr_recon_loss: 318599.3472; train_masked_gp_l1_reg_loss: 832.7456; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1070349.4583; train_global_loss: 29597874.8889; train_optim_loss: 29597874.8889; val_kl_reg_loss: 43845.4062; val_edge_recon_loss: 28090468.0000; val_gene_expr_recon_loss: 312022.5000; val_masked_gp_l1_reg_loss: 765.5380; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1068454.8750; val_global_loss: 29515556.0000; val_optim_loss: 29515556.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8977; val_auprc_score: 0.8737; val_best_acc_score: 0.8197; val_best_f1_score: 0.8334; train_kl_reg_loss: 47519.5343; train_edge_recon_loss: 27855816.2222; train_gene_expr_recon_loss: 313924.1597; train_masked_gp_l1_reg_loss: 739.0098; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1072756.9722; train_global_loss: 29290755.3333; train_optim_loss: 29290755.3333; val_kl_reg_loss: 48485.2969; val_edge_recon_loss: 27704520.0000; val_gene_expr_recon_loss: 309113.0625; val_masked_gp_l1_reg_loss: 700.4846; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1071207.3750; val_global_loss: 29134028.0000; val_optim_loss: 29134028.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9222; val_auprc_score: 0.9011; val_best_acc_score: 0.8518; val_best_f1_score: 0.8617; train_kl_reg_loss: 50860.7904; train_edge_recon_loss: 27372196.0000; train_gene_expr_recon_loss: 311383.5451; train_masked_gp_l1_reg_loss: 659.1572; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1072297.3750; train_global_loss: 28807397.1111; train_optim_loss: 28807397.1111; val_kl_reg_loss: 50913.2500; val_edge_recon_loss: 27095952.0000; val_gene_expr_recon_loss: 307437.5625; val_masked_gp_l1_reg_loss: 623.0862; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1067881.3750; val_global_loss: 28522810.0000; val_optim_loss: 28522810.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9345; val_auprc_score: 0.9137; val_best_acc_score: 0.8729; val_best_f1_score: 0.8789; train_kl_reg_loss: 50865.9640; train_edge_recon_loss: 27089022.4444; train_gene_expr_recon_loss: 307742.8472; train_masked_gp_l1_reg_loss: 617.8975; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1060780.7361; train_global_loss: 28509029.3333; train_optim_loss: 28509029.3333; val_kl_reg_loss: 48730.3125; val_edge_recon_loss: 26950810.0000; val_gene_expr_recon_loss: 304382.8750; val_masked_gp_l1_reg_loss: 609.1649; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1068633.8750; val_global_loss: 28373166.0000; val_optim_loss: 28373166.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9427; val_auprc_score: 0.9268; val_best_acc_score: 0.8797; val_best_f1_score: 0.8851; train_kl_reg_loss: 48964.5382; train_edge_recon_loss: 26802499.3333; train_gene_expr_recon_loss: 307098.9896; train_masked_gp_l1_reg_loss: 604.5178; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1063551.3125; train_global_loss: 28222719.1111; train_optim_loss: 28222719.1111; val_kl_reg_loss: 46084.3633; val_edge_recon_loss: 26965186.0000; val_gene_expr_recon_loss: 305465.5625; val_masked_gp_l1_reg_loss: 604.5157; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1065429.2500; val_global_loss: 28382770.0000; val_optim_loss: 28382770.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9471; val_auprc_score: 0.9283; val_best_acc_score: 0.8919; val_best_f1_score: 0.8969; train_kl_reg_loss: 44234.0890; train_edge_recon_loss: 26630411.5556; train_gene_expr_recon_loss: 304834.6285; train_masked_gp_l1_reg_loss: 607.3489; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1060867.8750; train_global_loss: 28040954.8889; train_optim_loss: 28040954.8889; val_kl_reg_loss: 40638.3281; val_edge_recon_loss: 26750228.0000; val_gene_expr_recon_loss: 301622.1562; val_masked_gp_l1_reg_loss: 611.5052; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1064901.2500; val_global_loss: 28158002.0000; val_optim_loss: 28158002.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9511; val_auprc_score: 0.9326; val_best_acc_score: 0.8994; val_best_f1_score: 0.9050; train_kl_reg_loss: 39531.1758; train_edge_recon_loss: 26509188.8889; train_gene_expr_recon_loss: 302820.6667; train_masked_gp_l1_reg_loss: 615.6155; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1059980.8889; train_global_loss: 27912137.3333; train_optim_loss: 27912137.3333; val_kl_reg_loss: 37098.0078; val_edge_recon_loss: 26770508.0000; val_gene_expr_recon_loss: 305237.0312; val_masked_gp_l1_reg_loss: 623.7355; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1064807.1250; val_global_loss: 28178276.0000; val_optim_loss: 28178276.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9548; val_auprc_score: 0.9354; val_best_acc_score: 0.9034; val_best_f1_score: 0.9079; train_kl_reg_loss: 37469.5417; train_edge_recon_loss: 26415505.1111; train_gene_expr_recon_loss: 301764.6042; train_masked_gp_l1_reg_loss: 624.9015; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1061524.7778; train_global_loss: 27816889.3333; train_optim_loss: 27816889.3333; val_kl_reg_loss: 35700.6328; val_edge_recon_loss: 26563766.0000; val_gene_expr_recon_loss: 302344.0938; val_masked_gp_l1_reg_loss: 637.1730; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1067284.6250; val_global_loss: 27969732.0000; val_optim_loss: 27969732.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9563; val_auprc_score: 0.9371; val_best_acc_score: 0.9073; val_best_f1_score: 0.9107; train_kl_reg_loss: 37121.7001; train_edge_recon_loss: 26428961.5556; train_gene_expr_recon_loss: 299185.8438; train_masked_gp_l1_reg_loss: 653.0242; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1060497.0000; train_global_loss: 27826418.8889; train_optim_loss: 27826418.8889; val_kl_reg_loss: 35890.9609; val_edge_recon_loss: 26614944.0000; val_gene_expr_recon_loss: 298172.9375; val_masked_gp_l1_reg_loss: 667.4413; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1061914.6250; val_global_loss: 28011588.0000; val_optim_loss: 28011588.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9608; val_auprc_score: 0.9459; val_best_acc_score: 0.9111; val_best_f1_score: 0.9155; train_kl_reg_loss: 36468.8277; train_edge_recon_loss: 26386738.0000; train_gene_expr_recon_loss: 298606.5243; train_masked_gp_l1_reg_loss: 671.6726; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1052167.0278; train_global_loss: 27774651.5556; train_optim_loss: 27774651.5556; val_kl_reg_loss: 35841.1406; val_edge_recon_loss: 26500660.0000; val_gene_expr_recon_loss: 292934.3750; val_masked_gp_l1_reg_loss: 685.6422; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1059962.3750; val_global_loss: 27890084.0000; val_optim_loss: 27890084.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9588; val_auprc_score: 0.9396; val_best_acc_score: 0.9122; val_best_f1_score: 0.9153; train_kl_reg_loss: 36018.1584; train_edge_recon_loss: 26488958.4444; train_gene_expr_recon_loss: 298959.4062; train_masked_gp_l1_reg_loss: 703.6458; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1060342.2222; train_global_loss: 27884981.5556; train_optim_loss: 27884981.5556; val_kl_reg_loss: 34620.0547; val_edge_recon_loss: 26590830.0000; val_gene_expr_recon_loss: 298287.8750; val_masked_gp_l1_reg_loss: 714.7363; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1061402.8750; val_global_loss: 27985854.0000; val_optim_loss: 27985854.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9635; val_auprc_score: 0.9483; val_best_acc_score: 0.9143; val_best_f1_score: 0.9178; train_kl_reg_loss: 36029.8594; train_edge_recon_loss: 26319080.4444; train_gene_expr_recon_loss: 296654.1111; train_masked_gp_l1_reg_loss: 729.0882; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1058940.0417; train_global_loss: 27711433.5556; train_optim_loss: 27711433.5556; val_kl_reg_loss: 34954.0547; val_edge_recon_loss: 26342434.0000; val_gene_expr_recon_loss: 293183.5938; val_masked_gp_l1_reg_loss: 736.0654; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1057962.6250; val_global_loss: 27729270.0000; val_optim_loss: 27729270.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9594; val_auprc_score: 0.9418; val_best_acc_score: 0.9150; val_best_f1_score: 0.9187; train_kl_reg_loss: 35186.9536; train_edge_recon_loss: 26288684.2222; train_gene_expr_recon_loss: 295727.0903; train_masked_gp_l1_reg_loss: 750.8526; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1056369.5972; train_global_loss: 27676718.4444; train_optim_loss: 27676718.4444; val_kl_reg_loss: 33610.8633; val_edge_recon_loss: 26486662.0000; val_gene_expr_recon_loss: 292812.8750; val_masked_gp_l1_reg_loss: 761.5964; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1056280.6250; val_global_loss: 27870126.0000; val_optim_loss: 27870126.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9646; val_auprc_score: 0.9480; val_best_acc_score: 0.9205; val_best_f1_score: 0.9239; train_kl_reg_loss: 34697.0855; train_edge_recon_loss: 26354447.7778; train_gene_expr_recon_loss: 296259.0312; train_masked_gp_l1_reg_loss: 775.7646; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1060026.7361; train_global_loss: 27746206.8889; train_optim_loss: 27746206.8889; val_kl_reg_loss: 32438.3047; val_edge_recon_loss: 26351958.0000; val_gene_expr_recon_loss: 292918.8438; val_masked_gp_l1_reg_loss: 792.5194; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1057586.1250; val_global_loss: 27735692.0000; val_optim_loss: 27735692.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9671; val_auprc_score: 0.9526; val_best_acc_score: 0.9243; val_best_f1_score: 0.9275; train_kl_reg_loss: 33363.8924; train_edge_recon_loss: 26234716.8889; train_gene_expr_recon_loss: 291873.9583; train_masked_gp_l1_reg_loss: 811.3769; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1050248.5694; train_global_loss: 27611014.4444; train_optim_loss: 27611014.4444; val_kl_reg_loss: 32558.2227; val_edge_recon_loss: 26387062.0000; val_gene_expr_recon_loss: 292506.6562; val_masked_gp_l1_reg_loss: 826.5286; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1055296.1250; val_global_loss: 27768248.0000; val_optim_loss: 27768248.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9685; val_auprc_score: 0.9534; val_best_acc_score: 0.9279; val_best_f1_score: 0.9311; train_kl_reg_loss: 33336.5056; train_edge_recon_loss: 26388564.4444; train_gene_expr_recon_loss: 293010.9028; train_masked_gp_l1_reg_loss: 835.5487; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1052197.0694; train_global_loss: 27767944.6667; train_optim_loss: 27767944.6667; val_kl_reg_loss: 31807.7852; val_edge_recon_loss: 26063182.0000; val_gene_expr_recon_loss: 288572.0312; val_masked_gp_l1_reg_loss: 841.9927; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1053421.6250; val_global_loss: 27437826.0000; val_optim_loss: 27437826.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9665; val_auprc_score: 0.9517; val_best_acc_score: 0.9220; val_best_f1_score: 0.9258; train_kl_reg_loss: 32615.1491; train_edge_recon_loss: 26385105.1111; train_gene_expr_recon_loss: 290049.4826; train_masked_gp_l1_reg_loss: 853.2326; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1050694.8889; train_global_loss: 27759318.4444; train_optim_loss: 27759318.4444; val_kl_reg_loss: 31308.6660; val_edge_recon_loss: 26515642.0000; val_gene_expr_recon_loss: 289211.1562; val_masked_gp_l1_reg_loss: 859.7808; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1050282.2500; val_global_loss: 27887304.0000; val_optim_loss: 27887304.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9683; val_auprc_score: 0.9547; val_best_acc_score: 0.9262; val_best_f1_score: 0.9287; train_kl_reg_loss: 31914.7003; train_edge_recon_loss: 26440335.1111; train_gene_expr_recon_loss: 289606.1493; train_masked_gp_l1_reg_loss: 868.9082; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1044819.6250; train_global_loss: 27807544.8889; train_optim_loss: 27807544.8889; val_kl_reg_loss: 30806.2812; val_edge_recon_loss: 26464558.0000; val_gene_expr_recon_loss: 287013.2188; val_masked_gp_l1_reg_loss: 879.9568; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1051777.1250; val_global_loss: 27835036.0000; val_optim_loss: 27835036.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9680; val_auprc_score: 0.9504; val_best_acc_score: 0.9336; val_best_f1_score: 0.9365; train_kl_reg_loss: 31591.7745; train_edge_recon_loss: 26275457.3333; train_gene_expr_recon_loss: 288463.5694; train_masked_gp_l1_reg_loss: 895.8233; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1046171.1667; train_global_loss: 27642579.5556; train_optim_loss: 27642579.5556; val_kl_reg_loss: 30424.8750; val_edge_recon_loss: 26194128.0000; val_gene_expr_recon_loss: 290741.5938; val_masked_gp_l1_reg_loss: 908.6357; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1051995.3750; val_global_loss: 27568198.0000; val_optim_loss: 27568198.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9664; val_auprc_score: 0.9495; val_best_acc_score: 0.9252; val_best_f1_score: 0.9284; train_kl_reg_loss: 31161.6126; train_edge_recon_loss: 26369017.1111; train_gene_expr_recon_loss: 287709.3194; train_masked_gp_l1_reg_loss: 918.6057; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043289.3125; train_global_loss: 27732096.0000; train_optim_loss: 27732096.0000; val_kl_reg_loss: 30241.0938; val_edge_recon_loss: 26460134.0000; val_gene_expr_recon_loss: 288016.6250; val_masked_gp_l1_reg_loss: 929.3566; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1048924.2500; val_global_loss: 27828246.0000; val_optim_loss: 27828246.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9724; val_auprc_score: 0.9613; val_best_acc_score: 0.9289; val_best_f1_score: 0.9314; train_kl_reg_loss: 30904.2465; train_edge_recon_loss: 26312816.2222; train_gene_expr_recon_loss: 288389.6944; train_masked_gp_l1_reg_loss: 926.5495; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047889.9931; train_global_loss: 27680926.4444; train_optim_loss: 27680926.4444; val_kl_reg_loss: 30190.8633; val_edge_recon_loss: 26212066.0000; val_gene_expr_recon_loss: 285783.5312; val_masked_gp_l1_reg_loss: 921.2435; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1048994.2500; val_global_loss: 27577956.0000; val_optim_loss: 27577956.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9678; val_auprc_score: 0.9531; val_best_acc_score: 0.9272; val_best_f1_score: 0.9303; train_kl_reg_loss: 31172.6682; train_edge_recon_loss: 26290567.1111; train_gene_expr_recon_loss: 286484.7847; train_masked_gp_l1_reg_loss: 919.1858; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1046230.2986; train_global_loss: 27655374.4444; train_optim_loss: 27655374.4444; val_kl_reg_loss: 29857.2109; val_edge_recon_loss: 26297608.0000; val_gene_expr_recon_loss: 286595.9375; val_masked_gp_l1_reg_loss: 917.0483; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1049501.3750; val_global_loss: 27664482.0000; val_optim_loss: 27664482.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9659; val_auprc_score: 0.9470; val_best_acc_score: 0.9252; val_best_f1_score: 0.9289; train_kl_reg_loss: 30566.0326; train_edge_recon_loss: 26265898.8889; train_gene_expr_recon_loss: 287739.5938; train_masked_gp_l1_reg_loss: 915.8085; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1044868.1042; train_global_loss: 27629988.0000; train_optim_loss: 27629988.0000; val_kl_reg_loss: 29974.3730; val_edge_recon_loss: 26565530.0000; val_gene_expr_recon_loss: 286706.9688; val_masked_gp_l1_reg_loss: 914.2469; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1049929.3750; val_global_loss: 27933054.0000; val_optim_loss: 27933054.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9708; val_auprc_score: 0.9585; val_best_acc_score: 0.9318; val_best_f1_score: 0.9348; train_kl_reg_loss: 30827.3503; train_edge_recon_loss: 26268730.2222; train_gene_expr_recon_loss: 287195.6319; train_masked_gp_l1_reg_loss: 913.9609; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043696.1111; train_global_loss: 27631363.5556; train_optim_loss: 27631363.5556; val_kl_reg_loss: 29867.9062; val_edge_recon_loss: 26296228.0000; val_gene_expr_recon_loss: 286175.1562; val_masked_gp_l1_reg_loss: 913.1949; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1048201.8125; val_global_loss: 27661388.0000; val_optim_loss: 27661388.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 38 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9654
Val AUPRC score: 0.9498
Val best accuracy score: 0.9254
Val best F1 score: 0.9280
Val gene expr MSE score: 1.0595
Val chrom access MSE score: 0.0909
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
