[True]
Run timestamp: 07082023_183523_43.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_43']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8955; val_auprc_score: 0.9044; val_best_acc_score: 0.5036; val_best_f1_score: 0.6683; train_kl_reg_loss: 6305.1332; train_edge_recon_loss: 35549.5885; train_gene_expr_recon_loss: 637348.6111; train_masked_gp_l1_reg_loss: 16098.8086; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 265522.8229; train_global_loss: 960824.9444; train_optim_loss: 960824.9444; val_kl_reg_loss: 11023.7314; val_edge_recon_loss: 40653.6484; val_gene_expr_recon_loss: 577161.6875; val_masked_gp_l1_reg_loss: 11350.6689; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 262212.3125; val_global_loss: 902402.0625; val_optim_loss: 902402.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8898; val_auprc_score: 0.8928; val_best_acc_score: 0.5108; val_best_f1_score: 0.6714; train_kl_reg_loss: 16498.0482; train_edge_recon_loss: 38284.4284; train_gene_expr_recon_loss: 561829.6458; train_masked_gp_l1_reg_loss: 9694.5001; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 260745.4948; train_global_loss: 887052.1181; train_optim_loss: 887052.1181; val_kl_reg_loss: 16142.7930; val_edge_recon_loss: 40647.1562; val_gene_expr_recon_loss: 522259.8750; val_masked_gp_l1_reg_loss: 8590.0820; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 257366.7031; val_global_loss: 845006.5625; val_optim_loss: 845006.5625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8910; val_auprc_score: 0.8880; val_best_acc_score: 0.5162; val_best_f1_score: 0.6737; train_kl_reg_loss: 21364.0927; train_edge_recon_loss: 38749.4062; train_gene_expr_recon_loss: 513980.7812; train_masked_gp_l1_reg_loss: 8884.9408; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 255323.7448; train_global_loss: 838302.9722; train_optim_loss: 838302.9722; val_kl_reg_loss: 22852.2227; val_edge_recon_loss: 40642.6328; val_gene_expr_recon_loss: 483914.6250; val_masked_gp_l1_reg_loss: 9093.8682; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253024.9688; val_global_loss: 809528.3750; val_optim_loss: 809528.3750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8844; val_auprc_score: 0.8812; val_best_acc_score: 0.5446; val_best_f1_score: 0.6862; train_kl_reg_loss: 22623.5638; train_edge_recon_loss: 38952.7812; train_gene_expr_recon_loss: 485398.0590; train_masked_gp_l1_reg_loss: 8903.1623; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252472.9062; train_global_loss: 808350.4792; train_optim_loss: 808350.4792; val_kl_reg_loss: 22024.4297; val_edge_recon_loss: 40624.1445; val_gene_expr_recon_loss: 465911.9688; val_masked_gp_l1_reg_loss: 8722.7490; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250331.3750; val_global_loss: 787614.6875; val_optim_loss: 787614.6875
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8957; val_auprc_score: 0.8923; val_best_acc_score: 0.5897; val_best_f1_score: 0.7073; train_kl_reg_loss: 22761.4449; train_edge_recon_loss: 38957.8090; train_gene_expr_recon_loss: 469502.9271; train_masked_gp_l1_reg_loss: 8631.1388; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250405.2726; train_global_loss: 790258.5833; train_optim_loss: 790258.5833; val_kl_reg_loss: 21264.9648; val_edge_recon_loss: 40598.7031; val_gene_expr_recon_loss: 454329.0000; val_masked_gp_l1_reg_loss: 8489.6426; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248355.6875; val_global_loss: 773038.0000; val_optim_loss: 773038.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8933; val_auprc_score: 0.8858; val_best_acc_score: 0.6291; val_best_f1_score: 0.7263; train_kl_reg_loss: 22762.9164; train_edge_recon_loss: 38947.2947; train_gene_expr_recon_loss: 455346.1389; train_masked_gp_l1_reg_loss: 8403.9475; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248077.1597; train_global_loss: 773537.4653; train_optim_loss: 773537.4653; val_kl_reg_loss: 21777.0156; val_edge_recon_loss: 40577.8125; val_gene_expr_recon_loss: 444715.7500; val_masked_gp_l1_reg_loss: 8301.0508; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246593.7969; val_global_loss: 761965.4375; val_optim_loss: 761965.4375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8950; val_auprc_score: 0.8881; val_best_acc_score: 0.6869; val_best_f1_score: 0.7570; train_kl_reg_loss: 23114.0764; train_edge_recon_loss: 39001.4006; train_gene_expr_recon_loss: 448076.8229; train_masked_gp_l1_reg_loss: 8240.8024; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245780.8455; train_global_loss: 764213.9514; train_optim_loss: 764213.9514; val_kl_reg_loss: 22626.5254; val_edge_recon_loss: 40538.3516; val_gene_expr_recon_loss: 436740.0000; val_masked_gp_l1_reg_loss: 8171.2871; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244919.7969; val_global_loss: 752995.9375; val_optim_loss: 752995.9375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8960; val_auprc_score: 0.8907; val_best_acc_score: 0.7467; val_best_f1_score: 0.7913; train_kl_reg_loss: 23656.3370; train_edge_recon_loss: 39018.9175; train_gene_expr_recon_loss: 440187.0660; train_masked_gp_l1_reg_loss: 8134.5165; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244103.3767; train_global_loss: 755100.2014; train_optim_loss: 755100.2014; val_kl_reg_loss: 22519.9141; val_edge_recon_loss: 40472.6680; val_gene_expr_recon_loss: 431166.3438; val_masked_gp_l1_reg_loss: 8100.3467; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243676.1406; val_global_loss: 745935.4375; val_optim_loss: 745935.4375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8958; val_auprc_score: 0.8828; val_best_acc_score: 0.7807; val_best_f1_score: 0.8111; train_kl_reg_loss: 23613.2320; train_edge_recon_loss: 38996.6636; train_gene_expr_recon_loss: 435401.9167; train_masked_gp_l1_reg_loss: 8091.1942; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243447.3524; train_global_loss: 749550.3681; train_optim_loss: 749550.3681; val_kl_reg_loss: 23206.6523; val_edge_recon_loss: 40404.2500; val_gene_expr_recon_loss: 425898.5312; val_masked_gp_l1_reg_loss: 8070.9785; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 242390.0156; val_global_loss: 739970.4375; val_optim_loss: 739970.4375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9041; val_auprc_score: 0.8957; val_best_acc_score: 0.8044; val_best_f1_score: 0.8246; train_kl_reg_loss: 23879.8086; train_edge_recon_loss: 38940.4349; train_gene_expr_recon_loss: 432141.7396; train_masked_gp_l1_reg_loss: 8059.8137; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242324.3976; train_global_loss: 745346.2014; train_optim_loss: 745346.2014; val_kl_reg_loss: 22805.2461; val_edge_recon_loss: 40329.2734; val_gene_expr_recon_loss: 422341.7500; val_masked_gp_l1_reg_loss: 8047.3784; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241247.5625; val_global_loss: 734771.2500; val_optim_loss: 734771.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9203; val_auprc_score: 0.9135; val_best_acc_score: 0.8428; val_best_f1_score: 0.8511; train_kl_reg_loss: 23804.1369; train_edge_recon_loss: 38902.4757; train_gene_expr_recon_loss: 428401.6007; train_masked_gp_l1_reg_loss: 8045.2933; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241879.5764; train_global_loss: 741033.0903; train_optim_loss: 741033.0903; val_kl_reg_loss: 22553.0762; val_edge_recon_loss: 40227.5508; val_gene_expr_recon_loss: 419290.6250; val_masked_gp_l1_reg_loss: 8049.2485; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240375.1719; val_global_loss: 730495.6875; val_optim_loss: 730495.6875
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9258; val_auprc_score: 0.9165; val_best_acc_score: 0.8601; val_best_f1_score: 0.8628; train_kl_reg_loss: 23665.1374; train_edge_recon_loss: 38827.4440; train_gene_expr_recon_loss: 425821.0174; train_masked_gp_l1_reg_loss: 8048.3572; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240608.8385; train_global_loss: 736970.7917; train_optim_loss: 736970.7917; val_kl_reg_loss: 22566.3105; val_edge_recon_loss: 40166.2695; val_gene_expr_recon_loss: 416270.0625; val_masked_gp_l1_reg_loss: 8048.1816; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239413.9375; val_global_loss: 726464.7500; val_optim_loss: 726464.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9348; val_auprc_score: 0.9254; val_best_acc_score: 0.8657; val_best_f1_score: 0.8644; train_kl_reg_loss: 23371.7613; train_edge_recon_loss: 38756.7904; train_gene_expr_recon_loss: 421454.6076; train_masked_gp_l1_reg_loss: 8051.2991; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239311.5260; train_global_loss: 730945.9861; train_optim_loss: 730945.9861; val_kl_reg_loss: 22018.9473; val_edge_recon_loss: 40070.0273; val_gene_expr_recon_loss: 414199.0625; val_masked_gp_l1_reg_loss: 8049.1987; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238626.9062; val_global_loss: 722964.1250; val_optim_loss: 722964.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9427; val_auprc_score: 0.9368; val_best_acc_score: 0.8681; val_best_f1_score: 0.8643; train_kl_reg_loss: 23069.4816; train_edge_recon_loss: 38691.7943; train_gene_expr_recon_loss: 418650.8854; train_masked_gp_l1_reg_loss: 8053.6431; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237900.8976; train_global_loss: 726366.6944; train_optim_loss: 726366.6944; val_kl_reg_loss: 21780.7383; val_edge_recon_loss: 39998.5742; val_gene_expr_recon_loss: 412169.2812; val_masked_gp_l1_reg_loss: 8054.1748; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237923.6562; val_global_loss: 719926.4375; val_optim_loss: 719926.4375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9419; val_auprc_score: 0.9321; val_best_acc_score: 0.8616; val_best_f1_score: 0.8555; train_kl_reg_loss: 22855.8633; train_edge_recon_loss: 38625.1228; train_gene_expr_recon_loss: 419398.4583; train_masked_gp_l1_reg_loss: 8067.3282; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237689.2708; train_global_loss: 726636.0486; train_optim_loss: 726636.0486; val_kl_reg_loss: 21171.9492; val_edge_recon_loss: 39912.2812; val_gene_expr_recon_loss: 410776.6250; val_masked_gp_l1_reg_loss: 8075.2271; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237272.4688; val_global_loss: 717208.5000; val_optim_loss: 717208.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9447; val_auprc_score: 0.9345; val_best_acc_score: 0.8623; val_best_f1_score: 0.8541; train_kl_reg_loss: 22578.2201; train_edge_recon_loss: 38561.8207; train_gene_expr_recon_loss: 417709.0833; train_masked_gp_l1_reg_loss: 8088.4839; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 237797.3837; train_global_loss: 724734.9931; train_optim_loss: 724734.9931; val_kl_reg_loss: 21187.2656; val_edge_recon_loss: 39870.1172; val_gene_expr_recon_loss: 408860.1875; val_masked_gp_l1_reg_loss: 8095.0449; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 236513.0156; val_global_loss: 714525.6250; val_optim_loss: 714525.6250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9409; val_auprc_score: 0.9301; val_best_acc_score: 0.8535; val_best_f1_score: 0.8453; train_kl_reg_loss: 22314.4089; train_edge_recon_loss: 38523.7786; train_gene_expr_recon_loss: 414622.6771; train_masked_gp_l1_reg_loss: 8108.6966; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 236899.7674; train_global_loss: 720469.3194; train_optim_loss: 720469.3194; val_kl_reg_loss: 21106.8340; val_edge_recon_loss: 39834.5703; val_gene_expr_recon_loss: 407219.7188; val_masked_gp_l1_reg_loss: 8119.2373; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235756.1250; val_global_loss: 712036.5000; val_optim_loss: 712036.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9496; val_auprc_score: 0.9419; val_best_acc_score: 0.8522; val_best_f1_score: 0.8494; train_kl_reg_loss: 22007.9748; train_edge_recon_loss: 38473.8576; train_gene_expr_recon_loss: 413126.3576; train_masked_gp_l1_reg_loss: 8129.4088; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 235891.9184; train_global_loss: 717629.5208; train_optim_loss: 717629.5208; val_kl_reg_loss: 19868.9199; val_edge_recon_loss: 39718.4414; val_gene_expr_recon_loss: 407212.7188; val_masked_gp_l1_reg_loss: 8138.7588; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 235401.0312; val_global_loss: 710339.8750; val_optim_loss: 710339.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9435; val_auprc_score: 0.9317; val_best_acc_score: 0.8491; val_best_f1_score: 0.8428; train_kl_reg_loss: 21669.5215; train_edge_recon_loss: 38427.3073; train_gene_expr_recon_loss: 411443.1007; train_masked_gp_l1_reg_loss: 8147.6247; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234787.0556; train_global_loss: 714474.6042; train_optim_loss: 714474.6042; val_kl_reg_loss: 20743.9199; val_edge_recon_loss: 39732.1680; val_gene_expr_recon_loss: 404769.7812; val_masked_gp_l1_reg_loss: 8154.6138; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 234484.8125; val_global_loss: 707885.3125; val_optim_loss: 707885.3125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9452; val_auprc_score: 0.9365; val_best_acc_score: 0.8461; val_best_f1_score: 0.8450; train_kl_reg_loss: 21543.7511; train_edge_recon_loss: 38395.2604; train_gene_expr_recon_loss: 411802.6771; train_masked_gp_l1_reg_loss: 8169.1936; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 235095.1215; train_global_loss: 715006.0139; train_optim_loss: 715006.0139; val_kl_reg_loss: 19956.2246; val_edge_recon_loss: 39712.6211; val_gene_expr_recon_loss: 404317.5625; val_masked_gp_l1_reg_loss: 8181.5469; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233966.7031; val_global_loss: 706134.6250; val_optim_loss: 706134.6250
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9511; val_auprc_score: 0.9447; val_best_acc_score: 0.8463; val_best_f1_score: 0.8531; train_kl_reg_loss: 21218.1938; train_edge_recon_loss: 38352.2257; train_gene_expr_recon_loss: 409213.1944; train_masked_gp_l1_reg_loss: 8199.1149; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234561.5955; train_global_loss: 711544.3333; train_optim_loss: 711544.3333; val_kl_reg_loss: 20281.1309; val_edge_recon_loss: 39667.7188; val_gene_expr_recon_loss: 402654.1875; val_masked_gp_l1_reg_loss: 8207.7529; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233287.8125; val_global_loss: 704098.6250; val_optim_loss: 704098.6250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9506; val_auprc_score: 0.9433; val_best_acc_score: 0.8363; val_best_f1_score: 0.8553; train_kl_reg_loss: 21047.8049; train_edge_recon_loss: 38315.5760; train_gene_expr_recon_loss: 408468.6632; train_masked_gp_l1_reg_loss: 8220.4489; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233976.2760; train_global_loss: 710028.7708; train_optim_loss: 710028.7708; val_kl_reg_loss: 19139.5879; val_edge_recon_loss: 39611.4844; val_gene_expr_recon_loss: 402723.9062; val_masked_gp_l1_reg_loss: 8233.7100; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232930.7656; val_global_loss: 702639.4375; val_optim_loss: 702639.4375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9534; val_auprc_score: 0.9460; val_best_acc_score: 0.8418; val_best_f1_score: 0.8611; train_kl_reg_loss: 20695.8001; train_edge_recon_loss: 38291.1120; train_gene_expr_recon_loss: 407771.9375; train_masked_gp_l1_reg_loss: 8242.9132; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233647.1944; train_global_loss: 708648.9653; train_optim_loss: 708648.9653; val_kl_reg_loss: 19931.1230; val_edge_recon_loss: 39613.9102; val_gene_expr_recon_loss: 400754.9062; val_masked_gp_l1_reg_loss: 8253.9736; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232176.0938; val_global_loss: 700730.0000; val_optim_loss: 700730.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9558; val_auprc_score: 0.9512; val_best_acc_score: 0.8469; val_best_f1_score: 0.8645; train_kl_reg_loss: 20488.6000; train_edge_recon_loss: 38248.8681; train_gene_expr_recon_loss: 403577.7778; train_masked_gp_l1_reg_loss: 8263.7372; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 230860.2899; train_global_loss: 701439.2847; train_optim_loss: 701439.2847; val_kl_reg_loss: 18696.5137; val_edge_recon_loss: 39534.9219; val_gene_expr_recon_loss: 401061.5625; val_masked_gp_l1_reg_loss: 8269.5596; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231913.7969; val_global_loss: 699476.3750; val_optim_loss: 699476.3750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9559; val_auprc_score: 0.9485; val_best_acc_score: 0.8558; val_best_f1_score: 0.8713; train_kl_reg_loss: 20208.5104; train_edge_recon_loss: 38213.5655; train_gene_expr_recon_loss: 403724.2500; train_masked_gp_l1_reg_loss: 8279.2017; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 231031.1302; train_global_loss: 701456.6667; train_optim_loss: 701456.6667; val_kl_reg_loss: 18795.9609; val_edge_recon_loss: 39490.4375; val_gene_expr_recon_loss: 399937.4375; val_masked_gp_l1_reg_loss: 8285.4053; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 231292.2344; val_global_loss: 697801.5000; val_optim_loss: 697801.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9535; val_auprc_score: 0.9463; val_best_acc_score: 0.8892; val_best_f1_score: 0.8931; train_kl_reg_loss: 19691.7530; train_edge_recon_loss: 39984.2682; train_gene_expr_recon_loss: 415634.4688; train_masked_gp_l1_reg_loss: 8294.6146; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234967.7326; train_global_loss: 718572.8264; train_optim_loss: 718572.8264; val_kl_reg_loss: 17082.6094; val_edge_recon_loss: 40274.3828; val_gene_expr_recon_loss: 407489.7500; val_masked_gp_l1_reg_loss: 8290.4150; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233854.2031; val_global_loss: 706991.3750; val_optim_loss: 706991.3750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9545; val_auprc_score: 0.9459; val_best_acc_score: 0.8859; val_best_f1_score: 0.8893; train_kl_reg_loss: 18449.6997; train_edge_recon_loss: 40070.3355; train_gene_expr_recon_loss: 414810.4757; train_masked_gp_l1_reg_loss: 8287.2869; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234691.1024; train_global_loss: 716308.9028; train_optim_loss: 716308.9028; val_kl_reg_loss: 16886.2852; val_edge_recon_loss: 40227.5430; val_gene_expr_recon_loss: 405939.4688; val_masked_gp_l1_reg_loss: 8271.9912; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233587.3750; val_global_loss: 704912.6875; val_optim_loss: 704912.6875
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9551; val_auprc_score: 0.9478; val_best_acc_score: 0.8882; val_best_f1_score: 0.8882; train_kl_reg_loss: 17729.6571; train_edge_recon_loss: 39981.1293; train_gene_expr_recon_loss: 412939.7569; train_masked_gp_l1_reg_loss: 8258.8443; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234507.9896; train_global_loss: 713417.3819; train_optim_loss: 713417.3819; val_kl_reg_loss: 15229.9521; val_edge_recon_loss: 40097.6602; val_gene_expr_recon_loss: 406701.6875; val_masked_gp_l1_reg_loss: 8235.7920; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233500.3906; val_global_loss: 703765.5000; val_optim_loss: 703765.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9568; val_auprc_score: 0.9492; val_best_acc_score: 0.8872; val_best_f1_score: 0.8855; train_kl_reg_loss: 17146.2433; train_edge_recon_loss: 39885.7418; train_gene_expr_recon_loss: 414266.0451; train_masked_gp_l1_reg_loss: 8227.7551; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 234037.6684; train_global_loss: 713563.4444; train_optim_loss: 713563.4444; val_kl_reg_loss: 15616.2793; val_edge_recon_loss: 40034.5664; val_gene_expr_recon_loss: 405345.2812; val_masked_gp_l1_reg_loss: 8212.3936; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 233005.2812; val_global_loss: 702213.8125; val_optim_loss: 702213.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9546; val_auprc_score: 0.9491; val_best_acc_score: 0.8844; val_best_f1_score: 0.8830; train_kl_reg_loss: 17042.5421; train_edge_recon_loss: 39850.8594; train_gene_expr_recon_loss: 411763.3889; train_masked_gp_l1_reg_loss: 8133.5884; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 232484.3125; train_global_loss: 709274.6944; train_optim_loss: 709274.6944; val_kl_reg_loss: 15802.1475; val_edge_recon_loss: 40041.7188; val_gene_expr_recon_loss: 404998.9688; val_masked_gp_l1_reg_loss: 8068.0811; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232941.4062; val_global_loss: 701852.3750; val_optim_loss: 701852.3750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9593; val_auprc_score: 0.9551; val_best_acc_score: 0.8897; val_best_f1_score: 0.8876; train_kl_reg_loss: 16968.7389; train_edge_recon_loss: 39851.7140; train_gene_expr_recon_loss: 409391.7708; train_masked_gp_l1_reg_loss: 8050.5464; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233211.8229; train_global_loss: 707474.6042; train_optim_loss: 707474.6042; val_kl_reg_loss: 15891.7227; val_edge_recon_loss: 40041.2539; val_gene_expr_recon_loss: 404730.6562; val_masked_gp_l1_reg_loss: 8023.2222; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232901.8750; val_global_loss: 701588.7500; val_optim_loss: 701588.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9528; val_auprc_score: 0.9468; val_best_acc_score: 0.8833; val_best_f1_score: 0.8816; train_kl_reg_loss: 17018.1873; train_edge_recon_loss: 39848.6923; train_gene_expr_recon_loss: 410516.5938; train_masked_gp_l1_reg_loss: 8009.9418; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233037.6736; train_global_loss: 708431.0764; train_optim_loss: 708431.0764; val_kl_reg_loss: 15734.9355; val_edge_recon_loss: 40049.3281; val_gene_expr_recon_loss: 404778.6250; val_masked_gp_l1_reg_loss: 7994.9502; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232885.7969; val_global_loss: 701443.6250; val_optim_loss: 701443.6250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9586; val_auprc_score: 0.9526; val_best_acc_score: 0.8866; val_best_f1_score: 0.8843; train_kl_reg_loss: 16931.3620; train_edge_recon_loss: 39849.6150; train_gene_expr_recon_loss: 410766.9931; train_masked_gp_l1_reg_loss: 7986.9027; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 233731.1615; train_global_loss: 709266.0417; train_optim_loss: 709266.0417; val_kl_reg_loss: 15839.8496; val_edge_recon_loss: 40023.0664; val_gene_expr_recon_loss: 404563.5625; val_masked_gp_l1_reg_loss: 7977.9146; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 232881.2500; val_global_loss: 701285.6250; val_optim_loss: 701285.6250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 23 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9537
val AUPRC score: 0.9448
val best accuracy score: 0.8840
val best F1 score: 0.8840
val target rna MSE score: 0.4251
val source rna MSE score: 0.2068
val target atac MSE score: 0.1343
val source atac MSE score: 0.0191
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
