[True]
Run timestamp: 07092023_160647_43.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_43']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2376 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5103, n_cat_covariates_embed_input: 0, n_hidden: 2313, n_latent: 2213, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2376
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2376

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7600; val_auprc_score: 0.7795; val_best_acc_score: 0.5257; val_best_f1_score: 0.6765; train_kl_reg_loss: 84845.7242; train_edge_recon_loss: 3542859.3702; train_gene_expr_recon_loss: 12727447.5344; train_masked_gp_l1_reg_loss: 114635.3758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3154869.0432; train_chrom_access_recon_loss: 10683008.0992; train_global_loss: 30307665.1908; train_optim_loss: 30307665.1908; val_kl_reg_loss: 109434.6812; val_edge_recon_loss: 4063544.9000; val_gene_expr_recon_loss: 11856048.6667; val_masked_gp_l1_reg_loss: 101625.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 252879.3750; val_chrom_access_recon_loss: 10302174.0667; val_global_loss: 26685706.4000; val_optim_loss: 26685706.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8477; val_auprc_score: 0.8527; val_best_acc_score: 0.7657; val_best_f1_score: 0.7718; train_kl_reg_loss: 101471.3195; train_edge_recon_loss: 3522620.3092; train_gene_expr_recon_loss: 11818627.3053; train_masked_gp_l1_reg_loss: 101865.3422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158455.8629; train_chrom_access_recon_loss: 10253224.4580; train_global_loss: 25956264.5496; train_optim_loss: 25956264.5496; val_kl_reg_loss: 96957.8000; val_edge_recon_loss: 4023560.3000; val_gene_expr_recon_loss: 11674671.4667; val_masked_gp_l1_reg_loss: 103906.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119039.2734; val_chrom_access_recon_loss: 10170761.9333; val_global_loss: 26188896.5333; val_optim_loss: 26188896.5333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8851; val_auprc_score: 0.8752; val_best_acc_score: 0.8034; val_best_f1_score: 0.8153; train_kl_reg_loss: 78560.5849; train_edge_recon_loss: 3372257.0649; train_gene_expr_recon_loss: 11663682.1221; train_masked_gp_l1_reg_loss: 109545.2503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106902.4629; train_chrom_access_recon_loss: 10111273.2672; train_global_loss: 25442220.7786; train_optim_loss: 25442220.7786; val_kl_reg_loss: 86943.1755; val_edge_recon_loss: 3023504.0000; val_gene_expr_recon_loss: 11606823.0000; val_masked_gp_l1_reg_loss: 119891.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99753.2109; val_chrom_access_recon_loss: 10121468.0667; val_global_loss: 25058382.1333; val_optim_loss: 25058382.1333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9119; val_auprc_score: 0.8944; val_best_acc_score: 0.8417; val_best_f1_score: 0.8535; train_kl_reg_loss: 104188.0672; train_edge_recon_loss: 2934551.6718; train_gene_expr_recon_loss: 11531986.5267; train_masked_gp_l1_reg_loss: 122452.1030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93383.4815; train_chrom_access_recon_loss: 9985178.3206; train_global_loss: 24771740.1985; train_optim_loss: 24771740.1985; val_kl_reg_loss: 105463.5297; val_edge_recon_loss: 2895498.1000; val_gene_expr_recon_loss: 11425814.9333; val_masked_gp_l1_reg_loss: 124106.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88940.9766; val_chrom_access_recon_loss: 9967963.9333; val_global_loss: 24607787.6000; val_optim_loss: 24607787.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9265; val_auprc_score: 0.9132; val_best_acc_score: 0.8568; val_best_f1_score: 0.8642; train_kl_reg_loss: 112394.9328; train_edge_recon_loss: 2858208.9198; train_gene_expr_recon_loss: 11410379.2824; train_masked_gp_l1_reg_loss: 125989.3794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86343.2179; train_chrom_access_recon_loss: 9892939.7634; train_global_loss: 24486255.4046; train_optim_loss: 24486255.4046; val_kl_reg_loss: 113597.7073; val_edge_recon_loss: 2852068.5833; val_gene_expr_recon_loss: 11355677.6667; val_masked_gp_l1_reg_loss: 128386.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84795.6250; val_chrom_access_recon_loss: 9870527.2667; val_global_loss: 24405053.4667; val_optim_loss: 24405053.4667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9285; val_auprc_score: 0.9120; val_best_acc_score: 0.8638; val_best_f1_score: 0.8728; train_kl_reg_loss: 111558.5688; train_edge_recon_loss: 2830086.3721; train_gene_expr_recon_loss: 11294538.2443; train_masked_gp_l1_reg_loss: 129977.3352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83838.7077; train_chrom_access_recon_loss: 9787902.6107; train_global_loss: 24237901.9084; train_optim_loss: 24237901.9084; val_kl_reg_loss: 107579.8260; val_edge_recon_loss: 2840409.7000; val_gene_expr_recon_loss: 11262055.4000; val_masked_gp_l1_reg_loss: 131990.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82864.9922; val_chrom_access_recon_loss: 9819656.1333; val_global_loss: 24244556.2667; val_optim_loss: 24244556.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9353; val_auprc_score: 0.9209; val_best_acc_score: 0.8748; val_best_f1_score: 0.8807; train_kl_reg_loss: 112147.9969; train_edge_recon_loss: 2808721.4676; train_gene_expr_recon_loss: 11216901.4351; train_masked_gp_l1_reg_loss: 133260.2054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81911.1224; train_chrom_access_recon_loss: 9722002.6947; train_global_loss: 24074944.8855; train_optim_loss: 24074944.8855; val_kl_reg_loss: 107803.0521; val_edge_recon_loss: 2835175.8167; val_gene_expr_recon_loss: 11114279.8667; val_masked_gp_l1_reg_loss: 134245.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81457.9766; val_chrom_access_recon_loss: 9665275.6000; val_global_loss: 23938238.4000; val_optim_loss: 23938238.4000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9362; val_auprc_score: 0.9183; val_best_acc_score: 0.8755; val_best_f1_score: 0.8824; train_kl_reg_loss: 107460.4948; train_edge_recon_loss: 2799509.2576; train_gene_expr_recon_loss: 11134647.6260; train_masked_gp_l1_reg_loss: 135863.8795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80821.6262; train_chrom_access_recon_loss: 9648828.9847; train_global_loss: 23907131.8321; train_optim_loss: 23907131.8321; val_kl_reg_loss: 98460.4187; val_edge_recon_loss: 2835083.8167; val_gene_expr_recon_loss: 11056196.3333; val_masked_gp_l1_reg_loss: 136635.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80395.0234; val_chrom_access_recon_loss: 9590715.5333; val_global_loss: 23797487.3333; val_optim_loss: 23797487.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9431; val_auprc_score: 0.9301; val_best_acc_score: 0.8818; val_best_f1_score: 0.8879; train_kl_reg_loss: 104143.0286; train_edge_recon_loss: 2795350.5000; train_gene_expr_recon_loss: 11062093.4427; train_masked_gp_l1_reg_loss: 138230.1648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79812.2281; train_chrom_access_recon_loss: 9577599.4885; train_global_loss: 23757228.8550; train_optim_loss: 23757228.8550; val_kl_reg_loss: 106081.2677; val_edge_recon_loss: 2804070.2833; val_gene_expr_recon_loss: 11016957.8000; val_masked_gp_l1_reg_loss: 139564.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79902.0000; val_chrom_access_recon_loss: 9564221.3333; val_global_loss: 23710797.6000; val_optim_loss: 23710797.6000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9464; val_auprc_score: 0.9336; val_best_acc_score: 0.8860; val_best_f1_score: 0.8903; train_kl_reg_loss: 104431.3802; train_edge_recon_loss: 2788242.0382; train_gene_expr_recon_loss: 10998755.4962; train_masked_gp_l1_reg_loss: 140185.1885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79570.8222; train_chrom_access_recon_loss: 9519853.8626; train_global_loss: 23631038.7023; train_optim_loss: 23631038.7023; val_kl_reg_loss: 102648.1359; val_edge_recon_loss: 2793003.0833; val_gene_expr_recon_loss: 10969167.6000; val_masked_gp_l1_reg_loss: 141387.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79194.9609; val_chrom_access_recon_loss: 9518139.6000; val_global_loss: 23603541.0667; val_optim_loss: 23603541.0667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9492; val_auprc_score: 0.9384; val_best_acc_score: 0.8864; val_best_f1_score: 0.8914; train_kl_reg_loss: 103761.4807; train_edge_recon_loss: 2761492.5363; train_gene_expr_recon_loss: 10947974.8092; train_masked_gp_l1_reg_loss: 141911.9561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79252.3851; train_chrom_access_recon_loss: 9474290.4198; train_global_loss: 23508683.4656; train_optim_loss: 23508683.4656; val_kl_reg_loss: 99490.0724; val_edge_recon_loss: 2790173.9167; val_gene_expr_recon_loss: 10891470.4667; val_masked_gp_l1_reg_loss: 143022.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79366.0234; val_chrom_access_recon_loss: 9468362.6667; val_global_loss: 23471884.9333; val_optim_loss: 23471884.9333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9484; val_auprc_score: 0.9313; val_best_acc_score: 0.8886; val_best_f1_score: 0.8938; train_kl_reg_loss: 102254.5203; train_edge_recon_loss: 2755043.9427; train_gene_expr_recon_loss: 10897690.9771; train_masked_gp_l1_reg_loss: 143464.8865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79207.5430; train_chrom_access_recon_loss: 9431640.2824; train_global_loss: 23409302.3359; train_optim_loss: 23409302.3359; val_kl_reg_loss: 104170.1266; val_edge_recon_loss: 2775150.2333; val_gene_expr_recon_loss: 10888738.4000; val_masked_gp_l1_reg_loss: 144304.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79005.3750; val_chrom_access_recon_loss: 9463445.2000; val_global_loss: 23454814.2667; val_optim_loss: 23454814.2667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9529; val_auprc_score: 0.9394; val_best_acc_score: 0.8930; val_best_f1_score: 0.8992; train_kl_reg_loss: 102925.2105; train_edge_recon_loss: 2744784.1221; train_gene_expr_recon_loss: 10847206.1603; train_masked_gp_l1_reg_loss: 144463.7708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79008.9685; train_chrom_access_recon_loss: 9380936.5649; train_global_loss: 23299324.9160; train_optim_loss: 23299324.9160; val_kl_reg_loss: 101682.9599; val_edge_recon_loss: 2736966.2667; val_gene_expr_recon_loss: 10799318.4000; val_masked_gp_l1_reg_loss: 144933.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78923.3906; val_chrom_access_recon_loss: 9367791.7333; val_global_loss: 23229615.7333; val_optim_loss: 23229615.7333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9571; val_auprc_score: 0.9459; val_best_acc_score: 0.8950; val_best_f1_score: 0.8986; train_kl_reg_loss: 102214.3742; train_edge_recon_loss: 2736094.2977; train_gene_expr_recon_loss: 10800787.4046; train_masked_gp_l1_reg_loss: 145403.9055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78735.6533; train_chrom_access_recon_loss: 9328773.0153; train_global_loss: 23192008.6718; train_optim_loss: 23192008.6718; val_kl_reg_loss: 103134.2208; val_edge_recon_loss: 2756982.0500; val_gene_expr_recon_loss: 10768956.1333; val_masked_gp_l1_reg_loss: 145909.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78701.0859; val_chrom_access_recon_loss: 9365164.0000; val_global_loss: 23218847.7333; val_optim_loss: 23218847.7333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9551; val_auprc_score: 0.9417; val_best_acc_score: 0.8954; val_best_f1_score: 0.8997; train_kl_reg_loss: 100432.5601; train_edge_recon_loss: 2743109.4618; train_gene_expr_recon_loss: 10762658.0763; train_masked_gp_l1_reg_loss: 146047.3123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78808.2985; train_chrom_access_recon_loss: 9289789.0458; train_global_loss: 23120844.7023; train_optim_loss: 23120844.7023; val_kl_reg_loss: 99518.9807; val_edge_recon_loss: 2740112.2333; val_gene_expr_recon_loss: 10675891.6667; val_masked_gp_l1_reg_loss: 146641.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79415.9141; val_chrom_access_recon_loss: 9268295.2000; val_global_loss: 23009875.2000; val_optim_loss: 23009875.2000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9554; val_auprc_score: 0.9403; val_best_acc_score: 0.8980; val_best_f1_score: 0.9026; train_kl_reg_loss: 100497.3551; train_edge_recon_loss: 2729910.9447; train_gene_expr_recon_loss: 10724554.1069; train_masked_gp_l1_reg_loss: 146805.3714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79044.8978; train_chrom_access_recon_loss: 9248959.9427; train_global_loss: 23029772.5344; train_optim_loss: 23029772.5344; val_kl_reg_loss: 102520.6146; val_edge_recon_loss: 2762671.8500; val_gene_expr_recon_loss: 10687555.3333; val_masked_gp_l1_reg_loss: 146972.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79657.3672; val_chrom_access_recon_loss: 9254453.5333; val_global_loss: 23033830.4000; val_optim_loss: 23033830.4000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9594; val_auprc_score: 0.9489; val_best_acc_score: 0.9020; val_best_f1_score: 0.9068; train_kl_reg_loss: 100084.0583; train_edge_recon_loss: 2727969.0267; train_gene_expr_recon_loss: 10694458.1221; train_masked_gp_l1_reg_loss: 147242.7316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79529.5443; train_chrom_access_recon_loss: 9220318.7405; train_global_loss: 22969602.1527; train_optim_loss: 22969602.1527; val_kl_reg_loss: 100192.3693; val_edge_recon_loss: 2737794.3333; val_gene_expr_recon_loss: 10660764.4000; val_masked_gp_l1_reg_loss: 147551.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80304.8438; val_chrom_access_recon_loss: 9260612.3333; val_global_loss: 22987220.6667; val_optim_loss: 22987220.6667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9624; val_auprc_score: 0.9513; val_best_acc_score: 0.9062; val_best_f1_score: 0.9100; train_kl_reg_loss: 99243.1571; train_edge_recon_loss: 2719279.3302; train_gene_expr_recon_loss: 10663140.0229; train_masked_gp_l1_reg_loss: 147738.5443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80561.1954; train_chrom_access_recon_loss: 9181174.0076; train_global_loss: 22891136.2443; train_optim_loss: 22891136.2443; val_kl_reg_loss: 100430.3349; val_edge_recon_loss: 2751708.5833; val_gene_expr_recon_loss: 10607840.4667; val_masked_gp_l1_reg_loss: 147818.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80865.0703; val_chrom_access_recon_loss: 9195192.9333; val_global_loss: 22883856.4000; val_optim_loss: 22883856.4000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9670; val_auprc_score: 0.9594; val_best_acc_score: 0.9111; val_best_f1_score: 0.9146; train_kl_reg_loss: 99673.9385; train_edge_recon_loss: 2719964.5095; train_gene_expr_recon_loss: 10636432.7481; train_masked_gp_l1_reg_loss: 148134.5061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81614.3839; train_chrom_access_recon_loss: 9154858.1298; train_global_loss: 22840678.2443; train_optim_loss: 22840678.2443; val_kl_reg_loss: 101019.9089; val_edge_recon_loss: 2727014.8833; val_gene_expr_recon_loss: 10592162.4667; val_masked_gp_l1_reg_loss: 148140.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81657.0234; val_chrom_access_recon_loss: 9138464.5333; val_global_loss: 22788459.7333; val_optim_loss: 22788459.7333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9647; val_auprc_score: 0.9553; val_best_acc_score: 0.9139; val_best_f1_score: 0.9179; train_kl_reg_loss: 99182.4737; train_edge_recon_loss: 2715788.4905; train_gene_expr_recon_loss: 10610489.3740; train_masked_gp_l1_reg_loss: 148282.9703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82231.0604; train_chrom_access_recon_loss: 9121877.9466; train_global_loss: 22777852.2748; train_optim_loss: 22777852.2748; val_kl_reg_loss: 99599.9010; val_edge_recon_loss: 2727726.8833; val_gene_expr_recon_loss: 10557936.2667; val_masked_gp_l1_reg_loss: 148340.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82247.1797; val_chrom_access_recon_loss: 9160465.5333; val_global_loss: 22776315.6000; val_optim_loss: 22776315.6000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9654; val_auprc_score: 0.9528; val_best_acc_score: 0.9143; val_best_f1_score: 0.9185; train_kl_reg_loss: 99121.5744; train_edge_recon_loss: 2718770.8092; train_gene_expr_recon_loss: 10589090.2137; train_masked_gp_l1_reg_loss: 148545.7548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82476.9478; train_chrom_access_recon_loss: 9097955.7366; train_global_loss: 22735960.9924; train_optim_loss: 22735960.9924; val_kl_reg_loss: 100644.9161; val_edge_recon_loss: 2732517.0500; val_gene_expr_recon_loss: 10556363.2667; val_masked_gp_l1_reg_loss: 148722.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82597.1953; val_chrom_access_recon_loss: 9169656.7333; val_global_loss: 22790500.6667; val_optim_loss: 22790500.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9707; val_auprc_score: 0.9640; val_best_acc_score: 0.9205; val_best_f1_score: 0.9230; train_kl_reg_loss: 98769.2833; train_edge_recon_loss: 2716867.6527; train_gene_expr_recon_loss: 10562834.0611; train_masked_gp_l1_reg_loss: 148830.2085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82771.2687; train_chrom_access_recon_loss: 9062564.3626; train_global_loss: 22672636.7939; train_optim_loss: 22672636.7939; val_kl_reg_loss: 97783.3344; val_edge_recon_loss: 2725820.8000; val_gene_expr_recon_loss: 10579110.4000; val_masked_gp_l1_reg_loss: 148667.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81986.0234; val_chrom_access_recon_loss: 9174773.6000; val_global_loss: 22808141.0667; val_optim_loss: 22808141.0667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9710; val_auprc_score: 0.9631; val_best_acc_score: 0.9229; val_best_f1_score: 0.9253; train_kl_reg_loss: 98970.3126; train_edge_recon_loss: 2708821.2004; train_gene_expr_recon_loss: 10542836.3511; train_masked_gp_l1_reg_loss: 148875.8000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82842.8754; train_chrom_access_recon_loss: 9034511.2710; train_global_loss: 22616857.8473; train_optim_loss: 22616857.8473; val_kl_reg_loss: 102131.5797; val_edge_recon_loss: 2715068.3167; val_gene_expr_recon_loss: 10493486.6000; val_masked_gp_l1_reg_loss: 148739.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82304.9922; val_chrom_access_recon_loss: 9053483.9333; val_global_loss: 22595215.6000; val_optim_loss: 22595215.6000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9703; val_auprc_score: 0.9595; val_best_acc_score: 0.9197; val_best_f1_score: 0.9239; train_kl_reg_loss: 98930.5823; train_edge_recon_loss: 2707949.4637; train_gene_expr_recon_loss: 10521443.0611; train_masked_gp_l1_reg_loss: 148715.9592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82684.3268; train_chrom_access_recon_loss: 9011528.9122; train_global_loss: 22571252.3206; train_optim_loss: 22571252.3206; val_kl_reg_loss: 99187.0797; val_edge_recon_loss: 2718196.8167; val_gene_expr_recon_loss: 10546337.0000; val_masked_gp_l1_reg_loss: 148741.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82505.8750; val_chrom_access_recon_loss: 9063194.4667; val_global_loss: 22658163.2000; val_optim_loss: 22658163.2000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9722; val_auprc_score: 0.9657; val_best_acc_score: 0.9217; val_best_f1_score: 0.9237; train_kl_reg_loss: 98115.9773; train_edge_recon_loss: 2713413.1431; train_gene_expr_recon_loss: 10502865.9237; train_masked_gp_l1_reg_loss: 148664.6682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82668.1701; train_chrom_access_recon_loss: 8984978.1908; train_global_loss: 22530706.1374; train_optim_loss: 22530706.1374; val_kl_reg_loss: 97072.2995; val_edge_recon_loss: 2719587.4667; val_gene_expr_recon_loss: 10471519.5333; val_masked_gp_l1_reg_loss: 148709.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82846.4062; val_chrom_access_recon_loss: 9048444.0000; val_global_loss: 22568179.3333; val_optim_loss: 22568179.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9762; val_auprc_score: 0.9687; val_best_acc_score: 0.9282; val_best_f1_score: 0.9306; train_kl_reg_loss: 103109.6350; train_edge_recon_loss: 2735160.9141; train_gene_expr_recon_loss: 10171302.7863; train_masked_gp_l1_reg_loss: 146520.2984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81113.3503; train_chrom_access_recon_loss: 8773463.0420; train_global_loss: 22010669.8931; train_optim_loss: 22010669.8931; val_kl_reg_loss: 70871.9078; val_edge_recon_loss: 2712474.0167; val_gene_expr_recon_loss: 10138484.4000; val_masked_gp_l1_reg_loss: 146146.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81980.7656; val_chrom_access_recon_loss: 8785732.8667; val_global_loss: 21935690.0000; val_optim_loss: 21935690.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9740; val_auprc_score: 0.9639; val_best_acc_score: 0.9247; val_best_f1_score: 0.9274; train_kl_reg_loss: 100009.6447; train_edge_recon_loss: 2719653.8569; train_gene_expr_recon_loss: 10137220.3740; train_masked_gp_l1_reg_loss: 146018.2089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81874.9453; train_chrom_access_recon_loss: 8739659.6450; train_global_loss: 21924436.6565; train_optim_loss: 21924436.6565; val_kl_reg_loss: 77593.8948; val_edge_recon_loss: 2724659.5167; val_gene_expr_recon_loss: 10111443.4667; val_masked_gp_l1_reg_loss: 145581.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81730.4375; val_chrom_access_recon_loss: 8750321.2000; val_global_loss: 21891328.8000; val_optim_loss: 21891328.8000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9761; val_auprc_score: 0.9685; val_best_acc_score: 0.9287; val_best_f1_score: 0.9311; train_kl_reg_loss: 95992.7248; train_edge_recon_loss: 2706053.3340; train_gene_expr_recon_loss: 10107281.3511; train_masked_gp_l1_reg_loss: 145178.2493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81889.1891; train_chrom_access_recon_loss: 8697494.2519; train_global_loss: 21833889.0534; train_optim_loss: 21833889.0534; val_kl_reg_loss: 81308.7026; val_edge_recon_loss: 2709205.4667; val_gene_expr_recon_loss: 10089290.9333; val_masked_gp_l1_reg_loss: 144918.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81206.4062; val_chrom_access_recon_loss: 8708428.1667; val_global_loss: 21814356.9333; val_optim_loss: 21814356.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9754; val_auprc_score: 0.9686; val_best_acc_score: 0.9289; val_best_f1_score: 0.9312; train_kl_reg_loss: 93574.6899; train_edge_recon_loss: 2708853.2748; train_gene_expr_recon_loss: 10101884.0000; train_masked_gp_l1_reg_loss: 144409.8536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81586.7941; train_chrom_access_recon_loss: 8699004.5267; train_global_loss: 21829313.0992; train_optim_loss: 21829313.0992; val_kl_reg_loss: 81942.9146; val_edge_recon_loss: 2710838.5667; val_gene_expr_recon_loss: 10055421.0667; val_masked_gp_l1_reg_loss: 143779.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81298.6641; val_chrom_access_recon_loss: 8711296.7000; val_global_loss: 21784577.2000; val_optim_loss: 21784577.2000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9767; val_auprc_score: 0.9685; val_best_acc_score: 0.9270; val_best_f1_score: 0.9293; train_kl_reg_loss: 92802.2980; train_edge_recon_loss: 2701903.9618; train_gene_expr_recon_loss: 10084280.0534; train_masked_gp_l1_reg_loss: 143431.5349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81308.1276; train_chrom_access_recon_loss: 8678661.8206; train_global_loss: 21782387.8168; train_optim_loss: 21782387.8168; val_kl_reg_loss: 83170.9885; val_edge_recon_loss: 2701242.1000; val_gene_expr_recon_loss: 10080202.4000; val_masked_gp_l1_reg_loss: 143154.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81452.2266; val_chrom_access_recon_loss: 8683531.1333; val_global_loss: 21772753.3333; val_optim_loss: 21772753.3333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9677; val_auprc_score: 0.9579; val_best_acc_score: 0.9143; val_best_f1_score: 0.9166; train_kl_reg_loss: 586230.2393; train_edge_recon_loss: 2739430.9122; train_gene_expr_recon_loss: 10168897.1069; train_masked_gp_l1_reg_loss: 141929.0200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80273.8531; train_chrom_access_recon_loss: 8750238.5038; train_global_loss: 22466999.6947; train_optim_loss: 22466999.6947; val_kl_reg_loss: 84915.5818; val_edge_recon_loss: 2750415.5333; val_gene_expr_recon_loss: 10093831.3333; val_masked_gp_l1_reg_loss: 137555.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75073.7891; val_chrom_access_recon_loss: 8715933.6000; val_global_loss: 21857725.8667; val_optim_loss: 21857725.8667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9658; val_auprc_score: 0.9527; val_best_acc_score: 0.9171; val_best_f1_score: 0.9197; train_kl_reg_loss: 95575.2077; train_edge_recon_loss: 2727725.5286; train_gene_expr_recon_loss: 10076119.0534; train_masked_gp_l1_reg_loss: 136570.2502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75932.6804; train_chrom_access_recon_loss: 8662743.8130; train_global_loss: 21774666.5496; train_optim_loss: 21774666.5496; val_kl_reg_loss: 91793.2344; val_edge_recon_loss: 2724563.9333; val_gene_expr_recon_loss: 10038757.9333; val_masked_gp_l1_reg_loss: 136368.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77222.8203; val_chrom_access_recon_loss: 8710501.9333; val_global_loss: 21779209.3333; val_optim_loss: 21779209.3333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9722; val_auprc_score: 0.9643; val_best_acc_score: 0.9208; val_best_f1_score: 0.9237; train_kl_reg_loss: 95747.5408; train_edge_recon_loss: 2710440.4103; train_gene_expr_recon_loss: 10046341.5115; train_masked_gp_l1_reg_loss: 136190.8347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77658.9548; train_chrom_access_recon_loss: 8641624.9008; train_global_loss: 21708004.0763; train_optim_loss: 21708004.0763; val_kl_reg_loss: 86548.4964; val_edge_recon_loss: 2728109.7667; val_gene_expr_recon_loss: 9999316.4667; val_masked_gp_l1_reg_loss: 136140.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78482.6484; val_chrom_access_recon_loss: 8605435.5667; val_global_loss: 21634034.2667; val_optim_loss: 21634034.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9733; val_auprc_score: 0.9656; val_best_acc_score: 0.9241; val_best_f1_score: 0.9255; train_kl_reg_loss: 91805.2443; train_edge_recon_loss: 2712417.8073; train_gene_expr_recon_loss: 10029623.3817; train_masked_gp_l1_reg_loss: 136224.5117; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78732.2758; train_chrom_access_recon_loss: 8627425.9427; train_global_loss: 21676229.1908; train_optim_loss: 21676229.1908; val_kl_reg_loss: 87378.8453; val_edge_recon_loss: 2734277.8333; val_gene_expr_recon_loss: 9996840.7333; val_masked_gp_l1_reg_loss: 136471.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79003.7656; val_chrom_access_recon_loss: 8634212.4333; val_global_loss: 21668184.9333; val_optim_loss: 21668184.9333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9737; val_auprc_score: 0.9646; val_best_acc_score: 0.9256; val_best_f1_score: 0.9272; train_kl_reg_loss: 91887.4238; train_edge_recon_loss: 2701694.8626; train_gene_expr_recon_loss: 10018740.9771; train_masked_gp_l1_reg_loss: 136404.8535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79582.3901; train_chrom_access_recon_loss: 8624794.8664; train_global_loss: 21653105.3130; train_optim_loss: 21653105.3130; val_kl_reg_loss: 87109.8099; val_edge_recon_loss: 2704132.5500; val_gene_expr_recon_loss: 9989927.1333; val_masked_gp_l1_reg_loss: 136433.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79326.8906; val_chrom_access_recon_loss: 8636290.8667; val_global_loss: 21633221.4667; val_optim_loss: 21633221.4667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9792; val_auprc_score: 0.9747; val_best_acc_score: 0.9330; val_best_f1_score: 0.9346; train_kl_reg_loss: 91320.9263; train_edge_recon_loss: 2696299.8397; train_gene_expr_recon_loss: 10000858.6565; train_masked_gp_l1_reg_loss: 136177.4134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79795.1762; train_chrom_access_recon_loss: 8612316.5038; train_global_loss: 21616768.4885; train_optim_loss: 21616768.4885; val_kl_reg_loss: 87780.9885; val_edge_recon_loss: 2709310.6667; val_gene_expr_recon_loss: 9946092.4000; val_masked_gp_l1_reg_loss: 136162.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80085.5000; val_chrom_access_recon_loss: 8588270.0667; val_global_loss: 21547702.5333; val_optim_loss: 21547702.5333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9744; val_auprc_score: 0.9648; val_best_acc_score: 0.9305; val_best_f1_score: 0.9329; train_kl_reg_loss: 90278.1636; train_edge_recon_loss: 2705356.1031; train_gene_expr_recon_loss: 9981357.1374; train_masked_gp_l1_reg_loss: 136105.3975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80027.3719; train_chrom_access_recon_loss: 8592031.6489; train_global_loss: 21585155.9237; train_optim_loss: 21585155.9237; val_kl_reg_loss: 85842.9984; val_edge_recon_loss: 2689157.4667; val_gene_expr_recon_loss: 10020552.6000; val_masked_gp_l1_reg_loss: 136190.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80839.5625; val_chrom_access_recon_loss: 8643891.3000; val_global_loss: 21656475.2000; val_optim_loss: 21656475.2000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9766; val_auprc_score: 0.9691; val_best_acc_score: 0.9303; val_best_f1_score: 0.9323; train_kl_reg_loss: 90027.5067; train_edge_recon_loss: 2705139.7634; train_gene_expr_recon_loss: 9974728.6641; train_masked_gp_l1_reg_loss: 136077.7666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80116.0678; train_chrom_access_recon_loss: 8580701.2824; train_global_loss: 21566791.0687; train_optim_loss: 21566791.0687; val_kl_reg_loss: 85963.6307; val_edge_recon_loss: 2716066.8667; val_gene_expr_recon_loss: 9954518.9333; val_masked_gp_l1_reg_loss: 135592.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79392.9844; val_chrom_access_recon_loss: 8651939.4667; val_global_loss: 21623474.0000; val_optim_loss: 21623474.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9786; val_auprc_score: 0.9721; val_best_acc_score: 0.9356; val_best_f1_score: 0.9373; train_kl_reg_loss: 90138.2131; train_edge_recon_loss: 2701569.4504; train_gene_expr_recon_loss: 9968883.6794; train_masked_gp_l1_reg_loss: 135742.2087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80036.0023; train_chrom_access_recon_loss: 8580692.5115; train_global_loss: 21557061.9695; train_optim_loss: 21557061.9695; val_kl_reg_loss: 85918.2870; val_edge_recon_loss: 2690110.5500; val_gene_expr_recon_loss: 9966757.9333; val_masked_gp_l1_reg_loss: 135430.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79577.3750; val_chrom_access_recon_loss: 8611627.7333; val_global_loss: 21569422.4000; val_optim_loss: 21569422.4000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9773; val_auprc_score: 0.9704; val_best_acc_score: 0.9291; val_best_f1_score: 0.9312; train_kl_reg_loss: 89282.4458; train_edge_recon_loss: 2703320.2309; train_gene_expr_recon_loss: 9968377.3817; train_masked_gp_l1_reg_loss: 135575.9250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80009.1365; train_chrom_access_recon_loss: 8574430.4160; train_global_loss: 21550995.4962; train_optim_loss: 21550995.4962; val_kl_reg_loss: 87199.3182; val_edge_recon_loss: 2710002.0667; val_gene_expr_recon_loss: 9952128.8667; val_masked_gp_l1_reg_loss: 135655.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80531.3438; val_chrom_access_recon_loss: 8628621.3667; val_global_loss: 21594138.5333; val_optim_loss: 21594138.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9770; val_auprc_score: 0.9693; val_best_acc_score: 0.9338; val_best_f1_score: 0.9357; train_kl_reg_loss: 89182.9480; train_edge_recon_loss: 2699314.4885; train_gene_expr_recon_loss: 9948092.5038; train_masked_gp_l1_reg_loss: 133017.3826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61397.7747; train_chrom_access_recon_loss: 8552176.3473; train_global_loss: 21483181.4656; train_optim_loss: 21483181.4656; val_kl_reg_loss: 87140.5458; val_edge_recon_loss: 2704853.5333; val_gene_expr_recon_loss: 9941010.3333; val_masked_gp_l1_reg_loss: 132343.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59271.5469; val_chrom_access_recon_loss: 8570635.6333; val_global_loss: 21495255.0667; val_optim_loss: 21495255.0667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9784; val_auprc_score: 0.9717; val_best_acc_score: 0.9356; val_best_f1_score: 0.9374; train_kl_reg_loss: 90097.7801; train_edge_recon_loss: 2694997.3893; train_gene_expr_recon_loss: 9954703.2290; train_masked_gp_l1_reg_loss: 132191.8756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59088.9387; train_chrom_access_recon_loss: 8562659.7634; train_global_loss: 21493739.0534; train_optim_loss: 21493739.0534; val_kl_reg_loss: 88033.4208; val_edge_recon_loss: 2715611.0667; val_gene_expr_recon_loss: 9917640.8667; val_masked_gp_l1_reg_loss: 132058.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58830.5781; val_chrom_access_recon_loss: 8526373.8000; val_global_loss: 21438548.9333; val_optim_loss: 21438548.9333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9785; val_auprc_score: 0.9723; val_best_acc_score: 0.9316; val_best_f1_score: 0.9335; train_kl_reg_loss: 90606.1928; train_edge_recon_loss: 2693990.2099; train_gene_expr_recon_loss: 9948677.6870; train_masked_gp_l1_reg_loss: 131999.4779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58654.1690; train_chrom_access_recon_loss: 8558221.1870; train_global_loss: 21482148.8244; train_optim_loss: 21482148.8244; val_kl_reg_loss: 88492.9312; val_edge_recon_loss: 2706052.7333; val_gene_expr_recon_loss: 9939340.3333; val_masked_gp_l1_reg_loss: 131938.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58539.5781; val_chrom_access_recon_loss: 8631880.5667; val_global_loss: 21556245.6000; val_optim_loss: 21556245.6000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9803; val_auprc_score: 0.9759; val_best_acc_score: 0.9352; val_best_f1_score: 0.9370; train_kl_reg_loss: 91053.4838; train_edge_recon_loss: 2694875.9160; train_gene_expr_recon_loss: 9947394.3740; train_masked_gp_l1_reg_loss: 131870.2700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58466.5590; train_chrom_access_recon_loss: 8552962.2634; train_global_loss: 21476622.8397; train_optim_loss: 21476622.8397; val_kl_reg_loss: 88693.5797; val_edge_recon_loss: 2699845.0000; val_gene_expr_recon_loss: 9873023.2667; val_masked_gp_l1_reg_loss: 131843.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58338.5703; val_chrom_access_recon_loss: 8511272.2333; val_global_loss: 21363017.0667; val_optim_loss: 21363017.0667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9800; val_auprc_score: 0.9756; val_best_acc_score: 0.9355; val_best_f1_score: 0.9373; train_kl_reg_loss: 91273.7643; train_edge_recon_loss: 2698813.2137; train_gene_expr_recon_loss: 9943154.1069; train_masked_gp_l1_reg_loss: 131800.9603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58234.3584; train_chrom_access_recon_loss: 8555867.2328; train_global_loss: 21479143.6489; train_optim_loss: 21479143.6489; val_kl_reg_loss: 89627.7995; val_edge_recon_loss: 2693995.3500; val_gene_expr_recon_loss: 9966849.9333; val_masked_gp_l1_reg_loss: 131732.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57990.9609; val_chrom_access_recon_loss: 8656208.5667; val_global_loss: 21596405.8667; val_optim_loss: 21596405.8667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9793; val_auprc_score: 0.9726; val_best_acc_score: 0.9325; val_best_f1_score: 0.9344; train_kl_reg_loss: 91651.2558; train_edge_recon_loss: 2695200.9447; train_gene_expr_recon_loss: 9945668.5038; train_masked_gp_l1_reg_loss: 131701.1430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58012.9730; train_chrom_access_recon_loss: 8557115.9427; train_global_loss: 21479350.7328; train_optim_loss: 21479350.7328; val_kl_reg_loss: 89641.8042; val_edge_recon_loss: 2712918.6667; val_gene_expr_recon_loss: 9916851.4667; val_masked_gp_l1_reg_loss: 131665.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57934.8516; val_chrom_access_recon_loss: 8565784.1667; val_global_loss: 21474795.8667; val_optim_loss: 21474795.8667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9810; val_auprc_score: 0.9761; val_best_acc_score: 0.9376; val_best_f1_score: 0.9392; train_kl_reg_loss: 91829.1576; train_edge_recon_loss: 2696090.5630; train_gene_expr_recon_loss: 9939231.7405; train_masked_gp_l1_reg_loss: 131615.4443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57819.3248; train_chrom_access_recon_loss: 8550505.6985; train_global_loss: 21467091.9389; train_optim_loss: 21467091.9389; val_kl_reg_loss: 89767.9703; val_edge_recon_loss: 2701741.4167; val_gene_expr_recon_loss: 9916148.9333; val_masked_gp_l1_reg_loss: 131578.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57690.0312; val_chrom_access_recon_loss: 8597282.9000; val_global_loss: 21494209.3333; val_optim_loss: 21494209.3333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9801; val_auprc_score: 0.9747; val_best_acc_score: 0.9375; val_best_f1_score: 0.9394; train_kl_reg_loss: 91760.1203; train_edge_recon_loss: 2693801.6622; train_gene_expr_recon_loss: 9942261.6260; train_masked_gp_l1_reg_loss: 131531.1818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57667.7264; train_chrom_access_recon_loss: 8561282.1718; train_global_loss: 21478304.3206; train_optim_loss: 21478304.3206; val_kl_reg_loss: 90383.7495; val_edge_recon_loss: 2688685.3667; val_gene_expr_recon_loss: 9933052.8667; val_masked_gp_l1_reg_loss: 131477.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57453.7578; val_chrom_access_recon_loss: 8611276.5000; val_global_loss: 21512330.2667; val_optim_loss: 21512330.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9775; val_auprc_score: 0.9731; val_best_acc_score: 0.9302; val_best_f1_score: 0.9323; train_kl_reg_loss: 91691.6595; train_edge_recon_loss: 2697608.1985; train_gene_expr_recon_loss: 9943790.0076; train_masked_gp_l1_reg_loss: 131196.2437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55465.4027; train_chrom_access_recon_loss: 8552774.7939; train_global_loss: 21472526.3206; train_optim_loss: 21472526.3206; val_kl_reg_loss: 89702.6297; val_edge_recon_loss: 2706701.4167; val_gene_expr_recon_loss: 9959560.2000; val_masked_gp_l1_reg_loss: 131106.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55253.2188; val_chrom_access_recon_loss: 8603894.3667; val_global_loss: 21546217.6000; val_optim_loss: 21546217.6000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9801; val_auprc_score: 0.9744; val_best_acc_score: 0.9348; val_best_f1_score: 0.9367; train_kl_reg_loss: 91772.2217; train_edge_recon_loss: 2693841.2901; train_gene_expr_recon_loss: 9944363.8702; train_masked_gp_l1_reg_loss: 131079.0593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55221.1983; train_chrom_access_recon_loss: 8554486.5344; train_global_loss: 21470764.2595; train_optim_loss: 21470764.2595; val_kl_reg_loss: 89481.2349; val_edge_recon_loss: 2704162.4333; val_gene_expr_recon_loss: 9918279.0000; val_masked_gp_l1_reg_loss: 131055.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55197.0391; val_chrom_access_recon_loss: 8583164.1667; val_global_loss: 21481340.1333; val_optim_loss: 21481340.1333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9793; val_auprc_score: 0.9753; val_best_acc_score: 0.9309; val_best_f1_score: 0.9331; train_kl_reg_loss: 91791.8451; train_edge_recon_loss: 2694140.8931; train_gene_expr_recon_loss: 9939390.9160; train_masked_gp_l1_reg_loss: 131043.5778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55191.1376; train_chrom_access_recon_loss: 8549508.7290; train_global_loss: 21461067.0992; train_optim_loss: 21461067.0992; val_kl_reg_loss: 90035.1443; val_edge_recon_loss: 2714326.4000; val_gene_expr_recon_loss: 9946123.9333; val_masked_gp_l1_reg_loss: 131029.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55167.9492; val_chrom_access_recon_loss: 8575161.3667; val_global_loss: 21511843.8667; val_optim_loss: 21511843.8667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9785; val_auprc_score: 0.9719; val_best_acc_score: 0.9313; val_best_f1_score: 0.9338; train_kl_reg_loss: 91618.1030; train_edge_recon_loss: 2690087.7347; train_gene_expr_recon_loss: 9939622.8321; train_masked_gp_l1_reg_loss: 131021.4305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55152.3232; train_chrom_access_recon_loss: 8546845.8893; train_global_loss: 21454348.3511; train_optim_loss: 21454348.3511; val_kl_reg_loss: 89993.6823; val_edge_recon_loss: 2712289.1833; val_gene_expr_recon_loss: 9947802.7333; val_masked_gp_l1_reg_loss: 131013.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55127.1367; val_chrom_access_recon_loss: 8585834.6333; val_global_loss: 21522060.2667; val_optim_loss: 21522060.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 60 min 39 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9782
val AUPRC score: 0.9711
val best accuracy score: 0.9340
val best F1 score: 0.9361
val target rna MSE score: 1.3563
val source rna MSE score: 0.3872
val target atac MSE score: 0.3393
val source atac MSE score: 0.0560
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
