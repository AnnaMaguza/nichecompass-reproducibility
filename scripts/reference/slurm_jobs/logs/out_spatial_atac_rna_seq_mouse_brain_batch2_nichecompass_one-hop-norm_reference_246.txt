[True]
Run timestamp: 07092023_025854_246.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_246']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2863 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 6459, n_cat_covariates_embed_input: 0, n_hidden: 2392, n_latent: 2292, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2863
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2863

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6220; val_auprc_score: 0.6231; val_best_acc_score: 0.5003; val_best_f1_score: 0.6667; train_kl_reg_loss: 47715.2056; train_edge_recon_loss: 3558296.9659; train_gene_expr_recon_loss: 14928890.1818; train_masked_gp_l1_reg_loss: 42867.7624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7550746.4091; train_chrom_access_recon_loss: 12488929.1364; train_global_loss: 38617445.8485; train_optim_loss: 38617445.8485; val_kl_reg_loss: 100664.2451; val_edge_recon_loss: 4065463.9688; val_gene_expr_recon_loss: 13522829.6250; val_masked_gp_l1_reg_loss: 41480.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2618189.2500; val_chrom_access_recon_loss: 11956619.2500; val_global_loss: 32305247.2500; val_optim_loss: 32305247.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6710; val_auprc_score: 0.6456; val_best_acc_score: 0.5328; val_best_f1_score: 0.6769; train_kl_reg_loss: 97768.8231; train_edge_recon_loss: 3551369.5227; train_gene_expr_recon_loss: 13390336.2121; train_masked_gp_l1_reg_loss: 39193.1088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 956176.2391; train_chrom_access_recon_loss: 11879465.5758; train_global_loss: 29914309.3030; train_optim_loss: 29914309.3030; val_kl_reg_loss: 109577.4756; val_edge_recon_loss: 4063109.9688; val_gene_expr_recon_loss: 12989925.1250; val_masked_gp_l1_reg_loss: 37726.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 344156.3750; val_chrom_access_recon_loss: 11724482.0000; val_global_loss: 29268976.5000; val_optim_loss: 29268976.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6873; val_auprc_score: 0.6691; val_best_acc_score: 0.5642; val_best_f1_score: 0.6877; train_kl_reg_loss: 105354.7865; train_edge_recon_loss: 3529440.2462; train_gene_expr_recon_loss: 13027339.5303; train_masked_gp_l1_reg_loss: 36745.1866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 258941.3056; train_chrom_access_recon_loss: 11733828.3636; train_global_loss: 28691649.3333; train_optim_loss: 28691649.3333; val_kl_reg_loss: 103486.7266; val_edge_recon_loss: 4061155.0312; val_gene_expr_recon_loss: 12876380.7500; val_masked_gp_l1_reg_loss: 36290.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 208621.8281; val_chrom_access_recon_loss: 11663227.7500; val_global_loss: 28949162.2500; val_optim_loss: 28949162.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7789; val_auprc_score: 0.7592; val_best_acc_score: 0.6854; val_best_f1_score: 0.7282; train_kl_reg_loss: 99345.5855; train_edge_recon_loss: 3519111.2273; train_gene_expr_recon_loss: 12887297.4091; train_masked_gp_l1_reg_loss: 36598.7905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 187037.2259; train_chrom_access_recon_loss: 11638060.1818; train_global_loss: 28367450.5152; train_optim_loss: 28367450.5152; val_kl_reg_loss: 101009.6855; val_edge_recon_loss: 4004032.3750; val_gene_expr_recon_loss: 12671300.1250; val_masked_gp_l1_reg_loss: 37478.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171727.7656; val_chrom_access_recon_loss: 11507217.0000; val_global_loss: 28492764.7500; val_optim_loss: 28492764.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8303; val_auprc_score: 0.7988; val_best_acc_score: 0.7534; val_best_f1_score: 0.7895; train_kl_reg_loss: 80754.6976; train_edge_recon_loss: 3439910.6780; train_gene_expr_recon_loss: 12793229.5000; train_masked_gp_l1_reg_loss: 38712.3263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159785.4067; train_chrom_access_recon_loss: 11568230.9848; train_global_loss: 28080623.4545; train_optim_loss: 28080623.4545; val_kl_reg_loss: 66892.2192; val_edge_recon_loss: 3274340.6562; val_gene_expr_recon_loss: 12679540.6250; val_masked_gp_l1_reg_loss: 40195.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151081.1562; val_chrom_access_recon_loss: 11585661.3750; val_global_loss: 27797711.0000; val_optim_loss: 27797711.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8354; val_auprc_score: 0.8066; val_best_acc_score: 0.7501; val_best_f1_score: 0.7981; train_kl_reg_loss: 88312.6799; train_edge_recon_loss: 3068104.8295; train_gene_expr_recon_loss: 12737878.4545; train_masked_gp_l1_reg_loss: 41754.9258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146395.8187; train_chrom_access_recon_loss: 11498524.9848; train_global_loss: 27580971.6970; train_optim_loss: 27580971.6970; val_kl_reg_loss: 113189.7617; val_edge_recon_loss: 2956568.1250; val_gene_expr_recon_loss: 12574667.7500; val_masked_gp_l1_reg_loss: 42752.2383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139753.9062; val_chrom_access_recon_loss: 11529519.6250; val_global_loss: 27356451.0000; val_optim_loss: 27356451.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8372; val_auprc_score: 0.7934; val_best_acc_score: 0.7636; val_best_f1_score: 0.7929; train_kl_reg_loss: 111216.9033; train_edge_recon_loss: 2999676.1705; train_gene_expr_recon_loss: 12658406.1061; train_masked_gp_l1_reg_loss: 43323.4998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133009.2908; train_chrom_access_recon_loss: 11445547.8030; train_global_loss: 27391179.6970; train_optim_loss: 27391179.6970; val_kl_reg_loss: 111014.8477; val_edge_recon_loss: 2986202.2188; val_gene_expr_recon_loss: 12473429.0000; val_masked_gp_l1_reg_loss: 44189.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128259.4922; val_chrom_access_recon_loss: 11366071.1250; val_global_loss: 27109165.5000; val_optim_loss: 27109165.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8480; val_auprc_score: 0.8099; val_best_acc_score: 0.7681; val_best_f1_score: 0.7948; train_kl_reg_loss: 111005.0143; train_edge_recon_loss: 2962123.7538; train_gene_expr_recon_loss: 12596914.6970; train_masked_gp_l1_reg_loss: 44892.4960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124214.5265; train_chrom_access_recon_loss: 11382324.3485; train_global_loss: 27221474.9394; train_optim_loss: 27221474.9394; val_kl_reg_loss: 112385.4990; val_edge_recon_loss: 2962989.0312; val_gene_expr_recon_loss: 12360813.8750; val_masked_gp_l1_reg_loss: 45668.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120880.0234; val_chrom_access_recon_loss: 11245727.8750; val_global_loss: 26848465.0000; val_optim_loss: 26848465.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8672; val_auprc_score: 0.8390; val_best_acc_score: 0.7867; val_best_f1_score: 0.8067; train_kl_reg_loss: 109244.2717; train_edge_recon_loss: 2935694.0152; train_gene_expr_recon_loss: 12530223.7424; train_masked_gp_l1_reg_loss: 46432.8941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118081.3754; train_chrom_access_recon_loss: 11322788.4848; train_global_loss: 27062464.9091; train_optim_loss: 27062464.9091; val_kl_reg_loss: 104680.4512; val_edge_recon_loss: 2923473.5000; val_gene_expr_recon_loss: 12378385.6250; val_masked_gp_l1_reg_loss: 47178.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116143.5078; val_chrom_access_recon_loss: 11328942.6250; val_global_loss: 26898804.2500; val_optim_loss: 26898804.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8793; val_auprc_score: 0.8420; val_best_acc_score: 0.8095; val_best_f1_score: 0.8269; train_kl_reg_loss: 105875.2418; train_edge_recon_loss: 2909199.8371; train_gene_expr_recon_loss: 12492825.8636; train_masked_gp_l1_reg_loss: 47826.5381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113811.0039; train_chrom_access_recon_loss: 11291440.8636; train_global_loss: 26960979.2727; train_optim_loss: 26960979.2727; val_kl_reg_loss: 105246.0244; val_edge_recon_loss: 2894786.5625; val_gene_expr_recon_loss: 12388271.1250; val_masked_gp_l1_reg_loss: 48628.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111678.1172; val_chrom_access_recon_loss: 11347182.7500; val_global_loss: 26895793.5000; val_optim_loss: 26895793.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8957; val_auprc_score: 0.8646; val_best_acc_score: 0.8251; val_best_f1_score: 0.8393; train_kl_reg_loss: 105347.6082; train_edge_recon_loss: 2869391.8068; train_gene_expr_recon_loss: 12445777.2424; train_masked_gp_l1_reg_loss: 49152.0109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110677.5244; train_chrom_access_recon_loss: 11250104.5606; train_global_loss: 26830450.7273; train_optim_loss: 26830450.7273; val_kl_reg_loss: 106482.5020; val_edge_recon_loss: 2875048.5938; val_gene_expr_recon_loss: 12311161.6250; val_masked_gp_l1_reg_loss: 49799.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109312.6797; val_chrom_access_recon_loss: 11131783.6250; val_global_loss: 26583589.5000; val_optim_loss: 26583589.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8863; val_auprc_score: 0.8401; val_best_acc_score: 0.8302; val_best_f1_score: 0.8461; train_kl_reg_loss: 106004.3059; train_edge_recon_loss: 2841009.4583; train_gene_expr_recon_loss: 12396037.9242; train_masked_gp_l1_reg_loss: 50295.1787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108483.4141; train_chrom_access_recon_loss: 11195613.3030; train_global_loss: 26697443.5152; train_optim_loss: 26697443.5152; val_kl_reg_loss: 104739.4512; val_edge_recon_loss: 2873355.7500; val_gene_expr_recon_loss: 12347693.7500; val_masked_gp_l1_reg_loss: 50743.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107621.5312; val_chrom_access_recon_loss: 11299739.5000; val_global_loss: 26783895.0000; val_optim_loss: 26783895.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8981; val_auprc_score: 0.8594; val_best_acc_score: 0.8369; val_best_f1_score: 0.8530; train_kl_reg_loss: 104762.6268; train_edge_recon_loss: 2822984.2462; train_gene_expr_recon_loss: 12350696.0455; train_masked_gp_l1_reg_loss: 51293.6706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107491.3426; train_chrom_access_recon_loss: 11151406.4394; train_global_loss: 26588634.5455; train_optim_loss: 26588634.5455; val_kl_reg_loss: 107642.7490; val_edge_recon_loss: 2832027.3438; val_gene_expr_recon_loss: 12142894.7500; val_masked_gp_l1_reg_loss: 51813.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107232.0234; val_chrom_access_recon_loss: 11080594.5000; val_global_loss: 26322204.5000; val_optim_loss: 26322204.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9059; val_auprc_score: 0.8746; val_best_acc_score: 0.8426; val_best_f1_score: 0.8544; train_kl_reg_loss: 104160.8993; train_edge_recon_loss: 2817908.4167; train_gene_expr_recon_loss: 12311283.3636; train_masked_gp_l1_reg_loss: 52226.3813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106345.9199; train_chrom_access_recon_loss: 11126650.4697; train_global_loss: 26518575.5152; train_optim_loss: 26518575.5152; val_kl_reg_loss: 102654.8604; val_edge_recon_loss: 2836374.0938; val_gene_expr_recon_loss: 12115909.0000; val_masked_gp_l1_reg_loss: 52784.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105814.9219; val_chrom_access_recon_loss: 11051181.6250; val_global_loss: 26264719.5000; val_optim_loss: 26264719.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9138; val_auprc_score: 0.8886; val_best_acc_score: 0.8493; val_best_f1_score: 0.8606; train_kl_reg_loss: 102377.2750; train_edge_recon_loss: 2822110.7955; train_gene_expr_recon_loss: 12279349.0152; train_masked_gp_l1_reg_loss: 53193.9106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105377.8194; train_chrom_access_recon_loss: 11101914.1212; train_global_loss: 26464322.9697; train_optim_loss: 26464322.9697; val_kl_reg_loss: 100818.1504; val_edge_recon_loss: 2830824.3438; val_gene_expr_recon_loss: 12066510.5000; val_masked_gp_l1_reg_loss: 53685.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105193.7109; val_chrom_access_recon_loss: 11039616.7500; val_global_loss: 26196648.2500; val_optim_loss: 26196648.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9143; val_auprc_score: 0.8768; val_best_acc_score: 0.8544; val_best_f1_score: 0.8668; train_kl_reg_loss: 101648.8887; train_edge_recon_loss: 2797965.3371; train_gene_expr_recon_loss: 12239800.8788; train_masked_gp_l1_reg_loss: 54154.4508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105063.9857; train_chrom_access_recon_loss: 11052756.4091; train_global_loss: 26351390.0303; train_optim_loss: 26351390.0303; val_kl_reg_loss: 99574.6396; val_edge_recon_loss: 2803880.5938; val_gene_expr_recon_loss: 12140433.2500; val_masked_gp_l1_reg_loss: 54685.9180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105052.5391; val_chrom_access_recon_loss: 11056259.8750; val_global_loss: 26259887.0000; val_optim_loss: 26259887.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9184; val_auprc_score: 0.8916; val_best_acc_score: 0.8587; val_best_f1_score: 0.8673; train_kl_reg_loss: 101502.2725; train_edge_recon_loss: 2783104.8371; train_gene_expr_recon_loss: 12215659.4394; train_masked_gp_l1_reg_loss: 54969.9682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105273.5746; train_chrom_access_recon_loss: 11034262.7879; train_global_loss: 26294772.8182; train_optim_loss: 26294772.8182; val_kl_reg_loss: 101842.9590; val_edge_recon_loss: 2805982.2812; val_gene_expr_recon_loss: 12240975.6250; val_masked_gp_l1_reg_loss: 55357.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105257.2891; val_chrom_access_recon_loss: 11092887.5000; val_global_loss: 26402303.2500; val_optim_loss: 26402303.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9222; val_auprc_score: 0.8944; val_best_acc_score: 0.8657; val_best_f1_score: 0.8750; train_kl_reg_loss: 101217.8451; train_edge_recon_loss: 2775898.2803; train_gene_expr_recon_loss: 12171681.2576; train_masked_gp_l1_reg_loss: 55728.2733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105273.6342; train_chrom_access_recon_loss: 10988361.9242; train_global_loss: 26198161.2727; train_optim_loss: 26198161.2727; val_kl_reg_loss: 100963.4639; val_edge_recon_loss: 2804086.3750; val_gene_expr_recon_loss: 11962756.2500; val_masked_gp_l1_reg_loss: 56089.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105313.2656; val_chrom_access_recon_loss: 10882099.2500; val_global_loss: 25911307.0000; val_optim_loss: 25911307.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9299; val_auprc_score: 0.9020; val_best_acc_score: 0.8692; val_best_f1_score: 0.8771; train_kl_reg_loss: 101150.6532; train_edge_recon_loss: 2755891.9318; train_gene_expr_recon_loss: 12142880.5455; train_masked_gp_l1_reg_loss: 56450.7214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105300.3885; train_chrom_access_recon_loss: 10958357.5152; train_global_loss: 26120031.7879; train_optim_loss: 26120031.7879; val_kl_reg_loss: 98399.7695; val_edge_recon_loss: 2772737.1875; val_gene_expr_recon_loss: 11921877.5000; val_masked_gp_l1_reg_loss: 56903.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105343.6875; val_chrom_access_recon_loss: 10823692.3750; val_global_loss: 25778954.0000; val_optim_loss: 25778954.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9204; val_auprc_score: 0.8872; val_best_acc_score: 0.8616; val_best_f1_score: 0.8712; train_kl_reg_loss: 98470.4607; train_edge_recon_loss: 2768483.3220; train_gene_expr_recon_loss: 12128135.8939; train_masked_gp_l1_reg_loss: 57256.7512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105347.6013; train_chrom_access_recon_loss: 10934572.4848; train_global_loss: 26092266.5455; train_optim_loss: 26092266.5455; val_kl_reg_loss: 94629.6182; val_edge_recon_loss: 2807610.2500; val_gene_expr_recon_loss: 12041136.0000; val_masked_gp_l1_reg_loss: 57656.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106000.7891; val_chrom_access_recon_loss: 11028539.0000; val_global_loss: 26135572.7500; val_optim_loss: 26135572.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9306; val_auprc_score: 0.9042; val_best_acc_score: 0.8705; val_best_f1_score: 0.8790; train_kl_reg_loss: 98423.7034; train_edge_recon_loss: 2757132.3447; train_gene_expr_recon_loss: 12094609.1818; train_masked_gp_l1_reg_loss: 57926.2410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105749.4160; train_chrom_access_recon_loss: 10901996.8939; train_global_loss: 26015837.8182; train_optim_loss: 26015837.8182; val_kl_reg_loss: 99253.0332; val_edge_recon_loss: 2764396.1562; val_gene_expr_recon_loss: 12002041.1250; val_masked_gp_l1_reg_loss: 58248.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105600.0703; val_chrom_access_recon_loss: 10946308.8750; val_global_loss: 25975847.5000; val_optim_loss: 25975847.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9315; val_auprc_score: 0.9038; val_best_acc_score: 0.8721; val_best_f1_score: 0.8810; train_kl_reg_loss: 97539.2435; train_edge_recon_loss: 2745392.6553; train_gene_expr_recon_loss: 12059823.0455; train_masked_gp_l1_reg_loss: 58569.2593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105816.3059; train_chrom_access_recon_loss: 10872387.8333; train_global_loss: 25939528.3030; train_optim_loss: 25939528.3030; val_kl_reg_loss: 94322.7188; val_edge_recon_loss: 2776102.9062; val_gene_expr_recon_loss: 11993123.6250; val_masked_gp_l1_reg_loss: 58857.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105878.6719; val_chrom_access_recon_loss: 10869269.1250; val_global_loss: 25897554.0000; val_optim_loss: 25897554.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9359; val_auprc_score: 0.9149; val_best_acc_score: 0.8783; val_best_f1_score: 0.8864; train_kl_reg_loss: 96767.2002; train_edge_recon_loss: 2745900.6970; train_gene_expr_recon_loss: 12034167.1364; train_masked_gp_l1_reg_loss: 59192.1815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105835.4657; train_chrom_access_recon_loss: 10838552.9091; train_global_loss: 25880415.7273; train_optim_loss: 25880415.7273; val_kl_reg_loss: 95526.9355; val_edge_recon_loss: 2764233.4688; val_gene_expr_recon_loss: 11797023.0000; val_masked_gp_l1_reg_loss: 59509.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106548.6016; val_chrom_access_recon_loss: 10705381.0000; val_global_loss: 25528222.5000; val_optim_loss: 25528222.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9346; val_auprc_score: 0.9099; val_best_acc_score: 0.8775; val_best_f1_score: 0.8868; train_kl_reg_loss: 95672.8195; train_edge_recon_loss: 2752074.8409; train_gene_expr_recon_loss: 12017392.7273; train_masked_gp_l1_reg_loss: 59791.2592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106334.8728; train_chrom_access_recon_loss: 10826699.0909; train_global_loss: 25857965.6667; train_optim_loss: 25857965.6667; val_kl_reg_loss: 94547.5703; val_edge_recon_loss: 2744802.2500; val_gene_expr_recon_loss: 11937762.3750; val_masked_gp_l1_reg_loss: 60124.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106289.1094; val_chrom_access_recon_loss: 10941373.8750; val_global_loss: 25884899.2500; val_optim_loss: 25884899.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9332; val_auprc_score: 0.9040; val_best_acc_score: 0.8759; val_best_f1_score: 0.8830; train_kl_reg_loss: 93817.5410; train_edge_recon_loss: 2750611.1288; train_gene_expr_recon_loss: 12001210.1061; train_masked_gp_l1_reg_loss: 60405.5596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106254.0865; train_chrom_access_recon_loss: 10803423.6667; train_global_loss: 25815721.7879; train_optim_loss: 25815721.7879; val_kl_reg_loss: 96554.7832; val_edge_recon_loss: 2771261.9688; val_gene_expr_recon_loss: 11765440.0000; val_masked_gp_l1_reg_loss: 60754.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106327.5312; val_chrom_access_recon_loss: 10737137.3750; val_global_loss: 25537475.7500; val_optim_loss: 25537475.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9346; val_auprc_score: 0.9100; val_best_acc_score: 0.8783; val_best_f1_score: 0.8857; train_kl_reg_loss: 93913.8788; train_edge_recon_loss: 2737883.8788; train_gene_expr_recon_loss: 11972543.6515; train_masked_gp_l1_reg_loss: 60953.1712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106493.4279; train_chrom_access_recon_loss: 10787150.9242; train_global_loss: 25758939.0000; train_optim_loss: 25758939.0000; val_kl_reg_loss: 92605.6699; val_edge_recon_loss: 2784604.6562; val_gene_expr_recon_loss: 11815373.0000; val_masked_gp_l1_reg_loss: 61226.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106358.1016; val_chrom_access_recon_loss: 10831753.2500; val_global_loss: 25691921.5000; val_optim_loss: 25691921.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9323; val_auprc_score: 0.9029; val_best_acc_score: 0.8772; val_best_f1_score: 0.8844; train_kl_reg_loss: 92475.9875; train_edge_recon_loss: 2728298.4811; train_gene_expr_recon_loss: 11943086.0000; train_masked_gp_l1_reg_loss: 61546.3110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106749.2789; train_chrom_access_recon_loss: 10747284.4242; train_global_loss: 25679440.4242; train_optim_loss: 25679440.4242; val_kl_reg_loss: 94606.0713; val_edge_recon_loss: 2764126.3438; val_gene_expr_recon_loss: 11858536.0000; val_masked_gp_l1_reg_loss: 61885.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107337.1172; val_chrom_access_recon_loss: 10724136.1250; val_global_loss: 25610626.7500; val_optim_loss: 25610626.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9266; val_auprc_score: 0.8918; val_best_acc_score: 0.8702; val_best_f1_score: 0.8788; train_kl_reg_loss: 93932.3308; train_edge_recon_loss: 2744208.0379; train_gene_expr_recon_loss: 11937718.4848; train_masked_gp_l1_reg_loss: 61164.7473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80658.7836; train_chrom_access_recon_loss: 10741285.6970; train_global_loss: 25658968.0909; train_optim_loss: 25658968.0909; val_kl_reg_loss: 94203.5273; val_edge_recon_loss: 2773875.8750; val_gene_expr_recon_loss: 11775971.7500; val_masked_gp_l1_reg_loss: 60733.9961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75761.2656; val_chrom_access_recon_loss: 10780180.5000; val_global_loss: 25560726.5000; val_optim_loss: 25560726.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9379; val_auprc_score: 0.9167; val_best_acc_score: 0.8778; val_best_f1_score: 0.8855; train_kl_reg_loss: 95012.9387; train_edge_recon_loss: 2725338.7273; train_gene_expr_recon_loss: 11926206.0152; train_masked_gp_l1_reg_loss: 60634.2092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75393.0574; train_chrom_access_recon_loss: 10728230.2727; train_global_loss: 25610815.3333; train_optim_loss: 25610815.3333; val_kl_reg_loss: 96312.0498; val_edge_recon_loss: 2778240.0938; val_gene_expr_recon_loss: 11806712.5000; val_masked_gp_l1_reg_loss: 60549.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75145.4688; val_chrom_access_recon_loss: 10771974.2500; val_global_loss: 25588933.5000; val_optim_loss: 25588933.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9361; val_auprc_score: 0.9114; val_best_acc_score: 0.8812; val_best_f1_score: 0.8865; train_kl_reg_loss: 96376.2298; train_edge_recon_loss: 2727288.1553; train_gene_expr_recon_loss: 11926379.3333; train_masked_gp_l1_reg_loss: 60526.9859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74949.3285; train_chrom_access_recon_loss: 10731570.2273; train_global_loss: 25617090.2727; train_optim_loss: 25617090.2727; val_kl_reg_loss: 96877.5859; val_edge_recon_loss: 2776256.5938; val_gene_expr_recon_loss: 11749104.1250; val_masked_gp_l1_reg_loss: 60498.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74751.7578; val_chrom_access_recon_loss: 10648286.2500; val_global_loss: 25405775.5000; val_optim_loss: 25405775.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9367; val_auprc_score: 0.9140; val_best_acc_score: 0.8759; val_best_f1_score: 0.8815; train_kl_reg_loss: 97223.6961; train_edge_recon_loss: 2733265.0833; train_gene_expr_recon_loss: 11925978.0909; train_masked_gp_l1_reg_loss: 60497.0617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74593.3363; train_chrom_access_recon_loss: 10726209.4394; train_global_loss: 25617766.8788; train_optim_loss: 25617766.8788; val_kl_reg_loss: 97379.2051; val_edge_recon_loss: 2791567.5938; val_gene_expr_recon_loss: 11779739.1250; val_masked_gp_l1_reg_loss: 60487.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74424.9844; val_chrom_access_recon_loss: 10660947.5000; val_global_loss: 25464546.2500; val_optim_loss: 25464546.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9375; val_auprc_score: 0.9137; val_best_acc_score: 0.8788; val_best_f1_score: 0.8861; train_kl_reg_loss: 96887.0353; train_edge_recon_loss: 2735449.7424; train_gene_expr_recon_loss: 11915619.8939; train_masked_gp_l1_reg_loss: 60496.1419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74303.3389; train_chrom_access_recon_loss: 10726011.5000; train_global_loss: 25608767.7576; train_optim_loss: 25608767.7576; val_kl_reg_loss: 97468.2744; val_edge_recon_loss: 2745466.1250; val_gene_expr_recon_loss: 11758664.7500; val_masked_gp_l1_reg_loss: 60513.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74209.2109; val_chrom_access_recon_loss: 10672860.8750; val_global_loss: 25409182.0000; val_optim_loss: 25409182.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9394; val_auprc_score: 0.9176; val_best_acc_score: 0.8831; val_best_f1_score: 0.8913; train_kl_reg_loss: 96946.1287; train_edge_recon_loss: 2736443.5530; train_gene_expr_recon_loss: 11915486.8030; train_masked_gp_l1_reg_loss: 60524.5043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74107.6009; train_chrom_access_recon_loss: 10711140.9545; train_global_loss: 25594649.3939; train_optim_loss: 25594649.3939; val_kl_reg_loss: 95957.1494; val_edge_recon_loss: 2767525.4375; val_gene_expr_recon_loss: 11748124.7500; val_masked_gp_l1_reg_loss: 60535.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74013.7969; val_chrom_access_recon_loss: 10711098.6250; val_global_loss: 25457255.5000; val_optim_loss: 25457255.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9370; val_auprc_score: 0.9058; val_best_acc_score: 0.8767; val_best_f1_score: 0.8848; train_kl_reg_loss: 96484.9976; train_edge_recon_loss: 2734901.6098; train_gene_expr_recon_loss: 11915432.6061; train_masked_gp_l1_reg_loss: 60559.9821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73916.6198; train_chrom_access_recon_loss: 10713521.6818; train_global_loss: 25594817.6061; train_optim_loss: 25594817.6061; val_kl_reg_loss: 97604.3789; val_edge_recon_loss: 2747203.5938; val_gene_expr_recon_loss: 11827172.7500; val_masked_gp_l1_reg_loss: 60576.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73839.7500; val_chrom_access_recon_loss: 10734897.1250; val_global_loss: 25541294.0000; val_optim_loss: 25541294.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9440; val_auprc_score: 0.9229; val_best_acc_score: 0.8858; val_best_f1_score: 0.8917; train_kl_reg_loss: 96457.6535; train_edge_recon_loss: 2732222.2500; train_gene_expr_recon_loss: 11922885.4697; train_masked_gp_l1_reg_loss: 60500.7773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71191.6899; train_chrom_access_recon_loss: 10719077.3939; train_global_loss: 25602335.2424; train_optim_loss: 25602335.2424; val_kl_reg_loss: 96338.6523; val_edge_recon_loss: 2752983.7500; val_gene_expr_recon_loss: 11758830.5000; val_masked_gp_l1_reg_loss: 60438.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70704.8906; val_chrom_access_recon_loss: 10727076.2500; val_global_loss: 25466372.0000; val_optim_loss: 25466372.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9382; val_auprc_score: 0.9166; val_best_acc_score: 0.8794; val_best_f1_score: 0.8857; train_kl_reg_loss: 96448.9864; train_edge_recon_loss: 2727886.6136; train_gene_expr_recon_loss: 11920596.3939; train_masked_gp_l1_reg_loss: 60416.5503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70678.9270; train_chrom_access_recon_loss: 10715150.6818; train_global_loss: 25591178.0909; train_optim_loss: 25591178.0909; val_kl_reg_loss: 96557.1914; val_edge_recon_loss: 2769677.8125; val_gene_expr_recon_loss: 11711931.3750; val_masked_gp_l1_reg_loss: 60398.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70662.6875; val_chrom_access_recon_loss: 10653526.6250; val_global_loss: 25362754.5000; val_optim_loss: 25362754.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9345; val_auprc_score: 0.9080; val_best_acc_score: 0.8780; val_best_f1_score: 0.8875; train_kl_reg_loss: 96561.8009; train_edge_recon_loss: 2736651.3977; train_gene_expr_recon_loss: 11911059.5909; train_masked_gp_l1_reg_loss: 60389.6378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70645.0843; train_chrom_access_recon_loss: 10712368.4394; train_global_loss: 25587676.2121; train_optim_loss: 25587676.2121; val_kl_reg_loss: 97105.7354; val_edge_recon_loss: 2736588.8750; val_gene_expr_recon_loss: 11793693.3750; val_masked_gp_l1_reg_loss: 60381.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70629.2422; val_chrom_access_recon_loss: 10773734.5000; val_global_loss: 25532132.5000; val_optim_loss: 25532132.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9378; val_auprc_score: 0.9168; val_best_acc_score: 0.8796; val_best_f1_score: 0.8862; train_kl_reg_loss: 96731.0379; train_edge_recon_loss: 2728376.5758; train_gene_expr_recon_loss: 11918268.1061; train_masked_gp_l1_reg_loss: 60379.2744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70614.1037; train_chrom_access_recon_loss: 10714599.1212; train_global_loss: 25588968.3030; train_optim_loss: 25588968.3030; val_kl_reg_loss: 97540.0156; val_edge_recon_loss: 2756501.5312; val_gene_expr_recon_loss: 11812855.1250; val_masked_gp_l1_reg_loss: 60375.5117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70604.2656; val_chrom_access_recon_loss: 10692815.8750; val_global_loss: 25490692.7500; val_optim_loss: 25490692.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9418; val_auprc_score: 0.9237; val_best_acc_score: 0.8842; val_best_f1_score: 0.8913; train_kl_reg_loss: 96769.4595; train_edge_recon_loss: 2732367.1705; train_gene_expr_recon_loss: 11909313.8485; train_masked_gp_l1_reg_loss: 60376.2874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70594.9691; train_chrom_access_recon_loss: 10703740.8485; train_global_loss: 25573162.4545; train_optim_loss: 25573162.4545; val_kl_reg_loss: 96313.4951; val_edge_recon_loss: 2740190.0938; val_gene_expr_recon_loss: 11776665.6250; val_masked_gp_l1_reg_loss: 60371.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70580.3828; val_chrom_access_recon_loss: 10632134.7500; val_global_loss: 25376255.5000; val_optim_loss: 25376255.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9406; val_auprc_score: 0.9156; val_best_acc_score: 0.8815; val_best_f1_score: 0.8887; train_kl_reg_loss: 96728.7093; train_edge_recon_loss: 2727527.3106; train_gene_expr_recon_loss: 11916354.4242; train_masked_gp_l1_reg_loss: 60373.6307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70573.4769; train_chrom_access_recon_loss: 10712008.9091; train_global_loss: 25583566.2424; train_optim_loss: 25583566.2424; val_kl_reg_loss: 97505.1426; val_edge_recon_loss: 2748132.1562; val_gene_expr_recon_loss: 11940674.5000; val_masked_gp_l1_reg_loss: 60372.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70561.2344; val_chrom_access_recon_loss: 10846522.0000; val_global_loss: 25763767.5000; val_optim_loss: 25763767.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9374; val_auprc_score: 0.9140; val_best_acc_score: 0.8751; val_best_f1_score: 0.8851; train_kl_reg_loss: 96781.4904; train_edge_recon_loss: 2730327.7727; train_gene_expr_recon_loss: 11913518.1818; train_masked_gp_l1_reg_loss: 60366.1209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70295.1570; train_chrom_access_recon_loss: 10704361.2121; train_global_loss: 25575649.9091; train_optim_loss: 25575649.9091; val_kl_reg_loss: 97204.4697; val_edge_recon_loss: 2746772.9688; val_gene_expr_recon_loss: 11649723.8750; val_masked_gp_l1_reg_loss: 60360.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70246.6484; val_chrom_access_recon_loss: 10573016.6250; val_global_loss: 25197326.0000; val_optim_loss: 25197326.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9318; val_auprc_score: 0.9018; val_best_acc_score: 0.8778; val_best_f1_score: 0.8834; train_kl_reg_loss: 96738.4717; train_edge_recon_loss: 2725740.6288; train_gene_expr_recon_loss: 11912290.6818; train_masked_gp_l1_reg_loss: 60358.1680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70243.9992; train_chrom_access_recon_loss: 10704790.5303; train_global_loss: 25570162.4848; train_optim_loss: 25570162.4848; val_kl_reg_loss: 96165.8096; val_edge_recon_loss: 2764206.2188; val_gene_expr_recon_loss: 11751212.3750; val_masked_gp_l1_reg_loss: 60356.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70241.8906; val_chrom_access_recon_loss: 10656106.5000; val_global_loss: 25398289.0000; val_optim_loss: 25398289.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9321; val_auprc_score: 0.9026; val_best_acc_score: 0.8726; val_best_f1_score: 0.8813; train_kl_reg_loss: 96760.5980; train_edge_recon_loss: 2738517.7235; train_gene_expr_recon_loss: 11918802.6515; train_masked_gp_l1_reg_loss: 60354.9914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70240.0091; train_chrom_access_recon_loss: 10712844.2576; train_global_loss: 25597520.1818; train_optim_loss: 25597520.1818; val_kl_reg_loss: 96850.4580; val_edge_recon_loss: 2782713.9688; val_gene_expr_recon_loss: 11820016.1250; val_masked_gp_l1_reg_loss: 60353.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70238.3750; val_chrom_access_recon_loss: 10699034.6250; val_global_loss: 25529207.2500; val_optim_loss: 25529207.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9428; val_auprc_score: 0.9242; val_best_acc_score: 0.8831; val_best_f1_score: 0.8902; train_kl_reg_loss: 96622.3182; train_edge_recon_loss: 2727992.1402; train_gene_expr_recon_loss: 11918081.9848; train_masked_gp_l1_reg_loss: 60353.3543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70237.4715; train_chrom_access_recon_loss: 10717865.9091; train_global_loss: 25591153.2727; train_optim_loss: 25591153.2727; val_kl_reg_loss: 97261.5010; val_edge_recon_loss: 2742067.9688; val_gene_expr_recon_loss: 11763484.6250; val_masked_gp_l1_reg_loss: 60352.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70236.0312; val_chrom_access_recon_loss: 10724507.2500; val_global_loss: 25457909.2500; val_optim_loss: 25457909.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9381; val_auprc_score: 0.9048; val_best_acc_score: 0.8845; val_best_f1_score: 0.8904; train_kl_reg_loss: 96674.6686; train_edge_recon_loss: 2740296.2803; train_gene_expr_recon_loss: 11914503.8182; train_masked_gp_l1_reg_loss: 60352.0764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70234.3801; train_chrom_access_recon_loss: 10713212.8636; train_global_loss: 25595274.1515; train_optim_loss: 25595274.1515; val_kl_reg_loss: 96644.4932; val_edge_recon_loss: 2752470.5000; val_gene_expr_recon_loss: 11809190.2500; val_masked_gp_l1_reg_loss: 60351.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70232.7656; val_chrom_access_recon_loss: 10787546.5000; val_global_loss: 25576435.7500; val_optim_loss: 25576435.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9323; val_auprc_score: 0.9049; val_best_acc_score: 0.8710; val_best_f1_score: 0.8786; train_kl_reg_loss: 96684.3397; train_edge_recon_loss: 2720622.1098; train_gene_expr_recon_loss: 11910916.2273; train_masked_gp_l1_reg_loss: 60350.7379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70206.0346; train_chrom_access_recon_loss: 10708740.1061; train_global_loss: 25567519.5152; train_optim_loss: 25567519.5152; val_kl_reg_loss: 97135.1055; val_edge_recon_loss: 2793251.5625; val_gene_expr_recon_loss: 11760320.0000; val_masked_gp_l1_reg_loss: 60350.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70201.1797; val_chrom_access_recon_loss: 10685249.0000; val_global_loss: 25466507.0000; val_optim_loss: 25466507.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9349; val_auprc_score: 0.9121; val_best_acc_score: 0.8737; val_best_f1_score: 0.8816; train_kl_reg_loss: 96807.4276; train_edge_recon_loss: 2740722.9773; train_gene_expr_recon_loss: 11914110.5606; train_masked_gp_l1_reg_loss: 60349.9236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70200.9654; train_chrom_access_recon_loss: 10707815.8939; train_global_loss: 25590007.7576; train_optim_loss: 25590007.7576; val_kl_reg_loss: 96803.7930; val_edge_recon_loss: 2769404.7188; val_gene_expr_recon_loss: 11774569.3750; val_masked_gp_l1_reg_loss: 60349.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70200.7500; val_chrom_access_recon_loss: 10787691.7500; val_global_loss: 25559020.5000; val_optim_loss: 25559020.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9412; val_auprc_score: 0.9214; val_best_acc_score: 0.8826; val_best_f1_score: 0.8887; train_kl_reg_loss: 96781.6766; train_edge_recon_loss: 2729549.0303; train_gene_expr_recon_loss: 11920003.5909; train_masked_gp_l1_reg_loss: 60349.5742; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70200.5768; train_chrom_access_recon_loss: 10716819.3030; train_global_loss: 25593704.2424; train_optim_loss: 25593704.2424; val_kl_reg_loss: 96827.3857; val_edge_recon_loss: 2732486.2188; val_gene_expr_recon_loss: 11883392.8750; val_masked_gp_l1_reg_loss: 60349.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70200.4609; val_chrom_access_recon_loss: 10772826.3750; val_global_loss: 25616082.0000; val_optim_loss: 25616082.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9394; val_auprc_score: 0.9133; val_best_acc_score: 0.8834; val_best_f1_score: 0.8917; train_kl_reg_loss: 96763.8982; train_edge_recon_loss: 2734789.4621; train_gene_expr_recon_loss: 11925875.7576; train_masked_gp_l1_reg_loss: 60349.3668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70200.2873; train_chrom_access_recon_loss: 10721582.8788; train_global_loss: 25609560.9697; train_optim_loss: 25609560.9697; val_kl_reg_loss: 96791.7822; val_edge_recon_loss: 2739252.2812; val_gene_expr_recon_loss: 11853943.7500; val_masked_gp_l1_reg_loss: 60349.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70200.1484; val_chrom_access_recon_loss: 10750252.6250; val_global_loss: 25570789.5000; val_optim_loss: 25570789.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 26 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9329
val AUPRC score: 0.9081
val best accuracy score: 0.8767
val best F1 score: 0.8864
val target rna MSE score: 1.0328
val source rna MSE score: 0.3988
val target atac MSE score: 0.3266
val source atac MSE score: 0.0715
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
