[True]
Run timestamp: 10082023_190953_50.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_50']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7397; val_auprc_score: 0.7654; val_best_acc_score: 0.5034; val_best_f1_score: 0.6680; train_kl_reg_loss: 97297.9326; train_edge_recon_loss: 3704497.5019; train_gene_expr_recon_loss: 26757733.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6804383.2977; train_global_loss: 37363912.3053; train_optim_loss: 37363912.3053; val_kl_reg_loss: 86743.4318; val_edge_recon_loss: 4064930.1500; val_gene_expr_recon_loss: 23489820.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6439247.4667; val_global_loss: 34080741.3333; val_optim_loss: 34080741.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7616; val_auprc_score: 0.7816; val_best_acc_score: 0.6288; val_best_f1_score: 0.7122; train_kl_reg_loss: 130619.6601; train_edge_recon_loss: 3602481.9905; train_gene_expr_recon_loss: 23440829.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6434383.7977; train_global_loss: 33608315.1145; train_optim_loss: 33608315.1145; val_kl_reg_loss: 148818.0490; val_edge_recon_loss: 4057320.4333; val_gene_expr_recon_loss: 22262857.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6288103.8000; val_global_loss: 32757099.4667; val_optim_loss: 32757099.4667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8258; val_auprc_score: 0.8342; val_best_acc_score: 0.7346; val_best_f1_score: 0.7368; train_kl_reg_loss: 144751.4709; train_edge_recon_loss: 3541122.6832; train_gene_expr_recon_loss: 22280584.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6324307.9237; train_global_loss: 32290766.2443; train_optim_loss: 32290766.2443; val_kl_reg_loss: 134348.1443; val_edge_recon_loss: 3991489.9000; val_gene_expr_recon_loss: 22007088.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6249984.1333; val_global_loss: 32382910.8000; val_optim_loss: 32382910.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8811; val_auprc_score: 0.8738; val_best_acc_score: 0.7960; val_best_f1_score: 0.8075; train_kl_reg_loss: 119158.1617; train_edge_recon_loss: 3465786.5935; train_gene_expr_recon_loss: 22077010.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6295325.4656; train_global_loss: 31957280.6718; train_optim_loss: 31957280.6718; val_kl_reg_loss: 103249.1854; val_edge_recon_loss: 3400314.8667; val_gene_expr_recon_loss: 21839749.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6217869.1000; val_global_loss: 31561182.8000; val_optim_loss: 31561182.8000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8852; val_auprc_score: 0.8729; val_best_acc_score: 0.7982; val_best_f1_score: 0.8086; train_kl_reg_loss: 135368.2536; train_edge_recon_loss: 3087261.2042; train_gene_expr_recon_loss: 21947057.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6261746.9008; train_global_loss: 31431434.3511; train_optim_loss: 31431434.3511; val_kl_reg_loss: 145104.6354; val_edge_recon_loss: 3004048.0667; val_gene_expr_recon_loss: 21760728.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6203502.5333; val_global_loss: 31113384.4000; val_optim_loss: 31113384.4000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8902; val_auprc_score: 0.8769; val_best_acc_score: 0.8044; val_best_f1_score: 0.8175; train_kl_reg_loss: 146160.8764; train_edge_recon_loss: 2975370.1718; train_gene_expr_recon_loss: 21780020.5496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6228183.5420; train_global_loss: 31129735.2672; train_optim_loss: 31129735.2672; val_kl_reg_loss: 144712.5219; val_edge_recon_loss: 2979700.6000; val_gene_expr_recon_loss: 21643165.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6162814.1667; val_global_loss: 30930392.2667; val_optim_loss: 30930392.2667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8937; val_auprc_score: 0.8805; val_best_acc_score: 0.8102; val_best_f1_score: 0.8263; train_kl_reg_loss: 139269.0651; train_edge_recon_loss: 2951777.3721; train_gene_expr_recon_loss: 21631372.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6198599.8664; train_global_loss: 30921018.3206; train_optim_loss: 30921018.3206; val_kl_reg_loss: 130604.6349; val_edge_recon_loss: 2961756.6833; val_gene_expr_recon_loss: 21543796.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6177284.4667; val_global_loss: 30813442.6667; val_optim_loss: 30813442.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9096; val_auprc_score: 0.8955; val_best_acc_score: 0.8314; val_best_f1_score: 0.8457; train_kl_reg_loss: 134170.1657; train_edge_recon_loss: 2902804.1794; train_gene_expr_recon_loss: 21529794.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6175577.4427; train_global_loss: 30742346.3969; train_optim_loss: 30742346.3969; val_kl_reg_loss: 132533.5703; val_edge_recon_loss: 2914781.6167; val_gene_expr_recon_loss: 21338880.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6137810.0667; val_global_loss: 30524005.8667; val_optim_loss: 30524005.8667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9197; val_auprc_score: 0.9043; val_best_acc_score: 0.8465; val_best_f1_score: 0.8576; train_kl_reg_loss: 127407.2165; train_edge_recon_loss: 2877806.9485; train_gene_expr_recon_loss: 21392453.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6151560.3168; train_global_loss: 30549227.7405; train_optim_loss: 30549227.7405; val_kl_reg_loss: 127079.4734; val_edge_recon_loss: 2873167.1500; val_gene_expr_recon_loss: 21251066.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6094645.9000; val_global_loss: 30345959.2000; val_optim_loss: 30345959.2000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9259; val_auprc_score: 0.9103; val_best_acc_score: 0.8545; val_best_f1_score: 0.8625; train_kl_reg_loss: 127338.4939; train_edge_recon_loss: 2851317.0802; train_gene_expr_recon_loss: 21305855.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6132906.2099; train_global_loss: 30417417.6031; train_optim_loss: 30417417.6031; val_kl_reg_loss: 122787.5573; val_edge_recon_loss: 2852922.0667; val_gene_expr_recon_loss: 21260949.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6109408.8333; val_global_loss: 30346067.8667; val_optim_loss: 30346067.8667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9309; val_auprc_score: 0.9172; val_best_acc_score: 0.8605; val_best_f1_score: 0.8678; train_kl_reg_loss: 123814.7588; train_edge_recon_loss: 2836411.3989; train_gene_expr_recon_loss: 21238243.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6122829.2863; train_global_loss: 30321299.1756; train_optim_loss: 30321299.1756; val_kl_reg_loss: 123579.8203; val_edge_recon_loss: 2808946.2667; val_gene_expr_recon_loss: 21066449.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6080228.5667; val_global_loss: 30079204.1333; val_optim_loss: 30079204.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9337; val_auprc_score: 0.9183; val_best_acc_score: 0.8680; val_best_f1_score: 0.8744; train_kl_reg_loss: 120095.9002; train_edge_recon_loss: 2814451.2290; train_gene_expr_recon_loss: 21179451.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6111968.9809; train_global_loss: 30225967.8168; train_optim_loss: 30225967.8168; val_kl_reg_loss: 119817.2667; val_edge_recon_loss: 2812402.6333; val_gene_expr_recon_loss: 21078702.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6083006.0000; val_global_loss: 30093928.6667; val_optim_loss: 30093928.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9392; val_auprc_score: 0.9257; val_best_acc_score: 0.8724; val_best_f1_score: 0.8798; train_kl_reg_loss: 118431.4981; train_edge_recon_loss: 2805471.3874; train_gene_expr_recon_loss: 21101261.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6092102.9695; train_global_loss: 30117266.9924; train_optim_loss: 30117266.9924; val_kl_reg_loss: 115450.5432; val_edge_recon_loss: 2804972.1500; val_gene_expr_recon_loss: 21056295.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6083559.2333; val_global_loss: 30060277.6000; val_optim_loss: 30060277.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9409; val_auprc_score: 0.9260; val_best_acc_score: 0.8770; val_best_f1_score: 0.8805; train_kl_reg_loss: 115168.0382; train_edge_recon_loss: 2782677.9561; train_gene_expr_recon_loss: 21053856.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6087073.3130; train_global_loss: 30038775.7099; train_optim_loss: 30038775.7099; val_kl_reg_loss: 111795.5073; val_edge_recon_loss: 2797206.0000; val_gene_expr_recon_loss: 20881017.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6020119.4000; val_global_loss: 29810138.4000; val_optim_loss: 29810138.4000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9480; val_auprc_score: 0.9352; val_best_acc_score: 0.8853; val_best_f1_score: 0.8899; train_kl_reg_loss: 111079.0153; train_edge_recon_loss: 2780443.1947; train_gene_expr_recon_loss: 21001366.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6075075.0573; train_global_loss: 29967964.0763; train_optim_loss: 29967964.0763; val_kl_reg_loss: 111854.5745; val_edge_recon_loss: 2782860.0333; val_gene_expr_recon_loss: 20896484.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6029800.5667; val_global_loss: 29820999.7333; val_optim_loss: 29820999.7333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9514; val_auprc_score: 0.9387; val_best_acc_score: 0.8902; val_best_f1_score: 0.8937; train_kl_reg_loss: 109370.2809; train_edge_recon_loss: 2768945.2557; train_gene_expr_recon_loss: 20933409.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6061069.2901; train_global_loss: 29872794.5649; train_optim_loss: 29872794.5649; val_kl_reg_loss: 108699.0979; val_edge_recon_loss: 2771663.2000; val_gene_expr_recon_loss: 20957298.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6044808.3000; val_global_loss: 29882469.0667; val_optim_loss: 29882469.0667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9545; val_auprc_score: 0.9446; val_best_acc_score: 0.8910; val_best_f1_score: 0.8944; train_kl_reg_loss: 105920.6627; train_edge_recon_loss: 2759613.9389; train_gene_expr_recon_loss: 20906981.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6060188.1527; train_global_loss: 29832704.0305; train_optim_loss: 29832704.0305; val_kl_reg_loss: 102047.3745; val_edge_recon_loss: 2762541.8167; val_gene_expr_recon_loss: 20783998.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6011290.2667; val_global_loss: 29659877.8667; val_optim_loss: 29659877.8667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9523; val_auprc_score: 0.9417; val_best_acc_score: 0.8922; val_best_f1_score: 0.8968; train_kl_reg_loss: 103670.3560; train_edge_recon_loss: 2758115.7099; train_gene_expr_recon_loss: 20863787.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6050334.5992; train_global_loss: 29775908.0305; train_optim_loss: 29775908.0305; val_kl_reg_loss: 101999.2026; val_edge_recon_loss: 2758427.4500; val_gene_expr_recon_loss: 20782136.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6020450.7000; val_global_loss: 29663013.8667; val_optim_loss: 29663013.8667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9555; val_auprc_score: 0.9460; val_best_acc_score: 0.8929; val_best_f1_score: 0.8968; train_kl_reg_loss: 101495.9180; train_edge_recon_loss: 2751007.0515; train_gene_expr_recon_loss: 20839872.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6046027.8855; train_global_loss: 29738403.6641; train_optim_loss: 29738403.6641; val_kl_reg_loss: 98922.6625; val_edge_recon_loss: 2788300.5833; val_gene_expr_recon_loss: 20819332.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6033471.8000; val_global_loss: 29740027.4667; val_optim_loss: 29740027.4667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9581; val_auprc_score: 0.9471; val_best_acc_score: 0.9020; val_best_f1_score: 0.9054; train_kl_reg_loss: 99496.8045; train_edge_recon_loss: 2740683.5687; train_gene_expr_recon_loss: 20793029.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6033537.2137; train_global_loss: 29666747.5267; train_optim_loss: 29666747.5267; val_kl_reg_loss: 99217.8172; val_edge_recon_loss: 2756699.1500; val_gene_expr_recon_loss: 20794577.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6008270.9000; val_global_loss: 29658765.2000; val_optim_loss: 29658765.2000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9635; val_auprc_score: 0.9564; val_best_acc_score: 0.9034; val_best_f1_score: 0.9063; train_kl_reg_loss: 98058.1135; train_edge_recon_loss: 2734654.7156; train_gene_expr_recon_loss: 20759231.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6031378.4809; train_global_loss: 29623322.9771; train_optim_loss: 29623322.9771; val_kl_reg_loss: 95200.0021; val_edge_recon_loss: 2743426.2500; val_gene_expr_recon_loss: 20659778.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5978522.9667; val_global_loss: 29476927.6000; val_optim_loss: 29476927.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9684; val_auprc_score: 0.9596; val_best_acc_score: 0.9127; val_best_f1_score: 0.9146; train_kl_reg_loss: 95536.6561; train_edge_recon_loss: 2739863.6374; train_gene_expr_recon_loss: 20748566.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6033916.3817; train_global_loss: 29617882.7023; train_optim_loss: 29617882.7023; val_kl_reg_loss: 92248.6057; val_edge_recon_loss: 2720329.5500; val_gene_expr_recon_loss: 20692307.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5989112.9667; val_global_loss: 29493998.6667; val_optim_loss: 29493998.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9648; val_auprc_score: 0.9572; val_best_acc_score: 0.9050; val_best_f1_score: 0.9080; train_kl_reg_loss: 93649.3201; train_edge_recon_loss: 2728618.3034; train_gene_expr_recon_loss: 20714869.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6025267.6908; train_global_loss: 29562405.0840; train_optim_loss: 29562405.0840; val_kl_reg_loss: 92548.7755; val_edge_recon_loss: 2740206.5667; val_gene_expr_recon_loss: 20618121.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5982551.4667; val_global_loss: 29433428.6667; val_optim_loss: 29433428.6667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9659; val_auprc_score: 0.9558; val_best_acc_score: 0.9136; val_best_f1_score: 0.9161; train_kl_reg_loss: 91812.6341; train_edge_recon_loss: 2727349.0363; train_gene_expr_recon_loss: 20663864.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6011269.2786; train_global_loss: 29494295.5115; train_optim_loss: 29494295.5115; val_kl_reg_loss: 90153.5370; val_edge_recon_loss: 2736309.1333; val_gene_expr_recon_loss: 20552352.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5972089.2333; val_global_loss: 29350904.4000; val_optim_loss: 29350904.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9700; val_auprc_score: 0.9634; val_best_acc_score: 0.9178; val_best_f1_score: 0.9196; train_kl_reg_loss: 90380.3514; train_edge_recon_loss: 2721984.1565; train_gene_expr_recon_loss: 20660756.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6016264.1985; train_global_loss: 29489384.6870; train_optim_loss: 29489384.6870; val_kl_reg_loss: 88620.1089; val_edge_recon_loss: 2750297.1500; val_gene_expr_recon_loss: 20743852.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6016783.5000; val_global_loss: 29599553.7333; val_optim_loss: 29599553.7333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9426; val_auprc_score: 0.9306; val_best_acc_score: 0.8781; val_best_f1_score: 0.8853; train_kl_reg_loss: 88393.6080; train_edge_recon_loss: 3028531.2557; train_gene_expr_recon_loss: 23344925.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6371294.4809; train_global_loss: 32833144.4733; train_optim_loss: 32833144.4733; val_kl_reg_loss: 17749.5529; val_edge_recon_loss: 2891409.6667; val_gene_expr_recon_loss: 22433145.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6242492.6667; val_global_loss: 31584797.0667; val_optim_loss: 31584797.0667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9420; val_auprc_score: 0.9309; val_best_acc_score: 0.8791; val_best_f1_score: 0.8823; train_kl_reg_loss: 95585.7651; train_edge_recon_loss: 2832796.8034; train_gene_expr_recon_loss: 23057130.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6304867.0840; train_global_loss: 32290380.6718; train_optim_loss: 32290380.6718; val_kl_reg_loss: 17106.8178; val_edge_recon_loss: 2829680.3167; val_gene_expr_recon_loss: 23294380.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6255217.8000; val_global_loss: 32396385.3333; val_optim_loss: 32396385.3333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9475; val_auprc_score: 0.9375; val_best_acc_score: 0.8813; val_best_f1_score: 0.8859; train_kl_reg_loss: 75746.2664; train_edge_recon_loss: 2795189.9027; train_gene_expr_recon_loss: 23689852.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6320801.7672; train_global_loss: 32881590.5802; train_optim_loss: 32881590.5802; val_kl_reg_loss: 13696.1355; val_edge_recon_loss: 2753935.9333; val_gene_expr_recon_loss: 23684930.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6270100.7667; val_global_loss: 32722663.4667; val_optim_loss: 32722663.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9488; val_auprc_score: 0.9381; val_best_acc_score: 0.8852; val_best_f1_score: 0.8896; train_kl_reg_loss: 64508.2729; train_edge_recon_loss: 2746392.8416; train_gene_expr_recon_loss: 23787035.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6316157.4695; train_global_loss: 32914093.6336; train_optim_loss: 32914093.6336; val_kl_reg_loss: 14091.9309; val_edge_recon_loss: 2746981.5167; val_gene_expr_recon_loss: 23733605.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6293755.0333; val_global_loss: 32788433.8667; val_optim_loss: 32788433.8667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9511; val_auprc_score: 0.9402; val_best_acc_score: 0.8868; val_best_f1_score: 0.8901; train_kl_reg_loss: 62638.9926; train_edge_recon_loss: 2742753.2462; train_gene_expr_recon_loss: 23737715.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6308520.9160; train_global_loss: 32851628.5344; train_optim_loss: 32851628.5344; val_kl_reg_loss: 14525.0262; val_edge_recon_loss: 2759286.2000; val_gene_expr_recon_loss: 23650563.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6287447.0333; val_global_loss: 32711821.7333; val_optim_loss: 32711821.7333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9489; val_auprc_score: 0.9367; val_best_acc_score: 0.8871; val_best_f1_score: 0.8920; train_kl_reg_loss: 61271.1773; train_edge_recon_loss: 2733822.7920; train_gene_expr_recon_loss: 23731190.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6308321.9351; train_global_loss: 32834605.8168; train_optim_loss: 32834605.8168; val_kl_reg_loss: 14763.3940; val_edge_recon_loss: 2738346.2333; val_gene_expr_recon_loss: 23677530.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6284180.0333; val_global_loss: 32714820.0000; val_optim_loss: 32714820.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9493; val_auprc_score: 0.9376; val_best_acc_score: 0.8883; val_best_f1_score: 0.8919; train_kl_reg_loss: 59130.2063; train_edge_recon_loss: 2734582.6527; train_gene_expr_recon_loss: 23702374.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6306887.5840; train_global_loss: 32802974.8702; train_optim_loss: 32802974.8702; val_kl_reg_loss: 15148.9175; val_edge_recon_loss: 2757499.7833; val_gene_expr_recon_loss: 23635074.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6273064.1333; val_global_loss: 32680787.7333; val_optim_loss: 32680787.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 58 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9579
val AUPRC score: 0.9475
val best accuracy score: 0.9003
val best F1 score: 0.9059
val target rna MSE score: 1.3643
val source rna MSE score: 499.1626
val target atac MSE score: 0.6140
val source atac MSE score: 6.4162
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
