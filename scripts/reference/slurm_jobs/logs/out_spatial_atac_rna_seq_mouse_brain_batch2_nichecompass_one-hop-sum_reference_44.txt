[True]
Run timestamp: 10082023_205004_44.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_44']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7564; val_auprc_score: 0.7785; val_best_acc_score: 0.5093; val_best_f1_score: 0.6705; train_kl_reg_loss: 154435.2943; train_edge_recon_loss: 3638052.6240; train_gene_expr_recon_loss: 26313816.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6793543.3969; train_global_loss: 36899847.3435; train_optim_loss: 36899847.3435; val_kl_reg_loss: 186992.8625; val_edge_recon_loss: 4064555.0000; val_gene_expr_recon_loss: 22689858.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6398936.3333; val_global_loss: 33340342.9333; val_optim_loss: 33340342.9333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8215; val_auprc_score: 0.8301; val_best_acc_score: 0.6944; val_best_f1_score: 0.7463; train_kl_reg_loss: 193092.6165; train_edge_recon_loss: 3579183.8263; train_gene_expr_recon_loss: 22516734.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6372920.0305; train_global_loss: 32661931.2366; train_optim_loss: 32661931.2366; val_kl_reg_loss: 166539.7448; val_edge_recon_loss: 4049661.3500; val_gene_expr_recon_loss: 22186775.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6335300.7667; val_global_loss: 32738277.3333; val_optim_loss: 32738277.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8849; val_auprc_score: 0.8836; val_best_acc_score: 0.7844; val_best_f1_score: 0.8091; train_kl_reg_loss: 157265.9888; train_edge_recon_loss: 3544541.4561; train_gene_expr_recon_loss: 22213306.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6331952.8931; train_global_loss: 32247067.1298; train_optim_loss: 32247067.1298; val_kl_reg_loss: 132585.9760; val_edge_recon_loss: 3915116.7667; val_gene_expr_recon_loss: 21875436.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6267906.8667; val_global_loss: 32191045.6000; val_optim_loss: 32191045.6000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8818; val_auprc_score: 0.8716; val_best_acc_score: 0.7898; val_best_f1_score: 0.8064; train_kl_reg_loss: 131942.4493; train_edge_recon_loss: 3315848.0534; train_gene_expr_recon_loss: 22042879.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6294231.6260; train_global_loss: 31784901.9389; train_optim_loss: 31784901.9389; val_kl_reg_loss: 140730.7490; val_edge_recon_loss: 3062859.3667; val_gene_expr_recon_loss: 21845236.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6251153.6667; val_global_loss: 31299980.6667; val_optim_loss: 31299980.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8755; val_auprc_score: 0.8629; val_best_acc_score: 0.7828; val_best_f1_score: 0.8012; train_kl_reg_loss: 162093.4567; train_edge_recon_loss: 3028382.1107; train_gene_expr_recon_loss: 21859956.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6258991.4733; train_global_loss: 31309423.5267; train_optim_loss: 31309423.5267; val_kl_reg_loss: 156472.7042; val_edge_recon_loss: 3058410.6833; val_gene_expr_recon_loss: 21689539.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6236396.2667; val_global_loss: 31140818.8000; val_optim_loss: 31140818.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8990; val_auprc_score: 0.8882; val_best_acc_score: 0.8075; val_best_f1_score: 0.8205; train_kl_reg_loss: 154652.1854; train_edge_recon_loss: 2974747.4828; train_gene_expr_recon_loss: 21717927.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6233867.5687; train_global_loss: 31081195.0229; train_optim_loss: 31081195.0229; val_kl_reg_loss: 144025.0458; val_edge_recon_loss: 3002554.0000; val_gene_expr_recon_loss: 21479628.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6202031.4000; val_global_loss: 30828239.2000; val_optim_loss: 30828239.2000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9120; val_auprc_score: 0.8974; val_best_acc_score: 0.8332; val_best_f1_score: 0.8413; train_kl_reg_loss: 141681.0969; train_edge_recon_loss: 2941729.4294; train_gene_expr_recon_loss: 21558516.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6197776.0420; train_global_loss: 30839703.2672; train_optim_loss: 30839703.2672; val_kl_reg_loss: 137165.3969; val_edge_recon_loss: 2945508.0000; val_gene_expr_recon_loss: 21384109.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6178482.6000; val_global_loss: 30645265.3333; val_optim_loss: 30645265.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9244; val_auprc_score: 0.9095; val_best_acc_score: 0.8533; val_best_f1_score: 0.8616; train_kl_reg_loss: 137403.5587; train_edge_recon_loss: 2887770.8874; train_gene_expr_recon_loss: 21467595.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6175167.4885; train_global_loss: 30667937.2519; train_optim_loss: 30667937.2519; val_kl_reg_loss: 139816.1833; val_edge_recon_loss: 2879643.7667; val_gene_expr_recon_loss: 21279571.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6165157.9667; val_global_loss: 30464189.8667; val_optim_loss: 30464189.8667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9299; val_auprc_score: 0.9147; val_best_acc_score: 0.8639; val_best_f1_score: 0.8700; train_kl_reg_loss: 138691.5728; train_edge_recon_loss: 2849869.6546; train_gene_expr_recon_loss: 21382979.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6161945.6679; train_global_loss: 30533486.4885; train_optim_loss: 30533486.4885; val_kl_reg_loss: 131234.1005; val_edge_recon_loss: 2869584.4333; val_gene_expr_recon_loss: 21237208.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6152309.8000; val_global_loss: 30390336.6667; val_optim_loss: 30390336.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9348; val_auprc_score: 0.9194; val_best_acc_score: 0.8717; val_best_f1_score: 0.8776; train_kl_reg_loss: 133420.2221; train_edge_recon_loss: 2835790.7271; train_gene_expr_recon_loss: 21313034.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6148220.6412; train_global_loss: 30430466.5649; train_optim_loss: 30430466.5649; val_kl_reg_loss: 127085.0151; val_edge_recon_loss: 2830076.1500; val_gene_expr_recon_loss: 21182524.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6142669.4333; val_global_loss: 30282354.1333; val_optim_loss: 30282354.1333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9374; val_auprc_score: 0.9224; val_best_acc_score: 0.8690; val_best_f1_score: 0.8771; train_kl_reg_loss: 128106.6355; train_edge_recon_loss: 2811770.3263; train_gene_expr_recon_loss: 21243506.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6132848.8092; train_global_loss: 30316232.2901; train_optim_loss: 30316232.2901; val_kl_reg_loss: 128473.3776; val_edge_recon_loss: 2840920.1000; val_gene_expr_recon_loss: 21103360.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6130047.1333; val_global_loss: 30202800.2667; val_optim_loss: 30202800.2667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9420; val_auprc_score: 0.9293; val_best_acc_score: 0.8781; val_best_f1_score: 0.8829; train_kl_reg_loss: 125554.4761; train_edge_recon_loss: 2799207.3912; train_gene_expr_recon_loss: 21155922.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6112889.6985; train_global_loss: 30193574.1374; train_optim_loss: 30193574.1374; val_kl_reg_loss: 118448.9646; val_edge_recon_loss: 2831880.6333; val_gene_expr_recon_loss: 21030224.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6104427.8000; val_global_loss: 30084982.2667; val_optim_loss: 30084982.2667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9466; val_auprc_score: 0.9317; val_best_acc_score: 0.8872; val_best_f1_score: 0.8916; train_kl_reg_loss: 121209.2549; train_edge_recon_loss: 2788544.9943; train_gene_expr_recon_loss: 21061787.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6091550.2366; train_global_loss: 30063091.6336; train_optim_loss: 30063091.6336; val_kl_reg_loss: 121056.7490; val_edge_recon_loss: 2801898.0667; val_gene_expr_recon_loss: 20915721.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6080182.6667; val_global_loss: 29918859.3333; val_optim_loss: 29918859.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9497; val_auprc_score: 0.9376; val_best_acc_score: 0.8883; val_best_f1_score: 0.8921; train_kl_reg_loss: 117451.1482; train_edge_recon_loss: 2773136.9905; train_gene_expr_recon_loss: 21022103.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6082198.1298; train_global_loss: 29994889.7405; train_optim_loss: 29994889.7405; val_kl_reg_loss: 115078.2646; val_edge_recon_loss: 2787900.3667; val_gene_expr_recon_loss: 20901122.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6077416.8667; val_global_loss: 29881517.8667; val_optim_loss: 29881517.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9554; val_auprc_score: 0.9441; val_best_acc_score: 0.8977; val_best_f1_score: 0.9016; train_kl_reg_loss: 115654.5170; train_edge_recon_loss: 2765172.9065; train_gene_expr_recon_loss: 20989615.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6076371.3626; train_global_loss: 29946813.9237; train_optim_loss: 29946813.9237; val_kl_reg_loss: 113732.6828; val_edge_recon_loss: 2779516.0833; val_gene_expr_recon_loss: 20822986.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6045337.8333; val_global_loss: 29761573.3333; val_optim_loss: 29761573.3333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9545; val_auprc_score: 0.9435; val_best_acc_score: 0.8959; val_best_f1_score: 0.9013; train_kl_reg_loss: 111511.7650; train_edge_recon_loss: 2758224.5076; train_gene_expr_recon_loss: 20922110.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6060714.3130; train_global_loss: 29852561.0076; train_optim_loss: 29852561.0076; val_kl_reg_loss: 108968.2010; val_edge_recon_loss: 2778690.4000; val_gene_expr_recon_loss: 20802998.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6065213.7000; val_global_loss: 29755870.6667; val_optim_loss: 29755870.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9591; val_auprc_score: 0.9459; val_best_acc_score: 0.9042; val_best_f1_score: 0.9086; train_kl_reg_loss: 108184.7541; train_edge_recon_loss: 2755594.0344; train_gene_expr_recon_loss: 20884572.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6056489.3092; train_global_loss: 29804840.5649; train_optim_loss: 29804840.5649; val_kl_reg_loss: 107420.5016; val_edge_recon_loss: 2737800.0833; val_gene_expr_recon_loss: 20755580.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6044043.5000; val_global_loss: 29644844.9333; val_optim_loss: 29644844.9333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9622; val_auprc_score: 0.9537; val_best_acc_score: 0.9064; val_best_f1_score: 0.9099; train_kl_reg_loss: 106180.7374; train_edge_recon_loss: 2750197.6794; train_gene_expr_recon_loss: 20829678.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6046502.2328; train_global_loss: 29732559.0076; train_optim_loss: 29732559.0076; val_kl_reg_loss: 103509.6672; val_edge_recon_loss: 2756737.4833; val_gene_expr_recon_loss: 20717426.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6061159.9333; val_global_loss: 29638834.1333; val_optim_loss: 29638834.1333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9596; val_auprc_score: 0.9482; val_best_acc_score: 0.9068; val_best_f1_score: 0.9105; train_kl_reg_loss: 103523.9857; train_edge_recon_loss: 2740457.3683; train_gene_expr_recon_loss: 20804988.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6038303.1298; train_global_loss: 29687272.9008; train_optim_loss: 29687272.9008; val_kl_reg_loss: 102710.0292; val_edge_recon_loss: 2771772.0000; val_gene_expr_recon_loss: 20631175.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6010694.3667; val_global_loss: 29516352.4000; val_optim_loss: 29516352.4000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9676; val_auprc_score: 0.9599; val_best_acc_score: 0.9105; val_best_f1_score: 0.9128; train_kl_reg_loss: 101867.5401; train_edge_recon_loss: 2732991.9771; train_gene_expr_recon_loss: 20771540.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6034098.4313; train_global_loss: 29640498.2595; train_optim_loss: 29640498.2595; val_kl_reg_loss: 100575.7969; val_edge_recon_loss: 2727329.5000; val_gene_expr_recon_loss: 20605273.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6018209.1667; val_global_loss: 29451387.7333; val_optim_loss: 29451387.7333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9665; val_auprc_score: 0.9570; val_best_acc_score: 0.9122; val_best_f1_score: 0.9148; train_kl_reg_loss: 98845.8775; train_edge_recon_loss: 2730396.8359; train_gene_expr_recon_loss: 20713897.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6015673.6565; train_global_loss: 29558814.0305; train_optim_loss: 29558814.0305; val_kl_reg_loss: 98836.6615; val_edge_recon_loss: 2733514.9500; val_gene_expr_recon_loss: 20624891.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6031456.9333; val_global_loss: 29488700.0000; val_optim_loss: 29488700.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9665; val_auprc_score: 0.9582; val_best_acc_score: 0.9089; val_best_f1_score: 0.9128; train_kl_reg_loss: 97563.2971; train_edge_recon_loss: 2723832.4389; train_gene_expr_recon_loss: 20672197.3588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6013279.8053; train_global_loss: 29506872.8092; train_optim_loss: 29506872.8092; val_kl_reg_loss: 97445.0115; val_edge_recon_loss: 2744007.1667; val_gene_expr_recon_loss: 20575121.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6018244.9333; val_global_loss: 29434818.8000; val_optim_loss: 29434818.8000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9700; val_auprc_score: 0.9607; val_best_acc_score: 0.9178; val_best_f1_score: 0.9203; train_kl_reg_loss: 96035.3899; train_edge_recon_loss: 2713521.7653; train_gene_expr_recon_loss: 20653081.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6009505.2977; train_global_loss: 29472143.8015; train_optim_loss: 29472143.8015; val_kl_reg_loss: 94794.3276; val_edge_recon_loss: 2721607.9500; val_gene_expr_recon_loss: 20552550.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6005259.6667; val_global_loss: 29374212.4000; val_optim_loss: 29374212.4000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9709; val_auprc_score: 0.9635; val_best_acc_score: 0.9197; val_best_f1_score: 0.9216; train_kl_reg_loss: 94251.5423; train_edge_recon_loss: 2712997.3092; train_gene_expr_recon_loss: 20592096.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5994241.0076; train_global_loss: 29393586.7634; train_optim_loss: 29393586.7634; val_kl_reg_loss: 92235.0703; val_edge_recon_loss: 2720550.5667; val_gene_expr_recon_loss: 20570144.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6017063.0667; val_global_loss: 29399993.4667; val_optim_loss: 29399993.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9699; val_auprc_score: 0.9626; val_best_acc_score: 0.9193; val_best_f1_score: 0.9224; train_kl_reg_loss: 92430.0007; train_edge_recon_loss: 2712549.2004; train_gene_expr_recon_loss: 20601064.7328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6001849.1718; train_global_loss: 29407893.0687; train_optim_loss: 29407893.0687; val_kl_reg_loss: 92500.8448; val_edge_recon_loss: 2729083.6833; val_gene_expr_recon_loss: 20405766.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5969202.6333; val_global_loss: 29196553.7333; val_optim_loss: 29196553.7333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9704; val_auprc_score: 0.9627; val_best_acc_score: 0.9205; val_best_f1_score: 0.9236; train_kl_reg_loss: 97725.3644; train_edge_recon_loss: 2753390.6011; train_gene_expr_recon_loss: 21401847.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6177152.8015; train_global_loss: 30430116.0000; train_optim_loss: 30430116.0000; val_kl_reg_loss: 51417.2057; val_edge_recon_loss: 2734009.7167; val_gene_expr_recon_loss: 21279942.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6157563.1333; val_global_loss: 30222933.0667; val_optim_loss: 30222933.0667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9702; val_auprc_score: 0.9620; val_best_acc_score: 0.9193; val_best_f1_score: 0.9213; train_kl_reg_loss: 95386.9578; train_edge_recon_loss: 2728297.4809; train_gene_expr_recon_loss: 21261234.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6113679.5611; train_global_loss: 30198598.5649; train_optim_loss: 30198598.5649; val_kl_reg_loss: 54431.3786; val_edge_recon_loss: 2724207.9333; val_gene_expr_recon_loss: 21289904.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6152436.2667; val_global_loss: 30220980.6667; val_optim_loss: 30220980.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9720; val_auprc_score: 0.9655; val_best_acc_score: 0.9229; val_best_f1_score: 0.9246; train_kl_reg_loss: 89502.6364; train_edge_recon_loss: 2722537.7653; train_gene_expr_recon_loss: 21327235.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6103535.5344; train_global_loss: 30242811.6641; train_optim_loss: 30242811.6641; val_kl_reg_loss: 49399.4922; val_edge_recon_loss: 2722282.9167; val_gene_expr_recon_loss: 21334953.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6102218.5333; val_global_loss: 30208854.8000; val_optim_loss: 30208854.8000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9721; val_auprc_score: 0.9647; val_best_acc_score: 0.9184; val_best_f1_score: 0.9206; train_kl_reg_loss: 89980.4424; train_edge_recon_loss: 2730460.4790; train_gene_expr_recon_loss: 21486535.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6107708.0267; train_global_loss: 30414684.1679; train_optim_loss: 30414684.1679; val_kl_reg_loss: 43736.8083; val_edge_recon_loss: 2741030.6000; val_gene_expr_recon_loss: 21484103.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6085187.8333; val_global_loss: 30354058.8000; val_optim_loss: 30354058.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9694; val_auprc_score: 0.9585; val_best_acc_score: 0.9197; val_best_f1_score: 0.9225; train_kl_reg_loss: 93648.7613; train_edge_recon_loss: 2732168.4198; train_gene_expr_recon_loss: 21677566.4122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6124540.3244; train_global_loss: 30627923.9542; train_optim_loss: 30627923.9542; val_kl_reg_loss: 42350.9805; val_edge_recon_loss: 2730211.5167; val_gene_expr_recon_loss: 21585327.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6141407.2333; val_global_loss: 30499297.3333; val_optim_loss: 30499297.3333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9734; val_auprc_score: 0.9675; val_best_acc_score: 0.9206; val_best_f1_score: 0.9241; train_kl_reg_loss: 95726.9914; train_edge_recon_loss: 2735672.7080; train_gene_expr_recon_loss: 21674394.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6138298.3664; train_global_loss: 30644092.7176; train_optim_loss: 30644092.7176; val_kl_reg_loss: 42297.6708; val_edge_recon_loss: 2724329.4333; val_gene_expr_recon_loss: 21561369.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6121793.8000; val_global_loss: 30449790.2667; val_optim_loss: 30449790.2667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9693; val_auprc_score: 0.9586; val_best_acc_score: 0.9202; val_best_f1_score: 0.9229; train_kl_reg_loss: 96736.4865; train_edge_recon_loss: 2736336.4561; train_gene_expr_recon_loss: 21721304.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6143009.1374; train_global_loss: 30697386.2748; train_optim_loss: 30697386.2748; val_kl_reg_loss: 41900.7695; val_edge_recon_loss: 2745145.0833; val_gene_expr_recon_loss: 21610179.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6128381.9667; val_global_loss: 30525607.3333; val_optim_loss: 30525607.3333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9716; val_auprc_score: 0.9635; val_best_acc_score: 0.9202; val_best_f1_score: 0.9230; train_kl_reg_loss: 96801.9946; train_edge_recon_loss: 2738830.8206; train_gene_expr_recon_loss: 21696779.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 6140942.0076; train_global_loss: 30673354.2901; train_optim_loss: 30673354.2901; val_kl_reg_loss: 40307.9096; val_edge_recon_loss: 2734830.2833; val_gene_expr_recon_loss: 21509881.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 6116644.9667; val_global_loss: 30401664.4000; val_optim_loss: 30401664.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 38 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9692
val AUPRC score: 0.9600
val best accuracy score: 0.9184
val best F1 score: 0.9205
val target rna MSE score: 1.1480
val source rna MSE score: 18.7963
val target atac MSE score: 0.5701
val source atac MSE score: 6.1604
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
