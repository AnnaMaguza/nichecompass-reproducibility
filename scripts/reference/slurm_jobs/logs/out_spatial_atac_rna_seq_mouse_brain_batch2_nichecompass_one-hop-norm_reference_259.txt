[True]
Run timestamp: 10102023_120215_259.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_259']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6808; val_auprc_score: 0.6585; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 71235.8183; train_edge_recon_loss: 752830.1051; train_gene_expr_recon_loss: 23154488.3333; train_masked_gp_l1_reg_loss: 38174.8299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4008060.0227; train_chrom_access_recon_loss: 4938490.7121; train_global_loss: 32963279.4545; train_optim_loss: 32963279.4545; val_kl_reg_loss: 110127.4580; val_edge_recon_loss: 813173.2344; val_gene_expr_recon_loss: 21915009.2500; val_masked_gp_l1_reg_loss: 46717.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2699091.7500; val_chrom_access_recon_loss: 4749430.3125; val_global_loss: 30333550.2500; val_optim_loss: 30333550.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6663; val_auprc_score: 0.6520; val_best_acc_score: 0.5427; val_best_f1_score: 0.6815; train_kl_reg_loss: 87448.8233; train_edge_recon_loss: 750096.7216; train_gene_expr_recon_loss: 21325532.7576; train_masked_gp_l1_reg_loss: 46409.7729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1756130.9318; train_chrom_access_recon_loss: 4710532.3485; train_global_loss: 28676151.2424; train_optim_loss: 28676151.2424; val_kl_reg_loss: 76118.6201; val_edge_recon_loss: 812589.8750; val_gene_expr_recon_loss: 21439465.2500; val_masked_gp_l1_reg_loss: 46258.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1040962.1875; val_chrom_access_recon_loss: 4724728.7500; val_global_loss: 28140123.0000; val_optim_loss: 28140123.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7379; val_auprc_score: 0.7127; val_best_acc_score: 0.6483; val_best_f1_score: 0.7176; train_kl_reg_loss: 80338.7131; train_edge_recon_loss: 739211.6960; train_gene_expr_recon_loss: 21068117.8485; train_masked_gp_l1_reg_loss: 46920.1167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 714436.9200; train_chrom_access_recon_loss: 4670533.8409; train_global_loss: 27319559.0909; train_optim_loss: 27319559.0909; val_kl_reg_loss: 80114.2510; val_edge_recon_loss: 810594.1641; val_gene_expr_recon_loss: 21303980.0000; val_masked_gp_l1_reg_loss: 47405.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 480730.4688; val_chrom_access_recon_loss: 4700187.1250; val_global_loss: 27423011.7500; val_optim_loss: 27423011.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8055; val_auprc_score: 0.7911; val_best_acc_score: 0.7125; val_best_f1_score: 0.7268; train_kl_reg_loss: 72753.7064; train_edge_recon_loss: 732813.7642; train_gene_expr_recon_loss: 20874735.4848; train_masked_gp_l1_reg_loss: 48080.1816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 366458.6780; train_chrom_access_recon_loss: 4647227.7652; train_global_loss: 26742069.7273; train_optim_loss: 26742069.7273; val_kl_reg_loss: 65829.2686; val_edge_recon_loss: 797203.5625; val_gene_expr_recon_loss: 21096832.7500; val_masked_gp_l1_reg_loss: 48841.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 282252.8438; val_chrom_access_recon_loss: 4691661.0625; val_global_loss: 26982621.2500; val_optim_loss: 26982621.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8498; val_auprc_score: 0.8108; val_best_acc_score: 0.7789; val_best_f1_score: 0.7961; train_kl_reg_loss: 66635.6864; train_edge_recon_loss: 720011.2784; train_gene_expr_recon_loss: 20737136.2727; train_masked_gp_l1_reg_loss: 49696.3894; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 240810.7784; train_chrom_access_recon_loss: 4624803.2576; train_global_loss: 26439093.7273; train_optim_loss: 26439093.7273; val_kl_reg_loss: 63891.3604; val_edge_recon_loss: 756512.8125; val_gene_expr_recon_loss: 20758713.2500; val_masked_gp_l1_reg_loss: 50627.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 209037.6406; val_chrom_access_recon_loss: 4621274.6875; val_global_loss: 26460058.7500; val_optim_loss: 26460058.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8697; val_auprc_score: 0.8342; val_best_acc_score: 0.7942; val_best_f1_score: 0.8126; train_kl_reg_loss: 65895.2198; train_edge_recon_loss: 683714.5928; train_gene_expr_recon_loss: 20574386.3636; train_masked_gp_l1_reg_loss: 51557.1002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 187377.1222; train_chrom_access_recon_loss: 4598100.2500; train_global_loss: 26161030.6970; train_optim_loss: 26161030.6970; val_kl_reg_loss: 75381.1504; val_edge_recon_loss: 656081.6250; val_gene_expr_recon_loss: 21023587.7500; val_masked_gp_l1_reg_loss: 52493.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 169314.2500; val_chrom_access_recon_loss: 4601505.9375; val_global_loss: 26578364.7500; val_optim_loss: 26578364.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8824; val_auprc_score: 0.8484; val_best_acc_score: 0.8138; val_best_f1_score: 0.8288; train_kl_reg_loss: 75548.4840; train_edge_recon_loss: 637105.0805; train_gene_expr_recon_loss: 20460171.7576; train_masked_gp_l1_reg_loss: 53547.8821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154901.0971; train_chrom_access_recon_loss: 4574382.0985; train_global_loss: 25955656.3939; train_optim_loss: 25955656.3939; val_kl_reg_loss: 74965.4707; val_edge_recon_loss: 635324.4375; val_gene_expr_recon_loss: 20721851.5000; val_masked_gp_l1_reg_loss: 54542.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142444.5781; val_chrom_access_recon_loss: 4624624.4375; val_global_loss: 26253751.7500; val_optim_loss: 26253751.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8883; val_auprc_score: 0.8507; val_best_acc_score: 0.8195; val_best_f1_score: 0.8353; train_kl_reg_loss: 75433.9027; train_edge_recon_loss: 627077.1780; train_gene_expr_recon_loss: 20339252.6667; train_masked_gp_l1_reg_loss: 55364.9640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132093.4040; train_chrom_access_recon_loss: 4549869.4697; train_global_loss: 25779091.6667; train_optim_loss: 25779091.6667; val_kl_reg_loss: 72170.0361; val_edge_recon_loss: 623525.1172; val_gene_expr_recon_loss: 20531683.5000; val_masked_gp_l1_reg_loss: 56107.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123061.7266; val_chrom_access_recon_loss: 4579493.1250; val_global_loss: 25986042.2500; val_optim_loss: 25986042.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8974; val_auprc_score: 0.8689; val_best_acc_score: 0.8307; val_best_f1_score: 0.8456; train_kl_reg_loss: 73415.3021; train_edge_recon_loss: 618562.4328; train_gene_expr_recon_loss: 20292900.5152; train_masked_gp_l1_reg_loss: 56820.7079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116616.1757; train_chrom_access_recon_loss: 4540611.6818; train_global_loss: 25698926.6364; train_optim_loss: 25698926.6364; val_kl_reg_loss: 73824.8262; val_edge_recon_loss: 621670.2422; val_gene_expr_recon_loss: 20620050.2500; val_masked_gp_l1_reg_loss: 57632.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111275.1875; val_chrom_access_recon_loss: 4573796.0625; val_global_loss: 26058249.2500; val_optim_loss: 26058249.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9002; val_auprc_score: 0.8686; val_best_acc_score: 0.8364; val_best_f1_score: 0.8477; train_kl_reg_loss: 72489.8617; train_edge_recon_loss: 611071.6165; train_gene_expr_recon_loss: 20190707.3333; train_masked_gp_l1_reg_loss: 58270.3479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106149.9473; train_chrom_access_recon_loss: 4516709.6061; train_global_loss: 25555398.7576; train_optim_loss: 25555398.7576; val_kl_reg_loss: 71092.5684; val_edge_recon_loss: 617113.7578; val_gene_expr_recon_loss: 20366641.2500; val_masked_gp_l1_reg_loss: 58800.0508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101961.9297; val_chrom_access_recon_loss: 4519776.2500; val_global_loss: 25735386.0000; val_optim_loss: 25735386.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8991; val_auprc_score: 0.8718; val_best_acc_score: 0.8364; val_best_f1_score: 0.8510; train_kl_reg_loss: 70151.3082; train_edge_recon_loss: 608647.0824; train_gene_expr_recon_loss: 20112845.0909; train_masked_gp_l1_reg_loss: 59465.7227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98645.7069; train_chrom_access_recon_loss: 4498940.8258; train_global_loss: 25448695.5758; train_optim_loss: 25448695.5758; val_kl_reg_loss: 68516.0264; val_edge_recon_loss: 618024.5859; val_gene_expr_recon_loss: 20298966.5000; val_masked_gp_l1_reg_loss: 60181.8008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96323.4766; val_chrom_access_recon_loss: 4491385.6875; val_global_loss: 25633399.0000; val_optim_loss: 25633399.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9037; val_auprc_score: 0.8722; val_best_acc_score: 0.8404; val_best_f1_score: 0.8526; train_kl_reg_loss: 68708.6754; train_edge_recon_loss: 605799.8580; train_gene_expr_recon_loss: 20047884.6970; train_masked_gp_l1_reg_loss: 60553.0981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93640.0575; train_chrom_access_recon_loss: 4486625.2803; train_global_loss: 25363211.4545; train_optim_loss: 25363211.4545; val_kl_reg_loss: 68125.0059; val_edge_recon_loss: 612309.1406; val_gene_expr_recon_loss: 20213125.2500; val_masked_gp_l1_reg_loss: 61109.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91698.9453; val_chrom_access_recon_loss: 4484440.2500; val_global_loss: 25530808.0000; val_optim_loss: 25530808.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9149; val_auprc_score: 0.8830; val_best_acc_score: 0.8530; val_best_f1_score: 0.8638; train_kl_reg_loss: 67785.9914; train_edge_recon_loss: 602797.5994; train_gene_expr_recon_loss: 19970306.0606; train_masked_gp_l1_reg_loss: 61515.3204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90154.8363; train_chrom_access_recon_loss: 4470812.5833; train_global_loss: 25263372.2121; train_optim_loss: 25263372.2121; val_kl_reg_loss: 65787.8818; val_edge_recon_loss: 604335.9688; val_gene_expr_recon_loss: 20256824.0000; val_masked_gp_l1_reg_loss: 62015.5898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88275.2969; val_chrom_access_recon_loss: 4492835.4375; val_global_loss: 25570076.0000; val_optim_loss: 25570076.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9257; val_auprc_score: 0.9040; val_best_acc_score: 0.8619; val_best_f1_score: 0.8712; train_kl_reg_loss: 65919.2695; train_edge_recon_loss: 600839.5814; train_gene_expr_recon_loss: 19927160.8788; train_masked_gp_l1_reg_loss: 62325.8166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87986.5580; train_chrom_access_recon_loss: 4461540.6439; train_global_loss: 25205772.7273; train_optim_loss: 25205772.7273; val_kl_reg_loss: 67013.6890; val_edge_recon_loss: 599400.6641; val_gene_expr_recon_loss: 19907724.0000; val_masked_gp_l1_reg_loss: 62767.9414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88368.2891; val_chrom_access_recon_loss: 4406452.7500; val_global_loss: 25131727.0000; val_optim_loss: 25131727.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9233; val_auprc_score: 0.8983; val_best_acc_score: 0.8638; val_best_f1_score: 0.8743; train_kl_reg_loss: 65298.8565; train_edge_recon_loss: 598357.8428; train_gene_expr_recon_loss: 19852462.1515; train_masked_gp_l1_reg_loss: 63146.2575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88219.6531; train_chrom_access_recon_loss: 4443034.9242; train_global_loss: 25110519.8485; train_optim_loss: 25110519.8485; val_kl_reg_loss: 65029.0103; val_edge_recon_loss: 599390.1172; val_gene_expr_recon_loss: 19947080.2500; val_masked_gp_l1_reg_loss: 63467.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87561.0078; val_chrom_access_recon_loss: 4454806.6250; val_global_loss: 25217335.5000; val_optim_loss: 25217335.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9271; val_auprc_score: 0.9070; val_best_acc_score: 0.8614; val_best_f1_score: 0.8703; train_kl_reg_loss: 64492.0881; train_edge_recon_loss: 597185.3153; train_gene_expr_recon_loss: 19781072.4545; train_masked_gp_l1_reg_loss: 63831.7834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87014.4819; train_chrom_access_recon_loss: 4429926.5682; train_global_loss: 25023522.9091; train_optim_loss: 25023522.9091; val_kl_reg_loss: 63247.2935; val_edge_recon_loss: 602535.7578; val_gene_expr_recon_loss: 19899744.2500; val_masked_gp_l1_reg_loss: 64215.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86890.6641; val_chrom_access_recon_loss: 4427051.5625; val_global_loss: 25143685.2500; val_optim_loss: 25143685.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9292; val_auprc_score: 0.9074; val_best_acc_score: 0.8702; val_best_f1_score: 0.8776; train_kl_reg_loss: 63125.8620; train_edge_recon_loss: 595113.8930; train_gene_expr_recon_loss: 19729441.9394; train_masked_gp_l1_reg_loss: 64577.5750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85693.6731; train_chrom_access_recon_loss: 4414810.4280; train_global_loss: 24952763.2727; train_optim_loss: 24952763.2727; val_kl_reg_loss: 63193.3521; val_edge_recon_loss: 599987.2422; val_gene_expr_recon_loss: 20118407.5000; val_masked_gp_l1_reg_loss: 65026.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84742.6953; val_chrom_access_recon_loss: 4492173.1250; val_global_loss: 25423529.2500; val_optim_loss: 25423529.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9290; val_auprc_score: 0.9072; val_best_acc_score: 0.8641; val_best_f1_score: 0.8720; train_kl_reg_loss: 62135.9892; train_edge_recon_loss: 594586.4091; train_gene_expr_recon_loss: 19657922.1212; train_masked_gp_l1_reg_loss: 65400.2922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83894.0907; train_chrom_access_recon_loss: 4396942.3333; train_global_loss: 24860881.1515; train_optim_loss: 24860881.1515; val_kl_reg_loss: 62348.5737; val_edge_recon_loss: 603142.7656; val_gene_expr_recon_loss: 20037598.7500; val_masked_gp_l1_reg_loss: 65753.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83737.2344; val_chrom_access_recon_loss: 4422660.8750; val_global_loss: 25275243.0000; val_optim_loss: 25275243.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9325; val_auprc_score: 0.9095; val_best_acc_score: 0.8721; val_best_f1_score: 0.8773; train_kl_reg_loss: 62353.3704; train_edge_recon_loss: 589121.5502; train_gene_expr_recon_loss: 19627384.4848; train_masked_gp_l1_reg_loss: 65259.7242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65811.9771; train_chrom_access_recon_loss: 4384534.6023; train_global_loss: 24794465.6364; train_optim_loss: 24794465.6364; val_kl_reg_loss: 62766.2754; val_edge_recon_loss: 597364.4375; val_gene_expr_recon_loss: 19800660.2500; val_masked_gp_l1_reg_loss: 64948.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59882.5391; val_chrom_access_recon_loss: 4396000.1875; val_global_loss: 24981621.0000; val_optim_loss: 24981621.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9422; val_auprc_score: 0.9264; val_best_acc_score: 0.8821; val_best_f1_score: 0.8872; train_kl_reg_loss: 62540.1641; train_edge_recon_loss: 590129.0246; train_gene_expr_recon_loss: 19624802.5455; train_masked_gp_l1_reg_loss: 64903.5468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59137.9583; train_chrom_access_recon_loss: 4383492.5455; train_global_loss: 24785005.7576; train_optim_loss: 24785005.7576; val_kl_reg_loss: 63078.1880; val_edge_recon_loss: 583271.6797; val_gene_expr_recon_loss: 19931185.2500; val_masked_gp_l1_reg_loss: 64872.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58691.4180; val_chrom_access_recon_loss: 4409117.2500; val_global_loss: 25110216.0000; val_optim_loss: 25110216.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9398; val_auprc_score: 0.9239; val_best_acc_score: 0.8783; val_best_f1_score: 0.8849; train_kl_reg_loss: 62926.5954; train_edge_recon_loss: 587929.7405; train_gene_expr_recon_loss: 19618517.9697; train_masked_gp_l1_reg_loss: 64883.2189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58346.1886; train_chrom_access_recon_loss: 4383037.6212; train_global_loss: 24775641.3030; train_optim_loss: 24775641.3030; val_kl_reg_loss: 63439.3506; val_edge_recon_loss: 587983.2891; val_gene_expr_recon_loss: 19814481.7500; val_masked_gp_l1_reg_loss: 64892.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58146.7656; val_chrom_access_recon_loss: 4419143.5625; val_global_loss: 25008086.5000; val_optim_loss: 25008086.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9323; val_auprc_score: 0.9078; val_best_acc_score: 0.8740; val_best_f1_score: 0.8794; train_kl_reg_loss: 63064.1006; train_edge_recon_loss: 588977.8210; train_gene_expr_recon_loss: 19601831.9091; train_masked_gp_l1_reg_loss: 64918.4747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57903.0261; train_chrom_access_recon_loss: 4374979.0606; train_global_loss: 24751674.5152; train_optim_loss: 24751674.5152; val_kl_reg_loss: 63411.4497; val_edge_recon_loss: 591550.6484; val_gene_expr_recon_loss: 19816385.0000; val_masked_gp_l1_reg_loss: 64942.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57721.3711; val_chrom_access_recon_loss: 4382423.0625; val_global_loss: 24976434.2500; val_optim_loss: 24976434.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9335; val_auprc_score: 0.9147; val_best_acc_score: 0.8705; val_best_f1_score: 0.8763; train_kl_reg_loss: 63138.1993; train_edge_recon_loss: 587201.6922; train_gene_expr_recon_loss: 19620516.3939; train_masked_gp_l1_reg_loss: 64974.4957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57499.4549; train_chrom_access_recon_loss: 4383847.4659; train_global_loss: 24777177.5455; train_optim_loss: 24777177.5455; val_kl_reg_loss: 63674.6953; val_edge_recon_loss: 597149.3516; val_gene_expr_recon_loss: 19667127.0000; val_masked_gp_l1_reg_loss: 65007.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57280.1367; val_chrom_access_recon_loss: 4369125.4375; val_global_loss: 24819364.5000; val_optim_loss: 24819364.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9328; val_auprc_score: 0.9120; val_best_acc_score: 0.8732; val_best_f1_score: 0.8788; train_kl_reg_loss: 63057.9975; train_edge_recon_loss: 586852.1487; train_gene_expr_recon_loss: 19594239.4848; train_masked_gp_l1_reg_loss: 65043.3313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57060.4267; train_chrom_access_recon_loss: 4376585.8333; train_global_loss: 24742839.4242; train_optim_loss: 24742839.4242; val_kl_reg_loss: 63870.7759; val_edge_recon_loss: 590917.2969; val_gene_expr_recon_loss: 19918967.2500; val_masked_gp_l1_reg_loss: 65085.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56927.4062; val_chrom_access_recon_loss: 4440293.2500; val_global_loss: 25136062.7500; val_optim_loss: 25136062.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9394; val_auprc_score: 0.9193; val_best_acc_score: 0.8778; val_best_f1_score: 0.8826; train_kl_reg_loss: 63173.2762; train_edge_recon_loss: 588149.6544; train_gene_expr_recon_loss: 19599517.0909; train_masked_gp_l1_reg_loss: 65110.7128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56671.8879; train_chrom_access_recon_loss: 4375321.8636; train_global_loss: 24747944.6667; train_optim_loss: 24747944.6667; val_kl_reg_loss: 63855.5552; val_edge_recon_loss: 590368.5391; val_gene_expr_recon_loss: 19921649.5000; val_masked_gp_l1_reg_loss: 65138.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56549.0586; val_chrom_access_recon_loss: 4419671.8125; val_global_loss: 25117233.2500; val_optim_loss: 25117233.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9260; val_auprc_score: 0.9052; val_best_acc_score: 0.8611; val_best_f1_score: 0.8715; train_kl_reg_loss: 63821.2479; train_edge_recon_loss: 704491.2794; train_gene_expr_recon_loss: 18598995.7273; train_masked_gp_l1_reg_loss: 65156.8743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54737.9195; train_chrom_access_recon_loss: 4543625.9735; train_global_loss: 24030828.9697; train_optim_loss: 24030828.9697; val_kl_reg_loss: 30379.2793; val_edge_recon_loss: 721100.8047; val_gene_expr_recon_loss: 18654859.5000; val_masked_gp_l1_reg_loss: 65170.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54102.3320; val_chrom_access_recon_loss: 4284431.9375; val_global_loss: 23810043.5000; val_optim_loss: 23810043.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9284; val_auprc_score: 0.9110; val_best_acc_score: 0.8678; val_best_f1_score: 0.8754; train_kl_reg_loss: 63112.7414; train_edge_recon_loss: 690337.7794; train_gene_expr_recon_loss: 18462920.6061; train_masked_gp_l1_reg_loss: 65095.4270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54091.0931; train_chrom_access_recon_loss: 4214616.4735; train_global_loss: 23550173.9091; train_optim_loss: 23550173.9091; val_kl_reg_loss: 29381.7559; val_edge_recon_loss: 719542.4219; val_gene_expr_recon_loss: 18560003.7500; val_masked_gp_l1_reg_loss: 65003.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53951.3867; val_chrom_access_recon_loss: 4224823.2812; val_global_loss: 23652707.7500; val_optim_loss: 23652707.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9249; val_auprc_score: 0.8978; val_best_acc_score: 0.8673; val_best_f1_score: 0.8763; train_kl_reg_loss: 59787.0041; train_edge_recon_loss: 688822.7708; train_gene_expr_recon_loss: 18438787.8182; train_masked_gp_l1_reg_loss: 64912.9531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53814.2520; train_chrom_access_recon_loss: 4181450.0985; train_global_loss: 23487574.9697; train_optim_loss: 23487574.9697; val_kl_reg_loss: 28335.2439; val_edge_recon_loss: 713200.7656; val_gene_expr_recon_loss: 18560156.2500; val_masked_gp_l1_reg_loss: 64819.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53658.7812; val_chrom_access_recon_loss: 4169681.7500; val_global_loss: 23589852.5000; val_optim_loss: 23589852.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9320; val_auprc_score: 0.9185; val_best_acc_score: 0.8643; val_best_f1_score: 0.8726; train_kl_reg_loss: 57676.6498; train_edge_recon_loss: 685643.3684; train_gene_expr_recon_loss: 18414297.6061; train_masked_gp_l1_reg_loss: 64729.6603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53489.2216; train_chrom_access_recon_loss: 4167047.8674; train_global_loss: 23442884.4545; train_optim_loss: 23442884.4545; val_kl_reg_loss: 28553.5610; val_edge_recon_loss: 708712.9141; val_gene_expr_recon_loss: 18550989.7500; val_masked_gp_l1_reg_loss: 64642.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53240.8086; val_chrom_access_recon_loss: 4164605.4688; val_global_loss: 23570743.5000; val_optim_loss: 23570743.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9344; val_auprc_score: 0.9207; val_best_acc_score: 0.8721; val_best_f1_score: 0.8783; train_kl_reg_loss: 56163.1246; train_edge_recon_loss: 681895.5739; train_gene_expr_recon_loss: 18396665.7879; train_masked_gp_l1_reg_loss: 64530.6096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52986.6016; train_chrom_access_recon_loss: 4159212.2841; train_global_loss: 23411454.0909; train_optim_loss: 23411454.0909; val_kl_reg_loss: 28284.5818; val_edge_recon_loss: 696747.4922; val_gene_expr_recon_loss: 18665857.5000; val_masked_gp_l1_reg_loss: 64433.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52774.5078; val_chrom_access_recon_loss: 4182326.2500; val_global_loss: 23690423.7500; val_optim_loss: 23690423.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9243; val_auprc_score: 0.9022; val_best_acc_score: 0.8619; val_best_f1_score: 0.8686; train_kl_reg_loss: 54413.1433; train_edge_recon_loss: 677146.9631; train_gene_expr_recon_loss: 18394415.0000; train_masked_gp_l1_reg_loss: 64332.1766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52556.7080; train_chrom_access_recon_loss: 4155292.4621; train_global_loss: 23398156.4848; train_optim_loss: 23398156.4848; val_kl_reg_loss: 27672.2649; val_edge_recon_loss: 694170.7656; val_gene_expr_recon_loss: 18426882.2500; val_masked_gp_l1_reg_loss: 64221.7617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52295.0195; val_chrom_access_recon_loss: 4140200.6562; val_global_loss: 23405443.5000; val_optim_loss: 23405443.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9305; val_auprc_score: 0.9117; val_best_acc_score: 0.8684; val_best_f1_score: 0.8760; train_kl_reg_loss: 53268.7119; train_edge_recon_loss: 671103.0653; train_gene_expr_recon_loss: 18389828.0606; train_masked_gp_l1_reg_loss: 64132.0906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52051.8428; train_chrom_access_recon_loss: 4155656.8447; train_global_loss: 23386040.5758; train_optim_loss: 23386040.5758; val_kl_reg_loss: 28275.8445; val_edge_recon_loss: 679538.9531; val_gene_expr_recon_loss: 18591564.0000; val_masked_gp_l1_reg_loss: 64015.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51807.6719; val_chrom_access_recon_loss: 4129588.6562; val_global_loss: 23544791.2500; val_optim_loss: 23544791.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9222; val_auprc_score: 0.9018; val_best_acc_score: 0.8549; val_best_f1_score: 0.8651; train_kl_reg_loss: 52031.5965; train_edge_recon_loss: 665474.0947; train_gene_expr_recon_loss: 18376836.8182; train_masked_gp_l1_reg_loss: 63920.8787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51590.5163; train_chrom_access_recon_loss: 4149225.6477; train_global_loss: 23359079.2727; train_optim_loss: 23359079.2727; val_kl_reg_loss: 27421.0657; val_edge_recon_loss: 679785.6328; val_gene_expr_recon_loss: 18425873.7500; val_masked_gp_l1_reg_loss: 63815.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51324.4336; val_chrom_access_recon_loss: 4136808.4688; val_global_loss: 23385028.5000; val_optim_loss: 23385028.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9270; val_auprc_score: 0.9127; val_best_acc_score: 0.8611; val_best_f1_score: 0.8694; train_kl_reg_loss: 50964.1281; train_edge_recon_loss: 660881.2576; train_gene_expr_recon_loss: 18375560.6970; train_masked_gp_l1_reg_loss: 63721.3990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51101.4422; train_chrom_access_recon_loss: 4149514.7273; train_global_loss: 23351743.9091; train_optim_loss: 23351743.9091; val_kl_reg_loss: 28437.7327; val_edge_recon_loss: 666954.2031; val_gene_expr_recon_loss: 18695537.5000; val_masked_gp_l1_reg_loss: 63618.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50869.1875; val_chrom_access_recon_loss: 4214227.3750; val_global_loss: 23719644.7500; val_optim_loss: 23719644.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9281; val_auprc_score: 0.9114; val_best_acc_score: 0.8627; val_best_f1_score: 0.8705; train_kl_reg_loss: 49891.9529; train_edge_recon_loss: 653787.5066; train_gene_expr_recon_loss: 18373670.5758; train_masked_gp_l1_reg_loss: 63521.2920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50665.3332; train_chrom_access_recon_loss: 4147072.9091; train_global_loss: 23338609.6061; train_optim_loss: 23338609.6061; val_kl_reg_loss: 28686.3276; val_edge_recon_loss: 656288.2656; val_gene_expr_recon_loss: 18616097.7500; val_masked_gp_l1_reg_loss: 63431.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50422.2656; val_chrom_access_recon_loss: 4165280.0938; val_global_loss: 23580206.2500; val_optim_loss: 23580206.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9286; val_auprc_score: 0.9127; val_best_acc_score: 0.8603; val_best_f1_score: 0.8681; train_kl_reg_loss: 49110.4856; train_edge_recon_loss: 645700.1307; train_gene_expr_recon_loss: 18360648.0606; train_masked_gp_l1_reg_loss: 63338.6802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50193.8187; train_chrom_access_recon_loss: 4144151.8750; train_global_loss: 23313142.9091; train_optim_loss: 23313142.9091; val_kl_reg_loss: 29316.3215; val_edge_recon_loss: 650153.1719; val_gene_expr_recon_loss: 18589552.5000; val_masked_gp_l1_reg_loss: 63248.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50008.1250; val_chrom_access_recon_loss: 4152403.6875; val_global_loss: 23534681.5000; val_optim_loss: 23534681.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9221; val_auprc_score: 0.9060; val_best_acc_score: 0.8552; val_best_f1_score: 0.8630; train_kl_reg_loss: 48478.1795; train_edge_recon_loss: 639849.5852; train_gene_expr_recon_loss: 18355860.0303; train_masked_gp_l1_reg_loss: 63165.6402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49824.9759; train_chrom_access_recon_loss: 4143986.6288; train_global_loss: 23301165.0303; train_optim_loss: 23301165.0303; val_kl_reg_loss: 31082.2278; val_edge_recon_loss: 637628.3125; val_gene_expr_recon_loss: 18722268.7500; val_masked_gp_l1_reg_loss: 63073.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49638.6875; val_chrom_access_recon_loss: 4196325.4688; val_global_loss: 23700016.7500; val_optim_loss: 23700016.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9198; val_auprc_score: 0.9011; val_best_acc_score: 0.8503; val_best_f1_score: 0.8590; train_kl_reg_loss: 48163.3438; train_edge_recon_loss: 634066.2699; train_gene_expr_recon_loss: 18343168.5758; train_masked_gp_l1_reg_loss: 63042.0446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48789.3570; train_chrom_access_recon_loss: 4138771.8258; train_global_loss: 23276001.4848; train_optim_loss: 23276001.4848; val_kl_reg_loss: 30926.7883; val_edge_recon_loss: 641875.4297; val_gene_expr_recon_loss: 18691315.7500; val_masked_gp_l1_reg_loss: 63017.4023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48607.2266; val_chrom_access_recon_loss: 4180322.4062; val_global_loss: 23656066.5000; val_optim_loss: 23656066.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9289; val_auprc_score: 0.9161; val_best_acc_score: 0.8544; val_best_f1_score: 0.8620; train_kl_reg_loss: 48185.8718; train_edge_recon_loss: 633317.9593; train_gene_expr_recon_loss: 18336403.2727; train_masked_gp_l1_reg_loss: 63001.2062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48567.3973; train_chrom_access_recon_loss: 4135675.9659; train_global_loss: 23265152.0606; train_optim_loss: 23265152.0606; val_kl_reg_loss: 31049.6277; val_edge_recon_loss: 643823.9219; val_gene_expr_recon_loss: 18499464.0000; val_masked_gp_l1_reg_loss: 62986.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48532.9414; val_chrom_access_recon_loss: 4134678.1562; val_global_loss: 23420534.0000; val_optim_loss: 23420534.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9150; val_auprc_score: 0.8912; val_best_acc_score: 0.8463; val_best_f1_score: 0.8563; train_kl_reg_loss: 48196.3554; train_edge_recon_loss: 631768.9498; train_gene_expr_recon_loss: 18338401.6970; train_masked_gp_l1_reg_loss: 62973.8154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48501.2234; train_chrom_access_recon_loss: 4137709.8485; train_global_loss: 23267551.8485; train_optim_loss: 23267551.8485; val_kl_reg_loss: 30961.2893; val_edge_recon_loss: 642396.8594; val_gene_expr_recon_loss: 18303700.5000; val_masked_gp_l1_reg_loss: 62961.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48468.2891; val_chrom_access_recon_loss: 4119965.5000; val_global_loss: 23208454.0000; val_optim_loss: 23208454.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9241; val_auprc_score: 0.9072; val_best_acc_score: 0.8579; val_best_f1_score: 0.8652; train_kl_reg_loss: 48188.7931; train_edge_recon_loss: 629767.9356; train_gene_expr_recon_loss: 18354038.4545; train_masked_gp_l1_reg_loss: 62950.9579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48440.4483; train_chrom_access_recon_loss: 4135884.3788; train_global_loss: 23279271.0303; train_optim_loss: 23279271.0303; val_kl_reg_loss: 31293.2834; val_edge_recon_loss: 636588.9375; val_gene_expr_recon_loss: 18494622.7500; val_masked_gp_l1_reg_loss: 62939.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48412.8555; val_chrom_access_recon_loss: 4154440.3438; val_global_loss: 23428297.5000; val_optim_loss: 23428297.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9278; val_auprc_score: 0.9066; val_best_acc_score: 0.8667; val_best_f1_score: 0.8748; train_kl_reg_loss: 48154.9674; train_edge_recon_loss: 630909.1269; train_gene_expr_recon_loss: 18340438.3939; train_masked_gp_l1_reg_loss: 62928.4990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48388.3133; train_chrom_access_recon_loss: 4135947.7197; train_global_loss: 23266766.7879; train_optim_loss: 23266766.7879; val_kl_reg_loss: 31574.0056; val_edge_recon_loss: 631331.1875; val_gene_expr_recon_loss: 18421027.5000; val_masked_gp_l1_reg_loss: 62917.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48363.7266; val_chrom_access_recon_loss: 4140820.0938; val_global_loss: 23336034.0000; val_optim_loss: 23336034.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9290; val_auprc_score: 0.9155; val_best_acc_score: 0.8622; val_best_f1_score: 0.8686; train_kl_reg_loss: 48163.5510; train_edge_recon_loss: 629918.0729; train_gene_expr_recon_loss: 18344447.0303; train_masked_gp_l1_reg_loss: 62907.4732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48335.8926; train_chrom_access_recon_loss: 4140656.2311; train_global_loss: 23274428.2424; train_optim_loss: 23274428.2424; val_kl_reg_loss: 31491.9207; val_edge_recon_loss: 632454.0312; val_gene_expr_recon_loss: 18543578.2500; val_masked_gp_l1_reg_loss: 62896.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48309.7422; val_chrom_access_recon_loss: 4148556.9062; val_global_loss: 23467286.5000; val_optim_loss: 23467286.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9248; val_auprc_score: 0.9048; val_best_acc_score: 0.8611; val_best_f1_score: 0.8680; train_kl_reg_loss: 48149.1283; train_edge_recon_loss: 629774.9091; train_gene_expr_recon_loss: 18346181.0606; train_masked_gp_l1_reg_loss: 62884.7388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48287.0927; train_chrom_access_recon_loss: 4136702.7576; train_global_loss: 23271979.5758; train_optim_loss: 23271979.5758; val_kl_reg_loss: 31749.4480; val_edge_recon_loss: 633232.9062; val_gene_expr_recon_loss: 18645947.0000; val_masked_gp_l1_reg_loss: 62874.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48261.0156; val_chrom_access_recon_loss: 4198394.1562; val_global_loss: 23620459.2500; val_optim_loss: 23620459.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9285; val_auprc_score: 0.9087; val_best_acc_score: 0.8600; val_best_f1_score: 0.8690; train_kl_reg_loss: 48170.0687; train_edge_recon_loss: 629362.1544; train_gene_expr_recon_loss: 18346396.1212; train_masked_gp_l1_reg_loss: 62870.9272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48170.8700; train_chrom_access_recon_loss: 4136603.4886; train_global_loss: 23271573.4242; train_optim_loss: 23271573.4242; val_kl_reg_loss: 31955.2666; val_edge_recon_loss: 632670.3359; val_gene_expr_recon_loss: 18756382.2500; val_masked_gp_l1_reg_loss: 62868.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48152.0703; val_chrom_access_recon_loss: 4215738.1562; val_global_loss: 23747766.0000; val_optim_loss: 23747766.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9268; val_auprc_score: 0.9134; val_best_acc_score: 0.8584; val_best_f1_score: 0.8655; train_kl_reg_loss: 48187.5682; train_edge_recon_loss: 626798.1080; train_gene_expr_recon_loss: 18340987.2121; train_masked_gp_l1_reg_loss: 62866.7263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48148.3519; train_chrom_access_recon_loss: 4134641.3826; train_global_loss: 23261629.5455; train_optim_loss: 23261629.5455; val_kl_reg_loss: 31792.4543; val_edge_recon_loss: 632590.4297; val_gene_expr_recon_loss: 18654519.5000; val_masked_gp_l1_reg_loss: 62864.9961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48145.1016; val_chrom_access_recon_loss: 4224291.0312; val_global_loss: 23654203.7500; val_optim_loss: 23654203.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9275; val_auprc_score: 0.9129; val_best_acc_score: 0.8608; val_best_f1_score: 0.8675; train_kl_reg_loss: 48197.9525; train_edge_recon_loss: 628770.1723; train_gene_expr_recon_loss: 18359597.9697; train_masked_gp_l1_reg_loss: 62863.6155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48142.2388; train_chrom_access_recon_loss: 4143611.7197; train_global_loss: 23291183.5758; train_optim_loss: 23291183.5758; val_kl_reg_loss: 31829.5410; val_edge_recon_loss: 634634.5547; val_gene_expr_recon_loss: 18454876.7500; val_masked_gp_l1_reg_loss: 62862.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48138.8984; val_chrom_access_recon_loss: 4169318.3750; val_global_loss: 23401659.0000; val_optim_loss: 23401659.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9221; val_auprc_score: 0.9010; val_best_acc_score: 0.8571; val_best_f1_score: 0.8645; train_kl_reg_loss: 48222.2282; train_edge_recon_loss: 626769.9261; train_gene_expr_recon_loss: 18356776.0909; train_masked_gp_l1_reg_loss: 62860.7364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48136.2419; train_chrom_access_recon_loss: 4140732.3485; train_global_loss: 23283497.4848; train_optim_loss: 23283497.4848; val_kl_reg_loss: 31722.6453; val_edge_recon_loss: 635233.1641; val_gene_expr_recon_loss: 18463403.5000; val_masked_gp_l1_reg_loss: 62859.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48133.4453; val_chrom_access_recon_loss: 4179206.9375; val_global_loss: 23420560.2500; val_optim_loss: 23420560.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 1 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9236
val AUPRC score: 0.9026
val best accuracy score: 0.8584
val best F1 score: 0.8668
val target rna MSE score: 1.7086
val source rna MSE score: 1.1909
val target atac MSE score: 0.4829
val source atac MSE score: 0.2050
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
