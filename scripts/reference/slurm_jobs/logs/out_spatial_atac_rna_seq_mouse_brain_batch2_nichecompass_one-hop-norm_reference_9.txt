[True]
Run timestamp: 24072023_161000_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9009; val_auprc_score: 0.9111; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 9740.0592; train_edge_recon_loss: 354238.3611; train_gene_expr_recon_loss: 324357.1493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 108358224.0000; train_global_loss: 109046559.1111; train_optim_loss: 109046559.1111; val_kl_reg_loss: 17438.6758; val_edge_recon_loss: 406591.2812; val_gene_expr_recon_loss: 306526.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 106104272.0000; val_global_loss: 106834832.0000; val_optim_loss: 106834832.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8768; val_auprc_score: 0.8798; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 28567.8088; train_edge_recon_loss: 376399.1458; train_gene_expr_recon_loss: 302842.4410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 106638633.7778; train_global_loss: 107346444.4444; train_optim_loss: 107346444.4444; val_kl_reg_loss: 37040.7891; val_edge_recon_loss: 406589.7812; val_gene_expr_recon_loss: 279066.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 103715200.0000; val_global_loss: 104437896.0000; val_optim_loss: 104437896.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8503; val_auprc_score: 0.8495; val_best_acc_score: 0.5009; val_best_f1_score: 0.6671; train_kl_reg_loss: 42902.8346; train_edge_recon_loss: 387300.3611; train_gene_expr_recon_loss: 273046.4149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102919009.7778; train_global_loss: 103622258.6667; train_optim_loss: 103622258.6667; val_kl_reg_loss: 52068.7812; val_edge_recon_loss: 406566.9375; val_gene_expr_recon_loss: 256051.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101693200.0000; val_global_loss: 102407888.0000; val_optim_loss: 102407888.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8462; val_auprc_score: 0.8461; val_best_acc_score: 0.5018; val_best_f1_score: 0.6674; train_kl_reg_loss: 62520.6437; train_edge_recon_loss: 396666.6111; train_gene_expr_recon_loss: 253413.3472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101156693.3333; train_global_loss: 101869293.3333; train_optim_loss: 101869293.3333; val_kl_reg_loss: 74510.3906; val_edge_recon_loss: 406580.0312; val_gene_expr_recon_loss: 242635.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100293816.0000; val_global_loss: 101017544.0000; val_optim_loss: 101017544.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8546; val_auprc_score: 0.8512; val_best_acc_score: 0.5019; val_best_f1_score: 0.6675; train_kl_reg_loss: 86564.6693; train_edge_recon_loss: 402236.0208; train_gene_expr_recon_loss: 241532.1024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99879995.5556; train_global_loss: 100610328.0000; train_optim_loss: 100610328.0000; val_kl_reg_loss: 96753.8203; val_edge_recon_loss: 406575.1562; val_gene_expr_recon_loss: 232389.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98916360.0000; val_global_loss: 99652080.0000; val_optim_loss: 99652080.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8690; val_auprc_score: 0.8607; val_best_acc_score: 0.5022; val_best_f1_score: 0.6676; train_kl_reg_loss: 107335.5069; train_edge_recon_loss: 403986.0486; train_gene_expr_recon_loss: 232238.9878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99303136.0000; train_global_loss: 100046696.8889; train_optim_loss: 100046696.8889; val_kl_reg_loss: 109409.7500; val_edge_recon_loss: 406548.7188; val_gene_expr_recon_loss: 226622.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98200920.0000; val_global_loss: 98943504.0000; val_optim_loss: 98943504.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8759; val_auprc_score: 0.8654; val_best_acc_score: 0.5022; val_best_f1_score: 0.6674; train_kl_reg_loss: 116231.8707; train_edge_recon_loss: 404615.7917; train_gene_expr_recon_loss: 227163.4080; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98165093.3333; train_global_loss: 98913104.0000; train_optim_loss: 98913104.0000; val_kl_reg_loss: 116532.4531; val_edge_recon_loss: 406499.9688; val_gene_expr_recon_loss: 221626.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97618048.0000; val_global_loss: 98362704.0000; val_optim_loss: 98362704.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8675; val_auprc_score: 0.8582; val_best_acc_score: 0.5115; val_best_f1_score: 0.6716; train_kl_reg_loss: 124434.7969; train_edge_recon_loss: 404628.8299; train_gene_expr_recon_loss: 223383.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97867368.0000; train_global_loss: 98619815.1111; train_optim_loss: 98619815.1111; val_kl_reg_loss: 123825.5469; val_edge_recon_loss: 406426.1562; val_gene_expr_recon_loss: 217880.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97450712.0000; val_global_loss: 98198840.0000; val_optim_loss: 98198840.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8564; val_auprc_score: 0.8507; val_best_acc_score: 0.5271; val_best_f1_score: 0.6786; train_kl_reg_loss: 128582.5668; train_edge_recon_loss: 404767.5764; train_gene_expr_recon_loss: 218793.1528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97443324.4444; train_global_loss: 98195467.5556; train_optim_loss: 98195467.5556; val_kl_reg_loss: 124871.5156; val_edge_recon_loss: 406351.8438; val_gene_expr_recon_loss: 215227.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97224064.0000; val_global_loss: 97970512.0000; val_optim_loss: 97970512.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8711; val_auprc_score: 0.8633; val_best_acc_score: 0.5602; val_best_f1_score: 0.6939; train_kl_reg_loss: 129484.7561; train_edge_recon_loss: 404667.5833; train_gene_expr_recon_loss: 215837.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96714936.8889; train_global_loss: 97464927.1111; train_optim_loss: 97464927.1111; val_kl_reg_loss: 125504.2656; val_edge_recon_loss: 406214.2188; val_gene_expr_recon_loss: 213345.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96971584.0000; val_global_loss: 97716648.0000; val_optim_loss: 97716648.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8747; val_auprc_score: 0.8631; val_best_acc_score: 0.6013; val_best_f1_score: 0.7136; train_kl_reg_loss: 132769.0642; train_edge_recon_loss: 404170.0660; train_gene_expr_recon_loss: 215683.7674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97532011.5556; train_global_loss: 98284634.6667; train_optim_loss: 98284634.6667; val_kl_reg_loss: 124464.1094; val_edge_recon_loss: 406024.8438; val_gene_expr_recon_loss: 212033.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96719240.0000; val_global_loss: 97461760.0000; val_optim_loss: 97461760.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8820; val_auprc_score: 0.8738; val_best_acc_score: 0.6620; val_best_f1_score: 0.7449; train_kl_reg_loss: 131253.4679; train_edge_recon_loss: 404304.0139; train_gene_expr_recon_loss: 213528.0365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97069422.2222; train_global_loss: 97818509.3333; train_optim_loss: 97818509.3333; val_kl_reg_loss: 124273.1562; val_edge_recon_loss: 405742.5000; val_gene_expr_recon_loss: 211130.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96564448.0000; val_global_loss: 97305592.0000; val_optim_loss: 97305592.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8875; val_auprc_score: 0.8719; val_best_acc_score: 0.7237; val_best_f1_score: 0.7786; train_kl_reg_loss: 132454.8828; train_edge_recon_loss: 403997.7708; train_gene_expr_recon_loss: 214008.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96966453.3333; train_global_loss: 97716915.5556; train_optim_loss: 97716915.5556; val_kl_reg_loss: 123366.0469; val_edge_recon_loss: 405336.4375; val_gene_expr_recon_loss: 210394.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96535128.0000; val_global_loss: 97274224.0000; val_optim_loss: 97274224.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8919; val_auprc_score: 0.8772; val_best_acc_score: 0.7820; val_best_f1_score: 0.8126; train_kl_reg_loss: 130084.8168; train_edge_recon_loss: 403501.7847; train_gene_expr_recon_loss: 212400.0191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96145401.7778; train_global_loss: 96891388.4444; train_optim_loss: 96891388.4444; val_kl_reg_loss: 122943.5703; val_edge_recon_loss: 404631.4688; val_gene_expr_recon_loss: 209715.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96428856.0000; val_global_loss: 97166144.0000; val_optim_loss: 97166144.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8940; val_auprc_score: 0.8801; val_best_acc_score: 0.7959; val_best_f1_score: 0.8180; train_kl_reg_loss: 128999.6293; train_edge_recon_loss: 402651.5104; train_gene_expr_recon_loss: 212126.1806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96337216.0000; train_global_loss: 97080993.7778; train_optim_loss: 97080993.7778; val_kl_reg_loss: 122394.5625; val_edge_recon_loss: 403746.5938; val_gene_expr_recon_loss: 209027.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96276720.0000; val_global_loss: 97011888.0000; val_optim_loss: 97011888.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8942; val_auprc_score: 0.8755; val_best_acc_score: 0.8104; val_best_f1_score: 0.8232; train_kl_reg_loss: 128248.7023; train_edge_recon_loss: 401468.2986; train_gene_expr_recon_loss: 211767.2743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96916280.0000; train_global_loss: 97657765.3333; train_optim_loss: 97657765.3333; val_kl_reg_loss: 121030.7578; val_edge_recon_loss: 402351.2188; val_gene_expr_recon_loss: 208830.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96294720.0000; val_global_loss: 97026936.0000; val_optim_loss: 97026936.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8947; val_auprc_score: 0.8807; val_best_acc_score: 0.8107; val_best_f1_score: 0.8166; train_kl_reg_loss: 126817.6788; train_edge_recon_loss: 400217.9167; train_gene_expr_recon_loss: 211363.0920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96550799.1111; train_global_loss: 97289199.1111; train_optim_loss: 97289199.1111; val_kl_reg_loss: 118797.7500; val_edge_recon_loss: 400878.9688; val_gene_expr_recon_loss: 208190.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96041664.0000; val_global_loss: 96769528.0000; val_optim_loss: 96769528.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8933; val_auprc_score: 0.8796; val_best_acc_score: 0.8032; val_best_f1_score: 0.8039; train_kl_reg_loss: 126430.0599; train_edge_recon_loss: 398937.3924; train_gene_expr_recon_loss: 210474.7795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96132602.6667; train_global_loss: 96868444.4444; train_optim_loss: 96868444.4444; val_kl_reg_loss: 117616.6094; val_edge_recon_loss: 399062.4688; val_gene_expr_recon_loss: 208078.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96097776.0000; val_global_loss: 96822536.0000; val_optim_loss: 96822536.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8826; val_auprc_score: 0.8623; val_best_acc_score: 0.7926; val_best_f1_score: 0.7937; train_kl_reg_loss: 125022.6467; train_edge_recon_loss: 397315.0451; train_gene_expr_recon_loss: 210803.5243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96581244.4444; train_global_loss: 97314385.7778; train_optim_loss: 97314385.7778; val_kl_reg_loss: 114518.8906; val_edge_recon_loss: 397630.8125; val_gene_expr_recon_loss: 207575.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95831944.0000; val_global_loss: 96551672.0000; val_optim_loss: 96551672.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8965; val_auprc_score: 0.8802; val_best_acc_score: 0.8015; val_best_f1_score: 0.8088; train_kl_reg_loss: 124625.5599; train_edge_recon_loss: 395417.9722; train_gene_expr_recon_loss: 211665.3837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96381145.7778; train_global_loss: 97112855.1111; train_optim_loss: 97112855.1111; val_kl_reg_loss: 113425.7500; val_edge_recon_loss: 395130.1875; val_gene_expr_recon_loss: 207469.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95833096.0000; val_global_loss: 96549120.0000; val_optim_loss: 96549120.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8878; val_auprc_score: 0.8719; val_best_acc_score: 0.7859; val_best_f1_score: 0.8052; train_kl_reg_loss: 122594.4575; train_edge_recon_loss: 393229.1250; train_gene_expr_recon_loss: 210812.6701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96201614.2222; train_global_loss: 96928250.6667; train_optim_loss: 96928250.6667; val_kl_reg_loss: 117124.3750; val_edge_recon_loss: 393576.5000; val_gene_expr_recon_loss: 206628.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95723328.0000; val_global_loss: 96440656.0000; val_optim_loss: 96440656.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8944; val_auprc_score: 0.8792; val_best_acc_score: 0.7890; val_best_f1_score: 0.8181; train_kl_reg_loss: 123229.9227; train_edge_recon_loss: 390988.8924; train_gene_expr_recon_loss: 210492.8247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96105721.7778; train_global_loss: 96830434.6667; train_optim_loss: 96830434.6667; val_kl_reg_loss: 115969.1719; val_edge_recon_loss: 390634.5938; val_gene_expr_recon_loss: 206566.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95608280.0000; val_global_loss: 96321448.0000; val_optim_loss: 96321448.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8933; val_auprc_score: 0.8760; val_best_acc_score: 0.7917; val_best_f1_score: 0.8182; train_kl_reg_loss: 122808.8576; train_edge_recon_loss: 388969.8056; train_gene_expr_recon_loss: 209479.5347; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95803449.7778; train_global_loss: 96524707.5556; train_optim_loss: 96524707.5556; val_kl_reg_loss: 111439.8672; val_edge_recon_loss: 389058.5000; val_gene_expr_recon_loss: 206827.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95745976.0000; val_global_loss: 96453304.0000; val_optim_loss: 96453304.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8991; val_auprc_score: 0.8880; val_best_acc_score: 0.7971; val_best_f1_score: 0.8210; train_kl_reg_loss: 121095.9714; train_edge_recon_loss: 386519.9375; train_gene_expr_recon_loss: 208943.7726; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95644935.1111; train_global_loss: 96361496.0000; train_optim_loss: 96361496.0000; val_kl_reg_loss: 114636.5156; val_edge_recon_loss: 386428.4688; val_gene_expr_recon_loss: 206033.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95432728.0000; val_global_loss: 96139824.0000; val_optim_loss: 96139824.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8986; val_auprc_score: 0.8806; val_best_acc_score: 0.8049; val_best_f1_score: 0.8252; train_kl_reg_loss: 122241.9957; train_edge_recon_loss: 384641.2500; train_gene_expr_recon_loss: 208663.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95775232.0000; train_global_loss: 96490778.6667; train_optim_loss: 96490778.6667; val_kl_reg_loss: 115352.0625; val_edge_recon_loss: 384395.4375; val_gene_expr_recon_loss: 205883.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95479192.0000; val_global_loss: 96184824.0000; val_optim_loss: 96184824.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9073; val_auprc_score: 0.8915; val_best_acc_score: 0.8063; val_best_f1_score: 0.8238; train_kl_reg_loss: 123865.1155; train_edge_recon_loss: 394120.1111; train_gene_expr_recon_loss: 209097.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95557902.2222; train_global_loss: 96284983.1111; train_optim_loss: 96284983.1111; val_kl_reg_loss: 96752.5469; val_edge_recon_loss: 394754.0000; val_gene_expr_recon_loss: 207505.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95751968.0000; val_global_loss: 96450984.0000; val_optim_loss: 96450984.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9092; val_auprc_score: 0.8886; val_best_acc_score: 0.8033; val_best_f1_score: 0.8318; train_kl_reg_loss: 121874.9375; train_edge_recon_loss: 393237.4306; train_gene_expr_recon_loss: 211245.9358; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95981501.3333; train_global_loss: 96707860.4444; train_optim_loss: 96707860.4444; val_kl_reg_loss: 96918.6719; val_edge_recon_loss: 393855.5938; val_gene_expr_recon_loss: 207481.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95764088.0000; val_global_loss: 96462344.0000; val_optim_loss: 96462344.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9100; val_auprc_score: 0.8896; val_best_acc_score: 0.8060; val_best_f1_score: 0.8329; train_kl_reg_loss: 119322.0069; train_edge_recon_loss: 392732.2882; train_gene_expr_recon_loss: 210896.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96427642.6667; train_global_loss: 97150594.6667; train_optim_loss: 97150594.6667; val_kl_reg_loss: 92364.5781; val_edge_recon_loss: 392576.9688; val_gene_expr_recon_loss: 207204.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95659264.0000; val_global_loss: 96351408.0000; val_optim_loss: 96351408.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9084; val_auprc_score: 0.8883; val_best_acc_score: 0.8030; val_best_f1_score: 0.8312; train_kl_reg_loss: 114335.8073; train_edge_recon_loss: 391805.7812; train_gene_expr_recon_loss: 210936.3090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95926508.4444; train_global_loss: 96643586.6667; train_optim_loss: 96643586.6667; val_kl_reg_loss: 99113.3203; val_edge_recon_loss: 393048.4062; val_gene_expr_recon_loss: 206997.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95643992.0000; val_global_loss: 96343152.0000; val_optim_loss: 96343152.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9128; val_auprc_score: 0.8942; val_best_acc_score: 0.8069; val_best_f1_score: 0.8337; train_kl_reg_loss: 119063.9688; train_edge_recon_loss: 392120.5243; train_gene_expr_recon_loss: 209052.9045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95795116.4444; train_global_loss: 96515353.7778; train_optim_loss: 96515353.7778; val_kl_reg_loss: 97682.9297; val_edge_recon_loss: 392432.1875; val_gene_expr_recon_loss: 206830.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95626016.0000; val_global_loss: 96322960.0000; val_optim_loss: 96322960.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9074; val_auprc_score: 0.8897; val_best_acc_score: 0.8030; val_best_f1_score: 0.8309; train_kl_reg_loss: 115929.8576; train_edge_recon_loss: 391611.1493; train_gene_expr_recon_loss: 209717.5434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95526444.4444; train_global_loss: 96243703.1111; train_optim_loss: 96243703.1111; val_kl_reg_loss: 97504.5156; val_edge_recon_loss: 392470.1562; val_gene_expr_recon_loss: 206977.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95574520.0000; val_global_loss: 96271472.0000; val_optim_loss: 96271472.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9134; val_auprc_score: 0.8943; val_best_acc_score: 0.8098; val_best_f1_score: 0.8356; train_kl_reg_loss: 118152.7161; train_edge_recon_loss: 391306.8924; train_gene_expr_recon_loss: 209428.8038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95551279.1111; train_global_loss: 96270168.0000; train_optim_loss: 96270168.0000; val_kl_reg_loss: 99075.8672; val_edge_recon_loss: 392165.4375; val_gene_expr_recon_loss: 206771.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95544064.0000; val_global_loss: 96242080.0000; val_optim_loss: 96242080.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 10 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9055
Val AUPRC score: 0.8841
Val best accuracy score: 0.8044
Val best F1 score: 0.8217
Val gene expr MSE score: 0.4585
Val chrom access MSE score: 0.0864
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
