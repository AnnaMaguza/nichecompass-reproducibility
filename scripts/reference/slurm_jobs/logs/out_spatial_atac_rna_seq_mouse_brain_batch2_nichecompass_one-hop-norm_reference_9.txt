[True]
Run timestamp: 10082023_145555_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7386; val_auprc_score: 0.7663; val_best_acc_score: 0.6176; val_best_f1_score: 0.6990; train_kl_reg_loss: 97908.7011; train_edge_recon_loss: 3676781.8817; train_gene_expr_recon_loss: 15302168.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 33489657.1145; train_global_loss: 52566515.9389; train_optim_loss: 52566515.9389; val_kl_reg_loss: 197866.7344; val_edge_recon_loss: 4055626.4667; val_gene_expr_recon_loss: 12914055.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 31022926.4000; val_global_loss: 48190474.6667; val_optim_loss: 48190474.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7644; val_auprc_score: 0.7824; val_best_acc_score: 0.6799; val_best_f1_score: 0.7202; train_kl_reg_loss: 141525.3766; train_edge_recon_loss: 3582430.9427; train_gene_expr_recon_loss: 12818679.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 30994715.7405; train_global_loss: 47537350.9618; train_optim_loss: 47537350.9618; val_kl_reg_loss: 118871.7510; val_edge_recon_loss: 3912819.5500; val_gene_expr_recon_loss: 12495389.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 30431237.0667; val_global_loss: 46958317.6000; val_optim_loss: 46958317.6000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8329; val_auprc_score: 0.8329; val_best_acc_score: 0.7317; val_best_f1_score: 0.7735; train_kl_reg_loss: 139017.2493; train_edge_recon_loss: 3255612.7424; train_gene_expr_recon_loss: 12503663.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 30609959.8473; train_global_loss: 46508253.5267; train_optim_loss: 46508253.5267; val_kl_reg_loss: 158879.4750; val_edge_recon_loss: 3098123.9500; val_gene_expr_recon_loss: 12330135.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 30171692.4000; val_global_loss: 45758832.0000; val_optim_loss: 45758832.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8734; val_auprc_score: 0.8625; val_best_acc_score: 0.7825; val_best_f1_score: 0.8004; train_kl_reg_loss: 152362.6201; train_edge_recon_loss: 3014366.9103; train_gene_expr_recon_loss: 12326011.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 30320047.8015; train_global_loss: 45812788.4885; train_optim_loss: 45812788.4885; val_kl_reg_loss: 139835.0115; val_edge_recon_loss: 2976152.0333; val_gene_expr_recon_loss: 12188889.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29805204.1333; val_global_loss: 45110080.0000; val_optim_loss: 45110080.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8934; val_auprc_score: 0.8775; val_best_acc_score: 0.8124; val_best_f1_score: 0.8300; train_kl_reg_loss: 138507.0081; train_edge_recon_loss: 2951514.7328; train_gene_expr_recon_loss: 12182201.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 30041136.9160; train_global_loss: 45313360.2748; train_optim_loss: 45313360.2748; val_kl_reg_loss: 134538.6219; val_edge_recon_loss: 2918295.2667; val_gene_expr_recon_loss: 12059197.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29708050.9333; val_global_loss: 44820082.9333; val_optim_loss: 44820082.9333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9133; val_auprc_score: 0.8988; val_best_acc_score: 0.8380; val_best_f1_score: 0.8483; train_kl_reg_loss: 136299.6019; train_edge_recon_loss: 2876296.7156; train_gene_expr_recon_loss: 12065402.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29801936.8550; train_global_loss: 44879935.1450; train_optim_loss: 44879935.1450; val_kl_reg_loss: 135804.0219; val_edge_recon_loss: 2887702.3667; val_gene_expr_recon_loss: 11925474.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29391373.2000; val_global_loss: 44340354.1333; val_optim_loss: 44340354.1333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9308; val_auprc_score: 0.9157; val_best_acc_score: 0.8635; val_best_f1_score: 0.8717; train_kl_reg_loss: 131608.8033; train_edge_recon_loss: 2839827.8397; train_gene_expr_recon_loss: 11968518.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29570904.3817; train_global_loss: 44510859.1450; train_optim_loss: 44510859.1450; val_kl_reg_loss: 131613.5568; val_edge_recon_loss: 2827931.3167; val_gene_expr_recon_loss: 11811231.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29148097.7333; val_global_loss: 43918873.6000; val_optim_loss: 43918873.6000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9382; val_auprc_score: 0.9226; val_best_acc_score: 0.8771; val_best_f1_score: 0.8834; train_kl_reg_loss: 127424.8224; train_edge_recon_loss: 2809228.6126; train_gene_expr_recon_loss: 11867642.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29336020.8397; train_global_loss: 44140316.9771; train_optim_loss: 44140316.9771; val_kl_reg_loss: 122829.5953; val_edge_recon_loss: 2821337.6167; val_gene_expr_recon_loss: 11761455.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 29045392.5333; val_global_loss: 43751015.7333; val_optim_loss: 43751015.7333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9383; val_auprc_score: 0.9217; val_best_acc_score: 0.8773; val_best_f1_score: 0.8849; train_kl_reg_loss: 122119.8134; train_edge_recon_loss: 2796744.9771; train_gene_expr_recon_loss: 11786056.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29155057.8015; train_global_loss: 43859979.3282; train_optim_loss: 43859979.3282; val_kl_reg_loss: 119897.9786; val_edge_recon_loss: 2804592.5667; val_gene_expr_recon_loss: 11659010.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28828764.0000; val_global_loss: 43412264.8000; val_optim_loss: 43412264.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9484; val_auprc_score: 0.9361; val_best_acc_score: 0.8864; val_best_f1_score: 0.8923; train_kl_reg_loss: 118003.6633; train_edge_recon_loss: 2782601.7195; train_gene_expr_recon_loss: 11712916.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28983498.5344; train_global_loss: 43597020.2137; train_optim_loss: 43597020.2137; val_kl_reg_loss: 109484.2677; val_edge_recon_loss: 2793475.3167; val_gene_expr_recon_loss: 11585866.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28654758.4000; val_global_loss: 43143584.8000; val_optim_loss: 43143584.8000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9481; val_auprc_score: 0.9344; val_best_acc_score: 0.8890; val_best_f1_score: 0.8950; train_kl_reg_loss: 114573.1341; train_edge_recon_loss: 2766814.6985; train_gene_expr_recon_loss: 11647177.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28822663.6336; train_global_loss: 43351229.0382; train_optim_loss: 43351229.0382; val_kl_reg_loss: 115267.9359; val_edge_recon_loss: 2772839.5500; val_gene_expr_recon_loss: 11547507.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28578332.9333; val_global_loss: 43013948.0000; val_optim_loss: 43013948.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9555; val_auprc_score: 0.9439; val_best_acc_score: 0.8968; val_best_f1_score: 0.9016; train_kl_reg_loss: 111214.8166; train_edge_recon_loss: 2755665.8321; train_gene_expr_recon_loss: 11591856.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28682345.6489; train_global_loss: 43141082.8702; train_optim_loss: 43141082.8702; val_kl_reg_loss: 109077.9849; val_edge_recon_loss: 2760172.5500; val_gene_expr_recon_loss: 11486350.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28371915.2000; val_global_loss: 42727516.5333; val_optim_loss: 42727516.5333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9519; val_auprc_score: 0.9377; val_best_acc_score: 0.8921; val_best_f1_score: 0.8983; train_kl_reg_loss: 107566.2940; train_edge_recon_loss: 2748412.4237; train_gene_expr_recon_loss: 11537907.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28549405.6641; train_global_loss: 42943291.3893; train_optim_loss: 42943291.3893; val_kl_reg_loss: 104992.9135; val_edge_recon_loss: 2785943.3500; val_gene_expr_recon_loss: 11444827.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28164102.6667; val_global_loss: 42499866.6667; val_optim_loss: 42499866.6667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9561; val_auprc_score: 0.9441; val_best_acc_score: 0.8981; val_best_f1_score: 0.9040; train_kl_reg_loss: 104219.7713; train_edge_recon_loss: 2748677.7366; train_gene_expr_recon_loss: 11470864.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28378457.9084; train_global_loss: 42702219.2366; train_optim_loss: 42702219.2366; val_kl_reg_loss: 102939.3115; val_edge_recon_loss: 2749397.4333; val_gene_expr_recon_loss: 11422840.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 28235212.6667; val_global_loss: 42510389.8667; val_optim_loss: 42510389.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9599; val_auprc_score: 0.9499; val_best_acc_score: 0.9046; val_best_f1_score: 0.9096; train_kl_reg_loss: 102073.6680; train_edge_recon_loss: 2739622.3092; train_gene_expr_recon_loss: 11432938.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28266608.0458; train_global_loss: 42541242.7481; train_optim_loss: 42541242.7481; val_kl_reg_loss: 102945.9229; val_edge_recon_loss: 2747999.0500; val_gene_expr_recon_loss: 11356465.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27970838.9333; val_global_loss: 42178250.1333; val_optim_loss: 42178250.1333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9607; val_auprc_score: 0.9491; val_best_acc_score: 0.9065; val_best_f1_score: 0.9114; train_kl_reg_loss: 98883.8882; train_edge_recon_loss: 2737711.5248; train_gene_expr_recon_loss: 11393114.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28147328.3206; train_global_loss: 42377038.5344; train_optim_loss: 42377038.5344; val_kl_reg_loss: 99184.0667; val_edge_recon_loss: 2748456.4833; val_gene_expr_recon_loss: 11331511.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27934350.9333; val_global_loss: 42113503.4667; val_optim_loss: 42113503.4667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9615; val_auprc_score: 0.9516; val_best_acc_score: 0.9062; val_best_f1_score: 0.9096; train_kl_reg_loss: 96810.2989; train_edge_recon_loss: 2726821.3664; train_gene_expr_recon_loss: 11372083.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 28073996.9313; train_global_loss: 42269712.3053; train_optim_loss: 42269712.3053; val_kl_reg_loss: 94553.6417; val_edge_recon_loss: 2734375.0333; val_gene_expr_recon_loss: 11290466.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27709130.0000; val_global_loss: 41828525.3333; val_optim_loss: 41828525.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9654; val_auprc_score: 0.9537; val_best_acc_score: 0.9165; val_best_f1_score: 0.9195; train_kl_reg_loss: 95493.5900; train_edge_recon_loss: 2720927.8874; train_gene_expr_recon_loss: 11322430.8244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27922537.7405; train_global_loss: 42061389.9847; train_optim_loss: 42061389.9847; val_kl_reg_loss: 95101.0667; val_edge_recon_loss: 2724525.7667; val_gene_expr_recon_loss: 11242862.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27691652.6667; val_global_loss: 41754141.8667; val_optim_loss: 41754141.8667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9688; val_auprc_score: 0.9597; val_best_acc_score: 0.9216; val_best_f1_score: 0.9254; train_kl_reg_loss: 92714.7736; train_edge_recon_loss: 2716027.5553; train_gene_expr_recon_loss: 11294703.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27853518.1069; train_global_loss: 41956963.3893; train_optim_loss: 41956963.3893; val_kl_reg_loss: 92566.9911; val_edge_recon_loss: 2714328.2833; val_gene_expr_recon_loss: 11226050.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27666073.7333; val_global_loss: 41699019.7333; val_optim_loss: 41699019.7333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9650; val_auprc_score: 0.9526; val_best_acc_score: 0.9126; val_best_f1_score: 0.9167; train_kl_reg_loss: 92105.9164; train_edge_recon_loss: 2705890.5477; train_gene_expr_recon_loss: 11266414.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27762675.8015; train_global_loss: 41827086.9618; train_optim_loss: 41827086.9618; val_kl_reg_loss: 92461.9755; val_edge_recon_loss: 2736870.4500; val_gene_expr_recon_loss: 11201647.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27593676.5333; val_global_loss: 41624655.7333; val_optim_loss: 41624655.7333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9697; val_auprc_score: 0.9606; val_best_acc_score: 0.9194; val_best_f1_score: 0.9224; train_kl_reg_loss: 89656.7309; train_edge_recon_loss: 2710846.5630; train_gene_expr_recon_loss: 11242554.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27666176.3817; train_global_loss: 41709233.8321; train_optim_loss: 41709233.8321; val_kl_reg_loss: 86287.3922; val_edge_recon_loss: 2728159.8167; val_gene_expr_recon_loss: 11175177.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27546770.5333; val_global_loss: 41536395.4667; val_optim_loss: 41536395.4667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9734; val_auprc_score: 0.9669; val_best_acc_score: 0.9272; val_best_f1_score: 0.9297; train_kl_reg_loss: 88372.8882; train_edge_recon_loss: 2706348.8168; train_gene_expr_recon_loss: 11212556.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27564220.2595; train_global_loss: 41571497.9542; train_optim_loss: 41571497.9542; val_kl_reg_loss: 88210.8536; val_edge_recon_loss: 2699400.5500; val_gene_expr_recon_loss: 11146094.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27365667.6000; val_global_loss: 41299373.6000; val_optim_loss: 41299373.6000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9741; val_auprc_score: 0.9670; val_best_acc_score: 0.9270; val_best_f1_score: 0.9302; train_kl_reg_loss: 88308.4112; train_edge_recon_loss: 2693884.3397; train_gene_expr_recon_loss: 11194060.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27515864.2595; train_global_loss: 41492117.9847; train_optim_loss: 41492117.9847; val_kl_reg_loss: 90890.9964; val_edge_recon_loss: 2708597.7000; val_gene_expr_recon_loss: 11151576.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27293686.2667; val_global_loss: 41244751.4667; val_optim_loss: 41244751.4667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9715; val_auprc_score: 0.9634; val_best_acc_score: 0.9244; val_best_f1_score: 0.9266; train_kl_reg_loss: 87657.3630; train_edge_recon_loss: 2689362.9046; train_gene_expr_recon_loss: 11173012.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27436469.0992; train_global_loss: 41386501.7710; train_optim_loss: 41386501.7710; val_kl_reg_loss: 86731.6880; val_edge_recon_loss: 2727205.2500; val_gene_expr_recon_loss: 11114142.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27274198.2667; val_global_loss: 41202277.6000; val_optim_loss: 41202277.6000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9767; val_auprc_score: 0.9715; val_best_acc_score: 0.9309; val_best_f1_score: 0.9335; train_kl_reg_loss: 85971.3120; train_edge_recon_loss: 2689531.9179; train_gene_expr_recon_loss: 11151977.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27374577.7710; train_global_loss: 41302058.4427; train_optim_loss: 41302058.4427; val_kl_reg_loss: 84369.9854; val_edge_recon_loss: 2688327.7833; val_gene_expr_recon_loss: 11114466.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27158241.6000; val_global_loss: 41045406.1333; val_optim_loss: 41045406.1333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9780; val_auprc_score: 0.9703; val_best_acc_score: 0.9375; val_best_f1_score: 0.9390; train_kl_reg_loss: 91483.9769; train_edge_recon_loss: 2710905.5000; train_gene_expr_recon_loss: 11353504.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27648342.0153; train_global_loss: 41804236.1221; train_optim_loss: 41804236.1221; val_kl_reg_loss: 55978.0589; val_edge_recon_loss: 2706829.6333; val_gene_expr_recon_loss: 11273671.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27418434.2667; val_global_loss: 41454912.8000; val_optim_loss: 41454912.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9782; val_auprc_score: 0.9720; val_best_acc_score: 0.9348; val_best_f1_score: 0.9365; train_kl_reg_loss: 86649.8779; train_edge_recon_loss: 2690660.1260; train_gene_expr_recon_loss: 11301246.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27530488.3664; train_global_loss: 41609045.1603; train_optim_loss: 41609045.1603; val_kl_reg_loss: 58960.5107; val_edge_recon_loss: 2711518.7167; val_gene_expr_recon_loss: 11210295.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27281239.6000; val_global_loss: 41262014.6667; val_optim_loss: 41262014.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9750; val_auprc_score: 0.9683; val_best_acc_score: 0.9302; val_best_f1_score: 0.9329; train_kl_reg_loss: 80734.7325; train_edge_recon_loss: 2682174.6050; train_gene_expr_recon_loss: 11290063.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27509957.9389; train_global_loss: 41562930.2901; train_optim_loss: 41562930.2901; val_kl_reg_loss: 59896.7469; val_edge_recon_loss: 2715592.2333; val_gene_expr_recon_loss: 11243878.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27209605.8667; val_global_loss: 41228973.8667; val_optim_loss: 41228973.8667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9803; val_auprc_score: 0.9749; val_best_acc_score: 0.9391; val_best_f1_score: 0.9411; train_kl_reg_loss: 76686.8189; train_edge_recon_loss: 2681073.2557; train_gene_expr_recon_loss: 11257501.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27416657.8931; train_global_loss: 41431919.4198; train_optim_loss: 41431919.4198; val_kl_reg_loss: 59302.5138; val_edge_recon_loss: 2692720.5500; val_gene_expr_recon_loss: 11243264.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27297888.6667; val_global_loss: 41293176.5333; val_optim_loss: 41293176.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9808; val_auprc_score: 0.9766; val_best_acc_score: 0.9396; val_best_f1_score: 0.9412; train_kl_reg_loss: 75572.5204; train_edge_recon_loss: 2678220.3092; train_gene_expr_recon_loss: 11243629.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27377338.8244; train_global_loss: 41374761.5267; train_optim_loss: 41374761.5267; val_kl_reg_loss: 60205.7482; val_edge_recon_loss: 2680182.6000; val_gene_expr_recon_loss: 11176779.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27166779.8667; val_global_loss: 41083947.2000; val_optim_loss: 41083947.2000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9813; val_auprc_score: 0.9767; val_best_acc_score: 0.9406; val_best_f1_score: 0.9420; train_kl_reg_loss: 75535.4043; train_edge_recon_loss: 2682470.6698; train_gene_expr_recon_loss: 11237324.6412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27376793.9847; train_global_loss: 41372124.7939; train_optim_loss: 41372124.7939; val_kl_reg_loss: 60550.4391; val_edge_recon_loss: 2695244.7000; val_gene_expr_recon_loss: 11196729.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27206692.6667; val_global_loss: 41159217.3333; val_optim_loss: 41159217.3333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9842; val_auprc_score: 0.9801; val_best_acc_score: 0.9469; val_best_f1_score: 0.9483; train_kl_reg_loss: 75245.9254; train_edge_recon_loss: 2675060.1603; train_gene_expr_recon_loss: 11240800.1298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27391304.1985; train_global_loss: 41382410.6260; train_optim_loss: 41382410.6260; val_kl_reg_loss: 60996.7284; val_edge_recon_loss: 2668033.7000; val_gene_expr_recon_loss: 11187007.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27298537.3333; val_global_loss: 41214574.9333; val_optim_loss: 41214574.9333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9781; val_auprc_score: 0.9709; val_best_acc_score: 0.9367; val_best_f1_score: 0.9384; train_kl_reg_loss: 75239.7535; train_edge_recon_loss: 2673333.5744; train_gene_expr_recon_loss: 11232209.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 27365024.4427; train_global_loss: 41345807.5115; train_optim_loss: 41345807.5115; val_kl_reg_loss: 60994.7320; val_edge_recon_loss: 2707432.6000; val_gene_expr_recon_loss: 11201546.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 27250485.0667; val_global_loss: 41220459.4667; val_optim_loss: 41220459.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 51 min 43 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9756
val AUPRC score: 0.9676
val best accuracy score: 0.9318
val best F1 score: 0.9335
val target rna MSE score: 0.9638
val source rna MSE score: 0.3498
val target atac MSE score: 0.1234
val source atac MSE score: 0.0220
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
