[True]
Run timestamp: 07082023_171740_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8778; val_auprc_score: 0.8947; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 25722.4464; train_edge_recon_loss: 36296.7604; train_gene_expr_recon_loss: 1291703.1806; train_masked_gp_l1_reg_loss: 16166.1807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167220.4444; train_chrom_access_recon_loss: 2593518.6250; train_global_loss: 4130627.6389; train_optim_loss: 4130627.6389; val_kl_reg_loss: 14514.7285; val_edge_recon_loss: 40660.0859; val_gene_expr_recon_loss: 1031888.8750; val_masked_gp_l1_reg_loss: 11843.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162931.5781; val_chrom_access_recon_loss: 1750313.1250; val_global_loss: 3012152.0000; val_optim_loss: 3012152.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8834; val_auprc_score: 0.8981; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 15259.0894; train_edge_recon_loss: 38263.5603; train_gene_expr_recon_loss: 930695.7014; train_masked_gp_l1_reg_loss: 10393.2471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160240.5503; train_chrom_access_recon_loss: 1560882.1944; train_global_loss: 2715734.3056; train_optim_loss: 2715734.3056; val_kl_reg_loss: 14848.2178; val_edge_recon_loss: 40660.3984; val_gene_expr_recon_loss: 834475.1250; val_masked_gp_l1_reg_loss: 9520.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156949.7656; val_chrom_access_recon_loss: 1439183.8750; val_global_loss: 2495637.5000; val_optim_loss: 2495637.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8877; val_auprc_score: 0.8997; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16740.0674; train_edge_recon_loss: 38391.7526; train_gene_expr_recon_loss: 819065.4583; train_masked_gp_l1_reg_loss: 9904.5769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154246.3750; train_chrom_access_recon_loss: 1406573.8056; train_global_loss: 2444922.0278; train_optim_loss: 2444922.0278; val_kl_reg_loss: 18819.9707; val_edge_recon_loss: 40660.6602; val_gene_expr_recon_loss: 776006.1250; val_masked_gp_l1_reg_loss: 10247.2910; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150720.6875; val_chrom_access_recon_loss: 1392645.5000; val_global_loss: 2389100.2500; val_optim_loss: 2389100.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8894; val_auprc_score: 0.9029; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 20808.4694; train_edge_recon_loss: 38785.9128; train_gene_expr_recon_loss: 776672.9028; train_masked_gp_l1_reg_loss: 10196.1904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147598.0851; train_chrom_access_recon_loss: 1377664.0139; train_global_loss: 2371725.5556; train_optim_loss: 2371725.5556; val_kl_reg_loss: 20784.4922; val_edge_recon_loss: 40659.8711; val_gene_expr_recon_loss: 745328.6875; val_masked_gp_l1_reg_loss: 10119.2529; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143497.5781; val_chrom_access_recon_loss: 1371277.8750; val_global_loss: 2331667.7500; val_optim_loss: 2331667.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8708; val_auprc_score: 0.8806; val_best_acc_score: 0.5049; val_best_f1_score: 0.6688; train_kl_reg_loss: 21751.4696; train_edge_recon_loss: 38872.9761; train_gene_expr_recon_loss: 750141.8889; train_masked_gp_l1_reg_loss: 10059.2220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139972.8524; train_chrom_access_recon_loss: 1354766.5833; train_global_loss: 2315564.9722; train_optim_loss: 2315564.9722; val_kl_reg_loss: 21776.6562; val_edge_recon_loss: 40656.7344; val_gene_expr_recon_loss: 723444.3750; val_masked_gp_l1_reg_loss: 9973.3389; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135471.8438; val_chrom_access_recon_loss: 1357483.8750; val_global_loss: 2288806.7500; val_optim_loss: 2288806.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8585; val_auprc_score: 0.8640; val_best_acc_score: 0.5183; val_best_f1_score: 0.6745; train_kl_reg_loss: 22773.7721; train_edge_recon_loss: 38932.6554; train_gene_expr_recon_loss: 722662.6528; train_masked_gp_l1_reg_loss: 9907.5403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131784.4236; train_chrom_access_recon_loss: 1339791.8889; train_global_loss: 2265852.9444; train_optim_loss: 2265852.9444; val_kl_reg_loss: 23028.6445; val_edge_recon_loss: 40646.5508; val_gene_expr_recon_loss: 705134.1250; val_masked_gp_l1_reg_loss: 9805.1309; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127156.0312; val_chrom_access_recon_loss: 1347887.5000; val_global_loss: 2253658.0000; val_optim_loss: 2253658.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8614; val_auprc_score: 0.8632; val_best_acc_score: 0.5284; val_best_f1_score: 0.6773; train_kl_reg_loss: 23925.1380; train_edge_recon_loss: 39015.2062; train_gene_expr_recon_loss: 710011.5208; train_masked_gp_l1_reg_loss: 9722.1940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123462.2708; train_chrom_access_recon_loss: 1338646.4444; train_global_loss: 2244782.7222; train_optim_loss: 2244782.7222; val_kl_reg_loss: 23744.4512; val_edge_recon_loss: 40628.6094; val_gene_expr_recon_loss: 691547.5000; val_masked_gp_l1_reg_loss: 9615.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118868.7500; val_chrom_access_recon_loss: 1340707.1250; val_global_loss: 2225112.0000; val_optim_loss: 2225112.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8407; val_auprc_score: 0.8355; val_best_acc_score: 0.5459; val_best_f1_score: 0.6834; train_kl_reg_loss: 24331.6565; train_edge_recon_loss: 39027.4136; train_gene_expr_recon_loss: 695542.8958; train_masked_gp_l1_reg_loss: 9552.5579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115262.8056; train_chrom_access_recon_loss: 1330215.4861; train_global_loss: 2213932.7500; train_optim_loss: 2213932.7500; val_kl_reg_loss: 24205.2715; val_edge_recon_loss: 40606.1836; val_gene_expr_recon_loss: 680650.2500; val_masked_gp_l1_reg_loss: 9478.1133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110829.2500; val_chrom_access_recon_loss: 1334517.8750; val_global_loss: 2200287.0000; val_optim_loss: 2200287.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8267; val_auprc_score: 0.8265; val_best_acc_score: 0.5837; val_best_f1_score: 0.6999; train_kl_reg_loss: 25001.2038; train_edge_recon_loss: 39072.0117; train_gene_expr_recon_loss: 686690.2222; train_masked_gp_l1_reg_loss: 9429.3567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107420.8594; train_chrom_access_recon_loss: 1322039.0972; train_global_loss: 2189652.7222; train_optim_loss: 2189652.7222; val_kl_reg_loss: 24619.9961; val_edge_recon_loss: 40570.6055; val_gene_expr_recon_loss: 672616.1875; val_masked_gp_l1_reg_loss: 9366.0488; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103248.1641; val_chrom_access_recon_loss: 1329006.6250; val_global_loss: 2179427.7500; val_optim_loss: 2179427.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8074; val_auprc_score: 0.8078; val_best_acc_score: 0.6113; val_best_f1_score: 0.7115; train_kl_reg_loss: 25694.0150; train_edge_recon_loss: 39093.7730; train_gene_expr_recon_loss: 676870.1944; train_masked_gp_l1_reg_loss: 9319.2539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100081.0477; train_chrom_access_recon_loss: 1316501.1250; train_global_loss: 2167559.3889; train_optim_loss: 2167559.3889; val_kl_reg_loss: 24976.9688; val_edge_recon_loss: 40534.0352; val_gene_expr_recon_loss: 666303.0000; val_masked_gp_l1_reg_loss: 9254.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96224.1406; val_chrom_access_recon_loss: 1325236.8750; val_global_loss: 2162529.5000; val_optim_loss: 2162529.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8045; val_auprc_score: 0.8053; val_best_acc_score: 0.6385; val_best_f1_score: 0.7240; train_kl_reg_loss: 25927.0816; train_edge_recon_loss: 39113.9805; train_gene_expr_recon_loss: 670836.9514; train_masked_gp_l1_reg_loss: 9215.5315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93312.7552; train_chrom_access_recon_loss: 1311999.9444; train_global_loss: 2150406.2778; train_optim_loss: 2150406.2778; val_kl_reg_loss: 25114.9336; val_edge_recon_loss: 40506.5312; val_gene_expr_recon_loss: 661075.7500; val_masked_gp_l1_reg_loss: 9167.9795; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89775.5625; val_chrom_access_recon_loss: 1320867.3750; val_global_loss: 2146508.2500; val_optim_loss: 2146508.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7988; val_auprc_score: 0.7955; val_best_acc_score: 0.6618; val_best_f1_score: 0.7347; train_kl_reg_loss: 26137.3438; train_edge_recon_loss: 39130.1810; train_gene_expr_recon_loss: 669117.7639; train_masked_gp_l1_reg_loss: 9137.4085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87122.5217; train_chrom_access_recon_loss: 1313838.9444; train_global_loss: 2144484.1944; train_optim_loss: 2144484.1944; val_kl_reg_loss: 24699.5410; val_edge_recon_loss: 40485.0195; val_gene_expr_recon_loss: 657588.3750; val_masked_gp_l1_reg_loss: 9106.8369; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83905.5391; val_chrom_access_recon_loss: 1318074.8750; val_global_loss: 2133860.2500; val_optim_loss: 2133860.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8054; val_auprc_score: 0.8063; val_best_acc_score: 0.6673; val_best_f1_score: 0.7360; train_kl_reg_loss: 25934.2554; train_edge_recon_loss: 39134.9440; train_gene_expr_recon_loss: 664649.7431; train_masked_gp_l1_reg_loss: 9082.1225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81500.0651; train_chrom_access_recon_loss: 1304948.7917; train_global_loss: 2125249.8889; train_optim_loss: 2125249.8889; val_kl_reg_loss: 24740.8730; val_edge_recon_loss: 40478.7227; val_gene_expr_recon_loss: 653530.9375; val_masked_gp_l1_reg_loss: 9051.2432; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78575.8516; val_chrom_access_recon_loss: 1315015.6250; val_global_loss: 2121393.2500; val_optim_loss: 2121393.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8204; val_auprc_score: 0.8168; val_best_acc_score: 0.6819; val_best_f1_score: 0.7433; train_kl_reg_loss: 25394.6582; train_edge_recon_loss: 39104.3776; train_gene_expr_recon_loss: 661186.9028; train_masked_gp_l1_reg_loss: 9034.0972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76381.3776; train_chrom_access_recon_loss: 1310168.8750; train_global_loss: 2121270.3056; train_optim_loss: 2121270.3056; val_kl_reg_loss: 24601.2578; val_edge_recon_loss: 40457.1875; val_gene_expr_recon_loss: 650779.0625; val_masked_gp_l1_reg_loss: 9012.3584; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73717.5156; val_chrom_access_recon_loss: 1312135.5000; val_global_loss: 2110703.0000; val_optim_loss: 2110703.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8342; val_auprc_score: 0.8369; val_best_acc_score: 0.7018; val_best_f1_score: 0.7529; train_kl_reg_loss: 24787.2428; train_edge_recon_loss: 39073.6584; train_gene_expr_recon_loss: 657908.9861; train_masked_gp_l1_reg_loss: 8996.1126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71718.5842; train_chrom_access_recon_loss: 1299297.3611; train_global_loss: 2101781.9861; train_optim_loss: 2101781.9861; val_kl_reg_loss: 24210.1543; val_edge_recon_loss: 40439.8789; val_gene_expr_recon_loss: 648544.5625; val_masked_gp_l1_reg_loss: 8978.4736; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69300.0312; val_chrom_access_recon_loss: 1310152.7500; val_global_loss: 2101626.0000; val_optim_loss: 2101626.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8422; val_auprc_score: 0.8411; val_best_acc_score: 0.7262; val_best_f1_score: 0.7646; train_kl_reg_loss: 24504.5827; train_edge_recon_loss: 39062.0269; train_gene_expr_recon_loss: 657114.1250; train_masked_gp_l1_reg_loss: 8960.6592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67483.2153; train_chrom_access_recon_loss: 1303955.7500; train_global_loss: 2101080.3750; train_optim_loss: 2101080.3750; val_kl_reg_loss: 23081.1230; val_edge_recon_loss: 40399.8242; val_gene_expr_recon_loss: 646950.5625; val_masked_gp_l1_reg_loss: 8942.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65269.1328; val_chrom_access_recon_loss: 1307743.1250; val_global_loss: 2092386.5000; val_optim_loss: 2092386.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8556; val_auprc_score: 0.8535; val_best_acc_score: 0.7611; val_best_f1_score: 0.7864; train_kl_reg_loss: 24120.4987; train_edge_recon_loss: 39025.2752; train_gene_expr_recon_loss: 658706.3958; train_masked_gp_l1_reg_loss: 8931.6465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63607.5130; train_chrom_access_recon_loss: 1302672.5278; train_global_loss: 2097063.8472; train_optim_loss: 2097063.8472; val_kl_reg_loss: 22666.4141; val_edge_recon_loss: 40360.7617; val_gene_expr_recon_loss: 645063.3750; val_masked_gp_l1_reg_loss: 8915.3350; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61574.6680; val_chrom_access_recon_loss: 1305831.1250; val_global_loss: 2084411.7500; val_optim_loss: 2084411.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8631; val_auprc_score: 0.8600; val_best_acc_score: 0.7742; val_best_f1_score: 0.7936; train_kl_reg_loss: 23595.7489; train_edge_recon_loss: 38998.8741; train_gene_expr_recon_loss: 649544.5486; train_masked_gp_l1_reg_loss: 8908.4597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60045.1745; train_chrom_access_recon_loss: 1294987.2500; train_global_loss: 2076080.0556; train_optim_loss: 2076080.0556; val_kl_reg_loss: 22172.1328; val_edge_recon_loss: 40338.7070; val_gene_expr_recon_loss: 643487.1250; val_masked_gp_l1_reg_loss: 8889.7686; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58171.0234; val_chrom_access_recon_loss: 1305701.5000; val_global_loss: 2078760.2500; val_optim_loss: 2078760.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8779; val_auprc_score: 0.8693; val_best_acc_score: 0.8007; val_best_f1_score: 0.8122; train_kl_reg_loss: 23133.7678; train_edge_recon_loss: 38948.3889; train_gene_expr_recon_loss: 646768.3889; train_masked_gp_l1_reg_loss: 8878.9183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56760.6532; train_chrom_access_recon_loss: 1293278.2778; train_global_loss: 2067768.3472; train_optim_loss: 2067768.3472; val_kl_reg_loss: 22349.6367; val_edge_recon_loss: 40305.9453; val_gene_expr_recon_loss: 641230.0000; val_masked_gp_l1_reg_loss: 8868.2285; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55035.4492; val_chrom_access_recon_loss: 1303205.1250; val_global_loss: 2070994.3750; val_optim_loss: 2070994.3750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8944; val_auprc_score: 0.8853; val_best_acc_score: 0.8234; val_best_f1_score: 0.8277; train_kl_reg_loss: 22921.9568; train_edge_recon_loss: 38913.4918; train_gene_expr_recon_loss: 652767.3958; train_masked_gp_l1_reg_loss: 8861.0439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53735.6198; train_chrom_access_recon_loss: 1294481.0833; train_global_loss: 2071680.5833; train_optim_loss: 2071680.5833; val_kl_reg_loss: 21735.8359; val_edge_recon_loss: 40248.0234; val_gene_expr_recon_loss: 640012.7500; val_masked_gp_l1_reg_loss: 8851.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52153.2109; val_chrom_access_recon_loss: 1301031.0000; val_global_loss: 2064032.3750; val_optim_loss: 2064032.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8999; val_auprc_score: 0.8910; val_best_acc_score: 0.8331; val_best_f1_score: 0.8334; train_kl_reg_loss: 22466.5124; train_edge_recon_loss: 38850.9410; train_gene_expr_recon_loss: 647141.2153; train_masked_gp_l1_reg_loss: 8850.2003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50961.1558; train_chrom_access_recon_loss: 1289818.3889; train_global_loss: 2058088.3750; train_optim_loss: 2058088.3750; val_kl_reg_loss: 21193.1055; val_edge_recon_loss: 40172.0586; val_gene_expr_recon_loss: 638822.9375; val_masked_gp_l1_reg_loss: 8843.4873; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49499.6172; val_chrom_access_recon_loss: 1298828.1250; val_global_loss: 2057359.3750; val_optim_loss: 2057359.3750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9183; val_auprc_score: 0.9100; val_best_acc_score: 0.8453; val_best_f1_score: 0.8428; train_kl_reg_loss: 22253.1250; train_edge_recon_loss: 38793.8524; train_gene_expr_recon_loss: 646679.7014; train_masked_gp_l1_reg_loss: 8835.9070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48396.8668; train_chrom_access_recon_loss: 1288496.3611; train_global_loss: 2053455.8333; train_optim_loss: 2053455.8333; val_kl_reg_loss: 21582.7930; val_edge_recon_loss: 40126.7578; val_gene_expr_recon_loss: 637026.8750; val_masked_gp_l1_reg_loss: 8827.0117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47043.1719; val_chrom_access_recon_loss: 1297191.1250; val_global_loss: 2051797.7500; val_optim_loss: 2051797.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9238; val_auprc_score: 0.9139; val_best_acc_score: 0.8494; val_best_f1_score: 0.8434; train_kl_reg_loss: 21982.8030; train_edge_recon_loss: 38730.7352; train_gene_expr_recon_loss: 644941.7222; train_masked_gp_l1_reg_loss: 8822.7446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46026.8915; train_chrom_access_recon_loss: 1289394.0556; train_global_loss: 2049898.9444; train_optim_loss: 2049898.9444; val_kl_reg_loss: 21033.1699; val_edge_recon_loss: 40033.2461; val_gene_expr_recon_loss: 636061.7500; val_masked_gp_l1_reg_loss: 8813.8525; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44779.1016; val_chrom_access_recon_loss: 1295506.6250; val_global_loss: 2046227.7500; val_optim_loss: 2046227.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9223; val_auprc_score: 0.9132; val_best_acc_score: 0.8395; val_best_f1_score: 0.8319; train_kl_reg_loss: 21952.1070; train_edge_recon_loss: 38675.7548; train_gene_expr_recon_loss: 644234.9097; train_masked_gp_l1_reg_loss: 8810.8881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43838.1211; train_chrom_access_recon_loss: 1284638.4861; train_global_loss: 2042150.2639; train_optim_loss: 2042150.2639; val_kl_reg_loss: 20772.4922; val_edge_recon_loss: 39969.0430; val_gene_expr_recon_loss: 635060.6250; val_masked_gp_l1_reg_loss: 8804.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42677.5156; val_chrom_access_recon_loss: 1292799.3750; val_global_loss: 2040083.5000; val_optim_loss: 2040083.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9270; val_auprc_score: 0.9157; val_best_acc_score: 0.8420; val_best_f1_score: 0.8325; train_kl_reg_loss: 21697.8765; train_edge_recon_loss: 38620.4119; train_gene_expr_recon_loss: 642920.4722; train_masked_gp_l1_reg_loss: 8802.1163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41809.0126; train_chrom_access_recon_loss: 1283135.1389; train_global_loss: 2036985.0139; train_optim_loss: 2036985.0139; val_kl_reg_loss: 20987.9277; val_edge_recon_loss: 39896.1719; val_gene_expr_recon_loss: 633614.0000; val_masked_gp_l1_reg_loss: 8795.8418; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40735.2930; val_chrom_access_recon_loss: 1290796.6250; val_global_loss: 2034825.8750; val_optim_loss: 2034825.8750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9197; val_auprc_score: 0.9088; val_best_acc_score: 0.8424; val_best_f1_score: 0.8370; train_kl_reg_loss: 18194.9395; train_edge_recon_loss: 39721.2778; train_gene_expr_recon_loss: 993653.5139; train_masked_gp_l1_reg_loss: 9004.0017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39753.4080; train_chrom_access_recon_loss: 1347449.5833; train_global_loss: 2447776.7222; train_optim_loss: 2447776.7222; val_kl_reg_loss: 14237.4561; val_edge_recon_loss: 40027.8125; val_gene_expr_recon_loss: 974702.5625; val_masked_gp_l1_reg_loss: 9406.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38434.5703; val_chrom_access_recon_loss: 1361184.8750; val_global_loss: 2437994.0000; val_optim_loss: 2437994.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9259; val_auprc_score: 0.9137; val_best_acc_score: 0.8465; val_best_f1_score: 0.8409; train_kl_reg_loss: 16804.8113; train_edge_recon_loss: 39741.2773; train_gene_expr_recon_loss: 980219.1597; train_masked_gp_l1_reg_loss: 9758.3561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37347.3077; train_chrom_access_recon_loss: 1345896.9028; train_global_loss: 2429767.8056; train_optim_loss: 2429767.8056; val_kl_reg_loss: 14445.2559; val_edge_recon_loss: 40044.8438; val_gene_expr_recon_loss: 966173.7500; val_masked_gp_l1_reg_loss: 10147.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36010.5039; val_chrom_access_recon_loss: 1357777.1250; val_global_loss: 2424599.0000; val_optim_loss: 2424599.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9359; val_auprc_score: 0.9270; val_best_acc_score: 0.8579; val_best_f1_score: 0.8526; train_kl_reg_loss: 16718.3049; train_edge_recon_loss: 39681.8598; train_gene_expr_recon_loss: 976352.2569; train_masked_gp_l1_reg_loss: 10404.2257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35000.7669; train_chrom_access_recon_loss: 1348579.4583; train_global_loss: 2426736.8889; train_optim_loss: 2426736.8889; val_kl_reg_loss: 15555.8496; val_edge_recon_loss: 39970.4648; val_gene_expr_recon_loss: 958883.3750; val_masked_gp_l1_reg_loss: 10682.7754; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33777.4180; val_chrom_access_recon_loss: 1355350.0000; val_global_loss: 2414220.0000; val_optim_loss: 2414220.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9345; val_auprc_score: 0.9248; val_best_acc_score: 0.8538; val_best_f1_score: 0.8477; train_kl_reg_loss: 16973.6124; train_edge_recon_loss: 39637.8850; train_gene_expr_recon_loss: 965898.6250; train_masked_gp_l1_reg_loss: 10854.5349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32866.9444; train_chrom_access_recon_loss: 1345444.7361; train_global_loss: 2411676.3056; train_optim_loss: 2411676.3056; val_kl_reg_loss: 15680.7695; val_edge_recon_loss: 39936.0078; val_gene_expr_recon_loss: 954103.8750; val_masked_gp_l1_reg_loss: 11040.8154; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31774.4023; val_chrom_access_recon_loss: 1353936.5000; val_global_loss: 2406472.5000; val_optim_loss: 2406472.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9348; val_auprc_score: 0.9255; val_best_acc_score: 0.8569; val_best_f1_score: 0.8508; train_kl_reg_loss: 16940.8424; train_edge_recon_loss: 39594.7522; train_gene_expr_recon_loss: 971710.3125; train_masked_gp_l1_reg_loss: 10978.4092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31608.2059; train_chrom_access_recon_loss: 1349171.1806; train_global_loss: 2420003.7222; train_optim_loss: 2420003.7222; val_kl_reg_loss: 15781.0322; val_edge_recon_loss: 39937.4844; val_gene_expr_recon_loss: 953403.3750; val_masked_gp_l1_reg_loss: 10927.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31421.8125; val_chrom_access_recon_loss: 1353298.1250; val_global_loss: 2404769.5000; val_optim_loss: 2404769.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9354; val_auprc_score: 0.9236; val_best_acc_score: 0.8537; val_best_f1_score: 0.8475; train_kl_reg_loss: 16900.9002; train_edge_recon_loss: 39599.6484; train_gene_expr_recon_loss: 963350.2708; train_masked_gp_l1_reg_loss: 10918.3406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31308.8607; train_chrom_access_recon_loss: 1343384.9583; train_global_loss: 2405462.9722; train_optim_loss: 2405462.9722; val_kl_reg_loss: 15721.8311; val_edge_recon_loss: 39923.7656; val_gene_expr_recon_loss: 953122.1250; val_masked_gp_l1_reg_loss: 10901.1338; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31162.7539; val_chrom_access_recon_loss: 1353384.8750; val_global_loss: 2404216.5000; val_optim_loss: 2404216.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9362; val_auprc_score: 0.9259; val_best_acc_score: 0.8546; val_best_f1_score: 0.8480; train_kl_reg_loss: 16829.6013; train_edge_recon_loss: 39584.8016; train_gene_expr_recon_loss: 967650.1111; train_masked_gp_l1_reg_loss: 10894.9607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31056.8800; train_chrom_access_recon_loss: 1345240.5694; train_global_loss: 2411256.9167; train_optim_loss: 2411256.9167; val_kl_reg_loss: 15713.3945; val_edge_recon_loss: 39924.9727; val_gene_expr_recon_loss: 952750.2500; val_masked_gp_l1_reg_loss: 10889.2686; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30927.1445; val_chrom_access_recon_loss: 1353167.1250; val_global_loss: 2403372.0000; val_optim_loss: 2403372.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9324; val_auprc_score: 0.9193; val_best_acc_score: 0.8503; val_best_f1_score: 0.8439; train_kl_reg_loss: 16818.3210; train_edge_recon_loss: 39576.2834; train_gene_expr_recon_loss: 965528.8611; train_masked_gp_l1_reg_loss: 10888.4809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30828.3318; train_chrom_access_recon_loss: 1339790.6250; train_global_loss: 2403430.8333; train_optim_loss: 2403430.8333; val_kl_reg_loss: 15712.6875; val_edge_recon_loss: 39907.9102; val_gene_expr_recon_loss: 952440.6875; val_masked_gp_l1_reg_loss: 10888.5732; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30710.2500; val_chrom_access_recon_loss: 1353274.2500; val_global_loss: 2402934.5000; val_optim_loss: 2402934.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 18 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9246
val AUPRC score: 0.9167
val best accuracy score: 0.8552
val best F1 score: 0.8587
val target rna MSE score: 3.7651
val source rna MSE score: 3.1199
val target atac MSE score: 0.1379
val source atac MSE score: 0.0198
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
