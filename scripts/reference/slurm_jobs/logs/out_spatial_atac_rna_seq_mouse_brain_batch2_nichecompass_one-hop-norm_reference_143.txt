[True]
Run timestamp: 07082023_215227_143.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_143']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9019; val_auprc_score: 0.9133; val_best_acc_score: 0.5722; val_best_f1_score: 0.6993; train_kl_reg_loss: 33738.2024; train_edge_recon_loss: 3472348.0556; train_gene_expr_recon_loss: 1271469.2222; train_masked_gp_l1_reg_loss: 16414.5893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119006.5764; train_chrom_access_recon_loss: 736781.8542; train_global_loss: 5649758.5000; train_optim_loss: 5649758.5000; val_kl_reg_loss: 7605.3877; val_edge_recon_loss: 4060437.5000; val_gene_expr_recon_loss: 1132273.6250; val_masked_gp_l1_reg_loss: 12082.1338; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116644.3281; val_chrom_access_recon_loss: 507357.8125; val_global_loss: 5836401.0000; val_optim_loss: 5836401.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9062; val_auprc_score: 0.9145; val_best_acc_score: 0.5655; val_best_f1_score: 0.6960; train_kl_reg_loss: 7494.2087; train_edge_recon_loss: 3472792.9167; train_gene_expr_recon_loss: 1055773.1528; train_masked_gp_l1_reg_loss: 10333.8204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115220.1042; train_chrom_access_recon_loss: 493611.8368; train_global_loss: 5155226.0000; train_optim_loss: 5155226.0000; val_kl_reg_loss: 6979.1367; val_edge_recon_loss: 4060663.0000; val_gene_expr_recon_loss: 972289.6250; val_masked_gp_l1_reg_loss: 8908.7275; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113450.0312; val_chrom_access_recon_loss: 488958.8750; val_global_loss: 5651249.5000; val_optim_loss: 5651249.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9061; val_auprc_score: 0.9120; val_best_acc_score: 0.5616; val_best_f1_score: 0.6942; train_kl_reg_loss: 10601.6846; train_edge_recon_loss: 3476628.8889; train_gene_expr_recon_loss: 919252.0625; train_masked_gp_l1_reg_loss: 8754.9950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112001.1189; train_chrom_access_recon_loss: 482674.6875; train_global_loss: 5009913.5556; train_optim_loss: 5009913.5556; val_kl_reg_loss: 12403.5684; val_edge_recon_loss: 4060939.0000; val_gene_expr_recon_loss: 880460.7500; val_masked_gp_l1_reg_loss: 8591.7607; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110132.3359; val_chrom_access_recon_loss: 478038.7812; val_global_loss: 5550566.5000; val_optim_loss: 5550566.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8986; val_auprc_score: 0.9031; val_best_acc_score: 0.5915; val_best_f1_score: 0.7076; train_kl_reg_loss: 14070.8528; train_edge_recon_loss: 3477332.8889; train_gene_expr_recon_loss: 846853.9861; train_masked_gp_l1_reg_loss: 8343.5689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108517.5859; train_chrom_access_recon_loss: 465312.8958; train_global_loss: 4920431.8889; train_optim_loss: 4920431.8889; val_kl_reg_loss: 15444.2871; val_edge_recon_loss: 4058447.5000; val_gene_expr_recon_loss: 824773.8750; val_masked_gp_l1_reg_loss: 8118.8921; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106406.4922; val_chrom_access_recon_loss: 464032.7500; val_global_loss: 5477224.0000; val_optim_loss: 5477224.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8944; val_auprc_score: 0.8946; val_best_acc_score: 0.6664; val_best_f1_score: 0.7442; train_kl_reg_loss: 15885.4489; train_edge_recon_loss: 3477314.6667; train_gene_expr_recon_loss: 801240.9722; train_masked_gp_l1_reg_loss: 8048.2349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104542.1450; train_chrom_access_recon_loss: 457095.8160; train_global_loss: 4864127.3333; train_optim_loss: 4864127.3333; val_kl_reg_loss: 15487.0762; val_edge_recon_loss: 4050652.0000; val_gene_expr_recon_loss: 789099.6250; val_masked_gp_l1_reg_loss: 7961.8770; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102100.0000; val_chrom_access_recon_loss: 457881.6875; val_global_loss: 5423182.0000; val_optim_loss: 5423182.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8894; val_auprc_score: 0.8837; val_best_acc_score: 0.7590; val_best_f1_score: 0.7956; train_kl_reg_loss: 16908.6734; train_edge_recon_loss: 3476597.0556; train_gene_expr_recon_loss: 772133.3333; train_masked_gp_l1_reg_loss: 7941.7669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100011.4809; train_chrom_access_recon_loss: 452883.5278; train_global_loss: 4826475.8333; train_optim_loss: 4826475.8333; val_kl_reg_loss: 17369.1484; val_edge_recon_loss: 4036594.2500; val_gene_expr_recon_loss: 762839.5000; val_masked_gp_l1_reg_loss: 7934.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97345.3906; val_chrom_access_recon_loss: 454332.3125; val_global_loss: 5376415.5000; val_optim_loss: 5376415.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8936; val_auprc_score: 0.8835; val_best_acc_score: 0.8261; val_best_f1_score: 0.8239; train_kl_reg_loss: 17046.2624; train_edge_recon_loss: 3473517.8611; train_gene_expr_recon_loss: 746477.3681; train_masked_gp_l1_reg_loss: 7959.8944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95156.1719; train_chrom_access_recon_loss: 450745.4549; train_global_loss: 4790903.1667; train_optim_loss: 4790903.1667; val_kl_reg_loss: 14699.8389; val_edge_recon_loss: 3980701.5000; val_gene_expr_recon_loss: 749059.2500; val_masked_gp_l1_reg_loss: 7982.5449; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92401.8281; val_chrom_access_recon_loss: 452338.5312; val_global_loss: 5297183.5000; val_optim_loss: 5297183.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9058; val_auprc_score: 0.8856; val_best_acc_score: 0.8348; val_best_f1_score: 0.8422; train_kl_reg_loss: 13504.1199; train_edge_recon_loss: 3454540.3056; train_gene_expr_recon_loss: 741918.9722; train_masked_gp_l1_reg_loss: 8018.3324; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90183.8707; train_chrom_access_recon_loss: 448366.4896; train_global_loss: 4756531.9444; train_optim_loss: 4756531.9444; val_kl_reg_loss: 9620.1504; val_edge_recon_loss: 3719979.0000; val_gene_expr_recon_loss: 746636.3125; val_masked_gp_l1_reg_loss: 8061.9521; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87421.7188; val_chrom_access_recon_loss: 451857.7500; val_global_loss: 5023577.0000; val_optim_loss: 5023577.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9005; val_auprc_score: 0.8781; val_best_acc_score: 0.8270; val_best_f1_score: 0.8415; train_kl_reg_loss: 7171.0186; train_edge_recon_loss: 3260183.3889; train_gene_expr_recon_loss: 758678.6736; train_masked_gp_l1_reg_loss: 8114.0050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85266.1424; train_chrom_access_recon_loss: 449299.2083; train_global_loss: 4568712.3333; train_optim_loss: 4568712.3333; val_kl_reg_loss: 8719.1621; val_edge_recon_loss: 2901064.2500; val_gene_expr_recon_loss: 807668.0000; val_masked_gp_l1_reg_loss: 8160.1689; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82641.1719; val_chrom_access_recon_loss: 457617.5312; val_global_loss: 4265870.5000; val_optim_loss: 4265870.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9128; val_auprc_score: 0.8894; val_best_acc_score: 0.8482; val_best_f1_score: 0.8597; train_kl_reg_loss: 20044.1782; train_edge_recon_loss: 2830149.3889; train_gene_expr_recon_loss: 797225.7500; train_masked_gp_l1_reg_loss: 8159.2285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80647.0113; train_chrom_access_recon_loss: 452280.0139; train_global_loss: 4188505.5833; train_optim_loss: 4188505.5833; val_kl_reg_loss: 35056.4375; val_edge_recon_loss: 2782295.0000; val_gene_expr_recon_loss: 782140.7500; val_masked_gp_l1_reg_loss: 8153.8306; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78177.4922; val_chrom_access_recon_loss: 454031.9688; val_global_loss: 4139855.5000; val_optim_loss: 4139855.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9194; val_auprc_score: 0.8932; val_best_acc_score: 0.8575; val_best_f1_score: 0.8677; train_kl_reg_loss: 44377.2925; train_edge_recon_loss: 2762130.3333; train_gene_expr_recon_loss: 768876.2083; train_masked_gp_l1_reg_loss: 8137.0663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76224.5512; train_chrom_access_recon_loss: 450229.4097; train_global_loss: 4109974.8611; train_optim_loss: 4109974.8611; val_kl_reg_loss: 48635.8633; val_edge_recon_loss: 2748162.7500; val_gene_expr_recon_loss: 764259.8750; val_masked_gp_l1_reg_loss: 8126.9727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73795.3750; val_chrom_access_recon_loss: 450940.6875; val_global_loss: 4093921.7500; val_optim_loss: 4093921.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9276; val_auprc_score: 0.8988; val_best_acc_score: 0.8680; val_best_f1_score: 0.8770; train_kl_reg_loss: 50388.1037; train_edge_recon_loss: 2724284.9167; train_gene_expr_recon_loss: 752185.5903; train_masked_gp_l1_reg_loss: 8116.6560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71887.6059; train_chrom_access_recon_loss: 447910.2708; train_global_loss: 4054773.1667; train_optim_loss: 4054773.1667; val_kl_reg_loss: 47471.5273; val_edge_recon_loss: 2745380.5000; val_gene_expr_recon_loss: 753684.5000; val_masked_gp_l1_reg_loss: 8083.4253; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69513.4844; val_chrom_access_recon_loss: 449697.2500; val_global_loss: 4073830.7500; val_optim_loss: 4073830.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9353; val_auprc_score: 0.9136; val_best_acc_score: 0.8767; val_best_f1_score: 0.8849; train_kl_reg_loss: 45769.6632; train_edge_recon_loss: 2731487.1944; train_gene_expr_recon_loss: 743533.4097; train_masked_gp_l1_reg_loss: 8101.6590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67649.8524; train_chrom_access_recon_loss: 445808.6597; train_global_loss: 4042350.4722; train_optim_loss: 4042350.4722; val_kl_reg_loss: 40355.5625; val_edge_recon_loss: 2720660.2500; val_gene_expr_recon_loss: 745972.9375; val_masked_gp_l1_reg_loss: 8080.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65349.9844; val_chrom_access_recon_loss: 448437.9375; val_global_loss: 4028857.0000; val_optim_loss: 4028857.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9317; val_auprc_score: 0.9077; val_best_acc_score: 0.8708; val_best_f1_score: 0.8802; train_kl_reg_loss: 39673.8485; train_edge_recon_loss: 2725786.2500; train_gene_expr_recon_loss: 737206.3819; train_masked_gp_l1_reg_loss: 8063.7788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63566.4796; train_chrom_access_recon_loss: 443771.9826; train_global_loss: 4018068.7500; train_optim_loss: 4018068.7500; val_kl_reg_loss: 37716.3594; val_edge_recon_loss: 2748293.2500; val_gene_expr_recon_loss: 740964.7500; val_masked_gp_l1_reg_loss: 8059.3599; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61372.3438; val_chrom_access_recon_loss: 447352.9375; val_global_loss: 4043758.7500; val_optim_loss: 4043758.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9449; val_auprc_score: 0.9252; val_best_acc_score: 0.8867; val_best_f1_score: 0.8938; train_kl_reg_loss: 39648.8780; train_edge_recon_loss: 2720702.0833; train_gene_expr_recon_loss: 730680.3750; train_masked_gp_l1_reg_loss: 8073.4846; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59694.1580; train_chrom_access_recon_loss: 444295.6736; train_global_loss: 4003094.5833; train_optim_loss: 4003094.5833; val_kl_reg_loss: 39364.0273; val_edge_recon_loss: 2729066.2500; val_gene_expr_recon_loss: 734684.2500; val_masked_gp_l1_reg_loss: 8081.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57639.5742; val_chrom_access_recon_loss: 446537.8750; val_global_loss: 4015373.5000; val_optim_loss: 4015373.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9397; val_auprc_score: 0.9171; val_best_acc_score: 0.8844; val_best_f1_score: 0.8919; train_kl_reg_loss: 39907.9102; train_edge_recon_loss: 2705616.8333; train_gene_expr_recon_loss: 728333.7292; train_masked_gp_l1_reg_loss: 8099.8860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56072.6701; train_chrom_access_recon_loss: 444699.1458; train_global_loss: 3982730.1944; train_optim_loss: 3982730.1944; val_kl_reg_loss: 37799.4062; val_edge_recon_loss: 2725088.2500; val_gene_expr_recon_loss: 733613.5625; val_masked_gp_l1_reg_loss: 8109.2046; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54160.7383; val_chrom_access_recon_loss: 445706.4375; val_global_loss: 4004477.7500; val_optim_loss: 4004477.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9420; val_auprc_score: 0.9229; val_best_acc_score: 0.8874; val_best_f1_score: 0.8954; train_kl_reg_loss: 37933.2917; train_edge_recon_loss: 2711002.2778; train_gene_expr_recon_loss: 719738.5694; train_masked_gp_l1_reg_loss: 8145.0822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52711.9609; train_chrom_access_recon_loss: 439587.9479; train_global_loss: 3969119.0278; train_optim_loss: 3969119.0278; val_kl_reg_loss: 37089.9297; val_edge_recon_loss: 2726212.5000; val_gene_expr_recon_loss: 728030.6250; val_masked_gp_l1_reg_loss: 8164.5952; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50939.4531; val_chrom_access_recon_loss: 444907.3125; val_global_loss: 3995344.2500; val_optim_loss: 3995344.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9499; val_auprc_score: 0.9332; val_best_acc_score: 0.8973; val_best_f1_score: 0.9026; train_kl_reg_loss: 37369.6246; train_edge_recon_loss: 2716907.6944; train_gene_expr_recon_loss: 716604.7569; train_masked_gp_l1_reg_loss: 8177.7377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49594.3681; train_chrom_access_recon_loss: 440911.5208; train_global_loss: 3969565.7500; train_optim_loss: 3969565.7500; val_kl_reg_loss: 36470.3477; val_edge_recon_loss: 2708971.5000; val_gene_expr_recon_loss: 725548.1875; val_masked_gp_l1_reg_loss: 8193.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47954.8438; val_chrom_access_recon_loss: 444045.8438; val_global_loss: 3971184.2500; val_optim_loss: 3971184.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9553; val_auprc_score: 0.9401; val_best_acc_score: 0.8980; val_best_f1_score: 0.9028; train_kl_reg_loss: 36588.6476; train_edge_recon_loss: 2712915.1944; train_gene_expr_recon_loss: 718910.1736; train_masked_gp_l1_reg_loss: 8221.3057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46715.9062; train_chrom_access_recon_loss: 441872.5312; train_global_loss: 3965223.7222; train_optim_loss: 3965223.7222; val_kl_reg_loss: 35424.3242; val_edge_recon_loss: 2715380.0000; val_gene_expr_recon_loss: 721944.3750; val_masked_gp_l1_reg_loss: 8240.2598; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45204.5898; val_chrom_access_recon_loss: 443352.6875; val_global_loss: 3969546.0000; val_optim_loss: 3969546.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9615; val_auprc_score: 0.9490; val_best_acc_score: 0.9069; val_best_f1_score: 0.9108; train_kl_reg_loss: 34922.0252; train_edge_recon_loss: 2704403.4444; train_gene_expr_recon_loss: 712788.1042; train_masked_gp_l1_reg_loss: 8271.4890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44066.1185; train_chrom_access_recon_loss: 438594.6146; train_global_loss: 3943045.8056; train_optim_loss: 3943045.8056; val_kl_reg_loss: 33704.9609; val_edge_recon_loss: 2724461.5000; val_gene_expr_recon_loss: 721675.2500; val_masked_gp_l1_reg_loss: 8295.3721; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42672.1406; val_chrom_access_recon_loss: 442935.2188; val_global_loss: 3973744.5000; val_optim_loss: 3973744.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9694; val_auprc_score: 0.9575; val_best_acc_score: 0.9208; val_best_f1_score: 0.9239; train_kl_reg_loss: 34390.3290; train_edge_recon_loss: 2694696.7222; train_gene_expr_recon_loss: 714689.3542; train_masked_gp_l1_reg_loss: 8319.8085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41627.9384; train_chrom_access_recon_loss: 441012.8056; train_global_loss: 3934736.8889; train_optim_loss: 3934736.8889; val_kl_reg_loss: 34485.1641; val_edge_recon_loss: 2684459.0000; val_gene_expr_recon_loss: 718293.9375; val_masked_gp_l1_reg_loss: 8353.6709; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40351.0000; val_chrom_access_recon_loss: 442612.0000; val_global_loss: 3928555.0000; val_optim_loss: 3928555.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9682; val_auprc_score: 0.9526; val_best_acc_score: 0.9252; val_best_f1_score: 0.9277; train_kl_reg_loss: 35292.6059; train_edge_recon_loss: 2680224.2500; train_gene_expr_recon_loss: 706877.3056; train_masked_gp_l1_reg_loss: 8392.6841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39386.8637; train_chrom_access_recon_loss: 437041.7917; train_global_loss: 3907215.4722; train_optim_loss: 3907215.4722; val_kl_reg_loss: 34828.0078; val_edge_recon_loss: 2689244.2500; val_gene_expr_recon_loss: 719348.1875; val_masked_gp_l1_reg_loss: 8432.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38206.1328; val_chrom_access_recon_loss: 441886.7188; val_global_loss: 3931945.7500; val_optim_loss: 3931945.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9733; val_auprc_score: 0.9630; val_best_acc_score: 0.9303; val_best_f1_score: 0.9335; train_kl_reg_loss: 36944.1901; train_edge_recon_loss: 2664648.3889; train_gene_expr_recon_loss: 707630.6042; train_masked_gp_l1_reg_loss: 8465.6398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37335.5425; train_chrom_access_recon_loss: 437520.2188; train_global_loss: 3892544.5556; train_optim_loss: 3892544.5556; val_kl_reg_loss: 37498.0547; val_edge_recon_loss: 2663072.2500; val_gene_expr_recon_loss: 713388.7500; val_masked_gp_l1_reg_loss: 8496.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36265.0859; val_chrom_access_recon_loss: 440844.1250; val_global_loss: 3899564.5000; val_optim_loss: 3899564.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9718; val_auprc_score: 0.9605; val_best_acc_score: 0.9298; val_best_f1_score: 0.9325; train_kl_reg_loss: 37944.5786; train_edge_recon_loss: 2675670.0833; train_gene_expr_recon_loss: 701445.9931; train_masked_gp_l1_reg_loss: 8537.5122; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35443.4865; train_chrom_access_recon_loss: 438731.7986; train_global_loss: 3897773.4167; train_optim_loss: 3897773.4167; val_kl_reg_loss: 36645.5469; val_edge_recon_loss: 2684995.2500; val_gene_expr_recon_loss: 712357.0000; val_masked_gp_l1_reg_loss: 8574.6543; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34436.7969; val_chrom_access_recon_loss: 440246.2500; val_global_loss: 3917255.5000; val_optim_loss: 3917255.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9691; val_auprc_score: 0.9548; val_best_acc_score: 0.9289; val_best_f1_score: 0.9314; train_kl_reg_loss: 37917.8802; train_edge_recon_loss: 2663499.7778; train_gene_expr_recon_loss: 704349.3750; train_masked_gp_l1_reg_loss: 8601.3624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33678.9727; train_chrom_access_recon_loss: 435592.7257; train_global_loss: 3883640.0278; train_optim_loss: 3883640.0278; val_kl_reg_loss: 36989.3906; val_edge_recon_loss: 2684574.5000; val_gene_expr_recon_loss: 714215.3750; val_masked_gp_l1_reg_loss: 8633.5850; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32755.1758; val_chrom_access_recon_loss: 439941.0000; val_global_loss: 3917109.2500; val_optim_loss: 3917109.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9730; val_auprc_score: 0.9631; val_best_acc_score: 0.9305; val_best_f1_score: 0.9325; train_kl_reg_loss: 35233.5590; train_edge_recon_loss: 2658790.5000; train_gene_expr_recon_loss: 1024611.9167; train_masked_gp_l1_reg_loss: 8729.1566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31887.5050; train_chrom_access_recon_loss: 459624.9479; train_global_loss: 4218877.5833; train_optim_loss: 4218877.5833; val_kl_reg_loss: 20122.3281; val_edge_recon_loss: 2676040.7500; val_gene_expr_recon_loss: 1036722.1250; val_masked_gp_l1_reg_loss: 8819.2129; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30717.4512; val_chrom_access_recon_loss: 463247.4062; val_global_loss: 4235669.0000; val_optim_loss: 4235669.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9688; val_auprc_score: 0.9532; val_best_acc_score: 0.9258; val_best_f1_score: 0.9291; train_kl_reg_loss: 31586.6753; train_edge_recon_loss: 2666078.3889; train_gene_expr_recon_loss: 1021016.7639; train_masked_gp_l1_reg_loss: 8890.4245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29736.4698; train_chrom_access_recon_loss: 459300.9583; train_global_loss: 4216609.6667; train_optim_loss: 4216609.6667; val_kl_reg_loss: 19900.5547; val_edge_recon_loss: 2664605.7500; val_gene_expr_recon_loss: 1033987.4375; val_masked_gp_l1_reg_loss: 8977.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28517.4062; val_chrom_access_recon_loss: 462974.2812; val_global_loss: 4218963.0000; val_optim_loss: 4218963.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9709; val_auprc_score: 0.9545; val_best_acc_score: 0.9326; val_best_f1_score: 0.9353; train_kl_reg_loss: 30641.1645; train_edge_recon_loss: 2656248.9167; train_gene_expr_recon_loss: 1018863.5556; train_masked_gp_l1_reg_loss: 8911.7312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28377.9091; train_chrom_access_recon_loss: 458886.2465; train_global_loss: 4201929.6667; train_optim_loss: 4201929.6667; val_kl_reg_loss: 19401.1289; val_edge_recon_loss: 2662376.7500; val_gene_expr_recon_loss: 1034002.0000; val_masked_gp_l1_reg_loss: 8846.3271; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28205.1523; val_chrom_access_recon_loss: 462605.2188; val_global_loss: 4215436.5000; val_optim_loss: 4215436.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9751; val_auprc_score: 0.9648; val_best_acc_score: 0.9326; val_best_f1_score: 0.9353; train_kl_reg_loss: 29990.5725; train_edge_recon_loss: 2660590.5278; train_gene_expr_recon_loss: 1021635.2569; train_masked_gp_l1_reg_loss: 8832.8513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28083.8216; train_chrom_access_recon_loss: 458252.7674; train_global_loss: 4207385.8611; train_optim_loss: 4207385.8611; val_kl_reg_loss: 19299.7480; val_edge_recon_loss: 2658419.0000; val_gene_expr_recon_loss: 1033215.0000; val_masked_gp_l1_reg_loss: 8813.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27930.6250; val_chrom_access_recon_loss: 462675.5938; val_global_loss: 4210353.0000; val_optim_loss: 4210353.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9752; val_auprc_score: 0.9616; val_best_acc_score: 0.9365; val_best_f1_score: 0.9389; train_kl_reg_loss: 29724.1191; train_edge_recon_loss: 2647199.9722; train_gene_expr_recon_loss: 1021495.9444; train_masked_gp_l1_reg_loss: 8805.7343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27813.0634; train_chrom_access_recon_loss: 460091.1979; train_global_loss: 4195129.9444; train_optim_loss: 4195129.9444; val_kl_reg_loss: 19170.3223; val_edge_recon_loss: 2639824.7500; val_gene_expr_recon_loss: 1033391.5000; val_masked_gp_l1_reg_loss: 8798.9980; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27669.5410; val_chrom_access_recon_loss: 462606.6250; val_global_loss: 4191461.5000; val_optim_loss: 4191461.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9733; val_auprc_score: 0.9618; val_best_acc_score: 0.9307; val_best_f1_score: 0.9336; train_kl_reg_loss: 29513.3158; train_edge_recon_loss: 2657306.8889; train_gene_expr_recon_loss: 1020741.7917; train_masked_gp_l1_reg_loss: 8797.9191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27561.1573; train_chrom_access_recon_loss: 456810.6562; train_global_loss: 4200731.8056; train_optim_loss: 4200731.8056; val_kl_reg_loss: 19030.8789; val_edge_recon_loss: 2660332.0000; val_gene_expr_recon_loss: 1032351.2500; val_masked_gp_l1_reg_loss: 8799.1689; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27429.0117; val_chrom_access_recon_loss: 462444.3750; val_global_loss: 4210387.0000; val_optim_loss: 4210387.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 38 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9698
val AUPRC score: 0.9594
val best accuracy score: 0.9266
val best F1 score: 0.9298
val target rna MSE score: 4.1230
val source rna MSE score: 3.3031
val target atac MSE score: 0.1393
val source atac MSE score: 0.0216
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
