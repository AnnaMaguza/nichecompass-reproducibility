[True]
Run timestamp: 10102023_043203_143.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_143']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6717; val_auprc_score: 0.6593; val_best_acc_score: 0.5126; val_best_f1_score: 0.6714; train_kl_reg_loss: 59899.5652; train_edge_recon_loss: 3520848.8371; train_gene_expr_recon_loss: 13996842.0909; train_masked_gp_l1_reg_loss: 47663.2650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5408077.0758; train_chrom_access_recon_loss: 11487246.0909; train_global_loss: 34520576.7879; train_optim_loss: 34520576.7879; val_kl_reg_loss: 112434.8008; val_edge_recon_loss: 4064781.4375; val_gene_expr_recon_loss: 12868580.8750; val_masked_gp_l1_reg_loss: 54553.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2377483.0000; val_chrom_access_recon_loss: 11206000.2500; val_global_loss: 30683834.5000; val_optim_loss: 30683834.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7143; val_auprc_score: 0.6933; val_best_acc_score: 0.5999; val_best_f1_score: 0.7037; train_kl_reg_loss: 109042.3690; train_edge_recon_loss: 3530375.1780; train_gene_expr_recon_loss: 12827263.3636; train_masked_gp_l1_reg_loss: 55768.7763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1047069.0923; train_chrom_access_recon_loss: 10984613.4091; train_global_loss: 28554132.4242; train_optim_loss: 28554132.4242; val_kl_reg_loss: 102380.5811; val_edge_recon_loss: 4059998.5938; val_gene_expr_recon_loss: 12732099.2500; val_masked_gp_l1_reg_loss: 57182.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 408708.9375; val_chrom_access_recon_loss: 11226587.2500; val_global_loss: 28586956.0000; val_optim_loss: 28586956.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7652; val_auprc_score: 0.7400; val_best_acc_score: 0.6625; val_best_f1_score: 0.7268; train_kl_reg_loss: 98580.4564; train_edge_recon_loss: 3517712.2311; train_gene_expr_recon_loss: 12674000.3939; train_masked_gp_l1_reg_loss: 58530.9452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 289970.1432; train_chrom_access_recon_loss: 10880475.8788; train_global_loss: 27519270.0303; train_optim_loss: 27519270.0303; val_kl_reg_loss: 83883.2246; val_edge_recon_loss: 3996074.9688; val_gene_expr_recon_loss: 12721879.5000; val_masked_gp_l1_reg_loss: 60096.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 218266.4844; val_chrom_access_recon_loss: 11115726.3750; val_global_loss: 28195926.7500; val_optim_loss: 28195926.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8278; val_auprc_score: 0.7974; val_best_acc_score: 0.7528; val_best_f1_score: 0.7783; train_kl_reg_loss: 78000.9301; train_edge_recon_loss: 3376979.3561; train_gene_expr_recon_loss: 12606337.1667; train_masked_gp_l1_reg_loss: 62331.7529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 187070.9406; train_chrom_access_recon_loss: 10820489.5000; train_global_loss: 27131209.4848; train_optim_loss: 27131209.4848; val_kl_reg_loss: 90359.5430; val_edge_recon_loss: 3162299.3125; val_gene_expr_recon_loss: 12643343.7500; val_masked_gp_l1_reg_loss: 65787.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161947.7656; val_chrom_access_recon_loss: 10984788.2500; val_global_loss: 27108527.0000; val_optim_loss: 27108527.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8675; val_auprc_score: 0.8319; val_best_acc_score: 0.7966; val_best_f1_score: 0.8198; train_kl_reg_loss: 107419.2526; train_edge_recon_loss: 2984886.8902; train_gene_expr_recon_loss: 12527871.2273; train_masked_gp_l1_reg_loss: 68729.7972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146057.3163; train_chrom_access_recon_loss: 10744045.5455; train_global_loss: 26579010.0909; train_optim_loss: 26579010.0909; val_kl_reg_loss: 112387.7656; val_edge_recon_loss: 2926582.1250; val_gene_expr_recon_loss: 12571192.2500; val_masked_gp_l1_reg_loss: 70795.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134606.2656; val_chrom_access_recon_loss: 11045852.7500; val_global_loss: 26861417.0000; val_optim_loss: 26861417.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8923; val_auprc_score: 0.8646; val_best_acc_score: 0.8262; val_best_f1_score: 0.8426; train_kl_reg_loss: 113773.6049; train_edge_recon_loss: 2872983.3712; train_gene_expr_recon_loss: 12444222.3788; train_masked_gp_l1_reg_loss: 72176.0781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126806.1622; train_chrom_access_recon_loss: 10675627.9242; train_global_loss: 26305589.6061; train_optim_loss: 26305589.6061; val_kl_reg_loss: 112423.5283; val_edge_recon_loss: 2850962.8438; val_gene_expr_recon_loss: 12530993.7500; val_masked_gp_l1_reg_loss: 73449.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121082.6328; val_chrom_access_recon_loss: 10961010.5000; val_global_loss: 26649922.2500; val_optim_loss: 26649922.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8847; val_auprc_score: 0.8447; val_best_acc_score: 0.8227; val_best_f1_score: 0.8380; train_kl_reg_loss: 113940.9244; train_edge_recon_loss: 2847924.2008; train_gene_expr_recon_loss: 12378669.8333; train_masked_gp_l1_reg_loss: 74690.1172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116462.7714; train_chrom_access_recon_loss: 10638566.7879; train_global_loss: 26170254.5758; train_optim_loss: 26170254.5758; val_kl_reg_loss: 112886.2607; val_edge_recon_loss: 2887138.5312; val_gene_expr_recon_loss: 12352659.1250; val_masked_gp_l1_reg_loss: 75896.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113345.7812; val_chrom_access_recon_loss: 10820923.1250; val_global_loss: 26362849.0000; val_optim_loss: 26362849.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8992; val_auprc_score: 0.8614; val_best_acc_score: 0.8431; val_best_f1_score: 0.8552; train_kl_reg_loss: 109638.7100; train_edge_recon_loss: 2831477.6477; train_gene_expr_recon_loss: 12326944.1364; train_masked_gp_l1_reg_loss: 76930.6593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110148.3651; train_chrom_access_recon_loss: 10586676.0455; train_global_loss: 26041815.5758; train_optim_loss: 26041815.5758; val_kl_reg_loss: 107989.6406; val_edge_recon_loss: 2858040.9062; val_gene_expr_recon_loss: 12406250.3750; val_masked_gp_l1_reg_loss: 77897.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107349.0078; val_chrom_access_recon_loss: 10789731.7500; val_global_loss: 26347259.0000; val_optim_loss: 26347259.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8965; val_auprc_score: 0.8530; val_best_acc_score: 0.8415; val_best_f1_score: 0.8555; train_kl_reg_loss: 108173.7121; train_edge_recon_loss: 2812315.0379; train_gene_expr_recon_loss: 12267221.1667; train_masked_gp_l1_reg_loss: 78780.3942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105507.0561; train_chrom_access_recon_loss: 10550361.4697; train_global_loss: 25922358.6970; train_optim_loss: 25922358.6970; val_kl_reg_loss: 101254.2148; val_edge_recon_loss: 2860553.1250; val_gene_expr_recon_loss: 12274760.2500; val_masked_gp_l1_reg_loss: 79743.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103850.2344; val_chrom_access_recon_loss: 10808157.2500; val_global_loss: 26228317.7500; val_optim_loss: 26228317.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9042; val_auprc_score: 0.8707; val_best_acc_score: 0.8423; val_best_f1_score: 0.8506; train_kl_reg_loss: 104619.0169; train_edge_recon_loss: 2807433.3788; train_gene_expr_recon_loss: 12219280.3333; train_masked_gp_l1_reg_loss: 80461.6540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102065.0865; train_chrom_access_recon_loss: 10510056.9242; train_global_loss: 25823916.4545; train_optim_loss: 25823916.4545; val_kl_reg_loss: 104663.5127; val_edge_recon_loss: 2844378.4688; val_gene_expr_recon_loss: 12311178.5000; val_masked_gp_l1_reg_loss: 81354.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101266.1094; val_chrom_access_recon_loss: 10726704.3750; val_global_loss: 26169546.5000; val_optim_loss: 26169546.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9037; val_auprc_score: 0.8701; val_best_acc_score: 0.8418; val_best_f1_score: 0.8530; train_kl_reg_loss: 101262.6844; train_edge_recon_loss: 2812180.5606; train_gene_expr_recon_loss: 12176609.6970; train_masked_gp_l1_reg_loss: 82036.6050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100463.3999; train_chrom_access_recon_loss: 10479969.1061; train_global_loss: 25752522.0000; train_optim_loss: 25752522.0000; val_kl_reg_loss: 100495.1309; val_edge_recon_loss: 2834663.3438; val_gene_expr_recon_loss: 12176366.5000; val_masked_gp_l1_reg_loss: 82544.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99561.5312; val_chrom_access_recon_loss: 10607865.0000; val_global_loss: 25901496.0000; val_optim_loss: 25901496.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9193; val_auprc_score: 0.8980; val_best_acc_score: 0.8509; val_best_f1_score: 0.8625; train_kl_reg_loss: 100978.6275; train_edge_recon_loss: 2790060.0795; train_gene_expr_recon_loss: 12132850.0758; train_masked_gp_l1_reg_loss: 83199.2759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99060.6810; train_chrom_access_recon_loss: 10444617.8182; train_global_loss: 25650766.4545; train_optim_loss: 25650766.4545; val_kl_reg_loss: 100866.3789; val_edge_recon_loss: 2816236.0938; val_gene_expr_recon_loss: 12083716.3750; val_masked_gp_l1_reg_loss: 84015.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98823.1641; val_chrom_access_recon_loss: 10684188.2500; val_global_loss: 25867844.7500; val_optim_loss: 25867844.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9170; val_auprc_score: 0.8842; val_best_acc_score: 0.8576; val_best_f1_score: 0.8668; train_kl_reg_loss: 99353.2550; train_edge_recon_loss: 2792200.1288; train_gene_expr_recon_loss: 12081527.1970; train_masked_gp_l1_reg_loss: 84452.2743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98318.6358; train_chrom_access_recon_loss: 10400346.3182; train_global_loss: 25556197.9394; train_optim_loss: 25556197.9394; val_kl_reg_loss: 96774.2002; val_edge_recon_loss: 2777927.0000; val_gene_expr_recon_loss: 12173763.6250; val_masked_gp_l1_reg_loss: 85072.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98787.5547; val_chrom_access_recon_loss: 10576752.0000; val_global_loss: 25809076.7500; val_optim_loss: 25809076.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9164; val_auprc_score: 0.8831; val_best_acc_score: 0.8541; val_best_f1_score: 0.8668; train_kl_reg_loss: 99000.9651; train_edge_recon_loss: 2780445.1894; train_gene_expr_recon_loss: 12041112.1061; train_masked_gp_l1_reg_loss: 85465.6723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98133.7541; train_chrom_access_recon_loss: 10375342.3485; train_global_loss: 25479499.9697; train_optim_loss: 25479499.9697; val_kl_reg_loss: 101672.3799; val_edge_recon_loss: 2804720.7188; val_gene_expr_recon_loss: 12154845.8750; val_masked_gp_l1_reg_loss: 85886.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96931.1094; val_chrom_access_recon_loss: 10628182.2500; val_global_loss: 25872238.0000; val_optim_loss: 25872238.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9238; val_auprc_score: 0.8984; val_best_acc_score: 0.8624; val_best_f1_score: 0.8714; train_kl_reg_loss: 99674.1774; train_edge_recon_loss: 2758611.4735; train_gene_expr_recon_loss: 12009074.1515; train_masked_gp_l1_reg_loss: 86250.6170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96798.2718; train_chrom_access_recon_loss: 10341037.2727; train_global_loss: 25391445.8788; train_optim_loss: 25391445.8788; val_kl_reg_loss: 96767.9775; val_edge_recon_loss: 2808597.4062; val_gene_expr_recon_loss: 12180943.5000; val_masked_gp_l1_reg_loss: 86652.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96710.9766; val_chrom_access_recon_loss: 10725575.8750; val_global_loss: 25995248.0000; val_optim_loss: 25995248.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9310; val_auprc_score: 0.9094; val_best_acc_score: 0.8697; val_best_f1_score: 0.8771; train_kl_reg_loss: 98525.2009; train_edge_recon_loss: 2758186.7841; train_gene_expr_recon_loss: 11979356.0455; train_masked_gp_l1_reg_loss: 87040.5683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95986.0990; train_chrom_access_recon_loss: 10322569.6970; train_global_loss: 25341664.2121; train_optim_loss: 25341664.2121; val_kl_reg_loss: 95925.5312; val_edge_recon_loss: 2792420.0000; val_gene_expr_recon_loss: 12006047.8750; val_masked_gp_l1_reg_loss: 87525.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96225.1406; val_chrom_access_recon_loss: 10617139.3750; val_global_loss: 25695283.7500; val_optim_loss: 25695283.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9297; val_auprc_score: 0.9013; val_best_acc_score: 0.8694; val_best_f1_score: 0.8775; train_kl_reg_loss: 96551.3308; train_edge_recon_loss: 2758244.3977; train_gene_expr_recon_loss: 11937128.5455; train_masked_gp_l1_reg_loss: 87801.7534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95003.9786; train_chrom_access_recon_loss: 10274185.0606; train_global_loss: 25248915.0303; train_optim_loss: 25248915.0303; val_kl_reg_loss: 96880.3711; val_edge_recon_loss: 2770477.1875; val_gene_expr_recon_loss: 12047737.1250; val_masked_gp_l1_reg_loss: 88189.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94499.1797; val_chrom_access_recon_loss: 10521113.3750; val_global_loss: 25618897.2500; val_optim_loss: 25618897.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9314; val_auprc_score: 0.9057; val_best_acc_score: 0.8705; val_best_f1_score: 0.8778; train_kl_reg_loss: 96961.0581; train_edge_recon_loss: 2745154.0152; train_gene_expr_recon_loss: 11919660.8030; train_masked_gp_l1_reg_loss: 88415.1286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93631.7635; train_chrom_access_recon_loss: 10246759.2727; train_global_loss: 25190582.0303; train_optim_loss: 25190582.0303; val_kl_reg_loss: 100558.7725; val_edge_recon_loss: 2779828.3750; val_gene_expr_recon_loss: 11998585.3750; val_masked_gp_l1_reg_loss: 88746.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93248.7422; val_chrom_access_recon_loss: 10414588.6250; val_global_loss: 25475556.2500; val_optim_loss: 25475556.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9360; val_auprc_score: 0.9151; val_best_acc_score: 0.8769; val_best_f1_score: 0.8854; train_kl_reg_loss: 96336.0000; train_edge_recon_loss: 2747198.2841; train_gene_expr_recon_loss: 11883194.9242; train_masked_gp_l1_reg_loss: 88931.9734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93222.7919; train_chrom_access_recon_loss: 10210364.7273; train_global_loss: 25119248.5455; train_optim_loss: 25119248.5455; val_kl_reg_loss: 94958.4336; val_edge_recon_loss: 2766215.8125; val_gene_expr_recon_loss: 11971320.0000; val_masked_gp_l1_reg_loss: 89031.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92346.4844; val_chrom_access_recon_loss: 10403978.2500; val_global_loss: 25417850.7500; val_optim_loss: 25417850.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9383; val_auprc_score: 0.9165; val_best_acc_score: 0.8791; val_best_f1_score: 0.8871; train_kl_reg_loss: 95689.1450; train_edge_recon_loss: 2737610.4962; train_gene_expr_recon_loss: 11853159.4091; train_masked_gp_l1_reg_loss: 89311.9137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92359.7699; train_chrom_access_recon_loss: 10185204.7727; train_global_loss: 25053335.5455; train_optim_loss: 25053335.5455; val_kl_reg_loss: 95375.6514; val_edge_recon_loss: 2751889.8438; val_gene_expr_recon_loss: 11957263.5000; val_masked_gp_l1_reg_loss: 89354.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92088.2578; val_chrom_access_recon_loss: 10389972.0000; val_global_loss: 25375944.5000; val_optim_loss: 25375944.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9390; val_auprc_score: 0.9187; val_best_acc_score: 0.8788; val_best_f1_score: 0.8846; train_kl_reg_loss: 92315.9469; train_edge_recon_loss: 2740476.9167; train_gene_expr_recon_loss: 11826828.9394; train_masked_gp_l1_reg_loss: 89661.6586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91948.5985; train_chrom_access_recon_loss: 10137639.7727; train_global_loss: 24978871.6061; train_optim_loss: 24978871.6061; val_kl_reg_loss: 93135.9258; val_edge_recon_loss: 2765123.7188; val_gene_expr_recon_loss: 11822859.3750; val_masked_gp_l1_reg_loss: 90012.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91477.7188; val_chrom_access_recon_loss: 10361806.8750; val_global_loss: 25224416.0000; val_optim_loss: 25224416.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9396; val_auprc_score: 0.9122; val_best_acc_score: 0.8823; val_best_f1_score: 0.8877; train_kl_reg_loss: 93010.3565; train_edge_recon_loss: 2734070.4129; train_gene_expr_recon_loss: 11810488.9394; train_masked_gp_l1_reg_loss: 90137.1160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91197.7596; train_chrom_access_recon_loss: 10110103.3788; train_global_loss: 24929008.0000; train_optim_loss: 24929008.0000; val_kl_reg_loss: 92085.2930; val_edge_recon_loss: 2761279.3125; val_gene_expr_recon_loss: 11772664.3750; val_masked_gp_l1_reg_loss: 90204.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91069.8125; val_chrom_access_recon_loss: 10310002.0000; val_global_loss: 25117304.5000; val_optim_loss: 25117304.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9454; val_auprc_score: 0.9300; val_best_acc_score: 0.8877; val_best_f1_score: 0.8922; train_kl_reg_loss: 91086.7994; train_edge_recon_loss: 2732836.1477; train_gene_expr_recon_loss: 11795202.3939; train_masked_gp_l1_reg_loss: 90371.9355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90738.3260; train_chrom_access_recon_loss: 10095170.4394; train_global_loss: 24895405.9394; train_optim_loss: 24895405.9394; val_kl_reg_loss: 89064.0576; val_edge_recon_loss: 2762811.8438; val_gene_expr_recon_loss: 11927782.2500; val_masked_gp_l1_reg_loss: 90470.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90300.8906; val_chrom_access_recon_loss: 10366761.2500; val_global_loss: 25327191.7500; val_optim_loss: 25327191.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9448; val_auprc_score: 0.9218; val_best_acc_score: 0.8925; val_best_f1_score: 0.8974; train_kl_reg_loss: 89654.8913; train_edge_recon_loss: 2727094.9697; train_gene_expr_recon_loss: 11758056.1364; train_masked_gp_l1_reg_loss: 90658.6359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90220.1753; train_chrom_access_recon_loss: 10050110.2121; train_global_loss: 24805794.8182; train_optim_loss: 24805794.8182; val_kl_reg_loss: 88342.3203; val_edge_recon_loss: 2723844.9688; val_gene_expr_recon_loss: 11753980.8750; val_masked_gp_l1_reg_loss: 90846.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90220.4141; val_chrom_access_recon_loss: 10270277.0000; val_global_loss: 25017511.2500; val_optim_loss: 25017511.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9473; val_auprc_score: 0.9304; val_best_acc_score: 0.8880; val_best_f1_score: 0.8945; train_kl_reg_loss: 90251.5355; train_edge_recon_loss: 2728110.8220; train_gene_expr_recon_loss: 11736217.3485; train_masked_gp_l1_reg_loss: 90930.4754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89931.2120; train_chrom_access_recon_loss: 10014866.9848; train_global_loss: 24750308.5455; train_optim_loss: 24750308.5455; val_kl_reg_loss: 88462.1348; val_edge_recon_loss: 2733758.3125; val_gene_expr_recon_loss: 11813838.8750; val_masked_gp_l1_reg_loss: 91012.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89665.7578; val_chrom_access_recon_loss: 10326821.8750; val_global_loss: 25143559.2500; val_optim_loss: 25143559.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9455; val_auprc_score: 0.9206; val_best_acc_score: 0.8936; val_best_f1_score: 0.8988; train_kl_reg_loss: 90058.2584; train_edge_recon_loss: 2717305.0076; train_gene_expr_recon_loss: 11725401.5303; train_masked_gp_l1_reg_loss: 91046.1670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89663.7296; train_chrom_access_recon_loss: 9985829.6364; train_global_loss: 24699304.4242; train_optim_loss: 24699304.4242; val_kl_reg_loss: 89386.5791; val_edge_recon_loss: 2748683.9688; val_gene_expr_recon_loss: 11810243.6250; val_masked_gp_l1_reg_loss: 91209.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89489.5781; val_chrom_access_recon_loss: 10257412.8750; val_global_loss: 25086426.0000; val_optim_loss: 25086426.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9491; val_auprc_score: 0.9325; val_best_acc_score: 0.8909; val_best_f1_score: 0.8947; train_kl_reg_loss: 89794.4708; train_edge_recon_loss: 2714335.2879; train_gene_expr_recon_loss: 11703527.4394; train_masked_gp_l1_reg_loss: 91314.7437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89376.7775; train_chrom_access_recon_loss: 9959029.6515; train_global_loss: 24647378.5152; train_optim_loss: 24647378.5152; val_kl_reg_loss: 91179.7676; val_edge_recon_loss: 2776236.8125; val_gene_expr_recon_loss: 11674715.0000; val_masked_gp_l1_reg_loss: 91377.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89362.0312; val_chrom_access_recon_loss: 10167984.8750; val_global_loss: 24890855.5000; val_optim_loss: 24890855.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9483; val_auprc_score: 0.9242; val_best_acc_score: 0.8920; val_best_f1_score: 0.8980; train_kl_reg_loss: 89479.3898; train_edge_recon_loss: 2722990.5871; train_gene_expr_recon_loss: 11689292.7727; train_masked_gp_l1_reg_loss: 91408.4341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89475.9725; train_chrom_access_recon_loss: 9915520.8182; train_global_loss: 24598167.7576; train_optim_loss: 24598167.7576; val_kl_reg_loss: 92614.2021; val_edge_recon_loss: 2764625.1250; val_gene_expr_recon_loss: 11761512.8750; val_masked_gp_l1_reg_loss: 91473.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89257.0625; val_chrom_access_recon_loss: 10184982.3750; val_global_loss: 24984465.2500; val_optim_loss: 24984465.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9476; val_auprc_score: 0.9280; val_best_acc_score: 0.8958; val_best_f1_score: 0.9002; train_kl_reg_loss: 89459.3436; train_edge_recon_loss: 2714676.8485; train_gene_expr_recon_loss: 11659791.5909; train_masked_gp_l1_reg_loss: 91439.2522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89241.5819; train_chrom_access_recon_loss: 9885611.0000; train_global_loss: 24530219.5455; train_optim_loss: 24530219.5455; val_kl_reg_loss: 88815.9131; val_edge_recon_loss: 2760536.3750; val_gene_expr_recon_loss: 11666724.3750; val_masked_gp_l1_reg_loss: 91392.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88958.1016; val_chrom_access_recon_loss: 10050896.3750; val_global_loss: 24747323.0000; val_optim_loss: 24747323.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9502; val_auprc_score: 0.9282; val_best_acc_score: 0.8974; val_best_f1_score: 0.9007; train_kl_reg_loss: 87217.7578; train_edge_recon_loss: 2717549.3447; train_gene_expr_recon_loss: 11644398.5455; train_masked_gp_l1_reg_loss: 91494.2582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89062.8209; train_chrom_access_recon_loss: 9852285.3636; train_global_loss: 24482008.1818; train_optim_loss: 24482008.1818; val_kl_reg_loss: 88643.3545; val_edge_recon_loss: 2750450.1875; val_gene_expr_recon_loss: 11738212.8750; val_masked_gp_l1_reg_loss: 91661.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89266.6641; val_chrom_access_recon_loss: 10155863.2500; val_global_loss: 24914097.5000; val_optim_loss: 24914097.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9474; val_auprc_score: 0.9280; val_best_acc_score: 0.8947; val_best_f1_score: 0.9008; train_kl_reg_loss: 87567.8981; train_edge_recon_loss: 2717847.0000; train_gene_expr_recon_loss: 11630155.3485; train_masked_gp_l1_reg_loss: 91596.5430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89038.8080; train_chrom_access_recon_loss: 9824134.9242; train_global_loss: 24440340.3636; train_optim_loss: 24440340.3636; val_kl_reg_loss: 85261.7480; val_edge_recon_loss: 2765307.5938; val_gene_expr_recon_loss: 11822019.6250; val_masked_gp_l1_reg_loss: 91518.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88854.6172; val_chrom_access_recon_loss: 10200200.0000; val_global_loss: 25053163.0000; val_optim_loss: 25053163.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9533; val_auprc_score: 0.9313; val_best_acc_score: 0.9017; val_best_f1_score: 0.9066; train_kl_reg_loss: 85976.6764; train_edge_recon_loss: 2705604.8144; train_gene_expr_recon_loss: 11622944.0152; train_masked_gp_l1_reg_loss: 91634.4322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88859.9620; train_chrom_access_recon_loss: 9801058.2273; train_global_loss: 24396077.9697; train_optim_loss: 24396077.9697; val_kl_reg_loss: 87013.6299; val_edge_recon_loss: 2726507.7500; val_gene_expr_recon_loss: 11673900.0000; val_masked_gp_l1_reg_loss: 91714.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88636.5625; val_chrom_access_recon_loss: 10134484.5000; val_global_loss: 24802258.0000; val_optim_loss: 24802258.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9587; val_auprc_score: 0.9407; val_best_acc_score: 0.9081; val_best_f1_score: 0.9108; train_kl_reg_loss: 86547.3406; train_edge_recon_loss: 2704428.0947; train_gene_expr_recon_loss: 11606595.2273; train_masked_gp_l1_reg_loss: 91640.4126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88706.8543; train_chrom_access_recon_loss: 9772646.6667; train_global_loss: 24350564.5455; train_optim_loss: 24350564.5455; val_kl_reg_loss: 88894.2236; val_edge_recon_loss: 2748432.0312; val_gene_expr_recon_loss: 11661205.6250; val_masked_gp_l1_reg_loss: 91728.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88939.2109; val_chrom_access_recon_loss: 10043405.8750; val_global_loss: 24722605.0000; val_optim_loss: 24722605.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9511; val_auprc_score: 0.9265; val_best_acc_score: 0.9044; val_best_f1_score: 0.9082; train_kl_reg_loss: 86258.4319; train_edge_recon_loss: 2700760.0682; train_gene_expr_recon_loss: 11589142.2424; train_masked_gp_l1_reg_loss: 91613.2962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88670.6893; train_chrom_access_recon_loss: 9738816.6515; train_global_loss: 24295261.6061; train_optim_loss: 24295261.6061; val_kl_reg_loss: 86009.4092; val_edge_recon_loss: 2734216.5000; val_gene_expr_recon_loss: 11699169.2500; val_masked_gp_l1_reg_loss: 91669.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89000.5312; val_chrom_access_recon_loss: 10168597.6250; val_global_loss: 24868663.0000; val_optim_loss: 24868663.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9572; val_auprc_score: 0.9428; val_best_acc_score: 0.9041; val_best_f1_score: 0.9073; train_kl_reg_loss: 85570.5853; train_edge_recon_loss: 2702462.7386; train_gene_expr_recon_loss: 11581798.3485; train_masked_gp_l1_reg_loss: 91611.5316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88840.3839; train_chrom_access_recon_loss: 9725854.1970; train_global_loss: 24276137.6970; train_optim_loss: 24276137.6970; val_kl_reg_loss: 86430.5361; val_edge_recon_loss: 2751419.2812; val_gene_expr_recon_loss: 11755168.7500; val_masked_gp_l1_reg_loss: 91423.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88849.9766; val_chrom_access_recon_loss: 10170909.2500; val_global_loss: 24944200.7500; val_optim_loss: 24944200.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9529; val_auprc_score: 0.9330; val_best_acc_score: 0.9014; val_best_f1_score: 0.9050; train_kl_reg_loss: 85178.7847; train_edge_recon_loss: 2702899.8220; train_gene_expr_recon_loss: 11562647.6515; train_masked_gp_l1_reg_loss: 91472.5382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88847.6971; train_chrom_access_recon_loss: 9699942.7576; train_global_loss: 24230989.0909; train_optim_loss: 24230989.0909; val_kl_reg_loss: 87158.0850; val_edge_recon_loss: 2746254.9375; val_gene_expr_recon_loss: 11639042.8750; val_masked_gp_l1_reg_loss: 91272.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88905.3516; val_chrom_access_recon_loss: 10064982.7500; val_global_loss: 24717616.5000; val_optim_loss: 24717616.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9606; val_auprc_score: 0.9490; val_best_acc_score: 0.9054; val_best_f1_score: 0.9098; train_kl_reg_loss: 84540.8922; train_edge_recon_loss: 2701670.3864; train_gene_expr_recon_loss: 11545663.9545; train_masked_gp_l1_reg_loss: 91217.2157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88680.0833; train_chrom_access_recon_loss: 9669229.7121; train_global_loss: 24181002.2424; train_optim_loss: 24181002.2424; val_kl_reg_loss: 85343.3604; val_edge_recon_loss: 2732319.3438; val_gene_expr_recon_loss: 11627235.5000; val_masked_gp_l1_reg_loss: 91417.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89203.2109; val_chrom_access_recon_loss: 9949150.7500; val_global_loss: 24574669.2500; val_optim_loss: 24574669.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9552; val_auprc_score: 0.9402; val_best_acc_score: 0.8998; val_best_f1_score: 0.9040; train_kl_reg_loss: 83993.5026; train_edge_recon_loss: 2699325.2197; train_gene_expr_recon_loss: 11543135.1970; train_masked_gp_l1_reg_loss: 91254.0768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88824.2754; train_chrom_access_recon_loss: 9654695.8333; train_global_loss: 24161228.0606; train_optim_loss: 24161228.0606; val_kl_reg_loss: 85567.7910; val_edge_recon_loss: 2758948.2500; val_gene_expr_recon_loss: 11640678.3750; val_masked_gp_l1_reg_loss: 91245.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89002.2188; val_chrom_access_recon_loss: 10014080.0000; val_global_loss: 24679521.0000; val_optim_loss: 24679521.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9541; val_auprc_score: 0.9400; val_best_acc_score: 0.9003; val_best_f1_score: 0.9054; train_kl_reg_loss: 83173.7586; train_edge_recon_loss: 2705899.1970; train_gene_expr_recon_loss: 11522568.0303; train_masked_gp_l1_reg_loss: 91142.7579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88944.6218; train_chrom_access_recon_loss: 9627400.2424; train_global_loss: 24119128.5455; train_optim_loss: 24119128.5455; val_kl_reg_loss: 85589.9844; val_edge_recon_loss: 2730553.9688; val_gene_expr_recon_loss: 11617874.6250; val_masked_gp_l1_reg_loss: 91187.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88820.9766; val_chrom_access_recon_loss: 9939138.6250; val_global_loss: 24553166.7500; val_optim_loss: 24553166.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9569; val_auprc_score: 0.9334; val_best_acc_score: 0.9084; val_best_f1_score: 0.9123; train_kl_reg_loss: 84113.6386; train_edge_recon_loss: 2697096.4886; train_gene_expr_recon_loss: 11517609.3636; train_masked_gp_l1_reg_loss: 90984.6451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88752.1303; train_chrom_access_recon_loss: 9608943.4242; train_global_loss: 24087499.6061; train_optim_loss: 24087499.6061; val_kl_reg_loss: 83702.4951; val_edge_recon_loss: 2762174.9375; val_gene_expr_recon_loss: 11541272.1250; val_masked_gp_l1_reg_loss: 90894.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88940.9141; val_chrom_access_recon_loss: 9949411.3750; val_global_loss: 24516396.0000; val_optim_loss: 24516396.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9551; val_auprc_score: 0.9325; val_best_acc_score: 0.9062; val_best_f1_score: 0.9105; train_kl_reg_loss: 83686.6690; train_edge_recon_loss: 2691177.0189; train_gene_expr_recon_loss: 11510308.2879; train_masked_gp_l1_reg_loss: 90867.5013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88984.0582; train_chrom_access_recon_loss: 9597334.1061; train_global_loss: 24062357.6364; train_optim_loss: 24062357.6364; val_kl_reg_loss: 86919.3154; val_edge_recon_loss: 2741596.8125; val_gene_expr_recon_loss: 11595469.8750; val_masked_gp_l1_reg_loss: 90770.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88947.7266; val_chrom_access_recon_loss: 9956062.0000; val_global_loss: 24559766.0000; val_optim_loss: 24559766.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9603; val_auprc_score: 0.9397; val_best_acc_score: 0.9124; val_best_f1_score: 0.9147; train_kl_reg_loss: 83469.6862; train_edge_recon_loss: 2700879.9924; train_gene_expr_recon_loss: 11490357.7879; train_masked_gp_l1_reg_loss: 90631.4987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88889.4237; train_chrom_access_recon_loss: 9562329.1061; train_global_loss: 24016557.3939; train_optim_loss: 24016557.3939; val_kl_reg_loss: 84488.6377; val_edge_recon_loss: 2744738.2188; val_gene_expr_recon_loss: 11595023.7500; val_masked_gp_l1_reg_loss: 90565.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89231.0078; val_chrom_access_recon_loss: 9956062.8750; val_global_loss: 24560109.2500; val_optim_loss: 24560109.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9618; val_auprc_score: 0.9439; val_best_acc_score: 0.9154; val_best_f1_score: 0.9181; train_kl_reg_loss: 83167.8337; train_edge_recon_loss: 2698266.7576; train_gene_expr_recon_loss: 11479610.3030; train_masked_gp_l1_reg_loss: 90371.8078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89032.5447; train_chrom_access_recon_loss: 9554439.5758; train_global_loss: 23994888.7879; train_optim_loss: 23994888.7879; val_kl_reg_loss: 85327.8496; val_edge_recon_loss: 2705259.7500; val_gene_expr_recon_loss: 11645894.3750; val_masked_gp_l1_reg_loss: 90332.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89113.3125; val_chrom_access_recon_loss: 9953565.7500; val_global_loss: 24569493.2500; val_optim_loss: 24569493.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9529; val_auprc_score: 0.9282; val_best_acc_score: 0.9119; val_best_f1_score: 0.9148; train_kl_reg_loss: 81988.1744; train_edge_recon_loss: 2700010.1932; train_gene_expr_recon_loss: 11475339.9848; train_masked_gp_l1_reg_loss: 90253.2959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89201.9902; train_chrom_access_recon_loss: 9534284.1364; train_global_loss: 23971077.7879; train_optim_loss: 23971077.7879; val_kl_reg_loss: 84812.0391; val_edge_recon_loss: 2751525.7188; val_gene_expr_recon_loss: 11667432.7500; val_masked_gp_l1_reg_loss: 90326.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88976.1641; val_chrom_access_recon_loss: 10021864.3750; val_global_loss: 24704937.0000; val_optim_loss: 24704937.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9580; val_auprc_score: 0.9378; val_best_acc_score: 0.9127; val_best_f1_score: 0.9162; train_kl_reg_loss: 84086.5238; train_edge_recon_loss: 2691211.2841; train_gene_expr_recon_loss: 11454995.1667; train_masked_gp_l1_reg_loss: 89295.2723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69362.0502; train_chrom_access_recon_loss: 9503955.4848; train_global_loss: 23892905.7879; train_optim_loss: 23892905.7879; val_kl_reg_loss: 85594.1650; val_edge_recon_loss: 2750034.5625; val_gene_expr_recon_loss: 11595291.7500; val_masked_gp_l1_reg_loss: 88839.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65389.8164; val_chrom_access_recon_loss: 10045174.8750; val_global_loss: 24630324.2500; val_optim_loss: 24630324.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9599; val_auprc_score: 0.9388; val_best_acc_score: 0.9162; val_best_f1_score: 0.9191; train_kl_reg_loss: 84171.8829; train_edge_recon_loss: 2689887.5568; train_gene_expr_recon_loss: 11454895.4848; train_masked_gp_l1_reg_loss: 88746.0102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65043.5775; train_chrom_access_recon_loss: 9493488.9091; train_global_loss: 23876233.4848; train_optim_loss: 23876233.4848; val_kl_reg_loss: 86346.0215; val_edge_recon_loss: 2729830.1562; val_gene_expr_recon_loss: 11571536.8750; val_masked_gp_l1_reg_loss: 88686.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64838.0117; val_chrom_access_recon_loss: 9980938.2500; val_global_loss: 24522175.2500; val_optim_loss: 24522175.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9619; val_auprc_score: 0.9449; val_best_acc_score: 0.9143; val_best_f1_score: 0.9181; train_kl_reg_loss: 84234.2520; train_edge_recon_loss: 2689374.3750; train_gene_expr_recon_loss: 11461898.8636; train_masked_gp_l1_reg_loss: 88648.3655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64670.5977; train_chrom_access_recon_loss: 9501804.5909; train_global_loss: 23890631.0303; train_optim_loss: 23890631.0303; val_kl_reg_loss: 85718.1787; val_edge_recon_loss: 2717307.1875; val_gene_expr_recon_loss: 11605303.7500; val_masked_gp_l1_reg_loss: 88628.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64484.7031; val_chrom_access_recon_loss: 9948807.6250; val_global_loss: 24510249.7500; val_optim_loss: 24510249.7500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9649; val_auprc_score: 0.9509; val_best_acc_score: 0.9199; val_best_f1_score: 0.9221; train_kl_reg_loss: 84203.6809; train_edge_recon_loss: 2698915.6061; train_gene_expr_recon_loss: 11445076.8485; train_masked_gp_l1_reg_loss: 88596.7060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64378.1930; train_chrom_access_recon_loss: 9480574.0758; train_global_loss: 23861745.3030; train_optim_loss: 23861745.3030; val_kl_reg_loss: 85593.5195; val_edge_recon_loss: 2707181.8750; val_gene_expr_recon_loss: 11555874.0000; val_masked_gp_l1_reg_loss: 88570.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64222.3359; val_chrom_access_recon_loss: 9976075.3750; val_global_loss: 24477516.7500; val_optim_loss: 24477516.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9628; val_auprc_score: 0.9453; val_best_acc_score: 0.9140; val_best_f1_score: 0.9168; train_kl_reg_loss: 83557.1648; train_edge_recon_loss: 2686712.9280; train_gene_expr_recon_loss: 11453928.8636; train_masked_gp_l1_reg_loss: 88556.2913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64099.8967; train_chrom_access_recon_loss: 9486494.4848; train_global_loss: 23863349.8182; train_optim_loss: 23863349.8182; val_kl_reg_loss: 85188.6504; val_edge_recon_loss: 2730126.8125; val_gene_expr_recon_loss: 11624875.3750; val_masked_gp_l1_reg_loss: 88545.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63988.1289; val_chrom_access_recon_loss: 10015819.6250; val_global_loss: 24608543.0000; val_optim_loss: 24608543.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9614; val_auprc_score: 0.9415; val_best_acc_score: 0.9154; val_best_f1_score: 0.9178; train_kl_reg_loss: 84159.7777; train_edge_recon_loss: 2683092.6667; train_gene_expr_recon_loss: 11461120.7879; train_masked_gp_l1_reg_loss: 88546.0421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63934.8675; train_chrom_access_recon_loss: 9499352.2576; train_global_loss: 23880206.3333; train_optim_loss: 23880206.3333; val_kl_reg_loss: 85998.8193; val_edge_recon_loss: 2734875.1875; val_gene_expr_recon_loss: 11587631.5000; val_masked_gp_l1_reg_loss: 88537.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63767.9219; val_chrom_access_recon_loss: 9886164.3750; val_global_loss: 24446975.2500; val_optim_loss: 24446975.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9670; val_auprc_score: 0.9507; val_best_acc_score: 0.9194; val_best_f1_score: 0.9224; train_kl_reg_loss: 84103.1112; train_edge_recon_loss: 2693385.9318; train_gene_expr_recon_loss: 11448184.6364; train_masked_gp_l1_reg_loss: 88501.6386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63649.9263; train_chrom_access_recon_loss: 9481382.5455; train_global_loss: 23859207.7576; train_optim_loss: 23859207.7576; val_kl_reg_loss: 84809.3848; val_edge_recon_loss: 2703671.0000; val_gene_expr_recon_loss: 11527483.7500; val_masked_gp_l1_reg_loss: 88493.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63521.1133; val_chrom_access_recon_loss: 10038063.1250; val_global_loss: 24506042.5000; val_optim_loss: 24506042.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9653; val_auprc_score: 0.9528; val_best_acc_score: 0.9167; val_best_f1_score: 0.9189; train_kl_reg_loss: 83780.1770; train_edge_recon_loss: 2695546.2311; train_gene_expr_recon_loss: 11449351.2424; train_masked_gp_l1_reg_loss: 88483.1922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63443.4665; train_chrom_access_recon_loss: 9479830.7121; train_global_loss: 23860435.2121; train_optim_loss: 23860435.2121; val_kl_reg_loss: 85421.7041; val_edge_recon_loss: 2704564.8438; val_gene_expr_recon_loss: 11671980.2500; val_masked_gp_l1_reg_loss: 88465.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63355.9297; val_chrom_access_recon_loss: 10017706.3750; val_global_loss: 24631493.7500; val_optim_loss: 24631493.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9612; val_auprc_score: 0.9384; val_best_acc_score: 0.9164; val_best_f1_score: 0.9195; train_kl_reg_loss: 83827.4632; train_edge_recon_loss: 2691735.9962; train_gene_expr_recon_loss: 11435582.1970; train_masked_gp_l1_reg_loss: 88446.1998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63247.9001; train_chrom_access_recon_loss: 9466238.1818; train_global_loss: 23829077.8182; train_optim_loss: 23829077.8182; val_kl_reg_loss: 84904.6816; val_edge_recon_loss: 2740232.1250; val_gene_expr_recon_loss: 11494136.2500; val_masked_gp_l1_reg_loss: 88424.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63179.4453; val_chrom_access_recon_loss: 9941853.1250; val_global_loss: 24412730.2500; val_optim_loss: 24412730.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9604; val_auprc_score: 0.9381; val_best_acc_score: 0.9119; val_best_f1_score: 0.9150; train_kl_reg_loss: 84293.4289; train_edge_recon_loss: 2691092.3182; train_gene_expr_recon_loss: 11454116.1970; train_masked_gp_l1_reg_loss: 88423.8026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63087.1412; train_chrom_access_recon_loss: 9475950.3485; train_global_loss: 23856963.3939; train_optim_loss: 23856963.3939; val_kl_reg_loss: 85452.1016; val_edge_recon_loss: 2752735.9062; val_gene_expr_recon_loss: 11513998.6250; val_masked_gp_l1_reg_loss: 88405.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62970.6250; val_chrom_access_recon_loss: 9935884.2500; val_global_loss: 24439446.7500; val_optim_loss: 24439446.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9682; val_auprc_score: 0.9539; val_best_acc_score: 0.9240; val_best_f1_score: 0.9252; train_kl_reg_loss: 83985.0769; train_edge_recon_loss: 2687155.8523; train_gene_expr_recon_loss: 11435649.3030; train_masked_gp_l1_reg_loss: 88386.8466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62872.5324; train_chrom_access_recon_loss: 9468716.6061; train_global_loss: 23826766.1818; train_optim_loss: 23826766.1818; val_kl_reg_loss: 86038.0264; val_edge_recon_loss: 2718581.3438; val_gene_expr_recon_loss: 11597499.8750; val_masked_gp_l1_reg_loss: 88374.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62775.8203; val_chrom_access_recon_loss: 9883586.5000; val_global_loss: 24436855.7500; val_optim_loss: 24436855.7500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9625; val_auprc_score: 0.9473; val_best_acc_score: 0.9130; val_best_f1_score: 0.9153; train_kl_reg_loss: 84286.7537; train_edge_recon_loss: 2690053.8636; train_gene_expr_recon_loss: 11440470.6667; train_masked_gp_l1_reg_loss: 88356.7604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62664.0194; train_chrom_access_recon_loss: 9468684.3182; train_global_loss: 23834516.4545; train_optim_loss: 23834516.4545; val_kl_reg_loss: 85503.7695; val_edge_recon_loss: 2730165.0312; val_gene_expr_recon_loss: 11506402.2500; val_masked_gp_l1_reg_loss: 88348.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62608.5000; val_chrom_access_recon_loss: 9801432.7500; val_global_loss: 24274461.2500; val_optim_loss: 24274461.2500
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9636; val_auprc_score: 0.9488; val_best_acc_score: 0.9213; val_best_f1_score: 0.9234; train_kl_reg_loss: 84553.8419; train_edge_recon_loss: 2684744.6780; train_gene_expr_recon_loss: 11442441.3485; train_masked_gp_l1_reg_loss: 88340.8712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62528.8012; train_chrom_access_recon_loss: 9475808.2576; train_global_loss: 23838417.8182; train_optim_loss: 23838417.8182; val_kl_reg_loss: 86042.7754; val_edge_recon_loss: 2729195.6875; val_gene_expr_recon_loss: 11579371.5000; val_masked_gp_l1_reg_loss: 88314.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62456.7383; val_chrom_access_recon_loss: 9885990.1250; val_global_loss: 24431372.0000; val_optim_loss: 24431372.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9651; val_auprc_score: 0.9510; val_best_acc_score: 0.9167; val_best_f1_score: 0.9198; train_kl_reg_loss: 84036.5552; train_edge_recon_loss: 2693785.5341; train_gene_expr_recon_loss: 11446060.7273; train_masked_gp_l1_reg_loss: 88312.5303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62395.2598; train_chrom_access_recon_loss: 9479509.5606; train_global_loss: 23854100.3030; train_optim_loss: 23854100.3030; val_kl_reg_loss: 85170.8770; val_edge_recon_loss: 2727879.5312; val_gene_expr_recon_loss: 11516083.0000; val_masked_gp_l1_reg_loss: 88312.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62342.0195; val_chrom_access_recon_loss: 9944142.2500; val_global_loss: 24423929.5000; val_optim_loss: 24423929.5000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9633; val_auprc_score: 0.9478; val_best_acc_score: 0.9154; val_best_f1_score: 0.9174; train_kl_reg_loss: 83794.7518; train_edge_recon_loss: 2686347.2386; train_gene_expr_recon_loss: 11446760.9848; train_masked_gp_l1_reg_loss: 88285.2004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62233.9070; train_chrom_access_recon_loss: 9476118.9545; train_global_loss: 23843541.1818; train_optim_loss: 23843541.1818; val_kl_reg_loss: 85167.2256; val_edge_recon_loss: 2749079.9062; val_gene_expr_recon_loss: 11570400.7500; val_masked_gp_l1_reg_loss: 88292.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62202.9727; val_chrom_access_recon_loss: 9897357.6250; val_global_loss: 24452500.2500; val_optim_loss: 24452500.2500
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9649; val_auprc_score: 0.9427; val_best_acc_score: 0.9199; val_best_f1_score: 0.9219; train_kl_reg_loss: 83960.9824; train_edge_recon_loss: 2687211.6667; train_gene_expr_recon_loss: 11443198.7273; train_masked_gp_l1_reg_loss: 88293.6589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62118.8417; train_chrom_access_recon_loss: 9468387.0758; train_global_loss: 23833171.0000; train_optim_loss: 23833171.0000; val_kl_reg_loss: 85130.9170; val_edge_recon_loss: 2730737.4375; val_gene_expr_recon_loss: 11582670.1250; val_masked_gp_l1_reg_loss: 88262.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62032.5195; val_chrom_access_recon_loss: 9984190.5000; val_global_loss: 24533023.7500; val_optim_loss: 24533023.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9603; val_auprc_score: 0.9393; val_best_acc_score: 0.9167; val_best_f1_score: 0.9191; train_kl_reg_loss: 83615.4766; train_edge_recon_loss: 2691298.5909; train_gene_expr_recon_loss: 11434949.6667; train_masked_gp_l1_reg_loss: 88162.2750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60070.0564; train_chrom_access_recon_loss: 9458524.8485; train_global_loss: 23816620.9091; train_optim_loss: 23816620.9091; val_kl_reg_loss: 85029.7529; val_edge_recon_loss: 2725280.1875; val_gene_expr_recon_loss: 11473497.2500; val_masked_gp_l1_reg_loss: 88115.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59677.7422; val_chrom_access_recon_loss: 9925106.8750; val_global_loss: 24356708.0000; val_optim_loss: 24356708.0000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9649; val_auprc_score: 0.9469; val_best_acc_score: 0.9221; val_best_f1_score: 0.9243; train_kl_reg_loss: 83893.3298; train_edge_recon_loss: 2692911.6705; train_gene_expr_recon_loss: 11438102.7273; train_masked_gp_l1_reg_loss: 88102.3149; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59636.4384; train_chrom_access_recon_loss: 9458318.5000; train_global_loss: 23820965.1212; train_optim_loss: 23820965.1212; val_kl_reg_loss: 85566.1904; val_edge_recon_loss: 2684200.1875; val_gene_expr_recon_loss: 11616512.0000; val_masked_gp_l1_reg_loss: 88093.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59611.0742; val_chrom_access_recon_loss: 9967020.7500; val_global_loss: 24501003.0000; val_optim_loss: 24501003.0000
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9639; val_auprc_score: 0.9469; val_best_acc_score: 0.9186; val_best_f1_score: 0.9210; train_kl_reg_loss: 83774.1534; train_edge_recon_loss: 2687218.2614; train_gene_expr_recon_loss: 11443547.8636; train_masked_gp_l1_reg_loss: 88087.7878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59590.6976; train_chrom_access_recon_loss: 9461563.3030; train_global_loss: 23823782.2727; train_optim_loss: 23823782.2727; val_kl_reg_loss: 85181.0303; val_edge_recon_loss: 2714189.7500; val_gene_expr_recon_loss: 11561766.6250; val_masked_gp_l1_reg_loss: 88083.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59571.9180; val_chrom_access_recon_loss: 9934769.6250; val_global_loss: 24443562.5000; val_optim_loss: 24443562.5000
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9685; val_auprc_score: 0.9539; val_best_acc_score: 0.9253; val_best_f1_score: 0.9275; train_kl_reg_loss: 83785.0387; train_edge_recon_loss: 2684378.2500; train_gene_expr_recon_loss: 11444318.1970; train_masked_gp_l1_reg_loss: 88079.9780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59557.6147; train_chrom_access_recon_loss: 9468786.4545; train_global_loss: 23828905.6061; train_optim_loss: 23828905.6061; val_kl_reg_loss: 85051.8203; val_edge_recon_loss: 2695916.3125; val_gene_expr_recon_loss: 11584266.0000; val_masked_gp_l1_reg_loss: 88077.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59540.0625; val_chrom_access_recon_loss: 9950523.3750; val_global_loss: 24463374.2500; val_optim_loss: 24463374.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 29 min 8 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.9668
val AUPRC score: 0.9534
val best accuracy score: 0.9164
val best F1 score: 0.9195
val target rna MSE score: 1.2824
val source rna MSE score: 0.8834
val target atac MSE score: 0.3360
val source atac MSE score: 0.1229
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
