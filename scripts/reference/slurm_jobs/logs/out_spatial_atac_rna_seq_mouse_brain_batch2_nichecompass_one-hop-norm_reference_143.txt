[True]
Run timestamp: 29072023_132114_143.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_143']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8849; val_auprc_score: 0.9043; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 32563.8864; train_edge_recon_loss: 34802889.7778; train_gene_expr_recon_loss: 7381276.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 183627608.8889; train_global_loss: 225844337.7778; train_optim_loss: 225844337.7778; val_kl_reg_loss: 24295.0430; val_edge_recon_loss: 40652268.0000; val_gene_expr_recon_loss: 6785510.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 175902816.0000; val_global_loss: 223364896.0000; val_optim_loss: 223364896.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8861; val_auprc_score: 0.9055; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 37672.6461; train_edge_recon_loss: 34878676.4444; train_gene_expr_recon_loss: 7011019.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 173333656.8889; train_global_loss: 215261029.3333; train_optim_loss: 215261029.3333; val_kl_reg_loss: 25909.7461; val_edge_recon_loss: 40655748.0000; val_gene_expr_recon_loss: 6800518.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 174457008.0000; val_global_loss: 221939184.0000; val_optim_loss: 221939184.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8786; val_auprc_score: 0.8936; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 54448.6328; train_edge_recon_loss: 34873788.0000; train_gene_expr_recon_loss: 6609733.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 172238885.3333; train_global_loss: 213776856.8889; train_optim_loss: 213776856.8889; val_kl_reg_loss: 34746.9453; val_edge_recon_loss: 40657504.0000; val_gene_expr_recon_loss: 6512637.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 172867664.0000; val_global_loss: 220072544.0000; val_optim_loss: 220072544.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8676; val_auprc_score: 0.8828; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 55059.8377; train_edge_recon_loss: 34894800.4444; train_gene_expr_recon_loss: 6464601.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 168681159.1111; train_global_loss: 210095619.5556; train_optim_loss: 210095619.5556; val_kl_reg_loss: 93850.5312; val_edge_recon_loss: 40658236.0000; val_gene_expr_recon_loss: 6423939.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 170895616.0000; val_global_loss: 218071648.0000; val_optim_loss: 218071648.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8636; val_auprc_score: 0.8792; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 155870.1076; train_edge_recon_loss: 34769916.8889; train_gene_expr_recon_loss: 6336630.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 167780272.0000; train_global_loss: 209042689.7778; train_optim_loss: 209042689.7778; val_kl_reg_loss: 185275.6094; val_edge_recon_loss: 40659232.0000; val_gene_expr_recon_loss: 6216379.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 168958544.0000; val_global_loss: 216019424.0000; val_optim_loss: 216019424.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8635; val_auprc_score: 0.8802; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 221049.3819; train_edge_recon_loss: 34804978.6667; train_gene_expr_recon_loss: 6095501.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 166192867.5556; train_global_loss: 207314398.2222; train_optim_loss: 207314398.2222; val_kl_reg_loss: 179149.0312; val_edge_recon_loss: 40660484.0000; val_gene_expr_recon_loss: 6035776.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 167425280.0000; val_global_loss: 214300688.0000; val_optim_loss: 214300688.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8717; val_auprc_score: 0.8888; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 284660.8819; train_edge_recon_loss: 34816170.6667; train_gene_expr_recon_loss: 6004214.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 164789086.2222; train_global_loss: 205894131.5556; train_optim_loss: 205894131.5556; val_kl_reg_loss: 167854.5625; val_edge_recon_loss: 40660696.0000; val_gene_expr_recon_loss: 5921636.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 166022272.0000; val_global_loss: 212772464.0000; val_optim_loss: 212772464.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8771; val_auprc_score: 0.8842; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 274507.8611; train_edge_recon_loss: 34830855.5556; train_gene_expr_recon_loss: 5832172.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 162976688.0000; train_global_loss: 203914222.2222; train_optim_loss: 203914222.2222; val_kl_reg_loss: 235168.1562; val_edge_recon_loss: 40660616.0000; val_gene_expr_recon_loss: 5750378.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 164908880.0000; val_global_loss: 211555040.0000; val_optim_loss: 211555040.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8739; val_auprc_score: 0.8848; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 289118.1424; train_edge_recon_loss: 34843683.5556; train_gene_expr_recon_loss: 5648583.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 161793310.2222; train_global_loss: 202574698.6667; train_optim_loss: 202574698.6667; val_kl_reg_loss: 246858.8125; val_edge_recon_loss: 40660460.0000; val_gene_expr_recon_loss: 5581076.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 163776480.0000; val_global_loss: 210264880.0000; val_optim_loss: 210264880.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8665; val_auprc_score: 0.8781; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 300059.6510; train_edge_recon_loss: 34805917.7778; train_gene_expr_recon_loss: 5504773.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 161589560.8889; train_global_loss: 202200309.3333; train_optim_loss: 202200309.3333; val_kl_reg_loss: 226404.2812; val_edge_recon_loss: 40659588.0000; val_gene_expr_recon_loss: 5415103.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 162577792.0000; val_global_loss: 208878880.0000; val_optim_loss: 208878880.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8619; val_auprc_score: 0.8707; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 307318.7014; train_edge_recon_loss: 34799576.8889; train_gene_expr_recon_loss: 5323504.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 160472478.2222; train_global_loss: 200902876.4444; train_optim_loss: 200902876.4444; val_kl_reg_loss: 222967.9688; val_edge_recon_loss: 40658648.0000; val_gene_expr_recon_loss: 5225370.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 161466240.0000; val_global_loss: 207573216.0000; val_optim_loss: 207573216.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8447; val_auprc_score: 0.8526; val_best_acc_score: 0.5011; val_best_f1_score: 0.6671; train_kl_reg_loss: 307646.7708; train_edge_recon_loss: 34818252.4444; train_gene_expr_recon_loss: 5116731.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 159179589.3333; train_global_loss: 199422220.4444; train_optim_loss: 199422220.4444; val_kl_reg_loss: 204554.7812; val_edge_recon_loss: 40657860.0000; val_gene_expr_recon_loss: 5048710.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 160514080.0000; val_global_loss: 206425216.0000; val_optim_loss: 206425216.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8406; val_auprc_score: 0.8497; val_best_acc_score: 0.5012; val_best_f1_score: 0.6672; train_kl_reg_loss: 295970.5590; train_edge_recon_loss: 34850423.5556; train_gene_expr_recon_loss: 4942407.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 157862186.6667; train_global_loss: 197950988.4444; train_optim_loss: 197950988.4444; val_kl_reg_loss: 199911.7656; val_edge_recon_loss: 40656860.0000; val_gene_expr_recon_loss: 4885900.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 159422560.0000; val_global_loss: 205165232.0000; val_optim_loss: 205165232.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8316; val_auprc_score: 0.8409; val_best_acc_score: 0.5022; val_best_f1_score: 0.6676; train_kl_reg_loss: 282878.8507; train_edge_recon_loss: 34824303.5556; train_gene_expr_recon_loss: 4775634.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 156311018.6667; train_global_loss: 196193834.6667; train_optim_loss: 196193834.6667; val_kl_reg_loss: 196341.5938; val_edge_recon_loss: 40656184.0000; val_gene_expr_recon_loss: 4737388.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 158315552.0000; val_global_loss: 203905472.0000; val_optim_loss: 203905472.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8294; val_auprc_score: 0.8399; val_best_acc_score: 0.5027; val_best_f1_score: 0.6679; train_kl_reg_loss: 268184.8802; train_edge_recon_loss: 34847270.2222; train_gene_expr_recon_loss: 4619485.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155802600.8889; train_global_loss: 195537544.8889; train_optim_loss: 195537544.8889; val_kl_reg_loss: 203004.9688; val_edge_recon_loss: 40655288.0000; val_gene_expr_recon_loss: 4598211.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 157690752.0000; val_global_loss: 203147264.0000; val_optim_loss: 203147264.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8270; val_auprc_score: 0.8378; val_best_acc_score: 0.5071; val_best_f1_score: 0.6699; train_kl_reg_loss: 266128.8767; train_edge_recon_loss: 34835428.4444; train_gene_expr_recon_loss: 4523264.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 155174709.3333; train_global_loss: 194799532.4444; train_optim_loss: 194799532.4444; val_kl_reg_loss: 201231.0469; val_edge_recon_loss: 40653484.0000; val_gene_expr_recon_loss: 4509618.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156793024.0000; val_global_loss: 202157360.0000; val_optim_loss: 202157360.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8209; val_auprc_score: 0.8293; val_best_acc_score: 0.5062; val_best_f1_score: 0.6694; train_kl_reg_loss: 253899.4097; train_edge_recon_loss: 34814472.4444; train_gene_expr_recon_loss: 4399743.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154185048.8889; train_global_loss: 193653162.6667; train_optim_loss: 193653162.6667; val_kl_reg_loss: 202752.8906; val_edge_recon_loss: 40653736.0000; val_gene_expr_recon_loss: 4394775.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156375696.0000; val_global_loss: 201626960.0000; val_optim_loss: 201626960.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8223; val_auprc_score: 0.8312; val_best_acc_score: 0.5077; val_best_f1_score: 0.6701; train_kl_reg_loss: 248681.9444; train_edge_recon_loss: 34813036.0000; train_gene_expr_recon_loss: 4322960.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154058076.4444; train_global_loss: 193442755.5556; train_optim_loss: 193442755.5556; val_kl_reg_loss: 186042.0000; val_edge_recon_loss: 40652592.0000; val_gene_expr_recon_loss: 4323274.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156251344.0000; val_global_loss: 201413248.0000; val_optim_loss: 201413248.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8312; val_auprc_score: 0.8402; val_best_acc_score: 0.5097; val_best_f1_score: 0.6710; train_kl_reg_loss: 247118.5122; train_edge_recon_loss: 34817283.5556; train_gene_expr_recon_loss: 4262319.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154245411.5556; train_global_loss: 193572131.5556; train_optim_loss: 193572131.5556; val_kl_reg_loss: 186281.2500; val_edge_recon_loss: 40651540.0000; val_gene_expr_recon_loss: 4251093.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155603408.0000; val_global_loss: 200692320.0000; val_optim_loss: 200692320.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8281; val_auprc_score: 0.8377; val_best_acc_score: 0.5137; val_best_f1_score: 0.6728; train_kl_reg_loss: 235241.2431; train_edge_recon_loss: 34817838.2222; train_gene_expr_recon_loss: 4192677.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153273952.0000; train_global_loss: 192519710.2222; train_optim_loss: 192519710.2222; val_kl_reg_loss: 186015.5938; val_edge_recon_loss: 40649388.0000; val_gene_expr_recon_loss: 4185880.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155448768.0000; val_global_loss: 200470048.0000; val_optim_loss: 200470048.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8286; val_auprc_score: 0.8320; val_best_acc_score: 0.5164; val_best_f1_score: 0.6739; train_kl_reg_loss: 233098.2326; train_edge_recon_loss: 34815101.7778; train_gene_expr_recon_loss: 4139197.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153189973.3333; train_global_loss: 192377370.6667; train_optim_loss: 192377370.6667; val_kl_reg_loss: 197062.4531; val_edge_recon_loss: 40648000.0000; val_gene_expr_recon_loss: 4132515.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155093472.0000; val_global_loss: 200071056.0000; val_optim_loss: 200071056.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8279; val_auprc_score: 0.8312; val_best_acc_score: 0.5189; val_best_f1_score: 0.6750; train_kl_reg_loss: 238213.3785; train_edge_recon_loss: 34812206.6667; train_gene_expr_recon_loss: 4079311.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152772691.5556; train_global_loss: 191902424.8889; train_optim_loss: 191902424.8889; val_kl_reg_loss: 176450.1250; val_edge_recon_loss: 40646036.0000; val_gene_expr_recon_loss: 4098631.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155037376.0000; val_global_loss: 199958496.0000; val_optim_loss: 199958496.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8357; val_auprc_score: 0.8341; val_best_acc_score: 0.5189; val_best_f1_score: 0.6749; train_kl_reg_loss: 219362.7240; train_edge_recon_loss: 34828284.0000; train_gene_expr_recon_loss: 4038887.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152236307.5556; train_global_loss: 191322840.8889; train_optim_loss: 191322840.8889; val_kl_reg_loss: 189595.7188; val_edge_recon_loss: 40643756.0000; val_gene_expr_recon_loss: 4058002.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154814848.0000; val_global_loss: 199706208.0000; val_optim_loss: 199706208.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8421; val_auprc_score: 0.8412; val_best_acc_score: 0.5217; val_best_f1_score: 0.6762; train_kl_reg_loss: 225094.3993; train_edge_recon_loss: 34811134.6667; train_gene_expr_recon_loss: 4005325.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152151856.0000; train_global_loss: 191193415.1111; train_optim_loss: 191193415.1111; val_kl_reg_loss: 182571.2188; val_edge_recon_loss: 40642044.0000; val_gene_expr_recon_loss: 4035068.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154778880.0000; val_global_loss: 199638560.0000; val_optim_loss: 199638560.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8465; val_auprc_score: 0.8418; val_best_acc_score: 0.5284; val_best_f1_score: 0.6791; train_kl_reg_loss: 218450.2934; train_edge_recon_loss: 34800122.6667; train_gene_expr_recon_loss: 3988229.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 151712814.2222; train_global_loss: 190719617.7778; train_optim_loss: 190719617.7778; val_kl_reg_loss: 173210.5312; val_edge_recon_loss: 40636848.0000; val_gene_expr_recon_loss: 4012265.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154613248.0000; val_global_loss: 199435568.0000; val_optim_loss: 199435568.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8616; val_auprc_score: 0.8582; val_best_acc_score: 0.5214; val_best_f1_score: 0.6760; train_kl_reg_loss: 151999.8585; train_edge_recon_loss: 39939011.1111; train_gene_expr_recon_loss: 3983788.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 152876216.8889; train_global_loss: 196951016.8889; train_optim_loss: 196951016.8889; val_kl_reg_loss: 153659.8438; val_edge_recon_loss: 40638056.0000; val_gene_expr_recon_loss: 3975456.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 154651360.0000; val_global_loss: 199418528.0000; val_optim_loss: 199418528.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8665; val_auprc_score: 0.8568; val_best_acc_score: 0.5396; val_best_f1_score: 0.6840; train_kl_reg_loss: 274489.2049; train_edge_recon_loss: 36127427.5556; train_gene_expr_recon_loss: 4175568.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153154936.8889; train_global_loss: 193732423.1111; train_optim_loss: 193732423.1111; val_kl_reg_loss: 205817.2188; val_edge_recon_loss: 40625448.0000; val_gene_expr_recon_loss: 4012233.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155044384.0000; val_global_loss: 199887872.0000; val_optim_loss: 199887872.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8593; val_auprc_score: 0.8488; val_best_acc_score: 0.5684; val_best_f1_score: 0.6971; train_kl_reg_loss: 200987.4036; train_edge_recon_loss: 36014162.6667; train_gene_expr_recon_loss: 4205918.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154369491.5556; train_global_loss: 194790563.5556; train_optim_loss: 194790563.5556; val_kl_reg_loss: 39841.9531; val_edge_recon_loss: 40610104.0000; val_gene_expr_recon_loss: 4238644.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156233728.0000; val_global_loss: 201122320.0000; val_optim_loss: 201122320.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8487; val_auprc_score: 0.8418; val_best_acc_score: 0.7432; val_best_f1_score: 0.7743; train_kl_reg_loss: 65864.0171; train_edge_recon_loss: 36358550.6667; train_gene_expr_recon_loss: 4877072.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 157271605.3333; train_global_loss: 198573095.1111; train_optim_loss: 198573095.1111; val_kl_reg_loss: 1034.0111; val_edge_recon_loss: 40364256.0000; val_gene_expr_recon_loss: 5369383.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 165163008.0000; val_global_loss: 210897680.0000; val_optim_loss: 210897680.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8829; val_auprc_score: 0.8746; val_best_acc_score: 0.5581; val_best_f1_score: 0.6929; train_kl_reg_loss: 17577.1259; train_edge_recon_loss: 35739796.4444; train_gene_expr_recon_loss: 4808896.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 158137530.6667; train_global_loss: 198703800.8889; train_optim_loss: 198703800.8889; val_kl_reg_loss: 14868.1455; val_edge_recon_loss: 40619268.0000; val_gene_expr_recon_loss: 4128222.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156252256.0000; val_global_loss: 201014624.0000; val_optim_loss: 201014624.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8804; val_auprc_score: 0.8735; val_best_acc_score: 0.5621; val_best_f1_score: 0.6948; train_kl_reg_loss: 14970.9567; train_edge_recon_loss: 35886760.4444; train_gene_expr_recon_loss: 4126622.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154026081.7778; train_global_loss: 194054433.7778; train_optim_loss: 194054433.7778; val_kl_reg_loss: 14719.9043; val_edge_recon_loss: 40617304.0000; val_gene_expr_recon_loss: 4127689.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 156149760.0000; val_global_loss: 200909472.0000; val_optim_loss: 200909472.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8819; val_auprc_score: 0.8745; val_best_acc_score: 0.5523; val_best_f1_score: 0.6902; train_kl_reg_loss: 18606.4679; train_edge_recon_loss: 35760620.4444; train_gene_expr_recon_loss: 4128896.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154681962.6667; train_global_loss: 194590085.3333; train_optim_loss: 194590085.3333; val_kl_reg_loss: 21325.1016; val_edge_recon_loss: 40622484.0000; val_gene_expr_recon_loss: 4077731.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155571968.0000; val_global_loss: 200293504.0000; val_optim_loss: 200293504.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8819; val_auprc_score: 0.8750; val_best_acc_score: 0.5420; val_best_f1_score: 0.6854; train_kl_reg_loss: 27715.6905; train_edge_recon_loss: 35528416.4444; train_gene_expr_recon_loss: 4130610.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 154335507.5556; train_global_loss: 194022250.6667; train_optim_loss: 194022250.6667; val_kl_reg_loss: 30140.3145; val_edge_recon_loss: 40626576.0000; val_gene_expr_recon_loss: 4052722.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155431328.0000; val_global_loss: 200140768.0000; val_optim_loss: 200140768.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8754; val_auprc_score: 0.8687; val_best_acc_score: 0.5427; val_best_f1_score: 0.6857; train_kl_reg_loss: 33510.7253; train_edge_recon_loss: 35427516.4444; train_gene_expr_recon_loss: 4131227.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 153955980.4444; train_global_loss: 193548236.4444; train_optim_loss: 193548236.4444; val_kl_reg_loss: 31582.4961; val_edge_recon_loss: 40628068.0000; val_gene_expr_recon_loss: 4056186.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 155641664.0000; val_global_loss: 200357504.0000; val_optim_loss: 200357504.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 49 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
val AUROC score: 0.8570
val AUPRC score: 0.8489
val best accuracy score: 0.5220
val best F1 score: 0.6763
val target rna MSE score: 7.8537
val source rna MSE score: 8.8474
val target atac MSE score: 0.1258
val source atac MSE score: 0.0182
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
