[True]
Run timestamp: 27072023_015616_118.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_118']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8728; val_auprc_score: 0.9755; val_best_acc_score: 0.8529; val_best_f1_score: 0.9203; train_kl_reg_loss: 348449.2031; train_edge_recon_loss: 10609187.7209; train_gene_expr_recon_loss: 2807136.0959; train_masked_gp_l1_reg_loss: 7634.2607; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13772407.3581; train_optim_loss: 13772407.3581; val_kl_reg_loss: 78104.5671; val_edge_recon_loss: 12230562.5833; val_gene_expr_recon_loss: 1352310.1354; val_masked_gp_l1_reg_loss: 8952.8936; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13669930.3333; val_optim_loss: 13669930.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8673; val_auprc_score: 0.9737; val_best_acc_score: 0.8611; val_best_f1_score: 0.9246; train_kl_reg_loss: 76634.5033; train_edge_recon_loss: 10314601.9465; train_gene_expr_recon_loss: 1275343.6320; train_masked_gp_l1_reg_loss: 9434.0519; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11676014.1535; train_optim_loss: 11676014.1535; val_kl_reg_loss: 58084.2785; val_edge_recon_loss: 11847245.4583; val_gene_expr_recon_loss: 1180713.9167; val_masked_gp_l1_reg_loss: 9869.7061; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13095913.7083; val_optim_loss: 13095913.7083
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8378; val_auprc_score: 0.9620; val_best_acc_score: 0.8870; val_best_f1_score: 0.9370; train_kl_reg_loss: 54118.7508; train_edge_recon_loss: 10087861.7860; train_gene_expr_recon_loss: 1188496.5256; train_masked_gp_l1_reg_loss: 10192.6557; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11340669.7674; train_optim_loss: 11340669.7674; val_kl_reg_loss: 34005.4111; val_edge_recon_loss: 9314995.0833; val_gene_expr_recon_loss: 1293327.0885; val_masked_gp_l1_reg_loss: 11232.6816; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10653560.4167; val_optim_loss: 10653560.4167
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8388; val_auprc_score: 0.9616; val_best_acc_score: 0.9023; val_best_f1_score: 0.9454; train_kl_reg_loss: 73963.6152; train_edge_recon_loss: 8668819.0953; train_gene_expr_recon_loss: 1136731.5215; train_masked_gp_l1_reg_loss: 11951.3426; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9891465.4907; train_optim_loss: 9891465.4907; val_kl_reg_loss: 82210.7734; val_edge_recon_loss: 8912792.6042; val_gene_expr_recon_loss: 1063197.7135; val_masked_gp_l1_reg_loss: 12306.9521; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10070508.0417; val_optim_loss: 10070508.0417
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8398; val_auprc_score: 0.9641; val_best_acc_score: 0.9086; val_best_f1_score: 0.9489; train_kl_reg_loss: 83076.8130; train_edge_recon_loss: 8510918.6651; train_gene_expr_recon_loss: 1023078.3424; train_masked_gp_l1_reg_loss: 12540.6324; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9629614.4488; train_optim_loss: 9629614.4488; val_kl_reg_loss: 74422.9896; val_edge_recon_loss: 8555820.0625; val_gene_expr_recon_loss: 988472.3047; val_masked_gp_l1_reg_loss: 12745.6406; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9631461.3333; val_optim_loss: 9631461.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8486; val_auprc_score: 0.9620; val_best_acc_score: 0.9061; val_best_f1_score: 0.9468; train_kl_reg_loss: 64951.8636; train_edge_recon_loss: 8417583.6302; train_gene_expr_recon_loss: 977490.9090; train_masked_gp_l1_reg_loss: 12961.0494; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9472987.4372; train_optim_loss: 9472987.4372; val_kl_reg_loss: 46003.3833; val_edge_recon_loss: 8606465.7292; val_gene_expr_recon_loss: 963270.2943; val_masked_gp_l1_reg_loss: 13194.4023; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9628933.4792; val_optim_loss: 9628933.4792
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8878; val_auprc_score: 0.9740; val_best_acc_score: 0.9079; val_best_f1_score: 0.9473; train_kl_reg_loss: 49779.4919; train_edge_recon_loss: 8256369.0023; train_gene_expr_recon_loss: 941981.1570; train_masked_gp_l1_reg_loss: 13372.3339; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9261501.9674; train_optim_loss: 9261501.9674; val_kl_reg_loss: 45675.7113; val_edge_recon_loss: 8160114.2083; val_gene_expr_recon_loss: 924388.3516; val_masked_gp_l1_reg_loss: 13480.0342; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9143658.1667; val_optim_loss: 9143658.1667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9010; val_auprc_score: 0.9787; val_best_acc_score: 0.9028; val_best_f1_score: 0.9442; train_kl_reg_loss: 42555.8084; train_edge_recon_loss: 8189475.3070; train_gene_expr_recon_loss: 910212.9648; train_masked_gp_l1_reg_loss: 13519.3922; train_group_lasso_reg_loss: 0.0000; train_global_loss: 9155763.4651; train_optim_loss: 9155763.4651; val_kl_reg_loss: 33371.5199; val_edge_recon_loss: 8119745.7917; val_gene_expr_recon_loss: 898714.6146; val_masked_gp_l1_reg_loss: 13510.3867; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9065342.0208; val_optim_loss: 9065342.0208
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9265; val_auprc_score: 0.9846; val_best_acc_score: 0.9179; val_best_f1_score: 0.9529; train_kl_reg_loss: 30328.3839; train_edge_recon_loss: 7979349.3047; train_gene_expr_recon_loss: 888632.9468; train_masked_gp_l1_reg_loss: 13439.6172; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8911750.2698; train_optim_loss: 8911750.2698; val_kl_reg_loss: 25776.5617; val_edge_recon_loss: 7897807.9375; val_gene_expr_recon_loss: 876658.4245; val_masked_gp_l1_reg_loss: 13343.0557; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8813585.8333; val_optim_loss: 8813585.8333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9255; val_auprc_score: 0.9826; val_best_acc_score: 0.9184; val_best_f1_score: 0.9531; train_kl_reg_loss: 28120.1212; train_edge_recon_loss: 7956184.1047; train_gene_expr_recon_loss: 867338.3102; train_masked_gp_l1_reg_loss: 13154.4850; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8864796.9837; train_optim_loss: 8864796.9837; val_kl_reg_loss: 28066.1430; val_edge_recon_loss: 8054896.5000; val_gene_expr_recon_loss: 857317.1771; val_masked_gp_l1_reg_loss: 12924.1250; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8953203.7708; val_optim_loss: 8953203.7708
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9215; val_auprc_score: 0.9822; val_best_acc_score: 0.9208; val_best_f1_score: 0.9542; train_kl_reg_loss: 28975.3530; train_edge_recon_loss: 7823320.0977; train_gene_expr_recon_loss: 848712.5462; train_masked_gp_l1_reg_loss: 12699.2955; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8713707.2977; train_optim_loss: 8713707.2977; val_kl_reg_loss: 28703.2826; val_edge_recon_loss: 8201156.9167; val_gene_expr_recon_loss: 840071.6510; val_masked_gp_l1_reg_loss: 12451.8701; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9082383.9167; val_optim_loss: 9082383.9167
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9379; val_auprc_score: 0.9854; val_best_acc_score: 0.9247; val_best_f1_score: 0.9563; train_kl_reg_loss: 27716.5485; train_edge_recon_loss: 7799741.0395; train_gene_expr_recon_loss: 834374.0058; train_masked_gp_l1_reg_loss: 12233.1416; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8674064.7581; train_optim_loss: 8674064.7581; val_kl_reg_loss: 28832.9242; val_edge_recon_loss: 8091756.6250; val_gene_expr_recon_loss: 827989.8802; val_masked_gp_l1_reg_loss: 11976.7793; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8960556.4375; val_optim_loss: 8960556.4375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9269; val_auprc_score: 0.9842; val_best_acc_score: 0.9260; val_best_f1_score: 0.9575; train_kl_reg_loss: 28811.3577; train_edge_recon_loss: 7755796.8349; train_gene_expr_recon_loss: 821542.0500; train_masked_gp_l1_reg_loss: 11713.5185; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8617863.7651; train_optim_loss: 8617863.7651; val_kl_reg_loss: 26907.0263; val_edge_recon_loss: 7945276.1042; val_gene_expr_recon_loss: 816523.5286; val_masked_gp_l1_reg_loss: 11452.5117; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8800159.5208; val_optim_loss: 8800159.5208
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9312; val_auprc_score: 0.9846; val_best_acc_score: 0.9270; val_best_f1_score: 0.9582; train_kl_reg_loss: 27531.5814; train_edge_recon_loss: 7830911.8558; train_gene_expr_recon_loss: 809479.2791; train_masked_gp_l1_reg_loss: 11160.8508; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8679083.6023; train_optim_loss: 8679083.6023; val_kl_reg_loss: 25283.3971; val_edge_recon_loss: 8003833.3542; val_gene_expr_recon_loss: 803188.4792; val_masked_gp_l1_reg_loss: 10872.0498; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8843177.3333; val_optim_loss: 8843177.3333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9464; val_auprc_score: 0.9884; val_best_acc_score: 0.9346; val_best_f1_score: 0.9625; train_kl_reg_loss: 21899.5805; train_edge_recon_loss: 7760441.4419; train_gene_expr_recon_loss: 799775.9122; train_masked_gp_l1_reg_loss: 10624.3459; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8592741.2837; train_optim_loss: 8592741.2837; val_kl_reg_loss: 21278.2352; val_edge_recon_loss: 7778102.3333; val_gene_expr_recon_loss: 795408.2005; val_masked_gp_l1_reg_loss: 10320.5098; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8605109.4583; val_optim_loss: 8605109.4583
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9483; val_auprc_score: 0.9887; val_best_acc_score: 0.9340; val_best_f1_score: 0.9618; train_kl_reg_loss: 20659.8074; train_edge_recon_loss: 7751388.3047; train_gene_expr_recon_loss: 790934.0904; train_masked_gp_l1_reg_loss: 9978.8762; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8572961.0767; train_optim_loss: 8572961.0767; val_kl_reg_loss: 21598.4650; val_edge_recon_loss: 8007671.4375; val_gene_expr_recon_loss: 785055.1432; val_masked_gp_l1_reg_loss: 9682.1191; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8824007.0417; val_optim_loss: 8824007.0417
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9493; val_auprc_score: 0.9880; val_best_acc_score: 0.9370; val_best_f1_score: 0.9635; train_kl_reg_loss: 22045.3038; train_edge_recon_loss: 7768046.0512; train_gene_expr_recon_loss: 781904.2910; train_masked_gp_l1_reg_loss: 9371.8640; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8581367.5000; train_optim_loss: 8581367.5000; val_kl_reg_loss: 19685.3033; val_edge_recon_loss: 8039184.4583; val_gene_expr_recon_loss: 779074.1771; val_masked_gp_l1_reg_loss: 9144.8184; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8847089.0833; val_optim_loss: 8847089.0833
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9518; val_auprc_score: 0.9894; val_best_acc_score: 0.9415; val_best_f1_score: 0.9661; train_kl_reg_loss: 21834.9977; train_edge_recon_loss: 7750664.5512; train_gene_expr_recon_loss: 774866.4750; train_masked_gp_l1_reg_loss: 8880.5578; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8556246.5651; train_optim_loss: 8556246.5651; val_kl_reg_loss: 20584.2424; val_edge_recon_loss: 7883763.6250; val_gene_expr_recon_loss: 770624.9453; val_masked_gp_l1_reg_loss: 8634.3262; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8683607.0000; val_optim_loss: 8683607.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9553; val_auprc_score: 0.9896; val_best_acc_score: 0.9446; val_best_f1_score: 0.9678; train_kl_reg_loss: 22799.4345; train_edge_recon_loss: 7752792.5023; train_gene_expr_recon_loss: 768065.9509; train_masked_gp_l1_reg_loss: 8370.5801; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8552028.4605; train_optim_loss: 8552028.4605; val_kl_reg_loss: 20729.6191; val_edge_recon_loss: 7929541.3125; val_gene_expr_recon_loss: 766652.7474; val_masked_gp_l1_reg_loss: 8120.4053; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8725043.8542; val_optim_loss: 8725043.8542

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9502; val_auprc_score: 0.9875; val_best_acc_score: 0.9415; val_best_f1_score: 0.9661; train_kl_reg_loss: 20957.6454; train_edge_recon_loss: 7729209.9674; train_gene_expr_recon_loss: 764019.7677; train_masked_gp_l1_reg_loss: 8084.0505; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8522271.4023; train_optim_loss: 8522271.4023; val_kl_reg_loss: 20250.6707; val_edge_recon_loss: 7874298.4375; val_gene_expr_recon_loss: 763091.9792; val_masked_gp_l1_reg_loss: 8065.8867; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8665707.0625; val_optim_loss: 8665707.0625
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9546; val_auprc_score: 0.9897; val_best_acc_score: 0.9446; val_best_f1_score: 0.9680; train_kl_reg_loss: 20992.0045; train_edge_recon_loss: 7730661.1651; train_gene_expr_recon_loss: 762686.7369; train_masked_gp_l1_reg_loss: 8052.2576; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8522392.1186; train_optim_loss: 8522392.1186; val_kl_reg_loss: 20713.2822; val_edge_recon_loss: 7864024.7292; val_gene_expr_recon_loss: 761998.0547; val_masked_gp_l1_reg_loss: 8038.6074; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8654774.9792; val_optim_loss: 8654774.9792
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9572; val_auprc_score: 0.9910; val_best_acc_score: 0.9457; val_best_f1_score: 0.9687; train_kl_reg_loss: 21657.7729; train_edge_recon_loss: 7709060.5326; train_gene_expr_recon_loss: 761663.1613; train_masked_gp_l1_reg_loss: 8014.1107; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8500395.5605; train_optim_loss: 8500395.5605; val_kl_reg_loss: 21061.9224; val_edge_recon_loss: 7702296.0833; val_gene_expr_recon_loss: 761137.8073; val_masked_gp_l1_reg_loss: 7993.0791; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8492488.6875; val_optim_loss: 8492488.6875
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9563; val_auprc_score: 0.9902; val_best_acc_score: 0.9462; val_best_f1_score: 0.9692; train_kl_reg_loss: 21231.7041; train_edge_recon_loss: 7708590.8628; train_gene_expr_recon_loss: 761187.9285; train_masked_gp_l1_reg_loss: 7978.1150; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8498988.5791; train_optim_loss: 8498988.5791; val_kl_reg_loss: 21001.4868; val_edge_recon_loss: 7526551.7292; val_gene_expr_recon_loss: 759734.1901; val_masked_gp_l1_reg_loss: 7963.6758; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8315251.1667; val_optim_loss: 8315251.1667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9621; val_auprc_score: 0.9916; val_best_acc_score: 0.9454; val_best_f1_score: 0.9683; train_kl_reg_loss: 21091.2296; train_edge_recon_loss: 7679435.0163; train_gene_expr_recon_loss: 760655.0381; train_masked_gp_l1_reg_loss: 7951.9169; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8469133.1977; train_optim_loss: 8469133.1977; val_kl_reg_loss: 19905.4885; val_edge_recon_loss: 7965275.6875; val_gene_expr_recon_loss: 760005.6667; val_masked_gp_l1_reg_loss: 7936.8691; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8753123.7917; val_optim_loss: 8753123.7917
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9542; val_auprc_score: 0.9896; val_best_acc_score: 0.9462; val_best_f1_score: 0.9689; train_kl_reg_loss: 20268.8229; train_edge_recon_loss: 7701512.5977; train_gene_expr_recon_loss: 759984.2797; train_masked_gp_l1_reg_loss: 7924.0652; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8489689.7349; train_optim_loss: 8489689.7349; val_kl_reg_loss: 19285.8536; val_edge_recon_loss: 7779620.6458; val_gene_expr_recon_loss: 759687.0104; val_masked_gp_l1_reg_loss: 7904.5996; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8566498.2917; val_optim_loss: 8566498.2917
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9578; val_auprc_score: 0.9910; val_best_acc_score: 0.9459; val_best_f1_score: 0.9688; train_kl_reg_loss: 19682.1930; train_edge_recon_loss: 7662431.0907; train_gene_expr_recon_loss: 765621.3953; train_masked_gp_l1_reg_loss: 7927.1004; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8455661.7953; train_optim_loss: 8455661.7953; val_kl_reg_loss: 12436.3363; val_edge_recon_loss: 7642565.6250; val_gene_expr_recon_loss: 764073.6484; val_masked_gp_l1_reg_loss: 7934.9180; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8427010.5833; val_optim_loss: 8427010.5833
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9545; val_auprc_score: 0.9894; val_best_acc_score: 0.9448; val_best_f1_score: 0.9681; train_kl_reg_loss: 19286.1550; train_edge_recon_loss: 7657712.3140; train_gene_expr_recon_loss: 763367.5366; train_masked_gp_l1_reg_loss: 7924.8130; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8448290.8372; train_optim_loss: 8448290.8372; val_kl_reg_loss: 12169.4342; val_edge_recon_loss: 7802509.4375; val_gene_expr_recon_loss: 762346.7188; val_masked_gp_l1_reg_loss: 7914.8184; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8584940.6458; val_optim_loss: 8584940.6458

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9604; val_auprc_score: 0.9912; val_best_acc_score: 0.9440; val_best_f1_score: 0.9675; train_kl_reg_loss: 19201.7394; train_edge_recon_loss: 7606234.2837; train_gene_expr_recon_loss: 762413.6863; train_masked_gp_l1_reg_loss: 7909.7270; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8395759.4000; train_optim_loss: 8395759.4000; val_kl_reg_loss: 12005.4336; val_edge_recon_loss: 7873273.2708; val_gene_expr_recon_loss: 762186.7109; val_masked_gp_l1_reg_loss: 7905.9644; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8655371.3333; val_optim_loss: 8655371.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9563; val_auprc_score: 0.9904; val_best_acc_score: 0.9439; val_best_f1_score: 0.9674; train_kl_reg_loss: 18914.2641; train_edge_recon_loss: 7691071.2233; train_gene_expr_recon_loss: 762197.9259; train_masked_gp_l1_reg_loss: 7903.3350; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8480086.7186; train_optim_loss: 8480086.7186; val_kl_reg_loss: 11816.5857; val_edge_recon_loss: 7856399.4583; val_gene_expr_recon_loss: 762148.8490; val_masked_gp_l1_reg_loss: 7900.7324; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8638265.7083; val_optim_loss: 8638265.7083
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9554; val_auprc_score: 0.9894; val_best_acc_score: 0.9451; val_best_f1_score: 0.9683; train_kl_reg_loss: 18805.8833; train_edge_recon_loss: 7736400.9326; train_gene_expr_recon_loss: 762432.4788; train_masked_gp_l1_reg_loss: 7897.7912; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8525537.1070; train_optim_loss: 8525537.1070; val_kl_reg_loss: 11822.1317; val_edge_recon_loss: 7731856.6458; val_gene_expr_recon_loss: 762040.9792; val_masked_gp_l1_reg_loss: 7894.9585; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8513614.6667; val_optim_loss: 8513614.6667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9517; val_auprc_score: 0.9891; val_best_acc_score: 0.9440; val_best_f1_score: 0.9678; train_kl_reg_loss: 18741.2831; train_edge_recon_loss: 7711774.8488; train_gene_expr_recon_loss: 762271.0233; train_masked_gp_l1_reg_loss: 7891.8467; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8500679.0000; train_optim_loss: 8500679.0000; val_kl_reg_loss: 11736.5860; val_edge_recon_loss: 7583916.8333; val_gene_expr_recon_loss: 761767.8151; val_masked_gp_l1_reg_loss: 7888.8237; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8365310.2083; val_optim_loss: 8365310.2083

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 34 min 6 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
Val AUROC score: 0.9545
Val AUPRC score: 0.9900
Val best accuracy score: 0.9432
Val best F1 score: 0.9674
Val gene expr MSE score: 21848.1083
Val cat covariate0 mean sim diff: 0.0002

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
