[True]
Run timestamp: 26072023_024211_83.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_83']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9160; val_auprc_score: 0.9264; val_best_acc_score: 0.5012; val_best_f1_score: 0.6672; train_kl_reg_loss: 11060.6222; train_edge_recon_loss: 3480014.0556; train_gene_expr_recon_loss: 3177474.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10828793.4444; train_global_loss: 17497343.1111; train_optim_loss: 17497343.1111; val_kl_reg_loss: 35255.6719; val_edge_recon_loss: 4065142.0000; val_gene_expr_recon_loss: 3042992.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10696310.0000; val_global_loss: 17839700.0000; val_optim_loss: 17839700.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8980; val_auprc_score: 0.9094; val_best_acc_score: 0.5019; val_best_f1_score: 0.6675; train_kl_reg_loss: 47007.4084; train_edge_recon_loss: 3508800.3889; train_gene_expr_recon_loss: 2913331.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10965968.1111; train_global_loss: 17435106.8889; train_optim_loss: 17435106.8889; val_kl_reg_loss: 29885.9453; val_edge_recon_loss: 4065241.2500; val_gene_expr_recon_loss: 2796142.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10500874.0000; val_global_loss: 17392144.0000; val_optim_loss: 17392144.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8769; val_auprc_score: 0.8859; val_best_acc_score: 0.5074; val_best_f1_score: 0.6700; train_kl_reg_loss: 52377.1960; train_edge_recon_loss: 3527870.6944; train_gene_expr_recon_loss: 2693278.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10460838.0000; train_global_loss: 16734364.6667; train_optim_loss: 16734364.6667; val_kl_reg_loss: 62891.2422; val_edge_recon_loss: 4065015.0000; val_gene_expr_recon_loss: 2616648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10301457.0000; val_global_loss: 17046012.0000; val_optim_loss: 17046012.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8794; val_auprc_score: 0.8853; val_best_acc_score: 0.5156; val_best_f1_score: 0.6735; train_kl_reg_loss: 79017.6272; train_edge_recon_loss: 3530070.0556; train_gene_expr_recon_loss: 2511761.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10289383.0000; train_global_loss: 16410231.8889; train_optim_loss: 16410231.8889; val_kl_reg_loss: 62841.0156; val_edge_recon_loss: 4064559.7500; val_gene_expr_recon_loss: 2463473.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10134393.0000; val_global_loss: 16725267.0000; val_optim_loss: 16725267.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8834; val_auprc_score: 0.8829; val_best_acc_score: 0.5226; val_best_f1_score: 0.6763; train_kl_reg_loss: 89409.0616; train_edge_recon_loss: 3536987.5278; train_gene_expr_recon_loss: 2373210.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10108451.4444; train_global_loss: 16108058.7778; train_optim_loss: 16108058.7778; val_kl_reg_loss: 88216.2188; val_edge_recon_loss: 4063568.0000; val_gene_expr_recon_loss: 2368829.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10028206.0000; val_global_loss: 16548819.0000; val_optim_loss: 16548819.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8831; val_auprc_score: 0.8821; val_best_acc_score: 0.5325; val_best_f1_score: 0.6805; train_kl_reg_loss: 101645.6267; train_edge_recon_loss: 3539590.9722; train_gene_expr_recon_loss: 2299553.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10035028.1111; train_global_loss: 15975818.3333; train_optim_loss: 15975818.3333; val_kl_reg_loss: 86916.7344; val_edge_recon_loss: 4062901.5000; val_gene_expr_recon_loss: 2303780.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9942052.0000; val_global_loss: 16395650.0000; val_optim_loss: 16395650.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8774; val_auprc_score: 0.8783; val_best_acc_score: 0.5556; val_best_f1_score: 0.6908; train_kl_reg_loss: 108907.6606; train_edge_recon_loss: 3541878.9444; train_gene_expr_recon_loss: 2248021.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9864814.4444; train_global_loss: 15763622.3333; train_optim_loss: 15763622.3333; val_kl_reg_loss: 90363.8125; val_edge_recon_loss: 4061625.0000; val_gene_expr_recon_loss: 2252297.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9881411.0000; val_global_loss: 16285698.0000; val_optim_loss: 16285698.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8669; val_auprc_score: 0.8670; val_best_acc_score: 0.5923; val_best_f1_score: 0.7068; train_kl_reg_loss: 111455.8793; train_edge_recon_loss: 3542402.3889; train_gene_expr_recon_loss: 2185150.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9858661.6667; train_global_loss: 15697669.8889; train_optim_loss: 15697669.8889; val_kl_reg_loss: 95844.0156; val_edge_recon_loss: 4059340.7500; val_gene_expr_recon_loss: 2216333.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9843719.0000; val_global_loss: 16215237.0000; val_optim_loss: 16215237.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8645; val_auprc_score: 0.8593; val_best_acc_score: 0.6487; val_best_f1_score: 0.7349; train_kl_reg_loss: 112638.2240; train_edge_recon_loss: 3539125.8611; train_gene_expr_recon_loss: 2161290.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9782957.2222; train_global_loss: 15596012.2222; train_optim_loss: 15596012.2222; val_kl_reg_loss: 87915.6797; val_edge_recon_loss: 4055780.7500; val_gene_expr_recon_loss: 2195767.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9814723.0000; val_global_loss: 16154187.0000; val_optim_loss: 16154187.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8669; val_auprc_score: 0.8623; val_best_acc_score: 0.7127; val_best_f1_score: 0.7687; train_kl_reg_loss: 112936.8168; train_edge_recon_loss: 3537737.9167; train_gene_expr_recon_loss: 2154251.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9794007.8889; train_global_loss: 15598934.3333; train_optim_loss: 15598934.3333; val_kl_reg_loss: 80018.4609; val_edge_recon_loss: 4050142.7500; val_gene_expr_recon_loss: 2182893.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9781497.0000; val_global_loss: 16094551.0000; val_optim_loss: 16094551.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8716; val_auprc_score: 0.8663; val_best_acc_score: 0.7635; val_best_f1_score: 0.7962; train_kl_reg_loss: 107478.5122; train_edge_recon_loss: 3538696.0556; train_gene_expr_recon_loss: 2137897.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9757256.5556; train_global_loss: 15541329.0000; train_optim_loss: 15541329.0000; val_kl_reg_loss: 93134.5859; val_edge_recon_loss: 4042311.0000; val_gene_expr_recon_loss: 2168741.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9769227.0000; val_global_loss: 16073414.0000; val_optim_loss: 16073414.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8714; val_auprc_score: 0.8656; val_best_acc_score: 0.7873; val_best_f1_score: 0.7989; train_kl_reg_loss: 105169.4592; train_edge_recon_loss: 3531496.7222; train_gene_expr_recon_loss: 2127715.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9755398.6667; train_global_loss: 15519780.6667; train_optim_loss: 15519780.6667; val_kl_reg_loss: 92282.1406; val_edge_recon_loss: 4026741.5000; val_gene_expr_recon_loss: 2160904.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9766183.0000; val_global_loss: 16046112.0000; val_optim_loss: 16046112.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8749; val_auprc_score: 0.8645; val_best_acc_score: 0.7864; val_best_f1_score: 0.7747; train_kl_reg_loss: 102453.5226; train_edge_recon_loss: 3523998.3889; train_gene_expr_recon_loss: 2130051.2361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9763728.4444; train_global_loss: 15520231.6667; train_optim_loss: 15520231.6667; val_kl_reg_loss: 84095.4766; val_edge_recon_loss: 3995999.7500; val_gene_expr_recon_loss: 2154389.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9745978.0000; val_global_loss: 15980463.0000; val_optim_loss: 15980463.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8836; val_auprc_score: 0.8733; val_best_acc_score: 0.7798; val_best_f1_score: 0.8082; train_kl_reg_loss: 97488.1293; train_edge_recon_loss: 3512970.2778; train_gene_expr_recon_loss: 2122650.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9757343.3333; train_global_loss: 15490452.0000; train_optim_loss: 15490452.0000; val_kl_reg_loss: 83196.6875; val_edge_recon_loss: 3926559.5000; val_gene_expr_recon_loss: 2146893.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9717402.0000; val_global_loss: 15874051.0000; val_optim_loss: 15874051.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8816; val_auprc_score: 0.8671; val_best_acc_score: 0.7979; val_best_f1_score: 0.8104; train_kl_reg_loss: 89806.6962; train_edge_recon_loss: 3492013.7500; train_gene_expr_recon_loss: 2112315.2361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9763653.2222; train_global_loss: 15457788.7778; train_optim_loss: 15457788.7778; val_kl_reg_loss: 77442.4219; val_edge_recon_loss: 3783387.5000; val_gene_expr_recon_loss: 2148495.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9722371.0000; val_global_loss: 15731696.0000; val_optim_loss: 15731696.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8873; val_auprc_score: 0.8746; val_best_acc_score: 0.8014; val_best_f1_score: 0.8115; train_kl_reg_loss: 74954.7860; train_edge_recon_loss: 3423860.8611; train_gene_expr_recon_loss: 2117387.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9753110.5556; train_global_loss: 15369313.7778; train_optim_loss: 15369313.7778; val_kl_reg_loss: 61992.0469; val_edge_recon_loss: 3475308.5000; val_gene_expr_recon_loss: 2158146.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9727097.0000; val_global_loss: 15422544.0000; val_optim_loss: 15422544.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8808; val_auprc_score: 0.8712; val_best_acc_score: 0.7842; val_best_f1_score: 0.8054; train_kl_reg_loss: 69362.5929; train_edge_recon_loss: 3239426.6667; train_gene_expr_recon_loss: 2126458.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9720485.6667; train_global_loss: 15155733.5556; train_optim_loss: 15155733.5556; val_kl_reg_loss: 79170.9375; val_edge_recon_loss: 3139682.5000; val_gene_expr_recon_loss: 2167647.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9730080.0000; val_global_loss: 15116581.0000; val_optim_loss: 15116581.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8714; val_auprc_score: 0.8558; val_best_acc_score: 0.7805; val_best_f1_score: 0.8034; train_kl_reg_loss: 107670.0078; train_edge_recon_loss: 3050983.4444; train_gene_expr_recon_loss: 2124559.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9694515.6667; train_global_loss: 14977728.7778; train_optim_loss: 14977728.7778; val_kl_reg_loss: 132084.5781; val_edge_recon_loss: 3014387.2500; val_gene_expr_recon_loss: 2156637.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9714506.0000; val_global_loss: 15017615.0000; val_optim_loss: 15017615.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8729; val_auprc_score: 0.8540; val_best_acc_score: 0.7809; val_best_f1_score: 0.8046; train_kl_reg_loss: 147144.8038; train_edge_recon_loss: 2975807.5833; train_gene_expr_recon_loss: 2110378.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9654280.2222; train_global_loss: 14887611.1111; train_optim_loss: 14887611.1111; val_kl_reg_loss: 141013.5000; val_edge_recon_loss: 2980591.0000; val_gene_expr_recon_loss: 2149034.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9707551.0000; val_global_loss: 14978190.0000; val_optim_loss: 14978190.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8765; val_auprc_score: 0.8536; val_best_acc_score: 0.7891; val_best_f1_score: 0.8091; train_kl_reg_loss: 135698.6632; train_edge_recon_loss: 2944800.0278; train_gene_expr_recon_loss: 2111932.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9710676.7778; train_global_loss: 14903107.3333; train_optim_loss: 14903107.3333; val_kl_reg_loss: 120387.7812; val_edge_recon_loss: 2981617.7500; val_gene_expr_recon_loss: 2141429.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9681739.0000; val_global_loss: 14925174.0000; val_optim_loss: 14925174.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8860; val_auprc_score: 0.8658; val_best_acc_score: 0.8002; val_best_f1_score: 0.8183; train_kl_reg_loss: 124887.6970; train_edge_recon_loss: 2929304.3889; train_gene_expr_recon_loss: 2101612.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9732640.5556; train_global_loss: 14888445.0000; train_optim_loss: 14888445.0000; val_kl_reg_loss: 120683.6250; val_edge_recon_loss: 2953240.5000; val_gene_expr_recon_loss: 2136085.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9675122.0000; val_global_loss: 14885132.0000; val_optim_loss: 14885132.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8899; val_auprc_score: 0.8670; val_best_acc_score: 0.8087; val_best_f1_score: 0.8229; train_kl_reg_loss: 123281.5477; train_edge_recon_loss: 2927944.8056; train_gene_expr_recon_loss: 2093475.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9641608.1111; train_global_loss: 14786309.7778; train_optim_loss: 14786309.7778; val_kl_reg_loss: 117159.3828; val_edge_recon_loss: 2932538.0000; val_gene_expr_recon_loss: 2133822.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9667028.0000; val_global_loss: 14850548.0000; val_optim_loss: 14850548.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8964; val_auprc_score: 0.8714; val_best_acc_score: 0.8157; val_best_f1_score: 0.8291; train_kl_reg_loss: 117597.7778; train_edge_recon_loss: 2908622.8611; train_gene_expr_recon_loss: 2090575.7639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9639056.0000; train_global_loss: 14755852.7778; train_optim_loss: 14755852.7778; val_kl_reg_loss: 115954.7344; val_edge_recon_loss: 2918541.7500; val_gene_expr_recon_loss: 2130345.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9661463.0000; val_global_loss: 14826305.0000; val_optim_loss: 14826305.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9048; val_auprc_score: 0.8784; val_best_acc_score: 0.8321; val_best_f1_score: 0.8421; train_kl_reg_loss: 115067.4852; train_edge_recon_loss: 2891555.5000; train_gene_expr_recon_loss: 2094938.0139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9648312.4444; train_global_loss: 14749873.4444; train_optim_loss: 14749873.4444; val_kl_reg_loss: 112627.7031; val_edge_recon_loss: 2887780.7500; val_gene_expr_recon_loss: 2130146.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9651807.0000; val_global_loss: 14782362.0000; val_optim_loss: 14782362.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9017; val_auprc_score: 0.8725; val_best_acc_score: 0.8324; val_best_f1_score: 0.8443; train_kl_reg_loss: 115978.0269; train_edge_recon_loss: 2865657.3889; train_gene_expr_recon_loss: 2076835.9306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9570847.7778; train_global_loss: 14629319.2222; train_optim_loss: 14629319.2222; val_kl_reg_loss: 114688.3203; val_edge_recon_loss: 2891027.7500; val_gene_expr_recon_loss: 2125908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9642486.0000; val_global_loss: 14774110.0000; val_optim_loss: 14774110.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9157; val_auprc_score: 0.8985; val_best_acc_score: 0.8362; val_best_f1_score: 0.8470; train_kl_reg_loss: 140066.8394; train_edge_recon_loss: 3101569.5000; train_gene_expr_recon_loss: 2123860.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9711415.7778; train_global_loss: 15076912.7778; train_optim_loss: 15076912.7778; val_kl_reg_loss: 44145.5781; val_edge_recon_loss: 3007518.7500; val_gene_expr_recon_loss: 2161004.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9690321.0000; val_global_loss: 14902990.0000; val_optim_loss: 14902990.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9133; val_auprc_score: 0.8951; val_best_acc_score: 0.8354; val_best_f1_score: 0.8460; train_kl_reg_loss: 173997.6389; train_edge_recon_loss: 2968056.2500; train_gene_expr_recon_loss: 2109558.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9665470.5556; train_global_loss: 14917082.8889; train_optim_loss: 14917082.8889; val_kl_reg_loss: 50790.3672; val_edge_recon_loss: 2961867.2500; val_gene_expr_recon_loss: 2157228.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9685253.0000; val_global_loss: 14855139.0000; val_optim_loss: 14855139.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9202; val_auprc_score: 0.8992; val_best_acc_score: 0.8428; val_best_f1_score: 0.8529; train_kl_reg_loss: 154339.3021; train_edge_recon_loss: 2933432.3333; train_gene_expr_recon_loss: 2121509.1528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9672894.5556; train_global_loss: 14882175.2222; train_optim_loss: 14882175.2222; val_kl_reg_loss: 49942.3984; val_edge_recon_loss: 2945628.5000; val_gene_expr_recon_loss: 2152408.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9666335.0000; val_global_loss: 14814314.0000; val_optim_loss: 14814314.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9227; val_auprc_score: 0.9033; val_best_acc_score: 0.8459; val_best_f1_score: 0.8556; train_kl_reg_loss: 130411.8333; train_edge_recon_loss: 2925063.6389; train_gene_expr_recon_loss: 2100060.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9609535.5556; train_global_loss: 14765071.5556; train_optim_loss: 14765071.5556; val_kl_reg_loss: 51450.3047; val_edge_recon_loss: 2933767.5000; val_gene_expr_recon_loss: 2149905.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9662914.0000; val_global_loss: 14798037.0000; val_optim_loss: 14798037.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9197; val_auprc_score: 0.9025; val_best_acc_score: 0.8449; val_best_f1_score: 0.8539; train_kl_reg_loss: 121420.3689; train_edge_recon_loss: 2919122.8333; train_gene_expr_recon_loss: 2094724.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9587769.4444; train_global_loss: 14723037.0000; train_optim_loss: 14723037.0000; val_kl_reg_loss: 52905.2578; val_edge_recon_loss: 2932112.0000; val_gene_expr_recon_loss: 2141464.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9646171.0000; val_global_loss: 14772653.0000; val_optim_loss: 14772653.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9170; val_auprc_score: 0.8978; val_best_acc_score: 0.8406; val_best_f1_score: 0.8500; train_kl_reg_loss: 122505.7448; train_edge_recon_loss: 2917691.8056; train_gene_expr_recon_loss: 2088328.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9641264.7778; train_global_loss: 14769791.0000; train_optim_loss: 14769791.0000; val_kl_reg_loss: 53508.6094; val_edge_recon_loss: 2941304.5000; val_gene_expr_recon_loss: 2142735.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9640858.0000; val_global_loss: 14778407.0000; val_optim_loss: 14778407.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9154; val_auprc_score: 0.8972; val_best_acc_score: 0.8364; val_best_f1_score: 0.8478; train_kl_reg_loss: 121323.9826; train_edge_recon_loss: 2900992.8889; train_gene_expr_recon_loss: 2099245.3472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9595354.8889; train_global_loss: 14716917.0000; train_optim_loss: 14716917.0000; val_kl_reg_loss: 53965.8320; val_edge_recon_loss: 2937319.0000; val_gene_expr_recon_loss: 2142034.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9635692.0000; val_global_loss: 14769011.0000; val_optim_loss: 14769011.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9226; val_auprc_score: 0.9045; val_best_acc_score: 0.8490; val_best_f1_score: 0.8564; train_kl_reg_loss: 121656.2092; train_edge_recon_loss: 2906613.1667; train_gene_expr_recon_loss: 2097286.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9601999.8889; train_global_loss: 14727555.7778; train_optim_loss: 14727555.7778; val_kl_reg_loss: 54506.6211; val_edge_recon_loss: 2912804.2500; val_gene_expr_recon_loss: 2142739.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9659328.0000; val_global_loss: 14769378.0000; val_optim_loss: 14769378.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9213; val_auprc_score: 0.9026; val_best_acc_score: 0.8428; val_best_f1_score: 0.8540; train_kl_reg_loss: 121735.8498; train_edge_recon_loss: 2903745.0278; train_gene_expr_recon_loss: 2096160.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9579189.3333; train_global_loss: 14700831.2222; train_optim_loss: 14700831.2222; val_kl_reg_loss: 53829.7539; val_edge_recon_loss: 2906075.5000; val_gene_expr_recon_loss: 2141463.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9638619.0000; val_global_loss: 14739988.0000; val_optim_loss: 14739988.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9165; val_auprc_score: 0.8987; val_best_acc_score: 0.8406; val_best_f1_score: 0.8504; train_kl_reg_loss: 121682.8602; train_edge_recon_loss: 2910884.6389; train_gene_expr_recon_loss: 2105912.6528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9666233.2222; train_global_loss: 14804713.5556; train_optim_loss: 14804713.5556; val_kl_reg_loss: 54990.0703; val_edge_recon_loss: 2935378.0000; val_gene_expr_recon_loss: 2141392.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9647644.0000; val_global_loss: 14779405.0000; val_optim_loss: 14779405.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9188; val_auprc_score: 0.9029; val_best_acc_score: 0.8391; val_best_f1_score: 0.8511; train_kl_reg_loss: 120884.9106; train_edge_recon_loss: 2906864.1111; train_gene_expr_recon_loss: 2119755.4028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9644556.4444; train_global_loss: 14792060.7778; train_optim_loss: 14792060.7778; val_kl_reg_loss: 54421.0000; val_edge_recon_loss: 2917991.5000; val_gene_expr_recon_loss: 2142520.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9646448.0000; val_global_loss: 14761380.0000; val_optim_loss: 14761380.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9196; val_auprc_score: 0.9033; val_best_acc_score: 0.8410; val_best_f1_score: 0.8510; train_kl_reg_loss: 120555.8828; train_edge_recon_loss: 2910908.3611; train_gene_expr_recon_loss: 2101103.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9608341.3333; train_global_loss: 14740909.0000; train_optim_loss: 14740909.0000; val_kl_reg_loss: 54477.6094; val_edge_recon_loss: 2933697.0000; val_gene_expr_recon_loss: 2141011.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9650208.0000; val_global_loss: 14779394.0000; val_optim_loss: 14779394.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9226; val_auprc_score: 0.9072; val_best_acc_score: 0.8442; val_best_f1_score: 0.8553; train_kl_reg_loss: 120963.1832; train_edge_recon_loss: 2911990.1944; train_gene_expr_recon_loss: 2099931.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9682884.7778; train_global_loss: 14815770.2222; train_optim_loss: 14815770.2222; val_kl_reg_loss: 55339.8672; val_edge_recon_loss: 2898846.2500; val_gene_expr_recon_loss: 2140095.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9629149.0000; val_global_loss: 14723431.0000; val_optim_loss: 14723431.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9199; val_auprc_score: 0.9041; val_best_acc_score: 0.8417; val_best_f1_score: 0.8520; train_kl_reg_loss: 119989.4661; train_edge_recon_loss: 2908829.2500; train_gene_expr_recon_loss: 2099106.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9642315.5556; train_global_loss: 14770241.2222; train_optim_loss: 14770241.2222; val_kl_reg_loss: 55907.0938; val_edge_recon_loss: 2917554.7500; val_gene_expr_recon_loss: 2139280.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9646317.0000; val_global_loss: 14759059.0000; val_optim_loss: 14759059.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9177; val_auprc_score: 0.8997; val_best_acc_score: 0.8391; val_best_f1_score: 0.8482; train_kl_reg_loss: 119597.8646; train_edge_recon_loss: 2899109.0556; train_gene_expr_recon_loss: 2092676.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9608776.0000; train_global_loss: 14720159.4444; train_optim_loss: 14720159.4444; val_kl_reg_loss: 56427.2734; val_edge_recon_loss: 2923640.0000; val_gene_expr_recon_loss: 2140446.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9644415.0000; val_global_loss: 14764928.0000; val_optim_loss: 14764928.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9213; val_auprc_score: 0.9024; val_best_acc_score: 0.8440; val_best_f1_score: 0.8538; train_kl_reg_loss: 119728.3733; train_edge_recon_loss: 2888966.8889; train_gene_expr_recon_loss: 2117156.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9731237.4444; train_global_loss: 14857089.5556; train_optim_loss: 14857089.5556; val_kl_reg_loss: 57040.6562; val_edge_recon_loss: 2918106.5000; val_gene_expr_recon_loss: 2138072.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9634456.0000; val_global_loss: 14747676.0000; val_optim_loss: 14747676.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9180; val_auprc_score: 0.8975; val_best_acc_score: 0.8413; val_best_f1_score: 0.8525; train_kl_reg_loss: 118668.4062; train_edge_recon_loss: 2897625.5556; train_gene_expr_recon_loss: 2099005.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9649662.7778; train_global_loss: 14764962.6667; train_optim_loss: 14764962.6667; val_kl_reg_loss: 57454.1016; val_edge_recon_loss: 2910722.0000; val_gene_expr_recon_loss: 2136280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9624133.0000; val_global_loss: 14728589.0000; val_optim_loss: 14728589.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9248; val_auprc_score: 0.9091; val_best_acc_score: 0.8451; val_best_f1_score: 0.8545; train_kl_reg_loss: 118916.3464; train_edge_recon_loss: 2901008.8611; train_gene_expr_recon_loss: 2100132.6528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9656938.1111; train_global_loss: 14776996.0000; train_optim_loss: 14776996.0000; val_kl_reg_loss: 57888.2656; val_edge_recon_loss: 2900888.2500; val_gene_expr_recon_loss: 2138305.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9653167.0000; val_global_loss: 14750249.0000; val_optim_loss: 14750249.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9211; val_auprc_score: 0.9043; val_best_acc_score: 0.8428; val_best_f1_score: 0.8534; train_kl_reg_loss: 118011.4679; train_edge_recon_loss: 2895309.2778; train_gene_expr_recon_loss: 2096931.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9618102.5556; train_global_loss: 14728354.6667; train_optim_loss: 14728354.6667; val_kl_reg_loss: 57847.3438; val_edge_recon_loss: 2908144.2500; val_gene_expr_recon_loss: 2136857.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9638105.0000; val_global_loss: 14740954.0000; val_optim_loss: 14740954.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9174; val_auprc_score: 0.9015; val_best_acc_score: 0.8383; val_best_f1_score: 0.8494; train_kl_reg_loss: 118455.7865; train_edge_recon_loss: 2890060.5278; train_gene_expr_recon_loss: 2096997.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9651965.3333; train_global_loss: 14757479.1111; train_optim_loss: 14757479.1111; val_kl_reg_loss: 57981.0625; val_edge_recon_loss: 2937018.2500; val_gene_expr_recon_loss: 2138912.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9643280.0000; val_global_loss: 14777192.0000; val_optim_loss: 14777192.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9181; val_auprc_score: 0.8996; val_best_acc_score: 0.8397; val_best_f1_score: 0.8503; train_kl_reg_loss: 118533.6606; train_edge_recon_loss: 2890847.5833; train_gene_expr_recon_loss: 2097402.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9640297.1111; train_global_loss: 14747080.7778; train_optim_loss: 14747080.7778; val_kl_reg_loss: 57902.6953; val_edge_recon_loss: 2917009.0000; val_gene_expr_recon_loss: 2137236.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9636010.0000; val_global_loss: 14748158.0000; val_optim_loss: 14748158.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 54 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9208
Val AUPRC score: 0.9037
Val best accuracy score: 0.8418
Val best F1 score: 0.8517
Val gene expr MSE score: 0.3890
Val chrom access MSE score: 0.0872
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
