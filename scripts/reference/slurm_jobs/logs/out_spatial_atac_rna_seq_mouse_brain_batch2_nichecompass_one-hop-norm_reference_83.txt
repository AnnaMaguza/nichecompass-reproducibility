[True]
Run timestamp: 29072023_120323_83.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_83']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8727; val_auprc_score: 0.8939; val_best_acc_score: 0.5015; val_best_f1_score: 0.6673; train_kl_reg_loss: 10433.5435; train_edge_recon_loss: 3482204.7500; train_gene_expr_recon_loss: 7691012.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 18107851.7778; train_global_loss: 29291502.8889; train_optim_loss: 29291502.8889; val_kl_reg_loss: 18054.0469; val_edge_recon_loss: 4065301.5000; val_gene_expr_recon_loss: 7059640.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17808600.0000; val_global_loss: 28951596.0000; val_optim_loss: 28951596.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8794; val_auprc_score: 0.8950; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 20158.9326; train_edge_recon_loss: 3502950.4722; train_gene_expr_recon_loss: 7161787.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17273214.0000; train_global_loss: 27958110.2222; train_optim_loss: 27958110.2222; val_kl_reg_loss: 40967.7383; val_edge_recon_loss: 4065888.5000; val_gene_expr_recon_loss: 6931882.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17205826.0000; val_global_loss: 28244564.0000; val_optim_loss: 28244564.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8719; val_auprc_score: 0.8903; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 35477.7324; train_edge_recon_loss: 3526933.3333; train_gene_expr_recon_loss: 6797364.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17035416.2222; train_global_loss: 27395191.3333; train_optim_loss: 27395191.3333; val_kl_reg_loss: 50951.9453; val_edge_recon_loss: 4065959.7500; val_gene_expr_recon_loss: 6621390.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17086802.0000; val_global_loss: 27825104.0000; val_optim_loss: 27825104.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8730; val_auprc_score: 0.8909; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 60008.5269; train_edge_recon_loss: 3527530.0000; train_gene_expr_recon_loss: 6563201.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16705824.5556; train_global_loss: 26856564.4444; train_optim_loss: 26856564.4444; val_kl_reg_loss: 87228.8828; val_edge_recon_loss: 4065935.2500; val_gene_expr_recon_loss: 6430180.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16791992.0000; val_global_loss: 27375336.0000; val_optim_loss: 27375336.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8652; val_auprc_score: 0.8810; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 85911.8602; train_edge_recon_loss: 3543885.1111; train_gene_expr_recon_loss: 6350469.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16674674.3333; train_global_loss: 26654940.6667; train_optim_loss: 26654940.6667; val_kl_reg_loss: 76494.4844; val_edge_recon_loss: 4065950.5000; val_gene_expr_recon_loss: 6167486.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16638376.0000; val_global_loss: 26948308.0000; val_optim_loss: 26948308.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8680; val_auprc_score: 0.8816; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 94399.0425; train_edge_recon_loss: 3544606.0556; train_gene_expr_recon_loss: 6119133.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16553818.5556; train_global_loss: 26311957.3333; train_optim_loss: 26311957.3333; val_kl_reg_loss: 81258.9609; val_edge_recon_loss: 4065885.7500; val_gene_expr_recon_loss: 5954736.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16471942.0000; val_global_loss: 26573824.0000; val_optim_loss: 26573824.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8725; val_auprc_score: 0.8834; val_best_acc_score: 0.5027; val_best_f1_score: 0.6679; train_kl_reg_loss: 102421.0790; train_edge_recon_loss: 3550058.4444; train_gene_expr_recon_loss: 5822652.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16294430.3333; train_global_loss: 25769562.0000; train_optim_loss: 25769562.0000; val_kl_reg_loss: 98981.2969; val_edge_recon_loss: 4065740.7500; val_gene_expr_recon_loss: 5670337.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16366782.0000; val_global_loss: 26201840.0000; val_optim_loss: 26201840.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8583; val_auprc_score: 0.8719; val_best_acc_score: 0.5053; val_best_f1_score: 0.6690; train_kl_reg_loss: 113382.8828; train_edge_recon_loss: 3544578.6111; train_gene_expr_recon_loss: 5551041.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16176750.5556; train_global_loss: 25385752.8889; train_optim_loss: 25385752.8889; val_kl_reg_loss: 101167.6953; val_edge_recon_loss: 4065621.5000; val_gene_expr_recon_loss: 5382139.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16203422.0000; val_global_loss: 25752350.0000; val_optim_loss: 25752350.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8382; val_auprc_score: 0.8527; val_best_acc_score: 0.5075; val_best_f1_score: 0.6700; train_kl_reg_loss: 112645.9505; train_edge_recon_loss: 3546575.3333; train_gene_expr_recon_loss: 5267816.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16045576.0000; train_global_loss: 24972614.2222; train_optim_loss: 24972614.2222; val_kl_reg_loss: 101466.3594; val_edge_recon_loss: 4065445.0000; val_gene_expr_recon_loss: 5076453.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16050053.0000; val_global_loss: 25293416.0000; val_optim_loss: 25293416.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8135; val_auprc_score: 0.8313; val_best_acc_score: 0.5158; val_best_f1_score: 0.6737; train_kl_reg_loss: 116393.6450; train_edge_recon_loss: 3544027.0278; train_gene_expr_recon_loss: 4994707.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15920227.0000; train_global_loss: 24575355.3333; train_optim_loss: 24575355.3333; val_kl_reg_loss: 90078.2188; val_edge_recon_loss: 4065046.2500; val_gene_expr_recon_loss: 4820358.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15914189.0000; val_global_loss: 24889672.0000; val_optim_loss: 24889672.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8022; val_auprc_score: 0.8175; val_best_acc_score: 0.5221; val_best_f1_score: 0.6765; train_kl_reg_loss: 111702.4132; train_edge_recon_loss: 3545900.7222; train_gene_expr_recon_loss: 4684179.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15740687.5556; train_global_loss: 24082469.7778; train_optim_loss: 24082469.7778; val_kl_reg_loss: 96906.0469; val_edge_recon_loss: 4064616.0000; val_gene_expr_recon_loss: 4554593.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15805744.0000; val_global_loss: 24521860.0000; val_optim_loss: 24521860.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7859; val_auprc_score: 0.8004; val_best_acc_score: 0.5263; val_best_f1_score: 0.6781; train_kl_reg_loss: 114542.1181; train_edge_recon_loss: 3539352.7500; train_gene_expr_recon_loss: 4473837.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15699116.4444; train_global_loss: 23826849.1111; train_optim_loss: 23826849.1111; val_kl_reg_loss: 92822.1406; val_edge_recon_loss: 4064129.0000; val_gene_expr_recon_loss: 4350812.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15713846.0000; val_global_loss: 24221608.0000; val_optim_loss: 24221608.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7770; val_auprc_score: 0.7863; val_best_acc_score: 0.5358; val_best_f1_score: 0.6822; train_kl_reg_loss: 109474.9514; train_edge_recon_loss: 3539283.0278; train_gene_expr_recon_loss: 4265752.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15585647.7778; train_global_loss: 23500158.6667; train_optim_loss: 23500158.6667; val_kl_reg_loss: 93399.8750; val_edge_recon_loss: 4063497.7500; val_gene_expr_recon_loss: 4171163.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15650632.0000; val_global_loss: 23978692.0000; val_optim_loss: 23978692.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7676; val_auprc_score: 0.7738; val_best_acc_score: 0.5428; val_best_f1_score: 0.6847; train_kl_reg_loss: 110496.5339; train_edge_recon_loss: 3534407.8056; train_gene_expr_recon_loss: 4139605.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15505269.0000; train_global_loss: 23289779.1111; train_optim_loss: 23289779.1111; val_kl_reg_loss: 90151.5781; val_edge_recon_loss: 4062814.0000; val_gene_expr_recon_loss: 4061972.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15587489.0000; val_global_loss: 23802428.0000; val_optim_loss: 23802428.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7704; val_auprc_score: 0.7764; val_best_acc_score: 0.5525; val_best_f1_score: 0.6885; train_kl_reg_loss: 104917.1892; train_edge_recon_loss: 3534887.1944; train_gene_expr_recon_loss: 4029953.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15387449.4444; train_global_loss: 23057207.5556; train_optim_loss: 23057207.5556; val_kl_reg_loss: 99236.5781; val_edge_recon_loss: 4062079.0000; val_gene_expr_recon_loss: 3981638.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15511018.0000; val_global_loss: 23653972.0000; val_optim_loss: 23653972.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7659; val_auprc_score: 0.7622; val_best_acc_score: 0.5837; val_best_f1_score: 0.7010; train_kl_reg_loss: 106495.7240; train_edge_recon_loss: 3529034.6944; train_gene_expr_recon_loss: 4009583.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15397164.5556; train_global_loss: 23042278.0000; train_optim_loss: 23042278.0000; val_kl_reg_loss: 68330.7578; val_edge_recon_loss: 4059291.5000; val_gene_expr_recon_loss: 3982423.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15500698.0000; val_global_loss: 23610744.0000; val_optim_loss: 23610744.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7691; val_auprc_score: 0.7695; val_best_acc_score: 0.5802; val_best_f1_score: 0.6992; train_kl_reg_loss: 97148.8516; train_edge_recon_loss: 3536093.1944; train_gene_expr_recon_loss: 3958170.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15361540.7778; train_global_loss: 22952953.3333; train_optim_loss: 22952953.3333; val_kl_reg_loss: 89640.9531; val_edge_recon_loss: 4059130.0000; val_gene_expr_recon_loss: 3915013.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15442018.0000; val_global_loss: 23505802.0000; val_optim_loss: 23505802.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7707; val_auprc_score: 0.7666; val_best_acc_score: 0.6085; val_best_f1_score: 0.7120; train_kl_reg_loss: 101028.3455; train_edge_recon_loss: 3522021.5833; train_gene_expr_recon_loss: 3942880.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15332179.5556; train_global_loss: 22898110.0000; train_optim_loss: 22898110.0000; val_kl_reg_loss: 80338.4297; val_edge_recon_loss: 4056803.5000; val_gene_expr_recon_loss: 3901951.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15433042.0000; val_global_loss: 23472136.0000; val_optim_loss: 23472136.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7699; val_auprc_score: 0.7652; val_best_acc_score: 0.6252; val_best_f1_score: 0.7192; train_kl_reg_loss: 95052.6285; train_edge_recon_loss: 3524241.6111; train_gene_expr_recon_loss: 3905733.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15283429.3333; train_global_loss: 22808456.8889; train_optim_loss: 22808456.8889; val_kl_reg_loss: 85024.7109; val_edge_recon_loss: 4054509.0000; val_gene_expr_recon_loss: 3892660.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15419623.0000; val_global_loss: 23451816.0000; val_optim_loss: 23451816.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.7716; val_auprc_score: 0.7637; val_best_acc_score: 0.6454; val_best_f1_score: 0.7269; train_kl_reg_loss: 93435.3177; train_edge_recon_loss: 3522051.1944; train_gene_expr_recon_loss: 3891006.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15266280.3333; train_global_loss: 22772773.5556; train_optim_loss: 22772773.5556; val_kl_reg_loss: 82848.7812; val_edge_recon_loss: 4051089.5000; val_gene_expr_recon_loss: 3879155.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15414021.0000; val_global_loss: 23427114.0000; val_optim_loss: 23427114.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7759; val_auprc_score: 0.7684; val_best_acc_score: 0.6718; val_best_f1_score: 0.7358; train_kl_reg_loss: 91904.9184; train_edge_recon_loss: 3519856.6944; train_gene_expr_recon_loss: 3886052.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15283797.7778; train_global_loss: 22781612.0000; train_optim_loss: 22781612.0000; val_kl_reg_loss: 71544.2734; val_edge_recon_loss: 4045923.2500; val_gene_expr_recon_loss: 3879177.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15383072.0000; val_global_loss: 23379716.0000; val_optim_loss: 23379716.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.7710; val_auprc_score: 0.7633; val_best_acc_score: 0.6811; val_best_f1_score: 0.7371; train_kl_reg_loss: 88301.3203; train_edge_recon_loss: 3520461.4167; train_gene_expr_recon_loss: 3916446.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15314994.0000; train_global_loss: 22840203.1111; train_optim_loss: 22840203.1111; val_kl_reg_loss: 78845.0469; val_edge_recon_loss: 4043096.2500; val_gene_expr_recon_loss: 3862037.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15389446.0000; val_global_loss: 23373424.0000; val_optim_loss: 23373424.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.7820; val_auprc_score: 0.7763; val_best_acc_score: 0.6973; val_best_f1_score: 0.7372; train_kl_reg_loss: 87794.5443; train_edge_recon_loss: 3514514.6944; train_gene_expr_recon_loss: 3915979.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15309379.6667; train_global_loss: 22827668.6667; train_optim_loss: 22827668.6667; val_kl_reg_loss: 69081.6562; val_edge_recon_loss: 4032741.0000; val_gene_expr_recon_loss: 3859328.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15369322.0000; val_global_loss: 23330472.0000; val_optim_loss: 23330472.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.7837; val_auprc_score: 0.7758; val_best_acc_score: 0.7065; val_best_f1_score: 0.7337; train_kl_reg_loss: 84607.1250; train_edge_recon_loss: 3512861.6944; train_gene_expr_recon_loss: 3874099.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15271116.0000; train_global_loss: 22742684.4444; train_optim_loss: 22742684.4444; val_kl_reg_loss: 70315.9844; val_edge_recon_loss: 4023208.0000; val_gene_expr_recon_loss: 3851831.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15366524.0000; val_global_loss: 23311880.0000; val_optim_loss: 23311880.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.7974; val_auprc_score: 0.7887; val_best_acc_score: 0.7169; val_best_f1_score: 0.7270; train_kl_reg_loss: 81668.5087; train_edge_recon_loss: 3509301.0000; train_gene_expr_recon_loss: 3882580.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15228300.3333; train_global_loss: 22701850.4444; train_optim_loss: 22701850.4444; val_kl_reg_loss: 63580.1562; val_edge_recon_loss: 4006352.2500; val_gene_expr_recon_loss: 3856459.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15370775.0000; val_global_loss: 23297168.0000; val_optim_loss: 23297168.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8059; val_auprc_score: 0.7958; val_best_acc_score: 0.7142; val_best_f1_score: 0.7504; train_kl_reg_loss: 54513.2982; train_edge_recon_loss: 3874377.2778; train_gene_expr_recon_loss: 3951997.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15377464.1111; train_global_loss: 23258352.8889; train_optim_loss: 23258352.8889; val_kl_reg_loss: 46949.0391; val_edge_recon_loss: 4036052.7500; val_gene_expr_recon_loss: 3990584.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15477179.0000; val_global_loss: 23550764.0000; val_optim_loss: 23550764.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.7934; val_auprc_score: 0.7872; val_best_acc_score: 0.5822; val_best_f1_score: 0.7023; train_kl_reg_loss: 25523.1564; train_edge_recon_loss: 3635516.8611; train_gene_expr_recon_loss: 4340759.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15535507.0000; train_global_loss: 23537306.6667; train_optim_loss: 23537306.6667; val_kl_reg_loss: 71652.3125; val_edge_recon_loss: 4060388.7500; val_gene_expr_recon_loss: 3969535.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15500668.0000; val_global_loss: 23602244.0000; val_optim_loss: 23602244.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.7946; val_auprc_score: 0.7854; val_best_acc_score: 0.5738; val_best_f1_score: 0.6996; train_kl_reg_loss: 29234.4491; train_edge_recon_loss: 3626561.9444; train_gene_expr_recon_loss: 4516589.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15823914.6667; train_global_loss: 23996300.6667; train_optim_loss: 23996300.6667; val_kl_reg_loss: 14096.9355; val_edge_recon_loss: 4061455.2500; val_gene_expr_recon_loss: 4057742.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15514753.0000; val_global_loss: 23648048.0000; val_optim_loss: 23648048.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.7910; val_auprc_score: 0.7962; val_best_acc_score: 0.5283; val_best_f1_score: 0.6788; train_kl_reg_loss: 5175.7582; train_edge_recon_loss: 3656066.5833; train_gene_expr_recon_loss: 4632710.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15802060.6667; train_global_loss: 24096014.0000; train_optim_loss: 24096014.0000; val_kl_reg_loss: 16660.3281; val_edge_recon_loss: 4063734.0000; val_gene_expr_recon_loss: 4054479.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15568850.0000; val_global_loss: 23703724.0000; val_optim_loss: 23703724.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.7914; val_auprc_score: 0.7945; val_best_acc_score: 0.5276; val_best_f1_score: 0.6788; train_kl_reg_loss: 20933.2795; train_edge_recon_loss: 3588335.1944; train_gene_expr_recon_loss: 4122253.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15557369.1111; train_global_loss: 23288890.8889; train_optim_loss: 23288890.8889; val_kl_reg_loss: 19907.1016; val_edge_recon_loss: 4063823.0000; val_gene_expr_recon_loss: 4015515.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15533719.0000; val_global_loss: 23632964.0000; val_optim_loss: 23632964.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.7956; val_auprc_score: 0.7985; val_best_acc_score: 0.5300; val_best_f1_score: 0.6798; train_kl_reg_loss: 19993.1361; train_edge_recon_loss: 3603619.2500; train_gene_expr_recon_loss: 4071910.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15519057.7778; train_global_loss: 23214580.0000; train_optim_loss: 23214580.0000; val_kl_reg_loss: 18412.2930; val_edge_recon_loss: 4063627.5000; val_gene_expr_recon_loss: 3990079.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15445744.0000; val_global_loss: 23517864.0000; val_optim_loss: 23517864.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.7930; val_auprc_score: 0.7929; val_best_acc_score: 0.5269; val_best_f1_score: 0.6784; train_kl_reg_loss: 21197.3980; train_edge_recon_loss: 3597976.3333; train_gene_expr_recon_loss: 4033301.3611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15364134.4444; train_global_loss: 23016609.7778; train_optim_loss: 23016609.7778; val_kl_reg_loss: 22554.2617; val_edge_recon_loss: 4063712.7500; val_gene_expr_recon_loss: 3970939.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15471310.0000; val_global_loss: 23528516.0000; val_optim_loss: 23528516.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.7907; val_auprc_score: 0.7921; val_best_acc_score: 0.5286; val_best_f1_score: 0.6791; train_kl_reg_loss: 26404.2112; train_edge_recon_loss: 3579960.0000; train_gene_expr_recon_loss: 4034305.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15411611.1111; train_global_loss: 23052280.6667; train_optim_loss: 23052280.6667; val_kl_reg_loss: 25933.5664; val_edge_recon_loss: 4063721.0000; val_gene_expr_recon_loss: 3948602.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15431912.0000; val_global_loss: 23470168.0000; val_optim_loss: 23470168.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 40 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8123
val AUPRC score: 0.8037
val best accuracy score: 0.7102
val best F1 score: 0.7539
val target rna MSE score: 1.7235
val source rna MSE score: 1.0769
val target atac MSE score: 0.1213
val source atac MSE score: 0.0181
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
