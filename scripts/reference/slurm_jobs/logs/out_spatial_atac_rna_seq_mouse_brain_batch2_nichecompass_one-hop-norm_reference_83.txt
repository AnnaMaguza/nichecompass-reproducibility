[True]
Run timestamp: 07082023_195917_83.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_83']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8729; val_auprc_score: 0.8840; val_best_acc_score: 0.5291; val_best_f1_score: 0.6793; train_kl_reg_loss: 18509.9516; train_edge_recon_loss: 348647.5312; train_gene_expr_recon_loss: 1267025.5139; train_masked_gp_l1_reg_loss: 4578.5743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119281.9375; train_chrom_access_recon_loss: 729779.1111; train_global_loss: 2487822.6944; train_optim_loss: 2487822.6944; val_kl_reg_loss: 3569.9719; val_edge_recon_loss: 406343.5000; val_gene_expr_recon_loss: 1077257.0000; val_masked_gp_l1_reg_loss: 4127.3062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116872.5859; val_chrom_access_recon_loss: 498419.7188; val_global_loss: 2106590.0000; val_optim_loss: 2106590.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8651; val_auprc_score: 0.8754; val_best_acc_score: 0.5131; val_best_f1_score: 0.6725; train_kl_reg_loss: 5646.2046; train_edge_recon_loss: 351335.2500; train_gene_expr_recon_loss: 1027026.6250; train_masked_gp_l1_reg_loss: 4058.5821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115254.4089; train_chrom_access_recon_loss: 495660.3264; train_global_loss: 1998981.3611; train_optim_loss: 1998981.3611; val_kl_reg_loss: 8050.7676; val_edge_recon_loss: 406468.5938; val_gene_expr_recon_loss: 924547.8125; val_masked_gp_l1_reg_loss: 4062.3718; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113179.0234; val_chrom_access_recon_loss: 488152.0000; val_global_loss: 1944460.6250; val_optim_loss: 1944460.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8507; val_auprc_score: 0.8609; val_best_acc_score: 0.5116; val_best_f1_score: 0.6718; train_kl_reg_loss: 11854.5472; train_edge_recon_loss: 355947.2292; train_gene_expr_recon_loss: 893699.6250; train_masked_gp_l1_reg_loss: 4153.4311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111439.8125; train_chrom_access_recon_loss: 484021.0590; train_global_loss: 1861115.6806; train_optim_loss: 1861115.6806; val_kl_reg_loss: 14526.7070; val_edge_recon_loss: 406492.0938; val_gene_expr_recon_loss: 825636.8125; val_masked_gp_l1_reg_loss: 4247.0835; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109236.0547; val_chrom_access_recon_loss: 477812.5938; val_global_loss: 1837951.3750; val_optim_loss: 1837951.3750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8353; val_auprc_score: 0.8468; val_best_acc_score: 0.5216; val_best_f1_score: 0.6762; train_kl_reg_loss: 16841.9997; train_edge_recon_loss: 358041.3333; train_gene_expr_recon_loss: 814414.9306; train_masked_gp_l1_reg_loss: 4262.9354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107414.2682; train_chrom_access_recon_loss: 473904.0833; train_global_loss: 1774879.5417; train_optim_loss: 1774879.5417; val_kl_reg_loss: 15780.9072; val_edge_recon_loss: 406433.6562; val_gene_expr_recon_loss: 768487.8750; val_masked_gp_l1_reg_loss: 4249.1987; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105072.4531; val_chrom_access_recon_loss: 460228.3125; val_global_loss: 1760252.5000; val_optim_loss: 1760252.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8400; val_auprc_score: 0.8501; val_best_acc_score: 0.5344; val_best_f1_score: 0.6807; train_kl_reg_loss: 18210.6865; train_edge_recon_loss: 358523.4688; train_gene_expr_recon_loss: 764946.7847; train_masked_gp_l1_reg_loss: 4229.6421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103092.0859; train_chrom_access_recon_loss: 458863.6007; train_global_loss: 1707866.2361; train_optim_loss: 1707866.2361; val_kl_reg_loss: 17308.2266; val_edge_recon_loss: 406294.5312; val_gene_expr_recon_loss: 730051.6250; val_masked_gp_l1_reg_loss: 4199.4448; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100541.4141; val_chrom_access_recon_loss: 453335.4062; val_global_loss: 1711730.6250; val_optim_loss: 1711730.6250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8592; val_auprc_score: 0.8630; val_best_acc_score: 0.5477; val_best_f1_score: 0.6851; train_kl_reg_loss: 18603.8724; train_edge_recon_loss: 358407.8333; train_gene_expr_recon_loss: 734671.4792; train_masked_gp_l1_reg_loss: 4177.2882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98384.6050; train_chrom_access_recon_loss: 452359.6806; train_global_loss: 1666604.7639; train_optim_loss: 1666604.7639; val_kl_reg_loss: 17680.8770; val_edge_recon_loss: 405983.1875; val_gene_expr_recon_loss: 710412.7500; val_masked_gp_l1_reg_loss: 4148.7051; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95635.7422; val_chrom_access_recon_loss: 449404.9375; val_global_loss: 1683266.2500; val_optim_loss: 1683266.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8668; val_auprc_score: 0.8691; val_best_acc_score: 0.6130; val_best_f1_score: 0.7146; train_kl_reg_loss: 18845.7394; train_edge_recon_loss: 357760.5799; train_gene_expr_recon_loss: 713056.6389; train_masked_gp_l1_reg_loss: 4137.4205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93379.8889; train_chrom_access_recon_loss: 448146.9375; train_global_loss: 1635327.2083; train_optim_loss: 1635327.2083; val_kl_reg_loss: 17202.8828; val_edge_recon_loss: 405279.2188; val_gene_expr_recon_loss: 695326.3750; val_masked_gp_l1_reg_loss: 4119.1738; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90541.1250; val_chrom_access_recon_loss: 446687.5938; val_global_loss: 1659156.3750; val_optim_loss: 1659156.3750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8481; val_auprc_score: 0.8465; val_best_acc_score: 0.6916; val_best_f1_score: 0.7527; train_kl_reg_loss: 18865.5977; train_edge_recon_loss: 357537.6007; train_gene_expr_recon_loss: 699575.3472; train_masked_gp_l1_reg_loss: 4115.3988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88258.6858; train_chrom_access_recon_loss: 444271.1632; train_global_loss: 1612623.7500; train_optim_loss: 1612623.7500; val_kl_reg_loss: 18596.6602; val_edge_recon_loss: 403873.2188; val_gene_expr_recon_loss: 683805.5625; val_masked_gp_l1_reg_loss: 4106.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85409.6406; val_chrom_access_recon_loss: 444760.5625; val_global_loss: 1640552.0000; val_optim_loss: 1640552.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8345; val_auprc_score: 0.8313; val_best_acc_score: 0.7458; val_best_f1_score: 0.7676; train_kl_reg_loss: 19076.3963; train_edge_recon_loss: 356934.0694; train_gene_expr_recon_loss: 692821.3889; train_masked_gp_l1_reg_loss: 4109.8633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83148.1684; train_chrom_access_recon_loss: 444665.0833; train_global_loss: 1600754.9444; train_optim_loss: 1600754.9444; val_kl_reg_loss: 16767.6602; val_edge_recon_loss: 401509.1562; val_gene_expr_recon_loss: 678452.3125; val_masked_gp_l1_reg_loss: 4107.0068; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80335.9375; val_chrom_access_recon_loss: 443111.1875; val_global_loss: 1624283.2500; val_optim_loss: 1624283.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8244; val_auprc_score: 0.8180; val_best_acc_score: 0.7417; val_best_f1_score: 0.7372; train_kl_reg_loss: 19114.3420; train_edge_recon_loss: 356327.7049; train_gene_expr_recon_loss: 688132.4236; train_masked_gp_l1_reg_loss: 4119.9340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78135.8273; train_chrom_access_recon_loss: 443161.4097; train_global_loss: 1588991.6250; train_optim_loss: 1588991.6250; val_kl_reg_loss: 17179.5996; val_edge_recon_loss: 398857.9375; val_gene_expr_recon_loss: 671989.5000; val_masked_gp_l1_reg_loss: 4126.5908; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75409.7188; val_chrom_access_recon_loss: 441905.3750; val_global_loss: 1609468.7500; val_optim_loss: 1609468.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8259; val_auprc_score: 0.8194; val_best_acc_score: 0.7196; val_best_f1_score: 0.7596; train_kl_reg_loss: 18760.2467; train_edge_recon_loss: 355229.0938; train_gene_expr_recon_loss: 679617.2222; train_masked_gp_l1_reg_loss: 4140.5541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73281.9514; train_chrom_access_recon_loss: 441003.5069; train_global_loss: 1572032.5972; train_optim_loss: 1572032.5972; val_kl_reg_loss: 17422.6836; val_edge_recon_loss: 394605.7812; val_gene_expr_recon_loss: 667538.1875; val_masked_gp_l1_reg_loss: 4152.0601; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70652.9531; val_chrom_access_recon_loss: 440864.3438; val_global_loss: 1595236.0000; val_optim_loss: 1595236.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8372; val_auprc_score: 0.8264; val_best_acc_score: 0.7542; val_best_f1_score: 0.7764; train_kl_reg_loss: 18397.7296; train_edge_recon_loss: 353351.5938; train_gene_expr_recon_loss: 675893.9028; train_masked_gp_l1_reg_loss: 4170.5207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68612.7509; train_chrom_access_recon_loss: 440155.5069; train_global_loss: 1560582.0139; train_optim_loss: 1560582.0139; val_kl_reg_loss: 16996.0039; val_edge_recon_loss: 386921.8750; val_gene_expr_recon_loss: 664640.0000; val_masked_gp_l1_reg_loss: 4188.4160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66098.2734; val_chrom_access_recon_loss: 439816.9375; val_global_loss: 1578661.5000; val_optim_loss: 1578661.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8430; val_auprc_score: 0.8357; val_best_acc_score: 0.7617; val_best_f1_score: 0.7781; train_kl_reg_loss: 18083.0998; train_edge_recon_loss: 350811.9062; train_gene_expr_recon_loss: 674227.4722; train_masked_gp_l1_reg_loss: 4216.0068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64161.6063; train_chrom_access_recon_loss: 440248.0208; train_global_loss: 1551748.1250; train_optim_loss: 1551748.1250; val_kl_reg_loss: 17233.4629; val_edge_recon_loss: 377840.1250; val_gene_expr_recon_loss: 661999.9375; val_masked_gp_l1_reg_loss: 4237.2471; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61776.9492; val_chrom_access_recon_loss: 439060.0625; val_global_loss: 1562147.7500; val_optim_loss: 1562147.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8530; val_auprc_score: 0.8415; val_best_acc_score: 0.7696; val_best_f1_score: 0.7856; train_kl_reg_loss: 17626.2650; train_edge_recon_loss: 346222.3299; train_gene_expr_recon_loss: 672875.1736; train_masked_gp_l1_reg_loss: 4261.5199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59942.6545; train_chrom_access_recon_loss: 439049.8889; train_global_loss: 1539977.8472; train_optim_loss: 1539977.8472; val_kl_reg_loss: 16087.6641; val_edge_recon_loss: 363947.8438; val_gene_expr_recon_loss: 661453.2500; val_masked_gp_l1_reg_loss: 4285.2251; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57692.4297; val_chrom_access_recon_loss: 438111.5625; val_global_loss: 1541578.0000; val_optim_loss: 1541578.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8769; val_auprc_score: 0.8707; val_best_acc_score: 0.7921; val_best_f1_score: 0.7995; train_kl_reg_loss: 17486.3822; train_edge_recon_loss: 338668.4861; train_gene_expr_recon_loss: 669140.5417; train_masked_gp_l1_reg_loss: 4315.3850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55977.2457; train_chrom_access_recon_loss: 438061.7708; train_global_loss: 1523649.8194; train_optim_loss: 1523649.8194; val_kl_reg_loss: 17291.1016; val_edge_recon_loss: 342043.9062; val_gene_expr_recon_loss: 661200.5000; val_masked_gp_l1_reg_loss: 4348.0918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53872.0078; val_chrom_access_recon_loss: 437814.1562; val_global_loss: 1516569.7500; val_optim_loss: 1516569.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8889; val_auprc_score: 0.8831; val_best_acc_score: 0.8067; val_best_f1_score: 0.8118; train_kl_reg_loss: 19797.3073; train_edge_recon_loss: 325261.7465; train_gene_expr_recon_loss: 672956.3819; train_masked_gp_l1_reg_loss: 4383.4655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52277.4457; train_chrom_access_recon_loss: 439199.7465; train_global_loss: 1513876.1250; train_optim_loss: 1513876.1250; val_kl_reg_loss: 21618.4766; val_edge_recon_loss: 320194.9688; val_gene_expr_recon_loss: 660946.1250; val_masked_gp_l1_reg_loss: 4423.4561; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50328.6523; val_chrom_access_recon_loss: 437316.7500; val_global_loss: 1494828.3750; val_optim_loss: 1494828.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9042; val_auprc_score: 0.8899; val_best_acc_score: 0.8230; val_best_f1_score: 0.8293; train_kl_reg_loss: 25100.5141; train_edge_recon_loss: 312247.4028; train_gene_expr_recon_loss: 669208.3056; train_masked_gp_l1_reg_loss: 4461.3284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48858.3060; train_chrom_access_recon_loss: 436969.5972; train_global_loss: 1496845.4722; train_optim_loss: 1496845.4722; val_kl_reg_loss: 26022.2969; val_edge_recon_loss: 307147.2500; val_gene_expr_recon_loss: 660179.1250; val_masked_gp_l1_reg_loss: 4496.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47065.7852; val_chrom_access_recon_loss: 436767.9688; val_global_loss: 1481679.2500; val_optim_loss: 1481679.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9193; val_auprc_score: 0.9069; val_best_acc_score: 0.8442; val_best_f1_score: 0.8525; train_kl_reg_loss: 27048.4078; train_edge_recon_loss: 303806.2743; train_gene_expr_recon_loss: 668236.5694; train_masked_gp_l1_reg_loss: 4530.1398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45724.6363; train_chrom_access_recon_loss: 437709.0799; train_global_loss: 1487055.1528; train_optim_loss: 1487055.1528; val_kl_reg_loss: 25275.0898; val_edge_recon_loss: 303944.0625; val_gene_expr_recon_loss: 658573.5000; val_masked_gp_l1_reg_loss: 4561.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44082.0000; val_chrom_access_recon_loss: 436175.1562; val_global_loss: 1472611.5000; val_optim_loss: 1472611.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9317; val_auprc_score: 0.9151; val_best_acc_score: 0.8672; val_best_f1_score: 0.8728; train_kl_reg_loss: 25929.8576; train_edge_recon_loss: 302641.7951; train_gene_expr_recon_loss: 666211.7569; train_masked_gp_l1_reg_loss: 4592.4505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42841.6306; train_chrom_access_recon_loss: 436529.4583; train_global_loss: 1478746.9306; train_optim_loss: 1478746.9306; val_kl_reg_loss: 25097.7070; val_edge_recon_loss: 300236.4375; val_gene_expr_recon_loss: 655466.6250; val_masked_gp_l1_reg_loss: 4623.5708; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41323.0469; val_chrom_access_recon_loss: 435066.3125; val_global_loss: 1461813.7500; val_optim_loss: 1461813.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9320; val_auprc_score: 0.9133; val_best_acc_score: 0.8646; val_best_f1_score: 0.8711; train_kl_reg_loss: 25936.9217; train_edge_recon_loss: 299735.2118; train_gene_expr_recon_loss: 664362.1181; train_masked_gp_l1_reg_loss: 4649.3578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40182.1710; train_chrom_access_recon_loss: 435292.2535; train_global_loss: 1470158.0139; train_optim_loss: 1470158.0139; val_kl_reg_loss: 25114.0859; val_edge_recon_loss: 300183.1875; val_gene_expr_recon_loss: 654888.5625; val_masked_gp_l1_reg_loss: 4672.6377; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38789.5312; val_chrom_access_recon_loss: 434492.0000; val_global_loss: 1458140.0000; val_optim_loss: 1458140.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9397; val_auprc_score: 0.9246; val_best_acc_score: 0.8729; val_best_f1_score: 0.8776; train_kl_reg_loss: 25962.7283; train_edge_recon_loss: 297871.2118; train_gene_expr_recon_loss: 665044.7847; train_masked_gp_l1_reg_loss: 4696.5583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37747.9640; train_chrom_access_recon_loss: 435574.6181; train_global_loss: 1466897.8472; train_optim_loss: 1466897.8472; val_kl_reg_loss: 25155.8496; val_edge_recon_loss: 297884.1875; val_gene_expr_recon_loss: 652502.8125; val_masked_gp_l1_reg_loss: 4719.0908; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36470.5859; val_chrom_access_recon_loss: 433598.8125; val_global_loss: 1450331.2500; val_optim_loss: 1450331.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9438; val_auprc_score: 0.9298; val_best_acc_score: 0.8795; val_best_f1_score: 0.8836; train_kl_reg_loss: 25847.9705; train_edge_recon_loss: 295949.9931; train_gene_expr_recon_loss: 659977.1736; train_masked_gp_l1_reg_loss: 4743.9472; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35514.1272; train_chrom_access_recon_loss: 434362.4271; train_global_loss: 1456395.6667; train_optim_loss: 1456395.6667; val_kl_reg_loss: 25218.4102; val_edge_recon_loss: 295119.3750; val_gene_expr_recon_loss: 650972.3750; val_masked_gp_l1_reg_loss: 4765.7559; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34340.6016; val_chrom_access_recon_loss: 433025.5000; val_global_loss: 1443442.0000; val_optim_loss: 1443442.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9438; val_auprc_score: 0.9229; val_best_acc_score: 0.8793; val_best_f1_score: 0.8835; train_kl_reg_loss: 26122.6803; train_edge_recon_loss: 293270.5729; train_gene_expr_recon_loss: 659054.8681; train_masked_gp_l1_reg_loss: 4788.6878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33463.1111; train_chrom_access_recon_loss: 432360.5799; train_global_loss: 1449060.5000; train_optim_loss: 1449060.5000; val_kl_reg_loss: 25923.3789; val_edge_recon_loss: 293714.0000; val_gene_expr_recon_loss: 649532.1875; val_masked_gp_l1_reg_loss: 4812.8389; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32386.8594; val_chrom_access_recon_loss: 432236.8125; val_global_loss: 1438606.0000; val_optim_loss: 1438606.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9527; val_auprc_score: 0.9425; val_best_acc_score: 0.8860; val_best_f1_score: 0.8897; train_kl_reg_loss: 26224.8715; train_edge_recon_loss: 294182.3611; train_gene_expr_recon_loss: 657273.7986; train_masked_gp_l1_reg_loss: 4837.3155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31583.3140; train_chrom_access_recon_loss: 433246.2431; train_global_loss: 1447347.9306; train_optim_loss: 1447347.9306; val_kl_reg_loss: 25179.3164; val_edge_recon_loss: 293566.7500; val_gene_expr_recon_loss: 648577.9375; val_masked_gp_l1_reg_loss: 4855.4053; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30600.3418; val_chrom_access_recon_loss: 431554.3125; val_global_loss: 1434334.0000; val_optim_loss: 1434334.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9496; val_auprc_score: 0.9304; val_best_acc_score: 0.8867; val_best_f1_score: 0.8910; train_kl_reg_loss: 25603.1686; train_edge_recon_loss: 292919.4722; train_gene_expr_recon_loss: 655007.6944; train_masked_gp_l1_reg_loss: 4879.2979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29862.0174; train_chrom_access_recon_loss: 429970.7743; train_global_loss: 1438242.4306; train_optim_loss: 1438242.4306; val_kl_reg_loss: 25030.6797; val_edge_recon_loss: 292707.7812; val_gene_expr_recon_loss: 647349.8750; val_masked_gp_l1_reg_loss: 4899.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28952.2441; val_chrom_access_recon_loss: 430935.3438; val_global_loss: 1429875.6250; val_optim_loss: 1429875.6250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9554; val_auprc_score: 0.9405; val_best_acc_score: 0.8976; val_best_f1_score: 0.9007; train_kl_reg_loss: 23431.9306; train_edge_recon_loss: 292949.9965; train_gene_expr_recon_loss: 942674.0139; train_masked_gp_l1_reg_loss: 4985.3855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28155.0156; train_chrom_access_recon_loss: 455359.7569; train_global_loss: 1747556.0833; train_optim_loss: 1747556.0833; val_kl_reg_loss: 16145.4102; val_edge_recon_loss: 289611.1562; val_gene_expr_recon_loss: 924906.9375; val_masked_gp_l1_reg_loss: 5121.8804; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27095.9961; val_chrom_access_recon_loss: 454310.6562; val_global_loss: 1717192.0000; val_optim_loss: 1717192.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9559; val_auprc_score: 0.9431; val_best_acc_score: 0.8949; val_best_f1_score: 0.8976; train_kl_reg_loss: 22101.7216; train_edge_recon_loss: 290420.9236; train_gene_expr_recon_loss: 932375.8125; train_masked_gp_l1_reg_loss: 5243.3506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26223.0712; train_chrom_access_recon_loss: 452811.1354; train_global_loss: 1729176.0000; train_optim_loss: 1729176.0000; val_kl_reg_loss: 17060.3477; val_edge_recon_loss: 289754.7500; val_gene_expr_recon_loss: 919510.6250; val_masked_gp_l1_reg_loss: 5382.7178; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25143.5000; val_chrom_access_recon_loss: 453528.0312; val_global_loss: 1710380.0000; val_optim_loss: 1710380.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9618; val_auprc_score: 0.9463; val_best_acc_score: 0.9093; val_best_f1_score: 0.9113; train_kl_reg_loss: 21996.8921; train_edge_recon_loss: 289177.4514; train_gene_expr_recon_loss: 924531.6042; train_masked_gp_l1_reg_loss: 5483.0985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24317.0753; train_chrom_access_recon_loss: 451079.4167; train_global_loss: 1716585.5417; train_optim_loss: 1716585.5417; val_kl_reg_loss: 18334.7129; val_edge_recon_loss: 286376.0938; val_gene_expr_recon_loss: 913243.3750; val_masked_gp_l1_reg_loss: 5596.7236; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23312.6992; val_chrom_access_recon_loss: 452473.7188; val_global_loss: 1699337.5000; val_optim_loss: 1699337.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9604; val_auprc_score: 0.9472; val_best_acc_score: 0.9057; val_best_f1_score: 0.9091; train_kl_reg_loss: 21891.7103; train_edge_recon_loss: 286860.5174; train_gene_expr_recon_loss: 921308.3472; train_masked_gp_l1_reg_loss: 5676.8762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22554.5332; train_chrom_access_recon_loss: 452194.4271; train_global_loss: 1710486.3611; train_optim_loss: 1710486.3611; val_kl_reg_loss: 19234.8320; val_edge_recon_loss: 288234.2812; val_gene_expr_recon_loss: 907963.9375; val_masked_gp_l1_reg_loss: 5767.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21635.3926; val_chrom_access_recon_loss: 451735.2188; val_global_loss: 1694571.3750; val_optim_loss: 1694571.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9640; val_auprc_score: 0.9543; val_best_acc_score: 0.9108; val_best_f1_score: 0.9134; train_kl_reg_loss: 21700.5553; train_edge_recon_loss: 287020.4410; train_gene_expr_recon_loss: 919570.9792; train_masked_gp_l1_reg_loss: 5760.5775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21520.8197; train_chrom_access_recon_loss: 451793.5972; train_global_loss: 1707366.9861; train_optim_loss: 1707366.9861; val_kl_reg_loss: 19079.1055; val_edge_recon_loss: 286816.8750; val_gene_expr_recon_loss: 908374.4375; val_masked_gp_l1_reg_loss: 5753.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21384.9375; val_chrom_access_recon_loss: 451702.7812; val_global_loss: 1693111.2500; val_optim_loss: 1693111.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9654; val_auprc_score: 0.9579; val_best_acc_score: 0.9101; val_best_f1_score: 0.9120; train_kl_reg_loss: 21624.5571; train_edge_recon_loss: 285921.4306; train_gene_expr_recon_loss: 917076.6111; train_masked_gp_l1_reg_loss: 5753.8226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21293.9961; train_chrom_access_recon_loss: 450361.1979; train_global_loss: 1702031.5972; train_optim_loss: 1702031.5972; val_kl_reg_loss: 19211.8359; val_edge_recon_loss: 287068.9688; val_gene_expr_recon_loss: 908040.1250; val_masked_gp_l1_reg_loss: 5754.1597; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21179.4102; val_chrom_access_recon_loss: 451596.1875; val_global_loss: 1692850.7500; val_optim_loss: 1692850.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9631; val_auprc_score: 0.9510; val_best_acc_score: 0.9066; val_best_f1_score: 0.9093; train_kl_reg_loss: 21700.5970; train_edge_recon_loss: 287402.3507; train_gene_expr_recon_loss: 921863.9931; train_masked_gp_l1_reg_loss: 5755.9090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21093.9922; train_chrom_access_recon_loss: 452134.6875; train_global_loss: 1709951.5000; train_optim_loss: 1709951.5000; val_kl_reg_loss: 19272.8398; val_edge_recon_loss: 288113.5625; val_gene_expr_recon_loss: 907554.1875; val_masked_gp_l1_reg_loss: 5758.3643; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20989.2734; val_chrom_access_recon_loss: 451486.6562; val_global_loss: 1693174.8750; val_optim_loss: 1693174.8750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9652; val_auprc_score: 0.9527; val_best_acc_score: 0.9131; val_best_f1_score: 0.9160; train_kl_reg_loss: 21574.4034; train_edge_recon_loss: 286122.9931; train_gene_expr_recon_loss: 916782.6667; train_masked_gp_l1_reg_loss: 5761.2556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20908.6222; train_chrom_access_recon_loss: 450217.0174; train_global_loss: 1701366.9722; train_optim_loss: 1701366.9722; val_kl_reg_loss: 19307.0117; val_edge_recon_loss: 286704.6250; val_gene_expr_recon_loss: 907164.5000; val_masked_gp_l1_reg_loss: 5765.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20811.2344; val_chrom_access_recon_loss: 451434.1250; val_global_loss: 1691186.7500; val_optim_loss: 1691186.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 33 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9554
val AUPRC score: 0.9449
val best accuracy score: 0.8932
val best F1 score: 0.8958
val target rna MSE score: 3.7750
val source rna MSE score: 3.0117
val target atac MSE score: 0.1373
val source atac MSE score: 0.0200
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
