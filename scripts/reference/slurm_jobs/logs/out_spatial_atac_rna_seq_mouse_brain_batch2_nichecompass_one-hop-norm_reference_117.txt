[True]
Run timestamp: 26072023_032517_117.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_117']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9633; val_auprc_score: 0.9675; val_best_acc_score: 0.8956; val_best_f1_score: 0.8930; train_kl_reg_loss: 1224.5811; train_edge_recon_loss: 34657924.8889; train_gene_expr_recon_loss: 324733.3576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10740516.5556; train_global_loss: 45724400.0000; train_optim_loss: 45724400.0000; val_kl_reg_loss: 1183.3345; val_edge_recon_loss: 40440052.0000; val_gene_expr_recon_loss: 318801.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10833706.0000; val_global_loss: 51593744.0000; val_optim_loss: 51593744.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9262; val_auprc_score: 0.9225; val_best_acc_score: 0.8223; val_best_f1_score: 0.8421; train_kl_reg_loss: 800.0094; train_edge_recon_loss: 34606641.3333; train_gene_expr_recon_loss: 322527.7153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10777485.4444; train_global_loss: 45707453.7778; train_optim_loss: 45707453.7778; val_kl_reg_loss: 697.8849; val_edge_recon_loss: 38949572.0000; val_gene_expr_recon_loss: 315076.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10789689.0000; val_global_loss: 50055032.0000; val_optim_loss: 50055032.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8692; val_auprc_score: 0.8639; val_best_acc_score: 0.7743; val_best_f1_score: 0.8010; train_kl_reg_loss: 1124.4992; train_edge_recon_loss: 33738151.7778; train_gene_expr_recon_loss: 314446.2396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10726859.4444; train_global_loss: 44780582.2222; train_optim_loss: 44780582.2222; val_kl_reg_loss: 2929.5620; val_edge_recon_loss: 30781100.0000; val_gene_expr_recon_loss: 311602.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10749785.0000; val_global_loss: 41845416.0000; val_optim_loss: 41845416.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8734; val_auprc_score: 0.8562; val_best_acc_score: 0.7730; val_best_f1_score: 0.8016; train_kl_reg_loss: 9668.3915; train_edge_recon_loss: 29531888.2222; train_gene_expr_recon_loss: 313914.4965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10656448.1111; train_global_loss: 40511919.5556; train_optim_loss: 40511919.5556; val_kl_reg_loss: 20559.4023; val_edge_recon_loss: 28355836.0000; val_gene_expr_recon_loss: 312318.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10737577.0000; val_global_loss: 39426292.0000; val_optim_loss: 39426292.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8932; val_auprc_score: 0.8717; val_best_acc_score: 0.8056; val_best_f1_score: 0.8288; train_kl_reg_loss: 29083.6230; train_edge_recon_loss: 27891294.8889; train_gene_expr_recon_loss: 314353.6840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10667980.0000; train_global_loss: 38902712.4444; train_optim_loss: 38902712.4444; val_kl_reg_loss: 37078.4375; val_edge_recon_loss: 27684296.0000; val_gene_expr_recon_loss: 306423.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10669571.0000; val_global_loss: 38697368.0000; val_optim_loss: 38697368.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9064; val_auprc_score: 0.8772; val_best_acc_score: 0.8333; val_best_f1_score: 0.8492; train_kl_reg_loss: 42646.6992; train_edge_recon_loss: 27501236.6667; train_gene_expr_recon_loss: 307694.2396; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10577980.8889; train_global_loss: 38429558.6667; train_optim_loss: 38429558.6667; val_kl_reg_loss: 46600.7734; val_edge_recon_loss: 27517604.0000; val_gene_expr_recon_loss: 299740.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10586528.0000; val_global_loss: 38450472.0000; val_optim_loss: 38450472.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9235; val_auprc_score: 0.9006; val_best_acc_score: 0.8585; val_best_f1_score: 0.8668; train_kl_reg_loss: 47777.1888; train_edge_recon_loss: 27190703.1111; train_gene_expr_recon_loss: 299699.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10447310.1111; train_global_loss: 37985490.6667; train_optim_loss: 37985490.6667; val_kl_reg_loss: 48529.8633; val_edge_recon_loss: 27162232.0000; val_gene_expr_recon_loss: 293830.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10534079.0000; val_global_loss: 38038672.0000; val_optim_loss: 38038672.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9371; val_auprc_score: 0.9184; val_best_acc_score: 0.8735; val_best_f1_score: 0.8808; train_kl_reg_loss: 48630.9575; train_edge_recon_loss: 26939445.5556; train_gene_expr_recon_loss: 295324.5069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10473309.5556; train_global_loss: 37756709.7778; train_optim_loss: 37756709.7778; val_kl_reg_loss: 49891.3203; val_edge_recon_loss: 27179644.0000; val_gene_expr_recon_loss: 290645.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10488418.0000; val_global_loss: 38008600.0000; val_optim_loss: 38008600.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9453; val_auprc_score: 0.9230; val_best_acc_score: 0.8899; val_best_f1_score: 0.8939; train_kl_reg_loss: 48596.9948; train_edge_recon_loss: 26711840.6667; train_gene_expr_recon_loss: 291999.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10463710.0000; train_global_loss: 37516146.6667; train_optim_loss: 37516146.6667; val_kl_reg_loss: 47538.6875; val_edge_recon_loss: 26825834.0000; val_gene_expr_recon_loss: 287649.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10484611.0000; val_global_loss: 37645632.0000; val_optim_loss: 37645632.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9522; val_auprc_score: 0.9323; val_best_acc_score: 0.9003; val_best_f1_score: 0.9044; train_kl_reg_loss: 45237.9067; train_edge_recon_loss: 26680902.8889; train_gene_expr_recon_loss: 288140.5208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10352248.4444; train_global_loss: 37366529.7778; train_optim_loss: 37366529.7778; val_kl_reg_loss: 44321.2969; val_edge_recon_loss: 26627392.0000; val_gene_expr_recon_loss: 284557.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10450980.0000; val_global_loss: 37407252.0000; val_optim_loss: 37407252.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9596; val_auprc_score: 0.9465; val_best_acc_score: 0.9038; val_best_f1_score: 0.9081; train_kl_reg_loss: 42882.2899; train_edge_recon_loss: 26580750.6667; train_gene_expr_recon_loss: 286592.1007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10350372.2222; train_global_loss: 37260597.3333; train_optim_loss: 37260597.3333; val_kl_reg_loss: 41593.4883; val_edge_recon_loss: 26830104.0000; val_gene_expr_recon_loss: 280313.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10429548.0000; val_global_loss: 37581560.0000; val_optim_loss: 37581560.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9585; val_auprc_score: 0.9422; val_best_acc_score: 0.9046; val_best_f1_score: 0.9082; train_kl_reg_loss: 41455.6632; train_edge_recon_loss: 26551062.0000; train_gene_expr_recon_loss: 282356.1528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10314754.1111; train_global_loss: 37189627.5556; train_optim_loss: 37189627.5556; val_kl_reg_loss: 41694.4375; val_edge_recon_loss: 26692218.0000; val_gene_expr_recon_loss: 277981.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10408420.0000; val_global_loss: 37420312.0000; val_optim_loss: 37420312.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9568; val_auprc_score: 0.9383; val_best_acc_score: 0.9092; val_best_f1_score: 0.9135; train_kl_reg_loss: 41641.8841; train_edge_recon_loss: 26459691.3333; train_gene_expr_recon_loss: 278394.1597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10290540.3333; train_global_loss: 37070268.4444; train_optim_loss: 37070268.4444; val_kl_reg_loss: 41767.5391; val_edge_recon_loss: 26645362.0000; val_gene_expr_recon_loss: 275396.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10355573.0000; val_global_loss: 37318100.0000; val_optim_loss: 37318100.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9625; val_auprc_score: 0.9497; val_best_acc_score: 0.9139; val_best_f1_score: 0.9178; train_kl_reg_loss: 43155.8789; train_edge_recon_loss: 26515306.0000; train_gene_expr_recon_loss: 275606.7535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10286136.4444; train_global_loss: 37120204.8889; train_optim_loss: 37120204.8889; val_kl_reg_loss: 42524.6953; val_edge_recon_loss: 26558596.0000; val_gene_expr_recon_loss: 274152.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10361573.0000; val_global_loss: 37236844.0000; val_optim_loss: 37236844.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9622; val_auprc_score: 0.9448; val_best_acc_score: 0.9146; val_best_f1_score: 0.9178; train_kl_reg_loss: 43370.5703; train_edge_recon_loss: 26405574.0000; train_gene_expr_recon_loss: 273242.6597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10219372.3333; train_global_loss: 36941559.1111; train_optim_loss: 36941559.1111; val_kl_reg_loss: 43826.0703; val_edge_recon_loss: 26535318.0000; val_gene_expr_recon_loss: 271422.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10326461.0000; val_global_loss: 37177028.0000; val_optim_loss: 37177028.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9659; val_auprc_score: 0.9501; val_best_acc_score: 0.9235; val_best_f1_score: 0.9263; train_kl_reg_loss: 43900.3802; train_edge_recon_loss: 26467829.7778; train_gene_expr_recon_loss: 269565.7899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10183107.3333; train_global_loss: 36964403.1111; train_optim_loss: 36964403.1111; val_kl_reg_loss: 45583.9844; val_edge_recon_loss: 26514512.0000; val_gene_expr_recon_loss: 266475.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10260740.0000; val_global_loss: 37087312.0000; val_optim_loss: 37087312.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9661; val_auprc_score: 0.9501; val_best_acc_score: 0.9225; val_best_f1_score: 0.9259; train_kl_reg_loss: 45208.6780; train_edge_recon_loss: 26487986.8889; train_gene_expr_recon_loss: 266874.6285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10179796.6667; train_global_loss: 36979867.5556; train_optim_loss: 36979867.5556; val_kl_reg_loss: 45847.0078; val_edge_recon_loss: 26626584.0000; val_gene_expr_recon_loss: 264734.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10232104.0000; val_global_loss: 37169272.0000; val_optim_loss: 37169272.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9676; val_auprc_score: 0.9516; val_best_acc_score: 0.9267; val_best_f1_score: 0.9297; train_kl_reg_loss: 46691.7843; train_edge_recon_loss: 26451195.3333; train_gene_expr_recon_loss: 265109.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10163747.5556; train_global_loss: 36926744.8889; train_optim_loss: 36926744.8889; val_kl_reg_loss: 45456.5781; val_edge_recon_loss: 26391030.0000; val_gene_expr_recon_loss: 263415.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10228302.0000; val_global_loss: 36928204.0000; val_optim_loss: 36928204.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9675; val_auprc_score: 0.9537; val_best_acc_score: 0.9233; val_best_f1_score: 0.9268; train_kl_reg_loss: 47482.5651; train_edge_recon_loss: 26412975.5556; train_gene_expr_recon_loss: 263298.8212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10163357.3333; train_global_loss: 36887115.1111; train_optim_loss: 36887115.1111; val_kl_reg_loss: 47501.1562; val_edge_recon_loss: 26555148.0000; val_gene_expr_recon_loss: 261869.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10180763.0000; val_global_loss: 37045284.0000; val_optim_loss: 37045284.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9659; val_auprc_score: 0.9507; val_best_acc_score: 0.9209; val_best_f1_score: 0.9244; train_kl_reg_loss: 47983.4909; train_edge_recon_loss: 26406850.6667; train_gene_expr_recon_loss: 261731.2153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10112413.5556; train_global_loss: 36828978.6667; train_optim_loss: 36828978.6667; val_kl_reg_loss: 47089.6875; val_edge_recon_loss: 26683158.0000; val_gene_expr_recon_loss: 259365.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10181736.0000; val_global_loss: 37171352.0000; val_optim_loss: 37171352.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9700; val_auprc_score: 0.9594; val_best_acc_score: 0.9229; val_best_f1_score: 0.9264; train_kl_reg_loss: 49130.8750; train_edge_recon_loss: 26397845.5556; train_gene_expr_recon_loss: 258608.1146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10021874.5556; train_global_loss: 36727459.1111; train_optim_loss: 36727459.1111; val_kl_reg_loss: 49574.3203; val_edge_recon_loss: 26407096.0000; val_gene_expr_recon_loss: 260290.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10150561.0000; val_global_loss: 36867520.0000; val_optim_loss: 36867520.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9725; val_auprc_score: 0.9614; val_best_acc_score: 0.9286; val_best_f1_score: 0.9315; train_kl_reg_loss: 50778.4605; train_edge_recon_loss: 26490492.0000; train_gene_expr_recon_loss: 257959.8976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10051806.0000; train_global_loss: 36851036.0000; train_optim_loss: 36851036.0000; val_kl_reg_loss: 50984.0938; val_edge_recon_loss: 26396776.0000; val_gene_expr_recon_loss: 254458.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10116189.0000; val_global_loss: 36818408.0000; val_optim_loss: 36818408.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9666; val_auprc_score: 0.9505; val_best_acc_score: 0.9231; val_best_f1_score: 0.9259; train_kl_reg_loss: 52222.6441; train_edge_recon_loss: 26452976.2222; train_gene_expr_recon_loss: 255899.2326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10021144.0000; train_global_loss: 36782242.2222; train_optim_loss: 36782242.2222; val_kl_reg_loss: 51510.9766; val_edge_recon_loss: 26508074.0000; val_gene_expr_recon_loss: 255921.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10114224.0000; val_global_loss: 36929728.0000; val_optim_loss: 36929728.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9707; val_auprc_score: 0.9598; val_best_acc_score: 0.9271; val_best_f1_score: 0.9303; train_kl_reg_loss: 53285.8290; train_edge_recon_loss: 26421838.8889; train_gene_expr_recon_loss: 254988.0017; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10003394.8889; train_global_loss: 36733508.0000; train_optim_loss: 36733508.0000; val_kl_reg_loss: 53518.0234; val_edge_recon_loss: 26400896.0000; val_gene_expr_recon_loss: 255615.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10101294.0000; val_global_loss: 36811324.0000; val_optim_loss: 36811324.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9716; val_auprc_score: 0.9588; val_best_acc_score: 0.9298; val_best_f1_score: 0.9322; train_kl_reg_loss: 54084.0499; train_edge_recon_loss: 26349606.8889; train_gene_expr_recon_loss: 254584.9792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9960017.2222; train_global_loss: 36618292.8889; train_optim_loss: 36618292.8889; val_kl_reg_loss: 54727.8906; val_edge_recon_loss: 26657110.0000; val_gene_expr_recon_loss: 254564.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10077727.0000; val_global_loss: 37044128.0000; val_optim_loss: 37044128.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9742; val_auprc_score: 0.9624; val_best_acc_score: 0.9303; val_best_f1_score: 0.9328; train_kl_reg_loss: 55567.6645; train_edge_recon_loss: 26268898.4444; train_gene_expr_recon_loss: 251204.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9957979.2222; train_global_loss: 36533649.7778; train_optim_loss: 36533649.7778; val_kl_reg_loss: 53212.8711; val_edge_recon_loss: 26425418.0000; val_gene_expr_recon_loss: 250264.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10033825.0000; val_global_loss: 36762720.0000; val_optim_loss: 36762720.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9708; val_auprc_score: 0.9586; val_best_acc_score: 0.9302; val_best_f1_score: 0.9326; train_kl_reg_loss: 56590.2509; train_edge_recon_loss: 26449459.3333; train_gene_expr_recon_loss: 249971.0955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9927926.4444; train_global_loss: 36683947.5556; train_optim_loss: 36683947.5556; val_kl_reg_loss: 53072.2070; val_edge_recon_loss: 26554412.0000; val_gene_expr_recon_loss: 248289.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10022042.0000; val_global_loss: 36877816.0000; val_optim_loss: 36877816.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9704; val_auprc_score: 0.9582; val_best_acc_score: 0.9285; val_best_f1_score: 0.9305; train_kl_reg_loss: 57338.6753; train_edge_recon_loss: 26407768.2222; train_gene_expr_recon_loss: 248461.7378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9943827.4444; train_global_loss: 36657396.0000; train_optim_loss: 36657396.0000; val_kl_reg_loss: 52971.5156; val_edge_recon_loss: 26410366.0000; val_gene_expr_recon_loss: 251946.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10056267.0000; val_global_loss: 36771552.0000; val_optim_loss: 36771552.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9716; val_auprc_score: 0.9594; val_best_acc_score: 0.9307; val_best_f1_score: 0.9336; train_kl_reg_loss: 58533.9948; train_edge_recon_loss: 26445771.7778; train_gene_expr_recon_loss: 248264.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9913967.4444; train_global_loss: 36666537.3333; train_optim_loss: 36666537.3333; val_kl_reg_loss: 54158.5469; val_edge_recon_loss: 26473128.0000; val_gene_expr_recon_loss: 249867.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10003287.0000; val_global_loss: 36780440.0000; val_optim_loss: 36780440.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9694; val_auprc_score: 0.9553; val_best_acc_score: 0.9313; val_best_f1_score: 0.9336; train_kl_reg_loss: 58821.3003; train_edge_recon_loss: 26461034.6667; train_gene_expr_recon_loss: 246278.5868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9889715.1111; train_global_loss: 36655849.3333; train_optim_loss: 36655849.3333; val_kl_reg_loss: 51802.9727; val_edge_recon_loss: 26506978.0000; val_gene_expr_recon_loss: 247677.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10011239.0000; val_global_loss: 36817696.0000; val_optim_loss: 36817696.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9733; val_auprc_score: 0.9623; val_best_acc_score: 0.9309; val_best_f1_score: 0.9334; train_kl_reg_loss: 57642.0616; train_edge_recon_loss: 26250824.6667; train_gene_expr_recon_loss: 245874.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9840979.4444; train_global_loss: 36395320.8889; train_optim_loss: 36395320.8889; val_kl_reg_loss: 52284.1172; val_edge_recon_loss: 26377952.0000; val_gene_expr_recon_loss: 246344.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9978115.0000; val_global_loss: 36654696.0000; val_optim_loss: 36654696.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9750; val_auprc_score: 0.9655; val_best_acc_score: 0.9353; val_best_f1_score: 0.9372; train_kl_reg_loss: 58234.1827; train_edge_recon_loss: 26278112.8889; train_gene_expr_recon_loss: 243859.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9872586.8889; train_global_loss: 36452793.3333; train_optim_loss: 36452793.3333; val_kl_reg_loss: 51883.4062; val_edge_recon_loss: 26167300.0000; val_gene_expr_recon_loss: 247164.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9987410.0000; val_global_loss: 36453760.0000; val_optim_loss: 36453760.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9749; val_auprc_score: 0.9649; val_best_acc_score: 0.9367; val_best_f1_score: 0.9391; train_kl_reg_loss: 58403.8967; train_edge_recon_loss: 26325869.7778; train_gene_expr_recon_loss: 243982.3698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9857172.6667; train_global_loss: 36485428.4444; train_optim_loss: 36485428.4444; val_kl_reg_loss: 52177.0781; val_edge_recon_loss: 26246962.0000; val_gene_expr_recon_loss: 246232.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9979853.0000; val_global_loss: 36525224.0000; val_optim_loss: 36525224.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9726; val_auprc_score: 0.9585; val_best_acc_score: 0.9349; val_best_f1_score: 0.9375; train_kl_reg_loss: 59289.6927; train_edge_recon_loss: 26390339.5556; train_gene_expr_recon_loss: 246103.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9897742.5556; train_global_loss: 36593475.5556; train_optim_loss: 36593475.5556; val_kl_reg_loss: 52556.6875; val_edge_recon_loss: 26271120.0000; val_gene_expr_recon_loss: 247020.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9992139.0000; val_global_loss: 36562836.0000; val_optim_loss: 36562836.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9738; val_auprc_score: 0.9621; val_best_acc_score: 0.9340; val_best_f1_score: 0.9360; train_kl_reg_loss: 58940.1094; train_edge_recon_loss: 26340191.7778; train_gene_expr_recon_loss: 245707.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9886415.5556; train_global_loss: 36531256.4444; train_optim_loss: 36531256.4444; val_kl_reg_loss: 51970.1836; val_edge_recon_loss: 26275584.0000; val_gene_expr_recon_loss: 246423.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9977367.0000; val_global_loss: 36551344.0000; val_optim_loss: 36551344.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9765; val_auprc_score: 0.9696; val_best_acc_score: 0.9333; val_best_f1_score: 0.9354; train_kl_reg_loss: 59204.4627; train_edge_recon_loss: 26285381.7778; train_gene_expr_recon_loss: 245497.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9909455.0000; train_global_loss: 36499537.7778; train_optim_loss: 36499537.7778; val_kl_reg_loss: 52317.0352; val_edge_recon_loss: 26425254.0000; val_gene_expr_recon_loss: 246710.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9996827.0000; val_global_loss: 36721108.0000; val_optim_loss: 36721108.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9715; val_auprc_score: 0.9612; val_best_acc_score: 0.9312; val_best_f1_score: 0.9335; train_kl_reg_loss: 59218.1285; train_edge_recon_loss: 26314311.1111; train_gene_expr_recon_loss: 244792.6701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9889708.5556; train_global_loss: 36508030.2222; train_optim_loss: 36508030.2222; val_kl_reg_loss: 52118.9141; val_edge_recon_loss: 26467476.0000; val_gene_expr_recon_loss: 246385.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9982039.0000; val_global_loss: 36748020.0000; val_optim_loss: 36748020.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9779; val_auprc_score: 0.9701; val_best_acc_score: 0.9365; val_best_f1_score: 0.9389; train_kl_reg_loss: 58954.6189; train_edge_recon_loss: 26269600.2222; train_gene_expr_recon_loss: 244333.3542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9838627.0000; train_global_loss: 36411515.1111; train_optim_loss: 36411515.1111; val_kl_reg_loss: 52583.7812; val_edge_recon_loss: 26210252.0000; val_gene_expr_recon_loss: 246679.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9994435.0000; val_global_loss: 36503952.0000; val_optim_loss: 36503952.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9711; val_auprc_score: 0.9594; val_best_acc_score: 0.9307; val_best_f1_score: 0.9336; train_kl_reg_loss: 58997.4067; train_edge_recon_loss: 26454736.6667; train_gene_expr_recon_loss: 243900.0035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9886504.6667; train_global_loss: 36644138.6667; train_optim_loss: 36644138.6667; val_kl_reg_loss: 52405.8125; val_edge_recon_loss: 26463762.0000; val_gene_expr_recon_loss: 246510.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9983906.0000; val_global_loss: 36746584.0000; val_optim_loss: 36746584.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9711; val_auprc_score: 0.9600; val_best_acc_score: 0.9294; val_best_f1_score: 0.9319; train_kl_reg_loss: 58807.5069; train_edge_recon_loss: 26341148.6667; train_gene_expr_recon_loss: 246011.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9880231.7778; train_global_loss: 36526199.1111; train_optim_loss: 36526199.1111; val_kl_reg_loss: 52605.5938; val_edge_recon_loss: 26678836.0000; val_gene_expr_recon_loss: 246288.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9983475.0000; val_global_loss: 36961204.0000; val_optim_loss: 36961204.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 5 min 50 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9737
Val AUPRC score: 0.9615
Val best accuracy score: 0.9351
Val best F1 score: 0.9376
Val gene expr MSE score: 0.6058
Val chrom access MSE score: 0.0901
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
