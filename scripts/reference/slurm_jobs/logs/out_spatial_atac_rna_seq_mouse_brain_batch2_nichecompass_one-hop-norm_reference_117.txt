[True]
Run timestamp: 07082023_210631_117.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_117']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8832; val_auprc_score: 0.9022; val_best_acc_score: 0.5053; val_best_f1_score: 0.6687; train_kl_reg_loss: 39964.4994; train_edge_recon_loss: 3478743.3889; train_gene_expr_recon_loss: 1245798.5556; train_masked_gp_l1_reg_loss: 16693.2905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167217.0538; train_chrom_access_recon_loss: 2323561.2083; train_global_loss: 7271978.0000; train_optim_loss: 7271978.0000; val_kl_reg_loss: 22410.5508; val_edge_recon_loss: 4065178.7500; val_gene_expr_recon_loss: 1114576.0000; val_masked_gp_l1_reg_loss: 12691.2402; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162677.7500; val_chrom_access_recon_loss: 1828088.6250; val_global_loss: 7205622.5000; val_optim_loss: 7205622.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8726; val_auprc_score: 0.8943; val_best_acc_score: 0.5119; val_best_f1_score: 0.6712; train_kl_reg_loss: 16799.9607; train_edge_recon_loss: 3478994.7222; train_gene_expr_recon_loss: 983225.3819; train_masked_gp_l1_reg_loss: 11106.5820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159916.3542; train_chrom_access_recon_loss: 1525960.3889; train_global_loss: 6176003.5000; train_optim_loss: 6176003.5000; val_kl_reg_loss: 14164.5967; val_edge_recon_loss: 4064699.0000; val_gene_expr_recon_loss: 908459.6250; val_masked_gp_l1_reg_loss: 9822.9629; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156518.4688; val_chrom_access_recon_loss: 1458958.2500; val_global_loss: 6612623.0000; val_optim_loss: 6612623.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8683; val_auprc_score: 0.8881; val_best_acc_score: 0.5133; val_best_f1_score: 0.6715; train_kl_reg_loss: 16649.3122; train_edge_recon_loss: 3479260.4167; train_gene_expr_recon_loss: 861107.0556; train_masked_gp_l1_reg_loss: 9688.6402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153636.5122; train_chrom_access_recon_loss: 1404263.6111; train_global_loss: 5924605.5556; train_optim_loss: 5924605.5556; val_kl_reg_loss: 19578.1836; val_edge_recon_loss: 4064727.7500; val_gene_expr_recon_loss: 835127.1250; val_masked_gp_l1_reg_loss: 9549.1318; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149814.1562; val_chrom_access_recon_loss: 1416017.8750; val_global_loss: 6494814.0000; val_optim_loss: 6494814.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8668; val_auprc_score: 0.8881; val_best_acc_score: 0.5217; val_best_f1_score: 0.6747; train_kl_reg_loss: 18891.1641; train_edge_recon_loss: 3481455.4722; train_gene_expr_recon_loss: 811899.7986; train_masked_gp_l1_reg_loss: 9322.4205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146386.2344; train_chrom_access_recon_loss: 1381269.8056; train_global_loss: 5849224.8333; train_optim_loss: 5849224.8333; val_kl_reg_loss: 17351.7852; val_edge_recon_loss: 4063590.2500; val_gene_expr_recon_loss: 808530.7500; val_masked_gp_l1_reg_loss: 9082.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141902.3750; val_chrom_access_recon_loss: 1394776.7500; val_global_loss: 6435235.0000; val_optim_loss: 6435235.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8976; val_auprc_score: 0.9047; val_best_acc_score: 0.5302; val_best_f1_score: 0.6782; train_kl_reg_loss: 18362.5080; train_edge_recon_loss: 3480771.0556; train_gene_expr_recon_loss: 782542.7222; train_masked_gp_l1_reg_loss: 8989.3810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138137.0990; train_chrom_access_recon_loss: 1359860.3333; train_global_loss: 5788663.1111; train_optim_loss: 5788663.1111; val_kl_reg_loss: 21590.7383; val_edge_recon_loss: 4062326.2500; val_gene_expr_recon_loss: 783920.7500; val_masked_gp_l1_reg_loss: 8877.3379; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133394.1250; val_chrom_access_recon_loss: 1382322.7500; val_global_loss: 6392432.0000; val_optim_loss: 6392432.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8959; val_auprc_score: 0.8943; val_best_acc_score: 0.6087; val_best_f1_score: 0.7147; train_kl_reg_loss: 20984.0929; train_edge_recon_loss: 3481806.5833; train_gene_expr_recon_loss: 761966.9722; train_masked_gp_l1_reg_loss: 8816.9620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129561.0938; train_chrom_access_recon_loss: 1344456.7500; train_global_loss: 5747592.5000; train_optim_loss: 5747592.5000; val_kl_reg_loss: 22015.3418; val_edge_recon_loss: 4058287.5000; val_gene_expr_recon_loss: 763751.0625; val_masked_gp_l1_reg_loss: 8744.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124768.2734; val_chrom_access_recon_loss: 1373256.8750; val_global_loss: 6350824.0000; val_optim_loss: 6350824.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8776; val_auprc_score: 0.8673; val_best_acc_score: 0.7586; val_best_f1_score: 0.7973; train_kl_reg_loss: 21792.1133; train_edge_recon_loss: 3480807.1667; train_gene_expr_recon_loss: 746728.1458; train_masked_gp_l1_reg_loss: 8707.5585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120960.0104; train_chrom_access_recon_loss: 1346120.4861; train_global_loss: 5725115.4444; train_optim_loss: 5725115.4444; val_kl_reg_loss: 19371.7070; val_edge_recon_loss: 4044342.7500; val_gene_expr_recon_loss: 748170.6250; val_masked_gp_l1_reg_loss: 8665.8037; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116238.1172; val_chrom_access_recon_loss: 1365739.8750; val_global_loss: 6302529.0000; val_optim_loss: 6302529.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8608; val_auprc_score: 0.8469; val_best_acc_score: 0.7812; val_best_f1_score: 0.7959; train_kl_reg_loss: 21093.4625; train_edge_recon_loss: 3479306.0278; train_gene_expr_recon_loss: 729241.4444; train_masked_gp_l1_reg_loss: 8660.9886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112564.7274; train_chrom_access_recon_loss: 1337465.4861; train_global_loss: 5688332.1667; train_optim_loss: 5688332.1667; val_kl_reg_loss: 21679.2539; val_edge_recon_loss: 4015554.7500; val_gene_expr_recon_loss: 735285.2500; val_masked_gp_l1_reg_loss: 8644.9961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108045.5469; val_chrom_access_recon_loss: 1360424.8750; val_global_loss: 6249634.5000; val_optim_loss: 6249634.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8642; val_auprc_score: 0.8490; val_best_acc_score: 0.7657; val_best_f1_score: 0.7974; train_kl_reg_loss: 20385.0653; train_edge_recon_loss: 3472587.8333; train_gene_expr_recon_loss: 721437.7917; train_masked_gp_l1_reg_loss: 8647.3475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104572.3359; train_chrom_access_recon_loss: 1334884.8889; train_global_loss: 5662515.3333; train_optim_loss: 5662515.3333; val_kl_reg_loss: 18155.9297; val_edge_recon_loss: 3897274.5000; val_gene_expr_recon_loss: 729260.2500; val_masked_gp_l1_reg_loss: 8645.9590; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100334.2969; val_chrom_access_recon_loss: 1356036.8750; val_global_loss: 6109708.5000; val_optim_loss: 6109708.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8623; val_auprc_score: 0.8461; val_best_acc_score: 0.7719; val_best_f1_score: 0.7974; train_kl_reg_loss: 15553.4891; train_edge_recon_loss: 3430554.9167; train_gene_expr_recon_loss: 719538.8750; train_masked_gp_l1_reg_loss: 8663.5175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97128.5026; train_chrom_access_recon_loss: 1332114.7639; train_global_loss: 5603554.1111; train_optim_loss: 5603554.1111; val_kl_reg_loss: 9725.6143; val_edge_recon_loss: 3393088.0000; val_gene_expr_recon_loss: 739382.8750; val_masked_gp_l1_reg_loss: 8694.1465; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93243.9219; val_chrom_access_recon_loss: 1357654.7500; val_global_loss: 5601789.0000; val_optim_loss: 5601789.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8620; val_auprc_score: 0.8454; val_best_acc_score: 0.7668; val_best_f1_score: 0.7915; train_kl_reg_loss: 10321.1335; train_edge_recon_loss: 3122055.6944; train_gene_expr_recon_loss: 750281.6667; train_masked_gp_l1_reg_loss: 8761.9018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90403.2378; train_chrom_access_recon_loss: 1336581.3056; train_global_loss: 5318405.0000; train_optim_loss: 5318405.0000; val_kl_reg_loss: 17327.8457; val_edge_recon_loss: 2931501.2500; val_gene_expr_recon_loss: 783499.5000; val_masked_gp_l1_reg_loss: 8836.0801; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87030.6094; val_chrom_access_recon_loss: 1372603.0000; val_global_loss: 5200798.0000; val_optim_loss: 5200798.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8865; val_auprc_score: 0.8638; val_best_acc_score: 0.8021; val_best_f1_score: 0.8204; train_kl_reg_loss: 27066.6107; train_edge_recon_loss: 2857776.8611; train_gene_expr_recon_loss: 753094.9444; train_masked_gp_l1_reg_loss: 8885.5599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84557.8741; train_chrom_access_recon_loss: 1338711.7222; train_global_loss: 5070093.5000; train_optim_loss: 5070093.5000; val_kl_reg_loss: 40144.2148; val_edge_recon_loss: 2817894.0000; val_gene_expr_recon_loss: 749169.7500; val_masked_gp_l1_reg_loss: 8935.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81549.6484; val_chrom_access_recon_loss: 1358349.5000; val_global_loss: 5056042.0000; val_optim_loss: 5056042.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9100; val_auprc_score: 0.8854; val_best_acc_score: 0.8407; val_best_f1_score: 0.8521; train_kl_reg_loss: 45663.7830; train_edge_recon_loss: 2792916.5000; train_gene_expr_recon_loss: 734879.9375; train_masked_gp_l1_reg_loss: 8952.3407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79255.4071; train_chrom_access_recon_loss: 1331124.5833; train_global_loss: 4992792.5000; train_optim_loss: 4992792.5000; val_kl_reg_loss: 49499.5508; val_edge_recon_loss: 2781285.2500; val_gene_expr_recon_loss: 743210.6875; val_masked_gp_l1_reg_loss: 8977.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76459.0312; val_chrom_access_recon_loss: 1354001.2500; val_global_loss: 5013433.0000; val_optim_loss: 5013433.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9274; val_auprc_score: 0.9072; val_best_acc_score: 0.8630; val_best_f1_score: 0.8712; train_kl_reg_loss: 47289.0269; train_edge_recon_loss: 2754969.3333; train_gene_expr_recon_loss: 727301.2639; train_masked_gp_l1_reg_loss: 8992.0811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74350.4913; train_chrom_access_recon_loss: 1321474.0278; train_global_loss: 4934376.2778; train_optim_loss: 4934376.2778; val_kl_reg_loss: 47108.5664; val_edge_recon_loss: 2758068.7500; val_gene_expr_recon_loss: 740652.2500; val_masked_gp_l1_reg_loss: 9001.7861; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71777.3906; val_chrom_access_recon_loss: 1350537.1250; val_global_loss: 4977146.0000; val_optim_loss: 4977146.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9325; val_auprc_score: 0.9125; val_best_acc_score: 0.8740; val_best_f1_score: 0.8811; train_kl_reg_loss: 46361.3772; train_edge_recon_loss: 2734706.7500; train_gene_expr_recon_loss: 727417.5833; train_masked_gp_l1_reg_loss: 9004.4393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69842.6658; train_chrom_access_recon_loss: 1326911.5000; train_global_loss: 4914244.3889; train_optim_loss: 4914244.3889; val_kl_reg_loss: 49451.3984; val_edge_recon_loss: 2735825.7500; val_gene_expr_recon_loss: 733530.2500; val_masked_gp_l1_reg_loss: 9001.2881; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67498.7578; val_chrom_access_recon_loss: 1346233.2500; val_global_loss: 4941541.0000; val_optim_loss: 4941541.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9359; val_auprc_score: 0.9149; val_best_acc_score: 0.8775; val_best_f1_score: 0.8839; train_kl_reg_loss: 48441.0091; train_edge_recon_loss: 2738345.8056; train_gene_expr_recon_loss: 718297.3264; train_masked_gp_l1_reg_loss: 9007.1684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65753.2391; train_chrom_access_recon_loss: 1318923.7778; train_global_loss: 4898768.2222; train_optim_loss: 4898768.2222; val_kl_reg_loss: 46943.5742; val_edge_recon_loss: 2739752.0000; val_gene_expr_recon_loss: 728146.8125; val_masked_gp_l1_reg_loss: 9017.4033; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63624.5391; val_chrom_access_recon_loss: 1343228.8750; val_global_loss: 4930713.0000; val_optim_loss: 4930713.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9422; val_auprc_score: 0.9211; val_best_acc_score: 0.8849; val_best_f1_score: 0.8910; train_kl_reg_loss: 46632.4245; train_edge_recon_loss: 2722756.1667; train_gene_expr_recon_loss: 719108.5417; train_masked_gp_l1_reg_loss: 9015.9870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62033.9514; train_chrom_access_recon_loss: 1322290.5278; train_global_loss: 4881837.5556; train_optim_loss: 4881837.5556; val_kl_reg_loss: 43757.9414; val_edge_recon_loss: 2712161.5000; val_gene_expr_recon_loss: 724025.2500; val_masked_gp_l1_reg_loss: 9011.8691; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60104.1367; val_chrom_access_recon_loss: 1340959.1250; val_global_loss: 4890020.0000; val_optim_loss: 4890020.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9354; val_auprc_score: 0.9128; val_best_acc_score: 0.8791; val_best_f1_score: 0.8865; train_kl_reg_loss: 44741.1224; train_edge_recon_loss: 2744200.1667; train_gene_expr_recon_loss: 711891.3611; train_masked_gp_l1_reg_loss: 9022.5408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58661.4766; train_chrom_access_recon_loss: 1318137.3333; train_global_loss: 4886654.0556; train_optim_loss: 4886654.0556; val_kl_reg_loss: 44924.4062; val_edge_recon_loss: 2752640.5000; val_gene_expr_recon_loss: 723921.5625; val_masked_gp_l1_reg_loss: 9026.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56896.5234; val_chrom_access_recon_loss: 1338023.6250; val_global_loss: 4925433.0000; val_optim_loss: 4925433.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9434; val_auprc_score: 0.9267; val_best_acc_score: 0.8841; val_best_f1_score: 0.8915; train_kl_reg_loss: 43927.5503; train_edge_recon_loss: 2715755.0000; train_gene_expr_recon_loss: 707414.8819; train_masked_gp_l1_reg_loss: 9039.2595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55564.8676; train_chrom_access_recon_loss: 1315405.5694; train_global_loss: 4847107.0000; train_optim_loss: 4847107.0000; val_kl_reg_loss: 42730.1875; val_edge_recon_loss: 2748705.2500; val_gene_expr_recon_loss: 717907.8750; val_masked_gp_l1_reg_loss: 9052.9277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53944.0469; val_chrom_access_recon_loss: 1335584.8750; val_global_loss: 4907925.5000; val_optim_loss: 4907925.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9473; val_auprc_score: 0.9311; val_best_acc_score: 0.8871; val_best_f1_score: 0.8937; train_kl_reg_loss: 43669.5365; train_edge_recon_loss: 2724337.3889; train_gene_expr_recon_loss: 707392.6875; train_masked_gp_l1_reg_loss: 9067.3393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52727.1311; train_chrom_access_recon_loss: 1314787.5694; train_global_loss: 4851981.5000; train_optim_loss: 4851981.5000; val_kl_reg_loss: 43713.0156; val_edge_recon_loss: 2709880.0000; val_gene_expr_recon_loss: 717842.1250; val_masked_gp_l1_reg_loss: 9083.6885; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51240.0859; val_chrom_access_recon_loss: 1333367.8750; val_global_loss: 4865126.5000; val_optim_loss: 4865126.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9477; val_auprc_score: 0.9300; val_best_acc_score: 0.8922; val_best_f1_score: 0.8983; train_kl_reg_loss: 43441.2049; train_edge_recon_loss: 2716014.8611; train_gene_expr_recon_loss: 705623.1667; train_masked_gp_l1_reg_loss: 9100.0399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50121.7448; train_chrom_access_recon_loss: 1307859.3472; train_global_loss: 4832160.3889; train_optim_loss: 4832160.3889; val_kl_reg_loss: 41978.1172; val_edge_recon_loss: 2739084.2500; val_gene_expr_recon_loss: 714135.5000; val_masked_gp_l1_reg_loss: 9122.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48752.0078; val_chrom_access_recon_loss: 1330571.6250; val_global_loss: 4883644.0000; val_optim_loss: 4883644.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9461; val_auprc_score: 0.9259; val_best_acc_score: 0.8930; val_best_f1_score: 0.8987; train_kl_reg_loss: 42696.0516; train_edge_recon_loss: 2701764.8056; train_gene_expr_recon_loss: 706986.1042; train_masked_gp_l1_reg_loss: 9144.4801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47724.6050; train_chrom_access_recon_loss: 1312541.5417; train_global_loss: 4820857.6111; train_optim_loss: 4820857.6111; val_kl_reg_loss: 42209.2266; val_edge_recon_loss: 2728237.0000; val_gene_expr_recon_loss: 711911.0000; val_masked_gp_l1_reg_loss: 9176.0684; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46455.2344; val_chrom_access_recon_loss: 1328763.2500; val_global_loss: 4866752.0000; val_optim_loss: 4866752.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9523; val_auprc_score: 0.9356; val_best_acc_score: 0.8994; val_best_f1_score: 0.9050; train_kl_reg_loss: 43853.5838; train_edge_recon_loss: 2714053.3333; train_gene_expr_recon_loss: 700594.8889; train_masked_gp_l1_reg_loss: 9196.3380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45503.0530; train_chrom_access_recon_loss: 1304355.4861; train_global_loss: 4817556.7222; train_optim_loss: 4817556.7222; val_kl_reg_loss: 42029.2656; val_edge_recon_loss: 2740425.7500; val_gene_expr_recon_loss: 709478.7500; val_masked_gp_l1_reg_loss: 9213.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44325.4883; val_chrom_access_recon_loss: 1325960.7500; val_global_loss: 4871433.0000; val_optim_loss: 4871433.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9521; val_auprc_score: 0.9329; val_best_acc_score: 0.9006; val_best_f1_score: 0.9064; train_kl_reg_loss: 42050.7161; train_edge_recon_loss: 2716327.4444; train_gene_expr_recon_loss: 699815.8611; train_masked_gp_l1_reg_loss: 9238.2626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43439.8759; train_chrom_access_recon_loss: 1304743.6389; train_global_loss: 4815615.8333; train_optim_loss: 4815615.8333; val_kl_reg_loss: 40688.3516; val_edge_recon_loss: 2720484.5000; val_gene_expr_recon_loss: 708109.0000; val_masked_gp_l1_reg_loss: 9256.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42349.0430; val_chrom_access_recon_loss: 1324312.0000; val_global_loss: 4845199.5000; val_optim_loss: 4845199.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9530; val_auprc_score: 0.9334; val_best_acc_score: 0.8992; val_best_f1_score: 0.9050; train_kl_reg_loss: 42050.9414; train_edge_recon_loss: 2716378.3056; train_gene_expr_recon_loss: 694679.6389; train_masked_gp_l1_reg_loss: 9277.7031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41528.5247; train_chrom_access_recon_loss: 1302313.6389; train_global_loss: 4806228.7778; train_optim_loss: 4806228.7778; val_kl_reg_loss: 41839.3555; val_edge_recon_loss: 2736959.7500; val_gene_expr_recon_loss: 705685.3750; val_masked_gp_l1_reg_loss: 9300.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40506.8008; val_chrom_access_recon_loss: 1322118.7500; val_global_loss: 4856410.5000; val_optim_loss: 4856410.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9543; val_auprc_score: 0.9390; val_best_acc_score: 0.9026; val_best_f1_score: 0.9080; train_kl_reg_loss: 40142.7895; train_edge_recon_loss: 2709520.2500; train_gene_expr_recon_loss: 1047900.9167; train_masked_gp_l1_reg_loss: 9368.6314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39473.0885; train_chrom_access_recon_loss: 1373287.4861; train_global_loss: 5219693.1667; train_optim_loss: 5219693.1667; val_kl_reg_loss: 22512.5059; val_edge_recon_loss: 2734952.7500; val_gene_expr_recon_loss: 1059404.0000; val_masked_gp_l1_reg_loss: 9444.8027; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38061.0703; val_chrom_access_recon_loss: 1393955.3750; val_global_loss: 5258330.5000; val_optim_loss: 5258330.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9598; val_auprc_score: 0.9457; val_best_acc_score: 0.9097; val_best_f1_score: 0.9142; train_kl_reg_loss: 35206.1484; train_edge_recon_loss: 2694465.2778; train_gene_expr_recon_loss: 1040756.7917; train_masked_gp_l1_reg_loss: 9525.1580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36869.2092; train_chrom_access_recon_loss: 1365332.3333; train_global_loss: 5182155.0000; train_optim_loss: 5182155.0000; val_kl_reg_loss: 21826.8281; val_edge_recon_loss: 2705527.0000; val_gene_expr_recon_loss: 1057824.7500; val_masked_gp_l1_reg_loss: 9613.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35397.7695; val_chrom_access_recon_loss: 1392719.3750; val_global_loss: 5222909.0000; val_optim_loss: 5222909.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9607; val_auprc_score: 0.9427; val_best_acc_score: 0.9092; val_best_f1_score: 0.9129; train_kl_reg_loss: 34417.1662; train_edge_recon_loss: 2696631.4444; train_gene_expr_recon_loss: 1039373.7292; train_masked_gp_l1_reg_loss: 9696.7909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34281.2131; train_chrom_access_recon_loss: 1368287.7500; train_global_loss: 5182688.0000; train_optim_loss: 5182688.0000; val_kl_reg_loss: 22690.5840; val_edge_recon_loss: 2705159.5000; val_gene_expr_recon_loss: 1056200.7500; val_masked_gp_l1_reg_loss: 9801.5098; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32929.8359; val_chrom_access_recon_loss: 1391722.1250; val_global_loss: 5218504.0000; val_optim_loss: 5218504.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9648; val_auprc_score: 0.9530; val_best_acc_score: 0.9154; val_best_f1_score: 0.9193; train_kl_reg_loss: 34259.0690; train_edge_recon_loss: 2687155.0000; train_gene_expr_recon_loss: 1042838.0972; train_masked_gp_l1_reg_loss: 9743.0587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32740.9295; train_chrom_access_recon_loss: 1372631.9722; train_global_loss: 5179368.2222; train_optim_loss: 5179368.2222; val_kl_reg_loss: 22303.0254; val_edge_recon_loss: 2669812.5000; val_gene_expr_recon_loss: 1056149.2500; val_masked_gp_l1_reg_loss: 9688.4697; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32526.3203; val_chrom_access_recon_loss: 1391665.1250; val_global_loss: 5182144.5000; val_optim_loss: 5182144.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9616; val_auprc_score: 0.9456; val_best_acc_score: 0.9158; val_best_f1_score: 0.9196; train_kl_reg_loss: 33353.4023; train_edge_recon_loss: 2691294.3056; train_gene_expr_recon_loss: 1033106.7500; train_masked_gp_l1_reg_loss: 9679.0053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32386.4976; train_chrom_access_recon_loss: 1361730.2778; train_global_loss: 5161550.1111; train_optim_loss: 5161550.1111; val_kl_reg_loss: 21654.2305; val_edge_recon_loss: 2677872.2500; val_gene_expr_recon_loss: 1056424.0000; val_masked_gp_l1_reg_loss: 9662.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32208.9258; val_chrom_access_recon_loss: 1391982.7500; val_global_loss: 5189805.0000; val_optim_loss: 5189805.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9630; val_auprc_score: 0.9492; val_best_acc_score: 0.9127; val_best_f1_score: 0.9169; train_kl_reg_loss: 32306.7711; train_edge_recon_loss: 2686967.0000; train_gene_expr_recon_loss: 1035210.3958; train_masked_gp_l1_reg_loss: 9657.7643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32078.5642; train_chrom_access_recon_loss: 1361475.2083; train_global_loss: 5157695.6667; train_optim_loss: 5157695.6667; val_kl_reg_loss: 21085.6133; val_edge_recon_loss: 2701499.7500; val_gene_expr_recon_loss: 1056142.8750; val_masked_gp_l1_reg_loss: 9652.9795; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31919.0859; val_chrom_access_recon_loss: 1392066.1250; val_global_loss: 5212366.0000; val_optim_loss: 5212366.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9604; val_auprc_score: 0.9421; val_best_acc_score: 0.9064; val_best_f1_score: 0.9113; train_kl_reg_loss: 31877.8535; train_edge_recon_loss: 2676891.9722; train_gene_expr_recon_loss: 1033371.0347; train_masked_gp_l1_reg_loss: 9653.7485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31799.1048; train_chrom_access_recon_loss: 1361075.8194; train_global_loss: 5144669.6111; train_optim_loss: 5144669.6111; val_kl_reg_loss: 21064.9355; val_edge_recon_loss: 2707073.7500; val_gene_expr_recon_loss: 1057009.0000; val_masked_gp_l1_reg_loss: 9656.0244; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31656.0645; val_chrom_access_recon_loss: 1392322.1250; val_global_loss: 5218782.0000; val_optim_loss: 5218782.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 23 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9558
val AUPRC score: 0.9421
val best accuracy score: 0.8989
val best F1 score: 0.9048
val target rna MSE score: 4.1274
val source rna MSE score: 3.3864
val target atac MSE score: 0.1403
val source atac MSE score: 0.0221
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
