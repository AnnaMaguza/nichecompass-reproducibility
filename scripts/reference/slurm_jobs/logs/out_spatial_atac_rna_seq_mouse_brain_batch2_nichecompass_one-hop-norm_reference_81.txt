[True]
Run timestamp: 26072023_024121_81.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_81']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9034; val_auprc_score: 0.9156; val_best_acc_score: 0.5007; val_best_f1_score: 0.6670; train_kl_reg_loss: 12548.5220; train_edge_recon_loss: 3482028.4167; train_gene_expr_recon_loss: 3181450.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10874037.8889; train_global_loss: 17550065.5556; train_optim_loss: 17550065.5556; val_kl_reg_loss: 22696.2656; val_edge_recon_loss: 4065336.2500; val_gene_expr_recon_loss: 3046590.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10839898.0000; val_global_loss: 17974520.0000; val_optim_loss: 17974520.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8990; val_auprc_score: 0.9111; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 31524.7533; train_edge_recon_loss: 3507522.1944; train_gene_expr_recon_loss: 2942629.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10679050.1111; train_global_loss: 17160726.3333; train_optim_loss: 17160726.3333; val_kl_reg_loss: 53773.0000; val_edge_recon_loss: 4065392.0000; val_gene_expr_recon_loss: 2825992.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10651344.0000; val_global_loss: 17596500.0000; val_optim_loss: 17596500.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8951; val_auprc_score: 0.9019; val_best_acc_score: 0.5054; val_best_f1_score: 0.6690; train_kl_reg_loss: 57395.5942; train_edge_recon_loss: 3526612.3333; train_gene_expr_recon_loss: 2712583.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10440125.1111; train_global_loss: 16736716.8889; train_optim_loss: 16736716.8889; val_kl_reg_loss: 67533.6484; val_edge_recon_loss: 4065221.2500; val_gene_expr_recon_loss: 2618734.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10433632.0000; val_global_loss: 17185120.0000; val_optim_loss: 17185120.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9057; val_auprc_score: 0.9103; val_best_acc_score: 0.5101; val_best_f1_score: 0.6711; train_kl_reg_loss: 74180.9844; train_edge_recon_loss: 3533645.1389; train_gene_expr_recon_loss: 2532021.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10226110.5556; train_global_loss: 16365957.4444; train_optim_loss: 16365957.4444; val_kl_reg_loss: 80987.1406; val_edge_recon_loss: 4064776.5000; val_gene_expr_recon_loss: 2466910.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10257628.0000; val_global_loss: 16870302.0000; val_optim_loss: 16870302.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9180; val_auprc_score: 0.9184; val_best_acc_score: 0.5146; val_best_f1_score: 0.6729; train_kl_reg_loss: 89594.3377; train_edge_recon_loss: 3535234.0000; train_gene_expr_recon_loss: 2396301.9444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10060188.5556; train_global_loss: 16081318.8889; train_optim_loss: 16081318.8889; val_kl_reg_loss: 81625.2109; val_edge_recon_loss: 4064077.7500; val_gene_expr_recon_loss: 2368835.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10160826.0000; val_global_loss: 16675364.0000; val_optim_loss: 16675364.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9019; val_auprc_score: 0.8969; val_best_acc_score: 0.5238; val_best_f1_score: 0.6766; train_kl_reg_loss: 100163.1432; train_edge_recon_loss: 3541266.7222; train_gene_expr_recon_loss: 2305939.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9972508.4444; train_global_loss: 15919878.1111; train_optim_loss: 15919878.1111; val_kl_reg_loss: 88269.4375; val_edge_recon_loss: 4063493.5000; val_gene_expr_recon_loss: 2294976.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10059404.0000; val_global_loss: 16506143.0000; val_optim_loss: 16506143.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9065; val_auprc_score: 0.9043; val_best_acc_score: 0.5424; val_best_f1_score: 0.6849; train_kl_reg_loss: 110504.9002; train_edge_recon_loss: 3541838.7778; train_gene_expr_recon_loss: 2257135.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9902699.2222; train_global_loss: 15812178.1111; train_optim_loss: 15812178.1111; val_kl_reg_loss: 76851.8438; val_edge_recon_loss: 4062231.5000; val_gene_expr_recon_loss: 2252871.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10008747.0000; val_global_loss: 16400702.0000; val_optim_loss: 16400702.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9082; val_auprc_score: 0.9057; val_best_acc_score: 0.5709; val_best_f1_score: 0.6982; train_kl_reg_loss: 111262.9601; train_edge_recon_loss: 3545290.9444; train_gene_expr_recon_loss: 2207637.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9892728.2222; train_global_loss: 15756919.6667; train_optim_loss: 15756919.6667; val_kl_reg_loss: 93300.2031; val_edge_recon_loss: 4060828.7500; val_gene_expr_recon_loss: 2214380.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9951682.0000; val_global_loss: 16320191.0000; val_optim_loss: 16320191.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9049; val_auprc_score: 0.8980; val_best_acc_score: 0.6241; val_best_f1_score: 0.7244; train_kl_reg_loss: 108479.6224; train_edge_recon_loss: 3545914.6389; train_gene_expr_recon_loss: 2188961.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9816662.7778; train_global_loss: 15660018.2222; train_optim_loss: 15660018.2222; val_kl_reg_loss: 103532.0156; val_edge_recon_loss: 4058561.0000; val_gene_expr_recon_loss: 2191112.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9938155.0000; val_global_loss: 16291360.0000; val_optim_loss: 16291360.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9075; val_auprc_score: 0.9027; val_best_acc_score: 0.6925; val_best_f1_score: 0.7608; train_kl_reg_loss: 113491.1345; train_edge_recon_loss: 3537558.4444; train_gene_expr_recon_loss: 2171128.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9827898.7778; train_global_loss: 15650076.8889; train_optim_loss: 15650076.8889; val_kl_reg_loss: 84961.6719; val_edge_recon_loss: 4054884.2500; val_gene_expr_recon_loss: 2177341.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9912160.0000; val_global_loss: 16229347.0000; val_optim_loss: 16229347.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9106; val_auprc_score: 0.9047; val_best_acc_score: 0.7590; val_best_f1_score: 0.7994; train_kl_reg_loss: 111555.5095; train_edge_recon_loss: 3537525.0000; train_gene_expr_recon_loss: 2137275.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9774541.4444; train_global_loss: 15560897.3333; train_optim_loss: 15560897.3333; val_kl_reg_loss: 79971.6484; val_edge_recon_loss: 4049736.2500; val_gene_expr_recon_loss: 2165216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9883850.0000; val_global_loss: 16178774.0000; val_optim_loss: 16178774.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9110; val_auprc_score: 0.9009; val_best_acc_score: 0.8120; val_best_f1_score: 0.8321; train_kl_reg_loss: 108522.0391; train_edge_recon_loss: 3535326.2778; train_gene_expr_recon_loss: 2135767.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9715134.8889; train_global_loss: 15494750.7778; train_optim_loss: 15494750.7778; val_kl_reg_loss: 90930.0781; val_edge_recon_loss: 4040900.7500; val_gene_expr_recon_loss: 2153560.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9874066.0000; val_global_loss: 16159457.0000; val_optim_loss: 16159457.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9109; val_auprc_score: 0.8991; val_best_acc_score: 0.8366; val_best_f1_score: 0.8435; train_kl_reg_loss: 104410.4913; train_edge_recon_loss: 3528726.5833; train_gene_expr_recon_loss: 2133980.3889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9772885.0000; train_global_loss: 15540002.4444; train_optim_loss: 15540002.4444; val_kl_reg_loss: 87102.0312; val_edge_recon_loss: 4026525.2500; val_gene_expr_recon_loss: 2147046.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9874983.0000; val_global_loss: 16135657.0000; val_optim_loss: 16135657.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9180; val_auprc_score: 0.9064; val_best_acc_score: 0.8387; val_best_f1_score: 0.8316; train_kl_reg_loss: 101564.9688; train_edge_recon_loss: 3524478.2778; train_gene_expr_recon_loss: 2108990.1528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9697793.1111; train_global_loss: 15432826.4444; train_optim_loss: 15432826.4444; val_kl_reg_loss: 90594.6719; val_edge_recon_loss: 3994262.7500; val_gene_expr_recon_loss: 2136549.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9856772.0000; val_global_loss: 16078179.0000; val_optim_loss: 16078179.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9195; val_auprc_score: 0.9090; val_best_acc_score: 0.8025; val_best_f1_score: 0.8275; train_kl_reg_loss: 95945.1441; train_edge_recon_loss: 3513072.8056; train_gene_expr_recon_loss: 2121585.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9738445.8889; train_global_loss: 15469049.8889; train_optim_loss: 15469049.8889; val_kl_reg_loss: 84648.0469; val_edge_recon_loss: 3928286.2500; val_gene_expr_recon_loss: 2133593.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9838689.0000; val_global_loss: 15985216.0000; val_optim_loss: 15985216.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9161; val_auprc_score: 0.8978; val_best_acc_score: 0.8375; val_best_f1_score: 0.8467; train_kl_reg_loss: 89304.7066; train_edge_recon_loss: 3493086.9444; train_gene_expr_recon_loss: 2113231.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9759564.6667; train_global_loss: 15455187.3333; train_optim_loss: 15455187.3333; val_kl_reg_loss: 67274.8281; val_edge_recon_loss: 3781900.0000; val_gene_expr_recon_loss: 2135766.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9839533.0000; val_global_loss: 15824474.0000; val_optim_loss: 15824474.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9149; val_auprc_score: 0.9018; val_best_acc_score: 0.8327; val_best_f1_score: 0.8416; train_kl_reg_loss: 73355.5499; train_edge_recon_loss: 3430931.4722; train_gene_expr_recon_loss: 2113581.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9721185.6667; train_global_loss: 15339054.6667; train_optim_loss: 15339054.6667; val_kl_reg_loss: 62251.5156; val_edge_recon_loss: 3481703.0000; val_gene_expr_recon_loss: 2141029.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9841373.0000; val_global_loss: 15526357.0000; val_optim_loss: 15526357.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8932; val_auprc_score: 0.8792; val_best_acc_score: 0.8040; val_best_f1_score: 0.8156; train_kl_reg_loss: 66987.0091; train_edge_recon_loss: 3246569.3889; train_gene_expr_recon_loss: 2127271.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9692661.0000; train_global_loss: 15133489.2222; train_optim_loss: 15133489.2222; val_kl_reg_loss: 73520.3906; val_edge_recon_loss: 3113869.7500; val_gene_expr_recon_loss: 2154874.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9839134.0000; val_global_loss: 15181399.0000; val_optim_loss: 15181399.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8872; val_auprc_score: 0.8682; val_best_acc_score: 0.7963; val_best_f1_score: 0.8094; train_kl_reg_loss: 99003.0590; train_edge_recon_loss: 3040119.0556; train_gene_expr_recon_loss: 2116576.2639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9620948.1111; train_global_loss: 14876646.4444; train_optim_loss: 14876646.4444; val_kl_reg_loss: 125192.0469; val_edge_recon_loss: 2950698.2500; val_gene_expr_recon_loss: 2144058.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9830957.0000; val_global_loss: 15050905.0000; val_optim_loss: 15050905.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8880; val_auprc_score: 0.8703; val_best_acc_score: 0.7980; val_best_f1_score: 0.8123; train_kl_reg_loss: 140264.6997; train_edge_recon_loss: 2968711.1111; train_gene_expr_recon_loss: 2103602.6528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9647706.8889; train_global_loss: 14860285.1111; train_optim_loss: 14860285.1111; val_kl_reg_loss: 134277.7500; val_edge_recon_loss: 2961723.0000; val_gene_expr_recon_loss: 2131120.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9802948.0000; val_global_loss: 15030069.0000; val_optim_loss: 15030069.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9027; val_auprc_score: 0.8882; val_best_acc_score: 0.8188; val_best_f1_score: 0.8275; train_kl_reg_loss: 130197.3542; train_edge_recon_loss: 2957788.0278; train_gene_expr_recon_loss: 2109628.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9651283.0000; train_global_loss: 14848896.4444; train_optim_loss: 14848896.4444; val_kl_reg_loss: 118163.9219; val_edge_recon_loss: 2919553.2500; val_gene_expr_recon_loss: 2126298.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9795321.0000; val_global_loss: 14959337.0000; val_optim_loss: 14959337.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9027; val_auprc_score: 0.8821; val_best_acc_score: 0.8213; val_best_f1_score: 0.8325; train_kl_reg_loss: 122121.8811; train_edge_recon_loss: 2954128.3611; train_gene_expr_recon_loss: 2093261.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9650338.4444; train_global_loss: 14819850.5556; train_optim_loss: 14819850.5556; val_kl_reg_loss: 118170.2344; val_edge_recon_loss: 2915725.0000; val_gene_expr_recon_loss: 2122968.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9783547.0000; val_global_loss: 14940411.0000; val_optim_loss: 14940411.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9060; val_auprc_score: 0.8848; val_best_acc_score: 0.8278; val_best_f1_score: 0.8374; train_kl_reg_loss: 120818.6649; train_edge_recon_loss: 2925241.1389; train_gene_expr_recon_loss: 2100487.8472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9634739.3333; train_global_loss: 14781286.8889; train_optim_loss: 14781286.8889; val_kl_reg_loss: 114345.2109; val_edge_recon_loss: 2921463.7500; val_gene_expr_recon_loss: 2119970.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9786029.0000; val_global_loss: 14941809.0000; val_optim_loss: 14941809.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9158; val_auprc_score: 0.8965; val_best_acc_score: 0.8416; val_best_f1_score: 0.8493; train_kl_reg_loss: 116170.1589; train_edge_recon_loss: 2908262.6389; train_gene_expr_recon_loss: 2088476.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9694146.3333; train_global_loss: 14807055.6667; train_optim_loss: 14807055.6667; val_kl_reg_loss: 111613.5000; val_edge_recon_loss: 2898094.0000; val_gene_expr_recon_loss: 2119702.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9773000.0000; val_global_loss: 14902410.0000; val_optim_loss: 14902410.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9266; val_auprc_score: 0.9118; val_best_acc_score: 0.8584; val_best_f1_score: 0.8652; train_kl_reg_loss: 116972.5069; train_edge_recon_loss: 2880782.9167; train_gene_expr_recon_loss: 2084823.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9682563.1111; train_global_loss: 14765141.6667; train_optim_loss: 14765141.6667; val_kl_reg_loss: 115304.5625; val_edge_recon_loss: 2863508.7500; val_gene_expr_recon_loss: 2114085.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9767883.0000; val_global_loss: 14860782.0000; val_optim_loss: 14860782.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9333; val_auprc_score: 0.9145; val_best_acc_score: 0.8627; val_best_f1_score: 0.8691; train_kl_reg_loss: 130218.3325; train_edge_recon_loss: 2916544.0833; train_gene_expr_recon_loss: 2099108.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9601563.7778; train_global_loss: 14747434.4444; train_optim_loss: 14747434.4444; val_kl_reg_loss: 86554.0781; val_edge_recon_loss: 2890083.2500; val_gene_expr_recon_loss: 2120889.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9759888.0000; val_global_loss: 14857415.0000; val_optim_loss: 14857415.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9340; val_auprc_score: 0.9145; val_best_acc_score: 0.8674; val_best_f1_score: 0.8747; train_kl_reg_loss: 147051.9635; train_edge_recon_loss: 2858960.2500; train_gene_expr_recon_loss: 2084845.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9630989.4444; train_global_loss: 14721847.4444; train_optim_loss: 14721847.4444; val_kl_reg_loss: 86071.6719; val_edge_recon_loss: 2879009.2500; val_gene_expr_recon_loss: 2119502.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9760315.0000; val_global_loss: 14844898.0000; val_optim_loss: 14844898.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9485; val_auprc_score: 0.9328; val_best_acc_score: 0.8876; val_best_f1_score: 0.8914; train_kl_reg_loss: 132345.5990; train_edge_recon_loss: 2851670.6389; train_gene_expr_recon_loss: 2089079.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9602810.0000; train_global_loss: 14675905.4444; train_optim_loss: 14675905.4444; val_kl_reg_loss: 86816.1719; val_edge_recon_loss: 2824267.5000; val_gene_expr_recon_loss: 2114051.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9743517.0000; val_global_loss: 14768652.0000; val_optim_loss: 14768652.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9509; val_auprc_score: 0.9332; val_best_acc_score: 0.8934; val_best_f1_score: 0.8980; train_kl_reg_loss: 127491.2665; train_edge_recon_loss: 2826484.7778; train_gene_expr_recon_loss: 2086790.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9575610.7778; train_global_loss: 14616377.0000; train_optim_loss: 14616377.0000; val_kl_reg_loss: 91406.2891; val_edge_recon_loss: 2811043.0000; val_gene_expr_recon_loss: 2115151.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9759081.0000; val_global_loss: 14776681.0000; val_optim_loss: 14776681.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9503; val_auprc_score: 0.9315; val_best_acc_score: 0.8954; val_best_f1_score: 0.8991; train_kl_reg_loss: 126738.5391; train_edge_recon_loss: 2811325.3611; train_gene_expr_recon_loss: 2078922.9028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9611470.7778; train_global_loss: 14628457.5556; train_optim_loss: 14628457.5556; val_kl_reg_loss: 91938.5000; val_edge_recon_loss: 2809954.2500; val_gene_expr_recon_loss: 2110002.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9726000.0000; val_global_loss: 14737895.0000; val_optim_loss: 14737895.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9481; val_auprc_score: 0.9243; val_best_acc_score: 0.8911; val_best_f1_score: 0.8966; train_kl_reg_loss: 123206.1858; train_edge_recon_loss: 2804516.8611; train_gene_expr_recon_loss: 2082868.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9585963.1111; train_global_loss: 14596555.0000; train_optim_loss: 14596555.0000; val_kl_reg_loss: 94025.0781; val_edge_recon_loss: 2818068.2500; val_gene_expr_recon_loss: 2109669.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9731533.0000; val_global_loss: 14753296.0000; val_optim_loss: 14753296.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9523; val_auprc_score: 0.9328; val_best_acc_score: 0.8932; val_best_f1_score: 0.8992; train_kl_reg_loss: 124544.0148; train_edge_recon_loss: 2790541.7500; train_gene_expr_recon_loss: 2071072.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9566332.6667; train_global_loss: 14552491.0000; train_optim_loss: 14552491.0000; val_kl_reg_loss: 95065.9688; val_edge_recon_loss: 2810081.0000; val_gene_expr_recon_loss: 2104283.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9714219.0000; val_global_loss: 14723650.0000; val_optim_loss: 14723650.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9569; val_auprc_score: 0.9374; val_best_acc_score: 0.9035; val_best_f1_score: 0.9063; train_kl_reg_loss: 123783.7405; train_edge_recon_loss: 2784376.4722; train_gene_expr_recon_loss: 2072623.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9564040.7778; train_global_loss: 14544824.6667; train_optim_loss: 14544824.6667; val_kl_reg_loss: 94392.3516; val_edge_recon_loss: 2787801.5000; val_gene_expr_recon_loss: 2102994.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9699789.0000; val_global_loss: 14684977.0000; val_optim_loss: 14684977.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9540; val_auprc_score: 0.9381; val_best_acc_score: 0.8981; val_best_f1_score: 0.9028; train_kl_reg_loss: 122665.0373; train_edge_recon_loss: 2772266.4167; train_gene_expr_recon_loss: 2078667.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9546791.0000; train_global_loss: 14520390.1111; train_optim_loss: 14520390.1111; val_kl_reg_loss: 94461.6250; val_edge_recon_loss: 2786867.2500; val_gene_expr_recon_loss: 2103920.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9704927.0000; val_global_loss: 14690176.0000; val_optim_loss: 14690176.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9610; val_auprc_score: 0.9499; val_best_acc_score: 0.9070; val_best_f1_score: 0.9109; train_kl_reg_loss: 119313.1840; train_edge_recon_loss: 2772844.0556; train_gene_expr_recon_loss: 2066096.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9512980.5556; train_global_loss: 14471234.0000; train_optim_loss: 14471234.0000; val_kl_reg_loss: 92460.1562; val_edge_recon_loss: 2769434.7500; val_gene_expr_recon_loss: 2101140.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9698851.0000; val_global_loss: 14661886.0000; val_optim_loss: 14661886.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9590; val_auprc_score: 0.9427; val_best_acc_score: 0.9051; val_best_f1_score: 0.9093; train_kl_reg_loss: 119213.1259; train_edge_recon_loss: 2779579.3611; train_gene_expr_recon_loss: 2066660.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9597075.2222; train_global_loss: 14562528.2222; train_optim_loss: 14562528.2222; val_kl_reg_loss: 92036.2188; val_edge_recon_loss: 2772205.2500; val_gene_expr_recon_loss: 2096133.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9687207.0000; val_global_loss: 14647582.0000; val_optim_loss: 14647582.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9590; val_auprc_score: 0.9426; val_best_acc_score: 0.9033; val_best_f1_score: 0.9077; train_kl_reg_loss: 117215.1632; train_edge_recon_loss: 2767985.2222; train_gene_expr_recon_loss: 2071191.6806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9539976.2222; train_global_loss: 14496368.2222; train_optim_loss: 14496368.2222; val_kl_reg_loss: 92434.6250; val_edge_recon_loss: 2784764.2500; val_gene_expr_recon_loss: 2091840.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9671720.0000; val_global_loss: 14640759.0000; val_optim_loss: 14640759.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9583; val_auprc_score: 0.9438; val_best_acc_score: 0.9012; val_best_f1_score: 0.9061; train_kl_reg_loss: 116740.0564; train_edge_recon_loss: 2759907.9444; train_gene_expr_recon_loss: 2050234.0139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9505457.5556; train_global_loss: 14432339.6667; train_optim_loss: 14432339.6667; val_kl_reg_loss: 93306.8750; val_edge_recon_loss: 2778815.0000; val_gene_expr_recon_loss: 2091597.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9684670.0000; val_global_loss: 14648390.0000; val_optim_loss: 14648390.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9590; val_auprc_score: 0.9412; val_best_acc_score: 0.9060; val_best_f1_score: 0.9100; train_kl_reg_loss: 114821.6849; train_edge_recon_loss: 2773003.1111; train_gene_expr_recon_loss: 2050132.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9501326.5556; train_global_loss: 14439284.2222; train_optim_loss: 14439284.2222; val_kl_reg_loss: 89763.2812; val_edge_recon_loss: 2777866.2500; val_gene_expr_recon_loss: 2090624.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9681999.0000; val_global_loss: 14640253.0000; val_optim_loss: 14640253.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9640; val_auprc_score: 0.9495; val_best_acc_score: 0.9112; val_best_f1_score: 0.9157; train_kl_reg_loss: 113310.6233; train_edge_recon_loss: 2767412.0000; train_gene_expr_recon_loss: 2060417.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9534975.8889; train_global_loss: 14476115.5556; train_optim_loss: 14476115.5556; val_kl_reg_loss: 90396.2656; val_edge_recon_loss: 2732188.5000; val_gene_expr_recon_loss: 2087623.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9657092.0000; val_global_loss: 14567300.0000; val_optim_loss: 14567300.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9591; val_auprc_score: 0.9423; val_best_acc_score: 0.9066; val_best_f1_score: 0.9108; train_kl_reg_loss: 113525.6484; train_edge_recon_loss: 2753195.0556; train_gene_expr_recon_loss: 2049149.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9486790.2222; train_global_loss: 14402661.0000; train_optim_loss: 14402661.0000; val_kl_reg_loss: 86984.5781; val_edge_recon_loss: 2754374.7500; val_gene_expr_recon_loss: 2090148.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9673633.0000; val_global_loss: 14605141.0000; val_optim_loss: 14605141.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9618; val_auprc_score: 0.9449; val_best_acc_score: 0.9113; val_best_f1_score: 0.9153; train_kl_reg_loss: 112150.7092; train_edge_recon_loss: 2754435.3889; train_gene_expr_recon_loss: 2039188.6111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9450471.4444; train_global_loss: 14356246.0000; train_optim_loss: 14356246.0000; val_kl_reg_loss: 87898.8672; val_edge_recon_loss: 2759567.2500; val_gene_expr_recon_loss: 2084051.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9653631.0000; val_global_loss: 14585148.0000; val_optim_loss: 14585148.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9576; val_auprc_score: 0.9381; val_best_acc_score: 0.9082; val_best_f1_score: 0.9131; train_kl_reg_loss: 115205.5095; train_edge_recon_loss: 2751767.9167; train_gene_expr_recon_loss: 2037610.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9434215.3333; train_global_loss: 14338799.6667; train_optim_loss: 14338799.6667; val_kl_reg_loss: 86761.2188; val_edge_recon_loss: 2758729.2500; val_gene_expr_recon_loss: 2084699.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9647115.0000; val_global_loss: 14577304.0000; val_optim_loss: 14577304.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9627; val_auprc_score: 0.9464; val_best_acc_score: 0.9131; val_best_f1_score: 0.9175; train_kl_reg_loss: 110441.5339; train_edge_recon_loss: 2747830.8611; train_gene_expr_recon_loss: 2043221.7361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9475074.3333; train_global_loss: 14376568.4444; train_optim_loss: 14376568.4444; val_kl_reg_loss: 85000.2734; val_edge_recon_loss: 2751887.2500; val_gene_expr_recon_loss: 2081352.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9649209.0000; val_global_loss: 14567448.0000; val_optim_loss: 14567448.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9626; val_auprc_score: 0.9500; val_best_acc_score: 0.9072; val_best_f1_score: 0.9115; train_kl_reg_loss: 108629.9566; train_edge_recon_loss: 2763302.5556; train_gene_expr_recon_loss: 2031753.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9437294.6667; train_global_loss: 14340980.8889; train_optim_loss: 14340980.8889; val_kl_reg_loss: 85306.3281; val_edge_recon_loss: 2767981.0000; val_gene_expr_recon_loss: 2077645.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9616690.0000; val_global_loss: 14547623.0000; val_optim_loss: 14547623.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9595; val_auprc_score: 0.9417; val_best_acc_score: 0.9092; val_best_f1_score: 0.9132; train_kl_reg_loss: 109842.3316; train_edge_recon_loss: 2759599.0833; train_gene_expr_recon_loss: 2038125.2639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9457540.4444; train_global_loss: 14365107.2222; train_optim_loss: 14365107.2222; val_kl_reg_loss: 86661.8906; val_edge_recon_loss: 2762318.5000; val_gene_expr_recon_loss: 2077698.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9641947.0000; val_global_loss: 14568626.0000; val_optim_loss: 14568626.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9660; val_auprc_score: 0.9541; val_best_acc_score: 0.9188; val_best_f1_score: 0.9224; train_kl_reg_loss: 110419.3845; train_edge_recon_loss: 2747843.0833; train_gene_expr_recon_loss: 2032811.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9475488.8889; train_global_loss: 14366562.2222; train_optim_loss: 14366562.2222; val_kl_reg_loss: 86236.6406; val_edge_recon_loss: 2741211.2500; val_gene_expr_recon_loss: 2077994.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9640048.0000; val_global_loss: 14545491.0000; val_optim_loss: 14545491.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9627; val_auprc_score: 0.9482; val_best_acc_score: 0.9089; val_best_f1_score: 0.9130; train_kl_reg_loss: 110492.9748; train_edge_recon_loss: 2742574.1389; train_gene_expr_recon_loss: 2055484.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9528039.5556; train_global_loss: 14436591.6667; train_optim_loss: 14436591.6667; val_kl_reg_loss: 87045.6484; val_edge_recon_loss: 2765875.7500; val_gene_expr_recon_loss: 2078535.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9641037.0000; val_global_loss: 14572494.0000; val_optim_loss: 14572494.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9608; val_auprc_score: 0.9480; val_best_acc_score: 0.9060; val_best_f1_score: 0.9104; train_kl_reg_loss: 110730.6120; train_edge_recon_loss: 2749027.3611; train_gene_expr_recon_loss: 2041367.2361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9466093.4444; train_global_loss: 14367218.6667; train_optim_loss: 14367218.6667; val_kl_reg_loss: 86976.2812; val_edge_recon_loss: 2783964.0000; val_gene_expr_recon_loss: 2076664.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9634087.0000; val_global_loss: 14581692.0000; val_optim_loss: 14581692.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9634; val_auprc_score: 0.9481; val_best_acc_score: 0.9092; val_best_f1_score: 0.9132; train_kl_reg_loss: 110691.0868; train_edge_recon_loss: 2748887.5556; train_gene_expr_recon_loss: 2052658.4306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9504369.3333; train_global_loss: 14416606.3333; train_optim_loss: 14416606.3333; val_kl_reg_loss: 87153.6719; val_edge_recon_loss: 2770877.0000; val_gene_expr_recon_loss: 2076429.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9629655.0000; val_global_loss: 14564116.0000; val_optim_loss: 14564116.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9611; val_auprc_score: 0.9452; val_best_acc_score: 0.9112; val_best_f1_score: 0.9163; train_kl_reg_loss: 110565.2908; train_edge_recon_loss: 2749796.9722; train_gene_expr_recon_loss: 2050162.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9508815.8889; train_global_loss: 14419340.1111; train_optim_loss: 14419340.1111; val_kl_reg_loss: 87148.5156; val_edge_recon_loss: 2755024.7500; val_gene_expr_recon_loss: 2077074.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9627543.0000; val_global_loss: 14546791.0000; val_optim_loss: 14546791.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9620; val_auprc_score: 0.9491; val_best_acc_score: 0.9072; val_best_f1_score: 0.9112; train_kl_reg_loss: 110674.2569; train_edge_recon_loss: 2745389.8889; train_gene_expr_recon_loss: 2033227.5694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9480411.3333; train_global_loss: 14369703.0000; train_optim_loss: 14369703.0000; val_kl_reg_loss: 87071.9531; val_edge_recon_loss: 2766232.7500; val_gene_expr_recon_loss: 2076970.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9632941.0000; val_global_loss: 14563216.0000; val_optim_loss: 14563216.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9624; val_auprc_score: 0.9481; val_best_acc_score: 0.9128; val_best_f1_score: 0.9172; train_kl_reg_loss: 110600.8819; train_edge_recon_loss: 2740680.0833; train_gene_expr_recon_loss: 2037580.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9502733.2222; train_global_loss: 14391594.8889; train_optim_loss: 14391594.8889; val_kl_reg_loss: 86975.8516; val_edge_recon_loss: 2747341.0000; val_gene_expr_recon_loss: 2077895.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9630898.0000; val_global_loss: 14543110.0000; val_optim_loss: 14543110.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9615; val_auprc_score: 0.9434; val_best_acc_score: 0.9092; val_best_f1_score: 0.9133; train_kl_reg_loss: 110678.8481; train_edge_recon_loss: 2745357.1944; train_gene_expr_recon_loss: 2053299.6528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9507975.4444; train_global_loss: 14417311.1111; train_optim_loss: 14417311.1111; val_kl_reg_loss: 87154.8125; val_edge_recon_loss: 2765158.7500; val_gene_expr_recon_loss: 2078895.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9640428.0000; val_global_loss: 14571636.0000; val_optim_loss: 14571636.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9632; val_auprc_score: 0.9465; val_best_acc_score: 0.9138; val_best_f1_score: 0.9172; train_kl_reg_loss: 109911.8724; train_edge_recon_loss: 2757578.1944; train_gene_expr_recon_loss: 2037919.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9447985.8889; train_global_loss: 14353395.2222; train_optim_loss: 14353395.2222; val_kl_reg_loss: 86726.7969; val_edge_recon_loss: 2736931.7500; val_gene_expr_recon_loss: 2077726.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9624625.0000; val_global_loss: 14526010.0000; val_optim_loss: 14526010.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9624; val_auprc_score: 0.9494; val_best_acc_score: 0.9104; val_best_f1_score: 0.9143; train_kl_reg_loss: 109946.9271; train_edge_recon_loss: 2745000.5000; train_gene_expr_recon_loss: 2032984.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9442073.2222; train_global_loss: 14330005.2222; train_optim_loss: 14330005.2222; val_kl_reg_loss: 86982.9844; val_edge_recon_loss: 2762921.2500; val_gene_expr_recon_loss: 2078065.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9637802.0000; val_global_loss: 14565772.0000; val_optim_loss: 14565772.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9630; val_auprc_score: 0.9490; val_best_acc_score: 0.9080; val_best_f1_score: 0.9119; train_kl_reg_loss: 110155.5295; train_edge_recon_loss: 2748568.4167; train_gene_expr_recon_loss: 2040315.7639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9478949.6667; train_global_loss: 14377989.3333; train_optim_loss: 14377989.3333; val_kl_reg_loss: 87348.2188; val_edge_recon_loss: 2757062.2500; val_gene_expr_recon_loss: 2076969.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9643333.0000; val_global_loss: 14564714.0000; val_optim_loss: 14564714.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9615; val_auprc_score: 0.9453; val_best_acc_score: 0.9092; val_best_f1_score: 0.9137; train_kl_reg_loss: 110596.3776; train_edge_recon_loss: 2751128.9444; train_gene_expr_recon_loss: 2055122.0139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9485967.1111; train_global_loss: 14402814.5556; train_optim_loss: 14402814.5556; val_kl_reg_loss: 86958.5000; val_edge_recon_loss: 2752948.7500; val_gene_expr_recon_loss: 2075811.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9625295.0000; val_global_loss: 14541014.0000; val_optim_loss: 14541014.0000
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9602; val_auprc_score: 0.9429; val_best_acc_score: 0.9131; val_best_f1_score: 0.9167; train_kl_reg_loss: 110414.6302; train_edge_recon_loss: 2748316.8333; train_gene_expr_recon_loss: 2037967.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9513508.0000; train_global_loss: 14410206.8889; train_optim_loss: 14410206.8889; val_kl_reg_loss: 87206.4688; val_edge_recon_loss: 2754219.5000; val_gene_expr_recon_loss: 2078319.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9633283.0000; val_global_loss: 14553028.0000; val_optim_loss: 14553028.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9630; val_auprc_score: 0.9496; val_best_acc_score: 0.9089; val_best_f1_score: 0.9138; train_kl_reg_loss: 110687.7925; train_edge_recon_loss: 2752591.6667; train_gene_expr_recon_loss: 2046967.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9511405.3333; train_global_loss: 14421651.8889; train_optim_loss: 14421651.8889; val_kl_reg_loss: 87315.7188; val_edge_recon_loss: 2773618.5000; val_gene_expr_recon_loss: 2077623.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9640304.0000; val_global_loss: 14578861.0000; val_optim_loss: 14578861.0000
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9619; val_auprc_score: 0.9452; val_best_acc_score: 0.9086; val_best_f1_score: 0.9128; train_kl_reg_loss: 110220.6936; train_edge_recon_loss: 2753052.0833; train_gene_expr_recon_loss: 2042540.0139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9495861.8889; train_global_loss: 14401674.5556; train_optim_loss: 14401674.5556; val_kl_reg_loss: 86883.7734; val_edge_recon_loss: 2777356.5000; val_gene_expr_recon_loss: 2077369.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9626143.0000; val_global_loss: 14567752.0000; val_optim_loss: 14567752.0000
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9609; val_auprc_score: 0.9456; val_best_acc_score: 0.9107; val_best_f1_score: 0.9148; train_kl_reg_loss: 110606.8568; train_edge_recon_loss: 2753581.9444; train_gene_expr_recon_loss: 2049528.8472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9493202.4444; train_global_loss: 14406920.0000; train_optim_loss: 14406920.0000; val_kl_reg_loss: 87333.6562; val_edge_recon_loss: 2759734.5000; val_gene_expr_recon_loss: 2076075.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9631562.0000; val_global_loss: 14554706.0000; val_optim_loss: 14554706.0000
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9606; val_auprc_score: 0.9456; val_best_acc_score: 0.9105; val_best_f1_score: 0.9145; train_kl_reg_loss: 110586.1450; train_edge_recon_loss: 2757604.6944; train_gene_expr_recon_loss: 2041186.7639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9482181.0000; train_global_loss: 14391558.6667; train_optim_loss: 14391558.6667; val_kl_reg_loss: 87403.5625; val_edge_recon_loss: 2762535.5000; val_gene_expr_recon_loss: 2077821.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9636583.0000; val_global_loss: 14564344.0000; val_optim_loss: 14564344.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 38 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
Val AUROC score: 0.9602
Val AUPRC score: 0.9447
Val best accuracy score: 0.9068
Val best F1 score: 0.9111
Val gene expr MSE score: 0.3552
Val chrom access MSE score: 0.0886
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
