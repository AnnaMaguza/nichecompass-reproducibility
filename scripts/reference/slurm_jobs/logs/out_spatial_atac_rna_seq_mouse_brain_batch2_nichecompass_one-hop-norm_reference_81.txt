[True]
Run timestamp: 07092023_184104_81.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_81']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 795 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3522, n_cat_covariates_embed_input: 0, n_hidden: 2313, n_latent: 2213, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 795
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 795

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7606; val_auprc_score: 0.7844; val_best_acc_score: 0.5090; val_best_f1_score: 0.6704; train_kl_reg_loss: 59055.7477; train_edge_recon_loss: 3545580.9370; train_gene_expr_recon_loss: 21342988.8244; train_masked_gp_l1_reg_loss: 65496.6426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 743798.0415; train_chrom_access_recon_loss: 4577733.5649; train_global_loss: 30334653.7099; train_optim_loss: 30334653.7099; val_kl_reg_loss: 120760.0094; val_edge_recon_loss: 4064658.8167; val_gene_expr_recon_loss: 19733755.3333; val_masked_gp_l1_reg_loss: 62568.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 502644.2500; val_chrom_access_recon_loss: 4324507.5000; val_global_loss: 28808893.4667; val_optim_loss: 28808893.4667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8523; val_auprc_score: 0.8586; val_best_acc_score: 0.7429; val_best_f1_score: 0.7761; train_kl_reg_loss: 85650.3702; train_edge_recon_loss: 3512948.9408; train_gene_expr_recon_loss: 19737700.3359; train_masked_gp_l1_reg_loss: 60190.3699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 347129.2016; train_chrom_access_recon_loss: 4364456.5477; train_global_loss: 28108075.8626; train_optim_loss: 28108075.8626; val_kl_reg_loss: 71773.9630; val_edge_recon_loss: 4032352.6167; val_gene_expr_recon_loss: 19280363.4667; val_masked_gp_l1_reg_loss: 59610.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 232886.4062; val_chrom_access_recon_loss: 4258524.8333; val_global_loss: 27935510.8000; val_optim_loss: 27935510.8000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8828; val_auprc_score: 0.8721; val_best_acc_score: 0.7983; val_best_f1_score: 0.8143; train_kl_reg_loss: 66356.2852; train_edge_recon_loss: 3422301.5668; train_gene_expr_recon_loss: 19391594.1069; train_masked_gp_l1_reg_loss: 62184.0340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 178120.1311; train_chrom_access_recon_loss: 4304871.6622; train_global_loss: 27425427.7405; train_optim_loss: 27425427.7405; val_kl_reg_loss: 56180.7214; val_edge_recon_loss: 3118657.3167; val_gene_expr_recon_loss: 19019479.3333; val_masked_gp_l1_reg_loss: 65055.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136649.8125; val_chrom_access_recon_loss: 4201095.2333; val_global_loss: 26597118.5333; val_optim_loss: 26597118.5333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8858; val_auprc_score: 0.8752; val_best_acc_score: 0.7887; val_best_f1_score: 0.8024; train_kl_reg_loss: 84785.0686; train_edge_recon_loss: 2990719.4771; train_gene_expr_recon_loss: 19148360.9160; train_masked_gp_l1_reg_loss: 67448.0705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112437.0854; train_chrom_access_recon_loss: 4256194.7500; train_global_loss: 26659945.4962; train_optim_loss: 26659945.4962; val_kl_reg_loss: 88374.5323; val_edge_recon_loss: 2965720.5000; val_gene_expr_recon_loss: 18740953.8667; val_masked_gp_l1_reg_loss: 69292.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92660.3438; val_chrom_access_recon_loss: 4147231.8000; val_global_loss: 26104232.5333; val_optim_loss: 26104232.5333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9009; val_auprc_score: 0.8889; val_best_acc_score: 0.8049; val_best_f1_score: 0.8220; train_kl_reg_loss: 89197.8262; train_edge_recon_loss: 2926460.0649; train_gene_expr_recon_loss: 18936514.6412; train_masked_gp_l1_reg_loss: 70824.9238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80274.0048; train_chrom_access_recon_loss: 4211803.4485; train_global_loss: 26315074.7328; train_optim_loss: 26315074.7328; val_kl_reg_loss: 88142.6969; val_edge_recon_loss: 2909405.4000; val_gene_expr_recon_loss: 18621598.1333; val_masked_gp_l1_reg_loss: 72324.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70291.8828; val_chrom_access_recon_loss: 4109660.0167; val_global_loss: 25871422.0000; val_optim_loss: 25871422.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9190; val_auprc_score: 0.9028; val_best_acc_score: 0.8383; val_best_f1_score: 0.8481; train_kl_reg_loss: 85525.3443; train_edge_recon_loss: 2881133.8760; train_gene_expr_recon_loss: 18753408.9924; train_masked_gp_l1_reg_loss: 73754.0239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63457.9263; train_chrom_access_recon_loss: 4172591.2901; train_global_loss: 26029871.4809; train_optim_loss: 26029871.4809; val_kl_reg_loss: 78070.3229; val_edge_recon_loss: 2872166.2333; val_gene_expr_recon_loss: 18431956.6667; val_masked_gp_l1_reg_loss: 75348.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58081.5781; val_chrom_access_recon_loss: 4086869.1667; val_global_loss: 25602492.1333; val_optim_loss: 25602492.1333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9320; val_auprc_score: 0.9171; val_best_acc_score: 0.8636; val_best_f1_score: 0.8713; train_kl_reg_loss: 85803.0468; train_edge_recon_loss: 2816034.3244; train_gene_expr_recon_loss: 18600673.0076; train_masked_gp_l1_reg_loss: 76582.3265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54099.5506; train_chrom_access_recon_loss: 4140396.0401; train_global_loss: 25773588.2443; train_optim_loss: 25773588.2443; val_kl_reg_loss: 86543.7464; val_edge_recon_loss: 2792761.4667; val_gene_expr_recon_loss: 18322302.5333; val_masked_gp_l1_reg_loss: 77964.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50108.0000; val_chrom_access_recon_loss: 4057887.2833; val_global_loss: 25387567.0667; val_optim_loss: 25387567.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9373; val_auprc_score: 0.9235; val_best_acc_score: 0.8709; val_best_f1_score: 0.8777; train_kl_reg_loss: 87977.3336; train_edge_recon_loss: 2777467.5763; train_gene_expr_recon_loss: 18459837.4198; train_masked_gp_l1_reg_loss: 79093.2929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47494.5915; train_chrom_access_recon_loss: 4106642.4580; train_global_loss: 25558512.3664; train_optim_loss: 25558512.3664; val_kl_reg_loss: 88705.9901; val_edge_recon_loss: 2773036.1000; val_gene_expr_recon_loss: 18091560.9333; val_masked_gp_l1_reg_loss: 80156.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44781.4219; val_chrom_access_recon_loss: 4004212.1333; val_global_loss: 25082453.2000; val_optim_loss: 25082453.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9399; val_auprc_score: 0.9276; val_best_acc_score: 0.8692; val_best_f1_score: 0.8773; train_kl_reg_loss: 86050.2586; train_edge_recon_loss: 2770286.1164; train_gene_expr_recon_loss: 18350799.4656; train_masked_gp_l1_reg_loss: 81505.5551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43083.8369; train_chrom_access_recon_loss: 4085287.6221; train_global_loss: 25417012.9313; train_optim_loss: 25417012.9313; val_kl_reg_loss: 86344.4776; val_edge_recon_loss: 2775557.3167; val_gene_expr_recon_loss: 18031803.4667; val_masked_gp_l1_reg_loss: 82656.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41521.1250; val_chrom_access_recon_loss: 3992916.1833; val_global_loss: 25010799.4667; val_optim_loss: 25010799.4667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9428; val_auprc_score: 0.9277; val_best_acc_score: 0.8789; val_best_f1_score: 0.8861; train_kl_reg_loss: 84925.4661; train_edge_recon_loss: 2749856.1775; train_gene_expr_recon_loss: 18233527.8321; train_masked_gp_l1_reg_loss: 83692.3268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40143.1533; train_chrom_access_recon_loss: 4053524.0954; train_global_loss: 25245669.1298; train_optim_loss: 25245669.1298; val_kl_reg_loss: 86188.4536; val_edge_recon_loss: 2756023.3167; val_gene_expr_recon_loss: 17908230.2667; val_masked_gp_l1_reg_loss: 84635.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39032.0234; val_chrom_access_recon_loss: 3956012.2667; val_global_loss: 24830123.0667; val_optim_loss: 24830123.0667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9504; val_auprc_score: 0.9374; val_best_acc_score: 0.8910; val_best_f1_score: 0.8956; train_kl_reg_loss: 83286.8928; train_edge_recon_loss: 2736013.2500; train_gene_expr_recon_loss: 18146317.5573; train_masked_gp_l1_reg_loss: 85568.6994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37921.8944; train_chrom_access_recon_loss: 4032098.5477; train_global_loss: 25121206.7634; train_optim_loss: 25121206.7634; val_kl_reg_loss: 84394.0125; val_edge_recon_loss: 2718676.6833; val_gene_expr_recon_loss: 17902300.9333; val_masked_gp_l1_reg_loss: 86497.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37024.3359; val_chrom_access_recon_loss: 3974192.2333; val_global_loss: 24803085.4667; val_optim_loss: 24803085.4667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9532; val_auprc_score: 0.9384; val_best_acc_score: 0.8925; val_best_f1_score: 0.8974; train_kl_reg_loss: 82460.5912; train_edge_recon_loss: 2733256.4733; train_gene_expr_recon_loss: 18050741.1145; train_masked_gp_l1_reg_loss: 87212.8647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36333.5568; train_chrom_access_recon_loss: 4008570.3130; train_global_loss: 24998574.9771; train_optim_loss: 24998574.9771; val_kl_reg_loss: 78534.0672; val_edge_recon_loss: 2724961.2000; val_gene_expr_recon_loss: 17774788.0000; val_masked_gp_l1_reg_loss: 87870.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35878.3320; val_chrom_access_recon_loss: 3923538.5667; val_global_loss: 24625570.1333; val_optim_loss: 24625570.1333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9511; val_auprc_score: 0.9389; val_best_acc_score: 0.8907; val_best_f1_score: 0.8944; train_kl_reg_loss: 79803.6398; train_edge_recon_loss: 2737066.6679; train_gene_expr_recon_loss: 17967192.7634; train_masked_gp_l1_reg_loss: 88695.9909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35302.3398; train_chrom_access_recon_loss: 3989175.3607; train_global_loss: 24897236.6107; train_optim_loss: 24897236.6107; val_kl_reg_loss: 79411.2542; val_edge_recon_loss: 2743637.9000; val_gene_expr_recon_loss: 17669235.4667; val_masked_gp_l1_reg_loss: 89424.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34576.9883; val_chrom_access_recon_loss: 3911021.8833; val_global_loss: 24527306.2667; val_optim_loss: 24527306.2667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9600; val_auprc_score: 0.9520; val_best_acc_score: 0.8992; val_best_f1_score: 0.9023; train_kl_reg_loss: 77218.1428; train_edge_recon_loss: 2720924.6527; train_gene_expr_recon_loss: 17900912.8092; train_masked_gp_l1_reg_loss: 90235.5271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34399.8617; train_chrom_access_recon_loss: 3972082.7252; train_global_loss: 24795773.6489; train_optim_loss: 24795773.6489; val_kl_reg_loss: 78069.5479; val_edge_recon_loss: 2743811.1500; val_gene_expr_recon_loss: 17665966.9333; val_masked_gp_l1_reg_loss: 90891.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34023.6406; val_chrom_access_recon_loss: 3911117.8500; val_global_loss: 24523881.4667; val_optim_loss: 24523881.4667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9615; val_auprc_score: 0.9517; val_best_acc_score: 0.9035; val_best_f1_score: 0.9076; train_kl_reg_loss: 77816.4142; train_edge_recon_loss: 2714522.9733; train_gene_expr_recon_loss: 17838716.7557; train_masked_gp_l1_reg_loss: 91560.9528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33884.5272; train_chrom_access_recon_loss: 3958665.6050; train_global_loss: 24715167.1603; train_optim_loss: 24715167.1603; val_kl_reg_loss: 76903.5615; val_edge_recon_loss: 2704958.3833; val_gene_expr_recon_loss: 17554579.0667; val_masked_gp_l1_reg_loss: 92242.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33722.0234; val_chrom_access_recon_loss: 3877726.5333; val_global_loss: 24340131.4667; val_optim_loss: 24340131.4667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9644; val_auprc_score: 0.9534; val_best_acc_score: 0.9117; val_best_f1_score: 0.9153; train_kl_reg_loss: 76883.6455; train_edge_recon_loss: 2708294.2672; train_gene_expr_recon_loss: 17773783.8092; train_masked_gp_l1_reg_loss: 92703.6982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33391.8721; train_chrom_access_recon_loss: 3940565.6832; train_global_loss: 24625622.8550; train_optim_loss: 24625622.8550; val_kl_reg_loss: 74638.3141; val_edge_recon_loss: 2708969.9833; val_gene_expr_recon_loss: 17473438.3333; val_masked_gp_l1_reg_loss: 93366.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33218.6953; val_chrom_access_recon_loss: 3859668.3333; val_global_loss: 24243298.9333; val_optim_loss: 24243298.9333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9631; val_auprc_score: 0.9532; val_best_acc_score: 0.9101; val_best_f1_score: 0.9136; train_kl_reg_loss: 75569.9733; train_edge_recon_loss: 2698568.7118; train_gene_expr_recon_loss: 17721954.9771; train_masked_gp_l1_reg_loss: 93896.8463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33005.2332; train_chrom_access_recon_loss: 3930591.6031; train_global_loss: 24553587.1298; train_optim_loss: 24553587.1298; val_kl_reg_loss: 76218.0693; val_edge_recon_loss: 2717500.1667; val_gene_expr_recon_loss: 17396126.6667; val_masked_gp_l1_reg_loss: 94477.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33198.3594; val_chrom_access_recon_loss: 3868534.0833; val_global_loss: 24186054.6667; val_optim_loss: 24186054.6667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9643; val_auprc_score: 0.9540; val_best_acc_score: 0.9100; val_best_f1_score: 0.9131; train_kl_reg_loss: 74691.1885; train_edge_recon_loss: 2704803.0324; train_gene_expr_recon_loss: 17665726.8168; train_masked_gp_l1_reg_loss: 94958.9897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32798.4088; train_chrom_access_recon_loss: 3914673.0401; train_global_loss: 24487651.4809; train_optim_loss: 24487651.4809; val_kl_reg_loss: 75132.2849; val_edge_recon_loss: 2722800.8500; val_gene_expr_recon_loss: 17382728.0000; val_masked_gp_l1_reg_loss: 95586.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32902.3203; val_chrom_access_recon_loss: 3833937.6167; val_global_loss: 24143086.8000; val_optim_loss: 24143086.8000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9667; val_auprc_score: 0.9587; val_best_acc_score: 0.9150; val_best_f1_score: 0.9163; train_kl_reg_loss: 74402.3825; train_edge_recon_loss: 2688942.2118; train_gene_expr_recon_loss: 17633262.6107; train_masked_gp_l1_reg_loss: 96009.2770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32652.2073; train_chrom_access_recon_loss: 3902430.8244; train_global_loss: 24427699.5267; train_optim_loss: 24427699.5267; val_kl_reg_loss: 75232.1490; val_edge_recon_loss: 2717771.3500; val_gene_expr_recon_loss: 17373329.4000; val_masked_gp_l1_reg_loss: 96365.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32507.1328; val_chrom_access_recon_loss: 3820190.3667; val_global_loss: 24115397.6000; val_optim_loss: 24115397.6000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9662; val_auprc_score: 0.9576; val_best_acc_score: 0.9128; val_best_f1_score: 0.9168; train_kl_reg_loss: 74037.5161; train_edge_recon_loss: 2691692.8397; train_gene_expr_recon_loss: 17578712.5802; train_masked_gp_l1_reg_loss: 96812.5313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32279.9897; train_chrom_access_recon_loss: 3893263.8149; train_global_loss: 24366799.1298; train_optim_loss: 24366799.1298; val_kl_reg_loss: 72267.3141; val_edge_recon_loss: 2716006.4167; val_gene_expr_recon_loss: 17314507.6667; val_masked_gp_l1_reg_loss: 97249.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32188.0488; val_chrom_access_recon_loss: 3819599.5500; val_global_loss: 24051819.0667; val_optim_loss: 24051819.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9708; val_auprc_score: 0.9642; val_best_acc_score: 0.9206; val_best_f1_score: 0.9236; train_kl_reg_loss: 72083.8409; train_edge_recon_loss: 2698008.7500; train_gene_expr_recon_loss: 17540429.4580; train_masked_gp_l1_reg_loss: 97798.7275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32282.9480; train_chrom_access_recon_loss: 3884002.7214; train_global_loss: 24324606.4580; train_optim_loss: 24324606.4580; val_kl_reg_loss: 71153.9333; val_edge_recon_loss: 2709429.1500; val_gene_expr_recon_loss: 17324878.4667; val_masked_gp_l1_reg_loss: 98211.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32471.1484; val_chrom_access_recon_loss: 3809650.4833; val_global_loss: 24045795.6000; val_optim_loss: 24045795.6000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9718; val_auprc_score: 0.9643; val_best_acc_score: 0.9188; val_best_f1_score: 0.9228; train_kl_reg_loss: 71447.1571; train_edge_recon_loss: 2694433.7557; train_gene_expr_recon_loss: 17490546.0305; train_masked_gp_l1_reg_loss: 98636.3547; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32350.4454; train_chrom_access_recon_loss: 3871852.2443; train_global_loss: 24259265.8626; train_optim_loss: 24259265.8626; val_kl_reg_loss: 70288.3432; val_edge_recon_loss: 2705495.6500; val_gene_expr_recon_loss: 17257960.7333; val_masked_gp_l1_reg_loss: 99002.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32346.2285; val_chrom_access_recon_loss: 3798978.8333; val_global_loss: 23964071.4667; val_optim_loss: 23964071.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9687; val_auprc_score: 0.9612; val_best_acc_score: 0.9157; val_best_f1_score: 0.9191; train_kl_reg_loss: 71392.7282; train_edge_recon_loss: 2686172.9160; train_gene_expr_recon_loss: 17466723.9771; train_masked_gp_l1_reg_loss: 99476.9014; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32435.5544; train_chrom_access_recon_loss: 3867389.7385; train_global_loss: 24223591.7863; train_optim_loss: 24223591.7863; val_kl_reg_loss: 70517.8854; val_edge_recon_loss: 2706648.3833; val_gene_expr_recon_loss: 17183997.8667; val_masked_gp_l1_reg_loss: 100030.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32635.3145; val_chrom_access_recon_loss: 3784461.4667; val_global_loss: 23878292.0000; val_optim_loss: 23878292.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9728; val_auprc_score: 0.9669; val_best_acc_score: 0.9221; val_best_f1_score: 0.9245; train_kl_reg_loss: 70420.2361; train_edge_recon_loss: 2687951.0115; train_gene_expr_recon_loss: 17431939.0534; train_masked_gp_l1_reg_loss: 100345.4461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32630.8215; train_chrom_access_recon_loss: 3860287.7233; train_global_loss: 24183574.2748; train_optim_loss: 24183574.2748; val_kl_reg_loss: 69297.6359; val_edge_recon_loss: 2703576.0000; val_gene_expr_recon_loss: 17172902.3333; val_masked_gp_l1_reg_loss: 100959.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32908.8125; val_chrom_access_recon_loss: 3782197.6500; val_global_loss: 23861841.7333; val_optim_loss: 23861841.7333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9714; val_auprc_score: 0.9638; val_best_acc_score: 0.9206; val_best_f1_score: 0.9231; train_kl_reg_loss: 70047.1685; train_edge_recon_loss: 2683178.3626; train_gene_expr_recon_loss: 17395809.3740; train_masked_gp_l1_reg_loss: 101301.1232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32971.8952; train_chrom_access_recon_loss: 3851366.5458; train_global_loss: 24134674.4427; train_optim_loss: 24134674.4427; val_kl_reg_loss: 69670.0396; val_edge_recon_loss: 2710707.4000; val_gene_expr_recon_loss: 17125162.9333; val_masked_gp_l1_reg_loss: 101683.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32678.9062; val_chrom_access_recon_loss: 3779063.0667; val_global_loss: 23818965.2000; val_optim_loss: 23818965.2000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9770; val_auprc_score: 0.9707; val_best_acc_score: 0.9313; val_best_f1_score: 0.9331; train_kl_reg_loss: 73442.1135; train_edge_recon_loss: 2715520.6069; train_gene_expr_recon_loss: 16963035.7710; train_masked_gp_l1_reg_loss: 99978.3339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26741.8369; train_chrom_access_recon_loss: 3777442.0706; train_global_loss: 23656160.8244; train_optim_loss: 23656160.8244; val_kl_reg_loss: 47931.9359; val_edge_recon_loss: 2691022.1000; val_gene_expr_recon_loss: 16681436.6000; val_masked_gp_l1_reg_loss: 99510.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25579.9648; val_chrom_access_recon_loss: 3694657.7000; val_global_loss: 23240138.1333; val_optim_loss: 23240138.1333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9737; val_auprc_score: 0.9658; val_best_acc_score: 0.9256; val_best_f1_score: 0.9280; train_kl_reg_loss: 74815.0832; train_edge_recon_loss: 2692485.6813; train_gene_expr_recon_loss: 16816756.1145; train_masked_gp_l1_reg_loss: 99254.6087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25540.3369; train_chrom_access_recon_loss: 3747803.9580; train_global_loss: 23456655.9084; train_optim_loss: 23456655.9084; val_kl_reg_loss: 49981.5057; val_edge_recon_loss: 2716474.8500; val_gene_expr_recon_loss: 16582714.3333; val_masked_gp_l1_reg_loss: 99120.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25530.1250; val_chrom_access_recon_loss: 3684223.8500; val_global_loss: 23158045.2000; val_optim_loss: 23158045.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9736; val_auprc_score: 0.9641; val_best_acc_score: 0.9255; val_best_f1_score: 0.9278; train_kl_reg_loss: 72253.9471; train_edge_recon_loss: 2679929.7863; train_gene_expr_recon_loss: 16754027.3206; train_masked_gp_l1_reg_loss: 98927.3378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25588.4402; train_chrom_access_recon_loss: 3737395.9637; train_global_loss: 23368122.7176; train_optim_loss: 23368122.7176; val_kl_reg_loss: 51672.2057; val_edge_recon_loss: 2703268.0500; val_gene_expr_recon_loss: 16514302.3333; val_masked_gp_l1_reg_loss: 98757.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25514.9160; val_chrom_access_recon_loss: 3685310.7667; val_global_loss: 23078825.8667; val_optim_loss: 23078825.8667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9747; val_auprc_score: 0.9645; val_best_acc_score: 0.9247; val_best_f1_score: 0.9272; train_kl_reg_loss: 69374.7335; train_edge_recon_loss: 2677172.2844; train_gene_expr_recon_loss: 16696446.1450; train_masked_gp_l1_reg_loss: 98559.1923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25562.9024; train_chrom_access_recon_loss: 3711071.3607; train_global_loss: 23278186.4580; train_optim_loss: 23278186.4580; val_kl_reg_loss: 53729.1875; val_edge_recon_loss: 2684295.8167; val_gene_expr_recon_loss: 16488154.3333; val_masked_gp_l1_reg_loss: 98397.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25561.6152; val_chrom_access_recon_loss: 3633225.0333; val_global_loss: 22983364.2667; val_optim_loss: 22983364.2667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9736; val_auprc_score: 0.9670; val_best_acc_score: 0.9258; val_best_f1_score: 0.9276; train_kl_reg_loss: 67047.6254; train_edge_recon_loss: 2679834.3874; train_gene_expr_recon_loss: 16641150.4504; train_masked_gp_l1_reg_loss: 98299.3820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25589.6714; train_chrom_access_recon_loss: 3699623.1603; train_global_loss: 23211544.7786; train_optim_loss: 23211544.7786; val_kl_reg_loss: 54058.5826; val_edge_recon_loss: 2700683.1667; val_gene_expr_recon_loss: 16346097.5333; val_masked_gp_l1_reg_loss: 98212.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25573.9844; val_chrom_access_recon_loss: 3620097.9167; val_global_loss: 22844723.2000; val_optim_loss: 22844723.2000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9729; val_auprc_score: 0.9617; val_best_acc_score: 0.9270; val_best_f1_score: 0.9287; train_kl_reg_loss: 65192.9884; train_edge_recon_loss: 2676267.9122; train_gene_expr_recon_loss: 16586122.0076; train_masked_gp_l1_reg_loss: 98052.6105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25589.0022; train_chrom_access_recon_loss: 3690243.6240; train_global_loss: 23141468.1374; train_optim_loss: 23141468.1374; val_kl_reg_loss: 52672.5682; val_edge_recon_loss: 2693349.3167; val_gene_expr_recon_loss: 16384875.4667; val_masked_gp_l1_reg_loss: 97959.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25679.0684; val_chrom_access_recon_loss: 3610902.0000; val_global_loss: 22865439.6000; val_optim_loss: 22865439.6000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9764; val_auprc_score: 0.9704; val_best_acc_score: 0.9297; val_best_f1_score: 0.9313; train_kl_reg_loss: 63149.0850; train_edge_recon_loss: 2675758.4313; train_gene_expr_recon_loss: 16538037.8473; train_masked_gp_l1_reg_loss: 97961.5689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25667.4772; train_chrom_access_recon_loss: 3672502.0019; train_global_loss: 23073076.4275; train_optim_loss: 23073076.4275; val_kl_reg_loss: 51999.4982; val_edge_recon_loss: 2689813.4000; val_gene_expr_recon_loss: 16288281.0667; val_masked_gp_l1_reg_loss: 98043.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25653.7598; val_chrom_access_recon_loss: 3590394.6833; val_global_loss: 22744186.6667; val_optim_loss: 22744186.6667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9753; val_auprc_score: 0.9682; val_best_acc_score: 0.9302; val_best_f1_score: 0.9325; train_kl_reg_loss: 63354.6933; train_edge_recon_loss: 2671476.4103; train_gene_expr_recon_loss: 16502836.3435; train_masked_gp_l1_reg_loss: 97847.8271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25670.4331; train_chrom_access_recon_loss: 3663727.4695; train_global_loss: 23024913.1908; train_optim_loss: 23024913.1908; val_kl_reg_loss: 53727.1104; val_edge_recon_loss: 2695337.3333; val_gene_expr_recon_loss: 16316238.9333; val_masked_gp_l1_reg_loss: 97723.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25656.6230; val_chrom_access_recon_loss: 3601470.7667; val_global_loss: 22790153.6000; val_optim_loss: 22790153.6000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9777; val_auprc_score: 0.9720; val_best_acc_score: 0.9340; val_best_f1_score: 0.9360; train_kl_reg_loss: 61709.4525; train_edge_recon_loss: 2676085.7653; train_gene_expr_recon_loss: 16474774.7786; train_masked_gp_l1_reg_loss: 97626.0106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25658.5413; train_chrom_access_recon_loss: 3661701.6011; train_global_loss: 22997556.1069; train_optim_loss: 22997556.1069; val_kl_reg_loss: 53576.9570; val_edge_recon_loss: 2684559.9000; val_gene_expr_recon_loss: 16347651.9333; val_masked_gp_l1_reg_loss: 97509.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25651.4004; val_chrom_access_recon_loss: 3620814.7000; val_global_loss: 22829765.6000; val_optim_loss: 22829765.6000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9766; val_auprc_score: 0.9713; val_best_acc_score: 0.9287; val_best_f1_score: 0.9310; train_kl_reg_loss: 60879.1673; train_edge_recon_loss: 2674844.7901; train_gene_expr_recon_loss: 16453613.2824; train_masked_gp_l1_reg_loss: 97469.4248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25732.8092; train_chrom_access_recon_loss: 3657424.1317; train_global_loss: 22969963.6489; train_optim_loss: 22969963.6489; val_kl_reg_loss: 55451.1349; val_edge_recon_loss: 2691562.4833; val_gene_expr_recon_loss: 16241006.7333; val_masked_gp_l1_reg_loss: 97416.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25693.2656; val_chrom_access_recon_loss: 3586327.0000; val_global_loss: 22697457.0667; val_optim_loss: 22697457.0667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9766; val_auprc_score: 0.9685; val_best_acc_score: 0.9332; val_best_f1_score: 0.9348; train_kl_reg_loss: 60463.8116; train_edge_recon_loss: 2671233.7271; train_gene_expr_recon_loss: 16419881.3817; train_masked_gp_l1_reg_loss: 97333.8745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25726.1873; train_chrom_access_recon_loss: 3643258.8263; train_global_loss: 22917897.9084; train_optim_loss: 22917897.9084; val_kl_reg_loss: 53642.7086; val_edge_recon_loss: 2682640.7000; val_gene_expr_recon_loss: 16231201.9333; val_masked_gp_l1_reg_loss: 97251.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25675.7207; val_chrom_access_recon_loss: 3569626.7333; val_global_loss: 22660039.7333; val_optim_loss: 22660039.7333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9814; val_auprc_score: 0.9756; val_best_acc_score: 0.9378; val_best_f1_score: 0.9394; train_kl_reg_loss: 59619.6216; train_edge_recon_loss: 2670089.7214; train_gene_expr_recon_loss: 16403255.0000; train_masked_gp_l1_reg_loss: 97294.7607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25709.8176; train_chrom_access_recon_loss: 3642397.8683; train_global_loss: 22898366.9466; train_optim_loss: 22898366.9466; val_kl_reg_loss: 54073.0151; val_edge_recon_loss: 2670866.1500; val_gene_expr_recon_loss: 16227094.8667; val_masked_gp_l1_reg_loss: 97222.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25636.5879; val_chrom_access_recon_loss: 3585579.5833; val_global_loss: 22660471.7333; val_optim_loss: 22660471.7333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9783; val_auprc_score: 0.9695; val_best_acc_score: 0.9333; val_best_f1_score: 0.9342; train_kl_reg_loss: 59174.5657; train_edge_recon_loss: 2667288.7729; train_gene_expr_recon_loss: 16357671.7939; train_masked_gp_l1_reg_loss: 97198.8489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25736.3711; train_chrom_access_recon_loss: 3633188.5744; train_global_loss: 22840258.8855; train_optim_loss: 22840258.8855; val_kl_reg_loss: 54261.0813; val_edge_recon_loss: 2678390.8667; val_gene_expr_recon_loss: 16120605.8667; val_masked_gp_l1_reg_loss: 97105.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25710.0645; val_chrom_access_recon_loss: 3558344.4500; val_global_loss: 22534418.2667; val_optim_loss: 22534418.2667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9789; val_auprc_score: 0.9725; val_best_acc_score: 0.9330; val_best_f1_score: 0.9351; train_kl_reg_loss: 58838.3809; train_edge_recon_loss: 2661584.6813; train_gene_expr_recon_loss: 16340332.6107; train_masked_gp_l1_reg_loss: 97085.5170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25714.9547; train_chrom_access_recon_loss: 3624132.2366; train_global_loss: 22807688.3511; train_optim_loss: 22807688.3511; val_kl_reg_loss: 52195.1102; val_edge_recon_loss: 2691595.7167; val_gene_expr_recon_loss: 16177303.6000; val_masked_gp_l1_reg_loss: 97078.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25768.0176; val_chrom_access_recon_loss: 3567772.6667; val_global_loss: 22611712.9333; val_optim_loss: 22611712.9333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9745; val_auprc_score: 0.9644; val_best_acc_score: 0.9303; val_best_f1_score: 0.9324; train_kl_reg_loss: 58537.1949; train_edge_recon_loss: 2674266.9275; train_gene_expr_recon_loss: 16298209.1450; train_masked_gp_l1_reg_loss: 97068.2536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25773.2019; train_chrom_access_recon_loss: 3621413.5706; train_global_loss: 22775268.2443; train_optim_loss: 22775268.2443; val_kl_reg_loss: 53524.3977; val_edge_recon_loss: 2699325.1167; val_gene_expr_recon_loss: 16098046.9333; val_masked_gp_l1_reg_loss: 97068.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25798.1484; val_chrom_access_recon_loss: 3547368.4500; val_global_loss: 22521130.6667; val_optim_loss: 22521130.6667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9798; val_auprc_score: 0.9740; val_best_acc_score: 0.9325; val_best_f1_score: 0.9342; train_kl_reg_loss: 58801.3152; train_edge_recon_loss: 2664939.9828; train_gene_expr_recon_loss: 16271200.2824; train_masked_gp_l1_reg_loss: 97047.9260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25789.1996; train_chrom_access_recon_loss: 3614676.1202; train_global_loss: 22732454.8092; train_optim_loss: 22732454.8092; val_kl_reg_loss: 52292.6349; val_edge_recon_loss: 2676672.8333; val_gene_expr_recon_loss: 16034874.2667; val_masked_gp_l1_reg_loss: 96976.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25727.8320; val_chrom_access_recon_loss: 3540961.6667; val_global_loss: 22427505.3333; val_optim_loss: 22427505.3333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9824; val_auprc_score: 0.9772; val_best_acc_score: 0.9383; val_best_f1_score: 0.9398; train_kl_reg_loss: 58112.4640; train_edge_recon_loss: 2666794.9332; train_gene_expr_recon_loss: 16250277.8015; train_masked_gp_l1_reg_loss: 97034.6740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25789.1513; train_chrom_access_recon_loss: 3608294.9580; train_global_loss: 22706303.8779; train_optim_loss: 22706303.8779; val_kl_reg_loss: 53266.9396; val_edge_recon_loss: 2672608.7000; val_gene_expr_recon_loss: 16059241.9333; val_masked_gp_l1_reg_loss: 97020.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25777.5391; val_chrom_access_recon_loss: 3542834.3667; val_global_loss: 22450749.8667; val_optim_loss: 22450749.8667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9807; val_auprc_score: 0.9738; val_best_acc_score: 0.9369; val_best_f1_score: 0.9385; train_kl_reg_loss: 57648.0320; train_edge_recon_loss: 2671839.9408; train_gene_expr_recon_loss: 16228702.1069; train_masked_gp_l1_reg_loss: 97069.1410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25820.0080; train_chrom_access_recon_loss: 3604292.0229; train_global_loss: 22685371.0534; train_optim_loss: 22685371.0534; val_kl_reg_loss: 53141.1065; val_edge_recon_loss: 2677600.8000; val_gene_expr_recon_loss: 16062966.2000; val_masked_gp_l1_reg_loss: 97034.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25735.2500; val_chrom_access_recon_loss: 3539805.9000; val_global_loss: 22456283.7333; val_optim_loss: 22456283.7333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9805; val_auprc_score: 0.9735; val_best_acc_score: 0.9387; val_best_f1_score: 0.9405; train_kl_reg_loss: 57263.1775; train_edge_recon_loss: 2668540.8378; train_gene_expr_recon_loss: 16223553.7023; train_masked_gp_l1_reg_loss: 97106.7426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25816.7600; train_chrom_access_recon_loss: 3607883.8321; train_global_loss: 22680165.2061; train_optim_loss: 22680165.2061; val_kl_reg_loss: 54183.6393; val_edge_recon_loss: 2668694.4000; val_gene_expr_recon_loss: 16004874.3333; val_masked_gp_l1_reg_loss: 97089.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25742.1211; val_chrom_access_recon_loss: 3538848.0667; val_global_loss: 22389432.1333; val_optim_loss: 22389432.1333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9796; val_auprc_score: 0.9742; val_best_acc_score: 0.9359; val_best_f1_score: 0.9376; train_kl_reg_loss: 57314.5256; train_edge_recon_loss: 2663107.6966; train_gene_expr_recon_loss: 16205598.6107; train_masked_gp_l1_reg_loss: 97180.8304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25788.9236; train_chrom_access_recon_loss: 3605924.0019; train_global_loss: 22654914.5344; train_optim_loss: 22654914.5344; val_kl_reg_loss: 53937.9753; val_edge_recon_loss: 2686755.1667; val_gene_expr_recon_loss: 16041359.2667; val_masked_gp_l1_reg_loss: 97236.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25712.8203; val_chrom_access_recon_loss: 3546681.9167; val_global_loss: 22451681.8667; val_optim_loss: 22451681.8667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9829; val_auprc_score: 0.9766; val_best_acc_score: 0.9422; val_best_f1_score: 0.9437; train_kl_reg_loss: 57729.2746; train_edge_recon_loss: 2661045.6527; train_gene_expr_recon_loss: 16173946.8473; train_masked_gp_l1_reg_loss: 97304.7879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25815.1997; train_chrom_access_recon_loss: 3595513.7080; train_global_loss: 22611355.3740; train_optim_loss: 22611355.3740; val_kl_reg_loss: 55871.3654; val_edge_recon_loss: 2677765.0667; val_gene_expr_recon_loss: 16077118.5333; val_masked_gp_l1_reg_loss: 97284.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25821.9121; val_chrom_access_recon_loss: 3545376.2667; val_global_loss: 22479236.9333; val_optim_loss: 22479236.9333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9861; val_auprc_score: 0.9834; val_best_acc_score: 0.9453; val_best_f1_score: 0.9461; train_kl_reg_loss: 57341.7274; train_edge_recon_loss: 2658871.0973; train_gene_expr_recon_loss: 16168108.5878; train_masked_gp_l1_reg_loss: 97378.1292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25866.7943; train_chrom_access_recon_loss: 3596482.2996; train_global_loss: 22604048.6107; train_optim_loss: 22604048.6107; val_kl_reg_loss: 55654.5281; val_edge_recon_loss: 2670549.6167; val_gene_expr_recon_loss: 16066290.9333; val_masked_gp_l1_reg_loss: 97435.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25768.9941; val_chrom_access_recon_loss: 3559273.8000; val_global_loss: 22474972.6667; val_optim_loss: 22474972.6667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9802; val_auprc_score: 0.9746; val_best_acc_score: 0.9375; val_best_f1_score: 0.9394; train_kl_reg_loss: 56971.5235; train_edge_recon_loss: 2664510.7481; train_gene_expr_recon_loss: 16154095.9771; train_masked_gp_l1_reg_loss: 97481.6896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25828.8354; train_chrom_access_recon_loss: 3596619.5439; train_global_loss: 22595508.1679; train_optim_loss: 22595508.1679; val_kl_reg_loss: 55224.2997; val_edge_recon_loss: 2695706.1833; val_gene_expr_recon_loss: 16006370.2667; val_masked_gp_l1_reg_loss: 97545.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25863.4980; val_chrom_access_recon_loss: 3551319.4167; val_global_loss: 22432029.8667; val_optim_loss: 22432029.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9821; val_auprc_score: 0.9781; val_best_acc_score: 0.9383; val_best_f1_score: 0.9395; train_kl_reg_loss: 57961.5556; train_edge_recon_loss: 2658875.5324; train_gene_expr_recon_loss: 16128551.1679; train_masked_gp_l1_reg_loss: 96881.4338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23888.6857; train_chrom_access_recon_loss: 3597531.0115; train_global_loss: 22563689.4046; train_optim_loss: 22563689.4046; val_kl_reg_loss: 56295.4755; val_edge_recon_loss: 2672610.2500; val_gene_expr_recon_loss: 15967767.9333; val_masked_gp_l1_reg_loss: 96647.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23521.5781; val_chrom_access_recon_loss: 3519679.9000; val_global_loss: 22336523.7333; val_optim_loss: 22336523.7333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9821; val_auprc_score: 0.9779; val_best_acc_score: 0.9404; val_best_f1_score: 0.9417; train_kl_reg_loss: 58388.5466; train_edge_recon_loss: 2658298.6221; train_gene_expr_recon_loss: 16122049.0534; train_masked_gp_l1_reg_loss: 96578.8602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23391.4581; train_chrom_access_recon_loss: 3589471.6031; train_global_loss: 22548178.1527; train_optim_loss: 22548178.1527; val_kl_reg_loss: 56399.3013; val_edge_recon_loss: 2693818.3500; val_gene_expr_recon_loss: 16010520.3333; val_masked_gp_l1_reg_loss: 96528.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23261.7715; val_chrom_access_recon_loss: 3531381.7000; val_global_loss: 22411909.7333; val_optim_loss: 22411909.7333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9818; val_auprc_score: 0.9773; val_best_acc_score: 0.9386; val_best_f1_score: 0.9399; train_kl_reg_loss: 58651.5782; train_edge_recon_loss: 2656131.3664; train_gene_expr_recon_loss: 16111864.5496; train_masked_gp_l1_reg_loss: 96505.7124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23172.0027; train_chrom_access_recon_loss: 3590640.2882; train_global_loss: 22536965.6031; train_optim_loss: 22536965.6031; val_kl_reg_loss: 56409.8034; val_edge_recon_loss: 2676595.1500; val_gene_expr_recon_loss: 15999088.7333; val_masked_gp_l1_reg_loss: 96477.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23070.1406; val_chrom_access_recon_loss: 3533311.1500; val_global_loss: 22384952.9333; val_optim_loss: 22384952.9333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9842; val_auprc_score: 0.9799; val_best_acc_score: 0.9458; val_best_f1_score: 0.9467; train_kl_reg_loss: 58768.1513; train_edge_recon_loss: 2658588.1298; train_gene_expr_recon_loss: 16110773.7634; train_masked_gp_l1_reg_loss: 96473.5226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23004.3194; train_chrom_access_recon_loss: 3589879.6393; train_global_loss: 22537487.5725; train_optim_loss: 22537487.5725; val_kl_reg_loss: 56877.2195; val_edge_recon_loss: 2669048.7333; val_gene_expr_recon_loss: 15981699.8000; val_masked_gp_l1_reg_loss: 96473.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22927.6074; val_chrom_access_recon_loss: 3523943.8500; val_global_loss: 22350971.7333; val_optim_loss: 22350971.7333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9822; val_auprc_score: 0.9772; val_best_acc_score: 0.9409; val_best_f1_score: 0.9424; train_kl_reg_loss: 58685.2114; train_edge_recon_loss: 2658555.7939; train_gene_expr_recon_loss: 16121460.0992; train_masked_gp_l1_reg_loss: 96456.9746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22863.2429; train_chrom_access_recon_loss: 3593203.2920; train_global_loss: 22551224.8855; train_optim_loss: 22551224.8855; val_kl_reg_loss: 56527.3083; val_edge_recon_loss: 2664409.0833; val_gene_expr_recon_loss: 15926083.4667; val_masked_gp_l1_reg_loss: 96458.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22799.1387; val_chrom_access_recon_loss: 3539773.6833; val_global_loss: 22306051.8667; val_optim_loss: 22306051.8667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9835; val_auprc_score: 0.9782; val_best_acc_score: 0.9430; val_best_f1_score: 0.9446; train_kl_reg_loss: 58710.8259; train_edge_recon_loss: 2659803.6183; train_gene_expr_recon_loss: 16112317.6489; train_masked_gp_l1_reg_loss: 96465.8049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22749.0640; train_chrom_access_recon_loss: 3591639.0076; train_global_loss: 22541686.0000; train_optim_loss: 22541686.0000; val_kl_reg_loss: 56604.7682; val_edge_recon_loss: 2667089.8333; val_gene_expr_recon_loss: 15943171.1333; val_masked_gp_l1_reg_loss: 96466.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22688.2031; val_chrom_access_recon_loss: 3534034.5833; val_global_loss: 22320054.2667; val_optim_loss: 22320054.2667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9829; val_auprc_score: 0.9770; val_best_acc_score: 0.9430; val_best_f1_score: 0.9442; train_kl_reg_loss: 58606.4461; train_edge_recon_loss: 2658188.9160; train_gene_expr_recon_loss: 16114727.2137; train_masked_gp_l1_reg_loss: 96477.7584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22648.5071; train_chrom_access_recon_loss: 3588774.3607; train_global_loss: 22539423.4809; train_optim_loss: 22539423.4809; val_kl_reg_loss: 56564.5237; val_edge_recon_loss: 2673536.0333; val_gene_expr_recon_loss: 16014200.1333; val_masked_gp_l1_reg_loss: 96478.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22586.5273; val_chrom_access_recon_loss: 3528323.4000; val_global_loss: 22391688.0000; val_optim_loss: 22391688.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9818; val_auprc_score: 0.9724; val_best_acc_score: 0.9435; val_best_f1_score: 0.9449; train_kl_reg_loss: 58749.0386; train_edge_recon_loss: 2655636.5363; train_gene_expr_recon_loss: 16103074.1527; train_masked_gp_l1_reg_loss: 96482.9396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22541.3140; train_chrom_access_recon_loss: 3588869.8053; train_global_loss: 22525353.9237; train_optim_loss: 22525353.9237; val_kl_reg_loss: 57026.8174; val_edge_recon_loss: 2675197.6000; val_gene_expr_recon_loss: 16026591.6667; val_masked_gp_l1_reg_loss: 96491.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22475.8281; val_chrom_access_recon_loss: 3541226.6333; val_global_loss: 22419010.9333; val_optim_loss: 22419010.9333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9818; val_auprc_score: 0.9754; val_best_acc_score: 0.9409; val_best_f1_score: 0.9422; train_kl_reg_loss: 58741.3770; train_edge_recon_loss: 2649417.8836; train_gene_expr_recon_loss: 16105691.0992; train_masked_gp_l1_reg_loss: 96511.2996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22453.3790; train_chrom_access_recon_loss: 3589492.5630; train_global_loss: 22522307.7405; train_optim_loss: 22522307.7405; val_kl_reg_loss: 56570.0909; val_edge_recon_loss: 2688125.0167; val_gene_expr_recon_loss: 15923646.0000; val_masked_gp_l1_reg_loss: 96511.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22380.0137; val_chrom_access_recon_loss: 3542476.8333; val_global_loss: 22329710.1333; val_optim_loss: 22329710.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9813; val_auprc_score: 0.9758; val_best_acc_score: 0.9414; val_best_f1_score: 0.9426; train_kl_reg_loss: 58654.2184; train_edge_recon_loss: 2657023.2748; train_gene_expr_recon_loss: 16109214.4504; train_masked_gp_l1_reg_loss: 96442.0080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22186.1755; train_chrom_access_recon_loss: 3591717.5324; train_global_loss: 22535237.6336; train_optim_loss: 22535237.6336; val_kl_reg_loss: 57210.5456; val_edge_recon_loss: 2673767.6500; val_gene_expr_recon_loss: 16002890.5333; val_masked_gp_l1_reg_loss: 96414.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22158.8125; val_chrom_access_recon_loss: 3557938.1000; val_global_loss: 22410379.0667; val_optim_loss: 22410379.0667
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9825; val_auprc_score: 0.9734; val_best_acc_score: 0.9411; val_best_f1_score: 0.9427; train_kl_reg_loss: 58695.8009; train_edge_recon_loss: 2650630.5821; train_gene_expr_recon_loss: 16096722.2672; train_masked_gp_l1_reg_loss: 96404.5174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22148.9830; train_chrom_access_recon_loss: 3590090.4179; train_global_loss: 22514692.5954; train_optim_loss: 22514692.5954; val_kl_reg_loss: 56796.1815; val_edge_recon_loss: 2670328.7500; val_gene_expr_recon_loss: 15957299.5333; val_masked_gp_l1_reg_loss: 96393.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22138.5039; val_chrom_access_recon_loss: 3518380.9333; val_global_loss: 22321337.2000; val_optim_loss: 22321337.2000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9845; val_auprc_score: 0.9811; val_best_acc_score: 0.9418; val_best_f1_score: 0.9429; train_kl_reg_loss: 58781.6906; train_edge_recon_loss: 2661537.7156; train_gene_expr_recon_loss: 16095073.8931; train_masked_gp_l1_reg_loss: 96389.2885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22128.2517; train_chrom_access_recon_loss: 3588062.5763; train_global_loss: 22521973.5878; train_optim_loss: 22521973.5878; val_kl_reg_loss: 56875.9279; val_edge_recon_loss: 2665719.7333; val_gene_expr_recon_loss: 15997516.0667; val_masked_gp_l1_reg_loss: 96383.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22119.6602; val_chrom_access_recon_loss: 3534620.4667; val_global_loss: 22373236.0000; val_optim_loss: 22373236.0000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9830; val_auprc_score: 0.9779; val_best_acc_score: 0.9422; val_best_f1_score: 0.9434; train_kl_reg_loss: 58802.4815; train_edge_recon_loss: 2658128.9656; train_gene_expr_recon_loss: 16095209.6870; train_masked_gp_l1_reg_loss: 96381.1384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22111.9564; train_chrom_access_recon_loss: 3588505.1889; train_global_loss: 22519139.6183; train_optim_loss: 22519139.6183; val_kl_reg_loss: 56939.3635; val_edge_recon_loss: 2679078.3500; val_gene_expr_recon_loss: 15944837.3333; val_masked_gp_l1_reg_loss: 96377.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22103.5410; val_chrom_access_recon_loss: 3525795.3000; val_global_loss: 22325132.2667; val_optim_loss: 22325132.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 73 min 26 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9829
val AUPRC score: 0.9774
val best accuracy score: 0.9407
val best F1 score: 0.9419
val target rna MSE score: 1.1268
val source rna MSE score: 0.2647
val target atac MSE score: 0.4732
val source atac MSE score: 0.0748
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
