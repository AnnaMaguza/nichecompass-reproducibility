[True]
Run timestamp: 07082023_195040_81.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_81']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8594; val_auprc_score: 0.8836; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 30349.4862; train_edge_recon_loss: 352941.9410; train_gene_expr_recon_loss: 1285934.6528; train_masked_gp_l1_reg_loss: 16348.9004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167399.1806; train_chrom_access_recon_loss: 2558178.0139; train_global_loss: 4411152.1944; train_optim_loss: 4411152.1944; val_kl_reg_loss: 15701.2070; val_edge_recon_loss: 406589.3125; val_gene_expr_recon_loss: 1100585.7500; val_masked_gp_l1_reg_loss: 12311.4355; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163078.3438; val_chrom_access_recon_loss: 1745401.1250; val_global_loss: 3443667.0000; val_optim_loss: 3443667.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8722; val_auprc_score: 0.8920; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 13319.6510; train_edge_recon_loss: 356162.3507; train_gene_expr_recon_loss: 981298.3819; train_masked_gp_l1_reg_loss: 11037.6049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160446.8646; train_chrom_access_recon_loss: 1554239.8056; train_global_loss: 3076504.6667; train_optim_loss: 3076504.6667; val_kl_reg_loss: 11424.5850; val_edge_recon_loss: 406584.7188; val_gene_expr_recon_loss: 872971.1250; val_masked_gp_l1_reg_loss: 10255.8740; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157235.8750; val_chrom_access_recon_loss: 1428378.3750; val_global_loss: 2886850.5000; val_optim_loss: 2886850.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8757; val_auprc_score: 0.8914; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13535.8620; train_edge_recon_loss: 356876.1597; train_gene_expr_recon_loss: 839585.8819; train_masked_gp_l1_reg_loss: 10572.2524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154576.5694; train_chrom_access_recon_loss: 1407006.3056; train_global_loss: 2782153.0556; train_optim_loss: 2782153.0556; val_kl_reg_loss: 15465.2959; val_edge_recon_loss: 406594.1562; val_gene_expr_recon_loss: 791928.0625; val_masked_gp_l1_reg_loss: 10848.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151075.8438; val_chrom_access_recon_loss: 1388933.6250; val_global_loss: 2764845.5000; val_optim_loss: 2764845.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8688; val_auprc_score: 0.8883; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 17146.3065; train_edge_recon_loss: 358929.7639; train_gene_expr_recon_loss: 787430.5139; train_masked_gp_l1_reg_loss: 10788.4944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147923.2031; train_chrom_access_recon_loss: 1379236.5833; train_global_loss: 2701454.8611; train_optim_loss: 2701454.8611; val_kl_reg_loss: 17417.5000; val_edge_recon_loss: 406591.9375; val_gene_expr_recon_loss: 757953.7500; val_masked_gp_l1_reg_loss: 10716.2402; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143776.1094; val_chrom_access_recon_loss: 1365964.7500; val_global_loss: 2702420.5000; val_optim_loss: 2702420.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8767; val_auprc_score: 0.8921; val_best_acc_score: 0.5024; val_best_f1_score: 0.6677; train_kl_reg_loss: 18863.0260; train_edge_recon_loss: 359450.7743; train_gene_expr_recon_loss: 756725.9375; train_masked_gp_l1_reg_loss: 10678.6538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140236.2517; train_chrom_access_recon_loss: 1364781.2222; train_global_loss: 2650735.9167; train_optim_loss: 2650735.9167; val_kl_reg_loss: 18999.9883; val_edge_recon_loss: 406570.3125; val_gene_expr_recon_loss: 736220.5000; val_masked_gp_l1_reg_loss: 10598.6924; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135728.8438; val_chrom_access_recon_loss: 1352405.8750; val_global_loss: 2660524.2500; val_optim_loss: 2660524.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8748; val_auprc_score: 0.8824; val_best_acc_score: 0.5120; val_best_f1_score: 0.6720; train_kl_reg_loss: 20025.9447; train_edge_recon_loss: 359453.8819; train_gene_expr_recon_loss: 736963.9653; train_masked_gp_l1_reg_loss: 10527.5272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132064.3932; train_chrom_access_recon_loss: 1350492.9861; train_global_loss: 2609528.6667; train_optim_loss: 2609528.6667; val_kl_reg_loss: 20540.7070; val_edge_recon_loss: 406517.8750; val_gene_expr_recon_loss: 718515.3125; val_masked_gp_l1_reg_loss: 10433.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127486.0312; val_chrom_access_recon_loss: 1343342.2500; val_global_loss: 2626835.5000; val_optim_loss: 2626835.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8631; val_auprc_score: 0.8652; val_best_acc_score: 0.5225; val_best_f1_score: 0.6765; train_kl_reg_loss: 21152.0436; train_edge_recon_loss: 360150.7986; train_gene_expr_recon_loss: 717755.2708; train_masked_gp_l1_reg_loss: 10364.7693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123842.7934; train_chrom_access_recon_loss: 1336029.9028; train_global_loss: 2569295.5556; train_optim_loss: 2569295.5556; val_kl_reg_loss: 22640.5742; val_edge_recon_loss: 406407.5312; val_gene_expr_recon_loss: 705423.1250; val_masked_gp_l1_reg_loss: 10268.5840; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119327.2500; val_chrom_access_recon_loss: 1336071.2500; val_global_loss: 2600138.5000; val_optim_loss: 2600138.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8632; val_auprc_score: 0.8622; val_best_acc_score: 0.5476; val_best_f1_score: 0.6858; train_kl_reg_loss: 21923.9835; train_edge_recon_loss: 360165.9479; train_gene_expr_recon_loss: 712602.7222; train_masked_gp_l1_reg_loss: 10197.5923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115796.2873; train_chrom_access_recon_loss: 1338418.9861; train_global_loss: 2559105.5000; train_optim_loss: 2559105.5000; val_kl_reg_loss: 21590.2988; val_edge_recon_loss: 406191.2188; val_gene_expr_recon_loss: 695550.7500; val_masked_gp_l1_reg_loss: 10100.6826; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111447.6953; val_chrom_access_recon_loss: 1330207.6250; val_global_loss: 2575088.2500; val_optim_loss: 2575088.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8573; val_auprc_score: 0.8607; val_best_acc_score: 0.5901; val_best_f1_score: 0.7045; train_kl_reg_loss: 22324.4681; train_edge_recon_loss: 359971.1736; train_gene_expr_recon_loss: 697095.9444; train_masked_gp_l1_reg_loss: 10053.8968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108097.0200; train_chrom_access_recon_loss: 1321643.9861; train_global_loss: 2519186.4444; train_optim_loss: 2519186.4444; val_kl_reg_loss: 23065.6133; val_edge_recon_loss: 405899.0312; val_gene_expr_recon_loss: 685324.4375; val_masked_gp_l1_reg_loss: 9976.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103990.2734; val_chrom_access_recon_loss: 1325498.6250; val_global_loss: 2553754.2500; val_optim_loss: 2553754.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8437; val_auprc_score: 0.8415; val_best_acc_score: 0.6500; val_best_f1_score: 0.7322; train_kl_reg_loss: 23507.5211; train_edge_recon_loss: 359742.9722; train_gene_expr_recon_loss: 689186.0208; train_masked_gp_l1_reg_loss: 9927.8863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100866.3750; train_chrom_access_recon_loss: 1322935.8750; train_global_loss: 2506166.6667; train_optim_loss: 2506166.6667; val_kl_reg_loss: 21556.0391; val_edge_recon_loss: 405396.8750; val_gene_expr_recon_loss: 678600.6250; val_masked_gp_l1_reg_loss: 9861.9277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97056.8906; val_chrom_access_recon_loss: 1320501.2500; val_global_loss: 2532973.5000; val_optim_loss: 2532973.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8311; val_auprc_score: 0.8293; val_best_acc_score: 0.6975; val_best_f1_score: 0.7538; train_kl_reg_loss: 23735.6810; train_edge_recon_loss: 359919.7431; train_gene_expr_recon_loss: 681302.7569; train_masked_gp_l1_reg_loss: 9822.2224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94188.5104; train_chrom_access_recon_loss: 1316350.1250; train_global_loss: 2485319.0556; train_optim_loss: 2485319.0556; val_kl_reg_loss: 21782.0898; val_edge_recon_loss: 404594.4062; val_gene_expr_recon_loss: 673361.0000; val_masked_gp_l1_reg_loss: 9765.4756; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90711.5469; val_chrom_access_recon_loss: 1316619.8750; val_global_loss: 2516834.5000; val_optim_loss: 2516834.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8259; val_auprc_score: 0.8181; val_best_acc_score: 0.7363; val_best_f1_score: 0.7680; train_kl_reg_loss: 23838.4976; train_edge_recon_loss: 359644.8750; train_gene_expr_recon_loss: 681076.2083; train_masked_gp_l1_reg_loss: 9727.7152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88113.3655; train_chrom_access_recon_loss: 1314275.4306; train_global_loss: 2476676.0833; train_optim_loss: 2476676.0833; val_kl_reg_loss: 21467.7891; val_edge_recon_loss: 403563.4688; val_gene_expr_recon_loss: 669352.6250; val_masked_gp_l1_reg_loss: 9680.4072; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84955.9375; val_chrom_access_recon_loss: 1312862.8750; val_global_loss: 2501883.0000; val_optim_loss: 2501883.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8203; val_auprc_score: 0.8174; val_best_acc_score: 0.7361; val_best_f1_score: 0.7511; train_kl_reg_loss: 23964.6688; train_edge_recon_loss: 359275.2569; train_gene_expr_recon_loss: 672287.7014; train_masked_gp_l1_reg_loss: 9667.1451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82594.6554; train_chrom_access_recon_loss: 1310146.9861; train_global_loss: 2457936.4722; train_optim_loss: 2457936.4722; val_kl_reg_loss: 21952.1406; val_edge_recon_loss: 402422.6562; val_gene_expr_recon_loss: 665252.1250; val_masked_gp_l1_reg_loss: 9634.0869; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79722.8281; val_chrom_access_recon_loss: 1309871.8750; val_global_loss: 2488856.0000; val_optim_loss: 2488856.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8247; val_auprc_score: 0.8173; val_best_acc_score: 0.7410; val_best_f1_score: 0.7376; train_kl_reg_loss: 23593.9397; train_edge_recon_loss: 358978.9479; train_gene_expr_recon_loss: 669769.9722; train_masked_gp_l1_reg_loss: 9618.0736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77577.9800; train_chrom_access_recon_loss: 1306438.1389; train_global_loss: 2445977.0278; train_optim_loss: 2445977.0278; val_kl_reg_loss: 23288.0117; val_edge_recon_loss: 400754.6875; val_gene_expr_recon_loss: 661897.3125; val_masked_gp_l1_reg_loss: 9585.8262; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74967.1797; val_chrom_access_recon_loss: 1307076.8750; val_global_loss: 2477570.0000; val_optim_loss: 2477570.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8281; val_auprc_score: 0.8203; val_best_acc_score: 0.7292; val_best_f1_score: 0.7554; train_kl_reg_loss: 23357.1821; train_edge_recon_loss: 358225.8646; train_gene_expr_recon_loss: 665185.4167; train_masked_gp_l1_reg_loss: 9568.7877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73009.4045; train_chrom_access_recon_loss: 1308301.3056; train_global_loss: 2437647.9444; train_optim_loss: 2437647.9444; val_kl_reg_loss: 22790.2422; val_edge_recon_loss: 398052.1875; val_gene_expr_recon_loss: 659594.4375; val_masked_gp_l1_reg_loss: 9541.7852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70630.6641; val_chrom_access_recon_loss: 1303925.2500; val_global_loss: 2464534.5000; val_optim_loss: 2464534.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8289; val_auprc_score: 0.8227; val_best_acc_score: 0.7264; val_best_f1_score: 0.7663; train_kl_reg_loss: 23026.8149; train_edge_recon_loss: 357162.3819; train_gene_expr_recon_loss: 666416.7917; train_masked_gp_l1_reg_loss: 9533.4326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68843.3247; train_chrom_access_recon_loss: 1301131.8056; train_global_loss: 2426114.5278; train_optim_loss: 2426114.5278; val_kl_reg_loss: 22049.1074; val_edge_recon_loss: 394586.8438; val_gene_expr_recon_loss: 657861.1250; val_masked_gp_l1_reg_loss: 9515.7822; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66669.8516; val_chrom_access_recon_loss: 1301834.0000; val_global_loss: 2452516.5000; val_optim_loss: 2452516.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8271; val_auprc_score: 0.8196; val_best_acc_score: 0.7370; val_best_f1_score: 0.7620; train_kl_reg_loss: 22597.6322; train_edge_recon_loss: 355739.1007; train_gene_expr_recon_loss: 665188.0347; train_masked_gp_l1_reg_loss: 9511.8155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65036.9813; train_chrom_access_recon_loss: 1303883.2083; train_global_loss: 2421956.7778; train_optim_loss: 2421956.7778; val_kl_reg_loss: 21079.2500; val_edge_recon_loss: 389298.6875; val_gene_expr_recon_loss: 656426.7500; val_masked_gp_l1_reg_loss: 9500.0693; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63049.6328; val_chrom_access_recon_loss: 1300129.5000; val_global_loss: 2439484.0000; val_optim_loss: 2439484.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8403; val_auprc_score: 0.8352; val_best_acc_score: 0.7524; val_best_f1_score: 0.7751; train_kl_reg_loss: 22124.3637; train_edge_recon_loss: 353417.6285; train_gene_expr_recon_loss: 664742.8056; train_masked_gp_l1_reg_loss: 9504.5518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61554.3711; train_chrom_access_recon_loss: 1305656.9583; train_global_loss: 2417000.6667; train_optim_loss: 2417000.6667; val_kl_reg_loss: 20602.6855; val_edge_recon_loss: 379012.6250; val_gene_expr_recon_loss: 655523.7500; val_masked_gp_l1_reg_loss: 9494.5928; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59719.6484; val_chrom_access_recon_loss: 1297946.7500; val_global_loss: 2422300.0000; val_optim_loss: 2422300.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8495; val_auprc_score: 0.8411; val_best_acc_score: 0.7637; val_best_f1_score: 0.7822; train_kl_reg_loss: 21458.9848; train_edge_recon_loss: 349458.1146; train_gene_expr_recon_loss: 659245.6250; train_masked_gp_l1_reg_loss: 9498.6848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58339.7396; train_chrom_access_recon_loss: 1293594.3056; train_global_loss: 2391595.5000; train_optim_loss: 2391595.5000; val_kl_reg_loss: 20371.8945; val_edge_recon_loss: 365825.2188; val_gene_expr_recon_loss: 654956.3750; val_masked_gp_l1_reg_loss: 9495.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56640.6562; val_chrom_access_recon_loss: 1296033.1250; val_global_loss: 2403322.5000; val_optim_loss: 2403322.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8530; val_auprc_score: 0.8485; val_best_acc_score: 0.7613; val_best_f1_score: 0.7808; train_kl_reg_loss: 21841.7819; train_edge_recon_loss: 340406.0833; train_gene_expr_recon_loss: 659922.4583; train_masked_gp_l1_reg_loss: 9498.3706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55364.4540; train_chrom_access_recon_loss: 1294621.6111; train_global_loss: 2381654.7222; train_optim_loss: 2381654.7222; val_kl_reg_loss: 22304.3652; val_edge_recon_loss: 346108.6562; val_gene_expr_recon_loss: 654499.7500; val_masked_gp_l1_reg_loss: 9509.0918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53801.0469; val_chrom_access_recon_loss: 1294524.5000; val_global_loss: 2380747.5000; val_optim_loss: 2380747.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8586; val_auprc_score: 0.8466; val_best_acc_score: 0.7668; val_best_f1_score: 0.7891; train_kl_reg_loss: 25707.3088; train_edge_recon_loss: 328611.8333; train_gene_expr_recon_loss: 662145.3611; train_masked_gp_l1_reg_loss: 9532.6822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52621.1280; train_chrom_access_recon_loss: 1293282.3056; train_global_loss: 2371900.6667; train_optim_loss: 2371900.6667; val_kl_reg_loss: 28471.5293; val_edge_recon_loss: 325784.4375; val_gene_expr_recon_loss: 653973.6250; val_masked_gp_l1_reg_loss: 9558.5527; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51172.4922; val_chrom_access_recon_loss: 1292359.2500; val_global_loss: 2361320.0000; val_optim_loss: 2361320.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8744; val_auprc_score: 0.8609; val_best_acc_score: 0.7868; val_best_f1_score: 0.8022; train_kl_reg_loss: 31062.6157; train_edge_recon_loss: 317540.5972; train_gene_expr_recon_loss: 659453.9514; train_masked_gp_l1_reg_loss: 9584.8459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50088.1311; train_chrom_access_recon_loss: 1294852.3750; train_global_loss: 2362582.4722; train_optim_loss: 2362582.4722; val_kl_reg_loss: 29623.6445; val_edge_recon_loss: 315913.8750; val_gene_expr_recon_loss: 653467.3750; val_masked_gp_l1_reg_loss: 9606.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48751.8594; val_chrom_access_recon_loss: 1290586.6250; val_global_loss: 2347950.2500; val_optim_loss: 2347950.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8904; val_auprc_score: 0.8766; val_best_acc_score: 0.8050; val_best_f1_score: 0.8151; train_kl_reg_loss: 30448.1990; train_edge_recon_loss: 314258.9514; train_gene_expr_recon_loss: 659444.6111; train_masked_gp_l1_reg_loss: 9635.5915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47758.0959; train_chrom_access_recon_loss: 1289542.5417; train_global_loss: 2351087.9722; train_optim_loss: 2351087.9722; val_kl_reg_loss: 28793.4805; val_edge_recon_loss: 311611.8438; val_gene_expr_recon_loss: 651605.8125; val_masked_gp_l1_reg_loss: 9661.7490; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46522.7344; val_chrom_access_recon_loss: 1288715.0000; val_global_loss: 2336910.5000; val_optim_loss: 2336910.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8985; val_auprc_score: 0.8785; val_best_acc_score: 0.8157; val_best_f1_score: 0.8303; train_kl_reg_loss: 29544.0725; train_edge_recon_loss: 311859.4271; train_gene_expr_recon_loss: 656857.1319; train_masked_gp_l1_reg_loss: 9688.1378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45586.1576; train_chrom_access_recon_loss: 1285173.0556; train_global_loss: 2338708.0000; train_optim_loss: 2338708.0000; val_kl_reg_loss: 29036.8594; val_edge_recon_loss: 308076.1250; val_gene_expr_recon_loss: 650637.6250; val_masked_gp_l1_reg_loss: 9719.4482; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44426.2031; val_chrom_access_recon_loss: 1286454.0000; val_global_loss: 2328350.2500; val_optim_loss: 2328350.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9127; val_auprc_score: 0.8949; val_best_acc_score: 0.8333; val_best_f1_score: 0.8445; train_kl_reg_loss: 29951.7148; train_edge_recon_loss: 307871.1771; train_gene_expr_recon_loss: 653655.4306; train_masked_gp_l1_reg_loss: 9737.7983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43548.3099; train_chrom_access_recon_loss: 1285152.0694; train_global_loss: 2329916.5000; train_optim_loss: 2329916.5000; val_kl_reg_loss: 29587.4648; val_edge_recon_loss: 306099.9375; val_gene_expr_recon_loss: 649349.1250; val_masked_gp_l1_reg_loss: 9750.6689; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42459.3047; val_chrom_access_recon_loss: 1284121.3750; val_global_loss: 2321368.0000; val_optim_loss: 2321368.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9166; val_auprc_score: 0.8998; val_best_acc_score: 0.8367; val_best_f1_score: 0.8483; train_kl_reg_loss: 27373.9811; train_edge_recon_loss: 335972.8125; train_gene_expr_recon_loss: 986553.5556; train_masked_gp_l1_reg_loss: 9863.3586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41429.1432; train_chrom_access_recon_loss: 1357501.3750; train_global_loss: 2758694.2500; train_optim_loss: 2758694.2500; val_kl_reg_loss: 9531.3477; val_edge_recon_loss: 321990.8438; val_gene_expr_recon_loss: 982567.1250; val_masked_gp_l1_reg_loss: 10103.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40042.0352; val_chrom_access_recon_loss: 1364059.8750; val_global_loss: 2728294.0000; val_optim_loss: 2728294.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9235; val_auprc_score: 0.9083; val_best_acc_score: 0.8473; val_best_f1_score: 0.8536; train_kl_reg_loss: 25726.7363; train_edge_recon_loss: 316455.3021; train_gene_expr_recon_loss: 982794.0069; train_masked_gp_l1_reg_loss: 10375.4463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38896.1003; train_chrom_access_recon_loss: 1353222.8750; train_global_loss: 2727470.4167; train_optim_loss: 2727470.4167; val_kl_reg_loss: 11832.7832; val_edge_recon_loss: 308961.1250; val_gene_expr_recon_loss: 976503.5625; val_masked_gp_l1_reg_loss: 10693.9932; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37489.5781; val_chrom_access_recon_loss: 1361553.3750; val_global_loss: 2707034.5000; val_optim_loss: 2707034.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9220; val_auprc_score: 0.9062; val_best_acc_score: 0.8453; val_best_f1_score: 0.8534; train_kl_reg_loss: 22986.0052; train_edge_recon_loss: 305435.5104; train_gene_expr_recon_loss: 980101.5972; train_masked_gp_l1_reg_loss: 10908.1890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36432.7995; train_chrom_access_recon_loss: 1353832.7778; train_global_loss: 2709696.9167; train_optim_loss: 2709696.9167; val_kl_reg_loss: 14529.5234; val_edge_recon_loss: 304085.6250; val_gene_expr_recon_loss: 969554.1250; val_masked_gp_l1_reg_loss: 11145.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35152.2617; val_chrom_access_recon_loss: 1358826.0000; val_global_loss: 2693293.0000; val_optim_loss: 2693293.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9211; val_auprc_score: 0.9051; val_best_acc_score: 0.8449; val_best_f1_score: 0.8532; train_kl_reg_loss: 22131.0069; train_edge_recon_loss: 301479.3090; train_gene_expr_recon_loss: 972974.6042; train_masked_gp_l1_reg_loss: 11290.8860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34199.6228; train_chrom_access_recon_loss: 1357013.8611; train_global_loss: 2699089.3333; train_optim_loss: 2699089.3333; val_kl_reg_loss: 16967.8555; val_edge_recon_loss: 300954.2812; val_gene_expr_recon_loss: 964210.8750; val_masked_gp_l1_reg_loss: 11456.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33056.0234; val_chrom_access_recon_loss: 1356380.8750; val_global_loss: 2683026.5000; val_optim_loss: 2683026.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9245; val_auprc_score: 0.9133; val_best_acc_score: 0.8444; val_best_f1_score: 0.8499; train_kl_reg_loss: 22426.8841; train_edge_recon_loss: 298171.1354; train_gene_expr_recon_loss: 969109.9444; train_masked_gp_l1_reg_loss: 11397.0164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32887.0812; train_chrom_access_recon_loss: 1358372.5556; train_global_loss: 2692364.5833; train_optim_loss: 2692364.5833; val_kl_reg_loss: 17420.5977; val_edge_recon_loss: 299815.2188; val_gene_expr_recon_loss: 963925.4375; val_masked_gp_l1_reg_loss: 11348.6768; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32695.7539; val_chrom_access_recon_loss: 1356186.5000; val_global_loss: 2681392.0000; val_optim_loss: 2681392.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9202; val_auprc_score: 0.9041; val_best_acc_score: 0.8414; val_best_f1_score: 0.8465; train_kl_reg_loss: 22416.3292; train_edge_recon_loss: 299009.2049; train_gene_expr_recon_loss: 972412.3403; train_masked_gp_l1_reg_loss: 11343.0788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32577.6022; train_chrom_access_recon_loss: 1355574.3889; train_global_loss: 2693332.9167; train_optim_loss: 2693332.9167; val_kl_reg_loss: 17606.4609; val_edge_recon_loss: 299185.7812; val_gene_expr_recon_loss: 963426.0000; val_masked_gp_l1_reg_loss: 11329.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32426.0703; val_chrom_access_recon_loss: 1355862.1250; val_global_loss: 2679836.0000; val_optim_loss: 2679836.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9213; val_auprc_score: 0.9051; val_best_acc_score: 0.8421; val_best_f1_score: 0.8510; train_kl_reg_loss: 22385.9872; train_edge_recon_loss: 297897.1042; train_gene_expr_recon_loss: 968427.6319; train_masked_gp_l1_reg_loss: 11325.3905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32315.8995; train_chrom_access_recon_loss: 1348117.6944; train_global_loss: 2680469.7222; train_optim_loss: 2680469.7222; val_kl_reg_loss: 17540.9395; val_edge_recon_loss: 299497.0312; val_gene_expr_recon_loss: 962861.8750; val_masked_gp_l1_reg_loss: 11321.8545; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32181.1641; val_chrom_access_recon_loss: 1355591.2500; val_global_loss: 2678994.0000; val_optim_loss: 2678994.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9257; val_auprc_score: 0.9137; val_best_acc_score: 0.8463; val_best_f1_score: 0.8517; train_kl_reg_loss: 22293.5043; train_edge_recon_loss: 297299.1806; train_gene_expr_recon_loss: 972425.9861; train_masked_gp_l1_reg_loss: 11321.6887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32078.5069; train_chrom_access_recon_loss: 1353169.0694; train_global_loss: 2688587.9444; train_optim_loss: 2688587.9444; val_kl_reg_loss: 17653.4961; val_edge_recon_loss: 298760.9688; val_gene_expr_recon_loss: 962642.1250; val_masked_gp_l1_reg_loss: 11323.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31955.5938; val_chrom_access_recon_loss: 1355464.5000; val_global_loss: 2677800.0000; val_optim_loss: 2677800.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 33 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9207
val AUPRC score: 0.9048
val best accuracy score: 0.8447
val best F1 score: 0.8543
val target rna MSE score: 3.6976
val source rna MSE score: 3.1474
val target atac MSE score: 0.1332
val source atac MSE score: 0.0200
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
