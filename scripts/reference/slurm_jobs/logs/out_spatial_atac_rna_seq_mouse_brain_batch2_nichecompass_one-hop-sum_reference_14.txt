[True]
Run timestamp: 10082023_191407_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7023; val_auprc_score: 0.7397; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 79278.2545; train_edge_recon_loss: 3705267.1584; train_gene_expr_recon_loss: 28054088.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1399425.8931; train_global_loss: 33238060.2595; train_optim_loss: 33238060.2595; val_kl_reg_loss: 98978.0781; val_edge_recon_loss: 4065791.0333; val_gene_expr_recon_loss: 23566664.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1301563.6500; val_global_loss: 29032997.0667; val_optim_loss: 29032997.0667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7598; val_auprc_score: 0.7830; val_best_acc_score: 0.5790; val_best_f1_score: 0.6953; train_kl_reg_loss: 127881.8315; train_edge_recon_loss: 3598813.1870; train_gene_expr_recon_loss: 23158532.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1290978.6498; train_global_loss: 28176205.8473; train_optim_loss: 28176205.8473; val_kl_reg_loss: 134998.1776; val_edge_recon_loss: 4060603.3500; val_gene_expr_recon_loss: 22408554.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1265622.2917; val_global_loss: 27869778.1333; val_optim_loss: 27869778.1333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8310; val_auprc_score: 0.8409; val_best_acc_score: 0.7429; val_best_f1_score: 0.7321; train_kl_reg_loss: 141125.6814; train_edge_recon_loss: 3541786.2920; train_gene_expr_recon_loss: 22405964.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1269905.1202; train_global_loss: 27358782.0458; train_optim_loss: 27358782.0458; val_kl_reg_loss: 136814.8438; val_edge_recon_loss: 3990668.9000; val_gene_expr_recon_loss: 21967110.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1251928.2917; val_global_loss: 27346521.6000; val_optim_loss: 27346521.6000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8620; val_auprc_score: 0.8504; val_best_acc_score: 0.7723; val_best_f1_score: 0.8018; train_kl_reg_loss: 117448.1550; train_edge_recon_loss: 3434888.4103; train_gene_expr_recon_loss: 22126660.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1260376.9599; train_global_loss: 26939373.8931; train_optim_loss: 26939373.8931; val_kl_reg_loss: 107051.9203; val_edge_recon_loss: 3199040.6000; val_gene_expr_recon_loss: 21807751.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1246810.1833; val_global_loss: 26360653.7333; val_optim_loss: 26360653.7333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8786; val_auprc_score: 0.8647; val_best_acc_score: 0.7821; val_best_f1_score: 0.8063; train_kl_reg_loss: 140805.4990; train_edge_recon_loss: 3056909.0706; train_gene_expr_recon_loss: 21971703.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1254905.6107; train_global_loss: 26424323.7405; train_optim_loss: 26424323.7405; val_kl_reg_loss: 139510.0417; val_edge_recon_loss: 3027168.5500; val_gene_expr_recon_loss: 21623712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1239467.1750; val_global_loss: 26029857.6000; val_optim_loss: 26029857.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8817; val_auprc_score: 0.8676; val_best_acc_score: 0.7816; val_best_f1_score: 0.8044; train_kl_reg_loss: 145020.8268; train_edge_recon_loss: 2985862.5973; train_gene_expr_recon_loss: 21829967.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1250081.0076; train_global_loss: 26210932.3817; train_optim_loss: 26210932.3817; val_kl_reg_loss: 140766.7281; val_edge_recon_loss: 2963596.1167; val_gene_expr_recon_loss: 21497699.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1234221.0500; val_global_loss: 25836283.3333; val_optim_loss: 25836283.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8930; val_auprc_score: 0.8794; val_best_acc_score: 0.8044; val_best_f1_score: 0.8227; train_kl_reg_loss: 137097.7854; train_edge_recon_loss: 2967532.0706; train_gene_expr_recon_loss: 21659572.1679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1243301.7605; train_global_loss: 26007503.8168; train_optim_loss: 26007503.8168; val_kl_reg_loss: 129200.3047; val_edge_recon_loss: 2987914.8333; val_gene_expr_recon_loss: 21360801.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1229463.8750; val_global_loss: 25707380.4000; val_optim_loss: 25707380.4000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8952; val_auprc_score: 0.8774; val_best_acc_score: 0.8111; val_best_f1_score: 0.8293; train_kl_reg_loss: 129539.5290; train_edge_recon_loss: 2945109.5382; train_gene_expr_recon_loss: 21544568.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1238885.8740; train_global_loss: 25858103.2366; train_optim_loss: 25858103.2366; val_kl_reg_loss: 126647.7776; val_edge_recon_loss: 2931293.2167; val_gene_expr_recon_loss: 21227006.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1228801.0500; val_global_loss: 25513748.6667; val_optim_loss: 25513748.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9063; val_auprc_score: 0.8907; val_best_acc_score: 0.8267; val_best_f1_score: 0.8406; train_kl_reg_loss: 123681.1254; train_edge_recon_loss: 2913983.0763; train_gene_expr_recon_loss: 21426181.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1233758.7710; train_global_loss: 25697604.2290; train_optim_loss: 25697604.2290; val_kl_reg_loss: 122475.5531; val_edge_recon_loss: 2924920.6333; val_gene_expr_recon_loss: 21138066.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1220732.7500; val_global_loss: 25406196.0000; val_optim_loss: 25406196.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9137; val_auprc_score: 0.8979; val_best_acc_score: 0.8367; val_best_f1_score: 0.8511; train_kl_reg_loss: 121700.9093; train_edge_recon_loss: 2866368.5344; train_gene_expr_recon_loss: 21327532.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1229275.7948; train_global_loss: 25544877.4962; train_optim_loss: 25544877.4962; val_kl_reg_loss: 117650.3984; val_edge_recon_loss: 2878510.4833; val_gene_expr_recon_loss: 21101982.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1221183.4583; val_global_loss: 25319326.9333; val_optim_loss: 25319326.9333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9250; val_auprc_score: 0.9116; val_best_acc_score: 0.8529; val_best_f1_score: 0.8643; train_kl_reg_loss: 119050.0060; train_edge_recon_loss: 2855423.1450; train_gene_expr_recon_loss: 21262176.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1226790.4761; train_global_loss: 25463439.6947; train_optim_loss: 25463439.6947; val_kl_reg_loss: 116936.0693; val_edge_recon_loss: 2815561.9500; val_gene_expr_recon_loss: 21045542.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1219868.0333; val_global_loss: 25197908.0000; val_optim_loss: 25197908.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9279; val_auprc_score: 0.9095; val_best_acc_score: 0.8584; val_best_f1_score: 0.8675; train_kl_reg_loss: 114291.3513; train_edge_recon_loss: 2843681.0229; train_gene_expr_recon_loss: 21229340.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1226262.2834; train_global_loss: 25413575.6794; train_optim_loss: 25413575.6794; val_kl_reg_loss: 113141.4109; val_edge_recon_loss: 2822834.2667; val_gene_expr_recon_loss: 20944000.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1213043.5833; val_global_loss: 25093020.2667; val_optim_loss: 25093020.2667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9299; val_auprc_score: 0.9162; val_best_acc_score: 0.8592; val_best_f1_score: 0.8678; train_kl_reg_loss: 112351.8231; train_edge_recon_loss: 2821210.1107; train_gene_expr_recon_loss: 21153795.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1222792.9504; train_global_loss: 25310150.1832; train_optim_loss: 25310150.1832; val_kl_reg_loss: 111384.5068; val_edge_recon_loss: 2825124.1333; val_gene_expr_recon_loss: 20826022.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1206150.9833; val_global_loss: 24968681.6000; val_optim_loss: 24968681.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9344; val_auprc_score: 0.9200; val_best_acc_score: 0.8680; val_best_f1_score: 0.8761; train_kl_reg_loss: 110952.0416; train_edge_recon_loss: 2805637.1489; train_gene_expr_recon_loss: 21067258.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1218772.7099; train_global_loss: 25202620.2595; train_optim_loss: 25202620.2595; val_kl_reg_loss: 106680.8078; val_edge_recon_loss: 2811772.6667; val_gene_expr_recon_loss: 20816599.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1207617.5583; val_global_loss: 24942670.9333; val_optim_loss: 24942670.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9377; val_auprc_score: 0.9218; val_best_acc_score: 0.8743; val_best_f1_score: 0.8815; train_kl_reg_loss: 107538.8498; train_edge_recon_loss: 2803042.1832; train_gene_expr_recon_loss: 21039629.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1219057.9656; train_global_loss: 25169268.8702; train_optim_loss: 25169268.8702; val_kl_reg_loss: 107242.3682; val_edge_recon_loss: 2800878.1000; val_gene_expr_recon_loss: 20838744.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1212614.4833; val_global_loss: 24959478.6667; val_optim_loss: 24959478.6667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9491; val_auprc_score: 0.9343; val_best_acc_score: 0.8855; val_best_f1_score: 0.8911; train_kl_reg_loss: 103563.3286; train_edge_recon_loss: 2777682.8263; train_gene_expr_recon_loss: 21000216.1832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1217485.1460; train_global_loss: 25098947.4198; train_optim_loss: 25098947.4198; val_kl_reg_loss: 101061.7604; val_edge_recon_loss: 2778350.8333; val_gene_expr_recon_loss: 20680510.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1198144.3833; val_global_loss: 24758067.2000; val_optim_loss: 24758067.2000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9464; val_auprc_score: 0.9346; val_best_acc_score: 0.8798; val_best_f1_score: 0.8867; train_kl_reg_loss: 102101.9569; train_edge_recon_loss: 2773114.2805; train_gene_expr_recon_loss: 20942590.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1214942.9790; train_global_loss: 25032749.5725; train_optim_loss: 25032749.5725; val_kl_reg_loss: 101176.6271; val_edge_recon_loss: 2793534.3000; val_gene_expr_recon_loss: 20617063.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1198082.0583; val_global_loss: 24709856.6667; val_optim_loss: 24709856.6667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9513; val_auprc_score: 0.9404; val_best_acc_score: 0.8868; val_best_f1_score: 0.8920; train_kl_reg_loss: 99411.4188; train_edge_recon_loss: 2765450.4618; train_gene_expr_recon_loss: 20909357.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1214222.7004; train_global_loss: 24988442.2137; train_optim_loss: 24988442.2137; val_kl_reg_loss: 99782.9714; val_edge_recon_loss: 2788679.5833; val_gene_expr_recon_loss: 20576691.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1200037.4167; val_global_loss: 24665191.2000; val_optim_loss: 24665191.2000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9537; val_auprc_score: 0.9419; val_best_acc_score: 0.8936; val_best_f1_score: 0.8983; train_kl_reg_loss: 97853.2386; train_edge_recon_loss: 2769451.5744; train_gene_expr_recon_loss: 20858428.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1212739.8817; train_global_loss: 24938472.9160; train_optim_loss: 24938472.9160; val_kl_reg_loss: 96099.6740; val_edge_recon_loss: 2752306.1500; val_gene_expr_recon_loss: 20564778.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1199622.0917; val_global_loss: 24612807.0667; val_optim_loss: 24612807.0667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9575; val_auprc_score: 0.9472; val_best_acc_score: 0.8984; val_best_f1_score: 0.9028; train_kl_reg_loss: 95385.0462; train_edge_recon_loss: 2749947.2004; train_gene_expr_recon_loss: 20828856.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1211198.8779; train_global_loss: 24885387.9542; train_optim_loss: 24885387.9542; val_kl_reg_loss: 96370.7214; val_edge_recon_loss: 2739002.8333; val_gene_expr_recon_loss: 20633147.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1203988.0417; val_global_loss: 24672509.3333; val_optim_loss: 24672509.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9578; val_auprc_score: 0.9441; val_best_acc_score: 0.9004; val_best_f1_score: 0.9049; train_kl_reg_loss: 94114.1870; train_edge_recon_loss: 2746715.9237; train_gene_expr_recon_loss: 20800086.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1211429.0744; train_global_loss: 24852346.0153; train_optim_loss: 24852346.0153; val_kl_reg_loss: 94979.9760; val_edge_recon_loss: 2746586.5667; val_gene_expr_recon_loss: 20522766.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1198645.7250; val_global_loss: 24562978.4000; val_optim_loss: 24562978.4000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9594; val_auprc_score: 0.9505; val_best_acc_score: 0.8995; val_best_f1_score: 0.9039; train_kl_reg_loss: 92104.0313; train_edge_recon_loss: 2747097.4447; train_gene_expr_recon_loss: 20750888.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1208884.7805; train_global_loss: 24798974.9313; train_optim_loss: 24798974.9313; val_kl_reg_loss: 91812.2656; val_edge_recon_loss: 2743857.4500; val_gene_expr_recon_loss: 20502868.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1197269.8417; val_global_loss: 24535808.1333; val_optim_loss: 24535808.1333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9571; val_auprc_score: 0.9459; val_best_acc_score: 0.8971; val_best_f1_score: 0.9018; train_kl_reg_loss: 91085.0692; train_edge_recon_loss: 2732454.0878; train_gene_expr_recon_loss: 20764034.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1209599.8817; train_global_loss: 24797173.3740; train_optim_loss: 24797173.3740; val_kl_reg_loss: 89141.3193; val_edge_recon_loss: 2764990.7500; val_gene_expr_recon_loss: 20507519.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1198114.0583; val_global_loss: 24559765.4667; val_optim_loss: 24559765.4667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9622; val_auprc_score: 0.9511; val_best_acc_score: 0.9050; val_best_f1_score: 0.9096; train_kl_reg_loss: 88813.0355; train_edge_recon_loss: 2733810.4504; train_gene_expr_recon_loss: 20719075.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1208217.4571; train_global_loss: 24749916.1832; train_optim_loss: 24749916.1832; val_kl_reg_loss: 85825.0677; val_edge_recon_loss: 2736053.4333; val_gene_expr_recon_loss: 20482956.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1199978.1417; val_global_loss: 24504812.5333; val_optim_loss: 24504812.5333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9629; val_auprc_score: 0.9540; val_best_acc_score: 0.9047; val_best_f1_score: 0.9085; train_kl_reg_loss: 86966.6667; train_edge_recon_loss: 2723794.4905; train_gene_expr_recon_loss: 20689312.1069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1207500.1527; train_global_loss: 24707573.3893; train_optim_loss: 24707573.3893; val_kl_reg_loss: 87908.1307; val_edge_recon_loss: 2740362.7000; val_gene_expr_recon_loss: 20385168.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1194470.1917; val_global_loss: 24407909.7333; val_optim_loss: 24407909.7333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9453; val_auprc_score: 0.9346; val_best_acc_score: 0.8813; val_best_f1_score: 0.8836; train_kl_reg_loss: 104724.7111; train_edge_recon_loss: 2949151.5840; train_gene_expr_recon_loss: 23544434.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1278362.6307; train_global_loss: 27876673.6947; train_optim_loss: 27876673.6947; val_kl_reg_loss: 13513.9543; val_edge_recon_loss: 2878994.5500; val_gene_expr_recon_loss: 23391245.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1260661.0500; val_global_loss: 27544415.2000; val_optim_loss: 27544415.2000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9451; val_auprc_score: 0.9326; val_best_acc_score: 0.8818; val_best_f1_score: 0.8881; train_kl_reg_loss: 91931.9859; train_edge_recon_loss: 2842334.6698; train_gene_expr_recon_loss: 23772347.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1271422.2166; train_global_loss: 27978036.3359; train_optim_loss: 27978036.3359; val_kl_reg_loss: 14159.3249; val_edge_recon_loss: 2771107.9500; val_gene_expr_recon_loss: 23488592.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1260759.8667; val_global_loss: 27534619.6000; val_optim_loss: 27534619.6000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9497; val_auprc_score: 0.9382; val_best_acc_score: 0.8874; val_best_f1_score: 0.8911; train_kl_reg_loss: 68883.7778; train_edge_recon_loss: 2784345.4828; train_gene_expr_recon_loss: 23770047.1145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1266193.0916; train_global_loss: 27889469.4809; train_optim_loss: 27889469.4809; val_kl_reg_loss: 12619.6225; val_edge_recon_loss: 2790228.4833; val_gene_expr_recon_loss: 23469735.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1251281.6000; val_global_loss: 27523865.6000; val_optim_loss: 27523865.6000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9521; val_auprc_score: 0.9385; val_best_acc_score: 0.8965; val_best_f1_score: 0.9014; train_kl_reg_loss: 50050.4419; train_edge_recon_loss: 2731210.1221; train_gene_expr_recon_loss: 23609433.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1262123.0019; train_global_loss: 27652817.2061; train_optim_loss: 27652817.2061; val_kl_reg_loss: 15677.7441; val_edge_recon_loss: 2712054.2833; val_gene_expr_recon_loss: 23129053.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1242605.2250; val_global_loss: 27099390.4000; val_optim_loss: 27099390.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9497; val_auprc_score: 0.9372; val_best_acc_score: 0.8864; val_best_f1_score: 0.8911; train_kl_reg_loss: 45188.0653; train_edge_recon_loss: 2712061.1660; train_gene_expr_recon_loss: 23460899.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1259829.3683; train_global_loss: 27477978.5649; train_optim_loss: 27477978.5649; val_kl_reg_loss: 15940.1311; val_edge_recon_loss: 2754817.2333; val_gene_expr_recon_loss: 23244842.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1254247.7583; val_global_loss: 27269847.2000; val_optim_loss: 27269847.2000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9559; val_auprc_score: 0.9451; val_best_acc_score: 0.8989; val_best_f1_score: 0.9041; train_kl_reg_loss: 44325.9404; train_edge_recon_loss: 2712774.0763; train_gene_expr_recon_loss: 23428930.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1258427.1823; train_global_loss: 27444458.0305; train_optim_loss: 27444458.0305; val_kl_reg_loss: 16158.8755; val_edge_recon_loss: 2714581.6833; val_gene_expr_recon_loss: 23117176.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1248045.6750; val_global_loss: 27095962.2667; val_optim_loss: 27095962.2667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9568; val_auprc_score: 0.9450; val_best_acc_score: 0.9038; val_best_f1_score: 0.9075; train_kl_reg_loss: 43129.2920; train_edge_recon_loss: 2709420.3111; train_gene_expr_recon_loss: 23388667.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1258307.5744; train_global_loss: 27399524.9160; train_optim_loss: 27399524.9160; val_kl_reg_loss: 16105.9609; val_edge_recon_loss: 2708213.2167; val_gene_expr_recon_loss: 23062202.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1244119.3083; val_global_loss: 27030641.4667; val_optim_loss: 27030641.4667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9546; val_auprc_score: 0.9421; val_best_acc_score: 0.8972; val_best_f1_score: 0.9021; train_kl_reg_loss: 42232.3600; train_edge_recon_loss: 2708689.8721; train_gene_expr_recon_loss: 23395731.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1259474.1498; train_global_loss: 27406127.7252; train_optim_loss: 27406127.7252; val_kl_reg_loss: 16045.5302; val_edge_recon_loss: 2719428.3833; val_gene_expr_recon_loss: 23116008.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1245331.8417; val_global_loss: 27096814.4000; val_optim_loss: 27096814.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 33 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9581
val AUPRC score: 0.9461
val best accuracy score: 0.9046
val best F1 score: 0.9088
val target rna MSE score: 1.3570
val source rna MSE score: 208.6588
val target atac MSE score: 0.6065
val source atac MSE score: 6.3425
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
