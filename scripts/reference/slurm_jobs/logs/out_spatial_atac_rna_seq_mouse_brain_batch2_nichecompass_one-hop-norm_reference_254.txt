[True]
Run timestamp: 07092023_034449_254.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_254']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 18606 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 21320, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 18606
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 18606

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6829; val_auprc_score: 0.6678; val_best_acc_score: 0.5462; val_best_f1_score: 0.6860; train_kl_reg_loss: 45269.8912; train_edge_recon_loss: 3637983.1856; train_gene_expr_recon_loss: 12774925.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 838786.6913; train_chrom_access_recon_loss: 41536425.6970; train_global_loss: 58833390.9091; train_optim_loss: 58833390.9091; val_kl_reg_loss: 78469.7383; val_edge_recon_loss: 4062905.0625; val_gene_expr_recon_loss: 11276255.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 667901.1250; val_chrom_access_recon_loss: 38812488.0000; val_global_loss: 54898019.5000; val_optim_loss: 54898019.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6884; val_auprc_score: 0.6765; val_best_acc_score: 0.6131; val_best_f1_score: 0.6878; train_kl_reg_loss: 83948.4996; train_edge_recon_loss: 3641857.8598; train_gene_expr_recon_loss: 11467862.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 510830.0507; train_chrom_access_recon_loss: 39607904.0000; train_global_loss: 55312403.2727; train_optim_loss: 55312403.2727; val_kl_reg_loss: 116913.4219; val_edge_recon_loss: 4056707.7500; val_gene_expr_recon_loss: 11086793.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 371218.6562; val_chrom_access_recon_loss: 38447156.0000; val_global_loss: 54078790.0000; val_optim_loss: 54078790.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7163; val_auprc_score: 0.7018; val_best_acc_score: 0.6419; val_best_f1_score: 0.7037; train_kl_reg_loss: 106943.0676; train_edge_recon_loss: 3543132.6894; train_gene_expr_recon_loss: 11184856.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 282753.1200; train_chrom_access_recon_loss: 39107408.3636; train_global_loss: 54225093.8182; train_optim_loss: 54225093.8182; val_kl_reg_loss: 107653.7119; val_edge_recon_loss: 3999114.0312; val_gene_expr_recon_loss: 10853755.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 213412.5938; val_chrom_access_recon_loss: 37918982.5000; val_global_loss: 53092919.5000; val_optim_loss: 53092919.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8026; val_auprc_score: 0.7810; val_best_acc_score: 0.7184; val_best_f1_score: 0.7667; train_kl_reg_loss: 91310.3479; train_edge_recon_loss: 3433814.5114; train_gene_expr_recon_loss: 11049369.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 175080.9306; train_chrom_access_recon_loss: 38802479.4545; train_global_loss: 53552054.6061; train_optim_loss: 53552054.6061; val_kl_reg_loss: 83622.2607; val_edge_recon_loss: 3285543.0312; val_gene_expr_recon_loss: 10697773.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144518.0469; val_chrom_access_recon_loss: 37783554.5000; val_global_loss: 51995011.0000; val_optim_loss: 51995011.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8273; val_auprc_score: 0.7790; val_best_acc_score: 0.7595; val_best_f1_score: 0.7917; train_kl_reg_loss: 114237.3574; train_edge_recon_loss: 3049790.5076; train_gene_expr_recon_loss: 10958883.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125495.2334; train_chrom_access_recon_loss: 38529774.4848; train_global_loss: 52778181.3939; train_optim_loss: 52778181.3939; val_kl_reg_loss: 120111.8291; val_edge_recon_loss: 3005903.8750; val_gene_expr_recon_loss: 10650086.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108856.8750; val_chrom_access_recon_loss: 37531756.0000; val_global_loss: 51416716.0000; val_optim_loss: 51416716.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8355; val_auprc_score: 0.7916; val_best_acc_score: 0.7743; val_best_f1_score: 0.7980; train_kl_reg_loss: 123402.3395; train_edge_recon_loss: 2971468.6515; train_gene_expr_recon_loss: 10889819.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97168.4924; train_chrom_access_recon_loss: 38339594.0606; train_global_loss: 52421453.3939; train_optim_loss: 52421453.3939; val_kl_reg_loss: 113839.4629; val_edge_recon_loss: 2943478.0312; val_gene_expr_recon_loss: 10589338.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86655.1953; val_chrom_access_recon_loss: 37430547.0000; val_global_loss: 51163858.0000; val_optim_loss: 51163858.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8512; val_auprc_score: 0.8106; val_best_acc_score: 0.7826; val_best_f1_score: 0.8026; train_kl_reg_loss: 118471.0808; train_edge_recon_loss: 2953027.3712; train_gene_expr_recon_loss: 10826244.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79269.5079; train_chrom_access_recon_loss: 38180158.3030; train_global_loss: 52157170.6061; train_optim_loss: 52157170.6061; val_kl_reg_loss: 103746.5352; val_edge_recon_loss: 2937395.0938; val_gene_expr_recon_loss: 10562041.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72527.9531; val_chrom_access_recon_loss: 37096089.0000; val_global_loss: 50771800.5000; val_optim_loss: 50771800.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8462; val_auprc_score: 0.8123; val_best_acc_score: 0.7773; val_best_f1_score: 0.8060; train_kl_reg_loss: 111185.2163; train_edge_recon_loss: 2932358.2159; train_gene_expr_recon_loss: 10770328.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67525.0630; train_chrom_access_recon_loss: 38027776.1212; train_global_loss: 51909172.4848; train_optim_loss: 51909172.4848; val_kl_reg_loss: 106184.3457; val_edge_recon_loss: 2941361.7500; val_gene_expr_recon_loss: 10478639.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63060.5117; val_chrom_access_recon_loss: 36984036.5000; val_global_loss: 50573283.0000; val_optim_loss: 50573283.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8702; val_auprc_score: 0.8326; val_best_acc_score: 0.8020; val_best_f1_score: 0.8254; train_kl_reg_loss: 105883.3741; train_edge_recon_loss: 2895031.7008; train_gene_expr_recon_loss: 10720532.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59436.5405; train_chrom_access_recon_loss: 37851217.0909; train_global_loss: 51632101.3333; train_optim_loss: 51632101.3333; val_kl_reg_loss: 101405.2432; val_edge_recon_loss: 2862398.4688; val_gene_expr_recon_loss: 10438424.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56177.5625; val_chrom_access_recon_loss: 36733734.5000; val_global_loss: 50192140.5000; val_optim_loss: 50192140.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8832; val_auprc_score: 0.8483; val_best_acc_score: 0.8143; val_best_f1_score: 0.8335; train_kl_reg_loss: 103116.0120; train_edge_recon_loss: 2859331.2159; train_gene_expr_recon_loss: 10673675.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53503.6787; train_chrom_access_recon_loss: 37721655.2121; train_global_loss: 51411281.9394; train_optim_loss: 51411281.9394; val_kl_reg_loss: 98132.3770; val_edge_recon_loss: 2880018.9375; val_gene_expr_recon_loss: 10410473.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51089.8477; val_chrom_access_recon_loss: 36711239.0000; val_global_loss: 50150954.0000; val_optim_loss: 50150954.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8876; val_auprc_score: 0.8533; val_best_acc_score: 0.8197; val_best_f1_score: 0.8400; train_kl_reg_loss: 102928.2240; train_edge_recon_loss: 2841623.5417; train_gene_expr_recon_loss: 10641457.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48983.8994; train_chrom_access_recon_loss: 37604111.6364; train_global_loss: 51239105.0303; train_optim_loss: 51239105.0303; val_kl_reg_loss: 97199.7217; val_edge_recon_loss: 2904408.0000; val_gene_expr_recon_loss: 10408461.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47094.3125; val_chrom_access_recon_loss: 36560814.5000; val_global_loss: 50017977.0000; val_optim_loss: 50017977.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8991; val_auprc_score: 0.8603; val_best_acc_score: 0.8436; val_best_f1_score: 0.8583; train_kl_reg_loss: 105613.0162; train_edge_recon_loss: 2795883.3030; train_gene_expr_recon_loss: 10597691.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45513.1911; train_chrom_access_recon_loss: 37445760.9697; train_global_loss: 50990461.6970; train_optim_loss: 50990461.6970; val_kl_reg_loss: 104006.7061; val_edge_recon_loss: 2804076.5938; val_gene_expr_recon_loss: 10325455.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44085.1875; val_chrom_access_recon_loss: 36613128.5000; val_global_loss: 49890752.5000; val_optim_loss: 49890752.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9103; val_auprc_score: 0.8781; val_best_acc_score: 0.8474; val_best_f1_score: 0.8610; train_kl_reg_loss: 103328.4737; train_edge_recon_loss: 2794655.3182; train_gene_expr_recon_loss: 10558853.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42788.6282; train_chrom_access_recon_loss: 37317388.8485; train_global_loss: 50817014.7879; train_optim_loss: 50817014.7879; val_kl_reg_loss: 99712.3555; val_edge_recon_loss: 2845494.7188; val_gene_expr_recon_loss: 10415703.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41754.6758; val_chrom_access_recon_loss: 36740801.0000; val_global_loss: 50143465.5000; val_optim_loss: 50143465.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9050; val_auprc_score: 0.8717; val_best_acc_score: 0.8474; val_best_f1_score: 0.8611; train_kl_reg_loss: 100425.4402; train_edge_recon_loss: 2793071.1856; train_gene_expr_recon_loss: 10523378.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40765.9148; train_chrom_access_recon_loss: 37192940.7879; train_global_loss: 50650582.0606; train_optim_loss: 50650582.0606; val_kl_reg_loss: 100173.9258; val_edge_recon_loss: 2830585.4375; val_gene_expr_recon_loss: 10235216.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39992.4727; val_chrom_access_recon_loss: 36343985.5000; val_global_loss: 49549952.5000; val_optim_loss: 49549952.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9160; val_auprc_score: 0.8866; val_best_acc_score: 0.8541; val_best_f1_score: 0.8655; train_kl_reg_loss: 100175.1371; train_edge_recon_loss: 2774451.5265; train_gene_expr_recon_loss: 10489601.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39127.3271; train_chrom_access_recon_loss: 37045602.5455; train_global_loss: 50448958.3030; train_optim_loss: 50448958.3030; val_kl_reg_loss: 97014.3926; val_edge_recon_loss: 2811205.3438; val_gene_expr_recon_loss: 10225013.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38664.0508; val_chrom_access_recon_loss: 36400869.5000; val_global_loss: 49572767.5000; val_optim_loss: 49572767.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9127; val_auprc_score: 0.8797; val_best_acc_score: 0.8549; val_best_f1_score: 0.8660; train_kl_reg_loss: 99478.1590; train_edge_recon_loss: 2760014.3902; train_gene_expr_recon_loss: 10454707.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37925.7782; train_chrom_access_recon_loss: 36922075.0303; train_global_loss: 50274200.6061; train_optim_loss: 50274200.6061; val_kl_reg_loss: 94970.0625; val_edge_recon_loss: 2826988.7812; val_gene_expr_recon_loss: 10319887.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37422.5156; val_chrom_access_recon_loss: 36081725.5000; val_global_loss: 49360995.0000; val_optim_loss: 49360995.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9225; val_auprc_score: 0.8893; val_best_acc_score: 0.8654; val_best_f1_score: 0.8754; train_kl_reg_loss: 98440.4815; train_edge_recon_loss: 2764788.1932; train_gene_expr_recon_loss: 10430649.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36987.2710; train_chrom_access_recon_loss: 36820178.2424; train_global_loss: 50151043.5152; train_optim_loss: 50151043.5152; val_kl_reg_loss: 93457.5947; val_edge_recon_loss: 2800536.3750; val_gene_expr_recon_loss: 10158305.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36624.8711; val_chrom_access_recon_loss: 35685514.5000; val_global_loss: 48774438.5000; val_optim_loss: 48774438.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9322; val_auprc_score: 0.9112; val_best_acc_score: 0.8721; val_best_f1_score: 0.8804; train_kl_reg_loss: 95099.1914; train_edge_recon_loss: 2756980.2992; train_gene_expr_recon_loss: 10398923.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36238.8607; train_chrom_access_recon_loss: 36687260.2424; train_global_loss: 49974501.6970; train_optim_loss: 49974501.6970; val_kl_reg_loss: 93762.5381; val_edge_recon_loss: 2763696.2188; val_gene_expr_recon_loss: 10195126.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35968.2422; val_chrom_access_recon_loss: 35697890.5000; val_global_loss: 48786443.5000; val_optim_loss: 48786443.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9303; val_auprc_score: 0.9044; val_best_acc_score: 0.8732; val_best_f1_score: 0.8823; train_kl_reg_loss: 94950.3905; train_edge_recon_loss: 2749546.5076; train_gene_expr_recon_loss: 10370116.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35684.1126; train_chrom_access_recon_loss: 36559175.1515; train_global_loss: 49809473.0909; train_optim_loss: 49809473.0909; val_kl_reg_loss: 92465.5586; val_edge_recon_loss: 2763989.1250; val_gene_expr_recon_loss: 10177231.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35361.9492; val_chrom_access_recon_loss: 35857641.5000; val_global_loss: 48926689.0000; val_optim_loss: 48926689.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9308; val_auprc_score: 0.9063; val_best_acc_score: 0.8686; val_best_f1_score: 0.8784; train_kl_reg_loss: 94303.6158; train_edge_recon_loss: 2747812.6250; train_gene_expr_recon_loss: 10350553.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35135.3089; train_chrom_access_recon_loss: 36476704.0606; train_global_loss: 49704508.6061; train_optim_loss: 49704508.6061; val_kl_reg_loss: 93158.5664; val_edge_recon_loss: 2797165.2188; val_gene_expr_recon_loss: 10110001.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34938.0977; val_chrom_access_recon_loss: 35747465.5000; val_global_loss: 48782729.0000; val_optim_loss: 48782729.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9345; val_auprc_score: 0.9107; val_best_acc_score: 0.8791; val_best_f1_score: 0.8858; train_kl_reg_loss: 93550.5942; train_edge_recon_loss: 2732834.6288; train_gene_expr_recon_loss: 10322409.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34741.9351; train_chrom_access_recon_loss: 36319535.8788; train_global_loss: 49503071.7576; train_optim_loss: 49503071.7576; val_kl_reg_loss: 90347.6621; val_edge_recon_loss: 2778570.3125; val_gene_expr_recon_loss: 10135523.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34632.8125; val_chrom_access_recon_loss: 35616688.5000; val_global_loss: 48655763.5000; val_optim_loss: 48655763.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9301; val_auprc_score: 0.9029; val_best_acc_score: 0.8721; val_best_f1_score: 0.8816; train_kl_reg_loss: 91942.4760; train_edge_recon_loss: 2739009.6515; train_gene_expr_recon_loss: 10293171.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34441.3482; train_chrom_access_recon_loss: 36205045.3939; train_global_loss: 49363610.6061; train_optim_loss: 49363610.6061; val_kl_reg_loss: 91023.7715; val_edge_recon_loss: 2783064.6875; val_gene_expr_recon_loss: 10009348.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34243.3516; val_chrom_access_recon_loss: 35067718.0000; val_global_loss: 47985398.5000; val_optim_loss: 47985398.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9412; val_auprc_score: 0.9141; val_best_acc_score: 0.8855; val_best_f1_score: 0.8930; train_kl_reg_loss: 90429.5473; train_edge_recon_loss: 2740441.4962; train_gene_expr_recon_loss: 10283096.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34113.4421; train_chrom_access_recon_loss: 36101536.5455; train_global_loss: 49249617.3939; train_optim_loss: 49249617.3939; val_kl_reg_loss: 86594.8760; val_edge_recon_loss: 2741948.6875; val_gene_expr_recon_loss: 10130865.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34195.1016; val_chrom_access_recon_loss: 35831650.0000; val_global_loss: 48825254.0000; val_optim_loss: 48825254.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9352; val_auprc_score: 0.9126; val_best_acc_score: 0.8753; val_best_f1_score: 0.8855; train_kl_reg_loss: 89507.8138; train_edge_recon_loss: 2726533.5341; train_gene_expr_recon_loss: 10262543.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34024.4526; train_chrom_access_recon_loss: 35988866.7273; train_global_loss: 49101475.9394; train_optim_loss: 49101475.9394; val_kl_reg_loss: 86230.8213; val_edge_recon_loss: 2752669.4375; val_gene_expr_recon_loss: 9993380.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33848.8750; val_chrom_access_recon_loss: 35290855.5000; val_global_loss: 48156985.0000; val_optim_loss: 48156985.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9442; val_auprc_score: 0.9282; val_best_acc_score: 0.8842; val_best_f1_score: 0.8924; train_kl_reg_loss: 88297.7029; train_edge_recon_loss: 2722549.2803; train_gene_expr_recon_loss: 10238521.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33841.4788; train_chrom_access_recon_loss: 35872302.8485; train_global_loss: 48955512.6061; train_optim_loss: 48955512.6061; val_kl_reg_loss: 86984.5303; val_edge_recon_loss: 2754078.9062; val_gene_expr_recon_loss: 10021311.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33702.7070; val_chrom_access_recon_loss: 35193815.0000; val_global_loss: 48089892.5000; val_optim_loss: 48089892.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9382; val_auprc_score: 0.9173; val_best_acc_score: 0.8788; val_best_f1_score: 0.8874; train_kl_reg_loss: 87144.1631; train_edge_recon_loss: 2729659.3333; train_gene_expr_recon_loss: 10235531.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29413.3309; train_chrom_access_recon_loss: 36224921.2727; train_global_loss: 49306669.6970; train_optim_loss: 49306669.6970; val_kl_reg_loss: 77097.8350; val_edge_recon_loss: 2776681.6875; val_gene_expr_recon_loss: 9951487.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27628.8027; val_chrom_access_recon_loss: 35083689.5000; val_global_loss: 47916586.0000; val_optim_loss: 47916586.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9375; val_auprc_score: 0.9104; val_best_acc_score: 0.8858; val_best_f1_score: 0.8900; train_kl_reg_loss: 88548.3530; train_edge_recon_loss: 2718843.6742; train_gene_expr_recon_loss: 10202489.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26842.6507; train_chrom_access_recon_loss: 36019773.9394; train_global_loss: 49056498.2424; train_optim_loss: 49056498.2424; val_kl_reg_loss: 77989.4121; val_edge_recon_loss: 2761586.5000; val_gene_expr_recon_loss: 9977504.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26477.7656; val_chrom_access_recon_loss: 35383503.5000; val_global_loss: 48227061.5000; val_optim_loss: 48227061.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9483; val_auprc_score: 0.9263; val_best_acc_score: 0.8966; val_best_f1_score: 0.9024; train_kl_reg_loss: 86701.4560; train_edge_recon_loss: 2718846.9811; train_gene_expr_recon_loss: 10180658.8939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26149.9936; train_chrom_access_recon_loss: 35866411.7576; train_global_loss: 48878768.9697; train_optim_loss: 48878768.9697; val_kl_reg_loss: 76043.4180; val_edge_recon_loss: 2716065.3438; val_gene_expr_recon_loss: 9971439.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25798.2051; val_chrom_access_recon_loss: 35231613.0000; val_global_loss: 48020958.5000; val_optim_loss: 48020958.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9437; val_auprc_score: 0.9204; val_best_acc_score: 0.8949; val_best_f1_score: 0.9008; train_kl_reg_loss: 84798.4651; train_edge_recon_loss: 2710811.7917; train_gene_expr_recon_loss: 10167161.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25647.8125; train_chrom_access_recon_loss: 35820193.8182; train_global_loss: 48808613.5758; train_optim_loss: 48808613.5758; val_kl_reg_loss: 75544.1328; val_edge_recon_loss: 2731773.4688; val_gene_expr_recon_loss: 9955621.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25504.7031; val_chrom_access_recon_loss: 35193224.0000; val_global_loss: 47981668.0000; val_optim_loss: 47981668.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9480; val_auprc_score: 0.9231; val_best_acc_score: 0.8963; val_best_f1_score: 0.9022; train_kl_reg_loss: 82523.0015; train_edge_recon_loss: 2721600.7197; train_gene_expr_recon_loss: 10142548.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25419.0044; train_chrom_access_recon_loss: 35693964.2121; train_global_loss: 48666055.0303; train_optim_loss: 48666055.0303; val_kl_reg_loss: 73766.4961; val_edge_recon_loss: 2734477.5312; val_gene_expr_recon_loss: 9941946.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25284.7461; val_chrom_access_recon_loss: 34926093.5000; val_global_loss: 47701568.5000; val_optim_loss: 47701568.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9519; val_auprc_score: 0.9348; val_best_acc_score: 0.9006; val_best_f1_score: 0.9041; train_kl_reg_loss: 81853.6742; train_edge_recon_loss: 2712356.2879; train_gene_expr_recon_loss: 10131572.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25176.1051; train_chrom_access_recon_loss: 35640712.6061; train_global_loss: 48591671.0303; train_optim_loss: 48591671.0303; val_kl_reg_loss: 74881.0645; val_edge_recon_loss: 2720306.5938; val_gene_expr_recon_loss: 9907490.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25151.7754; val_chrom_access_recon_loss: 34639837.5000; val_global_loss: 47367667.5000; val_optim_loss: 47367667.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9495; val_auprc_score: 0.9315; val_best_acc_score: 0.8968; val_best_f1_score: 0.9010; train_kl_reg_loss: 80689.5939; train_edge_recon_loss: 2707338.1212; train_gene_expr_recon_loss: 10112865.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25086.8139; train_chrom_access_recon_loss: 35547699.1818; train_global_loss: 48473679.1515; train_optim_loss: 48473679.1515; val_kl_reg_loss: 73099.1602; val_edge_recon_loss: 2758354.0938; val_gene_expr_recon_loss: 9963187.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25065.9609; val_chrom_access_recon_loss: 34857808.5000; val_global_loss: 47677515.0000; val_optim_loss: 47677515.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9476; val_auprc_score: 0.9270; val_best_acc_score: 0.8984; val_best_f1_score: 0.9040; train_kl_reg_loss: 79189.7812; train_edge_recon_loss: 2705483.3030; train_gene_expr_recon_loss: 10117115.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24984.4743; train_chrom_access_recon_loss: 35465836.7273; train_global_loss: 48392609.8182; train_optim_loss: 48392609.8182; val_kl_reg_loss: 74488.2646; val_edge_recon_loss: 2750951.1875; val_gene_expr_recon_loss: 9943406.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24991.4844; val_chrom_access_recon_loss: 34960658.5000; val_global_loss: 47754495.5000; val_optim_loss: 47754495.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9485; val_auprc_score: 0.9264; val_best_acc_score: 0.9009; val_best_f1_score: 0.9067; train_kl_reg_loss: 77215.5148; train_edge_recon_loss: 2705956.2424; train_gene_expr_recon_loss: 10113489.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24950.0583; train_chrom_access_recon_loss: 35425853.1515; train_global_loss: 48347465.0303; train_optim_loss: 48347465.0303; val_kl_reg_loss: 63806.2622; val_edge_recon_loss: 2753094.4375; val_gene_expr_recon_loss: 9966126.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24873.0898; val_chrom_access_recon_loss: 34934422.0000; val_global_loss: 47742322.0000; val_optim_loss: 47742322.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9433; val_auprc_score: 0.9205; val_best_acc_score: 0.8933; val_best_f1_score: 0.8987; train_kl_reg_loss: 106956.6874; train_edge_recon_loss: 2728101.8106; train_gene_expr_recon_loss: 10176129.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24713.5834; train_chrom_access_recon_loss: 35569623.8788; train_global_loss: 48605525.4545; train_optim_loss: 48605525.4545; val_kl_reg_loss: 75626.8262; val_edge_recon_loss: 2745837.4062; val_gene_expr_recon_loss: 9943267.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24401.5273; val_chrom_access_recon_loss: 35142742.0000; val_global_loss: 47931876.0000; val_optim_loss: 47931876.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9395; val_auprc_score: 0.9155; val_best_acc_score: 0.8901; val_best_f1_score: 0.8963; train_kl_reg_loss: 80386.9308; train_edge_recon_loss: 2708754.4659; train_gene_expr_recon_loss: 10098331.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22771.0078; train_chrom_access_recon_loss: 35376166.7879; train_global_loss: 48286410.7273; train_optim_loss: 48286410.7273; val_kl_reg_loss: 75976.7021; val_edge_recon_loss: 2755944.1250; val_gene_expr_recon_loss: 9994777.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22375.5625; val_chrom_access_recon_loss: 35052843.7500; val_global_loss: 47901918.5000; val_optim_loss: 47901918.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9435; val_auprc_score: 0.9176; val_best_acc_score: 0.8925; val_best_f1_score: 0.8988; train_kl_reg_loss: 81136.1665; train_edge_recon_loss: 2705103.6780; train_gene_expr_recon_loss: 10091297.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22294.7599; train_chrom_access_recon_loss: 35376783.2727; train_global_loss: 48276615.0909; train_optim_loss: 48276615.0909; val_kl_reg_loss: 76273.0234; val_edge_recon_loss: 2749109.4688; val_gene_expr_recon_loss: 9818687.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22228.3242; val_chrom_access_recon_loss: 34411685.5000; val_global_loss: 47077984.0000; val_optim_loss: 47077984.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9487; val_auprc_score: 0.9288; val_best_acc_score: 0.8963; val_best_f1_score: 0.9021; train_kl_reg_loss: 81434.5971; train_edge_recon_loss: 2703725.0303; train_gene_expr_recon_loss: 10087664.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22185.2069; train_chrom_access_recon_loss: 35347317.2727; train_global_loss: 48242326.9091; train_optim_loss: 48242326.9091; val_kl_reg_loss: 76438.1738; val_edge_recon_loss: 2757928.5312; val_gene_expr_recon_loss: 9881522.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22142.7637; val_chrom_access_recon_loss: 34742800.5000; val_global_loss: 47480832.5000; val_optim_loss: 47480832.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9488; val_auprc_score: 0.9267; val_best_acc_score: 0.8968; val_best_f1_score: 0.9015; train_kl_reg_loss: 81368.6731; train_edge_recon_loss: 2693197.2424; train_gene_expr_recon_loss: 10078208.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22118.6125; train_chrom_access_recon_loss: 35304363.9394; train_global_loss: 48179256.6061; train_optim_loss: 48179256.6061; val_kl_reg_loss: 76708.0400; val_edge_recon_loss: 2770050.6250; val_gene_expr_recon_loss: 9841318.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22083.2598; val_chrom_access_recon_loss: 34648559.5000; val_global_loss: 47358720.0000; val_optim_loss: 47358720.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9480; val_auprc_score: 0.9271; val_best_acc_score: 0.8966; val_best_f1_score: 0.9014; train_kl_reg_loss: 81511.8300; train_edge_recon_loss: 2694504.6553; train_gene_expr_recon_loss: 10074949.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22049.1586; train_chrom_access_recon_loss: 35316524.0000; train_global_loss: 48189538.6667; train_optim_loss: 48189538.6667; val_kl_reg_loss: 76540.0869; val_edge_recon_loss: 2758089.0000; val_gene_expr_recon_loss: 9771792.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22025.1914; val_chrom_access_recon_loss: 34520630.5000; val_global_loss: 47149076.5000; val_optim_loss: 47149076.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9521; val_auprc_score: 0.9346; val_best_acc_score: 0.9014; val_best_f1_score: 0.9064; train_kl_reg_loss: 81497.7634; train_edge_recon_loss: 2699693.0114; train_gene_expr_recon_loss: 10075500.1212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21998.3786; train_chrom_access_recon_loss: 35312100.4242; train_global_loss: 48190789.3939; train_optim_loss: 48190789.3939; val_kl_reg_loss: 77199.4697; val_edge_recon_loss: 2735644.2812; val_gene_expr_recon_loss: 9848808.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21979.2051; val_chrom_access_recon_loss: 34586321.0000; val_global_loss: 47269953.0000; val_optim_loss: 47269953.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9528; val_auprc_score: 0.9331; val_best_acc_score: 0.9049; val_best_f1_score: 0.9093; train_kl_reg_loss: 81525.4367; train_edge_recon_loss: 2702934.5152; train_gene_expr_recon_loss: 10063402.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21814.1609; train_chrom_access_recon_loss: 35275771.8788; train_global_loss: 48145448.3030; train_optim_loss: 48145448.3030; val_kl_reg_loss: 78294.2412; val_edge_recon_loss: 2708545.8125; val_gene_expr_recon_loss: 9889817.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21777.4590; val_chrom_access_recon_loss: 34503789.5000; val_global_loss: 47202225.0000; val_optim_loss: 47202225.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9446; val_auprc_score: 0.9212; val_best_acc_score: 0.8907; val_best_f1_score: 0.8973; train_kl_reg_loss: 81647.3739; train_edge_recon_loss: 2709110.2955; train_gene_expr_recon_loss: 10074946.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21770.6960; train_chrom_access_recon_loss: 35305639.8788; train_global_loss: 48193115.2727; train_optim_loss: 48193115.2727; val_kl_reg_loss: 76696.4053; val_edge_recon_loss: 2757211.2500; val_gene_expr_recon_loss: 9792036.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21764.8613; val_chrom_access_recon_loss: 34406909.0000; val_global_loss: 47054618.5000; val_optim_loss: 47054618.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9504; val_auprc_score: 0.9312; val_best_acc_score: 0.8998; val_best_f1_score: 0.9055; train_kl_reg_loss: 81563.1501; train_edge_recon_loss: 2706074.6629; train_gene_expr_recon_loss: 10066927.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21759.8403; train_chrom_access_recon_loss: 35274778.2424; train_global_loss: 48151103.1515; train_optim_loss: 48151103.1515; val_kl_reg_loss: 76954.5566; val_edge_recon_loss: 2741421.1875; val_gene_expr_recon_loss: 9913829.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21754.7324; val_chrom_access_recon_loss: 34814851.5000; val_global_loss: 47568811.5000; val_optim_loss: 47568811.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9538; val_auprc_score: 0.9387; val_best_acc_score: 0.9033; val_best_f1_score: 0.9072; train_kl_reg_loss: 81475.1336; train_edge_recon_loss: 2695614.0871; train_gene_expr_recon_loss: 10070379.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21752.0895; train_chrom_access_recon_loss: 35264818.8485; train_global_loss: 48134039.2121; train_optim_loss: 48134039.2121; val_kl_reg_loss: 77186.8066; val_edge_recon_loss: 2717703.0000; val_gene_expr_recon_loss: 9867841.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21748.4727; val_chrom_access_recon_loss: 34483711.7500; val_global_loss: 47168192.0000; val_optim_loss: 47168192.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9460; val_auprc_score: 0.9247; val_best_acc_score: 0.8907; val_best_f1_score: 0.8966; train_kl_reg_loss: 81646.4015; train_edge_recon_loss: 2689948.8674; train_gene_expr_recon_loss: 10071484.1212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21745.3973; train_chrom_access_recon_loss: 35288621.6667; train_global_loss: 48153446.0000; train_optim_loss: 48153446.0000; val_kl_reg_loss: 76986.9639; val_edge_recon_loss: 2747192.3438; val_gene_expr_recon_loss: 9832117.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21742.5820; val_chrom_access_recon_loss: 34358844.5000; val_global_loss: 47036884.0000; val_optim_loss: 47036884.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9504; val_auprc_score: 0.9259; val_best_acc_score: 0.8966; val_best_f1_score: 0.9014; train_kl_reg_loss: 81676.1934; train_edge_recon_loss: 2703561.0530; train_gene_expr_recon_loss: 10068455.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21739.3550; train_chrom_access_recon_loss: 35294892.9091; train_global_loss: 48170325.0303; train_optim_loss: 48170325.0303; val_kl_reg_loss: 77184.4668; val_edge_recon_loss: 2729735.5625; val_gene_expr_recon_loss: 9864384.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21736.0664; val_chrom_access_recon_loss: 34571505.5000; val_global_loss: 47264545.5000; val_optim_loss: 47264545.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9507; val_auprc_score: 0.9359; val_best_acc_score: 0.8949; val_best_f1_score: 0.9005; train_kl_reg_loss: 81781.5584; train_edge_recon_loss: 2694333.4924; train_gene_expr_recon_loss: 10068727.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21733.4811; train_chrom_access_recon_loss: 35284413.2121; train_global_loss: 48150989.2727; train_optim_loss: 48150989.2727; val_kl_reg_loss: 76581.1338; val_edge_recon_loss: 2756662.9375; val_gene_expr_recon_loss: 9892922.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21730.1094; val_chrom_access_recon_loss: 34529858.5000; val_global_loss: 47277755.0000; val_optim_loss: 47277755.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9497; val_auprc_score: 0.9291; val_best_acc_score: 0.8990; val_best_f1_score: 0.9041; train_kl_reg_loss: 81537.9231; train_edge_recon_loss: 2701590.3750; train_gene_expr_recon_loss: 10063575.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21728.4542; train_chrom_access_recon_loss: 35262290.6667; train_global_loss: 48130723.2727; train_optim_loss: 48130723.2727; val_kl_reg_loss: 77149.0439; val_edge_recon_loss: 2724551.1875; val_gene_expr_recon_loss: 9810191.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21724.9512; val_chrom_access_recon_loss: 34326533.0000; val_global_loss: 46960149.5000; val_optim_loss: 46960149.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9460; val_auprc_score: 0.9251; val_best_acc_score: 0.8923; val_best_f1_score: 0.8983; train_kl_reg_loss: 81651.0374; train_edge_recon_loss: 2693645.5341; train_gene_expr_recon_loss: 10068662.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21722.5568; train_chrom_access_recon_loss: 35308312.6667; train_global_loss: 48173994.0000; train_optim_loss: 48173994.0000; val_kl_reg_loss: 77253.2100; val_edge_recon_loss: 2749110.0938; val_gene_expr_recon_loss: 9899132.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21720.2852; val_chrom_access_recon_loss: 34482965.0000; val_global_loss: 47230181.0000; val_optim_loss: 47230181.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9482; val_auprc_score: 0.9319; val_best_acc_score: 0.8976; val_best_f1_score: 0.9038; train_kl_reg_loss: 81767.7116; train_edge_recon_loss: 2687392.1402; train_gene_expr_recon_loss: 10060261.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21717.6124; train_chrom_access_recon_loss: 35249682.1818; train_global_loss: 48100821.2727; train_optim_loss: 48100821.2727; val_kl_reg_loss: 76798.4395; val_edge_recon_loss: 2725914.0312; val_gene_expr_recon_loss: 9848242.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21715.2227; val_chrom_access_recon_loss: 34537909.5000; val_global_loss: 47210579.5000; val_optim_loss: 47210579.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9528; val_auprc_score: 0.9364; val_best_acc_score: 0.8979; val_best_f1_score: 0.9031; train_kl_reg_loss: 81740.4497; train_edge_recon_loss: 2700373.6591; train_gene_expr_recon_loss: 10063626.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21713.5837; train_chrom_access_recon_loss: 35269750.9697; train_global_loss: 48137205.5152; train_optim_loss: 48137205.5152; val_kl_reg_loss: 78097.2295; val_edge_recon_loss: 2727091.9062; val_gene_expr_recon_loss: 9988646.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21709.9902; val_chrom_access_recon_loss: 35071370.0000; val_global_loss: 47886915.5000; val_optim_loss: 47886915.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9493; val_auprc_score: 0.9285; val_best_acc_score: 0.8992; val_best_f1_score: 0.9040; train_kl_reg_loss: 81938.5397; train_edge_recon_loss: 2692218.9545; train_gene_expr_recon_loss: 10069830.6818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21708.0905; train_chrom_access_recon_loss: 35293963.5455; train_global_loss: 48159659.8182; train_optim_loss: 48159659.8182; val_kl_reg_loss: 77820.9727; val_edge_recon_loss: 2720587.4688; val_gene_expr_recon_loss: 9941920.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21705.6191; val_chrom_access_recon_loss: 34726107.2500; val_global_loss: 47488142.0000; val_optim_loss: 47488142.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9453; val_auprc_score: 0.9187; val_best_acc_score: 0.8974; val_best_f1_score: 0.9027; train_kl_reg_loss: 81698.0481; train_edge_recon_loss: 2701534.9394; train_gene_expr_recon_loss: 10066782.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21687.8148; train_chrom_access_recon_loss: 35256206.1818; train_global_loss: 48127909.1515; train_optim_loss: 48127909.1515; val_kl_reg_loss: 77421.4580; val_edge_recon_loss: 2734333.0000; val_gene_expr_recon_loss: 9816966.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21683.9629; val_chrom_access_recon_loss: 34330764.7500; val_global_loss: 46981170.0000; val_optim_loss: 46981170.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9548; val_auprc_score: 0.9386; val_best_acc_score: 0.9025; val_best_f1_score: 0.9070; train_kl_reg_loss: 81851.3589; train_edge_recon_loss: 2704016.2235; train_gene_expr_recon_loss: 10070661.1212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21683.2799; train_chrom_access_recon_loss: 35302639.0000; train_global_loss: 48180851.2121; train_optim_loss: 48180851.2121; val_kl_reg_loss: 77270.4717; val_edge_recon_loss: 2726563.5000; val_gene_expr_recon_loss: 9895475.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21682.7305; val_chrom_access_recon_loss: 34883242.2500; val_global_loss: 47604235.5000; val_optim_loss: 47604235.5000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9508; val_auprc_score: 0.9293; val_best_acc_score: 0.9003; val_best_f1_score: 0.9061; train_kl_reg_loss: 81636.5333; train_edge_recon_loss: 2697695.2879; train_gene_expr_recon_loss: 10066562.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21682.2893; train_chrom_access_recon_loss: 35251513.5455; train_global_loss: 48119090.1212; train_optim_loss: 48119090.1212; val_kl_reg_loss: 77568.2471; val_edge_recon_loss: 2744986.3438; val_gene_expr_recon_loss: 9936470.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21681.7559; val_chrom_access_recon_loss: 35070528.0000; val_global_loss: 47851234.5000; val_optim_loss: 47851234.5000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9419; val_auprc_score: 0.9173; val_best_acc_score: 0.8936; val_best_f1_score: 0.8996; train_kl_reg_loss: 81783.2016; train_edge_recon_loss: 2692881.3598; train_gene_expr_recon_loss: 10068989.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21681.3878; train_chrom_access_recon_loss: 35287496.0000; train_global_loss: 48152831.3333; train_optim_loss: 48152831.3333; val_kl_reg_loss: 76958.9717; val_edge_recon_loss: 2742669.1875; val_gene_expr_recon_loss: 9809018.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21680.9355; val_chrom_access_recon_loss: 34481711.0000; val_global_loss: 47132038.0000; val_optim_loss: 47132038.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 62 min 36 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9404
val AUPRC score: 0.9171
val best accuracy score: 0.8896
val best F1 score: 0.8969
val target rna MSE score: 1.5745
val source rna MSE score: 0.6354
val target atac MSE score: 0.1182
val source atac MSE score: 0.0279
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
