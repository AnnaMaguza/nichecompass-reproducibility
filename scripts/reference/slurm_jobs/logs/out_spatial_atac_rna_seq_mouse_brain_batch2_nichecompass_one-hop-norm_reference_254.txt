[True]
Run timestamp: 10102023_120107_254.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_254']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7769; val_auprc_score: 0.8030; val_best_acc_score: 0.5162; val_best_f1_score: 0.6721; train_kl_reg_loss: 57552.5628; train_edge_recon_loss: 742544.1904; train_gene_expr_recon_loss: 22117383.3740; train_masked_gp_l1_reg_loss: 131043.8176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3246800.1283; train_chrom_access_recon_loss: 11241584.5496; train_global_loss: 37536908.6565; train_optim_loss: 37536908.6565; val_kl_reg_loss: 76489.8813; val_edge_recon_loss: 812808.0625; val_gene_expr_recon_loss: 20944534.2667; val_masked_gp_l1_reg_loss: 109788.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 732512.5625; val_chrom_access_recon_loss: 10703722.4667; val_global_loss: 33379854.5333; val_optim_loss: 33379854.5333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8481; val_auprc_score: 0.8585; val_best_acc_score: 0.7071; val_best_f1_score: 0.7572; train_kl_reg_loss: 73246.7207; train_edge_recon_loss: 735443.8550; train_gene_expr_recon_loss: 20881424.8550; train_masked_gp_l1_reg_loss: 104505.5596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 381360.5753; train_chrom_access_recon_loss: 10862227.5954; train_global_loss: 33038209.3893; train_optim_loss: 33038209.3893; val_kl_reg_loss: 72230.2557; val_edge_recon_loss: 808843.0833; val_gene_expr_recon_loss: 20607481.2000; val_masked_gp_l1_reg_loss: 103079.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 222139.5938; val_chrom_access_recon_loss: 10601731.0667; val_global_loss: 32415505.3333; val_optim_loss: 32415505.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9049; val_auprc_score: 0.9016; val_best_acc_score: 0.8124; val_best_f1_score: 0.8268; train_kl_reg_loss: 65420.8138; train_edge_recon_loss: 724473.8879; train_gene_expr_recon_loss: 20594977.7099; train_masked_gp_l1_reg_loss: 103760.4545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180117.2908; train_chrom_access_recon_loss: 10711547.5725; train_global_loss: 32380297.5115; train_optim_loss: 32380297.5115; val_kl_reg_loss: 63578.9781; val_edge_recon_loss: 762568.7583; val_gene_expr_recon_loss: 20427351.2000; val_masked_gp_l1_reg_loss: 106040.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155172.5938; val_chrom_access_recon_loss: 10480396.7333; val_global_loss: 31995107.6000; val_optim_loss: 31995107.6000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9034; val_auprc_score: 0.8987; val_best_acc_score: 0.8178; val_best_f1_score: 0.8277; train_kl_reg_loss: 64412.5394; train_edge_recon_loss: 678040.7901; train_gene_expr_recon_loss: 20364098.7481; train_masked_gp_l1_reg_loss: 108589.2263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142003.5203; train_chrom_access_recon_loss: 10603195.8244; train_global_loss: 31960340.7176; train_optim_loss: 31960340.7176; val_kl_reg_loss: 71953.0844; val_edge_recon_loss: 650135.2125; val_gene_expr_recon_loss: 20284187.7333; val_masked_gp_l1_reg_loss: 111473.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131507.4062; val_chrom_access_recon_loss: 10460984.6667; val_global_loss: 31710242.5333; val_optim_loss: 31710242.5333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9144; val_auprc_score: 0.9020; val_best_acc_score: 0.8328; val_best_f1_score: 0.8440; train_kl_reg_loss: 73241.2182; train_edge_recon_loss: 635854.4876; train_gene_expr_recon_loss: 20159268.5191; train_masked_gp_l1_reg_loss: 112514.6581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123548.4414; train_chrom_access_recon_loss: 10499728.7099; train_global_loss: 31604156.1374; train_optim_loss: 31604156.1374; val_kl_reg_loss: 73709.3276; val_edge_recon_loss: 631792.7458; val_gene_expr_recon_loss: 20077560.5333; val_masked_gp_l1_reg_loss: 114385.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118561.9609; val_chrom_access_recon_loss: 10324923.3333; val_global_loss: 31340934.2667; val_optim_loss: 31340934.2667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9267; val_auprc_score: 0.9127; val_best_acc_score: 0.8548; val_best_f1_score: 0.8624; train_kl_reg_loss: 73099.8989; train_edge_recon_loss: 623397.8397; train_gene_expr_recon_loss: 20003079.9542; train_masked_gp_l1_reg_loss: 115025.2932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113286.1422; train_chrom_access_recon_loss: 10432796.0305; train_global_loss: 31360685.1450; train_optim_loss: 31360685.1450; val_kl_reg_loss: 72135.5172; val_edge_recon_loss: 618065.4250; val_gene_expr_recon_loss: 19894929.0667; val_masked_gp_l1_reg_loss: 116064.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108959.4297; val_chrom_access_recon_loss: 10225954.2000; val_global_loss: 31036108.4000; val_optim_loss: 31036108.4000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9293; val_auprc_score: 0.9177; val_best_acc_score: 0.8592; val_best_f1_score: 0.8690; train_kl_reg_loss: 72827.7301; train_edge_recon_loss: 612869.8989; train_gene_expr_recon_loss: 19860120.0611; train_masked_gp_l1_reg_loss: 116601.1345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106215.7801; train_chrom_access_recon_loss: 10345870.3206; train_global_loss: 31114505.0229; train_optim_loss: 31114505.0229; val_kl_reg_loss: 72864.9604; val_edge_recon_loss: 609463.7500; val_gene_expr_recon_loss: 19804764.8000; val_masked_gp_l1_reg_loss: 117055.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103305.9531; val_chrom_access_recon_loss: 10204063.2000; val_global_loss: 30911518.8000; val_optim_loss: 30911518.8000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9364; val_auprc_score: 0.9251; val_best_acc_score: 0.8658; val_best_f1_score: 0.8732; train_kl_reg_loss: 71535.9382; train_edge_recon_loss: 611454.1980; train_gene_expr_recon_loss: 19771231.8015; train_masked_gp_l1_reg_loss: 117669.7997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101615.9835; train_chrom_access_recon_loss: 10298327.9160; train_global_loss: 30971835.5267; train_optim_loss: 30971835.5267; val_kl_reg_loss: 71321.2208; val_edge_recon_loss: 610115.6500; val_gene_expr_recon_loss: 19624180.6667; val_masked_gp_l1_reg_loss: 118337.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100363.7422; val_chrom_access_recon_loss: 10132309.6000; val_global_loss: 30656629.3333; val_optim_loss: 30656629.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9392; val_auprc_score: 0.9281; val_best_acc_score: 0.8693; val_best_f1_score: 0.8755; train_kl_reg_loss: 70595.8904; train_edge_recon_loss: 606821.9280; train_gene_expr_recon_loss: 19638180.5496; train_masked_gp_l1_reg_loss: 118640.0875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99078.9472; train_chrom_access_recon_loss: 10210534.2290; train_global_loss: 30743851.6489; train_optim_loss: 30743851.6489; val_kl_reg_loss: 70331.9578; val_edge_recon_loss: 606164.6625; val_gene_expr_recon_loss: 19526481.6000; val_masked_gp_l1_reg_loss: 119110.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97497.3984; val_chrom_access_recon_loss: 10034574.0000; val_global_loss: 30454160.6667; val_optim_loss: 30454160.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9407; val_auprc_score: 0.9270; val_best_acc_score: 0.8713; val_best_f1_score: 0.8772; train_kl_reg_loss: 70057.5346; train_edge_recon_loss: 601606.8106; train_gene_expr_recon_loss: 19541554.1679; train_masked_gp_l1_reg_loss: 119553.2056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97286.6521; train_chrom_access_recon_loss: 10151580.0076; train_global_loss: 30581638.3053; train_optim_loss: 30581638.3053; val_kl_reg_loss: 71063.0698; val_edge_recon_loss: 606959.7583; val_gene_expr_recon_loss: 19500113.7333; val_masked_gp_l1_reg_loss: 119826.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96647.1094; val_chrom_access_recon_loss: 10007240.6667; val_global_loss: 30401851.6000; val_optim_loss: 30401851.6000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9476; val_auprc_score: 0.9366; val_best_acc_score: 0.8832; val_best_f1_score: 0.8880; train_kl_reg_loss: 69898.5790; train_edge_recon_loss: 598435.5792; train_gene_expr_recon_loss: 19464232.7481; train_masked_gp_l1_reg_loss: 120280.9768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95534.8287; train_chrom_access_recon_loss: 10112233.2595; train_global_loss: 30460615.9542; train_optim_loss: 30460615.9542; val_kl_reg_loss: 69056.9255; val_edge_recon_loss: 599273.9375; val_gene_expr_recon_loss: 19411298.9333; val_masked_gp_l1_reg_loss: 120664.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94637.9609; val_chrom_access_recon_loss: 9948653.9333; val_global_loss: 30243585.8667; val_optim_loss: 30243585.8667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9505; val_auprc_score: 0.9411; val_best_acc_score: 0.8841; val_best_f1_score: 0.8880; train_kl_reg_loss: 68760.6277; train_edge_recon_loss: 599245.1217; train_gene_expr_recon_loss: 19371138.8702; train_masked_gp_l1_reg_loss: 121053.8853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94147.6501; train_chrom_access_recon_loss: 10046666.2901; train_global_loss: 30301012.4580; train_optim_loss: 30301012.4580; val_kl_reg_loss: 68303.1352; val_edge_recon_loss: 600220.0458; val_gene_expr_recon_loss: 19224235.8667; val_masked_gp_l1_reg_loss: 121717.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93280.9297; val_chrom_access_recon_loss: 9871585.6000; val_global_loss: 29979342.4000; val_optim_loss: 29979342.4000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9515; val_auprc_score: 0.9403; val_best_acc_score: 0.8929; val_best_f1_score: 0.8978; train_kl_reg_loss: 68347.1471; train_edge_recon_loss: 594801.6465; train_gene_expr_recon_loss: 19290299.1908; train_masked_gp_l1_reg_loss: 121922.3299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92618.9992; train_chrom_access_recon_loss: 9991600.7481; train_global_loss: 30159590.1374; train_optim_loss: 30159590.1374; val_kl_reg_loss: 67607.5844; val_edge_recon_loss: 598308.3708; val_gene_expr_recon_loss: 19170682.1333; val_masked_gp_l1_reg_loss: 122382.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92027.6797; val_chrom_access_recon_loss: 9896517.0000; val_global_loss: 29947524.9333; val_optim_loss: 29947524.9333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9517; val_auprc_score: 0.9418; val_best_acc_score: 0.8872; val_best_f1_score: 0.8935; train_kl_reg_loss: 67954.8969; train_edge_recon_loss: 594655.8158; train_gene_expr_recon_loss: 19214457.2824; train_masked_gp_l1_reg_loss: 122554.0438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91552.2640; train_chrom_access_recon_loss: 9935779.0763; train_global_loss: 30026953.2672; train_optim_loss: 30026953.2672; val_kl_reg_loss: 68484.8490; val_edge_recon_loss: 599076.9917; val_gene_expr_recon_loss: 19162249.7333; val_masked_gp_l1_reg_loss: 123198.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91138.2031; val_chrom_access_recon_loss: 9771955.2000; val_global_loss: 29816102.9333; val_optim_loss: 29816102.9333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9563; val_auprc_score: 0.9441; val_best_acc_score: 0.8952; val_best_f1_score: 0.9005; train_kl_reg_loss: 67676.5495; train_edge_recon_loss: 592232.9881; train_gene_expr_recon_loss: 19168211.8473; train_masked_gp_l1_reg_loss: 123316.7681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90823.0952; train_chrom_access_recon_loss: 9886758.2061; train_global_loss: 29929019.4504; train_optim_loss: 29929019.4504; val_kl_reg_loss: 67464.6260; val_edge_recon_loss: 592259.5417; val_gene_expr_recon_loss: 19122149.0667; val_masked_gp_l1_reg_loss: 123600.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90367.3984; val_chrom_access_recon_loss: 9772956.0000; val_global_loss: 29768797.3333; val_optim_loss: 29768797.3333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9570; val_auprc_score: 0.9475; val_best_acc_score: 0.9006; val_best_f1_score: 0.9047; train_kl_reg_loss: 67421.1929; train_edge_recon_loss: 591911.7600; train_gene_expr_recon_loss: 19099261.7557; train_masked_gp_l1_reg_loss: 124069.2521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89979.9200; train_chrom_access_recon_loss: 9826584.7023; train_global_loss: 29799228.5496; train_optim_loss: 29799228.5496; val_kl_reg_loss: 68692.4839; val_edge_recon_loss: 595611.3375; val_gene_expr_recon_loss: 19015356.0000; val_masked_gp_l1_reg_loss: 124242.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90240.6562; val_chrom_access_recon_loss: 9684102.9333; val_global_loss: 29578244.8000; val_optim_loss: 29578244.8000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9581; val_auprc_score: 0.9498; val_best_acc_score: 0.8956; val_best_f1_score: 0.8996; train_kl_reg_loss: 67097.9493; train_edge_recon_loss: 592776.6360; train_gene_expr_recon_loss: 19036146.7786; train_masked_gp_l1_reg_loss: 124664.8827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89544.7237; train_chrom_access_recon_loss: 9776936.7023; train_global_loss: 29687167.8779; train_optim_loss: 29687167.8779; val_kl_reg_loss: 68271.9589; val_edge_recon_loss: 598830.2167; val_gene_expr_recon_loss: 19063845.3333; val_masked_gp_l1_reg_loss: 125604.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89882.1484; val_chrom_access_recon_loss: 9733198.7333; val_global_loss: 29679632.2667; val_optim_loss: 29679632.2667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9612; val_auprc_score: 0.9518; val_best_acc_score: 0.9023; val_best_f1_score: 0.9063; train_kl_reg_loss: 67084.2507; train_edge_recon_loss: 590989.5406; train_gene_expr_recon_loss: 18983312.6412; train_masked_gp_l1_reg_loss: 125598.8074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89386.2371; train_chrom_access_recon_loss: 9722096.5496; train_global_loss: 29578467.9695; train_optim_loss: 29578467.9695; val_kl_reg_loss: 66899.2953; val_edge_recon_loss: 593877.7125; val_gene_expr_recon_loss: 19008186.5333; val_masked_gp_l1_reg_loss: 125591.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88535.0625; val_chrom_access_recon_loss: 9609524.2667; val_global_loss: 29492615.8667; val_optim_loss: 29492615.8667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9606; val_auprc_score: 0.9516; val_best_acc_score: 0.9025; val_best_f1_score: 0.9064; train_kl_reg_loss: 67651.1310; train_edge_recon_loss: 591930.6813; train_gene_expr_recon_loss: 18940780.7328; train_masked_gp_l1_reg_loss: 126720.2140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88816.9232; train_chrom_access_recon_loss: 9694934.5725; train_global_loss: 29510834.1832; train_optim_loss: 29510834.1832; val_kl_reg_loss: 67983.9052; val_edge_recon_loss: 594313.2333; val_gene_expr_recon_loss: 18931837.6000; val_masked_gp_l1_reg_loss: 127348.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89366.9375; val_chrom_access_recon_loss: 9629929.8000; val_global_loss: 29440778.5333; val_optim_loss: 29440778.5333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9583; val_auprc_score: 0.9464; val_best_acc_score: 0.8996; val_best_f1_score: 0.9049; train_kl_reg_loss: 68030.8938; train_edge_recon_loss: 591355.3593; train_gene_expr_recon_loss: 18894004.8244; train_masked_gp_l1_reg_loss: 127705.1752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88976.6603; train_chrom_access_recon_loss: 9662535.3359; train_global_loss: 29432608.1221; train_optim_loss: 29432608.1221; val_kl_reg_loss: 67998.0099; val_edge_recon_loss: 597124.8958; val_gene_expr_recon_loss: 18965797.2000; val_masked_gp_l1_reg_loss: 128471.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89806.8125; val_chrom_access_recon_loss: 9617980.6667; val_global_loss: 29467178.6667; val_optim_loss: 29467178.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9625; val_auprc_score: 0.9519; val_best_acc_score: 0.9088; val_best_f1_score: 0.9126; train_kl_reg_loss: 67277.1795; train_edge_recon_loss: 591514.5725; train_gene_expr_recon_loss: 18833130.6870; train_masked_gp_l1_reg_loss: 128223.4667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88985.4101; train_chrom_access_recon_loss: 9605652.3588; train_global_loss: 29314783.8626; train_optim_loss: 29314783.8626; val_kl_reg_loss: 66248.9622; val_edge_recon_loss: 589171.7625; val_gene_expr_recon_loss: 18918179.2000; val_masked_gp_l1_reg_loss: 128701.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89910.2656; val_chrom_access_recon_loss: 9575067.9333; val_global_loss: 29367280.0000; val_optim_loss: 29367280.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9643; val_auprc_score: 0.9569; val_best_acc_score: 0.9069; val_best_f1_score: 0.9092; train_kl_reg_loss: 67909.6337; train_edge_recon_loss: 587599.4742; train_gene_expr_recon_loss: 18796232.7176; train_masked_gp_l1_reg_loss: 128612.9900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89038.9653; train_chrom_access_recon_loss: 9556074.1679; train_global_loss: 29225467.9847; train_optim_loss: 29225467.9847; val_kl_reg_loss: 66848.1815; val_edge_recon_loss: 592001.1958; val_gene_expr_recon_loss: 18824917.3333; val_masked_gp_l1_reg_loss: 128828.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88682.1484; val_chrom_access_recon_loss: 9540489.2000; val_global_loss: 29241766.2667; val_optim_loss: 29241766.2667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9644; val_auprc_score: 0.9555; val_best_acc_score: 0.9085; val_best_f1_score: 0.9118; train_kl_reg_loss: 67565.0862; train_edge_recon_loss: 590194.3497; train_gene_expr_recon_loss: 18752693.9084; train_masked_gp_l1_reg_loss: 129168.3084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88718.5528; train_chrom_access_recon_loss: 9515351.6260; train_global_loss: 29143691.8168; train_optim_loss: 29143691.8168; val_kl_reg_loss: 64697.8682; val_edge_recon_loss: 588754.3333; val_gene_expr_recon_loss: 18818759.4667; val_masked_gp_l1_reg_loss: 129401.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89134.8125; val_chrom_access_recon_loss: 9527724.3333; val_global_loss: 29218471.8667; val_optim_loss: 29218471.8667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9661; val_auprc_score: 0.9552; val_best_acc_score: 0.9161; val_best_f1_score: 0.9179; train_kl_reg_loss: 67722.3568; train_edge_recon_loss: 588830.1064; train_gene_expr_recon_loss: 18726175.1756; train_masked_gp_l1_reg_loss: 129785.2405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88741.5010; train_chrom_access_recon_loss: 9480477.5115; train_global_loss: 29081731.9695; train_optim_loss: 29081731.9695; val_kl_reg_loss: 68018.6333; val_edge_recon_loss: 588562.2500; val_gene_expr_recon_loss: 18815118.1333; val_masked_gp_l1_reg_loss: 130668.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89793.4688; val_chrom_access_recon_loss: 9483916.0000; val_global_loss: 29176077.2000; val_optim_loss: 29176077.2000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9540; val_auprc_score: 0.9419; val_best_acc_score: 0.8933; val_best_f1_score: 0.8991; train_kl_reg_loss: 1538308725.3334; train_edge_recon_loss: 596338.9895; train_gene_expr_recon_loss: 18853510.0916; train_masked_gp_l1_reg_loss: 130925.6554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92786.9497; train_chrom_access_recon_loss: 9633237.8702; train_global_loss: 1567615721.6641; train_optim_loss: 1567615721.6641; val_kl_reg_loss: 73732.2604; val_edge_recon_loss: 594670.5708; val_gene_expr_recon_loss: 18870135.3333; val_masked_gp_l1_reg_loss: 127080.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94084.0938; val_chrom_access_recon_loss: 9605231.6000; val_global_loss: 29364933.3333; val_optim_loss: 29364933.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9489; val_auprc_score: 0.9381; val_best_acc_score: 0.8891; val_best_f1_score: 0.8937; train_kl_reg_loss: 357156694206.6649; train_edge_recon_loss: 692601.6927; train_gene_expr_recon_loss: 17722964.8244; train_masked_gp_l1_reg_loss: 117160.8734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81971.5872; train_chrom_access_recon_loss: 9218479.8626; train_global_loss: 357184511336.7634; train_optim_loss: 357184511336.7634; val_kl_reg_loss: 36108.1440; val_edge_recon_loss: 687279.6875; val_gene_expr_recon_loss: 17478533.8000; val_masked_gp_l1_reg_loss: 110964.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80762.1172; val_chrom_access_recon_loss: 9037027.0000; val_global_loss: 27430674.8000; val_optim_loss: 27430674.8000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9421; val_auprc_score: 0.9281; val_best_acc_score: 0.8777; val_best_f1_score: 0.8844; train_kl_reg_loss: 69757.0593; train_edge_recon_loss: 654467.0420; train_gene_expr_recon_loss: 17520742.1832; train_masked_gp_l1_reg_loss: 106126.4353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77446.4395; train_chrom_access_recon_loss: 9144405.0687; train_global_loss: 27572944.1985; train_optim_loss: 27572944.1985; val_kl_reg_loss: 40939.0419; val_edge_recon_loss: 636416.4042; val_gene_expr_recon_loss: 17383739.4667; val_masked_gp_l1_reg_loss: 103672.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76115.6484; val_chrom_access_recon_loss: 9006513.1333; val_global_loss: 27247395.4667; val_optim_loss: 27247395.4667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9351; val_auprc_score: 0.9223; val_best_acc_score: 0.8674; val_best_f1_score: 0.8735; train_kl_reg_loss: 2638370.2907; train_edge_recon_loss: 624539.5067; train_gene_expr_recon_loss: 17468504.2290; train_masked_gp_l1_reg_loss: 101895.8334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75481.5411; train_chrom_access_recon_loss: 9123125.5573; train_global_loss: 30031916.9466; train_optim_loss: 30031916.9466; val_kl_reg_loss: 47535.3271; val_edge_recon_loss: 625769.6917; val_gene_expr_recon_loss: 17356396.2000; val_masked_gp_l1_reg_loss: 99774.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75387.4453; val_chrom_access_recon_loss: 9022893.2667; val_global_loss: 27227756.1333; val_optim_loss: 27227756.1333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9326; val_auprc_score: 0.9191; val_best_acc_score: 0.8661; val_best_f1_score: 0.8723; train_kl_reg_loss: 116016085006.3263; train_edge_recon_loss: 611793.2161; train_gene_expr_recon_loss: 17394303.0305; train_masked_gp_l1_reg_loss: 98288.7658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74949.0072; train_chrom_access_recon_loss: 9114899.2557; train_global_loss: 116043380003.0534; train_optim_loss: 116043380003.0534; val_kl_reg_loss: 48319.7906; val_edge_recon_loss: 618453.6958; val_gene_expr_recon_loss: 17363569.0667; val_masked_gp_l1_reg_loss: 96887.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74192.5391; val_chrom_access_recon_loss: 8993499.0667; val_global_loss: 27194921.3333; val_optim_loss: 27194921.3333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9420; val_auprc_score: 0.9312; val_best_acc_score: 0.8727; val_best_f1_score: 0.8779; train_kl_reg_loss: 64857.6426; train_edge_recon_loss: 610854.5029; train_gene_expr_recon_loss: 17347429.4046; train_masked_gp_l1_reg_loss: 96119.6375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74536.5958; train_chrom_access_recon_loss: 9095268.1107; train_global_loss: 27289065.8779; train_optim_loss: 27289065.8779; val_kl_reg_loss: 50174.4240; val_edge_recon_loss: 622199.9292; val_gene_expr_recon_loss: 17429664.9333; val_masked_gp_l1_reg_loss: 96087.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74842.9375; val_chrom_access_recon_loss: 8968454.0000; val_global_loss: 27241423.3333; val_optim_loss: 27241423.3333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9406; val_auprc_score: 0.9312; val_best_acc_score: 0.8690; val_best_f1_score: 0.8748; train_kl_reg_loss: 66871.3703; train_edge_recon_loss: 609874.2343; train_gene_expr_recon_loss: 17344082.7023; train_masked_gp_l1_reg_loss: 95100.3341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75116.2151; train_chrom_access_recon_loss: 9079475.4351; train_global_loss: 27270520.3053; train_optim_loss: 27270520.3053; val_kl_reg_loss: 51956.5958; val_edge_recon_loss: 604983.3583; val_gene_expr_recon_loss: 17349941.4000; val_masked_gp_l1_reg_loss: 94775.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75335.0156; val_chrom_access_recon_loss: 9018531.8667; val_global_loss: 27195524.9333; val_optim_loss: 27195524.9333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9399; val_auprc_score: 0.9246; val_best_acc_score: 0.8742; val_best_f1_score: 0.8784; train_kl_reg_loss: 64324.5955; train_edge_recon_loss: 601762.8807; train_gene_expr_recon_loss: 17303239.4427; train_masked_gp_l1_reg_loss: 94554.2777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75404.1734; train_chrom_access_recon_loss: 9068606.6756; train_global_loss: 27207891.9695; train_optim_loss: 27207891.9695; val_kl_reg_loss: 53830.1352; val_edge_recon_loss: 603759.3000; val_gene_expr_recon_loss: 17310912.9333; val_masked_gp_l1_reg_loss: 94393.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75680.7734; val_chrom_access_recon_loss: 8989114.9333; val_global_loss: 27127691.4667; val_optim_loss: 27127691.4667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9371; val_auprc_score: 0.9242; val_best_acc_score: 0.8717; val_best_f1_score: 0.8760; train_kl_reg_loss: 2632801238315.4258; train_edge_recon_loss: 627981.4986; train_gene_expr_recon_loss: 17352705.6641; train_masked_gp_l1_reg_loss: 92827.5417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76672.7739; train_chrom_access_recon_loss: 9085149.1374; train_global_loss: 2632828516892.8091; train_optim_loss: 2632828516892.8091; val_kl_reg_loss: 50976.5823; val_edge_recon_loss: 618933.1917; val_gene_expr_recon_loss: 17285679.2000; val_masked_gp_l1_reg_loss: 91841.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77750.8672; val_chrom_access_recon_loss: 8938616.3333; val_global_loss: 27063797.2000; val_optim_loss: 27063797.2000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9375; val_auprc_score: 0.9237; val_best_acc_score: 0.8728; val_best_f1_score: 0.8792; train_kl_reg_loss: 115529.6453; train_edge_recon_loss: 609752.5076; train_gene_expr_recon_loss: 17333032.4885; train_masked_gp_l1_reg_loss: 91984.0298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77069.7886; train_chrom_access_recon_loss: 9071042.4656; train_global_loss: 27298410.9466; train_optim_loss: 27298410.9466; val_kl_reg_loss: 55341.8016; val_edge_recon_loss: 607869.7292; val_gene_expr_recon_loss: 17272463.5333; val_masked_gp_l1_reg_loss: 91889.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77365.4922; val_chrom_access_recon_loss: 8908839.1000; val_global_loss: 27013770.4000; val_optim_loss: 27013770.4000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9377; val_auprc_score: 0.9250; val_best_acc_score: 0.8708; val_best_f1_score: 0.8765; train_kl_reg_loss: 63702.8143; train_edge_recon_loss: 601457.5749; train_gene_expr_recon_loss: 17269145.1985; train_masked_gp_l1_reg_loss: 91739.2716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77056.2551; train_chrom_access_recon_loss: 9048128.7786; train_global_loss: 27151230.0000; train_optim_loss: 27151230.0000; val_kl_reg_loss: 54811.5286; val_edge_recon_loss: 607050.2167; val_gene_expr_recon_loss: 17260265.0000; val_masked_gp_l1_reg_loss: 91708.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77358.6250; val_chrom_access_recon_loss: 8923150.2000; val_global_loss: 27014343.2000; val_optim_loss: 27014343.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9406; val_auprc_score: 0.9254; val_best_acc_score: 0.8735; val_best_f1_score: 0.8776; train_kl_reg_loss: 76855.5329; train_edge_recon_loss: 598182.6985; train_gene_expr_recon_loss: 17259363.5038; train_masked_gp_l1_reg_loss: 91847.4020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77040.6260; train_chrom_access_recon_loss: 9051307.9198; train_global_loss: 27154597.7099; train_optim_loss: 27154597.7099; val_kl_reg_loss: 52495.8336; val_edge_recon_loss: 605665.6958; val_gene_expr_recon_loss: 17260737.2667; val_masked_gp_l1_reg_loss: 92231.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77550.3984; val_chrom_access_recon_loss: 8915912.7333; val_global_loss: 27004593.3333; val_optim_loss: 27004593.3333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9354; val_auprc_score: 0.9220; val_best_acc_score: 0.8685; val_best_f1_score: 0.8756; train_kl_reg_loss: 61641.0035; train_edge_recon_loss: 595705.3230; train_gene_expr_recon_loss: 17252282.2290; train_masked_gp_l1_reg_loss: 92081.0117; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77494.8473; train_chrom_access_recon_loss: 9041016.6260; train_global_loss: 27120221.0840; train_optim_loss: 27120221.0840; val_kl_reg_loss: 54556.2076; val_edge_recon_loss: 601232.0917; val_gene_expr_recon_loss: 17278408.3333; val_masked_gp_l1_reg_loss: 92088.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77294.3281; val_chrom_access_recon_loss: 8929493.9333; val_global_loss: 27033072.5333; val_optim_loss: 27033072.5333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9440; val_auprc_score: 0.9321; val_best_acc_score: 0.8773; val_best_f1_score: 0.8813; train_kl_reg_loss: 60888.5206; train_edge_recon_loss: 596883.5587; train_gene_expr_recon_loss: 17253304.3130; train_masked_gp_l1_reg_loss: 91955.4487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77616.8364; train_chrom_access_recon_loss: 9030308.1794; train_global_loss: 27110956.7939; train_optim_loss: 27110956.7939; val_kl_reg_loss: 51980.7297; val_edge_recon_loss: 600840.4500; val_gene_expr_recon_loss: 17168320.6667; val_masked_gp_l1_reg_loss: 91978.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77539.6406; val_chrom_access_recon_loss: 8849136.3667; val_global_loss: 26839796.1333; val_optim_loss: 26839796.1333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9436; val_auprc_score: 0.9307; val_best_acc_score: 0.8802; val_best_f1_score: 0.8848; train_kl_reg_loss: 59900.0652; train_edge_recon_loss: 595645.2662; train_gene_expr_recon_loss: 17224060.4504; train_masked_gp_l1_reg_loss: 91825.2810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77949.9957; train_chrom_access_recon_loss: 9032989.4809; train_global_loss: 27082370.4733; train_optim_loss: 27082370.4733; val_kl_reg_loss: 52344.3802; val_edge_recon_loss: 601050.6125; val_gene_expr_recon_loss: 17268440.2667; val_masked_gp_l1_reg_loss: 91803.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77686.1797; val_chrom_access_recon_loss: 8897758.9333; val_global_loss: 26989084.1333; val_optim_loss: 26989084.1333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9451; val_auprc_score: 0.9319; val_best_acc_score: 0.8810; val_best_f1_score: 0.8860; train_kl_reg_loss: 60687.6784; train_edge_recon_loss: 595226.6221; train_gene_expr_recon_loss: 17211223.8931; train_masked_gp_l1_reg_loss: 91894.5086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77931.2058; train_chrom_access_recon_loss: 9024557.2481; train_global_loss: 27061521.2519; train_optim_loss: 27061521.2519; val_kl_reg_loss: 241336143339.7393; val_edge_recon_loss: 600016.7250; val_gene_expr_recon_loss: 17251128.4667; val_masked_gp_l1_reg_loss: 91993.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77740.8984; val_chrom_access_recon_loss: 8955314.0000; val_global_loss: 241363106476.0000; val_optim_loss: 241363106476.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9421; val_auprc_score: 0.9279; val_best_acc_score: 0.8743; val_best_f1_score: 0.8793; train_kl_reg_loss: 29838283683.0033; train_edge_recon_loss: 608965.8903; train_gene_expr_recon_loss: 17333008.3511; train_masked_gp_l1_reg_loss: 91115.1472; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79099.3557; train_chrom_access_recon_loss: 9044573.8626; train_global_loss: 29865438971.4809; train_optim_loss: 29865438971.4809; val_kl_reg_loss: 3935341.1187; val_edge_recon_loss: 609231.0167; val_gene_expr_recon_loss: 17147514.6667; val_masked_gp_l1_reg_loss: 90938.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79125.9609; val_chrom_access_recon_loss: 8881864.4000; val_global_loss: 30744015.7333; val_optim_loss: 30744015.7333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9461; val_auprc_score: 0.9345; val_best_acc_score: 0.8836; val_best_f1_score: 0.8893; train_kl_reg_loss: 435041066.8620; train_edge_recon_loss: 606178.0749; train_gene_expr_recon_loss: 17240603.6336; train_masked_gp_l1_reg_loss: 89633.7175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77189.6283; train_chrom_access_recon_loss: 9023220.7481; train_global_loss: 462077846.6107; train_optim_loss: 462077846.6107; val_kl_reg_loss: 68510.5000; val_edge_recon_loss: 609691.7542; val_gene_expr_recon_loss: 17221681.5333; val_masked_gp_l1_reg_loss: 88650.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76413.1406; val_chrom_access_recon_loss: 8899768.4000; val_global_loss: 26964716.2667; val_optim_loss: 26964716.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9424; val_auprc_score: 0.9290; val_best_acc_score: 0.8756; val_best_f1_score: 0.8832; train_kl_reg_loss: 75487.8182; train_edge_recon_loss: 607462.6054; train_gene_expr_recon_loss: 17172006.2443; train_masked_gp_l1_reg_loss: 85279.9630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61024.2332; train_chrom_access_recon_loss: 8992932.2328; train_global_loss: 26994192.9466; train_optim_loss: 26994192.9466; val_kl_reg_loss: 67822.1667; val_edge_recon_loss: 607568.6875; val_gene_expr_recon_loss: 17180106.0000; val_masked_gp_l1_reg_loss: 84519.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58754.3906; val_chrom_access_recon_loss: 8871038.1333; val_global_loss: 26869809.4667; val_optim_loss: 26869809.4667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9408; val_auprc_score: 0.9289; val_best_acc_score: 0.8750; val_best_f1_score: 0.8807; train_kl_reg_loss: 75109.4653; train_edge_recon_loss: 606502.9122; train_gene_expr_recon_loss: 17186134.5649; train_masked_gp_l1_reg_loss: 84384.6425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58343.4695; train_chrom_access_recon_loss: 9005784.9809; train_global_loss: 27016259.8779; train_optim_loss: 27016259.8779; val_kl_reg_loss: 67622.8141; val_edge_recon_loss: 607837.6792; val_gene_expr_recon_loss: 17176062.6000; val_masked_gp_l1_reg_loss: 84243.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57962.6758; val_chrom_access_recon_loss: 8865916.6333; val_global_loss: 26859645.3333; val_optim_loss: 26859645.3333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9467; val_auprc_score: 0.9325; val_best_acc_score: 0.8849; val_best_f1_score: 0.8888; train_kl_reg_loss: 74065.2529; train_edge_recon_loss: 603001.2734; train_gene_expr_recon_loss: 17161028.8244; train_masked_gp_l1_reg_loss: 84168.2349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57746.6381; train_chrom_access_recon_loss: 8990144.7328; train_global_loss: 26970155.0687; train_optim_loss: 26970155.0687; val_kl_reg_loss: 67295.0708; val_edge_recon_loss: 603384.6917; val_gene_expr_recon_loss: 17226339.7333; val_masked_gp_l1_reg_loss: 84133.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57574.8867; val_chrom_access_recon_loss: 8910777.5333; val_global_loss: 26949505.0667; val_optim_loss: 26949505.0667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9426; val_auprc_score: 0.9283; val_best_acc_score: 0.8782; val_best_f1_score: 0.8852; train_kl_reg_loss: 94328.4911; train_edge_recon_loss: 601034.0081; train_gene_expr_recon_loss: 17157137.2366; train_masked_gp_l1_reg_loss: 84130.4588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57453.7904; train_chrom_access_recon_loss: 8990872.5992; train_global_loss: 26984956.5496; train_optim_loss: 26984956.5496; val_kl_reg_loss: 66869.4620; val_edge_recon_loss: 602239.7125; val_gene_expr_recon_loss: 17222495.9333; val_masked_gp_l1_reg_loss: 84146.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57257.0234; val_chrom_access_recon_loss: 8956423.0667; val_global_loss: 26989432.1333; val_optim_loss: 26989432.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 36 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9425
val AUPRC score: 0.9290
val best accuracy score: 0.8748
val best F1 score: 0.8808
val target rna MSE score: 1.9325
val source rna MSE score: 0.9148
val target atac MSE score: 0.3455
val source atac MSE score: 0.1050
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
