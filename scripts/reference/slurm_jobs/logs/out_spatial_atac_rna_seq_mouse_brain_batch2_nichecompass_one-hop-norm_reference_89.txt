[True]
Run timestamp: 07082023_200650_89.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_89']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8762; val_auprc_score: 0.8837; val_best_acc_score: 0.5155; val_best_f1_score: 0.6736; train_kl_reg_loss: 66711.3814; train_edge_recon_loss: 352602.7847; train_gene_expr_recon_loss: 1252277.5972; train_masked_gp_l1_reg_loss: 16236.6513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119256.1962; train_chrom_access_recon_loss: 764831.8819; train_global_loss: 2571916.4861; train_optim_loss: 2571916.4861; val_kl_reg_loss: 17568.8945; val_edge_recon_loss: 406436.2500; val_gene_expr_recon_loss: 1048507.7500; val_masked_gp_l1_reg_loss: 12200.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116719.2969; val_chrom_access_recon_loss: 519877.2500; val_global_loss: 2121310.0000; val_optim_loss: 2121310.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8721; val_auprc_score: 0.8838; val_best_acc_score: 0.5170; val_best_f1_score: 0.6742; train_kl_reg_loss: 18603.7238; train_edge_recon_loss: 359712.9236; train_gene_expr_recon_loss: 979443.5903; train_masked_gp_l1_reg_loss: 10865.0394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115210.8568; train_chrom_access_recon_loss: 508800.3958; train_global_loss: 1992636.5139; train_optim_loss: 1992636.5139; val_kl_reg_loss: 21564.2734; val_edge_recon_loss: 406432.7188; val_gene_expr_recon_loss: 914764.2500; val_masked_gp_l1_reg_loss: 9919.3770; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113438.5312; val_chrom_access_recon_loss: 500307.4688; val_global_loss: 1966426.6250; val_optim_loss: 1966426.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8667; val_auprc_score: 0.8740; val_best_acc_score: 0.5187; val_best_f1_score: 0.6750; train_kl_reg_loss: 21447.6960; train_edge_recon_loss: 361444.2639; train_gene_expr_recon_loss: 876090.6181; train_masked_gp_l1_reg_loss: 9986.0144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112105.9653; train_chrom_access_recon_loss: 489985.4653; train_global_loss: 1871060.0000; train_optim_loss: 1871060.0000; val_kl_reg_loss: 23017.9609; val_edge_recon_loss: 406430.9062; val_gene_expr_recon_loss: 837184.0000; val_masked_gp_l1_reg_loss: 9989.7686; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110411.4922; val_chrom_access_recon_loss: 474963.5625; val_global_loss: 1861997.7500; val_optim_loss: 1861997.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8532; val_auprc_score: 0.8620; val_best_acc_score: 0.5362; val_best_f1_score: 0.6829; train_kl_reg_loss: 22551.4457; train_edge_recon_loss: 362045.5069; train_gene_expr_recon_loss: 811783.8125; train_masked_gp_l1_reg_loss: 9810.9639; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108912.2118; train_chrom_access_recon_loss: 467468.7049; train_global_loss: 1782572.6111; train_optim_loss: 1782572.6111; val_kl_reg_loss: 24338.5273; val_edge_recon_loss: 406322.3750; val_gene_expr_recon_loss: 793131.6875; val_masked_gp_l1_reg_loss: 9616.4229; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106904.6094; val_chrom_access_recon_loss: 461935.2500; val_global_loss: 1802248.8750; val_optim_loss: 1802248.8750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8411; val_auprc_score: 0.8483; val_best_acc_score: 0.5703; val_best_f1_score: 0.6979; train_kl_reg_loss: 23018.2585; train_edge_recon_loss: 360629.5486; train_gene_expr_recon_loss: 773846.4653; train_masked_gp_l1_reg_loss: 9517.7857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105092.3663; train_chrom_access_recon_loss: 457013.6701; train_global_loss: 1729118.1250; train_optim_loss: 1729118.1250; val_kl_reg_loss: 21601.6504; val_edge_recon_loss: 406034.1562; val_gene_expr_recon_loss: 762644.0000; val_masked_gp_l1_reg_loss: 9390.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102720.8984; val_chrom_access_recon_loss: 454299.3750; val_global_loss: 1756690.1250; val_optim_loss: 1756690.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8257; val_auprc_score: 0.8263; val_best_acc_score: 0.6187; val_best_f1_score: 0.7187; train_kl_reg_loss: 21712.5211; train_edge_recon_loss: 359097.6806; train_gene_expr_recon_loss: 745739.4306; train_masked_gp_l1_reg_loss: 9318.3855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100717.5087; train_chrom_access_recon_loss: 453179.9583; train_global_loss: 1689765.5278; train_optim_loss: 1689765.5278; val_kl_reg_loss: 21005.0977; val_edge_recon_loss: 405328.6875; val_gene_expr_recon_loss: 740896.6250; val_masked_gp_l1_reg_loss: 9227.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98169.4922; val_chrom_access_recon_loss: 450901.0312; val_global_loss: 1725528.1250; val_optim_loss: 1725528.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8345; val_auprc_score: 0.8308; val_best_acc_score: 0.6634; val_best_f1_score: 0.7375; train_kl_reg_loss: 20987.1135; train_edge_recon_loss: 357799.3819; train_gene_expr_recon_loss: 725179.2083; train_masked_gp_l1_reg_loss: 9193.3832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96085.0078; train_chrom_access_recon_loss: 449227.7569; train_global_loss: 1658471.8194; train_optim_loss: 1658471.8194; val_kl_reg_loss: 19876.9375; val_edge_recon_loss: 404245.9375; val_gene_expr_recon_loss: 721323.0000; val_masked_gp_l1_reg_loss: 9148.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93459.9141; val_chrom_access_recon_loss: 447614.9375; val_global_loss: 1695669.0000; val_optim_loss: 1695669.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8507; val_auprc_score: 0.8458; val_best_acc_score: 0.7418; val_best_f1_score: 0.7776; train_kl_reg_loss: 20936.3913; train_edge_recon_loss: 357350.9306; train_gene_expr_recon_loss: 710071.9306; train_masked_gp_l1_reg_loss: 9112.9029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91346.9618; train_chrom_access_recon_loss: 446243.5972; train_global_loss: 1635062.7222; train_optim_loss: 1635062.7222; val_kl_reg_loss: 18131.9727; val_edge_recon_loss: 402219.2500; val_gene_expr_recon_loss: 709426.6875; val_masked_gp_l1_reg_loss: 9069.1553; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88698.9531; val_chrom_access_recon_loss: 445583.3438; val_global_loss: 1673129.3750; val_optim_loss: 1673129.3750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8472; val_auprc_score: 0.8366; val_best_acc_score: 0.7660; val_best_f1_score: 0.7801; train_kl_reg_loss: 20606.1228; train_edge_recon_loss: 356573.6285; train_gene_expr_recon_loss: 698736.5347; train_masked_gp_l1_reg_loss: 9060.8475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86608.8837; train_chrom_access_recon_loss: 444656.8194; train_global_loss: 1616242.8056; train_optim_loss: 1616242.8056; val_kl_reg_loss: 19726.6699; val_edge_recon_loss: 400392.0938; val_gene_expr_recon_loss: 699417.5000; val_masked_gp_l1_reg_loss: 9038.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84020.4297; val_chrom_access_recon_loss: 443656.6875; val_global_loss: 1656251.7500; val_optim_loss: 1656251.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8496; val_auprc_score: 0.8401; val_best_acc_score: 0.7692; val_best_f1_score: 0.7603; train_kl_reg_loss: 20902.0979; train_edge_recon_loss: 355637.0764; train_gene_expr_recon_loss: 689501.2569; train_masked_gp_l1_reg_loss: 9035.1033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82001.2283; train_chrom_access_recon_loss: 440833.1319; train_global_loss: 1597909.9028; train_optim_loss: 1597909.9028; val_kl_reg_loss: 19409.1211; val_edge_recon_loss: 397622.7812; val_gene_expr_recon_loss: 693260.1250; val_masked_gp_l1_reg_loss: 9024.7920; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79500.7109; val_chrom_access_recon_loss: 442280.5312; val_global_loss: 1641098.0000; val_optim_loss: 1641098.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8610; val_auprc_score: 0.8518; val_best_acc_score: 0.7514; val_best_f1_score: 0.7703; train_kl_reg_loss: 21070.6495; train_edge_recon_loss: 354813.6562; train_gene_expr_recon_loss: 685497.2986; train_masked_gp_l1_reg_loss: 9031.4589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77556.4627; train_chrom_access_recon_loss: 442715.2049; train_global_loss: 1590684.7500; train_optim_loss: 1590684.7500; val_kl_reg_loss: 18769.0547; val_edge_recon_loss: 394828.7500; val_gene_expr_recon_loss: 688810.4375; val_masked_gp_l1_reg_loss: 9036.4834; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75151.3125; val_chrom_access_recon_loss: 441097.0625; val_global_loss: 1627693.0000; val_optim_loss: 1627693.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8714; val_auprc_score: 0.8577; val_best_acc_score: 0.7673; val_best_f1_score: 0.7965; train_kl_reg_loss: 20481.6352; train_edge_recon_loss: 353638.8819; train_gene_expr_recon_loss: 680584.1528; train_masked_gp_l1_reg_loss: 9053.9170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73289.0955; train_chrom_access_recon_loss: 440559.8854; train_global_loss: 1577607.5972; train_optim_loss: 1577607.5972; val_kl_reg_loss: 18647.5391; val_edge_recon_loss: 390575.4375; val_gene_expr_recon_loss: 684657.7500; val_masked_gp_l1_reg_loss: 9061.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70989.2031; val_chrom_access_recon_loss: 440012.6562; val_global_loss: 1613944.2500; val_optim_loss: 1613944.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8941; val_auprc_score: 0.8813; val_best_acc_score: 0.8193; val_best_f1_score: 0.8273; train_kl_reg_loss: 20260.9497; train_edge_recon_loss: 352361.4236; train_gene_expr_recon_loss: 675844.9375; train_masked_gp_l1_reg_loss: 9078.6642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69219.2309; train_chrom_access_recon_loss: 438313.0590; train_global_loss: 1565078.2778; train_optim_loss: 1565078.2778; val_kl_reg_loss: 18842.8008; val_edge_recon_loss: 382802.5625; val_gene_expr_recon_loss: 681238.5000; val_masked_gp_l1_reg_loss: 9092.8389; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67034.0156; val_chrom_access_recon_loss: 438984.3750; val_global_loss: 1597995.1250; val_optim_loss: 1597995.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9100; val_auprc_score: 0.8985; val_best_acc_score: 0.8343; val_best_f1_score: 0.8445; train_kl_reg_loss: 19785.4256; train_edge_recon_loss: 349257.9896; train_gene_expr_recon_loss: 676860.5903; train_masked_gp_l1_reg_loss: 9111.0252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65346.4510; train_chrom_access_recon_loss: 440435.9653; train_global_loss: 1560797.4583; train_optim_loss: 1560797.4583; val_kl_reg_loss: 19069.5391; val_edge_recon_loss: 370789.8438; val_gene_expr_recon_loss: 678347.8750; val_masked_gp_l1_reg_loss: 9130.7041; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63273.0664; val_chrom_access_recon_loss: 438209.1250; val_global_loss: 1578820.2500; val_optim_loss: 1578820.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9238; val_auprc_score: 0.9063; val_best_acc_score: 0.8561; val_best_f1_score: 0.8623; train_kl_reg_loss: 18606.8993; train_edge_recon_loss: 341746.3438; train_gene_expr_recon_loss: 671182.8056; train_masked_gp_l1_reg_loss: 9163.4297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61688.0278; train_chrom_access_recon_loss: 435052.6667; train_global_loss: 1537440.1528; train_optim_loss: 1537440.1528; val_kl_reg_loss: 18152.2109; val_edge_recon_loss: 343442.8438; val_gene_expr_recon_loss: 680235.8750; val_masked_gp_l1_reg_loss: 9200.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59745.2148; val_chrom_access_recon_loss: 437923.5000; val_global_loss: 1548700.2500; val_optim_loss: 1548700.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9232; val_auprc_score: 0.9058; val_best_acc_score: 0.8544; val_best_f1_score: 0.8623; train_kl_reg_loss: 20994.7459; train_edge_recon_loss: 324204.9826; train_gene_expr_recon_loss: 674656.3958; train_masked_gp_l1_reg_loss: 9248.6744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58273.6684; train_chrom_access_recon_loss: 437355.3854; train_global_loss: 1524733.8750; train_optim_loss: 1524733.8750; val_kl_reg_loss: 25479.2754; val_edge_recon_loss: 315986.8125; val_gene_expr_recon_loss: 679539.1250; val_masked_gp_l1_reg_loss: 9308.2090; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56470.7852; val_chrom_access_recon_loss: 437366.6875; val_global_loss: 1524151.0000; val_optim_loss: 1524151.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9198; val_auprc_score: 0.8976; val_best_acc_score: 0.8525; val_best_f1_score: 0.8634; train_kl_reg_loss: 28562.8377; train_edge_recon_loss: 308755.0729; train_gene_expr_recon_loss: 671013.9375; train_masked_gp_l1_reg_loss: 9356.7427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55105.1944; train_chrom_access_recon_loss: 437027.1840; train_global_loss: 1509820.9722; train_optim_loss: 1509820.9722; val_kl_reg_loss: 30045.4668; val_edge_recon_loss: 308229.2188; val_gene_expr_recon_loss: 676151.2500; val_masked_gp_l1_reg_loss: 9406.6973; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53434.4219; val_chrom_access_recon_loss: 436397.5625; val_global_loss: 1513664.5000; val_optim_loss: 1513664.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9260; val_auprc_score: 0.9039; val_best_acc_score: 0.8593; val_best_f1_score: 0.8687; train_kl_reg_loss: 29406.2270; train_edge_recon_loss: 304239.2882; train_gene_expr_recon_loss: 670029.2500; train_masked_gp_l1_reg_loss: 9446.5875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52167.8911; train_chrom_access_recon_loss: 436951.2674; train_global_loss: 1502240.5278; train_optim_loss: 1502240.5278; val_kl_reg_loss: 27764.7598; val_edge_recon_loss: 305487.3438; val_gene_expr_recon_loss: 674057.1250; val_masked_gp_l1_reg_loss: 9484.6621; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50614.9141; val_chrom_access_recon_loss: 435448.0625; val_global_loss: 1502857.0000; val_optim_loss: 1502857.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9307; val_auprc_score: 0.9066; val_best_acc_score: 0.8659; val_best_f1_score: 0.8728; train_kl_reg_loss: 27855.9442; train_edge_recon_loss: 302219.2465; train_gene_expr_recon_loss: 671889.9236; train_masked_gp_l1_reg_loss: 9517.5488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49441.0382; train_chrom_access_recon_loss: 435784.1701; train_global_loss: 1496707.8472; train_optim_loss: 1496707.8472; val_kl_reg_loss: 28004.6289; val_edge_recon_loss: 300981.1875; val_gene_expr_recon_loss: 672579.1250; val_masked_gp_l1_reg_loss: 9552.6768; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48005.3047; val_chrom_access_recon_loss: 434778.8125; val_global_loss: 1493901.7500; val_optim_loss: 1493901.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9274; val_auprc_score: 0.9006; val_best_acc_score: 0.8612; val_best_f1_score: 0.8702; train_kl_reg_loss: 28775.9677; train_edge_recon_loss: 299110.2569; train_gene_expr_recon_loss: 666093.5903; train_masked_gp_l1_reg_loss: 9589.0911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46925.3780; train_chrom_access_recon_loss: 436605.0104; train_global_loss: 1487099.2639; train_optim_loss: 1487099.2639; val_kl_reg_loss: 27968.6523; val_edge_recon_loss: 298196.2812; val_gene_expr_recon_loss: 671760.0625; val_masked_gp_l1_reg_loss: 9626.9258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45600.1758; val_chrom_access_recon_loss: 434339.4062; val_global_loss: 1487491.5000; val_optim_loss: 1487491.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9331; val_auprc_score: 0.9118; val_best_acc_score: 0.8686; val_best_f1_score: 0.8753; train_kl_reg_loss: 27972.7033; train_edge_recon_loss: 298797.6424; train_gene_expr_recon_loss: 663309.5417; train_masked_gp_l1_reg_loss: 9655.5021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44600.3338; train_chrom_access_recon_loss: 433844.4097; train_global_loss: 1478180.0972; train_optim_loss: 1478180.0972; val_kl_reg_loss: 27674.9609; val_edge_recon_loss: 298154.6562; val_gene_expr_recon_loss: 669565.1250; val_masked_gp_l1_reg_loss: 9682.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43369.4453; val_chrom_access_recon_loss: 433460.8438; val_global_loss: 1481907.1250; val_optim_loss: 1481907.1250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9376; val_auprc_score: 0.9191; val_best_acc_score: 0.8705; val_best_f1_score: 0.8775; train_kl_reg_loss: 27812.3522; train_edge_recon_loss: 295905.4375; train_gene_expr_recon_loss: 663339.6042; train_masked_gp_l1_reg_loss: 9707.6962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42435.7088; train_chrom_access_recon_loss: 433213.3160; train_global_loss: 1472414.1111; train_optim_loss: 1472414.1111; val_kl_reg_loss: 27823.2129; val_edge_recon_loss: 297466.5000; val_gene_expr_recon_loss: 667528.5000; val_masked_gp_l1_reg_loss: 9733.7949; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41289.1250; val_chrom_access_recon_loss: 432792.6250; val_global_loss: 1476633.7500; val_optim_loss: 1476633.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9462; val_auprc_score: 0.9294; val_best_acc_score: 0.8868; val_best_f1_score: 0.8912; train_kl_reg_loss: 27650.3435; train_edge_recon_loss: 295834.4688; train_gene_expr_recon_loss: 664793.2153; train_masked_gp_l1_reg_loss: 9754.6669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40425.8911; train_chrom_access_recon_loss: 432836.3229; train_global_loss: 1471294.9167; train_optim_loss: 1471294.9167; val_kl_reg_loss: 26872.2051; val_edge_recon_loss: 294738.6562; val_gene_expr_recon_loss: 666399.0625; val_masked_gp_l1_reg_loss: 9784.4473; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39366.7656; val_chrom_access_recon_loss: 432213.6250; val_global_loss: 1469374.7500; val_optim_loss: 1469374.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9469; val_auprc_score: 0.9320; val_best_acc_score: 0.8870; val_best_f1_score: 0.8906; train_kl_reg_loss: 27485.9110; train_edge_recon_loss: 294752.1319; train_gene_expr_recon_loss: 659602.8056; train_masked_gp_l1_reg_loss: 9808.3780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38566.5208; train_chrom_access_recon_loss: 430874.2743; train_global_loss: 1461090.0139; train_optim_loss: 1461090.0139; val_kl_reg_loss: 27332.7988; val_edge_recon_loss: 296152.1562; val_gene_expr_recon_loss: 664471.8750; val_masked_gp_l1_reg_loss: 9830.9727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37576.2930; val_chrom_access_recon_loss: 431370.5000; val_global_loss: 1466734.7500; val_optim_loss: 1466734.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9533; val_auprc_score: 0.9362; val_best_acc_score: 0.8968; val_best_f1_score: 0.9014; train_kl_reg_loss: 27300.8112; train_edge_recon_loss: 293749.5174; train_gene_expr_recon_loss: 657637.7569; train_masked_gp_l1_reg_loss: 9846.7881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36826.2122; train_chrom_access_recon_loss: 429824.3056; train_global_loss: 1455185.3889; train_optim_loss: 1455185.3889; val_kl_reg_loss: 27471.4453; val_edge_recon_loss: 291572.6250; val_gene_expr_recon_loss: 665131.2500; val_masked_gp_l1_reg_loss: 9867.6934; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35903.3555; val_chrom_access_recon_loss: 430866.6562; val_global_loss: 1460813.0000; val_optim_loss: 1460813.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9581; val_auprc_score: 0.9445; val_best_acc_score: 0.9038; val_best_f1_score: 0.9070; train_kl_reg_loss: 25208.8472; train_edge_recon_loss: 295538.6007; train_gene_expr_recon_loss: 968556.2639; train_masked_gp_l1_reg_loss: 9983.4341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35023.6441; train_chrom_access_recon_loss: 455044.2778; train_global_loss: 1789355.0556; train_optim_loss: 1789355.0556; val_kl_reg_loss: 16219.6113; val_edge_recon_loss: 292353.4688; val_gene_expr_recon_loss: 968526.3750; val_masked_gp_l1_reg_loss: 10187.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33839.4062; val_chrom_access_recon_loss: 454357.3750; val_global_loss: 1775483.7500; val_optim_loss: 1775483.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9575; val_auprc_score: 0.9438; val_best_acc_score: 0.9011; val_best_f1_score: 0.9055; train_kl_reg_loss: 24048.7298; train_edge_recon_loss: 292419.1076; train_gene_expr_recon_loss: 962319.8819; train_masked_gp_l1_reg_loss: 10375.9480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32859.9965; train_chrom_access_recon_loss: 453120.3090; train_global_loss: 1775143.9861; train_optim_loss: 1775143.9861; val_kl_reg_loss: 17448.3555; val_edge_recon_loss: 292141.4375; val_gene_expr_recon_loss: 961009.6250; val_masked_gp_l1_reg_loss: 10609.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31656.8984; val_chrom_access_recon_loss: 453205.6562; val_global_loss: 1766071.0000; val_optim_loss: 1766071.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9600; val_auprc_score: 0.9490; val_best_acc_score: 0.9039; val_best_f1_score: 0.9069; train_kl_reg_loss: 22803.5508; train_edge_recon_loss: 289359.3472; train_gene_expr_recon_loss: 950328.3681; train_masked_gp_l1_reg_loss: 10788.6002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30743.1903; train_chrom_access_recon_loss: 451302.9722; train_global_loss: 1755326.0139; train_optim_loss: 1755326.0139; val_kl_reg_loss: 18270.2500; val_edge_recon_loss: 288260.5312; val_gene_expr_recon_loss: 958904.2500; val_masked_gp_l1_reg_loss: 10996.3193; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29633.5586; val_chrom_access_recon_loss: 452920.1562; val_global_loss: 1758985.0000; val_optim_loss: 1758985.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9559; val_auprc_score: 0.9418; val_best_acc_score: 0.9023; val_best_f1_score: 0.9070; train_kl_reg_loss: 22437.7079; train_edge_recon_loss: 287373.2014; train_gene_expr_recon_loss: 948247.1181; train_masked_gp_l1_reg_loss: 11146.2848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28804.9273; train_chrom_access_recon_loss: 453280.2361; train_global_loss: 1751289.4583; train_optim_loss: 1751289.4583; val_kl_reg_loss: 19276.2148; val_edge_recon_loss: 288209.4688; val_gene_expr_recon_loss: 953056.0625; val_masked_gp_l1_reg_loss: 11325.2070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27805.4688; val_chrom_access_recon_loss: 452031.3438; val_global_loss: 1751703.8750; val_optim_loss: 1751703.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9611; val_auprc_score: 0.9474; val_best_acc_score: 0.9073; val_best_f1_score: 0.9112; train_kl_reg_loss: 21992.9757; train_edge_recon_loss: 286954.9340; train_gene_expr_recon_loss: 950398.0625; train_masked_gp_l1_reg_loss: 11267.6472; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27686.1515; train_chrom_access_recon_loss: 453262.9931; train_global_loss: 1751562.7778; train_optim_loss: 1751562.7778; val_kl_reg_loss: 19237.5586; val_edge_recon_loss: 286512.8125; val_gene_expr_recon_loss: 953241.2500; val_masked_gp_l1_reg_loss: 11219.2861; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27541.3281; val_chrom_access_recon_loss: 452025.8438; val_global_loss: 1749778.1250; val_optim_loss: 1749778.1250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9600; val_auprc_score: 0.9447; val_best_acc_score: 0.9064; val_best_f1_score: 0.9106; train_kl_reg_loss: 21853.4690; train_edge_recon_loss: 286914.8576; train_gene_expr_recon_loss: 946070.1458; train_masked_gp_l1_reg_loss: 11213.7013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27441.7949; train_chrom_access_recon_loss: 452630.6840; train_global_loss: 1746124.6250; train_optim_loss: 1746124.6250; val_kl_reg_loss: 19315.9102; val_edge_recon_loss: 287336.6875; val_gene_expr_recon_loss: 952250.8750; val_masked_gp_l1_reg_loss: 11201.7559; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27316.9629; val_chrom_access_recon_loss: 451831.9375; val_global_loss: 1749254.2500; val_optim_loss: 1749254.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9605; val_auprc_score: 0.9457; val_best_acc_score: 0.9073; val_best_f1_score: 0.9115; train_kl_reg_loss: 21816.7569; train_edge_recon_loss: 287058.5104; train_gene_expr_recon_loss: 947890.1806; train_masked_gp_l1_reg_loss: 11199.8409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27223.9612; train_chrom_access_recon_loss: 451990.1944; train_global_loss: 1747179.4583; train_optim_loss: 1747179.4583; val_kl_reg_loss: 19189.7422; val_edge_recon_loss: 286401.8125; val_gene_expr_recon_loss: 952533.3750; val_masked_gp_l1_reg_loss: 11199.1816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27109.9707; val_chrom_access_recon_loss: 451902.5000; val_global_loss: 1748336.6250; val_optim_loss: 1748336.6250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9608; val_auprc_score: 0.9494; val_best_acc_score: 0.9060; val_best_f1_score: 0.9096; train_kl_reg_loss: 21767.5204; train_edge_recon_loss: 286527.7257; train_gene_expr_recon_loss: 947634.2222; train_masked_gp_l1_reg_loss: 11202.9507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27022.0002; train_chrom_access_recon_loss: 451601.5694; train_global_loss: 1745755.9861; train_optim_loss: 1745755.9861; val_kl_reg_loss: 19288.3867; val_edge_recon_loss: 288749.5938; val_gene_expr_recon_loss: 951971.6250; val_masked_gp_l1_reg_loss: 11208.8574; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26915.9922; val_chrom_access_recon_loss: 451846.2500; val_global_loss: 1749980.7500; val_optim_loss: 1749980.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 27 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9521
val AUPRC score: 0.9403
val best accuracy score: 0.8914
val best F1 score: 0.8947
val target rna MSE score: 3.8690
val source rna MSE score: 3.1637
val target atac MSE score: 0.1389
val source atac MSE score: 0.0203
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
