[True]
Run timestamp: 07092023_191126_89.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_89']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 795 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3522, n_cat_covariates_embed_input: 0, n_hidden: 2313, n_latent: 2213, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 795
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 795

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7341; val_auprc_score: 0.7579; val_best_acc_score: 0.5282; val_best_f1_score: 0.6774; train_kl_reg_loss: 76350.8194; train_edge_recon_loss: 3570776.2538; train_gene_expr_recon_loss: 21331102.5649; train_masked_gp_l1_reg_loss: 134808.7031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3499566.0482; train_chrom_access_recon_loss: 4516144.9828; train_global_loss: 33128749.5115; train_optim_loss: 33128749.5115; val_kl_reg_loss: 89317.1266; val_edge_recon_loss: 4063340.4000; val_gene_expr_recon_loss: 20242013.4667; val_masked_gp_l1_reg_loss: 130499.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 430128.5625; val_chrom_access_recon_loss: 4398959.4000; val_global_loss: 29354258.4000; val_optim_loss: 29354258.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7631; val_auprc_score: 0.7890; val_best_acc_score: 0.5186; val_best_f1_score: 0.6731; train_kl_reg_loss: 94674.5189; train_edge_recon_loss: 3527524.2519; train_gene_expr_recon_loss: 19967277.3893; train_masked_gp_l1_reg_loss: 130021.5462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 255318.5646; train_chrom_access_recon_loss: 4321421.2424; train_global_loss: 28296237.4809; train_optim_loss: 28296237.4809; val_kl_reg_loss: 181807.8760; val_edge_recon_loss: 4063748.8833; val_gene_expr_recon_loss: 20017447.8667; val_masked_gp_l1_reg_loss: 131462.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192364.6250; val_chrom_access_recon_loss: 4364056.9167; val_global_loss: 28950887.2000; val_optim_loss: 28950887.2000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7945; val_auprc_score: 0.8115; val_best_acc_score: 0.5861; val_best_f1_score: 0.6976; train_kl_reg_loss: 91240.2918; train_edge_recon_loss: 3514982.1317; train_gene_expr_recon_loss: 19669953.9389; train_masked_gp_l1_reg_loss: 130759.6658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163434.0899; train_chrom_access_recon_loss: 4267433.1469; train_global_loss: 27837803.0840; train_optim_loss: 27837803.0840; val_kl_reg_loss: 96691.6953; val_edge_recon_loss: 4054674.2500; val_gene_expr_recon_loss: 19822293.0667; val_masked_gp_l1_reg_loss: 135616.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 160193.7656; val_chrom_access_recon_loss: 4300531.4000; val_global_loss: 28570000.1333; val_optim_loss: 28570000.1333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8512; val_auprc_score: 0.8602; val_best_acc_score: 0.7765; val_best_f1_score: 0.7766; train_kl_reg_loss: 84494.1785; train_edge_recon_loss: 3506663.8015; train_gene_expr_recon_loss: 19383155.8321; train_masked_gp_l1_reg_loss: 134843.8974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139298.6502; train_chrom_access_recon_loss: 4217963.2099; train_global_loss: 27466419.6794; train_optim_loss: 27466419.6794; val_kl_reg_loss: 87256.4479; val_edge_recon_loss: 3999747.7500; val_gene_expr_recon_loss: 19375210.2667; val_masked_gp_l1_reg_loss: 134970.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123722.5781; val_chrom_access_recon_loss: 4248628.3833; val_global_loss: 27969535.2000; val_optim_loss: 27969535.2000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8946; val_auprc_score: 0.8879; val_best_acc_score: 0.8147; val_best_f1_score: 0.8212; train_kl_reg_loss: 76828.7357; train_edge_recon_loss: 3476291.2653; train_gene_expr_recon_loss: 19085452.0611; train_masked_gp_l1_reg_loss: 137148.6902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113953.6752; train_chrom_access_recon_loss: 4175279.0802; train_global_loss: 27064953.3740; train_optim_loss: 27064953.3740; val_kl_reg_loss: 68308.7422; val_edge_recon_loss: 3675286.0500; val_gene_expr_recon_loss: 19114612.5333; val_masked_gp_l1_reg_loss: 139105.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107939.4531; val_chrom_access_recon_loss: 4192876.0000; val_global_loss: 27298129.2000; val_optim_loss: 27298129.2000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8871; val_auprc_score: 0.8748; val_best_acc_score: 0.7905; val_best_f1_score: 0.8121; train_kl_reg_loss: 89932.6074; train_edge_recon_loss: 3093877.1469; train_gene_expr_recon_loss: 18893067.4809; train_masked_gp_l1_reg_loss: 143802.4649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107002.0482; train_chrom_access_recon_loss: 4133630.4141; train_global_loss: 26461312.1221; train_optim_loss: 26461312.1221; val_kl_reg_loss: 104662.8438; val_edge_recon_loss: 2967242.1167; val_gene_expr_recon_loss: 18978296.9333; val_masked_gp_l1_reg_loss: 147164.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108322.8438; val_chrom_access_recon_loss: 4182294.5833; val_global_loss: 26487982.4000; val_optim_loss: 26487982.4000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9024; val_auprc_score: 0.8900; val_best_acc_score: 0.8145; val_best_f1_score: 0.8268; train_kl_reg_loss: 111020.6843; train_edge_recon_loss: 2945689.5553; train_gene_expr_recon_loss: 18707268.4733; train_masked_gp_l1_reg_loss: 148708.1194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107005.9835; train_chrom_access_recon_loss: 4104897.7405; train_global_loss: 26124590.5191; train_optim_loss: 26124590.5191; val_kl_reg_loss: 107130.7260; val_edge_recon_loss: 2938007.6000; val_gene_expr_recon_loss: 18810971.4667; val_masked_gp_l1_reg_loss: 150207.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104751.1328; val_chrom_access_recon_loss: 4159659.3500; val_global_loss: 26270728.9333; val_optim_loss: 26270728.9333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9096; val_auprc_score: 0.8937; val_best_acc_score: 0.8317; val_best_f1_score: 0.8441; train_kl_reg_loss: 108385.9120; train_edge_recon_loss: 2909273.7462; train_gene_expr_recon_loss: 18559572.0458; train_masked_gp_l1_reg_loss: 151313.7422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102281.5247; train_chrom_access_recon_loss: 4075903.1813; train_global_loss: 25906730.1985; train_optim_loss: 25906730.1985; val_kl_reg_loss: 110336.3786; val_edge_recon_loss: 2896987.8167; val_gene_expr_recon_loss: 18679406.9333; val_masked_gp_l1_reg_loss: 153077.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101230.6953; val_chrom_access_recon_loss: 4124735.8167; val_global_loss: 26065775.2000; val_optim_loss: 26065775.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9203; val_auprc_score: 0.8996; val_best_acc_score: 0.8519; val_best_f1_score: 0.8608; train_kl_reg_loss: 108899.7521; train_edge_recon_loss: 2861000.3111; train_gene_expr_recon_loss: 18441904.4733; train_masked_gp_l1_reg_loss: 154579.5867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100141.8340; train_chrom_access_recon_loss: 4048170.9733; train_global_loss: 25714696.9618; train_optim_loss: 25714696.9618; val_kl_reg_loss: 117807.0568; val_edge_recon_loss: 2833403.4833; val_gene_expr_recon_loss: 18522386.6667; val_masked_gp_l1_reg_loss: 156116.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99030.2734; val_chrom_access_recon_loss: 4098631.5833; val_global_loss: 25827374.8000; val_optim_loss: 25827374.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9289; val_auprc_score: 0.9145; val_best_acc_score: 0.8614; val_best_f1_score: 0.8703; train_kl_reg_loss: 110555.6819; train_edge_recon_loss: 2833181.0172; train_gene_expr_recon_loss: 18321310.0611; train_masked_gp_l1_reg_loss: 157159.3635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100005.3692; train_chrom_access_recon_loss: 4022364.0401; train_global_loss: 25544575.4351; train_optim_loss: 25544575.4351; val_kl_reg_loss: 112350.7932; val_edge_recon_loss: 2820440.4167; val_gene_expr_recon_loss: 18384239.4667; val_masked_gp_l1_reg_loss: 158307.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100735.9453; val_chrom_access_recon_loss: 4062390.6667; val_global_loss: 25638465.0667; val_optim_loss: 25638465.0667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9278; val_auprc_score: 0.9107; val_best_acc_score: 0.8572; val_best_f1_score: 0.8691; train_kl_reg_loss: 112670.0824; train_edge_recon_loss: 2815531.0859; train_gene_expr_recon_loss: 18222775.2519; train_masked_gp_l1_reg_loss: 158894.6665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100776.7444; train_chrom_access_recon_loss: 4005914.1164; train_global_loss: 25416561.8779; train_optim_loss: 25416561.8779; val_kl_reg_loss: 108899.3750; val_edge_recon_loss: 2843603.8000; val_gene_expr_recon_loss: 18382414.5333; val_masked_gp_l1_reg_loss: 159885.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101649.7891; val_chrom_access_recon_loss: 4055891.4667; val_global_loss: 25652344.9333; val_optim_loss: 25652344.9333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9308; val_auprc_score: 0.9131; val_best_acc_score: 0.8628; val_best_f1_score: 0.8724; train_kl_reg_loss: 109405.7870; train_edge_recon_loss: 2812888.6469; train_gene_expr_recon_loss: 18122315.0534; train_masked_gp_l1_reg_loss: 160485.0132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100430.0498; train_chrom_access_recon_loss: 3980536.8321; train_global_loss: 25286061.2672; train_optim_loss: 25286061.2672; val_kl_reg_loss: 109169.4849; val_edge_recon_loss: 2839968.6667; val_gene_expr_recon_loss: 18204756.2667; val_masked_gp_l1_reg_loss: 161150.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100335.0078; val_chrom_access_recon_loss: 4024218.0500; val_global_loss: 25439598.2667; val_optim_loss: 25439598.2667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9357; val_auprc_score: 0.9209; val_best_acc_score: 0.8690; val_best_f1_score: 0.8769; train_kl_reg_loss: 109377.2759; train_edge_recon_loss: 2798873.0324; train_gene_expr_recon_loss: 18046029.4198; train_masked_gp_l1_reg_loss: 161576.7648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99268.7981; train_chrom_access_recon_loss: 3965669.0191; train_global_loss: 25180794.2290; train_optim_loss: 25180794.2290; val_kl_reg_loss: 109097.0281; val_edge_recon_loss: 2808291.5167; val_gene_expr_recon_loss: 18175234.1333; val_masked_gp_l1_reg_loss: 161885.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100035.9688; val_chrom_access_recon_loss: 4010851.5167; val_global_loss: 25365396.2667; val_optim_loss: 25365396.2667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9387; val_auprc_score: 0.9188; val_best_acc_score: 0.8759; val_best_f1_score: 0.8819; train_kl_reg_loss: 107967.0067; train_edge_recon_loss: 2781976.1126; train_gene_expr_recon_loss: 17963260.1908; train_masked_gp_l1_reg_loss: 162633.1918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98348.6996; train_chrom_access_recon_loss: 3945921.8569; train_global_loss: 25060107.0229; train_optim_loss: 25060107.0229; val_kl_reg_loss: 108263.3255; val_edge_recon_loss: 2791948.7833; val_gene_expr_recon_loss: 18083366.0000; val_masked_gp_l1_reg_loss: 163049.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97885.8672; val_chrom_access_recon_loss: 3989437.4833; val_global_loss: 25233951.7333; val_optim_loss: 25233951.7333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9427; val_auprc_score: 0.9283; val_best_acc_score: 0.8779; val_best_f1_score: 0.8838; train_kl_reg_loss: 108285.2701; train_edge_recon_loss: 2776309.1603; train_gene_expr_recon_loss: 17895186.4122; train_masked_gp_l1_reg_loss: 163734.1477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97108.0795; train_chrom_access_recon_loss: 3931804.1698; train_global_loss: 24972427.1756; train_optim_loss: 24972427.1756; val_kl_reg_loss: 105502.1234; val_edge_recon_loss: 2789981.0167; val_gene_expr_recon_loss: 17991365.6000; val_masked_gp_l1_reg_loss: 164464.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97344.1641; val_chrom_access_recon_loss: 3987201.0833; val_global_loss: 25135857.8667; val_optim_loss: 25135857.8667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9456; val_auprc_score: 0.9329; val_best_acc_score: 0.8832; val_best_f1_score: 0.8888; train_kl_reg_loss: 106551.3807; train_edge_recon_loss: 2777569.9427; train_gene_expr_recon_loss: 17834694.7023; train_masked_gp_l1_reg_loss: 164620.7284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95900.3995; train_chrom_access_recon_loss: 3919348.2595; train_global_loss: 24898685.3740; train_optim_loss: 24898685.3740; val_kl_reg_loss: 107994.1698; val_edge_recon_loss: 2771447.8333; val_gene_expr_recon_loss: 17990944.9333; val_masked_gp_l1_reg_loss: 165338.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96697.5781; val_chrom_access_recon_loss: 3967650.2167; val_global_loss: 25100073.0667; val_optim_loss: 25100073.0667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9462; val_auprc_score: 0.9278; val_best_acc_score: 0.8863; val_best_f1_score: 0.8916; train_kl_reg_loss: 105697.8307; train_edge_recon_loss: 2763069.9695; train_gene_expr_recon_loss: 17766666.5878; train_masked_gp_l1_reg_loss: 165583.2061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95319.6916; train_chrom_access_recon_loss: 3902381.1508; train_global_loss: 24798718.4427; train_optim_loss: 24798718.4427; val_kl_reg_loss: 105497.4776; val_edge_recon_loss: 2766845.0000; val_gene_expr_recon_loss: 17884206.5333; val_masked_gp_l1_reg_loss: 165676.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94956.4922; val_chrom_access_recon_loss: 3953601.8167; val_global_loss: 24970782.8000; val_optim_loss: 24970782.8000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9491; val_auprc_score: 0.9333; val_best_acc_score: 0.8891; val_best_f1_score: 0.8955; train_kl_reg_loss: 105744.0230; train_edge_recon_loss: 2751452.0649; train_gene_expr_recon_loss: 17734243.4046; train_masked_gp_l1_reg_loss: 166101.8802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94217.1678; train_chrom_access_recon_loss: 3893841.7882; train_global_loss: 24745600.1832; train_optim_loss: 24745600.1832; val_kl_reg_loss: 104211.3865; val_edge_recon_loss: 2765004.7667; val_gene_expr_recon_loss: 17859470.5333; val_masked_gp_l1_reg_loss: 166433.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93640.2422; val_chrom_access_recon_loss: 3952419.9333; val_global_loss: 24941180.4000; val_optim_loss: 24941180.4000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9566; val_auprc_score: 0.9452; val_best_acc_score: 0.8988; val_best_f1_score: 0.9030; train_kl_reg_loss: 104772.8970; train_edge_recon_loss: 2754635.1145; train_gene_expr_recon_loss: 17688783.9618; train_masked_gp_l1_reg_loss: 166828.6713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93398.8511; train_chrom_access_recon_loss: 3887339.8302; train_global_loss: 24695759.3130; train_optim_loss: 24695759.3130; val_kl_reg_loss: 104651.4089; val_edge_recon_loss: 2753527.8167; val_gene_expr_recon_loss: 17792427.6000; val_masked_gp_l1_reg_loss: 167125.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93026.8750; val_chrom_access_recon_loss: 3952670.0167; val_global_loss: 24863428.8000; val_optim_loss: 24863428.8000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9531; val_auprc_score: 0.9421; val_best_acc_score: 0.8918; val_best_f1_score: 0.8955; train_kl_reg_loss: 104918.5825; train_edge_recon_loss: 2741645.0401; train_gene_expr_recon_loss: 17635154.1985; train_masked_gp_l1_reg_loss: 167209.1716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92546.7768; train_chrom_access_recon_loss: 3873669.3321; train_global_loss: 24615143.0534; train_optim_loss: 24615143.0534; val_kl_reg_loss: 100284.0688; val_edge_recon_loss: 2770493.4667; val_gene_expr_recon_loss: 17732978.1333; val_masked_gp_l1_reg_loss: 167616.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92753.6562; val_chrom_access_recon_loss: 3923605.1833; val_global_loss: 24787730.8000; val_optim_loss: 24787730.8000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9595; val_auprc_score: 0.9502; val_best_acc_score: 0.9003; val_best_f1_score: 0.9043; train_kl_reg_loss: 103644.2499; train_edge_recon_loss: 2731052.0229; train_gene_expr_recon_loss: 17592209.3435; train_masked_gp_l1_reg_loss: 167646.1852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92477.7805; train_chrom_access_recon_loss: 3865827.5553; train_global_loss: 24552857.1908; train_optim_loss: 24552857.1908; val_kl_reg_loss: 102787.8167; val_edge_recon_loss: 2756891.2167; val_gene_expr_recon_loss: 17707962.4667; val_masked_gp_l1_reg_loss: 167651.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91303.4531; val_chrom_access_recon_loss: 3918249.3167; val_global_loss: 24744846.6667; val_optim_loss: 24744846.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9614; val_auprc_score: 0.9518; val_best_acc_score: 0.9057; val_best_f1_score: 0.9090; train_kl_reg_loss: 104196.1499; train_edge_recon_loss: 2728756.6870; train_gene_expr_recon_loss: 17559285.7328; train_masked_gp_l1_reg_loss: 167865.2496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92285.1898; train_chrom_access_recon_loss: 3857674.7156; train_global_loss: 24510063.9389; train_optim_loss: 24510063.9389; val_kl_reg_loss: 108547.4026; val_edge_recon_loss: 2739666.5833; val_gene_expr_recon_loss: 17706294.2667; val_masked_gp_l1_reg_loss: 168464.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91779.5000; val_chrom_access_recon_loss: 3939668.1500; val_global_loss: 24754420.4000; val_optim_loss: 24754420.4000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9632; val_auprc_score: 0.9544; val_best_acc_score: 0.9060; val_best_f1_score: 0.9089; train_kl_reg_loss: 103650.9933; train_edge_recon_loss: 2730914.5515; train_gene_expr_recon_loss: 17516990.1374; train_masked_gp_l1_reg_loss: 168423.2025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92454.5511; train_chrom_access_recon_loss: 3847993.1355; train_global_loss: 24460426.5954; train_optim_loss: 24460426.5954; val_kl_reg_loss: 105209.9141; val_edge_recon_loss: 2725728.0333; val_gene_expr_recon_loss: 17718362.5333; val_masked_gp_l1_reg_loss: 169020.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93379.8984; val_chrom_access_recon_loss: 3937699.0167; val_global_loss: 24749399.7333; val_optim_loss: 24749399.7333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9600; val_auprc_score: 0.9488; val_best_acc_score: 0.9029; val_best_f1_score: 0.9079; train_kl_reg_loss: 104026.1068; train_edge_recon_loss: 2734198.1298; train_gene_expr_recon_loss: 17488304.6794; train_masked_gp_l1_reg_loss: 168788.8795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93102.2938; train_chrom_access_recon_loss: 3843359.4141; train_global_loss: 24431779.5115; train_optim_loss: 24431779.5115; val_kl_reg_loss: 104752.9932; val_edge_recon_loss: 2735369.9833; val_gene_expr_recon_loss: 17564864.9333; val_masked_gp_l1_reg_loss: 168628.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92483.9453; val_chrom_access_recon_loss: 3899926.6833; val_global_loss: 24566026.5333; val_optim_loss: 24566026.5333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9667; val_auprc_score: 0.9552; val_best_acc_score: 0.9148; val_best_f1_score: 0.9181; train_kl_reg_loss: 103963.3470; train_edge_recon_loss: 2731843.2634; train_gene_expr_recon_loss: 17462707.8550; train_masked_gp_l1_reg_loss: 168885.3136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93360.0284; train_chrom_access_recon_loss: 3835692.0344; train_global_loss: 24396451.7710; train_optim_loss: 24396451.7710; val_kl_reg_loss: 104390.3375; val_edge_recon_loss: 2721955.4833; val_gene_expr_recon_loss: 17622551.3333; val_masked_gp_l1_reg_loss: 168769.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92851.1641; val_chrom_access_recon_loss: 3885686.7500; val_global_loss: 24596205.7333; val_optim_loss: 24596205.7333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9653; val_auprc_score: 0.9555; val_best_acc_score: 0.9097; val_best_f1_score: 0.9127; train_kl_reg_loss: 109935.1816; train_edge_recon_loss: 2766351.1698; train_gene_expr_recon_loss: 16929098.1221; train_masked_gp_l1_reg_loss: 166100.6292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87358.5143; train_chrom_access_recon_loss: 3731472.7920; train_global_loss: 23790316.4580; train_optim_loss: 23790316.4580; val_kl_reg_loss: 72162.1932; val_edge_recon_loss: 2751946.8667; val_gene_expr_recon_loss: 17022167.4667; val_masked_gp_l1_reg_loss: 165484.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86413.1094; val_chrom_access_recon_loss: 3764239.2000; val_global_loss: 23862413.4667; val_optim_loss: 23862413.4667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9688; val_auprc_score: 0.9617; val_best_acc_score: 0.9159; val_best_f1_score: 0.9187; train_kl_reg_loss: 106309.6532; train_edge_recon_loss: 2743991.3435; train_gene_expr_recon_loss: 16890653.4122; train_masked_gp_l1_reg_loss: 164914.9599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85906.1206; train_chrom_access_recon_loss: 3714116.0153; train_global_loss: 23705891.5115; train_optim_loss: 23705891.5115; val_kl_reg_loss: 78280.5839; val_edge_recon_loss: 2730286.3667; val_gene_expr_recon_loss: 17075427.2000; val_masked_gp_l1_reg_loss: 164391.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85750.6562; val_chrom_access_recon_loss: 3794729.7167; val_global_loss: 23928865.7333; val_optim_loss: 23928865.7333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9671; val_auprc_score: 0.9584; val_best_acc_score: 0.9138; val_best_f1_score: 0.9169; train_kl_reg_loss: 100228.3410; train_edge_recon_loss: 2730061.4256; train_gene_expr_recon_loss: 16832940.6183; train_masked_gp_l1_reg_loss: 164054.1986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85788.9130; train_chrom_access_recon_loss: 3689650.3817; train_global_loss: 23602724.0458; train_optim_loss: 23602724.0458; val_kl_reg_loss: 81212.5833; val_edge_recon_loss: 2734611.1833; val_gene_expr_recon_loss: 16959246.5333; val_masked_gp_l1_reg_loss: 163863.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85435.6016; val_chrom_access_recon_loss: 3737765.4000; val_global_loss: 23762135.7333; val_optim_loss: 23762135.7333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9677; val_auprc_score: 0.9585; val_best_acc_score: 0.9146; val_best_f1_score: 0.9186; train_kl_reg_loss: 98538.6192; train_edge_recon_loss: 2719325.5954; train_gene_expr_recon_loss: 16803588.4275; train_masked_gp_l1_reg_loss: 163332.3189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85595.0246; train_chrom_access_recon_loss: 3685507.9256; train_global_loss: 23555887.8473; train_optim_loss: 23555887.8473; val_kl_reg_loss: 85338.3896; val_edge_recon_loss: 2731954.2667; val_gene_expr_recon_loss: 16970942.4667; val_masked_gp_l1_reg_loss: 163090.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85257.1094; val_chrom_access_recon_loss: 3749142.7333; val_global_loss: 23785725.6000; val_optim_loss: 23785725.6000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9663; val_auprc_score: 0.9579; val_best_acc_score: 0.9166; val_best_f1_score: 0.9200; train_kl_reg_loss: 97501.1487; train_edge_recon_loss: 2718184.1011; train_gene_expr_recon_loss: 16783418.4351; train_masked_gp_l1_reg_loss: 162551.3779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85127.2842; train_chrom_access_recon_loss: 3682022.7786; train_global_loss: 23528805.1298; train_optim_loss: 23528805.1298; val_kl_reg_loss: 89111.9016; val_edge_recon_loss: 2733486.3500; val_gene_expr_recon_loss: 16941033.5333; val_masked_gp_l1_reg_loss: 162351.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85185.3203; val_chrom_access_recon_loss: 3748530.2667; val_global_loss: 23759700.2667; val_optim_loss: 23759700.2667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9706; val_auprc_score: 0.9637; val_best_acc_score: 0.9185; val_best_f1_score: 0.9212; train_kl_reg_loss: 97014.3415; train_edge_recon_loss: 2718822.7099; train_gene_expr_recon_loss: 16766661.0458; train_masked_gp_l1_reg_loss: 161968.8226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84780.3211; train_chrom_access_recon_loss: 3678535.5611; train_global_loss: 23507782.8244; train_optim_loss: 23507782.8244; val_kl_reg_loss: 88941.6240; val_edge_recon_loss: 2716481.1833; val_gene_expr_recon_loss: 16903814.2667; val_masked_gp_l1_reg_loss: 161730.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83930.0000; val_chrom_access_recon_loss: 3747157.8667; val_global_loss: 23702055.0667; val_optim_loss: 23702055.0667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9716; val_auprc_score: 0.9634; val_best_acc_score: 0.9229; val_best_f1_score: 0.9251; train_kl_reg_loss: 96550.2528; train_edge_recon_loss: 2713634.2748; train_gene_expr_recon_loss: 16731729.9084; train_masked_gp_l1_reg_loss: 161476.3378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84197.1237; train_chrom_access_recon_loss: 3670872.8683; train_global_loss: 23458460.6870; train_optim_loss: 23458460.6870; val_kl_reg_loss: 92651.0714; val_edge_recon_loss: 2715953.1333; val_gene_expr_recon_loss: 16907914.5333; val_masked_gp_l1_reg_loss: 161431.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84311.4609; val_chrom_access_recon_loss: 3741713.1500; val_global_loss: 23703976.1333; val_optim_loss: 23703976.1333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9745; val_auprc_score: 0.9672; val_best_acc_score: 0.9264; val_best_f1_score: 0.9290; train_kl_reg_loss: 95606.4661; train_edge_recon_loss: 2716237.8779; train_gene_expr_recon_loss: 16729662.3511; train_masked_gp_l1_reg_loss: 161337.0781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84209.2799; train_chrom_access_recon_loss: 3672108.2996; train_global_loss: 23459161.2214; train_optim_loss: 23459161.2214; val_kl_reg_loss: 92404.8974; val_edge_recon_loss: 2694008.3833; val_gene_expr_recon_loss: 16837567.8667; val_masked_gp_l1_reg_loss: 161136.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83789.8438; val_chrom_access_recon_loss: 3720723.0167; val_global_loss: 23589630.0000; val_optim_loss: 23589630.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9704; val_auprc_score: 0.9602; val_best_acc_score: 0.9217; val_best_f1_score: 0.9241; train_kl_reg_loss: 95024.2304; train_edge_recon_loss: 2713275.6622; train_gene_expr_recon_loss: 16701102.1603; train_masked_gp_l1_reg_loss: 161087.1881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84036.1505; train_chrom_access_recon_loss: 3659522.0210; train_global_loss: 23414047.4809; train_optim_loss: 23414047.4809; val_kl_reg_loss: 90820.8552; val_edge_recon_loss: 2729395.0333; val_gene_expr_recon_loss: 16881242.6667; val_masked_gp_l1_reg_loss: 161146.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84191.2422; val_chrom_access_recon_loss: 3723511.4167; val_global_loss: 23670307.8667; val_optim_loss: 23670307.8667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9731; val_auprc_score: 0.9661; val_best_acc_score: 0.9254; val_best_f1_score: 0.9265; train_kl_reg_loss: 94653.7226; train_edge_recon_loss: 2712041.9905; train_gene_expr_recon_loss: 16682395.7481; train_masked_gp_l1_reg_loss: 160789.9988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83989.6714; train_chrom_access_recon_loss: 3656035.9256; train_global_loss: 23389907.3130; train_optim_loss: 23389907.3130; val_kl_reg_loss: 89817.0505; val_edge_recon_loss: 2726978.1167; val_gene_expr_recon_loss: 16771063.2667; val_masked_gp_l1_reg_loss: 160896.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84041.7188; val_chrom_access_recon_loss: 3703726.4000; val_global_loss: 23536523.2000; val_optim_loss: 23536523.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9706; val_auprc_score: 0.9586; val_best_acc_score: 0.9204; val_best_f1_score: 0.9229; train_kl_reg_loss: 94741.7374; train_edge_recon_loss: 2704248.9160; train_gene_expr_recon_loss: 16675777.3053; train_masked_gp_l1_reg_loss: 160781.6214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83770.8306; train_chrom_access_recon_loss: 3654028.2233; train_global_loss: 23373348.4427; train_optim_loss: 23373348.4427; val_kl_reg_loss: 92156.9021; val_edge_recon_loss: 2735062.8500; val_gene_expr_recon_loss: 16799396.5333; val_masked_gp_l1_reg_loss: 160880.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84234.9375; val_chrom_access_recon_loss: 3706374.1333; val_global_loss: 23578104.5333; val_optim_loss: 23578104.5333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9744; val_auprc_score: 0.9673; val_best_acc_score: 0.9263; val_best_f1_score: 0.9291; train_kl_reg_loss: 94631.8707; train_edge_recon_loss: 2714146.7805; train_gene_expr_recon_loss: 16674767.3206; train_masked_gp_l1_reg_loss: 160764.8935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83776.0185; train_chrom_access_recon_loss: 3655772.8015; train_global_loss: 23383859.7099; train_optim_loss: 23383859.7099; val_kl_reg_loss: 90070.1021; val_edge_recon_loss: 2711727.6333; val_gene_expr_recon_loss: 16838839.4667; val_masked_gp_l1_reg_loss: 160725.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84087.0703; val_chrom_access_recon_loss: 3739465.0833; val_global_loss: 23624916.0000; val_optim_loss: 23624916.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9764; val_auprc_score: 0.9707; val_best_acc_score: 0.9279; val_best_f1_score: 0.9301; train_kl_reg_loss: 94204.2150; train_edge_recon_loss: 2703706.0382; train_gene_expr_recon_loss: 16642911.3053; train_masked_gp_l1_reg_loss: 160712.3288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83726.6449; train_chrom_access_recon_loss: 3646764.0038; train_global_loss: 23332024.5802; train_optim_loss: 23332024.5802; val_kl_reg_loss: 90835.2594; val_edge_recon_loss: 2695857.1333; val_gene_expr_recon_loss: 16827512.6000; val_masked_gp_l1_reg_loss: 160517.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82858.6016; val_chrom_access_recon_loss: 3719158.1333; val_global_loss: 23576738.9333; val_optim_loss: 23576738.9333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9774; val_auprc_score: 0.9718; val_best_acc_score: 0.9297; val_best_f1_score: 0.9317; train_kl_reg_loss: 94359.3112; train_edge_recon_loss: 2702397.7595; train_gene_expr_recon_loss: 16635842.7557; train_masked_gp_l1_reg_loss: 160698.9778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83588.2801; train_chrom_access_recon_loss: 3647047.7004; train_global_loss: 23323934.7786; train_optim_loss: 23323934.7786; val_kl_reg_loss: 91892.4219; val_edge_recon_loss: 2711490.6167; val_gene_expr_recon_loss: 16748523.5333; val_masked_gp_l1_reg_loss: 160499.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83428.5312; val_chrom_access_recon_loss: 3710103.4500; val_global_loss: 23505938.2667; val_optim_loss: 23505938.2667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9780; val_auprc_score: 0.9734; val_best_acc_score: 0.9287; val_best_f1_score: 0.9306; train_kl_reg_loss: 93757.9901; train_edge_recon_loss: 2707483.7500; train_gene_expr_recon_loss: 16613507.0611; train_masked_gp_l1_reg_loss: 160608.5774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83564.1476; train_chrom_access_recon_loss: 3644019.8531; train_global_loss: 23302941.4809; train_optim_loss: 23302941.4809; val_kl_reg_loss: 90263.7063; val_edge_recon_loss: 2727580.1667; val_gene_expr_recon_loss: 16840725.9333; val_masked_gp_l1_reg_loss: 160717.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83576.2344; val_chrom_access_recon_loss: 3703943.6333; val_global_loss: 23606807.6000; val_optim_loss: 23606807.6000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9775; val_auprc_score: 0.9702; val_best_acc_score: 0.9352; val_best_f1_score: 0.9367; train_kl_reg_loss: 93718.8900; train_edge_recon_loss: 2704203.2786; train_gene_expr_recon_loss: 16621453.3511; train_masked_gp_l1_reg_loss: 160565.7438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83719.6184; train_chrom_access_recon_loss: 3644807.7233; train_global_loss: 23308468.7023; train_optim_loss: 23308468.7023; val_kl_reg_loss: 89402.1203; val_edge_recon_loss: 2717272.3333; val_gene_expr_recon_loss: 16811603.2667; val_masked_gp_l1_reg_loss: 160602.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83202.5625; val_chrom_access_recon_loss: 3693150.0833; val_global_loss: 23555232.0000; val_optim_loss: 23555232.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9798; val_auprc_score: 0.9751; val_best_acc_score: 0.9359; val_best_f1_score: 0.9376; train_kl_reg_loss: 93284.3101; train_edge_recon_loss: 2703734.9981; train_gene_expr_recon_loss: 16596129.2290; train_masked_gp_l1_reg_loss: 160338.0245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83486.2634; train_chrom_access_recon_loss: 3642868.9695; train_global_loss: 23279841.7710; train_optim_loss: 23279841.7710; val_kl_reg_loss: 90810.4245; val_edge_recon_loss: 2696466.2333; val_gene_expr_recon_loss: 16739519.8000; val_masked_gp_l1_reg_loss: 160279.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84166.6484; val_chrom_access_recon_loss: 3692254.4167; val_global_loss: 23463497.2000; val_optim_loss: 23463497.2000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9775; val_auprc_score: 0.9706; val_best_acc_score: 0.9298; val_best_f1_score: 0.9316; train_kl_reg_loss: 93620.7161; train_edge_recon_loss: 2696911.8569; train_gene_expr_recon_loss: 16592830.9313; train_masked_gp_l1_reg_loss: 160175.2353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83465.8371; train_chrom_access_recon_loss: 3644212.9160; train_global_loss: 23271217.5115; train_optim_loss: 23271217.5115; val_kl_reg_loss: 90684.4979; val_edge_recon_loss: 2722735.0667; val_gene_expr_recon_loss: 16756340.4667; val_masked_gp_l1_reg_loss: 159890.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83492.5859; val_chrom_access_recon_loss: 3710419.7667; val_global_loss: 23523561.7333; val_optim_loss: 23523561.7333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9759; val_auprc_score: 0.9677; val_best_acc_score: 0.9312; val_best_f1_score: 0.9337; train_kl_reg_loss: 93433.7984; train_edge_recon_loss: 2697024.8034; train_gene_expr_recon_loss: 16577166.7863; train_masked_gp_l1_reg_loss: 159935.7733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83438.7260; train_chrom_access_recon_loss: 3640131.1011; train_global_loss: 23251130.8702; train_optim_loss: 23251130.8702; val_kl_reg_loss: 92819.0724; val_edge_recon_loss: 2717670.6000; val_gene_expr_recon_loss: 16785690.7333; val_masked_gp_l1_reg_loss: 160133.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83262.8359; val_chrom_access_recon_loss: 3702176.5333; val_global_loss: 23541752.9333; val_optim_loss: 23541752.9333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9782; val_auprc_score: 0.9730; val_best_acc_score: 0.9349; val_best_f1_score: 0.9361; train_kl_reg_loss: 93682.8444; train_edge_recon_loss: 2703460.2061; train_gene_expr_recon_loss: 16567288.7939; train_masked_gp_l1_reg_loss: 159967.5850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83510.9045; train_chrom_access_recon_loss: 3635848.8721; train_global_loss: 23243759.1603; train_optim_loss: 23243759.1603; val_kl_reg_loss: 89566.5052; val_edge_recon_loss: 2710859.8000; val_gene_expr_recon_loss: 16770228.0667; val_masked_gp_l1_reg_loss: 159804.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83341.8750; val_chrom_access_recon_loss: 3693583.0833; val_global_loss: 23507383.4667; val_optim_loss: 23507383.4667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9786; val_auprc_score: 0.9730; val_best_acc_score: 0.9316; val_best_f1_score: 0.9338; train_kl_reg_loss: 94050.9441; train_edge_recon_loss: 2696532.3702; train_gene_expr_recon_loss: 16562966.0687; train_masked_gp_l1_reg_loss: 159661.8615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83448.3319; train_chrom_access_recon_loss: 3630621.3607; train_global_loss: 23227280.8244; train_optim_loss: 23227280.8244; val_kl_reg_loss: 94418.3151; val_edge_recon_loss: 2721721.5333; val_gene_expr_recon_loss: 16724744.0667; val_masked_gp_l1_reg_loss: 159457.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82791.1797; val_chrom_access_recon_loss: 3694692.4833; val_global_loss: 23477826.0000; val_optim_loss: 23477826.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9792; val_auprc_score: 0.9749; val_best_acc_score: 0.9305; val_best_f1_score: 0.9323; train_kl_reg_loss: 96114.7280; train_edge_recon_loss: 2694732.1164; train_gene_expr_recon_loss: 16526410.5649; train_masked_gp_l1_reg_loss: 156819.5728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64343.8769; train_chrom_access_recon_loss: 3621886.6431; train_global_loss: 23160307.6031; train_optim_loss: 23160307.6031; val_kl_reg_loss: 94961.8120; val_edge_recon_loss: 2713338.2833; val_gene_expr_recon_loss: 16782124.1333; val_masked_gp_l1_reg_loss: 156055.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62359.9531; val_chrom_access_recon_loss: 3706875.5667; val_global_loss: 23515715.4667; val_optim_loss: 23515715.4667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9802; val_auprc_score: 0.9749; val_best_acc_score: 0.9363; val_best_f1_score: 0.9383; train_kl_reg_loss: 96657.6088; train_edge_recon_loss: 2696908.0668; train_gene_expr_recon_loss: 16522365.3282; train_masked_gp_l1_reg_loss: 155875.3141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62048.7620; train_chrom_access_recon_loss: 3618754.1775; train_global_loss: 23152609.3435; train_optim_loss: 23152609.3435; val_kl_reg_loss: 95615.0786; val_edge_recon_loss: 2701369.5333; val_gene_expr_recon_loss: 16690299.9333; val_masked_gp_l1_reg_loss: 155775.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61798.4219; val_chrom_access_recon_loss: 3685140.9667; val_global_loss: 23389999.8667; val_optim_loss: 23389999.8667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9799; val_auprc_score: 0.9747; val_best_acc_score: 0.9338; val_best_f1_score: 0.9355; train_kl_reg_loss: 96871.6230; train_edge_recon_loss: 2700882.6088; train_gene_expr_recon_loss: 16527000.3435; train_masked_gp_l1_reg_loss: 155704.4819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61613.8689; train_chrom_access_recon_loss: 3621406.7290; train_global_loss: 23163479.6183; train_optim_loss: 23163479.6183; val_kl_reg_loss: 95321.0271; val_edge_recon_loss: 2703379.0833; val_gene_expr_recon_loss: 16747780.0000; val_masked_gp_l1_reg_loss: 155604.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61292.3750; val_chrom_access_recon_loss: 3687195.0500; val_global_loss: 23450571.8667; val_optim_loss: 23450571.8667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9805; val_auprc_score: 0.9755; val_best_acc_score: 0.9361; val_best_f1_score: 0.9382; train_kl_reg_loss: 96874.7357; train_edge_recon_loss: 2698262.5534; train_gene_expr_recon_loss: 16523647.4885; train_masked_gp_l1_reg_loss: 155518.4406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61163.6525; train_chrom_access_recon_loss: 3621949.1908; train_global_loss: 23157416.0458; train_optim_loss: 23157416.0458; val_kl_reg_loss: 96074.2734; val_edge_recon_loss: 2698646.8500; val_gene_expr_recon_loss: 16727829.2667; val_masked_gp_l1_reg_loss: 155493.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61085.6602; val_chrom_access_recon_loss: 3698502.3167; val_global_loss: 23437632.6667; val_optim_loss: 23437632.6667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9790; val_auprc_score: 0.9725; val_best_acc_score: 0.9364; val_best_f1_score: 0.9379; train_kl_reg_loss: 97148.3940; train_edge_recon_loss: 2698996.7519; train_gene_expr_recon_loss: 16515551.5038; train_masked_gp_l1_reg_loss: 155456.0229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60927.0919; train_chrom_access_recon_loss: 3618817.8187; train_global_loss: 23146897.6336; train_optim_loss: 23146897.6336; val_kl_reg_loss: 95258.6328; val_edge_recon_loss: 2719143.0333; val_gene_expr_recon_loss: 16736451.9333; val_masked_gp_l1_reg_loss: 155445.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60722.2344; val_chrom_access_recon_loss: 3694599.6667; val_global_loss: 23461620.9333; val_optim_loss: 23461620.9333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9791; val_auprc_score: 0.9727; val_best_acc_score: 0.9347; val_best_f1_score: 0.9363; train_kl_reg_loss: 97195.6094; train_edge_recon_loss: 2692405.6069; train_gene_expr_recon_loss: 16521887.2748; train_masked_gp_l1_reg_loss: 155395.1511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60588.9967; train_chrom_access_recon_loss: 3621622.9065; train_global_loss: 23149095.5267; train_optim_loss: 23149095.5267; val_kl_reg_loss: 96197.5604; val_edge_recon_loss: 2711994.2833; val_gene_expr_recon_loss: 16688004.4667; val_masked_gp_l1_reg_loss: 155368.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60468.3008; val_chrom_access_recon_loss: 3668655.0667; val_global_loss: 23380687.7333; val_optim_loss: 23380687.7333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9799; val_auprc_score: 0.9753; val_best_acc_score: 0.9347; val_best_f1_score: 0.9362; train_kl_reg_loss: 97435.8177; train_edge_recon_loss: 2693698.4714; train_gene_expr_recon_loss: 16514729.5115; train_masked_gp_l1_reg_loss: 155328.6790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60359.3474; train_chrom_access_recon_loss: 3617961.4160; train_global_loss: 23139513.2519; train_optim_loss: 23139513.2519; val_kl_reg_loss: 96533.7448; val_edge_recon_loss: 2708882.4000; val_gene_expr_recon_loss: 16774691.7333; val_masked_gp_l1_reg_loss: 155264.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60171.5742; val_chrom_access_recon_loss: 3701049.6167; val_global_loss: 23496593.3333; val_optim_loss: 23496593.3333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9817; val_auprc_score: 0.9777; val_best_acc_score: 0.9378; val_best_f1_score: 0.9393; train_kl_reg_loss: 97492.5103; train_edge_recon_loss: 2699038.1431; train_gene_expr_recon_loss: 16522969.2443; train_masked_gp_l1_reg_loss: 155263.4159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60106.2800; train_chrom_access_recon_loss: 3622282.1851; train_global_loss: 23157151.7099; train_optim_loss: 23157151.7099; val_kl_reg_loss: 96303.5896; val_edge_recon_loss: 2685706.8167; val_gene_expr_recon_loss: 16721477.8000; val_masked_gp_l1_reg_loss: 155196.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59801.3711; val_chrom_access_recon_loss: 3682606.0667; val_global_loss: 23401092.1333; val_optim_loss: 23401092.1333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9801; val_auprc_score: 0.9725; val_best_acc_score: 0.9361; val_best_f1_score: 0.9370; train_kl_reg_loss: 97882.6155; train_edge_recon_loss: 2693863.3626; train_gene_expr_recon_loss: 16510197.3435; train_masked_gp_l1_reg_loss: 155168.7597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59785.8581; train_chrom_access_recon_loss: 3619775.5305; train_global_loss: 23136673.6489; train_optim_loss: 23136673.6489; val_kl_reg_loss: 96919.3552; val_edge_recon_loss: 2709314.7667; val_gene_expr_recon_loss: 16680796.6667; val_masked_gp_l1_reg_loss: 155118.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59601.0664; val_chrom_access_recon_loss: 3678436.3667; val_global_loss: 23380187.3333; val_optim_loss: 23380187.3333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9778; val_auprc_score: 0.9717; val_best_acc_score: 0.9337; val_best_f1_score: 0.9355; train_kl_reg_loss: 97438.9144; train_edge_recon_loss: 2702660.6374; train_gene_expr_recon_loss: 16506208.9695; train_masked_gp_l1_reg_loss: 155095.2450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59588.9571; train_chrom_access_recon_loss: 3617809.9351; train_global_loss: 23138802.7634; train_optim_loss: 23138802.7634; val_kl_reg_loss: 96653.3120; val_edge_recon_loss: 2714979.4667; val_gene_expr_recon_loss: 16646878.5333; val_masked_gp_l1_reg_loss: 155126.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59572.6484; val_chrom_access_recon_loss: 3668468.9833; val_global_loss: 23341678.2667; val_optim_loss: 23341678.2667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9805; val_auprc_score: 0.9721; val_best_acc_score: 0.9337; val_best_f1_score: 0.9354; train_kl_reg_loss: 97085.1376; train_edge_recon_loss: 2693141.9046; train_gene_expr_recon_loss: 16502117.5115; train_masked_gp_l1_reg_loss: 155088.3226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59450.4486; train_chrom_access_recon_loss: 3618241.2824; train_global_loss: 23125124.8855; train_optim_loss: 23125124.8855; val_kl_reg_loss: 95521.5182; val_edge_recon_loss: 2700473.7000; val_gene_expr_recon_loss: 16724948.4000; val_masked_gp_l1_reg_loss: 155049.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59297.1250; val_chrom_access_recon_loss: 3693403.4667; val_global_loss: 23428695.2000; val_optim_loss: 23428695.2000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9819; val_auprc_score: 0.9764; val_best_acc_score: 0.9361; val_best_f1_score: 0.9378; train_kl_reg_loss: 96880.9380; train_edge_recon_loss: 2692197.6393; train_gene_expr_recon_loss: 16507211.4733; train_masked_gp_l1_reg_loss: 155059.9846; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59236.8481; train_chrom_access_recon_loss: 3619248.0305; train_global_loss: 23129834.8702; train_optim_loss: 23129834.8702; val_kl_reg_loss: 96800.7604; val_edge_recon_loss: 2696777.1833; val_gene_expr_recon_loss: 16723274.7333; val_masked_gp_l1_reg_loss: 155020.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59194.5469; val_chrom_access_recon_loss: 3689785.7000; val_global_loss: 23420852.1333; val_optim_loss: 23420852.1333
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9804; val_auprc_score: 0.9751; val_best_acc_score: 0.9387; val_best_f1_score: 0.9406; train_kl_reg_loss: 97299.5474; train_edge_recon_loss: 2696636.4981; train_gene_expr_recon_loss: 16510622.2519; train_masked_gp_l1_reg_loss: 155022.0252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59028.6847; train_chrom_access_recon_loss: 3620034.8874; train_global_loss: 23138644.0000; train_optim_loss: 23138644.0000; val_kl_reg_loss: 95948.7479; val_edge_recon_loss: 2699443.3333; val_gene_expr_recon_loss: 16710580.6000; val_masked_gp_l1_reg_loss: 155033.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59125.1133; val_chrom_access_recon_loss: 3682118.7000; val_global_loss: 23402251.0667; val_optim_loss: 23402251.0667
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9812; val_auprc_score: 0.9731; val_best_acc_score: 0.9390; val_best_f1_score: 0.9405; train_kl_reg_loss: 97113.1670; train_edge_recon_loss: 2701722.4637; train_gene_expr_recon_loss: 16490689.0916; train_masked_gp_l1_reg_loss: 155004.9405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58907.9039; train_chrom_access_recon_loss: 3615086.5210; train_global_loss: 23118524.0916; train_optim_loss: 23118524.0916; val_kl_reg_loss: 96022.5057; val_edge_recon_loss: 2703231.2000; val_gene_expr_recon_loss: 16764682.1333; val_masked_gp_l1_reg_loss: 155007.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58825.0977; val_chrom_access_recon_loss: 3692963.0000; val_global_loss: 23470732.8000; val_optim_loss: 23470732.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9781; val_auprc_score: 0.9700; val_best_acc_score: 0.9330; val_best_f1_score: 0.9354; train_kl_reg_loss: 96847.5231; train_edge_recon_loss: 2696773.5534; train_gene_expr_recon_loss: 16497850.7710; train_masked_gp_l1_reg_loss: 154718.7838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56806.0239; train_chrom_access_recon_loss: 3619638.0668; train_global_loss: 23122634.6718; train_optim_loss: 23122634.6718; val_kl_reg_loss: 95878.4500; val_edge_recon_loss: 2716631.8833; val_gene_expr_recon_loss: 16645289.2000; val_masked_gp_l1_reg_loss: 154609.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56592.7383; val_chrom_access_recon_loss: 3678108.1833; val_global_loss: 23347109.4667; val_optim_loss: 23347109.4667
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9791; val_auprc_score: 0.9702; val_best_acc_score: 0.9359; val_best_f1_score: 0.9381; train_kl_reg_loss: 96982.9154; train_edge_recon_loss: 2696600.7710; train_gene_expr_recon_loss: 16497619.3969; train_masked_gp_l1_reg_loss: 154571.5088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56561.4497; train_chrom_access_recon_loss: 3615645.8034; train_global_loss: 23117981.8473; train_optim_loss: 23117981.8473; val_kl_reg_loss: 95974.0526; val_edge_recon_loss: 2701496.7667; val_gene_expr_recon_loss: 16720662.9333; val_masked_gp_l1_reg_loss: 154538.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56524.9727; val_chrom_access_recon_loss: 3698323.3000; val_global_loss: 23427518.6667; val_optim_loss: 23427518.6667
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9815; val_auprc_score: 0.9758; val_best_acc_score: 0.9368; val_best_f1_score: 0.9381; train_kl_reg_loss: 97046.7941; train_edge_recon_loss: 2699464.1355; train_gene_expr_recon_loss: 16515988.7939; train_masked_gp_l1_reg_loss: 154524.0921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56510.2541; train_chrom_access_recon_loss: 3621312.2118; train_global_loss: 23144846.1374; train_optim_loss: 23144846.1374; val_kl_reg_loss: 96258.9922; val_edge_recon_loss: 2703449.7000; val_gene_expr_recon_loss: 16716095.4000; val_masked_gp_l1_reg_loss: 154505.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56479.3711; val_chrom_access_recon_loss: 3715575.8833; val_global_loss: 23442365.7333; val_optim_loss: 23442365.7333
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9816; val_auprc_score: 0.9764; val_best_acc_score: 0.9383; val_best_f1_score: 0.9397; train_kl_reg_loss: 96881.5307; train_edge_recon_loss: 2696866.7099; train_gene_expr_recon_loss: 16494529.9466; train_masked_gp_l1_reg_loss: 154496.6189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56461.9263; train_chrom_access_recon_loss: 3615703.5000; train_global_loss: 23114940.0611; train_optim_loss: 23114940.0611; val_kl_reg_loss: 96163.2109; val_edge_recon_loss: 2708844.9500; val_gene_expr_recon_loss: 16657673.6667; val_masked_gp_l1_reg_loss: 154484.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56449.1250; val_chrom_access_recon_loss: 3669233.5500; val_global_loss: 23342849.3333; val_optim_loss: 23342849.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 78 min 45 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.9808
val AUPRC score: 0.9745
val best accuracy score: 0.9348
val best F1 score: 0.9362
val target rna MSE score: 1.3357
val source rna MSE score: 0.3736
val target atac MSE score: 0.5086
val source atac MSE score: 0.0810
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
