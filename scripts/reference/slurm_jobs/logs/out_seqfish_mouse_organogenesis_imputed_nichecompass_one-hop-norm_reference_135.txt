[True]
Run timestamp: 27072023_030506_135.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_135']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8818; val_auprc_score: 0.9767; val_best_acc_score: 0.8563; val_best_f1_score: 0.9226; train_kl_reg_loss: 628663.9842; train_edge_recon_loss: 11331283.2047; train_gene_expr_recon_loss: 26980606.8651; train_masked_gp_l1_reg_loss: 7918.7130; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38948472.7628; train_optim_loss: 38948472.7628; val_kl_reg_loss: 321447.5469; val_edge_recon_loss: 11679962.7083; val_gene_expr_recon_loss: 16241723.6667; val_masked_gp_l1_reg_loss: 8269.6963; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28251404.0000; val_optim_loss: 28251404.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8674; val_auprc_score: 0.9730; val_best_acc_score: 0.8544; val_best_f1_score: 0.9215; train_kl_reg_loss: 604223.1658; train_edge_recon_loss: 11288407.0465; train_gene_expr_recon_loss: 30192281.5256; train_masked_gp_l1_reg_loss: 8636.6226; train_group_lasso_reg_loss: 0.0000; train_global_loss: 42093548.4000; train_optim_loss: 42093548.4000; val_kl_reg_loss: 607621.9583; val_edge_recon_loss: 11826971.8750; val_gene_expr_recon_loss: 26445305.3333; val_masked_gp_l1_reg_loss: 8821.8516; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38888718.8333; val_optim_loss: 38888718.8333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8562; val_auprc_score: 0.9706; val_best_acc_score: 0.8507; val_best_f1_score: 0.9194; train_kl_reg_loss: 568163.2536; train_edge_recon_loss: 11168433.1535; train_gene_expr_recon_loss: 26341063.9907; train_masked_gp_l1_reg_loss: 8914.9800; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38086575.4419; train_optim_loss: 38086575.4419; val_kl_reg_loss: 513119.2461; val_edge_recon_loss: 12136100.5000; val_gene_expr_recon_loss: 25924168.9167; val_masked_gp_l1_reg_loss: 9029.2666; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38582416.6667; val_optim_loss: 38582416.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8496; val_auprc_score: 0.9684; val_best_acc_score: 0.8547; val_best_f1_score: 0.9215; train_kl_reg_loss: 482954.8051; train_edge_recon_loss: 11000705.2419; train_gene_expr_recon_loss: 25663929.0047; train_masked_gp_l1_reg_loss: 9227.2288; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37156816.2791; train_optim_loss: 37156816.2791; val_kl_reg_loss: 374361.3398; val_edge_recon_loss: 11949818.4167; val_gene_expr_recon_loss: 25381587.8333; val_masked_gp_l1_reg_loss: 9386.0938; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37715155.6667; val_optim_loss: 37715155.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8468; val_auprc_score: 0.9676; val_best_acc_score: 0.8595; val_best_f1_score: 0.9236; train_kl_reg_loss: 426589.9141; train_edge_recon_loss: 10828671.2465; train_gene_expr_recon_loss: 25239603.9070; train_masked_gp_l1_reg_loss: 9563.3054; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36504428.3349; train_optim_loss: 36504428.3349; val_kl_reg_loss: 261254.4023; val_edge_recon_loss: 12010038.0417; val_gene_expr_recon_loss: 25099469.9167; val_masked_gp_l1_reg_loss: 9788.5234; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37380550.1667; val_optim_loss: 37380550.1667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8353; val_auprc_score: 0.9633; val_best_acc_score: 0.8590; val_best_f1_score: 0.9218; train_kl_reg_loss: 337646.2053; train_edge_recon_loss: 10850345.8465; train_gene_expr_recon_loss: 24986655.7953; train_masked_gp_l1_reg_loss: 10134.5305; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36184782.3814; train_optim_loss: 36184782.3814; val_kl_reg_loss: 265165.8034; val_edge_recon_loss: 12290051.5833; val_gene_expr_recon_loss: 24401051.3333; val_masked_gp_l1_reg_loss: 10459.3301; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36966729.1667; val_optim_loss: 36966729.1667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8472; val_auprc_score: 0.9664; val_best_acc_score: 0.8669; val_best_f1_score: 0.9262; train_kl_reg_loss: 76858.3571; train_edge_recon_loss: 10735163.8140; train_gene_expr_recon_loss: 16953302.1767; train_masked_gp_l1_reg_loss: 12768.9334; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27778093.3488; train_optim_loss: 27778093.3488; val_kl_reg_loss: 47903.5072; val_edge_recon_loss: 12057858.9583; val_gene_expr_recon_loss: 10655729.2500; val_masked_gp_l1_reg_loss: 14286.5703; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22775777.5000; val_optim_loss: 22775777.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8408; val_auprc_score: 0.9663; val_best_acc_score: 0.8651; val_best_f1_score: 0.9265; train_kl_reg_loss: 85603.4937; train_edge_recon_loss: 10427214.5558; train_gene_expr_recon_loss: 9645716.6093; train_masked_gp_l1_reg_loss: 14486.5504; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20173021.1349; train_optim_loss: 20173021.1349; val_kl_reg_loss: 87400.6152; val_edge_recon_loss: 11604686.9583; val_gene_expr_recon_loss: 9280883.7917; val_masked_gp_l1_reg_loss: 14531.1875; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20987503.3333; val_optim_loss: 20987503.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8257; val_auprc_score: 0.9612; val_best_acc_score: 0.8779; val_best_f1_score: 0.9328; train_kl_reg_loss: 82310.6333; train_edge_recon_loss: 10352991.2140; train_gene_expr_recon_loss: 9221679.6047; train_masked_gp_l1_reg_loss: 14649.0802; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19671630.6512; train_optim_loss: 19671630.6512; val_kl_reg_loss: 66113.1213; val_edge_recon_loss: 10903213.2500; val_gene_expr_recon_loss: 9070723.3750; val_masked_gp_l1_reg_loss: 14748.0381; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20054797.6667; val_optim_loss: 20054797.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8458; val_auprc_score: 0.9637; val_best_acc_score: 0.8799; val_best_f1_score: 0.9329; train_kl_reg_loss: 61230.7877; train_edge_recon_loss: 9771982.2302; train_gene_expr_recon_loss: 9023062.9488; train_masked_gp_l1_reg_loss: 14956.6547; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18871232.5628; train_optim_loss: 18871232.5628; val_kl_reg_loss: 58426.4961; val_edge_recon_loss: 9619046.4583; val_gene_expr_recon_loss: 8923606.0833; val_masked_gp_l1_reg_loss: 15258.1953; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18616337.3333; val_optim_loss: 18616337.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8404; val_auprc_score: 0.9610; val_best_acc_score: 0.8816; val_best_f1_score: 0.9336; train_kl_reg_loss: 77976.5274; train_edge_recon_loss: 9123397.8930; train_gene_expr_recon_loss: 8870251.1023; train_masked_gp_l1_reg_loss: 15568.1768; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18087193.6884; train_optim_loss: 18087193.6884; val_kl_reg_loss: 92029.8753; val_edge_recon_loss: 9299247.4167; val_gene_expr_recon_loss: 8756198.8333; val_masked_gp_l1_reg_loss: 15861.5674; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18163337.9167; val_optim_loss: 18163337.9167
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8256; val_auprc_score: 0.9600; val_best_acc_score: 0.8887; val_best_f1_score: 0.9382; train_kl_reg_loss: 103022.0859; train_edge_recon_loss: 8707543.8651; train_gene_expr_recon_loss: 8700898.1581; train_masked_gp_l1_reg_loss: 16069.3579; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17527533.4651; train_optim_loss: 17527533.4651; val_kl_reg_loss: 104465.0479; val_edge_recon_loss: 8853511.2083; val_gene_expr_recon_loss: 8601749.9583; val_masked_gp_l1_reg_loss: 16263.3896; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17575989.9583; val_optim_loss: 17575989.9583
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8439; val_auprc_score: 0.9639; val_best_acc_score: 0.8919; val_best_f1_score: 0.9396; train_kl_reg_loss: 110299.8697; train_edge_recon_loss: 8635963.4070; train_gene_expr_recon_loss: 8563847.6047; train_masked_gp_l1_reg_loss: 16431.5290; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17326542.3581; train_optim_loss: 17326542.3581; val_kl_reg_loss: 107356.1341; val_edge_recon_loss: 8921048.9375; val_gene_expr_recon_loss: 8488466.2917; val_masked_gp_l1_reg_loss: 16598.2441; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17533469.3750; val_optim_loss: 17533469.3750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8560; val_auprc_score: 0.9660; val_best_acc_score: 0.8961; val_best_f1_score: 0.9418; train_kl_reg_loss: 106628.6505; train_edge_recon_loss: 8551941.7512; train_gene_expr_recon_loss: 8453105.4372; train_masked_gp_l1_reg_loss: 16753.1902; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17128428.9581; train_optim_loss: 17128428.9581; val_kl_reg_loss: 101109.5879; val_edge_recon_loss: 8739724.1875; val_gene_expr_recon_loss: 8366390.3750; val_masked_gp_l1_reg_loss: 16913.3574; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17224137.9167; val_optim_loss: 17224137.9167
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8517; val_auprc_score: 0.9657; val_best_acc_score: 0.8963; val_best_f1_score: 0.9421; train_kl_reg_loss: 100214.0713; train_edge_recon_loss: 8510010.7930; train_gene_expr_recon_loss: 8345367.6860; train_masked_gp_l1_reg_loss: 17093.1824; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16972685.7488; train_optim_loss: 16972685.7488; val_kl_reg_loss: 94428.5020; val_edge_recon_loss: 8630024.3125; val_gene_expr_recon_loss: 8277646.2292; val_masked_gp_l1_reg_loss: 17280.4219; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17019378.9583; val_optim_loss: 17019378.9583
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8610; val_auprc_score: 0.9673; val_best_acc_score: 0.9026; val_best_f1_score: 0.9448; train_kl_reg_loss: 91346.2545; train_edge_recon_loss: 8454407.9442; train_gene_expr_recon_loss: 8252833.3163; train_masked_gp_l1_reg_loss: 17485.6178; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16816073.1070; train_optim_loss: 16816073.1070; val_kl_reg_loss: 85953.4775; val_edge_recon_loss: 8464458.0833; val_gene_expr_recon_loss: 8179855.8125; val_masked_gp_l1_reg_loss: 17688.4941; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16747955.3750; val_optim_loss: 16747955.3750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8726; val_auprc_score: 0.9703; val_best_acc_score: 0.8993; val_best_f1_score: 0.9430; train_kl_reg_loss: 84905.9882; train_edge_recon_loss: 8364805.4721; train_gene_expr_recon_loss: 8148650.3628; train_masked_gp_l1_reg_loss: 17882.1188; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16616243.9535; train_optim_loss: 16616243.9535; val_kl_reg_loss: 79417.3675; val_edge_recon_loss: 8625275.1667; val_gene_expr_recon_loss: 8084487.8750; val_masked_gp_l1_reg_loss: 18077.1406; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16807257.7083; val_optim_loss: 16807257.7083
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8774; val_auprc_score: 0.9711; val_best_acc_score: 0.9008; val_best_f1_score: 0.9435; train_kl_reg_loss: 79774.8877; train_edge_recon_loss: 8261351.9767; train_gene_expr_recon_loss: 8054078.4209; train_masked_gp_l1_reg_loss: 18234.7525; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16413440.0279; train_optim_loss: 16413440.0279; val_kl_reg_loss: 73254.6504; val_edge_recon_loss: 8599434.0625; val_gene_expr_recon_loss: 7989451.4792; val_masked_gp_l1_reg_loss: 18390.2617; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16680530.1667; val_optim_loss: 16680530.1667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8918; val_auprc_score: 0.9744; val_best_acc_score: 0.9061; val_best_f1_score: 0.9467; train_kl_reg_loss: 72558.3925; train_edge_recon_loss: 8192154.8116; train_gene_expr_recon_loss: 7968193.0093; train_masked_gp_l1_reg_loss: 18520.1500; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16251426.3674; train_optim_loss: 16251426.3674; val_kl_reg_loss: 66606.2747; val_edge_recon_loss: 8369969.8333; val_gene_expr_recon_loss: 7914200.6667; val_masked_gp_l1_reg_loss: 18643.7656; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16369420.9167; val_optim_loss: 16369420.9167
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8957; val_auprc_score: 0.9747; val_best_acc_score: 0.9074; val_best_f1_score: 0.9470; train_kl_reg_loss: 65727.6943; train_edge_recon_loss: 8117752.0372; train_gene_expr_recon_loss: 7889725.5860; train_masked_gp_l1_reg_loss: 18766.5095; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16091971.8093; train_optim_loss: 16091971.8093; val_kl_reg_loss: 60715.1810; val_edge_recon_loss: 8544580.9167; val_gene_expr_recon_loss: 7835360.1875; val_masked_gp_l1_reg_loss: 18888.0645; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16459544.2083; val_optim_loss: 16459544.2083
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9038; val_auprc_score: 0.9779; val_best_acc_score: 0.9145; val_best_f1_score: 0.9511; train_kl_reg_loss: 61758.9892; train_edge_recon_loss: 8094068.2907; train_gene_expr_recon_loss: 7814299.3116; train_masked_gp_l1_reg_loss: 18991.1060; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15989117.6326; train_optim_loss: 15989117.6326; val_kl_reg_loss: 59454.1632; val_edge_recon_loss: 8153762.7083; val_gene_expr_recon_loss: 7772839.6458; val_masked_gp_l1_reg_loss: 19078.5840; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16005135.3333; val_optim_loss: 16005135.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9130; val_auprc_score: 0.9802; val_best_acc_score: 0.9208; val_best_f1_score: 0.9544; train_kl_reg_loss: 59941.2603; train_edge_recon_loss: 7945447.4279; train_gene_expr_recon_loss: 7746502.7791; train_masked_gp_l1_reg_loss: 19145.5118; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15771036.9488; train_optim_loss: 15771036.9488; val_kl_reg_loss: 55894.8770; val_edge_recon_loss: 8187846.6042; val_gene_expr_recon_loss: 7697261.9167; val_masked_gp_l1_reg_loss: 19210.5195; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15960214.3333; val_optim_loss: 15960214.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9137; val_auprc_score: 0.9799; val_best_acc_score: 0.9214; val_best_f1_score: 0.9546; train_kl_reg_loss: 56070.0359; train_edge_recon_loss: 7918834.4930; train_gene_expr_recon_loss: 7685662.3791; train_masked_gp_l1_reg_loss: 19264.6504; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15679831.4977; train_optim_loss: 15679831.4977; val_kl_reg_loss: 52758.9972; val_edge_recon_loss: 8328952.4583; val_gene_expr_recon_loss: 7658343.4167; val_masked_gp_l1_reg_loss: 19304.4375; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16059358.8750; val_optim_loss: 16059358.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9221; val_auprc_score: 0.9827; val_best_acc_score: 0.9229; val_best_f1_score: 0.9557; train_kl_reg_loss: 52008.2441; train_edge_recon_loss: 7963009.3093; train_gene_expr_recon_loss: 7626766.0302; train_masked_gp_l1_reg_loss: 19325.9104; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15661109.5302; train_optim_loss: 15661109.5302; val_kl_reg_loss: 47577.6152; val_edge_recon_loss: 8022664.6667; val_gene_expr_recon_loss: 7584611.0208; val_masked_gp_l1_reg_loss: 19339.0312; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15674192.4167; val_optim_loss: 15674192.4167
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9240; val_auprc_score: 0.9843; val_best_acc_score: 0.9233; val_best_f1_score: 0.9563; train_kl_reg_loss: 48063.6478; train_edge_recon_loss: 7888373.1674; train_gene_expr_recon_loss: 7573303.1581; train_masked_gp_l1_reg_loss: 19331.4164; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15529071.3907; train_optim_loss: 15529071.3907; val_kl_reg_loss: 44932.7422; val_edge_recon_loss: 7868792.2708; val_gene_expr_recon_loss: 7542603.0625; val_masked_gp_l1_reg_loss: 19313.7324; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15475642.1250; val_optim_loss: 15475642.1250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9275; val_auprc_score: 0.9835; val_best_acc_score: 0.9234; val_best_f1_score: 0.9561; train_kl_reg_loss: 45331.5475; train_edge_recon_loss: 7900920.9884; train_gene_expr_recon_loss: 7535912.9233; train_masked_gp_l1_reg_loss: 19345.1588; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15501510.6465; train_optim_loss: 15501510.6465; val_kl_reg_loss: 17761.4684; val_edge_recon_loss: 8189779.3333; val_gene_expr_recon_loss: 7503122.4792; val_masked_gp_l1_reg_loss: 19347.3555; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15730010.3750; val_optim_loss: 15730010.3750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9352; val_auprc_score: 0.9856; val_best_acc_score: 0.9251; val_best_f1_score: 0.9568; train_kl_reg_loss: 41208.3471; train_edge_recon_loss: 7888983.7256; train_gene_expr_recon_loss: 7488889.4488; train_masked_gp_l1_reg_loss: 19291.9448; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15438373.5163; train_optim_loss: 15438373.5163; val_kl_reg_loss: 17255.3129; val_edge_recon_loss: 8058571.8542; val_gene_expr_recon_loss: 7465712.1875; val_masked_gp_l1_reg_loss: 19240.5977; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15560780.2917; val_optim_loss: 15560780.2917
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9439; val_auprc_score: 0.9869; val_best_acc_score: 0.9318; val_best_f1_score: 0.9604; train_kl_reg_loss: 37778.7396; train_edge_recon_loss: 7820762.3651; train_gene_expr_recon_loss: 7444564.8698; train_masked_gp_l1_reg_loss: 19126.4281; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15322232.4419; train_optim_loss: 15322232.4419; val_kl_reg_loss: 16868.2483; val_edge_recon_loss: 8124341.0833; val_gene_expr_recon_loss: 7421446.3958; val_masked_gp_l1_reg_loss: 19008.6113; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15581664.7083; val_optim_loss: 15581664.7083
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9388; val_auprc_score: 0.9867; val_best_acc_score: 0.9290; val_best_f1_score: 0.9588; train_kl_reg_loss: 36664.7376; train_edge_recon_loss: 7845945.0465; train_gene_expr_recon_loss: 7404047.3488; train_masked_gp_l1_reg_loss: 18868.2652; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15305525.3209; train_optim_loss: 15305525.3209; val_kl_reg_loss: 16637.7798; val_edge_recon_loss: 8174269.9375; val_gene_expr_recon_loss: 7422366.3958; val_masked_gp_l1_reg_loss: 18712.3066; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15631986.0417; val_optim_loss: 15631986.0417

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9451; val_auprc_score: 0.9882; val_best_acc_score: 0.9338; val_best_f1_score: 0.9618; train_kl_reg_loss: 35752.0549; train_edge_recon_loss: 7835210.6558; train_gene_expr_recon_loss: 7371913.4558; train_masked_gp_l1_reg_loss: 18692.1379; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15261568.3256; train_optim_loss: 15261568.3256; val_kl_reg_loss: 16562.8735; val_edge_recon_loss: 7784377.5417; val_gene_expr_recon_loss: 7368665.3542; val_masked_gp_l1_reg_loss: 18680.9199; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15188286.7917; val_optim_loss: 15188286.7917
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9404; val_auprc_score: 0.9859; val_best_acc_score: 0.9326; val_best_f1_score: 0.9610; train_kl_reg_loss: 35156.6277; train_edge_recon_loss: 7779705.7814; train_gene_expr_recon_loss: 7362937.3837; train_masked_gp_l1_reg_loss: 18667.6199; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15196467.3395; train_optim_loss: 15196467.3395; val_kl_reg_loss: 16413.3753; val_edge_recon_loss: 8083711.1042; val_gene_expr_recon_loss: 7353186.3958; val_masked_gp_l1_reg_loss: 18653.0508; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15471964.0000; val_optim_loss: 15471964.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9444; val_auprc_score: 0.9878; val_best_acc_score: 0.9348; val_best_f1_score: 0.9624; train_kl_reg_loss: 34602.1110; train_edge_recon_loss: 7775165.6953; train_gene_expr_recon_loss: 7358435.5512; train_masked_gp_l1_reg_loss: 18636.1564; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15186839.4744; train_optim_loss: 15186839.4744; val_kl_reg_loss: 15936.3231; val_edge_recon_loss: 7646785.8542; val_gene_expr_recon_loss: 7346776.0625; val_masked_gp_l1_reg_loss: 18620.5117; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15028119.3750; val_optim_loss: 15028119.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9405; val_auprc_score: 0.9868; val_best_acc_score: 0.9357; val_best_f1_score: 0.9628; train_kl_reg_loss: 34442.6235; train_edge_recon_loss: 7759660.2302; train_gene_expr_recon_loss: 7354855.3767; train_masked_gp_l1_reg_loss: 18598.8928; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15167557.1349; train_optim_loss: 15167557.1349; val_kl_reg_loss: 15797.1012; val_edge_recon_loss: 7846980.1667; val_gene_expr_recon_loss: 7341382.7292; val_masked_gp_l1_reg_loss: 18580.2227; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15222740.1250; val_optim_loss: 15222740.1250
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9453; val_auprc_score: 0.9876; val_best_acc_score: 0.9384; val_best_f1_score: 0.9644; train_kl_reg_loss: 33597.2586; train_edge_recon_loss: 7861546.3744; train_gene_expr_recon_loss: 7350316.4977; train_masked_gp_l1_reg_loss: 18563.1481; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15264023.2558; train_optim_loss: 15264023.2558; val_kl_reg_loss: 15665.6178; val_edge_recon_loss: 7801180.5208; val_gene_expr_recon_loss: 7341994.3333; val_masked_gp_l1_reg_loss: 18545.9102; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15177386.5000; val_optim_loss: 15177386.5000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9479; val_auprc_score: 0.9883; val_best_acc_score: 0.9363; val_best_f1_score: 0.9629; train_kl_reg_loss: 33395.0001; train_edge_recon_loss: 7781508.5791; train_gene_expr_recon_loss: 7345406.4884; train_masked_gp_l1_reg_loss: 18523.6359; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15178833.7023; train_optim_loss: 15178833.7023; val_kl_reg_loss: 15844.0454; val_edge_recon_loss: 8234004.1250; val_gene_expr_recon_loss: 7334747.2083; val_masked_gp_l1_reg_loss: 18502.4180; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15603097.2917; val_optim_loss: 15603097.2917
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9466; val_auprc_score: 0.9886; val_best_acc_score: 0.9365; val_best_f1_score: 0.9634; train_kl_reg_loss: 32970.6049; train_edge_recon_loss: 7770753.8233; train_gene_expr_recon_loss: 7338209.2791; train_masked_gp_l1_reg_loss: 18476.7785; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15160410.5302; train_optim_loss: 15160410.5302; val_kl_reg_loss: 15600.5288; val_edge_recon_loss: 7919088.7500; val_gene_expr_recon_loss: 7330746.2083; val_masked_gp_l1_reg_loss: 18454.4453; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15283889.5417; val_optim_loss: 15283889.5417

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9448; val_auprc_score: 0.9882; val_best_acc_score: 0.9358; val_best_f1_score: 0.9630; train_kl_reg_loss: 32575.0565; train_edge_recon_loss: 7693725.2395; train_gene_expr_recon_loss: 7332475.7767; train_masked_gp_l1_reg_loss: 18450.9863; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15077227.0884; train_optim_loss: 15077227.0884; val_kl_reg_loss: 15619.7465; val_edge_recon_loss: 7857929.9375; val_gene_expr_recon_loss: 7327901.4167; val_masked_gp_l1_reg_loss: 18448.0176; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15219899.1250; val_optim_loss: 15219899.1250
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9457; val_auprc_score: 0.9866; val_best_acc_score: 0.9375; val_best_f1_score: 0.9638; train_kl_reg_loss: 32539.7711; train_edge_recon_loss: 7688579.8651; train_gene_expr_recon_loss: 7331824.5814; train_masked_gp_l1_reg_loss: 18445.3006; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15071389.5209; train_optim_loss: 15071389.5209; val_kl_reg_loss: 15603.6337; val_edge_recon_loss: 8088509.7917; val_gene_expr_recon_loss: 7327514.8542; val_masked_gp_l1_reg_loss: 18442.3730; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15450070.3750; val_optim_loss: 15450070.3750
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9465; val_auprc_score: 0.9887; val_best_acc_score: 0.9355; val_best_f1_score: 0.9627; train_kl_reg_loss: 32493.8338; train_edge_recon_loss: 7746155.9093; train_gene_expr_recon_loss: 7330274.4186; train_masked_gp_l1_reg_loss: 18439.0914; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15127363.2326; train_optim_loss: 15127363.2326; val_kl_reg_loss: 15657.1104; val_edge_recon_loss: 7927160.6042; val_gene_expr_recon_loss: 7332608.6667; val_masked_gp_l1_reg_loss: 18435.5195; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15293862.4583; val_optim_loss: 15293862.4583
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9435; val_auprc_score: 0.9867; val_best_acc_score: 0.9363; val_best_f1_score: 0.9631; train_kl_reg_loss: 32494.2505; train_edge_recon_loss: 7693847.3488; train_gene_expr_recon_loss: 7330999.1674; train_masked_gp_l1_reg_loss: 18432.1150; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15075772.9395; train_optim_loss: 15075772.9395; val_kl_reg_loss: 15629.3087; val_edge_recon_loss: 8136298.0000; val_gene_expr_recon_loss: 7322528.4375; val_masked_gp_l1_reg_loss: 18428.6367; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15492884.7500; val_optim_loss: 15492884.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 48 min 29 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9439
Val AUPRC score: 0.9877
Val best accuracy score: 0.9340
Val best F1 score: 0.9619
Val gene expr MSE score: 128694.6547
Val cat covariate0 mean sim diff: -0.0012

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
