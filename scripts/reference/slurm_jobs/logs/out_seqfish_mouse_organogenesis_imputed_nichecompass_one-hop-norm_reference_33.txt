[True]
Run timestamp: 01082023_073133_33.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_33']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9115; val_auprc_score: 0.9819; val_best_acc_score: 0.8507; val_best_f1_score: 0.9194; train_kl_reg_loss: 116825.1658; train_edge_recon_loss: 11703.0208; train_gene_expr_recon_loss: 52917501.0370; train_masked_gp_l1_reg_loss: 7185.4067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59084.3975; train_global_loss: 53112298.6667; train_optim_loss: 53112298.6667; val_kl_reg_loss: 222823.5286; val_edge_recon_loss: 12130.8452; val_gene_expr_recon_loss: 39955960.6667; val_masked_gp_l1_reg_loss: 7776.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54840.4648; val_global_loss: 40253531.3333; val_optim_loss: 40253531.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8957; val_auprc_score: 0.9791; val_best_acc_score: 0.8506; val_best_f1_score: 0.9193; train_kl_reg_loss: 253232.0428; train_edge_recon_loss: 11935.0476; train_gene_expr_recon_loss: 36989626.5926; train_masked_gp_l1_reg_loss: 7805.2618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51476.5875; train_global_loss: 37314075.1852; train_optim_loss: 37314075.1852; val_kl_reg_loss: 251802.6953; val_edge_recon_loss: 12151.2821; val_gene_expr_recon_loss: 33032322.3333; val_masked_gp_l1_reg_loss: 7784.0586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48276.1250; val_global_loss: 33352336.0000; val_optim_loss: 33352336.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8752; val_auprc_score: 0.9753; val_best_acc_score: 0.8516; val_best_f1_score: 0.9199; train_kl_reg_loss: 252440.0961; train_edge_recon_loss: 11925.4281; train_gene_expr_recon_loss: 28674076.0000; train_masked_gp_l1_reg_loss: 7739.9950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45683.3043; train_global_loss: 28991864.8889; train_optim_loss: 28991864.8889; val_kl_reg_loss: 232272.4089; val_edge_recon_loss: 12054.6602; val_gene_expr_recon_loss: 25113403.3333; val_masked_gp_l1_reg_loss: 7700.1519; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43227.0898; val_global_loss: 25408658.6667; val_optim_loss: 25408658.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8548; val_auprc_score: 0.9701; val_best_acc_score: 0.8547; val_best_f1_score: 0.9213; train_kl_reg_loss: 226890.3411; train_edge_recon_loss: 11854.1024; train_gene_expr_recon_loss: 23648227.0370; train_masked_gp_l1_reg_loss: 7683.8257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41323.3308; train_global_loss: 23935978.4074; train_optim_loss: 23935978.4074; val_kl_reg_loss: 204141.6172; val_edge_recon_loss: 12100.3564; val_gene_expr_recon_loss: 22835039.6667; val_masked_gp_l1_reg_loss: 7677.3223; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39594.7812; val_global_loss: 23098553.6667; val_optim_loss: 23098553.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8522; val_auprc_score: 0.9691; val_best_acc_score: 0.8698; val_best_f1_score: 0.9286; train_kl_reg_loss: 198208.7399; train_edge_recon_loss: 11801.3522; train_gene_expr_recon_loss: 22465597.9259; train_masked_gp_l1_reg_loss: 7681.6058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38417.1265; train_global_loss: 22721706.7778; train_optim_loss: 22721706.7778; val_kl_reg_loss: 178002.7214; val_edge_recon_loss: 12126.7677; val_gene_expr_recon_loss: 22261442.6667; val_masked_gp_l1_reg_loss: 7688.9170; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37457.7031; val_global_loss: 22496718.0000; val_optim_loss: 22496718.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8524; val_auprc_score: 0.9684; val_best_acc_score: 0.8766; val_best_f1_score: 0.9307; train_kl_reg_loss: 174918.1953; train_edge_recon_loss: 11844.2133; train_gene_expr_recon_loss: 22046254.1111; train_masked_gp_l1_reg_loss: 7703.0574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37040.4862; train_global_loss: 22277760.1852; train_optim_loss: 22277760.1852; val_kl_reg_loss: 159459.8490; val_edge_recon_loss: 12021.0474; val_gene_expr_recon_loss: 21958961.3333; val_masked_gp_l1_reg_loss: 7721.4863; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36845.2539; val_global_loss: 22175010.0000; val_optim_loss: 22175010.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8607; val_auprc_score: 0.9712; val_best_acc_score: 0.8737; val_best_f1_score: 0.9312; train_kl_reg_loss: 158314.7520; train_edge_recon_loss: 11868.5911; train_gene_expr_recon_loss: 21763964.5556; train_masked_gp_l1_reg_loss: 7747.0662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36813.4576; train_global_loss: 21978708.7037; train_optim_loss: 21978708.7037; val_kl_reg_loss: 145656.9766; val_edge_recon_loss: 11722.5563; val_gene_expr_recon_loss: 21674279.6667; val_masked_gp_l1_reg_loss: 7782.8784; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36788.2891; val_global_loss: 21876229.0000; val_optim_loss: 21876229.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8680; val_auprc_score: 0.9727; val_best_acc_score: 0.8785; val_best_f1_score: 0.9333; train_kl_reg_loss: 145784.3860; train_edge_recon_loss: 11985.1021; train_gene_expr_recon_loss: 21530023.4074; train_masked_gp_l1_reg_loss: 7819.6823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36766.5430; train_global_loss: 21732379.2222; train_optim_loss: 21732379.2222; val_kl_reg_loss: 135679.0495; val_edge_recon_loss: 11716.8278; val_gene_expr_recon_loss: 21429244.6667; val_masked_gp_l1_reg_loss: 7858.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36743.6680; val_global_loss: 21621242.3333; val_optim_loss: 21621242.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8551; val_auprc_score: 0.9685; val_best_acc_score: 0.8743; val_best_f1_score: 0.9304; train_kl_reg_loss: 135990.7347; train_edge_recon_loss: 11792.3611; train_gene_expr_recon_loss: 21311332.0000; train_masked_gp_l1_reg_loss: 7890.5860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36722.5265; train_global_loss: 21503728.4444; train_optim_loss: 21503728.4444; val_kl_reg_loss: 126368.1693; val_edge_recon_loss: 11761.5101; val_gene_expr_recon_loss: 21301426.6667; val_masked_gp_l1_reg_loss: 7922.6162; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36699.9961; val_global_loss: 21484178.3333; val_optim_loss: 21484178.3333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8760; val_auprc_score: 0.9751; val_best_acc_score: 0.8810; val_best_f1_score: 0.9344; train_kl_reg_loss: 127776.7944; train_edge_recon_loss: 11766.5384; train_gene_expr_recon_loss: 21127297.6667; train_masked_gp_l1_reg_loss: 7950.8670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36676.7061; train_global_loss: 21311468.5926; train_optim_loss: 21311468.5926; val_kl_reg_loss: 119072.4596; val_edge_recon_loss: 11311.7541; val_gene_expr_recon_loss: 21048913.3333; val_masked_gp_l1_reg_loss: 7980.2905; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36652.3984; val_global_loss: 21223929.6667; val_optim_loss: 21223929.6667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8781; val_auprc_score: 0.9733; val_best_acc_score: 0.8773; val_best_f1_score: 0.9308; train_kl_reg_loss: 120959.5544; train_edge_recon_loss: 11742.1309; train_gene_expr_recon_loss: 20946093.9630; train_masked_gp_l1_reg_loss: 8007.7561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36627.8152; train_global_loss: 21123431.3704; train_optim_loss: 21123431.3704; val_kl_reg_loss: 113620.5573; val_edge_recon_loss: 11942.0666; val_gene_expr_recon_loss: 20859909.6667; val_masked_gp_l1_reg_loss: 8037.2373; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36602.1914; val_global_loss: 21030112.3333; val_optim_loss: 21030112.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8809; val_auprc_score: 0.9743; val_best_acc_score: 0.8794; val_best_f1_score: 0.9315; train_kl_reg_loss: 115043.9554; train_edge_recon_loss: 11755.8485; train_gene_expr_recon_loss: 20779650.6296; train_masked_gp_l1_reg_loss: 8066.5689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36576.0845; train_global_loss: 20951093.0370; train_optim_loss: 20951093.0370; val_kl_reg_loss: 108532.3307; val_edge_recon_loss: 11954.7734; val_gene_expr_recon_loss: 20724531.6667; val_masked_gp_l1_reg_loss: 8099.0308; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36549.1133; val_global_loss: 20889668.6667; val_optim_loss: 20889668.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8881; val_auprc_score: 0.9752; val_best_acc_score: 0.8819; val_best_f1_score: 0.9323; train_kl_reg_loss: 109803.0770; train_edge_recon_loss: 11633.3091; train_gene_expr_recon_loss: 20629685.7407; train_masked_gp_l1_reg_loss: 8129.0978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36522.0766; train_global_loss: 20795773.3704; train_optim_loss: 20795773.3704; val_kl_reg_loss: 103693.3581; val_edge_recon_loss: 12114.4572; val_gene_expr_recon_loss: 20556002.6667; val_masked_gp_l1_reg_loss: 8165.6729; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36493.3867; val_global_loss: 20716470.0000; val_optim_loss: 20716470.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8841; val_auprc_score: 0.9752; val_best_acc_score: 0.8863; val_best_f1_score: 0.9347; train_kl_reg_loss: 105157.7572; train_edge_recon_loss: 11741.7811; train_gene_expr_recon_loss: 20488725.7037; train_masked_gp_l1_reg_loss: 8194.6392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36465.9692; train_global_loss: 20650286.0370; train_optim_loss: 20650286.0370; val_kl_reg_loss: 99165.8346; val_edge_recon_loss: 11620.0975; val_gene_expr_recon_loss: 20463632.6667; val_masked_gp_l1_reg_loss: 8230.7363; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36436.4688; val_global_loss: 20619084.6667; val_optim_loss: 20619084.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8950; val_auprc_score: 0.9781; val_best_acc_score: 0.8896; val_best_f1_score: 0.9361; train_kl_reg_loss: 100881.3161; train_edge_recon_loss: 11718.0313; train_gene_expr_recon_loss: 20348262.6296; train_masked_gp_l1_reg_loss: 8263.0719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36408.3407; train_global_loss: 20505533.5185; train_optim_loss: 20505533.5185; val_kl_reg_loss: 95627.0807; val_edge_recon_loss: 11754.9954; val_gene_expr_recon_loss: 20317870.0000; val_masked_gp_l1_reg_loss: 8300.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36378.3984; val_global_loss: 20469930.0000; val_optim_loss: 20469930.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8933; val_auprc_score: 0.9775; val_best_acc_score: 0.8884; val_best_f1_score: 0.9353; train_kl_reg_loss: 97152.7514; train_edge_recon_loss: 11639.1041; train_gene_expr_recon_loss: 20219634.2963; train_masked_gp_l1_reg_loss: 8333.4563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36348.5256; train_global_loss: 20373108.2593; train_optim_loss: 20373108.2593; val_kl_reg_loss: 91712.3958; val_edge_recon_loss: 11591.6182; val_gene_expr_recon_loss: 20157751.6667; val_masked_gp_l1_reg_loss: 8367.4785; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36316.7812; val_global_loss: 20305739.6667; val_optim_loss: 20305739.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8985; val_auprc_score: 0.9775; val_best_acc_score: 0.8894; val_best_f1_score: 0.9351; train_kl_reg_loss: 93679.9977; train_edge_recon_loss: 11637.7688; train_gene_expr_recon_loss: 20088691.7778; train_masked_gp_l1_reg_loss: 8404.2390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36285.5940; train_global_loss: 20238699.2963; train_optim_loss: 20238699.2963; val_kl_reg_loss: 88849.2005; val_edge_recon_loss: 12041.1445; val_gene_expr_recon_loss: 20057047.0000; val_masked_gp_l1_reg_loss: 8440.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36253.5000; val_global_loss: 20202631.3333; val_optim_loss: 20202631.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8985; val_auprc_score: 0.9799; val_best_acc_score: 0.8898; val_best_f1_score: 0.9379; train_kl_reg_loss: 90559.5793; train_edge_recon_loss: 11726.9496; train_gene_expr_recon_loss: 19964640.7407; train_masked_gp_l1_reg_loss: 8474.4823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36221.9102; train_global_loss: 20111623.7037; train_optim_loss: 20111623.7037; val_kl_reg_loss: 86264.7305; val_edge_recon_loss: 11374.8587; val_gene_expr_recon_loss: 19960443.0000; val_masked_gp_l1_reg_loss: 8508.9248; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36189.9062; val_global_loss: 20102780.6667; val_optim_loss: 20102780.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8978; val_auprc_score: 0.9775; val_best_acc_score: 0.8882; val_best_f1_score: 0.9353; train_kl_reg_loss: 87733.5825; train_edge_recon_loss: 11665.1266; train_gene_expr_recon_loss: 19838953.8889; train_masked_gp_l1_reg_loss: 8542.3855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36158.1053; train_global_loss: 19983053.0370; train_optim_loss: 19983053.0370; val_kl_reg_loss: 83187.8125; val_edge_recon_loss: 11828.5737; val_gene_expr_recon_loss: 19806418.6667; val_masked_gp_l1_reg_loss: 8575.7529; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36126.1758; val_global_loss: 19946137.0000; val_optim_loss: 19946137.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9043; val_auprc_score: 0.9800; val_best_acc_score: 0.8944; val_best_f1_score: 0.9402; train_kl_reg_loss: 85124.8014; train_edge_recon_loss: 11569.7300; train_gene_expr_recon_loss: 19724583.5926; train_masked_gp_l1_reg_loss: 8608.9183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36095.8285; train_global_loss: 19865983.0000; train_optim_loss: 19865983.0000; val_kl_reg_loss: 80780.2839; val_edge_recon_loss: 11266.2386; val_gene_expr_recon_loss: 19714167.3333; val_masked_gp_l1_reg_loss: 8640.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36064.2539; val_global_loss: 19850918.0000; val_optim_loss: 19850918.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9056; val_auprc_score: 0.9796; val_best_acc_score: 0.8921; val_best_f1_score: 0.9383; train_kl_reg_loss: 82721.6013; train_edge_recon_loss: 11589.5008; train_gene_expr_recon_loss: 19606518.8148; train_masked_gp_l1_reg_loss: 8670.8662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36035.4345; train_global_loss: 19745536.1852; train_optim_loss: 19745536.1852; val_kl_reg_loss: 78638.8633; val_edge_recon_loss: 11911.0187; val_gene_expr_recon_loss: 19584757.3333; val_masked_gp_l1_reg_loss: 8701.0410; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36005.9805; val_global_loss: 19720015.3333; val_optim_loss: 19720015.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9080; val_auprc_score: 0.9807; val_best_acc_score: 0.8961; val_best_f1_score: 0.9407; train_kl_reg_loss: 80631.8002; train_edge_recon_loss: 11708.8301; train_gene_expr_recon_loss: 19485275.1852; train_masked_gp_l1_reg_loss: 8731.9871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35981.0865; train_global_loss: 19622328.8519; train_optim_loss: 19622328.8519; val_kl_reg_loss: 76956.3112; val_edge_recon_loss: 11595.2415; val_gene_expr_recon_loss: 19449357.6667; val_masked_gp_l1_reg_loss: 8763.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35955.8594; val_global_loss: 19582629.6667; val_optim_loss: 19582629.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9146; val_auprc_score: 0.9825; val_best_acc_score: 0.9034; val_best_f1_score: 0.9447; train_kl_reg_loss: 78538.6413; train_edge_recon_loss: 11557.4175; train_gene_expr_recon_loss: 19370800.8889; train_masked_gp_l1_reg_loss: 8793.8608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35933.4870; train_global_loss: 19505624.6296; train_optim_loss: 19505624.6296; val_kl_reg_loss: 74516.6966; val_edge_recon_loss: 11338.5199; val_gene_expr_recon_loss: 19329819.0000; val_masked_gp_l1_reg_loss: 8828.3916; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35911.2188; val_global_loss: 19460414.3333; val_optim_loss: 19460414.3333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9107; val_auprc_score: 0.9809; val_best_acc_score: 0.9021; val_best_f1_score: 0.9438; train_kl_reg_loss: 76667.7905; train_edge_recon_loss: 11568.7419; train_gene_expr_recon_loss: 19257428.8519; train_masked_gp_l1_reg_loss: 8856.0312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35892.0092; train_global_loss: 19390413.5556; train_optim_loss: 19390413.5556; val_kl_reg_loss: 73067.3841; val_edge_recon_loss: 11403.9339; val_gene_expr_recon_loss: 19234065.0000; val_masked_gp_l1_reg_loss: 8887.4131; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35873.2852; val_global_loss: 19363298.3333; val_optim_loss: 19363298.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9126; val_auprc_score: 0.9811; val_best_acc_score: 0.8985; val_best_f1_score: 0.9414; train_kl_reg_loss: 74851.4492; train_edge_recon_loss: 11512.7607; train_gene_expr_recon_loss: 19146600.3333; train_masked_gp_l1_reg_loss: 8920.2690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35856.8145; train_global_loss: 19277741.6667; train_optim_loss: 19277741.6667; val_kl_reg_loss: 71394.9883; val_edge_recon_loss: 11822.8138; val_gene_expr_recon_loss: 19116917.6667; val_masked_gp_l1_reg_loss: 8953.9551; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35840.7266; val_global_loss: 19244929.3333; val_optim_loss: 19244929.3333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8855; val_auprc_score: 0.9756; val_best_acc_score: 0.8790; val_best_f1_score: 0.9318; train_kl_reg_loss: 48349.3919; train_edge_recon_loss: 11780.4763; train_gene_expr_recon_loss: 33564043.5185; train_masked_gp_l1_reg_loss: 10059.9377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35503.6469; train_global_loss: 33669737.1481; train_optim_loss: 33669737.1481; val_kl_reg_loss: 56814.2018; val_edge_recon_loss: 11761.3374; val_gene_expr_recon_loss: 33679521.3333; val_masked_gp_l1_reg_loss: 10762.7363; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35374.5312; val_global_loss: 33794237.0000; val_optim_loss: 33794237.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8921; val_auprc_score: 0.9780; val_best_acc_score: 0.8899; val_best_f1_score: 0.9366; train_kl_reg_loss: 68239.1874; train_edge_recon_loss: 11629.8850; train_gene_expr_recon_loss: 31160769.4074; train_masked_gp_l1_reg_loss: 10712.8221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35340.2386; train_global_loss: 31286691.6296; train_optim_loss: 31286691.6296; val_kl_reg_loss: 68656.9219; val_edge_recon_loss: 11472.2995; val_gene_expr_recon_loss: 28623922.6667; val_masked_gp_l1_reg_loss: 10650.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35303.9141; val_global_loss: 28750006.0000; val_optim_loss: 28750006.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8991; val_auprc_score: 0.9781; val_best_acc_score: 0.8924; val_best_f1_score: 0.9371; train_kl_reg_loss: 71241.8649; train_edge_recon_loss: 11638.7181; train_gene_expr_recon_loss: 26843589.0000; train_masked_gp_l1_reg_loss: 10607.7167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35268.3325; train_global_loss: 26972345.4815; train_optim_loss: 26972345.4815; val_kl_reg_loss: 67583.7422; val_edge_recon_loss: 11951.4468; val_gene_expr_recon_loss: 25179949.3333; val_masked_gp_l1_reg_loss: 10567.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35230.9805; val_global_loss: 25305283.0000; val_optim_loss: 25305283.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9027; val_auprc_score: 0.9797; val_best_acc_score: 0.8937; val_best_f1_score: 0.9395; train_kl_reg_loss: 68822.1506; train_edge_recon_loss: 11660.2472; train_gene_expr_recon_loss: 24063862.1111; train_masked_gp_l1_reg_loss: 10534.8862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35194.0166; train_global_loss: 24190073.5556; train_optim_loss: 24190073.5556; val_kl_reg_loss: 64101.4818; val_edge_recon_loss: 11665.4053; val_gene_expr_recon_loss: 23048518.3333; val_masked_gp_l1_reg_loss: 10503.3555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35155.2695; val_global_loss: 23169945.3333; val_optim_loss: 23169945.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9080; val_auprc_score: 0.9807; val_best_acc_score: 0.8939; val_best_f1_score: 0.9395; train_kl_reg_loss: 66610.3932; train_edge_recon_loss: 11742.0125; train_gene_expr_recon_loss: 22986269.7037; train_masked_gp_l1_reg_loss: 10495.2794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35135.6325; train_global_loss: 23110253.0741; train_optim_loss: 23110253.0741; val_kl_reg_loss: 63784.2682; val_edge_recon_loss: 11809.1624; val_gene_expr_recon_loss: 22934815.6667; val_masked_gp_l1_reg_loss: 10490.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35128.3164; val_global_loss: 23056027.3333; val_optim_loss: 23056027.3333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9085; val_auprc_score: 0.9814; val_best_acc_score: 0.8977; val_best_f1_score: 0.9418; train_kl_reg_loss: 66230.8375; train_edge_recon_loss: 11580.4195; train_gene_expr_recon_loss: 22847039.1481; train_masked_gp_l1_reg_loss: 10486.9981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35124.2565; train_global_loss: 22970461.6296; train_optim_loss: 22970461.6296; val_kl_reg_loss: 63313.5729; val_edge_recon_loss: 11385.9271; val_gene_expr_recon_loss: 22768870.3333; val_masked_gp_l1_reg_loss: 10484.4043; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35120.0820; val_global_loss: 22889174.0000; val_optim_loss: 22889174.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9039; val_auprc_score: 0.9807; val_best_acc_score: 0.8969; val_best_f1_score: 0.9413; train_kl_reg_loss: 65831.5778; train_edge_recon_loss: 11459.8808; train_gene_expr_recon_loss: 22711243.3704; train_masked_gp_l1_reg_loss: 10481.6583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35116.0272; train_global_loss: 22834132.5926; train_optim_loss: 22834132.5926; val_kl_reg_loss: 63073.6595; val_edge_recon_loss: 11468.9224; val_gene_expr_recon_loss: 22643828.3333; val_masked_gp_l1_reg_loss: 10479.4189; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35111.8008; val_global_loss: 22763962.6667; val_optim_loss: 22763962.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9030; val_auprc_score: 0.9801; val_best_acc_score: 0.8967; val_best_f1_score: 0.9412; train_kl_reg_loss: 65463.3225; train_edge_recon_loss: 11593.2647; train_gene_expr_recon_loss: 22595499.1852; train_masked_gp_l1_reg_loss: 10476.0669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35107.5501; train_global_loss: 22718139.5185; train_optim_loss: 22718139.5185; val_kl_reg_loss: 62709.5514; val_edge_recon_loss: 11473.1571; val_gene_expr_recon_loss: 22526273.0000; val_masked_gp_l1_reg_loss: 10473.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35103.0781; val_global_loss: 22646034.0000; val_optim_loss: 22646034.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 59 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9080
val AUPRC score: 0.9799
val best accuracy score: 0.8990
val best F1 score: 0.9419
val target rna MSE score: 4.4603
val source rna MSE score: 5.4055
Val cat covariate0 mean sim diff: -0.0012

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
