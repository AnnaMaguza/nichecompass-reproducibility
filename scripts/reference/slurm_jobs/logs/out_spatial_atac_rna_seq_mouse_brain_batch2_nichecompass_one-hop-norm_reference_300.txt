[True]
Run timestamp: 07092023_074754_300.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '4000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_300']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2863 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 6459, n_cat_covariates_embed_input: 0, n_hidden: 2392, n_latent: 2292, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3596
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2863
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2292, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2863

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6585; val_auprc_score: 0.6352; val_best_acc_score: 0.5024; val_best_f1_score: 0.6677; train_kl_reg_loss: 54911.4230; train_edge_recon_loss: 3556630.0000; train_gene_expr_recon_loss: 14700312.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1113050.7472; train_chrom_access_recon_loss: 12526432.1061; train_global_loss: 31951336.0606; train_optim_loss: 31951336.0606; val_kl_reg_loss: 65120.8662; val_edge_recon_loss: 4065347.0000; val_gene_expr_recon_loss: 13480806.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 834760.8125; val_chrom_access_recon_loss: 12022875.0000; val_global_loss: 30468909.7500; val_optim_loss: 30468909.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7229; val_auprc_score: 0.7026; val_best_acc_score: 0.5774; val_best_f1_score: 0.6953; train_kl_reg_loss: 108954.6436; train_edge_recon_loss: 3532333.5644; train_gene_expr_recon_loss: 13167121.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 602470.6577; train_chrom_access_recon_loss: 11865684.5152; train_global_loss: 29276565.3333; train_optim_loss: 29276565.3333; val_kl_reg_loss: 118595.8223; val_edge_recon_loss: 4060571.5938; val_gene_expr_recon_loss: 13026337.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 409926.2812; val_chrom_access_recon_loss: 11718985.5000; val_global_loss: 29334416.5000; val_optim_loss: 29334416.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7611; val_auprc_score: 0.7374; val_best_acc_score: 0.6867; val_best_f1_score: 0.7243; train_kl_reg_loss: 101020.8705; train_edge_recon_loss: 3524011.7917; train_gene_expr_recon_loss: 12980429.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 303459.8279; train_chrom_access_recon_loss: 11751269.3636; train_global_loss: 28660191.0606; train_optim_loss: 28660191.0606; val_kl_reg_loss: 91214.6963; val_edge_recon_loss: 4045447.1562; val_gene_expr_recon_loss: 12857502.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 221797.2188; val_chrom_access_recon_loss: 11605092.3750; val_global_loss: 28821054.2500; val_optim_loss: 28821054.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8226; val_auprc_score: 0.8034; val_best_acc_score: 0.7055; val_best_f1_score: 0.7439; train_kl_reg_loss: 89419.9297; train_edge_recon_loss: 3509208.8144; train_gene_expr_recon_loss: 12862818.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 177353.7306; train_chrom_access_recon_loss: 11668290.5455; train_global_loss: 28307091.3030; train_optim_loss: 28307091.3030; val_kl_reg_loss: 80820.0459; val_edge_recon_loss: 3972114.6250; val_gene_expr_recon_loss: 12747674.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142457.0781; val_chrom_access_recon_loss: 11474696.1250; val_global_loss: 28417763.0000; val_optim_loss: 28417763.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8590; val_auprc_score: 0.8342; val_best_acc_score: 0.7816; val_best_f1_score: 0.7974; train_kl_reg_loss: 73294.5508; train_edge_recon_loss: 3452568.6856; train_gene_expr_recon_loss: 12776057.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121907.3040; train_chrom_access_recon_loss: 11597227.0152; train_global_loss: 28021054.5152; train_optim_loss: 28021054.5152; val_kl_reg_loss: 66470.2207; val_edge_recon_loss: 3527834.0938; val_gene_expr_recon_loss: 12772923.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104987.0625; val_chrom_access_recon_loss: 11512565.3750; val_global_loss: 27984779.7500; val_optim_loss: 27984779.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8584; val_auprc_score: 0.8251; val_best_acc_score: 0.7735; val_best_f1_score: 0.8027; train_kl_reg_loss: 78498.9936; train_edge_recon_loss: 3111269.2273; train_gene_expr_recon_loss: 12711090.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94498.5601; train_chrom_access_recon_loss: 11533525.0455; train_global_loss: 27528882.4242; train_optim_loss: 27528882.4242; val_kl_reg_loss: 100331.7871; val_edge_recon_loss: 2962755.5312; val_gene_expr_recon_loss: 12711401.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84956.9922; val_chrom_access_recon_loss: 11402345.1250; val_global_loss: 27261790.5000; val_optim_loss: 27261790.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8759; val_auprc_score: 0.8451; val_best_acc_score: 0.7980; val_best_f1_score: 0.8170; train_kl_reg_loss: 100297.7770; train_edge_recon_loss: 2939841.4242; train_gene_expr_recon_loss: 12637712.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77576.1345; train_chrom_access_recon_loss: 11470376.7879; train_global_loss: 27225804.4545; train_optim_loss: 27225804.4545; val_kl_reg_loss: 94534.6455; val_edge_recon_loss: 2898943.0938; val_gene_expr_recon_loss: 12603508.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70937.1562; val_chrom_access_recon_loss: 11395371.6250; val_global_loss: 27063295.2500; val_optim_loss: 27063295.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8811; val_auprc_score: 0.8493; val_best_acc_score: 0.8135; val_best_f1_score: 0.8259; train_kl_reg_loss: 97388.1764; train_edge_recon_loss: 2883344.9091; train_gene_expr_recon_loss: 12560202.7576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66001.1156; train_chrom_access_recon_loss: 11407001.8182; train_global_loss: 27013938.8788; train_optim_loss: 27013938.8788; val_kl_reg_loss: 91042.6377; val_edge_recon_loss: 2922430.5625; val_gene_expr_recon_loss: 12453362.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61467.5898; val_chrom_access_recon_loss: 11346160.8750; val_global_loss: 26874464.7500; val_optim_loss: 26874464.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8959; val_auprc_score: 0.8599; val_best_acc_score: 0.8286; val_best_f1_score: 0.8421; train_kl_reg_loss: 96062.4238; train_edge_recon_loss: 2847520.0833; train_gene_expr_recon_loss: 12505867.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57805.0020; train_chrom_access_recon_loss: 11368531.5152; train_global_loss: 26875787.0303; train_optim_loss: 26875787.0303; val_kl_reg_loss: 95796.0527; val_edge_recon_loss: 2858125.6875; val_gene_expr_recon_loss: 12493848.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54878.6641; val_chrom_access_recon_loss: 11300499.0000; val_global_loss: 26803147.7500; val_optim_loss: 26803147.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9046; val_auprc_score: 0.8714; val_best_acc_score: 0.8461; val_best_f1_score: 0.8568; train_kl_reg_loss: 94361.5633; train_edge_recon_loss: 2828198.0303; train_gene_expr_recon_loss: 12452028.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52334.0756; train_chrom_access_recon_loss: 11317106.5606; train_global_loss: 26744028.6364; train_optim_loss: 26744028.6364; val_kl_reg_loss: 92696.6709; val_edge_recon_loss: 2853436.9062; val_gene_expr_recon_loss: 12491311.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49925.0078; val_chrom_access_recon_loss: 11249243.5000; val_global_loss: 26736613.5000; val_optim_loss: 26736613.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9074; val_auprc_score: 0.8688; val_best_acc_score: 0.8528; val_best_f1_score: 0.8647; train_kl_reg_loss: 94904.6509; train_edge_recon_loss: 2808895.6553; train_gene_expr_recon_loss: 12410457.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47871.2143; train_chrom_access_recon_loss: 11280641.9545; train_global_loss: 26642771.1515; train_optim_loss: 26642771.1515; val_kl_reg_loss: 90182.8213; val_edge_recon_loss: 2821768.4375; val_gene_expr_recon_loss: 12321981.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46258.9570; val_chrom_access_recon_loss: 11175188.2500; val_global_loss: 26455380.2500; val_optim_loss: 26455380.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9169; val_auprc_score: 0.8900; val_best_acc_score: 0.8560; val_best_f1_score: 0.8646; train_kl_reg_loss: 89326.6825; train_edge_recon_loss: 2807409.4735; train_gene_expr_recon_loss: 12356194.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44780.6174; train_chrom_access_recon_loss: 11231458.8333; train_global_loss: 26529169.9697; train_optim_loss: 26529169.9697; val_kl_reg_loss: 88742.9492; val_edge_recon_loss: 2821947.4688; val_gene_expr_recon_loss: 12338856.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43345.8086; val_chrom_access_recon_loss: 11176346.0000; val_global_loss: 26469238.7500; val_optim_loss: 26469238.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9211; val_auprc_score: 0.8986; val_best_acc_score: 0.8549; val_best_f1_score: 0.8658; train_kl_reg_loss: 90286.7064; train_edge_recon_loss: 2767803.3712; train_gene_expr_recon_loss: 12314405.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42164.9823; train_chrom_access_recon_loss: 11190648.6970; train_global_loss: 26405310.0303; train_optim_loss: 26405310.0303; val_kl_reg_loss: 89151.9365; val_edge_recon_loss: 2801488.6250; val_gene_expr_recon_loss: 12188615.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41087.0039; val_chrom_access_recon_loss: 11031820.3750; val_global_loss: 26152163.2500; val_optim_loss: 26152163.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9242; val_auprc_score: 0.8978; val_best_acc_score: 0.8641; val_best_f1_score: 0.8719; train_kl_reg_loss: 88050.9422; train_edge_recon_loss: 2767862.3447; train_gene_expr_recon_loss: 12266762.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40177.7672; train_chrom_access_recon_loss: 11148752.1212; train_global_loss: 26311605.4545; train_optim_loss: 26311605.4545; val_kl_reg_loss: 83794.5566; val_edge_recon_loss: 2814547.7500; val_gene_expr_recon_loss: 12259786.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39424.5469; val_chrom_access_recon_loss: 11059244.0000; val_global_loss: 26256798.0000; val_optim_loss: 26256798.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9196; val_auprc_score: 0.8808; val_best_acc_score: 0.8624; val_best_f1_score: 0.8734; train_kl_reg_loss: 86385.3723; train_edge_recon_loss: 2768016.4280; train_gene_expr_recon_loss: 12238383.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38566.5394; train_chrom_access_recon_loss: 11119826.4242; train_global_loss: 26251178.0000; train_optim_loss: 26251178.0000; val_kl_reg_loss: 86268.3252; val_edge_recon_loss: 2798990.6875; val_gene_expr_recon_loss: 12170142.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38089.3984; val_chrom_access_recon_loss: 11001006.7500; val_global_loss: 26094497.2500; val_optim_loss: 26094497.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9263; val_auprc_score: 0.9026; val_best_acc_score: 0.8641; val_best_f1_score: 0.8720; train_kl_reg_loss: 86268.5552; train_edge_recon_loss: 2746963.7273; train_gene_expr_recon_loss: 12202406.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37488.7704; train_chrom_access_recon_loss: 11086954.7273; train_global_loss: 26160082.3939; train_optim_loss: 26160082.3939; val_kl_reg_loss: 82291.3740; val_edge_recon_loss: 2791629.5312; val_gene_expr_recon_loss: 12083518.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37096.9727; val_chrom_access_recon_loss: 10977224.7500; val_global_loss: 25971761.0000; val_optim_loss: 25971761.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9300; val_auprc_score: 0.9070; val_best_acc_score: 0.8700; val_best_f1_score: 0.8779; train_kl_reg_loss: 84604.3147; train_edge_recon_loss: 2739031.3371; train_gene_expr_recon_loss: 12158846.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36569.4783; train_chrom_access_recon_loss: 11047908.2576; train_global_loss: 26066960.0303; train_optim_loss: 26066960.0303; val_kl_reg_loss: 81544.0967; val_edge_recon_loss: 2774807.2188; val_gene_expr_recon_loss: 12094222.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36202.4766; val_chrom_access_recon_loss: 11039339.7500; val_global_loss: 26026115.7500; val_optim_loss: 26026115.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9359; val_auprc_score: 0.9075; val_best_acc_score: 0.8794; val_best_f1_score: 0.8845; train_kl_reg_loss: 83768.8342; train_edge_recon_loss: 2745793.4394; train_gene_expr_recon_loss: 12132516.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35776.3591; train_chrom_access_recon_loss: 11017180.3182; train_global_loss: 26015035.2121; train_optim_loss: 26015035.2121; val_kl_reg_loss: 80940.0850; val_edge_recon_loss: 2725967.8750; val_gene_expr_recon_loss: 12045980.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35414.6992; val_chrom_access_recon_loss: 10951664.5000; val_global_loss: 25839968.5000; val_optim_loss: 25839968.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9391; val_auprc_score: 0.9164; val_best_acc_score: 0.8807; val_best_f1_score: 0.8891; train_kl_reg_loss: 81833.9470; train_edge_recon_loss: 2734394.2008; train_gene_expr_recon_loss: 12105153.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35191.3406; train_chrom_access_recon_loss: 10990769.9242; train_global_loss: 25947343.3333; train_optim_loss: 25947343.3333; val_kl_reg_loss: 81981.6719; val_edge_recon_loss: 2740206.2188; val_gene_expr_recon_loss: 12158182.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34946.0508; val_chrom_access_recon_loss: 10964964.3750; val_global_loss: 25980281.0000; val_optim_loss: 25980281.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9396; val_auprc_score: 0.9168; val_best_acc_score: 0.8783; val_best_f1_score: 0.8866; train_kl_reg_loss: 80506.7562; train_edge_recon_loss: 2728047.8485; train_gene_expr_recon_loss: 12059484.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34648.9506; train_chrom_access_recon_loss: 10952921.7576; train_global_loss: 25855609.4848; train_optim_loss: 25855609.4848; val_kl_reg_loss: 82491.6572; val_edge_recon_loss: 2763507.0625; val_gene_expr_recon_loss: 12036374.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34401.6484; val_chrom_access_recon_loss: 10903788.1250; val_global_loss: 25820564.0000; val_optim_loss: 25820564.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9433; val_auprc_score: 0.9204; val_best_acc_score: 0.8882; val_best_f1_score: 0.8937; train_kl_reg_loss: 81204.7763; train_edge_recon_loss: 2728271.3333; train_gene_expr_recon_loss: 12051625.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34179.4904; train_chrom_access_recon_loss: 10943324.7727; train_global_loss: 25838605.3939; train_optim_loss: 25838605.3939; val_kl_reg_loss: 81753.7314; val_edge_recon_loss: 2758386.8125; val_gene_expr_recon_loss: 11974336.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34092.1719; val_chrom_access_recon_loss: 10817438.3750; val_global_loss: 25666007.0000; val_optim_loss: 25666007.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9390; val_auprc_score: 0.9128; val_best_acc_score: 0.8821; val_best_f1_score: 0.8887; train_kl_reg_loss: 79180.0518; train_edge_recon_loss: 2708444.7045; train_gene_expr_recon_loss: 12017554.8485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33826.0024; train_chrom_access_recon_loss: 10904544.1212; train_global_loss: 25743549.9394; train_optim_loss: 25743549.9394; val_kl_reg_loss: 78718.7676; val_edge_recon_loss: 2758056.5938; val_gene_expr_recon_loss: 11946056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33632.3750; val_chrom_access_recon_loss: 10810828.5000; val_global_loss: 25627291.7500; val_optim_loss: 25627291.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9471; val_auprc_score: 0.9244; val_best_acc_score: 0.8952; val_best_f1_score: 0.8992; train_kl_reg_loss: 79040.6206; train_edge_recon_loss: 2713698.6932; train_gene_expr_recon_loss: 11984163.4242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33452.5006; train_chrom_access_recon_loss: 10863358.7727; train_global_loss: 25673713.8788; train_optim_loss: 25673713.8788; val_kl_reg_loss: 79017.8799; val_edge_recon_loss: 2724365.1875; val_gene_expr_recon_loss: 12037135.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33294.9414; val_chrom_access_recon_loss: 10770389.8750; val_global_loss: 25644203.2500; val_optim_loss: 25644203.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9498; val_auprc_score: 0.9310; val_best_acc_score: 0.8998; val_best_f1_score: 0.9051; train_kl_reg_loss: 76628.1713; train_edge_recon_loss: 2708505.4318; train_gene_expr_recon_loss: 11961779.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33169.7734; train_chrom_access_recon_loss: 10840028.7273; train_global_loss: 25620111.8485; train_optim_loss: 25620111.8485; val_kl_reg_loss: 74683.2334; val_edge_recon_loss: 2712500.8750; val_gene_expr_recon_loss: 11863854.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33049.8906; val_chrom_access_recon_loss: 10783741.0000; val_global_loss: 25467830.0000; val_optim_loss: 25467830.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9548; val_auprc_score: 0.9388; val_best_acc_score: 0.9049; val_best_f1_score: 0.9091; train_kl_reg_loss: 75516.6098; train_edge_recon_loss: 2706322.9432; train_gene_expr_recon_loss: 11937746.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32897.2736; train_chrom_access_recon_loss: 10817092.0303; train_global_loss: 25569575.9394; train_optim_loss: 25569575.9394; val_kl_reg_loss: 73604.5059; val_edge_recon_loss: 2683823.6250; val_gene_expr_recon_loss: 12030903.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32790.2539; val_chrom_access_recon_loss: 10765686.2500; val_global_loss: 25586807.2500; val_optim_loss: 25586807.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9362; val_auprc_score: 0.9144; val_best_acc_score: 0.8788; val_best_f1_score: 0.8852; train_kl_reg_loss: 82146.9223; train_edge_recon_loss: 2733795.6477; train_gene_expr_recon_loss: 11674466.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29180.7847; train_chrom_access_recon_loss: 10626627.2576; train_global_loss: 25146216.8182; train_optim_loss: 25146216.8182; val_kl_reg_loss: 51096.1050; val_edge_recon_loss: 2807838.5625; val_gene_expr_recon_loss: 11598452.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27774.5430; val_chrom_access_recon_loss: 10428982.0000; val_global_loss: 24914144.2500; val_optim_loss: 24914144.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9578; val_auprc_score: 0.9442; val_best_acc_score: 0.9052; val_best_f1_score: 0.9097; train_kl_reg_loss: 79550.8318; train_edge_recon_loss: 2728961.8598; train_gene_expr_recon_loss: 11605073.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27336.4053; train_chrom_access_recon_loss: 10536883.8636; train_global_loss: 24977806.9697; train_optim_loss: 24977806.9697; val_kl_reg_loss: 51976.4932; val_edge_recon_loss: 2708425.5938; val_gene_expr_recon_loss: 11635651.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27063.0684; val_chrom_access_recon_loss: 10517257.1250; val_global_loss: 24940373.5000; val_optim_loss: 24940373.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9540; val_auprc_score: 0.9361; val_best_acc_score: 0.8987; val_best_f1_score: 0.9033; train_kl_reg_loss: 76801.5864; train_edge_recon_loss: 2713246.5985; train_gene_expr_recon_loss: 11579595.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26809.7211; train_chrom_access_recon_loss: 10513599.8182; train_global_loss: 24910052.7273; train_optim_loss: 24910052.7273; val_kl_reg_loss: 54992.8115; val_edge_recon_loss: 2714582.5938; val_gene_expr_recon_loss: 11650376.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26674.0410; val_chrom_access_recon_loss: 10460995.5000; val_global_loss: 24907621.5000; val_optim_loss: 24907621.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9510; val_auprc_score: 0.9310; val_best_acc_score: 0.8976; val_best_f1_score: 0.9038; train_kl_reg_loss: 73062.9769; train_edge_recon_loss: 2713318.4053; train_gene_expr_recon_loss: 11556727.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26606.9976; train_chrom_access_recon_loss: 10488494.0758; train_global_loss: 24858210.0000; train_optim_loss: 24858210.0000; val_kl_reg_loss: 55530.6997; val_edge_recon_loss: 2748038.9688; val_gene_expr_recon_loss: 11494016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26452.6465; val_chrom_access_recon_loss: 10403054.2500; val_global_loss: 24727092.7500; val_optim_loss: 24727092.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9463; val_auprc_score: 0.9241; val_best_acc_score: 0.8976; val_best_f1_score: 0.9038; train_kl_reg_loss: 70975.4845; train_edge_recon_loss: 2701403.8902; train_gene_expr_recon_loss: 11540711.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26369.3499; train_chrom_access_recon_loss: 10470933.1970; train_global_loss: 24810393.1212; train_optim_loss: 24810393.1212; val_kl_reg_loss: 56215.4980; val_edge_recon_loss: 2728162.0625; val_gene_expr_recon_loss: 11476937.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26334.1562; val_chrom_access_recon_loss: 10337285.2500; val_global_loss: 24624934.0000; val_optim_loss: 24624934.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9517; val_auprc_score: 0.9299; val_best_acc_score: 0.9017; val_best_f1_score: 0.9067; train_kl_reg_loss: 68979.0121; train_edge_recon_loss: 2701609.6477; train_gene_expr_recon_loss: 11522895.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26292.2710; train_chrom_access_recon_loss: 10462953.6364; train_global_loss: 24782729.8788; train_optim_loss: 24782729.8788; val_kl_reg_loss: 56271.4077; val_edge_recon_loss: 2710203.1875; val_gene_expr_recon_loss: 11363642.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26219.3672; val_chrom_access_recon_loss: 10308696.3750; val_global_loss: 24465032.5000; val_optim_loss: 24465032.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9532; val_auprc_score: 0.9310; val_best_acc_score: 0.9030; val_best_f1_score: 0.9082; train_kl_reg_loss: 67871.4426; train_edge_recon_loss: 2692831.9508; train_gene_expr_recon_loss: 11503466.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26124.8956; train_chrom_access_recon_loss: 10438565.1212; train_global_loss: 24728859.5455; train_optim_loss: 24728859.5455; val_kl_reg_loss: 55619.9004; val_edge_recon_loss: 2695545.0625; val_gene_expr_recon_loss: 11591675.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26232.9043; val_chrom_access_recon_loss: 10431339.0000; val_global_loss: 24800412.2500; val_optim_loss: 24800412.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9517; val_auprc_score: 0.9263; val_best_acc_score: 0.8990; val_best_f1_score: 0.9029; train_kl_reg_loss: 66189.9876; train_edge_recon_loss: 2695729.5341; train_gene_expr_recon_loss: 11484956.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26123.4048; train_chrom_access_recon_loss: 10416187.1061; train_global_loss: 24689186.9394; train_optim_loss: 24689186.9394; val_kl_reg_loss: 55172.5283; val_edge_recon_loss: 2722497.0938; val_gene_expr_recon_loss: 11498447.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26082.5312; val_chrom_access_recon_loss: 10359811.3750; val_global_loss: 24662011.0000; val_optim_loss: 24662011.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9516; val_auprc_score: 0.9288; val_best_acc_score: 0.8992; val_best_f1_score: 0.9058; train_kl_reg_loss: 64638.4241; train_edge_recon_loss: 2678029.3485; train_gene_expr_recon_loss: 11478277.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26034.7064; train_chrom_access_recon_loss: 10403425.9394; train_global_loss: 24650406.1818; train_optim_loss: 24650406.1818; val_kl_reg_loss: 57296.8271; val_edge_recon_loss: 2710197.8750; val_gene_expr_recon_loss: 11387840.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25893.3223; val_chrom_access_recon_loss: 10319628.1250; val_global_loss: 24500856.0000; val_optim_loss: 24500856.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9572; val_auprc_score: 0.9420; val_best_acc_score: 0.9035; val_best_f1_score: 0.9075; train_kl_reg_loss: 64079.9970; train_edge_recon_loss: 2692662.4848; train_gene_expr_recon_loss: 11461813.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25905.5719; train_chrom_access_recon_loss: 10391351.2424; train_global_loss: 24635812.2424; train_optim_loss: 24635812.2424; val_kl_reg_loss: 56308.7739; val_edge_recon_loss: 2720453.5938; val_gene_expr_recon_loss: 11496917.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25849.9688; val_chrom_access_recon_loss: 10356877.1250; val_global_loss: 24656407.0000; val_optim_loss: 24656407.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9582; val_auprc_score: 0.9488; val_best_acc_score: 0.9038; val_best_f1_score: 0.9078; train_kl_reg_loss: 61906.2396; train_edge_recon_loss: 2690192.5379; train_gene_expr_recon_loss: 11433601.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23816.0063; train_chrom_access_recon_loss: 10372231.6515; train_global_loss: 24581747.5152; train_optim_loss: 24581747.5152; val_kl_reg_loss: 58283.3076; val_edge_recon_loss: 2722960.0938; val_gene_expr_recon_loss: 11569731.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23426.1484; val_chrom_access_recon_loss: 10428791.7500; val_global_loss: 24803192.7500; val_optim_loss: 24803192.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9536; val_auprc_score: 0.9347; val_best_acc_score: 0.9025; val_best_f1_score: 0.9067; train_kl_reg_loss: 63037.3675; train_edge_recon_loss: 2679183.9583; train_gene_expr_recon_loss: 11436677.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23387.9291; train_chrom_access_recon_loss: 10370736.2121; train_global_loss: 24573023.0000; train_optim_loss: 24573023.0000; val_kl_reg_loss: 58351.3125; val_edge_recon_loss: 2721855.5312; val_gene_expr_recon_loss: 11346941.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23357.7051; val_chrom_access_recon_loss: 10240258.6250; val_global_loss: 24390765.2500; val_optim_loss: 24390765.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9615; val_auprc_score: 0.9491; val_best_acc_score: 0.9095; val_best_f1_score: 0.9127; train_kl_reg_loss: 63172.3349; train_edge_recon_loss: 2681623.6023; train_gene_expr_recon_loss: 11430410.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23326.7167; train_chrom_access_recon_loss: 10356682.5303; train_global_loss: 24555215.3333; train_optim_loss: 24555215.3333; val_kl_reg_loss: 58333.0400; val_edge_recon_loss: 2689155.1562; val_gene_expr_recon_loss: 11602209.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23301.1621; val_chrom_access_recon_loss: 10452848.2500; val_global_loss: 24825847.2500; val_optim_loss: 24825847.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9516; val_auprc_score: 0.9317; val_best_acc_score: 0.8971; val_best_f1_score: 0.9025; train_kl_reg_loss: 63436.5610; train_edge_recon_loss: 2679076.7197; train_gene_expr_recon_loss: 11430334.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23278.2999; train_chrom_access_recon_loss: 10354147.6061; train_global_loss: 24550273.3636; train_optim_loss: 24550273.3636; val_kl_reg_loss: 58372.8442; val_edge_recon_loss: 2739054.2500; val_gene_expr_recon_loss: 11440929.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23256.9004; val_chrom_access_recon_loss: 10252544.3750; val_global_loss: 24514158.0000; val_optim_loss: 24514158.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9602; val_auprc_score: 0.9465; val_best_acc_score: 0.9127; val_best_f1_score: 0.9156; train_kl_reg_loss: 63259.9057; train_edge_recon_loss: 2684194.0758; train_gene_expr_recon_loss: 11428675.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23242.6284; train_chrom_access_recon_loss: 10354504.0303; train_global_loss: 24553876.2121; train_optim_loss: 24553876.2121; val_kl_reg_loss: 58162.6821; val_edge_recon_loss: 2687890.4062; val_gene_expr_recon_loss: 11460746.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23224.9316; val_chrom_access_recon_loss: 10391401.6250; val_global_loss: 24621426.5000; val_optim_loss: 24621426.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9549; val_auprc_score: 0.9392; val_best_acc_score: 0.9001; val_best_f1_score: 0.9048; train_kl_reg_loss: 63463.5323; train_edge_recon_loss: 2682478.0795; train_gene_expr_recon_loss: 11436238.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23213.9618; train_chrom_access_recon_loss: 10368459.0152; train_global_loss: 24573852.9091; train_optim_loss: 24573852.9091; val_kl_reg_loss: 58888.0005; val_edge_recon_loss: 2735793.1875; val_gene_expr_recon_loss: 11429378.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23189.4492; val_chrom_access_recon_loss: 10283974.7500; val_global_loss: 24531223.7500; val_optim_loss: 24531223.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9602; val_auprc_score: 0.9445; val_best_acc_score: 0.9081; val_best_f1_score: 0.9121; train_kl_reg_loss: 63402.1570; train_edge_recon_loss: 2671638.0833; train_gene_expr_recon_loss: 11433089.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22968.1909; train_chrom_access_recon_loss: 10370963.9545; train_global_loss: 24562062.2121; train_optim_loss: 24562062.2121; val_kl_reg_loss: 58550.6445; val_edge_recon_loss: 2704002.9375; val_gene_expr_recon_loss: 11452529.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22926.3984; val_chrom_access_recon_loss: 10414087.1250; val_global_loss: 24652096.7500; val_optim_loss: 24652096.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9607; val_auprc_score: 0.9465; val_best_acc_score: 0.9087; val_best_f1_score: 0.9130; train_kl_reg_loss: 63475.6600; train_edge_recon_loss: 2685068.3977; train_gene_expr_recon_loss: 11442121.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22922.3486; train_chrom_access_recon_loss: 10374387.9394; train_global_loss: 24587975.5455; train_optim_loss: 24587975.5455; val_kl_reg_loss: 58829.2656; val_edge_recon_loss: 2715921.9375; val_gene_expr_recon_loss: 11576595.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22919.4766; val_chrom_access_recon_loss: 10442029.7500; val_global_loss: 24816295.2500; val_optim_loss: 24816295.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9572; val_auprc_score: 0.9363; val_best_acc_score: 0.9105; val_best_f1_score: 0.9147; train_kl_reg_loss: 63479.1978; train_edge_recon_loss: 2675928.0189; train_gene_expr_recon_loss: 11426334.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22916.3462; train_chrom_access_recon_loss: 10359274.7576; train_global_loss: 24547933.0000; train_optim_loss: 24547933.0000; val_kl_reg_loss: 58465.7295; val_edge_recon_loss: 2701113.3125; val_gene_expr_recon_loss: 11497690.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22913.2051; val_chrom_access_recon_loss: 10374227.6250; val_global_loss: 24654410.0000; val_optim_loss: 24654410.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9554; val_auprc_score: 0.9348; val_best_acc_score: 0.9044; val_best_f1_score: 0.9090; train_kl_reg_loss: 63455.1132; train_edge_recon_loss: 2676551.5038; train_gene_expr_recon_loss: 11429259.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22910.9302; train_chrom_access_recon_loss: 10365487.2576; train_global_loss: 24557664.5152; train_optim_loss: 24557664.5152; val_kl_reg_loss: 58703.7871; val_edge_recon_loss: 2715793.1250; val_gene_expr_recon_loss: 11413237.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22907.8926; val_chrom_access_recon_loss: 10231856.2500; val_global_loss: 24442498.7500; val_optim_loss: 24442498.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 25 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9577
val AUPRC score: 0.9382
val best accuracy score: 0.9078
val best F1 score: 0.9109
val target rna MSE score: 1.1292
val source rna MSE score: 0.3835
val target atac MSE score: 0.3221
val source atac MSE score: 0.0712
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
