[True]
Run timestamp: 07092023_191126_88.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_88']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3394 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7897, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6178; val_auprc_score: 0.6054; val_best_acc_score: 0.5051; val_best_f1_score: 0.6683; train_kl_reg_loss: 61190.1809; train_edge_recon_loss: 3584850.9735; train_gene_expr_recon_loss: 27803158.9091; train_masked_gp_l1_reg_loss: 95750.7268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1558363.2519; train_chrom_access_recon_loss: 15001118.1212; train_global_loss: 48104432.3030; train_optim_loss: 48104432.3030; val_kl_reg_loss: 102979.7578; val_edge_recon_loss: 4065313.1562; val_gene_expr_recon_loss: 25440878.7500; val_masked_gp_l1_reg_loss: 91156.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1305795.7500; val_chrom_access_recon_loss: 14356295.5000; val_global_loss: 45362419.0000; val_optim_loss: 45362419.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6777; val_auprc_score: 0.6489; val_best_acc_score: 0.5234; val_best_f1_score: 0.6735; train_kl_reg_loss: 129783.8820; train_edge_recon_loss: 3557554.4773; train_gene_expr_recon_loss: 24817164.4848; train_masked_gp_l1_reg_loss: 84015.9490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1057423.8750; train_chrom_access_recon_loss: 14187733.9242; train_global_loss: 43833676.8485; train_optim_loss: 43833676.8485; val_kl_reg_loss: 144193.2930; val_edge_recon_loss: 4063621.4062; val_gene_expr_recon_loss: 24799477.0000; val_masked_gp_l1_reg_loss: 79616.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 828851.1875; val_chrom_access_recon_loss: 14123639.2500; val_global_loss: 44039399.0000; val_optim_loss: 44039399.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6946; val_auprc_score: 0.6821; val_best_acc_score: 0.6150; val_best_f1_score: 0.6943; train_kl_reg_loss: 129399.0430; train_edge_recon_loss: 3539120.2727; train_gene_expr_recon_loss: 24404777.0606; train_masked_gp_l1_reg_loss: 77985.0736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 667605.6809; train_chrom_access_recon_loss: 14037708.7424; train_global_loss: 42856595.8182; train_optim_loss: 42856595.8182; val_kl_reg_loss: 122168.3838; val_edge_recon_loss: 4057613.4375; val_gene_expr_recon_loss: 24869872.0000; val_masked_gp_l1_reg_loss: 77436.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 529094.7500; val_chrom_access_recon_loss: 14121381.7500; val_global_loss: 43777565.5000; val_optim_loss: 43777565.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7888; val_auprc_score: 0.7644; val_best_acc_score: 0.7047; val_best_f1_score: 0.7139; train_kl_reg_loss: 118536.3819; train_edge_recon_loss: 3530174.2197; train_gene_expr_recon_loss: 24210146.1818; train_masked_gp_l1_reg_loss: 77534.5518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 436922.0085; train_chrom_access_recon_loss: 13945932.8030; train_global_loss: 42319245.9394; train_optim_loss: 42319245.9394; val_kl_reg_loss: 115775.2705; val_edge_recon_loss: 4030209.3438; val_gene_expr_recon_loss: 24215213.7500; val_masked_gp_l1_reg_loss: 78182.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 359289.9062; val_chrom_access_recon_loss: 13839289.0000; val_global_loss: 42637960.0000; val_optim_loss: 42637960.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8403; val_auprc_score: 0.8131; val_best_acc_score: 0.7689; val_best_f1_score: 0.7809; train_kl_reg_loss: 107208.4845; train_edge_recon_loss: 3513881.3674; train_gene_expr_recon_loss: 24035465.4242; train_masked_gp_l1_reg_loss: 79721.6991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 309577.2230; train_chrom_access_recon_loss: 13844767.6061; train_global_loss: 41890621.8788; train_optim_loss: 41890621.8788; val_kl_reg_loss: 99083.0713; val_edge_recon_loss: 3922344.4688; val_gene_expr_recon_loss: 23772931.7500; val_masked_gp_l1_reg_loss: 81678.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 266513.7812; val_chrom_access_recon_loss: 13679277.3750; val_global_loss: 41821828.0000; val_optim_loss: 41821828.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8814; val_auprc_score: 0.8536; val_best_acc_score: 0.8152; val_best_f1_score: 0.8234; train_kl_reg_loss: 89449.8490; train_edge_recon_loss: 3444496.6326; train_gene_expr_recon_loss: 23874890.0303; train_masked_gp_l1_reg_loss: 83871.9028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 234097.6979; train_chrom_access_recon_loss: 13766312.9545; train_global_loss: 41493119.1515; train_optim_loss: 41493119.1515; val_kl_reg_loss: 74524.3164; val_edge_recon_loss: 3439114.4062; val_gene_expr_recon_loss: 23794285.2500; val_masked_gp_l1_reg_loss: 86425.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 204851.7031; val_chrom_access_recon_loss: 13642609.6250; val_global_loss: 41241810.5000; val_optim_loss: 41241810.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8733; val_auprc_score: 0.8358; val_best_acc_score: 0.8106; val_best_f1_score: 0.8298; train_kl_reg_loss: 92261.5368; train_edge_recon_loss: 3095924.7614; train_gene_expr_recon_loss: 23797756.3636; train_masked_gp_l1_reg_loss: 89034.8743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 183144.3383; train_chrom_access_recon_loss: 13731744.8182; train_global_loss: 40989866.9697; train_optim_loss: 40989866.9697; val_kl_reg_loss: 112507.2295; val_edge_recon_loss: 2988440.6875; val_gene_expr_recon_loss: 23843469.5000; val_masked_gp_l1_reg_loss: 91565.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163892.9688; val_chrom_access_recon_loss: 13577555.0000; val_global_loss: 40777430.5000; val_optim_loss: 40777430.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8758; val_auprc_score: 0.8413; val_best_acc_score: 0.8092; val_best_f1_score: 0.8278; train_kl_reg_loss: 120497.9312; train_edge_recon_loss: 2947874.9432; train_gene_expr_recon_loss: 23678863.7879; train_masked_gp_l1_reg_loss: 93581.5625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149531.6570; train_chrom_access_recon_loss: 13649519.2576; train_global_loss: 40639869.3333; train_optim_loss: 40639869.3333; val_kl_reg_loss: 128737.3281; val_edge_recon_loss: 2954545.0938; val_gene_expr_recon_loss: 23915759.0000; val_masked_gp_l1_reg_loss: 94702.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135758.0156; val_chrom_access_recon_loss: 13568559.1250; val_global_loss: 40798060.0000; val_optim_loss: 40798060.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8861; val_auprc_score: 0.8502; val_best_acc_score: 0.8248; val_best_f1_score: 0.8410; train_kl_reg_loss: 128343.7480; train_edge_recon_loss: 2891500.9394; train_gene_expr_recon_loss: 23551952.3030; train_masked_gp_l1_reg_loss: 95631.7359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125446.9207; train_chrom_access_recon_loss: 13590206.7121; train_global_loss: 40383082.0606; train_optim_loss: 40383082.0606; val_kl_reg_loss: 124148.7178; val_edge_recon_loss: 2881392.7500; val_gene_expr_recon_loss: 23682115.7500; val_masked_gp_l1_reg_loss: 96737.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116776.6328; val_chrom_access_recon_loss: 13615863.2500; val_global_loss: 40517035.0000; val_optim_loss: 40517035.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8973; val_auprc_score: 0.8714; val_best_acc_score: 0.8256; val_best_f1_score: 0.8424; train_kl_reg_loss: 122616.6597; train_edge_recon_loss: 2877500.4545; train_gene_expr_recon_loss: 23450106.4545; train_masked_gp_l1_reg_loss: 97834.1139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109249.3841; train_chrom_access_recon_loss: 13519580.0758; train_global_loss: 40176887.5758; train_optim_loss: 40176887.5758; val_kl_reg_loss: 119663.6689; val_edge_recon_loss: 2884927.4375; val_gene_expr_recon_loss: 23437223.0000; val_masked_gp_l1_reg_loss: 98916.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102469.0781; val_chrom_access_recon_loss: 13404328.8750; val_global_loss: 40047529.0000; val_optim_loss: 40047529.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8992; val_auprc_score: 0.8710; val_best_acc_score: 0.8369; val_best_f1_score: 0.8504; train_kl_reg_loss: 123644.1863; train_edge_recon_loss: 2855602.5947; train_gene_expr_recon_loss: 23370225.0303; train_masked_gp_l1_reg_loss: 99731.4348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97063.7335; train_chrom_access_recon_loss: 13483063.2121; train_global_loss: 40029330.0000; train_optim_loss: 40029330.0000; val_kl_reg_loss: 121893.0137; val_edge_recon_loss: 2863517.6250; val_gene_expr_recon_loss: 23363676.2500; val_masked_gp_l1_reg_loss: 100650.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92329.5547; val_chrom_access_recon_loss: 13520497.5000; val_global_loss: 40062564.0000; val_optim_loss: 40062564.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9075; val_auprc_score: 0.8781; val_best_acc_score: 0.8447; val_best_f1_score: 0.8589; train_kl_reg_loss: 118718.3273; train_edge_recon_loss: 2839952.5114; train_gene_expr_recon_loss: 23268721.6667; train_masked_gp_l1_reg_loss: 101526.3930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87884.9261; train_chrom_access_recon_loss: 13426289.7273; train_global_loss: 39843093.5152; train_optim_loss: 39843093.5152; val_kl_reg_loss: 122169.9473; val_edge_recon_loss: 2849422.6562; val_gene_expr_recon_loss: 23217169.5000; val_masked_gp_l1_reg_loss: 102463.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84123.0938; val_chrom_access_recon_loss: 13274365.7500; val_global_loss: 39649716.0000; val_optim_loss: 39649716.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9080; val_auprc_score: 0.8780; val_best_acc_score: 0.8434; val_best_f1_score: 0.8562; train_kl_reg_loss: 117419.4819; train_edge_recon_loss: 2841611.9508; train_gene_expr_recon_loss: 23190739.0909; train_masked_gp_l1_reg_loss: 103117.6504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80843.1580; train_chrom_access_recon_loss: 13384014.1364; train_global_loss: 39717745.5758; train_optim_loss: 39717745.5758; val_kl_reg_loss: 114786.8691; val_edge_recon_loss: 2848743.1875; val_gene_expr_recon_loss: 23351401.5000; val_masked_gp_l1_reg_loss: 104106.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77651.3203; val_chrom_access_recon_loss: 13439427.0000; val_global_loss: 39936117.0000; val_optim_loss: 39936117.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9065; val_auprc_score: 0.8773; val_best_acc_score: 0.8455; val_best_f1_score: 0.8569; train_kl_reg_loss: 114900.7951; train_edge_recon_loss: 2821679.0795; train_gene_expr_recon_loss: 23093460.8182; train_masked_gp_l1_reg_loss: 104842.7963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75081.0107; train_chrom_access_recon_loss: 13322297.7879; train_global_loss: 39532262.3030; train_optim_loss: 39532262.3030; val_kl_reg_loss: 117140.9336; val_edge_recon_loss: 2827060.9688; val_gene_expr_recon_loss: 23130851.5000; val_masked_gp_l1_reg_loss: 105314.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72440.9844; val_chrom_access_recon_loss: 13242217.5000; val_global_loss: 39495025.0000; val_optim_loss: 39495025.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9131; val_auprc_score: 0.8885; val_best_acc_score: 0.8452; val_best_f1_score: 0.8580; train_kl_reg_loss: 115947.0798; train_edge_recon_loss: 2815766.3144; train_gene_expr_recon_loss: 23035934.5152; train_masked_gp_l1_reg_loss: 106069.7325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70425.2405; train_chrom_access_recon_loss: 13298577.1818; train_global_loss: 39442720.3636; train_optim_loss: 39442720.3636; val_kl_reg_loss: 109346.8701; val_edge_recon_loss: 2834676.6875; val_gene_expr_recon_loss: 22943861.5000; val_masked_gp_l1_reg_loss: 107009.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68552.8281; val_chrom_access_recon_loss: 13085086.7500; val_global_loss: 39148534.0000; val_optim_loss: 39148534.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9263; val_auprc_score: 0.9082; val_best_acc_score: 0.8592; val_best_f1_score: 0.8673; train_kl_reg_loss: 115130.5434; train_edge_recon_loss: 2785862.3864; train_gene_expr_recon_loss: 22981847.8485; train_masked_gp_l1_reg_loss: 107505.9927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66818.0421; train_chrom_access_recon_loss: 13260974.2576; train_global_loss: 39318138.9697; train_optim_loss: 39318138.9697; val_kl_reg_loss: 115366.7832; val_edge_recon_loss: 2815300.0625; val_gene_expr_recon_loss: 23119482.5000; val_masked_gp_l1_reg_loss: 108246.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65098.5039; val_chrom_access_recon_loss: 13239980.2500; val_global_loss: 39463473.5000; val_optim_loss: 39463473.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9223; val_auprc_score: 0.8961; val_best_acc_score: 0.8565; val_best_f1_score: 0.8670; train_kl_reg_loss: 113695.2951; train_edge_recon_loss: 2795541.2727; train_gene_expr_recon_loss: 22908735.1515; train_masked_gp_l1_reg_loss: 108707.1864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63434.6692; train_chrom_access_recon_loss: 13209391.8485; train_global_loss: 39199505.0909; train_optim_loss: 39199505.0909; val_kl_reg_loss: 116290.9980; val_edge_recon_loss: 2823600.1250; val_gene_expr_recon_loss: 22955241.5000; val_masked_gp_l1_reg_loss: 109447.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62276.8789; val_chrom_access_recon_loss: 13150487.6250; val_global_loss: 39217344.5000; val_optim_loss: 39217344.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9268; val_auprc_score: 0.8980; val_best_acc_score: 0.8667; val_best_f1_score: 0.8766; train_kl_reg_loss: 113132.7540; train_edge_recon_loss: 2783725.6136; train_gene_expr_recon_loss: 22859319.0606; train_masked_gp_l1_reg_loss: 109913.8007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60968.1113; train_chrom_access_recon_loss: 13172504.1364; train_global_loss: 39099563.2121; train_optim_loss: 39099563.2121; val_kl_reg_loss: 113159.0830; val_edge_recon_loss: 2797026.9375; val_gene_expr_recon_loss: 23193787.5000; val_masked_gp_l1_reg_loss: 110432.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59940.4961; val_chrom_access_recon_loss: 13281760.7500; val_global_loss: 39556105.5000; val_optim_loss: 39556105.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9267; val_auprc_score: 0.9017; val_best_acc_score: 0.8641; val_best_f1_score: 0.8726; train_kl_reg_loss: 110885.6952; train_edge_recon_loss: 2776347.1591; train_gene_expr_recon_loss: 22784404.3939; train_masked_gp_l1_reg_loss: 110998.2344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58756.9909; train_chrom_access_recon_loss: 13133083.2879; train_global_loss: 38974475.8182; train_optim_loss: 38974475.8182; val_kl_reg_loss: 112051.4395; val_edge_recon_loss: 2817016.9375; val_gene_expr_recon_loss: 22955853.5000; val_masked_gp_l1_reg_loss: 111809.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57930.3828; val_chrom_access_recon_loss: 13128920.3750; val_global_loss: 39183581.5000; val_optim_loss: 39183581.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9209; val_auprc_score: 0.8919; val_best_acc_score: 0.8632; val_best_f1_score: 0.8712; train_kl_reg_loss: 111319.3374; train_edge_recon_loss: 2776823.3220; train_gene_expr_recon_loss: 22768887.1515; train_masked_gp_l1_reg_loss: 110022.9998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52113.9308; train_chrom_access_recon_loss: 13119008.5758; train_global_loss: 38938175.2727; train_optim_loss: 38938175.2727; val_kl_reg_loss: 112259.5732; val_edge_recon_loss: 2810743.0938; val_gene_expr_recon_loss: 22971228.0000; val_masked_gp_l1_reg_loss: 109023.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49717.2734; val_chrom_access_recon_loss: 13316319.6250; val_global_loss: 39369293.0000; val_optim_loss: 39369293.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9289; val_auprc_score: 0.9050; val_best_acc_score: 0.8713; val_best_f1_score: 0.8799; train_kl_reg_loss: 111952.3142; train_edge_recon_loss: 2776255.4659; train_gene_expr_recon_loss: 22739289.9394; train_masked_gp_l1_reg_loss: 108808.9722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49225.7360; train_chrom_access_recon_loss: 13097493.8939; train_global_loss: 38883025.9394; train_optim_loss: 38883025.9394; val_kl_reg_loss: 113179.4785; val_edge_recon_loss: 2789311.6562; val_gene_expr_recon_loss: 22941470.5000; val_masked_gp_l1_reg_loss: 108666.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48867.0156; val_chrom_access_recon_loss: 13051322.3750; val_global_loss: 39052818.0000; val_optim_loss: 39052818.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9206; val_auprc_score: 0.8836; val_best_acc_score: 0.8646; val_best_f1_score: 0.8744; train_kl_reg_loss: 112449.8466; train_edge_recon_loss: 2779451.4015; train_gene_expr_recon_loss: 22724276.0303; train_masked_gp_l1_reg_loss: 108609.3814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48585.0882; train_chrom_access_recon_loss: 13091795.0606; train_global_loss: 38865166.5455; train_optim_loss: 38865166.5455; val_kl_reg_loss: 113092.0801; val_edge_recon_loss: 2822766.0938; val_gene_expr_recon_loss: 22928762.7500; val_masked_gp_l1_reg_loss: 108558.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48329.2773; val_chrom_access_recon_loss: 13130369.2500; val_global_loss: 39151878.0000; val_optim_loss: 39151878.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9282; val_auprc_score: 0.9012; val_best_acc_score: 0.8665; val_best_f1_score: 0.8746; train_kl_reg_loss: 112717.3142; train_edge_recon_loss: 2773470.2083; train_gene_expr_recon_loss: 22738103.2121; train_masked_gp_l1_reg_loss: 108572.2899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48119.0285; train_chrom_access_recon_loss: 13093567.8939; train_global_loss: 38874550.0000; train_optim_loss: 38874550.0000; val_kl_reg_loss: 113587.0127; val_edge_recon_loss: 2803517.9062; val_gene_expr_recon_loss: 22937094.0000; val_masked_gp_l1_reg_loss: 108579.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47926.8906; val_chrom_access_recon_loss: 13081637.6250; val_global_loss: 39092343.5000; val_optim_loss: 39092343.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9187; val_auprc_score: 0.8910; val_best_acc_score: 0.8533; val_best_f1_score: 0.8643; train_kl_reg_loss: 113304.3733; train_edge_recon_loss: 2778361.4811; train_gene_expr_recon_loss: 22733396.0303; train_masked_gp_l1_reg_loss: 108586.8094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47722.1170; train_chrom_access_recon_loss: 13087406.6970; train_global_loss: 38868777.5152; train_optim_loss: 38868777.5152; val_kl_reg_loss: 112465.6406; val_edge_recon_loss: 2838005.5625; val_gene_expr_recon_loss: 22743412.0000; val_masked_gp_l1_reg_loss: 108597.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47520.4883; val_chrom_access_recon_loss: 12981505.5000; val_global_loss: 38831507.0000; val_optim_loss: 38831507.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9226; val_auprc_score: 0.8983; val_best_acc_score: 0.8530; val_best_f1_score: 0.8653; train_kl_reg_loss: 113361.1819; train_edge_recon_loss: 2769737.9962; train_gene_expr_recon_loss: 22745301.2424; train_masked_gp_l1_reg_loss: 108618.5381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47339.7849; train_chrom_access_recon_loss: 13100166.6212; train_global_loss: 38884525.3333; train_optim_loss: 38884525.3333; val_kl_reg_loss: 113844.4053; val_edge_recon_loss: 2847176.6562; val_gene_expr_recon_loss: 22868657.5000; val_masked_gp_l1_reg_loss: 108638.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47194.0078; val_chrom_access_recon_loss: 13091626.0000; val_global_loss: 39077137.0000; val_optim_loss: 39077137.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9224; val_auprc_score: 0.8961; val_best_acc_score: 0.8579; val_best_f1_score: 0.8688; train_kl_reg_loss: 116388.7143; train_edge_recon_loss: 2813068.4318; train_gene_expr_recon_loss: 22522309.2121; train_masked_gp_l1_reg_loss: 108349.9049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46397.0305; train_chrom_access_recon_loss: 13129560.6667; train_global_loss: 38736074.1212; train_optim_loss: 38736074.1212; val_kl_reg_loss: 83841.3799; val_edge_recon_loss: 2866504.0312; val_gene_expr_recon_loss: 22556675.2500; val_masked_gp_l1_reg_loss: 108250.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45833.9375; val_chrom_access_recon_loss: 12944682.8750; val_global_loss: 38605787.5000; val_optim_loss: 38605787.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9356; val_auprc_score: 0.9145; val_best_acc_score: 0.8726; val_best_f1_score: 0.8806; train_kl_reg_loss: 116726.8859; train_edge_recon_loss: 2802085.5303; train_gene_expr_recon_loss: 22489755.0303; train_masked_gp_l1_reg_loss: 108287.1867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45614.8741; train_chrom_access_recon_loss: 13023871.1667; train_global_loss: 38586340.4242; train_optim_loss: 38586340.4242; val_kl_reg_loss: 85347.1309; val_edge_recon_loss: 2831308.4375; val_gene_expr_recon_loss: 22513319.5000; val_masked_gp_l1_reg_loss: 108302.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45394.6914; val_chrom_access_recon_loss: 13013622.1250; val_global_loss: 38597293.5000; val_optim_loss: 38597293.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9319; val_auprc_score: 0.9057; val_best_acc_score: 0.8740; val_best_f1_score: 0.8812; train_kl_reg_loss: 118562.5252; train_edge_recon_loss: 2800412.5227; train_gene_expr_recon_loss: 22474329.5455; train_masked_gp_l1_reg_loss: 108328.4835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45222.4682; train_chrom_access_recon_loss: 13002879.0152; train_global_loss: 38549734.0606; train_optim_loss: 38549734.0606; val_kl_reg_loss: 87629.0508; val_edge_recon_loss: 2824523.6562; val_gene_expr_recon_loss: 22747219.0000; val_masked_gp_l1_reg_loss: 108358.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45045.0703; val_chrom_access_recon_loss: 13104930.6250; val_global_loss: 38917706.0000; val_optim_loss: 38917706.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9273; val_auprc_score: 0.8990; val_best_acc_score: 0.8708; val_best_f1_score: 0.8800; train_kl_reg_loss: 119150.2759; train_edge_recon_loss: 2798398.0606; train_gene_expr_recon_loss: 22458394.6061; train_masked_gp_l1_reg_loss: 108382.8851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44914.6900; train_chrom_access_recon_loss: 12986056.7879; train_global_loss: 38515296.9697; train_optim_loss: 38515296.9697; val_kl_reg_loss: 87871.8662; val_edge_recon_loss: 2820664.6875; val_gene_expr_recon_loss: 22672738.5000; val_masked_gp_l1_reg_loss: 108389.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44733.4297; val_chrom_access_recon_loss: 13094918.6250; val_global_loss: 38829318.0000; val_optim_loss: 38829318.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9298; val_auprc_score: 0.9063; val_best_acc_score: 0.8675; val_best_f1_score: 0.8766; train_kl_reg_loss: 119116.4424; train_edge_recon_loss: 2792668.4962; train_gene_expr_recon_loss: 22435234.3939; train_masked_gp_l1_reg_loss: 108411.8594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44596.7857; train_chrom_access_recon_loss: 12970916.4091; train_global_loss: 38470944.3030; train_optim_loss: 38470944.3030; val_kl_reg_loss: 88110.4336; val_edge_recon_loss: 2815980.5312; val_gene_expr_recon_loss: 22685813.7500; val_masked_gp_l1_reg_loss: 108428.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44455.3320; val_chrom_access_recon_loss: 13057660.7500; val_global_loss: 38800449.0000; val_optim_loss: 38800449.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9263; val_auprc_score: 0.8982; val_best_acc_score: 0.8678; val_best_f1_score: 0.8772; train_kl_reg_loss: 119180.0948; train_edge_recon_loss: 2791042.8750; train_gene_expr_recon_loss: 22440112.4545; train_masked_gp_l1_reg_loss: 108445.3797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44335.9931; train_chrom_access_recon_loss: 12966557.0303; train_global_loss: 38469673.7576; train_optim_loss: 38469673.7576; val_kl_reg_loss: 88711.0869; val_edge_recon_loss: 2822886.3125; val_gene_expr_recon_loss: 22734877.7500; val_masked_gp_l1_reg_loss: 108447.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44191.8633; val_chrom_access_recon_loss: 12945233.7500; val_global_loss: 38744349.0000; val_optim_loss: 38744349.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9306; val_auprc_score: 0.9044; val_best_acc_score: 0.8708; val_best_f1_score: 0.8776; train_kl_reg_loss: 119178.5906; train_edge_recon_loss: 2795751.4205; train_gene_expr_recon_loss: 22437329.8788; train_masked_gp_l1_reg_loss: 108387.2198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43931.6399; train_chrom_access_recon_loss: 12969439.5909; train_global_loss: 38474018.6061; train_optim_loss: 38474018.6061; val_kl_reg_loss: 89019.0469; val_edge_recon_loss: 2803053.3750; val_gene_expr_recon_loss: 22527608.2500; val_masked_gp_l1_reg_loss: 108345.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43838.8867; val_chrom_access_recon_loss: 12931215.3750; val_global_loss: 38503079.5000; val_optim_loss: 38503079.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9259; val_auprc_score: 0.8962; val_best_acc_score: 0.8684; val_best_f1_score: 0.8764; train_kl_reg_loss: 119401.7287; train_edge_recon_loss: 2795800.0492; train_gene_expr_recon_loss: 22436421.4848; train_masked_gp_l1_reg_loss: 108326.9659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43796.9126; train_chrom_access_recon_loss: 12962280.8788; train_global_loss: 38466028.1818; train_optim_loss: 38466028.1818; val_kl_reg_loss: 88862.4053; val_edge_recon_loss: 2838435.7188; val_gene_expr_recon_loss: 22375667.7500; val_masked_gp_l1_reg_loss: 108311.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43761.2656; val_chrom_access_recon_loss: 12865978.2500; val_global_loss: 38321018.5000; val_optim_loss: 38321018.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9339; val_auprc_score: 0.9104; val_best_acc_score: 0.8740; val_best_f1_score: 0.8822; train_kl_reg_loss: 119297.9647; train_edge_recon_loss: 2786420.6326; train_gene_expr_recon_loss: 22422853.4848; train_masked_gp_l1_reg_loss: 108299.7855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43732.3638; train_chrom_access_recon_loss: 12958929.2727; train_global_loss: 38439533.7576; train_optim_loss: 38439533.7576; val_kl_reg_loss: 89496.4746; val_edge_recon_loss: 2812916.4375; val_gene_expr_recon_loss: 22299902.7500; val_masked_gp_l1_reg_loss: 108291.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43703.1406; val_chrom_access_recon_loss: 12873920.6250; val_global_loss: 38228232.0000; val_optim_loss: 38228232.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9308; val_auprc_score: 0.9031; val_best_acc_score: 0.8721; val_best_f1_score: 0.8806; train_kl_reg_loss: 119330.5813; train_edge_recon_loss: 2798024.6970; train_gene_expr_recon_loss: 22434899.0909; train_masked_gp_l1_reg_loss: 108288.6204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43683.3764; train_chrom_access_recon_loss: 12970298.4091; train_global_loss: 38474525.1515; train_optim_loss: 38474525.1515; val_kl_reg_loss: 89075.2920; val_edge_recon_loss: 2823163.7188; val_gene_expr_recon_loss: 22388900.7500; val_masked_gp_l1_reg_loss: 108279.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43655.7266; val_chrom_access_recon_loss: 12925875.7500; val_global_loss: 38378951.5000; val_optim_loss: 38378951.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9309; val_auprc_score: 0.9045; val_best_acc_score: 0.8708; val_best_f1_score: 0.8797; train_kl_reg_loss: 119416.6889; train_edge_recon_loss: 2788314.0833; train_gene_expr_recon_loss: 22424436.0909; train_masked_gp_l1_reg_loss: 108277.5412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43635.2283; train_chrom_access_recon_loss: 12966770.1364; train_global_loss: 38450850.1212; train_optim_loss: 38450850.1212; val_kl_reg_loss: 90016.2744; val_edge_recon_loss: 2801466.5625; val_gene_expr_recon_loss: 22747963.0000; val_masked_gp_l1_reg_loss: 108271.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43613.6445; val_chrom_access_recon_loss: 12975653.7500; val_global_loss: 38766986.0000; val_optim_loss: 38766986.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9364; val_auprc_score: 0.9102; val_best_acc_score: 0.8743; val_best_f1_score: 0.8810; train_kl_reg_loss: 119292.3517; train_edge_recon_loss: 2787067.8295; train_gene_expr_recon_loss: 22435107.8182; train_masked_gp_l1_reg_loss: 108271.3397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43596.7188; train_chrom_access_recon_loss: 12967199.5606; train_global_loss: 38460535.8788; train_optim_loss: 38460535.8788; val_kl_reg_loss: 89558.7783; val_edge_recon_loss: 2797401.0938; val_gene_expr_recon_loss: 22520209.5000; val_masked_gp_l1_reg_loss: 108266.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43574.0586; val_chrom_access_recon_loss: 12886671.1250; val_global_loss: 38445680.0000; val_optim_loss: 38445680.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9287; val_auprc_score: 0.9009; val_best_acc_score: 0.8667; val_best_f1_score: 0.8769; train_kl_reg_loss: 119124.4727; train_edge_recon_loss: 2788051.3144; train_gene_expr_recon_loss: 22433000.2727; train_masked_gp_l1_reg_loss: 108266.3498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43557.4533; train_chrom_access_recon_loss: 12964853.1061; train_global_loss: 38456852.7273; train_optim_loss: 38456852.7273; val_kl_reg_loss: 89586.2480; val_edge_recon_loss: 2833958.5625; val_gene_expr_recon_loss: 22389180.7500; val_masked_gp_l1_reg_loss: 108262.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43536.8242; val_chrom_access_recon_loss: 12886959.1250; val_global_loss: 38351482.5000; val_optim_loss: 38351482.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9304; val_auprc_score: 0.9057; val_best_acc_score: 0.8657; val_best_f1_score: 0.8754; train_kl_reg_loss: 119176.8026; train_edge_recon_loss: 2788816.4508; train_gene_expr_recon_loss: 22439540.6364; train_masked_gp_l1_reg_loss: 108256.5112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43508.9688; train_chrom_access_recon_loss: 12966701.0455; train_global_loss: 38466000.5455; train_optim_loss: 38466000.5455; val_kl_reg_loss: 89351.3984; val_edge_recon_loss: 2826598.4062; val_gene_expr_recon_loss: 22504748.7500; val_masked_gp_l1_reg_loss: 108252.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43500.1953; val_chrom_access_recon_loss: 12967118.3750; val_global_loss: 38539569.0000; val_optim_loss: 38539569.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9292; val_auprc_score: 0.9033; val_best_acc_score: 0.8649; val_best_f1_score: 0.8753; train_kl_reg_loss: 119244.1328; train_edge_recon_loss: 2785655.6326; train_gene_expr_recon_loss: 22441718.7879; train_masked_gp_l1_reg_loss: 108250.5887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43496.6584; train_chrom_access_recon_loss: 12969274.0152; train_global_loss: 38467639.4545; train_optim_loss: 38467639.4545; val_kl_reg_loss: 89017.2119; val_edge_recon_loss: 2818817.2812; val_gene_expr_recon_loss: 22592586.7500; val_masked_gp_l1_reg_loss: 108248.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43493.1719; val_chrom_access_recon_loss: 12845054.1250; val_global_loss: 38497216.5000; val_optim_loss: 38497216.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9305; val_auprc_score: 0.9065; val_best_acc_score: 0.8775; val_best_f1_score: 0.8851; train_kl_reg_loss: 119265.4342; train_edge_recon_loss: 2784585.0871; train_gene_expr_recon_loss: 22420115.2121; train_masked_gp_l1_reg_loss: 108247.4203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43490.1617; train_chrom_access_recon_loss: 12961360.9091; train_global_loss: 38437064.1212; train_optim_loss: 38437064.1212; val_kl_reg_loss: 89478.3340; val_edge_recon_loss: 2819131.0312; val_gene_expr_recon_loss: 22720338.2500; val_masked_gp_l1_reg_loss: 108246.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43487.1328; val_chrom_access_recon_loss: 13112152.8750; val_global_loss: 38892834.5000; val_optim_loss: 38892834.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9322; val_auprc_score: 0.9080; val_best_acc_score: 0.8743; val_best_f1_score: 0.8833; train_kl_reg_loss: 119185.6611; train_edge_recon_loss: 2784136.0795; train_gene_expr_recon_loss: 22441826.3030; train_masked_gp_l1_reg_loss: 108245.3651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43484.7748; train_chrom_access_recon_loss: 12969014.1818; train_global_loss: 38465892.2424; train_optim_loss: 38465892.2424; val_kl_reg_loss: 89692.6113; val_edge_recon_loss: 2808414.5312; val_gene_expr_recon_loss: 22527391.2500; val_masked_gp_l1_reg_loss: 108244.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43482.0000; val_chrom_access_recon_loss: 12881204.2500; val_global_loss: 38458428.5000; val_optim_loss: 38458428.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 24 min 34 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
val AUROC score: 0.9283
val AUPRC score: 0.9007
val best accuracy score: 0.8721
val best F1 score: 0.8807
val target rna MSE score: 1.0444
val source rna MSE score: 0.3153
val target atac MSE score: 0.3334
val source atac MSE score: 0.0746
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
