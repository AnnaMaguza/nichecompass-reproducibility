[True]
Run timestamp: 26072023_024944_88.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_88']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8994; val_auprc_score: 0.9115; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13806.4287; train_edge_recon_loss: 3494171.4167; train_gene_expr_recon_loss: 3184441.1389; train_masked_gp_l1_reg_loss: 1880.2872; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 107800565.3333; train_global_loss: 114494864.8889; train_optim_loss: 114494864.8889; val_kl_reg_loss: 94344.2188; val_edge_recon_loss: 4065996.5000; val_gene_expr_recon_loss: 3032318.0000; val_masked_gp_l1_reg_loss: 1917.3757; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 107606376.0000; val_global_loss: 114800952.0000; val_optim_loss: 114800952.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9066; val_auprc_score: 0.9173; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 48156.7038; train_edge_recon_loss: 3572935.5556; train_gene_expr_recon_loss: 3006255.3611; train_masked_gp_l1_reg_loss: 2018.2335; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 107969057.7778; train_global_loss: 114598423.1111; train_optim_loss: 114598423.1111; val_kl_reg_loss: 41135.2188; val_edge_recon_loss: 4065919.5000; val_gene_expr_recon_loss: 2843841.5000; val_masked_gp_l1_reg_loss: 2174.8662; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 105909648.0000; val_global_loss: 112862720.0000; val_optim_loss: 112862720.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8846; val_auprc_score: 0.8901; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 74678.0291; train_edge_recon_loss: 3585107.7222; train_gene_expr_recon_loss: 2776852.0833; train_masked_gp_l1_reg_loss: 2319.3900; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 104836508.4444; train_global_loss: 111275465.7778; train_optim_loss: 111275465.7778; val_kl_reg_loss: 74576.3672; val_edge_recon_loss: 4065849.0000; val_gene_expr_recon_loss: 2624990.7500; val_masked_gp_l1_reg_loss: 2492.2979; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 103776720.0000; val_global_loss: 110544632.0000; val_optim_loss: 110544632.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8707; val_auprc_score: 0.8740; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 105804.3047; train_edge_recon_loss: 3628906.1111; train_gene_expr_recon_loss: 2566878.2500; train_masked_gp_l1_reg_loss: 2591.4829; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102313624.0000; train_global_loss: 108617803.5556; train_optim_loss: 108617803.5556; val_kl_reg_loss: 82169.5938; val_edge_recon_loss: 4065912.0000; val_gene_expr_recon_loss: 2464132.0000; val_masked_gp_l1_reg_loss: 2687.7246; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101967008.0000; val_global_loss: 108581912.0000; val_optim_loss: 108581912.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8823; val_auprc_score: 0.8861; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 124851.8976; train_edge_recon_loss: 3651107.7778; train_gene_expr_recon_loss: 2438254.3611; train_masked_gp_l1_reg_loss: 2730.4920; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100421295.1111; train_global_loss: 106638240.8889; train_optim_loss: 106638240.8889; val_kl_reg_loss: 142706.2812; val_edge_recon_loss: 4065908.5000; val_gene_expr_recon_loss: 2370330.7500; val_masked_gp_l1_reg_loss: 2768.4595; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100786744.0000; val_global_loss: 107368456.0000; val_optim_loss: 107368456.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8873; val_auprc_score: 0.8840; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 160816.5104; train_edge_recon_loss: 3644724.5278; train_gene_expr_recon_loss: 2353345.5556; train_masked_gp_l1_reg_loss: 2775.9974; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99154400.8889; train_global_loss: 105316063.1111; train_optim_loss: 105316063.1111; val_kl_reg_loss: 137008.9062; val_edge_recon_loss: 4065803.2500; val_gene_expr_recon_loss: 2299573.2500; val_masked_gp_l1_reg_loss: 2773.6792; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99611080.0000; val_global_loss: 106116240.0000; val_optim_loss: 106116240.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8797; val_auprc_score: 0.8745; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 177944.0330; train_edge_recon_loss: 3625978.5556; train_gene_expr_recon_loss: 2295286.8889; train_masked_gp_l1_reg_loss: 2759.7442; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98810296.8889; train_global_loss: 104912265.7778; train_optim_loss: 104912265.7778; val_kl_reg_loss: 152274.9688; val_edge_recon_loss: 4065616.5000; val_gene_expr_recon_loss: 2244101.5000; val_masked_gp_l1_reg_loss: 2735.6494; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99093432.0000; val_global_loss: 105558160.0000; val_optim_loss: 105558160.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8690; val_auprc_score: 0.8665; val_best_acc_score: 0.5024; val_best_f1_score: 0.6677; train_kl_reg_loss: 189206.2465; train_edge_recon_loss: 3625768.8333; train_gene_expr_recon_loss: 2248905.0833; train_masked_gp_l1_reg_loss: 2711.4322; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98628138.6667; train_global_loss: 104694729.7778; train_optim_loss: 104694729.7778; val_kl_reg_loss: 162070.9375; val_edge_recon_loss: 4065225.5000; val_gene_expr_recon_loss: 2202327.7500; val_masked_gp_l1_reg_loss: 2678.4956; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98644896.0000; val_global_loss: 105077200.0000; val_optim_loss: 105077200.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8571; val_auprc_score: 0.8583; val_best_acc_score: 0.5066; val_best_f1_score: 0.6696; train_kl_reg_loss: 195570.6580; train_edge_recon_loss: 3615093.1389; train_gene_expr_recon_loss: 2189136.6528; train_masked_gp_l1_reg_loss: 2653.2785; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97507493.3333; train_global_loss: 103509947.5556; train_optim_loss: 103509947.5556; val_kl_reg_loss: 176816.6250; val_edge_recon_loss: 4064996.0000; val_gene_expr_recon_loss: 2170640.2500; val_masked_gp_l1_reg_loss: 2622.4756; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98504232.0000; val_global_loss: 104919304.0000; val_optim_loss: 104919304.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8524; val_auprc_score: 0.8495; val_best_acc_score: 0.5181; val_best_f1_score: 0.6748; train_kl_reg_loss: 201296.7847; train_edge_recon_loss: 3610409.0833; train_gene_expr_recon_loss: 2181032.7778; train_masked_gp_l1_reg_loss: 2599.2452; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97770151.1111; train_global_loss: 103765488.8889; train_optim_loss: 103765488.8889; val_kl_reg_loss: 158475.5156; val_edge_recon_loss: 4064220.7500; val_gene_expr_recon_loss: 2151778.7500; val_masked_gp_l1_reg_loss: 2571.0713; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98380352.0000; val_global_loss: 104757400.0000; val_optim_loss: 104757400.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8603; val_auprc_score: 0.8602; val_best_acc_score: 0.5335; val_best_f1_score: 0.6817; train_kl_reg_loss: 199506.2222; train_edge_recon_loss: 3612656.1111; train_gene_expr_recon_loss: 2162372.8333; train_masked_gp_l1_reg_loss: 2550.5827; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97528212.4444; train_global_loss: 103505298.6667; train_optim_loss: 103505298.6667; val_kl_reg_loss: 169624.6562; val_edge_recon_loss: 4063412.2500; val_gene_expr_recon_loss: 2135071.7500; val_masked_gp_l1_reg_loss: 2525.3738; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98150928.0000; val_global_loss: 104521560.0000; val_optim_loss: 104521560.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8609; val_auprc_score: 0.8581; val_best_acc_score: 0.5395; val_best_f1_score: 0.6843; train_kl_reg_loss: 197720.8177; train_edge_recon_loss: 3604524.9167; train_gene_expr_recon_loss: 2134714.4167; train_masked_gp_l1_reg_loss: 2508.5629; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96494558.2222; train_global_loss: 102434027.5556; train_optim_loss: 102434027.5556; val_kl_reg_loss: 201063.4375; val_edge_recon_loss: 4062944.2500; val_gene_expr_recon_loss: 2120753.0000; val_masked_gp_l1_reg_loss: 2488.0947; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97934504.0000; val_global_loss: 104321752.0000; val_optim_loss: 104321752.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8688; val_auprc_score: 0.8664; val_best_acc_score: 0.5783; val_best_f1_score: 0.7023; train_kl_reg_loss: 204250.8229; train_edge_recon_loss: 3596201.0556; train_gene_expr_recon_loss: 2138548.0972; train_masked_gp_l1_reg_loss: 2475.0077; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97344397.3333; train_global_loss: 103285872.0000; train_optim_loss: 103285872.0000; val_kl_reg_loss: 148816.3125; val_edge_recon_loss: 4061190.7500; val_gene_expr_recon_loss: 2118412.5000; val_masked_gp_l1_reg_loss: 2459.1399; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97965224.0000; val_global_loss: 104296104.0000; val_optim_loss: 104296104.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8729; val_auprc_score: 0.8698; val_best_acc_score: 0.5962; val_best_f1_score: 0.7105; train_kl_reg_loss: 193262.9010; train_edge_recon_loss: 3606722.8333; train_gene_expr_recon_loss: 2121706.2778; train_masked_gp_l1_reg_loss: 2448.0867; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97052676.4444; train_global_loss: 102976816.0000; train_optim_loss: 102976816.0000; val_kl_reg_loss: 173991.1094; val_edge_recon_loss: 4059977.5000; val_gene_expr_recon_loss: 2107824.7500; val_masked_gp_l1_reg_loss: 2433.0972; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97656088.0000; val_global_loss: 104000312.0000; val_optim_loss: 104000312.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8847; val_auprc_score: 0.8802; val_best_acc_score: 0.6452; val_best_f1_score: 0.7352; train_kl_reg_loss: 204437.8819; train_edge_recon_loss: 3585547.1389; train_gene_expr_recon_loss: 2107244.6250; train_masked_gp_l1_reg_loss: 2422.9243; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96898045.3333; train_global_loss: 102797696.8889; train_optim_loss: 102797696.8889; val_kl_reg_loss: 144521.9688; val_edge_recon_loss: 4057468.5000; val_gene_expr_recon_loss: 2105050.5000; val_masked_gp_l1_reg_loss: 2410.2808; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97573840.0000; val_global_loss: 103883288.0000; val_optim_loss: 103883288.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8828; val_auprc_score: 0.8731; val_best_acc_score: 0.6757; val_best_f1_score: 0.7508; train_kl_reg_loss: 188141.3628; train_edge_recon_loss: 3603710.9722; train_gene_expr_recon_loss: 2116742.3750; train_masked_gp_l1_reg_loss: 2400.8774; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97188397.3333; train_global_loss: 103099392.8889; train_optim_loss: 103099392.8889; val_kl_reg_loss: 157188.5156; val_edge_recon_loss: 4055339.5000; val_gene_expr_recon_loss: 2098702.5000; val_masked_gp_l1_reg_loss: 2389.8989; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97532064.0000; val_global_loss: 103845688.0000; val_optim_loss: 103845688.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8899; val_auprc_score: 0.8763; val_best_acc_score: 0.7470; val_best_f1_score: 0.7909; train_kl_reg_loss: 198315.5677; train_edge_recon_loss: 3583888.7500; train_gene_expr_recon_loss: 2100796.2778; train_masked_gp_l1_reg_loss: 2382.8649; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96740733.3333; train_global_loss: 102626117.3333; train_optim_loss: 102626117.3333; val_kl_reg_loss: 162164.5000; val_edge_recon_loss: 4051141.5000; val_gene_expr_recon_loss: 2095824.6250; val_masked_gp_l1_reg_loss: 2373.5654; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97493576.0000; val_global_loss: 103805080.0000; val_optim_loss: 103805080.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8988; val_auprc_score: 0.8890; val_best_acc_score: 0.7943; val_best_f1_score: 0.8207; train_kl_reg_loss: 188039.8038; train_edge_recon_loss: 3584735.2778; train_gene_expr_recon_loss: 2100636.6667; train_masked_gp_l1_reg_loss: 2370.5787; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96767605.3333; train_global_loss: 102643386.6667; train_optim_loss: 102643386.6667; val_kl_reg_loss: 154261.1562; val_edge_recon_loss: 4044283.7500; val_gene_expr_recon_loss: 2093441.1250; val_masked_gp_l1_reg_loss: 2365.1658; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97454088.0000; val_global_loss: 103748440.0000; val_optim_loss: 103748440.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8972; val_auprc_score: 0.8813; val_best_acc_score: 0.8129; val_best_f1_score: 0.8299; train_kl_reg_loss: 186826.4288; train_edge_recon_loss: 3582673.7222; train_gene_expr_recon_loss: 2102524.3472; train_masked_gp_l1_reg_loss: 2359.9993; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97011904.0000; train_global_loss: 102886289.7778; train_optim_loss: 102886289.7778; val_kl_reg_loss: 154881.1250; val_edge_recon_loss: 4037363.5000; val_gene_expr_recon_loss: 2090020.6250; val_masked_gp_l1_reg_loss: 2354.0979; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97241912.0000; val_global_loss: 103526528.0000; val_optim_loss: 103526528.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8997; val_auprc_score: 0.8844; val_best_acc_score: 0.8215; val_best_f1_score: 0.8309; train_kl_reg_loss: 185756.8073; train_edge_recon_loss: 3575068.2778; train_gene_expr_recon_loss: 2106284.6389; train_masked_gp_l1_reg_loss: 2353.4912; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96343090.6667; train_global_loss: 102212553.7778; train_optim_loss: 102212553.7778; val_kl_reg_loss: 149552.2344; val_edge_recon_loss: 4025558.2500; val_gene_expr_recon_loss: 2087100.7500; val_masked_gp_l1_reg_loss: 2348.8286; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97216040.0000; val_global_loss: 103480600.0000; val_optim_loss: 103480600.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9039; val_auprc_score: 0.8838; val_best_acc_score: 0.8292; val_best_f1_score: 0.8310; train_kl_reg_loss: 180657.4010; train_edge_recon_loss: 3570837.8611; train_gene_expr_recon_loss: 2106103.3056; train_masked_gp_l1_reg_loss: 2347.1808; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96735473.7778; train_global_loss: 102595419.5556; train_optim_loss: 102595419.5556; val_kl_reg_loss: 172501.1562; val_edge_recon_loss: 4009617.0000; val_gene_expr_recon_loss: 2085205.5000; val_masked_gp_l1_reg_loss: 2342.1277; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97221288.0000; val_global_loss: 103490952.0000; val_optim_loss: 103490952.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9083; val_auprc_score: 0.8929; val_best_acc_score: 0.8193; val_best_f1_score: 0.8117; train_kl_reg_loss: 182735.9896; train_edge_recon_loss: 3560800.8611; train_gene_expr_recon_loss: 2108484.7222; train_masked_gp_l1_reg_loss: 2339.9840; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96641016.0000; train_global_loss: 102495377.7778; train_optim_loss: 102495377.7778; val_kl_reg_loss: 149612.0625; val_edge_recon_loss: 3988414.0000; val_gene_expr_recon_loss: 2081792.7500; val_masked_gp_l1_reg_loss: 2336.8728; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97018288.0000; val_global_loss: 103240448.0000; val_optim_loss: 103240448.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9086; val_auprc_score: 0.8881; val_best_acc_score: 0.8022; val_best_f1_score: 0.8207; train_kl_reg_loss: 170619.9323; train_edge_recon_loss: 3562882.1944; train_gene_expr_recon_loss: 2096465.5139; train_masked_gp_l1_reg_loss: 2335.8528; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96329216.0000; train_global_loss: 102161520.0000; train_optim_loss: 102161520.0000; val_kl_reg_loss: 150684.1250; val_edge_recon_loss: 3964156.5000; val_gene_expr_recon_loss: 2080221.5000; val_masked_gp_l1_reg_loss: 2333.9780; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96960312.0000; val_global_loss: 103157712.0000; val_optim_loss: 103157712.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9116; val_auprc_score: 0.8922; val_best_acc_score: 0.8092; val_best_f1_score: 0.8345; train_kl_reg_loss: 170749.8924; train_edge_recon_loss: 3549807.3611; train_gene_expr_recon_loss: 2085535.6667; train_masked_gp_l1_reg_loss: 2333.4667; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95990723.5556; train_global_loss: 101799149.3333; train_optim_loss: 101799149.3333; val_kl_reg_loss: 148560.3438; val_edge_recon_loss: 3925235.0000; val_gene_expr_recon_loss: 2074825.7500; val_masked_gp_l1_reg_loss: 2332.1365; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96662512.0000; val_global_loss: 102813464.0000; val_optim_loss: 102813464.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9147; val_auprc_score: 0.8948; val_best_acc_score: 0.8240; val_best_f1_score: 0.8425; train_kl_reg_loss: 166225.0104; train_edge_recon_loss: 3536651.9167; train_gene_expr_recon_loss: 2089249.7639; train_masked_gp_l1_reg_loss: 2331.8703; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96024263.1111; train_global_loss: 101818721.7778; train_optim_loss: 101818721.7778; val_kl_reg_loss: 139290.3750; val_edge_recon_loss: 3870404.0000; val_gene_expr_recon_loss: 2074326.6250; val_masked_gp_l1_reg_loss: 2329.9150; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96741192.0000; val_global_loss: 102827544.0000; val_optim_loss: 102827544.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9188; val_auprc_score: 0.9026; val_best_acc_score: 0.8281; val_best_f1_score: 0.8205; train_kl_reg_loss: 205541.6528; train_edge_recon_loss: 3681082.0000; train_gene_expr_recon_loss: 2087994.0139; train_masked_gp_l1_reg_loss: 2331.1994; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96036594.6667; train_global_loss: 102013544.0000; train_optim_loss: 102013544.0000; val_kl_reg_loss: 125911.3359; val_edge_recon_loss: 3958337.0000; val_gene_expr_recon_loss: 2075421.7500; val_masked_gp_l1_reg_loss: 2333.7864; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96579792.0000; val_global_loss: 102741792.0000; val_optim_loss: 102741792.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9196; val_auprc_score: 0.9020; val_best_acc_score: 0.8340; val_best_f1_score: 0.8280; train_kl_reg_loss: 174846.1892; train_edge_recon_loss: 3624969.0833; train_gene_expr_recon_loss: 2080951.4028; train_masked_gp_l1_reg_loss: 2339.1479; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95423846.2222; train_global_loss: 101306952.8889; train_optim_loss: 101306952.8889; val_kl_reg_loss: 120090.9688; val_edge_recon_loss: 3965339.7500; val_gene_expr_recon_loss: 2072690.7500; val_masked_gp_l1_reg_loss: 2345.8486; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96581472.0000; val_global_loss: 102741936.0000; val_optim_loss: 102741936.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9243; val_auprc_score: 0.9073; val_best_acc_score: 0.8426; val_best_f1_score: 0.8396; train_kl_reg_loss: 137657.3168; train_edge_recon_loss: 3735862.1667; train_gene_expr_recon_loss: 2096976.3611; train_masked_gp_l1_reg_loss: 2354.8472; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96448897.7778; train_global_loss: 102421747.5556; train_optim_loss: 102421747.5556; val_kl_reg_loss: 164618.9688; val_edge_recon_loss: 3964188.5000; val_gene_expr_recon_loss: 2079332.0000; val_masked_gp_l1_reg_loss: 2369.9343; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96626712.0000; val_global_loss: 102837224.0000; val_optim_loss: 102837224.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9198; val_auprc_score: 0.8989; val_best_acc_score: 0.8486; val_best_f1_score: 0.8524; train_kl_reg_loss: 106371.7161; train_edge_recon_loss: 3749955.7222; train_gene_expr_recon_loss: 2124024.9028; train_masked_gp_l1_reg_loss: 2384.3551; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96228098.6667; train_global_loss: 102210835.5556; train_optim_loss: 102210835.5556; val_kl_reg_loss: 101929.4688; val_edge_recon_loss: 3999072.0000; val_gene_expr_recon_loss: 2095016.2500; val_masked_gp_l1_reg_loss: 2401.1655; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96891488.0000; val_global_loss: 103089904.0000; val_optim_loss: 103089904.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9205; val_auprc_score: 0.9034; val_best_acc_score: 0.8456; val_best_f1_score: 0.8491; train_kl_reg_loss: 113932.3290; train_edge_recon_loss: 3745620.5000; train_gene_expr_recon_loss: 2106971.5139; train_masked_gp_l1_reg_loss: 2421.8102; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95617630.2222; train_global_loss: 101586576.8889; train_optim_loss: 101586576.8889; val_kl_reg_loss: 79230.0859; val_edge_recon_loss: 4002948.0000; val_gene_expr_recon_loss: 2080203.0000; val_masked_gp_l1_reg_loss: 2444.7083; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96689440.0000; val_global_loss: 102854264.0000; val_optim_loss: 102854264.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9185; val_auprc_score: 0.8914; val_best_acc_score: 0.8471; val_best_f1_score: 0.8498; train_kl_reg_loss: 97439.7509; train_edge_recon_loss: 3714359.5833; train_gene_expr_recon_loss: 2101091.9306; train_masked_gp_l1_reg_loss: 2445.4895; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96033071.1111; train_global_loss: 101948408.0000; train_optim_loss: 101948408.0000; val_kl_reg_loss: 100516.7344; val_edge_recon_loss: 4001430.2500; val_gene_expr_recon_loss: 2076696.0000; val_masked_gp_l1_reg_loss: 2445.8474; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96632832.0000; val_global_loss: 102813920.0000; val_optim_loss: 102813920.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9154; val_auprc_score: 0.8933; val_best_acc_score: 0.8422; val_best_f1_score: 0.8446; train_kl_reg_loss: 107226.3559; train_edge_recon_loss: 3687617.2222; train_gene_expr_recon_loss: 2096259.6944; train_masked_gp_l1_reg_loss: 2445.7107; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95733653.3333; train_global_loss: 101627200.8889; train_optim_loss: 101627200.8889; val_kl_reg_loss: 97522.0781; val_edge_recon_loss: 3997819.2500; val_gene_expr_recon_loss: 2075059.0000; val_masked_gp_l1_reg_loss: 2445.3267; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96663760.0000; val_global_loss: 102836608.0000; val_optim_loss: 102836608.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9223; val_auprc_score: 0.9015; val_best_acc_score: 0.8461; val_best_f1_score: 0.8472; train_kl_reg_loss: 115104.6458; train_edge_recon_loss: 3683387.5556; train_gene_expr_recon_loss: 2093819.8889; train_masked_gp_l1_reg_loss: 2445.1312; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96255571.5556; train_global_loss: 102150328.8889; train_optim_loss: 102150328.8889; val_kl_reg_loss: 109287.5391; val_edge_recon_loss: 3991697.7500; val_gene_expr_recon_loss: 2074041.5000; val_masked_gp_l1_reg_loss: 2444.8611; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96535584.0000; val_global_loss: 102713056.0000; val_optim_loss: 102713056.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9182; val_auprc_score: 0.8984; val_best_acc_score: 0.8409; val_best_f1_score: 0.8414; train_kl_reg_loss: 116556.8941; train_edge_recon_loss: 3672950.2500; train_gene_expr_recon_loss: 2087781.3056; train_masked_gp_l1_reg_loss: 2444.4364; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95469966.2222; train_global_loss: 101349697.7778; train_optim_loss: 101349697.7778; val_kl_reg_loss: 106819.9531; val_edge_recon_loss: 3988242.2500; val_gene_expr_recon_loss: 2070939.0000; val_masked_gp_l1_reg_loss: 2443.8162; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96534112.0000; val_global_loss: 102702560.0000; val_optim_loss: 102702560.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9190; val_auprc_score: 0.8952; val_best_acc_score: 0.8424; val_best_f1_score: 0.8417; train_kl_reg_loss: 119623.2387; train_edge_recon_loss: 3658783.9167; train_gene_expr_recon_loss: 2077161.9722; train_masked_gp_l1_reg_loss: 2443.2377; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95361527.1111; train_global_loss: 101219538.6667; train_optim_loss: 101219538.6667; val_kl_reg_loss: 109015.7031; val_edge_recon_loss: 3982380.0000; val_gene_expr_recon_loss: 2069920.7500; val_masked_gp_l1_reg_loss: 2442.4854; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96481920.0000; val_global_loss: 102645680.0000; val_optim_loss: 102645680.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9116; val_auprc_score: 0.8858; val_best_acc_score: 0.8332; val_best_f1_score: 0.8326; train_kl_reg_loss: 117268.5660; train_edge_recon_loss: 3651149.0833; train_gene_expr_recon_loss: 2085122.5139; train_masked_gp_l1_reg_loss: 2441.7900; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95925702.2222; train_global_loss: 101781685.3333; train_optim_loss: 101781685.3333; val_kl_reg_loss: 108156.3750; val_edge_recon_loss: 3979310.5000; val_gene_expr_recon_loss: 2068593.2500; val_masked_gp_l1_reg_loss: 2440.9558; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96548512.0000; val_global_loss: 102707016.0000; val_optim_loss: 102707016.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9177; val_auprc_score: 0.8960; val_best_acc_score: 0.8343; val_best_f1_score: 0.8320; train_kl_reg_loss: 115863.9809; train_edge_recon_loss: 3648053.8611; train_gene_expr_recon_loss: 2082249.2917; train_masked_gp_l1_reg_loss: 2440.3356; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96103493.3333; train_global_loss: 101952101.3333; train_optim_loss: 101952101.3333; val_kl_reg_loss: 102877.1719; val_edge_recon_loss: 3973134.5000; val_gene_expr_recon_loss: 2070028.6250; val_masked_gp_l1_reg_loss: 2439.6094; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96483264.0000; val_global_loss: 102631744.0000; val_optim_loss: 102631744.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9165; val_auprc_score: 0.8950; val_best_acc_score: 0.8331; val_best_f1_score: 0.8298; train_kl_reg_loss: 109976.4531; train_edge_recon_loss: 3648606.7778; train_gene_expr_recon_loss: 2078195.5278; train_masked_gp_l1_reg_loss: 2439.2414; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95757233.7778; train_global_loss: 101596450.6667; train_optim_loss: 101596450.6667; val_kl_reg_loss: 104776.8750; val_edge_recon_loss: 3971918.7500; val_gene_expr_recon_loss: 2068708.0000; val_masked_gp_l1_reg_loss: 2438.8977; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96512344.0000; val_global_loss: 102660184.0000; val_optim_loss: 102660184.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9134; val_auprc_score: 0.8867; val_best_acc_score: 0.8341; val_best_f1_score: 0.8305; train_kl_reg_loss: 122278.9401; train_edge_recon_loss: 3633316.5556; train_gene_expr_recon_loss: 2079830.1250; train_masked_gp_l1_reg_loss: 2438.6128; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95718216.0000; train_global_loss: 101556080.0000; train_optim_loss: 101556080.0000; val_kl_reg_loss: 114257.1562; val_edge_recon_loss: 3968453.5000; val_gene_expr_recon_loss: 2067894.5000; val_masked_gp_l1_reg_loss: 2438.2424; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96432704.0000; val_global_loss: 102585744.0000; val_optim_loss: 102585744.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9204; val_auprc_score: 0.9013; val_best_acc_score: 0.8344; val_best_f1_score: 0.8294; train_kl_reg_loss: 124668.7474; train_edge_recon_loss: 3624237.2222; train_gene_expr_recon_loss: 2073704.3750; train_masked_gp_l1_reg_loss: 2437.9072; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95599569.7778; train_global_loss: 101424619.5556; train_optim_loss: 101424619.5556; val_kl_reg_loss: 111416.2344; val_edge_recon_loss: 3965715.7500; val_gene_expr_recon_loss: 2069012.1250; val_masked_gp_l1_reg_loss: 2437.4011; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96529168.0000; val_global_loss: 102677752.0000; val_optim_loss: 102677752.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9161; val_auprc_score: 0.8926; val_best_acc_score: 0.8288; val_best_f1_score: 0.8236; train_kl_reg_loss: 122513.4497; train_edge_recon_loss: 3633387.0833; train_gene_expr_recon_loss: 2086869.1528; train_masked_gp_l1_reg_loss: 2437.0367; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95775667.5556; train_global_loss: 101620873.7778; train_optim_loss: 101620873.7778; val_kl_reg_loss: 114753.6875; val_edge_recon_loss: 3958996.2500; val_gene_expr_recon_loss: 2065127.0000; val_masked_gp_l1_reg_loss: 2436.4524; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96354760.0000; val_global_loss: 102496072.0000; val_optim_loss: 102496072.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9149; val_auprc_score: 0.8925; val_best_acc_score: 0.8266; val_best_f1_score: 0.8224; train_kl_reg_loss: 126486.5851; train_edge_recon_loss: 3622245.1111; train_gene_expr_recon_loss: 2090506.3056; train_masked_gp_l1_reg_loss: 2435.8203; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95780072.8889; train_global_loss: 101621746.6667; train_optim_loss: 101621746.6667; val_kl_reg_loss: 116985.9375; val_edge_recon_loss: 3956979.7500; val_gene_expr_recon_loss: 2068628.8750; val_masked_gp_l1_reg_loss: 2435.0198; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96504632.0000; val_global_loss: 102649664.0000; val_optim_loss: 102649664.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9148; val_auprc_score: 0.8951; val_best_acc_score: 0.8252; val_best_f1_score: 0.8244; train_kl_reg_loss: 127357.6580; train_edge_recon_loss: 3622811.9444; train_gene_expr_recon_loss: 2099488.1944; train_masked_gp_l1_reg_loss: 2434.3565; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95549584.0000; train_global_loss: 101401676.4444; train_optim_loss: 101401676.4444; val_kl_reg_loss: 116238.4062; val_edge_recon_loss: 3952827.5000; val_gene_expr_recon_loss: 2066085.7500; val_masked_gp_l1_reg_loss: 2433.5681; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96378240.0000; val_global_loss: 102515824.0000; val_optim_loss: 102515824.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9180; val_auprc_score: 0.8971; val_best_acc_score: 0.8270; val_best_f1_score: 0.8281; train_kl_reg_loss: 123726.3464; train_edge_recon_loss: 3622618.8056; train_gene_expr_recon_loss: 2087022.0139; train_masked_gp_l1_reg_loss: 2433.2202; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96108278.2222; train_global_loss: 101944079.1111; train_optim_loss: 101944079.1111; val_kl_reg_loss: 112979.9062; val_edge_recon_loss: 3948931.7500; val_gene_expr_recon_loss: 2068118.0000; val_masked_gp_l1_reg_loss: 2432.6592; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96608464.0000; val_global_loss: 102740928.0000; val_optim_loss: 102740928.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9183; val_auprc_score: 0.8970; val_best_acc_score: 0.8275; val_best_f1_score: 0.8280; train_kl_reg_loss: 129552.7917; train_edge_recon_loss: 3610073.6944; train_gene_expr_recon_loss: 2076863.8611; train_masked_gp_l1_reg_loss: 2432.0242; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95638317.3333; train_global_loss: 101457240.8889; train_optim_loss: 101457240.8889; val_kl_reg_loss: 124394.2188; val_edge_recon_loss: 3945989.2500; val_gene_expr_recon_loss: 2067595.5000; val_masked_gp_l1_reg_loss: 2431.1399; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96487176.0000; val_global_loss: 102627584.0000; val_optim_loss: 102627584.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9183; val_auprc_score: 0.8979; val_best_acc_score: 0.8239; val_best_f1_score: 0.8279; train_kl_reg_loss: 135493.9635; train_edge_recon_loss: 3604629.2500; train_gene_expr_recon_loss: 2091720.1806; train_masked_gp_l1_reg_loss: 2430.9989; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95663034.6667; train_global_loss: 101497308.4444; train_optim_loss: 101497308.4444; val_kl_reg_loss: 121784.0000; val_edge_recon_loss: 3945340.5000; val_gene_expr_recon_loss: 2065987.2500; val_masked_gp_l1_reg_loss: 2430.8257; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96296760.0000; val_global_loss: 102432304.0000; val_optim_loss: 102432304.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9231; val_auprc_score: 0.9038; val_best_acc_score: 0.8308; val_best_f1_score: 0.8320; train_kl_reg_loss: 134428.8030; train_edge_recon_loss: 3598283.0833; train_gene_expr_recon_loss: 2067492.0694; train_masked_gp_l1_reg_loss: 2430.6904; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95628212.4444; train_global_loss: 101430845.3333; train_optim_loss: 101430845.3333; val_kl_reg_loss: 121733.4297; val_edge_recon_loss: 3943559.5000; val_gene_expr_recon_loss: 2066865.0000; val_masked_gp_l1_reg_loss: 2430.5227; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96464104.0000; val_global_loss: 102598696.0000; val_optim_loss: 102598696.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9185; val_auprc_score: 0.8999; val_best_acc_score: 0.8266; val_best_f1_score: 0.8244; train_kl_reg_loss: 132045.9887; train_edge_recon_loss: 3607274.1667; train_gene_expr_recon_loss: 2076595.9861; train_masked_gp_l1_reg_loss: 2430.3920; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95902608.8889; train_global_loss: 101720954.6667; train_optim_loss: 101720954.6667; val_kl_reg_loss: 120270.8125; val_edge_recon_loss: 3945336.7500; val_gene_expr_recon_loss: 2067020.7500; val_masked_gp_l1_reg_loss: 2430.2356; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96480576.0000; val_global_loss: 102615632.0000; val_optim_loss: 102615632.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9156; val_auprc_score: 0.8904; val_best_acc_score: 0.8242; val_best_f1_score: 0.8288; train_kl_reg_loss: 130661.2622; train_edge_recon_loss: 3605120.4444; train_gene_expr_recon_loss: 2077732.3472; train_masked_gp_l1_reg_loss: 2430.1139; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96111355.5556; train_global_loss: 101927299.5556; train_optim_loss: 101927299.5556; val_kl_reg_loss: 119337.7031; val_edge_recon_loss: 3944652.5000; val_gene_expr_recon_loss: 2064379.6250; val_masked_gp_l1_reg_loss: 2429.9678; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96328920.0000; val_global_loss: 102459720.0000; val_optim_loss: 102459720.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9129; val_auprc_score: 0.8861; val_best_acc_score: 0.8228; val_best_f1_score: 0.8293; train_kl_reg_loss: 131144.5929; train_edge_recon_loss: 3603618.6944; train_gene_expr_recon_loss: 2066700.2500; train_masked_gp_l1_reg_loss: 2429.8619; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95418685.3333; train_global_loss: 101222580.4444; train_optim_loss: 101222580.4444; val_kl_reg_loss: 118677.8906; val_edge_recon_loss: 3945378.7500; val_gene_expr_recon_loss: 2065201.3750; val_masked_gp_l1_reg_loss: 2429.7300; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96329576.0000; val_global_loss: 102461264.0000; val_optim_loss: 102461264.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9145; val_auprc_score: 0.8876; val_best_acc_score: 0.8267; val_best_f1_score: 0.8245; train_kl_reg_loss: 132052.3967; train_edge_recon_loss: 3604297.8611; train_gene_expr_recon_loss: 2092050.9722; train_masked_gp_l1_reg_loss: 2429.7145; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95964484.4444; train_global_loss: 101795314.6667; train_optim_loss: 101795314.6667; val_kl_reg_loss: 120294.6250; val_edge_recon_loss: 3947031.5000; val_gene_expr_recon_loss: 2064871.2500; val_masked_gp_l1_reg_loss: 2429.6968; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96303896.0000; val_global_loss: 102438520.0000; val_optim_loss: 102438520.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9189; val_auprc_score: 0.8996; val_best_acc_score: 0.8252; val_best_f1_score: 0.8289; train_kl_reg_loss: 131773.1693; train_edge_recon_loss: 3602586.4444; train_gene_expr_recon_loss: 2084263.0556; train_masked_gp_l1_reg_loss: 2429.6857; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95580380.4444; train_global_loss: 101401432.8889; train_optim_loss: 101401432.8889; val_kl_reg_loss: 118536.1875; val_edge_recon_loss: 3943954.5000; val_gene_expr_recon_loss: 2064209.1250; val_masked_gp_l1_reg_loss: 2429.6707; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96258144.0000; val_global_loss: 102387272.0000; val_optim_loss: 102387272.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9142; val_auprc_score: 0.8908; val_best_acc_score: 0.8217; val_best_f1_score: 0.8283; train_kl_reg_loss: 132211.8307; train_edge_recon_loss: 3599960.6667; train_gene_expr_recon_loss: 2075198.2639; train_masked_gp_l1_reg_loss: 2429.6580; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95898451.5556; train_global_loss: 101708253.3333; train_optim_loss: 101708253.3333; val_kl_reg_loss: 120404.1172; val_edge_recon_loss: 3944441.5000; val_gene_expr_recon_loss: 2065092.0000; val_masked_gp_l1_reg_loss: 2429.6423; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96270040.0000; val_global_loss: 102402408.0000; val_optim_loss: 102402408.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9189; val_auprc_score: 0.8984; val_best_acc_score: 0.8271; val_best_f1_score: 0.8306; train_kl_reg_loss: 132620.0451; train_edge_recon_loss: 3601951.3056; train_gene_expr_recon_loss: 2100970.8472; train_masked_gp_l1_reg_loss: 2429.6301; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95494887.1111; train_global_loss: 101332857.7778; train_optim_loss: 101332857.7778; val_kl_reg_loss: 119015.4219; val_edge_recon_loss: 3946136.0000; val_gene_expr_recon_loss: 2064415.2500; val_masked_gp_l1_reg_loss: 2429.6152; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96276848.0000; val_global_loss: 102408848.0000; val_optim_loss: 102408848.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9165; val_auprc_score: 0.8920; val_best_acc_score: 0.8277; val_best_f1_score: 0.8278; train_kl_reg_loss: 132436.1250; train_edge_recon_loss: 3603726.6667; train_gene_expr_recon_loss: 2076834.4306; train_masked_gp_l1_reg_loss: 2429.6041; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94790177.7778; train_global_loss: 100605605.3333; train_optim_loss: 100605605.3333; val_kl_reg_loss: 118978.6719; val_edge_recon_loss: 3945497.7500; val_gene_expr_recon_loss: 2066369.3750; val_masked_gp_l1_reg_loss: 2429.5898; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96368224.0000; val_global_loss: 102501496.0000; val_optim_loss: 102501496.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9186; val_auprc_score: 0.9013; val_best_acc_score: 0.8240; val_best_f1_score: 0.8284; train_kl_reg_loss: 132310.7335; train_edge_recon_loss: 3603770.3611; train_gene_expr_recon_loss: 2068679.3333; train_masked_gp_l1_reg_loss: 2429.5783; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 94853647.1111; train_global_loss: 100660836.4444; train_optim_loss: 100660836.4444; val_kl_reg_loss: 118490.6562; val_edge_recon_loss: 3945482.7500; val_gene_expr_recon_loss: 2063928.7500; val_masked_gp_l1_reg_loss: 2429.5635; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96262328.0000; val_global_loss: 102392656.0000; val_optim_loss: 102392656.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9192; val_auprc_score: 0.9004; val_best_acc_score: 0.8258; val_best_f1_score: 0.8290; train_kl_reg_loss: 132072.7057; train_edge_recon_loss: 3604274.8056; train_gene_expr_recon_loss: 2067304.2361; train_masked_gp_l1_reg_loss: 2429.5619; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95171275.5556; train_global_loss: 100977356.4444; train_optim_loss: 100977356.4444; val_kl_reg_loss: 120443.7969; val_edge_recon_loss: 3945224.2500; val_gene_expr_recon_loss: 2066503.3750; val_masked_gp_l1_reg_loss: 2429.5601; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96456616.0000; val_global_loss: 102591216.0000; val_optim_loss: 102591216.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9147; val_auprc_score: 0.8900; val_best_acc_score: 0.8250; val_best_f1_score: 0.8258; train_kl_reg_loss: 130926.4965; train_edge_recon_loss: 3600845.8889; train_gene_expr_recon_loss: 2078656.5833; train_masked_gp_l1_reg_loss: 2429.5589; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95604775.1111; train_global_loss: 101417633.7778; train_optim_loss: 101417633.7778; val_kl_reg_loss: 119494.2031; val_edge_recon_loss: 3945933.5000; val_gene_expr_recon_loss: 2066456.1250; val_masked_gp_l1_reg_loss: 2429.5571; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96339048.0000; val_global_loss: 102473360.0000; val_optim_loss: 102473360.0000
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9114; val_auprc_score: 0.8864; val_best_acc_score: 0.8230; val_best_f1_score: 0.8252; train_kl_reg_loss: 131741.8481; train_edge_recon_loss: 3604821.0278; train_gene_expr_recon_loss: 2084967.1111; train_masked_gp_l1_reg_loss: 2429.5562; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95792317.3333; train_global_loss: 101616276.4444; train_optim_loss: 101616276.4444; val_kl_reg_loss: 119499.9375; val_edge_recon_loss: 3948693.2500; val_gene_expr_recon_loss: 2065679.5000; val_masked_gp_l1_reg_loss: 2429.5547; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96419680.0000; val_global_loss: 102555984.0000; val_optim_loss: 102555984.0000
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9148; val_auprc_score: 0.8912; val_best_acc_score: 0.8251; val_best_f1_score: 0.8264; train_kl_reg_loss: 131009.1936; train_edge_recon_loss: 3601175.3056; train_gene_expr_recon_loss: 2086049.0556; train_masked_gp_l1_reg_loss: 2429.5535; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95473159.1111; train_global_loss: 101293822.2222; train_optim_loss: 101293822.2222; val_kl_reg_loss: 120017.8281; val_edge_recon_loss: 3946265.5000; val_gene_expr_recon_loss: 2064966.3750; val_masked_gp_l1_reg_loss: 2429.5522; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96345664.0000; val_global_loss: 102479344.0000; val_optim_loss: 102479344.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 2 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
Val AUROC score: 0.9158
Val AUPRC score: 0.8886
Val best accuracy score: 0.8259
Val best F1 score: 0.8310
Val gene expr MSE score: 0.4464
Val chrom access MSE score: 0.0869
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
