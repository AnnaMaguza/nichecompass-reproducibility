[True]
Run timestamp: 26072023_011850_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8830; val_auprc_score: 0.9017; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 103107720.0544; train_edge_recon_loss: 356074.1111; train_gene_expr_recon_loss: 339039.1875; train_masked_gp_l1_reg_loss: 1688.1105; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 118545926.2222; train_global_loss: 222350453.3333; train_optim_loss: 222350453.3333; val_kl_reg_loss: 2455171.5000; val_edge_recon_loss: 406623.5938; val_gene_expr_recon_loss: 299493.7812; val_masked_gp_l1_reg_loss: 1629.1974; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 104976888.0000; val_global_loss: 108139808.0000; val_optim_loss: 108139808.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8893; val_auprc_score: 0.8995; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 443770.5356; train_edge_recon_loss: 389282.9236; train_gene_expr_recon_loss: 310555.6319; train_masked_gp_l1_reg_loss: 1689.4145; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 116425880.0000; train_global_loss: 117571178.6667; train_optim_loss: 117571178.6667; val_kl_reg_loss: 123974.9062; val_edge_recon_loss: 406627.3438; val_gene_expr_recon_loss: 268983.1875; val_masked_gp_l1_reg_loss: 1775.4568; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 102752608.0000; val_global_loss: 103553968.0000; val_optim_loss: 103553968.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8877; val_auprc_score: 0.8967; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 147114.4635; train_edge_recon_loss: 404862.5833; train_gene_expr_recon_loss: 260361.3542; train_masked_gp_l1_reg_loss: 1835.9772; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 104057581.3333; train_global_loss: 104871755.5556; train_optim_loss: 104871755.5556; val_kl_reg_loss: 200397.2969; val_edge_recon_loss: 406627.0625; val_gene_expr_recon_loss: 251937.0469; val_masked_gp_l1_reg_loss: 1896.9617; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 101032152.0000; val_global_loss: 101893008.0000; val_optim_loss: 101893008.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8769; val_auprc_score: 0.8849; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 190314.8368; train_edge_recon_loss: 405899.1944; train_gene_expr_recon_loss: 248980.2135; train_masked_gp_l1_reg_loss: 1914.5183; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102155754.6667; train_global_loss: 103002863.1111; train_optim_loss: 103002863.1111; val_kl_reg_loss: 189853.4375; val_edge_recon_loss: 406623.5312; val_gene_expr_recon_loss: 242495.0469; val_masked_gp_l1_reg_loss: 1916.0217; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99759208.0000; val_global_loss: 100600096.0000; val_optim_loss: 100600096.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8442; val_auprc_score: 0.8471; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 201219.7049; train_edge_recon_loss: 406087.1042; train_gene_expr_recon_loss: 239904.7222; train_masked_gp_l1_reg_loss: 1897.0358; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100671908.4444; train_global_loss: 101521017.7778; train_optim_loss: 101521017.7778; val_kl_reg_loss: 197277.8438; val_edge_recon_loss: 406609.1250; val_gene_expr_recon_loss: 235845.8125; val_masked_gp_l1_reg_loss: 1866.0193; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98862720.0000; val_global_loss: 99704320.0000; val_optim_loss: 99704320.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8186; val_auprc_score: 0.8188; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 205372.8490; train_edge_recon_loss: 405982.5868; train_gene_expr_recon_loss: 233883.8160; train_masked_gp_l1_reg_loss: 1835.2715; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 100048878.2222; train_global_loss: 100895952.0000; train_optim_loss: 100895952.0000; val_kl_reg_loss: 204228.7656; val_edge_recon_loss: 406590.6562; val_gene_expr_recon_loss: 230482.7031; val_masked_gp_l1_reg_loss: 1792.2390; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98408216.0000; val_global_loss: 99251312.0000; val_optim_loss: 99251312.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8076; val_auprc_score: 0.8048; val_best_acc_score: 0.5104; val_best_f1_score: 0.6713; train_kl_reg_loss: 214874.6111; train_edge_recon_loss: 405781.8611; train_gene_expr_recon_loss: 228613.1562; train_masked_gp_l1_reg_loss: 1756.4038; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99843017.7778; train_global_loss: 100694043.5556; train_optim_loss: 100694043.5556; val_kl_reg_loss: 209721.8125; val_edge_recon_loss: 406526.7500; val_gene_expr_recon_loss: 226245.9531; val_masked_gp_l1_reg_loss: 1709.5209; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98028008.0000; val_global_loss: 98872208.0000; val_optim_loss: 98872208.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8124; val_auprc_score: 0.8072; val_best_acc_score: 0.5259; val_best_f1_score: 0.6782; train_kl_reg_loss: 218339.6406; train_edge_recon_loss: 405288.4792; train_gene_expr_recon_loss: 225078.0903; train_masked_gp_l1_reg_loss: 1675.9233; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99588887.1111; train_global_loss: 100439271.1111; train_optim_loss: 100439271.1111; val_kl_reg_loss: 212869.2812; val_edge_recon_loss: 406402.8438; val_gene_expr_recon_loss: 222283.9375; val_masked_gp_l1_reg_loss: 1635.8917; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97576096.0000; val_global_loss: 98419288.0000; val_optim_loss: 98419288.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8290; val_auprc_score: 0.8170; val_best_acc_score: 0.5461; val_best_f1_score: 0.6860; train_kl_reg_loss: 222079.5330; train_edge_recon_loss: 404897.4549; train_gene_expr_recon_loss: 221008.9410; train_masked_gp_l1_reg_loss: 1611.5047; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98772544.0000; train_global_loss: 99622140.4444; train_optim_loss: 99622140.4444; val_kl_reg_loss: 214612.2656; val_edge_recon_loss: 406135.7812; val_gene_expr_recon_loss: 219712.7031; val_masked_gp_l1_reg_loss: 1579.2136; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97197944.0000; val_global_loss: 98039984.0000; val_optim_loss: 98039984.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8330; val_auprc_score: 0.8203; val_best_acc_score: 0.5781; val_best_f1_score: 0.6997; train_kl_reg_loss: 214374.0208; train_edge_recon_loss: 404735.9896; train_gene_expr_recon_loss: 217274.2448; train_masked_gp_l1_reg_loss: 1556.9139; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98002495.1111; train_global_loss: 98840436.4444; train_optim_loss: 98840436.4444; val_kl_reg_loss: 207601.0625; val_edge_recon_loss: 405830.9062; val_gene_expr_recon_loss: 217657.1094; val_masked_gp_l1_reg_loss: 1527.7078; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97055064.0000; val_global_loss: 97887680.0000; val_optim_loss: 97887680.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8202; val_auprc_score: 0.8043; val_best_acc_score: 0.6203; val_best_f1_score: 0.7192; train_kl_reg_loss: 214897.3472; train_edge_recon_loss: 404479.4410; train_gene_expr_recon_loss: 216795.8628; train_masked_gp_l1_reg_loss: 1509.5926; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97616683.5556; train_global_loss: 98454366.2222; train_optim_loss: 98454366.2222; val_kl_reg_loss: 201820.8906; val_edge_recon_loss: 405434.5625; val_gene_expr_recon_loss: 215963.9688; val_masked_gp_l1_reg_loss: 1484.0857; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96623904.0000; val_global_loss: 97448608.0000; val_optim_loss: 97448608.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8005; val_auprc_score: 0.7872; val_best_acc_score: 0.6439; val_best_f1_score: 0.7291; train_kl_reg_loss: 208641.8785; train_edge_recon_loss: 404354.4479; train_gene_expr_recon_loss: 215517.1719; train_masked_gp_l1_reg_loss: 1467.6270; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97952788.4444; train_global_loss: 98782770.6667; train_optim_loss: 98782770.6667; val_kl_reg_loss: 191827.1406; val_edge_recon_loss: 405185.6875; val_gene_expr_recon_loss: 214941.8281; val_masked_gp_l1_reg_loss: 1447.2748; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96378856.0000; val_global_loss: 97192256.0000; val_optim_loss: 97192256.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7967; val_auprc_score: 0.7843; val_best_acc_score: 0.6652; val_best_f1_score: 0.7371; train_kl_reg_loss: 200951.8420; train_edge_recon_loss: 404011.7708; train_gene_expr_recon_loss: 214006.4635; train_masked_gp_l1_reg_loss: 1432.9156; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97621680.8889; train_global_loss: 98442084.4444; train_optim_loss: 98442084.4444; val_kl_reg_loss: 186393.5938; val_edge_recon_loss: 404697.3125; val_gene_expr_recon_loss: 214376.9688; val_masked_gp_l1_reg_loss: 1415.8152; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96438160.0000; val_global_loss: 97245040.0000; val_optim_loss: 97245040.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8026; val_auprc_score: 0.7959; val_best_acc_score: 0.6836; val_best_f1_score: 0.7443; train_kl_reg_loss: 196909.2760; train_edge_recon_loss: 403495.9097; train_gene_expr_recon_loss: 213804.6181; train_masked_gp_l1_reg_loss: 1404.6682; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97373523.5556; train_global_loss: 98189136.8889; train_optim_loss: 98189136.8889; val_kl_reg_loss: 181318.3281; val_edge_recon_loss: 404178.3438; val_gene_expr_recon_loss: 213835.9531; val_masked_gp_l1_reg_loss: 1388.0421; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96160360.0000; val_global_loss: 96961080.0000; val_optim_loss: 96961080.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8053; val_auprc_score: 0.7995; val_best_acc_score: 0.7012; val_best_f1_score: 0.7515; train_kl_reg_loss: 189728.3976; train_edge_recon_loss: 403232.6458; train_gene_expr_recon_loss: 211904.5851; train_masked_gp_l1_reg_loss: 1379.0445; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97209420.4444; train_global_loss: 98015663.1111; train_optim_loss: 98015663.1111; val_kl_reg_loss: 172869.2188; val_edge_recon_loss: 404002.9062; val_gene_expr_recon_loss: 213297.7344; val_masked_gp_l1_reg_loss: 1364.5104; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96141592.0000; val_global_loss: 96933128.0000; val_optim_loss: 96933128.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8005; val_auprc_score: 0.7949; val_best_acc_score: 0.7010; val_best_f1_score: 0.7483; train_kl_reg_loss: 183433.1562; train_edge_recon_loss: 402778.2361; train_gene_expr_recon_loss: 213822.3628; train_masked_gp_l1_reg_loss: 1354.6635; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97272702.2222; train_global_loss: 98074091.5556; train_optim_loss: 98074091.5556; val_kl_reg_loss: 169416.5469; val_edge_recon_loss: 403714.3125; val_gene_expr_recon_loss: 212326.3906; val_masked_gp_l1_reg_loss: 1342.7297; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95905592.0000; val_global_loss: 96692392.0000; val_optim_loss: 96692392.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8143; val_auprc_score: 0.8088; val_best_acc_score: 0.7133; val_best_f1_score: 0.7525; train_kl_reg_loss: 177397.3507; train_edge_recon_loss: 402280.9618; train_gene_expr_recon_loss: 211544.0226; train_masked_gp_l1_reg_loss: 1336.1244; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97029358.2222; train_global_loss: 97821916.4444; train_optim_loss: 97821916.4444; val_kl_reg_loss: 163023.5000; val_edge_recon_loss: 403498.2500; val_gene_expr_recon_loss: 211986.6875; val_masked_gp_l1_reg_loss: 1325.6272; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95812976.0000; val_global_loss: 96592808.0000; val_optim_loss: 96592808.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8199; val_auprc_score: 0.8162; val_best_acc_score: 0.7193; val_best_f1_score: 0.7538; train_kl_reg_loss: 173386.7778; train_edge_recon_loss: 401830.6354; train_gene_expr_recon_loss: 212391.3993; train_masked_gp_l1_reg_loss: 1319.7028; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97055261.3333; train_global_loss: 97844189.3333; train_optim_loss: 97844189.3333; val_kl_reg_loss: 159169.0781; val_edge_recon_loss: 403105.1562; val_gene_expr_recon_loss: 211780.1875; val_masked_gp_l1_reg_loss: 1310.0585; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95654744.0000; val_global_loss: 96430112.0000; val_optim_loss: 96430112.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8310; val_auprc_score: 0.8307; val_best_acc_score: 0.7359; val_best_f1_score: 0.7629; train_kl_reg_loss: 167797.7031; train_edge_recon_loss: 401432.2812; train_gene_expr_recon_loss: 210753.8698; train_masked_gp_l1_reg_loss: 1304.6497; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97002597.3333; train_global_loss: 97783885.3333; train_optim_loss: 97783885.3333; val_kl_reg_loss: 156205.9688; val_edge_recon_loss: 402934.0000; val_gene_expr_recon_loss: 211101.0156; val_masked_gp_l1_reg_loss: 1295.9360; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95437576.0000; val_global_loss: 96209112.0000; val_optim_loss: 96209112.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8399; val_auprc_score: 0.8314; val_best_acc_score: 0.7553; val_best_f1_score: 0.7741; train_kl_reg_loss: 163280.0920; train_edge_recon_loss: 401082.4340; train_gene_expr_recon_loss: 211648.6910; train_masked_gp_l1_reg_loss: 1292.9503; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97022792.0000; train_global_loss: 97800095.1111; train_optim_loss: 97800095.1111; val_kl_reg_loss: 150755.0625; val_edge_recon_loss: 402651.1562; val_gene_expr_recon_loss: 210939.9219; val_masked_gp_l1_reg_loss: 1287.6080; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95499208.0000; val_global_loss: 96264840.0000; val_optim_loss: 96264840.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8578; val_auprc_score: 0.8503; val_best_acc_score: 0.7750; val_best_f1_score: 0.7861; train_kl_reg_loss: 158878.9861; train_edge_recon_loss: 400883.4479; train_gene_expr_recon_loss: 211105.8385; train_masked_gp_l1_reg_loss: 1284.6583; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96899636.4444; train_global_loss: 97671790.2222; train_optim_loss: 97671790.2222; val_kl_reg_loss: 146176.4375; val_edge_recon_loss: 402186.9062; val_gene_expr_recon_loss: 210725.5312; val_masked_gp_l1_reg_loss: 1280.0450; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95364248.0000; val_global_loss: 96124616.0000; val_optim_loss: 96124616.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8611; val_auprc_score: 0.8530; val_best_acc_score: 0.7815; val_best_f1_score: 0.7885; train_kl_reg_loss: 154727.6128; train_edge_recon_loss: 400389.1319; train_gene_expr_recon_loss: 210813.1667; train_masked_gp_l1_reg_loss: 1277.2249; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96547770.6667; train_global_loss: 97314977.7778; train_optim_loss: 97314977.7778; val_kl_reg_loss: 143319.6562; val_edge_recon_loss: 401907.5625; val_gene_expr_recon_loss: 210310.7812; val_masked_gp_l1_reg_loss: 1271.9440; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95181888.0000; val_global_loss: 95938696.0000; val_optim_loss: 95938696.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8722; val_auprc_score: 0.8634; val_best_acc_score: 0.7960; val_best_f1_score: 0.7973; train_kl_reg_loss: 151841.2240; train_edge_recon_loss: 400179.9306; train_gene_expr_recon_loss: 210769.1424; train_masked_gp_l1_reg_loss: 1268.6326; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96698688.0000; train_global_loss: 97462746.6667; train_optim_loss: 97462746.6667; val_kl_reg_loss: 142041.4062; val_edge_recon_loss: 401504.2500; val_gene_expr_recon_loss: 209972.0000; val_masked_gp_l1_reg_loss: 1264.1272; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95146352.0000; val_global_loss: 95901136.0000; val_optim_loss: 95901136.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8721; val_auprc_score: 0.8604; val_best_acc_score: 0.7971; val_best_f1_score: 0.7960; train_kl_reg_loss: 148806.9462; train_edge_recon_loss: 399543.5035; train_gene_expr_recon_loss: 210452.7865; train_masked_gp_l1_reg_loss: 1262.1633; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96962669.3333; train_global_loss: 97722735.1111; train_optim_loss: 97722735.1111; val_kl_reg_loss: 138904.1875; val_edge_recon_loss: 401184.1562; val_gene_expr_recon_loss: 209769.4844; val_masked_gp_l1_reg_loss: 1257.3459; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95037960.0000; val_global_loss: 95789072.0000; val_optim_loss: 95789072.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8788; val_auprc_score: 0.8680; val_best_acc_score: 0.7984; val_best_f1_score: 0.7931; train_kl_reg_loss: 147080.7535; train_edge_recon_loss: 398737.6597; train_gene_expr_recon_loss: 210955.9410; train_masked_gp_l1_reg_loss: 1256.7867; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96815166.2222; train_global_loss: 97573197.3333; train_optim_loss: 97573197.3333; val_kl_reg_loss: 133625.1719; val_edge_recon_loss: 400385.0938; val_gene_expr_recon_loss: 209798.0156; val_masked_gp_l1_reg_loss: 1252.9508; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 95100232.0000; val_global_loss: 95845296.0000; val_optim_loss: 95845296.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8923; val_auprc_score: 0.8753; val_best_acc_score: 0.7095; val_best_f1_score: 0.7717; train_kl_reg_loss: 180560.9444; train_edge_recon_loss: 400739.3889; train_gene_expr_recon_loss: 244289.3021; train_masked_gp_l1_reg_loss: 1266.1998; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101224838.2222; train_global_loss: 102051693.3333; train_optim_loss: 102051693.3333; val_kl_reg_loss: 83584.2031; val_edge_recon_loss: 405465.4062; val_gene_expr_recon_loss: 232174.0469; val_masked_gp_l1_reg_loss: 1283.7910; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97859592.0000; val_global_loss: 98582096.0000; val_optim_loss: 98582096.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8776; val_auprc_score: 0.8644; val_best_acc_score: 0.6293; val_best_f1_score: 0.7275; train_kl_reg_loss: 161448.7431; train_edge_recon_loss: 404772.6493; train_gene_expr_recon_loss: 232937.8594; train_masked_gp_l1_reg_loss: 1285.5441; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99032172.4444; train_global_loss: 99832617.7778; train_optim_loss: 99832617.7778; val_kl_reg_loss: 82995.0938; val_edge_recon_loss: 405904.9062; val_gene_expr_recon_loss: 230086.9375; val_masked_gp_l1_reg_loss: 1280.5255; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97563856.0000; val_global_loss: 98284120.0000; val_optim_loss: 98284120.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8609; val_auprc_score: 0.8454; val_best_acc_score: 0.6421; val_best_f1_score: 0.7334; train_kl_reg_loss: 144953.5625; train_edge_recon_loss: 403930.7569; train_gene_expr_recon_loss: 228446.9236; train_masked_gp_l1_reg_loss: 1269.9598; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98591497.7778; train_global_loss: 99370099.5556; train_optim_loss: 99370099.5556; val_kl_reg_loss: 73611.6797; val_edge_recon_loss: 405793.0625; val_gene_expr_recon_loss: 226995.7031; val_masked_gp_l1_reg_loss: 1255.1031; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97344536.0000; val_global_loss: 98052192.0000; val_optim_loss: 98052192.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8690; val_auprc_score: 0.8553; val_best_acc_score: 0.6482; val_best_f1_score: 0.7368; train_kl_reg_loss: 128826.7674; train_edge_recon_loss: 405443.3750; train_gene_expr_recon_loss: 227359.4740; train_masked_gp_l1_reg_loss: 1252.0882; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98450192.8889; train_global_loss: 99213074.6667; train_optim_loss: 99213074.6667; val_kl_reg_loss: 73141.3281; val_edge_recon_loss: 405762.5000; val_gene_expr_recon_loss: 226803.4219; val_masked_gp_l1_reg_loss: 1248.3875; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97232384.0000; val_global_loss: 97939336.0000; val_optim_loss: 97939336.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8688; val_auprc_score: 0.8562; val_best_acc_score: 0.6529; val_best_f1_score: 0.7394; train_kl_reg_loss: 127152.5122; train_edge_recon_loss: 405449.2917; train_gene_expr_recon_loss: 227051.6788; train_masked_gp_l1_reg_loss: 1246.1230; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98589893.3333; train_global_loss: 99350794.6667; train_optim_loss: 99350794.6667; val_kl_reg_loss: 74323.5938; val_edge_recon_loss: 405748.5312; val_gene_expr_recon_loss: 226768.6875; val_masked_gp_l1_reg_loss: 1243.2961; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97400504.0000; val_global_loss: 98108592.0000; val_optim_loss: 98108592.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8640; val_auprc_score: 0.8526; val_best_acc_score: 0.6500; val_best_f1_score: 0.7373; train_kl_reg_loss: 125787.1554; train_edge_recon_loss: 405022.1701; train_gene_expr_recon_loss: 227629.4826; train_masked_gp_l1_reg_loss: 1241.1790; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98911580.4444; train_global_loss: 99671259.5556; train_optim_loss: 99671259.5556; val_kl_reg_loss: 74314.2500; val_edge_recon_loss: 405749.9375; val_gene_expr_recon_loss: 226456.4062; val_masked_gp_l1_reg_loss: 1238.6368; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97422288.0000; val_global_loss: 98130048.0000; val_optim_loss: 98130048.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8647; val_auprc_score: 0.8508; val_best_acc_score: 0.6521; val_best_f1_score: 0.7383; train_kl_reg_loss: 123033.4089; train_edge_recon_loss: 404774.7014; train_gene_expr_recon_loss: 226316.8854; train_masked_gp_l1_reg_loss: 1236.7925; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98508190.2222; train_global_loss: 99263552.8889; train_optim_loss: 99263552.8889; val_kl_reg_loss: 74442.4375; val_edge_recon_loss: 405729.1562; val_gene_expr_recon_loss: 226058.0625; val_masked_gp_l1_reg_loss: 1234.5909; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97328024.0000; val_global_loss: 98035488.0000; val_optim_loss: 98035488.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 25 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.8835
Val AUPRC score: 0.8753
Val best accuracy score: 0.7855
Val best F1 score: 0.8068
Val gene expr MSE score: 0.8077
Val chrom access MSE score: 0.0871
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
