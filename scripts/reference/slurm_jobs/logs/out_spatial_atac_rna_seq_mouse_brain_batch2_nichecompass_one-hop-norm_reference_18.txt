[True]
Run timestamp: 07092023_142800_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 799 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3515, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 799
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 799

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6612; val_auprc_score: 0.6487; val_best_acc_score: 0.5048; val_best_f1_score: 0.6685; train_kl_reg_loss: 50914.5911; train_edge_recon_loss: 3533198.5909; train_gene_expr_recon_loss: 12555957.8182; train_masked_gp_l1_reg_loss: 56678.2486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 817917.1515; train_chrom_access_recon_loss: 2661080.5417; train_global_loss: 19675747.0909; train_optim_loss: 19675747.0909; val_kl_reg_loss: 84777.8174; val_edge_recon_loss: 4065076.0625; val_gene_expr_recon_loss: 11592978.8750; val_masked_gp_l1_reg_loss: 52736.4023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 625432.1250; val_chrom_access_recon_loss: 2609088.3438; val_global_loss: 19030089.0000; val_optim_loss: 19030089.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7152; val_auprc_score: 0.7004; val_best_acc_score: 0.5556; val_best_f1_score: 0.6870; train_kl_reg_loss: 92492.1347; train_edge_recon_loss: 3519529.6212; train_gene_expr_recon_loss: 11295413.5000; train_masked_gp_l1_reg_loss: 50420.9412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 459378.7008; train_chrom_access_recon_loss: 2511652.1098; train_global_loss: 17928887.0909; train_optim_loss: 17928887.0909; val_kl_reg_loss: 101570.2969; val_edge_recon_loss: 4062020.6875; val_gene_expr_recon_loss: 11275003.3750; val_masked_gp_l1_reg_loss: 49421.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 318807.8125; val_chrom_access_recon_loss: 2508751.4375; val_global_loss: 18315575.5000; val_optim_loss: 18315575.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7673; val_auprc_score: 0.7474; val_best_acc_score: 0.6943; val_best_f1_score: 0.7168; train_kl_reg_loss: 84896.0671; train_edge_recon_loss: 3512581.6894; train_gene_expr_recon_loss: 11142779.9848; train_masked_gp_l1_reg_loss: 49649.6023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 237309.4676; train_chrom_access_recon_loss: 2488896.1705; train_global_loss: 17516112.9091; train_optim_loss: 17516112.9091; val_kl_reg_loss: 85324.8760; val_edge_recon_loss: 4040843.8125; val_gene_expr_recon_loss: 11254367.0000; val_masked_gp_l1_reg_loss: 50634.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173955.3906; val_chrom_access_recon_loss: 2504421.8438; val_global_loss: 18109547.7500; val_optim_loss: 18109547.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8322; val_auprc_score: 0.8010; val_best_acc_score: 0.7665; val_best_f1_score: 0.7865; train_kl_reg_loss: 71604.4342; train_edge_recon_loss: 3487982.4773; train_gene_expr_recon_loss: 11044029.2727; train_masked_gp_l1_reg_loss: 52458.3656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138649.3345; train_chrom_access_recon_loss: 2473790.6174; train_global_loss: 17268514.5152; train_optim_loss: 17268514.5152; val_kl_reg_loss: 59447.3286; val_edge_recon_loss: 3723332.4688; val_gene_expr_recon_loss: 11150133.8750; val_masked_gp_l1_reg_loss: 54662.4023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111387.4297; val_chrom_access_recon_loss: 2508604.2812; val_global_loss: 17607567.0000; val_optim_loss: 17607567.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8586; val_auprc_score: 0.8249; val_best_acc_score: 0.7894; val_best_f1_score: 0.8061; train_kl_reg_loss: 59825.1210; train_edge_recon_loss: 3170080.5909; train_gene_expr_recon_loss: 11085771.6667; train_masked_gp_l1_reg_loss: 57745.1999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96937.7476; train_chrom_access_recon_loss: 2466530.1742; train_global_loss: 16936890.4091; train_optim_loss: 16936890.4091; val_kl_reg_loss: 40206.1982; val_edge_recon_loss: 3133311.7500; val_gene_expr_recon_loss: 11177561.3750; val_masked_gp_l1_reg_loss: 62034.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86742.7578; val_chrom_access_recon_loss: 2491442.2500; val_global_loss: 16991298.2500; val_optim_loss: 16991298.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8689; val_auprc_score: 0.8269; val_best_acc_score: 0.7953; val_best_f1_score: 0.8149; train_kl_reg_loss: 60171.4348; train_edge_recon_loss: 2993586.7235; train_gene_expr_recon_loss: 10966670.7727; train_masked_gp_l1_reg_loss: 64065.9814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76264.5555; train_chrom_access_recon_loss: 2449689.0606; train_global_loss: 16610448.5152; train_optim_loss: 16610448.5152; val_kl_reg_loss: 78050.9229; val_edge_recon_loss: 2917211.1250; val_gene_expr_recon_loss: 11065170.2500; val_masked_gp_l1_reg_loss: 64485.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65678.5625; val_chrom_access_recon_loss: 2461704.2188; val_global_loss: 16652300.5000; val_optim_loss: 16652300.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8798; val_auprc_score: 0.8384; val_best_acc_score: 0.8192; val_best_f1_score: 0.8340; train_kl_reg_loss: 81572.3093; train_edge_recon_loss: 2887495.0189; train_gene_expr_recon_loss: 10870723.9394; train_masked_gp_l1_reg_loss: 65402.4924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59090.1272; train_chrom_access_recon_loss: 2435113.1629; train_global_loss: 16399397.0152; train_optim_loss: 16399397.0152; val_kl_reg_loss: 84442.5244; val_edge_recon_loss: 2885970.7500; val_gene_expr_recon_loss: 11069170.3750; val_masked_gp_l1_reg_loss: 66375.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53301.9336; val_chrom_access_recon_loss: 2491038.6250; val_global_loss: 16650300.2500; val_optim_loss: 16650300.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9085; val_auprc_score: 0.8751; val_best_acc_score: 0.8490; val_best_f1_score: 0.8574; train_kl_reg_loss: 86954.4510; train_edge_recon_loss: 2864500.7538; train_gene_expr_recon_loss: 10799619.8182; train_masked_gp_l1_reg_loss: 67275.0256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48940.6156; train_chrom_access_recon_loss: 2423973.8068; train_global_loss: 16291264.5000; train_optim_loss: 16291264.5000; val_kl_reg_loss: 82744.1006; val_edge_recon_loss: 2834627.0312; val_gene_expr_recon_loss: 10823208.0000; val_masked_gp_l1_reg_loss: 68262.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45264.4453; val_chrom_access_recon_loss: 2429547.0938; val_global_loss: 16283653.5000; val_optim_loss: 16283653.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9071; val_auprc_score: 0.8725; val_best_acc_score: 0.8485; val_best_f1_score: 0.8581; train_kl_reg_loss: 88021.9599; train_edge_recon_loss: 2822317.3561; train_gene_expr_recon_loss: 10742737.1061; train_masked_gp_l1_reg_loss: 69217.0709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42589.5336; train_chrom_access_recon_loss: 2414153.6174; train_global_loss: 16179036.7879; train_optim_loss: 16179036.7879; val_kl_reg_loss: 89817.0664; val_edge_recon_loss: 2796354.5938; val_gene_expr_recon_loss: 10757733.1250; val_masked_gp_l1_reg_loss: 69971.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40319.3438; val_chrom_access_recon_loss: 2439921.6250; val_global_loss: 16194116.1250; val_optim_loss: 16194116.1250
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9224; val_auprc_score: 0.9047; val_best_acc_score: 0.8576; val_best_f1_score: 0.8660; train_kl_reg_loss: 88076.9667; train_edge_recon_loss: 2813715.6742; train_gene_expr_recon_loss: 10695970.8030; train_masked_gp_l1_reg_loss: 70830.5632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38562.3050; train_chrom_access_recon_loss: 2405117.0644; train_global_loss: 16112273.3182; train_optim_loss: 16112273.3182; val_kl_reg_loss: 88885.1494; val_edge_recon_loss: 2804642.9688; val_gene_expr_recon_loss: 10757701.3750; val_masked_gp_l1_reg_loss: 71741.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37065.1172; val_chrom_access_recon_loss: 2456134.3438; val_global_loss: 16216171.1250; val_optim_loss: 16216171.1250
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9172; val_auprc_score: 0.8909; val_best_acc_score: 0.8579; val_best_f1_score: 0.8668; train_kl_reg_loss: 88441.7036; train_edge_recon_loss: 2796000.4470; train_gene_expr_recon_loss: 10642403.4091; train_masked_gp_l1_reg_loss: 72369.7309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35783.0642; train_chrom_access_recon_loss: 2393047.4129; train_global_loss: 16028045.8485; train_optim_loss: 16028045.8485; val_kl_reg_loss: 88303.9688; val_edge_recon_loss: 2826727.5938; val_gene_expr_recon_loss: 10681464.3750; val_masked_gp_l1_reg_loss: 73206.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34797.9570; val_chrom_access_recon_loss: 2409668.6875; val_global_loss: 16114168.6250; val_optim_loss: 16114168.6250
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9181; val_auprc_score: 0.8914; val_best_acc_score: 0.8552; val_best_f1_score: 0.8666; train_kl_reg_loss: 86665.2125; train_edge_recon_loss: 2785096.2386; train_gene_expr_recon_loss: 10602734.8939; train_masked_gp_l1_reg_loss: 73853.7012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33964.2824; train_chrom_access_recon_loss: 2383292.0720; train_global_loss: 15965606.3939; train_optim_loss: 15965606.3939; val_kl_reg_loss: 86838.7568; val_edge_recon_loss: 2820820.9688; val_gene_expr_recon_loss: 10798167.2500; val_masked_gp_l1_reg_loss: 74583.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33324.4062; val_chrom_access_recon_loss: 2448182.0938; val_global_loss: 16261915.7500; val_optim_loss: 16261915.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9135; val_auprc_score: 0.8875; val_best_acc_score: 0.8555; val_best_f1_score: 0.8668; train_kl_reg_loss: 83593.5167; train_edge_recon_loss: 2794819.7917; train_gene_expr_recon_loss: 10558850.7879; train_masked_gp_l1_reg_loss: 75238.9161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32715.7843; train_chrom_access_recon_loss: 2375779.9356; train_global_loss: 15920998.7121; train_optim_loss: 15920998.7121; val_kl_reg_loss: 83220.7754; val_edge_recon_loss: 2808701.2500; val_gene_expr_recon_loss: 10764115.6250; val_masked_gp_l1_reg_loss: 75946.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32050.0547; val_chrom_access_recon_loss: 2420577.2188; val_global_loss: 16184611.0000; val_optim_loss: 16184611.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9064; val_auprc_score: 0.8716; val_best_acc_score: 0.8495; val_best_f1_score: 0.8635; train_kl_reg_loss: 83784.6867; train_edge_recon_loss: 2784088.5303; train_gene_expr_recon_loss: 10532166.3788; train_masked_gp_l1_reg_loss: 76310.4686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31617.0418; train_chrom_access_recon_loss: 2368675.1136; train_global_loss: 15876642.1970; train_optim_loss: 15876642.1970; val_kl_reg_loss: 83599.2217; val_edge_recon_loss: 2797032.3750; val_gene_expr_recon_loss: 10708188.5000; val_masked_gp_l1_reg_loss: 76811.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31357.5684; val_chrom_access_recon_loss: 2407067.3125; val_global_loss: 16104056.7500; val_optim_loss: 16104056.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9182; val_auprc_score: 0.8865; val_best_acc_score: 0.8603; val_best_f1_score: 0.8691; train_kl_reg_loss: 81643.1023; train_edge_recon_loss: 2764135.2917; train_gene_expr_recon_loss: 10492942.1818; train_masked_gp_l1_reg_loss: 77385.6225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30721.0260; train_chrom_access_recon_loss: 2361033.8371; train_global_loss: 15807861.1364; train_optim_loss: 15807861.1364; val_kl_reg_loss: 81229.2900; val_edge_recon_loss: 2795150.1562; val_gene_expr_recon_loss: 10628709.8750; val_masked_gp_l1_reg_loss: 78070.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30438.1348; val_chrom_access_recon_loss: 2405822.8750; val_global_loss: 16019420.2500; val_optim_loss: 16019420.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9212; val_auprc_score: 0.8911; val_best_acc_score: 0.8603; val_best_f1_score: 0.8715; train_kl_reg_loss: 79301.2917; train_edge_recon_loss: 2754378.7159; train_gene_expr_recon_loss: 10460994.0000; train_masked_gp_l1_reg_loss: 78513.2337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29992.2349; train_chrom_access_recon_loss: 2353340.2462; train_global_loss: 15756519.6818; train_optim_loss: 15756519.6818; val_kl_reg_loss: 80971.4268; val_edge_recon_loss: 2786168.2500; val_gene_expr_recon_loss: 10551048.8750; val_masked_gp_l1_reg_loss: 79055.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29556.2070; val_chrom_access_recon_loss: 2379996.3125; val_global_loss: 15906795.7500; val_optim_loss: 15906795.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9224; val_auprc_score: 0.8944; val_best_acc_score: 0.8595; val_best_f1_score: 0.8689; train_kl_reg_loss: 80017.5864; train_edge_recon_loss: 2755703.8182; train_gene_expr_recon_loss: 10430028.4394; train_masked_gp_l1_reg_loss: 79563.3279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29126.3205; train_chrom_access_recon_loss: 2346271.2576; train_global_loss: 15720710.6667; train_optim_loss: 15720710.6667; val_kl_reg_loss: 80488.9023; val_edge_recon_loss: 2792886.3750; val_gene_expr_recon_loss: 10482899.1250; val_masked_gp_l1_reg_loss: 80166.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28994.1016; val_chrom_access_recon_loss: 2335952.3594; val_global_loss: 15801388.1250; val_optim_loss: 15801388.1250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9285; val_auprc_score: 0.9037; val_best_acc_score: 0.8684; val_best_f1_score: 0.8757; train_kl_reg_loss: 79607.2959; train_edge_recon_loss: 2736463.1591; train_gene_expr_recon_loss: 10399401.7121; train_masked_gp_l1_reg_loss: 80574.5453; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28569.1524; train_chrom_access_recon_loss: 2339221.1288; train_global_loss: 15663837.0758; train_optim_loss: 15663837.0758; val_kl_reg_loss: 80601.1562; val_edge_recon_loss: 2754319.3438; val_gene_expr_recon_loss: 10530588.5000; val_masked_gp_l1_reg_loss: 81011.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28187.1523; val_chrom_access_recon_loss: 2367760.6562; val_global_loss: 15842467.6250; val_optim_loss: 15842467.6250
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9316; val_auprc_score: 0.9044; val_best_acc_score: 0.8726; val_best_f1_score: 0.8775; train_kl_reg_loss: 78663.2172; train_edge_recon_loss: 2739071.5871; train_gene_expr_recon_loss: 10368710.7273; train_masked_gp_l1_reg_loss: 81418.3645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27864.1581; train_chrom_access_recon_loss: 2332997.0985; train_global_loss: 15628725.1061; train_optim_loss: 15628725.1061; val_kl_reg_loss: 77705.7705; val_edge_recon_loss: 2744284.5312; val_gene_expr_recon_loss: 10399475.0000; val_masked_gp_l1_reg_loss: 81994.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27781.9609; val_chrom_access_recon_loss: 2342051.0000; val_global_loss: 15673292.2500; val_optim_loss: 15673292.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9302; val_auprc_score: 0.9073; val_best_acc_score: 0.8659; val_best_f1_score: 0.8750; train_kl_reg_loss: 75939.6020; train_edge_recon_loss: 2731717.1098; train_gene_expr_recon_loss: 10348288.0455; train_masked_gp_l1_reg_loss: 82363.9467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27490.4948; train_chrom_access_recon_loss: 2325104.4697; train_global_loss: 15590903.7121; train_optim_loss: 15590903.7121; val_kl_reg_loss: 78385.7500; val_edge_recon_loss: 2743319.3750; val_gene_expr_recon_loss: 10489795.7500; val_masked_gp_l1_reg_loss: 82856.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27215.5156; val_chrom_access_recon_loss: 2363306.9688; val_global_loss: 15784880.7500; val_optim_loss: 15784880.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9400; val_auprc_score: 0.9143; val_best_acc_score: 0.8812; val_best_f1_score: 0.8883; train_kl_reg_loss: 76904.7223; train_edge_recon_loss: 2708731.5152; train_gene_expr_recon_loss: 10319839.4848; train_masked_gp_l1_reg_loss: 83161.2223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26985.5163; train_chrom_access_recon_loss: 2320208.4508; train_global_loss: 15535830.8788; train_optim_loss: 15535830.8788; val_kl_reg_loss: 77327.8984; val_edge_recon_loss: 2731768.1250; val_gene_expr_recon_loss: 10419930.2500; val_masked_gp_l1_reg_loss: 83519.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26980.7188; val_chrom_access_recon_loss: 2340489.0625; val_global_loss: 15680016.3750; val_optim_loss: 15680016.3750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9396; val_auprc_score: 0.9187; val_best_acc_score: 0.8810; val_best_f1_score: 0.8875; train_kl_reg_loss: 76500.2638; train_edge_recon_loss: 2722612.3447; train_gene_expr_recon_loss: 10295330.0000; train_masked_gp_l1_reg_loss: 83961.8643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26680.1522; train_chrom_access_recon_loss: 2313340.0871; train_global_loss: 15518424.8182; train_optim_loss: 15518424.8182; val_kl_reg_loss: 75180.0967; val_edge_recon_loss: 2730815.3438; val_gene_expr_recon_loss: 10552429.1250; val_masked_gp_l1_reg_loss: 84420.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26670.5898; val_chrom_access_recon_loss: 2356355.5938; val_global_loss: 15825872.2500; val_optim_loss: 15825872.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9394; val_auprc_score: 0.9170; val_best_acc_score: 0.8778; val_best_f1_score: 0.8844; train_kl_reg_loss: 74391.5616; train_edge_recon_loss: 2724373.2197; train_gene_expr_recon_loss: 10281587.9545; train_masked_gp_l1_reg_loss: 84812.5129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26432.0707; train_chrom_access_recon_loss: 2310826.6629; train_global_loss: 15502423.9394; train_optim_loss: 15502423.9394; val_kl_reg_loss: 77286.1807; val_edge_recon_loss: 2761709.1562; val_gene_expr_recon_loss: 10428416.1250; val_masked_gp_l1_reg_loss: 85250.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26404.7109; val_chrom_access_recon_loss: 2355614.7500; val_global_loss: 15734681.1250; val_optim_loss: 15734681.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9382; val_auprc_score: 0.9126; val_best_acc_score: 0.8778; val_best_f1_score: 0.8835; train_kl_reg_loss: 74836.6220; train_edge_recon_loss: 2717826.1970; train_gene_expr_recon_loss: 10258591.9697; train_masked_gp_l1_reg_loss: 84112.0191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22695.9935; train_chrom_access_recon_loss: 2304348.0644; train_global_loss: 15462410.8182; train_optim_loss: 15462410.8182; val_kl_reg_loss: 76707.9492; val_edge_recon_loss: 2726782.7188; val_gene_expr_recon_loss: 10462607.7500; val_masked_gp_l1_reg_loss: 83549.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21387.7578; val_chrom_access_recon_loss: 2338362.8438; val_global_loss: 15709398.2500; val_optim_loss: 15709398.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9394; val_auprc_score: 0.9139; val_best_acc_score: 0.8823; val_best_f1_score: 0.8891; train_kl_reg_loss: 75632.4332; train_edge_recon_loss: 2720271.6591; train_gene_expr_recon_loss: 10254767.5606; train_masked_gp_l1_reg_loss: 83438.6657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21211.4635; train_chrom_access_recon_loss: 2303765.0909; train_global_loss: 15459086.8636; train_optim_loss: 15459086.8636; val_kl_reg_loss: 76392.1729; val_edge_recon_loss: 2734116.9062; val_gene_expr_recon_loss: 10401601.8750; val_masked_gp_l1_reg_loss: 83404.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21125.1621; val_chrom_access_recon_loss: 2336562.7500; val_global_loss: 15653203.7500; val_optim_loss: 15653203.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9379; val_auprc_score: 0.9106; val_best_acc_score: 0.8818; val_best_f1_score: 0.8886; train_kl_reg_loss: 81547.1753; train_edge_recon_loss: 2775943.9583; train_gene_expr_recon_loss: 10068276.3788; train_masked_gp_l1_reg_loss: 83091.6153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20362.9194; train_chrom_access_recon_loss: 2306882.8106; train_global_loss: 15336104.8333; train_optim_loss: 15336104.8333; val_kl_reg_loss: 43709.0659; val_edge_recon_loss: 2793012.2812; val_gene_expr_recon_loss: 10193948.5000; val_masked_gp_l1_reg_loss: 82950.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19778.3496; val_chrom_access_recon_loss: 2327203.9688; val_global_loss: 15460601.7500; val_optim_loss: 15460601.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9317; val_auprc_score: 0.9016; val_best_acc_score: 0.8756; val_best_f1_score: 0.8833; train_kl_reg_loss: 87308.3254; train_edge_recon_loss: 2769824.5303; train_gene_expr_recon_loss: 9956113.5455; train_masked_gp_l1_reg_loss: 82904.4369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19494.8957; train_chrom_access_recon_loss: 2256856.2576; train_global_loss: 15172501.9848; train_optim_loss: 15172501.9848; val_kl_reg_loss: 45211.1753; val_edge_recon_loss: 2789139.5312; val_gene_expr_recon_loss: 10117320.2500; val_masked_gp_l1_reg_loss: 82883.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19258.6816; val_chrom_access_recon_loss: 2286753.0938; val_global_loss: 15340567.0000; val_optim_loss: 15340567.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9381; val_auprc_score: 0.9153; val_best_acc_score: 0.8745; val_best_f1_score: 0.8806; train_kl_reg_loss: 89614.2865; train_edge_recon_loss: 2760433.4962; train_gene_expr_recon_loss: 9930493.4394; train_masked_gp_l1_reg_loss: 82872.3975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19097.1119; train_chrom_access_recon_loss: 2248233.4811; train_global_loss: 15130744.1970; train_optim_loss: 15130744.1970; val_kl_reg_loss: 46980.2979; val_edge_recon_loss: 2783114.0000; val_gene_expr_recon_loss: 9997097.2500; val_masked_gp_l1_reg_loss: 82853.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18930.6406; val_chrom_access_recon_loss: 2265342.0312; val_global_loss: 15194318.8750; val_optim_loss: 15194318.8750
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9401; val_auprc_score: 0.9154; val_best_acc_score: 0.8815; val_best_f1_score: 0.8891; train_kl_reg_loss: 90026.3950; train_edge_recon_loss: 2756357.4621; train_gene_expr_recon_loss: 9927812.2121; train_masked_gp_l1_reg_loss: 82847.7430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18805.7248; train_chrom_access_recon_loss: 2246022.1629; train_global_loss: 15121871.8485; train_optim_loss: 15121871.8485; val_kl_reg_loss: 47739.8096; val_edge_recon_loss: 2769719.4375; val_gene_expr_recon_loss: 10089110.8750; val_masked_gp_l1_reg_loss: 82845.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18689.8145; val_chrom_access_recon_loss: 2267476.5312; val_global_loss: 15275581.8750; val_optim_loss: 15275581.8750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9386; val_auprc_score: 0.9170; val_best_acc_score: 0.8815; val_best_f1_score: 0.8897; train_kl_reg_loss: 89891.3923; train_edge_recon_loss: 2748354.3561; train_gene_expr_recon_loss: 9909901.7424; train_masked_gp_l1_reg_loss: 82837.1544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18602.5651; train_chrom_access_recon_loss: 2241457.2027; train_global_loss: 15091044.3182; train_optim_loss: 15091044.3182; val_kl_reg_loss: 48680.4243; val_edge_recon_loss: 2764967.5938; val_gene_expr_recon_loss: 10017010.0000; val_masked_gp_l1_reg_loss: 82833.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18519.2773; val_chrom_access_recon_loss: 2282730.2812; val_global_loss: 15214740.3750; val_optim_loss: 15214740.3750
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9396; val_auprc_score: 0.9221; val_best_acc_score: 0.8796; val_best_f1_score: 0.8867; train_kl_reg_loss: 89978.3196; train_edge_recon_loss: 2743208.5530; train_gene_expr_recon_loss: 9884849.7576; train_masked_gp_l1_reg_loss: 82834.8974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18455.3773; train_chrom_access_recon_loss: 2233816.8409; train_global_loss: 15053143.8333; train_optim_loss: 15053143.8333; val_kl_reg_loss: 48311.1768; val_edge_recon_loss: 2804716.0625; val_gene_expr_recon_loss: 9996915.6250; val_masked_gp_l1_reg_loss: 82820.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18385.8359; val_chrom_access_recon_loss: 2260744.6562; val_global_loss: 15211893.3750; val_optim_loss: 15211893.3750
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9428; val_auprc_score: 0.9228; val_best_acc_score: 0.8810; val_best_f1_score: 0.8900; train_kl_reg_loss: 89908.8028; train_edge_recon_loss: 2736691.3106; train_gene_expr_recon_loss: 9884796.5758; train_masked_gp_l1_reg_loss: 82819.2461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18335.4906; train_chrom_access_recon_loss: 2233681.3182; train_global_loss: 15046232.6364; train_optim_loss: 15046232.6364; val_kl_reg_loss: 49432.2695; val_edge_recon_loss: 2749450.6250; val_gene_expr_recon_loss: 10092513.0000; val_masked_gp_l1_reg_loss: 82821.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18290.3516; val_chrom_access_recon_loss: 2273510.4688; val_global_loss: 15266018.5000; val_optim_loss: 15266018.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9345; val_auprc_score: 0.9097; val_best_acc_score: 0.8743; val_best_f1_score: 0.8835; train_kl_reg_loss: 89234.4070; train_edge_recon_loss: 2747500.9167; train_gene_expr_recon_loss: 9883623.9242; train_masked_gp_l1_reg_loss: 82780.4221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18145.5857; train_chrom_access_recon_loss: 2233963.0663; train_global_loss: 15055248.3788; train_optim_loss: 15055248.3788; val_kl_reg_loss: 49601.8394; val_edge_recon_loss: 2791992.8125; val_gene_expr_recon_loss: 10081146.8750; val_masked_gp_l1_reg_loss: 82761.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18110.9199; val_chrom_access_recon_loss: 2266995.7812; val_global_loss: 15290609.3750; val_optim_loss: 15290609.3750
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9389; val_auprc_score: 0.9110; val_best_acc_score: 0.8821; val_best_f1_score: 0.8904; train_kl_reg_loss: 89297.2383; train_edge_recon_loss: 2740184.3182; train_gene_expr_recon_loss: 9878720.8788; train_masked_gp_l1_reg_loss: 82752.5438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18101.8375; train_chrom_access_recon_loss: 2232133.5568; train_global_loss: 15041190.3333; train_optim_loss: 15041190.3333; val_kl_reg_loss: 49486.4741; val_edge_recon_loss: 2757183.1562; val_gene_expr_recon_loss: 9988550.3750; val_masked_gp_l1_reg_loss: 82745.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18093.3535; val_chrom_access_recon_loss: 2266056.9375; val_global_loss: 15162115.2500; val_optim_loss: 15162115.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9433; val_auprc_score: 0.9237; val_best_acc_score: 0.8845; val_best_f1_score: 0.8913; train_kl_reg_loss: 88908.8359; train_edge_recon_loss: 2741821.3598; train_gene_expr_recon_loss: 9868147.5909; train_masked_gp_l1_reg_loss: 82740.0709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18087.3712; train_chrom_access_recon_loss: 2231434.3769; train_global_loss: 15031139.4848; train_optim_loss: 15031139.4848; val_kl_reg_loss: 49585.3696; val_edge_recon_loss: 2763003.4062; val_gene_expr_recon_loss: 9963624.2500; val_masked_gp_l1_reg_loss: 82735.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18080.1230; val_chrom_access_recon_loss: 2259726.0000; val_global_loss: 15136754.1250; val_optim_loss: 15136754.1250
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9352; val_auprc_score: 0.9092; val_best_acc_score: 0.8794; val_best_f1_score: 0.8881; train_kl_reg_loss: 88945.2337; train_edge_recon_loss: 2754738.7689; train_gene_expr_recon_loss: 9866893.4091; train_masked_gp_l1_reg_loss: 82731.5367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18075.0159; train_chrom_access_recon_loss: 2232294.9280; train_global_loss: 15043678.9091; train_optim_loss: 15043678.9091; val_kl_reg_loss: 49682.2212; val_edge_recon_loss: 2774552.8438; val_gene_expr_recon_loss: 10001195.6250; val_masked_gp_l1_reg_loss: 82728.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18068.8906; val_chrom_access_recon_loss: 2276157.1250; val_global_loss: 15202384.7500; val_optim_loss: 15202384.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9397; val_auprc_score: 0.9217; val_best_acc_score: 0.8778; val_best_f1_score: 0.8859; train_kl_reg_loss: 88587.8156; train_edge_recon_loss: 2744181.3636; train_gene_expr_recon_loss: 9869623.3030; train_masked_gp_l1_reg_loss: 82725.1906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18063.7433; train_chrom_access_recon_loss: 2230245.6023; train_global_loss: 15033426.9697; train_optim_loss: 15033426.9697; val_kl_reg_loss: 49495.0386; val_edge_recon_loss: 2772766.9375; val_gene_expr_recon_loss: 10076066.2500; val_masked_gp_l1_reg_loss: 82722.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18058.5898; val_chrom_access_recon_loss: 2279622.4688; val_global_loss: 15278732.7500; val_optim_loss: 15278732.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9340; val_auprc_score: 0.9101; val_best_acc_score: 0.8697; val_best_f1_score: 0.8769; train_kl_reg_loss: 88408.8176; train_edge_recon_loss: 2737379.7462; train_gene_expr_recon_loss: 9859609.8788; train_masked_gp_l1_reg_loss: 82720.3456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18054.4737; train_chrom_access_recon_loss: 2230812.3712; train_global_loss: 15016985.5909; train_optim_loss: 15016985.5909; val_kl_reg_loss: 49543.9512; val_edge_recon_loss: 2800277.7188; val_gene_expr_recon_loss: 9934583.6250; val_masked_gp_l1_reg_loss: 82717.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18049.1172; val_chrom_access_recon_loss: 2265898.6875; val_global_loss: 15151070.1250; val_optim_loss: 15151070.1250
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9317; val_auprc_score: 0.9041; val_best_acc_score: 0.8748; val_best_f1_score: 0.8844; train_kl_reg_loss: 88460.7873; train_edge_recon_loss: 2738938.5682; train_gene_expr_recon_loss: 9866026.5606; train_masked_gp_l1_reg_loss: 82715.3733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18044.2636; train_chrom_access_recon_loss: 2231679.8598; train_global_loss: 15025865.5606; train_optim_loss: 15025865.5606; val_kl_reg_loss: 50066.3926; val_edge_recon_loss: 2787897.0312; val_gene_expr_recon_loss: 10140431.1250; val_masked_gp_l1_reg_loss: 82712.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18040.4180; val_chrom_access_recon_loss: 2270916.7500; val_global_loss: 15350063.3750; val_optim_loss: 15350063.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9432; val_auprc_score: 0.9250; val_best_acc_score: 0.8815; val_best_f1_score: 0.8904; train_kl_reg_loss: 88492.2428; train_edge_recon_loss: 2740030.7348; train_gene_expr_recon_loss: 9866309.9545; train_masked_gp_l1_reg_loss: 82708.2193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18024.8981; train_chrom_access_recon_loss: 2231940.8693; train_global_loss: 15027506.8939; train_optim_loss: 15027506.8939; val_kl_reg_loss: 49187.4087; val_edge_recon_loss: 2760199.7812; val_gene_expr_recon_loss: 10001474.8750; val_masked_gp_l1_reg_loss: 82706.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18021.4766; val_chrom_access_recon_loss: 2274167.0000; val_global_loss: 15185756.3750; val_optim_loss: 15185756.3750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9452; val_auprc_score: 0.9263; val_best_acc_score: 0.8823; val_best_f1_score: 0.8893; train_kl_reg_loss: 88346.9983; train_edge_recon_loss: 2737518.4394; train_gene_expr_recon_loss: 9867635.0303; train_masked_gp_l1_reg_loss: 82705.0835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18020.7077; train_chrom_access_recon_loss: 2231597.8485; train_global_loss: 15025824.0606; train_optim_loss: 15025824.0606; val_kl_reg_loss: 49468.2734; val_edge_recon_loss: 2750618.8750; val_gene_expr_recon_loss: 9985735.0000; val_masked_gp_l1_reg_loss: 82704.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18020.0586; val_chrom_access_recon_loss: 2265148.8438; val_global_loss: 15151695.1250; val_optim_loss: 15151695.1250
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9388; val_auprc_score: 0.9132; val_best_acc_score: 0.8799; val_best_f1_score: 0.8891; train_kl_reg_loss: 88423.0798; train_edge_recon_loss: 2741751.1742; train_gene_expr_recon_loss: 9874431.7424; train_masked_gp_l1_reg_loss: 82703.6265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18019.4360; train_chrom_access_recon_loss: 2231802.0758; train_global_loss: 15037131.1364; train_optim_loss: 15037131.1364; val_kl_reg_loss: 49794.4302; val_edge_recon_loss: 2762828.0000; val_gene_expr_recon_loss: 9890875.7500; val_masked_gp_l1_reg_loss: 82702.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18018.8203; val_chrom_access_recon_loss: 2265596.5000; val_global_loss: 15069816.7500; val_optim_loss: 15069816.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9398; val_auprc_score: 0.9199; val_best_acc_score: 0.8788; val_best_f1_score: 0.8873; train_kl_reg_loss: 88332.6705; train_edge_recon_loss: 2738021.9735; train_gene_expr_recon_loss: 9873944.9242; train_masked_gp_l1_reg_loss: 82702.6054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18018.3233; train_chrom_access_recon_loss: 2233513.5360; train_global_loss: 15034534.1212; train_optim_loss: 15034534.1212; val_kl_reg_loss: 49719.4448; val_edge_recon_loss: 2777232.1250; val_gene_expr_recon_loss: 9880273.0000; val_masked_gp_l1_reg_loss: 82702.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18017.7363; val_chrom_access_recon_loss: 2265767.6250; val_global_loss: 15073711.8750; val_optim_loss: 15073711.8750
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9375; val_auprc_score: 0.9046; val_best_acc_score: 0.8845; val_best_f1_score: 0.8914; train_kl_reg_loss: 88239.8332; train_edge_recon_loss: 2748629.5682; train_gene_expr_recon_loss: 9871350.4545; train_masked_gp_l1_reg_loss: 82701.7307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18017.3284; train_chrom_access_recon_loss: 2231830.3258; train_global_loss: 15040769.3636; train_optim_loss: 15040769.3636; val_kl_reg_loss: 50022.7061; val_edge_recon_loss: 2759829.9375; val_gene_expr_recon_loss: 10023684.2500; val_masked_gp_l1_reg_loss: 82701.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18016.7793; val_chrom_access_recon_loss: 2290937.8125; val_global_loss: 15225192.7500; val_optim_loss: 15225192.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9415; val_auprc_score: 0.9242; val_best_acc_score: 0.8778; val_best_f1_score: 0.8867; train_kl_reg_loss: 88182.1510; train_edge_recon_loss: 2740485.3939; train_gene_expr_recon_loss: 9867200.8485; train_masked_gp_l1_reg_loss: 82700.8684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18016.2076; train_chrom_access_recon_loss: 2231155.4242; train_global_loss: 15027740.9242; train_optim_loss: 15027740.9242; val_kl_reg_loss: 49621.8550; val_edge_recon_loss: 2773130.1875; val_gene_expr_recon_loss: 9938482.2500; val_masked_gp_l1_reg_loss: 82700.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18015.6699; val_chrom_access_recon_loss: 2239670.0469; val_global_loss: 15101620.3750; val_optim_loss: 15101620.3750
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9340; val_auprc_score: 0.9097; val_best_acc_score: 0.8769; val_best_f1_score: 0.8861; train_kl_reg_loss: 88347.1760; train_edge_recon_loss: 2742840.6023; train_gene_expr_recon_loss: 9869426.2273; train_masked_gp_l1_reg_loss: 82700.0695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18015.1183; train_chrom_access_recon_loss: 2232057.8750; train_global_loss: 15033386.9848; train_optim_loss: 15033386.9848; val_kl_reg_loss: 50024.5244; val_edge_recon_loss: 2789888.4062; val_gene_expr_recon_loss: 10042854.2500; val_masked_gp_l1_reg_loss: 82699.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18014.4844; val_chrom_access_recon_loss: 2281335.8125; val_global_loss: 15264816.8750; val_optim_loss: 15264816.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9331; val_auprc_score: 0.9078; val_best_acc_score: 0.8769; val_best_f1_score: 0.8861; train_kl_reg_loss: 88225.2170; train_edge_recon_loss: 2734702.5227; train_gene_expr_recon_loss: 9863679.8030; train_masked_gp_l1_reg_loss: 82699.0870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18012.8543; train_chrom_access_recon_loss: 2231117.5303; train_global_loss: 15018437.1667; train_optim_loss: 15018437.1667; val_kl_reg_loss: 49346.3857; val_edge_recon_loss: 2764782.8750; val_gene_expr_recon_loss: 9958448.7500; val_masked_gp_l1_reg_loss: 82698.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18012.4902; val_chrom_access_recon_loss: 2272765.0312; val_global_loss: 15146053.8750; val_optim_loss: 15146053.8750
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9411; val_auprc_score: 0.9166; val_best_acc_score: 0.8829; val_best_f1_score: 0.8915; train_kl_reg_loss: 88221.6480; train_edge_recon_loss: 2743030.0795; train_gene_expr_recon_loss: 9866563.1818; train_masked_gp_l1_reg_loss: 82698.7486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18012.4110; train_chrom_access_recon_loss: 2230548.5227; train_global_loss: 15029074.5303; train_optim_loss: 15029074.5303; val_kl_reg_loss: 49670.5122; val_edge_recon_loss: 2752487.5312; val_gene_expr_recon_loss: 9988438.2500; val_masked_gp_l1_reg_loss: 82698.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18012.3418; val_chrom_access_recon_loss: 2258202.0000; val_global_loss: 15149509.2500; val_optim_loss: 15149509.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9377; val_auprc_score: 0.9176; val_best_acc_score: 0.8759; val_best_f1_score: 0.8831; train_kl_reg_loss: 88315.6541; train_edge_recon_loss: 2735789.2197; train_gene_expr_recon_loss: 9865759.8485; train_masked_gp_l1_reg_loss: 82698.5629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18012.2618; train_chrom_access_recon_loss: 2231060.4432; train_global_loss: 15021636.0152; train_optim_loss: 15021636.0152; val_kl_reg_loss: 49644.1343; val_edge_recon_loss: 2791721.7188; val_gene_expr_recon_loss: 9992249.0000; val_masked_gp_l1_reg_loss: 82698.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18012.1973; val_chrom_access_recon_loss: 2283532.1875; val_global_loss: 15217856.8750; val_optim_loss: 15217856.8750
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9341; val_auprc_score: 0.9113; val_best_acc_score: 0.8748; val_best_f1_score: 0.8823; train_kl_reg_loss: 88381.8609; train_edge_recon_loss: 2738840.3598; train_gene_expr_recon_loss: 9872715.9091; train_masked_gp_l1_reg_loss: 82698.4083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18012.1428; train_chrom_access_recon_loss: 2232360.9564; train_global_loss: 15033009.1970; train_optim_loss: 15033009.1970; val_kl_reg_loss: 49428.3574; val_edge_recon_loss: 2771560.8438; val_gene_expr_recon_loss: 10039311.5000; val_masked_gp_l1_reg_loss: 82698.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18012.0781; val_chrom_access_recon_loss: 2293009.7500; val_global_loss: 15254020.5000; val_optim_loss: 15254020.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 25 min 59 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9345
val AUPRC score: 0.9088
val best accuracy score: 0.8743
val best F1 score: 0.8835
val target rna MSE score: 2.0587
val source rna MSE score: 0.6697
val target atac MSE score: 0.4820
val source atac MSE score: 0.1093
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
