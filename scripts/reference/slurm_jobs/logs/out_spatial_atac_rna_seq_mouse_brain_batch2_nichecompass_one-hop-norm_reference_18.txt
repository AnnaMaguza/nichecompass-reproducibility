[True]
Run timestamp: 07082023_173755_18.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_18']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8806; val_auprc_score: 0.9006; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 9309.8721; train_edge_recon_loss: 36442.4731; train_gene_expr_recon_loss: 1285692.9028; train_masked_gp_l1_reg_loss: 15849.5537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167393.7118; train_chrom_access_recon_loss: 2259270.9028; train_global_loss: 3773959.4444; train_optim_loss: 3773959.4444; val_kl_reg_loss: 12693.3027; val_edge_recon_loss: 40661.5391; val_gene_expr_recon_loss: 1097973.3750; val_masked_gp_l1_reg_loss: 10879.8633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163171.8125; val_chrom_access_recon_loss: 1658389.6250; val_global_loss: 2983769.5000; val_optim_loss: 2983769.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9014; val_auprc_score: 0.9137; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 12342.8930; train_edge_recon_loss: 37836.0616; train_gene_expr_recon_loss: 939427.2778; train_masked_gp_l1_reg_loss: 9367.4786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160564.4583; train_chrom_access_recon_loss: 1500347.1389; train_global_loss: 2659885.2778; train_optim_loss: 2659885.2778; val_kl_reg_loss: 12659.9395; val_edge_recon_loss: 40661.4961; val_gene_expr_recon_loss: 859708.7500; val_masked_gp_l1_reg_loss: 8655.3105; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157394.9062; val_chrom_access_recon_loss: 1416295.5000; val_global_loss: 2495376.0000; val_optim_loss: 2495376.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9062; val_auprc_score: 0.9187; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 15776.2336; train_edge_recon_loss: 38189.6298; train_gene_expr_recon_loss: 812914.9722; train_masked_gp_l1_reg_loss: 9253.2305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154769.4983; train_chrom_access_recon_loss: 1400587.5556; train_global_loss: 2431491.0833; train_optim_loss: 2431491.0833; val_kl_reg_loss: 18659.5039; val_edge_recon_loss: 40661.8008; val_gene_expr_recon_loss: 788183.6250; val_masked_gp_l1_reg_loss: 9682.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151297.0156; val_chrom_access_recon_loss: 1378537.0000; val_global_loss: 2387021.7500; val_optim_loss: 2387021.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8955; val_auprc_score: 0.9079; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 19926.9783; train_edge_recon_loss: 38713.8763; train_gene_expr_recon_loss: 759095.6458; train_masked_gp_l1_reg_loss: 9670.0674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148163.3333; train_chrom_access_recon_loss: 1366500.1389; train_global_loss: 2342070.0556; train_optim_loss: 2342070.0556; val_kl_reg_loss: 20955.2930; val_edge_recon_loss: 40661.3711; val_gene_expr_recon_loss: 756539.3750; val_masked_gp_l1_reg_loss: 9704.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144049.8125; val_chrom_access_recon_loss: 1355568.7500; val_global_loss: 2327479.0000; val_optim_loss: 2327479.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8866; val_auprc_score: 0.9011; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 22504.8987; train_edge_recon_loss: 38887.9470; train_gene_expr_recon_loss: 735264.7222; train_masked_gp_l1_reg_loss: 9689.6831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140521.2760; train_chrom_access_recon_loss: 1350212.4028; train_global_loss: 2297080.9444; train_optim_loss: 2297080.9444; val_kl_reg_loss: 23237.1484; val_edge_recon_loss: 40660.5352; val_gene_expr_recon_loss: 734687.6250; val_masked_gp_l1_reg_loss: 9634.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136007.4375; val_chrom_access_recon_loss: 1342441.1250; val_global_loss: 2286668.0000; val_optim_loss: 2286668.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8796; val_auprc_score: 0.8874; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 24256.6037; train_edge_recon_loss: 39049.0664; train_gene_expr_recon_loss: 718225.1528; train_masked_gp_l1_reg_loss: 9596.9328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132301.5694; train_chrom_access_recon_loss: 1337793.8889; train_global_loss: 2261223.1944; train_optim_loss: 2261223.1944; val_kl_reg_loss: 24777.8945; val_edge_recon_loss: 40657.6992; val_gene_expr_recon_loss: 718819.8750; val_masked_gp_l1_reg_loss: 9533.6729; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127650.9375; val_chrom_access_recon_loss: 1332895.5000; val_global_loss: 2254335.5000; val_optim_loss: 2254335.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8673; val_auprc_score: 0.8675; val_best_acc_score: 0.5061; val_best_f1_score: 0.6693; train_kl_reg_loss: 25406.3581; train_edge_recon_loss: 39135.2804; train_gene_expr_recon_loss: 702564.3056; train_masked_gp_l1_reg_loss: 9473.0435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123940.3438; train_chrom_access_recon_loss: 1327023.9167; train_global_loss: 2227543.2222; train_optim_loss: 2227543.2222; val_kl_reg_loss: 25549.2441; val_edge_recon_loss: 40651.8516; val_gene_expr_recon_loss: 706422.8750; val_masked_gp_l1_reg_loss: 9393.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119331.5625; val_chrom_access_recon_loss: 1325721.5000; val_global_loss: 2227070.2500; val_optim_loss: 2227070.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8611; val_auprc_score: 0.8590; val_best_acc_score: 0.5259; val_best_f1_score: 0.6779; train_kl_reg_loss: 25850.8238; train_edge_recon_loss: 39174.6215; train_gene_expr_recon_loss: 689583.4444; train_masked_gp_l1_reg_loss: 9334.1437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115720.6597; train_chrom_access_recon_loss: 1318677.7778; train_global_loss: 2198341.5000; train_optim_loss: 2198341.5000; val_kl_reg_loss: 25495.4648; val_edge_recon_loss: 40638.7500; val_gene_expr_recon_loss: 696911.0625; val_masked_gp_l1_reg_loss: 9252.2568; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111265.2500; val_chrom_access_recon_loss: 1320313.5000; val_global_loss: 2203876.2500; val_optim_loss: 2203876.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8476; val_auprc_score: 0.8441; val_best_acc_score: 0.5492; val_best_f1_score: 0.6876; train_kl_reg_loss: 26108.9375; train_edge_recon_loss: 39191.1024; train_gene_expr_recon_loss: 683419.4861; train_masked_gp_l1_reg_loss: 9196.9743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107822.0061; train_chrom_access_recon_loss: 1323362.7639; train_global_loss: 2189101.3056; train_optim_loss: 2189101.3056; val_kl_reg_loss: 25558.6602; val_edge_recon_loss: 40625.1758; val_gene_expr_recon_loss: 688288.3750; val_masked_gp_l1_reg_loss: 9130.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103599.4922; val_chrom_access_recon_loss: 1315701.1250; val_global_loss: 2182903.0000; val_optim_loss: 2182903.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8426; val_auprc_score: 0.8395; val_best_acc_score: 0.5892; val_best_f1_score: 0.7059; train_kl_reg_loss: 26298.6493; train_edge_recon_loss: 39228.0855; train_gene_expr_recon_loss: 671681.0833; train_masked_gp_l1_reg_loss: 9088.9801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100377.0339; train_chrom_access_recon_loss: 1316354.1250; train_global_loss: 2163027.9722; train_optim_loss: 2163027.9722; val_kl_reg_loss: 25086.6055; val_edge_recon_loss: 40603.7773; val_gene_expr_recon_loss: 682712.4375; val_masked_gp_l1_reg_loss: 9033.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96445.7500; val_chrom_access_recon_loss: 1311776.3750; val_global_loss: 2165658.5000; val_optim_loss: 2165658.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8435; val_auprc_score: 0.8356; val_best_acc_score: 0.6120; val_best_f1_score: 0.7169; train_kl_reg_loss: 26318.4338; train_edge_recon_loss: 39256.8694; train_gene_expr_recon_loss: 667388.0556; train_masked_gp_l1_reg_loss: 8998.8507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93495.5911; train_chrom_access_recon_loss: 1307138.9444; train_global_loss: 2142596.7778; train_optim_loss: 2142596.7778; val_kl_reg_loss: 25977.3730; val_edge_recon_loss: 40590.0508; val_gene_expr_recon_loss: 677000.6875; val_masked_gp_l1_reg_loss: 8950.5410; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89917.2812; val_chrom_access_recon_loss: 1307939.2500; val_global_loss: 2150375.2500; val_optim_loss: 2150375.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8505; val_auprc_score: 0.8480; val_best_acc_score: 0.6405; val_best_f1_score: 0.7313; train_kl_reg_loss: 25824.2294; train_edge_recon_loss: 39234.8490; train_gene_expr_recon_loss: 663481.3333; train_masked_gp_l1_reg_loss: 8929.3049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87237.1085; train_chrom_access_recon_loss: 1303886.4861; train_global_loss: 2128593.3056; train_optim_loss: 2128593.3056; val_kl_reg_loss: 25607.5977; val_edge_recon_loss: 40574.7891; val_gene_expr_recon_loss: 673678.2500; val_masked_gp_l1_reg_loss: 8897.7432; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83993.1250; val_chrom_access_recon_loss: 1304821.0000; val_global_loss: 2137572.5000; val_optim_loss: 2137572.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8474; val_auprc_score: 0.8401; val_best_acc_score: 0.6593; val_best_f1_score: 0.7399; train_kl_reg_loss: 25661.5866; train_edge_recon_loss: 39236.6562; train_gene_expr_recon_loss: 660879.0278; train_masked_gp_l1_reg_loss: 8875.6678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81562.2378; train_chrom_access_recon_loss: 1298911.9028; train_global_loss: 2115127.0833; train_optim_loss: 2115127.0833; val_kl_reg_loss: 24791.5586; val_edge_recon_loss: 40558.3047; val_gene_expr_recon_loss: 670729.3750; val_masked_gp_l1_reg_loss: 8851.3457; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78619.5703; val_chrom_access_recon_loss: 1302262.5000; val_global_loss: 2125812.7500; val_optim_loss: 2125812.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8648; val_auprc_score: 0.8630; val_best_acc_score: 0.6857; val_best_f1_score: 0.7533; train_kl_reg_loss: 25294.0898; train_edge_recon_loss: 39218.2504; train_gene_expr_recon_loss: 659084.1528; train_masked_gp_l1_reg_loss: 8838.3660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76418.1719; train_chrom_access_recon_loss: 1301115.0278; train_global_loss: 2109968.0694; train_optim_loss: 2109968.0694; val_kl_reg_loss: 24186.7500; val_edge_recon_loss: 40542.6836; val_gene_expr_recon_loss: 668532.6250; val_masked_gp_l1_reg_loss: 8815.6816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73737.9609; val_chrom_access_recon_loss: 1300032.6250; val_global_loss: 2115848.2500; val_optim_loss: 2115848.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8676; val_auprc_score: 0.8649; val_best_acc_score: 0.7067; val_best_f1_score: 0.7640; train_kl_reg_loss: 24844.9342; train_edge_recon_loss: 39196.7990; train_gene_expr_recon_loss: 655150.7986; train_masked_gp_l1_reg_loss: 8805.2881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71727.0990; train_chrom_access_recon_loss: 1300847.3472; train_global_loss: 2100572.2639; train_optim_loss: 2100572.2639; val_kl_reg_loss: 23367.7227; val_edge_recon_loss: 40527.8477; val_gene_expr_recon_loss: 667056.5000; val_masked_gp_l1_reg_loss: 8793.9902; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69279.2500; val_chrom_access_recon_loss: 1297822.2500; val_global_loss: 2106847.5000; val_optim_loss: 2106847.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8851; val_auprc_score: 0.8812; val_best_acc_score: 0.7354; val_best_f1_score: 0.7807; train_kl_reg_loss: 24387.2476; train_edge_recon_loss: 39171.2431; train_gene_expr_recon_loss: 658178.3819; train_masked_gp_l1_reg_loss: 8790.9084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67448.4523; train_chrom_access_recon_loss: 1302638.1111; train_global_loss: 2100614.3889; train_optim_loss: 2100614.3889; val_kl_reg_loss: 23092.3281; val_edge_recon_loss: 40502.6250; val_gene_expr_recon_loss: 664973.1250; val_masked_gp_l1_reg_loss: 8773.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65209.0430; val_chrom_access_recon_loss: 1298132.7500; val_global_loss: 2100683.7500; val_optim_loss: 2100683.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8921; val_auprc_score: 0.8921; val_best_acc_score: 0.7560; val_best_f1_score: 0.7931; train_kl_reg_loss: 23907.3147; train_edge_recon_loss: 39147.3034; train_gene_expr_recon_loss: 650225.9097; train_masked_gp_l1_reg_loss: 8767.8191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63534.8646; train_chrom_access_recon_loss: 1290563.3889; train_global_loss: 2076146.5972; train_optim_loss: 2076146.5972; val_kl_reg_loss: 22646.0488; val_edge_recon_loss: 40491.5000; val_gene_expr_recon_loss: 663066.6250; val_masked_gp_l1_reg_loss: 8755.9863; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61475.9062; val_chrom_access_recon_loss: 1296114.2500; val_global_loss: 2092550.3750; val_optim_loss: 2092550.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9027; val_auprc_score: 0.8964; val_best_acc_score: 0.8027; val_best_f1_score: 0.8243; train_kl_reg_loss: 23362.6695; train_edge_recon_loss: 39103.8090; train_gene_expr_recon_loss: 649691.0694; train_masked_gp_l1_reg_loss: 8752.9905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59927.8707; train_chrom_access_recon_loss: 1294704.3333; train_global_loss: 2075542.7361; train_optim_loss: 2075542.7361; val_kl_reg_loss: 22354.9531; val_edge_recon_loss: 40453.1289; val_gene_expr_recon_loss: 661264.3750; val_masked_gp_l1_reg_loss: 8745.1523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58036.9062; val_chrom_access_recon_loss: 1293628.0000; val_global_loss: 2084482.5000; val_optim_loss: 2084482.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9104; val_auprc_score: 0.9014; val_best_acc_score: 0.8266; val_best_f1_score: 0.8407; train_kl_reg_loss: 22952.4677; train_edge_recon_loss: 39067.6311; train_gene_expr_recon_loss: 648616.6181; train_masked_gp_l1_reg_loss: 8740.9558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56614.1771; train_chrom_access_recon_loss: 1292758.1111; train_global_loss: 2068749.9583; train_optim_loss: 2068749.9583; val_kl_reg_loss: 22194.3477; val_edge_recon_loss: 40428.8164; val_gene_expr_recon_loss: 659473.3750; val_masked_gp_l1_reg_loss: 8737.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54865.9570; val_chrom_access_recon_loss: 1292175.8750; val_global_loss: 2077875.7500; val_optim_loss: 2077875.7500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9122; val_auprc_score: 0.9032; val_best_acc_score: 0.8382; val_best_f1_score: 0.8473; train_kl_reg_loss: 22655.5729; train_edge_recon_loss: 39030.9102; train_gene_expr_recon_loss: 649662.6389; train_masked_gp_l1_reg_loss: 8736.2146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53549.0851; train_chrom_access_recon_loss: 1293962.7500; train_global_loss: 2067597.2083; train_optim_loss: 2067597.2083; val_kl_reg_loss: 21806.5410; val_edge_recon_loss: 40382.3633; val_gene_expr_recon_loss: 658043.8750; val_masked_gp_l1_reg_loss: 8738.8066; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51933.8516; val_chrom_access_recon_loss: 1290242.3750; val_global_loss: 2071147.7500; val_optim_loss: 2071147.7500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9222; val_auprc_score: 0.9099; val_best_acc_score: 0.8514; val_best_f1_score: 0.8548; train_kl_reg_loss: 22330.8398; train_edge_recon_loss: 38967.0373; train_gene_expr_recon_loss: 646741.7361; train_masked_gp_l1_reg_loss: 8741.1241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50718.5482; train_chrom_access_recon_loss: 1291896.7778; train_global_loss: 2059396.0694; train_optim_loss: 2059396.0694; val_kl_reg_loss: 21367.6641; val_edge_recon_loss: 40299.5039; val_gene_expr_recon_loss: 656860.9375; val_masked_gp_l1_reg_loss: 8741.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49225.7266; val_chrom_access_recon_loss: 1288540.8750; val_global_loss: 2065036.5000; val_optim_loss: 2065036.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9243; val_auprc_score: 0.9096; val_best_acc_score: 0.8507; val_best_f1_score: 0.8500; train_kl_reg_loss: 21944.8542; train_edge_recon_loss: 38883.0326; train_gene_expr_recon_loss: 648842.4097; train_masked_gp_l1_reg_loss: 8739.5164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48100.6050; train_chrom_access_recon_loss: 1292404.9444; train_global_loss: 2058915.3611; train_optim_loss: 2058915.3611; val_kl_reg_loss: 20951.1211; val_edge_recon_loss: 40216.9805; val_gene_expr_recon_loss: 655464.7500; val_masked_gp_l1_reg_loss: 8736.9541; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46722.3906; val_chrom_access_recon_loss: 1286246.5000; val_global_loss: 2058338.7500; val_optim_loss: 2058338.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9261; val_auprc_score: 0.9104; val_best_acc_score: 0.8472; val_best_f1_score: 0.8428; train_kl_reg_loss: 21685.6395; train_edge_recon_loss: 38812.0681; train_gene_expr_recon_loss: 644885.5625; train_masked_gp_l1_reg_loss: 8739.2580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45683.5204; train_chrom_access_recon_loss: 1287814.2639; train_global_loss: 2047620.3056; train_optim_loss: 2047620.3056; val_kl_reg_loss: 20988.2363; val_edge_recon_loss: 40103.1953; val_gene_expr_recon_loss: 654002.6875; val_masked_gp_l1_reg_loss: 8741.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44399.1211; val_chrom_access_recon_loss: 1284657.3750; val_global_loss: 2052892.1250; val_optim_loss: 2052892.1250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9336; val_auprc_score: 0.9231; val_best_acc_score: 0.8463; val_best_f1_score: 0.8378; train_kl_reg_loss: 21569.2782; train_edge_recon_loss: 38718.9141; train_gene_expr_recon_loss: 647227.8264; train_masked_gp_l1_reg_loss: 8738.8465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43429.0373; train_chrom_access_recon_loss: 1286922.1944; train_global_loss: 2046606.0833; train_optim_loss: 2046606.0833; val_kl_reg_loss: 20856.8945; val_edge_recon_loss: 40019.8594; val_gene_expr_recon_loss: 652698.8125; val_masked_gp_l1_reg_loss: 8731.4902; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42236.3125; val_chrom_access_recon_loss: 1282218.0000; val_global_loss: 2046761.3750; val_optim_loss: 2046761.3750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9325; val_auprc_score: 0.9217; val_best_acc_score: 0.8286; val_best_f1_score: 0.8304; train_kl_reg_loss: 21409.4015; train_edge_recon_loss: 38632.9935; train_gene_expr_recon_loss: 642590.3333; train_masked_gp_l1_reg_loss: 8738.9862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41340.0065; train_chrom_access_recon_loss: 1284147.0139; train_global_loss: 2036858.7361; train_optim_loss: 2036858.7361; val_kl_reg_loss: 20361.4805; val_edge_recon_loss: 39878.5703; val_gene_expr_recon_loss: 651923.0000; val_masked_gp_l1_reg_loss: 8735.1162; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40221.6797; val_chrom_access_recon_loss: 1280171.3750; val_global_loss: 2041291.2500; val_optim_loss: 2041291.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9340; val_auprc_score: 0.9229; val_best_acc_score: 0.8689; val_best_f1_score: 0.8743; train_kl_reg_loss: 17447.5280; train_edge_recon_loss: 40064.0807; train_gene_expr_recon_loss: 980014.6736; train_masked_gp_l1_reg_loss: 8936.0707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39196.7938; train_chrom_access_recon_loss: 1354934.3333; train_global_loss: 2440593.5000; train_optim_loss: 2440593.5000; val_kl_reg_loss: 13437.6973; val_edge_recon_loss: 40320.0000; val_gene_expr_recon_loss: 992197.0000; val_masked_gp_l1_reg_loss: 9330.2822; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37820.6992; val_chrom_access_recon_loss: 1355004.8750; val_global_loss: 2448110.5000; val_optim_loss: 2448110.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9364; val_auprc_score: 0.9271; val_best_acc_score: 0.8593; val_best_f1_score: 0.8689; train_kl_reg_loss: 15887.1439; train_edge_recon_loss: 40114.8707; train_gene_expr_recon_loss: 969443.1111; train_masked_gp_l1_reg_loss: 9702.1930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36696.3199; train_chrom_access_recon_loss: 1352330.1944; train_global_loss: 2424173.8889; train_optim_loss: 2424173.8889; val_kl_reg_loss: 13837.1650; val_edge_recon_loss: 40369.5898; val_gene_expr_recon_loss: 983169.1250; val_masked_gp_l1_reg_loss: 10122.2383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35325.2109; val_chrom_access_recon_loss: 1352116.5000; val_global_loss: 2434940.0000; val_optim_loss: 2434940.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9361; val_auprc_score: 0.9294; val_best_acc_score: 0.8632; val_best_f1_score: 0.8708; train_kl_reg_loss: 15761.4592; train_edge_recon_loss: 40156.8737; train_gene_expr_recon_loss: 964989.9653; train_masked_gp_l1_reg_loss: 10391.7171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34296.5087; train_chrom_access_recon_loss: 1346932.4306; train_global_loss: 2412528.9722; train_optim_loss: 2412528.9722; val_kl_reg_loss: 14099.6553; val_edge_recon_loss: 40357.9844; val_gene_expr_recon_loss: 976404.3125; val_masked_gp_l1_reg_loss: 10669.2559; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33053.4180; val_chrom_access_recon_loss: 1349675.1250; val_global_loss: 2424259.7500; val_optim_loss: 2424259.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9349; val_auprc_score: 0.9242; val_best_acc_score: 0.8635; val_best_f1_score: 0.8701; train_kl_reg_loss: 15752.8434; train_edge_recon_loss: 40147.9019; train_gene_expr_recon_loss: 957847.6042; train_masked_gp_l1_reg_loss: 10834.1810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32136.1115; train_chrom_access_recon_loss: 1348162.4306; train_global_loss: 2404881.0833; train_optim_loss: 2404881.0833; val_kl_reg_loss: 14412.8135; val_edge_recon_loss: 40337.2070; val_gene_expr_recon_loss: 971135.5000; val_masked_gp_l1_reg_loss: 11004.3857; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31029.6133; val_chrom_access_recon_loss: 1347391.5000; val_global_loss: 2415311.0000; val_optim_loss: 2415311.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9352; val_auprc_score: 0.9265; val_best_acc_score: 0.8628; val_best_f1_score: 0.8698; train_kl_reg_loss: 15691.5157; train_edge_recon_loss: 40136.9071; train_gene_expr_recon_loss: 955650.6111; train_masked_gp_l1_reg_loss: 10936.1251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30860.6873; train_chrom_access_recon_loss: 1347983.2500; train_global_loss: 2401259.1111; train_optim_loss: 2401259.1111; val_kl_reg_loss: 14786.2188; val_edge_recon_loss: 40329.8242; val_gene_expr_recon_loss: 970449.1250; val_masked_gp_l1_reg_loss: 10883.1592; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30670.4316; val_chrom_access_recon_loss: 1347335.2500; val_global_loss: 2414454.0000; val_optim_loss: 2414454.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9374; val_auprc_score: 0.9311; val_best_acc_score: 0.8676; val_best_f1_score: 0.8737; train_kl_reg_loss: 15962.3668; train_edge_recon_loss: 40140.4388; train_gene_expr_recon_loss: 951355.9375; train_masked_gp_l1_reg_loss: 10873.9010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30554.8305; train_chrom_access_recon_loss: 1338686.0556; train_global_loss: 2387573.4722; train_optim_loss: 2387573.4722; val_kl_reg_loss: 14815.5234; val_edge_recon_loss: 40325.6797; val_gene_expr_recon_loss: 970096.7500; val_masked_gp_l1_reg_loss: 10854.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30405.9492; val_chrom_access_recon_loss: 1346846.6250; val_global_loss: 2413345.0000; val_optim_loss: 2413345.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9317; val_auprc_score: 0.9231; val_best_acc_score: 0.8622; val_best_f1_score: 0.8690; train_kl_reg_loss: 15890.2663; train_edge_recon_loss: 40134.0152; train_gene_expr_recon_loss: 954621.2292; train_masked_gp_l1_reg_loss: 10845.4544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30298.3546; train_chrom_access_recon_loss: 1348373.5694; train_global_loss: 2400162.8889; train_optim_loss: 2400162.8889; val_kl_reg_loss: 14670.0801; val_edge_recon_loss: 40318.7578; val_gene_expr_recon_loss: 969881.3750; val_masked_gp_l1_reg_loss: 10836.0342; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30166.9824; val_chrom_access_recon_loss: 1346956.8750; val_global_loss: 2412830.0000; val_optim_loss: 2412830.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9328; val_auprc_score: 0.9175; val_best_acc_score: 0.8642; val_best_f1_score: 0.8706; train_kl_reg_loss: 15796.6694; train_edge_recon_loss: 40124.5699; train_gene_expr_recon_loss: 957147.1736; train_masked_gp_l1_reg_loss: 10832.0873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30066.8214; train_chrom_access_recon_loss: 1344219.7639; train_global_loss: 2398187.1389; train_optim_loss: 2398187.1389; val_kl_reg_loss: 14727.1855; val_edge_recon_loss: 40315.8086; val_gene_expr_recon_loss: 969426.7500; val_masked_gp_l1_reg_loss: 10829.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29946.9102; val_chrom_access_recon_loss: 1346659.8750; val_global_loss: 2411905.7500; val_optim_loss: 2411905.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 36 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9350
val AUPRC score: 0.9268
val best accuracy score: 0.8593
val best F1 score: 0.8677
val target rna MSE score: 3.9960
val source rna MSE score: 3.4372
val target atac MSE score: 0.1344
val source atac MSE score: 0.0202
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
