[True]
Run timestamp: 21072023_201133_2036.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '24', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_2036']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 635067
Number of validation edges: 70562
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8937; val_auprc_score: 0.9781; val_best_acc_score: 0.8531; val_best_f1_score: 0.9207; train_kl_reg_loss: 756490.6454; train_edge_recon_loss: 11348128.3897; train_gene_expr_recon_loss: 261221399.7295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 273326018.8084; train_optim_loss: 273326018.8084; val_kl_reg_loss: 752837.3478; val_edge_recon_loss: 11942361.9275; val_gene_expr_recon_loss: 237994989.9130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 250690188.9855; val_optim_loss: 250690188.9855
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9021; val_auprc_score: 0.9795; val_best_acc_score: 0.8529; val_best_f1_score: 0.9206; train_kl_reg_loss: 661165.8139; train_edge_recon_loss: 11127183.4605; train_gene_expr_recon_loss: 237027731.4783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 248816080.5668; train_optim_loss: 248816080.5668; val_kl_reg_loss: 558186.3886; val_edge_recon_loss: 11986645.3188; val_gene_expr_recon_loss: 228176290.5507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 240721122.0870; val_optim_loss: 240721122.0870
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8743; val_auprc_score: 0.9733; val_best_acc_score: 0.8814; val_best_f1_score: 0.9349; train_kl_reg_loss: 453230.1359; train_edge_recon_loss: 10909037.1353; train_gene_expr_recon_loss: 232441755.0531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243804021.9002; train_optim_loss: 243804021.9002; val_kl_reg_loss: 114694.7535; val_edge_recon_loss: 11858730.7246; val_gene_expr_recon_loss: 236011916.7536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 247985342.1449; val_optim_loss: 247985342.1449
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8283; val_auprc_score: 0.9592; val_best_acc_score: 0.8726; val_best_f1_score: 0.9304; train_kl_reg_loss: 127320.9886; train_edge_recon_loss: 10740886.9010; train_gene_expr_recon_loss: 181916704.7601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 192784912.5539; train_optim_loss: 192784912.5539; val_kl_reg_loss: 66284.2390; val_edge_recon_loss: 11759400.0580; val_gene_expr_recon_loss: 91954192.1159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 103779876.0580; val_optim_loss: 103779876.0580
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8597; val_auprc_score: 0.9665; val_best_acc_score: 0.8900; val_best_f1_score: 0.9380; train_kl_reg_loss: 90785.5851; train_edge_recon_loss: 10321840.2383; train_gene_expr_recon_loss: 89079346.2673; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 99491972.1610; train_optim_loss: 99491972.1610; val_kl_reg_loss: 81881.4785; val_edge_recon_loss: 11263192.8116; val_gene_expr_recon_loss: 86755764.1739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98100838.8406; val_optim_loss: 98100838.8406
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8701; val_auprc_score: 0.9693; val_best_acc_score: 0.9011; val_best_f1_score: 0.9444; train_kl_reg_loss: 67380.4962; train_edge_recon_loss: 9975414.4026; train_gene_expr_recon_loss: 85839569.7262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95882364.4960; train_optim_loss: 95882364.4960; val_kl_reg_loss: 55028.1887; val_edge_recon_loss: 10022501.5217; val_gene_expr_recon_loss: 84447989.4493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94525518.3768; val_optim_loss: 94525518.3768
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8783; val_auprc_score: 0.9710; val_best_acc_score: 0.9047; val_best_f1_score: 0.9459; train_kl_reg_loss: 63859.5287; train_edge_recon_loss: 9443014.8696; train_gene_expr_recon_loss: 83772315.7359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93279190.0290; train_optim_loss: 93279190.0290; val_kl_reg_loss: 76489.6454; val_edge_recon_loss: 9301198.8333; val_gene_expr_recon_loss: 82687675.5942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 92065364.7536; val_optim_loss: 92065364.7536
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8782; val_auprc_score: 0.9717; val_best_acc_score: 0.9052; val_best_f1_score: 0.9466; train_kl_reg_loss: 97288.3659; train_edge_recon_loss: 8986725.4034; train_gene_expr_recon_loss: 82136326.0548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 91220339.7101; train_optim_loss: 91220339.7101; val_kl_reg_loss: 116052.6733; val_edge_recon_loss: 8895994.2029; val_gene_expr_recon_loss: 81201068.6377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 90213115.3623; val_optim_loss: 90213115.3623
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8843; val_auprc_score: 0.9738; val_best_acc_score: 0.9084; val_best_f1_score: 0.9485; train_kl_reg_loss: 126986.6989; train_edge_recon_loss: 8750220.6522; train_gene_expr_recon_loss: 80784438.0805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 89661645.5008; train_optim_loss: 89661645.5008; val_kl_reg_loss: 128855.7882; val_edge_recon_loss: 8671642.2101; val_gene_expr_recon_loss: 79992887.7681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 88793385.8551; val_optim_loss: 88793385.8551
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8961; val_auprc_score: 0.9769; val_best_acc_score: 0.9106; val_best_f1_score: 0.9497; train_kl_reg_loss: 131984.8809; train_edge_recon_loss: 8595398.7874; train_gene_expr_recon_loss: 79748979.3752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 88476363.1304; train_optim_loss: 88476363.1304; val_kl_reg_loss: 125672.0320; val_edge_recon_loss: 8575439.7681; val_gene_expr_recon_loss: 79129540.4058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87830652.1739; val_optim_loss: 87830652.1739
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9022; val_auprc_score: 0.9780; val_best_acc_score: 0.9133; val_best_f1_score: 0.9511; train_kl_reg_loss: 122039.5102; train_edge_recon_loss: 8478805.3132; train_gene_expr_recon_loss: 78916655.7166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 87517500.5217; train_optim_loss: 87517500.5217; val_kl_reg_loss: 108682.1535; val_edge_recon_loss: 8473475.1667; val_gene_expr_recon_loss: 78483251.3623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87065408.5797; val_optim_loss: 87065408.5797
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9176; val_auprc_score: 0.9820; val_best_acc_score: 0.9191; val_best_f1_score: 0.9539; train_kl_reg_loss: 109293.3739; train_edge_recon_loss: 8359070.5451; train_gene_expr_recon_loss: 77498074.6151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85966438.5314; train_optim_loss: 85966438.5314; val_kl_reg_loss: 105891.0207; val_edge_recon_loss: 8323739.7101; val_gene_expr_recon_loss: 77116128.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85545758.6087; val_optim_loss: 85545758.6087
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9205; val_auprc_score: 0.9822; val_best_acc_score: 0.9223; val_best_f1_score: 0.9558; train_kl_reg_loss: 103070.0429; train_edge_recon_loss: 8238428.4678; train_gene_expr_recon_loss: 76953596.5475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85295095.0338; train_optim_loss: 85295095.0338; val_kl_reg_loss: 98054.8165; val_edge_recon_loss: 8307006.7609; val_gene_expr_recon_loss: 76561274.2029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84966335.5362; val_optim_loss: 84966335.5362
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9226; val_auprc_score: 0.9822; val_best_acc_score: 0.9248; val_best_f1_score: 0.9570; train_kl_reg_loss: 96207.9375; train_edge_recon_loss: 8168062.2150; train_gene_expr_recon_loss: 76570175.9871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84834446.1320; train_optim_loss: 84834446.1320; val_kl_reg_loss: 94337.2199; val_edge_recon_loss: 8310298.3188; val_gene_expr_recon_loss: 76355451.7101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84760087.0725; val_optim_loss: 84760087.0725
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9216; val_auprc_score: 0.9820; val_best_acc_score: 0.9272; val_best_f1_score: 0.9584; train_kl_reg_loss: 92948.3600; train_edge_recon_loss: 8123479.0008; train_gene_expr_recon_loss: 76309333.8744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84525761.1594; train_optim_loss: 84525761.1594; val_kl_reg_loss: 90411.7780; val_edge_recon_loss: 8263670.2391; val_gene_expr_recon_loss: 76140127.3043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84494209.2754; val_optim_loss: 84494209.2754
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9283; val_auprc_score: 0.9839; val_best_acc_score: 0.9309; val_best_f1_score: 0.9605; train_kl_reg_loss: 88992.8031; train_edge_recon_loss: 8107147.1111; train_gene_expr_recon_loss: 76095768.7343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84291908.7923; train_optim_loss: 84291908.7923; val_kl_reg_loss: 86397.3554; val_edge_recon_loss: 8010944.7101; val_gene_expr_recon_loss: 75930093.9130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84027436.0580; val_optim_loss: 84027436.0580
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9242; val_auprc_score: 0.9827; val_best_acc_score: 0.9288; val_best_f1_score: 0.9593; train_kl_reg_loss: 85102.5229; train_edge_recon_loss: 8091393.6127; train_gene_expr_recon_loss: 75879664.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84056160.3092; train_optim_loss: 84056160.3092; val_kl_reg_loss: 81301.6529; val_edge_recon_loss: 8144109.1159; val_gene_expr_recon_loss: 75673484.4058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83898894.8406; val_optim_loss: 83898894.8406
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9313; val_auprc_score: 0.9848; val_best_acc_score: 0.9318; val_best_f1_score: 0.9609; train_kl_reg_loss: 79364.6528; train_edge_recon_loss: 8057000.4928; train_gene_expr_recon_loss: 75624752.2190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83761117.3720; train_optim_loss: 83761117.3720; val_kl_reg_loss: 74348.3490; val_edge_recon_loss: 8105928.7174; val_gene_expr_recon_loss: 75341005.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83521282.2029; val_optim_loss: 83521282.2029
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9364; val_auprc_score: 0.9860; val_best_acc_score: 0.9318; val_best_f1_score: 0.9609; train_kl_reg_loss: 73652.9533; train_edge_recon_loss: 8029576.6071; train_gene_expr_recon_loss: 75395619.1948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83498848.7729; train_optim_loss: 83498848.7729; val_kl_reg_loss: 68365.2644; val_edge_recon_loss: 8137819.0725; val_gene_expr_recon_loss: 75415669.4493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83621853.6812; val_optim_loss: 83621853.6812
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9416; val_auprc_score: 0.9872; val_best_acc_score: 0.9358; val_best_f1_score: 0.9632; train_kl_reg_loss: 64998.0799; train_edge_recon_loss: 8006281.3905; train_gene_expr_recon_loss: 75678730.5250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83750009.9066; train_optim_loss: 83750009.9066; val_kl_reg_loss: 59987.9248; val_edge_recon_loss: 7937023.2246; val_gene_expr_recon_loss: 75165867.0145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83162878.4928; val_optim_loss: 83162878.4928
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9475; val_auprc_score: 0.9886; val_best_acc_score: 0.9368; val_best_f1_score: 0.9637; train_kl_reg_loss: 62906.7278; train_edge_recon_loss: 7994838.8841; train_gene_expr_recon_loss: 75129641.3269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83187386.8728; train_optim_loss: 83187386.8728; val_kl_reg_loss: 65182.0130; val_edge_recon_loss: 8019499.2464; val_gene_expr_recon_loss: 74861893.1014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82946574.0290; val_optim_loss: 82946574.0290
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9450; val_auprc_score: 0.9873; val_best_acc_score: 0.9352; val_best_f1_score: 0.9628; train_kl_reg_loss: 63434.2526; train_edge_recon_loss: 8014344.6602; train_gene_expr_recon_loss: 75478703.0596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83556481.9968; train_optim_loss: 83556481.9968; val_kl_reg_loss: 67361.2849; val_edge_recon_loss: 8034718.6087; val_gene_expr_recon_loss: 75272263.6522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83374343.5362; val_optim_loss: 83374343.5362
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9494; val_auprc_score: 0.9882; val_best_acc_score: 0.9343; val_best_f1_score: 0.9620; train_kl_reg_loss: 66804.4476; train_edge_recon_loss: 7958873.6014; train_gene_expr_recon_loss: 75494903.8712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83520581.7842; train_optim_loss: 83520581.7842; val_kl_reg_loss: 65609.9126; val_edge_recon_loss: 8161592.4710; val_gene_expr_recon_loss: 75491359.6522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83718562.2029; val_optim_loss: 83718562.2029
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9560; val_auprc_score: 0.9902; val_best_acc_score: 0.9400; val_best_f1_score: 0.9652; train_kl_reg_loss: 65970.0607; train_edge_recon_loss: 7934532.1924; train_gene_expr_recon_loss: 75574456.6312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83574958.8663; train_optim_loss: 83574958.8663; val_kl_reg_loss: 69013.4799; val_edge_recon_loss: 8063128.3986; val_gene_expr_recon_loss: 76357571.8261; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84489713.8551; val_optim_loss: 84489713.8551
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9498; val_auprc_score: 0.9890; val_best_acc_score: 0.9377; val_best_f1_score: 0.9640; train_kl_reg_loss: 64680.9350; train_edge_recon_loss: 7972464.4444; train_gene_expr_recon_loss: 75911994.5250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83949140.0837; train_optim_loss: 83949140.0837; val_kl_reg_loss: 60183.9779; val_edge_recon_loss: 7904304.1812; val_gene_expr_recon_loss: 77703666.7826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85668155.4783; val_optim_loss: 85668155.4783

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9474; val_auprc_score: 0.9880; val_best_acc_score: 0.9395; val_best_f1_score: 0.9651; train_kl_reg_loss: 66871.4580; train_edge_recon_loss: 8743587.2617; train_gene_expr_recon_loss: 76353207.2657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85163665.8937; train_optim_loss: 85163665.8937; val_kl_reg_loss: 15082.9887; val_edge_recon_loss: 8708849.9348; val_gene_expr_recon_loss: 78602148.7536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 87326081.5072; val_optim_loss: 87326081.5072
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9453; val_auprc_score: 0.9875; val_best_acc_score: 0.9396; val_best_f1_score: 0.9651; train_kl_reg_loss: 69662.3478; train_edge_recon_loss: 8521704.9936; train_gene_expr_recon_loss: 76411443.3623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 85002810.7568; train_optim_loss: 85002810.7568; val_kl_reg_loss: 15058.5999; val_edge_recon_loss: 8584421.0797; val_gene_expr_recon_loss: 73687443.7101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82286923.1304; val_optim_loss: 82286923.1304
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9479; val_auprc_score: 0.9882; val_best_acc_score: 0.9409; val_best_f1_score: 0.9659; train_kl_reg_loss: 70993.7519; train_edge_recon_loss: 8415787.2770; train_gene_expr_recon_loss: 76252020.1353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84738800.9791; train_optim_loss: 84738800.9791; val_kl_reg_loss: 15425.2297; val_edge_recon_loss: 8364218.1304; val_gene_expr_recon_loss: 76783512.4638; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85163155.4783; val_optim_loss: 85163155.4783
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9442; val_auprc_score: 0.9871; val_best_acc_score: 0.9398; val_best_f1_score: 0.9653; train_kl_reg_loss: 71835.9174; train_edge_recon_loss: 8330134.6763; train_gene_expr_recon_loss: 76186226.2287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84588196.9340; train_optim_loss: 84588196.9340; val_kl_reg_loss: 15116.6372; val_edge_recon_loss: 8365728.0145; val_gene_expr_recon_loss: 76025623.7681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84406468.9855; val_optim_loss: 84406468.9855
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9454; val_auprc_score: 0.9873; val_best_acc_score: 0.9408; val_best_f1_score: 0.9660; train_kl_reg_loss: 72057.3864; train_edge_recon_loss: 8312350.8027; train_gene_expr_recon_loss: 76238375.3559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84622783.6908; train_optim_loss: 84622783.6908; val_kl_reg_loss: 15209.2167; val_edge_recon_loss: 8325779.5145; val_gene_expr_recon_loss: 73851549.5652; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82192538.4348; val_optim_loss: 82192538.4348
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9438; val_auprc_score: 0.9869; val_best_acc_score: 0.9405; val_best_f1_score: 0.9658; train_kl_reg_loss: 71585.4490; train_edge_recon_loss: 8248969.5419; train_gene_expr_recon_loss: 76092146.2029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84412701.1272; train_optim_loss: 84412701.1272; val_kl_reg_loss: 14380.5158; val_edge_recon_loss: 8296054.0507; val_gene_expr_recon_loss: 78238549.7971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 86548984.2319; val_optim_loss: 86548984.2319
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9438; val_auprc_score: 0.9865; val_best_acc_score: 0.9389; val_best_f1_score: 0.9648; train_kl_reg_loss: 70520.8112; train_edge_recon_loss: 8256299.4984; train_gene_expr_recon_loss: 76086367.0209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84413187.3494; train_optim_loss: 84413187.3494; val_kl_reg_loss: 13903.6019; val_edge_recon_loss: 8426838.7246; val_gene_expr_recon_loss: 76984225.2754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85424967.3043; val_optim_loss: 85424967.3043
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9452; val_auprc_score: 0.9874; val_best_acc_score: 0.9412; val_best_f1_score: 0.9662; train_kl_reg_loss: 68809.6948; train_edge_recon_loss: 8240408.1103; train_gene_expr_recon_loss: 76285143.0982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 84594360.9662; train_optim_loss: 84594360.9662; val_kl_reg_loss: 13572.2916; val_edge_recon_loss: 8162180.8841; val_gene_expr_recon_loss: 75132934.3768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83308687.8841; val_optim_loss: 83308687.8841
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9431; val_auprc_score: 0.9868; val_best_acc_score: 0.9407; val_best_f1_score: 0.9660; train_kl_reg_loss: 67162.0500; train_edge_recon_loss: 8163181.3068; train_gene_expr_recon_loss: 75414400.7279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83644744.0258; train_optim_loss: 83644744.0258; val_kl_reg_loss: 13405.9625; val_edge_recon_loss: 8099218.4058; val_gene_expr_recon_loss: 76602133.9130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84714757.9130; val_optim_loss: 84714757.9130

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9436; val_auprc_score: 0.9869; val_best_acc_score: 0.9387; val_best_f1_score: 0.9647; train_kl_reg_loss: 66179.5829; train_edge_recon_loss: 8198498.6618; train_gene_expr_recon_loss: 75012313.2238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83276991.4074; train_optim_loss: 83276991.4074; val_kl_reg_loss: 13554.3147; val_edge_recon_loss: 8303388.3116; val_gene_expr_recon_loss: 71662713.9710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 79979656.3478; val_optim_loss: 79979656.3478
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9451; val_auprc_score: 0.9874; val_best_acc_score: 0.9392; val_best_f1_score: 0.9651; train_kl_reg_loss: 65979.0165; train_edge_recon_loss: 8177309.5660; train_gene_expr_recon_loss: 75073475.5233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83316764.0064; train_optim_loss: 83316764.0064; val_kl_reg_loss: 13462.0753; val_edge_recon_loss: 8233321.3841; val_gene_expr_recon_loss: 75067918.7246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83314702.3768; val_optim_loss: 83314702.3768
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9445; val_auprc_score: 0.9872; val_best_acc_score: 0.9401; val_best_f1_score: 0.9655; train_kl_reg_loss: 65703.0253; train_edge_recon_loss: 8203543.1731; train_gene_expr_recon_loss: 74967231.0531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83236477.1787; train_optim_loss: 83236477.1787; val_kl_reg_loss: 13455.2211; val_edge_recon_loss: 8228664.8768; val_gene_expr_recon_loss: 77748263.0725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85990383.3043; val_optim_loss: 85990383.3043
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9446; val_auprc_score: 0.9871; val_best_acc_score: 0.9392; val_best_f1_score: 0.9651; train_kl_reg_loss: 65460.7186; train_edge_recon_loss: 8168855.6208; train_gene_expr_recon_loss: 75040928.2190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83275244.5990; train_optim_loss: 83275244.5990; val_kl_reg_loss: 13523.5393; val_edge_recon_loss: 8242985.7391; val_gene_expr_recon_loss: 76169164.5217; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84425674.0870; val_optim_loss: 84425674.0870
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9442; val_auprc_score: 0.9870; val_best_acc_score: 0.9393; val_best_f1_score: 0.9650; train_kl_reg_loss: 65150.0844; train_edge_recon_loss: 8174273.1675; train_gene_expr_recon_loss: 75218435.0531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83457858.4863; train_optim_loss: 83457858.4863; val_kl_reg_loss: 13374.2719; val_edge_recon_loss: 8282007.1884; val_gene_expr_recon_loss: 75903420.6377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84198802.5507; val_optim_loss: 84198802.5507

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9452; val_auprc_score: 0.9875; val_best_acc_score: 0.9404; val_best_f1_score: 0.9657; train_kl_reg_loss: 65063.4308; train_edge_recon_loss: 8169316.8285; train_gene_expr_recon_loss: 74734782.6087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 82969163.0403; train_optim_loss: 82969163.0403; val_kl_reg_loss: 13357.4612; val_edge_recon_loss: 8175129.2319; val_gene_expr_recon_loss: 74803299.7101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82991787.0145; val_optim_loss: 82991787.0145
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9454; val_auprc_score: 0.9877; val_best_acc_score: 0.9404; val_best_f1_score: 0.9658; train_kl_reg_loss: 64970.0066; train_edge_recon_loss: 8201713.7697; train_gene_expr_recon_loss: 74879939.0531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83146622.9436; train_optim_loss: 83146622.9436; val_kl_reg_loss: 13380.8740; val_edge_recon_loss: 8162557.1739; val_gene_expr_recon_loss: 74861335.6522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 83037273.5072; val_optim_loss: 83037273.5072
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9437; val_auprc_score: 0.9870; val_best_acc_score: 0.9401; val_best_f1_score: 0.9656; train_kl_reg_loss: 64945.7273; train_edge_recon_loss: 8179797.6047; train_gene_expr_recon_loss: 74777992.8245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 83022736.1417; train_optim_loss: 83022736.1417; val_kl_reg_loss: 13380.7012; val_edge_recon_loss: 8171289.2174; val_gene_expr_recon_loss: 74643416.8116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82828086.8406; val_optim_loss: 82828086.8406
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9436; val_auprc_score: 0.9872; val_best_acc_score: 0.9398; val_best_f1_score: 0.9654; train_kl_reg_loss: 64858.8228; train_edge_recon_loss: 8146095.4300; train_gene_expr_recon_loss: 74133937.6618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 82344891.8132; train_optim_loss: 82344891.8132; val_kl_reg_loss: 13368.3124; val_edge_recon_loss: 8145573.8478; val_gene_expr_recon_loss: 74215074.0870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 82374016.6957; val_optim_loss: 82374016.6957

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 566 min 3 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
Val AUROC score: 0.9440
Val AUPRC score: 0.9873
Val best accuracy score: 0.9393
Val best F1 score: 0.9652
Val gene expr MSE score: 8721.9416
Val cat covariate0 mean sim diff: -0.0071

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
