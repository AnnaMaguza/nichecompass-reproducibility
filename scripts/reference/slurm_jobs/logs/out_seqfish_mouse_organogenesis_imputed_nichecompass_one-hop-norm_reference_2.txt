[True]
Run timestamp: 27072023_043901_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8418; val_auprc_score: 0.9664; val_best_acc_score: 0.8555; val_best_f1_score: 0.9221; train_kl_reg_loss: 83568.8582; train_edge_recon_loss: 117118.6997; train_gene_expr_recon_loss: 1512902.7945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1713590.3541; train_optim_loss: 1713590.3541; val_kl_reg_loss: 70544.3665; val_edge_recon_loss: 117464.6455; val_gene_expr_recon_loss: 1044895.4896; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1232904.4948; val_optim_loss: 1232904.4948
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8299; val_auprc_score: 0.9629; val_best_acc_score: 0.8693; val_best_f1_score: 0.9284; train_kl_reg_loss: 56330.7332; train_edge_recon_loss: 116943.3705; train_gene_expr_recon_loss: 1010704.3927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1183978.4983; train_optim_loss: 1183978.4983; val_kl_reg_loss: 46676.1388; val_edge_recon_loss: 117117.0866; val_gene_expr_recon_loss: 968103.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1131896.3594; val_optim_loss: 1131896.3594
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8501; val_auprc_score: 0.9682; val_best_acc_score: 0.8693; val_best_f1_score: 0.9275; train_kl_reg_loss: 41697.1108; train_edge_recon_loss: 114758.0723; train_gene_expr_recon_loss: 943533.7314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1099988.9140; train_optim_loss: 1099988.9140; val_kl_reg_loss: 38176.4287; val_edge_recon_loss: 115107.7087; val_gene_expr_recon_loss: 917457.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1070741.2344; val_optim_loss: 1070741.2344
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8623; val_auprc_score: 0.9711; val_best_acc_score: 0.8671; val_best_f1_score: 0.9267; train_kl_reg_loss: 34605.2869; train_edge_recon_loss: 112467.1751; train_gene_expr_recon_loss: 902093.8465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1049166.3084; train_optim_loss: 1049166.3084; val_kl_reg_loss: 32170.6817; val_edge_recon_loss: 114163.1436; val_gene_expr_recon_loss: 883119.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1029453.7240; val_optim_loss: 1029453.7240
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8738; val_auprc_score: 0.9741; val_best_acc_score: 0.8726; val_best_f1_score: 0.9289; train_kl_reg_loss: 30446.6960; train_edge_recon_loss: 110438.7346; train_gene_expr_recon_loss: 873075.4212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1013960.8520; train_optim_loss: 1013960.8520; val_kl_reg_loss: 28848.5305; val_edge_recon_loss: 109674.7725; val_gene_expr_recon_loss: 858175.6589; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 996698.9583; val_optim_loss: 996698.9583
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8954; val_auprc_score: 0.9780; val_best_acc_score: 0.8819; val_best_f1_score: 0.9333; train_kl_reg_loss: 27766.5214; train_edge_recon_loss: 106949.4476; train_gene_expr_recon_loss: 850264.5549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 984980.5218; train_optim_loss: 984980.5218; val_kl_reg_loss: 26893.6398; val_edge_recon_loss: 105965.6188; val_gene_expr_recon_loss: 837462.3776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 970321.6328; val_optim_loss: 970321.6328
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8969; val_auprc_score: 0.9784; val_best_acc_score: 0.8929; val_best_f1_score: 0.9395; train_kl_reg_loss: 25914.8183; train_edge_recon_loss: 103543.6631; train_gene_expr_recon_loss: 831029.8241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 960488.3049; train_optim_loss: 960488.3049; val_kl_reg_loss: 25029.4967; val_edge_recon_loss: 100692.6436; val_gene_expr_recon_loss: 819557.2292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 945279.3672; val_optim_loss: 945279.3672
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9067; val_auprc_score: 0.9809; val_best_acc_score: 0.9045; val_best_f1_score: 0.9460; train_kl_reg_loss: 24105.8850; train_edge_recon_loss: 101032.2537; train_gene_expr_recon_loss: 814053.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 939191.3174; train_optim_loss: 939191.3174; val_kl_reg_loss: 23204.8779; val_edge_recon_loss: 95447.9964; val_gene_expr_recon_loss: 803787.2370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 922440.1120; val_optim_loss: 922440.1120
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9135; val_auprc_score: 0.9827; val_best_acc_score: 0.9077; val_best_f1_score: 0.9477; train_kl_reg_loss: 22282.7347; train_edge_recon_loss: 99683.8079; train_gene_expr_recon_loss: 798927.6840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 920894.2294; train_optim_loss: 920894.2294; val_kl_reg_loss: 21519.2493; val_edge_recon_loss: 95840.0791; val_gene_expr_recon_loss: 789407.0807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 906766.4010; val_optim_loss: 906766.4010
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9175; val_auprc_score: 0.9821; val_best_acc_score: 0.9120; val_best_f1_score: 0.9495; train_kl_reg_loss: 20698.5048; train_edge_recon_loss: 97441.1500; train_gene_expr_recon_loss: 785260.1762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 903399.8288; train_optim_loss: 903399.8288; val_kl_reg_loss: 19922.0462; val_edge_recon_loss: 98471.5397; val_gene_expr_recon_loss: 776452.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 894845.7526; val_optim_loss: 894845.7526
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9218; val_auprc_score: 0.9831; val_best_acc_score: 0.9165; val_best_f1_score: 0.9521; train_kl_reg_loss: 19256.9826; train_edge_recon_loss: 96186.1080; train_gene_expr_recon_loss: 773169.4407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 888612.5308; train_optim_loss: 888612.5308; val_kl_reg_loss: 18628.1814; val_edge_recon_loss: 95054.0436; val_gene_expr_recon_loss: 765147.2318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 878829.4583; val_optim_loss: 878829.4583
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9225; val_auprc_score: 0.9840; val_best_acc_score: 0.9211; val_best_f1_score: 0.9551; train_kl_reg_loss: 17882.6338; train_edge_recon_loss: 92651.2518; train_gene_expr_recon_loss: 762023.1026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 872556.9881; train_optim_loss: 872556.9881; val_kl_reg_loss: 17180.8211; val_edge_recon_loss: 91975.0895; val_gene_expr_recon_loss: 754459.0260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 863614.9349; val_optim_loss: 863614.9349
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9285; val_auprc_score: 0.9842; val_best_acc_score: 0.9236; val_best_f1_score: 0.9564; train_kl_reg_loss: 16650.4230; train_edge_recon_loss: 92646.7919; train_gene_expr_recon_loss: 752028.9093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 861326.1238; train_optim_loss: 861326.1238; val_kl_reg_loss: 16201.6767; val_edge_recon_loss: 91997.6927; val_gene_expr_recon_loss: 746643.8099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 854843.1771; val_optim_loss: 854843.1771
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9224; val_auprc_score: 0.9833; val_best_acc_score: 0.9229; val_best_f1_score: 0.9560; train_kl_reg_loss: 15555.1552; train_edge_recon_loss: 91044.1645; train_gene_expr_recon_loss: 742961.1666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 849560.4858; train_optim_loss: 849560.4858; val_kl_reg_loss: 15033.9208; val_edge_recon_loss: 92262.0732; val_gene_expr_recon_loss: 735922.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 843218.1745; val_optim_loss: 843218.1745
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9309; val_auprc_score: 0.9843; val_best_acc_score: 0.9306; val_best_f1_score: 0.9603; train_kl_reg_loss: 14479.7774; train_edge_recon_loss: 89282.2447; train_gene_expr_recon_loss: 734239.9942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 838002.0140; train_optim_loss: 838002.0140; val_kl_reg_loss: 13948.5847; val_edge_recon_loss: 88354.5007; val_gene_expr_recon_loss: 729784.0260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 832087.1146; val_optim_loss: 832087.1146
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9340; val_auprc_score: 0.9852; val_best_acc_score: 0.9338; val_best_f1_score: 0.9620; train_kl_reg_loss: 13564.2784; train_edge_recon_loss: 88601.3921; train_gene_expr_recon_loss: 726726.5622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 828892.2314; train_optim_loss: 828892.2314; val_kl_reg_loss: 13086.2991; val_edge_recon_loss: 87632.9450; val_gene_expr_recon_loss: 721002.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 821721.9141; val_optim_loss: 821721.9141
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9347; val_auprc_score: 0.9858; val_best_acc_score: 0.9319; val_best_f1_score: 0.9610; train_kl_reg_loss: 12695.8153; train_edge_recon_loss: 87544.9866; train_gene_expr_recon_loss: 719500.8576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 819741.6605; train_optim_loss: 819741.6605; val_kl_reg_loss: 12300.0129; val_edge_recon_loss: 87305.3486; val_gene_expr_recon_loss: 714540.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 814145.8333; val_optim_loss: 814145.8333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9406; val_auprc_score: 0.9868; val_best_acc_score: 0.9316; val_best_f1_score: 0.9606; train_kl_reg_loss: 11861.9182; train_edge_recon_loss: 85217.1975; train_gene_expr_recon_loss: 713004.1555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 810083.2718; train_optim_loss: 810083.2718; val_kl_reg_loss: 11575.2902; val_edge_recon_loss: 88499.0358; val_gene_expr_recon_loss: 707917.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 807991.6667; val_optim_loss: 807991.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9432; val_auprc_score: 0.9875; val_best_acc_score: 0.9374; val_best_f1_score: 0.9640; train_kl_reg_loss: 11204.1267; train_edge_recon_loss: 85956.9810; train_gene_expr_recon_loss: 706863.5058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 804024.6134; train_optim_loss: 804024.6134; val_kl_reg_loss: 10824.2276; val_edge_recon_loss: 85072.2721; val_gene_expr_recon_loss: 702081.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 797977.8359; val_optim_loss: 797977.8359
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9444; val_auprc_score: 0.9872; val_best_acc_score: 0.9392; val_best_f1_score: 0.9651; train_kl_reg_loss: 10497.8939; train_edge_recon_loss: 84654.8265; train_gene_expr_recon_loss: 701132.1590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 796284.8799; train_optim_loss: 796284.8799; val_kl_reg_loss: 10173.7589; val_edge_recon_loss: 83912.5537; val_gene_expr_recon_loss: 696241.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 790327.4635; val_optim_loss: 790327.4635
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9472; val_auprc_score: 0.9879; val_best_acc_score: 0.9410; val_best_f1_score: 0.9660; train_kl_reg_loss: 9890.0513; train_edge_recon_loss: 83394.4627; train_gene_expr_recon_loss: 695946.6424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 789231.1552; train_optim_loss: 789231.1552; val_kl_reg_loss: 9568.9591; val_edge_recon_loss: 83238.8398; val_gene_expr_recon_loss: 691987.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 784795.3698; val_optim_loss: 784795.3698
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9515; val_auprc_score: 0.9891; val_best_acc_score: 0.9410; val_best_f1_score: 0.9660; train_kl_reg_loss: 9378.7851; train_edge_recon_loss: 82387.2998; train_gene_expr_recon_loss: 691230.5578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 782996.6419; train_optim_loss: 782996.6419; val_kl_reg_loss: 9124.7805; val_edge_recon_loss: 83072.9619; val_gene_expr_recon_loss: 687298.1224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 779495.8698; val_optim_loss: 779495.8698
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9559; val_auprc_score: 0.9909; val_best_acc_score: 0.9417; val_best_f1_score: 0.9665; train_kl_reg_loss: 8991.9288; train_edge_recon_loss: 82212.9851; train_gene_expr_recon_loss: 686936.2948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 778141.2081; train_optim_loss: 778141.2081; val_kl_reg_loss: 8885.5590; val_edge_recon_loss: 80994.4271; val_gene_expr_recon_loss: 683299.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 773179.7083; val_optim_loss: 773179.7083
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9538; val_auprc_score: 0.9896; val_best_acc_score: 0.9447; val_best_f1_score: 0.9680; train_kl_reg_loss: 8657.4376; train_edge_recon_loss: 81653.4111; train_gene_expr_recon_loss: 682872.0142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 773182.8613; train_optim_loss: 773182.8613; val_kl_reg_loss: 8430.7602; val_edge_recon_loss: 81797.2839; val_gene_expr_recon_loss: 678816.4323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 769044.4766; val_optim_loss: 769044.4766
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9534; val_auprc_score: 0.9897; val_best_acc_score: 0.9429; val_best_f1_score: 0.9671; train_kl_reg_loss: 8343.1580; train_edge_recon_loss: 81931.8090; train_gene_expr_recon_loss: 679144.5064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 769419.4727; train_optim_loss: 769419.4727; val_kl_reg_loss: 8130.0469; val_edge_recon_loss: 81076.8047; val_gene_expr_recon_loss: 675620.7995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 764827.6458; val_optim_loss: 764827.6458
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9562; val_auprc_score: 0.9906; val_best_acc_score: 0.9467; val_best_f1_score: 0.9694; train_kl_reg_loss: 8068.7990; train_edge_recon_loss: 80664.9202; train_gene_expr_recon_loss: 675491.5721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 764225.2927; train_optim_loss: 764225.2927; val_kl_reg_loss: 7975.0194; val_edge_recon_loss: 79070.8923; val_gene_expr_recon_loss: 671913.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 758959.5391; val_optim_loss: 758959.5391
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9572; val_auprc_score: 0.9897; val_best_acc_score: 0.9453; val_best_f1_score: 0.9682; train_kl_reg_loss: 7895.4393; train_edge_recon_loss: 81468.0817; train_gene_expr_recon_loss: 672205.1192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 761568.6387; train_optim_loss: 761568.6387; val_kl_reg_loss: 7764.5968; val_edge_recon_loss: 81600.7428; val_gene_expr_recon_loss: 668847.1380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 758212.4818; val_optim_loss: 758212.4818
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9565; val_auprc_score: 0.9892; val_best_acc_score: 0.9465; val_best_f1_score: 0.9688; train_kl_reg_loss: 7701.8904; train_edge_recon_loss: 80062.9471; train_gene_expr_recon_loss: 669254.2189; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 757019.0547; train_optim_loss: 757019.0547; val_kl_reg_loss: 7585.7466; val_edge_recon_loss: 81761.6888; val_gene_expr_recon_loss: 665947.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 755295.2656; val_optim_loss: 755295.2656
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9546; val_auprc_score: 0.9892; val_best_acc_score: 0.9446; val_best_f1_score: 0.9679; train_kl_reg_loss: 7572.8126; train_edge_recon_loss: 79786.7092; train_gene_expr_recon_loss: 666509.1584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 753868.6794; train_optim_loss: 753868.6794; val_kl_reg_loss: 7432.0669; val_edge_recon_loss: 83381.2567; val_gene_expr_recon_loss: 663115.6693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 753928.9922; val_optim_loss: 753928.9922
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9503; val_auprc_score: 0.9890; val_best_acc_score: 0.9445; val_best_f1_score: 0.9680; train_kl_reg_loss: 7442.8738; train_edge_recon_loss: 79028.7221; train_gene_expr_recon_loss: 663780.3703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 750251.9651; train_optim_loss: 750251.9651; val_kl_reg_loss: 7398.5986; val_edge_recon_loss: 80156.5295; val_gene_expr_recon_loss: 661211.4870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 748766.6146; val_optim_loss: 748766.6146
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9561; val_auprc_score: 0.9904; val_best_acc_score: 0.9472; val_best_f1_score: 0.9695; train_kl_reg_loss: 7375.1563; train_edge_recon_loss: 79793.4287; train_gene_expr_recon_loss: 661518.9971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 748687.5846; train_optim_loss: 748687.5846; val_kl_reg_loss: 7270.5631; val_edge_recon_loss: 77613.8488; val_gene_expr_recon_loss: 658531.6849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 743416.0938; val_optim_loss: 743416.0938
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9587; val_auprc_score: 0.9908; val_best_acc_score: 0.9471; val_best_f1_score: 0.9694; train_kl_reg_loss: 7310.7970; train_edge_recon_loss: 79447.6600; train_gene_expr_recon_loss: 659149.7506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 745908.2070; train_optim_loss: 745908.2070; val_kl_reg_loss: 7223.2902; val_edge_recon_loss: 79589.9388; val_gene_expr_recon_loss: 656292.8932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 743106.1224; val_optim_loss: 743106.1224
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9600; val_auprc_score: 0.9901; val_best_acc_score: 0.9489; val_best_f1_score: 0.9702; train_kl_reg_loss: 7268.7016; train_edge_recon_loss: 79561.7019; train_gene_expr_recon_loss: 657041.4276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 743871.8317; train_optim_loss: 743871.8317; val_kl_reg_loss: 7190.5536; val_edge_recon_loss: 82594.0422; val_gene_expr_recon_loss: 654375.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 744160.3073; val_optim_loss: 744160.3073
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9617; val_auprc_score: 0.9912; val_best_acc_score: 0.9498; val_best_f1_score: 0.9710; train_kl_reg_loss: 7226.0293; train_edge_recon_loss: 78708.9675; train_gene_expr_recon_loss: 654835.1683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 740770.1634; train_optim_loss: 740770.1634; val_kl_reg_loss: 7261.5364; val_edge_recon_loss: 79611.8929; val_gene_expr_recon_loss: 652606.8490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 739480.2760; val_optim_loss: 739480.2760
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9619; val_auprc_score: 0.9910; val_best_acc_score: 0.9476; val_best_f1_score: 0.9695; train_kl_reg_loss: 7193.7052; train_edge_recon_loss: 79644.2947; train_gene_expr_recon_loss: 653272.7660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 740110.7672; train_optim_loss: 740110.7672; val_kl_reg_loss: 7170.3793; val_edge_recon_loss: 81854.8792; val_gene_expr_recon_loss: 651562.6693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 740587.9297; val_optim_loss: 740587.9297
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9555; val_auprc_score: 0.9898; val_best_acc_score: 0.9484; val_best_f1_score: 0.9702; train_kl_reg_loss: 7170.2957; train_edge_recon_loss: 78506.0782; train_gene_expr_recon_loss: 651556.8506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 737233.2256; train_optim_loss: 737233.2256; val_kl_reg_loss: 7165.1533; val_edge_recon_loss: 79195.8511; val_gene_expr_recon_loss: 648792.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 735153.4375; val_optim_loss: 735153.4375
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9591; val_auprc_score: 0.9914; val_best_acc_score: 0.9494; val_best_f1_score: 0.9708; train_kl_reg_loss: 7128.9597; train_edge_recon_loss: 78902.0170; train_gene_expr_recon_loss: 649916.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 735947.4131; train_optim_loss: 735947.4131; val_kl_reg_loss: 7183.9223; val_edge_recon_loss: 75473.6720; val_gene_expr_recon_loss: 647003.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 729660.6979; val_optim_loss: 729660.6979
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9590; val_auprc_score: 0.9904; val_best_acc_score: 0.9523; val_best_f1_score: 0.9725; train_kl_reg_loss: 7107.2593; train_edge_recon_loss: 79117.5398; train_gene_expr_recon_loss: 648391.8096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 734616.6076; train_optim_loss: 734616.6076; val_kl_reg_loss: 7124.8512; val_edge_recon_loss: 77166.2599; val_gene_expr_recon_loss: 646013.7318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 730304.8490; val_optim_loss: 730304.8490
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9607; val_auprc_score: 0.9915; val_best_acc_score: 0.9495; val_best_f1_score: 0.9708; train_kl_reg_loss: 7097.3834; train_edge_recon_loss: 78391.9689; train_gene_expr_recon_loss: 646974.4177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 732463.7698; train_optim_loss: 732463.7698; val_kl_reg_loss: 7104.4379; val_edge_recon_loss: 79133.9147; val_gene_expr_recon_loss: 644583.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 730821.9844; val_optim_loss: 730821.9844
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9606; val_auprc_score: 0.9918; val_best_acc_score: 0.9435; val_best_f1_score: 0.9671; train_kl_reg_loss: 7231.9860; train_edge_recon_loss: 79420.8522; train_gene_expr_recon_loss: 657145.3148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 743798.1517; train_optim_loss: 743798.1517; val_kl_reg_loss: 7511.8234; val_edge_recon_loss: 80462.4417; val_gene_expr_recon_loss: 654789.8151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 742764.0833; val_optim_loss: 742764.0833
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9578; val_auprc_score: 0.9907; val_best_acc_score: 0.9432; val_best_f1_score: 0.9671; train_kl_reg_loss: 7389.5184; train_edge_recon_loss: 79050.4310; train_gene_expr_recon_loss: 650098.5076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 736538.4570; train_optim_loss: 736538.4570; val_kl_reg_loss: 7204.6700; val_edge_recon_loss: 81643.3151; val_gene_expr_recon_loss: 645972.5365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 734820.5234; val_optim_loss: 734820.5234

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9553; val_auprc_score: 0.9898; val_best_acc_score: 0.9466; val_best_f1_score: 0.9690; train_kl_reg_loss: 7269.8700; train_edge_recon_loss: 79610.9905; train_gene_expr_recon_loss: 646302.4526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 733183.3131; train_optim_loss: 733183.3131; val_kl_reg_loss: 7227.4521; val_edge_recon_loss: 78685.9053; val_gene_expr_recon_loss: 644253.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 730167.1719; val_optim_loss: 730167.1719
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9587; val_auprc_score: 0.9907; val_best_acc_score: 0.9464; val_best_f1_score: 0.9688; train_kl_reg_loss: 7259.5382; train_edge_recon_loss: 79131.5348; train_gene_expr_recon_loss: 645844.0110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 732235.0863; train_optim_loss: 732235.0863; val_kl_reg_loss: 7217.5400; val_edge_recon_loss: 80708.4777; val_gene_expr_recon_loss: 644684.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 732610.3255; val_optim_loss: 732610.3255
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9574; val_auprc_score: 0.9900; val_best_acc_score: 0.9472; val_best_f1_score: 0.9692; train_kl_reg_loss: 7247.8167; train_edge_recon_loss: 79460.5439; train_gene_expr_recon_loss: 645604.2020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 732312.5631; train_optim_loss: 732312.5631; val_kl_reg_loss: 7205.5821; val_edge_recon_loss: 80131.7972; val_gene_expr_recon_loss: 644318.8099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 731656.1849; val_optim_loss: 731656.1849
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9529; val_auprc_score: 0.9887; val_best_acc_score: 0.9465; val_best_f1_score: 0.9691; train_kl_reg_loss: 7226.2519; train_edge_recon_loss: 79954.0164; train_gene_expr_recon_loss: 645293.1988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 732473.4672; train_optim_loss: 732473.4672; val_kl_reg_loss: 7185.5513; val_edge_recon_loss: 80540.8633; val_gene_expr_recon_loss: 643856.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 731583.1276; val_optim_loss: 731583.1276

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 108 min 4 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9521
Val AUPRC score: 0.9883
Val best accuracy score: 0.9487
Val best F1 score: 0.9703
Val gene expr MSE score: 58786.3573
Val cat covariate0 mean sim diff: -0.0037

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
