[True]
Run timestamp: 01082023_072957_32.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_32']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9028; val_auprc_score: 0.9813; val_best_acc_score: 0.8553; val_best_f1_score: 0.9220; train_kl_reg_loss: 275272.9728; train_edge_recon_loss: 11716.2581; train_gene_expr_recon_loss: 49701793.8519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118302.8646; train_global_loss: 50107085.8519; train_optim_loss: 50107085.8519; val_kl_reg_loss: 381971.2969; val_edge_recon_loss: 11765.4006; val_gene_expr_recon_loss: 42593810.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109912.7812; val_global_loss: 43097459.3333; val_optim_loss: 43097459.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8706; val_auprc_score: 0.9733; val_best_acc_score: 0.8519; val_best_f1_score: 0.9200; train_kl_reg_loss: 379103.4190; train_edge_recon_loss: 11925.6564; train_gene_expr_recon_loss: 37289786.8519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103093.9398; train_global_loss: 37783909.8889; train_optim_loss: 37783909.8889; val_kl_reg_loss: 336131.5000; val_edge_recon_loss: 12043.4453; val_gene_expr_recon_loss: 31939345.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96513.2500; val_global_loss: 32384034.0000; val_optim_loss: 32384034.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8532; val_auprc_score: 0.9687; val_best_acc_score: 0.8546; val_best_f1_score: 0.9210; train_kl_reg_loss: 322265.4184; train_edge_recon_loss: 11999.7345; train_gene_expr_recon_loss: 29532497.8519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91129.8929; train_global_loss: 29957892.9259; train_optim_loss: 29957892.9259; val_kl_reg_loss: 284446.3073; val_edge_recon_loss: 12374.7440; val_gene_expr_recon_loss: 28145216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86043.3750; val_global_loss: 28528081.3333; val_optim_loss: 28528081.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8375; val_auprc_score: 0.9663; val_best_acc_score: 0.8744; val_best_f1_score: 0.9310; train_kl_reg_loss: 272416.1377; train_edge_recon_loss: 11983.5069; train_gene_expr_recon_loss: 27755312.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82138.9932; train_global_loss: 28121851.1481; train_optim_loss: 28121851.1481; val_kl_reg_loss: 241296.7188; val_edge_recon_loss: 11842.2952; val_gene_expr_recon_loss: 27475506.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78612.6094; val_global_loss: 27807257.0000; val_optim_loss: 27807257.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8502; val_auprc_score: 0.9682; val_best_acc_score: 0.8790; val_best_f1_score: 0.9315; train_kl_reg_loss: 233888.4086; train_edge_recon_loss: 11925.8787; train_gene_expr_recon_loss: 27312784.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76212.2313; train_global_loss: 27634810.7778; train_optim_loss: 27634810.7778; val_kl_reg_loss: 210241.3229; val_edge_recon_loss: 11676.0487; val_gene_expr_recon_loss: 27146336.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74242.0469; val_global_loss: 27442495.6667; val_optim_loss: 27442495.6667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8491; val_auprc_score: 0.9679; val_best_acc_score: 0.8739; val_best_f1_score: 0.9309; train_kl_reg_loss: 206858.8545; train_edge_recon_loss: 12030.2245; train_gene_expr_recon_loss: 27024183.5926; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73349.4073; train_global_loss: 27316422.0370; train_optim_loss: 27316422.0370; val_kl_reg_loss: 188607.2786; val_edge_recon_loss: 11896.6852; val_gene_expr_recon_loss: 26875060.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72890.2969; val_global_loss: 27148454.6667; val_optim_loss: 27148454.6667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8541; val_auprc_score: 0.9671; val_best_acc_score: 0.8738; val_best_f1_score: 0.9301; train_kl_reg_loss: 186497.2616; train_edge_recon_loss: 11890.2891; train_gene_expr_recon_loss: 26773070.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72746.7442; train_global_loss: 27044204.8148; train_optim_loss: 27044204.8148; val_kl_reg_loss: 170607.9531; val_edge_recon_loss: 12124.8372; val_gene_expr_recon_loss: 26656057.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72611.0859; val_global_loss: 26911402.3333; val_optim_loss: 26911402.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8667; val_auprc_score: 0.9707; val_best_acc_score: 0.8806; val_best_f1_score: 0.9333; train_kl_reg_loss: 170679.8591; train_edge_recon_loss: 11881.7728; train_gene_expr_recon_loss: 26553965.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72481.7483; train_global_loss: 26809008.2593; train_optim_loss: 26809008.2593; val_kl_reg_loss: 157706.7995; val_edge_recon_loss: 11930.4188; val_gene_expr_recon_loss: 26455706.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72343.8281; val_global_loss: 26697687.6667; val_optim_loss: 26697687.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8714; val_auprc_score: 0.9721; val_best_acc_score: 0.8837; val_best_f1_score: 0.9347; train_kl_reg_loss: 158079.6727; train_edge_recon_loss: 11688.8053; train_gene_expr_recon_loss: 26347173.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72208.7059; train_global_loss: 26589150.6296; train_optim_loss: 26589150.6296; val_kl_reg_loss: 146987.9766; val_edge_recon_loss: 11698.1304; val_gene_expr_recon_loss: 26243350.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72065.3281; val_global_loss: 26474102.6667; val_optim_loss: 26474102.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8736; val_auprc_score: 0.9724; val_best_acc_score: 0.8831; val_best_f1_score: 0.9337; train_kl_reg_loss: 147589.3817; train_edge_recon_loss: 11902.6939; train_gene_expr_recon_loss: 26152270.5185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71922.5483; train_global_loss: 26383685.2222; train_optim_loss: 26383685.2222; val_kl_reg_loss: 137811.8568; val_edge_recon_loss: 11959.8942; val_gene_expr_recon_loss: 26063170.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71773.2109; val_global_loss: 26284716.0000; val_optim_loss: 26284716.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8760; val_auprc_score: 0.9725; val_best_acc_score: 0.8858; val_best_f1_score: 0.9347; train_kl_reg_loss: 138813.3394; train_edge_recon_loss: 11736.3423; train_gene_expr_recon_loss: 25967680.9630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71627.0394; train_global_loss: 26189857.7407; train_optim_loss: 26189857.7407; val_kl_reg_loss: 129695.8841; val_edge_recon_loss: 11829.0003; val_gene_expr_recon_loss: 25882710.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71474.6250; val_global_loss: 26095708.6667; val_optim_loss: 26095708.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8811; val_auprc_score: 0.9750; val_best_acc_score: 0.8878; val_best_f1_score: 0.9355; train_kl_reg_loss: 131043.1578; train_edge_recon_loss: 11726.7936; train_gene_expr_recon_loss: 25787144.8519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71325.2954; train_global_loss: 26001240.2963; train_optim_loss: 26001240.2963; val_kl_reg_loss: 122502.5807; val_edge_recon_loss: 11695.2715; val_gene_expr_recon_loss: 25709446.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71171.2656; val_global_loss: 25914815.6667; val_optim_loss: 25914815.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8913; val_auprc_score: 0.9765; val_best_acc_score: 0.8924; val_best_f1_score: 0.9380; train_kl_reg_loss: 124437.5985; train_edge_recon_loss: 11686.2655; train_gene_expr_recon_loss: 25606564.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71025.1723; train_global_loss: 25813713.2222; train_optim_loss: 25813713.2222; val_kl_reg_loss: 116901.4089; val_edge_recon_loss: 11475.8358; val_gene_expr_recon_loss: 25520745.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70878.1875; val_global_loss: 25720000.3333; val_optim_loss: 25720000.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8928; val_auprc_score: 0.9773; val_best_acc_score: 0.8922; val_best_f1_score: 0.9376; train_kl_reg_loss: 118541.1021; train_edge_recon_loss: 11588.0794; train_gene_expr_recon_loss: 25430465.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70737.2486; train_global_loss: 25631331.7778; train_optim_loss: 25631331.7778; val_kl_reg_loss: 111565.4206; val_edge_recon_loss: 11543.9167; val_gene_expr_recon_loss: 25346451.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70591.2266; val_global_loss: 25540152.6667; val_optim_loss: 25540152.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8966; val_auprc_score: 0.9775; val_best_acc_score: 0.8912; val_best_f1_score: 0.9383; train_kl_reg_loss: 113239.2269; train_edge_recon_loss: 11743.2013; train_gene_expr_recon_loss: 25258215.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70453.2999; train_global_loss: 25453651.3704; train_optim_loss: 25453651.3704; val_kl_reg_loss: 105951.1888; val_edge_recon_loss: 11815.3477; val_gene_expr_recon_loss: 25174780.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70312.7188; val_global_loss: 25362859.0000; val_optim_loss: 25362859.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9017; val_auprc_score: 0.9794; val_best_acc_score: 0.8965; val_best_f1_score: 0.9416; train_kl_reg_loss: 108046.7742; train_edge_recon_loss: 11589.0615; train_gene_expr_recon_loss: 25085287.9259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70178.9036; train_global_loss: 25275102.6667; train_optim_loss: 25275102.6667; val_kl_reg_loss: 97278.4544; val_edge_recon_loss: 11408.8397; val_gene_expr_recon_loss: 24768320.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70039.1562; val_global_loss: 24947048.0000; val_optim_loss: 24947048.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8508; val_auprc_score: 0.9691; val_best_acc_score: 0.8623; val_best_f1_score: 0.9251; train_kl_reg_loss: 98141.5427; train_edge_recon_loss: 11880.2306; train_gene_expr_recon_loss: 26529838.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69896.6312; train_global_loss: 26709757.1481; train_optim_loss: 26709757.1481; val_kl_reg_loss: 59681.9727; val_edge_recon_loss: 12004.3610; val_gene_expr_recon_loss: 28009030.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69773.7109; val_global_loss: 28150491.0000; val_optim_loss: 28150491.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8631; val_auprc_score: 0.9716; val_best_acc_score: 0.8765; val_best_f1_score: 0.9309; train_kl_reg_loss: 50364.8145; train_edge_recon_loss: 11829.8858; train_gene_expr_recon_loss: 24092970.1481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70079.9484; train_global_loss: 24225244.6667; train_optim_loss: 24225244.6667; val_kl_reg_loss: 52583.6797; val_edge_recon_loss: 11682.9761; val_gene_expr_recon_loss: 22438374.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70268.5781; val_global_loss: 22572909.3333; val_optim_loss: 22572909.3333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8798; val_auprc_score: 0.9760; val_best_acc_score: 0.8843; val_best_f1_score: 0.9358; train_kl_reg_loss: 59165.2012; train_edge_recon_loss: 11739.3038; train_gene_expr_recon_loss: 22164805.7407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70224.7143; train_global_loss: 22305934.8889; train_optim_loss: 22305934.8889; val_kl_reg_loss: 60644.0488; val_edge_recon_loss: 11393.4596; val_gene_expr_recon_loss: 21969149.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70149.2891; val_global_loss: 22111336.3333; val_optim_loss: 22111336.3333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8843; val_auprc_score: 0.9753; val_best_acc_score: 0.8835; val_best_f1_score: 0.9345; train_kl_reg_loss: 64982.5689; train_edge_recon_loss: 11662.9415; train_gene_expr_recon_loss: 21850408.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70052.8329; train_global_loss: 21997106.7778; train_optim_loss: 21997106.7778; val_kl_reg_loss: 64188.7956; val_edge_recon_loss: 11982.0811; val_gene_expr_recon_loss: 21735679.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69946.7578; val_global_loss: 21881796.0000; val_optim_loss: 21881796.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8895; val_auprc_score: 0.9760; val_best_acc_score: 0.8841; val_best_f1_score: 0.9347; train_kl_reg_loss: 66114.6206; train_edge_recon_loss: 11717.4824; train_gene_expr_recon_loss: 21632155.9630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69837.3103; train_global_loss: 21779825.1852; train_optim_loss: 21779825.1852; val_kl_reg_loss: 60737.6146; val_edge_recon_loss: 11886.2412; val_gene_expr_recon_loss: 21420078.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69720.2031; val_global_loss: 21562422.0000; val_optim_loss: 21562422.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8979; val_auprc_score: 0.9781; val_best_acc_score: 0.8900; val_best_f1_score: 0.9377; train_kl_reg_loss: 64865.5041; train_edge_recon_loss: 11612.0013; train_gene_expr_recon_loss: 21287986.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69622.7565; train_global_loss: 21434087.1481; train_optim_loss: 21434087.1481; val_kl_reg_loss: 63841.0566; val_edge_recon_loss: 11812.1916; val_gene_expr_recon_loss: 21153547.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69507.7812; val_global_loss: 21298708.6667; val_optim_loss: 21298708.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8973; val_auprc_score: 0.9785; val_best_acc_score: 0.8903; val_best_f1_score: 0.9379; train_kl_reg_loss: 66647.0802; train_edge_recon_loss: 11617.4012; train_gene_expr_recon_loss: 21110921.0741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69386.7899; train_global_loss: 21258572.1852; train_optim_loss: 21258572.1852; val_kl_reg_loss: 64761.2207; val_edge_recon_loss: 11734.7464; val_gene_expr_recon_loss: 21026047.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69259.4531; val_global_loss: 21171803.3333; val_optim_loss: 21171803.3333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8976; val_auprc_score: 0.9781; val_best_acc_score: 0.8940; val_best_f1_score: 0.9399; train_kl_reg_loss: 66991.4071; train_edge_recon_loss: 11593.7521; train_gene_expr_recon_loss: 20971350.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69133.1361; train_global_loss: 21119068.8889; train_optim_loss: 21119068.8889; val_kl_reg_loss: 64608.9408; val_edge_recon_loss: 11552.1660; val_gene_expr_recon_loss: 20914957.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69002.7344; val_global_loss: 21060120.6667; val_optim_loss: 21060120.6667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9052; val_auprc_score: 0.9801; val_best_acc_score: 0.8998; val_best_f1_score: 0.9429; train_kl_reg_loss: 66744.9524; train_edge_recon_loss: 11663.9908; train_gene_expr_recon_loss: 20848070.2593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68873.2637; train_global_loss: 20995352.3704; train_optim_loss: 20995352.3704; val_kl_reg_loss: 63565.4147; val_edge_recon_loss: 11514.6763; val_gene_expr_recon_loss: 20774547.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68739.1719; val_global_loss: 20918367.3333; val_optim_loss: 20918367.3333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8888; val_auprc_score: 0.9780; val_best_acc_score: 0.8888; val_best_f1_score: 0.9379; train_kl_reg_loss: 41970.9244; train_edge_recon_loss: 11568.5517; train_gene_expr_recon_loss: 37374993.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69148.3490; train_global_loss: 37497681.3704; train_optim_loss: 37497681.3704; val_kl_reg_loss: 42609.8659; val_edge_recon_loss: 11468.0565; val_gene_expr_recon_loss: 32678996.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69156.6094; val_global_loss: 32802230.0000; val_optim_loss: 32802230.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8999; val_auprc_score: 0.9779; val_best_acc_score: 0.8877; val_best_f1_score: 0.9356; train_kl_reg_loss: 55112.7619; train_edge_recon_loss: 11793.8852; train_gene_expr_recon_loss: 29546754.0370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68934.8608; train_global_loss: 29682595.5926; train_optim_loss: 29682595.5926; val_kl_reg_loss: 56534.1491; val_edge_recon_loss: 11968.3221; val_gene_expr_recon_loss: 26815650.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68699.2578; val_global_loss: 26952853.6667; val_optim_loss: 26952853.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8969; val_auprc_score: 0.9790; val_best_acc_score: 0.8894; val_best_f1_score: 0.9376; train_kl_reg_loss: 57406.5739; train_edge_recon_loss: 11511.0146; train_gene_expr_recon_loss: 25134867.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68468.2377; train_global_loss: 25272253.4815; train_optim_loss: 25272253.4815; val_kl_reg_loss: 54352.0671; val_edge_recon_loss: 11629.6976; val_gene_expr_recon_loss: 23680727.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68226.7344; val_global_loss: 23814935.0000; val_optim_loss: 23814935.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8994; val_auprc_score: 0.9786; val_best_acc_score: 0.8910; val_best_f1_score: 0.9379; train_kl_reg_loss: 55319.1498; train_edge_recon_loss: 11628.8050; train_gene_expr_recon_loss: 22766272.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67990.7718; train_global_loss: 22901211.2963; train_optim_loss: 22901211.2963; val_kl_reg_loss: 51573.7461; val_edge_recon_loss: 11654.7897; val_gene_expr_recon_loss: 21980137.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67743.9062; val_global_loss: 22111109.6667; val_optim_loss: 22111109.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9055; val_auprc_score: 0.9801; val_best_acc_score: 0.8935; val_best_f1_score: 0.9393; train_kl_reg_loss: 53888.6481; train_edge_recon_loss: 11487.9300; train_gene_expr_recon_loss: 21920984.8519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67687.8986; train_global_loss: 22054049.2222; train_optim_loss: 22054049.2222; val_kl_reg_loss: 51300.4408; val_edge_recon_loss: 11623.8273; val_gene_expr_recon_loss: 21837396.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67655.7891; val_global_loss: 21967976.3333; val_optim_loss: 21967976.3333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9026; val_auprc_score: 0.9796; val_best_acc_score: 0.8949; val_best_f1_score: 0.9401; train_kl_reg_loss: 53597.5707; train_edge_recon_loss: 11561.1674; train_gene_expr_recon_loss: 21809210.6296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67630.4942; train_global_loss: 21941999.9259; train_optim_loss: 21941999.9259; val_kl_reg_loss: 51052.3366; val_edge_recon_loss: 11353.6123; val_gene_expr_recon_loss: 21755637.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67604.1484; val_global_loss: 21885647.6667; val_optim_loss: 21885647.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8977; val_auprc_score: 0.9787; val_best_acc_score: 0.8927; val_best_f1_score: 0.9389; train_kl_reg_loss: 53295.3857; train_edge_recon_loss: 11636.6966; train_gene_expr_recon_loss: 21705281.1481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67578.3058; train_global_loss: 21837791.5556; train_optim_loss: 21837791.5556; val_kl_reg_loss: 50831.5690; val_edge_recon_loss: 11382.3099; val_gene_expr_recon_loss: 21649668.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67551.2656; val_global_loss: 21779434.3333; val_optim_loss: 21779434.3333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9028; val_auprc_score: 0.9787; val_best_acc_score: 0.8914; val_best_f1_score: 0.9379; train_kl_reg_loss: 53006.4980; train_edge_recon_loss: 11463.3464; train_gene_expr_recon_loss: 21609767.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67524.4952; train_global_loss: 21741761.4074; train_optim_loss: 21741761.4074; val_kl_reg_loss: 50462.2454; val_edge_recon_loss: 11723.9333; val_gene_expr_recon_loss: 21525344.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67496.3672; val_global_loss: 21655026.6667; val_optim_loss: 21655026.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 0 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9094
val AUPRC score: 0.9808
val best accuracy score: 0.9006
val best F1 score: 0.9431
val target rna MSE score: 23.1901
val source rna MSE score: 141.6450
Val cat covariate0 mean sim diff: -0.0001

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
