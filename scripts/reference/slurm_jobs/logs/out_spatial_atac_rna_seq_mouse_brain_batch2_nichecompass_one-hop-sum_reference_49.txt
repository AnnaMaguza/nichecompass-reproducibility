[True]
Run timestamp: 10082023_205855_49.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_49']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7789; val_auprc_score: 0.8017; val_best_acc_score: 0.5181; val_best_f1_score: 0.6710; train_kl_reg_loss: 279330.9327; train_edge_recon_loss: 3984246.3779; train_gene_expr_recon_loss: 30405878.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 131956181.2519; train_global_loss: 166625637.4962; train_optim_loss: 166625637.4962; val_kl_reg_loss: 176875.8687; val_edge_recon_loss: 4063350.8167; val_gene_expr_recon_loss: 24665642.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 118233197.3333; val_global_loss: 147139065.6000; val_optim_loss: 147139065.6000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7820; val_auprc_score: 0.8039; val_best_acc_score: 0.6874; val_best_f1_score: 0.7249; train_kl_reg_loss: 166128.7263; train_edge_recon_loss: 3902627.5992; train_gene_expr_recon_loss: 24161145.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 116594932.8244; train_global_loss: 144824834.9313; train_optim_loss: 144824834.9313; val_kl_reg_loss: 173621.6604; val_edge_recon_loss: 4050788.2500; val_gene_expr_recon_loss: 23073523.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 117022342.9333; val_global_loss: 144320275.2000; val_optim_loss: 144320275.2000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8184; val_auprc_score: 0.8261; val_best_acc_score: 0.7330; val_best_f1_score: 0.7530; train_kl_reg_loss: 208929.8038; train_edge_recon_loss: 3624495.5305; train_gene_expr_recon_loss: 22654176.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 115344322.1985; train_global_loss: 141831923.5420; train_optim_loss: 141831923.5420; val_kl_reg_loss: 173426.5583; val_edge_recon_loss: 3949546.0333; val_gene_expr_recon_loss: 22166435.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 114608160.0000; val_global_loss: 140897569.0667; val_optim_loss: 140897569.0667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8576; val_auprc_score: 0.8573; val_best_acc_score: 0.7722; val_best_f1_score: 0.7888; train_kl_reg_loss: 179268.9498; train_edge_recon_loss: 3504155.5401; train_gene_expr_recon_loss: 22189153.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 114189234.9313; train_global_loss: 140061813.3740; train_optim_loss: 140061813.3740; val_kl_reg_loss: 163974.5427; val_edge_recon_loss: 3547939.8500; val_gene_expr_recon_loss: 21893978.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 113537261.8667; val_global_loss: 139143154.1333; val_optim_loss: 139143154.1333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8794; val_auprc_score: 0.8709; val_best_acc_score: 0.7881; val_best_f1_score: 0.8121; train_kl_reg_loss: 173530.4003; train_edge_recon_loss: 3241792.4141; train_gene_expr_recon_loss: 21983200.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 113141275.4198; train_global_loss: 138539798.0458; train_optim_loss: 138539798.0458; val_kl_reg_loss: 192282.3885; val_edge_recon_loss: 3106340.3333; val_gene_expr_recon_loss: 21827002.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 113299981.8667; val_global_loss: 138425609.0667; val_optim_loss: 138425609.0667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8997; val_auprc_score: 0.8884; val_best_acc_score: 0.8145; val_best_f1_score: 0.8325; train_kl_reg_loss: 202799.9153; train_edge_recon_loss: 3042157.8931; train_gene_expr_recon_loss: 21832417.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 112588439.8779; train_global_loss: 137665815.5115; train_optim_loss: 137665815.5115; val_kl_reg_loss: 211506.0969; val_edge_recon_loss: 3007123.0000; val_gene_expr_recon_loss: 21868666.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 114157276.2667; val_global_loss: 139244574.4000; val_optim_loss: 139244574.4000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9013; val_auprc_score: 0.8850; val_best_acc_score: 0.8244; val_best_f1_score: 0.8390; train_kl_reg_loss: 208432.4478; train_edge_recon_loss: 2977993.4637; train_gene_expr_recon_loss: 21703803.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 112044223.5725; train_global_loss: 136934452.8244; train_optim_loss: 136934452.8244; val_kl_reg_loss: 200785.9448; val_edge_recon_loss: 2972074.6333; val_gene_expr_recon_loss: 21566076.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 112359603.7333; val_global_loss: 137098541.3333; val_optim_loss: 137098541.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9057; val_auprc_score: 0.8906; val_best_acc_score: 0.8281; val_best_f1_score: 0.8419; train_kl_reg_loss: 201401.4306; train_edge_recon_loss: 2942062.0439; train_gene_expr_recon_loss: 21596393.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111448240.6718; train_global_loss: 136188097.2214; train_optim_loss: 136188097.2214; val_kl_reg_loss: 198269.3427; val_edge_recon_loss: 2984533.4000; val_gene_expr_recon_loss: 21498957.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111954364.8000; val_global_loss: 136636125.8667; val_optim_loss: 136636125.8667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9166; val_auprc_score: 0.9035; val_best_acc_score: 0.8438; val_best_f1_score: 0.8540; train_kl_reg_loss: 196078.1834; train_edge_recon_loss: 2923741.5821; train_gene_expr_recon_loss: 21506288.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111053624.2443; train_global_loss: 135679733.2519; train_optim_loss: 135679733.2519; val_kl_reg_loss: 191162.1448; val_edge_recon_loss: 2927436.4333; val_gene_expr_recon_loss: 21512946.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111867077.3333; val_global_loss: 136498620.8000; val_optim_loss: 136498620.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9174; val_auprc_score: 0.9026; val_best_acc_score: 0.8436; val_best_f1_score: 0.8549; train_kl_reg_loss: 189633.6744; train_edge_recon_loss: 2908928.4122; train_gene_expr_recon_loss: 21401429.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110415576.8550; train_global_loss: 134915568.7328; train_optim_loss: 134915568.7328; val_kl_reg_loss: 185632.9406; val_edge_recon_loss: 2921794.9833; val_gene_expr_recon_loss: 21355340.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111216186.1333; val_global_loss: 135678955.2000; val_optim_loss: 135678955.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9235; val_auprc_score: 0.9098; val_best_acc_score: 0.8544; val_best_f1_score: 0.8636; train_kl_reg_loss: 183436.8739; train_edge_recon_loss: 2893490.1069; train_gene_expr_recon_loss: 21318905.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110054444.4580; train_global_loss: 134450276.1527; train_optim_loss: 134450276.1527; val_kl_reg_loss: 179724.9552; val_edge_recon_loss: 2896241.3000; val_gene_expr_recon_loss: 21294484.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110817775.4667; val_global_loss: 135188226.6667; val_optim_loss: 135188226.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9282; val_auprc_score: 0.9136; val_best_acc_score: 0.8570; val_best_f1_score: 0.8664; train_kl_reg_loss: 177264.7675; train_edge_recon_loss: 2877747.1870; train_gene_expr_recon_loss: 21266831.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109719289.4656; train_global_loss: 134041133.3740; train_optim_loss: 134041133.3740; val_kl_reg_loss: 176026.2229; val_edge_recon_loss: 2888130.9667; val_gene_expr_recon_loss: 21078655.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109636395.2000; val_global_loss: 133779207.4667; val_optim_loss: 133779207.4667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9312; val_auprc_score: 0.9180; val_best_acc_score: 0.8649; val_best_f1_score: 0.8734; train_kl_reg_loss: 173385.2380; train_edge_recon_loss: 2869527.6870; train_gene_expr_recon_loss: 21192213.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109306549.2519; train_global_loss: 133541675.9084; train_optim_loss: 133541675.9084; val_kl_reg_loss: 167233.3396; val_edge_recon_loss: 2859280.2000; val_gene_expr_recon_loss: 21193996.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110391301.8667; val_global_loss: 134611813.8667; val_optim_loss: 134611813.8667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9323; val_auprc_score: 0.9182; val_best_acc_score: 0.8681; val_best_f1_score: 0.8778; train_kl_reg_loss: 167340.8028; train_edge_recon_loss: 2851964.7996; train_gene_expr_recon_loss: 21121091.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108911992.0611; train_global_loss: 133052388.9466; train_optim_loss: 133052388.9466; val_kl_reg_loss: 161602.2292; val_edge_recon_loss: 2871354.7667; val_gene_expr_recon_loss: 21009013.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109364276.2667; val_global_loss: 133406246.9333; val_optim_loss: 133406246.9333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9364; val_auprc_score: 0.9251; val_best_acc_score: 0.8707; val_best_f1_score: 0.8800; train_kl_reg_loss: 163388.1116; train_edge_recon_loss: 2842827.9809; train_gene_expr_recon_loss: 21070519.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108608941.6183; train_global_loss: 132685677.7405; train_optim_loss: 132685677.7405; val_kl_reg_loss: 161505.3937; val_edge_recon_loss: 2846480.3833; val_gene_expr_recon_loss: 21041111.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109974701.3333; val_global_loss: 134023798.4000; val_optim_loss: 134023798.4000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9362; val_auprc_score: 0.9226; val_best_acc_score: 0.8689; val_best_f1_score: 0.8781; train_kl_reg_loss: 159846.5963; train_edge_recon_loss: 2831214.9561; train_gene_expr_recon_loss: 21043731.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108526888.0000; train_global_loss: 132561681.0992; train_optim_loss: 132561681.0992; val_kl_reg_loss: 156941.8031; val_edge_recon_loss: 2848007.6500; val_gene_expr_recon_loss: 21024086.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109318684.2667; val_global_loss: 133347720.5333; val_optim_loss: 133347720.5333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9399; val_auprc_score: 0.9286; val_best_acc_score: 0.8777; val_best_f1_score: 0.8842; train_kl_reg_loss: 155195.5211; train_edge_recon_loss: 2831151.5630; train_gene_expr_recon_loss: 21002990.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108235848.9160; train_global_loss: 132225186.3817; train_optim_loss: 132225186.3817; val_kl_reg_loss: 152476.9958; val_edge_recon_loss: 2840445.4667; val_gene_expr_recon_loss: 20958302.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108816356.8000; val_global_loss: 132767581.3333; val_optim_loss: 132767581.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9386; val_auprc_score: 0.9269; val_best_acc_score: 0.8693; val_best_f1_score: 0.8779; train_kl_reg_loss: 152136.3726; train_edge_recon_loss: 2819976.3492; train_gene_expr_recon_loss: 20969155.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108000727.2061; train_global_loss: 131941995.6031; train_optim_loss: 131941995.6031; val_kl_reg_loss: 151032.0854; val_edge_recon_loss: 2851617.9167; val_gene_expr_recon_loss: 20890486.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108515111.4667; val_global_loss: 132408250.1333; val_optim_loss: 132408250.1333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9430; val_auprc_score: 0.9297; val_best_acc_score: 0.8820; val_best_f1_score: 0.8877; train_kl_reg_loss: 148421.9757; train_edge_recon_loss: 2808899.7920; train_gene_expr_recon_loss: 20908241.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107577274.1374; train_global_loss: 131442838.0458; train_optim_loss: 131442838.0458; val_kl_reg_loss: 144759.8687; val_edge_recon_loss: 2829539.0167; val_gene_expr_recon_loss: 20930964.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109396145.6000; val_global_loss: 133301410.6667; val_optim_loss: 133301410.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9443; val_auprc_score: 0.9315; val_best_acc_score: 0.8806; val_best_f1_score: 0.8884; train_kl_reg_loss: 146220.3773; train_edge_recon_loss: 2810975.6393; train_gene_expr_recon_loss: 20894456.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107548554.1374; train_global_loss: 131400206.5954; train_optim_loss: 131400206.5954; val_kl_reg_loss: 144612.0208; val_edge_recon_loss: 2823635.5500; val_gene_expr_recon_loss: 20897876.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108913051.7333; val_global_loss: 132779177.0667; val_optim_loss: 132779177.0667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9461; val_auprc_score: 0.9325; val_best_acc_score: 0.8843; val_best_f1_score: 0.8914; train_kl_reg_loss: 143439.0392; train_edge_recon_loss: 2801921.9351; train_gene_expr_recon_loss: 20860955.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107373562.3206; train_global_loss: 131179877.9847; train_optim_loss: 131179877.9847; val_kl_reg_loss: 141733.0146; val_edge_recon_loss: 2808918.5333; val_gene_expr_recon_loss: 20872650.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108252277.3333; val_global_loss: 132075579.2000; val_optim_loss: 132075579.2000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9491; val_auprc_score: 0.9411; val_best_acc_score: 0.8817; val_best_f1_score: 0.8883; train_kl_reg_loss: 140706.8250; train_edge_recon_loss: 2796650.5668; train_gene_expr_recon_loss: 20802994.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 106989679.6947; train_global_loss: 130730032.1221; train_optim_loss: 130730032.1221; val_kl_reg_loss: 140170.9333; val_edge_recon_loss: 2814453.5333; val_gene_expr_recon_loss: 20756394.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107400154.1333; val_global_loss: 131111174.4000; val_optim_loss: 131111174.4000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9570; val_auprc_score: 0.9483; val_best_acc_score: 0.8981; val_best_f1_score: 0.9015; train_kl_reg_loss: 138187.6099; train_edge_recon_loss: 2789563.8492; train_gene_expr_recon_loss: 20810703.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107003803.1145; train_global_loss: 130742257.8321; train_optim_loss: 130742257.8321; val_kl_reg_loss: 135973.2115; val_edge_recon_loss: 2774629.7833; val_gene_expr_recon_loss: 20779400.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108054257.0667; val_global_loss: 131744258.6667; val_optim_loss: 131744258.6667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9522; val_auprc_score: 0.9411; val_best_acc_score: 0.8890; val_best_f1_score: 0.8938; train_kl_reg_loss: 139080.0741; train_edge_recon_loss: 2779701.2195; train_gene_expr_recon_loss: 20759306.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 106651082.3817; train_global_loss: 130329170.5038; train_optim_loss: 130329170.5038; val_kl_reg_loss: 138776.0906; val_edge_recon_loss: 2793701.7833; val_gene_expr_recon_loss: 20726748.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107322718.4000; val_global_loss: 130981945.6000; val_optim_loss: 130981945.6000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9577; val_auprc_score: 0.9500; val_best_acc_score: 0.8967; val_best_f1_score: 0.9024; train_kl_reg_loss: 136728.2660; train_edge_recon_loss: 2780484.2748; train_gene_expr_recon_loss: 20755515.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 106751196.5191; train_global_loss: 130423924.5191; train_optim_loss: 130423924.5191; val_kl_reg_loss: 134720.3813; val_edge_recon_loss: 2775661.8167; val_gene_expr_recon_loss: 20704254.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107587190.4000; val_global_loss: 131201827.7333; val_optim_loss: 131201827.7333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9229; val_auprc_score: 0.9072; val_best_acc_score: 0.8526; val_best_f1_score: 0.8633; train_kl_reg_loss: 151386.8307; train_edge_recon_loss: 3177121.8206; train_gene_expr_recon_loss: 24338716.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111470244.7023; train_global_loss: 139137469.8626; train_optim_loss: 139137469.8626; val_kl_reg_loss: 16324.7452; val_edge_recon_loss: 3005366.1333; val_gene_expr_recon_loss: 24212125.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 112797125.3333; val_global_loss: 140030943.4667; val_optim_loss: 140030943.4667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9207; val_auprc_score: 0.9010; val_best_acc_score: 0.8554; val_best_f1_score: 0.8658; train_kl_reg_loss: 101406.6970; train_edge_recon_loss: 2880215.5840; train_gene_expr_recon_loss: 24193365.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111549760.9771; train_global_loss: 138724748.7023; train_optim_loss: 138724748.7023; val_kl_reg_loss: 17819.5906; val_edge_recon_loss: 2803072.0000; val_gene_expr_recon_loss: 23930735.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111856857.0667; val_global_loss: 138608484.2667; val_optim_loss: 138608484.2667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9284; val_auprc_score: 0.9095; val_best_acc_score: 0.8645; val_best_f1_score: 0.8747; train_kl_reg_loss: 73755.7315; train_edge_recon_loss: 2793848.9561; train_gene_expr_recon_loss: 23843445.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111070663.2061; train_global_loss: 137781713.4656; train_optim_loss: 137781713.4656; val_kl_reg_loss: 21584.3143; val_edge_recon_loss: 2772620.8667; val_gene_expr_recon_loss: 23660432.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111557858.6667; val_global_loss: 138012496.0000; val_optim_loss: 138012496.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9239; val_auprc_score: 0.9047; val_best_acc_score: 0.8561; val_best_f1_score: 0.8680; train_kl_reg_loss: 61964.5909; train_edge_recon_loss: 2761848.9237; train_gene_expr_recon_loss: 23667566.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110737820.5802; train_global_loss: 137229200.1832; train_optim_loss: 137229200.1832; val_kl_reg_loss: 22344.4129; val_edge_recon_loss: 2788410.2333; val_gene_expr_recon_loss: 23635938.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111769896.5333; val_global_loss: 138216589.3333; val_optim_loss: 138216589.3333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9278; val_auprc_score: 0.9062; val_best_acc_score: 0.8655; val_best_f1_score: 0.8758; train_kl_reg_loss: 61434.9916; train_edge_recon_loss: 2756584.3454; train_gene_expr_recon_loss: 23637200.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110749370.4427; train_global_loss: 137204590.5344; train_optim_loss: 137204590.5344; val_kl_reg_loss: 22854.3133; val_edge_recon_loss: 2760835.6833; val_gene_expr_recon_loss: 23510146.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111260318.4000; val_global_loss: 137554154.1333; val_optim_loss: 137554154.1333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9266; val_auprc_score: 0.9069; val_best_acc_score: 0.8682; val_best_f1_score: 0.8768; train_kl_reg_loss: 59988.2266; train_edge_recon_loss: 2760817.2844; train_gene_expr_recon_loss: 23654032.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110992315.9084; train_global_loss: 137467154.5649; train_optim_loss: 137467154.5649; val_kl_reg_loss: 23278.3897; val_edge_recon_loss: 2764524.2000; val_gene_expr_recon_loss: 23522576.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111379486.9333; val_global_loss: 137689866.1333; val_optim_loss: 137689866.1333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9267; val_auprc_score: 0.9074; val_best_acc_score: 0.8666; val_best_f1_score: 0.8754; train_kl_reg_loss: 58742.7406; train_edge_recon_loss: 2758560.7214; train_gene_expr_recon_loss: 23579012.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110635227.7252; train_global_loss: 137031543.0229; train_optim_loss: 137031543.0229; val_kl_reg_loss: 23673.5905; val_edge_recon_loss: 2756607.7833; val_gene_expr_recon_loss: 23488741.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111250214.4000; val_global_loss: 137519237.8667; val_optim_loss: 137519237.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 52 min 31 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9559
val AUPRC score: 0.9460
val best accuracy score: 0.8911
val best F1 score: 0.8962
val target rna MSE score: 1.6852
val source rna MSE score: 55.8941
val target atac MSE score: 0.1300
val source atac MSE score: 1.0419
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
