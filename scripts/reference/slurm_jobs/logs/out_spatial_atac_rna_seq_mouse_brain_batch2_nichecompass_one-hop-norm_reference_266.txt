[True]
Run timestamp: 07092023_045934_266.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_266']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 26065 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 30568, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 26065
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 26065

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6516; val_auprc_score: 0.6391; val_best_acc_score: 0.5110; val_best_f1_score: 0.6689; train_kl_reg_loss: 70831.7615; train_edge_recon_loss: 3641058.3295; train_gene_expr_recon_loss: 17069064.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1512906.2595; train_chrom_access_recon_loss: 59042608.4242; train_global_loss: 81336468.4848; train_optim_loss: 81336468.4848; val_kl_reg_loss: 100850.7158; val_edge_recon_loss: 4064330.7812; val_gene_expr_recon_loss: 15045522.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1209922.7500; val_chrom_access_recon_loss: 56293219.5000; val_global_loss: 76713844.0000; val_optim_loss: 76713844.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6975; val_auprc_score: 0.6785; val_best_acc_score: 0.5427; val_best_f1_score: 0.6770; train_kl_reg_loss: 122791.5654; train_edge_recon_loss: 3620641.3182; train_gene_expr_recon_loss: 14912851.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 915076.1383; train_chrom_access_recon_loss: 55915958.6667; train_global_loss: 75487319.3939; train_optim_loss: 75487319.3939; val_kl_reg_loss: 149047.1465; val_edge_recon_loss: 4062231.5312; val_gene_expr_recon_loss: 14661752.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 654913.2500; val_chrom_access_recon_loss: 55490444.5000; val_global_loss: 75018389.0000; val_optim_loss: 75018389.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7513; val_auprc_score: 0.7240; val_best_acc_score: 0.6728; val_best_f1_score: 0.7179; train_kl_reg_loss: 134252.7789; train_edge_recon_loss: 3556363.4659; train_gene_expr_recon_loss: 14663388.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 496397.0402; train_chrom_access_recon_loss: 55323177.6970; train_global_loss: 74173579.6364; train_optim_loss: 74173579.6364; val_kl_reg_loss: 128000.8271; val_edge_recon_loss: 4053268.5312; val_gene_expr_recon_loss: 14583199.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 371274.1875; val_chrom_access_recon_loss: 55159594.5000; val_global_loss: 74295338.0000; val_optim_loss: 74295338.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8141; val_auprc_score: 0.7948; val_best_acc_score: 0.7007; val_best_f1_score: 0.7509; train_kl_reg_loss: 122170.3453; train_edge_recon_loss: 3531084.7500; train_gene_expr_recon_loss: 14521712.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 300438.3878; train_chrom_access_recon_loss: 54910492.3636; train_global_loss: 73385898.6667; train_optim_loss: 73385898.6667; val_kl_reg_loss: 119031.0879; val_edge_recon_loss: 3992533.9062; val_gene_expr_recon_loss: 14332272.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 243742.3281; val_chrom_access_recon_loss: 54735039.0000; val_global_loss: 73422617.0000; val_optim_loss: 73422617.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8300; val_auprc_score: 0.7840; val_best_acc_score: 0.7595; val_best_f1_score: 0.7861; train_kl_reg_loss: 103468.2891; train_edge_recon_loss: 3467966.3636; train_gene_expr_recon_loss: 14410019.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 209407.1780; train_chrom_access_recon_loss: 54573649.3939; train_global_loss: 72764510.1818; train_optim_loss: 72764510.1818; val_kl_reg_loss: 85266.9717; val_edge_recon_loss: 3404556.4375; val_gene_expr_recon_loss: 14394591.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 180855.6094; val_chrom_access_recon_loss: 54732844.0000; val_global_loss: 72798116.0000; val_optim_loss: 72798116.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8318; val_auprc_score: 0.7831; val_best_acc_score: 0.7671; val_best_f1_score: 0.7964; train_kl_reg_loss: 115744.6519; train_edge_recon_loss: 3092574.0417; train_gene_expr_recon_loss: 14327246.7424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160844.6998; train_chrom_access_recon_loss: 54374659.2121; train_global_loss: 72071069.3333; train_optim_loss: 72071069.3333; val_kl_reg_loss: 134533.1455; val_edge_recon_loss: 3029941.5625; val_gene_expr_recon_loss: 14306718.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143435.8438; val_chrom_access_recon_loss: 54378478.0000; val_global_loss: 71993107.0000; val_optim_loss: 71993107.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8280; val_auprc_score: 0.7814; val_best_acc_score: 0.7668; val_best_f1_score: 0.7988; train_kl_reg_loss: 137644.0962; train_edge_recon_loss: 2984232.7197; train_gene_expr_recon_loss: 14238551.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130667.4991; train_chrom_access_recon_loss: 54096844.0000; train_global_loss: 71587939.2727; train_optim_loss: 71587939.2727; val_kl_reg_loss: 131086.3623; val_edge_recon_loss: 3029147.7812; val_gene_expr_recon_loss: 14258738.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119033.0312; val_chrom_access_recon_loss: 53868783.5000; val_global_loss: 71406791.0000; val_optim_loss: 71406791.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8482; val_auprc_score: 0.8047; val_best_acc_score: 0.7942; val_best_f1_score: 0.8212; train_kl_reg_loss: 132520.3861; train_edge_recon_loss: 2966073.6326; train_gene_expr_recon_loss: 14174242.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110388.8213; train_chrom_access_recon_loss: 53876562.3030; train_global_loss: 71259788.0606; train_optim_loss: 71259788.0606; val_kl_reg_loss: 123886.3154; val_edge_recon_loss: 2926897.1250; val_gene_expr_recon_loss: 14169590.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102838.9141; val_chrom_access_recon_loss: 54088938.5000; val_global_loss: 71412150.0000; val_optim_loss: 71412150.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8353; val_auprc_score: 0.7878; val_best_acc_score: 0.7840; val_best_f1_score: 0.8128; train_kl_reg_loss: 128983.2050; train_edge_recon_loss: 2921222.2727; train_gene_expr_recon_loss: 14102725.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96501.8545; train_chrom_access_recon_loss: 53628199.3333; train_global_loss: 70877632.4848; train_optim_loss: 70877632.4848; val_kl_reg_loss: 129276.9775; val_edge_recon_loss: 2939208.3750; val_gene_expr_recon_loss: 14138681.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90731.3438; val_chrom_access_recon_loss: 53984132.0000; val_global_loss: 71282031.0000; val_optim_loss: 71282031.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8494; val_auprc_score: 0.8045; val_best_acc_score: 0.7915; val_best_f1_score: 0.8217; train_kl_reg_loss: 129631.1812; train_edge_recon_loss: 2888442.2348; train_gene_expr_recon_loss: 14058834.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85995.1790; train_chrom_access_recon_loss: 53475318.4848; train_global_loss: 70638221.2121; train_optim_loss: 70638221.2121; val_kl_reg_loss: 124749.7715; val_edge_recon_loss: 2938485.7188; val_gene_expr_recon_loss: 14102072.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82057.0703; val_chrom_access_recon_loss: 54050305.0000; val_global_loss: 71297671.0000; val_optim_loss: 71297671.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8559; val_auprc_score: 0.8099; val_best_acc_score: 0.7985; val_best_f1_score: 0.8276; train_kl_reg_loss: 127790.0584; train_edge_recon_loss: 2870863.5417; train_gene_expr_recon_loss: 14003740.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78149.0299; train_chrom_access_recon_loss: 53227142.3636; train_global_loss: 70307685.9394; train_optim_loss: 70307685.9394; val_kl_reg_loss: 127851.3877; val_edge_recon_loss: 2888096.1562; val_gene_expr_recon_loss: 14018272.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74895.8516; val_chrom_access_recon_loss: 53994845.5000; val_global_loss: 71103962.0000; val_optim_loss: 71103962.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8697; val_auprc_score: 0.8311; val_best_acc_score: 0.8084; val_best_f1_score: 0.8342; train_kl_reg_loss: 125536.3381; train_edge_recon_loss: 2842561.6136; train_gene_expr_recon_loss: 13948825.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72043.1739; train_chrom_access_recon_loss: 53076375.7576; train_global_loss: 70065343.2727; train_optim_loss: 70065343.2727; val_kl_reg_loss: 123489.7295; val_edge_recon_loss: 2863500.6250; val_gene_expr_recon_loss: 13736148.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69425.5078; val_chrom_access_recon_loss: 53094529.0000; val_global_loss: 69887094.0000; val_optim_loss: 69887094.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8696; val_auprc_score: 0.8225; val_best_acc_score: 0.8079; val_best_f1_score: 0.8325; train_kl_reg_loss: 122164.3290; train_edge_recon_loss: 2852082.1439; train_gene_expr_recon_loss: 13903449.5606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67144.3384; train_chrom_access_recon_loss: 52844923.2727; train_global_loss: 69789763.2121; train_optim_loss: 69789763.2121; val_kl_reg_loss: 123323.8535; val_edge_recon_loss: 2858641.7188; val_gene_expr_recon_loss: 13837362.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65239.1602; val_chrom_access_recon_loss: 53153833.0000; val_global_loss: 70038401.0000; val_optim_loss: 70038401.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8737; val_auprc_score: 0.8409; val_best_acc_score: 0.8074; val_best_f1_score: 0.8326; train_kl_reg_loss: 120139.1232; train_edge_recon_loss: 2834299.9015; train_gene_expr_recon_loss: 13853610.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63332.4270; train_chrom_access_recon_loss: 52678782.2424; train_global_loss: 69550164.3030; train_optim_loss: 69550164.3030; val_kl_reg_loss: 119780.5146; val_edge_recon_loss: 2861057.4062; val_gene_expr_recon_loss: 13903032.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61689.7344; val_chrom_access_recon_loss: 53651627.5000; val_global_loss: 70597189.0000; val_optim_loss: 70597189.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8899; val_auprc_score: 0.8662; val_best_acc_score: 0.8090; val_best_f1_score: 0.8333; train_kl_reg_loss: 117578.1042; train_edge_recon_loss: 2826538.3750; train_gene_expr_recon_loss: 13813862.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60208.5287; train_chrom_access_recon_loss: 52487664.0606; train_global_loss: 69305851.2727; train_optim_loss: 69305851.2727; val_kl_reg_loss: 116663.4443; val_edge_recon_loss: 2864080.1875; val_gene_expr_recon_loss: 13891583.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58917.9062; val_chrom_access_recon_loss: 52684765.5000; val_global_loss: 69616011.0000; val_optim_loss: 69616011.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8867; val_auprc_score: 0.8580; val_best_acc_score: 0.8060; val_best_f1_score: 0.8306; train_kl_reg_loss: 114809.4203; train_edge_recon_loss: 2812733.2008; train_gene_expr_recon_loss: 13766090.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57691.4561; train_chrom_access_recon_loss: 52338169.2727; train_global_loss: 69089494.1818; train_optim_loss: 69089494.1818; val_kl_reg_loss: 110421.6152; val_edge_recon_loss: 2870328.2188; val_gene_expr_recon_loss: 13634304.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56625.9023; val_chrom_access_recon_loss: 52196339.5000; val_global_loss: 68868020.0000; val_optim_loss: 68868020.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9055; val_auprc_score: 0.8718; val_best_acc_score: 0.8350; val_best_f1_score: 0.8470; train_kl_reg_loss: 112671.0888; train_edge_recon_loss: 2809116.8712; train_gene_expr_recon_loss: 13744479.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55749.5249; train_chrom_access_recon_loss: 52178885.5758; train_global_loss: 68900902.8485; train_optim_loss: 68900902.8485; val_kl_reg_loss: 112724.2715; val_edge_recon_loss: 2810839.7500; val_gene_expr_recon_loss: 13640196.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54938.6953; val_chrom_access_recon_loss: 52058885.5000; val_global_loss: 68677585.0000; val_optim_loss: 68677585.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9061; val_auprc_score: 0.8727; val_best_acc_score: 0.8447; val_best_f1_score: 0.8578; train_kl_reg_loss: 112044.4028; train_edge_recon_loss: 2791463.6818; train_gene_expr_recon_loss: 13710055.9545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54104.9169; train_chrom_access_recon_loss: 52018007.2727; train_global_loss: 68685675.6970; train_optim_loss: 68685675.6970; val_kl_reg_loss: 111953.2578; val_edge_recon_loss: 2825438.0938; val_gene_expr_recon_loss: 13681933.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53517.3203; val_chrom_access_recon_loss: 52248734.5000; val_global_loss: 68921576.5000; val_optim_loss: 68921576.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9084; val_auprc_score: 0.8799; val_best_acc_score: 0.8469; val_best_f1_score: 0.8611; train_kl_reg_loss: 110985.7578; train_edge_recon_loss: 2781978.2045; train_gene_expr_recon_loss: 13672656.7576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52812.4786; train_chrom_access_recon_loss: 51846080.4848; train_global_loss: 68464513.8182; train_optim_loss: 68464513.8182; val_kl_reg_loss: 108677.8340; val_edge_recon_loss: 2812034.2500; val_gene_expr_recon_loss: 13671069.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52429.9805; val_chrom_access_recon_loss: 52383733.0000; val_global_loss: 69027944.0000; val_optim_loss: 69027944.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9162; val_auprc_score: 0.8867; val_best_acc_score: 0.8579; val_best_f1_score: 0.8691; train_kl_reg_loss: 110037.5819; train_edge_recon_loss: 2776691.0530; train_gene_expr_recon_loss: 13636979.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51762.4478; train_chrom_access_recon_loss: 51648351.1515; train_global_loss: 68223822.1212; train_optim_loss: 68223822.1212; val_kl_reg_loss: 109909.3018; val_edge_recon_loss: 2810347.3750; val_gene_expr_recon_loss: 13621731.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51490.9492; val_chrom_access_recon_loss: 51481033.5000; val_global_loss: 68074513.5000; val_optim_loss: 68074513.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9129; val_auprc_score: 0.8799; val_best_acc_score: 0.8520; val_best_f1_score: 0.8660; train_kl_reg_loss: 108706.6091; train_edge_recon_loss: 2764591.3106; train_gene_expr_recon_loss: 13596346.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50869.5190; train_chrom_access_recon_loss: 51472888.3636; train_global_loss: 67993402.1212; train_optim_loss: 67993402.1212; val_kl_reg_loss: 109635.6543; val_edge_recon_loss: 2817492.3125; val_gene_expr_recon_loss: 13585206.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50616.0273; val_chrom_access_recon_loss: 51950202.0000; val_global_loss: 68513152.5000; val_optim_loss: 68513152.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9186; val_auprc_score: 0.8843; val_best_acc_score: 0.8614; val_best_f1_score: 0.8740; train_kl_reg_loss: 107537.8359; train_edge_recon_loss: 2763393.2273; train_gene_expr_recon_loss: 13593323.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50090.2702; train_chrom_access_recon_loss: 51383460.5455; train_global_loss: 67897805.0909; train_optim_loss: 67897805.0909; val_kl_reg_loss: 109034.3291; val_edge_recon_loss: 2787496.1562; val_gene_expr_recon_loss: 13636185.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49724.9609; val_chrom_access_recon_loss: 51902624.0000; val_global_loss: 68485065.0000; val_optim_loss: 68485065.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9230; val_auprc_score: 0.8924; val_best_acc_score: 0.8606; val_best_f1_score: 0.8717; train_kl_reg_loss: 106190.8810; train_edge_recon_loss: 2761207.7121; train_gene_expr_recon_loss: 13544406.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49326.3523; train_chrom_access_recon_loss: 51183604.4242; train_global_loss: 67644735.8182; train_optim_loss: 67644735.8182; val_kl_reg_loss: 103253.6875; val_edge_recon_loss: 2787856.0000; val_gene_expr_recon_loss: 13608325.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49299.0859; val_chrom_access_recon_loss: 52061310.0000; val_global_loss: 68610043.0000; val_optim_loss: 68610043.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9290; val_auprc_score: 0.9064; val_best_acc_score: 0.8619; val_best_f1_score: 0.8743; train_kl_reg_loss: 105885.5837; train_edge_recon_loss: 2742755.0379; train_gene_expr_recon_loss: 13516625.1970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48861.9962; train_chrom_access_recon_loss: 51031931.5758; train_global_loss: 67446059.2727; train_optim_loss: 67446059.2727; val_kl_reg_loss: 105776.6055; val_edge_recon_loss: 2785893.8750; val_gene_expr_recon_loss: 13488360.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48705.9766; val_chrom_access_recon_loss: 51367259.0000; val_global_loss: 67795997.0000; val_optim_loss: 67795997.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9281; val_auprc_score: 0.8989; val_best_acc_score: 0.8675; val_best_f1_score: 0.8786; train_kl_reg_loss: 104263.5204; train_edge_recon_loss: 2744003.5189; train_gene_expr_recon_loss: 13498203.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48537.0962; train_chrom_access_recon_loss: 50927213.0909; train_global_loss: 67322220.3030; train_optim_loss: 67322220.3030; val_kl_reg_loss: 101008.2441; val_edge_recon_loss: 2797385.5625; val_gene_expr_recon_loss: 13507823.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48527.8164; val_chrom_access_recon_loss: 51599327.5000; val_global_loss: 68054072.0000; val_optim_loss: 68054072.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9326; val_auprc_score: 0.9095; val_best_acc_score: 0.8753; val_best_f1_score: 0.8857; train_kl_reg_loss: 102419.3839; train_edge_recon_loss: 2753716.0076; train_gene_expr_recon_loss: 13477201.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43544.2932; train_chrom_access_recon_loss: 51305387.3939; train_global_loss: 67682269.1515; train_optim_loss: 67682269.1515; val_kl_reg_loss: 94421.8135; val_edge_recon_loss: 2754825.5938; val_gene_expr_recon_loss: 13398351.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41565.4492; val_chrom_access_recon_loss: 51298481.0000; val_global_loss: 67587645.5000; val_optim_loss: 67587645.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9245; val_auprc_score: 0.9016; val_best_acc_score: 0.8654; val_best_f1_score: 0.8762; train_kl_reg_loss: 103150.6869; train_edge_recon_loss: 2743250.1970; train_gene_expr_recon_loss: 13445980.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40830.9536; train_chrom_access_recon_loss: 50982043.4545; train_global_loss: 67315255.2727; train_optim_loss: 67315255.2727; val_kl_reg_loss: 93837.8623; val_edge_recon_loss: 2800758.5312; val_gene_expr_recon_loss: 13554394.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40417.6211; val_chrom_access_recon_loss: 51204054.5000; val_global_loss: 67693461.5000; val_optim_loss: 67693461.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9340; val_auprc_score: 0.9080; val_best_acc_score: 0.8721; val_best_f1_score: 0.8819; train_kl_reg_loss: 100800.7360; train_edge_recon_loss: 2737666.1591; train_gene_expr_recon_loss: 13423438.1212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40104.0748; train_chrom_access_recon_loss: 50896182.0000; train_global_loss: 67198191.2727; train_optim_loss: 67198191.2727; val_kl_reg_loss: 92165.0693; val_edge_recon_loss: 2767153.9688; val_gene_expr_recon_loss: 13262749.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39745.2930; val_chrom_access_recon_loss: 50882882.5000; val_global_loss: 67044695.0000; val_optim_loss: 67044695.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9382; val_auprc_score: 0.9142; val_best_acc_score: 0.8799; val_best_f1_score: 0.8894; train_kl_reg_loss: 99279.2406; train_edge_recon_loss: 2733831.8258; train_gene_expr_recon_loss: 13418440.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39418.4699; train_chrom_access_recon_loss: 50819970.2424; train_global_loss: 67110939.6970; train_optim_loss: 67110939.6970; val_kl_reg_loss: 93736.3672; val_edge_recon_loss: 2741779.2188; val_gene_expr_recon_loss: 13248391.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39300.5977; val_chrom_access_recon_loss: 50737331.0000; val_global_loss: 66860540.0000; val_optim_loss: 66860540.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9389; val_auprc_score: 0.9140; val_best_acc_score: 0.8804; val_best_f1_score: 0.8900; train_kl_reg_loss: 97096.0695; train_edge_recon_loss: 2740205.2008; train_gene_expr_recon_loss: 13378249.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39104.7991; train_chrom_access_recon_loss: 50638934.9091; train_global_loss: 66893590.4242; train_optim_loss: 66893590.4242; val_kl_reg_loss: 89562.5537; val_edge_recon_loss: 2761334.2500; val_gene_expr_recon_loss: 13346568.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38923.3711; val_chrom_access_recon_loss: 50833170.0000; val_global_loss: 67069559.5000; val_optim_loss: 67069559.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9432; val_auprc_score: 0.9222; val_best_acc_score: 0.8872; val_best_f1_score: 0.8935; train_kl_reg_loss: 96557.6384; train_edge_recon_loss: 2726772.5833; train_gene_expr_recon_loss: 13364788.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38758.7416; train_chrom_access_recon_loss: 50528804.6667; train_global_loss: 66755681.6970; train_optim_loss: 66755681.6970; val_kl_reg_loss: 88119.2344; val_edge_recon_loss: 2743731.4062; val_gene_expr_recon_loss: 13275564.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38592.9180; val_chrom_access_recon_loss: 50730314.5000; val_global_loss: 66876322.5000; val_optim_loss: 66876322.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9380; val_auprc_score: 0.9190; val_best_acc_score: 0.8764; val_best_f1_score: 0.8838; train_kl_reg_loss: 94228.7217; train_edge_recon_loss: 2729845.5947; train_gene_expr_recon_loss: 13351890.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38412.5433; train_chrom_access_recon_loss: 50447360.6061; train_global_loss: 66661738.6061; train_optim_loss: 66661738.6061; val_kl_reg_loss: 88518.1641; val_edge_recon_loss: 2787092.9688; val_gene_expr_recon_loss: 13367698.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38516.7852; val_chrom_access_recon_loss: 51334954.5000; val_global_loss: 67616781.5000; val_optim_loss: 67616781.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9453; val_auprc_score: 0.9219; val_best_acc_score: 0.8920; val_best_f1_score: 0.8977; train_kl_reg_loss: 94739.4031; train_edge_recon_loss: 2719976.0568; train_gene_expr_recon_loss: 13331310.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38283.8026; train_chrom_access_recon_loss: 50341283.3939; train_global_loss: 66525592.7273; train_optim_loss: 66525592.7273; val_kl_reg_loss: 88319.6455; val_edge_recon_loss: 2744377.8125; val_gene_expr_recon_loss: 13342189.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38287.5586; val_chrom_access_recon_loss: 50232573.0000; val_global_loss: 66445748.0000; val_optim_loss: 66445748.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9426; val_auprc_score: 0.9203; val_best_acc_score: 0.8880; val_best_f1_score: 0.8955; train_kl_reg_loss: 93831.9351; train_edge_recon_loss: 2715511.8750; train_gene_expr_recon_loss: 13313425.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38090.7219; train_chrom_access_recon_loss: 50236830.1212; train_global_loss: 66397690.4242; train_optim_loss: 66397690.4242; val_kl_reg_loss: 89972.4805; val_edge_recon_loss: 2754366.0625; val_gene_expr_recon_loss: 13334695.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38022.7461; val_chrom_access_recon_loss: 51085948.5000; val_global_loss: 67303006.0000; val_optim_loss: 67303006.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9456; val_auprc_score: 0.9245; val_best_acc_score: 0.8939; val_best_f1_score: 0.9009; train_kl_reg_loss: 93421.1746; train_edge_recon_loss: 2712993.7311; train_gene_expr_recon_loss: 13305837.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37255.5560; train_chrom_access_recon_loss: 50248877.8788; train_global_loss: 66398386.0606; train_optim_loss: 66398386.0606; val_kl_reg_loss: 90954.4590; val_edge_recon_loss: 2748276.8750; val_gene_expr_recon_loss: 13311338.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36515.9688; val_chrom_access_recon_loss: 50918775.5000; val_global_loss: 67105861.5000; val_optim_loss: 67105861.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9503; val_auprc_score: 0.9286; val_best_acc_score: 0.8998; val_best_f1_score: 0.9047; train_kl_reg_loss: 92537.5394; train_edge_recon_loss: 2710883.4167; train_gene_expr_recon_loss: 13276537.5303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36428.1064; train_chrom_access_recon_loss: 50048010.1212; train_global_loss: 66164396.5455; train_optim_loss: 66164396.5455; val_kl_reg_loss: 87492.1836; val_edge_recon_loss: 2742724.8438; val_gene_expr_recon_loss: 13192534.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36361.0078; val_chrom_access_recon_loss: 49903028.5000; val_global_loss: 65962140.5000; val_optim_loss: 65962140.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9483; val_auprc_score: 0.9271; val_best_acc_score: 0.8933; val_best_f1_score: 0.9009; train_kl_reg_loss: 90918.1503; train_edge_recon_loss: 2716074.9394; train_gene_expr_recon_loss: 13265961.0606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36326.9229; train_chrom_access_recon_loss: 49967495.4545; train_global_loss: 66076776.3636; train_optim_loss: 66076776.3636; val_kl_reg_loss: 86768.2148; val_edge_recon_loss: 2737530.5625; val_gene_expr_recon_loss: 13405891.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36330.2500; val_chrom_access_recon_loss: 51055822.0000; val_global_loss: 67322342.5000; val_optim_loss: 67322342.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9548; val_auprc_score: 0.9353; val_best_acc_score: 0.9068; val_best_f1_score: 0.9120; train_kl_reg_loss: 91491.8243; train_edge_recon_loss: 2696262.0000; train_gene_expr_recon_loss: 13254664.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36276.9835; train_chrom_access_recon_loss: 49908078.5455; train_global_loss: 65986774.4242; train_optim_loss: 65986774.4242; val_kl_reg_loss: 87563.9092; val_edge_recon_loss: 2725041.5000; val_gene_expr_recon_loss: 13276928.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36299.6914; val_chrom_access_recon_loss: 50091045.5000; val_global_loss: 66216879.0000; val_optim_loss: 66216879.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9463; val_auprc_score: 0.9233; val_best_acc_score: 0.8966; val_best_f1_score: 0.9016; train_kl_reg_loss: 89868.9650; train_edge_recon_loss: 2706846.5189; train_gene_expr_recon_loss: 13247824.1212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36261.4718; train_chrom_access_recon_loss: 49849571.6970; train_global_loss: 65930372.4848; train_optim_loss: 65930372.4848; val_kl_reg_loss: 85757.8682; val_edge_recon_loss: 2742453.6875; val_gene_expr_recon_loss: 13250810.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36168.3398; val_chrom_access_recon_loss: 50143260.5000; val_global_loss: 66258451.0000; val_optim_loss: 66258451.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9530; val_auprc_score: 0.9370; val_best_acc_score: 0.9017; val_best_f1_score: 0.9084; train_kl_reg_loss: 89333.1252; train_edge_recon_loss: 2701908.4583; train_gene_expr_recon_loss: 13230919.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36158.4476; train_chrom_access_recon_loss: 49754193.9394; train_global_loss: 65812513.5758; train_optim_loss: 65812513.5758; val_kl_reg_loss: 86635.4922; val_edge_recon_loss: 2726650.1250; val_gene_expr_recon_loss: 13144329.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36134.1328; val_chrom_access_recon_loss: 50216116.5000; val_global_loss: 66209864.5000; val_optim_loss: 66209864.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9532; val_auprc_score: 0.9367; val_best_acc_score: 0.9014; val_best_f1_score: 0.9082; train_kl_reg_loss: 89065.8733; train_edge_recon_loss: 2710506.8674; train_gene_expr_recon_loss: 13217469.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33240.5517; train_chrom_access_recon_loss: 49701808.1818; train_global_loss: 65752091.3939; train_optim_loss: 65752091.3939; val_kl_reg_loss: 88436.5820; val_edge_recon_loss: 2736550.5000; val_gene_expr_recon_loss: 13142153.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32662.2168; val_chrom_access_recon_loss: 49894420.0000; val_global_loss: 65894223.5000; val_optim_loss: 65894223.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9521; val_auprc_score: 0.9340; val_best_acc_score: 0.8982; val_best_f1_score: 0.9047; train_kl_reg_loss: 90225.8239; train_edge_recon_loss: 2695816.9242; train_gene_expr_recon_loss: 13206164.6515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32583.2267; train_chrom_access_recon_loss: 49613892.1212; train_global_loss: 65638682.6667; train_optim_loss: 65638682.6667; val_kl_reg_loss: 88074.4053; val_edge_recon_loss: 2740784.5625; val_gene_expr_recon_loss: 13294537.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32535.1191; val_chrom_access_recon_loss: 50494995.5000; val_global_loss: 66650927.0000; val_optim_loss: 66650927.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9518; val_auprc_score: 0.9304; val_best_acc_score: 0.9054; val_best_f1_score: 0.9113; train_kl_reg_loss: 90500.2882; train_edge_recon_loss: 2697155.6288; train_gene_expr_recon_loss: 13207595.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32490.1650; train_chrom_access_recon_loss: 49642504.9091; train_global_loss: 65670246.1818; train_optim_loss: 65670246.1818; val_kl_reg_loss: 88463.0801; val_edge_recon_loss: 2742173.9688; val_gene_expr_recon_loss: 13243809.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32443.4258; val_chrom_access_recon_loss: 50061963.5000; val_global_loss: 66168853.0000; val_optim_loss: 66168853.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9534; val_auprc_score: 0.9375; val_best_acc_score: 0.9014; val_best_f1_score: 0.9079; train_kl_reg_loss: 90380.2534; train_edge_recon_loss: 2703324.4848; train_gene_expr_recon_loss: 13201735.3182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32418.9486; train_chrom_access_recon_loss: 49667009.8788; train_global_loss: 65694869.0909; train_optim_loss: 65694869.0909; val_kl_reg_loss: 88151.9961; val_edge_recon_loss: 2742406.3438; val_gene_expr_recon_loss: 13182929.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32386.6953; val_chrom_access_recon_loss: 50294175.5000; val_global_loss: 66340049.5000; val_optim_loss: 66340049.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9528; val_auprc_score: 0.9364; val_best_acc_score: 0.9017; val_best_f1_score: 0.9081; train_kl_reg_loss: 90270.1887; train_edge_recon_loss: 2707112.1364; train_gene_expr_recon_loss: 13206617.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32356.1010; train_chrom_access_recon_loss: 49634030.3030; train_global_loss: 65670385.6970; train_optim_loss: 65670385.6970; val_kl_reg_loss: 88471.1006; val_edge_recon_loss: 2737840.8750; val_gene_expr_recon_loss: 13067448.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32332.5801; val_chrom_access_recon_loss: 50132936.5000; val_global_loss: 66059029.5000; val_optim_loss: 66059029.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9554; val_auprc_score: 0.9353; val_best_acc_score: 0.9049; val_best_f1_score: 0.9104; train_kl_reg_loss: 90186.9660; train_edge_recon_loss: 2706871.0682; train_gene_expr_recon_loss: 13196337.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32020.2998; train_chrom_access_recon_loss: 49614348.3636; train_global_loss: 65639764.0606; train_optim_loss: 65639764.0606; val_kl_reg_loss: 88594.3633; val_edge_recon_loss: 2730096.2188; val_gene_expr_recon_loss: 13104742.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31958.7578; val_chrom_access_recon_loss: 50037034.5000; val_global_loss: 65992427.0000; val_optim_loss: 65992427.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9560; val_auprc_score: 0.9420; val_best_acc_score: 0.8998; val_best_f1_score: 0.9053; train_kl_reg_loss: 90166.5485; train_edge_recon_loss: 2698895.2727; train_gene_expr_recon_loss: 13204310.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31953.0823; train_chrom_access_recon_loss: 49635030.9091; train_global_loss: 65660356.5455; train_optim_loss: 65660356.5455; val_kl_reg_loss: 88130.1475; val_edge_recon_loss: 2754922.7500; val_gene_expr_recon_loss: 13264975.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31946.7402; val_chrom_access_recon_loss: 50159827.5000; val_global_loss: 66299803.0000; val_optim_loss: 66299803.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9568; val_auprc_score: 0.9417; val_best_acc_score: 0.9035; val_best_f1_score: 0.9078; train_kl_reg_loss: 90279.9029; train_edge_recon_loss: 2690832.7765; train_gene_expr_recon_loss: 13201855.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31942.2885; train_chrom_access_recon_loss: 49578288.6667; train_global_loss: 65593199.8788; train_optim_loss: 65593199.8788; val_kl_reg_loss: 88062.7100; val_edge_recon_loss: 2718247.2812; val_gene_expr_recon_loss: 13171916.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31937.1699; val_chrom_access_recon_loss: 50068086.5000; val_global_loss: 66078250.0000; val_optim_loss: 66078250.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9540; val_auprc_score: 0.9386; val_best_acc_score: 0.9038; val_best_f1_score: 0.9088; train_kl_reg_loss: 90151.9341; train_edge_recon_loss: 2697665.2386; train_gene_expr_recon_loss: 13189665.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31934.2557; train_chrom_access_recon_loss: 49557942.2424; train_global_loss: 65567359.5758; train_optim_loss: 65567359.5758; val_kl_reg_loss: 88971.5391; val_edge_recon_loss: 2742784.4062; val_gene_expr_recon_loss: 13131834.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31930.9121; val_chrom_access_recon_loss: 50181623.0000; val_global_loss: 66177144.0000; val_optim_loss: 66177144.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 68 min 52 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9489
val AUPRC score: 0.9286
val best accuracy score: 0.8995
val best F1 score: 0.9052
val target rna MSE score: 0.9585
val source rna MSE score: 0.3504
val target atac MSE score: 0.1258
val source atac MSE score: 0.0277
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
