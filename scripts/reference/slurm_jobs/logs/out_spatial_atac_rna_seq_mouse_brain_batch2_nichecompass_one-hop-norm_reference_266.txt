[True]
Run timestamp: 10102023_123316_266.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_266']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7861; val_auprc_score: 0.8104; val_best_acc_score: 0.5123; val_best_f1_score: 0.6714; train_kl_reg_loss: 63414.0623; train_edge_recon_loss: 743998.0391; train_gene_expr_recon_loss: 22034983.0076; train_masked_gp_l1_reg_loss: 132138.4459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3220813.7376; train_chrom_access_recon_loss: 4742339.6489; train_global_loss: 30937686.8855; train_optim_loss: 30937686.8855; val_kl_reg_loss: 76218.9516; val_edge_recon_loss: 812839.0208; val_gene_expr_recon_loss: 21289355.4667; val_masked_gp_l1_reg_loss: 107024.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 728463.5625; val_chrom_access_recon_loss: 4640998.0000; val_global_loss: 27654899.2000; val_optim_loss: 27654899.2000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8702; val_auprc_score: 0.8748; val_best_acc_score: 0.7897; val_best_f1_score: 0.8032; train_kl_reg_loss: 75471.3657; train_edge_recon_loss: 734403.9146; train_gene_expr_recon_loss: 20887992.2443; train_masked_gp_l1_reg_loss: 104464.7922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 374959.1942; train_chrom_access_recon_loss: 4584139.9637; train_global_loss: 26761431.4656; train_optim_loss: 26761431.4656; val_kl_reg_loss: 66867.6383; val_edge_recon_loss: 801425.9833; val_gene_expr_recon_loss: 20856582.1333; val_masked_gp_l1_reg_loss: 104703.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 213457.9062; val_chrom_access_recon_loss: 4573516.7000; val_global_loss: 26616554.6667; val_optim_loss: 26616554.6667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9041; val_auprc_score: 0.8972; val_best_acc_score: 0.8181; val_best_f1_score: 0.8315; train_kl_reg_loss: 67416.0831; train_edge_recon_loss: 713284.3946; train_gene_expr_recon_loss: 20625080.0611; train_masked_gp_l1_reg_loss: 106403.9343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170078.6162; train_chrom_access_recon_loss: 4528499.5687; train_global_loss: 26210762.8092; train_optim_loss: 26210762.8092; val_kl_reg_loss: 64217.8034; val_edge_recon_loss: 706903.0625; val_gene_expr_recon_loss: 20587079.6000; val_masked_gp_l1_reg_loss: 109179.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150849.0156; val_chrom_access_recon_loss: 4519409.4667; val_global_loss: 26137639.8667; val_optim_loss: 26137639.8667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9112; val_auprc_score: 0.9009; val_best_acc_score: 0.8293; val_best_f1_score: 0.8372; train_kl_reg_loss: 74135.6911; train_edge_recon_loss: 648321.8507; train_gene_expr_recon_loss: 20327075.8473; train_masked_gp_l1_reg_loss: 110278.7945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138357.7032; train_chrom_access_recon_loss: 4478909.2214; train_global_loss: 25777079.0992; train_optim_loss: 25777079.0992; val_kl_reg_loss: 78258.4203; val_edge_recon_loss: 636235.2208; val_gene_expr_recon_loss: 20356507.7333; val_masked_gp_l1_reg_loss: 111654.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127923.9922; val_chrom_access_recon_loss: 4466730.1833; val_global_loss: 25777310.0000; val_optim_loss: 25777310.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9214; val_auprc_score: 0.9044; val_best_acc_score: 0.8452; val_best_f1_score: 0.8557; train_kl_reg_loss: 76313.3520; train_edge_recon_loss: 624851.9098; train_gene_expr_recon_loss: 20140794.2443; train_masked_gp_l1_reg_loss: 112582.8281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117178.8986; train_chrom_access_recon_loss: 4441124.6031; train_global_loss: 25512845.9695; train_optim_loss: 25512845.9695; val_kl_reg_loss: 75131.1641; val_edge_recon_loss: 618410.5458; val_gene_expr_recon_loss: 20234065.3333; val_masked_gp_l1_reg_loss: 113823.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109958.2031; val_chrom_access_recon_loss: 4460838.0333; val_global_loss: 25612227.2000; val_optim_loss: 25612227.2000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9290; val_auprc_score: 0.9117; val_best_acc_score: 0.8566; val_best_f1_score: 0.8643; train_kl_reg_loss: 74798.9280; train_edge_recon_loss: 615300.1803; train_gene_expr_recon_loss: 20003312.7328; train_masked_gp_l1_reg_loss: 114805.9412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104336.1044; train_chrom_access_recon_loss: 4410534.7557; train_global_loss: 25323088.6565; train_optim_loss: 25323088.6565; val_kl_reg_loss: 73874.1526; val_edge_recon_loss: 607003.1917; val_gene_expr_recon_loss: 20033021.6000; val_masked_gp_l1_reg_loss: 115272.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99875.3359; val_chrom_access_recon_loss: 4414108.5833; val_global_loss: 25343155.2000; val_optim_loss: 25343155.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9353; val_auprc_score: 0.9219; val_best_acc_score: 0.8642; val_best_f1_score: 0.8722; train_kl_reg_loss: 73800.6748; train_edge_recon_loss: 610262.0038; train_gene_expr_recon_loss: 19843193.7710; train_masked_gp_l1_reg_loss: 116406.8027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96148.1056; train_chrom_access_recon_loss: 4377258.7557; train_global_loss: 25117070.1679; train_optim_loss: 25117070.1679; val_kl_reg_loss: 72920.1255; val_edge_recon_loss: 607035.8042; val_gene_expr_recon_loss: 19895452.5333; val_masked_gp_l1_reg_loss: 117171.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93240.8750; val_chrom_access_recon_loss: 4379562.0333; val_global_loss: 25165382.1333; val_optim_loss: 25165382.1333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9360; val_auprc_score: 0.9237; val_best_acc_score: 0.8657; val_best_f1_score: 0.8718; train_kl_reg_loss: 72729.5737; train_edge_recon_loss: 606098.2877; train_gene_expr_recon_loss: 19751562.7023; train_masked_gp_l1_reg_loss: 117664.9181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92264.1946; train_chrom_access_recon_loss: 4350836.8740; train_global_loss: 24991156.6870; train_optim_loss: 24991156.6870; val_kl_reg_loss: 71122.4609; val_edge_recon_loss: 607839.7917; val_gene_expr_recon_loss: 19874990.5333; val_masked_gp_l1_reg_loss: 118049.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91073.5156; val_chrom_access_recon_loss: 4374647.9500; val_global_loss: 25137724.5333; val_optim_loss: 25137724.5333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9441; val_auprc_score: 0.9322; val_best_acc_score: 0.8778; val_best_f1_score: 0.8840; train_kl_reg_loss: 71553.4368; train_edge_recon_loss: 603708.5429; train_gene_expr_recon_loss: 19610194.6260; train_masked_gp_l1_reg_loss: 118492.7784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91110.0905; train_chrom_access_recon_loss: 4320773.0458; train_global_loss: 24815832.7328; train_optim_loss: 24815832.7328; val_kl_reg_loss: 68058.2229; val_edge_recon_loss: 605377.6333; val_gene_expr_recon_loss: 19705101.4667; val_masked_gp_l1_reg_loss: 119088.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90884.8125; val_chrom_access_recon_loss: 4324581.0833; val_global_loss: 24913090.6667; val_optim_loss: 24913090.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9476; val_auprc_score: 0.9339; val_best_acc_score: 0.8835; val_best_f1_score: 0.8885; train_kl_reg_loss: 70816.2604; train_edge_recon_loss: 600425.4513; train_gene_expr_recon_loss: 19511830.5649; train_masked_gp_l1_reg_loss: 119379.8638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90173.2535; train_chrom_access_recon_loss: 4298706.4256; train_global_loss: 24691331.7863; train_optim_loss: 24691331.7863; val_kl_reg_loss: 68597.3958; val_edge_recon_loss: 600797.8917; val_gene_expr_recon_loss: 19556551.3333; val_masked_gp_l1_reg_loss: 119888.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89786.4844; val_chrom_access_recon_loss: 4287409.1667; val_global_loss: 24723029.6000; val_optim_loss: 24723029.6000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9505; val_auprc_score: 0.9359; val_best_acc_score: 0.8933; val_best_f1_score: 0.8974; train_kl_reg_loss: 70167.8897; train_edge_recon_loss: 595433.5057; train_gene_expr_recon_loss: 19422198.7023; train_masked_gp_l1_reg_loss: 120310.9738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88697.1279; train_chrom_access_recon_loss: 4275214.7653; train_global_loss: 24572022.8244; train_optim_loss: 24572022.8244; val_kl_reg_loss: 69069.3703; val_edge_recon_loss: 595940.0625; val_gene_expr_recon_loss: 19454651.8667; val_masked_gp_l1_reg_loss: 120919.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87588.3672; val_chrom_access_recon_loss: 4260503.4000; val_global_loss: 24588672.5333; val_optim_loss: 24588672.5333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9545; val_auprc_score: 0.9455; val_best_acc_score: 0.8895; val_best_f1_score: 0.8933; train_kl_reg_loss: 69158.2140; train_edge_recon_loss: 596811.1551; train_gene_expr_recon_loss: 19331614.5649; train_masked_gp_l1_reg_loss: 121309.8846; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87264.4668; train_chrom_access_recon_loss: 4249944.2462; train_global_loss: 24456102.5191; train_optim_loss: 24456102.5191; val_kl_reg_loss: 68077.4323; val_edge_recon_loss: 596130.3708; val_gene_expr_recon_loss: 19438938.0000; val_masked_gp_l1_reg_loss: 121768.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86791.6250; val_chrom_access_recon_loss: 4276087.6833; val_global_loss: 24587793.6000; val_optim_loss: 24587793.6000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9577; val_auprc_score: 0.9478; val_best_acc_score: 0.8977; val_best_f1_score: 0.9037; train_kl_reg_loss: 69071.3251; train_edge_recon_loss: 591884.1011; train_gene_expr_recon_loss: 19259338.2901; train_masked_gp_l1_reg_loss: 122091.6575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85627.4819; train_chrom_access_recon_loss: 4225340.2786; train_global_loss: 24353353.2061; train_optim_loss: 24353353.2061; val_kl_reg_loss: 68355.1740; val_edge_recon_loss: 592812.7167; val_gene_expr_recon_loss: 19384246.8000; val_masked_gp_l1_reg_loss: 123092.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85907.5938; val_chrom_access_recon_loss: 4259954.1500; val_global_loss: 24514368.6667; val_optim_loss: 24514368.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9614; val_auprc_score: 0.9529; val_best_acc_score: 0.9034; val_best_f1_score: 0.9072; train_kl_reg_loss: 68251.0121; train_edge_recon_loss: 591704.0501; train_gene_expr_recon_loss: 19167785.4962; train_masked_gp_l1_reg_loss: 123252.4964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84711.4227; train_chrom_access_recon_loss: 4200413.9046; train_global_loss: 24236118.4122; train_optim_loss: 24236118.4122; val_kl_reg_loss: 65818.9284; val_edge_recon_loss: 594849.4125; val_gene_expr_recon_loss: 19323586.5333; val_masked_gp_l1_reg_loss: 123950.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84578.2500; val_chrom_access_recon_loss: 4220551.7333; val_global_loss: 24413334.8000; val_optim_loss: 24413334.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9592; val_auprc_score: 0.9457; val_best_acc_score: 0.9035; val_best_f1_score: 0.9068; train_kl_reg_loss: 67763.4836; train_edge_recon_loss: 591831.1579; train_gene_expr_recon_loss: 19129592.3664; train_masked_gp_l1_reg_loss: 124257.7486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84156.2700; train_chrom_access_recon_loss: 4178092.3702; train_global_loss: 24175693.2824; train_optim_loss: 24175693.2824; val_kl_reg_loss: 66705.4047; val_edge_recon_loss: 589048.7000; val_gene_expr_recon_loss: 19221283.8667; val_masked_gp_l1_reg_loss: 124743.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83965.5625; val_chrom_access_recon_loss: 4196489.3000; val_global_loss: 24282237.4667; val_optim_loss: 24282237.4667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9594; val_auprc_score: 0.9487; val_best_acc_score: 0.9047; val_best_f1_score: 0.9087; train_kl_reg_loss: 67413.1754; train_edge_recon_loss: 590338.5334; train_gene_expr_recon_loss: 19061272.2748; train_masked_gp_l1_reg_loss: 125607.2854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83732.6797; train_chrom_access_recon_loss: 4152457.3969; train_global_loss: 24080821.2214; train_optim_loss: 24080821.2214; val_kl_reg_loss: 66377.1255; val_edge_recon_loss: 594430.0875; val_gene_expr_recon_loss: 19296130.8000; val_masked_gp_l1_reg_loss: 126420.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84261.4609; val_chrom_access_recon_loss: 4189666.8000; val_global_loss: 24357287.3333; val_optim_loss: 24357287.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9627; val_auprc_score: 0.9547; val_best_acc_score: 0.9042; val_best_f1_score: 0.9078; train_kl_reg_loss: 67124.5077; train_edge_recon_loss: 589231.9738; train_gene_expr_recon_loss: 18978783.2061; train_masked_gp_l1_reg_loss: 127001.1783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83646.3474; train_chrom_access_recon_loss: 4122002.8454; train_global_loss: 23967790.0153; train_optim_loss: 23967790.0153; val_kl_reg_loss: 67215.1448; val_edge_recon_loss: 591770.9792; val_gene_expr_recon_loss: 19122385.8667; val_masked_gp_l1_reg_loss: 128136.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84349.8828; val_chrom_access_recon_loss: 4141311.6500; val_global_loss: 24135169.8667; val_optim_loss: 24135169.8667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9562; val_auprc_score: 0.9424; val_best_acc_score: 0.9002; val_best_f1_score: 0.9048; train_kl_reg_loss: 66524.3118; train_edge_recon_loss: 589904.3049; train_gene_expr_recon_loss: 18900142.4122; train_masked_gp_l1_reg_loss: 128792.9385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83710.2102; train_chrom_access_recon_loss: 4089913.4179; train_global_loss: 23858987.5420; train_optim_loss: 23858987.5420; val_kl_reg_loss: 66702.5953; val_edge_recon_loss: 592590.8125; val_gene_expr_recon_loss: 19088551.2000; val_masked_gp_l1_reg_loss: 129871.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83783.8047; val_chrom_access_recon_loss: 4131612.7000; val_global_loss: 24093113.6000; val_optim_loss: 24093113.6000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9571; val_auprc_score: 0.9459; val_best_acc_score: 0.9002; val_best_f1_score: 0.9050; train_kl_reg_loss: 66663.0474; train_edge_recon_loss: 588049.8335; train_gene_expr_recon_loss: 18843908.3664; train_masked_gp_l1_reg_loss: 130436.4979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83782.8456; train_chrom_access_recon_loss: 4058619.1088; train_global_loss: 23771459.6489; train_optim_loss: 23771459.6489; val_kl_reg_loss: 66569.1724; val_edge_recon_loss: 593594.3625; val_gene_expr_recon_loss: 19063481.2000; val_masked_gp_l1_reg_loss: 131265.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84637.4375; val_chrom_access_recon_loss: 4113834.7667; val_global_loss: 24053383.3333; val_optim_loss: 24053383.3333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9608; val_auprc_score: 0.9507; val_best_acc_score: 0.9061; val_best_f1_score: 0.9098; train_kl_reg_loss: 66486.0480; train_edge_recon_loss: 588424.2996; train_gene_expr_recon_loss: 18770933.7710; train_masked_gp_l1_reg_loss: 131903.8956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84195.4355; train_chrom_access_recon_loss: 4030809.6794; train_global_loss: 23672753.3282; train_optim_loss: 23672753.3282; val_kl_reg_loss: 64587.0266; val_edge_recon_loss: 593344.8667; val_gene_expr_recon_loss: 18970284.9333; val_masked_gp_l1_reg_loss: 133246.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84732.7266; val_chrom_access_recon_loss: 4066075.5333; val_global_loss: 23912270.4000; val_optim_loss: 23912270.4000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9613; val_auprc_score: 0.9518; val_best_acc_score: 0.9065; val_best_f1_score: 0.9083; train_kl_reg_loss: 66728.8203; train_edge_recon_loss: 587228.8612; train_gene_expr_recon_loss: 18697897.4046; train_masked_gp_l1_reg_loss: 133733.9854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84353.9919; train_chrom_access_recon_loss: 3998599.7252; train_global_loss: 23568542.7634; train_optim_loss: 23568542.7634; val_kl_reg_loss: 67981.0729; val_edge_recon_loss: 590691.4250; val_gene_expr_recon_loss: 19010638.4000; val_masked_gp_l1_reg_loss: 134377.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85064.4375; val_chrom_access_recon_loss: 4063313.1333; val_global_loss: 23952066.2667; val_optim_loss: 23952066.2667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9576; val_auprc_score: 0.9432; val_best_acc_score: 0.9029; val_best_f1_score: 0.9075; train_kl_reg_loss: 66809.4241; train_edge_recon_loss: 587226.8597; train_gene_expr_recon_loss: 18657400.8397; train_masked_gp_l1_reg_loss: 134933.7172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84788.1940; train_chrom_access_recon_loss: 3968499.0782; train_global_loss: 23499658.1069; train_optim_loss: 23499658.1069; val_kl_reg_loss: 67137.4672; val_edge_recon_loss: 590071.7250; val_gene_expr_recon_loss: 18808683.3333; val_masked_gp_l1_reg_loss: 136033.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85843.4297; val_chrom_access_recon_loss: 4032490.5167; val_global_loss: 23720261.2000; val_optim_loss: 23720261.2000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9555; val_auprc_score: 0.9388; val_best_acc_score: 0.9010; val_best_f1_score: 0.9060; train_kl_reg_loss: 67376.4150; train_edge_recon_loss: 585779.3177; train_gene_expr_recon_loss: 18575772.7023; train_masked_gp_l1_reg_loss: 136218.3034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85171.1365; train_chrom_access_recon_loss: 3934237.8912; train_global_loss: 23384555.8473; train_optim_loss: 23384555.8473; val_kl_reg_loss: 65988.2302; val_edge_recon_loss: 589540.6167; val_gene_expr_recon_loss: 18770117.4667; val_masked_gp_l1_reg_loss: 136707.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85217.8672; val_chrom_access_recon_loss: 4006402.8333; val_global_loss: 23653975.2000; val_optim_loss: 23653975.2000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9612; val_auprc_score: 0.9512; val_best_acc_score: 0.9053; val_best_f1_score: 0.9095; train_kl_reg_loss: 67417.1183; train_edge_recon_loss: 586741.9079; train_gene_expr_recon_loss: 18522862.1985; train_masked_gp_l1_reg_loss: 137213.3075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85317.8100; train_chrom_access_recon_loss: 3906593.0344; train_global_loss: 23306145.2977; train_optim_loss: 23306145.2977; val_kl_reg_loss: 68191.5234; val_edge_recon_loss: 591333.4375; val_gene_expr_recon_loss: 18790596.8000; val_masked_gp_l1_reg_loss: 137532.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84825.2188; val_chrom_access_recon_loss: 3983256.7333; val_global_loss: 23655736.4000; val_optim_loss: 23655736.4000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9581; val_auprc_score: 0.9447; val_best_acc_score: 0.9057; val_best_f1_score: 0.9090; train_kl_reg_loss: 67776.5492; train_edge_recon_loss: 587726.8841; train_gene_expr_recon_loss: 18462151.0534; train_masked_gp_l1_reg_loss: 137814.3052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85532.3643; train_chrom_access_recon_loss: 3883321.0191; train_global_loss: 23224322.2595; train_optim_loss: 23224322.2595; val_kl_reg_loss: 68526.1448; val_edge_recon_loss: 592652.7083; val_gene_expr_recon_loss: 18684944.2667; val_masked_gp_l1_reg_loss: 138190.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86034.5781; val_chrom_access_recon_loss: 3963604.9833; val_global_loss: 23533952.1333; val_optim_loss: 23533952.1333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9382; val_auprc_score: 0.9219; val_best_acc_score: 0.8732; val_best_f1_score: 0.8812; train_kl_reg_loss: 58679.9439; train_edge_recon_loss: 639425.8893; train_gene_expr_recon_loss: 18015511.1221; train_masked_gp_l1_reg_loss: 136503.1740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75220.5854; train_chrom_access_recon_loss: 4011221.9313; train_global_loss: 22936562.6565; train_optim_loss: 22936562.6565; val_kl_reg_loss: 41270.5203; val_edge_recon_loss: 616255.6458; val_gene_expr_recon_loss: 18076312.0000; val_masked_gp_l1_reg_loss: 133234.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73884.6328; val_chrom_access_recon_loss: 3998884.3667; val_global_loss: 22939840.6667; val_optim_loss: 22939840.6667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9476; val_auprc_score: 0.9326; val_best_acc_score: 0.8829; val_best_f1_score: 0.8900; train_kl_reg_loss: 59878.3423; train_edge_recon_loss: 604592.1603; train_gene_expr_recon_loss: 17866416.7481; train_masked_gp_l1_reg_loss: 131464.5439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73339.0324; train_chrom_access_recon_loss: 3973458.3969; train_global_loss: 22709149.1603; train_optim_loss: 22709149.1603; val_kl_reg_loss: 48545.9008; val_edge_recon_loss: 597935.9833; val_gene_expr_recon_loss: 18014776.9333; val_masked_gp_l1_reg_loss: 130252.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73428.9219; val_chrom_access_recon_loss: 3980571.3167; val_global_loss: 22845510.4000; val_optim_loss: 22845510.4000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9485; val_auprc_score: 0.9340; val_best_acc_score: 0.8864; val_best_f1_score: 0.8900; train_kl_reg_loss: 60034.2674; train_edge_recon_loss: 595076.5506; train_gene_expr_recon_loss: 17786018.2824; train_masked_gp_l1_reg_loss: 129103.2293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73431.2498; train_chrom_access_recon_loss: 3944172.0515; train_global_loss: 22587835.6489; train_optim_loss: 22587835.6489; val_kl_reg_loss: 52478.5167; val_edge_recon_loss: 596188.6542; val_gene_expr_recon_loss: 18011585.8667; val_masked_gp_l1_reg_loss: 128394.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73682.1719; val_chrom_access_recon_loss: 3979355.4167; val_global_loss: 22841684.8000; val_optim_loss: 22841684.8000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9554; val_auprc_score: 0.9433; val_best_acc_score: 0.8987; val_best_f1_score: 0.9022; train_kl_reg_loss: 59806.0349; train_edge_recon_loss: 591909.5969; train_gene_expr_recon_loss: 17781686.7176; train_masked_gp_l1_reg_loss: 127514.8102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73688.4556; train_chrom_access_recon_loss: 3936424.3779; train_global_loss: 22571030.0916; train_optim_loss: 22571030.0916; val_kl_reg_loss: 51125.3503; val_edge_recon_loss: 594174.8500; val_gene_expr_recon_loss: 17909394.8000; val_masked_gp_l1_reg_loss: 126936.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73904.8438; val_chrom_access_recon_loss: 3945946.1000; val_global_loss: 22701480.9333; val_optim_loss: 22701480.9333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9529; val_auprc_score: 0.9398; val_best_acc_score: 0.8925; val_best_f1_score: 0.8964; train_kl_reg_loss: 59535.7354; train_edge_recon_loss: 588914.9113; train_gene_expr_recon_loss: 17700332.1069; train_masked_gp_l1_reg_loss: 126547.1781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73731.2210; train_chrom_access_recon_loss: 3914377.8149; train_global_loss: 22463439.0687; train_optim_loss: 22463439.0687; val_kl_reg_loss: 54614.7266; val_edge_recon_loss: 592352.2708; val_gene_expr_recon_loss: 17929367.2000; val_masked_gp_l1_reg_loss: 126085.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73851.7266; val_chrom_access_recon_loss: 3957655.1333; val_global_loss: 22733927.2000; val_optim_loss: 22733927.2000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9533; val_auprc_score: 0.9375; val_best_acc_score: 0.8946; val_best_f1_score: 0.8999; train_kl_reg_loss: 59891.6186; train_edge_recon_loss: 588105.9318; train_gene_expr_recon_loss: 17667725.2519; train_masked_gp_l1_reg_loss: 125805.9856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73819.5215; train_chrom_access_recon_loss: 3909370.0153; train_global_loss: 22424718.2595; train_optim_loss: 22424718.2595; val_kl_reg_loss: 55259.9870; val_edge_recon_loss: 593754.2583; val_gene_expr_recon_loss: 17849294.8000; val_masked_gp_l1_reg_loss: 125664.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73649.7109; val_chrom_access_recon_loss: 3937010.6000; val_global_loss: 22634633.8667; val_optim_loss: 22634633.8667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9542; val_auprc_score: 0.9356; val_best_acc_score: 0.9022; val_best_f1_score: 0.9061; train_kl_reg_loss: 60297.8505; train_edge_recon_loss: 587585.3115; train_gene_expr_recon_loss: 17630490.4046; train_masked_gp_l1_reg_loss: 125207.8896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74018.2852; train_chrom_access_recon_loss: 3897186.5248; train_global_loss: 22374786.2290; train_optim_loss: 22374786.2290; val_kl_reg_loss: 54414.6565; val_edge_recon_loss: 587955.7042; val_gene_expr_recon_loss: 17811155.6667; val_masked_gp_l1_reg_loss: 124854.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73930.0547; val_chrom_access_recon_loss: 3963487.4167; val_global_loss: 22615797.4667; val_optim_loss: 22615797.4667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9561; val_auprc_score: 0.9388; val_best_acc_score: 0.9010; val_best_f1_score: 0.9054; train_kl_reg_loss: 60383.8219; train_edge_recon_loss: 585039.4418; train_gene_expr_recon_loss: 17606059.2748; train_masked_gp_l1_reg_loss: 124556.2659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74011.3256; train_chrom_access_recon_loss: 3888346.1756; train_global_loss: 22338396.3511; train_optim_loss: 22338396.3511; val_kl_reg_loss: 55842.3870; val_edge_recon_loss: 588312.5708; val_gene_expr_recon_loss: 17854845.7333; val_masked_gp_l1_reg_loss: 124158.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74001.4453; val_chrom_access_recon_loss: 3921021.4167; val_global_loss: 22618182.0000; val_optim_loss: 22618182.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9575; val_auprc_score: 0.9411; val_best_acc_score: 0.9020; val_best_f1_score: 0.9063; train_kl_reg_loss: 60492.1091; train_edge_recon_loss: 584015.0668; train_gene_expr_recon_loss: 17551215.9466; train_masked_gp_l1_reg_loss: 124203.1419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74052.1221; train_chrom_access_recon_loss: 3873865.2271; train_global_loss: 22267843.6336; train_optim_loss: 22267843.6336; val_kl_reg_loss: 56232.8208; val_edge_recon_loss: 585063.1875; val_gene_expr_recon_loss: 17877467.2000; val_masked_gp_l1_reg_loss: 124274.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74599.2656; val_chrom_access_recon_loss: 3941662.6667; val_global_loss: 22659300.0000; val_optim_loss: 22659300.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9586; val_auprc_score: 0.9479; val_best_acc_score: 0.9053; val_best_f1_score: 0.9097; train_kl_reg_loss: 60733.8306; train_edge_recon_loss: 584755.3154; train_gene_expr_recon_loss: 17528319.9542; train_masked_gp_l1_reg_loss: 124009.5417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74302.3758; train_chrom_access_recon_loss: 3866967.2042; train_global_loss: 22239088.2137; train_optim_loss: 22239088.2137; val_kl_reg_loss: 56158.0659; val_edge_recon_loss: 587530.3458; val_gene_expr_recon_loss: 17778107.7333; val_masked_gp_l1_reg_loss: 123625.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74247.5938; val_chrom_access_recon_loss: 3924366.4333; val_global_loss: 22544036.6667; val_optim_loss: 22544036.6667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9574; val_auprc_score: 0.9450; val_best_acc_score: 0.9016; val_best_f1_score: 0.9057; train_kl_reg_loss: 60596.4996; train_edge_recon_loss: 583992.6250; train_gene_expr_recon_loss: 17485885.5496; train_masked_gp_l1_reg_loss: 123543.3836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74229.1077; train_chrom_access_recon_loss: 3855103.2863; train_global_loss: 22183350.4885; train_optim_loss: 22183350.4885; val_kl_reg_loss: 56021.2404; val_edge_recon_loss: 587631.6833; val_gene_expr_recon_loss: 17813921.7333; val_masked_gp_l1_reg_loss: 123580.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73978.4844; val_chrom_access_recon_loss: 3931440.7667; val_global_loss: 22586573.6000; val_optim_loss: 22586573.6000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9580; val_auprc_score: 0.9446; val_best_acc_score: 0.9054; val_best_f1_score: 0.9097; train_kl_reg_loss: 60829.6034; train_edge_recon_loss: 582365.9198; train_gene_expr_recon_loss: 17482275.3969; train_masked_gp_l1_reg_loss: 123309.4801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74266.3702; train_chrom_access_recon_loss: 3849730.1183; train_global_loss: 22172776.9618; train_optim_loss: 22172776.9618; val_kl_reg_loss: 56986.6398; val_edge_recon_loss: 586070.9750; val_gene_expr_recon_loss: 17790944.2667; val_masked_gp_l1_reg_loss: 123220.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74994.4297; val_chrom_access_recon_loss: 3918005.4500; val_global_loss: 22550221.3333; val_optim_loss: 22550221.3333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9560; val_auprc_score: 0.9410; val_best_acc_score: 0.9025; val_best_f1_score: 0.9070; train_kl_reg_loss: 61234.5634; train_edge_recon_loss: 582671.0372; train_gene_expr_recon_loss: 17452509.2061; train_masked_gp_l1_reg_loss: 123198.4500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74464.7939; train_chrom_access_recon_loss: 3843346.1679; train_global_loss: 22137424.2290; train_optim_loss: 22137424.2290; val_kl_reg_loss: 57546.0555; val_edge_recon_loss: 586554.0792; val_gene_expr_recon_loss: 17755752.8000; val_masked_gp_l1_reg_loss: 122868.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74309.9062; val_chrom_access_recon_loss: 3912216.5667; val_global_loss: 22509247.8667; val_optim_loss: 22509247.8667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9553; val_auprc_score: 0.9422; val_best_acc_score: 0.9029; val_best_f1_score: 0.9069; train_kl_reg_loss: 61470.0284; train_edge_recon_loss: 583593.3182; train_gene_expr_recon_loss: 17418486.9008; train_masked_gp_l1_reg_loss: 122863.1276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74356.2824; train_chrom_access_recon_loss: 3834001.3989; train_global_loss: 22094771.0534; train_optim_loss: 22094771.0534; val_kl_reg_loss: 58535.2635; val_edge_recon_loss: 589587.8125; val_gene_expr_recon_loss: 17724232.0000; val_masked_gp_l1_reg_loss: 122478.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74116.1172; val_chrom_access_recon_loss: 3913684.4167; val_global_loss: 22482633.6000; val_optim_loss: 22482633.6000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9546; val_auprc_score: 0.9389; val_best_acc_score: 0.8995; val_best_f1_score: 0.9048; train_kl_reg_loss: 62017.4079; train_edge_recon_loss: 583499.6307; train_gene_expr_recon_loss: 17418326.6336; train_masked_gp_l1_reg_loss: 122306.7032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74162.4818; train_chrom_access_recon_loss: 3832404.6622; train_global_loss: 22092717.4656; train_optim_loss: 22092717.4656; val_kl_reg_loss: 59106.6128; val_edge_recon_loss: 587874.2083; val_gene_expr_recon_loss: 17766694.5333; val_masked_gp_l1_reg_loss: 121970.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74634.8672; val_chrom_access_recon_loss: 3918448.5333; val_global_loss: 22528728.4000; val_optim_loss: 22528728.4000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9561; val_auprc_score: 0.9382; val_best_acc_score: 0.9069; val_best_f1_score: 0.9103; train_kl_reg_loss: 62435.1279; train_edge_recon_loss: 582871.5353; train_gene_expr_recon_loss: 17395457.5954; train_masked_gp_l1_reg_loss: 122016.5785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74477.1673; train_chrom_access_recon_loss: 3828236.3626; train_global_loss: 22065494.4580; train_optim_loss: 22065494.4580; val_kl_reg_loss: 59141.1359; val_edge_recon_loss: 585960.5208; val_gene_expr_recon_loss: 17624259.4667; val_masked_gp_l1_reg_loss: 121789.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74235.8438; val_chrom_access_recon_loss: 3891078.4333; val_global_loss: 22356465.2000; val_optim_loss: 22356465.2000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9559; val_auprc_score: 0.9428; val_best_acc_score: 0.9023; val_best_f1_score: 0.9068; train_kl_reg_loss: 62524.6101; train_edge_recon_loss: 585349.3764; train_gene_expr_recon_loss: 17399901.3206; train_masked_gp_l1_reg_loss: 121548.1659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74212.5281; train_chrom_access_recon_loss: 3835925.0344; train_global_loss: 22079461.0687; train_optim_loss: 22079461.0687; val_kl_reg_loss: 60739.7089; val_edge_recon_loss: 588600.8042; val_gene_expr_recon_loss: 17722362.0000; val_masked_gp_l1_reg_loss: 120769.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74005.9062; val_chrom_access_recon_loss: 3914927.9833; val_global_loss: 22481406.1333; val_optim_loss: 22481406.1333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9424; val_auprc_score: 0.9205; val_best_acc_score: 0.8861; val_best_f1_score: 0.8918; train_kl_reg_loss: 2741161234.8989; train_edge_recon_loss: 614578.8449; train_gene_expr_recon_loss: 17727420.8092; train_masked_gp_l1_reg_loss: 120258.5673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75382.8901; train_chrom_access_recon_loss: 3923918.3779; train_global_loss: 2763622944.4275; train_optim_loss: 2763622944.4275; val_kl_reg_loss: 59198.4529; val_edge_recon_loss: 607083.3042; val_gene_expr_recon_loss: 17857608.6667; val_masked_gp_l1_reg_loss: 115742.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75794.6875; val_chrom_access_recon_loss: 3941082.7333; val_global_loss: 22656509.0667; val_optim_loss: 22656509.0667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9485; val_auprc_score: 0.9293; val_best_acc_score: 0.8902; val_best_f1_score: 0.8954; train_kl_reg_loss: 176549.0145; train_edge_recon_loss: 596590.1350; train_gene_expr_recon_loss: 17725962.5191; train_masked_gp_l1_reg_loss: 113546.8351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74955.9305; train_chrom_access_recon_loss: 3918066.3588; train_global_loss: 22605670.7939; train_optim_loss: 22605670.7939; val_kl_reg_loss: 65178.6896; val_edge_recon_loss: 596933.0917; val_gene_expr_recon_loss: 17829797.3333; val_masked_gp_l1_reg_loss: 112235.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73882.0469; val_chrom_access_recon_loss: 3943150.1333; val_global_loss: 22621177.4667; val_optim_loss: 22621177.4667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9486; val_auprc_score: 0.9343; val_best_acc_score: 0.8840; val_best_f1_score: 0.8903; train_kl_reg_loss: 365159211.4929; train_edge_recon_loss: 593297.1746; train_gene_expr_recon_loss: 17616659.6336; train_masked_gp_l1_reg_loss: 112195.9744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74332.8393; train_chrom_access_recon_loss: 3903094.6737; train_global_loss: 387458771.0992; train_optim_loss: 387458771.0992; val_kl_reg_loss: 69665.2833; val_edge_recon_loss: 598185.3167; val_gene_expr_recon_loss: 17770881.2000; val_masked_gp_l1_reg_loss: 111051.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74532.9844; val_chrom_access_recon_loss: 3939100.5833; val_global_loss: 22563416.4000; val_optim_loss: 22563416.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9447; val_auprc_score: 0.9273; val_best_acc_score: 0.8876; val_best_f1_score: 0.8944; train_kl_reg_loss: 84617.9798; train_edge_recon_loss: 593531.6570; train_gene_expr_recon_loss: 17632794.8473; train_masked_gp_l1_reg_loss: 106426.4736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59310.0629; train_chrom_access_recon_loss: 3906711.4866; train_global_loss: 22383392.4733; train_optim_loss: 22383392.4733; val_kl_reg_loss: 70523.1219; val_edge_recon_loss: 599036.2667; val_gene_expr_recon_loss: 17734098.0000; val_masked_gp_l1_reg_loss: 105084.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56955.1680; val_chrom_access_recon_loss: 3939341.4833; val_global_loss: 22505038.5333; val_optim_loss: 22505038.5333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9542; val_auprc_score: 0.9393; val_best_acc_score: 0.8989; val_best_f1_score: 0.9041; train_kl_reg_loss: 979414.4071; train_edge_recon_loss: 592439.7906; train_gene_expr_recon_loss: 17572420.4427; train_masked_gp_l1_reg_loss: 104775.9745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56337.5849; train_chrom_access_recon_loss: 3891024.2462; train_global_loss: 23196412.1527; train_optim_loss: 23196412.1527; val_kl_reg_loss: 71195.1656; val_edge_recon_loss: 593351.1292; val_gene_expr_recon_loss: 17733094.0667; val_masked_gp_l1_reg_loss: 104522.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55802.7227; val_chrom_access_recon_loss: 3933590.6667; val_global_loss: 22491555.3333; val_optim_loss: 22491555.3333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9507; val_auprc_score: 0.9380; val_best_acc_score: 0.8902; val_best_f1_score: 0.8968; train_kl_reg_loss: 76536.5833; train_edge_recon_loss: 591613.5115; train_gene_expr_recon_loss: 17545567.4962; train_masked_gp_l1_reg_loss: 104428.6690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55449.1143; train_chrom_access_recon_loss: 3886878.4351; train_global_loss: 22260473.8015; train_optim_loss: 22260473.8015; val_kl_reg_loss: 71306.1849; val_edge_recon_loss: 597453.4167; val_gene_expr_recon_loss: 17751558.0000; val_masked_gp_l1_reg_loss: 104316.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55146.2070; val_chrom_access_recon_loss: 3930680.6167; val_global_loss: 22510460.1333; val_optim_loss: 22510460.1333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9520; val_auprc_score: 0.9366; val_best_acc_score: 0.8933; val_best_f1_score: 0.8977; train_kl_reg_loss: 76941.1391; train_edge_recon_loss: 591238.3173; train_gene_expr_recon_loss: 17571713.6870; train_masked_gp_l1_reg_loss: 104224.4555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54879.9332; train_chrom_access_recon_loss: 3887314.8244; train_global_loss: 22286312.1221; train_optim_loss: 22286312.1221; val_kl_reg_loss: 72532.0839; val_edge_recon_loss: 591791.0750; val_gene_expr_recon_loss: 17847472.1333; val_masked_gp_l1_reg_loss: 104130.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54594.8672; val_chrom_access_recon_loss: 3949837.7000; val_global_loss: 22620356.8000; val_optim_loss: 22620356.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 32 min 14 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9570
val AUPRC score: 0.9439
val best accuracy score: 0.9050
val best F1 score: 0.9099
val target rna MSE score: 1.3402
val source rna MSE score: 0.5103
val target atac MSE score: 1.5170
val source atac MSE score: 0.1496
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
