Run timestamp: 20062023_155323_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', '20', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 20, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1423, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cond_embed_input: 20, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 2342808
Number of validation edges: 260312
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8785; val_auprc_score: 0.9842; val_best_acc_score: 0.9587; val_best_f1_score: 0.9779; train_kl_reg_loss: 5347.7928; train_edge_recon_loss: 46422.6405; train_cond_contrastive_loss: 80727.6885; train_gene_expr_recon_loss: 118287.3292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 250785.4511; train_optim_loss: 250785.4511; val_kl_reg_loss: 4921.5012; val_edge_recon_loss: 42672.3883; val_cond_contrastive_loss: 79305.1085; val_gene_expr_recon_loss: 107115.7029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 234014.7014; val_optim_loss: 234014.7014
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8747; val_auprc_score: 0.9835; val_best_acc_score: 0.9604; val_best_f1_score: 0.9788; train_kl_reg_loss: 5139.1029; train_edge_recon_loss: 42077.9014; train_cond_contrastive_loss: 79991.4759; train_gene_expr_recon_loss: 104098.3909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 231306.8714; train_optim_loss: 231306.8714; val_kl_reg_loss: 5398.3533; val_edge_recon_loss: 42517.8954; val_cond_contrastive_loss: 79369.4723; val_gene_expr_recon_loss: 101931.4836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 229217.2046; val_optim_loss: 229217.2046
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8761; val_auprc_score: 0.9837; val_best_acc_score: 0.9609; val_best_f1_score: 0.9790; train_kl_reg_loss: 5367.8526; train_edge_recon_loss: 41898.8787; train_cond_contrastive_loss: 80170.0928; train_gene_expr_recon_loss: 99810.5120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 227247.3357; train_optim_loss: 227247.3357; val_kl_reg_loss: 5413.2606; val_edge_recon_loss: 41979.4727; val_cond_contrastive_loss: 79734.7104; val_gene_expr_recon_loss: 98284.0496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225411.4917; val_optim_loss: 225411.4917
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8768; val_auprc_score: 0.9838; val_best_acc_score: 0.9616; val_best_f1_score: 0.9794; train_kl_reg_loss: 5605.7874; train_edge_recon_loss: 41716.1754; train_cond_contrastive_loss: 80297.8703; train_gene_expr_recon_loss: 96910.2058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224530.0387; train_optim_loss: 224530.0387; val_kl_reg_loss: 5671.4784; val_edge_recon_loss: 41985.8597; val_cond_contrastive_loss: 79808.5319; val_gene_expr_recon_loss: 95858.0889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 223323.9578; val_optim_loss: 223323.9578
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8758; val_auprc_score: 0.9837; val_best_acc_score: 0.9606; val_best_f1_score: 0.9789; train_kl_reg_loss: 5776.7323; train_edge_recon_loss: 41365.5254; train_cond_contrastive_loss: 80342.3443; train_gene_expr_recon_loss: 95057.4517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 222542.0531; train_optim_loss: 222542.0531; val_kl_reg_loss: 5770.7821; val_edge_recon_loss: 41620.1641; val_cond_contrastive_loss: 79748.6606; val_gene_expr_recon_loss: 94413.7646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 221553.3713; val_optim_loss: 221553.3713
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8746; val_auprc_score: 0.9835; val_best_acc_score: 0.9624; val_best_f1_score: 0.9799; train_kl_reg_loss: 5877.9758; train_edge_recon_loss: 41254.1645; train_cond_contrastive_loss: 80305.4243; train_gene_expr_recon_loss: 93832.9409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 221270.5052; train_optim_loss: 221270.5052; val_kl_reg_loss: 5913.5641; val_edge_recon_loss: 41730.7481; val_cond_contrastive_loss: 79792.8997; val_gene_expr_recon_loss: 93426.7316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 220863.9424; val_optim_loss: 220863.9424
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8777; val_auprc_score: 0.9840; val_best_acc_score: 0.9607; val_best_f1_score: 0.9789; train_kl_reg_loss: 5951.1120; train_edge_recon_loss: 41310.3835; train_cond_contrastive_loss: 80266.3092; train_gene_expr_recon_loss: 92975.5004; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 220503.3054; train_optim_loss: 220503.3054; val_kl_reg_loss: 5898.8655; val_edge_recon_loss: 41374.2625; val_cond_contrastive_loss: 79736.3558; val_gene_expr_recon_loss: 92616.7007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219626.1838; val_optim_loss: 219626.1838
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8765; val_auprc_score: 0.9836; val_best_acc_score: 0.9609; val_best_f1_score: 0.9790; train_kl_reg_loss: 6009.4572; train_edge_recon_loss: 41335.9763; train_cond_contrastive_loss: 80220.2093; train_gene_expr_recon_loss: 92273.8314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219839.4737; train_optim_loss: 219839.4737; val_kl_reg_loss: 5735.3610; val_edge_recon_loss: 41785.2557; val_cond_contrastive_loss: 79871.7393; val_gene_expr_recon_loss: 92048.1823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 219440.5391; val_optim_loss: 219440.5391
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8797; val_auprc_score: 0.9838; val_best_acc_score: 0.9622; val_best_f1_score: 0.9797; train_kl_reg_loss: 6055.9781; train_edge_recon_loss: 41375.7405; train_cond_contrastive_loss: 80183.5479; train_gene_expr_recon_loss: 91731.2688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 219346.5353; train_optim_loss: 219346.5353; val_kl_reg_loss: 6094.8852; val_edge_recon_loss: 41555.4000; val_cond_contrastive_loss: 79646.7616; val_gene_expr_recon_loss: 91541.0099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218838.0557; val_optim_loss: 218838.0557
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8792; val_auprc_score: 0.9839; val_best_acc_score: 0.9610; val_best_f1_score: 0.9791; train_kl_reg_loss: 6093.2400; train_edge_recon_loss: 41339.1283; train_cond_contrastive_loss: 80142.9990; train_gene_expr_recon_loss: 91316.3595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218891.7267; train_optim_loss: 218891.7267; val_kl_reg_loss: 5898.6870; val_edge_recon_loss: 41757.9753; val_cond_contrastive_loss: 79690.7334; val_gene_expr_recon_loss: 91183.5922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 218530.9880; val_optim_loss: 218530.9880
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8835; val_auprc_score: 0.9846; val_best_acc_score: 0.9621; val_best_f1_score: 0.9797; train_kl_reg_loss: 6125.9116; train_edge_recon_loss: 41273.0187; train_cond_contrastive_loss: 80095.2495; train_gene_expr_recon_loss: 90961.4161; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 218455.5959; train_optim_loss: 218455.5959; val_kl_reg_loss: 6098.7620; val_edge_recon_loss: 41094.9124; val_cond_contrastive_loss: 79673.9541; val_gene_expr_recon_loss: 90898.9790; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217766.6077; val_optim_loss: 217766.6077
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8811; val_auprc_score: 0.9841; val_best_acc_score: 0.9626; val_best_f1_score: 0.9800; train_kl_reg_loss: 6146.4435; train_edge_recon_loss: 41066.1674; train_cond_contrastive_loss: 80065.2825; train_gene_expr_recon_loss: 90708.7337; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217986.6269; train_optim_loss: 217986.6269; val_kl_reg_loss: 6093.9713; val_edge_recon_loss: 41482.4097; val_cond_contrastive_loss: 79653.4437; val_gene_expr_recon_loss: 90601.8732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217831.6975; val_optim_loss: 217831.6975
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8805; val_auprc_score: 0.9839; val_best_acc_score: 0.9635; val_best_f1_score: 0.9804; train_kl_reg_loss: 6161.7263; train_edge_recon_loss: 41239.1315; train_cond_contrastive_loss: 80031.1322; train_gene_expr_recon_loss: 90476.1948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217908.1848; train_optim_loss: 217908.1848; val_kl_reg_loss: 6081.5319; val_edge_recon_loss: 41601.1480; val_cond_contrastive_loss: 79548.2396; val_gene_expr_recon_loss: 90429.6979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217660.6172; val_optim_loss: 217660.6172
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8819; val_auprc_score: 0.9840; val_best_acc_score: 0.9606; val_best_f1_score: 0.9788; train_kl_reg_loss: 6177.7014; train_edge_recon_loss: 41122.2190; train_cond_contrastive_loss: 79994.2342; train_gene_expr_recon_loss: 90320.3513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217614.5058; train_optim_loss: 217614.5058; val_kl_reg_loss: 5945.5485; val_edge_recon_loss: 41822.6870; val_cond_contrastive_loss: 79730.6429; val_gene_expr_recon_loss: 90420.7577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217919.6367; val_optim_loss: 217919.6367
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8796; val_auprc_score: 0.9837; val_best_acc_score: 0.9631; val_best_f1_score: 0.9802; train_kl_reg_loss: 6195.9460; train_edge_recon_loss: 41090.1280; train_cond_contrastive_loss: 79969.8896; train_gene_expr_recon_loss: 90174.6458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217430.6097; train_optim_loss: 217430.6097; val_kl_reg_loss: 6159.5026; val_edge_recon_loss: 41633.4682; val_cond_contrastive_loss: 79491.9167; val_gene_expr_recon_loss: 90216.8678; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217501.7561; val_optim_loss: 217501.7561
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8829; val_auprc_score: 0.9843; val_best_acc_score: 0.9642; val_best_f1_score: 0.9808; train_kl_reg_loss: 6201.4479; train_edge_recon_loss: 40993.4719; train_cond_contrastive_loss: 79942.1304; train_gene_expr_recon_loss: 90015.5732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217152.6234; train_optim_loss: 217152.6234; val_kl_reg_loss: 6107.1353; val_edge_recon_loss: 41197.0805; val_cond_contrastive_loss: 79479.9061; val_gene_expr_recon_loss: 90064.4038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216848.5256; val_optim_loss: 216848.5256
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8801; val_auprc_score: 0.9838; val_best_acc_score: 0.9630; val_best_f1_score: 0.9801; train_kl_reg_loss: 6211.3363; train_edge_recon_loss: 41098.6601; train_cond_contrastive_loss: 79928.0509; train_gene_expr_recon_loss: 89898.1898; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 217136.2374; train_optim_loss: 217136.2374; val_kl_reg_loss: 6105.5709; val_edge_recon_loss: 41348.5464; val_cond_contrastive_loss: 79527.9813; val_gene_expr_recon_loss: 89979.6583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216961.7561; val_optim_loss: 216961.7561
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8839; val_auprc_score: 0.9845; val_best_acc_score: 0.9632; val_best_f1_score: 0.9802; train_kl_reg_loss: 6218.9564; train_edge_recon_loss: 40782.1588; train_cond_contrastive_loss: 79896.2301; train_gene_expr_recon_loss: 89778.8520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216676.1976; train_optim_loss: 216676.1976; val_kl_reg_loss: 5934.8318; val_edge_recon_loss: 41226.2134; val_cond_contrastive_loss: 79633.0419; val_gene_expr_recon_loss: 89887.1809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216681.2683; val_optim_loss: 216681.2683
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8797; val_auprc_score: 0.9837; val_best_acc_score: 0.9632; val_best_f1_score: 0.9802; train_kl_reg_loss: 6229.0719; train_edge_recon_loss: 40963.8781; train_cond_contrastive_loss: 79883.8856; train_gene_expr_recon_loss: 89704.8700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216781.7056; train_optim_loss: 216781.7056; val_kl_reg_loss: 6011.5005; val_edge_recon_loss: 41424.2807; val_cond_contrastive_loss: 79539.0250; val_gene_expr_recon_loss: 89745.9750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216720.7812; val_optim_loss: 216720.7812
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8841; val_auprc_score: 0.9843; val_best_acc_score: 0.9630; val_best_f1_score: 0.9801; train_kl_reg_loss: 6233.8750; train_edge_recon_loss: 41089.2209; train_cond_contrastive_loss: 79865.1257; train_gene_expr_recon_loss: 89622.2094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216810.4309; train_optim_loss: 216810.4309; val_kl_reg_loss: 6164.7547; val_edge_recon_loss: 41303.9320; val_cond_contrastive_loss: 79459.7738; val_gene_expr_recon_loss: 89717.8628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216646.3215; val_optim_loss: 216646.3215
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8792; val_auprc_score: 0.9834; val_best_acc_score: 0.9640; val_best_f1_score: 0.9807; train_kl_reg_loss: 6247.3550; train_edge_recon_loss: 41068.3573; train_cond_contrastive_loss: 79853.2324; train_gene_expr_recon_loss: 89559.3058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216728.2508; train_optim_loss: 216728.2508; val_kl_reg_loss: 6130.9592; val_edge_recon_loss: 41721.4161; val_cond_contrastive_loss: 79464.8529; val_gene_expr_recon_loss: 89590.2037; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216907.4309; val_optim_loss: 216907.4309
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8843; val_auprc_score: 0.9841; val_best_acc_score: 0.9647; val_best_f1_score: 0.9810; train_kl_reg_loss: 6246.0867; train_edge_recon_loss: 40977.4390; train_cond_contrastive_loss: 79833.2541; train_gene_expr_recon_loss: 89470.5563; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216527.3361; train_optim_loss: 216527.3361; val_kl_reg_loss: 6251.7633; val_edge_recon_loss: 41851.7051; val_cond_contrastive_loss: 79429.0677; val_gene_expr_recon_loss: 89623.6626; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 217156.1997; val_optim_loss: 217156.1997
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8853; val_auprc_score: 0.9844; val_best_acc_score: 0.9629; val_best_f1_score: 0.9801; train_kl_reg_loss: 6259.2525; train_edge_recon_loss: 41054.2154; train_cond_contrastive_loss: 79822.5019; train_gene_expr_recon_loss: 89401.3471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216537.3168; train_optim_loss: 216537.3168; val_kl_reg_loss: 6082.8145; val_edge_recon_loss: 41525.2222; val_cond_contrastive_loss: 79484.4340; val_gene_expr_recon_loss: 89534.2319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216626.7021; val_optim_loss: 216626.7021
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8829; val_auprc_score: 0.9839; val_best_acc_score: 0.9632; val_best_f1_score: 0.9802; train_kl_reg_loss: 6260.7718; train_edge_recon_loss: 41039.2533; train_cond_contrastive_loss: 79815.6229; train_gene_expr_recon_loss: 89359.5228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216475.1707; train_optim_loss: 216475.1707; val_kl_reg_loss: 6116.3402; val_edge_recon_loss: 41894.1157; val_cond_contrastive_loss: 79452.3715; val_gene_expr_recon_loss: 89523.3997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216986.2283; val_optim_loss: 216986.2283
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8858; val_auprc_score: 0.9845; val_best_acc_score: 0.9644; val_best_f1_score: 0.9809; train_kl_reg_loss: 6266.5738; train_edge_recon_loss: 41078.6468; train_cond_contrastive_loss: 79794.4919; train_gene_expr_recon_loss: 89289.0877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 216428.7999; train_optim_loss: 216428.7999; val_kl_reg_loss: 6101.4280; val_edge_recon_loss: 41023.9830; val_cond_contrastive_loss: 79433.3723; val_gene_expr_recon_loss: 89499.5437; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 216058.3271; val_optim_loss: 216058.3271
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8818; val_auprc_score: 0.9839; val_best_acc_score: 0.9645; val_best_f1_score: 0.9810; train_kl_reg_loss: 5550.8706; train_edge_recon_loss: 41009.6541; train_cond_contrastive_loss: 79792.0259; train_gene_expr_recon_loss: 89231.9052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215584.4559; train_optim_loss: 215584.4559; val_kl_reg_loss: 5316.2767; val_edge_recon_loss: 41600.8554; val_cond_contrastive_loss: 79430.9142; val_gene_expr_recon_loss: 89484.1725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215832.2202; val_optim_loss: 215832.2202
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8854; val_auprc_score: 0.9843; val_best_acc_score: 0.9644; val_best_f1_score: 0.9809; train_kl_reg_loss: 5431.3257; train_edge_recon_loss: 40891.8417; train_cond_contrastive_loss: 79709.7776; train_gene_expr_recon_loss: 89186.1501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 215219.0948; train_optim_loss: 215219.0948; val_kl_reg_loss: 5155.0454; val_edge_recon_loss: 41238.9455; val_cond_contrastive_loss: 79546.0677; val_gene_expr_recon_loss: 89420.3306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215360.3906; val_optim_loss: 215360.3906
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8804; val_auprc_score: 0.9837; val_best_acc_score: 0.9642; val_best_f1_score: 0.9808; train_kl_reg_loss: 5399.2612; train_edge_recon_loss: 40741.7688; train_cond_contrastive_loss: 79685.7097; train_gene_expr_recon_loss: 89136.2190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214962.9583; train_optim_loss: 214962.9583; val_kl_reg_loss: 5322.7067; val_edge_recon_loss: 41420.6138; val_cond_contrastive_loss: 79404.7009; val_gene_expr_recon_loss: 89282.8950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215430.9158; val_optim_loss: 215430.9158
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8844; val_auprc_score: 0.9843; val_best_acc_score: 0.9633; val_best_f1_score: 0.9803; train_kl_reg_loss: 5389.8208; train_edge_recon_loss: 40798.9641; train_cond_contrastive_loss: 79667.1299; train_gene_expr_recon_loss: 89101.0037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214956.9184; train_optim_loss: 214956.9184; val_kl_reg_loss: 5225.4050; val_edge_recon_loss: 40990.0627; val_cond_contrastive_loss: 79482.3875; val_gene_expr_recon_loss: 89360.1801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215058.0364; val_optim_loss: 215058.0364
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8835; val_auprc_score: 0.9842; val_best_acc_score: 0.9641; val_best_f1_score: 0.9807; train_kl_reg_loss: 5376.8764; train_edge_recon_loss: 40795.6387; train_cond_contrastive_loss: 79647.1102; train_gene_expr_recon_loss: 89076.9020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214896.5273; train_optim_loss: 214896.5273; val_kl_reg_loss: 5213.5236; val_edge_recon_loss: 41223.0378; val_cond_contrastive_loss: 79481.7982; val_gene_expr_recon_loss: 89256.6670; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215175.0264; val_optim_loss: 215175.0264
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8836; val_auprc_score: 0.9842; val_best_acc_score: 0.9649; val_best_f1_score: 0.9811; train_kl_reg_loss: 5362.0003; train_edge_recon_loss: 40752.2798; train_cond_contrastive_loss: 79640.1240; train_gene_expr_recon_loss: 89067.5942; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214821.9983; train_optim_loss: 214821.9983; val_kl_reg_loss: 5231.1804; val_edge_recon_loss: 41381.5098; val_cond_contrastive_loss: 79423.5457; val_gene_expr_recon_loss: 89210.4921; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215246.7290; val_optim_loss: 215246.7290
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8847; val_auprc_score: 0.9843; val_best_acc_score: 0.9647; val_best_f1_score: 0.9811; train_kl_reg_loss: 5345.0648; train_edge_recon_loss: 40818.0628; train_cond_contrastive_loss: 79626.2181; train_gene_expr_recon_loss: 89017.8190; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214807.1649; train_optim_loss: 214807.1649; val_kl_reg_loss: 5281.0081; val_edge_recon_loss: 41175.3934; val_cond_contrastive_loss: 79396.1646; val_gene_expr_recon_loss: 89296.9877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 215149.5530; val_optim_loss: 215149.5530

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8820; val_auprc_score: 0.9838; val_best_acc_score: 0.9649; val_best_f1_score: 0.9811; train_kl_reg_loss: 5321.3018; train_edge_recon_loss: 40727.9821; train_cond_contrastive_loss: 79621.8461; train_gene_expr_recon_loss: 88504.0924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214175.2224; train_optim_loss: 214175.2224; val_kl_reg_loss: 5214.8536; val_edge_recon_loss: 41317.2180; val_cond_contrastive_loss: 79402.7209; val_gene_expr_recon_loss: 88771.3015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214706.0945; val_optim_loss: 214706.0945
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8833; val_auprc_score: 0.9841; val_best_acc_score: 0.9648; val_best_f1_score: 0.9811; train_kl_reg_loss: 5318.5691; train_edge_recon_loss: 40831.6418; train_cond_contrastive_loss: 79617.6780; train_gene_expr_recon_loss: 88462.2633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214230.1522; train_optim_loss: 214230.1522; val_kl_reg_loss: 5222.2516; val_edge_recon_loss: 41092.9573; val_cond_contrastive_loss: 79412.6104; val_gene_expr_recon_loss: 88781.7764; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214509.5969; val_optim_loss: 214509.5969
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8847; val_auprc_score: 0.9844; val_best_acc_score: 0.9656; val_best_f1_score: 0.9816; train_kl_reg_loss: 5321.8406; train_edge_recon_loss: 40745.6351; train_cond_contrastive_loss: 79606.7266; train_gene_expr_recon_loss: 88435.8668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214110.0691; train_optim_loss: 214110.0691; val_kl_reg_loss: 5244.4695; val_edge_recon_loss: 40916.3693; val_cond_contrastive_loss: 79385.5074; val_gene_expr_recon_loss: 88833.6674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214380.0132; val_optim_loss: 214380.0132
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.8796; val_auprc_score: 0.9835; val_best_acc_score: 0.9655; val_best_f1_score: 0.9815; train_kl_reg_loss: 5318.5941; train_edge_recon_loss: 40648.7682; train_cond_contrastive_loss: 79605.6998; train_gene_expr_recon_loss: 88439.2064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214012.2688; train_optim_loss: 214012.2688; val_kl_reg_loss: 5285.3167; val_edge_recon_loss: 41479.1449; val_cond_contrastive_loss: 79340.5735; val_gene_expr_recon_loss: 88813.8627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214918.8972; val_optim_loss: 214918.8972
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8845; val_auprc_score: 0.9844; val_best_acc_score: 0.9656; val_best_f1_score: 0.9815; train_kl_reg_loss: 5313.2086; train_edge_recon_loss: 40748.6182; train_cond_contrastive_loss: 79598.9838; train_gene_expr_recon_loss: 88418.5144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214079.3248; train_optim_loss: 214079.3248; val_kl_reg_loss: 5203.7315; val_edge_recon_loss: 40647.9630; val_cond_contrastive_loss: 79403.2855; val_gene_expr_recon_loss: 88712.0298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 213967.0098; val_optim_loss: 213967.0098
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.8857; val_auprc_score: 0.9844; val_best_acc_score: 0.9650; val_best_f1_score: 0.9812; train_kl_reg_loss: 5311.6292; train_edge_recon_loss: 40719.4093; train_cond_contrastive_loss: 79596.1712; train_gene_expr_recon_loss: 88434.0747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214061.2843; train_optim_loss: 214061.2843; val_kl_reg_loss: 5215.6942; val_edge_recon_loss: 41392.0972; val_cond_contrastive_loss: 79417.5790; val_gene_expr_recon_loss: 88699.2490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214724.6189; val_optim_loss: 214724.6189
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.8821; val_auprc_score: 0.9837; val_best_acc_score: 0.9649; val_best_f1_score: 0.9812; train_kl_reg_loss: 5306.8685; train_edge_recon_loss: 40737.3640; train_cond_contrastive_loss: 79594.7899; train_gene_expr_recon_loss: 88420.2996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 214059.3215; train_optim_loss: 214059.3215; val_kl_reg_loss: 5205.6499; val_edge_recon_loss: 41368.3683; val_cond_contrastive_loss: 79405.4961; val_gene_expr_recon_loss: 88757.4181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214736.9321; val_optim_loss: 214736.9321
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.8850; val_auprc_score: 0.9846; val_best_acc_score: 0.9654; val_best_f1_score: 0.9815; train_kl_reg_loss: 5306.0089; train_edge_recon_loss: 40528.5196; train_cond_contrastive_loss: 79596.6318; train_gene_expr_recon_loss: 88423.5357; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213854.6958; train_optim_loss: 213854.6958; val_kl_reg_loss: 5212.0301; val_edge_recon_loss: 40661.4323; val_cond_contrastive_loss: 79388.5060; val_gene_expr_recon_loss: 88789.8894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214051.8586; val_optim_loss: 214051.8586

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.8825; val_auprc_score: 0.9838; val_best_acc_score: 0.9652; val_best_f1_score: 0.9813; train_kl_reg_loss: 5295.1727; train_edge_recon_loss: 40734.5918; train_cond_contrastive_loss: 79593.6293; train_gene_expr_recon_loss: 88292.5687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213915.9628; train_optim_loss: 213915.9628; val_kl_reg_loss: 5217.2879; val_edge_recon_loss: 41272.7538; val_cond_contrastive_loss: 79374.9613; val_gene_expr_recon_loss: 88758.4911; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214623.4939; val_optim_loss: 214623.4939
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.8872; val_auprc_score: 0.9846; val_best_acc_score: 0.9659; val_best_f1_score: 0.9817; train_kl_reg_loss: 5302.9749; train_edge_recon_loss: 40739.4467; train_cond_contrastive_loss: 79587.3764; train_gene_expr_recon_loss: 88300.6789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213930.4767; train_optim_loss: 213930.4767; val_kl_reg_loss: 5216.8019; val_edge_recon_loss: 40883.1599; val_cond_contrastive_loss: 79385.6942; val_gene_expr_recon_loss: 88688.7451; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214174.4009; val_optim_loss: 214174.4009
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.8833; val_auprc_score: 0.9840; val_best_acc_score: 0.9655; val_best_f1_score: 0.9814; train_kl_reg_loss: 5301.4895; train_edge_recon_loss: 40570.4047; train_cond_contrastive_loss: 79590.8380; train_gene_expr_recon_loss: 88323.1814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 213785.9132; train_optim_loss: 213785.9132; val_kl_reg_loss: 5221.6987; val_edge_recon_loss: 41151.9034; val_cond_contrastive_loss: 79390.4757; val_gene_expr_recon_loss: 88756.2787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 214520.3574; val_optim_loss: 214520.3574
