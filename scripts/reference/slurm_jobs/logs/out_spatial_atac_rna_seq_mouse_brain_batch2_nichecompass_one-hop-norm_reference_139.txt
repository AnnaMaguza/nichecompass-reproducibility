[True]
Run timestamp: 10102023_041559_139.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_139']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6278; val_auprc_score: 0.6123; val_best_acc_score: 0.5019; val_best_f1_score: 0.6669; train_kl_reg_loss: 44355.9725; train_edge_recon_loss: 3509624.5568; train_gene_expr_recon_loss: 14085078.4545; train_masked_gp_l1_reg_loss: 45834.4290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5435413.6023; train_chrom_access_recon_loss: 4954321.6667; train_global_loss: 28074628.7879; train_optim_loss: 28074628.7879; val_kl_reg_loss: 75098.8711; val_edge_recon_loss: 4064798.5000; val_gene_expr_recon_loss: 13143791.2500; val_masked_gp_l1_reg_loss: 56394.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2413957.0000; val_chrom_access_recon_loss: 4777856.5625; val_global_loss: 24531896.2500; val_optim_loss: 24531896.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6907; val_auprc_score: 0.6662; val_best_acc_score: 0.5884; val_best_f1_score: 0.6966; train_kl_reg_loss: 86488.6774; train_edge_recon_loss: 3517123.5152; train_gene_expr_recon_loss: 12920136.8939; train_masked_gp_l1_reg_loss: 57796.7073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1078627.5256; train_chrom_access_recon_loss: 4747413.0227; train_global_loss: 22407586.3636; train_optim_loss: 22407586.3636; val_kl_reg_loss: 96734.9990; val_edge_recon_loss: 4059689.7500; val_gene_expr_recon_loss: 12694426.7500; val_masked_gp_l1_reg_loss: 58623.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 421714.3750; val_chrom_access_recon_loss: 4682733.3125; val_global_loss: 22013922.5000; val_optim_loss: 22013922.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7337; val_auprc_score: 0.7049; val_best_acc_score: 0.6677; val_best_f1_score: 0.7048; train_kl_reg_loss: 84062.7796; train_edge_recon_loss: 3508327.4811; train_gene_expr_recon_loss: 12722564.1667; train_masked_gp_l1_reg_loss: 59789.1880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 291702.4313; train_chrom_access_recon_loss: 4699132.5530; train_global_loss: 21365578.6061; train_optim_loss: 21365578.6061; val_kl_reg_loss: 68518.8018; val_edge_recon_loss: 4016189.2500; val_gene_expr_recon_loss: 12662604.0000; val_masked_gp_l1_reg_loss: 61152.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 213724.5312; val_chrom_access_recon_loss: 4672896.0000; val_global_loss: 21695084.2500; val_optim_loss: 21695084.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7844; val_auprc_score: 0.7760; val_best_acc_score: 0.6921; val_best_f1_score: 0.7441; train_kl_reg_loss: 68859.0099; train_edge_recon_loss: 3457458.9773; train_gene_expr_recon_loss: 12630991.4394; train_masked_gp_l1_reg_loss: 62535.5268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181141.7805; train_chrom_access_recon_loss: 4671084.9242; train_global_loss: 21072071.6667; train_optim_loss: 21072071.6667; val_kl_reg_loss: 57616.3076; val_edge_recon_loss: 3459384.7188; val_gene_expr_recon_loss: 12496284.3750; val_masked_gp_l1_reg_loss: 64624.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156926.2969; val_chrom_access_recon_loss: 4639505.5000; val_global_loss: 20874342.2500; val_optim_loss: 20874342.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8234; val_auprc_score: 0.8134; val_best_acc_score: 0.7273; val_best_f1_score: 0.7616; train_kl_reg_loss: 81160.2775; train_edge_recon_loss: 3127507.5152; train_gene_expr_recon_loss: 12572169.1061; train_masked_gp_l1_reg_loss: 68152.7084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141608.1005; train_chrom_access_recon_loss: 4652335.9015; train_global_loss: 20642933.6364; train_optim_loss: 20642933.6364; val_kl_reg_loss: 93785.2148; val_edge_recon_loss: 3105260.8125; val_gene_expr_recon_loss: 12439468.2500; val_masked_gp_l1_reg_loss: 70610.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128190.7031; val_chrom_access_recon_loss: 4609353.1250; val_global_loss: 20446669.0000; val_optim_loss: 20446669.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8454; val_auprc_score: 0.8182; val_best_acc_score: 0.7673; val_best_f1_score: 0.7964; train_kl_reg_loss: 96902.0355; train_edge_recon_loss: 3004016.4470; train_gene_expr_recon_loss: 12497698.4697; train_masked_gp_l1_reg_loss: 72566.8067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122639.7610; train_chrom_access_recon_loss: 4622049.7652; train_global_loss: 20415873.2424; train_optim_loss: 20415873.2424; val_kl_reg_loss: 101830.5322; val_edge_recon_loss: 2985708.5938; val_gene_expr_recon_loss: 12466577.3750; val_masked_gp_l1_reg_loss: 74522.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118296.7969; val_chrom_access_recon_loss: 4639263.0000; val_global_loss: 20386199.7500; val_optim_loss: 20386199.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8787; val_auprc_score: 0.8434; val_best_acc_score: 0.8095; val_best_f1_score: 0.8281; train_kl_reg_loss: 99910.5382; train_edge_recon_loss: 2900030.0606; train_gene_expr_recon_loss: 12421206.5606; train_masked_gp_l1_reg_loss: 75926.4963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116047.7789; train_chrom_access_recon_loss: 4601022.6439; train_global_loss: 20214144.0909; train_optim_loss: 20214144.0909; val_kl_reg_loss: 100966.3887; val_edge_recon_loss: 2849024.6875; val_gene_expr_recon_loss: 12298691.6250; val_masked_gp_l1_reg_loss: 77360.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112814.0859; val_chrom_access_recon_loss: 4585471.8750; val_global_loss: 20024328.5000; val_optim_loss: 20024328.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8688; val_auprc_score: 0.8320; val_best_acc_score: 0.7982; val_best_f1_score: 0.8191; train_kl_reg_loss: 100287.6456; train_edge_recon_loss: 2858521.7083; train_gene_expr_recon_loss: 12342974.8485; train_masked_gp_l1_reg_loss: 78394.7512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109276.4746; train_chrom_access_recon_loss: 4571918.9015; train_global_loss: 20061374.4242; train_optim_loss: 20061374.4242; val_kl_reg_loss: 100910.8135; val_edge_recon_loss: 2911978.6875; val_gene_expr_recon_loss: 12232843.1250; val_masked_gp_l1_reg_loss: 79272.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106465.0625; val_chrom_access_recon_loss: 4543750.1250; val_global_loss: 19975220.0000; val_optim_loss: 19975220.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8804; val_auprc_score: 0.8450; val_best_acc_score: 0.8111; val_best_f1_score: 0.8296; train_kl_reg_loss: 95496.0962; train_edge_recon_loss: 2851430.1098; train_gene_expr_recon_loss: 12288832.0606; train_masked_gp_l1_reg_loss: 79899.7186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103713.0837; train_chrom_access_recon_loss: 4558385.4545; train_global_loss: 19977756.4545; train_optim_loss: 19977756.4545; val_kl_reg_loss: 94391.5098; val_edge_recon_loss: 2885439.3750; val_gene_expr_recon_loss: 12216424.2500; val_masked_gp_l1_reg_loss: 81027.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102417.7109; val_chrom_access_recon_loss: 4515713.0625; val_global_loss: 19895414.2500; val_optim_loss: 19895414.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8969; val_auprc_score: 0.8628; val_best_acc_score: 0.8248; val_best_f1_score: 0.8372; train_kl_reg_loss: 94067.3406; train_edge_recon_loss: 2827441.9394; train_gene_expr_recon_loss: 12241947.4848; train_masked_gp_l1_reg_loss: 81862.7929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100646.3948; train_chrom_access_recon_loss: 4544324.8182; train_global_loss: 19890290.7576; train_optim_loss: 19890290.7576; val_kl_reg_loss: 94008.5781; val_edge_recon_loss: 2858520.8438; val_gene_expr_recon_loss: 12148988.3750; val_masked_gp_l1_reg_loss: 82741.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100057.6172; val_chrom_access_recon_loss: 4503794.2500; val_global_loss: 19788112.0000; val_optim_loss: 19788112.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8956; val_auprc_score: 0.8636; val_best_acc_score: 0.8267; val_best_f1_score: 0.8383; train_kl_reg_loss: 95676.7884; train_edge_recon_loss: 2806114.6856; train_gene_expr_recon_loss: 12188147.1061; train_masked_gp_l1_reg_loss: 83402.1154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99615.1365; train_chrom_access_recon_loss: 4530489.7803; train_global_loss: 19803445.6364; train_optim_loss: 19803445.6364; val_kl_reg_loss: 98641.5723; val_edge_recon_loss: 2847841.9375; val_gene_expr_recon_loss: 11980598.5000; val_masked_gp_l1_reg_loss: 84213.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99224.3516; val_chrom_access_recon_loss: 4492711.6250; val_global_loss: 19603230.7500; val_optim_loss: 19603230.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9035; val_auprc_score: 0.8736; val_best_acc_score: 0.8348; val_best_f1_score: 0.8453; train_kl_reg_loss: 95043.1812; train_edge_recon_loss: 2796188.0909; train_gene_expr_recon_loss: 12139908.3788; train_masked_gp_l1_reg_loss: 84820.2082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99337.8660; train_chrom_access_recon_loss: 4509540.6591; train_global_loss: 19724838.4545; train_optim_loss: 19724838.4545; val_kl_reg_loss: 95713.3115; val_edge_recon_loss: 2821861.8125; val_gene_expr_recon_loss: 12145675.3750; val_masked_gp_l1_reg_loss: 85546.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99413.6484; val_chrom_access_recon_loss: 4536298.3750; val_global_loss: 19784510.0000; val_optim_loss: 19784510.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9056; val_auprc_score: 0.8714; val_best_acc_score: 0.8404; val_best_f1_score: 0.8497; train_kl_reg_loss: 95695.1212; train_edge_recon_loss: 2788733.0568; train_gene_expr_recon_loss: 12109876.6970; train_masked_gp_l1_reg_loss: 86119.8916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98343.3093; train_chrom_access_recon_loss: 4498922.7576; train_global_loss: 19677690.8788; train_optim_loss: 19677690.8788; val_kl_reg_loss: 96647.2578; val_edge_recon_loss: 2807045.4375; val_gene_expr_recon_loss: 12064251.3750; val_masked_gp_l1_reg_loss: 86427.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97005.3672; val_chrom_access_recon_loss: 4484302.8125; val_global_loss: 19635680.2500; val_optim_loss: 19635680.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9068; val_auprc_score: 0.8766; val_best_acc_score: 0.8361; val_best_f1_score: 0.8494; train_kl_reg_loss: 92905.9116; train_edge_recon_loss: 2783477.2424; train_gene_expr_recon_loss: 12056364.8030; train_masked_gp_l1_reg_loss: 86953.3557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96555.1450; train_chrom_access_recon_loss: 4478551.8864; train_global_loss: 19594808.3939; train_optim_loss: 19594808.3939; val_kl_reg_loss: 94620.9658; val_edge_recon_loss: 2841227.6250; val_gene_expr_recon_loss: 12010472.0000; val_masked_gp_l1_reg_loss: 87622.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95984.9688; val_chrom_access_recon_loss: 4497085.8750; val_global_loss: 19627014.5000; val_optim_loss: 19627014.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8996; val_auprc_score: 0.8592; val_best_acc_score: 0.8391; val_best_f1_score: 0.8476; train_kl_reg_loss: 89940.9734; train_edge_recon_loss: 2778112.6667; train_gene_expr_recon_loss: 12024538.2727; train_masked_gp_l1_reg_loss: 88096.7023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95133.5172; train_chrom_access_recon_loss: 4468573.7424; train_global_loss: 19544395.9697; train_optim_loss: 19544395.9697; val_kl_reg_loss: 90827.5596; val_edge_recon_loss: 2865451.6562; val_gene_expr_recon_loss: 11896097.6250; val_masked_gp_l1_reg_loss: 88761.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95229.7656; val_chrom_access_recon_loss: 4440118.5625; val_global_loss: 19476487.7500; val_optim_loss: 19476487.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9202; val_auprc_score: 0.8885; val_best_acc_score: 0.8632; val_best_f1_score: 0.8729; train_kl_reg_loss: 93455.3447; train_edge_recon_loss: 2757227.7159; train_gene_expr_recon_loss: 11990289.5606; train_masked_gp_l1_reg_loss: 89106.9916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93932.6148; train_chrom_access_recon_loss: 4451834.5038; train_global_loss: 19475846.6667; train_optim_loss: 19475846.6667; val_kl_reg_loss: 94683.2666; val_edge_recon_loss: 2750524.1875; val_gene_expr_recon_loss: 11922485.0000; val_masked_gp_l1_reg_loss: 89092.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92662.0781; val_chrom_access_recon_loss: 4456063.9688; val_global_loss: 19405510.5000; val_optim_loss: 19405510.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9131; val_auprc_score: 0.8857; val_best_acc_score: 0.8493; val_best_f1_score: 0.8624; train_kl_reg_loss: 91784.7475; train_edge_recon_loss: 2774475.6629; train_gene_expr_recon_loss: 11952415.9242; train_masked_gp_l1_reg_loss: 89495.0702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92646.1190; train_chrom_access_recon_loss: 4442582.9659; train_global_loss: 19443400.4848; train_optim_loss: 19443400.4848; val_kl_reg_loss: 90607.7148; val_edge_recon_loss: 2812219.6250; val_gene_expr_recon_loss: 11944452.2500; val_masked_gp_l1_reg_loss: 90063.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92038.8828; val_chrom_access_recon_loss: 4431163.1875; val_global_loss: 19460545.5000; val_optim_loss: 19460545.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9148; val_auprc_score: 0.8824; val_best_acc_score: 0.8589; val_best_f1_score: 0.8677; train_kl_reg_loss: 89535.9361; train_edge_recon_loss: 2754481.4508; train_gene_expr_recon_loss: 11923289.6364; train_masked_gp_l1_reg_loss: 90415.9061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91263.4524; train_chrom_access_recon_loss: 4425426.9924; train_global_loss: 19374413.5455; train_optim_loss: 19374413.5455; val_kl_reg_loss: 93970.4512; val_edge_recon_loss: 2804187.0938; val_gene_expr_recon_loss: 11992765.8750; val_masked_gp_l1_reg_loss: 90774.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90702.3125; val_chrom_access_recon_loss: 4523065.3438; val_global_loss: 19595465.2500; val_optim_loss: 19595465.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9259; val_auprc_score: 0.9000; val_best_acc_score: 0.8673; val_best_f1_score: 0.8772; train_kl_reg_loss: 89150.5800; train_edge_recon_loss: 2765146.4318; train_gene_expr_recon_loss: 11900165.0455; train_masked_gp_l1_reg_loss: 91066.5901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90376.4732; train_chrom_access_recon_loss: 4413629.3864; train_global_loss: 19349534.2727; train_optim_loss: 19349534.2727; val_kl_reg_loss: 85882.8027; val_edge_recon_loss: 2769729.1562; val_gene_expr_recon_loss: 11906095.0000; val_masked_gp_l1_reg_loss: 91374.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90627.4062; val_chrom_access_recon_loss: 4448518.0000; val_global_loss: 19392226.0000; val_optim_loss: 19392226.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9186; val_auprc_score: 0.8920; val_best_acc_score: 0.8608; val_best_f1_score: 0.8668; train_kl_reg_loss: 88639.0067; train_edge_recon_loss: 2733596.9508; train_gene_expr_recon_loss: 11881053.3636; train_masked_gp_l1_reg_loss: 91504.5265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89976.8782; train_chrom_access_recon_loss: 4406265.0644; train_global_loss: 19291035.6061; train_optim_loss: 19291035.6061; val_kl_reg_loss: 87229.5146; val_edge_recon_loss: 2807032.1875; val_gene_expr_recon_loss: 11790576.2500; val_masked_gp_l1_reg_loss: 91705.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89288.6172; val_chrom_access_recon_loss: 4381131.4375; val_global_loss: 19246963.2500; val_optim_loss: 19246963.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9258; val_auprc_score: 0.9010; val_best_acc_score: 0.8627; val_best_f1_score: 0.8742; train_kl_reg_loss: 87318.4190; train_edge_recon_loss: 2743080.5341; train_gene_expr_recon_loss: 11851306.7273; train_masked_gp_l1_reg_loss: 91826.5871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89104.5374; train_chrom_access_recon_loss: 4396023.4848; train_global_loss: 19258660.3030; train_optim_loss: 19258660.3030; val_kl_reg_loss: 89553.5830; val_edge_recon_loss: 2778360.5625; val_gene_expr_recon_loss: 11730789.1250; val_masked_gp_l1_reg_loss: 92067.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88684.7109; val_chrom_access_recon_loss: 4380272.2500; val_global_loss: 19159728.2500; val_optim_loss: 19159728.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9271; val_auprc_score: 0.9017; val_best_acc_score: 0.8649; val_best_f1_score: 0.8734; train_kl_reg_loss: 86633.9875; train_edge_recon_loss: 2739244.7273; train_gene_expr_recon_loss: 11824389.9545; train_masked_gp_l1_reg_loss: 92084.4003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88527.2795; train_chrom_access_recon_loss: 4383417.0947; train_global_loss: 19214297.7273; train_optim_loss: 19214297.7273; val_kl_reg_loss: 85931.9307; val_edge_recon_loss: 2792780.6250; val_gene_expr_recon_loss: 11665747.1250; val_masked_gp_l1_reg_loss: 92206.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87936.1406; val_chrom_access_recon_loss: 4339645.7500; val_global_loss: 19064247.2500; val_optim_loss: 19064247.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9295; val_auprc_score: 0.9026; val_best_acc_score: 0.8740; val_best_f1_score: 0.8805; train_kl_reg_loss: 84538.7776; train_edge_recon_loss: 2740259.8106; train_gene_expr_recon_loss: 11788692.0303; train_masked_gp_l1_reg_loss: 92285.8749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87998.0678; train_chrom_access_recon_loss: 4368113.3864; train_global_loss: 19161887.7576; train_optim_loss: 19161887.7576; val_kl_reg_loss: 86759.0820; val_edge_recon_loss: 2771022.3438; val_gene_expr_recon_loss: 11664483.1250; val_masked_gp_l1_reg_loss: 92582.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88187.7266; val_chrom_access_recon_loss: 4397612.1875; val_global_loss: 19100647.2500; val_optim_loss: 19100647.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9333; val_auprc_score: 0.9056; val_best_acc_score: 0.8740; val_best_f1_score: 0.8809; train_kl_reg_loss: 84919.4252; train_edge_recon_loss: 2732050.6515; train_gene_expr_recon_loss: 11775911.2121; train_masked_gp_l1_reg_loss: 92473.5524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87479.5537; train_chrom_access_recon_loss: 4358978.0341; train_global_loss: 19131812.5152; train_optim_loss: 19131812.5152; val_kl_reg_loss: 82005.6016; val_edge_recon_loss: 2773508.8750; val_gene_expr_recon_loss: 11741539.8750; val_masked_gp_l1_reg_loss: 92522.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87515.6172; val_chrom_access_recon_loss: 4346192.1875; val_global_loss: 19123285.0000; val_optim_loss: 19123285.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9288; val_auprc_score: 0.9027; val_best_acc_score: 0.8718; val_best_f1_score: 0.8811; train_kl_reg_loss: 84196.5692; train_edge_recon_loss: 2731585.9356; train_gene_expr_recon_loss: 11760120.0152; train_masked_gp_l1_reg_loss: 92687.4685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87394.4234; train_chrom_access_recon_loss: 4352533.7538; train_global_loss: 19108518.0909; train_optim_loss: 19108518.0909; val_kl_reg_loss: 84383.3721; val_edge_recon_loss: 2769287.9062; val_gene_expr_recon_loss: 11650137.6250; val_masked_gp_l1_reg_loss: 92733.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87107.9766; val_chrom_access_recon_loss: 4331019.6250; val_global_loss: 19014670.5000; val_optim_loss: 19014670.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9333; val_auprc_score: 0.9026; val_best_acc_score: 0.8767; val_best_f1_score: 0.8851; train_kl_reg_loss: 84451.8688; train_edge_recon_loss: 2724489.1439; train_gene_expr_recon_loss: 11740509.1818; train_masked_gp_l1_reg_loss: 92714.1973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86899.5084; train_chrom_access_recon_loss: 4342819.6667; train_global_loss: 19071883.5758; train_optim_loss: 19071883.5758; val_kl_reg_loss: 83809.0322; val_edge_recon_loss: 2745973.1250; val_gene_expr_recon_loss: 11745448.0000; val_masked_gp_l1_reg_loss: 92755.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86667.7969; val_chrom_access_recon_loss: 4387017.5000; val_global_loss: 19141672.0000; val_optim_loss: 19141672.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9381; val_auprc_score: 0.9177; val_best_acc_score: 0.8829; val_best_f1_score: 0.8890; train_kl_reg_loss: 84662.3433; train_edge_recon_loss: 2722096.5303; train_gene_expr_recon_loss: 11719912.9545; train_masked_gp_l1_reg_loss: 92713.6038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86595.7714; train_chrom_access_recon_loss: 4329321.7841; train_global_loss: 19035302.7879; train_optim_loss: 19035302.7879; val_kl_reg_loss: 84262.8047; val_edge_recon_loss: 2769549.3750; val_gene_expr_recon_loss: 11735441.0000; val_masked_gp_l1_reg_loss: 92693.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86490.3125; val_chrom_access_recon_loss: 4370882.3438; val_global_loss: 19139319.0000; val_optim_loss: 19139319.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9395; val_auprc_score: 0.9174; val_best_acc_score: 0.8818; val_best_f1_score: 0.8868; train_kl_reg_loss: 83744.0285; train_edge_recon_loss: 2722480.1742; train_gene_expr_recon_loss: 11694916.2424; train_masked_gp_l1_reg_loss: 92695.5946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86459.3770; train_chrom_access_recon_loss: 4316915.1818; train_global_loss: 18997210.6970; train_optim_loss: 18997210.6970; val_kl_reg_loss: 83463.5742; val_edge_recon_loss: 2764155.0312; val_gene_expr_recon_loss: 11683162.3750; val_masked_gp_l1_reg_loss: 92688.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86808.9297; val_chrom_access_recon_loss: 4337672.7188; val_global_loss: 19047950.2500; val_optim_loss: 19047950.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9370; val_auprc_score: 0.9130; val_best_acc_score: 0.8780; val_best_f1_score: 0.8836; train_kl_reg_loss: 82873.4304; train_edge_recon_loss: 2728097.1629; train_gene_expr_recon_loss: 11683539.5758; train_masked_gp_l1_reg_loss: 92707.7118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86813.0848; train_chrom_access_recon_loss: 4313535.7879; train_global_loss: 18987566.6970; train_optim_loss: 18987566.6970; val_kl_reg_loss: 82727.9629; val_edge_recon_loss: 2744203.5625; val_gene_expr_recon_loss: 11551713.8750; val_masked_gp_l1_reg_loss: 92623.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87014.5547; val_chrom_access_recon_loss: 4270662.5938; val_global_loss: 18828946.7500; val_optim_loss: 18828946.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9405; val_auprc_score: 0.9222; val_best_acc_score: 0.8802; val_best_f1_score: 0.8857; train_kl_reg_loss: 82717.8249; train_edge_recon_loss: 2710736.1553; train_gene_expr_recon_loss: 11660207.8485; train_masked_gp_l1_reg_loss: 92645.7388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86954.2849; train_chrom_access_recon_loss: 4300462.6742; train_global_loss: 18933724.4545; train_optim_loss: 18933724.4545; val_kl_reg_loss: 83138.9180; val_edge_recon_loss: 2738645.7188; val_gene_expr_recon_loss: 11607657.1250; val_masked_gp_l1_reg_loss: 92644.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87294.1172; val_chrom_access_recon_loss: 4294325.6875; val_global_loss: 18903706.5000; val_optim_loss: 18903706.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9402; val_auprc_score: 0.9140; val_best_acc_score: 0.8812; val_best_f1_score: 0.8877; train_kl_reg_loss: 82491.6192; train_edge_recon_loss: 2713110.8258; train_gene_expr_recon_loss: 11644683.7424; train_masked_gp_l1_reg_loss: 92685.6463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87376.6387; train_chrom_access_recon_loss: 4292119.4356; train_global_loss: 18912467.7576; train_optim_loss: 18912467.7576; val_kl_reg_loss: 83608.7520; val_edge_recon_loss: 2755205.6562; val_gene_expr_recon_loss: 11517821.7500; val_masked_gp_l1_reg_loss: 92646.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87643.4453; val_chrom_access_recon_loss: 4317333.6875; val_global_loss: 18854258.2500; val_optim_loss: 18854258.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9471; val_auprc_score: 0.9290; val_best_acc_score: 0.8850; val_best_f1_score: 0.8906; train_kl_reg_loss: 82178.8532; train_edge_recon_loss: 2712392.8258; train_gene_expr_recon_loss: 11628549.4091; train_masked_gp_l1_reg_loss: 92589.7111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87884.7718; train_chrom_access_recon_loss: 4280367.6364; train_global_loss: 18883963.3636; train_optim_loss: 18883963.3636; val_kl_reg_loss: 81729.6641; val_edge_recon_loss: 2742120.2188; val_gene_expr_recon_loss: 11489862.6250; val_masked_gp_l1_reg_loss: 92551.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87637.3750; val_chrom_access_recon_loss: 4281554.9375; val_global_loss: 18775456.2500; val_optim_loss: 18775456.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9382; val_auprc_score: 0.9155; val_best_acc_score: 0.8810; val_best_f1_score: 0.8904; train_kl_reg_loss: 82496.1030; train_edge_recon_loss: 2711690.9242; train_gene_expr_recon_loss: 11620532.0152; train_masked_gp_l1_reg_loss: 92499.4754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88237.9053; train_chrom_access_recon_loss: 4270350.4962; train_global_loss: 18865806.9091; train_optim_loss: 18865806.9091; val_kl_reg_loss: 81509.4482; val_edge_recon_loss: 2746259.6875; val_gene_expr_recon_loss: 11625888.2500; val_masked_gp_l1_reg_loss: 92413.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88654.6484; val_chrom_access_recon_loss: 4317683.3125; val_global_loss: 18952409.2500; val_optim_loss: 18952409.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9466; val_auprc_score: 0.9296; val_best_acc_score: 0.8923; val_best_f1_score: 0.8986; train_kl_reg_loss: 81510.5814; train_edge_recon_loss: 2706947.0455; train_gene_expr_recon_loss: 11604278.0303; train_masked_gp_l1_reg_loss: 92483.3439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89090.1306; train_chrom_access_recon_loss: 4258265.1932; train_global_loss: 18832574.3939; train_optim_loss: 18832574.3939; val_kl_reg_loss: 85285.0664; val_edge_recon_loss: 2702256.6875; val_gene_expr_recon_loss: 11488688.8750; val_masked_gp_l1_reg_loss: 92402.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88817.6328; val_chrom_access_recon_loss: 4242665.3750; val_global_loss: 18700117.2500; val_optim_loss: 18700117.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9474; val_auprc_score: 0.9247; val_best_acc_score: 0.8920; val_best_f1_score: 0.8971; train_kl_reg_loss: 84145.1738; train_edge_recon_loss: 2711417.5947; train_gene_expr_recon_loss: 11592473.5455; train_masked_gp_l1_reg_loss: 92323.1136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89100.8316; train_chrom_access_recon_loss: 4253729.8295; train_global_loss: 18823190.1515; train_optim_loss: 18823190.1515; val_kl_reg_loss: 82570.5947; val_edge_recon_loss: 2742823.5000; val_gene_expr_recon_loss: 11580772.8750; val_masked_gp_l1_reg_loss: 92416.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89778.9141; val_chrom_access_recon_loss: 4270602.6250; val_global_loss: 18858965.7500; val_optim_loss: 18858965.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9403; val_auprc_score: 0.9152; val_best_acc_score: 0.8861; val_best_f1_score: 0.8916; train_kl_reg_loss: 81784.8854; train_edge_recon_loss: 2702777.0265; train_gene_expr_recon_loss: 11579893.5303; train_masked_gp_l1_reg_loss: 92238.2240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89659.1148; train_chrom_access_recon_loss: 4243400.0682; train_global_loss: 18789753.0000; train_optim_loss: 18789753.0000; val_kl_reg_loss: 80831.0078; val_edge_recon_loss: 2769914.9375; val_gene_expr_recon_loss: 11646262.0000; val_masked_gp_l1_reg_loss: 92227.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89906.1094; val_chrom_access_recon_loss: 4296423.5312; val_global_loss: 18975565.5000; val_optim_loss: 18975565.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9425; val_auprc_score: 0.9180; val_best_acc_score: 0.8880; val_best_f1_score: 0.8938; train_kl_reg_loss: 81784.4150; train_edge_recon_loss: 2712354.7121; train_gene_expr_recon_loss: 11557223.1364; train_masked_gp_l1_reg_loss: 92251.0326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89932.7164; train_chrom_access_recon_loss: 4230461.9129; train_global_loss: 18764008.0000; train_optim_loss: 18764008.0000; val_kl_reg_loss: 82238.1748; val_edge_recon_loss: 2751623.4062; val_gene_expr_recon_loss: 11492290.2500; val_masked_gp_l1_reg_loss: 92204.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89977.1562; val_chrom_access_recon_loss: 4246000.6875; val_global_loss: 18754333.7500; val_optim_loss: 18754333.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9456; val_auprc_score: 0.9220; val_best_acc_score: 0.8909; val_best_f1_score: 0.8955; train_kl_reg_loss: 80837.1545; train_edge_recon_loss: 2719325.6477; train_gene_expr_recon_loss: 11541754.3333; train_masked_gp_l1_reg_loss: 92130.3971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90029.4682; train_chrom_access_recon_loss: 4222736.1970; train_global_loss: 18746813.2727; train_optim_loss: 18746813.2727; val_kl_reg_loss: 77964.1816; val_edge_recon_loss: 2730438.0000; val_gene_expr_recon_loss: 11442515.6250; val_masked_gp_l1_reg_loss: 92173.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90633.9609; val_chrom_access_recon_loss: 4217370.1875; val_global_loss: 18651096.0000; val_optim_loss: 18651096.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9450; val_auprc_score: 0.9255; val_best_acc_score: 0.8925; val_best_f1_score: 0.8966; train_kl_reg_loss: 79885.4999; train_edge_recon_loss: 2710903.8447; train_gene_expr_recon_loss: 11538720.7576; train_masked_gp_l1_reg_loss: 92167.4966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90131.4491; train_chrom_access_recon_loss: 4210355.0152; train_global_loss: 18722164.0909; train_optim_loss: 18722164.0909; val_kl_reg_loss: 80342.1973; val_edge_recon_loss: 2743308.1562; val_gene_expr_recon_loss: 11458961.0000; val_masked_gp_l1_reg_loss: 92126.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90778.9297; val_chrom_access_recon_loss: 4289385.5625; val_global_loss: 18754902.5000; val_optim_loss: 18754902.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9517; val_auprc_score: 0.9269; val_best_acc_score: 0.8971; val_best_f1_score: 0.8998; train_kl_reg_loss: 81125.7333; train_edge_recon_loss: 2703108.9394; train_gene_expr_recon_loss: 11525538.3182; train_masked_gp_l1_reg_loss: 92135.0671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90573.4644; train_chrom_access_recon_loss: 4202188.6667; train_global_loss: 18694670.4545; train_optim_loss: 18694670.4545; val_kl_reg_loss: 83393.4658; val_edge_recon_loss: 2746587.7812; val_gene_expr_recon_loss: 11486959.6250; val_masked_gp_l1_reg_loss: 92077.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90092.3594; val_chrom_access_recon_loss: 4237465.2188; val_global_loss: 18736575.2500; val_optim_loss: 18736575.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9423; val_auprc_score: 0.9138; val_best_acc_score: 0.8888; val_best_f1_score: 0.8942; train_kl_reg_loss: 80203.0618; train_edge_recon_loss: 2704191.7689; train_gene_expr_recon_loss: 11527326.3788; train_masked_gp_l1_reg_loss: 91938.2843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90228.1065; train_chrom_access_recon_loss: 4195726.1326; train_global_loss: 18689613.6970; train_optim_loss: 18689613.6970; val_kl_reg_loss: 79536.8086; val_edge_recon_loss: 2751991.0312; val_gene_expr_recon_loss: 11408925.2500; val_masked_gp_l1_reg_loss: 92070.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91475.6641; val_chrom_access_recon_loss: 4196671.0312; val_global_loss: 18620670.5000; val_optim_loss: 18620670.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9526; val_auprc_score: 0.9295; val_best_acc_score: 0.9017; val_best_f1_score: 0.9063; train_kl_reg_loss: 80501.4538; train_edge_recon_loss: 2696530.0758; train_gene_expr_recon_loss: 11512190.2879; train_masked_gp_l1_reg_loss: 91963.9112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90996.0008; train_chrom_access_recon_loss: 4186844.7992; train_global_loss: 18659026.6061; train_optim_loss: 18659026.6061; val_kl_reg_loss: 79778.4863; val_edge_recon_loss: 2712386.7188; val_gene_expr_recon_loss: 11381977.3750; val_masked_gp_l1_reg_loss: 91795.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90610.6719; val_chrom_access_recon_loss: 4177927.7188; val_global_loss: 18534476.0000; val_optim_loss: 18534476.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9522; val_auprc_score: 0.9361; val_best_acc_score: 0.9014; val_best_f1_score: 0.9067; train_kl_reg_loss: 80366.1151; train_edge_recon_loss: 2696701.1667; train_gene_expr_recon_loss: 11496213.8030; train_masked_gp_l1_reg_loss: 91745.7612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90780.8414; train_chrom_access_recon_loss: 4177647.0000; train_global_loss: 18633454.8485; train_optim_loss: 18633454.8485; val_kl_reg_loss: 76695.1689; val_edge_recon_loss: 2708621.7188; val_gene_expr_recon_loss: 11478000.5000; val_masked_gp_l1_reg_loss: 91736.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91182.7812; val_chrom_access_recon_loss: 4219245.2500; val_global_loss: 18665481.5000; val_optim_loss: 18665481.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9448; val_auprc_score: 0.9156; val_best_acc_score: 0.8877; val_best_f1_score: 0.8951; train_kl_reg_loss: 79667.1134; train_edge_recon_loss: 2698442.4432; train_gene_expr_recon_loss: 11493203.6970; train_masked_gp_l1_reg_loss: 91631.4490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90861.4970; train_chrom_access_recon_loss: 4167471.8485; train_global_loss: 18621277.9394; train_optim_loss: 18621277.9394; val_kl_reg_loss: 78088.6816; val_edge_recon_loss: 2756393.8438; val_gene_expr_recon_loss: 11470165.1250; val_masked_gp_l1_reg_loss: 91468.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90899.9922; val_chrom_access_recon_loss: 4215320.0938; val_global_loss: 18702337.0000; val_optim_loss: 18702337.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9515; val_auprc_score: 0.9343; val_best_acc_score: 0.8960; val_best_f1_score: 0.9016; train_kl_reg_loss: 79170.5115; train_edge_recon_loss: 2704949.3144; train_gene_expr_recon_loss: 11471635.7879; train_masked_gp_l1_reg_loss: 91399.8769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90927.6095; train_chrom_access_recon_loss: 4154544.3788; train_global_loss: 18592627.4545; train_optim_loss: 18592627.4545; val_kl_reg_loss: 79501.3115; val_edge_recon_loss: 2731451.5000; val_gene_expr_recon_loss: 11489011.3750; val_masked_gp_l1_reg_loss: 91337.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90990.1641; val_chrom_access_recon_loss: 4213045.3438; val_global_loss: 18695336.7500; val_optim_loss: 18695336.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9572; val_auprc_score: 0.9390; val_best_acc_score: 0.9065; val_best_f1_score: 0.9105; train_kl_reg_loss: 79360.8047; train_edge_recon_loss: 2696689.8182; train_gene_expr_recon_loss: 11466005.0606; train_masked_gp_l1_reg_loss: 91225.5128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91035.7740; train_chrom_access_recon_loss: 4145657.7197; train_global_loss: 18569974.6970; train_optim_loss: 18569974.6970; val_kl_reg_loss: 78091.9551; val_edge_recon_loss: 2701604.7812; val_gene_expr_recon_loss: 11515207.5000; val_masked_gp_l1_reg_loss: 91210.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91045.6094; val_chrom_access_recon_loss: 4216591.3750; val_global_loss: 18693752.7500; val_optim_loss: 18693752.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9546; val_auprc_score: 0.9337; val_best_acc_score: 0.9073; val_best_f1_score: 0.9098; train_kl_reg_loss: 79421.2891; train_edge_recon_loss: 2684295.9053; train_gene_expr_recon_loss: 11457529.0455; train_masked_gp_l1_reg_loss: 90153.5756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71662.1457; train_chrom_access_recon_loss: 4132892.1023; train_global_loss: 18515953.9394; train_optim_loss: 18515953.9394; val_kl_reg_loss: 80726.4863; val_edge_recon_loss: 2725571.0625; val_gene_expr_recon_loss: 11503065.7500; val_masked_gp_l1_reg_loss: 89712.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67571.3984; val_chrom_access_recon_loss: 4205671.8750; val_global_loss: 18672318.2500; val_optim_loss: 18672318.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9519; val_auprc_score: 0.9362; val_best_acc_score: 0.8984; val_best_f1_score: 0.9022; train_kl_reg_loss: 80151.1271; train_edge_recon_loss: 2692780.7538; train_gene_expr_recon_loss: 11447155.7424; train_masked_gp_l1_reg_loss: 89622.8867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67139.5973; train_chrom_access_recon_loss: 4123646.0455; train_global_loss: 18500496.3030; train_optim_loss: 18500496.3030; val_kl_reg_loss: 81641.7568; val_edge_recon_loss: 2741682.1250; val_gene_expr_recon_loss: 11402016.8750; val_masked_gp_l1_reg_loss: 89565.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66827.6641; val_chrom_access_recon_loss: 4183930.0625; val_global_loss: 18565664.2500; val_optim_loss: 18565664.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9546; val_auprc_score: 0.9322; val_best_acc_score: 0.9065; val_best_f1_score: 0.9099; train_kl_reg_loss: 80602.1264; train_edge_recon_loss: 2699472.6591; train_gene_expr_recon_loss: 11451218.2273; train_masked_gp_l1_reg_loss: 89533.0152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66676.4906; train_chrom_access_recon_loss: 4125152.9470; train_global_loss: 18512655.4242; train_optim_loss: 18512655.4242; val_kl_reg_loss: 81653.4268; val_edge_recon_loss: 2711348.0000; val_gene_expr_recon_loss: 11458883.3750; val_masked_gp_l1_reg_loss: 89513.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66455.7422; val_chrom_access_recon_loss: 4168915.0938; val_global_loss: 18576769.0000; val_optim_loss: 18576769.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9568; val_auprc_score: 0.9357; val_best_acc_score: 0.9054; val_best_f1_score: 0.9089; train_kl_reg_loss: 81001.3318; train_edge_recon_loss: 2685383.7614; train_gene_expr_recon_loss: 11446836.3788; train_masked_gp_l1_reg_loss: 89481.3806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66322.7829; train_chrom_access_recon_loss: 4129963.6326; train_global_loss: 18498989.2424; train_optim_loss: 18498989.2424; val_kl_reg_loss: 81180.1104; val_edge_recon_loss: 2710681.6875; val_gene_expr_recon_loss: 11419051.5000; val_masked_gp_l1_reg_loss: 89467.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66165.3906; val_chrom_access_recon_loss: 4170358.1250; val_global_loss: 18536903.5000; val_optim_loss: 18536903.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 30 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9522
val AUPRC score: 0.9351
val best accuracy score: 0.8974
val best F1 score: 0.9021
val target rna MSE score: 1.2537
val source rna MSE score: 0.7635
val target atac MSE score: 0.4863
val source atac MSE score: 0.1875
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
