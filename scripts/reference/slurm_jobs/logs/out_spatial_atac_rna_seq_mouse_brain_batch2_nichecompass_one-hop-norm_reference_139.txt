[True]
Run timestamp: 07082023_214505_139.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_139']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9647; val_auprc_score: 0.9645; val_best_acc_score: 0.8813; val_best_f1_score: 0.8741; train_kl_reg_loss: 2866.6041; train_edge_recon_loss: 3466482.9444; train_gene_expr_recon_loss: 640524.9097; train_masked_gp_l1_reg_loss: 8420.0037; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 266477.1024; train_global_loss: 4384771.5556; train_optim_loss: 4384771.5556; val_kl_reg_loss: 1497.1615; val_edge_recon_loss: 4022091.7500; val_gene_expr_recon_loss: 626081.2500; val_masked_gp_l1_reg_loss: 6091.9751; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 262465.3125; val_global_loss: 4918227.5000; val_optim_loss: 4918227.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9364; val_auprc_score: 0.9235; val_best_acc_score: 0.8627; val_best_f1_score: 0.8695; train_kl_reg_loss: 1258.7868; train_edge_recon_loss: 3438443.4722; train_gene_expr_recon_loss: 623586.6736; train_masked_gp_l1_reg_loss: 4996.3863; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 265433.8160; train_global_loss: 4333719.2222; train_optim_loss: 4333719.2222; val_kl_reg_loss: 1852.3293; val_edge_recon_loss: 3356806.7500; val_gene_expr_recon_loss: 601699.7500; val_masked_gp_l1_reg_loss: 4096.8291; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 260906.0000; val_global_loss: 4225361.5000; val_optim_loss: 4225361.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9133; val_auprc_score: 0.8940; val_best_acc_score: 0.8477; val_best_f1_score: 0.8576; train_kl_reg_loss: 8540.2465; train_edge_recon_loss: 3026374.4167; train_gene_expr_recon_loss: 596961.9931; train_masked_gp_l1_reg_loss: 4027.9482; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 264553.9132; train_global_loss: 3900458.5278; train_optim_loss: 3900458.5278; val_kl_reg_loss: 24310.8887; val_edge_recon_loss: 2812112.2500; val_gene_expr_recon_loss: 587146.5000; val_masked_gp_l1_reg_loss: 3983.5161; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 259598.8281; val_global_loss: 3687152.0000; val_optim_loss: 3687152.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9241; val_auprc_score: 0.9000; val_best_acc_score: 0.8618; val_best_f1_score: 0.8707; train_kl_reg_loss: 36709.2107; train_edge_recon_loss: 2734282.8889; train_gene_expr_recon_loss: 588969.3056; train_masked_gp_l1_reg_loss: 3846.9874; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 261934.8108; train_global_loss: 3625743.2222; train_optim_loss: 3625743.2222; val_kl_reg_loss: 41968.7383; val_edge_recon_loss: 2749153.0000; val_gene_expr_recon_loss: 575112.8125; val_masked_gp_l1_reg_loss: 3757.8003; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 257590.2344; val_global_loss: 3627582.5000; val_optim_loss: 3627582.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9276; val_auprc_score: 0.9116; val_best_acc_score: 0.8604; val_best_f1_score: 0.8662; train_kl_reg_loss: 41722.3069; train_edge_recon_loss: 2721148.6944; train_gene_expr_recon_loss: 569641.2639; train_masked_gp_l1_reg_loss: 3775.3768; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 262384.8750; train_global_loss: 3598672.5556; train_optim_loss: 3598672.5556; val_kl_reg_loss: 35158.0117; val_edge_recon_loss: 2729473.0000; val_gene_expr_recon_loss: 557770.2500; val_masked_gp_l1_reg_loss: 3797.5491; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 256323.6562; val_global_loss: 3582522.5000; val_optim_loss: 3582522.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9345; val_auprc_score: 0.9169; val_best_acc_score: 0.8677; val_best_f1_score: 0.8757; train_kl_reg_loss: 34929.6801; train_edge_recon_loss: 2729642.6111; train_gene_expr_recon_loss: 557638.2083; train_masked_gp_l1_reg_loss: 3828.2764; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 260001.8351; train_global_loss: 3586040.5278; train_optim_loss: 3586040.5278; val_kl_reg_loss: 33144.0156; val_edge_recon_loss: 2748557.0000; val_gene_expr_recon_loss: 544012.2500; val_masked_gp_l1_reg_loss: 3882.3135; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 254997.4688; val_global_loss: 3584593.0000; val_optim_loss: 3584593.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9360; val_auprc_score: 0.9139; val_best_acc_score: 0.8793; val_best_f1_score: 0.8856; train_kl_reg_loss: 33391.0584; train_edge_recon_loss: 2707597.2500; train_gene_expr_recon_loss: 545059.3403; train_masked_gp_l1_reg_loss: 3957.7733; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 257821.2413; train_global_loss: 3547826.6667; train_optim_loss: 3547826.6667; val_kl_reg_loss: 31422.7969; val_edge_recon_loss: 2707607.5000; val_gene_expr_recon_loss: 541040.7500; val_masked_gp_l1_reg_loss: 4041.8528; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253915.2344; val_global_loss: 3538028.0000; val_optim_loss: 3538028.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9383; val_auprc_score: 0.9228; val_best_acc_score: 0.8760; val_best_f1_score: 0.8843; train_kl_reg_loss: 32010.7763; train_edge_recon_loss: 2714936.6111; train_gene_expr_recon_loss: 534026.5764; train_masked_gp_l1_reg_loss: 4116.4393; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 257081.2083; train_global_loss: 3542171.6389; train_optim_loss: 3542171.6389; val_kl_reg_loss: 30556.6094; val_edge_recon_loss: 2716012.5000; val_gene_expr_recon_loss: 531140.8750; val_masked_gp_l1_reg_loss: 4221.8516; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252922.1875; val_global_loss: 3534854.0000; val_optim_loss: 3534854.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9461; val_auprc_score: 0.9288; val_best_acc_score: 0.8918; val_best_f1_score: 0.8983; train_kl_reg_loss: 31743.0408; train_edge_recon_loss: 2708376.1944; train_gene_expr_recon_loss: 526712.6250; train_masked_gp_l1_reg_loss: 4297.7182; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 255054.5868; train_global_loss: 3526184.1667; train_optim_loss: 3526184.1667; val_kl_reg_loss: 31077.4609; val_edge_recon_loss: 2684383.7500; val_gene_expr_recon_loss: 517735.7500; val_masked_gp_l1_reg_loss: 4386.0068; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251799.5625; val_global_loss: 3489382.5000; val_optim_loss: 3489382.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9464; val_auprc_score: 0.9315; val_best_acc_score: 0.8910; val_best_f1_score: 0.8979; train_kl_reg_loss: 30915.0853; train_edge_recon_loss: 2706468.5278; train_gene_expr_recon_loss: 517256.4792; train_masked_gp_l1_reg_loss: 4482.2992; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 254613.0417; train_global_loss: 3513735.5000; train_optim_loss: 3513735.5000; val_kl_reg_loss: 29939.7773; val_edge_recon_loss: 2696322.5000; val_gene_expr_recon_loss: 513960.3125; val_masked_gp_l1_reg_loss: 4591.1392; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250795.5625; val_global_loss: 3495609.2500; val_optim_loss: 3495609.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9467; val_auprc_score: 0.9287; val_best_acc_score: 0.8913; val_best_f1_score: 0.8984; train_kl_reg_loss: 31062.6402; train_edge_recon_loss: 2708889.5000; train_gene_expr_recon_loss: 511350.8715; train_masked_gp_l1_reg_loss: 4662.8717; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 253641.3715; train_global_loss: 3509607.2222; train_optim_loss: 3509607.2222; val_kl_reg_loss: 28715.5742; val_edge_recon_loss: 2689762.5000; val_gene_expr_recon_loss: 504262.4688; val_masked_gp_l1_reg_loss: 4756.7192; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249597.6875; val_global_loss: 3477095.0000; val_optim_loss: 3477095.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9455; val_auprc_score: 0.9249; val_best_acc_score: 0.8903; val_best_f1_score: 0.8972; train_kl_reg_loss: 29995.3283; train_edge_recon_loss: 2693366.1944; train_gene_expr_recon_loss: 504755.0208; train_masked_gp_l1_reg_loss: 4832.7777; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 253332.9983; train_global_loss: 3486282.2778; train_optim_loss: 3486282.2778; val_kl_reg_loss: 29233.0039; val_edge_recon_loss: 2711469.0000; val_gene_expr_recon_loss: 502015.6875; val_masked_gp_l1_reg_loss: 4926.2715; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249032.1094; val_global_loss: 3496676.0000; val_optim_loss: 3496676.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9613; val_auprc_score: 0.9505; val_best_acc_score: 0.9103; val_best_f1_score: 0.9140; train_kl_reg_loss: 29194.3763; train_edge_recon_loss: 2685877.1111; train_gene_expr_recon_loss: 501235.1562; train_masked_gp_l1_reg_loss: 4998.4868; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252273.5417; train_global_loss: 3473578.6389; train_optim_loss: 3473578.6389; val_kl_reg_loss: 28833.3223; val_edge_recon_loss: 2664785.7500; val_gene_expr_recon_loss: 496605.7500; val_masked_gp_l1_reg_loss: 5084.8989; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248279.3906; val_global_loss: 3443589.2500; val_optim_loss: 3443589.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9645; val_auprc_score: 0.9521; val_best_acc_score: 0.9100; val_best_f1_score: 0.9132; train_kl_reg_loss: 30212.4039; train_edge_recon_loss: 2671908.4167; train_gene_expr_recon_loss: 495761.7118; train_masked_gp_l1_reg_loss: 5148.8706; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250704.8698; train_global_loss: 3453736.1944; train_optim_loss: 3453736.1944; val_kl_reg_loss: 28099.5586; val_edge_recon_loss: 2668000.7500; val_gene_expr_recon_loss: 493338.8750; val_masked_gp_l1_reg_loss: 5224.7065; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247616.7188; val_global_loss: 3442280.5000; val_optim_loss: 3442280.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9618; val_auprc_score: 0.9510; val_best_acc_score: 0.9097; val_best_f1_score: 0.9132; train_kl_reg_loss: 29734.7418; train_edge_recon_loss: 2668449.6389; train_gene_expr_recon_loss: 493388.8924; train_masked_gp_l1_reg_loss: 5281.8803; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250785.1146; train_global_loss: 3447640.3889; train_optim_loss: 3447640.3889; val_kl_reg_loss: 28045.4570; val_edge_recon_loss: 2662068.5000; val_gene_expr_recon_loss: 493076.9688; val_masked_gp_l1_reg_loss: 5355.2808; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247442.0469; val_global_loss: 3435988.2500; val_optim_loss: 3435988.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9675; val_auprc_score: 0.9529; val_best_acc_score: 0.9212; val_best_f1_score: 0.9243; train_kl_reg_loss: 29548.2029; train_edge_recon_loss: 2661264.8889; train_gene_expr_recon_loss: 492712.7326; train_masked_gp_l1_reg_loss: 5409.2684; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 251506.8472; train_global_loss: 3440441.8889; train_optim_loss: 3440441.8889; val_kl_reg_loss: 28341.1055; val_edge_recon_loss: 2660284.7500; val_gene_expr_recon_loss: 490404.4375; val_masked_gp_l1_reg_loss: 5468.7261; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246688.2812; val_global_loss: 3431187.2500; val_optim_loss: 3431187.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9695; val_auprc_score: 0.9616; val_best_acc_score: 0.9193; val_best_f1_score: 0.9225; train_kl_reg_loss: 29022.8247; train_edge_recon_loss: 2653967.1389; train_gene_expr_recon_loss: 487769.9167; train_masked_gp_l1_reg_loss: 5518.5361; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249038.9323; train_global_loss: 3425317.4167; train_optim_loss: 3425317.4167; val_kl_reg_loss: 27501.6914; val_edge_recon_loss: 2677486.7500; val_gene_expr_recon_loss: 488895.3750; val_masked_gp_l1_reg_loss: 5575.7539; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 246046.0469; val_global_loss: 3445505.7500; val_optim_loss: 3445505.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9687; val_auprc_score: 0.9558; val_best_acc_score: 0.9209; val_best_f1_score: 0.9237; train_kl_reg_loss: 28457.8939; train_edge_recon_loss: 2655446.2778; train_gene_expr_recon_loss: 486128.3299; train_masked_gp_l1_reg_loss: 5611.6846; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 249700.1441; train_global_loss: 3425344.3611; train_optim_loss: 3425344.3611; val_kl_reg_loss: 27034.4375; val_edge_recon_loss: 2655784.5000; val_gene_expr_recon_loss: 485112.0312; val_masked_gp_l1_reg_loss: 5658.3882; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245770.4844; val_global_loss: 3419360.0000; val_optim_loss: 3419360.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9673; val_auprc_score: 0.9544; val_best_acc_score: 0.9188; val_best_f1_score: 0.9220; train_kl_reg_loss: 28737.9881; train_edge_recon_loss: 2646118.9722; train_gene_expr_recon_loss: 481799.8611; train_masked_gp_l1_reg_loss: 5709.8264; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247817.8247; train_global_loss: 3410184.5000; train_optim_loss: 3410184.5000; val_kl_reg_loss: 29292.0039; val_edge_recon_loss: 2671058.7500; val_gene_expr_recon_loss: 479793.9375; val_masked_gp_l1_reg_loss: 5749.1460; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 245055.9062; val_global_loss: 3430950.0000; val_optim_loss: 3430950.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9708; val_auprc_score: 0.9567; val_best_acc_score: 0.9267; val_best_f1_score: 0.9296; train_kl_reg_loss: 28882.1408; train_edge_recon_loss: 2636664.4722; train_gene_expr_recon_loss: 478522.7083; train_masked_gp_l1_reg_loss: 5782.1536; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248369.5903; train_global_loss: 3398221.0278; train_optim_loss: 3398221.0278; val_kl_reg_loss: 26980.0156; val_edge_recon_loss: 2640046.2500; val_gene_expr_recon_loss: 481136.6875; val_masked_gp_l1_reg_loss: 5814.0728; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244759.3281; val_global_loss: 3398736.2500; val_optim_loss: 3398736.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9722; val_auprc_score: 0.9585; val_best_acc_score: 0.9309; val_best_f1_score: 0.9329; train_kl_reg_loss: 28823.6734; train_edge_recon_loss: 2624651.4167; train_gene_expr_recon_loss: 475731.7986; train_masked_gp_l1_reg_loss: 5853.5087; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247211.2222; train_global_loss: 3382271.5833; train_optim_loss: 3382271.5833; val_kl_reg_loss: 29436.8828; val_edge_recon_loss: 2641726.5000; val_gene_expr_recon_loss: 474134.7500; val_masked_gp_l1_reg_loss: 5892.7397; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 244372.9531; val_global_loss: 3395564.0000; val_optim_loss: 3395564.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9758; val_auprc_score: 0.9673; val_best_acc_score: 0.9376; val_best_f1_score: 0.9398; train_kl_reg_loss: 29721.5306; train_edge_recon_loss: 2642145.3889; train_gene_expr_recon_loss: 472820.5938; train_masked_gp_l1_reg_loss: 5927.7583; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246551.1944; train_global_loss: 3397166.5833; train_optim_loss: 3397166.5833; val_kl_reg_loss: 28589.6094; val_edge_recon_loss: 2632152.2500; val_gene_expr_recon_loss: 476219.3125; val_masked_gp_l1_reg_loss: 5963.4717; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243871.4844; val_global_loss: 3386796.0000; val_optim_loss: 3386796.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9753; val_auprc_score: 0.9665; val_best_acc_score: 0.9371; val_best_f1_score: 0.9394; train_kl_reg_loss: 29857.3739; train_edge_recon_loss: 2630773.1111; train_gene_expr_recon_loss: 470558.2118; train_masked_gp_l1_reg_loss: 6003.4151; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246075.3455; train_global_loss: 3383267.3889; train_optim_loss: 3383267.3889; val_kl_reg_loss: 28844.3809; val_edge_recon_loss: 2650600.0000; val_gene_expr_recon_loss: 471245.3750; val_masked_gp_l1_reg_loss: 6040.9155; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243232.8594; val_global_loss: 3399963.7500; val_optim_loss: 3399963.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9762; val_auprc_score: 0.9663; val_best_acc_score: 0.9345; val_best_f1_score: 0.9374; train_kl_reg_loss: 30133.5998; train_edge_recon_loss: 2630327.4722; train_gene_expr_recon_loss: 469495.5625; train_masked_gp_l1_reg_loss: 6063.2970; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245695.9618; train_global_loss: 3381715.9444; train_optim_loss: 3381715.9444; val_kl_reg_loss: 28512.6445; val_edge_recon_loss: 2648132.2500; val_gene_expr_recon_loss: 469186.3750; val_masked_gp_l1_reg_loss: 6086.8184; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 242702.6562; val_global_loss: 3394621.0000; val_optim_loss: 3394621.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9754; val_auprc_score: 0.9660; val_best_acc_score: 0.9348; val_best_f1_score: 0.9377; train_kl_reg_loss: 30492.1252; train_edge_recon_loss: 2625261.1667; train_gene_expr_recon_loss: 466892.5729; train_masked_gp_l1_reg_loss: 6121.6988; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245597.6250; train_global_loss: 3374365.1667; train_optim_loss: 3374365.1667; val_kl_reg_loss: 30422.3008; val_edge_recon_loss: 2646459.7500; val_gene_expr_recon_loss: 462350.1250; val_masked_gp_l1_reg_loss: 6156.6035; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241873.1875; val_global_loss: 3387261.7500; val_optim_loss: 3387261.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9799; val_auprc_score: 0.9713; val_best_acc_score: 0.9400; val_best_f1_score: 0.9424; train_kl_reg_loss: 30070.4848; train_edge_recon_loss: 2629320.4444; train_gene_expr_recon_loss: 472770.2500; train_masked_gp_l1_reg_loss: 6196.6092; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246642.2587; train_global_loss: 3385000.1111; train_optim_loss: 3385000.1111; val_kl_reg_loss: 20313.5664; val_edge_recon_loss: 2622788.7500; val_gene_expr_recon_loss: 477852.1250; val_masked_gp_l1_reg_loss: 6204.7275; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243314.1562; val_global_loss: 3370473.5000; val_optim_loss: 3370473.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9769; val_auprc_score: 0.9676; val_best_acc_score: 0.9365; val_best_f1_score: 0.9381; train_kl_reg_loss: 29381.9466; train_edge_recon_loss: 2624107.3333; train_gene_expr_recon_loss: 471881.5556; train_masked_gp_l1_reg_loss: 6213.2818; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245405.5139; train_global_loss: 3376989.6389; train_optim_loss: 3376989.6389; val_kl_reg_loss: 21406.5977; val_edge_recon_loss: 2638761.7500; val_gene_expr_recon_loss: 476737.0000; val_masked_gp_l1_reg_loss: 6223.5840; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 243460.5781; val_global_loss: 3386589.2500; val_optim_loss: 3386589.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9753; val_auprc_score: 0.9648; val_best_acc_score: 0.9395; val_best_f1_score: 0.9416; train_kl_reg_loss: 29822.8338; train_edge_recon_loss: 2615538.0556; train_gene_expr_recon_loss: 468962.4896; train_masked_gp_l1_reg_loss: 6241.8205; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245423.2465; train_global_loss: 3365988.4722; train_optim_loss: 3365988.4722; val_kl_reg_loss: 22118.1152; val_edge_recon_loss: 2647030.7500; val_gene_expr_recon_loss: 466655.5000; val_masked_gp_l1_reg_loss: 6255.6548; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241843.2656; val_global_loss: 3383903.2500; val_optim_loss: 3383903.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9797; val_auprc_score: 0.9722; val_best_acc_score: 0.9448; val_best_f1_score: 0.9460; train_kl_reg_loss: 28234.7637; train_edge_recon_loss: 2625835.0000; train_gene_expr_recon_loss: 466502.4236; train_masked_gp_l1_reg_loss: 6270.8722; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245611.4688; train_global_loss: 3372454.5278; train_optim_loss: 3372454.5278; val_kl_reg_loss: 20268.8867; val_edge_recon_loss: 2636787.5000; val_gene_expr_recon_loss: 468370.1875; val_masked_gp_l1_reg_loss: 6279.2920; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241764.4531; val_global_loss: 3373470.5000; val_optim_loss: 3373470.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9803; val_auprc_score: 0.9726; val_best_acc_score: 0.9425; val_best_f1_score: 0.9446; train_kl_reg_loss: 26433.2847; train_edge_recon_loss: 2623013.7222; train_gene_expr_recon_loss: 465680.2951; train_masked_gp_l1_reg_loss: 6292.8754; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244397.9792; train_global_loss: 3365818.1389; train_optim_loss: 3365818.1389; val_kl_reg_loss: 22252.0918; val_edge_recon_loss: 2625593.2500; val_gene_expr_recon_loss: 468930.0938; val_masked_gp_l1_reg_loss: 6306.3403; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241659.5156; val_global_loss: 3364741.0000; val_optim_loss: 3364741.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9801; val_auprc_score: 0.9718; val_best_acc_score: 0.9417; val_best_f1_score: 0.9434; train_kl_reg_loss: 28848.9909; train_edge_recon_loss: 2613551.9722; train_gene_expr_recon_loss: 465127.6076; train_masked_gp_l1_reg_loss: 6323.7115; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244845.5573; train_global_loss: 3358697.8611; train_optim_loss: 3358697.8611; val_kl_reg_loss: 22593.1367; val_edge_recon_loss: 2629199.2500; val_gene_expr_recon_loss: 464575.3438; val_masked_gp_l1_reg_loss: 6341.1968; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 241080.6406; val_global_loss: 3363789.7500; val_optim_loss: 3363789.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9828; val_auprc_score: 0.9752; val_best_acc_score: 0.9488; val_best_f1_score: 0.9501; train_kl_reg_loss: 27272.8464; train_edge_recon_loss: 2614652.5833; train_gene_expr_recon_loss: 462250.8194; train_masked_gp_l1_reg_loss: 6365.8279; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243527.1337; train_global_loss: 3354069.1944; train_optim_loss: 3354069.1944; val_kl_reg_loss: 21311.0039; val_edge_recon_loss: 2627208.5000; val_gene_expr_recon_loss: 465411.3750; val_masked_gp_l1_reg_loss: 6383.1260; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240710.0312; val_global_loss: 3361024.2500; val_optim_loss: 3361024.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9834; val_auprc_score: 0.9773; val_best_acc_score: 0.9446; val_best_f1_score: 0.9465; train_kl_reg_loss: 26713.2209; train_edge_recon_loss: 2611170.3889; train_gene_expr_recon_loss: 460915.1840; train_masked_gp_l1_reg_loss: 6405.5216; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 243551.3872; train_global_loss: 3348755.7778; train_optim_loss: 3348755.7778; val_kl_reg_loss: 23693.0234; val_edge_recon_loss: 2643266.0000; val_gene_expr_recon_loss: 459348.8438; val_masked_gp_l1_reg_loss: 6421.3325; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239726.4219; val_global_loss: 3372455.5000; val_optim_loss: 3372455.5000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9807; val_auprc_score: 0.9704; val_best_acc_score: 0.9456; val_best_f1_score: 0.9473; train_kl_reg_loss: 27787.5334; train_edge_recon_loss: 2613215.1389; train_gene_expr_recon_loss: 458251.3160; train_masked_gp_l1_reg_loss: 6442.7327; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 242474.9167; train_global_loss: 3348171.6389; train_optim_loss: 3348171.6389; val_kl_reg_loss: 23009.2031; val_edge_recon_loss: 2626257.2500; val_gene_expr_recon_loss: 458139.3750; val_masked_gp_l1_reg_loss: 6458.8618; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239736.6719; val_global_loss: 3353601.5000; val_optim_loss: 3353601.5000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9824; val_auprc_score: 0.9757; val_best_acc_score: 0.9481; val_best_f1_score: 0.9492; train_kl_reg_loss: 26629.0393; train_edge_recon_loss: 2615631.8333; train_gene_expr_recon_loss: 455071.9167; train_masked_gp_l1_reg_loss: 6477.9185; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241938.2274; train_global_loss: 3345748.8333; train_optim_loss: 3345748.8333; val_kl_reg_loss: 22124.9844; val_edge_recon_loss: 2620612.5000; val_gene_expr_recon_loss: 463569.2500; val_masked_gp_l1_reg_loss: 6488.9692; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 240051.8594; val_global_loss: 3352847.5000; val_optim_loss: 3352847.5000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9843; val_auprc_score: 0.9763; val_best_acc_score: 0.9527; val_best_f1_score: 0.9538; train_kl_reg_loss: 25590.4653; train_edge_recon_loss: 2613092.8611; train_gene_expr_recon_loss: 456284.9618; train_masked_gp_l1_reg_loss: 6502.3199; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241292.8455; train_global_loss: 3342763.4444; train_optim_loss: 3342763.4444; val_kl_reg_loss: 22140.6367; val_edge_recon_loss: 2606068.0000; val_gene_expr_recon_loss: 461607.2500; val_masked_gp_l1_reg_loss: 6514.9229; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239434.8125; val_global_loss: 3335765.7500; val_optim_loss: 3335765.7500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9844; val_auprc_score: 0.9783; val_best_acc_score: 0.9501; val_best_f1_score: 0.9515; train_kl_reg_loss: 26515.3615; train_edge_recon_loss: 2611714.5833; train_gene_expr_recon_loss: 454089.2361; train_masked_gp_l1_reg_loss: 6533.7675; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240878.8681; train_global_loss: 3339731.8056; train_optim_loss: 3339731.8056; val_kl_reg_loss: 23150.8125; val_edge_recon_loss: 2601566.2500; val_gene_expr_recon_loss: 458710.9375; val_masked_gp_l1_reg_loss: 6550.0322; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 239182.6406; val_global_loss: 3329160.7500; val_optim_loss: 3329160.7500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9808; val_auprc_score: 0.9697; val_best_acc_score: 0.9487; val_best_f1_score: 0.9502; train_kl_reg_loss: 25998.4837; train_edge_recon_loss: 2602586.6389; train_gene_expr_recon_loss: 453062.2257; train_masked_gp_l1_reg_loss: 6568.3198; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240450.4167; train_global_loss: 3328666.0833; train_optim_loss: 3328666.0833; val_kl_reg_loss: 23223.8477; val_edge_recon_loss: 2623342.0000; val_gene_expr_recon_loss: 457300.2500; val_masked_gp_l1_reg_loss: 6583.4053; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238662.0781; val_global_loss: 3349111.5000; val_optim_loss: 3349111.5000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9833; val_auprc_score: 0.9746; val_best_acc_score: 0.9528; val_best_f1_score: 0.9541; train_kl_reg_loss: 26494.3012; train_edge_recon_loss: 2601149.8056; train_gene_expr_recon_loss: 451436.1806; train_masked_gp_l1_reg_loss: 6602.5197; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241497.3681; train_global_loss: 3327180.2222; train_optim_loss: 3327180.2222; val_kl_reg_loss: 22535.8125; val_edge_recon_loss: 2621127.0000; val_gene_expr_recon_loss: 457646.2500; val_masked_gp_l1_reg_loss: 6617.0762; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238598.0000; val_global_loss: 3346524.0000; val_optim_loss: 3346524.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9854; val_auprc_score: 0.9800; val_best_acc_score: 0.9538; val_best_f1_score: 0.9553; train_kl_reg_loss: 25582.0649; train_edge_recon_loss: 2610230.2778; train_gene_expr_recon_loss: 454493.5382; train_masked_gp_l1_reg_loss: 6633.4283; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 241297.9462; train_global_loss: 3338237.2500; train_optim_loss: 3338237.2500; val_kl_reg_loss: 22426.3555; val_edge_recon_loss: 2615253.7500; val_gene_expr_recon_loss: 458111.3125; val_masked_gp_l1_reg_loss: 6651.8242; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238468.0625; val_global_loss: 3340911.0000; val_optim_loss: 3340911.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9848; val_auprc_score: 0.9789; val_best_acc_score: 0.9530; val_best_f1_score: 0.9542; train_kl_reg_loss: 24977.3672; train_edge_recon_loss: 2606781.5833; train_gene_expr_recon_loss: 450807.3333; train_masked_gp_l1_reg_loss: 6677.9119; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240249.8785; train_global_loss: 3329494.0278; train_optim_loss: 3329494.0278; val_kl_reg_loss: 22075.2812; val_edge_recon_loss: 2634876.2500; val_gene_expr_recon_loss: 457119.0000; val_masked_gp_l1_reg_loss: 6694.1484; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 238238.7031; val_global_loss: 3359003.5000; val_optim_loss: 3359003.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9841; val_auprc_score: 0.9766; val_best_acc_score: 0.9546; val_best_f1_score: 0.9560; train_kl_reg_loss: 24976.4709; train_edge_recon_loss: 2612587.3611; train_gene_expr_recon_loss: 450650.6736; train_masked_gp_l1_reg_loss: 6658.8913; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240208.6181; train_global_loss: 3335082.0000; train_optim_loss: 3335082.0000; val_kl_reg_loss: 22511.2930; val_edge_recon_loss: 2622451.7500; val_gene_expr_recon_loss: 455114.4375; val_masked_gp_l1_reg_loss: 6626.0503; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237934.9688; val_global_loss: 3344638.5000; val_optim_loss: 3344638.5000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9848; val_auprc_score: 0.9785; val_best_acc_score: 0.9551; val_best_f1_score: 0.9563; train_kl_reg_loss: 25384.1148; train_edge_recon_loss: 2599672.6667; train_gene_expr_recon_loss: 448936.0486; train_masked_gp_l1_reg_loss: 6617.4789; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239838.3420; train_global_loss: 3320448.7222; train_optim_loss: 3320448.7222; val_kl_reg_loss: 22981.9609; val_edge_recon_loss: 2608194.2500; val_gene_expr_recon_loss: 455161.7188; val_masked_gp_l1_reg_loss: 6604.6709; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237939.3281; val_global_loss: 3330882.0000; val_optim_loss: 3330882.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9832; val_auprc_score: 0.9757; val_best_acc_score: 0.9518; val_best_f1_score: 0.9532; train_kl_reg_loss: 25893.4180; train_edge_recon_loss: 2605583.0278; train_gene_expr_recon_loss: 450801.1667; train_masked_gp_l1_reg_loss: 6598.7736; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240918.9392; train_global_loss: 3329795.2500; train_optim_loss: 3329795.2500; val_kl_reg_loss: 23316.4570; val_edge_recon_loss: 2616957.5000; val_gene_expr_recon_loss: 454875.1250; val_masked_gp_l1_reg_loss: 6591.9624; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237860.9844; val_global_loss: 3339602.0000; val_optim_loss: 3339602.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9863; val_auprc_score: 0.9801; val_best_acc_score: 0.9576; val_best_f1_score: 0.9586; train_kl_reg_loss: 26049.4859; train_edge_recon_loss: 2610452.9444; train_gene_expr_recon_loss: 451201.6667; train_masked_gp_l1_reg_loss: 6588.5960; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240695.8108; train_global_loss: 3334988.4722; train_optim_loss: 3334988.4722; val_kl_reg_loss: 23162.1641; val_edge_recon_loss: 2604803.2500; val_gene_expr_recon_loss: 454607.5938; val_masked_gp_l1_reg_loss: 6584.8188; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237910.6250; val_global_loss: 3327068.5000; val_optim_loss: 3327068.5000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9872; val_auprc_score: 0.9827; val_best_acc_score: 0.9563; val_best_f1_score: 0.9575; train_kl_reg_loss: 26033.6352; train_edge_recon_loss: 2607392.7500; train_gene_expr_recon_loss: 448450.4618; train_masked_gp_l1_reg_loss: 6583.9070; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240403.1267; train_global_loss: 3328863.8611; train_optim_loss: 3328863.8611; val_kl_reg_loss: 23170.7656; val_edge_recon_loss: 2598247.5000; val_gene_expr_recon_loss: 454255.4375; val_masked_gp_l1_reg_loss: 6582.3506; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237801.6406; val_global_loss: 3320057.7500; val_optim_loss: 3320057.7500
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9828; val_auprc_score: 0.9764; val_best_acc_score: 0.9487; val_best_f1_score: 0.9504; train_kl_reg_loss: 25871.9036; train_edge_recon_loss: 2608276.6944; train_gene_expr_recon_loss: 449323.5347; train_masked_gp_l1_reg_loss: 6582.5235; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239494.2951; train_global_loss: 3329549.0000; train_optim_loss: 3329549.0000; val_kl_reg_loss: 23127.6914; val_edge_recon_loss: 2619939.7500; val_gene_expr_recon_loss: 454450.1875; val_masked_gp_l1_reg_loss: 6582.1538; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237823.5781; val_global_loss: 3341923.5000; val_optim_loss: 3341923.5000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9828; val_auprc_score: 0.9734; val_best_acc_score: 0.9507; val_best_f1_score: 0.9523; train_kl_reg_loss: 26015.3266; train_edge_recon_loss: 2596825.6944; train_gene_expr_recon_loss: 449222.1701; train_masked_gp_l1_reg_loss: 6582.2623; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240496.5590; train_global_loss: 3319141.9722; train_optim_loss: 3319141.9722; val_kl_reg_loss: 23208.3203; val_edge_recon_loss: 2630059.0000; val_gene_expr_recon_loss: 454123.6875; val_masked_gp_l1_reg_loss: 6582.1479; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237773.2500; val_global_loss: 3351746.5000; val_optim_loss: 3351746.5000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9864; val_auprc_score: 0.9806; val_best_acc_score: 0.9554; val_best_f1_score: 0.9566; train_kl_reg_loss: 25762.9071; train_edge_recon_loss: 2608277.2500; train_gene_expr_recon_loss: 448636.1354; train_masked_gp_l1_reg_loss: 6583.2312; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239881.1788; train_global_loss: 3329140.7778; train_optim_loss: 3329140.7778; val_kl_reg_loss: 22725.8086; val_edge_recon_loss: 2614705.0000; val_gene_expr_recon_loss: 454368.2812; val_masked_gp_l1_reg_loss: 6583.7280; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237772.2188; val_global_loss: 3336155.0000; val_optim_loss: 3336155.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9845; val_auprc_score: 0.9779; val_best_acc_score: 0.9528; val_best_f1_score: 0.9543; train_kl_reg_loss: 25475.0966; train_edge_recon_loss: 2604362.5000; train_gene_expr_recon_loss: 447420.3750; train_masked_gp_l1_reg_loss: 6584.8515; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240267.8750; train_global_loss: 3324110.6389; train_optim_loss: 3324110.6389; val_kl_reg_loss: 22783.2070; val_edge_recon_loss: 2615995.0000; val_gene_expr_recon_loss: 454534.7500; val_masked_gp_l1_reg_loss: 6584.9946; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237767.4375; val_global_loss: 3337665.5000; val_optim_loss: 3337665.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9872; val_auprc_score: 0.9833; val_best_acc_score: 0.9534; val_best_f1_score: 0.9548; train_kl_reg_loss: 25488.7719; train_edge_recon_loss: 2598200.7222; train_gene_expr_recon_loss: 448966.8785; train_masked_gp_l1_reg_loss: 6581.4695; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239551.2969; train_global_loss: 3318789.0833; train_optim_loss: 3318789.0833; val_kl_reg_loss: 22787.7812; val_edge_recon_loss: 2615892.5000; val_gene_expr_recon_loss: 454520.6250; val_masked_gp_l1_reg_loss: 6578.0752; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237766.3281; val_global_loss: 3337545.2500; val_optim_loss: 3337545.2500
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9856; val_auprc_score: 0.9784; val_best_acc_score: 0.9558; val_best_f1_score: 0.9570; train_kl_reg_loss: 25448.9379; train_edge_recon_loss: 2610706.4722; train_gene_expr_recon_loss: 447934.6111; train_masked_gp_l1_reg_loss: 6577.2462; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239696.8993; train_global_loss: 3330364.1667; train_optim_loss: 3330364.1667; val_kl_reg_loss: 22756.6582; val_edge_recon_loss: 2621196.5000; val_gene_expr_recon_loss: 454306.4688; val_masked_gp_l1_reg_loss: 6575.9277; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237759.1094; val_global_loss: 3342594.7500; val_optim_loss: 3342594.7500
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9853; val_auprc_score: 0.9773; val_best_acc_score: 0.9539; val_best_f1_score: 0.9553; train_kl_reg_loss: 25569.8893; train_edge_recon_loss: 2605166.6389; train_gene_expr_recon_loss: 450222.7049; train_masked_gp_l1_reg_loss: 6575.2627; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 240032.4288; train_global_loss: 3327567.0000; train_optim_loss: 3327567.0000; val_kl_reg_loss: 22819.6641; val_edge_recon_loss: 2614745.2500; val_gene_expr_recon_loss: 454140.0938; val_masked_gp_l1_reg_loss: 6574.5674; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237737.2812; val_global_loss: 3336016.7500; val_optim_loss: 3336016.7500
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9814; val_auprc_score: 0.9711; val_best_acc_score: 0.9522; val_best_f1_score: 0.9537; train_kl_reg_loss: 25485.4844; train_edge_recon_loss: 2604436.8056; train_gene_expr_recon_loss: 448079.4549; train_masked_gp_l1_reg_loss: 6574.3354; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 239872.2014; train_global_loss: 3324448.2778; train_optim_loss: 3324448.2778; val_kl_reg_loss: 22769.1055; val_edge_recon_loss: 2633807.7500; val_gene_expr_recon_loss: 454103.5312; val_masked_gp_l1_reg_loss: 6574.0034; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 237700.4688; val_global_loss: 3354954.7500; val_optim_loss: 3354954.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 11 min 13 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9843
val AUPRC score: 0.9800
val best accuracy score: 0.9534
val best F1 score: 0.9547
val target rna MSE score: 0.3577
val source rna MSE score: 0.1876
val target atac MSE score: 0.1327
val source atac MSE score: 0.0202
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
