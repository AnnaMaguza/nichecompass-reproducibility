[True]
Run timestamp: 09102023_224627_61.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_61']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7755; val_auprc_score: 0.7900; val_best_acc_score: 0.5947; val_best_f1_score: 0.7061; train_kl_reg_loss: 66015.0704; train_edge_recon_loss: 3504063.4962; train_gene_expr_recon_loss: 13472843.9160; train_masked_gp_l1_reg_loss: 51462.1884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3422794.2977; train_chrom_access_recon_loss: 6745720.9580; train_global_loss: 27262899.7405; train_optim_loss: 27262899.7405; val_kl_reg_loss: 48098.2237; val_edge_recon_loss: 4060447.4667; val_gene_expr_recon_loss: 12868535.8000; val_masked_gp_l1_reg_loss: 61220.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 531510.2500; val_chrom_access_recon_loss: 6568241.6667; val_global_loss: 24138053.4667; val_optim_loss: 24138053.4667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7668; val_auprc_score: 0.7840; val_best_acc_score: 0.6536; val_best_f1_score: 0.7244; train_kl_reg_loss: 66650.4369; train_edge_recon_loss: 3497854.5458; train_gene_expr_recon_loss: 12683140.0229; train_masked_gp_l1_reg_loss: 65127.4284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 312839.2118; train_chrom_access_recon_loss: 6513520.9580; train_global_loss: 23139132.5649; train_optim_loss: 23139132.5649; val_kl_reg_loss: 84452.4693; val_edge_recon_loss: 4054383.9667; val_gene_expr_recon_loss: 12569405.5333; val_masked_gp_l1_reg_loss: 70066.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 234798.5000; val_chrom_access_recon_loss: 6494455.1000; val_global_loss: 23507561.7333; val_optim_loss: 23507561.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8381; val_auprc_score: 0.8413; val_best_acc_score: 0.7334; val_best_f1_score: 0.7622; train_kl_reg_loss: 64082.9991; train_edge_recon_loss: 3477369.2576; train_gene_expr_recon_loss: 12491184.5878; train_masked_gp_l1_reg_loss: 70582.2520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180107.8420; train_chrom_access_recon_loss: 6437651.3397; train_global_loss: 22720978.3053; train_optim_loss: 22720978.3053; val_kl_reg_loss: 64507.1943; val_edge_recon_loss: 3900959.6500; val_gene_expr_recon_loss: 12396152.0000; val_masked_gp_l1_reg_loss: 71219.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152250.1562; val_chrom_access_recon_loss: 6426560.9667; val_global_loss: 23011649.7333; val_optim_loss: 23011649.7333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8723; val_auprc_score: 0.8647; val_best_acc_score: 0.7759; val_best_f1_score: 0.7923; train_kl_reg_loss: 58357.0262; train_edge_recon_loss: 3199415.1679; train_gene_expr_recon_loss: 12335819.1450; train_masked_gp_l1_reg_loss: 74446.5234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137003.2596; train_chrom_access_recon_loss: 6352471.8359; train_global_loss: 22157513.0534; train_optim_loss: 22157513.0534; val_kl_reg_loss: 75327.7411; val_edge_recon_loss: 2980835.3833; val_gene_expr_recon_loss: 12252014.7333; val_masked_gp_l1_reg_loss: 79221.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126025.2344; val_chrom_access_recon_loss: 6288729.0333; val_global_loss: 21802152.9333; val_optim_loss: 21802152.9333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9053; val_auprc_score: 0.8928; val_best_acc_score: 0.8222; val_best_f1_score: 0.8334; train_kl_reg_loss: 86112.4832; train_edge_recon_loss: 2897994.7023; train_gene_expr_recon_loss: 12212924.5115; train_masked_gp_l1_reg_loss: 80788.2520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119850.0302; train_chrom_access_recon_loss: 6297680.5916; train_global_loss: 21695350.6565; train_optim_loss: 21695350.6565; val_kl_reg_loss: 74843.8609; val_edge_recon_loss: 2887754.0667; val_gene_expr_recon_loss: 12185245.0667; val_masked_gp_l1_reg_loss: 81931.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118679.7266; val_chrom_access_recon_loss: 6278926.1667; val_global_loss: 21627380.9333; val_optim_loss: 21627380.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9041; val_auprc_score: 0.8872; val_best_acc_score: 0.8288; val_best_f1_score: 0.8421; train_kl_reg_loss: 86843.0574; train_edge_recon_loss: 2862327.0706; train_gene_expr_recon_loss: 12114523.5267; train_masked_gp_l1_reg_loss: 83478.9824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116057.4987; train_chrom_access_recon_loss: 6246302.8588; train_global_loss: 21509533.0534; train_optim_loss: 21509533.0534; val_kl_reg_loss: 97642.5490; val_edge_recon_loss: 2809964.1833; val_gene_expr_recon_loss: 12064517.0000; val_masked_gp_l1_reg_loss: 85027.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114760.2969; val_chrom_access_recon_loss: 6211434.0000; val_global_loss: 21383344.6667; val_optim_loss: 21383344.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9200; val_auprc_score: 0.9053; val_best_acc_score: 0.8490; val_best_f1_score: 0.8569; train_kl_reg_loss: 92514.7083; train_edge_recon_loss: 2807792.6603; train_gene_expr_recon_loss: 12017412.7252; train_masked_gp_l1_reg_loss: 86023.7284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111942.4475; train_chrom_access_recon_loss: 6203221.6450; train_global_loss: 21318907.8626; train_optim_loss: 21318907.8626; val_kl_reg_loss: 92824.5365; val_edge_recon_loss: 2790814.1000; val_gene_expr_recon_loss: 11957719.4667; val_masked_gp_l1_reg_loss: 86806.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110490.6797; val_chrom_access_recon_loss: 6175898.6000; val_global_loss: 21214554.5333; val_optim_loss: 21214554.5333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9249; val_auprc_score: 0.9097; val_best_acc_score: 0.8544; val_best_f1_score: 0.8614; train_kl_reg_loss: 90398.3903; train_edge_recon_loss: 2792422.5763; train_gene_expr_recon_loss: 11932156.7405; train_masked_gp_l1_reg_loss: 87520.4531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108486.6599; train_chrom_access_recon_loss: 6164876.4809; train_global_loss: 21175861.1756; train_optim_loss: 21175861.1756; val_kl_reg_loss: 83170.0625; val_edge_recon_loss: 2815775.6167; val_gene_expr_recon_loss: 11899084.3333; val_masked_gp_l1_reg_loss: 88333.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108011.3516; val_chrom_access_recon_loss: 6171256.0333; val_global_loss: 21165631.2000; val_optim_loss: 21165631.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9220; val_auprc_score: 0.9038; val_best_acc_score: 0.8506; val_best_f1_score: 0.8622; train_kl_reg_loss: 85414.4739; train_edge_recon_loss: 2793630.3244; train_gene_expr_recon_loss: 11857445.6794; train_masked_gp_l1_reg_loss: 89050.7164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106273.6396; train_chrom_access_recon_loss: 6125273.4008; train_global_loss: 21057088.2290; train_optim_loss: 21057088.2290; val_kl_reg_loss: 86312.4854; val_edge_recon_loss: 2807995.1500; val_gene_expr_recon_loss: 11887337.7333; val_masked_gp_l1_reg_loss: 89546.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104860.2188; val_chrom_access_recon_loss: 6132883.4000; val_global_loss: 21108934.8000; val_optim_loss: 21108934.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9294; val_auprc_score: 0.9132; val_best_acc_score: 0.8639; val_best_f1_score: 0.8733; train_kl_reg_loss: 82701.9244; train_edge_recon_loss: 2784718.3206; train_gene_expr_recon_loss: 11796790.0000; train_masked_gp_l1_reg_loss: 89963.5192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103514.1717; train_chrom_access_recon_loss: 6090901.0573; train_global_loss: 20948589.0229; train_optim_loss: 20948589.0229; val_kl_reg_loss: 80018.2292; val_edge_recon_loss: 2789013.6833; val_gene_expr_recon_loss: 11789377.7333; val_masked_gp_l1_reg_loss: 90485.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101941.6484; val_chrom_access_recon_loss: 6075524.8000; val_global_loss: 20926361.4667; val_optim_loss: 20926361.4667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9364; val_auprc_score: 0.9246; val_best_acc_score: 0.8669; val_best_f1_score: 0.8749; train_kl_reg_loss: 81923.9589; train_edge_recon_loss: 2772305.2615; train_gene_expr_recon_loss: 11739112.7328; train_masked_gp_l1_reg_loss: 90772.9560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100300.6557; train_chrom_access_recon_loss: 6061529.7405; train_global_loss: 20845945.3282; train_optim_loss: 20845945.3282; val_kl_reg_loss: 78938.6026; val_edge_recon_loss: 2765727.1000; val_gene_expr_recon_loss: 11732277.0667; val_masked_gp_l1_reg_loss: 91248.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99792.5547; val_chrom_access_recon_loss: 6038007.2333; val_global_loss: 20805991.0667; val_optim_loss: 20805991.0667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9399; val_auprc_score: 0.9259; val_best_acc_score: 0.8712; val_best_f1_score: 0.8807; train_kl_reg_loss: 81346.8304; train_edge_recon_loss: 2758323.5248; train_gene_expr_recon_loss: 11684405.9160; train_masked_gp_l1_reg_loss: 91215.7416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98097.2842; train_chrom_access_recon_loss: 6032687.6374; train_global_loss: 20746076.9008; train_optim_loss: 20746076.9008; val_kl_reg_loss: 80746.2417; val_edge_recon_loss: 2759965.0667; val_gene_expr_recon_loss: 11686439.0667; val_masked_gp_l1_reg_loss: 91253.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97423.0234; val_chrom_access_recon_loss: 6017754.6667; val_global_loss: 20733582.0000; val_optim_loss: 20733582.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9403; val_auprc_score: 0.9239; val_best_acc_score: 0.8743; val_best_f1_score: 0.8810; train_kl_reg_loss: 79193.4294; train_edge_recon_loss: 2739354.7271; train_gene_expr_recon_loss: 11657661.2290; train_masked_gp_l1_reg_loss: 91549.0232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96286.7539; train_chrom_access_recon_loss: 6018830.0992; train_global_loss: 20682875.2366; train_optim_loss: 20682875.2366; val_kl_reg_loss: 81039.1510; val_edge_recon_loss: 2769454.3000; val_gene_expr_recon_loss: 11595926.8000; val_masked_gp_l1_reg_loss: 91761.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95852.3672; val_chrom_access_recon_loss: 5971493.0333; val_global_loss: 20605526.4000; val_optim_loss: 20605526.4000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9477; val_auprc_score: 0.9375; val_best_acc_score: 0.8829; val_best_f1_score: 0.8881; train_kl_reg_loss: 79175.6446; train_edge_recon_loss: 2743283.2691; train_gene_expr_recon_loss: 11617881.9924; train_masked_gp_l1_reg_loss: 91536.4964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94562.2480; train_chrom_access_recon_loss: 5994027.3130; train_global_loss: 20620467.0076; train_optim_loss: 20620467.0076; val_kl_reg_loss: 78303.2630; val_edge_recon_loss: 2727968.3667; val_gene_expr_recon_loss: 11607258.2667; val_masked_gp_l1_reg_loss: 91609.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93790.7031; val_chrom_access_recon_loss: 5970248.3667; val_global_loss: 20569179.3333; val_optim_loss: 20569179.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9493; val_auprc_score: 0.9369; val_best_acc_score: 0.8837; val_best_f1_score: 0.8892; train_kl_reg_loss: 78803.2751; train_edge_recon_loss: 2734128.2252; train_gene_expr_recon_loss: 11584555.1145; train_masked_gp_l1_reg_loss: 91493.5366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93305.9647; train_chrom_access_recon_loss: 5968881.3092; train_global_loss: 20551167.3893; train_optim_loss: 20551167.3893; val_kl_reg_loss: 79399.8255; val_edge_recon_loss: 2756372.1000; val_gene_expr_recon_loss: 11601060.1333; val_masked_gp_l1_reg_loss: 91303.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93163.3906; val_chrom_access_recon_loss: 5975203.4000; val_global_loss: 20596501.6000; val_optim_loss: 20596501.6000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9485; val_auprc_score: 0.9333; val_best_acc_score: 0.8888; val_best_f1_score: 0.8944; train_kl_reg_loss: 77588.3709; train_edge_recon_loss: 2733454.2309; train_gene_expr_recon_loss: 11541927.2977; train_masked_gp_l1_reg_loss: 91234.7832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92255.4865; train_chrom_access_recon_loss: 5954933.1756; train_global_loss: 20491393.4351; train_optim_loss: 20491393.4351; val_kl_reg_loss: 78447.1104; val_edge_recon_loss: 2732574.9333; val_gene_expr_recon_loss: 11498634.0000; val_masked_gp_l1_reg_loss: 91143.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92253.4453; val_chrom_access_recon_loss: 5926714.1667; val_global_loss: 20419766.9333; val_optim_loss: 20419766.9333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9483; val_auprc_score: 0.9339; val_best_acc_score: 0.8872; val_best_f1_score: 0.8939; train_kl_reg_loss: 76778.2068; train_edge_recon_loss: 2725558.7481; train_gene_expr_recon_loss: 11512003.0076; train_masked_gp_l1_reg_loss: 90944.4901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91362.6012; train_chrom_access_recon_loss: 5929625.1183; train_global_loss: 20426272.2290; train_optim_loss: 20426272.2290; val_kl_reg_loss: 76499.9438; val_edge_recon_loss: 2741091.1667; val_gene_expr_recon_loss: 11484900.9333; val_masked_gp_l1_reg_loss: 90780.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91025.8281; val_chrom_access_recon_loss: 5920022.6000; val_global_loss: 20404321.8667; val_optim_loss: 20404321.8667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9509; val_auprc_score: 0.9372; val_best_acc_score: 0.8909; val_best_f1_score: 0.8968; train_kl_reg_loss: 76316.1316; train_edge_recon_loss: 2714401.7519; train_gene_expr_recon_loss: 11487292.8855; train_masked_gp_l1_reg_loss: 90693.2498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90889.6055; train_chrom_access_recon_loss: 5915959.0420; train_global_loss: 20375552.5649; train_optim_loss: 20375552.5649; val_kl_reg_loss: 75464.5021; val_edge_recon_loss: 2725279.6000; val_gene_expr_recon_loss: 11442795.7333; val_masked_gp_l1_reg_loss: 90692.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91314.5547; val_chrom_access_recon_loss: 5918874.9000; val_global_loss: 20344421.6000; val_optim_loss: 20344421.6000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9505; val_auprc_score: 0.9372; val_best_acc_score: 0.8882; val_best_f1_score: 0.8950; train_kl_reg_loss: 76551.7948; train_edge_recon_loss: 2715987.3683; train_gene_expr_recon_loss: 11460424.6794; train_masked_gp_l1_reg_loss: 90352.9145; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90413.9167; train_chrom_access_recon_loss: 5895628.1832; train_global_loss: 20329358.7481; train_optim_loss: 20329358.7481; val_kl_reg_loss: 75682.2484; val_edge_recon_loss: 2720469.8833; val_gene_expr_recon_loss: 11476824.7333; val_masked_gp_l1_reg_loss: 90051.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89889.8906; val_chrom_access_recon_loss: 5901013.3000; val_global_loss: 20353932.1333; val_optim_loss: 20353932.1333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9559; val_auprc_score: 0.9430; val_best_acc_score: 0.8964; val_best_f1_score: 0.9021; train_kl_reg_loss: 74822.4302; train_edge_recon_loss: 2713119.4084; train_gene_expr_recon_loss: 11448183.8931; train_masked_gp_l1_reg_loss: 89879.2381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89940.8377; train_chrom_access_recon_loss: 5886289.5305; train_global_loss: 20302235.3893; train_optim_loss: 20302235.3893; val_kl_reg_loss: 74635.8750; val_edge_recon_loss: 2723485.4667; val_gene_expr_recon_loss: 11438688.8667; val_masked_gp_l1_reg_loss: 89783.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90125.0156; val_chrom_access_recon_loss: 5878149.7667; val_global_loss: 20294868.9333; val_optim_loss: 20294868.9333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9563; val_auprc_score: 0.9425; val_best_acc_score: 0.8972; val_best_f1_score: 0.9008; train_kl_reg_loss: 75261.9240; train_edge_recon_loss: 2708701.2901; train_gene_expr_recon_loss: 11421109.4580; train_masked_gp_l1_reg_loss: 89483.0218; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89631.0193; train_chrom_access_recon_loss: 5872824.5000; train_global_loss: 20257011.2214; train_optim_loss: 20257011.2214; val_kl_reg_loss: 77374.2161; val_edge_recon_loss: 2699357.7833; val_gene_expr_recon_loss: 11400839.7333; val_masked_gp_l1_reg_loss: 89403.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89565.5234; val_chrom_access_recon_loss: 5867614.6000; val_global_loss: 20224156.4000; val_optim_loss: 20224156.4000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9547; val_auprc_score: 0.9415; val_best_acc_score: 0.8953; val_best_f1_score: 0.8982; train_kl_reg_loss: 75334.4873; train_edge_recon_loss: 2705736.3626; train_gene_expr_recon_loss: 11413611.7863; train_masked_gp_l1_reg_loss: 88923.4123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89591.2657; train_chrom_access_recon_loss: 5867778.5573; train_global_loss: 20240975.7863; train_optim_loss: 20240975.7863; val_kl_reg_loss: 75316.5885; val_edge_recon_loss: 2731085.2500; val_gene_expr_recon_loss: 11413000.3333; val_masked_gp_l1_reg_loss: 88631.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90200.4922; val_chrom_access_recon_loss: 5846082.9000; val_global_loss: 20244317.4667; val_optim_loss: 20244317.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9622; val_auprc_score: 0.9513; val_best_acc_score: 0.9062; val_best_f1_score: 0.9096; train_kl_reg_loss: 74244.1804; train_edge_recon_loss: 2708013.1355; train_gene_expr_recon_loss: 11392317.7328; train_masked_gp_l1_reg_loss: 88492.2551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90121.4576; train_chrom_access_recon_loss: 5853409.1450; train_global_loss: 20206598.0000; train_optim_loss: 20206598.0000; val_kl_reg_loss: 74168.7698; val_edge_recon_loss: 2709397.3167; val_gene_expr_recon_loss: 11385038.5333; val_masked_gp_l1_reg_loss: 88470.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91085.4844; val_chrom_access_recon_loss: 5863092.0333; val_global_loss: 20211252.6667; val_optim_loss: 20211252.6667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9656; val_auprc_score: 0.9565; val_best_acc_score: 0.9078; val_best_f1_score: 0.9118; train_kl_reg_loss: 74481.3182; train_edge_recon_loss: 2696957.9065; train_gene_expr_recon_loss: 11356306.7634; train_masked_gp_l1_reg_loss: 88273.2968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91179.8781; train_chrom_access_recon_loss: 5826309.3321; train_global_loss: 20133508.5344; train_optim_loss: 20133508.5344; val_kl_reg_loss: 75151.8344; val_edge_recon_loss: 2700376.8667; val_gene_expr_recon_loss: 11365227.6667; val_masked_gp_l1_reg_loss: 88112.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91722.9219; val_chrom_access_recon_loss: 5847956.7667; val_global_loss: 20168548.8000; val_optim_loss: 20168548.8000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9635; val_auprc_score: 0.9534; val_best_acc_score: 0.9081; val_best_f1_score: 0.9131; train_kl_reg_loss: 74149.1693; train_edge_recon_loss: 2694640.7824; train_gene_expr_recon_loss: 11358188.2901; train_masked_gp_l1_reg_loss: 87916.9493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92177.3633; train_chrom_access_recon_loss: 5824857.4885; train_global_loss: 20131929.9542; train_optim_loss: 20131929.9542; val_kl_reg_loss: 72927.0594; val_edge_recon_loss: 2710657.2333; val_gene_expr_recon_loss: 11337787.6000; val_masked_gp_l1_reg_loss: 87738.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92070.3438; val_chrom_access_recon_loss: 5821124.5667; val_global_loss: 20122304.2667; val_optim_loss: 20122304.2667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9569; val_auprc_score: 0.9475; val_best_acc_score: 0.8987; val_best_f1_score: 0.9019; train_kl_reg_loss: 97227.3602; train_edge_recon_loss: 2803027.9256; train_gene_expr_recon_loss: 10086998.6870; train_masked_gp_l1_reg_loss: 86875.5171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89431.7761; train_chrom_access_recon_loss: 5221347.2901; train_global_loss: 18384908.5191; train_optim_loss: 18384908.5191; val_kl_reg_loss: 23687.8932; val_edge_recon_loss: 2736201.5500; val_gene_expr_recon_loss: 10039440.6000; val_masked_gp_l1_reg_loss: 85094.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89564.8984; val_chrom_access_recon_loss: 5188253.7667; val_global_loss: 18162243.8667; val_optim_loss: 18162243.8667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9567; val_auprc_score: 0.9466; val_best_acc_score: 0.8964; val_best_f1_score: 0.9011; train_kl_reg_loss: 71039.4521; train_edge_recon_loss: 2724008.6966; train_gene_expr_recon_loss: 10045690.1374; train_masked_gp_l1_reg_loss: 83196.1621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89935.2189; train_chrom_access_recon_loss: 5195654.8321; train_global_loss: 18209524.6412; train_optim_loss: 18209524.6412; val_kl_reg_loss: 29061.1776; val_edge_recon_loss: 2728807.8833; val_gene_expr_recon_loss: 10048577.4000; val_masked_gp_l1_reg_loss: 81058.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90124.5703; val_chrom_access_recon_loss: 5188615.1667; val_global_loss: 18166245.8667; val_optim_loss: 18166245.8667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9570; val_auprc_score: 0.9441; val_best_acc_score: 0.8998; val_best_f1_score: 0.9034; train_kl_reg_loss: 58989.2739; train_edge_recon_loss: 2707899.9962; train_gene_expr_recon_loss: 10028754.5038; train_masked_gp_l1_reg_loss: 79052.6826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90241.3065; train_chrom_access_recon_loss: 5182930.1718; train_global_loss: 18147868.0305; train_optim_loss: 18147868.0305; val_kl_reg_loss: 34316.9467; val_edge_recon_loss: 2714798.1500; val_gene_expr_recon_loss: 10020670.1333; val_masked_gp_l1_reg_loss: 76938.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90128.5703; val_chrom_access_recon_loss: 5173749.3000; val_global_loss: 18110602.4000; val_optim_loss: 18110602.4000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9644; val_auprc_score: 0.9540; val_best_acc_score: 0.9093; val_best_f1_score: 0.9137; train_kl_reg_loss: 53703.4308; train_edge_recon_loss: 2703771.4561; train_gene_expr_recon_loss: 10018687.2366; train_masked_gp_l1_reg_loss: 75277.9466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90182.7996; train_chrom_access_recon_loss: 5182702.6412; train_global_loss: 18124325.3740; train_optim_loss: 18124325.3740; val_kl_reg_loss: 37425.8297; val_edge_recon_loss: 2681180.5833; val_gene_expr_recon_loss: 10032452.8000; val_masked_gp_l1_reg_loss: 73552.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90116.8828; val_chrom_access_recon_loss: 5163312.0667; val_global_loss: 18078041.3333; val_optim_loss: 18078041.3333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9630; val_auprc_score: 0.9526; val_best_acc_score: 0.9081; val_best_f1_score: 0.9116; train_kl_reg_loss: 53448.1710; train_edge_recon_loss: 2689622.3893; train_gene_expr_recon_loss: 10006834.4504; train_masked_gp_l1_reg_loss: 72160.8522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89757.8983; train_chrom_access_recon_loss: 5175823.3664; train_global_loss: 18087647.1145; train_optim_loss: 18087647.1145; val_kl_reg_loss: 39401.7810; val_edge_recon_loss: 2702591.6667; val_gene_expr_recon_loss: 9983738.8000; val_masked_gp_l1_reg_loss: 70703.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89359.1953; val_chrom_access_recon_loss: 5173504.1333; val_global_loss: 18059298.6000; val_optim_loss: 18059298.6000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9584; val_auprc_score: 0.9445; val_best_acc_score: 0.9027; val_best_f1_score: 0.9081; train_kl_reg_loss: 51292.2928; train_edge_recon_loss: 2698849.6317; train_gene_expr_recon_loss: 9971678.0153; train_masked_gp_l1_reg_loss: 69761.3789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89532.2532; train_chrom_access_recon_loss: 5161724.2328; train_global_loss: 18042837.8015; train_optim_loss: 18042837.8015; val_kl_reg_loss: 39445.7195; val_edge_recon_loss: 2723572.0833; val_gene_expr_recon_loss: 9958292.1333; val_masked_gp_l1_reg_loss: 68844.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88922.1797; val_chrom_access_recon_loss: 5125217.1667; val_global_loss: 18004294.1333; val_optim_loss: 18004294.1333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9658; val_auprc_score: 0.9565; val_best_acc_score: 0.9119; val_best_f1_score: 0.9152; train_kl_reg_loss: 52514.8498; train_edge_recon_loss: 2681214.8034; train_gene_expr_recon_loss: 9971539.1985; train_masked_gp_l1_reg_loss: 68022.3654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89164.3999; train_chrom_access_recon_loss: 5157720.7252; train_global_loss: 18020176.3817; train_optim_loss: 18020176.3817; val_kl_reg_loss: 42098.4682; val_edge_recon_loss: 2683532.9333; val_gene_expr_recon_loss: 9930006.2667; val_masked_gp_l1_reg_loss: 67125.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89150.9453; val_chrom_access_recon_loss: 5148545.1000; val_global_loss: 17960458.8000; val_optim_loss: 17960458.8000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9653; val_auprc_score: 0.9562; val_best_acc_score: 0.9136; val_best_f1_score: 0.9172; train_kl_reg_loss: 53837.5173; train_edge_recon_loss: 2684420.9218; train_gene_expr_recon_loss: 9943596.0763; train_masked_gp_l1_reg_loss: 66361.1366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88968.2484; train_chrom_access_recon_loss: 5146130.4809; train_global_loss: 17983314.3511; train_optim_loss: 17983314.3511; val_kl_reg_loss: 42320.6674; val_edge_recon_loss: 2690857.5500; val_gene_expr_recon_loss: 9919006.0667; val_masked_gp_l1_reg_loss: 65714.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88850.1719; val_chrom_access_recon_loss: 5135942.4000; val_global_loss: 17942691.8667; val_optim_loss: 17942691.8667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9664; val_auprc_score: 0.9567; val_best_acc_score: 0.9153; val_best_f1_score: 0.9174; train_kl_reg_loss: 51908.6791; train_edge_recon_loss: 2678204.8015; train_gene_expr_recon_loss: 9923835.0153; train_masked_gp_l1_reg_loss: 65084.4083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88402.5109; train_chrom_access_recon_loss: 5134265.1603; train_global_loss: 17941700.5191; train_optim_loss: 17941700.5191; val_kl_reg_loss: 45065.7979; val_edge_recon_loss: 2677504.8167; val_gene_expr_recon_loss: 9898664.5333; val_masked_gp_l1_reg_loss: 64575.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88392.8125; val_chrom_access_recon_loss: 5126100.9000; val_global_loss: 17900304.0000; val_optim_loss: 17900304.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9651; val_auprc_score: 0.9523; val_best_acc_score: 0.9148; val_best_f1_score: 0.9176; train_kl_reg_loss: 52821.4653; train_edge_recon_loss: 2674224.0954; train_gene_expr_recon_loss: 9905165.2595; train_masked_gp_l1_reg_loss: 63907.8165; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88116.1400; train_chrom_access_recon_loss: 5128953.1756; train_global_loss: 17913187.9084; train_optim_loss: 17913187.9084; val_kl_reg_loss: 43065.7492; val_edge_recon_loss: 2688171.2333; val_gene_expr_recon_loss: 9887232.1333; val_masked_gp_l1_reg_loss: 63347.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88420.9766; val_chrom_access_recon_loss: 5121590.6333; val_global_loss: 17891827.8667; val_optim_loss: 17891827.8667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9653; val_auprc_score: 0.9530; val_best_acc_score: 0.9134; val_best_f1_score: 0.9174; train_kl_reg_loss: 51487.9860; train_edge_recon_loss: 2677308.4542; train_gene_expr_recon_loss: 9891900.1145; train_masked_gp_l1_reg_loss: 62929.2118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87950.9013; train_chrom_access_recon_loss: 5120640.2824; train_global_loss: 17892216.9313; train_optim_loss: 17892216.9313; val_kl_reg_loss: 43617.2203; val_edge_recon_loss: 2698583.2500; val_gene_expr_recon_loss: 9890475.9333; val_masked_gp_l1_reg_loss: 62424.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87811.6641; val_chrom_access_recon_loss: 5099573.6667; val_global_loss: 17882486.4000; val_optim_loss: 17882486.4000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9713; val_auprc_score: 0.9625; val_best_acc_score: 0.9236; val_best_f1_score: 0.9266; train_kl_reg_loss: 50460.2592; train_edge_recon_loss: 2675476.9198; train_gene_expr_recon_loss: 9881501.7481; train_masked_gp_l1_reg_loss: 62217.5694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87775.3937; train_chrom_access_recon_loss: 5111493.7710; train_global_loss: 17868925.7176; train_optim_loss: 17868925.7176; val_kl_reg_loss: 44757.0664; val_edge_recon_loss: 2669572.5333; val_gene_expr_recon_loss: 9889111.8000; val_masked_gp_l1_reg_loss: 61802.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87958.8203; val_chrom_access_recon_loss: 5108646.8000; val_global_loss: 17861849.4667; val_optim_loss: 17861849.4667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9669; val_auprc_score: 0.9567; val_best_acc_score: 0.9153; val_best_f1_score: 0.9180; train_kl_reg_loss: 50795.5974; train_edge_recon_loss: 2669524.7710; train_gene_expr_recon_loss: 9865765.5802; train_masked_gp_l1_reg_loss: 61493.6260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87749.2077; train_chrom_access_recon_loss: 5107275.7901; train_global_loss: 17842604.5954; train_optim_loss: 17842604.5954; val_kl_reg_loss: 46507.5208; val_edge_recon_loss: 2698247.9667; val_gene_expr_recon_loss: 9853739.5333; val_masked_gp_l1_reg_loss: 61124.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87079.4531; val_chrom_access_recon_loss: 5101572.9667; val_global_loss: 17848271.6000; val_optim_loss: 17848271.6000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9672; val_auprc_score: 0.9559; val_best_acc_score: 0.9163; val_best_f1_score: 0.9191; train_kl_reg_loss: 50728.7993; train_edge_recon_loss: 2673086.4752; train_gene_expr_recon_loss: 9842548.6641; train_masked_gp_l1_reg_loss: 60731.5682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87392.6150; train_chrom_access_recon_loss: 5092188.5420; train_global_loss: 17806676.6641; train_optim_loss: 17806676.6641; val_kl_reg_loss: 47635.0695; val_edge_recon_loss: 2689365.0833; val_gene_expr_recon_loss: 9809566.3333; val_masked_gp_l1_reg_loss: 60379.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87393.2656; val_chrom_access_recon_loss: 5065211.3000; val_global_loss: 17759550.6667; val_optim_loss: 17759550.6667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9723; val_auprc_score: 0.9639; val_best_acc_score: 0.9245; val_best_f1_score: 0.9268; train_kl_reg_loss: 50952.3773; train_edge_recon_loss: 2670165.5534; train_gene_expr_recon_loss: 9841907.5191; train_masked_gp_l1_reg_loss: 59888.8307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87221.9140; train_chrom_access_recon_loss: 5086205.8664; train_global_loss: 17796341.9466; train_optim_loss: 17796341.9466; val_kl_reg_loss: 48180.6042; val_edge_recon_loss: 2666028.9333; val_gene_expr_recon_loss: 9822413.7333; val_masked_gp_l1_reg_loss: 59504.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87979.4141; val_chrom_access_recon_loss: 5085649.0000; val_global_loss: 17769756.4000; val_optim_loss: 17769756.4000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9718; val_auprc_score: 0.9626; val_best_acc_score: 0.9210; val_best_f1_score: 0.9234; train_kl_reg_loss: 50966.5898; train_edge_recon_loss: 2668737.6737; train_gene_expr_recon_loss: 9830168.4198; train_masked_gp_l1_reg_loss: 59168.6415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87309.3274; train_chrom_access_recon_loss: 5081119.1947; train_global_loss: 17777469.9237; train_optim_loss: 17777469.9237; val_kl_reg_loss: 48763.6393; val_edge_recon_loss: 2674349.5667; val_gene_expr_recon_loss: 9822935.1333; val_masked_gp_l1_reg_loss: 58786.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86779.5078; val_chrom_access_recon_loss: 5054468.5667; val_global_loss: 17746083.2000; val_optim_loss: 17746083.2000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9708; val_auprc_score: 0.9627; val_best_acc_score: 0.9221; val_best_f1_score: 0.9251; train_kl_reg_loss: 50925.6574; train_edge_recon_loss: 2667469.6489; train_gene_expr_recon_loss: 9820038.9313; train_masked_gp_l1_reg_loss: 58544.2142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87046.3548; train_chrom_access_recon_loss: 5075106.1908; train_global_loss: 17759130.9771; train_optim_loss: 17759130.9771; val_kl_reg_loss: 46459.1753; val_edge_recon_loss: 2671210.1167; val_gene_expr_recon_loss: 9794472.9333; val_masked_gp_l1_reg_loss: 58510.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87816.8203; val_chrom_access_recon_loss: 5066290.8000; val_global_loss: 17724760.0000; val_optim_loss: 17724760.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9706; val_auprc_score: 0.9606; val_best_acc_score: 0.9258; val_best_f1_score: 0.9289; train_kl_reg_loss: 51209.9973; train_edge_recon_loss: 2673206.2214; train_gene_expr_recon_loss: 9812361.1069; train_masked_gp_l1_reg_loss: 58235.6633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87071.0290; train_chrom_access_recon_loss: 5073717.7481; train_global_loss: 17755801.6947; train_optim_loss: 17755801.6947; val_kl_reg_loss: 45837.9969; val_edge_recon_loss: 2677106.7500; val_gene_expr_recon_loss: 9820618.0000; val_masked_gp_l1_reg_loss: 57971.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87146.7891; val_chrom_access_recon_loss: 5080706.5000; val_global_loss: 17769387.0667; val_optim_loss: 17769387.0667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9666; val_auprc_score: 0.9543; val_best_acc_score: 0.9200; val_best_f1_score: 0.9236; train_kl_reg_loss: 50051.6510; train_edge_recon_loss: 2674730.6737; train_gene_expr_recon_loss: 9810936.4504; train_masked_gp_l1_reg_loss: 57945.9316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87055.6641; train_chrom_access_recon_loss: 5072248.5496; train_global_loss: 17752968.8321; train_optim_loss: 17752968.8321; val_kl_reg_loss: 45173.8995; val_edge_recon_loss: 2672385.8667; val_gene_expr_recon_loss: 9826555.1333; val_masked_gp_l1_reg_loss: 57915.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87065.3281; val_chrom_access_recon_loss: 5093577.4000; val_global_loss: 17782673.2000; val_optim_loss: 17782673.2000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9739; val_auprc_score: 0.9652; val_best_acc_score: 0.9263; val_best_f1_score: 0.9295; train_kl_reg_loss: 50339.9504; train_edge_recon_loss: 2665397.4408; train_gene_expr_recon_loss: 9791935.1603; train_masked_gp_l1_reg_loss: 57716.7849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87200.3871; train_chrom_access_recon_loss: 5074404.2824; train_global_loss: 17726993.8931; train_optim_loss: 17726993.8931; val_kl_reg_loss: 46688.2143; val_edge_recon_loss: 2667126.7000; val_gene_expr_recon_loss: 9776292.4667; val_masked_gp_l1_reg_loss: 57594.7852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87298.0781; val_chrom_access_recon_loss: 5052571.6000; val_global_loss: 17687571.9333; val_optim_loss: 17687571.9333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9698; val_auprc_score: 0.9575; val_best_acc_score: 0.9224; val_best_f1_score: 0.9253; train_kl_reg_loss: 50326.7861; train_edge_recon_loss: 2668755.0229; train_gene_expr_recon_loss: 9770100.6107; train_masked_gp_l1_reg_loss: 57339.5539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87022.3799; train_chrom_access_recon_loss: 5064242.2137; train_global_loss: 17697786.6107; train_optim_loss: 17697786.6107; val_kl_reg_loss: 48709.9026; val_edge_recon_loss: 2689160.1500; val_gene_expr_recon_loss: 9785903.0667; val_masked_gp_l1_reg_loss: 57085.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87206.2344; val_chrom_access_recon_loss: 5057459.9000; val_global_loss: 17725525.0667; val_optim_loss: 17725525.0667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9694; val_auprc_score: 0.9571; val_best_acc_score: 0.9212; val_best_f1_score: 0.9249; train_kl_reg_loss: 50933.3852; train_edge_recon_loss: 2663595.0229; train_gene_expr_recon_loss: 9772062.5038; train_masked_gp_l1_reg_loss: 56840.9266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87086.2288; train_chrom_access_recon_loss: 5062411.5649; train_global_loss: 17692929.6183; train_optim_loss: 17692929.6183; val_kl_reg_loss: 46052.2664; val_edge_recon_loss: 2685809.6667; val_gene_expr_recon_loss: 9754593.5333; val_masked_gp_l1_reg_loss: 56643.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87146.1641; val_chrom_access_recon_loss: 5037485.9000; val_global_loss: 17667731.7333; val_optim_loss: 17667731.7333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9751; val_auprc_score: 0.9682; val_best_acc_score: 0.9286; val_best_f1_score: 0.9313; train_kl_reg_loss: 50137.9768; train_edge_recon_loss: 2663088.4790; train_gene_expr_recon_loss: 9768813.7328; train_masked_gp_l1_reg_loss: 56537.5634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87097.0515; train_chrom_access_recon_loss: 5061796.2290; train_global_loss: 17687471.0153; train_optim_loss: 17687471.0153; val_kl_reg_loss: 46620.8784; val_edge_recon_loss: 2658147.2667; val_gene_expr_recon_loss: 9772036.0000; val_masked_gp_l1_reg_loss: 56418.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87219.0703; val_chrom_access_recon_loss: 5078755.3000; val_global_loss: 17699197.2000; val_optim_loss: 17699197.2000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9686; val_auprc_score: 0.9563; val_best_acc_score: 0.9201; val_best_f1_score: 0.9241; train_kl_reg_loss: 49058.7251; train_edge_recon_loss: 2663755.9389; train_gene_expr_recon_loss: 9760402.6107; train_masked_gp_l1_reg_loss: 56201.5130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87015.4142; train_chrom_access_recon_loss: 5054370.8015; train_global_loss: 17670804.9847; train_optim_loss: 17670804.9847; val_kl_reg_loss: 47987.0964; val_edge_recon_loss: 2677522.6167; val_gene_expr_recon_loss: 9778842.2000; val_masked_gp_l1_reg_loss: 56122.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87003.6797; val_chrom_access_recon_loss: 5060546.0333; val_global_loss: 17708025.0667; val_optim_loss: 17708025.0667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9716; val_auprc_score: 0.9625; val_best_acc_score: 0.9272; val_best_f1_score: 0.9301; train_kl_reg_loss: 50997.3260; train_edge_recon_loss: 2671279.6641; train_gene_expr_recon_loss: 9747023.5496; train_masked_gp_l1_reg_loss: 55931.0660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86873.1134; train_chrom_access_recon_loss: 5050550.9351; train_global_loss: 17662655.6260; train_optim_loss: 17662655.6260; val_kl_reg_loss: 48266.9635; val_edge_recon_loss: 2669778.8667; val_gene_expr_recon_loss: 9795816.3333; val_masked_gp_l1_reg_loss: 55720.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86748.4453; val_chrom_access_recon_loss: 5077450.3333; val_global_loss: 17733781.3333; val_optim_loss: 17733781.3333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9723; val_auprc_score: 0.9634; val_best_acc_score: 0.9250; val_best_f1_score: 0.9284; train_kl_reg_loss: 49812.3206; train_edge_recon_loss: 2664637.3397; train_gene_expr_recon_loss: 9747366.1069; train_masked_gp_l1_reg_loss: 55603.7512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86822.9073; train_chrom_access_recon_loss: 5046948.7786; train_global_loss: 17651191.1908; train_optim_loss: 17651191.1908; val_kl_reg_loss: 47791.1987; val_edge_recon_loss: 2682230.9167; val_gene_expr_recon_loss: 9767586.0667; val_masked_gp_l1_reg_loss: 55465.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87075.3516; val_chrom_access_recon_loss: 5053145.4000; val_global_loss: 17693294.5333; val_optim_loss: 17693294.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9772; val_auprc_score: 0.9720; val_best_acc_score: 0.9309; val_best_f1_score: 0.9326; train_kl_reg_loss: 50428.8876; train_edge_recon_loss: 2663598.6450; train_gene_expr_recon_loss: 9728668.8015; train_masked_gp_l1_reg_loss: 54799.1119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69683.9376; train_chrom_access_recon_loss: 5034196.4466; train_global_loss: 17601375.8855; train_optim_loss: 17601375.8855; val_kl_reg_loss: 48804.4310; val_edge_recon_loss: 2673061.9333; val_gene_expr_recon_loss: 9728292.8667; val_masked_gp_l1_reg_loss: 54636.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67699.8828; val_chrom_access_recon_loss: 5011049.4000; val_global_loss: 17583544.6667; val_optim_loss: 17583544.6667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9738; val_auprc_score: 0.9669; val_best_acc_score: 0.9279; val_best_f1_score: 0.9304; train_kl_reg_loss: 51064.9717; train_edge_recon_loss: 2664632.0859; train_gene_expr_recon_loss: 9725120.5878; train_masked_gp_l1_reg_loss: 54585.3785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67327.5134; train_chrom_access_recon_loss: 5033387.7366; train_global_loss: 17596118.3511; train_optim_loss: 17596118.3511; val_kl_reg_loss: 49243.8536; val_edge_recon_loss: 2674177.8333; val_gene_expr_recon_loss: 9728226.6000; val_masked_gp_l1_reg_loss: 54532.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66952.1797; val_chrom_access_recon_loss: 5046929.8667; val_global_loss: 17620063.0667; val_optim_loss: 17620063.0667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9725; val_auprc_score: 0.9633; val_best_acc_score: 0.9250; val_best_f1_score: 0.9274; train_kl_reg_loss: 51511.6101; train_edge_recon_loss: 2662087.2977; train_gene_expr_recon_loss: 9721612.1603; train_masked_gp_l1_reg_loss: 54505.7173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66723.1694; train_chrom_access_recon_loss: 5024571.7366; train_global_loss: 17581011.7023; train_optim_loss: 17581011.7023; val_kl_reg_loss: 49635.7589; val_edge_recon_loss: 2664587.3333; val_gene_expr_recon_loss: 9755144.4000; val_masked_gp_l1_reg_loss: 54465.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66505.2422; val_chrom_access_recon_loss: 5029397.3000; val_global_loss: 17619736.0000; val_optim_loss: 17619736.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9741; val_auprc_score: 0.9652; val_best_acc_score: 0.9312; val_best_f1_score: 0.9336; train_kl_reg_loss: 51654.8895; train_edge_recon_loss: 2659835.9179; train_gene_expr_recon_loss: 9725308.6718; train_masked_gp_l1_reg_loss: 54426.4468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66267.6600; train_chrom_access_recon_loss: 5035268.1221; train_global_loss: 17592761.7710; train_optim_loss: 17592761.7710; val_kl_reg_loss: 49822.5898; val_edge_recon_loss: 2669212.3333; val_gene_expr_recon_loss: 9697919.8000; val_masked_gp_l1_reg_loss: 54403.7695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66075.4141; val_chrom_access_recon_loss: 5006419.4667; val_global_loss: 17543853.4000; val_optim_loss: 17543853.4000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9737; val_auprc_score: 0.9656; val_best_acc_score: 0.9260; val_best_f1_score: 0.9283; train_kl_reg_loss: 51656.1482; train_edge_recon_loss: 2653941.0248; train_gene_expr_recon_loss: 9718410.7023; train_masked_gp_l1_reg_loss: 54369.3143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65887.0300; train_chrom_access_recon_loss: 5029907.1260; train_global_loss: 17574171.2977; train_optim_loss: 17574171.2977; val_kl_reg_loss: 49905.9940; val_edge_recon_loss: 2678913.6500; val_gene_expr_recon_loss: 9708337.8000; val_masked_gp_l1_reg_loss: 54348.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65698.4844; val_chrom_access_recon_loss: 5017009.5667; val_global_loss: 17574214.1333; val_optim_loss: 17574214.1333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9737; val_auprc_score: 0.9653; val_best_acc_score: 0.9294; val_best_f1_score: 0.9308; train_kl_reg_loss: 51753.8172; train_edge_recon_loss: 2657006.7767; train_gene_expr_recon_loss: 9714701.9313; train_masked_gp_l1_reg_loss: 54312.8236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65556.0834; train_chrom_access_recon_loss: 5029192.0229; train_global_loss: 17572523.4046; train_optim_loss: 17572523.4046; val_kl_reg_loss: 49973.2495; val_edge_recon_loss: 2669735.4667; val_gene_expr_recon_loss: 9711113.4667; val_masked_gp_l1_reg_loss: 54278.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65379.5078; val_chrom_access_recon_loss: 5025945.9000; val_global_loss: 17576426.0000; val_optim_loss: 17576426.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9742; val_auprc_score: 0.9649; val_best_acc_score: 0.9306; val_best_f1_score: 0.9332; train_kl_reg_loss: 51640.7936; train_edge_recon_loss: 2658326.2844; train_gene_expr_recon_loss: 9726008.9160; train_masked_gp_l1_reg_loss: 54260.2823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65234.0161; train_chrom_access_recon_loss: 5038673.9313; train_global_loss: 17594144.2519; train_optim_loss: 17594144.2519; val_kl_reg_loss: 50106.1221; val_edge_recon_loss: 2653491.7333; val_gene_expr_recon_loss: 9748133.2667; val_masked_gp_l1_reg_loss: 54234.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65133.4688; val_chrom_access_recon_loss: 5032705.9000; val_global_loss: 17603805.2000; val_optim_loss: 17603805.2000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9765; val_auprc_score: 0.9692; val_best_acc_score: 0.9309; val_best_f1_score: 0.9317; train_kl_reg_loss: 52114.0915; train_edge_recon_loss: 2655480.6584; train_gene_expr_recon_loss: 9713839.3206; train_masked_gp_l1_reg_loss: 54219.8222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65005.9911; train_chrom_access_recon_loss: 5028465.7824; train_global_loss: 17569125.6412; train_optim_loss: 17569125.6412; val_kl_reg_loss: 50460.2305; val_edge_recon_loss: 2666173.5500; val_gene_expr_recon_loss: 9718574.9333; val_masked_gp_l1_reg_loss: 54176.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64802.0469; val_chrom_access_recon_loss: 5022642.0667; val_global_loss: 17576829.7333; val_optim_loss: 17576829.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9740; val_auprc_score: 0.9617; val_best_acc_score: 0.9286; val_best_f1_score: 0.9314; train_kl_reg_loss: 52082.6877; train_edge_recon_loss: 2657970.6870; train_gene_expr_recon_loss: 9720183.4656; train_masked_gp_l1_reg_loss: 54110.0558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63018.3071; train_chrom_access_recon_loss: 5034302.8321; train_global_loss: 17581668.0534; train_optim_loss: 17581668.0534; val_kl_reg_loss: 50573.4344; val_edge_recon_loss: 2670552.0667; val_gene_expr_recon_loss: 9738193.9333; val_masked_gp_l1_reg_loss: 54090.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62818.7656; val_chrom_access_recon_loss: 5069843.6667; val_global_loss: 17646072.0000; val_optim_loss: 17646072.0000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9763; val_auprc_score: 0.9686; val_best_acc_score: 0.9305; val_best_f1_score: 0.9327; train_kl_reg_loss: 52018.5881; train_edge_recon_loss: 2658725.0611; train_gene_expr_recon_loss: 9717037.8702; train_masked_gp_l1_reg_loss: 54083.4448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62782.7161; train_chrom_access_recon_loss: 5030974.7176; train_global_loss: 17575622.5115; train_optim_loss: 17575622.5115; val_kl_reg_loss: 50252.6305; val_edge_recon_loss: 2649176.7667; val_gene_expr_recon_loss: 9730969.6000; val_masked_gp_l1_reg_loss: 54077.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62739.9570; val_chrom_access_recon_loss: 5023827.7333; val_global_loss: 17571043.6667; val_optim_loss: 17571043.6667
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9730; val_auprc_score: 0.9632; val_best_acc_score: 0.9278; val_best_f1_score: 0.9306; train_kl_reg_loss: 52016.8626; train_edge_recon_loss: 2662647.3111; train_gene_expr_recon_loss: 9715219.7252; train_masked_gp_l1_reg_loss: 54072.2623; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62705.5088; train_chrom_access_recon_loss: 5034548.2023; train_global_loss: 17581209.8550; train_optim_loss: 17581209.8550; val_kl_reg_loss: 50069.3122; val_edge_recon_loss: 2678238.2667; val_gene_expr_recon_loss: 9722716.6000; val_masked_gp_l1_reg_loss: 54069.4023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62679.9062; val_chrom_access_recon_loss: 5022319.5000; val_global_loss: 17590092.6667; val_optim_loss: 17590092.6667
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9743; val_auprc_score: 0.9662; val_best_acc_score: 0.9303; val_best_f1_score: 0.9328; train_kl_reg_loss: 52058.9451; train_edge_recon_loss: 2655189.1832; train_gene_expr_recon_loss: 9726968.4809; train_masked_gp_l1_reg_loss: 54065.2957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62656.4495; train_chrom_access_recon_loss: 5036729.5229; train_global_loss: 17587667.8855; train_optim_loss: 17587667.8855; val_kl_reg_loss: 50549.9979; val_edge_recon_loss: 2666638.6000; val_gene_expr_recon_loss: 9736791.1333; val_masked_gp_l1_reg_loss: 54061.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62633.3750; val_chrom_access_recon_loss: 5029037.6333; val_global_loss: 17599711.0667; val_optim_loss: 17599711.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 60 min 2 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9732
val AUPRC score: 0.9629
val best accuracy score: 0.9287
val best F1 score: 0.9300
val target rna MSE score: 2.2429
val source rna MSE score: 0.6611
val target atac MSE score: 0.3381
val source atac MSE score: 0.1060
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
