[True]
Run timestamp: 07082023_211054_121.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_121']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9512; val_auprc_score: 0.9551; val_best_acc_score: 0.8271; val_best_f1_score: 0.8475; train_kl_reg_loss: 4642.6300; train_edge_recon_loss: 3468127.8333; train_gene_expr_recon_loss: 620563.6528; train_masked_gp_l1_reg_loss: 8648.1020; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 795638.3472; train_global_loss: 4897620.4444; train_optim_loss: 4897620.4444; val_kl_reg_loss: 1680.9291; val_edge_recon_loss: 4049521.0000; val_gene_expr_recon_loss: 620297.0625; val_masked_gp_l1_reg_loss: 6676.9492; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 798715.1875; val_global_loss: 5476891.0000; val_optim_loss: 5476891.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9379; val_auprc_score: 0.9372; val_best_acc_score: 0.8200; val_best_f1_score: 0.8329; train_kl_reg_loss: 1587.3413; train_edge_recon_loss: 3464450.1667; train_gene_expr_recon_loss: 605534.7569; train_masked_gp_l1_reg_loss: 5673.9039; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 791795.7778; train_global_loss: 4869041.8889; train_optim_loss: 4869041.8889; val_kl_reg_loss: 1529.9050; val_edge_recon_loss: 3935720.0000; val_gene_expr_recon_loss: 598381.4375; val_masked_gp_l1_reg_loss: 4820.5103; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 792751.4375; val_global_loss: 5333203.5000; val_optim_loss: 5333203.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8977; val_auprc_score: 0.8942; val_best_acc_score: 0.7873; val_best_f1_score: 0.8040; train_kl_reg_loss: 1847.4599; train_edge_recon_loss: 3368514.9722; train_gene_expr_recon_loss: 582002.9306; train_masked_gp_l1_reg_loss: 4701.1791; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 787113.2153; train_global_loss: 4744179.7778; train_optim_loss: 4744179.7778; val_kl_reg_loss: 4206.2788; val_edge_recon_loss: 3039107.2500; val_gene_expr_recon_loss: 577556.8750; val_masked_gp_l1_reg_loss: 4661.9507; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 786449.3125; val_global_loss: 4411982.0000; val_optim_loss: 4411982.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9006; val_auprc_score: 0.8917; val_best_acc_score: 0.8197; val_best_f1_score: 0.8249; train_kl_reg_loss: 16112.7074; train_edge_recon_loss: 2936729.6667; train_gene_expr_recon_loss: 568160.7292; train_masked_gp_l1_reg_loss: 4615.0050; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 784150.4792; train_global_loss: 4309768.5556; train_optim_loss: 4309768.5556; val_kl_reg_loss: 35726.3516; val_edge_recon_loss: 2836532.2500; val_gene_expr_recon_loss: 564592.3750; val_masked_gp_l1_reg_loss: 4529.5464; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 780756.5625; val_global_loss: 4222137.0000; val_optim_loss: 4222137.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9043; val_auprc_score: 0.8842; val_best_acc_score: 0.8238; val_best_f1_score: 0.8372; train_kl_reg_loss: 48195.1155; train_edge_recon_loss: 2824623.0556; train_gene_expr_recon_loss: 545936.8403; train_masked_gp_l1_reg_loss: 4515.8105; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 772957.1944; train_global_loss: 4196228.0556; train_optim_loss: 4196228.0556; val_kl_reg_loss: 46622.0234; val_edge_recon_loss: 2800835.2500; val_gene_expr_recon_loss: 546985.2500; val_masked_gp_l1_reg_loss: 4547.5679; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 773945.1875; val_global_loss: 4172935.2500; val_optim_loss: 4172935.2500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9226; val_auprc_score: 0.8972; val_best_acc_score: 0.8593; val_best_f1_score: 0.8688; train_kl_reg_loss: 37229.3220; train_edge_recon_loss: 2782633.8889; train_gene_expr_recon_loss: 535761.5000; train_masked_gp_l1_reg_loss: 4551.1325; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 768056.3542; train_global_loss: 4128232.1944; train_optim_loss: 4128232.1944; val_kl_reg_loss: 26920.1953; val_edge_recon_loss: 2747997.0000; val_gene_expr_recon_loss: 542055.1875; val_masked_gp_l1_reg_loss: 4562.1440; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 771633.1875; val_global_loss: 4093168.0000; val_optim_loss: 4093168.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9253; val_auprc_score: 0.9027; val_best_acc_score: 0.8616; val_best_f1_score: 0.8710; train_kl_reg_loss: 30418.9544; train_edge_recon_loss: 2730529.7500; train_gene_expr_recon_loss: 534741.2014; train_masked_gp_l1_reg_loss: 4574.2689; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 767876.8125; train_global_loss: 4068140.9722; train_optim_loss: 4068140.9722; val_kl_reg_loss: 34400.3906; val_edge_recon_loss: 2753022.2500; val_gene_expr_recon_loss: 533286.0000; val_masked_gp_l1_reg_loss: 4596.4316; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 767303.6250; val_global_loss: 4092609.0000; val_optim_loss: 4092609.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9321; val_auprc_score: 0.9117; val_best_acc_score: 0.8701; val_best_f1_score: 0.8766; train_kl_reg_loss: 37151.1662; train_edge_recon_loss: 2726078.1389; train_gene_expr_recon_loss: 523166.8160; train_masked_gp_l1_reg_loss: 4633.9192; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 763953.7778; train_global_loss: 4054983.8333; train_optim_loss: 4054983.8333; val_kl_reg_loss: 35669.5938; val_edge_recon_loss: 2730195.2500; val_gene_expr_recon_loss: 522327.3438; val_masked_gp_l1_reg_loss: 4689.4438; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 762960.4375; val_global_loss: 4055842.0000; val_optim_loss: 4055842.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9327; val_auprc_score: 0.9119; val_best_acc_score: 0.8729; val_best_f1_score: 0.8817; train_kl_reg_loss: 35836.4162; train_edge_recon_loss: 2723878.1389; train_gene_expr_recon_loss: 515073.9618; train_masked_gp_l1_reg_loss: 4739.0178; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 759280.2778; train_global_loss: 4038807.8889; train_optim_loss: 4038807.8889; val_kl_reg_loss: 33929.1484; val_edge_recon_loss: 2722626.0000; val_gene_expr_recon_loss: 517649.6250; val_masked_gp_l1_reg_loss: 4800.4448; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 760091.1875; val_global_loss: 4039096.7500; val_optim_loss: 4039096.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9370; val_auprc_score: 0.9163; val_best_acc_score: 0.8740; val_best_f1_score: 0.8809; train_kl_reg_loss: 35301.1059; train_edge_recon_loss: 2716322.9167; train_gene_expr_recon_loss: 505805.0347; train_masked_gp_l1_reg_loss: 4868.4052; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 755735.2083; train_global_loss: 4018032.6944; train_optim_loss: 4018032.6944; val_kl_reg_loss: 35418.3008; val_edge_recon_loss: 2728710.0000; val_gene_expr_recon_loss: 509423.1875; val_masked_gp_l1_reg_loss: 4928.4609; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 756666.0625; val_global_loss: 4035146.0000; val_optim_loss: 4035146.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9366; val_auprc_score: 0.9113; val_best_acc_score: 0.8816; val_best_f1_score: 0.8889; train_kl_reg_loss: 35799.1732; train_edge_recon_loss: 2722434.3056; train_gene_expr_recon_loss: 499911.6493; train_masked_gp_l1_reg_loss: 4988.6820; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 752974.4236; train_global_loss: 4016108.1944; train_optim_loss: 4016108.1944; val_kl_reg_loss: 34665.6328; val_edge_recon_loss: 2720499.0000; val_gene_expr_recon_loss: 501189.4375; val_masked_gp_l1_reg_loss: 5053.8174; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 753622.7500; val_global_loss: 4015030.7500; val_optim_loss: 4015030.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9487; val_auprc_score: 0.9332; val_best_acc_score: 0.8918; val_best_f1_score: 0.8978; train_kl_reg_loss: 34357.6979; train_edge_recon_loss: 2709948.5556; train_gene_expr_recon_loss: 491589.4097; train_masked_gp_l1_reg_loss: 5115.5590; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 746947.4653; train_global_loss: 3987958.7222; train_optim_loss: 3987958.7222; val_kl_reg_loss: 33388.6328; val_edge_recon_loss: 2710996.5000; val_gene_expr_recon_loss: 496376.5625; val_masked_gp_l1_reg_loss: 5184.7603; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 750941.8125; val_global_loss: 3996888.2500; val_optim_loss: 3996888.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9493; val_auprc_score: 0.9333; val_best_acc_score: 0.8928; val_best_f1_score: 0.8980; train_kl_reg_loss: 33687.9249; train_edge_recon_loss: 2708339.0556; train_gene_expr_recon_loss: 489908.6979; train_masked_gp_l1_reg_loss: 5231.9201; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 748089.7778; train_global_loss: 3985257.3611; train_optim_loss: 3985257.3611; val_kl_reg_loss: 32498.7969; val_edge_recon_loss: 2711620.2500; val_gene_expr_recon_loss: 493048.1250; val_masked_gp_l1_reg_loss: 5294.8252; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 748974.8750; val_global_loss: 3991436.5000; val_optim_loss: 3991436.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9579; val_auprc_score: 0.9439; val_best_acc_score: 0.9022; val_best_f1_score: 0.9060; train_kl_reg_loss: 33022.6782; train_edge_recon_loss: 2692744.0000; train_gene_expr_recon_loss: 486802.3819; train_masked_gp_l1_reg_loss: 5356.0776; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 744899.8958; train_global_loss: 3962825.0833; train_optim_loss: 3962825.0833; val_kl_reg_loss: 32273.2012; val_edge_recon_loss: 2681527.7500; val_gene_expr_recon_loss: 491594.0625; val_masked_gp_l1_reg_loss: 5431.8359; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 747552.1875; val_global_loss: 3958379.0000; val_optim_loss: 3958379.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9624; val_auprc_score: 0.9493; val_best_acc_score: 0.9111; val_best_f1_score: 0.9146; train_kl_reg_loss: 33230.2778; train_edge_recon_loss: 2700197.9722; train_gene_expr_recon_loss: 485231.6007; train_masked_gp_l1_reg_loss: 5500.8160; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 740469.7083; train_global_loss: 3964630.4167; train_optim_loss: 3964630.4167; val_kl_reg_loss: 31423.9492; val_edge_recon_loss: 2681972.5000; val_gene_expr_recon_loss: 490683.7500; val_masked_gp_l1_reg_loss: 5568.1689; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 745793.6875; val_global_loss: 3955442.2500; val_optim_loss: 3955442.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9659; val_auprc_score: 0.9544; val_best_acc_score: 0.9135; val_best_f1_score: 0.9167; train_kl_reg_loss: 32888.2146; train_edge_recon_loss: 2692228.6944; train_gene_expr_recon_loss: 482722.1632; train_masked_gp_l1_reg_loss: 5629.7849; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 740961.3542; train_global_loss: 3954430.1667; train_optim_loss: 3954430.1667; val_kl_reg_loss: 31342.1875; val_edge_recon_loss: 2689396.2500; val_gene_expr_recon_loss: 485683.5000; val_masked_gp_l1_reg_loss: 5693.1343; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 743368.1250; val_global_loss: 3955483.5000; val_optim_loss: 3955483.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9684; val_auprc_score: 0.9593; val_best_acc_score: 0.9163; val_best_f1_score: 0.9197; train_kl_reg_loss: 33907.2524; train_edge_recon_loss: 2670865.3889; train_gene_expr_recon_loss: 479619.2917; train_masked_gp_l1_reg_loss: 5745.0917; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 738296.7778; train_global_loss: 3928433.7500; train_optim_loss: 3928433.7500; val_kl_reg_loss: 33373.9453; val_edge_recon_loss: 2670817.5000; val_gene_expr_recon_loss: 482246.0625; val_masked_gp_l1_reg_loss: 5802.6470; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 740670.5625; val_global_loss: 3932910.7500; val_optim_loss: 3932910.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9691; val_auprc_score: 0.9547; val_best_acc_score: 0.9227; val_best_f1_score: 0.9252; train_kl_reg_loss: 34627.3351; train_edge_recon_loss: 2667112.2778; train_gene_expr_recon_loss: 475724.6319; train_masked_gp_l1_reg_loss: 5847.5287; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 736935.1458; train_global_loss: 3920246.9167; train_optim_loss: 3920246.9167; val_kl_reg_loss: 33303.6641; val_edge_recon_loss: 2684696.2500; val_gene_expr_recon_loss: 479171.8750; val_masked_gp_l1_reg_loss: 5886.2676; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 738977.6250; val_global_loss: 3942036.0000; val_optim_loss: 3942036.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9714; val_auprc_score: 0.9616; val_best_acc_score: 0.9276; val_best_f1_score: 0.9305; train_kl_reg_loss: 34012.8277; train_edge_recon_loss: 2660884.5000; train_gene_expr_recon_loss: 472297.2083; train_masked_gp_l1_reg_loss: 5921.6634; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 732763.7708; train_global_loss: 3905880.0556; train_optim_loss: 3905880.0556; val_kl_reg_loss: 31666.1562; val_edge_recon_loss: 2664966.0000; val_gene_expr_recon_loss: 482437.8125; val_masked_gp_l1_reg_loss: 5952.1055; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 739017.5000; val_global_loss: 3924039.5000; val_optim_loss: 3924039.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9735; val_auprc_score: 0.9616; val_best_acc_score: 0.9342; val_best_f1_score: 0.9367; train_kl_reg_loss: 32232.2324; train_edge_recon_loss: 2657445.6667; train_gene_expr_recon_loss: 469412.4618; train_masked_gp_l1_reg_loss: 5994.6826; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 733179.7708; train_global_loss: 3898264.7222; train_optim_loss: 3898264.7222; val_kl_reg_loss: 33116.3047; val_edge_recon_loss: 2656554.0000; val_gene_expr_recon_loss: 473429.7500; val_masked_gp_l1_reg_loss: 6030.6094; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 735461.5625; val_global_loss: 3904592.0000; val_optim_loss: 3904592.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9753; val_auprc_score: 0.9671; val_best_acc_score: 0.9321; val_best_f1_score: 0.9343; train_kl_reg_loss: 33997.7287; train_edge_recon_loss: 2652365.5278; train_gene_expr_recon_loss: 468680.8958; train_masked_gp_l1_reg_loss: 6061.6809; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 731163.7431; train_global_loss: 3892269.4722; train_optim_loss: 3892269.4722; val_kl_reg_loss: 31887.1836; val_edge_recon_loss: 2647028.2500; val_gene_expr_recon_loss: 474722.0625; val_masked_gp_l1_reg_loss: 6092.9141; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 734585.3125; val_global_loss: 3894315.7500; val_optim_loss: 3894315.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9755; val_auprc_score: 0.9665; val_best_acc_score: 0.9316; val_best_f1_score: 0.9340; train_kl_reg_loss: 32583.2580; train_edge_recon_loss: 2650758.5000; train_gene_expr_recon_loss: 468352.1007; train_masked_gp_l1_reg_loss: 6123.7220; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 732359.0139; train_global_loss: 3890176.6111; train_optim_loss: 3890176.6111; val_kl_reg_loss: 32617.9102; val_edge_recon_loss: 2656144.5000; val_gene_expr_recon_loss: 471267.0625; val_masked_gp_l1_reg_loss: 6150.7446; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 733562.8125; val_global_loss: 3899743.0000; val_optim_loss: 3899743.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9753; val_auprc_score: 0.9657; val_best_acc_score: 0.9310; val_best_f1_score: 0.9341; train_kl_reg_loss: 33707.8741; train_edge_recon_loss: 2652389.6389; train_gene_expr_recon_loss: 466015.2569; train_masked_gp_l1_reg_loss: 6185.6638; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 728480.6389; train_global_loss: 3886779.0833; train_optim_loss: 3886779.0833; val_kl_reg_loss: 32616.9434; val_edge_recon_loss: 2662922.7500; val_gene_expr_recon_loss: 470081.0000; val_masked_gp_l1_reg_loss: 6211.8105; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 731305.0000; val_global_loss: 3903137.5000; val_optim_loss: 3903137.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9754; val_auprc_score: 0.9660; val_best_acc_score: 0.9312; val_best_f1_score: 0.9336; train_kl_reg_loss: 33468.4089; train_edge_recon_loss: 2638792.0000; train_gene_expr_recon_loss: 466199.0903; train_masked_gp_l1_reg_loss: 6244.4964; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 731052.5000; train_global_loss: 3875756.4444; train_optim_loss: 3875756.4444; val_kl_reg_loss: 32690.1621; val_edge_recon_loss: 2664725.0000; val_gene_expr_recon_loss: 469042.7500; val_masked_gp_l1_reg_loss: 6277.5859; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 729489.8750; val_global_loss: 3902225.5000; val_optim_loss: 3902225.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9785; val_auprc_score: 0.9684; val_best_acc_score: 0.9357; val_best_f1_score: 0.9365; train_kl_reg_loss: 33273.7912; train_edge_recon_loss: 2641158.3889; train_gene_expr_recon_loss: 461492.5104; train_masked_gp_l1_reg_loss: 6318.3590; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 726630.7847; train_global_loss: 3868873.8611; train_optim_loss: 3868873.8611; val_kl_reg_loss: 33424.3438; val_edge_recon_loss: 2677336.2500; val_gene_expr_recon_loss: 468821.3125; val_masked_gp_l1_reg_loss: 6352.7969; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 727963.8125; val_global_loss: 3913898.2500; val_optim_loss: 3913898.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9782; val_auprc_score: 0.9711; val_best_acc_score: 0.9317; val_best_f1_score: 0.9341; train_kl_reg_loss: 33350.0742; train_edge_recon_loss: 2667853.1111; train_gene_expr_recon_loss: 473488.0208; train_masked_gp_l1_reg_loss: 6318.4293; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 728761.5208; train_global_loss: 3909771.1667; train_optim_loss: 3909771.1667; val_kl_reg_loss: 17318.4434; val_edge_recon_loss: 2666392.2500; val_gene_expr_recon_loss: 494320.8125; val_masked_gp_l1_reg_loss: 6266.5044; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 739550.8750; val_global_loss: 3923849.0000; val_optim_loss: 3923849.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9780; val_auprc_score: 0.9701; val_best_acc_score: 0.9337; val_best_f1_score: 0.9351; train_kl_reg_loss: 32823.0085; train_edge_recon_loss: 2646277.3333; train_gene_expr_recon_loss: 482241.6007; train_masked_gp_l1_reg_loss: 6240.4423; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 733368.7986; train_global_loss: 3900951.1667; train_optim_loss: 3900951.1667; val_kl_reg_loss: 17866.6152; val_edge_recon_loss: 2659728.0000; val_gene_expr_recon_loss: 486456.0000; val_masked_gp_l1_reg_loss: 6211.6411; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 736601.9375; val_global_loss: 3906864.2500; val_optim_loss: 3906864.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9772; val_auprc_score: 0.9695; val_best_acc_score: 0.9317; val_best_f1_score: 0.9333; train_kl_reg_loss: 33288.1332; train_edge_recon_loss: 2662315.7500; train_gene_expr_recon_loss: 474890.8194; train_masked_gp_l1_reg_loss: 6195.6790; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 729546.8819; train_global_loss: 3906237.2778; train_optim_loss: 3906237.2778; val_kl_reg_loss: 17501.3359; val_edge_recon_loss: 2672469.2500; val_gene_expr_recon_loss: 483568.8125; val_masked_gp_l1_reg_loss: 6177.7734; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 735753.7500; val_global_loss: 3915470.7500; val_optim_loss: 3915470.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9782; val_auprc_score: 0.9697; val_best_acc_score: 0.9357; val_best_f1_score: 0.9369; train_kl_reg_loss: 32632.4401; train_edge_recon_loss: 2651089.3611; train_gene_expr_recon_loss: 475870.3646; train_masked_gp_l1_reg_loss: 6167.7721; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 732490.0139; train_global_loss: 3898250.0000; train_optim_loss: 3898250.0000; val_kl_reg_loss: 17094.2773; val_edge_recon_loss: 2658511.0000; val_gene_expr_recon_loss: 486353.6562; val_masked_gp_l1_reg_loss: 6157.8032; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 736613.2500; val_global_loss: 3904730.0000; val_optim_loss: 3904730.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 21 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
val AUROC score: 0.9746
val AUPRC score: 0.9643
val best accuracy score: 0.9305
val best F1 score: 0.9333
val target rna MSE score: 1.1470
val source rna MSE score: 0.3507
val target atac MSE score: 0.1342
val source atac MSE score: 0.0208
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
