[True, False, True]
Run timestamp: 01092023_114547_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc_modified', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '50', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '100.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 550825
Number of validation nodes: 61203
Number of training edges: 1299049
Number of validation edges: 144338
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/50 |--------------------| 2.0% val_auroc_score: 0.8933; val_auprc_score: 0.9814; val_best_acc_score: 0.9119; val_best_f1_score: 0.9512; train_kl_reg_loss: 17870.6118; train_edge_recon_loss: 731514.1541; train_cat_covariates_contrastive_loss: 951880.3271; train_gene_expr_recon_loss: 2599014.0232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15452.0389; train_global_loss: 4315731.1595; train_optim_loss: 4315731.1595; val_kl_reg_loss: 19797.9389; val_edge_recon_loss: 730043.0574; val_cat_covariates_contrastive_loss: 952232.0173; val_gene_expr_recon_loss: 2274328.8998; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5606.5640; val_global_loss: 3982008.4211; val_optim_loss: 3982008.4211
Epoch 2/50 |--------------------| 4.0% val_auroc_score: 0.9055; val_auprc_score: 0.9833; val_best_acc_score: 0.9212; val_best_f1_score: 0.9562; train_kl_reg_loss: 21545.7147; train_edge_recon_loss: 701842.7155; train_cat_covariates_contrastive_loss: 953153.5587; train_gene_expr_recon_loss: 2131365.7430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5275.8760; train_global_loss: 3813183.6069; train_optim_loss: 3813183.6069; val_kl_reg_loss: 24114.0294; val_edge_recon_loss: 709623.1421; val_cat_covariates_contrastive_loss: 950848.9878; val_gene_expr_recon_loss: 2037261.1746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5050.8765; val_global_loss: 3726898.3351; val_optim_loss: 3726898.3351
Epoch 3/50 |█-------------------| 6.0% val_auroc_score: 0.9217; val_auprc_score: 0.9867; val_best_acc_score: 0.9252; val_best_f1_score: 0.9582; train_kl_reg_loss: 23635.3749; train_edge_recon_loss: 699597.1148; train_cat_covariates_contrastive_loss: 953608.7272; train_gene_expr_recon_loss: 1996069.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4998.1754; train_global_loss: 3677908.4560; train_optim_loss: 3677908.4560; val_kl_reg_loss: 22269.8300; val_edge_recon_loss: 720386.4176; val_cat_covariates_contrastive_loss: 961844.1449; val_gene_expr_recon_loss: 1964892.8958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4887.5952; val_global_loss: 3674280.7943; val_optim_loss: 3674280.7943
Epoch 4/50 |█-------------------| 8.0% val_auroc_score: 0.9194; val_auprc_score: 0.9857; val_best_acc_score: 0.9273; val_best_f1_score: 0.9595; train_kl_reg_loss: 24494.1356; train_edge_recon_loss: 697884.1150; train_cat_covariates_contrastive_loss: 953867.2510; train_gene_expr_recon_loss: 1946750.6096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4881.6111; train_global_loss: 3627877.7246; train_optim_loss: 3627877.7246; val_kl_reg_loss: 24254.7128; val_edge_recon_loss: 712454.5738; val_cat_covariates_contrastive_loss: 955038.1691; val_gene_expr_recon_loss: 1934757.8621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4801.8945; val_global_loss: 3631307.3191; val_optim_loss: 3631307.3191
Epoch 5/50 |██------------------| 10.0% val_auroc_score: 0.9254; val_auprc_score: 0.9871; val_best_acc_score: 0.9307; val_best_f1_score: 0.9613; train_kl_reg_loss: 24887.5800; train_edge_recon_loss: 697225.7385; train_cat_covariates_contrastive_loss: 953673.0509; train_gene_expr_recon_loss: 1920150.1436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4797.1016; train_global_loss: 3600733.6153; train_optim_loss: 3600733.6153; val_kl_reg_loss: 24207.9079; val_edge_recon_loss: 714764.0909; val_cat_covariates_contrastive_loss: 955704.4679; val_gene_expr_recon_loss: 1911715.7190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4803.9385; val_global_loss: 3611196.1906; val_optim_loss: 3611196.1906
Epoch 6/50 |██------------------| 12.0% val_auroc_score: 0.8984; val_auprc_score: 0.9807; val_best_acc_score: 0.9176; val_best_f1_score: 0.9538; train_kl_reg_loss: 25271.7229; train_edge_recon_loss: 695513.3461; train_cat_covariates_contrastive_loss: 953854.7326; train_gene_expr_recon_loss: 1903228.2409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4746.9546; train_global_loss: 3582614.9953; train_optim_loss: 3582614.9953; val_kl_reg_loss: 29438.8329; val_edge_recon_loss: 728308.3573; val_cat_covariates_contrastive_loss: 949262.2828; val_gene_expr_recon_loss: 1900151.9255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4706.2788; val_global_loss: 3611867.6472; val_optim_loss: 3611867.6472
Epoch 7/50 |██------------------| 14.0% val_auroc_score: 0.9262; val_auprc_score: 0.9870; val_best_acc_score: 0.9268; val_best_f1_score: 0.9592; train_kl_reg_loss: 25438.9625; train_edge_recon_loss: 695673.0684; train_cat_covariates_contrastive_loss: 953773.1989; train_gene_expr_recon_loss: 1888676.4906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4712.0875; train_global_loss: 3568273.8069; train_optim_loss: 3568273.8069; val_kl_reg_loss: 23930.4428; val_edge_recon_loss: 721946.3075; val_cat_covariates_contrastive_loss: 956324.8551; val_gene_expr_recon_loss: 1894968.6312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4739.4058; val_global_loss: 3601909.7296; val_optim_loss: 3601909.7296
Epoch 8/50 |███-----------------| 16.0% val_auroc_score: 0.9192; val_auprc_score: 0.9856; val_best_acc_score: 0.9255; val_best_f1_score: 0.9583; train_kl_reg_loss: 25670.0475; train_edge_recon_loss: 690832.1227; train_cat_covariates_contrastive_loss: 953933.9408; train_gene_expr_recon_loss: 1877960.6315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4663.9457; train_global_loss: 3553060.6834; train_optim_loss: 3553060.6834; val_kl_reg_loss: 26384.1006; val_edge_recon_loss: 711365.2838; val_cat_covariates_contrastive_loss: 953406.5448; val_gene_expr_recon_loss: 1873624.6565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4640.4854; val_global_loss: 3569421.0895; val_optim_loss: 3569421.0895
Epoch 9/50 |███-----------------| 18.0% val_auroc_score: 0.9237; val_auprc_score: 0.9867; val_best_acc_score: 0.9252; val_best_f1_score: 0.9581; train_kl_reg_loss: 26181.1819; train_edge_recon_loss: 694725.7383; train_cat_covariates_contrastive_loss: 954102.8615; train_gene_expr_recon_loss: 1868381.7746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4643.3299; train_global_loss: 3548034.8843; train_optim_loss: 3548034.8843; val_kl_reg_loss: 26518.4445; val_edge_recon_loss: 705032.9102; val_cat_covariates_contrastive_loss: 953901.0508; val_gene_expr_recon_loss: 1870035.8661; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4603.8931; val_global_loss: 3560092.2846; val_optim_loss: 3560092.2846
Epoch 10/50 |████----------------| 20.0% val_auroc_score: 0.9230; val_auprc_score: 0.9866; val_best_acc_score: 0.9257; val_best_f1_score: 0.9585; train_kl_reg_loss: 26391.4366; train_edge_recon_loss: 694506.2378; train_cat_covariates_contrastive_loss: 954283.9612; train_gene_expr_recon_loss: 1859410.1593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4628.0666; train_global_loss: 3539219.8649; train_optim_loss: 3539219.8649; val_kl_reg_loss: 26650.4972; val_edge_recon_loss: 710138.6161; val_cat_covariates_contrastive_loss: 955367.3839; val_gene_expr_recon_loss: 1868462.4761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4588.1172; val_global_loss: 3565206.9725; val_optim_loss: 3565206.9725
Epoch 11/50 |████----------------| 22.0% val_auroc_score: 0.9266; val_auprc_score: 0.9872; val_best_acc_score: 0.9294; val_best_f1_score: 0.9605; train_kl_reg_loss: 26606.2597; train_edge_recon_loss: 690415.7552; train_cat_covariates_contrastive_loss: 954160.8896; train_gene_expr_recon_loss: 1850057.3160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4615.3454; train_global_loss: 3525855.5646; train_optim_loss: 3525855.5646; val_kl_reg_loss: 26656.5221; val_edge_recon_loss: 708127.2696; val_cat_covariates_contrastive_loss: 953772.7875; val_gene_expr_recon_loss: 1856320.1809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4638.0098; val_global_loss: 3549514.7633; val_optim_loss: 3549514.7633
Epoch 12/50 |████----------------| 24.0% val_auroc_score: 0.8928; val_auprc_score: 0.9799; val_best_acc_score: 0.9159; val_best_f1_score: 0.9529; train_kl_reg_loss: 26859.2251; train_edge_recon_loss: 692820.2134; train_cat_covariates_contrastive_loss: 954364.3479; train_gene_expr_recon_loss: 1844162.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4600.6979; train_global_loss: 3522806.7643; train_optim_loss: 3522806.7643; val_kl_reg_loss: 28792.3711; val_edge_recon_loss: 721690.0144; val_cat_covariates_contrastive_loss: 951729.3065; val_gene_expr_recon_loss: 1854258.7677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4542.9824; val_global_loss: 3561013.4610; val_optim_loss: 3561013.4610
Epoch 13/50 |█████---------------| 26.0% val_auroc_score: 0.9146; val_auprc_score: 0.9843; val_best_acc_score: 0.9232; val_best_f1_score: 0.9573; train_kl_reg_loss: 27021.4866; train_edge_recon_loss: 690809.9294; train_cat_covariates_contrastive_loss: 954495.2185; train_gene_expr_recon_loss: 1839014.2735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4577.6896; train_global_loss: 3515918.5960; train_optim_loss: 3515918.5960; val_kl_reg_loss: 27491.3150; val_edge_recon_loss: 714247.2673; val_cat_covariates_contrastive_loss: 953585.3482; val_gene_expr_recon_loss: 1839159.5288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4559.9717; val_global_loss: 3539043.4601; val_optim_loss: 3539043.4601
Epoch 14/50 |█████---------------| 28.0% val_auroc_score: 0.9303; val_auprc_score: 0.9880; val_best_acc_score: 0.9303; val_best_f1_score: 0.9611; train_kl_reg_loss: 27231.8597; train_edge_recon_loss: 692092.5464; train_cat_covariates_contrastive_loss: 954387.8600; train_gene_expr_recon_loss: 1833343.6541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4569.3709; train_global_loss: 3511625.2925; train_optim_loss: 3511625.2925; val_kl_reg_loss: 26939.8044; val_edge_recon_loss: 708363.6022; val_cat_covariates_contrastive_loss: 956658.7416; val_gene_expr_recon_loss: 1837247.4353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4587.3550; val_global_loss: 3533796.8324; val_optim_loss: 3533796.8324
Epoch 15/50 |██████--------------| 30.0% val_auroc_score: 0.9180; val_auprc_score: 0.9857; val_best_acc_score: 0.9195; val_best_f1_score: 0.9552; train_kl_reg_loss: 27326.7760; train_edge_recon_loss: 692794.7150; train_cat_covariates_contrastive_loss: 954391.2630; train_gene_expr_recon_loss: 1828403.6219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4561.0478; train_global_loss: 3507477.4237; train_optim_loss: 3507477.4237; val_kl_reg_loss: 27092.4029; val_edge_recon_loss: 708178.2338; val_cat_covariates_contrastive_loss: 955913.2697; val_gene_expr_recon_loss: 1837755.7691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4529.7197; val_global_loss: 3533469.4291; val_optim_loss: 3533469.4291
Epoch 16/50 |██████--------------| 32.0% val_auroc_score: 0.9269; val_auprc_score: 0.9871; val_best_acc_score: 0.9306; val_best_f1_score: 0.9613; train_kl_reg_loss: 27464.2665; train_edge_recon_loss: 694639.7907; train_cat_covariates_contrastive_loss: 954679.1930; train_gene_expr_recon_loss: 1825188.0197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4547.3013; train_global_loss: 3506518.5684; train_optim_loss: 3506518.5684; val_kl_reg_loss: 27949.0525; val_edge_recon_loss: 708394.5705; val_cat_covariates_contrastive_loss: 954976.0499; val_gene_expr_recon_loss: 1842288.8413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4513.2148; val_global_loss: 3538121.7668; val_optim_loss: 3538121.7668
Epoch 17/50 |██████--------------| 34.0% val_auroc_score: 0.9221; val_auprc_score: 0.9855; val_best_acc_score: 0.9312; val_best_f1_score: 0.9616; train_kl_reg_loss: 27532.2994; train_edge_recon_loss: 691700.0578; train_cat_covariates_contrastive_loss: 954459.4010; train_gene_expr_recon_loss: 1821505.7237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4550.5145; train_global_loss: 3499747.9943; train_optim_loss: 3499747.9943; val_kl_reg_loss: 28762.8551; val_edge_recon_loss: 715299.2574; val_cat_covariates_contrastive_loss: 951755.3805; val_gene_expr_recon_loss: 1823898.7035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4510.5894; val_global_loss: 3524226.6986; val_optim_loss: 3524226.6986
Epoch 18/50 |███████-------------| 36.0% val_auroc_score: 0.9307; val_auprc_score: 0.9880; val_best_acc_score: 0.9265; val_best_f1_score: 0.9587; train_kl_reg_loss: 27649.5815; train_edge_recon_loss: 692083.7226; train_cat_covariates_contrastive_loss: 954630.1530; train_gene_expr_recon_loss: 1818454.2836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4544.1325; train_global_loss: 3497361.8737; train_optim_loss: 3497361.8737; val_kl_reg_loss: 26411.5674; val_edge_recon_loss: 714766.4045; val_cat_covariates_contrastive_loss: 959251.9956; val_gene_expr_recon_loss: 1819657.2580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4478.0767; val_global_loss: 3524565.2225; val_optim_loss: 3524565.2225
Epoch 19/50 |███████-------------| 38.0% val_auroc_score: 0.9268; val_auprc_score: 0.9870; val_best_acc_score: 0.9350; val_best_f1_score: 0.9637; train_kl_reg_loss: 28219.3246; train_edge_recon_loss: 689737.5171; train_cat_covariates_contrastive_loss: 954575.0002; train_gene_expr_recon_loss: 1816918.5264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4537.6697; train_global_loss: 3493988.0348; train_optim_loss: 3493988.0348; val_kl_reg_loss: 27988.7571; val_edge_recon_loss: 704848.6392; val_cat_covariates_contrastive_loss: 954785.7981; val_gene_expr_recon_loss: 1824477.0988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4566.0181; val_global_loss: 3516666.2988; val_optim_loss: 3516666.2988
Epoch 20/50 |████████------------| 40.0% val_auroc_score: 0.9291; val_auprc_score: 0.9875; val_best_acc_score: 0.9307; val_best_f1_score: 0.9612; train_kl_reg_loss: 28135.3343; train_edge_recon_loss: 691700.0375; train_cat_covariates_contrastive_loss: 954712.3232; train_gene_expr_recon_loss: 1812955.0144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4541.2875; train_global_loss: 3492043.9985; train_optim_loss: 3492043.9985; val_kl_reg_loss: 26919.7631; val_edge_recon_loss: 706205.4659; val_cat_covariates_contrastive_loss: 956704.8597; val_gene_expr_recon_loss: 1821092.4176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4521.3721; val_global_loss: 3515443.7509; val_optim_loss: 3515443.7509
Epoch 21/50 |████████------------| 42.0% val_auroc_score: 0.9239; val_auprc_score: 0.9868; val_best_acc_score: 0.9293; val_best_f1_score: 0.9605; train_kl_reg_loss: 27708.0804; train_edge_recon_loss: 694713.4316; train_cat_covariates_contrastive_loss: 954987.6870; train_gene_expr_recon_loss: 1884618.8771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4691.9212; train_global_loss: 3566719.9956; train_optim_loss: 3566719.9956; val_kl_reg_loss: 21644.2629; val_edge_recon_loss: 711109.1637; val_cat_covariates_contrastive_loss: 953746.6059; val_gene_expr_recon_loss: 2293818.8324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5411.4395; val_global_loss: 3985730.3626; val_optim_loss: 3985730.3626
Epoch 22/50 |████████------------| 44.0% val_auroc_score: 0.9248; val_auprc_score: 0.9865; val_best_acc_score: 0.9296; val_best_f1_score: 0.9607; train_kl_reg_loss: 27055.3738; train_edge_recon_loss: 689913.1895; train_cat_covariates_contrastive_loss: 954227.6477; train_gene_expr_recon_loss: 1984223.2809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4683.2590; train_global_loss: 3660102.7513; train_optim_loss: 3660102.7513; val_kl_reg_loss: 27767.8006; val_edge_recon_loss: 708201.1222; val_cat_covariates_contrastive_loss: 954212.6735; val_gene_expr_recon_loss: 1883109.0399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4601.6191; val_global_loss: 3577892.1436; val_optim_loss: 3577892.1436
Epoch 23/50 |█████████-----------| 46.0% val_auroc_score: 0.9204; val_auprc_score: 0.9855; val_best_acc_score: 0.9267; val_best_f1_score: 0.9591; train_kl_reg_loss: 28193.4627; train_edge_recon_loss: 690509.8398; train_cat_covariates_contrastive_loss: 954855.5078; train_gene_expr_recon_loss: 1849143.9113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4551.4121; train_global_loss: 3527254.1361; train_optim_loss: 3527254.1361; val_kl_reg_loss: 29109.5353; val_edge_recon_loss: 706753.8727; val_cat_covariates_contrastive_loss: 953221.7334; val_gene_expr_recon_loss: 1839871.6671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4555.4976; val_global_loss: 3533512.3032; val_optim_loss: 3533512.3032
Epoch 24/50 |█████████-----------| 48.0% val_auroc_score: 0.9085; val_auprc_score: 0.9829; val_best_acc_score: 0.9204; val_best_f1_score: 0.9555; train_kl_reg_loss: 28313.7875; train_edge_recon_loss: 689594.6934; train_cat_covariates_contrastive_loss: 954866.1279; train_gene_expr_recon_loss: 1817795.0131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4521.6645; train_global_loss: 3495091.2883; train_optim_loss: 3495091.2883; val_kl_reg_loss: 31174.3376; val_edge_recon_loss: 713718.9838; val_cat_covariates_contrastive_loss: 951392.0887; val_gene_expr_recon_loss: 1821024.4743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4508.6699; val_global_loss: 3521818.6241; val_optim_loss: 3521818.6241

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/50 |██████████----------| 50.0% val_auroc_score: 0.9267; val_auprc_score: 0.9867; val_best_acc_score: 0.9288; val_best_f1_score: 0.9602; train_kl_reg_loss: 28252.7308; train_edge_recon_loss: 688399.8350; train_cat_covariates_contrastive_loss: 954694.0162; train_gene_expr_recon_loss: 1782344.1891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4140.8122; train_global_loss: 3457831.5843; train_optim_loss: 3457831.5843; val_kl_reg_loss: 28298.1239; val_edge_recon_loss: 709490.2019; val_cat_covariates_contrastive_loss: 954584.0554; val_gene_expr_recon_loss: 1786086.3887; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4106.6973; val_global_loss: 3482565.5248; val_optim_loss: 3482565.5248
Epoch 26/50 |██████████----------| 52.0% val_auroc_score: 0.9301; val_auprc_score: 0.9877; val_best_acc_score: 0.9316; val_best_f1_score: 0.9617; train_kl_reg_loss: 28061.2397; train_edge_recon_loss: 687556.9871; train_cat_covariates_contrastive_loss: 954690.4280; train_gene_expr_recon_loss: 1774534.4507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4100.2267; train_global_loss: 3448943.3296; train_optim_loss: 3448943.3296; val_kl_reg_loss: 28284.8283; val_edge_recon_loss: 702641.2640; val_cat_covariates_contrastive_loss: 954492.4145; val_gene_expr_recon_loss: 1781604.9548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4100.2925; val_global_loss: 3471123.7181; val_optim_loss: 3471123.7181
Epoch 27/50 |██████████----------| 54.0% val_auroc_score: 0.9274; val_auprc_score: 0.9869; val_best_acc_score: 0.9315; val_best_f1_score: 0.9617; train_kl_reg_loss: 27853.4922; train_edge_recon_loss: 689393.5367; train_cat_covariates_contrastive_loss: 954543.7232; train_gene_expr_recon_loss: 1770928.4203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4101.6030; train_global_loss: 3446820.7752; train_optim_loss: 3446820.7752; val_kl_reg_loss: 27794.4426; val_edge_recon_loss: 700773.0731; val_cat_covariates_contrastive_loss: 954273.6170; val_gene_expr_recon_loss: 1779020.7371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4098.3853; val_global_loss: 3465960.3661; val_optim_loss: 3465960.3661
