[True]
Run timestamp: 01082023_085111_60.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_60']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9082; val_auprc_score: 0.9822; val_best_acc_score: 0.8512; val_best_f1_score: 0.9196; train_kl_reg_loss: 67600.2992; train_edge_recon_loss: 116653.4761; train_gene_expr_recon_loss: 5354277.9630; train_masked_gp_l1_reg_loss: 12289.8130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117760.8053; train_global_loss: 5668582.4259; train_optim_loss: 5668582.4259; val_kl_reg_loss: 89846.9948; val_edge_recon_loss: 120982.6068; val_gene_expr_recon_loss: 4185651.5417; val_masked_gp_l1_reg_loss: 11254.2168; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109017.4062; val_global_loss: 4516752.5000; val_optim_loss: 4516752.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8876; val_auprc_score: 0.9782; val_best_acc_score: 0.8540; val_best_f1_score: 0.9213; train_kl_reg_loss: 85346.7905; train_edge_recon_loss: 119404.1813; train_gene_expr_recon_loss: 3935484.6574; train_masked_gp_l1_reg_loss: 10102.9900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101900.3659; train_global_loss: 4252238.9907; train_optim_loss: 4252238.9907; val_kl_reg_loss: 74189.7878; val_edge_recon_loss: 118540.8151; val_gene_expr_recon_loss: 3591916.4583; val_masked_gp_l1_reg_loss: 9199.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95129.3906; val_global_loss: 3888976.3333; val_optim_loss: 3888976.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8563; val_auprc_score: 0.9708; val_best_acc_score: 0.8579; val_best_f1_score: 0.9229; train_kl_reg_loss: 70866.8799; train_edge_recon_loss: 119085.0386; train_gene_expr_recon_loss: 3125787.7685; train_masked_gp_l1_reg_loss: 8737.9408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89725.4860; train_global_loss: 3414203.0880; train_optim_loss: 3414203.0880; val_kl_reg_loss: 63051.1113; val_edge_recon_loss: 120828.5781; val_gene_expr_recon_loss: 2686437.4167; val_masked_gp_l1_reg_loss: 8396.8691; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84605.5000; val_global_loss: 2963319.3333; val_optim_loss: 2963319.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8408; val_auprc_score: 0.9675; val_best_acc_score: 0.8727; val_best_f1_score: 0.9298; train_kl_reg_loss: 61815.4526; train_edge_recon_loss: 118281.6170; train_gene_expr_recon_loss: 2478041.1111; train_masked_gp_l1_reg_loss: 8257.5495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80469.7795; train_global_loss: 2746865.5185; train_optim_loss: 2746865.5185; val_kl_reg_loss: 56254.2826; val_edge_recon_loss: 118250.2148; val_gene_expr_recon_loss: 2349965.4167; val_masked_gp_l1_reg_loss: 8188.5620; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76579.6406; val_global_loss: 2609238.1667; val_optim_loss: 2609238.1667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8436; val_auprc_score: 0.9672; val_best_acc_score: 0.8723; val_best_f1_score: 0.9300; train_kl_reg_loss: 54899.3049; train_edge_recon_loss: 117880.6247; train_gene_expr_recon_loss: 2305007.2315; train_masked_gp_l1_reg_loss: 8201.0016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73718.7679; train_global_loss: 2559706.9306; train_optim_loss: 2559706.9306; val_kl_reg_loss: 49719.0983; val_edge_recon_loss: 117757.2409; val_gene_expr_recon_loss: 2266931.8750; val_masked_gp_l1_reg_loss: 8237.3584; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71248.1328; val_global_loss: 2513893.6667; val_optim_loss: 2513893.6667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8494; val_auprc_score: 0.9679; val_best_acc_score: 0.8808; val_best_f1_score: 0.9345; train_kl_reg_loss: 48788.5122; train_edge_recon_loss: 116959.9783; train_gene_expr_recon_loss: 2247656.2222; train_masked_gp_l1_reg_loss: 8295.0718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69827.3597; train_global_loss: 2491527.1157; train_optim_loss: 2491527.1157; val_kl_reg_loss: 44546.2129; val_edge_recon_loss: 116199.3294; val_gene_expr_recon_loss: 2223621.6667; val_masked_gp_l1_reg_loss: 8377.2021; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68806.5938; val_global_loss: 2461550.9583; val_optim_loss: 2461550.9583
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8450; val_auprc_score: 0.9646; val_best_acc_score: 0.8739; val_best_f1_score: 0.9299; train_kl_reg_loss: 44240.3904; train_edge_recon_loss: 116115.3717; train_gene_expr_recon_loss: 2211987.0972; train_masked_gp_l1_reg_loss: 8491.0144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68094.6194; train_global_loss: 2448928.5000; train_optim_loss: 2448928.5000; val_kl_reg_loss: 40681.7585; val_edge_recon_loss: 121333.5755; val_gene_expr_recon_loss: 2193878.5833; val_masked_gp_l1_reg_loss: 8626.4424; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67354.5000; val_global_loss: 2431874.9167; val_optim_loss: 2431874.9167
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8590; val_auprc_score: 0.9699; val_best_acc_score: 0.8841; val_best_f1_score: 0.9355; train_kl_reg_loss: 40873.2208; train_edge_recon_loss: 114417.1709; train_gene_expr_recon_loss: 2182420.8519; train_masked_gp_l1_reg_loss: 8766.9498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66617.4178; train_global_loss: 2413095.6389; train_optim_loss: 2413095.6389; val_kl_reg_loss: 37931.2819; val_edge_recon_loss: 113985.1901; val_gene_expr_recon_loss: 2169037.9167; val_masked_gp_l1_reg_loss: 8915.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65837.9062; val_global_loss: 2395707.6250; val_optim_loss: 2395707.6250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8726; val_auprc_score: 0.9724; val_best_acc_score: 0.8813; val_best_f1_score: 0.9336; train_kl_reg_loss: 38291.8474; train_edge_recon_loss: 112523.3830; train_gene_expr_recon_loss: 2157479.6343; train_masked_gp_l1_reg_loss: 9054.5022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65062.5304; train_global_loss: 2382411.9028; train_optim_loss: 2382411.9028; val_kl_reg_loss: 35918.6335; val_edge_recon_loss: 116587.4258; val_gene_expr_recon_loss: 2144181.0833; val_masked_gp_l1_reg_loss: 9200.1777; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64246.8047; val_global_loss: 2370134.1667; val_optim_loss: 2370134.1667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8831; val_auprc_score: 0.9749; val_best_acc_score: 0.8889; val_best_f1_score: 0.9369; train_kl_reg_loss: 36279.6025; train_edge_recon_loss: 113492.6578; train_gene_expr_recon_loss: 2134841.3519; train_masked_gp_l1_reg_loss: 9333.7744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63444.2255; train_global_loss: 2357391.6157; train_optim_loss: 2357391.6157; val_kl_reg_loss: 34105.0547; val_edge_recon_loss: 113060.7279; val_gene_expr_recon_loss: 2121434.3333; val_masked_gp_l1_reg_loss: 9472.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62601.6328; val_global_loss: 2340674.6250; val_optim_loss: 2340674.6250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8906; val_auprc_score: 0.9769; val_best_acc_score: 0.8944; val_best_f1_score: 0.9402; train_kl_reg_loss: 34549.2418; train_edge_recon_loss: 111679.4573; train_gene_expr_recon_loss: 2114552.1991; train_masked_gp_l1_reg_loss: 9595.1276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61776.7579; train_global_loss: 2332152.7778; train_optim_loss: 2332152.7778; val_kl_reg_loss: 32649.2943; val_edge_recon_loss: 111350.4414; val_gene_expr_recon_loss: 2106360.9167; val_masked_gp_l1_reg_loss: 9724.9014; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60915.3047; val_global_loss: 2321000.8750; val_optim_loss: 2321000.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8928; val_auprc_score: 0.9772; val_best_acc_score: 0.8975; val_best_f1_score: 0.9414; train_kl_reg_loss: 33139.7673; train_edge_recon_loss: 111516.2527; train_gene_expr_recon_loss: 2096201.4792; train_masked_gp_l1_reg_loss: 9841.7120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60076.5908; train_global_loss: 2310775.8009; train_optim_loss: 2310775.8009; val_kl_reg_loss: 31466.7767; val_edge_recon_loss: 110530.9909; val_gene_expr_recon_loss: 2090051.9792; val_masked_gp_l1_reg_loss: 9969.2705; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59204.0820; val_global_loss: 2301222.9583; val_optim_loss: 2301222.9583
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8937; val_auprc_score: 0.9768; val_best_acc_score: 0.8996; val_best_f1_score: 0.9427; train_kl_reg_loss: 31963.6542; train_edge_recon_loss: 109655.5696; train_gene_expr_recon_loss: 2078820.4699; train_masked_gp_l1_reg_loss: 10080.2762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58361.5200; train_global_loss: 2288881.4815; train_optim_loss: 2288881.4815; val_kl_reg_loss: 30205.5033; val_edge_recon_loss: 110923.4427; val_gene_expr_recon_loss: 2065173.8542; val_masked_gp_l1_reg_loss: 10200.7588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57488.1445; val_global_loss: 2273991.7917; val_optim_loss: 2273991.7917
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8988; val_auprc_score: 0.9791; val_best_acc_score: 0.9019; val_best_f1_score: 0.9442; train_kl_reg_loss: 31013.5380; train_edge_recon_loss: 109145.9413; train_gene_expr_recon_loss: 2062656.8542; train_masked_gp_l1_reg_loss: 10317.5478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56649.5088; train_global_loss: 2269783.3981; train_optim_loss: 2269783.3981; val_kl_reg_loss: 29514.4196; val_edge_recon_loss: 108570.3841; val_gene_expr_recon_loss: 2056285.9583; val_masked_gp_l1_reg_loss: 10440.9482; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55785.1250; val_global_loss: 2260596.9167; val_optim_loss: 2260596.9167
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9022; val_auprc_score: 0.9779; val_best_acc_score: 0.9022; val_best_f1_score: 0.9440; train_kl_reg_loss: 30212.8130; train_edge_recon_loss: 107466.8268; train_gene_expr_recon_loss: 2046589.0046; train_masked_gp_l1_reg_loss: 10551.8247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54957.8032; train_global_loss: 2249778.2824; train_optim_loss: 2249778.2824; val_kl_reg_loss: 28590.5081; val_edge_recon_loss: 112329.9779; val_gene_expr_recon_loss: 2039067.1667; val_masked_gp_l1_reg_loss: 10674.4512; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54107.0625; val_global_loss: 2244769.1250; val_optim_loss: 2244769.1250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9066; val_auprc_score: 0.9790; val_best_acc_score: 0.9089; val_best_f1_score: 0.9476; train_kl_reg_loss: 29560.7996; train_edge_recon_loss: 106268.9873; train_gene_expr_recon_loss: 2031467.5787; train_masked_gp_l1_reg_loss: 10779.2854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53296.1591; train_global_loss: 2231372.8194; train_optim_loss: 2231372.8194; val_kl_reg_loss: 28231.8564; val_edge_recon_loss: 108712.1888; val_gene_expr_recon_loss: 2022271.7292; val_masked_gp_l1_reg_loss: 10893.5918; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52463.7422; val_global_loss: 2222573.0833; val_optim_loss: 2222573.0833
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9118; val_auprc_score: 0.9809; val_best_acc_score: 0.9120; val_best_f1_score: 0.9497; train_kl_reg_loss: 28918.0962; train_edge_recon_loss: 105007.7729; train_gene_expr_recon_loss: 2016631.8495; train_masked_gp_l1_reg_loss: 10997.0983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51672.7991; train_global_loss: 2213227.6065; train_optim_loss: 2213227.6065; val_kl_reg_loss: 27688.5495; val_edge_recon_loss: 108154.6836; val_gene_expr_recon_loss: 2005408.8542; val_masked_gp_l1_reg_loss: 11109.6436; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50859.5938; val_global_loss: 2203221.4167; val_optim_loss: 2203221.4167
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9148; val_auprc_score: 0.9816; val_best_acc_score: 0.9124; val_best_f1_score: 0.9496; train_kl_reg_loss: 28399.9206; train_edge_recon_loss: 104742.5686; train_gene_expr_recon_loss: 2002099.0023; train_masked_gp_l1_reg_loss: 11211.3063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50091.4785; train_global_loss: 2196544.2870; train_optim_loss: 2196544.2870; val_kl_reg_loss: 27010.5967; val_edge_recon_loss: 108321.4505; val_gene_expr_recon_loss: 1995642.3958; val_masked_gp_l1_reg_loss: 11321.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49299.3594; val_global_loss: 2191594.9583; val_optim_loss: 2191594.9583
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9117; val_auprc_score: 0.9808; val_best_acc_score: 0.9126; val_best_f1_score: 0.9498; train_kl_reg_loss: 27866.8934; train_edge_recon_loss: 104703.1133; train_gene_expr_recon_loss: 1988820.4514; train_masked_gp_l1_reg_loss: 11423.1982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48549.3350; train_global_loss: 2181362.9861; train_optim_loss: 2181362.9861; val_kl_reg_loss: 26532.4577; val_edge_recon_loss: 107321.0885; val_gene_expr_recon_loss: 1981465.4583; val_masked_gp_l1_reg_loss: 11531.4746; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47779.3789; val_global_loss: 2174630.0417; val_optim_loss: 2174630.0417
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9222; val_auprc_score: 0.9834; val_best_acc_score: 0.9168; val_best_f1_score: 0.9523; train_kl_reg_loss: 27341.7448; train_edge_recon_loss: 103726.3831; train_gene_expr_recon_loss: 1975583.4514; train_masked_gp_l1_reg_loss: 11625.0094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47046.5009; train_global_loss: 2165323.0926; train_optim_loss: 2165323.0926; val_kl_reg_loss: 26109.9215; val_edge_recon_loss: 105770.5469; val_gene_expr_recon_loss: 1965007.8958; val_masked_gp_l1_reg_loss: 11727.0420; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46298.0156; val_global_loss: 2154913.3750; val_optim_loss: 2154913.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9228; val_auprc_score: 0.9821; val_best_acc_score: 0.9203; val_best_f1_score: 0.9540; train_kl_reg_loss: 26947.7361; train_edge_recon_loss: 102290.1348; train_gene_expr_recon_loss: 1962899.5926; train_masked_gp_l1_reg_loss: 11819.7748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45586.7717; train_global_loss: 2149543.9954; train_optim_loss: 2149543.9954; val_kl_reg_loss: 25801.3805; val_edge_recon_loss: 106437.6615; val_gene_expr_recon_loss: 1957709.6667; val_masked_gp_l1_reg_loss: 11920.2168; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44856.4297; val_global_loss: 2146725.4167; val_optim_loss: 2146725.4167
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9206; val_auprc_score: 0.9828; val_best_acc_score: 0.9197; val_best_f1_score: 0.9539; train_kl_reg_loss: 26524.4823; train_edge_recon_loss: 101969.0305; train_gene_expr_recon_loss: 1950690.0579; train_masked_gp_l1_reg_loss: 12008.5347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44172.4672; train_global_loss: 2135364.5787; train_optim_loss: 2135364.5787; val_kl_reg_loss: 25496.6071; val_edge_recon_loss: 103619.3984; val_gene_expr_recon_loss: 1945760.4375; val_masked_gp_l1_reg_loss: 12105.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43471.5039; val_global_loss: 2130453.2500; val_optim_loss: 2130453.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9265; val_auprc_score: 0.9845; val_best_acc_score: 0.9208; val_best_f1_score: 0.9547; train_kl_reg_loss: 26077.1071; train_edge_recon_loss: 102281.2678; train_gene_expr_recon_loss: 1938606.3472; train_masked_gp_l1_reg_loss: 12190.9904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42809.0116; train_global_loss: 2121964.7130; train_optim_loss: 2121964.7130; val_kl_reg_loss: 25130.1901; val_edge_recon_loss: 101722.1719; val_gene_expr_recon_loss: 1933658.8750; val_masked_gp_l1_reg_loss: 12282.1738; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42129.7969; val_global_loss: 2114923.2083; val_optim_loss: 2114923.2083
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9282; val_auprc_score: 0.9846; val_best_acc_score: 0.9222; val_best_f1_score: 0.9554; train_kl_reg_loss: 25709.1948; train_edge_recon_loss: 100746.0012; train_gene_expr_recon_loss: 1927580.1644; train_masked_gp_l1_reg_loss: 12362.4011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41490.5952; train_global_loss: 2107888.3472; train_optim_loss: 2107888.3472; val_kl_reg_loss: 24558.8141; val_edge_recon_loss: 102519.3060; val_gene_expr_recon_loss: 1920795.9792; val_masked_gp_l1_reg_loss: 12452.1504; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40836.8320; val_global_loss: 2101163.0833; val_optim_loss: 2101163.0833
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9301; val_auprc_score: 0.9849; val_best_acc_score: 0.9256; val_best_f1_score: 0.9572; train_kl_reg_loss: 25251.7269; train_edge_recon_loss: 99432.0644; train_gene_expr_recon_loss: 1916551.4468; train_masked_gp_l1_reg_loss: 12529.9435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40220.9420; train_global_loss: 2093986.1111; train_optim_loss: 2093986.1111; val_kl_reg_loss: 24112.3034; val_edge_recon_loss: 100263.7578; val_gene_expr_recon_loss: 1910619.8333; val_masked_gp_l1_reg_loss: 12620.1123; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39593.4219; val_global_loss: 2087209.3958; val_optim_loss: 2087209.3958
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9109; val_auprc_score: 0.9797; val_best_acc_score: 0.9124; val_best_f1_score: 0.9496; train_kl_reg_loss: 20332.4525; train_edge_recon_loss: 110101.4162; train_gene_expr_recon_loss: 3545243.3796; train_masked_gp_l1_reg_loss: 14981.6712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38673.7321; train_global_loss: 3729332.6620; train_optim_loss: 3729332.6620; val_kl_reg_loss: 20432.1380; val_edge_recon_loss: 113234.1888; val_gene_expr_recon_loss: 3176029.0417; val_masked_gp_l1_reg_loss: 15236.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37641.1797; val_global_loss: 3362573.1250; val_optim_loss: 3362573.1250
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9170; val_auprc_score: 0.9818; val_best_acc_score: 0.9143; val_best_f1_score: 0.9509; train_kl_reg_loss: 22283.0117; train_edge_recon_loss: 108246.2581; train_gene_expr_recon_loss: 2949960.9630; train_masked_gp_l1_reg_loss: 15045.1631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36661.0258; train_global_loss: 3132196.4444; train_optim_loss: 3132196.4444; val_kl_reg_loss: 20206.8171; val_edge_recon_loss: 108876.0755; val_gene_expr_recon_loss: 2747731.7917; val_masked_gp_l1_reg_loss: 14930.4600; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35661.2812; val_global_loss: 2927406.4583; val_optim_loss: 2927406.4583
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9237; val_auprc_score: 0.9837; val_best_acc_score: 0.9168; val_best_f1_score: 0.9524; train_kl_reg_loss: 21807.7238; train_edge_recon_loss: 103238.1341; train_gene_expr_recon_loss: 2594299.7778; train_masked_gp_l1_reg_loss: 14893.8216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34732.0237; train_global_loss: 2768971.4630; train_optim_loss: 2768971.4630; val_kl_reg_loss: 19646.8975; val_edge_recon_loss: 104617.8464; val_gene_expr_recon_loss: 2460287.1250; val_masked_gp_l1_reg_loss: 14869.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33784.7266; val_global_loss: 2633206.6250; val_optim_loss: 2633206.6250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9180; val_auprc_score: 0.9822; val_best_acc_score: 0.9197; val_best_f1_score: 0.9540; train_kl_reg_loss: 21078.9102; train_edge_recon_loss: 101462.6795; train_gene_expr_recon_loss: 2367176.9444; train_masked_gp_l1_reg_loss: 14865.0188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32902.8453; train_global_loss: 2537486.3935; train_optim_loss: 2537486.3935; val_kl_reg_loss: 18617.5931; val_edge_recon_loss: 100823.3346; val_gene_expr_recon_loss: 2282987.1667; val_masked_gp_l1_reg_loss: 14862.1621; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32003.4805; val_global_loss: 2449293.8333; val_optim_loss: 2449293.8333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9152; val_auprc_score: 0.9812; val_best_acc_score: 0.9195; val_best_f1_score: 0.9539; train_kl_reg_loss: 20567.8371; train_edge_recon_loss: 100068.1644; train_gene_expr_recon_loss: 2277302.6065; train_masked_gp_l1_reg_loss: 14813.2435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31880.2577; train_global_loss: 2444632.1019; train_optim_loss: 2444632.1019; val_kl_reg_loss: 18589.9053; val_edge_recon_loss: 100617.1198; val_gene_expr_recon_loss: 2275336.8333; val_masked_gp_l1_reg_loss: 14801.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31782.3203; val_global_loss: 2441127.3750; val_optim_loss: 2441127.3750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9228; val_auprc_score: 0.9828; val_best_acc_score: 0.9214; val_best_f1_score: 0.9547; train_kl_reg_loss: 20480.2515; train_edge_recon_loss: 99167.0294; train_gene_expr_recon_loss: 2263910.0231; train_masked_gp_l1_reg_loss: 14799.7086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31694.3475; train_global_loss: 2430051.3796; train_optim_loss: 2430051.3796; val_kl_reg_loss: 18547.9775; val_edge_recon_loss: 100059.4544; val_gene_expr_recon_loss: 2257702.8750; val_masked_gp_l1_reg_loss: 14799.8008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31602.7148; val_global_loss: 2422712.8750; val_optim_loss: 2422712.8750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9217; val_auprc_score: 0.9828; val_best_acc_score: 0.9206; val_best_f1_score: 0.9542; train_kl_reg_loss: 20373.0604; train_edge_recon_loss: 99740.7477; train_gene_expr_recon_loss: 2252261.8704; train_masked_gp_l1_reg_loss: 14799.5473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31513.2349; train_global_loss: 2418688.4491; train_optim_loss: 2418688.4491; val_kl_reg_loss: 18494.3496; val_edge_recon_loss: 100509.8945; val_gene_expr_recon_loss: 2244670.2083; val_masked_gp_l1_reg_loss: 14799.9717; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31419.7656; val_global_loss: 2409894.1667; val_optim_loss: 2409894.1667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9320; val_auprc_score: 0.9856; val_best_acc_score: 0.9216; val_best_f1_score: 0.9550; train_kl_reg_loss: 20270.5352; train_edge_recon_loss: 98942.8254; train_gene_expr_recon_loss: 2240231.0694; train_masked_gp_l1_reg_loss: 14800.0435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31328.2097; train_global_loss: 2405572.6759; train_optim_loss: 2405572.6759; val_kl_reg_loss: 18355.7591; val_edge_recon_loss: 100047.7930; val_gene_expr_recon_loss: 2231596.7083; val_masked_gp_l1_reg_loss: 14800.4541; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31232.5156; val_global_loss: 2396033.2917; val_optim_loss: 2396033.2917

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 24 min 2 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9281
val AUPRC score: 0.9840
val best accuracy score: 0.9252
val best F1 score: 0.9571
val target rna MSE score: 23.8951
val source rna MSE score: 134.5839
Val cat covariate0 mean sim diff: -0.0026

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
