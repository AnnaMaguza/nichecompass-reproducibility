[True]
Run timestamp: 08082023_030056_60.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_60']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5399 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 5399, n_cat_covariates_embed_input: 0, n_hidden: 1847, n_latent: 1797, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9068; val_auprc_score: 0.9816; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 202700.6524; train_edge_recon_loss: 117668.8240; train_gene_expr_recon_loss: 3830242.9375; train_masked_gp_l1_reg_loss: 20070.4417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176397.6818; train_global_loss: 4347080.5168; train_optim_loss: 4347080.5168; val_kl_reg_loss: 156934.7448; val_edge_recon_loss: 119048.9642; val_gene_expr_recon_loss: 3052096.1042; val_masked_gp_l1_reg_loss: 19042.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167933.0312; val_global_loss: 3515054.8333; val_optim_loss: 3515054.8333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8830; val_auprc_score: 0.9750; val_best_acc_score: 0.8860; val_best_f1_score: 0.9371; train_kl_reg_loss: 122755.8151; train_edge_recon_loss: 119307.9170; train_gene_expr_recon_loss: 2972686.9639; train_masked_gp_l1_reg_loss: 17761.8883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156413.9680; train_global_loss: 3388926.5601; train_optim_loss: 3388926.5601; val_kl_reg_loss: 98871.6927; val_edge_recon_loss: 120123.7604; val_gene_expr_recon_loss: 2902524.6875; val_masked_gp_l1_reg_loss: 16692.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144210.2188; val_global_loss: 3282422.6458; val_optim_loss: 3282422.6458
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8846; val_auprc_score: 0.9751; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 565033.2446; train_edge_recon_loss: 118196.8931; train_gene_expr_recon_loss: 9455742.0385; train_masked_gp_l1_reg_loss: 16219.0655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132708.5634; train_global_loss: 10287899.6659; train_optim_loss: 10287899.6659; val_kl_reg_loss: 13703341.1667; val_edge_recon_loss: 118997.0169; val_gene_expr_recon_loss: 8406881.7083; val_masked_gp_l1_reg_loss: 18385.1035; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127576.6250; val_global_loss: 22375182.0000; val_optim_loss: 22375182.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8794; val_auprc_score: 0.9749; val_best_acc_score: 0.8551; val_best_f1_score: 0.9219; train_kl_reg_loss: 687855.4180; train_edge_recon_loss: 119200.4738; train_gene_expr_recon_loss: 7771419.4976; train_masked_gp_l1_reg_loss: 20239.5685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119045.9411; train_global_loss: 8717760.9014; train_optim_loss: 8717760.9014; val_kl_reg_loss: 324700.3438; val_edge_recon_loss: 117902.7402; val_gene_expr_recon_loss: 3611065.3750; val_masked_gp_l1_reg_loss: 19547.8457; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110182.1953; val_global_loss: 4183398.4792; val_optim_loss: 4183398.4792
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8817; val_auprc_score: 0.9750; val_best_acc_score: 0.8572; val_best_f1_score: 0.9229; train_kl_reg_loss: 260680.9908; train_edge_recon_loss: 119112.2906; train_gene_expr_recon_loss: 3606805.2139; train_masked_gp_l1_reg_loss: 19013.5603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104104.8241; train_global_loss: 4109716.8822; train_optim_loss: 4109716.8822; val_kl_reg_loss: 211407.0938; val_edge_recon_loss: 118125.3867; val_gene_expr_recon_loss: 3457848.5417; val_masked_gp_l1_reg_loss: 18523.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98326.0859; val_global_loss: 3904231.0208; val_optim_loss: 3904231.0208
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8779; val_auprc_score: 0.9734; val_best_acc_score: 0.8607; val_best_f1_score: 0.9243; train_kl_reg_loss: 179263.0053; train_edge_recon_loss: 119451.9339; train_gene_expr_recon_loss: 3435265.3726; train_masked_gp_l1_reg_loss: 18185.2555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93679.6170; train_global_loss: 3845845.1635; train_optim_loss: 3845845.1635; val_kl_reg_loss: 149014.6172; val_edge_recon_loss: 121548.8691; val_gene_expr_recon_loss: 3408300.0833; val_masked_gp_l1_reg_loss: 17906.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89296.1719; val_global_loss: 3786066.0417; val_optim_loss: 3786066.0417
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8760; val_auprc_score: 0.9732; val_best_acc_score: 0.8706; val_best_f1_score: 0.9295; train_kl_reg_loss: 138528.3196; train_edge_recon_loss: 119079.7486; train_gene_expr_recon_loss: 3216055.2548; train_masked_gp_l1_reg_loss: 17797.8811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85575.8969; train_global_loss: 3577037.0865; train_optim_loss: 3577037.0865; val_kl_reg_loss: 119038.2363; val_edge_recon_loss: 119129.1035; val_gene_expr_recon_loss: 2994251.0833; val_masked_gp_l1_reg_loss: 17731.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82126.2891; val_global_loss: 3332276.6667; val_optim_loss: 3332276.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8799; val_auprc_score: 0.9750; val_best_acc_score: 0.8575; val_best_f1_score: 0.9230; train_kl_reg_loss: 140862.0163; train_edge_recon_loss: 119020.5620; train_gene_expr_recon_loss: 3083997.2019; train_masked_gp_l1_reg_loss: 17641.1578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79138.1881; train_global_loss: 3440659.1346; train_optim_loss: 3440659.1346; val_kl_reg_loss: 191757.1341; val_edge_recon_loss: 118806.7513; val_gene_expr_recon_loss: 2803873.2083; val_masked_gp_l1_reg_loss: 17476.7637; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75938.6172; val_global_loss: 3207852.3333; val_optim_loss: 3207852.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8768; val_auprc_score: 0.9743; val_best_acc_score: 0.8651; val_best_f1_score: 0.9268; train_kl_reg_loss: 161889.0664; train_edge_recon_loss: 119457.4028; train_gene_expr_recon_loss: 2758120.4327; train_masked_gp_l1_reg_loss: 17295.8719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73610.0113; train_global_loss: 3130372.7837; train_optim_loss: 3130372.7837; val_kl_reg_loss: 135025.5352; val_edge_recon_loss: 118405.8359; val_gene_expr_recon_loss: 2722714.8333; val_masked_gp_l1_reg_loss: 17179.2129; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71388.7031; val_global_loss: 3064714.2083; val_optim_loss: 3064714.2083
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8751; val_auprc_score: 0.9738; val_best_acc_score: 0.8750; val_best_f1_score: 0.9318; train_kl_reg_loss: 119251.4804; train_edge_recon_loss: 119349.6016; train_gene_expr_recon_loss: 2646971.5144; train_masked_gp_l1_reg_loss: 17312.7964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69347.6855; train_global_loss: 2972233.0625; train_optim_loss: 2972233.0625; val_kl_reg_loss: 103156.0814; val_edge_recon_loss: 118106.0423; val_gene_expr_recon_loss: 2598020.2292; val_masked_gp_l1_reg_loss: 17377.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67313.0859; val_global_loss: 2903972.5625; val_optim_loss: 2903972.5625
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8751; val_auprc_score: 0.9733; val_best_acc_score: 0.8797; val_best_f1_score: 0.9339; train_kl_reg_loss: 95768.4132; train_edge_recon_loss: 118924.5889; train_gene_expr_recon_loss: 2577925.2764; train_masked_gp_l1_reg_loss: 17383.0752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65387.0441; train_global_loss: 2875388.4062; train_optim_loss: 2875388.4062; val_kl_reg_loss: 86154.8724; val_edge_recon_loss: 119701.1152; val_gene_expr_recon_loss: 2526745.4375; val_masked_gp_l1_reg_loss: 17370.8027; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63478.7422; val_global_loss: 2813450.9375; val_optim_loss: 2813450.9375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8724; val_auprc_score: 0.9719; val_best_acc_score: 0.8847; val_best_f1_score: 0.9362; train_kl_reg_loss: 79907.7025; train_edge_recon_loss: 119577.4316; train_gene_expr_recon_loss: 2514827.1851; train_masked_gp_l1_reg_loss: 17399.6070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61749.9097; train_global_loss: 2793461.8341; train_optim_loss: 2793461.8341; val_kl_reg_loss: 72288.7357; val_edge_recon_loss: 120825.6908; val_gene_expr_recon_loss: 2492830.2708; val_masked_gp_l1_reg_loss: 17543.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60021.6094; val_global_loss: 2763509.3958; val_optim_loss: 2763509.3958
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8728; val_auprc_score: 0.9718; val_best_acc_score: 0.8904; val_best_f1_score: 0.9390; train_kl_reg_loss: 67744.4253; train_edge_recon_loss: 118478.7827; train_gene_expr_recon_loss: 2485176.8053; train_masked_gp_l1_reg_loss: 17531.4761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58429.0024; train_global_loss: 2747360.5144; train_optim_loss: 2747360.5144; val_kl_reg_loss: 62370.0557; val_edge_recon_loss: 118726.0553; val_gene_expr_recon_loss: 2466359.7917; val_masked_gp_l1_reg_loss: 17521.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56879.8789; val_global_loss: 2721856.9167; val_optim_loss: 2721856.9167
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8780; val_auprc_score: 0.9735; val_best_acc_score: 0.8955; val_best_f1_score: 0.9413; train_kl_reg_loss: 59611.6345; train_edge_recon_loss: 118432.6889; train_gene_expr_recon_loss: 2452275.3101; train_masked_gp_l1_reg_loss: 17523.6215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55471.8530; train_global_loss: 2703315.1130; train_optim_loss: 2703315.1130; val_kl_reg_loss: 55776.2266; val_edge_recon_loss: 118182.1061; val_gene_expr_recon_loss: 2431392.8542; val_masked_gp_l1_reg_loss: 17528.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54080.9375; val_global_loss: 2676960.6875; val_optim_loss: 2676960.6875
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8802; val_auprc_score: 0.9738; val_best_acc_score: 0.8965; val_best_f1_score: 0.9412; train_kl_reg_loss: 53917.3765; train_edge_recon_loss: 118060.4016; train_gene_expr_recon_loss: 2425113.6442; train_masked_gp_l1_reg_loss: 17517.8878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52784.1337; train_global_loss: 2667393.4471; train_optim_loss: 2667393.4471; val_kl_reg_loss: 50917.1510; val_edge_recon_loss: 118118.6608; val_gene_expr_recon_loss: 2411630.5000; val_masked_gp_l1_reg_loss: 17504.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51513.5859; val_global_loss: 2649683.8125; val_optim_loss: 2649683.8125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8843; val_auprc_score: 0.9746; val_best_acc_score: 0.8957; val_best_f1_score: 0.9401; train_kl_reg_loss: 49345.9158; train_edge_recon_loss: 117778.7527; train_gene_expr_recon_loss: 2401751.1683; train_masked_gp_l1_reg_loss: 17501.3872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50343.0285; train_global_loss: 2636720.2837; train_optim_loss: 2636720.2837; val_kl_reg_loss: 46756.3506; val_edge_recon_loss: 118705.9805; val_gene_expr_recon_loss: 2385959.3750; val_masked_gp_l1_reg_loss: 17496.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49194.6289; val_global_loss: 2618112.6667; val_optim_loss: 2618112.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8827; val_auprc_score: 0.9739; val_best_acc_score: 0.8909; val_best_f1_score: 0.9369; train_kl_reg_loss: 45211.2536; train_edge_recon_loss: 116803.7233; train_gene_expr_recon_loss: 2356985.0120; train_masked_gp_l1_reg_loss: 17492.9740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48129.0172; train_global_loss: 2584621.9712; train_optim_loss: 2584621.9712; val_kl_reg_loss: 42725.1061; val_edge_recon_loss: 118137.4225; val_gene_expr_recon_loss: 2322834.9583; val_masked_gp_l1_reg_loss: 17498.6152; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47087.8477; val_global_loss: 2548283.7083; val_optim_loss: 2548283.7083
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8862; val_auprc_score: 0.9747; val_best_acc_score: 0.8933; val_best_f1_score: 0.9410; train_kl_reg_loss: 41948.7538; train_edge_recon_loss: 115985.8192; train_gene_expr_recon_loss: 2316452.0505; train_masked_gp_l1_reg_loss: 17468.2442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46103.3132; train_global_loss: 2537958.1587; train_optim_loss: 2537958.1587; val_kl_reg_loss: 40105.7142; val_edge_recon_loss: 117648.7708; val_gene_expr_recon_loss: 2304542.4583; val_masked_gp_l1_reg_loss: 17436.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45141.4922; val_global_loss: 2524875.2292; val_optim_loss: 2524875.2292
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8868; val_auprc_score: 0.9744; val_best_acc_score: 0.9020; val_best_f1_score: 0.9452; train_kl_reg_loss: 39259.6248; train_edge_recon_loss: 115927.1982; train_gene_expr_recon_loss: 2293920.2837; train_masked_gp_l1_reg_loss: 17422.2311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44250.2104; train_global_loss: 2510779.5385; train_optim_loss: 2510779.5385; val_kl_reg_loss: 37763.6722; val_edge_recon_loss: 116740.7656; val_gene_expr_recon_loss: 2282898.1458; val_masked_gp_l1_reg_loss: 17388.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43371.8047; val_global_loss: 2498162.8542; val_optim_loss: 2498162.8542
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8860; val_auprc_score: 0.9740; val_best_acc_score: 0.9072; val_best_f1_score: 0.9474; train_kl_reg_loss: 36977.1349; train_edge_recon_loss: 114906.8375; train_gene_expr_recon_loss: 2275856.3317; train_masked_gp_l1_reg_loss: 17349.8696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42546.9722; train_global_loss: 2487637.1514; train_optim_loss: 2487637.1514; val_kl_reg_loss: 35267.6683; val_edge_recon_loss: 115521.7181; val_gene_expr_recon_loss: 2263371.8333; val_masked_gp_l1_reg_loss: 17319.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41746.6094; val_global_loss: 2473226.7292; val_optim_loss: 2473226.7292
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8851; val_auprc_score: 0.9737; val_best_acc_score: 0.9079; val_best_f1_score: 0.9482; train_kl_reg_loss: 34742.4583; train_edge_recon_loss: 113209.1436; train_gene_expr_recon_loss: 2200455.2115; train_masked_gp_l1_reg_loss: 17381.7923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41120.7340; train_global_loss: 2406909.3438; train_optim_loss: 2406909.3438; val_kl_reg_loss: 34555.8916; val_edge_recon_loss: 115055.3906; val_gene_expr_recon_loss: 2052379.4271; val_masked_gp_l1_reg_loss: 17618.9434; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40606.9531; val_global_loss: 2260216.7083; val_optim_loss: 2260216.7083
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8903; val_auprc_score: 0.9747; val_best_acc_score: 0.9116; val_best_f1_score: 0.9497; train_kl_reg_loss: 33035.9585; train_edge_recon_loss: 112155.3162; train_gene_expr_recon_loss: 2014868.8341; train_masked_gp_l1_reg_loss: 17597.7476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39834.6742; train_global_loss: 2217492.5433; train_optim_loss: 2217492.5433; val_kl_reg_loss: 31490.0267; val_edge_recon_loss: 113423.8034; val_gene_expr_recon_loss: 2000388.5312; val_masked_gp_l1_reg_loss: 17513.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39086.1211; val_global_loss: 2201902.0625; val_optim_loss: 2201902.0625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8898; val_auprc_score: 0.9736; val_best_acc_score: 0.9133; val_best_f1_score: 0.9508; train_kl_reg_loss: 30561.9105; train_edge_recon_loss: 110126.7761; train_gene_expr_recon_loss: 1992183.6707; train_masked_gp_l1_reg_loss: 17435.7848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38402.4937; train_global_loss: 2188710.6250; train_optim_loss: 2188710.6250; val_kl_reg_loss: 28925.6377; val_edge_recon_loss: 111745.8945; val_gene_expr_recon_loss: 1983071.5417; val_masked_gp_l1_reg_loss: 17346.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37735.5312; val_global_loss: 2178825.0417; val_optim_loss: 2178825.0417
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8987; val_auprc_score: 0.9760; val_best_acc_score: 0.9156; val_best_f1_score: 0.9521; train_kl_reg_loss: 28397.4277; train_edge_recon_loss: 109277.8713; train_gene_expr_recon_loss: 1930826.6502; train_masked_gp_l1_reg_loss: 17335.5390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37126.0603; train_global_loss: 2122963.5421; train_optim_loss: 2122963.5421; val_kl_reg_loss: 27041.2469; val_edge_recon_loss: 111422.7819; val_gene_expr_recon_loss: 1908840.9062; val_masked_gp_l1_reg_loss: 17264.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36493.0547; val_global_loss: 2101062.1146; val_optim_loss: 2101062.1146
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8954; val_auprc_score: 0.9746; val_best_acc_score: 0.9161; val_best_f1_score: 0.9520; train_kl_reg_loss: 26407.6165; train_edge_recon_loss: 107239.1591; train_gene_expr_recon_loss: 1901885.1418; train_masked_gp_l1_reg_loss: 17116.0170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35860.7407; train_global_loss: 2088508.6803; train_optim_loss: 2088508.6803; val_kl_reg_loss: 25162.5771; val_edge_recon_loss: 110282.3913; val_gene_expr_recon_loss: 1892856.8333; val_masked_gp_l1_reg_loss: 16955.4277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35227.8047; val_global_loss: 2080484.9271; val_optim_loss: 2080484.9271
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8982; val_auprc_score: 0.9762; val_best_acc_score: 0.8970; val_best_f1_score: 0.9425; train_kl_reg_loss: 22155.9847; train_edge_recon_loss: 117180.7386; train_gene_expr_recon_loss: 2989679.4471; train_masked_gp_l1_reg_loss: 18489.4792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32889.9927; train_global_loss: 3180395.6418; train_optim_loss: 3180395.6418; val_kl_reg_loss: 10822.3093; val_edge_recon_loss: 122355.2135; val_gene_expr_recon_loss: 2320632.5625; val_masked_gp_l1_reg_loss: 18543.3301; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30535.9199; val_global_loss: 2502889.3333; val_optim_loss: 2502889.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8868; val_auprc_score: 0.9749; val_best_acc_score: 0.9070; val_best_f1_score: 0.9473; train_kl_reg_loss: 12592.8392; train_edge_recon_loss: 119047.8238; train_gene_expr_recon_loss: 2170447.5048; train_masked_gp_l1_reg_loss: 17978.0018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28712.6364; train_global_loss: 2348778.7981; train_optim_loss: 2348778.7981; val_kl_reg_loss: 7500.5649; val_edge_recon_loss: 117204.5951; val_gene_expr_recon_loss: 2074901.9271; val_masked_gp_l1_reg_loss: 17384.5840; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27059.8262; val_global_loss: 2244051.3333; val_optim_loss: 2244051.3333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8838; val_auprc_score: 0.9732; val_best_acc_score: 0.8961; val_best_f1_score: 0.9396; train_kl_reg_loss: 9391.2882; train_edge_recon_loss: 117290.9946; train_gene_expr_recon_loss: 2034291.2007; train_masked_gp_l1_reg_loss: 16816.8750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25743.4415; train_global_loss: 2203533.7933; train_optim_loss: 2203533.7933; val_kl_reg_loss: 6332.1123; val_edge_recon_loss: 118434.7305; val_gene_expr_recon_loss: 2000964.8125; val_masked_gp_l1_reg_loss: 16265.7949; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24516.1230; val_global_loss: 2166513.3958; val_optim_loss: 2166513.3958
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8770; val_auprc_score: 0.9714; val_best_acc_score: 0.8951; val_best_f1_score: 0.9414; train_kl_reg_loss: 7814.4555; train_edge_recon_loss: 116799.4359; train_gene_expr_recon_loss: 1984892.7031; train_masked_gp_l1_reg_loss: 15727.9206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23483.2706; train_global_loss: 2148717.7957; train_optim_loss: 2148717.7957; val_kl_reg_loss: 5655.4690; val_edge_recon_loss: 119053.8737; val_gene_expr_recon_loss: 1967601.8021; val_masked_gp_l1_reg_loss: 15190.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22499.8633; val_global_loss: 2130001.3542; val_optim_loss: 2130001.3542

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8776; val_auprc_score: 0.9717; val_best_acc_score: 0.8978; val_best_f1_score: 0.9428; train_kl_reg_loss: 7151.2085; train_edge_recon_loss: 117253.7130; train_gene_expr_recon_loss: 1967362.3005; train_masked_gp_l1_reg_loss: 15091.0723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22305.1744; train_global_loss: 2129163.4736; train_optim_loss: 2129163.4736; val_kl_reg_loss: 5499.7239; val_edge_recon_loss: 117336.7533; val_gene_expr_recon_loss: 1965475.9792; val_masked_gp_l1_reg_loss: 15034.0371; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22201.2324; val_global_loss: 2125547.7500; val_optim_loss: 2125547.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8757; val_auprc_score: 0.9712; val_best_acc_score: 0.9015; val_best_f1_score: 0.9448; train_kl_reg_loss: 6977.1762; train_edge_recon_loss: 116591.6965; train_gene_expr_recon_loss: 1965044.8281; train_masked_gp_l1_reg_loss: 14981.9757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22108.4783; train_global_loss: 2125704.1611; train_optim_loss: 2125704.1611; val_kl_reg_loss: 5379.9602; val_edge_recon_loss: 116016.6751; val_gene_expr_recon_loss: 1961675.6146; val_masked_gp_l1_reg_loss: 14928.3838; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22012.7070; val_global_loss: 2120013.3750; val_optim_loss: 2120013.3750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8782; val_auprc_score: 0.9720; val_best_acc_score: 0.9007; val_best_f1_score: 0.9442; train_kl_reg_loss: 6812.3187; train_edge_recon_loss: 116896.9396; train_gene_expr_recon_loss: 1962681.8930; train_masked_gp_l1_reg_loss: 14875.3439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21917.8698; train_global_loss: 2123184.3678; train_optim_loss: 2123184.3678; val_kl_reg_loss: 5270.6818; val_edge_recon_loss: 116640.4740; val_gene_expr_recon_loss: 1958900.1771; val_masked_gp_l1_reg_loss: 14820.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21820.3613; val_global_loss: 2117452.0938; val_optim_loss: 2117452.0938
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8778; val_auprc_score: 0.9714; val_best_acc_score: 0.9014; val_best_f1_score: 0.9445; train_kl_reg_loss: 6657.3374; train_edge_recon_loss: 116195.0696; train_gene_expr_recon_loss: 1960381.6094; train_masked_gp_l1_reg_loss: 14765.6354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21723.0274; train_global_loss: 2119722.6911; train_optim_loss: 2119722.6911; val_kl_reg_loss: 5140.5893; val_edge_recon_loss: 117059.4089; val_gene_expr_recon_loss: 1959539.8438; val_masked_gp_l1_reg_loss: 14709.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21623.2344; val_global_loss: 2118072.0833; val_optim_loss: 2118072.0833

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 93 min 18 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8964
val AUPRC score: 0.9751
val best accuracy score: 0.9157
val best F1 score: 0.9522
val target rna MSE score: 21.7097
val source rna MSE score: 140.4097
Val cat covariate0 mean sim diff: -0.0023

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
