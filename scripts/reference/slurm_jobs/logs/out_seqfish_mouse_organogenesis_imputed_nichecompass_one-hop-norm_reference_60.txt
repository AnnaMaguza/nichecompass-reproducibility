[True]
Run timestamp: 26072023_223128_60.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_60']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8635; val_auprc_score: 0.9734; val_best_acc_score: 0.8529; val_best_f1_score: 0.9205; train_kl_reg_loss: 101162.4676; train_edge_recon_loss: 1092874.9846; train_gene_expr_recon_loss: 1746129.8047; train_masked_gp_l1_reg_loss: 13576.2595; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2953743.4919; train_optim_loss: 2953743.4919; val_kl_reg_loss: 81760.0996; val_edge_recon_loss: 1199137.0260; val_gene_expr_recon_loss: 1118266.4167; val_masked_gp_l1_reg_loss: 13162.7539; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2412326.3333; val_optim_loss: 2412326.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8363; val_auprc_score: 0.9690; val_best_acc_score: 0.8678; val_best_f1_score: 0.9280; train_kl_reg_loss: 72787.8530; train_edge_recon_loss: 1069545.6349; train_gene_expr_recon_loss: 1078112.5427; train_masked_gp_l1_reg_loss: 12924.6059; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2233370.6355; train_optim_loss: 2233370.6355; val_kl_reg_loss: 56977.8467; val_edge_recon_loss: 1157747.0573; val_gene_expr_recon_loss: 1028437.4844; val_masked_gp_l1_reg_loss: 12942.2021; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2256104.6354; val_optim_loss: 2256104.6354
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8395; val_auprc_score: 0.9639; val_best_acc_score: 0.8791; val_best_f1_score: 0.9331; train_kl_reg_loss: 54919.3347; train_edge_recon_loss: 1053380.8140; train_gene_expr_recon_loss: 1010884.7102; train_masked_gp_l1_reg_loss: 13286.2183; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2132471.0744; train_optim_loss: 2132471.0744; val_kl_reg_loss: 42987.2964; val_edge_recon_loss: 1140939.3021; val_gene_expr_recon_loss: 986144.4427; val_masked_gp_l1_reg_loss: 13790.8652; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2183861.8125; val_optim_loss: 2183861.8125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8587; val_auprc_score: 0.9671; val_best_acc_score: 0.8925; val_best_f1_score: 0.9399; train_kl_reg_loss: 50449.9942; train_edge_recon_loss: 974413.4369; train_gene_expr_recon_loss: 977969.7174; train_masked_gp_l1_reg_loss: 14345.2740; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2017178.4215; train_optim_loss: 2017178.4215; val_kl_reg_loss: 53185.1982; val_edge_recon_loss: 923779.5312; val_gene_expr_recon_loss: 953721.9974; val_masked_gp_l1_reg_loss: 14837.5977; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1945524.3438; val_optim_loss: 1945524.3438
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8625; val_auprc_score: 0.9686; val_best_acc_score: 0.9014; val_best_f1_score: 0.9448; train_kl_reg_loss: 53298.2759; train_edge_recon_loss: 908137.7506; train_gene_expr_recon_loss: 941800.5419; train_masked_gp_l1_reg_loss: 15303.1890; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1918539.7512; train_optim_loss: 1918539.7512; val_kl_reg_loss: 48411.9370; val_edge_recon_loss: 917356.0911; val_gene_expr_recon_loss: 926079.8958; val_masked_gp_l1_reg_loss: 15734.8838; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1907582.7969; val_optim_loss: 1907582.7969
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8711; val_auprc_score: 0.9705; val_best_acc_score: 0.9069; val_best_f1_score: 0.9477; train_kl_reg_loss: 45944.2111; train_edge_recon_loss: 882137.0122; train_gene_expr_recon_loss: 912603.4419; train_masked_gp_l1_reg_loss: 16137.5788; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1856822.2407; train_optim_loss: 1856822.2407; val_kl_reg_loss: 42437.4212; val_edge_recon_loss: 887898.9375; val_gene_expr_recon_loss: 896887.1406; val_masked_gp_l1_reg_loss: 16511.9570; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1843735.4896; val_optim_loss: 1843735.4896
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8872; val_auprc_score: 0.9742; val_best_acc_score: 0.9105; val_best_f1_score: 0.9496; train_kl_reg_loss: 40700.5953; train_edge_recon_loss: 854357.9797; train_gene_expr_recon_loss: 885641.3177; train_masked_gp_l1_reg_loss: 16784.8851; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1797484.7773; train_optim_loss: 1797484.7773; val_kl_reg_loss: 37296.3429; val_edge_recon_loss: 871248.1875; val_gene_expr_recon_loss: 872520.9870; val_masked_gp_l1_reg_loss: 16988.8848; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1798054.3958; val_optim_loss: 1798054.3958
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9057; val_auprc_score: 0.9791; val_best_acc_score: 0.9200; val_best_f1_score: 0.9545; train_kl_reg_loss: 34970.3407; train_edge_recon_loss: 838758.9968; train_gene_expr_recon_loss: 865132.6887; train_masked_gp_l1_reg_loss: 17079.1122; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1755941.1372; train_optim_loss: 1755941.1372; val_kl_reg_loss: 33176.6227; val_edge_recon_loss: 832393.8776; val_gene_expr_recon_loss: 855544.7057; val_masked_gp_l1_reg_loss: 17100.5859; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1738215.8229; val_optim_loss: 1738215.8229
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9199; val_auprc_score: 0.9819; val_best_acc_score: 0.9293; val_best_f1_score: 0.9596; train_kl_reg_loss: 30955.7904; train_edge_recon_loss: 820694.9500; train_gene_expr_recon_loss: 847461.9814; train_masked_gp_l1_reg_loss: 17003.3790; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1716116.1029; train_optim_loss: 1716116.1029; val_kl_reg_loss: 28035.2628; val_edge_recon_loss: 818614.7995; val_gene_expr_recon_loss: 837575.9219; val_masked_gp_l1_reg_loss: 16843.1602; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1701069.1042; val_optim_loss: 1701069.1042
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9190; val_auprc_score: 0.9818; val_best_acc_score: 0.9299; val_best_f1_score: 0.9600; train_kl_reg_loss: 26803.4578; train_edge_recon_loss: 810694.9102; train_gene_expr_recon_loss: 831512.4326; train_masked_gp_l1_reg_loss: 16578.4246; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1685589.2320; train_optim_loss: 1685589.2320; val_kl_reg_loss: 23872.5180; val_edge_recon_loss: 793967.2839; val_gene_expr_recon_loss: 823632.2682; val_masked_gp_l1_reg_loss: 16240.3428; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1657712.4427; val_optim_loss: 1657712.4427
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9294; val_auprc_score: 0.9841; val_best_acc_score: 0.9290; val_best_f1_score: 0.9591; train_kl_reg_loss: 22948.4757; train_edge_recon_loss: 805948.4349; train_gene_expr_recon_loss: 817672.8849; train_masked_gp_l1_reg_loss: 15839.5563; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1662409.3517; train_optim_loss: 1662409.3517; val_kl_reg_loss: 20698.0311; val_edge_recon_loss: 834214.7005; val_gene_expr_recon_loss: 809523.8438; val_masked_gp_l1_reg_loss: 15384.0820; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1679820.6771; val_optim_loss: 1679820.6771
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9369; val_auprc_score: 0.9851; val_best_acc_score: 0.9314; val_best_f1_score: 0.9604; train_kl_reg_loss: 20109.9960; train_edge_recon_loss: 804133.3044; train_gene_expr_recon_loss: 805464.4881; train_masked_gp_l1_reg_loss: 14890.0575; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1644597.8488; train_optim_loss: 1644597.8488; val_kl_reg_loss: 17094.2567; val_edge_recon_loss: 815770.2370; val_gene_expr_recon_loss: 798206.0078; val_masked_gp_l1_reg_loss: 14377.7725; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1645448.2292; val_optim_loss: 1645448.2292
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9460; val_auprc_score: 0.9893; val_best_acc_score: 0.9354; val_best_f1_score: 0.9630; train_kl_reg_loss: 17337.1352; train_edge_recon_loss: 792590.1718; train_gene_expr_recon_loss: 793997.0267; train_masked_gp_l1_reg_loss: 13913.4258; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1617837.7599; train_optim_loss: 1617837.7599; val_kl_reg_loss: 16929.2323; val_edge_recon_loss: 770482.3151; val_gene_expr_recon_loss: 787432.7422; val_masked_gp_l1_reg_loss: 13437.2861; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1588281.5469; val_optim_loss: 1588281.5469
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9446; val_auprc_score: 0.9879; val_best_acc_score: 0.9360; val_best_f1_score: 0.9631; train_kl_reg_loss: 15704.1764; train_edge_recon_loss: 786176.5488; train_gene_expr_recon_loss: 784195.2369; train_masked_gp_l1_reg_loss: 13026.1364; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1599102.1029; train_optim_loss: 1599102.1029; val_kl_reg_loss: 14788.0890; val_edge_recon_loss: 784497.0286; val_gene_expr_recon_loss: 778603.4844; val_masked_gp_l1_reg_loss: 12596.7666; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1590485.3542; val_optim_loss: 1590485.3542
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9532; val_auprc_score: 0.9896; val_best_acc_score: 0.9392; val_best_f1_score: 0.9648; train_kl_reg_loss: 14539.4539; train_edge_recon_loss: 785827.7488; train_gene_expr_recon_loss: 775685.9320; train_masked_gp_l1_reg_loss: 12224.9359; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1588278.0663; train_optim_loss: 1588278.0663; val_kl_reg_loss: 14276.0570; val_edge_recon_loss: 794442.7865; val_gene_expr_recon_loss: 770102.2031; val_masked_gp_l1_reg_loss: 11870.7461; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1590691.8073; val_optim_loss: 1590691.8073
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9532; val_auprc_score: 0.9896; val_best_acc_score: 0.9430; val_best_f1_score: 0.9671; train_kl_reg_loss: 13857.5650; train_edge_recon_loss: 776388.6622; train_gene_expr_recon_loss: 767910.7581; train_masked_gp_l1_reg_loss: 11527.5856; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1569684.5744; train_optim_loss: 1569684.5744; val_kl_reg_loss: 13430.2094; val_edge_recon_loss: 779883.5182; val_gene_expr_recon_loss: 762937.8828; val_masked_gp_l1_reg_loss: 11184.9355; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1567436.4792; val_optim_loss: 1567436.4792
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9529; val_auprc_score: 0.9890; val_best_acc_score: 0.9459; val_best_f1_score: 0.9687; train_kl_reg_loss: 13442.7248; train_edge_recon_loss: 762741.3750; train_gene_expr_recon_loss: 760837.1930; train_masked_gp_l1_reg_loss: 10894.3066; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1547915.6017; train_optim_loss: 1547915.6017; val_kl_reg_loss: 13216.5640; val_edge_recon_loss: 791237.6719; val_gene_expr_recon_loss: 756858.3021; val_masked_gp_l1_reg_loss: 10600.9590; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1571913.5365; val_optim_loss: 1571913.5365
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9551; val_auprc_score: 0.9891; val_best_acc_score: 0.9439; val_best_f1_score: 0.9675; train_kl_reg_loss: 13134.7358; train_edge_recon_loss: 774226.2422; train_gene_expr_recon_loss: 754644.6049; train_masked_gp_l1_reg_loss: 10365.4083; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1552370.9959; train_optim_loss: 1552370.9959; val_kl_reg_loss: 12524.8408; val_edge_recon_loss: 805013.3359; val_gene_expr_recon_loss: 750254.6979; val_masked_gp_l1_reg_loss: 10136.7979; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1577929.6198; val_optim_loss: 1577929.6198
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9547; val_auprc_score: 0.9901; val_best_acc_score: 0.9462; val_best_f1_score: 0.9690; train_kl_reg_loss: 12926.1861; train_edge_recon_loss: 773883.6520; train_gene_expr_recon_loss: 749076.0520; train_masked_gp_l1_reg_loss: 9928.2068; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1545814.0924; train_optim_loss: 1545814.0924; val_kl_reg_loss: 12293.5167; val_edge_recon_loss: 779112.7578; val_gene_expr_recon_loss: 746018.2552; val_masked_gp_l1_reg_loss: 9741.7285; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1547166.2865; val_optim_loss: 1547166.2865
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9544; val_auprc_score: 0.9895; val_best_acc_score: 0.9451; val_best_f1_score: 0.9680; train_kl_reg_loss: 12456.6443; train_edge_recon_loss: 779817.1186; train_gene_expr_recon_loss: 744361.8250; train_masked_gp_l1_reg_loss: 9548.5935; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1546184.1767; train_optim_loss: 1546184.1767; val_kl_reg_loss: 12021.8723; val_edge_recon_loss: 804428.5286; val_gene_expr_recon_loss: 740756.3464; val_masked_gp_l1_reg_loss: 9339.6074; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1566546.3854; val_optim_loss: 1566546.3854
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9601; val_auprc_score: 0.9915; val_best_acc_score: 0.9496; val_best_f1_score: 0.9708; train_kl_reg_loss: 12342.7707; train_edge_recon_loss: 775396.5561; train_gene_expr_recon_loss: 739890.2427; train_masked_gp_l1_reg_loss: 9181.4495; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1536811.0233; train_optim_loss: 1536811.0233; val_kl_reg_loss: 11501.5736; val_edge_recon_loss: 782744.2708; val_gene_expr_recon_loss: 736185.8724; val_masked_gp_l1_reg_loss: 9008.5068; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1539440.2188; val_optim_loss: 1539440.2188
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9592; val_auprc_score: 0.9904; val_best_acc_score: 0.9516; val_best_f1_score: 0.9719; train_kl_reg_loss: 12043.2904; train_edge_recon_loss: 770194.4828; train_gene_expr_recon_loss: 735513.2919; train_masked_gp_l1_reg_loss: 8841.4530; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1526592.5093; train_optim_loss: 1526592.5093; val_kl_reg_loss: 10708.4411; val_edge_recon_loss: 781786.8047; val_gene_expr_recon_loss: 733166.1667; val_masked_gp_l1_reg_loss: 8660.1387; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1534321.5312; val_optim_loss: 1534321.5312
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9578; val_auprc_score: 0.9897; val_best_acc_score: 0.9503; val_best_f1_score: 0.9711; train_kl_reg_loss: 12053.5351; train_edge_recon_loss: 761415.7997; train_gene_expr_recon_loss: 731456.1509; train_masked_gp_l1_reg_loss: 8554.2610; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1513479.7430; train_optim_loss: 1513479.7430; val_kl_reg_loss: 11214.5039; val_edge_recon_loss: 793888.5781; val_gene_expr_recon_loss: 729835.1562; val_masked_gp_l1_reg_loss: 8454.5752; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1543392.8646; val_optim_loss: 1543392.8646
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9627; val_auprc_score: 0.9914; val_best_acc_score: 0.9514; val_best_f1_score: 0.9716; train_kl_reg_loss: 11895.5619; train_edge_recon_loss: 771081.0878; train_gene_expr_recon_loss: 728433.1355; train_masked_gp_l1_reg_loss: 8342.3963; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1519752.1773; train_optim_loss: 1519752.1773; val_kl_reg_loss: 11151.5867; val_edge_recon_loss: 785129.8464; val_gene_expr_recon_loss: 726876.8385; val_masked_gp_l1_reg_loss: 8274.6465; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1531432.9010; val_optim_loss: 1531432.9010
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9589; val_auprc_score: 0.9904; val_best_acc_score: 0.9512; val_best_f1_score: 0.9717; train_kl_reg_loss: 11882.9204; train_edge_recon_loss: 770298.5267; train_gene_expr_recon_loss: 724944.4387; train_masked_gp_l1_reg_loss: 8140.0374; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1515265.9227; train_optim_loss: 1515265.9227; val_kl_reg_loss: 11162.3539; val_edge_recon_loss: 791728.1276; val_gene_expr_recon_loss: 723296.7292; val_masked_gp_l1_reg_loss: 8014.9194; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1534202.0573; val_optim_loss: 1534202.0573
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9638; val_auprc_score: 0.9917; val_best_acc_score: 0.9543; val_best_f1_score: 0.9734; train_kl_reg_loss: 11690.1621; train_edge_recon_loss: 770793.8672; train_gene_expr_recon_loss: 721715.2448; train_masked_gp_l1_reg_loss: 7947.2518; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1512146.5244; train_optim_loss: 1512146.5244; val_kl_reg_loss: 11262.1053; val_edge_recon_loss: 773641.4010; val_gene_expr_recon_loss: 720188.9193; val_masked_gp_l1_reg_loss: 7863.4644; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1512955.9323; val_optim_loss: 1512955.9323
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9607; val_auprc_score: 0.9906; val_best_acc_score: 0.9515; val_best_f1_score: 0.9720; train_kl_reg_loss: 11549.6747; train_edge_recon_loss: 772327.9480; train_gene_expr_recon_loss: 719478.6576; train_masked_gp_l1_reg_loss: 7822.5411; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1511178.8157; train_optim_loss: 1511178.8157; val_kl_reg_loss: 10479.3123; val_edge_recon_loss: 777246.3021; val_gene_expr_recon_loss: 718810.9531; val_masked_gp_l1_reg_loss: 7752.6719; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1514289.1979; val_optim_loss: 1514289.1979
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9637; val_auprc_score: 0.9911; val_best_acc_score: 0.9537; val_best_f1_score: 0.9733; train_kl_reg_loss: 11250.8160; train_edge_recon_loss: 768433.4267; train_gene_expr_recon_loss: 716991.2619; train_masked_gp_l1_reg_loss: 7707.9314; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1504383.4320; train_optim_loss: 1504383.4320; val_kl_reg_loss: 11090.2093; val_edge_recon_loss: 752252.0000; val_gene_expr_recon_loss: 715553.4661; val_masked_gp_l1_reg_loss: 7644.4541; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1486540.1719; val_optim_loss: 1486540.1719
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9613; val_auprc_score: 0.9916; val_best_acc_score: 0.9515; val_best_f1_score: 0.9719; train_kl_reg_loss: 11360.3413; train_edge_recon_loss: 776665.5291; train_gene_expr_recon_loss: 714370.5360; train_masked_gp_l1_reg_loss: 7597.9854; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1509994.3942; train_optim_loss: 1509994.3942; val_kl_reg_loss: 10525.7841; val_edge_recon_loss: 774487.3984; val_gene_expr_recon_loss: 713150.4505; val_masked_gp_l1_reg_loss: 7522.6992; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1505686.3854; val_optim_loss: 1505686.3854
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9647; val_auprc_score: 0.9918; val_best_acc_score: 0.9558; val_best_f1_score: 0.9743; train_kl_reg_loss: 11251.4726; train_edge_recon_loss: 773177.6073; train_gene_expr_recon_loss: 712402.7698; train_masked_gp_l1_reg_loss: 7527.4597; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1504359.3093; train_optim_loss: 1504359.3093; val_kl_reg_loss: 10826.8750; val_edge_recon_loss: 782132.6406; val_gene_expr_recon_loss: 710670.2708; val_masked_gp_l1_reg_loss: 7492.8076; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1511122.5260; val_optim_loss: 1511122.5260
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9624; val_auprc_score: 0.9910; val_best_acc_score: 0.9554; val_best_f1_score: 0.9741; train_kl_reg_loss: 11412.7035; train_edge_recon_loss: 770809.9250; train_gene_expr_recon_loss: 710161.5683; train_masked_gp_l1_reg_loss: 7418.1487; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1499802.3465; train_optim_loss: 1499802.3465; val_kl_reg_loss: 10857.4732; val_edge_recon_loss: 782677.2786; val_gene_expr_recon_loss: 709270.2135; val_masked_gp_l1_reg_loss: 7393.5312; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1510198.4479; val_optim_loss: 1510198.4479
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9609; val_auprc_score: 0.9899; val_best_acc_score: 0.9543; val_best_f1_score: 0.9735; train_kl_reg_loss: 11261.5850; train_edge_recon_loss: 772931.3904; train_gene_expr_recon_loss: 708201.1837; train_masked_gp_l1_reg_loss: 7406.9231; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1499801.0767; train_optim_loss: 1499801.0767; val_kl_reg_loss: 10861.1376; val_edge_recon_loss: 784166.3333; val_gene_expr_recon_loss: 705765.6797; val_masked_gp_l1_reg_loss: 7366.5356; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1508159.6406; val_optim_loss: 1508159.6406

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9667; val_auprc_score: 0.9918; val_best_acc_score: 0.9596; val_best_f1_score: 0.9764; train_kl_reg_loss: 11174.0515; train_edge_recon_loss: 760989.1416; train_gene_expr_recon_loss: 705318.0262; train_masked_gp_l1_reg_loss: 7188.5728; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1484669.7959; train_optim_loss: 1484669.7959; val_kl_reg_loss: 10957.7889; val_edge_recon_loss: 783004.5833; val_gene_expr_recon_loss: 705192.4036; val_masked_gp_l1_reg_loss: 7156.5342; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1506311.2865; val_optim_loss: 1506311.2865
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9671; val_auprc_score: 0.9921; val_best_acc_score: 0.9562; val_best_f1_score: 0.9746; train_kl_reg_loss: 11215.1865; train_edge_recon_loss: 757123.2828; train_gene_expr_recon_loss: 705136.3956; train_masked_gp_l1_reg_loss: 7152.2323; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1480627.0983; train_optim_loss: 1480627.0983; val_kl_reg_loss: 10756.2861; val_edge_recon_loss: 784175.1094; val_gene_expr_recon_loss: 704045.8307; val_masked_gp_l1_reg_loss: 7153.8018; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1506130.9792; val_optim_loss: 1506130.9792
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9673; val_auprc_score: 0.9925; val_best_acc_score: 0.9584; val_best_f1_score: 0.9759; train_kl_reg_loss: 11166.7003; train_edge_recon_loss: 768349.6552; train_gene_expr_recon_loss: 704940.2259; train_masked_gp_l1_reg_loss: 7155.4071; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1491611.9907; train_optim_loss: 1491611.9907; val_kl_reg_loss: 10772.7600; val_edge_recon_loss: 761605.3151; val_gene_expr_recon_loss: 704650.9453; val_masked_gp_l1_reg_loss: 7153.7930; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1484182.7760; val_optim_loss: 1484182.7760
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9638; val_auprc_score: 0.9914; val_best_acc_score: 0.9556; val_best_f1_score: 0.9743; train_kl_reg_loss: 11063.1457; train_edge_recon_loss: 764505.7012; train_gene_expr_recon_loss: 705083.2718; train_masked_gp_l1_reg_loss: 7162.3475; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1487814.4622; train_optim_loss: 1487814.4622; val_kl_reg_loss: 10755.7607; val_edge_recon_loss: 779438.8307; val_gene_expr_recon_loss: 703986.0833; val_masked_gp_l1_reg_loss: 7169.6294; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1501350.2969; val_optim_loss: 1501350.2969
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9694; val_auprc_score: 0.9930; val_best_acc_score: 0.9605; val_best_f1_score: 0.9771; train_kl_reg_loss: 11092.1215; train_edge_recon_loss: 756329.4166; train_gene_expr_recon_loss: 704671.1064; train_masked_gp_l1_reg_loss: 7167.9066; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1479260.5483; train_optim_loss: 1479260.5483; val_kl_reg_loss: 10785.5223; val_edge_recon_loss: 768950.4792; val_gene_expr_recon_loss: 704728.4844; val_masked_gp_l1_reg_loss: 7167.9971; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1491632.4792; val_optim_loss: 1491632.4792
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9654; val_auprc_score: 0.9919; val_best_acc_score: 0.9585; val_best_f1_score: 0.9760; train_kl_reg_loss: 11050.9489; train_edge_recon_loss: 767672.8922; train_gene_expr_recon_loss: 704587.8131; train_masked_gp_l1_reg_loss: 7170.2076; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1490481.8593; train_optim_loss: 1490481.8593; val_kl_reg_loss: 10619.8438; val_edge_recon_loss: 765779.4766; val_gene_expr_recon_loss: 703842.6224; val_masked_gp_l1_reg_loss: 7181.0278; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1487422.9479; val_optim_loss: 1487422.9479
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9700; val_auprc_score: 0.9935; val_best_acc_score: 0.9580; val_best_f1_score: 0.9758; train_kl_reg_loss: 11072.7915; train_edge_recon_loss: 767105.3093; train_gene_expr_recon_loss: 704121.8602; train_masked_gp_l1_reg_loss: 7171.3442; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1489471.3035; train_optim_loss: 1489471.3035; val_kl_reg_loss: 10794.6049; val_edge_recon_loss: 760797.2604; val_gene_expr_recon_loss: 703014.4167; val_masked_gp_l1_reg_loss: 7170.8535; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1481777.1562; val_optim_loss: 1481777.1562
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9668; val_auprc_score: 0.9925; val_best_acc_score: 0.9603; val_best_f1_score: 0.9771; train_kl_reg_loss: 10899.7358; train_edge_recon_loss: 767068.1407; train_gene_expr_recon_loss: 703922.0942; train_masked_gp_l1_reg_loss: 7176.0573; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1489066.0355; train_optim_loss: 1489066.0355; val_kl_reg_loss: 10402.1174; val_edge_recon_loss: 755528.2578; val_gene_expr_recon_loss: 703430.5026; val_masked_gp_l1_reg_loss: 7186.2305; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1476547.1354; val_optim_loss: 1476547.1354
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9676; val_auprc_score: 0.9928; val_best_acc_score: 0.9587; val_best_f1_score: 0.9760; train_kl_reg_loss: 10872.5449; train_edge_recon_loss: 771428.1047; train_gene_expr_recon_loss: 703455.9151; train_masked_gp_l1_reg_loss: 7183.6423; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1492940.2064; train_optim_loss: 1492940.2064; val_kl_reg_loss: 10564.8140; val_edge_recon_loss: 777089.4714; val_gene_expr_recon_loss: 702632.2240; val_masked_gp_l1_reg_loss: 7188.9395; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1497475.5000; val_optim_loss: 1497475.5000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9681; val_auprc_score: 0.9927; val_best_acc_score: 0.9593; val_best_f1_score: 0.9764; train_kl_reg_loss: 10918.5125; train_edge_recon_loss: 766260.2163; train_gene_expr_recon_loss: 703420.7552; train_masked_gp_l1_reg_loss: 7182.6783; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1487782.1605; train_optim_loss: 1487782.1605; val_kl_reg_loss: 10584.0951; val_edge_recon_loss: 780834.7370; val_gene_expr_recon_loss: 702997.8021; val_masked_gp_l1_reg_loss: 7186.2017; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1501602.8906; val_optim_loss: 1501602.8906
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9673; val_auprc_score: 0.9919; val_best_acc_score: 0.9586; val_best_f1_score: 0.9760; train_kl_reg_loss: 10927.5853; train_edge_recon_loss: 765436.7253; train_gene_expr_recon_loss: 703022.0794; train_masked_gp_l1_reg_loss: 7173.6819; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1486560.0674; train_optim_loss: 1486560.0674; val_kl_reg_loss: 10455.0811; val_edge_recon_loss: 762467.6875; val_gene_expr_recon_loss: 702936.7422; val_masked_gp_l1_reg_loss: 7165.6914; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1483025.2448; val_optim_loss: 1483025.2448
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9684; val_auprc_score: 0.9930; val_best_acc_score: 0.9608; val_best_f1_score: 0.9775; train_kl_reg_loss: 10828.9249; train_edge_recon_loss: 758998.0747; train_gene_expr_recon_loss: 702855.0474; train_masked_gp_l1_reg_loss: 7170.2192; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1479852.2634; train_optim_loss: 1479852.2634; val_kl_reg_loss: 10284.1718; val_edge_recon_loss: 740937.5026; val_gene_expr_recon_loss: 702333.2135; val_masked_gp_l1_reg_loss: 7173.9346; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1460728.7500; val_optim_loss: 1460728.7500
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9646; val_auprc_score: 0.9912; val_best_acc_score: 0.9578; val_best_f1_score: 0.9754; train_kl_reg_loss: 10796.1015; train_edge_recon_loss: 766030.9379; train_gene_expr_recon_loss: 702630.5820; train_masked_gp_l1_reg_loss: 7180.6735; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1486638.2924; train_optim_loss: 1486638.2924; val_kl_reg_loss: 10414.1657; val_edge_recon_loss: 807345.1432; val_gene_expr_recon_loss: 702416.5521; val_masked_gp_l1_reg_loss: 7187.2432; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1527363.1094; val_optim_loss: 1527363.1094
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9689; val_auprc_score: 0.9925; val_best_acc_score: 0.9581; val_best_f1_score: 0.9757; train_kl_reg_loss: 10815.0816; train_edge_recon_loss: 760109.7945; train_gene_expr_recon_loss: 702503.5320; train_masked_gp_l1_reg_loss: 7182.1498; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1480610.5634; train_optim_loss: 1480610.5634; val_kl_reg_loss: 10393.2191; val_edge_recon_loss: 776228.3594; val_gene_expr_recon_loss: 702506.8620; val_masked_gp_l1_reg_loss: 7182.8979; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1496311.3229; val_optim_loss: 1496311.3229
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9660; val_auprc_score: 0.9914; val_best_acc_score: 0.9599; val_best_f1_score: 0.9768; train_kl_reg_loss: 10859.1835; train_edge_recon_loss: 764600.3154; train_gene_expr_recon_loss: 702367.9805; train_masked_gp_l1_reg_loss: 7175.4783; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1485002.9628; train_optim_loss: 1485002.9628; val_kl_reg_loss: 10671.2208; val_edge_recon_loss: 782854.6953; val_gene_expr_recon_loss: 701654.8047; val_masked_gp_l1_reg_loss: 7170.1670; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1502350.8542; val_optim_loss: 1502350.8542
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9691; val_auprc_score: 0.9930; val_best_acc_score: 0.9623; val_best_f1_score: 0.9781; train_kl_reg_loss: 10856.8259; train_edge_recon_loss: 762364.1183; train_gene_expr_recon_loss: 701666.2392; train_masked_gp_l1_reg_loss: 7160.7467; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1482047.9349; train_optim_loss: 1482047.9349; val_kl_reg_loss: 10529.4745; val_edge_recon_loss: 765177.1536; val_gene_expr_recon_loss: 701413.7057; val_masked_gp_l1_reg_loss: 7152.6074; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1484272.9531; val_optim_loss: 1484272.9531

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9694; val_auprc_score: 0.9923; val_best_acc_score: 0.9585; val_best_f1_score: 0.9758; train_kl_reg_loss: 10787.2806; train_edge_recon_loss: 771132.5299; train_gene_expr_recon_loss: 701466.2869; train_masked_gp_l1_reg_loss: 7128.8596; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1490514.9610; train_optim_loss: 1490514.9610; val_kl_reg_loss: 10462.8465; val_edge_recon_loss: 796164.6120; val_gene_expr_recon_loss: 701113.4635; val_masked_gp_l1_reg_loss: 7123.4121; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1514864.2865; val_optim_loss: 1514864.2865
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9702; val_auprc_score: 0.9930; val_best_acc_score: 0.9600; val_best_f1_score: 0.9768; train_kl_reg_loss: 10765.5509; train_edge_recon_loss: 764210.6997; train_gene_expr_recon_loss: 701361.8267; train_masked_gp_l1_reg_loss: 7122.8582; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1483460.9314; train_optim_loss: 1483460.9314; val_kl_reg_loss: 10466.1434; val_edge_recon_loss: 779378.2526; val_gene_expr_recon_loss: 701263.6797; val_masked_gp_l1_reg_loss: 7122.2778; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1498230.3333; val_optim_loss: 1498230.3333
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9629; val_auprc_score: 0.9911; val_best_acc_score: 0.9586; val_best_f1_score: 0.9761; train_kl_reg_loss: 10766.7242; train_edge_recon_loss: 756751.0198; train_gene_expr_recon_loss: 701653.7750; train_masked_gp_l1_reg_loss: 7121.3582; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1476292.8686; train_optim_loss: 1476292.8686; val_kl_reg_loss: 10387.1169; val_edge_recon_loss: 769591.0208; val_gene_expr_recon_loss: 701034.8776; val_masked_gp_l1_reg_loss: 7121.1953; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1488134.2865; val_optim_loss: 1488134.2865
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9650; val_auprc_score: 0.9901; val_best_acc_score: 0.9559; val_best_f1_score: 0.9744; train_kl_reg_loss: 10701.8817; train_edge_recon_loss: 758780.7872; train_gene_expr_recon_loss: 701314.6988; train_masked_gp_l1_reg_loss: 7121.5133; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1477918.8738; train_optim_loss: 1477918.8738; val_kl_reg_loss: 10416.5983; val_edge_recon_loss: 804010.2005; val_gene_expr_recon_loss: 701951.5625; val_masked_gp_l1_reg_loss: 7121.4106; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1523499.7344; val_optim_loss: 1523499.7344

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 65 min 44 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
Val AUROC score: 0.9617
Val AUPRC score: 0.9905
Val best accuracy score: 0.9560
Val best F1 score: 0.9745
Val gene expr MSE score: 126041.5827
Val cat covariate0 mean sim diff: -0.0045

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
