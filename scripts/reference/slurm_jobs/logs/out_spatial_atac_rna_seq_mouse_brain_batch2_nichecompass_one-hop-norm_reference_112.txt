[True]
Run timestamp: 26072023_031943_112.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_112']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9600; val_auprc_score: 0.9610; val_best_acc_score: 0.7979; val_best_f1_score: 0.7480; train_kl_reg_loss: 1248.9643; train_edge_recon_loss: 34656043.1111; train_gene_expr_recon_loss: 323188.3368; train_masked_gp_l1_reg_loss: 1540.1992; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1078450.2083; train_global_loss: 36060471.1111; train_optim_loss: 36060471.1111; val_kl_reg_loss: 667.5560; val_edge_recon_loss: 40221584.0000; val_gene_expr_recon_loss: 322313.4062; val_masked_gp_l1_reg_loss: 1196.1547; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1097743.0000; val_global_loss: 41643504.0000; val_optim_loss: 41643504.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9099; val_auprc_score: 0.9032; val_best_acc_score: 0.8281; val_best_f1_score: 0.8391; train_kl_reg_loss: 499.3695; train_edge_recon_loss: 34538734.6667; train_gene_expr_recon_loss: 321419.0868; train_masked_gp_l1_reg_loss: 1028.5120; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1072285.3889; train_global_loss: 35933966.6667; train_optim_loss: 35933966.6667; val_kl_reg_loss: 695.5818; val_edge_recon_loss: 34441272.0000; val_gene_expr_recon_loss: 320311.0625; val_masked_gp_l1_reg_loss: 877.3744; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1095692.2500; val_global_loss: 35858848.0000; val_optim_loss: 35858848.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8851; val_auprc_score: 0.8858; val_best_acc_score: 0.7815; val_best_f1_score: 0.7982; train_kl_reg_loss: 3328.5269; train_edge_recon_loss: 31795097.7778; train_gene_expr_recon_loss: 316117.5000; train_masked_gp_l1_reg_loss: 861.6052; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1069239.2083; train_global_loss: 33184644.8889; train_optim_loss: 33184644.8889; val_kl_reg_loss: 11714.2637; val_edge_recon_loss: 28215102.0000; val_gene_expr_recon_loss: 320453.6562; val_masked_gp_l1_reg_loss: 895.7761; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1097404.0000; val_global_loss: 29645570.0000; val_optim_loss: 29645570.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8832; val_auprc_score: 0.8682; val_best_acc_score: 0.7924; val_best_f1_score: 0.8055; train_kl_reg_loss: 24568.5432; train_edge_recon_loss: 28426955.3333; train_gene_expr_recon_loss: 320786.8507; train_masked_gp_l1_reg_loss: 859.9497; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1067875.9028; train_global_loss: 29841046.8889; train_optim_loss: 29841046.8889; val_kl_reg_loss: 38949.2734; val_edge_recon_loss: 28322608.0000; val_gene_expr_recon_loss: 316479.5000; val_masked_gp_l1_reg_loss: 792.2161; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1092198.1250; val_global_loss: 29771028.0000; val_optim_loss: 29771028.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8878; val_auprc_score: 0.8616; val_best_acc_score: 0.8118; val_best_f1_score: 0.8194; train_kl_reg_loss: 46110.4240; train_edge_recon_loss: 27937227.1111; train_gene_expr_recon_loss: 313186.3576; train_masked_gp_l1_reg_loss: 756.1772; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1064307.0417; train_global_loss: 29361586.4444; train_optim_loss: 29361586.4444; val_kl_reg_loss: 47720.5625; val_edge_recon_loss: 28147454.0000; val_gene_expr_recon_loss: 314223.2188; val_masked_gp_l1_reg_loss: 721.6171; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1094582.7500; val_global_loss: 29604702.0000; val_optim_loss: 29604702.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9049; val_auprc_score: 0.8735; val_best_acc_score: 0.8411; val_best_f1_score: 0.8539; train_kl_reg_loss: 49768.3403; train_edge_recon_loss: 27579992.0000; train_gene_expr_recon_loss: 309457.3681; train_masked_gp_l1_reg_loss: 688.3798; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1060548.6944; train_global_loss: 29000454.6667; train_optim_loss: 29000454.6667; val_kl_reg_loss: 52822.3906; val_edge_recon_loss: 27170306.0000; val_gene_expr_recon_loss: 311311.2188; val_masked_gp_l1_reg_loss: 657.2745; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1080155.2500; val_global_loss: 28615254.0000; val_optim_loss: 28615254.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9209; val_auprc_score: 0.8930; val_best_acc_score: 0.8631; val_best_f1_score: 0.8729; train_kl_reg_loss: 49476.4206; train_edge_recon_loss: 27197091.7778; train_gene_expr_recon_loss: 308074.9896; train_masked_gp_l1_reg_loss: 652.6025; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1060858.8611; train_global_loss: 28616155.3333; train_optim_loss: 28616155.3333; val_kl_reg_loss: 49558.3516; val_edge_recon_loss: 27273378.0000; val_gene_expr_recon_loss: 308445.9688; val_masked_gp_l1_reg_loss: 633.6772; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1083458.7500; val_global_loss: 28715474.0000; val_optim_loss: 28715474.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9277; val_auprc_score: 0.9048; val_best_acc_score: 0.8677; val_best_f1_score: 0.8748; train_kl_reg_loss: 48949.7552; train_edge_recon_loss: 27051497.1111; train_gene_expr_recon_loss: 306740.8368; train_masked_gp_l1_reg_loss: 618.7581; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1061242.9653; train_global_loss: 28469049.1111; train_optim_loss: 28469049.1111; val_kl_reg_loss: 48108.5195; val_edge_recon_loss: 27202628.0000; val_gene_expr_recon_loss: 307330.1250; val_masked_gp_l1_reg_loss: 600.5460; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1080857.5000; val_global_loss: 28639524.0000; val_optim_loss: 28639524.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9318; val_auprc_score: 0.9075; val_best_acc_score: 0.8715; val_best_f1_score: 0.8796; train_kl_reg_loss: 46391.4167; train_edge_recon_loss: 26963630.6667; train_gene_expr_recon_loss: 302392.8403; train_masked_gp_l1_reg_loss: 593.7720; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1051546.9792; train_global_loss: 28364555.5556; train_optim_loss: 28364555.5556; val_kl_reg_loss: 45488.8164; val_edge_recon_loss: 26946968.0000; val_gene_expr_recon_loss: 303910.1875; val_masked_gp_l1_reg_loss: 585.2849; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1081299.6250; val_global_loss: 28378252.0000; val_optim_loss: 28378252.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9426; val_auprc_score: 0.9208; val_best_acc_score: 0.8837; val_best_f1_score: 0.8914; train_kl_reg_loss: 44083.8997; train_edge_recon_loss: 26783721.1111; train_gene_expr_recon_loss: 301809.3819; train_masked_gp_l1_reg_loss: 584.7150; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1056213.7917; train_global_loss: 28186413.1111; train_optim_loss: 28186413.1111; val_kl_reg_loss: 42068.9492; val_edge_recon_loss: 26783904.0000; val_gene_expr_recon_loss: 302127.1250; val_masked_gp_l1_reg_loss: 586.1152; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1079167.6250; val_global_loss: 28207854.0000; val_optim_loss: 28207854.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9457; val_auprc_score: 0.9289; val_best_acc_score: 0.8890; val_best_f1_score: 0.8948; train_kl_reg_loss: 40715.9631; train_edge_recon_loss: 26812122.8889; train_gene_expr_recon_loss: 301171.3472; train_masked_gp_l1_reg_loss: 595.1248; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1055267.0069; train_global_loss: 28209872.2222; train_optim_loss: 28209872.2222; val_kl_reg_loss: 40139.2266; val_edge_recon_loss: 26911408.0000; val_gene_expr_recon_loss: 304529.8438; val_masked_gp_l1_reg_loss: 603.3570; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1073988.2500; val_global_loss: 28330670.0000; val_optim_loss: 28330670.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9538; val_auprc_score: 0.9355; val_best_acc_score: 0.8998; val_best_f1_score: 0.9044; train_kl_reg_loss: 37091.6163; train_edge_recon_loss: 26554913.7778; train_gene_expr_recon_loss: 301906.5243; train_masked_gp_l1_reg_loss: 611.1157; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1058127.7222; train_global_loss: 27952651.1111; train_optim_loss: 27952651.1111; val_kl_reg_loss: 35947.1289; val_edge_recon_loss: 26945290.0000; val_gene_expr_recon_loss: 300993.0625; val_masked_gp_l1_reg_loss: 617.5396; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1076821.5000; val_global_loss: 28359672.0000; val_optim_loss: 28359672.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9560; val_auprc_score: 0.9383; val_best_acc_score: 0.9053; val_best_f1_score: 0.9088; train_kl_reg_loss: 34471.1667; train_edge_recon_loss: 26599809.7778; train_gene_expr_recon_loss: 298288.8715; train_masked_gp_l1_reg_loss: 626.4606; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1055790.5486; train_global_loss: 27988986.6667; train_optim_loss: 27988986.6667; val_kl_reg_loss: 33494.8789; val_edge_recon_loss: 26514080.0000; val_gene_expr_recon_loss: 301574.4375; val_masked_gp_l1_reg_loss: 638.1365; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1076649.8750; val_global_loss: 27926436.0000; val_optim_loss: 27926436.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9591; val_auprc_score: 0.9454; val_best_acc_score: 0.9049; val_best_f1_score: 0.9099; train_kl_reg_loss: 32640.3822; train_edge_recon_loss: 26481916.0000; train_gene_expr_recon_loss: 298792.7396; train_masked_gp_l1_reg_loss: 650.1844; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1054233.0069; train_global_loss: 27868232.0000; train_optim_loss: 27868232.0000; val_kl_reg_loss: 33043.6289; val_edge_recon_loss: 26596570.0000; val_gene_expr_recon_loss: 299491.2188; val_masked_gp_l1_reg_loss: 667.3257; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1078216.5000; val_global_loss: 28007990.0000; val_optim_loss: 28007990.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9621; val_auprc_score: 0.9472; val_best_acc_score: 0.9117; val_best_f1_score: 0.9154; train_kl_reg_loss: 33368.8620; train_edge_recon_loss: 26367266.4444; train_gene_expr_recon_loss: 296498.9132; train_masked_gp_l1_reg_loss: 691.7195; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1057200.0417; train_global_loss: 27755025.7778; train_optim_loss: 27755025.7778; val_kl_reg_loss: 35071.3672; val_edge_recon_loss: 26362038.0000; val_gene_expr_recon_loss: 299090.0625; val_masked_gp_l1_reg_loss: 711.7369; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1075789.6250; val_global_loss: 27772702.0000; val_optim_loss: 27772702.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9640; val_auprc_score: 0.9455; val_best_acc_score: 0.9220; val_best_f1_score: 0.9256; train_kl_reg_loss: 35426.4223; train_edge_recon_loss: 26382503.3333; train_gene_expr_recon_loss: 295620.5000; train_masked_gp_l1_reg_loss: 721.5851; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1054173.1181; train_global_loss: 27768445.1111; train_optim_loss: 27768445.1111; val_kl_reg_loss: 35774.0469; val_edge_recon_loss: 26550282.0000; val_gene_expr_recon_loss: 294215.0312; val_masked_gp_l1_reg_loss: 733.1140; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1072413.7500; val_global_loss: 27953420.0000; val_optim_loss: 27953420.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9643; val_auprc_score: 0.9522; val_best_acc_score: 0.9198; val_best_f1_score: 0.9236; train_kl_reg_loss: 34292.0981; train_edge_recon_loss: 26359071.3333; train_gene_expr_recon_loss: 291599.5382; train_masked_gp_l1_reg_loss: 743.2496; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1048646.0764; train_global_loss: 27734352.6667; train_optim_loss: 27734352.6667; val_kl_reg_loss: 33859.3711; val_edge_recon_loss: 26376932.0000; val_gene_expr_recon_loss: 296823.1875; val_masked_gp_l1_reg_loss: 753.4650; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1071451.8750; val_global_loss: 27779822.0000; val_optim_loss: 27779822.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9655; val_auprc_score: 0.9504; val_best_acc_score: 0.9258; val_best_f1_score: 0.9289; train_kl_reg_loss: 32284.9742; train_edge_recon_loss: 26372666.8889; train_gene_expr_recon_loss: 291545.7500; train_masked_gp_l1_reg_loss: 766.0189; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047775.1528; train_global_loss: 27745039.3333; train_optim_loss: 27745039.3333; val_kl_reg_loss: 32548.0664; val_edge_recon_loss: 26438180.0000; val_gene_expr_recon_loss: 294325.8750; val_masked_gp_l1_reg_loss: 782.8059; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1068803.0000; val_global_loss: 27834640.0000; val_optim_loss: 27834640.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9711; val_auprc_score: 0.9580; val_best_acc_score: 0.9293; val_best_f1_score: 0.9317; train_kl_reg_loss: 32245.1076; train_edge_recon_loss: 26372377.3333; train_gene_expr_recon_loss: 290770.5451; train_masked_gp_l1_reg_loss: 794.9601; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1048942.2222; train_global_loss: 27745129.5556; train_optim_loss: 27745129.5556; val_kl_reg_loss: 32522.4863; val_edge_recon_loss: 26209638.0000; val_gene_expr_recon_loss: 293196.1562; val_masked_gp_l1_reg_loss: 810.7715; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1068735.7500; val_global_loss: 27604902.0000; val_optim_loss: 27604902.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9700; val_auprc_score: 0.9570; val_best_acc_score: 0.9274; val_best_f1_score: 0.9296; train_kl_reg_loss: 32577.7897; train_edge_recon_loss: 26373685.3333; train_gene_expr_recon_loss: 289441.0972; train_masked_gp_l1_reg_loss: 822.5390; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1040382.5903; train_global_loss: 27736909.3333; train_optim_loss: 27736909.3333; val_kl_reg_loss: 32846.8750; val_edge_recon_loss: 26450702.0000; val_gene_expr_recon_loss: 293991.5312; val_masked_gp_l1_reg_loss: 841.7310; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1067294.7500; val_global_loss: 27845676.0000; val_optim_loss: 27845676.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9665; val_auprc_score: 0.9468; val_best_acc_score: 0.9263; val_best_f1_score: 0.9289; train_kl_reg_loss: 32617.0853; train_edge_recon_loss: 26287440.8889; train_gene_expr_recon_loss: 288704.3021; train_masked_gp_l1_reg_loss: 859.6272; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1044165.2431; train_global_loss: 27653787.7778; train_optim_loss: 27653787.7778; val_kl_reg_loss: 32705.8887; val_edge_recon_loss: 26544846.0000; val_gene_expr_recon_loss: 288244.6562; val_masked_gp_l1_reg_loss: 873.3848; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1063471.8750; val_global_loss: 27930142.0000; val_optim_loss: 27930142.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9676; val_auprc_score: 0.9517; val_best_acc_score: 0.9247; val_best_f1_score: 0.9286; train_kl_reg_loss: 31916.5901; train_edge_recon_loss: 26297228.4444; train_gene_expr_recon_loss: 289031.9236; train_masked_gp_l1_reg_loss: 888.7652; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1055924.3333; train_global_loss: 27674989.3333; train_optim_loss: 27674989.3333; val_kl_reg_loss: 31872.6953; val_edge_recon_loss: 26404404.0000; val_gene_expr_recon_loss: 289378.5625; val_masked_gp_l1_reg_loss: 900.0497; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1062444.5000; val_global_loss: 27788998.0000; val_optim_loss: 27788998.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9732; val_auprc_score: 0.9623; val_best_acc_score: 0.9314; val_best_f1_score: 0.9337; train_kl_reg_loss: 31646.2376; train_edge_recon_loss: 26330331.3333; train_gene_expr_recon_loss: 287336.7326; train_masked_gp_l1_reg_loss: 912.9773; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1044755.5000; train_global_loss: 27694983.1111; train_optim_loss: 27694983.1111; val_kl_reg_loss: 31449.0547; val_edge_recon_loss: 26369918.0000; val_gene_expr_recon_loss: 288378.8125; val_masked_gp_l1_reg_loss: 923.3397; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1064517.0000; val_global_loss: 27755188.0000; val_optim_loss: 27755188.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9709; val_auprc_score: 0.9590; val_best_acc_score: 0.9283; val_best_f1_score: 0.9308; train_kl_reg_loss: 31206.3273; train_edge_recon_loss: 26224153.1111; train_gene_expr_recon_loss: 283902.9757; train_masked_gp_l1_reg_loss: 921.2625; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1036190.5417; train_global_loss: 27576374.2222; train_optim_loss: 27576374.2222; val_kl_reg_loss: 31698.6914; val_edge_recon_loss: 26406014.0000; val_gene_expr_recon_loss: 287759.2812; val_masked_gp_l1_reg_loss: 917.5339; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1061246.8750; val_global_loss: 27787636.0000; val_optim_loss: 27787636.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9733; val_auprc_score: 0.9621; val_best_acc_score: 0.9318; val_best_f1_score: 0.9345; train_kl_reg_loss: 31357.5788; train_edge_recon_loss: 26207881.5556; train_gene_expr_recon_loss: 285474.0174; train_masked_gp_l1_reg_loss: 915.7527; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1035951.9514; train_global_loss: 27561581.1111; train_optim_loss: 27561581.1111; val_kl_reg_loss: 31536.0742; val_edge_recon_loss: 26457488.0000; val_gene_expr_recon_loss: 289123.1250; val_masked_gp_l1_reg_loss: 913.3760; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1063008.0000; val_global_loss: 27842070.0000; val_optim_loss: 27842070.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9683; val_auprc_score: 0.9551; val_best_acc_score: 0.9247; val_best_f1_score: 0.9278; train_kl_reg_loss: 31463.2589; train_edge_recon_loss: 26205880.0000; train_gene_expr_recon_loss: 288571.7431; train_masked_gp_l1_reg_loss: 910.7612; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1043963.6250; train_global_loss: 27570789.3333; train_optim_loss: 27570789.3333; val_kl_reg_loss: 20778.3027; val_edge_recon_loss: 26634098.0000; val_gene_expr_recon_loss: 292825.1875; val_masked_gp_l1_reg_loss: 907.6306; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1066994.5000; val_global_loss: 28015604.0000; val_optim_loss: 28015604.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9728; val_auprc_score: 0.9632; val_best_acc_score: 0.9317; val_best_f1_score: 0.9346; train_kl_reg_loss: 31137.1806; train_edge_recon_loss: 26266339.7778; train_gene_expr_recon_loss: 293016.9028; train_masked_gp_l1_reg_loss: 905.5139; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1048643.6042; train_global_loss: 27640043.5556; train_optim_loss: 27640043.5556; val_kl_reg_loss: 20572.7832; val_edge_recon_loss: 26325042.0000; val_gene_expr_recon_loss: 294383.4375; val_masked_gp_l1_reg_loss: 902.6620; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1069922.6250; val_global_loss: 27710822.0000; val_optim_loss: 27710822.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 37 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9670
Val AUPRC score: 0.9516
Val best accuracy score: 0.9240
Val best F1 score: 0.9270
Val gene expr MSE score: 0.7647
Val chrom access MSE score: 0.0954
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
