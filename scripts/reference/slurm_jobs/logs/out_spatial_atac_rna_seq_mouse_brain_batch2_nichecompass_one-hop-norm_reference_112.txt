[True]
Run timestamp: 10102023_021934_112.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_112']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6355; val_auprc_score: 0.6403; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 45699.6006; train_edge_recon_loss: 3517330.3409; train_gene_expr_recon_loss: 14113927.5758; train_masked_gp_l1_reg_loss: 137739.4772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4522881.2121; train_chrom_access_recon_loss: 11638859.1667; train_global_loss: 33976437.6970; train_optim_loss: 33976437.6970; val_kl_reg_loss: 47108.5806; val_edge_recon_loss: 4065644.5938; val_gene_expr_recon_loss: 13374389.6250; val_masked_gp_l1_reg_loss: 113766.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2098765.5000; val_chrom_access_recon_loss: 11312959.0000; val_global_loss: 31012633.5000; val_optim_loss: 31012633.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6522; val_auprc_score: 0.6456; val_best_acc_score: 0.5253; val_best_f1_score: 0.6754; train_kl_reg_loss: 88243.2524; train_edge_recon_loss: 3518143.9205; train_gene_expr_recon_loss: 12859914.7576; train_masked_gp_l1_reg_loss: 106846.2631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 983881.4872; train_chrom_access_recon_loss: 11039492.0758; train_global_loss: 28596521.7576; train_optim_loss: 28596521.7576; val_kl_reg_loss: 109924.1240; val_edge_recon_loss: 4063775.3438; val_gene_expr_recon_loss: 12861093.8750; val_masked_gp_l1_reg_loss: 101322.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 415912.5938; val_chrom_access_recon_loss: 10982770.5000; val_global_loss: 28534797.7500; val_optim_loss: 28534797.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6828; val_auprc_score: 0.6746; val_best_acc_score: 0.5435; val_best_f1_score: 0.6797; train_kl_reg_loss: 93552.1606; train_edge_recon_loss: 3516146.2500; train_gene_expr_recon_loss: 12652967.2879; train_masked_gp_l1_reg_loss: 99928.0850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 289212.7472; train_chrom_access_recon_loss: 10916445.8939; train_global_loss: 27568252.2727; train_optim_loss: 27568252.2727; val_kl_reg_loss: 89653.0693; val_edge_recon_loss: 4062129.2188; val_gene_expr_recon_loss: 12624355.0000; val_masked_gp_l1_reg_loss: 99460.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 210199.4062; val_chrom_access_recon_loss: 10875636.0000; val_global_loss: 27961433.5000; val_optim_loss: 27961433.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7243; val_auprc_score: 0.7150; val_best_acc_score: 0.6572; val_best_f1_score: 0.6930; train_kl_reg_loss: 86533.7356; train_edge_recon_loss: 3511380.7917; train_gene_expr_recon_loss: 12571475.0758; train_masked_gp_l1_reg_loss: 99514.6694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 175428.2770; train_chrom_access_recon_loss: 10859057.1364; train_global_loss: 27303389.5758; train_optim_loss: 27303389.5758; val_kl_reg_loss: 80949.7695; val_edge_recon_loss: 4027034.0625; val_gene_expr_recon_loss: 12605471.1250; val_masked_gp_l1_reg_loss: 100449.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149783.1094; val_chrom_access_recon_loss: 10927885.5000; val_global_loss: 27891574.2500; val_optim_loss: 27891574.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7904; val_auprc_score: 0.7662; val_best_acc_score: 0.7139; val_best_f1_score: 0.7592; train_kl_reg_loss: 74603.2036; train_edge_recon_loss: 3475052.6326; train_gene_expr_recon_loss: 12499544.6364; train_masked_gp_l1_reg_loss: 101790.2866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135761.0601; train_chrom_access_recon_loss: 10801981.5909; train_global_loss: 27088733.4848; train_optim_loss: 27088733.4848; val_kl_reg_loss: 61848.7065; val_edge_recon_loss: 3615636.5625; val_gene_expr_recon_loss: 12609135.8750; val_masked_gp_l1_reg_loss: 104866.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123998.8438; val_chrom_access_recon_loss: 10871283.1250; val_global_loss: 27386768.7500; val_optim_loss: 27386768.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8196; val_auprc_score: 0.7894; val_best_acc_score: 0.7488; val_best_f1_score: 0.7869; train_kl_reg_loss: 73871.8751; train_edge_recon_loss: 3201406.7879; train_gene_expr_recon_loss: 12443674.7576; train_masked_gp_l1_reg_loss: 110115.1435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117042.3464; train_chrom_access_recon_loss: 10747734.4545; train_global_loss: 26693845.4848; train_optim_loss: 26693845.4848; val_kl_reg_loss: 88064.8193; val_edge_recon_loss: 3049814.1875; val_gene_expr_recon_loss: 12560351.8750; val_masked_gp_l1_reg_loss: 116769.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111670.3750; val_chrom_access_recon_loss: 10802074.7500; val_global_loss: 26728745.5000; val_optim_loss: 26728745.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8401; val_auprc_score: 0.8032; val_best_acc_score: 0.7474; val_best_f1_score: 0.7900; train_kl_reg_loss: 99608.4150; train_edge_recon_loss: 2988775.5455; train_gene_expr_recon_loss: 12386449.1364; train_masked_gp_l1_reg_loss: 119941.3175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108757.2640; train_chrom_access_recon_loss: 10682405.2727; train_global_loss: 26385936.6364; train_optim_loss: 26385936.6364; val_kl_reg_loss: 91351.4150; val_edge_recon_loss: 2979232.8438; val_gene_expr_recon_loss: 12380245.6250; val_masked_gp_l1_reg_loss: 120236.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105348.2188; val_chrom_access_recon_loss: 10703287.7500; val_global_loss: 26379702.2500; val_optim_loss: 26379702.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8520; val_auprc_score: 0.8191; val_best_acc_score: 0.7708; val_best_f1_score: 0.7995; train_kl_reg_loss: 100824.2566; train_edge_recon_loss: 2950730.4848; train_gene_expr_recon_loss: 12295878.1667; train_masked_gp_l1_reg_loss: 119966.0800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102399.9898; train_chrom_access_recon_loss: 10626133.2273; train_global_loss: 26195932.1818; train_optim_loss: 26195932.1818; val_kl_reg_loss: 111341.8877; val_edge_recon_loss: 2908152.8125; val_gene_expr_recon_loss: 12418265.6250; val_masked_gp_l1_reg_loss: 119917.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99338.3672; val_chrom_access_recon_loss: 10745165.6250; val_global_loss: 26402181.0000; val_optim_loss: 26402181.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8587; val_auprc_score: 0.8247; val_best_acc_score: 0.7861; val_best_f1_score: 0.8009; train_kl_reg_loss: 100605.4705; train_edge_recon_loss: 2935498.1591; train_gene_expr_recon_loss: 12245284.1212; train_masked_gp_l1_reg_loss: 119971.2573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97143.0170; train_chrom_access_recon_loss: 10586471.3182; train_global_loss: 26084973.2424; train_optim_loss: 26084973.2424; val_kl_reg_loss: 95327.0273; val_edge_recon_loss: 2927278.5000; val_gene_expr_recon_loss: 12395367.7500; val_masked_gp_l1_reg_loss: 120657.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95251.4531; val_chrom_access_recon_loss: 10624794.2500; val_global_loss: 26258676.0000; val_optim_loss: 26258676.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8627; val_auprc_score: 0.8191; val_best_acc_score: 0.7875; val_best_f1_score: 0.8137; train_kl_reg_loss: 97553.6186; train_edge_recon_loss: 2921470.2197; train_gene_expr_recon_loss: 12203349.1970; train_masked_gp_l1_reg_loss: 121527.3961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93565.2067; train_chrom_access_recon_loss: 10551682.0000; train_global_loss: 25989147.8485; train_optim_loss: 25989147.8485; val_kl_reg_loss: 100794.0928; val_edge_recon_loss: 2931067.6250; val_gene_expr_recon_loss: 12298741.6250; val_masked_gp_l1_reg_loss: 121997.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91950.5156; val_chrom_access_recon_loss: 10586409.1250; val_global_loss: 26130960.5000; val_optim_loss: 26130960.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8756; val_auprc_score: 0.8330; val_best_acc_score: 0.8047; val_best_f1_score: 0.8291; train_kl_reg_loss: 94269.3355; train_edge_recon_loss: 2886914.1856; train_gene_expr_recon_loss: 12157317.6970; train_masked_gp_l1_reg_loss: 122790.6262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91271.9495; train_chrom_access_recon_loss: 10519856.6212; train_global_loss: 25872420.4545; train_optim_loss: 25872420.4545; val_kl_reg_loss: 95687.2441; val_edge_recon_loss: 2878905.3750; val_gene_expr_recon_loss: 12274274.1250; val_masked_gp_l1_reg_loss: 123689.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90634.8750; val_chrom_access_recon_loss: 10563830.1250; val_global_loss: 26027020.5000; val_optim_loss: 26027020.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8782; val_auprc_score: 0.8466; val_best_acc_score: 0.8057; val_best_f1_score: 0.8242; train_kl_reg_loss: 95015.7576; train_edge_recon_loss: 2861130.3144; train_gene_expr_recon_loss: 12113105.9394; train_masked_gp_l1_reg_loss: 124528.6425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89799.5524; train_chrom_access_recon_loss: 10491504.5303; train_global_loss: 25775084.6667; train_optim_loss: 25775084.6667; val_kl_reg_loss: 96267.6572; val_edge_recon_loss: 2915175.8125; val_gene_expr_recon_loss: 12247316.1250; val_masked_gp_l1_reg_loss: 125055.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88985.7656; val_chrom_access_recon_loss: 10576936.6250; val_global_loss: 26049737.2500; val_optim_loss: 26049737.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8935; val_auprc_score: 0.8530; val_best_acc_score: 0.8332; val_best_f1_score: 0.8474; train_kl_reg_loss: 95477.6284; train_edge_recon_loss: 2831946.5530; train_gene_expr_recon_loss: 12062851.8485; train_masked_gp_l1_reg_loss: 125840.6515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88295.8775; train_chrom_access_recon_loss: 10441027.5909; train_global_loss: 25645440.1212; train_optim_loss: 25645440.1212; val_kl_reg_loss: 103038.6172; val_edge_recon_loss: 2836670.0938; val_gene_expr_recon_loss: 12194056.5000; val_masked_gp_l1_reg_loss: 127024.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88533.9609; val_chrom_access_recon_loss: 10562085.0000; val_global_loss: 25911409.0000; val_optim_loss: 25911409.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9022; val_auprc_score: 0.8610; val_best_acc_score: 0.8466; val_best_f1_score: 0.8590; train_kl_reg_loss: 96995.1347; train_edge_recon_loss: 2816294.4129; train_gene_expr_recon_loss: 12027125.7424; train_masked_gp_l1_reg_loss: 127279.9323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87187.7822; train_chrom_access_recon_loss: 10409887.0303; train_global_loss: 25564770.0909; train_optim_loss: 25564770.0909; val_kl_reg_loss: 97442.3467; val_edge_recon_loss: 2804387.6562; val_gene_expr_recon_loss: 12197009.7500; val_masked_gp_l1_reg_loss: 127394.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86517.1328; val_chrom_access_recon_loss: 10479655.1250; val_global_loss: 25792405.7500; val_optim_loss: 25792405.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9147; val_auprc_score: 0.8853; val_best_acc_score: 0.8536; val_best_f1_score: 0.8649; train_kl_reg_loss: 98564.6951; train_edge_recon_loss: 2791541.3371; train_gene_expr_recon_loss: 11985736.4545; train_masked_gp_l1_reg_loss: 127773.1881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85456.9858; train_chrom_access_recon_loss: 10377522.3182; train_global_loss: 25466594.9091; train_optim_loss: 25466594.9091; val_kl_reg_loss: 95677.6816; val_edge_recon_loss: 2794177.5000; val_gene_expr_recon_loss: 12020180.1250; val_masked_gp_l1_reg_loss: 128316.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85380.6562; val_chrom_access_recon_loss: 10374401.7500; val_global_loss: 25498134.0000; val_optim_loss: 25498134.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9092; val_auprc_score: 0.8753; val_best_acc_score: 0.8463; val_best_f1_score: 0.8571; train_kl_reg_loss: 99591.5994; train_edge_recon_loss: 2789489.4432; train_gene_expr_recon_loss: 11967946.9242; train_masked_gp_l1_reg_loss: 128678.2443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84348.9450; train_chrom_access_recon_loss: 10362465.6667; train_global_loss: 25432520.9697; train_optim_loss: 25432520.9697; val_kl_reg_loss: 94939.8906; val_edge_recon_loss: 2864321.3125; val_gene_expr_recon_loss: 12170793.3750; val_masked_gp_l1_reg_loss: 128589.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83234.2500; val_chrom_access_recon_loss: 10528586.1250; val_global_loss: 25870463.2500; val_optim_loss: 25870463.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9158; val_auprc_score: 0.8908; val_best_acc_score: 0.8490; val_best_f1_score: 0.8627; train_kl_reg_loss: 97843.5205; train_edge_recon_loss: 2770336.5152; train_gene_expr_recon_loss: 11927443.1818; train_masked_gp_l1_reg_loss: 129056.4237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83049.7352; train_chrom_access_recon_loss: 10320175.5455; train_global_loss: 25327904.9091; train_optim_loss: 25327904.9091; val_kl_reg_loss: 98921.9082; val_edge_recon_loss: 2813639.7500; val_gene_expr_recon_loss: 12024727.8750; val_masked_gp_l1_reg_loss: 129747.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82823.5781; val_chrom_access_recon_loss: 10376911.2500; val_global_loss: 25526772.0000; val_optim_loss: 25526772.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9141; val_auprc_score: 0.8780; val_best_acc_score: 0.8522; val_best_f1_score: 0.8652; train_kl_reg_loss: 99292.7217; train_edge_recon_loss: 2773546.8712; train_gene_expr_recon_loss: 11902683.8333; train_masked_gp_l1_reg_loss: 129641.4801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81959.1609; train_chrom_access_recon_loss: 10293330.4697; train_global_loss: 25280454.6667; train_optim_loss: 25280454.6667; val_kl_reg_loss: 102538.0615; val_edge_recon_loss: 2810816.5938; val_gene_expr_recon_loss: 11981218.6250; val_masked_gp_l1_reg_loss: 129755.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81737.2344; val_chrom_access_recon_loss: 10312206.5000; val_global_loss: 25418273.0000; val_optim_loss: 25418273.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9188; val_auprc_score: 0.8843; val_best_acc_score: 0.8606; val_best_f1_score: 0.8712; train_kl_reg_loss: 96401.0260; train_edge_recon_loss: 2762874.4697; train_gene_expr_recon_loss: 11877765.1667; train_masked_gp_l1_reg_loss: 129932.5723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81254.2263; train_chrom_access_recon_loss: 10276542.0758; train_global_loss: 25224769.5758; train_optim_loss: 25224769.5758; val_kl_reg_loss: 96683.1943; val_edge_recon_loss: 2780095.5000; val_gene_expr_recon_loss: 12106197.2500; val_masked_gp_l1_reg_loss: 130403.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81365.4062; val_chrom_access_recon_loss: 10407532.3750; val_global_loss: 25602276.2500; val_optim_loss: 25602276.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9158; val_auprc_score: 0.8850; val_best_acc_score: 0.8549; val_best_f1_score: 0.8677; train_kl_reg_loss: 99770.9856; train_edge_recon_loss: 2758469.0038; train_gene_expr_recon_loss: 11843734.4242; train_masked_gp_l1_reg_loss: 130271.7454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80430.7556; train_chrom_access_recon_loss: 10241269.3939; train_global_loss: 25153946.3636; train_optim_loss: 25153946.3636; val_kl_reg_loss: 100873.2803; val_edge_recon_loss: 2792674.5938; val_gene_expr_recon_loss: 11998659.1250; val_masked_gp_l1_reg_loss: 130231.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80121.2344; val_chrom_access_recon_loss: 10448461.8750; val_global_loss: 25551021.0000; val_optim_loss: 25551021.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9207; val_auprc_score: 0.8898; val_best_acc_score: 0.8579; val_best_f1_score: 0.8685; train_kl_reg_loss: 96850.3252; train_edge_recon_loss: 2763877.7500; train_gene_expr_recon_loss: 11827192.7121; train_masked_gp_l1_reg_loss: 130308.5702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79743.8404; train_chrom_access_recon_loss: 10229159.6364; train_global_loss: 25127132.7879; train_optim_loss: 25127132.7879; val_kl_reg_loss: 96847.5439; val_edge_recon_loss: 2798630.6562; val_gene_expr_recon_loss: 11973004.7500; val_masked_gp_l1_reg_loss: 129930.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79232.8984; val_chrom_access_recon_loss: 10261389.6250; val_global_loss: 25339035.5000; val_optim_loss: 25339035.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9192; val_auprc_score: 0.8870; val_best_acc_score: 0.8632; val_best_f1_score: 0.8735; train_kl_reg_loss: 97634.6432; train_edge_recon_loss: 2753143.4129; train_gene_expr_recon_loss: 11798553.7121; train_masked_gp_l1_reg_loss: 130125.6470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79017.0864; train_chrom_access_recon_loss: 10196899.9848; train_global_loss: 25055374.5758; train_optim_loss: 25055374.5758; val_kl_reg_loss: 96287.7744; val_edge_recon_loss: 2793623.4688; val_gene_expr_recon_loss: 12035505.5000; val_masked_gp_l1_reg_loss: 130485.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78950.7578; val_chrom_access_recon_loss: 10315197.8750; val_global_loss: 25450051.7500; val_optim_loss: 25450051.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9273; val_auprc_score: 0.8995; val_best_acc_score: 0.8659; val_best_f1_score: 0.8735; train_kl_reg_loss: 97054.5719; train_edge_recon_loss: 2748725.1856; train_gene_expr_recon_loss: 11782456.8182; train_masked_gp_l1_reg_loss: 130169.9805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78532.0284; train_chrom_access_recon_loss: 10171035.2424; train_global_loss: 25007973.6061; train_optim_loss: 25007973.6061; val_kl_reg_loss: 98049.6104; val_edge_recon_loss: 2772161.8750; val_gene_expr_recon_loss: 11977512.5000; val_masked_gp_l1_reg_loss: 130334.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78608.9375; val_chrom_access_recon_loss: 10320172.8750; val_global_loss: 25376840.0000; val_optim_loss: 25376840.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9258; val_auprc_score: 0.9000; val_best_acc_score: 0.8657; val_best_f1_score: 0.8752; train_kl_reg_loss: 95144.8763; train_edge_recon_loss: 2755664.8030; train_gene_expr_recon_loss: 11749462.6364; train_masked_gp_l1_reg_loss: 130210.3459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77993.7429; train_chrom_access_recon_loss: 10142485.6818; train_global_loss: 24950962.0303; train_optim_loss: 24950962.0303; val_kl_reg_loss: 97471.6768; val_edge_recon_loss: 2774407.6875; val_gene_expr_recon_loss: 11945514.2500; val_masked_gp_l1_reg_loss: 130173.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77667.9219; val_chrom_access_recon_loss: 10251613.5000; val_global_loss: 25276849.5000; val_optim_loss: 25276849.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9246; val_auprc_score: 0.8971; val_best_acc_score: 0.8622; val_best_f1_score: 0.8720; train_kl_reg_loss: 96518.9605; train_edge_recon_loss: 2747966.9091; train_gene_expr_recon_loss: 11746314.3333; train_masked_gp_l1_reg_loss: 130220.2674; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77465.1243; train_chrom_access_recon_loss: 10134185.5303; train_global_loss: 24932671.1515; train_optim_loss: 24932671.1515; val_kl_reg_loss: 97300.0000; val_edge_recon_loss: 2785723.3750; val_gene_expr_recon_loss: 11846781.0000; val_masked_gp_l1_reg_loss: 130170.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77799.1094; val_chrom_access_recon_loss: 10196555.3750; val_global_loss: 25134329.7500; val_optim_loss: 25134329.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9173; val_auprc_score: 0.8803; val_best_acc_score: 0.8643; val_best_f1_score: 0.8754; train_kl_reg_loss: 127588.1549; train_edge_recon_loss: 2884155.3295; train_gene_expr_recon_loss: 10774760.4697; train_masked_gp_l1_reg_loss: 130634.9123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78904.5353; train_chrom_access_recon_loss: 9479837.8485; train_global_loss: 23475881.2727; train_optim_loss: 23475881.2727; val_kl_reg_loss: 29610.7241; val_edge_recon_loss: 2835022.9062; val_gene_expr_recon_loss: 10819932.1250; val_masked_gp_l1_reg_loss: 131013.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80351.7031; val_chrom_access_recon_loss: 9405601.6250; val_global_loss: 23301532.7500; val_optim_loss: 23301532.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9181; val_auprc_score: 0.8851; val_best_acc_score: 0.8573; val_best_f1_score: 0.8685; train_kl_reg_loss: 114460.6005; train_edge_recon_loss: 2803504.3447; train_gene_expr_recon_loss: 10673334.4242; train_masked_gp_l1_reg_loss: 130535.9091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80187.3731; train_chrom_access_recon_loss: 9336862.3939; train_global_loss: 23138885.0909; train_optim_loss: 23138885.0909; val_kl_reg_loss: 35314.2847; val_edge_recon_loss: 2827642.4375; val_gene_expr_recon_loss: 10765189.3750; val_masked_gp_l1_reg_loss: 129708.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80127.4297; val_chrom_access_recon_loss: 9310363.3750; val_global_loss: 23148345.7500; val_optim_loss: 23148345.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9165; val_auprc_score: 0.8785; val_best_acc_score: 0.8589; val_best_f1_score: 0.8690; train_kl_reg_loss: 97606.0458; train_edge_recon_loss: 2773847.9924; train_gene_expr_recon_loss: 10655077.5909; train_masked_gp_l1_reg_loss: 128550.4917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79512.6875; train_chrom_access_recon_loss: 9309715.2121; train_global_loss: 23044309.9091; train_optim_loss: 23044309.9091; val_kl_reg_loss: 41499.6445; val_edge_recon_loss: 2822058.2188; val_gene_expr_recon_loss: 10663224.0000; val_masked_gp_l1_reg_loss: 127513.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79581.1797; val_chrom_access_recon_loss: 9339890.3750; val_global_loss: 23073766.2500; val_optim_loss: 23073766.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9273; val_auprc_score: 0.9030; val_best_acc_score: 0.8654; val_best_f1_score: 0.8762; train_kl_reg_loss: 87482.9257; train_edge_recon_loss: 2755919.9924; train_gene_expr_recon_loss: 10634999.5758; train_masked_gp_l1_reg_loss: 126387.3162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78972.2520; train_chrom_access_recon_loss: 9290203.7424; train_global_loss: 22973965.9394; train_optim_loss: 22973965.9394; val_kl_reg_loss: 42044.2949; val_edge_recon_loss: 2776970.7812; val_gene_expr_recon_loss: 10791851.5000; val_masked_gp_l1_reg_loss: 125599.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79151.6328; val_chrom_access_recon_loss: 9367728.2500; val_global_loss: 23183345.7500; val_optim_loss: 23183345.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9329; val_auprc_score: 0.9113; val_best_acc_score: 0.8710; val_best_f1_score: 0.8811; train_kl_reg_loss: 82292.2551; train_edge_recon_loss: 2751480.7159; train_gene_expr_recon_loss: 10616301.5909; train_masked_gp_l1_reg_loss: 124747.6219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78611.5315; train_chrom_access_recon_loss: 9282036.5909; train_global_loss: 22935470.2424; train_optim_loss: 22935470.2424; val_kl_reg_loss: 47973.9868; val_edge_recon_loss: 2760733.5938; val_gene_expr_recon_loss: 10768395.8750; val_masked_gp_l1_reg_loss: 123838.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78064.3438; val_chrom_access_recon_loss: 9324633.6250; val_global_loss: 23103640.0000; val_optim_loss: 23103640.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9249; val_auprc_score: 0.8972; val_best_acc_score: 0.8665; val_best_f1_score: 0.8749; train_kl_reg_loss: 77573.9188; train_edge_recon_loss: 2748023.9508; train_gene_expr_recon_loss: 10588035.5758; train_masked_gp_l1_reg_loss: 122792.7268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77967.5153; train_chrom_access_recon_loss: 9256310.5000; train_global_loss: 22870704.0303; train_optim_loss: 22870704.0303; val_kl_reg_loss: 49915.0176; val_edge_recon_loss: 2786455.2812; val_gene_expr_recon_loss: 10696134.5000; val_masked_gp_l1_reg_loss: 121870.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77699.7812; val_chrom_access_recon_loss: 9303514.5000; val_global_loss: 23035590.5000; val_optim_loss: 23035590.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9257; val_auprc_score: 0.8980; val_best_acc_score: 0.8630; val_best_f1_score: 0.8719; train_kl_reg_loss: 75175.0120; train_edge_recon_loss: 2744488.9432; train_gene_expr_recon_loss: 10561943.0909; train_masked_gp_l1_reg_loss: 120871.4171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77588.8472; train_chrom_access_recon_loss: 9210155.9091; train_global_loss: 22790223.0606; train_optim_loss: 22790223.0606; val_kl_reg_loss: 51985.2622; val_edge_recon_loss: 2780944.5312; val_gene_expr_recon_loss: 10717696.1250; val_masked_gp_l1_reg_loss: 119861.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77961.5078; val_chrom_access_recon_loss: 9257425.8750; val_global_loss: 23005874.5000; val_optim_loss: 23005874.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9269; val_auprc_score: 0.8963; val_best_acc_score: 0.8667; val_best_f1_score: 0.8731; train_kl_reg_loss: 73838.3866; train_edge_recon_loss: 2735367.5530; train_gene_expr_recon_loss: 10520282.1970; train_masked_gp_l1_reg_loss: 118915.2524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77276.3344; train_chrom_access_recon_loss: 9175363.4697; train_global_loss: 22701043.3636; train_optim_loss: 22701043.3636; val_kl_reg_loss: 55427.1016; val_edge_recon_loss: 2786515.5625; val_gene_expr_recon_loss: 10625173.6250; val_masked_gp_l1_reg_loss: 118007.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77209.0547; val_chrom_access_recon_loss: 9232943.8750; val_global_loss: 22895277.0000; val_optim_loss: 22895277.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9286; val_auprc_score: 0.9033; val_best_acc_score: 0.8721; val_best_f1_score: 0.8782; train_kl_reg_loss: 72498.0857; train_edge_recon_loss: 2728248.1250; train_gene_expr_recon_loss: 10499149.3333; train_masked_gp_l1_reg_loss: 117197.9813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76847.8820; train_chrom_access_recon_loss: 9158495.6667; train_global_loss: 22652437.1818; train_optim_loss: 22652437.1818; val_kl_reg_loss: 55070.7222; val_edge_recon_loss: 2742792.4062; val_gene_expr_recon_loss: 10610627.2500; val_masked_gp_l1_reg_loss: 116506.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76810.4219; val_chrom_access_recon_loss: 9234655.5000; val_global_loss: 22836462.5000; val_optim_loss: 22836462.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9271; val_auprc_score: 0.8987; val_best_acc_score: 0.8684; val_best_f1_score: 0.8742; train_kl_reg_loss: 72964.0142; train_edge_recon_loss: 2730932.0606; train_gene_expr_recon_loss: 10478131.4697; train_masked_gp_l1_reg_loss: 115683.1483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76556.6429; train_chrom_access_recon_loss: 9139186.7121; train_global_loss: 22613454.1212; train_optim_loss: 22613454.1212; val_kl_reg_loss: 57299.6211; val_edge_recon_loss: 2778716.8438; val_gene_expr_recon_loss: 10639997.0000; val_masked_gp_l1_reg_loss: 114995.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76294.1953; val_chrom_access_recon_loss: 9203149.8750; val_global_loss: 22870453.2500; val_optim_loss: 22870453.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9322; val_auprc_score: 0.9083; val_best_acc_score: 0.8713; val_best_f1_score: 0.8815; train_kl_reg_loss: 72585.1766; train_edge_recon_loss: 2729020.1098; train_gene_expr_recon_loss: 10462882.0152; train_masked_gp_l1_reg_loss: 114251.2689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76046.9343; train_chrom_access_recon_loss: 9127795.7273; train_global_loss: 22582581.2121; train_optim_loss: 22582581.2121; val_kl_reg_loss: 58708.1113; val_edge_recon_loss: 2740351.6875; val_gene_expr_recon_loss: 10583544.7500; val_masked_gp_l1_reg_loss: 113462.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75923.1953; val_chrom_access_recon_loss: 9242433.6250; val_global_loss: 22814423.5000; val_optim_loss: 22814423.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9295; val_auprc_score: 0.8999; val_best_acc_score: 0.8716; val_best_f1_score: 0.8807; train_kl_reg_loss: 71705.8183; train_edge_recon_loss: 2714942.0379; train_gene_expr_recon_loss: 10435280.3333; train_masked_gp_l1_reg_loss: 112741.2153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75566.3938; train_chrom_access_recon_loss: 9103596.8333; train_global_loss: 22513832.3939; train_optim_loss: 22513832.3939; val_kl_reg_loss: 59412.0684; val_edge_recon_loss: 2765321.5938; val_gene_expr_recon_loss: 10598844.8750; val_masked_gp_l1_reg_loss: 112131.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75724.5625; val_chrom_access_recon_loss: 9110989.3750; val_global_loss: 22722425.0000; val_optim_loss: 22722425.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9329; val_auprc_score: 0.9046; val_best_acc_score: 0.8713; val_best_f1_score: 0.8797; train_kl_reg_loss: 70348.2434; train_edge_recon_loss: 2710371.5379; train_gene_expr_recon_loss: 10433332.2273; train_masked_gp_l1_reg_loss: 111518.8829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75269.0215; train_chrom_access_recon_loss: 9089424.9545; train_global_loss: 22490264.9697; train_optim_loss: 22490264.9697; val_kl_reg_loss: 61828.3604; val_edge_recon_loss: 2765527.6875; val_gene_expr_recon_loss: 10544858.7500; val_masked_gp_l1_reg_loss: 111066.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75278.8906; val_chrom_access_recon_loss: 9144649.7500; val_global_loss: 22703209.2500; val_optim_loss: 22703209.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9281; val_auprc_score: 0.8984; val_best_acc_score: 0.8764; val_best_f1_score: 0.8832; train_kl_reg_loss: 70558.8400; train_edge_recon_loss: 2717764.5606; train_gene_expr_recon_loss: 10426614.1212; train_masked_gp_l1_reg_loss: 110726.8851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75034.3326; train_chrom_access_recon_loss: 9085742.8182; train_global_loss: 22486441.6970; train_optim_loss: 22486441.6970; val_kl_reg_loss: 60129.1763; val_edge_recon_loss: 2735751.1875; val_gene_expr_recon_loss: 10542642.0000; val_masked_gp_l1_reg_loss: 110287.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74864.0938; val_chrom_access_recon_loss: 9141051.1250; val_global_loss: 22664724.5000; val_optim_loss: 22664724.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9332; val_auprc_score: 0.9109; val_best_acc_score: 0.8748; val_best_f1_score: 0.8828; train_kl_reg_loss: 71695.5449; train_edge_recon_loss: 2716457.5455; train_gene_expr_recon_loss: 10389671.8485; train_masked_gp_l1_reg_loss: 109879.6429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74768.3577; train_chrom_access_recon_loss: 9056744.1515; train_global_loss: 22419217.0303; train_optim_loss: 22419217.0303; val_kl_reg_loss: 59985.6479; val_edge_recon_loss: 2753378.1562; val_gene_expr_recon_loss: 10567880.8750; val_masked_gp_l1_reg_loss: 109280.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74841.9609; val_chrom_access_recon_loss: 9162924.7500; val_global_loss: 22728291.5000; val_optim_loss: 22728291.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9376; val_auprc_score: 0.9122; val_best_acc_score: 0.8807; val_best_f1_score: 0.8875; train_kl_reg_loss: 69962.0775; train_edge_recon_loss: 2719589.0076; train_gene_expr_recon_loss: 10386238.3333; train_masked_gp_l1_reg_loss: 108779.0318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74554.2910; train_chrom_access_recon_loss: 9058004.8788; train_global_loss: 22417127.8485; train_optim_loss: 22417127.8485; val_kl_reg_loss: 60834.8101; val_edge_recon_loss: 2712473.7500; val_gene_expr_recon_loss: 10430394.1250; val_masked_gp_l1_reg_loss: 108329.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74528.6094; val_chrom_access_recon_loss: 9019080.1250; val_global_loss: 22405641.0000; val_optim_loss: 22405641.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9324; val_auprc_score: 0.8994; val_best_acc_score: 0.8772; val_best_f1_score: 0.8847; train_kl_reg_loss: 68877.9289; train_edge_recon_loss: 2709987.5076; train_gene_expr_recon_loss: 10373282.6818; train_masked_gp_l1_reg_loss: 107823.4599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74513.3400; train_chrom_access_recon_loss: 9037496.9545; train_global_loss: 22371981.8182; train_optim_loss: 22371981.8182; val_kl_reg_loss: 61257.3022; val_edge_recon_loss: 2753194.0938; val_gene_expr_recon_loss: 10549348.0000; val_masked_gp_l1_reg_loss: 107398.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74287.6094; val_chrom_access_recon_loss: 9124988.5000; val_global_loss: 22670474.7500; val_optim_loss: 22670474.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9365; val_auprc_score: 0.9046; val_best_acc_score: 0.8831; val_best_f1_score: 0.8878; train_kl_reg_loss: 70014.2412; train_edge_recon_loss: 2708361.2273; train_gene_expr_recon_loss: 10353362.3485; train_masked_gp_l1_reg_loss: 107033.0498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74313.2272; train_chrom_access_recon_loss: 9018507.5606; train_global_loss: 22331591.6970; train_optim_loss: 22331591.6970; val_kl_reg_loss: 63812.3184; val_edge_recon_loss: 2728823.5625; val_gene_expr_recon_loss: 10425580.2500; val_masked_gp_l1_reg_loss: 106527.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74458.1328; val_chrom_access_recon_loss: 9083437.6250; val_global_loss: 22482639.0000; val_optim_loss: 22482639.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9307; val_auprc_score: 0.9035; val_best_acc_score: 0.8767; val_best_f1_score: 0.8825; train_kl_reg_loss: 69811.9548; train_edge_recon_loss: 2698061.2424; train_gene_expr_recon_loss: 10339079.7576; train_masked_gp_l1_reg_loss: 105917.8597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74214.0104; train_chrom_access_recon_loss: 9001292.8485; train_global_loss: 22288377.5455; train_optim_loss: 22288377.5455; val_kl_reg_loss: 64387.2114; val_edge_recon_loss: 2755018.3125; val_gene_expr_recon_loss: 10436178.1250; val_masked_gp_l1_reg_loss: 105507.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73991.0547; val_chrom_access_recon_loss: 9058845.0000; val_global_loss: 22493927.5000; val_optim_loss: 22493927.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9363; val_auprc_score: 0.9073; val_best_acc_score: 0.8769; val_best_f1_score: 0.8851; train_kl_reg_loss: 68400.2585; train_edge_recon_loss: 2714924.1098; train_gene_expr_recon_loss: 10330129.2273; train_masked_gp_l1_reg_loss: 105072.2098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73968.7116; train_chrom_access_recon_loss: 8996643.0152; train_global_loss: 22289137.6061; train_optim_loss: 22289137.6061; val_kl_reg_loss: 62844.1846; val_edge_recon_loss: 2728631.6250; val_gene_expr_recon_loss: 10465359.5000; val_masked_gp_l1_reg_loss: 104963.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73874.1484; val_chrom_access_recon_loss: 9115274.3750; val_global_loss: 22550947.5000; val_optim_loss: 22550947.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9350; val_auprc_score: 0.9087; val_best_acc_score: 0.8726; val_best_f1_score: 0.8803; train_kl_reg_loss: 68553.4393; train_edge_recon_loss: 2705042.3788; train_gene_expr_recon_loss: 10306990.6515; train_masked_gp_l1_reg_loss: 102247.3616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61525.0040; train_chrom_access_recon_loss: 8975324.9848; train_global_loss: 22219683.9394; train_optim_loss: 22219683.9394; val_kl_reg_loss: 64138.6201; val_edge_recon_loss: 2762975.6250; val_gene_expr_recon_loss: 10458279.6250; val_masked_gp_l1_reg_loss: 101503.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59117.4453; val_chrom_access_recon_loss: 9057291.7500; val_global_loss: 22503305.7500; val_optim_loss: 22503305.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9404; val_auprc_score: 0.9139; val_best_acc_score: 0.8858; val_best_f1_score: 0.8919; train_kl_reg_loss: 69637.2421; train_edge_recon_loss: 2706411.9962; train_gene_expr_recon_loss: 10300295.2727; train_masked_gp_l1_reg_loss: 101382.1301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58794.8016; train_chrom_access_recon_loss: 8974349.4394; train_global_loss: 22210870.7879; train_optim_loss: 22210870.7879; val_kl_reg_loss: 64621.9141; val_edge_recon_loss: 2722334.5312; val_gene_expr_recon_loss: 10425992.0000; val_masked_gp_l1_reg_loss: 101268.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58589.0156; val_chrom_access_recon_loss: 9029529.5000; val_global_loss: 22402334.7500; val_optim_loss: 22402334.7500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9386; val_auprc_score: 0.9137; val_best_acc_score: 0.8831; val_best_f1_score: 0.8898; train_kl_reg_loss: 70542.8952; train_edge_recon_loss: 2710136.7462; train_gene_expr_recon_loss: 10294225.3788; train_masked_gp_l1_reg_loss: 101180.9658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58411.3781; train_chrom_access_recon_loss: 8971071.2879; train_global_loss: 22205568.6667; train_optim_loss: 22205568.6667; val_kl_reg_loss: 65738.0161; val_edge_recon_loss: 2743802.1562; val_gene_expr_recon_loss: 10461748.5000; val_masked_gp_l1_reg_loss: 101085.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58239.4375; val_chrom_access_recon_loss: 9045198.2500; val_global_loss: 22475810.5000; val_optim_loss: 22475810.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9404; val_auprc_score: 0.9074; val_best_acc_score: 0.8869; val_best_f1_score: 0.8921; train_kl_reg_loss: 70998.0328; train_edge_recon_loss: 2701952.8182; train_gene_expr_recon_loss: 10288678.8030; train_masked_gp_l1_reg_loss: 101005.4277; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58143.3516; train_chrom_access_recon_loss: 8953072.7576; train_global_loss: 22173851.4242; train_optim_loss: 22173851.4242; val_kl_reg_loss: 65610.0332; val_edge_recon_loss: 2711943.2500; val_gene_expr_recon_loss: 10441189.6250; val_masked_gp_l1_reg_loss: 100932.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58002.5234; val_chrom_access_recon_loss: 9032545.3750; val_global_loss: 22410224.5000; val_optim_loss: 22410224.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9399; val_auprc_score: 0.9186; val_best_acc_score: 0.8818; val_best_f1_score: 0.8917; train_kl_reg_loss: 70561.3841; train_edge_recon_loss: 2714258.0455; train_gene_expr_recon_loss: 10292049.0152; train_masked_gp_l1_reg_loss: 100837.9175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57871.8633; train_chrom_access_recon_loss: 8954699.7424; train_global_loss: 22190278.0303; train_optim_loss: 22190278.0303; val_kl_reg_loss: 65651.8008; val_edge_recon_loss: 2711538.5312; val_gene_expr_recon_loss: 10410765.5000; val_masked_gp_l1_reg_loss: 100778.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57891.6250; val_chrom_access_recon_loss: 8956381.6875; val_global_loss: 22303008.5000; val_optim_loss: 22303008.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9321; val_auprc_score: 0.9090; val_best_acc_score: 0.8702; val_best_f1_score: 0.8792; train_kl_reg_loss: 70450.6566; train_edge_recon_loss: 2702666.0038; train_gene_expr_recon_loss: 10297056.1818; train_masked_gp_l1_reg_loss: 100703.3275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57748.6979; train_chrom_access_recon_loss: 8965436.3939; train_global_loss: 22194061.3030; train_optim_loss: 22194061.3030; val_kl_reg_loss: 66053.3174; val_edge_recon_loss: 2774708.7812; val_gene_expr_recon_loss: 10386855.2500; val_masked_gp_l1_reg_loss: 100636.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57680.3125; val_chrom_access_recon_loss: 8938442.6875; val_global_loss: 22324377.2500; val_optim_loss: 22324377.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9341; val_auprc_score: 0.9087; val_best_acc_score: 0.8775; val_best_f1_score: 0.8849; train_kl_reg_loss: 70997.0183; train_edge_recon_loss: 2711048.4773; train_gene_expr_recon_loss: 10299799.9848; train_masked_gp_l1_reg_loss: 100578.8829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57608.1123; train_chrom_access_recon_loss: 8964818.5455; train_global_loss: 22204850.8788; train_optim_loss: 22204850.8788; val_kl_reg_loss: 66225.8838; val_edge_recon_loss: 2743370.0312; val_gene_expr_recon_loss: 10350373.0000; val_masked_gp_l1_reg_loss: 100526.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57472.8516; val_chrom_access_recon_loss: 8952717.7500; val_global_loss: 22270685.7500; val_optim_loss: 22270685.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9332; val_auprc_score: 0.8958; val_best_acc_score: 0.8818; val_best_f1_score: 0.8892; train_kl_reg_loss: 71128.4862; train_edge_recon_loss: 2702234.2841; train_gene_expr_recon_loss: 10294637.7424; train_masked_gp_l1_reg_loss: 100449.3949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57356.7264; train_chrom_access_recon_loss: 8965694.6515; train_global_loss: 22191501.0909; train_optim_loss: 22191501.0909; val_kl_reg_loss: 65440.1494; val_edge_recon_loss: 2714780.1250; val_gene_expr_recon_loss: 10426918.8750; val_masked_gp_l1_reg_loss: 100390.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57259.0039; val_chrom_access_recon_loss: 9090110.8750; val_global_loss: 22454898.7500; val_optim_loss: 22454898.7500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9405; val_auprc_score: 0.9138; val_best_acc_score: 0.8804; val_best_f1_score: 0.8869; train_kl_reg_loss: 70569.8732; train_edge_recon_loss: 2704137.1629; train_gene_expr_recon_loss: 10293714.5455; train_masked_gp_l1_reg_loss: 100339.9277; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57169.0041; train_chrom_access_recon_loss: 8958666.4545; train_global_loss: 22184597.0303; train_optim_loss: 22184597.0303; val_kl_reg_loss: 65790.4883; val_edge_recon_loss: 2719211.3750; val_gene_expr_recon_loss: 10378760.7500; val_masked_gp_l1_reg_loss: 100281.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57206.5508; val_chrom_access_recon_loss: 9015571.3750; val_global_loss: 22336821.7500; val_optim_loss: 22336821.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9379; val_auprc_score: 0.9084; val_best_acc_score: 0.8834; val_best_f1_score: 0.8901; train_kl_reg_loss: 70425.5999; train_edge_recon_loss: 2706307.2727; train_gene_expr_recon_loss: 10290339.3636; train_masked_gp_l1_reg_loss: 100206.2463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57063.8999; train_chrom_access_recon_loss: 8959261.1061; train_global_loss: 22183603.4242; train_optim_loss: 22183603.4242; val_kl_reg_loss: 66264.7046; val_edge_recon_loss: 2713764.2188; val_gene_expr_recon_loss: 10390155.5000; val_masked_gp_l1_reg_loss: 100139.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56992.8438; val_chrom_access_recon_loss: 9065904.8750; val_global_loss: 22393221.0000; val_optim_loss: 22393221.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9362; val_auprc_score: 0.9123; val_best_acc_score: 0.8761; val_best_f1_score: 0.8832; train_kl_reg_loss: 70976.1054; train_edge_recon_loss: 2708924.7500; train_gene_expr_recon_loss: 10289193.6364; train_masked_gp_l1_reg_loss: 100090.2584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56903.7022; train_chrom_access_recon_loss: 8961859.6364; train_global_loss: 22187948.0303; train_optim_loss: 22187948.0303; val_kl_reg_loss: 66077.3940; val_edge_recon_loss: 2747731.2812; val_gene_expr_recon_loss: 10374232.8750; val_masked_gp_l1_reg_loss: 100002.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56804.3164; val_chrom_access_recon_loss: 8986610.7500; val_global_loss: 22331459.7500; val_optim_loss: 22331459.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9404; val_auprc_score: 0.9135; val_best_acc_score: 0.8850; val_best_f1_score: 0.8916; train_kl_reg_loss: 70730.9820; train_edge_recon_loss: 2704149.8902; train_gene_expr_recon_loss: 10274890.5455; train_masked_gp_l1_reg_loss: 99723.5268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55488.7431; train_chrom_access_recon_loss: 8944597.0152; train_global_loss: 22149580.8182; train_optim_loss: 22149580.8182; val_kl_reg_loss: 65612.4912; val_edge_recon_loss: 2719875.4375; val_gene_expr_recon_loss: 10339732.2500; val_masked_gp_l1_reg_loss: 99645.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55235.3633; val_chrom_access_recon_loss: 9065117.7500; val_global_loss: 22345218.0000; val_optim_loss: 22345218.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9334; val_auprc_score: 0.9088; val_best_acc_score: 0.8786; val_best_f1_score: 0.8862; train_kl_reg_loss: 70767.4915; train_edge_recon_loss: 2697739.2424; train_gene_expr_recon_loss: 10286271.6061; train_masked_gp_l1_reg_loss: 99626.7990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55211.4373; train_chrom_access_recon_loss: 8950833.5909; train_global_loss: 22160450.0606; train_optim_loss: 22160450.0606; val_kl_reg_loss: 66594.8418; val_edge_recon_loss: 2742771.4688; val_gene_expr_recon_loss: 10428483.6250; val_masked_gp_l1_reg_loss: 99612.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55191.1875; val_chrom_access_recon_loss: 8985765.1250; val_global_loss: 22378418.0000; val_optim_loss: 22378418.0000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9387; val_auprc_score: 0.9147; val_best_acc_score: 0.8815; val_best_f1_score: 0.8868; train_kl_reg_loss: 70739.0898; train_edge_recon_loss: 2700994.8106; train_gene_expr_recon_loss: 10282832.6515; train_masked_gp_l1_reg_loss: 99601.4429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55171.4421; train_chrom_access_recon_loss: 8960605.5909; train_global_loss: 22169945.1212; train_optim_loss: 22169945.1212; val_kl_reg_loss: 66003.1689; val_edge_recon_loss: 2721764.4062; val_gene_expr_recon_loss: 10381197.8750; val_masked_gp_l1_reg_loss: 99590.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55152.2734; val_chrom_access_recon_loss: 8996599.6250; val_global_loss: 22320308.0000; val_optim_loss: 22320308.0000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9392; val_auprc_score: 0.9119; val_best_acc_score: 0.8821; val_best_f1_score: 0.8891; train_kl_reg_loss: 70868.6506; train_edge_recon_loss: 2716098.3409; train_gene_expr_recon_loss: 10293479.7879; train_masked_gp_l1_reg_loss: 99583.0413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55137.1467; train_chrom_access_recon_loss: 8961190.1364; train_global_loss: 22196357.1818; train_optim_loss: 22196357.1818; val_kl_reg_loss: 66218.5557; val_edge_recon_loss: 2737248.6250; val_gene_expr_recon_loss: 10436660.2500; val_masked_gp_l1_reg_loss: 99574.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55123.2773; val_chrom_access_recon_loss: 9026527.2500; val_global_loss: 22421351.7500; val_optim_loss: 22421351.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 28 min 31 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9415
val AUPRC score: 0.9195
val best accuracy score: 0.8818
val best F1 score: 0.8883
val target rna MSE score: 2.4034
val source rna MSE score: 1.1192
val target atac MSE score: 0.3198
val source atac MSE score: 0.1318
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
