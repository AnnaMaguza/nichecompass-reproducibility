[True]
Run timestamp: 10082023_223240_80.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_80']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7639; val_auprc_score: 0.7838; val_best_acc_score: 0.5023; val_best_f1_score: 0.6677; train_kl_reg_loss: 156907.1228; train_edge_recon_loss: 3714811.0973; train_gene_expr_recon_loss: 44170004.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4104749.2710; train_global_loss: 52146472.3969; train_optim_loss: 52146472.3969; val_kl_reg_loss: 267852.1365; val_edge_recon_loss: 4064990.0833; val_gene_expr_recon_loss: 38405485.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3928382.0667; val_global_loss: 46666709.0667; val_optim_loss: 46666709.0667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8125; val_auprc_score: 0.8217; val_best_acc_score: 0.6834; val_best_f1_score: 0.7410; train_kl_reg_loss: 232747.0056; train_edge_recon_loss: 3605007.8550; train_gene_expr_recon_loss: 37464100.0916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3823284.5954; train_global_loss: 45125139.6947; train_optim_loss: 45125139.6947; val_kl_reg_loss: 235487.7260; val_edge_recon_loss: 4045981.9500; val_gene_expr_recon_loss: 37381547.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3868983.7833; val_global_loss: 45532000.5333; val_optim_loss: 45532000.5333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8851; val_auprc_score: 0.8828; val_best_acc_score: 0.7730; val_best_f1_score: 0.7844; train_kl_reg_loss: 195077.0630; train_edge_recon_loss: 3564407.6603; train_gene_expr_recon_loss: 36919947.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3791783.1908; train_global_loss: 44471215.3588; train_optim_loss: 44471215.3588; val_kl_reg_loss: 182628.7812; val_edge_recon_loss: 3947397.0500; val_gene_expr_recon_loss: 37021273.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3845517.2167; val_global_loss: 44996816.5333; val_optim_loss: 44996816.5333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9073; val_auprc_score: 0.8990; val_best_acc_score: 0.8244; val_best_f1_score: 0.8355; train_kl_reg_loss: 162511.1172; train_edge_recon_loss: 3474932.8302; train_gene_expr_recon_loss: 36570545.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3766280.5859; train_global_loss: 43974269.7710; train_optim_loss: 43974269.7710; val_kl_reg_loss: 157913.0792; val_edge_recon_loss: 3483259.1333; val_gene_expr_recon_loss: 36706859.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3817028.9167; val_global_loss: 44165060.5333; val_optim_loss: 44165060.5333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9023; val_auprc_score: 0.8916; val_best_acc_score: 0.8155; val_best_f1_score: 0.8300; train_kl_reg_loss: 169954.8681; train_edge_recon_loss: 3169228.9427; train_gene_expr_recon_loss: 36382241.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3753997.9771; train_global_loss: 43475423.7252; train_optim_loss: 43475423.7252; val_kl_reg_loss: 188927.6208; val_edge_recon_loss: 3043174.1500; val_gene_expr_recon_loss: 36439455.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3800953.6833; val_global_loss: 43472510.9333; val_optim_loss: 43472510.9333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9201; val_auprc_score: 0.9104; val_best_acc_score: 0.8399; val_best_f1_score: 0.8513; train_kl_reg_loss: 187554.9924; train_edge_recon_loss: 2970538.2595; train_gene_expr_recon_loss: 36126525.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3737233.9618; train_global_loss: 43021852.3969; train_optim_loss: 43021852.3969; val_kl_reg_loss: 184540.5146; val_edge_recon_loss: 2965253.5333; val_gene_expr_recon_loss: 36092749.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3774731.3000; val_global_loss: 43017274.4000; val_optim_loss: 43017274.4000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9284; val_auprc_score: 0.9151; val_best_acc_score: 0.8580; val_best_f1_score: 0.8667; train_kl_reg_loss: 181383.1089; train_edge_recon_loss: 2936281.4905; train_gene_expr_recon_loss: 35864364.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3713504.1393; train_global_loss: 42695533.1603; train_optim_loss: 42695533.1603; val_kl_reg_loss: 182416.3760; val_edge_recon_loss: 2908466.1167; val_gene_expr_recon_loss: 36096188.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3776413.0500; val_global_loss: 42963483.7333; val_optim_loss: 42963483.7333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9381; val_auprc_score: 0.9276; val_best_acc_score: 0.8725; val_best_f1_score: 0.8781; train_kl_reg_loss: 177420.8251; train_edge_recon_loss: 2896167.2023; train_gene_expr_recon_loss: 35697472.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3700969.1737; train_global_loss: 42472029.5573; train_optim_loss: 42472029.5573; val_kl_reg_loss: 178336.1521; val_edge_recon_loss: 2891574.6667; val_gene_expr_recon_loss: 35814710.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3746298.8167; val_global_loss: 42630919.4667; val_optim_loss: 42630919.4667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9372; val_auprc_score: 0.9263; val_best_acc_score: 0.8746; val_best_f1_score: 0.8817; train_kl_reg_loss: 169849.8597; train_edge_recon_loss: 2886723.5821; train_gene_expr_recon_loss: 35505146.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3687395.4218; train_global_loss: 42249115.3282; train_optim_loss: 42249115.3282; val_kl_reg_loss: 165534.8406; val_edge_recon_loss: 2877977.3500; val_gene_expr_recon_loss: 35729286.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3748658.5167; val_global_loss: 42521456.8000; val_optim_loss: 42521456.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9427; val_auprc_score: 0.9315; val_best_acc_score: 0.8775; val_best_f1_score: 0.8840; train_kl_reg_loss: 160133.5675; train_edge_recon_loss: 2869675.2099; train_gene_expr_recon_loss: 35380108.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3676945.5935; train_global_loss: 42086862.5954; train_optim_loss: 42086862.5954; val_kl_reg_loss: 155428.4250; val_edge_recon_loss: 2857733.6500; val_gene_expr_recon_loss: 35504022.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3721310.4667; val_global_loss: 42238495.7333; val_optim_loss: 42238495.7333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9402; val_auprc_score: 0.9276; val_best_acc_score: 0.8774; val_best_f1_score: 0.8843; train_kl_reg_loss: 155653.6131; train_edge_recon_loss: 2845274.6050; train_gene_expr_recon_loss: 35276921.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3670393.5248; train_global_loss: 41948243.2061; train_optim_loss: 41948243.2061; val_kl_reg_loss: 158206.9031; val_edge_recon_loss: 2845448.1667; val_gene_expr_recon_loss: 35358766.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3724748.7667; val_global_loss: 42087170.1333; val_optim_loss: 42087170.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9421; val_auprc_score: 0.9265; val_best_acc_score: 0.8874; val_best_f1_score: 0.8930; train_kl_reg_loss: 150092.6836; train_edge_recon_loss: 2845095.7863; train_gene_expr_recon_loss: 35141493.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3660359.3969; train_global_loss: 41797041.8626; train_optim_loss: 41797041.8626; val_kl_reg_loss: 145025.2104; val_edge_recon_loss: 2836902.1667; val_gene_expr_recon_loss: 35292849.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3718475.2333; val_global_loss: 41993252.5333; val_optim_loss: 41993252.5333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9475; val_auprc_score: 0.9401; val_best_acc_score: 0.8852; val_best_f1_score: 0.8887; train_kl_reg_loss: 144335.6535; train_edge_recon_loss: 2830002.1947; train_gene_expr_recon_loss: 35055141.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3654303.7634; train_global_loss: 41683783.4198; train_optim_loss: 41683783.4198; val_kl_reg_loss: 140193.2615; val_edge_recon_loss: 2854566.5333; val_gene_expr_recon_loss: 35167766.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3705917.7000; val_global_loss: 41868443.7333; val_optim_loss: 41868443.7333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9475; val_auprc_score: 0.9343; val_best_acc_score: 0.8902; val_best_f1_score: 0.8953; train_kl_reg_loss: 139593.4987; train_edge_recon_loss: 2820638.5668; train_gene_expr_recon_loss: 34915830.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3642187.0038; train_global_loss: 41518249.3740; train_optim_loss: 41518249.3740; val_kl_reg_loss: 138321.6604; val_edge_recon_loss: 2824712.4333; val_gene_expr_recon_loss: 35229124.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3719491.4500; val_global_loss: 41911650.1333; val_optim_loss: 41911650.1333
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9539; val_auprc_score: 0.9457; val_best_acc_score: 0.8942; val_best_f1_score: 0.8970; train_kl_reg_loss: 134185.0849; train_edge_recon_loss: 2809783.7061; train_gene_expr_recon_loss: 34841843.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3637604.9943; train_global_loss: 41423417.0382; train_optim_loss: 41423417.0382; val_kl_reg_loss: 133262.6427; val_edge_recon_loss: 2808494.0000; val_gene_expr_recon_loss: 34984249.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3696271.7333; val_global_loss: 41622276.8000; val_optim_loss: 41622276.8000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9545; val_auprc_score: 0.9469; val_best_acc_score: 0.8903; val_best_f1_score: 0.8953; train_kl_reg_loss: 131196.7248; train_edge_recon_loss: 2812529.3359; train_gene_expr_recon_loss: 34745023.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3632924.2939; train_global_loss: 41321673.7405; train_optim_loss: 41321673.7405; val_kl_reg_loss: 125535.5047; val_edge_recon_loss: 2826691.7167; val_gene_expr_recon_loss: 34926990.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3690129.7500; val_global_loss: 41569348.0000; val_optim_loss: 41569348.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9591; val_auprc_score: 0.9523; val_best_acc_score: 0.8989; val_best_f1_score: 0.9033; train_kl_reg_loss: 126630.8158; train_edge_recon_loss: 2793773.5286; train_gene_expr_recon_loss: 34683744.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3630034.4218; train_global_loss: 41234183.3893; train_optim_loss: 41234183.3893; val_kl_reg_loss: 126559.6906; val_edge_recon_loss: 2794684.3500; val_gene_expr_recon_loss: 34913522.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3694614.6500; val_global_loss: 41529381.6000; val_optim_loss: 41529381.6000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9579; val_auprc_score: 0.9486; val_best_acc_score: 0.8959; val_best_f1_score: 0.9005; train_kl_reg_loss: 124807.0137; train_edge_recon_loss: 2788903.5115; train_gene_expr_recon_loss: 34591043.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3621776.4962; train_global_loss: 41126530.4427; train_optim_loss: 41126530.4427; val_kl_reg_loss: 124064.8536; val_edge_recon_loss: 2802497.4167; val_gene_expr_recon_loss: 34996682.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3696485.5667; val_global_loss: 41619731.7333; val_optim_loss: 41619731.7333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9601; val_auprc_score: 0.9522; val_best_acc_score: 0.8983; val_best_f1_score: 0.9029; train_kl_reg_loss: 122139.7493; train_edge_recon_loss: 2778949.4389; train_gene_expr_recon_loss: 34540362.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3621042.2691; train_global_loss: 41062493.5878; train_optim_loss: 41062493.5878; val_kl_reg_loss: 120029.2047; val_edge_recon_loss: 2781147.4667; val_gene_expr_recon_loss: 34826141.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3687866.7333; val_global_loss: 41415185.3333; val_optim_loss: 41415185.3333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9612; val_auprc_score: 0.9542; val_best_acc_score: 0.9030; val_best_f1_score: 0.9078; train_kl_reg_loss: 119367.6674; train_edge_recon_loss: 2772402.3321; train_gene_expr_recon_loss: 34487045.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3620412.2863; train_global_loss: 40999227.8168; train_optim_loss: 40999227.8168; val_kl_reg_loss: 119087.8359; val_edge_recon_loss: 2774349.3500; val_gene_expr_recon_loss: 34719446.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3682940.3000; val_global_loss: 41295824.0000; val_optim_loss: 41295824.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9637; val_auprc_score: 0.9567; val_best_acc_score: 0.9066; val_best_f1_score: 0.9103; train_kl_reg_loss: 117287.3984; train_edge_recon_loss: 2763519.9828; train_gene_expr_recon_loss: 34398920.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3616269.8683; train_global_loss: 40895998.0458; train_optim_loss: 40895998.0458; val_kl_reg_loss: 117352.6281; val_edge_recon_loss: 2774267.9000; val_gene_expr_recon_loss: 34718909.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3678730.2833; val_global_loss: 41289260.5333; val_optim_loss: 41289260.5333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9672; val_auprc_score: 0.9629; val_best_acc_score: 0.9108; val_best_f1_score: 0.9135; train_kl_reg_loss: 115354.3697; train_edge_recon_loss: 2761407.7137; train_gene_expr_recon_loss: 34342505.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3612293.9294; train_global_loss: 40831561.6183; train_optim_loss: 40831561.6183; val_kl_reg_loss: 112520.3755; val_edge_recon_loss: 2764161.4167; val_gene_expr_recon_loss: 34589215.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3674929.9667; val_global_loss: 41140826.9333; val_optim_loss: 41140826.9333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9659; val_auprc_score: 0.9598; val_best_acc_score: 0.9099; val_best_f1_score: 0.9133; train_kl_reg_loss: 112056.3087; train_edge_recon_loss: 2762581.6240; train_gene_expr_recon_loss: 34260920.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3608228.3760; train_global_loss: 40743787.2977; train_optim_loss: 40743787.2977; val_kl_reg_loss: 112295.6151; val_edge_recon_loss: 2748835.5667; val_gene_expr_recon_loss: 34553419.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3670261.2167; val_global_loss: 41084810.9333; val_optim_loss: 41084810.9333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9676; val_auprc_score: 0.9615; val_best_acc_score: 0.9134; val_best_f1_score: 0.9168; train_kl_reg_loss: 111575.3276; train_edge_recon_loss: 2743882.4313; train_gene_expr_recon_loss: 34193936.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3604726.4160; train_global_loss: 40654120.3359; train_optim_loss: 40654120.3359; val_kl_reg_loss: 111584.5969; val_edge_recon_loss: 2754253.2333; val_gene_expr_recon_loss: 34632705.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3685642.9500; val_global_loss: 41184186.4000; val_optim_loss: 41184186.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9673; val_auprc_score: 0.9590; val_best_acc_score: 0.9095; val_best_f1_score: 0.9142; train_kl_reg_loss: 109449.4402; train_edge_recon_loss: 2742988.9275; train_gene_expr_recon_loss: 34144710.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3605471.9561; train_global_loss: 40602621.2824; train_optim_loss: 40602621.2824; val_kl_reg_loss: 108690.9870; val_edge_recon_loss: 2768753.3667; val_gene_expr_recon_loss: 34479019.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3665548.5667; val_global_loss: 41022012.2667; val_optim_loss: 41022012.2667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9722; val_auprc_score: 0.9660; val_best_acc_score: 0.9184; val_best_f1_score: 0.9205; train_kl_reg_loss: 112511.6657; train_edge_recon_loss: 2795316.7214; train_gene_expr_recon_loss: 35693671.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3717467.4809; train_global_loss: 42318967.0840; train_optim_loss: 42318967.0840; val_kl_reg_loss: 60219.9596; val_edge_recon_loss: 2789247.5167; val_gene_expr_recon_loss: 35951973.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3766283.9333; val_global_loss: 42567724.8000; val_optim_loss: 42567724.8000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9692; val_auprc_score: 0.9603; val_best_acc_score: 0.9157; val_best_f1_score: 0.9183; train_kl_reg_loss: 111682.2353; train_edge_recon_loss: 2773575.2824; train_gene_expr_recon_loss: 35517637.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3682315.9237; train_global_loss: 42085210.7786; train_optim_loss: 42085210.7786; val_kl_reg_loss: 64285.6849; val_edge_recon_loss: 2799040.7000; val_gene_expr_recon_loss: 35978448.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3758561.6333; val_global_loss: 42600336.5333; val_optim_loss: 42600336.5333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9722; val_auprc_score: 0.9656; val_best_acc_score: 0.9227; val_best_f1_score: 0.9245; train_kl_reg_loss: 107151.0258; train_edge_recon_loss: 2746015.0744; train_gene_expr_recon_loss: 35410046.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3674768.4828; train_global_loss: 41937981.6489; train_optim_loss: 41937981.6489; val_kl_reg_loss: 67469.4682; val_edge_recon_loss: 2757783.0667; val_gene_expr_recon_loss: 35801414.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3749805.5667; val_global_loss: 42376472.5333; val_optim_loss: 42376472.5333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9743; val_auprc_score: 0.9690; val_best_acc_score: 0.9271; val_best_f1_score: 0.9288; train_kl_reg_loss: 102649.1023; train_edge_recon_loss: 2740967.7099; train_gene_expr_recon_loss: 35301645.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3665868.5534; train_global_loss: 41811130.7481; train_optim_loss: 41811130.7481; val_kl_reg_loss: 69243.8750; val_edge_recon_loss: 2737301.9333; val_gene_expr_recon_loss: 35626578.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3743965.8333; val_global_loss: 42177091.2000; val_optim_loss: 42177091.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9761; val_auprc_score: 0.9709; val_best_acc_score: 0.9254; val_best_f1_score: 0.9277; train_kl_reg_loss: 100622.7646; train_edge_recon_loss: 2742183.2042; train_gene_expr_recon_loss: 35202456.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3659224.5115; train_global_loss: 41704486.8092; train_optim_loss: 41704486.8092; val_kl_reg_loss: 70329.4297; val_edge_recon_loss: 2735123.0500; val_gene_expr_recon_loss: 35433602.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3705198.9833; val_global_loss: 41944254.6667; val_optim_loss: 41944254.6667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9742; val_auprc_score: 0.9684; val_best_acc_score: 0.9225; val_best_f1_score: 0.9243; train_kl_reg_loss: 100431.7297; train_edge_recon_loss: 2739052.8683; train_gene_expr_recon_loss: 35239244.3511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3664438.2500; train_global_loss: 41743167.3588; train_optim_loss: 41743167.3588; val_kl_reg_loss: 71770.9187; val_edge_recon_loss: 2743638.5667; val_gene_expr_recon_loss: 35614904.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3734065.1500; val_global_loss: 42164379.7333; val_optim_loss: 42164379.7333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9743; val_auprc_score: 0.9692; val_best_acc_score: 0.9219; val_best_f1_score: 0.9248; train_kl_reg_loss: 100593.7681; train_edge_recon_loss: 2729774.3798; train_gene_expr_recon_loss: 35166003.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3661205.8359; train_global_loss: 41657577.1603; train_optim_loss: 41657577.1603; val_kl_reg_loss: 72401.4000; val_edge_recon_loss: 2766363.6500; val_gene_expr_recon_loss: 35517551.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3725832.5000; val_global_loss: 42082148.5333; val_optim_loss: 42082148.5333
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9756; val_auprc_score: 0.9706; val_best_acc_score: 0.9256; val_best_f1_score: 0.9264; train_kl_reg_loss: 100302.9995; train_edge_recon_loss: 2735787.0019; train_gene_expr_recon_loss: 35173192.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3662716.2538; train_global_loss: 41671998.5038; train_optim_loss: 41671998.5038; val_kl_reg_loss: 73274.4656; val_edge_recon_loss: 2721246.6833; val_gene_expr_recon_loss: 35554787.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3737782.7500; val_global_loss: 42087090.6667; val_optim_loss: 42087090.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 45 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9711
val AUPRC score: 0.9642
val best accuracy score: 0.9169
val best F1 score: 0.9199
val target rna MSE score: 1.1569
val source rna MSE score: 82.9397
val target atac MSE score: 0.5969
val source atac MSE score: 6.3695
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
