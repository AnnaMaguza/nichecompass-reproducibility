[True]
Run timestamp: 27072023_031030_139.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_139']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8732; val_auprc_score: 0.9749; val_best_acc_score: 0.8521; val_best_f1_score: 0.9201; train_kl_reg_loss: 314474.9350; train_edge_recon_loss: 10738402.8674; train_gene_expr_recon_loss: 18570466.4930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29623344.3070; train_optim_loss: 29623344.3070; val_kl_reg_loss: 283493.3672; val_edge_recon_loss: 12019032.7500; val_gene_expr_recon_loss: 10910723.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23213249.8333; val_optim_loss: 23213249.8333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8584; val_auprc_score: 0.9717; val_best_acc_score: 0.8609; val_best_f1_score: 0.9241; train_kl_reg_loss: 297784.9068; train_edge_recon_loss: 10549147.5488; train_gene_expr_recon_loss: 10483325.3349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21330257.7395; train_optim_loss: 21330257.7395; val_kl_reg_loss: 210186.1120; val_edge_recon_loss: 11985962.2917; val_gene_expr_recon_loss: 10179684.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22375832.3333; val_optim_loss: 22375832.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8541; val_auprc_score: 0.9687; val_best_acc_score: 0.8719; val_best_f1_score: 0.9286; train_kl_reg_loss: 230371.4129; train_edge_recon_loss: 10629969.9558; train_gene_expr_recon_loss: 10102393.8884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20962735.2558; train_optim_loss: 20962735.2558; val_kl_reg_loss: 162526.7018; val_edge_recon_loss: 11711346.0000; val_gene_expr_recon_loss: 9915231.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21789103.5833; val_optim_loss: 21789103.5833
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8624; val_auprc_score: 0.9698; val_best_acc_score: 0.8925; val_best_f1_score: 0.9398; train_kl_reg_loss: 188323.0904; train_edge_recon_loss: 10476584.6302; train_gene_expr_recon_loss: 9647814.7209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20312722.4279; train_optim_loss: 20312722.4279; val_kl_reg_loss: 146991.4766; val_edge_recon_loss: 11242644.9167; val_gene_expr_recon_loss: 9453913.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20843550.2500; val_optim_loss: 20843550.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8496; val_auprc_score: 0.9640; val_best_acc_score: 0.8924; val_best_f1_score: 0.9401; train_kl_reg_loss: 125683.2747; train_edge_recon_loss: 9967325.4279; train_gene_expr_recon_loss: 9368075.0558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19461083.7767; train_optim_loss: 19461083.7767; val_kl_reg_loss: 116986.1341; val_edge_recon_loss: 9192258.1042; val_gene_expr_recon_loss: 9270446.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18579690.1667; val_optim_loss: 18579690.1667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8513; val_auprc_score: 0.9663; val_best_acc_score: 0.8929; val_best_f1_score: 0.9396; train_kl_reg_loss: 170909.0086; train_edge_recon_loss: 8931242.1349; train_gene_expr_recon_loss: 9129238.4651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18231389.6093; train_optim_loss: 18231389.6093; val_kl_reg_loss: 198020.8366; val_edge_recon_loss: 8888062.9167; val_gene_expr_recon_loss: 8964168.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18050252.5833; val_optim_loss: 18050252.5833
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8622; val_auprc_score: 0.9678; val_best_acc_score: 0.8992; val_best_f1_score: 0.9439; train_kl_reg_loss: 199099.1773; train_edge_recon_loss: 8581646.2070; train_gene_expr_recon_loss: 8855764.6651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17636510.1535; train_optim_loss: 17636510.1535; val_kl_reg_loss: 185013.1094; val_edge_recon_loss: 8623549.7708; val_gene_expr_recon_loss: 8713254.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17521817.2500; val_optim_loss: 17521817.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8695; val_auprc_score: 0.9710; val_best_acc_score: 0.9052; val_best_f1_score: 0.9468; train_kl_reg_loss: 179991.4278; train_edge_recon_loss: 8531990.2698; train_gene_expr_recon_loss: 8633019.7535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17345001.4279; train_optim_loss: 17345001.4279; val_kl_reg_loss: 165782.7806; val_edge_recon_loss: 8490106.7500; val_gene_expr_recon_loss: 8525732.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17181622.0417; val_optim_loss: 17181622.0417
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8804; val_auprc_score: 0.9726; val_best_acc_score: 0.9004; val_best_f1_score: 0.9440; train_kl_reg_loss: 164402.9157; train_edge_recon_loss: 8390581.1930; train_gene_expr_recon_loss: 8462777.8140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17017762.0000; train_optim_loss: 17017762.0000; val_kl_reg_loss: 158401.0384; val_edge_recon_loss: 8604625.3750; val_gene_expr_recon_loss: 8369369.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17132395.5000; val_optim_loss: 17132395.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8929; val_auprc_score: 0.9761; val_best_acc_score: 0.9059; val_best_f1_score: 0.9469; train_kl_reg_loss: 161167.7323; train_edge_recon_loss: 8251527.1791; train_gene_expr_recon_loss: 8306705.7256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16719400.6744; train_optim_loss: 16719400.6744; val_kl_reg_loss: 154991.4727; val_edge_recon_loss: 8390271.9583; val_gene_expr_recon_loss: 8223164.3958; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16768427.8750; val_optim_loss: 16768427.8750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9030; val_auprc_score: 0.9779; val_best_acc_score: 0.9243; val_best_f1_score: 0.9567; train_kl_reg_loss: 149529.3076; train_edge_recon_loss: 8142066.5884; train_gene_expr_recon_loss: 8170836.2093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16462432.1814; train_optim_loss: 16462432.1814; val_kl_reg_loss: 139004.8092; val_edge_recon_loss: 8193574.0625; val_gene_expr_recon_loss: 8096675.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16429254.0417; val_optim_loss: 16429254.0417
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9081; val_auprc_score: 0.9791; val_best_acc_score: 0.9263; val_best_f1_score: 0.9579; train_kl_reg_loss: 140719.6640; train_edge_recon_loss: 8001787.4256; train_gene_expr_recon_loss: 8044235.5884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16186742.7256; train_optim_loss: 16186742.7256; val_kl_reg_loss: 133507.9082; val_edge_recon_loss: 8133832.8333; val_gene_expr_recon_loss: 7977113.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16244453.7917; val_optim_loss: 16244453.7917
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9100; val_auprc_score: 0.9803; val_best_acc_score: 0.9247; val_best_f1_score: 0.9570; train_kl_reg_loss: 128783.7349; train_edge_recon_loss: 7997383.3442; train_gene_expr_recon_loss: 7938148.9186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16064315.9628; train_optim_loss: 16064315.9628; val_kl_reg_loss: 122517.5719; val_edge_recon_loss: 8051149.2708; val_gene_expr_recon_loss: 7870004.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16043671.2917; val_optim_loss: 16043671.2917
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9179; val_auprc_score: 0.9823; val_best_acc_score: 0.9248; val_best_f1_score: 0.9571; train_kl_reg_loss: 117025.4778; train_edge_recon_loss: 7929580.4256; train_gene_expr_recon_loss: 7838114.7209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15884720.5953; train_optim_loss: 15884720.5953; val_kl_reg_loss: 108194.7985; val_edge_recon_loss: 8132217.5625; val_gene_expr_recon_loss: 7785015.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16025427.9583; val_optim_loss: 16025427.9583
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9219; val_auprc_score: 0.9829; val_best_acc_score: 0.9229; val_best_f1_score: 0.9559; train_kl_reg_loss: 103433.5365; train_edge_recon_loss: 7982121.3791; train_gene_expr_recon_loss: 7750146.6163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15835701.5256; train_optim_loss: 15835701.5256; val_kl_reg_loss: 93258.8125; val_edge_recon_loss: 8151247.0625; val_gene_expr_recon_loss: 7694961.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15939467.2917; val_optim_loss: 15939467.2917
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9315; val_auprc_score: 0.9844; val_best_acc_score: 0.9216; val_best_f1_score: 0.9551; train_kl_reg_loss: 89438.5695; train_edge_recon_loss: 7969039.9442; train_gene_expr_recon_loss: 7667979.8744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15726458.3814; train_optim_loss: 15726458.3814; val_kl_reg_loss: 83243.4873; val_edge_recon_loss: 8285099.3958; val_gene_expr_recon_loss: 7614619.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15982961.9167; val_optim_loss: 15982961.9167
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9332; val_auprc_score: 0.9858; val_best_acc_score: 0.9280; val_best_f1_score: 0.9585; train_kl_reg_loss: 77800.8934; train_edge_recon_loss: 7983829.8023; train_gene_expr_recon_loss: 7594406.0512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15656036.7721; train_optim_loss: 15656036.7721; val_kl_reg_loss: 66507.7531; val_edge_recon_loss: 8033987.3333; val_gene_expr_recon_loss: 7577328.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15677823.4167; val_optim_loss: 15677823.4167
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9389; val_auprc_score: 0.9870; val_best_acc_score: 0.9267; val_best_f1_score: 0.9578; train_kl_reg_loss: 67457.4629; train_edge_recon_loss: 7862980.1674; train_gene_expr_recon_loss: 7528306.5209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15458744.1860; train_optim_loss: 15458744.1860; val_kl_reg_loss: 61239.8691; val_edge_recon_loss: 8027393.2708; val_gene_expr_recon_loss: 7486276.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15574909.2083; val_optim_loss: 15574909.2083
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9394; val_auprc_score: 0.9867; val_best_acc_score: 0.9257; val_best_f1_score: 0.9570; train_kl_reg_loss: 58754.2989; train_edge_recon_loss: 7798847.6512; train_gene_expr_recon_loss: 7472724.0349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15330325.9442; train_optim_loss: 15330325.9442; val_kl_reg_loss: 52993.2790; val_edge_recon_loss: 8161351.0000; val_gene_expr_recon_loss: 7442367.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15656712.2917; val_optim_loss: 15656712.2917
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9478; val_auprc_score: 0.9882; val_best_acc_score: 0.9356; val_best_f1_score: 0.9629; train_kl_reg_loss: 51518.4927; train_edge_recon_loss: 7887605.7814; train_gene_expr_recon_loss: 7415707.7488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15354832.0140; train_optim_loss: 15354832.0140; val_kl_reg_loss: 47827.2853; val_edge_recon_loss: 7896026.6042; val_gene_expr_recon_loss: 7379740.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15323594.4167; val_optim_loss: 15323594.4167
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9501; val_auprc_score: 0.9886; val_best_acc_score: 0.9388; val_best_f1_score: 0.9647; train_kl_reg_loss: 47144.6398; train_edge_recon_loss: 7687704.7698; train_gene_expr_recon_loss: 7369597.5512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15104447.0093; train_optim_loss: 15104447.0093; val_kl_reg_loss: 44314.4688; val_edge_recon_loss: 7785590.9375; val_gene_expr_recon_loss: 7330361.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15160266.5833; val_optim_loss: 15160266.5833
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9450; val_auprc_score: 0.9875; val_best_acc_score: 0.9368; val_best_f1_score: 0.9635; train_kl_reg_loss: 45424.9158; train_edge_recon_loss: 7677039.8767; train_gene_expr_recon_loss: 7321632.2442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15044097.0791; train_optim_loss: 15044097.0791; val_kl_reg_loss: 43382.5452; val_edge_recon_loss: 7801690.1042; val_gene_expr_recon_loss: 7286500.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15131573.6667; val_optim_loss: 15131573.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9565; val_auprc_score: 0.9901; val_best_acc_score: 0.9419; val_best_f1_score: 0.9665; train_kl_reg_loss: 43844.0817; train_edge_recon_loss: 7735298.1349; train_gene_expr_recon_loss: 7283843.1605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15062985.3953; train_optim_loss: 15062985.3953; val_kl_reg_loss: 40965.8394; val_edge_recon_loss: 7820554.5625; val_gene_expr_recon_loss: 7251070.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15112591.1250; val_optim_loss: 15112591.1250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9565; val_auprc_score: 0.9897; val_best_acc_score: 0.9470; val_best_f1_score: 0.9692; train_kl_reg_loss: 42376.3582; train_edge_recon_loss: 7703523.9860; train_gene_expr_recon_loss: 7243646.8535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14989547.2047; train_optim_loss: 14989547.2047; val_kl_reg_loss: 39943.6440; val_edge_recon_loss: 7838313.0417; val_gene_expr_recon_loss: 7228029.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15106286.4583; val_optim_loss: 15106286.4583
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9520; val_auprc_score: 0.9875; val_best_acc_score: 0.9398; val_best_f1_score: 0.9648; train_kl_reg_loss: 39881.8667; train_edge_recon_loss: 7681557.9674; train_gene_expr_recon_loss: 7209042.4791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14930482.2698; train_optim_loss: 14930482.2698; val_kl_reg_loss: 40589.7830; val_edge_recon_loss: 8008862.6250; val_gene_expr_recon_loss: 7185336.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15234789.3333; val_optim_loss: 15234789.3333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9640; val_auprc_score: 0.9914; val_best_acc_score: 0.9497; val_best_f1_score: 0.9707; train_kl_reg_loss: 40090.5612; train_edge_recon_loss: 7780688.3279; train_gene_expr_recon_loss: 7246894.1442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15067673.0419; train_optim_loss: 15067673.0419; val_kl_reg_loss: 12688.5313; val_edge_recon_loss: 7890672.8958; val_gene_expr_recon_loss: 7230453.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15133815.3750; val_optim_loss: 15133815.3750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9594; val_auprc_score: 0.9902; val_best_acc_score: 0.9499; val_best_f1_score: 0.9709; train_kl_reg_loss: 36806.6483; train_edge_recon_loss: 7734292.7302; train_gene_expr_recon_loss: 7206443.5488; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14977542.9023; train_optim_loss: 14977542.9023; val_kl_reg_loss: 12171.5457; val_edge_recon_loss: 7828149.3333; val_gene_expr_recon_loss: 7189272.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15029593.2917; val_optim_loss: 15029593.2917
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9627; val_auprc_score: 0.9918; val_best_acc_score: 0.9519; val_best_f1_score: 0.9721; train_kl_reg_loss: 33139.5478; train_edge_recon_loss: 7689324.8116; train_gene_expr_recon_loss: 7179334.6442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14901798.9860; train_optim_loss: 14901798.9860; val_kl_reg_loss: 11660.6109; val_edge_recon_loss: 7792107.7917; val_gene_expr_recon_loss: 7164824.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14968593.3750; val_optim_loss: 14968593.3750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9654; val_auprc_score: 0.9917; val_best_acc_score: 0.9537; val_best_f1_score: 0.9730; train_kl_reg_loss: 30995.0138; train_edge_recon_loss: 7662569.3628; train_gene_expr_recon_loss: 7153254.3535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14846818.7628; train_optim_loss: 14846818.7628; val_kl_reg_loss: 11637.4835; val_edge_recon_loss: 7896309.6667; val_gene_expr_recon_loss: 7143875.7708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15051822.8750; val_optim_loss: 15051822.8750
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9595; val_auprc_score: 0.9896; val_best_acc_score: 0.9514; val_best_f1_score: 0.9717; train_kl_reg_loss: 29569.6090; train_edge_recon_loss: 7637555.8930; train_gene_expr_recon_loss: 7132314.2558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14799439.7581; train_optim_loss: 14799439.7581; val_kl_reg_loss: 11383.8547; val_edge_recon_loss: 8025354.2083; val_gene_expr_recon_loss: 7116596.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15153334.2917; val_optim_loss: 15153334.2917
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9629; val_auprc_score: 0.9910; val_best_acc_score: 0.9553; val_best_f1_score: 0.9742; train_kl_reg_loss: 27756.7980; train_edge_recon_loss: 7733212.2767; train_gene_expr_recon_loss: 7112430.4744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14873399.5442; train_optim_loss: 14873399.5442; val_kl_reg_loss: 10878.2697; val_edge_recon_loss: 7650523.8750; val_gene_expr_recon_loss: 7126537.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14787939.7917; val_optim_loss: 14787939.7917
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9630; val_auprc_score: 0.9912; val_best_acc_score: 0.9542; val_best_f1_score: 0.9733; train_kl_reg_loss: 26573.1886; train_edge_recon_loss: 7601100.6419; train_gene_expr_recon_loss: 7097843.3442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14725517.1767; train_optim_loss: 14725517.1767; val_kl_reg_loss: 11237.7257; val_edge_recon_loss: 7970925.8542; val_gene_expr_recon_loss: 7079659.1042; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15061822.6667; val_optim_loss: 15061822.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9601; val_auprc_score: 0.9901; val_best_acc_score: 0.9540; val_best_f1_score: 0.9734; train_kl_reg_loss: 25194.3266; train_edge_recon_loss: 7631126.4326; train_gene_expr_recon_loss: 7084651.1372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14740971.9163; train_optim_loss: 14740971.9163; val_kl_reg_loss: 11175.1163; val_edge_recon_loss: 7685192.9375; val_gene_expr_recon_loss: 7074074.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14770442.2083; val_optim_loss: 14770442.2083
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9671; val_auprc_score: 0.9926; val_best_acc_score: 0.9590; val_best_f1_score: 0.9763; train_kl_reg_loss: 24342.0871; train_edge_recon_loss: 7670334.2674; train_gene_expr_recon_loss: 7066680.7581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14761357.0791; train_optim_loss: 14761357.0791; val_kl_reg_loss: 10474.0033; val_edge_recon_loss: 7482716.5417; val_gene_expr_recon_loss: 7056043.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14549233.7083; val_optim_loss: 14549233.7083
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9621; val_auprc_score: 0.9908; val_best_acc_score: 0.9589; val_best_f1_score: 0.9761; train_kl_reg_loss: 23093.6971; train_edge_recon_loss: 7634232.8581; train_gene_expr_recon_loss: 7056241.2326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14713567.7628; train_optim_loss: 14713567.7628; val_kl_reg_loss: 10481.9177; val_edge_recon_loss: 7854854.0417; val_gene_expr_recon_loss: 7056767.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14922103.1250; val_optim_loss: 14922103.1250
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9641; val_auprc_score: 0.9914; val_best_acc_score: 0.9580; val_best_f1_score: 0.9756; train_kl_reg_loss: 22518.3238; train_edge_recon_loss: 7651359.9488; train_gene_expr_recon_loss: 7046134.5651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14720012.8047; train_optim_loss: 14720012.8047; val_kl_reg_loss: 10855.2889; val_edge_recon_loss: 7890179.5625; val_gene_expr_recon_loss: 7025579.2708; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14926614.0417; val_optim_loss: 14926614.0417
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9696; val_auprc_score: 0.9931; val_best_acc_score: 0.9601; val_best_f1_score: 0.9770; train_kl_reg_loss: 21542.8854; train_edge_recon_loss: 7674217.8047; train_gene_expr_recon_loss: 7032573.6093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14728334.2884; train_optim_loss: 14728334.2884; val_kl_reg_loss: 10858.5963; val_edge_recon_loss: 7582074.3750; val_gene_expr_recon_loss: 7031057.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14623990.7500; val_optim_loss: 14623990.7500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9715; val_auprc_score: 0.9936; val_best_acc_score: 0.9615; val_best_f1_score: 0.9776; train_kl_reg_loss: 20751.5094; train_edge_recon_loss: 7616594.9140; train_gene_expr_recon_loss: 7022024.3326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14659370.7302; train_optim_loss: 14659370.7302; val_kl_reg_loss: 11061.7430; val_edge_recon_loss: 7738805.9583; val_gene_expr_recon_loss: 7014761.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14764629.2500; val_optim_loss: 14764629.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9661; val_auprc_score: 0.9916; val_best_acc_score: 0.9588; val_best_f1_score: 0.9761; train_kl_reg_loss: 20423.4463; train_edge_recon_loss: 7676021.5047; train_gene_expr_recon_loss: 6992785.7279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14689230.7023; train_optim_loss: 14689230.7023; val_kl_reg_loss: 11229.8176; val_edge_recon_loss: 7911076.5625; val_gene_expr_recon_loss: 6992919.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14915225.3750; val_optim_loss: 14915225.3750
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9653; val_auprc_score: 0.9913; val_best_acc_score: 0.9609; val_best_f1_score: 0.9772; train_kl_reg_loss: 20557.8843; train_edge_recon_loss: 7657604.4721; train_gene_expr_recon_loss: 6988763.4419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14666925.7767; train_optim_loss: 14666925.7767; val_kl_reg_loss: 11280.4091; val_edge_recon_loss: 7830400.8333; val_gene_expr_recon_loss: 6979549.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14821231.1250; val_optim_loss: 14821231.1250
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9674; val_auprc_score: 0.9920; val_best_acc_score: 0.9613; val_best_f1_score: 0.9774; train_kl_reg_loss: 20697.7661; train_edge_recon_loss: 7684314.0721; train_gene_expr_recon_loss: 6986254.7558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14691266.6186; train_optim_loss: 14691266.6186; val_kl_reg_loss: 11389.9140; val_edge_recon_loss: 7811771.7083; val_gene_expr_recon_loss: 6991179.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14814341.2083; val_optim_loss: 14814341.2083
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9695; val_auprc_score: 0.9929; val_best_acc_score: 0.9605; val_best_f1_score: 0.9770; train_kl_reg_loss: 20764.8533; train_edge_recon_loss: 7500185.5116; train_gene_expr_recon_loss: 6987097.3953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14508047.7256; train_optim_loss: 14508047.7256; val_kl_reg_loss: 11419.5555; val_edge_recon_loss: 7618869.8333; val_gene_expr_recon_loss: 6995436.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14625725.7917; val_optim_loss: 14625725.7917

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 48 sec.
Using best model state, which was in epoch 34.

--- MODEL EVALUATION ---
Val AUROC score: 0.9642
Val AUPRC score: 0.9914
Val best accuracy score: 0.9566
Val best F1 score: 0.9748
Val gene expr MSE score: 101443.5088
Val cat covariate0 mean sim diff: -0.0027

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
