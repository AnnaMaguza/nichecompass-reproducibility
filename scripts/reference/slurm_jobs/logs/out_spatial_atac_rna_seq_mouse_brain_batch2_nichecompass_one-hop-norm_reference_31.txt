[True]
Run timestamp: 24072023_163018_31.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_31']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9564; val_auprc_score: 0.9599; val_best_acc_score: 0.5648; val_best_f1_score: 0.6966; train_kl_reg_loss: 3968.9760; train_edge_recon_loss: 3471168.2222; train_gene_expr_recon_loss: 324680.2049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10779963.2222; train_global_loss: 14579780.5556; train_optim_loss: 14579780.5556; val_kl_reg_loss: 9005.6123; val_edge_recon_loss: 4060920.0000; val_gene_expr_recon_loss: 314269.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10702028.0000; val_global_loss: 15086224.0000; val_optim_loss: 15086224.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9438; val_auprc_score: 0.9497; val_best_acc_score: 0.5296; val_best_f1_score: 0.6801; train_kl_reg_loss: 18525.1266; train_edge_recon_loss: 3487116.1389; train_gene_expr_recon_loss: 305622.4514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10601940.2222; train_global_loss: 14413203.7778; train_optim_loss: 14413203.7778; val_kl_reg_loss: 40681.6875; val_edge_recon_loss: 4063151.7500; val_gene_expr_recon_loss: 289535.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10506169.0000; val_global_loss: 14899538.0000; val_optim_loss: 14899538.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9295; val_auprc_score: 0.9308; val_best_acc_score: 0.5229; val_best_f1_score: 0.6770; train_kl_reg_loss: 40059.9080; train_edge_recon_loss: 3504098.1667; train_gene_expr_recon_loss: 282866.1458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10434493.7778; train_global_loss: 14261518.0000; train_optim_loss: 14261518.0000; val_kl_reg_loss: 39860.8750; val_edge_recon_loss: 4063493.2500; val_gene_expr_recon_loss: 269012.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10304328.0000; val_global_loss: 14676694.0000; val_optim_loss: 14676694.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9240; val_auprc_score: 0.9249; val_best_acc_score: 0.5426; val_best_f1_score: 0.6860; train_kl_reg_loss: 55686.9983; train_edge_recon_loss: 3510294.4444; train_gene_expr_recon_loss: 263050.6146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10239569.5556; train_global_loss: 14068601.8889; train_optim_loss: 14068601.8889; val_kl_reg_loss: 54497.6289; val_edge_recon_loss: 4062714.0000; val_gene_expr_recon_loss: 252131.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10136087.0000; val_global_loss: 14505430.0000; val_optim_loss: 14505430.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9196; val_auprc_score: 0.9183; val_best_acc_score: 0.5644; val_best_f1_score: 0.6962; train_kl_reg_loss: 70496.0720; train_edge_recon_loss: 3519351.3056; train_gene_expr_recon_loss: 246983.7569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10065426.0000; train_global_loss: 13902257.0000; train_optim_loss: 13902257.0000; val_kl_reg_loss: 67943.1719; val_edge_recon_loss: 4061626.7500; val_gene_expr_recon_loss: 240365.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10002136.0000; val_global_loss: 14372072.0000; val_optim_loss: 14372072.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9145; val_auprc_score: 0.9108; val_best_acc_score: 0.6373; val_best_f1_score: 0.7324; train_kl_reg_loss: 82066.9922; train_edge_recon_loss: 3522046.6944; train_gene_expr_recon_loss: 238580.3646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9956764.4444; train_global_loss: 13799458.4444; train_optim_loss: 13799458.4444; val_kl_reg_loss: 52820.4453; val_edge_recon_loss: 4058554.2500; val_gene_expr_recon_loss: 235454.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9941520.0000; val_global_loss: 14288349.0000; val_optim_loss: 14288349.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9145; val_auprc_score: 0.9120; val_best_acc_score: 0.7041; val_best_f1_score: 0.7689; train_kl_reg_loss: 82099.1576; train_edge_recon_loss: 3524466.2222; train_gene_expr_recon_loss: 232443.8698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9878250.5556; train_global_loss: 13717259.7778; train_optim_loss: 13717259.7778; val_kl_reg_loss: 53570.9688; val_edge_recon_loss: 4054315.0000; val_gene_expr_recon_loss: 231712.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9895463.0000; val_global_loss: 14235062.0000; val_optim_loss: 14235062.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9072; val_auprc_score: 0.9007; val_best_acc_score: 0.7668; val_best_f1_score: 0.8043; train_kl_reg_loss: 83158.5855; train_edge_recon_loss: 3521354.1667; train_gene_expr_recon_loss: 228984.8872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9842496.5556; train_global_loss: 13675994.0000; train_optim_loss: 13675994.0000; val_kl_reg_loss: 54278.8711; val_edge_recon_loss: 4046552.5000; val_gene_expr_recon_loss: 228305.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9844918.0000; val_global_loss: 14174054.0000; val_optim_loss: 14174054.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9031; val_auprc_score: 0.8933; val_best_acc_score: 0.8122; val_best_f1_score: 0.8294; train_kl_reg_loss: 81252.3902; train_edge_recon_loss: 3518827.5833; train_gene_expr_recon_loss: 225962.8906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9769249.6667; train_global_loss: 13595292.4444; train_optim_loss: 13595292.4444; val_kl_reg_loss: 66872.0312; val_edge_recon_loss: 4030832.2500; val_gene_expr_recon_loss: 224837.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9810107.0000; val_global_loss: 14132649.0000; val_optim_loss: 14132649.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8971; val_auprc_score: 0.8868; val_best_acc_score: 0.8033; val_best_f1_score: 0.7963; train_kl_reg_loss: 75212.8772; train_edge_recon_loss: 3512739.5000; train_gene_expr_recon_loss: 224914.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9826946.4444; train_global_loss: 13639813.4444; train_optim_loss: 13639813.4444; val_kl_reg_loss: 67036.8438; val_edge_recon_loss: 3983853.7500; val_gene_expr_recon_loss: 223680.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9787259.0000; val_global_loss: 14061830.0000; val_optim_loss: 14061830.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8939; val_auprc_score: 0.8788; val_best_acc_score: 0.8071; val_best_f1_score: 0.8249; train_kl_reg_loss: 70419.4462; train_edge_recon_loss: 3493374.9444; train_gene_expr_recon_loss: 222920.5694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9790910.4444; train_global_loss: 13577625.3333; train_optim_loss: 13577625.3333; val_kl_reg_loss: 52501.8984; val_edge_recon_loss: 3811081.7500; val_gene_expr_recon_loss: 223693.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9802406.0000; val_global_loss: 13889683.0000; val_optim_loss: 13889683.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8808; val_auprc_score: 0.8634; val_best_acc_score: 0.7974; val_best_f1_score: 0.8162; train_kl_reg_loss: 52307.7101; train_edge_recon_loss: 3403855.7500; train_gene_expr_recon_loss: 224975.6632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9823312.1111; train_global_loss: 13504451.3333; train_optim_loss: 13504451.3333; val_kl_reg_loss: 42695.9805; val_edge_recon_loss: 3297033.2500; val_gene_expr_recon_loss: 227385.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9822176.0000; val_global_loss: 13389291.0000; val_optim_loss: 13389291.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8635; val_auprc_score: 0.8453; val_best_acc_score: 0.7730; val_best_f1_score: 0.8012; train_kl_reg_loss: 63126.8863; train_edge_recon_loss: 3077235.3611; train_gene_expr_recon_loss: 229217.0365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9851046.4444; train_global_loss: 13220625.5556; train_optim_loss: 13220625.5556; val_kl_reg_loss: 96287.8281; val_edge_recon_loss: 2963054.5000; val_gene_expr_recon_loss: 229308.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9853693.0000; val_global_loss: 13142344.0000; val_optim_loss: 13142344.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8713; val_auprc_score: 0.8528; val_best_acc_score: 0.7792; val_best_f1_score: 0.8054; train_kl_reg_loss: 116930.0564; train_edge_recon_loss: 2940235.8056; train_gene_expr_recon_loss: 225610.6910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9836498.8889; train_global_loss: 13119275.3333; train_optim_loss: 13119275.3333; val_kl_reg_loss: 112631.8594; val_edge_recon_loss: 2934215.0000; val_gene_expr_recon_loss: 223623.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9783387.0000; val_global_loss: 13053858.0000; val_optim_loss: 13053858.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8786; val_auprc_score: 0.8524; val_best_acc_score: 0.7893; val_best_f1_score: 0.8079; train_kl_reg_loss: 104559.9375; train_edge_recon_loss: 2938487.3611; train_gene_expr_recon_loss: 221537.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9756817.4444; train_global_loss: 13021402.1111; train_optim_loss: 13021402.1111; val_kl_reg_loss: 96109.9688; val_edge_recon_loss: 2930031.7500; val_gene_expr_recon_loss: 222835.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9776394.0000; val_global_loss: 13025371.0000; val_optim_loss: 13025371.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8858; val_auprc_score: 0.8584; val_best_acc_score: 0.8056; val_best_f1_score: 0.8176; train_kl_reg_loss: 101573.3064; train_edge_recon_loss: 2912599.2222; train_gene_expr_recon_loss: 221964.6059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9718189.5556; train_global_loss: 12954326.7778; train_optim_loss: 12954326.7778; val_kl_reg_loss: 95197.1719; val_edge_recon_loss: 2881765.2500; val_gene_expr_recon_loss: 221862.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9752937.0000; val_global_loss: 12951762.0000; val_optim_loss: 12951762.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8990; val_auprc_score: 0.8733; val_best_acc_score: 0.8236; val_best_f1_score: 0.8325; train_kl_reg_loss: 97599.2361; train_edge_recon_loss: 2892420.7500; train_gene_expr_recon_loss: 221073.1788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9742200.0000; train_global_loss: 12953293.3333; train_optim_loss: 12953293.3333; val_kl_reg_loss: 92941.5312; val_edge_recon_loss: 2892378.5000; val_gene_expr_recon_loss: 221494.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9748545.0000; val_global_loss: 12955360.0000; val_optim_loss: 12955360.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9133; val_auprc_score: 0.8894; val_best_acc_score: 0.8411; val_best_f1_score: 0.8533; train_kl_reg_loss: 95970.7431; train_edge_recon_loss: 2862847.1944; train_gene_expr_recon_loss: 219432.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9691411.0000; train_global_loss: 12869661.4444; train_optim_loss: 12869661.4444; val_kl_reg_loss: 93427.2031; val_edge_recon_loss: 2862276.7500; val_gene_expr_recon_loss: 221492.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9741827.0000; val_global_loss: 12919024.0000; val_optim_loss: 12919024.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9244; val_auprc_score: 0.9027; val_best_acc_score: 0.8596; val_best_f1_score: 0.8695; train_kl_reg_loss: 99661.0981; train_edge_recon_loss: 2835743.3611; train_gene_expr_recon_loss: 219157.1736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9650737.7778; train_global_loss: 12805299.4444; train_optim_loss: 12805299.4444; val_kl_reg_loss: 97127.5859; val_edge_recon_loss: 2831972.7500; val_gene_expr_recon_loss: 220603.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9732971.0000; val_global_loss: 12882675.0000; val_optim_loss: 12882675.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9316; val_auprc_score: 0.9104; val_best_acc_score: 0.8701; val_best_f1_score: 0.8780; train_kl_reg_loss: 102898.4792; train_edge_recon_loss: 2806414.5833; train_gene_expr_recon_loss: 219513.3681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9644411.4444; train_global_loss: 12773237.7778; train_optim_loss: 12773237.7778; val_kl_reg_loss: 102881.0391; val_edge_recon_loss: 2799418.5000; val_gene_expr_recon_loss: 220090.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9721767.0000; val_global_loss: 12844157.0000; val_optim_loss: 12844157.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9450; val_auprc_score: 0.9273; val_best_acc_score: 0.8835; val_best_f1_score: 0.8898; train_kl_reg_loss: 105746.9271; train_edge_recon_loss: 2804675.8889; train_gene_expr_recon_loss: 217381.5451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9661009.3333; train_global_loss: 12788813.6667; train_optim_loss: 12788813.6667; val_kl_reg_loss: 98905.1562; val_edge_recon_loss: 2778786.7500; val_gene_expr_recon_loss: 219609.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9714485.0000; val_global_loss: 12811786.0000; val_optim_loss: 12811786.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9425; val_auprc_score: 0.9237; val_best_acc_score: 0.8813; val_best_f1_score: 0.8888; train_kl_reg_loss: 99090.3212; train_edge_recon_loss: 2786012.9722; train_gene_expr_recon_loss: 218019.4201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9667035.2222; train_global_loss: 12770158.1111; train_optim_loss: 12770158.1111; val_kl_reg_loss: 92346.9375; val_edge_recon_loss: 2797230.0000; val_gene_expr_recon_loss: 217723.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9683379.0000; val_global_loss: 12790680.0000; val_optim_loss: 12790680.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9456; val_auprc_score: 0.9242; val_best_acc_score: 0.8878; val_best_f1_score: 0.8951; train_kl_reg_loss: 97156.4635; train_edge_recon_loss: 2791418.3056; train_gene_expr_recon_loss: 216107.8628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9601704.2222; train_global_loss: 12706386.7778; train_optim_loss: 12706386.7778; val_kl_reg_loss: 92480.4453; val_edge_recon_loss: 2770077.0000; val_gene_expr_recon_loss: 218112.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9692947.0000; val_global_loss: 12773616.0000; val_optim_loss: 12773616.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9507; val_auprc_score: 0.9347; val_best_acc_score: 0.8946; val_best_f1_score: 0.9004; train_kl_reg_loss: 94457.8611; train_edge_recon_loss: 2784186.6944; train_gene_expr_recon_loss: 216280.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9652037.3333; train_global_loss: 12746962.0000; train_optim_loss: 12746962.0000; val_kl_reg_loss: 90876.7969; val_edge_recon_loss: 2803440.0000; val_gene_expr_recon_loss: 217644.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9673485.0000; val_global_loss: 12785446.0000; val_optim_loss: 12785446.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9558; val_auprc_score: 0.9403; val_best_acc_score: 0.9019; val_best_f1_score: 0.9062; train_kl_reg_loss: 91366.4479; train_edge_recon_loss: 2782224.7778; train_gene_expr_recon_loss: 217138.2378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9666121.7778; train_global_loss: 12756851.4444; train_optim_loss: 12756851.4444; val_kl_reg_loss: 86765.5469; val_edge_recon_loss: 2774859.0000; val_gene_expr_recon_loss: 217693.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9669633.0000; val_global_loss: 12748951.0000; val_optim_loss: 12748951.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9531; val_auprc_score: 0.9321; val_best_acc_score: 0.9042; val_best_f1_score: 0.9090; train_kl_reg_loss: 91098.6901; train_edge_recon_loss: 2766034.2222; train_gene_expr_recon_loss: 217211.8490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9622731.1111; train_global_loss: 12697075.7778; train_optim_loss: 12697075.7778; val_kl_reg_loss: 89052.0781; val_edge_recon_loss: 2752940.0000; val_gene_expr_recon_loss: 216712.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9672946.0000; val_global_loss: 12731650.0000; val_optim_loss: 12731650.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9583; val_auprc_score: 0.9395; val_best_acc_score: 0.9119; val_best_f1_score: 0.9156; train_kl_reg_loss: 91664.5530; train_edge_recon_loss: 2750922.9167; train_gene_expr_recon_loss: 215920.7135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9621689.7778; train_global_loss: 12680198.0000; train_optim_loss: 12680198.0000; val_kl_reg_loss: 90381.7891; val_edge_recon_loss: 2748467.5000; val_gene_expr_recon_loss: 216986.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9673570.0000; val_global_loss: 12729406.0000; val_optim_loss: 12729406.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9598; val_auprc_score: 0.9436; val_best_acc_score: 0.9104; val_best_f1_score: 0.9151; train_kl_reg_loss: 93189.2882; train_edge_recon_loss: 2747240.2222; train_gene_expr_recon_loss: 215134.7431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9610461.6667; train_global_loss: 12666025.7778; train_optim_loss: 12666025.7778; val_kl_reg_loss: 88618.3906; val_edge_recon_loss: 2731695.0000; val_gene_expr_recon_loss: 217145.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9652111.0000; val_global_loss: 12689570.0000; val_optim_loss: 12689570.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9597; val_auprc_score: 0.9450; val_best_acc_score: 0.9105; val_best_f1_score: 0.9155; train_kl_reg_loss: 92696.8559; train_edge_recon_loss: 2733949.1944; train_gene_expr_recon_loss: 215448.4479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9613917.8889; train_global_loss: 12656012.4444; train_optim_loss: 12656012.4444; val_kl_reg_loss: 90764.4297; val_edge_recon_loss: 2741382.0000; val_gene_expr_recon_loss: 215729.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9646126.0000; val_global_loss: 12694002.0000; val_optim_loss: 12694002.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9622; val_auprc_score: 0.9487; val_best_acc_score: 0.9170; val_best_f1_score: 0.9210; train_kl_reg_loss: 92525.5634; train_edge_recon_loss: 2724586.3611; train_gene_expr_recon_loss: 214630.0365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9577775.6667; train_global_loss: 12609517.5556; train_optim_loss: 12609517.5556; val_kl_reg_loss: 87689.0781; val_edge_recon_loss: 2738601.5000; val_gene_expr_recon_loss: 216601.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9643837.0000; val_global_loss: 12686730.0000; val_optim_loss: 12686730.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9640; val_auprc_score: 0.9509; val_best_acc_score: 0.9185; val_best_f1_score: 0.9219; train_kl_reg_loss: 90143.9106; train_edge_recon_loss: 2727644.0000; train_gene_expr_recon_loss: 213728.1632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9598773.4444; train_global_loss: 12630289.4444; train_optim_loss: 12630289.4444; val_kl_reg_loss: 90361.0781; val_edge_recon_loss: 2733065.7500; val_gene_expr_recon_loss: 214891.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9628228.0000; val_global_loss: 12666546.0000; val_optim_loss: 12666546.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9642; val_auprc_score: 0.9496; val_best_acc_score: 0.9175; val_best_f1_score: 0.9210; train_kl_reg_loss: 90112.9193; train_edge_recon_loss: 2732050.0556; train_gene_expr_recon_loss: 213060.2049; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9542140.5556; train_global_loss: 12577363.8889; train_optim_loss: 12577363.8889; val_kl_reg_loss: 86076.4062; val_edge_recon_loss: 2734711.7500; val_gene_expr_recon_loss: 215643.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9619069.0000; val_global_loss: 12655501.0000; val_optim_loss: 12655501.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9669; val_auprc_score: 0.9543; val_best_acc_score: 0.9227; val_best_f1_score: 0.9256; train_kl_reg_loss: 89845.8863; train_edge_recon_loss: 2720348.8611; train_gene_expr_recon_loss: 214413.7743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9579855.7778; train_global_loss: 12604464.3333; train_optim_loss: 12604464.3333; val_kl_reg_loss: 88820.6094; val_edge_recon_loss: 2724369.7500; val_gene_expr_recon_loss: 214796.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9602320.0000; val_global_loss: 12630307.0000; val_optim_loss: 12630307.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9688; val_auprc_score: 0.9587; val_best_acc_score: 0.9223; val_best_f1_score: 0.9252; train_kl_reg_loss: 88027.5538; train_edge_recon_loss: 2715751.6667; train_gene_expr_recon_loss: 212336.8976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9565440.7778; train_global_loss: 12581557.0000; train_optim_loss: 12581557.0000; val_kl_reg_loss: 87327.5781; val_edge_recon_loss: 2715479.5000; val_gene_expr_recon_loss: 214494.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9601770.0000; val_global_loss: 12619072.0000; val_optim_loss: 12619072.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9649; val_auprc_score: 0.9529; val_best_acc_score: 0.9190; val_best_f1_score: 0.9224; train_kl_reg_loss: 89705.4149; train_edge_recon_loss: 2711163.0000; train_gene_expr_recon_loss: 213467.4010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9510352.4444; train_global_loss: 12524688.2222; train_optim_loss: 12524688.2222; val_kl_reg_loss: 85620.0078; val_edge_recon_loss: 2733705.0000; val_gene_expr_recon_loss: 214494.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9599060.0000; val_global_loss: 12632880.0000; val_optim_loss: 12632880.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9675; val_auprc_score: 0.9549; val_best_acc_score: 0.9239; val_best_f1_score: 0.9270; train_kl_reg_loss: 86176.4766; train_edge_recon_loss: 2708219.9167; train_gene_expr_recon_loss: 213555.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9545332.5556; train_global_loss: 12553284.3333; train_optim_loss: 12553284.3333; val_kl_reg_loss: 86334.6719; val_edge_recon_loss: 2732226.5000; val_gene_expr_recon_loss: 213889.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9597138.0000; val_global_loss: 12629589.0000; val_optim_loss: 12629589.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9738; val_auprc_score: 0.9642; val_best_acc_score: 0.9322; val_best_f1_score: 0.9350; train_kl_reg_loss: 86805.9280; train_edge_recon_loss: 2714333.4167; train_gene_expr_recon_loss: 212091.7326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9553151.5556; train_global_loss: 12566382.6667; train_optim_loss: 12566382.6667; val_kl_reg_loss: 81534.7578; val_edge_recon_loss: 2697545.2500; val_gene_expr_recon_loss: 214572.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9598359.0000; val_global_loss: 12592012.0000; val_optim_loss: 12592012.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9736; val_auprc_score: 0.9639; val_best_acc_score: 0.9281; val_best_f1_score: 0.9306; train_kl_reg_loss: 84298.4418; train_edge_recon_loss: 2713792.9167; train_gene_expr_recon_loss: 212692.4653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9526759.0000; train_global_loss: 12537542.7778; train_optim_loss: 12537542.7778; val_kl_reg_loss: 82350.5000; val_edge_recon_loss: 2728758.5000; val_gene_expr_recon_loss: 213869.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9582944.0000; val_global_loss: 12607923.0000; val_optim_loss: 12607923.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9751; val_auprc_score: 0.9635; val_best_acc_score: 0.9352; val_best_f1_score: 0.9383; train_kl_reg_loss: 84026.1146; train_edge_recon_loss: 2705667.8056; train_gene_expr_recon_loss: 211820.9288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9485356.3333; train_global_loss: 12486871.2222; train_optim_loss: 12486871.2222; val_kl_reg_loss: 83654.8750; val_edge_recon_loss: 2693422.7500; val_gene_expr_recon_loss: 212985.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9555828.0000; val_global_loss: 12545890.0000; val_optim_loss: 12545890.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9766; val_auprc_score: 0.9683; val_best_acc_score: 0.9348; val_best_f1_score: 0.9369; train_kl_reg_loss: 84949.2049; train_edge_recon_loss: 2703736.4722; train_gene_expr_recon_loss: 212643.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9539254.0000; train_global_loss: 12540582.7778; train_optim_loss: 12540582.7778; val_kl_reg_loss: 79931.8125; val_edge_recon_loss: 2710341.7500; val_gene_expr_recon_loss: 214055.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9570321.0000; val_global_loss: 12574650.0000; val_optim_loss: 12574650.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9765; val_auprc_score: 0.9692; val_best_acc_score: 0.9332; val_best_f1_score: 0.9354; train_kl_reg_loss: 81936.2595; train_edge_recon_loss: 2694378.6389; train_gene_expr_recon_loss: 211911.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9502294.3333; train_global_loss: 12490520.6667; train_optim_loss: 12490520.6667; val_kl_reg_loss: 81145.5312; val_edge_recon_loss: 2707193.0000; val_gene_expr_recon_loss: 213712.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9568345.0000; val_global_loss: 12570396.0000; val_optim_loss: 12570396.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9776; val_auprc_score: 0.9705; val_best_acc_score: 0.9357; val_best_f1_score: 0.9377; train_kl_reg_loss: 83302.7977; train_edge_recon_loss: 2693226.2222; train_gene_expr_recon_loss: 211704.9392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9485472.7778; train_global_loss: 12473706.7778; train_optim_loss: 12473706.7778; val_kl_reg_loss: 82448.9844; val_edge_recon_loss: 2712615.7500; val_gene_expr_recon_loss: 212879.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9550468.0000; val_global_loss: 12558412.0000; val_optim_loss: 12558412.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9786; val_auprc_score: 0.9708; val_best_acc_score: 0.9375; val_best_f1_score: 0.9399; train_kl_reg_loss: 82676.9062; train_edge_recon_loss: 2693374.0556; train_gene_expr_recon_loss: 211944.0226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9519848.4444; train_global_loss: 12507843.3333; train_optim_loss: 12507843.3333; val_kl_reg_loss: 80343.7812; val_edge_recon_loss: 2703038.2500; val_gene_expr_recon_loss: 213149.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9553470.0000; val_global_loss: 12550002.0000; val_optim_loss: 12550002.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9764; val_auprc_score: 0.9666; val_best_acc_score: 0.9359; val_best_f1_score: 0.9379; train_kl_reg_loss: 81374.2135; train_edge_recon_loss: 2701217.5833; train_gene_expr_recon_loss: 211203.3385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9457596.8889; train_global_loss: 12451392.0000; train_optim_loss: 12451392.0000; val_kl_reg_loss: 81914.2969; val_edge_recon_loss: 2723855.7500; val_gene_expr_recon_loss: 211775.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9539640.0000; val_global_loss: 12557186.0000; val_optim_loss: 12557186.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9794; val_auprc_score: 0.9701; val_best_acc_score: 0.9414; val_best_f1_score: 0.9430; train_kl_reg_loss: 82487.2700; train_edge_recon_loss: 2691866.1111; train_gene_expr_recon_loss: 211352.2118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9477869.1111; train_global_loss: 12463574.7778; train_optim_loss: 12463574.7778; val_kl_reg_loss: 81259.9297; val_edge_recon_loss: 2715538.2500; val_gene_expr_recon_loss: 212557.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9549067.0000; val_global_loss: 12558422.0000; val_optim_loss: 12558422.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9764; val_auprc_score: 0.9647; val_best_acc_score: 0.9376; val_best_f1_score: 0.9395; train_kl_reg_loss: 82233.5720; train_edge_recon_loss: 2689779.4444; train_gene_expr_recon_loss: 210578.2292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9478469.3333; train_global_loss: 12461060.6667; train_optim_loss: 12461060.6667; val_kl_reg_loss: 81645.2031; val_edge_recon_loss: 2713993.7500; val_gene_expr_recon_loss: 212044.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9531190.0000; val_global_loss: 12538874.0000; val_optim_loss: 12538874.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9798; val_auprc_score: 0.9729; val_best_acc_score: 0.9406; val_best_f1_score: 0.9422; train_kl_reg_loss: 82503.7292; train_edge_recon_loss: 2693102.4167; train_gene_expr_recon_loss: 211183.6736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9555502.3333; train_global_loss: 12542292.2222; train_optim_loss: 12542292.2222; val_kl_reg_loss: 80962.3438; val_edge_recon_loss: 2696568.2500; val_gene_expr_recon_loss: 212339.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9535981.0000; val_global_loss: 12525851.0000; val_optim_loss: 12525851.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9780; val_auprc_score: 0.9682; val_best_acc_score: 0.9387; val_best_f1_score: 0.9406; train_kl_reg_loss: 81764.6493; train_edge_recon_loss: 2689346.1389; train_gene_expr_recon_loss: 210879.6059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9428580.0000; train_global_loss: 12410570.3333; train_optim_loss: 12410570.3333; val_kl_reg_loss: 81258.2734; val_edge_recon_loss: 2709618.7500; val_gene_expr_recon_loss: 212272.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9549044.0000; val_global_loss: 12552194.0000; val_optim_loss: 12552194.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9793; val_auprc_score: 0.9705; val_best_acc_score: 0.9409; val_best_f1_score: 0.9425; train_kl_reg_loss: 81617.3889; train_edge_recon_loss: 2679288.2778; train_gene_expr_recon_loss: 211761.1042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9510989.1111; train_global_loss: 12483656.1111; train_optim_loss: 12483656.1111; val_kl_reg_loss: 80931.1328; val_edge_recon_loss: 2706255.5000; val_gene_expr_recon_loss: 212372.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9536070.0000; val_global_loss: 12535630.0000; val_optim_loss: 12535630.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9772; val_auprc_score: 0.9684; val_best_acc_score: 0.9368; val_best_f1_score: 0.9388; train_kl_reg_loss: 81471.7153; train_edge_recon_loss: 2690171.3333; train_gene_expr_recon_loss: 211038.4045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9486834.5556; train_global_loss: 12469515.8889; train_optim_loss: 12469515.8889; val_kl_reg_loss: 81111.1094; val_edge_recon_loss: 2719394.7500; val_gene_expr_recon_loss: 212402.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9553376.0000; val_global_loss: 12566284.0000; val_optim_loss: 12566284.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9803; val_auprc_score: 0.9739; val_best_acc_score: 0.9454; val_best_f1_score: 0.9469; train_kl_reg_loss: 81325.4306; train_edge_recon_loss: 2688435.0556; train_gene_expr_recon_loss: 210581.5260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9486289.5556; train_global_loss: 12466631.5556; train_optim_loss: 12466631.5556; val_kl_reg_loss: 80787.1875; val_edge_recon_loss: 2695728.7500; val_gene_expr_recon_loss: 211982.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9531455.0000; val_global_loss: 12519953.0000; val_optim_loss: 12519953.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9803; val_auprc_score: 0.9721; val_best_acc_score: 0.9429; val_best_f1_score: 0.9448; train_kl_reg_loss: 81467.5564; train_edge_recon_loss: 2687368.6111; train_gene_expr_recon_loss: 210600.5486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9434213.5556; train_global_loss: 12413650.2222; train_optim_loss: 12413650.2222; val_kl_reg_loss: 80686.9844; val_edge_recon_loss: 2702500.7500; val_gene_expr_recon_loss: 212132.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9534226.0000; val_global_loss: 12529546.0000; val_optim_loss: 12529546.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9814; val_auprc_score: 0.9739; val_best_acc_score: 0.9431; val_best_f1_score: 0.9451; train_kl_reg_loss: 81573.6988; train_edge_recon_loss: 2686978.6667; train_gene_expr_recon_loss: 211171.2465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9532489.8889; train_global_loss: 12512213.4444; train_optim_loss: 12512213.4444; val_kl_reg_loss: 80147.8750; val_edge_recon_loss: 2699985.2500; val_gene_expr_recon_loss: 212146.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9534283.0000; val_global_loss: 12526562.0000; val_optim_loss: 12526562.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9797; val_auprc_score: 0.9721; val_best_acc_score: 0.9452; val_best_f1_score: 0.9464; train_kl_reg_loss: 80594.2005; train_edge_recon_loss: 2694083.5000; train_gene_expr_recon_loss: 209656.3576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9483185.7778; train_global_loss: 12467520.0000; train_optim_loss: 12467520.0000; val_kl_reg_loss: 80247.5938; val_edge_recon_loss: 2688777.7500; val_gene_expr_recon_loss: 212146.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9542917.0000; val_global_loss: 12524089.0000; val_optim_loss: 12524089.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9815; val_auprc_score: 0.9768; val_best_acc_score: 0.9399; val_best_f1_score: 0.9416; train_kl_reg_loss: 80922.2500; train_edge_recon_loss: 2682498.5000; train_gene_expr_recon_loss: 210938.3247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9453245.1111; train_global_loss: 12427604.4444; train_optim_loss: 12427604.4444; val_kl_reg_loss: 80409.2188; val_edge_recon_loss: 2719324.2500; val_gene_expr_recon_loss: 212382.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9553805.0000; val_global_loss: 12565921.0000; val_optim_loss: 12565921.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9811; val_auprc_score: 0.9748; val_best_acc_score: 0.9430; val_best_f1_score: 0.9450; train_kl_reg_loss: 81065.5078; train_edge_recon_loss: 2688287.7778; train_gene_expr_recon_loss: 210584.0972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9501918.3333; train_global_loss: 12481855.7778; train_optim_loss: 12481855.7778; val_kl_reg_loss: 80567.5781; val_edge_recon_loss: 2692644.2500; val_gene_expr_recon_loss: 212188.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9548859.0000; val_global_loss: 12534259.0000; val_optim_loss: 12534259.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9800; val_auprc_score: 0.9726; val_best_acc_score: 0.9392; val_best_f1_score: 0.9410; train_kl_reg_loss: 81079.9062; train_edge_recon_loss: 2686112.8333; train_gene_expr_recon_loss: 210068.9201; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9494474.5556; train_global_loss: 12471736.1111; train_optim_loss: 12471736.1111; val_kl_reg_loss: 80316.6250; val_edge_recon_loss: 2707247.2500; val_gene_expr_recon_loss: 212107.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9530630.0000; val_global_loss: 12530302.0000; val_optim_loss: 12530302.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9823; val_auprc_score: 0.9773; val_best_acc_score: 0.9422; val_best_f1_score: 0.9438; train_kl_reg_loss: 81198.5521; train_edge_recon_loss: 2687120.6389; train_gene_expr_recon_loss: 210979.8802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9443964.6667; train_global_loss: 12423263.7778; train_optim_loss: 12423263.7778; val_kl_reg_loss: 80820.5781; val_edge_recon_loss: 2680029.0000; val_gene_expr_recon_loss: 212196.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9542399.0000; val_global_loss: 12515445.0000; val_optim_loss: 12515445.0000
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9798; val_auprc_score: 0.9723; val_best_acc_score: 0.9402; val_best_f1_score: 0.9424; train_kl_reg_loss: 80964.3785; train_edge_recon_loss: 2685534.7222; train_gene_expr_recon_loss: 209841.0226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9436482.5556; train_global_loss: 12412822.5556; train_optim_loss: 12412822.5556; val_kl_reg_loss: 80459.5469; val_edge_recon_loss: 2702891.5000; val_gene_expr_recon_loss: 211959.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9524659.0000; val_global_loss: 12519969.0000; val_optim_loss: 12519969.0000
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9808; val_auprc_score: 0.9751; val_best_acc_score: 0.9431; val_best_f1_score: 0.9451; train_kl_reg_loss: 81347.7899; train_edge_recon_loss: 2687754.4444; train_gene_expr_recon_loss: 210558.2483; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9476594.5556; train_global_loss: 12456255.1111; train_optim_loss: 12456255.1111; val_kl_reg_loss: 80529.7188; val_edge_recon_loss: 2696882.2500; val_gene_expr_recon_loss: 211919.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9526698.0000; val_global_loss: 12516029.0000; val_optim_loss: 12516029.0000
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9812; val_auprc_score: 0.9749; val_best_acc_score: 0.9421; val_best_f1_score: 0.9440; train_kl_reg_loss: 81482.9653; train_edge_recon_loss: 2691543.9722; train_gene_expr_recon_loss: 210589.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9465103.3333; train_global_loss: 12448720.3333; train_optim_loss: 12448720.3333; val_kl_reg_loss: 80354.3828; val_edge_recon_loss: 2718301.7500; val_gene_expr_recon_loss: 212037.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9524432.0000; val_global_loss: 12535126.0000; val_optim_loss: 12535126.0000
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9813; val_auprc_score: 0.9737; val_best_acc_score: 0.9435; val_best_f1_score: 0.9455; train_kl_reg_loss: 81590.8533; train_edge_recon_loss: 2688731.9722; train_gene_expr_recon_loss: 210927.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9492077.1111; train_global_loss: 12473327.5556; train_optim_loss: 12473327.5556; val_kl_reg_loss: 80488.5000; val_edge_recon_loss: 2697971.5000; val_gene_expr_recon_loss: 212264.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9541539.0000; val_global_loss: 12532263.0000; val_optim_loss: 12532263.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9758; val_auprc_score: 0.9665; val_best_acc_score: 0.9372; val_best_f1_score: 0.9398; train_kl_reg_loss: 81471.7561; train_edge_recon_loss: 2690413.4722; train_gene_expr_recon_loss: 210870.0365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9487121.5556; train_global_loss: 12469876.8889; train_optim_loss: 12469876.8889; val_kl_reg_loss: 80514.1875; val_edge_recon_loss: 2709280.5000; val_gene_expr_recon_loss: 212188.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9531913.0000; val_global_loss: 12533896.0000; val_optim_loss: 12533896.0000
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9803; val_auprc_score: 0.9732; val_best_acc_score: 0.9415; val_best_f1_score: 0.9434; train_kl_reg_loss: 81278.5295; train_edge_recon_loss: 2692443.4722; train_gene_expr_recon_loss: 210838.3698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9499074.8889; train_global_loss: 12483635.2222; train_optim_loss: 12483635.2222; val_kl_reg_loss: 80488.6719; val_edge_recon_loss: 2702363.7500; val_gene_expr_recon_loss: 212126.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9533198.0000; val_global_loss: 12528177.0000; val_optim_loss: 12528177.0000
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9814; val_auprc_score: 0.9748; val_best_acc_score: 0.9410; val_best_f1_score: 0.9426; train_kl_reg_loss: 81274.1059; train_edge_recon_loss: 2687217.2778; train_gene_expr_recon_loss: 210766.5295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9453914.5556; train_global_loss: 12433172.4444; train_optim_loss: 12433172.4444; val_kl_reg_loss: 80268.6797; val_edge_recon_loss: 2691867.2500; val_gene_expr_recon_loss: 212232.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9530101.0000; val_global_loss: 12514470.0000; val_optim_loss: 12514470.0000
Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9801; val_auprc_score: 0.9731; val_best_acc_score: 0.9418; val_best_f1_score: 0.9434; train_kl_reg_loss: 81190.4835; train_edge_recon_loss: 2682476.3056; train_gene_expr_recon_loss: 210365.8924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9467211.3333; train_global_loss: 12441244.0000; train_optim_loss: 12441244.0000; val_kl_reg_loss: 80716.7422; val_edge_recon_loss: 2699790.0000; val_gene_expr_recon_loss: 212364.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9549609.0000; val_global_loss: 12542480.0000; val_optim_loss: 12542480.0000
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9795; val_auprc_score: 0.9723; val_best_acc_score: 0.9400; val_best_f1_score: 0.9423; train_kl_reg_loss: 81041.4236; train_edge_recon_loss: 2688317.9444; train_gene_expr_recon_loss: 210924.7587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9419955.1111; train_global_loss: 12400239.2222; train_optim_loss: 12400239.2222; val_kl_reg_loss: 80572.5781; val_edge_recon_loss: 2699895.7500; val_gene_expr_recon_loss: 212258.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9545235.0000; val_global_loss: 12537962.0000; val_optim_loss: 12537962.0000
Epoch 68/100 |█████████████-------| 68.0% val_auroc_score: 0.9790; val_auprc_score: 0.9709; val_best_acc_score: 0.9394; val_best_f1_score: 0.9411; train_kl_reg_loss: 81384.3359; train_edge_recon_loss: 2684762.6389; train_gene_expr_recon_loss: 210034.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9423401.3333; train_global_loss: 12399582.4444; train_optim_loss: 12399582.4444; val_kl_reg_loss: 80444.3438; val_edge_recon_loss: 2712621.7500; val_gene_expr_recon_loss: 212122.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9538504.0000; val_global_loss: 12543692.0000; val_optim_loss: 12543692.0000
Epoch 69/100 |█████████████-------| 69.0% val_auroc_score: 0.9790; val_auprc_score: 0.9718; val_best_acc_score: 0.9411; val_best_f1_score: 0.9428; train_kl_reg_loss: 81400.2292; train_edge_recon_loss: 2686245.5556; train_gene_expr_recon_loss: 211052.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9457050.2222; train_global_loss: 12435748.3333; train_optim_loss: 12435748.3333; val_kl_reg_loss: 80589.2344; val_edge_recon_loss: 2701786.7500; val_gene_expr_recon_loss: 212194.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9536905.0000; val_global_loss: 12531476.0000; val_optim_loss: 12531476.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 70/100 |██████████████------| 70.0% val_auroc_score: 0.9801; val_auprc_score: 0.9730; val_best_acc_score: 0.9429; val_best_f1_score: 0.9449; train_kl_reg_loss: 81200.9601; train_edge_recon_loss: 2688409.0000; train_gene_expr_recon_loss: 211548.6233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9444360.3333; train_global_loss: 12425518.8889; train_optim_loss: 12425518.8889; val_kl_reg_loss: 80666.8906; val_edge_recon_loss: 2686115.7500; val_gene_expr_recon_loss: 212245.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9536563.0000; val_global_loss: 12515591.0000; val_optim_loss: 12515591.0000
Epoch 71/100 |██████████████------| 71.0% val_auroc_score: 0.9786; val_auprc_score: 0.9705; val_best_acc_score: 0.9404; val_best_f1_score: 0.9421; train_kl_reg_loss: 81351.2587; train_edge_recon_loss: 2691947.5833; train_gene_expr_recon_loss: 211858.8229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9521613.3333; train_global_loss: 12506771.2222; train_optim_loss: 12506771.2222; val_kl_reg_loss: 80900.3984; val_edge_recon_loss: 2700671.0000; val_gene_expr_recon_loss: 212257.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9540059.0000; val_global_loss: 12533888.0000; val_optim_loss: 12533888.0000
Epoch 72/100 |██████████████------| 72.0% val_auroc_score: 0.9789; val_auprc_score: 0.9716; val_best_acc_score: 0.9383; val_best_f1_score: 0.9401; train_kl_reg_loss: 81129.1519; train_edge_recon_loss: 2689803.3611; train_gene_expr_recon_loss: 211433.6163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9460606.5556; train_global_loss: 12442972.7778; train_optim_loss: 12442972.7778; val_kl_reg_loss: 80746.4375; val_edge_recon_loss: 2721751.7500; val_gene_expr_recon_loss: 212122.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9533638.0000; val_global_loss: 12548259.0000; val_optim_loss: 12548259.0000
Epoch 73/100 |██████████████------| 73.0% val_auroc_score: 0.9810; val_auprc_score: 0.9758; val_best_acc_score: 0.9435; val_best_f1_score: 0.9451; train_kl_reg_loss: 81460.2708; train_edge_recon_loss: 2692813.5556; train_gene_expr_recon_loss: 211289.6007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9505633.7778; train_global_loss: 12491197.3333; train_optim_loss: 12491197.3333; val_kl_reg_loss: 80535.0312; val_edge_recon_loss: 2694652.0000; val_gene_expr_recon_loss: 212111.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9534296.0000; val_global_loss: 12521595.0000; val_optim_loss: 12521595.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 52 sec.
Using best model state, which was in epoch 65.

--- MODEL EVALUATION ---
Val AUROC score: 0.9798
Val AUPRC score: 0.9714
Val best accuracy score: 0.9462
Val best F1 score: 0.9480
Val gene expr MSE score: 0.4293
Val chrom access MSE score: 0.0867
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
