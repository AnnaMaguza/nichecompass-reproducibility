[True]
Run timestamp: 07082023_220952_154.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_154']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2573, n_latent: 2573, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9612; val_auprc_score: 0.9606; val_best_acc_score: 0.8359; val_best_f1_score: 0.8563; train_kl_reg_loss: 5077.2129; train_edge_recon_loss: 3468445.5833; train_gene_expr_recon_loss: 625316.8264; train_masked_gp_l1_reg_loss: 4632.8696; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 266902.9253; train_global_loss: 4370375.4444; train_optim_loss: 4370375.4444; val_kl_reg_loss: 3427.3738; val_edge_recon_loss: 4051377.0000; val_gene_expr_recon_loss: 615663.3750; val_masked_gp_l1_reg_loss: 4093.8391; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 267863.3125; val_global_loss: 4942425.0000; val_optim_loss: 4942425.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9504; val_auprc_score: 0.9447; val_best_acc_score: 0.8181; val_best_f1_score: 0.8440; train_kl_reg_loss: 1967.8045; train_edge_recon_loss: 3463883.4722; train_gene_expr_recon_loss: 610688.7986; train_masked_gp_l1_reg_loss: 3863.3574; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 264834.8038; train_global_loss: 4345238.2778; train_optim_loss: 4345238.2778; val_kl_reg_loss: 1431.0972; val_edge_recon_loss: 3935805.0000; val_gene_expr_recon_loss: 592502.4375; val_masked_gp_l1_reg_loss: 3670.2202; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 265959.0000; val_global_loss: 4799367.5000; val_optim_loss: 4799367.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8989; val_auprc_score: 0.8959; val_best_acc_score: 0.7984; val_best_f1_score: 0.8090; train_kl_reg_loss: 1889.1253; train_edge_recon_loss: 3354317.3611; train_gene_expr_recon_loss: 585347.8194; train_masked_gp_l1_reg_loss: 3649.1385; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 262349.2205; train_global_loss: 4207552.5278; train_optim_loss: 4207552.5278; val_kl_reg_loss: 4983.5762; val_edge_recon_loss: 3020808.7500; val_gene_expr_recon_loss: 576704.6875; val_masked_gp_l1_reg_loss: 3654.9963; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 264221.9688; val_global_loss: 3870374.0000; val_optim_loss: 3870374.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8900; val_auprc_score: 0.8790; val_best_acc_score: 0.8050; val_best_f1_score: 0.7986; train_kl_reg_loss: 17672.6344; train_edge_recon_loss: 2920728.7500; train_gene_expr_recon_loss: 575427.2778; train_masked_gp_l1_reg_loss: 3638.2269; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 261019.4097; train_global_loss: 3778486.2778; train_optim_loss: 3778486.2778; val_kl_reg_loss: 40402.8906; val_edge_recon_loss: 2857720.5000; val_gene_expr_recon_loss: 564159.3125; val_masked_gp_l1_reg_loss: 3579.0017; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 262273.3125; val_global_loss: 3728135.0000; val_optim_loss: 3728135.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9015; val_auprc_score: 0.8748; val_best_acc_score: 0.8257; val_best_f1_score: 0.8359; train_kl_reg_loss: 46889.9740; train_edge_recon_loss: 2814924.6111; train_gene_expr_recon_loss: 551827.6458; train_masked_gp_l1_reg_loss: 3537.8336; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 257285.1510; train_global_loss: 3674465.2222; train_optim_loss: 3674465.2222; val_kl_reg_loss: 43809.6016; val_edge_recon_loss: 2806775.0000; val_gene_expr_recon_loss: 548071.2500; val_masked_gp_l1_reg_loss: 3504.0134; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 260620.6562; val_global_loss: 3662780.5000; val_optim_loss: 3662780.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9305; val_auprc_score: 0.9120; val_best_acc_score: 0.8666; val_best_f1_score: 0.8733; train_kl_reg_loss: 33414.8500; train_edge_recon_loss: 2770004.3611; train_gene_expr_recon_loss: 549850.4583; train_masked_gp_l1_reg_loss: 3516.2730; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 258110.4601; train_global_loss: 3614896.4167; train_optim_loss: 3614896.4167; val_kl_reg_loss: 26499.9473; val_edge_recon_loss: 2733493.5000; val_gene_expr_recon_loss: 547492.5000; val_masked_gp_l1_reg_loss: 3530.3245; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 260156.8906; val_global_loss: 3571173.2500; val_optim_loss: 3571173.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9324; val_auprc_score: 0.9077; val_best_acc_score: 0.8739; val_best_f1_score: 0.8809; train_kl_reg_loss: 30467.2988; train_edge_recon_loss: 2728437.1389; train_gene_expr_recon_loss: 541796.0833; train_masked_gp_l1_reg_loss: 3528.6707; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256946.0260; train_global_loss: 3561175.2222; train_optim_loss: 3561175.2222; val_kl_reg_loss: 35355.7461; val_edge_recon_loss: 2733214.5000; val_gene_expr_recon_loss: 535654.7500; val_masked_gp_l1_reg_loss: 3524.1665; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 258551.9531; val_global_loss: 3566301.2500; val_optim_loss: 3566301.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9442; val_auprc_score: 0.9227; val_best_acc_score: 0.8871; val_best_f1_score: 0.8937; train_kl_reg_loss: 35531.8533; train_edge_recon_loss: 2726389.8889; train_gene_expr_recon_loss: 531399.3958; train_masked_gp_l1_reg_loss: 3523.9454; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 256068.2500; train_global_loss: 3552913.3056; train_optim_loss: 3552913.3056; val_kl_reg_loss: 32386.0273; val_edge_recon_loss: 2691935.5000; val_gene_expr_recon_loss: 527277.3750; val_masked_gp_l1_reg_loss: 3528.1074; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 257213.2500; val_global_loss: 3512340.2500; val_optim_loss: 3512340.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9476; val_auprc_score: 0.9302; val_best_acc_score: 0.8910; val_best_f1_score: 0.8969; train_kl_reg_loss: 30663.9134; train_edge_recon_loss: 2707893.1944; train_gene_expr_recon_loss: 523421.8160; train_masked_gp_l1_reg_loss: 3552.2574; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 254218.1580; train_global_loss: 3519749.3333; train_optim_loss: 3519749.3333; val_kl_reg_loss: 29836.7305; val_edge_recon_loss: 2701981.0000; val_gene_expr_recon_loss: 518086.3125; val_masked_gp_l1_reg_loss: 3577.9360; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 256357.8594; val_global_loss: 3509839.7500; val_optim_loss: 3509839.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9504; val_auprc_score: 0.9312; val_best_acc_score: 0.8979; val_best_f1_score: 0.9033; train_kl_reg_loss: 30300.6174; train_edge_recon_loss: 2686226.8333; train_gene_expr_recon_loss: 516354.1597; train_masked_gp_l1_reg_loss: 3604.7671; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252202.7448; train_global_loss: 3488689.2222; train_optim_loss: 3488689.2222; val_kl_reg_loss: 29768.1230; val_edge_recon_loss: 2704846.5000; val_gene_expr_recon_loss: 514121.8750; val_masked_gp_l1_reg_loss: 3637.1414; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 255763.7656; val_global_loss: 3508137.5000; val_optim_loss: 3508137.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9554; val_auprc_score: 0.9394; val_best_acc_score: 0.8996; val_best_f1_score: 0.9046; train_kl_reg_loss: 29539.2396; train_edge_recon_loss: 2670062.6944; train_gene_expr_recon_loss: 511932.3125; train_masked_gp_l1_reg_loss: 3677.1378; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252473.2066; train_global_loss: 3467684.6389; train_optim_loss: 3467684.6389; val_kl_reg_loss: 30109.2969; val_edge_recon_loss: 2690605.7500; val_gene_expr_recon_loss: 510649.2812; val_masked_gp_l1_reg_loss: 3718.8691; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 254876.2500; val_global_loss: 3489959.2500; val_optim_loss: 3489959.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9584; val_auprc_score: 0.9369; val_best_acc_score: 0.9072; val_best_f1_score: 0.9119; train_kl_reg_loss: 31529.8309; train_edge_recon_loss: 2676585.7222; train_gene_expr_recon_loss: 507194.8819; train_masked_gp_l1_reg_loss: 3747.2169; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 252492.4410; train_global_loss: 3471550.0278; train_optim_loss: 3471550.0278; val_kl_reg_loss: 32150.7852; val_edge_recon_loss: 2659162.5000; val_gene_expr_recon_loss: 503075.5000; val_masked_gp_l1_reg_loss: 3785.8345; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253798.8594; val_global_loss: 3451973.2500; val_optim_loss: 3451973.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9606; val_auprc_score: 0.9490; val_best_acc_score: 0.9074; val_best_f1_score: 0.9122; train_kl_reg_loss: 31790.8012; train_edge_recon_loss: 2663249.9444; train_gene_expr_recon_loss: 499894.9062; train_masked_gp_l1_reg_loss: 3821.7539; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250823.6476; train_global_loss: 3449581.0833; train_optim_loss: 3449581.0833; val_kl_reg_loss: 31305.8594; val_edge_recon_loss: 2673021.0000; val_gene_expr_recon_loss: 496364.8750; val_masked_gp_l1_reg_loss: 3859.6780; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 253014.2500; val_global_loss: 3457565.5000; val_optim_loss: 3457565.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9681; val_auprc_score: 0.9561; val_best_acc_score: 0.9162; val_best_f1_score: 0.9195; train_kl_reg_loss: 31400.3537; train_edge_recon_loss: 2667442.2500; train_gene_expr_recon_loss: 493260.3264; train_masked_gp_l1_reg_loss: 3892.8844; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 250297.3403; train_global_loss: 3446293.0833; train_optim_loss: 3446293.0833; val_kl_reg_loss: 30761.6523; val_edge_recon_loss: 2648285.0000; val_gene_expr_recon_loss: 490498.3125; val_masked_gp_l1_reg_loss: 3929.0869; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 252438.6406; val_global_loss: 3425912.7500; val_optim_loss: 3425912.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9608; val_auprc_score: 0.9461; val_best_acc_score: 0.9101; val_best_f1_score: 0.9133; train_kl_reg_loss: 30778.1970; train_edge_recon_loss: 2669006.0833; train_gene_expr_recon_loss: 491360.0347; train_masked_gp_l1_reg_loss: 3960.1545; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248703.2031; train_global_loss: 3443807.7778; train_optim_loss: 3443807.7778; val_kl_reg_loss: 30987.3633; val_edge_recon_loss: 2675192.2500; val_gene_expr_recon_loss: 491978.5625; val_masked_gp_l1_reg_loss: 3997.4832; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251890.3281; val_global_loss: 3454045.7500; val_optim_loss: 3454045.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9649; val_auprc_score: 0.9548; val_best_acc_score: 0.9154; val_best_f1_score: 0.9182; train_kl_reg_loss: 30964.4692; train_edge_recon_loss: 2657827.9722; train_gene_expr_recon_loss: 485068.9653; train_masked_gp_l1_reg_loss: 4032.4244; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248247.3455; train_global_loss: 3426141.2222; train_optim_loss: 3426141.2222; val_kl_reg_loss: 29494.2480; val_edge_recon_loss: 2652233.2500; val_gene_expr_recon_loss: 485527.6875; val_masked_gp_l1_reg_loss: 4073.2822; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251204.8281; val_global_loss: 3422533.2500; val_optim_loss: 3422533.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9673; val_auprc_score: 0.9568; val_best_acc_score: 0.9139; val_best_f1_score: 0.9174; train_kl_reg_loss: 30289.6345; train_edge_recon_loss: 2660828.8611; train_gene_expr_recon_loss: 483043.8125; train_masked_gp_l1_reg_loss: 4101.5546; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247385.4774; train_global_loss: 3425649.2222; train_optim_loss: 3425649.2222; val_kl_reg_loss: 29684.5449; val_edge_recon_loss: 2659157.7500; val_gene_expr_recon_loss: 488119.3750; val_masked_gp_l1_reg_loss: 4133.0391; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251012.8594; val_global_loss: 3432107.2500; val_optim_loss: 3432107.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9677; val_auprc_score: 0.9542; val_best_acc_score: 0.9165; val_best_f1_score: 0.9190; train_kl_reg_loss: 29813.8852; train_edge_recon_loss: 2650928.2500; train_gene_expr_recon_loss: 482396.6667; train_masked_gp_l1_reg_loss: 4162.3356; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247798.3559; train_global_loss: 3415099.5278; train_optim_loss: 3415099.5278; val_kl_reg_loss: 29479.0293; val_edge_recon_loss: 2664207.7500; val_gene_expr_recon_loss: 480101.0312; val_masked_gp_l1_reg_loss: 4194.7749; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250196.9688; val_global_loss: 3428179.5000; val_optim_loss: 3428179.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9695; val_auprc_score: 0.9569; val_best_acc_score: 0.9209; val_best_f1_score: 0.9239; train_kl_reg_loss: 29630.2806; train_edge_recon_loss: 2648923.2778; train_gene_expr_recon_loss: 476736.5556; train_masked_gp_l1_reg_loss: 4227.6956; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247604.9531; train_global_loss: 3407122.7778; train_optim_loss: 3407122.7778; val_kl_reg_loss: 28274.3594; val_edge_recon_loss: 2659977.7500; val_gene_expr_recon_loss: 475071.0625; val_masked_gp_l1_reg_loss: 4258.4902; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249409.7656; val_global_loss: 3416991.2500; val_optim_loss: 3416991.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9692; val_auprc_score: 0.9563; val_best_acc_score: 0.9205; val_best_f1_score: 0.9240; train_kl_reg_loss: 28885.3622; train_edge_recon_loss: 2653061.7500; train_gene_expr_recon_loss: 472011.4410; train_masked_gp_l1_reg_loss: 4279.8361; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246019.0469; train_global_loss: 3404257.5278; train_optim_loss: 3404257.5278; val_kl_reg_loss: 28005.2578; val_edge_recon_loss: 2661474.0000; val_gene_expr_recon_loss: 477297.8438; val_masked_gp_l1_reg_loss: 4301.2646; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249383.7344; val_global_loss: 3420462.0000; val_optim_loss: 3420462.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9730; val_auprc_score: 0.9629; val_best_acc_score: 0.9245; val_best_f1_score: 0.9270; train_kl_reg_loss: 27747.8194; train_edge_recon_loss: 2648365.6667; train_gene_expr_recon_loss: 475750.5035; train_masked_gp_l1_reg_loss: 4319.7439; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246872.7674; train_global_loss: 3403056.4722; train_optim_loss: 3403056.4722; val_kl_reg_loss: 27305.8320; val_edge_recon_loss: 2655759.7500; val_gene_expr_recon_loss: 475597.5000; val_masked_gp_l1_reg_loss: 4340.7583; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249249.5625; val_global_loss: 3412253.2500; val_optim_loss: 3412253.2500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9753; val_auprc_score: 0.9664; val_best_acc_score: 0.9316; val_best_f1_score: 0.9333; train_kl_reg_loss: 28206.4633; train_edge_recon_loss: 2640733.8333; train_gene_expr_recon_loss: 471616.7083; train_masked_gp_l1_reg_loss: 4365.7272; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247461.2726; train_global_loss: 3392383.9167; train_optim_loss: 3392383.9167; val_kl_reg_loss: 27994.7188; val_edge_recon_loss: 2646623.7500; val_gene_expr_recon_loss: 475586.3750; val_masked_gp_l1_reg_loss: 4386.6763; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248647.4844; val_global_loss: 3403239.2500; val_optim_loss: 3403239.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9724; val_auprc_score: 0.9621; val_best_acc_score: 0.9320; val_best_f1_score: 0.9342; train_kl_reg_loss: 28511.7687; train_edge_recon_loss: 2640905.8056; train_gene_expr_recon_loss: 469894.5451; train_masked_gp_l1_reg_loss: 4405.4217; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246439.3733; train_global_loss: 3390156.8889; train_optim_loss: 3390156.8889; val_kl_reg_loss: 28070.6387; val_edge_recon_loss: 2629609.7500; val_gene_expr_recon_loss: 473694.7500; val_masked_gp_l1_reg_loss: 4423.3716; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248419.6250; val_global_loss: 3384218.0000; val_optim_loss: 3384218.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9735; val_auprc_score: 0.9654; val_best_acc_score: 0.9299; val_best_f1_score: 0.9330; train_kl_reg_loss: 29175.8398; train_edge_recon_loss: 2637817.3056; train_gene_expr_recon_loss: 467978.7222; train_masked_gp_l1_reg_loss: 4443.0059; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245212.1128; train_global_loss: 3384626.9722; train_optim_loss: 3384626.9722; val_kl_reg_loss: 29985.0469; val_edge_recon_loss: 2643224.0000; val_gene_expr_recon_loss: 477728.2500; val_masked_gp_l1_reg_loss: 4455.8452; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 248709.0156; val_global_loss: 3404102.0000; val_optim_loss: 3404102.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9741; val_auprc_score: 0.9647; val_best_acc_score: 0.9321; val_best_f1_score: 0.9345; train_kl_reg_loss: 29632.0512; train_edge_recon_loss: 2631223.1667; train_gene_expr_recon_loss: 464930.1319; train_masked_gp_l1_reg_loss: 4476.9459; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 244550.2639; train_global_loss: 3374812.5278; train_optim_loss: 3374812.5278; val_kl_reg_loss: 28794.9453; val_edge_recon_loss: 2647973.5000; val_gene_expr_recon_loss: 471323.5625; val_masked_gp_l1_reg_loss: 4493.9819; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 247585.5156; val_global_loss: 3400171.5000; val_optim_loss: 3400171.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9737; val_auprc_score: 0.9620; val_best_acc_score: 0.9272; val_best_f1_score: 0.9294; train_kl_reg_loss: 28948.6565; train_edge_recon_loss: 2655145.2500; train_gene_expr_recon_loss: 492536.4097; train_masked_gp_l1_reg_loss: 4515.1386; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 248643.9115; train_global_loss: 3429789.4167; train_optim_loss: 3429789.4167; val_kl_reg_loss: 12218.8262; val_edge_recon_loss: 2645364.7500; val_gene_expr_recon_loss: 499312.3125; val_masked_gp_l1_reg_loss: 4514.2065; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 251333.5469; val_global_loss: 3412743.5000; val_optim_loss: 3412743.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9771; val_auprc_score: 0.9688; val_best_acc_score: 0.9307; val_best_f1_score: 0.9331; train_kl_reg_loss: 27715.8746; train_edge_recon_loss: 2636209.0556; train_gene_expr_recon_loss: 484568.1701; train_masked_gp_l1_reg_loss: 4504.2244; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247484.2812; train_global_loss: 3400481.6667; train_optim_loss: 3400481.6667; val_kl_reg_loss: 12584.4688; val_edge_recon_loss: 2631972.2500; val_gene_expr_recon_loss: 495026.2500; val_masked_gp_l1_reg_loss: 4488.9214; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250572.4062; val_global_loss: 3394644.5000; val_optim_loss: 3394644.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9762; val_auprc_score: 0.9659; val_best_acc_score: 0.9312; val_best_f1_score: 0.9332; train_kl_reg_loss: 25851.5881; train_edge_recon_loss: 2624190.0833; train_gene_expr_recon_loss: 486543.5833; train_masked_gp_l1_reg_loss: 4474.5810; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247714.9427; train_global_loss: 3388774.8333; train_optim_loss: 3388774.8333; val_kl_reg_loss: 12385.1162; val_edge_recon_loss: 2639020.7500; val_gene_expr_recon_loss: 492739.2812; val_masked_gp_l1_reg_loss: 4457.0371; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250378.6875; val_global_loss: 3398980.7500; val_optim_loss: 3398980.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9741; val_auprc_score: 0.9615; val_best_acc_score: 0.9295; val_best_f1_score: 0.9314; train_kl_reg_loss: 25648.4529; train_edge_recon_loss: 2628076.4722; train_gene_expr_recon_loss: 482853.7431; train_masked_gp_l1_reg_loss: 4448.6107; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246633.1476; train_global_loss: 3387660.4444; train_optim_loss: 3387660.4444; val_kl_reg_loss: 12521.6963; val_edge_recon_loss: 2649899.7500; val_gene_expr_recon_loss: 488699.2812; val_masked_gp_l1_reg_loss: 4437.7607; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250030.8125; val_global_loss: 3405589.2500; val_optim_loss: 3405589.2500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9777; val_auprc_score: 0.9714; val_best_acc_score: 0.9325; val_best_f1_score: 0.9341; train_kl_reg_loss: 25386.7893; train_edge_recon_loss: 2627398.0833; train_gene_expr_recon_loss: 482285.9097; train_masked_gp_l1_reg_loss: 4431.3395; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246816.9097; train_global_loss: 3386318.9722; train_optim_loss: 3386318.9722; val_kl_reg_loss: 12407.6133; val_edge_recon_loss: 2621365.5000; val_gene_expr_recon_loss: 490865.0000; val_masked_gp_l1_reg_loss: 4424.7671; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250212.2344; val_global_loss: 3379275.0000; val_optim_loss: 3379275.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9734; val_auprc_score: 0.9607; val_best_acc_score: 0.9286; val_best_f1_score: 0.9312; train_kl_reg_loss: 25031.9086; train_edge_recon_loss: 2631963.8056; train_gene_expr_recon_loss: 482005.8507; train_masked_gp_l1_reg_loss: 4420.6639; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245987.2326; train_global_loss: 3389409.4167; train_optim_loss: 3389409.4167; val_kl_reg_loss: 12410.8340; val_edge_recon_loss: 2637393.0000; val_gene_expr_recon_loss: 490474.1250; val_masked_gp_l1_reg_loss: 4415.9854; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250190.0938; val_global_loss: 3394884.0000; val_optim_loss: 3394884.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9769; val_auprc_score: 0.9686; val_best_acc_score: 0.9320; val_best_f1_score: 0.9346; train_kl_reg_loss: 24873.2287; train_edge_recon_loss: 2630926.0833; train_gene_expr_recon_loss: 483411.2708; train_masked_gp_l1_reg_loss: 4412.8498; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247288.3455; train_global_loss: 3390911.7500; train_optim_loss: 3390911.7500; val_kl_reg_loss: 12452.4863; val_edge_recon_loss: 2631004.7500; val_gene_expr_recon_loss: 489189.9375; val_masked_gp_l1_reg_loss: 4409.0796; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250052.8281; val_global_loss: 3387109.0000; val_optim_loss: 3387109.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9744; val_auprc_score: 0.9663; val_best_acc_score: 0.9297; val_best_f1_score: 0.9323; train_kl_reg_loss: 24658.2296; train_edge_recon_loss: 2625088.8611; train_gene_expr_recon_loss: 480421.6458; train_masked_gp_l1_reg_loss: 4406.7786; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246060.5486; train_global_loss: 3380636.1111; train_optim_loss: 3380636.1111; val_kl_reg_loss: 12396.9062; val_edge_recon_loss: 2646099.7500; val_gene_expr_recon_loss: 489649.8125; val_masked_gp_l1_reg_loss: 4403.8672; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250128.9844; val_global_loss: 3402679.2500; val_optim_loss: 3402679.2500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9753; val_auprc_score: 0.9667; val_best_acc_score: 0.9345; val_best_f1_score: 0.9368; train_kl_reg_loss: 24318.6257; train_edge_recon_loss: 2622835.3333; train_gene_expr_recon_loss: 481760.8160; train_masked_gp_l1_reg_loss: 4401.4698; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247177.3924; train_global_loss: 3380493.6389; train_optim_loss: 3380493.6389; val_kl_reg_loss: 12368.0137; val_edge_recon_loss: 2627785.7500; val_gene_expr_recon_loss: 489506.1250; val_masked_gp_l1_reg_loss: 4398.6528; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250051.9062; val_global_loss: 3384110.7500; val_optim_loss: 3384110.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9795; val_auprc_score: 0.9702; val_best_acc_score: 0.9380; val_best_f1_score: 0.9402; train_kl_reg_loss: 24267.7747; train_edge_recon_loss: 2627417.8889; train_gene_expr_recon_loss: 481750.4167; train_masked_gp_l1_reg_loss: 4397.2060; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247250.2344; train_global_loss: 3385083.4722; train_optim_loss: 3385083.4722; val_kl_reg_loss: 12359.3555; val_edge_recon_loss: 2616821.5000; val_gene_expr_recon_loss: 489357.5000; val_masked_gp_l1_reg_loss: 4395.7832; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250066.7656; val_global_loss: 3373000.7500; val_optim_loss: 3373000.7500
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9771; val_auprc_score: 0.9692; val_best_acc_score: 0.9345; val_best_f1_score: 0.9366; train_kl_reg_loss: 24397.9058; train_edge_recon_loss: 2624929.5278; train_gene_expr_recon_loss: 481106.1285; train_masked_gp_l1_reg_loss: 4395.3267; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247125.1267; train_global_loss: 3381954.0000; train_optim_loss: 3381954.0000; val_kl_reg_loss: 12445.6406; val_edge_recon_loss: 2617921.5000; val_gene_expr_recon_loss: 489303.6875; val_masked_gp_l1_reg_loss: 4394.6904; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249996.5781; val_global_loss: 3374062.2500; val_optim_loss: 3374062.2500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9762; val_auprc_score: 0.9676; val_best_acc_score: 0.9336; val_best_f1_score: 0.9353; train_kl_reg_loss: 24141.1489; train_edge_recon_loss: 2629955.9444; train_gene_expr_recon_loss: 480443.8576; train_masked_gp_l1_reg_loss: 4394.3012; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246596.8906; train_global_loss: 3385532.1667; train_optim_loss: 3385532.1667; val_kl_reg_loss: 12411.3359; val_edge_recon_loss: 2625884.5000; val_gene_expr_recon_loss: 489435.0938; val_masked_gp_l1_reg_loss: 4393.8276; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250029.8594; val_global_loss: 3382154.2500; val_optim_loss: 3382154.2500
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9787; val_auprc_score: 0.9719; val_best_acc_score: 0.9359; val_best_f1_score: 0.9375; train_kl_reg_loss: 24130.5851; train_edge_recon_loss: 2622038.2500; train_gene_expr_recon_loss: 481436.6701; train_masked_gp_l1_reg_loss: 4393.4500; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245841.0104; train_global_loss: 3377839.8889; train_optim_loss: 3377839.8889; val_kl_reg_loss: 12440.6582; val_edge_recon_loss: 2631046.5000; val_gene_expr_recon_loss: 489418.2500; val_masked_gp_l1_reg_loss: 4393.0278; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250059.9844; val_global_loss: 3387358.5000; val_optim_loss: 3387358.5000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9763; val_auprc_score: 0.9681; val_best_acc_score: 0.9333; val_best_f1_score: 0.9355; train_kl_reg_loss: 24139.2849; train_edge_recon_loss: 2617927.6111; train_gene_expr_recon_loss: 483454.8194; train_masked_gp_l1_reg_loss: 4392.7584; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246739.9965; train_global_loss: 3376654.5556; train_optim_loss: 3376654.5556; val_kl_reg_loss: 12411.4580; val_edge_recon_loss: 2623458.0000; val_gene_expr_recon_loss: 489151.5000; val_masked_gp_l1_reg_loss: 4392.4131; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249970.7344; val_global_loss: 3379384.2500; val_optim_loss: 3379384.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9743; val_auprc_score: 0.9651; val_best_acc_score: 0.9297; val_best_f1_score: 0.9328; train_kl_reg_loss: 24219.3053; train_edge_recon_loss: 2633989.9444; train_gene_expr_recon_loss: 482253.6528; train_masked_gp_l1_reg_loss: 4392.2540; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246390.5087; train_global_loss: 3391245.7500; train_optim_loss: 3391245.7500; val_kl_reg_loss: 12439.6504; val_edge_recon_loss: 2650476.0000; val_gene_expr_recon_loss: 489132.5000; val_masked_gp_l1_reg_loss: 4392.0967; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249965.7188; val_global_loss: 3406406.0000; val_optim_loss: 3406406.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9787; val_auprc_score: 0.9708; val_best_acc_score: 0.9359; val_best_f1_score: 0.9379; train_kl_reg_loss: 24260.7192; train_edge_recon_loss: 2620328.8889; train_gene_expr_recon_loss: 482194.9479; train_masked_gp_l1_reg_loss: 4392.0521; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245724.9809; train_global_loss: 3376901.5556; train_optim_loss: 3376901.5556; val_kl_reg_loss: 12472.7295; val_edge_recon_loss: 2644204.7500; val_gene_expr_recon_loss: 489085.5625; val_masked_gp_l1_reg_loss: 4391.9805; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249997.2344; val_global_loss: 3400152.2500; val_optim_loss: 3400152.2500
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9802; val_auprc_score: 0.9745; val_best_acc_score: 0.9364; val_best_f1_score: 0.9377; train_kl_reg_loss: 24226.6686; train_edge_recon_loss: 2625332.6111; train_gene_expr_recon_loss: 480977.9097; train_masked_gp_l1_reg_loss: 4391.9392; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246902.5330; train_global_loss: 3381831.6944; train_optim_loss: 3381831.6944; val_kl_reg_loss: 12438.9570; val_edge_recon_loss: 2616316.0000; val_gene_expr_recon_loss: 489076.6875; val_masked_gp_l1_reg_loss: 4391.8887; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249942.9688; val_global_loss: 3372166.7500; val_optim_loss: 3372166.7500
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9767; val_auprc_score: 0.9682; val_best_acc_score: 0.9340; val_best_f1_score: 0.9361; train_kl_reg_loss: 24169.6217; train_edge_recon_loss: 2621825.0000; train_gene_expr_recon_loss: 481426.0625; train_masked_gp_l1_reg_loss: 4391.8551; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247061.0764; train_global_loss: 3378873.5278; train_optim_loss: 3378873.5278; val_kl_reg_loss: 12384.4180; val_edge_recon_loss: 2634515.5000; val_gene_expr_recon_loss: 489085.5000; val_masked_gp_l1_reg_loss: 4391.8149; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249997.7812; val_global_loss: 3390375.0000; val_optim_loss: 3390375.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9753; val_auprc_score: 0.9667; val_best_acc_score: 0.9324; val_best_f1_score: 0.9352; train_kl_reg_loss: 24260.7682; train_edge_recon_loss: 2620202.1111; train_gene_expr_recon_loss: 482224.7604; train_masked_gp_l1_reg_loss: 4391.7865; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246130.4549; train_global_loss: 3377209.8333; train_optim_loss: 3377209.8333; val_kl_reg_loss: 12482.6406; val_edge_recon_loss: 2638756.0000; val_gene_expr_recon_loss: 489048.2500; val_masked_gp_l1_reg_loss: 4391.7510; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250015.8906; val_global_loss: 3394694.7500; val_optim_loss: 3394694.7500
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9766; val_auprc_score: 0.9663; val_best_acc_score: 0.9344; val_best_f1_score: 0.9365; train_kl_reg_loss: 24115.7782; train_edge_recon_loss: 2621116.0278; train_gene_expr_recon_loss: 480420.1910; train_masked_gp_l1_reg_loss: 4391.7261; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246447.9948; train_global_loss: 3376491.7500; train_optim_loss: 3376491.7500; val_kl_reg_loss: 12410.6758; val_edge_recon_loss: 2629662.5000; val_gene_expr_recon_loss: 489070.6875; val_masked_gp_l1_reg_loss: 4391.6938; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249984.5000; val_global_loss: 3385520.2500; val_optim_loss: 3385520.2500
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9775; val_auprc_score: 0.9713; val_best_acc_score: 0.9322; val_best_f1_score: 0.9346; train_kl_reg_loss: 24150.2148; train_edge_recon_loss: 2622255.5556; train_gene_expr_recon_loss: 480512.0104; train_masked_gp_l1_reg_loss: 4391.6666; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246128.8889; train_global_loss: 3377438.4722; train_optim_loss: 3377438.4722; val_kl_reg_loss: 12437.6328; val_edge_recon_loss: 2651429.7500; val_gene_expr_recon_loss: 489066.0938; val_masked_gp_l1_reg_loss: 4391.6328; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249964.7500; val_global_loss: 3407290.0000; val_optim_loss: 3407290.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9760; val_auprc_score: 0.9663; val_best_acc_score: 0.9351; val_best_f1_score: 0.9369; train_kl_reg_loss: 24079.1081; train_edge_recon_loss: 2620152.7500; train_gene_expr_recon_loss: 481960.2847; train_masked_gp_l1_reg_loss: 4391.6166; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246224.8785; train_global_loss: 3376808.6111; train_optim_loss: 3376808.6111; val_kl_reg_loss: 12425.0840; val_edge_recon_loss: 2624616.0000; val_gene_expr_recon_loss: 489068.3125; val_masked_gp_l1_reg_loss: 4391.6021; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249973.4375; val_global_loss: 3380474.2500; val_optim_loss: 3380474.2500
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9796; val_auprc_score: 0.9732; val_best_acc_score: 0.9369; val_best_f1_score: 0.9389; train_kl_reg_loss: 24138.0000; train_edge_recon_loss: 2630827.9444; train_gene_expr_recon_loss: 480053.6354; train_masked_gp_l1_reg_loss: 4391.5971; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245982.4340; train_global_loss: 3385393.5556; train_optim_loss: 3385393.5556; val_kl_reg_loss: 12380.0234; val_edge_recon_loss: 2611687.2500; val_gene_expr_recon_loss: 489072.3750; val_masked_gp_l1_reg_loss: 4391.5898; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249994.8438; val_global_loss: 3367525.7500; val_optim_loss: 3367525.7500
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9743; val_auprc_score: 0.9652; val_best_acc_score: 0.9313; val_best_f1_score: 0.9337; train_kl_reg_loss: 24220.7626; train_edge_recon_loss: 2622744.1667; train_gene_expr_recon_loss: 481201.0833; train_masked_gp_l1_reg_loss: 4391.5854; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246187.2066; train_global_loss: 3378744.6944; train_optim_loss: 3378744.6944; val_kl_reg_loss: 12393.9746; val_edge_recon_loss: 2627500.2500; val_gene_expr_recon_loss: 489067.7500; val_masked_gp_l1_reg_loss: 4391.5801; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249984.7344; val_global_loss: 3383338.2500; val_optim_loss: 3383338.2500
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9740; val_auprc_score: 0.9616; val_best_acc_score: 0.9306; val_best_f1_score: 0.9331; train_kl_reg_loss: 24162.0996; train_edge_recon_loss: 2630778.0556; train_gene_expr_recon_loss: 480569.4236; train_masked_gp_l1_reg_loss: 4391.5767; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246767.8663; train_global_loss: 3386668.9444; train_optim_loss: 3386668.9444; val_kl_reg_loss: 12429.9277; val_edge_recon_loss: 2646148.7500; val_gene_expr_recon_loss: 489076.0625; val_masked_gp_l1_reg_loss: 4391.5723; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249989.9219; val_global_loss: 3402036.2500; val_optim_loss: 3402036.2500
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9754; val_auprc_score: 0.9671; val_best_acc_score: 0.9316; val_best_f1_score: 0.9335; train_kl_reg_loss: 24158.0660; train_edge_recon_loss: 2617934.5000; train_gene_expr_recon_loss: 481925.4097; train_masked_gp_l1_reg_loss: 4391.5693; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246317.5191; train_global_loss: 3374726.9722; train_optim_loss: 3374726.9722; val_kl_reg_loss: 12410.0283; val_edge_recon_loss: 2638329.2500; val_gene_expr_recon_loss: 489062.1875; val_masked_gp_l1_reg_loss: 4391.5654; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249971.2656; val_global_loss: 3394164.2500; val_optim_loss: 3394164.2500
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9777; val_auprc_score: 0.9704; val_best_acc_score: 0.9324; val_best_f1_score: 0.9340; train_kl_reg_loss: 24136.1070; train_edge_recon_loss: 2640359.1944; train_gene_expr_recon_loss: 481464.4688; train_masked_gp_l1_reg_loss: 4391.5626; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 246999.0781; train_global_loss: 3397350.3889; train_optim_loss: 3397350.3889; val_kl_reg_loss: 12452.8359; val_edge_recon_loss: 2642941.2500; val_gene_expr_recon_loss: 489076.4375; val_masked_gp_l1_reg_loss: 4391.5586; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249987.4219; val_global_loss: 3398849.5000; val_optim_loss: 3398849.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9754; val_auprc_score: 0.9643; val_best_acc_score: 0.9305; val_best_f1_score: 0.9330; train_kl_reg_loss: 24142.0219; train_edge_recon_loss: 2621570.0278; train_gene_expr_recon_loss: 481113.4896; train_masked_gp_l1_reg_loss: 4391.5572; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 245950.9861; train_global_loss: 3377168.0556; train_optim_loss: 3377168.0556; val_kl_reg_loss: 12452.3008; val_edge_recon_loss: 2641357.5000; val_gene_expr_recon_loss: 489064.8750; val_masked_gp_l1_reg_loss: 4391.5557; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249964.9688; val_global_loss: 3397231.0000; val_optim_loss: 3397231.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9760; val_auprc_score: 0.9657; val_best_acc_score: 0.9317; val_best_f1_score: 0.9341; train_kl_reg_loss: 24142.4540; train_edge_recon_loss: 2624389.7500; train_gene_expr_recon_loss: 480840.1215; train_masked_gp_l1_reg_loss: 4391.5549; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247273.2517; train_global_loss: 3381037.1389; train_optim_loss: 3381037.1389; val_kl_reg_loss: 12456.4404; val_edge_recon_loss: 2653854.5000; val_gene_expr_recon_loss: 489072.0000; val_masked_gp_l1_reg_loss: 4391.5537; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249992.0469; val_global_loss: 3409766.5000; val_optim_loss: 3409766.5000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9762; val_auprc_score: 0.9667; val_best_acc_score: 0.9309; val_best_f1_score: 0.9334; train_kl_reg_loss: 24273.2550; train_edge_recon_loss: 2618870.9444; train_gene_expr_recon_loss: 482888.8819; train_masked_gp_l1_reg_loss: 4391.5533; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247609.5399; train_global_loss: 3378034.1111; train_optim_loss: 3378034.1111; val_kl_reg_loss: 12426.8262; val_edge_recon_loss: 2638320.5000; val_gene_expr_recon_loss: 489079.1250; val_masked_gp_l1_reg_loss: 4391.5527; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 250002.2656; val_global_loss: 3394220.2500; val_optim_loss: 3394220.2500
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9753; val_auprc_score: 0.9680; val_best_acc_score: 0.9306; val_best_f1_score: 0.9335; train_kl_reg_loss: 24151.0679; train_edge_recon_loss: 2623386.3889; train_gene_expr_recon_loss: 482386.2465; train_masked_gp_l1_reg_loss: 4391.5521; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 247045.9444; train_global_loss: 3381361.1389; train_optim_loss: 3381361.1389; val_kl_reg_loss: 12428.1982; val_edge_recon_loss: 2635444.5000; val_gene_expr_recon_loss: 489065.1562; val_masked_gp_l1_reg_loss: 4391.5518; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 249947.1875; val_global_loss: 3391276.7500; val_optim_loss: 3391276.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 11 min 36 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9769
val AUPRC score: 0.9683
val best accuracy score: 0.9317
val best F1 score: 0.9341
val target rna MSE score: 0.4473
val source rna MSE score: 0.2982
val target atac MSE score: 0.1375
val source atac MSE score: 0.0228
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
