[True]
Run timestamp: 10102023_051357_154.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_154']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7505; val_auprc_score: 0.7793; val_best_acc_score: 0.5543; val_best_f1_score: 0.6879; train_kl_reg_loss: 63691.1574; train_edge_recon_loss: 743207.1369; train_gene_expr_recon_loss: 22021615.7405; train_masked_gp_l1_reg_loss: 139326.1455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3349359.8220; train_chrom_access_recon_loss: 955472.6980; train_global_loss: 27272672.9160; train_optim_loss: 27272672.9160; val_kl_reg_loss: 82452.0328; val_edge_recon_loss: 812448.3958; val_gene_expr_recon_loss: 21217469.6000; val_masked_gp_l1_reg_loss: 111562.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 825661.3750; val_chrom_access_recon_loss: 932041.1875; val_global_loss: 23981635.4667; val_optim_loss: 23981635.4667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8565; val_auprc_score: 0.8593; val_best_acc_score: 0.7626; val_best_f1_score: 0.7485; train_kl_reg_loss: 73342.9308; train_edge_recon_loss: 733509.1183; train_gene_expr_recon_loss: 20827948.3206; train_masked_gp_l1_reg_loss: 108712.6000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 407203.3974; train_chrom_access_recon_loss: 919537.6403; train_global_loss: 23070254.0458; train_optim_loss: 23070254.0458; val_kl_reg_loss: 72649.5453; val_edge_recon_loss: 789917.5833; val_gene_expr_recon_loss: 20968703.6000; val_masked_gp_l1_reg_loss: 108341.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 215124.3906; val_chrom_access_recon_loss: 921834.8792; val_global_loss: 23076571.4667; val_optim_loss: 23076571.4667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9050; val_auprc_score: 0.8933; val_best_acc_score: 0.8204; val_best_f1_score: 0.8331; train_kl_reg_loss: 67726.9084; train_edge_recon_loss: 701744.9776; train_gene_expr_recon_loss: 20553695.9237; train_masked_gp_l1_reg_loss: 109084.1763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167619.9064; train_chrom_access_recon_loss: 909327.6846; train_global_loss: 22509199.2977; train_optim_loss: 22509199.2977; val_kl_reg_loss: 73488.2437; val_edge_recon_loss: 665174.2250; val_gene_expr_recon_loss: 20758727.2000; val_masked_gp_l1_reg_loss: 109650.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139577.2031; val_chrom_access_recon_loss: 912791.7833; val_global_loss: 22659409.3333; val_optim_loss: 22659409.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9246; val_auprc_score: 0.9094; val_best_acc_score: 0.8535; val_best_f1_score: 0.8610; train_kl_reg_loss: 77439.3167; train_edge_recon_loss: 637083.1231; train_gene_expr_recon_loss: 20300639.4656; train_masked_gp_l1_reg_loss: 110231.4698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128926.4586; train_chrom_access_recon_loss: 900340.4427; train_global_loss: 22154660.2748; train_optim_loss: 22154660.2748; val_kl_reg_loss: 75560.6359; val_edge_recon_loss: 627590.1250; val_gene_expr_recon_loss: 20427799.8667; val_masked_gp_l1_reg_loss: 111763.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122669.4141; val_chrom_access_recon_loss: 908119.6750; val_global_loss: 22273504.1333; val_optim_loss: 22273504.1333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9357; val_auprc_score: 0.9230; val_best_acc_score: 0.8654; val_best_f1_score: 0.8728; train_kl_reg_loss: 77535.3945; train_edge_recon_loss: 618394.2424; train_gene_expr_recon_loss: 20129118.5496; train_masked_gp_l1_reg_loss: 112540.3993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115792.9606; train_chrom_access_recon_loss: 893615.0911; train_global_loss: 21946996.7023; train_optim_loss: 21946996.7023; val_kl_reg_loss: 76468.2891; val_edge_recon_loss: 612277.5042; val_gene_expr_recon_loss: 20288612.6667; val_masked_gp_l1_reg_loss: 113705.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111482.4297; val_chrom_access_recon_loss: 899671.7625; val_global_loss: 22102218.1333; val_optim_loss: 22102218.1333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9345; val_auprc_score: 0.9159; val_best_acc_score: 0.8701; val_best_f1_score: 0.8761; train_kl_reg_loss: 75577.6391; train_edge_recon_loss: 611766.9766; train_gene_expr_recon_loss: 19959236.4427; train_masked_gp_l1_reg_loss: 114406.1013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107388.6491; train_chrom_access_recon_loss: 885780.0086; train_global_loss: 21754155.8626; train_optim_loss: 21754155.8626; val_kl_reg_loss: 74978.0188; val_edge_recon_loss: 612579.0375; val_gene_expr_recon_loss: 20124561.8667; val_masked_gp_l1_reg_loss: 115641.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104644.6328; val_chrom_access_recon_loss: 890678.7625; val_global_loss: 21923084.0000; val_optim_loss: 21923084.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9363; val_auprc_score: 0.9217; val_best_acc_score: 0.8688; val_best_f1_score: 0.8745; train_kl_reg_loss: 74204.8149; train_edge_recon_loss: 607818.1512; train_gene_expr_recon_loss: 19824467.0992; train_masked_gp_l1_reg_loss: 116178.6552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100985.8300; train_chrom_access_recon_loss: 880386.6236; train_global_loss: 21604041.2214; train_optim_loss: 21604041.2214; val_kl_reg_loss: 73039.9563; val_edge_recon_loss: 610167.3083; val_gene_expr_recon_loss: 20038089.7333; val_masked_gp_l1_reg_loss: 116990.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97909.5781; val_chrom_access_recon_loss: 890638.2208; val_global_loss: 21826835.2000; val_optim_loss: 21826835.2000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9420; val_auprc_score: 0.9291; val_best_acc_score: 0.8754; val_best_f1_score: 0.8820; train_kl_reg_loss: 73155.1710; train_edge_recon_loss: 601552.9843; train_gene_expr_recon_loss: 19683157.2672; train_masked_gp_l1_reg_loss: 117496.6313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96177.7205; train_chrom_access_recon_loss: 874246.7677; train_global_loss: 21445786.5954; train_optim_loss: 21445786.5954; val_kl_reg_loss: 72451.6797; val_edge_recon_loss: 606573.1583; val_gene_expr_recon_loss: 19954326.8000; val_masked_gp_l1_reg_loss: 117962.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94781.0625; val_chrom_access_recon_loss: 882854.0292; val_global_loss: 21728949.4667; val_optim_loss: 21728949.4667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9463; val_auprc_score: 0.9345; val_best_acc_score: 0.8809; val_best_f1_score: 0.8862; train_kl_reg_loss: 71882.6543; train_edge_recon_loss: 601171.9432; train_gene_expr_recon_loss: 19597987.7405; train_masked_gp_l1_reg_loss: 118491.5904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93173.3869; train_chrom_access_recon_loss: 869632.5887; train_global_loss: 21352340.0458; train_optim_loss: 21352340.0458; val_kl_reg_loss: 69757.9766; val_edge_recon_loss: 601826.2917; val_gene_expr_recon_loss: 19841881.8667; val_masked_gp_l1_reg_loss: 119400.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92067.3984; val_chrom_access_recon_loss: 874468.5208; val_global_loss: 21599402.5333; val_optim_loss: 21599402.5333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9537; val_auprc_score: 0.9423; val_best_acc_score: 0.8919; val_best_f1_score: 0.8961; train_kl_reg_loss: 71183.0417; train_edge_recon_loss: 596791.2901; train_gene_expr_recon_loss: 19478082.4122; train_masked_gp_l1_reg_loss: 119633.3905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90825.8156; train_chrom_access_recon_loss: 864772.7891; train_global_loss: 21221288.6718; train_optim_loss: 21221288.6718; val_kl_reg_loss: 72022.7599; val_edge_recon_loss: 597774.6125; val_gene_expr_recon_loss: 19660893.7333; val_masked_gp_l1_reg_loss: 119940.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89660.4141; val_chrom_access_recon_loss: 867445.6208; val_global_loss: 21407736.4000; val_optim_loss: 21407736.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9540; val_auprc_score: 0.9451; val_best_acc_score: 0.8910; val_best_f1_score: 0.8946; train_kl_reg_loss: 70363.0318; train_edge_recon_loss: 596198.2624; train_gene_expr_recon_loss: 19418525.2824; train_masked_gp_l1_reg_loss: 120368.8672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88912.4916; train_chrom_access_recon_loss: 861622.1388; train_global_loss: 21155990.1374; train_optim_loss: 21155990.1374; val_kl_reg_loss: 71228.0354; val_edge_recon_loss: 597538.0875; val_gene_expr_recon_loss: 19493044.5333; val_masked_gp_l1_reg_loss: 120915.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88908.4297; val_chrom_access_recon_loss: 862898.1375; val_global_loss: 21234532.8000; val_optim_loss: 21234532.8000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9556; val_auprc_score: 0.9450; val_best_acc_score: 0.8914; val_best_f1_score: 0.8959; train_kl_reg_loss: 69682.1354; train_edge_recon_loss: 594318.6942; train_gene_expr_recon_loss: 19329111.6336; train_masked_gp_l1_reg_loss: 121239.2950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88184.9810; train_chrom_access_recon_loss: 858018.1913; train_global_loss: 21060554.9008; train_optim_loss: 21060554.9008; val_kl_reg_loss: 70910.7026; val_edge_recon_loss: 591880.0042; val_gene_expr_recon_loss: 19602084.8000; val_masked_gp_l1_reg_loss: 121907.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87890.7266; val_chrom_access_recon_loss: 870599.6375; val_global_loss: 21345273.0667; val_optim_loss: 21345273.0667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9599; val_auprc_score: 0.9520; val_best_acc_score: 0.9011; val_best_f1_score: 0.9049; train_kl_reg_loss: 69302.6625; train_edge_recon_loss: 592763.2724; train_gene_expr_recon_loss: 19244830.7634; train_masked_gp_l1_reg_loss: 121917.8126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87546.9049; train_chrom_access_recon_loss: 854198.0291; train_global_loss: 20970559.4504; train_optim_loss: 20970559.4504; val_kl_reg_loss: 70464.2594; val_edge_recon_loss: 593797.5375; val_gene_expr_recon_loss: 19490570.9333; val_masked_gp_l1_reg_loss: 122572.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87975.9688; val_chrom_access_recon_loss: 858694.7875; val_global_loss: 21224075.4667; val_optim_loss: 21224075.4667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9605; val_auprc_score: 0.9507; val_best_acc_score: 0.9022; val_best_f1_score: 0.9052; train_kl_reg_loss: 68551.7782; train_edge_recon_loss: 590425.4218; train_gene_expr_recon_loss: 19169373.0992; train_masked_gp_l1_reg_loss: 122823.6206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87488.3294; train_chrom_access_recon_loss: 850530.4885; train_global_loss: 20889192.9618; train_optim_loss: 20889192.9618; val_kl_reg_loss: 67675.6880; val_edge_recon_loss: 592380.3250; val_gene_expr_recon_loss: 19388749.7333; val_masked_gp_l1_reg_loss: 123207.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87822.4922; val_chrom_access_recon_loss: 854897.5417; val_global_loss: 21114733.6000; val_optim_loss: 21114733.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9620; val_auprc_score: 0.9516; val_best_acc_score: 0.9057; val_best_f1_score: 0.9104; train_kl_reg_loss: 68414.7878; train_edge_recon_loss: 588324.6403; train_gene_expr_recon_loss: 19111583.4351; train_masked_gp_l1_reg_loss: 123737.9817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88218.0725; train_chrom_access_recon_loss: 848131.1236; train_global_loss: 20828410.1374; train_optim_loss: 20828410.1374; val_kl_reg_loss: 67498.9109; val_edge_recon_loss: 592748.7500; val_gene_expr_recon_loss: 19359091.3333; val_masked_gp_l1_reg_loss: 124328.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88205.3281; val_chrom_access_recon_loss: 856619.2917; val_global_loss: 21088492.1333; val_optim_loss: 21088492.1333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9599; val_auprc_score: 0.9490; val_best_acc_score: 0.9026; val_best_f1_score: 0.9059; train_kl_reg_loss: 67638.2926; train_edge_recon_loss: 587924.2953; train_gene_expr_recon_loss: 19040891.7557; train_masked_gp_l1_reg_loss: 124726.3867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88581.1856; train_chrom_access_recon_loss: 845620.3602; train_global_loss: 20755382.1985; train_optim_loss: 20755382.1985; val_kl_reg_loss: 68356.6109; val_edge_recon_loss: 593544.6792; val_gene_expr_recon_loss: 19253603.8667; val_masked_gp_l1_reg_loss: 125404.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88170.3672; val_chrom_access_recon_loss: 850295.9750; val_global_loss: 20979374.4000; val_optim_loss: 20979374.4000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9600; val_auprc_score: 0.9500; val_best_acc_score: 0.9020; val_best_f1_score: 0.9069; train_kl_reg_loss: 66858.9747; train_edge_recon_loss: 589251.8841; train_gene_expr_recon_loss: 18991942.8702; train_masked_gp_l1_reg_loss: 125709.0093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88217.1007; train_chrom_access_recon_loss: 843864.0902; train_global_loss: 20705843.9847; train_optim_loss: 20705843.9847; val_kl_reg_loss: 49535.8786; val_edge_recon_loss: 626439.1292; val_gene_expr_recon_loss: 19569977.8667; val_masked_gp_l1_reg_loss: 126786.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91634.4766; val_chrom_access_recon_loss: 861407.7792; val_global_loss: 21325780.6667; val_optim_loss: 21325780.6667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9631; val_auprc_score: 0.9556; val_best_acc_score: 0.9056; val_best_f1_score: 0.9084; train_kl_reg_loss: 64089.5902; train_edge_recon_loss: 596537.2872; train_gene_expr_recon_loss: 19017587.4046; train_masked_gp_l1_reg_loss: 125325.9489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100640.3789; train_chrom_access_recon_loss: 847147.4618; train_global_loss: 20751328.1527; train_optim_loss: 20751328.1527; val_kl_reg_loss: 66661.6398; val_edge_recon_loss: 595926.0625; val_gene_expr_recon_loss: 19193272.1333; val_masked_gp_l1_reg_loss: 124762.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96999.2500; val_chrom_access_recon_loss: 851346.3667; val_global_loss: 20928968.4000; val_optim_loss: 20928968.4000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9637; val_auprc_score: 0.9532; val_best_acc_score: 0.9076; val_best_f1_score: 0.9106; train_kl_reg_loss: 67699.8853; train_edge_recon_loss: 586545.9256; train_gene_expr_recon_loss: 18909628.8397; train_masked_gp_l1_reg_loss: 125111.6437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95467.3230; train_chrom_access_recon_loss: 839928.2891; train_global_loss: 20624382.0153; train_optim_loss: 20624382.0153; val_kl_reg_loss: 66918.9849; val_edge_recon_loss: 591556.6208; val_gene_expr_recon_loss: 19157432.4000; val_masked_gp_l1_reg_loss: 126032.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94590.8984; val_chrom_access_recon_loss: 847584.2292; val_global_loss: 20884114.2667; val_optim_loss: 20884114.2667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9688; val_auprc_score: 0.9613; val_best_acc_score: 0.9165; val_best_f1_score: 0.9182; train_kl_reg_loss: 67015.2364; train_edge_recon_loss: 586994.4685; train_gene_expr_recon_loss: 18853077.3740; train_masked_gp_l1_reg_loss: 126124.3352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93779.9671; train_chrom_access_recon_loss: 837578.7428; train_global_loss: 20564570.0916; train_optim_loss: 20564570.0916; val_kl_reg_loss: 66648.3302; val_edge_recon_loss: 585919.2083; val_gene_expr_recon_loss: 19079042.1333; val_masked_gp_l1_reg_loss: 127163.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94438.7812; val_chrom_access_recon_loss: 843894.9833; val_global_loss: 20797106.5333; val_optim_loss: 20797106.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9632; val_auprc_score: 0.9523; val_best_acc_score: 0.9058; val_best_f1_score: 0.9099; train_kl_reg_loss: 65951.1946; train_edge_recon_loss: 588087.3736; train_gene_expr_recon_loss: 18787063.1450; train_masked_gp_l1_reg_loss: 127661.1199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92797.3079; train_chrom_access_recon_loss: 835671.1694; train_global_loss: 20497231.2824; train_optim_loss: 20497231.2824; val_kl_reg_loss: 65707.1880; val_edge_recon_loss: 593184.8917; val_gene_expr_recon_loss: 19090183.7333; val_masked_gp_l1_reg_loss: 128411.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90406.4531; val_chrom_access_recon_loss: 846043.3250; val_global_loss: 20813936.6667; val_optim_loss: 20813936.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9671; val_auprc_score: 0.9585; val_best_acc_score: 0.9162; val_best_f1_score: 0.9193; train_kl_reg_loss: 66140.7158; train_edge_recon_loss: 585015.7743; train_gene_expr_recon_loss: 18735807.2519; train_masked_gp_l1_reg_loss: 128865.8081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90977.3126; train_chrom_access_recon_loss: 833576.7686; train_global_loss: 20440383.6336; train_optim_loss: 20440383.6336; val_kl_reg_loss: 65735.0872; val_edge_recon_loss: 586874.4750; val_gene_expr_recon_loss: 18895957.8667; val_masked_gp_l1_reg_loss: 129895.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92302.7344; val_chrom_access_recon_loss: 839143.5125; val_global_loss: 20609909.0667; val_optim_loss: 20609909.0667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9671; val_auprc_score: 0.9594; val_best_acc_score: 0.9109; val_best_f1_score: 0.9155; train_kl_reg_loss: 65160.1923; train_edge_recon_loss: 585346.8034; train_gene_expr_recon_loss: 18685830.7023; train_masked_gp_l1_reg_loss: 130356.2217; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90148.6429; train_chrom_access_recon_loss: 831924.6985; train_global_loss: 20388767.2672; train_optim_loss: 20388767.2672; val_kl_reg_loss: 64957.6549; val_edge_recon_loss: 586750.9417; val_gene_expr_recon_loss: 18947339.4667; val_masked_gp_l1_reg_loss: 131274.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91555.3438; val_chrom_access_recon_loss: 838089.4083; val_global_loss: 20659967.4667; val_optim_loss: 20659967.4667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9660; val_auprc_score: 0.9569; val_best_acc_score: 0.9115; val_best_f1_score: 0.9149; train_kl_reg_loss: 64776.2736; train_edge_recon_loss: 584450.6636; train_gene_expr_recon_loss: 18635498.9008; train_masked_gp_l1_reg_loss: 131843.0757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89633.2286; train_chrom_access_recon_loss: 831087.7777; train_global_loss: 20337290.0000; train_optim_loss: 20337290.0000; val_kl_reg_loss: 64122.6471; val_edge_recon_loss: 586772.3750; val_gene_expr_recon_loss: 18898014.6667; val_masked_gp_l1_reg_loss: 132175.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89620.2109; val_chrom_access_recon_loss: 837019.5917; val_global_loss: 20607725.3333; val_optim_loss: 20607725.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9640; val_auprc_score: 0.9535; val_best_acc_score: 0.9096; val_best_f1_score: 0.9136; train_kl_reg_loss: 64489.8073; train_edge_recon_loss: 582996.2090; train_gene_expr_recon_loss: 18606629.6031; train_masked_gp_l1_reg_loss: 132869.3756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88458.2311; train_chrom_access_recon_loss: 830719.9685; train_global_loss: 20306162.9466; train_optim_loss: 20306162.9466; val_kl_reg_loss: 64120.8682; val_edge_recon_loss: 586920.9542; val_gene_expr_recon_loss: 18889225.2000; val_masked_gp_l1_reg_loss: 133911.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88961.7578; val_chrom_access_recon_loss: 837710.1500; val_global_loss: 20600851.2000; val_optim_loss: 20600851.2000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9404; val_auprc_score: 0.9275; val_best_acc_score: 0.8707; val_best_f1_score: 0.8742; train_kl_reg_loss: 38107.3949; train_edge_recon_loss: 721969.6002; train_gene_expr_recon_loss: 17840050.9008; train_masked_gp_l1_reg_loss: 133006.9673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90455.0202; train_chrom_access_recon_loss: 784584.8573; train_global_loss: 19608174.6718; train_optim_loss: 19608174.6718; val_kl_reg_loss: 16898.1823; val_edge_recon_loss: 758555.3042; val_gene_expr_recon_loss: 17746152.1333; val_masked_gp_l1_reg_loss: 131778.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101551.7422; val_chrom_access_recon_loss: 786397.7667; val_global_loss: 19541333.2000; val_optim_loss: 19541333.2000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8989; val_auprc_score: 0.8792; val_best_acc_score: 0.8271; val_best_f1_score: 0.8461; train_kl_reg_loss: 24942.8524; train_edge_recon_loss: 712088.2853; train_gene_expr_recon_loss: 17574801.9847; train_masked_gp_l1_reg_loss: 130864.3211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98632.7737; train_chrom_access_recon_loss: 775604.8130; train_global_loss: 19316934.8550; train_optim_loss: 19316934.8550; val_kl_reg_loss: 18395.2784; val_edge_recon_loss: 696856.6625; val_gene_expr_recon_loss: 17735452.2667; val_masked_gp_l1_reg_loss: 130494.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98916.0938; val_chrom_access_recon_loss: 782674.5375; val_global_loss: 19462788.4000; val_optim_loss: 19462788.4000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8946; val_auprc_score: 0.8730; val_best_acc_score: 0.8193; val_best_f1_score: 0.8352; train_kl_reg_loss: 24074.2461; train_edge_recon_loss: 678753.0506; train_gene_expr_recon_loss: 17475282.9313; train_masked_gp_l1_reg_loss: 126892.7221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96432.9159; train_chrom_access_recon_loss: 772952.6794; train_global_loss: 19174388.4885; train_optim_loss: 19174388.4885; val_kl_reg_loss: 21591.6046; val_edge_recon_loss: 656449.1625; val_gene_expr_recon_loss: 17636748.5333; val_masked_gp_l1_reg_loss: 123253.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92269.4141; val_chrom_access_recon_loss: 780572.4333; val_global_loss: 19310885.6000; val_optim_loss: 19310885.6000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8967; val_auprc_score: 0.8815; val_best_acc_score: 0.8188; val_best_f1_score: 0.8331; train_kl_reg_loss: 29418.4898; train_edge_recon_loss: 633631.4222; train_gene_expr_recon_loss: 17411931.5878; train_masked_gp_l1_reg_loss: 120445.1836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90888.2384; train_chrom_access_recon_loss: 770571.4051; train_global_loss: 19056886.3664; train_optim_loss: 19056886.3664; val_kl_reg_loss: 31583.9522; val_edge_recon_loss: 624404.8417; val_gene_expr_recon_loss: 17598236.6667; val_masked_gp_l1_reg_loss: 117800.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88680.2031; val_chrom_access_recon_loss: 779398.9292; val_global_loss: 19240104.5333; val_optim_loss: 19240104.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9042; val_auprc_score: 0.8848; val_best_acc_score: 0.8277; val_best_f1_score: 0.8417; train_kl_reg_loss: 36831.4070; train_edge_recon_loss: 611525.9055; train_gene_expr_recon_loss: 17374590.7634; train_masked_gp_l1_reg_loss: 115144.0579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86753.7513; train_chrom_access_recon_loss: 770413.9399; train_global_loss: 18995259.6947; train_optim_loss: 18995259.6947; val_kl_reg_loss: 37258.6753; val_edge_recon_loss: 608959.8625; val_gene_expr_recon_loss: 17624730.0000; val_masked_gp_l1_reg_loss: 112703.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84941.8281; val_chrom_access_recon_loss: 778971.1292; val_global_loss: 19247565.7333; val_optim_loss: 19247565.7333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9098; val_auprc_score: 0.8953; val_best_acc_score: 0.8263; val_best_f1_score: 0.8414; train_kl_reg_loss: 40674.2544; train_edge_recon_loss: 605109.0577; train_gene_expr_recon_loss: 17335653.2443; train_masked_gp_l1_reg_loss: 110360.2195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84003.3462; train_chrom_access_recon_loss: 770145.2476; train_global_loss: 18945945.4504; train_optim_loss: 18945945.4504; val_kl_reg_loss: 39703.6961; val_edge_recon_loss: 602040.2833; val_gene_expr_recon_loss: 17557443.2667; val_masked_gp_l1_reg_loss: 108334.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83011.0469; val_chrom_access_recon_loss: 775956.7083; val_global_loss: 19166489.6000; val_optim_loss: 19166489.6000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9143; val_auprc_score: 0.9012; val_best_acc_score: 0.8339; val_best_f1_score: 0.8461; train_kl_reg_loss: 42701.0348; train_edge_recon_loss: 600483.3440; train_gene_expr_recon_loss: 17301322.3969; train_masked_gp_l1_reg_loss: 106531.8312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81821.3070; train_chrom_access_recon_loss: 768208.3693; train_global_loss: 18901068.3664; train_optim_loss: 18901068.3664; val_kl_reg_loss: 40165.9956; val_edge_recon_loss: 603159.9458; val_gene_expr_recon_loss: 17503017.9333; val_masked_gp_l1_reg_loss: 105239.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81227.7969; val_chrom_access_recon_loss: 778591.9625; val_global_loss: 19111404.1333; val_optim_loss: 19111404.1333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9142; val_auprc_score: 0.8968; val_best_acc_score: 0.8385; val_best_f1_score: 0.8502; train_kl_reg_loss: 43889.6749; train_edge_recon_loss: 598602.2056; train_gene_expr_recon_loss: 17284823.6489; train_masked_gp_l1_reg_loss: 103904.5329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80033.4555; train_chrom_access_recon_loss: 767801.0969; train_global_loss: 18879054.5802; train_optim_loss: 18879054.5802; val_kl_reg_loss: 42833.5859; val_edge_recon_loss: 603966.6333; val_gene_expr_recon_loss: 17581495.8000; val_masked_gp_l1_reg_loss: 102810.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79897.8828; val_chrom_access_recon_loss: 773133.2208; val_global_loss: 19184136.8000; val_optim_loss: 19184136.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9265; val_auprc_score: 0.9147; val_best_acc_score: 0.8504; val_best_f1_score: 0.8598; train_kl_reg_loss: 45305.7364; train_edge_recon_loss: 595294.2529; train_gene_expr_recon_loss: 17254191.6412; train_masked_gp_l1_reg_loss: 101848.3051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78907.5233; train_chrom_access_recon_loss: 767264.0186; train_global_loss: 18842811.3893; train_optim_loss: 18842811.3893; val_kl_reg_loss: 44478.2151; val_edge_recon_loss: 596777.5292; val_gene_expr_recon_loss: 17476168.2000; val_masked_gp_l1_reg_loss: 101101.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77699.0781; val_chrom_access_recon_loss: 776629.6000; val_global_loss: 19072855.6000; val_optim_loss: 19072855.6000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9257; val_auprc_score: 0.9128; val_best_acc_score: 0.8548; val_best_f1_score: 0.8641; train_kl_reg_loss: 46297.4584; train_edge_recon_loss: 592631.1236; train_gene_expr_recon_loss: 17236448.8626; train_masked_gp_l1_reg_loss: 100298.2021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77716.3538; train_chrom_access_recon_loss: 766518.1231; train_global_loss: 18819910.0763; train_optim_loss: 18819910.0763; val_kl_reg_loss: 45332.9656; val_edge_recon_loss: 596052.1958; val_gene_expr_recon_loss: 17377990.0000; val_masked_gp_l1_reg_loss: 99785.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77292.3516; val_chrom_access_recon_loss: 770200.2958; val_global_loss: 18966653.7333; val_optim_loss: 18966653.7333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9320; val_auprc_score: 0.9205; val_best_acc_score: 0.8583; val_best_f1_score: 0.8646; train_kl_reg_loss: 46861.7981; train_edge_recon_loss: 590780.9237; train_gene_expr_recon_loss: 17227221.5573; train_masked_gp_l1_reg_loss: 99068.1536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76916.3729; train_chrom_access_recon_loss: 765237.2347; train_global_loss: 18806086.0458; train_optim_loss: 18806086.0458; val_kl_reg_loss: 46312.1263; val_edge_recon_loss: 594367.6917; val_gene_expr_recon_loss: 17447070.2000; val_masked_gp_l1_reg_loss: 98714.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76817.4922; val_chrom_access_recon_loss: 771998.7875; val_global_loss: 19035280.8000; val_optim_loss: 19035280.8000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9349; val_auprc_score: 0.9200; val_best_acc_score: 0.8689; val_best_f1_score: 0.8776; train_kl_reg_loss: 47340.2604; train_edge_recon_loss: 590044.7457; train_gene_expr_recon_loss: 17200183.2824; train_masked_gp_l1_reg_loss: 98285.9705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76376.5880; train_chrom_access_recon_loss: 764793.1450; train_global_loss: 18777023.9847; train_optim_loss: 18777023.9847; val_kl_reg_loss: 46704.3013; val_edge_recon_loss: 587158.2667; val_gene_expr_recon_loss: 17445094.6667; val_masked_gp_l1_reg_loss: 98013.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76275.7188; val_chrom_access_recon_loss: 769971.9625; val_global_loss: 19023218.9333; val_optim_loss: 19023218.9333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9375; val_auprc_score: 0.9220; val_best_acc_score: 0.8703; val_best_f1_score: 0.8766; train_kl_reg_loss: 47918.4174; train_edge_recon_loss: 588957.3655; train_gene_expr_recon_loss: 17187386.9847; train_masked_gp_l1_reg_loss: 97675.7086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75888.4209; train_chrom_access_recon_loss: 765099.8240; train_global_loss: 18762926.5802; train_optim_loss: 18762926.5802; val_kl_reg_loss: 46983.2846; val_edge_recon_loss: 590286.4708; val_gene_expr_recon_loss: 17397161.2667; val_masked_gp_l1_reg_loss: 97551.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75280.2969; val_chrom_access_recon_loss: 770768.6208; val_global_loss: 18978031.7333; val_optim_loss: 18978031.7333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9387; val_auprc_score: 0.9251; val_best_acc_score: 0.8742; val_best_f1_score: 0.8798; train_kl_reg_loss: 47719.7453; train_edge_recon_loss: 587659.5052; train_gene_expr_recon_loss: 17142416.6107; train_masked_gp_l1_reg_loss: 97287.0926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75543.7072; train_chrom_access_recon_loss: 764076.1656; train_global_loss: 18714702.8397; train_optim_loss: 18714702.8397; val_kl_reg_loss: 48313.8346; val_edge_recon_loss: 587856.2250; val_gene_expr_recon_loss: 17396955.0667; val_masked_gp_l1_reg_loss: 97015.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75227.1094; val_chrom_access_recon_loss: 770608.7125; val_global_loss: 18975977.4667; val_optim_loss: 18975977.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9408; val_auprc_score: 0.9301; val_best_acc_score: 0.8716; val_best_f1_score: 0.8791; train_kl_reg_loss: 48814.2702; train_edge_recon_loss: 586739.7939; train_gene_expr_recon_loss: 17138585.6336; train_masked_gp_l1_reg_loss: 93742.1011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60384.1676; train_chrom_access_recon_loss: 764714.1255; train_global_loss: 18692980.1832; train_optim_loss: 18692980.1832; val_kl_reg_loss: 48522.6477; val_edge_recon_loss: 587851.7000; val_gene_expr_recon_loss: 17278858.2667; val_masked_gp_l1_reg_loss: 92990.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58130.9297; val_chrom_access_recon_loss: 764131.2792; val_global_loss: 18830484.0000; val_optim_loss: 18830484.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9388; val_auprc_score: 0.9258; val_best_acc_score: 0.8716; val_best_f1_score: 0.8786; train_kl_reg_loss: 49612.5490; train_edge_recon_loss: 585371.0740; train_gene_expr_recon_loss: 17117406.5496; train_masked_gp_l1_reg_loss: 92817.9693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57624.0930; train_chrom_access_recon_loss: 763223.1546; train_global_loss: 18666055.4656; train_optim_loss: 18666055.4656; val_kl_reg_loss: 49499.9760; val_edge_recon_loss: 589145.4417; val_gene_expr_recon_loss: 17357692.5333; val_masked_gp_l1_reg_loss: 92672.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57152.4961; val_chrom_access_recon_loss: 771528.6375; val_global_loss: 18917690.5333; val_optim_loss: 18917690.5333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9419; val_auprc_score: 0.9303; val_best_acc_score: 0.8746; val_best_f1_score: 0.8800; train_kl_reg_loss: 50036.3069; train_edge_recon_loss: 585692.7595; train_gene_expr_recon_loss: 17113790.6107; train_masked_gp_l1_reg_loss: 92593.1185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56802.3765; train_chrom_access_recon_loss: 763105.4323; train_global_loss: 18662020.5344; train_optim_loss: 18662020.5344; val_kl_reg_loss: 50012.2180; val_edge_recon_loss: 588064.0833; val_gene_expr_recon_loss: 17384046.8667; val_masked_gp_l1_reg_loss: 92533.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56493.9453; val_chrom_access_recon_loss: 771319.9375; val_global_loss: 18942471.3333; val_optim_loss: 18942471.3333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9430; val_auprc_score: 0.9283; val_best_acc_score: 0.8751; val_best_f1_score: 0.8801; train_kl_reg_loss: 50507.6999; train_edge_recon_loss: 583472.3950; train_gene_expr_recon_loss: 17106099.1908; train_masked_gp_l1_reg_loss: 92429.9960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56262.4191; train_chrom_access_recon_loss: 763128.9179; train_global_loss: 18651900.7328; train_optim_loss: 18651900.7328; val_kl_reg_loss: 50040.0521; val_edge_recon_loss: 588633.0167; val_gene_expr_recon_loss: 17354368.1333; val_masked_gp_l1_reg_loss: 92343.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56029.3945; val_chrom_access_recon_loss: 768017.9458; val_global_loss: 18909432.9333; val_optim_loss: 18909432.9333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9466; val_auprc_score: 0.9359; val_best_acc_score: 0.8779; val_best_f1_score: 0.8835; train_kl_reg_loss: 50857.4059; train_edge_recon_loss: 585232.4098; train_gene_expr_recon_loss: 17109934.6336; train_masked_gp_l1_reg_loss: 92290.3224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55811.4207; train_chrom_access_recon_loss: 763362.7796; train_global_loss: 18657488.9466; train_optim_loss: 18657488.9466; val_kl_reg_loss: 50541.1477; val_edge_recon_loss: 584542.4708; val_gene_expr_recon_loss: 17384504.4000; val_masked_gp_l1_reg_loss: 92236.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55575.5078; val_chrom_access_recon_loss: 771406.7875; val_global_loss: 18938806.5333; val_optim_loss: 18938806.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9455; val_auprc_score: 0.9339; val_best_acc_score: 0.8767; val_best_f1_score: 0.8841; train_kl_reg_loss: 51086.7996; train_edge_recon_loss: 583405.4790; train_gene_expr_recon_loss: 17096117.8321; train_masked_gp_l1_reg_loss: 91874.2510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54076.2812; train_chrom_access_recon_loss: 762679.5219; train_global_loss: 18639240.2595; train_optim_loss: 18639240.2595; val_kl_reg_loss: 50632.1831; val_edge_recon_loss: 585536.8417; val_gene_expr_recon_loss: 17417668.8000; val_masked_gp_l1_reg_loss: 91757.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53851.1094; val_chrom_access_recon_loss: 774139.9792; val_global_loss: 18973587.2000; val_optim_loss: 18973587.2000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9463; val_auprc_score: 0.9351; val_best_acc_score: 0.8805; val_best_f1_score: 0.8859; train_kl_reg_loss: 51064.5089; train_edge_recon_loss: 582658.4819; train_gene_expr_recon_loss: 17106488.7176; train_masked_gp_l1_reg_loss: 91724.4139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53779.8104; train_chrom_access_recon_loss: 763412.4241; train_global_loss: 18649128.2748; train_optim_loss: 18649128.2748; val_kl_reg_loss: 50566.0253; val_edge_recon_loss: 583701.0250; val_gene_expr_recon_loss: 17406511.3333; val_masked_gp_l1_reg_loss: 91690.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53714.2734; val_chrom_access_recon_loss: 776983.1167; val_global_loss: 18963165.7333; val_optim_loss: 18963165.7333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9437; val_auprc_score: 0.9334; val_best_acc_score: 0.8759; val_best_f1_score: 0.8819; train_kl_reg_loss: 51053.0375; train_edge_recon_loss: 584531.8411; train_gene_expr_recon_loss: 17116196.7557; train_masked_gp_l1_reg_loss: 91671.8456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53653.4444; train_chrom_access_recon_loss: 763078.6403; train_global_loss: 18660185.3893; train_optim_loss: 18660185.3893; val_kl_reg_loss: 50488.4669; val_edge_recon_loss: 587306.5917; val_gene_expr_recon_loss: 17271407.6000; val_masked_gp_l1_reg_loss: 91652.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53600.6992; val_chrom_access_recon_loss: 768010.2375; val_global_loss: 18822464.9333; val_optim_loss: 18822464.9333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9435; val_auprc_score: 0.9326; val_best_acc_score: 0.8794; val_best_f1_score: 0.8841; train_kl_reg_loss: 51038.3848; train_edge_recon_loss: 585177.3182; train_gene_expr_recon_loss: 17089307.9847; train_masked_gp_l1_reg_loss: 91641.2607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53549.4225; train_chrom_access_recon_loss: 761548.9857; train_global_loss: 18632263.2214; train_optim_loss: 18632263.2214; val_kl_reg_loss: 50811.2922; val_edge_recon_loss: 586893.3667; val_gene_expr_recon_loss: 17374853.8667; val_masked_gp_l1_reg_loss: 91622.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53505.3867; val_chrom_access_recon_loss: 770637.2458; val_global_loss: 18928323.8667; val_optim_loss: 18928323.8667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9460; val_auprc_score: 0.9338; val_best_acc_score: 0.8813; val_best_f1_score: 0.8870; train_kl_reg_loss: 51150.5465; train_edge_recon_loss: 584025.7867; train_gene_expr_recon_loss: 17097686.8168; train_masked_gp_l1_reg_loss: 91611.6797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53473.8809; train_chrom_access_recon_loss: 762293.7557; train_global_loss: 18640242.4580; train_optim_loss: 18640242.4580; val_kl_reg_loss: 50850.8240; val_edge_recon_loss: 585774.8250; val_gene_expr_recon_loss: 17382182.1333; val_masked_gp_l1_reg_loss: 91599.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53435.7383; val_chrom_access_recon_loss: 771650.1083; val_global_loss: 18935493.8667; val_optim_loss: 18935493.8667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9428; val_auprc_score: 0.9296; val_best_acc_score: 0.8779; val_best_f1_score: 0.8841; train_kl_reg_loss: 51233.5290; train_edge_recon_loss: 583233.9060; train_gene_expr_recon_loss: 17100615.1679; train_masked_gp_l1_reg_loss: 91594.7337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53401.1434; train_chrom_access_recon_loss: 762252.6503; train_global_loss: 18642330.9924; train_optim_loss: 18642330.9924; val_kl_reg_loss: 50797.4310; val_edge_recon_loss: 587303.7458; val_gene_expr_recon_loss: 17391248.2667; val_masked_gp_l1_reg_loss: 91583.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53360.1094; val_chrom_access_recon_loss: 773153.2208; val_global_loss: 18947446.6667; val_optim_loss: 18947446.6667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9424; val_auprc_score: 0.9328; val_best_acc_score: 0.8744; val_best_f1_score: 0.8819; train_kl_reg_loss: 51264.7996; train_edge_recon_loss: 582891.4327; train_gene_expr_recon_loss: 17104540.1756; train_masked_gp_l1_reg_loss: 91576.0844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53332.5483; train_chrom_access_recon_loss: 763493.4198; train_global_loss: 18647098.5496; train_optim_loss: 18647098.5496; val_kl_reg_loss: 50863.9674; val_edge_recon_loss: 586862.8042; val_gene_expr_recon_loss: 17375709.3333; val_masked_gp_l1_reg_loss: 91564.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53294.5703; val_chrom_access_recon_loss: 774077.8958; val_global_loss: 18932372.1333; val_optim_loss: 18932372.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9450; val_auprc_score: 0.9334; val_best_acc_score: 0.8774; val_best_f1_score: 0.8828; train_kl_reg_loss: 51260.4405; train_edge_recon_loss: 585081.1536; train_gene_expr_recon_loss: 17109551.8702; train_masked_gp_l1_reg_loss: 91528.5252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53146.9566; train_chrom_access_recon_loss: 763759.5654; train_global_loss: 18654328.3282; train_optim_loss: 18654328.3282; val_kl_reg_loss: 50923.1583; val_edge_recon_loss: 584048.6125; val_gene_expr_recon_loss: 17240226.8667; val_masked_gp_l1_reg_loss: 91517.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53126.9219; val_chrom_access_recon_loss: 766061.8250; val_global_loss: 18785904.2667; val_optim_loss: 18785904.2667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9494; val_auprc_score: 0.9402; val_best_acc_score: 0.8806; val_best_f1_score: 0.8858; train_kl_reg_loss: 51210.1839; train_edge_recon_loss: 584147.4198; train_gene_expr_recon_loss: 17089815.3893; train_masked_gp_l1_reg_loss: 91513.8975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53120.3039; train_chrom_access_recon_loss: 762686.7896; train_global_loss: 18632493.9542; train_optim_loss: 18632493.9542; val_kl_reg_loss: 50979.2141; val_edge_recon_loss: 585255.4208; val_gene_expr_recon_loss: 17406524.8667; val_masked_gp_l1_reg_loss: 91510.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53114.1602; val_chrom_access_recon_loss: 772276.4750; val_global_loss: 18959659.8667; val_optim_loss: 18959659.8667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9419; val_auprc_score: 0.9264; val_best_acc_score: 0.8759; val_best_f1_score: 0.8813; train_kl_reg_loss: 51265.5551; train_edge_recon_loss: 583130.8573; train_gene_expr_recon_loss: 17099893.2214; train_masked_gp_l1_reg_loss: 91507.5097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53109.0710; train_chrom_access_recon_loss: 762889.4189; train_global_loss: 18641795.8779; train_optim_loss: 18641795.8779; val_kl_reg_loss: 50824.8724; val_edge_recon_loss: 587644.5958; val_gene_expr_recon_loss: 17387103.5333; val_masked_gp_l1_reg_loss: 91505.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53103.9062; val_chrom_access_recon_loss: 771360.9333; val_global_loss: 18941544.2667; val_optim_loss: 18941544.2667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9406; val_auprc_score: 0.9296; val_best_acc_score: 0.8729; val_best_f1_score: 0.8805; train_kl_reg_loss: 51251.7323; train_edge_recon_loss: 583221.2953; train_gene_expr_recon_loss: 17093729.1450; train_masked_gp_l1_reg_loss: 91503.5257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53098.9500; train_chrom_access_recon_loss: 762513.2261; train_global_loss: 18635318.0611; train_optim_loss: 18635318.0611; val_kl_reg_loss: 50569.1305; val_edge_recon_loss: 588178.1458; val_gene_expr_recon_loss: 17365797.0000; val_masked_gp_l1_reg_loss: 91501.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53093.9727; val_chrom_access_recon_loss: 773778.1375; val_global_loss: 18922918.4000; val_optim_loss: 18922918.4000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9445; val_auprc_score: 0.9324; val_best_acc_score: 0.8775; val_best_f1_score: 0.8840; train_kl_reg_loss: 51271.8633; train_edge_recon_loss: 584483.6899; train_gene_expr_recon_loss: 17102395.1756; train_masked_gp_l1_reg_loss: 91500.1509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53089.6798; train_chrom_access_recon_loss: 763050.0821; train_global_loss: 18645790.5191; train_optim_loss: 18645790.5191; val_kl_reg_loss: 50928.3964; val_edge_recon_loss: 586251.0167; val_gene_expr_recon_loss: 17301040.4667; val_masked_gp_l1_reg_loss: 91498.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53085.2031; val_chrom_access_recon_loss: 768716.5667; val_global_loss: 18851520.4000; val_optim_loss: 18851520.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9431; val_auprc_score: 0.9310; val_best_acc_score: 0.8736; val_best_f1_score: 0.8813; train_kl_reg_loss: 51270.1283; train_edge_recon_loss: 585063.9284; train_gene_expr_recon_loss: 17098014.5954; train_masked_gp_l1_reg_loss: 91494.8757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53070.2486; train_chrom_access_recon_loss: 762367.1279; train_global_loss: 18641280.6412; train_optim_loss: 18641280.6412; val_kl_reg_loss: 50933.5844; val_edge_recon_loss: 587803.7042; val_gene_expr_recon_loss: 17337883.8667; val_masked_gp_l1_reg_loss: 91493.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53068.3047; val_chrom_access_recon_loss: 772619.7583; val_global_loss: 18893803.0667; val_optim_loss: 18893803.0667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9450; val_auprc_score: 0.9332; val_best_acc_score: 0.8787; val_best_f1_score: 0.8840; train_kl_reg_loss: 51249.0705; train_edge_recon_loss: 581436.5115; train_gene_expr_recon_loss: 17095662.2748; train_masked_gp_l1_reg_loss: 91493.3252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53067.6264; train_chrom_access_recon_loss: 763180.4179; train_global_loss: 18636090.1985; train_optim_loss: 18636090.1985; val_kl_reg_loss: 50628.1695; val_edge_recon_loss: 583454.3458; val_gene_expr_recon_loss: 17394954.2000; val_masked_gp_l1_reg_loss: 91492.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53066.9844; val_chrom_access_recon_loss: 774248.5000; val_global_loss: 18947843.3333; val_optim_loss: 18947843.3333
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9451; val_auprc_score: 0.9317; val_best_acc_score: 0.8808; val_best_f1_score: 0.8867; train_kl_reg_loss: 51233.5476; train_edge_recon_loss: 584574.3884; train_gene_expr_recon_loss: 17103373.7405; train_masked_gp_l1_reg_loss: 91492.6054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53066.3917; train_chrom_access_recon_loss: 762889.4499; train_global_loss: 18646629.2977; train_optim_loss: 18646629.2977; val_kl_reg_loss: 50809.3042; val_edge_recon_loss: 584697.3458; val_gene_expr_recon_loss: 17382021.7333; val_masked_gp_l1_reg_loss: 91492.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53065.8086; val_chrom_access_recon_loss: 773205.8125; val_global_loss: 18935292.2667; val_optim_loss: 18935292.2667
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9435; val_auprc_score: 0.9319; val_best_acc_score: 0.8782; val_best_f1_score: 0.8851; train_kl_reg_loss: 51212.5726; train_edge_recon_loss: 584974.8879; train_gene_expr_recon_loss: 17095454.4275; train_masked_gp_l1_reg_loss: 91492.1481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53065.2825; train_chrom_access_recon_loss: 762180.2281; train_global_loss: 18638379.5802; train_optim_loss: 18638379.5802; val_kl_reg_loss: 50826.0083; val_edge_recon_loss: 585575.0417; val_gene_expr_recon_loss: 17300894.9333; val_masked_gp_l1_reg_loss: 91491.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53064.7969; val_chrom_access_recon_loss: 765983.0750; val_global_loss: 18847835.2000; val_optim_loss: 18847835.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 55 min 10 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9420
val AUPRC score: 0.9297
val best accuracy score: 0.8720
val best F1 score: 0.8796
val target rna MSE score: 1.5970
val source rna MSE score: 0.6173
val target atac MSE score: 0.5053
val source atac MSE score: 0.1602
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
