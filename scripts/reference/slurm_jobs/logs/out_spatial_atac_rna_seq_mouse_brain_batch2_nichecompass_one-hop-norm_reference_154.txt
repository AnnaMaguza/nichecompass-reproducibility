[True]
Run timestamp: 26072023_040748_154.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_154']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9233; val_auprc_score: 0.9325; val_best_acc_score: 0.5044; val_best_f1_score: 0.6686; train_kl_reg_loss: 6606.2118; train_edge_recon_loss: 34722016.4444; train_gene_expr_recon_loss: 31741916.2222; train_masked_gp_l1_reg_loss: 1917.7253; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10821191.1111; train_global_loss: 77293645.3333; train_optim_loss: 77293645.3333; val_kl_reg_loss: 40478.8828; val_edge_recon_loss: 40645712.0000; val_gene_expr_recon_loss: 30040224.0000; val_masked_gp_l1_reg_loss: 1975.3713; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10730228.0000; val_global_loss: 81458624.0000; val_optim_loss: 81458624.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9070; val_auprc_score: 0.9160; val_best_acc_score: 0.5071; val_best_f1_score: 0.6699; train_kl_reg_loss: 58478.0208; train_edge_recon_loss: 34797897.7778; train_gene_expr_recon_loss: 29469513.3333; train_masked_gp_l1_reg_loss: 2079.5293; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10764059.0000; train_global_loss: 75092025.7778; train_optim_loss: 75092025.7778; val_kl_reg_loss: 107685.9375; val_edge_recon_loss: 40649332.0000; val_gene_expr_recon_loss: 27780314.0000; val_masked_gp_l1_reg_loss: 2235.9255; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10574246.0000; val_global_loss: 79113808.0000; val_optim_loss: 79113808.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9072; val_auprc_score: 0.9173; val_best_acc_score: 0.5038; val_best_f1_score: 0.6683; train_kl_reg_loss: 124120.9818; train_edge_recon_loss: 34817846.6667; train_gene_expr_recon_loss: 27381809.7778; train_masked_gp_l1_reg_loss: 2385.3437; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10520959.0000; train_global_loss: 72847121.7778; train_optim_loss: 72847121.7778; val_kl_reg_loss: 278802.3125; val_edge_recon_loss: 40654280.0000; val_gene_expr_recon_loss: 25787864.0000; val_masked_gp_l1_reg_loss: 2572.5410; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10376405.0000; val_global_loss: 77099928.0000; val_optim_loss: 77099928.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8999; val_auprc_score: 0.9100; val_best_acc_score: 0.5055; val_best_f1_score: 0.6691; train_kl_reg_loss: 257040.4983; train_edge_recon_loss: 34814006.2222; train_gene_expr_recon_loss: 25422536.2222; train_masked_gp_l1_reg_loss: 2695.3737; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10279635.4444; train_global_loss: 70775914.6667; train_optim_loss: 70775914.6667; val_kl_reg_loss: 187960.8438; val_edge_recon_loss: 40654260.0000; val_gene_expr_recon_loss: 24184060.0000; val_masked_gp_l1_reg_loss: 2823.4624; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10191137.0000; val_global_loss: 75220240.0000; val_optim_loss: 75220240.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8832; val_auprc_score: 0.8857; val_best_acc_score: 0.5109; val_best_f1_score: 0.6716; train_kl_reg_loss: 298885.4722; train_edge_recon_loss: 34843727.1111; train_gene_expr_recon_loss: 23982110.6667; train_masked_gp_l1_reg_loss: 2887.7367; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10186116.0000; train_global_loss: 69313725.3333; train_optim_loss: 69313725.3333; val_kl_reg_loss: 197011.7500; val_edge_recon_loss: 40650212.0000; val_gene_expr_recon_loss: 23277706.0000; val_masked_gp_l1_reg_loss: 2950.3384; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10060332.0000; val_global_loss: 74188208.0000; val_optim_loss: 74188208.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8870; val_auprc_score: 0.8919; val_best_acc_score: 0.5159; val_best_f1_score: 0.6738; train_kl_reg_loss: 313937.5486; train_edge_recon_loss: 34838035.5556; train_gene_expr_recon_loss: 23153955.7778; train_masked_gp_l1_reg_loss: 2984.2966; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10047305.1111; train_global_loss: 68356220.4444; train_optim_loss: 68356220.4444; val_kl_reg_loss: 218782.0312; val_edge_recon_loss: 40647540.0000; val_gene_expr_recon_loss: 22658878.0000; val_masked_gp_l1_reg_loss: 3020.4529; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9994806.0000; val_global_loss: 73523024.0000; val_optim_loss: 73523024.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8848; val_auprc_score: 0.8901; val_best_acc_score: 0.5164; val_best_f1_score: 0.6741; train_kl_reg_loss: 335109.6441; train_edge_recon_loss: 34845250.2222; train_gene_expr_recon_loss: 22735203.1111; train_masked_gp_l1_reg_loss: 3042.4871; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9968857.2222; train_global_loss: 67887463.1111; train_optim_loss: 67887463.1111; val_kl_reg_loss: 271201.8438; val_edge_recon_loss: 40644912.0000; val_gene_expr_recon_loss: 22149856.0000; val_masked_gp_l1_reg_loss: 3065.6982; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9933338.0000; val_global_loss: 73002368.0000; val_optim_loss: 73002368.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8768; val_auprc_score: 0.8806; val_best_acc_score: 0.5194; val_best_f1_score: 0.6752; train_kl_reg_loss: 359885.3194; train_edge_recon_loss: 34842341.7778; train_gene_expr_recon_loss: 22140820.8889; train_masked_gp_l1_reg_loss: 3078.3989; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9886520.7778; train_global_loss: 67232646.6667; train_optim_loss: 67232646.6667; val_kl_reg_loss: 345512.2812; val_edge_recon_loss: 40641084.0000; val_gene_expr_recon_loss: 21729722.0000; val_masked_gp_l1_reg_loss: 3091.5874; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9874258.0000; val_global_loss: 72593672.0000; val_optim_loss: 72593672.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8784; val_auprc_score: 0.8801; val_best_acc_score: 0.5344; val_best_f1_score: 0.6814; train_kl_reg_loss: 377532.5938; train_edge_recon_loss: 34859400.0000; train_gene_expr_recon_loss: 21802302.6667; train_masked_gp_l1_reg_loss: 3099.6130; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9887142.8889; train_global_loss: 66929478.2222; train_optim_loss: 66929478.2222; val_kl_reg_loss: 296437.3125; val_edge_recon_loss: 40628640.0000; val_gene_expr_recon_loss: 21470148.0000; val_masked_gp_l1_reg_loss: 3108.1860; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9839522.0000; val_global_loss: 72237856.0000; val_optim_loss: 72237856.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8778; val_auprc_score: 0.8779; val_best_acc_score: 0.5582; val_best_f1_score: 0.6917; train_kl_reg_loss: 368336.0139; train_edge_recon_loss: 34849583.5556; train_gene_expr_recon_loss: 21459019.7778; train_masked_gp_l1_reg_loss: 3115.5515; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9816272.3333; train_global_loss: 66496324.8889; train_optim_loss: 66496324.8889; val_kl_reg_loss: 295089.3438; val_edge_recon_loss: 40614016.0000; val_gene_expr_recon_loss: 21285210.0000; val_masked_gp_l1_reg_loss: 3124.9160; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9822314.0000; val_global_loss: 72019752.0000; val_optim_loss: 72019752.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8837; val_auprc_score: 0.8849; val_best_acc_score: 0.5998; val_best_f1_score: 0.7116; train_kl_reg_loss: 359416.0000; train_edge_recon_loss: 34859233.3333; train_gene_expr_recon_loss: 21354788.8889; train_masked_gp_l1_reg_loss: 3133.5665; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9771751.4444; train_global_loss: 66348321.7778; train_optim_loss: 66348321.7778; val_kl_reg_loss: 283190.1250; val_edge_recon_loss: 40591584.0000; val_gene_expr_recon_loss: 21179296.0000; val_masked_gp_l1_reg_loss: 3143.9868; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9783547.0000; val_global_loss: 71840760.0000; val_optim_loss: 71840760.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8900; val_auprc_score: 0.8860; val_best_acc_score: 0.6583; val_best_f1_score: 0.7419; train_kl_reg_loss: 344601.9722; train_edge_recon_loss: 34864579.5556; train_gene_expr_recon_loss: 21205988.8889; train_masked_gp_l1_reg_loss: 3154.4655; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9755120.7778; train_global_loss: 66173445.7778; train_optim_loss: 66173445.7778; val_kl_reg_loss: 315062.0938; val_edge_recon_loss: 40559440.0000; val_gene_expr_recon_loss: 21093458.0000; val_masked_gp_l1_reg_loss: 3167.0210; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9784726.0000; val_global_loss: 71755856.0000; val_optim_loss: 71755856.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8914; val_auprc_score: 0.8842; val_best_acc_score: 0.7165; val_best_f1_score: 0.7738; train_kl_reg_loss: 331017.9201; train_edge_recon_loss: 34836348.8889; train_gene_expr_recon_loss: 21199214.8889; train_masked_gp_l1_reg_loss: 3177.6074; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9762973.6667; train_global_loss: 66132732.4444; train_optim_loss: 66132732.4444; val_kl_reg_loss: 256986.4375; val_edge_recon_loss: 40508156.0000; val_gene_expr_recon_loss: 21024272.0000; val_masked_gp_l1_reg_loss: 3189.7803; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9762005.0000; val_global_loss: 71554608.0000; val_optim_loss: 71554608.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9002; val_auprc_score: 0.8920; val_best_acc_score: 0.7695; val_best_f1_score: 0.8049; train_kl_reg_loss: 325288.8785; train_edge_recon_loss: 34855030.6667; train_gene_expr_recon_loss: 21177001.7778; train_masked_gp_l1_reg_loss: 3198.6709; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9759869.4444; train_global_loss: 66120389.3333; train_optim_loss: 66120389.3333; val_kl_reg_loss: 227803.8750; val_edge_recon_loss: 40425588.0000; val_gene_expr_recon_loss: 20995204.0000; val_masked_gp_l1_reg_loss: 3209.2129; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9762086.0000; val_global_loss: 71413888.0000; val_optim_loss: 71413888.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8982; val_auprc_score: 0.8861; val_best_acc_score: 0.8073; val_best_f1_score: 0.8263; train_kl_reg_loss: 320537.6667; train_edge_recon_loss: 34840111.5556; train_gene_expr_recon_loss: 21127863.1111; train_masked_gp_l1_reg_loss: 3219.4819; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9746406.2222; train_global_loss: 66038136.8889; train_optim_loss: 66038136.8889; val_kl_reg_loss: 224589.4688; val_edge_recon_loss: 40287480.0000; val_gene_expr_recon_loss: 20918322.0000; val_masked_gp_l1_reg_loss: 3231.9961; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9734833.0000; val_global_loss: 71168456.0000; val_optim_loss: 71168456.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9085; val_auprc_score: 0.8964; val_best_acc_score: 0.8358; val_best_f1_score: 0.8411; train_kl_reg_loss: 287300.4375; train_edge_recon_loss: 34825529.7778; train_gene_expr_recon_loss: 21008056.6667; train_masked_gp_l1_reg_loss: 3240.9810; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9705052.7778; train_global_loss: 65829180.8889; train_optim_loss: 65829180.8889; val_kl_reg_loss: 259383.9531; val_edge_recon_loss: 40083280.0000; val_gene_expr_recon_loss: 20866526.0000; val_masked_gp_l1_reg_loss: 3251.4634; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9746148.0000; val_global_loss: 70958592.0000; val_optim_loss: 70958592.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9132; val_auprc_score: 0.9013; val_best_acc_score: 0.8296; val_best_f1_score: 0.8213; train_kl_reg_loss: 287614.8125; train_edge_recon_loss: 34757149.3333; train_gene_expr_recon_loss: 20979868.2222; train_masked_gp_l1_reg_loss: 3260.0896; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9743765.6667; train_global_loss: 65771657.7778; train_optim_loss: 65771657.7778; val_kl_reg_loss: 221598.6719; val_edge_recon_loss: 39658704.0000; val_gene_expr_recon_loss: 20816222.0000; val_masked_gp_l1_reg_loss: 3271.3418; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9718112.0000; val_global_loss: 70417912.0000; val_optim_loss: 70417912.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9173; val_auprc_score: 0.9004; val_best_acc_score: 0.8258; val_best_f1_score: 0.8455; train_kl_reg_loss: 265813.3038; train_edge_recon_loss: 34673424.4444; train_gene_expr_recon_loss: 20931597.1111; train_masked_gp_l1_reg_loss: 3281.6820; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9680206.1111; train_global_loss: 65554322.6667; train_optim_loss: 65554322.6667; val_kl_reg_loss: 199329.8594; val_edge_recon_loss: 38774660.0000; val_gene_expr_recon_loss: 20833228.0000; val_masked_gp_l1_reg_loss: 3293.6821; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9721099.0000; val_global_loss: 69531608.0000; val_optim_loss: 69531608.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9205; val_auprc_score: 0.9025; val_best_acc_score: 0.8498; val_best_f1_score: 0.8553; train_kl_reg_loss: 220901.1910; train_edge_recon_loss: 34445691.5556; train_gene_expr_recon_loss: 20896714.8889; train_masked_gp_l1_reg_loss: 3305.0735; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9727165.1111; train_global_loss: 65293778.6667; train_optim_loss: 65293778.6667; val_kl_reg_loss: 163660.7500; val_edge_recon_loss: 36888152.0000; val_gene_expr_recon_loss: 20894520.0000; val_masked_gp_l1_reg_loss: 3318.6277; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9740373.0000; val_global_loss: 67690024.0000; val_optim_loss: 67690024.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9151; val_auprc_score: 0.8985; val_best_acc_score: 0.8411; val_best_f1_score: 0.8476; train_kl_reg_loss: 128102.3915; train_edge_recon_loss: 33481730.6667; train_gene_expr_recon_loss: 21184144.6667; train_masked_gp_l1_reg_loss: 3334.2381; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9749338.3333; train_global_loss: 64546650.2222; train_optim_loss: 64546650.2222; val_kl_reg_loss: 69961.8281; val_edge_recon_loss: 32116676.0000; val_gene_expr_recon_loss: 21325254.0000; val_masked_gp_l1_reg_loss: 3358.2385; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9811589.0000; val_global_loss: 63326840.0000; val_optim_loss: 63326840.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8827; val_auprc_score: 0.8562; val_best_acc_score: 0.8027; val_best_f1_score: 0.8157; train_kl_reg_loss: 77508.1988; train_edge_recon_loss: 30631421.5556; train_gene_expr_recon_loss: 21640849.1111; train_masked_gp_l1_reg_loss: 3395.4552; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9838592.5556; train_global_loss: 62191766.6667; train_optim_loss: 62191766.6667; val_kl_reg_loss: 110133.2188; val_edge_recon_loss: 29619854.0000; val_gene_expr_recon_loss: 21507284.0000; val_masked_gp_l1_reg_loss: 3452.3484; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9838846.0000; val_global_loss: 61079568.0000; val_optim_loss: 61079568.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8834; val_auprc_score: 0.8524; val_best_acc_score: 0.8079; val_best_f1_score: 0.8222; train_kl_reg_loss: 158697.2118; train_edge_recon_loss: 29173839.5556; train_gene_expr_recon_loss: 21482752.0000; train_masked_gp_l1_reg_loss: 3504.0967; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9765754.1111; train_global_loss: 60584546.2222; train_optim_loss: 60584546.2222; val_kl_reg_loss: 195240.6250; val_edge_recon_loss: 29125596.0000; val_gene_expr_recon_loss: 21199744.0000; val_masked_gp_l1_reg_loss: 3562.3315; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9899465.0000; val_global_loss: 60423608.0000; val_optim_loss: 60423608.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8890; val_auprc_score: 0.8599; val_best_acc_score: 0.8158; val_best_f1_score: 0.8323; train_kl_reg_loss: 213558.8194; train_edge_recon_loss: 28806408.6667; train_gene_expr_recon_loss: 21279537.3333; train_masked_gp_l1_reg_loss: 3599.6335; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9793939.0000; train_global_loss: 60097042.2222; train_optim_loss: 60097042.2222; val_kl_reg_loss: 205687.0469; val_edge_recon_loss: 29023286.0000; val_gene_expr_recon_loss: 20994232.0000; val_masked_gp_l1_reg_loss: 3638.7573; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9777174.0000; val_global_loss: 60004024.0000; val_optim_loss: 60004024.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8954; val_auprc_score: 0.8685; val_best_acc_score: 0.8197; val_best_f1_score: 0.8298; train_kl_reg_loss: 223305.1354; train_edge_recon_loss: 29089300.4444; train_gene_expr_recon_loss: 21206880.4444; train_masked_gp_l1_reg_loss: 3662.1663; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9807224.1111; train_global_loss: 60330372.4444; train_optim_loss: 60330372.4444; val_kl_reg_loss: 237305.5312; val_edge_recon_loss: 28890964.0000; val_gene_expr_recon_loss: 20955738.0000; val_masked_gp_l1_reg_loss: 3688.6885; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9755400.0000; val_global_loss: 59843096.0000; val_optim_loss: 59843096.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8906; val_auprc_score: 0.8619; val_best_acc_score: 0.8180; val_best_f1_score: 0.8338; train_kl_reg_loss: 264002.1545; train_edge_recon_loss: 28587259.5556; train_gene_expr_recon_loss: 21009120.0000; train_masked_gp_l1_reg_loss: 3707.5166; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9722615.6667; train_global_loss: 59586703.1111; train_optim_loss: 59586703.1111; val_kl_reg_loss: 266630.6562; val_edge_recon_loss: 28422626.0000; val_gene_expr_recon_loss: 20925274.0000; val_masked_gp_l1_reg_loss: 3727.9692; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9739752.0000; val_global_loss: 59358008.0000; val_optim_loss: 59358008.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8976; val_auprc_score: 0.8631; val_best_acc_score: 0.8275; val_best_f1_score: 0.8410; train_kl_reg_loss: 291739.4201; train_edge_recon_loss: 28671087.7778; train_gene_expr_recon_loss: 21023082.4444; train_masked_gp_l1_reg_loss: 3746.9338; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9738739.0000; train_global_loss: 59728395.1111; train_optim_loss: 59728395.1111; val_kl_reg_loss: 174681.2500; val_edge_recon_loss: 28346398.0000; val_gene_expr_recon_loss: 20932922.0000; val_masked_gp_l1_reg_loss: 3771.8164; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9733469.0000; val_global_loss: 59191240.0000; val_optim_loss: 59191240.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8959; val_auprc_score: 0.8655; val_best_acc_score: 0.8275; val_best_f1_score: 0.8405; train_kl_reg_loss: 336203.2153; train_edge_recon_loss: 28430074.6667; train_gene_expr_recon_loss: 20916103.3333; train_masked_gp_l1_reg_loss: 3792.0515; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9702204.4444; train_global_loss: 59388378.2222; train_optim_loss: 59388378.2222; val_kl_reg_loss: 193153.2500; val_edge_recon_loss: 28502164.0000; val_gene_expr_recon_loss: 20895840.0000; val_masked_gp_l1_reg_loss: 3814.5947; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9724577.0000; val_global_loss: 59319552.0000; val_optim_loss: 59319552.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8997; val_auprc_score: 0.8733; val_best_acc_score: 0.8261; val_best_f1_score: 0.8394; train_kl_reg_loss: 363786.2500; train_edge_recon_loss: 28308505.1111; train_gene_expr_recon_loss: 21009459.5556; train_masked_gp_l1_reg_loss: 3832.0056; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9735288.5556; train_global_loss: 59420871.5556; train_optim_loss: 59420871.5556; val_kl_reg_loss: 207230.6719; val_edge_recon_loss: 28493166.0000; val_gene_expr_recon_loss: 20820986.0000; val_masked_gp_l1_reg_loss: 3852.8381; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9702390.0000; val_global_loss: 59227624.0000; val_optim_loss: 59227624.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9094; val_auprc_score: 0.8845; val_best_acc_score: 0.8395; val_best_f1_score: 0.8509; train_kl_reg_loss: 378404.2674; train_edge_recon_loss: 28118375.1111; train_gene_expr_recon_loss: 20880040.0000; train_masked_gp_l1_reg_loss: 3869.8360; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9660536.0000; train_global_loss: 59041224.4444; train_optim_loss: 59041224.4444; val_kl_reg_loss: 211997.6406; val_edge_recon_loss: 27939788.0000; val_gene_expr_recon_loss: 20786958.0000; val_masked_gp_l1_reg_loss: 3890.0051; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9693072.0000; val_global_loss: 58635708.0000; val_optim_loss: 58635708.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9111; val_auprc_score: 0.8863; val_best_acc_score: 0.8401; val_best_f1_score: 0.8514; train_kl_reg_loss: 379860.7396; train_edge_recon_loss: 27968748.6667; train_gene_expr_recon_loss: 20981812.8889; train_masked_gp_l1_reg_loss: 3905.0597; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9694720.7778; train_global_loss: 59029048.4444; train_optim_loss: 59029048.4444; val_kl_reg_loss: 211551.3438; val_edge_recon_loss: 27920410.0000; val_gene_expr_recon_loss: 20758468.0000; val_masked_gp_l1_reg_loss: 3924.4487; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9681141.0000; val_global_loss: 58575496.0000; val_optim_loss: 58575496.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9204; val_auprc_score: 0.9006; val_best_acc_score: 0.8456; val_best_f1_score: 0.8559; train_kl_reg_loss: 376577.0278; train_edge_recon_loss: 27922116.6667; train_gene_expr_recon_loss: 20905428.8889; train_masked_gp_l1_reg_loss: 3940.8151; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9662813.5556; train_global_loss: 58870876.4444; train_optim_loss: 58870876.4444; val_kl_reg_loss: 217135.9688; val_edge_recon_loss: 28033420.0000; val_gene_expr_recon_loss: 20730600.0000; val_masked_gp_l1_reg_loss: 3959.5288; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9671857.0000; val_global_loss: 58656972.0000; val_optim_loss: 58656972.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9223; val_auprc_score: 0.8985; val_best_acc_score: 0.8572; val_best_f1_score: 0.8633; train_kl_reg_loss: 378018.8229; train_edge_recon_loss: 27736100.2222; train_gene_expr_recon_loss: 20791258.8889; train_masked_gp_l1_reg_loss: 3973.9746; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9682568.7778; train_global_loss: 58591920.8889; train_optim_loss: 58591920.8889; val_kl_reg_loss: 214901.9062; val_edge_recon_loss: 27901554.0000; val_gene_expr_recon_loss: 20731940.0000; val_masked_gp_l1_reg_loss: 3991.4905; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9684603.0000; val_global_loss: 58536992.0000; val_optim_loss: 58536992.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9309; val_auprc_score: 0.9097; val_best_acc_score: 0.8684; val_best_f1_score: 0.8768; train_kl_reg_loss: 385496.9757; train_edge_recon_loss: 27786514.2222; train_gene_expr_recon_loss: 20738788.6667; train_masked_gp_l1_reg_loss: 4006.2339; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9693056.6667; train_global_loss: 58607863.5556; train_optim_loss: 58607863.5556; val_kl_reg_loss: 215316.8750; val_edge_recon_loss: 27333272.0000; val_gene_expr_recon_loss: 20721730.0000; val_masked_gp_l1_reg_loss: 4023.5168; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9678747.0000; val_global_loss: 57953092.0000; val_optim_loss: 57953092.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9306; val_auprc_score: 0.9073; val_best_acc_score: 0.8692; val_best_f1_score: 0.8779; train_kl_reg_loss: 383094.8542; train_edge_recon_loss: 27583015.3333; train_gene_expr_recon_loss: 20720229.7778; train_masked_gp_l1_reg_loss: 4038.6480; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9658266.4444; train_global_loss: 58348644.8889; train_optim_loss: 58348644.8889; val_kl_reg_loss: 226260.5000; val_edge_recon_loss: 27494786.0000; val_gene_expr_recon_loss: 20667878.0000; val_masked_gp_l1_reg_loss: 4056.3281; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9657577.0000; val_global_loss: 58050556.0000; val_optim_loss: 58050556.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9332; val_auprc_score: 0.9142; val_best_acc_score: 0.8725; val_best_f1_score: 0.8813; train_kl_reg_loss: 386539.8299; train_edge_recon_loss: 27410104.4444; train_gene_expr_recon_loss: 20717403.5556; train_masked_gp_l1_reg_loss: 4070.3381; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9622505.7778; train_global_loss: 58140624.4444; train_optim_loss: 58140624.4444; val_kl_reg_loss: 237513.0312; val_edge_recon_loss: 27399228.0000; val_gene_expr_recon_loss: 20620530.0000; val_masked_gp_l1_reg_loss: 4086.8835; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9641797.0000; val_global_loss: 57903156.0000; val_optim_loss: 57903156.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9341; val_auprc_score: 0.9100; val_best_acc_score: 0.8750; val_best_f1_score: 0.8831; train_kl_reg_loss: 391148.2326; train_edge_recon_loss: 27433600.2222; train_gene_expr_recon_loss: 20619432.6667; train_masked_gp_l1_reg_loss: 4100.5243; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9624346.8889; train_global_loss: 58072628.8889; train_optim_loss: 58072628.8889; val_kl_reg_loss: 242536.1250; val_edge_recon_loss: 27581492.0000; val_gene_expr_recon_loss: 20622276.0000; val_masked_gp_l1_reg_loss: 4116.1597; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9636015.0000; val_global_loss: 58086436.0000; val_optim_loss: 58086436.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9352; val_auprc_score: 0.9110; val_best_acc_score: 0.8781; val_best_f1_score: 0.8869; train_kl_reg_loss: 396098.9097; train_edge_recon_loss: 27360277.5556; train_gene_expr_recon_loss: 20742162.4444; train_masked_gp_l1_reg_loss: 4128.9678; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9675527.6667; train_global_loss: 58178196.8889; train_optim_loss: 58178196.8889; val_kl_reg_loss: 242652.1875; val_edge_recon_loss: 27440816.0000; val_gene_expr_recon_loss: 20573268.0000; val_masked_gp_l1_reg_loss: 4144.1597; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9628427.0000; val_global_loss: 57889308.0000; val_optim_loss: 57889308.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9363; val_auprc_score: 0.9149; val_best_acc_score: 0.8783; val_best_f1_score: 0.8863; train_kl_reg_loss: 383828.4097; train_edge_recon_loss: 27306362.0000; train_gene_expr_recon_loss: 20637472.6667; train_masked_gp_l1_reg_loss: 4157.1867; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9579015.3333; train_global_loss: 57910836.4444; train_optim_loss: 57910836.4444; val_kl_reg_loss: 238632.5938; val_edge_recon_loss: 27386870.0000; val_gene_expr_recon_loss: 20563454.0000; val_masked_gp_l1_reg_loss: 4172.4028; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9615188.0000; val_global_loss: 57808316.0000; val_optim_loss: 57808316.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9399; val_auprc_score: 0.9210; val_best_acc_score: 0.8810; val_best_f1_score: 0.8875; train_kl_reg_loss: 382016.1354; train_edge_recon_loss: 27357482.6667; train_gene_expr_recon_loss: 20522024.4444; train_masked_gp_l1_reg_loss: 4184.6850; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9590994.8889; train_global_loss: 57856702.2222; train_optim_loss: 57856702.2222; val_kl_reg_loss: 235831.2500; val_edge_recon_loss: 27422768.0000; val_gene_expr_recon_loss: 20530768.0000; val_masked_gp_l1_reg_loss: 4199.5557; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9607437.0000; val_global_loss: 57801004.0000; val_optim_loss: 57801004.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9404; val_auprc_score: 0.9215; val_best_acc_score: 0.8806; val_best_f1_score: 0.8888; train_kl_reg_loss: 379210.0590; train_edge_recon_loss: 27333502.4444; train_gene_expr_recon_loss: 20554139.5556; train_masked_gp_l1_reg_loss: 4210.7950; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9591361.5556; train_global_loss: 57862423.5556; train_optim_loss: 57862423.5556; val_kl_reg_loss: 239812.9688; val_edge_recon_loss: 27513716.0000; val_gene_expr_recon_loss: 20528786.0000; val_masked_gp_l1_reg_loss: 4225.0508; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9599666.0000; val_global_loss: 57886200.0000; val_optim_loss: 57886200.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9466; val_auprc_score: 0.9297; val_best_acc_score: 0.8919; val_best_f1_score: 0.8984; train_kl_reg_loss: 376780.2361; train_edge_recon_loss: 27244310.6667; train_gene_expr_recon_loss: 20630960.4444; train_masked_gp_l1_reg_loss: 4237.3015; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9572776.2222; train_global_loss: 57829064.8889; train_optim_loss: 57829064.8889; val_kl_reg_loss: 233957.1094; val_edge_recon_loss: 27024186.0000; val_gene_expr_recon_loss: 20508750.0000; val_masked_gp_l1_reg_loss: 4251.6816; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9602225.0000; val_global_loss: 57373372.0000; val_optim_loss: 57373372.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9461; val_auprc_score: 0.9217; val_best_acc_score: 0.8913; val_best_f1_score: 0.8980; train_kl_reg_loss: 371223.7500; train_edge_recon_loss: 27333365.7778; train_gene_expr_recon_loss: 20589939.3333; train_masked_gp_l1_reg_loss: 4263.4323; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9561451.3333; train_global_loss: 57860243.1111; train_optim_loss: 57860243.1111; val_kl_reg_loss: 239495.8125; val_edge_recon_loss: 27162910.0000; val_gene_expr_recon_loss: 20468230.0000; val_masked_gp_l1_reg_loss: 4277.8486; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9589291.0000; val_global_loss: 57464204.0000; val_optim_loss: 57464204.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9457; val_auprc_score: 0.9264; val_best_acc_score: 0.8926; val_best_f1_score: 0.8983; train_kl_reg_loss: 370241.4028; train_edge_recon_loss: 27242601.7778; train_gene_expr_recon_loss: 20526236.4444; train_masked_gp_l1_reg_loss: 4289.8940; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9561937.0000; train_global_loss: 57705306.2222; train_optim_loss: 57705306.2222; val_kl_reg_loss: 241395.8125; val_edge_recon_loss: 27191562.0000; val_gene_expr_recon_loss: 20475566.0000; val_masked_gp_l1_reg_loss: 4303.6113; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9584992.0000; val_global_loss: 57497820.0000; val_optim_loss: 57497820.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9470; val_auprc_score: 0.9324; val_best_acc_score: 0.8867; val_best_f1_score: 0.8936; train_kl_reg_loss: 364914.0972; train_edge_recon_loss: 27252420.2222; train_gene_expr_recon_loss: 20412207.5556; train_masked_gp_l1_reg_loss: 4314.7353; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9527702.1111; train_global_loss: 57561558.2222; train_optim_loss: 57561558.2222; val_kl_reg_loss: 237659.7188; val_edge_recon_loss: 27308794.0000; val_gene_expr_recon_loss: 20420690.0000; val_masked_gp_l1_reg_loss: 4328.1099; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9559274.0000; val_global_loss: 57530744.0000; val_optim_loss: 57530744.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9487; val_auprc_score: 0.9357; val_best_acc_score: 0.8870; val_best_f1_score: 0.8922; train_kl_reg_loss: 356072.5903; train_edge_recon_loss: 27352286.6667; train_gene_expr_recon_loss: 20558538.8889; train_masked_gp_l1_reg_loss: 4339.4333; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9538425.0000; train_global_loss: 57809663.1111; train_optim_loss: 57809663.1111; val_kl_reg_loss: 233281.2812; val_edge_recon_loss: 27466980.0000; val_gene_expr_recon_loss: 20406646.0000; val_masked_gp_l1_reg_loss: 4353.1245; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9565911.0000; val_global_loss: 57677172.0000; val_optim_loss: 57677172.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9492; val_auprc_score: 0.9313; val_best_acc_score: 0.8957; val_best_f1_score: 0.9005; train_kl_reg_loss: 350349.5035; train_edge_recon_loss: 27324520.4444; train_gene_expr_recon_loss: 20468423.7778; train_masked_gp_l1_reg_loss: 4354.1153; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9547676.8889; train_global_loss: 57695325.3333; train_optim_loss: 57695325.3333; val_kl_reg_loss: 235239.2812; val_edge_recon_loss: 27158306.0000; val_gene_expr_recon_loss: 20404156.0000; val_masked_gp_l1_reg_loss: 4355.3047; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9569712.0000; val_global_loss: 57371772.0000; val_optim_loss: 57371772.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9474; val_auprc_score: 0.9277; val_best_acc_score: 0.8954; val_best_f1_score: 0.9000; train_kl_reg_loss: 354428.1701; train_edge_recon_loss: 27227995.1111; train_gene_expr_recon_loss: 20468142.4444; train_masked_gp_l1_reg_loss: 4356.1785; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9590405.4444; train_global_loss: 57645326.6667; train_optim_loss: 57645326.6667; val_kl_reg_loss: 235435.2188; val_edge_recon_loss: 27086934.0000; val_gene_expr_recon_loss: 20411436.0000; val_masked_gp_l1_reg_loss: 4357.2778; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9562909.0000; val_global_loss: 57301072.0000; val_optim_loss: 57301072.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9464; val_auprc_score: 0.9289; val_best_acc_score: 0.8911; val_best_f1_score: 0.8971; train_kl_reg_loss: 351186.2778; train_edge_recon_loss: 27176459.7778; train_gene_expr_recon_loss: 20353407.1111; train_masked_gp_l1_reg_loss: 4358.1355; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9534450.8889; train_global_loss: 57419862.2222; train_optim_loss: 57419862.2222; val_kl_reg_loss: 237137.5156; val_edge_recon_loss: 27317232.0000; val_gene_expr_recon_loss: 20394396.0000; val_masked_gp_l1_reg_loss: 4359.3462; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9570292.0000; val_global_loss: 57523420.0000; val_optim_loss: 57523420.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9476; val_auprc_score: 0.9301; val_best_acc_score: 0.8946; val_best_f1_score: 0.9004; train_kl_reg_loss: 351328.3229; train_edge_recon_loss: 27334576.6667; train_gene_expr_recon_loss: 20420498.8889; train_masked_gp_l1_reg_loss: 4360.4288; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9561902.3333; train_global_loss: 57672666.6667; train_optim_loss: 57672666.6667; val_kl_reg_loss: 233213.0156; val_edge_recon_loss: 27205672.0000; val_gene_expr_recon_loss: 20381748.0000; val_masked_gp_l1_reg_loss: 4361.7896; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9552677.0000; val_global_loss: 57377668.0000; val_optim_loss: 57377668.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9467; val_auprc_score: 0.9263; val_best_acc_score: 0.8910; val_best_f1_score: 0.8951; train_kl_reg_loss: 351061.0694; train_edge_recon_loss: 27120390.8889; train_gene_expr_recon_loss: 20450854.2222; train_masked_gp_l1_reg_loss: 4362.8772; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9502999.8889; train_global_loss: 57429669.3333; train_optim_loss: 57429669.3333; val_kl_reg_loss: 232463.0469; val_edge_recon_loss: 27439976.0000; val_gene_expr_recon_loss: 20381542.0000; val_masked_gp_l1_reg_loss: 4364.2686; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9559501.0000; val_global_loss: 57617848.0000; val_optim_loss: 57617848.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9474; val_auprc_score: 0.9245; val_best_acc_score: 0.8923; val_best_f1_score: 0.8985; train_kl_reg_loss: 351649.6215; train_edge_recon_loss: 27174748.0000; train_gene_expr_recon_loss: 20392963.7778; train_masked_gp_l1_reg_loss: 4365.3900; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9499491.3333; train_global_loss: 57423216.4444; train_optim_loss: 57423216.4444; val_kl_reg_loss: 232738.3438; val_edge_recon_loss: 27290916.0000; val_gene_expr_recon_loss: 20370416.0000; val_masked_gp_l1_reg_loss: 4366.7637; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9549772.0000; val_global_loss: 57448212.0000; val_optim_loss: 57448212.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9468; val_auprc_score: 0.9282; val_best_acc_score: 0.8926; val_best_f1_score: 0.8969; train_kl_reg_loss: 349719.2604; train_edge_recon_loss: 27161043.5556; train_gene_expr_recon_loss: 20400163.7778; train_masked_gp_l1_reg_loss: 4366.8679; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9490195.0000; train_global_loss: 57405489.3333; train_optim_loss: 57405489.3333; val_kl_reg_loss: 234082.2500; val_edge_recon_loss: 27563888.0000; val_gene_expr_recon_loss: 20390424.0000; val_masked_gp_l1_reg_loss: 4366.9966; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9561736.0000; val_global_loss: 57754496.0000; val_optim_loss: 57754496.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9492; val_auprc_score: 0.9310; val_best_acc_score: 0.8942; val_best_f1_score: 0.8997; train_kl_reg_loss: 351144.4861; train_edge_recon_loss: 27301319.3333; train_gene_expr_recon_loss: 20419248.6667; train_masked_gp_l1_reg_loss: 4367.0919; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9527588.7778; train_global_loss: 57603669.3333; train_optim_loss: 57603669.3333; val_kl_reg_loss: 233301.5312; val_edge_recon_loss: 27264344.0000; val_gene_expr_recon_loss: 20360406.0000; val_masked_gp_l1_reg_loss: 4367.2163; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9554660.0000; val_global_loss: 57417080.0000; val_optim_loss: 57417080.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9518; val_auprc_score: 0.9358; val_best_acc_score: 0.8980; val_best_f1_score: 0.9029; train_kl_reg_loss: 351243.1771; train_edge_recon_loss: 27299902.8889; train_gene_expr_recon_loss: 20340247.3333; train_masked_gp_l1_reg_loss: 4367.3127; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9513643.2222; train_global_loss: 57509404.4444; train_optim_loss: 57509404.4444; val_kl_reg_loss: 233633.3438; val_edge_recon_loss: 26994798.0000; val_gene_expr_recon_loss: 20376846.0000; val_masked_gp_l1_reg_loss: 4367.4424; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9560646.0000; val_global_loss: 57170296.0000; val_optim_loss: 57170296.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9521; val_auprc_score: 0.9346; val_best_acc_score: 0.9000; val_best_f1_score: 0.9052; train_kl_reg_loss: 354837.0660; train_edge_recon_loss: 27312997.7778; train_gene_expr_recon_loss: 20589033.1111; train_masked_gp_l1_reg_loss: 4367.5517; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9595790.8889; train_global_loss: 57857026.6667; train_optim_loss: 57857026.6667; val_kl_reg_loss: 233044.4688; val_edge_recon_loss: 27139416.0000; val_gene_expr_recon_loss: 20379060.0000; val_masked_gp_l1_reg_loss: 4367.6904; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9549994.0000; val_global_loss: 57305880.0000; val_optim_loss: 57305880.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9477; val_auprc_score: 0.9294; val_best_acc_score: 0.8911; val_best_f1_score: 0.8958; train_kl_reg_loss: 353553.5417; train_edge_recon_loss: 27199978.6667; train_gene_expr_recon_loss: 20503688.0000; train_masked_gp_l1_reg_loss: 4367.7982; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9540312.8889; train_global_loss: 57601900.8889; train_optim_loss: 57601900.8889; val_kl_reg_loss: 234022.2188; val_edge_recon_loss: 27369776.0000; val_gene_expr_recon_loss: 20393656.0000; val_masked_gp_l1_reg_loss: 4367.9307; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9565490.0000; val_global_loss: 57567312.0000; val_optim_loss: 57567312.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9455; val_auprc_score: 0.9266; val_best_acc_score: 0.8923; val_best_f1_score: 0.8982; train_kl_reg_loss: 351498.7465; train_edge_recon_loss: 27289539.1111; train_gene_expr_recon_loss: 20507952.6667; train_masked_gp_l1_reg_loss: 4368.0281; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9544106.4444; train_global_loss: 57697464.8889; train_optim_loss: 57697464.8889; val_kl_reg_loss: 233140.7812; val_edge_recon_loss: 27440712.0000; val_gene_expr_recon_loss: 20373760.0000; val_masked_gp_l1_reg_loss: 4368.1528; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9559000.0000; val_global_loss: 57610980.0000; val_optim_loss: 57610980.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9481; val_auprc_score: 0.9302; val_best_acc_score: 0.8953; val_best_f1_score: 0.9019; train_kl_reg_loss: 351103.8507; train_edge_recon_loss: 27201877.1111; train_gene_expr_recon_loss: 20463826.2222; train_masked_gp_l1_reg_loss: 4368.2553; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9530488.3333; train_global_loss: 57551664.0000; train_optim_loss: 57551664.0000; val_kl_reg_loss: 232335.7500; val_edge_recon_loss: 27116648.0000; val_gene_expr_recon_loss: 20374782.0000; val_masked_gp_l1_reg_loss: 4368.3857; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9548596.0000; val_global_loss: 57276732.0000; val_optim_loss: 57276732.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9496; val_auprc_score: 0.9320; val_best_acc_score: 0.8930; val_best_f1_score: 0.8991; train_kl_reg_loss: 351659.9167; train_edge_recon_loss: 27100321.5556; train_gene_expr_recon_loss: 20471709.5556; train_masked_gp_l1_reg_loss: 4368.3962; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9557098.6667; train_global_loss: 57485158.6667; train_optim_loss: 57485158.6667; val_kl_reg_loss: 233030.0781; val_edge_recon_loss: 27359536.0000; val_gene_expr_recon_loss: 20341916.0000; val_masked_gp_l1_reg_loss: 4368.4092; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9540594.0000; val_global_loss: 57479440.0000; val_optim_loss: 57479440.0000
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9510; val_auprc_score: 0.9340; val_best_acc_score: 0.8975; val_best_f1_score: 0.9033; train_kl_reg_loss: 352268.0312; train_edge_recon_loss: 27210934.8889; train_gene_expr_recon_loss: 20402476.0000; train_masked_gp_l1_reg_loss: 4368.4201; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9553120.4444; train_global_loss: 57523168.8889; train_optim_loss: 57523168.8889; val_kl_reg_loss: 234118.2031; val_edge_recon_loss: 27062834.0000; val_gene_expr_recon_loss: 20387250.0000; val_masked_gp_l1_reg_loss: 4368.4336; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9559906.0000; val_global_loss: 57248472.0000; val_optim_loss: 57248472.0000
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9479; val_auprc_score: 0.9285; val_best_acc_score: 0.8932; val_best_f1_score: 0.8991; train_kl_reg_loss: 350579.7986; train_edge_recon_loss: 27172712.8889; train_gene_expr_recon_loss: 20353681.7778; train_masked_gp_l1_reg_loss: 4368.4437; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9512075.5556; train_global_loss: 57393419.5556; train_optim_loss: 57393419.5556; val_kl_reg_loss: 233457.3750; val_edge_recon_loss: 27245894.0000; val_gene_expr_recon_loss: 20379706.0000; val_masked_gp_l1_reg_loss: 4368.4570; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9551964.0000; val_global_loss: 57415388.0000; val_optim_loss: 57415388.0000
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9489; val_auprc_score: 0.9291; val_best_acc_score: 0.8954; val_best_f1_score: 0.9020; train_kl_reg_loss: 352788.7535; train_edge_recon_loss: 27222257.3333; train_gene_expr_recon_loss: 20394495.3333; train_masked_gp_l1_reg_loss: 4368.4675; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9560359.6667; train_global_loss: 57534269.3333; train_optim_loss: 57534269.3333; val_kl_reg_loss: 233281.8125; val_edge_recon_loss: 27212838.0000; val_gene_expr_recon_loss: 20370134.0000; val_masked_gp_l1_reg_loss: 4368.4814; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9543754.0000; val_global_loss: 57364376.0000; val_optim_loss: 57364376.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 16 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
Val AUROC score: 0.9483
Val AUPRC score: 0.9295
Val best accuracy score: 0.8918
Val best F1 score: 0.8977
Val gene expr MSE score: 0.4217
Val chrom access MSE score: 0.0868
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
