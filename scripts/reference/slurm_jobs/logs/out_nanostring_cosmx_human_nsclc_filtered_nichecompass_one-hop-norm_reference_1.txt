[True]
Run timestamp: 26082023_190455_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc_filtered', '--reference_batches', 'batch1', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 883, n_cat_covariates_embed_input: 0, n_hidden: 883, n_latent: 1484, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1484, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 883
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1484, n_addon_gp_input: 10, n_cat_covariates_embed_input: 3, n_output: 883

--- INITIALIZING TRAINER ---
Number of training nodes: 171624
Number of validation nodes: 19069
Number of training edges: 784282
Number of validation edges: 87142
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9477; val_auprc_score: 0.9665; val_best_acc_score: 0.9049; val_best_f1_score: 0.9310; train_kl_reg_loss: 13608.3450; train_edge_recon_loss: 1842708.0160; train_gene_expr_recon_loss: 2477343.2582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4333659.6257; train_optim_loss: 4333659.6257; val_kl_reg_loss: 11741.6476; val_edge_recon_loss: 1794444.6730; val_gene_expr_recon_loss: 2316437.4709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4122623.8140; val_optim_loss: 4122623.8140
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9661; val_auprc_score: 0.9783; val_best_acc_score: 0.9264; val_best_f1_score: 0.9462; train_kl_reg_loss: 10919.0376; train_edge_recon_loss: 1765069.1554; train_gene_expr_recon_loss: 2235318.9865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4011307.1743; train_optim_loss: 4011307.1743; val_kl_reg_loss: 11495.0444; val_edge_recon_loss: 1787336.7587; val_gene_expr_recon_loss: 2143080.9230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3941912.7209; val_optim_loss: 3941912.7209
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9670; val_auprc_score: 0.9787; val_best_acc_score: 0.9290; val_best_f1_score: 0.9478; train_kl_reg_loss: 12813.8598; train_edge_recon_loss: 1759663.9336; train_gene_expr_recon_loss: 2046731.1939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3819208.9902; train_optim_loss: 3819208.9902; val_kl_reg_loss: 14216.8774; val_edge_recon_loss: 1783717.9535; val_gene_expr_recon_loss: 1959317.3067; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3757252.1279; val_optim_loss: 3757252.1279
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9698; val_auprc_score: 0.9807; val_best_acc_score: 0.9329; val_best_f1_score: 0.9508; train_kl_reg_loss: 14942.6442; train_edge_recon_loss: 1758478.5408; train_gene_expr_recon_loss: 1894941.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3668363.0490; train_optim_loss: 3668363.0490; val_kl_reg_loss: 15489.2443; val_edge_recon_loss: 1781329.3910; val_gene_expr_recon_loss: 1841972.7718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3638791.4157; val_optim_loss: 3638791.4157
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9708; val_auprc_score: 0.9814; val_best_acc_score: 0.9333; val_best_f1_score: 0.9511; train_kl_reg_loss: 16300.4746; train_edge_recon_loss: 1758407.7854; train_gene_expr_recon_loss: 1802830.1230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3577538.3809; train_optim_loss: 3577538.3809; val_kl_reg_loss: 16413.8711; val_edge_recon_loss: 1778532.6381; val_gene_expr_recon_loss: 1772955.9215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3567902.4273; val_optim_loss: 3567902.4273
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9703; val_auprc_score: 0.9810; val_best_acc_score: 0.9329; val_best_f1_score: 0.9509; train_kl_reg_loss: 17108.0872; train_edge_recon_loss: 1754839.6288; train_gene_expr_recon_loss: 1742986.0259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3514933.7379; train_optim_loss: 3514933.7379; val_kl_reg_loss: 17796.7445; val_edge_recon_loss: 1777728.4273; val_gene_expr_recon_loss: 1726912.1933; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3522437.3721; val_optim_loss: 3522437.3721
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9709; val_auprc_score: 0.9812; val_best_acc_score: 0.9354; val_best_f1_score: 0.9527; train_kl_reg_loss: 17548.8172; train_edge_recon_loss: 1757330.9045; train_gene_expr_recon_loss: 1706064.1604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3480943.8802; train_optim_loss: 3480943.8802; val_kl_reg_loss: 17649.1227; val_edge_recon_loss: 1769587.9462; val_gene_expr_recon_loss: 1693065.4985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3480302.5843; val_optim_loss: 3480302.5843
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9714; val_auprc_score: 0.9816; val_best_acc_score: 0.9359; val_best_f1_score: 0.9530; train_kl_reg_loss: 17836.7970; train_edge_recon_loss: 1754628.0894; train_gene_expr_recon_loss: 1675660.6472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3448125.5333; train_optim_loss: 3448125.5333; val_kl_reg_loss: 17695.1758; val_edge_recon_loss: 1775874.6323; val_gene_expr_recon_loss: 1670596.2529; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3464166.0610; val_optim_loss: 3464166.0610
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9732; val_auprc_score: 0.9828; val_best_acc_score: 0.9372; val_best_f1_score: 0.9538; train_kl_reg_loss: 18084.1568; train_edge_recon_loss: 1753062.3207; train_gene_expr_recon_loss: 1659489.6629; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3430636.1384; train_optim_loss: 3430636.1384; val_kl_reg_loss: 18077.4201; val_edge_recon_loss: 1781718.9709; val_gene_expr_recon_loss: 1660885.2355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3460681.6047; val_optim_loss: 3460681.6047
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9743; val_auprc_score: 0.9836; val_best_acc_score: 0.9387; val_best_f1_score: 0.9550; train_kl_reg_loss: 18303.1618; train_edge_recon_loss: 1752770.3698; train_gene_expr_recon_loss: 1641537.2841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3412610.8127; train_optim_loss: 3412610.8127; val_kl_reg_loss: 18158.6670; val_edge_recon_loss: 1768542.0887; val_gene_expr_recon_loss: 1643882.1512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3430582.8895; val_optim_loss: 3430582.8895
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9732; val_auprc_score: 0.9824; val_best_acc_score: 0.9384; val_best_f1_score: 0.9548; train_kl_reg_loss: 18427.3051; train_edge_recon_loss: 1750476.7944; train_gene_expr_recon_loss: 1631840.3711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3400744.4693; train_optim_loss: 3400744.4693; val_kl_reg_loss: 18275.0389; val_edge_recon_loss: 1773392.9709; val_gene_expr_recon_loss: 1636112.4346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3427780.4593; val_optim_loss: 3427780.4593
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9741; val_auprc_score: 0.9837; val_best_acc_score: 0.9388; val_best_f1_score: 0.9551; train_kl_reg_loss: 18550.5343; train_edge_recon_loss: 1749637.8450; train_gene_expr_recon_loss: 1624783.6885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3392972.0702; train_optim_loss: 3392972.0702; val_kl_reg_loss: 18577.7999; val_edge_recon_loss: 1776656.8561; val_gene_expr_recon_loss: 1628128.8852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3423363.5436; val_optim_loss: 3423363.5436
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9747; val_auprc_score: 0.9837; val_best_acc_score: 0.9409; val_best_f1_score: 0.9567; train_kl_reg_loss: 18618.2250; train_edge_recon_loss: 1751858.7079; train_gene_expr_recon_loss: 1611241.9953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3381718.9305; train_optim_loss: 3381718.9305; val_kl_reg_loss: 18906.2887; val_edge_recon_loss: 1765237.1017; val_gene_expr_recon_loss: 1622220.3561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3406363.7355; val_optim_loss: 3406363.7355
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9751; val_auprc_score: 0.9838; val_best_acc_score: 0.9397; val_best_f1_score: 0.9556; train_kl_reg_loss: 18754.1855; train_edge_recon_loss: 1750802.8757; train_gene_expr_recon_loss: 1608601.0294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3378158.0871; train_optim_loss: 3378158.0871; val_kl_reg_loss: 19025.9239; val_edge_recon_loss: 1772494.6642; val_gene_expr_recon_loss: 1616069.3663; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3407589.9651; val_optim_loss: 3407589.9651
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9756; val_auprc_score: 0.9842; val_best_acc_score: 0.9425; val_best_f1_score: 0.9578; train_kl_reg_loss: 18837.8386; train_edge_recon_loss: 1749949.4210; train_gene_expr_recon_loss: 1601855.3903; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3370642.6456; train_optim_loss: 3370642.6456; val_kl_reg_loss: 18826.2434; val_edge_recon_loss: 1766986.7442; val_gene_expr_recon_loss: 1610224.4535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3396037.4419; val_optim_loss: 3396037.4419
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9758; val_auprc_score: 0.9845; val_best_acc_score: 0.9420; val_best_f1_score: 0.9574; train_kl_reg_loss: 18933.7222; train_edge_recon_loss: 1751203.7221; train_gene_expr_recon_loss: 1597425.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3367562.5950; train_optim_loss: 3367562.5950; val_kl_reg_loss: 18949.4842; val_edge_recon_loss: 1771951.2137; val_gene_expr_recon_loss: 1610488.1802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3401388.8837; val_optim_loss: 3401388.8837
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9754; val_auprc_score: 0.9841; val_best_acc_score: 0.9415; val_best_f1_score: 0.9570; train_kl_reg_loss: 18942.4950; train_edge_recon_loss: 1747084.5625; train_gene_expr_recon_loss: 1590636.5046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3356663.5682; train_optim_loss: 3356663.5682; val_kl_reg_loss: 18906.8186; val_edge_recon_loss: 1768600.9869; val_gene_expr_recon_loss: 1608272.3256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3395780.1163; val_optim_loss: 3395780.1163
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9745; val_auprc_score: 0.9832; val_best_acc_score: 0.9420; val_best_f1_score: 0.9575; train_kl_reg_loss: 19053.7109; train_edge_recon_loss: 1749293.1038; train_gene_expr_recon_loss: 1587549.8879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3355896.7053; train_optim_loss: 3355896.7053; val_kl_reg_loss: 19334.3539; val_edge_recon_loss: 1765859.7936; val_gene_expr_recon_loss: 1603283.6148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3388477.7733; val_optim_loss: 3388477.7733
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9760; val_auprc_score: 0.9842; val_best_acc_score: 0.9428; val_best_f1_score: 0.9579; train_kl_reg_loss: 19141.7562; train_edge_recon_loss: 1750119.6953; train_gene_expr_recon_loss: 1583832.5202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3353093.9674; train_optim_loss: 3353093.9674; val_kl_reg_loss: 19531.9067; val_edge_recon_loss: 1770742.1686; val_gene_expr_recon_loss: 1593752.4985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3384026.5669; val_optim_loss: 3384026.5669
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9757; val_auprc_score: 0.9841; val_best_acc_score: 0.9428; val_best_f1_score: 0.9580; train_kl_reg_loss: 19361.1634; train_edge_recon_loss: 1746110.3407; train_gene_expr_recon_loss: 1580708.4577; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3346179.9644; train_optim_loss: 3346179.9644; val_kl_reg_loss: 19443.7660; val_edge_recon_loss: 1776496.2892; val_gene_expr_recon_loss: 1590547.9578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3386488.0029; val_optim_loss: 3386488.0029
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9764; val_auprc_score: 0.9844; val_best_acc_score: 0.9453; val_best_f1_score: 0.9598; train_kl_reg_loss: 19218.4037; train_edge_recon_loss: 1746402.9918; train_gene_expr_recon_loss: 1573708.6981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3339330.0937; train_optim_loss: 3339330.0937; val_kl_reg_loss: 19233.1399; val_edge_recon_loss: 1767624.6802; val_gene_expr_recon_loss: 1588550.0872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3375407.9128; val_optim_loss: 3375407.9128
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9764; val_auprc_score: 0.9849; val_best_acc_score: 0.9434; val_best_f1_score: 0.9583; train_kl_reg_loss: 19306.1172; train_edge_recon_loss: 1749634.6789; train_gene_expr_recon_loss: 1575274.4098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3344215.2023; train_optim_loss: 3344215.2023; val_kl_reg_loss: 19543.5309; val_edge_recon_loss: 1765711.1526; val_gene_expr_recon_loss: 1593028.9244; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3378283.6134; val_optim_loss: 3378283.6134
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9768; val_auprc_score: 0.9854; val_best_acc_score: 0.9435; val_best_f1_score: 0.9584; train_kl_reg_loss: 19421.8830; train_edge_recon_loss: 1747319.0542; train_gene_expr_recon_loss: 1569080.4517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3335821.3858; train_optim_loss: 3335821.3858; val_kl_reg_loss: 19127.6620; val_edge_recon_loss: 1768828.3779; val_gene_expr_recon_loss: 1583984.4913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3371940.5262; val_optim_loss: 3371940.5262
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9780; val_auprc_score: 0.9860; val_best_acc_score: 0.9454; val_best_f1_score: 0.9597; train_kl_reg_loss: 19348.1715; train_edge_recon_loss: 1748424.6456; train_gene_expr_recon_loss: 1568678.4514; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3336451.2683; train_optim_loss: 3336451.2683; val_kl_reg_loss: 19612.0996; val_edge_recon_loss: 1765154.0698; val_gene_expr_recon_loss: 1588251.7297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3373017.8953; val_optim_loss: 3373017.8953
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9757; val_auprc_score: 0.9839; val_best_acc_score: 0.9440; val_best_f1_score: 0.9588; train_kl_reg_loss: 19568.8923; train_edge_recon_loss: 1750353.8970; train_gene_expr_recon_loss: 1565682.8399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3335605.6283; train_optim_loss: 3335605.6283; val_kl_reg_loss: 19754.8103; val_edge_recon_loss: 1764159.9753; val_gene_expr_recon_loss: 1583159.8241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3367074.6076; val_optim_loss: 3367074.6076
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9781; val_auprc_score: 0.9859; val_best_acc_score: 0.9456; val_best_f1_score: 0.9598; train_kl_reg_loss: 19525.7524; train_edge_recon_loss: 1748927.3933; train_gene_expr_recon_loss: 1561117.0338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3329570.1808; train_optim_loss: 3329570.1808; val_kl_reg_loss: 19492.3515; val_edge_recon_loss: 1765345.8852; val_gene_expr_recon_loss: 1587011.8140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3371850.0494; val_optim_loss: 3371850.0494
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9774; val_auprc_score: 0.9855; val_best_acc_score: 0.9452; val_best_f1_score: 0.9598; train_kl_reg_loss: 19582.1113; train_edge_recon_loss: 1747085.7861; train_gene_expr_recon_loss: 1559101.1542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3325769.0486; train_optim_loss: 3325769.0486; val_kl_reg_loss: 19877.5546; val_edge_recon_loss: 1768009.8445; val_gene_expr_recon_loss: 1580967.3634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3368854.7587; val_optim_loss: 3368854.7587
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9762; val_auprc_score: 0.9842; val_best_acc_score: 0.9447; val_best_f1_score: 0.9594; train_kl_reg_loss: 19763.0717; train_edge_recon_loss: 1745544.7552; train_gene_expr_recon_loss: 1560055.9964; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3325363.8198; train_optim_loss: 3325363.8198; val_kl_reg_loss: 19764.8055; val_edge_recon_loss: 1770134.3169; val_gene_expr_recon_loss: 1576312.7049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3366211.8343; val_optim_loss: 3366211.8343
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9777; val_auprc_score: 0.9856; val_best_acc_score: 0.9455; val_best_f1_score: 0.9598; train_kl_reg_loss: 19750.4047; train_edge_recon_loss: 1747815.5202; train_gene_expr_recon_loss: 1557615.8009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3325181.7252; train_optim_loss: 3325181.7252; val_kl_reg_loss: 20012.3828; val_edge_recon_loss: 1768015.5509; val_gene_expr_recon_loss: 1580789.9157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3368817.8459; val_optim_loss: 3368817.8459
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9786; val_auprc_score: 0.9860; val_best_acc_score: 0.9475; val_best_f1_score: 0.9613; train_kl_reg_loss: 19852.9034; train_edge_recon_loss: 1747326.2751; train_gene_expr_recon_loss: 1555510.6975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3322689.8698; train_optim_loss: 3322689.8698; val_kl_reg_loss: 19617.4581; val_edge_recon_loss: 1766180.6279; val_gene_expr_recon_loss: 1573251.4622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3359049.5640; val_optim_loss: 3359049.5640
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9776; val_auprc_score: 0.9857; val_best_acc_score: 0.9459; val_best_f1_score: 0.9602; train_kl_reg_loss: 19822.4500; train_edge_recon_loss: 1745048.9716; train_gene_expr_recon_loss: 1551127.5379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3315998.9631; train_optim_loss: 3315998.9631; val_kl_reg_loss: 19839.4174; val_edge_recon_loss: 1768326.9985; val_gene_expr_recon_loss: 1568891.9622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3357058.3779; val_optim_loss: 3357058.3779
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9788; val_auprc_score: 0.9862; val_best_acc_score: 0.9479; val_best_f1_score: 0.9615; train_kl_reg_loss: 19932.4308; train_edge_recon_loss: 1745915.5282; train_gene_expr_recon_loss: 1553764.9860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3319612.9439; train_optim_loss: 3319612.9439; val_kl_reg_loss: 20041.9847; val_edge_recon_loss: 1767101.9884; val_gene_expr_recon_loss: 1572197.0901; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3359341.0610; val_optim_loss: 3359341.0610
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9791; val_auprc_score: 0.9867; val_best_acc_score: 0.9466; val_best_f1_score: 0.9606; train_kl_reg_loss: 19948.6107; train_edge_recon_loss: 1746231.6415; train_gene_expr_recon_loss: 1548733.8208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3314914.0718; train_optim_loss: 3314914.0718; val_kl_reg_loss: 19827.2290; val_edge_recon_loss: 1761245.4215; val_gene_expr_recon_loss: 1572779.3401; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3353851.9767; val_optim_loss: 3353851.9767
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9765; val_auprc_score: 0.9845; val_best_acc_score: 0.9451; val_best_f1_score: 0.9594; train_kl_reg_loss: 19964.0397; train_edge_recon_loss: 1746197.6381; train_gene_expr_recon_loss: 1548968.0899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3315129.7653; train_optim_loss: 3315129.7653; val_kl_reg_loss: 20495.8469; val_edge_recon_loss: 1774769.8270; val_gene_expr_recon_loss: 1568493.1076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3363758.7674; val_optim_loss: 3363758.7674
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9788; val_auprc_score: 0.9862; val_best_acc_score: 0.9483; val_best_f1_score: 0.9620; train_kl_reg_loss: 20010.9105; train_edge_recon_loss: 1745541.4683; train_gene_expr_recon_loss: 1545247.0341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3310799.4096; train_optim_loss: 3310799.4096; val_kl_reg_loss: 20001.7780; val_edge_recon_loss: 1760416.1381; val_gene_expr_recon_loss: 1564226.0669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3344644.0058; val_optim_loss: 3344644.0058
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9788; val_auprc_score: 0.9864; val_best_acc_score: 0.9470; val_best_f1_score: 0.9610; train_kl_reg_loss: 20093.3329; train_edge_recon_loss: 1745793.7596; train_gene_expr_recon_loss: 1546833.3236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3312720.4116; train_optim_loss: 3312720.4116; val_kl_reg_loss: 20639.5064; val_edge_recon_loss: 1760925.0015; val_gene_expr_recon_loss: 1563572.8983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3345137.4012; val_optim_loss: 3345137.4012
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9774; val_auprc_score: 0.9852; val_best_acc_score: 0.9466; val_best_f1_score: 0.9606; train_kl_reg_loss: 20015.9683; train_edge_recon_loss: 1747576.7569; train_gene_expr_recon_loss: 1542784.3043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3310377.0290; train_optim_loss: 3310377.0290; val_kl_reg_loss: 20013.0379; val_edge_recon_loss: 1764784.3459; val_gene_expr_recon_loss: 1566896.2355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3351693.6076; val_optim_loss: 3351693.6076
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9795; val_auprc_score: 0.9867; val_best_acc_score: 0.9487; val_best_f1_score: 0.9622; train_kl_reg_loss: 20123.8504; train_edge_recon_loss: 1746269.8205; train_gene_expr_recon_loss: 1543132.0308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3309525.7076; train_optim_loss: 3309525.7076; val_kl_reg_loss: 20077.5299; val_edge_recon_loss: 1759892.3823; val_gene_expr_recon_loss: 1559731.3997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3339701.3023; val_optim_loss: 3339701.3023
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9803; val_auprc_score: 0.9874; val_best_acc_score: 0.9483; val_best_f1_score: 0.9619; train_kl_reg_loss: 20216.5857; train_edge_recon_loss: 1746246.9765; train_gene_expr_recon_loss: 1544344.3110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3310807.8740; train_optim_loss: 3310807.8740; val_kl_reg_loss: 19900.5604; val_edge_recon_loss: 1762858.1628; val_gene_expr_recon_loss: 1560699.9898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3343458.7035; val_optim_loss: 3343458.7035
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9782; val_auprc_score: 0.9858; val_best_acc_score: 0.9474; val_best_f1_score: 0.9613; train_kl_reg_loss: 20192.8827; train_edge_recon_loss: 1741499.8130; train_gene_expr_recon_loss: 1538332.2861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3300024.9778; train_optim_loss: 3300024.9778; val_kl_reg_loss: 20439.6199; val_edge_recon_loss: 1764484.6831; val_gene_expr_recon_loss: 1566843.0654; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3351767.3576; val_optim_loss: 3351767.3576
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9785; val_auprc_score: 0.9859; val_best_acc_score: 0.9483; val_best_f1_score: 0.9619; train_kl_reg_loss: 20330.8504; train_edge_recon_loss: 1744720.9375; train_gene_expr_recon_loss: 1540857.7658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3305909.5529; train_optim_loss: 3305909.5529; val_kl_reg_loss: 20297.3373; val_edge_recon_loss: 1770273.4971; val_gene_expr_recon_loss: 1559828.5233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3350399.3576; val_optim_loss: 3350399.3576
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9789; val_auprc_score: 0.9858; val_best_acc_score: 0.9489; val_best_f1_score: 0.9623; train_kl_reg_loss: 20235.6645; train_edge_recon_loss: 1745682.8765; train_gene_expr_recon_loss: 1537916.1973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3303834.7383; train_optim_loss: 3303834.7383; val_kl_reg_loss: 20381.3040; val_edge_recon_loss: 1769821.8605; val_gene_expr_recon_loss: 1566328.2645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3356531.4477; val_optim_loss: 3356531.4477

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9794; val_auprc_score: 0.9865; val_best_acc_score: 0.9491; val_best_f1_score: 0.9625; train_kl_reg_loss: 19999.1002; train_edge_recon_loss: 1744135.9724; train_gene_expr_recon_loss: 1520992.4900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3285127.5594; train_optim_loss: 3285127.5594; val_kl_reg_loss: 20053.6665; val_edge_recon_loss: 1763292.1410; val_gene_expr_recon_loss: 1545154.0770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3328499.8924; val_optim_loss: 3328499.8924
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9789; val_auprc_score: 0.9861; val_best_acc_score: 0.9493; val_best_f1_score: 0.9627; train_kl_reg_loss: 20015.9778; train_edge_recon_loss: 1741735.1718; train_gene_expr_recon_loss: 1516306.8073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3278057.9586; train_optim_loss: 3278057.9586; val_kl_reg_loss: 20196.9640; val_edge_recon_loss: 1762894.5858; val_gene_expr_recon_loss: 1543446.4753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3326538.0116; val_optim_loss: 3326538.0116
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9797; val_auprc_score: 0.9867; val_best_acc_score: 0.9499; val_best_f1_score: 0.9630; train_kl_reg_loss: 19938.7614; train_edge_recon_loss: 1743250.7595; train_gene_expr_recon_loss: 1514405.1531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3277594.6730; train_optim_loss: 3277594.6730; val_kl_reg_loss: 20004.9149; val_edge_recon_loss: 1758847.6279; val_gene_expr_recon_loss: 1543041.2544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3321893.8198; val_optim_loss: 3321893.8198
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9790; val_auprc_score: 0.9861; val_best_acc_score: 0.9490; val_best_f1_score: 0.9623; train_kl_reg_loss: 19928.3702; train_edge_recon_loss: 1742927.0031; train_gene_expr_recon_loss: 1512739.6994; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3275595.0715; train_optim_loss: 3275595.0715; val_kl_reg_loss: 20047.2799; val_edge_recon_loss: 1765318.1163; val_gene_expr_recon_loss: 1542182.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3327547.4128; val_optim_loss: 3327547.4128
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9803; val_auprc_score: 0.9870; val_best_acc_score: 0.9500; val_best_f1_score: 0.9631; train_kl_reg_loss: 19895.3447; train_edge_recon_loss: 1742084.8996; train_gene_expr_recon_loss: 1512289.9377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3274270.1743; train_optim_loss: 3274270.1743; val_kl_reg_loss: 19868.1781; val_edge_recon_loss: 1767939.2849; val_gene_expr_recon_loss: 1542726.1308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3330533.5959; val_optim_loss: 3330533.5959
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9797; val_auprc_score: 0.9867; val_best_acc_score: 0.9504; val_best_f1_score: 0.9634; train_kl_reg_loss: 19790.4873; train_edge_recon_loss: 1742016.5230; train_gene_expr_recon_loss: 1511071.9093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3272878.9213; train_optim_loss: 3272878.9213; val_kl_reg_loss: 19774.5237; val_edge_recon_loss: 1763820.8198; val_gene_expr_recon_loss: 1539986.8517; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3323582.1802; val_optim_loss: 3323582.1802
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9813; val_auprc_score: 0.9880; val_best_acc_score: 0.9511; val_best_f1_score: 0.9639; train_kl_reg_loss: 19748.7342; train_edge_recon_loss: 1743482.9948; train_gene_expr_recon_loss: 1510816.9714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3274048.6958; train_optim_loss: 3274048.6958; val_kl_reg_loss: 19741.7623; val_edge_recon_loss: 1759071.4985; val_gene_expr_recon_loss: 1539456.9433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3318270.1977; val_optim_loss: 3318270.1977
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9801; val_auprc_score: 0.9870; val_best_acc_score: 0.9505; val_best_f1_score: 0.9634; train_kl_reg_loss: 19687.7637; train_edge_recon_loss: 1738795.0307; train_gene_expr_recon_loss: 1510577.2174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3269060.0059; train_optim_loss: 3269060.0059; val_kl_reg_loss: 19815.1043; val_edge_recon_loss: 1766170.7515; val_gene_expr_recon_loss: 1540094.2180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3326080.0669; val_optim_loss: 3326080.0669
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9799; val_auprc_score: 0.9867; val_best_acc_score: 0.9511; val_best_f1_score: 0.9640; train_kl_reg_loss: 19653.5468; train_edge_recon_loss: 1740565.3642; train_gene_expr_recon_loss: 1510996.0646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3271214.9742; train_optim_loss: 3271214.9742; val_kl_reg_loss: 19704.3416; val_edge_recon_loss: 1755947.2326; val_gene_expr_recon_loss: 1539191.3721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3314842.9419; val_optim_loss: 3314842.9419
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9809; val_auprc_score: 0.9878; val_best_acc_score: 0.9501; val_best_f1_score: 0.9631; train_kl_reg_loss: 19652.4492; train_edge_recon_loss: 1741857.4005; train_gene_expr_recon_loss: 1509545.0552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3271054.9011; train_optim_loss: 3271054.9011; val_kl_reg_loss: 19622.4614; val_edge_recon_loss: 1764352.1119; val_gene_expr_recon_loss: 1538741.7718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3322716.3430; val_optim_loss: 3322716.3430
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9809; val_auprc_score: 0.9879; val_best_acc_score: 0.9514; val_best_f1_score: 0.9642; train_kl_reg_loss: 19568.4276; train_edge_recon_loss: 1741831.3585; train_gene_expr_recon_loss: 1508991.6407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3270391.4266; train_optim_loss: 3270391.4266; val_kl_reg_loss: 19555.6335; val_edge_recon_loss: 1753586.0872; val_gene_expr_recon_loss: 1536373.2369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3309514.9680; val_optim_loss: 3309514.9680
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9801; val_auprc_score: 0.9870; val_best_acc_score: 0.9505; val_best_f1_score: 0.9635; train_kl_reg_loss: 19527.9441; train_edge_recon_loss: 1743579.2291; train_gene_expr_recon_loss: 1509728.6160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3272835.7914; train_optim_loss: 3272835.7914; val_kl_reg_loss: 19713.2561; val_edge_recon_loss: 1764289.8590; val_gene_expr_recon_loss: 1540557.2166; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3324560.3576; val_optim_loss: 3324560.3576
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9798; val_auprc_score: 0.9865; val_best_acc_score: 0.9516; val_best_f1_score: 0.9643; train_kl_reg_loss: 19570.9871; train_edge_recon_loss: 1742180.4370; train_gene_expr_recon_loss: 1508135.1457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3269886.5708; train_optim_loss: 3269886.5708; val_kl_reg_loss: 19591.2586; val_edge_recon_loss: 1761164.4172; val_gene_expr_recon_loss: 1538235.1817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3318990.8547; val_optim_loss: 3318990.8547
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9807; val_auprc_score: 0.9874; val_best_acc_score: 0.9518; val_best_f1_score: 0.9645; train_kl_reg_loss: 19464.1582; train_edge_recon_loss: 1741367.1821; train_gene_expr_recon_loss: 1508296.4530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3269127.7928; train_optim_loss: 3269127.7928; val_kl_reg_loss: 19546.9921; val_edge_recon_loss: 1757991.7878; val_gene_expr_recon_loss: 1537587.9956; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3315126.7733; val_optim_loss: 3315126.7733
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9801; val_auprc_score: 0.9870; val_best_acc_score: 0.9513; val_best_f1_score: 0.9640; train_kl_reg_loss: 19484.2355; train_edge_recon_loss: 1740154.2409; train_gene_expr_recon_loss: 1507440.0963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3267078.5751; train_optim_loss: 3267078.5751; val_kl_reg_loss: 19413.7242; val_edge_recon_loss: 1761120.3517; val_gene_expr_recon_loss: 1537525.4172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3318059.4651; val_optim_loss: 3318059.4651

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9807; val_auprc_score: 0.9875; val_best_acc_score: 0.9512; val_best_f1_score: 0.9639; train_kl_reg_loss: 19352.4184; train_edge_recon_loss: 1741241.2906; train_gene_expr_recon_loss: 1505189.8039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3265783.5124; train_optim_loss: 3265783.5124; val_kl_reg_loss: 19418.8272; val_edge_recon_loss: 1759963.2718; val_gene_expr_recon_loss: 1535736.7442; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3315118.8488; val_optim_loss: 3315118.8488
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9801; val_auprc_score: 0.9869; val_best_acc_score: 0.9511; val_best_f1_score: 0.9639; train_kl_reg_loss: 19353.2274; train_edge_recon_loss: 1739641.0604; train_gene_expr_recon_loss: 1504736.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3263730.3032; train_optim_loss: 3263730.3032; val_kl_reg_loss: 19453.4080; val_edge_recon_loss: 1760621.6453; val_gene_expr_recon_loss: 1536283.9201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3316359.0000; val_optim_loss: 3316359.0000
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9811; val_auprc_score: 0.9877; val_best_acc_score: 0.9519; val_best_f1_score: 0.9645; train_kl_reg_loss: 19352.7960; train_edge_recon_loss: 1741795.0441; train_gene_expr_recon_loss: 1505548.6219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3266696.4644; train_optim_loss: 3266696.4644; val_kl_reg_loss: 19399.7616; val_edge_recon_loss: 1752517.9520; val_gene_expr_recon_loss: 1537741.1759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3309658.8750; val_optim_loss: 3309658.8750
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9806; val_auprc_score: 0.9875; val_best_acc_score: 0.9504; val_best_f1_score: 0.9634; train_kl_reg_loss: 19365.1030; train_edge_recon_loss: 1741477.6247; train_gene_expr_recon_loss: 1505163.6523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3266006.3789; train_optim_loss: 3266006.3789; val_kl_reg_loss: 19394.7728; val_edge_recon_loss: 1762991.8823; val_gene_expr_recon_loss: 1534818.5436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3317205.1977; val_optim_loss: 3317205.1977

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 790 min 50 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9805
val AUPRC score: 0.9873
val best accuracy score: 0.9504
val best F1 score: 0.9634
val target rna MSE score: 0.4787
val source rna MSE score: 0.0506
Val cat covariate0 mean sim diff: 0.0002

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
