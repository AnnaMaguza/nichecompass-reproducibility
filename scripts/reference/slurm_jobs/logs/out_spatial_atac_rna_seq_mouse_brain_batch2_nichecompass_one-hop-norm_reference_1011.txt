[True]
Run timestamp: 10082023_134118_1011.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1011']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7509; val_auprc_score: 0.7708; val_best_acc_score: 0.5160; val_best_f1_score: 0.6729; train_kl_reg_loss: 101142.5380; train_edge_recon_loss: 3567204.0191; train_gene_expr_recon_loss: 14414105.0382; train_masked_gp_l1_reg_loss: 73104.5790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 234365.7698; train_chrom_access_recon_loss: 2175124.6403; train_global_loss: 20565046.6260; train_optim_loss: 20565046.6260; val_kl_reg_loss: 154660.9958; val_edge_recon_loss: 4064166.0167; val_gene_expr_recon_loss: 12979539.2000; val_masked_gp_l1_reg_loss: 67077.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 215490.0938; val_chrom_access_recon_loss: 2095075.9917; val_global_loss: 19576010.1333; val_optim_loss: 19576010.1333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8135; val_auprc_score: 0.8191; val_best_acc_score: 0.7243; val_best_f1_score: 0.7402; train_kl_reg_loss: 123933.0669; train_edge_recon_loss: 3536798.5744; train_gene_expr_recon_loss: 12651571.3893; train_masked_gp_l1_reg_loss: 66062.7202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 195333.5527; train_chrom_access_recon_loss: 2048464.7529; train_global_loss: 18622163.9695; train_optim_loss: 18622163.9695; val_kl_reg_loss: 119943.8667; val_edge_recon_loss: 4018052.2167; val_gene_expr_recon_loss: 12740076.0667; val_masked_gp_l1_reg_loss: 67319.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175463.2188; val_chrom_access_recon_loss: 2075678.0917; val_global_loss: 19196534.1333; val_optim_loss: 19196534.1333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8363; val_auprc_score: 0.8405; val_best_acc_score: 0.7409; val_best_f1_score: 0.7647; train_kl_reg_loss: 97308.6845; train_edge_recon_loss: 3416498.9504; train_gene_expr_recon_loss: 12448393.2290; train_masked_gp_l1_reg_loss: 70291.5261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158005.5253; train_chrom_access_recon_loss: 2022170.8989; train_global_loss: 18212668.7176; train_optim_loss: 18212668.7176; val_kl_reg_loss: 101608.3583; val_edge_recon_loss: 3203993.4667; val_gene_expr_recon_loss: 12648038.9333; val_masked_gp_l1_reg_loss: 74401.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141625.3125; val_chrom_access_recon_loss: 2065680.8583; val_global_loss: 18235348.8000; val_optim_loss: 18235348.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8592; val_auprc_score: 0.8531; val_best_acc_score: 0.7623; val_best_f1_score: 0.7851; train_kl_reg_loss: 112727.3064; train_edge_recon_loss: 3099185.2443; train_gene_expr_recon_loss: 12320244.2595; train_masked_gp_l1_reg_loss: 76777.4364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128501.8271; train_chrom_access_recon_loss: 2002911.9323; train_global_loss: 17740347.9695; train_optim_loss: 17740347.9695; val_kl_reg_loss: 115259.5802; val_edge_recon_loss: 3046137.4000; val_gene_expr_recon_loss: 12465115.5333; val_masked_gp_l1_reg_loss: 78915.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116832.5547; val_chrom_access_recon_loss: 2041487.2917; val_global_loss: 17863749.0667; val_optim_loss: 17863749.0667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8923; val_auprc_score: 0.8828; val_best_acc_score: 0.8102; val_best_f1_score: 0.8098; train_kl_reg_loss: 117620.2118; train_edge_recon_loss: 2985356.5611; train_gene_expr_recon_loss: 12177639.8168; train_masked_gp_l1_reg_loss: 80903.1818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108107.2650; train_chrom_access_recon_loss: 1984205.9122; train_global_loss: 17453832.8779; train_optim_loss: 17453832.8779; val_kl_reg_loss: 122759.8177; val_edge_recon_loss: 2942431.3000; val_gene_expr_recon_loss: 12286854.2667; val_masked_gp_l1_reg_loss: 82819.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100169.1250; val_chrom_access_recon_loss: 2016789.9917; val_global_loss: 17551824.4000; val_optim_loss: 17551824.4000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9064; val_auprc_score: 0.8905; val_best_acc_score: 0.8319; val_best_f1_score: 0.8425; train_kl_reg_loss: 111872.3884; train_edge_recon_loss: 2904012.9962; train_gene_expr_recon_loss: 12042926.4962; train_masked_gp_l1_reg_loss: 84376.2709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93572.6521; train_chrom_access_recon_loss: 1967199.3387; train_global_loss: 17203960.1374; train_optim_loss: 17203960.1374; val_kl_reg_loss: 115247.7312; val_edge_recon_loss: 2901353.0167; val_gene_expr_recon_loss: 12224200.3333; val_masked_gp_l1_reg_loss: 86071.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87450.1406; val_chrom_access_recon_loss: 2003064.7667; val_global_loss: 17417387.8667; val_optim_loss: 17417387.8667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9274; val_auprc_score: 0.9118; val_best_acc_score: 0.8596; val_best_f1_score: 0.8670; train_kl_reg_loss: 111290.6044; train_edge_recon_loss: 2850635.6718; train_gene_expr_recon_loss: 11940934.8397; train_masked_gp_l1_reg_loss: 87603.2727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81812.0196; train_chrom_access_recon_loss: 1951392.9036; train_global_loss: 17023669.3588; train_optim_loss: 17023669.3588; val_kl_reg_loss: 112425.8089; val_edge_recon_loss: 2839695.4000; val_gene_expr_recon_loss: 12092332.8667; val_masked_gp_l1_reg_loss: 89331.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76487.6562; val_chrom_access_recon_loss: 1981461.8250; val_global_loss: 17191736.1333; val_optim_loss: 17191736.1333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9336; val_auprc_score: 0.9198; val_best_acc_score: 0.8685; val_best_f1_score: 0.8765; train_kl_reg_loss: 110307.0601; train_edge_recon_loss: 2814369.5649; train_gene_expr_recon_loss: 11848790.5420; train_masked_gp_l1_reg_loss: 90593.9600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71997.9634; train_chrom_access_recon_loss: 1937649.9628; train_global_loss: 16873709.0840; train_optim_loss: 16873709.0840; val_kl_reg_loss: 108320.2510; val_edge_recon_loss: 2830224.4000; val_gene_expr_recon_loss: 12061863.6667; val_masked_gp_l1_reg_loss: 92010.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67962.6953; val_chrom_access_recon_loss: 1970632.7750; val_global_loss: 17131014.8000; val_optim_loss: 17131014.8000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9421; val_auprc_score: 0.9313; val_best_acc_score: 0.8791; val_best_f1_score: 0.8843; train_kl_reg_loss: 108618.1522; train_edge_recon_loss: 2808864.5344; train_gene_expr_recon_loss: 11767606.3359; train_masked_gp_l1_reg_loss: 93236.1792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64371.2736; train_chrom_access_recon_loss: 1924697.1164; train_global_loss: 16767393.5191; train_optim_loss: 16767393.5191; val_kl_reg_loss: 105343.6755; val_edge_recon_loss: 2785033.5167; val_gene_expr_recon_loss: 11916310.6667; val_masked_gp_l1_reg_loss: 94368.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60989.1367; val_chrom_access_recon_loss: 1950123.5417; val_global_loss: 16912169.4000; val_optim_loss: 16912169.4000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9418; val_auprc_score: 0.9296; val_best_acc_score: 0.8831; val_best_f1_score: 0.8875; train_kl_reg_loss: 104427.6750; train_edge_recon_loss: 2797258.5763; train_gene_expr_recon_loss: 11701628.6336; train_masked_gp_l1_reg_loss: 95555.5305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57980.7942; train_chrom_access_recon_loss: 1915079.5363; train_global_loss: 16671930.7099; train_optim_loss: 16671930.7099; val_kl_reg_loss: 105908.6417; val_edge_recon_loss: 2789052.3000; val_gene_expr_recon_loss: 11883858.9333; val_masked_gp_l1_reg_loss: 96666.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55081.0781; val_chrom_access_recon_loss: 1953035.0000; val_global_loss: 16883603.2000; val_optim_loss: 16883603.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9415; val_auprc_score: 0.9266; val_best_acc_score: 0.8825; val_best_f1_score: 0.8889; train_kl_reg_loss: 103318.7819; train_edge_recon_loss: 2785363.7958; train_gene_expr_recon_loss: 11626237.3969; train_masked_gp_l1_reg_loss: 97780.4622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52532.9478; train_chrom_access_recon_loss: 1904191.5296; train_global_loss: 16569424.9237; train_optim_loss: 16569424.9237; val_kl_reg_loss: 101660.5068; val_edge_recon_loss: 2790536.0167; val_gene_expr_recon_loss: 11830758.0667; val_masked_gp_l1_reg_loss: 98960.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50090.9375; val_chrom_access_recon_loss: 1944762.3750; val_global_loss: 16816768.0000; val_optim_loss: 16816768.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9426; val_auprc_score: 0.9284; val_best_acc_score: 0.8828; val_best_f1_score: 0.8875; train_kl_reg_loss: 101390.4021; train_edge_recon_loss: 2780271.4828; train_gene_expr_recon_loss: 11570513.2214; train_masked_gp_l1_reg_loss: 99817.5141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47848.4286; train_chrom_access_recon_loss: 1894806.5124; train_global_loss: 16494647.5344; train_optim_loss: 16494647.5344; val_kl_reg_loss: 101148.4896; val_edge_recon_loss: 2805835.4500; val_gene_expr_recon_loss: 11741820.8000; val_masked_gp_l1_reg_loss: 100924.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45735.0352; val_chrom_access_recon_loss: 1927814.7917; val_global_loss: 16723279.4000; val_optim_loss: 16723279.4000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9512; val_auprc_score: 0.9413; val_best_acc_score: 0.8923; val_best_f1_score: 0.8960; train_kl_reg_loss: 100642.7915; train_edge_recon_loss: 2759771.0515; train_gene_expr_recon_loss: 11521116.2672; train_masked_gp_l1_reg_loss: 101665.5947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43770.1034; train_chrom_access_recon_loss: 1887189.0086; train_global_loss: 16414154.8473; train_optim_loss: 16414154.8473; val_kl_reg_loss: 100422.6318; val_edge_recon_loss: 2765340.2833; val_gene_expr_recon_loss: 11715521.4667; val_masked_gp_l1_reg_loss: 102491.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41847.8633; val_chrom_access_recon_loss: 1918453.7667; val_global_loss: 16644077.1333; val_optim_loss: 16644077.1333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9513; val_auprc_score: 0.9377; val_best_acc_score: 0.8933; val_best_f1_score: 0.8975; train_kl_reg_loss: 97138.1645; train_edge_recon_loss: 2758887.7328; train_gene_expr_recon_loss: 11472407.7863; train_masked_gp_l1_reg_loss: 103363.9881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40202.5474; train_chrom_access_recon_loss: 1880370.2948; train_global_loss: 16352370.5420; train_optim_loss: 16352370.5420; val_kl_reg_loss: 91728.7219; val_edge_recon_loss: 2755561.9833; val_gene_expr_recon_loss: 11657487.6000; val_masked_gp_l1_reg_loss: 104303.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38611.7383; val_chrom_access_recon_loss: 1918814.3083; val_global_loss: 16566507.4667; val_optim_loss: 16566507.4667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9527; val_auprc_score: 0.9425; val_best_acc_score: 0.8915; val_best_f1_score: 0.8960; train_kl_reg_loss: 96008.2246; train_edge_recon_loss: 2754088.4370; train_gene_expr_recon_loss: 11438027.4198; train_masked_gp_l1_reg_loss: 105062.7885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37119.0988; train_chrom_access_recon_loss: 1873609.5782; train_global_loss: 16303915.4809; train_optim_loss: 16303915.4809; val_kl_reg_loss: 94025.3562; val_edge_recon_loss: 2777407.3667; val_gene_expr_recon_loss: 11603882.9333; val_masked_gp_l1_reg_loss: 105748.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35787.6289; val_chrom_access_recon_loss: 1906066.2917; val_global_loss: 16522919.0000; val_optim_loss: 16522919.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9545; val_auprc_score: 0.9418; val_best_acc_score: 0.8988; val_best_f1_score: 0.9039; train_kl_reg_loss: 95764.9676; train_edge_recon_loss: 2737610.3321; train_gene_expr_recon_loss: 11389242.8550; train_masked_gp_l1_reg_loss: 106533.9484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34574.2458; train_chrom_access_recon_loss: 1865744.0553; train_global_loss: 16229470.2977; train_optim_loss: 16229470.2977; val_kl_reg_loss: 98799.7568; val_edge_recon_loss: 2733165.9333; val_gene_expr_recon_loss: 11609998.2667; val_masked_gp_l1_reg_loss: 107249.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33426.6250; val_chrom_access_recon_loss: 1917711.6250; val_global_loss: 16500351.6000; val_optim_loss: 16500351.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9590; val_auprc_score: 0.9467; val_best_acc_score: 0.9018; val_best_f1_score: 0.9055; train_kl_reg_loss: 94008.5525; train_edge_recon_loss: 2735046.1240; train_gene_expr_recon_loss: 11354299.2519; train_masked_gp_l1_reg_loss: 107962.3057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32452.7559; train_chrom_access_recon_loss: 1860888.1937; train_global_loss: 16184657.1603; train_optim_loss: 16184657.1603; val_kl_reg_loss: 97202.3547; val_edge_recon_loss: 2741205.7500; val_gene_expr_recon_loss: 11555877.1333; val_masked_gp_l1_reg_loss: 108803.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31472.7109; val_chrom_access_recon_loss: 1901019.2833; val_global_loss: 16435581.5333; val_optim_loss: 16435581.5333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9597; val_auprc_score: 0.9481; val_best_acc_score: 0.9054; val_best_f1_score: 0.9081; train_kl_reg_loss: 92519.2439; train_edge_recon_loss: 2724747.3282; train_gene_expr_recon_loss: 11321082.4656; train_masked_gp_l1_reg_loss: 109377.4308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30690.8628; train_chrom_access_recon_loss: 1855503.0048; train_global_loss: 16133920.2595; train_optim_loss: 16133920.2595; val_kl_reg_loss: 91726.0437; val_edge_recon_loss: 2735711.0833; val_gene_expr_recon_loss: 11544984.2000; val_masked_gp_l1_reg_loss: 110057.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29972.8730; val_chrom_access_recon_loss: 1904930.4500; val_global_loss: 16417382.6000; val_optim_loss: 16417382.6000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9635; val_auprc_score: 0.9539; val_best_acc_score: 0.9061; val_best_f1_score: 0.9096; train_kl_reg_loss: 92047.7937; train_edge_recon_loss: 2718150.9313; train_gene_expr_recon_loss: 11281759.1527; train_masked_gp_l1_reg_loss: 110716.2021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29298.4534; train_chrom_access_recon_loss: 1850764.9208; train_global_loss: 16082737.4351; train_optim_loss: 16082737.4351; val_kl_reg_loss: 89361.5995; val_edge_recon_loss: 2746325.4333; val_gene_expr_recon_loss: 11504276.8000; val_masked_gp_l1_reg_loss: 111499.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28667.0781; val_chrom_access_recon_loss: 1888750.3417; val_global_loss: 16368880.0000; val_optim_loss: 16368880.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9672; val_auprc_score: 0.9583; val_best_acc_score: 0.9116; val_best_f1_score: 0.9158; train_kl_reg_loss: 90606.9574; train_edge_recon_loss: 2719814.6737; train_gene_expr_recon_loss: 11259670.6870; train_masked_gp_l1_reg_loss: 111989.2369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28046.8969; train_chrom_access_recon_loss: 1847116.1670; train_global_loss: 16057244.6336; train_optim_loss: 16057244.6336; val_kl_reg_loss: 90798.0599; val_edge_recon_loss: 2731752.0833; val_gene_expr_recon_loss: 11420979.5333; val_masked_gp_l1_reg_loss: 112606.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27452.1934; val_chrom_access_recon_loss: 1881244.6000; val_global_loss: 16264833.2000; val_optim_loss: 16264833.2000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9709; val_auprc_score: 0.9621; val_best_acc_score: 0.9178; val_best_f1_score: 0.9206; train_kl_reg_loss: 89427.9956; train_edge_recon_loss: 2720921.2385; train_gene_expr_recon_loss: 11237966.0687; train_masked_gp_l1_reg_loss: 113185.6905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26858.4813; train_chrom_access_recon_loss: 1843798.9370; train_global_loss: 16032158.4427; train_optim_loss: 16032158.4427; val_kl_reg_loss: 92695.2214; val_edge_recon_loss: 2712314.1833; val_gene_expr_recon_loss: 11452469.7333; val_masked_gp_l1_reg_loss: 113616.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26207.8242; val_chrom_access_recon_loss: 1881478.6167; val_global_loss: 16278781.7333; val_optim_loss: 16278781.7333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9678; val_auprc_score: 0.9582; val_best_acc_score: 0.9178; val_best_f1_score: 0.9211; train_kl_reg_loss: 89759.1418; train_edge_recon_loss: 2709716.1031; train_gene_expr_recon_loss: 11209079.1603; train_masked_gp_l1_reg_loss: 114153.0273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25713.1865; train_chrom_access_recon_loss: 1840145.3941; train_global_loss: 15988566.0305; train_optim_loss: 15988566.0305; val_kl_reg_loss: 88623.1583; val_edge_recon_loss: 2731800.2833; val_gene_expr_recon_loss: 11371115.6667; val_masked_gp_l1_reg_loss: 114584.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25204.2539; val_chrom_access_recon_loss: 1877528.4000; val_global_loss: 16208856.6000; val_optim_loss: 16208856.6000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9708; val_auprc_score: 0.9600; val_best_acc_score: 0.9208; val_best_f1_score: 0.9241; train_kl_reg_loss: 89317.6480; train_edge_recon_loss: 2710875.3645; train_gene_expr_recon_loss: 11177787.9160; train_masked_gp_l1_reg_loss: 115132.7146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24718.7926; train_chrom_access_recon_loss: 1835361.4933; train_global_loss: 15953193.9542; train_optim_loss: 15953193.9542; val_kl_reg_loss: 90910.9458; val_edge_recon_loss: 2710092.7000; val_gene_expr_recon_loss: 11385806.3333; val_masked_gp_l1_reg_loss: 115645.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24291.7520; val_chrom_access_recon_loss: 1872506.9333; val_global_loss: 16199254.0000; val_optim_loss: 16199254.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9721; val_auprc_score: 0.9611; val_best_acc_score: 0.9263; val_best_f1_score: 0.9283; train_kl_reg_loss: 87771.7341; train_edge_recon_loss: 2709396.4618; train_gene_expr_recon_loss: 11165540.3588; train_masked_gp_l1_reg_loss: 116091.5441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23894.9008; train_chrom_access_recon_loss: 1833863.3635; train_global_loss: 15936558.4656; train_optim_loss: 15936558.4656; val_kl_reg_loss: 88977.3526; val_edge_recon_loss: 2703920.0500; val_gene_expr_recon_loss: 11405285.9333; val_masked_gp_l1_reg_loss: 116598.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23496.2480; val_chrom_access_recon_loss: 1873525.2167; val_global_loss: 16211802.4000; val_optim_loss: 16211802.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9725; val_auprc_score: 0.9614; val_best_acc_score: 0.9270; val_best_f1_score: 0.9288; train_kl_reg_loss: 87263.3712; train_edge_recon_loss: 2706501.4637; train_gene_expr_recon_loss: 11146798.4351; train_masked_gp_l1_reg_loss: 117049.4537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23271.4429; train_chrom_access_recon_loss: 1831374.0973; train_global_loss: 15912258.3053; train_optim_loss: 15912258.3053; val_kl_reg_loss: 88364.4630; val_edge_recon_loss: 2693993.3833; val_gene_expr_recon_loss: 11331677.3333; val_masked_gp_l1_reg_loss: 117622.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23012.3867; val_chrom_access_recon_loss: 1864439.5667; val_global_loss: 16119108.8667; val_optim_loss: 16119108.8667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9116; val_auprc_score: 0.8967; val_best_acc_score: 0.8420; val_best_f1_score: 0.8515; train_kl_reg_loss: 130210.9654; train_edge_recon_loss: 2960395.5420; train_gene_expr_recon_loss: 12287450.6718; train_masked_gp_l1_reg_loss: 120496.5612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19433.7929; train_chrom_access_recon_loss: 1928694.4676; train_global_loss: 17446681.9618; train_optim_loss: 17446681.9618; val_kl_reg_loss: 6142.5687; val_edge_recon_loss: 3179014.9167; val_gene_expr_recon_loss: 12965889.3333; val_masked_gp_l1_reg_loss: 123382.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17983.0176; val_chrom_access_recon_loss: 2007251.5417; val_global_loss: 18299663.7333; val_optim_loss: 18299663.7333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8870; val_auprc_score: 0.8698; val_best_acc_score: 0.8037; val_best_f1_score: 0.8212; train_kl_reg_loss: 59786.2255; train_edge_recon_loss: 2984781.5916; train_gene_expr_recon_loss: 12560247.4885; train_masked_gp_l1_reg_loss: 122977.5216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17667.1557; train_chrom_access_recon_loss: 1951048.8311; train_global_loss: 17696508.9466; train_optim_loss: 17696508.9466; val_kl_reg_loss: 18426.9991; val_edge_recon_loss: 2887579.7500; val_gene_expr_recon_loss: 12676416.3333; val_masked_gp_l1_reg_loss: 120901.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17121.0684; val_chrom_access_recon_loss: 1979308.7167; val_global_loss: 17699754.9333; val_optim_loss: 17699754.9333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9179; val_auprc_score: 0.8977; val_best_acc_score: 0.8514; val_best_f1_score: 0.8632; train_kl_reg_loss: 48343.0988; train_edge_recon_loss: 2897814.9981; train_gene_expr_recon_loss: 12435939.3664; train_masked_gp_l1_reg_loss: 118065.1865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16674.0876; train_chrom_access_recon_loss: 1939145.4628; train_global_loss: 17455982.1756; train_optim_loss: 17455982.1756; val_kl_reg_loss: 7572.6342; val_edge_recon_loss: 2937744.4333; val_gene_expr_recon_loss: 12636119.6000; val_masked_gp_l1_reg_loss: 115896.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16439.6328; val_chrom_access_recon_loss: 1986487.5500; val_global_loss: 17700260.1333; val_optim_loss: 17700260.1333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8974; val_auprc_score: 0.8747; val_best_acc_score: 0.8331; val_best_f1_score: 0.8493; train_kl_reg_loss: 56565.3925; train_edge_recon_loss: 2861401.3263; train_gene_expr_recon_loss: 12355379.7863; train_masked_gp_l1_reg_loss: 114065.8878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16243.3863; train_chrom_access_recon_loss: 1933953.0477; train_global_loss: 17337608.9237; train_optim_loss: 17337608.9237; val_kl_reg_loss: 15482.7598; val_edge_recon_loss: 2838089.0500; val_gene_expr_recon_loss: 12502705.0667; val_masked_gp_l1_reg_loss: 112098.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16035.5098; val_chrom_access_recon_loss: 1971412.0500; val_global_loss: 17455823.8000; val_optim_loss: 17455823.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9003; val_auprc_score: 0.8794; val_best_acc_score: 0.8337; val_best_f1_score: 0.8479; train_kl_reg_loss: 57786.9085; train_edge_recon_loss: 2829216.3931; train_gene_expr_recon_loss: 12322308.2824; train_masked_gp_l1_reg_loss: 111489.7485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15943.0413; train_chrom_access_recon_loss: 1932986.9160; train_global_loss: 17269731.1908; train_optim_loss: 17269731.1908; val_kl_reg_loss: 15914.2240; val_edge_recon_loss: 2847390.5333; val_gene_expr_recon_loss: 12541061.6667; val_masked_gp_l1_reg_loss: 111218.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15912.6865; val_chrom_access_recon_loss: 1979808.6250; val_global_loss: 17511306.0667; val_optim_loss: 17511306.0667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9036; val_auprc_score: 0.8835; val_best_acc_score: 0.8409; val_best_f1_score: 0.8534; train_kl_reg_loss: 57175.1886; train_edge_recon_loss: 2812882.4027; train_gene_expr_recon_loss: 12311355.8244; train_masked_gp_l1_reg_loss: 110970.9293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15889.0557; train_chrom_access_recon_loss: 1930911.6670; train_global_loss: 17239185.0840; train_optim_loss: 17239185.0840; val_kl_reg_loss: 16541.4834; val_edge_recon_loss: 2818493.1333; val_gene_expr_recon_loss: 12551486.4667; val_masked_gp_l1_reg_loss: 110717.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15866.6318; val_chrom_access_recon_loss: 1981170.5083; val_global_loss: 17494276.9333; val_optim_loss: 17494276.9333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8995; val_auprc_score: 0.8781; val_best_acc_score: 0.8352; val_best_f1_score: 0.8497; train_kl_reg_loss: 56329.5063; train_edge_recon_loss: 2810457.8931; train_gene_expr_recon_loss: 12307519.2214; train_masked_gp_l1_reg_loss: 110458.2067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15841.7630; train_chrom_access_recon_loss: 1930848.1326; train_global_loss: 17231454.7252; train_optim_loss: 17231454.7252; val_kl_reg_loss: 17148.2740; val_edge_recon_loss: 2842210.1667; val_gene_expr_recon_loss: 12540578.6667; val_masked_gp_l1_reg_loss: 110182.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15815.7412; val_chrom_access_recon_loss: 1980110.7833; val_global_loss: 17506045.8667; val_optim_loss: 17506045.8667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9089; val_auprc_score: 0.8880; val_best_acc_score: 0.8430; val_best_f1_score: 0.8568; train_kl_reg_loss: 55346.2799; train_edge_recon_loss: 2804352.3149; train_gene_expr_recon_loss: 12301884.0763; train_masked_gp_l1_reg_loss: 109902.5944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15788.1101; train_chrom_access_recon_loss: 1930340.8473; train_global_loss: 17217614.2366; train_optim_loss: 17217614.2366; val_kl_reg_loss: 17568.8823; val_edge_recon_loss: 2807141.0667; val_gene_expr_recon_loss: 12497976.6667; val_masked_gp_l1_reg_loss: 109619.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15762.0439; val_chrom_access_recon_loss: 1970187.4250; val_global_loss: 17418256.0000; val_optim_loss: 17418256.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 45 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9716
val AUPRC score: 0.9642
val best accuracy score: 0.9188
val best F1 score: 0.9230
val target rna MSE score: 4.4730
val source rna MSE score: 4.3524
val target atac MSE score: 0.6199
val source atac MSE score: 0.2366
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
