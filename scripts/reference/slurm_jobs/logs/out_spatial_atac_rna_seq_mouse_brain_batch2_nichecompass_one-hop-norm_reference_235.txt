[True]
Run timestamp: 07092023_015147_235.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_235']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19031 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 21756, n_cat_covariates_embed_input: 0, n_hidden: 2312, n_latent: 2212, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19031
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19031

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7826; val_auprc_score: 0.8038; val_best_acc_score: 0.5864; val_best_f1_score: 0.7002; train_kl_reg_loss: 95639.1952; train_edge_recon_loss: 3583869.1622; train_gene_expr_recon_loss: 13014259.4504; train_masked_gp_l1_reg_loss: 32588.7097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3284058.9998; train_chrom_access_recon_loss: 42988069.0992; train_global_loss: 62998484.7023; train_optim_loss: 62998484.7023; val_kl_reg_loss: 116523.9568; val_edge_recon_loss: 4060632.9167; val_gene_expr_recon_loss: 12038403.9333; val_masked_gp_l1_reg_loss: 29040.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 347275.1875; val_chrom_access_recon_loss: 41323216.5333; val_global_loss: 57915093.3333; val_optim_loss: 57915093.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8542; val_auprc_score: 0.8487; val_best_acc_score: 0.7648; val_best_f1_score: 0.7905; train_kl_reg_loss: 115435.2786; train_edge_recon_loss: 3526315.1355; train_gene_expr_recon_loss: 11819488.1832; train_masked_gp_l1_reg_loss: 28140.1079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 221955.4990; train_chrom_access_recon_loss: 41065825.7099; train_global_loss: 56777159.9084; train_optim_loss: 56777159.9084; val_kl_reg_loss: 91982.4354; val_edge_recon_loss: 3803470.8333; val_gene_expr_recon_loss: 11792958.0000; val_masked_gp_l1_reg_loss: 28763.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157268.7969; val_chrom_access_recon_loss: 40935908.5333; val_global_loss: 56810351.4667; val_optim_loss: 56810351.4667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8562; val_auprc_score: 0.8489; val_best_acc_score: 0.7530; val_best_f1_score: 0.7849; train_kl_reg_loss: 113124.7613; train_edge_recon_loss: 3125996.7443; train_gene_expr_recon_loss: 11632650.5344; train_masked_gp_l1_reg_loss: 30124.6180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135027.5836; train_chrom_access_recon_loss: 40594149.7405; train_global_loss: 55631073.9542; train_optim_loss: 55631073.9542; val_kl_reg_loss: 131147.7865; val_edge_recon_loss: 3036956.6167; val_gene_expr_recon_loss: 11558297.8667; val_masked_gp_l1_reg_loss: 31346.4883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120577.5703; val_chrom_access_recon_loss: 40370898.6667; val_global_loss: 55249224.2667; val_optim_loss: 55249224.2667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8762; val_auprc_score: 0.8611; val_best_acc_score: 0.7947; val_best_f1_score: 0.8135; train_kl_reg_loss: 122856.3921; train_edge_recon_loss: 2972577.6088; train_gene_expr_recon_loss: 11487624.8626; train_masked_gp_l1_reg_loss: 32430.6319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113555.7562; train_chrom_access_recon_loss: 40152867.3282; train_global_loss: 54881912.4275; train_optim_loss: 54881912.4275; val_kl_reg_loss: 116974.7901; val_edge_recon_loss: 2957283.1000; val_gene_expr_recon_loss: 11500722.9333; val_masked_gp_l1_reg_loss: 33494.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108036.8828; val_chrom_access_recon_loss: 40050593.3333; val_global_loss: 54767104.8000; val_optim_loss: 54767104.8000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8858; val_auprc_score: 0.8684; val_best_acc_score: 0.8033; val_best_f1_score: 0.8222; train_kl_reg_loss: 114602.0861; train_edge_recon_loss: 2932143.0611; train_gene_expr_recon_loss: 11372151.4198; train_masked_gp_l1_reg_loss: 34373.9743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104380.9791; train_chrom_access_recon_loss: 39846573.8321; train_global_loss: 54404225.5878; train_optim_loss: 54404225.5878; val_kl_reg_loss: 109314.2000; val_edge_recon_loss: 2918672.7000; val_gene_expr_recon_loss: 11340383.8667; val_masked_gp_l1_reg_loss: 35217.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101948.8984; val_chrom_access_recon_loss: 39596804.5333; val_global_loss: 54102342.1333; val_optim_loss: 54102342.1333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9053; val_auprc_score: 0.8893; val_best_acc_score: 0.8227; val_best_f1_score: 0.8374; train_kl_reg_loss: 109004.8364; train_edge_recon_loss: 2880296.0802; train_gene_expr_recon_loss: 11268510.8473; train_masked_gp_l1_reg_loss: 36015.1119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99670.5997; train_chrom_access_recon_loss: 39459062.0153; train_global_loss: 53852559.4504; train_optim_loss: 53852559.4504; val_kl_reg_loss: 113437.8677; val_edge_recon_loss: 2885249.2167; val_gene_expr_recon_loss: 11234883.5333; val_masked_gp_l1_reg_loss: 36815.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98338.5234; val_chrom_access_recon_loss: 39222635.7333; val_global_loss: 53591361.0667; val_optim_loss: 53591361.0667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9251; val_auprc_score: 0.9118; val_best_acc_score: 0.8488; val_best_f1_score: 0.8593; train_kl_reg_loss: 110479.0630; train_edge_recon_loss: 2829740.3130; train_gene_expr_recon_loss: 11185475.3588; train_masked_gp_l1_reg_loss: 37538.8208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96854.5707; train_chrom_access_recon_loss: 39189604.9160; train_global_loss: 53449693.0992; train_optim_loss: 53449693.0992; val_kl_reg_loss: 109191.7193; val_edge_recon_loss: 2838849.9667; val_gene_expr_recon_loss: 11183309.5333; val_masked_gp_l1_reg_loss: 38380.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95516.8984; val_chrom_access_recon_loss: 39024618.6667; val_global_loss: 53289866.9333; val_optim_loss: 53289866.9333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9332; val_auprc_score: 0.9155; val_best_acc_score: 0.8690; val_best_f1_score: 0.8773; train_kl_reg_loss: 108245.6800; train_edge_recon_loss: 2797946.5592; train_gene_expr_recon_loss: 11101741.5573; train_masked_gp_l1_reg_loss: 38969.1320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94745.5696; train_chrom_access_recon_loss: 38934730.7481; train_global_loss: 53076379.1450; train_optim_loss: 53076379.1450; val_kl_reg_loss: 104148.4135; val_edge_recon_loss: 2816644.0500; val_gene_expr_recon_loss: 11109396.9333; val_masked_gp_l1_reg_loss: 39845.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94192.1562; val_chrom_access_recon_loss: 38886708.2667; val_global_loss: 53050934.4000; val_optim_loss: 53050934.4000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9366; val_auprc_score: 0.9175; val_best_acc_score: 0.8755; val_best_f1_score: 0.8832; train_kl_reg_loss: 106174.0439; train_edge_recon_loss: 2778355.9733; train_gene_expr_recon_loss: 11030484.4122; train_masked_gp_l1_reg_loss: 40403.2374; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93153.0444; train_chrom_access_recon_loss: 38673287.1450; train_global_loss: 52721857.9542; train_optim_loss: 52721857.9542; val_kl_reg_loss: 108036.9500; val_edge_recon_loss: 2795294.8000; val_gene_expr_recon_loss: 11056968.3333; val_masked_gp_l1_reg_loss: 40956.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92909.6484; val_chrom_access_recon_loss: 38701200.2667; val_global_loss: 52795367.4667; val_optim_loss: 52795367.4667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9468; val_auprc_score: 0.9315; val_best_acc_score: 0.8853; val_best_f1_score: 0.8910; train_kl_reg_loss: 105195.1756; train_edge_recon_loss: 2766692.1260; train_gene_expr_recon_loss: 10962579.3282; train_masked_gp_l1_reg_loss: 41581.3694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92315.4495; train_chrom_access_recon_loss: 38392685.0992; train_global_loss: 52361048.6107; train_optim_loss: 52361048.6107; val_kl_reg_loss: 105984.6734; val_edge_recon_loss: 2771012.0667; val_gene_expr_recon_loss: 10955522.4667; val_masked_gp_l1_reg_loss: 42199.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92179.2578; val_chrom_access_recon_loss: 38174325.3333; val_global_loss: 52141222.4000; val_optim_loss: 52141222.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9488; val_auprc_score: 0.9377; val_best_acc_score: 0.8860; val_best_f1_score: 0.8913; train_kl_reg_loss: 104484.9367; train_edge_recon_loss: 2751788.4351; train_gene_expr_recon_loss: 10909522.6718; train_masked_gp_l1_reg_loss: 42647.8421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91693.5103; train_chrom_access_recon_loss: 38203251.4809; train_global_loss: 52103389.2519; train_optim_loss: 52103389.2519; val_kl_reg_loss: 103031.4422; val_edge_recon_loss: 2763698.5000; val_gene_expr_recon_loss: 10951013.2667; val_masked_gp_l1_reg_loss: 43243.8008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91423.7500; val_chrom_access_recon_loss: 38211382.4000; val_global_loss: 52163793.6000; val_optim_loss: 52163793.6000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9506; val_auprc_score: 0.9341; val_best_acc_score: 0.8918; val_best_f1_score: 0.8981; train_kl_reg_loss: 101861.6533; train_edge_recon_loss: 2746674.1622; train_gene_expr_recon_loss: 10857606.1756; train_masked_gp_l1_reg_loss: 43787.5344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90863.1223; train_chrom_access_recon_loss: 37945254.5954; train_global_loss: 51786047.2366; train_optim_loss: 51786047.2366; val_kl_reg_loss: 100474.5464; val_edge_recon_loss: 2757291.0667; val_gene_expr_recon_loss: 10897234.6000; val_masked_gp_l1_reg_loss: 44197.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90839.0312; val_chrom_access_recon_loss: 38267397.8667; val_global_loss: 52157434.9333; val_optim_loss: 52157434.9333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9550; val_auprc_score: 0.9443; val_best_acc_score: 0.8995; val_best_f1_score: 0.9031; train_kl_reg_loss: 99364.6066; train_edge_recon_loss: 2733863.3321; train_gene_expr_recon_loss: 10810351.3130; train_masked_gp_l1_reg_loss: 44698.1481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90384.9433; train_chrom_access_recon_loss: 37754554.0763; train_global_loss: 51533216.3664; train_optim_loss: 51533216.3664; val_kl_reg_loss: 97988.0146; val_edge_recon_loss: 2756394.0833; val_gene_expr_recon_loss: 10835063.2000; val_masked_gp_l1_reg_loss: 45251.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90521.6484; val_chrom_access_recon_loss: 37787140.0000; val_global_loss: 51612359.4667; val_optim_loss: 51612359.4667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9577; val_auprc_score: 0.9477; val_best_acc_score: 0.9014; val_best_f1_score: 0.9053; train_kl_reg_loss: 97500.9399; train_edge_recon_loss: 2731108.9065; train_gene_expr_recon_loss: 10765231.2443; train_masked_gp_l1_reg_loss: 45609.2518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89997.7635; train_chrom_access_recon_loss: 37536658.9313; train_global_loss: 51266107.0840; train_optim_loss: 51266107.0840; val_kl_reg_loss: 96538.4297; val_edge_recon_loss: 2745563.1500; val_gene_expr_recon_loss: 10770602.8667; val_masked_gp_l1_reg_loss: 46061.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90009.1094; val_chrom_access_recon_loss: 37547956.8000; val_global_loss: 51296732.0000; val_optim_loss: 51296732.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9582; val_auprc_score: 0.9463; val_best_acc_score: 0.9043; val_best_f1_score: 0.9094; train_kl_reg_loss: 96322.0867; train_edge_recon_loss: 2722636.4695; train_gene_expr_recon_loss: 10727430.3664; train_masked_gp_l1_reg_loss: 46450.2468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89585.5052; train_chrom_access_recon_loss: 37340424.1221; train_global_loss: 51022848.8855; train_optim_loss: 51022848.8855; val_kl_reg_loss: 94805.5063; val_edge_recon_loss: 2732434.9333; val_gene_expr_recon_loss: 10728366.4667; val_masked_gp_l1_reg_loss: 46868.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89808.9609; val_chrom_access_recon_loss: 37346938.9333; val_global_loss: 51039223.7333; val_optim_loss: 51039223.7333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9607; val_auprc_score: 0.9505; val_best_acc_score: 0.9050; val_best_f1_score: 0.9103; train_kl_reg_loss: 94657.8799; train_edge_recon_loss: 2719693.9046; train_gene_expr_recon_loss: 10694167.0229; train_masked_gp_l1_reg_loss: 47296.2548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89299.8476; train_chrom_access_recon_loss: 37159019.9084; train_global_loss: 50804134.7786; train_optim_loss: 50804134.7786; val_kl_reg_loss: 92434.6839; val_edge_recon_loss: 2736363.8667; val_gene_expr_recon_loss: 10717292.8667; val_masked_gp_l1_reg_loss: 47742.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89381.6250; val_chrom_access_recon_loss: 37212358.6667; val_global_loss: 50895574.1333; val_optim_loss: 50895574.1333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9660; val_auprc_score: 0.9571; val_best_acc_score: 0.9136; val_best_f1_score: 0.9170; train_kl_reg_loss: 93275.5917; train_edge_recon_loss: 2712623.8206; train_gene_expr_recon_loss: 10658000.8092; train_masked_gp_l1_reg_loss: 48023.0161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89032.7091; train_chrom_access_recon_loss: 36953759.0840; train_global_loss: 50554714.9924; train_optim_loss: 50554714.9924; val_kl_reg_loss: 93892.6714; val_edge_recon_loss: 2715917.7333; val_gene_expr_recon_loss: 10649537.3333; val_masked_gp_l1_reg_loss: 48306.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88989.7344; val_chrom_access_recon_loss: 37021914.4000; val_global_loss: 50618559.7333; val_optim_loss: 50618559.7333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9664; val_auprc_score: 0.9594; val_best_acc_score: 0.9154; val_best_f1_score: 0.9193; train_kl_reg_loss: 91628.5109; train_edge_recon_loss: 2719268.4580; train_gene_expr_recon_loss: 10622199.0687; train_masked_gp_l1_reg_loss: 48742.7747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88845.7534; train_chrom_access_recon_loss: 36761384.6718; train_global_loss: 50332069.0687; train_optim_loss: 50332069.0687; val_kl_reg_loss: 91744.7250; val_edge_recon_loss: 2736112.1333; val_gene_expr_recon_loss: 10663325.3333; val_masked_gp_l1_reg_loss: 49023.5820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88639.4688; val_chrom_access_recon_loss: 36930014.9333; val_global_loss: 50558860.2667; val_optim_loss: 50558860.2667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9665; val_auprc_score: 0.9595; val_best_acc_score: 0.9127; val_best_f1_score: 0.9161; train_kl_reg_loss: 90875.4875; train_edge_recon_loss: 2711296.2672; train_gene_expr_recon_loss: 10600702.3282; train_masked_gp_l1_reg_loss: 49339.6396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88724.6319; train_chrom_access_recon_loss: 36625016.0763; train_global_loss: 50165954.3817; train_optim_loss: 50165954.3817; val_kl_reg_loss: 90626.6516; val_edge_recon_loss: 2742524.5500; val_gene_expr_recon_loss: 10613841.3333; val_masked_gp_l1_reg_loss: 49622.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88934.9609; val_chrom_access_recon_loss: 36807025.3333; val_global_loss: 50392575.4667; val_optim_loss: 50392575.4667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9662; val_auprc_score: 0.9591; val_best_acc_score: 0.9123; val_best_f1_score: 0.9156; train_kl_reg_loss: 91433.5287; train_edge_recon_loss: 2708522.9752; train_gene_expr_recon_loss: 10577539.5191; train_masked_gp_l1_reg_loss: 50131.6687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88842.2917; train_chrom_access_recon_loss: 36510846.5038; train_global_loss: 50027316.4580; train_optim_loss: 50027316.4580; val_kl_reg_loss: 90496.8667; val_edge_recon_loss: 2712722.9667; val_gene_expr_recon_loss: 10637638.4000; val_masked_gp_l1_reg_loss: 50363.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89281.2734; val_chrom_access_recon_loss: 36770514.4000; val_global_loss: 50351016.5333; val_optim_loss: 50351016.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9635; val_auprc_score: 0.9527; val_best_acc_score: 0.9130; val_best_f1_score: 0.9165; train_kl_reg_loss: 84971.2292; train_edge_recon_loss: 2721374.6489; train_gene_expr_recon_loss: 10610765.4962; train_masked_gp_l1_reg_loss: 51002.2885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90350.4151; train_chrom_access_recon_loss: 36647414.6565; train_global_loss: 50205878.9008; train_optim_loss: 50205878.9008; val_kl_reg_loss: 82406.5828; val_edge_recon_loss: 2726894.4167; val_gene_expr_recon_loss: 10712571.0000; val_masked_gp_l1_reg_loss: 54624.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97629.9766; val_chrom_access_recon_loss: 37557280.8000; val_global_loss: 51231408.0000; val_optim_loss: 51231408.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9620; val_auprc_score: 0.9525; val_best_acc_score: 0.9085; val_best_f1_score: 0.9119; train_kl_reg_loss: 84078.5702; train_edge_recon_loss: 2726413.0305; train_gene_expr_recon_loss: 10634094.8779; train_masked_gp_l1_reg_loss: 59820.6083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96992.9529; train_chrom_access_recon_loss: 36672409.5115; train_global_loss: 50273809.4351; train_optim_loss: 50273809.4351; val_kl_reg_loss: 86285.2891; val_edge_recon_loss: 2721028.5333; val_gene_expr_recon_loss: 10610769.0000; val_masked_gp_l1_reg_loss: 59345.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94368.8281; val_chrom_access_recon_loss: 36742109.0667; val_global_loss: 50313906.4000; val_optim_loss: 50313906.4000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9657; val_auprc_score: 0.9579; val_best_acc_score: 0.9119; val_best_f1_score: 0.9155; train_kl_reg_loss: 85070.1506; train_edge_recon_loss: 2716545.4656; train_gene_expr_recon_loss: 10538952.1145; train_masked_gp_l1_reg_loss: 58607.3847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92856.1583; train_chrom_access_recon_loss: 36250934.3053; train_global_loss: 49742965.6183; train_optim_loss: 49742965.6183; val_kl_reg_loss: 83773.1745; val_edge_recon_loss: 2724028.8167; val_gene_expr_recon_loss: 10557286.0000; val_masked_gp_l1_reg_loss: 58143.4883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92705.4922; val_chrom_access_recon_loss: 36408382.4000; val_global_loss: 49924318.6667; val_optim_loss: 49924318.6667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9671; val_auprc_score: 0.9595; val_best_acc_score: 0.9135; val_best_f1_score: 0.9168; train_kl_reg_loss: 88012.9262; train_edge_recon_loss: 2719037.1260; train_gene_expr_recon_loss: 10547134.4504; train_masked_gp_l1_reg_loss: 58276.7207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92271.2138; train_chrom_access_recon_loss: 36244309.4656; train_global_loss: 49749041.9847; train_optim_loss: 49749041.9847; val_kl_reg_loss: 90579.5542; val_edge_recon_loss: 2720308.1333; val_gene_expr_recon_loss: 10583151.5333; val_masked_gp_l1_reg_loss: 58402.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91814.8047; val_chrom_access_recon_loss: 36517731.2000; val_global_loss: 50061988.0000; val_optim_loss: 50061988.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9676; val_auprc_score: 0.9583; val_best_acc_score: 0.9122; val_best_f1_score: 0.9147; train_kl_reg_loss: 85813.6168; train_edge_recon_loss: 2712064.0420; train_gene_expr_recon_loss: 10519637.7176; train_masked_gp_l1_reg_loss: 58013.5363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90836.1317; train_chrom_access_recon_loss: 36153784.9771; train_global_loss: 49620150.1069; train_optim_loss: 49620150.1069; val_kl_reg_loss: 86048.6073; val_edge_recon_loss: 2710375.1000; val_gene_expr_recon_loss: 10559396.1333; val_masked_gp_l1_reg_loss: 57698.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90303.0859; val_chrom_access_recon_loss: 36266343.7333; val_global_loss: 49770164.5333; val_optim_loss: 49770164.5333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9719; val_auprc_score: 0.9645; val_best_acc_score: 0.9201; val_best_f1_score: 0.9219; train_kl_reg_loss: 89905.3384; train_edge_recon_loss: 2709443.1069; train_gene_expr_recon_loss: 10506929.4504; train_masked_gp_l1_reg_loss: 57553.6853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89695.4222; train_chrom_access_recon_loss: 36040196.9466; train_global_loss: 49493723.9084; train_optim_loss: 49493723.9084; val_kl_reg_loss: 91446.9734; val_edge_recon_loss: 2693371.4167; val_gene_expr_recon_loss: 10533255.6667; val_masked_gp_l1_reg_loss: 57359.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89184.5547; val_chrom_access_recon_loss: 36225041.0667; val_global_loss: 49689660.2667; val_optim_loss: 49689660.2667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9689; val_auprc_score: 0.9616; val_best_acc_score: 0.9181; val_best_f1_score: 0.9204; train_kl_reg_loss: 88050.0689; train_edge_recon_loss: 2707815.5076; train_gene_expr_recon_loss: 10485045.8015; train_masked_gp_l1_reg_loss: 57277.3240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89020.4085; train_chrom_access_recon_loss: 35893623.4046; train_global_loss: 49320832.4885; train_optim_loss: 49320832.4885; val_kl_reg_loss: 87762.8401; val_edge_recon_loss: 2718637.9000; val_gene_expr_recon_loss: 10497829.1333; val_masked_gp_l1_reg_loss: 57273.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89016.0000; val_chrom_access_recon_loss: 35991897.3333; val_global_loss: 49442415.7333; val_optim_loss: 49442415.7333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9694; val_auprc_score: 0.9625; val_best_acc_score: 0.9186; val_best_f1_score: 0.9220; train_kl_reg_loss: 89643.2200; train_edge_recon_loss: 2713095.1069; train_gene_expr_recon_loss: 10512254.5267; train_masked_gp_l1_reg_loss: 57643.1028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88099.7761; train_chrom_access_recon_loss: 35952492.5191; train_global_loss: 49413228.2443; train_optim_loss: 49413228.2443; val_kl_reg_loss: 91330.1766; val_edge_recon_loss: 2710651.4500; val_gene_expr_recon_loss: 10475929.5333; val_masked_gp_l1_reg_loss: 57519.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89312.4141; val_chrom_access_recon_loss: 36100253.0667; val_global_loss: 49524994.9333; val_optim_loss: 49524994.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9742; val_auprc_score: 0.9666; val_best_acc_score: 0.9232; val_best_f1_score: 0.9256; train_kl_reg_loss: 91107.0347; train_edge_recon_loss: 2692025.2500; train_gene_expr_recon_loss: 10439220.2214; train_masked_gp_l1_reg_loss: 57395.6974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88803.8030; train_chrom_access_recon_loss: 35699782.3206; train_global_loss: 49068334.3817; train_optim_loss: 49068334.3817; val_kl_reg_loss: 89004.6406; val_edge_recon_loss: 2706693.6000; val_gene_expr_recon_loss: 10455724.8667; val_masked_gp_l1_reg_loss: 57332.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88964.4297; val_chrom_access_recon_loss: 35976029.0667; val_global_loss: 49373748.8000; val_optim_loss: 49373748.8000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9708; val_auprc_score: 0.9635; val_best_acc_score: 0.9167; val_best_f1_score: 0.9192; train_kl_reg_loss: 88334.7528; train_edge_recon_loss: 2704601.2443; train_gene_expr_recon_loss: 10429116.6947; train_masked_gp_l1_reg_loss: 57372.8983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88587.2015; train_chrom_access_recon_loss: 35651551.7863; train_global_loss: 49019564.7634; train_optim_loss: 49019564.7634; val_kl_reg_loss: 90417.9964; val_edge_recon_loss: 2724621.1500; val_gene_expr_recon_loss: 10495658.8667; val_masked_gp_l1_reg_loss: 57241.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90015.8359; val_chrom_access_recon_loss: 36125885.6000; val_global_loss: 49583841.6000; val_optim_loss: 49583841.6000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9715; val_auprc_score: 0.9640; val_best_acc_score: 0.9163; val_best_f1_score: 0.9191; train_kl_reg_loss: 90156.4380; train_edge_recon_loss: 2696551.7347; train_gene_expr_recon_loss: 10421160.2519; train_masked_gp_l1_reg_loss: 57283.7353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88758.1430; train_chrom_access_recon_loss: 35583867.2366; train_global_loss: 48937777.6794; train_optim_loss: 48937777.6794; val_kl_reg_loss: 87641.6453; val_edge_recon_loss: 2749198.8167; val_gene_expr_recon_loss: 10487312.9333; val_masked_gp_l1_reg_loss: 57356.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88823.9375; val_chrom_access_recon_loss: 36038352.8000; val_global_loss: 49508686.9333; val_optim_loss: 49508686.9333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9713; val_auprc_score: 0.9634; val_best_acc_score: 0.9197; val_best_f1_score: 0.9221; train_kl_reg_loss: 88400.5372; train_edge_recon_loss: 2698791.8416; train_gene_expr_recon_loss: 10400133.0229; train_masked_gp_l1_reg_loss: 57117.0886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88864.2751; train_chrom_access_recon_loss: 35437904.5038; train_global_loss: 48771211.3588; train_optim_loss: 48771211.3588; val_kl_reg_loss: 88233.3828; val_edge_recon_loss: 2726714.4333; val_gene_expr_recon_loss: 10456548.2667; val_masked_gp_l1_reg_loss: 57065.0039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88834.9531; val_chrom_access_recon_loss: 35872948.0000; val_global_loss: 49290343.7333; val_optim_loss: 49290343.7333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9756; val_auprc_score: 0.9700; val_best_acc_score: 0.9276; val_best_f1_score: 0.9300; train_kl_reg_loss: 87369.7229; train_edge_recon_loss: 2701960.1565; train_gene_expr_recon_loss: 10395532.8168; train_masked_gp_l1_reg_loss: 56926.9332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88711.2478; train_chrom_access_recon_loss: 35441090.8397; train_global_loss: 48771591.7863; train_optim_loss: 48771591.7863; val_kl_reg_loss: 86869.0255; val_edge_recon_loss: 2696621.4167; val_gene_expr_recon_loss: 10476294.0667; val_masked_gp_l1_reg_loss: 56859.6367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89007.6172; val_chrom_access_recon_loss: 35950524.5333; val_global_loss: 49356176.8000; val_optim_loss: 49356176.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9716; val_auprc_score: 0.9647; val_best_acc_score: 0.9241; val_best_f1_score: 0.9267; train_kl_reg_loss: 556807.2344; train_edge_recon_loss: 2719782.5954; train_gene_expr_recon_loss: 10439422.6794; train_masked_gp_l1_reg_loss: 56876.1498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87445.9534; train_chrom_access_recon_loss: 35759479.0229; train_global_loss: 49619813.6183; train_optim_loss: 49619813.6183; val_kl_reg_loss: 96141.2911; val_edge_recon_loss: 2753640.1500; val_gene_expr_recon_loss: 10524718.7333; val_masked_gp_l1_reg_loss: 57778.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86869.7500; val_chrom_access_recon_loss: 36161268.8000; val_global_loss: 49680417.8667; val_optim_loss: 49680417.8667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9662; val_auprc_score: 0.9586; val_best_acc_score: 0.9109; val_best_f1_score: 0.9145; train_kl_reg_loss: 353996.5664; train_edge_recon_loss: 2752465.1889; train_gene_expr_recon_loss: 10496667.1985; train_masked_gp_l1_reg_loss: 59905.7212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90052.1336; train_chrom_access_recon_loss: 35983405.9389; train_global_loss: 49736492.5802; train_optim_loss: 49736492.5802; val_kl_reg_loss: 95980.0125; val_edge_recon_loss: 2748497.9167; val_gene_expr_recon_loss: 10456963.0000; val_masked_gp_l1_reg_loss: 59457.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92556.9922; val_chrom_access_recon_loss: 35890798.4000; val_global_loss: 49344253.3333; val_optim_loss: 49344253.3333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9720; val_auprc_score: 0.9635; val_best_acc_score: 0.9192; val_best_f1_score: 0.9227; train_kl_reg_loss: 100165.8312; train_edge_recon_loss: 2714991.9008; train_gene_expr_recon_loss: 10537317.6947; train_masked_gp_l1_reg_loss: 60391.3573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90136.6593; train_chrom_access_recon_loss: 35637693.4962; train_global_loss: 49140696.8244; train_optim_loss: 49140696.8244; val_kl_reg_loss: 97434.4094; val_edge_recon_loss: 2718960.4833; val_gene_expr_recon_loss: 10524287.6667; val_masked_gp_l1_reg_loss: 60200.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89857.9688; val_chrom_access_recon_loss: 35838736.8000; val_global_loss: 49329477.0667; val_optim_loss: 49329477.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9725; val_auprc_score: 0.9658; val_best_acc_score: 0.9223; val_best_f1_score: 0.9249; train_kl_reg_loss: 96667.7826; train_edge_recon_loss: 2703991.6336; train_gene_expr_recon_loss: 10469685.9618; train_masked_gp_l1_reg_loss: 59229.1206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67843.5926; train_chrom_access_recon_loss: 35438515.3282; train_global_loss: 48835933.4046; train_optim_loss: 48835933.4046; val_kl_reg_loss: 97149.3010; val_edge_recon_loss: 2712216.5167; val_gene_expr_recon_loss: 10481621.9333; val_masked_gp_l1_reg_loss: 58652.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65644.5781; val_chrom_access_recon_loss: 35652423.8667; val_global_loss: 49067708.8000; val_optim_loss: 49067708.8000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9706; val_auprc_score: 0.9617; val_best_acc_score: 0.9184; val_best_f1_score: 0.9215; train_kl_reg_loss: 97070.8094; train_edge_recon_loss: 2702307.4179; train_gene_expr_recon_loss: 10425707.8015; train_masked_gp_l1_reg_loss: 58428.7999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65321.4664; train_chrom_access_recon_loss: 35379452.6870; train_global_loss: 48728289.1908; train_optim_loss: 48728289.1908; val_kl_reg_loss: 97320.9964; val_edge_recon_loss: 2718598.5167; val_gene_expr_recon_loss: 10455567.1333; val_masked_gp_l1_reg_loss: 58280.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65182.6250; val_chrom_access_recon_loss: 35686853.3333; val_global_loss: 49081804.0000; val_optim_loss: 49081804.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9701; val_auprc_score: 0.9611; val_best_acc_score: 0.9190; val_best_f1_score: 0.9225; train_kl_reg_loss: 96960.5219; train_edge_recon_loss: 2704637.3836; train_gene_expr_recon_loss: 10407389.5725; train_masked_gp_l1_reg_loss: 58173.5477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65164.0399; train_chrom_access_recon_loss: 35350663.4656; train_global_loss: 48682988.6107; train_optim_loss: 48682988.6107; val_kl_reg_loss: 97132.2620; val_edge_recon_loss: 2709584.5000; val_gene_expr_recon_loss: 10451294.9333; val_masked_gp_l1_reg_loss: 58057.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64884.7188; val_chrom_access_recon_loss: 35683962.6667; val_global_loss: 49064917.6000; val_optim_loss: 49064917.6000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9697; val_auprc_score: 0.9613; val_best_acc_score: 0.9209; val_best_f1_score: 0.9235; train_kl_reg_loss: 96978.5980; train_edge_recon_loss: 2695033.8531; train_gene_expr_recon_loss: 10398592.2061; train_masked_gp_l1_reg_loss: 57989.0590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64665.5470; train_chrom_access_recon_loss: 35319802.7023; train_global_loss: 48633061.9542; train_optim_loss: 48633061.9542; val_kl_reg_loss: 97899.6641; val_edge_recon_loss: 2718906.1667; val_gene_expr_recon_loss: 10437689.2000; val_masked_gp_l1_reg_loss: 57908.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64457.6797; val_chrom_access_recon_loss: 35718027.3333; val_global_loss: 49094888.5333; val_optim_loss: 49094888.5333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9706; val_auprc_score: 0.9653; val_best_acc_score: 0.9166; val_best_f1_score: 0.9198; train_kl_reg_loss: 97129.8622; train_edge_recon_loss: 2702197.3111; train_gene_expr_recon_loss: 10384002.7863; train_masked_gp_l1_reg_loss: 57868.8137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64289.9639; train_chrom_access_recon_loss: 35286274.9313; train_global_loss: 48591763.7863; train_optim_loss: 48591763.7863; val_kl_reg_loss: 98130.3542; val_edge_recon_loss: 2719201.8333; val_gene_expr_recon_loss: 10429844.2667; val_masked_gp_l1_reg_loss: 57807.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64189.7109; val_chrom_access_recon_loss: 35744148.2667; val_global_loss: 49113323.2000; val_optim_loss: 49113323.2000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9690; val_auprc_score: 0.9613; val_best_acc_score: 0.9194; val_best_f1_score: 0.9229; train_kl_reg_loss: 97259.7507; train_edge_recon_loss: 2698827.7443; train_gene_expr_recon_loss: 10378561.8397; train_masked_gp_l1_reg_loss: 57760.1996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63928.5748; train_chrom_access_recon_loss: 35293858.5191; train_global_loss: 48590196.6718; train_optim_loss: 48590196.6718; val_kl_reg_loss: 98059.9464; val_edge_recon_loss: 2698991.1500; val_gene_expr_recon_loss: 10420948.5333; val_masked_gp_l1_reg_loss: 57695.5820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63644.9375; val_chrom_access_recon_loss: 35625739.4667; val_global_loss: 48965080.5333; val_optim_loss: 48965080.5333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9730; val_auprc_score: 0.9669; val_best_acc_score: 0.9216; val_best_f1_score: 0.9243; train_kl_reg_loss: 97137.8923; train_edge_recon_loss: 2700764.5057; train_gene_expr_recon_loss: 10367446.1908; train_masked_gp_l1_reg_loss: 57656.0314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63533.1318; train_chrom_access_recon_loss: 35237245.0534; train_global_loss: 48523782.8397; train_optim_loss: 48523782.8397; val_kl_reg_loss: 96744.4755; val_edge_recon_loss: 2698931.2333; val_gene_expr_recon_loss: 10396546.6000; val_masked_gp_l1_reg_loss: 57610.1211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63479.6680; val_chrom_access_recon_loss: 35499234.2667; val_global_loss: 48812546.6667; val_optim_loss: 48812546.6667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9735; val_auprc_score: 0.9647; val_best_acc_score: 0.9290; val_best_f1_score: 0.9316; train_kl_reg_loss: 98746.1112; train_edge_recon_loss: 2706008.1279; train_gene_expr_recon_loss: 10369772.4656; train_masked_gp_l1_reg_loss: 57579.2923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63400.0898; train_chrom_access_recon_loss: 35272341.8779; train_global_loss: 48567848.0000; train_optim_loss: 48567848.0000; val_kl_reg_loss: 97296.1349; val_edge_recon_loss: 2676967.9167; val_gene_expr_recon_loss: 10396885.5333; val_masked_gp_l1_reg_loss: 57520.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63206.0312; val_chrom_access_recon_loss: 35621421.0667; val_global_loss: 48913296.5333; val_optim_loss: 48913296.5333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9712; val_auprc_score: 0.9618; val_best_acc_score: 0.9224; val_best_f1_score: 0.9250; train_kl_reg_loss: 96787.3907; train_edge_recon_loss: 2695906.4485; train_gene_expr_recon_loss: 10363934.6641; train_masked_gp_l1_reg_loss: 57483.8152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63138.4065; train_chrom_access_recon_loss: 35230734.2901; train_global_loss: 48507985.0382; train_optim_loss: 48507985.0382; val_kl_reg_loss: 96774.6068; val_edge_recon_loss: 2711667.3833; val_gene_expr_recon_loss: 10398606.8667; val_masked_gp_l1_reg_loss: 57434.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62975.2656; val_chrom_access_recon_loss: 35548258.4000; val_global_loss: 48875716.2667; val_optim_loss: 48875716.2667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9706; val_auprc_score: 0.9634; val_best_acc_score: 0.9201; val_best_f1_score: 0.9237; train_kl_reg_loss: 96853.3099; train_edge_recon_loss: 2691906.1469; train_gene_expr_recon_loss: 10371540.2366; train_masked_gp_l1_reg_loss: 57403.5953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62832.1760; train_chrom_access_recon_loss: 35249353.6641; train_global_loss: 48529889.2519; train_optim_loss: 48529889.2519; val_kl_reg_loss: 96634.2375; val_edge_recon_loss: 2709838.6333; val_gene_expr_recon_loss: 10403569.4000; val_masked_gp_l1_reg_loss: 57339.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62692.4062; val_chrom_access_recon_loss: 35570776.2667; val_global_loss: 48900850.6667; val_optim_loss: 48900850.6667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9688; val_auprc_score: 0.9586; val_best_acc_score: 0.9163; val_best_f1_score: 0.9196; train_kl_reg_loss: 96691.4714; train_edge_recon_loss: 2698969.1355; train_gene_expr_recon_loss: 10359488.1145; train_masked_gp_l1_reg_loss: 57322.8378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62646.7333; train_chrom_access_recon_loss: 35211188.4580; train_global_loss: 48486306.7176; train_optim_loss: 48486306.7176; val_kl_reg_loss: 96809.0865; val_edge_recon_loss: 2733314.5000; val_gene_expr_recon_loss: 10407748.6000; val_masked_gp_l1_reg_loss: 57276.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62617.9219; val_chrom_access_recon_loss: 35578926.0000; val_global_loss: 48936692.8000; val_optim_loss: 48936692.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9731; val_auprc_score: 0.9660; val_best_acc_score: 0.9196; val_best_f1_score: 0.9222; train_kl_reg_loss: 96140.4110; train_edge_recon_loss: 2698272.6107; train_gene_expr_recon_loss: 10356688.0000; train_masked_gp_l1_reg_loss: 57184.8094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60415.6417; train_chrom_access_recon_loss: 35251115.9084; train_global_loss: 48519817.2519; train_optim_loss: 48519817.2519; val_kl_reg_loss: 96902.0688; val_edge_recon_loss: 2706661.7667; val_gene_expr_recon_loss: 10445751.4000; val_masked_gp_l1_reg_loss: 57116.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60198.5391; val_chrom_access_recon_loss: 35768506.8000; val_global_loss: 49135136.8000; val_optim_loss: 49135136.8000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9709; val_auprc_score: 0.9646; val_best_acc_score: 0.9182; val_best_f1_score: 0.9201; train_kl_reg_loss: 96270.8644; train_edge_recon_loss: 2696696.1355; train_gene_expr_recon_loss: 10353058.2672; train_masked_gp_l1_reg_loss: 57084.5077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60165.8038; train_chrom_access_recon_loss: 35177679.7252; train_global_loss: 48440955.2366; train_optim_loss: 48440955.2366; val_kl_reg_loss: 96933.1250; val_edge_recon_loss: 2717633.9833; val_gene_expr_recon_loss: 10399914.1333; val_masked_gp_l1_reg_loss: 57057.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60141.1680; val_chrom_access_recon_loss: 35633373.8667; val_global_loss: 48965054.4000; val_optim_loss: 48965054.4000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9694; val_auprc_score: 0.9618; val_best_acc_score: 0.9169; val_best_f1_score: 0.9190; train_kl_reg_loss: 96390.5493; train_edge_recon_loss: 2694207.5802; train_gene_expr_recon_loss: 10361496.1603; train_masked_gp_l1_reg_loss: 57039.8069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60120.5338; train_chrom_access_recon_loss: 35216077.6183; train_global_loss: 48485332.3664; train_optim_loss: 48485332.3664; val_kl_reg_loss: 96581.0266; val_edge_recon_loss: 2711908.8667; val_gene_expr_recon_loss: 10420305.8667; val_masked_gp_l1_reg_loss: 57022.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60102.3477; val_chrom_access_recon_loss: 35659344.8000; val_global_loss: 49005265.6000; val_optim_loss: 49005265.6000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9709; val_auprc_score: 0.9622; val_best_acc_score: 0.9197; val_best_f1_score: 0.9225; train_kl_reg_loss: 96369.5639; train_edge_recon_loss: 2698507.5076; train_gene_expr_recon_loss: 10353727.7328; train_masked_gp_l1_reg_loss: 57013.4427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60075.9708; train_chrom_access_recon_loss: 35186173.7710; train_global_loss: 48451867.9695; train_optim_loss: 48451867.9695; val_kl_reg_loss: 96885.1115; val_edge_recon_loss: 2701534.5167; val_gene_expr_recon_loss: 10408810.8667; val_masked_gp_l1_reg_loss: 56999.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60056.0508; val_chrom_access_recon_loss: 35615739.7333; val_global_loss: 48940026.1333; val_optim_loss: 48940026.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 117 min 55 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9723
val AUPRC score: 0.9658
val best accuracy score: 0.9241
val best F1 score: 0.9272
val target rna MSE score: 2.0382
val source rna MSE score: 0.4599
val target atac MSE score: 0.2236
val source atac MSE score: 0.0201
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
