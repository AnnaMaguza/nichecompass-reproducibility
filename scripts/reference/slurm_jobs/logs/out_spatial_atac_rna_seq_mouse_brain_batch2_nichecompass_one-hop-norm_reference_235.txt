[True]
Run timestamp: 10102023_103615_235.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_235']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7098; val_auprc_score: 0.6852; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 62153.3575; train_edge_recon_loss: 748023.1316; train_gene_expr_recon_loss: 23144949.0000; train_masked_gp_l1_reg_loss: 59106.7340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6062400.8144; train_chrom_access_recon_loss: 2961485.7424; train_global_loss: 33038118.6364; train_optim_loss: 33038118.6364; val_kl_reg_loss: 80810.2246; val_edge_recon_loss: 813174.3594; val_gene_expr_recon_loss: 21420102.2500; val_masked_gp_l1_reg_loss: 64940.9258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3355566.7500; val_chrom_access_recon_loss: 2816993.0312; val_global_loss: 28551586.0000; val_optim_loss: 28551586.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7133; val_auprc_score: 0.6883; val_best_acc_score: 0.6002; val_best_f1_score: 0.7000; train_kl_reg_loss: 86623.3103; train_edge_recon_loss: 748884.2188; train_gene_expr_recon_loss: 21350335.4242; train_masked_gp_l1_reg_loss: 63193.4351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1823328.4366; train_chrom_access_recon_loss: 2828579.6098; train_global_loss: 26900944.2727; train_optim_loss: 26900944.2727; val_kl_reg_loss: 88297.8408; val_edge_recon_loss: 811908.1250; val_gene_expr_recon_loss: 20885727.7500; val_masked_gp_l1_reg_loss: 62361.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 874190.6875; val_chrom_access_recon_loss: 2786726.1250; val_global_loss: 25509212.0000; val_optim_loss: 25509212.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7736; val_auprc_score: 0.7607; val_best_acc_score: 0.6943; val_best_f1_score: 0.7153; train_kl_reg_loss: 80683.2151; train_edge_recon_loss: 737537.2244; train_gene_expr_recon_loss: 21132972.6667; train_masked_gp_l1_reg_loss: 62346.8310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 574540.5606; train_chrom_access_recon_loss: 2812071.4659; train_global_loss: 25400152.0909; train_optim_loss: 25400152.0909; val_kl_reg_loss: 72735.5479; val_edge_recon_loss: 804379.6797; val_gene_expr_recon_loss: 20941101.0000; val_masked_gp_l1_reg_loss: 62788.9258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 384010.1562; val_chrom_access_recon_loss: 2787157.2812; val_global_loss: 25052172.0000; val_optim_loss: 25052172.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8251; val_auprc_score: 0.8005; val_best_acc_score: 0.7520; val_best_f1_score: 0.7596; train_kl_reg_loss: 72994.9926; train_edge_recon_loss: 727074.6051; train_gene_expr_recon_loss: 20968477.4848; train_masked_gp_l1_reg_loss: 63675.3794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 304613.3213; train_chrom_access_recon_loss: 2795109.3409; train_global_loss: 24931945.3030; train_optim_loss: 24931945.3030; val_kl_reg_loss: 68699.0059; val_edge_recon_loss: 772271.2812; val_gene_expr_recon_loss: 20565873.2500; val_masked_gp_l1_reg_loss: 65055.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 246712.2344; val_chrom_access_recon_loss: 2734804.5000; val_global_loss: 24453416.0000; val_optim_loss: 24453416.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8718; val_auprc_score: 0.8560; val_best_acc_score: 0.7912; val_best_f1_score: 0.8060; train_kl_reg_loss: 69762.6741; train_edge_recon_loss: 700868.6676; train_gene_expr_recon_loss: 20804659.3030; train_masked_gp_l1_reg_loss: 66276.0357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 217744.1082; train_chrom_access_recon_loss: 2776803.2803; train_global_loss: 24636113.9091; train_optim_loss: 24636113.9091; val_kl_reg_loss: 70875.1230; val_edge_recon_loss: 695872.9531; val_gene_expr_recon_loss: 20441793.7500; val_masked_gp_l1_reg_loss: 67940.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 199990.3281; val_chrom_access_recon_loss: 2743670.7188; val_global_loss: 24220143.0000; val_optim_loss: 24220143.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8917; val_auprc_score: 0.8592; val_best_acc_score: 0.8165; val_best_f1_score: 0.8278; train_kl_reg_loss: 77256.6967; train_edge_recon_loss: 653156.2263; train_gene_expr_recon_loss: 20638541.7879; train_masked_gp_l1_reg_loss: 69374.4889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186352.1188; train_chrom_access_recon_loss: 2762560.5985; train_global_loss: 24387242.2424; train_optim_loss: 24387242.2424; val_kl_reg_loss: 82369.6377; val_edge_recon_loss: 638641.6875; val_gene_expr_recon_loss: 20651141.5000; val_masked_gp_l1_reg_loss: 70874.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174799.1250; val_chrom_access_recon_loss: 2746222.1250; val_global_loss: 24364048.7500; val_optim_loss: 24364048.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8944; val_auprc_score: 0.8691; val_best_acc_score: 0.8272; val_best_f1_score: 0.8385; train_kl_reg_loss: 82205.1235; train_edge_recon_loss: 628792.7311; train_gene_expr_recon_loss: 20530468.2727; train_masked_gp_l1_reg_loss: 72133.0561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 164001.7514; train_chrom_access_recon_loss: 2751575.0530; train_global_loss: 24229176.0909; train_optim_loss: 24229176.0909; val_kl_reg_loss: 81639.9570; val_edge_recon_loss: 631290.8438; val_gene_expr_recon_loss: 20361527.7500; val_masked_gp_l1_reg_loss: 73284.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155998.5000; val_chrom_access_recon_loss: 2713054.3438; val_global_loss: 24016794.7500; val_optim_loss: 24016794.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8947; val_auprc_score: 0.8651; val_best_acc_score: 0.8259; val_best_f1_score: 0.8393; train_kl_reg_loss: 81662.8016; train_edge_recon_loss: 618379.3892; train_gene_expr_recon_loss: 20429272.6364; train_masked_gp_l1_reg_loss: 74400.3050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148381.7176; train_chrom_access_recon_loss: 2737196.0227; train_global_loss: 24089292.7879; train_optim_loss: 24089292.7879; val_kl_reg_loss: 81301.5361; val_edge_recon_loss: 623051.0312; val_gene_expr_recon_loss: 20301577.7500; val_masked_gp_l1_reg_loss: 75408.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141839.3438; val_chrom_access_recon_loss: 2717266.1250; val_global_loss: 23940444.7500; val_optim_loss: 23940444.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9061; val_auprc_score: 0.8712; val_best_acc_score: 0.8439; val_best_f1_score: 0.8547; train_kl_reg_loss: 80022.9521; train_edge_recon_loss: 611802.0492; train_gene_expr_recon_loss: 20351075.5455; train_masked_gp_l1_reg_loss: 76258.7119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137659.5552; train_chrom_access_recon_loss: 2729485.7992; train_global_loss: 23986304.1818; train_optim_loss: 23986304.1818; val_kl_reg_loss: 80759.0771; val_edge_recon_loss: 612369.7812; val_gene_expr_recon_loss: 20153469.7500; val_masked_gp_l1_reg_loss: 76962.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134675.7188; val_chrom_access_recon_loss: 2696033.3438; val_global_loss: 23754270.0000; val_optim_loss: 23754270.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9003; val_auprc_score: 0.8691; val_best_acc_score: 0.8307; val_best_f1_score: 0.8474; train_kl_reg_loss: 77852.8902; train_edge_recon_loss: 610817.6856; train_gene_expr_recon_loss: 20284348.1515; train_masked_gp_l1_reg_loss: 77612.4179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130942.5123; train_chrom_access_recon_loss: 2723123.2765; train_global_loss: 23904697.0606; train_optim_loss: 23904697.0606; val_kl_reg_loss: 76721.9297; val_edge_recon_loss: 617346.1484; val_gene_expr_recon_loss: 20097417.7500; val_masked_gp_l1_reg_loss: 78331.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129583.8906; val_chrom_access_recon_loss: 2675021.7812; val_global_loss: 23674424.0000; val_optim_loss: 23674424.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9121; val_auprc_score: 0.8792; val_best_acc_score: 0.8455; val_best_f1_score: 0.8552; train_kl_reg_loss: 76311.1010; train_edge_recon_loss: 607762.7367; train_gene_expr_recon_loss: 20189439.3333; train_masked_gp_l1_reg_loss: 78918.1470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127387.9350; train_chrom_access_recon_loss: 2710706.7538; train_global_loss: 23790526.0909; train_optim_loss: 23790526.0909; val_kl_reg_loss: 76221.9648; val_edge_recon_loss: 608471.2422; val_gene_expr_recon_loss: 19887250.5000; val_masked_gp_l1_reg_loss: 79391.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124908.5938; val_chrom_access_recon_loss: 2678697.3750; val_global_loss: 23454941.2500; val_optim_loss: 23454941.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9106; val_auprc_score: 0.8905; val_best_acc_score: 0.8412; val_best_f1_score: 0.8519; train_kl_reg_loss: 74446.8452; train_edge_recon_loss: 604346.2708; train_gene_expr_recon_loss: 20107838.6667; train_masked_gp_l1_reg_loss: 80001.4263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123416.2466; train_chrom_access_recon_loss: 2701041.8674; train_global_loss: 23691091.0909; train_optim_loss: 23691091.0909; val_kl_reg_loss: 72704.8301; val_edge_recon_loss: 613302.8984; val_gene_expr_recon_loss: 19977672.5000; val_masked_gp_l1_reg_loss: 80551.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123011.6094; val_chrom_access_recon_loss: 2664633.5000; val_global_loss: 23531878.2500; val_optim_loss: 23531878.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9186; val_auprc_score: 0.8867; val_best_acc_score: 0.8512; val_best_f1_score: 0.8608; train_kl_reg_loss: 73250.3222; train_edge_recon_loss: 602903.8239; train_gene_expr_recon_loss: 20029081.2424; train_masked_gp_l1_reg_loss: 81121.3545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120967.4875; train_chrom_access_recon_loss: 2689664.1477; train_global_loss: 23596988.3333; train_optim_loss: 23596988.3333; val_kl_reg_loss: 73611.8691; val_edge_recon_loss: 604272.2578; val_gene_expr_recon_loss: 19925773.7500; val_masked_gp_l1_reg_loss: 81685.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120236.7344; val_chrom_access_recon_loss: 2657108.0312; val_global_loss: 23462688.0000; val_optim_loss: 23462688.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9246; val_auprc_score: 0.9020; val_best_acc_score: 0.8522; val_best_f1_score: 0.8622; train_kl_reg_loss: 72865.7459; train_edge_recon_loss: 598437.0104; train_gene_expr_recon_loss: 19974320.7879; train_masked_gp_l1_reg_loss: 82157.4871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118750.4654; train_chrom_access_recon_loss: 2682332.1402; train_global_loss: 23528863.6667; train_optim_loss: 23528863.6667; val_kl_reg_loss: 71649.3750; val_edge_recon_loss: 608071.1719; val_gene_expr_recon_loss: 19787214.7500; val_masked_gp_l1_reg_loss: 82686.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117521.6406; val_chrom_access_recon_loss: 2626950.0000; val_global_loss: 23294093.2500; val_optim_loss: 23294093.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9304; val_auprc_score: 0.9129; val_best_acc_score: 0.8635; val_best_f1_score: 0.8722; train_kl_reg_loss: 71381.8145; train_edge_recon_loss: 598733.9034; train_gene_expr_recon_loss: 19906778.2727; train_masked_gp_l1_reg_loss: 83171.5058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116353.4203; train_chrom_access_recon_loss: 2676049.4356; train_global_loss: 23452468.1515; train_optim_loss: 23452468.1515; val_kl_reg_loss: 70926.9082; val_edge_recon_loss: 604464.1953; val_gene_expr_recon_loss: 19673376.0000; val_masked_gp_l1_reg_loss: 83845.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116341.9531; val_chrom_access_recon_loss: 2643611.3438; val_global_loss: 23192566.5000; val_optim_loss: 23192566.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9353; val_auprc_score: 0.9173; val_best_acc_score: 0.8708; val_best_f1_score: 0.8787; train_kl_reg_loss: 70953.6353; train_edge_recon_loss: 595974.0180; train_gene_expr_recon_loss: 19861453.2727; train_masked_gp_l1_reg_loss: 84036.8685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114769.7135; train_chrom_access_recon_loss: 2667472.2614; train_global_loss: 23394659.7879; train_optim_loss: 23394659.7879; val_kl_reg_loss: 69777.6162; val_edge_recon_loss: 598400.2266; val_gene_expr_recon_loss: 19548103.2500; val_masked_gp_l1_reg_loss: 84664.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114265.0156; val_chrom_access_recon_loss: 2611210.0625; val_global_loss: 23026421.2500; val_optim_loss: 23026421.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9378; val_auprc_score: 0.9230; val_best_acc_score: 0.8705; val_best_f1_score: 0.8772; train_kl_reg_loss: 69895.8395; train_edge_recon_loss: 595135.0985; train_gene_expr_recon_loss: 19799909.5455; train_masked_gp_l1_reg_loss: 84961.4717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113096.1895; train_chrom_access_recon_loss: 2658072.1970; train_global_loss: 23321070.4545; train_optim_loss: 23321070.4545; val_kl_reg_loss: 69609.4336; val_edge_recon_loss: 596900.9375; val_gene_expr_recon_loss: 19624276.0000; val_masked_gp_l1_reg_loss: 85503.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112798.8906; val_chrom_access_recon_loss: 2624924.4062; val_global_loss: 23114012.7500; val_optim_loss: 23114012.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9330; val_auprc_score: 0.9138; val_best_acc_score: 0.8670; val_best_f1_score: 0.8752; train_kl_reg_loss: 68888.5013; train_edge_recon_loss: 594925.4129; train_gene_expr_recon_loss: 19755505.6970; train_masked_gp_l1_reg_loss: 85750.2812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111825.1009; train_chrom_access_recon_loss: 2652862.0303; train_global_loss: 23269757.0303; train_optim_loss: 23269757.0303; val_kl_reg_loss: 68623.1201; val_edge_recon_loss: 604300.5391; val_gene_expr_recon_loss: 19476649.2500; val_masked_gp_l1_reg_loss: 86323.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111854.0156; val_chrom_access_recon_loss: 2603668.3125; val_global_loss: 22951419.2500; val_optim_loss: 22951419.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9401; val_auprc_score: 0.9201; val_best_acc_score: 0.8772; val_best_f1_score: 0.8836; train_kl_reg_loss: 68425.6256; train_edge_recon_loss: 592064.4527; train_gene_expr_recon_loss: 19697850.0000; train_masked_gp_l1_reg_loss: 86648.4756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110485.4994; train_chrom_access_recon_loss: 2645041.3977; train_global_loss: 23200515.4848; train_optim_loss: 23200515.4848; val_kl_reg_loss: 68318.9463; val_edge_recon_loss: 593948.1484; val_gene_expr_recon_loss: 19721598.0000; val_masked_gp_l1_reg_loss: 87148.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110844.6016; val_chrom_access_recon_loss: 2632117.6562; val_global_loss: 23213974.7500; val_optim_loss: 23213974.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9373; val_auprc_score: 0.9183; val_best_acc_score: 0.8726; val_best_f1_score: 0.8812; train_kl_reg_loss: 67524.7278; train_edge_recon_loss: 592508.7727; train_gene_expr_recon_loss: 19643435.7576; train_masked_gp_l1_reg_loss: 87504.7849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109976.3864; train_chrom_access_recon_loss: 2636451.4886; train_global_loss: 23137401.9697; train_optim_loss: 23137401.9697; val_kl_reg_loss: 67104.3760; val_edge_recon_loss: 598365.1250; val_gene_expr_recon_loss: 19472928.0000; val_masked_gp_l1_reg_loss: 87802.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108945.1328; val_chrom_access_recon_loss: 2636931.8125; val_global_loss: 22972077.0000; val_optim_loss: 22972077.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9423; val_auprc_score: 0.9255; val_best_acc_score: 0.8802; val_best_f1_score: 0.8870; train_kl_reg_loss: 67096.8381; train_edge_recon_loss: 590353.6212; train_gene_expr_recon_loss: 19611636.5455; train_masked_gp_l1_reg_loss: 88210.6120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108614.8810; train_chrom_access_recon_loss: 2631759.4432; train_global_loss: 23097671.8788; train_optim_loss: 23097671.8788; val_kl_reg_loss: 67435.8115; val_edge_recon_loss: 599605.9531; val_gene_expr_recon_loss: 19619406.2500; val_masked_gp_l1_reg_loss: 88609.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108122.8047; val_chrom_access_recon_loss: 2619623.0625; val_global_loss: 23102803.2500; val_optim_loss: 23102803.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9418; val_auprc_score: 0.9213; val_best_acc_score: 0.8853; val_best_f1_score: 0.8898; train_kl_reg_loss: 66702.5384; train_edge_recon_loss: 588124.6155; train_gene_expr_recon_loss: 19571300.6364; train_masked_gp_l1_reg_loss: 89120.3024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107691.9177; train_chrom_access_recon_loss: 2627362.3826; train_global_loss: 23050302.6364; train_optim_loss: 23050302.6364; val_kl_reg_loss: 65786.1084; val_edge_recon_loss: 595350.4141; val_gene_expr_recon_loss: 19353685.2500; val_masked_gp_l1_reg_loss: 89560.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107031.9219; val_chrom_access_recon_loss: 2591108.2812; val_global_loss: 22802522.5000; val_optim_loss: 22802522.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9435; val_auprc_score: 0.9290; val_best_acc_score: 0.8826; val_best_f1_score: 0.8898; train_kl_reg_loss: 66197.6128; train_edge_recon_loss: 588789.4953; train_gene_expr_recon_loss: 19524517.2424; train_masked_gp_l1_reg_loss: 89948.6518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106834.0095; train_chrom_access_recon_loss: 2619168.1023; train_global_loss: 22995454.9394; train_optim_loss: 22995454.9394; val_kl_reg_loss: 65127.0737; val_edge_recon_loss: 593958.1328; val_gene_expr_recon_loss: 19348523.5000; val_masked_gp_l1_reg_loss: 90281.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106730.9141; val_chrom_access_recon_loss: 2618350.1562; val_global_loss: 22822970.5000; val_optim_loss: 22822970.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9500; val_auprc_score: 0.9368; val_best_acc_score: 0.8915; val_best_f1_score: 0.8975; train_kl_reg_loss: 65205.3899; train_edge_recon_loss: 587509.8125; train_gene_expr_recon_loss: 19468102.3333; train_masked_gp_l1_reg_loss: 90811.3157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106082.2698; train_chrom_access_recon_loss: 2609495.0644; train_global_loss: 22927206.0909; train_optim_loss: 22927206.0909; val_kl_reg_loss: 65416.9619; val_edge_recon_loss: 589841.0859; val_gene_expr_recon_loss: 19283316.0000; val_masked_gp_l1_reg_loss: 91325.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105892.5703; val_chrom_access_recon_loss: 2610084.0938; val_global_loss: 22745876.0000; val_optim_loss: 22745876.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9505; val_auprc_score: 0.9362; val_best_acc_score: 0.8925; val_best_f1_score: 0.8975; train_kl_reg_loss: 65111.5371; train_edge_recon_loss: 585612.3674; train_gene_expr_recon_loss: 19433885.4848; train_masked_gp_l1_reg_loss: 91773.5979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105259.6953; train_chrom_access_recon_loss: 2603620.1515; train_global_loss: 22885262.8182; train_optim_loss: 22885262.8182; val_kl_reg_loss: 65005.7451; val_edge_recon_loss: 588414.7891; val_gene_expr_recon_loss: 19353993.2500; val_masked_gp_l1_reg_loss: 92174.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104761.8672; val_chrom_access_recon_loss: 2585667.9062; val_global_loss: 22790017.5000; val_optim_loss: 22790017.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9496; val_auprc_score: 0.9378; val_best_acc_score: 0.8866; val_best_f1_score: 0.8928; train_kl_reg_loss: 64663.6826; train_edge_recon_loss: 585300.7964; train_gene_expr_recon_loss: 19386048.6667; train_masked_gp_l1_reg_loss: 92676.6166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104652.1776; train_chrom_access_recon_loss: 2599015.0189; train_global_loss: 22832356.9697; train_optim_loss: 22832356.9697; val_kl_reg_loss: 64502.0698; val_edge_recon_loss: 592881.4922; val_gene_expr_recon_loss: 19142590.0000; val_masked_gp_l1_reg_loss: 93096.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104492.1641; val_chrom_access_recon_loss: 2550449.1875; val_global_loss: 22548010.7500; val_optim_loss: 22548010.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9453; val_auprc_score: 0.9258; val_best_acc_score: 0.8872; val_best_f1_score: 0.8934; train_kl_reg_loss: 63775.3117; train_edge_recon_loss: 585413.8570; train_gene_expr_recon_loss: 19342946.4242; train_masked_gp_l1_reg_loss: 93683.5156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103987.8280; train_chrom_access_recon_loss: 2589772.3788; train_global_loss: 22779579.1212; train_optim_loss: 22779579.1212; val_kl_reg_loss: 63631.9390; val_edge_recon_loss: 590285.2891; val_gene_expr_recon_loss: 19141867.5000; val_masked_gp_l1_reg_loss: 94293.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104008.1797; val_chrom_access_recon_loss: 2568547.1875; val_global_loss: 22562634.0000; val_optim_loss: 22562634.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9514; val_auprc_score: 0.9363; val_best_acc_score: 0.8952; val_best_f1_score: 0.9001; train_kl_reg_loss: 63570.8786; train_edge_recon_loss: 585795.3390; train_gene_expr_recon_loss: 19295282.0000; train_masked_gp_l1_reg_loss: 94712.7553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103593.9469; train_chrom_access_recon_loss: 2585316.7083; train_global_loss: 22728271.6061; train_optim_loss: 22728271.6061; val_kl_reg_loss: 62035.2559; val_edge_recon_loss: 589391.0312; val_gene_expr_recon_loss: 18952542.2500; val_masked_gp_l1_reg_loss: 95211.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103633.9453; val_chrom_access_recon_loss: 2544700.1250; val_global_loss: 22347514.5000; val_optim_loss: 22347514.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9499; val_auprc_score: 0.9347; val_best_acc_score: 0.8939; val_best_f1_score: 0.8992; train_kl_reg_loss: 63196.2581; train_edge_recon_loss: 583962.5975; train_gene_expr_recon_loss: 19259689.4242; train_masked_gp_l1_reg_loss: 95701.6980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103209.7283; train_chrom_access_recon_loss: 2580366.6477; train_global_loss: 22686126.2727; train_optim_loss: 22686126.2727; val_kl_reg_loss: 63747.0854; val_edge_recon_loss: 587526.5625; val_gene_expr_recon_loss: 18967568.7500; val_masked_gp_l1_reg_loss: 96126.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103227.3672; val_chrom_access_recon_loss: 2535679.1875; val_global_loss: 22353875.7500; val_optim_loss: 22353875.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9512; val_auprc_score: 0.9398; val_best_acc_score: 0.8912; val_best_f1_score: 0.8951; train_kl_reg_loss: 62689.7145; train_edge_recon_loss: 584526.9858; train_gene_expr_recon_loss: 19207022.1515; train_masked_gp_l1_reg_loss: 96635.0742; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102993.5659; train_chrom_access_recon_loss: 2571729.8939; train_global_loss: 22625597.1818; train_optim_loss: 22625597.1818; val_kl_reg_loss: 61853.5249; val_edge_recon_loss: 588072.0000; val_gene_expr_recon_loss: 19193825.5000; val_masked_gp_l1_reg_loss: 97234.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102411.8047; val_chrom_access_recon_loss: 2549370.1875; val_global_loss: 22592767.5000; val_optim_loss: 22592767.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9446; val_auprc_score: 0.9270; val_best_acc_score: 0.8829; val_best_f1_score: 0.8896; train_kl_reg_loss: 62255.1201; train_edge_recon_loss: 585508.4167; train_gene_expr_recon_loss: 19172367.9697; train_masked_gp_l1_reg_loss: 97593.8672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102415.1955; train_chrom_access_recon_loss: 2563131.3182; train_global_loss: 22583271.9091; train_optim_loss: 22583271.9091; val_kl_reg_loss: 62789.6299; val_edge_recon_loss: 590372.9609; val_gene_expr_recon_loss: 19077195.5000; val_masked_gp_l1_reg_loss: 98085.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103231.2422; val_chrom_access_recon_loss: 2549135.2500; val_global_loss: 22480811.0000; val_optim_loss: 22480811.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9515; val_auprc_score: 0.9365; val_best_acc_score: 0.8987; val_best_f1_score: 0.9018; train_kl_reg_loss: 62138.2881; train_edge_recon_loss: 584570.7491; train_gene_expr_recon_loss: 19142052.4848; train_masked_gp_l1_reg_loss: 98528.5670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102539.2312; train_chrom_access_recon_loss: 2559405.7765; train_global_loss: 22549235.0909; train_optim_loss: 22549235.0909; val_kl_reg_loss: 62792.0552; val_edge_recon_loss: 584239.1719; val_gene_expr_recon_loss: 18918632.5000; val_masked_gp_l1_reg_loss: 98917.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101913.6484; val_chrom_access_recon_loss: 2533302.1875; val_global_loss: 22299797.5000; val_optim_loss: 22299797.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9495; val_auprc_score: 0.9301; val_best_acc_score: 0.8958; val_best_f1_score: 0.9013; train_kl_reg_loss: 61976.4702; train_edge_recon_loss: 583906.6544; train_gene_expr_recon_loss: 19095746.2121; train_masked_gp_l1_reg_loss: 99399.5315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101811.3606; train_chrom_access_recon_loss: 2550670.1250; train_global_loss: 22493510.4242; train_optim_loss: 22493510.4242; val_kl_reg_loss: 62131.1567; val_edge_recon_loss: 594509.2891; val_gene_expr_recon_loss: 18975522.5000; val_masked_gp_l1_reg_loss: 99951.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102408.3984; val_chrom_access_recon_loss: 2537585.7188; val_global_loss: 22372108.7500; val_optim_loss: 22372108.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9416; val_auprc_score: 0.9205; val_best_acc_score: 0.8890; val_best_f1_score: 0.8960; train_kl_reg_loss: 61752.2247; train_edge_recon_loss: 584581.3485; train_gene_expr_recon_loss: 19039685.5152; train_masked_gp_l1_reg_loss: 100382.2888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102278.2287; train_chrom_access_recon_loss: 2545279.4167; train_global_loss: 22433959.0303; train_optim_loss: 22433959.0303; val_kl_reg_loss: 60443.7329; val_edge_recon_loss: 591764.4609; val_gene_expr_recon_loss: 18902275.0000; val_masked_gp_l1_reg_loss: 100863.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101921.6953; val_chrom_access_recon_loss: 2519896.0625; val_global_loss: 22277165.5000; val_optim_loss: 22277165.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9538; val_auprc_score: 0.9354; val_best_acc_score: 0.8968; val_best_f1_score: 0.9015; train_kl_reg_loss: 61467.1434; train_edge_recon_loss: 582432.6733; train_gene_expr_recon_loss: 19007911.6667; train_masked_gp_l1_reg_loss: 101175.3614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101813.6618; train_chrom_access_recon_loss: 2538629.8258; train_global_loss: 22393430.4848; train_optim_loss: 22393430.4848; val_kl_reg_loss: 61185.3154; val_edge_recon_loss: 590333.2656; val_gene_expr_recon_loss: 18942368.5000; val_masked_gp_l1_reg_loss: 101563.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101983.6406; val_chrom_access_recon_loss: 2524882.4688; val_global_loss: 22322317.5000; val_optim_loss: 22322317.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9536; val_auprc_score: 0.9412; val_best_acc_score: 0.8968; val_best_f1_score: 0.9007; train_kl_reg_loss: 61697.4529; train_edge_recon_loss: 580478.5388; train_gene_expr_recon_loss: 18993376.1515; train_masked_gp_l1_reg_loss: 101988.9513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101842.2970; train_chrom_access_recon_loss: 2534911.4659; train_global_loss: 22374294.6970; train_optim_loss: 22374294.6970; val_kl_reg_loss: 61931.3896; val_edge_recon_loss: 592552.9375; val_gene_expr_recon_loss: 18890884.2500; val_masked_gp_l1_reg_loss: 102483.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102030.0859; val_chrom_access_recon_loss: 2528974.8438; val_global_loss: 22278857.7500; val_optim_loss: 22278857.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9539; val_auprc_score: 0.9339; val_best_acc_score: 0.8984; val_best_f1_score: 0.9008; train_kl_reg_loss: 61357.6415; train_edge_recon_loss: 583421.3040; train_gene_expr_recon_loss: 18930862.1818; train_masked_gp_l1_reg_loss: 102979.7852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101763.0826; train_chrom_access_recon_loss: 2524249.2689; train_global_loss: 22304633.2727; train_optim_loss: 22304633.2727; val_kl_reg_loss: 61082.4434; val_edge_recon_loss: 590331.7031; val_gene_expr_recon_loss: 18934275.7500; val_masked_gp_l1_reg_loss: 103396.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102535.6562; val_chrom_access_recon_loss: 2523142.9062; val_global_loss: 22314765.0000; val_optim_loss: 22314765.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9494; val_auprc_score: 0.9333; val_best_acc_score: 0.8939; val_best_f1_score: 0.8997; train_kl_reg_loss: 61389.2578; train_edge_recon_loss: 581026.8826; train_gene_expr_recon_loss: 18906297.0000; train_masked_gp_l1_reg_loss: 103801.6978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102024.3852; train_chrom_access_recon_loss: 2520614.9508; train_global_loss: 22275154.1818; train_optim_loss: 22275154.1818; val_kl_reg_loss: 61600.7256; val_edge_recon_loss: 591669.6875; val_gene_expr_recon_loss: 18753443.7500; val_masked_gp_l1_reg_loss: 104181.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101793.4297; val_chrom_access_recon_loss: 2489460.4688; val_global_loss: 22102151.2500; val_optim_loss: 22102151.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9499; val_auprc_score: 0.9326; val_best_acc_score: 0.8917; val_best_f1_score: 0.8962; train_kl_reg_loss: 61543.9306; train_edge_recon_loss: 580626.6326; train_gene_expr_recon_loss: 18871140.2424; train_masked_gp_l1_reg_loss: 104554.1549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101878.3496; train_chrom_access_recon_loss: 2516179.5758; train_global_loss: 22235922.7879; train_optim_loss: 22235922.7879; val_kl_reg_loss: 62511.3198; val_edge_recon_loss: 590187.3125; val_gene_expr_recon_loss: 18908727.5000; val_masked_gp_l1_reg_loss: 104982.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101689.7188; val_chrom_access_recon_loss: 2541107.9375; val_global_loss: 22309206.0000; val_optim_loss: 22309206.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9453; val_auprc_score: 0.9279; val_best_acc_score: 0.8893; val_best_f1_score: 0.8940; train_kl_reg_loss: 61441.8139; train_edge_recon_loss: 582626.4119; train_gene_expr_recon_loss: 18847393.1515; train_masked_gp_l1_reg_loss: 105338.9538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101651.6637; train_chrom_access_recon_loss: 2511413.4394; train_global_loss: 22209865.4545; train_optim_loss: 22209865.4545; val_kl_reg_loss: 61095.2529; val_edge_recon_loss: 595404.9375; val_gene_expr_recon_loss: 18780290.0000; val_masked_gp_l1_reg_loss: 105600.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102886.2031; val_chrom_access_recon_loss: 2495856.5312; val_global_loss: 22141133.2500; val_optim_loss: 22141133.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9447; val_auprc_score: 0.9259; val_best_acc_score: 0.8907; val_best_f1_score: 0.8956; train_kl_reg_loss: 61118.6146; train_edge_recon_loss: 582058.3902; train_gene_expr_recon_loss: 18799082.5152; train_masked_gp_l1_reg_loss: 105993.4033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102095.9608; train_chrom_access_recon_loss: 2503022.9394; train_global_loss: 22153371.4545; train_optim_loss: 22153371.4545; val_kl_reg_loss: 61116.9937; val_edge_recon_loss: 594114.4922; val_gene_expr_recon_loss: 18917150.7500; val_masked_gp_l1_reg_loss: 106392.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102237.2031; val_chrom_access_recon_loss: 2510010.2500; val_global_loss: 22291022.5000; val_optim_loss: 22291022.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9423; val_auprc_score: 0.9174; val_best_acc_score: 0.8882; val_best_f1_score: 0.8940; train_kl_reg_loss: 60950.5737; train_edge_recon_loss: 582171.6790; train_gene_expr_recon_loss: 18754088.5455; train_masked_gp_l1_reg_loss: 106737.8729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101860.9142; train_chrom_access_recon_loss: 2494315.0606; train_global_loss: 22100124.5758; train_optim_loss: 22100124.5758; val_kl_reg_loss: 60758.2598; val_edge_recon_loss: 588038.7812; val_gene_expr_recon_loss: 18751908.2500; val_masked_gp_l1_reg_loss: 107012.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102108.4922; val_chrom_access_recon_loss: 2519955.7500; val_global_loss: 22129780.7500; val_optim_loss: 22129780.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9524; val_auprc_score: 0.9357; val_best_acc_score: 0.8958; val_best_f1_score: 0.9009; train_kl_reg_loss: 61417.0633; train_edge_recon_loss: 580344.3750; train_gene_expr_recon_loss: 18711750.0000; train_masked_gp_l1_reg_loss: 106058.5479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77635.7243; train_chrom_access_recon_loss: 2483461.9545; train_global_loss: 22020667.6364; train_optim_loss: 22020667.6364; val_kl_reg_loss: 61636.8979; val_edge_recon_loss: 588489.1875; val_gene_expr_recon_loss: 18747392.7500; val_masked_gp_l1_reg_loss: 105627.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70984.9219; val_chrom_access_recon_loss: 2495939.6250; val_global_loss: 22070070.0000; val_optim_loss: 22070070.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9479; val_auprc_score: 0.9270; val_best_acc_score: 0.8939; val_best_f1_score: 0.8972; train_kl_reg_loss: 61852.1137; train_edge_recon_loss: 579027.9773; train_gene_expr_recon_loss: 18708191.4545; train_masked_gp_l1_reg_loss: 105582.6468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70077.1992; train_chrom_access_recon_loss: 2484469.7348; train_global_loss: 22009201.1818; train_optim_loss: 22009201.1818; val_kl_reg_loss: 62195.7397; val_edge_recon_loss: 588836.1328; val_gene_expr_recon_loss: 18633136.7500; val_masked_gp_l1_reg_loss: 105590.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69355.3359; val_chrom_access_recon_loss: 2494726.5312; val_global_loss: 21953841.5000; val_optim_loss: 21953841.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9515; val_auprc_score: 0.9371; val_best_acc_score: 0.8952; val_best_f1_score: 0.8999; train_kl_reg_loss: 62088.7123; train_edge_recon_loss: 578118.3210; train_gene_expr_recon_loss: 18707995.0303; train_masked_gp_l1_reg_loss: 105592.0716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68974.4367; train_chrom_access_recon_loss: 2485557.3561; train_global_loss: 22008325.7879; train_optim_loss: 22008325.7879; val_kl_reg_loss: 62048.1631; val_edge_recon_loss: 588566.9609; val_gene_expr_recon_loss: 18701474.7500; val_masked_gp_l1_reg_loss: 105621.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68829.2266; val_chrom_access_recon_loss: 2474384.9375; val_global_loss: 22000927.0000; val_optim_loss: 22000927.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9519; val_auprc_score: 0.9378; val_best_acc_score: 0.8998; val_best_f1_score: 0.9038; train_kl_reg_loss: 62067.3513; train_edge_recon_loss: 579627.4602; train_gene_expr_recon_loss: 18678616.5758; train_masked_gp_l1_reg_loss: 105662.7131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68567.1190; train_chrom_access_recon_loss: 2482335.3561; train_global_loss: 21976876.6061; train_optim_loss: 21976876.6061; val_kl_reg_loss: 62165.8008; val_edge_recon_loss: 587008.8281; val_gene_expr_recon_loss: 18821224.2500; val_masked_gp_l1_reg_loss: 105680.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68294.4219; val_chrom_access_recon_loss: 2526024.8750; val_global_loss: 22170397.0000; val_optim_loss: 22170397.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9546; val_auprc_score: 0.9398; val_best_acc_score: 0.9006; val_best_f1_score: 0.9046; train_kl_reg_loss: 62366.6091; train_edge_recon_loss: 578159.2689; train_gene_expr_recon_loss: 18688589.3333; train_masked_gp_l1_reg_loss: 105731.4357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68073.3493; train_chrom_access_recon_loss: 2480972.1591; train_global_loss: 21983892.1212; train_optim_loss: 21983892.1212; val_kl_reg_loss: 62749.9648; val_edge_recon_loss: 583485.3438; val_gene_expr_recon_loss: 18678850.7500; val_masked_gp_l1_reg_loss: 105764.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67912.8125; val_chrom_access_recon_loss: 2502395.9375; val_global_loss: 22001158.5000; val_optim_loss: 22001158.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9478; val_auprc_score: 0.9255; val_best_acc_score: 0.8960; val_best_f1_score: 0.9006; train_kl_reg_loss: 62393.6499; train_edge_recon_loss: 578800.8674; train_gene_expr_recon_loss: 18686543.8485; train_masked_gp_l1_reg_loss: 105801.0787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67758.2569; train_chrom_access_recon_loss: 2480951.3902; train_global_loss: 21982249.1515; train_optim_loss: 21982249.1515; val_kl_reg_loss: 62958.1191; val_edge_recon_loss: 587831.1172; val_gene_expr_recon_loss: 18671280.7500; val_masked_gp_l1_reg_loss: 105853.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67631.5781; val_chrom_access_recon_loss: 2492463.9375; val_global_loss: 21988020.7500; val_optim_loss: 21988020.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9538; val_auprc_score: 0.9388; val_best_acc_score: 0.8968; val_best_f1_score: 0.9012; train_kl_reg_loss: 62602.3375; train_edge_recon_loss: 579730.4034; train_gene_expr_recon_loss: 18681756.0303; train_masked_gp_l1_reg_loss: 105741.6196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65288.3702; train_chrom_access_recon_loss: 2481319.5871; train_global_loss: 21976438.5758; train_optim_loss: 21976438.5758; val_kl_reg_loss: 62547.1250; val_edge_recon_loss: 586211.4062; val_gene_expr_recon_loss: 18659797.5000; val_masked_gp_l1_reg_loss: 105681.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64650.3594; val_chrom_access_recon_loss: 2486999.5000; val_global_loss: 21965887.7500; val_optim_loss: 21965887.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9423; val_auprc_score: 0.9162; val_best_acc_score: 0.8877; val_best_f1_score: 0.8932; train_kl_reg_loss: 62543.7710; train_edge_recon_loss: 579961.9943; train_gene_expr_recon_loss: 18690668.5758; train_masked_gp_l1_reg_loss: 105667.7738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64524.4242; train_chrom_access_recon_loss: 2481874.8561; train_global_loss: 21985241.4848; train_optim_loss: 21985241.4848; val_kl_reg_loss: 62339.5068; val_edge_recon_loss: 589588.1484; val_gene_expr_recon_loss: 18591658.0000; val_masked_gp_l1_reg_loss: 105661.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64420.2734; val_chrom_access_recon_loss: 2467319.5000; val_global_loss: 21880987.2500; val_optim_loss: 21880987.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9489; val_auprc_score: 0.9266; val_best_acc_score: 0.8982; val_best_f1_score: 0.9032; train_kl_reg_loss: 62471.0719; train_edge_recon_loss: 580099.6989; train_gene_expr_recon_loss: 18666172.4848; train_masked_gp_l1_reg_loss: 105660.8222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64354.8751; train_chrom_access_recon_loss: 2476995.4508; train_global_loss: 21955754.3333; train_optim_loss: 21955754.3333; val_kl_reg_loss: 62824.2861; val_edge_recon_loss: 583990.4219; val_gene_expr_recon_loss: 18593587.0000; val_masked_gp_l1_reg_loss: 105658.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64289.7344; val_chrom_access_recon_loss: 2494717.2188; val_global_loss: 21905066.5000; val_optim_loss: 21905066.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9507; val_auprc_score: 0.9334; val_best_acc_score: 0.8944; val_best_f1_score: 0.8992; train_kl_reg_loss: 62559.2907; train_edge_recon_loss: 578480.4934; train_gene_expr_recon_loss: 18675359.2727; train_masked_gp_l1_reg_loss: 105660.9400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64233.5635; train_chrom_access_recon_loss: 2477185.7727; train_global_loss: 21963479.5152; train_optim_loss: 21963479.5152; val_kl_reg_loss: 62592.9238; val_edge_recon_loss: 589694.5234; val_gene_expr_recon_loss: 18836582.0000; val_masked_gp_l1_reg_loss: 105662.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64180.1680; val_chrom_access_recon_loss: 2497646.3750; val_global_loss: 22156357.5000; val_optim_loss: 22156357.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9507; val_auprc_score: 0.9312; val_best_acc_score: 0.9014; val_best_f1_score: 0.9040; train_kl_reg_loss: 62479.2944; train_edge_recon_loss: 578770.4536; train_gene_expr_recon_loss: 18680112.3333; train_masked_gp_l1_reg_loss: 105663.5888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64141.8755; train_chrom_access_recon_loss: 2478499.7159; train_global_loss: 21969666.9394; train_optim_loss: 21969666.9394; val_kl_reg_loss: 62747.7319; val_edge_recon_loss: 585889.2500; val_gene_expr_recon_loss: 18678576.7500; val_masked_gp_l1_reg_loss: 105667.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64109.0391; val_chrom_access_recon_loss: 2482691.4688; val_global_loss: 21979683.2500; val_optim_loss: 21979683.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9488; val_auprc_score: 0.9350; val_best_acc_score: 0.8901; val_best_f1_score: 0.8954; train_kl_reg_loss: 62560.9096; train_edge_recon_loss: 578922.8343; train_gene_expr_recon_loss: 18681358.0606; train_masked_gp_l1_reg_loss: 105671.2295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64081.4862; train_chrom_access_recon_loss: 2478572.9015; train_global_loss: 21971167.4848; train_optim_loss: 21971167.4848; val_kl_reg_loss: 62749.3608; val_edge_recon_loss: 587930.2031; val_gene_expr_recon_loss: 18581338.5000; val_masked_gp_l1_reg_loss: 105672.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64043.8008; val_chrom_access_recon_loss: 2478339.4688; val_global_loss: 21880074.0000; val_optim_loss: 21880074.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9458; val_auprc_score: 0.9291; val_best_acc_score: 0.8898; val_best_f1_score: 0.8952; train_kl_reg_loss: 62541.3822; train_edge_recon_loss: 578083.2538; train_gene_expr_recon_loss: 18682498.9697; train_masked_gp_l1_reg_loss: 105676.0436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64018.3199; train_chrom_access_recon_loss: 2481924.1439; train_global_loss: 21974741.8485; train_optim_loss: 21974741.8485; val_kl_reg_loss: 62872.7783; val_edge_recon_loss: 589660.6094; val_gene_expr_recon_loss: 18835565.0000; val_masked_gp_l1_reg_loss: 105679.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63985.5742; val_chrom_access_recon_loss: 2501367.3750; val_global_loss: 22159131.2500; val_optim_loss: 22159131.2500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9455; val_auprc_score: 0.9258; val_best_acc_score: 0.8933; val_best_f1_score: 0.8993; train_kl_reg_loss: 62570.8661; train_edge_recon_loss: 578267.3722; train_gene_expr_recon_loss: 18682163.6667; train_masked_gp_l1_reg_loss: 105683.5994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63965.7279; train_chrom_access_recon_loss: 2480693.7386; train_global_loss: 21973345.0909; train_optim_loss: 21973345.0909; val_kl_reg_loss: 62810.4819; val_edge_recon_loss: 586103.1562; val_gene_expr_recon_loss: 18662154.0000; val_masked_gp_l1_reg_loss: 105688.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63931.2070; val_chrom_access_recon_loss: 2478303.0312; val_global_loss: 21958990.5000; val_optim_loss: 21958990.5000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9495; val_auprc_score: 0.9325; val_best_acc_score: 0.8947; val_best_f1_score: 0.8995; train_kl_reg_loss: 62513.4767; train_edge_recon_loss: 578338.9839; train_gene_expr_recon_loss: 18669680.5152; train_masked_gp_l1_reg_loss: 105693.1857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63911.7778; train_chrom_access_recon_loss: 2480648.0795; train_global_loss: 21960785.7879; train_optim_loss: 21960785.7879; val_kl_reg_loss: 62777.3179; val_edge_recon_loss: 588864.4375; val_gene_expr_recon_loss: 18720058.0000; val_masked_gp_l1_reg_loss: 105696.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63879.0195; val_chrom_access_recon_loss: 2502485.9375; val_global_loss: 22043762.0000; val_optim_loss: 22043762.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9482; val_auprc_score: 0.9256; val_best_acc_score: 0.8976; val_best_f1_score: 0.9019; train_kl_reg_loss: 62588.6703; train_edge_recon_loss: 579934.1307; train_gene_expr_recon_loss: 18683311.8788; train_masked_gp_l1_reg_loss: 105703.9757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63864.5726; train_chrom_access_recon_loss: 2476644.0720; train_global_loss: 21972047.3030; train_optim_loss: 21972047.3030; val_kl_reg_loss: 62817.3228; val_edge_recon_loss: 585414.9219; val_gene_expr_recon_loss: 18814216.2500; val_masked_gp_l1_reg_loss: 105707.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63835.5547; val_chrom_access_recon_loss: 2495769.6250; val_global_loss: 22127762.2500; val_optim_loss: 22127762.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9506; val_auprc_score: 0.9330; val_best_acc_score: 0.8974; val_best_f1_score: 0.9023; train_kl_reg_loss: 62617.0198; train_edge_recon_loss: 580666.7405; train_gene_expr_recon_loss: 18672730.6061; train_masked_gp_l1_reg_loss: 105696.7199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63605.0849; train_chrom_access_recon_loss: 2478394.8030; train_global_loss: 21963711.0303; train_optim_loss: 21963711.0303; val_kl_reg_loss: 62969.7339; val_edge_recon_loss: 585691.6094; val_gene_expr_recon_loss: 18786155.7500; val_masked_gp_l1_reg_loss: 105690.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63544.7930; val_chrom_access_recon_loss: 2508072.9375; val_global_loss: 22112123.5000; val_optim_loss: 22112123.5000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9459; val_auprc_score: 0.9268; val_best_acc_score: 0.8947; val_best_f1_score: 0.9005; train_kl_reg_loss: 62555.7024; train_edge_recon_loss: 579452.3153; train_gene_expr_recon_loss: 18657184.1515; train_masked_gp_l1_reg_loss: 105689.1746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63533.8111; train_chrom_access_recon_loss: 2475971.6288; train_global_loss: 21944386.8485; train_optim_loss: 21944386.8485; val_kl_reg_loss: 62762.3574; val_edge_recon_loss: 588289.2969; val_gene_expr_recon_loss: 18707891.5000; val_masked_gp_l1_reg_loss: 105688.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63524.1719; val_chrom_access_recon_loss: 2474876.6875; val_global_loss: 22003031.2500; val_optim_loss: 22003031.2500
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9501; val_auprc_score: 0.9311; val_best_acc_score: 0.9003; val_best_f1_score: 0.9051; train_kl_reg_loss: 62573.8047; train_edge_recon_loss: 579412.0691; train_gene_expr_recon_loss: 18666859.0909; train_masked_gp_l1_reg_loss: 105688.0855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63517.8034; train_chrom_access_recon_loss: 2477706.3106; train_global_loss: 21955757.0606; train_optim_loss: 21955757.0606; val_kl_reg_loss: 62919.7588; val_edge_recon_loss: 588999.2344; val_gene_expr_recon_loss: 18954630.5000; val_masked_gp_l1_reg_loss: 105687.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63511.0938; val_chrom_access_recon_loss: 2506605.8750; val_global_loss: 22282355.0000; val_optim_loss: 22282355.0000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9516; val_auprc_score: 0.9333; val_best_acc_score: 0.8995; val_best_f1_score: 0.9041; train_kl_reg_loss: 62575.7051; train_edge_recon_loss: 577794.8722; train_gene_expr_recon_loss: 18681979.5758; train_masked_gp_l1_reg_loss: 105688.1159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63506.1989; train_chrom_access_recon_loss: 2479879.9129; train_global_loss: 21971424.1212; train_optim_loss: 21971424.1212; val_kl_reg_loss: 62855.1973; val_edge_recon_loss: 587232.0781; val_gene_expr_recon_loss: 18782317.2500; val_masked_gp_l1_reg_loss: 105688.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63501.3867; val_chrom_access_recon_loss: 2510124.6875; val_global_loss: 22111719.2500; val_optim_loss: 22111719.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 26 min 48 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9517
val AUPRC score: 0.9358
val best accuracy score: 0.8971
val best F1 score: 0.9027
val target rna MSE score: 1.2116
val source rna MSE score: 0.6102
val target atac MSE score: 0.4648
val source atac MSE score: 0.1816
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
