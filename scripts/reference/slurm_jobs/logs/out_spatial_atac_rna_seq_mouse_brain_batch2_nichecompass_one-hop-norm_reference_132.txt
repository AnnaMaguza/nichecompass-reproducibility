[True]
Run timestamp: 07082023_213441_132.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_132']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8738; val_auprc_score: 0.8901; val_best_acc_score: 0.5213; val_best_f1_score: 0.6761; train_kl_reg_loss: 64883.1479; train_edge_recon_loss: 3478369.8333; train_gene_expr_recon_loss: 1262912.1944; train_masked_gp_l1_reg_loss: 8819.4812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167300.1198; train_chrom_access_recon_loss: 2656308.1528; train_global_loss: 7638593.0000; train_optim_loss: 7638593.0000; val_kl_reg_loss: 19009.2129; val_edge_recon_loss: 4063892.0000; val_gene_expr_recon_loss: 1029685.5625; val_masked_gp_l1_reg_loss: 7335.1860; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162855.8438; val_chrom_access_recon_loss: 1671970.1250; val_global_loss: 6954748.0000; val_optim_loss: 6954748.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8663; val_auprc_score: 0.8821; val_best_acc_score: 0.5389; val_best_f1_score: 0.6839; train_kl_reg_loss: 15273.9874; train_edge_recon_loss: 3479387.7778; train_gene_expr_recon_loss: 958345.1597; train_masked_gp_l1_reg_loss: 6773.1058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160158.3837; train_chrom_access_recon_loss: 1524288.4722; train_global_loss: 6144226.7778; train_optim_loss: 6144226.7778; val_kl_reg_loss: 11581.2402; val_edge_recon_loss: 4062718.2500; val_gene_expr_recon_loss: 887863.8750; val_masked_gp_l1_reg_loss: 6335.9365; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156883.8906; val_chrom_access_recon_loss: 1423979.6250; val_global_loss: 6549363.0000; val_optim_loss: 6549363.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8547; val_auprc_score: 0.8725; val_best_acc_score: 0.5393; val_best_f1_score: 0.6839; train_kl_reg_loss: 12820.8791; train_edge_recon_loss: 3478849.8889; train_gene_expr_recon_loss: 864209.0417; train_masked_gp_l1_reg_loss: 6310.7410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154184.1545; train_chrom_access_recon_loss: 1407577.8194; train_global_loss: 5923952.5556; train_optim_loss: 5923952.5556; val_kl_reg_loss: 13483.5088; val_edge_recon_loss: 4062956.7500; val_gene_expr_recon_loss: 825794.3125; val_masked_gp_l1_reg_loss: 6327.7026; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150645.2969; val_chrom_access_recon_loss: 1389777.0000; val_global_loss: 6448984.5000; val_optim_loss: 6448984.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8401; val_auprc_score: 0.8585; val_best_acc_score: 0.5534; val_best_f1_score: 0.6897; train_kl_reg_loss: 16079.3754; train_edge_recon_loss: 3480350.5833; train_gene_expr_recon_loss: 817093.4583; train_masked_gp_l1_reg_loss: 6294.8511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147473.4549; train_chrom_access_recon_loss: 1383662.2083; train_global_loss: 5850953.8889; train_optim_loss: 5850953.8889; val_kl_reg_loss: 14939.5723; val_edge_recon_loss: 4061915.5000; val_gene_expr_recon_loss: 794109.4375; val_masked_gp_l1_reg_loss: 6238.7637; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143292.8281; val_chrom_access_recon_loss: 1372640.8750; val_global_loss: 6393137.5000; val_optim_loss: 6393137.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8460; val_auprc_score: 0.8585; val_best_acc_score: 0.5676; val_best_f1_score: 0.6948; train_kl_reg_loss: 16983.1584; train_edge_recon_loss: 3479828.6667; train_gene_expr_recon_loss: 790438.0694; train_masked_gp_l1_reg_loss: 6221.0515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139686.5139; train_chrom_access_recon_loss: 1361046.1111; train_global_loss: 5794203.7778; train_optim_loss: 5794203.7778; val_kl_reg_loss: 17223.2227; val_edge_recon_loss: 4059628.2500; val_gene_expr_recon_loss: 773270.3750; val_masked_gp_l1_reg_loss: 6203.1958; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135070.4688; val_chrom_access_recon_loss: 1360848.2500; val_global_loss: 6352244.0000; val_optim_loss: 6352244.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8557; val_auprc_score: 0.8612; val_best_acc_score: 0.5924; val_best_f1_score: 0.7052; train_kl_reg_loss: 19996.4586; train_edge_recon_loss: 3480000.5556; train_gene_expr_recon_loss: 767384.6458; train_masked_gp_l1_reg_loss: 6205.6925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131287.4253; train_chrom_access_recon_loss: 1362758.6944; train_global_loss: 5767633.3889; train_optim_loss: 5767633.3889; val_kl_reg_loss: 19323.8594; val_edge_recon_loss: 4054922.7500; val_gene_expr_recon_loss: 755313.3750; val_masked_gp_l1_reg_loss: 6206.6768; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126537.0469; val_chrom_access_recon_loss: 1352637.8750; val_global_loss: 6314941.5000; val_optim_loss: 6314941.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8646; val_auprc_score: 0.8610; val_best_acc_score: 0.6541; val_best_f1_score: 0.7346; train_kl_reg_loss: 19697.1654; train_edge_recon_loss: 3480469.1111; train_gene_expr_recon_loss: 745416.9375; train_masked_gp_l1_reg_loss: 6224.2312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122750.7682; train_chrom_access_recon_loss: 1349738.5000; train_global_loss: 5724296.7778; train_optim_loss: 5724296.7778; val_kl_reg_loss: 19722.9785; val_edge_recon_loss: 4048857.5000; val_gene_expr_recon_loss: 740811.0000; val_masked_gp_l1_reg_loss: 6238.9277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118056.0312; val_chrom_access_recon_loss: 1346415.3750; val_global_loss: 6280102.0000; val_optim_loss: 6280102.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8701; val_auprc_score: 0.8648; val_best_acc_score: 0.7413; val_best_f1_score: 0.7823; train_kl_reg_loss: 21150.3856; train_edge_recon_loss: 3478731.0833; train_gene_expr_recon_loss: 734771.9097; train_masked_gp_l1_reg_loss: 6255.2627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114393.1016; train_chrom_access_recon_loss: 1349522.4444; train_global_loss: 5704824.1667; train_optim_loss: 5704824.1667; val_kl_reg_loss: 19236.2637; val_edge_recon_loss: 4034709.7500; val_gene_expr_recon_loss: 726599.2500; val_masked_gp_l1_reg_loss: 6269.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109892.6953; val_chrom_access_recon_loss: 1340405.2500; val_global_loss: 6237112.0000; val_optim_loss: 6237112.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8732; val_auprc_score: 0.8642; val_best_acc_score: 0.8053; val_best_f1_score: 0.8118; train_kl_reg_loss: 19828.8531; train_edge_recon_loss: 3476356.0833; train_gene_expr_recon_loss: 723334.2986; train_masked_gp_l1_reg_loss: 6291.2127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106421.3498; train_chrom_access_recon_loss: 1345598.4306; train_global_loss: 5677830.2222; train_optim_loss: 5677830.2222; val_kl_reg_loss: 16792.5742; val_edge_recon_loss: 4004408.7500; val_gene_expr_recon_loss: 718415.5000; val_masked_gp_l1_reg_loss: 6315.8735; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102173.5078; val_chrom_access_recon_loss: 1336278.5000; val_global_loss: 6184385.0000; val_optim_loss: 6184385.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8740; val_auprc_score: 0.8627; val_best_acc_score: 0.7633; val_best_f1_score: 0.7833; train_kl_reg_loss: 18087.5898; train_edge_recon_loss: 3466484.6111; train_gene_expr_recon_loss: 719897.3681; train_masked_gp_l1_reg_loss: 6346.4167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98952.2326; train_chrom_access_recon_loss: 1331865.3750; train_global_loss: 5641633.7222; train_optim_loss: 5641633.7222; val_kl_reg_loss: 16187.7861; val_edge_recon_loss: 3920324.7500; val_gene_expr_recon_loss: 712638.5000; val_masked_gp_l1_reg_loss: 6381.6694; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95033.9688; val_chrom_access_recon_loss: 1332833.3750; val_global_loss: 6083400.0000; val_optim_loss: 6083400.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8945; val_auprc_score: 0.8771; val_best_acc_score: 0.8199; val_best_f1_score: 0.8293; train_kl_reg_loss: 14026.0458; train_edge_recon_loss: 3438473.2500; train_gene_expr_recon_loss: 714345.0000; train_masked_gp_l1_reg_loss: 6424.0462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92104.3264; train_chrom_access_recon_loss: 1335198.0972; train_global_loss: 5600570.8333; train_optim_loss: 5600570.8333; val_kl_reg_loss: 9563.1807; val_edge_recon_loss: 3607872.7500; val_gene_expr_recon_loss: 720542.1250; val_masked_gp_l1_reg_loss: 6469.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88579.6172; val_chrom_access_recon_loss: 1333228.1250; val_global_loss: 5766255.5000; val_optim_loss: 5766255.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9030; val_auprc_score: 0.8849; val_best_acc_score: 0.8348; val_best_f1_score: 0.8452; train_kl_reg_loss: 8770.0199; train_edge_recon_loss: 3228580.7500; train_gene_expr_recon_loss: 750744.6944; train_masked_gp_l1_reg_loss: 6538.5548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86024.9566; train_chrom_access_recon_loss: 1348703.8194; train_global_loss: 5429362.7222; train_optim_loss: 5429362.7222; val_kl_reg_loss: 11135.9053; val_edge_recon_loss: 2891913.7500; val_gene_expr_recon_loss: 789950.5000; val_masked_gp_l1_reg_loss: 6652.2271; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83013.4453; val_chrom_access_recon_loss: 1355309.5000; val_global_loss: 5137975.5000; val_optim_loss: 5137975.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9100; val_auprc_score: 0.8869; val_best_acc_score: 0.8429; val_best_f1_score: 0.8551; train_kl_reg_loss: 21836.3657; train_edge_recon_loss: 2817442.0000; train_gene_expr_recon_loss: 788129.5764; train_masked_gp_l1_reg_loss: 6793.7495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80919.8750; train_chrom_access_recon_loss: 1353249.3194; train_global_loss: 5068370.8889; train_optim_loss: 5068370.8889; val_kl_reg_loss: 33804.6875; val_edge_recon_loss: 2799675.7500; val_gene_expr_recon_loss: 763812.1250; val_masked_gp_l1_reg_loss: 6937.1851; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78387.9375; val_chrom_access_recon_loss: 1341402.8750; val_global_loss: 5024020.5000; val_optim_loss: 5024020.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9205; val_auprc_score: 0.8958; val_best_acc_score: 0.8576; val_best_f1_score: 0.8659; train_kl_reg_loss: 42991.7457; train_edge_recon_loss: 2760826.6944; train_gene_expr_recon_loss: 754181.7778; train_masked_gp_l1_reg_loss: 6972.7688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76425.4783; train_chrom_access_recon_loss: 1343091.1111; train_global_loss: 4984489.6667; train_optim_loss: 4984489.6667; val_kl_reg_loss: 46676.5938; val_edge_recon_loss: 2763159.0000; val_gene_expr_recon_loss: 740723.7500; val_masked_gp_l1_reg_loss: 7012.4980; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74011.5000; val_chrom_access_recon_loss: 1333131.8750; val_global_loss: 4964715.0000; val_optim_loss: 4964715.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9179; val_auprc_score: 0.8886; val_best_acc_score: 0.8581; val_best_f1_score: 0.8699; train_kl_reg_loss: 50661.9861; train_edge_recon_loss: 2752096.3333; train_gene_expr_recon_loss: 735050.6528; train_masked_gp_l1_reg_loss: 7016.5630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72167.8116; train_chrom_access_recon_loss: 1332197.2639; train_global_loss: 4949190.6111; train_optim_loss: 4949190.6111; val_kl_reg_loss: 49324.1523; val_edge_recon_loss: 2748974.2500; val_gene_expr_recon_loss: 727286.9375; val_masked_gp_l1_reg_loss: 6994.2793; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69888.1172; val_chrom_access_recon_loss: 1326661.8750; val_global_loss: 4929129.5000; val_optim_loss: 4929129.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9241; val_auprc_score: 0.8961; val_best_acc_score: 0.8662; val_best_f1_score: 0.8768; train_kl_reg_loss: 49280.0655; train_edge_recon_loss: 2737776.6667; train_gene_expr_recon_loss: 729126.0069; train_masked_gp_l1_reg_loss: 6979.4441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68122.6398; train_chrom_access_recon_loss: 1330954.0833; train_global_loss: 4922238.8889; train_optim_loss: 4922238.8889; val_kl_reg_loss: 44517.5117; val_edge_recon_loss: 2734912.0000; val_gene_expr_recon_loss: 722786.5000; val_masked_gp_l1_reg_loss: 6959.1968; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65959.4062; val_chrom_access_recon_loss: 1323226.3750; val_global_loss: 4898361.0000; val_optim_loss: 4898361.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9325; val_auprc_score: 0.9114; val_best_acc_score: 0.8685; val_best_f1_score: 0.8778; train_kl_reg_loss: 44761.0586; train_edge_recon_loss: 2729239.9444; train_gene_expr_recon_loss: 722817.7153; train_masked_gp_l1_reg_loss: 6943.1236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64326.5148; train_chrom_access_recon_loss: 1329437.6528; train_global_loss: 4897526.0556; train_optim_loss: 4897526.0556; val_kl_reg_loss: 41312.4062; val_edge_recon_loss: 2745311.2500; val_gene_expr_recon_loss: 718903.1250; val_masked_gp_l1_reg_loss: 6919.8999; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62334.1719; val_chrom_access_recon_loss: 1320090.3750; val_global_loss: 4894871.5000; val_optim_loss: 4894871.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9334; val_auprc_score: 0.9096; val_best_acc_score: 0.8700; val_best_f1_score: 0.8804; train_kl_reg_loss: 42940.1675; train_edge_recon_loss: 2721068.8056; train_gene_expr_recon_loss: 716621.6597; train_masked_gp_l1_reg_loss: 6921.2142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60842.4735; train_chrom_access_recon_loss: 1317078.8194; train_global_loss: 4865473.1667; train_optim_loss: 4865473.1667; val_kl_reg_loss: 41698.8359; val_edge_recon_loss: 2752914.2500; val_gene_expr_recon_loss: 713924.5625; val_masked_gp_l1_reg_loss: 6920.3130; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59023.4961; val_chrom_access_recon_loss: 1317959.3750; val_global_loss: 4892440.5000; val_optim_loss: 4892440.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9361; val_auprc_score: 0.9139; val_best_acc_score: 0.8810; val_best_f1_score: 0.8877; train_kl_reg_loss: 43340.2153; train_edge_recon_loss: 2721898.2222; train_gene_expr_recon_loss: 708128.5000; train_masked_gp_l1_reg_loss: 6921.7275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57656.4436; train_chrom_access_recon_loss: 1313288.5000; train_global_loss: 4851233.6111; train_optim_loss: 4851233.6111; val_kl_reg_loss: 41584.3281; val_edge_recon_loss: 2733138.2500; val_gene_expr_recon_loss: 709304.6250; val_masked_gp_l1_reg_loss: 6913.9751; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55984.2500; val_chrom_access_recon_loss: 1314962.7500; val_global_loss: 4861888.0000; val_optim_loss: 4861888.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9433; val_auprc_score: 0.9260; val_best_acc_score: 0.8832; val_best_f1_score: 0.8909; train_kl_reg_loss: 42716.3355; train_edge_recon_loss: 2727781.5833; train_gene_expr_recon_loss: 708310.9236; train_masked_gp_l1_reg_loss: 6916.1025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54724.3815; train_chrom_access_recon_loss: 1313281.1111; train_global_loss: 4853730.6111; train_optim_loss: 4853730.6111; val_kl_reg_loss: 41070.3555; val_edge_recon_loss: 2737652.2500; val_gene_expr_recon_loss: 705682.1875; val_masked_gp_l1_reg_loss: 6912.1538; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53182.5781; val_chrom_access_recon_loss: 1311372.3750; val_global_loss: 4855872.0000; val_optim_loss: 4855872.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9417; val_auprc_score: 0.9214; val_best_acc_score: 0.8874; val_best_f1_score: 0.8949; train_kl_reg_loss: 42062.4197; train_edge_recon_loss: 2715899.1944; train_gene_expr_recon_loss: 703796.8889; train_masked_gp_l1_reg_loss: 6928.0439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52019.5668; train_chrom_access_recon_loss: 1309225.6111; train_global_loss: 4829931.6667; train_optim_loss: 4829931.6667; val_kl_reg_loss: 40915.4375; val_edge_recon_loss: 2715321.5000; val_gene_expr_recon_loss: 703605.4375; val_masked_gp_l1_reg_loss: 6939.8623; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50599.2891; val_chrom_access_recon_loss: 1310379.5000; val_global_loss: 4827761.0000; val_optim_loss: 4827761.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9468; val_auprc_score: 0.9277; val_best_acc_score: 0.8918; val_best_f1_score: 0.8989; train_kl_reg_loss: 42465.0968; train_edge_recon_loss: 2727312.3611; train_gene_expr_recon_loss: 701473.7639; train_masked_gp_l1_reg_loss: 6954.1338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49521.2943; train_chrom_access_recon_loss: 1311219.9583; train_global_loss: 4838946.5556; train_optim_loss: 4838946.5556; val_kl_reg_loss: 40637.2969; val_edge_recon_loss: 2722886.0000; val_gene_expr_recon_loss: 700853.3750; val_masked_gp_l1_reg_loss: 6968.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48199.9023; val_chrom_access_recon_loss: 1307311.3750; val_global_loss: 4826856.0000; val_optim_loss: 4826856.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9494; val_auprc_score: 0.9332; val_best_acc_score: 0.8926; val_best_f1_score: 0.8999; train_kl_reg_loss: 41912.2040; train_edge_recon_loss: 2719883.5278; train_gene_expr_recon_loss: 699466.3333; train_masked_gp_l1_reg_loss: 6986.3056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47202.1771; train_chrom_access_recon_loss: 1312421.6528; train_global_loss: 4827872.1667; train_optim_loss: 4827872.1667; val_kl_reg_loss: 40158.9883; val_edge_recon_loss: 2709142.0000; val_gene_expr_recon_loss: 698768.6250; val_masked_gp_l1_reg_loss: 7003.1211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45975.0469; val_chrom_access_recon_loss: 1305136.5000; val_global_loss: 4806184.0000; val_optim_loss: 4806184.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9535; val_auprc_score: 0.9378; val_best_acc_score: 0.9004; val_best_f1_score: 0.9058; train_kl_reg_loss: 41202.7917; train_edge_recon_loss: 2719870.5833; train_gene_expr_recon_loss: 694797.8819; train_masked_gp_l1_reg_loss: 7024.4865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45052.2214; train_chrom_access_recon_loss: 1302470.0556; train_global_loss: 4810418.0556; train_optim_loss: 4810418.0556; val_kl_reg_loss: 39872.1875; val_edge_recon_loss: 2698363.0000; val_gene_expr_recon_loss: 696315.9375; val_masked_gp_l1_reg_loss: 7043.4956; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43915.5781; val_chrom_access_recon_loss: 1302920.2500; val_global_loss: 4788430.5000; val_optim_loss: 4788430.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9598; val_auprc_score: 0.9453; val_best_acc_score: 0.9080; val_best_f1_score: 0.9121; train_kl_reg_loss: 40959.9644; train_edge_recon_loss: 2714707.0278; train_gene_expr_recon_loss: 696437.9236; train_masked_gp_l1_reg_loss: 7061.4660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43056.4549; train_chrom_access_recon_loss: 1306362.9444; train_global_loss: 4808585.7222; train_optim_loss: 4808585.7222; val_kl_reg_loss: 39479.0781; val_edge_recon_loss: 2702596.2500; val_gene_expr_recon_loss: 694261.2500; val_masked_gp_l1_reg_loss: 7076.7114; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41998.6406; val_chrom_access_recon_loss: 1301169.6250; val_global_loss: 4786581.5000; val_optim_loss: 4786581.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9612; val_auprc_score: 0.9474; val_best_acc_score: 0.9061; val_best_f1_score: 0.9106; train_kl_reg_loss: 38342.1966; train_edge_recon_loss: 2718098.3611; train_gene_expr_recon_loss: 995972.5903; train_masked_gp_l1_reg_loss: 7124.6867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40969.7795; train_chrom_access_recon_loss: 1390901.8889; train_global_loss: 5191409.5556; train_optim_loss: 5191409.5556; val_kl_reg_loss: 13252.2871; val_edge_recon_loss: 2732931.0000; val_gene_expr_recon_loss: 986334.3750; val_masked_gp_l1_reg_loss: 7150.3975; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39568.2188; val_chrom_access_recon_loss: 1378476.5000; val_global_loss: 5157713.0000; val_optim_loss: 5157713.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9700; val_auprc_score: 0.9603; val_best_acc_score: 0.9216; val_best_f1_score: 0.9244; train_kl_reg_loss: 34909.0560; train_edge_recon_loss: 2719094.0833; train_gene_expr_recon_loss: 989395.2569; train_masked_gp_l1_reg_loss: 7172.8919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38375.0074; train_chrom_access_recon_loss: 1380375.2639; train_global_loss: 5169321.5556; train_optim_loss: 5169321.5556; val_kl_reg_loss: 12907.7441; val_edge_recon_loss: 2702990.2500; val_gene_expr_recon_loss: 982661.8125; val_masked_gp_l1_reg_loss: 7201.8643; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36889.0195; val_chrom_access_recon_loss: 1377293.8750; val_global_loss: 5119944.5000; val_optim_loss: 5119944.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9673; val_auprc_score: 0.9531; val_best_acc_score: 0.9186; val_best_f1_score: 0.9224; train_kl_reg_loss: 32225.6944; train_edge_recon_loss: 2696494.3056; train_gene_expr_recon_loss: 987954.4306; train_masked_gp_l1_reg_loss: 7228.4372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35744.0074; train_chrom_access_recon_loss: 1376535.1528; train_global_loss: 5136182.1111; train_optim_loss: 5136182.1111; val_kl_reg_loss: 12390.6357; val_edge_recon_loss: 2696750.2500; val_gene_expr_recon_loss: 982864.0000; val_masked_gp_l1_reg_loss: 7261.0176; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34347.0078; val_chrom_access_recon_loss: 1376880.6250; val_global_loss: 5110493.5000; val_optim_loss: 5110493.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9684; val_auprc_score: 0.9580; val_best_acc_score: 0.9205; val_best_f1_score: 0.9237; train_kl_reg_loss: 27836.8498; train_edge_recon_loss: 2686350.1667; train_gene_expr_recon_loss: 983574.1181; train_masked_gp_l1_reg_loss: 7284.8875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33298.1324; train_chrom_access_recon_loss: 1376562.7639; train_global_loss: 5114907.0556; train_optim_loss: 5114907.0556; val_kl_reg_loss: 11162.3662; val_edge_recon_loss: 2695787.0000; val_gene_expr_recon_loss: 983084.4375; val_masked_gp_l1_reg_loss: 7309.3760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32030.0156; val_chrom_access_recon_loss: 1377059.6250; val_global_loss: 5106433.0000; val_optim_loss: 5106433.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9687; val_auprc_score: 0.9554; val_best_acc_score: 0.9231; val_best_f1_score: 0.9267; train_kl_reg_loss: 25322.4084; train_edge_recon_loss: 2674504.9722; train_gene_expr_recon_loss: 984760.1875; train_masked_gp_l1_reg_loss: 7283.1672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31848.9618; train_chrom_access_recon_loss: 1378446.5694; train_global_loss: 5102166.3333; train_optim_loss: 5102166.3333; val_kl_reg_loss: 11111.5674; val_edge_recon_loss: 2692621.7500; val_gene_expr_recon_loss: 984256.8750; val_masked_gp_l1_reg_loss: 7257.3481; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31646.0273; val_chrom_access_recon_loss: 1377744.1250; val_global_loss: 5104637.5000; val_optim_loss: 5104637.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9711; val_auprc_score: 0.9595; val_best_acc_score: 0.9250; val_best_f1_score: 0.9276; train_kl_reg_loss: 25108.4501; train_edge_recon_loss: 2684914.6667; train_gene_expr_recon_loss: 986051.6319; train_masked_gp_l1_reg_loss: 7250.9484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31517.6775; train_chrom_access_recon_loss: 1378537.0833; train_global_loss: 5113380.4444; train_optim_loss: 5113380.4444; val_kl_reg_loss: 11082.7129; val_edge_recon_loss: 2697813.0000; val_gene_expr_recon_loss: 983661.5000; val_masked_gp_l1_reg_loss: 7240.6357; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31352.7832; val_chrom_access_recon_loss: 1377228.7500; val_global_loss: 5108379.5000; val_optim_loss: 5108379.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9719; val_auprc_score: 0.9595; val_best_acc_score: 0.9251; val_best_f1_score: 0.9278; train_kl_reg_loss: 24814.3455; train_edge_recon_loss: 2678130.5833; train_gene_expr_recon_loss: 984155.3264; train_masked_gp_l1_reg_loss: 7234.7697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31232.6480; train_chrom_access_recon_loss: 1378847.9722; train_global_loss: 5104415.7222; train_optim_loss: 5104415.7222; val_kl_reg_loss: 11075.9668; val_edge_recon_loss: 2696668.5000; val_gene_expr_recon_loss: 982139.1250; val_masked_gp_l1_reg_loss: 7227.9204; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31085.6328; val_chrom_access_recon_loss: 1376657.1250; val_global_loss: 5104854.5000; val_optim_loss: 5104854.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9723; val_auprc_score: 0.9608; val_best_acc_score: 0.9305; val_best_f1_score: 0.9331; train_kl_reg_loss: 24528.5766; train_edge_recon_loss: 2669533.2778; train_gene_expr_recon_loss: 984538.7014; train_masked_gp_l1_reg_loss: 7224.0500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30973.2057; train_chrom_access_recon_loss: 1379730.3056; train_global_loss: 5096528.1667; train_optim_loss: 5096528.1667; val_kl_reg_loss: 10933.7842; val_edge_recon_loss: 2666018.2500; val_gene_expr_recon_loss: 983718.3750; val_masked_gp_l1_reg_loss: 7220.1372; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30838.5059; val_chrom_access_recon_loss: 1377195.5000; val_global_loss: 5075925.0000; val_optim_loss: 5075925.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 32 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9589
val AUPRC score: 0.9439
val best accuracy score: 0.9034
val best F1 score: 0.9081
val target rna MSE score: 3.9534
val source rna MSE score: 3.2465
val target atac MSE score: 0.1351
val source atac MSE score: 0.0209
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
