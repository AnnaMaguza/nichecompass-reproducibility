[True]
Run timestamp: 10102023_083916_205.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_205']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7736; val_auprc_score: 0.7933; val_best_acc_score: 0.5450; val_best_f1_score: 0.6861; train_kl_reg_loss: 82170.9853; train_edge_recon_loss: 754914.4604; train_gene_expr_recon_loss: 22019632.3664; train_masked_gp_l1_reg_loss: 59671.2124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3985450.1269; train_chrom_access_recon_loss: 6664758.7748; train_global_loss: 33566598.1985; train_optim_loss: 33566598.1985; val_kl_reg_loss: 87911.0380; val_edge_recon_loss: 812555.3792; val_gene_expr_recon_loss: 20818839.2000; val_masked_gp_l1_reg_loss: 62840.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 924694.1875; val_chrom_access_recon_loss: 6424858.6667; val_global_loss: 29131698.4000; val_optim_loss: 29131698.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8777; val_auprc_score: 0.8735; val_best_acc_score: 0.7564; val_best_f1_score: 0.7921; train_kl_reg_loss: 79144.7534; train_edge_recon_loss: 735096.6255; train_gene_expr_recon_loss: 20866949.1908; train_masked_gp_l1_reg_loss: 63831.1550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 476799.1586; train_chrom_access_recon_loss: 6454301.6603; train_global_loss: 28676122.6718; train_optim_loss: 28676122.6718; val_kl_reg_loss: 63112.5961; val_edge_recon_loss: 785321.5792; val_gene_expr_recon_loss: 20630256.9333; val_masked_gp_l1_reg_loss: 65397.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 276122.3125; val_chrom_access_recon_loss: 6423842.2333; val_global_loss: 28244053.0667; val_optim_loss: 28244053.0667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9138; val_auprc_score: 0.9037; val_best_acc_score: 0.8372; val_best_f1_score: 0.8463; train_kl_reg_loss: 73056.0023; train_edge_recon_loss: 686095.6107; train_gene_expr_recon_loss: 20587967.5573; train_masked_gp_l1_reg_loss: 67423.5523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 226584.5163; train_chrom_access_recon_loss: 6379583.7137; train_global_loss: 28020710.8855; train_optim_loss: 28020710.8855; val_kl_reg_loss: 80459.1755; val_edge_recon_loss: 642670.2792; val_gene_expr_recon_loss: 20384696.2667; val_masked_gp_l1_reg_loss: 69687.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 196441.1875; val_chrom_access_recon_loss: 6325090.6333; val_global_loss: 27699046.1333; val_optim_loss: 27699046.1333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9252; val_auprc_score: 0.9120; val_best_acc_score: 0.8545; val_best_f1_score: 0.8634; train_kl_reg_loss: 79884.8768; train_edge_recon_loss: 628662.5157; train_gene_expr_recon_loss: 20364820.5344; train_masked_gp_l1_reg_loss: 71760.3518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 177305.6642; train_chrom_access_recon_loss: 6316509.6908; train_global_loss: 27638943.6336; train_optim_loss: 27638943.6336; val_kl_reg_loss: 77925.6714; val_edge_recon_loss: 621749.1208; val_gene_expr_recon_loss: 20187124.8000; val_masked_gp_l1_reg_loss: 73724.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 165419.1094; val_chrom_access_recon_loss: 6290131.7000; val_global_loss: 27416074.9333; val_optim_loss: 27416074.9333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9338; val_auprc_score: 0.9198; val_best_acc_score: 0.8645; val_best_f1_score: 0.8716; train_kl_reg_loss: 77145.7539; train_edge_recon_loss: 614921.8965; train_gene_expr_recon_loss: 20179674.0611; train_masked_gp_l1_reg_loss: 75249.7995; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156685.8214; train_chrom_access_recon_loss: 6265942.6794; train_global_loss: 27369620.0611; train_optim_loss: 27369620.0611; val_kl_reg_loss: 76436.4922; val_edge_recon_loss: 612104.9500; val_gene_expr_recon_loss: 20011144.5333; val_masked_gp_l1_reg_loss: 76767.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149090.5156; val_chrom_access_recon_loss: 6273716.9333; val_global_loss: 27199260.6667; val_optim_loss: 27199260.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9386; val_auprc_score: 0.9291; val_best_acc_score: 0.8658; val_best_f1_score: 0.8750; train_kl_reg_loss: 74471.0426; train_edge_recon_loss: 607968.0091; train_gene_expr_recon_loss: 20007169.1145; train_masked_gp_l1_reg_loss: 77825.5042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143017.9284; train_chrom_access_recon_loss: 6216971.9351; train_global_loss: 27127423.4962; train_optim_loss: 27127423.4962; val_kl_reg_loss: 73278.2797; val_edge_recon_loss: 604788.5333; val_gene_expr_recon_loss: 19765146.8000; val_masked_gp_l1_reg_loss: 79031.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137703.8594; val_chrom_access_recon_loss: 6186593.5667; val_global_loss: 26846542.9333; val_optim_loss: 26846542.9333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9426; val_auprc_score: 0.9320; val_best_acc_score: 0.8748; val_best_f1_score: 0.8800; train_kl_reg_loss: 71936.0754; train_edge_recon_loss: 600667.1121; train_gene_expr_recon_loss: 19876787.7099; train_masked_gp_l1_reg_loss: 79797.0315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133853.4302; train_chrom_access_recon_loss: 6176936.0878; train_global_loss: 26939977.2824; train_optim_loss: 26939977.2824; val_kl_reg_loss: 71868.4245; val_edge_recon_loss: 605302.0167; val_gene_expr_recon_loss: 19775919.0667; val_masked_gp_l1_reg_loss: 80796.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131229.2500; val_chrom_access_recon_loss: 6170555.6333; val_global_loss: 26835670.8000; val_optim_loss: 26835670.8000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9529; val_auprc_score: 0.9424; val_best_acc_score: 0.8886; val_best_f1_score: 0.8937; train_kl_reg_loss: 70148.1810; train_edge_recon_loss: 597203.8435; train_gene_expr_recon_loss: 19732782.6260; train_masked_gp_l1_reg_loss: 81299.7029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128977.1160; train_chrom_access_recon_loss: 6137420.3893; train_global_loss: 26747831.8931; train_optim_loss: 26747831.8931; val_kl_reg_loss: 68827.4070; val_edge_recon_loss: 594335.6833; val_gene_expr_recon_loss: 19491181.4667; val_masked_gp_l1_reg_loss: 82040.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127682.8672; val_chrom_access_recon_loss: 6105220.7667; val_global_loss: 26469287.3333; val_optim_loss: 26469287.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9564; val_auprc_score: 0.9487; val_best_acc_score: 0.8914; val_best_f1_score: 0.8961; train_kl_reg_loss: 68734.4297; train_edge_recon_loss: 593358.2781; train_gene_expr_recon_loss: 19649370.5191; train_masked_gp_l1_reg_loss: 82701.2688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125622.7494; train_chrom_access_recon_loss: 6105378.1336; train_global_loss: 26625165.5878; train_optim_loss: 26625165.5878; val_kl_reg_loss: 66591.8497; val_edge_recon_loss: 595766.3125; val_gene_expr_recon_loss: 19489113.3333; val_masked_gp_l1_reg_loss: 83334.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124417.9688; val_chrom_access_recon_loss: 6120177.3000; val_global_loss: 26479400.5333; val_optim_loss: 26479400.5333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9597; val_auprc_score: 0.9504; val_best_acc_score: 0.9007; val_best_f1_score: 0.9042; train_kl_reg_loss: 67670.9033; train_edge_recon_loss: 590177.6217; train_gene_expr_recon_loss: 19536058.1069; train_masked_gp_l1_reg_loss: 83835.1908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121935.9516; train_chrom_access_recon_loss: 6068556.0458; train_global_loss: 26468233.7099; train_optim_loss: 26468233.7099; val_kl_reg_loss: 66186.8987; val_edge_recon_loss: 591334.9708; val_gene_expr_recon_loss: 19426587.8667; val_masked_gp_l1_reg_loss: 84308.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119790.9062; val_chrom_access_recon_loss: 6077949.5667; val_global_loss: 26366157.0667; val_optim_loss: 26366157.0667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9614; val_auprc_score: 0.9526; val_best_acc_score: 0.9029; val_best_f1_score: 0.9061; train_kl_reg_loss: 66345.6005; train_edge_recon_loss: 589087.8445; train_gene_expr_recon_loss: 19445655.0076; train_masked_gp_l1_reg_loss: 84824.4941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118208.9300; train_chrom_access_recon_loss: 6030291.6183; train_global_loss: 26334413.6031; train_optim_loss: 26334413.6031; val_kl_reg_loss: 67110.2406; val_edge_recon_loss: 590995.9667; val_gene_expr_recon_loss: 19296042.5333; val_masked_gp_l1_reg_loss: 85391.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117446.6172; val_chrom_access_recon_loss: 6043788.0333; val_global_loss: 26200774.9333; val_optim_loss: 26200774.9333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9640; val_auprc_score: 0.9560; val_best_acc_score: 0.9080; val_best_f1_score: 0.9102; train_kl_reg_loss: 65249.1823; train_edge_recon_loss: 587351.5091; train_gene_expr_recon_loss: 19376740.1679; train_masked_gp_l1_reg_loss: 85801.4603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115765.1613; train_chrom_access_recon_loss: 6013595.0992; train_global_loss: 26244502.4580; train_optim_loss: 26244502.4580; val_kl_reg_loss: 65398.9516; val_edge_recon_loss: 586173.4917; val_gene_expr_recon_loss: 19215932.2667; val_masked_gp_l1_reg_loss: 86330.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115167.4688; val_chrom_access_recon_loss: 5998759.1333; val_global_loss: 26067761.8667; val_optim_loss: 26067761.8667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9675; val_auprc_score: 0.9610; val_best_acc_score: 0.9128; val_best_f1_score: 0.9151; train_kl_reg_loss: 64351.7650; train_edge_recon_loss: 585972.4041; train_gene_expr_recon_loss: 19288799.7099; train_masked_gp_l1_reg_loss: 86868.5178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113830.6499; train_chrom_access_recon_loss: 5971263.0687; train_global_loss: 26111086.1527; train_optim_loss: 26111086.1527; val_kl_reg_loss: 64935.3039; val_edge_recon_loss: 588213.1792; val_gene_expr_recon_loss: 19113444.9333; val_masked_gp_l1_reg_loss: 87480.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113988.8594; val_chrom_access_recon_loss: 5962952.5667; val_global_loss: 25931013.8667; val_optim_loss: 25931013.8667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9679; val_auprc_score: 0.9602; val_best_acc_score: 0.9132; val_best_f1_score: 0.9147; train_kl_reg_loss: 63448.9725; train_edge_recon_loss: 583989.1255; train_gene_expr_recon_loss: 19206443.1450; train_masked_gp_l1_reg_loss: 87874.4261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111831.9806; train_chrom_access_recon_loss: 5934568.0916; train_global_loss: 25988155.8321; train_optim_loss: 25988155.8321; val_kl_reg_loss: 62682.4539; val_edge_recon_loss: 587287.4917; val_gene_expr_recon_loss: 19093551.3333; val_masked_gp_l1_reg_loss: 88422.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110778.4453; val_chrom_access_recon_loss: 5948824.0667; val_global_loss: 25891545.3333; val_optim_loss: 25891545.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9703; val_auprc_score: 0.9650; val_best_acc_score: 0.9159; val_best_f1_score: 0.9186; train_kl_reg_loss: 62728.4852; train_edge_recon_loss: 582714.8669; train_gene_expr_recon_loss: 19148290.3817; train_masked_gp_l1_reg_loss: 88853.9784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110102.1814; train_chrom_access_recon_loss: 5911799.3931; train_global_loss: 25904489.5420; train_optim_loss: 25904489.5420; val_kl_reg_loss: 63276.2422; val_edge_recon_loss: 585066.2500; val_gene_expr_recon_loss: 18998311.0667; val_masked_gp_l1_reg_loss: 89632.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110222.5859; val_chrom_access_recon_loss: 5915654.8333; val_global_loss: 25762162.2667; val_optim_loss: 25762162.2667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9712; val_auprc_score: 0.9657; val_best_acc_score: 0.9181; val_best_f1_score: 0.9210; train_kl_reg_loss: 62080.4706; train_edge_recon_loss: 580702.0811; train_gene_expr_recon_loss: 19086088.5344; train_masked_gp_l1_reg_loss: 90077.2777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109524.9777; train_chrom_access_recon_loss: 5883115.6908; train_global_loss: 25811589.0687; train_optim_loss: 25811589.0687; val_kl_reg_loss: 61283.2844; val_edge_recon_loss: 586280.7208; val_gene_expr_recon_loss: 19026630.8000; val_masked_gp_l1_reg_loss: 90757.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110256.7969; val_chrom_access_recon_loss: 5908085.6667; val_global_loss: 25783294.8000; val_optim_loss: 25783294.8000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9694; val_auprc_score: 0.9630; val_best_acc_score: 0.9175; val_best_f1_score: 0.9205; train_kl_reg_loss: 61615.9091; train_edge_recon_loss: 580021.8860; train_gene_expr_recon_loss: 19005214.0153; train_masked_gp_l1_reg_loss: 91366.4148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109071.6973; train_chrom_access_recon_loss: 5848231.8893; train_global_loss: 25695521.7252; train_optim_loss: 25695521.7252; val_kl_reg_loss: 59978.2562; val_edge_recon_loss: 584682.6167; val_gene_expr_recon_loss: 18895188.6667; val_masked_gp_l1_reg_loss: 91896.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108797.6797; val_chrom_access_recon_loss: 5854637.8000; val_global_loss: 25595180.9333; val_optim_loss: 25595180.9333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9695; val_auprc_score: 0.9588; val_best_acc_score: 0.9198; val_best_f1_score: 0.9217; train_kl_reg_loss: 61066.8888; train_edge_recon_loss: 580094.8946; train_gene_expr_recon_loss: 18969035.3130; train_masked_gp_l1_reg_loss: 92543.3527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108605.9606; train_chrom_access_recon_loss: 5829055.8244; train_global_loss: 25640402.1374; train_optim_loss: 25640402.1374; val_kl_reg_loss: 61256.2214; val_edge_recon_loss: 582971.6542; val_gene_expr_recon_loss: 18902743.2000; val_masked_gp_l1_reg_loss: 93064.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108213.3047; val_chrom_access_recon_loss: 5874983.2667; val_global_loss: 25623231.8667; val_optim_loss: 25623231.8667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9722; val_auprc_score: 0.9664; val_best_acc_score: 0.9221; val_best_f1_score: 0.9234; train_kl_reg_loss: 60543.5866; train_edge_recon_loss: 579314.5272; train_gene_expr_recon_loss: 18894922.2443; train_masked_gp_l1_reg_loss: 93753.5688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108223.2916; train_chrom_access_recon_loss: 5795434.0954; train_global_loss: 25532191.4504; train_optim_loss: 25532191.4504; val_kl_reg_loss: 60601.8167; val_edge_recon_loss: 583519.6167; val_gene_expr_recon_loss: 18845594.9333; val_masked_gp_l1_reg_loss: 94407.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108789.6094; val_chrom_access_recon_loss: 5809248.0000; val_global_loss: 25502162.0000; val_optim_loss: 25502162.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9704; val_auprc_score: 0.9647; val_best_acc_score: 0.9193; val_best_f1_score: 0.9227; train_kl_reg_loss: 60321.6341; train_edge_recon_loss: 580366.9728; train_gene_expr_recon_loss: 18832468.7328; train_masked_gp_l1_reg_loss: 95148.8938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108544.6257; train_chrom_access_recon_loss: 5774802.7557; train_global_loss: 25451653.8015; train_optim_loss: 25451653.8015; val_kl_reg_loss: 60354.2802; val_edge_recon_loss: 584557.5417; val_gene_expr_recon_loss: 18808954.4000; val_masked_gp_l1_reg_loss: 95620.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108716.6562; val_chrom_access_recon_loss: 5831125.2333; val_global_loss: 25489327.4667; val_optim_loss: 25489327.4667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9703; val_auprc_score: 0.9628; val_best_acc_score: 0.9237; val_best_f1_score: 0.9257; train_kl_reg_loss: 60641.8345; train_edge_recon_loss: 577863.1484; train_gene_expr_recon_loss: 18756635.4656; train_masked_gp_l1_reg_loss: 96265.2933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108480.3405; train_chrom_access_recon_loss: 5752471.7023; train_global_loss: 25352357.9542; train_optim_loss: 25352357.9542; val_kl_reg_loss: 58684.0154; val_edge_recon_loss: 581650.8750; val_gene_expr_recon_loss: 18759704.5333; val_masked_gp_l1_reg_loss: 97016.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109014.1406; val_chrom_access_recon_loss: 5815715.2333; val_global_loss: 25421784.8000; val_optim_loss: 25421784.8000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9677; val_auprc_score: 0.9595; val_best_acc_score: 0.9142; val_best_f1_score: 0.9172; train_kl_reg_loss: 60099.8007; train_edge_recon_loss: 578994.7147; train_gene_expr_recon_loss: 18722032.1832; train_masked_gp_l1_reg_loss: 97456.2087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108823.1252; train_chrom_access_recon_loss: 5739096.3740; train_global_loss: 25306502.1832; train_optim_loss: 25306502.1832; val_kl_reg_loss: 59594.1758; val_edge_recon_loss: 584005.3458; val_gene_expr_recon_loss: 18719431.2000; val_masked_gp_l1_reg_loss: 97978.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109272.9531; val_chrom_access_recon_loss: 5789672.9000; val_global_loss: 25359953.6000; val_optim_loss: 25359953.6000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9728; val_auprc_score: 0.9678; val_best_acc_score: 0.9212; val_best_f1_score: 0.9241; train_kl_reg_loss: 60496.1422; train_edge_recon_loss: 578522.1207; train_gene_expr_recon_loss: 18667316.1832; train_masked_gp_l1_reg_loss: 98503.2167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108967.7773; train_chrom_access_recon_loss: 5715765.4046; train_global_loss: 25229570.6718; train_optim_loss: 25229570.6718; val_kl_reg_loss: 61550.5401; val_edge_recon_loss: 579466.8083; val_gene_expr_recon_loss: 18712039.4667; val_masked_gp_l1_reg_loss: 98887.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109821.3359; val_chrom_access_recon_loss: 5810611.7333; val_global_loss: 25372378.2667; val_optim_loss: 25372378.2667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9678; val_auprc_score: 0.9591; val_best_acc_score: 0.9163; val_best_f1_score: 0.9200; train_kl_reg_loss: 60888.6082; train_edge_recon_loss: 577492.9561; train_gene_expr_recon_loss: 18609156.8702; train_masked_gp_l1_reg_loss: 99235.4989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109266.2257; train_chrom_access_recon_loss: 5698512.0496; train_global_loss: 25154552.2748; train_optim_loss: 25154552.2748; val_kl_reg_loss: 61211.3112; val_edge_recon_loss: 580976.4667; val_gene_expr_recon_loss: 18645068.9333; val_masked_gp_l1_reg_loss: 99606.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110105.8359; val_chrom_access_recon_loss: 5775888.6667; val_global_loss: 25272857.7333; val_optim_loss: 25272857.7333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9676; val_auprc_score: 0.9594; val_best_acc_score: 0.9142; val_best_f1_score: 0.9180; train_kl_reg_loss: 61081.5577; train_edge_recon_loss: 578250.0997; train_gene_expr_recon_loss: 18580424.2290; train_masked_gp_l1_reg_loss: 99916.7645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109584.7746; train_chrom_access_recon_loss: 5692784.7748; train_global_loss: 25122042.2443; train_optim_loss: 25122042.2443; val_kl_reg_loss: 61085.8018; val_edge_recon_loss: 582274.6917; val_gene_expr_recon_loss: 18619378.2667; val_masked_gp_l1_reg_loss: 99844.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110273.0938; val_chrom_access_recon_loss: 5771503.7333; val_global_loss: 25244360.5333; val_optim_loss: 25244360.5333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9278; val_auprc_score: 0.9216; val_best_acc_score: 0.8471; val_best_f1_score: 0.8589; train_kl_reg_loss: 33693.7869; train_edge_recon_loss: 764821.3960; train_gene_expr_recon_loss: 17299458.9542; train_masked_gp_l1_reg_loss: 94144.4222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103276.5483; train_chrom_access_recon_loss: 5331169.4733; train_global_loss: 23626564.6107; train_optim_loss: 23626564.6107; val_kl_reg_loss: 14839.6517; val_edge_recon_loss: 783532.3792; val_gene_expr_recon_loss: 17030875.2000; val_masked_gp_l1_reg_loss: 87922.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104697.2812; val_chrom_access_recon_loss: 5316633.6000; val_global_loss: 23338500.6667; val_optim_loss: 23338500.6667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9273; val_auprc_score: 0.9197; val_best_acc_score: 0.8519; val_best_f1_score: 0.8606; train_kl_reg_loss: 22119.1264; train_edge_recon_loss: 752391.4442; train_gene_expr_recon_loss: 17061296.2214; train_masked_gp_l1_reg_loss: 82887.8199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101397.8937; train_chrom_access_recon_loss: 5289570.7405; train_global_loss: 23309663.3740; train_optim_loss: 23309663.3740; val_kl_reg_loss: 13907.1725; val_edge_recon_loss: 727159.7542; val_gene_expr_recon_loss: 16862931.4667; val_masked_gp_l1_reg_loss: 79376.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99131.9297; val_chrom_access_recon_loss: 5271809.5333; val_global_loss: 23054315.8667; val_optim_loss: 23054315.8667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9070; val_auprc_score: 0.8928; val_best_acc_score: 0.8302; val_best_f1_score: 0.8423; train_kl_reg_loss: 26791.0656; train_edge_recon_loss: 666486.3282; train_gene_expr_recon_loss: 16935785.0611; train_masked_gp_l1_reg_loss: 76053.0467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95280.8320; train_chrom_access_recon_loss: 5265796.9695; train_global_loss: 23066193.2977; train_optim_loss: 23066193.2977; val_kl_reg_loss: 25880.0853; val_edge_recon_loss: 626343.0250; val_gene_expr_recon_loss: 16788701.8667; val_masked_gp_l1_reg_loss: 73640.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93939.5703; val_chrom_access_recon_loss: 5275893.2667; val_global_loss: 22884398.2667; val_optim_loss: 22884398.2667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9088; val_auprc_score: 0.8967; val_best_acc_score: 0.8236; val_best_f1_score: 0.8369; train_kl_reg_loss: 37011.6222; train_edge_recon_loss: 613293.8707; train_gene_expr_recon_loss: 16871234.8092; train_masked_gp_l1_reg_loss: 71935.8686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93312.2368; train_chrom_access_recon_loss: 5252746.9046; train_global_loss: 22939535.3588; train_optim_loss: 22939535.3588; val_kl_reg_loss: 32973.7757; val_edge_recon_loss: 610314.8750; val_gene_expr_recon_loss: 16745729.9333; val_masked_gp_l1_reg_loss: 70265.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93494.6172; val_chrom_access_recon_loss: 5237798.6333; val_global_loss: 22790576.8000; val_optim_loss: 22790576.8000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9084; val_auprc_score: 0.8975; val_best_acc_score: 0.8292; val_best_f1_score: 0.8392; train_kl_reg_loss: 40024.9519; train_edge_recon_loss: 602864.7180; train_gene_expr_recon_loss: 16848162.2672; train_masked_gp_l1_reg_loss: 68995.7479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92876.9507; train_chrom_access_recon_loss: 5245167.1031; train_global_loss: 22898091.7710; train_optim_loss: 22898091.7710; val_kl_reg_loss: 34469.9385; val_edge_recon_loss: 604160.2708; val_gene_expr_recon_loss: 16700754.2667; val_masked_gp_l1_reg_loss: 67821.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93397.4219; val_chrom_access_recon_loss: 5228427.6000; val_global_loss: 22729031.7333; val_optim_loss: 22729031.7333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9104; val_auprc_score: 0.8961; val_best_acc_score: 0.8358; val_best_f1_score: 0.8465; train_kl_reg_loss: 41394.6797; train_edge_recon_loss: 598732.6727; train_gene_expr_recon_loss: 16817888.5802; train_masked_gp_l1_reg_loss: 66823.1020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92599.0732; train_chrom_access_recon_loss: 5238208.5458; train_global_loss: 22855646.8397; train_optim_loss: 22855646.8397; val_kl_reg_loss: 35200.3812; val_edge_recon_loss: 598820.6917; val_gene_expr_recon_loss: 16638589.2667; val_masked_gp_l1_reg_loss: 66014.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91787.5078; val_chrom_access_recon_loss: 5226428.8667; val_global_loss: 22656841.4667; val_optim_loss: 22656841.4667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9108; val_auprc_score: 0.8967; val_best_acc_score: 0.8363; val_best_f1_score: 0.8482; train_kl_reg_loss: 41846.5298; train_edge_recon_loss: 593467.4809; train_gene_expr_recon_loss: 16789920.6260; train_masked_gp_l1_reg_loss: 65161.5281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91888.1506; train_chrom_access_recon_loss: 5233268.1527; train_global_loss: 22815552.3053; train_optim_loss: 22815552.3053; val_kl_reg_loss: 36383.7591; val_edge_recon_loss: 599328.0417; val_gene_expr_recon_loss: 16699185.1333; val_masked_gp_l1_reg_loss: 64518.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91201.9531; val_chrom_access_recon_loss: 5217778.5000; val_global_loss: 22708395.3333; val_optim_loss: 22708395.3333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9170; val_auprc_score: 0.8990; val_best_acc_score: 0.8460; val_best_f1_score: 0.8559; train_kl_reg_loss: 41230.1808; train_edge_recon_loss: 590992.3736; train_gene_expr_recon_loss: 16752991.7328; train_masked_gp_l1_reg_loss: 63896.8871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91182.8393; train_chrom_access_recon_loss: 5218796.4771; train_global_loss: 22759090.4885; train_optim_loss: 22759090.4885; val_kl_reg_loss: 37622.9802; val_edge_recon_loss: 593948.4083; val_gene_expr_recon_loss: 16746971.4667; val_masked_gp_l1_reg_loss: 63328.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90221.7812; val_chrom_access_recon_loss: 5261581.6000; val_global_loss: 22793674.4000; val_optim_loss: 22793674.4000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9225; val_auprc_score: 0.9073; val_best_acc_score: 0.8510; val_best_f1_score: 0.8630; train_kl_reg_loss: 41528.1838; train_edge_recon_loss: 589341.1579; train_gene_expr_recon_loss: 16771179.8931; train_masked_gp_l1_reg_loss: 62933.5110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90344.0694; train_chrom_access_recon_loss: 5228996.7824; train_global_loss: 22784323.8473; train_optim_loss: 22784323.8473; val_kl_reg_loss: 38830.3997; val_edge_recon_loss: 593571.7542; val_gene_expr_recon_loss: 16648005.8000; val_masked_gp_l1_reg_loss: 62672.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90808.2109; val_chrom_access_recon_loss: 5229708.3667; val_global_loss: 22663596.5333; val_optim_loss: 22663596.5333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9275; val_auprc_score: 0.9090; val_best_acc_score: 0.8620; val_best_f1_score: 0.8714; train_kl_reg_loss: 41582.2339; train_edge_recon_loss: 584308.9213; train_gene_expr_recon_loss: 16743804.5496; train_masked_gp_l1_reg_loss: 62380.8061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90221.4990; train_chrom_access_recon_loss: 5219650.8550; train_global_loss: 22741948.8092; train_optim_loss: 22741948.8092; val_kl_reg_loss: 39007.9073; val_edge_recon_loss: 585886.5167; val_gene_expr_recon_loss: 16652399.0667; val_masked_gp_l1_reg_loss: 62122.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90239.5625; val_chrom_access_recon_loss: 5214575.8667; val_global_loss: 22644231.4667; val_optim_loss: 22644231.4667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9322; val_auprc_score: 0.9183; val_best_acc_score: 0.8650; val_best_f1_score: 0.8735; train_kl_reg_loss: 41192.5077; train_edge_recon_loss: 582132.7004; train_gene_expr_recon_loss: 16711487.4885; train_masked_gp_l1_reg_loss: 61928.8294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89893.6704; train_chrom_access_recon_loss: 5211806.8511; train_global_loss: 22698442.0611; train_optim_loss: 22698442.0611; val_kl_reg_loss: 38323.0922; val_edge_recon_loss: 581975.5250; val_gene_expr_recon_loss: 16614587.7333; val_masked_gp_l1_reg_loss: 61626.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89553.7266; val_chrom_access_recon_loss: 5203275.9667; val_global_loss: 22589342.4000; val_optim_loss: 22589342.4000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9351; val_auprc_score: 0.9175; val_best_acc_score: 0.8690; val_best_f1_score: 0.8753; train_kl_reg_loss: 40939.2679; train_edge_recon_loss: 580377.2257; train_gene_expr_recon_loss: 16709605.6031; train_masked_gp_l1_reg_loss: 61475.7748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89362.3472; train_chrom_access_recon_loss: 5205944.7252; train_global_loss: 22687705.0229; train_optim_loss: 22687705.0229; val_kl_reg_loss: 38209.0461; val_edge_recon_loss: 582052.5708; val_gene_expr_recon_loss: 16633901.0667; val_masked_gp_l1_reg_loss: 61374.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89377.1797; val_chrom_access_recon_loss: 5200160.0667; val_global_loss: 22605074.6667; val_optim_loss: 22605074.6667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9421; val_auprc_score: 0.9306; val_best_acc_score: 0.8755; val_best_f1_score: 0.8817; train_kl_reg_loss: 40878.8360; train_edge_recon_loss: 579350.4389; train_gene_expr_recon_loss: 16681691.0076; train_masked_gp_l1_reg_loss: 61266.0764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89341.4756; train_chrom_access_recon_loss: 5201690.0763; train_global_loss: 22654217.8168; train_optim_loss: 22654217.8168; val_kl_reg_loss: 38816.5057; val_edge_recon_loss: 580486.0917; val_gene_expr_recon_loss: 16594742.2000; val_masked_gp_l1_reg_loss: 61121.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89073.3516; val_chrom_access_recon_loss: 5204302.1333; val_global_loss: 22568543.0667; val_optim_loss: 22568543.0667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9390; val_auprc_score: 0.9260; val_best_acc_score: 0.8717; val_best_f1_score: 0.8790; train_kl_reg_loss: 40862.5894; train_edge_recon_loss: 576069.6388; train_gene_expr_recon_loss: 16663296.3817; train_masked_gp_l1_reg_loss: 61039.8491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89139.8643; train_chrom_access_recon_loss: 5186831.8053; train_global_loss: 22617240.1832; train_optim_loss: 22617240.1832; val_kl_reg_loss: 38636.5674; val_edge_recon_loss: 582408.9958; val_gene_expr_recon_loss: 16571343.0000; val_masked_gp_l1_reg_loss: 61002.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88948.8906; val_chrom_access_recon_loss: 5196044.3000; val_global_loss: 22538383.2000; val_optim_loss: 22538383.2000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9435; val_auprc_score: 0.9291; val_best_acc_score: 0.8747; val_best_f1_score: 0.8835; train_kl_reg_loss: 41035.9173; train_edge_recon_loss: 576184.9184; train_gene_expr_recon_loss: 16659999.3511; train_masked_gp_l1_reg_loss: 61013.6847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89041.5292; train_chrom_access_recon_loss: 5189783.2863; train_global_loss: 22617058.5038; train_optim_loss: 22617058.5038; val_kl_reg_loss: 39051.8406; val_edge_recon_loss: 578582.7917; val_gene_expr_recon_loss: 16605299.2667; val_masked_gp_l1_reg_loss: 60981.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88954.4297; val_chrom_access_recon_loss: 5197475.4333; val_global_loss: 22570345.2000; val_optim_loss: 22570345.2000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9407; val_auprc_score: 0.9256; val_best_acc_score: 0.8781; val_best_f1_score: 0.8849; train_kl_reg_loss: 40825.5943; train_edge_recon_loss: 575255.5635; train_gene_expr_recon_loss: 16643484.0687; train_masked_gp_l1_reg_loss: 61031.9685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88860.0488; train_chrom_access_recon_loss: 5182551.5000; train_global_loss: 22592008.7786; train_optim_loss: 22592008.7786; val_kl_reg_loss: 38106.5615; val_edge_recon_loss: 580554.1833; val_gene_expr_recon_loss: 16633607.6667; val_masked_gp_l1_reg_loss: 61129.0586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88744.7422; val_chrom_access_recon_loss: 5209264.0667; val_global_loss: 22611406.2667; val_optim_loss: 22611406.2667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9466; val_auprc_score: 0.9329; val_best_acc_score: 0.8856; val_best_f1_score: 0.8924; train_kl_reg_loss: 40775.7017; train_edge_recon_loss: 573906.3225; train_gene_expr_recon_loss: 16619472.3130; train_masked_gp_l1_reg_loss: 61105.4427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88807.1910; train_chrom_access_recon_loss: 5178988.4275; train_global_loss: 22563055.5420; train_optim_loss: 22563055.5420; val_kl_reg_loss: 39057.0299; val_edge_recon_loss: 576686.8125; val_gene_expr_recon_loss: 16570887.9333; val_masked_gp_l1_reg_loss: 61188.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88654.6250; val_chrom_access_recon_loss: 5189350.6333; val_global_loss: 22525824.5333; val_optim_loss: 22525824.5333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9475; val_auprc_score: 0.9348; val_best_acc_score: 0.8892; val_best_f1_score: 0.8931; train_kl_reg_loss: 40733.4081; train_edge_recon_loss: 573430.6035; train_gene_expr_recon_loss: 16617036.6031; train_masked_gp_l1_reg_loss: 61167.5588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88732.6445; train_chrom_access_recon_loss: 5183099.8282; train_global_loss: 22564200.7328; train_optim_loss: 22564200.7328; val_kl_reg_loss: 39050.6036; val_edge_recon_loss: 577243.9333; val_gene_expr_recon_loss: 16618914.6667; val_masked_gp_l1_reg_loss: 61181.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88820.6172; val_chrom_access_recon_loss: 5198784.2667; val_global_loss: 22583995.3333; val_optim_loss: 22583995.3333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9500; val_auprc_score: 0.9362; val_best_acc_score: 0.8913; val_best_f1_score: 0.8964; train_kl_reg_loss: 40665.5698; train_edge_recon_loss: 574170.8812; train_gene_expr_recon_loss: 16604272.6183; train_masked_gp_l1_reg_loss: 61208.1909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88666.2408; train_chrom_access_recon_loss: 5182745.2214; train_global_loss: 22551728.5954; train_optim_loss: 22551728.5954; val_kl_reg_loss: 38878.8620; val_edge_recon_loss: 575075.5500; val_gene_expr_recon_loss: 16525179.5333; val_masked_gp_l1_reg_loss: 61226.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88603.8047; val_chrom_access_recon_loss: 5196294.3333; val_global_loss: 22485258.0000; val_optim_loss: 22485258.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9505; val_auprc_score: 0.9360; val_best_acc_score: 0.8895; val_best_f1_score: 0.8950; train_kl_reg_loss: 40747.2405; train_edge_recon_loss: 571389.3139; train_gene_expr_recon_loss: 16594851.0992; train_masked_gp_l1_reg_loss: 61306.5296; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88698.2260; train_chrom_access_recon_loss: 5177434.0687; train_global_loss: 22534426.4427; train_optim_loss: 22534426.4427; val_kl_reg_loss: 39048.5909; val_edge_recon_loss: 573507.4208; val_gene_expr_recon_loss: 16593881.6667; val_masked_gp_l1_reg_loss: 61337.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88583.0703; val_chrom_access_recon_loss: 5213121.3667; val_global_loss: 22569480.9333; val_optim_loss: 22569480.9333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9528; val_auprc_score: 0.9411; val_best_acc_score: 0.8937; val_best_f1_score: 0.8984; train_kl_reg_loss: 40427.9250; train_edge_recon_loss: 573385.9461; train_gene_expr_recon_loss: 16583864.8550; train_masked_gp_l1_reg_loss: 61411.9256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88606.0237; train_chrom_access_recon_loss: 5174953.8740; train_global_loss: 22522650.4733; train_optim_loss: 22522650.4733; val_kl_reg_loss: 38669.4685; val_edge_recon_loss: 574896.5042; val_gene_expr_recon_loss: 16629534.6000; val_masked_gp_l1_reg_loss: 61482.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88556.8203; val_chrom_access_recon_loss: 5226763.6000; val_global_loss: 22619902.6667; val_optim_loss: 22619902.6667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9565; val_auprc_score: 0.9423; val_best_acc_score: 0.8980; val_best_f1_score: 0.9019; train_kl_reg_loss: 40621.3125; train_edge_recon_loss: 571709.5615; train_gene_expr_recon_loss: 16570844.3282; train_masked_gp_l1_reg_loss: 61587.9248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88562.1632; train_chrom_access_recon_loss: 5171605.1985; train_global_loss: 22504930.4275; train_optim_loss: 22504930.4275; val_kl_reg_loss: 36993.2867; val_edge_recon_loss: 576215.1500; val_gene_expr_recon_loss: 16545440.8000; val_masked_gp_l1_reg_loss: 61705.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88400.2656; val_chrom_access_recon_loss: 5197628.9000; val_global_loss: 22506384.1333; val_optim_loss: 22506384.1333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9494; val_auprc_score: 0.9352; val_best_acc_score: 0.8899; val_best_f1_score: 0.8931; train_kl_reg_loss: 41816.8791; train_edge_recon_loss: 574351.7662; train_gene_expr_recon_loss: 16560163.3053; train_masked_gp_l1_reg_loss: 61923.3593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88714.9890; train_chrom_access_recon_loss: 5172283.6947; train_global_loss: 22499253.9542; train_optim_loss: 22499253.9542; val_kl_reg_loss: 35259.1102; val_edge_recon_loss: 579998.6083; val_gene_expr_recon_loss: 16552362.4667; val_masked_gp_l1_reg_loss: 62233.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88454.1250; val_chrom_access_recon_loss: 5184928.2000; val_global_loss: 22503236.8000; val_optim_loss: 22503236.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9526; val_auprc_score: 0.9368; val_best_acc_score: 0.8919; val_best_f1_score: 0.8972; train_kl_reg_loss: 42784.7375; train_edge_recon_loss: 574158.2452; train_gene_expr_recon_loss: 16533571.6260; train_masked_gp_l1_reg_loss: 61513.0725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70592.1884; train_chrom_access_recon_loss: 5162873.8893; train_global_loss: 22445493.7710; train_optim_loss: 22445493.7710; val_kl_reg_loss: 36197.7432; val_edge_recon_loss: 577692.6792; val_gene_expr_recon_loss: 16475793.8667; val_masked_gp_l1_reg_loss: 61290.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68198.6250; val_chrom_access_recon_loss: 5171694.1333; val_global_loss: 22390866.6667; val_optim_loss: 22390866.6667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9522; val_auprc_score: 0.9378; val_best_acc_score: 0.8903; val_best_f1_score: 0.8956; train_kl_reg_loss: 43347.4283; train_edge_recon_loss: 576101.9528; train_gene_expr_recon_loss: 16532992.9542; train_masked_gp_l1_reg_loss: 61238.7513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67666.7620; train_chrom_access_recon_loss: 5165573.5229; train_global_loss: 22446921.0840; train_optim_loss: 22446921.0840; val_kl_reg_loss: 36443.1013; val_edge_recon_loss: 580482.8333; val_gene_expr_recon_loss: 16518346.8000; val_masked_gp_l1_reg_loss: 61189.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67178.1797; val_chrom_access_recon_loss: 5165667.4333; val_global_loss: 22429308.2667; val_optim_loss: 22429308.2667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9524; val_auprc_score: 0.9408; val_best_acc_score: 0.8884; val_best_f1_score: 0.8936; train_kl_reg_loss: 43460.0430; train_edge_recon_loss: 574547.8068; train_gene_expr_recon_loss: 16524464.8321; train_masked_gp_l1_reg_loss: 61166.5549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66826.6716; train_chrom_access_recon_loss: 5157400.4924; train_global_loss: 22427866.2748; train_optim_loss: 22427866.2748; val_kl_reg_loss: 36684.5359; val_edge_recon_loss: 578701.5708; val_gene_expr_recon_loss: 16503440.2000; val_masked_gp_l1_reg_loss: 61128.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66395.6016; val_chrom_access_recon_loss: 5172465.2000; val_global_loss: 22418815.2000; val_optim_loss: 22418815.2000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9559; val_auprc_score: 0.9461; val_best_acc_score: 0.8964; val_best_f1_score: 0.9022; train_kl_reg_loss: 43620.3525; train_edge_recon_loss: 574372.3927; train_gene_expr_recon_loss: 16528908.9160; train_masked_gp_l1_reg_loss: 61114.0304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66104.2743; train_chrom_access_recon_loss: 5162238.0267; train_global_loss: 22436358.2901; train_optim_loss: 22436358.2901; val_kl_reg_loss: 37047.4174; val_edge_recon_loss: 574855.7458; val_gene_expr_recon_loss: 16476691.2667; val_masked_gp_l1_reg_loss: 61095.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65809.3125; val_chrom_access_recon_loss: 5157261.6000; val_global_loss: 22372761.4667; val_optim_loss: 22372761.4667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9517; val_auprc_score: 0.9399; val_best_acc_score: 0.8884; val_best_f1_score: 0.8941; train_kl_reg_loss: 43770.5362; train_edge_recon_loss: 571746.8492; train_gene_expr_recon_loss: 16513644.6260; train_masked_gp_l1_reg_loss: 61089.5231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65523.0206; train_chrom_access_recon_loss: 5150928.1641; train_global_loss: 22406702.7786; train_optim_loss: 22406702.7786; val_kl_reg_loss: 37292.3229; val_edge_recon_loss: 574680.8042; val_gene_expr_recon_loss: 16516880.0667; val_masked_gp_l1_reg_loss: 61068.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65265.3945; val_chrom_access_recon_loss: 5169969.8000; val_global_loss: 22425157.0667; val_optim_loss: 22425157.0667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9564; val_auprc_score: 0.9451; val_best_acc_score: 0.8999; val_best_f1_score: 0.9040; train_kl_reg_loss: 43792.4055; train_edge_recon_loss: 573940.1298; train_gene_expr_recon_loss: 16542342.5878; train_masked_gp_l1_reg_loss: 61042.5340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65056.9799; train_chrom_access_recon_loss: 5167491.7786; train_global_loss: 22453666.3969; train_optim_loss: 22453666.3969; val_kl_reg_loss: 37430.8755; val_edge_recon_loss: 572021.5292; val_gene_expr_recon_loss: 16407544.8667; val_masked_gp_l1_reg_loss: 61024.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64773.7812; val_chrom_access_recon_loss: 5138076.1667; val_global_loss: 22280872.1333; val_optim_loss: 22280872.1333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9479; val_auprc_score: 0.9319; val_best_acc_score: 0.8835; val_best_f1_score: 0.8893; train_kl_reg_loss: 43658.9906; train_edge_recon_loss: 573018.6990; train_gene_expr_recon_loss: 16518096.4351; train_masked_gp_l1_reg_loss: 61012.8600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64486.2628; train_chrom_access_recon_loss: 5155653.3359; train_global_loss: 22415926.6870; train_optim_loss: 22415926.6870; val_kl_reg_loss: 37573.2120; val_edge_recon_loss: 580728.2250; val_gene_expr_recon_loss: 16503348.6000; val_masked_gp_l1_reg_loss: 60995.7695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64218.7188; val_chrom_access_recon_loss: 5186776.7000; val_global_loss: 22433641.2000; val_optim_loss: 22433641.2000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9542; val_auprc_score: 0.9424; val_best_acc_score: 0.8922; val_best_f1_score: 0.8968; train_kl_reg_loss: 43861.3087; train_edge_recon_loss: 573339.2385; train_gene_expr_recon_loss: 16523634.8321; train_masked_gp_l1_reg_loss: 60985.5609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64053.9973; train_chrom_access_recon_loss: 5163201.8244; train_global_loss: 22429076.8092; train_optim_loss: 22429076.8092; val_kl_reg_loss: 37887.5953; val_edge_recon_loss: 573355.2083; val_gene_expr_recon_loss: 16461122.1333; val_masked_gp_l1_reg_loss: 60963.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63786.9023; val_chrom_access_recon_loss: 5149845.0333; val_global_loss: 22346959.6000; val_optim_loss: 22346959.6000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9504; val_auprc_score: 0.9394; val_best_acc_score: 0.8884; val_best_f1_score: 0.8934; train_kl_reg_loss: 43882.9729; train_edge_recon_loss: 574442.7047; train_gene_expr_recon_loss: 16530417.2137; train_masked_gp_l1_reg_loss: 60949.2734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63666.4037; train_chrom_access_recon_loss: 5163112.0229; train_global_loss: 22436470.5496; train_optim_loss: 22436470.5496; val_kl_reg_loss: 38015.4221; val_edge_recon_loss: 578747.6375; val_gene_expr_recon_loss: 16492693.4667; val_masked_gp_l1_reg_loss: 60917.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63305.5859; val_chrom_access_recon_loss: 5192819.3667; val_global_loss: 22426499.7333; val_optim_loss: 22426499.7333
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9545; val_auprc_score: 0.9429; val_best_acc_score: 0.8940; val_best_f1_score: 0.8986; train_kl_reg_loss: 43850.1806; train_edge_recon_loss: 574403.6026; train_gene_expr_recon_loss: 16520755.0229; train_masked_gp_l1_reg_loss: 60900.7973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63159.2470; train_chrom_access_recon_loss: 5161179.3550; train_global_loss: 22424248.4122; train_optim_loss: 22424248.4122; val_kl_reg_loss: 38149.1669; val_edge_recon_loss: 571730.5667; val_gene_expr_recon_loss: 16479724.6000; val_masked_gp_l1_reg_loss: 60880.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62973.3125; val_chrom_access_recon_loss: 5174283.1333; val_global_loss: 22387741.3333; val_optim_loss: 22387741.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9540; val_auprc_score: 0.9439; val_best_acc_score: 0.8936; val_best_f1_score: 0.8972; train_kl_reg_loss: 43974.4141; train_edge_recon_loss: 572066.6570; train_gene_expr_recon_loss: 16503963.0763; train_masked_gp_l1_reg_loss: 60803.9330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61121.8032; train_chrom_access_recon_loss: 5160450.2710; train_global_loss: 22402380.2443; train_optim_loss: 22402380.2443; val_kl_reg_loss: 38299.8945; val_edge_recon_loss: 577600.5875; val_gene_expr_recon_loss: 16475947.2000; val_masked_gp_l1_reg_loss: 60774.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60887.1719; val_chrom_access_recon_loss: 5169811.2667; val_global_loss: 22383320.6667; val_optim_loss: 22383320.6667
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9494; val_auprc_score: 0.9360; val_best_acc_score: 0.8853; val_best_f1_score: 0.8891; train_kl_reg_loss: 44009.8273; train_edge_recon_loss: 572696.1455; train_gene_expr_recon_loss: 16504398.0229; train_masked_gp_l1_reg_loss: 60763.5979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60824.0729; train_chrom_access_recon_loss: 5160098.6870; train_global_loss: 22402790.3969; train_optim_loss: 22402790.3969; val_kl_reg_loss: 38518.6901; val_edge_recon_loss: 577055.5083; val_gene_expr_recon_loss: 16569541.5333; val_masked_gp_l1_reg_loss: 60756.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60765.0664; val_chrom_access_recon_loss: 5215444.5000; val_global_loss: 22522082.1333; val_optim_loss: 22522082.1333
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9520; val_auprc_score: 0.9359; val_best_acc_score: 0.8907; val_best_f1_score: 0.8953; train_kl_reg_loss: 43991.8850; train_edge_recon_loss: 570956.0577; train_gene_expr_recon_loss: 16520541.4427; train_masked_gp_l1_reg_loss: 60751.2096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60720.3405; train_chrom_access_recon_loss: 5161035.5420; train_global_loss: 22417996.3511; train_optim_loss: 22417996.3511; val_kl_reg_loss: 38450.0779; val_edge_recon_loss: 573911.5792; val_gene_expr_recon_loss: 16402183.1333; val_masked_gp_l1_reg_loss: 60746.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60673.9961; val_chrom_access_recon_loss: 5153894.8000; val_global_loss: 22289860.1333; val_optim_loss: 22289860.1333
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9563; val_auprc_score: 0.9480; val_best_acc_score: 0.8948; val_best_f1_score: 0.8995; train_kl_reg_loss: 44062.6634; train_edge_recon_loss: 572114.6555; train_gene_expr_recon_loss: 16518833.8092; train_masked_gp_l1_reg_loss: 60745.1402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60635.4475; train_chrom_access_recon_loss: 5164351.7481; train_global_loss: 22420743.2519; train_optim_loss: 22420743.2519; val_kl_reg_loss: 38481.7794; val_edge_recon_loss: 572945.9625; val_gene_expr_recon_loss: 16521273.8667; val_masked_gp_l1_reg_loss: 60739.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60599.5938; val_chrom_access_recon_loss: 5191804.6000; val_global_loss: 22445845.7333; val_optim_loss: 22445845.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 60 min 51 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9520
val AUPRC score: 0.9380
val best accuracy score: 0.8925
val best F1 score: 0.8958
val target rna MSE score: 1.4230
val source rna MSE score: 0.5084
val target atac MSE score: 0.3434
val source atac MSE score: 0.1079
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
