[True]
Run timestamp: 10102023_053000_158.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_158']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7749; val_auprc_score: 0.7903; val_best_acc_score: 0.5078; val_best_f1_score: 0.6699; train_kl_reg_loss: 39184.6198; train_edge_recon_loss: 724600.1107; train_gene_expr_recon_loss: 22482520.5496; train_masked_gp_l1_reg_loss: 140993.5236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3376136.9074; train_chrom_access_recon_loss: 2263520.7195; train_global_loss: 29026956.2901; train_optim_loss: 29026956.2901; val_kl_reg_loss: 65981.3201; val_edge_recon_loss: 812898.3833; val_gene_expr_recon_loss: 21059658.1333; val_masked_gp_l1_reg_loss: 125329.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 851791.6250; val_chrom_access_recon_loss: 2186767.3917; val_global_loss: 25102427.2000; val_optim_loss: 25102427.2000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8468; val_auprc_score: 0.8571; val_best_acc_score: 0.6039; val_best_f1_score: 0.7111; train_kl_reg_loss: 61095.2156; train_edge_recon_loss: 728817.3669; train_gene_expr_recon_loss: 21007379.0229; train_masked_gp_l1_reg_loss: 118766.9249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 425008.5571; train_chrom_access_recon_loss: 2171910.9618; train_global_loss: 24512978.0458; train_optim_loss: 24512978.0458; val_kl_reg_loss: 60964.7695; val_edge_recon_loss: 811559.7667; val_gene_expr_recon_loss: 20779591.2000; val_masked_gp_l1_reg_loss: 114452.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 227099.4531; val_chrom_access_recon_loss: 2167217.2000; val_global_loss: 24160884.9333; val_optim_loss: 24160884.9333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8967; val_auprc_score: 0.8958; val_best_acc_score: 0.8240; val_best_f1_score: 0.8278; train_kl_reg_loss: 57858.8372; train_edge_recon_loss: 723678.9919; train_gene_expr_recon_loss: 20674981.6641; train_masked_gp_l1_reg_loss: 113458.6324; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172623.4451; train_chrom_access_recon_loss: 2144208.2939; train_global_loss: 23886809.9542; train_optim_loss: 23886809.9542; val_kl_reg_loss: 52518.3958; val_edge_recon_loss: 801289.1500; val_gene_expr_recon_loss: 20459349.0667; val_masked_gp_l1_reg_loss: 113251.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 143656.6719; val_chrom_access_recon_loss: 2136389.9833; val_global_loss: 23706454.6667; val_optim_loss: 23706454.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9089; val_auprc_score: 0.9019; val_best_acc_score: 0.8314; val_best_f1_score: 0.8394; train_kl_reg_loss: 53594.1359; train_edge_recon_loss: 713895.8841; train_gene_expr_recon_loss: 20413988.9771; train_masked_gp_l1_reg_loss: 114267.6998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135104.7581; train_chrom_access_recon_loss: 2120309.0429; train_global_loss: 23551160.5649; train_optim_loss: 23551160.5649; val_kl_reg_loss: 53653.5643; val_edge_recon_loss: 734950.9500; val_gene_expr_recon_loss: 20185260.5333; val_masked_gp_l1_reg_loss: 115627.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128140.4609; val_chrom_access_recon_loss: 2103550.4667; val_global_loss: 23321182.9333; val_optim_loss: 23321182.9333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9065; val_auprc_score: 0.8945; val_best_acc_score: 0.8215; val_best_f1_score: 0.8361; train_kl_reg_loss: 59872.9973; train_edge_recon_loss: 653073.7653; train_gene_expr_recon_loss: 20222694.3206; train_masked_gp_l1_reg_loss: 117413.7066; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121020.5814; train_chrom_access_recon_loss: 2104109.9704; train_global_loss: 23278185.4809; train_optim_loss: 23278185.4809; val_kl_reg_loss: 66319.5591; val_edge_recon_loss: 635917.4875; val_gene_expr_recon_loss: 20042385.0667; val_masked_gp_l1_reg_loss: 119311.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116179.7344; val_chrom_access_recon_loss: 2097064.6333; val_global_loss: 23077178.9333; val_optim_loss: 23077178.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9160; val_auprc_score: 0.9073; val_best_acc_score: 0.8308; val_best_f1_score: 0.8428; train_kl_reg_loss: 67313.5981; train_edge_recon_loss: 623659.9494; train_gene_expr_recon_loss: 20038122.2443; train_masked_gp_l1_reg_loss: 119876.8575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110678.9293; train_chrom_access_recon_loss: 2087751.3502; train_global_loss: 23047403.1145; train_optim_loss: 23047403.1145; val_kl_reg_loss: 67838.3354; val_edge_recon_loss: 620473.5875; val_gene_expr_recon_loss: 19867041.0667; val_masked_gp_l1_reg_loss: 120568.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105871.2734; val_chrom_access_recon_loss: 2082774.1000; val_global_loss: 22864567.0667; val_optim_loss: 22864567.0667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9180; val_auprc_score: 0.9073; val_best_acc_score: 0.8319; val_best_f1_score: 0.8414; train_kl_reg_loss: 67785.7228; train_edge_recon_loss: 615220.0668; train_gene_expr_recon_loss: 19887152.7634; train_masked_gp_l1_reg_loss: 120993.4380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102565.7631; train_chrom_access_recon_loss: 2072497.1441; train_global_loss: 22866215.0687; train_optim_loss: 22866215.0687; val_kl_reg_loss: 68805.6177; val_edge_recon_loss: 615001.3083; val_gene_expr_recon_loss: 19665385.8667; val_masked_gp_l1_reg_loss: 121561.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99964.8516; val_chrom_access_recon_loss: 2059137.2667; val_global_loss: 22629856.4000; val_optim_loss: 22629856.4000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9256; val_auprc_score: 0.9171; val_best_acc_score: 0.8445; val_best_f1_score: 0.8505; train_kl_reg_loss: 67390.8622; train_edge_recon_loss: 610648.7586; train_gene_expr_recon_loss: 19772678.5649; train_masked_gp_l1_reg_loss: 121546.3599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96950.0728; train_chrom_access_recon_loss: 2058921.1784; train_global_loss: 22728135.6183; train_optim_loss: 22728135.6183; val_kl_reg_loss: 67171.3500; val_edge_recon_loss: 614632.0417; val_gene_expr_recon_loss: 19642557.7333; val_masked_gp_l1_reg_loss: 121745.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94077.1406; val_chrom_access_recon_loss: 2042029.6750; val_global_loss: 22582215.2000; val_optim_loss: 22582215.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9383; val_auprc_score: 0.9280; val_best_acc_score: 0.8643; val_best_f1_score: 0.8722; train_kl_reg_loss: 66904.7651; train_edge_recon_loss: 607380.4819; train_gene_expr_recon_loss: 19664847.5725; train_masked_gp_l1_reg_loss: 121784.0860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92357.5759; train_chrom_access_recon_loss: 2045850.5076; train_global_loss: 22599124.8702; train_optim_loss: 22599124.8702; val_kl_reg_loss: 63773.8185; val_edge_recon_loss: 606972.1167; val_gene_expr_recon_loss: 19489631.8667; val_masked_gp_l1_reg_loss: 122181.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91685.2578; val_chrom_access_recon_loss: 2037408.4000; val_global_loss: 22411654.2667; val_optim_loss: 22411654.2667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9442; val_auprc_score: 0.9334; val_best_acc_score: 0.8748; val_best_f1_score: 0.8797; train_kl_reg_loss: 66425.0579; train_edge_recon_loss: 601730.6732; train_gene_expr_recon_loss: 19557058.8550; train_masked_gp_l1_reg_loss: 122186.2202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89511.9862; train_chrom_access_recon_loss: 2035940.5534; train_global_loss: 22472853.2977; train_optim_loss: 22472853.2977; val_kl_reg_loss: 66076.6354; val_edge_recon_loss: 604436.4708; val_gene_expr_recon_loss: 19383792.5333; val_masked_gp_l1_reg_loss: 122884.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88539.0469; val_chrom_access_recon_loss: 2029167.9917; val_global_loss: 22294897.6000; val_optim_loss: 22294897.6000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9489; val_auprc_score: 0.9409; val_best_acc_score: 0.8794; val_best_f1_score: 0.8834; train_kl_reg_loss: 66320.5470; train_edge_recon_loss: 600088.1269; train_gene_expr_recon_loss: 19462690.0763; train_masked_gp_l1_reg_loss: 122723.1571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87012.3305; train_chrom_access_recon_loss: 2025255.0086; train_global_loss: 22364089.2977; train_optim_loss: 22364089.2977; val_kl_reg_loss: 66887.1667; val_edge_recon_loss: 600893.9458; val_gene_expr_recon_loss: 19412756.8000; val_masked_gp_l1_reg_loss: 123454.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86278.4609; val_chrom_access_recon_loss: 2026694.7500; val_global_loss: 22316964.6667; val_optim_loss: 22316964.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9476; val_auprc_score: 0.9332; val_best_acc_score: 0.8861; val_best_f1_score: 0.8897; train_kl_reg_loss: 66243.1455; train_edge_recon_loss: 596449.0005; train_gene_expr_recon_loss: 19392247.1145; train_masked_gp_l1_reg_loss: 123208.5791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85547.1177; train_chrom_access_recon_loss: 2016968.9733; train_global_loss: 22280663.8931; train_optim_loss: 22280663.8931; val_kl_reg_loss: 65710.0279; val_edge_recon_loss: 600737.9958; val_gene_expr_recon_loss: 19264322.2667; val_masked_gp_l1_reg_loss: 123657.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84871.6641; val_chrom_access_recon_loss: 2019170.0167; val_global_loss: 22158470.0000; val_optim_loss: 22158470.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9563; val_auprc_score: 0.9467; val_best_acc_score: 0.8985; val_best_f1_score: 0.9007; train_kl_reg_loss: 66206.4494; train_edge_recon_loss: 593007.2085; train_gene_expr_recon_loss: 19321294.0305; train_masked_gp_l1_reg_loss: 123680.1021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84546.6667; train_chrom_access_recon_loss: 2009187.9695; train_global_loss: 22197922.4580; train_optim_loss: 22197922.4580; val_kl_reg_loss: 65694.7320; val_edge_recon_loss: 593490.8542; val_gene_expr_recon_loss: 19166272.6667; val_masked_gp_l1_reg_loss: 124043.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85018.2344; val_chrom_access_recon_loss: 1997880.0167; val_global_loss: 22032400.2667; val_optim_loss: 22032400.2667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9565; val_auprc_score: 0.9471; val_best_acc_score: 0.8946; val_best_f1_score: 0.8987; train_kl_reg_loss: 65924.8716; train_edge_recon_loss: 592295.3707; train_gene_expr_recon_loss: 19248916.0458; train_masked_gp_l1_reg_loss: 124252.6022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84134.0212; train_chrom_access_recon_loss: 2001178.6002; train_global_loss: 22116701.7099; train_optim_loss: 22116701.7099; val_kl_reg_loss: 66860.8323; val_edge_recon_loss: 595526.5625; val_gene_expr_recon_loss: 19174080.1333; val_masked_gp_l1_reg_loss: 124362.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83448.1875; val_chrom_access_recon_loss: 2002733.3083; val_global_loss: 22047010.8000; val_optim_loss: 22047010.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9618; val_auprc_score: 0.9535; val_best_acc_score: 0.9019; val_best_f1_score: 0.9048; train_kl_reg_loss: 65940.8180; train_edge_recon_loss: 590803.3201; train_gene_expr_recon_loss: 19183286.5496; train_masked_gp_l1_reg_loss: 124386.5394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83545.6483; train_chrom_access_recon_loss: 1991538.8006; train_global_loss: 22039501.8473; train_optim_loss: 22039501.8473; val_kl_reg_loss: 65962.0565; val_edge_recon_loss: 591158.2333; val_gene_expr_recon_loss: 19039987.7333; val_masked_gp_l1_reg_loss: 124848.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84046.1562; val_chrom_access_recon_loss: 1988296.2167; val_global_loss: 21894298.0000; val_optim_loss: 21894298.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9596; val_auprc_score: 0.9493; val_best_acc_score: 0.9041; val_best_f1_score: 0.9069; train_kl_reg_loss: 66061.5290; train_edge_recon_loss: 588584.9418; train_gene_expr_recon_loss: 19129437.0840; train_masked_gp_l1_reg_loss: 124914.4750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83274.8288; train_chrom_access_recon_loss: 1985503.3521; train_global_loss: 21977776.3053; train_optim_loss: 21977776.3053; val_kl_reg_loss: 66122.4055; val_edge_recon_loss: 590530.3208; val_gene_expr_recon_loss: 19034560.6667; val_masked_gp_l1_reg_loss: 125485.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84666.9766; val_chrom_access_recon_loss: 1987712.9083; val_global_loss: 21889078.2667; val_optim_loss: 21889078.2667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9610; val_auprc_score: 0.9501; val_best_acc_score: 0.9050; val_best_f1_score: 0.9082; train_kl_reg_loss: 65425.8814; train_edge_recon_loss: 587866.2987; train_gene_expr_recon_loss: 19062172.0305; train_masked_gp_l1_reg_loss: 125526.4329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83590.3997; train_chrom_access_recon_loss: 1979535.1097; train_global_loss: 21904116.2443; train_optim_loss: 21904116.2443; val_kl_reg_loss: 65495.2250; val_edge_recon_loss: 590537.5042; val_gene_expr_recon_loss: 18980857.6000; val_masked_gp_l1_reg_loss: 125484.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83752.8047; val_chrom_access_recon_loss: 1978599.1250; val_global_loss: 21824725.4667; val_optim_loss: 21824725.4667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9637; val_auprc_score: 0.9530; val_best_acc_score: 0.9095; val_best_f1_score: 0.9125; train_kl_reg_loss: 65147.7596; train_edge_recon_loss: 588190.8244; train_gene_expr_recon_loss: 19022089.0382; train_masked_gp_l1_reg_loss: 125656.4422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83359.4000; train_chrom_access_recon_loss: 1973526.4475; train_global_loss: 21857969.7099; train_optim_loss: 21857969.7099; val_kl_reg_loss: 65163.5375; val_edge_recon_loss: 588683.9000; val_gene_expr_recon_loss: 18911266.9333; val_masked_gp_l1_reg_loss: 125908.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84277.0234; val_chrom_access_recon_loss: 1977866.8833; val_global_loss: 21753166.9333; val_optim_loss: 21753166.9333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9641; val_auprc_score: 0.9553; val_best_acc_score: 0.9086; val_best_f1_score: 0.9112; train_kl_reg_loss: 64923.8205; train_edge_recon_loss: 586018.4742; train_gene_expr_recon_loss: 18956759.9389; train_masked_gp_l1_reg_loss: 126299.7226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83623.3453; train_chrom_access_recon_loss: 1966609.4714; train_global_loss: 21784234.9313; train_optim_loss: 21784234.9313; val_kl_reg_loss: 65951.7721; val_edge_recon_loss: 586965.0542; val_gene_expr_recon_loss: 18951860.8000; val_masked_gp_l1_reg_loss: 126850.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83747.3203; val_chrom_access_recon_loss: 1972229.8500; val_global_loss: 21787605.2000; val_optim_loss: 21787605.2000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9651; val_auprc_score: 0.9571; val_best_acc_score: 0.9076; val_best_f1_score: 0.9109; train_kl_reg_loss: 64538.8873; train_edge_recon_loss: 585580.6264; train_gene_expr_recon_loss: 18918026.4733; train_masked_gp_l1_reg_loss: 126995.4780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84151.7268; train_chrom_access_recon_loss: 1964161.3635; train_global_loss: 21743454.5802; train_optim_loss: 21743454.5802; val_kl_reg_loss: 63944.2031; val_edge_recon_loss: 585473.6917; val_gene_expr_recon_loss: 18880091.6000; val_masked_gp_l1_reg_loss: 127244.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84663.9219; val_chrom_access_recon_loss: 1964125.8667; val_global_loss: 21705543.4667; val_optim_loss: 21705543.4667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9620; val_auprc_score: 0.9515; val_best_acc_score: 0.9123; val_best_f1_score: 0.9151; train_kl_reg_loss: 64148.5166; train_edge_recon_loss: 584873.1489; train_gene_expr_recon_loss: 18864099.5573; train_masked_gp_l1_reg_loss: 127660.5408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84288.2542; train_chrom_access_recon_loss: 1958076.2777; train_global_loss: 21683146.1527; train_optim_loss: 21683146.1527; val_kl_reg_loss: 64120.9953; val_edge_recon_loss: 586787.7125; val_gene_expr_recon_loss: 18818504.2667; val_masked_gp_l1_reg_loss: 128124.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85617.9062; val_chrom_access_recon_loss: 1958989.5667; val_global_loss: 21642144.5333; val_optim_loss: 21642144.5333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9625; val_auprc_score: 0.9520; val_best_acc_score: 0.9076; val_best_f1_score: 0.9119; train_kl_reg_loss: 63641.1152; train_edge_recon_loss: 584880.2691; train_gene_expr_recon_loss: 18815659.2519; train_masked_gp_l1_reg_loss: 128419.0722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85153.2300; train_chrom_access_recon_loss: 1954159.9237; train_global_loss: 21631912.8244; train_optim_loss: 21631912.8244; val_kl_reg_loss: 65352.7833; val_edge_recon_loss: 585800.2208; val_gene_expr_recon_loss: 18819504.1333; val_masked_gp_l1_reg_loss: 129155.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84716.5078; val_chrom_access_recon_loss: 1961733.7250; val_global_loss: 21646263.0667; val_optim_loss: 21646263.0667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9616; val_auprc_score: 0.9500; val_best_acc_score: 0.9081; val_best_f1_score: 0.9120; train_kl_reg_loss: 63505.1993; train_edge_recon_loss: 584749.6026; train_gene_expr_recon_loss: 18795904.8092; train_masked_gp_l1_reg_loss: 129299.4765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85335.1473; train_chrom_access_recon_loss: 1955003.9895; train_global_loss: 21613798.2137; train_optim_loss: 21613798.2137; val_kl_reg_loss: 63680.3333; val_edge_recon_loss: 589732.2542; val_gene_expr_recon_loss: 18705395.0667; val_masked_gp_l1_reg_loss: 129786.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86202.4219; val_chrom_access_recon_loss: 1952979.5583; val_global_loss: 21527775.0667; val_optim_loss: 21527775.0667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9614; val_auprc_score: 0.9495; val_best_acc_score: 0.9101; val_best_f1_score: 0.9123; train_kl_reg_loss: 63116.4312; train_edge_recon_loss: 583475.9237; train_gene_expr_recon_loss: 18746160.5496; train_masked_gp_l1_reg_loss: 130226.4837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85774.5818; train_chrom_access_recon_loss: 1947885.2548; train_global_loss: 21556639.3130; train_optim_loss: 21556639.3130; val_kl_reg_loss: 60954.0542; val_edge_recon_loss: 584553.7250; val_gene_expr_recon_loss: 18811859.6000; val_masked_gp_l1_reg_loss: 130471.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86087.5000; val_chrom_access_recon_loss: 1963272.0250; val_global_loss: 21637199.3333; val_optim_loss: 21637199.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9665; val_auprc_score: 0.9576; val_best_acc_score: 0.9116; val_best_f1_score: 0.9153; train_kl_reg_loss: 62941.2557; train_edge_recon_loss: 584051.4170; train_gene_expr_recon_loss: 18679061.9847; train_masked_gp_l1_reg_loss: 131234.1580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86020.5852; train_chrom_access_recon_loss: 1943110.9284; train_global_loss: 21486420.4122; train_optim_loss: 21486420.4122; val_kl_reg_loss: 64170.3133; val_edge_recon_loss: 585880.5958; val_gene_expr_recon_loss: 18650651.3333; val_masked_gp_l1_reg_loss: 131574.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86089.8984; val_chrom_access_recon_loss: 1947175.8333; val_global_loss: 21465542.1333; val_optim_loss: 21465542.1333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9554; val_auprc_score: 0.9461; val_best_acc_score: 0.8952; val_best_f1_score: 0.8985; train_kl_reg_loss: 62332.2310; train_edge_recon_loss: 628691.7467; train_gene_expr_recon_loss: 17554684.8855; train_masked_gp_l1_reg_loss: 126525.0310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74737.7638; train_chrom_access_recon_loss: 1856089.1002; train_global_loss: 20303060.9008; train_optim_loss: 20303060.9008; val_kl_reg_loss: 37624.0448; val_edge_recon_loss: 608090.8917; val_gene_expr_recon_loss: 17510195.0000; val_masked_gp_l1_reg_loss: 123498.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71857.6562; val_chrom_access_recon_loss: 1849514.8917; val_global_loss: 20200780.8000; val_optim_loss: 20200780.8000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9575; val_auprc_score: 0.9482; val_best_acc_score: 0.9011; val_best_f1_score: 0.9029; train_kl_reg_loss: 56914.9287; train_edge_recon_loss: 598141.0491; train_gene_expr_recon_loss: 17479474.6489; train_masked_gp_l1_reg_loss: 121374.0629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71726.1302; train_chrom_access_recon_loss: 1844801.9542; train_global_loss: 20172432.8244; train_optim_loss: 20172432.8244; val_kl_reg_loss: 44092.7862; val_edge_recon_loss: 593356.3208; val_gene_expr_recon_loss: 17424648.8000; val_masked_gp_l1_reg_loss: 119602.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72210.3359; val_chrom_access_recon_loss: 1835813.3250; val_global_loss: 20089722.8000; val_optim_loss: 20089722.8000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9545; val_auprc_score: 0.9409; val_best_acc_score: 0.8949; val_best_f1_score: 0.8980; train_kl_reg_loss: 55189.2775; train_edge_recon_loss: 591295.4427; train_gene_expr_recon_loss: 17403094.3282; train_masked_gp_l1_reg_loss: 118689.6127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71958.1418; train_chrom_access_recon_loss: 1840658.7405; train_global_loss: 20080885.5725; train_optim_loss: 20080885.5725; val_kl_reg_loss: 44636.2844; val_edge_recon_loss: 592806.7042; val_gene_expr_recon_loss: 17273798.4000; val_masked_gp_l1_reg_loss: 117902.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72245.4688; val_chrom_access_recon_loss: 1837956.5667; val_global_loss: 19939346.1333; val_optim_loss: 19939346.1333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9559; val_auprc_score: 0.9403; val_best_acc_score: 0.8999; val_best_f1_score: 0.9038; train_kl_reg_loss: 53732.5813; train_edge_recon_loss: 588266.1675; train_gene_expr_recon_loss: 17339095.5878; train_masked_gp_l1_reg_loss: 117068.9556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72137.3415; train_chrom_access_recon_loss: 1835319.4370; train_global_loss: 20005620.0153; train_optim_loss: 20005620.0153; val_kl_reg_loss: 47322.7982; val_edge_recon_loss: 588775.7750; val_gene_expr_recon_loss: 17359323.4667; val_masked_gp_l1_reg_loss: 116187.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72069.1875; val_chrom_access_recon_loss: 1843575.9500; val_global_loss: 20027255.7333; val_optim_loss: 20027255.7333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9531; val_auprc_score: 0.9372; val_best_acc_score: 0.8964; val_best_f1_score: 0.9008; train_kl_reg_loss: 52790.1198; train_edge_recon_loss: 583590.3650; train_gene_expr_recon_loss: 17292339.9924; train_masked_gp_l1_reg_loss: 115820.7945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72182.3934; train_chrom_access_recon_loss: 1832420.6116; train_global_loss: 19949144.2748; train_optim_loss: 19949144.2748; val_kl_reg_loss: 47606.6651; val_edge_recon_loss: 590174.5167; val_gene_expr_recon_loss: 17301683.2000; val_masked_gp_l1_reg_loss: 115295.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72062.2891; val_chrom_access_recon_loss: 1839872.6417; val_global_loss: 19966694.9333; val_optim_loss: 19966694.9333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9578; val_auprc_score: 0.9451; val_best_acc_score: 0.9011; val_best_f1_score: 0.9054; train_kl_reg_loss: 52273.8620; train_edge_recon_loss: 583159.2576; train_gene_expr_recon_loss: 17250513.4809; train_masked_gp_l1_reg_loss: 115116.1830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72208.0822; train_chrom_access_recon_loss: 1832749.8578; train_global_loss: 19906020.5802; train_optim_loss: 19906020.5802; val_kl_reg_loss: 47668.8878; val_edge_recon_loss: 587529.5917; val_gene_expr_recon_loss: 17252389.5333; val_masked_gp_l1_reg_loss: 114606.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72211.6641; val_chrom_access_recon_loss: 1832153.1167; val_global_loss: 19906558.5333; val_optim_loss: 19906558.5333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9601; val_auprc_score: 0.9480; val_best_acc_score: 0.9069; val_best_f1_score: 0.9098; train_kl_reg_loss: 51785.8484; train_edge_recon_loss: 579828.0735; train_gene_expr_recon_loss: 17193069.7557; train_masked_gp_l1_reg_loss: 114482.8542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72363.1414; train_chrom_access_recon_loss: 1829060.8416; train_global_loss: 19840590.6718; train_optim_loss: 19840590.6718; val_kl_reg_loss: 50417.4406; val_edge_recon_loss: 583221.5792; val_gene_expr_recon_loss: 17183169.0000; val_masked_gp_l1_reg_loss: 114405.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72241.1484; val_chrom_access_recon_loss: 1831997.3583; val_global_loss: 19835453.4667; val_optim_loss: 19835453.4667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9592; val_auprc_score: 0.9429; val_best_acc_score: 0.9060; val_best_f1_score: 0.9095; train_kl_reg_loss: 51501.8114; train_edge_recon_loss: 578542.1512; train_gene_expr_recon_loss: 17156039.0458; train_masked_gp_l1_reg_loss: 114055.6573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72285.2018; train_chrom_access_recon_loss: 1824914.1317; train_global_loss: 19797338.0000; train_optim_loss: 19797338.0000; val_kl_reg_loss: 49515.9440; val_edge_recon_loss: 581567.9583; val_gene_expr_recon_loss: 17242915.4000; val_masked_gp_l1_reg_loss: 113795.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72434.2812; val_chrom_access_recon_loss: 1838556.4417; val_global_loss: 19898785.7333; val_optim_loss: 19898785.7333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9605; val_auprc_score: 0.9488; val_best_acc_score: 0.9073; val_best_f1_score: 0.9093; train_kl_reg_loss: 51161.4885; train_edge_recon_loss: 578062.6856; train_gene_expr_recon_loss: 17137243.5191; train_masked_gp_l1_reg_loss: 113611.0645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72468.2436; train_chrom_access_recon_loss: 1825390.1698; train_global_loss: 19777937.1603; train_optim_loss: 19777937.1603; val_kl_reg_loss: 50062.6284; val_edge_recon_loss: 579877.5583; val_gene_expr_recon_loss: 17133338.7333; val_masked_gp_l1_reg_loss: 113458.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72578.2891; val_chrom_access_recon_loss: 1828909.2500; val_global_loss: 19778224.0000; val_optim_loss: 19778224.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9610; val_auprc_score: 0.9478; val_best_acc_score: 0.9099; val_best_f1_score: 0.9129; train_kl_reg_loss: 50967.4968; train_edge_recon_loss: 577495.9542; train_gene_expr_recon_loss: 17092274.8015; train_masked_gp_l1_reg_loss: 113352.1492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72784.0256; train_chrom_access_recon_loss: 1823776.1355; train_global_loss: 19730650.3969; train_optim_loss: 19730650.3969; val_kl_reg_loss: 49405.5003; val_edge_recon_loss: 577345.7500; val_gene_expr_recon_loss: 17136950.4000; val_masked_gp_l1_reg_loss: 113099.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72704.6250; val_chrom_access_recon_loss: 1826963.0000; val_global_loss: 19776468.5333; val_optim_loss: 19776468.5333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9596; val_auprc_score: 0.9451; val_best_acc_score: 0.9069; val_best_f1_score: 0.9095; train_kl_reg_loss: 50900.2770; train_edge_recon_loss: 578304.1279; train_gene_expr_recon_loss: 17048099.2061; train_masked_gp_l1_reg_loss: 113149.3573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72813.4807; train_chrom_access_recon_loss: 1819280.8998; train_global_loss: 19682547.2977; train_optim_loss: 19682547.2977; val_kl_reg_loss: 49816.6505; val_edge_recon_loss: 580732.0500; val_gene_expr_recon_loss: 17125568.2000; val_masked_gp_l1_reg_loss: 112888.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73040.2656; val_chrom_access_recon_loss: 1822842.9667; val_global_loss: 19764888.0000; val_optim_loss: 19764888.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9614; val_auprc_score: 0.9492; val_best_acc_score: 0.9119; val_best_f1_score: 0.9155; train_kl_reg_loss: 51002.6400; train_edge_recon_loss: 576776.6665; train_gene_expr_recon_loss: 17044715.0382; train_masked_gp_l1_reg_loss: 112863.5919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72934.5504; train_chrom_access_recon_loss: 1822598.4990; train_global_loss: 19680890.9771; train_optim_loss: 19680890.9771; val_kl_reg_loss: 49708.5404; val_edge_recon_loss: 578924.5667; val_gene_expr_recon_loss: 17120815.0000; val_masked_gp_l1_reg_loss: 112552.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72907.0625; val_chrom_access_recon_loss: 1822048.0250; val_global_loss: 19756956.0000; val_optim_loss: 19756956.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9597; val_auprc_score: 0.9422; val_best_acc_score: 0.9066; val_best_f1_score: 0.9107; train_kl_reg_loss: 51028.6076; train_edge_recon_loss: 576247.7109; train_gene_expr_recon_loss: 16998986.3359; train_masked_gp_l1_reg_loss: 112439.4385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73034.0881; train_chrom_access_recon_loss: 1819706.7156; train_global_loss: 19631442.9313; train_optim_loss: 19631442.9313; val_kl_reg_loss: 50123.2352; val_edge_recon_loss: 581879.4708; val_gene_expr_recon_loss: 17067140.8667; val_masked_gp_l1_reg_loss: 112350.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72656.0312; val_chrom_access_recon_loss: 1828007.7000; val_global_loss: 19712157.7333; val_optim_loss: 19712157.7333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9610; val_auprc_score: 0.9497; val_best_acc_score: 0.9033; val_best_f1_score: 0.9073; train_kl_reg_loss: 50870.4856; train_edge_recon_loss: 590072.6002; train_gene_expr_recon_loss: 17206683.9389; train_masked_gp_l1_reg_loss: 109630.1384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72384.5889; train_chrom_access_recon_loss: 1818896.3015; train_global_loss: 19848538.0763; train_optim_loss: 19848538.0763; val_kl_reg_loss: 51967.6872; val_edge_recon_loss: 584792.3375; val_gene_expr_recon_loss: 17131389.8667; val_masked_gp_l1_reg_loss: 106955.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71823.7578; val_chrom_access_recon_loss: 1822017.1250; val_global_loss: 19768947.2000; val_optim_loss: 19768947.2000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9572; val_auprc_score: 0.9454; val_best_acc_score: 0.9007; val_best_f1_score: 0.9044; train_kl_reg_loss: 202845876.5244; train_edge_recon_loss: 600206.7385; train_gene_expr_recon_loss: 17438848.1603; train_masked_gp_l1_reg_loss: 104494.5393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73093.4571; train_chrom_access_recon_loss: 1818292.4666; train_global_loss: 222880807.6947; train_optim_loss: 222880807.6947; val_kl_reg_loss: 43312.9576; val_edge_recon_loss: 615353.2917; val_gene_expr_recon_loss: 17259133.8000; val_masked_gp_l1_reg_loss: 100152.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73510.8125; val_chrom_access_recon_loss: 1818329.5167; val_global_loss: 19909791.4667; val_optim_loss: 19909791.4667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9558; val_auprc_score: 0.9449; val_best_acc_score: 0.8971; val_best_f1_score: 0.9004; train_kl_reg_loss: 55847.8460; train_edge_recon_loss: 609468.5014; train_gene_expr_recon_loss: 17337847.2366; train_masked_gp_l1_reg_loss: 98341.6514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72750.6865; train_chrom_access_recon_loss: 1815250.7719; train_global_loss: 19989506.7023; train_optim_loss: 19989506.7023; val_kl_reg_loss: 53238.0987; val_edge_recon_loss: 604405.2375; val_gene_expr_recon_loss: 17127434.1333; val_masked_gp_l1_reg_loss: 96940.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70863.0859; val_chrom_access_recon_loss: 1801696.6083; val_global_loss: 19754577.4667; val_optim_loss: 19754577.4667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9612; val_auprc_score: 0.9525; val_best_acc_score: 0.9046; val_best_f1_score: 0.9078; train_kl_reg_loss: 77328.1620; train_edge_recon_loss: 615983.4866; train_gene_expr_recon_loss: 17381109.9084; train_masked_gp_l1_reg_loss: 95382.9255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71370.3415; train_chrom_access_recon_loss: 1813781.1670; train_global_loss: 20054956.0000; train_optim_loss: 20054956.0000; val_kl_reg_loss: 71680.6255; val_edge_recon_loss: 616574.5292; val_gene_expr_recon_loss: 17365722.8000; val_masked_gp_l1_reg_loss: 93021.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71091.3516; val_chrom_access_recon_loss: 1830233.6167; val_global_loss: 20048325.3333; val_optim_loss: 20048325.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9591; val_auprc_score: 0.9489; val_best_acc_score: 0.9004; val_best_f1_score: 0.9033; train_kl_reg_loss: 74170.5627; train_edge_recon_loss: 607855.9490; train_gene_expr_recon_loss: 17212752.5573; train_masked_gp_l1_reg_loss: 89213.2522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56046.9637; train_chrom_access_recon_loss: 1806543.6078; train_global_loss: 19846582.9771; train_optim_loss: 19846582.9771; val_kl_reg_loss: 65823.1219; val_edge_recon_loss: 604650.2208; val_gene_expr_recon_loss: 17224686.4667; val_masked_gp_l1_reg_loss: 88232.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53715.8594; val_chrom_access_recon_loss: 1820743.4500; val_global_loss: 19857851.3333; val_optim_loss: 19857851.3333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9600; val_auprc_score: 0.9516; val_best_acc_score: 0.9015; val_best_f1_score: 0.9039; train_kl_reg_loss: 70574.1782; train_edge_recon_loss: 601221.8020; train_gene_expr_recon_loss: 17198353.3435; train_masked_gp_l1_reg_loss: 88043.6366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53184.7403; train_chrom_access_recon_loss: 1806308.9284; train_global_loss: 19817686.7023; train_optim_loss: 19817686.7023; val_kl_reg_loss: 63642.0578; val_edge_recon_loss: 601101.6333; val_gene_expr_recon_loss: 17134361.5333; val_masked_gp_l1_reg_loss: 87892.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52725.3750; val_chrom_access_recon_loss: 1811809.9000; val_global_loss: 19751532.8000; val_optim_loss: 19751532.8000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9557; val_auprc_score: 0.9447; val_best_acc_score: 0.8949; val_best_f1_score: 0.8977; train_kl_reg_loss: 68940.6692; train_edge_recon_loss: 596641.8411; train_gene_expr_recon_loss: 17179987.2672; train_masked_gp_l1_reg_loss: 87870.9829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52372.3307; train_chrom_access_recon_loss: 1805490.9809; train_global_loss: 19791304.0458; train_optim_loss: 19791304.0458; val_kl_reg_loss: 62553.7922; val_edge_recon_loss: 600396.2250; val_gene_expr_recon_loss: 17202782.0667; val_masked_gp_l1_reg_loss: 87868.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52136.8477; val_chrom_access_recon_loss: 1814914.7833; val_global_loss: 19820650.8000; val_optim_loss: 19820650.8000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9547; val_auprc_score: 0.9408; val_best_acc_score: 0.8944; val_best_f1_score: 0.8993; train_kl_reg_loss: 68173.8038; train_edge_recon_loss: 595376.0305; train_gene_expr_recon_loss: 17187206.8473; train_masked_gp_l1_reg_loss: 87856.3449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51928.6798; train_chrom_access_recon_loss: 1806299.9781; train_global_loss: 19796841.8015; train_optim_loss: 19796841.8015; val_kl_reg_loss: 62694.4958; val_edge_recon_loss: 594369.5167; val_gene_expr_recon_loss: 17111398.1333; val_masked_gp_l1_reg_loss: 87841.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51710.7617; val_chrom_access_recon_loss: 1805492.7167; val_global_loss: 19713506.8000; val_optim_loss: 19713506.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 31 min 1 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9614
val AUPRC score: 0.9499
val best accuracy score: 0.9089
val best F1 score: 0.9122
val target rna MSE score: 1.3187
val source rna MSE score: 0.5670
val target atac MSE score: 0.3452
val source atac MSE score: 0.1065
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
