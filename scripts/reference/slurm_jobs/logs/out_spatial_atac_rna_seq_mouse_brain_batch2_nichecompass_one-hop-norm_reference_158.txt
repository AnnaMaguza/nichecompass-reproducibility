[True]
Run timestamp: 07082023_221719_158.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_158']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8844; val_auprc_score: 0.8919; val_best_acc_score: 0.5671; val_best_f1_score: 0.6969; train_kl_reg_loss: 111832.3377; train_edge_recon_loss: 3475928.1944; train_gene_expr_recon_loss: 1191334.2917; train_masked_gp_l1_reg_loss: 8652.2517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119363.7465; train_chrom_access_recon_loss: 755212.8924; train_global_loss: 5662323.7222; train_optim_loss: 5662323.7222; val_kl_reg_loss: 15275.9844; val_edge_recon_loss: 4060720.7500; val_gene_expr_recon_loss: 1019590.3750; val_masked_gp_l1_reg_loss: 7170.3643; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116850.8516; val_chrom_access_recon_loss: 515245.0312; val_global_loss: 5734853.5000; val_optim_loss: 5734853.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8795; val_auprc_score: 0.8901; val_best_acc_score: 0.6091; val_best_f1_score: 0.7166; train_kl_reg_loss: 18757.7510; train_edge_recon_loss: 3477988.6944; train_gene_expr_recon_loss: 992908.4722; train_masked_gp_l1_reg_loss: 6649.3859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115307.6276; train_chrom_access_recon_loss: 505920.4271; train_global_loss: 5117532.3333; train_optim_loss: 5117532.3333; val_kl_reg_loss: 39751.2188; val_edge_recon_loss: 4058142.2500; val_gene_expr_recon_loss: 931895.3125; val_masked_gp_l1_reg_loss: 6208.8457; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113461.0312; val_chrom_access_recon_loss: 480345.9375; val_global_loss: 5629805.0000; val_optim_loss: 5629805.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8646; val_auprc_score: 0.8737; val_best_acc_score: 0.6475; val_best_f1_score: 0.7345; train_kl_reg_loss: 21505.6475; train_edge_recon_loss: 3480360.6944; train_gene_expr_recon_loss: 909427.7778; train_masked_gp_l1_reg_loss: 6116.4345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112013.1910; train_chrom_access_recon_loss: 485337.6944; train_global_loss: 5014761.3333; train_optim_loss: 5014761.3333; val_kl_reg_loss: 26489.0586; val_edge_recon_loss: 4054329.7500; val_gene_expr_recon_loss: 868858.5000; val_masked_gp_l1_reg_loss: 6041.1870; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110158.0938; val_chrom_access_recon_loss: 471563.8750; val_global_loss: 5537440.0000; val_optim_loss: 5537440.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8438; val_auprc_score: 0.8494; val_best_acc_score: 0.6964; val_best_f1_score: 0.7563; train_kl_reg_loss: 20070.6666; train_edge_recon_loss: 3479329.0278; train_gene_expr_recon_loss: 855081.9028; train_masked_gp_l1_reg_loss: 5955.0256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108531.7925; train_chrom_access_recon_loss: 471334.2396; train_global_loss: 4940302.6111; train_optim_loss: 4940302.6111; val_kl_reg_loss: 23158.9336; val_edge_recon_loss: 4046096.2500; val_gene_expr_recon_loss: 834590.1250; val_masked_gp_l1_reg_loss: 5841.2358; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106395.6250; val_chrom_access_recon_loss: 457182.8750; val_global_loss: 5473265.0000; val_optim_loss: 5473265.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8363; val_auprc_score: 0.8331; val_best_acc_score: 0.7482; val_best_f1_score: 0.7656; train_kl_reg_loss: 16826.0688; train_edge_recon_loss: 3477476.9167; train_gene_expr_recon_loss: 826827.2986; train_masked_gp_l1_reg_loss: 5781.1783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104531.6727; train_chrom_access_recon_loss: 463939.0278; train_global_loss: 4895382.0556; train_optim_loss: 4895382.0556; val_kl_reg_loss: 15369.5840; val_edge_recon_loss: 4013378.5000; val_gene_expr_recon_loss: 807604.6250; val_masked_gp_l1_reg_loss: 5732.6670; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102117.1484; val_chrom_access_recon_loss: 451592.2500; val_global_loss: 5395794.0000; val_optim_loss: 5395794.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8303; val_auprc_score: 0.8086; val_best_acc_score: 0.7406; val_best_f1_score: 0.7802; train_kl_reg_loss: 14513.9467; train_edge_recon_loss: 3470826.5000; train_gene_expr_recon_loss: 800184.7431; train_masked_gp_l1_reg_loss: 5730.9074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100083.8759; train_chrom_access_recon_loss: 456895.6736; train_global_loss: 4848235.5000; train_optim_loss: 4848235.5000; val_kl_reg_loss: 11069.2324; val_edge_recon_loss: 3907233.5000; val_gene_expr_recon_loss: 785650.8750; val_masked_gp_l1_reg_loss: 5737.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97495.7031; val_chrom_access_recon_loss: 447824.4688; val_global_loss: 5255011.0000; val_optim_loss: 5255011.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8511; val_auprc_score: 0.8346; val_best_acc_score: 0.7743; val_best_f1_score: 0.7974; train_kl_reg_loss: 8819.6985; train_edge_recon_loss: 3412842.2500; train_gene_expr_recon_loss: 786996.6597; train_masked_gp_l1_reg_loss: 5758.7484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95376.3411; train_chrom_access_recon_loss: 453396.6528; train_global_loss: 4763190.3889; train_optim_loss: 4763190.3889; val_kl_reg_loss: 5672.9111; val_edge_recon_loss: 3324140.0000; val_gene_expr_recon_loss: 801881.0000; val_masked_gp_l1_reg_loss: 5770.1426; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92711.7266; val_chrom_access_recon_loss: 449032.8125; val_global_loss: 4679209.0000; val_optim_loss: 4679209.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8681; val_auprc_score: 0.8621; val_best_acc_score: 0.7701; val_best_f1_score: 0.7912; train_kl_reg_loss: 10425.4750; train_edge_recon_loss: 3071911.5556; train_gene_expr_recon_loss: 821634.4097; train_masked_gp_l1_reg_loss: 5775.8039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90613.9410; train_chrom_access_recon_loss: 455374.8472; train_global_loss: 4455736.1111; train_optim_loss: 4455736.1111; val_kl_reg_loss: 20895.4648; val_edge_recon_loss: 2884148.7500; val_gene_expr_recon_loss: 813949.3750; val_masked_gp_l1_reg_loss: 5819.6196; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88051.1875; val_chrom_access_recon_loss: 449818.4688; val_global_loss: 4262682.5000; val_optim_loss: 4262682.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8827; val_auprc_score: 0.8735; val_best_acc_score: 0.7912; val_best_f1_score: 0.8005; train_kl_reg_loss: 30884.3108; train_edge_recon_loss: 2899089.7778; train_gene_expr_recon_loss: 791186.5208; train_masked_gp_l1_reg_loss: 5873.8032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86045.8003; train_chrom_access_recon_loss: 453656.4965; train_global_loss: 4266736.7778; train_optim_loss: 4266736.7778; val_kl_reg_loss: 40799.7578; val_edge_recon_loss: 2900456.0000; val_gene_expr_recon_loss: 771379.8750; val_masked_gp_l1_reg_loss: 5924.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83523.7656; val_chrom_access_recon_loss: 444599.0625; val_global_loss: 4246683.0000; val_optim_loss: 4246683.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8943; val_auprc_score: 0.8785; val_best_acc_score: 0.8143; val_best_f1_score: 0.8154; train_kl_reg_loss: 45056.6363; train_edge_recon_loss: 2872174.6944; train_gene_expr_recon_loss: 760145.8333; train_masked_gp_l1_reg_loss: 5944.9425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81504.7109; train_chrom_access_recon_loss: 447756.3958; train_global_loss: 4212583.2222; train_optim_loss: 4212583.2222; val_kl_reg_loss: 45077.7539; val_edge_recon_loss: 2855568.5000; val_gene_expr_recon_loss: 755015.8750; val_masked_gp_l1_reg_loss: 5958.8892; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78987.8828; val_chrom_access_recon_loss: 442659.2188; val_global_loss: 4183268.2500; val_optim_loss: 4183268.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9017; val_auprc_score: 0.8857; val_best_acc_score: 0.8131; val_best_f1_score: 0.8274; train_kl_reg_loss: 44718.9609; train_edge_recon_loss: 2844991.6667; train_gene_expr_recon_loss: 753663.9931; train_masked_gp_l1_reg_loss: 5967.9463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76983.8134; train_chrom_access_recon_loss: 449908.1181; train_global_loss: 4176234.5278; train_optim_loss: 4176234.5278; val_kl_reg_loss: 39747.8359; val_edge_recon_loss: 2819832.0000; val_gene_expr_recon_loss: 747026.3750; val_masked_gp_l1_reg_loss: 5989.0791; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74498.0625; val_chrom_access_recon_loss: 441315.3750; val_global_loss: 4128408.5000; val_optim_loss: 4128408.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9121; val_auprc_score: 0.8932; val_best_acc_score: 0.8366; val_best_f1_score: 0.8456; train_kl_reg_loss: 39110.4132; train_edge_recon_loss: 2811743.4722; train_gene_expr_recon_loss: 745743.9514; train_masked_gp_l1_reg_loss: 6015.8334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72571.9705; train_chrom_access_recon_loss: 447332.6944; train_global_loss: 4122518.3611; train_optim_loss: 4122518.3611; val_kl_reg_loss: 36137.6328; val_edge_recon_loss: 2789461.5000; val_gene_expr_recon_loss: 744431.6250; val_masked_gp_l1_reg_loss: 6060.7271; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70202.4922; val_chrom_access_recon_loss: 440298.5000; val_global_loss: 4086592.7500; val_optim_loss: 4086592.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9252; val_auprc_score: 0.9050; val_best_acc_score: 0.8587; val_best_f1_score: 0.8673; train_kl_reg_loss: 36041.5712; train_edge_recon_loss: 2767953.8333; train_gene_expr_recon_loss: 745865.4653; train_masked_gp_l1_reg_loss: 6103.2938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68379.1528; train_chrom_access_recon_loss: 446286.5451; train_global_loss: 4070629.8611; train_optim_loss: 4070629.8611; val_kl_reg_loss: 37115.0625; val_edge_recon_loss: 2772588.7500; val_gene_expr_recon_loss: 746761.6250; val_masked_gp_l1_reg_loss: 6141.5166; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66154.6719; val_chrom_access_recon_loss: 439796.5938; val_global_loss: 4068558.2500; val_optim_loss: 4068558.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9272; val_auprc_score: 0.9020; val_best_acc_score: 0.8612; val_best_f1_score: 0.8703; train_kl_reg_loss: 37799.0343; train_edge_recon_loss: 2750544.9167; train_gene_expr_recon_loss: 743492.4167; train_masked_gp_l1_reg_loss: 6171.1615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64483.8320; train_chrom_access_recon_loss: 448472.8021; train_global_loss: 4050964.0833; train_optim_loss: 4050964.0833; val_kl_reg_loss: 36578.6797; val_edge_recon_loss: 2763121.7500; val_gene_expr_recon_loss: 736443.5625; val_masked_gp_l1_reg_loss: 6202.0410; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62446.2969; val_chrom_access_recon_loss: 438375.8438; val_global_loss: 4043168.0000; val_optim_loss: 4043168.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9436; val_auprc_score: 0.9265; val_best_acc_score: 0.8813; val_best_f1_score: 0.8883; train_kl_reg_loss: 38614.4375; train_edge_recon_loss: 2720530.2500; train_gene_expr_recon_loss: 737761.6389; train_masked_gp_l1_reg_loss: 6238.3717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60905.5321; train_chrom_access_recon_loss: 445606.6250; train_global_loss: 4009656.7778; train_optim_loss: 4009656.7778; val_kl_reg_loss: 36851.5078; val_edge_recon_loss: 2708950.7500; val_gene_expr_recon_loss: 736010.7500; val_masked_gp_l1_reg_loss: 6281.4043; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59019.0625; val_chrom_access_recon_loss: 437661.9062; val_global_loss: 3984775.5000; val_optim_loss: 3984775.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9502; val_auprc_score: 0.9361; val_best_acc_score: 0.8903; val_best_f1_score: 0.8964; train_kl_reg_loss: 37708.4275; train_edge_recon_loss: 2694500.5278; train_gene_expr_recon_loss: 736069.8958; train_masked_gp_l1_reg_loss: 6337.4621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57592.0126; train_chrom_access_recon_loss: 444987.1910; train_global_loss: 3977195.5278; train_optim_loss: 3977195.5278; val_kl_reg_loss: 35627.7852; val_edge_recon_loss: 2723475.7500; val_gene_expr_recon_loss: 728932.8750; val_masked_gp_l1_reg_loss: 6388.1372; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55853.6875; val_chrom_access_recon_loss: 436451.9375; val_global_loss: 3986730.5000; val_optim_loss: 3986730.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9536; val_auprc_score: 0.9367; val_best_acc_score: 0.8950; val_best_f1_score: 0.9017; train_kl_reg_loss: 36903.2409; train_edge_recon_loss: 2686085.7222; train_gene_expr_recon_loss: 727050.0347; train_masked_gp_l1_reg_loss: 6425.9129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54539.7023; train_chrom_access_recon_loss: 442463.8194; train_global_loss: 3953468.4722; train_optim_loss: 3953468.4722; val_kl_reg_loss: 36684.0859; val_edge_recon_loss: 2687384.5000; val_gene_expr_recon_loss: 723584.1875; val_masked_gp_l1_reg_loss: 6463.4990; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52932.9492; val_chrom_access_recon_loss: 435688.7188; val_global_loss: 3942738.0000; val_optim_loss: 3942738.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9593; val_auprc_score: 0.9474; val_best_acc_score: 0.9015; val_best_f1_score: 0.9074; train_kl_reg_loss: 38132.0365; train_edge_recon_loss: 2675295.0833; train_gene_expr_recon_loss: 723004.5625; train_masked_gp_l1_reg_loss: 6489.6250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51706.9674; train_chrom_access_recon_loss: 443016.3924; train_global_loss: 3937644.6389; train_optim_loss: 3937644.6389; val_kl_reg_loss: 36995.3828; val_edge_recon_loss: 2697012.7500; val_gene_expr_recon_loss: 720317.1250; val_masked_gp_l1_reg_loss: 6520.3931; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50208.0391; val_chrom_access_recon_loss: 435069.1875; val_global_loss: 3946123.2500; val_optim_loss: 3946123.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9581; val_auprc_score: 0.9401; val_best_acc_score: 0.9072; val_best_f1_score: 0.9110; train_kl_reg_loss: 38434.2782; train_edge_recon_loss: 2687954.7500; train_gene_expr_recon_loss: 718276.2639; train_masked_gp_l1_reg_loss: 6553.6761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49075.2018; train_chrom_access_recon_loss: 440754.9375; train_global_loss: 3941049.1667; train_optim_loss: 3941049.1667; val_kl_reg_loss: 37000.6484; val_edge_recon_loss: 2669589.7500; val_gene_expr_recon_loss: 716108.0000; val_masked_gp_l1_reg_loss: 6591.7178; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47691.5273; val_chrom_access_recon_loss: 434091.3438; val_global_loss: 3911073.0000; val_optim_loss: 3911073.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9601; val_auprc_score: 0.9440; val_best_acc_score: 0.9073; val_best_f1_score: 0.9116; train_kl_reg_loss: 38644.9041; train_edge_recon_loss: 2679956.6111; train_gene_expr_recon_loss: 713494.8889; train_masked_gp_l1_reg_loss: 6628.3003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46645.3707; train_chrom_access_recon_loss: 441125.9097; train_global_loss: 3926495.8889; train_optim_loss: 3926495.8889; val_kl_reg_loss: 38039.1523; val_edge_recon_loss: 2676783.7500; val_gene_expr_recon_loss: 713685.5625; val_masked_gp_l1_reg_loss: 6661.4551; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45362.5352; val_chrom_access_recon_loss: 433056.6250; val_global_loss: 3913589.0000; val_optim_loss: 3913589.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9611; val_auprc_score: 0.9453; val_best_acc_score: 0.9095; val_best_f1_score: 0.9139; train_kl_reg_loss: 38598.0234; train_edge_recon_loss: 2674067.6111; train_gene_expr_recon_loss: 711536.4653; train_masked_gp_l1_reg_loss: 6690.8848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44387.9141; train_chrom_access_recon_loss: 439933.5174; train_global_loss: 3915214.4167; train_optim_loss: 3915214.4167; val_kl_reg_loss: 37837.8359; val_edge_recon_loss: 2693886.2500; val_gene_expr_recon_loss: 710944.3750; val_masked_gp_l1_reg_loss: 6719.7002; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43201.3477; val_chrom_access_recon_loss: 432501.5000; val_global_loss: 3925091.0000; val_optim_loss: 3925091.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9654; val_auprc_score: 0.9513; val_best_acc_score: 0.9165; val_best_f1_score: 0.9199; train_kl_reg_loss: 38481.1406; train_edge_recon_loss: 2668597.8889; train_gene_expr_recon_loss: 707899.7778; train_masked_gp_l1_reg_loss: 6748.7730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42303.8303; train_chrom_access_recon_loss: 439200.1632; train_global_loss: 3903231.6111; train_optim_loss: 3903231.6111; val_kl_reg_loss: 37550.9375; val_edge_recon_loss: 2676310.5000; val_gene_expr_recon_loss: 708409.7500; val_masked_gp_l1_reg_loss: 6776.4888; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41210.1758; val_chrom_access_recon_loss: 432110.9375; val_global_loss: 3902369.0000; val_optim_loss: 3902369.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9634; val_auprc_score: 0.9507; val_best_acc_score: 0.9142; val_best_f1_score: 0.9174; train_kl_reg_loss: 38012.9779; train_edge_recon_loss: 2661502.6667; train_gene_expr_recon_loss: 705480.5486; train_masked_gp_l1_reg_loss: 6801.7215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40380.4818; train_chrom_access_recon_loss: 438506.8715; train_global_loss: 3890685.3333; train_optim_loss: 3890685.3333; val_kl_reg_loss: 35808.2305; val_edge_recon_loss: 2686198.0000; val_gene_expr_recon_loss: 704945.9375; val_masked_gp_l1_reg_loss: 6830.1504; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39365.3516; val_chrom_access_recon_loss: 431396.7812; val_global_loss: 3904544.5000; val_optim_loss: 3904544.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9655; val_auprc_score: 0.9521; val_best_acc_score: 0.9143; val_best_f1_score: 0.9176; train_kl_reg_loss: 37139.3377; train_edge_recon_loss: 2666139.2778; train_gene_expr_recon_loss: 706246.9236; train_masked_gp_l1_reg_loss: 6864.9700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38602.3207; train_chrom_access_recon_loss: 437593.2431; train_global_loss: 3892586.1111; train_optim_loss: 3892586.1111; val_kl_reg_loss: 35568.1797; val_edge_recon_loss: 2702535.7500; val_gene_expr_recon_loss: 703356.5000; val_masked_gp_l1_reg_loss: 6895.7222; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37668.0039; val_chrom_access_recon_loss: 431112.8438; val_global_loss: 3917137.0000; val_optim_loss: 3917137.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9664; val_auprc_score: 0.9566; val_best_acc_score: 0.9161; val_best_f1_score: 0.9195; train_kl_reg_loss: 37227.8854; train_edge_recon_loss: 2667721.3056; train_gene_expr_recon_loss: 700728.2708; train_masked_gp_l1_reg_loss: 6935.2762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36971.8207; train_chrom_access_recon_loss: 436467.8507; train_global_loss: 3886052.4444; train_optim_loss: 3886052.4444; val_kl_reg_loss: 35673.1641; val_edge_recon_loss: 2688649.5000; val_gene_expr_recon_loss: 702557.5000; val_masked_gp_l1_reg_loss: 6959.7729; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36104.0195; val_chrom_access_recon_loss: 430465.9688; val_global_loss: 3900410.0000; val_optim_loss: 3900410.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9675; val_auprc_score: 0.9562; val_best_acc_score: 0.9202; val_best_f1_score: 0.9242; train_kl_reg_loss: 34752.3112; train_edge_recon_loss: 2671556.8889; train_gene_expr_recon_loss: 983115.5486; train_masked_gp_l1_reg_loss: 6992.0582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35215.0833; train_chrom_access_recon_loss: 463599.5139; train_global_loss: 4195231.4444; train_optim_loss: 4195231.4444; val_kl_reg_loss: 12634.6943; val_edge_recon_loss: 2675865.0000; val_gene_expr_recon_loss: 972260.5000; val_masked_gp_l1_reg_loss: 7013.0303; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33986.7031; val_chrom_access_recon_loss: 454742.6875; val_global_loss: 4156502.7500; val_optim_loss: 4156502.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9733; val_auprc_score: 0.9641; val_best_acc_score: 0.9255; val_best_f1_score: 0.9282; train_kl_reg_loss: 30767.2055; train_edge_recon_loss: 2663428.7222; train_gene_expr_recon_loss: 971533.0764; train_masked_gp_l1_reg_loss: 7034.9308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32930.4733; train_chrom_access_recon_loss: 461508.1736; train_global_loss: 4167202.6389; train_optim_loss: 4167202.6389; val_kl_reg_loss: 12911.6348; val_edge_recon_loss: 2659001.2500; val_gene_expr_recon_loss: 969835.8750; val_masked_gp_l1_reg_loss: 7066.5405; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31615.6680; val_chrom_access_recon_loss: 454525.9688; val_global_loss: 4134957.2500; val_optim_loss: 4134957.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9726; val_auprc_score: 0.9582; val_best_acc_score: 0.9270; val_best_f1_score: 0.9291; train_kl_reg_loss: 29546.3785; train_edge_recon_loss: 2671521.0556; train_gene_expr_recon_loss: 973319.0000; train_masked_gp_l1_reg_loss: 7097.9264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30605.7020; train_chrom_access_recon_loss: 460687.2049; train_global_loss: 4172777.2778; train_optim_loss: 4172777.2778; val_kl_reg_loss: 12549.3086; val_edge_recon_loss: 2658513.7500; val_gene_expr_recon_loss: 964997.0000; val_masked_gp_l1_reg_loss: 7141.0161; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29378.4980; val_chrom_access_recon_loss: 453785.8750; val_global_loss: 4126365.5000; val_optim_loss: 4126365.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9739; val_auprc_score: 0.9629; val_best_acc_score: 0.9321; val_best_f1_score: 0.9345; train_kl_reg_loss: 26804.9570; train_edge_recon_loss: 2658417.4167; train_gene_expr_recon_loss: 970108.5903; train_masked_gp_l1_reg_loss: 7178.9758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28457.1259; train_chrom_access_recon_loss: 463347.2361; train_global_loss: 4154314.2778; train_optim_loss: 4154314.2778; val_kl_reg_loss: 11898.9473; val_edge_recon_loss: 2649751.5000; val_gene_expr_recon_loss: 962876.0000; val_masked_gp_l1_reg_loss: 7224.7402; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27345.8281; val_chrom_access_recon_loss: 453329.5000; val_global_loss: 4112426.5000; val_optim_loss: 4112426.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9711; val_auprc_score: 0.9586; val_best_acc_score: 0.9240; val_best_f1_score: 0.9274; train_kl_reg_loss: 25145.8424; train_edge_recon_loss: 2646628.6111; train_gene_expr_recon_loss: 957892.5903; train_masked_gp_l1_reg_loss: 7200.5053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27216.5820; train_chrom_access_recon_loss: 457320.6701; train_global_loss: 4121404.7778; train_optim_loss: 4121404.7778; val_kl_reg_loss: 12099.2148; val_edge_recon_loss: 2693879.5000; val_gene_expr_recon_loss: 963761.6250; val_masked_gp_l1_reg_loss: 7178.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27060.0410; val_chrom_access_recon_loss: 453449.7500; val_global_loss: 4157428.2500; val_optim_loss: 4157428.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9726; val_auprc_score: 0.9613; val_best_acc_score: 0.9275; val_best_f1_score: 0.9304; train_kl_reg_loss: 25375.3882; train_edge_recon_loss: 2651413.5000; train_gene_expr_recon_loss: 966904.4444; train_masked_gp_l1_reg_loss: 7173.7535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26950.4907; train_chrom_access_recon_loss: 460154.4792; train_global_loss: 4137972.0278; train_optim_loss: 4137972.0278; val_kl_reg_loss: 12018.0625; val_edge_recon_loss: 2685270.5000; val_gene_expr_recon_loss: 964411.6250; val_masked_gp_l1_reg_loss: 7166.5435; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26813.3633; val_chrom_access_recon_loss: 453516.5625; val_global_loss: 4149196.2500; val_optim_loss: 4149196.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9739; val_auprc_score: 0.9651; val_best_acc_score: 0.9287; val_best_f1_score: 0.9315; train_kl_reg_loss: 25162.1786; train_edge_recon_loss: 2649558.5278; train_gene_expr_recon_loss: 962642.4375; train_masked_gp_l1_reg_loss: 7163.7957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26711.2012; train_chrom_access_recon_loss: 458408.9028; train_global_loss: 4129647.0833; train_optim_loss: 4129647.0833; val_kl_reg_loss: 12088.6963; val_edge_recon_loss: 2660947.2500; val_gene_expr_recon_loss: 963201.3750; val_masked_gp_l1_reg_loss: 7161.1455; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26585.8691; val_chrom_access_recon_loss: 453396.3750; val_global_loss: 4123381.0000; val_optim_loss: 4123381.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9715; val_auprc_score: 0.9623; val_best_acc_score: 0.9270; val_best_f1_score: 0.9300; train_kl_reg_loss: 25072.8342; train_edge_recon_loss: 2655818.6389; train_gene_expr_recon_loss: 957885.4375; train_masked_gp_l1_reg_loss: 7160.4816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26489.5671; train_chrom_access_recon_loss: 457766.1250; train_global_loss: 4130193.0833; train_optim_loss: 4130193.0833; val_kl_reg_loss: 12203.1260; val_edge_recon_loss: 2682020.2500; val_gene_expr_recon_loss: 963178.5000; val_masked_gp_l1_reg_loss: 7160.5322; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26373.3672; val_chrom_access_recon_loss: 453395.4688; val_global_loss: 4144331.2500; val_optim_loss: 4144331.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 42 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9689
val AUPRC score: 0.9584
val best accuracy score: 0.9204
val best F1 score: 0.9232
val target rna MSE score: 3.9671
val source rna MSE score: 3.2218
val target atac MSE score: 0.1358
val source atac MSE score: 0.0214
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
