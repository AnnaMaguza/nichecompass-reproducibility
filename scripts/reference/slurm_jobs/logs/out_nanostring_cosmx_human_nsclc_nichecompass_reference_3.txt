[True, False, True]
Run timestamp: 06102023_190455_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '8', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000000.', '--lambda_gene_expr_recon', '300000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100.0', '--lambda_l1_addon', '100.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 43, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 43, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 631979
Number of validation nodes: 70220
Number of training edges: 1492281
Number of validation edges: 165809
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8866; val_auprc_score: 0.9808; val_best_acc_score: 0.9154; val_best_f1_score: 0.9536; train_kl_reg_loss: 46281.0577; train_edge_recon_loss: 64090298.4508; train_gene_expr_recon_loss: 257341261.0305; train_masked_gp_l1_reg_loss: 9440.6035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 276116.0928; train_global_loss: 321763397.6041; train_optim_loss: 321763397.6041; val_kl_reg_loss: 41808.9667; val_edge_recon_loss: 64328752.9383; val_gene_expr_recon_loss: 224648538.4198; val_masked_gp_l1_reg_loss: 13223.6768; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 287598.4375; val_global_loss: 289319900.5926; val_optim_loss: 289319900.5926
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8953; val_auprc_score: 0.9824; val_best_acc_score: 0.9178; val_best_f1_score: 0.9547; train_kl_reg_loss: 53000.9701; train_edge_recon_loss: 62060504.4885; train_gene_expr_recon_loss: 213311245.3050; train_masked_gp_l1_reg_loss: 14385.7414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 272575.7358; train_global_loss: 275711712.0549; train_optim_loss: 275711712.0549; val_kl_reg_loss: 65230.1492; val_edge_recon_loss: 64187019.5926; val_gene_expr_recon_loss: 207841313.6790; val_masked_gp_l1_reg_loss: 14856.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 256921.0938; val_global_loss: 272365344.8889; val_optim_loss: 272365344.8889
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9062; val_auprc_score: 0.9840; val_best_acc_score: 0.9238; val_best_f1_score: 0.9578; train_kl_reg_loss: 71241.5925; train_edge_recon_loss: 61725236.9400; train_gene_expr_recon_loss: 204031492.5832; train_masked_gp_l1_reg_loss: 14744.4013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 242761.2681; train_global_loss: 266085476.5777; train_optim_loss: 266085476.5777; val_kl_reg_loss: 79230.0292; val_edge_recon_loss: 63777957.5432; val_gene_expr_recon_loss: 202152065.3827; val_masked_gp_l1_reg_loss: 14609.1768; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 227936.7188; val_global_loss: 266251803.0617; val_optim_loss: 266251803.0617
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9178; val_auprc_score: 0.9864; val_best_acc_score: 0.9277; val_best_f1_score: 0.9600; train_kl_reg_loss: 82359.4091; train_edge_recon_loss: 61178530.8199; train_gene_expr_recon_loss: 199122560.9496; train_masked_gp_l1_reg_loss: 15422.1724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 219619.9364; train_global_loss: 260618492.7835; train_optim_loss: 260618492.7835; val_kl_reg_loss: 86691.0481; val_edge_recon_loss: 63712338.6296; val_gene_expr_recon_loss: 198786973.6790; val_masked_gp_l1_reg_loss: 15911.4932; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 211190.6250; val_global_loss: 262813094.8642; val_optim_loss: 262813094.8642
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9196; val_auprc_score: 0.9863; val_best_acc_score: 0.9295; val_best_f1_score: 0.9610; train_kl_reg_loss: 8477093092.1289; train_edge_recon_loss: 61010374.2106; train_gene_expr_recon_loss: 197016243.5184; train_masked_gp_l1_reg_loss: 16146.5244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 203522.2256; train_global_loss: 8735339814.3561; train_optim_loss: 8735339814.3561; val_kl_reg_loss: 100397.6521; val_edge_recon_loss: 63742113.3704; val_gene_expr_recon_loss: 197229555.3580; val_masked_gp_l1_reg_loss: 16299.7988; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 195389.1094; val_global_loss: 261283759.7531; val_optim_loss: 261283759.7531
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9231; val_auprc_score: 0.9873; val_best_acc_score: 0.9315; val_best_f1_score: 0.9621; train_kl_reg_loss: 101257.4912; train_edge_recon_loss: 61132907.7187; train_gene_expr_recon_loss: 195270273.3228; train_masked_gp_l1_reg_loss: 16470.3264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 190543.3870; train_global_loss: 256711452.6902; train_optim_loss: 256711452.6902; val_kl_reg_loss: 104861.7474; val_edge_recon_loss: 63177220.6914; val_gene_expr_recon_loss: 195530056.0494; val_masked_gp_l1_reg_loss: 16717.0098; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 186625.3750; val_global_loss: 259015480.9877; val_optim_loss: 259015480.9877
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9288; val_auprc_score: 0.9883; val_best_acc_score: 0.9329; val_best_f1_score: 0.9627; train_kl_reg_loss: 109242.4801; train_edge_recon_loss: 60769215.2535; train_gene_expr_recon_loss: 193941305.0511; train_masked_gp_l1_reg_loss: 16946.3121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 182646.3576; train_global_loss: 255019355.6364; train_optim_loss: 255019355.6364; val_kl_reg_loss: 108017.3105; val_edge_recon_loss: 63694218.6173; val_gene_expr_recon_loss: 193930606.9630; val_masked_gp_l1_reg_loss: 17450.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 180553.6562; val_global_loss: 257930856.0000; val_optim_loss: 257930856.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9277; val_auprc_score: 0.9879; val_best_acc_score: 0.9333; val_best_f1_score: 0.9630; train_kl_reg_loss: 479001.0888; train_edge_recon_loss: 60921558.1777; train_gene_expr_recon_loss: 192914618.1708; train_masked_gp_l1_reg_loss: 17445.0730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176667.9942; train_global_loss: 254509290.9887; train_optim_loss: 254509290.9887; val_kl_reg_loss: 123308.3382; val_edge_recon_loss: 63744930.0617; val_gene_expr_recon_loss: 193217907.6543; val_masked_gp_l1_reg_loss: 17441.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173541.9531; val_global_loss: 257277122.2716; val_optim_loss: 257277122.2716
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9319; val_auprc_score: 0.9886; val_best_acc_score: 0.9360; val_best_f1_score: 0.9645; train_kl_reg_loss: 124729.3345; train_edge_recon_loss: 60729832.0727; train_gene_expr_recon_loss: 191725691.0271; train_masked_gp_l1_reg_loss: 17521.2914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171960.1130; train_global_loss: 252769733.8127; train_optim_loss: 252769733.8127; val_kl_reg_loss: 131032.1701; val_edge_recon_loss: 62813597.9259; val_gene_expr_recon_loss: 192521319.6543; val_masked_gp_l1_reg_loss: 17595.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 170249.8594; val_global_loss: 255653805.0864; val_optim_loss: 255653805.0864
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9311; val_auprc_score: 0.9882; val_best_acc_score: 0.9356; val_best_f1_score: 0.9642; train_kl_reg_loss: 132642.2809; train_edge_recon_loss: 60614545.8827; train_gene_expr_recon_loss: 190689290.7856; train_masked_gp_l1_reg_loss: 17665.9541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169692.4241; train_global_loss: 251623837.4642; train_optim_loss: 251623837.4642; val_kl_reg_loss: 135193.7361; val_edge_recon_loss: 64038814.9877; val_gene_expr_recon_loss: 191330505.5802; val_masked_gp_l1_reg_loss: 17666.6738; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168523.5312; val_global_loss: 255690704.7901; val_optim_loss: 255690704.7901
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9330; val_auprc_score: 0.9888; val_best_acc_score: 0.9359; val_best_f1_score: 0.9644; train_kl_reg_loss: 143029.4330; train_edge_recon_loss: 60779919.4113; train_gene_expr_recon_loss: 190306633.7537; train_masked_gp_l1_reg_loss: 17571.7182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166701.4903; train_global_loss: 251413855.6048; train_optim_loss: 251413855.6048; val_kl_reg_loss: 149526.2654; val_edge_recon_loss: 63409398.2222; val_gene_expr_recon_loss: 191158261.4815; val_masked_gp_l1_reg_loss: 17521.3965; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 165145.9531; val_global_loss: 254899857.9753; val_optim_loss: 254899857.9753
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9347; val_auprc_score: 0.9891; val_best_acc_score: 0.9376; val_best_f1_score: 0.9654; train_kl_reg_loss: 1716377.4428; train_edge_recon_loss: 60573038.8254; train_gene_expr_recon_loss: 189957425.6906; train_masked_gp_l1_reg_loss: 17334.1963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163146.4032; train_global_loss: 252427322.8569; train_optim_loss: 252427322.8569; val_kl_reg_loss: 155852.0863; val_edge_recon_loss: 63242126.2716; val_gene_expr_recon_loss: 190890394.3704; val_masked_gp_l1_reg_loss: 17063.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159971.5312; val_global_loss: 254465396.9383; val_optim_loss: 254465396.9383
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9079; val_auprc_score: 0.9845; val_best_acc_score: 0.9261; val_best_f1_score: 0.9592; train_kl_reg_loss: 83702734.6162; train_edge_recon_loss: 64628698.1173; train_gene_expr_recon_loss: 666144759.3990; train_masked_gp_l1_reg_loss: 15027.8597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181859.4550; train_global_loss: 814673084.5310; train_optim_loss: 814673084.5310; val_kl_reg_loss: 190467.2634; val_edge_recon_loss: 63861055.2963; val_gene_expr_recon_loss: 220041323.5556; val_masked_gp_l1_reg_loss: 12761.8486; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 208884.3750; val_global_loss: 284314509.8272; val_optim_loss: 284314509.8272
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9282; val_auprc_score: 0.9876; val_best_acc_score: 0.9352; val_best_f1_score: 0.9641; train_kl_reg_loss: 202191.3099; train_edge_recon_loss: 61577550.7184; train_gene_expr_recon_loss: 215050521.2432; train_masked_gp_l1_reg_loss: 14176.3946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181305.8148; train_global_loss: 277025745.8552; train_optim_loss: 277025745.8552; val_kl_reg_loss: 228360.6191; val_edge_recon_loss: 64098866.9383; val_gene_expr_recon_loss: 200847918.3704; val_masked_gp_l1_reg_loss: 14790.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 181083.5156; val_global_loss: 265371017.8765; val_optim_loss: 265371017.8765
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9321; val_auprc_score: 0.9884; val_best_acc_score: 0.9364; val_best_f1_score: 0.9647; train_kl_reg_loss: 223441.1103; train_edge_recon_loss: 60784961.5643; train_gene_expr_recon_loss: 196332717.1348; train_masked_gp_l1_reg_loss: 15147.1778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159362.5337; train_global_loss: 257515629.5630; train_optim_loss: 257515629.5630; val_kl_reg_loss: 226392.5438; val_edge_recon_loss: 63506901.8889; val_gene_expr_recon_loss: 193478708.0000; val_masked_gp_l1_reg_loss: 15331.6074; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152242.9688; val_global_loss: 257379571.8025; val_optim_loss: 257379571.8025
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9355; val_auprc_score: 0.9894; val_best_acc_score: 0.9378; val_best_f1_score: 0.9655; train_kl_reg_loss: 13575547.5263; train_edge_recon_loss: 60514648.2580; train_gene_expr_recon_loss: 189065232.8837; train_masked_gp_l1_reg_loss: 15285.0109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149288.5239; train_global_loss: 263320002.2504; train_optim_loss: 263320002.2504; val_kl_reg_loss: 237132.3766; val_edge_recon_loss: 62734795.7901; val_gene_expr_recon_loss: 190456861.5802; val_masked_gp_l1_reg_loss: 15312.7285; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149092.0469; val_global_loss: 253593190.6667; val_optim_loss: 253593190.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9371; val_auprc_score: 0.9896; val_best_acc_score: 0.9371; val_best_f1_score: 0.9650; train_kl_reg_loss: 234456.2704; train_edge_recon_loss: 60569349.9156; train_gene_expr_recon_loss: 188773116.7012; train_masked_gp_l1_reg_loss: 15132.4513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147275.6626; train_global_loss: 249739330.7609; train_optim_loss: 249739330.7609; val_kl_reg_loss: 230410.7131; val_edge_recon_loss: 63480006.0988; val_gene_expr_recon_loss: 190336521.2346; val_masked_gp_l1_reg_loss: 15087.8330; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146874.0469; val_global_loss: 254208905.0370; val_optim_loss: 254208905.0370
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9337; val_auprc_score: 0.9887; val_best_acc_score: 0.9374; val_best_f1_score: 0.9653; train_kl_reg_loss: 240251.8082; train_edge_recon_loss: 60798696.0535; train_gene_expr_recon_loss: 188367976.3650; train_masked_gp_l1_reg_loss: 15012.1206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146824.5316; train_global_loss: 249568760.7986; train_optim_loss: 249568760.7986; val_kl_reg_loss: 250574.3659; val_edge_recon_loss: 63554147.7160; val_gene_expr_recon_loss: 188921009.4321; val_masked_gp_l1_reg_loss: 14873.5264; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146439.5156; val_global_loss: 252887043.4074; val_optim_loss: 252887043.4074
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9359; val_auprc_score: 0.9896; val_best_acc_score: 0.9386; val_best_f1_score: 0.9659; train_kl_reg_loss: 310480.3393; train_edge_recon_loss: 60666501.4751; train_gene_expr_recon_loss: 188645879.4319; train_masked_gp_l1_reg_loss: 14657.0118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144170.7047; train_global_loss: 249781689.3475; train_optim_loss: 249781689.3475; val_kl_reg_loss: 513157802.7247; val_edge_recon_loss: 62457347.9630; val_gene_expr_recon_loss: 188908323.4074; val_masked_gp_l1_reg_loss: 14427.3350; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141626.9062; val_global_loss: 764679508.9877; val_optim_loss: 764679508.9877
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9354; val_auprc_score: 0.9892; val_best_acc_score: 0.9376; val_best_f1_score: 0.9653; train_kl_reg_loss: 10237169621249.5645; train_edge_recon_loss: 60690536.9057; train_gene_expr_recon_loss: 188734406.9379; train_masked_gp_l1_reg_loss: 14254.8054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140649.0064; train_global_loss: 10237419115903.6484; train_optim_loss: 10237419115903.6484; val_kl_reg_loss: 261984.2087; val_edge_recon_loss: 63537781.9877; val_gene_expr_recon_loss: 192756454.0741; val_masked_gp_l1_reg_loss: 13974.2979; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139447.9219; val_global_loss: 256709630.0247; val_optim_loss: 256709630.0247
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9375; val_auprc_score: 0.9899; val_best_acc_score: 0.9385; val_best_f1_score: 0.9659; train_kl_reg_loss: 267010.6908; train_edge_recon_loss: 60625293.5122; train_gene_expr_recon_loss: 188405202.3657; train_masked_gp_l1_reg_loss: 13872.3517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138156.1305; train_global_loss: 249449535.4292; train_optim_loss: 249449535.4292; val_kl_reg_loss: 271816.1841; val_edge_recon_loss: 62729298.2840; val_gene_expr_recon_loss: 188343916.8889; val_masked_gp_l1_reg_loss: 13814.1436; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137758.2031; val_global_loss: 251496599.9012; val_optim_loss: 251496599.9012
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9364; val_auprc_score: 0.9894; val_best_acc_score: 0.9379; val_best_f1_score: 0.9654; train_kl_reg_loss: 270751.8632; train_edge_recon_loss: 60608016.8316; train_gene_expr_recon_loss: 187833104.6093; train_masked_gp_l1_reg_loss: 13671.3027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137132.0759; train_global_loss: 248862676.6930; train_optim_loss: 248862676.6930; val_kl_reg_loss: 269849.5091; val_edge_recon_loss: 63267437.6914; val_gene_expr_recon_loss: 188620715.7531; val_masked_gp_l1_reg_loss: 13651.6299; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137394.1406; val_global_loss: 252309043.9012; val_optim_loss: 252309043.9012
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9385; val_auprc_score: 0.9899; val_best_acc_score: 0.9379; val_best_f1_score: 0.9655; train_kl_reg_loss: 267779.1617; train_edge_recon_loss: 60637658.8597; train_gene_expr_recon_loss: 187537919.6322; train_masked_gp_l1_reg_loss: 13617.7511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137148.7224; train_global_loss: 248594124.2346; train_optim_loss: 248594124.2346; val_kl_reg_loss: 272432.1903; val_edge_recon_loss: 63252461.8272; val_gene_expr_recon_loss: 189132442.5185; val_masked_gp_l1_reg_loss: 13596.6523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137082.8125; val_global_loss: 252808024.7407; val_optim_loss: 252808024.7407
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9383; val_auprc_score: 0.9898; val_best_acc_score: 0.9395; val_best_f1_score: 0.9664; train_kl_reg_loss: 8433071.6145; train_edge_recon_loss: 60740078.8666; train_gene_expr_recon_loss: 189123678.3149; train_masked_gp_l1_reg_loss: 13243.4926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134240.8120; train_global_loss: 258444314.1654; train_optim_loss: 258444314.1654; val_kl_reg_loss: 289623.1706; val_edge_recon_loss: 63016258.9630; val_gene_expr_recon_loss: 189792369.6790; val_masked_gp_l1_reg_loss: 12936.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130745.2422; val_global_loss: 253241947.7531; val_optim_loss: 253241947.7531
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9387; val_auprc_score: 0.9898; val_best_acc_score: 0.9392; val_best_f1_score: 0.9662; train_kl_reg_loss: 345370.1997; train_edge_recon_loss: 60732507.3880; train_gene_expr_recon_loss: 188589742.1283; train_masked_gp_l1_reg_loss: 12810.6609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130537.3132; train_global_loss: 249810967.2672; train_optim_loss: 249810967.2672; val_kl_reg_loss: 302050.8682; val_edge_recon_loss: 63393122.3333; val_gene_expr_recon_loss: 189938385.6296; val_masked_gp_l1_reg_loss: 12770.4355; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129903.2344; val_global_loss: 253776230.5185; val_optim_loss: 253776230.5185

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9366; val_auprc_score: 0.9893; val_best_acc_score: 0.9399; val_best_f1_score: 0.9666; train_kl_reg_loss: 355902.1680; train_edge_recon_loss: 60903012.7684; train_gene_expr_recon_loss: 184369690.3959; train_masked_gp_l1_reg_loss: 13059.6377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127861.1725; train_global_loss: 245769526.0158; train_optim_loss: 245769526.0158; val_kl_reg_loss: 225966.5138; val_edge_recon_loss: 63362884.2840; val_gene_expr_recon_loss: 185434709.2346; val_masked_gp_l1_reg_loss: 13196.5488; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126960.7422; val_global_loss: 249163720.3457; val_optim_loss: 249163720.3457
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9369; val_auprc_score: 0.9893; val_best_acc_score: 0.9399; val_best_f1_score: 0.9666; train_kl_reg_loss: 313934.1765; train_edge_recon_loss: 60681122.2861; train_gene_expr_recon_loss: 183579319.3880; train_masked_gp_l1_reg_loss: 13240.3832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126408.4692; train_global_loss: 244714024.9798; train_optim_loss: 244714024.9798; val_kl_reg_loss: 210807.7904; val_edge_recon_loss: 63363375.1358; val_gene_expr_recon_loss: 184840854.2222; val_masked_gp_l1_reg_loss: 13276.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126019.7891; val_global_loss: 248554333.6790; val_optim_loss: 248554333.6790
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9382; val_auprc_score: 0.9896; val_best_acc_score: 0.9404; val_best_f1_score: 0.9669; train_kl_reg_loss: 311790.0609; train_edge_recon_loss: 60610888.2292; train_gene_expr_recon_loss: 183096325.9938; train_masked_gp_l1_reg_loss: 13307.0125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125711.4139; train_global_loss: 244158022.6086; train_optim_loss: 244158022.6086; val_kl_reg_loss: 206983.0757; val_edge_recon_loss: 63045050.8025; val_gene_expr_recon_loss: 184466141.3827; val_masked_gp_l1_reg_loss: 13339.8662; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125476.7812; val_global_loss: 247856991.0617; val_optim_loss: 247856991.0617
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9397; val_auprc_score: 0.9901; val_best_acc_score: 0.9403; val_best_f1_score: 0.9669; train_kl_reg_loss: 303606.2879; train_edge_recon_loss: 60728370.8226; train_gene_expr_recon_loss: 182828532.9509; train_masked_gp_l1_reg_loss: 13368.9173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125262.8221; train_global_loss: 243999143.9149; train_optim_loss: 243999143.9149; val_kl_reg_loss: 206643.4432; val_edge_recon_loss: 62661761.1111; val_gene_expr_recon_loss: 184338585.7284; val_masked_gp_l1_reg_loss: 13390.9072; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125123.5312; val_global_loss: 247345501.4321; val_optim_loss: 247345501.4321
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9394; val_auprc_score: 0.9898; val_best_acc_score: 0.9404; val_best_f1_score: 0.9669; train_kl_reg_loss: 297310.2236; train_edge_recon_loss: 60624924.4432; train_gene_expr_recon_loss: 182642122.9942; train_masked_gp_l1_reg_loss: 13429.1159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124983.7884; train_global_loss: 243702770.8597; train_optim_loss: 243702770.8597; val_kl_reg_loss: 207244.4974; val_edge_recon_loss: 63320699.2222; val_gene_expr_recon_loss: 183973764.8889; val_masked_gp_l1_reg_loss: 13454.3340; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124875.3203; val_global_loss: 247640043.8025; val_optim_loss: 247640043.8025
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9400; val_auprc_score: 0.9898; val_best_acc_score: 0.9407; val_best_f1_score: 0.9670; train_kl_reg_loss: 293063.7419; train_edge_recon_loss: 60598425.7304; train_gene_expr_recon_loss: 182352846.6662; train_masked_gp_l1_reg_loss: 13491.9588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124852.5041; train_global_loss: 243382680.8974; train_optim_loss: 243382680.8974; val_kl_reg_loss: 211429.1246; val_edge_recon_loss: 63125786.6173; val_gene_expr_recon_loss: 183866479.3580; val_masked_gp_l1_reg_loss: 13526.8887; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124878.3203; val_global_loss: 247342095.1605; val_optim_loss: 247342095.1605
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9396; val_auprc_score: 0.9899; val_best_acc_score: 0.9412; val_best_f1_score: 0.9673; train_kl_reg_loss: 286641.5364; train_edge_recon_loss: 60380506.0734; train_gene_expr_recon_loss: 182267918.8473; train_masked_gp_l1_reg_loss: 13558.2697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124786.2880; train_global_loss: 243073410.6731; train_optim_loss: 243073410.6731; val_kl_reg_loss: 212779.5021; val_edge_recon_loss: 62687507.4444; val_gene_expr_recon_loss: 183712151.3580; val_masked_gp_l1_reg_loss: 13593.4971; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124762.7812; val_global_loss: 246750806.4691; val_optim_loss: 246750806.4691
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9412; val_auprc_score: 0.9901; val_best_acc_score: 0.9413; val_best_f1_score: 0.9673; train_kl_reg_loss: 282969.7765; train_edge_recon_loss: 60424490.3163; train_gene_expr_recon_loss: 182073945.9184; train_masked_gp_l1_reg_loss: 13622.0002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124701.7804; train_global_loss: 242919731.0902; train_optim_loss: 242919731.0902; val_kl_reg_loss: 215339.7145; val_edge_recon_loss: 63334386.9012; val_gene_expr_recon_loss: 183687077.0370; val_masked_gp_l1_reg_loss: 13656.1572; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124676.2344; val_global_loss: 247375139.2593; val_optim_loss: 247375139.2593
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9411; val_auprc_score: 0.9902; val_best_acc_score: 0.9415; val_best_f1_score: 0.9675; train_kl_reg_loss: 278937.0821; train_edge_recon_loss: 60554158.6003; train_gene_expr_recon_loss: 181982935.2398; train_masked_gp_l1_reg_loss: 13691.2587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124618.5148; train_global_loss: 242954339.4086; train_optim_loss: 242954339.4086; val_kl_reg_loss: 216671.3522; val_edge_recon_loss: 62962829.1111; val_gene_expr_recon_loss: 183439963.6049; val_masked_gp_l1_reg_loss: 13720.1387; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124568.1406; val_global_loss: 246757767.8025; val_optim_loss: 246757767.8025
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9405; val_auprc_score: 0.9899; val_best_acc_score: 0.9420; val_best_f1_score: 0.9678; train_kl_reg_loss: 274311.8291; train_edge_recon_loss: 60450939.1506; train_gene_expr_recon_loss: 181893177.5780; train_masked_gp_l1_reg_loss: 13746.8211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124534.3248; train_global_loss: 242756710.1365; train_optim_loss: 242756710.1365; val_kl_reg_loss: 219731.4028; val_edge_recon_loss: 62430982.3827; val_gene_expr_recon_loss: 183434750.3704; val_masked_gp_l1_reg_loss: 13773.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124502.9453; val_global_loss: 246223736.7901; val_optim_loss: 246223736.7901
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9414; val_auprc_score: 0.9902; val_best_acc_score: 0.9411; val_best_f1_score: 0.9673; train_kl_reg_loss: 273103.3138; train_edge_recon_loss: 60508246.1077; train_gene_expr_recon_loss: 181814418.0419; train_masked_gp_l1_reg_loss: 13795.5802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124514.0275; train_global_loss: 242734077.0964; train_optim_loss: 242734077.0964; val_kl_reg_loss: 225088.6407; val_edge_recon_loss: 63356461.8025; val_gene_expr_recon_loss: 183335464.5432; val_masked_gp_l1_reg_loss: 13823.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124404.6016; val_global_loss: 247055238.5185; val_optim_loss: 247055238.5185
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9421; val_auprc_score: 0.9904; val_best_acc_score: 0.9424; val_best_f1_score: 0.9680; train_kl_reg_loss: 271939.7106; train_edge_recon_loss: 60467279.7489; train_gene_expr_recon_loss: 181614264.4748; train_masked_gp_l1_reg_loss: 13857.9221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124442.3248; train_global_loss: 242491784.5681; train_optim_loss: 242491784.5681; val_kl_reg_loss: 226534.7974; val_edge_recon_loss: 62601260.5185; val_gene_expr_recon_loss: 183228758.0741; val_masked_gp_l1_reg_loss: 13889.7275; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124436.5000; val_global_loss: 246194873.9259; val_optim_loss: 246194873.9259
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9405; val_auprc_score: 0.9902; val_best_acc_score: 0.9410; val_best_f1_score: 0.9672; train_kl_reg_loss: 272415.5111; train_edge_recon_loss: 60452197.4765; train_gene_expr_recon_loss: 181596709.6425; train_masked_gp_l1_reg_loss: 13915.8480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124452.9533; train_global_loss: 242459690.3465; train_optim_loss: 242459690.3465; val_kl_reg_loss: 230905.5682; val_edge_recon_loss: 62897231.8642; val_gene_expr_recon_loss: 183027550.7654; val_masked_gp_l1_reg_loss: 13943.7256; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124353.1953; val_global_loss: 246293976.0988; val_optim_loss: 246293976.0988
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9412; val_auprc_score: 0.9901; val_best_acc_score: 0.9408; val_best_f1_score: 0.9671; train_kl_reg_loss: 269423.7439; train_edge_recon_loss: 60342306.0254; train_gene_expr_recon_loss: 181469228.6024; train_masked_gp_l1_reg_loss: 13975.8636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124388.4920; train_global_loss: 242219324.0864; train_optim_loss: 242219324.0864; val_kl_reg_loss: 233719.9609; val_edge_recon_loss: 63322777.1852; val_gene_expr_recon_loss: 183222697.7778; val_masked_gp_l1_reg_loss: 14002.3135; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124473.0000; val_global_loss: 246917674.9630; val_optim_loss: 246917674.9630
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9416; val_auprc_score: 0.9902; val_best_acc_score: 0.9420; val_best_f1_score: 0.9677; train_kl_reg_loss: 267947.3247; train_edge_recon_loss: 60262616.1166; train_gene_expr_recon_loss: 181426570.3410; train_masked_gp_l1_reg_loss: 14031.5443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124393.8131; train_global_loss: 242095558.9050; train_optim_loss: 242095558.9050; val_kl_reg_loss: 235695.4354; val_edge_recon_loss: 62907182.1728; val_gene_expr_recon_loss: 182996177.5309; val_masked_gp_l1_reg_loss: 14068.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124429.2969; val_global_loss: 246277550.7160; val_optim_loss: 246277550.7160
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9426; val_auprc_score: 0.9901; val_best_acc_score: 0.9431; val_best_f1_score: 0.9683; train_kl_reg_loss: 267213.2880; train_edge_recon_loss: 60498356.4693; train_gene_expr_recon_loss: 181330198.5153; train_masked_gp_l1_reg_loss: 14097.9459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124445.9601; train_global_loss: 242234311.8655; train_optim_loss: 242234311.8655; val_kl_reg_loss: 240507.4961; val_edge_recon_loss: 63002660.3210; val_gene_expr_recon_loss: 182840355.3086; val_masked_gp_l1_reg_loss: 14122.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124360.7188; val_global_loss: 246222019.3580; val_optim_loss: 246222019.3580

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9414; val_auprc_score: 0.9904; val_best_acc_score: 0.9421; val_best_f1_score: 0.9679; train_kl_reg_loss: 269018.0957; train_edge_recon_loss: 60570214.7005; train_gene_expr_recon_loss: 180903105.6686; train_masked_gp_l1_reg_loss: 14136.0423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124241.3063; train_global_loss: 241880715.3235; train_optim_loss: 241880715.3235; val_kl_reg_loss: 239483.7825; val_edge_recon_loss: 62312577.8025; val_gene_expr_recon_loss: 182586299.7037; val_masked_gp_l1_reg_loss: 14147.4014; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124181.9219; val_global_loss: 245276681.5802; val_optim_loss: 245276681.5802
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9417; val_auprc_score: 0.9905; val_best_acc_score: 0.9419; val_best_f1_score: 0.9678; train_kl_reg_loss: 268321.2708; train_edge_recon_loss: 60419567.2549; train_gene_expr_recon_loss: 180853522.9036; train_masked_gp_l1_reg_loss: 14157.2082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124153.0184; train_global_loss: 241679719.8216; train_optim_loss: 241679719.8216; val_kl_reg_loss: 239474.6462; val_edge_recon_loss: 62374451.4938; val_gene_expr_recon_loss: 182693408.1975; val_masked_gp_l1_reg_loss: 14166.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124129.6875; val_global_loss: 245445622.0247; val_optim_loss: 245445622.0247
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9422; val_auprc_score: 0.9905; val_best_acc_score: 0.9422; val_best_f1_score: 0.9679; train_kl_reg_loss: 267826.2255; train_edge_recon_loss: 60411894.0117; train_gene_expr_recon_loss: 180740249.9293; train_masked_gp_l1_reg_loss: 14175.2040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124109.8405; train_global_loss: 241558255.0504; train_optim_loss: 241558255.0504; val_kl_reg_loss: 239549.5202; val_edge_recon_loss: 62375117.3457; val_gene_expr_recon_loss: 182349397.8765; val_masked_gp_l1_reg_loss: 14183.8838; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124112.2891; val_global_loss: 245102352.8395; val_optim_loss: 245102352.8395
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9425; val_auprc_score: 0.9905; val_best_acc_score: 0.9418; val_best_f1_score: 0.9676; train_kl_reg_loss: 267879.3383; train_edge_recon_loss: 60607681.8635; train_gene_expr_recon_loss: 180805250.2504; train_masked_gp_l1_reg_loss: 14191.9911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124100.0906; train_global_loss: 241819101.7057; train_optim_loss: 241819101.7057; val_kl_reg_loss: 239443.3483; val_edge_recon_loss: 62956094.2469; val_gene_expr_recon_loss: 182552634.9136; val_masked_gp_l1_reg_loss: 14199.0566; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124083.3516; val_global_loss: 245886444.3457; val_optim_loss: 245886444.3457
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9435; val_auprc_score: 0.9905; val_best_acc_score: 0.9430; val_best_f1_score: 0.9683; train_kl_reg_loss: 267344.3238; train_edge_recon_loss: 60274252.4089; train_gene_expr_recon_loss: 180787867.2686; train_masked_gp_l1_reg_loss: 14205.4750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124081.5918; train_global_loss: 241467750.4274; train_optim_loss: 241467750.4274; val_kl_reg_loss: 240371.9751; val_edge_recon_loss: 62660167.1728; val_gene_expr_recon_loss: 182493243.4568; val_masked_gp_l1_reg_loss: 14212.0488; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124083.9688; val_global_loss: 245532070.3704; val_optim_loss: 245532070.3704
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9430; val_auprc_score: 0.9906; val_best_acc_score: 0.9421; val_best_f1_score: 0.9679; train_kl_reg_loss: 266980.5724; train_edge_recon_loss: 60349519.8669; train_gene_expr_recon_loss: 180780363.7187; train_masked_gp_l1_reg_loss: 14218.4313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124066.2873; train_global_loss: 241535149.4532; train_optim_loss: 241535149.4532; val_kl_reg_loss: 239618.9287; val_edge_recon_loss: 62386791.0247; val_gene_expr_recon_loss: 182334128.1975; val_masked_gp_l1_reg_loss: 14224.8291; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124069.2969; val_global_loss: 245098826.4691; val_optim_loss: 245098826.4691
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9419; val_auprc_score: 0.9903; val_best_acc_score: 0.9425; val_best_f1_score: 0.9680; train_kl_reg_loss: 267065.6314; train_edge_recon_loss: 60524327.6720; train_gene_expr_recon_loss: 180745495.4429; train_masked_gp_l1_reg_loss: 14230.3849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124065.1778; train_global_loss: 241675183.5828; train_optim_loss: 241675183.5828; val_kl_reg_loss: 240520.0094; val_edge_recon_loss: 62266668.5926; val_gene_expr_recon_loss: 182673144.9383; val_masked_gp_l1_reg_loss: 14235.7695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124045.3828; val_global_loss: 245318621.8765; val_optim_loss: 245318621.8765
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9436; val_auprc_score: 0.9906; val_best_acc_score: 0.9431; val_best_f1_score: 0.9684; train_kl_reg_loss: 267383.3870; train_edge_recon_loss: 60588214.4494; train_gene_expr_recon_loss: 180770918.5208; train_masked_gp_l1_reg_loss: 14241.2087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124046.3627; train_global_loss: 241764800.8727; train_optim_loss: 241764800.8727; val_kl_reg_loss: 240782.8294; val_edge_recon_loss: 62465538.3086; val_gene_expr_recon_loss: 182438625.3333; val_masked_gp_l1_reg_loss: 14246.8691; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124037.1953; val_global_loss: 245283218.9136; val_optim_loss: 245283218.9136
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9410; val_auprc_score: 0.9900; val_best_acc_score: 0.9413; val_best_f1_score: 0.9673; train_kl_reg_loss: 266719.2382; train_edge_recon_loss: 60237962.0364; train_gene_expr_recon_loss: 180792065.7784; train_masked_gp_l1_reg_loss: 14252.5683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124032.8733; train_global_loss: 241435032.9633; train_optim_loss: 241435032.9633; val_kl_reg_loss: 239961.3819; val_edge_recon_loss: 63288565.8272; val_gene_expr_recon_loss: 182570705.0864; val_masked_gp_l1_reg_loss: 14257.8643; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124020.6406; val_global_loss: 246237504.2469; val_optim_loss: 246237504.2469
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9409; val_auprc_score: 0.9902; val_best_acc_score: 0.9420; val_best_f1_score: 0.9677; train_kl_reg_loss: 266608.7314; train_edge_recon_loss: 60248162.5647; train_gene_expr_recon_loss: 180732919.8436; train_masked_gp_l1_reg_loss: 14262.9906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124030.3396; train_global_loss: 241385983.1657; train_optim_loss: 241385983.1657; val_kl_reg_loss: 240721.6649; val_edge_recon_loss: 62447445.7407; val_gene_expr_recon_loss: 182382607.8519; val_masked_gp_l1_reg_loss: 14268.2373; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124039.2969; val_global_loss: 245209079.3580; val_optim_loss: 245209079.3580

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9436; val_auprc_score: 0.9907; val_best_acc_score: 0.9423; val_best_f1_score: 0.9679; train_kl_reg_loss: 266392.1399; train_edge_recon_loss: 60570451.8422; train_gene_expr_recon_loss: 180643775.9451; train_masked_gp_l1_reg_loss: 14268.8066; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124032.9614; train_global_loss: 241618923.9767; train_optim_loss: 241618923.9767; val_kl_reg_loss: 240492.0232; val_edge_recon_loss: 62947794.1975; val_gene_expr_recon_loss: 182462582.5185; val_masked_gp_l1_reg_loss: 14269.4941; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124027.9766; val_global_loss: 245789172.6914; val_optim_loss: 245789172.6914
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9431; val_auprc_score: 0.9906; val_best_acc_score: 0.9423; val_best_f1_score: 0.9679; train_kl_reg_loss: 266311.6125; train_edge_recon_loss: 60323508.0247; train_gene_expr_recon_loss: 180671140.4185; train_masked_gp_l1_reg_loss: 14270.2480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124024.3993; train_global_loss: 241399256.3266; train_optim_loss: 241399256.3266; val_kl_reg_loss: 240359.8329; val_edge_recon_loss: 62646149.6543; val_gene_expr_recon_loss: 182351486.4691; val_masked_gp_l1_reg_loss: 14270.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124022.4844; val_global_loss: 245376284.0988; val_optim_loss: 245376284.0988
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9409; val_auprc_score: 0.9900; val_best_acc_score: 0.9422; val_best_f1_score: 0.9679; train_kl_reg_loss: 266325.8193; train_edge_recon_loss: 60445327.7214; train_gene_expr_recon_loss: 180723048.3211; train_masked_gp_l1_reg_loss: 14271.6420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124020.6036; train_global_loss: 241572989.9307; train_optim_loss: 241572989.9307; val_kl_reg_loss: 240675.7846; val_edge_recon_loss: 62968686.6667; val_gene_expr_recon_loss: 182348288.2469; val_masked_gp_l1_reg_loss: 14272.2549; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124018.0078; val_global_loss: 245695938.8148; val_optim_loss: 245695938.8148
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9407; val_auprc_score: 0.9900; val_best_acc_score: 0.9423; val_best_f1_score: 0.9678; train_kl_reg_loss: 266288.5811; train_edge_recon_loss: 60326138.0213; train_gene_expr_recon_loss: 180702717.1238; train_masked_gp_l1_reg_loss: 14272.7949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124017.1099; train_global_loss: 241433431.7777; train_optim_loss: 241433431.7777; val_kl_reg_loss: 240719.0814; val_edge_recon_loss: 62539827.0494; val_gene_expr_recon_loss: 182492088.7407; val_masked_gp_l1_reg_loss: 14273.4053; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124014.0391; val_global_loss: 245410923.6049; val_optim_loss: 245410923.6049

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 634 min 37 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9413
val AUPRC score: 0.9903
val best accuracy score: 0.9419
val best F1 score: 0.9677
val target rna MSE score: 0.5999
val source rna MSE score: 0.1296
Val cat covariate0 mean sim diff: -0.0008
Val cat covariate1 mean sim diff: -0.0586
Val cat covariate2 mean sim diff: -0.0001

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
