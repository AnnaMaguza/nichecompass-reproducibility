[True, False, True]
Run timestamp: 05092023_101353_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '100000.0', '--contrastive_logits_pos_ratio', '0.0078125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 563097
Number of validation nodes: 62566
Number of training edges: 1330101
Number of validation edges: 147789
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9250; val_auprc_score: 0.9861; val_best_acc_score: 0.9286; val_best_f1_score: 0.9600; train_kl_reg_loss: 16036.6711; train_edge_recon_loss: 714404.6188; train_cat_covariates_contrastive_loss: 99699.2982; train_gene_expr_recon_loss: 2525417.8529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59305.4137; train_global_loss: 3414863.8514; train_optim_loss: 3414863.8514; val_kl_reg_loss: 15697.0860; val_edge_recon_loss: 713587.2403; val_cat_covariates_contrastive_loss: 100280.7757; val_gene_expr_recon_loss: 2189897.6181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15632.8203; val_global_loss: 3035095.4654; val_optim_loss: 3035095.4654
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9286; val_auprc_score: 0.9863; val_best_acc_score: 0.9313; val_best_f1_score: 0.9613; train_kl_reg_loss: 17383.7243; train_edge_recon_loss: 690313.6588; train_cat_covariates_contrastive_loss: 99625.8881; train_gene_expr_recon_loss: 2069943.5837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15848.2565; train_global_loss: 2893115.1103; train_optim_loss: 2893115.1103; val_kl_reg_loss: 18490.8147; val_edge_recon_loss: 718079.4427; val_cat_covariates_contrastive_loss: 99170.4990; val_gene_expr_recon_loss: 1994435.3953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16035.9326; val_global_loss: 2846212.1436; val_optim_loss: 2846212.1436
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9346; val_auprc_score: 0.9877; val_best_acc_score: 0.9353; val_best_f1_score: 0.9636; train_kl_reg_loss: 18967.4088; train_edge_recon_loss: 687073.6747; train_cat_covariates_contrastive_loss: 99394.3443; train_gene_expr_recon_loss: 1956156.6501; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16448.3832; train_global_loss: 2778040.4644; train_optim_loss: 2778040.4644; val_kl_reg_loss: 19763.2994; val_edge_recon_loss: 709231.1211; val_cat_covariates_contrastive_loss: 99346.3290; val_gene_expr_recon_loss: 1929147.3971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16753.9766; val_global_loss: 2774242.1566; val_optim_loss: 2774242.1566
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9381; val_auprc_score: 0.9885; val_best_acc_score: 0.9365; val_best_f1_score: 0.9642; train_kl_reg_loss: 19704.4677; train_edge_recon_loss: 685356.9427; train_cat_covariates_contrastive_loss: 99358.1852; train_gene_expr_recon_loss: 1910993.3482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16645.5752; train_global_loss: 2732058.5213; train_optim_loss: 2732058.5213; val_kl_reg_loss: 19593.4006; val_edge_recon_loss: 710159.3279; val_cat_covariates_contrastive_loss: 100115.8683; val_gene_expr_recon_loss: 1898368.1125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16665.9609; val_global_loss: 2744902.7119; val_optim_loss: 2744902.7119
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9356; val_auprc_score: 0.9876; val_best_acc_score: 0.9365; val_best_f1_score: 0.9642; train_kl_reg_loss: 20436.7324; train_edge_recon_loss: 686048.9388; train_cat_covariates_contrastive_loss: 99358.6888; train_gene_expr_recon_loss: 1889281.6309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16698.0374; train_global_loss: 2711824.0243; train_optim_loss: 2711824.0243; val_kl_reg_loss: 21111.6866; val_edge_recon_loss: 711060.9321; val_cat_covariates_contrastive_loss: 98744.1610; val_gene_expr_recon_loss: 1883033.6233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16823.3262; val_global_loss: 2730773.6522; val_optim_loss: 2730773.6522
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9401; val_auprc_score: 0.9886; val_best_acc_score: 0.9399; val_best_f1_score: 0.9662; train_kl_reg_loss: 20846.0384; train_edge_recon_loss: 686752.7284; train_cat_covariates_contrastive_loss: 99387.2406; train_gene_expr_recon_loss: 1872606.4541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16736.2915; train_global_loss: 2696328.7544; train_optim_loss: 2696328.7544; val_kl_reg_loss: 21159.7460; val_edge_recon_loss: 701578.4429; val_cat_covariates_contrastive_loss: 99133.1003; val_gene_expr_recon_loss: 1870838.0480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16700.1914; val_global_loss: 2709409.5822; val_optim_loss: 2709409.5822
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9378; val_auprc_score: 0.9879; val_best_acc_score: 0.9381; val_best_f1_score: 0.9651; train_kl_reg_loss: 21275.1439; train_edge_recon_loss: 684213.3555; train_cat_covariates_contrastive_loss: 99343.5250; train_gene_expr_recon_loss: 1860660.2844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16775.2448; train_global_loss: 2682267.5530; train_optim_loss: 2682267.5530; val_kl_reg_loss: 22381.0510; val_edge_recon_loss: 709007.2093; val_cat_covariates_contrastive_loss: 98595.8551; val_gene_expr_recon_loss: 1858314.6029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16751.3691; val_global_loss: 2705049.9637; val_optim_loss: 2705049.9637
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9419; val_auprc_score: 0.9890; val_best_acc_score: 0.9397; val_best_f1_score: 0.9660; train_kl_reg_loss: 21837.2929; train_edge_recon_loss: 686400.0366; train_cat_covariates_contrastive_loss: 99440.9748; train_gene_expr_recon_loss: 1849164.5607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16858.2709; train_global_loss: 2673701.1338; train_optim_loss: 2673701.1338; val_kl_reg_loss: 21407.9322; val_edge_recon_loss: 709576.0154; val_cat_covariates_contrastive_loss: 100234.1726; val_gene_expr_recon_loss: 1850816.9100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16749.5801; val_global_loss: 2698784.5311; val_optim_loss: 2698784.5311
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9392; val_auprc_score: 0.9881; val_best_acc_score: 0.9386; val_best_f1_score: 0.9655; train_kl_reg_loss: 22230.3798; train_edge_recon_loss: 684085.0071; train_cat_covariates_contrastive_loss: 99428.2081; train_gene_expr_recon_loss: 1841929.2953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16998.5794; train_global_loss: 2664671.4712; train_optim_loss: 2664671.4712; val_kl_reg_loss: 22541.1187; val_edge_recon_loss: 714035.5284; val_cat_covariates_contrastive_loss: 99064.9214; val_gene_expr_recon_loss: 1839622.2253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17023.1445; val_global_loss: 2692287.0355; val_optim_loss: 2692287.0355
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9432; val_auprc_score: 0.9892; val_best_acc_score: 0.9402; val_best_f1_score: 0.9663; train_kl_reg_loss: 22596.3683; train_edge_recon_loss: 687736.4280; train_cat_covariates_contrastive_loss: 99473.9989; train_gene_expr_recon_loss: 1833284.3552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17075.6054; train_global_loss: 2660166.7575; train_optim_loss: 2660166.7575; val_kl_reg_loss: 22895.0272; val_edge_recon_loss: 709059.9883; val_cat_covariates_contrastive_loss: 99326.0580; val_gene_expr_recon_loss: 1837400.3789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17128.2500; val_global_loss: 2685809.6955; val_optim_loss: 2685809.6955
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9449; val_auprc_score: 0.9895; val_best_acc_score: 0.9409; val_best_f1_score: 0.9666; train_kl_reg_loss: 22901.8011; train_edge_recon_loss: 686990.3878; train_cat_covariates_contrastive_loss: 99466.4071; train_gene_expr_recon_loss: 1825260.2306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17149.4130; train_global_loss: 2651768.2391; train_optim_loss: 2651768.2391; val_kl_reg_loss: 22465.8004; val_edge_recon_loss: 718548.8653; val_cat_covariates_contrastive_loss: 100348.8232; val_gene_expr_recon_loss: 1844948.5212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17189.8359; val_global_loss: 2703501.7578; val_optim_loss: 2703501.7578
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9420; val_auprc_score: 0.9888; val_best_acc_score: 0.9405; val_best_f1_score: 0.9665; train_kl_reg_loss: 23633.3400; train_edge_recon_loss: 689775.5213; train_cat_covariates_contrastive_loss: 99370.2750; train_gene_expr_recon_loss: 1936264.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17392.4866; train_global_loss: 2766435.7040; train_optim_loss: 2766435.7040; val_kl_reg_loss: 23623.3380; val_edge_recon_loss: 709810.6263; val_cat_covariates_contrastive_loss: 99384.7874; val_gene_expr_recon_loss: 1930385.2046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17324.8672; val_global_loss: 2780528.7085; val_optim_loss: 2780528.7085
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9435; val_auprc_score: 0.9893; val_best_acc_score: 0.9406; val_best_f1_score: 0.9664; train_kl_reg_loss: 30421242.0589; train_edge_recon_loss: 692037.7756; train_cat_covariates_contrastive_loss: 99323.4883; train_gene_expr_recon_loss: 2039288.5882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18089.5495; train_global_loss: 33269978.9279; train_optim_loss: 33269978.9279; val_kl_reg_loss: 25592.8015; val_edge_recon_loss: 710577.4511; val_cat_covariates_contrastive_loss: 100750.9140; val_gene_expr_recon_loss: 1933378.2530; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17137.6250; val_global_loss: 2787437.0000; val_optim_loss: 2787437.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9420; val_auprc_score: 0.9887; val_best_acc_score: 0.9408; val_best_f1_score: 0.9666; train_kl_reg_loss: 26848.7661; train_edge_recon_loss: 685938.9017; train_cat_covariates_contrastive_loss: 99970.8377; train_gene_expr_recon_loss: 1886600.6525; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17178.4732; train_global_loss: 2716537.6282; train_optim_loss: 2716537.6282; val_kl_reg_loss: 27720.8706; val_edge_recon_loss: 712245.4604; val_cat_covariates_contrastive_loss: 99337.6036; val_gene_expr_recon_loss: 1857358.2357; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17241.5605; val_global_loss: 2713903.6609; val_optim_loss: 2713903.6609

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9447; val_auprc_score: 0.9894; val_best_acc_score: 0.9407; val_best_f1_score: 0.9666; train_kl_reg_loss: 26611.2965; train_edge_recon_loss: 685019.8608; train_cat_covariates_contrastive_loss: 99987.2557; train_gene_expr_recon_loss: 1826821.5035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8373.0617; train_global_loss: 2646812.9760; train_optim_loss: 2646812.9760; val_kl_reg_loss: 26709.8319; val_edge_recon_loss: 710785.8232; val_cat_covariates_contrastive_loss: 99993.8710; val_gene_expr_recon_loss: 1828848.8932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8307.1748; val_global_loss: 2674645.6799; val_optim_loss: 2674645.6799
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9466; val_auprc_score: 0.9898; val_best_acc_score: 0.9426; val_best_f1_score: 0.9675; train_kl_reg_loss: 26371.9450; train_edge_recon_loss: 684197.2860; train_cat_covariates_contrastive_loss: 99976.4611; train_gene_expr_recon_loss: 1815600.8864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8303.9961; train_global_loss: 2634450.5764; train_optim_loss: 2634450.5764; val_kl_reg_loss: 26297.8132; val_edge_recon_loss: 710776.5804; val_cat_covariates_contrastive_loss: 100106.4164; val_gene_expr_recon_loss: 1819216.3988; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8257.2930; val_global_loss: 2664654.4533; val_optim_loss: 2664654.4533
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9474; val_auprc_score: 0.9900; val_best_acc_score: 0.9429; val_best_f1_score: 0.9677; train_kl_reg_loss: 26023.5944; train_edge_recon_loss: 685641.7736; train_cat_covariates_contrastive_loss: 99962.7824; train_gene_expr_recon_loss: 1807366.7873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8299.1468; train_global_loss: 2627294.0855; train_optim_loss: 2627294.0855; val_kl_reg_loss: 25829.7148; val_edge_recon_loss: 706498.6981; val_cat_covariates_contrastive_loss: 100207.4657; val_gene_expr_recon_loss: 1810232.7314; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8281.1494; val_global_loss: 2651049.8642; val_optim_loss: 2651049.8642
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9454; val_auprc_score: 0.9896; val_best_acc_score: 0.9426; val_best_f1_score: 0.9676; train_kl_reg_loss: 25693.8990; train_edge_recon_loss: 684046.5543; train_cat_covariates_contrastive_loss: 99923.2660; train_gene_expr_recon_loss: 1800806.6557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8309.9911; train_global_loss: 2618780.3663; train_optim_loss: 2618780.3663; val_kl_reg_loss: 25640.3475; val_edge_recon_loss: 711496.0621; val_cat_covariates_contrastive_loss: 100069.2234; val_gene_expr_recon_loss: 1805119.0705; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8265.0420; val_global_loss: 2650589.6981; val_optim_loss: 2650589.6981
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9479; val_auprc_score: 0.9899; val_best_acc_score: 0.9433; val_best_f1_score: 0.9679; train_kl_reg_loss: 25314.0944; train_edge_recon_loss: 683674.8915; train_cat_covariates_contrastive_loss: 99890.9205; train_gene_expr_recon_loss: 1795084.3868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8309.0131; train_global_loss: 2612273.3073; train_optim_loss: 2612273.3073; val_kl_reg_loss: 25275.7644; val_edge_recon_loss: 709626.5737; val_cat_covariates_contrastive_loss: 99948.9541; val_gene_expr_recon_loss: 1801549.6561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8358.0898; val_global_loss: 2644758.9524; val_optim_loss: 2644758.9524
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9472; val_auprc_score: 0.9901; val_best_acc_score: 0.9427; val_best_f1_score: 0.9677; train_kl_reg_loss: 25012.5292; train_edge_recon_loss: 683780.9771; train_cat_covariates_contrastive_loss: 99802.7877; train_gene_expr_recon_loss: 1791723.1655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8337.9582; train_global_loss: 2608657.4155; train_optim_loss: 2608657.4155; val_kl_reg_loss: 25059.5774; val_edge_recon_loss: 703584.9983; val_cat_covariates_contrastive_loss: 99837.8426; val_gene_expr_recon_loss: 1799479.6557; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8349.4932; val_global_loss: 2636311.5588; val_optim_loss: 2636311.5588
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9467; val_auprc_score: 0.9897; val_best_acc_score: 0.9418; val_best_f1_score: 0.9670; train_kl_reg_loss: 24786.9780; train_edge_recon_loss: 682631.8149; train_cat_covariates_contrastive_loss: 99709.9369; train_gene_expr_recon_loss: 1788642.3712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8377.0553; train_global_loss: 2604148.1586; train_optim_loss: 2604148.1586; val_kl_reg_loss: 24638.2235; val_edge_recon_loss: 717220.3921; val_cat_covariates_contrastive_loss: 100322.1162; val_gene_expr_recon_loss: 1796621.1860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8377.3174; val_global_loss: 2647179.1696; val_optim_loss: 2647179.1696
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9474; val_auprc_score: 0.9900; val_best_acc_score: 0.9435; val_best_f1_score: 0.9681; train_kl_reg_loss: 24550.1625; train_edge_recon_loss: 682593.8433; train_cat_covariates_contrastive_loss: 99692.8024; train_gene_expr_recon_loss: 1786409.0477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8410.9696; train_global_loss: 2601656.8315; train_optim_loss: 2601656.8315; val_kl_reg_loss: 24536.4420; val_edge_recon_loss: 707237.8643; val_cat_covariates_contrastive_loss: 99944.4626; val_gene_expr_recon_loss: 1793737.7327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8406.5820; val_global_loss: 2633863.0052; val_optim_loss: 2633863.0052
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9467; val_auprc_score: 0.9895; val_best_acc_score: 0.9431; val_best_f1_score: 0.9679; train_kl_reg_loss: 24350.9487; train_edge_recon_loss: 682972.6427; train_cat_covariates_contrastive_loss: 99727.2799; train_gene_expr_recon_loss: 1784611.4035; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8426.2249; train_global_loss: 2600088.4981; train_optim_loss: 2600088.4981; val_kl_reg_loss: 24434.2810; val_edge_recon_loss: 713647.3847; val_cat_covariates_contrastive_loss: 99655.2324; val_gene_expr_recon_loss: 1792250.4965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8427.9160; val_global_loss: 2638415.3919; val_optim_loss: 2638415.3919
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9466; val_auprc_score: 0.9899; val_best_acc_score: 0.9432; val_best_f1_score: 0.9680; train_kl_reg_loss: 24174.1885; train_edge_recon_loss: 684175.0444; train_cat_covariates_contrastive_loss: 99669.2112; train_gene_expr_recon_loss: 1782466.2295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8469.6800; train_global_loss: 2598954.3528; train_optim_loss: 2598954.3528; val_kl_reg_loss: 24112.8285; val_edge_recon_loss: 703953.8700; val_cat_covariates_contrastive_loss: 99613.4163; val_gene_expr_recon_loss: 1789922.4230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8514.2607; val_global_loss: 2626116.7881; val_optim_loss: 2626116.7881
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9467; val_auprc_score: 0.9896; val_best_acc_score: 0.9437; val_best_f1_score: 0.9682; train_kl_reg_loss: 23937.5453; train_edge_recon_loss: 684509.0417; train_cat_covariates_contrastive_loss: 99649.4388; train_gene_expr_recon_loss: 1780675.1294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8473.4705; train_global_loss: 2597244.6280; train_optim_loss: 2597244.6280; val_kl_reg_loss: 23981.1538; val_edge_recon_loss: 708927.4652; val_cat_covariates_contrastive_loss: 99557.2554; val_gene_expr_recon_loss: 1787986.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8517.1396; val_global_loss: 2628969.6168; val_optim_loss: 2628969.6168
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9387; val_auprc_score: 0.9883; val_best_acc_score: 0.9363; val_best_f1_score: 0.9641; train_kl_reg_loss: 23844.0384; train_edge_recon_loss: 691870.8388; train_cat_covariates_contrastive_loss: 100932.1001; train_gene_expr_recon_loss: 1699515.6801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7690.4233; train_global_loss: 2523853.0771; train_optim_loss: 2523853.0771; val_kl_reg_loss: 18355.1191; val_edge_recon_loss: 720352.1925; val_cat_covariates_contrastive_loss: 100994.8294; val_gene_expr_recon_loss: 1703236.5549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7533.6094; val_global_loss: 2550472.2007; val_optim_loss: 2550472.2007
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9423; val_auprc_score: 0.9891; val_best_acc_score: 0.9381; val_best_f1_score: 0.9650; train_kl_reg_loss: 23159.5541; train_edge_recon_loss: 688196.6430; train_cat_covariates_contrastive_loss: 100323.5459; train_gene_expr_recon_loss: 1696249.4978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7468.0759; train_global_loss: 2515397.3163; train_optim_loss: 2515397.3163; val_kl_reg_loss: 19930.5321; val_edge_recon_loss: 712841.2472; val_cat_covariates_contrastive_loss: 100390.6745; val_gene_expr_recon_loss: 1703347.0943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7495.5039; val_global_loss: 2544005.0415; val_optim_loss: 2544005.0415
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9417; val_auprc_score: 0.9891; val_best_acc_score: 0.9384; val_best_f1_score: 0.9653; train_kl_reg_loss: 22472.7738; train_edge_recon_loss: 685172.0036; train_cat_covariates_contrastive_loss: 99751.9311; train_gene_expr_recon_loss: 1691888.4223; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7453.7577; train_global_loss: 2506738.8890; train_optim_loss: 2506738.8890; val_kl_reg_loss: 20080.7931; val_edge_recon_loss: 709539.0091; val_cat_covariates_contrastive_loss: 99940.1475; val_gene_expr_recon_loss: 1685906.8209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7443.4795; val_global_loss: 2522910.2682; val_optim_loss: 2522910.2682
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9430; val_auprc_score: 0.9891; val_best_acc_score: 0.9399; val_best_f1_score: 0.9661; train_kl_reg_loss: 21717.4554; train_edge_recon_loss: 687215.0795; train_cat_covariates_contrastive_loss: 99602.8272; train_gene_expr_recon_loss: 1676429.5209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7455.2037; train_global_loss: 2492420.0893; train_optim_loss: 2492420.0893; val_kl_reg_loss: 20196.2057; val_edge_recon_loss: 709097.3509; val_cat_covariates_contrastive_loss: 99506.0159; val_gene_expr_recon_loss: 1683230.4433; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7451.0679; val_global_loss: 2519481.0234; val_optim_loss: 2519481.0234
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9426; val_auprc_score: 0.9889; val_best_acc_score: 0.9398; val_best_f1_score: 0.9660; train_kl_reg_loss: 21485.7234; train_edge_recon_loss: 684658.6964; train_cat_covariates_contrastive_loss: 99486.7294; train_gene_expr_recon_loss: 1673767.8980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7469.0978; train_global_loss: 2486868.1440; train_optim_loss: 2486868.1440; val_kl_reg_loss: 20387.3053; val_edge_recon_loss: 712788.6066; val_cat_covariates_contrastive_loss: 99510.2065; val_gene_expr_recon_loss: 1681339.6280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7450.6450; val_global_loss: 2521476.4931; val_optim_loss: 2521476.4931
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9442; val_auprc_score: 0.9893; val_best_acc_score: 0.9405; val_best_f1_score: 0.9664; train_kl_reg_loss: 21281.6171; train_edge_recon_loss: 685343.2785; train_cat_covariates_contrastive_loss: 99315.1976; train_gene_expr_recon_loss: 1671296.5165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7496.1942; train_global_loss: 2484732.8035; train_optim_loss: 2484732.8035; val_kl_reg_loss: 20545.4842; val_edge_recon_loss: 707386.6092; val_cat_covariates_contrastive_loss: 99439.8344; val_gene_expr_recon_loss: 1678312.1600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7521.9443; val_global_loss: 2513206.0917; val_optim_loss: 2513206.0917
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9452; val_auprc_score: 0.9897; val_best_acc_score: 0.9414; val_best_f1_score: 0.9669; train_kl_reg_loss: 21168.1871; train_edge_recon_loss: 685620.0701; train_cat_covariates_contrastive_loss: 99397.1551; train_gene_expr_recon_loss: 1668031.7216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7502.4645; train_global_loss: 2481719.5976; train_optim_loss: 2481719.5976; val_kl_reg_loss: 20324.6843; val_edge_recon_loss: 701549.8262; val_cat_covariates_contrastive_loss: 99299.0263; val_gene_expr_recon_loss: 1674256.2760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7531.9673; val_global_loss: 2502961.8097; val_optim_loss: 2502961.8097
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9444; val_auprc_score: 0.9894; val_best_acc_score: 0.9413; val_best_f1_score: 0.9668; train_kl_reg_loss: 20990.5805; train_edge_recon_loss: 681829.5614; train_cat_covariates_contrastive_loss: 99279.7189; train_gene_expr_recon_loss: 1665261.7083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7527.9725; train_global_loss: 2474889.5422; train_optim_loss: 2474889.5422; val_kl_reg_loss: 20501.2610; val_edge_recon_loss: 705309.1804; val_cat_covariates_contrastive_loss: 99272.5265; val_gene_expr_recon_loss: 1672745.0208; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7526.7944; val_global_loss: 2505354.7413; val_optim_loss: 2505354.7413
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9445; val_auprc_score: 0.9893; val_best_acc_score: 0.9408; val_best_f1_score: 0.9665; train_kl_reg_loss: 20892.4514; train_edge_recon_loss: 684282.7824; train_cat_covariates_contrastive_loss: 99229.3534; train_gene_expr_recon_loss: 1664068.5469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7535.3756; train_global_loss: 2476008.5089; train_optim_loss: 2476008.5089; val_kl_reg_loss: 20160.2937; val_edge_recon_loss: 706461.2428; val_cat_covariates_contrastive_loss: 99431.7825; val_gene_expr_recon_loss: 1669872.2050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7555.6426; val_global_loss: 2503481.2725; val_optim_loss: 2503481.2725
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9454; val_auprc_score: 0.9898; val_best_acc_score: 0.9408; val_best_f1_score: 0.9666; train_kl_reg_loss: 20934.3999; train_edge_recon_loss: 686594.2643; train_cat_covariates_contrastive_loss: 99252.7905; train_gene_expr_recon_loss: 1663295.5424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7536.8205; train_global_loss: 2477613.8168; train_optim_loss: 2477613.8168; val_kl_reg_loss: 20275.7921; val_edge_recon_loss: 701709.5213; val_cat_covariates_contrastive_loss: 99824.2411; val_gene_expr_recon_loss: 1671328.4252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7514.9590; val_global_loss: 2500652.9784; val_optim_loss: 2500652.9784
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9455; val_auprc_score: 0.9896; val_best_acc_score: 0.9404; val_best_f1_score: 0.9663; train_kl_reg_loss: 20770.0626; train_edge_recon_loss: 683845.7594; train_cat_covariates_contrastive_loss: 99233.2254; train_gene_expr_recon_loss: 1661816.4220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7548.0998; train_global_loss: 2473213.5719; train_optim_loss: 2473213.5719; val_kl_reg_loss: 20376.4795; val_edge_recon_loss: 709455.4114; val_cat_covariates_contrastive_loss: 98913.7295; val_gene_expr_recon_loss: 1670701.6099; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7593.4951; val_global_loss: 2507040.7292; val_optim_loss: 2507040.7292
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9474; val_auprc_score: 0.9902; val_best_acc_score: 0.9420; val_best_f1_score: 0.9672; train_kl_reg_loss: 20853.2955; train_edge_recon_loss: 683943.4483; train_cat_covariates_contrastive_loss: 99179.7248; train_gene_expr_recon_loss: 1662225.8865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7585.4878; train_global_loss: 2473787.8450; train_optim_loss: 2473787.8450; val_kl_reg_loss: 20538.6555; val_edge_recon_loss: 699249.9291; val_cat_covariates_contrastive_loss: 99207.9113; val_gene_expr_recon_loss: 1670497.5108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7539.8481; val_global_loss: 2497033.7483; val_optim_loss: 2497033.7483
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9470; val_auprc_score: 0.9897; val_best_acc_score: 0.9422; val_best_f1_score: 0.9673; train_kl_reg_loss: 20536.2158; train_edge_recon_loss: 683780.3485; train_cat_covariates_contrastive_loss: 99162.2513; train_gene_expr_recon_loss: 1660524.4613; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7578.8455; train_global_loss: 2471582.1224; train_optim_loss: 2471582.1224; val_kl_reg_loss: 20401.4897; val_edge_recon_loss: 711695.0705; val_cat_covariates_contrastive_loss: 99170.8940; val_gene_expr_recon_loss: 1669235.2362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7591.3281; val_global_loss: 2508093.9446; val_optim_loss: 2508093.9446
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9453; val_auprc_score: 0.9896; val_best_acc_score: 0.9417; val_best_f1_score: 0.9671; train_kl_reg_loss: 20464.2529; train_edge_recon_loss: 682488.9766; train_cat_covariates_contrastive_loss: 99090.9554; train_gene_expr_recon_loss: 1660039.6362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7589.9567; train_global_loss: 2469673.7758; train_optim_loss: 2469673.7758; val_kl_reg_loss: 20761.0356; val_edge_recon_loss: 704300.9773; val_cat_covariates_contrastive_loss: 98925.5114; val_gene_expr_recon_loss: 1667471.3698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7590.6157; val_global_loss: 2499049.3979; val_optim_loss: 2499049.3979
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9450; val_auprc_score: 0.9893; val_best_acc_score: 0.9414; val_best_f1_score: 0.9669; train_kl_reg_loss: 24018.3389; train_edge_recon_loss: 681210.0861; train_cat_covariates_contrastive_loss: 99091.5373; train_gene_expr_recon_loss: 1659303.1003; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7607.2606; train_global_loss: 2471230.3242; train_optim_loss: 2471230.3242; val_kl_reg_loss: 20143.7559; val_edge_recon_loss: 706948.0523; val_cat_covariates_contrastive_loss: 99006.1083; val_gene_expr_recon_loss: 1667662.5264; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7598.3931; val_global_loss: 2501358.9507; val_optim_loss: 2501358.9507
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9483; val_auprc_score: 0.9903; val_best_acc_score: 0.9422; val_best_f1_score: 0.9674; train_kl_reg_loss: 20384.4181; train_edge_recon_loss: 685237.4688; train_cat_covariates_contrastive_loss: 99171.2828; train_gene_expr_recon_loss: 1657664.0394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7606.7340; train_global_loss: 2470063.9460; train_optim_loss: 2470063.9460; val_kl_reg_loss: 20116.2335; val_edge_recon_loss: 704308.7003; val_cat_covariates_contrastive_loss: 99523.9330; val_gene_expr_recon_loss: 1665062.3819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7641.8950; val_global_loss: 2496653.2379; val_optim_loss: 2496653.2379
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9451; val_auprc_score: 0.9894; val_best_acc_score: 0.9423; val_best_f1_score: 0.9674; train_kl_reg_loss: 20338.3390; train_edge_recon_loss: 681605.1531; train_cat_covariates_contrastive_loss: 99021.4755; train_gene_expr_recon_loss: 1657510.3941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7625.6760; train_global_loss: 2466101.0350; train_optim_loss: 2466101.0350; val_kl_reg_loss: 20190.7588; val_edge_recon_loss: 705434.0548; val_cat_covariates_contrastive_loss: 98817.1610; val_gene_expr_recon_loss: 1665912.8322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7591.2812; val_global_loss: 2497946.0484; val_optim_loss: 2497946.0484
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9466; val_auprc_score: 0.9899; val_best_acc_score: 0.9425; val_best_f1_score: 0.9675; train_kl_reg_loss: 20271.9978; train_edge_recon_loss: 683162.2281; train_cat_covariates_contrastive_loss: 99015.6759; train_gene_expr_recon_loss: 1656151.2277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7616.7659; train_global_loss: 2466217.8959; train_optim_loss: 2466217.8959; val_kl_reg_loss: 20212.4047; val_edge_recon_loss: 701931.5190; val_cat_covariates_contrastive_loss: 98927.1187; val_gene_expr_recon_loss: 1666270.8227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7585.1772; val_global_loss: 2494927.1211; val_optim_loss: 2494927.1211
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9460; val_auprc_score: 0.9896; val_best_acc_score: 0.9417; val_best_f1_score: 0.9671; train_kl_reg_loss: 20200.5338; train_edge_recon_loss: 683774.4970; train_cat_covariates_contrastive_loss: 98989.6295; train_gene_expr_recon_loss: 1655803.2148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7640.0058; train_global_loss: 2466407.8764; train_optim_loss: 2466407.8764; val_kl_reg_loss: 19827.7700; val_edge_recon_loss: 708519.9602; val_cat_covariates_contrastive_loss: 99166.1673; val_gene_expr_recon_loss: 1665287.9074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7636.4316; val_global_loss: 2500438.3019; val_optim_loss: 2500438.3019
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9459; val_auprc_score: 0.9895; val_best_acc_score: 0.9427; val_best_f1_score: 0.9676; train_kl_reg_loss: 20250.5181; train_edge_recon_loss: 683143.5030; train_cat_covariates_contrastive_loss: 99047.4468; train_gene_expr_recon_loss: 1655479.8584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7653.2857; train_global_loss: 2465574.6143; train_optim_loss: 2465574.6143; val_kl_reg_loss: 20010.1159; val_edge_recon_loss: 705790.9286; val_cat_covariates_contrastive_loss: 99312.6326; val_gene_expr_recon_loss: 1663535.2971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7660.5342; val_global_loss: 2496309.4740; val_optim_loss: 2496309.4740
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9454; val_auprc_score: 0.9894; val_best_acc_score: 0.9421; val_best_f1_score: 0.9673; train_kl_reg_loss: 20151.6880; train_edge_recon_loss: 683023.4784; train_cat_covariates_contrastive_loss: 98981.8590; train_gene_expr_recon_loss: 1654337.8991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7665.3728; train_global_loss: 2464160.3014; train_optim_loss: 2464160.3014; val_kl_reg_loss: 19902.3986; val_edge_recon_loss: 707947.2008; val_cat_covariates_contrastive_loss: 98957.9662; val_gene_expr_recon_loss: 1661255.2924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7669.9546; val_global_loss: 2495732.8581; val_optim_loss: 2495732.8581
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9475; val_auprc_score: 0.9899; val_best_acc_score: 0.9425; val_best_f1_score: 0.9675; train_kl_reg_loss: 20045.4112; train_edge_recon_loss: 683253.4564; train_cat_covariates_contrastive_loss: 98971.9184; train_gene_expr_recon_loss: 1653117.5463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7674.6892; train_global_loss: 2463063.0226; train_optim_loss: 2463063.0226; val_kl_reg_loss: 19847.8219; val_edge_recon_loss: 712961.5917; val_cat_covariates_contrastive_loss: 98870.1040; val_gene_expr_recon_loss: 1660609.6864; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7679.3472; val_global_loss: 2499968.4645; val_optim_loss: 2499968.4645

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9450; val_auprc_score: 0.9895; val_best_acc_score: 0.9419; val_best_f1_score: 0.9672; train_kl_reg_loss: 19931.1524; train_edge_recon_loss: 680771.2268; train_cat_covariates_contrastive_loss: 99008.0173; train_gene_expr_recon_loss: 1648136.9632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6875.9601; train_global_loss: 2454723.3240; train_optim_loss: 2454723.3240; val_kl_reg_loss: 19864.8801; val_edge_recon_loss: 705487.6340; val_cat_covariates_contrastive_loss: 98938.4148; val_gene_expr_recon_loss: 1658803.5311; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6851.6992; val_global_loss: 2489946.2154; val_optim_loss: 2489946.2154
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9458; val_auprc_score: 0.9896; val_best_acc_score: 0.9421; val_best_f1_score: 0.9673; train_kl_reg_loss: 19925.8868; train_edge_recon_loss: 682492.8374; train_cat_covariates_contrastive_loss: 98911.4409; train_gene_expr_recon_loss: 1647784.0306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6865.6280; train_global_loss: 2455979.8245; train_optim_loss: 2455979.8245; val_kl_reg_loss: 19812.9861; val_edge_recon_loss: 705386.6553; val_cat_covariates_contrastive_loss: 98880.0701; val_gene_expr_recon_loss: 1658756.5649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6881.0850; val_global_loss: 2489717.2725; val_optim_loss: 2489717.2725
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9454; val_auprc_score: 0.9897; val_best_acc_score: 0.9422; val_best_f1_score: 0.9674; train_kl_reg_loss: 19921.7161; train_edge_recon_loss: 682349.9495; train_cat_covariates_contrastive_loss: 98987.6666; train_gene_expr_recon_loss: 1646695.7156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6867.8445; train_global_loss: 2454822.8915; train_optim_loss: 2454822.8915; val_kl_reg_loss: 19825.5508; val_edge_recon_loss: 701321.7126; val_cat_covariates_contrastive_loss: 98823.2426; val_gene_expr_recon_loss: 1655926.7760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6874.0132; val_global_loss: 2482771.2837; val_optim_loss: 2482771.2837
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9454; val_auprc_score: 0.9895; val_best_acc_score: 0.9412; val_best_f1_score: 0.9668; train_kl_reg_loss: 19921.1623; train_edge_recon_loss: 683197.9232; train_cat_covariates_contrastive_loss: 98994.2400; train_gene_expr_recon_loss: 1646661.8644; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6867.4862; train_global_loss: 2455642.6740; train_optim_loss: 2455642.6740; val_kl_reg_loss: 19804.4120; val_edge_recon_loss: 712039.1200; val_cat_covariates_contrastive_loss: 98958.3517; val_gene_expr_recon_loss: 1657271.9888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6853.3071; val_global_loss: 2494927.1237; val_optim_loss: 2494927.1237
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9453; val_auprc_score: 0.9895; val_best_acc_score: 0.9415; val_best_f1_score: 0.9670; train_kl_reg_loss: 19913.5230; train_edge_recon_loss: 681759.5728; train_cat_covariates_contrastive_loss: 98958.5462; train_gene_expr_recon_loss: 1647424.6106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6860.5016; train_global_loss: 2454916.7523; train_optim_loss: 2454916.7523; val_kl_reg_loss: 19810.0122; val_edge_recon_loss: 709822.2858; val_cat_covariates_contrastive_loss: 99019.1793; val_gene_expr_recon_loss: 1654416.7076; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6855.8369; val_global_loss: 2489923.9360; val_optim_loss: 2489923.9360
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9457; val_auprc_score: 0.9896; val_best_acc_score: 0.9430; val_best_f1_score: 0.9678; train_kl_reg_loss: 19950.0359; train_edge_recon_loss: 682697.2426; train_cat_covariates_contrastive_loss: 98963.9120; train_gene_expr_recon_loss: 1646868.5965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6861.7102; train_global_loss: 2455341.4999; train_optim_loss: 2455341.4999; val_kl_reg_loss: 19805.3190; val_edge_recon_loss: 700154.4004; val_cat_covariates_contrastive_loss: 99051.7229; val_gene_expr_recon_loss: 1657662.4048; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6861.3115; val_global_loss: 2483535.0952; val_optim_loss: 2483535.0952
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9463; val_auprc_score: 0.9897; val_best_acc_score: 0.9422; val_best_f1_score: 0.9673; train_kl_reg_loss: 19931.7261; train_edge_recon_loss: 681712.0798; train_cat_covariates_contrastive_loss: 98928.5976; train_gene_expr_recon_loss: 1646470.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6866.8633; train_global_loss: 2453909.9036; train_optim_loss: 2453909.9036; val_kl_reg_loss: 19801.2786; val_edge_recon_loss: 710524.1358; val_cat_covariates_contrastive_loss: 99233.5665; val_gene_expr_recon_loss: 1660206.9200; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6867.2134; val_global_loss: 2496633.1540; val_optim_loss: 2496633.1540

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9448; val_auprc_score: 0.9892; val_best_acc_score: 0.9421; val_best_f1_score: 0.9673; train_kl_reg_loss: 19901.0306; train_edge_recon_loss: 680973.0705; train_cat_covariates_contrastive_loss: 98906.7988; train_gene_expr_recon_loss: 1646188.0267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6777.0184; train_global_loss: 2452745.9433; train_optim_loss: 2452745.9433; val_kl_reg_loss: 19803.5212; val_edge_recon_loss: 709217.7299; val_cat_covariates_contrastive_loss: 98884.4537; val_gene_expr_recon_loss: 1655520.2158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6772.7949; val_global_loss: 2490198.6721; val_optim_loss: 2490198.6721
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9469; val_auprc_score: 0.9898; val_best_acc_score: 0.9427; val_best_f1_score: 0.9677; train_kl_reg_loss: 19911.1120; train_edge_recon_loss: 683207.5644; train_cat_covariates_contrastive_loss: 98979.9067; train_gene_expr_recon_loss: 1645962.3541; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6772.3642; train_global_loss: 2454833.3010; train_optim_loss: 2454833.3010; val_kl_reg_loss: 19819.1094; val_edge_recon_loss: 703519.0175; val_cat_covariates_contrastive_loss: 98982.2876; val_gene_expr_recon_loss: 1655649.5740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6773.2354; val_global_loss: 2484743.2353; val_optim_loss: 2484743.2353
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9481; val_auprc_score: 0.9902; val_best_acc_score: 0.9423; val_best_f1_score: 0.9674; train_kl_reg_loss: 19905.7471; train_edge_recon_loss: 681969.4435; train_cat_covariates_contrastive_loss: 98932.6005; train_gene_expr_recon_loss: 1645565.2844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6773.1914; train_global_loss: 2453146.2670; train_optim_loss: 2453146.2670; val_kl_reg_loss: 19804.0153; val_edge_recon_loss: 704025.9388; val_cat_covariates_contrastive_loss: 99055.8884; val_gene_expr_recon_loss: 1656791.2171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6774.6567; val_global_loss: 2486451.8080; val_optim_loss: 2486451.8080
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9462; val_auprc_score: 0.9896; val_best_acc_score: 0.9425; val_best_f1_score: 0.9675; train_kl_reg_loss: 19913.0913; train_edge_recon_loss: 680150.0098; train_cat_covariates_contrastive_loss: 98941.7082; train_gene_expr_recon_loss: 1646537.8095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6774.4764; train_global_loss: 2452317.0939; train_optim_loss: 2452317.0939; val_kl_reg_loss: 19843.8466; val_edge_recon_loss: 701063.6184; val_cat_covariates_contrastive_loss: 98979.1547; val_gene_expr_recon_loss: 1657824.3646; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6774.4487; val_global_loss: 2484485.4775; val_optim_loss: 2484485.4775

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1095 min 3 sec.
Using best model state, which was in epoch 50.

--- MODEL EVALUATION ---
val AUROC score: 0.9379
val AUPRC score: 0.9858
val best accuracy score: 0.9413
val best F1 score: 0.9669
val target rna MSE score: 0.4494
val source rna MSE score: 0.1283
Val cat covariate0 mean sim diff: -0.0010
Val cat covariate1 mean sim diff: -0.0671
Val cat covariate2 mean sim diff: -0.0006

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
