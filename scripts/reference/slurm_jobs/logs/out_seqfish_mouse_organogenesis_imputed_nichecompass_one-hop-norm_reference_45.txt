[True]
Run timestamp: 26072023_215314_45.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_45']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8667; val_auprc_score: 0.9725; val_best_acc_score: 0.8515; val_best_f1_score: 0.9198; train_kl_reg_loss: 408191.6104; train_edge_recon_loss: 117125.5009; train_gene_expr_recon_loss: 177741302.2512; train_masked_gp_l1_reg_loss: 8322.5455; train_group_lasso_reg_loss: 0.0000; train_global_loss: 178274943.1070; train_optim_loss: 178274943.1070; val_kl_reg_loss: 72864.6868; val_edge_recon_loss: 120692.8805; val_gene_expr_recon_loss: 186608432.6667; val_masked_gp_l1_reg_loss: 9746.3730; val_group_lasso_reg_loss: 0.0000; val_global_loss: 186811733.3333; val_optim_loss: 186811733.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8339; val_auprc_score: 0.9651; val_best_acc_score: 0.8556; val_best_f1_score: 0.9220; train_kl_reg_loss: 223174.1398; train_edge_recon_loss: 119199.2293; train_gene_expr_recon_loss: 143984747.9814; train_masked_gp_l1_reg_loss: 10081.3261; train_group_lasso_reg_loss: 0.0000; train_global_loss: 144337202.9023; train_optim_loss: 144337202.9023; val_kl_reg_loss: 235214.8574; val_edge_recon_loss: 119001.8952; val_gene_expr_recon_loss: 137083612.0000; val_masked_gp_l1_reg_loss: 10148.0342; val_group_lasso_reg_loss: 0.0000; val_global_loss: 137447972.6667; val_optim_loss: 137447972.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8398; val_auprc_score: 0.9659; val_best_acc_score: 0.8712; val_best_f1_score: 0.9275; train_kl_reg_loss: 242987.2560; train_edge_recon_loss: 118783.6619; train_gene_expr_recon_loss: 134676405.0233; train_masked_gp_l1_reg_loss: 10289.1312; train_group_lasso_reg_loss: 0.0000; train_global_loss: 135048464.8558; train_optim_loss: 135048464.8558; val_kl_reg_loss: 233357.9245; val_edge_recon_loss: 119711.2565; val_gene_expr_recon_loss: 132430011.6667; val_masked_gp_l1_reg_loss: 10457.0098; val_group_lasso_reg_loss: 0.0000; val_global_loss: 132793538.6667; val_optim_loss: 132793538.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8473; val_auprc_score: 0.9679; val_best_acc_score: 0.8819; val_best_f1_score: 0.9349; train_kl_reg_loss: 242993.3333; train_edge_recon_loss: 117811.1023; train_gene_expr_recon_loss: 130338738.0837; train_masked_gp_l1_reg_loss: 10654.6652; train_group_lasso_reg_loss: 0.0000; train_global_loss: 130710197.0233; train_optim_loss: 130710197.0233; val_kl_reg_loss: 235420.5651; val_edge_recon_loss: 116158.3307; val_gene_expr_recon_loss: 128408016.3333; val_masked_gp_l1_reg_loss: 10860.1025; val_group_lasso_reg_loss: 0.0000; val_global_loss: 128770458.6667; val_optim_loss: 128770458.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8467; val_auprc_score: 0.9667; val_best_acc_score: 0.8805; val_best_f1_score: 0.9337; train_kl_reg_loss: 240399.8120; train_edge_recon_loss: 118322.6605; train_gene_expr_recon_loss: 126854759.2930; train_masked_gp_l1_reg_loss: 11055.4526; train_group_lasso_reg_loss: 0.0000; train_global_loss: 127224537.6000; train_optim_loss: 127224537.6000; val_kl_reg_loss: 226855.4297; val_edge_recon_loss: 116892.7240; val_gene_expr_recon_loss: 124798372.3333; val_masked_gp_l1_reg_loss: 11259.8418; val_group_lasso_reg_loss: 0.0000; val_global_loss: 125153376.3333; val_optim_loss: 125153376.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8633; val_auprc_score: 0.9706; val_best_acc_score: 0.8768; val_best_f1_score: 0.9318; train_kl_reg_loss: 235372.9698; train_edge_recon_loss: 118313.0973; train_gene_expr_recon_loss: 123726034.0093; train_masked_gp_l1_reg_loss: 11450.1562; train_group_lasso_reg_loss: 0.0000; train_global_loss: 124091170.6047; train_optim_loss: 124091170.6047; val_kl_reg_loss: 225698.9134; val_edge_recon_loss: 119795.0876; val_gene_expr_recon_loss: 122402698.0000; val_masked_gp_l1_reg_loss: 11639.8535; val_group_lasso_reg_loss: 0.0000; val_global_loss: 122759831.6667; val_optim_loss: 122759831.6667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8729; val_auprc_score: 0.9724; val_best_acc_score: 0.8796; val_best_f1_score: 0.9335; train_kl_reg_loss: 234407.1713; train_edge_recon_loss: 117400.7202; train_gene_expr_recon_loss: 121316767.7395; train_masked_gp_l1_reg_loss: 11815.4662; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121680390.9581; train_optim_loss: 121680390.9581; val_kl_reg_loss: 224235.4414; val_edge_recon_loss: 117779.9808; val_gene_expr_recon_loss: 120202677.3333; val_masked_gp_l1_reg_loss: 11985.8223; val_group_lasso_reg_loss: 0.0000; val_global_loss: 120556676.0000; val_optim_loss: 120556676.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8735; val_auprc_score: 0.9715; val_best_acc_score: 0.8840; val_best_f1_score: 0.9357; train_kl_reg_loss: 231709.9791; train_edge_recon_loss: 117604.6398; train_gene_expr_recon_loss: 119229203.0140; train_masked_gp_l1_reg_loss: 12132.9019; train_group_lasso_reg_loss: 0.0000; train_global_loss: 119590650.4558; train_optim_loss: 119590650.4558; val_kl_reg_loss: 221976.3392; val_edge_recon_loss: 117464.3337; val_gene_expr_recon_loss: 118256797.3333; val_masked_gp_l1_reg_loss: 12272.6289; val_group_lasso_reg_loss: 0.0000; val_global_loss: 118608510.3333; val_optim_loss: 118608510.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8825; val_auprc_score: 0.9750; val_best_acc_score: 0.8845; val_best_f1_score: 0.9355; train_kl_reg_loss: 225163.5015; train_edge_recon_loss: 116890.4987; train_gene_expr_recon_loss: 117390471.5535; train_masked_gp_l1_reg_loss: 12406.2479; train_group_lasso_reg_loss: 0.0000; train_global_loss: 117744931.9442; train_optim_loss: 117744931.9442; val_kl_reg_loss: 212334.5729; val_edge_recon_loss: 114825.7865; val_gene_expr_recon_loss: 116455131.0000; val_masked_gp_l1_reg_loss: 12528.4863; val_group_lasso_reg_loss: 0.0000; val_global_loss: 116794819.3333; val_optim_loss: 116794819.3333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8876; val_auprc_score: 0.9765; val_best_acc_score: 0.8864; val_best_f1_score: 0.9361; train_kl_reg_loss: 216054.6342; train_edge_recon_loss: 116053.4930; train_gene_expr_recon_loss: 115664256.1488; train_masked_gp_l1_reg_loss: 12650.4478; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116009014.4744; train_optim_loss: 116009014.4744; val_kl_reg_loss: 202874.9525; val_edge_recon_loss: 115847.5749; val_gene_expr_recon_loss: 114802315.0000; val_masked_gp_l1_reg_loss: 12779.9434; val_group_lasso_reg_loss: 0.0000; val_global_loss: 115133813.0000; val_optim_loss: 115133813.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8967; val_auprc_score: 0.9785; val_best_acc_score: 0.8848; val_best_f1_score: 0.9355; train_kl_reg_loss: 206305.1709; train_edge_recon_loss: 115678.6142; train_gene_expr_recon_loss: 114064097.9721; train_masked_gp_l1_reg_loss: 12901.8484; train_group_lasso_reg_loss: 0.0000; train_global_loss: 114398983.9256; train_optim_loss: 114398983.9256; val_kl_reg_loss: 193718.8158; val_edge_recon_loss: 117696.9577; val_gene_expr_recon_loss: 113339760.0000; val_masked_gp_l1_reg_loss: 13024.7119; val_group_lasso_reg_loss: 0.0000; val_global_loss: 113664199.3333; val_optim_loss: 113664199.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8949; val_auprc_score: 0.9774; val_best_acc_score: 0.8847; val_best_f1_score: 0.9333; train_kl_reg_loss: 196840.7648; train_edge_recon_loss: 116319.6964; train_gene_expr_recon_loss: 112615368.7442; train_masked_gp_l1_reg_loss: 13146.0946; train_group_lasso_reg_loss: 0.0000; train_global_loss: 112941675.4977; train_optim_loss: 112941675.4977; val_kl_reg_loss: 185094.8496; val_edge_recon_loss: 121227.9694; val_gene_expr_recon_loss: 111976765.6667; val_masked_gp_l1_reg_loss: 13265.6445; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112296352.3333; val_optim_loss: 112296352.3333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8966; val_auprc_score: 0.9779; val_best_acc_score: 0.8862; val_best_f1_score: 0.9347; train_kl_reg_loss: 187161.3469; train_edge_recon_loss: 117168.7899; train_gene_expr_recon_loss: 111239838.7349; train_masked_gp_l1_reg_loss: 13383.9327; train_group_lasso_reg_loss: 0.0000; train_global_loss: 111557552.8558; train_optim_loss: 111557552.8558; val_kl_reg_loss: 175137.2962; val_edge_recon_loss: 115982.0244; val_gene_expr_recon_loss: 110443705.3333; val_masked_gp_l1_reg_loss: 13502.9668; val_group_lasso_reg_loss: 0.0000; val_global_loss: 110748328.3333; val_optim_loss: 110748328.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9069; val_auprc_score: 0.9809; val_best_acc_score: 0.8931; val_best_f1_score: 0.9395; train_kl_reg_loss: 177997.3426; train_edge_recon_loss: 116647.0638; train_gene_expr_recon_loss: 109946223.0698; train_masked_gp_l1_reg_loss: 13622.7359; train_group_lasso_reg_loss: 0.0000; train_global_loss: 110254490.2326; train_optim_loss: 110254490.2326; val_kl_reg_loss: 165138.5241; val_edge_recon_loss: 114185.1393; val_gene_expr_recon_loss: 109285518.0000; val_masked_gp_l1_reg_loss: 13745.5078; val_group_lasso_reg_loss: 0.0000; val_global_loss: 109578585.6667; val_optim_loss: 109578585.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9030; val_auprc_score: 0.9792; val_best_acc_score: 0.8950; val_best_f1_score: 0.9386; train_kl_reg_loss: 168276.5569; train_edge_recon_loss: 116668.6833; train_gene_expr_recon_loss: 109221424.0372; train_masked_gp_l1_reg_loss: 13878.2897; train_group_lasso_reg_loss: 0.0000; train_global_loss: 109520248.0000; train_optim_loss: 109520248.0000; val_kl_reg_loss: 159681.6217; val_edge_recon_loss: 115944.8789; val_gene_expr_recon_loss: 108293706.0000; val_masked_gp_l1_reg_loss: 13999.8291; val_group_lasso_reg_loss: 0.0000; val_global_loss: 108583331.3333; val_optim_loss: 108583331.3333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9119; val_auprc_score: 0.9819; val_best_acc_score: 0.8948; val_best_f1_score: 0.9399; train_kl_reg_loss: 163042.2181; train_edge_recon_loss: 115922.8059; train_gene_expr_recon_loss: 107845940.8000; train_masked_gp_l1_reg_loss: 14099.8732; train_group_lasso_reg_loss: 0.0000; train_global_loss: 108139005.9163; train_optim_loss: 108139005.9163; val_kl_reg_loss: 154433.9473; val_edge_recon_loss: 113841.5212; val_gene_expr_recon_loss: 107192753.3333; val_masked_gp_l1_reg_loss: 14201.0820; val_group_lasso_reg_loss: 0.0000; val_global_loss: 107475229.3333; val_optim_loss: 107475229.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9216; val_auprc_score: 0.9847; val_best_acc_score: 0.9006; val_best_f1_score: 0.9438; train_kl_reg_loss: 156353.1323; train_edge_recon_loss: 114777.0571; train_gene_expr_recon_loss: 106768695.4419; train_masked_gp_l1_reg_loss: 14305.5603; train_group_lasso_reg_loss: 0.0000; train_global_loss: 107054131.1256; train_optim_loss: 107054131.1256; val_kl_reg_loss: 146468.3099; val_edge_recon_loss: 114002.7959; val_gene_expr_recon_loss: 106327944.6667; val_masked_gp_l1_reg_loss: 14408.7559; val_group_lasso_reg_loss: 0.0000; val_global_loss: 106602824.0000; val_optim_loss: 106602824.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9164; val_auprc_score: 0.9833; val_best_acc_score: 0.9010; val_best_f1_score: 0.9438; train_kl_reg_loss: 148617.4837; train_edge_recon_loss: 115744.6653; train_gene_expr_recon_loss: 105745094.2512; train_masked_gp_l1_reg_loss: 14511.6559; train_group_lasso_reg_loss: 0.0000; train_global_loss: 106023968.0744; train_optim_loss: 106023968.0744; val_kl_reg_loss: 138827.1348; val_edge_recon_loss: 114771.6221; val_gene_expr_recon_loss: 105253863.6667; val_masked_gp_l1_reg_loss: 14611.0664; val_group_lasso_reg_loss: 0.0000; val_global_loss: 105522069.6667; val_optim_loss: 105522069.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9226; val_auprc_score: 0.9839; val_best_acc_score: 0.9073; val_best_f1_score: 0.9472; train_kl_reg_loss: 140838.0820; train_edge_recon_loss: 114540.9570; train_gene_expr_recon_loss: 104727511.8884; train_masked_gp_l1_reg_loss: 14721.9588; train_group_lasso_reg_loss: 0.0000; train_global_loss: 104997612.7628; train_optim_loss: 104997612.7628; val_kl_reg_loss: 133039.7083; val_edge_recon_loss: 110960.4170; val_gene_expr_recon_loss: 104308739.0000; val_masked_gp_l1_reg_loss: 14818.3574; val_group_lasso_reg_loss: 0.0000; val_global_loss: 104567556.0000; val_optim_loss: 104567556.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9200; val_auprc_score: 0.9840; val_best_acc_score: 0.9024; val_best_f1_score: 0.9444; train_kl_reg_loss: 134147.5488; train_edge_recon_loss: 117666.1437; train_gene_expr_recon_loss: 103803565.3209; train_masked_gp_l1_reg_loss: 14922.9195; train_group_lasso_reg_loss: 0.0000; train_global_loss: 104070302.1023; train_optim_loss: 104070302.1023; val_kl_reg_loss: 125180.4053; val_edge_recon_loss: 111139.8070; val_gene_expr_recon_loss: 103286904.0000; val_masked_gp_l1_reg_loss: 15025.5098; val_group_lasso_reg_loss: 0.0000; val_global_loss: 103538247.6667; val_optim_loss: 103538247.6667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8886; val_auprc_score: 0.9794; val_best_acc_score: 0.8676; val_best_f1_score: 0.9277; train_kl_reg_loss: 127571.8765; train_edge_recon_loss: 115696.3177; train_gene_expr_recon_loss: 175379211.3860; train_masked_gp_l1_reg_loss: 15741.0473; train_group_lasso_reg_loss: 0.0000; train_global_loss: 175638219.9442; train_optim_loss: 175638219.9442; val_kl_reg_loss: 85289.4906; val_edge_recon_loss: 114828.6758; val_gene_expr_recon_loss: 238535596.0000; val_masked_gp_l1_reg_loss: 17471.9805; val_group_lasso_reg_loss: 0.0000; val_global_loss: 238753185.3333; val_optim_loss: 238753185.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8891; val_auprc_score: 0.9763; val_best_acc_score: 0.8774; val_best_f1_score: 0.9314; train_kl_reg_loss: 91845.9389; train_edge_recon_loss: 117678.7539; train_gene_expr_recon_loss: 234421506.6047; train_masked_gp_l1_reg_loss: 17652.1845; train_group_lasso_reg_loss: 0.0000; train_global_loss: 234648683.9814; train_optim_loss: 234648683.9814; val_kl_reg_loss: 91073.8314; val_edge_recon_loss: 118032.0990; val_gene_expr_recon_loss: 231712670.6667; val_masked_gp_l1_reg_loss: 17736.1953; val_group_lasso_reg_loss: 0.0000; val_global_loss: 231939520.0000; val_optim_loss: 231939520.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9019; val_auprc_score: 0.9801; val_best_acc_score: 0.8873; val_best_f1_score: 0.9356; train_kl_reg_loss: 95057.9687; train_edge_recon_loss: 115286.9594; train_gene_expr_recon_loss: 229729780.5395; train_masked_gp_l1_reg_loss: 17790.9344; train_group_lasso_reg_loss: 0.0000; train_global_loss: 229957916.8744; train_optim_loss: 229957916.8744; val_kl_reg_loss: 92564.8415; val_edge_recon_loss: 115425.4258; val_gene_expr_recon_loss: 227909075.3333; val_masked_gp_l1_reg_loss: 17842.5449; val_group_lasso_reg_loss: 0.0000; val_global_loss: 228134904.6667; val_optim_loss: 228134904.6667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9042; val_auprc_score: 0.9800; val_best_acc_score: 0.8906; val_best_f1_score: 0.9370; train_kl_reg_loss: 96071.2163; train_edge_recon_loss: 115699.0105; train_gene_expr_recon_loss: 226473574.3256; train_masked_gp_l1_reg_loss: 17864.4739; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226703209.0791; train_optim_loss: 226703209.0791; val_kl_reg_loss: 92764.9258; val_edge_recon_loss: 116834.2389; val_gene_expr_recon_loss: 224898628.6667; val_masked_gp_l1_reg_loss: 17903.8008; val_group_lasso_reg_loss: 0.0000; val_global_loss: 225126132.6667; val_optim_loss: 225126132.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9036; val_auprc_score: 0.9804; val_best_acc_score: 0.8932; val_best_f1_score: 0.9386; train_kl_reg_loss: 96264.5273; train_edge_recon_loss: 115790.6410; train_gene_expr_recon_loss: 224723218.4558; train_masked_gp_l1_reg_loss: 17881.6329; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224953157.3581; train_optim_loss: 224953157.3581; val_kl_reg_loss: 92935.8851; val_edge_recon_loss: 114609.2757; val_gene_expr_recon_loss: 224739113.3333; val_masked_gp_l1_reg_loss: 17865.2656; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224964531.3333; val_optim_loss: 224964531.3333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8982; val_auprc_score: 0.9787; val_best_acc_score: 0.8883; val_best_f1_score: 0.9358; train_kl_reg_loss: 96185.9662; train_edge_recon_loss: 115073.7544; train_gene_expr_recon_loss: 224451925.8791; train_masked_gp_l1_reg_loss: 17864.0513; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224681051.5349; train_optim_loss: 224681051.5349; val_kl_reg_loss: 92906.1849; val_edge_recon_loss: 116777.9359; val_gene_expr_recon_loss: 224307995.3333; val_masked_gp_l1_reg_loss: 17863.7090; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224535536.0000; val_optim_loss: 224535536.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9071; val_auprc_score: 0.9812; val_best_acc_score: 0.8911; val_best_f1_score: 0.9374; train_kl_reg_loss: 96157.6351; train_edge_recon_loss: 115856.0635; train_gene_expr_recon_loss: 224284650.4186; train_masked_gp_l1_reg_loss: 17864.2432; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224514530.5302; train_optim_loss: 224514530.5302; val_kl_reg_loss: 92754.6702; val_edge_recon_loss: 114557.9430; val_gene_expr_recon_loss: 224119845.3333; val_masked_gp_l1_reg_loss: 17865.8574; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224345031.3333; val_optim_loss: 224345031.3333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9024; val_auprc_score: 0.9785; val_best_acc_score: 0.8907; val_best_f1_score: 0.9369; train_kl_reg_loss: 96145.2714; train_edge_recon_loss: 114573.2912; train_gene_expr_recon_loss: 224007911.4419; train_masked_gp_l1_reg_loss: 17866.7547; train_group_lasso_reg_loss: 0.0000; train_global_loss: 224236502.5488; train_optim_loss: 224236502.5488; val_kl_reg_loss: 92799.7318; val_edge_recon_loss: 118113.0635; val_gene_expr_recon_loss: 224078720.6667; val_masked_gp_l1_reg_loss: 17868.6211; val_group_lasso_reg_loss: 0.0000; val_global_loss: 224307506.6667; val_optim_loss: 224307506.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 29 min 23 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9191
Val AUPRC score: 0.9834
Val best accuracy score: 0.9033
Val best F1 score: 0.9446
Val gene expr MSE score: 10649.0766
Val cat covariate0 mean sim diff: -0.0009

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
