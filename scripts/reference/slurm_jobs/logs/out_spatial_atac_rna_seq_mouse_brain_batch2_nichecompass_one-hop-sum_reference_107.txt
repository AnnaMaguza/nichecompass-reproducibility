[True]
Run timestamp: 10082023_235833_107.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_107']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6986; val_auprc_score: 0.7400; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 118180.8655; train_edge_recon_loss: 3830967.4351; train_gene_expr_recon_loss: 46036465.9237; train_masked_gp_l1_reg_loss: 82470.7142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 247361.7592; train_chrom_access_recon_loss: 6889979.5115; train_global_loss: 57205426.1985; train_optim_loss: 57205426.1985; val_kl_reg_loss: 219224.1240; val_edge_recon_loss: 4065739.3000; val_gene_expr_recon_loss: 39296192.8000; val_masked_gp_l1_reg_loss: 84006.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 243315.4375; val_chrom_access_recon_loss: 6534804.2333; val_global_loss: 50443284.8000; val_optim_loss: 50443284.8000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7628; val_auprc_score: 0.7806; val_best_acc_score: 0.6624; val_best_f1_score: 0.7172; train_kl_reg_loss: 204183.0395; train_edge_recon_loss: 3654129.1660; train_gene_expr_recon_loss: 38051572.9160; train_masked_gp_l1_reg_loss: 79113.3838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 237028.9692; train_chrom_access_recon_loss: 6405486.9924; train_global_loss: 48631514.3511; train_optim_loss: 48631514.3511; val_kl_reg_loss: 244727.8344; val_edge_recon_loss: 4051505.9333; val_gene_expr_recon_loss: 37270614.6667; val_masked_gp_l1_reg_loss: 77139.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 230437.9375; val_chrom_access_recon_loss: 6363257.6333; val_global_loss: 48237682.1333; val_optim_loss: 48237682.1333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8569; val_auprc_score: 0.8583; val_best_acc_score: 0.7452; val_best_f1_score: 0.7666; train_kl_reg_loss: 195640.1535; train_edge_recon_loss: 3571906.7748; train_gene_expr_recon_loss: 37086133.4962; train_masked_gp_l1_reg_loss: 75751.0165; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 223959.5410; train_chrom_access_recon_loss: 6324191.3092; train_global_loss: 47477582.5038; train_optim_loss: 47477582.5038; val_kl_reg_loss: 192779.4229; val_edge_recon_loss: 3975732.9833; val_gene_expr_recon_loss: 36952838.6667; val_masked_gp_l1_reg_loss: 75907.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 217493.0625; val_chrom_access_recon_loss: 6325998.3333; val_global_loss: 47740749.6000; val_optim_loss: 47740749.6000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9003; val_auprc_score: 0.8876; val_best_acc_score: 0.8226; val_best_f1_score: 0.8332; train_kl_reg_loss: 164468.8291; train_edge_recon_loss: 3500089.3378; train_gene_expr_recon_loss: 36694985.4656; train_masked_gp_l1_reg_loss: 77256.3729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 211323.9018; train_chrom_access_recon_loss: 6283872.3015; train_global_loss: 46931995.8168; train_optim_loss: 46931995.8168; val_kl_reg_loss: 148018.9073; val_edge_recon_loss: 3552319.9000; val_gene_expr_recon_loss: 36657363.7333; val_masked_gp_l1_reg_loss: 78707.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 205211.5469; val_chrom_access_recon_loss: 6332397.1333; val_global_loss: 46974018.9333; val_optim_loss: 46974018.9333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8986; val_auprc_score: 0.8893; val_best_acc_score: 0.8091; val_best_f1_score: 0.8208; train_kl_reg_loss: 173274.7644; train_edge_recon_loss: 3160330.9828; train_gene_expr_recon_loss: 36419520.8855; train_masked_gp_l1_reg_loss: 80845.9856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 199516.2263; train_chrom_access_recon_loss: 6249504.9962; train_global_loss: 46282993.9237; train_optim_loss: 46282993.9237; val_kl_reg_loss: 190140.3354; val_edge_recon_loss: 3061639.5500; val_gene_expr_recon_loss: 36550408.0000; val_masked_gp_l1_reg_loss: 82969.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 193984.9062; val_chrom_access_recon_loss: 6321912.3333; val_global_loss: 46401052.8000; val_optim_loss: 46401052.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9060; val_auprc_score: 0.8910; val_best_acc_score: 0.8246; val_best_f1_score: 0.8376; train_kl_reg_loss: 192236.4227; train_edge_recon_loss: 3004360.0763; train_gene_expr_recon_loss: 36153992.4580; train_masked_gp_l1_reg_loss: 83568.4266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 188926.4247; train_chrom_access_recon_loss: 6217369.6908; train_global_loss: 45840453.8321; train_optim_loss: 45840453.8321; val_kl_reg_loss: 184024.6229; val_edge_recon_loss: 2981632.4333; val_gene_expr_recon_loss: 36237582.6667; val_masked_gp_l1_reg_loss: 84632.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 184126.4062; val_chrom_access_recon_loss: 6268560.1333; val_global_loss: 45940558.9333; val_optim_loss: 45940558.9333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9126; val_auprc_score: 0.9008; val_best_acc_score: 0.8333; val_best_f1_score: 0.8458; train_kl_reg_loss: 182291.4727; train_edge_recon_loss: 2950651.4962; train_gene_expr_recon_loss: 35905946.9924; train_masked_gp_l1_reg_loss: 85805.2403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 179688.0816; train_chrom_access_recon_loss: 6190381.3130; train_global_loss: 45494764.3664; train_optim_loss: 45494764.3664; val_kl_reg_loss: 173934.0646; val_edge_recon_loss: 2947111.8167; val_gene_expr_recon_loss: 35863028.2667; val_masked_gp_l1_reg_loss: 87193.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175264.3125; val_chrom_access_recon_loss: 6222526.3333; val_global_loss: 45469055.7333; val_optim_loss: 45469055.7333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9107; val_auprc_score: 0.8948; val_best_acc_score: 0.8336; val_best_f1_score: 0.8460; train_kl_reg_loss: 180897.8717; train_edge_recon_loss: 2929371.0840; train_gene_expr_recon_loss: 35740447.9389; train_masked_gp_l1_reg_loss: 88308.1034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171097.1885; train_chrom_access_recon_loss: 6170269.4580; train_global_loss: 45280391.5420; train_optim_loss: 45280391.5420; val_kl_reg_loss: 177268.5135; val_edge_recon_loss: 2943959.8167; val_gene_expr_recon_loss: 35783294.1333; val_masked_gp_l1_reg_loss: 89600.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 166958.8125; val_chrom_access_recon_loss: 6212508.7000; val_global_loss: 45373590.4000; val_optim_loss: 45373590.4000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9237; val_auprc_score: 0.9124; val_best_acc_score: 0.8480; val_best_f1_score: 0.8605; train_kl_reg_loss: 173733.0073; train_edge_recon_loss: 2911420.2080; train_gene_expr_recon_loss: 35590964.0305; train_masked_gp_l1_reg_loss: 90460.2459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 162960.0104; train_chrom_access_recon_loss: 6155565.1298; train_global_loss: 45085102.6870; train_optim_loss: 45085102.6870; val_kl_reg_loss: 171135.4000; val_edge_recon_loss: 2888596.9833; val_gene_expr_recon_loss: 35543406.9333; val_masked_gp_l1_reg_loss: 91446.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158979.8594; val_chrom_access_recon_loss: 6186755.8333; val_global_loss: 45040323.7333; val_optim_loss: 45040323.7333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9284; val_auprc_score: 0.9159; val_best_acc_score: 0.8538; val_best_f1_score: 0.8638; train_kl_reg_loss: 166973.2015; train_edge_recon_loss: 2899006.1202; train_gene_expr_recon_loss: 35464781.7099; train_masked_gp_l1_reg_loss: 93459.2542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155229.2210; train_chrom_access_recon_loss: 6133501.7519; train_global_loss: 44912951.2061; train_optim_loss: 44912951.2061; val_kl_reg_loss: 168382.2833; val_edge_recon_loss: 2883069.7000; val_gene_expr_recon_loss: 35385327.2000; val_masked_gp_l1_reg_loss: 94817.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151505.4219; val_chrom_access_recon_loss: 6161369.2000; val_global_loss: 44844468.8000; val_optim_loss: 44844468.8000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9295; val_auprc_score: 0.9181; val_best_acc_score: 0.8523; val_best_f1_score: 0.8639; train_kl_reg_loss: 164752.4453; train_edge_recon_loss: 2878747.1851; train_gene_expr_recon_loss: 35332871.7710; train_masked_gp_l1_reg_loss: 95555.6308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147976.5728; train_chrom_access_recon_loss: 6119168.9313; train_global_loss: 44739072.6718; train_optim_loss: 44739072.6718; val_kl_reg_loss: 153768.5969; val_edge_recon_loss: 2904419.1833; val_gene_expr_recon_loss: 35232472.5333; val_masked_gp_l1_reg_loss: 96629.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144470.9688; val_chrom_access_recon_loss: 6134901.8000; val_global_loss: 44666661.8667; val_optim_loss: 44666661.8667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9322; val_auprc_score: 0.9192; val_best_acc_score: 0.8628; val_best_f1_score: 0.8664; train_kl_reg_loss: 159284.6155; train_edge_recon_loss: 2864855.6069; train_gene_expr_recon_loss: 35224016.8244; train_masked_gp_l1_reg_loss: 97512.9818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141160.2882; train_chrom_access_recon_loss: 6107193.5115; train_global_loss: 44594023.6336; train_optim_loss: 44594023.6336; val_kl_reg_loss: 158144.1406; val_edge_recon_loss: 2875213.1667; val_gene_expr_recon_loss: 35097527.4667; val_masked_gp_l1_reg_loss: 98664.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138006.2188; val_chrom_access_recon_loss: 6111061.8000; val_global_loss: 44478617.8667; val_optim_loss: 44478617.8667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9377; val_auprc_score: 0.9283; val_best_acc_score: 0.8686; val_best_f1_score: 0.8749; train_kl_reg_loss: 154974.2137; train_edge_recon_loss: 2850539.1145; train_gene_expr_recon_loss: 35134789.5267; train_masked_gp_l1_reg_loss: 99419.3895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134968.9324; train_chrom_access_recon_loss: 6097545.0153; train_global_loss: 44472236.1832; train_optim_loss: 44472236.1832; val_kl_reg_loss: 154410.3969; val_edge_recon_loss: 2866394.2333; val_gene_expr_recon_loss: 35297622.6667; val_masked_gp_l1_reg_loss: 100517.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131993.3281; val_chrom_access_recon_loss: 6148863.9333; val_global_loss: 44699799.4667; val_optim_loss: 44699799.4667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9425; val_auprc_score: 0.9320; val_best_acc_score: 0.8751; val_best_f1_score: 0.8832; train_kl_reg_loss: 150969.1561; train_edge_recon_loss: 2843546.5935; train_gene_expr_recon_loss: 35003702.1985; train_masked_gp_l1_reg_loss: 101295.2988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129276.1684; train_chrom_access_recon_loss: 6076127.4122; train_global_loss: 44304916.8244; train_optim_loss: 44304916.8244; val_kl_reg_loss: 149599.3198; val_edge_recon_loss: 2824210.3667; val_gene_expr_recon_loss: 35030456.0000; val_masked_gp_l1_reg_loss: 102429.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126616.3438; val_chrom_access_recon_loss: 6105208.7333; val_global_loss: 44338517.6000; val_optim_loss: 44338517.6000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9442; val_auprc_score: 0.9338; val_best_acc_score: 0.8769; val_best_f1_score: 0.8823; train_kl_reg_loss: 147128.3365; train_edge_recon_loss: 2828477.2424; train_gene_expr_recon_loss: 34964433.1450; train_masked_gp_l1_reg_loss: 103242.6015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124026.4566; train_chrom_access_recon_loss: 6077405.4580; train_global_loss: 44244713.2519; train_optim_loss: 44244713.2519; val_kl_reg_loss: 146361.9760; val_edge_recon_loss: 2835297.8500; val_gene_expr_recon_loss: 35055230.4000; val_masked_gp_l1_reg_loss: 104054.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121572.9219; val_chrom_access_recon_loss: 6109991.1000; val_global_loss: 44372509.8667; val_optim_loss: 44372509.8667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9472; val_auprc_score: 0.9380; val_best_acc_score: 0.8802; val_best_f1_score: 0.8869; train_kl_reg_loss: 143275.1127; train_edge_recon_loss: 2827969.1202; train_gene_expr_recon_loss: 34805540.1679; train_masked_gp_l1_reg_loss: 105155.6523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119198.4207; train_chrom_access_recon_loss: 6053148.6794; train_global_loss: 44054287.4198; train_optim_loss: 44054287.4198; val_kl_reg_loss: 140431.4240; val_edge_recon_loss: 2835284.7667; val_gene_expr_recon_loss: 34947508.2667; val_masked_gp_l1_reg_loss: 106123.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116855.8359; val_chrom_access_recon_loss: 6092401.7667; val_global_loss: 44238606.6667; val_optim_loss: 44238606.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9558; val_auprc_score: 0.9476; val_best_acc_score: 0.8942; val_best_f1_score: 0.8996; train_kl_reg_loss: 139671.5295; train_edge_recon_loss: 2813199.6240; train_gene_expr_recon_loss: 34794150.3664; train_masked_gp_l1_reg_loss: 107023.7016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114713.2474; train_chrom_access_recon_loss: 6060785.9695; train_global_loss: 44029544.3359; train_optim_loss: 44029544.3359; val_kl_reg_loss: 139088.7875; val_edge_recon_loss: 2816829.1167; val_gene_expr_recon_loss: 34943725.6000; val_masked_gp_l1_reg_loss: 107743.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112555.3203; val_chrom_access_recon_loss: 6093625.6333; val_global_loss: 44213569.3333; val_optim_loss: 44213569.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9602; val_auprc_score: 0.9539; val_best_acc_score: 0.9000; val_best_f1_score: 0.9036; train_kl_reg_loss: 138216.0947; train_edge_recon_loss: 2803729.5859; train_gene_expr_recon_loss: 34669019.3130; train_masked_gp_l1_reg_loss: 109110.2686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110474.7335; train_chrom_access_recon_loss: 6037764.8435; train_global_loss: 43868314.5038; train_optim_loss: 43868314.5038; val_kl_reg_loss: 138147.1349; val_edge_recon_loss: 2788182.8500; val_gene_expr_recon_loss: 34887585.8667; val_masked_gp_l1_reg_loss: 110439.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108404.9922; val_chrom_access_recon_loss: 6096439.9000; val_global_loss: 44129200.5333; val_optim_loss: 44129200.5333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9586; val_auprc_score: 0.9516; val_best_acc_score: 0.8968; val_best_f1_score: 0.9010; train_kl_reg_loss: 136534.5044; train_edge_recon_loss: 2789807.3492; train_gene_expr_recon_loss: 34663106.9008; train_masked_gp_l1_reg_loss: 111095.4887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106464.2910; train_chrom_access_recon_loss: 6042880.7939; train_global_loss: 43849889.2214; train_optim_loss: 43849889.2214; val_kl_reg_loss: 133437.7365; val_edge_recon_loss: 2823070.6167; val_gene_expr_recon_loss: 34724112.2667; val_masked_gp_l1_reg_loss: 111836.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104475.1094; val_chrom_access_recon_loss: 6067377.3000; val_global_loss: 43964309.3333; val_optim_loss: 43964309.3333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9620; val_auprc_score: 0.9518; val_best_acc_score: 0.9068; val_best_f1_score: 0.9092; train_kl_reg_loss: 133892.7323; train_edge_recon_loss: 2782608.1317; train_gene_expr_recon_loss: 34568382.3359; train_masked_gp_l1_reg_loss: 112523.6430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102632.9209; train_chrom_access_recon_loss: 6031942.5420; train_global_loss: 43731982.3206; train_optim_loss: 43731982.3206; val_kl_reg_loss: 134773.6833; val_edge_recon_loss: 2787954.5833; val_gene_expr_recon_loss: 34557258.6667; val_masked_gp_l1_reg_loss: 113218.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100828.9062; val_chrom_access_recon_loss: 6054259.7333; val_global_loss: 43748295.4667; val_optim_loss: 43748295.4667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9634; val_auprc_score: 0.9562; val_best_acc_score: 0.9045; val_best_f1_score: 0.9084; train_kl_reg_loss: 132167.8869; train_edge_recon_loss: 2781758.3912; train_gene_expr_recon_loss: 34556739.7557; train_masked_gp_l1_reg_loss: 113944.3705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99063.7482; train_chrom_access_recon_loss: 6035986.9122; train_global_loss: 43719661.2214; train_optim_loss: 43719661.2214; val_kl_reg_loss: 132192.3271; val_edge_recon_loss: 2795462.0500; val_gene_expr_recon_loss: 34658041.7333; val_masked_gp_l1_reg_loss: 114963.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97387.2578; val_chrom_access_recon_loss: 6079478.7667; val_global_loss: 43877527.2000; val_optim_loss: 43877527.2000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9651; val_auprc_score: 0.9562; val_best_acc_score: 0.9096; val_best_f1_score: 0.9132; train_kl_reg_loss: 130989.8943; train_edge_recon_loss: 2776395.2424; train_gene_expr_recon_loss: 34484422.1832; train_masked_gp_l1_reg_loss: 115745.5933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95767.3169; train_chrom_access_recon_loss: 6023440.0344; train_global_loss: 43626759.9389; train_optim_loss: 43626759.9389; val_kl_reg_loss: 130289.8568; val_edge_recon_loss: 2777973.3500; val_gene_expr_recon_loss: 34657885.3333; val_masked_gp_l1_reg_loss: 116430.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94086.3281; val_chrom_access_recon_loss: 6058346.0333; val_global_loss: 43835014.4000; val_optim_loss: 43835014.4000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9647; val_auprc_score: 0.9575; val_best_acc_score: 0.9096; val_best_f1_score: 0.9131; train_kl_reg_loss: 128955.5929; train_edge_recon_loss: 2768872.9752; train_gene_expr_recon_loss: 34436170.8702; train_masked_gp_l1_reg_loss: 117268.0936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92555.0196; train_chrom_access_recon_loss: 6019917.3473; train_global_loss: 43563740.0916; train_optim_loss: 43563740.0916; val_kl_reg_loss: 127252.2120; val_edge_recon_loss: 2777591.8000; val_gene_expr_recon_loss: 34584418.5333; val_masked_gp_l1_reg_loss: 117882.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91028.6406; val_chrom_access_recon_loss: 6064952.0667; val_global_loss: 43763126.1333; val_optim_loss: 43763126.1333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9710; val_auprc_score: 0.9636; val_best_acc_score: 0.9208; val_best_f1_score: 0.9226; train_kl_reg_loss: 127830.0091; train_edge_recon_loss: 2757539.9008; train_gene_expr_recon_loss: 34403909.9542; train_masked_gp_l1_reg_loss: 118911.5408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89559.5020; train_chrom_access_recon_loss: 6019654.4962; train_global_loss: 43517405.2519; train_optim_loss: 43517405.2519; val_kl_reg_loss: 127097.3880; val_edge_recon_loss: 2749044.4167; val_gene_expr_recon_loss: 34547024.8000; val_masked_gp_l1_reg_loss: 119838.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88157.5625; val_chrom_access_recon_loss: 6061526.0333; val_global_loss: 43692688.2667; val_optim_loss: 43692688.2667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9685; val_auprc_score: 0.9621; val_best_acc_score: 0.9135; val_best_f1_score: 0.9166; train_kl_reg_loss: 125692.8154; train_edge_recon_loss: 2761841.6756; train_gene_expr_recon_loss: 34381169.1450; train_masked_gp_l1_reg_loss: 120721.6494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86739.7547; train_chrom_access_recon_loss: 6018799.7519; train_global_loss: 43494964.9771; train_optim_loss: 43494964.9771; val_kl_reg_loss: 126706.6349; val_edge_recon_loss: 2773082.5000; val_gene_expr_recon_loss: 34538940.0000; val_masked_gp_l1_reg_loss: 121506.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85382.3984; val_chrom_access_recon_loss: 6061802.7333; val_global_loss: 43707424.0000; val_optim_loss: 43707424.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9492; val_auprc_score: 0.9410; val_best_acc_score: 0.8810; val_best_f1_score: 0.8886; train_kl_reg_loss: 161464.1817; train_edge_recon_loss: 2998079.2366; train_gene_expr_recon_loss: 38790858.9618; train_masked_gp_l1_reg_loss: 123635.7404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90408.6709; train_chrom_access_recon_loss: 6364454.8092; train_global_loss: 48528901.8015; train_optim_loss: 48528901.8015; val_kl_reg_loss: 22388.7836; val_edge_recon_loss: 2905325.0167; val_gene_expr_recon_loss: 40042637.0667; val_masked_gp_l1_reg_loss: 124552.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91785.8125; val_chrom_access_recon_loss: 6409927.7333; val_global_loss: 49596614.6667; val_optim_loss: 49596614.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9305; val_auprc_score: 0.9162; val_best_acc_score: 0.8605; val_best_f1_score: 0.8700; train_kl_reg_loss: 130146.2253; train_edge_recon_loss: 2903737.4275; train_gene_expr_recon_loss: 40639422.1374; train_masked_gp_l1_reg_loss: 123984.4517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90991.8952; train_chrom_access_recon_loss: 6373290.2977; train_global_loss: 50261572.0916; train_optim_loss: 50261572.0916; val_kl_reg_loss: 19946.2268; val_edge_recon_loss: 2806601.1667; val_gene_expr_recon_loss: 41138239.2000; val_masked_gp_l1_reg_loss: 122075.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88890.4922; val_chrom_access_recon_loss: 6426903.8667; val_global_loss: 50602658.9333; val_optim_loss: 50602658.9333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9181; val_auprc_score: 0.8974; val_best_acc_score: 0.8527; val_best_f1_score: 0.8631; train_kl_reg_loss: 72373.4718; train_edge_recon_loss: 2803863.0782; train_gene_expr_recon_loss: 40526022.0153; train_masked_gp_l1_reg_loss: 119443.5443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86514.8133; train_chrom_access_recon_loss: 6351113.0687; train_global_loss: 49959330.0458; train_optim_loss: 49959330.0458; val_kl_reg_loss: 25492.9207; val_edge_recon_loss: 2808177.0833; val_gene_expr_recon_loss: 40284982.1333; val_masked_gp_l1_reg_loss: 116754.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84216.8906; val_chrom_access_recon_loss: 6396965.0000; val_global_loss: 49716589.0667; val_optim_loss: 49716589.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9160; val_auprc_score: 0.8942; val_best_acc_score: 0.8533; val_best_f1_score: 0.8633; train_kl_reg_loss: 60778.7112; train_edge_recon_loss: 2778473.2137; train_gene_expr_recon_loss: 40145265.0382; train_masked_gp_l1_reg_loss: 116250.2912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83946.6512; train_chrom_access_recon_loss: 6330674.6489; train_global_loss: 49515388.5191; train_optim_loss: 49515388.5191; val_kl_reg_loss: 26526.3842; val_edge_recon_loss: 2802374.4000; val_gene_expr_recon_loss: 40233590.4000; val_masked_gp_l1_reg_loss: 115937.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83686.2812; val_chrom_access_recon_loss: 6371942.0000; val_global_loss: 49634057.3333; val_optim_loss: 49634057.3333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9143; val_auprc_score: 0.8923; val_best_acc_score: 0.8475; val_best_f1_score: 0.8584; train_kl_reg_loss: 59740.6085; train_edge_recon_loss: 2789802.6393; train_gene_expr_recon_loss: 40069204.3053; train_masked_gp_l1_reg_loss: 115640.6341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83426.0660; train_chrom_access_recon_loss: 6323878.3931; train_global_loss: 49441692.7634; train_optim_loss: 49441692.7634; val_kl_reg_loss: 27131.1862; val_edge_recon_loss: 2823013.6500; val_gene_expr_recon_loss: 40238183.7333; val_masked_gp_l1_reg_loss: 115332.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83156.3203; val_chrom_access_recon_loss: 6375922.4667; val_global_loss: 49662739.4667; val_optim_loss: 49662739.4667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9180; val_auprc_score: 0.8955; val_best_acc_score: 0.8534; val_best_f1_score: 0.8640; train_kl_reg_loss: 58854.6489; train_edge_recon_loss: 2776529.8607; train_gene_expr_recon_loss: 40041900.2443; train_masked_gp_l1_reg_loss: 115017.9911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82889.6441; train_chrom_access_recon_loss: 6321298.8435; train_global_loss: 49396491.1450; train_optim_loss: 49396491.1450; val_kl_reg_loss: 27569.1807; val_edge_recon_loss: 2796587.8167; val_gene_expr_recon_loss: 40238319.4667; val_masked_gp_l1_reg_loss: 114691.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82616.3906; val_chrom_access_recon_loss: 6378408.8000; val_global_loss: 49638193.0667; val_optim_loss: 49638193.0667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9200; val_auprc_score: 0.8975; val_best_acc_score: 0.8572; val_best_f1_score: 0.8649; train_kl_reg_loss: 57522.2063; train_edge_recon_loss: 2780133.5706; train_gene_expr_recon_loss: 39992571.8779; train_masked_gp_l1_reg_loss: 114361.8194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82340.5569; train_chrom_access_recon_loss: 6321185.3893; train_global_loss: 49348115.4198; train_optim_loss: 49348115.4198; val_kl_reg_loss: 27948.4681; val_edge_recon_loss: 2792993.0333; val_gene_expr_recon_loss: 40120859.7333; val_masked_gp_l1_reg_loss: 114014.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82060.6328; val_chrom_access_recon_loss: 6374177.7667; val_global_loss: 49512054.9333; val_optim_loss: 49512054.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 41 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9685
val AUPRC score: 0.9625
val best accuracy score: 0.9131
val best F1 score: 0.9163
val target rna MSE score: 2.5962
val source rna MSE score: 131.1139
val target atac MSE score: 0.6203
val source atac MSE score: 7.0955
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
