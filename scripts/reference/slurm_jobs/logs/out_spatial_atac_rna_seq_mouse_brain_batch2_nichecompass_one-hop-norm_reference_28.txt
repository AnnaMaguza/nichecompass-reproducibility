[True]
Run timestamp: 07092023_150430_28.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_28']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2398 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5114, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6597; val_auprc_score: 0.6552; val_best_acc_score: 0.5019; val_best_f1_score: 0.6675; train_kl_reg_loss: 68392.9123; train_edge_recon_loss: 3536809.9924; train_gene_expr_recon_loss: 12483035.0909; train_masked_gp_l1_reg_loss: 116512.2984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5533095.1761; train_chrom_access_recon_loss: 6174244.2197; train_global_loss: 27912089.9697; train_optim_loss: 27912089.9697; val_kl_reg_loss: 145395.8164; val_edge_recon_loss: 4065442.3750; val_gene_expr_recon_loss: 11387870.3750; val_masked_gp_l1_reg_loss: 102745.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1969674.1250; val_chrom_access_recon_loss: 5797419.2500; val_global_loss: 23468547.7500; val_optim_loss: 23468547.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6714; val_auprc_score: 0.6584; val_best_acc_score: 0.5376; val_best_f1_score: 0.6812; train_kl_reg_loss: 119800.3589; train_edge_recon_loss: 3537174.9394; train_gene_expr_recon_loss: 11306344.2727; train_masked_gp_l1_reg_loss: 98925.3404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 718581.3717; train_chrom_access_recon_loss: 5860179.8182; train_global_loss: 21641006.0606; train_optim_loss: 21641006.0606; val_kl_reg_loss: 97929.1748; val_edge_recon_loss: 4063392.4375; val_gene_expr_recon_loss: 11163153.2500; val_masked_gp_l1_reg_loss: 98509.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 236454.1250; val_chrom_access_recon_loss: 5709937.0000; val_global_loss: 21369375.5000; val_optim_loss: 21369375.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7130; val_auprc_score: 0.6945; val_best_acc_score: 0.6220; val_best_f1_score: 0.6967; train_kl_reg_loss: 107828.8626; train_edge_recon_loss: 3527130.0417; train_gene_expr_recon_loss: 11150330.9545; train_masked_gp_l1_reg_loss: 99304.2888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176034.8362; train_chrom_access_recon_loss: 5804974.2045; train_global_loss: 20865603.3333; train_optim_loss: 20865603.3333; val_kl_reg_loss: 104211.0713; val_edge_recon_loss: 4055965.3750; val_gene_expr_recon_loss: 11076663.8750; val_masked_gp_l1_reg_loss: 100489.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142912.1406; val_chrom_access_recon_loss: 5729821.7500; val_global_loss: 21210063.5000; val_optim_loss: 21210063.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8176; val_auprc_score: 0.7764; val_best_acc_score: 0.7348; val_best_f1_score: 0.7702; train_kl_reg_loss: 96591.4672; train_edge_recon_loss: 3514530.3333; train_gene_expr_recon_loss: 11071555.1818; train_masked_gp_l1_reg_loss: 102196.0057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129526.3647; train_chrom_access_recon_loss: 5772826.9015; train_global_loss: 20687226.3333; train_optim_loss: 20687226.3333; val_kl_reg_loss: 92011.1943; val_edge_recon_loss: 3940820.7500; val_gene_expr_recon_loss: 11016918.8750; val_masked_gp_l1_reg_loss: 104560.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120142.8203; val_chrom_access_recon_loss: 5724386.8750; val_global_loss: 20998841.0000; val_optim_loss: 20998841.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8178; val_auprc_score: 0.7837; val_best_acc_score: 0.7423; val_best_f1_score: 0.7752; train_kl_reg_loss: 82999.7672; train_edge_recon_loss: 3320437.0833; train_gene_expr_recon_loss: 11040536.8333; train_masked_gp_l1_reg_loss: 110517.7464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117139.2659; train_chrom_access_recon_loss: 5748891.1818; train_global_loss: 20420521.9697; train_optim_loss: 20420521.9697; val_kl_reg_loss: 65002.3052; val_edge_recon_loss: 3453696.0312; val_gene_expr_recon_loss: 11163513.3750; val_masked_gp_l1_reg_loss: 121538.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117830.2656; val_chrom_access_recon_loss: 5712761.8750; val_global_loss: 20634341.0000; val_optim_loss: 20634341.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8415; val_auprc_score: 0.8140; val_best_acc_score: 0.7512; val_best_f1_score: 0.7950; train_kl_reg_loss: 86202.0800; train_edge_recon_loss: 3103001.7841; train_gene_expr_recon_loss: 11024244.9545; train_masked_gp_l1_reg_loss: 125811.7812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117843.5040; train_chrom_access_recon_loss: 5727485.7955; train_global_loss: 20184589.8788; train_optim_loss: 20184589.8788; val_kl_reg_loss: 114869.2217; val_edge_recon_loss: 2950562.6562; val_gene_expr_recon_loss: 10882253.5000; val_masked_gp_l1_reg_loss: 125661.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109393.4922; val_chrom_access_recon_loss: 5626608.5625; val_global_loss: 19809348.0000; val_optim_loss: 19809348.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8563; val_auprc_score: 0.8201; val_best_acc_score: 0.7706; val_best_f1_score: 0.7965; train_kl_reg_loss: 115369.3325; train_edge_recon_loss: 2954106.2121; train_gene_expr_recon_loss: 10897955.9697; train_masked_gp_l1_reg_loss: 125783.9350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104435.7530; train_chrom_access_recon_loss: 5674942.6742; train_global_loss: 19872593.9394; train_optim_loss: 19872593.9394; val_kl_reg_loss: 111195.0146; val_edge_recon_loss: 2956142.7500; val_gene_expr_recon_loss: 10755390.5000; val_masked_gp_l1_reg_loss: 126525.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100800.6875; val_chrom_access_recon_loss: 5547616.3750; val_global_loss: 19597671.7500; val_optim_loss: 19597671.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8650; val_auprc_score: 0.8307; val_best_acc_score: 0.7845; val_best_f1_score: 0.8082; train_kl_reg_loss: 111477.6139; train_edge_recon_loss: 2937648.6364; train_gene_expr_recon_loss: 10842620.4848; train_masked_gp_l1_reg_loss: 127738.4846; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98197.1509; train_chrom_access_recon_loss: 5648741.0000; train_global_loss: 19766423.4848; train_optim_loss: 19766423.4848; val_kl_reg_loss: 110039.0293; val_edge_recon_loss: 2916294.6250; val_gene_expr_recon_loss: 10746871.7500; val_masked_gp_l1_reg_loss: 128849.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95234.9141; val_chrom_access_recon_loss: 5583520.1250; val_global_loss: 19580810.0000; val_optim_loss: 19580810.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8631; val_auprc_score: 0.8293; val_best_acc_score: 0.7864; val_best_f1_score: 0.8130; train_kl_reg_loss: 113774.3962; train_edge_recon_loss: 2877130.9470; train_gene_expr_recon_loss: 10792732.0303; train_masked_gp_l1_reg_loss: 130106.0111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93333.2840; train_chrom_access_recon_loss: 5626063.2273; train_global_loss: 19633139.9394; train_optim_loss: 19633139.9394; val_kl_reg_loss: 115984.4639; val_edge_recon_loss: 2925312.3750; val_gene_expr_recon_loss: 10829390.6250; val_masked_gp_l1_reg_loss: 131243.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91704.5938; val_chrom_access_recon_loss: 5576084.0000; val_global_loss: 19669720.5000; val_optim_loss: 19669720.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8686; val_auprc_score: 0.8280; val_best_acc_score: 0.8023; val_best_f1_score: 0.8199; train_kl_reg_loss: 114663.7679; train_edge_recon_loss: 2866377.5606; train_gene_expr_recon_loss: 10749887.7121; train_masked_gp_l1_reg_loss: 132431.8549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90629.9525; train_chrom_access_recon_loss: 5610408.0379; train_global_loss: 19564398.9091; train_optim_loss: 19564398.9091; val_kl_reg_loss: 113107.3857; val_edge_recon_loss: 2916117.9688; val_gene_expr_recon_loss: 10643169.8750; val_masked_gp_l1_reg_loss: 133765.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90191.1172; val_chrom_access_recon_loss: 5506525.3750; val_global_loss: 19402878.0000; val_optim_loss: 19402878.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8933; val_auprc_score: 0.8565; val_best_acc_score: 0.8334; val_best_f1_score: 0.8462; train_kl_reg_loss: 114329.1784; train_edge_recon_loss: 2845018.5568; train_gene_expr_recon_loss: 10697622.4091; train_masked_gp_l1_reg_loss: 134897.6198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89348.8305; train_chrom_access_recon_loss: 5575498.8485; train_global_loss: 19456715.4848; train_optim_loss: 19456715.4848; val_kl_reg_loss: 110205.3770; val_edge_recon_loss: 2864890.7500; val_gene_expr_recon_loss: 10582732.1250; val_masked_gp_l1_reg_loss: 136495.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89417.4688; val_chrom_access_recon_loss: 5439998.8125; val_global_loss: 19223740.2500; val_optim_loss: 19223740.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9063; val_auprc_score: 0.8729; val_best_acc_score: 0.8450; val_best_f1_score: 0.8576; train_kl_reg_loss: 109442.2098; train_edge_recon_loss: 2822280.6856; train_gene_expr_recon_loss: 10659191.6364; train_masked_gp_l1_reg_loss: 137263.0734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88638.1561; train_chrom_access_recon_loss: 5562531.5985; train_global_loss: 19379347.1818; train_optim_loss: 19379347.1818; val_kl_reg_loss: 111021.6416; val_edge_recon_loss: 2823249.1875; val_gene_expr_recon_loss: 10509897.3750; val_masked_gp_l1_reg_loss: 138778.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88082.1250; val_chrom_access_recon_loss: 5442230.6875; val_global_loss: 19113259.0000; val_optim_loss: 19113259.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8992; val_auprc_score: 0.8672; val_best_acc_score: 0.8353; val_best_f1_score: 0.8482; train_kl_reg_loss: 111596.8548; train_edge_recon_loss: 2812043.6553; train_gene_expr_recon_loss: 10613937.7273; train_masked_gp_l1_reg_loss: 139429.0239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87817.9036; train_chrom_access_recon_loss: 5539063.1667; train_global_loss: 19303888.3939; train_optim_loss: 19303888.3939; val_kl_reg_loss: 113559.5332; val_edge_recon_loss: 2837532.4375; val_gene_expr_recon_loss: 10578812.5000; val_masked_gp_l1_reg_loss: 140171.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88033.6797; val_chrom_access_recon_loss: 5455908.0000; val_global_loss: 19214018.5000; val_optim_loss: 19214018.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9112; val_auprc_score: 0.8845; val_best_acc_score: 0.8442; val_best_f1_score: 0.8560; train_kl_reg_loss: 112579.2977; train_edge_recon_loss: 2804374.7576; train_gene_expr_recon_loss: 10584882.3939; train_masked_gp_l1_reg_loss: 140902.5613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87694.2798; train_chrom_access_recon_loss: 5522812.8485; train_global_loss: 19253246.0303; train_optim_loss: 19253246.0303; val_kl_reg_loss: 108443.2754; val_edge_recon_loss: 2821556.7188; val_gene_expr_recon_loss: 10568328.5000; val_masked_gp_l1_reg_loss: 141499.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87359.0078; val_chrom_access_recon_loss: 5443051.5625; val_global_loss: 19170238.0000; val_optim_loss: 19170238.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9230; val_auprc_score: 0.8977; val_best_acc_score: 0.8568; val_best_f1_score: 0.8689; train_kl_reg_loss: 110872.5000; train_edge_recon_loss: 2785055.6250; train_gene_expr_recon_loss: 10547564.9697; train_masked_gp_l1_reg_loss: 142093.2071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87384.9316; train_chrom_access_recon_loss: 5504280.9924; train_global_loss: 19177252.2727; train_optim_loss: 19177252.2727; val_kl_reg_loss: 112552.0137; val_edge_recon_loss: 2791680.9688; val_gene_expr_recon_loss: 10391334.5000; val_masked_gp_l1_reg_loss: 142527.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86970.1172; val_chrom_access_recon_loss: 5382282.0625; val_global_loss: 18907347.5000; val_optim_loss: 18907347.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9228; val_auprc_score: 0.9016; val_best_acc_score: 0.8581; val_best_f1_score: 0.8649; train_kl_reg_loss: 112051.8911; train_edge_recon_loss: 2783431.7576; train_gene_expr_recon_loss: 10519751.3182; train_masked_gp_l1_reg_loss: 143037.1842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87119.8091; train_chrom_access_recon_loss: 5492581.9167; train_global_loss: 19137973.9394; train_optim_loss: 19137973.9394; val_kl_reg_loss: 108552.6680; val_edge_recon_loss: 2777934.0625; val_gene_expr_recon_loss: 10298717.0000; val_masked_gp_l1_reg_loss: 143626.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87283.9375; val_chrom_access_recon_loss: 5336272.1875; val_global_loss: 18752385.8750; val_optim_loss: 18752385.8750
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9204; val_auprc_score: 0.8895; val_best_acc_score: 0.8603; val_best_f1_score: 0.8690; train_kl_reg_loss: 108786.0812; train_edge_recon_loss: 2792882.3636; train_gene_expr_recon_loss: 10481597.7121; train_masked_gp_l1_reg_loss: 143911.2519; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86920.6901; train_chrom_access_recon_loss: 5473738.8636; train_global_loss: 19087836.8788; train_optim_loss: 19087836.8788; val_kl_reg_loss: 109181.3047; val_edge_recon_loss: 2795225.3125; val_gene_expr_recon_loss: 10491229.3750; val_masked_gp_l1_reg_loss: 144627.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87279.4375; val_chrom_access_recon_loss: 5403176.5000; val_global_loss: 19030720.0000; val_optim_loss: 19030720.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9258; val_auprc_score: 0.8970; val_best_acc_score: 0.8643; val_best_f1_score: 0.8745; train_kl_reg_loss: 111230.6127; train_edge_recon_loss: 2775983.7083; train_gene_expr_recon_loss: 10450014.8182; train_masked_gp_l1_reg_loss: 144792.8189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86966.8615; train_chrom_access_recon_loss: 5454613.1667; train_global_loss: 19023601.9091; train_optim_loss: 19023601.9091; val_kl_reg_loss: 105631.9307; val_edge_recon_loss: 2794853.7500; val_gene_expr_recon_loss: 10487144.3750; val_masked_gp_l1_reg_loss: 145261.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87146.6172; val_chrom_access_recon_loss: 5420964.6875; val_global_loss: 19041002.2500; val_optim_loss: 19041002.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9287; val_auprc_score: 0.9043; val_best_acc_score: 0.8673; val_best_f1_score: 0.8765; train_kl_reg_loss: 107134.2708; train_edge_recon_loss: 2786348.4583; train_gene_expr_recon_loss: 10432367.6667; train_masked_gp_l1_reg_loss: 145940.4240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87025.2469; train_chrom_access_recon_loss: 5443474.3636; train_global_loss: 19002290.4242; train_optim_loss: 19002290.4242; val_kl_reg_loss: 109580.8389; val_edge_recon_loss: 2791030.2500; val_gene_expr_recon_loss: 10359074.8750; val_masked_gp_l1_reg_loss: 146498.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87205.9609; val_chrom_access_recon_loss: 5360826.4375; val_global_loss: 18854216.5000; val_optim_loss: 18854216.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9229; val_auprc_score: 0.8973; val_best_acc_score: 0.8689; val_best_f1_score: 0.8776; train_kl_reg_loss: 107500.5089; train_edge_recon_loss: 2767005.5303; train_gene_expr_recon_loss: 10401055.1970; train_masked_gp_l1_reg_loss: 146694.1707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86868.5765; train_chrom_access_recon_loss: 5428171.5455; train_global_loss: 18937295.6061; train_optim_loss: 18937295.6061; val_kl_reg_loss: 108692.2305; val_edge_recon_loss: 2778760.6250; val_gene_expr_recon_loss: 10373954.6250; val_masked_gp_l1_reg_loss: 147128.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87145.1562; val_chrom_access_recon_loss: 5359495.4375; val_global_loss: 18855176.7500; val_optim_loss: 18855176.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9260; val_auprc_score: 0.9003; val_best_acc_score: 0.8635; val_best_f1_score: 0.8730; train_kl_reg_loss: 108275.9556; train_edge_recon_loss: 2760191.4659; train_gene_expr_recon_loss: 10376280.1212; train_masked_gp_l1_reg_loss: 143837.8087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66807.3067; train_chrom_access_recon_loss: 5408508.7955; train_global_loss: 18863901.5152; train_optim_loss: 18863901.5152; val_kl_reg_loss: 110647.8057; val_edge_recon_loss: 2804349.0312; val_gene_expr_recon_loss: 10344464.6250; val_masked_gp_l1_reg_loss: 142502.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62739.4336; val_chrom_access_recon_loss: 5351017.5625; val_global_loss: 18815720.0000; val_optim_loss: 18815720.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9260; val_auprc_score: 0.9050; val_best_acc_score: 0.8587; val_best_f1_score: 0.8669; train_kl_reg_loss: 110455.3430; train_edge_recon_loss: 2760882.6250; train_gene_expr_recon_loss: 10382749.0152; train_masked_gp_l1_reg_loss: 142296.3778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62388.3507; train_chrom_access_recon_loss: 5411032.2500; train_global_loss: 18869804.0303; train_optim_loss: 18869804.0303; val_kl_reg_loss: 112025.5195; val_edge_recon_loss: 2797428.6875; val_gene_expr_recon_loss: 10380450.6250; val_masked_gp_l1_reg_loss: 142181.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62110.9766; val_chrom_access_recon_loss: 5379876.3750; val_global_loss: 18874073.0000; val_optim_loss: 18874073.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9331; val_auprc_score: 0.9076; val_best_acc_score: 0.8772; val_best_f1_score: 0.8834; train_kl_reg_loss: 110543.5379; train_edge_recon_loss: 2762318.6780; train_gene_expr_recon_loss: 10374076.1061; train_masked_gp_l1_reg_loss: 142150.2973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61925.1816; train_chrom_access_recon_loss: 5407563.4848; train_global_loss: 18858577.2121; train_optim_loss: 18858577.2121; val_kl_reg_loss: 111188.8154; val_edge_recon_loss: 2745294.4688; val_gene_expr_recon_loss: 10315393.8750; val_masked_gp_l1_reg_loss: 142129.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61730.0859; val_chrom_access_recon_loss: 5319120.6250; val_global_loss: 18694856.7500; val_optim_loss: 18694856.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9301; val_auprc_score: 0.9043; val_best_acc_score: 0.8681; val_best_f1_score: 0.8770; train_kl_reg_loss: 110980.4814; train_edge_recon_loss: 2765675.1174; train_gene_expr_recon_loss: 10369463.0303; train_masked_gp_l1_reg_loss: 142060.4328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61511.7481; train_chrom_access_recon_loss: 5406303.9394; train_global_loss: 18855994.6970; train_optim_loss: 18855994.6970; val_kl_reg_loss: 111575.8008; val_edge_recon_loss: 2777782.4375; val_gene_expr_recon_loss: 10249544.6250; val_masked_gp_l1_reg_loss: 142112.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61460.1836; val_chrom_access_recon_loss: 5301641.0625; val_global_loss: 18644115.7500; val_optim_loss: 18644115.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9239; val_auprc_score: 0.8945; val_best_acc_score: 0.8643; val_best_f1_score: 0.8742; train_kl_reg_loss: 111334.3980; train_edge_recon_loss: 2750001.1591; train_gene_expr_recon_loss: 10375453.8939; train_masked_gp_l1_reg_loss: 142087.8037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61376.2491; train_chrom_access_recon_loss: 5413716.2045; train_global_loss: 18853969.8485; train_optim_loss: 18853969.8485; val_kl_reg_loss: 111273.6611; val_edge_recon_loss: 2780785.6250; val_gene_expr_recon_loss: 10273839.8750; val_masked_gp_l1_reg_loss: 142073.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61233.5391; val_chrom_access_recon_loss: 5358223.7500; val_global_loss: 18727431.2500; val_optim_loss: 18727431.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9258; val_auprc_score: 0.8931; val_best_acc_score: 0.8665; val_best_f1_score: 0.8751; train_kl_reg_loss: 104346.2762; train_edge_recon_loss: 2883846.7197; train_gene_expr_recon_loss: 10009124.1515; train_masked_gp_l1_reg_loss: 141967.5353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62279.3181; train_chrom_access_recon_loss: 5414179.5682; train_global_loss: 18615743.5152; train_optim_loss: 18615743.5152; val_kl_reg_loss: 46552.2964; val_edge_recon_loss: 2909058.1562; val_gene_expr_recon_loss: 9848781.5000; val_masked_gp_l1_reg_loss: 141936.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63257.8047; val_chrom_access_recon_loss: 5184072.5625; val_global_loss: 18193659.2500; val_optim_loss: 18193659.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9201; val_auprc_score: 0.8920; val_best_acc_score: 0.8603; val_best_f1_score: 0.8686; train_kl_reg_loss: 115226.0750; train_edge_recon_loss: 2852515.1402; train_gene_expr_recon_loss: 9923263.3939; train_masked_gp_l1_reg_loss: 141929.4934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63077.8886; train_chrom_access_recon_loss: 5225837.2273; train_global_loss: 18321849.3333; train_optim_loss: 18321849.3333; val_kl_reg_loss: 52021.0166; val_edge_recon_loss: 2880348.7500; val_gene_expr_recon_loss: 9840554.7500; val_masked_gp_l1_reg_loss: 141877.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62889.3828; val_chrom_access_recon_loss: 5111069.1875; val_global_loss: 18088759.7500; val_optim_loss: 18088759.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9240; val_auprc_score: 0.8957; val_best_acc_score: 0.8624; val_best_f1_score: 0.8684; train_kl_reg_loss: 120882.9511; train_edge_recon_loss: 2838054.0644; train_gene_expr_recon_loss: 9882685.0606; train_masked_gp_l1_reg_loss: 141815.6259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62706.7211; train_chrom_access_recon_loss: 5178734.7652; train_global_loss: 18224879.1515; train_optim_loss: 18224879.1515; val_kl_reg_loss: 55632.5918; val_edge_recon_loss: 2885687.0625; val_gene_expr_recon_loss: 9892815.7500; val_masked_gp_l1_reg_loss: 141734.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62631.4766; val_chrom_access_recon_loss: 5109944.4375; val_global_loss: 18148445.0000; val_optim_loss: 18148445.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9285; val_auprc_score: 0.9041; val_best_acc_score: 0.8670; val_best_f1_score: 0.8739; train_kl_reg_loss: 122172.8981; train_edge_recon_loss: 2822333.0303; train_gene_expr_recon_loss: 9864727.6667; train_masked_gp_l1_reg_loss: 141690.1323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62580.3897; train_chrom_access_recon_loss: 5161570.8788; train_global_loss: 18175074.7576; train_optim_loss: 18175074.7576; val_kl_reg_loss: 57659.3794; val_edge_recon_loss: 2838508.5000; val_gene_expr_recon_loss: 9822385.0000; val_masked_gp_l1_reg_loss: 141597.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62478.4297; val_chrom_access_recon_loss: 5079921.8125; val_global_loss: 18002551.2500; val_optim_loss: 18002551.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9264; val_auprc_score: 0.8990; val_best_acc_score: 0.8632; val_best_f1_score: 0.8728; train_kl_reg_loss: 122972.1156; train_edge_recon_loss: 2824697.9735; train_gene_expr_recon_loss: 9839796.6212; train_masked_gp_l1_reg_loss: 141481.8582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62443.8691; train_chrom_access_recon_loss: 5146204.9091; train_global_loss: 18137597.5455; train_optim_loss: 18137597.5455; val_kl_reg_loss: 60691.0337; val_edge_recon_loss: 2844680.6562; val_gene_expr_recon_loss: 9817804.5000; val_masked_gp_l1_reg_loss: 141395.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62396.2500; val_chrom_access_recon_loss: 5091675.1875; val_global_loss: 18018642.2500; val_optim_loss: 18018642.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9288; val_auprc_score: 0.9061; val_best_acc_score: 0.8651; val_best_f1_score: 0.8739; train_kl_reg_loss: 121520.6733; train_edge_recon_loss: 2813167.2879; train_gene_expr_recon_loss: 9834015.1212; train_masked_gp_l1_reg_loss: 141310.8414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62405.2007; train_chrom_access_recon_loss: 5143067.3864; train_global_loss: 18115486.5152; train_optim_loss: 18115486.5152; val_kl_reg_loss: 61412.3003; val_edge_recon_loss: 2836443.0312; val_gene_expr_recon_loss: 9843616.5000; val_masked_gp_l1_reg_loss: 141239.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62367.9961; val_chrom_access_recon_loss: 5041806.8750; val_global_loss: 17986885.7500; val_optim_loss: 17986885.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9286; val_auprc_score: 0.8995; val_best_acc_score: 0.8665; val_best_f1_score: 0.8738; train_kl_reg_loss: 120373.6811; train_edge_recon_loss: 2804493.2727; train_gene_expr_recon_loss: 9819160.6061; train_masked_gp_l1_reg_loss: 141142.9228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62392.5586; train_chrom_access_recon_loss: 5128072.0530; train_global_loss: 18075634.9091; train_optim_loss: 18075634.9091; val_kl_reg_loss: 62760.3315; val_edge_recon_loss: 2810972.8750; val_gene_expr_recon_loss: 9768658.8750; val_masked_gp_l1_reg_loss: 141056.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62455.5234; val_chrom_access_recon_loss: 5024496.3750; val_global_loss: 17870400.0000; val_optim_loss: 17870400.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9271; val_auprc_score: 0.8945; val_best_acc_score: 0.8681; val_best_f1_score: 0.8743; train_kl_reg_loss: 118368.8474; train_edge_recon_loss: 2799516.2083; train_gene_expr_recon_loss: 9806171.2273; train_masked_gp_l1_reg_loss: 140982.0054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62385.6868; train_chrom_access_recon_loss: 5121220.0606; train_global_loss: 18048644.0000; train_optim_loss: 18048644.0000; val_kl_reg_loss: 63486.5776; val_edge_recon_loss: 2821567.0625; val_gene_expr_recon_loss: 9755782.1250; val_masked_gp_l1_reg_loss: 140899.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62431.9492; val_chrom_access_recon_loss: 5031397.1875; val_global_loss: 17875564.0000; val_optim_loss: 17875564.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9286; val_auprc_score: 0.8992; val_best_acc_score: 0.8667; val_best_f1_score: 0.8733; train_kl_reg_loss: 117105.9397; train_edge_recon_loss: 2796198.7879; train_gene_expr_recon_loss: 9794875.6970; train_masked_gp_l1_reg_loss: 140792.8996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62404.7798; train_chrom_access_recon_loss: 5114619.2424; train_global_loss: 18025997.3030; train_optim_loss: 18025997.3030; val_kl_reg_loss: 66188.9272; val_edge_recon_loss: 2829308.0000; val_gene_expr_recon_loss: 9723212.1250; val_masked_gp_l1_reg_loss: 140706.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62348.2500; val_chrom_access_recon_loss: 5033463.9375; val_global_loss: 17855227.5000; val_optim_loss: 17855227.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9280; val_auprc_score: 0.9039; val_best_acc_score: 0.8684; val_best_f1_score: 0.8752; train_kl_reg_loss: 115672.3357; train_edge_recon_loss: 2790298.9773; train_gene_expr_recon_loss: 9789867.5606; train_masked_gp_l1_reg_loss: 140595.6657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62322.0904; train_chrom_access_recon_loss: 5107019.0606; train_global_loss: 18005775.8485; train_optim_loss: 18005775.8485; val_kl_reg_loss: 66392.4531; val_edge_recon_loss: 2807316.5938; val_gene_expr_recon_loss: 9714740.2500; val_masked_gp_l1_reg_loss: 140483.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62297.0273; val_chrom_access_recon_loss: 5034885.0625; val_global_loss: 17826115.5000; val_optim_loss: 17826115.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9279; val_auprc_score: 0.9009; val_best_acc_score: 0.8686; val_best_f1_score: 0.8756; train_kl_reg_loss: 113415.6288; train_edge_recon_loss: 2787641.9470; train_gene_expr_recon_loss: 9783789.8333; train_masked_gp_l1_reg_loss: 140414.9927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62221.9623; train_chrom_access_recon_loss: 5105882.6970; train_global_loss: 17993366.9697; train_optim_loss: 17993366.9697; val_kl_reg_loss: 67487.6963; val_edge_recon_loss: 2817196.7188; val_gene_expr_recon_loss: 9721797.5000; val_masked_gp_l1_reg_loss: 140329.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62193.0352; val_chrom_access_recon_loss: 5019715.8750; val_global_loss: 17828721.0000; val_optim_loss: 17828721.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9328; val_auprc_score: 0.9104; val_best_acc_score: 0.8745; val_best_f1_score: 0.8808; train_kl_reg_loss: 110647.7805; train_edge_recon_loss: 2789745.2045; train_gene_expr_recon_loss: 9785532.4545; train_masked_gp_l1_reg_loss: 140248.4806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62146.4016; train_chrom_access_recon_loss: 5103639.2955; train_global_loss: 17991959.6061; train_optim_loss: 17991959.6061; val_kl_reg_loss: 67777.1104; val_edge_recon_loss: 2792118.0312; val_gene_expr_recon_loss: 9781773.7500; val_masked_gp_l1_reg_loss: 140179.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62143.3281; val_chrom_access_recon_loss: 5064049.1250; val_global_loss: 17908040.0000; val_optim_loss: 17908040.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9317; val_auprc_score: 0.9068; val_best_acc_score: 0.8718; val_best_f1_score: 0.8795; train_kl_reg_loss: 108902.3216; train_edge_recon_loss: 2770541.7348; train_gene_expr_recon_loss: 9772076.1212; train_masked_gp_l1_reg_loss: 140086.6818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62052.8764; train_chrom_access_recon_loss: 5099437.6212; train_global_loss: 17953097.3333; train_optim_loss: 17953097.3333; val_kl_reg_loss: 69316.8560; val_edge_recon_loss: 2785328.1250; val_gene_expr_recon_loss: 9729184.2500; val_masked_gp_l1_reg_loss: 140011.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62035.1367; val_chrom_access_recon_loss: 5062137.6250; val_global_loss: 17848013.2500; val_optim_loss: 17848013.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9197; val_auprc_score: 0.8819; val_best_acc_score: 0.8667; val_best_f1_score: 0.8740; train_kl_reg_loss: 107424.1553; train_edge_recon_loss: 2768131.5114; train_gene_expr_recon_loss: 9769675.1667; train_masked_gp_l1_reg_loss: 139933.1226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61982.0315; train_chrom_access_recon_loss: 5099283.1288; train_global_loss: 17946429.0606; train_optim_loss: 17946429.0606; val_kl_reg_loss: 70499.7773; val_edge_recon_loss: 2848332.5312; val_gene_expr_recon_loss: 9699679.2500; val_masked_gp_l1_reg_loss: 139858.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61943.9883; val_chrom_access_recon_loss: 5026295.4375; val_global_loss: 17846609.0000; val_optim_loss: 17846609.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9256; val_auprc_score: 0.8991; val_best_acc_score: 0.8643; val_best_f1_score: 0.8705; train_kl_reg_loss: 106675.0743; train_edge_recon_loss: 2777566.0758; train_gene_expr_recon_loss: 9758401.1515; train_masked_gp_l1_reg_loss: 139680.4950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60241.2513; train_chrom_access_recon_loss: 5088940.4091; train_global_loss: 17931504.5758; train_optim_loss: 17931504.5758; val_kl_reg_loss: 70230.7881; val_edge_recon_loss: 2853950.2188; val_gene_expr_recon_loss: 9620416.0000; val_masked_gp_l1_reg_loss: 139609.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59912.1133; val_chrom_access_recon_loss: 5008464.9375; val_global_loss: 17752583.5000; val_optim_loss: 17752583.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9276; val_auprc_score: 0.9045; val_best_acc_score: 0.8632; val_best_f1_score: 0.8716; train_kl_reg_loss: 106939.9484; train_edge_recon_loss: 2786234.6894; train_gene_expr_recon_loss: 9757686.9242; train_masked_gp_l1_reg_loss: 139583.4264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59888.4311; train_chrom_access_recon_loss: 5083809.6742; train_global_loss: 17934143.1818; train_optim_loss: 17934143.1818; val_kl_reg_loss: 70924.0010; val_edge_recon_loss: 2795963.2812; val_gene_expr_recon_loss: 9692317.8750; val_masked_gp_l1_reg_loss: 139557.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59869.0195; val_chrom_access_recon_loss: 4992902.7500; val_global_loss: 17751534.2500; val_optim_loss: 17751534.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9307; val_auprc_score: 0.9028; val_best_acc_score: 0.8713; val_best_f1_score: 0.8789; train_kl_reg_loss: 106763.6046; train_edge_recon_loss: 2785031.1174; train_gene_expr_recon_loss: 9751513.2727; train_masked_gp_l1_reg_loss: 139537.4418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59848.7905; train_chrom_access_recon_loss: 5082884.4697; train_global_loss: 17925578.6061; train_optim_loss: 17925578.6061; val_kl_reg_loss: 70663.5830; val_edge_recon_loss: 2806013.8438; val_gene_expr_recon_loss: 9767604.2500; val_masked_gp_l1_reg_loss: 139519.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59831.8984; val_chrom_access_recon_loss: 5040196.3125; val_global_loss: 17883830.0000; val_optim_loss: 17883830.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9315; val_auprc_score: 0.9002; val_best_acc_score: 0.8675; val_best_f1_score: 0.8756; train_kl_reg_loss: 106486.7740; train_edge_recon_loss: 2776104.4697; train_gene_expr_recon_loss: 9751482.8788; train_masked_gp_l1_reg_loss: 139505.5639; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59830.3058; train_chrom_access_recon_loss: 5081721.7955; train_global_loss: 17915131.8788; train_optim_loss: 17915131.8788; val_kl_reg_loss: 70738.8545; val_edge_recon_loss: 2818377.9688; val_gene_expr_recon_loss: 9654937.5000; val_masked_gp_l1_reg_loss: 139489.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59813.6250; val_chrom_access_recon_loss: 5056986.1250; val_global_loss: 17800344.5000; val_optim_loss: 17800344.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9292; val_auprc_score: 0.8984; val_best_acc_score: 0.8692; val_best_f1_score: 0.8771; train_kl_reg_loss: 106136.0672; train_edge_recon_loss: 2779906.0606; train_gene_expr_recon_loss: 9753053.1061; train_masked_gp_l1_reg_loss: 139478.9032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59805.1413; train_chrom_access_recon_loss: 5081963.7652; train_global_loss: 17920342.9697; train_optim_loss: 17920342.9697; val_kl_reg_loss: 71024.9287; val_edge_recon_loss: 2791816.4062; val_gene_expr_recon_loss: 9686044.8750; val_masked_gp_l1_reg_loss: 139465.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59805.1914; val_chrom_access_recon_loss: 4987170.6250; val_global_loss: 17735327.0000; val_optim_loss: 17735327.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9352; val_auprc_score: 0.9196; val_best_acc_score: 0.8735; val_best_f1_score: 0.8798; train_kl_reg_loss: 106125.3612; train_edge_recon_loss: 2779515.1667; train_gene_expr_recon_loss: 9760793.8333; train_masked_gp_l1_reg_loss: 139451.9517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59791.9513; train_chrom_access_recon_loss: 5086493.2576; train_global_loss: 17932171.4242; train_optim_loss: 17932171.4242; val_kl_reg_loss: 70473.1396; val_edge_recon_loss: 2808609.8125; val_gene_expr_recon_loss: 9666619.1250; val_masked_gp_l1_reg_loss: 139441.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59790.7734; val_chrom_access_recon_loss: 4995137.6250; val_global_loss: 17740071.5000; val_optim_loss: 17740071.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9369; val_auprc_score: 0.9147; val_best_acc_score: 0.8783; val_best_f1_score: 0.8845; train_kl_reg_loss: 105768.5617; train_edge_recon_loss: 2780680.9848; train_gene_expr_recon_loss: 9753834.3485; train_masked_gp_l1_reg_loss: 139428.4304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59785.0726; train_chrom_access_recon_loss: 5085200.4697; train_global_loss: 17924697.9697; train_optim_loss: 17924697.9697; val_kl_reg_loss: 71496.2705; val_edge_recon_loss: 2787302.9688; val_gene_expr_recon_loss: 9699502.1250; val_masked_gp_l1_reg_loss: 139415.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59772.9180; val_chrom_access_recon_loss: 4991034.3750; val_global_loss: 17748525.0000; val_optim_loss: 17748525.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9312; val_auprc_score: 0.9071; val_best_acc_score: 0.8713; val_best_f1_score: 0.8792; train_kl_reg_loss: 105941.0399; train_edge_recon_loss: 2783124.7765; train_gene_expr_recon_loss: 9751245.2727; train_masked_gp_l1_reg_loss: 139404.4112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59767.1581; train_chrom_access_recon_loss: 5083897.2652; train_global_loss: 17923379.7879; train_optim_loss: 17923379.7879; val_kl_reg_loss: 71609.3340; val_edge_recon_loss: 2782724.9688; val_gene_expr_recon_loss: 9702202.3750; val_masked_gp_l1_reg_loss: 139390.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59758.2188; val_chrom_access_recon_loss: 4992245.1250; val_global_loss: 17747929.5000; val_optim_loss: 17747929.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9358; val_auprc_score: 0.9153; val_best_acc_score: 0.8748; val_best_f1_score: 0.8808; train_kl_reg_loss: 105758.4691; train_edge_recon_loss: 2778014.9432; train_gene_expr_recon_loss: 9752033.4697; train_masked_gp_l1_reg_loss: 139379.7607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59750.0502; train_chrom_access_recon_loss: 5080169.7576; train_global_loss: 17915106.3333; train_optim_loss: 17915106.3333; val_kl_reg_loss: 72117.4004; val_edge_recon_loss: 2792349.0938; val_gene_expr_recon_loss: 9763098.3750; val_masked_gp_l1_reg_loss: 139367.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59748.6133; val_chrom_access_recon_loss: 5083141.0625; val_global_loss: 17909822.7500; val_optim_loss: 17909822.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9257; val_auprc_score: 0.8996; val_best_acc_score: 0.8606; val_best_f1_score: 0.8690; train_kl_reg_loss: 105340.6214; train_edge_recon_loss: 2775217.7462; train_gene_expr_recon_loss: 9750535.7424; train_masked_gp_l1_reg_loss: 139348.5715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59554.9918; train_chrom_access_recon_loss: 5081463.2652; train_global_loss: 17911461.0000; train_optim_loss: 17911461.0000; val_kl_reg_loss: 71766.4980; val_edge_recon_loss: 2835257.1250; val_gene_expr_recon_loss: 9684589.8750; val_masked_gp_l1_reg_loss: 139340.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59517.9453; val_chrom_access_recon_loss: 5016526.6875; val_global_loss: 17806999.2500; val_optim_loss: 17806999.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9236; val_auprc_score: 0.8962; val_best_acc_score: 0.8649; val_best_f1_score: 0.8738; train_kl_reg_loss: 105523.6085; train_edge_recon_loss: 2772287.9432; train_gene_expr_recon_loss: 9750857.4394; train_masked_gp_l1_reg_loss: 139337.8615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59515.1426; train_chrom_access_recon_loss: 5086319.0455; train_global_loss: 17913841.0303; train_optim_loss: 17913841.0303; val_kl_reg_loss: 71591.4668; val_edge_recon_loss: 2838478.2188; val_gene_expr_recon_loss: 9780599.2500; val_masked_gp_l1_reg_loss: 139335.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59512.8555; val_chrom_access_recon_loss: 5043969.8750; val_global_loss: 17933487.0000; val_optim_loss: 17933487.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9345; val_auprc_score: 0.9168; val_best_acc_score: 0.8716; val_best_f1_score: 0.8794; train_kl_reg_loss: 105312.2996; train_edge_recon_loss: 2772953.0265; train_gene_expr_recon_loss: 9750337.0000; train_masked_gp_l1_reg_loss: 139333.4830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59511.2961; train_chrom_access_recon_loss: 5081489.0303; train_global_loss: 17908936.0909; train_optim_loss: 17908936.0909; val_kl_reg_loss: 71702.3242; val_edge_recon_loss: 2771600.0625; val_gene_expr_recon_loss: 9743394.0000; val_masked_gp_l1_reg_loss: 139331.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59508.8750; val_chrom_access_recon_loss: 5068656.3750; val_global_loss: 17854192.7500; val_optim_loss: 17854192.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9308; val_auprc_score: 0.9043; val_best_acc_score: 0.8694; val_best_f1_score: 0.8776; train_kl_reg_loss: 105480.9684; train_edge_recon_loss: 2775640.1629; train_gene_expr_recon_loss: 9749877.0152; train_masked_gp_l1_reg_loss: 139329.8475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59507.8270; train_chrom_access_recon_loss: 5082861.9848; train_global_loss: 17912697.7879; train_optim_loss: 17912697.7879; val_kl_reg_loss: 71644.0332; val_edge_recon_loss: 2796570.2500; val_gene_expr_recon_loss: 9693443.7500; val_masked_gp_l1_reg_loss: 139328.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59506.8711; val_chrom_access_recon_loss: 4983997.0000; val_global_loss: 17744489.7500; val_optim_loss: 17744489.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 29 min 3 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9319
val AUPRC score: 0.9090
val best accuracy score: 0.8724
val best F1 score: 0.8787
val target rna MSE score: 1.9377
val source rna MSE score: 0.7266
val target atac MSE score: 0.3090
val source atac MSE score: 0.0706
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
