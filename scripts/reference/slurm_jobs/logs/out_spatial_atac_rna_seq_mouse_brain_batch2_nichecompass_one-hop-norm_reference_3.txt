[True]
Run timestamp: 07082023_170332_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8782; val_auprc_score: 0.8970; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 27564.8198; train_edge_recon_loss: 36397.9349; train_gene_expr_recon_loss: 1310317.4028; train_masked_gp_l1_reg_loss: 4604.5209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167482.5990; train_chrom_access_recon_loss: 2673317.0417; train_global_loss: 4219684.2500; train_optim_loss: 4219684.2500; val_kl_reg_loss: 17474.9102; val_edge_recon_loss: 40661.3555; val_gene_expr_recon_loss: 1115825.3750; val_masked_gp_l1_reg_loss: 4171.1104; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163198.3281; val_chrom_access_recon_loss: 1826727.3750; val_global_loss: 3168058.5000; val_optim_loss: 3168058.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8877; val_auprc_score: 0.9052; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16243.9825; train_edge_recon_loss: 38441.1780; train_gene_expr_recon_loss: 964395.5139; train_masked_gp_l1_reg_loss: 4087.7364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160564.5434; train_chrom_access_recon_loss: 1597369.1944; train_global_loss: 2781102.1111; train_optim_loss: 2781102.1111; val_kl_reg_loss: 13413.7148; val_edge_recon_loss: 40660.8750; val_gene_expr_recon_loss: 838665.0000; val_masked_gp_l1_reg_loss: 4085.0361; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157409.3438; val_chrom_access_recon_loss: 1413874.5000; val_global_loss: 2468108.5000; val_optim_loss: 2468108.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8829; val_auprc_score: 0.8979; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 14870.3451; train_edge_recon_loss: 38269.3069; train_gene_expr_recon_loss: 816127.4514; train_masked_gp_l1_reg_loss: 4209.0913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154917.5590; train_chrom_access_recon_loss: 1411802.1111; train_global_loss: 2440195.9167; train_optim_loss: 2440195.9167; val_kl_reg_loss: 16166.7559; val_edge_recon_loss: 40661.1875; val_gene_expr_recon_loss: 774744.5000; val_masked_gp_l1_reg_loss: 4361.8286; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151677.1562; val_chrom_access_recon_loss: 1370484.6250; val_global_loss: 2358096.0000; val_optim_loss: 2358096.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8820; val_auprc_score: 0.8972; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 18289.3103; train_edge_recon_loss: 38643.7530; train_gene_expr_recon_loss: 766871.5972; train_masked_gp_l1_reg_loss: 4411.0789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148772.5573; train_chrom_access_recon_loss: 1381441.9861; train_global_loss: 2358430.3333; train_optim_loss: 2358430.3333; val_kl_reg_loss: 18670.1445; val_edge_recon_loss: 40660.7422; val_gene_expr_recon_loss: 742266.6250; val_masked_gp_l1_reg_loss: 4435.1279; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144927.9375; val_chrom_access_recon_loss: 1348847.5000; val_global_loss: 2299808.0000; val_optim_loss: 2299808.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8797; val_auprc_score: 0.8924; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 19953.8728; train_edge_recon_loss: 38811.0799; train_gene_expr_recon_loss: 740631.3889; train_masked_gp_l1_reg_loss: 4429.7192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141575.3385; train_chrom_access_recon_loss: 1363569.1667; train_global_loss: 2308970.5556; train_optim_loss: 2308970.5556; val_kl_reg_loss: 19812.0977; val_edge_recon_loss: 40659.3203; val_gene_expr_recon_loss: 722997.8750; val_masked_gp_l1_reg_loss: 4414.6611; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137266.9688; val_chrom_access_recon_loss: 1334777.5000; val_global_loss: 2259928.5000; val_optim_loss: 2259928.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8763; val_auprc_score: 0.8874; val_best_acc_score: 0.5059; val_best_f1_score: 0.6693; train_kl_reg_loss: 21453.2619; train_edge_recon_loss: 38897.8620; train_gene_expr_recon_loss: 723531.5625; train_masked_gp_l1_reg_loss: 4394.6876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133709.1406; train_chrom_access_recon_loss: 1355277.5833; train_global_loss: 2277264.0833; train_optim_loss: 2277264.0833; val_kl_reg_loss: 20882.2051; val_edge_recon_loss: 40655.6562; val_gene_expr_recon_loss: 707513.7500; val_masked_gp_l1_reg_loss: 4357.9463; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129230.6641; val_chrom_access_recon_loss: 1324661.2500; val_global_loss: 2227301.5000; val_optim_loss: 2227301.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8628; val_auprc_score: 0.8656; val_best_acc_score: 0.5170; val_best_f1_score: 0.6741; train_kl_reg_loss: 22087.4032; train_edge_recon_loss: 38972.3277; train_gene_expr_recon_loss: 705484.1319; train_masked_gp_l1_reg_loss: 4330.6636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125652.1649; train_chrom_access_recon_loss: 1333360.5972; train_global_loss: 2229887.3056; train_optim_loss: 2229887.3056; val_kl_reg_loss: 22169.0156; val_edge_recon_loss: 40646.6758; val_gene_expr_recon_loss: 693749.3750; val_masked_gp_l1_reg_loss: 4294.7695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121203.9688; val_chrom_access_recon_loss: 1316974.5000; val_global_loss: 2199038.2500; val_optim_loss: 2199038.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8501; val_auprc_score: 0.8451; val_best_acc_score: 0.5407; val_best_f1_score: 0.6840; train_kl_reg_loss: 23514.8019; train_edge_recon_loss: 39036.7934; train_gene_expr_recon_loss: 696911.7222; train_masked_gp_l1_reg_loss: 4271.5460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117721.4896; train_chrom_access_recon_loss: 1337035.9722; train_global_loss: 2218492.3333; train_optim_loss: 2218492.3333; val_kl_reg_loss: 23169.7910; val_edge_recon_loss: 40623.6133; val_gene_expr_recon_loss: 682648.0625; val_masked_gp_l1_reg_loss: 4235.9209; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113420.6719; val_chrom_access_recon_loss: 1311166.2500; val_global_loss: 2175264.5000; val_optim_loss: 2175264.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8303; val_auprc_score: 0.8265; val_best_acc_score: 0.5800; val_best_f1_score: 0.7007; train_kl_reg_loss: 23872.2567; train_edge_recon_loss: 39041.1263; train_gene_expr_recon_loss: 685265.7917; train_masked_gp_l1_reg_loss: 4214.8154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110092.1615; train_chrom_access_recon_loss: 1326985.0694; train_global_loss: 2189471.2222; train_optim_loss: 2189471.2222; val_kl_reg_loss: 23495.1602; val_edge_recon_loss: 40597.5234; val_gene_expr_recon_loss: 674227.9375; val_masked_gp_l1_reg_loss: 4187.7373; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106010.2812; val_chrom_access_recon_loss: 1306239.8750; val_global_loss: 2154758.5000; val_optim_loss: 2154758.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8076; val_auprc_score: 0.8068; val_best_acc_score: 0.6238; val_best_f1_score: 0.7201; train_kl_reg_loss: 24542.6328; train_edge_recon_loss: 39058.1866; train_gene_expr_recon_loss: 679654.7222; train_masked_gp_l1_reg_loss: 4172.7297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102890.0668; train_chrom_access_recon_loss: 1325173.1944; train_global_loss: 2175491.5000; train_optim_loss: 2175491.5000; val_kl_reg_loss: 22788.7812; val_edge_recon_loss: 40559.4336; val_gene_expr_recon_loss: 668900.0625; val_masked_gp_l1_reg_loss: 4147.3247; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99085.2344; val_chrom_access_recon_loss: 1301422.8750; val_global_loss: 2136903.7500; val_optim_loss: 2136903.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8108; val_auprc_score: 0.8100; val_best_acc_score: 0.6564; val_best_f1_score: 0.7352; train_kl_reg_loss: 24461.7726; train_edge_recon_loss: 39075.4366; train_gene_expr_recon_loss: 671624.2639; train_masked_gp_l1_reg_loss: 4135.4648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96227.7240; train_chrom_access_recon_loss: 1321393.4861; train_global_loss: 2156918.1111; train_optim_loss: 2156918.1111; val_kl_reg_loss: 23276.4219; val_edge_recon_loss: 40531.3594; val_gene_expr_recon_loss: 663351.6875; val_masked_gp_l1_reg_loss: 4115.3027; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92753.4453; val_chrom_access_recon_loss: 1297578.1250; val_global_loss: 2121606.5000; val_optim_loss: 2121606.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8103; val_auprc_score: 0.8054; val_best_acc_score: 0.6766; val_best_f1_score: 0.7438; train_kl_reg_loss: 24423.7242; train_edge_recon_loss: 39097.6372; train_gene_expr_recon_loss: 667104.5278; train_masked_gp_l1_reg_loss: 4103.0134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90147.0660; train_chrom_access_recon_loss: 1318512.3194; train_global_loss: 2143388.3056; train_optim_loss: 2143388.3056; val_kl_reg_loss: 23070.3320; val_edge_recon_loss: 40504.5273; val_gene_expr_recon_loss: 659582.0625; val_masked_gp_l1_reg_loss: 4086.6021; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86985.9453; val_chrom_access_recon_loss: 1293624.0000; val_global_loss: 2107853.5000; val_optim_loss: 2107853.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8130; val_auprc_score: 0.8121; val_best_acc_score: 0.6808; val_best_f1_score: 0.7433; train_kl_reg_loss: 24089.3125; train_edge_recon_loss: 39092.8416; train_gene_expr_recon_loss: 659721.3403; train_masked_gp_l1_reg_loss: 4081.9320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84617.3785; train_chrom_access_recon_loss: 1304148.0556; train_global_loss: 2115750.9028; train_optim_loss: 2115750.9028; val_kl_reg_loss: 23071.6523; val_edge_recon_loss: 40484.6133; val_gene_expr_recon_loss: 655786.3750; val_masked_gp_l1_reg_loss: 4072.0698; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81738.4219; val_chrom_access_recon_loss: 1290606.1250; val_global_loss: 2095759.2500; val_optim_loss: 2095759.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8178; val_auprc_score: 0.8171; val_best_acc_score: 0.7004; val_best_f1_score: 0.7519; train_kl_reg_loss: 23970.7250; train_edge_recon_loss: 39072.1632; train_gene_expr_recon_loss: 660684.5972; train_masked_gp_l1_reg_loss: 4065.8711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79573.8229; train_chrom_access_recon_loss: 1308722.0000; train_global_loss: 2116089.1667; train_optim_loss: 2116089.1667; val_kl_reg_loss: 22397.1641; val_edge_recon_loss: 40451.1016; val_gene_expr_recon_loss: 653439.8750; val_masked_gp_l1_reg_loss: 4055.4839; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76940.7109; val_chrom_access_recon_loss: 1287997.2500; val_global_loss: 2085281.5000; val_optim_loss: 2085281.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8304; val_auprc_score: 0.8313; val_best_acc_score: 0.7202; val_best_f1_score: 0.7606; train_kl_reg_loss: 23540.8329; train_edge_recon_loss: 39058.8299; train_gene_expr_recon_loss: 656564.0347; train_masked_gp_l1_reg_loss: 4056.1244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74963.8099; train_chrom_access_recon_loss: 1299507.5972; train_global_loss: 2097691.1944; train_optim_loss: 2097691.1944; val_kl_reg_loss: 21815.0508; val_edge_recon_loss: 40424.2188; val_gene_expr_recon_loss: 651584.7500; val_masked_gp_l1_reg_loss: 4049.7339; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72552.2812; val_chrom_access_recon_loss: 1285942.6250; val_global_loss: 2076368.6250; val_optim_loss: 2076368.6250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8521; val_auprc_score: 0.8546; val_best_acc_score: 0.7375; val_best_f1_score: 0.7714; train_kl_reg_loss: 23226.1315; train_edge_recon_loss: 39054.9800; train_gene_expr_recon_loss: 653414.0000; train_masked_gp_l1_reg_loss: 4050.6183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70742.7413; train_chrom_access_recon_loss: 1299740.2778; train_global_loss: 2090228.7500; train_optim_loss: 2090228.7500; val_kl_reg_loss: 22240.4531; val_edge_recon_loss: 40416.1016; val_gene_expr_recon_loss: 648234.8125; val_masked_gp_l1_reg_loss: 4046.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68527.5781; val_chrom_access_recon_loss: 1283440.1250; val_global_loss: 2066906.0000; val_optim_loss: 2066906.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8599; val_auprc_score: 0.8624; val_best_acc_score: 0.7540; val_best_f1_score: 0.7807; train_kl_reg_loss: 22979.6463; train_edge_recon_loss: 39028.8477; train_gene_expr_recon_loss: 652430.2431; train_masked_gp_l1_reg_loss: 4045.9731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66851.5234; train_chrom_access_recon_loss: 1300552.2778; train_global_loss: 2085888.5000; train_optim_loss: 2085888.5000; val_kl_reg_loss: 22065.4961; val_edge_recon_loss: 40389.5547; val_gene_expr_recon_loss: 646262.5000; val_masked_gp_l1_reg_loss: 4038.7690; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64807.3984; val_chrom_access_recon_loss: 1281196.3750; val_global_loss: 2058760.0000; val_optim_loss: 2058760.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8772; val_auprc_score: 0.8722; val_best_acc_score: 0.7899; val_best_f1_score: 0.8035; train_kl_reg_loss: 22618.5276; train_edge_recon_loss: 38995.3533; train_gene_expr_recon_loss: 648791.2917; train_masked_gp_l1_reg_loss: 4038.9072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63260.7704; train_chrom_access_recon_loss: 1291361.7083; train_global_loss: 2069066.5694; train_optim_loss: 2069066.5694; val_kl_reg_loss: 21357.8047; val_edge_recon_loss: 40348.6484; val_gene_expr_recon_loss: 644848.9375; val_masked_gp_l1_reg_loss: 4038.0264; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61365.9766; val_chrom_access_recon_loss: 1279190.8750; val_global_loss: 2051150.2500; val_optim_loss: 2051150.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8885; val_auprc_score: 0.8826; val_best_acc_score: 0.8083; val_best_f1_score: 0.8150; train_kl_reg_loss: 22189.6491; train_edge_recon_loss: 38941.2114; train_gene_expr_recon_loss: 647647.4167; train_masked_gp_l1_reg_loss: 4041.4349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59939.5499; train_chrom_access_recon_loss: 1297755.7500; train_global_loss: 2070514.9861; train_optim_loss: 2070514.9861; val_kl_reg_loss: 21288.5664; val_edge_recon_loss: 40286.0742; val_gene_expr_recon_loss: 642937.8750; val_masked_gp_l1_reg_loss: 4037.9148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58193.8203; val_chrom_access_recon_loss: 1276969.8750; val_global_loss: 2043714.1250; val_optim_loss: 2043714.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8909; val_auprc_score: 0.8779; val_best_acc_score: 0.8155; val_best_f1_score: 0.8177; train_kl_reg_loss: 21981.4772; train_edge_recon_loss: 38917.4618; train_gene_expr_recon_loss: 645029.2569; train_masked_gp_l1_reg_loss: 4045.3501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56877.3220; train_chrom_access_recon_loss: 1289652.9722; train_global_loss: 2056503.8472; train_optim_loss: 2056503.8472; val_kl_reg_loss: 20510.8516; val_edge_recon_loss: 40241.4219; val_gene_expr_recon_loss: 641992.8750; val_masked_gp_l1_reg_loss: 4045.1785; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55254.7969; val_chrom_access_recon_loss: 1277754.7500; val_global_loss: 2039799.8750; val_optim_loss: 2039799.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8972; val_auprc_score: 0.8890; val_best_acc_score: 0.8212; val_best_f1_score: 0.8213; train_kl_reg_loss: 21412.7081; train_edge_recon_loss: 38829.6584; train_gene_expr_recon_loss: 645995.4236; train_masked_gp_l1_reg_loss: 4050.0100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54031.1797; train_chrom_access_recon_loss: 1285976.0972; train_global_loss: 2050295.0694; train_optim_loss: 2050295.0694; val_kl_reg_loss: 20890.6250; val_edge_recon_loss: 40194.8828; val_gene_expr_recon_loss: 639972.8750; val_masked_gp_l1_reg_loss: 4049.6218; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52533.0156; val_chrom_access_recon_loss: 1275454.5000; val_global_loss: 2033095.5000; val_optim_loss: 2033095.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9063; val_auprc_score: 0.9004; val_best_acc_score: 0.8248; val_best_f1_score: 0.8196; train_kl_reg_loss: 21210.9627; train_edge_recon_loss: 38792.6684; train_gene_expr_recon_loss: 639525.7917; train_masked_gp_l1_reg_loss: 4055.6270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51396.8906; train_chrom_access_recon_loss: 1284647.4306; train_global_loss: 2039629.3889; train_optim_loss: 2039629.3889; val_kl_reg_loss: 19987.8887; val_edge_recon_loss: 40135.5625; val_gene_expr_recon_loss: 639118.5000; val_masked_gp_l1_reg_loss: 4055.4399; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49990.5039; val_chrom_access_recon_loss: 1272990.0000; val_global_loss: 2026277.8750; val_optim_loss: 2026277.8750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9128; val_auprc_score: 0.9033; val_best_acc_score: 0.8297; val_best_f1_score: 0.8210; train_kl_reg_loss: 20862.1777; train_edge_recon_loss: 38729.7461; train_gene_expr_recon_loss: 645763.2153; train_masked_gp_l1_reg_loss: 4060.9594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48928.5391; train_chrom_access_recon_loss: 1290215.8472; train_global_loss: 2048560.5000; train_optim_loss: 2048560.5000; val_kl_reg_loss: 19583.9180; val_edge_recon_loss: 40052.7461; val_gene_expr_recon_loss: 638107.2500; val_masked_gp_l1_reg_loss: 4061.5718; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47630.5859; val_chrom_access_recon_loss: 1270536.5000; val_global_loss: 2019972.5000; val_optim_loss: 2019972.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9097; val_auprc_score: 0.9011; val_best_acc_score: 0.8217; val_best_f1_score: 0.8125; train_kl_reg_loss: 20670.7485; train_edge_recon_loss: 38677.7170; train_gene_expr_recon_loss: 640253.3889; train_masked_gp_l1_reg_loss: 4070.1063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46654.5499; train_chrom_access_recon_loss: 1285551.0556; train_global_loss: 2035877.5833; train_optim_loss: 2035877.5833; val_kl_reg_loss: 19571.0742; val_edge_recon_loss: 40017.2109; val_gene_expr_recon_loss: 636721.5000; val_masked_gp_l1_reg_loss: 4072.7810; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45445.4922; val_chrom_access_recon_loss: 1268804.8750; val_global_loss: 2014633.0000; val_optim_loss: 2014633.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9196; val_auprc_score: 0.9105; val_best_acc_score: 0.8293; val_best_f1_score: 0.8184; train_kl_reg_loss: 20378.3056; train_edge_recon_loss: 38608.4253; train_gene_expr_recon_loss: 642752.5000; train_masked_gp_l1_reg_loss: 4080.7642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44534.3503; train_chrom_access_recon_loss: 1283736.0417; train_global_loss: 2034090.3472; train_optim_loss: 2034090.3472; val_kl_reg_loss: 19920.4297; val_edge_recon_loss: 39941.7344; val_gene_expr_recon_loss: 635228.0000; val_masked_gp_l1_reg_loss: 4083.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43410.9531; val_chrom_access_recon_loss: 1266799.2500; val_global_loss: 2009383.6250; val_optim_loss: 2009383.6250
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9142; val_auprc_score: 0.9035; val_best_acc_score: 0.8367; val_best_f1_score: 0.8358; train_kl_reg_loss: 17935.4980; train_edge_recon_loss: 39674.8368; train_gene_expr_recon_loss: 931715.9653; train_masked_gp_l1_reg_loss: 4143.0381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42405.3494; train_chrom_access_recon_loss: 1355866.7639; train_global_loss: 2391741.3889; train_optim_loss: 2391741.3889; val_kl_reg_loss: 15772.3955; val_edge_recon_loss: 40130.3203; val_gene_expr_recon_loss: 914427.6250; val_masked_gp_l1_reg_loss: 4253.7568; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41064.4766; val_chrom_access_recon_loss: 1336119.3750; val_global_loss: 2351768.0000; val_optim_loss: 2351768.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9172; val_auprc_score: 0.9081; val_best_acc_score: 0.8371; val_best_f1_score: 0.8352; train_kl_reg_loss: 16978.7935; train_edge_recon_loss: 39683.4227; train_gene_expr_recon_loss: 923281.7639; train_masked_gp_l1_reg_loss: 4350.6705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39959.4297; train_chrom_access_recon_loss: 1354729.8750; train_global_loss: 2378983.9722; train_optim_loss: 2378983.9722; val_kl_reg_loss: 14906.1826; val_edge_recon_loss: 40118.7617; val_gene_expr_recon_loss: 908740.8750; val_masked_gp_l1_reg_loss: 4463.5142; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38598.6797; val_chrom_access_recon_loss: 1334058.7500; val_global_loss: 2340886.7500; val_optim_loss: 2340886.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9184; val_auprc_score: 0.9039; val_best_acc_score: 0.8378; val_best_f1_score: 0.8339; train_kl_reg_loss: 16696.6854; train_edge_recon_loss: 39667.7283; train_gene_expr_recon_loss: 915755.6389; train_masked_gp_l1_reg_loss: 4538.7492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37560.8672; train_chrom_access_recon_loss: 1351862.1667; train_global_loss: 2366081.8611; train_optim_loss: 2366081.8611; val_kl_reg_loss: 14800.8320; val_edge_recon_loss: 40062.5742; val_gene_expr_recon_loss: 904106.6250; val_masked_gp_l1_reg_loss: 4613.5107; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36300.9922; val_chrom_access_recon_loss: 1331669.8750; val_global_loss: 2331554.5000; val_optim_loss: 2331554.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9214; val_auprc_score: 0.9101; val_best_acc_score: 0.8327; val_best_f1_score: 0.8261; train_kl_reg_loss: 16510.9745; train_edge_recon_loss: 39618.8064; train_gene_expr_recon_loss: 906785.2917; train_masked_gp_l1_reg_loss: 4663.3156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35361.6372; train_chrom_access_recon_loss: 1340976.8056; train_global_loss: 2343916.8611; train_optim_loss: 2343916.8611; val_kl_reg_loss: 14883.9717; val_edge_recon_loss: 39980.0195; val_gene_expr_recon_loss: 900115.6250; val_masked_gp_l1_reg_loss: 4714.1353; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34226.3359; val_chrom_access_recon_loss: 1329387.6250; val_global_loss: 2323307.7500; val_optim_loss: 2323307.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9207; val_auprc_score: 0.9071; val_best_acc_score: 0.8387; val_best_f1_score: 0.8325; train_kl_reg_loss: 16311.2604; train_edge_recon_loss: 39572.5417; train_gene_expr_recon_loss: 906933.2222; train_masked_gp_l1_reg_loss: 4705.4720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34059.5256; train_chrom_access_recon_loss: 1341309.5972; train_global_loss: 2342891.6111; train_optim_loss: 2342891.6111; val_kl_reg_loss: 15568.1592; val_edge_recon_loss: 39993.4141; val_gene_expr_recon_loss: 899199.8125; val_masked_gp_l1_reg_loss: 4697.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33871.9922; val_chrom_access_recon_loss: 1329055.3750; val_global_loss: 2322386.2500; val_optim_loss: 2322386.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9226; val_auprc_score: 0.9079; val_best_acc_score: 0.8367; val_best_f1_score: 0.8302; train_kl_reg_loss: 16833.3084; train_edge_recon_loss: 39591.3815; train_gene_expr_recon_loss: 909189.4583; train_masked_gp_l1_reg_loss: 4695.8223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33755.8555; train_chrom_access_recon_loss: 1351032.2639; train_global_loss: 2355098.0833; train_optim_loss: 2355098.0833; val_kl_reg_loss: 15494.4258; val_edge_recon_loss: 39992.5352; val_gene_expr_recon_loss: 899005.6250; val_masked_gp_l1_reg_loss: 4692.1689; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33606.4531; val_chrom_access_recon_loss: 1329136.2500; val_global_loss: 2321927.5000; val_optim_loss: 2321927.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9214; val_auprc_score: 0.9074; val_best_acc_score: 0.8352; val_best_f1_score: 0.8285; train_kl_reg_loss: 16478.5955; train_edge_recon_loss: 39587.3477; train_gene_expr_recon_loss: 903975.8611; train_masked_gp_l1_reg_loss: 4690.7303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33497.2977; train_chrom_access_recon_loss: 1340801.8333; train_global_loss: 2339031.6389; train_optim_loss: 2339031.6389; val_kl_reg_loss: 15257.8281; val_edge_recon_loss: 39990.5742; val_gene_expr_recon_loss: 898887.2500; val_masked_gp_l1_reg_loss: 4689.5259; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33363.9102; val_chrom_access_recon_loss: 1328742.0000; val_global_loss: 2320931.0000; val_optim_loss: 2320931.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9233; val_auprc_score: 0.9094; val_best_acc_score: 0.8397; val_best_f1_score: 0.8327; train_kl_reg_loss: 16549.3739; train_edge_recon_loss: 39582.8550; train_gene_expr_recon_loss: 908687.6111; train_masked_gp_l1_reg_loss: 4689.7185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33261.9579; train_chrom_access_recon_loss: 1347826.1806; train_global_loss: 2350597.7778; train_optim_loss: 2350597.7778; val_kl_reg_loss: 15470.5645; val_edge_recon_loss: 39969.9570; val_gene_expr_recon_loss: 898570.2500; val_masked_gp_l1_reg_loss: 4690.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33139.6797; val_chrom_access_recon_loss: 1328874.7500; val_global_loss: 2320715.5000; val_optim_loss: 2320715.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 36 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9183
val AUPRC score: 0.9096
val best accuracy score: 0.8448
val best F1 score: 0.8457
val target rna MSE score: 3.6307
val source rna MSE score: 3.1317
val target atac MSE score: 0.1297
val source atac MSE score: 0.0193
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
