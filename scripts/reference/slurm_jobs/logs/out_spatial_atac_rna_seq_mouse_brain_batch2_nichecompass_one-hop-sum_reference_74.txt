[True]
Run timestamp: 10082023_221749_74.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_74']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7103; val_auprc_score: 0.7513; val_best_acc_score: 0.5003; val_best_f1_score: 0.6667; train_kl_reg_loss: 133032.8211; train_edge_recon_loss: 3782195.5821; train_gene_expr_recon_loss: 44603338.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4115453.0210; train_global_loss: 52634020.2748; train_optim_loss: 52634020.2748; val_kl_reg_loss: 122717.5719; val_edge_recon_loss: 4065674.1667; val_gene_expr_recon_loss: 38922550.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3894688.5333; val_global_loss: 47005632.0000; val_optim_loss: 47005632.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8063; val_auprc_score: 0.8191; val_best_acc_score: 0.6807; val_best_f1_score: 0.7363; train_kl_reg_loss: 207075.6428; train_edge_recon_loss: 3636654.2882; train_gene_expr_recon_loss: 37694355.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3845909.8187; train_global_loss: 45383995.2977; train_optim_loss: 45383995.2977; val_kl_reg_loss: 212212.5604; val_edge_recon_loss: 4047211.6333; val_gene_expr_recon_loss: 37454740.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3828255.1500; val_global_loss: 45542420.2667; val_optim_loss: 45542420.2667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8824; val_auprc_score: 0.8792; val_best_acc_score: 0.7825; val_best_f1_score: 0.7589; train_kl_reg_loss: 189978.8770; train_edge_recon_loss: 3565160.6431; train_gene_expr_recon_loss: 36874724.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3798343.9943; train_global_loss: 44428208.0000; train_optim_loss: 44428208.0000; val_kl_reg_loss: 181270.5469; val_edge_recon_loss: 3983180.8333; val_gene_expr_recon_loss: 36944117.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3786190.9833; val_global_loss: 44894760.2667; val_optim_loss: 44894760.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9013; val_auprc_score: 0.8917; val_best_acc_score: 0.8228; val_best_f1_score: 0.8356; train_kl_reg_loss: 158817.5479; train_edge_recon_loss: 3506621.4122; train_gene_expr_recon_loss: 36533986.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3776599.2271; train_global_loss: 43976024.9160; train_optim_loss: 43976024.9160; val_kl_reg_loss: 146983.8240; val_edge_recon_loss: 3713776.2833; val_gene_expr_recon_loss: 36511243.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3757478.8500; val_global_loss: 44129481.8667; val_optim_loss: 44129481.8667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8907; val_auprc_score: 0.8766; val_best_acc_score: 0.8080; val_best_f1_score: 0.8224; train_kl_reg_loss: 147078.7209; train_edge_recon_loss: 3259890.6851; train_gene_expr_recon_loss: 36299282.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3756247.3206; train_global_loss: 43462498.7481; train_optim_loss: 43462498.7481; val_kl_reg_loss: 173186.3854; val_edge_recon_loss: 3096818.0333; val_gene_expr_recon_loss: 36402770.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3763279.2667; val_global_loss: 43436054.1333; val_optim_loss: 43436054.1333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9003; val_auprc_score: 0.8854; val_best_acc_score: 0.8199; val_best_f1_score: 0.8313; train_kl_reg_loss: 172440.4631; train_edge_recon_loss: 3016862.2958; train_gene_expr_recon_loss: 36122570.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3745339.0897; train_global_loss: 43057212.1832; train_optim_loss: 43057212.1832; val_kl_reg_loss: 178580.9542; val_edge_recon_loss: 2987628.5833; val_gene_expr_recon_loss: 36217254.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3738277.0500; val_global_loss: 43121741.8667; val_optim_loss: 43121741.8667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9214; val_auprc_score: 0.9066; val_best_acc_score: 0.8444; val_best_f1_score: 0.8538; train_kl_reg_loss: 170186.1954; train_edge_recon_loss: 2975169.6202; train_gene_expr_recon_loss: 35900819.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3728979.9504; train_global_loss: 42775155.3893; train_optim_loss: 42775155.3893; val_kl_reg_loss: 168111.7812; val_edge_recon_loss: 2912332.8000; val_gene_expr_recon_loss: 35998590.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3724984.0167; val_global_loss: 42804019.4667; val_optim_loss: 42804019.4667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9215; val_auprc_score: 0.9066; val_best_acc_score: 0.8496; val_best_f1_score: 0.8592; train_kl_reg_loss: 160992.1998; train_edge_recon_loss: 2935994.7748; train_gene_expr_recon_loss: 35682937.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3713933.3473; train_global_loss: 42493857.8931; train_optim_loss: 42493857.8931; val_kl_reg_loss: 163151.6781; val_edge_recon_loss: 2927643.7500; val_gene_expr_recon_loss: 35789546.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3709238.2167; val_global_loss: 42589580.8000; val_optim_loss: 42589580.8000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9260; val_auprc_score: 0.9079; val_best_acc_score: 0.8592; val_best_f1_score: 0.8683; train_kl_reg_loss: 157520.3661; train_edge_recon_loss: 2900574.9103; train_gene_expr_recon_loss: 35571873.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3709573.1565; train_global_loss: 42339542.0458; train_optim_loss: 42339542.0458; val_kl_reg_loss: 150998.7448; val_edge_recon_loss: 2936014.4667; val_gene_expr_recon_loss: 35739468.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3708679.5500; val_global_loss: 42535160.8000; val_optim_loss: 42535160.8000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9380; val_auprc_score: 0.9231; val_best_acc_score: 0.8747; val_best_f1_score: 0.8795; train_kl_reg_loss: 151460.6557; train_edge_recon_loss: 2870760.9695; train_gene_expr_recon_loss: 35366025.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3687458.4676; train_global_loss: 42075705.2214; train_optim_loss: 42075705.2214; val_kl_reg_loss: 154120.9510; val_edge_recon_loss: 2874052.4167; val_gene_expr_recon_loss: 35477408.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3682722.5833; val_global_loss: 42188303.2000; val_optim_loss: 42188303.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9411; val_auprc_score: 0.9282; val_best_acc_score: 0.8746; val_best_f1_score: 0.8820; train_kl_reg_loss: 146923.6902; train_edge_recon_loss: 2856755.2290; train_gene_expr_recon_loss: 35287039.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3681856.9294; train_global_loss: 41972575.4198; train_optim_loss: 41972575.4198; val_kl_reg_loss: 146499.5552; val_edge_recon_loss: 2839327.2500; val_gene_expr_recon_loss: 35466472.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3683388.4833; val_global_loss: 42135688.5333; val_optim_loss: 42135688.5333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9442; val_auprc_score: 0.9316; val_best_acc_score: 0.8818; val_best_f1_score: 0.8855; train_kl_reg_loss: 145523.5231; train_edge_recon_loss: 2833666.8817; train_gene_expr_recon_loss: 35127826.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3668625.0057; train_global_loss: 41775641.4962; train_optim_loss: 41775641.4962; val_kl_reg_loss: 143150.7365; val_edge_recon_loss: 2847785.3167; val_gene_expr_recon_loss: 35282721.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3665603.7167; val_global_loss: 41939260.8000; val_optim_loss: 41939260.8000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9454; val_auprc_score: 0.9305; val_best_acc_score: 0.8859; val_best_f1_score: 0.8909; train_kl_reg_loss: 142120.1310; train_edge_recon_loss: 2811839.9046; train_gene_expr_recon_loss: 35076651.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3666803.3550; train_global_loss: 41697414.8702; train_optim_loss: 41697414.8702; val_kl_reg_loss: 142955.2771; val_edge_recon_loss: 2811616.4333; val_gene_expr_recon_loss: 34997326.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3637715.5000; val_global_loss: 41589614.6667; val_optim_loss: 41589614.6667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9515; val_auprc_score: 0.9414; val_best_acc_score: 0.8894; val_best_f1_score: 0.8932; train_kl_reg_loss: 137640.4023; train_edge_recon_loss: 2807766.1088; train_gene_expr_recon_loss: 34946595.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3656059.2405; train_global_loss: 41548061.6489; train_optim_loss: 41548061.6489; val_kl_reg_loss: 136452.3510; val_edge_recon_loss: 2816963.2333; val_gene_expr_recon_loss: 35156772.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3655713.6000; val_global_loss: 41765901.8667; val_optim_loss: 41765901.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9551; val_auprc_score: 0.9457; val_best_acc_score: 0.8937; val_best_f1_score: 0.8970; train_kl_reg_loss: 134966.7115; train_edge_recon_loss: 2792845.2748; train_gene_expr_recon_loss: 34899381.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3654260.6527; train_global_loss: 41481454.1679; train_optim_loss: 41481454.1679; val_kl_reg_loss: 132208.3578; val_edge_recon_loss: 2804759.0833; val_gene_expr_recon_loss: 35010012.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3646885.4667; val_global_loss: 41593864.8000; val_optim_loss: 41593864.8000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9569; val_auprc_score: 0.9490; val_best_acc_score: 0.8973; val_best_f1_score: 0.9011; train_kl_reg_loss: 129709.7026; train_edge_recon_loss: 2791775.7424; train_gene_expr_recon_loss: 34766809.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3642536.8569; train_global_loss: 41330831.6031; train_optim_loss: 41330831.6031; val_kl_reg_loss: 129013.4714; val_edge_recon_loss: 2794743.9000; val_gene_expr_recon_loss: 35048531.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3656402.0500; val_global_loss: 41628690.6667; val_optim_loss: 41628690.6667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9596; val_auprc_score: 0.9527; val_best_acc_score: 0.9016; val_best_f1_score: 0.9044; train_kl_reg_loss: 127167.3782; train_edge_recon_loss: 2780208.3531; train_gene_expr_recon_loss: 34727124.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3642113.0859; train_global_loss: 41276612.9771; train_optim_loss: 41276612.9771; val_kl_reg_loss: 126472.1328; val_edge_recon_loss: 2784951.0833; val_gene_expr_recon_loss: 34750887.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3621548.3500; val_global_loss: 41283858.6667; val_optim_loss: 41283858.6667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9594; val_auprc_score: 0.9532; val_best_acc_score: 0.9029; val_best_f1_score: 0.9052; train_kl_reg_loss: 124601.0629; train_edge_recon_loss: 2768564.9580; train_gene_expr_recon_loss: 34646921.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3638042.8092; train_global_loss: 41178130.5344; train_optim_loss: 41178130.5344; val_kl_reg_loss: 126417.6964; val_edge_recon_loss: 2776714.0333; val_gene_expr_recon_loss: 34894920.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3643023.2833; val_global_loss: 41441076.0000; val_optim_loss: 41441076.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9579; val_auprc_score: 0.9472; val_best_acc_score: 0.8999; val_best_f1_score: 0.9035; train_kl_reg_loss: 122475.1870; train_edge_recon_loss: 2770079.6031; train_gene_expr_recon_loss: 34583650.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3632215.5076; train_global_loss: 41108420.3969; train_optim_loss: 41108420.3969; val_kl_reg_loss: 123095.4833; val_edge_recon_loss: 2782356.5500; val_gene_expr_recon_loss: 34784957.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3642627.9500; val_global_loss: 41333037.0667; val_optim_loss: 41333037.0667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9651; val_auprc_score: 0.9570; val_best_acc_score: 0.9085; val_best_f1_score: 0.9111; train_kl_reg_loss: 119633.5338; train_edge_recon_loss: 2760324.1107; train_gene_expr_recon_loss: 34503923.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3629687.3321; train_global_loss: 41013568.4580; train_optim_loss: 41013568.4580; val_kl_reg_loss: 118998.5995; val_edge_recon_loss: 2767577.6667; val_gene_expr_recon_loss: 34728771.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3627383.0500; val_global_loss: 41242730.6667; val_optim_loss: 41242730.6667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9632; val_auprc_score: 0.9548; val_best_acc_score: 0.9100; val_best_f1_score: 0.9122; train_kl_reg_loss: 116129.8030; train_edge_recon_loss: 2756105.1756; train_gene_expr_recon_loss: 34449063.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3625405.3053; train_global_loss: 40946703.5420; train_optim_loss: 40946703.5420; val_kl_reg_loss: 113339.9250; val_edge_recon_loss: 2771875.6667; val_gene_expr_recon_loss: 34686531.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3626666.3333; val_global_loss: 41198413.6000; val_optim_loss: 41198413.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9659; val_auprc_score: 0.9576; val_best_acc_score: 0.9099; val_best_f1_score: 0.9127; train_kl_reg_loss: 114431.2848; train_edge_recon_loss: 2752837.7634; train_gene_expr_recon_loss: 34381796.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3620965.2500; train_global_loss: 40870030.7176; train_optim_loss: 40870030.7176; val_kl_reg_loss: 116457.3229; val_edge_recon_loss: 2766268.4333; val_gene_expr_recon_loss: 34666640.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3639089.0500; val_global_loss: 41188455.2000; val_optim_loss: 41188455.2000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9675; val_auprc_score: 0.9610; val_best_acc_score: 0.9136; val_best_f1_score: 0.9164; train_kl_reg_loss: 111922.7342; train_edge_recon_loss: 2746151.9122; train_gene_expr_recon_loss: 34298716.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3615740.3531; train_global_loss: 40772531.5420; train_optim_loss: 40772531.5420; val_kl_reg_loss: 111891.1552; val_edge_recon_loss: 2753658.6667; val_gene_expr_recon_loss: 34446941.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3605485.0333; val_global_loss: 40917976.2667; val_optim_loss: 40917976.2667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9681; val_auprc_score: 0.9598; val_best_acc_score: 0.9140; val_best_f1_score: 0.9165; train_kl_reg_loss: 110791.2374; train_edge_recon_loss: 2742267.5782; train_gene_expr_recon_loss: 34250150.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3614754.8874; train_global_loss: 40717964.4275; train_optim_loss: 40717964.4275; val_kl_reg_loss: 109005.1396; val_edge_recon_loss: 2759349.3333; val_gene_expr_recon_loss: 34697766.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3651865.0167; val_global_loss: 41217984.8000; val_optim_loss: 41217984.8000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9716; val_auprc_score: 0.9670; val_best_acc_score: 0.9175; val_best_f1_score: 0.9205; train_kl_reg_loss: 107827.0365; train_edge_recon_loss: 2740303.4752; train_gene_expr_recon_loss: 34178841.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3609967.5172; train_global_loss: 40636939.0840; train_optim_loss: 40636939.0840; val_kl_reg_loss: 104655.8667; val_edge_recon_loss: 2746090.1333; val_gene_expr_recon_loss: 34491084.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3617077.9667; val_global_loss: 40958908.5333; val_optim_loss: 40958908.5333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9705; val_auprc_score: 0.9627; val_best_acc_score: 0.9228; val_best_f1_score: 0.9250; train_kl_reg_loss: 109301.0122; train_edge_recon_loss: 2769416.6202; train_gene_expr_recon_loss: 34842045.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3706902.3397; train_global_loss: 41427665.8626; train_optim_loss: 41427665.8626; val_kl_reg_loss: 76805.6865; val_edge_recon_loss: 2745913.1500; val_gene_expr_recon_loss: 35140550.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3698605.7167; val_global_loss: 41661875.2000; val_optim_loss: 41661875.2000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9715; val_auprc_score: 0.9648; val_best_acc_score: 0.9188; val_best_f1_score: 0.9214; train_kl_reg_loss: 108842.5179; train_edge_recon_loss: 2751045.6145; train_gene_expr_recon_loss: 34677689.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3670887.6927; train_global_loss: 41208465.9847; train_optim_loss: 41208465.9847; val_kl_reg_loss: 78305.4120; val_edge_recon_loss: 2753147.3333; val_gene_expr_recon_loss: 34921283.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3670144.0833; val_global_loss: 41422880.0000; val_optim_loss: 41422880.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9717; val_auprc_score: 0.9636; val_best_acc_score: 0.9233; val_best_f1_score: 0.9246; train_kl_reg_loss: 107725.7839; train_edge_recon_loss: 2745535.9370; train_gene_expr_recon_loss: 34589904.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3662178.3798; train_global_loss: 41105344.4275; train_optim_loss: 41105344.4275; val_kl_reg_loss: 78889.3328; val_edge_recon_loss: 2750643.1333; val_gene_expr_recon_loss: 34903145.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3676049.1000; val_global_loss: 41408726.4000; val_optim_loss: 41408726.4000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9696; val_auprc_score: 0.9636; val_best_acc_score: 0.9179; val_best_f1_score: 0.9201; train_kl_reg_loss: 107379.9039; train_edge_recon_loss: 2740485.0573; train_gene_expr_recon_loss: 34597369.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3662501.9847; train_global_loss: 41107736.4885; train_optim_loss: 41107736.4885; val_kl_reg_loss: 79201.8922; val_edge_recon_loss: 2747513.3667; val_gene_expr_recon_loss: 35018664.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3679835.3333; val_global_loss: 41525214.9333; val_optim_loss: 41525214.9333
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9736; val_auprc_score: 0.9674; val_best_acc_score: 0.9258; val_best_f1_score: 0.9284; train_kl_reg_loss: 107187.9990; train_edge_recon_loss: 2733601.4962; train_gene_expr_recon_loss: 34608370.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3666390.6698; train_global_loss: 41115550.5344; train_optim_loss: 41115550.5344; val_kl_reg_loss: 79726.6604; val_edge_recon_loss: 2740076.4000; val_gene_expr_recon_loss: 34772993.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3665836.8000; val_global_loss: 41258633.8667; val_optim_loss: 41258633.8667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9727; val_auprc_score: 0.9659; val_best_acc_score: 0.9208; val_best_f1_score: 0.9234; train_kl_reg_loss: 106666.7049; train_edge_recon_loss: 2737178.6469; train_gene_expr_recon_loss: 34628802.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3670117.6069; train_global_loss: 41142765.0687; train_optim_loss: 41142765.0687; val_kl_reg_loss: 79423.5333; val_edge_recon_loss: 2763878.5500; val_gene_expr_recon_loss: 34790090.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3659974.1833; val_global_loss: 41293367.4667; val_optim_loss: 41293367.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 5 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9708
val AUPRC score: 0.9650
val best accuracy score: 0.9190
val best F1 score: 0.9215
val target rna MSE score: 0.9731
val source rna MSE score: 13.5426
val target atac MSE score: 0.5509
val source atac MSE score: 5.9854
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
