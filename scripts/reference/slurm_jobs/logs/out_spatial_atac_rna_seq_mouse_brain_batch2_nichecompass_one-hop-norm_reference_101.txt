[True]
Run timestamp: 07082023_203745_101.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_101']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8973; val_auprc_score: 0.9091; val_best_acc_score: 0.5164; val_best_f1_score: 0.6741; train_kl_reg_loss: 22477.3008; train_edge_recon_loss: 350111.5174; train_gene_expr_recon_loss: 1245686.0139; train_masked_gp_l1_reg_loss: 4580.0673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119355.2925; train_chrom_access_recon_loss: 703599.0278; train_global_loss: 2445809.2222; train_optim_loss: 2445809.2222; val_kl_reg_loss: 7850.2368; val_edge_recon_loss: 406423.9375; val_gene_expr_recon_loss: 1134741.5000; val_masked_gp_l1_reg_loss: 4213.0771; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117108.1641; val_chrom_access_recon_loss: 503506.9375; val_global_loss: 2173844.0000; val_optim_loss: 2173844.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9034; val_auprc_score: 0.9156; val_best_acc_score: 0.5049; val_best_f1_score: 0.6688; train_kl_reg_loss: 10674.5358; train_edge_recon_loss: 354478.9479; train_gene_expr_recon_loss: 1052316.9792; train_masked_gp_l1_reg_loss: 4204.5877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115704.1441; train_chrom_access_recon_loss: 502900.3368; train_global_loss: 2040279.5278; train_optim_loss: 2040279.5278; val_kl_reg_loss: 11591.0117; val_edge_recon_loss: 406524.3750; val_gene_expr_recon_loss: 933607.8125; val_masked_gp_l1_reg_loss: 4264.1475; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113957.9297; val_chrom_access_recon_loss: 488674.1562; val_global_loss: 1958619.3750; val_optim_loss: 1958619.3750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8967; val_auprc_score: 0.9082; val_best_acc_score: 0.5057; val_best_f1_score: 0.6692; train_kl_reg_loss: 14985.5184; train_edge_recon_loss: 357960.2014; train_gene_expr_recon_loss: 893638.0278; train_masked_gp_l1_reg_loss: 4375.2440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112529.6918; train_chrom_access_recon_loss: 493603.3924; train_global_loss: 1877092.0694; train_optim_loss: 1877092.0694; val_kl_reg_loss: 16125.0293; val_edge_recon_loss: 406533.2188; val_gene_expr_recon_loss: 832586.8750; val_masked_gp_l1_reg_loss: 4491.8433; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110691.1562; val_chrom_access_recon_loss: 474969.5312; val_global_loss: 1845397.6250; val_optim_loss: 1845397.6250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8732; val_auprc_score: 0.8838; val_best_acc_score: 0.5168; val_best_f1_score: 0.6741; train_kl_reg_loss: 18316.2637; train_edge_recon_loss: 359160.1528; train_gene_expr_recon_loss: 813858.1806; train_masked_gp_l1_reg_loss: 4522.9520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109110.1597; train_chrom_access_recon_loss: 473233.7292; train_global_loss: 1778201.4583; train_optim_loss: 1778201.4583; val_kl_reg_loss: 17160.5234; val_edge_recon_loss: 406461.9688; val_gene_expr_recon_loss: 775547.6250; val_masked_gp_l1_reg_loss: 4532.7104; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107057.2188; val_chrom_access_recon_loss: 456000.6250; val_global_loss: 1766760.7500; val_optim_loss: 1766760.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8491; val_auprc_score: 0.8588; val_best_acc_score: 0.5434; val_best_f1_score: 0.6845; train_kl_reg_loss: 19295.4735; train_edge_recon_loss: 358998.8681; train_gene_expr_recon_loss: 769130.4792; train_masked_gp_l1_reg_loss: 4526.5556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105293.9245; train_chrom_access_recon_loss: 459513.9826; train_global_loss: 1716759.3056; train_optim_loss: 1716759.3056; val_kl_reg_loss: 16647.0469; val_edge_recon_loss: 406208.0000; val_gene_expr_recon_loss: 740233.6250; val_masked_gp_l1_reg_loss: 4512.4043; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103019.9375; val_chrom_access_recon_loss: 449214.6875; val_global_loss: 1719835.7500; val_optim_loss: 1719835.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8415; val_auprc_score: 0.8477; val_best_acc_score: 0.5662; val_best_f1_score: 0.6929; train_kl_reg_loss: 19463.5460; train_edge_recon_loss: 359162.2153; train_gene_expr_recon_loss: 732114.3194; train_masked_gp_l1_reg_loss: 4502.3682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101117.7474; train_chrom_access_recon_loss: 453901.5764; train_global_loss: 1670261.7083; train_optim_loss: 1670261.7083; val_kl_reg_loss: 18051.3711; val_edge_recon_loss: 405691.0938; val_gene_expr_recon_loss: 716772.5000; val_masked_gp_l1_reg_loss: 4480.7222; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98694.7969; val_chrom_access_recon_loss: 445516.7500; val_global_loss: 1689207.2500; val_optim_loss: 1689207.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8437; val_auprc_score: 0.8407; val_best_acc_score: 0.6331; val_best_f1_score: 0.7239; train_kl_reg_loss: 19152.6862; train_edge_recon_loss: 358186.6389; train_gene_expr_recon_loss: 714532.4931; train_masked_gp_l1_reg_loss: 4465.9040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96698.7717; train_chrom_access_recon_loss: 449173.0556; train_global_loss: 1642209.5556; train_optim_loss: 1642209.5556; val_kl_reg_loss: 17969.5586; val_edge_recon_loss: 404787.1562; val_gene_expr_recon_loss: 702671.5000; val_masked_gp_l1_reg_loss: 4447.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94186.8750; val_chrom_access_recon_loss: 442933.1875; val_global_loss: 1666996.0000; val_optim_loss: 1666996.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8443; val_auprc_score: 0.8441; val_best_acc_score: 0.6885; val_best_f1_score: 0.7509; train_kl_reg_loss: 19170.4653; train_edge_recon_loss: 357999.7500; train_gene_expr_recon_loss: 702316.6458; train_masked_gp_l1_reg_loss: 4441.9199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92172.2387; train_chrom_access_recon_loss: 445772.3438; train_global_loss: 1621873.3611; train_optim_loss: 1621873.3611; val_kl_reg_loss: 17952.7969; val_edge_recon_loss: 403360.9688; val_gene_expr_recon_loss: 691421.2500; val_masked_gp_l1_reg_loss: 4428.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89650.7422; val_chrom_access_recon_loss: 441109.9688; val_global_loss: 1647924.6250; val_optim_loss: 1647924.6250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8339; val_auprc_score: 0.8320; val_best_acc_score: 0.7265; val_best_f1_score: 0.7645; train_kl_reg_loss: 19434.2804; train_edge_recon_loss: 357019.7812; train_gene_expr_recon_loss: 690620.2431; train_masked_gp_l1_reg_loss: 4429.7949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87647.2934; train_chrom_access_recon_loss: 444428.7014; train_global_loss: 1603580.0694; train_optim_loss: 1603580.0694; val_kl_reg_loss: 17815.2383; val_edge_recon_loss: 401800.7188; val_gene_expr_recon_loss: 683843.8125; val_masked_gp_l1_reg_loss: 4422.9897; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85154.3125; val_chrom_access_recon_loss: 439559.4688; val_global_loss: 1632596.5000; val_optim_loss: 1632596.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8314; val_auprc_score: 0.8283; val_best_acc_score: 0.7536; val_best_f1_score: 0.7667; train_kl_reg_loss: 18986.3917; train_edge_recon_loss: 356335.4757; train_gene_expr_recon_loss: 681683.8264; train_masked_gp_l1_reg_loss: 4427.2932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83188.7387; train_chrom_access_recon_loss: 442751.1250; train_global_loss: 1587372.8194; train_optim_loss: 1587372.8194; val_kl_reg_loss: 18885.5664; val_edge_recon_loss: 399360.3438; val_gene_expr_recon_loss: 677307.1250; val_masked_gp_l1_reg_loss: 4426.7715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80749.8281; val_chrom_access_recon_loss: 438508.7500; val_global_loss: 1619238.3750; val_optim_loss: 1619238.3750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8434; val_auprc_score: 0.8357; val_best_acc_score: 0.7524; val_best_f1_score: 0.7614; train_kl_reg_loss: 19047.6565; train_edge_recon_loss: 355152.8160; train_gene_expr_recon_loss: 680635.9097; train_masked_gp_l1_reg_loss: 4433.9944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78837.0955; train_chrom_access_recon_loss: 443001.7604; train_global_loss: 1581109.2500; train_optim_loss: 1581109.2500; val_kl_reg_loss: 17201.3438; val_edge_recon_loss: 393988.0000; val_gene_expr_recon_loss: 673934.2500; val_masked_gp_l1_reg_loss: 4437.8940; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76469.9844; val_chrom_access_recon_loss: 437402.4062; val_global_loss: 1603433.8750; val_optim_loss: 1603433.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8440; val_auprc_score: 0.8355; val_best_acc_score: 0.7507; val_best_f1_score: 0.7793; train_kl_reg_loss: 18815.6495; train_edge_recon_loss: 353493.8542; train_gene_expr_recon_loss: 675107.1111; train_masked_gp_l1_reg_loss: 4448.8818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74622.9965; train_chrom_access_recon_loss: 440504.8125; train_global_loss: 1566993.3472; train_optim_loss: 1566993.3472; val_kl_reg_loss: 17155.6992; val_edge_recon_loss: 387287.2812; val_gene_expr_recon_loss: 670360.0000; val_masked_gp_l1_reg_loss: 4454.8340; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72336.2969; val_chrom_access_recon_loss: 436418.2500; val_global_loss: 1588012.3750; val_optim_loss: 1588012.3750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8604; val_auprc_score: 0.8480; val_best_acc_score: 0.7758; val_best_f1_score: 0.7903; train_kl_reg_loss: 18230.0232; train_edge_recon_loss: 350490.8056; train_gene_expr_recon_loss: 672503.5000; train_masked_gp_l1_reg_loss: 4470.5371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70560.4957; train_chrom_access_recon_loss: 439938.1736; train_global_loss: 1556193.5556; train_optim_loss: 1556193.5556; val_kl_reg_loss: 16819.7539; val_edge_recon_loss: 375769.0000; val_gene_expr_recon_loss: 667708.6250; val_masked_gp_l1_reg_loss: 4482.9775; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68368.2188; val_chrom_access_recon_loss: 435607.9688; val_global_loss: 1568756.6250; val_optim_loss: 1568756.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8675; val_auprc_score: 0.8550; val_best_acc_score: 0.7850; val_best_f1_score: 0.7976; train_kl_reg_loss: 18057.2229; train_edge_recon_loss: 345422.4236; train_gene_expr_recon_loss: 668034.9722; train_masked_gp_l1_reg_loss: 4503.3733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66675.9913; train_chrom_access_recon_loss: 439098.2743; train_global_loss: 1541792.2778; train_optim_loss: 1541792.2778; val_kl_reg_loss: 16735.2188; val_edge_recon_loss: 359281.6250; val_gene_expr_recon_loss: 667054.3750; val_masked_gp_l1_reg_loss: 4522.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64590.9023; val_chrom_access_recon_loss: 434936.7188; val_global_loss: 1547121.2500; val_optim_loss: 1547121.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8803; val_auprc_score: 0.8718; val_best_acc_score: 0.7961; val_best_f1_score: 0.8057; train_kl_reg_loss: 18678.1842; train_edge_recon_loss: 336481.6285; train_gene_expr_recon_loss: 669022.7014; train_masked_gp_l1_reg_loss: 4547.1111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62989.7535; train_chrom_access_recon_loss: 438025.3194; train_global_loss: 1529744.7083; train_optim_loss: 1529744.7083; val_kl_reg_loss: 18778.3477; val_edge_recon_loss: 337268.6562; val_gene_expr_recon_loss: 666961.3125; val_masked_gp_l1_reg_loss: 4573.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61021.3359; val_chrom_access_recon_loss: 434492.0000; val_global_loss: 1523095.6250; val_optim_loss: 1523095.6250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8826; val_auprc_score: 0.8758; val_best_acc_score: 0.7952; val_best_f1_score: 0.8027; train_kl_reg_loss: 21953.1916; train_edge_recon_loss: 325223.7986; train_gene_expr_recon_loss: 665695.3056; train_masked_gp_l1_reg_loss: 4608.2903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59520.4119; train_chrom_access_recon_loss: 439065.1458; train_global_loss: 1516066.1389; train_optim_loss: 1516066.1389; val_kl_reg_loss: 23213.3828; val_edge_recon_loss: 325651.6250; val_gene_expr_recon_loss: 665069.1250; val_masked_gp_l1_reg_loss: 4643.7988; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57676.3906; val_chrom_access_recon_loss: 433615.4688; val_global_loss: 1509869.8750; val_optim_loss: 1509869.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8896; val_auprc_score: 0.8809; val_best_acc_score: 0.7979; val_best_f1_score: 0.8119; train_kl_reg_loss: 26200.7116; train_edge_recon_loss: 316764.3472; train_gene_expr_recon_loss: 669444.6111; train_masked_gp_l1_reg_loss: 4671.9708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56268.5490; train_chrom_access_recon_loss: 439056.2604; train_global_loss: 1512406.4306; train_optim_loss: 1512406.4306; val_kl_reg_loss: 25872.0898; val_edge_recon_loss: 315910.3438; val_gene_expr_recon_loss: 662751.8750; val_masked_gp_l1_reg_loss: 4700.9785; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54541.9453; val_chrom_access_recon_loss: 432982.3750; val_global_loss: 1496759.6250; val_optim_loss: 1496759.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8980; val_auprc_score: 0.8899; val_best_acc_score: 0.8094; val_best_f1_score: 0.8202; train_kl_reg_loss: 27188.8312; train_edge_recon_loss: 313921.6111; train_gene_expr_recon_loss: 660596.7153; train_masked_gp_l1_reg_loss: 4729.3968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53234.8811; train_chrom_access_recon_loss: 438274.5799; train_global_loss: 1497946.0417; train_optim_loss: 1497946.0417; val_kl_reg_loss: 25129.1738; val_edge_recon_loss: 312520.5938; val_gene_expr_recon_loss: 662077.6250; val_masked_gp_l1_reg_loss: 4754.6772; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51620.7891; val_chrom_access_recon_loss: 432237.3125; val_global_loss: 1488340.2500; val_optim_loss: 1488340.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8989; val_auprc_score: 0.8862; val_best_acc_score: 0.8145; val_best_f1_score: 0.8232; train_kl_reg_loss: 25795.2376; train_edge_recon_loss: 311341.6840; train_gene_expr_recon_loss: 662452.3958; train_masked_gp_l1_reg_loss: 4777.2099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50398.1298; train_chrom_access_recon_loss: 434774.0521; train_global_loss: 1489538.6806; train_optim_loss: 1489538.6806; val_kl_reg_loss: 23725.6934; val_edge_recon_loss: 313236.5625; val_gene_expr_recon_loss: 660470.3125; val_masked_gp_l1_reg_loss: 4799.9507; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48895.7891; val_chrom_access_recon_loss: 431674.4062; val_global_loss: 1482802.6250; val_optim_loss: 1482802.6250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9093; val_auprc_score: 0.8932; val_best_acc_score: 0.8331; val_best_f1_score: 0.8363; train_kl_reg_loss: 24902.5729; train_edge_recon_loss: 308333.7465; train_gene_expr_recon_loss: 661653.4931; train_masked_gp_l1_reg_loss: 4823.0465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47761.9314; train_chrom_access_recon_loss: 434689.6736; train_global_loss: 1482164.4722; train_optim_loss: 1482164.4722; val_kl_reg_loss: 24012.0195; val_edge_recon_loss: 309721.4688; val_gene_expr_recon_loss: 658182.7500; val_masked_gp_l1_reg_loss: 4845.1958; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46365.7422; val_chrom_access_recon_loss: 430960.7812; val_global_loss: 1474088.0000; val_optim_loss: 1474088.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9234; val_auprc_score: 0.9062; val_best_acc_score: 0.8511; val_best_f1_score: 0.8565; train_kl_reg_loss: 25319.6799; train_edge_recon_loss: 305009.7951; train_gene_expr_recon_loss: 661849.4792; train_masked_gp_l1_reg_loss: 4871.8529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45307.3273; train_chrom_access_recon_loss: 434019.5382; train_global_loss: 1476377.6528; train_optim_loss: 1476377.6528; val_kl_reg_loss: 24778.1094; val_edge_recon_loss: 303355.7188; val_gene_expr_recon_loss: 656332.5000; val_masked_gp_l1_reg_loss: 4898.5449; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44005.2695; val_chrom_access_recon_loss: 430434.6562; val_global_loss: 1463804.7500; val_optim_loss: 1463804.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9343; val_auprc_score: 0.9170; val_best_acc_score: 0.8654; val_best_f1_score: 0.8712; train_kl_reg_loss: 25584.2138; train_edge_recon_loss: 301542.8750; train_gene_expr_recon_loss: 659222.1250; train_masked_gp_l1_reg_loss: 4920.6247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43022.7378; train_chrom_access_recon_loss: 434409.8160; train_global_loss: 1468702.3889; train_optim_loss: 1468702.3889; val_kl_reg_loss: 24699.2559; val_edge_recon_loss: 299501.0312; val_gene_expr_recon_loss: 655523.7500; val_masked_gp_l1_reg_loss: 4941.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41808.7188; val_chrom_access_recon_loss: 429820.8438; val_global_loss: 1456295.1250; val_optim_loss: 1456295.1250
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9382; val_auprc_score: 0.9205; val_best_acc_score: 0.8750; val_best_f1_score: 0.8813; train_kl_reg_loss: 25689.9392; train_edge_recon_loss: 297380.3125; train_gene_expr_recon_loss: 657453.3056; train_masked_gp_l1_reg_loss: 4967.1662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40888.7153; train_chrom_access_recon_loss: 432971.0382; train_global_loss: 1459350.4583; train_optim_loss: 1459350.4583; val_kl_reg_loss: 25000.2656; val_edge_recon_loss: 295623.5000; val_gene_expr_recon_loss: 654475.3750; val_masked_gp_l1_reg_loss: 4987.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39752.3672; val_chrom_access_recon_loss: 429069.9688; val_global_loss: 1448909.0000; val_optim_loss: 1448909.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9399; val_auprc_score: 0.9233; val_best_acc_score: 0.8781; val_best_f1_score: 0.8840; train_kl_reg_loss: 25995.7383; train_edge_recon_loss: 297109.4028; train_gene_expr_recon_loss: 654206.2083; train_masked_gp_l1_reg_loss: 5009.6417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38894.4905; train_chrom_access_recon_loss: 432618.2778; train_global_loss: 1453833.7500; train_optim_loss: 1453833.7500; val_kl_reg_loss: 24957.8398; val_edge_recon_loss: 297228.8750; val_gene_expr_recon_loss: 651920.5000; val_masked_gp_l1_reg_loss: 5030.7090; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37833.5430; val_chrom_access_recon_loss: 428312.8438; val_global_loss: 1445284.3750; val_optim_loss: 1445284.3750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9426; val_auprc_score: 0.9287; val_best_acc_score: 0.8766; val_best_f1_score: 0.8819; train_kl_reg_loss: 25616.3659; train_edge_recon_loss: 295335.2222; train_gene_expr_recon_loss: 652122.5556; train_masked_gp_l1_reg_loss: 5050.8972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37031.4371; train_chrom_access_recon_loss: 431056.0799; train_global_loss: 1446212.5417; train_optim_loss: 1446212.5417; val_kl_reg_loss: 25025.5410; val_edge_recon_loss: 296535.9375; val_gene_expr_recon_loss: 652003.3125; val_masked_gp_l1_reg_loss: 5068.7090; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36038.2031; val_chrom_access_recon_loss: 427761.0938; val_global_loss: 1442432.7500; val_optim_loss: 1442432.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9439; val_auprc_score: 0.9325; val_best_acc_score: 0.8770; val_best_f1_score: 0.8805; train_kl_reg_loss: 24942.7862; train_edge_recon_loss: 307438.7222; train_gene_expr_recon_loss: 1017610.7778; train_masked_gp_l1_reg_loss: 5143.1391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35146.9162; train_chrom_access_recon_loss: 457026.5868; train_global_loss: 1847308.9167; train_optim_loss: 1847308.9167; val_kl_reg_loss: 10944.6875; val_edge_recon_loss: 302422.0312; val_gene_expr_recon_loss: 1009189.7500; val_masked_gp_l1_reg_loss: 5262.5073; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33968.8711; val_chrom_access_recon_loss: 452091.0625; val_global_loss: 1813879.0000; val_optim_loss: 1813879.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9409; val_auprc_score: 0.9243; val_best_acc_score: 0.8763; val_best_f1_score: 0.8804; train_kl_reg_loss: 24834.4614; train_edge_recon_loss: 299031.1458; train_gene_expr_recon_loss: 1008287.7153; train_masked_gp_l1_reg_loss: 5371.8433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33001.1458; train_chrom_access_recon_loss: 454809.4931; train_global_loss: 1825335.7500; train_optim_loss: 1825335.7500; val_kl_reg_loss: 12197.2637; val_edge_recon_loss: 297234.4375; val_gene_expr_recon_loss: 1004070.5000; val_masked_gp_l1_reg_loss: 5496.1987; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31808.9160; val_chrom_access_recon_loss: 451535.0625; val_global_loss: 1802342.5000; val_optim_loss: 1802342.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9476; val_auprc_score: 0.9325; val_best_acc_score: 0.8848; val_best_f1_score: 0.8876; train_kl_reg_loss: 21321.8275; train_edge_recon_loss: 294437.2188; train_gene_expr_recon_loss: 1003470.4514; train_masked_gp_l1_reg_loss: 5579.6345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30896.4169; train_chrom_access_recon_loss: 456747.0833; train_global_loss: 1812452.5972; train_optim_loss: 1812452.5972; val_kl_reg_loss: 13031.0586; val_edge_recon_loss: 293005.2500; val_gene_expr_recon_loss: 999489.6250; val_masked_gp_l1_reg_loss: 5672.0532; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29785.6738; val_chrom_access_recon_loss: 450806.9688; val_global_loss: 1791790.6250; val_optim_loss: 1791790.6250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9470; val_auprc_score: 0.9331; val_best_acc_score: 0.8843; val_best_f1_score: 0.8880; train_kl_reg_loss: 19648.8231; train_edge_recon_loss: 291451.4479; train_gene_expr_recon_loss: 1000962.3681; train_masked_gp_l1_reg_loss: 5731.7987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28942.4549; train_chrom_access_recon_loss: 455019.7882; train_global_loss: 1801756.6528; train_optim_loss: 1801756.6528; val_kl_reg_loss: 15039.4482; val_edge_recon_loss: 289656.4375; val_gene_expr_recon_loss: 993837.1250; val_masked_gp_l1_reg_loss: 5799.0576; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27917.1973; val_chrom_access_recon_loss: 449978.3750; val_global_loss: 1782227.6250; val_optim_loss: 1782227.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9480; val_auprc_score: 0.9334; val_best_acc_score: 0.8863; val_best_f1_score: 0.8896; train_kl_reg_loss: 19681.4230; train_edge_recon_loss: 290082.7708; train_gene_expr_recon_loss: 998463.0208; train_masked_gp_l1_reg_loss: 5791.2947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27798.9158; train_chrom_access_recon_loss: 455794.1771; train_global_loss: 1797611.6250; train_optim_loss: 1797611.6250; val_kl_reg_loss: 15358.4980; val_edge_recon_loss: 289956.9688; val_gene_expr_recon_loss: 993674.0000; val_masked_gp_l1_reg_loss: 5784.1104; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27655.2930; val_chrom_access_recon_loss: 450076.2188; val_global_loss: 1782505.1250; val_optim_loss: 1782505.1250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9480; val_auprc_score: 0.9306; val_best_acc_score: 0.8860; val_best_f1_score: 0.8890; train_kl_reg_loss: 19657.0393; train_edge_recon_loss: 289268.6424; train_gene_expr_recon_loss: 997651.2083; train_masked_gp_l1_reg_loss: 5783.9065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27556.1821; train_chrom_access_recon_loss: 454665.0903; train_global_loss: 1794582.0278; train_optim_loss: 1794582.0278; val_kl_reg_loss: 15451.8281; val_edge_recon_loss: 290642.1875; val_gene_expr_recon_loss: 992913.5000; val_masked_gp_l1_reg_loss: 5782.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27431.5234; val_chrom_access_recon_loss: 449946.3750; val_global_loss: 1782167.8750; val_optim_loss: 1782167.8750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9503; val_auprc_score: 0.9380; val_best_acc_score: 0.8868; val_best_f1_score: 0.8898; train_kl_reg_loss: 19664.1135; train_edge_recon_loss: 290281.5104; train_gene_expr_recon_loss: 996934.7847; train_masked_gp_l1_reg_loss: 5782.3573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27337.7207; train_chrom_access_recon_loss: 455017.0764; train_global_loss: 1795017.5278; train_optim_loss: 1795017.5278; val_kl_reg_loss: 15469.2861; val_edge_recon_loss: 290071.2812; val_gene_expr_recon_loss: 992580.0625; val_masked_gp_l1_reg_loss: 5782.5190; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27222.3281; val_chrom_access_recon_loss: 449822.8125; val_global_loss: 1780948.2500; val_optim_loss: 1780948.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9497; val_auprc_score: 0.9374; val_best_acc_score: 0.8867; val_best_f1_score: 0.8898; train_kl_reg_loss: 19455.5404; train_edge_recon_loss: 289599.5486; train_gene_expr_recon_loss: 996771.5347; train_masked_gp_l1_reg_loss: 5783.3347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27133.0547; train_chrom_access_recon_loss: 457285.8299; train_global_loss: 1796028.8333; train_optim_loss: 1796028.8333; val_kl_reg_loss: 15433.0557; val_edge_recon_loss: 290476.4062; val_gene_expr_recon_loss: 992339.0000; val_masked_gp_l1_reg_loss: 5784.9976; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27024.6562; val_chrom_access_recon_loss: 449848.3438; val_global_loss: 1780906.5000; val_optim_loss: 1780906.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 36 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9469
val AUPRC score: 0.9349
val best accuracy score: 0.8805
val best F1 score: 0.8842
val target rna MSE score: 3.8550
val source rna MSE score: 3.0902
val target atac MSE score: 0.1324
val source atac MSE score: 0.0200
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
