[True]
Run timestamp: 29072023_123018_101.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_101']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8965; val_auprc_score: 0.9103; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2920.7444; train_edge_recon_loss: 3484785.4444; train_gene_expr_recon_loss: 87501424.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 18964158.2222; train_global_loss: 109953289.7778; train_optim_loss: 109953289.7778; val_kl_reg_loss: 3979.4622; val_edge_recon_loss: 4065596.5000; val_gene_expr_recon_loss: 79832872.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17144948.0000; val_global_loss: 101047392.0000; val_optim_loss: 101047392.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9116; val_auprc_score: 0.9202; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 43520.8238; train_edge_recon_loss: 3510207.8056; train_gene_expr_recon_loss: 75641005.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17484362.8889; train_global_loss: 96679096.8889; train_optim_loss: 96679096.8889; val_kl_reg_loss: 89218.6562; val_edge_recon_loss: 4066157.0000; val_gene_expr_recon_loss: 71575024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17569400.0000; val_global_loss: 93299800.0000; val_optim_loss: 93299800.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8938; val_auprc_score: 0.9016; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 49038.5252; train_edge_recon_loss: 3641625.4444; train_gene_expr_recon_loss: 70247821.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17681542.8889; train_global_loss: 91620025.7778; train_optim_loss: 91620025.7778; val_kl_reg_loss: 81088.7500; val_edge_recon_loss: 4066039.2500; val_gene_expr_recon_loss: 68511104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 17116228.0000; val_global_loss: 89774464.0000; val_optim_loss: 89774464.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8885; val_auprc_score: 0.8961; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 109056.4397; train_edge_recon_loss: 3599377.5833; train_gene_expr_recon_loss: 67715426.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17288423.7778; train_global_loss: 88712283.5556; train_optim_loss: 88712283.5556; val_kl_reg_loss: 113236.3750; val_edge_recon_loss: 4066039.0000; val_gene_expr_recon_loss: 64641544.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16949046.0000; val_global_loss: 85769864.0000; val_optim_loss: 85769864.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8848; val_auprc_score: 0.8879; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 129397.5590; train_edge_recon_loss: 3644475.5278; train_gene_expr_recon_loss: 63379032.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17170432.8889; train_global_loss: 84323338.6667; train_optim_loss: 84323338.6667; val_kl_reg_loss: 117133.0938; val_edge_recon_loss: 4065944.7500; val_gene_expr_recon_loss: 61009736.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16839464.0000; val_global_loss: 82032272.0000; val_optim_loss: 82032272.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8868; val_auprc_score: 0.8906; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 158328.8689; train_edge_recon_loss: 3639829.9444; train_gene_expr_recon_loss: 59604902.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 17066446.8889; train_global_loss: 80469508.4444; train_optim_loss: 80469508.4444; val_kl_reg_loss: 136637.5000; val_edge_recon_loss: 4065930.0000; val_gene_expr_recon_loss: 56960440.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16662556.0000; val_global_loss: 77825568.0000; val_optim_loss: 77825568.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8865; val_auprc_score: 0.8891; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 189638.0382; train_edge_recon_loss: 3637962.7778; train_gene_expr_recon_loss: 55021507.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16781703.3333; train_global_loss: 75630811.5556; train_optim_loss: 75630811.5556; val_kl_reg_loss: 134715.0938; val_edge_recon_loss: 4065913.0000; val_gene_expr_recon_loss: 52635288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16471376.0000; val_global_loss: 73307296.0000; val_optim_loss: 73307296.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8784; val_auprc_score: 0.8831; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 209455.6597; train_edge_recon_loss: 3650187.8611; train_gene_expr_recon_loss: 50727376.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16601607.1111; train_global_loss: 71188627.5556; train_optim_loss: 71188627.5556; val_kl_reg_loss: 129873.9844; val_edge_recon_loss: 4065805.0000; val_gene_expr_recon_loss: 48624160.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16242494.0000; val_global_loss: 69062336.0000; val_optim_loss: 69062336.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8625; val_auprc_score: 0.8677; val_best_acc_score: 0.5009; val_best_f1_score: 0.6671; train_kl_reg_loss: 212895.1215; train_edge_recon_loss: 3663194.0833; train_gene_expr_recon_loss: 47047088.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16366931.3333; train_global_loss: 67290109.7778; train_optim_loss: 67290109.7778; val_kl_reg_loss: 163126.7812; val_edge_recon_loss: 4065729.0000; val_gene_expr_recon_loss: 45311440.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 16033994.0000; val_global_loss: 65574288.0000; val_optim_loss: 65574288.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8565; val_auprc_score: 0.8612; val_best_acc_score: 0.5018; val_best_f1_score: 0.6674; train_kl_reg_loss: 219193.0122; train_edge_recon_loss: 3651032.2222; train_gene_expr_recon_loss: 44143200.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 16167503.3333; train_global_loss: 64180928.8889; train_optim_loss: 64180928.8889; val_kl_reg_loss: 161588.0156; val_edge_recon_loss: 4065633.5000; val_gene_expr_recon_loss: 42962856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15791342.0000; val_global_loss: 62981416.0000; val_optim_loss: 62981416.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8476; val_auprc_score: 0.8528; val_best_acc_score: 0.5031; val_best_f1_score: 0.6680; train_kl_reg_loss: 224169.9427; train_edge_recon_loss: 3642230.8333; train_gene_expr_recon_loss: 42152829.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15877709.1111; train_global_loss: 61896939.5556; train_optim_loss: 61896939.5556; val_kl_reg_loss: 156683.6094; val_edge_recon_loss: 4065462.2500; val_gene_expr_recon_loss: 41386828.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15625744.0000; val_global_loss: 61234720.0000; val_optim_loss: 61234720.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8473; val_auprc_score: 0.8477; val_best_acc_score: 0.5067; val_best_f1_score: 0.6697; train_kl_reg_loss: 219639.4826; train_edge_recon_loss: 3635980.5556; train_gene_expr_recon_loss: 41036342.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15800699.0000; train_global_loss: 60692661.3333; train_optim_loss: 60692661.3333; val_kl_reg_loss: 161647.9062; val_edge_recon_loss: 4065138.0000; val_gene_expr_recon_loss: 40500072.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15512658.0000; val_global_loss: 60239512.0000; val_optim_loss: 60239512.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8465; val_auprc_score: 0.8460; val_best_acc_score: 0.5101; val_best_f1_score: 0.6711; train_kl_reg_loss: 212222.9913; train_edge_recon_loss: 3630232.1667; train_gene_expr_recon_loss: 39986046.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15599794.7778; train_global_loss: 59428296.4444; train_optim_loss: 59428296.4444; val_kl_reg_loss: 165403.0000; val_edge_recon_loss: 4064784.0000; val_gene_expr_recon_loss: 39823048.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15407518.0000; val_global_loss: 59460752.0000; val_optim_loss: 59460752.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8459; val_auprc_score: 0.8421; val_best_acc_score: 0.5140; val_best_f1_score: 0.6728; train_kl_reg_loss: 209655.3316; train_edge_recon_loss: 3614729.2500; train_gene_expr_recon_loss: 39489443.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15500544.4444; train_global_loss: 58814371.5556; train_optim_loss: 58814371.5556; val_kl_reg_loss: 180860.4375; val_edge_recon_loss: 4064419.0000; val_gene_expr_recon_loss: 39338688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15366232.0000; val_global_loss: 58950200.0000; val_optim_loss: 58950200.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8540; val_auprc_score: 0.8489; val_best_acc_score: 0.5333; val_best_f1_score: 0.6815; train_kl_reg_loss: 210544.7431; train_edge_recon_loss: 3603019.1389; train_gene_expr_recon_loss: 39288083.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15442278.8889; train_global_loss: 58543925.7778; train_optim_loss: 58543925.7778; val_kl_reg_loss: 157379.3281; val_edge_recon_loss: 4063559.2500; val_gene_expr_recon_loss: 39110552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15312260.0000; val_global_loss: 58643752.0000; val_optim_loss: 58643752.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8474; val_auprc_score: 0.8367; val_best_acc_score: 0.5445; val_best_f1_score: 0.6866; train_kl_reg_loss: 196782.3524; train_edge_recon_loss: 3606583.5278; train_gene_expr_recon_loss: 39255624.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15462617.0000; train_global_loss: 58521607.1111; train_optim_loss: 58521607.1111; val_kl_reg_loss: 138216.0625; val_edge_recon_loss: 4062998.5000; val_gene_expr_recon_loss: 38945128.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15270961.0000; val_global_loss: 58417304.0000; val_optim_loss: 58417304.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8452; val_auprc_score: 0.8386; val_best_acc_score: 0.5618; val_best_f1_score: 0.6948; train_kl_reg_loss: 190976.5434; train_edge_recon_loss: 3600277.8056; train_gene_expr_recon_loss: 38633924.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15367192.4444; train_global_loss: 57792371.5556; train_optim_loss: 57792371.5556; val_kl_reg_loss: 170938.3594; val_edge_recon_loss: 4062342.2500; val_gene_expr_recon_loss: 38697452.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15272855.0000; val_global_loss: 58203588.0000; val_optim_loss: 58203588.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8531; val_auprc_score: 0.8411; val_best_acc_score: 0.5819; val_best_f1_score: 0.7045; train_kl_reg_loss: 192821.8194; train_edge_recon_loss: 3589392.6111; train_gene_expr_recon_loss: 38788187.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15380553.1111; train_global_loss: 57950954.2222; train_optim_loss: 57950954.2222; val_kl_reg_loss: 151482.3594; val_edge_recon_loss: 4061141.2500; val_gene_expr_recon_loss: 38625088.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15244340.0000; val_global_loss: 58082052.0000; val_optim_loss: 58082052.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8526; val_auprc_score: 0.8392; val_best_acc_score: 0.6006; val_best_f1_score: 0.7135; train_kl_reg_loss: 186888.0122; train_edge_recon_loss: 3587982.8056; train_gene_expr_recon_loss: 38592552.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15357745.2222; train_global_loss: 57725169.3333; train_optim_loss: 57725169.3333; val_kl_reg_loss: 134490.3438; val_edge_recon_loss: 4059730.7500; val_gene_expr_recon_loss: 38476560.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15217776.0000; val_global_loss: 57888556.0000; val_optim_loss: 57888556.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8516; val_auprc_score: 0.8368; val_best_acc_score: 0.6124; val_best_f1_score: 0.7192; train_kl_reg_loss: 180721.2153; train_edge_recon_loss: 3585542.0278; train_gene_expr_recon_loss: 38462482.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15295113.7778; train_global_loss: 57523859.5556; train_optim_loss: 57523859.5556; val_kl_reg_loss: 172912.5938; val_edge_recon_loss: 4058963.0000; val_gene_expr_recon_loss: 38366300.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15211205.0000; val_global_loss: 57809380.0000; val_optim_loss: 57809380.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8504; val_auprc_score: 0.8356; val_best_acc_score: 0.6346; val_best_f1_score: 0.7300; train_kl_reg_loss: 180763.6094; train_edge_recon_loss: 3577058.0833; train_gene_expr_recon_loss: 38389485.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15291693.7778; train_global_loss: 57439001.3333; train_optim_loss: 57439001.3333; val_kl_reg_loss: 144657.0312; val_edge_recon_loss: 4056841.5000; val_gene_expr_recon_loss: 38333520.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15225838.0000; val_global_loss: 57760856.0000; val_optim_loss: 57760856.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8552; val_auprc_score: 0.8376; val_best_acc_score: 0.6598; val_best_f1_score: 0.7426; train_kl_reg_loss: 174896.1007; train_edge_recon_loss: 3578921.4722; train_gene_expr_recon_loss: 38428719.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15325736.8889; train_global_loss: 57508274.2222; train_optim_loss: 57508274.2222; val_kl_reg_loss: 129170.2266; val_edge_recon_loss: 4054668.5000; val_gene_expr_recon_loss: 38240460.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15183927.0000; val_global_loss: 57608228.0000; val_optim_loss: 57608228.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8555; val_auprc_score: 0.8386; val_best_acc_score: 0.6765; val_best_f1_score: 0.7516; train_kl_reg_loss: 172479.6910; train_edge_recon_loss: 3574839.4444; train_gene_expr_recon_loss: 38186343.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15286186.2222; train_global_loss: 57219849.3333; train_optim_loss: 57219849.3333; val_kl_reg_loss: 160931.7969; val_edge_recon_loss: 4052102.0000; val_gene_expr_recon_loss: 38117128.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15153896.0000; val_global_loss: 57484056.0000; val_optim_loss: 57484056.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8671; val_auprc_score: 0.8585; val_best_acc_score: 0.6987; val_best_f1_score: 0.7632; train_kl_reg_loss: 168400.0868; train_edge_recon_loss: 3571644.7500; train_gene_expr_recon_loss: 38021795.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15200946.2222; train_global_loss: 56962786.2222; train_optim_loss: 56962786.2222; val_kl_reg_loss: 136777.9062; val_edge_recon_loss: 4048870.5000; val_gene_expr_recon_loss: 38070300.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15131507.0000; val_global_loss: 57387456.0000; val_optim_loss: 57387456.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8635; val_auprc_score: 0.8516; val_best_acc_score: 0.7064; val_best_f1_score: 0.7665; train_kl_reg_loss: 166534.9167; train_edge_recon_loss: 3564715.6944; train_gene_expr_recon_loss: 37883055.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15271161.1111; train_global_loss: 56885466.2222; train_optim_loss: 56885466.2222; val_kl_reg_loss: 144360.1094; val_edge_recon_loss: 4047254.0000; val_gene_expr_recon_loss: 38007216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15142431.0000; val_global_loss: 57341264.0000; val_optim_loss: 57341264.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8499; val_auprc_score: 0.8313; val_best_acc_score: 0.6617; val_best_f1_score: 0.7423; train_kl_reg_loss: 181299.5773; train_edge_recon_loss: 3756507.0000; train_gene_expr_recon_loss: 39471253.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15364463.8889; train_global_loss: 58773523.5556; train_optim_loss: 58773523.5556; val_kl_reg_loss: 47106.1758; val_edge_recon_loss: 4048923.7500; val_gene_expr_recon_loss: 40077876.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15293182.0000; val_global_loss: 59467088.0000; val_optim_loss: 59467088.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8462; val_auprc_score: 0.8386; val_best_acc_score: 0.5768; val_best_f1_score: 0.7002; train_kl_reg_loss: 46637.2450; train_edge_recon_loss: 3790198.2778; train_gene_expr_recon_loss: 40782019.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15449769.4444; train_global_loss: 60068623.1111; train_optim_loss: 60068623.1111; val_kl_reg_loss: 43168.8047; val_edge_recon_loss: 4058052.5000; val_gene_expr_recon_loss: 39044580.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15282116.0000; val_global_loss: 58427916.0000; val_optim_loss: 58427916.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8518; val_auprc_score: 0.8422; val_best_acc_score: 0.5575; val_best_f1_score: 0.6927; train_kl_reg_loss: 62564.2752; train_edge_recon_loss: 3706731.2500; train_gene_expr_recon_loss: 39122524.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15399698.1111; train_global_loss: 58291517.7778; train_optim_loss: 58291517.7778; val_kl_reg_loss: 49882.1328; val_edge_recon_loss: 4061678.0000; val_gene_expr_recon_loss: 38739688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15229886.0000; val_global_loss: 58081136.0000; val_optim_loss: 58081136.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8465; val_auprc_score: 0.8337; val_best_acc_score: 0.5468; val_best_f1_score: 0.6880; train_kl_reg_loss: 80596.8819; train_edge_recon_loss: 3684355.7778; train_gene_expr_recon_loss: 38807171.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15353584.0000; train_global_loss: 57925707.5556; train_optim_loss: 57925707.5556; val_kl_reg_loss: 66128.6016; val_edge_recon_loss: 4062583.5000; val_gene_expr_recon_loss: 38440848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15188668.0000; val_global_loss: 57758228.0000; val_optim_loss: 57758228.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8461; val_auprc_score: 0.8327; val_best_acc_score: 0.5505; val_best_f1_score: 0.6898; train_kl_reg_loss: 73055.7656; train_edge_recon_loss: 3749902.6111; train_gene_expr_recon_loss: 38204600.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15276113.4444; train_global_loss: 57303672.0000; train_optim_loss: 57303672.0000; val_kl_reg_loss: 69855.8125; val_edge_recon_loss: 4062570.2500; val_gene_expr_recon_loss: 38353048.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15182770.0000; val_global_loss: 57668240.0000; val_optim_loss: 57668240.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8457; val_auprc_score: 0.8378; val_best_acc_score: 0.5461; val_best_f1_score: 0.6877; train_kl_reg_loss: 75108.3698; train_edge_recon_loss: 3720914.1944; train_gene_expr_recon_loss: 38336926.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15303015.3333; train_global_loss: 57435964.4444; train_optim_loss: 57435964.4444; val_kl_reg_loss: 70662.7656; val_edge_recon_loss: 4062742.0000; val_gene_expr_recon_loss: 38346492.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15186948.0000; val_global_loss: 57666844.0000; val_optim_loss: 57666844.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8488; val_auprc_score: 0.8387; val_best_acc_score: 0.5485; val_best_f1_score: 0.6888; train_kl_reg_loss: 76189.9844; train_edge_recon_loss: 3694459.5833; train_gene_expr_recon_loss: 38430894.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15251200.5556; train_global_loss: 57452745.7778; train_optim_loss: 57452745.7778; val_kl_reg_loss: 70635.4062; val_edge_recon_loss: 4062655.7500; val_gene_expr_recon_loss: 38308120.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15159308.0000; val_global_loss: 57600720.0000; val_optim_loss: 57600720.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8518; val_auprc_score: 0.8406; val_best_acc_score: 0.5488; val_best_f1_score: 0.6890; train_kl_reg_loss: 73914.8819; train_edge_recon_loss: 3687123.9722; train_gene_expr_recon_loss: 38414682.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 15327483.1111; train_global_loss: 57503204.0000; train_optim_loss: 57503204.0000; val_kl_reg_loss: 69121.2344; val_edge_recon_loss: 4062501.7500; val_gene_expr_recon_loss: 38329456.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 15168946.0000; val_global_loss: 57630024.0000; val_optim_loss: 57630024.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 46 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8578
val AUPRC score: 0.8404
val best accuracy score: 0.6765
val best F1 score: 0.7511
val target rna MSE score: 0.9560
val source rna MSE score: 0.6693
val target atac MSE score: 0.1196
val source atac MSE score: 0.0185
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
