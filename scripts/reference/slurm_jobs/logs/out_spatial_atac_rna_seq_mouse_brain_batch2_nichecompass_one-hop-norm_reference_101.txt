[True]
Run timestamp: 26072023_030542_101.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_101']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9000; val_auprc_score: 0.9096; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 17292.2542; train_edge_recon_loss: 3494856.2778; train_gene_expr_recon_loss: 31615607.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10867812.7778; train_global_loss: 45995568.4444; train_optim_loss: 45995568.4444; val_kl_reg_loss: 43593.0312; val_edge_recon_loss: 4065780.0000; val_gene_expr_recon_loss: 29882718.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10516551.0000; val_global_loss: 44508644.0000; val_optim_loss: 44508644.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8899; val_auprc_score: 0.8994; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 74398.0951; train_edge_recon_loss: 3578525.4722; train_gene_expr_recon_loss: 28619146.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10667480.6667; train_global_loss: 42939550.6667; train_optim_loss: 42939550.6667; val_kl_reg_loss: 70815.9062; val_edge_recon_loss: 4065945.7500; val_gene_expr_recon_loss: 26999880.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10288923.0000; val_global_loss: 41425564.0000; val_optim_loss: 41425564.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8793; val_auprc_score: 0.8850; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 114187.2231; train_edge_recon_loss: 3633575.7778; train_gene_expr_recon_loss: 26082460.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10467550.5556; train_global_loss: 40297774.6667; train_optim_loss: 40297774.6667; val_kl_reg_loss: 116640.5469; val_edge_recon_loss: 4066015.5000; val_gene_expr_recon_loss: 24920418.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10085923.0000; val_global_loss: 39188996.0000; val_optim_loss: 39188996.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8861; val_auprc_score: 0.8902; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 153505.4800; train_edge_recon_loss: 3678232.0556; train_gene_expr_recon_loss: 24212826.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10232072.6667; train_global_loss: 38276635.5556; train_optim_loss: 38276635.5556; val_kl_reg_loss: 175005.3438; val_edge_recon_loss: 4065967.0000; val_gene_expr_recon_loss: 23353672.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9943918.0000; val_global_loss: 37538560.0000; val_optim_loss: 37538560.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8894; val_auprc_score: 0.8883; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 193831.4497; train_edge_recon_loss: 3682146.0556; train_gene_expr_recon_loss: 22846392.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10020987.8889; train_global_loss: 36743357.3333; train_optim_loss: 36743357.3333; val_kl_reg_loss: 196400.5312; val_edge_recon_loss: 4065793.2500; val_gene_expr_recon_loss: 22459752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9817343.0000; val_global_loss: 36539288.0000; val_optim_loss: 36539288.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8931; val_auprc_score: 0.8910; val_best_acc_score: 0.5015; val_best_f1_score: 0.6673; train_kl_reg_loss: 210477.5990; train_edge_recon_loss: 3668309.0278; train_gene_expr_recon_loss: 22089939.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9936076.8889; train_global_loss: 35904803.1111; train_optim_loss: 35904803.1111; val_kl_reg_loss: 184340.2500; val_edge_recon_loss: 4065548.0000; val_gene_expr_recon_loss: 21902354.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9753041.0000; val_global_loss: 35905284.0000; val_optim_loss: 35905284.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8775; val_auprc_score: 0.8721; val_best_acc_score: 0.5074; val_best_f1_score: 0.6700; train_kl_reg_loss: 223265.2326; train_edge_recon_loss: 3659258.3611; train_gene_expr_recon_loss: 21787139.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9902965.1111; train_global_loss: 35572628.0000; train_optim_loss: 35572628.0000; val_kl_reg_loss: 205924.5312; val_edge_recon_loss: 4065203.0000; val_gene_expr_recon_loss: 21567540.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9711541.0000; val_global_loss: 35550208.0000; val_optim_loss: 35550208.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8826; val_auprc_score: 0.8746; val_best_acc_score: 0.5133; val_best_f1_score: 0.6726; train_kl_reg_loss: 235741.7535; train_edge_recon_loss: 3655582.3056; train_gene_expr_recon_loss: 21594706.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9890355.7778; train_global_loss: 35376387.5556; train_optim_loss: 35376387.5556; val_kl_reg_loss: 181931.9688; val_edge_recon_loss: 4064436.0000; val_gene_expr_recon_loss: 21353564.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9679324.0000; val_global_loss: 35279256.0000; val_optim_loss: 35279256.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8742; val_auprc_score: 0.8637; val_best_acc_score: 0.5407; val_best_f1_score: 0.6850; train_kl_reg_loss: 225122.6667; train_edge_recon_loss: 3650518.2222; train_gene_expr_recon_loss: 21212529.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9800181.0000; train_global_loss: 34888351.5556; train_optim_loss: 34888351.5556; val_kl_reg_loss: 215534.2812; val_edge_recon_loss: 4063068.7500; val_gene_expr_recon_loss: 21229372.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9661838.0000; val_global_loss: 35169816.0000; val_optim_loss: 35169816.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8846; val_auprc_score: 0.8777; val_best_acc_score: 0.5873; val_best_f1_score: 0.7067; train_kl_reg_loss: 229980.0660; train_edge_recon_loss: 3631724.6667; train_gene_expr_recon_loss: 21182121.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9844674.6667; train_global_loss: 34888500.0000; train_optim_loss: 34888500.0000; val_kl_reg_loss: 171687.0469; val_edge_recon_loss: 4060627.0000; val_gene_expr_recon_loss: 21103646.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9624174.0000; val_global_loss: 34960136.0000; val_optim_loss: 34960136.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8743; val_auprc_score: 0.8681; val_best_acc_score: 0.6156; val_best_f1_score: 0.7203; train_kl_reg_loss: 215053.0781; train_edge_recon_loss: 3630313.3333; train_gene_expr_recon_loss: 21077419.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9753915.1111; train_global_loss: 34676701.3333; train_optim_loss: 34676701.3333; val_kl_reg_loss: 206447.0938; val_edge_recon_loss: 4059234.2500; val_gene_expr_recon_loss: 21067078.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9640029.0000; val_global_loss: 34972788.0000; val_optim_loss: 34972788.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8788; val_auprc_score: 0.8651; val_best_acc_score: 0.6710; val_best_f1_score: 0.7492; train_kl_reg_loss: 217718.3611; train_edge_recon_loss: 3615475.2500; train_gene_expr_recon_loss: 21064031.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9764495.4444; train_global_loss: 34661721.7778; train_optim_loss: 34661721.7778; val_kl_reg_loss: 183292.6250; val_edge_recon_loss: 4055211.2500; val_gene_expr_recon_loss: 20974444.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9608356.0000; val_global_loss: 34821304.0000; val_optim_loss: 34821304.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8818; val_auprc_score: 0.8712; val_best_acc_score: 0.7230; val_best_f1_score: 0.7777; train_kl_reg_loss: 213470.8976; train_edge_recon_loss: 3608130.2222; train_gene_expr_recon_loss: 21032076.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9832735.0000; train_global_loss: 34686412.8889; train_optim_loss: 34686412.8889; val_kl_reg_loss: 175518.3438; val_edge_recon_loss: 4049927.0000; val_gene_expr_recon_loss: 20924634.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9600335.0000; val_global_loss: 34750416.0000; val_optim_loss: 34750416.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8768; val_auprc_score: 0.8662; val_best_acc_score: 0.7447; val_best_f1_score: 0.7876; train_kl_reg_loss: 205766.4080; train_edge_recon_loss: 3604958.6667; train_gene_expr_recon_loss: 20877614.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9758860.1111; train_global_loss: 34447198.6667; train_optim_loss: 34447198.6667; val_kl_reg_loss: 175796.1562; val_edge_recon_loss: 4043517.5000; val_gene_expr_recon_loss: 20873100.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9580104.0000; val_global_loss: 34672520.0000; val_optim_loss: 34672520.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8840; val_auprc_score: 0.8696; val_best_acc_score: 0.7808; val_best_f1_score: 0.8083; train_kl_reg_loss: 205697.0920; train_edge_recon_loss: 3593937.8056; train_gene_expr_recon_loss: 20829084.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9739233.7778; train_global_loss: 34367952.8889; train_optim_loss: 34367952.8889; val_kl_reg_loss: 163252.5312; val_edge_recon_loss: 4035380.2500; val_gene_expr_recon_loss: 20817890.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9561566.0000; val_global_loss: 34578088.0000; val_optim_loss: 34578088.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8825; val_auprc_score: 0.8713; val_best_acc_score: 0.7940; val_best_f1_score: 0.8121; train_kl_reg_loss: 193754.3542; train_edge_recon_loss: 3595104.2222; train_gene_expr_recon_loss: 20840634.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9742302.4444; train_global_loss: 34371794.6667; train_optim_loss: 34371794.6667; val_kl_reg_loss: 183491.6094; val_edge_recon_loss: 4026500.5000; val_gene_expr_recon_loss: 20773028.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9570531.0000; val_global_loss: 34553552.0000; val_optim_loss: 34553552.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8827; val_auprc_score: 0.8632; val_best_acc_score: 0.8038; val_best_f1_score: 0.8111; train_kl_reg_loss: 197543.8681; train_edge_recon_loss: 3578804.8611; train_gene_expr_recon_loss: 20844310.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9735574.1111; train_global_loss: 34356232.8889; train_optim_loss: 34356232.8889; val_kl_reg_loss: 155299.2969; val_edge_recon_loss: 4011583.7500; val_gene_expr_recon_loss: 20776922.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9565061.0000; val_global_loss: 34508864.0000; val_optim_loss: 34508864.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8867; val_auprc_score: 0.8705; val_best_acc_score: 0.8069; val_best_f1_score: 0.8048; train_kl_reg_loss: 184720.4028; train_edge_recon_loss: 3580830.4444; train_gene_expr_recon_loss: 20606712.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9680702.5556; train_global_loss: 34052965.7778; train_optim_loss: 34052965.7778; val_kl_reg_loss: 178778.1875; val_edge_recon_loss: 3992495.2500; val_gene_expr_recon_loss: 20743066.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9567627.0000; val_global_loss: 34481968.0000; val_optim_loss: 34481968.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8896; val_auprc_score: 0.8719; val_best_acc_score: 0.7976; val_best_f1_score: 0.7868; train_kl_reg_loss: 187484.1476; train_edge_recon_loss: 3565477.0556; train_gene_expr_recon_loss: 20661305.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9701641.0000; train_global_loss: 34115908.0000; train_optim_loss: 34115908.0000; val_kl_reg_loss: 148498.0000; val_edge_recon_loss: 3970366.5000; val_gene_expr_recon_loss: 20707662.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9548191.0000; val_global_loss: 34374716.0000; val_optim_loss: 34374716.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8900; val_auprc_score: 0.8694; val_best_acc_score: 0.7817; val_best_f1_score: 0.8025; train_kl_reg_loss: 176317.2847; train_edge_recon_loss: 3561980.9722; train_gene_expr_recon_loss: 20642299.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9692456.1111; train_global_loss: 34073053.7778; train_optim_loss: 34073053.7778; val_kl_reg_loss: 156873.0156; val_edge_recon_loss: 3939062.2500; val_gene_expr_recon_loss: 20673746.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9531945.0000; val_global_loss: 34301628.0000; val_optim_loss: 34301628.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8964; val_auprc_score: 0.8802; val_best_acc_score: 0.8002; val_best_f1_score: 0.8227; train_kl_reg_loss: 174818.5781; train_edge_recon_loss: 3544479.6389; train_gene_expr_recon_loss: 20673213.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9685349.0000; train_global_loss: 34077861.3333; train_optim_loss: 34077861.3333; val_kl_reg_loss: 149118.0938; val_edge_recon_loss: 3888060.2500; val_gene_expr_recon_loss: 20648962.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9525654.0000; val_global_loss: 34211792.0000; val_optim_loss: 34211792.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8985; val_auprc_score: 0.8849; val_best_acc_score: 0.8161; val_best_f1_score: 0.8295; train_kl_reg_loss: 166866.7222; train_edge_recon_loss: 3529883.2778; train_gene_expr_recon_loss: 20696751.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9694864.2222; train_global_loss: 34088365.3333; train_optim_loss: 34088365.3333; val_kl_reg_loss: 140267.5938; val_edge_recon_loss: 3838801.7500; val_gene_expr_recon_loss: 20631652.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9517438.0000; val_global_loss: 34128160.0000; val_optim_loss: 34128160.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8976; val_auprc_score: 0.8793; val_best_acc_score: 0.8181; val_best_f1_score: 0.8261; train_kl_reg_loss: 161182.5104; train_edge_recon_loss: 3511430.0000; train_gene_expr_recon_loss: 20674190.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9693898.7778; train_global_loss: 34040702.8889; train_optim_loss: 34040702.8889; val_kl_reg_loss: 137429.4688; val_edge_recon_loss: 3776255.2500; val_gene_expr_recon_loss: 20617424.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9523689.0000; val_global_loss: 34054796.0000; val_optim_loss: 34054796.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9023; val_auprc_score: 0.8850; val_best_acc_score: 0.8248; val_best_f1_score: 0.8334; train_kl_reg_loss: 156058.4115; train_edge_recon_loss: 3479915.9167; train_gene_expr_recon_loss: 20576183.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9651839.1111; train_global_loss: 33863996.6667; train_optim_loss: 33863996.6667; val_kl_reg_loss: 129303.6484; val_edge_recon_loss: 3670336.0000; val_gene_expr_recon_loss: 20592432.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9505914.0000; val_global_loss: 33897984.0000; val_optim_loss: 33897984.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9005; val_auprc_score: 0.8856; val_best_acc_score: 0.8185; val_best_f1_score: 0.8304; train_kl_reg_loss: 147050.4062; train_edge_recon_loss: 3439222.4444; train_gene_expr_recon_loss: 20392918.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9607462.4444; train_global_loss: 33586653.5556; train_optim_loss: 33586653.5556; val_kl_reg_loss: 128532.7656; val_edge_recon_loss: 3560915.5000; val_gene_expr_recon_loss: 20561050.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9488218.0000; val_global_loss: 33738716.0000; val_optim_loss: 33738716.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9181; val_auprc_score: 0.8994; val_best_acc_score: 0.8191; val_best_f1_score: 0.8404; train_kl_reg_loss: 142147.9549; train_edge_recon_loss: 3715260.3611; train_gene_expr_recon_loss: 21079461.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9687227.6667; train_global_loss: 34624097.3333; train_optim_loss: 34624097.3333; val_kl_reg_loss: 55991.2656; val_edge_recon_loss: 3874549.7500; val_gene_expr_recon_loss: 21170920.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9556375.0000; val_global_loss: 34657836.0000; val_optim_loss: 34657836.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9047; val_auprc_score: 0.8895; val_best_acc_score: 0.8278; val_best_f1_score: 0.8299; train_kl_reg_loss: 80511.7817; train_edge_recon_loss: 3807065.0833; train_gene_expr_recon_loss: 21437930.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9703077.0000; train_global_loss: 35028584.4444; train_optim_loss: 35028584.4444; val_kl_reg_loss: 37981.9727; val_edge_recon_loss: 3979243.2500; val_gene_expr_recon_loss: 21363362.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9566019.0000; val_global_loss: 34946608.0000; val_optim_loss: 34946608.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8808; val_auprc_score: 0.8690; val_best_acc_score: 0.7595; val_best_f1_score: 0.7959; train_kl_reg_loss: 48355.9206; train_edge_recon_loss: 3851619.0833; train_gene_expr_recon_loss: 21470893.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9772050.0000; train_global_loss: 35142918.2222; train_optim_loss: 35142918.2222; val_kl_reg_loss: 43236.4336; val_edge_recon_loss: 4032852.2500; val_gene_expr_recon_loss: 21175718.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9547956.0000; val_global_loss: 34799760.0000; val_optim_loss: 34799760.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8902; val_auprc_score: 0.8841; val_best_acc_score: 0.7316; val_best_f1_score: 0.7801; train_kl_reg_loss: 57190.4293; train_edge_recon_loss: 3829464.9444; train_gene_expr_recon_loss: 21118377.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9690358.8889; train_global_loss: 34695391.1111; train_optim_loss: 34695391.1111; val_kl_reg_loss: 42943.0859; val_edge_recon_loss: 4043530.5000; val_gene_expr_recon_loss: 21084352.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9538832.0000; val_global_loss: 34709656.0000; val_optim_loss: 34709656.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8852; val_auprc_score: 0.8731; val_best_acc_score: 0.7266; val_best_f1_score: 0.7774; train_kl_reg_loss: 47082.5286; train_edge_recon_loss: 3847808.1667; train_gene_expr_recon_loss: 21120521.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9686950.4444; train_global_loss: 34702364.0000; train_optim_loss: 34702364.0000; val_kl_reg_loss: 45200.3047; val_edge_recon_loss: 4043001.2500; val_gene_expr_recon_loss: 21018820.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9521803.0000; val_global_loss: 34628824.0000; val_optim_loss: 34628824.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8808; val_auprc_score: 0.8653; val_best_acc_score: 0.7129; val_best_f1_score: 0.7692; train_kl_reg_loss: 56561.8242; train_edge_recon_loss: 3790359.6944; train_gene_expr_recon_loss: 21144805.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9726272.7778; train_global_loss: 34718000.4444; train_optim_loss: 34718000.4444; val_kl_reg_loss: 54461.9961; val_edge_recon_loss: 4045294.0000; val_gene_expr_recon_loss: 20966742.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9536470.0000; val_global_loss: 34602968.0000; val_optim_loss: 34602968.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8914; val_auprc_score: 0.8840; val_best_acc_score: 0.7320; val_best_f1_score: 0.7812; train_kl_reg_loss: 58309.3498; train_edge_recon_loss: 3792758.5000; train_gene_expr_recon_loss: 21036625.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9700198.1111; train_global_loss: 34587892.0000; train_optim_loss: 34587892.0000; val_kl_reg_loss: 52532.0000; val_edge_recon_loss: 4044239.0000; val_gene_expr_recon_loss: 20929402.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9516843.0000; val_global_loss: 34543016.0000; val_optim_loss: 34543016.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8896; val_auprc_score: 0.8766; val_best_acc_score: 0.7365; val_best_f1_score: 0.7840; train_kl_reg_loss: 60037.6120; train_edge_recon_loss: 3797827.5833; train_gene_expr_recon_loss: 20901983.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9684544.2222; train_global_loss: 34444392.8889; train_optim_loss: 34444392.8889; val_kl_reg_loss: 57503.2812; val_edge_recon_loss: 4041924.7500; val_gene_expr_recon_loss: 20939574.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9524136.0000; val_global_loss: 34563136.0000; val_optim_loss: 34563136.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 34 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9127
Val AUPRC score: 0.8945
Val best accuracy score: 0.8246
Val best F1 score: 0.8421
Val gene expr MSE score: 0.4679
Val chrom access MSE score: 0.0853
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
