[True, False, True]
Run timestamp: 06102023_193048_26.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', '960', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100.0', '--lambda_l1_addon', '100.0', '--edge_batch_size', '512', '--node_batch_size', '256', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_26']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2325.
Number of gene programs after filtering and combining: 1858.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1613, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1613, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 631979
Number of validation nodes: 70220
Number of training edges: 1492281
Number of validation edges: 165809
Edge batch size: 512
Node batch size: 256

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8976; val_auprc_score: 0.9830; val_best_acc_score: 0.9186; val_best_f1_score: 0.9552; train_kl_reg_loss: 31097.3039; train_edge_recon_loss: 6369037.9368; train_gene_expr_recon_loss: 26351109.4998; train_masked_gp_l1_reg_loss: 68331.6078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159107.9274; train_global_loss: 32978684.2943; train_optim_loss: 32978684.2943; val_kl_reg_loss: 34758.6034; val_edge_recon_loss: 6486522.8596; val_gene_expr_recon_loss: 23406551.7654; val_masked_gp_l1_reg_loss: 94320.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136747.8594; val_global_loss: 30158901.2346; val_optim_loss: 30158901.2346
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9068; val_auprc_score: 0.9845; val_best_acc_score: 0.9245; val_best_f1_score: 0.9584; train_kl_reg_loss: 39769.7614; train_edge_recon_loss: 6212427.2721; train_gene_expr_recon_loss: 22442815.5774; train_masked_gp_l1_reg_loss: 99538.6893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130590.7563; train_global_loss: 28925142.0638; train_optim_loss: 28925142.0638; val_kl_reg_loss: 46142.6473; val_edge_recon_loss: 6423365.2130; val_gene_expr_recon_loss: 21783745.2099; val_masked_gp_l1_reg_loss: 96791.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123720.0781; val_global_loss: 28473765.0802; val_optim_loss: 28473765.0802
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9133; val_auprc_score: 0.9858; val_best_acc_score: 0.9251; val_best_f1_score: 0.9586; train_kl_reg_loss: 50987.9647; train_edge_recon_loss: 6155607.4734; train_gene_expr_recon_loss: 21430599.8539; train_masked_gp_l1_reg_loss: 93367.3196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118801.7373; train_global_loss: 27849364.3499; train_optim_loss: 27849364.3499; val_kl_reg_loss: 56206.0906; val_edge_recon_loss: 6398401.7901; val_gene_expr_recon_loss: 21204050.7593; val_masked_gp_l1_reg_loss: 90450.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114861.3750; val_global_loss: 27863970.5556; val_optim_loss: 27863970.5556
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9048; val_auprc_score: 0.9840; val_best_acc_score: 0.9236; val_best_f1_score: 0.9578; train_kl_reg_loss: 818737034671.1193; train_edge_recon_loss: 6216540.5530; train_gene_expr_recon_loss: 22796156.2353; train_masked_gp_l1_reg_loss: 148702.1001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125248.9329; train_global_loss: 818766310978.4302; train_optim_loss: 818766310978.4302; val_kl_reg_loss: 40911.8394; val_edge_recon_loss: 6445769.4028; val_gene_expr_recon_loss: 22966800.1111; val_masked_gp_l1_reg_loss: 220942.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133308.3281; val_global_loss: 29807731.3642; val_optim_loss: 29807731.3642
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9196; val_auprc_score: 0.9867; val_best_acc_score: 0.9287; val_best_f1_score: 0.9607; train_kl_reg_loss: 59090.2023; train_edge_recon_loss: 6178192.5324; train_gene_expr_recon_loss: 21689386.0220; train_masked_gp_l1_reg_loss: 153132.0640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112475.4265; train_global_loss: 28192276.2395; train_optim_loss: 28192276.2395; val_kl_reg_loss: 67510.9927; val_edge_recon_loss: 6407019.6929; val_gene_expr_recon_loss: 21212169.1790; val_masked_gp_l1_reg_loss: 112724.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102931.2344; val_global_loss: 27902355.9074; val_optim_loss: 27902355.9074
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9207; val_auprc_score: 0.9869; val_best_acc_score: 0.9301; val_best_f1_score: 0.9613; train_kl_reg_loss: 464483.9456; train_edge_recon_loss: 6157806.7018; train_gene_expr_recon_loss: 21089459.9904; train_masked_gp_l1_reg_loss: 96502.6393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100131.5672; train_global_loss: 27908384.8467; train_optim_loss: 27908384.8467; val_kl_reg_loss: 83885.8708; val_edge_recon_loss: 6412672.4475; val_gene_expr_recon_loss: 21147488.9198; val_masked_gp_l1_reg_loss: 85145.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97347.7969; val_global_loss: 27826541.2099; val_optim_loss: 27826541.2099
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9235; val_auprc_score: 0.9874; val_best_acc_score: 0.9299; val_best_f1_score: 0.9612; train_kl_reg_loss: 82755.2449; train_edge_recon_loss: 6150589.3702; train_gene_expr_recon_loss: 20896908.4096; train_masked_gp_l1_reg_loss: 78835.2225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96438.1466; train_global_loss: 27305526.3753; train_optim_loss: 27305526.3753; val_kl_reg_loss: 83595.7871; val_edge_recon_loss: 6471621.6728; val_gene_expr_recon_loss: 20858537.2346; val_masked_gp_l1_reg_loss: 76386.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95888.5000; val_global_loss: 27586028.6543; val_optim_loss: 27586028.6543
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9263; val_auprc_score: 0.9883; val_best_acc_score: 0.9327; val_best_f1_score: 0.9627; train_kl_reg_loss: 1140134.6648; train_edge_recon_loss: 6169800.7304; train_gene_expr_recon_loss: 20803633.3626; train_masked_gp_l1_reg_loss: 75477.7298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95415.9344; train_global_loss: 28284462.3849; train_optim_loss: 28284462.3849; val_kl_reg_loss: 93090.6059; val_edge_recon_loss: 6373534.5262; val_gene_expr_recon_loss: 20801110.0000; val_masked_gp_l1_reg_loss: 74996.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94962.1484; val_global_loss: 27437693.1790; val_optim_loss: 27437693.1790
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9250; val_auprc_score: 0.9879; val_best_acc_score: 0.9305; val_best_f1_score: 0.9616; train_kl_reg_loss: 125326.4599; train_edge_recon_loss: 6155223.4121; train_gene_expr_recon_loss: 20716368.7499; train_masked_gp_l1_reg_loss: 73057.2005; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94409.7461; train_global_loss: 27164385.5444; train_optim_loss: 27164385.5444; val_kl_reg_loss: 96518.8244; val_edge_recon_loss: 6411295.4900; val_gene_expr_recon_loss: 20758315.7099; val_masked_gp_l1_reg_loss: 72492.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93837.0156; val_global_loss: 27432460.0617; val_optim_loss: 27432460.0617
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9208; val_auprc_score: 0.9867; val_best_acc_score: 0.9304; val_best_f1_score: 0.9615; train_kl_reg_loss: 30268776180329.3789; train_edge_recon_loss: 6242065.7727; train_gene_expr_recon_loss: 23575114.1654; train_masked_gp_l1_reg_loss: 153050.8012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136499.7843; train_global_loss: 30268806272451.0859; train_optim_loss: 30268806272451.0859; val_kl_reg_loss: 92741.2963; val_edge_recon_loss: 6467707.5741; val_gene_expr_recon_loss: 21050827.1481; val_masked_gp_l1_reg_loss: 115791.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120961.1172; val_global_loss: 27848030.0247; val_optim_loss: 27848030.0247
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9240; val_auprc_score: 0.9874; val_best_acc_score: 0.9309; val_best_f1_score: 0.9618; train_kl_reg_loss: 709155.2470; train_edge_recon_loss: 6163706.9292; train_gene_expr_recon_loss: 20882346.9290; train_masked_gp_l1_reg_loss: 92971.5143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106096.5807; train_global_loss: 27954277.1897; train_optim_loss: 27954277.1897; val_kl_reg_loss: 108446.8084; val_edge_recon_loss: 6493668.0895; val_gene_expr_recon_loss: 20813763.2654; val_masked_gp_l1_reg_loss: 80049.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96237.2578; val_global_loss: 27592166.2284; val_optim_loss: 27592166.2284
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9268; val_auprc_score: 0.9881; val_best_acc_score: 0.9322; val_best_f1_score: 0.9624; train_kl_reg_loss: 108481.9614; train_edge_recon_loss: 6146831.0316; train_gene_expr_recon_loss: 20692543.8854; train_masked_gp_l1_reg_loss: 73898.9717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92536.6187; train_global_loss: 27114292.4864; train_optim_loss: 27114292.4864; val_kl_reg_loss: 110669.2043; val_edge_recon_loss: 6466290.3904; val_gene_expr_recon_loss: 20696134.1605; val_masked_gp_l1_reg_loss: 70240.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90555.2891; val_global_loss: 27433889.7407; val_optim_loss: 27433889.7407
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8949; val_auprc_score: 0.9820; val_best_acc_score: 0.9175; val_best_f1_score: 0.9545; train_kl_reg_loss: 33268350.4138; train_edge_recon_loss: 6276596.9696; train_gene_expr_recon_loss: 24498581.0127; train_masked_gp_l1_reg_loss: 82545.7199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100263.9682; train_global_loss: 64226337.1190; train_optim_loss: 64226337.1190; val_kl_reg_loss: 74623295739.3630; val_edge_recon_loss: 6685525.1204; val_gene_expr_recon_loss: 25269477.2654; val_masked_gp_l1_reg_loss: 261789.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 218416.9219; val_global_loss: 74655730742.9877; val_optim_loss: 74655730742.9877

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9116; val_auprc_score: 0.9849; val_best_acc_score: 0.9267; val_best_f1_score: 0.9595; train_kl_reg_loss: 2523224761065.3047; train_edge_recon_loss: 6325642.7479; train_gene_expr_recon_loss: 23774123.5410; train_masked_gp_l1_reg_loss: 243798.6434; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 203788.5064; train_global_loss: 2523255297367.3696; train_optim_loss: 2523255297367.3696; val_kl_reg_loss: 75604.2472; val_edge_recon_loss: 6461261.4630; val_gene_expr_recon_loss: 22647971.9198; val_masked_gp_l1_reg_loss: 222492.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 187395.0156; val_global_loss: 29594725.6667; val_optim_loss: 29594725.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9215; val_auprc_score: 0.9869; val_best_acc_score: 0.9312; val_best_f1_score: 0.9620; train_kl_reg_loss: 86721.5257; train_edge_recon_loss: 6163782.4783; train_gene_expr_recon_loss: 21762910.7108; train_masked_gp_l1_reg_loss: 194289.8208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169289.9666; train_global_loss: 28376994.5235; train_optim_loss: 28376994.5235; val_kl_reg_loss: 95712.7997; val_edge_recon_loss: 6384802.6019; val_gene_expr_recon_loss: 21219672.0185; val_masked_gp_l1_reg_loss: 165879.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152395.3594; val_global_loss: 28018463.5000; val_optim_loss: 28018463.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9276; val_auprc_score: 0.9879; val_best_acc_score: 0.9329; val_best_f1_score: 0.9628; train_kl_reg_loss: 99003.4684; train_edge_recon_loss: 6140597.4652; train_gene_expr_recon_loss: 20892604.5509; train_masked_gp_l1_reg_loss: 140778.0284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139347.3292; train_global_loss: 27412330.8288; train_optim_loss: 27412330.8288; val_kl_reg_loss: 101438.9459; val_edge_recon_loss: 6459716.7639; val_gene_expr_recon_loss: 20771991.9815; val_masked_gp_l1_reg_loss: 117470.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128570.7500; val_global_loss: 27579187.7284; val_optim_loss: 27579187.7284
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9280; val_auprc_score: 0.9883; val_best_acc_score: 0.9336; val_best_f1_score: 0.9632; train_kl_reg_loss: 102741.3660; train_edge_recon_loss: 6160389.2689; train_gene_expr_recon_loss: 20598681.5595; train_masked_gp_l1_reg_loss: 98130.0607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121054.1471; train_global_loss: 27080996.4014; train_optim_loss: 27080996.4014; val_kl_reg_loss: 103352.1398; val_edge_recon_loss: 6405348.6991; val_gene_expr_recon_loss: 20592421.6975; val_masked_gp_l1_reg_loss: 81384.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114804.5781; val_global_loss: 27297310.4938; val_optim_loss: 27297310.4938
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9277; val_auprc_score: 0.9881; val_best_acc_score: 0.9332; val_best_f1_score: 0.9630; train_kl_reg_loss: 103567.9901; train_edge_recon_loss: 6138400.2141; train_gene_expr_recon_loss: 20455162.4226; train_masked_gp_l1_reg_loss: 70143.8573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110050.4688; train_global_loss: 26877324.9523; train_optim_loss: 26877324.9523; val_kl_reg_loss: 103409.3726; val_edge_recon_loss: 6421815.9892; val_gene_expr_recon_loss: 20486617.5926; val_masked_gp_l1_reg_loss: 61664.9727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105854.1719; val_global_loss: 27179360.9506; val_optim_loss: 27179360.9506
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9282; val_auprc_score: 0.9883; val_best_acc_score: 0.9336; val_best_f1_score: 0.9632; train_kl_reg_loss: 102790.4816; train_edge_recon_loss: 6135877.1598; train_gene_expr_recon_loss: 20368586.8686; train_masked_gp_l1_reg_loss: 57700.9466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102517.2090; train_global_loss: 26767472.6779; train_optim_loss: 26767472.6779; val_kl_reg_loss: 102691.1779; val_edge_recon_loss: 6396805.2176; val_gene_expr_recon_loss: 20427668.5617; val_masked_gp_l1_reg_loss: 54854.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99453.0938; val_global_loss: 27081472.9321; val_optim_loss: 27081472.9321
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9316; val_auprc_score: 0.9888; val_best_acc_score: 0.9346; val_best_f1_score: 0.9637; train_kl_reg_loss: 102113.7612; train_edge_recon_loss: 6133774.8455; train_gene_expr_recon_loss: 20306906.2744; train_masked_gp_l1_reg_loss: 53357.2988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96807.0413; train_global_loss: 26692959.1801; train_optim_loss: 26692959.1801; val_kl_reg_loss: 101765.5437; val_edge_recon_loss: 6438780.8194; val_gene_expr_recon_loss: 20353272.5556; val_masked_gp_l1_reg_loss: 52055.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94365.5859; val_global_loss: 27040240.9198; val_optim_loss: 27040240.9198
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9302; val_auprc_score: 0.9887; val_best_acc_score: 0.9346; val_best_f1_score: 0.9638; train_kl_reg_loss: 101862.7479; train_edge_recon_loss: 6148852.2279; train_gene_expr_recon_loss: 20257303.5877; train_masked_gp_l1_reg_loss: 51255.9969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92206.0392; train_global_loss: 26651480.5914; train_optim_loss: 26651480.5914; val_kl_reg_loss: 101298.6238; val_edge_recon_loss: 6405074.4398; val_gene_expr_recon_loss: 20325689.4877; val_masked_gp_l1_reg_loss: 50380.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90198.1328; val_global_loss: 26972640.5926; val_optim_loss: 26972640.5926
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9322; val_auprc_score: 0.9890; val_best_acc_score: 0.9349; val_best_f1_score: 0.9638; train_kl_reg_loss: 552837.4230; train_edge_recon_loss: 6141527.5997; train_gene_expr_recon_loss: 20219560.2230; train_masked_gp_l1_reg_loss: 49917.4878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88439.8843; train_global_loss: 27052282.6065; train_optim_loss: 27052282.6065; val_kl_reg_loss: 101471.9633; val_edge_recon_loss: 6418844.0139; val_gene_expr_recon_loss: 20298166.8704; val_masked_gp_l1_reg_loss: 49402.1133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86831.2500; val_global_loss: 26954716.8827; val_optim_loss: 26954716.8827
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9310; val_auprc_score: 0.9888; val_best_acc_score: 0.9355; val_best_f1_score: 0.9642; train_kl_reg_loss: 104743.5053; train_edge_recon_loss: 6142744.2483; train_gene_expr_recon_loss: 20186666.7019; train_masked_gp_l1_reg_loss: 49122.2703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85445.3279; train_global_loss: 26568722.0549; train_optim_loss: 26568722.0549; val_kl_reg_loss: 100036.5282; val_edge_recon_loss: 6407219.4799; val_gene_expr_recon_loss: 20271397.4074; val_masked_gp_l1_reg_loss: 48718.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84141.0000; val_global_loss: 26911512.5679; val_optim_loss: 26911512.5679
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9321; val_auprc_score: 0.9890; val_best_acc_score: 0.9357; val_best_f1_score: 0.9643; train_kl_reg_loss: 100407.7694; train_edge_recon_loss: 6120177.8845; train_gene_expr_recon_loss: 20166907.4827; train_masked_gp_l1_reg_loss: 48594.1758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82933.4637; train_global_loss: 26519020.7993; train_optim_loss: 26519020.7993; val_kl_reg_loss: 100057.1391; val_edge_recon_loss: 6410362.6096; val_gene_expr_recon_loss: 20240192.7099; val_masked_gp_l1_reg_loss: 48394.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81831.1797; val_global_loss: 26880838.4630; val_optim_loss: 26880838.4630
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9332; val_auprc_score: 0.9892; val_best_acc_score: 0.9355; val_best_f1_score: 0.9643; train_kl_reg_loss: 99855.4284; train_edge_recon_loss: 6136746.2596; train_gene_expr_recon_loss: 20157543.1039; train_masked_gp_l1_reg_loss: 48225.3650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80819.7704; train_global_loss: 26523189.9197; train_optim_loss: 26523189.9197; val_kl_reg_loss: 100117.8189; val_edge_recon_loss: 6408997.2948; val_gene_expr_recon_loss: 20224557.8395; val_masked_gp_l1_reg_loss: 47954.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79861.5781; val_global_loss: 26861488.9444; val_optim_loss: 26861488.9444
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9294; val_auprc_score: 0.9884; val_best_acc_score: 0.9350; val_best_f1_score: 0.9640; train_kl_reg_loss: 90155.6716; train_edge_recon_loss: 6155372.7812; train_gene_expr_recon_loss: 18138824.5111; train_masked_gp_l1_reg_loss: 42242.6672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84696.2102; train_global_loss: 24511291.8600; train_optim_loss: 24511291.8600; val_kl_reg_loss: 34362.8201; val_edge_recon_loss: 6418610.9954; val_gene_expr_recon_loss: 17924084.2716; val_masked_gp_l1_reg_loss: 39307.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82973.0078; val_global_loss: 24499340.0926; val_optim_loss: 24499340.0926
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9288; val_auprc_score: 0.9883; val_best_acc_score: 0.9345; val_best_f1_score: 0.9637; train_kl_reg_loss: 78932.8896; train_edge_recon_loss: 6136657.7045; train_gene_expr_recon_loss: 17816312.1743; train_masked_gp_l1_reg_loss: 35935.2813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81483.9031; train_global_loss: 24149321.9376; train_optim_loss: 24149321.9376; val_kl_reg_loss: 33424.9254; val_edge_recon_loss: 6356447.0247; val_gene_expr_recon_loss: 17782759.1420; val_masked_gp_l1_reg_loss: 31871.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80416.8516; val_global_loss: 24284919.1173; val_optim_loss: 24284919.1173
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9298; val_auprc_score: 0.9883; val_best_acc_score: 0.9347; val_best_f1_score: 0.9639; train_kl_reg_loss: 68496.2673; train_edge_recon_loss: 6144818.7770; train_gene_expr_recon_loss: 17716992.5839; train_masked_gp_l1_reg_loss: 26036.7391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79922.1316; train_global_loss: 24036266.4851; train_optim_loss: 24036266.4851; val_kl_reg_loss: 33216.9637; val_edge_recon_loss: 6370870.4722; val_gene_expr_recon_loss: 17705021.6235; val_masked_gp_l1_reg_loss: 19556.5371; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79321.2812; val_global_loss: 24207987.1111; val_optim_loss: 24207987.1111
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9294; val_auprc_score: 0.9884; val_best_acc_score: 0.9347; val_best_f1_score: 0.9638; train_kl_reg_loss: 60670.0888; train_edge_recon_loss: 6122158.6744; train_gene_expr_recon_loss: 17651242.9877; train_masked_gp_l1_reg_loss: 14192.7838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78861.4348; train_global_loss: 23927125.9630; train_optim_loss: 23927125.9630; val_kl_reg_loss: 33551.1020; val_edge_recon_loss: 6371186.5787; val_gene_expr_recon_loss: 17659972.5154; val_masked_gp_l1_reg_loss: 9710.8916; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78423.2031; val_global_loss: 24152844.2346; val_optim_loss: 24152844.2346
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9298; val_auprc_score: 0.9885; val_best_acc_score: 0.9355; val_best_f1_score: 0.9643; train_kl_reg_loss: 55159.3072; train_edge_recon_loss: 6130961.2916; train_gene_expr_recon_loss: 17606059.7455; train_masked_gp_l1_reg_loss: 8284.3673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77970.3985; train_global_loss: 23878435.1184; train_optim_loss: 23878435.1184; val_kl_reg_loss: 34063.9579; val_edge_recon_loss: 6350706.0108; val_gene_expr_recon_loss: 17610681.8179; val_masked_gp_l1_reg_loss: 8027.1787; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77607.3594; val_global_loss: 24081087.7037; val_optim_loss: 24081087.7037
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9296; val_auprc_score: 0.9883; val_best_acc_score: 0.9356; val_best_f1_score: 0.9642; train_kl_reg_loss: 52789.4479; train_edge_recon_loss: 6124667.3648; train_gene_expr_recon_loss: 17550454.7671; train_masked_gp_l1_reg_loss: 8169.8388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77306.9385; train_global_loss: 23813388.3719; train_optim_loss: 23813388.3719; val_kl_reg_loss: 34189.1276; val_edge_recon_loss: 6417457.6296; val_gene_expr_recon_loss: 17569417.0617; val_masked_gp_l1_reg_loss: 8310.7354; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77014.4844; val_global_loss: 24106387.8148; val_optim_loss: 24106387.8148
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9301; val_auprc_score: 0.9884; val_best_acc_score: 0.9349; val_best_f1_score: 0.9639; train_kl_reg_loss: 51023.8031; train_edge_recon_loss: 6120431.8395; train_gene_expr_recon_loss: 17515762.7925; train_masked_gp_l1_reg_loss: 8424.6915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76657.6442; train_global_loss: 23772300.7623; train_optim_loss: 23772300.7623; val_kl_reg_loss: 33857.9668; val_edge_recon_loss: 6421788.4660; val_gene_expr_recon_loss: 17540426.2253; val_masked_gp_l1_reg_loss: 8551.3916; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76405.7891; val_global_loss: 24081030.5926; val_optim_loss: 24081030.5926
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9288; val_auprc_score: 0.9883; val_best_acc_score: 0.9361; val_best_f1_score: 0.9646; train_kl_reg_loss: 50353.9543; train_edge_recon_loss: 6128347.9420; train_gene_expr_recon_loss: 17460652.6398; train_masked_gp_l1_reg_loss: 8652.6668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76212.8417; train_global_loss: 23724220.0213; train_optim_loss: 23724220.0213; val_kl_reg_loss: 33544.8323; val_edge_recon_loss: 6331419.6667; val_gene_expr_recon_loss: 17480963.9784; val_masked_gp_l1_reg_loss: 8758.1611; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76027.6953; val_global_loss: 23930714.5494; val_optim_loss: 23930714.5494
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9306; val_auprc_score: 0.9885; val_best_acc_score: 0.9367; val_best_f1_score: 0.9649; train_kl_reg_loss: 50314.4144; train_edge_recon_loss: 6123663.9823; train_gene_expr_recon_loss: 17424736.0696; train_masked_gp_l1_reg_loss: 8833.2880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75830.7494; train_global_loss: 23683378.4700; train_optim_loss: 23683378.4700; val_kl_reg_loss: 33421.0196; val_edge_recon_loss: 6347141.2932; val_gene_expr_recon_loss: 17448560.5401; val_masked_gp_l1_reg_loss: 8907.5957; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75677.4141; val_global_loss: 23913708.8827; val_optim_loss: 23913708.8827
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9309; val_auprc_score: 0.9885; val_best_acc_score: 0.9365; val_best_f1_score: 0.9647; train_kl_reg_loss: 52668.0107; train_edge_recon_loss: 6133541.9284; train_gene_expr_recon_loss: 17399178.8408; train_masked_gp_l1_reg_loss: 8980.9375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75533.7937; train_global_loss: 23669903.5293; train_optim_loss: 23669903.5293; val_kl_reg_loss: 33399.8962; val_edge_recon_loss: 6410956.4506; val_gene_expr_recon_loss: 17421584.2932; val_masked_gp_l1_reg_loss: 9039.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75454.2812; val_global_loss: 23950434.6235; val_optim_loss: 23950434.6235
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9324; val_auprc_score: 0.9889; val_best_acc_score: 0.9375; val_best_f1_score: 0.9653; train_kl_reg_loss: 49477.4562; train_edge_recon_loss: 6127159.0613; train_gene_expr_recon_loss: 17372917.3554; train_masked_gp_l1_reg_loss: 9098.4967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75251.9307; train_global_loss: 23633904.3225; train_optim_loss: 23633904.3225; val_kl_reg_loss: 33812.6224; val_edge_recon_loss: 6348268.7037; val_gene_expr_recon_loss: 17375038.1821; val_masked_gp_l1_reg_loss: 9163.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75105.5938; val_global_loss: 23841389.5247; val_optim_loss: 23841389.5247
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9319; val_auprc_score: 0.9888; val_best_acc_score: 0.9377; val_best_f1_score: 0.9655; train_kl_reg_loss: 49524.9998; train_edge_recon_loss: 6122723.2366; train_gene_expr_recon_loss: 17354602.9695; train_masked_gp_l1_reg_loss: 9217.9839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74999.6848; train_global_loss: 23611068.8322; train_optim_loss: 23611068.8322; val_kl_reg_loss: 34824.9777; val_edge_recon_loss: 6309161.0887; val_gene_expr_recon_loss: 17359936.4506; val_masked_gp_l1_reg_loss: 9281.6025; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74963.5781; val_global_loss: 23788168.5432; val_optim_loss: 23788168.5432
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9322; val_auprc_score: 0.9887; val_best_acc_score: 0.9374; val_best_f1_score: 0.9653; train_kl_reg_loss: 49423.8115; train_edge_recon_loss: 6112699.9056; train_gene_expr_recon_loss: 17328371.2185; train_masked_gp_l1_reg_loss: 9319.3567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74811.9993; train_global_loss: 23574626.2930; train_optim_loss: 23574626.2930; val_kl_reg_loss: 35679.1003; val_edge_recon_loss: 6344859.0370; val_gene_expr_recon_loss: 17355418.7809; val_masked_gp_l1_reg_loss: 9352.0137; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74707.2578; val_global_loss: 23820016.8827; val_optim_loss: 23820016.8827
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9335; val_auprc_score: 0.9891; val_best_acc_score: 0.9375; val_best_f1_score: 0.9653; train_kl_reg_loss: 49031.5342; train_edge_recon_loss: 6123362.0880; train_gene_expr_recon_loss: 17311409.7760; train_masked_gp_l1_reg_loss: 9407.4688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74639.8929; train_global_loss: 23567850.7952; train_optim_loss: 23567850.7952; val_kl_reg_loss: 35873.0591; val_edge_recon_loss: 6372931.7778; val_gene_expr_recon_loss: 17333246.2191; val_masked_gp_l1_reg_loss: 9447.7520; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74547.5625; val_global_loss: 23826047.0864; val_optim_loss: 23826047.0864
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9337; val_auprc_score: 0.9890; val_best_acc_score: 0.9372; val_best_f1_score: 0.9651; train_kl_reg_loss: 48600.5542; train_edge_recon_loss: 6106845.3130; train_gene_expr_recon_loss: 17296216.6154; train_masked_gp_l1_reg_loss: 9501.6069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74508.9446; train_global_loss: 23535673.0456; train_optim_loss: 23535673.0456; val_kl_reg_loss: 36255.4242; val_edge_recon_loss: 6368377.8519; val_gene_expr_recon_loss: 17314060.8642; val_masked_gp_l1_reg_loss: 9537.8799; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74344.1797; val_global_loss: 23802576.1481; val_optim_loss: 23802576.1481
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9316; val_auprc_score: 0.9886; val_best_acc_score: 0.9364; val_best_f1_score: 0.9648; train_kl_reg_loss: 48956.3632; train_edge_recon_loss: 6106334.8045; train_gene_expr_recon_loss: 17278817.5026; train_masked_gp_l1_reg_loss: 9579.5879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74292.3123; train_global_loss: 23517980.5921; train_optim_loss: 23517980.5921; val_kl_reg_loss: 37261.4127; val_edge_recon_loss: 6393537.9969; val_gene_expr_recon_loss: 17310968.4722; val_masked_gp_l1_reg_loss: 9621.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74266.8906; val_global_loss: 23825655.8210; val_optim_loss: 23825655.8210

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9326; val_auprc_score: 0.9888; val_best_acc_score: 0.9372; val_best_f1_score: 0.9652; train_kl_reg_loss: 48988.3485; train_edge_recon_loss: 6112461.1882; train_gene_expr_recon_loss: 17259964.8408; train_masked_gp_l1_reg_loss: 9529.5052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73105.5986; train_global_loss: 23504049.3407; train_optim_loss: 23504049.3407; val_kl_reg_loss: 37002.9677; val_edge_recon_loss: 6387016.0833; val_gene_expr_recon_loss: 17295100.7315; val_masked_gp_l1_reg_loss: 9532.2373; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72659.4375; val_global_loss: 23801311.7716; val_optim_loss: 23801311.7716
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9333; val_auprc_score: 0.9892; val_best_acc_score: 0.9366; val_best_f1_score: 0.9648; train_kl_reg_loss: 48697.4441; train_edge_recon_loss: 6090659.8450; train_gene_expr_recon_loss: 17260328.6573; train_masked_gp_l1_reg_loss: 9538.8930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72537.2047; train_global_loss: 23481762.0089; train_optim_loss: 23481762.0089; val_kl_reg_loss: 37031.7549; val_edge_recon_loss: 6353548.2207; val_gene_expr_recon_loss: 17285603.4969; val_masked_gp_l1_reg_loss: 9545.9961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72451.7734; val_global_loss: 23758181.4753; val_optim_loss: 23758181.4753
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9333; val_auprc_score: 0.9889; val_best_acc_score: 0.9359; val_best_f1_score: 0.9645; train_kl_reg_loss: 48537.6033; train_edge_recon_loss: 6105900.4722; train_gene_expr_recon_loss: 17261181.7516; train_masked_gp_l1_reg_loss: 9551.3912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72401.6266; train_global_loss: 23497572.8679; train_optim_loss: 23497572.8679; val_kl_reg_loss: 36834.9180; val_edge_recon_loss: 6426842.8719; val_gene_expr_recon_loss: 17299924.6975; val_masked_gp_l1_reg_loss: 9554.9863; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72353.7578; val_global_loss: 23845510.4753; val_optim_loss: 23845510.4753
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9337; val_auprc_score: 0.9891; val_best_acc_score: 0.9380; val_best_f1_score: 0.9656; train_kl_reg_loss: 48408.7859; train_edge_recon_loss: 6116732.4807; train_gene_expr_recon_loss: 17257419.0003; train_masked_gp_l1_reg_loss: 9561.3723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72327.4822; train_global_loss: 23504449.2144; train_optim_loss: 23504449.2144; val_kl_reg_loss: 36893.0505; val_edge_recon_loss: 6327259.2932; val_gene_expr_recon_loss: 17298030.8920; val_masked_gp_l1_reg_loss: 9568.2764; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72305.5547; val_global_loss: 23744057.3086; val_optim_loss: 23744057.3086
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9325; val_auprc_score: 0.9888; val_best_acc_score: 0.9373; val_best_f1_score: 0.9652; train_kl_reg_loss: 48461.1013; train_edge_recon_loss: 6104879.8798; train_gene_expr_recon_loss: 17253351.0113; train_masked_gp_l1_reg_loss: 9572.2496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72280.1038; train_global_loss: 23488544.3492; train_optim_loss: 23488544.3492; val_kl_reg_loss: 36997.4645; val_edge_recon_loss: 6360581.8997; val_gene_expr_recon_loss: 17282323.7006; val_masked_gp_l1_reg_loss: 9577.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72253.7656; val_global_loss: 23761735.0370; val_optim_loss: 23761735.0370
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9340; val_auprc_score: 0.9893; val_best_acc_score: 0.9385; val_best_f1_score: 0.9659; train_kl_reg_loss: 48461.7250; train_edge_recon_loss: 6100938.6304; train_gene_expr_recon_loss: 17250782.8494; train_masked_gp_l1_reg_loss: 9582.1863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72229.9625; train_global_loss: 23481995.4340; train_optim_loss: 23481995.4340; val_kl_reg_loss: 37050.1848; val_edge_recon_loss: 6302209.4552; val_gene_expr_recon_loss: 17304126.2778; val_masked_gp_l1_reg_loss: 9587.3350; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72213.7812; val_global_loss: 23725187.8642; val_optim_loss: 23725187.8642
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9337; val_auprc_score: 0.9891; val_best_acc_score: 0.9374; val_best_f1_score: 0.9653; train_kl_reg_loss: 48836.1280; train_edge_recon_loss: 6116223.2390; train_gene_expr_recon_loss: 17246904.6298; train_masked_gp_l1_reg_loss: 9591.9634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72195.9275; train_global_loss: 23493751.9238; train_optim_loss: 23493751.9238; val_kl_reg_loss: 37024.0066; val_edge_recon_loss: 6384566.5849; val_gene_expr_recon_loss: 17279678.4383; val_masked_gp_l1_reg_loss: 9596.8145; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72172.0469; val_global_loss: 23783037.0802; val_optim_loss: 23783037.0802
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9350; val_auprc_score: 0.9892; val_best_acc_score: 0.9378; val_best_f1_score: 0.9655; train_kl_reg_loss: 48237.6229; train_edge_recon_loss: 6087550.3380; train_gene_expr_recon_loss: 17248606.6508; train_masked_gp_l1_reg_loss: 9603.1223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72151.2487; train_global_loss: 23466149.0545; train_optim_loss: 23466149.0545; val_kl_reg_loss: 36868.7501; val_edge_recon_loss: 6384389.7253; val_gene_expr_recon_loss: 17285212.6944; val_masked_gp_l1_reg_loss: 9611.2900; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72125.1953; val_global_loss: 23788209.1605; val_optim_loss: 23788209.1605
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9349; val_auprc_score: 0.9893; val_best_acc_score: 0.9380; val_best_f1_score: 0.9656; train_kl_reg_loss: 48257.2121; train_edge_recon_loss: 6089953.6657; train_gene_expr_recon_loss: 17244763.3877; train_masked_gp_l1_reg_loss: 9616.3971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72118.0381; train_global_loss: 23464708.7026; train_optim_loss: 23464708.7026; val_kl_reg_loss: 36952.3526; val_edge_recon_loss: 6329094.7052; val_gene_expr_recon_loss: 17280513.2222; val_masked_gp_l1_reg_loss: 9621.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72114.8281; val_global_loss: 23728296.2778; val_optim_loss: 23728296.2778
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9328; val_auprc_score: 0.9889; val_best_acc_score: 0.9369; val_best_f1_score: 0.9650; train_kl_reg_loss: 48120.4897; train_edge_recon_loss: 6099067.0062; train_gene_expr_recon_loss: 17248266.6425; train_masked_gp_l1_reg_loss: 9627.0996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72104.9438; train_global_loss: 23477186.1907; train_optim_loss: 23477186.1907; val_kl_reg_loss: 37090.0382; val_edge_recon_loss: 6420799.2099; val_gene_expr_recon_loss: 17275999.2685; val_masked_gp_l1_reg_loss: 9631.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72100.3672; val_global_loss: 23815620.5123; val_optim_loss: 23815620.5123

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9331; val_auprc_score: 0.9889; val_best_acc_score: 0.9373; val_best_f1_score: 0.9653; train_kl_reg_loss: 48235.8069; train_edge_recon_loss: 6089735.1837; train_gene_expr_recon_loss: 17244817.2947; train_masked_gp_l1_reg_loss: 9622.3038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71991.7975; train_global_loss: 23464402.1269; train_optim_loss: 23464402.1269; val_kl_reg_loss: 37033.6501; val_edge_recon_loss: 6356901.3657; val_gene_expr_recon_loss: 17277136.8920; val_masked_gp_l1_reg_loss: 9622.4258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71936.1719; val_global_loss: 23752629.8765; val_optim_loss: 23752629.8765
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9342; val_auprc_score: 0.9890; val_best_acc_score: 0.9366; val_best_f1_score: 0.9648; train_kl_reg_loss: 48218.2194; train_edge_recon_loss: 6110540.3533; train_gene_expr_recon_loss: 17244842.9595; train_masked_gp_l1_reg_loss: 9622.6551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71909.7303; train_global_loss: 23485133.4902; train_optim_loss: 23485133.4902; val_kl_reg_loss: 37048.1337; val_edge_recon_loss: 6462720.7022; val_gene_expr_recon_loss: 17287822.7994; val_masked_gp_l1_reg_loss: 9623.1514; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71889.1328; val_global_loss: 23869105.7099; val_optim_loss: 23869105.7099
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9347; val_auprc_score: 0.9892; val_best_acc_score: 0.9379; val_best_f1_score: 0.9656; train_kl_reg_loss: 48210.5962; train_edge_recon_loss: 6103358.3130; train_gene_expr_recon_loss: 17244758.4364; train_masked_gp_l1_reg_loss: 9623.4378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71874.3778; train_global_loss: 23477825.7688; train_optim_loss: 23477825.7688; val_kl_reg_loss: 37028.0814; val_edge_recon_loss: 6336010.8241; val_gene_expr_recon_loss: 17273431.4907; val_masked_gp_l1_reg_loss: 9623.8936; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71861.1172; val_global_loss: 23727956.3889; val_optim_loss: 23727956.3889
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9330; val_auprc_score: 0.9888; val_best_acc_score: 0.9363; val_best_f1_score: 0.9646; train_kl_reg_loss: 48181.8378; train_edge_recon_loss: 6093269.1715; train_gene_expr_recon_loss: 17242256.2916; train_masked_gp_l1_reg_loss: 9624.2878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71853.2276; train_global_loss: 23465184.5605; train_optim_loss: 23465184.5605; val_kl_reg_loss: 37036.6736; val_edge_recon_loss: 6431330.8349; val_gene_expr_recon_loss: 17274148.1049; val_masked_gp_l1_reg_loss: 9624.7988; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71844.8125; val_global_loss: 23823983.5741; val_optim_loss: 23823983.5741

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 912 min 55 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9343
val AUPRC score: 0.9891
val best accuracy score: 0.9374
val best F1 score: 0.9653
val target rna MSE score: 0.3874
val source rna MSE score: 0.1777
Val cat covariate0 mean sim diff: -0.0007
Val cat covariate1 mean sim diff: -0.0603
Val cat covariate2 mean sim diff: -0.0001

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
