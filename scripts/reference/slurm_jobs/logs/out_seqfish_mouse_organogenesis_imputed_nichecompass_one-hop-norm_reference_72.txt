[True]
Run timestamp: 08082023_062105_72.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_72']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 5399 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 5399, n_cat_covariates_embed_input: 0, n_hidden: 1847, n_latent: 1797, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1797, n_addon_gp_input: 50, n_cat_covariates_embed_input: 3, n_output: 5399

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9208; val_auprc_score: 0.9842; val_best_acc_score: 0.8558; val_best_f1_score: 0.9223; train_kl_reg_loss: 209484.3253; train_edge_recon_loss: 1141431.5373; train_gene_expr_recon_loss: 4302981.8510; train_masked_gp_l1_reg_loss: 21390.0008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176894.5203; train_global_loss: 5852182.1923; train_optim_loss: 5852182.1923; val_kl_reg_loss: 284870.6667; val_edge_recon_loss: 1176082.2812; val_gene_expr_recon_loss: 2587013.8542; val_masked_gp_l1_reg_loss: 21705.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168780.7656; val_global_loss: 4238453.7292; val_optim_loss: 4238453.7292
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9156; val_auprc_score: 0.9830; val_best_acc_score: 0.8548; val_best_f1_score: 0.9217; train_kl_reg_loss: 210717.0906; train_edge_recon_loss: 1157831.6617; train_gene_expr_recon_loss: 2842510.1683; train_masked_gp_l1_reg_loss: 20966.3159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 157808.6191; train_global_loss: 4389833.8317; train_optim_loss: 4389833.8317; val_kl_reg_loss: 234308.1497; val_edge_recon_loss: 1177937.5104; val_gene_expr_recon_loss: 2527579.0625; val_masked_gp_l1_reg_loss: 20428.7480; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146403.3125; val_global_loss: 4106656.7083; val_optim_loss: 4106656.7083
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9135; val_auprc_score: 0.9826; val_best_acc_score: 0.8527; val_best_f1_score: 0.9205; train_kl_reg_loss: 156507.3960; train_edge_recon_loss: 1140326.3059; train_gene_expr_recon_loss: 2756934.7308; train_masked_gp_l1_reg_loss: 20122.0505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135163.8853; train_global_loss: 4209054.3822; train_optim_loss: 4209054.3822; val_kl_reg_loss: 180786.2370; val_edge_recon_loss: 1195578.8646; val_gene_expr_recon_loss: 2492221.2708; val_masked_gp_l1_reg_loss: 19945.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124337.5938; val_global_loss: 4012869.4167; val_optim_loss: 4012869.4167
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9101; val_auprc_score: 0.9824; val_best_acc_score: 0.8532; val_best_f1_score: 0.9208; train_kl_reg_loss: 97793.2008; train_edge_recon_loss: 1097308.6725; train_gene_expr_recon_loss: 2484750.4639; train_masked_gp_l1_reg_loss: 19893.9635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115062.3516; train_global_loss: 3814808.6442; train_optim_loss: 3814808.6442; val_kl_reg_loss: 84411.9167; val_edge_recon_loss: 1198015.2917; val_gene_expr_recon_loss: 2376382.9792; val_masked_gp_l1_reg_loss: 19951.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106315.0000; val_global_loss: 3785076.9167; val_optim_loss: 3785076.9167
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9003; val_auprc_score: 0.9802; val_best_acc_score: 0.8516; val_best_f1_score: 0.9198; train_kl_reg_loss: 80238.4984; train_edge_recon_loss: 1081292.0469; train_gene_expr_recon_loss: 2314274.5000; train_masked_gp_l1_reg_loss: 19907.5245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98637.2015; train_global_loss: 3594349.7716; train_optim_loss: 3594349.7716; val_kl_reg_loss: 73072.9414; val_edge_recon_loss: 1205910.3125; val_gene_expr_recon_loss: 2249356.1458; val_masked_gp_l1_reg_loss: 19813.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91360.8516; val_global_loss: 3639513.7083; val_optim_loss: 3639513.7083
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8880; val_auprc_score: 0.9778; val_best_acc_score: 0.8607; val_best_f1_score: 0.9246; train_kl_reg_loss: 72949.3267; train_edge_recon_loss: 1072772.4171; train_gene_expr_recon_loss: 2232743.1394; train_masked_gp_l1_reg_loss: 19600.2103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85167.6510; train_global_loss: 3483232.7548; train_optim_loss: 3483232.7548; val_kl_reg_loss: 64107.7640; val_edge_recon_loss: 1187925.3229; val_gene_expr_recon_loss: 2209772.9792; val_masked_gp_l1_reg_loss: 19398.8887; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79372.8594; val_global_loss: 3560577.7917; val_optim_loss: 3560577.7917
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8671; val_auprc_score: 0.9723; val_best_acc_score: 0.8722; val_best_f1_score: 0.9296; train_kl_reg_loss: 65942.3878; train_edge_recon_loss: 1063432.0577; train_gene_expr_recon_loss: 2194981.8005; train_masked_gp_l1_reg_loss: 19234.9146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74607.5696; train_global_loss: 3418198.7404; train_optim_loss: 3418198.7404; val_kl_reg_loss: 62913.8727; val_edge_recon_loss: 1187360.9375; val_gene_expr_recon_loss: 2174002.7083; val_masked_gp_l1_reg_loss: 19079.4258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70137.2422; val_global_loss: 3513494.2917; val_optim_loss: 3513494.2917
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8565; val_auprc_score: 0.9677; val_best_acc_score: 0.8880; val_best_f1_score: 0.9376; train_kl_reg_loss: 59600.7307; train_edge_recon_loss: 1058654.5216; train_gene_expr_recon_loss: 2161480.2476; train_masked_gp_l1_reg_loss: 18969.8758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66440.4864; train_global_loss: 3365145.8606; train_optim_loss: 3365145.8606; val_kl_reg_loss: 55907.2321; val_edge_recon_loss: 1167665.1250; val_gene_expr_recon_loss: 2141460.2083; val_masked_gp_l1_reg_loss: 18874.7285; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62931.8750; val_global_loss: 3446839.0833; val_optim_loss: 3446839.0833
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8621; val_auprc_score: 0.9663; val_best_acc_score: 0.8981; val_best_f1_score: 0.9426; train_kl_reg_loss: 52171.4987; train_edge_recon_loss: 1042168.2073; train_gene_expr_recon_loss: 2130241.7139; train_masked_gp_l1_reg_loss: 18855.6928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59845.6723; train_global_loss: 3303282.7644; train_optim_loss: 3303282.7644; val_kl_reg_loss: 49218.1562; val_edge_recon_loss: 1076866.9115; val_gene_expr_recon_loss: 2113121.9792; val_masked_gp_l1_reg_loss: 18897.8105; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56839.9023; val_global_loss: 3314944.7917; val_optim_loss: 3314944.7917
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8667; val_auprc_score: 0.9679; val_best_acc_score: 0.9016; val_best_f1_score: 0.9447; train_kl_reg_loss: 51847.2565; train_edge_recon_loss: 983210.0505; train_gene_expr_recon_loss: 2103056.7812; train_masked_gp_l1_reg_loss: 19056.8505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54165.5351; train_global_loss: 3211336.4639; train_optim_loss: 3211336.4639; val_kl_reg_loss: 56790.6589; val_edge_recon_loss: 977969.8385; val_gene_expr_recon_loss: 2087823.2188; val_masked_gp_l1_reg_loss: 19241.3184; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51575.8555; val_global_loss: 3193400.7292; val_optim_loss: 3193400.7292
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8670; val_auprc_score: 0.9679; val_best_acc_score: 0.9010; val_best_f1_score: 0.9444; train_kl_reg_loss: 58330.6346; train_edge_recon_loss: 950427.9585; train_gene_expr_recon_loss: 2075645.4267; train_masked_gp_l1_reg_loss: 19397.1070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49251.2711; train_global_loss: 3153052.4183; train_optim_loss: 3153052.4183; val_kl_reg_loss: 58548.5449; val_edge_recon_loss: 948658.9896; val_gene_expr_recon_loss: 2061538.6771; val_masked_gp_l1_reg_loss: 19547.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47046.1797; val_global_loss: 3135339.7292; val_optim_loss: 3135339.7292
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8634; val_auprc_score: 0.9681; val_best_acc_score: 0.9021; val_best_f1_score: 0.9448; train_kl_reg_loss: 57247.5020; train_edge_recon_loss: 932154.7554; train_gene_expr_recon_loss: 2051309.2825; train_masked_gp_l1_reg_loss: 19653.4608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45097.7118; train_global_loss: 3105462.7284; train_optim_loss: 3105462.7284; val_kl_reg_loss: 54696.5465; val_edge_recon_loss: 928336.9479; val_gene_expr_recon_loss: 2038431.0729; val_masked_gp_l1_reg_loss: 19753.8418; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43242.3359; val_global_loss: 3084460.5417; val_optim_loss: 3084460.5417
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8632; val_auprc_score: 0.9670; val_best_acc_score: 0.9027; val_best_f1_score: 0.9452; train_kl_reg_loss: 53504.7548; train_edge_recon_loss: 910152.3407; train_gene_expr_recon_loss: 2028312.3726; train_masked_gp_l1_reg_loss: 19822.2892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41647.0951; train_global_loss: 3053438.8510; train_optim_loss: 3053438.8510; val_kl_reg_loss: 51671.0876; val_edge_recon_loss: 935108.7188; val_gene_expr_recon_loss: 2015309.0521; val_masked_gp_l1_reg_loss: 19882.8613; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40114.2500; val_global_loss: 3062085.8750; val_optim_loss: 3062085.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8666; val_auprc_score: 0.9688; val_best_acc_score: 0.9075; val_best_f1_score: 0.9481; train_kl_reg_loss: 49954.4482; train_edge_recon_loss: 908046.2476; train_gene_expr_recon_loss: 2006016.8726; train_masked_gp_l1_reg_loss: 19914.1750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38771.7396; train_global_loss: 3022703.4976; train_optim_loss: 3022703.4976; val_kl_reg_loss: 47846.7158; val_edge_recon_loss: 901899.5573; val_gene_expr_recon_loss: 1994552.7604; val_masked_gp_l1_reg_loss: 19932.9277; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37460.0312; val_global_loss: 3001692.0208; val_optim_loss: 3001692.0208
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8659; val_auprc_score: 0.9681; val_best_acc_score: 0.9093; val_best_f1_score: 0.9491; train_kl_reg_loss: 46114.3519; train_edge_recon_loss: 890271.6526; train_gene_expr_recon_loss: 1984706.9615; train_masked_gp_l1_reg_loss: 19933.3252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36282.2798; train_global_loss: 2977308.5601; train_optim_loss: 2977308.5601; val_kl_reg_loss: 44555.8770; val_edge_recon_loss: 897719.6771; val_gene_expr_recon_loss: 1972187.6042; val_masked_gp_l1_reg_loss: 19917.4082; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35115.0234; val_global_loss: 2969495.6042; val_optim_loss: 2969495.6042
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8659; val_auprc_score: 0.9682; val_best_acc_score: 0.9101; val_best_f1_score: 0.9494; train_kl_reg_loss: 42273.4924; train_edge_recon_loss: 882714.6929; train_gene_expr_recon_loss: 1963244.2993; train_masked_gp_l1_reg_loss: 19879.3517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34039.3393; train_global_loss: 2942151.1779; train_optim_loss: 2942151.1779; val_kl_reg_loss: 40346.9163; val_edge_recon_loss: 899871.0833; val_gene_expr_recon_loss: 1952157.6667; val_masked_gp_l1_reg_loss: 19828.8496; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32987.6602; val_global_loss: 2945192.1667; val_optim_loss: 2945192.1667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8725; val_auprc_score: 0.9691; val_best_acc_score: 0.9122; val_best_f1_score: 0.9504; train_kl_reg_loss: 39134.3355; train_edge_recon_loss: 880799.3383; train_gene_expr_recon_loss: 1943278.3365; train_masked_gp_l1_reg_loss: 19757.9837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32043.3231; train_global_loss: 2915013.3029; train_optim_loss: 2915013.3029; val_kl_reg_loss: 37331.8350; val_edge_recon_loss: 893887.2969; val_gene_expr_recon_loss: 1931593.2500; val_masked_gp_l1_reg_loss: 19679.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31150.7617; val_global_loss: 2913642.3750; val_optim_loss: 2913642.3750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8791; val_auprc_score: 0.9706; val_best_acc_score: 0.9186; val_best_f1_score: 0.9540; train_kl_reg_loss: 36484.0959; train_edge_recon_loss: 869901.8119; train_gene_expr_recon_loss: 1922148.9327; train_masked_gp_l1_reg_loss: 19577.1133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30398.5346; train_global_loss: 2878510.4808; train_optim_loss: 2878510.4808; val_kl_reg_loss: 35252.7327; val_edge_recon_loss: 865857.3229; val_gene_expr_recon_loss: 1911238.7500; val_masked_gp_l1_reg_loss: 19461.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29706.3047; val_global_loss: 2861516.8333; val_optim_loss: 2861516.8333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8894; val_auprc_score: 0.9738; val_best_acc_score: 0.9178; val_best_f1_score: 0.9533; train_kl_reg_loss: 34321.1011; train_edge_recon_loss: 859162.7434; train_gene_expr_recon_loss: 1902362.9892; train_masked_gp_l1_reg_loss: 19324.8758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29104.0377; train_global_loss: 2844275.7428; train_optim_loss: 2844275.7428; val_kl_reg_loss: 33065.5630; val_edge_recon_loss: 865578.7760; val_gene_expr_recon_loss: 1893267.9167; val_masked_gp_l1_reg_loss: 19167.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28485.1191; val_global_loss: 2839564.5000; val_optim_loss: 2839564.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8935; val_auprc_score: 0.9757; val_best_acc_score: 0.9184; val_best_f1_score: 0.9539; train_kl_reg_loss: 32324.6229; train_edge_recon_loss: 849588.1665; train_gene_expr_recon_loss: 1883611.0204; train_masked_gp_l1_reg_loss: 18976.3359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27854.6858; train_global_loss: 2812354.8413; train_optim_loss: 2812354.8413; val_kl_reg_loss: 31123.1826; val_edge_recon_loss: 845299.7292; val_gene_expr_recon_loss: 1873255.3958; val_masked_gp_l1_reg_loss: 18768.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27197.3848; val_global_loss: 2795643.7917; val_optim_loss: 2795643.7917
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9065; val_auprc_score: 0.9795; val_best_acc_score: 0.9181; val_best_f1_score: 0.9536; train_kl_reg_loss: 29851.0263; train_edge_recon_loss: 839950.5607; train_gene_expr_recon_loss: 1866406.1635; train_masked_gp_l1_reg_loss: 18533.4213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26568.8702; train_global_loss: 2781310.0433; train_optim_loss: 2781310.0433; val_kl_reg_loss: 28668.8343; val_edge_recon_loss: 828734.2448; val_gene_expr_recon_loss: 1856136.8542; val_masked_gp_l1_reg_loss: 18285.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25949.7480; val_global_loss: 2757774.8958; val_optim_loss: 2757774.8958
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9146; val_auprc_score: 0.9813; val_best_acc_score: 0.9176; val_best_f1_score: 0.9532; train_kl_reg_loss: 27455.8704; train_edge_recon_loss: 839073.8834; train_gene_expr_recon_loss: 1850136.1767; train_masked_gp_l1_reg_loss: 18004.1306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25320.8001; train_global_loss: 2759990.8822; train_optim_loss: 2759990.8822; val_kl_reg_loss: 25713.2013; val_edge_recon_loss: 833670.2500; val_gene_expr_recon_loss: 1842214.5938; val_masked_gp_l1_reg_loss: 17702.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24738.0449; val_global_loss: 2744038.7500; val_optim_loss: 2744038.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9241; val_auprc_score: 0.9828; val_best_acc_score: 0.9235; val_best_f1_score: 0.9561; train_kl_reg_loss: 24890.5330; train_edge_recon_loss: 829205.6538; train_gene_expr_recon_loss: 1835109.9050; train_masked_gp_l1_reg_loss: 17388.7773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24211.8085; train_global_loss: 2730806.6731; train_optim_loss: 2730806.6731; val_kl_reg_loss: 23024.6286; val_edge_recon_loss: 845133.9427; val_gene_expr_recon_loss: 1826428.2500; val_masked_gp_l1_reg_loss: 17065.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23719.9492; val_global_loss: 2735372.2708; val_optim_loss: 2735372.2708
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9348; val_auprc_score: 0.9852; val_best_acc_score: 0.9302; val_best_f1_score: 0.9601; train_kl_reg_loss: 22835.3006; train_edge_recon_loss: 819575.4453; train_gene_expr_recon_loss: 1820476.4712; train_masked_gp_l1_reg_loss: 16731.1322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23286.4450; train_global_loss: 2702904.8029; train_optim_loss: 2702904.8029; val_kl_reg_loss: 21761.3472; val_edge_recon_loss: 822786.4271; val_gene_expr_recon_loss: 1812901.3438; val_masked_gp_l1_reg_loss: 16382.2021; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22889.3633; val_global_loss: 2696720.6042; val_optim_loss: 2696720.6042
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9415; val_auprc_score: 0.9868; val_best_acc_score: 0.9342; val_best_f1_score: 0.9622; train_kl_reg_loss: 21165.6058; train_edge_recon_loss: 814423.8239; train_gene_expr_recon_loss: 1806218.4195; train_masked_gp_l1_reg_loss: 16036.5881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22561.4926; train_global_loss: 2680405.9135; train_optim_loss: 2680405.9135; val_kl_reg_loss: 20130.5625; val_edge_recon_loss: 809671.1562; val_gene_expr_recon_loss: 1798832.4375; val_masked_gp_l1_reg_loss: 15682.1396; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22256.2402; val_global_loss: 2666572.6667; val_optim_loss: 2666572.6667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9430; val_auprc_score: 0.9871; val_best_acc_score: 0.9356; val_best_f1_score: 0.9630; train_kl_reg_loss: 18093.4681; train_edge_recon_loss: 820428.0763; train_gene_expr_recon_loss: 2443847.9183; train_masked_gp_l1_reg_loss: 15218.7325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19059.3130; train_global_loss: 3316647.5120; train_optim_loss: 3316647.5120; val_kl_reg_loss: 6744.3338; val_edge_recon_loss: 809283.3125; val_gene_expr_recon_loss: 2024463.9167; val_masked_gp_l1_reg_loss: 14657.8115; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16079.7305; val_global_loss: 2871229.0833; val_optim_loss: 2871229.0833
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9499; val_auprc_score: 0.9889; val_best_acc_score: 0.9395; val_best_f1_score: 0.9650; train_kl_reg_loss: 12917.6423; train_edge_recon_loss: 797402.2945; train_gene_expr_recon_loss: 1961116.9483; train_masked_gp_l1_reg_loss: 14084.3387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14052.9652; train_global_loss: 2799574.1947; train_optim_loss: 2799574.1947; val_kl_reg_loss: 5306.0243; val_edge_recon_loss: 797404.5625; val_gene_expr_recon_loss: 1923905.4062; val_masked_gp_l1_reg_loss: 13538.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12306.1318; val_global_loss: 2752461.2708; val_optim_loss: 2752461.2708
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9538; val_auprc_score: 0.9895; val_best_acc_score: 0.9442; val_best_f1_score: 0.9676; train_kl_reg_loss: 9209.0644; train_edge_recon_loss: 785017.9609; train_gene_expr_recon_loss: 1904849.2716; train_masked_gp_l1_reg_loss: 13075.2452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11036.5464; train_global_loss: 2723188.0865; train_optim_loss: 2723188.0865; val_kl_reg_loss: 3970.0824; val_edge_recon_loss: 782757.0729; val_gene_expr_recon_loss: 1890297.6354; val_masked_gp_l1_reg_loss: 12633.4082; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9904.1553; val_global_loss: 2699562.5208; val_optim_loss: 2699562.5208
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9628; val_auprc_score: 0.9918; val_best_acc_score: 0.9513; val_best_f1_score: 0.9718; train_kl_reg_loss: 6594.3539; train_edge_recon_loss: 781373.9651; train_gene_expr_recon_loss: 1880618.5697; train_masked_gp_l1_reg_loss: 12246.7530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9028.9791; train_global_loss: 2689862.6370; train_optim_loss: 2689862.6370; val_kl_reg_loss: 3468.9041; val_edge_recon_loss: 780806.2240; val_gene_expr_recon_loss: 1873481.4375; val_masked_gp_l1_reg_loss: 11864.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8231.6201; val_global_loss: 2677852.3125; val_optim_loss: 2677852.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9600; val_auprc_score: 0.9901; val_best_acc_score: 0.9511; val_best_f1_score: 0.9716; train_kl_reg_loss: 5873.2232; train_edge_recon_loss: 778234.0114; train_gene_expr_recon_loss: 1871759.6863; train_masked_gp_l1_reg_loss: 11789.6848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8036.6816; train_global_loss: 2675693.3077; train_optim_loss: 2675693.3077; val_kl_reg_loss: 3359.2638; val_edge_recon_loss: 797323.3698; val_gene_expr_recon_loss: 1869384.6250; val_masked_gp_l1_reg_loss: 11747.2373; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7951.6045; val_global_loss: 2689766.0208; val_optim_loss: 2689766.0208
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9633; val_auprc_score: 0.9917; val_best_acc_score: 0.9530; val_best_f1_score: 0.9727; train_kl_reg_loss: 5658.1599; train_edge_recon_loss: 783876.4796; train_gene_expr_recon_loss: 1869504.0120; train_masked_gp_l1_reg_loss: 11709.1213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7880.1735; train_global_loss: 2678627.9495; train_optim_loss: 2678627.9495; val_kl_reg_loss: 3290.7859; val_edge_recon_loss: 776105.3646; val_gene_expr_recon_loss: 1867770.5208; val_masked_gp_l1_reg_loss: 11669.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7806.3867; val_global_loss: 2666642.3958; val_optim_loss: 2666642.3958
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9632; val_auprc_score: 0.9918; val_best_acc_score: 0.9515; val_best_f1_score: 0.9720; train_kl_reg_loss: 5528.9674; train_edge_recon_loss: 778433.0559; train_gene_expr_recon_loss: 1868689.3341; train_masked_gp_l1_reg_loss: 11629.9621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7733.9771; train_global_loss: 2672015.2837; train_optim_loss: 2672015.2837; val_kl_reg_loss: 3251.2059; val_edge_recon_loss: 784962.3594; val_gene_expr_recon_loss: 1868067.3021; val_masked_gp_l1_reg_loss: 11589.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7659.7676; val_global_loss: 2675529.6250; val_optim_loss: 2675529.6250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9644; val_auprc_score: 0.9918; val_best_acc_score: 0.9534; val_best_f1_score: 0.9729; train_kl_reg_loss: 5399.1236; train_edge_recon_loss: 775719.1893; train_gene_expr_recon_loss: 1867184.7596; train_masked_gp_l1_reg_loss: 11548.2012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7585.8710; train_global_loss: 2667437.1322; train_optim_loss: 2667437.1322; val_kl_reg_loss: 3161.0474; val_edge_recon_loss: 786486.7135; val_gene_expr_recon_loss: 1866066.3854; val_masked_gp_l1_reg_loss: 11506.3760; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7510.4907; val_global_loss: 2674731.1458; val_optim_loss: 2674731.1458

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 92 min 22 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9409
val AUPRC score: 0.9868
val best accuracy score: 0.9353
val best F1 score: 0.9628
val target rna MSE score: 18.0461
val source rna MSE score: 126.1875
Val cat covariate0 mean sim diff: -0.0015

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
