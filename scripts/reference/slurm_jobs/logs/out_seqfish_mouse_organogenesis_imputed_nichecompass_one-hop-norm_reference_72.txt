[True]
Run timestamp: 26072023_234039_72.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_72']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8862; val_auprc_score: 0.9761; val_best_acc_score: 0.8508; val_best_f1_score: 0.9194; train_kl_reg_loss: 266396.2176; train_edge_recon_loss: 1153377.3686; train_gene_expr_recon_loss: 3578994.2523; train_masked_gp_l1_reg_loss: 13960.5255; train_group_lasso_reg_loss: 0.0000; train_global_loss: 5012728.3698; train_optim_loss: 5012728.3698; val_kl_reg_loss: 304147.1797; val_edge_recon_loss: 1212642.9427; val_gene_expr_recon_loss: 2852941.1979; val_masked_gp_l1_reg_loss: 14174.1875; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4383905.3333; val_optim_loss: 4383905.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8785; val_auprc_score: 0.9756; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 225377.9681; train_edge_recon_loss: 1155463.1602; train_gene_expr_recon_loss: 3249742.4733; train_masked_gp_l1_reg_loss: 14219.3089; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4644802.9186; train_optim_loss: 4644802.9186; val_kl_reg_loss: 83584.5407; val_edge_recon_loss: 1210602.6797; val_gene_expr_recon_loss: 2843996.9479; val_masked_gp_l1_reg_loss: 14919.1113; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4153103.2083; val_optim_loss: 4153103.2083
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8798; val_auprc_score: 0.9773; val_best_acc_score: 0.8671; val_best_f1_score: 0.9277; train_kl_reg_loss: 73320.1637; train_edge_recon_loss: 1092548.3881; train_gene_expr_recon_loss: 1984148.6709; train_masked_gp_l1_reg_loss: 15749.5092; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3165766.7326; train_optim_loss: 3165766.7326; val_kl_reg_loss: 55803.7507; val_edge_recon_loss: 1166921.7005; val_gene_expr_recon_loss: 1103837.9479; val_masked_gp_l1_reg_loss: 16406.3242; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2342969.6667; val_optim_loss: 2342969.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8434; val_auprc_score: 0.9674; val_best_acc_score: 0.8564; val_best_f1_score: 0.9217; train_kl_reg_loss: 58418.1083; train_edge_recon_loss: 1075765.3770; train_gene_expr_recon_loss: 1047622.0669; train_masked_gp_l1_reg_loss: 16507.3347; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2198312.8698; train_optim_loss: 2198312.8698; val_kl_reg_loss: 56789.1987; val_edge_recon_loss: 1225850.4714; val_gene_expr_recon_loss: 1016203.1589; val_masked_gp_l1_reg_loss: 16505.6074; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2315348.2917; val_optim_loss: 2315348.2917
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8358; val_auprc_score: 0.9643; val_best_acc_score: 0.8615; val_best_f1_score: 0.9237; train_kl_reg_loss: 51958.3484; train_edge_recon_loss: 1060783.6224; train_gene_expr_recon_loss: 1002362.7180; train_masked_gp_l1_reg_loss: 16515.1649; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2131619.8547; train_optim_loss: 2131619.8547; val_kl_reg_loss: 50258.8354; val_edge_recon_loss: 1187356.8385; val_gene_expr_recon_loss: 988059.1172; val_masked_gp_l1_reg_loss: 16572.0371; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2242246.7708; val_optim_loss: 2242246.7708
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8399; val_auprc_score: 0.9619; val_best_acc_score: 0.8810; val_best_f1_score: 0.9331; train_kl_reg_loss: 45151.5360; train_edge_recon_loss: 1035206.7180; train_gene_expr_recon_loss: 975092.8773; train_masked_gp_l1_reg_loss: 16711.5424; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2072162.6733; train_optim_loss: 2072162.6733; val_kl_reg_loss: 41235.0545; val_edge_recon_loss: 1083191.8802; val_gene_expr_recon_loss: 963886.9479; val_masked_gp_l1_reg_loss: 16916.9160; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2105230.8229; val_optim_loss: 2105230.8229
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8563; val_auprc_score: 0.9673; val_best_acc_score: 0.8862; val_best_f1_score: 0.9366; train_kl_reg_loss: 42670.6155; train_edge_recon_loss: 964823.7994; train_gene_expr_recon_loss: 953307.6407; train_masked_gp_l1_reg_loss: 17314.2025; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1978116.2494; train_optim_loss: 1978116.2494; val_kl_reg_loss: 45327.5905; val_edge_recon_loss: 936653.7396; val_gene_expr_recon_loss: 944219.0885; val_masked_gp_l1_reg_loss: 17758.7598; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1943959.1719; val_optim_loss: 1943959.1719
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8663; val_auprc_score: 0.9677; val_best_acc_score: 0.8931; val_best_f1_score: 0.9397; train_kl_reg_loss: 45397.4413; train_edge_recon_loss: 912563.7314; train_gene_expr_recon_loss: 928792.0619; train_masked_gp_l1_reg_loss: 18117.9711; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1904871.1948; train_optim_loss: 1904871.1948; val_kl_reg_loss: 41992.3993; val_edge_recon_loss: 925033.7500; val_gene_expr_recon_loss: 917792.8854; val_masked_gp_l1_reg_loss: 18426.3359; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1903245.4115; val_optim_loss: 1903245.4115
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8582; val_auprc_score: 0.9668; val_best_acc_score: 0.8974; val_best_f1_score: 0.9422; train_kl_reg_loss: 41051.1564; train_edge_recon_loss: 876459.2555; train_gene_expr_recon_loss: 906784.2625; train_masked_gp_l1_reg_loss: 18610.8221; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1842905.4942; train_optim_loss: 1842905.4942; val_kl_reg_loss: 36648.9272; val_edge_recon_loss: 891283.6042; val_gene_expr_recon_loss: 898203.9297; val_masked_gp_l1_reg_loss: 18741.8184; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1844878.3333; val_optim_loss: 1844878.3333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8762; val_auprc_score: 0.9709; val_best_acc_score: 0.9007; val_best_f1_score: 0.9438; train_kl_reg_loss: 35225.5506; train_edge_recon_loss: 860511.9250; train_gene_expr_recon_loss: 889241.1012; train_masked_gp_l1_reg_loss: 18793.3074; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1803771.8860; train_optim_loss: 1803771.8860; val_kl_reg_loss: 32220.1571; val_edge_recon_loss: 866610.4453; val_gene_expr_recon_loss: 882824.4167; val_masked_gp_l1_reg_loss: 18804.9434; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1800460.0104; val_optim_loss: 1800460.0104
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8851; val_auprc_score: 0.9732; val_best_acc_score: 0.9028; val_best_f1_score: 0.9449; train_kl_reg_loss: 30257.1714; train_edge_recon_loss: 843441.7884; train_gene_expr_recon_loss: 874645.6730; train_masked_gp_l1_reg_loss: 18706.4415; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1767051.0791; train_optim_loss: 1767051.0791; val_kl_reg_loss: 26514.8850; val_edge_recon_loss: 846666.9870; val_gene_expr_recon_loss: 869349.2995; val_masked_gp_l1_reg_loss: 18567.5586; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1761098.6667; val_optim_loss: 1761098.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8997; val_auprc_score: 0.9783; val_best_acc_score: 0.9062; val_best_f1_score: 0.9459; train_kl_reg_loss: 25816.9070; train_edge_recon_loss: 832014.7599; train_gene_expr_recon_loss: 860779.1590; train_masked_gp_l1_reg_loss: 18339.0951; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1736949.9209; train_optim_loss: 1736949.9209; val_kl_reg_loss: 22304.2168; val_edge_recon_loss: 826542.0417; val_gene_expr_recon_loss: 855508.4349; val_masked_gp_l1_reg_loss: 18059.2402; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1722413.9271; val_optim_loss: 1722413.9271
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8977; val_auprc_score: 0.9772; val_best_acc_score: 0.9120; val_best_f1_score: 0.9498; train_kl_reg_loss: 21641.0012; train_edge_recon_loss: 817725.2483; train_gene_expr_recon_loss: 848178.4695; train_masked_gp_l1_reg_loss: 17713.6189; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1705258.3372; train_optim_loss: 1705258.3372; val_kl_reg_loss: 18181.9003; val_edge_recon_loss: 818426.5260; val_gene_expr_recon_loss: 843490.0859; val_masked_gp_l1_reg_loss: 17358.2012; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1697456.7656; val_optim_loss: 1697456.7656
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9116; val_auprc_score: 0.9793; val_best_acc_score: 0.9242; val_best_f1_score: 0.9564; train_kl_reg_loss: 18268.4323; train_edge_recon_loss: 805896.5116; train_gene_expr_recon_loss: 835876.3375; train_masked_gp_l1_reg_loss: 16973.9347; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1677015.2145; train_optim_loss: 1677015.2145; val_kl_reg_loss: 16674.9884; val_edge_recon_loss: 817537.3984; val_gene_expr_recon_loss: 830728.5703; val_masked_gp_l1_reg_loss: 16581.0801; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1681522.0833; val_optim_loss: 1681522.0833
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9166; val_auprc_score: 0.9816; val_best_acc_score: 0.9261; val_best_f1_score: 0.9576; train_kl_reg_loss: 15878.4713; train_edge_recon_loss: 798951.3166; train_gene_expr_recon_loss: 823759.2404; train_masked_gp_l1_reg_loss: 16180.5120; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1654769.5442; train_optim_loss: 1654769.5442; val_kl_reg_loss: 14674.2463; val_edge_recon_loss: 800862.6797; val_gene_expr_recon_loss: 819255.2812; val_masked_gp_l1_reg_loss: 15774.7383; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1650566.9740; val_optim_loss: 1650566.9740
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9238; val_auprc_score: 0.9838; val_best_acc_score: 0.9256; val_best_f1_score: 0.9574; train_kl_reg_loss: 14582.6661; train_edge_recon_loss: 798799.7797; train_gene_expr_recon_loss: 812986.4794; train_masked_gp_l1_reg_loss: 15381.4532; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1641750.3791; train_optim_loss: 1641750.3791; val_kl_reg_loss: 13202.7518; val_edge_recon_loss: 797744.2474; val_gene_expr_recon_loss: 810317.4115; val_masked_gp_l1_reg_loss: 14989.5000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1636253.8958; val_optim_loss: 1636253.8958
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9260; val_auprc_score: 0.9841; val_best_acc_score: 0.9200; val_best_f1_score: 0.9541; train_kl_reg_loss: 12951.2214; train_edge_recon_loss: 791354.0395; train_gene_expr_recon_loss: 803357.3991; train_masked_gp_l1_reg_loss: 14624.5996; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1622287.2564; train_optim_loss: 1622287.2564; val_kl_reg_loss: 11785.5564; val_edge_recon_loss: 803812.4714; val_gene_expr_recon_loss: 801108.4036; val_masked_gp_l1_reg_loss: 14278.5723; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1630985.0521; val_optim_loss: 1630985.0521
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9385; val_auprc_score: 0.9862; val_best_acc_score: 0.9249; val_best_f1_score: 0.9567; train_kl_reg_loss: 11899.6355; train_edge_recon_loss: 793260.0869; train_gene_expr_recon_loss: 795513.5297; train_masked_gp_l1_reg_loss: 13947.6683; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1614620.9128; train_optim_loss: 1614620.9128; val_kl_reg_loss: 10771.5780; val_edge_recon_loss: 796298.9141; val_gene_expr_recon_loss: 793552.3542; val_masked_gp_l1_reg_loss: 13623.5352; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1614246.3333; val_optim_loss: 1614246.3333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9385; val_auprc_score: 0.9865; val_best_acc_score: 0.9258; val_best_f1_score: 0.9573; train_kl_reg_loss: 11152.7097; train_edge_recon_loss: 786544.9773; train_gene_expr_recon_loss: 787263.9177; train_masked_gp_l1_reg_loss: 13317.4141; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1598279.0221; train_optim_loss: 1598279.0221; val_kl_reg_loss: 10441.4196; val_edge_recon_loss: 791265.2630; val_gene_expr_recon_loss: 784273.7422; val_masked_gp_l1_reg_loss: 12990.9512; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1598971.4219; val_optim_loss: 1598971.4219
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9465; val_auprc_score: 0.9882; val_best_acc_score: 0.9292; val_best_f1_score: 0.9586; train_kl_reg_loss: 10925.5721; train_edge_recon_loss: 789032.5515; train_gene_expr_recon_loss: 779469.3206; train_masked_gp_l1_reg_loss: 12718.9507; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1592146.3919; train_optim_loss: 1592146.3919; val_kl_reg_loss: 10171.8422; val_edge_recon_loss: 810732.5312; val_gene_expr_recon_loss: 777692.1068; val_masked_gp_l1_reg_loss: 12423.1885; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1611019.7396; val_optim_loss: 1611019.7396
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9513; val_auprc_score: 0.9890; val_best_acc_score: 0.9364; val_best_f1_score: 0.9632; train_kl_reg_loss: 10809.4900; train_edge_recon_loss: 782496.8564; train_gene_expr_recon_loss: 772455.9297; train_masked_gp_l1_reg_loss: 12143.9762; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1577906.2500; train_optim_loss: 1577906.2500; val_kl_reg_loss: 10146.2955; val_edge_recon_loss: 778182.8698; val_gene_expr_recon_loss: 771188.4089; val_masked_gp_l1_reg_loss: 11878.3066; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1571395.8229; val_optim_loss: 1571395.8229
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9425; val_auprc_score: 0.9872; val_best_acc_score: 0.9325; val_best_f1_score: 0.9607; train_kl_reg_loss: 10713.7504; train_edge_recon_loss: 785049.9439; train_gene_expr_recon_loss: 765816.7881; train_masked_gp_l1_reg_loss: 11622.5583; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1573203.0419; train_optim_loss: 1573203.0419; val_kl_reg_loss: 11534.8984; val_edge_recon_loss: 804684.1562; val_gene_expr_recon_loss: 766262.2448; val_masked_gp_l1_reg_loss: 11357.7324; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1593839.0312; val_optim_loss: 1593839.0312
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9495; val_auprc_score: 0.9886; val_best_acc_score: 0.9402; val_best_f1_score: 0.9654; train_kl_reg_loss: 10839.1111; train_edge_recon_loss: 775233.5343; train_gene_expr_recon_loss: 760281.7672; train_masked_gp_l1_reg_loss: 11126.9851; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1557481.3983; train_optim_loss: 1557481.3983; val_kl_reg_loss: 10365.3229; val_edge_recon_loss: 799320.1406; val_gene_expr_recon_loss: 759703.9844; val_masked_gp_l1_reg_loss: 10903.4297; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1580292.8229; val_optim_loss: 1580292.8229
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9500; val_auprc_score: 0.9886; val_best_acc_score: 0.9352; val_best_f1_score: 0.9624; train_kl_reg_loss: 10935.7716; train_edge_recon_loss: 775059.6125; train_gene_expr_recon_loss: 754552.6846; train_masked_gp_l1_reg_loss: 10669.7189; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1551217.7901; train_optim_loss: 1551217.7901; val_kl_reg_loss: 10585.5903; val_edge_recon_loss: 789046.1745; val_gene_expr_recon_loss: 754065.1094; val_masked_gp_l1_reg_loss: 10439.5957; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1564136.5000; val_optim_loss: 1564136.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9461; val_auprc_score: 0.9881; val_best_acc_score: 0.9374; val_best_f1_score: 0.9640; train_kl_reg_loss: 11079.6848; train_edge_recon_loss: 781236.4988; train_gene_expr_recon_loss: 749419.6439; train_masked_gp_l1_reg_loss: 10240.9344; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1551976.7727; train_optim_loss: 1551976.7727; val_kl_reg_loss: 11074.6260; val_edge_recon_loss: 783560.2786; val_gene_expr_recon_loss: 748481.3229; val_masked_gp_l1_reg_loss: 10040.3965; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1553156.6198; val_optim_loss: 1553156.6198
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9488; val_auprc_score: 0.9883; val_best_acc_score: 0.9399; val_best_f1_score: 0.9654; train_kl_reg_loss: 10034.5828; train_edge_recon_loss: 773790.5349; train_gene_expr_recon_loss: 750448.1529; train_masked_gp_l1_reg_loss: 9997.3802; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1544270.6547; train_optim_loss: 1544270.6547; val_kl_reg_loss: 5727.0342; val_edge_recon_loss: 790479.3255; val_gene_expr_recon_loss: 750459.0182; val_masked_gp_l1_reg_loss: 9905.4053; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1556570.7552; val_optim_loss: 1556570.7552
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9523; val_auprc_score: 0.9889; val_best_acc_score: 0.9411; val_best_f1_score: 0.9659; train_kl_reg_loss: 9098.5361; train_edge_recon_loss: 772901.8360; train_gene_expr_recon_loss: 746036.0910; train_masked_gp_l1_reg_loss: 9803.0140; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1537839.4826; train_optim_loss: 1537839.4826; val_kl_reg_loss: 4844.5717; val_edge_recon_loss: 794439.2318; val_gene_expr_recon_loss: 745593.2995; val_masked_gp_l1_reg_loss: 9718.7354; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1554595.8385; val_optim_loss: 1554595.8385
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9487; val_auprc_score: 0.9879; val_best_acc_score: 0.9419; val_best_f1_score: 0.9663; train_kl_reg_loss: 8353.0644; train_edge_recon_loss: 767263.9767; train_gene_expr_recon_loss: 742091.9741; train_masked_gp_l1_reg_loss: 9606.0746; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1527315.0942; train_optim_loss: 1527315.0942; val_kl_reg_loss: 4738.3597; val_edge_recon_loss: 794829.1536; val_gene_expr_recon_loss: 743039.9245; val_masked_gp_l1_reg_loss: 9507.9453; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1552115.4427; val_optim_loss: 1552115.4427
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9581; val_auprc_score: 0.9901; val_best_acc_score: 0.9463; val_best_f1_score: 0.9688; train_kl_reg_loss: 8096.0704; train_edge_recon_loss: 771238.3657; train_gene_expr_recon_loss: 740117.1567; train_masked_gp_l1_reg_loss: 9326.1532; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1528777.7436; train_optim_loss: 1528777.7436; val_kl_reg_loss: 4592.5622; val_edge_recon_loss: 779325.6771; val_gene_expr_recon_loss: 740654.4583; val_masked_gp_l1_reg_loss: 9194.1748; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1533766.8438; val_optim_loss: 1533766.8438
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9527; val_auprc_score: 0.9885; val_best_acc_score: 0.9416; val_best_f1_score: 0.9662; train_kl_reg_loss: 7782.3639; train_edge_recon_loss: 779575.6858; train_gene_expr_recon_loss: 737181.6015; train_masked_gp_l1_reg_loss: 9097.4392; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1533637.0936; train_optim_loss: 1533637.0936; val_kl_reg_loss: 4512.6180; val_edge_recon_loss: 800435.1875; val_gene_expr_recon_loss: 738890.9297; val_masked_gp_l1_reg_loss: 9027.5967; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1552866.3802; val_optim_loss: 1552866.3802
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9601; val_auprc_score: 0.9917; val_best_acc_score: 0.9474; val_best_f1_score: 0.9696; train_kl_reg_loss: 7647.7538; train_edge_recon_loss: 774515.1291; train_gene_expr_recon_loss: 734409.1096; train_masked_gp_l1_reg_loss: 8930.0455; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1525502.0465; train_optim_loss: 1525502.0465; val_kl_reg_loss: 4600.1098; val_edge_recon_loss: 762611.9167; val_gene_expr_recon_loss: 735384.9479; val_masked_gp_l1_reg_loss: 8858.5586; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1511455.4688; val_optim_loss: 1511455.4688
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9588; val_auprc_score: 0.9902; val_best_acc_score: 0.9482; val_best_f1_score: 0.9700; train_kl_reg_loss: 7421.5616; train_edge_recon_loss: 766954.8375; train_gene_expr_recon_loss: 731438.3544; train_masked_gp_l1_reg_loss: 8753.5042; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1514568.2581; train_optim_loss: 1514568.2581; val_kl_reg_loss: 4493.6909; val_edge_recon_loss: 774898.4297; val_gene_expr_recon_loss: 732367.1771; val_masked_gp_l1_reg_loss: 8642.8652; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1520402.1823; val_optim_loss: 1520402.1823
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9598; val_auprc_score: 0.9910; val_best_acc_score: 0.9486; val_best_f1_score: 0.9701; train_kl_reg_loss: 7217.8515; train_edge_recon_loss: 775711.6235; train_gene_expr_recon_loss: 728975.9788; train_masked_gp_l1_reg_loss: 8552.5375; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1520457.9930; train_optim_loss: 1520457.9930; val_kl_reg_loss: 4547.0756; val_edge_recon_loss: 799950.7969; val_gene_expr_recon_loss: 730119.9505; val_masked_gp_l1_reg_loss: 8448.6895; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1543066.5625; val_optim_loss: 1543066.5625
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9624; val_auprc_score: 0.9915; val_best_acc_score: 0.9529; val_best_f1_score: 0.9726; train_kl_reg_loss: 7118.7283; train_edge_recon_loss: 764780.3363; train_gene_expr_recon_loss: 726423.2395; train_masked_gp_l1_reg_loss: 8394.4688; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1506716.7773; train_optim_loss: 1506716.7773; val_kl_reg_loss: 4715.7986; val_edge_recon_loss: 782916.4036; val_gene_expr_recon_loss: 728924.2292; val_masked_gp_l1_reg_loss: 8306.7539; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1524863.1823; val_optim_loss: 1524863.1823
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9626; val_auprc_score: 0.9915; val_best_acc_score: 0.9536; val_best_f1_score: 0.9732; train_kl_reg_loss: 7021.4711; train_edge_recon_loss: 770109.4738; train_gene_expr_recon_loss: 724366.6596; train_masked_gp_l1_reg_loss: 8209.5775; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1509707.1802; train_optim_loss: 1509707.1802; val_kl_reg_loss: 4725.1892; val_edge_recon_loss: 754568.3880; val_gene_expr_recon_loss: 724675.4245; val_masked_gp_l1_reg_loss: 8129.0601; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1492098.0104; val_optim_loss: 1492098.0104
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9631; val_auprc_score: 0.9910; val_best_acc_score: 0.9499; val_best_f1_score: 0.9709; train_kl_reg_loss: 6852.8103; train_edge_recon_loss: 764132.7244; train_gene_expr_recon_loss: 722541.6419; train_masked_gp_l1_reg_loss: 8056.3350; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1501583.5122; train_optim_loss: 1501583.5122; val_kl_reg_loss: 4739.9327; val_edge_recon_loss: 777516.8021; val_gene_expr_recon_loss: 724025.3646; val_masked_gp_l1_reg_loss: 7992.5303; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1514274.6094; val_optim_loss: 1514274.6094
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9560; val_auprc_score: 0.9900; val_best_acc_score: 0.9528; val_best_f1_score: 0.9728; train_kl_reg_loss: 6925.5056; train_edge_recon_loss: 764387.3096; train_gene_expr_recon_loss: 720732.6047; train_masked_gp_l1_reg_loss: 7910.3872; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1499955.8099; train_optim_loss: 1499955.8099; val_kl_reg_loss: 4824.2634; val_edge_recon_loss: 747672.2630; val_gene_expr_recon_loss: 722020.5521; val_masked_gp_l1_reg_loss: 7854.5166; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1482371.5677; val_optim_loss: 1482371.5677
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9636; val_auprc_score: 0.9915; val_best_acc_score: 0.9548; val_best_f1_score: 0.9737; train_kl_reg_loss: 6739.7737; train_edge_recon_loss: 767494.7122; train_gene_expr_recon_loss: 719108.0930; train_masked_gp_l1_reg_loss: 7760.6941; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1501103.2756; train_optim_loss: 1501103.2756; val_kl_reg_loss: 4812.6429; val_edge_recon_loss: 783669.1484; val_gene_expr_recon_loss: 721209.6745; val_masked_gp_l1_reg_loss: 7688.3813; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1517379.8490; val_optim_loss: 1517379.8490
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9608; val_auprc_score: 0.9898; val_best_acc_score: 0.9531; val_best_f1_score: 0.9728; train_kl_reg_loss: 6773.8702; train_edge_recon_loss: 771679.6276; train_gene_expr_recon_loss: 717708.1791; train_masked_gp_l1_reg_loss: 7598.4556; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1503760.1366; train_optim_loss: 1503760.1366; val_kl_reg_loss: 5217.9912; val_edge_recon_loss: 777854.7943; val_gene_expr_recon_loss: 718366.2214; val_masked_gp_l1_reg_loss: 7504.5449; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1508943.5052; val_optim_loss: 1508943.5052
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9649; val_auprc_score: 0.9919; val_best_acc_score: 0.9529; val_best_f1_score: 0.9728; train_kl_reg_loss: 6607.7753; train_edge_recon_loss: 766696.1334; train_gene_expr_recon_loss: 716368.8471; train_masked_gp_l1_reg_loss: 7480.5609; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1497153.3134; train_optim_loss: 1497153.3134; val_kl_reg_loss: 5367.4765; val_edge_recon_loss: 773114.9115; val_gene_expr_recon_loss: 717683.7839; val_masked_gp_l1_reg_loss: 7431.4111; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1503597.5521; val_optim_loss: 1503597.5521
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9614; val_auprc_score: 0.9912; val_best_acc_score: 0.9535; val_best_f1_score: 0.9732; train_kl_reg_loss: 6618.9483; train_edge_recon_loss: 769563.9622; train_gene_expr_recon_loss: 714876.2721; train_masked_gp_l1_reg_loss: 7349.2022; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1498408.3779; train_optim_loss: 1498408.3779; val_kl_reg_loss: 5354.5411; val_edge_recon_loss: 758321.5026; val_gene_expr_recon_loss: 717308.8464; val_masked_gp_l1_reg_loss: 7278.6338; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1488263.5208; val_optim_loss: 1488263.5208

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9611; val_auprc_score: 0.9909; val_best_acc_score: 0.9551; val_best_f1_score: 0.9740; train_kl_reg_loss: 6578.6338; train_edge_recon_loss: 765414.2163; train_gene_expr_recon_loss: 713408.9381; train_masked_gp_l1_reg_loss: 7211.1401; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1492612.9227; train_optim_loss: 1492612.9227; val_kl_reg_loss: 5126.7131; val_edge_recon_loss: 768565.4557; val_gene_expr_recon_loss: 714428.4323; val_masked_gp_l1_reg_loss: 7199.9360; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1495320.4740; val_optim_loss: 1495320.4740
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9613; val_auprc_score: 0.9907; val_best_acc_score: 0.9536; val_best_f1_score: 0.9730; train_kl_reg_loss: 6507.1476; train_edge_recon_loss: 770983.6180; train_gene_expr_recon_loss: 712955.4802; train_masked_gp_l1_reg_loss: 7204.8315; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1497651.0750; train_optim_loss: 1497651.0750; val_kl_reg_loss: 5132.4889; val_edge_recon_loss: 792538.8516; val_gene_expr_recon_loss: 715489.3672; val_masked_gp_l1_reg_loss: 7203.8916; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1520364.5833; val_optim_loss: 1520364.5833
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9626; val_auprc_score: 0.9915; val_best_acc_score: 0.9548; val_best_f1_score: 0.9738; train_kl_reg_loss: 6538.3527; train_edge_recon_loss: 768583.2366; train_gene_expr_recon_loss: 712834.5573; train_masked_gp_l1_reg_loss: 7204.9155; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1495161.0581; train_optim_loss: 1495161.0581; val_kl_reg_loss: 5102.4633; val_edge_recon_loss: 779487.0755; val_gene_expr_recon_loss: 715175.5990; val_masked_gp_l1_reg_loss: 7200.0898; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1506965.2708; val_optim_loss: 1506965.2708
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9635; val_auprc_score: 0.9917; val_best_acc_score: 0.9536; val_best_f1_score: 0.9730; train_kl_reg_loss: 6468.1496; train_edge_recon_loss: 765124.8375; train_gene_expr_recon_loss: 712977.0593; train_masked_gp_l1_reg_loss: 7205.3387; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1491775.3890; train_optim_loss: 1491775.3890; val_kl_reg_loss: 5067.5148; val_edge_recon_loss: 785960.9896; val_gene_expr_recon_loss: 716015.2422; val_masked_gp_l1_reg_loss: 7204.3208; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1514248.1302; val_optim_loss: 1514248.1302

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 55 min 36 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9650
Val AUPRC score: 0.9915
Val best accuracy score: 0.9546
Val best F1 score: 0.9736
Val gene expr MSE score: 182874.8656
Val cat covariate0 mean sim diff: 0.0004

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
