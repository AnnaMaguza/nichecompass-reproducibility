[True]
Run timestamp: 01082023_091948_72.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_72']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9197; val_auprc_score: 0.9834; val_best_acc_score: 0.8510; val_best_f1_score: 0.9195; train_kl_reg_loss: 208963.5589; train_edge_recon_loss: 116494.5680; train_gene_expr_recon_loss: 54222113.0370; train_masked_gp_l1_reg_loss: 13878.0474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118089.8045; train_global_loss: 54679539.1111; train_optim_loss: 54679539.1111; val_kl_reg_loss: 270745.2760; val_edge_recon_loss: 121117.9870; val_gene_expr_recon_loss: 41420202.0000; val_masked_gp_l1_reg_loss: 14510.2910; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109523.3594; val_global_loss: 41936101.3333; val_optim_loss: 41936101.3333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9070; val_auprc_score: 0.9823; val_best_acc_score: 0.8585; val_best_f1_score: 0.9238; train_kl_reg_loss: 284729.0330; train_edge_recon_loss: 119433.3166; train_gene_expr_recon_loss: 37578265.4074; train_masked_gp_l1_reg_loss: 14429.3813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102704.8817; train_global_loss: 38099562.2222; train_optim_loss: 38099562.2222; val_kl_reg_loss: 277762.3021; val_edge_recon_loss: 115094.1706; val_gene_expr_recon_loss: 34281692.0000; val_masked_gp_l1_reg_loss: 14210.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96255.1172; val_global_loss: 34785017.3333; val_optim_loss: 34785017.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8773; val_auprc_score: 0.9755; val_best_acc_score: 0.8549; val_best_f1_score: 0.9218; train_kl_reg_loss: 272318.3686; train_edge_recon_loss: 119243.8089; train_gene_expr_recon_loss: 30088395.1481; train_masked_gp_l1_reg_loss: 13948.2481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91147.8744; train_global_loss: 30585053.0741; train_optim_loss: 30585053.0741; val_kl_reg_loss: 245790.8177; val_edge_recon_loss: 118012.9727; val_gene_expr_recon_loss: 26355201.6667; val_masked_gp_l1_reg_loss: 13689.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86339.3281; val_global_loss: 26819035.6667; val_optim_loss: 26819035.6667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8525; val_auprc_score: 0.9690; val_best_acc_score: 0.8551; val_best_f1_score: 0.9214; train_kl_reg_loss: 237508.4664; train_edge_recon_loss: 119603.0464; train_gene_expr_recon_loss: 24605927.9259; train_masked_gp_l1_reg_loss: 13496.1926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82623.3795; train_global_loss: 25059158.8519; train_optim_loss: 25059158.8519; val_kl_reg_loss: 213554.0260; val_edge_recon_loss: 122042.3307; val_gene_expr_recon_loss: 23432994.6667; val_masked_gp_l1_reg_loss: 13333.5459; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79246.3906; val_global_loss: 23861170.6667; val_optim_loss: 23861170.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8391; val_auprc_score: 0.9661; val_best_acc_score: 0.8775; val_best_f1_score: 0.9327; train_kl_reg_loss: 207632.1843; train_edge_recon_loss: 119293.1765; train_gene_expr_recon_loss: 22857668.1481; train_masked_gp_l1_reg_loss: 13236.2244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76946.9666; train_global_loss: 23274776.6667; train_optim_loss: 23274776.6667; val_kl_reg_loss: 188944.1302; val_edge_recon_loss: 117756.7839; val_gene_expr_recon_loss: 22437749.3333; val_masked_gp_l1_reg_loss: 13156.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75065.6875; val_global_loss: 22832672.0000; val_optim_loss: 22832672.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8440; val_auprc_score: 0.9654; val_best_acc_score: 0.8730; val_best_f1_score: 0.9279; train_kl_reg_loss: 185357.6617; train_edge_recon_loss: 119214.2724; train_gene_expr_recon_loss: 22203968.2963; train_masked_gp_l1_reg_loss: 13121.4056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74233.5571; train_global_loss: 22595895.2963; train_optim_loss: 22595895.2963; val_kl_reg_loss: 170658.2630; val_edge_recon_loss: 119959.4505; val_gene_expr_recon_loss: 21942792.3333; val_masked_gp_l1_reg_loss: 13106.3555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73839.1641; val_global_loss: 22320356.0000; val_optim_loss: 22320356.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8573; val_auprc_score: 0.9687; val_best_acc_score: 0.8769; val_best_f1_score: 0.9321; train_kl_reg_loss: 168835.0761; train_edge_recon_loss: 118186.7960; train_gene_expr_recon_loss: 21830408.0741; train_masked_gp_l1_reg_loss: 13137.1215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73766.1552; train_global_loss: 22204333.2593; train_optim_loss: 22204333.2593; val_kl_reg_loss: 156984.5234; val_edge_recon_loss: 120716.7852; val_gene_expr_recon_loss: 21679250.0000; val_masked_gp_l1_reg_loss: 13180.4795; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73702.4844; val_global_loss: 22043833.3333; val_optim_loss: 22043833.3333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8564; val_auprc_score: 0.9684; val_best_acc_score: 0.8780; val_best_f1_score: 0.9322; train_kl_reg_loss: 156635.2216; train_edge_recon_loss: 119019.8231; train_gene_expr_recon_loss: 21550642.4444; train_masked_gp_l1_reg_loss: 13232.3940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73642.1299; train_global_loss: 21913171.9259; train_optim_loss: 21913171.9259; val_kl_reg_loss: 146528.3516; val_edge_recon_loss: 117821.6185; val_gene_expr_recon_loss: 21431206.3333; val_masked_gp_l1_reg_loss: 13291.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73578.1797; val_global_loss: 21782426.0000; val_optim_loss: 21782426.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8628; val_auprc_score: 0.9693; val_best_acc_score: 0.8780; val_best_f1_score: 0.9314; train_kl_reg_loss: 146846.0295; train_edge_recon_loss: 117800.5297; train_gene_expr_recon_loss: 21322350.8148; train_masked_gp_l1_reg_loss: 13333.4499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73513.1635; train_global_loss: 21673844.1111; train_optim_loss: 21673844.1111; val_kl_reg_loss: 137623.3724; val_edge_recon_loss: 119768.5456; val_gene_expr_recon_loss: 21216173.6667; val_masked_gp_l1_reg_loss: 13378.1533; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73443.1719; val_global_loss: 21560387.6667; val_optim_loss: 21560387.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8738; val_auprc_score: 0.9725; val_best_acc_score: 0.8786; val_best_f1_score: 0.9312; train_kl_reg_loss: 138502.0819; train_edge_recon_loss: 117036.8384; train_gene_expr_recon_loss: 21124149.3333; train_masked_gp_l1_reg_loss: 13422.8098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73373.6832; train_global_loss: 21466484.7037; train_optim_loss: 21466484.7037; val_kl_reg_loss: 131005.2083; val_edge_recon_loss: 118863.4922; val_gene_expr_recon_loss: 20985183.6667; val_masked_gp_l1_reg_loss: 13468.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73299.8594; val_global_loss: 21321820.3333; val_optim_loss: 21321820.3333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8738; val_auprc_score: 0.9716; val_best_acc_score: 0.8771; val_best_f1_score: 0.9299; train_kl_reg_loss: 131183.3870; train_edge_recon_loss: 115947.2938; train_gene_expr_recon_loss: 20946875.3704; train_masked_gp_l1_reg_loss: 13504.3557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73225.1063; train_global_loss: 21280735.3704; train_optim_loss: 21280735.3704; val_kl_reg_loss: 123809.6341; val_edge_recon_loss: 121597.8307; val_gene_expr_recon_loss: 20821850.0000; val_masked_gp_l1_reg_loss: 13540.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73146.7031; val_global_loss: 21153943.6667; val_optim_loss: 21153943.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8686; val_auprc_score: 0.9710; val_best_acc_score: 0.8796; val_best_f1_score: 0.9316; train_kl_reg_loss: 124619.7995; train_edge_recon_loss: 117932.5145; train_gene_expr_recon_loss: 20785916.8148; train_masked_gp_l1_reg_loss: 13575.2290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73067.4599; train_global_loss: 21115111.7037; train_optim_loss: 21115111.7037; val_kl_reg_loss: 117655.3229; val_edge_recon_loss: 118222.4036; val_gene_expr_recon_loss: 20666332.6667; val_masked_gp_l1_reg_loss: 13615.6729; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72984.1094; val_global_loss: 20988810.0000; val_optim_loss: 20988810.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8836; val_auprc_score: 0.9757; val_best_acc_score: 0.8853; val_best_f1_score: 0.9357; train_kl_reg_loss: 118891.2053; train_edge_recon_loss: 115763.4988; train_gene_expr_recon_loss: 20629291.3333; train_masked_gp_l1_reg_loss: 13653.5237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72903.4275; train_global_loss: 20950503.1481; train_optim_loss: 20950503.1481; val_kl_reg_loss: 112499.7930; val_edge_recon_loss: 114942.6536; val_gene_expr_recon_loss: 20519787.3333; val_masked_gp_l1_reg_loss: 13701.2051; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72819.2109; val_global_loss: 20833751.3333; val_optim_loss: 20833751.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8835; val_auprc_score: 0.9742; val_best_acc_score: 0.8829; val_best_f1_score: 0.9328; train_kl_reg_loss: 113657.9770; train_edge_recon_loss: 116230.3012; train_gene_expr_recon_loss: 20482135.6667; train_masked_gp_l1_reg_loss: 13746.6661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72736.7257; train_global_loss: 20798507.3704; train_optim_loss: 20798507.3704; val_kl_reg_loss: 108220.1940; val_edge_recon_loss: 120399.6133; val_gene_expr_recon_loss: 20405065.0000; val_masked_gp_l1_reg_loss: 13801.8857; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72651.1797; val_global_loss: 20720139.0000; val_optim_loss: 20720139.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8832; val_auprc_score: 0.9746; val_best_acc_score: 0.8873; val_best_f1_score: 0.9363; train_kl_reg_loss: 108880.6474; train_edge_recon_loss: 116299.4741; train_gene_expr_recon_loss: 20345949.8148; train_masked_gp_l1_reg_loss: 13846.7438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72568.0492; train_global_loss: 20657544.7778; train_optim_loss: 20657544.7778; val_kl_reg_loss: 102678.2995; val_edge_recon_loss: 116831.2318; val_gene_expr_recon_loss: 20241118.6667; val_masked_gp_l1_reg_loss: 13897.0293; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72480.4531; val_global_loss: 20547006.0000; val_optim_loss: 20547006.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8863; val_auprc_score: 0.9755; val_best_acc_score: 0.8933; val_best_f1_score: 0.9395; train_kl_reg_loss: 104650.6473; train_edge_recon_loss: 116662.0859; train_gene_expr_recon_loss: 20206813.7778; train_masked_gp_l1_reg_loss: 13953.0652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72399.1769; train_global_loss: 20514478.7037; train_optim_loss: 20514478.7037; val_kl_reg_loss: 99262.2174; val_edge_recon_loss: 113695.9023; val_gene_expr_recon_loss: 20153232.0000; val_masked_gp_l1_reg_loss: 14012.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72315.0469; val_global_loss: 20452518.3333; val_optim_loss: 20452518.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8932; val_auprc_score: 0.9777; val_best_acc_score: 0.8974; val_best_f1_score: 0.9415; train_kl_reg_loss: 100798.6633; train_edge_recon_loss: 115890.5848; train_gene_expr_recon_loss: 20073912.1481; train_masked_gp_l1_reg_loss: 14063.8380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72234.7331; train_global_loss: 20376900.0000; train_optim_loss: 20376900.0000; val_kl_reg_loss: 95477.7474; val_edge_recon_loss: 114089.3763; val_gene_expr_recon_loss: 19996365.3333; val_masked_gp_l1_reg_loss: 14119.9307; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72152.5156; val_global_loss: 20292204.6667; val_optim_loss: 20292204.6667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8942; val_auprc_score: 0.9777; val_best_acc_score: 0.8945; val_best_f1_score: 0.9397; train_kl_reg_loss: 97343.3043; train_edge_recon_loss: 115760.9915; train_gene_expr_recon_loss: 19940801.1481; train_masked_gp_l1_reg_loss: 14170.0347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72073.9627; train_global_loss: 20240149.3333; train_optim_loss: 20240149.3333; val_kl_reg_loss: 92529.7201; val_edge_recon_loss: 114643.0638; val_gene_expr_recon_loss: 19850184.3333; val_masked_gp_l1_reg_loss: 14227.1387; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71994.1016; val_global_loss: 20143579.3333; val_optim_loss: 20143579.3333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9058; val_auprc_score: 0.9794; val_best_acc_score: 0.8987; val_best_f1_score: 0.9417; train_kl_reg_loss: 94066.7514; train_edge_recon_loss: 115711.8565; train_gene_expr_recon_loss: 19809270.4074; train_masked_gp_l1_reg_loss: 14281.8174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71916.2305; train_global_loss: 20105247.0000; train_optim_loss: 20105247.0000; val_kl_reg_loss: 89562.5039; val_edge_recon_loss: 115973.4883; val_gene_expr_recon_loss: 19713664.6667; val_masked_gp_l1_reg_loss: 14338.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71837.0156; val_global_loss: 20005376.6667; val_optim_loss: 20005376.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9035; val_auprc_score: 0.9788; val_best_acc_score: 0.8987; val_best_f1_score: 0.9415; train_kl_reg_loss: 91088.1917; train_edge_recon_loss: 114331.1479; train_gene_expr_recon_loss: 19686087.0741; train_masked_gp_l1_reg_loss: 14383.8832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71762.6124; train_global_loss: 19977653.0000; train_optim_loss: 19977653.0000; val_kl_reg_loss: 86525.4805; val_edge_recon_loss: 116425.3411; val_gene_expr_recon_loss: 19616833.6667; val_masked_gp_l1_reg_loss: 14436.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71687.3281; val_global_loss: 19905908.3333; val_optim_loss: 19905908.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9001; val_auprc_score: 0.9789; val_best_acc_score: 0.9003; val_best_f1_score: 0.9425; train_kl_reg_loss: 88363.6218; train_edge_recon_loss: 115316.4269; train_gene_expr_recon_loss: 19564773.1111; train_masked_gp_l1_reg_loss: 14483.5012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71615.5832; train_global_loss: 19854552.2222; train_optim_loss: 19854552.2222; val_kl_reg_loss: 84164.0430; val_edge_recon_loss: 113056.5156; val_gene_expr_recon_loss: 19477590.3333; val_masked_gp_l1_reg_loss: 14537.2754; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71542.8828; val_global_loss: 19760891.3333; val_optim_loss: 19760891.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9014; val_auprc_score: 0.9783; val_best_acc_score: 0.8994; val_best_f1_score: 0.9417; train_kl_reg_loss: 85839.6807; train_edge_recon_loss: 114136.2446; train_gene_expr_recon_loss: 19448449.4074; train_masked_gp_l1_reg_loss: 14580.2325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71473.3171; train_global_loss: 19734478.9630; train_optim_loss: 19734478.9630; val_kl_reg_loss: 81993.3763; val_edge_recon_loss: 115928.7760; val_gene_expr_recon_loss: 19376310.3333; val_masked_gp_l1_reg_loss: 14630.6045; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71400.7656; val_global_loss: 19660262.3333; val_optim_loss: 19660262.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9063; val_auprc_score: 0.9799; val_best_acc_score: 0.9027; val_best_f1_score: 0.9434; train_kl_reg_loss: 83496.0589; train_edge_recon_loss: 114258.9878; train_gene_expr_recon_loss: 19329530.9630; train_masked_gp_l1_reg_loss: 14674.4463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71330.6042; train_global_loss: 19613291.1111; train_optim_loss: 19613291.1111; val_kl_reg_loss: 79649.1641; val_edge_recon_loss: 114440.0547; val_gene_expr_recon_loss: 19241307.3333; val_masked_gp_l1_reg_loss: 14727.3574; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71256.9375; val_global_loss: 19521380.6667; val_optim_loss: 19521380.6667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9116; val_auprc_score: 0.9820; val_best_acc_score: 0.9021; val_best_f1_score: 0.9433; train_kl_reg_loss: 81316.8115; train_edge_recon_loss: 114282.0885; train_gene_expr_recon_loss: 19217986.9259; train_masked_gp_l1_reg_loss: 14765.4136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71183.8200; train_global_loss: 19499535.1852; train_optim_loss: 19499535.1852; val_kl_reg_loss: 77474.1693; val_edge_recon_loss: 112443.7096; val_gene_expr_recon_loss: 19153281.3333; val_masked_gp_l1_reg_loss: 14810.2686; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71106.7812; val_global_loss: 19429115.3333; val_optim_loss: 19429115.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9102; val_auprc_score: 0.9809; val_best_acc_score: 0.9011; val_best_f1_score: 0.9436; train_kl_reg_loss: 79210.4847; train_edge_recon_loss: 114068.6842; train_gene_expr_recon_loss: 19109939.4444; train_masked_gp_l1_reg_loss: 14851.7719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71032.3636; train_global_loss: 19389102.7037; train_optim_loss: 19389102.7037; val_kl_reg_loss: 75575.8776; val_edge_recon_loss: 115697.9531; val_gene_expr_recon_loss: 19091326.0000; val_masked_gp_l1_reg_loss: 14902.0791; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70954.0547; val_global_loss: 19368455.6667; val_optim_loss: 19368455.6667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9162; val_auprc_score: 0.9825; val_best_acc_score: 0.9070; val_best_f1_score: 0.9468; train_kl_reg_loss: 76235.9695; train_edge_recon_loss: 114761.7509; train_gene_expr_recon_loss: 19168103.1852; train_masked_gp_l1_reg_loss: 14962.9085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70861.3210; train_global_loss: 19444925.2222; train_optim_loss: 19444925.2222; val_kl_reg_loss: 66468.0091; val_edge_recon_loss: 114080.1276; val_gene_expr_recon_loss: 19106067.6667; val_masked_gp_l1_reg_loss: 15025.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70674.3594; val_global_loss: 19372315.6667; val_optim_loss: 19372315.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8994; val_auprc_score: 0.9793; val_best_acc_score: 0.9058; val_best_f1_score: 0.9472; train_kl_reg_loss: 56847.9333; train_edge_recon_loss: 115939.8343; train_gene_expr_recon_loss: 29813930.7037; train_masked_gp_l1_reg_loss: 15976.6105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70157.4776; train_global_loss: 30072852.8148; train_optim_loss: 30072852.8148; val_kl_reg_loss: 62879.5736; val_edge_recon_loss: 112529.4948; val_gene_expr_recon_loss: 34629470.0000; val_masked_gp_l1_reg_loss: 17069.8652; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69750.8516; val_global_loss: 34891698.6667; val_optim_loss: 34891698.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9048; val_auprc_score: 0.9804; val_best_acc_score: 0.9001; val_best_f1_score: 0.9421; train_kl_reg_loss: 74004.3830; train_edge_recon_loss: 117125.6651; train_gene_expr_recon_loss: 31707980.5185; train_masked_gp_l1_reg_loss: 17145.2442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69628.1280; train_global_loss: 31985883.8519; train_optim_loss: 31985883.8519; val_kl_reg_loss: 72535.7591; val_edge_recon_loss: 116372.9531; val_gene_expr_recon_loss: 29000012.6667; val_masked_gp_l1_reg_loss: 17135.0059; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69491.4766; val_global_loss: 29275549.0000; val_optim_loss: 29275549.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8996; val_auprc_score: 0.9791; val_best_acc_score: 0.9005; val_best_f1_score: 0.9439; train_kl_reg_loss: 74421.6522; train_edge_recon_loss: 116136.3239; train_gene_expr_recon_loss: 27012776.8519; train_masked_gp_l1_reg_loss: 17114.5953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69355.3621; train_global_loss: 27289804.8519; train_optim_loss: 27289804.8519; val_kl_reg_loss: 68263.6068; val_edge_recon_loss: 111824.9154; val_gene_expr_recon_loss: 25322321.3333; val_masked_gp_l1_reg_loss: 17090.1738; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69211.9922; val_global_loss: 25588712.0000; val_optim_loss: 25588712.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9095; val_auprc_score: 0.9804; val_best_acc_score: 0.8984; val_best_f1_score: 0.9422; train_kl_reg_loss: 71801.1224; train_edge_recon_loss: 114772.5916; train_gene_expr_recon_loss: 25154576.8889; train_masked_gp_l1_reg_loss: 17073.0827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69166.3388; train_global_loss: 25427390.0000; train_optim_loss: 25427390.0000; val_kl_reg_loss: 67852.9818; val_edge_recon_loss: 119305.4089; val_gene_expr_recon_loss: 25057312.6667; val_masked_gp_l1_reg_loss: 17065.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69144.9219; val_global_loss: 25330680.6667; val_optim_loss: 25330680.6667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9018; val_auprc_score: 0.9789; val_best_acc_score: 0.8985; val_best_f1_score: 0.9424; train_kl_reg_loss: 71270.6571; train_edge_recon_loss: 115264.5634; train_gene_expr_recon_loss: 24925055.1481; train_masked_gp_l1_reg_loss: 17062.7420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69130.1143; train_global_loss: 25197783.4815; train_optim_loss: 25197783.4815; val_kl_reg_loss: 67531.8125; val_edge_recon_loss: 115876.6315; val_gene_expr_recon_loss: 24837513.3333; val_masked_gp_l1_reg_loss: 17061.3457; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69114.7734; val_global_loss: 25107097.6667; val_optim_loss: 25107097.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9083; val_auprc_score: 0.9808; val_best_acc_score: 0.9022; val_best_f1_score: 0.9443; train_kl_reg_loss: 70792.6730; train_edge_recon_loss: 116139.4936; train_gene_expr_recon_loss: 24721127.6667; train_masked_gp_l1_reg_loss: 17058.8417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69099.7371; train_global_loss: 24994218.2963; train_optim_loss: 24994218.2963; val_kl_reg_loss: 66944.5820; val_edge_recon_loss: 116572.3802; val_gene_expr_recon_loss: 24632764.0000; val_masked_gp_l1_reg_loss: 17057.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69084.0156; val_global_loss: 24902423.0000; val_optim_loss: 24902423.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9086; val_auprc_score: 0.9810; val_best_acc_score: 0.9014; val_best_f1_score: 0.9438; train_kl_reg_loss: 70280.8137; train_edge_recon_loss: 115430.4436; train_gene_expr_recon_loss: 24531584.4074; train_masked_gp_l1_reg_loss: 17055.2609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69068.4048; train_global_loss: 24803419.4074; train_optim_loss: 24803419.4074; val_kl_reg_loss: 66580.6445; val_edge_recon_loss: 116212.9310; val_gene_expr_recon_loss: 24426776.3333; val_masked_gp_l1_reg_loss: 17053.7910; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69052.0000; val_global_loss: 24695676.3333; val_optim_loss: 24695676.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 13 min 40 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9094
val AUPRC score: 0.9812
val best accuracy score: 0.9030
val best F1 score: 0.9435
val target rna MSE score: 4.9965
val source rna MSE score: 4.9574
Val cat covariate0 mean sim diff: -0.0011

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
