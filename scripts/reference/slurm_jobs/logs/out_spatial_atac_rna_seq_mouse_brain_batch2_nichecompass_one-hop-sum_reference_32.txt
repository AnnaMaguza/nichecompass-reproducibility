[True]
Run timestamp: 10082023_201013_32.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_32']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7172; val_auprc_score: 0.7495; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 97788.9144; train_edge_recon_loss: 3695607.6870; train_gene_expr_recon_loss: 26870911.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4103700.7195; train_global_loss: 34768008.9924; train_optim_loss: 34768008.9924; val_kl_reg_loss: 164942.0823; val_edge_recon_loss: 4065867.8333; val_gene_expr_recon_loss: 23713708.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3955244.2000; val_global_loss: 31899762.6667; val_optim_loss: 31899762.6667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7454; val_auprc_score: 0.7670; val_best_acc_score: 0.6315; val_best_f1_score: 0.7099; train_kl_reg_loss: 134879.7540; train_edge_recon_loss: 3615379.3626; train_gene_expr_recon_loss: 23145283.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3864608.5420; train_global_loss: 30760151.3893; train_optim_loss: 30760151.3893; val_kl_reg_loss: 147793.3156; val_edge_recon_loss: 4055846.9833; val_gene_expr_recon_loss: 22647401.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3855234.7167; val_global_loss: 30706277.2000; val_optim_loss: 30706277.2000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8209; val_auprc_score: 0.8278; val_best_acc_score: 0.7208; val_best_f1_score: 0.7485; train_kl_reg_loss: 143659.5760; train_edge_recon_loss: 3540241.6431; train_gene_expr_recon_loss: 22241430.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3802712.7824; train_global_loss: 29728044.4733; train_optim_loss: 29728044.4733; val_kl_reg_loss: 131629.2281; val_edge_recon_loss: 3970286.4500; val_gene_expr_recon_loss: 22309756.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3838116.4333; val_global_loss: 30249788.8000; val_optim_loss: 30249788.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8647; val_auprc_score: 0.8672; val_best_acc_score: 0.7809; val_best_f1_score: 0.7882; train_kl_reg_loss: 115823.1122; train_edge_recon_loss: 3427555.4637; train_gene_expr_recon_loss: 22007898.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3775677.2710; train_global_loss: 29326954.8855; train_optim_loss: 29326954.8855; val_kl_reg_loss: 112551.1167; val_edge_recon_loss: 3303351.9000; val_gene_expr_recon_loss: 22284053.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3823125.5333; val_global_loss: 29523081.3333; val_optim_loss: 29523081.3333
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8910; val_auprc_score: 0.8773; val_best_acc_score: 0.8123; val_best_f1_score: 0.8275; train_kl_reg_loss: 125437.4373; train_edge_recon_loss: 3119689.9141; train_gene_expr_recon_loss: 21892921.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3761892.1450; train_global_loss: 28899940.6565; train_optim_loss: 28899940.6565; val_kl_reg_loss: 139706.5682; val_edge_recon_loss: 3027514.2000; val_gene_expr_recon_loss: 22042600.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3798846.6000; val_global_loss: 29008668.0000; val_optim_loss: 29008668.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9166; val_auprc_score: 0.9044; val_best_acc_score: 0.8389; val_best_f1_score: 0.8501; train_kl_reg_loss: 142513.4881; train_edge_recon_loss: 2937104.9656; train_gene_expr_recon_loss: 21701269.7405; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3736928.0935; train_global_loss: 28517816.1527; train_optim_loss: 28517816.1527; val_kl_reg_loss: 149055.5094; val_edge_recon_loss: 2916204.2333; val_gene_expr_recon_loss: 21962277.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3808927.9333; val_global_loss: 28836464.8000; val_optim_loss: 28836464.8000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9256; val_auprc_score: 0.9141; val_best_acc_score: 0.8513; val_best_f1_score: 0.8604; train_kl_reg_loss: 144231.2716; train_edge_recon_loss: 2880447.6851; train_gene_expr_recon_loss: 21557659.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3719411.5401; train_global_loss: 28301750.3359; train_optim_loss: 28301750.3359; val_kl_reg_loss: 142534.7115; val_edge_recon_loss: 2890411.6833; val_gene_expr_recon_loss: 21812781.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3764869.5167; val_global_loss: 28610597.0667; val_optim_loss: 28610597.0667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9263; val_auprc_score: 0.9121; val_best_acc_score: 0.8561; val_best_f1_score: 0.8646; train_kl_reg_loss: 141596.3883; train_edge_recon_loss: 2857575.8130; train_gene_expr_recon_loss: 21452311.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3704290.5191; train_global_loss: 28155773.9237; train_optim_loss: 28155773.9237; val_kl_reg_loss: 137347.6000; val_edge_recon_loss: 2874710.5833; val_gene_expr_recon_loss: 21784811.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3758324.9667; val_global_loss: 28555194.1333; val_optim_loss: 28555194.1333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9271; val_auprc_score: 0.9125; val_best_acc_score: 0.8587; val_best_f1_score: 0.8671; train_kl_reg_loss: 135253.9640; train_edge_recon_loss: 2841845.9981; train_gene_expr_recon_loss: 21378260.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3696813.0095; train_global_loss: 28052173.0840; train_optim_loss: 28052173.0840; val_kl_reg_loss: 132303.7161; val_edge_recon_loss: 2871056.7667; val_gene_expr_recon_loss: 21620702.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3742947.4667; val_global_loss: 28367010.6667; val_optim_loss: 28367010.6667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9369; val_auprc_score: 0.9243; val_best_acc_score: 0.8709; val_best_f1_score: 0.8782; train_kl_reg_loss: 130721.2127; train_edge_recon_loss: 2830071.4275; train_gene_expr_recon_loss: 21291103.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3684921.4523; train_global_loss: 27936817.8931; train_optim_loss: 27936817.8931; val_kl_reg_loss: 127780.2854; val_edge_recon_loss: 2830304.5167; val_gene_expr_recon_loss: 21438108.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3719262.1833; val_global_loss: 28115455.2000; val_optim_loss: 28115455.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9358; val_auprc_score: 0.9223; val_best_acc_score: 0.8743; val_best_f1_score: 0.8812; train_kl_reg_loss: 124224.6518; train_edge_recon_loss: 2825958.9294; train_gene_expr_recon_loss: 21199709.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3672888.2939; train_global_loss: 27822781.7099; train_optim_loss: 27822781.7099; val_kl_reg_loss: 123092.5260; val_edge_recon_loss: 2804246.5833; val_gene_expr_recon_loss: 21312531.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3713079.6333; val_global_loss: 27952950.1333; val_optim_loss: 27952950.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9364; val_auprc_score: 0.9202; val_best_acc_score: 0.8729; val_best_f1_score: 0.8804; train_kl_reg_loss: 119508.0012; train_edge_recon_loss: 2810277.5763; train_gene_expr_recon_loss: 21127189.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3663477.6164; train_global_loss: 27720452.4275; train_optim_loss: 27720452.4275; val_kl_reg_loss: 116305.7391; val_edge_recon_loss: 2829820.1833; val_gene_expr_recon_loss: 21375009.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3704452.7000; val_global_loss: 28025587.6000; val_optim_loss: 28025587.6000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9381; val_auprc_score: 0.9210; val_best_acc_score: 0.8744; val_best_f1_score: 0.8801; train_kl_reg_loss: 114717.2709; train_edge_recon_loss: 2813737.5534; train_gene_expr_recon_loss: 21068176.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3654688.0076; train_global_loss: 27651319.5573; train_optim_loss: 27651319.5573; val_kl_reg_loss: 114451.3833; val_edge_recon_loss: 2803896.0667; val_gene_expr_recon_loss: 21290465.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3716648.6500; val_global_loss: 27925461.6000; val_optim_loss: 27925461.6000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9380; val_auprc_score: 0.9232; val_best_acc_score: 0.8764; val_best_f1_score: 0.8822; train_kl_reg_loss: 111876.9786; train_edge_recon_loss: 2793490.6088; train_gene_expr_recon_loss: 21008374.8702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3647909.2844; train_global_loss: 27561651.7099; train_optim_loss: 27561651.7099; val_kl_reg_loss: 117325.0385; val_edge_recon_loss: 2804777.4000; val_gene_expr_recon_loss: 21316145.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3707132.6833; val_global_loss: 27945380.8000; val_optim_loss: 27945380.8000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9356; val_auprc_score: 0.9192; val_best_acc_score: 0.8725; val_best_f1_score: 0.8784; train_kl_reg_loss: 110672.0935; train_edge_recon_loss: 2800027.9618; train_gene_expr_recon_loss: 20998103.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3646642.1145; train_global_loss: 27555445.2519; train_optim_loss: 27555445.2519; val_kl_reg_loss: 108730.3844; val_edge_recon_loss: 2828834.2833; val_gene_expr_recon_loss: 21200321.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3707914.4667; val_global_loss: 27845800.5333; val_optim_loss: 27845800.5333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9406; val_auprc_score: 0.9263; val_best_acc_score: 0.8809; val_best_f1_score: 0.8878; train_kl_reg_loss: 104949.5915; train_edge_recon_loss: 2797669.0630; train_gene_expr_recon_loss: 20911744.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3636935.4427; train_global_loss: 27451298.7634; train_optim_loss: 27451298.7634; val_kl_reg_loss: 103904.2172; val_edge_recon_loss: 2800164.0667; val_gene_expr_recon_loss: 21154946.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3680785.1667; val_global_loss: 27739799.0667; val_optim_loss: 27739799.0667
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9444; val_auprc_score: 0.9333; val_best_acc_score: 0.8802; val_best_f1_score: 0.8872; train_kl_reg_loss: 103549.9126; train_edge_recon_loss: 2776954.5802; train_gene_expr_recon_loss: 20888571.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3635591.4027; train_global_loss: 27404666.9618; train_optim_loss: 27404666.9618; val_kl_reg_loss: 102997.4443; val_edge_recon_loss: 2786505.4167; val_gene_expr_recon_loss: 21163017.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3707010.3500; val_global_loss: 27759530.5333; val_optim_loss: 27759530.5333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9470; val_auprc_score: 0.9331; val_best_acc_score: 0.8860; val_best_f1_score: 0.8917; train_kl_reg_loss: 100511.4735; train_edge_recon_loss: 2773014.1469; train_gene_expr_recon_loss: 20852854.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3628198.8607; train_global_loss: 27354578.8092; train_optim_loss: 27354578.8092; val_kl_reg_loss: 101596.0964; val_edge_recon_loss: 2777955.6000; val_gene_expr_recon_loss: 21127399.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3698201.4833; val_global_loss: 27705153.2000; val_optim_loss: 27705153.2000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9466; val_auprc_score: 0.9329; val_best_acc_score: 0.8864; val_best_f1_score: 0.8929; train_kl_reg_loss: 98331.2282; train_edge_recon_loss: 2765447.4198; train_gene_expr_recon_loss: 20796012.1527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3622390.5019; train_global_loss: 27282181.2824; train_optim_loss: 27282181.2824; val_kl_reg_loss: 95239.8750; val_edge_recon_loss: 2773942.7333; val_gene_expr_recon_loss: 21072608.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3682605.9333; val_global_loss: 27624396.5333; val_optim_loss: 27624396.5333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9494; val_auprc_score: 0.9363; val_best_acc_score: 0.8926; val_best_f1_score: 0.8973; train_kl_reg_loss: 95616.3386; train_edge_recon_loss: 2764209.3588; train_gene_expr_recon_loss: 20786552.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3622085.1947; train_global_loss: 27268463.5267; train_optim_loss: 27268463.5267; val_kl_reg_loss: 94405.3141; val_edge_recon_loss: 2765144.5333; val_gene_expr_recon_loss: 21037261.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3675559.6833; val_global_loss: 27572370.8000; val_optim_loss: 27572370.8000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9530; val_auprc_score: 0.9400; val_best_acc_score: 0.8976; val_best_f1_score: 0.9021; train_kl_reg_loss: 94275.1997; train_edge_recon_loss: 2753478.9618; train_gene_expr_recon_loss: 20734642.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3616295.8111; train_global_loss: 27198691.8779; train_optim_loss: 27198691.8779; val_kl_reg_loss: 92809.0589; val_edge_recon_loss: 2753472.4667; val_gene_expr_recon_loss: 21014442.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3673015.5667; val_global_loss: 27533739.3333; val_optim_loss: 27533739.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9493; val_auprc_score: 0.9389; val_best_acc_score: 0.8870; val_best_f1_score: 0.8928; train_kl_reg_loss: 91617.2431; train_edge_recon_loss: 2753470.8664; train_gene_expr_recon_loss: 20735308.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3619882.7977; train_global_loss: 27200278.8702; train_optim_loss: 27200278.8702; val_kl_reg_loss: 92256.4937; val_edge_recon_loss: 2779628.2000; val_gene_expr_recon_loss: 20991430.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3670753.8000; val_global_loss: 27534068.8000; val_optim_loss: 27534068.8000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9540; val_auprc_score: 0.9419; val_best_acc_score: 0.8922; val_best_f1_score: 0.8968; train_kl_reg_loss: 91245.9506; train_edge_recon_loss: 2743014.0134; train_gene_expr_recon_loss: 20693544.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3612742.7405; train_global_loss: 27140546.7634; train_optim_loss: 27140546.7634; val_kl_reg_loss: 89331.2141; val_edge_recon_loss: 2761160.9167; val_gene_expr_recon_loss: 20967385.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3668607.0833; val_global_loss: 27486485.2000; val_optim_loss: 27486485.2000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9534; val_auprc_score: 0.9419; val_best_acc_score: 0.8959; val_best_f1_score: 0.9009; train_kl_reg_loss: 89589.7756; train_edge_recon_loss: 2733546.9294; train_gene_expr_recon_loss: 20662777.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3611015.6126; train_global_loss: 27096929.7405; train_optim_loss: 27096929.7405; val_kl_reg_loss: 90041.7089; val_edge_recon_loss: 2745110.4500; val_gene_expr_recon_loss: 20959707.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3671782.4833; val_global_loss: 27466642.2667; val_optim_loss: 27466642.2667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9534; val_auprc_score: 0.9410; val_best_acc_score: 0.8919; val_best_f1_score: 0.8972; train_kl_reg_loss: 87878.2017; train_edge_recon_loss: 2735308.2481; train_gene_expr_recon_loss: 20638453.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3607893.2118; train_global_loss: 27069533.3740; train_optim_loss: 27069533.3740; val_kl_reg_loss: 86547.5729; val_edge_recon_loss: 2753090.2500; val_gene_expr_recon_loss: 20905534.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3653688.3000; val_global_loss: 27398860.9333; val_optim_loss: 27398860.9333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9495; val_auprc_score: 0.9359; val_best_acc_score: 0.8872; val_best_f1_score: 0.8927; train_kl_reg_loss: 107126.3034; train_edge_recon_loss: 2890586.6088; train_gene_expr_recon_loss: 22847556.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3811392.5973; train_global_loss: 29656661.7557; train_optim_loss: 29656661.7557; val_kl_reg_loss: 16358.8046; val_edge_recon_loss: 2867338.2500; val_gene_expr_recon_loss: 23166413.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3834544.8833; val_global_loss: 29884656.0000; val_optim_loss: 29884656.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9417; val_auprc_score: 0.9293; val_best_acc_score: 0.8732; val_best_f1_score: 0.8798; train_kl_reg_loss: 104920.8991; train_edge_recon_loss: 2833928.7576; train_gene_expr_recon_loss: 23793869.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3801501.7462; train_global_loss: 30534221.2061; train_optim_loss: 30534221.2061; val_kl_reg_loss: 13435.9926; val_edge_recon_loss: 2795284.2500; val_gene_expr_recon_loss: 24302514.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3864002.1333; val_global_loss: 30975237.2000; val_optim_loss: 30975237.2000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9424; val_auprc_score: 0.9246; val_best_acc_score: 0.8790; val_best_f1_score: 0.8856; train_kl_reg_loss: 64704.8353; train_edge_recon_loss: 2750700.0420; train_gene_expr_recon_loss: 23898320.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3794480.3645; train_global_loss: 30508206.2443; train_optim_loss: 30508206.2443; val_kl_reg_loss: 18961.2934; val_edge_recon_loss: 2730268.1500; val_gene_expr_recon_loss: 23991593.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3828767.3500; val_global_loss: 30569590.1333; val_optim_loss: 30569590.1333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9400; val_auprc_score: 0.9258; val_best_acc_score: 0.8744; val_best_f1_score: 0.8810; train_kl_reg_loss: 47652.8420; train_edge_recon_loss: 2721804.7519; train_gene_expr_recon_loss: 23568251.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3773829.4046; train_global_loss: 30111538.3969; train_optim_loss: 30111538.3969; val_kl_reg_loss: 21559.4293; val_edge_recon_loss: 2734287.2500; val_gene_expr_recon_loss: 23686955.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3818663.1000; val_global_loss: 30261465.6000; val_optim_loss: 30261465.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9436; val_auprc_score: 0.9290; val_best_acc_score: 0.8829; val_best_f1_score: 0.8899; train_kl_reg_loss: 44473.4282; train_edge_recon_loss: 2704338.1527; train_gene_expr_recon_loss: 23454078.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3772728.9676; train_global_loss: 29975619.1603; train_optim_loss: 29975619.1603; val_kl_reg_loss: 22415.5362; val_edge_recon_loss: 2711664.6333; val_gene_expr_recon_loss: 23730694.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3830040.0833; val_global_loss: 30294814.2667; val_optim_loss: 30294814.2667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9400; val_auprc_score: 0.9247; val_best_acc_score: 0.8785; val_best_f1_score: 0.8853; train_kl_reg_loss: 42931.5455; train_edge_recon_loss: 2707498.5744; train_gene_expr_recon_loss: 23421510.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3767375.3989; train_global_loss: 29939315.8015; train_optim_loss: 29939315.8015; val_kl_reg_loss: 22231.2780; val_edge_recon_loss: 2724511.1833; val_gene_expr_recon_loss: 23805898.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3843820.0500; val_global_loss: 30396460.0000; val_optim_loss: 30396460.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9395; val_auprc_score: 0.9237; val_best_acc_score: 0.8760; val_best_f1_score: 0.8847; train_kl_reg_loss: 41973.8211; train_edge_recon_loss: 2699187.7385; train_gene_expr_recon_loss: 23401489.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3769396.8779; train_global_loss: 29912047.8473; train_optim_loss: 29912047.8473; val_kl_reg_loss: 22538.2637; val_edge_recon_loss: 2721310.3833; val_gene_expr_recon_loss: 23697698.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3828199.2667; val_global_loss: 30269746.2667; val_optim_loss: 30269746.2667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9431; val_auprc_score: 0.9288; val_best_acc_score: 0.8859; val_best_f1_score: 0.8915; train_kl_reg_loss: 41364.7059; train_edge_recon_loss: 2692960.8702; train_gene_expr_recon_loss: 23375756.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 3765811.0439; train_global_loss: 29875893.2977; train_optim_loss: 29875893.2977; val_kl_reg_loss: 22777.4553; val_edge_recon_loss: 2711659.7333; val_gene_expr_recon_loss: 23781781.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 3820699.1167; val_global_loss: 30336918.1333; val_optim_loss: 30336918.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 42 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9532
val AUPRC score: 0.9382
val best accuracy score: 0.8934
val best F1 score: 0.8980
val target rna MSE score: 1.8548
val source rna MSE score: 115.7903
val target atac MSE score: 0.6331
val source atac MSE score: 6.5904
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
