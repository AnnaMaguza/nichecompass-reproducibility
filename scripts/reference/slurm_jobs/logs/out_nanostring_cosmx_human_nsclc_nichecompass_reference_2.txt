[True, False, True]
Run timestamp: 05092023_121353_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '500000.0', '--contrastive_logits_pos_ratio', '0.0078125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 563097
Number of validation nodes: 62566
Number of training edges: 1330101
Number of validation edges: 147789
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9146; val_auprc_score: 0.9830; val_best_acc_score: 0.9246; val_best_f1_score: 0.9576; train_kl_reg_loss: 16407.2836; train_edge_recon_loss: 722164.2142; train_cat_covariates_contrastive_loss: 477404.5596; train_gene_expr_recon_loss: 2561103.6840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59146.4365; train_global_loss: 3836226.1805; train_optim_loss: 3836226.1805; val_kl_reg_loss: 16449.3949; val_edge_recon_loss: 717279.7488; val_cat_covariates_contrastive_loss: 479407.0963; val_gene_expr_recon_loss: 2229997.4040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15237.9150; val_global_loss: 3458371.6358; val_optim_loss: 3458371.6358
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9190; val_auprc_score: 0.9836; val_best_acc_score: 0.9257; val_best_f1_score: 0.9582; train_kl_reg_loss: 19023.4082; train_edge_recon_loss: 692366.1118; train_cat_covariates_contrastive_loss: 477634.8922; train_gene_expr_recon_loss: 2099389.5638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15589.3624; train_global_loss: 3304003.3370; train_optim_loss: 3304003.3370; val_kl_reg_loss: 20413.1460; val_edge_recon_loss: 715338.4852; val_cat_covariates_contrastive_loss: 478064.9006; val_gene_expr_recon_loss: 2017481.2020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15964.4141; val_global_loss: 3247262.2336; val_optim_loss: 3247262.2336
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9240; val_auprc_score: 0.9846; val_best_acc_score: 0.9306; val_best_f1_score: 0.9611; train_kl_reg_loss: 20973.8130; train_edge_recon_loss: 690496.4252; train_cat_covariates_contrastive_loss: 477888.3498; train_gene_expr_recon_loss: 1976131.2643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16210.7091; train_global_loss: 3181700.5623; train_optim_loss: 3181700.5623; val_kl_reg_loss: 21454.4256; val_edge_recon_loss: 711736.6298; val_cat_covariates_contrastive_loss: 477988.3207; val_gene_expr_recon_loss: 1948633.7249; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16352.9834; val_global_loss: 3176166.0926; val_optim_loss: 3176166.0926
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9248; val_auprc_score: 0.9845; val_best_acc_score: 0.9321; val_best_f1_score: 0.9618; train_kl_reg_loss: 21889.1363; train_edge_recon_loss: 685758.8839; train_cat_covariates_contrastive_loss: 477966.7122; train_gene_expr_recon_loss: 1930648.4360; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16507.0097; train_global_loss: 3132770.1803; train_optim_loss: 3132770.1803; val_kl_reg_loss: 22817.9632; val_edge_recon_loss: 711321.5437; val_cat_covariates_contrastive_loss: 477248.1826; val_gene_expr_recon_loss: 1923529.3741; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16452.8223; val_global_loss: 3151369.8080; val_optim_loss: 3151369.8080
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9318; val_auprc_score: 0.9861; val_best_acc_score: 0.9359; val_best_f1_score: 0.9638; train_kl_reg_loss: 22449.8200; train_edge_recon_loss: 686528.6227; train_cat_covariates_contrastive_loss: 478035.0140; train_gene_expr_recon_loss: 1904378.5482; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16611.7378; train_global_loss: 3108003.7439; train_optim_loss: 3108003.7439; val_kl_reg_loss: 23097.6448; val_edge_recon_loss: 708113.4163; val_cat_covariates_contrastive_loss: 478108.0609; val_gene_expr_recon_loss: 1898978.9563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16779.0957; val_global_loss: 3125077.0856; val_optim_loss: 3125077.0856
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9307; val_auprc_score: 0.9860; val_best_acc_score: 0.9341; val_best_f1_score: 0.9629; train_kl_reg_loss: 22998.1140; train_edge_recon_loss: 686951.3746; train_cat_covariates_contrastive_loss: 478115.8871; train_gene_expr_recon_loss: 1888263.1809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16616.3351; train_global_loss: 3092944.8890; train_optim_loss: 3092944.8890; val_kl_reg_loss: 24027.9141; val_edge_recon_loss: 704736.6914; val_cat_covariates_contrastive_loss: 477215.4451; val_gene_expr_recon_loss: 1888610.2228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16564.8926; val_global_loss: 3111155.2777; val_optim_loss: 3111155.2777
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9317; val_auprc_score: 0.9860; val_best_acc_score: 0.9338; val_best_f1_score: 0.9627; train_kl_reg_loss: 23604.7060; train_edge_recon_loss: 684909.7141; train_cat_covariates_contrastive_loss: 478292.7345; train_gene_expr_recon_loss: 1874812.8366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16694.0948; train_global_loss: 3078314.0835; train_optim_loss: 3078314.0835; val_kl_reg_loss: 24414.6793; val_edge_recon_loss: 715630.4559; val_cat_covariates_contrastive_loss: 479057.7871; val_gene_expr_recon_loss: 1873645.7712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16620.9336; val_global_loss: 3109369.6981; val_optim_loss: 3109369.6981
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9294; val_auprc_score: 0.9849; val_best_acc_score: 0.9360; val_best_f1_score: 0.9640; train_kl_reg_loss: 24040.1575; train_edge_recon_loss: 687189.8376; train_cat_covariates_contrastive_loss: 478360.1019; train_gene_expr_recon_loss: 1862687.9965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16886.6609; train_global_loss: 3069164.7537; train_optim_loss: 3069164.7537; val_kl_reg_loss: 25328.2302; val_edge_recon_loss: 709815.6920; val_cat_covariates_contrastive_loss: 476846.5656; val_gene_expr_recon_loss: 1864774.8023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16873.8633; val_global_loss: 3093639.0355; val_optim_loss: 3093639.0355
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9353; val_auprc_score: 0.9865; val_best_acc_score: 0.9384; val_best_f1_score: 0.9654; train_kl_reg_loss: 24427.2224; train_edge_recon_loss: 685526.0664; train_cat_covariates_contrastive_loss: 478515.5071; train_gene_expr_recon_loss: 1855037.9785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17101.5101; train_global_loss: 3060608.2869; train_optim_loss: 3060608.2869; val_kl_reg_loss: 24783.4746; val_edge_recon_loss: 709934.3047; val_cat_covariates_contrastive_loss: 478857.5284; val_gene_expr_recon_loss: 1857531.2392; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17090.1133; val_global_loss: 3088196.5398; val_optim_loss: 3088196.5398
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9375; val_auprc_score: 0.9870; val_best_acc_score: 0.9397; val_best_f1_score: 0.9661; train_kl_reg_loss: 24827.8314; train_edge_recon_loss: 686720.9622; train_cat_covariates_contrastive_loss: 478523.1947; train_gene_expr_recon_loss: 1842608.7668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17322.1570; train_global_loss: 3050002.9137; train_optim_loss: 3050002.9137; val_kl_reg_loss: 24571.2213; val_edge_recon_loss: 703003.5634; val_cat_covariates_contrastive_loss: 479434.4103; val_gene_expr_recon_loss: 1853071.6034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17459.4492; val_global_loss: 3077540.3071; val_optim_loss: 3077540.3071
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9340; val_auprc_score: 0.9862; val_best_acc_score: 0.9377; val_best_f1_score: 0.9649; train_kl_reg_loss: 25165.1780; train_edge_recon_loss: 686162.7012; train_cat_covariates_contrastive_loss: 478712.8083; train_gene_expr_recon_loss: 1837869.1998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17489.4510; train_global_loss: 3045399.3360; train_optim_loss: 3045399.3360; val_kl_reg_loss: 25559.2455; val_edge_recon_loss: 707458.0285; val_cat_covariates_contrastive_loss: 478272.7183; val_gene_expr_recon_loss: 1848774.0575; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17614.4023; val_global_loss: 3077678.5407; val_optim_loss: 3077678.5407
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9393; val_auprc_score: 0.9874; val_best_acc_score: 0.9393; val_best_f1_score: 0.9657; train_kl_reg_loss: 25579.3371; train_edge_recon_loss: 686301.1048; train_cat_covariates_contrastive_loss: 478784.1148; train_gene_expr_recon_loss: 1830833.8406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17601.0993; train_global_loss: 3039099.4988; train_optim_loss: 3039099.4988; val_kl_reg_loss: 26355.9951; val_edge_recon_loss: 709104.0965; val_cat_covariates_contrastive_loss: 478954.1746; val_gene_expr_recon_loss: 1833707.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17724.6328; val_global_loss: 3065846.1237; val_optim_loss: 3065846.1237
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9243; val_auprc_score: 0.9845; val_best_acc_score: 0.9313; val_best_f1_score: 0.9613; train_kl_reg_loss: 26777.1026; train_edge_recon_loss: 709664.8356; train_cat_covariates_contrastive_loss: 478338.9832; train_gene_expr_recon_loss: 3278419.3058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18996.9843; train_global_loss: 4512197.2008; train_optim_loss: 4512197.2008; val_kl_reg_loss: 18886.9149; val_edge_recon_loss: 716962.2091; val_cat_covariates_contrastive_loss: 475916.9086; val_gene_expr_recon_loss: 2334293.9507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17499.5078; val_global_loss: 3563559.4784; val_optim_loss: 3563559.4784
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9356; val_auprc_score: 0.9864; val_best_acc_score: 0.9392; val_best_f1_score: 0.9658; train_kl_reg_loss: 24074.1433; train_edge_recon_loss: 687285.6366; train_cat_covariates_contrastive_loss: 477861.9152; train_gene_expr_recon_loss: 2037743.2181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17779.6098; train_global_loss: 3244744.5206; train_optim_loss: 3244744.5206; val_kl_reg_loss: 26274.8434; val_edge_recon_loss: 706557.7321; val_cat_covariates_contrastive_loss: 477447.4809; val_gene_expr_recon_loss: 1899388.6769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17493.8457; val_global_loss: 3127162.4853; val_optim_loss: 3127162.4853
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9392; val_auprc_score: 0.9872; val_best_acc_score: 0.9412; val_best_f1_score: 0.9668; train_kl_reg_loss: 26191.4685; train_edge_recon_loss: 683867.2515; train_cat_covariates_contrastive_loss: 479079.2844; train_gene_expr_recon_loss: 1862604.1045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17643.9321; train_global_loss: 3069386.0426; train_optim_loss: 3069386.0426; val_kl_reg_loss: 26733.5013; val_edge_recon_loss: 704592.5825; val_cat_covariates_contrastive_loss: 479322.7665; val_gene_expr_recon_loss: 1843240.2145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17504.2207; val_global_loss: 3071393.3209; val_optim_loss: 3071393.3209
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9313; val_auprc_score: 0.9849; val_best_acc_score: 0.9397; val_best_f1_score: 0.9660; train_kl_reg_loss: 26659.6389; train_edge_recon_loss: 685448.9177; train_cat_covariates_contrastive_loss: 479208.7357; train_gene_expr_recon_loss: 1829936.5637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17684.4295; train_global_loss: 3038938.2848; train_optim_loss: 3038938.2848; val_kl_reg_loss: 28055.4612; val_edge_recon_loss: 713546.7789; val_cat_covariates_contrastive_loss: 477646.6023; val_gene_expr_recon_loss: 1829578.3400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17806.4648; val_global_loss: 3066633.6782; val_optim_loss: 3066633.6782

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9389; val_auprc_score: 0.9872; val_best_acc_score: 0.9412; val_best_f1_score: 0.9670; train_kl_reg_loss: 26661.2404; train_edge_recon_loss: 682293.1338; train_cat_covariates_contrastive_loss: 479141.4594; train_gene_expr_recon_loss: 1794715.8971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9032.3912; train_global_loss: 2991844.1208; train_optim_loss: 2991844.1208; val_kl_reg_loss: 26725.1956; val_edge_recon_loss: 703654.6861; val_cat_covariates_contrastive_loss: 478743.9112; val_gene_expr_recon_loss: 1799966.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8999.3574; val_global_loss: 3018089.1843; val_optim_loss: 3018089.1843
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9404; val_auprc_score: 0.9874; val_best_acc_score: 0.9409; val_best_f1_score: 0.9667; train_kl_reg_loss: 26443.3989; train_edge_recon_loss: 683328.8667; train_cat_covariates_contrastive_loss: 479046.3057; train_gene_expr_recon_loss: 1787631.6930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8995.6644; train_global_loss: 2985445.9300; train_optim_loss: 2985445.9300; val_kl_reg_loss: 26310.7598; val_edge_recon_loss: 707541.6623; val_cat_covariates_contrastive_loss: 478819.3454; val_gene_expr_recon_loss: 1794394.0843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8978.5479; val_global_loss: 3016044.3503; val_optim_loss: 3016044.3503
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9401; val_auprc_score: 0.9873; val_best_acc_score: 0.9418; val_best_f1_score: 0.9671; train_kl_reg_loss: 26086.0096; train_edge_recon_loss: 683784.6685; train_cat_covariates_contrastive_loss: 478951.0641; train_gene_expr_recon_loss: 1783928.1268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9019.7535; train_global_loss: 2981769.6212; train_optim_loss: 2981769.6212; val_kl_reg_loss: 26259.4188; val_edge_recon_loss: 708006.2620; val_cat_covariates_contrastive_loss: 478557.1857; val_gene_expr_recon_loss: 1792790.0995; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9054.3535; val_global_loss: 3014667.2137; val_optim_loss: 3014667.2137
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9393; val_auprc_score: 0.9871; val_best_acc_score: 0.9408; val_best_f1_score: 0.9665; train_kl_reg_loss: 25843.3716; train_edge_recon_loss: 685630.1615; train_cat_covariates_contrastive_loss: 478793.9863; train_gene_expr_recon_loss: 1781487.1820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9057.8032; train_global_loss: 2980812.4998; train_optim_loss: 2980812.4998; val_kl_reg_loss: 26006.7599; val_edge_recon_loss: 708876.8067; val_cat_covariates_contrastive_loss: 478668.7618; val_gene_expr_recon_loss: 1791772.8292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9033.5557; val_global_loss: 3014358.6626; val_optim_loss: 3014358.6626
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9396; val_auprc_score: 0.9872; val_best_acc_score: 0.9414; val_best_f1_score: 0.9669; train_kl_reg_loss: 25704.4673; train_edge_recon_loss: 682748.3756; train_cat_covariates_contrastive_loss: 478748.8693; train_gene_expr_recon_loss: 1779433.3302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9074.5718; train_global_loss: 2975709.6169; train_optim_loss: 2975709.6169; val_kl_reg_loss: 25598.3225; val_edge_recon_loss: 707697.6925; val_cat_covariates_contrastive_loss: 478983.7033; val_gene_expr_recon_loss: 1789396.9157; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9084.9492; val_global_loss: 3010761.6306; val_optim_loss: 3010761.6306
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9410; val_auprc_score: 0.9878; val_best_acc_score: 0.9407; val_best_f1_score: 0.9665; train_kl_reg_loss: 25509.9802; train_edge_recon_loss: 683864.8060; train_cat_covariates_contrastive_loss: 478756.3327; train_gene_expr_recon_loss: 1778316.6255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9111.7300; train_global_loss: 2975559.4713; train_optim_loss: 2975559.4713; val_kl_reg_loss: 25386.5694; val_edge_recon_loss: 704995.5023; val_cat_covariates_contrastive_loss: 478779.8748; val_gene_expr_recon_loss: 1786797.4957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9136.2705; val_global_loss: 3005095.6886; val_optim_loss: 3005095.6886
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9411; val_auprc_score: 0.9875; val_best_acc_score: 0.9417; val_best_f1_score: 0.9671; train_kl_reg_loss: 25308.7800; train_edge_recon_loss: 682177.6840; train_cat_covariates_contrastive_loss: 478579.5581; train_gene_expr_recon_loss: 1777241.6342; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9137.4042; train_global_loss: 2972445.0590; train_optim_loss: 2972445.0590; val_kl_reg_loss: 25620.5143; val_edge_recon_loss: 703881.4150; val_cat_covariates_contrastive_loss: 477947.1178; val_gene_expr_recon_loss: 1785678.8555; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9175.9434; val_global_loss: 3002303.9083; val_optim_loss: 3002303.9083
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9409; val_auprc_score: 0.9877; val_best_acc_score: 0.9415; val_best_f1_score: 0.9670; train_kl_reg_loss: 25180.5768; train_edge_recon_loss: 684284.1060; train_cat_covariates_contrastive_loss: 478489.4442; train_gene_expr_recon_loss: 1775857.0731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9168.1615; train_global_loss: 2972979.3607; train_optim_loss: 2972979.3607; val_kl_reg_loss: 25244.2139; val_edge_recon_loss: 709016.2011; val_cat_covariates_contrastive_loss: 479053.2697; val_gene_expr_recon_loss: 1786665.0843; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9128.8125; val_global_loss: 3009107.5138; val_optim_loss: 3009107.5138
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9416; val_auprc_score: 0.9876; val_best_acc_score: 0.9421; val_best_f1_score: 0.9673; train_kl_reg_loss: 25100.5841; train_edge_recon_loss: 681574.3424; train_cat_covariates_contrastive_loss: 478568.3211; train_gene_expr_recon_loss: 1774800.1119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9191.1647; train_global_loss: 2969234.5240; train_optim_loss: 2969234.5240; val_kl_reg_loss: 25530.7111; val_edge_recon_loss: 713030.5067; val_cat_covariates_contrastive_loss: 477878.8888; val_gene_expr_recon_loss: 1783850.6773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9192.6387; val_global_loss: 3009483.5277; val_optim_loss: 3009483.5277
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9357; val_auprc_score: 0.9866; val_best_acc_score: 0.9379; val_best_f1_score: 0.9651; train_kl_reg_loss: 24495.9979; train_edge_recon_loss: 688726.4066; train_cat_covariates_contrastive_loss: 479055.3442; train_gene_expr_recon_loss: 1657056.9093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7756.8997; train_global_loss: 2857091.5581; train_optim_loss: 2857091.5581; val_kl_reg_loss: 19042.2573; val_edge_recon_loss: 706787.0056; val_cat_covariates_contrastive_loss: 478546.1311; val_gene_expr_recon_loss: 1657840.8235; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7226.7412; val_global_loss: 2869442.9602; val_optim_loss: 2869442.9602
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9360; val_auprc_score: 0.9867; val_best_acc_score: 0.9382; val_best_f1_score: 0.9652; train_kl_reg_loss: 23200.2912; train_edge_recon_loss: 684142.7993; train_cat_covariates_contrastive_loss: 478310.8856; train_gene_expr_recon_loss: 1648052.8680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7240.2836; train_global_loss: 2840947.1268; train_optim_loss: 2840947.1268; val_kl_reg_loss: 19379.1270; val_edge_recon_loss: 707865.2144; val_cat_covariates_contrastive_loss: 478522.4854; val_gene_expr_recon_loss: 1654242.5852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7177.4189; val_global_loss: 2867186.9109; val_optim_loss: 2867186.9109
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9353; val_auprc_score: 0.9863; val_best_acc_score: 0.9383; val_best_f1_score: 0.9652; train_kl_reg_loss: 22333.0913; train_edge_recon_loss: 684819.5049; train_cat_covariates_contrastive_loss: 477910.3027; train_gene_expr_recon_loss: 1643003.3326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7216.6300; train_global_loss: 2835282.8612; train_optim_loss: 2835282.8612; val_kl_reg_loss: 20034.3274; val_edge_recon_loss: 711727.0538; val_cat_covariates_contrastive_loss: 477938.3216; val_gene_expr_recon_loss: 1650378.5631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7251.3828; val_global_loss: 2867329.7682; val_optim_loss: 2867329.7682
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9372; val_auprc_score: 0.9871; val_best_acc_score: 0.9381; val_best_f1_score: 0.9652; train_kl_reg_loss: 21765.0169; train_edge_recon_loss: 685331.8298; train_cat_covariates_contrastive_loss: 477701.8831; train_gene_expr_recon_loss: 1639093.2889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7228.4150; train_global_loss: 2831120.4343; train_optim_loss: 2831120.4343; val_kl_reg_loss: 20212.0205; val_edge_recon_loss: 707088.9268; val_cat_covariates_contrastive_loss: 478426.6368; val_gene_expr_recon_loss: 1646934.5130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7264.3931; val_global_loss: 2859926.5995; val_optim_loss: 2859926.5995
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9370; val_auprc_score: 0.9870; val_best_acc_score: 0.9405; val_best_f1_score: 0.9665; train_kl_reg_loss: 21543.1954; train_edge_recon_loss: 684133.8610; train_cat_covariates_contrastive_loss: 477651.1897; train_gene_expr_recon_loss: 1636710.1391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7248.9466; train_global_loss: 2827287.3340; train_optim_loss: 2827287.3340; val_kl_reg_loss: 20340.8776; val_edge_recon_loss: 698376.2154; val_cat_covariates_contrastive_loss: 477681.9938; val_gene_expr_recon_loss: 1645718.7327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7261.0405; val_global_loss: 2849378.8123; val_optim_loss: 2849378.8123
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9382; val_auprc_score: 0.9871; val_best_acc_score: 0.9410; val_best_f1_score: 0.9668; train_kl_reg_loss: 21358.3176; train_edge_recon_loss: 684240.1044; train_cat_covariates_contrastive_loss: 477558.6483; train_gene_expr_recon_loss: 1634765.5285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7280.7249; train_global_loss: 2825203.3224; train_optim_loss: 2825203.3224; val_kl_reg_loss: 20641.5455; val_edge_recon_loss: 699233.5806; val_cat_covariates_contrastive_loss: 477229.0063; val_gene_expr_recon_loss: 1642322.3313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7214.4263; val_global_loss: 2846640.9611; val_optim_loss: 2846640.9611
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9378; val_auprc_score: 0.9869; val_best_acc_score: 0.9397; val_best_f1_score: 0.9660; train_kl_reg_loss: 21316.3923; train_edge_recon_loss: 683736.4954; train_cat_covariates_contrastive_loss: 477557.6792; train_gene_expr_recon_loss: 1632009.1878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7285.9233; train_global_loss: 2821905.6766; train_optim_loss: 2821905.6766; val_kl_reg_loss: 20467.8358; val_edge_recon_loss: 704553.5249; val_cat_covariates_contrastive_loss: 477778.1784; val_gene_expr_recon_loss: 1640014.9658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7304.8423; val_global_loss: 2850119.2491; val_optim_loss: 2850119.2491
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9363; val_auprc_score: 0.9863; val_best_acc_score: 0.9398; val_best_f1_score: 0.9661; train_kl_reg_loss: 21243.8203; train_edge_recon_loss: 682780.7676; train_cat_covariates_contrastive_loss: 477487.5026; train_gene_expr_recon_loss: 1629774.1327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7295.1417; train_global_loss: 2818581.3658; train_optim_loss: 2818581.3658; val_kl_reg_loss: 20737.2899; val_edge_recon_loss: 712091.5489; val_cat_covariates_contrastive_loss: 477442.1184; val_gene_expr_recon_loss: 1639426.1332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7280.3208; val_global_loss: 2856977.3382; val_optim_loss: 2856977.3382
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9368; val_auprc_score: 0.9866; val_best_acc_score: 0.9403; val_best_f1_score: 0.9664; train_kl_reg_loss: 21172.1212; train_edge_recon_loss: 681631.2761; train_cat_covariates_contrastive_loss: 477520.2260; train_gene_expr_recon_loss: 1627943.5384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7306.0903; train_global_loss: 2815573.2556; train_optim_loss: 2815573.2556; val_kl_reg_loss: 20865.8133; val_edge_recon_loss: 703860.0179; val_cat_covariates_contrastive_loss: 477053.5337; val_gene_expr_recon_loss: 1637456.9753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7267.7373; val_global_loss: 2846504.0830; val_optim_loss: 2846504.0830
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9373; val_auprc_score: 0.9870; val_best_acc_score: 0.9402; val_best_f1_score: 0.9664; train_kl_reg_loss: 21113.0655; train_edge_recon_loss: 683154.3695; train_cat_covariates_contrastive_loss: 477462.6656; train_gene_expr_recon_loss: 1626617.8900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7316.7687; train_global_loss: 2815664.7564; train_optim_loss: 2815664.7564; val_kl_reg_loss: 20767.1770; val_edge_recon_loss: 699321.8627; val_cat_covariates_contrastive_loss: 477011.1052; val_gene_expr_recon_loss: 1636707.4879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7277.0200; val_global_loss: 2841084.6349; val_optim_loss: 2841084.6349
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9356; val_auprc_score: 0.9863; val_best_acc_score: 0.9404; val_best_f1_score: 0.9663; train_kl_reg_loss: 21078.1518; train_edge_recon_loss: 682032.1932; train_cat_covariates_contrastive_loss: 477408.7446; train_gene_expr_recon_loss: 1626464.7585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7319.6625; train_global_loss: 2814303.5115; train_optim_loss: 2814303.5115; val_kl_reg_loss: 20677.1562; val_edge_recon_loss: 709916.0796; val_cat_covariates_contrastive_loss: 477006.9799; val_gene_expr_recon_loss: 1634233.3218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7286.6631; val_global_loss: 2849120.2924; val_optim_loss: 2849120.2924
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9358; val_auprc_score: 0.9865; val_best_acc_score: 0.9403; val_best_f1_score: 0.9663; train_kl_reg_loss: 20969.9158; train_edge_recon_loss: 679840.9051; train_cat_covariates_contrastive_loss: 477281.8557; train_gene_expr_recon_loss: 1625239.6889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7334.3362; train_global_loss: 2810666.6987; train_optim_loss: 2810666.6987; val_kl_reg_loss: 20650.7400; val_edge_recon_loss: 701506.1726; val_cat_covariates_contrastive_loss: 477252.2451; val_gene_expr_recon_loss: 1634807.3106; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7310.6504; val_global_loss: 2841527.2249; val_optim_loss: 2841527.2249
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9387; val_auprc_score: 0.9873; val_best_acc_score: 0.9402; val_best_f1_score: 0.9663; train_kl_reg_loss: 20927.9372; train_edge_recon_loss: 682900.4681; train_cat_covariates_contrastive_loss: 477356.9292; train_gene_expr_recon_loss: 1624867.8902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7349.1959; train_global_loss: 2813402.4196; train_optim_loss: 2813402.4196; val_kl_reg_loss: 20372.7539; val_edge_recon_loss: 706372.4672; val_cat_covariates_contrastive_loss: 477753.6723; val_gene_expr_recon_loss: 1634290.0160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7343.3599; val_global_loss: 2846132.1618; val_optim_loss: 2846132.1618
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9379; val_auprc_score: 0.9869; val_best_acc_score: 0.9397; val_best_f1_score: 0.9661; train_kl_reg_loss: 20900.2169; train_edge_recon_loss: 683919.7253; train_cat_covariates_contrastive_loss: 477267.7510; train_gene_expr_recon_loss: 1623457.7616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7359.3220; train_global_loss: 2812904.7775; train_optim_loss: 2812904.7775; val_kl_reg_loss: 20473.1217; val_edge_recon_loss: 704928.6249; val_cat_covariates_contrastive_loss: 477423.2662; val_gene_expr_recon_loss: 1632563.9343; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7352.4771; val_global_loss: 2842741.4377; val_optim_loss: 2842741.4377

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9391; val_auprc_score: 0.9874; val_best_acc_score: 0.9399; val_best_f1_score: 0.9661; train_kl_reg_loss: 20796.6318; train_edge_recon_loss: 682643.5051; train_cat_covariates_contrastive_loss: 477252.6403; train_gene_expr_recon_loss: 1619636.4557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6618.6934; train_global_loss: 2806947.9235; train_optim_loss: 2806947.9235; val_kl_reg_loss: 20487.9275; val_edge_recon_loss: 710077.1803; val_cat_covariates_contrastive_loss: 477375.5929; val_gene_expr_recon_loss: 1628644.0631; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6610.5820; val_global_loss: 2843195.2612; val_optim_loss: 2843195.2612
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9368; val_auprc_score: 0.9867; val_best_acc_score: 0.9402; val_best_f1_score: 0.9662; train_kl_reg_loss: 20845.2601; train_edge_recon_loss: 681577.4226; train_cat_covariates_contrastive_loss: 477195.8491; train_gene_expr_recon_loss: 1618860.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6600.4658; train_global_loss: 2805079.8745; train_optim_loss: 2805079.8745; val_kl_reg_loss: 20654.0160; val_edge_recon_loss: 705648.0122; val_cat_covariates_contrastive_loss: 477350.6371; val_gene_expr_recon_loss: 1626817.8274; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6598.1748; val_global_loss: 2837068.7483; val_optim_loss: 2837068.7483
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9390; val_auprc_score: 0.9870; val_best_acc_score: 0.9405; val_best_f1_score: 0.9663; train_kl_reg_loss: 20831.8839; train_edge_recon_loss: 682238.2987; train_cat_covariates_contrastive_loss: 477221.7255; train_gene_expr_recon_loss: 1618780.9977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6598.9010; train_global_loss: 2805671.8113; train_optim_loss: 2805671.8113; val_kl_reg_loss: 20590.8999; val_edge_recon_loss: 708552.4531; val_cat_covariates_contrastive_loss: 477019.6439; val_gene_expr_recon_loss: 1628524.0294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6591.0601; val_global_loss: 2841278.0234; val_optim_loss: 2841278.0234
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9381; val_auprc_score: 0.9869; val_best_acc_score: 0.9400; val_best_f1_score: 0.9661; train_kl_reg_loss: 20837.4067; train_edge_recon_loss: 682425.8249; train_cat_covariates_contrastive_loss: 477150.6802; train_gene_expr_recon_loss: 1618312.4448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6591.4985; train_global_loss: 2805317.8550; train_optim_loss: 2805317.8550; val_kl_reg_loss: 20564.2611; val_edge_recon_loss: 708589.1248; val_cat_covariates_contrastive_loss: 477223.3397; val_gene_expr_recon_loss: 1628656.1903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6584.7222; val_global_loss: 2841617.6670; val_optim_loss: 2841617.6670
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9372; val_auprc_score: 0.9868; val_best_acc_score: 0.9400; val_best_f1_score: 0.9662; train_kl_reg_loss: 20818.0532; train_edge_recon_loss: 682300.7875; train_cat_covariates_contrastive_loss: 477240.1086; train_gene_expr_recon_loss: 1618104.7586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6588.8701; train_global_loss: 2805052.5753; train_optim_loss: 2805052.5753; val_kl_reg_loss: 20585.3819; val_edge_recon_loss: 702752.2655; val_cat_covariates_contrastive_loss: 476870.8380; val_gene_expr_recon_loss: 1627177.9680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6592.0483; val_global_loss: 2833978.4663; val_optim_loss: 2833978.4663
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9376; val_auprc_score: 0.9867; val_best_acc_score: 0.9406; val_best_f1_score: 0.9665; train_kl_reg_loss: 20837.1501; train_edge_recon_loss: 681216.9104; train_cat_covariates_contrastive_loss: 477119.5655; train_gene_expr_recon_loss: 1617677.7960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6588.1708; train_global_loss: 2803439.5948; train_optim_loss: 2803439.5948; val_kl_reg_loss: 20556.6455; val_edge_recon_loss: 704912.2379; val_cat_covariates_contrastive_loss: 477343.5255; val_gene_expr_recon_loss: 1627870.2954; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6577.4341; val_global_loss: 2837260.2111; val_optim_loss: 2837260.2111
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9384; val_auprc_score: 0.9870; val_best_acc_score: 0.9402; val_best_f1_score: 0.9662; train_kl_reg_loss: 20799.0625; train_edge_recon_loss: 681128.0186; train_cat_covariates_contrastive_loss: 477106.7762; train_gene_expr_recon_loss: 1617382.4487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6591.1030; train_global_loss: 2803007.4082; train_optim_loss: 2803007.4082; val_kl_reg_loss: 20508.5185; val_edge_recon_loss: 708163.9186; val_cat_covariates_contrastive_loss: 477391.2380; val_gene_expr_recon_loss: 1627657.1907; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6596.7031; val_global_loss: 2840317.6107; val_optim_loss: 2840317.6107
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9404; val_auprc_score: 0.9874; val_best_acc_score: 0.9410; val_best_f1_score: 0.9667; train_kl_reg_loss: 20779.8362; train_edge_recon_loss: 680697.8457; train_cat_covariates_contrastive_loss: 477134.0267; train_gene_expr_recon_loss: 1617393.7135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6598.3294; train_global_loss: 2802603.7531; train_optim_loss: 2802603.7531; val_kl_reg_loss: 20518.3649; val_edge_recon_loss: 703232.5465; val_cat_covariates_contrastive_loss: 477096.0854; val_gene_expr_recon_loss: 1630341.6224; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6597.1118; val_global_loss: 2837785.6220; val_optim_loss: 2837785.6220
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9409; val_auprc_score: 0.9877; val_best_acc_score: 0.9415; val_best_f1_score: 0.9670; train_kl_reg_loss: 20795.2663; train_edge_recon_loss: 681375.0151; train_cat_covariates_contrastive_loss: 477154.4121; train_gene_expr_recon_loss: 1618358.3401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6596.6749; train_global_loss: 2804279.7079; train_optim_loss: 2804279.7079; val_kl_reg_loss: 20550.7641; val_edge_recon_loss: 699204.1090; val_cat_covariates_contrastive_loss: 477325.4733; val_gene_expr_recon_loss: 1630114.2033; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6590.2227; val_global_loss: 2833784.8080; val_optim_loss: 2833784.8080
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9402; val_auprc_score: 0.9875; val_best_acc_score: 0.9415; val_best_f1_score: 0.9670; train_kl_reg_loss: 20765.5807; train_edge_recon_loss: 681643.2642; train_cat_covariates_contrastive_loss: 477179.6139; train_gene_expr_recon_loss: 1618445.6308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6595.8660; train_global_loss: 2804629.9531; train_optim_loss: 2804629.9531; val_kl_reg_loss: 20536.1250; val_edge_recon_loss: 698813.0221; val_cat_covariates_contrastive_loss: 477074.3348; val_gene_expr_recon_loss: 1629855.6215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6591.3706; val_global_loss: 2832870.3512; val_optim_loss: 2832870.3512
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9386; val_auprc_score: 0.9872; val_best_acc_score: 0.9402; val_best_f1_score: 0.9663; train_kl_reg_loss: 20763.1886; train_edge_recon_loss: 682152.8142; train_cat_covariates_contrastive_loss: 477218.5794; train_gene_expr_recon_loss: 1618536.7053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6598.9778; train_global_loss: 2805270.2666; train_optim_loss: 2805270.2666; val_kl_reg_loss: 20611.2477; val_edge_recon_loss: 703831.7557; val_cat_covariates_contrastive_loss: 477080.7103; val_gene_expr_recon_loss: 1629028.7599; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6590.1074; val_global_loss: 2837142.4775; val_optim_loss: 2837142.4775
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9387; val_auprc_score: 0.9871; val_best_acc_score: 0.9407; val_best_f1_score: 0.9665; train_kl_reg_loss: 20763.7365; train_edge_recon_loss: 683526.9655; train_cat_covariates_contrastive_loss: 477109.7759; train_gene_expr_recon_loss: 1617891.9052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6599.5401; train_global_loss: 2805891.9212; train_optim_loss: 2805891.9212; val_kl_reg_loss: 20476.9367; val_edge_recon_loss: 703722.1696; val_cat_covariates_contrastive_loss: 477370.3393; val_gene_expr_recon_loss: 1627375.3123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6606.8057; val_global_loss: 2835551.5078; val_optim_loss: 2835551.5078
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9383; val_auprc_score: 0.9871; val_best_acc_score: 0.9411; val_best_f1_score: 0.9667; train_kl_reg_loss: 20756.3293; train_edge_recon_loss: 682340.0557; train_cat_covariates_contrastive_loss: 477162.2984; train_gene_expr_recon_loss: 1618000.6091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6602.4838; train_global_loss: 2804861.7761; train_optim_loss: 2804861.7761; val_kl_reg_loss: 20544.0654; val_edge_recon_loss: 704863.1255; val_cat_covariates_contrastive_loss: 476834.9746; val_gene_expr_recon_loss: 1628220.0792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6626.5190; val_global_loss: 2837088.7318; val_optim_loss: 2837088.7318
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9386; val_auprc_score: 0.9869; val_best_acc_score: 0.9413; val_best_f1_score: 0.9669; train_kl_reg_loss: 20733.8462; train_edge_recon_loss: 682150.9218; train_cat_covariates_contrastive_loss: 477175.0868; train_gene_expr_recon_loss: 1617449.2096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6608.7595; train_global_loss: 2804117.8245; train_optim_loss: 2804117.8245; val_kl_reg_loss: 20569.4366; val_edge_recon_loss: 699933.3900; val_cat_covariates_contrastive_loss: 477069.1453; val_gene_expr_recon_loss: 1627794.2513; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6625.3408; val_global_loss: 2831991.4723; val_optim_loss: 2831991.4723
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9381; val_auprc_score: 0.9868; val_best_acc_score: 0.9410; val_best_f1_score: 0.9666; train_kl_reg_loss: 20730.7473; train_edge_recon_loss: 680846.6306; train_cat_covariates_contrastive_loss: 477126.7700; train_gene_expr_recon_loss: 1617912.4586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6603.6263; train_global_loss: 2803220.2325; train_optim_loss: 2803220.2325; val_kl_reg_loss: 20533.5695; val_edge_recon_loss: 708369.3917; val_cat_covariates_contrastive_loss: 477441.6820; val_gene_expr_recon_loss: 1629023.8997; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6595.6772; val_global_loss: 2841964.2829; val_optim_loss: 2841964.2829
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9401; val_auprc_score: 0.9875; val_best_acc_score: 0.9404; val_best_f1_score: 0.9664; train_kl_reg_loss: 20726.5152; train_edge_recon_loss: 682289.3235; train_cat_covariates_contrastive_loss: 477185.9774; train_gene_expr_recon_loss: 1618095.4277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6604.5845; train_global_loss: 2804901.8287; train_optim_loss: 2804901.8287; val_kl_reg_loss: 20524.4343; val_edge_recon_loss: 703900.1863; val_cat_covariates_contrastive_loss: 476970.9906; val_gene_expr_recon_loss: 1629919.5350; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6599.2866; val_global_loss: 2837914.3910; val_optim_loss: 2837914.3910
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9375; val_auprc_score: 0.9869; val_best_acc_score: 0.9405; val_best_f1_score: 0.9665; train_kl_reg_loss: 20697.6743; train_edge_recon_loss: 682573.8315; train_cat_covariates_contrastive_loss: 477149.6044; train_gene_expr_recon_loss: 1617802.3073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6601.9465; train_global_loss: 2804825.3636; train_optim_loss: 2804825.3636; val_kl_reg_loss: 20557.9590; val_edge_recon_loss: 700555.0595; val_cat_covariates_contrastive_loss: 477183.9399; val_gene_expr_recon_loss: 1629749.1795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6608.0757; val_global_loss: 2834654.1194; val_optim_loss: 2834654.1194
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9378; val_auprc_score: 0.9866; val_best_acc_score: 0.9401; val_best_f1_score: 0.9662; train_kl_reg_loss: 20707.6762; train_edge_recon_loss: 679813.0534; train_cat_covariates_contrastive_loss: 477119.5471; train_gene_expr_recon_loss: 1617491.7052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6606.1041; train_global_loss: 2801738.0872; train_optim_loss: 2801738.0872; val_kl_reg_loss: 20519.1442; val_edge_recon_loss: 711150.9578; val_cat_covariates_contrastive_loss: 477304.2461; val_gene_expr_recon_loss: 1628571.4113; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6606.5527; val_global_loss: 2844152.2604; val_optim_loss: 2844152.2604

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9392; val_auprc_score: 0.9873; val_best_acc_score: 0.9408; val_best_f1_score: 0.9666; train_kl_reg_loss: 20726.3642; train_edge_recon_loss: 681351.5276; train_cat_covariates_contrastive_loss: 477125.1738; train_gene_expr_recon_loss: 1617036.8170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6524.7285; train_global_loss: 2802764.6138; train_optim_loss: 2802764.6138; val_kl_reg_loss: 20543.4312; val_edge_recon_loss: 704696.8200; val_cat_covariates_contrastive_loss: 476954.9962; val_gene_expr_recon_loss: 1629305.3785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6526.5596; val_global_loss: 2838027.1341; val_optim_loss: 2838027.1341
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9402; val_auprc_score: 0.9876; val_best_acc_score: 0.9412; val_best_f1_score: 0.9668; train_kl_reg_loss: 20705.6608; train_edge_recon_loss: 682900.7331; train_cat_covariates_contrastive_loss: 477060.6151; train_gene_expr_recon_loss: 1617928.5304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6524.7031; train_global_loss: 2805120.2437; train_optim_loss: 2805120.2437; val_kl_reg_loss: 20530.1439; val_edge_recon_loss: 702005.7916; val_cat_covariates_contrastive_loss: 476996.6103; val_gene_expr_recon_loss: 1627851.1259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6524.8799; val_global_loss: 2833908.6791; val_optim_loss: 2833908.6791
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9393; val_auprc_score: 0.9870; val_best_acc_score: 0.9408; val_best_f1_score: 0.9665; train_kl_reg_loss: 20690.6359; train_edge_recon_loss: 681265.8558; train_cat_covariates_contrastive_loss: 477070.4005; train_gene_expr_recon_loss: 1617358.8689; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6523.7450; train_global_loss: 2802909.5080; train_optim_loss: 2802909.5080; val_kl_reg_loss: 20482.1221; val_edge_recon_loss: 707802.7876; val_cat_covariates_contrastive_loss: 477087.1433; val_gene_expr_recon_loss: 1627128.4684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6522.3091; val_global_loss: 2839022.7708; val_optim_loss: 2839022.7708
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9397; val_auprc_score: 0.9872; val_best_acc_score: 0.9409; val_best_f1_score: 0.9666; train_kl_reg_loss: 20691.8669; train_edge_recon_loss: 678933.5905; train_cat_covariates_contrastive_loss: 477017.4837; train_gene_expr_recon_loss: 1616820.2011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6522.9424; train_global_loss: 2799986.0858; train_optim_loss: 2799986.0858; val_kl_reg_loss: 20493.6413; val_edge_recon_loss: 703461.0435; val_cat_covariates_contrastive_loss: 476888.3170; val_gene_expr_recon_loss: 1628360.8811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6524.5254; val_global_loss: 2835728.3901; val_optim_loss: 2835728.3901

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1213 min 17 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9292
val AUPRC score: 0.9825
val best accuracy score: 0.9396
val best F1 score: 0.9659
val target rna MSE score: 0.3931
val source rna MSE score: 0.1426
Val cat covariate0 mean sim diff: -0.0008
Val cat covariate1 mean sim diff: -0.0607
Val cat covariate2 mean sim diff: -0.0002

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
