[True]
Run timestamp: 07082023_201438_92.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_92']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8887; val_auprc_score: 0.9093; val_best_acc_score: 0.5032; val_best_f1_score: 0.6681; train_kl_reg_loss: 10830.4489; train_edge_recon_loss: 349319.7326; train_gene_expr_recon_loss: 1247669.6528; train_masked_gp_l1_reg_loss: 4482.9132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119318.7170; train_chrom_access_recon_loss: 936481.3646; train_global_loss: 2668102.8611; train_optim_loss: 2668102.8611; val_kl_reg_loss: 3361.7798; val_edge_recon_loss: 406525.0938; val_gene_expr_recon_loss: 1104671.7500; val_masked_gp_l1_reg_loss: 3910.1697; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116953.9688; val_chrom_access_recon_loss: 536404.0625; val_global_loss: 2171826.7500; val_optim_loss: 2171826.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8952; val_auprc_score: 0.9143; val_best_acc_score: 0.5008; val_best_f1_score: 0.6669; train_kl_reg_loss: 3295.0484; train_edge_recon_loss: 349517.7118; train_gene_expr_recon_loss: 1073908.3750; train_masked_gp_l1_reg_loss: 3789.4711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115519.5911; train_chrom_access_recon_loss: 498918.6840; train_global_loss: 2044948.8611; train_optim_loss: 2044948.8611; val_kl_reg_loss: 4279.7373; val_edge_recon_loss: 406562.2812; val_gene_expr_recon_loss: 1008759.0625; val_masked_gp_l1_reg_loss: 3773.6660; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113773.0312; val_chrom_access_recon_loss: 484680.4688; val_global_loss: 2021828.2500; val_optim_loss: 2021828.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8997; val_auprc_score: 0.9134; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 9672.9501; train_edge_recon_loss: 353324.0625; train_gene_expr_recon_loss: 940940.7917; train_masked_gp_l1_reg_loss: 3927.1731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112375.6536; train_chrom_access_recon_loss: 482861.2639; train_global_loss: 1903101.8194; train_optim_loss: 1903101.8194; val_kl_reg_loss: 15506.1309; val_edge_recon_loss: 406603.0938; val_gene_expr_recon_loss: 848916.3125; val_masked_gp_l1_reg_loss: 4106.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110590.8516; val_chrom_access_recon_loss: 480666.5625; val_global_loss: 1866389.2500; val_optim_loss: 1866389.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8812; val_auprc_score: 0.9002; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16846.5413; train_edge_recon_loss: 358770.2917; train_gene_expr_recon_loss: 812988.9653; train_masked_gp_l1_reg_loss: 4165.8728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109019.7656; train_chrom_access_recon_loss: 472083.2778; train_global_loss: 1773874.6944; train_optim_loss: 1773874.6944; val_kl_reg_loss: 16394.6289; val_edge_recon_loss: 406597.0938; val_gene_expr_recon_loss: 780718.5625; val_masked_gp_l1_reg_loss: 4216.5630; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106944.5469; val_chrom_access_recon_loss: 465666.6562; val_global_loss: 1780538.0000; val_optim_loss: 1780538.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8857; val_auprc_score: 0.8975; val_best_acc_score: 0.5027; val_best_f1_score: 0.6679; train_kl_reg_loss: 16716.2919; train_edge_recon_loss: 357919.7431; train_gene_expr_recon_loss: 774084.8542; train_masked_gp_l1_reg_loss: 4258.9135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105130.3481; train_chrom_access_recon_loss: 460206.4062; train_global_loss: 1718316.5278; train_optim_loss: 1718316.5278; val_kl_reg_loss: 17017.0137; val_edge_recon_loss: 406564.7812; val_gene_expr_recon_loss: 745572.6875; val_masked_gp_l1_reg_loss: 4305.8120; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102789.5938; val_chrom_access_recon_loss: 454286.8125; val_global_loss: 1730536.7500; val_optim_loss: 1730536.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8758; val_auprc_score: 0.8823; val_best_acc_score: 0.5156; val_best_f1_score: 0.6734; train_kl_reg_loss: 17920.4408; train_edge_recon_loss: 358356.6667; train_gene_expr_recon_loss: 735974.7986; train_masked_gp_l1_reg_loss: 4329.4065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100824.6016; train_chrom_access_recon_loss: 452826.6979; train_global_loss: 1670232.6250; train_optim_loss: 1670232.6250; val_kl_reg_loss: 17547.2656; val_edge_recon_loss: 406489.4062; val_gene_expr_recon_loss: 723188.3750; val_masked_gp_l1_reg_loss: 4337.8423; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98321.0156; val_chrom_access_recon_loss: 450359.8125; val_global_loss: 1700243.7500; val_optim_loss: 1700243.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8644; val_auprc_score: 0.8716; val_best_acc_score: 0.5300; val_best_f1_score: 0.6784; train_kl_reg_loss: 17786.4377; train_edge_recon_loss: 357964.3889; train_gene_expr_recon_loss: 719614.7014; train_masked_gp_l1_reg_loss: 4342.3139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96271.9132; train_chrom_access_recon_loss: 448316.2118; train_global_loss: 1644295.9444; train_optim_loss: 1644295.9444; val_kl_reg_loss: 17234.3672; val_edge_recon_loss: 406298.9375; val_gene_expr_recon_loss: 708602.8125; val_masked_gp_l1_reg_loss: 4337.3481; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93697.2500; val_chrom_access_recon_loss: 447602.5000; val_global_loss: 1677773.2500; val_optim_loss: 1677773.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8483; val_auprc_score: 0.8489; val_best_acc_score: 0.5724; val_best_f1_score: 0.6960; train_kl_reg_loss: 17886.1580; train_edge_recon_loss: 357839.4653; train_gene_expr_recon_loss: 705594.4097; train_masked_gp_l1_reg_loss: 4334.2142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91635.9054; train_chrom_access_recon_loss: 445408.7500; train_global_loss: 1622698.9028; train_optim_loss: 1622698.9028; val_kl_reg_loss: 17529.1250; val_edge_recon_loss: 405927.3125; val_gene_expr_recon_loss: 696766.2500; val_masked_gp_l1_reg_loss: 4326.3257; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89065.4688; val_chrom_access_recon_loss: 445818.1562; val_global_loss: 1659432.7500; val_optim_loss: 1659432.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8382; val_auprc_score: 0.8354; val_best_acc_score: 0.6475; val_best_f1_score: 0.7306; train_kl_reg_loss: 18169.8184; train_edge_recon_loss: 357493.2049; train_gene_expr_recon_loss: 695959.7708; train_masked_gp_l1_reg_loss: 4332.6859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87028.1840; train_chrom_access_recon_loss: 442244.6215; train_global_loss: 1605228.2778; train_optim_loss: 1605228.2778; val_kl_reg_loss: 17497.7734; val_edge_recon_loss: 405112.6250; val_gene_expr_recon_loss: 687374.0000; val_masked_gp_l1_reg_loss: 4332.7412; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84493.4062; val_chrom_access_recon_loss: 444340.0000; val_global_loss: 1643150.5000; val_optim_loss: 1643150.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8274; val_auprc_score: 0.8181; val_best_acc_score: 0.7083; val_best_f1_score: 0.7585; train_kl_reg_loss: 18277.8188; train_edge_recon_loss: 357227.4410; train_gene_expr_recon_loss: 687365.0208; train_masked_gp_l1_reg_loss: 4336.6780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82502.7943; train_chrom_access_recon_loss: 444605.6285; train_global_loss: 1594315.3611; train_optim_loss: 1594315.3611; val_kl_reg_loss: 17397.4102; val_edge_recon_loss: 403744.7500; val_gene_expr_recon_loss: 680045.3750; val_masked_gp_l1_reg_loss: 4334.7231; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80036.6172; val_chrom_access_recon_loss: 443116.5000; val_global_loss: 1628675.3750; val_optim_loss: 1628675.3750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8323; val_auprc_score: 0.8282; val_best_acc_score: 0.7510; val_best_f1_score: 0.7724; train_kl_reg_loss: 18242.3776; train_edge_recon_loss: 356738.0208; train_gene_expr_recon_loss: 678015.0972; train_masked_gp_l1_reg_loss: 4344.9336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78108.3637; train_chrom_access_recon_loss: 440972.5764; train_global_loss: 1576421.4167; train_optim_loss: 1576421.4167; val_kl_reg_loss: 16509.6191; val_edge_recon_loss: 401447.2500; val_gene_expr_recon_loss: 675472.6250; val_masked_gp_l1_reg_loss: 4345.6685; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75727.2031; val_chrom_access_recon_loss: 441921.0312; val_global_loss: 1615423.3750; val_optim_loss: 1615423.3750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8318; val_auprc_score: 0.8234; val_best_acc_score: 0.7517; val_best_f1_score: 0.7483; train_kl_reg_loss: 18160.9785; train_edge_recon_loss: 356013.8299; train_gene_expr_recon_loss: 678704.0278; train_masked_gp_l1_reg_loss: 4354.4157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73883.4349; train_chrom_access_recon_loss: 441073.0903; train_global_loss: 1572189.7639; train_optim_loss: 1572189.7639; val_kl_reg_loss: 16971.8711; val_edge_recon_loss: 398126.5312; val_gene_expr_recon_loss: 670730.1875; val_masked_gp_l1_reg_loss: 4357.5151; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71606.5547; val_chrom_access_recon_loss: 440744.8750; val_global_loss: 1602537.5000; val_optim_loss: 1602537.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8338; val_auprc_score: 0.8240; val_best_acc_score: 0.7385; val_best_f1_score: 0.7618; train_kl_reg_loss: 17890.2574; train_edge_recon_loss: 354785.4514; train_gene_expr_recon_loss: 671470.3056; train_masked_gp_l1_reg_loss: 4374.0814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69846.0017; train_chrom_access_recon_loss: 440570.9861; train_global_loss: 1558937.0972; train_optim_loss: 1558937.0972; val_kl_reg_loss: 16015.3838; val_edge_recon_loss: 395024.8125; val_gene_expr_recon_loss: 667913.9375; val_masked_gp_l1_reg_loss: 4384.4380; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67670.0312; val_chrom_access_recon_loss: 439899.2812; val_global_loss: 1590907.8750; val_optim_loss: 1590907.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8525; val_auprc_score: 0.8409; val_best_acc_score: 0.7650; val_best_f1_score: 0.7873; train_kl_reg_loss: 17386.6100; train_edge_recon_loss: 353350.1528; train_gene_expr_recon_loss: 671194.4653; train_masked_gp_l1_reg_loss: 4400.5883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65999.3806; train_chrom_access_recon_loss: 438616.8681; train_global_loss: 1550948.0278; train_optim_loss: 1550948.0278; val_kl_reg_loss: 16050.4316; val_edge_recon_loss: 388117.9062; val_gene_expr_recon_loss: 664903.6875; val_masked_gp_l1_reg_loss: 4411.3813; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63946.9609; val_chrom_access_recon_loss: 439034.0000; val_global_loss: 1576464.3750; val_optim_loss: 1576464.3750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8662; val_auprc_score: 0.8519; val_best_acc_score: 0.7901; val_best_f1_score: 0.7959; train_kl_reg_loss: 16844.9427; train_edge_recon_loss: 350936.9236; train_gene_expr_recon_loss: 665232.3542; train_masked_gp_l1_reg_loss: 4432.7760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62380.4779; train_chrom_access_recon_loss: 437051.3854; train_global_loss: 1536878.8333; train_optim_loss: 1536878.8333; val_kl_reg_loss: 15824.8643; val_edge_recon_loss: 378387.2812; val_gene_expr_recon_loss: 662925.5000; val_masked_gp_l1_reg_loss: 4446.4863; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60459.8242; val_chrom_access_recon_loss: 438226.0625; val_global_loss: 1560270.0000; val_optim_loss: 1560270.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8877; val_auprc_score: 0.8726; val_best_acc_score: 0.8096; val_best_f1_score: 0.8198; train_kl_reg_loss: 16462.3358; train_edge_recon_loss: 345448.2118; train_gene_expr_recon_loss: 663776.9306; train_masked_gp_l1_reg_loss: 4468.0206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59001.8155; train_chrom_access_recon_loss: 437567.8542; train_global_loss: 1526725.1389; train_optim_loss: 1526725.1389; val_kl_reg_loss: 15640.5605; val_edge_recon_loss: 356092.2812; val_gene_expr_recon_loss: 662224.0625; val_masked_gp_l1_reg_loss: 4488.2681; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57216.3750; val_chrom_access_recon_loss: 437835.5938; val_global_loss: 1533497.1250; val_optim_loss: 1533497.1250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8961; val_auprc_score: 0.8853; val_best_acc_score: 0.8134; val_best_f1_score: 0.8203; train_kl_reg_loss: 17267.5361; train_edge_recon_loss: 333888.7049; train_gene_expr_recon_loss: 666682.8958; train_masked_gp_l1_reg_loss: 4516.7626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55860.9805; train_chrom_access_recon_loss: 437341.1736; train_global_loss: 1515558.0417; train_optim_loss: 1515558.0417; val_kl_reg_loss: 19077.8398; val_edge_recon_loss: 329432.5625; val_gene_expr_recon_loss: 662168.5625; val_masked_gp_l1_reg_loss: 4549.1074; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54205.1641; val_chrom_access_recon_loss: 437514.4375; val_global_loss: 1506947.7500; val_optim_loss: 1506947.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8926; val_auprc_score: 0.8754; val_best_acc_score: 0.8126; val_best_f1_score: 0.8216; train_kl_reg_loss: 23327.5822; train_edge_recon_loss: 316555.6840; train_gene_expr_recon_loss: 667610.4722; train_masked_gp_l1_reg_loss: 4583.7891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52957.5204; train_chrom_access_recon_loss: 437545.7743; train_global_loss: 1502580.8472; train_optim_loss: 1502580.8472; val_kl_reg_loss: 26449.6738; val_edge_recon_loss: 312956.9688; val_gene_expr_recon_loss: 660223.1250; val_masked_gp_l1_reg_loss: 4622.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51433.8828; val_chrom_access_recon_loss: 436571.7188; val_global_loss: 1492257.7500; val_optim_loss: 1492257.7500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8966; val_auprc_score: 0.8730; val_best_acc_score: 0.8189; val_best_f1_score: 0.8305; train_kl_reg_loss: 27508.7153; train_edge_recon_loss: 308983.1840; train_gene_expr_recon_loss: 663685.4306; train_masked_gp_l1_reg_loss: 4653.5700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50285.7352; train_chrom_access_recon_loss: 434761.1424; train_global_loss: 1489877.7778; train_optim_loss: 1489877.7778; val_kl_reg_loss: 25538.0625; val_edge_recon_loss: 308824.1875; val_gene_expr_recon_loss: 658851.8750; val_masked_gp_l1_reg_loss: 4685.6040; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48873.8594; val_chrom_access_recon_loss: 435754.4062; val_global_loss: 1482528.0000; val_optim_loss: 1482528.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9109; val_auprc_score: 0.8898; val_best_acc_score: 0.8323; val_best_f1_score: 0.8438; train_kl_reg_loss: 25542.0618; train_edge_recon_loss: 305848.0451; train_gene_expr_recon_loss: 655970.9792; train_masked_gp_l1_reg_loss: 4716.8155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47809.3082; train_chrom_access_recon_loss: 433918.0729; train_global_loss: 1473805.3056; train_optim_loss: 1473805.3056; val_kl_reg_loss: 24780.6133; val_edge_recon_loss: 303181.8438; val_gene_expr_recon_loss: 657893.9375; val_masked_gp_l1_reg_loss: 4743.5347; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46502.2188; val_chrom_access_recon_loss: 435001.8438; val_global_loss: 1472104.0000; val_optim_loss: 1472104.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9127; val_auprc_score: 0.8892; val_best_acc_score: 0.8391; val_best_f1_score: 0.8518; train_kl_reg_loss: 25024.2148; train_edge_recon_loss: 301706.4618; train_gene_expr_recon_loss: 656472.0069; train_masked_gp_l1_reg_loss: 4766.5839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45506.2539; train_chrom_access_recon_loss: 432774.5972; train_global_loss: 1466250.1111; train_optim_loss: 1466250.1111; val_kl_reg_loss: 25050.5312; val_edge_recon_loss: 301565.5625; val_gene_expr_recon_loss: 656901.2500; val_masked_gp_l1_reg_loss: 4788.4023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44282.5156; val_chrom_access_recon_loss: 434468.6562; val_global_loss: 1467056.8750; val_optim_loss: 1467056.8750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9270; val_auprc_score: 0.9081; val_best_acc_score: 0.8550; val_best_f1_score: 0.8621; train_kl_reg_loss: 24940.8006; train_edge_recon_loss: 299897.8924; train_gene_expr_recon_loss: 658487.5139; train_masked_gp_l1_reg_loss: 4812.9412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43354.6593; train_chrom_access_recon_loss: 432295.4514; train_global_loss: 1463789.2083; train_optim_loss: 1463789.2083; val_kl_reg_loss: 24411.2773; val_edge_recon_loss: 296733.9062; val_gene_expr_recon_loss: 655710.1250; val_masked_gp_l1_reg_loss: 4836.7471; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42214.6523; val_chrom_access_recon_loss: 433811.9062; val_global_loss: 1457718.6250; val_optim_loss: 1457718.6250
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9297; val_auprc_score: 0.9104; val_best_acc_score: 0.8649; val_best_f1_score: 0.8713; train_kl_reg_loss: 24967.5788; train_edge_recon_loss: 298628.7778; train_gene_expr_recon_loss: 659550.8542; train_masked_gp_l1_reg_loss: 4856.8234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41352.4796; train_chrom_access_recon_loss: 434614.5347; train_global_loss: 1463971.0417; train_optim_loss: 1463971.0417; val_kl_reg_loss: 24044.0820; val_edge_recon_loss: 297228.8125; val_gene_expr_recon_loss: 653784.7500; val_masked_gp_l1_reg_loss: 4881.8975; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40289.2109; val_chrom_access_recon_loss: 433116.2500; val_global_loss: 1453345.0000; val_optim_loss: 1453345.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9384; val_auprc_score: 0.9170; val_best_acc_score: 0.8769; val_best_f1_score: 0.8838; train_kl_reg_loss: 24805.6152; train_edge_recon_loss: 295655.8993; train_gene_expr_recon_loss: 651848.3889; train_masked_gp_l1_reg_loss: 4904.1518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39487.7161; train_chrom_access_recon_loss: 431936.1354; train_global_loss: 1448637.9028; train_optim_loss: 1448637.9028; val_kl_reg_loss: 25747.6504; val_edge_recon_loss: 294119.7188; val_gene_expr_recon_loss: 652007.7500; val_masked_gp_l1_reg_loss: 4926.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38496.8672; val_chrom_access_recon_loss: 432498.5312; val_global_loss: 1447797.1250; val_optim_loss: 1447797.1250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9388; val_auprc_score: 0.9211; val_best_acc_score: 0.8786; val_best_f1_score: 0.8850; train_kl_reg_loss: 25506.7520; train_edge_recon_loss: 294309.6042; train_gene_expr_recon_loss: 654616.1875; train_masked_gp_l1_reg_loss: 4943.5414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37740.4913; train_chrom_access_recon_loss: 430444.4722; train_global_loss: 1447561.0278; train_optim_loss: 1447561.0278; val_kl_reg_loss: 24940.2734; val_edge_recon_loss: 296083.5938; val_gene_expr_recon_loss: 652104.7500; val_masked_gp_l1_reg_loss: 4962.3936; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36809.9297; val_chrom_access_recon_loss: 432090.2500; val_global_loss: 1446991.2500; val_optim_loss: 1446991.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9394; val_auprc_score: 0.9213; val_best_acc_score: 0.8723; val_best_f1_score: 0.8767; train_kl_reg_loss: 23603.3251; train_edge_recon_loss: 299527.2743; train_gene_expr_recon_loss: 967993.0694; train_masked_gp_l1_reg_loss: 5045.9109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35956.3359; train_chrom_access_recon_loss: 454321.8715; train_global_loss: 1786447.7222; train_optim_loss: 1786447.7222; val_kl_reg_loss: 14050.5918; val_edge_recon_loss: 301666.9375; val_gene_expr_recon_loss: 963205.0000; val_masked_gp_l1_reg_loss: 5182.1084; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34817.6797; val_chrom_access_recon_loss: 455259.1250; val_global_loss: 1774181.3750; val_optim_loss: 1774181.3750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9392; val_auprc_score: 0.9191; val_best_acc_score: 0.8732; val_best_f1_score: 0.8783; train_kl_reg_loss: 22903.6979; train_edge_recon_loss: 295798.3333; train_gene_expr_recon_loss: 967582.9792; train_masked_gp_l1_reg_loss: 5304.4714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33878.9774; train_chrom_access_recon_loss: 455823.0833; train_global_loss: 1781291.5139; train_optim_loss: 1781291.5139; val_kl_reg_loss: 14312.6162; val_edge_recon_loss: 296228.0625; val_gene_expr_recon_loss: 958616.7500; val_masked_gp_l1_reg_loss: 5451.6689; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32723.0586; val_chrom_access_recon_loss: 454791.6875; val_global_loss: 1762123.7500; val_optim_loss: 1762123.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9448; val_auprc_score: 0.9277; val_best_acc_score: 0.8853; val_best_f1_score: 0.8902; train_kl_reg_loss: 21664.5981; train_edge_recon_loss: 293023.7639; train_gene_expr_recon_loss: 953686.7014; train_masked_gp_l1_reg_loss: 5551.6439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31841.7433; train_chrom_access_recon_loss: 452421.3507; train_global_loss: 1758189.7639; train_optim_loss: 1758189.7639; val_kl_reg_loss: 15241.1719; val_edge_recon_loss: 291608.9062; val_gene_expr_recon_loss: 954304.3750; val_masked_gp_l1_reg_loss: 5666.5996; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30770.5742; val_chrom_access_recon_loss: 454171.0312; val_global_loss: 1751762.7500; val_optim_loss: 1751762.7500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9432; val_auprc_score: 0.9245; val_best_acc_score: 0.8837; val_best_f1_score: 0.8878; train_kl_reg_loss: 20751.2862; train_edge_recon_loss: 290236.4062; train_gene_expr_recon_loss: 957672.9861; train_masked_gp_l1_reg_loss: 5745.3313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29962.4460; train_chrom_access_recon_loss: 455061.3889; train_global_loss: 1759429.8333; train_optim_loss: 1759429.8333; val_kl_reg_loss: 16009.2158; val_edge_recon_loss: 290551.9375; val_gene_expr_recon_loss: 951063.5625; val_masked_gp_l1_reg_loss: 5834.8574; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28982.7188; val_chrom_access_recon_loss: 453730.6250; val_global_loss: 1746173.0000; val_optim_loss: 1746173.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9478; val_auprc_score: 0.9312; val_best_acc_score: 0.8891; val_best_f1_score: 0.8929; train_kl_reg_loss: 20248.5519; train_edge_recon_loss: 288366.7465; train_gene_expr_recon_loss: 958564.8681; train_masked_gp_l1_reg_loss: 5827.3459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28866.4321; train_chrom_access_recon_loss: 453463.2049; train_global_loss: 1755337.1806; train_optim_loss: 1755337.1806; val_kl_reg_loss: 16448.6680; val_edge_recon_loss: 289801.6250; val_gene_expr_recon_loss: 949803.1875; val_masked_gp_l1_reg_loss: 5820.6831; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28726.1094; val_chrom_access_recon_loss: 453639.3125; val_global_loss: 1744239.5000; val_optim_loss: 1744239.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9446; val_auprc_score: 0.9251; val_best_acc_score: 0.8867; val_best_f1_score: 0.8918; train_kl_reg_loss: 20282.9449; train_edge_recon_loss: 288060.5729; train_gene_expr_recon_loss: 948740.5069; train_masked_gp_l1_reg_loss: 5822.0819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28629.8605; train_chrom_access_recon_loss: 452187.4757; train_global_loss: 1743723.4306; train_optim_loss: 1743723.4306; val_kl_reg_loss: 16453.7012; val_edge_recon_loss: 291087.2812; val_gene_expr_recon_loss: 949432.1250; val_masked_gp_l1_reg_loss: 5822.8291; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28508.8672; val_chrom_access_recon_loss: 453498.3750; val_global_loss: 1744803.2500; val_optim_loss: 1744803.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9461; val_auprc_score: 0.9284; val_best_acc_score: 0.8813; val_best_f1_score: 0.8871; train_kl_reg_loss: 20149.2624; train_edge_recon_loss: 288873.0417; train_gene_expr_recon_loss: 952372.8056; train_masked_gp_l1_reg_loss: 5824.5907; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28418.2752; train_chrom_access_recon_loss: 451953.9062; train_global_loss: 1747591.8611; train_optim_loss: 1747591.8611; val_kl_reg_loss: 16513.8652; val_edge_recon_loss: 291937.2500; val_gene_expr_recon_loss: 948773.5000; val_masked_gp_l1_reg_loss: 5826.9131; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28307.0801; val_chrom_access_recon_loss: 453371.7188; val_global_loss: 1744730.3750; val_optim_loss: 1744730.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9490; val_auprc_score: 0.9338; val_best_acc_score: 0.8867; val_best_f1_score: 0.8925; train_kl_reg_loss: 20137.2227; train_edge_recon_loss: 289132.8993; train_gene_expr_recon_loss: 951037.8194; train_masked_gp_l1_reg_loss: 5829.2886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28221.1591; train_chrom_access_recon_loss: 454130.7257; train_global_loss: 1748489.1250; train_optim_loss: 1748489.1250; val_kl_reg_loss: 16496.7402; val_edge_recon_loss: 288711.6250; val_gene_expr_recon_loss: 948681.6875; val_masked_gp_l1_reg_loss: 5832.8652; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28117.0312; val_chrom_access_recon_loss: 453365.9688; val_global_loss: 1741205.8750; val_optim_loss: 1741205.8750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 59 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9366
val AUPRC score: 0.9175
val best accuracy score: 0.8725
val best F1 score: 0.8784
val target rna MSE score: 3.8769
val source rna MSE score: 3.1527
val target atac MSE score: 0.1361
val source atac MSE score: 0.0206
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
