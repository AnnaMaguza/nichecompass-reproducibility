[True]
Run timestamp: 07092023_192143_92.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_92']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2398 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5114, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2716
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2398

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.5946; val_auprc_score: 0.5956; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 46785.4292; train_edge_recon_loss: 3576747.8636; train_gene_expr_recon_loss: 21188930.3333; train_masked_gp_l1_reg_loss: 151837.4477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5974824.3409; train_chrom_access_recon_loss: 10377836.6364; train_global_loss: 41316961.8788; train_optim_loss: 41316961.8788; val_kl_reg_loss: 81791.7920; val_edge_recon_loss: 4065544.9688; val_gene_expr_recon_loss: 19154649.2500; val_masked_gp_l1_reg_loss: 142296.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2556566.5000; val_chrom_access_recon_loss: 9706139.2500; val_global_loss: 35706988.0000; val_optim_loss: 35706988.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6779; val_auprc_score: 0.6624; val_best_acc_score: 0.5519; val_best_f1_score: 0.6848; train_kl_reg_loss: 109877.9969; train_edge_recon_loss: 3542862.3447; train_gene_expr_recon_loss: 19033706.1212; train_masked_gp_l1_reg_loss: 131042.5778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1104023.8703; train_chrom_access_recon_loss: 9801109.0909; train_global_loss: 33722621.9697; train_optim_loss: 33722621.9697; val_kl_reg_loss: 107985.8115; val_edge_recon_loss: 4062291.2188; val_gene_expr_recon_loss: 18416016.7500; val_masked_gp_l1_reg_loss: 124263.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 421202.3438; val_chrom_access_recon_loss: 9552504.3750; val_global_loss: 32684264.2500; val_optim_loss: 32684264.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6684; val_auprc_score: 0.6598; val_best_acc_score: 0.5951; val_best_f1_score: 0.6735; train_kl_reg_loss: 113576.5417; train_edge_recon_loss: 3533717.1477; train_gene_expr_recon_loss: 18662185.7273; train_masked_gp_l1_reg_loss: 122006.0072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 292276.5741; train_chrom_access_recon_loss: 9696000.2727; train_global_loss: 32419762.1515; train_optim_loss: 32419762.1515; val_kl_reg_loss: 114920.7744; val_edge_recon_loss: 4054612.1875; val_gene_expr_recon_loss: 18442085.2500; val_masked_gp_l1_reg_loss: 120601.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 215093.7656; val_chrom_access_recon_loss: 9599698.8750; val_global_loss: 32547013.2500; val_optim_loss: 32547013.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7465; val_auprc_score: 0.7324; val_best_acc_score: 0.6703; val_best_f1_score: 0.7019; train_kl_reg_loss: 106949.2837; train_edge_recon_loss: 3524880.7386; train_gene_expr_recon_loss: 18500823.2121; train_masked_gp_l1_reg_loss: 120557.5891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 183517.8771; train_chrom_access_recon_loss: 9639869.1515; train_global_loss: 32076597.7879; train_optim_loss: 32076597.7879; val_kl_reg_loss: 111073.4863; val_edge_recon_loss: 4031370.3438; val_gene_expr_recon_loss: 18157926.0000; val_masked_gp_l1_reg_loss: 120967.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159682.0312; val_chrom_access_recon_loss: 9424719.0000; val_global_loss: 32005739.0000; val_optim_loss: 32005739.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8179; val_auprc_score: 0.7951; val_best_acc_score: 0.7466; val_best_f1_score: 0.7653; train_kl_reg_loss: 97575.1112; train_edge_recon_loss: 3509185.4015; train_gene_expr_recon_loss: 18358862.4545; train_masked_gp_l1_reg_loss: 122595.7718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146284.7251; train_chrom_access_recon_loss: 9577226.8485; train_global_loss: 31811730.4242; train_optim_loss: 31811730.4242; val_kl_reg_loss: 86613.3652; val_edge_recon_loss: 3892143.5938; val_gene_expr_recon_loss: 17971941.7500; val_masked_gp_l1_reg_loss: 124876.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135802.1250; val_chrom_access_recon_loss: 9444519.6250; val_global_loss: 31655896.2500; val_optim_loss: 31655896.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8379; val_auprc_score: 0.7906; val_best_acc_score: 0.7646; val_best_f1_score: 0.7958; train_kl_reg_loss: 81937.1077; train_edge_recon_loss: 3370248.9886; train_gene_expr_recon_loss: 18267080.2424; train_masked_gp_l1_reg_loss: 128121.5606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129353.0934; train_chrom_access_recon_loss: 9523757.7121; train_global_loss: 31500498.8182; train_optim_loss: 31500498.8182; val_kl_reg_loss: 83585.8115; val_edge_recon_loss: 3155730.9375; val_gene_expr_recon_loss: 18012557.5000; val_masked_gp_l1_reg_loss: 132098.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125568.6953; val_chrom_access_recon_loss: 9329729.5000; val_global_loss: 30839269.7500; val_optim_loss: 30839269.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8425; val_auprc_score: 0.7968; val_best_acc_score: 0.7684; val_best_f1_score: 0.7957; train_kl_reg_loss: 94869.9634; train_edge_recon_loss: 3109658.6553; train_gene_expr_recon_loss: 18264128.5455; train_masked_gp_l1_reg_loss: 138346.5568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122600.7969; train_chrom_access_recon_loss: 9493910.4545; train_global_loss: 31223515.1818; train_optim_loss: 31223515.1818; val_kl_reg_loss: 98424.8760; val_edge_recon_loss: 3234142.5938; val_gene_expr_recon_loss: 17971514.0000; val_masked_gp_l1_reg_loss: 141901.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121831.4531; val_chrom_access_recon_loss: 9336638.7500; val_global_loss: 30904454.2500; val_optim_loss: 30904454.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8432; val_auprc_score: 0.8038; val_best_acc_score: 0.7609; val_best_f1_score: 0.7960; train_kl_reg_loss: 114718.0743; train_edge_recon_loss: 3037333.4735; train_gene_expr_recon_loss: 18155871.1818; train_masked_gp_l1_reg_loss: 143173.2786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120413.2541; train_chrom_access_recon_loss: 9469471.3182; train_global_loss: 31040980.7879; train_optim_loss: 31040980.7879; val_kl_reg_loss: 120411.0762; val_edge_recon_loss: 3017632.4688; val_gene_expr_recon_loss: 17892692.5000; val_masked_gp_l1_reg_loss: 141635.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116603.2656; val_chrom_access_recon_loss: 9278713.5000; val_global_loss: 30567689.7500; val_optim_loss: 30567689.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8570; val_auprc_score: 0.8277; val_best_acc_score: 0.7671; val_best_f1_score: 0.7955; train_kl_reg_loss: 121630.2598; train_edge_recon_loss: 2959013.1326; train_gene_expr_recon_loss: 18016890.6364; train_masked_gp_l1_reg_loss: 142015.7528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113230.2777; train_chrom_access_recon_loss: 9398100.1515; train_global_loss: 30750880.4545; train_optim_loss: 30750880.4545; val_kl_reg_loss: 114694.0039; val_edge_recon_loss: 2959043.6875; val_gene_expr_recon_loss: 17809770.5000; val_masked_gp_l1_reg_loss: 143211.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110020.1797; val_chrom_access_recon_loss: 9230354.7500; val_global_loss: 30367095.2500; val_optim_loss: 30367095.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8619; val_auprc_score: 0.8304; val_best_acc_score: 0.7805; val_best_f1_score: 0.8071; train_kl_reg_loss: 120154.1518; train_edge_recon_loss: 2948704.3182; train_gene_expr_recon_loss: 17925161.1515; train_masked_gp_l1_reg_loss: 144627.4751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108121.4640; train_chrom_access_recon_loss: 9344685.6667; train_global_loss: 30591454.3939; train_optim_loss: 30591454.3939; val_kl_reg_loss: 118011.3477; val_edge_recon_loss: 2932256.4062; val_gene_expr_recon_loss: 17624547.2500; val_masked_gp_l1_reg_loss: 146225.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106384.7656; val_chrom_access_recon_loss: 9218590.0000; val_global_loss: 30146014.7500; val_optim_loss: 30146014.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8658; val_auprc_score: 0.8298; val_best_acc_score: 0.7937; val_best_f1_score: 0.8129; train_kl_reg_loss: 118446.0323; train_edge_recon_loss: 2928372.2992; train_gene_expr_recon_loss: 17850562.7879; train_masked_gp_l1_reg_loss: 147520.3606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105850.7694; train_chrom_access_recon_loss: 9309856.1515; train_global_loss: 30460608.2727; train_optim_loss: 30460608.2727; val_kl_reg_loss: 120635.8203; val_edge_recon_loss: 2903756.2188; val_gene_expr_recon_loss: 17500726.7500; val_masked_gp_l1_reg_loss: 149048.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105458.5859; val_chrom_access_recon_loss: 9096668.8750; val_global_loss: 29876293.5000; val_optim_loss: 29876293.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8793; val_auprc_score: 0.8428; val_best_acc_score: 0.8028; val_best_f1_score: 0.8210; train_kl_reg_loss: 116296.7378; train_edge_recon_loss: 2902706.7462; train_gene_expr_recon_loss: 17785388.7576; train_masked_gp_l1_reg_loss: 150094.2540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104923.0849; train_chrom_access_recon_loss: 9272892.7576; train_global_loss: 30332302.5152; train_optim_loss: 30332302.5152; val_kl_reg_loss: 114541.3926; val_edge_recon_loss: 2877195.0312; val_gene_expr_recon_loss: 17512370.2500; val_masked_gp_l1_reg_loss: 151674.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104865.1562; val_chrom_access_recon_loss: 9099277.2500; val_global_loss: 29859924.0000; val_optim_loss: 29859924.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8858; val_auprc_score: 0.8546; val_best_acc_score: 0.8165; val_best_f1_score: 0.8323; train_kl_reg_loss: 119169.8183; train_edge_recon_loss: 2879039.0303; train_gene_expr_recon_loss: 17695941.2727; train_masked_gp_l1_reg_loss: 152489.5587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104908.5205; train_chrom_access_recon_loss: 9242085.8182; train_global_loss: 30193634.2727; train_optim_loss: 30193634.2727; val_kl_reg_loss: 111628.1660; val_edge_recon_loss: 2860623.0625; val_gene_expr_recon_loss: 17434018.0000; val_masked_gp_l1_reg_loss: 153744.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104713.2188; val_chrom_access_recon_loss: 9054811.6250; val_global_loss: 29719538.7500; val_optim_loss: 29719538.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8820; val_auprc_score: 0.8428; val_best_acc_score: 0.8157; val_best_f1_score: 0.8335; train_kl_reg_loss: 117180.4838; train_edge_recon_loss: 2861883.3636; train_gene_expr_recon_loss: 17633307.5606; train_masked_gp_l1_reg_loss: 154406.9695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104673.9098; train_chrom_access_recon_loss: 9208078.6364; train_global_loss: 30079531.0000; train_optim_loss: 30079531.0000; val_kl_reg_loss: 112404.5137; val_edge_recon_loss: 2873154.5000; val_gene_expr_recon_loss: 17201035.7500; val_masked_gp_l1_reg_loss: 155453.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105054.4297; val_chrom_access_recon_loss: 9021439.1250; val_global_loss: 29468542.0000; val_optim_loss: 29468542.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8870; val_auprc_score: 0.8503; val_best_acc_score: 0.8197; val_best_f1_score: 0.8376; train_kl_reg_loss: 114872.4872; train_edge_recon_loss: 2848614.1667; train_gene_expr_recon_loss: 17588908.3939; train_masked_gp_l1_reg_loss: 156270.0571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104620.2644; train_chrom_access_recon_loss: 9179729.9242; train_global_loss: 29993015.2121; train_optim_loss: 29993015.2121; val_kl_reg_loss: 117242.8916; val_edge_recon_loss: 2877777.3125; val_gene_expr_recon_loss: 17238409.0000; val_masked_gp_l1_reg_loss: 157200.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104395.2812; val_chrom_access_recon_loss: 9031040.5000; val_global_loss: 29526065.7500; val_optim_loss: 29526065.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8875; val_auprc_score: 0.8549; val_best_acc_score: 0.8248; val_best_f1_score: 0.8417; train_kl_reg_loss: 118164.7590; train_edge_recon_loss: 2827269.5265; train_gene_expr_recon_loss: 17544504.9091; train_masked_gp_l1_reg_loss: 157878.7133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104551.1579; train_chrom_access_recon_loss: 9160521.9697; train_global_loss: 29912891.2121; train_optim_loss: 29912891.2121; val_kl_reg_loss: 115891.2715; val_edge_recon_loss: 2892630.6562; val_gene_expr_recon_loss: 17139573.8750; val_masked_gp_l1_reg_loss: 158480.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104400.7656; val_chrom_access_recon_loss: 8938636.7500; val_global_loss: 29349612.7500; val_optim_loss: 29349612.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9091; val_auprc_score: 0.8795; val_best_acc_score: 0.8455; val_best_f1_score: 0.8575; train_kl_reg_loss: 116015.5621; train_edge_recon_loss: 2819316.7424; train_gene_expr_recon_loss: 17482322.6667; train_masked_gp_l1_reg_loss: 159400.0374; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104027.5920; train_chrom_access_recon_loss: 9135593.5303; train_global_loss: 29816676.2121; train_optim_loss: 29816676.2121; val_kl_reg_loss: 117591.7988; val_edge_recon_loss: 2848012.2812; val_gene_expr_recon_loss: 17276370.7500; val_masked_gp_l1_reg_loss: 160272.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104012.5234; val_chrom_access_recon_loss: 9029732.6250; val_global_loss: 29535991.2500; val_optim_loss: 29535991.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9078; val_auprc_score: 0.8758; val_best_acc_score: 0.8469; val_best_f1_score: 0.8581; train_kl_reg_loss: 119309.2024; train_edge_recon_loss: 2804704.1098; train_gene_expr_recon_loss: 17443407.3636; train_masked_gp_l1_reg_loss: 160750.5947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103666.2304; train_chrom_access_recon_loss: 9113424.9848; train_global_loss: 29745262.3939; train_optim_loss: 29745262.3939; val_kl_reg_loss: 116724.3193; val_edge_recon_loss: 2813257.6250; val_gene_expr_recon_loss: 17088059.2500; val_masked_gp_l1_reg_loss: 161366.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103350.6406; val_chrom_access_recon_loss: 8884875.6250; val_global_loss: 29167632.7500; val_optim_loss: 29167632.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9159; val_auprc_score: 0.8853; val_best_acc_score: 0.8493; val_best_f1_score: 0.8627; train_kl_reg_loss: 117032.1419; train_edge_recon_loss: 2805569.2045; train_gene_expr_recon_loss: 17380196.0152; train_masked_gp_l1_reg_loss: 161932.0045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103163.1639; train_chrom_access_recon_loss: 9079984.0455; train_global_loss: 29647876.6970; train_optim_loss: 29647876.6970; val_kl_reg_loss: 113253.0664; val_edge_recon_loss: 2810741.9062; val_gene_expr_recon_loss: 17103799.8750; val_masked_gp_l1_reg_loss: 162618.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102189.2891; val_chrom_access_recon_loss: 8995440.8750; val_global_loss: 29288043.7500; val_optim_loss: 29288043.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9077; val_auprc_score: 0.8752; val_best_acc_score: 0.8455; val_best_f1_score: 0.8597; train_kl_reg_loss: 114810.0980; train_edge_recon_loss: 2800328.3333; train_gene_expr_recon_loss: 17346279.0606; train_masked_gp_l1_reg_loss: 163387.8778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102044.4628; train_chrom_access_recon_loss: 9059535.3485; train_global_loss: 29586385.1818; train_optim_loss: 29586385.1818; val_kl_reg_loss: 115941.7520; val_edge_recon_loss: 2835350.0312; val_gene_expr_recon_loss: 17232296.1250; val_masked_gp_l1_reg_loss: 163822.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101967.9844; val_chrom_access_recon_loss: 8922503.8750; val_global_loss: 29371881.7500; val_optim_loss: 29371881.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9117; val_auprc_score: 0.8779; val_best_acc_score: 0.8506; val_best_f1_score: 0.8634; train_kl_reg_loss: 116719.8693; train_edge_recon_loss: 2794908.4470; train_gene_expr_recon_loss: 17294426.6212; train_masked_gp_l1_reg_loss: 164152.3376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101479.0664; train_chrom_access_recon_loss: 9040691.3636; train_global_loss: 29512377.3333; train_optim_loss: 29512377.3333; val_kl_reg_loss: 116469.3613; val_edge_recon_loss: 2823381.5000; val_gene_expr_recon_loss: 17169016.7500; val_masked_gp_l1_reg_loss: 164615.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101029.4141; val_chrom_access_recon_loss: 8909766.6250; val_global_loss: 29284280.2500; val_optim_loss: 29284280.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9236; val_auprc_score: 0.9018; val_best_acc_score: 0.8638; val_best_f1_score: 0.8729; train_kl_reg_loss: 114637.7672; train_edge_recon_loss: 2784815.4886; train_gene_expr_recon_loss: 17265393.7727; train_masked_gp_l1_reg_loss: 165170.1906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100598.6243; train_chrom_access_recon_loss: 9011700.0606; train_global_loss: 29442316.0909; train_optim_loss: 29442316.0909; val_kl_reg_loss: 112543.6367; val_edge_recon_loss: 2786710.0625; val_gene_expr_recon_loss: 16979261.7500; val_masked_gp_l1_reg_loss: 165748.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100790.6797; val_chrom_access_recon_loss: 8862324.5000; val_global_loss: 29007378.2500; val_optim_loss: 29007378.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9236; val_auprc_score: 0.8974; val_best_acc_score: 0.8581; val_best_f1_score: 0.8682; train_kl_reg_loss: 118033.2495; train_edge_recon_loss: 2771951.1856; train_gene_expr_recon_loss: 17224745.5303; train_masked_gp_l1_reg_loss: 166080.6494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100328.2910; train_chrom_access_recon_loss: 8988391.8939; train_global_loss: 29369530.9394; train_optim_loss: 29369530.9394; val_kl_reg_loss: 115092.3164; val_edge_recon_loss: 2792652.8438; val_gene_expr_recon_loss: 16952042.1250; val_masked_gp_l1_reg_loss: 166344.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99396.8203; val_chrom_access_recon_loss: 8776802.7500; val_global_loss: 28902329.7500; val_optim_loss: 28902329.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9233; val_auprc_score: 0.8972; val_best_acc_score: 0.8549; val_best_f1_score: 0.8674; train_kl_reg_loss: 116046.7691; train_edge_recon_loss: 2775954.6174; train_gene_expr_recon_loss: 17202645.2273; train_masked_gp_l1_reg_loss: 166681.7081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99325.3709; train_chrom_access_recon_loss: 8979910.6970; train_global_loss: 29340564.3030; train_optim_loss: 29340564.3030; val_kl_reg_loss: 117357.1553; val_edge_recon_loss: 2777973.5625; val_gene_expr_recon_loss: 16873885.2500; val_masked_gp_l1_reg_loss: 167071.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98640.3047; val_chrom_access_recon_loss: 8801695.6250; val_global_loss: 28836623.7500; val_optim_loss: 28836623.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9245; val_auprc_score: 0.8956; val_best_acc_score: 0.8659; val_best_f1_score: 0.8745; train_kl_reg_loss: 113790.0988; train_edge_recon_loss: 2780408.4621; train_gene_expr_recon_loss: 17173814.8788; train_masked_gp_l1_reg_loss: 167363.6160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98717.6947; train_chrom_access_recon_loss: 8952710.5909; train_global_loss: 29286805.3333; train_optim_loss: 29286805.3333; val_kl_reg_loss: 110772.0605; val_edge_recon_loss: 2806375.0000; val_gene_expr_recon_loss: 16791015.1250; val_masked_gp_l1_reg_loss: 167927.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98582.3672; val_chrom_access_recon_loss: 8776665.6250; val_global_loss: 28751338.0000; val_optim_loss: 28751338.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9309; val_auprc_score: 0.9091; val_best_acc_score: 0.8686; val_best_f1_score: 0.8756; train_kl_reg_loss: 120490.8696; train_edge_recon_loss: 2831509.3258; train_gene_expr_recon_loss: 16799489.0303; train_masked_gp_l1_reg_loss: 166847.8937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99551.1370; train_chrom_access_recon_loss: 8801908.8561; train_global_loss: 28819797.0606; train_optim_loss: 28819797.0606; val_kl_reg_loss: 71735.8350; val_edge_recon_loss: 2814617.5938; val_gene_expr_recon_loss: 16505894.2500; val_masked_gp_l1_reg_loss: 166370.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99875.8672; val_chrom_access_recon_loss: 8536159.6250; val_global_loss: 28194653.0000; val_optim_loss: 28194653.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9308; val_auprc_score: 0.9032; val_best_acc_score: 0.8673; val_best_f1_score: 0.8754; train_kl_reg_loss: 125175.2186; train_edge_recon_loss: 2786752.7803; train_gene_expr_recon_loss: 16716843.3030; train_masked_gp_l1_reg_loss: 166523.3269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98623.6057; train_chrom_access_recon_loss: 8688069.8864; train_global_loss: 28581987.9394; train_optim_loss: 28581987.9394; val_kl_reg_loss: 76700.9150; val_edge_recon_loss: 2821555.4062; val_gene_expr_recon_loss: 16387258.5000; val_masked_gp_l1_reg_loss: 166917.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98091.1328; val_chrom_access_recon_loss: 8472312.8750; val_global_loss: 28022837.2500; val_optim_loss: 28022837.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9279; val_auprc_score: 0.9014; val_best_acc_score: 0.8646; val_best_f1_score: 0.8744; train_kl_reg_loss: 118598.3701; train_edge_recon_loss: 2786341.3447; train_gene_expr_recon_loss: 16679670.8788; train_masked_gp_l1_reg_loss: 167237.0990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97178.8452; train_chrom_access_recon_loss: 8668050.2576; train_global_loss: 28517076.9697; train_optim_loss: 28517076.9697; val_kl_reg_loss: 78028.9219; val_edge_recon_loss: 2801085.6875; val_gene_expr_recon_loss: 16377833.6250; val_masked_gp_l1_reg_loss: 167616.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96524.8359; val_chrom_access_recon_loss: 8452561.8125; val_global_loss: 27973650.2500; val_optim_loss: 27973650.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9379; val_auprc_score: 0.9185; val_best_acc_score: 0.8759; val_best_f1_score: 0.8833; train_kl_reg_loss: 116406.8558; train_edge_recon_loss: 2768926.6439; train_gene_expr_recon_loss: 16623345.7879; train_masked_gp_l1_reg_loss: 167581.7517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96189.7760; train_chrom_access_recon_loss: 8624601.1667; train_global_loss: 28397052.0606; train_optim_loss: 28397052.0606; val_kl_reg_loss: 83502.3184; val_edge_recon_loss: 2819512.2812; val_gene_expr_recon_loss: 16381904.8750; val_masked_gp_l1_reg_loss: 167794.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96263.8984; val_chrom_access_recon_loss: 8436940.8125; val_global_loss: 27985918.5000; val_optim_loss: 27985918.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9334; val_auprc_score: 0.9087; val_best_acc_score: 0.8716; val_best_f1_score: 0.8791; train_kl_reg_loss: 112706.6982; train_edge_recon_loss: 2762832.8447; train_gene_expr_recon_loss: 16605520.8030; train_masked_gp_l1_reg_loss: 167683.0914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95469.5187; train_chrom_access_recon_loss: 8613027.8939; train_global_loss: 28357240.8182; train_optim_loss: 28357240.8182; val_kl_reg_loss: 84601.0625; val_edge_recon_loss: 2785593.8750; val_gene_expr_recon_loss: 16331332.7500; val_masked_gp_l1_reg_loss: 167771.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95185.8906; val_chrom_access_recon_loss: 8526881.5625; val_global_loss: 27991367.2500; val_optim_loss: 27991367.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9347; val_auprc_score: 0.9069; val_best_acc_score: 0.8772; val_best_f1_score: 0.8846; train_kl_reg_loss: 110618.3938; train_edge_recon_loss: 2748280.4205; train_gene_expr_recon_loss: 16578573.9848; train_masked_gp_l1_reg_loss: 167746.4091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94919.0015; train_chrom_access_recon_loss: 8594021.7348; train_global_loss: 28294160.0000; train_optim_loss: 28294160.0000; val_kl_reg_loss: 89534.6045; val_edge_recon_loss: 2803229.8750; val_gene_expr_recon_loss: 16295628.8750; val_masked_gp_l1_reg_loss: 167900.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94788.3359; val_chrom_access_recon_loss: 8438270.3750; val_global_loss: 27889351.7500; val_optim_loss: 27889351.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9397; val_auprc_score: 0.9178; val_best_acc_score: 0.8783; val_best_f1_score: 0.8863; train_kl_reg_loss: 106274.3737; train_edge_recon_loss: 2761233.8674; train_gene_expr_recon_loss: 16551672.8636; train_masked_gp_l1_reg_loss: 167972.2931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94312.0942; train_chrom_access_recon_loss: 8585864.7652; train_global_loss: 28267330.3030; train_optim_loss: 28267330.3030; val_kl_reg_loss: 89869.6152; val_edge_recon_loss: 2766257.8438; val_gene_expr_recon_loss: 16296728.7500; val_masked_gp_l1_reg_loss: 167999.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94443.9219; val_chrom_access_recon_loss: 8381576.4375; val_global_loss: 27796876.5000; val_optim_loss: 27796876.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9383; val_auprc_score: 0.9121; val_best_acc_score: 0.8810; val_best_f1_score: 0.8877; train_kl_reg_loss: 106452.9541; train_edge_recon_loss: 2755666.6667; train_gene_expr_recon_loss: 16525848.4091; train_masked_gp_l1_reg_loss: 167846.7848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93733.9316; train_chrom_access_recon_loss: 8570371.3561; train_global_loss: 28219920.1212; train_optim_loss: 28219920.1212; val_kl_reg_loss: 93511.1758; val_edge_recon_loss: 2775201.4688; val_gene_expr_recon_loss: 16320064.0000; val_masked_gp_l1_reg_loss: 167969.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93637.0547; val_chrom_access_recon_loss: 8376054.2500; val_global_loss: 27826438.7500; val_optim_loss: 27826438.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9411; val_auprc_score: 0.9180; val_best_acc_score: 0.8869; val_best_f1_score: 0.8928; train_kl_reg_loss: 104697.9348; train_edge_recon_loss: 2752543.4167; train_gene_expr_recon_loss: 16497829.5758; train_masked_gp_l1_reg_loss: 167769.4290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93213.8054; train_chrom_access_recon_loss: 8550546.1061; train_global_loss: 28166600.3333; train_optim_loss: 28166600.3333; val_kl_reg_loss: 92188.5791; val_edge_recon_loss: 2787381.7188; val_gene_expr_recon_loss: 16417651.6250; val_masked_gp_l1_reg_loss: 167656.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92793.9062; val_chrom_access_recon_loss: 8545300.7500; val_global_loss: 28102972.2500; val_optim_loss: 28102972.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9419; val_auprc_score: 0.9260; val_best_acc_score: 0.8799; val_best_f1_score: 0.8867; train_kl_reg_loss: 104519.2487; train_edge_recon_loss: 2751813.8030; train_gene_expr_recon_loss: 16471246.5303; train_masked_gp_l1_reg_loss: 167583.0007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92436.1340; train_chrom_access_recon_loss: 8528153.5455; train_global_loss: 28115752.1818; train_optim_loss: 28115752.1818; val_kl_reg_loss: 91699.6748; val_edge_recon_loss: 2791681.3750; val_gene_expr_recon_loss: 16193309.1250; val_masked_gp_l1_reg_loss: 167534.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92781.7734; val_chrom_access_recon_loss: 8303843.9375; val_global_loss: 27640850.2500; val_optim_loss: 27640850.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9449; val_auprc_score: 0.9258; val_best_acc_score: 0.8888; val_best_f1_score: 0.8944; train_kl_reg_loss: 103991.2412; train_edge_recon_loss: 2741598.4545; train_gene_expr_recon_loss: 16442260.5000; train_masked_gp_l1_reg_loss: 167414.2990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92263.9566; train_chrom_access_recon_loss: 8503008.6061; train_global_loss: 28050536.8485; train_optim_loss: 28050536.8485; val_kl_reg_loss: 95688.1660; val_edge_recon_loss: 2778786.0000; val_gene_expr_recon_loss: 16179972.0000; val_masked_gp_l1_reg_loss: 167195.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91922.2578; val_chrom_access_recon_loss: 8396831.3750; val_global_loss: 27710395.5000; val_optim_loss: 27710395.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9529; val_auprc_score: 0.9311; val_best_acc_score: 0.8995; val_best_f1_score: 0.9037; train_kl_reg_loss: 104140.1635; train_edge_recon_loss: 2744229.7803; train_gene_expr_recon_loss: 16425174.8030; train_masked_gp_l1_reg_loss: 167063.1508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91755.7473; train_chrom_access_recon_loss: 8501057.2727; train_global_loss: 28033420.8788; train_optim_loss: 28033420.8788; val_kl_reg_loss: 94552.6152; val_edge_recon_loss: 2728990.2812; val_gene_expr_recon_loss: 16122598.3750; val_masked_gp_l1_reg_loss: 166933.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91729.6250; val_chrom_access_recon_loss: 8317620.8750; val_global_loss: 27522425.7500; val_optim_loss: 27522425.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9502; val_auprc_score: 0.9288; val_best_acc_score: 0.8936; val_best_f1_score: 0.8984; train_kl_reg_loss: 101786.1134; train_edge_recon_loss: 2738924.7879; train_gene_expr_recon_loss: 16400706.0152; train_masked_gp_l1_reg_loss: 166788.6858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91445.7138; train_chrom_access_recon_loss: 8485735.3485; train_global_loss: 27985386.7576; train_optim_loss: 27985386.7576; val_kl_reg_loss: 95906.2129; val_edge_recon_loss: 2766133.5000; val_gene_expr_recon_loss: 16123050.3750; val_masked_gp_l1_reg_loss: 166910.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90950.3828; val_chrom_access_recon_loss: 8276331.0625; val_global_loss: 27519281.2500; val_optim_loss: 27519281.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9452; val_auprc_score: 0.9232; val_best_acc_score: 0.8882; val_best_f1_score: 0.8953; train_kl_reg_loss: 103086.0676; train_edge_recon_loss: 2738843.1818; train_gene_expr_recon_loss: 16371156.4242; train_masked_gp_l1_reg_loss: 166642.0301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91127.4669; train_chrom_access_recon_loss: 8466452.5758; train_global_loss: 27937307.7576; train_optim_loss: 27937307.7576; val_kl_reg_loss: 97455.7227; val_edge_recon_loss: 2756502.1562; val_gene_expr_recon_loss: 16047550.2500; val_masked_gp_l1_reg_loss: 166459.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90447.5078; val_chrom_access_recon_loss: 8325507.2500; val_global_loss: 27483923.0000; val_optim_loss: 27483923.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9518; val_auprc_score: 0.9361; val_best_acc_score: 0.8917; val_best_f1_score: 0.8968; train_kl_reg_loss: 101285.0492; train_edge_recon_loss: 2741648.9053; train_gene_expr_recon_loss: 16372890.8788; train_masked_gp_l1_reg_loss: 166436.5431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90555.9079; train_chrom_access_recon_loss: 8467115.8258; train_global_loss: 27939933.0909; train_optim_loss: 27939933.0909; val_kl_reg_loss: 98493.1650; val_edge_recon_loss: 2762952.7812; val_gene_expr_recon_loss: 16226636.2500; val_masked_gp_l1_reg_loss: 166546.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90953.0625; val_chrom_access_recon_loss: 8340569.8750; val_global_loss: 27686152.0000; val_optim_loss: 27686152.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9505; val_auprc_score: 0.9318; val_best_acc_score: 0.8982; val_best_f1_score: 0.9031; train_kl_reg_loss: 102117.5122; train_edge_recon_loss: 2729904.9091; train_gene_expr_recon_loss: 16347840.6818; train_masked_gp_l1_reg_loss: 166403.1233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90331.3297; train_chrom_access_recon_loss: 8449348.2652; train_global_loss: 27885945.6364; train_optim_loss: 27885945.6364; val_kl_reg_loss: 96638.2305; val_edge_recon_loss: 2773699.4375; val_gene_expr_recon_loss: 16019514.0000; val_masked_gp_l1_reg_loss: 166273.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90282.7266; val_chrom_access_recon_loss: 8203083.6875; val_global_loss: 27349491.0000; val_optim_loss: 27349491.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9578; val_auprc_score: 0.9431; val_best_acc_score: 0.9084; val_best_f1_score: 0.9120; train_kl_reg_loss: 101806.9156; train_edge_recon_loss: 2729723.4583; train_gene_expr_recon_loss: 16336503.5303; train_masked_gp_l1_reg_loss: 166321.4254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90076.8240; train_chrom_access_recon_loss: 8440585.6515; train_global_loss: 27865018.0909; train_optim_loss: 27865018.0909; val_kl_reg_loss: 92315.4785; val_edge_recon_loss: 2738108.2500; val_gene_expr_recon_loss: 16105402.7500; val_masked_gp_l1_reg_loss: 166431.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89903.2266; val_chrom_access_recon_loss: 8265621.1875; val_global_loss: 27457783.7500; val_optim_loss: 27457783.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9503; val_auprc_score: 0.9354; val_best_acc_score: 0.8896; val_best_f1_score: 0.8966; train_kl_reg_loss: 102114.3169; train_edge_recon_loss: 2727425.9015; train_gene_expr_recon_loss: 16333365.0909; train_masked_gp_l1_reg_loss: 166390.0341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89768.8861; train_chrom_access_recon_loss: 8441536.1742; train_global_loss: 27860600.3030; train_optim_loss: 27860600.3030; val_kl_reg_loss: 97501.5410; val_edge_recon_loss: 2778199.1562; val_gene_expr_recon_loss: 16064477.7500; val_masked_gp_l1_reg_loss: 166451.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90050.0312; val_chrom_access_recon_loss: 8267635.1875; val_global_loss: 27464315.5000; val_optim_loss: 27464315.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9564; val_auprc_score: 0.9376; val_best_acc_score: 0.9081; val_best_f1_score: 0.9127; train_kl_reg_loss: 102697.8383; train_edge_recon_loss: 2734516.5644; train_gene_expr_recon_loss: 16299233.5152; train_masked_gp_l1_reg_loss: 166421.3158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89632.1939; train_chrom_access_recon_loss: 8427293.7121; train_global_loss: 27819795.0909; train_optim_loss: 27819795.0909; val_kl_reg_loss: 97102.1396; val_edge_recon_loss: 2724272.4375; val_gene_expr_recon_loss: 16098122.5000; val_masked_gp_l1_reg_loss: 166367.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89239.4375; val_chrom_access_recon_loss: 8267609.6875; val_global_loss: 27442714.7500; val_optim_loss: 27442714.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9564; val_auprc_score: 0.9384; val_best_acc_score: 0.9057; val_best_f1_score: 0.9104; train_kl_reg_loss: 102357.4077; train_edge_recon_loss: 2732512.7841; train_gene_expr_recon_loss: 16295411.8333; train_masked_gp_l1_reg_loss: 166448.9129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89416.2734; train_chrom_access_recon_loss: 8415711.7879; train_global_loss: 27801858.7879; train_optim_loss: 27801858.7879; val_kl_reg_loss: 96364.5928; val_edge_recon_loss: 2767196.5312; val_gene_expr_recon_loss: 16032152.2500; val_masked_gp_l1_reg_loss: 166488.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88896.2266; val_chrom_access_recon_loss: 8220787.9375; val_global_loss: 27371885.2500; val_optim_loss: 27371885.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9560; val_auprc_score: 0.9361; val_best_acc_score: 0.9041; val_best_f1_score: 0.9082; train_kl_reg_loss: 102077.2472; train_edge_recon_loss: 2729392.2765; train_gene_expr_recon_loss: 16266772.1061; train_masked_gp_l1_reg_loss: 164556.5485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72005.3713; train_chrom_access_recon_loss: 8391084.8712; train_global_loss: 27725888.3030; train_optim_loss: 27725888.3030; val_kl_reg_loss: 97694.1436; val_edge_recon_loss: 2741926.6562; val_gene_expr_recon_loss: 15976030.2500; val_masked_gp_l1_reg_loss: 163719.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68776.9609; val_chrom_access_recon_loss: 8223333.3125; val_global_loss: 27271479.7500; val_optim_loss: 27271479.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9546; val_auprc_score: 0.9363; val_best_acc_score: 0.9017; val_best_f1_score: 0.9044; train_kl_reg_loss: 103382.4251; train_edge_recon_loss: 2713175.9167; train_gene_expr_recon_loss: 16260576.4697; train_masked_gp_l1_reg_loss: 163510.4420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68480.8356; train_chrom_access_recon_loss: 8391934.7727; train_global_loss: 27701061.0303; train_optim_loss: 27701061.0303; val_kl_reg_loss: 99199.1455; val_edge_recon_loss: 2753081.7812; val_gene_expr_recon_loss: 16017684.6250; val_masked_gp_l1_reg_loss: 163367.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68290.3516; val_chrom_access_recon_loss: 8290656.2500; val_global_loss: 27392280.2500; val_optim_loss: 27392280.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9477; val_auprc_score: 0.9344; val_best_acc_score: 0.8909; val_best_f1_score: 0.8974; train_kl_reg_loss: 104479.3871; train_edge_recon_loss: 2723440.0644; train_gene_expr_recon_loss: 16252771.0606; train_masked_gp_l1_reg_loss: 163265.2739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68117.4766; train_chrom_access_recon_loss: 8387757.4394; train_global_loss: 27699830.6970; train_optim_loss: 27699830.6970; val_kl_reg_loss: 99519.6367; val_edge_recon_loss: 2774525.0625; val_gene_expr_recon_loss: 15916392.3750; val_masked_gp_l1_reg_loss: 163188.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67963.0703; val_chrom_access_recon_loss: 8208082.4375; val_global_loss: 27229672.0000; val_optim_loss: 27229672.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9595; val_auprc_score: 0.9474; val_best_acc_score: 0.9078; val_best_f1_score: 0.9122; train_kl_reg_loss: 104423.2745; train_edge_recon_loss: 2722974.0303; train_gene_expr_recon_loss: 16251500.3636; train_masked_gp_l1_reg_loss: 163133.1546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67823.1136; train_chrom_access_recon_loss: 8392014.0682; train_global_loss: 27701867.9394; train_optim_loss: 27701867.9394; val_kl_reg_loss: 99722.4336; val_edge_recon_loss: 2740844.4375; val_gene_expr_recon_loss: 16199847.5000; val_masked_gp_l1_reg_loss: 163118.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67771.6250; val_chrom_access_recon_loss: 8347439.1875; val_global_loss: 27618743.5000; val_optim_loss: 27618743.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9511; val_auprc_score: 0.9327; val_best_acc_score: 0.9009; val_best_f1_score: 0.9047; train_kl_reg_loss: 104768.4537; train_edge_recon_loss: 2722830.0000; train_gene_expr_recon_loss: 16256764.2121; train_masked_gp_l1_reg_loss: 163087.7874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67691.6310; train_chrom_access_recon_loss: 8391364.4015; train_global_loss: 27706506.3333; train_optim_loss: 27706506.3333; val_kl_reg_loss: 100351.2129; val_edge_recon_loss: 2767954.2500; val_gene_expr_recon_loss: 15975286.8750; val_masked_gp_l1_reg_loss: 163013.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67589.5000; val_chrom_access_recon_loss: 8157150.3750; val_global_loss: 27231346.2500; val_optim_loss: 27231346.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9545; val_auprc_score: 0.9398; val_best_acc_score: 0.9027; val_best_f1_score: 0.9063; train_kl_reg_loss: 104541.6064; train_edge_recon_loss: 2727490.3447; train_gene_expr_recon_loss: 16259104.4394; train_masked_gp_l1_reg_loss: 162994.2926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67449.9039; train_chrom_access_recon_loss: 8389998.7121; train_global_loss: 27711579.3636; train_optim_loss: 27711579.3636; val_kl_reg_loss: 99881.7734; val_edge_recon_loss: 2740139.8750; val_gene_expr_recon_loss: 15953011.7500; val_masked_gp_l1_reg_loss: 162995.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67339.0938; val_chrom_access_recon_loss: 8224471.1250; val_global_loss: 27247840.5000; val_optim_loss: 27247840.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9538; val_auprc_score: 0.9335; val_best_acc_score: 0.9097; val_best_f1_score: 0.9144; train_kl_reg_loss: 104353.3767; train_edge_recon_loss: 2737656.1629; train_gene_expr_recon_loss: 16245181.5758; train_masked_gp_l1_reg_loss: 162985.9590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67323.1198; train_chrom_access_recon_loss: 8383230.8182; train_global_loss: 27700730.9697; train_optim_loss: 27700730.9697; val_kl_reg_loss: 98863.7979; val_edge_recon_loss: 2737649.9688; val_gene_expr_recon_loss: 15973823.0000; val_masked_gp_l1_reg_loss: 162961.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67251.6562; val_chrom_access_recon_loss: 8182659.3125; val_global_loss: 27223209.5000; val_optim_loss: 27223209.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9511; val_auprc_score: 0.9306; val_best_acc_score: 0.9014; val_best_f1_score: 0.9061; train_kl_reg_loss: 104451.8877; train_edge_recon_loss: 2722023.0455; train_gene_expr_recon_loss: 16238529.3636; train_masked_gp_l1_reg_loss: 162948.9605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67187.8184; train_chrom_access_recon_loss: 8383731.2424; train_global_loss: 27678872.3939; train_optim_loss: 27678872.3939; val_kl_reg_loss: 100223.0508; val_edge_recon_loss: 2737776.6875; val_gene_expr_recon_loss: 16036652.3750; val_masked_gp_l1_reg_loss: 162915.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67003.7812; val_chrom_access_recon_loss: 8214185.6875; val_global_loss: 27318757.5000; val_optim_loss: 27318757.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9550; val_auprc_score: 0.9373; val_best_acc_score: 0.9003; val_best_f1_score: 0.9048; train_kl_reg_loss: 104681.1792; train_edge_recon_loss: 2713910.4091; train_gene_expr_recon_loss: 16249379.4242; train_masked_gp_l1_reg_loss: 162890.1333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66890.2176; train_chrom_access_recon_loss: 8381787.1894; train_global_loss: 27679538.6364; train_optim_loss: 27679538.6364; val_kl_reg_loss: 100337.7666; val_edge_recon_loss: 2747101.6875; val_gene_expr_recon_loss: 16037001.7500; val_masked_gp_l1_reg_loss: 162895.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66960.0859; val_chrom_access_recon_loss: 8277949.3125; val_global_loss: 27392246.7500; val_optim_loss: 27392246.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9522; val_auprc_score: 0.9299; val_best_acc_score: 0.9035; val_best_f1_score: 0.9085; train_kl_reg_loss: 104701.1243; train_edge_recon_loss: 2718434.0871; train_gene_expr_recon_loss: 16238282.5455; train_masked_gp_l1_reg_loss: 162897.3873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66842.7644; train_chrom_access_recon_loss: 8380093.2576; train_global_loss: 27671251.3939; train_optim_loss: 27671251.3939; val_kl_reg_loss: 100070.8418; val_edge_recon_loss: 2746357.0938; val_gene_expr_recon_loss: 16054538.6250; val_masked_gp_l1_reg_loss: 162868.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66792.8281; val_chrom_access_recon_loss: 8276864.0000; val_global_loss: 27407490.7500; val_optim_loss: 27407490.7500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9512; val_auprc_score: 0.9315; val_best_acc_score: 0.9044; val_best_f1_score: 0.9081; train_kl_reg_loss: 104837.0705; train_edge_recon_loss: 2713917.7121; train_gene_expr_recon_loss: 16248616.9697; train_masked_gp_l1_reg_loss: 162847.4960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66626.4638; train_chrom_access_recon_loss: 8388010.0682; train_global_loss: 27684855.8485; train_optim_loss: 27684855.8485; val_kl_reg_loss: 99785.2900; val_edge_recon_loss: 2747468.5000; val_gene_expr_recon_loss: 16026944.2500; val_masked_gp_l1_reg_loss: 162853.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66580.5781; val_chrom_access_recon_loss: 8171086.0000; val_global_loss: 27274718.2500; val_optim_loss: 27274718.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9606; val_auprc_score: 0.9471; val_best_acc_score: 0.9095; val_best_f1_score: 0.9135; train_kl_reg_loss: 104755.1126; train_edge_recon_loss: 2728160.8068; train_gene_expr_recon_loss: 16240123.5303; train_masked_gp_l1_reg_loss: 162647.5982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64765.6170; train_chrom_access_recon_loss: 8378002.7273; train_global_loss: 27678455.4242; train_optim_loss: 27678455.4242; val_kl_reg_loss: 100188.9355; val_edge_recon_loss: 2743245.3125; val_gene_expr_recon_loss: 16076803.2500; val_masked_gp_l1_reg_loss: 162546.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64416.9766; val_chrom_access_recon_loss: 8290350.6250; val_global_loss: 27437550.2500; val_optim_loss: 27437550.2500
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9500; val_auprc_score: 0.9263; val_best_acc_score: 0.9044; val_best_f1_score: 0.9091; train_kl_reg_loss: 104716.5608; train_edge_recon_loss: 2721346.4129; train_gene_expr_recon_loss: 16241857.5303; train_masked_gp_l1_reg_loss: 162513.0769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64384.4203; train_chrom_access_recon_loss: 8376501.2121; train_global_loss: 27671319.0606; train_optim_loss: 27671319.0606; val_kl_reg_loss: 100253.6006; val_edge_recon_loss: 2753634.8125; val_gene_expr_recon_loss: 16064559.2500; val_masked_gp_l1_reg_loss: 162484.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64359.6641; val_chrom_access_recon_loss: 8278166.8750; val_global_loss: 27423459.0000; val_optim_loss: 27423459.0000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9522; val_auprc_score: 0.9325; val_best_acc_score: 0.9049; val_best_f1_score: 0.9086; train_kl_reg_loss: 104585.9876; train_edge_recon_loss: 2723312.8523; train_gene_expr_recon_loss: 16231659.8939; train_masked_gp_l1_reg_loss: 162469.6906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64344.8487; train_chrom_access_recon_loss: 8377949.9697; train_global_loss: 27664323.1212; train_optim_loss: 27664323.1212; val_kl_reg_loss: 100543.0283; val_edge_recon_loss: 2758646.0312; val_gene_expr_recon_loss: 15977900.5000; val_masked_gp_l1_reg_loss: 162455.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64317.2617; val_chrom_access_recon_loss: 8193524.8125; val_global_loss: 27257388.5000; val_optim_loss: 27257388.5000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9555; val_auprc_score: 0.9401; val_best_acc_score: 0.9019; val_best_f1_score: 0.9061; train_kl_reg_loss: 104674.4219; train_edge_recon_loss: 2733667.1174; train_gene_expr_recon_loss: 16251684.4242; train_masked_gp_l1_reg_loss: 162447.3442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64301.3758; train_chrom_access_recon_loss: 8382956.4394; train_global_loss: 27699731.1212; train_optim_loss: 27699731.1212; val_kl_reg_loss: 99203.7539; val_edge_recon_loss: 2747293.6250; val_gene_expr_recon_loss: 16012217.2500; val_masked_gp_l1_reg_loss: 162439.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64287.4297; val_chrom_access_recon_loss: 8180809.5000; val_global_loss: 27266252.5000; val_optim_loss: 27266252.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 6 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9497
val AUPRC score: 0.9325
val best accuracy score: 0.8963
val best F1 score: 0.9024
val target rna MSE score: 1.3378
val source rna MSE score: 0.4751
val target atac MSE score: 0.3088
val source atac MSE score: 0.0690
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
