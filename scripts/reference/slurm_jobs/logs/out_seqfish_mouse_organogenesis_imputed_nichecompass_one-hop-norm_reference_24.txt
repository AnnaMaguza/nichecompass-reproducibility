[True]
Run timestamp: 01082023_071115_24.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_24']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8930; val_auprc_score: 0.9796; val_best_acc_score: 0.8528; val_best_f1_score: 0.9205; train_kl_reg_loss: 159740.0711; train_edge_recon_loss: 11763.0549; train_gene_expr_recon_loss: 4958668.2778; train_masked_gp_l1_reg_loss: 12926.7914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118145.0699; train_global_loss: 5261243.2222; train_optim_loss: 5261243.2222; val_kl_reg_loss: 151046.5677; val_edge_recon_loss: 11968.7129; val_gene_expr_recon_loss: 4255374.3333; val_masked_gp_l1_reg_loss: 12745.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109332.6172; val_global_loss: 4540467.0833; val_optim_loss: 4540467.0833
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8787; val_auprc_score: 0.9769; val_best_acc_score: 0.8530; val_best_f1_score: 0.9206; train_kl_reg_loss: 144937.5262; train_edge_recon_loss: 11960.6162; train_gene_expr_recon_loss: 3718206.9583; train_masked_gp_l1_reg_loss: 12216.6425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102185.0998; train_global_loss: 3989506.8472; train_optim_loss: 3989506.8472; val_kl_reg_loss: 150066.4948; val_edge_recon_loss: 11980.2116; val_gene_expr_recon_loss: 3184947.1667; val_masked_gp_l1_reg_loss: 11708.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95197.3594; val_global_loss: 3453899.9167; val_optim_loss: 3453899.9167
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8528; val_auprc_score: 0.9707; val_best_acc_score: 0.8618; val_best_f1_score: 0.9246; train_kl_reg_loss: 109994.9883; train_edge_recon_loss: 11928.3714; train_gene_expr_recon_loss: 2950267.6574; train_masked_gp_l1_reg_loss: 11360.5512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89217.5935; train_global_loss: 3172769.1296; train_optim_loss: 3172769.1296; val_kl_reg_loss: 79799.7760; val_edge_recon_loss: 12091.9989; val_gene_expr_recon_loss: 2814973.3750; val_masked_gp_l1_reg_loss: 11069.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83440.8203; val_global_loss: 3001375.1250; val_optim_loss: 3001375.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8402; val_auprc_score: 0.9679; val_best_acc_score: 0.8715; val_best_f1_score: 0.9287; train_kl_reg_loss: 76100.0032; train_edge_recon_loss: 11875.4858; train_gene_expr_recon_loss: 2719189.2500; train_masked_gp_l1_reg_loss: 10887.4042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78722.7169; train_global_loss: 2896774.8519; train_optim_loss: 2896774.8519; val_kl_reg_loss: 63453.8639; val_edge_recon_loss: 11916.2376; val_gene_expr_recon_loss: 2450379.0833; val_masked_gp_l1_reg_loss: 10781.8369; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74291.5000; val_global_loss: 2610822.4167; val_optim_loss: 2610822.4167
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8372; val_auprc_score: 0.9667; val_best_acc_score: 0.8725; val_best_f1_score: 0.9302; train_kl_reg_loss: 59351.3823; train_edge_recon_loss: 11789.5472; train_gene_expr_recon_loss: 2322684.1713; train_masked_gp_l1_reg_loss: 10690.0278; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70966.0720; train_global_loss: 2475481.2037; train_optim_loss: 2475481.2037; val_kl_reg_loss: 53902.9518; val_edge_recon_loss: 11907.8672; val_gene_expr_recon_loss: 2285340.0833; val_masked_gp_l1_reg_loss: 10583.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68020.2656; val_global_loss: 2429754.9167; val_optim_loss: 2429754.9167
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8418; val_auprc_score: 0.9670; val_best_acc_score: 0.8729; val_best_f1_score: 0.9296; train_kl_reg_loss: 52449.5501; train_edge_recon_loss: 11944.4090; train_gene_expr_recon_loss: 2274621.1204; train_masked_gp_l1_reg_loss: 10510.5747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66157.7677; train_global_loss: 2415683.4583; train_optim_loss: 2415683.4583; val_kl_reg_loss: 47657.8633; val_edge_recon_loss: 12032.0754; val_gene_expr_recon_loss: 2256362.4167; val_masked_gp_l1_reg_loss: 10462.9316; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64695.0078; val_global_loss: 2391210.3333; val_optim_loss: 2391210.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8523; val_auprc_score: 0.9683; val_best_acc_score: 0.8736; val_best_f1_score: 0.9292; train_kl_reg_loss: 46538.9975; train_edge_recon_loss: 11802.3184; train_gene_expr_recon_loss: 2203653.7269; train_masked_gp_l1_reg_loss: 10500.6852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63565.1375; train_global_loss: 2336060.8565; train_optim_loss: 2336060.8565; val_kl_reg_loss: 44153.8874; val_edge_recon_loss: 12143.6325; val_gene_expr_recon_loss: 2156164.3750; val_masked_gp_l1_reg_loss: 10535.3721; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62402.0508; val_global_loss: 2285399.1667; val_optim_loss: 2285399.1667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8602; val_auprc_score: 0.9709; val_best_acc_score: 0.8734; val_best_f1_score: 0.9300; train_kl_reg_loss: 43716.7797; train_edge_recon_loss: 11746.0760; train_gene_expr_recon_loss: 2148016.0556; train_masked_gp_l1_reg_loss: 10519.5615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61255.5234; train_global_loss: 2275254.0000; train_optim_loss: 2275254.0000; val_kl_reg_loss: 40564.7767; val_edge_recon_loss: 11921.6849; val_gene_expr_recon_loss: 2133189.5000; val_masked_gp_l1_reg_loss: 10524.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60060.7109; val_global_loss: 2256260.6667; val_optim_loss: 2256260.6667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8758; val_auprc_score: 0.9742; val_best_acc_score: 0.8762; val_best_f1_score: 0.9313; train_kl_reg_loss: 40785.2572; train_edge_recon_loss: 11666.6273; train_gene_expr_recon_loss: 2124331.2639; train_masked_gp_l1_reg_loss: 10553.9615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58911.1484; train_global_loss: 2246248.2361; train_optim_loss: 2246248.2361; val_kl_reg_loss: 38446.4818; val_edge_recon_loss: 11689.4132; val_gene_expr_recon_loss: 2110207.2083; val_masked_gp_l1_reg_loss: 10594.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57719.5000; val_global_loss: 2228657.1250; val_optim_loss: 2228657.1250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8760; val_auprc_score: 0.9740; val_best_acc_score: 0.8761; val_best_f1_score: 0.9309; train_kl_reg_loss: 38396.5608; train_edge_recon_loss: 11543.3806; train_gene_expr_recon_loss: 2102505.8356; train_masked_gp_l1_reg_loss: 10637.3947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56581.9590; train_global_loss: 2219665.1250; train_optim_loss: 2219665.1250; val_kl_reg_loss: 35899.9499; val_edge_recon_loss: 11689.4494; val_gene_expr_recon_loss: 2089176.6250; val_masked_gp_l1_reg_loss: 10683.5459; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55410.7422; val_global_loss: 2202860.2917; val_optim_loss: 2202860.2917
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8761; val_auprc_score: 0.9733; val_best_acc_score: 0.8753; val_best_f1_score: 0.9298; train_kl_reg_loss: 36311.5140; train_edge_recon_loss: 11515.3267; train_gene_expr_recon_loss: 2081677.2963; train_masked_gp_l1_reg_loss: 10728.6083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54303.6362; train_global_loss: 2194536.3750; train_optim_loss: 2194536.3750; val_kl_reg_loss: 34033.8685; val_edge_recon_loss: 12018.5767; val_gene_expr_recon_loss: 2067652.5625; val_masked_gp_l1_reg_loss: 10778.2715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53173.4297; val_global_loss: 2177656.7500; val_optim_loss: 2177656.7500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8879; val_auprc_score: 0.9748; val_best_acc_score: 0.8772; val_best_f1_score: 0.9315; train_kl_reg_loss: 34516.1705; train_edge_recon_loss: 11521.5863; train_gene_expr_recon_loss: 2061979.1690; train_masked_gp_l1_reg_loss: 10827.4867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52119.6462; train_global_loss: 2170964.0463; train_optim_loss: 2170964.0463; val_kl_reg_loss: 32532.0791; val_edge_recon_loss: 12032.9006; val_gene_expr_recon_loss: 2048962.9375; val_masked_gp_l1_reg_loss: 10880.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51046.1016; val_global_loss: 2155454.4583; val_optim_loss: 2155454.4583
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8875; val_auprc_score: 0.9779; val_best_acc_score: 0.8856; val_best_f1_score: 0.9363; train_kl_reg_loss: 32979.2414; train_edge_recon_loss: 11565.4625; train_gene_expr_recon_loss: 2042643.8634; train_masked_gp_l1_reg_loss: 10933.4465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50052.9693; train_global_loss: 2148174.9769; train_optim_loss: 2148174.9769; val_kl_reg_loss: 31012.0316; val_edge_recon_loss: 11215.9080; val_gene_expr_recon_loss: 2031908.3542; val_masked_gp_l1_reg_loss: 10989.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49040.4609; val_global_loss: 2134166.0000; val_optim_loss: 2134166.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8927; val_auprc_score: 0.9772; val_best_acc_score: 0.8847; val_best_f1_score: 0.9347; train_kl_reg_loss: 31574.9840; train_edge_recon_loss: 11444.1567; train_gene_expr_recon_loss: 2024259.7106; train_masked_gp_l1_reg_loss: 11042.8012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48087.8226; train_global_loss: 2126409.4537; train_optim_loss: 2126409.4537; val_kl_reg_loss: 29861.6283; val_edge_recon_loss: 11310.7959; val_gene_expr_recon_loss: 2011872.9583; val_masked_gp_l1_reg_loss: 11103.1143; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47118.0469; val_global_loss: 2111266.5417; val_optim_loss: 2111266.5417
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8951; val_auprc_score: 0.9777; val_best_acc_score: 0.8850; val_best_f1_score: 0.9341; train_kl_reg_loss: 30333.7683; train_edge_recon_loss: 11479.2875; train_gene_expr_recon_loss: 2006998.1644; train_masked_gp_l1_reg_loss: 11156.6313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46200.1298; train_global_loss: 2106167.9769; train_optim_loss: 2106167.9769; val_kl_reg_loss: 28615.7288; val_edge_recon_loss: 11753.8966; val_gene_expr_recon_loss: 1996728.3125; val_masked_gp_l1_reg_loss: 11214.5947; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45258.8750; val_global_loss: 2093571.4375; val_optim_loss: 2093571.4375
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8985; val_auprc_score: 0.9790; val_best_acc_score: 0.8915; val_best_f1_score: 0.9377; train_kl_reg_loss: 29204.5702; train_edge_recon_loss: 11519.7465; train_gene_expr_recon_loss: 1990329.7963; train_masked_gp_l1_reg_loss: 11270.4088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44363.9062; train_global_loss: 2086688.4306; train_optim_loss: 2086688.4306; val_kl_reg_loss: 27590.8037; val_edge_recon_loss: 11353.6873; val_gene_expr_recon_loss: 1981375.7917; val_masked_gp_l1_reg_loss: 11330.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43442.1406; val_global_loss: 2075093.0208; val_optim_loss: 2075093.0208
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9000; val_auprc_score: 0.9793; val_best_acc_score: 0.8956; val_best_f1_score: 0.9397; train_kl_reg_loss: 28164.8699; train_edge_recon_loss: 11315.0531; train_gene_expr_recon_loss: 1975269.1875; train_masked_gp_l1_reg_loss: 11385.5807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42564.3657; train_global_loss: 2068699.0347; train_optim_loss: 2068699.0347; val_kl_reg_loss: 26612.5684; val_edge_recon_loss: 11319.7961; val_gene_expr_recon_loss: 1964876.7500; val_masked_gp_l1_reg_loss: 11444.4053; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41665.9062; val_global_loss: 2055919.3542; val_optim_loss: 2055919.3542
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9064; val_auprc_score: 0.9803; val_best_acc_score: 0.8962; val_best_f1_score: 0.9395; train_kl_reg_loss: 27202.3797; train_edge_recon_loss: 11427.5628; train_gene_expr_recon_loss: 1960935.5880; train_masked_gp_l1_reg_loss: 11499.5124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40815.6931; train_global_loss: 2051880.7431; train_optim_loss: 2051880.7431; val_kl_reg_loss: 25790.6266; val_edge_recon_loss: 11564.0309; val_gene_expr_recon_loss: 1949572.7083; val_masked_gp_l1_reg_loss: 11558.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39946.1719; val_global_loss: 2038431.5000; val_optim_loss: 2038431.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9092; val_auprc_score: 0.9808; val_best_acc_score: 0.8960; val_best_f1_score: 0.9399; train_kl_reg_loss: 26340.4293; train_edge_recon_loss: 11430.8489; train_gene_expr_recon_loss: 1946818.4167; train_masked_gp_l1_reg_loss: 11614.0880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39127.4965; train_global_loss: 2035331.2685; train_optim_loss: 2035331.2685; val_kl_reg_loss: 25157.0430; val_edge_recon_loss: 11417.7926; val_gene_expr_recon_loss: 1940262.0417; val_masked_gp_l1_reg_loss: 11672.6465; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38287.5547; val_global_loss: 2026797.0000; val_optim_loss: 2026797.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9131; val_auprc_score: 0.9823; val_best_acc_score: 0.8959; val_best_f1_score: 0.9405; train_kl_reg_loss: 25537.0657; train_edge_recon_loss: 11351.5418; train_gene_expr_recon_loss: 1933256.9653; train_masked_gp_l1_reg_loss: 11728.9114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37496.2943; train_global_loss: 2019370.7755; train_optim_loss: 2019370.7755; val_kl_reg_loss: 24183.2145; val_edge_recon_loss: 11336.0482; val_gene_expr_recon_loss: 1925376.0208; val_masked_gp_l1_reg_loss: 11787.8652; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36688.6797; val_global_loss: 2009371.7917; val_optim_loss: 2009371.7917
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9073; val_auprc_score: 0.9813; val_best_acc_score: 0.8959; val_best_f1_score: 0.9403; train_kl_reg_loss: 24769.9708; train_edge_recon_loss: 11316.9396; train_gene_expr_recon_loss: 1920747.5185; train_masked_gp_l1_reg_loss: 11840.0706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35924.4762; train_global_loss: 2004598.9861; train_optim_loss: 2004598.9861; val_kl_reg_loss: 23405.8037; val_edge_recon_loss: 11428.4604; val_gene_expr_recon_loss: 1913401.3750; val_masked_gp_l1_reg_loss: 11897.0713; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35149.3203; val_global_loss: 1995282.1458; val_optim_loss: 1995282.1458
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9142; val_auprc_score: 0.9830; val_best_acc_score: 0.8997; val_best_f1_score: 0.9424; train_kl_reg_loss: 24064.3361; train_edge_recon_loss: 11248.8675; train_gene_expr_recon_loss: 1908446.2176; train_masked_gp_l1_reg_loss: 11947.3327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34420.5986; train_global_loss: 1990127.3495; train_optim_loss: 1990127.3495; val_kl_reg_loss: 22860.9355; val_edge_recon_loss: 11101.6646; val_gene_expr_recon_loss: 1900178.0625; val_masked_gp_l1_reg_loss: 12002.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33684.8867; val_global_loss: 1979827.6875; val_optim_loss: 1979827.6875
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9174; val_auprc_score: 0.9836; val_best_acc_score: 0.9023; val_best_f1_score: 0.9435; train_kl_reg_loss: 23384.0243; train_edge_recon_loss: 11301.3485; train_gene_expr_recon_loss: 1896738.7106; train_masked_gp_l1_reg_loss: 12051.6219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32995.8549; train_global_loss: 1976471.5556; train_optim_loss: 1976471.5556; val_kl_reg_loss: 22335.4915; val_edge_recon_loss: 11306.2536; val_gene_expr_recon_loss: 1888627.5208; val_masked_gp_l1_reg_loss: 12105.4795; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32293.9180; val_global_loss: 1966668.6250; val_optim_loss: 1966668.6250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9125; val_auprc_score: 0.9816; val_best_acc_score: 0.8989; val_best_f1_score: 0.9415; train_kl_reg_loss: 22757.4833; train_edge_recon_loss: 11314.5184; train_gene_expr_recon_loss: 1885817.7384; train_masked_gp_l1_reg_loss: 12153.0422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31642.8294; train_global_loss: 1963685.6157; train_optim_loss: 1963685.6157; val_kl_reg_loss: 21689.8079; val_edge_recon_loss: 11253.0931; val_gene_expr_recon_loss: 1879486.9375; val_masked_gp_l1_reg_loss: 12203.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30976.3203; val_global_loss: 1955609.4583; val_optim_loss: 1955609.4583
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9171; val_auprc_score: 0.9834; val_best_acc_score: 0.9046; val_best_f1_score: 0.9446; train_kl_reg_loss: 22158.3689; train_edge_recon_loss: 11362.4128; train_gene_expr_recon_loss: 1874417.0093; train_masked_gp_l1_reg_loss: 12246.4633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30359.9553; train_global_loss: 1950544.2245; train_optim_loss: 1950544.2245; val_kl_reg_loss: 21155.6468; val_edge_recon_loss: 11121.5946; val_gene_expr_recon_loss: 1867059.3125; val_masked_gp_l1_reg_loss: 12293.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29731.9258; val_global_loss: 1941361.5833; val_optim_loss: 1941361.5833
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9008; val_auprc_score: 0.9796; val_best_acc_score: 0.8836; val_best_f1_score: 0.9342; train_kl_reg_loss: 18885.2172; train_edge_recon_loss: 11701.7056; train_gene_expr_recon_loss: 3568291.5972; train_masked_gp_l1_reg_loss: 14076.5706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28544.5464; train_global_loss: 3641499.6481; train_optim_loss: 3641499.6481; val_kl_reg_loss: 18672.0179; val_edge_recon_loss: 11572.7163; val_gene_expr_recon_loss: 3087470.4583; val_masked_gp_l1_reg_loss: 14472.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27188.5352; val_global_loss: 3159376.4167; val_optim_loss: 3159376.4167
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8880; val_auprc_score: 0.9761; val_best_acc_score: 0.8842; val_best_f1_score: 0.9348; train_kl_reg_loss: 21820.6241; train_edge_recon_loss: 11436.9935; train_gene_expr_recon_loss: 2828989.6898; train_masked_gp_l1_reg_loss: 14325.6169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25955.3810; train_global_loss: 2902528.3102; train_optim_loss: 2902528.3102; val_kl_reg_loss: 17609.2731; val_edge_recon_loss: 11358.9801; val_gene_expr_recon_loss: 2582127.8750; val_masked_gp_l1_reg_loss: 14210.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24727.7363; val_global_loss: 2650034.3333; val_optim_loss: 2650034.3333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8979; val_auprc_score: 0.9783; val_best_acc_score: 0.8911; val_best_f1_score: 0.9378; train_kl_reg_loss: 18180.3384; train_edge_recon_loss: 11416.6723; train_gene_expr_recon_loss: 2431186.9028; train_masked_gp_l1_reg_loss: 14150.7816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23634.5683; train_global_loss: 2498569.2639; train_optim_loss: 2498569.2639; val_kl_reg_loss: 15695.7298; val_edge_recon_loss: 11279.2743; val_gene_expr_recon_loss: 2301161.7083; val_masked_gp_l1_reg_loss: 14095.9160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22542.0801; val_global_loss: 2364774.7083; val_optim_loss: 2364774.7083
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9071; val_auprc_score: 0.9805; val_best_acc_score: 0.8956; val_best_f1_score: 0.9394; train_kl_reg_loss: 16064.4930; train_edge_recon_loss: 11229.6231; train_gene_expr_recon_loss: 2219753.0231; train_masked_gp_l1_reg_loss: 14045.4280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21563.3833; train_global_loss: 2282655.9630; train_optim_loss: 2282655.9630; val_kl_reg_loss: 14154.5267; val_edge_recon_loss: 11431.4077; val_gene_expr_recon_loss: 2142599.8333; val_masked_gp_l1_reg_loss: 13996.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20584.1914; val_global_loss: 2202766.5417; val_optim_loss: 2202766.5417

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9077; val_auprc_score: 0.9818; val_best_acc_score: 0.8949; val_best_f1_score: 0.9393; train_kl_reg_loss: 15074.1064; train_edge_recon_loss: 11191.9753; train_gene_expr_recon_loss: 2142147.7546; train_masked_gp_l1_reg_loss: 13960.6110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20450.8843; train_global_loss: 2202825.2870; train_optim_loss: 2202825.2870; val_kl_reg_loss: 14015.0067; val_edge_recon_loss: 11165.8452; val_gene_expr_recon_loss: 2135218.8750; val_masked_gp_l1_reg_loss: 13946.4707; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20345.8770; val_global_loss: 2194692.2083; val_optim_loss: 2194692.2083
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9029; val_auprc_score: 0.9790; val_best_acc_score: 0.8917; val_best_f1_score: 0.9376; train_kl_reg_loss: 14917.1593; train_edge_recon_loss: 11308.6053; train_gene_expr_recon_loss: 2131321.2639; train_masked_gp_l1_reg_loss: 13940.2536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20252.5589; train_global_loss: 2191739.8380; train_optim_loss: 2191739.8380; val_kl_reg_loss: 13856.1960; val_edge_recon_loss: 11598.2529; val_gene_expr_recon_loss: 2124277.5833; val_masked_gp_l1_reg_loss: 13933.9473; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20155.5430; val_global_loss: 2183821.5000; val_optim_loss: 2183821.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9093; val_auprc_score: 0.9804; val_best_acc_score: 0.8950; val_best_f1_score: 0.9386; train_kl_reg_loss: 14771.3267; train_edge_recon_loss: 11223.2870; train_gene_expr_recon_loss: 2121552.7500; train_masked_gp_l1_reg_loss: 13928.0545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20061.2447; train_global_loss: 2181536.6713; train_optim_loss: 2181536.6713; val_kl_reg_loss: 13770.9870; val_edge_recon_loss: 11525.5063; val_gene_expr_recon_loss: 2115890.2917; val_masked_gp_l1_reg_loss: 13922.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19963.0117; val_global_loss: 2175072.0417; val_optim_loss: 2175072.0417
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9090; val_auprc_score: 0.9811; val_best_acc_score: 0.8936; val_best_f1_score: 0.9386; train_kl_reg_loss: 14626.7363; train_edge_recon_loss: 11279.9747; train_gene_expr_recon_loss: 2112394.1759; train_masked_gp_l1_reg_loss: 13916.0535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19867.2271; train_global_loss: 2172084.1667; train_optim_loss: 2172084.1667; val_kl_reg_loss: 13565.7689; val_edge_recon_loss: 11439.2367; val_gene_expr_recon_loss: 2104099.4167; val_masked_gp_l1_reg_loss: 13909.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19767.3281; val_global_loss: 2162781.7083; val_optim_loss: 2162781.7083

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 23 min 4 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9207
val AUPRC score: 0.9845
val best accuracy score: 0.9052
val best F1 score: 0.9449
val target rna MSE score: 23.5567
val source rna MSE score: 167.8950
Val cat covariate0 mean sim diff: -0.0007

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
