[True, False, True]
Run timestamp: 06092023_134843_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 556628
Number of validation nodes: 61848
Number of training edges: 1316511
Number of validation edges: 146278
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8967; val_auprc_score: 0.9788; val_best_acc_score: 0.9183; val_best_f1_score: 0.9544; train_kl_reg_loss: 16921.3049; train_edge_recon_loss: 719839.4605; train_cat_covariates_contrastive_loss: 945814.4416; train_gene_expr_recon_loss: 2709737.0998; train_masked_gp_l1_reg_loss: 25574.1148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57677.6956; train_global_loss: 4475564.1097; train_optim_loss: 4475564.1097; val_kl_reg_loss: 14788.3008; val_edge_recon_loss: 724259.3098; val_cat_covariates_contrastive_loss: 944263.5398; val_gene_expr_recon_loss: 2566363.2019; val_masked_gp_l1_reg_loss: 23159.4961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13621.4199; val_global_loss: 4286455.3409; val_optim_loss: 4286455.3409
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9178; val_auprc_score: 0.9831; val_best_acc_score: 0.9287; val_best_f1_score: 0.9599; train_kl_reg_loss: 16723.2974; train_edge_recon_loss: 693864.2011; train_cat_covariates_contrastive_loss: 946532.1850; train_gene_expr_recon_loss: 2494553.1940; train_masked_gp_l1_reg_loss: 28050.7090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13976.5695; train_global_loss: 4193700.1628; train_optim_loss: 4193700.1628; val_kl_reg_loss: 18437.2373; val_edge_recon_loss: 712763.9683; val_cat_covariates_contrastive_loss: 947375.2734; val_gene_expr_recon_loss: 2437697.3715; val_masked_gp_l1_reg_loss: 32280.3496; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14597.2363; val_global_loss: 4163151.3400; val_optim_loss: 4163151.3400
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9273; val_auprc_score: 0.9852; val_best_acc_score: 0.9314; val_best_f1_score: 0.9615; train_kl_reg_loss: 19940.7681; train_edge_recon_loss: 689411.4449; train_cat_covariates_contrastive_loss: 948888.1447; train_gene_expr_recon_loss: 2404548.2561; train_masked_gp_l1_reg_loss: 34805.6766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14884.4689; train_global_loss: 4112478.7584; train_optim_loss: 4112478.7584; val_kl_reg_loss: 21118.5595; val_edge_recon_loss: 710316.5649; val_cat_covariates_contrastive_loss: 949576.8405; val_gene_expr_recon_loss: 2380639.3566; val_masked_gp_l1_reg_loss: 37256.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15250.4971; val_global_loss: 4114158.8086; val_optim_loss: 4114158.8086
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9278; val_auprc_score: 0.9847; val_best_acc_score: 0.9332; val_best_f1_score: 0.9623; train_kl_reg_loss: 22720.6740; train_edge_recon_loss: 690489.9678; train_cat_covariates_contrastive_loss: 950181.2410; train_gene_expr_recon_loss: 2358739.7916; train_masked_gp_l1_reg_loss: 38833.5020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15488.8516; train_global_loss: 4076454.0312; train_optim_loss: 4076454.0312; val_kl_reg_loss: 24209.3781; val_edge_recon_loss: 716279.9097; val_cat_covariates_contrastive_loss: 949353.9539; val_gene_expr_recon_loss: 2347058.2727; val_masked_gp_l1_reg_loss: 39995.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15742.4521; val_global_loss: 4092639.2421; val_optim_loss: 4092639.2421
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9294; val_auprc_score: 0.9851; val_best_acc_score: 0.9356; val_best_f1_score: 0.9636; train_kl_reg_loss: 24427.4162; train_edge_recon_loss: 690968.8859; train_cat_covariates_contrastive_loss: 950933.1724; train_gene_expr_recon_loss: 2333513.0641; train_masked_gp_l1_reg_loss: 40796.4433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15756.2897; train_global_loss: 4056395.2696; train_optim_loss: 4056395.2696; val_kl_reg_loss: 25516.4354; val_edge_recon_loss: 714359.5355; val_cat_covariates_contrastive_loss: 949662.8820; val_gene_expr_recon_loss: 2324027.3837; val_masked_gp_l1_reg_loss: 41819.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15994.8135; val_global_loss: 4071380.5009; val_optim_loss: 4071380.5009
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9322; val_auprc_score: 0.9857; val_best_acc_score: 0.9360; val_best_f1_score: 0.9639; train_kl_reg_loss: 25831.8469; train_edge_recon_loss: 689565.7479; train_cat_covariates_contrastive_loss: 951338.4513; train_gene_expr_recon_loss: 2314073.7297; train_masked_gp_l1_reg_loss: 42972.1629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16024.6420; train_global_loss: 4039806.5821; train_optim_loss: 4039806.5821; val_kl_reg_loss: 27065.2621; val_edge_recon_loss: 716001.1654; val_cat_covariates_contrastive_loss: 950302.3818; val_gene_expr_recon_loss: 2308255.6678; val_masked_gp_l1_reg_loss: 43709.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16195.7969; val_global_loss: 4061530.0000; val_optim_loss: 4061530.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9305; val_auprc_score: 0.9849; val_best_acc_score: 0.9366; val_best_f1_score: 0.9642; train_kl_reg_loss: 27025.6054; train_edge_recon_loss: 691300.5689; train_cat_covariates_contrastive_loss: 951783.9131; train_gene_expr_recon_loss: 2299552.7118; train_masked_gp_l1_reg_loss: 44524.7996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16322.5251; train_global_loss: 4030510.1219; train_optim_loss: 4030510.1219; val_kl_reg_loss: 29295.2337; val_edge_recon_loss: 718883.4131; val_cat_covariates_contrastive_loss: 949374.2937; val_gene_expr_recon_loss: 2294688.6267; val_masked_gp_l1_reg_loss: 45229.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16451.8477; val_global_loss: 4053922.5865; val_optim_loss: 4053922.5865
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9357; val_auprc_score: 0.9864; val_best_acc_score: 0.9367; val_best_f1_score: 0.9642; train_kl_reg_loss: 28042.1117; train_edge_recon_loss: 690561.3594; train_cat_covariates_contrastive_loss: 952063.4036; train_gene_expr_recon_loss: 2287104.3081; train_masked_gp_l1_reg_loss: 46008.4669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16592.7236; train_global_loss: 4020372.3721; train_optim_loss: 4020372.3721; val_kl_reg_loss: 28586.9860; val_edge_recon_loss: 716526.7071; val_cat_covariates_contrastive_loss: 951095.4819; val_gene_expr_recon_loss: 2284599.4904; val_masked_gp_l1_reg_loss: 46779.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16642.0625; val_global_loss: 4044229.9240; val_optim_loss: 4044229.9240
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9396; val_auprc_score: 0.9875; val_best_acc_score: 0.9385; val_best_f1_score: 0.9652; train_kl_reg_loss: 28993.1214; train_edge_recon_loss: 690133.7096; train_cat_covariates_contrastive_loss: 952380.4568; train_gene_expr_recon_loss: 2276410.5916; train_masked_gp_l1_reg_loss: 47396.4799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16978.3178; train_global_loss: 4012292.6754; train_optim_loss: 4012292.6754; val_kl_reg_loss: 29056.5565; val_edge_recon_loss: 715707.4102; val_cat_covariates_contrastive_loss: 952318.6560; val_gene_expr_recon_loss: 2271747.9816; val_masked_gp_l1_reg_loss: 48172.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17080.9648; val_global_loss: 4034083.5997; val_optim_loss: 4034083.5997
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9380; val_auprc_score: 0.9869; val_best_acc_score: 0.9373; val_best_f1_score: 0.9646; train_kl_reg_loss: 29895.2194; train_edge_recon_loss: 691431.8063; train_cat_covariates_contrastive_loss: 952695.9105; train_gene_expr_recon_loss: 2266425.6048; train_masked_gp_l1_reg_loss: 48506.4881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17318.4989; train_global_loss: 4006273.5322; train_optim_loss: 4006273.5322; val_kl_reg_loss: 30011.6983; val_edge_recon_loss: 718144.7504; val_cat_covariates_contrastive_loss: 952667.6383; val_gene_expr_recon_loss: 2262260.7072; val_masked_gp_l1_reg_loss: 48884.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17407.7324; val_global_loss: 4029377.5393; val_optim_loss: 4029377.5393
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9433; val_auprc_score: 0.9884; val_best_acc_score: 0.9404; val_best_f1_score: 0.9662; train_kl_reg_loss: 28410.3778; train_edge_recon_loss: 695208.1204; train_cat_covariates_contrastive_loss: 952303.2823; train_gene_expr_recon_loss: 2317936.8697; train_masked_gp_l1_reg_loss: 77609.7358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17740.3145; train_global_loss: 4089208.7013; train_optim_loss: 4089208.7013; val_kl_reg_loss: 30291.5673; val_edge_recon_loss: 712321.1200; val_cat_covariates_contrastive_loss: 953255.1272; val_gene_expr_recon_loss: 2271123.6530; val_masked_gp_l1_reg_loss: 54313.3164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17598.1445; val_global_loss: 4038902.9642; val_optim_loss: 4038902.9642
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9369; val_auprc_score: 0.9865; val_best_acc_score: 0.9389; val_best_f1_score: 0.9654; train_kl_reg_loss: 30996.4907; train_edge_recon_loss: 688683.2850; train_cat_covariates_contrastive_loss: 953218.4843; train_gene_expr_recon_loss: 2261332.7941; train_masked_gp_l1_reg_loss: 49686.3946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17623.2202; train_global_loss: 4001540.6676; train_optim_loss: 4001540.6676; val_kl_reg_loss: 32301.9300; val_edge_recon_loss: 716890.7882; val_cat_covariates_contrastive_loss: 951453.2336; val_gene_expr_recon_loss: 2256885.1407; val_masked_gp_l1_reg_loss: 48977.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17586.4648; val_global_loss: 4024095.0909; val_optim_loss: 4024095.0909
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9407; val_auprc_score: 0.9875; val_best_acc_score: 0.9413; val_best_f1_score: 0.9668; train_kl_reg_loss: 31434.4329; train_edge_recon_loss: 690991.9616; train_cat_covariates_contrastive_loss: 953158.3318; train_gene_expr_recon_loss: 2251823.9343; train_masked_gp_l1_reg_loss: 49552.6605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17680.9224; train_global_loss: 3994642.2479; train_optim_loss: 3994642.2479; val_kl_reg_loss: 30791.1728; val_edge_recon_loss: 712398.9456; val_cat_covariates_contrastive_loss: 953950.5551; val_gene_expr_recon_loss: 2249286.4851; val_masked_gp_l1_reg_loss: 50325.2383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17739.0547; val_global_loss: 4014491.4082; val_optim_loss: 4014491.4082
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9361; val_auprc_score: 0.9866; val_best_acc_score: 0.9371; val_best_f1_score: 0.9645; train_kl_reg_loss: 31741.2811; train_edge_recon_loss: 688830.9946; train_cat_covariates_contrastive_loss: 953277.0935; train_gene_expr_recon_loss: 2245080.1739; train_masked_gp_l1_reg_loss: 50635.3131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17727.0724; train_global_loss: 3987291.9287; train_optim_loss: 3987291.9287; val_kl_reg_loss: 33252.6641; val_edge_recon_loss: 711613.4379; val_cat_covariates_contrastive_loss: 951972.3993; val_gene_expr_recon_loss: 2242934.6923; val_masked_gp_l1_reg_loss: 50946.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17798.2012; val_global_loss: 4008518.1844; val_optim_loss: 4008518.1844
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9351; val_auprc_score: 0.9861; val_best_acc_score: 0.9377; val_best_f1_score: 0.9649; train_kl_reg_loss: 32368.7571; train_edge_recon_loss: 692847.8607; train_cat_covariates_contrastive_loss: 953591.1109; train_gene_expr_recon_loss: 2238203.0663; train_masked_gp_l1_reg_loss: 51333.5377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17817.9236; train_global_loss: 3986162.2587; train_optim_loss: 3986162.2587; val_kl_reg_loss: 32971.3948; val_edge_recon_loss: 708458.4363; val_cat_covariates_contrastive_loss: 951679.9576; val_gene_expr_recon_loss: 2235190.9406; val_masked_gp_l1_reg_loss: 51742.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17693.1562; val_global_loss: 3997736.7133; val_optim_loss: 3997736.7133
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9393; val_auprc_score: 0.9868; val_best_acc_score: 0.9425; val_best_f1_score: 0.9675; train_kl_reg_loss: 32663.3109; train_edge_recon_loss: 693178.3382; train_cat_covariates_contrastive_loss: 953703.3508; train_gene_expr_recon_loss: 2232900.3946; train_masked_gp_l1_reg_loss: 52164.9894; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17945.5771; train_global_loss: 3982555.9613; train_optim_loss: 3982555.9613; val_kl_reg_loss: 33996.2722; val_edge_recon_loss: 717461.8503; val_cat_covariates_contrastive_loss: 952859.6003; val_gene_expr_recon_loss: 2235231.1783; val_masked_gp_l1_reg_loss: 52405.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18121.5723; val_global_loss: 4010076.1469; val_optim_loss: 4010076.1469
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9408; val_auprc_score: 0.9874; val_best_acc_score: 0.9398; val_best_f1_score: 0.9660; train_kl_reg_loss: 33034.7602; train_edge_recon_loss: 693899.7489; train_cat_covariates_contrastive_loss: 953785.0621; train_gene_expr_recon_loss: 2228467.6801; train_masked_gp_l1_reg_loss: 52634.7883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18013.2757; train_global_loss: 3979835.3160; train_optim_loss: 3979835.3160; val_kl_reg_loss: 33594.4778; val_edge_recon_loss: 713667.2003; val_cat_covariates_contrastive_loss: 953545.6643; val_gene_expr_recon_loss: 2230418.1123; val_masked_gp_l1_reg_loss: 52697.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17994.9277; val_global_loss: 4001917.9598; val_optim_loss: 4001917.9598
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9309; val_auprc_score: 0.9850; val_best_acc_score: 0.9359; val_best_f1_score: 0.9638; train_kl_reg_loss: 33474.6030; train_edge_recon_loss: 694201.6468; train_cat_covariates_contrastive_loss: 953997.5410; train_gene_expr_recon_loss: 2225341.7245; train_masked_gp_l1_reg_loss: 52923.6902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18076.9723; train_global_loss: 3978016.1766; train_optim_loss: 3978016.1766; val_kl_reg_loss: 36936.4844; val_edge_recon_loss: 716726.0420; val_cat_covariates_contrastive_loss: 950612.5975; val_gene_expr_recon_loss: 2231365.8523; val_masked_gp_l1_reg_loss: 53325.5820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18165.4688; val_global_loss: 4007131.9747; val_optim_loss: 4007131.9747
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9423; val_auprc_score: 0.9876; val_best_acc_score: 0.9431; val_best_f1_score: 0.9678; train_kl_reg_loss: 33645.8709; train_edge_recon_loss: 691325.3659; train_cat_covariates_contrastive_loss: 953914.1177; train_gene_expr_recon_loss: 2221825.8075; train_masked_gp_l1_reg_loss: 53307.9337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18106.4351; train_global_loss: 3972125.5312; train_optim_loss: 3972125.5312; val_kl_reg_loss: 32952.1035; val_edge_recon_loss: 713777.8330; val_cat_covariates_contrastive_loss: 954234.3678; val_gene_expr_recon_loss: 2221267.2561; val_masked_gp_l1_reg_loss: 53566.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18235.1406; val_global_loss: 3994033.7998; val_optim_loss: 3994033.7998
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9427; val_auprc_score: 0.9877; val_best_acc_score: 0.9429; val_best_f1_score: 0.9677; train_kl_reg_loss: 33788.0275; train_edge_recon_loss: 690716.4052; train_cat_covariates_contrastive_loss: 953984.9579; train_gene_expr_recon_loss: 2218290.7284; train_masked_gp_l1_reg_loss: 53772.0447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18151.7328; train_global_loss: 3968703.8979; train_optim_loss: 3968703.8979; val_kl_reg_loss: 34215.9844; val_edge_recon_loss: 706523.9830; val_cat_covariates_contrastive_loss: 952921.5868; val_gene_expr_recon_loss: 2219180.0162; val_masked_gp_l1_reg_loss: 54096.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18007.8086; val_global_loss: 3984945.5795; val_optim_loss: 3984945.5795
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9436; val_auprc_score: 0.9880; val_best_acc_score: 0.9432; val_best_f1_score: 0.9678; train_kl_reg_loss: 34064.8888; train_edge_recon_loss: 690533.4160; train_cat_covariates_contrastive_loss: 953881.6082; train_gene_expr_recon_loss: 2215375.3409; train_masked_gp_l1_reg_loss: 54223.4151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18185.0344; train_global_loss: 3966263.7053; train_optim_loss: 3966263.7053; val_kl_reg_loss: 34352.7494; val_edge_recon_loss: 713131.2853; val_cat_covariates_contrastive_loss: 954322.5760; val_gene_expr_recon_loss: 2216903.1984; val_masked_gp_l1_reg_loss: 54439.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18354.4121; val_global_loss: 3991504.3138; val_optim_loss: 3991504.3138
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9400; val_auprc_score: 0.9870; val_best_acc_score: 0.9423; val_best_f1_score: 0.9674; train_kl_reg_loss: 34430.9395; train_edge_recon_loss: 692730.6641; train_cat_covariates_contrastive_loss: 954211.7416; train_gene_expr_recon_loss: 2212806.2907; train_masked_gp_l1_reg_loss: 54465.3441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18247.1658; train_global_loss: 3966892.1419; train_optim_loss: 3966892.1419; val_kl_reg_loss: 34690.8982; val_edge_recon_loss: 714004.6246; val_cat_covariates_contrastive_loss: 952775.8169; val_gene_expr_recon_loss: 2210863.1923; val_masked_gp_l1_reg_loss: 54463.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18199.4609; val_global_loss: 3984997.5315; val_optim_loss: 3984997.5315
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9424; val_auprc_score: 0.9875; val_best_acc_score: 0.9422; val_best_f1_score: 0.9672; train_kl_reg_loss: 34542.1661; train_edge_recon_loss: 692114.8745; train_cat_covariates_contrastive_loss: 954132.5957; train_gene_expr_recon_loss: 2209140.3712; train_masked_gp_l1_reg_loss: 54902.8385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18277.9378; train_global_loss: 3963110.7843; train_optim_loss: 3963110.7843; val_kl_reg_loss: 34151.1427; val_edge_recon_loss: 719543.3475; val_cat_covariates_contrastive_loss: 953776.1814; val_gene_expr_recon_loss: 2214577.5699; val_masked_gp_l1_reg_loss: 55379.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18277.4922; val_global_loss: 3995704.7404; val_optim_loss: 3995704.7404
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9430; val_auprc_score: 0.9876; val_best_acc_score: 0.9436; val_best_f1_score: 0.9680; train_kl_reg_loss: 34953.3061; train_edge_recon_loss: 693838.4048; train_cat_covariates_contrastive_loss: 954391.5947; train_gene_expr_recon_loss: 2207798.2421; train_masked_gp_l1_reg_loss: 54970.7101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18288.7272; train_global_loss: 3964240.9866; train_optim_loss: 3964240.9866; val_kl_reg_loss: 35367.5480; val_edge_recon_loss: 717321.3746; val_cat_covariates_contrastive_loss: 953020.6556; val_gene_expr_recon_loss: 2207223.5188; val_masked_gp_l1_reg_loss: 55173.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18303.8672; val_global_loss: 3986410.0944; val_optim_loss: 3986410.0944

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9436; val_auprc_score: 0.9879; val_best_acc_score: 0.9439; val_best_f1_score: 0.9682; train_kl_reg_loss: 34803.2950; train_edge_recon_loss: 688859.0792; train_cat_covariates_contrastive_loss: 953943.4996; train_gene_expr_recon_loss: 2201099.9633; train_masked_gp_l1_reg_loss: 49864.9145; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9383.8268; train_global_loss: 3937954.5748; train_optim_loss: 3937954.5748; val_kl_reg_loss: 35610.9990; val_edge_recon_loss: 710399.3875; val_cat_covariates_contrastive_loss: 952603.1989; val_gene_expr_recon_loss: 2202465.5962; val_masked_gp_l1_reg_loss: 49937.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9303.6494; val_global_loss: 3960320.3304; val_optim_loss: 3960320.3304
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9279; val_auprc_score: 0.9853; val_best_acc_score: 0.9324; val_best_f1_score: 0.9621; train_kl_reg_loss: 32014.1225; train_edge_recon_loss: 699067.0749; train_cat_covariates_contrastive_loss: 953949.7252; train_gene_expr_recon_loss: 1926296.0539; train_masked_gp_l1_reg_loss: 49693.9094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8743.0108; train_global_loss: 3669763.8968; train_optim_loss: 3669763.8968; val_kl_reg_loss: 26998.2010; val_edge_recon_loss: 722540.4412; val_cat_covariates_contrastive_loss: 953665.5197; val_gene_expr_recon_loss: 1924178.4462; val_masked_gp_l1_reg_loss: 49568.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8457.4111; val_global_loss: 3685408.8575; val_optim_loss: 3685408.8575
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9288; val_auprc_score: 0.9850; val_best_acc_score: 0.9334; val_best_f1_score: 0.9625; train_kl_reg_loss: 30444.1633; train_edge_recon_loss: 696585.0211; train_cat_covariates_contrastive_loss: 953458.4261; train_gene_expr_recon_loss: 1920956.2191; train_masked_gp_l1_reg_loss: 49642.6693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8443.8333; train_global_loss: 3659530.3287; train_optim_loss: 3659530.3287; val_kl_reg_loss: 27928.5987; val_edge_recon_loss: 725170.8088; val_cat_covariates_contrastive_loss: 953756.0677; val_gene_expr_recon_loss: 1923178.2067; val_masked_gp_l1_reg_loss: 49752.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8382.0312; val_global_loss: 3688168.1801; val_optim_loss: 3688168.1801
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9327; val_auprc_score: 0.9856; val_best_acc_score: 0.9359; val_best_f1_score: 0.9638; train_kl_reg_loss: 29954.5907; train_edge_recon_loss: 696324.5808; train_cat_covariates_contrastive_loss: 953304.9227; train_gene_expr_recon_loss: 1920548.3785; train_masked_gp_l1_reg_loss: 49856.3146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8393.7100; train_global_loss: 3658382.5017; train_optim_loss: 3658382.5017; val_kl_reg_loss: 28922.0281; val_edge_recon_loss: 727024.2603; val_cat_covariates_contrastive_loss: 952803.9659; val_gene_expr_recon_loss: 1921948.0105; val_masked_gp_l1_reg_loss: 49973.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8346.9814; val_global_loss: 3689019.1853; val_optim_loss: 3689019.1853
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9326; val_auprc_score: 0.9856; val_best_acc_score: 0.9364; val_best_f1_score: 0.9641; train_kl_reg_loss: 29871.9384; train_edge_recon_loss: 694727.6810; train_cat_covariates_contrastive_loss: 953273.9311; train_gene_expr_recon_loss: 1920124.1157; train_masked_gp_l1_reg_loss: 50066.1801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8383.8992; train_global_loss: 3656447.7448; train_optim_loss: 3656447.7448; val_kl_reg_loss: 29321.0943; val_edge_recon_loss: 725028.4087; val_cat_covariates_contrastive_loss: 953093.1967; val_gene_expr_recon_loss: 1922958.1281; val_masked_gp_l1_reg_loss: 50162.5898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8394.1260; val_global_loss: 3688957.5822; val_optim_loss: 3688957.5822
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9359; val_auprc_score: 0.9865; val_best_acc_score: 0.9375; val_best_f1_score: 0.9648; train_kl_reg_loss: 29805.9239; train_edge_recon_loss: 693418.6027; train_cat_covariates_contrastive_loss: 953217.2312; train_gene_expr_recon_loss: 1919228.4415; train_masked_gp_l1_reg_loss: 50260.6678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8384.0229; train_global_loss: 3654314.8880; train_optim_loss: 3654314.8880; val_kl_reg_loss: 29326.6591; val_edge_recon_loss: 718112.2025; val_cat_covariates_contrastive_loss: 952941.2760; val_gene_expr_recon_loss: 1920188.8868; val_masked_gp_l1_reg_loss: 50342.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8415.9023; val_global_loss: 3679327.1031; val_optim_loss: 3679327.1031
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9347; val_auprc_score: 0.9861; val_best_acc_score: 0.9374; val_best_f1_score: 0.9647; train_kl_reg_loss: 29780.9375; train_edge_recon_loss: 692215.6170; train_cat_covariates_contrastive_loss: 953210.4161; train_gene_expr_recon_loss: 1918847.7955; train_masked_gp_l1_reg_loss: 50413.7139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8399.5645; train_global_loss: 3652868.0427; train_optim_loss: 3652868.0427; val_kl_reg_loss: 29361.5261; val_edge_recon_loss: 713947.1647; val_cat_covariates_contrastive_loss: 952727.1838; val_gene_expr_recon_loss: 1920100.8444; val_masked_gp_l1_reg_loss: 50504.9180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8379.6982; val_global_loss: 3675021.4668; val_optim_loss: 3675021.4668
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9351; val_auprc_score: 0.9861; val_best_acc_score: 0.9378; val_best_f1_score: 0.9649; train_kl_reg_loss: 32358.1618; train_edge_recon_loss: 691037.5214; train_cat_covariates_contrastive_loss: 953195.9158; train_gene_expr_recon_loss: 1919200.5985; train_masked_gp_l1_reg_loss: 50542.7701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8416.1193; train_global_loss: 3654751.0882; train_optim_loss: 3654751.0882; val_kl_reg_loss: 29502.0976; val_edge_recon_loss: 720821.6236; val_cat_covariates_contrastive_loss: 953616.4449; val_gene_expr_recon_loss: 1921640.2155; val_masked_gp_l1_reg_loss: 50610.6445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8396.0371; val_global_loss: 3684587.1320; val_optim_loss: 3684587.1320
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9345; val_auprc_score: 0.9860; val_best_acc_score: 0.9384; val_best_f1_score: 0.9653; train_kl_reg_loss: 29819.0212; train_edge_recon_loss: 692795.3680; train_cat_covariates_contrastive_loss: 953295.9997; train_gene_expr_recon_loss: 1918634.6736; train_masked_gp_l1_reg_loss: 50645.2907; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8409.5770; train_global_loss: 3653599.9346; train_optim_loss: 3653599.9346; val_kl_reg_loss: 32658.6529; val_edge_recon_loss: 712648.8923; val_cat_covariates_contrastive_loss: 953218.6853; val_gene_expr_recon_loss: 1920241.3702; val_masked_gp_l1_reg_loss: 50726.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8424.5586; val_global_loss: 3677918.8479; val_optim_loss: 3677918.8479
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9370; val_auprc_score: 0.9864; val_best_acc_score: 0.9380; val_best_f1_score: 0.9650; train_kl_reg_loss: 30280.8672; train_edge_recon_loss: 691544.8711; train_cat_covariates_contrastive_loss: 953216.3927; train_gene_expr_recon_loss: 1918671.4364; train_masked_gp_l1_reg_loss: 50748.6608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8413.6582; train_global_loss: 3652875.8880; train_optim_loss: 3652875.8880; val_kl_reg_loss: 29633.4977; val_edge_recon_loss: 720153.4956; val_cat_covariates_contrastive_loss: 953065.0240; val_gene_expr_recon_loss: 1921932.0507; val_masked_gp_l1_reg_loss: 50798.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8402.3301; val_global_loss: 3683984.8199; val_optim_loss: 3683984.8199
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9385; val_auprc_score: 0.9871; val_best_acc_score: 0.9391; val_best_f1_score: 0.9656; train_kl_reg_loss: 29825.5728; train_edge_recon_loss: 690908.3545; train_cat_covariates_contrastive_loss: 953281.2854; train_gene_expr_recon_loss: 1918061.9219; train_masked_gp_l1_reg_loss: 50841.1877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8424.9099; train_global_loss: 3651343.2328; train_optim_loss: 3651343.2328; val_kl_reg_loss: 29444.0394; val_edge_recon_loss: 710827.4148; val_cat_covariates_contrastive_loss: 954081.2478; val_gene_expr_recon_loss: 1917533.7828; val_masked_gp_l1_reg_loss: 50882.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8406.7734; val_global_loss: 3671175.9869; val_optim_loss: 3671175.9869
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9373; val_auprc_score: 0.9868; val_best_acc_score: 0.9395; val_best_f1_score: 0.9658; train_kl_reg_loss: 29832.2216; train_edge_recon_loss: 692351.2962; train_cat_covariates_contrastive_loss: 953384.4138; train_gene_expr_recon_loss: 1917875.8955; train_masked_gp_l1_reg_loss: 50924.4386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8439.1608; train_global_loss: 3652807.4253; train_optim_loss: 3652807.4253; val_kl_reg_loss: 30349.5328; val_edge_recon_loss: 714476.6546; val_cat_covariates_contrastive_loss: 951858.4366; val_gene_expr_recon_loss: 1920783.1407; val_masked_gp_l1_reg_loss: 50997.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8438.0420; val_global_loss: 3676903.0201; val_optim_loss: 3676903.0201
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9386; val_auprc_score: 0.9869; val_best_acc_score: 0.9386; val_best_f1_score: 0.9654; train_kl_reg_loss: 29786.2144; train_edge_recon_loss: 690644.0701; train_cat_covariates_contrastive_loss: 953142.6042; train_gene_expr_recon_loss: 1918167.8497; train_masked_gp_l1_reg_loss: 51004.0082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8437.6262; train_global_loss: 3651182.3691; train_optim_loss: 3651182.3691; val_kl_reg_loss: 29650.0537; val_edge_recon_loss: 719839.9186; val_cat_covariates_contrastive_loss: 953056.0649; val_gene_expr_recon_loss: 1918758.5476; val_masked_gp_l1_reg_loss: 51007.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8422.0703; val_global_loss: 3680733.5935; val_optim_loss: 3680733.5935
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9383; val_auprc_score: 0.9869; val_best_acc_score: 0.9403; val_best_f1_score: 0.9663; train_kl_reg_loss: 29812.0421; train_edge_recon_loss: 692066.5500; train_cat_covariates_contrastive_loss: 953155.0837; train_gene_expr_recon_loss: 1917311.5182; train_masked_gp_l1_reg_loss: 51076.6496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8440.1505; train_global_loss: 3651861.9928; train_optim_loss: 3651861.9928; val_kl_reg_loss: 30019.4645; val_edge_recon_loss: 712065.1172; val_cat_covariates_contrastive_loss: 952646.8335; val_gene_expr_recon_loss: 1921063.7950; val_masked_gp_l1_reg_loss: 51124.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8482.0586; val_global_loss: 3675401.9615; val_optim_loss: 3675401.9615
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9388; val_auprc_score: 0.9871; val_best_acc_score: 0.9406; val_best_f1_score: 0.9664; train_kl_reg_loss: 29784.7589; train_edge_recon_loss: 691567.0052; train_cat_covariates_contrastive_loss: 953091.4475; train_gene_expr_recon_loss: 1916794.4132; train_masked_gp_l1_reg_loss: 51143.0498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8445.2692; train_global_loss: 3650825.9425; train_optim_loss: 3650825.9425; val_kl_reg_loss: 29739.3793; val_edge_recon_loss: 710905.7745; val_cat_covariates_contrastive_loss: 952480.2244; val_gene_expr_recon_loss: 1920548.6879; val_masked_gp_l1_reg_loss: 51185.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8424.4258; val_global_loss: 3673284.3164; val_optim_loss: 3673284.3164

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9386; val_auprc_score: 0.9870; val_best_acc_score: 0.9398; val_best_f1_score: 0.9661; train_kl_reg_loss: 29755.8550; train_edge_recon_loss: 691960.4615; train_cat_covariates_contrastive_loss: 953124.6418; train_gene_expr_recon_loss: 1916333.2185; train_masked_gp_l1_reg_loss: 50728.7795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7570.9694; train_global_loss: 3649473.9254; train_optim_loss: 3649473.9254; val_kl_reg_loss: 29640.6590; val_edge_recon_loss: 712007.7948; val_cat_covariates_contrastive_loss: 953342.2815; val_gene_expr_recon_loss: 1919081.1158; val_masked_gp_l1_reg_loss: 50736.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7559.0493; val_global_loss: 3672367.0944; val_optim_loss: 3672367.0944
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9385; val_auprc_score: 0.9868; val_best_acc_score: 0.9406; val_best_f1_score: 0.9664; train_kl_reg_loss: 29820.6226; train_edge_recon_loss: 689753.0438; train_cat_covariates_contrastive_loss: 953125.4487; train_gene_expr_recon_loss: 1916770.3534; train_masked_gp_l1_reg_loss: 50741.9021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7557.9911; train_global_loss: 3647769.3649; train_optim_loss: 3647769.3649; val_kl_reg_loss: 29825.6887; val_edge_recon_loss: 710814.2496; val_cat_covariates_contrastive_loss: 952849.8953; val_gene_expr_recon_loss: 1919116.2098; val_masked_gp_l1_reg_loss: 50747.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7558.0039; val_global_loss: 3670912.0393; val_optim_loss: 3670912.0393
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9386; val_auprc_score: 0.9867; val_best_acc_score: 0.9403; val_best_f1_score: 0.9663; train_kl_reg_loss: 29756.7924; train_edge_recon_loss: 691362.0936; train_cat_covariates_contrastive_loss: 952980.1383; train_gene_expr_recon_loss: 1915890.2567; train_masked_gp_l1_reg_loss: 50754.5922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7559.3848; train_global_loss: 3648303.2576; train_optim_loss: 3648303.2576; val_kl_reg_loss: 29772.3814; val_edge_recon_loss: 719594.3966; val_cat_covariates_contrastive_loss: 953366.9036; val_gene_expr_recon_loss: 1919054.4244; val_masked_gp_l1_reg_loss: 50762.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7552.5601; val_global_loss: 3680103.1049; val_optim_loss: 3680103.1049
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9379; val_auprc_score: 0.9869; val_best_acc_score: 0.9405; val_best_f1_score: 0.9665; train_kl_reg_loss: 29974.5037; train_edge_recon_loss: 693458.9978; train_cat_covariates_contrastive_loss: 953281.3773; train_gene_expr_recon_loss: 1916550.9080; train_masked_gp_l1_reg_loss: 50772.8577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7557.8036; train_global_loss: 3651596.4518; train_optim_loss: 3651596.4518; val_kl_reg_loss: 29699.8893; val_edge_recon_loss: 704985.6029; val_cat_covariates_contrastive_loss: 953376.7142; val_gene_expr_recon_loss: 1919430.5756; val_masked_gp_l1_reg_loss: 50781.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7574.3921; val_global_loss: 3665848.5315; val_optim_loss: 3665848.5315
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9403; val_auprc_score: 0.9874; val_best_acc_score: 0.9403; val_best_f1_score: 0.9663; train_kl_reg_loss: 29803.7782; train_edge_recon_loss: 691632.9508; train_cat_covariates_contrastive_loss: 953164.5837; train_gene_expr_recon_loss: 1916259.9460; train_masked_gp_l1_reg_loss: 50788.2253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7560.0255; train_global_loss: 3649209.5086; train_optim_loss: 3649209.5086; val_kl_reg_loss: 29928.1999; val_edge_recon_loss: 711332.7321; val_cat_covariates_contrastive_loss: 952525.0350; val_gene_expr_recon_loss: 1919984.4764; val_masked_gp_l1_reg_loss: 50786.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7565.4932; val_global_loss: 3672122.7010; val_optim_loss: 3672122.7010
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9377; val_auprc_score: 0.9867; val_best_acc_score: 0.9395; val_best_f1_score: 0.9659; train_kl_reg_loss: 29802.7103; train_edge_recon_loss: 691375.1458; train_cat_covariates_contrastive_loss: 953036.0301; train_gene_expr_recon_loss: 1916774.4045; train_masked_gp_l1_reg_loss: 50796.4382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7558.8923; train_global_loss: 3649343.6242; train_optim_loss: 3649343.6242; val_kl_reg_loss: 29819.5834; val_edge_recon_loss: 716919.2048; val_cat_covariates_contrastive_loss: 952815.5439; val_gene_expr_recon_loss: 1918523.8230; val_masked_gp_l1_reg_loss: 50803.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7558.2402; val_global_loss: 3676439.6591; val_optim_loss: 3676439.6591
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9397; val_auprc_score: 0.9870; val_best_acc_score: 0.9396; val_best_f1_score: 0.9659; train_kl_reg_loss: 29827.1793; train_edge_recon_loss: 690831.9919; train_cat_covariates_contrastive_loss: 953071.4184; train_gene_expr_recon_loss: 1916091.2231; train_masked_gp_l1_reg_loss: 50805.2577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7553.5077; train_global_loss: 3648180.5752; train_optim_loss: 3648180.5752; val_kl_reg_loss: 29945.4392; val_edge_recon_loss: 718494.3503; val_cat_covariates_contrastive_loss: 952586.9709; val_gene_expr_recon_loss: 1918072.0699; val_masked_gp_l1_reg_loss: 50810.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7546.4512; val_global_loss: 3677456.3435; val_optim_loss: 3677456.3435
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9392; val_auprc_score: 0.9871; val_best_acc_score: 0.9401; val_best_f1_score: 0.9661; train_kl_reg_loss: 29809.8015; train_edge_recon_loss: 691272.2144; train_cat_covariates_contrastive_loss: 952991.9741; train_gene_expr_recon_loss: 1916536.7752; train_masked_gp_l1_reg_loss: 50815.5647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7554.0488; train_global_loss: 3648980.3752; train_optim_loss: 3648980.3752; val_kl_reg_loss: 29725.9762; val_edge_recon_loss: 717735.2892; val_cat_covariates_contrastive_loss: 953301.2268; val_gene_expr_recon_loss: 1919136.9353; val_masked_gp_l1_reg_loss: 50820.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7562.6074; val_global_loss: 3678282.4309; val_optim_loss: 3678282.4309

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9397; val_auprc_score: 0.9872; val_best_acc_score: 0.9405; val_best_f1_score: 0.9664; train_kl_reg_loss: 29776.0523; train_edge_recon_loss: 692013.4408; train_cat_covariates_contrastive_loss: 953246.8243; train_gene_expr_recon_loss: 1916626.8704; train_masked_gp_l1_reg_loss: 50770.6824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7463.5773; train_global_loss: 3649897.4412; train_optim_loss: 3649897.4412; val_kl_reg_loss: 29764.6304; val_edge_recon_loss: 710525.8776; val_cat_covariates_contrastive_loss: 953140.4795; val_gene_expr_recon_loss: 1917263.8824; val_masked_gp_l1_reg_loss: 50770.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7458.2925; val_global_loss: 3668923.8776; val_optim_loss: 3668923.8776
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9389; val_auprc_score: 0.9869; val_best_acc_score: 0.9399; val_best_f1_score: 0.9660; train_kl_reg_loss: 29786.0911; train_edge_recon_loss: 690841.1769; train_cat_covariates_contrastive_loss: 953177.8707; train_gene_expr_recon_loss: 1916312.9346; train_masked_gp_l1_reg_loss: 50771.3540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7459.1036; train_global_loss: 3648348.5357; train_optim_loss: 3648348.5357; val_kl_reg_loss: 29775.1817; val_edge_recon_loss: 721340.0321; val_cat_covariates_contrastive_loss: 953135.3805; val_gene_expr_recon_loss: 1918621.6639; val_masked_gp_l1_reg_loss: 50771.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7457.9849; val_global_loss: 3681101.8357; val_optim_loss: 3681101.8357
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9398; val_auprc_score: 0.9871; val_best_acc_score: 0.9402; val_best_f1_score: 0.9662; train_kl_reg_loss: 29799.3529; train_edge_recon_loss: 689833.9255; train_cat_covariates_contrastive_loss: 953255.1658; train_gene_expr_recon_loss: 1916754.4069; train_masked_gp_l1_reg_loss: 50772.5427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7456.1850; train_global_loss: 3647871.5777; train_optim_loss: 3647871.5777; val_kl_reg_loss: 29774.3692; val_edge_recon_loss: 717348.5927; val_cat_covariates_contrastive_loss: 952787.6477; val_gene_expr_recon_loss: 1916955.7365; val_masked_gp_l1_reg_loss: 50773.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7456.3027; val_global_loss: 3675095.5970; val_optim_loss: 3675095.5970
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9386; val_auprc_score: 0.9868; val_best_acc_score: 0.9398; val_best_f1_score: 0.9660; train_kl_reg_loss: 29787.8926; train_edge_recon_loss: 690175.0451; train_cat_covariates_contrastive_loss: 953094.5007; train_gene_expr_recon_loss: 1916828.8209; train_masked_gp_l1_reg_loss: 50774.0682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7457.0051; train_global_loss: 3648117.3352; train_optim_loss: 3648117.3352; val_kl_reg_loss: 29759.3069; val_edge_recon_loss: 714031.7045; val_cat_covariates_contrastive_loss: 952543.1538; val_gene_expr_recon_loss: 1917844.2548; val_masked_gp_l1_reg_loss: 50774.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7456.5474; val_global_loss: 3672409.6809; val_optim_loss: 3672409.6809

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 931 min 12 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9211
val AUPRC score: 0.9792
val best accuracy score: 0.9367
val best F1 score: 0.9642
val target rna MSE score: 0.2321
val source rna MSE score: 0.1181
Val cat covariate0 mean sim diff: -0.0022
Val cat covariate1 mean sim diff: -0.0521
Val cat covariate2 mean sim diff: -0.0008

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
