Run timestamp: 20062023_155305_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', 'batch3', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 3, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1423, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cond_embed_input: 3, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 380406
Number of validation nodes: 42267
Number of training edges: 914339
Number of validation edges: 101593
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9211; val_auprc_score: 0.9574; val_best_acc_score: 0.9070; val_best_f1_score: 0.9385; train_kl_reg_loss: 6344.9353; train_edge_recon_loss: 165151.7099; train_cond_contrastive_loss: 81613.5046; train_gene_expr_recon_loss: 129027.1384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382137.2878; train_optim_loss: 382137.2878; val_kl_reg_loss: 7403.3724; val_edge_recon_loss: 150167.0544; val_cond_contrastive_loss: 79356.4022; val_gene_expr_recon_loss: 112310.8022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349237.6262; val_optim_loss: 349237.6262
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9297; val_auprc_score: 0.9603; val_best_acc_score: 0.9282; val_best_f1_score: 0.9523; train_kl_reg_loss: 7252.8532; train_edge_recon_loss: 148202.3882; train_cond_contrastive_loss: 80248.0681; train_gene_expr_recon_loss: 106351.1031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342054.4143; train_optim_loss: 342054.4143; val_kl_reg_loss: 6930.1709; val_edge_recon_loss: 147183.2963; val_cond_contrastive_loss: 79691.2081; val_gene_expr_recon_loss: 102497.0894; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336301.7625; val_optim_loss: 336301.7625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9308; val_auprc_score: 0.9600; val_best_acc_score: 0.9332; val_best_f1_score: 0.9553; train_kl_reg_loss: 6786.0276; train_edge_recon_loss: 146193.0664; train_cond_contrastive_loss: 80202.4510; train_gene_expr_recon_loss: 99909.2584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333090.8032; train_optim_loss: 333090.8032; val_kl_reg_loss: 6499.7567; val_edge_recon_loss: 146299.2338; val_cond_contrastive_loss: 79740.8262; val_gene_expr_recon_loss: 98006.5759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330546.3937; val_optim_loss: 330546.3937
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9281; val_auprc_score: 0.9570; val_best_acc_score: 0.9359; val_best_f1_score: 0.9572; train_kl_reg_loss: 6507.3948; train_edge_recon_loss: 145018.5792; train_cond_contrastive_loss: 80123.4166; train_gene_expr_recon_loss: 95993.8491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327643.2395; train_optim_loss: 327643.2395; val_kl_reg_loss: 6352.7450; val_edge_recon_loss: 145619.3675; val_cond_contrastive_loss: 79506.1356; val_gene_expr_recon_loss: 94590.5188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326068.7662; val_optim_loss: 326068.7662
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9365; val_auprc_score: 0.9623; val_best_acc_score: 0.9373; val_best_f1_score: 0.9579; train_kl_reg_loss: 6397.4640; train_edge_recon_loss: 143930.5017; train_cond_contrastive_loss: 80053.6266; train_gene_expr_recon_loss: 93286.0680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323667.6596; train_optim_loss: 323667.6596; val_kl_reg_loss: 6091.8434; val_edge_recon_loss: 144762.1137; val_cond_contrastive_loss: 79797.0559; val_gene_expr_recon_loss: 92291.1225; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322942.1412; val_optim_loss: 322942.1412
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9353; val_auprc_score: 0.9608; val_best_acc_score: 0.9398; val_best_f1_score: 0.9596; train_kl_reg_loss: 6354.4836; train_edge_recon_loss: 143670.5605; train_cond_contrastive_loss: 80046.9996; train_gene_expr_recon_loss: 91353.7861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 321425.8291; train_optim_loss: 321425.8291; val_kl_reg_loss: 6188.5399; val_edge_recon_loss: 144845.9925; val_cond_contrastive_loss: 79603.4266; val_gene_expr_recon_loss: 90616.9584; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321254.9200; val_optim_loss: 321254.9200
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9413; val_auprc_score: 0.9631; val_best_acc_score: 0.9497; val_best_f1_score: 0.9662; train_kl_reg_loss: 6418.2519; train_edge_recon_loss: 142770.1917; train_cond_contrastive_loss: 80081.8338; train_gene_expr_recon_loss: 89890.6414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 319160.9169; train_optim_loss: 319160.9169; val_kl_reg_loss: 6279.5548; val_edge_recon_loss: 142989.9669; val_cond_contrastive_loss: 79586.3084; val_gene_expr_recon_loss: 89367.3791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318223.2075; val_optim_loss: 318223.2075
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9394; val_auprc_score: 0.9618; val_best_acc_score: 0.9486; val_best_f1_score: 0.9654; train_kl_reg_loss: 6414.7232; train_edge_recon_loss: 142066.3014; train_cond_contrastive_loss: 79975.5197; train_gene_expr_recon_loss: 88671.7153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 317128.2602; train_optim_loss: 317128.2602; val_kl_reg_loss: 6257.7283; val_edge_recon_loss: 143827.3200; val_cond_contrastive_loss: 79372.8684; val_gene_expr_recon_loss: 88132.5397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317590.4625; val_optim_loss: 317590.4625
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9398; val_auprc_score: 0.9619; val_best_acc_score: 0.9501; val_best_f1_score: 0.9665; train_kl_reg_loss: 6434.0075; train_edge_recon_loss: 141995.3884; train_cond_contrastive_loss: 79970.1977; train_gene_expr_recon_loss: 87667.5633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 316067.1571; train_optim_loss: 316067.1571; val_kl_reg_loss: 6572.3765; val_edge_recon_loss: 144105.6931; val_cond_contrastive_loss: 79366.2269; val_gene_expr_recon_loss: 87364.2112; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 317408.5087; val_optim_loss: 317408.5087
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9400; val_auprc_score: 0.9625; val_best_acc_score: 0.9501; val_best_f1_score: 0.9665; train_kl_reg_loss: 6469.6543; train_edge_recon_loss: 142186.3755; train_cond_contrastive_loss: 79962.5252; train_gene_expr_recon_loss: 86790.0891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 315408.6443; train_optim_loss: 315408.6443; val_kl_reg_loss: 6351.0908; val_edge_recon_loss: 143162.5294; val_cond_contrastive_loss: 79550.7600; val_gene_expr_recon_loss: 86547.3731; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 315611.7512; val_optim_loss: 315611.7512
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9408; val_auprc_score: 0.9631; val_best_acc_score: 0.9524; val_best_f1_score: 0.9680; train_kl_reg_loss: 6489.4484; train_edge_recon_loss: 142247.4786; train_cond_contrastive_loss: 79924.5150; train_gene_expr_recon_loss: 85986.7160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 314648.1583; train_optim_loss: 314648.1583; val_kl_reg_loss: 6445.0993; val_edge_recon_loss: 142476.9394; val_cond_contrastive_loss: 79473.4559; val_gene_expr_recon_loss: 85786.5975; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 314182.0925; val_optim_loss: 314182.0925
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9401; val_auprc_score: 0.9624; val_best_acc_score: 0.9512; val_best_f1_score: 0.9672; train_kl_reg_loss: 6530.8098; train_edge_recon_loss: 142153.4085; train_cond_contrastive_loss: 79932.6804; train_gene_expr_recon_loss: 85379.6188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 313996.5173; train_optim_loss: 313996.5173; val_kl_reg_loss: 6448.6214; val_edge_recon_loss: 143575.5856; val_cond_contrastive_loss: 79492.2744; val_gene_expr_recon_loss: 85312.3559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 314828.8337; val_optim_loss: 314828.8337
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9392; val_auprc_score: 0.9620; val_best_acc_score: 0.9514; val_best_f1_score: 0.9674; train_kl_reg_loss: 6555.2865; train_edge_recon_loss: 142219.0015; train_cond_contrastive_loss: 79928.4669; train_gene_expr_recon_loss: 84759.0835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 313461.8401; train_optim_loss: 313461.8401; val_kl_reg_loss: 6799.0992; val_edge_recon_loss: 142866.7694; val_cond_contrastive_loss: 79468.8087; val_gene_expr_recon_loss: 84756.0628; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 313890.7375; val_optim_loss: 313890.7375
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9418; val_auprc_score: 0.9639; val_best_acc_score: 0.9527; val_best_f1_score: 0.9683; train_kl_reg_loss: 6589.5230; train_edge_recon_loss: 141992.8112; train_cond_contrastive_loss: 79915.0196; train_gene_expr_recon_loss: 84261.1991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 312758.5545; train_optim_loss: 312758.5545; val_kl_reg_loss: 6496.5799; val_edge_recon_loss: 142448.7075; val_cond_contrastive_loss: 79596.2856; val_gene_expr_recon_loss: 84300.8572; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 312842.4275; val_optim_loss: 312842.4275
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9395; val_auprc_score: 0.9620; val_best_acc_score: 0.9526; val_best_f1_score: 0.9681; train_kl_reg_loss: 6620.0841; train_edge_recon_loss: 142010.6318; train_cond_contrastive_loss: 79913.7640; train_gene_expr_recon_loss: 83800.4039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 312344.8845; train_optim_loss: 312344.8845; val_kl_reg_loss: 6559.4228; val_edge_recon_loss: 142962.2525; val_cond_contrastive_loss: 79457.5038; val_gene_expr_recon_loss: 83700.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 312679.1813; val_optim_loss: 312679.1813
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9415; val_auprc_score: 0.9631; val_best_acc_score: 0.9530; val_best_f1_score: 0.9684; train_kl_reg_loss: 6647.7398; train_edge_recon_loss: 141877.6460; train_cond_contrastive_loss: 79899.4696; train_gene_expr_recon_loss: 83349.9512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 311774.8068; train_optim_loss: 311774.8068; val_kl_reg_loss: 6559.7492; val_edge_recon_loss: 143405.0081; val_cond_contrastive_loss: 79655.1503; val_gene_expr_recon_loss: 83448.6397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 313068.5475; val_optim_loss: 313068.5475
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9406; val_auprc_score: 0.9629; val_best_acc_score: 0.9532; val_best_f1_score: 0.9686; train_kl_reg_loss: 6668.2099; train_edge_recon_loss: 141925.6327; train_cond_contrastive_loss: 79915.4521; train_gene_expr_recon_loss: 82997.5720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 311506.8661; train_optim_loss: 311506.8661; val_kl_reg_loss: 6556.2017; val_edge_recon_loss: 142977.3563; val_cond_contrastive_loss: 79569.2397; val_gene_expr_recon_loss: 83069.4269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 312172.2263; val_optim_loss: 312172.2263
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9424; val_auprc_score: 0.9636; val_best_acc_score: 0.9542; val_best_f1_score: 0.9692; train_kl_reg_loss: 6685.3252; train_edge_recon_loss: 141654.6587; train_cond_contrastive_loss: 79873.0681; train_gene_expr_recon_loss: 82702.9368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 310915.9898; train_optim_loss: 310915.9898; val_kl_reg_loss: 6461.1695; val_edge_recon_loss: 143049.4744; val_cond_contrastive_loss: 79537.1016; val_gene_expr_recon_loss: 82743.2462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 311790.9863; val_optim_loss: 311790.9863
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9407; val_auprc_score: 0.9627; val_best_acc_score: 0.9545; val_best_f1_score: 0.9694; train_kl_reg_loss: 6714.4526; train_edge_recon_loss: 141915.5389; train_cond_contrastive_loss: 79886.3707; train_gene_expr_recon_loss: 82400.1443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 310916.5056; train_optim_loss: 310916.5056; val_kl_reg_loss: 6686.9873; val_edge_recon_loss: 142579.4850; val_cond_contrastive_loss: 79443.0256; val_gene_expr_recon_loss: 82488.8313; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 311198.3300; val_optim_loss: 311198.3300
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9406; val_auprc_score: 0.9632; val_best_acc_score: 0.9542; val_best_f1_score: 0.9693; train_kl_reg_loss: 6727.7757; train_edge_recon_loss: 141626.4895; train_cond_contrastive_loss: 79846.3047; train_gene_expr_recon_loss: 82143.7967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 310344.3668; train_optim_loss: 310344.3668; val_kl_reg_loss: 6540.1721; val_edge_recon_loss: 142255.7919; val_cond_contrastive_loss: 79431.6684; val_gene_expr_recon_loss: 82326.1034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 310553.7363; val_optim_loss: 310553.7363
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9410; val_auprc_score: 0.9631; val_best_acc_score: 0.9541; val_best_f1_score: 0.9692; train_kl_reg_loss: 6744.2300; train_edge_recon_loss: 141746.0334; train_cond_contrastive_loss: 79849.3965; train_gene_expr_recon_loss: 81866.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 310206.4781; train_optim_loss: 310206.4781; val_kl_reg_loss: 6667.3881; val_edge_recon_loss: 142558.0050; val_cond_contrastive_loss: 79463.5722; val_gene_expr_recon_loss: 82073.2669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 310762.2325; val_optim_loss: 310762.2325
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9425; val_auprc_score: 0.9637; val_best_acc_score: 0.9548; val_best_f1_score: 0.9696; train_kl_reg_loss: 6760.7122; train_edge_recon_loss: 141559.2241; train_cond_contrastive_loss: 79830.8037; train_gene_expr_recon_loss: 81617.6087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 309768.3477; train_optim_loss: 309768.3477; val_kl_reg_loss: 6589.9775; val_edge_recon_loss: 143318.0812; val_cond_contrastive_loss: 79459.3522; val_gene_expr_recon_loss: 81801.6566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 311169.0687; val_optim_loss: 311169.0687
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9425; val_auprc_score: 0.9638; val_best_acc_score: 0.9552; val_best_f1_score: 0.9699; train_kl_reg_loss: 6779.2492; train_edge_recon_loss: 141751.5139; train_cond_contrastive_loss: 79827.2139; train_gene_expr_recon_loss: 81428.5991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 309786.5767; train_optim_loss: 309786.5767; val_kl_reg_loss: 6699.8386; val_edge_recon_loss: 142901.5231; val_cond_contrastive_loss: 79394.2791; val_gene_expr_recon_loss: 81745.0369; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 310740.6825; val_optim_loss: 310740.6825

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9412; val_auprc_score: 0.9634; val_best_acc_score: 0.9548; val_best_f1_score: 0.9697; train_kl_reg_loss: 6763.0931; train_edge_recon_loss: 141536.5734; train_cond_contrastive_loss: 79818.4302; train_gene_expr_recon_loss: 80975.4680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 309093.5643; train_optim_loss: 309093.5643; val_kl_reg_loss: 6628.7075; val_edge_recon_loss: 142376.3125; val_cond_contrastive_loss: 79456.2088; val_gene_expr_recon_loss: 81546.3581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 310007.5850; val_optim_loss: 310007.5850
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9403; val_auprc_score: 0.9624; val_best_acc_score: 0.9546; val_best_f1_score: 0.9695; train_kl_reg_loss: 6758.8318; train_edge_recon_loss: 141552.1368; train_cond_contrastive_loss: 79843.1462; train_gene_expr_recon_loss: 80926.4463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 309080.5624; train_optim_loss: 309080.5624; val_kl_reg_loss: 6622.9601; val_edge_recon_loss: 142942.2613; val_cond_contrastive_loss: 79447.8169; val_gene_expr_recon_loss: 81386.2787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 310399.3162; val_optim_loss: 310399.3162
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9422; val_auprc_score: 0.9637; val_best_acc_score: 0.9549; val_best_f1_score: 0.9697; train_kl_reg_loss: 6808.1561; train_edge_recon_loss: 141602.7975; train_cond_contrastive_loss: 79941.5081; train_gene_expr_recon_loss: 80901.3826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 309253.8458; train_optim_loss: 309253.8458; val_kl_reg_loss: 6378.3039; val_edge_recon_loss: 142698.0894; val_cond_contrastive_loss: 79479.2534; val_gene_expr_recon_loss: 81288.7291; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 309844.3800; val_optim_loss: 309844.3800
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9424; val_auprc_score: 0.9635; val_best_acc_score: 0.9556; val_best_f1_score: 0.9701; train_kl_reg_loss: 6711.0251; train_edge_recon_loss: 141663.8918; train_cond_contrastive_loss: 79866.2098; train_gene_expr_recon_loss: 80856.5009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 309097.6274; train_optim_loss: 309097.6274; val_kl_reg_loss: 6399.8850; val_edge_recon_loss: 142774.3406; val_cond_contrastive_loss: 79502.1209; val_gene_expr_recon_loss: 81391.5116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 310067.8575; val_optim_loss: 310067.8575
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9415; val_auprc_score: 0.9626; val_best_acc_score: 0.9555; val_best_f1_score: 0.9701; train_kl_reg_loss: 6674.3102; train_edge_recon_loss: 141425.9523; train_cond_contrastive_loss: 79848.8272; train_gene_expr_recon_loss: 80832.8175; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 308781.9071; train_optim_loss: 308781.9071; val_kl_reg_loss: 6446.4485; val_edge_recon_loss: 142971.7013; val_cond_contrastive_loss: 79474.0075; val_gene_expr_recon_loss: 81240.2781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 310132.4325; val_optim_loss: 310132.4325
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9414; val_auprc_score: 0.9628; val_best_acc_score: 0.9557; val_best_f1_score: 0.9702; train_kl_reg_loss: 6668.6420; train_edge_recon_loss: 141719.5772; train_cond_contrastive_loss: 79843.1684; train_gene_expr_recon_loss: 80795.6152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 309027.0035; train_optim_loss: 309027.0035; val_kl_reg_loss: 6375.8793; val_edge_recon_loss: 142858.2950; val_cond_contrastive_loss: 79513.0691; val_gene_expr_recon_loss: 81274.4594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 310021.7012; val_optim_loss: 310021.7012

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9408; val_auprc_score: 0.9624; val_best_acc_score: 0.9551; val_best_f1_score: 0.9698; train_kl_reg_loss: 6643.3114; train_edge_recon_loss: 141722.3851; train_cond_contrastive_loss: 79836.9517; train_gene_expr_recon_loss: 80733.6133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 308936.2620; train_optim_loss: 308936.2620; val_kl_reg_loss: 6441.5206; val_edge_recon_loss: 142893.1525; val_cond_contrastive_loss: 79454.0975; val_gene_expr_recon_loss: 81214.0844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 310002.8550; val_optim_loss: 310002.8550
