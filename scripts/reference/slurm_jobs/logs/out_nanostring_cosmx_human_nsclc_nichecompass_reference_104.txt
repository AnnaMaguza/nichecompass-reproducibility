[True, False, True]
Run timestamp: 30092023_031623_104.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_104']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 487746
Number of validation nodes: 54194
Number of training edges: 1154331
Number of validation edges: 128258
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8956; val_auprc_score: 0.9768; val_best_acc_score: 0.9073; val_best_f1_score: 0.9473; train_kl_reg_loss: 16614.8211; train_edge_recon_loss: 827530.4108; train_cat_covariates_contrastive_loss: 951171.5173; train_gene_expr_recon_loss: 2717010.8539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4512327.6057; train_optim_loss: 4512327.6057; val_kl_reg_loss: 18852.8277; val_edge_recon_loss: 828449.9679; val_cat_covariates_contrastive_loss: 951587.8145; val_gene_expr_recon_loss: 2384611.6833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4183502.2849; val_optim_loss: 4183502.2849
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9128; val_auprc_score: 0.9800; val_best_acc_score: 0.9233; val_best_f1_score: 0.9562; train_kl_reg_loss: 20575.3323; train_edge_recon_loss: 794700.6835; train_cat_covariates_contrastive_loss: 951593.3158; train_gene_expr_recon_loss: 2224311.0257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3991180.3557; train_optim_loss: 3991180.3557; val_kl_reg_loss: 22030.8922; val_edge_recon_loss: 817056.1780; val_cat_covariates_contrastive_loss: 950867.9420; val_gene_expr_recon_loss: 2107994.1170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3897949.1355; val_optim_loss: 3897949.1355
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9115; val_auprc_score: 0.9794; val_best_acc_score: 0.9190; val_best_f1_score: 0.9537; train_kl_reg_loss: 22534.3965; train_edge_recon_loss: 789145.9481; train_cat_covariates_contrastive_loss: 951775.8754; train_gene_expr_recon_loss: 2060996.3642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3824452.5857; train_optim_loss: 3824452.5857; val_kl_reg_loss: 23787.4143; val_edge_recon_loss: 819422.7226; val_cat_covariates_contrastive_loss: 949922.7418; val_gene_expr_recon_loss: 2024558.9716; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3817691.8456; val_optim_loss: 3817691.8456
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9205; val_auprc_score: 0.9819; val_best_acc_score: 0.9227; val_best_f1_score: 0.9558; train_kl_reg_loss: 23421.4190; train_edge_recon_loss: 789427.2060; train_cat_covariates_contrastive_loss: 951680.0930; train_gene_expr_recon_loss: 2001871.3543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3766400.0711; train_optim_loss: 3766400.0711; val_kl_reg_loss: 23411.2830; val_edge_recon_loss: 814154.4156; val_cat_covariates_contrastive_loss: 951662.7791; val_gene_expr_recon_loss: 1985784.8969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3775013.3725; val_optim_loss: 3775013.3725
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9289; val_auprc_score: 0.9843; val_best_acc_score: 0.9260; val_best_f1_score: 0.9576; train_kl_reg_loss: 23824.8283; train_edge_recon_loss: 786994.6652; train_cat_covariates_contrastive_loss: 951581.0970; train_gene_expr_recon_loss: 1969649.2767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3732049.8671; train_optim_loss: 3732049.8671; val_kl_reg_loss: 22828.5540; val_edge_recon_loss: 811920.0291; val_cat_covariates_contrastive_loss: 954858.6365; val_gene_expr_recon_loss: 1955371.2410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3744978.4572; val_optim_loss: 3744978.4572
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9236; val_auprc_score: 0.9825; val_best_acc_score: 0.9240; val_best_f1_score: 0.9566; train_kl_reg_loss: 24170.9079; train_edge_recon_loss: 786060.9020; train_cat_covariates_contrastive_loss: 951634.4945; train_gene_expr_recon_loss: 1950233.7417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3712100.0457; train_optim_loss: 3712100.0457; val_kl_reg_loss: 23415.2919; val_edge_recon_loss: 811281.4649; val_cat_covariates_contrastive_loss: 952540.9878; val_gene_expr_recon_loss: 1945683.1190; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3732920.8596; val_optim_loss: 3732920.8596
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9248; val_auprc_score: 0.9825; val_best_acc_score: 0.9302; val_best_f1_score: 0.9601; train_kl_reg_loss: 24498.2182; train_edge_recon_loss: 788692.7897; train_cat_covariates_contrastive_loss: 951704.7342; train_gene_expr_recon_loss: 1934749.7892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3699645.5320; train_optim_loss: 3699645.5320; val_kl_reg_loss: 24600.9329; val_edge_recon_loss: 808985.2908; val_cat_covariates_contrastive_loss: 951370.8384; val_gene_expr_recon_loss: 1928926.7938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3713883.8516; val_optim_loss: 3713883.8516
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9249; val_auprc_score: 0.9827; val_best_acc_score: 0.9274; val_best_f1_score: 0.9584; train_kl_reg_loss: 24746.1289; train_edge_recon_loss: 783236.7062; train_cat_covariates_contrastive_loss: 951699.9930; train_gene_expr_recon_loss: 1920558.4535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3680241.2808; train_optim_loss: 3680241.2808; val_kl_reg_loss: 24912.5653; val_edge_recon_loss: 810080.5336; val_cat_covariates_contrastive_loss: 950866.3240; val_gene_expr_recon_loss: 1923197.9512; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3709057.3685; val_optim_loss: 3709057.3685
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9157; val_auprc_score: 0.9797; val_best_acc_score: 0.9240; val_best_f1_score: 0.9564; train_kl_reg_loss: 24974.7398; train_edge_recon_loss: 787497.5300; train_cat_covariates_contrastive_loss: 951906.2662; train_gene_expr_recon_loss: 1909904.9289; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3674283.4659; train_optim_loss: 3674283.4659; val_kl_reg_loss: 26980.2071; val_edge_recon_loss: 818047.8187; val_cat_covariates_contrastive_loss: 948784.8372; val_gene_expr_recon_loss: 1904653.9751; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3698466.8347; val_optim_loss: 3698466.8347
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9283; val_auprc_score: 0.9832; val_best_acc_score: 0.9305; val_best_f1_score: 0.9602; train_kl_reg_loss: 25230.0293; train_edge_recon_loss: 786360.8944; train_cat_covariates_contrastive_loss: 951931.6322; train_gene_expr_recon_loss: 1901574.4185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3665096.9757; train_optim_loss: 3665096.9757; val_kl_reg_loss: 25064.2612; val_edge_recon_loss: 817836.2809; val_cat_covariates_contrastive_loss: 951297.3683; val_gene_expr_recon_loss: 1896675.4457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3690873.3616; val_optim_loss: 3690873.3616
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9301; val_auprc_score: 0.9839; val_best_acc_score: 0.9306; val_best_f1_score: 0.9603; train_kl_reg_loss: 25478.9833; train_edge_recon_loss: 787287.3345; train_cat_covariates_contrastive_loss: 951963.4523; train_gene_expr_recon_loss: 1891765.5319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3656495.3025; train_optim_loss: 3656495.3025; val_kl_reg_loss: 26518.5193; val_edge_recon_loss: 809021.6484; val_cat_covariates_contrastive_loss: 950830.6305; val_gene_expr_recon_loss: 1888865.3621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3675236.1653; val_optim_loss: 3675236.1653
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9295; val_auprc_score: 0.9834; val_best_acc_score: 0.9297; val_best_f1_score: 0.9597; train_kl_reg_loss: 25692.1672; train_edge_recon_loss: 787058.0270; train_cat_covariates_contrastive_loss: 951899.3646; train_gene_expr_recon_loss: 1882098.6033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3646748.1630; train_optim_loss: 3646748.1630; val_kl_reg_loss: 24930.3592; val_edge_recon_loss: 812466.7184; val_cat_covariates_contrastive_loss: 952192.8977; val_gene_expr_recon_loss: 1879941.0812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3669531.0588; val_optim_loss: 3669531.0588
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9258; val_auprc_score: 0.9823; val_best_acc_score: 0.9295; val_best_f1_score: 0.9597; train_kl_reg_loss: 25868.9937; train_edge_recon_loss: 785911.5302; train_cat_covariates_contrastive_loss: 951910.8065; train_gene_expr_recon_loss: 1877396.6145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3641087.9438; train_optim_loss: 3641087.9438; val_kl_reg_loss: 26381.1001; val_edge_recon_loss: 805545.7014; val_cat_covariates_contrastive_loss: 951114.5229; val_gene_expr_recon_loss: 1878162.8167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3661204.1365; val_optim_loss: 3661204.1365
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9249; val_auprc_score: 0.9823; val_best_acc_score: 0.9296; val_best_f1_score: 0.9596; train_kl_reg_loss: 26028.4804; train_edge_recon_loss: 784630.5380; train_cat_covariates_contrastive_loss: 952099.7113; train_gene_expr_recon_loss: 1872034.1136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3634792.8414; train_optim_loss: 3634792.8414; val_kl_reg_loss: 26927.9730; val_edge_recon_loss: 812606.6382; val_cat_covariates_contrastive_loss: 950779.2537; val_gene_expr_recon_loss: 1875108.5319; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3665422.3934; val_optim_loss: 3665422.3934
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9366; val_auprc_score: 0.9858; val_best_acc_score: 0.9327; val_best_f1_score: 0.9614; train_kl_reg_loss: 26099.3723; train_edge_recon_loss: 783835.5794; train_cat_covariates_contrastive_loss: 952115.8793; train_gene_expr_recon_loss: 1865726.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3627777.1244; train_optim_loss: 3627777.1244; val_kl_reg_loss: 25170.1333; val_edge_recon_loss: 808484.9400; val_cat_covariates_contrastive_loss: 955692.7368; val_gene_expr_recon_loss: 1871335.0881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3660682.8964; val_optim_loss: 3660682.8964
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9292; val_auprc_score: 0.9835; val_best_acc_score: 0.9293; val_best_f1_score: 0.9594; train_kl_reg_loss: 26339.4621; train_edge_recon_loss: 784137.7667; train_cat_covariates_contrastive_loss: 952033.9855; train_gene_expr_recon_loss: 1862023.1192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3624534.3334; train_optim_loss: 3624534.3334; val_kl_reg_loss: 26341.3613; val_edge_recon_loss: 815030.3757; val_cat_covariates_contrastive_loss: 951573.3108; val_gene_expr_recon_loss: 1861665.2306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3654610.2869; val_optim_loss: 3654610.2869
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9266; val_auprc_score: 0.9833; val_best_acc_score: 0.9271; val_best_f1_score: 0.9583; train_kl_reg_loss: 26425.0856; train_edge_recon_loss: 783078.9470; train_cat_covariates_contrastive_loss: 952159.1390; train_gene_expr_recon_loss: 1858953.8011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3620616.9729; train_optim_loss: 3620616.9729; val_kl_reg_loss: 26230.2531; val_edge_recon_loss: 804328.8215; val_cat_covariates_contrastive_loss: 952567.4278; val_gene_expr_recon_loss: 1857894.2435; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3641020.7400; val_optim_loss: 3641020.7400
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9271; val_auprc_score: 0.9832; val_best_acc_score: 0.9299; val_best_f1_score: 0.9599; train_kl_reg_loss: 26418.3242; train_edge_recon_loss: 784169.4275; train_cat_covariates_contrastive_loss: 952096.2152; train_gene_expr_recon_loss: 1854083.5607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3616767.5275; train_optim_loss: 3616767.5275; val_kl_reg_loss: 26752.8658; val_edge_recon_loss: 797944.1631; val_cat_covariates_contrastive_loss: 950731.6691; val_gene_expr_recon_loss: 1852923.8576; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3628352.5578; val_optim_loss: 3628352.5578
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9323; val_auprc_score: 0.9843; val_best_acc_score: 0.9334; val_best_f1_score: 0.9619; train_kl_reg_loss: 26543.6340; train_edge_recon_loss: 784568.8165; train_cat_covariates_contrastive_loss: 952089.1683; train_gene_expr_recon_loss: 1853796.3517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3616997.9704; train_optim_loss: 3616997.9704; val_kl_reg_loss: 26821.4924; val_edge_recon_loss: 805323.1643; val_cat_covariates_contrastive_loss: 951786.0139; val_gene_expr_recon_loss: 1858881.8202; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3642812.4861; val_optim_loss: 3642812.4861
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9374; val_auprc_score: 0.9861; val_best_acc_score: 0.9318; val_best_f1_score: 0.9609; train_kl_reg_loss: 26622.5388; train_edge_recon_loss: 785114.6295; train_cat_covariates_contrastive_loss: 952304.0726; train_gene_expr_recon_loss: 1851210.2285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3615251.4686; train_optim_loss: 3615251.4686; val_kl_reg_loss: 25241.7451; val_edge_recon_loss: 812393.3551; val_cat_covariates_contrastive_loss: 959226.3090; val_gene_expr_recon_loss: 1860903.0184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3657764.4213; val_optim_loss: 3657764.4213
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9279; val_auprc_score: 0.9826; val_best_acc_score: 0.9313; val_best_f1_score: 0.9606; train_kl_reg_loss: 26888.7171; train_edge_recon_loss: 784278.4937; train_cat_covariates_contrastive_loss: 952305.8843; train_gene_expr_recon_loss: 1846844.6226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3610317.7196; train_optim_loss: 3610317.7196; val_kl_reg_loss: 26762.3102; val_edge_recon_loss: 815017.8728; val_cat_covariates_contrastive_loss: 950352.1394; val_gene_expr_recon_loss: 1845706.2595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3637838.5857; val_optim_loss: 3637838.5857
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9265; val_auprc_score: 0.9826; val_best_acc_score: 0.9323; val_best_f1_score: 0.9614; train_kl_reg_loss: 26908.2826; train_edge_recon_loss: 785153.1593; train_cat_covariates_contrastive_loss: 952323.2329; train_gene_expr_recon_loss: 1847760.1078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3612144.7810; train_optim_loss: 3612144.7810; val_kl_reg_loss: 27534.2658; val_edge_recon_loss: 807452.1651; val_cat_covariates_contrastive_loss: 951043.3807; val_gene_expr_recon_loss: 1876108.8526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3662138.6594; val_optim_loss: 3662138.6594

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9347; val_auprc_score: 0.9848; val_best_acc_score: 0.9341; val_best_f1_score: 0.9621; train_kl_reg_loss: 26801.0650; train_edge_recon_loss: 782672.8600; train_cat_covariates_contrastive_loss: 952140.4354; train_gene_expr_recon_loss: 1813225.5079; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3574839.8690; train_optim_loss: 3574839.8690; val_kl_reg_loss: 27164.0042; val_edge_recon_loss: 805462.5125; val_cat_covariates_contrastive_loss: 951563.7159; val_gene_expr_recon_loss: 1816320.9168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3600511.1454; val_optim_loss: 3600511.1454
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9307; val_auprc_score: 0.9837; val_best_acc_score: 0.9314; val_best_f1_score: 0.9606; train_kl_reg_loss: 26752.4785; train_edge_recon_loss: 778028.3531; train_cat_covariates_contrastive_loss: 952134.9310; train_gene_expr_recon_loss: 1806846.2108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3563761.9768; train_optim_loss: 3563761.9768; val_kl_reg_loss: 26717.0056; val_edge_recon_loss: 809430.2896; val_cat_covariates_contrastive_loss: 951844.8713; val_gene_expr_recon_loss: 1814604.3680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3602596.5448; val_optim_loss: 3602596.5448
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9364; val_auprc_score: 0.9852; val_best_acc_score: 0.9338; val_best_f1_score: 0.9620; train_kl_reg_loss: 26384.7203; train_edge_recon_loss: 782395.2417; train_cat_covariates_contrastive_loss: 951883.4299; train_gene_expr_recon_loss: 1803816.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3564480.1939; train_optim_loss: 3564480.1939; val_kl_reg_loss: 26230.2049; val_edge_recon_loss: 800176.3155; val_cat_covariates_contrastive_loss: 952146.1272; val_gene_expr_recon_loss: 1812214.2440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3590766.8944; val_optim_loss: 3590766.8944
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9339; val_auprc_score: 0.9844; val_best_acc_score: 0.9341; val_best_f1_score: 0.9622; train_kl_reg_loss: 27145.6680; train_edge_recon_loss: 784984.0626; train_cat_covariates_contrastive_loss: 952630.5851; train_gene_expr_recon_loss: 1800205.3728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3564965.6864; train_optim_loss: 3564965.6864; val_kl_reg_loss: 23543.3483; val_edge_recon_loss: 800549.8952; val_cat_covariates_contrastive_loss: 951853.6275; val_gene_expr_recon_loss: 1807472.6713; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3583419.5408; val_optim_loss: 3583419.5408
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9342; val_auprc_score: 0.9845; val_best_acc_score: 0.9348; val_best_f1_score: 0.9627; train_kl_reg_loss: 26484.0594; train_edge_recon_loss: 785116.9772; train_cat_covariates_contrastive_loss: 952255.9593; train_gene_expr_recon_loss: 1798832.5509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3562689.5459; train_optim_loss: 3562689.5459; val_kl_reg_loss: 23794.2497; val_edge_recon_loss: 804412.2791; val_cat_covariates_contrastive_loss: 952156.6001; val_gene_expr_recon_loss: 1805746.6902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3586109.8207; val_optim_loss: 3586109.8207
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9302; val_auprc_score: 0.9835; val_best_acc_score: 0.9336; val_best_f1_score: 0.9618; train_kl_reg_loss: 25757.3884; train_edge_recon_loss: 782380.8563; train_cat_covariates_contrastive_loss: 951780.4333; train_gene_expr_recon_loss: 1797480.1609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3557398.8379; train_optim_loss: 3557398.8379; val_kl_reg_loss: 24077.7184; val_edge_recon_loss: 806567.7739; val_cat_covariates_contrastive_loss: 951113.5951; val_gene_expr_recon_loss: 1806023.8476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3587782.9333; val_optim_loss: 3587782.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9297; val_auprc_score: 0.9834; val_best_acc_score: 0.9314; val_best_f1_score: 0.9607; train_kl_reg_loss: 25302.3177; train_edge_recon_loss: 783427.9688; train_cat_covariates_contrastive_loss: 951549.0736; train_gene_expr_recon_loss: 1796283.4088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3556562.7662; train_optim_loss: 3556562.7662; val_kl_reg_loss: 24331.7947; val_edge_recon_loss: 801081.1922; val_cat_covariates_contrastive_loss: 950583.5296; val_gene_expr_recon_loss: 1806157.5090; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3582154.0159; val_optim_loss: 3582154.0159
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9349; val_auprc_score: 0.9849; val_best_acc_score: 0.9344; val_best_f1_score: 0.9624; train_kl_reg_loss: 24986.5166; train_edge_recon_loss: 782790.2747; train_cat_covariates_contrastive_loss: 951490.9697; train_gene_expr_recon_loss: 1795498.8117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3554766.5723; train_optim_loss: 3554766.5723; val_kl_reg_loss: 23897.3079; val_edge_recon_loss: 802755.8852; val_cat_covariates_contrastive_loss: 952102.3352; val_gene_expr_recon_loss: 1803589.0040; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3582344.5239; val_optim_loss: 3582344.5239
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9359; val_auprc_score: 0.9850; val_best_acc_score: 0.9347; val_best_f1_score: 0.9625; train_kl_reg_loss: 24973.7789; train_edge_recon_loss: 782786.5527; train_cat_covariates_contrastive_loss: 951545.7788; train_gene_expr_recon_loss: 1794885.3732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3554191.4844; train_optim_loss: 3554191.4844; val_kl_reg_loss: 23898.5085; val_edge_recon_loss: 804783.3752; val_cat_covariates_contrastive_loss: 951763.4355; val_gene_expr_recon_loss: 1803067.8476; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3583513.1604; val_optim_loss: 3583513.1604
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9374; val_auprc_score: 0.9854; val_best_acc_score: 0.9347; val_best_f1_score: 0.9625; train_kl_reg_loss: 24618.3132; train_edge_recon_loss: 780303.7336; train_cat_covariates_contrastive_loss: 951084.7837; train_gene_expr_recon_loss: 1794543.4979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3550550.3266; train_optim_loss: 3550550.3266; val_kl_reg_loss: 23849.1205; val_edge_recon_loss: 806226.7951; val_cat_covariates_contrastive_loss: 952033.0266; val_gene_expr_recon_loss: 1804253.5558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3586362.4990; val_optim_loss: 3586362.4990
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9362; val_auprc_score: 0.9851; val_best_acc_score: 0.9337; val_best_f1_score: 0.9620; train_kl_reg_loss: 24531.8669; train_edge_recon_loss: 783089.1619; train_cat_covariates_contrastive_loss: 951019.1060; train_gene_expr_recon_loss: 1794325.9528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3552966.0869; train_optim_loss: 3552966.0869; val_kl_reg_loss: 24016.5465; val_edge_recon_loss: 799826.2971; val_cat_covariates_contrastive_loss: 951297.7891; val_gene_expr_recon_loss: 1802161.0060; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3577301.6474; val_optim_loss: 3577301.6474
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9334; val_auprc_score: 0.9839; val_best_acc_score: 0.9336; val_best_f1_score: 0.9618; train_kl_reg_loss: 24386.9985; train_edge_recon_loss: 779961.6255; train_cat_covariates_contrastive_loss: 951078.5608; train_gene_expr_recon_loss: 1793257.5626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3548684.7480; train_optim_loss: 3548684.7480; val_kl_reg_loss: 24386.0923; val_edge_recon_loss: 814461.0122; val_cat_covariates_contrastive_loss: 950166.3762; val_gene_expr_recon_loss: 1801997.9721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3591011.4462; val_optim_loss: 3591011.4462
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9366; val_auprc_score: 0.9856; val_best_acc_score: 0.9349; val_best_f1_score: 0.9627; train_kl_reg_loss: 24345.1842; train_edge_recon_loss: 783181.4574; train_cat_covariates_contrastive_loss: 951056.5976; train_gene_expr_recon_loss: 1793121.8962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3551705.1364; train_optim_loss: 3551705.1364; val_kl_reg_loss: 23600.5092; val_edge_recon_loss: 798871.7131; val_cat_covariates_contrastive_loss: 952064.2007; val_gene_expr_recon_loss: 1801579.0259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3576115.4522; val_optim_loss: 3576115.4522
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9345; val_auprc_score: 0.9844; val_best_acc_score: 0.9331; val_best_f1_score: 0.9615; train_kl_reg_loss: 24251.4579; train_edge_recon_loss: 778390.6656; train_cat_covariates_contrastive_loss: 950888.0970; train_gene_expr_recon_loss: 1792166.8636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3545697.0839; train_optim_loss: 3545697.0839; val_kl_reg_loss: 24439.4682; val_edge_recon_loss: 809590.7149; val_cat_covariates_contrastive_loss: 949764.7498; val_gene_expr_recon_loss: 1799392.2908; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3583187.2221; val_optim_loss: 3583187.2221
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9361; val_auprc_score: 0.9852; val_best_acc_score: 0.9338; val_best_f1_score: 0.9621; train_kl_reg_loss: 24134.1814; train_edge_recon_loss: 780352.3676; train_cat_covariates_contrastive_loss: 950886.1326; train_gene_expr_recon_loss: 1791925.8597; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3547298.5415; train_optim_loss: 3547298.5415; val_kl_reg_loss: 23426.9175; val_edge_recon_loss: 802585.9686; val_cat_covariates_contrastive_loss: 951609.9472; val_gene_expr_recon_loss: 1800794.6624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3578417.4851; val_optim_loss: 3578417.4851
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9353; val_auprc_score: 0.9850; val_best_acc_score: 0.9343; val_best_f1_score: 0.9623; train_kl_reg_loss: 24056.2662; train_edge_recon_loss: 781385.8561; train_cat_covariates_contrastive_loss: 950852.6435; train_gene_expr_recon_loss: 1791281.3896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3547576.1570; train_optim_loss: 3547576.1570; val_kl_reg_loss: 23778.4896; val_edge_recon_loss: 801269.3598; val_cat_covariates_contrastive_loss: 950907.2341; val_gene_expr_recon_loss: 1799158.3327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3575113.3994; val_optim_loss: 3575113.3994
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9354; val_auprc_score: 0.9848; val_best_acc_score: 0.9337; val_best_f1_score: 0.9618; train_kl_reg_loss: 23982.6753; train_edge_recon_loss: 780885.8351; train_cat_covariates_contrastive_loss: 950723.2398; train_gene_expr_recon_loss: 1790137.7151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3545729.4650; train_optim_loss: 3545729.4650; val_kl_reg_loss: 23995.4229; val_edge_recon_loss: 805089.0142; val_cat_covariates_contrastive_loss: 950364.4039; val_gene_expr_recon_loss: 1801317.9930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3580766.8297; val_optim_loss: 3580766.8297
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9333; val_auprc_score: 0.9844; val_best_acc_score: 0.9335; val_best_f1_score: 0.9618; train_kl_reg_loss: 23930.0671; train_edge_recon_loss: 780356.7632; train_cat_covariates_contrastive_loss: 950734.3750; train_gene_expr_recon_loss: 1790409.4222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3545430.6265; train_optim_loss: 3545430.6265; val_kl_reg_loss: 24321.5756; val_edge_recon_loss: 793549.6738; val_cat_covariates_contrastive_loss: 949392.0299; val_gene_expr_recon_loss: 1799510.6688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3566773.9502; val_optim_loss: 3566773.9502
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9373; val_auprc_score: 0.9854; val_best_acc_score: 0.9349; val_best_f1_score: 0.9627; train_kl_reg_loss: 23829.7840; train_edge_recon_loss: 780467.0591; train_cat_covariates_contrastive_loss: 950540.9901; train_gene_expr_recon_loss: 1790139.0697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3544976.9032; train_optim_loss: 3544976.9032; val_kl_reg_loss: 23754.0833; val_edge_recon_loss: 801496.3578; val_cat_covariates_contrastive_loss: 950429.6215; val_gene_expr_recon_loss: 1799900.3466; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3575580.4143; val_optim_loss: 3575580.4143
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9353; val_auprc_score: 0.9848; val_best_acc_score: 0.9343; val_best_f1_score: 0.9623; train_kl_reg_loss: 23775.8533; train_edge_recon_loss: 779761.6634; train_cat_covariates_contrastive_loss: 950630.5912; train_gene_expr_recon_loss: 1789466.7000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3543634.8079; train_optim_loss: 3543634.8079; val_kl_reg_loss: 23334.9124; val_edge_recon_loss: 802192.2649; val_cat_covariates_contrastive_loss: 950514.8118; val_gene_expr_recon_loss: 1798951.8058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3574993.7968; val_optim_loss: 3574993.7968
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9354; val_auprc_score: 0.9848; val_best_acc_score: 0.9342; val_best_f1_score: 0.9622; train_kl_reg_loss: 23650.2935; train_edge_recon_loss: 781148.4926; train_cat_covariates_contrastive_loss: 950436.1997; train_gene_expr_recon_loss: 1789641.5548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3544876.5391; train_optim_loss: 3544876.5391; val_kl_reg_loss: 23480.1312; val_edge_recon_loss: 805345.2983; val_cat_covariates_contrastive_loss: 950229.1292; val_gene_expr_recon_loss: 1799574.7117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3578629.2689; val_optim_loss: 3578629.2689
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9358; val_auprc_score: 0.9849; val_best_acc_score: 0.9352; val_best_f1_score: 0.9627; train_kl_reg_loss: 23617.6923; train_edge_recon_loss: 780651.1309; train_cat_covariates_contrastive_loss: 950355.2091; train_gene_expr_recon_loss: 1788307.4298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3542931.4589; train_optim_loss: 3542931.4589; val_kl_reg_loss: 23194.3423; val_edge_recon_loss: 801210.2582; val_cat_covariates_contrastive_loss: 950878.2410; val_gene_expr_recon_loss: 1797687.1404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3572969.9811; val_optim_loss: 3572969.9811

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9366; val_auprc_score: 0.9850; val_best_acc_score: 0.9347; val_best_f1_score: 0.9625; train_kl_reg_loss: 23519.8378; train_edge_recon_loss: 780538.6213; train_cat_covariates_contrastive_loss: 950443.3750; train_gene_expr_recon_loss: 1785296.4390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3539798.2761; train_optim_loss: 3539798.2761; val_kl_reg_loss: 23261.7378; val_edge_recon_loss: 807507.2794; val_cat_covariates_contrastive_loss: 950330.4798; val_gene_expr_recon_loss: 1795657.9771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3576757.4711; val_optim_loss: 3576757.4711
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9344; val_auprc_score: 0.9844; val_best_acc_score: 0.9342; val_best_f1_score: 0.9622; train_kl_reg_loss: 23508.8762; train_edge_recon_loss: 780209.2306; train_cat_covariates_contrastive_loss: 950404.6912; train_gene_expr_recon_loss: 1784257.2015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3538380.0019; train_optim_loss: 3538380.0019; val_kl_reg_loss: 23369.5206; val_edge_recon_loss: 807000.9280; val_cat_covariates_contrastive_loss: 950065.1666; val_gene_expr_recon_loss: 1795757.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3576192.8904; val_optim_loss: 3576192.8904
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9367; val_auprc_score: 0.9850; val_best_acc_score: 0.9346; val_best_f1_score: 0.9625; train_kl_reg_loss: 23543.5098; train_edge_recon_loss: 780348.0450; train_cat_covariates_contrastive_loss: 950353.6316; train_gene_expr_recon_loss: 1784308.9302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3538554.1160; train_optim_loss: 3538554.1160; val_kl_reg_loss: 23138.3491; val_edge_recon_loss: 803539.2301; val_cat_covariates_contrastive_loss: 950607.4589; val_gene_expr_recon_loss: 1795099.2221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3572384.2440; val_optim_loss: 3572384.2440
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9355; val_auprc_score: 0.9847; val_best_acc_score: 0.9337; val_best_f1_score: 0.9620; train_kl_reg_loss: 23512.7903; train_edge_recon_loss: 781404.5312; train_cat_covariates_contrastive_loss: 950357.9660; train_gene_expr_recon_loss: 1784043.8247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3539319.1113; train_optim_loss: 3539319.1113; val_kl_reg_loss: 23226.8739; val_edge_recon_loss: 805458.4470; val_cat_covariates_contrastive_loss: 950396.2968; val_gene_expr_recon_loss: 1793506.7983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3572588.4114; val_optim_loss: 3572588.4114

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 539 min 10 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9078
val AUPRC score: 0.9726
val best accuracy score: 0.9295
val best F1 score: 0.9594
val target rna MSE score: 0.3777
val source rna MSE score: 0.1146
Val cat covariate0 mean sim diff: 0.0003
Val cat covariate1 mean sim diff: -0.0672
Val cat covariate2 mean sim diff: -0.0003

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
