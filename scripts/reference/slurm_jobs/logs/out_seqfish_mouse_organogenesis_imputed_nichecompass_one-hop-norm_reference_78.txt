[True]
Run timestamp: 01082023_092624_78.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_78']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8967; val_auprc_score: 0.9802; val_best_acc_score: 0.8566; val_best_f1_score: 0.9223; train_kl_reg_loss: 58675.0780; train_edge_recon_loss: 1038680.9711; train_gene_expr_recon_loss: 514186.1395; train_masked_gp_l1_reg_loss: 11397.2928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113822.9356; train_global_loss: 1736762.4097; train_optim_loss: 1736762.4097; val_kl_reg_loss: 49232.3581; val_edge_recon_loss: 1204874.5208; val_gene_expr_recon_loss: 435369.1719; val_masked_gp_l1_reg_loss: 10999.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100529.8906; val_global_loss: 1801005.2083; val_optim_loss: 1801005.2083
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8819; val_auprc_score: 0.9765; val_best_acc_score: 0.8526; val_best_f1_score: 0.9198; train_kl_reg_loss: 43989.6428; train_edge_recon_loss: 1038901.6343; train_gene_expr_recon_loss: 385440.1568; train_masked_gp_l1_reg_loss: 10589.1227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89839.9282; train_global_loss: 1568760.4861; train_optim_loss: 1568760.4861; val_kl_reg_loss: 32518.6517; val_edge_recon_loss: 1253451.5625; val_gene_expr_recon_loss: 309324.7396; val_masked_gp_l1_reg_loss: 10182.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79693.8750; val_global_loss: 1685171.4583; val_optim_loss: 1685171.4583
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8813; val_auprc_score: 0.9772; val_best_acc_score: 0.8654; val_best_f1_score: 0.9268; train_kl_reg_loss: 28241.6797; train_edge_recon_loss: 1037504.3322; train_gene_expr_recon_loss: 281178.6209; train_masked_gp_l1_reg_loss: 9737.4130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70419.1795; train_global_loss: 1427081.2083; train_optim_loss: 1427081.2083; val_kl_reg_loss: 20679.4043; val_edge_recon_loss: 1192826.4167; val_gene_expr_recon_loss: 266255.1667; val_masked_gp_l1_reg_loss: 9337.1572; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60913.2812; val_global_loss: 1550011.3958; val_optim_loss: 1550011.3958
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8786; val_auprc_score: 0.9765; val_best_acc_score: 0.8690; val_best_f1_score: 0.9282; train_kl_reg_loss: 18041.2527; train_edge_recon_loss: 1035607.4074; train_gene_expr_recon_loss: 261004.6808; train_masked_gp_l1_reg_loss: 9082.5185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52711.8998; train_global_loss: 1376447.7500; train_optim_loss: 1376447.7500; val_kl_reg_loss: 14886.4339; val_edge_recon_loss: 1202615.2500; val_gene_expr_recon_loss: 255969.9688; val_masked_gp_l1_reg_loss: 8842.8223; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44908.8203; val_global_loss: 1527223.4167; val_optim_loss: 1527223.4167
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8673; val_auprc_score: 0.9742; val_best_acc_score: 0.8710; val_best_f1_score: 0.9283; train_kl_reg_loss: 14166.8906; train_edge_recon_loss: 1034307.8380; train_gene_expr_recon_loss: 253488.8704; train_masked_gp_l1_reg_loss: 8663.8417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38882.0119; train_global_loss: 1349509.4352; train_optim_loss: 1349509.4352; val_kl_reg_loss: 12092.3411; val_edge_recon_loss: 1204922.5208; val_gene_expr_recon_loss: 249352.8854; val_masked_gp_l1_reg_loss: 8492.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33389.9766; val_global_loss: 1508250.2292; val_optim_loss: 1508250.2292
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8593; val_auprc_score: 0.9726; val_best_acc_score: 0.8761; val_best_f1_score: 0.9322; train_kl_reg_loss: 12392.6057; train_edge_recon_loss: 1027646.8009; train_gene_expr_recon_loss: 247137.4722; train_masked_gp_l1_reg_loss: 8345.7015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29513.7707; train_global_loss: 1325036.3449; train_optim_loss: 1325036.3449; val_kl_reg_loss: 10957.5952; val_edge_recon_loss: 1172650.6042; val_gene_expr_recon_loss: 244115.9844; val_masked_gp_l1_reg_loss: 8206.7754; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26214.6504; val_global_loss: 1462145.5417; val_optim_loss: 1462145.5417
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8431; val_auprc_score: 0.9645; val_best_acc_score: 0.8772; val_best_f1_score: 0.9319; train_kl_reg_loss: 10246.8793; train_edge_recon_loss: 1023498.2801; train_gene_expr_recon_loss: 243237.5611; train_masked_gp_l1_reg_loss: 8098.9585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23847.2924; train_global_loss: 1308928.9491; train_optim_loss: 1308928.9491; val_kl_reg_loss: 6408.9738; val_edge_recon_loss: 1084499.2083; val_gene_expr_recon_loss: 247086.6120; val_masked_gp_l1_reg_loss: 8015.0840; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21709.9219; val_global_loss: 1367719.7917; val_optim_loss: 1367719.7917
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8369; val_auprc_score: 0.9626; val_best_acc_score: 0.8869; val_best_f1_score: 0.9371; train_kl_reg_loss: 12139.7919; train_edge_recon_loss: 911855.7164; train_gene_expr_recon_loss: 252683.0608; train_masked_gp_l1_reg_loss: 8056.0256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20570.7172; train_global_loss: 1205305.3148; train_optim_loss: 1205305.3148; val_kl_reg_loss: 18278.5189; val_edge_recon_loss: 895714.1979; val_gene_expr_recon_loss: 246703.2969; val_masked_gp_l1_reg_loss: 8088.9058; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19454.6914; val_global_loss: 1188239.6458; val_optim_loss: 1188239.6458
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8496; val_auprc_score: 0.9664; val_best_acc_score: 0.8992; val_best_f1_score: 0.9435; train_kl_reg_loss: 17323.1235; train_edge_recon_loss: 870276.0231; train_gene_expr_recon_loss: 243345.9543; train_masked_gp_l1_reg_loss: 8032.6900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18358.3646; train_global_loss: 1157336.1528; train_optim_loss: 1157336.1528; val_kl_reg_loss: 15687.4855; val_edge_recon_loss: 869675.3854; val_gene_expr_recon_loss: 241491.2448; val_masked_gp_l1_reg_loss: 7951.8809; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17285.9336; val_global_loss: 1152091.8333; val_optim_loss: 1152091.8333
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8563; val_auprc_score: 0.9677; val_best_acc_score: 0.9008; val_best_f1_score: 0.9444; train_kl_reg_loss: 15798.4038; train_edge_recon_loss: 851372.1933; train_gene_expr_recon_loss: 238352.5914; train_masked_gp_l1_reg_loss: 7841.3743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16391.9716; train_global_loss: 1129756.5185; train_optim_loss: 1129756.5185; val_kl_reg_loss: 14762.3174; val_edge_recon_loss: 884180.9583; val_gene_expr_recon_loss: 238274.9948; val_masked_gp_l1_reg_loss: 7716.3081; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15550.6230; val_global_loss: 1160485.1667; val_optim_loss: 1160485.1667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8506; val_auprc_score: 0.9660; val_best_acc_score: 0.9075; val_best_f1_score: 0.9482; train_kl_reg_loss: 16093.1340; train_edge_recon_loss: 856153.4363; train_gene_expr_recon_loss: 234222.4893; train_masked_gp_l1_reg_loss: 7571.8003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14836.5119; train_global_loss: 1128877.3727; train_optim_loss: 1128877.3727; val_kl_reg_loss: 15605.9118; val_edge_recon_loss: 868088.7292; val_gene_expr_recon_loss: 232615.1276; val_masked_gp_l1_reg_loss: 7415.3408; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14154.0625; val_global_loss: 1137879.2083; val_optim_loss: 1137879.2083
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8668; val_auprc_score: 0.9693; val_best_acc_score: 0.9062; val_best_f1_score: 0.9471; train_kl_reg_loss: 14707.1510; train_edge_recon_loss: 840312.9398; train_gene_expr_recon_loss: 231489.6259; train_masked_gp_l1_reg_loss: 7256.1167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13627.7443; train_global_loss: 1107393.5718; train_optim_loss: 1107393.5718; val_kl_reg_loss: 13264.9541; val_edge_recon_loss: 860506.4167; val_gene_expr_recon_loss: 231313.1042; val_masked_gp_l1_reg_loss: 7093.9771; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13144.6797; val_global_loss: 1125323.1250; val_optim_loss: 1125323.1250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8837; val_auprc_score: 0.9738; val_best_acc_score: 0.9069; val_best_f1_score: 0.9471; train_kl_reg_loss: 13643.0648; train_edge_recon_loss: 832765.3866; train_gene_expr_recon_loss: 229187.0642; train_masked_gp_l1_reg_loss: 6926.2689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12803.9003; train_global_loss: 1095325.6840; train_optim_loss: 1095325.6840; val_kl_reg_loss: 14503.1659; val_edge_recon_loss: 831583.5938; val_gene_expr_recon_loss: 226711.9948; val_masked_gp_l1_reg_loss: 6740.9595; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 12475.4941; val_global_loss: 1092015.2292; val_optim_loss: 1092015.2292
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8958; val_auprc_score: 0.9752; val_best_acc_score: 0.9076; val_best_f1_score: 0.9472; train_kl_reg_loss: 14334.5618; train_edge_recon_loss: 824767.0602; train_gene_expr_recon_loss: 224826.0608; train_masked_gp_l1_reg_loss: 6550.8772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 12118.3785; train_global_loss: 1082596.9410; train_optim_loss: 1082596.9410; val_kl_reg_loss: 12816.4425; val_edge_recon_loss: 844074.6250; val_gene_expr_recon_loss: 223440.7318; val_masked_gp_l1_reg_loss: 6351.9116; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11746.3379; val_global_loss: 1098430.0417; val_optim_loss: 1098430.0417
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9076; val_auprc_score: 0.9789; val_best_acc_score: 0.9134; val_best_f1_score: 0.9507; train_kl_reg_loss: 12872.4197; train_edge_recon_loss: 818610.3391; train_gene_expr_recon_loss: 222046.1600; train_masked_gp_l1_reg_loss: 6155.2502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 11433.0782; train_global_loss: 1071117.2477; train_optim_loss: 1071117.2477; val_kl_reg_loss: 11632.7715; val_edge_recon_loss: 811075.3750; val_gene_expr_recon_loss: 220195.9141; val_masked_gp_l1_reg_loss: 5948.4038; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 11147.1309; val_global_loss: 1059999.5417; val_optim_loss: 1059999.5417
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9176; val_auprc_score: 0.9816; val_best_acc_score: 0.9216; val_best_f1_score: 0.9549; train_kl_reg_loss: 11946.9473; train_edge_recon_loss: 811918.7859; train_gene_expr_recon_loss: 219786.4774; train_masked_gp_l1_reg_loss: 5746.8531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10895.5635; train_global_loss: 1060294.6389; train_optim_loss: 1060294.6389; val_kl_reg_loss: 12117.4785; val_edge_recon_loss: 832795.6667; val_gene_expr_recon_loss: 218441.6068; val_masked_gp_l1_reg_loss: 5537.3369; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10650.6455; val_global_loss: 1079542.7396; val_optim_loss: 1079542.7396
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9178; val_auprc_score: 0.9803; val_best_acc_score: 0.9243; val_best_f1_score: 0.9565; train_kl_reg_loss: 12488.8149; train_edge_recon_loss: 796290.3241; train_gene_expr_recon_loss: 216566.6033; train_masked_gp_l1_reg_loss: 5340.1007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10382.8148; train_global_loss: 1041068.6574; train_optim_loss: 1041068.6574; val_kl_reg_loss: 11176.9028; val_edge_recon_loss: 820398.6771; val_gene_expr_recon_loss: 216021.4375; val_masked_gp_l1_reg_loss: 5133.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10048.3818; val_global_loss: 1062779.2083; val_optim_loss: 1062779.2083
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9281; val_auprc_score: 0.9840; val_best_acc_score: 0.9223; val_best_f1_score: 0.9552; train_kl_reg_loss: 11882.2130; train_edge_recon_loss: 804273.7292; train_gene_expr_recon_loss: 214005.5596; train_masked_gp_l1_reg_loss: 4939.2425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9756.6410; train_global_loss: 1044857.3889; train_optim_loss: 1044857.3889; val_kl_reg_loss: 11609.0042; val_edge_recon_loss: 826149.2917; val_gene_expr_recon_loss: 212058.3828; val_masked_gp_l1_reg_loss: 4736.1143; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9465.2031; val_global_loss: 1064018.0417; val_optim_loss: 1064018.0417
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9402; val_auprc_score: 0.9860; val_best_acc_score: 0.9317; val_best_f1_score: 0.9607; train_kl_reg_loss: 11508.7803; train_edge_recon_loss: 787150.7731; train_gene_expr_recon_loss: 211570.7960; train_masked_gp_l1_reg_loss: 4549.9998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9159.9413; train_global_loss: 1023940.2963; train_optim_loss: 1023940.2963; val_kl_reg_loss: 10963.2406; val_edge_recon_loss: 782188.2812; val_gene_expr_recon_loss: 210101.9818; val_masked_gp_l1_reg_loss: 4359.2607; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8859.0146; val_global_loss: 1016471.7396; val_optim_loss: 1016471.7396
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9371; val_auprc_score: 0.9855; val_best_acc_score: 0.9312; val_best_f1_score: 0.9604; train_kl_reg_loss: 10934.9113; train_edge_recon_loss: 785623.8194; train_gene_expr_recon_loss: 209335.3177; train_masked_gp_l1_reg_loss: 4186.9863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8561.1257; train_global_loss: 1018642.1562; train_optim_loss: 1018642.1562; val_kl_reg_loss: 10357.6484; val_edge_recon_loss: 799473.8958; val_gene_expr_recon_loss: 208561.2760; val_masked_gp_l1_reg_loss: 4012.0771; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8261.8574; val_global_loss: 1030666.7396; val_optim_loss: 1030666.7396
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9421; val_auprc_score: 0.9871; val_best_acc_score: 0.9307; val_best_f1_score: 0.9600; train_kl_reg_loss: 11044.1317; train_edge_recon_loss: 790279.2674; train_gene_expr_recon_loss: 207285.4786; train_masked_gp_l1_reg_loss: 3856.5509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7982.8579; train_global_loss: 1020448.2755; train_optim_loss: 1020448.2755; val_kl_reg_loss: 10916.0202; val_edge_recon_loss: 806680.4375; val_gene_expr_recon_loss: 206121.2760; val_masked_gp_l1_reg_loss: 3702.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7683.7861; val_global_loss: 1035103.9792; val_optim_loss: 1035103.9792
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9417; val_auprc_score: 0.9867; val_best_acc_score: 0.9352; val_best_f1_score: 0.9627; train_kl_reg_loss: 10906.4093; train_edge_recon_loss: 796592.5463; train_gene_expr_recon_loss: 205185.9025; train_masked_gp_l1_reg_loss: 3566.8821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7387.5643; train_global_loss: 1023639.3079; train_optim_loss: 1023639.3079; val_kl_reg_loss: 11141.9010; val_edge_recon_loss: 784389.6146; val_gene_expr_recon_loss: 203972.4453; val_masked_gp_l1_reg_loss: 3431.2083; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7092.9385; val_global_loss: 1010028.0833; val_optim_loss: 1010028.0833
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9378; val_auprc_score: 0.9857; val_best_acc_score: 0.9305; val_best_f1_score: 0.9601; train_kl_reg_loss: 10779.8528; train_edge_recon_loss: 791969.8009; train_gene_expr_recon_loss: 203146.8359; train_masked_gp_l1_reg_loss: 3309.0825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6822.7338; train_global_loss: 1016028.3056; train_optim_loss: 1016028.3056; val_kl_reg_loss: 10265.4401; val_edge_recon_loss: 791066.1354; val_gene_expr_recon_loss: 202480.3021; val_masked_gp_l1_reg_loss: 3188.2480; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6545.4062; val_global_loss: 1013545.5208; val_optim_loss: 1013545.5208
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9443; val_auprc_score: 0.9875; val_best_acc_score: 0.9327; val_best_f1_score: 0.9611; train_kl_reg_loss: 10423.1272; train_edge_recon_loss: 777410.7014; train_gene_expr_recon_loss: 201412.6947; train_masked_gp_l1_reg_loss: 3084.8991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6287.6904; train_global_loss: 998619.1204; train_optim_loss: 998619.1204; val_kl_reg_loss: 10557.5474; val_edge_recon_loss: 804430.1042; val_gene_expr_recon_loss: 201336.2005; val_masked_gp_l1_reg_loss: 2979.9963; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6038.7471; val_global_loss: 1025342.6042; val_optim_loss: 1025342.6042
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9414; val_auprc_score: 0.9865; val_best_acc_score: 0.9360; val_best_f1_score: 0.9632; train_kl_reg_loss: 10301.9880; train_edge_recon_loss: 780554.2269; train_gene_expr_recon_loss: 199734.3692; train_masked_gp_l1_reg_loss: 2887.3404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5816.7015; train_global_loss: 999294.6262; train_optim_loss: 999294.6262; val_kl_reg_loss: 10103.0150; val_edge_recon_loss: 781771.5104; val_gene_expr_recon_loss: 199766.8880; val_masked_gp_l1_reg_loss: 2802.2595; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5591.4609; val_global_loss: 1000035.0938; val_optim_loss: 1000035.0938
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9536; val_auprc_score: 0.9896; val_best_acc_score: 0.9393; val_best_f1_score: 0.9649; train_kl_reg_loss: 9971.0611; train_edge_recon_loss: 781612.5486; train_gene_expr_recon_loss: 198167.8472; train_masked_gp_l1_reg_loss: 2724.0435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5397.0966; train_global_loss: 997872.5914; train_optim_loss: 997872.5914; val_kl_reg_loss: 9418.7803; val_edge_recon_loss: 797539.3646; val_gene_expr_recon_loss: 197983.9479; val_masked_gp_l1_reg_loss: 2647.0095; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5195.0391; val_global_loss: 1012784.1354; val_optim_loss: 1012784.1354
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9506; val_auprc_score: 0.9898; val_best_acc_score: 0.9440; val_best_f1_score: 0.9679; train_kl_reg_loss: 9671.5740; train_edge_recon_loss: 775336.2118; train_gene_expr_recon_loss: 196555.6678; train_masked_gp_l1_reg_loss: 2585.8744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5018.1759; train_global_loss: 989167.5139; train_optim_loss: 989167.5139; val_kl_reg_loss: 9615.5480; val_edge_recon_loss: 750506.9271; val_gene_expr_recon_loss: 195919.9531; val_masked_gp_l1_reg_loss: 2524.5364; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4829.6929; val_global_loss: 963396.6771; val_optim_loss: 963396.6771
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9494; val_auprc_score: 0.9886; val_best_acc_score: 0.9401; val_best_f1_score: 0.9652; train_kl_reg_loss: 9681.1064; train_edge_recon_loss: 773197.8900; train_gene_expr_recon_loss: 195225.9812; train_masked_gp_l1_reg_loss: 2469.1559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4666.9385; train_global_loss: 985241.0671; train_optim_loss: 985241.0671; val_kl_reg_loss: 8924.9575; val_edge_recon_loss: 789919.2083; val_gene_expr_recon_loss: 194823.5990; val_masked_gp_l1_reg_loss: 2421.3530; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4508.0503; val_global_loss: 1000597.2083; val_optim_loss: 1000597.2083
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9495; val_auprc_score: 0.9885; val_best_acc_score: 0.9404; val_best_f1_score: 0.9656; train_kl_reg_loss: 9407.4258; train_edge_recon_loss: 783077.2755; train_gene_expr_recon_loss: 193949.4164; train_masked_gp_l1_reg_loss: 2372.1814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4355.8887; train_global_loss: 993162.1875; train_optim_loss: 993162.1875; val_kl_reg_loss: 9610.5856; val_edge_recon_loss: 797999.1875; val_gene_expr_recon_loss: 193330.1302; val_masked_gp_l1_reg_loss: 2318.8269; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4199.7168; val_global_loss: 1007458.4271; val_optim_loss: 1007458.4271
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9531; val_auprc_score: 0.9902; val_best_acc_score: 0.9437; val_best_f1_score: 0.9677; train_kl_reg_loss: 9448.6443; train_edge_recon_loss: 771831.7431; train_gene_expr_recon_loss: 192660.2471; train_masked_gp_l1_reg_loss: 2274.5712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4061.7074; train_global_loss: 980276.9236; train_optim_loss: 980276.9236; val_kl_reg_loss: 8996.7124; val_edge_recon_loss: 752606.3750; val_gene_expr_recon_loss: 191880.0365; val_masked_gp_l1_reg_loss: 2234.9028; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3929.5994; val_global_loss: 959647.6458; val_optim_loss: 959647.6458
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9540; val_auprc_score: 0.9891; val_best_acc_score: 0.9459; val_best_f1_score: 0.9687; train_kl_reg_loss: 9105.4263; train_edge_recon_loss: 780309.9988; train_gene_expr_recon_loss: 191471.9809; train_masked_gp_l1_reg_loss: 2197.7197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3809.7323; train_global_loss: 986894.8576; train_optim_loss: 986894.8576; val_kl_reg_loss: 8667.7030; val_edge_recon_loss: 792061.0833; val_gene_expr_recon_loss: 190897.6458; val_masked_gp_l1_reg_loss: 2160.3237; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3691.2593; val_global_loss: 997477.9792; val_optim_loss: 997477.9792
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9510; val_auprc_score: 0.9880; val_best_acc_score: 0.9428; val_best_f1_score: 0.9669; train_kl_reg_loss: 9119.7793; train_edge_recon_loss: 775107.7083; train_gene_expr_recon_loss: 190295.4803; train_masked_gp_l1_reg_loss: 2118.5278; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3577.2883; train_global_loss: 980218.7778; train_optim_loss: 980218.7778; val_kl_reg_loss: 9056.7362; val_edge_recon_loss: 793886.4062; val_gene_expr_recon_loss: 189641.0651; val_masked_gp_l1_reg_loss: 2087.1052; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3479.4355; val_global_loss: 998150.7708; val_optim_loss: 998150.7708
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9549; val_auprc_score: 0.9889; val_best_acc_score: 0.9428; val_best_f1_score: 0.9668; train_kl_reg_loss: 9111.2949; train_edge_recon_loss: 770825.3079; train_gene_expr_recon_loss: 189246.3258; train_masked_gp_l1_reg_loss: 2056.0523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3383.3337; train_global_loss: 974622.3183; train_optim_loss: 974622.3183; val_kl_reg_loss: 8785.3760; val_edge_recon_loss: 799751.5208; val_gene_expr_recon_loss: 189021.9141; val_masked_gp_l1_reg_loss: 2029.2124; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3288.1543; val_global_loss: 1002876.1250; val_optim_loss: 1002876.1250
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9585; val_auprc_score: 0.9906; val_best_acc_score: 0.9480; val_best_f1_score: 0.9697; train_kl_reg_loss: 8898.7255; train_edge_recon_loss: 764684.5856; train_gene_expr_recon_loss: 188323.8617; train_masked_gp_l1_reg_loss: 2002.4231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3206.3281; train_global_loss: 967115.9271; train_optim_loss: 967115.9271; val_kl_reg_loss: 8547.6079; val_edge_recon_loss: 788862.8333; val_gene_expr_recon_loss: 187837.2188; val_masked_gp_l1_reg_loss: 1981.9810; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3135.3015; val_global_loss: 990364.9583; val_optim_loss: 990364.9583

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9565; val_auprc_score: 0.9897; val_best_acc_score: 0.9469; val_best_f1_score: 0.9692; train_kl_reg_loss: 8725.3174; train_edge_recon_loss: 777052.1644; train_gene_expr_recon_loss: 187746.1013; train_masked_gp_l1_reg_loss: 1930.1583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3051.8407; train_global_loss: 978505.5938; train_optim_loss: 978505.5938; val_kl_reg_loss: 8451.2728; val_edge_recon_loss: 784276.8646; val_gene_expr_recon_loss: 187813.8047; val_masked_gp_l1_reg_loss: 1915.3748; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3024.1963; val_global_loss: 985481.5000; val_optim_loss: 985481.5000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9512; val_auprc_score: 0.9873; val_best_acc_score: 0.9472; val_best_f1_score: 0.9694; train_kl_reg_loss: 8748.9673; train_edge_recon_loss: 773114.2917; train_gene_expr_recon_loss: 187634.0671; train_masked_gp_l1_reg_loss: 1911.6251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3013.7721; train_global_loss: 974422.7199; train_optim_loss: 974422.7199; val_kl_reg_loss: 8503.6978; val_edge_recon_loss: 771074.9375; val_gene_expr_recon_loss: 187692.7005; val_masked_gp_l1_reg_loss: 1908.2449; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3003.3472; val_global_loss: 972182.9583; val_optim_loss: 972182.9583
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9604; val_auprc_score: 0.9910; val_best_acc_score: 0.9480; val_best_f1_score: 0.9698; train_kl_reg_loss: 8685.4228; train_edge_recon_loss: 775291.3727; train_gene_expr_recon_loss: 187559.6953; train_masked_gp_l1_reg_loss: 1905.3065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2994.7488; train_global_loss: 976436.5486; train_optim_loss: 976436.5486; val_kl_reg_loss: 8441.8066; val_edge_recon_loss: 782411.0417; val_gene_expr_recon_loss: 187126.2708; val_masked_gp_l1_reg_loss: 1902.2976; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2985.6987; val_global_loss: 982867.1250; val_optim_loss: 982867.1250
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9527; val_auprc_score: 0.9890; val_best_acc_score: 0.9471; val_best_f1_score: 0.9695; train_kl_reg_loss: 8655.1790; train_edge_recon_loss: 774491.8299; train_gene_expr_recon_loss: 187437.1499; train_masked_gp_l1_reg_loss: 1899.8171; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2978.1158; train_global_loss: 975462.0926; train_optim_loss: 975462.0926; val_kl_reg_loss: 8463.4824; val_edge_recon_loss: 764254.8646; val_gene_expr_recon_loss: 187543.3047; val_masked_gp_l1_reg_loss: 1897.8094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2971.4204; val_global_loss: 965130.8958; val_optim_loss: 965130.8958

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 27 min 6 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9497
val AUPRC score: 0.9885
val best accuracy score: 0.9420
val best F1 score: 0.9666
val target rna MSE score: 23.6588
val source rna MSE score: 6.6698
Val cat covariate0 mean sim diff: -0.0003

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
