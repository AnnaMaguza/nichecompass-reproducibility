[True]
Run timestamp: 07082023_215857_147.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_147']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8956; val_auprc_score: 0.9069; val_best_acc_score: 0.5597; val_best_f1_score: 0.6928; train_kl_reg_loss: 27310.3677; train_edge_recon_loss: 3474183.6667; train_gene_expr_recon_loss: 1163043.0972; train_masked_gp_l1_reg_loss: 4583.8814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167002.7292; train_chrom_access_recon_loss: 686428.8993; train_global_loss: 5522552.6111; train_optim_loss: 5522552.6111; val_kl_reg_loss: 9765.8105; val_edge_recon_loss: 4061098.7500; val_gene_expr_recon_loss: 977438.0000; val_masked_gp_l1_reg_loss: 4121.0791; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162237.8750; val_chrom_access_recon_loss: 505807.9062; val_global_loss: 5720469.5000; val_optim_loss: 5720469.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8777; val_auprc_score: 0.8881; val_best_acc_score: 0.5760; val_best_f1_score: 0.6991; train_kl_reg_loss: 9100.2712; train_edge_recon_loss: 3474488.1389; train_gene_expr_recon_loss: 920220.9931; train_masked_gp_l1_reg_loss: 3979.3399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159064.1250; train_chrom_access_recon_loss: 486124.7674; train_global_loss: 5052977.4444; train_optim_loss: 5052977.4444; val_kl_reg_loss: 10787.6387; val_edge_recon_loss: 4059912.2500; val_gene_expr_recon_loss: 865335.2500; val_masked_gp_l1_reg_loss: 3872.1938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155064.1250; val_chrom_access_recon_loss: 475629.5000; val_global_loss: 5570600.5000; val_optim_loss: 5570600.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8594; val_auprc_score: 0.8649; val_best_acc_score: 0.6179; val_best_f1_score: 0.7175; train_kl_reg_loss: 12066.7753; train_edge_recon_loss: 3476075.1667; train_gene_expr_recon_loss: 840847.1528; train_masked_gp_l1_reg_loss: 3877.7258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151586.4549; train_chrom_access_recon_loss: 464507.5174; train_global_loss: 4948960.7222; train_optim_loss: 4948960.7222; val_kl_reg_loss: 15072.8184; val_edge_recon_loss: 4054239.5000; val_gene_expr_recon_loss: 810060.1875; val_masked_gp_l1_reg_loss: 3900.1331; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146974.3438; val_chrom_access_recon_loss: 463798.0938; val_global_loss: 5494045.0000; val_optim_loss: 5494045.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8563; val_auprc_score: 0.8642; val_best_acc_score: 0.6568; val_best_f1_score: 0.7343; train_kl_reg_loss: 15346.3924; train_edge_recon_loss: 3477018.0000; train_gene_expr_recon_loss: 799194.5278; train_masked_gp_l1_reg_loss: 3913.7308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142869.1684; train_chrom_access_recon_loss: 458855.4514; train_global_loss: 4897197.3889; train_optim_loss: 4897197.3889; val_kl_reg_loss: 13999.3945; val_edge_recon_loss: 4045004.7500; val_gene_expr_recon_loss: 779146.5000; val_masked_gp_l1_reg_loss: 3921.1968; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137533.3906; val_chrom_access_recon_loss: 458495.2188; val_global_loss: 5438100.5000; val_optim_loss: 5438100.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8466; val_auprc_score: 0.8431; val_best_acc_score: 0.7332; val_best_f1_score: 0.7718; train_kl_reg_loss: 15804.2095; train_edge_recon_loss: 3476240.4167; train_gene_expr_recon_loss: 773221.2708; train_masked_gp_l1_reg_loss: 3937.5498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133082.1849; train_chrom_access_recon_loss: 454189.6285; train_global_loss: 4856475.2778; train_optim_loss: 4856475.2778; val_kl_reg_loss: 13346.4355; val_edge_recon_loss: 4027871.5000; val_gene_expr_recon_loss: 756654.9375; val_masked_gp_l1_reg_loss: 3959.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127465.8516; val_chrom_access_recon_loss: 455232.6562; val_global_loss: 5384530.5000; val_optim_loss: 5384530.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8360; val_auprc_score: 0.8295; val_best_acc_score: 0.7582; val_best_f1_score: 0.7523; train_kl_reg_loss: 15337.6072; train_edge_recon_loss: 3472322.3611; train_gene_expr_recon_loss: 755756.3056; train_masked_gp_l1_reg_loss: 3986.0493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122966.5816; train_chrom_access_recon_loss: 450791.8438; train_global_loss: 4821160.6667; train_optim_loss: 4821160.6667; val_kl_reg_loss: 13324.5898; val_edge_recon_loss: 3958945.0000; val_gene_expr_recon_loss: 743359.5000; val_masked_gp_l1_reg_loss: 4017.7158; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117360.3828; val_chrom_access_recon_loss: 453344.6875; val_global_loss: 5290351.5000; val_optim_loss: 5290351.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8405; val_auprc_score: 0.8274; val_best_acc_score: 0.7551; val_best_f1_score: 0.7730; train_kl_reg_loss: 12394.4278; train_edge_recon_loss: 3445974.6389; train_gene_expr_recon_loss: 742995.9931; train_masked_gp_l1_reg_loss: 4058.6569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112972.4931; train_chrom_access_recon_loss: 448783.1979; train_global_loss: 4767179.5000; train_optim_loss: 4767179.5000; val_kl_reg_loss: 9432.1377; val_edge_recon_loss: 3666913.2500; val_gene_expr_recon_loss: 742991.5000; val_masked_gp_l1_reg_loss: 4110.2314; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107581.9609; val_chrom_access_recon_loss: 453080.7500; val_global_loss: 4984110.0000; val_optim_loss: 4984110.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8473; val_auprc_score: 0.8403; val_best_acc_score: 0.7607; val_best_f1_score: 0.7828; train_kl_reg_loss: 8533.0131; train_edge_recon_loss: 3241822.2222; train_gene_expr_recon_loss: 768886.2917; train_masked_gp_l1_reg_loss: 4171.8292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103490.5964; train_chrom_access_recon_loss: 451883.9132; train_global_loss: 4578787.7778; train_optim_loss: 4578787.7778; val_kl_reg_loss: 13143.8770; val_edge_recon_loss: 3024425.7500; val_gene_expr_recon_loss: 799039.2500; val_masked_gp_l1_reg_loss: 4285.2935; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98575.4375; val_chrom_access_recon_loss: 457629.8438; val_global_loss: 4397099.5000; val_optim_loss: 4397099.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8836; val_auprc_score: 0.8640; val_best_acc_score: 0.8019; val_best_f1_score: 0.8211; train_kl_reg_loss: 24606.9935; train_edge_recon_loss: 2898641.8056; train_gene_expr_recon_loss: 789577.3750; train_masked_gp_l1_reg_loss: 4384.2307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94926.7943; train_chrom_access_recon_loss: 452339.6111; train_global_loss: 4264476.7222; train_optim_loss: 4264476.7222; val_kl_reg_loss: 38591.6250; val_edge_recon_loss: 2847085.5000; val_gene_expr_recon_loss: 776272.2500; val_masked_gp_l1_reg_loss: 4463.6699; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90471.8125; val_chrom_access_recon_loss: 455102.4062; val_global_loss: 4211987.0000; val_optim_loss: 4211987.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9190; val_auprc_score: 0.8936; val_best_acc_score: 0.8599; val_best_f1_score: 0.8698; train_kl_reg_loss: 43127.7661; train_edge_recon_loss: 2763734.0833; train_gene_expr_recon_loss: 763122.4722; train_masked_gp_l1_reg_loss: 4508.8655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87040.4115; train_chrom_access_recon_loss: 448916.3889; train_global_loss: 4110449.9167; train_optim_loss: 4110449.9167; val_kl_reg_loss: 43898.9961; val_edge_recon_loss: 2737662.2500; val_gene_expr_recon_loss: 752710.2500; val_masked_gp_l1_reg_loss: 4557.7393; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82835.5938; val_chrom_access_recon_loss: 451776.1250; val_global_loss: 4073441.0000; val_optim_loss: 4073441.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9240; val_auprc_score: 0.8960; val_best_acc_score: 0.8661; val_best_f1_score: 0.8755; train_kl_reg_loss: 43230.9861; train_edge_recon_loss: 2734825.3056; train_gene_expr_recon_loss: 746507.2153; train_masked_gp_l1_reg_loss: 4578.1207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79655.0747; train_chrom_access_recon_loss: 445998.0833; train_global_loss: 4054794.8056; train_optim_loss: 4054794.8056; val_kl_reg_loss: 42246.3281; val_edge_recon_loss: 2746862.0000; val_gene_expr_recon_loss: 742132.7500; val_masked_gp_l1_reg_loss: 4585.0493; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75798.5000; val_chrom_access_recon_loss: 450091.7500; val_global_loss: 4061716.2500; val_optim_loss: 4061716.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9285; val_auprc_score: 0.9012; val_best_acc_score: 0.8750; val_best_f1_score: 0.8831; train_kl_reg_loss: 41773.1636; train_edge_recon_loss: 2723667.2222; train_gene_expr_recon_loss: 743118.9028; train_masked_gp_l1_reg_loss: 4585.2030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72890.7153; train_chrom_access_recon_loss: 446291.3090; train_global_loss: 4032326.5556; train_optim_loss: 4032326.5556; val_kl_reg_loss: 41301.8984; val_edge_recon_loss: 2728005.2500; val_gene_expr_recon_loss: 734573.0000; val_masked_gp_l1_reg_loss: 4590.0635; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69381.9531; val_chrom_access_recon_loss: 448585.0625; val_global_loss: 4026437.2500; val_optim_loss: 4026437.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9357; val_auprc_score: 0.9089; val_best_acc_score: 0.8847; val_best_f1_score: 0.8917; train_kl_reg_loss: 41298.5260; train_edge_recon_loss: 2731942.4722; train_gene_expr_recon_loss: 736217.0972; train_masked_gp_l1_reg_loss: 4599.4730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66801.5451; train_chrom_access_recon_loss: 445247.9167; train_global_loss: 4026106.9722; train_optim_loss: 4026106.9722; val_kl_reg_loss: 40934.0078; val_edge_recon_loss: 2720557.5000; val_gene_expr_recon_loss: 730004.6875; val_masked_gp_l1_reg_loss: 4610.2490; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63699.6406; val_chrom_access_recon_loss: 447204.1562; val_global_loss: 4007010.5000; val_optim_loss: 4007010.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9378; val_auprc_score: 0.9172; val_best_acc_score: 0.8813; val_best_f1_score: 0.8879; train_kl_reg_loss: 40744.9110; train_edge_recon_loss: 2720283.1944; train_gene_expr_recon_loss: 727254.3333; train_masked_gp_l1_reg_loss: 4617.4240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61432.2804; train_chrom_access_recon_loss: 442424.2708; train_global_loss: 3996756.4167; train_optim_loss: 3996756.4167; val_kl_reg_loss: 40519.4375; val_edge_recon_loss: 2723200.5000; val_gene_expr_recon_loss: 725105.1250; val_masked_gp_l1_reg_loss: 4627.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58704.4219; val_chrom_access_recon_loss: 446377.3438; val_global_loss: 3998534.5000; val_optim_loss: 3998534.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9356; val_auprc_score: 0.9118; val_best_acc_score: 0.8839; val_best_f1_score: 0.8894; train_kl_reg_loss: 39930.9562; train_edge_recon_loss: 2724778.9722; train_gene_expr_recon_loss: 725020.0833; train_masked_gp_l1_reg_loss: 4639.1636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56687.7109; train_chrom_access_recon_loss: 442710.2396; train_global_loss: 3993767.1111; train_optim_loss: 3993767.1111; val_kl_reg_loss: 38134.7227; val_edge_recon_loss: 2730154.7500; val_gene_expr_recon_loss: 724209.7500; val_masked_gp_l1_reg_loss: 4658.2490; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54266.0195; val_chrom_access_recon_loss: 445637.3438; val_global_loss: 3997060.7500; val_optim_loss: 3997060.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9396; val_auprc_score: 0.9172; val_best_acc_score: 0.8857; val_best_f1_score: 0.8922; train_kl_reg_loss: 38540.7964; train_edge_recon_loss: 2712922.1944; train_gene_expr_recon_loss: 723838.5069; train_masked_gp_l1_reg_loss: 4676.6764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52489.5013; train_chrom_access_recon_loss: 441315.5868; train_global_loss: 3973783.2500; train_optim_loss: 3973783.2500; val_kl_reg_loss: 38733.6406; val_edge_recon_loss: 2725453.5000; val_gene_expr_recon_loss: 717814.0000; val_masked_gp_l1_reg_loss: 4698.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50341.4453; val_chrom_access_recon_loss: 445009.8125; val_global_loss: 3982050.7500; val_optim_loss: 3982050.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9443; val_auprc_score: 0.9241; val_best_acc_score: 0.8923; val_best_f1_score: 0.8994; train_kl_reg_loss: 39224.3911; train_edge_recon_loss: 2712954.2500; train_gene_expr_recon_loss: 715854.0556; train_masked_gp_l1_reg_loss: 4716.1492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48744.2374; train_chrom_access_recon_loss: 440518.2465; train_global_loss: 3962011.3611; train_optim_loss: 3962011.3611; val_kl_reg_loss: 38982.1562; val_edge_recon_loss: 2711359.7500; val_gene_expr_recon_loss: 715643.4375; val_masked_gp_l1_reg_loss: 4732.6606; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46812.9492; val_chrom_access_recon_loss: 443655.6562; val_global_loss: 3961187.0000; val_optim_loss: 3961187.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9455; val_auprc_score: 0.9256; val_best_acc_score: 0.8902; val_best_f1_score: 0.8968; train_kl_reg_loss: 39017.4306; train_edge_recon_loss: 2717981.6389; train_gene_expr_recon_loss: 713526.7847; train_masked_gp_l1_reg_loss: 4753.8565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45387.8281; train_chrom_access_recon_loss: 440228.2708; train_global_loss: 3960895.7778; train_optim_loss: 3960895.7778; val_kl_reg_loss: 38401.2734; val_edge_recon_loss: 2735931.0000; val_gene_expr_recon_loss: 712624.2500; val_masked_gp_l1_reg_loss: 4775.6553; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43653.3984; val_chrom_access_recon_loss: 443247.6562; val_global_loss: 3978633.5000; val_optim_loss: 3978633.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9494; val_auprc_score: 0.9340; val_best_acc_score: 0.8959; val_best_f1_score: 0.9021; train_kl_reg_loss: 38816.4366; train_edge_recon_loss: 2720061.4722; train_gene_expr_recon_loss: 709321.2292; train_masked_gp_l1_reg_loss: 4793.9462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42360.0525; train_chrom_access_recon_loss: 439699.3125; train_global_loss: 3955052.4722; train_optim_loss: 3955052.4722; val_kl_reg_loss: 37304.9609; val_edge_recon_loss: 2710919.5000; val_gene_expr_recon_loss: 710028.7500; val_masked_gp_l1_reg_loss: 4813.6475; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40783.3438; val_chrom_access_recon_loss: 442650.7188; val_global_loss: 3946501.0000; val_optim_loss: 3946501.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9517; val_auprc_score: 0.9357; val_best_acc_score: 0.8987; val_best_f1_score: 0.9035; train_kl_reg_loss: 37348.7205; train_edge_recon_loss: 2712817.1944; train_gene_expr_recon_loss: 705612.4028; train_masked_gp_l1_reg_loss: 4835.5583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39625.3780; train_chrom_access_recon_loss: 438393.9931; train_global_loss: 3938633.2222; train_optim_loss: 3938633.2222; val_kl_reg_loss: 37255.9688; val_edge_recon_loss: 2719105.2500; val_gene_expr_recon_loss: 707014.6250; val_masked_gp_l1_reg_loss: 4854.5503; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38216.8516; val_chrom_access_recon_loss: 442095.2188; val_global_loss: 3948542.5000; val_optim_loss: 3948542.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9535; val_auprc_score: 0.9389; val_best_acc_score: 0.8968; val_best_f1_score: 0.9009; train_kl_reg_loss: 37212.1515; train_edge_recon_loss: 2715585.7778; train_gene_expr_recon_loss: 705339.1319; train_masked_gp_l1_reg_loss: 4874.0500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37156.0985; train_chrom_access_recon_loss: 439719.8472; train_global_loss: 3939887.1111; train_optim_loss: 3939887.1111; val_kl_reg_loss: 36086.2500; val_edge_recon_loss: 2724010.0000; val_gene_expr_recon_loss: 704343.8750; val_masked_gp_l1_reg_loss: 4897.7349; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35885.8906; val_chrom_access_recon_loss: 440961.6562; val_global_loss: 3946185.5000; val_optim_loss: 3946185.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9576; val_auprc_score: 0.9442; val_best_acc_score: 0.9015; val_best_f1_score: 0.9061; train_kl_reg_loss: 36498.0582; train_edge_recon_loss: 2716271.4444; train_gene_expr_recon_loss: 704284.9583; train_masked_gp_l1_reg_loss: 4919.2552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34949.0265; train_chrom_access_recon_loss: 439047.8264; train_global_loss: 3935970.5000; train_optim_loss: 3935970.5000; val_kl_reg_loss: 34902.2188; val_edge_recon_loss: 2726277.5000; val_gene_expr_recon_loss: 702014.1875; val_masked_gp_l1_reg_loss: 4940.1294; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33813.0391; val_chrom_access_recon_loss: 440436.6250; val_global_loss: 3942384.0000; val_optim_loss: 3942384.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9622; val_auprc_score: 0.9492; val_best_acc_score: 0.9085; val_best_f1_score: 0.9128; train_kl_reg_loss: 35243.3993; train_edge_recon_loss: 2718022.1667; train_gene_expr_recon_loss: 702663.2431; train_masked_gp_l1_reg_loss: 4958.3220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32971.4067; train_chrom_access_recon_loss: 437819.9201; train_global_loss: 3931678.4722; train_optim_loss: 3931678.4722; val_kl_reg_loss: 33671.6875; val_edge_recon_loss: 2700614.0000; val_gene_expr_recon_loss: 698833.2500; val_masked_gp_l1_reg_loss: 4971.8276; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31944.0527; val_chrom_access_recon_loss: 439982.3125; val_global_loss: 3910017.0000; val_optim_loss: 3910017.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9653; val_auprc_score: 0.9527; val_best_acc_score: 0.9178; val_best_f1_score: 0.9204; train_kl_reg_loss: 33711.6137; train_edge_recon_loss: 2705394.1389; train_gene_expr_recon_loss: 698837.7292; train_masked_gp_l1_reg_loss: 4987.3545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31178.5076; train_chrom_access_recon_loss: 436400.8646; train_global_loss: 3910510.2500; train_optim_loss: 3910510.2500; val_kl_reg_loss: 31989.2734; val_edge_recon_loss: 2701554.5000; val_gene_expr_recon_loss: 700879.2500; val_masked_gp_l1_reg_loss: 4997.2593; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30245.3242; val_chrom_access_recon_loss: 439865.2812; val_global_loss: 3909530.7500; val_optim_loss: 3909530.7500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9679; val_auprc_score: 0.9547; val_best_acc_score: 0.9228; val_best_f1_score: 0.9257; train_kl_reg_loss: 32280.9855; train_edge_recon_loss: 2689201.5278; train_gene_expr_recon_loss: 698319.6042; train_masked_gp_l1_reg_loss: 5011.5624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29563.8809; train_chrom_access_recon_loss: 436004.0451; train_global_loss: 3890381.6389; train_optim_loss: 3890381.6389; val_kl_reg_loss: 30948.2930; val_edge_recon_loss: 2705722.5000; val_gene_expr_recon_loss: 702110.8750; val_masked_gp_l1_reg_loss: 5023.2529; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28734.1953; val_chrom_access_recon_loss: 439624.6250; val_global_loss: 3912163.5000; val_optim_loss: 3912163.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9713; val_auprc_score: 0.9568; val_best_acc_score: 0.9279; val_best_f1_score: 0.9300; train_kl_reg_loss: 28791.1450; train_edge_recon_loss: 2677633.8333; train_gene_expr_recon_loss: 988391.7083; train_masked_gp_l1_reg_loss: 5045.5158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27862.1005; train_chrom_access_recon_loss: 461340.5729; train_global_loss: 4189064.8333; train_optim_loss: 4189064.8333; val_kl_reg_loss: 13860.4062; val_edge_recon_loss: 2684253.2500; val_gene_expr_recon_loss: 984047.0000; val_masked_gp_l1_reg_loss: 5075.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26637.0898; val_chrom_access_recon_loss: 465092.7188; val_global_loss: 4178966.2500; val_optim_loss: 4178966.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9720; val_auprc_score: 0.9622; val_best_acc_score: 0.9322; val_best_f1_score: 0.9339; train_kl_reg_loss: 26744.8739; train_edge_recon_loss: 2666737.8611; train_gene_expr_recon_loss: 984891.0972; train_masked_gp_l1_reg_loss: 5102.8391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25565.4379; train_chrom_access_recon_loss: 459426.3472; train_global_loss: 4168468.3889; train_optim_loss: 4168468.3889; val_kl_reg_loss: 14206.8027; val_edge_recon_loss: 2665846.7500; val_gene_expr_recon_loss: 982074.0000; val_masked_gp_l1_reg_loss: 5131.8262; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24222.8223; val_chrom_access_recon_loss: 464610.6562; val_global_loss: 4156092.7500; val_optim_loss: 4156092.7500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9746; val_auprc_score: 0.9658; val_best_acc_score: 0.9297; val_best_f1_score: 0.9315; train_kl_reg_loss: 26157.3049; train_edge_recon_loss: 2654774.8611; train_gene_expr_recon_loss: 978463.0069; train_masked_gp_l1_reg_loss: 5154.1947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23187.0968; train_chrom_access_recon_loss: 460980.5868; train_global_loss: 4148717.0278; train_optim_loss: 4148717.0278; val_kl_reg_loss: 14231.2080; val_edge_recon_loss: 2667329.2500; val_gene_expr_recon_loss: 976803.0000; val_masked_gp_l1_reg_loss: 5178.3208; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21929.6367; val_chrom_access_recon_loss: 463692.3750; val_global_loss: 4149164.0000; val_optim_loss: 4149164.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9704; val_auprc_score: 0.9600; val_best_acc_score: 0.9272; val_best_f1_score: 0.9293; train_kl_reg_loss: 25765.9941; train_edge_recon_loss: 2657959.3611; train_gene_expr_recon_loss: 976050.0486; train_masked_gp_l1_reg_loss: 5169.0013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21736.2717; train_chrom_access_recon_loss: 458954.6215; train_global_loss: 4145635.2222; train_optim_loss: 4145635.2222; val_kl_reg_loss: 14158.4199; val_edge_recon_loss: 2681010.0000; val_gene_expr_recon_loss: 976396.2500; val_masked_gp_l1_reg_loss: 5158.4004; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21524.8867; val_chrom_access_recon_loss: 463670.4062; val_global_loss: 4161918.7500; val_optim_loss: 4161918.7500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9714; val_auprc_score: 0.9591; val_best_acc_score: 0.9325; val_best_f1_score: 0.9341; train_kl_reg_loss: 25470.6124; train_edge_recon_loss: 2657631.7778; train_gene_expr_recon_loss: 976071.2014; train_masked_gp_l1_reg_loss: 5155.0620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21393.7235; train_chrom_access_recon_loss: 460501.4306; train_global_loss: 4146223.7222; train_optim_loss: 4146223.7222; val_kl_reg_loss: 13976.2129; val_edge_recon_loss: 2663807.2500; val_gene_expr_recon_loss: 975239.6250; val_masked_gp_l1_reg_loss: 5150.8311; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21224.2734; val_chrom_access_recon_loss: 463487.5938; val_global_loss: 4142885.5000; val_optim_loss: 4142885.5000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9718; val_auprc_score: 0.9564; val_best_acc_score: 0.9279; val_best_f1_score: 0.9300; train_kl_reg_loss: 25130.9392; train_edge_recon_loss: 2651884.1667; train_gene_expr_recon_loss: 976334.9028; train_masked_gp_l1_reg_loss: 5148.6067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21101.6141; train_chrom_access_recon_loss: 458887.0035; train_global_loss: 4138487.2778; train_optim_loss: 4138487.2778; val_kl_reg_loss: 13936.6152; val_edge_recon_loss: 2673962.0000; val_gene_expr_recon_loss: 975590.3125; val_masked_gp_l1_reg_loss: 5146.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20951.5508; val_chrom_access_recon_loss: 463546.5312; val_global_loss: 4153133.2500; val_optim_loss: 4153133.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9753; val_auprc_score: 0.9649; val_best_acc_score: 0.9336; val_best_f1_score: 0.9353; train_kl_reg_loss: 25040.5627; train_edge_recon_loss: 2656312.4167; train_gene_expr_recon_loss: 975144.3333; train_masked_gp_l1_reg_loss: 5145.9126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20838.8210; train_chrom_access_recon_loss: 458866.5208; train_global_loss: 4141348.6389; train_optim_loss: 4141348.6389; val_kl_reg_loss: 13977.3438; val_edge_recon_loss: 2656924.2500; val_gene_expr_recon_loss: 975513.3125; val_masked_gp_l1_reg_loss: 5145.5684; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20704.5098; val_chrom_access_recon_loss: 463507.8750; val_global_loss: 4135772.5000; val_optim_loss: 4135772.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 20 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9688
val AUPRC score: 0.9559
val best accuracy score: 0.9214
val best F1 score: 0.9249
val target rna MSE score: 3.9417
val source rna MSE score: 3.1961
val target atac MSE score: 0.1404
val source atac MSE score: 0.0221
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
