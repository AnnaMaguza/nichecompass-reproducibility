[True]
Run timestamp: 10102023_044405_147.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_147']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7023; val_auprc_score: 0.6732; val_best_acc_score: 0.5019; val_best_f1_score: 0.6675; train_kl_reg_loss: 78311.6479; train_edge_recon_loss: 757311.6932; train_gene_expr_recon_loss: 23322816.5455; train_masked_gp_l1_reg_loss: 36651.5312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4028929.2121; train_chrom_access_recon_loss: 996054.7206; train_global_loss: 29220075.5758; train_optim_loss: 29220075.5758; val_kl_reg_loss: 87225.5762; val_edge_recon_loss: 813022.1484; val_gene_expr_recon_loss: 21272031.2500; val_masked_gp_l1_reg_loss: 39007.7305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2700894.2500; val_chrom_access_recon_loss: 954477.9219; val_global_loss: 25866659.0000; val_optim_loss: 25866659.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6894; val_auprc_score: 0.6617; val_best_acc_score: 0.6265; val_best_f1_score: 0.6956; train_kl_reg_loss: 92362.5406; train_edge_recon_loss: 747230.9489; train_gene_expr_recon_loss: 21231660.8788; train_masked_gp_l1_reg_loss: 39835.6944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1765785.6629; train_chrom_access_recon_loss: 945732.4394; train_global_loss: 24822608.3939; train_optim_loss: 24822608.3939; val_kl_reg_loss: 85878.2686; val_edge_recon_loss: 810708.4375; val_gene_expr_recon_loss: 21020828.0000; val_masked_gp_l1_reg_loss: 40719.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1063281.7500; val_chrom_access_recon_loss: 948398.0234; val_global_loss: 23969814.5000; val_optim_loss: 23969814.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7560; val_auprc_score: 0.7323; val_best_acc_score: 0.6628; val_best_f1_score: 0.7253; train_kl_reg_loss: 80626.6612; train_edge_recon_loss: 735195.9176; train_gene_expr_recon_loss: 21014867.9697; train_masked_gp_l1_reg_loss: 41692.8335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 733127.4479; train_chrom_access_recon_loss: 938948.2614; train_global_loss: 23544459.1818; train_optim_loss: 23544459.1818; val_kl_reg_loss: 75298.4980; val_edge_recon_loss: 801541.4219; val_gene_expr_recon_loss: 20930698.0000; val_masked_gp_l1_reg_loss: 42749.7695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 495064.0938; val_chrom_access_recon_loss: 935706.4453; val_global_loss: 23281058.7500; val_optim_loss: 23281058.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8069; val_auprc_score: 0.7837; val_best_acc_score: 0.7286; val_best_f1_score: 0.7581; train_kl_reg_loss: 70930.8259; train_edge_recon_loss: 723769.0473; train_gene_expr_recon_loss: 20847004.3939; train_masked_gp_l1_reg_loss: 44018.8239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 381798.2865; train_chrom_access_recon_loss: 932829.5947; train_global_loss: 23000350.7879; train_optim_loss: 23000350.7879; val_kl_reg_loss: 67798.2197; val_edge_recon_loss: 765477.1562; val_gene_expr_recon_loss: 20779751.7500; val_masked_gp_l1_reg_loss: 45349.9961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 298841.1562; val_chrom_access_recon_loss: 936565.4922; val_global_loss: 22893785.0000; val_optim_loss: 22893785.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8638; val_auprc_score: 0.8296; val_best_acc_score: 0.7920; val_best_f1_score: 0.8120; train_kl_reg_loss: 66861.7644; train_edge_recon_loss: 695701.2188; train_gene_expr_recon_loss: 20693792.5152; train_masked_gp_l1_reg_loss: 46559.9648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 254199.2876; train_chrom_access_recon_loss: 928199.4877; train_global_loss: 22685314.3030; train_optim_loss: 22685314.3030; val_kl_reg_loss: 67445.2031; val_edge_recon_loss: 684051.3906; val_gene_expr_recon_loss: 20537249.2500; val_masked_gp_l1_reg_loss: 47847.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 219080.8594; val_chrom_access_recon_loss: 931331.6484; val_global_loss: 22487005.2500; val_optim_loss: 22487005.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8847; val_auprc_score: 0.8468; val_best_acc_score: 0.8170; val_best_f1_score: 0.8315; train_kl_reg_loss: 75308.5086; train_edge_recon_loss: 642284.7964; train_gene_expr_recon_loss: 20547958.9394; train_masked_gp_l1_reg_loss: 48987.0038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 197640.5703; train_chrom_access_recon_loss: 923113.4640; train_global_loss: 22435293.4242; train_optim_loss: 22435293.4242; val_kl_reg_loss: 79624.6729; val_edge_recon_loss: 638559.9922; val_gene_expr_recon_loss: 20376762.2500; val_masked_gp_l1_reg_loss: 50344.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179122.4531; val_chrom_access_recon_loss: 918859.6719; val_global_loss: 22243273.0000; val_optim_loss: 22243273.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8969; val_auprc_score: 0.8643; val_best_acc_score: 0.8286; val_best_f1_score: 0.8433; train_kl_reg_loss: 78110.8668; train_edge_recon_loss: 623330.0028; train_gene_expr_recon_loss: 20427268.3030; train_masked_gp_l1_reg_loss: 51370.7989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 164390.5833; train_chrom_access_recon_loss: 918371.7481; train_global_loss: 22262842.3636; train_optim_loss: 22262842.3636; val_kl_reg_loss: 74416.3154; val_edge_recon_loss: 628588.1562; val_gene_expr_recon_loss: 20217865.2500; val_masked_gp_l1_reg_loss: 52549.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152452.4531; val_chrom_access_recon_loss: 914180.6172; val_global_loss: 22040052.2500; val_optim_loss: 22040052.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8947; val_auprc_score: 0.8686; val_best_acc_score: 0.8251; val_best_f1_score: 0.8384; train_kl_reg_loss: 75714.0071; train_edge_recon_loss: 617406.4792; train_gene_expr_recon_loss: 20333012.2727; train_masked_gp_l1_reg_loss: 53385.8553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143124.9148; train_chrom_access_recon_loss: 915598.1184; train_global_loss: 22138241.5152; train_optim_loss: 22138241.5152; val_kl_reg_loss: 75178.4336; val_edge_recon_loss: 622635.7188; val_gene_expr_recon_loss: 20335916.0000; val_masked_gp_l1_reg_loss: 54230.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136305.4062; val_chrom_access_recon_loss: 912038.5469; val_global_loss: 22136304.7500; val_optim_loss: 22136304.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9013; val_auprc_score: 0.8719; val_best_acc_score: 0.8377; val_best_f1_score: 0.8521; train_kl_reg_loss: 73386.3911; train_edge_recon_loss: 610766.3210; train_gene_expr_recon_loss: 20240608.6970; train_masked_gp_l1_reg_loss: 55090.5282; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129448.6164; train_chrom_access_recon_loss: 911868.2121; train_global_loss: 22021168.7273; train_optim_loss: 22021168.7273; val_kl_reg_loss: 74280.3809; val_edge_recon_loss: 610356.5234; val_gene_expr_recon_loss: 20382790.5000; val_masked_gp_l1_reg_loss: 55959.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124416.7031; val_chrom_access_recon_loss: 913945.6641; val_global_loss: 22161748.7500; val_optim_loss: 22161748.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9128; val_auprc_score: 0.8889; val_best_acc_score: 0.8447; val_best_f1_score: 0.8576; train_kl_reg_loss: 71227.5257; train_edge_recon_loss: 609177.4953; train_gene_expr_recon_loss: 20149567.7576; train_masked_gp_l1_reg_loss: 56550.4642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119067.4408; train_chrom_access_recon_loss: 907478.6193; train_global_loss: 21913069.2727; train_optim_loss: 21913069.2727; val_kl_reg_loss: 71798.4004; val_edge_recon_loss: 609148.8438; val_gene_expr_recon_loss: 20095384.0000; val_masked_gp_l1_reg_loss: 57275.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114903.1328; val_chrom_access_recon_loss: 912870.0547; val_global_loss: 21861381.5000; val_optim_loss: 21861381.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9103; val_auprc_score: 0.8827; val_best_acc_score: 0.8471; val_best_f1_score: 0.8592; train_kl_reg_loss: 70426.0032; train_edge_recon_loss: 603344.1477; train_gene_expr_recon_loss: 20097785.7879; train_masked_gp_l1_reg_loss: 57820.8638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110948.7049; train_chrom_access_recon_loss: 905994.0189; train_global_loss: 21846319.7879; train_optim_loss: 21846319.7879; val_kl_reg_loss: 70242.1260; val_edge_recon_loss: 605882.9766; val_gene_expr_recon_loss: 20036607.2500; val_masked_gp_l1_reg_loss: 58385.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108395.8203; val_chrom_access_recon_loss: 905775.1250; val_global_loss: 21785289.7500; val_optim_loss: 21785289.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9147; val_auprc_score: 0.8827; val_best_acc_score: 0.8536; val_best_f1_score: 0.8652; train_kl_reg_loss: 68414.7348; train_edge_recon_loss: 600781.6771; train_gene_expr_recon_loss: 20021783.2727; train_masked_gp_l1_reg_loss: 58999.4161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105589.2938; train_chrom_access_recon_loss: 902480.0720; train_global_loss: 21758048.5455; train_optim_loss: 21758048.5455; val_kl_reg_loss: 66811.1377; val_edge_recon_loss: 602122.1875; val_gene_expr_recon_loss: 19974176.2500; val_masked_gp_l1_reg_loss: 59591.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103596.9375; val_chrom_access_recon_loss: 897686.0000; val_global_loss: 21703983.2500; val_optim_loss: 21703983.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9129; val_auprc_score: 0.8842; val_best_acc_score: 0.8509; val_best_f1_score: 0.8640; train_kl_reg_loss: 66262.1868; train_edge_recon_loss: 600669.2850; train_gene_expr_recon_loss: 19942429.7576; train_masked_gp_l1_reg_loss: 60145.5503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101397.5097; train_chrom_access_recon_loss: 899269.7519; train_global_loss: 21670173.8485; train_optim_loss: 21670173.8485; val_kl_reg_loss: 64968.5811; val_edge_recon_loss: 603273.6562; val_gene_expr_recon_loss: 19848806.0000; val_masked_gp_l1_reg_loss: 60693.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99675.7109; val_chrom_access_recon_loss: 896615.4844; val_global_loss: 21574033.7500; val_optim_loss: 21574033.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9275; val_auprc_score: 0.9077; val_best_acc_score: 0.8598; val_best_f1_score: 0.8666; train_kl_reg_loss: 66330.2100; train_edge_recon_loss: 596067.1288; train_gene_expr_recon_loss: 19888493.8485; train_masked_gp_l1_reg_loss: 61114.1085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97734.5496; train_chrom_access_recon_loss: 896629.9905; train_global_loss: 21606370.1212; train_optim_loss: 21606370.1212; val_kl_reg_loss: 64193.2061; val_edge_recon_loss: 599111.8672; val_gene_expr_recon_loss: 19748850.0000; val_masked_gp_l1_reg_loss: 61616.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96849.7891; val_chrom_access_recon_loss: 901020.2266; val_global_loss: 21471641.5000; val_optim_loss: 21471641.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9340; val_auprc_score: 0.9137; val_best_acc_score: 0.8694; val_best_f1_score: 0.8784; train_kl_reg_loss: 65072.2122; train_edge_recon_loss: 593971.7225; train_gene_expr_recon_loss: 19825319.6667; train_masked_gp_l1_reg_loss: 62074.6363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95312.7785; train_chrom_access_recon_loss: 894013.5407; train_global_loss: 21535764.5152; train_optim_loss: 21535764.5152; val_kl_reg_loss: 63206.7378; val_edge_recon_loss: 594580.1641; val_gene_expr_recon_loss: 19569132.2500; val_masked_gp_l1_reg_loss: 62495.7852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94640.4609; val_chrom_access_recon_loss: 883773.0469; val_global_loss: 21267828.2500; val_optim_loss: 21267828.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9321; val_auprc_score: 0.9068; val_best_acc_score: 0.8740; val_best_f1_score: 0.8801; train_kl_reg_loss: 63550.7574; train_edge_recon_loss: 593817.4953; train_gene_expr_recon_loss: 19765931.4242; train_masked_gp_l1_reg_loss: 62934.1890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93443.1242; train_chrom_access_recon_loss: 891433.9744; train_global_loss: 21471111.2121; train_optim_loss: 21471111.2121; val_kl_reg_loss: 62345.9551; val_edge_recon_loss: 592713.4609; val_gene_expr_recon_loss: 19769188.0000; val_masked_gp_l1_reg_loss: 63415.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93215.8828; val_chrom_access_recon_loss: 893494.7188; val_global_loss: 21474374.0000; val_optim_loss: 21474374.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9262; val_auprc_score: 0.9055; val_best_acc_score: 0.8632; val_best_f1_score: 0.8725; train_kl_reg_loss: 62814.3709; train_edge_recon_loss: 590966.8504; train_gene_expr_recon_loss: 19720494.7576; train_masked_gp_l1_reg_loss: 63796.8844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91958.6932; train_chrom_access_recon_loss: 890455.5511; train_global_loss: 21420487.1515; train_optim_loss: 21420487.1515; val_kl_reg_loss: 63175.3564; val_edge_recon_loss: 600259.6016; val_gene_expr_recon_loss: 19834028.2500; val_masked_gp_l1_reg_loss: 64226.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91681.5312; val_chrom_access_recon_loss: 902546.3516; val_global_loss: 21555917.5000; val_optim_loss: 21555917.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9399; val_auprc_score: 0.9256; val_best_acc_score: 0.8702; val_best_f1_score: 0.8781; train_kl_reg_loss: 62169.3063; train_edge_recon_loss: 589682.5417; train_gene_expr_recon_loss: 19646445.1515; train_masked_gp_l1_reg_loss: 64639.8314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90874.7505; train_chrom_access_recon_loss: 885855.4934; train_global_loss: 21339667.1818; train_optim_loss: 21339667.1818; val_kl_reg_loss: 62476.9541; val_edge_recon_loss: 589358.0078; val_gene_expr_recon_loss: 19759967.2500; val_masked_gp_l1_reg_loss: 64997.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90100.0156; val_chrom_access_recon_loss: 892215.0234; val_global_loss: 21459115.5000; val_optim_loss: 21459115.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9339; val_auprc_score: 0.9149; val_best_acc_score: 0.8684; val_best_f1_score: 0.8752; train_kl_reg_loss: 61593.6190; train_edge_recon_loss: 587400.6733; train_gene_expr_recon_loss: 19610542.3333; train_masked_gp_l1_reg_loss: 65445.8220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89584.7224; train_chrom_access_recon_loss: 885135.3409; train_global_loss: 21299702.5758; train_optim_loss: 21299702.5758; val_kl_reg_loss: 61574.5581; val_edge_recon_loss: 597890.5781; val_gene_expr_recon_loss: 19667224.7500; val_masked_gp_l1_reg_loss: 65882.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90131.5469; val_chrom_access_recon_loss: 898566.4297; val_global_loss: 21381269.7500; val_optim_loss: 21381269.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9350; val_auprc_score: 0.9146; val_best_acc_score: 0.8729; val_best_f1_score: 0.8809; train_kl_reg_loss: 61162.3607; train_edge_recon_loss: 587879.6297; train_gene_expr_recon_loss: 19578968.1212; train_masked_gp_l1_reg_loss: 65244.1943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70703.2883; train_chrom_access_recon_loss: 882722.1174; train_global_loss: 21246679.7576; train_optim_loss: 21246679.7576; val_kl_reg_loss: 61829.9072; val_edge_recon_loss: 590660.9688; val_gene_expr_recon_loss: 19496765.7500; val_masked_gp_l1_reg_loss: 64885.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64253.6602; val_chrom_access_recon_loss: 882592.0625; val_global_loss: 21160988.5000; val_optim_loss: 21160988.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9408; val_auprc_score: 0.9206; val_best_acc_score: 0.8791; val_best_f1_score: 0.8838; train_kl_reg_loss: 61807.8172; train_edge_recon_loss: 585029.4044; train_gene_expr_recon_loss: 19546138.4545; train_masked_gp_l1_reg_loss: 64835.7621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63331.9785; train_chrom_access_recon_loss: 881401.4678; train_global_loss: 21202544.8182; train_optim_loss: 21202544.8182; val_kl_reg_loss: 62342.8442; val_edge_recon_loss: 594618.9141; val_gene_expr_recon_loss: 19576519.5000; val_masked_gp_l1_reg_loss: 64814.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62690.6250; val_chrom_access_recon_loss: 882777.1406; val_global_loss: 21243762.2500; val_optim_loss: 21243762.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9397; val_auprc_score: 0.9191; val_best_acc_score: 0.8799; val_best_f1_score: 0.8877; train_kl_reg_loss: 62256.9118; train_edge_recon_loss: 584972.0218; train_gene_expr_recon_loss: 19525980.9394; train_masked_gp_l1_reg_loss: 64825.5372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62393.5263; train_chrom_access_recon_loss: 880223.7311; train_global_loss: 21180652.7576; train_optim_loss: 21180652.7576; val_kl_reg_loss: 63013.0806; val_edge_recon_loss: 589010.1641; val_gene_expr_recon_loss: 19563904.2500; val_masked_gp_l1_reg_loss: 64844.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62013.6914; val_chrom_access_recon_loss: 891286.0000; val_global_loss: 21234071.5000; val_optim_loss: 21234071.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9323; val_auprc_score: 0.9047; val_best_acc_score: 0.8700; val_best_f1_score: 0.8783; train_kl_reg_loss: 62367.0249; train_edge_recon_loss: 584844.4025; train_gene_expr_recon_loss: 19544688.6061; train_masked_gp_l1_reg_loss: 64872.9498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61754.2673; train_chrom_access_recon_loss: 881994.5777; train_global_loss: 21200521.6970; train_optim_loss: 21200521.6970; val_kl_reg_loss: 63026.3833; val_edge_recon_loss: 592425.1719; val_gene_expr_recon_loss: 19804452.5000; val_masked_gp_l1_reg_loss: 64910.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61531.1016; val_chrom_access_recon_loss: 889889.9844; val_global_loss: 21476236.2500; val_optim_loss: 21476236.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9400; val_auprc_score: 0.9154; val_best_acc_score: 0.8802; val_best_f1_score: 0.8848; train_kl_reg_loss: 62473.9609; train_edge_recon_loss: 583764.0294; train_gene_expr_recon_loss: 19533299.5152; train_masked_gp_l1_reg_loss: 64943.8665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61352.7905; train_chrom_access_recon_loss: 880529.6231; train_global_loss: 21186363.9697; train_optim_loss: 21186363.9697; val_kl_reg_loss: 62988.0649; val_edge_recon_loss: 589652.2578; val_gene_expr_recon_loss: 19518704.0000; val_masked_gp_l1_reg_loss: 64960.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61080.9375; val_chrom_access_recon_loss: 886060.2188; val_global_loss: 21183444.2500; val_optim_loss: 21183444.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9368; val_auprc_score: 0.9117; val_best_acc_score: 0.8716; val_best_f1_score: 0.8794; train_kl_reg_loss: 62448.8333; train_edge_recon_loss: 584109.5133; train_gene_expr_recon_loss: 19538647.6364; train_masked_gp_l1_reg_loss: 64900.0530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59319.2504; train_chrom_access_recon_loss: 881205.6837; train_global_loss: 21190630.7879; train_optim_loss: 21190630.7879; val_kl_reg_loss: 62784.3770; val_edge_recon_loss: 587575.4688; val_gene_expr_recon_loss: 19461708.2500; val_masked_gp_l1_reg_loss: 64855.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58738.0000; val_chrom_access_recon_loss: 879151.3438; val_global_loss: 21114813.2500; val_optim_loss: 21114813.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9353; val_auprc_score: 0.9158; val_best_acc_score: 0.8684; val_best_f1_score: 0.8775; train_kl_reg_loss: 66808.4464; train_edge_recon_loss: 733682.2973; train_gene_expr_recon_loss: 18147989.4242; train_masked_gp_l1_reg_loss: 64801.9260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58250.1465; train_chrom_access_recon_loss: 936438.2150; train_global_loss: 20007970.4242; train_optim_loss: 20007970.4242; val_kl_reg_loss: 16921.5413; val_edge_recon_loss: 734515.5625; val_gene_expr_recon_loss: 18127008.0000; val_masked_gp_l1_reg_loss: 64753.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57755.6953; val_chrom_access_recon_loss: 940041.5859; val_global_loss: 19940996.5000; val_optim_loss: 19940996.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9323; val_auprc_score: 0.9116; val_best_acc_score: 0.8632; val_best_f1_score: 0.8731; train_kl_reg_loss: 66686.0662; train_edge_recon_loss: 732991.5767; train_gene_expr_recon_loss: 17998348.0606; train_masked_gp_l1_reg_loss: 64726.0244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57359.3770; train_chrom_access_recon_loss: 912768.8892; train_global_loss: 19832880.1212; train_optim_loss: 19832880.1212; val_kl_reg_loss: 16873.3738; val_edge_recon_loss: 736897.4688; val_gene_expr_recon_loss: 18059685.5000; val_masked_gp_l1_reg_loss: 64700.3555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56993.5742; val_chrom_access_recon_loss: 897382.1016; val_global_loss: 19832533.0000; val_optim_loss: 19832533.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9269; val_auprc_score: 0.9060; val_best_acc_score: 0.8546; val_best_f1_score: 0.8631; train_kl_reg_loss: 65979.7266; train_edge_recon_loss: 733049.3210; train_gene_expr_recon_loss: 17925192.6061; train_masked_gp_l1_reg_loss: 64677.4391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56707.7448; train_chrom_access_recon_loss: 893455.5369; train_global_loss: 19739062.6061; train_optim_loss: 19739062.6061; val_kl_reg_loss: 17004.8677; val_edge_recon_loss: 737847.1172; val_gene_expr_recon_loss: 17866025.2500; val_masked_gp_l1_reg_loss: 64652.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56425.4414; val_chrom_access_recon_loss: 884701.9688; val_global_loss: 19626657.5000; val_optim_loss: 19626657.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9302; val_auprc_score: 0.9112; val_best_acc_score: 0.8624; val_best_f1_score: 0.8667; train_kl_reg_loss: 65734.7062; train_edge_recon_loss: 730228.5426; train_gene_expr_recon_loss: 17898777.0606; train_masked_gp_l1_reg_loss: 64627.7441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56194.0866; train_chrom_access_recon_loss: 881449.3523; train_global_loss: 19697011.4545; train_optim_loss: 19697011.4545; val_kl_reg_loss: 18384.0056; val_edge_recon_loss: 739243.0625; val_gene_expr_recon_loss: 17962944.2500; val_masked_gp_l1_reg_loss: 64602.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55966.6641; val_chrom_access_recon_loss: 881393.5703; val_global_loss: 19722533.0000; val_optim_loss: 19722533.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9299; val_auprc_score: 0.9099; val_best_acc_score: 0.8581; val_best_f1_score: 0.8694; train_kl_reg_loss: 67852.0458; train_edge_recon_loss: 716963.9659; train_gene_expr_recon_loss: 17883742.1818; train_masked_gp_l1_reg_loss: 64577.5910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55777.5948; train_chrom_access_recon_loss: 872392.1932; train_global_loss: 19661305.4848; train_optim_loss: 19661305.4848; val_kl_reg_loss: 22930.1719; val_edge_recon_loss: 737504.5391; val_gene_expr_recon_loss: 17728561.7500; val_masked_gp_l1_reg_loss: 64556.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55599.1328; val_chrom_access_recon_loss: 871277.0391; val_global_loss: 19480429.2500; val_optim_loss: 19480429.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9283; val_auprc_score: 0.8959; val_best_acc_score: 0.8616; val_best_f1_score: 0.8682; train_kl_reg_loss: 69840.4486; train_edge_recon_loss: 707653.0540; train_gene_expr_recon_loss: 17859439.6970; train_masked_gp_l1_reg_loss: 64536.9562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55445.8221; train_chrom_access_recon_loss: 864627.5947; train_global_loss: 19621543.5152; train_optim_loss: 19621543.5152; val_kl_reg_loss: 24181.7207; val_edge_recon_loss: 739314.4531; val_gene_expr_recon_loss: 17921824.7500; val_masked_gp_l1_reg_loss: 64515.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55299.3008; val_chrom_access_recon_loss: 873209.2891; val_global_loss: 19678346.2500; val_optim_loss: 19678346.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9329; val_auprc_score: 0.9122; val_best_acc_score: 0.8654; val_best_f1_score: 0.8713; train_kl_reg_loss: 70086.2532; train_edge_recon_loss: 705026.1061; train_gene_expr_recon_loss: 17855340.0606; train_masked_gp_l1_reg_loss: 64491.9244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55175.4116; train_chrom_access_recon_loss: 859292.6326; train_global_loss: 19609412.6061; train_optim_loss: 19609412.6061; val_kl_reg_loss: 26249.0488; val_edge_recon_loss: 739081.6172; val_gene_expr_recon_loss: 17798677.0000; val_masked_gp_l1_reg_loss: 64468.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55053.1094; val_chrom_access_recon_loss: 859081.8828; val_global_loss: 19542611.5000; val_optim_loss: 19542611.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9376; val_auprc_score: 0.9219; val_best_acc_score: 0.8662; val_best_f1_score: 0.8747; train_kl_reg_loss: 70949.6263; train_edge_recon_loss: 704699.3059; train_gene_expr_recon_loss: 17817724.9697; train_masked_gp_l1_reg_loss: 64441.5282; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54949.9773; train_chrom_access_recon_loss: 853333.0928; train_global_loss: 19566098.6061; train_optim_loss: 19566098.6061; val_kl_reg_loss: 26626.7600; val_edge_recon_loss: 739000.6250; val_gene_expr_recon_loss: 17800255.0000; val_masked_gp_l1_reg_loss: 64413.5117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54839.8594; val_chrom_access_recon_loss: 853542.0078; val_global_loss: 19538678.5000; val_optim_loss: 19538678.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9238; val_auprc_score: 0.8984; val_best_acc_score: 0.8627; val_best_f1_score: 0.8739; train_kl_reg_loss: 71152.8724; train_edge_recon_loss: 703771.6288; train_gene_expr_recon_loss: 17817816.6364; train_masked_gp_l1_reg_loss: 64384.5788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54742.9756; train_chrom_access_recon_loss: 850172.2415; train_global_loss: 19562040.7576; train_optim_loss: 19562040.7576; val_kl_reg_loss: 27389.3071; val_edge_recon_loss: 740351.2109; val_gene_expr_recon_loss: 17816433.7500; val_masked_gp_l1_reg_loss: 64353.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54646.8477; val_chrom_access_recon_loss: 852744.8047; val_global_loss: 19555919.2500; val_optim_loss: 19555919.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9274; val_auprc_score: 0.9016; val_best_acc_score: 0.8606; val_best_f1_score: 0.8707; train_kl_reg_loss: 70910.0966; train_edge_recon_loss: 702993.9470; train_gene_expr_recon_loss: 17810588.7879; train_masked_gp_l1_reg_loss: 64349.4232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54557.0313; train_chrom_access_recon_loss: 848269.4375; train_global_loss: 19551668.9091; train_optim_loss: 19551668.9091; val_kl_reg_loss: 27760.6128; val_edge_recon_loss: 741104.9375; val_gene_expr_recon_loss: 17914984.5000; val_masked_gp_l1_reg_loss: 64345.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54530.0820; val_chrom_access_recon_loss: 859988.9141; val_global_loss: 19662715.0000; val_optim_loss: 19662715.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9298; val_auprc_score: 0.9087; val_best_acc_score: 0.8662; val_best_f1_score: 0.8734; train_kl_reg_loss: 70854.1984; train_edge_recon_loss: 703087.7197; train_gene_expr_recon_loss: 17798281.1818; train_masked_gp_l1_reg_loss: 64342.1146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54518.1615; train_chrom_access_recon_loss: 846694.2614; train_global_loss: 19537777.9697; train_optim_loss: 19537777.9697; val_kl_reg_loss: 27458.3872; val_edge_recon_loss: 740179.9922; val_gene_expr_recon_loss: 17727282.0000; val_masked_gp_l1_reg_loss: 64338.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54506.9258; val_chrom_access_recon_loss: 846186.6016; val_global_loss: 19459951.0000; val_optim_loss: 19459951.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9323; val_auprc_score: 0.9089; val_best_acc_score: 0.8643; val_best_f1_score: 0.8743; train_kl_reg_loss: 70563.6423; train_edge_recon_loss: 703103.2765; train_gene_expr_recon_loss: 17788469.4242; train_masked_gp_l1_reg_loss: 64335.4506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54496.6010; train_chrom_access_recon_loss: 845677.2699; train_global_loss: 19526645.5455; train_optim_loss: 19526645.5455; val_kl_reg_loss: 27637.3796; val_edge_recon_loss: 739753.1797; val_gene_expr_recon_loss: 17727428.7500; val_masked_gp_l1_reg_loss: 64332.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54486.5703; val_chrom_access_recon_loss: 841727.3047; val_global_loss: 19455364.5000; val_optim_loss: 19455364.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9292; val_auprc_score: 0.9091; val_best_acc_score: 0.8622; val_best_f1_score: 0.8734; train_kl_reg_loss: 70675.8125; train_edge_recon_loss: 703070.5900; train_gene_expr_recon_loss: 17802260.6364; train_masked_gp_l1_reg_loss: 64328.6668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54477.0228; train_chrom_access_recon_loss: 846908.7367; train_global_loss: 19541721.6364; train_optim_loss: 19541721.6364; val_kl_reg_loss: 27923.5527; val_edge_recon_loss: 742364.5078; val_gene_expr_recon_loss: 17728090.7500; val_masked_gp_l1_reg_loss: 64325.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54467.2305; val_chrom_access_recon_loss: 849023.7188; val_global_loss: 19466196.2500; val_optim_loss: 19466196.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9247; val_auprc_score: 0.8988; val_best_acc_score: 0.8573; val_best_f1_score: 0.8691; train_kl_reg_loss: 70692.0063; train_edge_recon_loss: 702655.9631; train_gene_expr_recon_loss: 17797532.3030; train_masked_gp_l1_reg_loss: 64321.8507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54458.3853; train_chrom_access_recon_loss: 847045.0199; train_global_loss: 19536705.4242; train_optim_loss: 19536705.4242; val_kl_reg_loss: 27647.3787; val_edge_recon_loss: 740580.1875; val_gene_expr_recon_loss: 17768922.2500; val_masked_gp_l1_reg_loss: 64318.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54449.3320; val_chrom_access_recon_loss: 848331.8594; val_global_loss: 19504249.5000; val_optim_loss: 19504249.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9241; val_auprc_score: 0.8954; val_best_acc_score: 0.8606; val_best_f1_score: 0.8722; train_kl_reg_loss: 70633.2326; train_edge_recon_loss: 703376.0398; train_gene_expr_recon_loss: 17803839.5455; train_masked_gp_l1_reg_loss: 64314.9057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54440.4002; train_chrom_access_recon_loss: 846607.3116; train_global_loss: 19543211.5455; train_optim_loss: 19543211.5455; val_kl_reg_loss: 28023.7039; val_edge_recon_loss: 740418.7500; val_gene_expr_recon_loss: 17694807.7500; val_masked_gp_l1_reg_loss: 64311.2461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54431.1445; val_chrom_access_recon_loss: 859290.0391; val_global_loss: 19441284.0000; val_optim_loss: 19441284.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9264; val_auprc_score: 0.9017; val_best_acc_score: 0.8603; val_best_f1_score: 0.8720; train_kl_reg_loss: 70525.9292; train_edge_recon_loss: 703641.0038; train_gene_expr_recon_loss: 17802462.5303; train_masked_gp_l1_reg_loss: 64307.5182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54422.3703; train_chrom_access_recon_loss: 846302.4716; train_global_loss: 19541661.7576; train_optim_loss: 19541661.7576; val_kl_reg_loss: 27795.3782; val_edge_recon_loss: 741547.5938; val_gene_expr_recon_loss: 17837593.5000; val_masked_gp_l1_reg_loss: 64303.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54413.4961; val_chrom_access_recon_loss: 851781.0234; val_global_loss: 19577435.5000; val_optim_loss: 19577435.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9329; val_auprc_score: 0.9058; val_best_acc_score: 0.8643; val_best_f1_score: 0.8734; train_kl_reg_loss: 70443.2308; train_edge_recon_loss: 702898.5871; train_gene_expr_recon_loss: 17792245.0000; train_masked_gp_l1_reg_loss: 64299.9855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54404.4390; train_chrom_access_recon_loss: 844301.7358; train_global_loss: 19528592.9697; train_optim_loss: 19528592.9697; val_kl_reg_loss: 28600.2637; val_edge_recon_loss: 740713.9141; val_gene_expr_recon_loss: 17861157.7500; val_masked_gp_l1_reg_loss: 64296.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54395.5820; val_chrom_access_recon_loss: 849936.0547; val_global_loss: 19599099.7500; val_optim_loss: 19599099.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9324; val_auprc_score: 0.9099; val_best_acc_score: 0.8608; val_best_f1_score: 0.8722; train_kl_reg_loss: 70517.8280; train_edge_recon_loss: 702706.9981; train_gene_expr_recon_loss: 17807409.5455; train_masked_gp_l1_reg_loss: 64292.2754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54387.4296; train_chrom_access_recon_loss: 845974.0294; train_global_loss: 19545288.3030; train_optim_loss: 19545288.3030; val_kl_reg_loss: 28003.4229; val_edge_recon_loss: 742556.2812; val_gene_expr_recon_loss: 17770581.5000; val_masked_gp_l1_reg_loss: 64288.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54378.7578; val_chrom_access_recon_loss: 851738.0859; val_global_loss: 19511545.5000; val_optim_loss: 19511545.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9282; val_auprc_score: 0.9092; val_best_acc_score: 0.8622; val_best_f1_score: 0.8736; train_kl_reg_loss: 70535.1914; train_edge_recon_loss: 702293.1269; train_gene_expr_recon_loss: 17790985.9697; train_masked_gp_l1_reg_loss: 64284.2823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54370.2023; train_chrom_access_recon_loss: 845146.8939; train_global_loss: 19527615.7273; train_optim_loss: 19527615.7273; val_kl_reg_loss: 27841.7688; val_edge_recon_loss: 741274.7891; val_gene_expr_recon_loss: 17767552.0000; val_masked_gp_l1_reg_loss: 64280.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54361.1562; val_chrom_access_recon_loss: 844367.5234; val_global_loss: 19499678.0000; val_optim_loss: 19499678.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9350; val_auprc_score: 0.9161; val_best_acc_score: 0.8702; val_best_f1_score: 0.8797; train_kl_reg_loss: 70552.0421; train_edge_recon_loss: 702762.3286; train_gene_expr_recon_loss: 17800463.6970; train_masked_gp_l1_reg_loss: 64279.4833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54351.5444; train_chrom_access_recon_loss: 845305.4991; train_global_loss: 19537715.1515; train_optim_loss: 19537715.1515; val_kl_reg_loss: 28444.7554; val_edge_recon_loss: 739262.4922; val_gene_expr_recon_loss: 17831851.2500; val_masked_gp_l1_reg_loss: 64278.9961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54348.7617; val_chrom_access_recon_loss: 854511.8203; val_global_loss: 19572696.2500; val_optim_loss: 19572696.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9271; val_auprc_score: 0.8990; val_best_acc_score: 0.8606; val_best_f1_score: 0.8700; train_kl_reg_loss: 70498.2421; train_edge_recon_loss: 701754.1316; train_gene_expr_recon_loss: 17786988.6061; train_masked_gp_l1_reg_loss: 64278.5500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54347.6513; train_chrom_access_recon_loss: 844377.5492; train_global_loss: 19522243.8485; train_optim_loss: 19522243.8485; val_kl_reg_loss: 27849.4373; val_edge_recon_loss: 740617.9297; val_gene_expr_recon_loss: 17772475.0000; val_masked_gp_l1_reg_loss: 64278.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54346.5469; val_chrom_access_recon_loss: 846335.4297; val_global_loss: 19505902.0000; val_optim_loss: 19505902.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9328; val_auprc_score: 0.9136; val_best_acc_score: 0.8627; val_best_f1_score: 0.8737; train_kl_reg_loss: 70449.9086; train_edge_recon_loss: 702026.7169; train_gene_expr_recon_loss: 17790660.5909; train_masked_gp_l1_reg_loss: 64277.6474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54345.5724; train_chrom_access_recon_loss: 845017.0360; train_global_loss: 19526777.7273; train_optim_loss: 19526777.7273; val_kl_reg_loss: 28055.8723; val_edge_recon_loss: 741674.4688; val_gene_expr_recon_loss: 17774301.0000; val_masked_gp_l1_reg_loss: 64277.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54344.5664; val_chrom_access_recon_loss: 845118.7578; val_global_loss: 19507772.2500; val_optim_loss: 19507772.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9332; val_auprc_score: 0.9093; val_best_acc_score: 0.8665; val_best_f1_score: 0.8769; train_kl_reg_loss: 70526.9924; train_edge_recon_loss: 702062.0265; train_gene_expr_recon_loss: 17791172.0606; train_masked_gp_l1_reg_loss: 64276.7624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54343.6316; train_chrom_access_recon_loss: 844248.2472; train_global_loss: 19526629.4242; train_optim_loss: 19526629.4242; val_kl_reg_loss: 28036.5342; val_edge_recon_loss: 741207.9219; val_gene_expr_recon_loss: 17741086.5000; val_masked_gp_l1_reg_loss: 64276.3008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54342.6367; val_chrom_access_recon_loss: 844160.1250; val_global_loss: 19473108.7500; val_optim_loss: 19473108.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 42 sec.
Using best model state, which was in epoch 40.

--- MODEL EVALUATION ---
val AUROC score: 0.9349
val AUPRC score: 0.9157
val best accuracy score: 0.8646
val best F1 score: 0.8754
val target rna MSE score: 2.1297
val source rna MSE score: 3.0854
val target atac MSE score: 0.5735
val source atac MSE score: 0.3230
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
