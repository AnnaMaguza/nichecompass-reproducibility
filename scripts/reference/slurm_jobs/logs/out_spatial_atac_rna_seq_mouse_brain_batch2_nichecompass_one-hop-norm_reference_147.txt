[True]
Run timestamp: 29072023_132418_147.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_147']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8926; val_auprc_score: 0.9056; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2500.0731; train_edge_recon_loss: 34704083.1111; train_gene_expr_recon_loss: 75857168.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1900998.3750; train_global_loss: 112464748.4444; train_optim_loss: 112464748.4444; val_kl_reg_loss: 4429.0063; val_edge_recon_loss: 40651512.0000; val_gene_expr_recon_loss: 68106256.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1730345.5000; val_global_loss: 110492536.0000; val_optim_loss: 110492536.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9107; val_auprc_score: 0.9195; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 27493.0894; train_edge_recon_loss: 34797485.3333; train_gene_expr_recon_loss: 64490848.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1817739.8056; train_global_loss: 101133568.0000; train_optim_loss: 101133568.0000; val_kl_reg_loss: 26953.7109; val_edge_recon_loss: 40659200.0000; val_gene_expr_recon_loss: 61800548.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1790836.5000; val_global_loss: 104277544.0000; val_optim_loss: 104277544.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8942; val_auprc_score: 0.9101; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 71311.0304; train_edge_recon_loss: 34789978.2222; train_gene_expr_recon_loss: 60576787.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1793562.0833; train_global_loss: 97231640.8889; train_optim_loss: 97231640.8889; val_kl_reg_loss: 78271.2188; val_edge_recon_loss: 40658772.0000; val_gene_expr_recon_loss: 58438056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1746328.5000; val_global_loss: 100921432.0000; val_optim_loss: 100921432.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8825; val_auprc_score: 0.8944; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 163730.7569; train_edge_recon_loss: 34776861.3333; train_gene_expr_recon_loss: 57321738.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1768959.4306; train_global_loss: 94031288.8889; train_optim_loss: 94031288.8889; val_kl_reg_loss: 132882.2188; val_edge_recon_loss: 40658452.0000; val_gene_expr_recon_loss: 54959456.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1728041.3750; val_global_loss: 97478832.0000; val_optim_loss: 97478832.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8813; val_auprc_score: 0.8898; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 226638.2578; train_edge_recon_loss: 34769409.3333; train_gene_expr_recon_loss: 53526166.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1743077.8194; train_global_loss: 90265292.4444; train_optim_loss: 90265292.4444; val_kl_reg_loss: 231460.9531; val_edge_recon_loss: 40658204.0000; val_gene_expr_recon_loss: 51895872.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1718222.2500; val_global_loss: 94503760.0000; val_optim_loss: 94503760.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8764; val_auprc_score: 0.8825; val_best_acc_score: 0.5027; val_best_f1_score: 0.6679; train_kl_reg_loss: 263734.0347; train_edge_recon_loss: 34797046.2222; train_gene_expr_recon_loss: 50543485.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1714638.6111; train_global_loss: 87318905.7778; train_optim_loss: 87318905.7778; val_kl_reg_loss: 240862.2188; val_edge_recon_loss: 40657164.0000; val_gene_expr_recon_loss: 49287712.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1681236.0000; val_global_loss: 91866976.0000; val_optim_loss: 91866976.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8721; val_auprc_score: 0.8814; val_best_acc_score: 0.5051; val_best_f1_score: 0.6689; train_kl_reg_loss: 287875.6406; train_edge_recon_loss: 34810792.4444; train_gene_expr_recon_loss: 48298382.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1688340.2778; train_global_loss: 85085390.2222; train_optim_loss: 85085390.2222; val_kl_reg_loss: 221539.4688; val_edge_recon_loss: 40655828.0000; val_gene_expr_recon_loss: 47135808.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1657105.2500; val_global_loss: 89670280.0000; val_optim_loss: 89670280.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8705; val_auprc_score: 0.8754; val_best_acc_score: 0.5090; val_best_f1_score: 0.6707; train_kl_reg_loss: 312308.3333; train_edge_recon_loss: 34836706.6667; train_gene_expr_recon_loss: 46171039.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1670896.6111; train_global_loss: 82990952.0000; train_optim_loss: 82990952.0000; val_kl_reg_loss: 239396.6250; val_edge_recon_loss: 40653412.0000; val_gene_expr_recon_loss: 45205916.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1642073.7500; val_global_loss: 87740792.0000; val_optim_loss: 87740792.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8652; val_auprc_score: 0.8736; val_best_acc_score: 0.5163; val_best_f1_score: 0.6739; train_kl_reg_loss: 322556.2153; train_edge_recon_loss: 34819492.0000; train_gene_expr_recon_loss: 44387952.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1651109.7639; train_global_loss: 81181109.3333; train_optim_loss: 81181109.3333; val_kl_reg_loss: 224408.3281; val_edge_recon_loss: 40648464.0000; val_gene_expr_recon_loss: 43632952.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1617859.5000; val_global_loss: 86123680.0000; val_optim_loss: 86123680.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8545; val_auprc_score: 0.8628; val_best_acc_score: 0.5221; val_best_f1_score: 0.6764; train_kl_reg_loss: 309874.3177; train_edge_recon_loss: 34854688.4444; train_gene_expr_recon_loss: 43103084.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1630432.4028; train_global_loss: 79898080.0000; train_optim_loss: 79898080.0000; val_kl_reg_loss: 237266.5625; val_edge_recon_loss: 40643244.0000; val_gene_expr_recon_loss: 42418304.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1601111.0000; val_global_loss: 84899928.0000; val_optim_loss: 84899928.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8536; val_auprc_score: 0.8598; val_best_acc_score: 0.5243; val_best_f1_score: 0.6773; train_kl_reg_loss: 292326.1354; train_edge_recon_loss: 34849748.8889; train_gene_expr_recon_loss: 41962293.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1613299.8889; train_global_loss: 78717666.6667; train_optim_loss: 78717666.6667; val_kl_reg_loss: 248159.5469; val_edge_recon_loss: 40639660.0000; val_gene_expr_recon_loss: 41415320.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1584619.2500; val_global_loss: 83887752.0000; val_optim_loss: 83887752.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8445; val_auprc_score: 0.8473; val_best_acc_score: 0.5300; val_best_f1_score: 0.6796; train_kl_reg_loss: 308643.3733; train_edge_recon_loss: 34822444.0000; train_gene_expr_recon_loss: 40832446.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1592485.0694; train_global_loss: 77556018.6667; train_optim_loss: 77556018.6667; val_kl_reg_loss: 213203.1562; val_edge_recon_loss: 40634912.0000; val_gene_expr_recon_loss: 40709556.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1571708.7500; val_global_loss: 83129384.0000; val_optim_loss: 83129384.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8443; val_auprc_score: 0.8436; val_best_acc_score: 0.5393; val_best_f1_score: 0.6838; train_kl_reg_loss: 289284.2344; train_edge_recon_loss: 34843474.6667; train_gene_expr_recon_loss: 40263655.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1585409.1528; train_global_loss: 76981822.2222; train_optim_loss: 76981822.2222; val_kl_reg_loss: 250442.3906; val_edge_recon_loss: 40628700.0000; val_gene_expr_recon_loss: 40042856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1559079.2500; val_global_loss: 82481080.0000; val_optim_loss: 82481080.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8487; val_auprc_score: 0.8534; val_best_acc_score: 0.5486; val_best_f1_score: 0.6880; train_kl_reg_loss: 291517.8212; train_edge_recon_loss: 34828051.5556; train_gene_expr_recon_loss: 39893720.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1569182.1806; train_global_loss: 76582472.8889; train_optim_loss: 76582472.8889; val_kl_reg_loss: 230714.0156; val_edge_recon_loss: 40624128.0000; val_gene_expr_recon_loss: 39703952.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1553916.7500; val_global_loss: 82112720.0000; val_optim_loss: 82112720.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8475; val_auprc_score: 0.8524; val_best_acc_score: 0.5745; val_best_f1_score: 0.6995; train_kl_reg_loss: 281927.6528; train_edge_recon_loss: 34852388.0000; train_gene_expr_recon_loss: 39301980.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1564526.3750; train_global_loss: 76000823.1111; train_optim_loss: 76000823.1111; val_kl_reg_loss: 225505.9844; val_edge_recon_loss: 40609548.0000; val_gene_expr_recon_loss: 39440048.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1547736.6250; val_global_loss: 81822840.0000; val_optim_loss: 81822840.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8383; val_auprc_score: 0.8374; val_best_acc_score: 0.6012; val_best_f1_score: 0.7123; train_kl_reg_loss: 273939.1562; train_edge_recon_loss: 34847596.8889; train_gene_expr_recon_loss: 39436711.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1562581.4028; train_global_loss: 76120828.4444; train_optim_loss: 76120828.4444; val_kl_reg_loss: 218651.8438; val_edge_recon_loss: 40596372.0000; val_gene_expr_recon_loss: 39072952.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1540180.3750; val_global_loss: 81428160.0000; val_optim_loss: 81428160.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8456; val_auprc_score: 0.8401; val_best_acc_score: 0.6254; val_best_f1_score: 0.7242; train_kl_reg_loss: 271558.1753; train_edge_recon_loss: 34811596.8889; train_gene_expr_recon_loss: 38756238.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1543931.1528; train_global_loss: 75383326.2222; train_optim_loss: 75383326.2222; val_kl_reg_loss: 220790.9688; val_edge_recon_loss: 40581416.0000; val_gene_expr_recon_loss: 38978864.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1539345.7500; val_global_loss: 81320416.0000; val_optim_loss: 81320416.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8438; val_auprc_score: 0.8357; val_best_acc_score: 0.6469; val_best_f1_score: 0.7343; train_kl_reg_loss: 261265.1406; train_edge_recon_loss: 34829074.6667; train_gene_expr_recon_loss: 38717572.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1557536.5694; train_global_loss: 75365450.6667; train_optim_loss: 75365450.6667; val_kl_reg_loss: 200334.8750; val_edge_recon_loss: 40558888.0000; val_gene_expr_recon_loss: 38836768.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1535473.7500; val_global_loss: 81131464.0000; val_optim_loss: 81131464.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8489; val_auprc_score: 0.8418; val_best_acc_score: 0.6776; val_best_f1_score: 0.7498; train_kl_reg_loss: 258413.5312; train_edge_recon_loss: 34810609.7778; train_gene_expr_recon_loss: 38921967.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1558160.1389; train_global_loss: 75549151.1111; train_optim_loss: 75549151.1111; val_kl_reg_loss: 195015.0625; val_edge_recon_loss: 40523280.0000; val_gene_expr_recon_loss: 38643848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1531572.1250; val_global_loss: 80893720.0000; val_optim_loss: 80893720.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8409; val_auprc_score: 0.8281; val_best_acc_score: 0.6915; val_best_f1_score: 0.7563; train_kl_reg_loss: 253798.7465; train_edge_recon_loss: 34813719.1111; train_gene_expr_recon_loss: 38526106.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1544506.7222; train_global_loss: 75138131.5556; train_optim_loss: 75138131.5556; val_kl_reg_loss: 178668.3750; val_edge_recon_loss: 40490448.0000; val_gene_expr_recon_loss: 38612848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1530266.7500; val_global_loss: 80812232.0000; val_optim_loss: 80812232.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8404; val_auprc_score: 0.8274; val_best_acc_score: 0.7083; val_best_f1_score: 0.7642; train_kl_reg_loss: 246421.6094; train_edge_recon_loss: 34815098.6667; train_gene_expr_recon_loss: 38760132.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1555349.0833; train_global_loss: 75377001.7778; train_optim_loss: 75377001.7778; val_kl_reg_loss: 184886.4219; val_edge_recon_loss: 40444816.0000; val_gene_expr_recon_loss: 38497292.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1528030.5000; val_global_loss: 80655024.0000; val_optim_loss: 80655024.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8435; val_auprc_score: 0.8311; val_best_acc_score: 0.7300; val_best_f1_score: 0.7745; train_kl_reg_loss: 236229.6875; train_edge_recon_loss: 34798646.6667; train_gene_expr_recon_loss: 38034633.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1534149.6389; train_global_loss: 74603659.5556; train_optim_loss: 74603659.5556; val_kl_reg_loss: 209050.6562; val_edge_recon_loss: 40410652.0000; val_gene_expr_recon_loss: 38420288.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1526641.7500; val_global_loss: 80566632.0000; val_optim_loss: 80566632.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8437; val_auprc_score: 0.8305; val_best_acc_score: 0.7458; val_best_f1_score: 0.7787; train_kl_reg_loss: 228635.6319; train_edge_recon_loss: 34800541.3333; train_gene_expr_recon_loss: 38374500.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1540285.5139; train_global_loss: 74943964.4444; train_optim_loss: 74943964.4444; val_kl_reg_loss: 160738.9219; val_edge_recon_loss: 40310292.0000; val_gene_expr_recon_loss: 38354960.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1523818.3750; val_global_loss: 80349808.0000; val_optim_loss: 80349808.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8454; val_auprc_score: 0.8329; val_best_acc_score: 0.7625; val_best_f1_score: 0.7865; train_kl_reg_loss: 231238.2188; train_edge_recon_loss: 34788131.1111; train_gene_expr_recon_loss: 38540932.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1542449.8194; train_global_loss: 75102752.8889; train_optim_loss: 75102752.8889; val_kl_reg_loss: 168427.6562; val_edge_recon_loss: 40255288.0000; val_gene_expr_recon_loss: 38278508.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1524169.1250; val_global_loss: 80226392.0000; val_optim_loss: 80226392.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8436; val_auprc_score: 0.8239; val_best_acc_score: 0.7679; val_best_f1_score: 0.7858; train_kl_reg_loss: 216584.2378; train_edge_recon_loss: 34781941.3333; train_gene_expr_recon_loss: 38133640.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1538702.9583; train_global_loss: 74670873.7778; train_optim_loss: 74670873.7778; val_kl_reg_loss: 177054.5469; val_edge_recon_loss: 40160476.0000; val_gene_expr_recon_loss: 38174940.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1521141.2500; val_global_loss: 80033616.0000; val_optim_loss: 80033616.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8651; val_auprc_score: 0.8427; val_best_acc_score: 0.7909; val_best_f1_score: 0.7953; train_kl_reg_loss: 287100.6701; train_edge_recon_loss: 35875839.5556; train_gene_expr_recon_loss: 38771696.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1536944.4028; train_global_loss: 76471585.7778; train_optim_loss: 76471585.7778; val_kl_reg_loss: 85646.0938; val_edge_recon_loss: 39891832.0000; val_gene_expr_recon_loss: 39856672.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1534001.7500; val_global_loss: 81368152.0000; val_optim_loss: 81368152.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8579; val_auprc_score: 0.8463; val_best_acc_score: 0.7467; val_best_f1_score: 0.7832; train_kl_reg_loss: 123188.4620; train_edge_recon_loss: 35484181.7778; train_gene_expr_recon_loss: 40896081.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1563041.2500; train_global_loss: 78066494.2222; train_optim_loss: 78066494.2222; val_kl_reg_loss: 284814.5625; val_edge_recon_loss: 40155400.0000; val_gene_expr_recon_loss: 40187976.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1536143.3750; val_global_loss: 82164336.0000; val_optim_loss: 82164336.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8583; val_auprc_score: 0.8417; val_best_acc_score: 0.7773; val_best_f1_score: 0.7965; train_kl_reg_loss: 120350.7936; train_edge_recon_loss: 35054208.8889; train_gene_expr_recon_loss: 40911999.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1581412.0556; train_global_loss: 77667970.6667; train_optim_loss: 77667970.6667; val_kl_reg_loss: 81452.6719; val_edge_recon_loss: 40030224.0000; val_gene_expr_recon_loss: 39205232.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1536451.5000; val_global_loss: 80853360.0000; val_optim_loss: 80853360.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8564; val_auprc_score: 0.8351; val_best_acc_score: 0.7763; val_best_f1_score: 0.7921; train_kl_reg_loss: 55492.1656; train_edge_recon_loss: 35020670.2222; train_gene_expr_recon_loss: 40467870.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1564162.8056; train_global_loss: 77108194.6667; train_optim_loss: 77108194.6667; val_kl_reg_loss: 116450.0625; val_edge_recon_loss: 40020560.0000; val_gene_expr_recon_loss: 39082680.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1532814.2500; val_global_loss: 80752512.0000; val_optim_loss: 80752512.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8546; val_auprc_score: 0.8353; val_best_acc_score: 0.7755; val_best_f1_score: 0.7893; train_kl_reg_loss: 105581.5747; train_edge_recon_loss: 34853486.6667; train_gene_expr_recon_loss: 39238229.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1547524.3611; train_global_loss: 75744819.5556; train_optim_loss: 75744819.5556; val_kl_reg_loss: 79449.7656; val_edge_recon_loss: 39976452.0000; val_gene_expr_recon_loss: 39001908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1532587.5000; val_global_loss: 80590392.0000; val_optim_loss: 80590392.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8608; val_auprc_score: 0.8419; val_best_acc_score: 0.7821; val_best_f1_score: 0.7934; train_kl_reg_loss: 78415.1832; train_edge_recon_loss: 34902115.1111; train_gene_expr_recon_loss: 38935116.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1549402.0556; train_global_loss: 75465047.1111; train_optim_loss: 75465047.1111; val_kl_reg_loss: 72551.3203; val_edge_recon_loss: 39900452.0000; val_gene_expr_recon_loss: 38866992.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1527957.5000; val_global_loss: 80367960.0000; val_optim_loss: 80367960.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8602; val_auprc_score: 0.8370; val_best_acc_score: 0.7793; val_best_f1_score: 0.7918; train_kl_reg_loss: 83625.6094; train_edge_recon_loss: 34883672.0000; train_gene_expr_recon_loss: 38775792.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1549092.9861; train_global_loss: 75292183.1111; train_optim_loss: 75292183.1111; val_kl_reg_loss: 89729.9297; val_edge_recon_loss: 39917268.0000; val_gene_expr_recon_loss: 38844616.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1530832.3750; val_global_loss: 80382448.0000; val_optim_loss: 80382448.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8619; val_auprc_score: 0.8460; val_best_acc_score: 0.7824; val_best_f1_score: 0.7943; train_kl_reg_loss: 101944.3628; train_edge_recon_loss: 34872517.7778; train_gene_expr_recon_loss: 38855923.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1546588.4583; train_global_loss: 75376973.3333; train_optim_loss: 75376973.3333; val_kl_reg_loss: 98784.9375; val_edge_recon_loss: 39932848.0000; val_gene_expr_recon_loss: 38726060.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1526845.2500; val_global_loss: 80284544.0000; val_optim_loss: 80284544.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 40 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.8433
val AUPRC score: 0.8216
val best accuracy score: 0.7568
val best F1 score: 0.7841
val target rna MSE score: 2.9286
val source rna MSE score: 0.6486
val target atac MSE score: 0.1231
val source atac MSE score: 0.0337
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
