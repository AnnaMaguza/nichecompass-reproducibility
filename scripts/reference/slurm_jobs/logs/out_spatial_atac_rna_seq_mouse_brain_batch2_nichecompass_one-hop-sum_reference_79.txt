[True]
Run timestamp: 10082023_223206_79.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_79']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7565; val_auprc_score: 0.7893; val_best_acc_score: 0.5294; val_best_f1_score: 0.6733; train_kl_reg_loss: 232011.5353; train_edge_recon_loss: 3970920.4542; train_gene_expr_recon_loss: 48366196.0305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 76834149.3130; train_global_loss: 129403277.2519; train_optim_loss: 129403277.2519; val_kl_reg_loss: 211442.1167; val_edge_recon_loss: 4062456.5333; val_gene_expr_recon_loss: 39573145.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 70165880.2667; val_global_loss: 114012925.8667; val_optim_loss: 114012925.8667
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7979; val_auprc_score: 0.8141; val_best_acc_score: 0.7175; val_best_f1_score: 0.7072; train_kl_reg_loss: 204937.9172; train_edge_recon_loss: 3925143.6469; train_gene_expr_recon_loss: 38745023.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 69760510.1679; train_global_loss: 112635614.9618; train_optim_loss: 112635614.9618; val_kl_reg_loss: 235745.6781; val_edge_recon_loss: 4031391.2000; val_gene_expr_recon_loss: 37706538.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 68779935.4667; val_global_loss: 110753609.6000; val_optim_loss: 110753609.6000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8077; val_auprc_score: 0.8164; val_best_acc_score: 0.7154; val_best_f1_score: 0.7439; train_kl_reg_loss: 179841.6928; train_edge_recon_loss: 3807401.0115; train_gene_expr_recon_loss: 37716084.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 69101989.8931; train_global_loss: 110805317.4351; train_optim_loss: 110805317.4351; val_kl_reg_loss: 232124.2260; val_edge_recon_loss: 3806791.9167; val_gene_expr_recon_loss: 36957782.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67858185.6000; val_global_loss: 108854884.8000; val_optim_loss: 108854884.8000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8604; val_auprc_score: 0.8530; val_best_acc_score: 0.7641; val_best_f1_score: 0.7829; train_kl_reg_loss: 225519.6927; train_edge_recon_loss: 3358101.1298; train_gene_expr_recon_loss: 36832749.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 68565658.7786; train_global_loss: 108982029.6794; train_optim_loss: 108982029.6794; val_kl_reg_loss: 262156.7208; val_edge_recon_loss: 3188430.8500; val_gene_expr_recon_loss: 36424025.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67173070.4000; val_global_loss: 107047683.2000; val_optim_loss: 107047683.2000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8742; val_auprc_score: 0.8612; val_best_acc_score: 0.7889; val_best_f1_score: 0.7996; train_kl_reg_loss: 264560.4216; train_edge_recon_loss: 3108596.4523; train_gene_expr_recon_loss: 36489922.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 68070627.7252; train_global_loss: 107933707.1145; train_optim_loss: 107933707.1145; val_kl_reg_loss: 262692.1813; val_edge_recon_loss: 3096838.8500; val_gene_expr_recon_loss: 36446677.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 67380252.8000; val_global_loss: 107186461.8667; val_optim_loss: 107186461.8667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8872; val_auprc_score: 0.8746; val_best_acc_score: 0.8014; val_best_f1_score: 0.8145; train_kl_reg_loss: 248271.5549; train_edge_recon_loss: 3064075.0916; train_gene_expr_recon_loss: 36253506.5954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67754985.7099; train_global_loss: 107320838.7176; train_optim_loss: 107320838.7176; val_kl_reg_loss: 237210.1187; val_edge_recon_loss: 3052955.6500; val_gene_expr_recon_loss: 36154561.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66842411.7333; val_global_loss: 106287137.0667; val_optim_loss: 106287137.0667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9011; val_auprc_score: 0.8876; val_best_acc_score: 0.8169; val_best_f1_score: 0.8287; train_kl_reg_loss: 231781.2586; train_edge_recon_loss: 3018666.1698; train_gene_expr_recon_loss: 36023464.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67350941.9542; train_global_loss: 106624853.9847; train_optim_loss: 106624853.9847; val_kl_reg_loss: 223184.0625; val_edge_recon_loss: 3006401.8333; val_gene_expr_recon_loss: 35932746.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66580283.7333; val_global_loss: 105742616.5333; val_optim_loss: 105742616.5333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9089; val_auprc_score: 0.8928; val_best_acc_score: 0.8294; val_best_f1_score: 0.8429; train_kl_reg_loss: 220722.1217; train_edge_recon_loss: 2976388.5076; train_gene_expr_recon_loss: 35846785.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 67063048.1527; train_global_loss: 106106944.3053; train_optim_loss: 106106944.3053; val_kl_reg_loss: 215343.5052; val_edge_recon_loss: 2975709.4667; val_gene_expr_recon_loss: 35781139.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66327370.4000; val_global_loss: 105299563.7333; val_optim_loss: 105299563.7333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9178; val_auprc_score: 0.9023; val_best_acc_score: 0.8428; val_best_f1_score: 0.8539; train_kl_reg_loss: 212030.4606; train_edge_recon_loss: 2952342.0057; train_gene_expr_recon_loss: 35697133.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66785075.2061; train_global_loss: 105646581.9847; train_optim_loss: 105646581.9847; val_kl_reg_loss: 206233.7844; val_edge_recon_loss: 2946752.9833; val_gene_expr_recon_loss: 35604894.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66033726.6667; val_global_loss: 104791608.0000; val_optim_loss: 104791608.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9170; val_auprc_score: 0.9007; val_best_acc_score: 0.8436; val_best_f1_score: 0.8539; train_kl_reg_loss: 204129.6856; train_edge_recon_loss: 2951605.0229; train_gene_expr_recon_loss: 35697748.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66492931.3893; train_global_loss: 105346414.4122; train_optim_loss: 105346414.4122; val_kl_reg_loss: 202636.8667; val_edge_recon_loss: 2949466.4333; val_gene_expr_recon_loss: 35677881.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 66060180.5333; val_global_loss: 104890164.8000; val_optim_loss: 104890164.8000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9220; val_auprc_score: 0.9074; val_best_acc_score: 0.8510; val_best_f1_score: 0.8591; train_kl_reg_loss: 209276.1452; train_edge_recon_loss: 2914811.9523; train_gene_expr_recon_loss: 35555948.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 66306202.3511; train_global_loss: 104986239.2672; train_optim_loss: 104986239.2672; val_kl_reg_loss: 182331.6083; val_edge_recon_loss: 2969749.3333; val_gene_expr_recon_loss: 35519432.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65605152.8000; val_global_loss: 104276666.1333; val_optim_loss: 104276666.1333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9275; val_auprc_score: 0.9097; val_best_acc_score: 0.8599; val_best_f1_score: 0.8705; train_kl_reg_loss: 195660.3962; train_edge_recon_loss: 2905169.5344; train_gene_expr_recon_loss: 35387184.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65995758.6870; train_global_loss: 104483773.4351; train_optim_loss: 104483773.4351; val_kl_reg_loss: 197908.8052; val_edge_recon_loss: 2885476.7667; val_gene_expr_recon_loss: 35173674.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65245034.6667; val_global_loss: 103502095.4667; val_optim_loss: 103502095.4667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9314; val_auprc_score: 0.9169; val_best_acc_score: 0.8632; val_best_f1_score: 0.8727; train_kl_reg_loss: 197080.7764; train_edge_recon_loss: 2867944.3092; train_gene_expr_recon_loss: 35180318.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65770003.0840; train_global_loss: 104015347.2977; train_optim_loss: 104015347.2977; val_kl_reg_loss: 191468.6208; val_edge_recon_loss: 2898567.2167; val_gene_expr_recon_loss: 35136295.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64942352.8000; val_global_loss: 103168684.8000; val_optim_loss: 103168684.8000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9360; val_auprc_score: 0.9230; val_best_acc_score: 0.8666; val_best_f1_score: 0.8762; train_kl_reg_loss: 190439.3569; train_edge_recon_loss: 2870601.7767; train_gene_expr_recon_loss: 35073601.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65498286.7176; train_global_loss: 103632928.8550; train_optim_loss: 103632928.8550; val_kl_reg_loss: 186591.4479; val_edge_recon_loss: 2863090.7333; val_gene_expr_recon_loss: 35151085.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 65227408.8000; val_global_loss: 103428176.0000; val_optim_loss: 103428176.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9389; val_auprc_score: 0.9245; val_best_acc_score: 0.8732; val_best_f1_score: 0.8808; train_kl_reg_loss: 186137.9827; train_edge_recon_loss: 2847973.5668; train_gene_expr_recon_loss: 34992480.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65335952.6718; train_global_loss: 103362545.1603; train_optim_loss: 103362545.1603; val_kl_reg_loss: 180961.5875; val_edge_recon_loss: 2851788.5167; val_gene_expr_recon_loss: 35045560.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64521061.8667; val_global_loss: 102599372.2667; val_optim_loss: 102599372.2667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9419; val_auprc_score: 0.9308; val_best_acc_score: 0.8764; val_best_f1_score: 0.8844; train_kl_reg_loss: 179819.1546; train_edge_recon_loss: 2843796.1966; train_gene_expr_recon_loss: 34932910.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 65295985.1908; train_global_loss: 103252510.7176; train_optim_loss: 103252510.7176; val_kl_reg_loss: 173963.4458; val_edge_recon_loss: 2848053.9667; val_gene_expr_recon_loss: 34976405.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64803271.2000; val_global_loss: 102801692.8000; val_optim_loss: 102801692.8000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9498; val_auprc_score: 0.9399; val_best_acc_score: 0.8851; val_best_f1_score: 0.8924; train_kl_reg_loss: 175030.3404; train_edge_recon_loss: 2827785.1947; train_gene_expr_recon_loss: 34820305.4198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64970801.3130; train_global_loss: 102793922.3206; train_optim_loss: 102793922.3206; val_kl_reg_loss: 168975.6958; val_edge_recon_loss: 2833342.1500; val_gene_expr_recon_loss: 34695602.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64016297.3333; val_global_loss: 101714217.0667; val_optim_loss: 101714217.0667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9501; val_auprc_score: 0.9392; val_best_acc_score: 0.8835; val_best_f1_score: 0.8902; train_kl_reg_loss: 169932.7532; train_edge_recon_loss: 2824629.7176; train_gene_expr_recon_loss: 34783941.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64987173.5267; train_global_loss: 102765677.4351; train_optim_loss: 102765677.4351; val_kl_reg_loss: 167865.3094; val_edge_recon_loss: 2842667.5167; val_gene_expr_recon_loss: 34851753.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64483989.8667; val_global_loss: 102346276.8000; val_optim_loss: 102346276.8000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9521; val_auprc_score: 0.9436; val_best_acc_score: 0.8868; val_best_f1_score: 0.8939; train_kl_reg_loss: 164975.3136; train_edge_recon_loss: 2820695.9504; train_gene_expr_recon_loss: 34905013.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64887148.4580; train_global_loss: 102777832.9771; train_optim_loss: 102777832.9771; val_kl_reg_loss: 166562.1250; val_edge_recon_loss: 2813355.7000; val_gene_expr_recon_loss: 34808437.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64188535.2000; val_global_loss: 101976889.6000; val_optim_loss: 101976889.6000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9419; val_auprc_score: 0.9300; val_best_acc_score: 0.8770; val_best_f1_score: 0.8862; train_kl_reg_loss: 157643.4969; train_edge_recon_loss: 2834896.2042; train_gene_expr_recon_loss: 34959707.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64761176.0916; train_global_loss: 102713423.5725; train_optim_loss: 102713423.5725; val_kl_reg_loss: 142609.0042; val_edge_recon_loss: 2866403.0333; val_gene_expr_recon_loss: 34688666.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 63567341.0667; val_global_loss: 101265018.6667; val_optim_loss: 101265018.6667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9505; val_auprc_score: 0.9392; val_best_acc_score: 0.8899; val_best_f1_score: 0.8960; train_kl_reg_loss: 159782.5104; train_edge_recon_loss: 2817996.3531; train_gene_expr_recon_loss: 34638294.6870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64667250.8397; train_global_loss: 102283324.6412; train_optim_loss: 102283324.6412; val_kl_reg_loss: 158530.0573; val_edge_recon_loss: 2816759.9167; val_gene_expr_recon_loss: 34583538.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 63873731.2000; val_global_loss: 101432560.0000; val_optim_loss: 101432560.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9505; val_auprc_score: 0.9394; val_best_acc_score: 0.8856; val_best_f1_score: 0.8922; train_kl_reg_loss: 162361.8491; train_edge_recon_loss: 2799132.5687; train_gene_expr_recon_loss: 34571645.9542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64613368.2748; train_global_loss: 102146508.7023; train_optim_loss: 102146508.7023; val_kl_reg_loss: 158294.8188; val_edge_recon_loss: 2829455.1000; val_gene_expr_recon_loss: 34665499.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64041274.9333; val_global_loss: 101694523.2000; val_optim_loss: 101694523.2000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9536; val_auprc_score: 0.9443; val_best_acc_score: 0.8902; val_best_f1_score: 0.8958; train_kl_reg_loss: 158112.1697; train_edge_recon_loss: 2795110.6851; train_gene_expr_recon_loss: 34500017.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64479844.7939; train_global_loss: 101933084.7023; train_optim_loss: 101933084.7023; val_kl_reg_loss: 157153.7760; val_edge_recon_loss: 2812415.3667; val_gene_expr_recon_loss: 34648150.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64005119.2000; val_global_loss: 101622839.4667; val_optim_loss: 101622839.4667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9560; val_auprc_score: 0.9472; val_best_acc_score: 0.8918; val_best_f1_score: 0.8987; train_kl_reg_loss: 155498.5360; train_edge_recon_loss: 2792447.7977; train_gene_expr_recon_loss: 34444765.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64441025.9237; train_global_loss: 101833738.0153; train_optim_loss: 101833738.0153; val_kl_reg_loss: 151962.8719; val_edge_recon_loss: 2801919.8000; val_gene_expr_recon_loss: 34622983.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64060105.3333; val_global_loss: 101636971.7333; val_optim_loss: 101636971.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9602; val_auprc_score: 0.9538; val_best_acc_score: 0.8975; val_best_f1_score: 0.9018; train_kl_reg_loss: 153745.4094; train_edge_recon_loss: 2788822.6164; train_gene_expr_recon_loss: 34406456.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64351579.9389; train_global_loss: 101700604.2748; train_optim_loss: 101700604.2748; val_kl_reg_loss: 154050.4781; val_edge_recon_loss: 2790301.3500; val_gene_expr_recon_loss: 34374173.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 63506490.9333; val_global_loss: 100825016.5333; val_optim_loss: 100825016.5333
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9592; val_auprc_score: 0.9519; val_best_acc_score: 0.8963; val_best_f1_score: 0.9002; train_kl_reg_loss: 152849.5379; train_edge_recon_loss: 2862674.2252; train_gene_expr_recon_loss: 35696431.4504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64934726.0153; train_global_loss: 103646680.9160; train_optim_loss: 103646680.9160; val_kl_reg_loss: 87204.7547; val_edge_recon_loss: 2866735.2333; val_gene_expr_recon_loss: 35582928.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64062314.6667; val_global_loss: 102599184.0000; val_optim_loss: 102599184.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9596; val_auprc_score: 0.9543; val_best_acc_score: 0.8929; val_best_f1_score: 0.8977; train_kl_reg_loss: 158419.5775; train_edge_recon_loss: 2851894.1336; train_gene_expr_recon_loss: 35539984.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64928209.5573; train_global_loss: 103478507.9084; train_optim_loss: 103478507.9084; val_kl_reg_loss: 88852.4630; val_edge_recon_loss: 2871794.6167; val_gene_expr_recon_loss: 35543925.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64320201.6000; val_global_loss: 102824773.3333; val_optim_loss: 102824773.3333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9616; val_auprc_score: 0.9534; val_best_acc_score: 0.9000; val_best_f1_score: 0.9047; train_kl_reg_loss: 161838.5663; train_edge_recon_loss: 2842139.4504; train_gene_expr_recon_loss: 35453905.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64812093.7405; train_global_loss: 103269976.5496; train_optim_loss: 103269976.5496; val_kl_reg_loss: 92378.9641; val_edge_recon_loss: 2841669.3167; val_gene_expr_recon_loss: 35540483.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64240183.7333; val_global_loss: 102714716.8000; val_optim_loss: 102714716.8000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9575; val_auprc_score: 0.9500; val_best_acc_score: 0.8903; val_best_f1_score: 0.8963; train_kl_reg_loss: 164226.3334; train_edge_recon_loss: 2842507.6756; train_gene_expr_recon_loss: 35439606.7176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64801195.2977; train_global_loss: 103247536.1221; train_optim_loss: 103247536.1221; val_kl_reg_loss: 94652.6146; val_edge_recon_loss: 2852265.4833; val_gene_expr_recon_loss: 35480573.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64122138.6667; val_global_loss: 102549629.8667; val_optim_loss: 102549629.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9580; val_auprc_score: 0.9492; val_best_acc_score: 0.8950; val_best_f1_score: 0.8994; train_kl_reg_loss: 165083.3046; train_edge_recon_loss: 2830750.3168; train_gene_expr_recon_loss: 35483826.8092; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64988341.8931; train_global_loss: 103468002.1374; train_optim_loss: 103468002.1374; val_kl_reg_loss: 93621.4286; val_edge_recon_loss: 2861659.9500; val_gene_expr_recon_loss: 35430172.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64128057.3333; val_global_loss: 102513511.4667; val_optim_loss: 102513511.4667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9563; val_auprc_score: 0.9464; val_best_acc_score: 0.8921; val_best_f1_score: 0.8974; train_kl_reg_loss: 164722.4105; train_edge_recon_loss: 2826849.0916; train_gene_expr_recon_loss: 35399983.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64715048.6107; train_global_loss: 103106603.3588; train_optim_loss: 103106603.3588; val_kl_reg_loss: 95648.6047; val_edge_recon_loss: 2862008.8333; val_gene_expr_recon_loss: 35407891.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64102186.4000; val_global_loss: 102467735.4667; val_optim_loss: 102467735.4667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9567; val_auprc_score: 0.9487; val_best_acc_score: 0.8902; val_best_f1_score: 0.8970; train_kl_reg_loss: 165140.2805; train_edge_recon_loss: 2835171.6088; train_gene_expr_recon_loss: 35419349.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64757318.7786; train_global_loss: 103176979.8473; train_optim_loss: 103176979.8473; val_kl_reg_loss: 94315.6245; val_edge_recon_loss: 2862878.8833; val_gene_expr_recon_loss: 35531724.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64204092.2667; val_global_loss: 102693010.6667; val_optim_loss: 102693010.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9561; val_auprc_score: 0.9446; val_best_acc_score: 0.8913; val_best_f1_score: 0.8971; train_kl_reg_loss: 165035.3083; train_edge_recon_loss: 2836490.0954; train_gene_expr_recon_loss: 35409271.4962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 64732789.0382; train_global_loss: 103143585.4046; train_optim_loss: 103143585.4046; val_kl_reg_loss: 94872.0651; val_edge_recon_loss: 2850648.0167; val_gene_expr_recon_loss: 35434455.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 64005903.7333; val_global_loss: 102385879.4667; val_optim_loss: 102385879.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 54 min 21 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9545
val AUPRC score: 0.9466
val best accuracy score: 0.8897
val best F1 score: 0.8958
val target rna MSE score: 1.1907
val source rna MSE score: 35.4663
val target atac MSE score: 0.1218
val source atac MSE score: 0.8967
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
