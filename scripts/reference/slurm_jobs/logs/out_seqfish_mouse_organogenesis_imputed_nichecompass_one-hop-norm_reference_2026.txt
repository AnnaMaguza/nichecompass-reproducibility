[True]
Run timestamp: 21072023_194944_2026.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '16', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000.0', '--lambda_gene_expr_recon', '30000.0', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500.0', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_2026']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 424361
Number of validation edges: 47151
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9036; val_auprc_score: 0.9787; val_best_acc_score: 0.8517; val_best_f1_score: 0.9199; train_kl_reg_loss: 906454.1082; train_edge_recon_loss: 11479487.3558; train_gene_expr_recon_loss: 223356598.3462; train_masked_gp_l1_reg_loss: 751169.3465; train_group_lasso_reg_loss: 0.0000; train_global_loss: 236493709.9231; train_optim_loss: 236493709.9231; val_kl_reg_loss: 1233462.5677; val_edge_recon_loss: 11699572.2812; val_gene_expr_recon_loss: 127304163.0000; val_masked_gp_l1_reg_loss: 741788.4375; val_group_lasso_reg_loss: 0.0000; val_global_loss: 140978988.0000; val_optim_loss: 140978988.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8930; val_auprc_score: 0.9758; val_best_acc_score: 0.8543; val_best_f1_score: 0.9214; train_kl_reg_loss: 1415562.6319; train_edge_recon_loss: 11885111.6875; train_gene_expr_recon_loss: 277819515.6538; train_masked_gp_l1_reg_loss: 759960.9210; train_group_lasso_reg_loss: 0.0000; train_global_loss: 291880153.3846; train_optim_loss: 291880153.3846; val_kl_reg_loss: 1516035.0156; val_edge_recon_loss: 11995093.4167; val_gene_expr_recon_loss: 349501640.0000; val_masked_gp_l1_reg_loss: 790767.2500; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363803518.6667; val_optim_loss: 363803518.6667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8916; val_auprc_score: 0.9768; val_best_acc_score: 0.8546; val_best_f1_score: 0.9216; train_kl_reg_loss: 1237580.7837; train_edge_recon_loss: 11932380.2740; train_gene_expr_recon_loss: 471558734.9231; train_masked_gp_l1_reg_loss: 773610.3242; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485502306.1538; train_optim_loss: 485502306.1538; val_kl_reg_loss: 893273.6849; val_edge_recon_loss: 11711102.3333; val_gene_expr_recon_loss: 444404557.3333; val_masked_gp_l1_reg_loss: 750519.5000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457759460.0000; val_optim_loss: 457759460.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8901; val_auprc_score: 0.9767; val_best_acc_score: 0.8547; val_best_f1_score: 0.9216; train_kl_reg_loss: 833123.9979; train_edge_recon_loss: 11844282.4038; train_gene_expr_recon_loss: 448861007.5385; train_masked_gp_l1_reg_loss: 730166.5679; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462268578.9231; train_optim_loss: 462268578.9231; val_kl_reg_loss: 1283530.0781; val_edge_recon_loss: 11816966.5833; val_gene_expr_recon_loss: 431554552.0000; val_masked_gp_l1_reg_loss: 713651.7500; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445368714.6667; val_optim_loss: 445368714.6667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8755; val_auprc_score: 0.9743; val_best_acc_score: 0.8513; val_best_f1_score: 0.9197; train_kl_reg_loss: 703829.9793; train_edge_recon_loss: 11547168.3798; train_gene_expr_recon_loss: 425863885.3846; train_masked_gp_l1_reg_loss: 716713.2395; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438831598.3077; train_optim_loss: 438831598.3077; val_kl_reg_loss: 613628.5339; val_edge_recon_loss: 11913223.8333; val_gene_expr_recon_loss: 405918782.6667; val_masked_gp_l1_reg_loss: 711539.2500; val_group_lasso_reg_loss: 0.0000; val_global_loss: 419157189.3333; val_optim_loss: 419157189.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8734; val_auprc_score: 0.9745; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 609438.3990; train_edge_recon_loss: 11368843.4375; train_gene_expr_recon_loss: 405118433.8462; train_masked_gp_l1_reg_loss: 710592.0616; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417807309.5385; train_optim_loss: 417807309.5385; val_kl_reg_loss: 474043.3099; val_edge_recon_loss: 11851359.4583; val_gene_expr_recon_loss: 399902146.6667; val_masked_gp_l1_reg_loss: 722048.3125; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412949597.3333; val_optim_loss: 412949597.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8666; val_auprc_score: 0.9719; val_best_acc_score: 0.8507; val_best_f1_score: 0.9193; train_kl_reg_loss: 234906.7201; train_edge_recon_loss: 11031108.4471; train_gene_expr_recon_loss: 296082450.3462; train_masked_gp_l1_reg_loss: 908597.3888; train_group_lasso_reg_loss: 0.0000; train_global_loss: 308257063.8846; train_optim_loss: 308257063.8846; val_kl_reg_loss: 156674.7689; val_edge_recon_loss: 12316775.9167; val_gene_expr_recon_loss: 116292003.6667; val_masked_gp_l1_reg_loss: 1101675.1250; val_group_lasso_reg_loss: 0.0000; val_global_loss: 129867125.6667; val_optim_loss: 129867125.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8613; val_auprc_score: 0.9718; val_best_acc_score: 0.8546; val_best_f1_score: 0.9215; train_kl_reg_loss: 199256.0747; train_edge_recon_loss: 10563041.7019; train_gene_expr_recon_loss: 104306933.6538; train_masked_gp_l1_reg_loss: 1067410.9681; train_group_lasso_reg_loss: 0.0000; train_global_loss: 116136642.3846; train_optim_loss: 116136642.3846; val_kl_reg_loss: 204392.6562; val_edge_recon_loss: 11600669.8958; val_gene_expr_recon_loss: 100024686.3333; val_masked_gp_l1_reg_loss: 1030974.3750; val_group_lasso_reg_loss: 0.0000; val_global_loss: 112860724.3333; val_optim_loss: 112860724.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8558; val_auprc_score: 0.9702; val_best_acc_score: 0.8604; val_best_f1_score: 0.9244; train_kl_reg_loss: 216886.7032; train_edge_recon_loss: 10520345.5192; train_gene_expr_recon_loss: 98354044.6923; train_masked_gp_l1_reg_loss: 1001019.0282; train_group_lasso_reg_loss: 0.0000; train_global_loss: 110092295.8846; train_optim_loss: 110092295.8846; val_kl_reg_loss: 218524.2083; val_edge_recon_loss: 12051772.2083; val_gene_expr_recon_loss: 97358288.6667; val_masked_gp_l1_reg_loss: 973579.2500; val_group_lasso_reg_loss: 0.0000; val_global_loss: 110602161.0000; val_optim_loss: 110602161.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8480; val_auprc_score: 0.9689; val_best_acc_score: 0.8691; val_best_f1_score: 0.9288; train_kl_reg_loss: 225140.2927; train_edge_recon_loss: 10529692.5144; train_gene_expr_recon_loss: 96381335.1154; train_masked_gp_l1_reg_loss: 950888.1202; train_group_lasso_reg_loss: 0.0000; train_global_loss: 108087055.9231; train_optim_loss: 108087055.9231; val_kl_reg_loss: 222645.3457; val_edge_recon_loss: 11633814.7917; val_gene_expr_recon_loss: 95727716.0000; val_masked_gp_l1_reg_loss: 930356.6875; val_group_lasso_reg_loss: 0.0000; val_global_loss: 108514536.6667; val_optim_loss: 108514536.6667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8442; val_auprc_score: 0.9670; val_best_acc_score: 0.8730; val_best_f1_score: 0.9305; train_kl_reg_loss: 227577.9463; train_edge_recon_loss: 10466454.2933; train_gene_expr_recon_loss: 95014231.3462; train_masked_gp_l1_reg_loss: 912211.2701; train_group_lasso_reg_loss: 0.0000; train_global_loss: 106620474.6923; train_optim_loss: 106620474.6923; val_kl_reg_loss: 219070.9342; val_edge_recon_loss: 12125553.5000; val_gene_expr_recon_loss: 94562602.3333; val_masked_gp_l1_reg_loss: 895585.6250; val_group_lasso_reg_loss: 0.0000; val_global_loss: 107802811.3333; val_optim_loss: 107802811.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8457; val_auprc_score: 0.9676; val_best_acc_score: 0.8781; val_best_f1_score: 0.9329; train_kl_reg_loss: 227948.5533; train_edge_recon_loss: 10504758.9519; train_gene_expr_recon_loss: 93865740.8462; train_masked_gp_l1_reg_loss: 881580.3353; train_group_lasso_reg_loss: 0.0000; train_global_loss: 105480028.8846; train_optim_loss: 105480028.8846; val_kl_reg_loss: 229699.3047; val_edge_recon_loss: 11762711.1042; val_gene_expr_recon_loss: 93571332.0000; val_masked_gp_l1_reg_loss: 868391.9375; val_group_lasso_reg_loss: 0.0000; val_global_loss: 106432133.0000; val_optim_loss: 106432133.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8473; val_auprc_score: 0.9675; val_best_acc_score: 0.8802; val_best_f1_score: 0.9335; train_kl_reg_loss: 225537.8824; train_edge_recon_loss: 10553251.2163; train_gene_expr_recon_loss: 92839747.9231; train_masked_gp_l1_reg_loss: 857370.8266; train_group_lasso_reg_loss: 0.0000; train_global_loss: 104475908.0000; train_optim_loss: 104475908.0000; val_kl_reg_loss: 208678.9616; val_edge_recon_loss: 11927400.6667; val_gene_expr_recon_loss: 92483382.3333; val_masked_gp_l1_reg_loss: 847272.0625; val_group_lasso_reg_loss: 0.0000; val_global_loss: 105466734.3333; val_optim_loss: 105466734.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8490; val_auprc_score: 0.9678; val_best_acc_score: 0.8767; val_best_f1_score: 0.9308; train_kl_reg_loss: 224738.5430; train_edge_recon_loss: 10528426.1587; train_gene_expr_recon_loss: 91870680.8846; train_masked_gp_l1_reg_loss: 838789.2311; train_group_lasso_reg_loss: 0.0000; train_global_loss: 103462634.7308; train_optim_loss: 103462634.7308; val_kl_reg_loss: 221374.4329; val_edge_recon_loss: 11945974.3333; val_gene_expr_recon_loss: 91485496.0000; val_masked_gp_l1_reg_loss: 831365.1875; val_group_lasso_reg_loss: 0.0000; val_global_loss: 104484213.6667; val_optim_loss: 104484213.6667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8534; val_auprc_score: 0.9683; val_best_acc_score: 0.8772; val_best_f1_score: 0.9327; train_kl_reg_loss: 220906.0991; train_edge_recon_loss: 10469157.1731; train_gene_expr_recon_loss: 90927719.0385; train_masked_gp_l1_reg_loss: 825559.4471; train_group_lasso_reg_loss: 0.0000; train_global_loss: 102443341.4231; train_optim_loss: 102443341.4231; val_kl_reg_loss: 210383.7220; val_edge_recon_loss: 12063450.2500; val_gene_expr_recon_loss: 90489669.3333; val_masked_gp_l1_reg_loss: 820341.1250; val_group_lasso_reg_loss: 0.0000; val_global_loss: 103583846.6667; val_optim_loss: 103583846.6667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8506; val_auprc_score: 0.9673; val_best_acc_score: 0.8840; val_best_f1_score: 0.9360; train_kl_reg_loss: 217750.5632; train_edge_recon_loss: 10482106.1587; train_gene_expr_recon_loss: 89986172.9615; train_masked_gp_l1_reg_loss: 816596.7852; train_group_lasso_reg_loss: 0.0000; train_global_loss: 101502626.2692; train_optim_loss: 101502626.2692; val_kl_reg_loss: 199018.2956; val_edge_recon_loss: 11778110.3750; val_gene_expr_recon_loss: 89734814.6667; val_masked_gp_l1_reg_loss: 812955.6875; val_group_lasso_reg_loss: 0.0000; val_global_loss: 102524895.3333; val_optim_loss: 102524895.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8539; val_auprc_score: 0.9675; val_best_acc_score: 0.8885; val_best_f1_score: 0.9384; train_kl_reg_loss: 208903.4920; train_edge_recon_loss: 10524339.2981; train_gene_expr_recon_loss: 89118249.5000; train_masked_gp_l1_reg_loss: 810517.1953; train_group_lasso_reg_loss: 0.0000; train_global_loss: 100662009.4615; train_optim_loss: 100662009.4615; val_kl_reg_loss: 207695.5775; val_edge_recon_loss: 11537489.3333; val_gene_expr_recon_loss: 88876575.6667; val_masked_gp_l1_reg_loss: 808286.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 101430049.0000; val_optim_loss: 101430049.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8599; val_auprc_score: 0.9679; val_best_acc_score: 0.8896; val_best_f1_score: 0.9384; train_kl_reg_loss: 200224.1967; train_edge_recon_loss: 10469664.7404; train_gene_expr_recon_loss: 88267804.6923; train_masked_gp_l1_reg_loss: 806037.8468; train_group_lasso_reg_loss: 0.0000; train_global_loss: 99743731.5769; train_optim_loss: 99743731.5769; val_kl_reg_loss: 181965.7090; val_edge_recon_loss: 11454986.1250; val_gene_expr_recon_loss: 88003583.3333; val_masked_gp_l1_reg_loss: 803841.6250; val_group_lasso_reg_loss: 0.0000; val_global_loss: 100444374.3333; val_optim_loss: 100444374.3333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8600; val_auprc_score: 0.9674; val_best_acc_score: 0.8915; val_best_f1_score: 0.9393; train_kl_reg_loss: 187806.3857; train_edge_recon_loss: 10286589.4904; train_gene_expr_recon_loss: 87440401.2692; train_masked_gp_l1_reg_loss: 802077.7476; train_group_lasso_reg_loss: 0.0000; train_global_loss: 98716874.6538; train_optim_loss: 98716874.6538; val_kl_reg_loss: 180024.4115; val_edge_recon_loss: 11054823.9375; val_gene_expr_recon_loss: 87356742.3333; val_masked_gp_l1_reg_loss: 800212.0625; val_group_lasso_reg_loss: 0.0000; val_global_loss: 99391806.6667; val_optim_loss: 99391806.6667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8637; val_auprc_score: 0.9683; val_best_acc_score: 0.8940; val_best_f1_score: 0.9406; train_kl_reg_loss: 174615.2570; train_edge_recon_loss: 10047340.2019; train_gene_expr_recon_loss: 86745230.6154; train_masked_gp_l1_reg_loss: 797993.8837; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97765179.8846; train_optim_loss: 97765179.8846; val_kl_reg_loss: 165259.7930; val_edge_recon_loss: 10603018.7083; val_gene_expr_recon_loss: 86679081.6667; val_masked_gp_l1_reg_loss: 796131.5000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98243488.3333; val_optim_loss: 98243488.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8638; val_auprc_score: 0.9683; val_best_acc_score: 0.8947; val_best_f1_score: 0.9411; train_kl_reg_loss: 166715.0640; train_edge_recon_loss: 10009504.7933; train_gene_expr_recon_loss: 86025794.8077; train_masked_gp_l1_reg_loss: 793445.9525; train_group_lasso_reg_loss: 0.0000; train_global_loss: 96995460.6154; train_optim_loss: 96995460.6154; val_kl_reg_loss: 157672.3672; val_edge_recon_loss: 10363268.3750; val_gene_expr_recon_loss: 85943643.6667; val_masked_gp_l1_reg_loss: 790978.6250; val_group_lasso_reg_loss: 0.0000; val_global_loss: 97255561.3333; val_optim_loss: 97255561.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8680; val_auprc_score: 0.9688; val_best_acc_score: 0.8975; val_best_f1_score: 0.9426; train_kl_reg_loss: 164954.1962; train_edge_recon_loss: 9797321.2019; train_gene_expr_recon_loss: 85353929.2692; train_masked_gp_l1_reg_loss: 788473.1058; train_group_lasso_reg_loss: 0.0000; train_global_loss: 96104677.8077; train_optim_loss: 96104677.8077; val_kl_reg_loss: 163567.5605; val_edge_recon_loss: 9897910.3333; val_gene_expr_recon_loss: 85355594.6667; val_masked_gp_l1_reg_loss: 785805.9375; val_group_lasso_reg_loss: 0.0000; val_global_loss: 96202880.0000; val_optim_loss: 96202880.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8671; val_auprc_score: 0.9688; val_best_acc_score: 0.8972; val_best_f1_score: 0.9421; train_kl_reg_loss: 170806.0290; train_edge_recon_loss: 9640782.2284; train_gene_expr_recon_loss: 84775054.4231; train_masked_gp_l1_reg_loss: 782375.8389; train_group_lasso_reg_loss: 0.0000; train_global_loss: 95369018.1923; train_optim_loss: 95369018.1923; val_kl_reg_loss: 176747.2018; val_edge_recon_loss: 9656807.0000; val_gene_expr_recon_loss: 84636231.6667; val_masked_gp_l1_reg_loss: 779200.3125; val_group_lasso_reg_loss: 0.0000; val_global_loss: 95248985.6667; val_optim_loss: 95248985.6667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8734; val_auprc_score: 0.9695; val_best_acc_score: 0.8994; val_best_f1_score: 0.9430; train_kl_reg_loss: 185970.1635; train_edge_recon_loss: 9429380.1611; train_gene_expr_recon_loss: 84234297.2308; train_masked_gp_l1_reg_loss: 775074.0306; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94624721.4615; train_optim_loss: 94624721.4615; val_kl_reg_loss: 195457.2279; val_edge_recon_loss: 9550755.6250; val_gene_expr_recon_loss: 84136867.3333; val_masked_gp_l1_reg_loss: 770893.1250; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94653975.3333; val_optim_loss: 94653975.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8690; val_auprc_score: 0.9691; val_best_acc_score: 0.8978; val_best_f1_score: 0.9423; train_kl_reg_loss: 204205.2634; train_edge_recon_loss: 9365089.4327; train_gene_expr_recon_loss: 83723859.5000; train_masked_gp_l1_reg_loss: 766631.8573; train_group_lasso_reg_loss: 0.0000; train_global_loss: 94059785.8846; train_optim_loss: 94059785.8846; val_kl_reg_loss: 210402.5775; val_edge_recon_loss: 9570264.6875; val_gene_expr_recon_loss: 83744888.6667; val_masked_gp_l1_reg_loss: 762133.6250; val_group_lasso_reg_loss: 0.0000; val_global_loss: 94287691.6667; val_optim_loss: 94287691.6667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.6567; val_auprc_score: 0.8985; val_best_acc_score: 0.8535; val_best_f1_score: 0.9209; train_kl_reg_loss: 63423.5289; train_edge_recon_loss: 11145712.5288; train_gene_expr_recon_loss: 96056667.3077; train_masked_gp_l1_reg_loss: 929754.4504; train_group_lasso_reg_loss: 0.0000; train_global_loss: 108195557.8462; train_optim_loss: 108195557.8462; val_kl_reg_loss: 18749.0116; val_edge_recon_loss: 11909772.3333; val_gene_expr_recon_loss: 88678189.0000; val_masked_gp_l1_reg_loss: 969688.6875; val_group_lasso_reg_loss: 0.0000; val_global_loss: 101576398.6667; val_optim_loss: 101576398.6667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.6942; val_auprc_score: 0.9092; val_best_acc_score: 0.8525; val_best_f1_score: 0.9204; train_kl_reg_loss: 24279.1191; train_edge_recon_loss: 11040673.9856; train_gene_expr_recon_loss: 87682364.9615; train_masked_gp_l1_reg_loss: 946246.2335; train_group_lasso_reg_loss: 0.0000; train_global_loss: 99693564.3462; train_optim_loss: 99693564.3462; val_kl_reg_loss: 31000.3551; val_edge_recon_loss: 11985874.5000; val_gene_expr_recon_loss: 86906675.0000; val_masked_gp_l1_reg_loss: 907630.3750; val_group_lasso_reg_loss: 0.0000; val_global_loss: 99831182.3333; val_optim_loss: 99831182.3333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.7099; val_auprc_score: 0.9164; val_best_acc_score: 0.8548; val_best_f1_score: 0.9216; train_kl_reg_loss: 23262.9687; train_edge_recon_loss: 11131868.6923; train_gene_expr_recon_loss: 86440100.0769; train_masked_gp_l1_reg_loss: 881240.4213; train_group_lasso_reg_loss: 0.0000; train_global_loss: 98476472.1538; train_optim_loss: 98476472.1538; val_kl_reg_loss: 12205.6145; val_edge_recon_loss: 11751197.9167; val_gene_expr_recon_loss: 85948920.0000; val_masked_gp_l1_reg_loss: 865831.5625; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98578155.6667; val_optim_loss: 98578155.6667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.7581; val_auprc_score: 0.9328; val_best_acc_score: 0.8758; val_best_f1_score: 0.9315; train_kl_reg_loss: 8548.6686; train_edge_recon_loss: 10837349.9231; train_gene_expr_recon_loss: 86995688.4615; train_masked_gp_l1_reg_loss: 858180.7184; train_group_lasso_reg_loss: 0.0000; train_global_loss: 98699768.1538; train_optim_loss: 98699768.1538; val_kl_reg_loss: 9491.2056; val_edge_recon_loss: 11727867.2917; val_gene_expr_recon_loss: 86195567.3333; val_masked_gp_l1_reg_loss: 844628.8750; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98777557.0000; val_optim_loss: 98777557.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.7525; val_auprc_score: 0.9294; val_best_acc_score: 0.8742; val_best_f1_score: 0.9305; train_kl_reg_loss: 9569.7924; train_edge_recon_loss: 10691068.5240; train_gene_expr_recon_loss: 85834107.5000; train_masked_gp_l1_reg_loss: 840843.7494; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97375589.6154; train_optim_loss: 97375589.6154; val_kl_reg_loss: 9359.2983; val_edge_recon_loss: 11612783.0417; val_gene_expr_recon_loss: 85832294.0000; val_masked_gp_l1_reg_loss: 837965.6875; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98292405.0000; val_optim_loss: 98292405.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.7541; val_auprc_score: 0.9310; val_best_acc_score: 0.8701; val_best_f1_score: 0.9281; train_kl_reg_loss: 9563.0104; train_edge_recon_loss: 10795036.7260; train_gene_expr_recon_loss: 85718862.4231; train_masked_gp_l1_reg_loss: 835134.5968; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97358596.8462; train_optim_loss: 97358596.8462; val_kl_reg_loss: 8727.6482; val_edge_recon_loss: 11963362.6250; val_gene_expr_recon_loss: 85698157.6667; val_masked_gp_l1_reg_loss: 832354.4375; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98502599.6667; val_optim_loss: 98502599.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.7552; val_auprc_score: 0.9298; val_best_acc_score: 0.8631; val_best_f1_score: 0.9238; train_kl_reg_loss: 9686.9003; train_edge_recon_loss: 10746252.1010; train_gene_expr_recon_loss: 85643822.6538; train_masked_gp_l1_reg_loss: 829194.2284; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97228955.8846; train_optim_loss: 97228955.8846; val_kl_reg_loss: 8396.3612; val_edge_recon_loss: 12151524.7500; val_gene_expr_recon_loss: 85648986.6667; val_masked_gp_l1_reg_loss: 826063.5000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98634971.6667; val_optim_loss: 98634971.6667
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.7566; val_auprc_score: 0.9322; val_best_acc_score: 0.8649; val_best_f1_score: 0.9249; train_kl_reg_loss: 9978.8658; train_edge_recon_loss: 10707589.0865; train_gene_expr_recon_loss: 85485023.4231; train_masked_gp_l1_reg_loss: 822589.0604; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97025180.5385; train_optim_loss: 97025180.5385; val_kl_reg_loss: 9622.5861; val_edge_recon_loss: 12013838.6667; val_gene_expr_recon_loss: 85504754.3333; val_masked_gp_l1_reg_loss: 818867.1875; val_group_lasso_reg_loss: 0.0000; val_global_loss: 98347079.6667; val_optim_loss: 98347079.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 168 min 57 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.8904
Val AUPRC score: 0.9739
Val best accuracy score: 0.9106
Val best F1 score: 0.9493
Val gene expr MSE score: 3636.1814
Val cat covariate0 mean sim diff: -0.0047

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
