[True]
Run timestamp: 09102023_211417_38.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_38']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7653; val_auprc_score: 0.7891; val_best_acc_score: 0.5911; val_best_f1_score: 0.7010; train_kl_reg_loss: 57876.3430; train_edge_recon_loss: 3507516.5706; train_gene_expr_recon_loss: 13348589.5496; train_masked_gp_l1_reg_loss: 87595.5382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1950675.3414; train_chrom_access_recon_loss: 2252118.0515; train_global_loss: 21204371.4198; train_optim_loss: 21204371.4198; val_kl_reg_loss: 87402.1661; val_edge_recon_loss: 4059453.1167; val_gene_expr_recon_loss: 12480032.4000; val_masked_gp_l1_reg_loss: 76750.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 451649.8125; val_chrom_access_recon_loss: 2122399.2583; val_global_loss: 19277686.6667; val_optim_loss: 19277686.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8461; val_auprc_score: 0.8520; val_best_acc_score: 0.7532; val_best_f1_score: 0.7708; train_kl_reg_loss: 72800.6312; train_edge_recon_loss: 3485134.5630; train_gene_expr_recon_loss: 12532430.4962; train_masked_gp_l1_reg_loss: 76580.6023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 230745.2562; train_chrom_access_recon_loss: 2167809.8502; train_global_loss: 18565501.3130; train_optim_loss: 18565501.3130; val_kl_reg_loss: 55941.6143; val_edge_recon_loss: 3518773.6500; val_gene_expr_recon_loss: 12342803.8000; val_masked_gp_l1_reg_loss: 80349.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134532.2969; val_chrom_access_recon_loss: 2117207.1167; val_global_loss: 18249607.3333; val_optim_loss: 18249607.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8735; val_auprc_score: 0.8685; val_best_acc_score: 0.7672; val_best_f1_score: 0.7938; train_kl_reg_loss: 85192.8638; train_edge_recon_loss: 3059209.3683; train_gene_expr_recon_loss: 12398307.3817; train_masked_gp_l1_reg_loss: 85799.8891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112361.9929; train_chrom_access_recon_loss: 2146009.8607; train_global_loss: 17886881.3740; train_optim_loss: 17886881.3740; val_kl_reg_loss: 90796.6667; val_edge_recon_loss: 2956561.4667; val_gene_expr_recon_loss: 12136510.6000; val_masked_gp_l1_reg_loss: 89921.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100152.9062; val_chrom_access_recon_loss: 2075091.2833; val_global_loss: 17449034.0000; val_optim_loss: 17449034.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8985; val_auprc_score: 0.8816; val_best_acc_score: 0.8139; val_best_f1_score: 0.8271; train_kl_reg_loss: 90759.5964; train_edge_recon_loss: 2913673.6260; train_gene_expr_recon_loss: 12241516.4122; train_masked_gp_l1_reg_loss: 91057.0790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92622.8118; train_chrom_access_recon_loss: 2121525.2615; train_global_loss: 17551154.7786; train_optim_loss: 17551154.7786; val_kl_reg_loss: 91378.4667; val_edge_recon_loss: 2883647.5667; val_gene_expr_recon_loss: 11996663.0667; val_masked_gp_l1_reg_loss: 93784.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87747.8359; val_chrom_access_recon_loss: 2053563.0583; val_global_loss: 17206784.2000; val_optim_loss: 17206784.2000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9047; val_auprc_score: 0.8874; val_best_acc_score: 0.8255; val_best_f1_score: 0.8403; train_kl_reg_loss: 88575.9201; train_edge_recon_loss: 2888524.0687; train_gene_expr_recon_loss: 12162225.3435; train_masked_gp_l1_reg_loss: 97074.3741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85814.5774; train_chrom_access_recon_loss: 2107456.2653; train_global_loss: 17429670.5420; train_optim_loss: 17429670.5420; val_kl_reg_loss: 82209.7073; val_edge_recon_loss: 2857094.7167; val_gene_expr_recon_loss: 11938378.8667; val_masked_gp_l1_reg_loss: 98149.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82651.5391; val_chrom_access_recon_loss: 2031873.8000; val_global_loss: 17090357.9333; val_optim_loss: 17090357.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9230; val_auprc_score: 0.9071; val_best_acc_score: 0.8504; val_best_f1_score: 0.8606; train_kl_reg_loss: 85885.4491; train_edge_recon_loss: 2824193.6336; train_gene_expr_recon_loss: 12028687.3817; train_masked_gp_l1_reg_loss: 99925.6180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78427.7381; train_chrom_access_recon_loss: 2088551.8435; train_global_loss: 17205671.5420; train_optim_loss: 17205671.5420; val_kl_reg_loss: 81266.9490; val_edge_recon_loss: 2810168.0667; val_gene_expr_recon_loss: 11776336.2000; val_masked_gp_l1_reg_loss: 101780.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75345.1484; val_chrom_access_recon_loss: 2026057.5500; val_global_loss: 16870953.8000; val_optim_loss: 16870953.8000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9260; val_auprc_score: 0.9091; val_best_acc_score: 0.8576; val_best_f1_score: 0.8677; train_kl_reg_loss: 86843.2835; train_edge_recon_loss: 2780809.9752; train_gene_expr_recon_loss: 11951404.6794; train_masked_gp_l1_reg_loss: 103256.5904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72921.0491; train_chrom_access_recon_loss: 2073778.7719; train_global_loss: 17069014.2214; train_optim_loss: 17069014.2214; val_kl_reg_loss: 88833.4500; val_edge_recon_loss: 2815465.3167; val_gene_expr_recon_loss: 11732614.7333; val_masked_gp_l1_reg_loss: 104437.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71935.3281; val_chrom_access_recon_loss: 2011384.0917; val_global_loss: 16824669.6000; val_optim_loss: 16824669.6000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9359; val_auprc_score: 0.9208; val_best_acc_score: 0.8711; val_best_f1_score: 0.8773; train_kl_reg_loss: 86835.5961; train_edge_recon_loss: 2773003.7634; train_gene_expr_recon_loss: 11890878.8244; train_masked_gp_l1_reg_loss: 104946.7645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69781.7660; train_chrom_access_recon_loss: 2064811.4198; train_global_loss: 16990258.0687; train_optim_loss: 16990258.0687; val_kl_reg_loss: 88711.6823; val_edge_recon_loss: 2787182.9500; val_gene_expr_recon_loss: 11694235.3333; val_masked_gp_l1_reg_loss: 106015.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68667.9688; val_chrom_access_recon_loss: 2001120.1000; val_global_loss: 16745933.3333; val_optim_loss: 16745933.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9381; val_auprc_score: 0.9243; val_best_acc_score: 0.8743; val_best_f1_score: 0.8811; train_kl_reg_loss: 86401.4803; train_edge_recon_loss: 2755134.8149; train_gene_expr_recon_loss: 11811077.4198; train_masked_gp_l1_reg_loss: 106571.5199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67679.6565; train_chrom_access_recon_loss: 2047131.8989; train_global_loss: 16873996.7099; train_optim_loss: 16873996.7099; val_kl_reg_loss: 84758.0964; val_edge_recon_loss: 2771311.4667; val_gene_expr_recon_loss: 11609171.2667; val_masked_gp_l1_reg_loss: 106973.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66830.2734; val_chrom_access_recon_loss: 1992131.7167; val_global_loss: 16631175.3333; val_optim_loss: 16631175.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9488; val_auprc_score: 0.9360; val_best_acc_score: 0.8909; val_best_f1_score: 0.8969; train_kl_reg_loss: 84675.2934; train_edge_recon_loss: 2746714.2576; train_gene_expr_recon_loss: 11751723.7328; train_masked_gp_l1_reg_loss: 107447.2422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66775.2007; train_chrom_access_recon_loss: 2038001.3769; train_global_loss: 16795337.0763; train_optim_loss: 16795337.0763; val_kl_reg_loss: 82508.8141; val_edge_recon_loss: 2751186.5833; val_gene_expr_recon_loss: 11554654.4667; val_masked_gp_l1_reg_loss: 108160.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67340.0781; val_chrom_access_recon_loss: 1976161.5833; val_global_loss: 16540011.3333; val_optim_loss: 16540011.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9528; val_auprc_score: 0.9410; val_best_acc_score: 0.8944; val_best_f1_score: 0.8990; train_kl_reg_loss: 83329.4556; train_edge_recon_loss: 2728571.7901; train_gene_expr_recon_loss: 11709521.5878; train_masked_gp_l1_reg_loss: 108265.0699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67607.8298; train_chrom_access_recon_loss: 2030748.7023; train_global_loss: 16728044.4351; train_optim_loss: 16728044.4351; val_kl_reg_loss: 82251.8536; val_edge_recon_loss: 2735442.5500; val_gene_expr_recon_loss: 11467707.0667; val_masked_gp_l1_reg_loss: 108510.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67638.4688; val_chrom_access_recon_loss: 1962470.9250; val_global_loss: 16424021.4000; val_optim_loss: 16424021.4000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9577; val_auprc_score: 0.9463; val_best_acc_score: 0.9004; val_best_f1_score: 0.9038; train_kl_reg_loss: 81212.5728; train_edge_recon_loss: 2730275.6947; train_gene_expr_recon_loss: 11650381.1985; train_masked_gp_l1_reg_loss: 108521.6089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66968.6663; train_chrom_access_recon_loss: 2017790.1116; train_global_loss: 16655149.7863; train_optim_loss: 16655149.7863; val_kl_reg_loss: 80651.9016; val_edge_recon_loss: 2730591.7500; val_gene_expr_recon_loss: 11501364.9333; val_masked_gp_l1_reg_loss: 108857.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66551.4531; val_chrom_access_recon_loss: 1969963.5083; val_global_loss: 16457981.0667; val_optim_loss: 16457981.0667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9628; val_auprc_score: 0.9551; val_best_acc_score: 0.9035; val_best_f1_score: 0.9073; train_kl_reg_loss: 79301.4999; train_edge_recon_loss: 2726532.4771; train_gene_expr_recon_loss: 11621241.9008; train_masked_gp_l1_reg_loss: 109068.6583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66395.8506; train_chrom_access_recon_loss: 2013685.4323; train_global_loss: 16616225.7176; train_optim_loss: 16616225.7176; val_kl_reg_loss: 79858.2208; val_edge_recon_loss: 2719545.9667; val_gene_expr_recon_loss: 11442404.7333; val_masked_gp_l1_reg_loss: 109254.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66313.8125; val_chrom_access_recon_loss: 1958901.9667; val_global_loss: 16376279.7333; val_optim_loss: 16376279.7333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9581; val_auprc_score: 0.9462; val_best_acc_score: 0.9042; val_best_f1_score: 0.9075; train_kl_reg_loss: 79543.4792; train_edge_recon_loss: 2713821.1966; train_gene_expr_recon_loss: 11591714.1908; train_masked_gp_l1_reg_loss: 109202.0233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65606.8128; train_chrom_access_recon_loss: 2007065.7987; train_global_loss: 16566953.4656; train_optim_loss: 16566953.4656; val_kl_reg_loss: 78601.4354; val_edge_recon_loss: 2740501.7667; val_gene_expr_recon_loss: 11375166.6667; val_masked_gp_l1_reg_loss: 109471.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65707.5859; val_chrom_access_recon_loss: 1942541.8333; val_global_loss: 16311991.6667; val_optim_loss: 16311991.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9601; val_auprc_score: 0.9489; val_best_acc_score: 0.9043; val_best_f1_score: 0.9084; train_kl_reg_loss: 77515.6610; train_edge_recon_loss: 2710952.5668; train_gene_expr_recon_loss: 11551908.8855; train_masked_gp_l1_reg_loss: 109444.8349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65112.8261; train_chrom_access_recon_loss: 1998551.8922; train_global_loss: 16513486.6489; train_optim_loss: 16513486.6489; val_kl_reg_loss: 76409.2917; val_edge_recon_loss: 2722300.8833; val_gene_expr_recon_loss: 11348460.1333; val_masked_gp_l1_reg_loss: 109332.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65075.1445; val_chrom_access_recon_loss: 1939697.7333; val_global_loss: 16261276.0000; val_optim_loss: 16261276.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9589; val_auprc_score: 0.9463; val_best_acc_score: 0.9050; val_best_f1_score: 0.9083; train_kl_reg_loss: 77124.1636; train_edge_recon_loss: 2703817.4218; train_gene_expr_recon_loss: 11513165.5267; train_masked_gp_l1_reg_loss: 109403.7513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64535.8853; train_chrom_access_recon_loss: 1989614.7128; train_global_loss: 16457661.4809; train_optim_loss: 16457661.4809; val_kl_reg_loss: 78798.5932; val_edge_recon_loss: 2742564.4167; val_gene_expr_recon_loss: 11323718.0667; val_masked_gp_l1_reg_loss: 109421.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64327.8711; val_chrom_access_recon_loss: 1932601.4000; val_global_loss: 16251431.3333; val_optim_loss: 16251431.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9642; val_auprc_score: 0.9539; val_best_acc_score: 0.9072; val_best_f1_score: 0.9118; train_kl_reg_loss: 76869.1562; train_edge_recon_loss: 2705553.6183; train_gene_expr_recon_loss: 11484281.0992; train_masked_gp_l1_reg_loss: 109663.5077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63981.1134; train_chrom_access_recon_loss: 1983976.4361; train_global_loss: 16424325.0229; train_optim_loss: 16424325.0229; val_kl_reg_loss: 76210.8568; val_edge_recon_loss: 2700602.9833; val_gene_expr_recon_loss: 11321431.6667; val_masked_gp_l1_reg_loss: 109945.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64026.9258; val_chrom_access_recon_loss: 1928798.5500; val_global_loss: 16201016.0667; val_optim_loss: 16201016.0667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9655; val_auprc_score: 0.9553; val_best_acc_score: 0.9112; val_best_f1_score: 0.9141; train_kl_reg_loss: 76229.5835; train_edge_recon_loss: 2699128.1431; train_gene_expr_recon_loss: 11460477.8931; train_masked_gp_l1_reg_loss: 109750.1119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63627.2551; train_chrom_access_recon_loss: 1981233.8340; train_global_loss: 16390446.9008; train_optim_loss: 16390446.9008; val_kl_reg_loss: 76370.6016; val_edge_recon_loss: 2709200.5667; val_gene_expr_recon_loss: 11315287.9333; val_masked_gp_l1_reg_loss: 110165.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64168.1836; val_chrom_access_recon_loss: 1932593.7333; val_global_loss: 16207785.9333; val_optim_loss: 16207785.9333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9671; val_auprc_score: 0.9570; val_best_acc_score: 0.9186; val_best_f1_score: 0.9219; train_kl_reg_loss: 75612.1870; train_edge_recon_loss: 2693834.3454; train_gene_expr_recon_loss: 11427584.1145; train_masked_gp_l1_reg_loss: 109930.7968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63170.7404; train_chrom_access_recon_loss: 1973730.3626; train_global_loss: 16343862.5573; train_optim_loss: 16343862.5573; val_kl_reg_loss: 76574.4312; val_edge_recon_loss: 2704686.0667; val_gene_expr_recon_loss: 11249201.0667; val_masked_gp_l1_reg_loss: 109976.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63575.2734; val_chrom_access_recon_loss: 1922544.2083; val_global_loss: 16126557.7333; val_optim_loss: 16126557.7333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9702; val_auprc_score: 0.9619; val_best_acc_score: 0.9219; val_best_f1_score: 0.9242; train_kl_reg_loss: 76581.5462; train_edge_recon_loss: 2695644.2595; train_gene_expr_recon_loss: 11408481.9389; train_masked_gp_l1_reg_loss: 109762.0222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63008.8476; train_chrom_access_recon_loss: 1970854.2729; train_global_loss: 16324332.8626; train_optim_loss: 16324332.8626; val_kl_reg_loss: 76589.3302; val_edge_recon_loss: 2699325.1333; val_gene_expr_recon_loss: 11258139.4667; val_masked_gp_l1_reg_loss: 109638.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62826.9531; val_chrom_access_recon_loss: 1915451.8583; val_global_loss: 16121970.6667; val_optim_loss: 16121970.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9712; val_auprc_score: 0.9598; val_best_acc_score: 0.9252; val_best_f1_score: 0.9281; train_kl_reg_loss: 76121.8593; train_edge_recon_loss: 2692454.6756; train_gene_expr_recon_loss: 11389364.6947; train_masked_gp_l1_reg_loss: 109452.0177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62634.2271; train_chrom_access_recon_loss: 1965015.3015; train_global_loss: 16295042.7863; train_optim_loss: 16295042.7863; val_kl_reg_loss: 76848.9875; val_edge_recon_loss: 2687371.4167; val_gene_expr_recon_loss: 11220433.0000; val_masked_gp_l1_reg_loss: 109523.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63044.4336; val_chrom_access_recon_loss: 1909306.0417; val_global_loss: 16066526.5333; val_optim_loss: 16066526.5333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9663; val_auprc_score: 0.9562; val_best_acc_score: 0.9167; val_best_f1_score: 0.9192; train_kl_reg_loss: 75742.6103; train_edge_recon_loss: 2696923.1813; train_gene_expr_recon_loss: 11388151.8855; train_masked_gp_l1_reg_loss: 109297.3160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62556.2820; train_chrom_access_recon_loss: 1965421.7557; train_global_loss: 16298093.0305; train_optim_loss: 16298093.0305; val_kl_reg_loss: 76094.9276; val_edge_recon_loss: 2710978.7333; val_gene_expr_recon_loss: 11192317.0667; val_masked_gp_l1_reg_loss: 109303.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62483.0664; val_chrom_access_recon_loss: 1901969.8500; val_global_loss: 16053147.5333; val_optim_loss: 16053147.5333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9701; val_auprc_score: 0.9616; val_best_acc_score: 0.9192; val_best_f1_score: 0.9227; train_kl_reg_loss: 75309.9658; train_edge_recon_loss: 2691903.1718; train_gene_expr_recon_loss: 11359706.1985; train_masked_gp_l1_reg_loss: 108980.0837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62190.2388; train_chrom_access_recon_loss: 1958975.1135; train_global_loss: 16257064.7939; train_optim_loss: 16257064.7939; val_kl_reg_loss: 76025.2984; val_edge_recon_loss: 2714832.6000; val_gene_expr_recon_loss: 11194160.1333; val_masked_gp_l1_reg_loss: 109124.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62883.2852; val_chrom_access_recon_loss: 1905593.2250; val_global_loss: 16062618.2000; val_optim_loss: 16062618.2000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9683; val_auprc_score: 0.9571; val_best_acc_score: 0.9219; val_best_f1_score: 0.9245; train_kl_reg_loss: 75965.5510; train_edge_recon_loss: 2684437.8225; train_gene_expr_recon_loss: 11343104.6870; train_masked_gp_l1_reg_loss: 108848.6891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62468.6721; train_chrom_access_recon_loss: 1955806.0649; train_global_loss: 16230631.5802; train_optim_loss: 16230631.5802; val_kl_reg_loss: 74747.2266; val_edge_recon_loss: 2710496.3500; val_gene_expr_recon_loss: 11204655.6000; val_masked_gp_l1_reg_loss: 108801.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62175.2773; val_chrom_access_recon_loss: 1910925.3083; val_global_loss: 16071800.3333; val_optim_loss: 16071800.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9739; val_auprc_score: 0.9646; val_best_acc_score: 0.9245; val_best_f1_score: 0.9270; train_kl_reg_loss: 75314.3867; train_edge_recon_loss: 2686872.6489; train_gene_expr_recon_loss: 11334006.7481; train_masked_gp_l1_reg_loss: 108408.0032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62136.9309; train_chrom_access_recon_loss: 1951976.9885; train_global_loss: 16218715.6031; train_optim_loss: 16218715.6031; val_kl_reg_loss: 73524.5625; val_edge_recon_loss: 2682201.7000; val_gene_expr_recon_loss: 11144226.3333; val_masked_gp_l1_reg_loss: 108258.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62010.9414; val_chrom_access_recon_loss: 1890082.5917; val_global_loss: 15960305.2667; val_optim_loss: 15960305.2667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9705; val_auprc_score: 0.9623; val_best_acc_score: 0.9220; val_best_f1_score: 0.9253; train_kl_reg_loss: 74199.5147; train_edge_recon_loss: 2680312.6508; train_gene_expr_recon_loss: 11313113.9924; train_masked_gp_l1_reg_loss: 108148.1313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62057.3217; train_chrom_access_recon_loss: 1949438.1097; train_global_loss: 16187269.7176; train_optim_loss: 16187269.7176; val_kl_reg_loss: 74194.1641; val_edge_recon_loss: 2700473.1500; val_gene_expr_recon_loss: 11133658.4000; val_masked_gp_l1_reg_loss: 108121.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62566.4492; val_chrom_access_recon_loss: 1896319.7667; val_global_loss: 15975333.4667; val_optim_loss: 15975333.4667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9741; val_auprc_score: 0.9659; val_best_acc_score: 0.9270; val_best_f1_score: 0.9296; train_kl_reg_loss: 74371.1803; train_edge_recon_loss: 2679321.4370; train_gene_expr_recon_loss: 11304174.2672; train_masked_gp_l1_reg_loss: 107874.7692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62203.6620; train_chrom_access_recon_loss: 1945624.6336; train_global_loss: 16173570.0534; train_optim_loss: 16173570.0534; val_kl_reg_loss: 72560.3620; val_edge_recon_loss: 2692294.5500; val_gene_expr_recon_loss: 11161691.0000; val_masked_gp_l1_reg_loss: 107837.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62004.2344; val_chrom_access_recon_loss: 1900558.9250; val_global_loss: 15996945.6000; val_optim_loss: 15996945.6000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9753; val_auprc_score: 0.9685; val_best_acc_score: 0.9290; val_best_f1_score: 0.9316; train_kl_reg_loss: 73190.7094; train_edge_recon_loss: 2686550.1546; train_gene_expr_recon_loss: 11300075.8321; train_masked_gp_l1_reg_loss: 107648.4543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62255.1134; train_chrom_access_recon_loss: 1946438.8359; train_global_loss: 16176159.0153; train_optim_loss: 16176159.0153; val_kl_reg_loss: 71597.4729; val_edge_recon_loss: 2682057.3833; val_gene_expr_recon_loss: 11157688.3333; val_masked_gp_l1_reg_loss: 107690.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62958.6406; val_chrom_access_recon_loss: 1890894.4250; val_global_loss: 15972887.6667; val_optim_loss: 15972887.6667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9746; val_auprc_score: 0.9673; val_best_acc_score: 0.9281; val_best_f1_score: 0.9307; train_kl_reg_loss: 73699.1790; train_edge_recon_loss: 2682020.4084; train_gene_expr_recon_loss: 11277321.6947; train_masked_gp_l1_reg_loss: 107450.5440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62439.1899; train_chrom_access_recon_loss: 1942000.3340; train_global_loss: 16144931.4275; train_optim_loss: 16144931.4275; val_kl_reg_loss: 73518.2802; val_edge_recon_loss: 2676994.7667; val_gene_expr_recon_loss: 11135067.9333; val_masked_gp_l1_reg_loss: 107598.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63359.7461; val_chrom_access_recon_loss: 1896140.2250; val_global_loss: 15952680.2667; val_optim_loss: 15952680.2667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9788; val_auprc_score: 0.9745; val_best_acc_score: 0.9326; val_best_f1_score: 0.9342; train_kl_reg_loss: 72646.3692; train_edge_recon_loss: 2678371.5744; train_gene_expr_recon_loss: 11277698.2366; train_masked_gp_l1_reg_loss: 107213.8811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62506.0099; train_chrom_access_recon_loss: 1941767.8406; train_global_loss: 16140203.9237; train_optim_loss: 16140203.9237; val_kl_reg_loss: 71310.1656; val_edge_recon_loss: 2697399.1833; val_gene_expr_recon_loss: 11077682.8000; val_masked_gp_l1_reg_loss: 107320.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62695.1641; val_chrom_access_recon_loss: 1881971.7333; val_global_loss: 15898379.8667; val_optim_loss: 15898379.8667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9747; val_auprc_score: 0.9668; val_best_acc_score: 0.9306; val_best_f1_score: 0.9329; train_kl_reg_loss: 72257.3196; train_edge_recon_loss: 2680521.6450; train_gene_expr_recon_loss: 11279382.6031; train_masked_gp_l1_reg_loss: 107021.2220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62658.0108; train_chrom_access_recon_loss: 1942601.5086; train_global_loss: 16144442.2366; train_optim_loss: 16144442.2366; val_kl_reg_loss: 71703.3880; val_edge_recon_loss: 2687295.4000; val_gene_expr_recon_loss: 11039348.5333; val_masked_gp_l1_reg_loss: 106776.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62877.6289; val_chrom_access_recon_loss: 1877038.2583; val_global_loss: 15845039.4667; val_optim_loss: 15845039.4667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9783; val_auprc_score: 0.9718; val_best_acc_score: 0.9363; val_best_f1_score: 0.9378; train_kl_reg_loss: 71532.9681; train_edge_recon_loss: 2679745.3569; train_gene_expr_recon_loss: 11250786.3206; train_masked_gp_l1_reg_loss: 106663.4915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62735.7693; train_chrom_access_recon_loss: 1933604.1794; train_global_loss: 16105068.0458; train_optim_loss: 16105068.0458; val_kl_reg_loss: 72338.7542; val_edge_recon_loss: 2686645.6833; val_gene_expr_recon_loss: 11111748.0000; val_masked_gp_l1_reg_loss: 106778.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62917.3750; val_chrom_access_recon_loss: 1890247.7833; val_global_loss: 15930676.2000; val_optim_loss: 15930676.2000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9775; val_auprc_score: 0.9699; val_best_acc_score: 0.9378; val_best_f1_score: 0.9397; train_kl_reg_loss: 72375.6435; train_edge_recon_loss: 2680087.5267; train_gene_expr_recon_loss: 11237809.5649; train_masked_gp_l1_reg_loss: 106539.1026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62873.3317; train_chrom_access_recon_loss: 1931733.6966; train_global_loss: 16091418.9542; train_optim_loss: 16091418.9542; val_kl_reg_loss: 70026.9604; val_edge_recon_loss: 2676558.4500; val_gene_expr_recon_loss: 11115991.7333; val_masked_gp_l1_reg_loss: 106427.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63473.5469; val_chrom_access_recon_loss: 1889141.8750; val_global_loss: 15921621.2667; val_optim_loss: 15921621.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9783; val_auprc_score: 0.9731; val_best_acc_score: 0.9322; val_best_f1_score: 0.9347; train_kl_reg_loss: 71365.3198; train_edge_recon_loss: 2677090.3416; train_gene_expr_recon_loss: 11244910.0000; train_masked_gp_l1_reg_loss: 106329.3278; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63152.5768; train_chrom_access_recon_loss: 1933682.4685; train_global_loss: 16096530.0458; train_optim_loss: 16096530.0458; val_kl_reg_loss: 69413.4745; val_edge_recon_loss: 2699420.9500; val_gene_expr_recon_loss: 11075551.6667; val_masked_gp_l1_reg_loss: 106521.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63845.9062; val_chrom_access_recon_loss: 1873946.0500; val_global_loss: 15888699.2667; val_optim_loss: 15888699.2667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9800; val_auprc_score: 0.9722; val_best_acc_score: 0.9406; val_best_f1_score: 0.9418; train_kl_reg_loss: 70222.2978; train_edge_recon_loss: 2678860.8760; train_gene_expr_recon_loss: 11236874.9771; train_masked_gp_l1_reg_loss: 106070.3434; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63334.7798; train_chrom_access_recon_loss: 1931471.3483; train_global_loss: 16086834.6260; train_optim_loss: 16086834.6260; val_kl_reg_loss: 69808.1411; val_edge_recon_loss: 2690875.5167; val_gene_expr_recon_loss: 11064940.6000; val_masked_gp_l1_reg_loss: 105912.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63649.6172; val_chrom_access_recon_loss: 1877453.3833; val_global_loss: 15872639.7333; val_optim_loss: 15872639.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9781; val_auprc_score: 0.9703; val_best_acc_score: 0.9336; val_best_f1_score: 0.9352; train_kl_reg_loss: 71754.0042; train_edge_recon_loss: 2668581.6107; train_gene_expr_recon_loss: 11213203.7557; train_masked_gp_l1_reg_loss: 101820.7217; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50569.2321; train_chrom_access_recon_loss: 1924998.5677; train_global_loss: 16030928.0076; train_optim_loss: 16030928.0076; val_kl_reg_loss: 74438.8203; val_edge_recon_loss: 2692471.8333; val_gene_expr_recon_loss: 11083761.0000; val_masked_gp_l1_reg_loss: 100787.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48269.7070; val_chrom_access_recon_loss: 1881016.2750; val_global_loss: 15880746.0000; val_optim_loss: 15880746.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9815; val_auprc_score: 0.9766; val_best_acc_score: 0.9406; val_best_f1_score: 0.9417; train_kl_reg_loss: 74042.6100; train_edge_recon_loss: 2670670.8626; train_gene_expr_recon_loss: 11201133.1450; train_masked_gp_l1_reg_loss: 100641.3129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47760.1986; train_chrom_access_recon_loss: 1923588.1336; train_global_loss: 16017836.2672; train_optim_loss: 16017836.2672; val_kl_reg_loss: 75380.8573; val_edge_recon_loss: 2678069.4833; val_gene_expr_recon_loss: 11120733.4667; val_masked_gp_l1_reg_loss: 100505.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47358.0234; val_chrom_access_recon_loss: 1885430.1583; val_global_loss: 15907477.9333; val_optim_loss: 15907477.9333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9797; val_auprc_score: 0.9727; val_best_acc_score: 0.9391; val_best_f1_score: 0.9402; train_kl_reg_loss: 74768.5506; train_edge_recon_loss: 2665210.9179; train_gene_expr_recon_loss: 11209432.4580; train_masked_gp_l1_reg_loss: 100402.9528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47036.9875; train_chrom_access_recon_loss: 1922900.0219; train_global_loss: 16019751.8702; train_optim_loss: 16019751.8702; val_kl_reg_loss: 75053.0172; val_edge_recon_loss: 2673469.5500; val_gene_expr_recon_loss: 11072234.9333; val_masked_gp_l1_reg_loss: 100377.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46862.2148; val_chrom_access_recon_loss: 1878477.8333; val_global_loss: 15846475.4000; val_optim_loss: 15846475.4000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9819; val_auprc_score: 0.9762; val_best_acc_score: 0.9431; val_best_f1_score: 0.9451; train_kl_reg_loss: 74734.3341; train_edge_recon_loss: 2666005.7595; train_gene_expr_recon_loss: 11201181.4275; train_masked_gp_l1_reg_loss: 100310.5897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46630.1189; train_chrom_access_recon_loss: 1922046.7595; train_global_loss: 16010908.9237; train_optim_loss: 16010908.9237; val_kl_reg_loss: 75195.2120; val_edge_recon_loss: 2662599.3667; val_gene_expr_recon_loss: 11049241.4000; val_masked_gp_l1_reg_loss: 100251.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46473.0625; val_chrom_access_recon_loss: 1873405.8583; val_global_loss: 15807165.7333; val_optim_loss: 15807165.7333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9808; val_auprc_score: 0.9760; val_best_acc_score: 0.9391; val_best_f1_score: 0.9404; train_kl_reg_loss: 75273.8121; train_edge_recon_loss: 2665211.4771; train_gene_expr_recon_loss: 11198869.5802; train_masked_gp_l1_reg_loss: 100229.7081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46312.6332; train_chrom_access_recon_loss: 1919468.8387; train_global_loss: 16005366.0382; train_optim_loss: 16005366.0382; val_kl_reg_loss: 76428.9141; val_edge_recon_loss: 2687721.4667; val_gene_expr_recon_loss: 11102400.1333; val_masked_gp_l1_reg_loss: 100174.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46169.5625; val_chrom_access_recon_loss: 1875614.6250; val_global_loss: 15888510.0667; val_optim_loss: 15888510.0667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9807; val_auprc_score: 0.9742; val_best_acc_score: 0.9403; val_best_f1_score: 0.9415; train_kl_reg_loss: 74435.4553; train_edge_recon_loss: 2662718.0439; train_gene_expr_recon_loss: 11206911.7176; train_masked_gp_l1_reg_loss: 100143.1065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46021.1011; train_chrom_access_recon_loss: 1922783.7805; train_global_loss: 16013013.2519; train_optim_loss: 16013013.2519; val_kl_reg_loss: 74168.4141; val_edge_recon_loss: 2680525.7167; val_gene_expr_recon_loss: 11076433.4667; val_masked_gp_l1_reg_loss: 100117.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45938.6289; val_chrom_access_recon_loss: 1880492.5667; val_global_loss: 15857677.2000; val_optim_loss: 15857677.2000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9813; val_auprc_score: 0.9759; val_best_acc_score: 0.9429; val_best_f1_score: 0.9445; train_kl_reg_loss: 74504.9365; train_edge_recon_loss: 2668154.7080; train_gene_expr_recon_loss: 11195141.8855; train_masked_gp_l1_reg_loss: 100107.7364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45812.0377; train_chrom_access_recon_loss: 1920308.8235; train_global_loss: 16004030.1374; train_optim_loss: 16004030.1374; val_kl_reg_loss: 74692.7604; val_edge_recon_loss: 2660821.5333; val_gene_expr_recon_loss: 11022814.4000; val_masked_gp_l1_reg_loss: 100091.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45739.3281; val_chrom_access_recon_loss: 1865887.5500; val_global_loss: 15770046.1333; val_optim_loss: 15770046.1333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9819; val_auprc_score: 0.9760; val_best_acc_score: 0.9418; val_best_f1_score: 0.9437; train_kl_reg_loss: 75056.6020; train_edge_recon_loss: 2662299.8034; train_gene_expr_recon_loss: 11189049.4656; train_masked_gp_l1_reg_loss: 100032.5059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45583.0099; train_chrom_access_recon_loss: 1919236.3817; train_global_loss: 15991257.8015; train_optim_loss: 15991257.8015; val_kl_reg_loss: 75750.3630; val_edge_recon_loss: 2661747.9500; val_gene_expr_recon_loss: 11050974.9333; val_masked_gp_l1_reg_loss: 99993.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45445.7734; val_chrom_access_recon_loss: 1873789.2167; val_global_loss: 15807701.3333; val_optim_loss: 15807701.3333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9811; val_auprc_score: 0.9749; val_best_acc_score: 0.9404; val_best_f1_score: 0.9415; train_kl_reg_loss: 75009.8844; train_edge_recon_loss: 2664408.2309; train_gene_expr_recon_loss: 11198661.0763; train_masked_gp_l1_reg_loss: 99977.1147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45364.2154; train_chrom_access_recon_loss: 1920505.0611; train_global_loss: 16003925.4962; train_optim_loss: 16003925.4962; val_kl_reg_loss: 75360.8896; val_edge_recon_loss: 2674804.6667; val_gene_expr_recon_loss: 11039138.8000; val_masked_gp_l1_reg_loss: 99943.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45207.4297; val_chrom_access_recon_loss: 1881488.4917; val_global_loss: 15815942.8000; val_optim_loss: 15815942.8000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9813; val_auprc_score: 0.9743; val_best_acc_score: 0.9403; val_best_f1_score: 0.9422; train_kl_reg_loss: 75313.5896; train_edge_recon_loss: 2665934.3263; train_gene_expr_recon_loss: 11200441.0840; train_masked_gp_l1_reg_loss: 99894.2676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45096.4764; train_chrom_access_recon_loss: 1921207.6441; train_global_loss: 16007887.3969; train_optim_loss: 16007887.3969; val_kl_reg_loss: 74848.1135; val_edge_recon_loss: 2678199.9500; val_gene_expr_recon_loss: 11086273.8667; val_masked_gp_l1_reg_loss: 99865.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44979.7031; val_chrom_access_recon_loss: 1881820.3667; val_global_loss: 15865987.0667; val_optim_loss: 15865987.0667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9811; val_auprc_score: 0.9761; val_best_acc_score: 0.9391; val_best_f1_score: 0.9412; train_kl_reg_loss: 74217.4955; train_edge_recon_loss: 2671798.4752; train_gene_expr_recon_loss: 11191446.2061; train_masked_gp_l1_reg_loss: 99833.1099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44920.2841; train_chrom_access_recon_loss: 1918858.1718; train_global_loss: 16001073.7405; train_optim_loss: 16001073.7405; val_kl_reg_loss: 74440.3974; val_edge_recon_loss: 2677357.8667; val_gene_expr_recon_loss: 11055519.8667; val_masked_gp_l1_reg_loss: 99802.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44858.4805; val_chrom_access_recon_loss: 1875479.7917; val_global_loss: 15827458.8667; val_optim_loss: 15827458.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9799; val_auprc_score: 0.9703; val_best_acc_score: 0.9369; val_best_f1_score: 0.9382; train_kl_reg_loss: 74171.5683; train_edge_recon_loss: 2668940.7805; train_gene_expr_recon_loss: 11188184.9618; train_masked_gp_l1_reg_loss: 99336.7824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43545.7743; train_chrom_access_recon_loss: 1917775.5487; train_global_loss: 15991955.4046; train_optim_loss: 15991955.4046; val_kl_reg_loss: 74670.7344; val_edge_recon_loss: 2684302.2500; val_gene_expr_recon_loss: 11058422.1333; val_masked_gp_l1_reg_loss: 99175.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43291.9297; val_chrom_access_recon_loss: 1867733.2083; val_global_loss: 15827596.2667; val_optim_loss: 15827596.2667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9811; val_auprc_score: 0.9742; val_best_acc_score: 0.9415; val_best_f1_score: 0.9430; train_kl_reg_loss: 74429.6723; train_edge_recon_loss: 2667195.7901; train_gene_expr_recon_loss: 11197144.5725; train_masked_gp_l1_reg_loss: 99139.5346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43210.2564; train_chrom_access_recon_loss: 1920285.2939; train_global_loss: 16001405.1145; train_optim_loss: 16001405.1145; val_kl_reg_loss: 75207.5974; val_edge_recon_loss: 2655029.5500; val_gene_expr_recon_loss: 11084280.1333; val_masked_gp_l1_reg_loss: 99114.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43152.1016; val_chrom_access_recon_loss: 1882299.8417; val_global_loss: 15839083.1333; val_optim_loss: 15839083.1333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9809; val_auprc_score: 0.9752; val_best_acc_score: 0.9409; val_best_f1_score: 0.9427; train_kl_reg_loss: 74512.4792; train_edge_recon_loss: 2667544.4160; train_gene_expr_recon_loss: 11196223.1069; train_masked_gp_l1_reg_loss: 99100.2699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43107.1943; train_chrom_access_recon_loss: 1920057.1574; train_global_loss: 16000544.6412; train_optim_loss: 16000544.6412; val_kl_reg_loss: 75003.9724; val_edge_recon_loss: 2672169.7833; val_gene_expr_recon_loss: 11073210.8000; val_masked_gp_l1_reg_loss: 99081.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43060.0781; val_chrom_access_recon_loss: 1877210.8833; val_global_loss: 15839736.4000; val_optim_loss: 15839736.4000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9804; val_auprc_score: 0.9747; val_best_acc_score: 0.9398; val_best_f1_score: 0.9411; train_kl_reg_loss: 74592.8093; train_edge_recon_loss: 2663567.6107; train_gene_expr_recon_loss: 11188555.5496; train_masked_gp_l1_reg_loss: 99076.8266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43034.6333; train_chrom_access_recon_loss: 1919010.2099; train_global_loss: 15987837.6183; train_optim_loss: 15987837.6183; val_kl_reg_loss: 75029.7083; val_edge_recon_loss: 2683078.8333; val_gene_expr_recon_loss: 11045467.6000; val_masked_gp_l1_reg_loss: 99067.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42995.4453; val_chrom_access_recon_loss: 1868388.6000; val_global_loss: 15814027.6000; val_optim_loss: 15814027.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 34 min 46 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9806
val AUPRC score: 0.9751
val best accuracy score: 0.9386
val best F1 score: 0.9403
val target rna MSE score: 1.1263
val source rna MSE score: 0.3995
val target atac MSE score: 0.3210
val source atac MSE score: 0.0954
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
