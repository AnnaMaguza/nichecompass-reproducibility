[True]
Run timestamp: 07082023_182530_38.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_38']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8814; val_auprc_score: 0.8984; val_best_acc_score: 0.5015; val_best_f1_score: 0.6673; train_kl_reg_loss: 9383.9024; train_edge_recon_loss: 35720.5109; train_gene_expr_recon_loss: 1273269.9167; train_masked_gp_l1_reg_loss: 4561.9296; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119416.1189; train_chrom_access_recon_loss: 919330.3924; train_global_loss: 2361682.7500; train_optim_loss: 2361682.7500; val_kl_reg_loss: 6678.3916; val_edge_recon_loss: 40656.2539; val_gene_expr_recon_loss: 1176784.7500; val_masked_gp_l1_reg_loss: 4042.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117292.8516; val_chrom_access_recon_loss: 550941.6250; val_global_loss: 1896396.0000; val_optim_loss: 1896396.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9038; val_auprc_score: 0.9169; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7706.2982; train_edge_recon_loss: 36963.9323; train_gene_expr_recon_loss: 1079443.3403; train_masked_gp_l1_reg_loss: 3890.3504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116063.8533; train_chrom_access_recon_loss: 512804.5000; train_global_loss: 1756872.2222; train_optim_loss: 1756872.2222; val_kl_reg_loss: 9578.7578; val_edge_recon_loss: 40659.1758; val_gene_expr_recon_loss: 973017.0000; val_masked_gp_l1_reg_loss: 3823.1401; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114582.6953; val_chrom_access_recon_loss: 483971.8125; val_global_loss: 1625632.5000; val_optim_loss: 1625632.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8965; val_auprc_score: 0.9050; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 14689.2642; train_edge_recon_loss: 38030.4210; train_gene_expr_recon_loss: 900608.6111; train_masked_gp_l1_reg_loss: 3895.9905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113416.1293; train_chrom_access_recon_loss: 480748.7396; train_global_loss: 1551389.1667; train_optim_loss: 1551389.1667; val_kl_reg_loss: 19102.6680; val_edge_recon_loss: 40660.5312; val_gene_expr_recon_loss: 829010.9375; val_masked_gp_l1_reg_loss: 3969.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111909.0547; val_chrom_access_recon_loss: 478672.4688; val_global_loss: 1483325.0000; val_optim_loss: 1483325.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8817; val_auprc_score: 0.8902; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 19941.9316; train_edge_recon_loss: 38717.6927; train_gene_expr_recon_loss: 801663.3194; train_masked_gp_l1_reg_loss: 3973.2999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110576.7240; train_chrom_access_recon_loss: 468726.5799; train_global_loss: 1443599.5278; train_optim_loss: 1443599.5278; val_kl_reg_loss: 18557.2305; val_edge_recon_loss: 40658.2461; val_gene_expr_recon_loss: 769645.1250; val_masked_gp_l1_reg_loss: 3960.6963; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108822.0469; val_chrom_access_recon_loss: 459831.3438; val_global_loss: 1401474.7500; val_optim_loss: 1401474.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8612; val_auprc_score: 0.8768; val_best_acc_score: 0.5097; val_best_f1_score: 0.6710; train_kl_reg_loss: 19913.9731; train_edge_recon_loss: 38666.5764; train_gene_expr_recon_loss: 751491.9722; train_masked_gp_l1_reg_loss: 3959.7664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107291.9601; train_chrom_access_recon_loss: 452259.4306; train_global_loss: 1373583.6944; train_optim_loss: 1373583.6944; val_kl_reg_loss: 21060.1484; val_edge_recon_loss: 40654.6016; val_gene_expr_recon_loss: 730982.5000; val_masked_gp_l1_reg_loss: 3946.4963; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105299.5469; val_chrom_access_recon_loss: 452617.6250; val_global_loss: 1354561.0000; val_optim_loss: 1354561.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8491; val_auprc_score: 0.8603; val_best_acc_score: 0.5233; val_best_f1_score: 0.6761; train_kl_reg_loss: 20575.8839; train_edge_recon_loss: 38781.5569; train_gene_expr_recon_loss: 720911.6181; train_masked_gp_l1_reg_loss: 3928.9871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103588.6276; train_chrom_access_recon_loss: 449227.8125; train_global_loss: 1337014.4861; train_optim_loss: 1337014.4861; val_kl_reg_loss: 20308.0645; val_edge_recon_loss: 40640.8555; val_gene_expr_recon_loss: 710962.2500; val_masked_gp_l1_reg_loss: 3909.2588; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101396.9141; val_chrom_access_recon_loss: 448478.5000; val_global_loss: 1325695.8750; val_optim_loss: 1325695.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8620; val_auprc_score: 0.8661; val_best_acc_score: 0.5309; val_best_f1_score: 0.6779; train_kl_reg_loss: 20749.0677; train_edge_recon_loss: 38791.3303; train_gene_expr_recon_loss: 707566.8542; train_masked_gp_l1_reg_loss: 3895.8440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99584.2595; train_chrom_access_recon_loss: 447567.6076; train_global_loss: 1318154.9861; train_optim_loss: 1318154.9861; val_kl_reg_loss: 20335.6445; val_edge_recon_loss: 40619.9219; val_gene_expr_recon_loss: 695788.8750; val_masked_gp_l1_reg_loss: 3876.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97298.0000; val_chrom_access_recon_loss: 445702.0625; val_global_loss: 1303620.6250; val_optim_loss: 1303620.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8657; val_auprc_score: 0.8691; val_best_acc_score: 0.5490; val_best_f1_score: 0.6853; train_kl_reg_loss: 20442.4180; train_edge_recon_loss: 38794.4813; train_gene_expr_recon_loss: 689895.1319; train_masked_gp_l1_reg_loss: 3870.5224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95455.2405; train_chrom_access_recon_loss: 441474.8056; train_global_loss: 1289932.5833; train_optim_loss: 1289932.5833; val_kl_reg_loss: 20520.4414; val_edge_recon_loss: 40597.3594; val_gene_expr_recon_loss: 684251.9375; val_masked_gp_l1_reg_loss: 3858.3860; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93147.1953; val_chrom_access_recon_loss: 443658.4375; val_global_loss: 1286033.7500; val_optim_loss: 1286033.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8437; val_auprc_score: 0.8448; val_best_acc_score: 0.5757; val_best_f1_score: 0.6966; train_kl_reg_loss: 20640.3698; train_edge_recon_loss: 38836.7040; train_gene_expr_recon_loss: 679814.5069; train_masked_gp_l1_reg_loss: 3850.2387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91304.1354; train_chrom_access_recon_loss: 440959.8264; train_global_loss: 1275405.7778; train_optim_loss: 1275405.7778; val_kl_reg_loss: 20190.4414; val_edge_recon_loss: 40580.9805; val_gene_expr_recon_loss: 675725.5000; val_masked_gp_l1_reg_loss: 3840.7817; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89008.7656; val_chrom_access_recon_loss: 442062.5625; val_global_loss: 1271409.0000; val_optim_loss: 1271409.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8271; val_auprc_score: 0.8275; val_best_acc_score: 0.5961; val_best_f1_score: 0.7054; train_kl_reg_loss: 20788.2726; train_edge_recon_loss: 38848.5139; train_gene_expr_recon_loss: 675427.7431; train_masked_gp_l1_reg_loss: 3840.5869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87194.0460; train_chrom_access_recon_loss: 441248.1493; train_global_loss: 1267347.3333; train_optim_loss: 1267347.3333; val_kl_reg_loss: 20121.2539; val_edge_recon_loss: 40554.5352; val_gene_expr_recon_loss: 669511.1250; val_masked_gp_l1_reg_loss: 3833.2158; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84939.4688; val_chrom_access_recon_loss: 440913.7188; val_global_loss: 1259873.3750; val_optim_loss: 1259873.3750
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8190; val_auprc_score: 0.8215; val_best_acc_score: 0.6202; val_best_f1_score: 0.7165; train_kl_reg_loss: 20495.4861; train_edge_recon_loss: 38827.9779; train_gene_expr_recon_loss: 667377.1458; train_masked_gp_l1_reg_loss: 3837.4887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83166.0712; train_chrom_access_recon_loss: 439112.0833; train_global_loss: 1252816.2639; train_optim_loss: 1252816.2639; val_kl_reg_loss: 19977.6016; val_edge_recon_loss: 40538.7773; val_gene_expr_recon_loss: 664604.4375; val_masked_gp_l1_reg_loss: 3836.1375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80963.9453; val_chrom_access_recon_loss: 439765.0000; val_global_loss: 1249685.8750; val_optim_loss: 1249685.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8239; val_auprc_score: 0.8235; val_best_acc_score: 0.6555; val_best_f1_score: 0.7328; train_kl_reg_loss: 20194.1701; train_edge_recon_loss: 38809.6806; train_gene_expr_recon_loss: 662755.2083; train_masked_gp_l1_reg_loss: 3839.0209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79239.3472; train_chrom_access_recon_loss: 438168.2639; train_global_loss: 1243005.6667; train_optim_loss: 1243005.6667; val_kl_reg_loss: 19497.4375; val_edge_recon_loss: 40505.8984; val_gene_expr_recon_loss: 661121.6875; val_masked_gp_l1_reg_loss: 3834.4067; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77105.5469; val_chrom_access_recon_loss: 438502.2812; val_global_loss: 1240567.2500; val_optim_loss: 1240567.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8206; val_auprc_score: 0.8165; val_best_acc_score: 0.6836; val_best_f1_score: 0.7465; train_kl_reg_loss: 20072.7303; train_edge_recon_loss: 38791.7231; train_gene_expr_recon_loss: 661398.5000; train_masked_gp_l1_reg_loss: 3839.4405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75442.9323; train_chrom_access_recon_loss: 438075.8507; train_global_loss: 1237621.1806; train_optim_loss: 1237621.1806; val_kl_reg_loss: 19192.2070; val_edge_recon_loss: 40469.3828; val_gene_expr_recon_loss: 657974.8125; val_masked_gp_l1_reg_loss: 3839.3042; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73386.4375; val_chrom_access_recon_loss: 437561.4375; val_global_loss: 1232423.5000; val_optim_loss: 1232423.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8349; val_auprc_score: 0.8340; val_best_acc_score: 0.7119; val_best_f1_score: 0.7602; train_kl_reg_loss: 19587.3568; train_edge_recon_loss: 38746.4327; train_gene_expr_recon_loss: 655177.1806; train_masked_gp_l1_reg_loss: 3844.4411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71787.2891; train_chrom_access_recon_loss: 433283.7847; train_global_loss: 1222426.4444; train_optim_loss: 1222426.4444; val_kl_reg_loss: 19198.0664; val_edge_recon_loss: 40434.0938; val_gene_expr_recon_loss: 654916.3750; val_masked_gp_l1_reg_loss: 3846.7380; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69815.4219; val_chrom_access_recon_loss: 436410.8438; val_global_loss: 1224621.6250; val_optim_loss: 1224621.6250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8457; val_auprc_score: 0.8490; val_best_acc_score: 0.7361; val_best_f1_score: 0.7697; train_kl_reg_loss: 19438.5885; train_edge_recon_loss: 38729.4180; train_gene_expr_recon_loss: 655599.7639; train_masked_gp_l1_reg_loss: 3854.3335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68293.0243; train_chrom_access_recon_loss: 436462.7049; train_global_loss: 1222377.8472; train_optim_loss: 1222377.8472; val_kl_reg_loss: 18288.6211; val_edge_recon_loss: 40388.1914; val_gene_expr_recon_loss: 653022.7500; val_masked_gp_l1_reg_loss: 3858.1448; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66412.2109; val_chrom_access_recon_loss: 435449.0625; val_global_loss: 1217419.0000; val_optim_loss: 1217419.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8594; val_auprc_score: 0.8597; val_best_acc_score: 0.7724; val_best_f1_score: 0.7893; train_kl_reg_loss: 19046.9112; train_edge_recon_loss: 38683.3359; train_gene_expr_recon_loss: 649749.5278; train_masked_gp_l1_reg_loss: 3872.2745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64961.9696; train_chrom_access_recon_loss: 433240.2986; train_global_loss: 1209554.2917; train_optim_loss: 1209554.2917; val_kl_reg_loss: 17646.2461; val_edge_recon_loss: 40312.4141; val_gene_expr_recon_loss: 652012.2500; val_masked_gp_l1_reg_loss: 3878.5476; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63175.7422; val_chrom_access_recon_loss: 434923.5000; val_global_loss: 1211948.7500; val_optim_loss: 1211948.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8697; val_auprc_score: 0.8685; val_best_acc_score: 0.7879; val_best_f1_score: 0.7995; train_kl_reg_loss: 18761.1215; train_edge_recon_loss: 38628.5946; train_gene_expr_recon_loss: 652907.5000; train_masked_gp_l1_reg_loss: 3885.9052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61807.4648; train_chrom_access_recon_loss: 434317.4965; train_global_loss: 1210308.0972; train_optim_loss: 1210308.0972; val_kl_reg_loss: 18160.8770; val_edge_recon_loss: 40295.9141; val_gene_expr_recon_loss: 648494.0000; val_masked_gp_l1_reg_loss: 3890.6147; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60121.6367; val_chrom_access_recon_loss: 434020.9375; val_global_loss: 1204984.0000; val_optim_loss: 1204984.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8875; val_auprc_score: 0.8863; val_best_acc_score: 0.8092; val_best_f1_score: 0.8094; train_kl_reg_loss: 18417.7389; train_edge_recon_loss: 38549.1519; train_gene_expr_recon_loss: 645714.2778; train_masked_gp_l1_reg_loss: 3902.2937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58830.3585; train_chrom_access_recon_loss: 431635.5694; train_global_loss: 1197049.3889; train_optim_loss: 1197049.3889; val_kl_reg_loss: 17670.4648; val_edge_recon_loss: 40199.1055; val_gene_expr_recon_loss: 647096.1250; val_masked_gp_l1_reg_loss: 3910.9250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57237.3516; val_chrom_access_recon_loss: 433255.2188; val_global_loss: 1199369.2500; val_optim_loss: 1199369.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8916; val_auprc_score: 0.8831; val_best_acc_score: 0.8139; val_best_f1_score: 0.8060; train_kl_reg_loss: 18244.2020; train_edge_recon_loss: 38495.7617; train_gene_expr_recon_loss: 644660.9028; train_masked_gp_l1_reg_loss: 3921.1069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56018.0386; train_chrom_access_recon_loss: 431208.5451; train_global_loss: 1192548.5556; train_optim_loss: 1192548.5556; val_kl_reg_loss: 16736.8203; val_edge_recon_loss: 40066.4883; val_gene_expr_recon_loss: 647023.9375; val_masked_gp_l1_reg_loss: 3926.0471; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54518.0078; val_chrom_access_recon_loss: 433097.7188; val_global_loss: 1195369.0000; val_optim_loss: 1195369.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9021; val_auprc_score: 0.8933; val_best_acc_score: 0.8248; val_best_f1_score: 0.8165; train_kl_reg_loss: 17859.2969; train_edge_recon_loss: 38411.3711; train_gene_expr_recon_loss: 645390.8403; train_masked_gp_l1_reg_loss: 3935.6449; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53373.6593; train_chrom_access_recon_loss: 431756.3785; train_global_loss: 1190727.1944; train_optim_loss: 1190727.1944; val_kl_reg_loss: 17742.1016; val_edge_recon_loss: 40079.1055; val_gene_expr_recon_loss: 643683.7500; val_masked_gp_l1_reg_loss: 3940.9656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51967.2578; val_chrom_access_recon_loss: 432528.7188; val_global_loss: 1189941.8750; val_optim_loss: 1189941.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9103; val_auprc_score: 0.9040; val_best_acc_score: 0.8207; val_best_f1_score: 0.8059; train_kl_reg_loss: 17692.8830; train_edge_recon_loss: 38349.8650; train_gene_expr_recon_loss: 640980.9028; train_masked_gp_l1_reg_loss: 3953.7094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50888.8424; train_chrom_access_recon_loss: 429304.5139; train_global_loss: 1181170.7361; train_optim_loss: 1181170.7361; val_kl_reg_loss: 17067.6934; val_edge_recon_loss: 39942.6836; val_gene_expr_recon_loss: 642426.1250; val_masked_gp_l1_reg_loss: 3962.9172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49559.4844; val_chrom_access_recon_loss: 431675.9375; val_global_loss: 1184634.8750; val_optim_loss: 1184634.8750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9177; val_auprc_score: 0.9124; val_best_acc_score: 0.8164; val_best_f1_score: 0.7956; train_kl_reg_loss: 17435.2151; train_edge_recon_loss: 38275.7812; train_gene_expr_recon_loss: 643989.2431; train_masked_gp_l1_reg_loss: 3972.8045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48547.1602; train_chrom_access_recon_loss: 431725.6111; train_global_loss: 1183945.8194; train_optim_loss: 1183945.8194; val_kl_reg_loss: 16482.8281; val_edge_recon_loss: 39842.8203; val_gene_expr_recon_loss: 641948.2500; val_masked_gp_l1_reg_loss: 3978.3296; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47298.9414; val_chrom_access_recon_loss: 431026.9375; val_global_loss: 1180578.0000; val_optim_loss: 1180578.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9186; val_auprc_score: 0.9118; val_best_acc_score: 0.8170; val_best_f1_score: 0.8061; train_kl_reg_loss: 17332.3559; train_edge_recon_loss: 38207.0156; train_gene_expr_recon_loss: 641692.1806; train_masked_gp_l1_reg_loss: 3988.9236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46348.6146; train_chrom_access_recon_loss: 429919.2222; train_global_loss: 1177488.3194; train_optim_loss: 1177488.3194; val_kl_reg_loss: 16714.3477; val_edge_recon_loss: 39818.9023; val_gene_expr_recon_loss: 639926.0000; val_masked_gp_l1_reg_loss: 3994.6294; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45175.5859; val_chrom_access_recon_loss: 430477.2500; val_global_loss: 1176106.7500; val_optim_loss: 1176106.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9235; val_auprc_score: 0.9172; val_best_acc_score: 0.8112; val_best_f1_score: 0.8239; train_kl_reg_loss: 16990.3242; train_edge_recon_loss: 38143.3880; train_gene_expr_recon_loss: 638724.5833; train_masked_gp_l1_reg_loss: 4008.6052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44279.6593; train_chrom_access_recon_loss: 428844.0174; train_global_loss: 1170990.5833; train_optim_loss: 1170990.5833; val_kl_reg_loss: 16087.0586; val_edge_recon_loss: 39722.1602; val_gene_expr_recon_loss: 639606.0000; val_masked_gp_l1_reg_loss: 4016.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43168.0391; val_chrom_access_recon_loss: 429843.6875; val_global_loss: 1172443.2500; val_optim_loss: 1172443.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9223; val_auprc_score: 0.9166; val_best_acc_score: 0.8045; val_best_f1_score: 0.8314; train_kl_reg_loss: 16822.7993; train_edge_recon_loss: 38087.9978; train_gene_expr_recon_loss: 635537.2917; train_masked_gp_l1_reg_loss: 4026.6741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42323.5747; train_chrom_access_recon_loss: 427316.5208; train_global_loss: 1164114.8333; train_optim_loss: 1164114.8333; val_kl_reg_loss: 16091.5996; val_edge_recon_loss: 39676.7031; val_gene_expr_recon_loss: 638190.4375; val_masked_gp_l1_reg_loss: 4035.4072; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41277.2227; val_chrom_access_recon_loss: 429340.9062; val_global_loss: 1168612.3750; val_optim_loss: 1168612.3750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9156; val_auprc_score: 0.9104; val_best_acc_score: 0.8395; val_best_f1_score: 0.8351; train_kl_reg_loss: 14484.5864; train_edge_recon_loss: 39705.3190; train_gene_expr_recon_loss: 996675.2361; train_masked_gp_l1_reg_loss: 4111.1599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40373.6393; train_chrom_access_recon_loss: 452121.9514; train_global_loss: 1547471.9306; train_optim_loss: 1547471.9306; val_kl_reg_loss: 11635.4648; val_edge_recon_loss: 40127.0039; val_gene_expr_recon_loss: 996619.0000; val_masked_gp_l1_reg_loss: 4238.0562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39191.8203; val_chrom_access_recon_loss: 454014.8438; val_global_loss: 1545826.2500; val_optim_loss: 1545826.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9164; val_auprc_score: 0.9114; val_best_acc_score: 0.8390; val_best_f1_score: 0.8363; train_kl_reg_loss: 13363.0996; train_edge_recon_loss: 39792.7569; train_gene_expr_recon_loss: 991611.9514; train_masked_gp_l1_reg_loss: 4347.1373; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38226.7938; train_chrom_access_recon_loss: 450425.5312; train_global_loss: 1537767.2917; train_optim_loss: 1537767.2917; val_kl_reg_loss: 11494.6445; val_edge_recon_loss: 40160.2891; val_gene_expr_recon_loss: 989581.3125; val_masked_gp_l1_reg_loss: 4467.1855; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37036.8789; val_chrom_access_recon_loss: 452934.8125; val_global_loss: 1535675.2500; val_optim_loss: 1535675.2500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9255; val_auprc_score: 0.9216; val_best_acc_score: 0.8465; val_best_f1_score: 0.8427; train_kl_reg_loss: 13145.0487; train_edge_recon_loss: 39798.2513; train_gene_expr_recon_loss: 984357.3750; train_masked_gp_l1_reg_loss: 4548.1355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36121.4696; train_chrom_access_recon_loss: 450503.1181; train_global_loss: 1528473.3889; train_optim_loss: 1528473.3889; val_kl_reg_loss: 12045.2236; val_edge_recon_loss: 40131.1172; val_gene_expr_recon_loss: 983458.1875; val_masked_gp_l1_reg_loss: 4633.9409; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35002.0859; val_chrom_access_recon_loss: 452016.4688; val_global_loss: 1527287.0000; val_optim_loss: 1527287.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9277; val_auprc_score: 0.9215; val_best_acc_score: 0.8513; val_best_f1_score: 0.8450; train_kl_reg_loss: 13183.6125; train_edge_recon_loss: 39747.4614; train_gene_expr_recon_loss: 977881.1042; train_masked_gp_l1_reg_loss: 4684.3398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34150.4353; train_chrom_access_recon_loss: 450267.5312; train_global_loss: 1519914.4444; train_optim_loss: 1519914.4444; val_kl_reg_loss: 12134.5586; val_edge_recon_loss: 40076.8594; val_gene_expr_recon_loss: 979223.6250; val_masked_gp_l1_reg_loss: 4738.2476; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33112.4961; val_chrom_access_recon_loss: 451593.1250; val_global_loss: 1520878.8750; val_optim_loss: 1520878.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9252; val_auprc_score: 0.9186; val_best_acc_score: 0.8430; val_best_f1_score: 0.8376; train_kl_reg_loss: 13081.2630; train_edge_recon_loss: 39717.0447; train_gene_expr_recon_loss: 981595.8750; train_masked_gp_l1_reg_loss: 4726.5678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32997.0074; train_chrom_access_recon_loss: 449190.2604; train_global_loss: 1521307.9722; train_optim_loss: 1521307.9722; val_kl_reg_loss: 12160.5312; val_edge_recon_loss: 40069.6133; val_gene_expr_recon_loss: 978919.0000; val_masked_gp_l1_reg_loss: 4716.3608; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32856.5078; val_chrom_access_recon_loss: 451475.0000; val_global_loss: 1520197.0000; val_optim_loss: 1520197.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9300; val_auprc_score: 0.9234; val_best_acc_score: 0.8475; val_best_f1_score: 0.8407; train_kl_reg_loss: 13138.5227; train_edge_recon_loss: 39696.6810; train_gene_expr_recon_loss: 983005.2083; train_masked_gp_l1_reg_loss: 4715.2612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32757.3800; train_chrom_access_recon_loss: 451886.6910; train_global_loss: 1525199.7778; train_optim_loss: 1525199.7778; val_kl_reg_loss: 12131.1367; val_edge_recon_loss: 40045.5586; val_gene_expr_recon_loss: 978681.3750; val_masked_gp_l1_reg_loss: 4712.5806; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32632.9590; val_chrom_access_recon_loss: 451448.0625; val_global_loss: 1519651.7500; val_optim_loss: 1519651.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9320; val_auprc_score: 0.9247; val_best_acc_score: 0.8495; val_best_f1_score: 0.8422; train_kl_reg_loss: 13066.8295; train_edge_recon_loss: 39683.1341; train_gene_expr_recon_loss: 974199.2361; train_masked_gp_l1_reg_loss: 4711.9457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32538.4293; train_chrom_access_recon_loss: 447197.7188; train_global_loss: 1511397.3056; train_optim_loss: 1511397.3056; val_kl_reg_loss: 12179.7793; val_edge_recon_loss: 40041.1445; val_gene_expr_recon_loss: 978278.2500; val_masked_gp_l1_reg_loss: 4711.4404; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32422.1191; val_chrom_access_recon_loss: 451335.5938; val_global_loss: 1518968.3750; val_optim_loss: 1518968.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9259; val_auprc_score: 0.9183; val_best_acc_score: 0.8432; val_best_f1_score: 0.8363; train_kl_reg_loss: 13100.9721; train_edge_recon_loss: 39674.6762; train_gene_expr_recon_loss: 973277.2083; train_masked_gp_l1_reg_loss: 4711.5838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32331.6532; train_chrom_access_recon_loss: 449954.2257; train_global_loss: 1513050.3611; train_optim_loss: 1513050.3611; val_kl_reg_loss: 12126.2949; val_edge_recon_loss: 40044.3164; val_gene_expr_recon_loss: 977965.1250; val_masked_gp_l1_reg_loss: 4712.0010; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32221.7227; val_chrom_access_recon_loss: 451305.9688; val_global_loss: 1518375.5000; val_optim_loss: 1518375.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 36 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9185
val AUPRC score: 0.9062
val best accuracy score: 0.8500
val best F1 score: 0.8506
val target rna MSE score: 3.7952
val source rna MSE score: 3.2207
val target atac MSE score: 0.1340
val source atac MSE score: 0.0202
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
