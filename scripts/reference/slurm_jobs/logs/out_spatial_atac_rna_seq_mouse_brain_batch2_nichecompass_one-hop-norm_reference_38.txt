[True]
Run timestamp: 24072023_164025_38.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_38']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9212; val_auprc_score: 0.9316; val_best_acc_score: 0.5170; val_best_f1_score: 0.6741; train_kl_reg_loss: 7604.5755; train_edge_recon_loss: 3473030.4722; train_gene_expr_recon_loss: 3159740.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1083079.2778; train_global_loss: 7723454.4444; train_optim_loss: 7723454.4444; val_kl_reg_loss: 17948.9648; val_edge_recon_loss: 4063812.7500; val_gene_expr_recon_loss: 2976876.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1058842.3750; val_global_loss: 8117480.5000; val_optim_loss: 8117480.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9053; val_auprc_score: 0.9144; val_best_acc_score: 0.5160; val_best_f1_score: 0.6738; train_kl_reg_loss: 32123.8583; train_edge_recon_loss: 3495930.4167; train_gene_expr_recon_loss: 2895963.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1066962.0139; train_global_loss: 7490979.8333; train_optim_loss: 7490979.8333; val_kl_reg_loss: 30232.1816; val_edge_recon_loss: 4064214.2500; val_gene_expr_recon_loss: 2730633.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1040363.6875; val_global_loss: 7865443.5000; val_optim_loss: 7865443.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9047; val_auprc_score: 0.9067; val_best_acc_score: 0.5154; val_best_f1_score: 0.6733; train_kl_reg_loss: 50710.0862; train_edge_recon_loss: 3504930.2778; train_gene_expr_recon_loss: 2675325.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1047327.6111; train_global_loss: 7278293.6111; train_optim_loss: 7278293.6111; val_kl_reg_loss: 52537.6094; val_edge_recon_loss: 4064263.0000; val_gene_expr_recon_loss: 2522643.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1023022.9375; val_global_loss: 7662466.5000; val_optim_loss: 7662466.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8977; val_auprc_score: 0.8968; val_best_acc_score: 0.5346; val_best_f1_score: 0.6817; train_kl_reg_loss: 69821.9340; train_edge_recon_loss: 3517344.3611; train_gene_expr_recon_loss: 2497010.3056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1032615.6042; train_global_loss: 7116792.2778; train_optim_loss: 7116792.2778; val_kl_reg_loss: 49952.8750; val_edge_recon_loss: 4062851.7500; val_gene_expr_recon_loss: 2408920.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1008561.9375; val_global_loss: 7530287.0000; val_optim_loss: 7530287.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8997; val_auprc_score: 0.8984; val_best_acc_score: 0.5711; val_best_f1_score: 0.6992; train_kl_reg_loss: 72501.8984; train_edge_recon_loss: 3518481.2222; train_gene_expr_recon_loss: 2370343.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1004692.1181; train_global_loss: 6966018.8889; train_optim_loss: 6966018.8889; val_kl_reg_loss: 58569.5625; val_edge_recon_loss: 4061215.0000; val_gene_expr_recon_loss: 2318726.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 997321.8125; val_global_loss: 7435832.5000; val_optim_loss: 7435832.5000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9019; val_auprc_score: 0.8985; val_best_acc_score: 0.6525; val_best_f1_score: 0.7406; train_kl_reg_loss: 77733.4062; train_edge_recon_loss: 3518264.1389; train_gene_expr_recon_loss: 2309226.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 999752.6667; train_global_loss: 6904976.8333; train_optim_loss: 6904976.8333; val_kl_reg_loss: 53552.4375; val_edge_recon_loss: 4057257.5000; val_gene_expr_recon_loss: 2266787.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 991142.0000; val_global_loss: 7368740.0000; val_optim_loss: 7368740.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8908; val_auprc_score: 0.8793; val_best_acc_score: 0.7387; val_best_f1_score: 0.7890; train_kl_reg_loss: 78447.9644; train_edge_recon_loss: 3518172.5278; train_gene_expr_recon_loss: 2257442.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 999675.2500; train_global_loss: 6853737.7222; train_optim_loss: 6853737.7222; val_kl_reg_loss: 58046.0156; val_edge_recon_loss: 4049058.5000; val_gene_expr_recon_loss: 2221925.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 986963.8750; val_global_loss: 7315993.5000; val_optim_loss: 7315993.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8936; val_auprc_score: 0.8769; val_best_acc_score: 0.8073; val_best_f1_score: 0.8259; train_kl_reg_loss: 79968.8628; train_edge_recon_loss: 3517030.0556; train_gene_expr_recon_loss: 2228220.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1001956.7431; train_global_loss: 6827175.8333; train_optim_loss: 6827175.8333; val_kl_reg_loss: 48226.4766; val_edge_recon_loss: 4026330.7500; val_gene_expr_recon_loss: 2193977.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982084.0000; val_global_loss: 7250619.0000; val_optim_loss: 7250619.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8898; val_auprc_score: 0.8706; val_best_acc_score: 0.7960; val_best_f1_score: 0.7959; train_kl_reg_loss: 76707.6784; train_edge_recon_loss: 3510981.3611; train_gene_expr_recon_loss: 2192225.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 993074.5833; train_global_loss: 6772989.1667; train_optim_loss: 6772989.1667; val_kl_reg_loss: 58242.7344; val_edge_recon_loss: 3963605.7500; val_gene_expr_recon_loss: 2166324.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 980671.5000; val_global_loss: 7168844.0000; val_optim_loss: 7168844.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8925; val_auprc_score: 0.8718; val_best_acc_score: 0.8168; val_best_f1_score: 0.8314; train_kl_reg_loss: 65839.0451; train_edge_recon_loss: 3488029.6389; train_gene_expr_recon_loss: 2170648.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 984262.7917; train_global_loss: 6708780.0556; train_optim_loss: 6708780.0556; val_kl_reg_loss: 59293.3984; val_edge_recon_loss: 3784786.7500; val_gene_expr_recon_loss: 2154765.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978722.4375; val_global_loss: 6977568.5000; val_optim_loss: 6977568.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8923; val_auprc_score: 0.8745; val_best_acc_score: 0.8127; val_best_f1_score: 0.8273; train_kl_reg_loss: 51339.9666; train_edge_recon_loss: 3385754.6111; train_gene_expr_recon_loss: 2190248.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 994417.5139; train_global_loss: 6621760.8889; train_optim_loss: 6621760.8889; val_kl_reg_loss: 41453.1719; val_edge_recon_loss: 3313783.5000; val_gene_expr_recon_loss: 2196881.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 984769.1875; val_global_loss: 6536887.0000; val_optim_loss: 6536887.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8740; val_auprc_score: 0.8557; val_best_acc_score: 0.7793; val_best_f1_score: 0.8005; train_kl_reg_loss: 57943.3880; train_edge_recon_loss: 3119674.8333; train_gene_expr_recon_loss: 2230026.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 998152.8125; train_global_loss: 6405797.9444; train_optim_loss: 6405797.9444; val_kl_reg_loss: 82877.1562; val_edge_recon_loss: 3006942.5000; val_gene_expr_recon_loss: 2207755.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 985868.5000; val_global_loss: 6283443.5000; val_optim_loss: 6283443.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8820; val_auprc_score: 0.8654; val_best_acc_score: 0.7813; val_best_f1_score: 0.8094; train_kl_reg_loss: 109950.2188; train_edge_recon_loss: 2949253.0833; train_gene_expr_recon_loss: 2197086.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 989620.0833; train_global_loss: 6245910.3889; train_optim_loss: 6245910.3889; val_kl_reg_loss: 115112.5781; val_edge_recon_loss: 2910603.5000; val_gene_expr_recon_loss: 2170163.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979320.6875; val_global_loss: 6175200.5000; val_optim_loss: 6175200.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8908; val_auprc_score: 0.8779; val_best_acc_score: 0.7951; val_best_f1_score: 0.8128; train_kl_reg_loss: 108998.7031; train_edge_recon_loss: 2916603.6944; train_gene_expr_recon_loss: 2176880.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 987662.1319; train_global_loss: 6190144.8333; train_optim_loss: 6190144.8333; val_kl_reg_loss: 92183.6172; val_edge_recon_loss: 2913543.5000; val_gene_expr_recon_loss: 2155875.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 976739.0000; val_global_loss: 6138341.0000; val_optim_loss: 6138341.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9046; val_auprc_score: 0.8892; val_best_acc_score: 0.8095; val_best_f1_score: 0.8202; train_kl_reg_loss: 95339.3915; train_edge_recon_loss: 2903907.1944; train_gene_expr_recon_loss: 2167549.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982418.8264; train_global_loss: 6149214.4444; train_optim_loss: 6149214.4444; val_kl_reg_loss: 91979.6172; val_edge_recon_loss: 2887992.2500; val_gene_expr_recon_loss: 2146786.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973953.5625; val_global_loss: 6100711.5000; val_optim_loss: 6100711.5000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9142; val_auprc_score: 0.9019; val_best_acc_score: 0.8308; val_best_f1_score: 0.8344; train_kl_reg_loss: 94815.0668; train_edge_recon_loss: 2875573.1944; train_gene_expr_recon_loss: 2167433.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 989058.0486; train_global_loss: 6126879.6111; train_optim_loss: 6126879.6111; val_kl_reg_loss: 85316.6562; val_edge_recon_loss: 2885457.0000; val_gene_expr_recon_loss: 2144626.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974979.8750; val_global_loss: 6090380.0000; val_optim_loss: 6090380.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9266; val_auprc_score: 0.9092; val_best_acc_score: 0.8513; val_best_f1_score: 0.8606; train_kl_reg_loss: 87872.3325; train_edge_recon_loss: 2865088.0000; train_gene_expr_recon_loss: 2148919.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979528.0347; train_global_loss: 6081407.3333; train_optim_loss: 6081407.3333; val_kl_reg_loss: 82492.9219; val_edge_recon_loss: 2842142.5000; val_gene_expr_recon_loss: 2140428.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 973301.3750; val_global_loss: 6038365.5000; val_optim_loss: 6038365.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9377; val_auprc_score: 0.9208; val_best_acc_score: 0.8674; val_best_f1_score: 0.8746; train_kl_reg_loss: 87048.6875; train_edge_recon_loss: 2837630.1944; train_gene_expr_recon_loss: 2135286.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976444.2153; train_global_loss: 6036409.1667; train_optim_loss: 6036409.1667; val_kl_reg_loss: 83187.5469; val_edge_recon_loss: 2829315.0000; val_gene_expr_recon_loss: 2137779.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974260.2500; val_global_loss: 6024542.0000; val_optim_loss: 6024542.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9509; val_auprc_score: 0.9384; val_best_acc_score: 0.8868; val_best_f1_score: 0.8931; train_kl_reg_loss: 89103.0095; train_edge_recon_loss: 2798486.8056; train_gene_expr_recon_loss: 2137982.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 975371.8472; train_global_loss: 6000944.2222; train_optim_loss: 6000944.2222; val_kl_reg_loss: 88370.7812; val_edge_recon_loss: 2797667.5000; val_gene_expr_recon_loss: 2131735.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 972850.6250; val_global_loss: 5990624.0000; val_optim_loss: 5990624.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9525; val_auprc_score: 0.9353; val_best_acc_score: 0.8953; val_best_f1_score: 0.8993; train_kl_reg_loss: 90818.9349; train_edge_recon_loss: 2795838.2222; train_gene_expr_recon_loss: 2138257.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 980093.3750; train_global_loss: 6005007.8889; train_optim_loss: 6005007.8889; val_kl_reg_loss: 85293.2969; val_edge_recon_loss: 2811613.7500; val_gene_expr_recon_loss: 2125873.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971123.5000; val_global_loss: 5993903.5000; val_optim_loss: 5993903.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9614; val_auprc_score: 0.9495; val_best_acc_score: 0.9066; val_best_f1_score: 0.9093; train_kl_reg_loss: 90085.8637; train_edge_recon_loss: 2769844.1667; train_gene_expr_recon_loss: 2129227.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 979382.0764; train_global_loss: 5968539.3889; train_optim_loss: 5968539.3889; val_kl_reg_loss: 87380.4219; val_edge_recon_loss: 2758477.2500; val_gene_expr_recon_loss: 2124534.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970620.4375; val_global_loss: 5941012.5000; val_optim_loss: 5941012.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9623; val_auprc_score: 0.9473; val_best_acc_score: 0.9138; val_best_f1_score: 0.9168; train_kl_reg_loss: 90051.4531; train_edge_recon_loss: 2752494.9722; train_gene_expr_recon_loss: 2134812.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 984703.5069; train_global_loss: 5962062.0556; train_optim_loss: 5962062.0556; val_kl_reg_loss: 86499.7344; val_edge_recon_loss: 2759238.0000; val_gene_expr_recon_loss: 2120755.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969495.3125; val_global_loss: 5935989.0000; val_optim_loss: 5935989.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9671; val_auprc_score: 0.9554; val_best_acc_score: 0.9179; val_best_f1_score: 0.9210; train_kl_reg_loss: 88304.8967; train_edge_recon_loss: 2752577.1389; train_gene_expr_recon_loss: 2125640.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973904.9028; train_global_loss: 5940427.0556; train_optim_loss: 5940427.0556; val_kl_reg_loss: 83564.9375; val_edge_recon_loss: 2746487.2500; val_gene_expr_recon_loss: 2120138.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970540.4375; val_global_loss: 5920730.5000; val_optim_loss: 5920730.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9637; val_auprc_score: 0.9470; val_best_acc_score: 0.9177; val_best_f1_score: 0.9210; train_kl_reg_loss: 87099.2040; train_edge_recon_loss: 2735337.7778; train_gene_expr_recon_loss: 2128506.5972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 974425.0764; train_global_loss: 5925368.7778; train_optim_loss: 5925368.7778; val_kl_reg_loss: 85911.7656; val_edge_recon_loss: 2751583.5000; val_gene_expr_recon_loss: 2112231.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967858.6250; val_global_loss: 5917585.5000; val_optim_loss: 5917585.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9704; val_auprc_score: 0.9602; val_best_acc_score: 0.9245; val_best_f1_score: 0.9277; train_kl_reg_loss: 87977.0521; train_edge_recon_loss: 2740728.2222; train_gene_expr_recon_loss: 2116522.4861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976119.4236; train_global_loss: 5921347.1667; train_optim_loss: 5921347.1667; val_kl_reg_loss: 82290.0859; val_edge_recon_loss: 2746281.5000; val_gene_expr_recon_loss: 2107154.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965907.0625; val_global_loss: 5901633.0000; val_optim_loss: 5901633.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9697; val_auprc_score: 0.9570; val_best_acc_score: 0.9259; val_best_f1_score: 0.9286; train_kl_reg_loss: 89797.4193; train_edge_recon_loss: 2745257.1111; train_gene_expr_recon_loss: 2123252.0278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968685.9583; train_global_loss: 5926992.4444; train_optim_loss: 5926992.4444; val_kl_reg_loss: 71085.4375; val_edge_recon_loss: 2735214.0000; val_gene_expr_recon_loss: 2115603.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966010.6250; val_global_loss: 5887913.5000; val_optim_loss: 5887913.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9728; val_auprc_score: 0.9588; val_best_acc_score: 0.9325; val_best_f1_score: 0.9342; train_kl_reg_loss: 93489.2387; train_edge_recon_loss: 2732833.5278; train_gene_expr_recon_loss: 2112435.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971684.2083; train_global_loss: 5910442.8333; train_optim_loss: 5910442.8333; val_kl_reg_loss: 68351.5938; val_edge_recon_loss: 2746761.2500; val_gene_expr_recon_loss: 2112354.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967168.5625; val_global_loss: 5894635.5000; val_optim_loss: 5894635.5000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9754; val_auprc_score: 0.9669; val_best_acc_score: 0.9320; val_best_f1_score: 0.9343; train_kl_reg_loss: 90113.6667; train_edge_recon_loss: 2729736.8889; train_gene_expr_recon_loss: 2115594.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971579.9236; train_global_loss: 5907024.5000; train_optim_loss: 5907024.5000; val_kl_reg_loss: 68953.2656; val_edge_recon_loss: 2729182.0000; val_gene_expr_recon_loss: 2109559.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 965716.1250; val_global_loss: 5873410.5000; val_optim_loss: 5873410.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9752; val_auprc_score: 0.9664; val_best_acc_score: 0.9322; val_best_f1_score: 0.9345; train_kl_reg_loss: 87699.0356; train_edge_recon_loss: 2721426.2500; train_gene_expr_recon_loss: 2107829.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966604.4653; train_global_loss: 5883559.4444; train_optim_loss: 5883559.4444; val_kl_reg_loss: 68026.3125; val_edge_recon_loss: 2739956.0000; val_gene_expr_recon_loss: 2107354.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964911.6875; val_global_loss: 5880248.5000; val_optim_loss: 5880248.5000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9715; val_auprc_score: 0.9603; val_best_acc_score: 0.9294; val_best_f1_score: 0.9317; train_kl_reg_loss: 86813.6398; train_edge_recon_loss: 2712000.4444; train_gene_expr_recon_loss: 2111354.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973577.4167; train_global_loss: 5883746.0556; train_optim_loss: 5883746.0556; val_kl_reg_loss: 70673.7344; val_edge_recon_loss: 2725553.7500; val_gene_expr_recon_loss: 2102296.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964364.0000; val_global_loss: 5862888.0000; val_optim_loss: 5862888.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9733; val_auprc_score: 0.9602; val_best_acc_score: 0.9320; val_best_f1_score: 0.9339; train_kl_reg_loss: 88469.6623; train_edge_recon_loss: 2714218.6944; train_gene_expr_recon_loss: 2099128.5139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967288.3889; train_global_loss: 5869105.2778; train_optim_loss: 5869105.2778; val_kl_reg_loss: 68850.0938; val_edge_recon_loss: 2720770.2500; val_gene_expr_recon_loss: 2107286.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963264.0625; val_global_loss: 5860171.0000; val_optim_loss: 5860171.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9753; val_auprc_score: 0.9659; val_best_acc_score: 0.9333; val_best_f1_score: 0.9362; train_kl_reg_loss: 84469.1042; train_edge_recon_loss: 2709309.2222; train_gene_expr_recon_loss: 2115986.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971857.6806; train_global_loss: 5881622.3333; train_optim_loss: 5881622.3333; val_kl_reg_loss: 67263.0000; val_edge_recon_loss: 2721242.2500; val_gene_expr_recon_loss: 2095745.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962597.2500; val_global_loss: 5846848.0000; val_optim_loss: 5846848.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9765; val_auprc_score: 0.9668; val_best_acc_score: 0.9399; val_best_f1_score: 0.9413; train_kl_reg_loss: 83221.2769; train_edge_recon_loss: 2705055.3889; train_gene_expr_recon_loss: 2085193.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964310.3542; train_global_loss: 5837780.6111; train_optim_loss: 5837780.6111; val_kl_reg_loss: 69273.0078; val_edge_recon_loss: 2705951.2500; val_gene_expr_recon_loss: 2096096.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963053.3125; val_global_loss: 5834374.5000; val_optim_loss: 5834374.5000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9744; val_auprc_score: 0.9624; val_best_acc_score: 0.9364; val_best_f1_score: 0.9386; train_kl_reg_loss: 83900.0608; train_edge_recon_loss: 2698150.6667; train_gene_expr_recon_loss: 2097090.5972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971505.1944; train_global_loss: 5850646.5556; train_optim_loss: 5850646.5556; val_kl_reg_loss: 68968.0156; val_edge_recon_loss: 2710763.7500; val_gene_expr_recon_loss: 2095283.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961523.8750; val_global_loss: 5836539.0000; val_optim_loss: 5836539.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9807; val_auprc_score: 0.9747; val_best_acc_score: 0.9383; val_best_f1_score: 0.9399; train_kl_reg_loss: 82339.5122; train_edge_recon_loss: 2699455.0000; train_gene_expr_recon_loss: 2090590.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966072.2708; train_global_loss: 5838457.2222; train_optim_loss: 5838457.2222; val_kl_reg_loss: 68627.9297; val_edge_recon_loss: 2700340.7500; val_gene_expr_recon_loss: 2083624.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 961002.5625; val_global_loss: 5813595.5000; val_optim_loss: 5813595.5000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9776; val_auprc_score: 0.9689; val_best_acc_score: 0.9395; val_best_f1_score: 0.9410; train_kl_reg_loss: 81368.9974; train_edge_recon_loss: 2702816.1944; train_gene_expr_recon_loss: 2090652.3194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 970705.5139; train_global_loss: 5845542.9444; train_optim_loss: 5845542.9444; val_kl_reg_loss: 67136.7266; val_edge_recon_loss: 2703012.7500; val_gene_expr_recon_loss: 2087984.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 960756.5000; val_global_loss: 5818890.5000; val_optim_loss: 5818890.5000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9796; val_auprc_score: 0.9700; val_best_acc_score: 0.9427; val_best_f1_score: 0.9448; train_kl_reg_loss: 79050.6866; train_edge_recon_loss: 2701686.0000; train_gene_expr_recon_loss: 2079521.9861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967399.7014; train_global_loss: 5827658.3889; train_optim_loss: 5827658.3889; val_kl_reg_loss: 69460.9531; val_edge_recon_loss: 2700146.2500; val_gene_expr_recon_loss: 2079025.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 957838.6250; val_global_loss: 5806471.5000; val_optim_loss: 5806471.5000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9779; val_auprc_score: 0.9668; val_best_acc_score: 0.9392; val_best_f1_score: 0.9415; train_kl_reg_loss: 80897.4731; train_edge_recon_loss: 2700314.2222; train_gene_expr_recon_loss: 2079773.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 968441.5833; train_global_loss: 5829426.3889; train_optim_loss: 5829426.3889; val_kl_reg_loss: 68503.7031; val_edge_recon_loss: 2692104.5000; val_gene_expr_recon_loss: 2078886.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 957324.7500; val_global_loss: 5796819.0000; val_optim_loss: 5796819.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9804; val_auprc_score: 0.9714; val_best_acc_score: 0.9433; val_best_f1_score: 0.9446; train_kl_reg_loss: 79147.4549; train_edge_recon_loss: 2699594.5278; train_gene_expr_recon_loss: 2071734.0556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961200.2500; train_global_loss: 5811676.2778; train_optim_loss: 5811676.2778; val_kl_reg_loss: 66060.3047; val_edge_recon_loss: 2709975.0000; val_gene_expr_recon_loss: 2079245.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 958158.0625; val_global_loss: 5813439.0000; val_optim_loss: 5813439.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9811; val_auprc_score: 0.9756; val_best_acc_score: 0.9387; val_best_f1_score: 0.9405; train_kl_reg_loss: 75569.0781; train_edge_recon_loss: 2691399.4444; train_gene_expr_recon_loss: 2071741.2639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959150.1181; train_global_loss: 5797859.9444; train_optim_loss: 5797859.9444; val_kl_reg_loss: 67277.7031; val_edge_recon_loss: 2712277.2500; val_gene_expr_recon_loss: 2070923.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 955555.0000; val_global_loss: 5806034.0000; val_optim_loss: 5806034.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9790; val_auprc_score: 0.9680; val_best_acc_score: 0.9448; val_best_f1_score: 0.9465; train_kl_reg_loss: 79689.2075; train_edge_recon_loss: 2683812.2222; train_gene_expr_recon_loss: 2059828.0972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961202.6736; train_global_loss: 5784532.2778; train_optim_loss: 5784532.2778; val_kl_reg_loss: 70728.5391; val_edge_recon_loss: 2693393.0000; val_gene_expr_recon_loss: 2069530.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 956068.1250; val_global_loss: 5789720.0000; val_optim_loss: 5789720.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9794; val_auprc_score: 0.9720; val_best_acc_score: 0.9398; val_best_f1_score: 0.9412; train_kl_reg_loss: 77392.6944; train_edge_recon_loss: 2687584.3333; train_gene_expr_recon_loss: 2070016.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964237.7222; train_global_loss: 5799230.8889; train_optim_loss: 5799230.8889; val_kl_reg_loss: 62267.6914; val_edge_recon_loss: 2707706.5000; val_gene_expr_recon_loss: 2079787.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 956784.3750; val_global_loss: 5806546.5000; val_optim_loss: 5806546.5000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9806; val_auprc_score: 0.9707; val_best_acc_score: 0.9445; val_best_f1_score: 0.9461; train_kl_reg_loss: 75065.8828; train_edge_recon_loss: 2688025.5278; train_gene_expr_recon_loss: 2070372.7222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963965.7083; train_global_loss: 5797429.7222; train_optim_loss: 5797429.7222; val_kl_reg_loss: 67603.6250; val_edge_recon_loss: 2683693.2500; val_gene_expr_recon_loss: 2064912.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 953705.8750; val_global_loss: 5769915.0000; val_optim_loss: 5769915.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9828; val_auprc_score: 0.9764; val_best_acc_score: 0.9461; val_best_f1_score: 0.9476; train_kl_reg_loss: 76677.8385; train_edge_recon_loss: 2692685.4167; train_gene_expr_recon_loss: 2043262.5417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 949757.6667; train_global_loss: 5762383.3333; train_optim_loss: 5762383.3333; val_kl_reg_loss: 64572.7188; val_edge_recon_loss: 2682246.0000; val_gene_expr_recon_loss: 2064964.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 953310.4375; val_global_loss: 5765094.0000; val_optim_loss: 5765094.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9799; val_auprc_score: 0.9688; val_best_acc_score: 0.9414; val_best_f1_score: 0.9430; train_kl_reg_loss: 74106.0052; train_edge_recon_loss: 2684621.5833; train_gene_expr_recon_loss: 2054876.9722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963726.0208; train_global_loss: 5777330.5000; train_optim_loss: 5777330.5000; val_kl_reg_loss: 62959.1484; val_edge_recon_loss: 2697555.7500; val_gene_expr_recon_loss: 2071910.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 953171.0000; val_global_loss: 5785596.0000; val_optim_loss: 5785596.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9807; val_auprc_score: 0.9743; val_best_acc_score: 0.9415; val_best_f1_score: 0.9433; train_kl_reg_loss: 73817.7960; train_edge_recon_loss: 2689860.5833; train_gene_expr_recon_loss: 2039021.5972; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 953632.0278; train_global_loss: 5756332.0000; train_optim_loss: 5756332.0000; val_kl_reg_loss: 64394.4922; val_edge_recon_loss: 2696324.0000; val_gene_expr_recon_loss: 2061492.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 952551.9375; val_global_loss: 5774762.5000; val_optim_loss: 5774762.5000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9834; val_auprc_score: 0.9784; val_best_acc_score: 0.9458; val_best_f1_score: 0.9472; train_kl_reg_loss: 74266.3203; train_edge_recon_loss: 2684431.1944; train_gene_expr_recon_loss: 2053403.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959368.4931; train_global_loss: 5771469.8333; train_optim_loss: 5771469.8333; val_kl_reg_loss: 64751.4453; val_edge_recon_loss: 2689445.2500; val_gene_expr_recon_loss: 2061295.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 953240.7500; val_global_loss: 5768733.0000; val_optim_loss: 5768733.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9808; val_auprc_score: 0.9743; val_best_acc_score: 0.9440; val_best_f1_score: 0.9459; train_kl_reg_loss: 72888.5269; train_edge_recon_loss: 2680818.7778; train_gene_expr_recon_loss: 2046887.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957519.9514; train_global_loss: 5758115.1111; train_optim_loss: 5758115.1111; val_kl_reg_loss: 63685.7734; val_edge_recon_loss: 2708503.5000; val_gene_expr_recon_loss: 2059872.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 952716.7500; val_global_loss: 5784778.0000; val_optim_loss: 5784778.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9832; val_auprc_score: 0.9762; val_best_acc_score: 0.9481; val_best_f1_score: 0.9498; train_kl_reg_loss: 72716.4193; train_edge_recon_loss: 2679298.3333; train_gene_expr_recon_loss: 2043852.4861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 960354.0069; train_global_loss: 5756221.2778; train_optim_loss: 5756221.2778; val_kl_reg_loss: 65533.3672; val_edge_recon_loss: 2687267.2500; val_gene_expr_recon_loss: 2053382.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 951803.5625; val_global_loss: 5757986.5000; val_optim_loss: 5757986.5000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9843; val_auprc_score: 0.9797; val_best_acc_score: 0.9438; val_best_f1_score: 0.9458; train_kl_reg_loss: 73754.4861; train_edge_recon_loss: 2682614.1111; train_gene_expr_recon_loss: 2033113.8194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 955281.2361; train_global_loss: 5744763.6667; train_optim_loss: 5744763.6667; val_kl_reg_loss: 64331.7812; val_edge_recon_loss: 2695041.5000; val_gene_expr_recon_loss: 2053539.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 949673.1250; val_global_loss: 5762586.0000; val_optim_loss: 5762586.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9827; val_auprc_score: 0.9753; val_best_acc_score: 0.9480; val_best_f1_score: 0.9492; train_kl_reg_loss: 72994.6033; train_edge_recon_loss: 2682789.5833; train_gene_expr_recon_loss: 2045424.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 958773.4444; train_global_loss: 5759981.6667; train_optim_loss: 5759981.6667; val_kl_reg_loss: 64536.3281; val_edge_recon_loss: 2699841.0000; val_gene_expr_recon_loss: 2052297.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 950017.0000; val_global_loss: 5766691.0000; val_optim_loss: 5766691.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9838; val_auprc_score: 0.9773; val_best_acc_score: 0.9481; val_best_f1_score: 0.9494; train_kl_reg_loss: 72959.0564; train_edge_recon_loss: 2672287.0278; train_gene_expr_recon_loss: 2033824.4306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 959265.3819; train_global_loss: 5738335.9444; train_optim_loss: 5738335.9444; val_kl_reg_loss: 63837.1953; val_edge_recon_loss: 2688787.0000; val_gene_expr_recon_loss: 2056121.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 951332.3750; val_global_loss: 5760078.5000; val_optim_loss: 5760078.5000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9818; val_auprc_score: 0.9743; val_best_acc_score: 0.9469; val_best_f1_score: 0.9488; train_kl_reg_loss: 72718.8898; train_edge_recon_loss: 2683382.3889; train_gene_expr_recon_loss: 2041288.5694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961886.1319; train_global_loss: 5759275.8889; train_optim_loss: 5759275.8889; val_kl_reg_loss: 64017.5859; val_edge_recon_loss: 2686196.5000; val_gene_expr_recon_loss: 2052659.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 949956.2500; val_global_loss: 5752830.0000; val_optim_loss: 5752830.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9834; val_auprc_score: 0.9779; val_best_acc_score: 0.9508; val_best_f1_score: 0.9519; train_kl_reg_loss: 73027.1875; train_edge_recon_loss: 2683786.0278; train_gene_expr_recon_loss: 2036468.4028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957315.1319; train_global_loss: 5750596.8889; train_optim_loss: 5750596.8889; val_kl_reg_loss: 63825.2188; val_edge_recon_loss: 2665943.0000; val_gene_expr_recon_loss: 2052591.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 948936.6250; val_global_loss: 5731296.5000; val_optim_loss: 5731296.5000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9848; val_auprc_score: 0.9795; val_best_acc_score: 0.9519; val_best_f1_score: 0.9533; train_kl_reg_loss: 72728.5955; train_edge_recon_loss: 2681586.3333; train_gene_expr_recon_loss: 2037320.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 958169.6736; train_global_loss: 5749805.1667; train_optim_loss: 5749805.1667; val_kl_reg_loss: 63756.3047; val_edge_recon_loss: 2668630.5000; val_gene_expr_recon_loss: 2050435.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 948426.4375; val_global_loss: 5731248.5000; val_optim_loss: 5731248.5000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9837; val_auprc_score: 0.9792; val_best_acc_score: 0.9465; val_best_f1_score: 0.9481; train_kl_reg_loss: 72859.2526; train_edge_recon_loss: 2671833.9444; train_gene_expr_recon_loss: 2044107.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 956411.6806; train_global_loss: 5745212.6111; train_optim_loss: 5745212.6111; val_kl_reg_loss: 63882.3320; val_edge_recon_loss: 2687183.0000; val_gene_expr_recon_loss: 2050789.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 948660.5000; val_global_loss: 5750515.5000; val_optim_loss: 5750515.5000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9823; val_auprc_score: 0.9752; val_best_acc_score: 0.9481; val_best_f1_score: 0.9494; train_kl_reg_loss: 73048.6736; train_edge_recon_loss: 2674012.0833; train_gene_expr_recon_loss: 2035620.7639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 956175.1389; train_global_loss: 5738856.5556; train_optim_loss: 5738856.5556; val_kl_reg_loss: 64039.9727; val_edge_recon_loss: 2688535.2500; val_gene_expr_recon_loss: 2051768.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 949494.5000; val_global_loss: 5753838.5000; val_optim_loss: 5753838.5000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9855; val_auprc_score: 0.9806; val_best_acc_score: 0.9518; val_best_f1_score: 0.9528; train_kl_reg_loss: 72704.1780; train_edge_recon_loss: 2679693.6389; train_gene_expr_recon_loss: 2039284.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 953323.7361; train_global_loss: 5745005.8889; train_optim_loss: 5745005.8889; val_kl_reg_loss: 63823.6016; val_edge_recon_loss: 2672376.0000; val_gene_expr_recon_loss: 2052934.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 950703.5625; val_global_loss: 5739838.0000; val_optim_loss: 5739838.0000
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9821; val_auprc_score: 0.9737; val_best_acc_score: 0.9446; val_best_f1_score: 0.9462; train_kl_reg_loss: 72511.5104; train_edge_recon_loss: 2673506.1111; train_gene_expr_recon_loss: 2034901.6944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957131.3403; train_global_loss: 5738050.7778; train_optim_loss: 5738050.7778; val_kl_reg_loss: 64064.4688; val_edge_recon_loss: 2699928.5000; val_gene_expr_recon_loss: 2050418.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 949558.8750; val_global_loss: 5763970.5000; val_optim_loss: 5763970.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9821; val_auprc_score: 0.9754; val_best_acc_score: 0.9481; val_best_f1_score: 0.9495; train_kl_reg_loss: 72871.8681; train_edge_recon_loss: 2673216.0278; train_gene_expr_recon_loss: 2028768.8611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 954530.1458; train_global_loss: 5729386.8333; train_optim_loss: 5729386.8333; val_kl_reg_loss: 63960.2266; val_edge_recon_loss: 2674070.5000; val_gene_expr_recon_loss: 2050749.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 950514.5000; val_global_loss: 5739295.0000; val_optim_loss: 5739295.0000
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9815; val_auprc_score: 0.9738; val_best_acc_score: 0.9452; val_best_f1_score: 0.9468; train_kl_reg_loss: 72642.9731; train_edge_recon_loss: 2680919.8889; train_gene_expr_recon_loss: 2029983.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 953684.1806; train_global_loss: 5737230.8889; train_optim_loss: 5737230.8889; val_kl_reg_loss: 63688.6484; val_edge_recon_loss: 2699647.0000; val_gene_expr_recon_loss: 2051456.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 948984.9375; val_global_loss: 5763777.5000; val_optim_loss: 5763777.5000
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9816; val_auprc_score: 0.9741; val_best_acc_score: 0.9470; val_best_f1_score: 0.9485; train_kl_reg_loss: 72843.0729; train_edge_recon_loss: 2674032.2222; train_gene_expr_recon_loss: 2049009.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 958454.8194; train_global_loss: 5754339.3333; train_optim_loss: 5754339.3333; val_kl_reg_loss: 63833.0938; val_edge_recon_loss: 2692802.7500; val_gene_expr_recon_loss: 2052827.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 949907.0000; val_global_loss: 5759370.0000; val_optim_loss: 5759370.0000
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9824; val_auprc_score: 0.9756; val_best_acc_score: 0.9449; val_best_f1_score: 0.9469; train_kl_reg_loss: 72814.9896; train_edge_recon_loss: 2671256.5000; train_gene_expr_recon_loss: 2037999.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 954352.3958; train_global_loss: 5736423.7778; train_optim_loss: 5736423.7778; val_kl_reg_loss: 64030.6016; val_edge_recon_loss: 2690593.2500; val_gene_expr_recon_loss: 2054230.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 951139.0625; val_global_loss: 5759993.5000; val_optim_loss: 5759993.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 11 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
Val AUROC score: 0.9814
Val AUPRC score: 0.9753
Val best accuracy score: 0.9433
Val best F1 score: 0.9450
Val gene expr MSE score: 0.3704
Val chrom access MSE score: 0.0858
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
