[True]
Run timestamp: 07092023_154334_38.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '100', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_38']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1125 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5628, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1125

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6209; val_auprc_score: 0.5977; val_best_acc_score: 0.5043; val_best_f1_score: 0.6683; train_kl_reg_loss: 51885.8736; train_edge_recon_loss: 3544728.9394; train_gene_expr_recon_loss: 16622084.3636; train_masked_gp_l1_reg_loss: 83084.5759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1442288.6761; train_chrom_access_recon_loss: 6294576.9773; train_global_loss: 28038649.4848; train_optim_loss: 28038649.4848; val_kl_reg_loss: 116071.2988; val_edge_recon_loss: 4065112.7812; val_gene_expr_recon_loss: 15249717.8750; val_masked_gp_l1_reg_loss: 79725.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1067477.7500; val_chrom_access_recon_loss: 6100290.5625; val_global_loss: 26678396.5000; val_optim_loss: 26678396.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6628; val_auprc_score: 0.6403; val_best_acc_score: 0.5634; val_best_f1_score: 0.6890; train_kl_reg_loss: 109860.0043; train_edge_recon_loss: 3537863.8258; train_gene_expr_recon_loss: 14890398.6061; train_masked_gp_l1_reg_loss: 74727.6407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 764541.7614; train_chrom_access_recon_loss: 5978721.7500; train_global_loss: 25356113.3030; train_optim_loss: 25356113.3030; val_kl_reg_loss: 115291.8516; val_edge_recon_loss: 4061905.1562; val_gene_expr_recon_loss: 14678017.7500; val_masked_gp_l1_reg_loss: 71799.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 516913.4688; val_chrom_access_recon_loss: 5980130.3750; val_global_loss: 25424059.5000; val_optim_loss: 25424059.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7212; val_auprc_score: 0.7010; val_best_acc_score: 0.6287; val_best_f1_score: 0.7053; train_kl_reg_loss: 108170.7822; train_edge_recon_loss: 3527933.7917; train_gene_expr_recon_loss: 14663869.4697; train_masked_gp_l1_reg_loss: 71413.7047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 381547.2912; train_chrom_access_recon_loss: 5928494.6439; train_global_loss: 24681429.7576; train_optim_loss: 24681429.7576; val_kl_reg_loss: 111741.9307; val_edge_recon_loss: 4055311.1250; val_gene_expr_recon_loss: 14601608.2500; val_masked_gp_l1_reg_loss: 71733.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 276958.6562; val_chrom_access_recon_loss: 5919486.8125; val_global_loss: 25036840.2500; val_optim_loss: 25036840.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8049; val_auprc_score: 0.7793; val_best_acc_score: 0.7184; val_best_f1_score: 0.7297; train_kl_reg_loss: 98448.1902; train_edge_recon_loss: 3518352.1136; train_gene_expr_recon_loss: 14545354.3030; train_masked_gp_l1_reg_loss: 72644.0021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 218523.5400; train_chrom_access_recon_loss: 5896306.0076; train_global_loss: 24349628.2424; train_optim_loss: 24349628.2424; val_kl_reg_loss: 98063.3232; val_edge_recon_loss: 4006786.5625; val_gene_expr_recon_loss: 14618693.6250; val_masked_gp_l1_reg_loss: 74177.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172028.3750; val_chrom_access_recon_loss: 5984555.6250; val_global_loss: 24954305.2500; val_optim_loss: 24954305.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8393; val_auprc_score: 0.8079; val_best_acc_score: 0.7743; val_best_f1_score: 0.7908; train_kl_reg_loss: 83917.4695; train_edge_recon_loss: 3479982.7917; train_gene_expr_recon_loss: 14453589.6667; train_masked_gp_l1_reg_loss: 75813.5393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144478.3144; train_chrom_access_recon_loss: 5860702.1061; train_global_loss: 24098484.0303; train_optim_loss: 24098484.0303; val_kl_reg_loss: 65826.1670; val_edge_recon_loss: 3619373.0625; val_gene_expr_recon_loss: 14551892.5000; val_masked_gp_l1_reg_loss: 77584.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122642.1875; val_chrom_access_recon_loss: 5887292.9375; val_global_loss: 24324610.5000; val_optim_loss: 24324610.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8656; val_auprc_score: 0.8306; val_best_acc_score: 0.7920; val_best_f1_score: 0.8115; train_kl_reg_loss: 83807.3445; train_edge_recon_loss: 3147221.3068; train_gene_expr_recon_loss: 14404174.1667; train_masked_gp_l1_reg_loss: 80561.7563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109604.5515; train_chrom_access_recon_loss: 5839485.5379; train_global_loss: 23664854.4848; train_optim_loss: 23664854.4848; val_kl_reg_loss: 107983.0830; val_edge_recon_loss: 2982060.6875; val_gene_expr_recon_loss: 14575374.8750; val_masked_gp_l1_reg_loss: 83289.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97620.4531; val_chrom_access_recon_loss: 5894016.1250; val_global_loss: 23740345.0000; val_optim_loss: 23740345.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8793; val_auprc_score: 0.8455; val_best_acc_score: 0.8076; val_best_f1_score: 0.8268; train_kl_reg_loss: 110945.9763; train_edge_recon_loss: 2923687.2614; train_gene_expr_recon_loss: 14300402.0000; train_masked_gp_l1_reg_loss: 84755.6142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88283.8142; train_chrom_access_recon_loss: 5802178.8182; train_global_loss: 23310253.3333; train_optim_loss: 23310253.3333; val_kl_reg_loss: 112360.8203; val_edge_recon_loss: 2940113.4062; val_gene_expr_recon_loss: 14385150.7500; val_masked_gp_l1_reg_loss: 86184.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79742.4297; val_chrom_access_recon_loss: 5810763.0000; val_global_loss: 23414313.7500; val_optim_loss: 23414313.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9008; val_auprc_score: 0.8742; val_best_acc_score: 0.8334; val_best_f1_score: 0.8444; train_kl_reg_loss: 114024.3068; train_edge_recon_loss: 2874754.1326; train_gene_expr_recon_loss: 14218508.7121; train_masked_gp_l1_reg_loss: 87614.2530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74038.1748; train_chrom_access_recon_loss: 5773908.1970; train_global_loss: 23142847.8485; train_optim_loss: 23142847.8485; val_kl_reg_loss: 112135.3721; val_edge_recon_loss: 2895876.8125; val_gene_expr_recon_loss: 14410063.3750; val_masked_gp_l1_reg_loss: 89171.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69079.4062; val_chrom_access_recon_loss: 5859209.1875; val_global_loss: 23435536.5000; val_optim_loss: 23435536.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9041; val_auprc_score: 0.8712; val_best_acc_score: 0.8420; val_best_f1_score: 0.8541; train_kl_reg_loss: 115204.4455; train_edge_recon_loss: 2842425.8864; train_gene_expr_recon_loss: 14158315.5606; train_masked_gp_l1_reg_loss: 90279.3210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64860.6801; train_chrom_access_recon_loss: 5757181.0227; train_global_loss: 23028266.8182; train_optim_loss: 23028266.8182; val_kl_reg_loss: 114250.5283; val_edge_recon_loss: 2882016.4062; val_gene_expr_recon_loss: 14289235.8750; val_masked_gp_l1_reg_loss: 91511.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61193.3594; val_chrom_access_recon_loss: 5770392.4375; val_global_loss: 23208601.0000; val_optim_loss: 23208601.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9126; val_auprc_score: 0.8811; val_best_acc_score: 0.8544; val_best_f1_score: 0.8628; train_kl_reg_loss: 111685.9624; train_edge_recon_loss: 2820014.6856; train_gene_expr_recon_loss: 14089488.0758; train_masked_gp_l1_reg_loss: 92763.5824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58488.9178; train_chrom_access_recon_loss: 5725809.5000; train_global_loss: 22898250.7576; train_optim_loss: 22898250.7576; val_kl_reg_loss: 111895.5518; val_edge_recon_loss: 2846718.4375; val_gene_expr_recon_loss: 14288952.5000; val_masked_gp_l1_reg_loss: 93950.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55869.1172; val_chrom_access_recon_loss: 5768525.6875; val_global_loss: 23165912.0000; val_optim_loss: 23165912.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9030; val_auprc_score: 0.8799; val_best_acc_score: 0.8358; val_best_f1_score: 0.8479; train_kl_reg_loss: 111665.4959; train_edge_recon_loss: 2829100.4697; train_gene_expr_recon_loss: 14036525.0000; train_masked_gp_l1_reg_loss: 94805.3755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53722.2585; train_chrom_access_recon_loss: 5700664.2273; train_global_loss: 22826482.8788; train_optim_loss: 22826482.8788; val_kl_reg_loss: 105165.7539; val_edge_recon_loss: 2880738.6562; val_gene_expr_recon_loss: 14206495.0000; val_masked_gp_l1_reg_loss: 95738.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51827.9922; val_chrom_access_recon_loss: 5782773.5000; val_global_loss: 23122739.5000; val_optim_loss: 23122739.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9118; val_auprc_score: 0.8864; val_best_acc_score: 0.8501; val_best_f1_score: 0.8587; train_kl_reg_loss: 109145.0915; train_edge_recon_loss: 2815469.9962; train_gene_expr_recon_loss: 13990594.8788; train_masked_gp_l1_reg_loss: 96537.0025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50161.4354; train_chrom_access_recon_loss: 5690834.1818; train_global_loss: 22752742.8485; train_optim_loss: 22752742.8485; val_kl_reg_loss: 108760.3984; val_edge_recon_loss: 2851639.2500; val_gene_expr_recon_loss: 14189686.6250; val_masked_gp_l1_reg_loss: 97447.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48767.2500; val_chrom_access_recon_loss: 5741429.9375; val_global_loss: 23037731.7500; val_optim_loss: 23037731.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9127; val_auprc_score: 0.8801; val_best_acc_score: 0.8549; val_best_f1_score: 0.8620; train_kl_reg_loss: 105826.5922; train_edge_recon_loss: 2804007.6515; train_gene_expr_recon_loss: 13934450.9545; train_masked_gp_l1_reg_loss: 98263.1596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47550.2292; train_chrom_access_recon_loss: 5662381.8409; train_global_loss: 22652480.5455; train_optim_loss: 22652480.5455; val_kl_reg_loss: 108487.9678; val_edge_recon_loss: 2862403.3750; val_gene_expr_recon_loss: 14127514.1250; val_masked_gp_l1_reg_loss: 99166.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46760.6836; val_chrom_access_recon_loss: 5663051.8750; val_global_loss: 22907383.5000; val_optim_loss: 22907383.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9144; val_auprc_score: 0.8818; val_best_acc_score: 0.8565; val_best_f1_score: 0.8681; train_kl_reg_loss: 104299.1726; train_edge_recon_loss: 2796472.8598; train_gene_expr_recon_loss: 13875529.0606; train_masked_gp_l1_reg_loss: 99914.1365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45651.6914; train_chrom_access_recon_loss: 5637004.5909; train_global_loss: 22558871.6970; train_optim_loss: 22558871.6970; val_kl_reg_loss: 101649.3330; val_edge_recon_loss: 2823882.4688; val_gene_expr_recon_loss: 14029332.0000; val_masked_gp_l1_reg_loss: 100741.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44741.4766; val_chrom_access_recon_loss: 5671251.0000; val_global_loss: 22771598.2500; val_optim_loss: 22771598.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9134; val_auprc_score: 0.8811; val_best_acc_score: 0.8606; val_best_f1_score: 0.8709; train_kl_reg_loss: 102605.4918; train_edge_recon_loss: 2785072.5303; train_gene_expr_recon_loss: 13848581.0152; train_masked_gp_l1_reg_loss: 101422.5940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44051.4061; train_chrom_access_recon_loss: 5625080.8258; train_global_loss: 22506813.9394; train_optim_loss: 22506813.9394; val_kl_reg_loss: 100825.7393; val_edge_recon_loss: 2806765.0938; val_gene_expr_recon_loss: 13778442.8750; val_masked_gp_l1_reg_loss: 102220.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43598.1016; val_chrom_access_recon_loss: 5581833.5000; val_global_loss: 22413685.5000; val_optim_loss: 22413685.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9223; val_auprc_score: 0.8970; val_best_acc_score: 0.8649; val_best_f1_score: 0.8731; train_kl_reg_loss: 100972.0013; train_edge_recon_loss: 2790544.1667; train_gene_expr_recon_loss: 13800947.2273; train_masked_gp_l1_reg_loss: 102816.7915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42922.6802; train_chrom_access_recon_loss: 5606616.1364; train_global_loss: 22444819.1212; train_optim_loss: 22444819.1212; val_kl_reg_loss: 100308.0635; val_edge_recon_loss: 2798903.3438; val_gene_expr_recon_loss: 13968242.1250; val_masked_gp_l1_reg_loss: 103482.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42532.1641; val_chrom_access_recon_loss: 5640419.9375; val_global_loss: 22653887.5000; val_optim_loss: 22653887.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9269; val_auprc_score: 0.9031; val_best_acc_score: 0.8678; val_best_f1_score: 0.8755; train_kl_reg_loss: 99441.9698; train_edge_recon_loss: 2774362.7235; train_gene_expr_recon_loss: 13771919.9545; train_masked_gp_l1_reg_loss: 104030.8647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42018.8253; train_chrom_access_recon_loss: 5596558.7424; train_global_loss: 22388332.9091; train_optim_loss: 22388332.9091; val_kl_reg_loss: 98695.0742; val_edge_recon_loss: 2794122.4375; val_gene_expr_recon_loss: 13881564.2500; val_masked_gp_l1_reg_loss: 104667.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41710.9180; val_chrom_access_recon_loss: 5625670.2500; val_global_loss: 22546430.5000; val_optim_loss: 22546430.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9245; val_auprc_score: 0.8968; val_best_acc_score: 0.8673; val_best_f1_score: 0.8767; train_kl_reg_loss: 98165.8117; train_edge_recon_loss: 2773696.3106; train_gene_expr_recon_loss: 13724255.2424; train_masked_gp_l1_reg_loss: 105301.9812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41234.7443; train_chrom_access_recon_loss: 5574974.6364; train_global_loss: 22317628.6970; train_optim_loss: 22317628.6970; val_kl_reg_loss: 97851.3076; val_edge_recon_loss: 2788383.7500; val_gene_expr_recon_loss: 13898973.2500; val_masked_gp_l1_reg_loss: 105722.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40878.7852; val_chrom_access_recon_loss: 5631393.8125; val_global_loss: 22563202.0000; val_optim_loss: 22563202.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9220; val_auprc_score: 0.8903; val_best_acc_score: 0.8627; val_best_f1_score: 0.8715; train_kl_reg_loss: 96067.6241; train_edge_recon_loss: 2775209.3447; train_gene_expr_recon_loss: 13690389.6667; train_masked_gp_l1_reg_loss: 106383.7352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40618.5980; train_chrom_access_recon_loss: 5561306.2045; train_global_loss: 22269975.3030; train_optim_loss: 22269975.3030; val_kl_reg_loss: 94563.8525; val_edge_recon_loss: 2785459.7500; val_gene_expr_recon_loss: 13951091.8750; val_masked_gp_l1_reg_loss: 107023.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40327.2539; val_chrom_access_recon_loss: 5669984.4375; val_global_loss: 22648451.2500; val_optim_loss: 22648451.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9321; val_auprc_score: 0.9072; val_best_acc_score: 0.8708; val_best_f1_score: 0.8768; train_kl_reg_loss: 95931.9179; train_edge_recon_loss: 2759708.0076; train_gene_expr_recon_loss: 13668443.4848; train_masked_gp_l1_reg_loss: 105230.1942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34847.8388; train_chrom_access_recon_loss: 5551356.1364; train_global_loss: 22215517.5152; train_optim_loss: 22215517.5152; val_kl_reg_loss: 96567.2871; val_edge_recon_loss: 2756849.4062; val_gene_expr_recon_loss: 13884757.2500; val_masked_gp_l1_reg_loss: 104377.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32913.7695; val_chrom_access_recon_loss: 5593272.3125; val_global_loss: 22468738.0000; val_optim_loss: 22468738.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9273; val_auprc_score: 0.9006; val_best_acc_score: 0.8686; val_best_f1_score: 0.8745; train_kl_reg_loss: 97601.3369; train_edge_recon_loss: 2756945.3409; train_gene_expr_recon_loss: 13664101.3182; train_masked_gp_l1_reg_loss: 104190.8390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32628.1389; train_chrom_access_recon_loss: 5547409.3182; train_global_loss: 22202876.2121; train_optim_loss: 22202876.2121; val_kl_reg_loss: 99168.6543; val_edge_recon_loss: 2810739.0312; val_gene_expr_recon_loss: 13848814.6250; val_masked_gp_l1_reg_loss: 104098.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32426.9043; val_chrom_access_recon_loss: 5586316.6875; val_global_loss: 22481563.2500; val_optim_loss: 22481563.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9238; val_auprc_score: 0.8956; val_best_acc_score: 0.8659; val_best_f1_score: 0.8745; train_kl_reg_loss: 98223.2480; train_edge_recon_loss: 2759845.7348; train_gene_expr_recon_loss: 13656927.9697; train_masked_gp_l1_reg_loss: 104062.9199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32282.0909; train_chrom_access_recon_loss: 5544938.1818; train_global_loss: 22196280.2121; train_optim_loss: 22196280.2121; val_kl_reg_loss: 99085.0918; val_edge_recon_loss: 2790319.2812; val_gene_expr_recon_loss: 13720505.7500; val_masked_gp_l1_reg_loss: 104046.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32177.9062; val_chrom_access_recon_loss: 5559380.3750; val_global_loss: 22305514.2500; val_optim_loss: 22305514.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9313; val_auprc_score: 0.9073; val_best_acc_score: 0.8692; val_best_f1_score: 0.8773; train_kl_reg_loss: 98278.0316; train_edge_recon_loss: 2766310.4697; train_gene_expr_recon_loss: 13652649.3939; train_masked_gp_l1_reg_loss: 104088.2281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32079.7883; train_chrom_access_recon_loss: 5542200.2197; train_global_loss: 22195606.2727; train_optim_loss: 22195606.2727; val_kl_reg_loss: 98805.9775; val_edge_recon_loss: 2778609.3438; val_gene_expr_recon_loss: 13811643.7500; val_masked_gp_l1_reg_loss: 104117.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32000.3320; val_chrom_access_recon_loss: 5600337.2500; val_global_loss: 22425513.7500; val_optim_loss: 22425513.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9245; val_auprc_score: 0.8979; val_best_acc_score: 0.8627; val_best_f1_score: 0.8716; train_kl_reg_loss: 98372.7805; train_edge_recon_loss: 2763447.8712; train_gene_expr_recon_loss: 13653617.8182; train_masked_gp_l1_reg_loss: 104147.8130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31937.9410; train_chrom_access_recon_loss: 5544235.8864; train_global_loss: 22195760.0909; train_optim_loss: 22195760.0909; val_kl_reg_loss: 98832.8633; val_edge_recon_loss: 2833474.0312; val_gene_expr_recon_loss: 13801068.5000; val_masked_gp_l1_reg_loss: 104149.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31855.7676; val_chrom_access_recon_loss: 5642948.5625; val_global_loss: 22512330.0000; val_optim_loss: 22512330.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9308; val_auprc_score: 0.9055; val_best_acc_score: 0.8726; val_best_f1_score: 0.8798; train_kl_reg_loss: 98009.8769; train_edge_recon_loss: 2756576.8485; train_gene_expr_recon_loss: 13641536.2576; train_masked_gp_l1_reg_loss: 104213.3092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31790.7342; train_chrom_access_recon_loss: 5539920.9015; train_global_loss: 22172047.9091; train_optim_loss: 22172047.9091; val_kl_reg_loss: 99626.2236; val_edge_recon_loss: 2774432.1250; val_gene_expr_recon_loss: 13789493.8750; val_masked_gp_l1_reg_loss: 104249.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31730.1992; val_chrom_access_recon_loss: 5637981.0000; val_global_loss: 22437513.2500; val_optim_loss: 22437513.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9227; val_auprc_score: 0.8941; val_best_acc_score: 0.8667; val_best_f1_score: 0.8748; train_kl_reg_loss: 103765.6793; train_edge_recon_loss: 2805954.9508; train_gene_expr_recon_loss: 13555859.4091; train_masked_gp_l1_reg_loss: 103930.1344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30640.6532; train_chrom_access_recon_loss: 5584453.1439; train_global_loss: 22184604.0303; train_optim_loss: 22184604.0303; val_kl_reg_loss: 71677.8457; val_edge_recon_loss: 2829669.5938; val_gene_expr_recon_loss: 13636929.5000; val_masked_gp_l1_reg_loss: 103816.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29680.8477; val_chrom_access_recon_loss: 5543691.4375; val_global_loss: 22215465.0000; val_optim_loss: 22215465.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9269; val_auprc_score: 0.8959; val_best_acc_score: 0.8726; val_best_f1_score: 0.8792; train_kl_reg_loss: 107241.7765; train_edge_recon_loss: 2791094.2992; train_gene_expr_recon_loss: 13442998.6364; train_masked_gp_l1_reg_loss: 103819.2782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29148.3593; train_chrom_access_recon_loss: 5480524.7045; train_global_loss: 21954827.0909; train_optim_loss: 21954827.0909; val_kl_reg_loss: 74802.3623; val_edge_recon_loss: 2838110.6250; val_gene_expr_recon_loss: 13594848.3750; val_masked_gp_l1_reg_loss: 103836.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28669.7266; val_chrom_access_recon_loss: 5531634.1250; val_global_loss: 22171902.0000; val_optim_loss: 22171902.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9222; val_auprc_score: 0.8893; val_best_acc_score: 0.8678; val_best_f1_score: 0.8755; train_kl_reg_loss: 108841.2102; train_edge_recon_loss: 2789724.3182; train_gene_expr_recon_loss: 13431852.5606; train_masked_gp_l1_reg_loss: 103865.6515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28302.8261; train_chrom_access_recon_loss: 5466833.5833; train_global_loss: 21929420.0606; train_optim_loss: 21929420.0606; val_kl_reg_loss: 75931.7559; val_edge_recon_loss: 2812935.1875; val_gene_expr_recon_loss: 13510199.0000; val_masked_gp_l1_reg_loss: 103901.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27981.0859; val_chrom_access_recon_loss: 5530093.3125; val_global_loss: 22061041.2500; val_optim_loss: 22061041.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9293; val_auprc_score: 0.9041; val_best_acc_score: 0.8726; val_best_f1_score: 0.8795; train_kl_reg_loss: 108841.3569; train_edge_recon_loss: 2788417.3864; train_gene_expr_recon_loss: 13415726.6667; train_masked_gp_l1_reg_loss: 103947.2932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27729.9827; train_chrom_access_recon_loss: 5464179.0227; train_global_loss: 21908841.6364; train_optim_loss: 21908841.6364; val_kl_reg_loss: 75857.1475; val_edge_recon_loss: 2814028.7812; val_gene_expr_recon_loss: 13526388.2500; val_masked_gp_l1_reg_loss: 103975.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27476.9473; val_chrom_access_recon_loss: 5479136.0000; val_global_loss: 22026861.7500; val_optim_loss: 22026861.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9303; val_auprc_score: 0.9054; val_best_acc_score: 0.8710; val_best_f1_score: 0.8797; train_kl_reg_loss: 108478.3114; train_edge_recon_loss: 2775953.3674; train_gene_expr_recon_loss: 13428720.4697; train_masked_gp_l1_reg_loss: 104031.9122; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27288.6346; train_chrom_access_recon_loss: 5466558.2348; train_global_loss: 21911030.9394; train_optim_loss: 21911030.9394; val_kl_reg_loss: 76776.5928; val_edge_recon_loss: 2825344.4688; val_gene_expr_recon_loss: 13574431.3750; val_masked_gp_l1_reg_loss: 104090.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27094.6113; val_chrom_access_recon_loss: 5515683.4375; val_global_loss: 22123421.2500; val_optim_loss: 22123421.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9299; val_auprc_score: 0.9080; val_best_acc_score: 0.8684; val_best_f1_score: 0.8756; train_kl_reg_loss: 108845.3189; train_edge_recon_loss: 2772853.0530; train_gene_expr_recon_loss: 13421748.2879; train_masked_gp_l1_reg_loss: 104134.2218; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26963.8451; train_chrom_access_recon_loss: 5461565.0682; train_global_loss: 21896109.8182; train_optim_loss: 21896109.8182; val_kl_reg_loss: 78183.0645; val_edge_recon_loss: 2842324.9688; val_gene_expr_recon_loss: 13646253.5000; val_masked_gp_l1_reg_loss: 104152.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26817.5410; val_chrom_access_recon_loss: 5532664.8750; val_global_loss: 22230397.5000; val_optim_loss: 22230397.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9297; val_auprc_score: 0.9013; val_best_acc_score: 0.8764; val_best_f1_score: 0.8820; train_kl_reg_loss: 108029.0170; train_edge_recon_loss: 2768612.4432; train_gene_expr_recon_loss: 13415330.1515; train_masked_gp_l1_reg_loss: 104205.3340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26701.5774; train_chrom_access_recon_loss: 5458405.3409; train_global_loss: 21881284.0303; train_optim_loss: 21881284.0303; val_kl_reg_loss: 78843.2080; val_edge_recon_loss: 2780524.7188; val_gene_expr_recon_loss: 13750657.7500; val_masked_gp_l1_reg_loss: 104243.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26574.9355; val_chrom_access_recon_loss: 5544401.0000; val_global_loss: 22285245.5000; val_optim_loss: 22285245.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9250; val_auprc_score: 0.8979; val_best_acc_score: 0.8651; val_best_f1_score: 0.8718; train_kl_reg_loss: 107705.9373; train_edge_recon_loss: 2770881.4659; train_gene_expr_recon_loss: 13404411.5152; train_masked_gp_l1_reg_loss: 104303.9156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26493.8136; train_chrom_access_recon_loss: 5451908.0455; train_global_loss: 21865704.8485; train_optim_loss: 21865704.8485; val_kl_reg_loss: 78384.5986; val_edge_recon_loss: 2845708.1250; val_gene_expr_recon_loss: 13616432.6250; val_masked_gp_l1_reg_loss: 104345.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26394.9336; val_chrom_access_recon_loss: 5506023.5625; val_global_loss: 22177289.0000; val_optim_loss: 22177289.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9239; val_auprc_score: 0.8892; val_best_acc_score: 0.8673; val_best_f1_score: 0.8758; train_kl_reg_loss: 106386.0939; train_edge_recon_loss: 2772855.5265; train_gene_expr_recon_loss: 13410061.3636; train_masked_gp_l1_reg_loss: 104260.2459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26118.6538; train_chrom_access_recon_loss: 5452725.1061; train_global_loss: 21872407.0000; train_optim_loss: 21872407.0000; val_kl_reg_loss: 78777.8486; val_edge_recon_loss: 2807222.3125; val_gene_expr_recon_loss: 13659144.5000; val_masked_gp_l1_reg_loss: 104213.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26049.3750; val_chrom_access_recon_loss: 5469410.7500; val_global_loss: 22144818.7500; val_optim_loss: 22144818.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9353; val_auprc_score: 0.9118; val_best_acc_score: 0.8756; val_best_f1_score: 0.8820; train_kl_reg_loss: 106599.1085; train_edge_recon_loss: 2775166.9962; train_gene_expr_recon_loss: 13416102.4242; train_masked_gp_l1_reg_loss: 104198.8536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26029.5327; train_chrom_access_recon_loss: 5458861.4470; train_global_loss: 21886958.3030; train_optim_loss: 21886958.3030; val_kl_reg_loss: 78590.2188; val_edge_recon_loss: 2794078.3438; val_gene_expr_recon_loss: 13488873.8750; val_masked_gp_l1_reg_loss: 104186.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26009.6250; val_chrom_access_recon_loss: 5509641.1875; val_global_loss: 22001380.7500; val_optim_loss: 22001380.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9296; val_auprc_score: 0.8973; val_best_acc_score: 0.8716; val_best_f1_score: 0.8791; train_kl_reg_loss: 106756.2367; train_edge_recon_loss: 2773504.9129; train_gene_expr_recon_loss: 13395125.8182; train_masked_gp_l1_reg_loss: 104181.4144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25993.6550; train_chrom_access_recon_loss: 5448641.0379; train_global_loss: 21854202.9697; train_optim_loss: 21854202.9697; val_kl_reg_loss: 77973.3682; val_edge_recon_loss: 2791137.5312; val_gene_expr_recon_loss: 13581298.1250; val_masked_gp_l1_reg_loss: 104174.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25977.8203; val_chrom_access_recon_loss: 5464220.7500; val_global_loss: 22044782.5000; val_optim_loss: 22044782.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9350; val_auprc_score: 0.9146; val_best_acc_score: 0.8748; val_best_f1_score: 0.8809; train_kl_reg_loss: 106624.8630; train_edge_recon_loss: 2781220.3030; train_gene_expr_recon_loss: 13404677.8636; train_masked_gp_l1_reg_loss: 104174.2989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25964.7220; train_chrom_access_recon_loss: 5453330.0682; train_global_loss: 21875992.0909; train_optim_loss: 21875992.0909; val_kl_reg_loss: 79135.2998; val_edge_recon_loss: 2792529.3125; val_gene_expr_recon_loss: 13634047.5000; val_masked_gp_l1_reg_loss: 104172.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25951.0371; val_chrom_access_recon_loss: 5552719.7500; val_global_loss: 22188555.5000; val_optim_loss: 22188555.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9346; val_auprc_score: 0.9098; val_best_acc_score: 0.8815; val_best_f1_score: 0.8868; train_kl_reg_loss: 106436.6077; train_edge_recon_loss: 2760948.7614; train_gene_expr_recon_loss: 13408835.7879; train_masked_gp_l1_reg_loss: 104173.2718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25939.2736; train_chrom_access_recon_loss: 5452057.1591; train_global_loss: 21858390.8788; train_optim_loss: 21858390.8788; val_kl_reg_loss: 78437.0283; val_edge_recon_loss: 2777072.5938; val_gene_expr_recon_loss: 13494054.2500; val_masked_gp_l1_reg_loss: 104173.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25927.0078; val_chrom_access_recon_loss: 5517124.8750; val_global_loss: 21996790.0000; val_optim_loss: 21996790.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9338; val_auprc_score: 0.9103; val_best_acc_score: 0.8753; val_best_f1_score: 0.8826; train_kl_reg_loss: 106602.0436; train_edge_recon_loss: 2774305.3371; train_gene_expr_recon_loss: 13404152.6970; train_masked_gp_l1_reg_loss: 104177.1108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25916.4302; train_chrom_access_recon_loss: 5453616.5227; train_global_loss: 21868770.0303; train_optim_loss: 21868770.0303; val_kl_reg_loss: 79278.8135; val_edge_recon_loss: 2783194.2812; val_gene_expr_recon_loss: 13560305.8750; val_masked_gp_l1_reg_loss: 104177.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25903.5918; val_chrom_access_recon_loss: 5456900.3125; val_global_loss: 22009761.5000; val_optim_loss: 22009761.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9293; val_auprc_score: 0.9033; val_best_acc_score: 0.8732; val_best_f1_score: 0.8798; train_kl_reg_loss: 106430.7792; train_edge_recon_loss: 2771811.2879; train_gene_expr_recon_loss: 13398867.9697; train_masked_gp_l1_reg_loss: 104181.2778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25894.8102; train_chrom_access_recon_loss: 5451330.3106; train_global_loss: 21858516.2727; train_optim_loss: 21858516.2727; val_kl_reg_loss: 79165.8604; val_edge_recon_loss: 2796256.7500; val_gene_expr_recon_loss: 13534459.2500; val_masked_gp_l1_reg_loss: 104183.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25882.0625; val_chrom_access_recon_loss: 5485546.7500; val_global_loss: 22025494.5000; val_optim_loss: 22025494.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9313; val_auprc_score: 0.9079; val_best_acc_score: 0.8702; val_best_f1_score: 0.8779; train_kl_reg_loss: 106481.0792; train_edge_recon_loss: 2767497.6856; train_gene_expr_recon_loss: 13402169.9091; train_masked_gp_l1_reg_loss: 104187.2611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25872.3573; train_chrom_access_recon_loss: 5456914.8712; train_global_loss: 21863123.0000; train_optim_loss: 21863123.0000; val_kl_reg_loss: 79140.7188; val_edge_recon_loss: 2799654.5312; val_gene_expr_recon_loss: 13660179.5000; val_masked_gp_l1_reg_loss: 104188.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25861.2617; val_chrom_access_recon_loss: 5537579.1250; val_global_loss: 22206604.0000; val_optim_loss: 22206604.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9341; val_auprc_score: 0.9128; val_best_acc_score: 0.8767; val_best_f1_score: 0.8833; train_kl_reg_loss: 106494.7085; train_edge_recon_loss: 2770042.3258; train_gene_expr_recon_loss: 13406976.5606; train_masked_gp_l1_reg_loss: 104193.1727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25852.2174; train_chrom_access_recon_loss: 5451502.7121; train_global_loss: 21865061.5758; train_optim_loss: 21865061.5758; val_kl_reg_loss: 78646.8330; val_edge_recon_loss: 2776608.9375; val_gene_expr_recon_loss: 13450572.6250; val_masked_gp_l1_reg_loss: 104196.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25840.9062; val_chrom_access_recon_loss: 5478739.9375; val_global_loss: 21914605.2500; val_optim_loss: 21914605.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9333; val_auprc_score: 0.9096; val_best_acc_score: 0.8764; val_best_f1_score: 0.8824; train_kl_reg_loss: 106102.5578; train_edge_recon_loss: 2779030.2765; train_gene_expr_recon_loss: 13399610.4242; train_masked_gp_l1_reg_loss: 104201.1806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25830.8915; train_chrom_access_recon_loss: 5451864.6061; train_global_loss: 21866640.0606; train_optim_loss: 21866640.0606; val_kl_reg_loss: 79280.5928; val_edge_recon_loss: 2789449.8125; val_gene_expr_recon_loss: 13509275.2500; val_masked_gp_l1_reg_loss: 104202.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25820.6797; val_chrom_access_recon_loss: 5466841.5625; val_global_loss: 21974870.5000; val_optim_loss: 21974870.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9314; val_auprc_score: 0.9105; val_best_acc_score: 0.8748; val_best_f1_score: 0.8812; train_kl_reg_loss: 106048.3147; train_edge_recon_loss: 2771028.8409; train_gene_expr_recon_loss: 13393341.8333; train_masked_gp_l1_reg_loss: 104208.8243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25813.1181; train_chrom_access_recon_loss: 5446876.3182; train_global_loss: 21847317.2727; train_optim_loss: 21847317.2727; val_kl_reg_loss: 79405.2539; val_edge_recon_loss: 2812792.8125; val_gene_expr_recon_loss: 13697695.5000; val_masked_gp_l1_reg_loss: 104211.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25800.8906; val_chrom_access_recon_loss: 5535081.2500; val_global_loss: 22254987.5000; val_optim_loss: 22254987.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9326; val_auprc_score: 0.9009; val_best_acc_score: 0.8772; val_best_f1_score: 0.8821; train_kl_reg_loss: 105731.1051; train_edge_recon_loss: 2767627.4962; train_gene_expr_recon_loss: 13389818.3030; train_masked_gp_l1_reg_loss: 104217.9426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25793.4045; train_chrom_access_recon_loss: 5451565.0530; train_global_loss: 21844753.3030; train_optim_loss: 21844753.3030; val_kl_reg_loss: 79149.3223; val_edge_recon_loss: 2771836.1875; val_gene_expr_recon_loss: 13502712.2500; val_masked_gp_l1_reg_loss: 104219.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25783.3750; val_chrom_access_recon_loss: 5457963.4375; val_global_loss: 21941664.5000; val_optim_loss: 21941664.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9309; val_auprc_score: 0.9054; val_best_acc_score: 0.8740; val_best_f1_score: 0.8800; train_kl_reg_loss: 105803.2765; train_edge_recon_loss: 2759279.7955; train_gene_expr_recon_loss: 13403636.6515; train_masked_gp_l1_reg_loss: 104225.2397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25772.8398; train_chrom_access_recon_loss: 5452759.0833; train_global_loss: 21851476.7879; train_optim_loss: 21851476.7879; val_kl_reg_loss: 79013.5957; val_edge_recon_loss: 2811777.7500; val_gene_expr_recon_loss: 13547914.7500; val_masked_gp_l1_reg_loss: 104229.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25761.6582; val_chrom_access_recon_loss: 5487421.3125; val_global_loss: 22056119.2500; val_optim_loss: 22056119.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9352; val_auprc_score: 0.9172; val_best_acc_score: 0.8759; val_best_f1_score: 0.8835; train_kl_reg_loss: 105865.5210; train_edge_recon_loss: 2764249.6970; train_gene_expr_recon_loss: 13402368.6212; train_masked_gp_l1_reg_loss: 104220.7557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25731.6171; train_chrom_access_recon_loss: 5454767.3788; train_global_loss: 21857203.6364; train_optim_loss: 21857203.6364; val_kl_reg_loss: 78859.3057; val_edge_recon_loss: 2781217.9375; val_gene_expr_recon_loss: 13554804.1250; val_masked_gp_l1_reg_loss: 104216.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25724.6211; val_chrom_access_recon_loss: 5515615.0000; val_global_loss: 22060437.2500; val_optim_loss: 22060437.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9283; val_auprc_score: 0.8959; val_best_acc_score: 0.8724; val_best_f1_score: 0.8791; train_kl_reg_loss: 105868.7591; train_edge_recon_loss: 2765404.1477; train_gene_expr_recon_loss: 13409700.8485; train_masked_gp_l1_reg_loss: 104214.6607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25722.9432; train_chrom_access_recon_loss: 5456850.6212; train_global_loss: 21867762.1818; train_optim_loss: 21867762.1818; val_kl_reg_loss: 79145.3184; val_edge_recon_loss: 2808461.4688; val_gene_expr_recon_loss: 13495237.3750; val_masked_gp_l1_reg_loss: 104213.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25721.2520; val_chrom_access_recon_loss: 5487712.5000; val_global_loss: 22000491.0000; val_optim_loss: 22000491.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9269; val_auprc_score: 0.8972; val_best_acc_score: 0.8697; val_best_f1_score: 0.8772; train_kl_reg_loss: 106005.2389; train_edge_recon_loss: 2755565.0568; train_gene_expr_recon_loss: 13398164.7273; train_masked_gp_l1_reg_loss: 104212.7416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25719.9607; train_chrom_access_recon_loss: 5450999.4167; train_global_loss: 21840667.1818; train_optim_loss: 21840667.1818; val_kl_reg_loss: 79358.4131; val_edge_recon_loss: 2807868.8750; val_gene_expr_recon_loss: 13558787.1250; val_masked_gp_l1_reg_loss: 104212.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25718.4629; val_chrom_access_recon_loss: 5527572.9375; val_global_loss: 22103517.7500; val_optim_loss: 22103517.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9265; val_auprc_score: 0.9003; val_best_acc_score: 0.8692; val_best_f1_score: 0.8759; train_kl_reg_loss: 105898.0922; train_edge_recon_loss: 2765913.4015; train_gene_expr_recon_loss: 13400534.5909; train_masked_gp_l1_reg_loss: 104211.7309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25717.2076; train_chrom_access_recon_loss: 5447235.6212; train_global_loss: 21849510.6364; train_optim_loss: 21849510.6364; val_kl_reg_loss: 79280.6875; val_edge_recon_loss: 2827411.9688; val_gene_expr_recon_loss: 13513630.6250; val_masked_gp_l1_reg_loss: 104211.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25715.8164; val_chrom_access_recon_loss: 5482161.3750; val_global_loss: 22032412.7500; val_optim_loss: 22032412.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 30 min 45 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9186
val AUPRC score: 0.8788
val best accuracy score: 0.8600
val best F1 score: 0.8689
val target rna MSE score: 0.9394
val source rna MSE score: 0.3245
val target atac MSE score: 0.4918
val source atac MSE score: 0.1091
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
