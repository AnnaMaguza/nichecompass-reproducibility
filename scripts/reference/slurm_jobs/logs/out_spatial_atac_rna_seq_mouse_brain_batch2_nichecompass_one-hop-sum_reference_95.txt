[True]
Run timestamp: 10082023_231741_95.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '50.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_95']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 3000 peaks after filtering spatially variable peaks.
Keeping 600 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4751, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 600

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7060; val_auprc_score: 0.7389; val_best_acc_score: 0.5063; val_best_f1_score: 0.6690; train_kl_reg_loss: 113821.6723; train_edge_recon_loss: 3779180.4771; train_gene_expr_recon_loss: 44711653.0992; train_masked_gp_l1_reg_loss: 84816.2401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 242765.3406; train_chrom_access_recon_loss: 6776079.0344; train_global_loss: 55708315.9389; train_optim_loss: 55708315.9389; val_kl_reg_loss: 81208.6875; val_edge_recon_loss: 4064918.8500; val_gene_expr_recon_loss: 39518364.8000; val_masked_gp_l1_reg_loss: 86700.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 236552.7812; val_chrom_access_recon_loss: 6542654.9000; val_global_loss: 50530398.9333; val_optim_loss: 50530398.9333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7869; val_auprc_score: 0.7993; val_best_acc_score: 0.6737; val_best_f1_score: 0.7310; train_kl_reg_loss: 195080.1731; train_edge_recon_loss: 3610624.6431; train_gene_expr_recon_loss: 37847728.1832; train_masked_gp_l1_reg_loss: 82187.7196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 229127.7134; train_chrom_access_recon_loss: 6398917.2405; train_global_loss: 48363665.9847; train_optim_loss: 48363665.9847; val_kl_reg_loss: 218788.2760; val_edge_recon_loss: 4047420.6667; val_gene_expr_recon_loss: 37254764.8000; val_masked_gp_l1_reg_loss: 78639.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 221239.6719; val_chrom_access_recon_loss: 6348167.0000; val_global_loss: 48169020.5333; val_optim_loss: 48169020.5333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8800; val_auprc_score: 0.8757; val_best_acc_score: 0.7980; val_best_f1_score: 0.8152; train_kl_reg_loss: 183666.0270; train_edge_recon_loss: 3554431.8359; train_gene_expr_recon_loss: 36948548.7328; train_masked_gp_l1_reg_loss: 78111.0742; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 213569.5551; train_chrom_access_recon_loss: 6325865.4847; train_global_loss: 47304192.7328; train_optim_loss: 47304192.7328; val_kl_reg_loss: 158508.6490; val_edge_recon_loss: 3895970.0667; val_gene_expr_recon_loss: 36780760.8000; val_masked_gp_l1_reg_loss: 78641.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 205989.2031; val_chrom_access_recon_loss: 6335476.8333; val_global_loss: 47455344.2667; val_optim_loss: 47455344.2667
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8882; val_auprc_score: 0.8771; val_best_acc_score: 0.8036; val_best_f1_score: 0.8203; train_kl_reg_loss: 154475.5920; train_edge_recon_loss: 3412797.0840; train_gene_expr_recon_loss: 36586433.0382; train_masked_gp_l1_reg_loss: 80136.7084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 199165.1869; train_chrom_access_recon_loss: 6290549.2328; train_global_loss: 46723556.6718; train_optim_loss: 46723556.6718; val_kl_reg_loss: 153409.9937; val_edge_recon_loss: 3253298.7000; val_gene_expr_recon_loss: 36783793.0667; val_masked_gp_l1_reg_loss: 82054.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192671.5000; val_chrom_access_recon_loss: 6353745.6667; val_global_loss: 46818975.4667; val_optim_loss: 46818975.4667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8979; val_auprc_score: 0.8813; val_best_acc_score: 0.8169; val_best_f1_score: 0.8298; train_kl_reg_loss: 183097.1449; train_edge_recon_loss: 3068718.8168; train_gene_expr_recon_loss: 36280642.8702; train_masked_gp_l1_reg_loss: 84007.4126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 187204.2142; train_chrom_access_recon_loss: 6253478.6183; train_global_loss: 46057149.0687; train_optim_loss: 46057149.0687; val_kl_reg_loss: 189111.4062; val_edge_recon_loss: 3039527.1000; val_gene_expr_recon_loss: 36509805.0667; val_masked_gp_l1_reg_loss: 85265.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 181959.2344; val_chrom_access_recon_loss: 6314708.0000; val_global_loss: 46320376.2667; val_optim_loss: 46320376.2667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9179; val_auprc_score: 0.9039; val_best_acc_score: 0.8418; val_best_f1_score: 0.8527; train_kl_reg_loss: 185032.6899; train_edge_recon_loss: 2986941.8073; train_gene_expr_recon_loss: 36038839.2366; train_masked_gp_l1_reg_loss: 86357.1921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176907.2637; train_chrom_access_recon_loss: 6220133.6374; train_global_loss: 45694211.9389; train_optim_loss: 45694211.9389; val_kl_reg_loss: 181180.0333; val_edge_recon_loss: 2958292.4833; val_gene_expr_recon_loss: 36094788.8000; val_masked_gp_l1_reg_loss: 87612.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171892.1094; val_chrom_access_recon_loss: 6244507.4667; val_global_loss: 45738273.3333; val_optim_loss: 45738273.3333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9200; val_auprc_score: 0.9041; val_best_acc_score: 0.8507; val_best_f1_score: 0.8598; train_kl_reg_loss: 180172.1576; train_edge_recon_loss: 2940524.3244; train_gene_expr_recon_loss: 35800911.6641; train_masked_gp_l1_reg_loss: 88887.9929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167320.2498; train_chrom_access_recon_loss: 6198160.0000; train_global_loss: 45375976.3664; train_optim_loss: 45375976.3664; val_kl_reg_loss: 174728.4750; val_edge_recon_loss: 2960819.3000; val_gene_expr_recon_loss: 35980719.7333; val_masked_gp_l1_reg_loss: 90205.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162906.5938; val_chrom_access_recon_loss: 6273023.9000; val_global_loss: 45642403.4667; val_optim_loss: 45642403.4667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9346; val_auprc_score: 0.9222; val_best_acc_score: 0.8642; val_best_f1_score: 0.8721; train_kl_reg_loss: 177062.2005; train_edge_recon_loss: 2900617.4466; train_gene_expr_recon_loss: 35643489.9847; train_masked_gp_l1_reg_loss: 91377.2458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158709.6541; train_chrom_access_recon_loss: 6174173.7061; train_global_loss: 45145430.4122; train_optim_loss: 45145430.4122; val_kl_reg_loss: 177281.2865; val_edge_recon_loss: 2885151.8667; val_gene_expr_recon_loss: 35649627.4667; val_masked_gp_l1_reg_loss: 92573.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154596.6875; val_chrom_access_recon_loss: 6195054.1667; val_global_loss: 45154282.9333; val_optim_loss: 45154282.9333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9300; val_auprc_score: 0.9162; val_best_acc_score: 0.8603; val_best_f1_score: 0.8667; train_kl_reg_loss: 172757.7327; train_edge_recon_loss: 2872443.5706; train_gene_expr_recon_loss: 35473476.1069; train_masked_gp_l1_reg_loss: 93725.5256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150703.0835; train_chrom_access_recon_loss: 6154474.0229; train_global_loss: 44917579.9084; train_optim_loss: 44917579.9084; val_kl_reg_loss: 171895.6583; val_edge_recon_loss: 2902654.8000; val_gene_expr_recon_loss: 35661215.2000; val_masked_gp_l1_reg_loss: 94932.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146896.5625; val_chrom_access_recon_loss: 6192394.5667; val_global_loss: 45169988.2667; val_optim_loss: 45169988.2667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9407; val_auprc_score: 0.9303; val_best_acc_score: 0.8740; val_best_f1_score: 0.8812; train_kl_reg_loss: 165720.5813; train_edge_recon_loss: 2872694.1164; train_gene_expr_recon_loss: 35328522.4122; train_masked_gp_l1_reg_loss: 96070.9228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143406.0295; train_chrom_access_recon_loss: 6137409.9351; train_global_loss: 44743823.7252; train_optim_loss: 44743823.7252; val_kl_reg_loss: 162690.4906; val_edge_recon_loss: 2861325.2167; val_gene_expr_recon_loss: 35467665.0667; val_masked_gp_l1_reg_loss: 97019.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140001.9531; val_chrom_access_recon_loss: 6185026.4333; val_global_loss: 44913726.9333; val_optim_loss: 44913726.9333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9486; val_auprc_score: 0.9372; val_best_acc_score: 0.8880; val_best_f1_score: 0.8927; train_kl_reg_loss: 161876.9881; train_edge_recon_loss: 2842741.8893; train_gene_expr_recon_loss: 35206581.4504; train_masked_gp_l1_reg_loss: 98253.5255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136870.9874; train_chrom_access_recon_loss: 6118889.1031; train_global_loss: 44565213.9847; train_optim_loss: 44565213.9847; val_kl_reg_loss: 162450.2313; val_edge_recon_loss: 2843001.3667; val_gene_expr_recon_loss: 35426581.6000; val_masked_gp_l1_reg_loss: 99340.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133773.7812; val_chrom_access_recon_loss: 6154505.3000; val_global_loss: 44819650.6667; val_optim_loss: 44819650.6667
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9451; val_auprc_score: 0.9319; val_best_acc_score: 0.8820; val_best_f1_score: 0.8880; train_kl_reg_loss: 157515.3575; train_edge_recon_loss: 2831519.3206; train_gene_expr_recon_loss: 35095952.0000; train_masked_gp_l1_reg_loss: 100382.2687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130808.4740; train_chrom_access_recon_loss: 6104455.6450; train_global_loss: 44420632.8855; train_optim_loss: 44420632.8855; val_kl_reg_loss: 155278.1625; val_edge_recon_loss: 2855104.3000; val_gene_expr_recon_loss: 35204702.4000; val_masked_gp_l1_reg_loss: 101341.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127859.3281; val_chrom_access_recon_loss: 6173454.8333; val_global_loss: 44617740.0000; val_optim_loss: 44617740.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9495; val_auprc_score: 0.9370; val_best_acc_score: 0.8860; val_best_f1_score: 0.8912; train_kl_reg_loss: 154430.1907; train_edge_recon_loss: 2815681.9198; train_gene_expr_recon_loss: 34991656.6107; train_masked_gp_l1_reg_loss: 102520.0796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125163.2029; train_chrom_access_recon_loss: 6091445.8397; train_global_loss: 44280897.9237; train_optim_loss: 44280897.9237; val_kl_reg_loss: 156521.3885; val_edge_recon_loss: 2821388.7667; val_gene_expr_recon_loss: 35103164.0000; val_masked_gp_l1_reg_loss: 103436.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122483.2656; val_chrom_access_recon_loss: 6122449.5333; val_global_loss: 44429444.0000; val_optim_loss: 44429444.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9574; val_auprc_score: 0.9501; val_best_acc_score: 0.8996; val_best_f1_score: 0.9035; train_kl_reg_loss: 150906.0531; train_edge_recon_loss: 2814834.0515; train_gene_expr_recon_loss: 34928019.1145; train_masked_gp_l1_reg_loss: 104493.9482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119853.8959; train_chrom_access_recon_loss: 6084580.3321; train_global_loss: 44202687.3282; train_optim_loss: 44202687.3282; val_kl_reg_loss: 150513.9969; val_edge_recon_loss: 2791288.0167; val_gene_expr_recon_loss: 35064578.1333; val_masked_gp_l1_reg_loss: 105693.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117260.3516; val_chrom_access_recon_loss: 6121547.2667; val_global_loss: 44350879.4667; val_optim_loss: 44350879.4667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9562; val_auprc_score: 0.9453; val_best_acc_score: 0.8998; val_best_f1_score: 0.9040; train_kl_reg_loss: 146534.2791; train_edge_recon_loss: 2800409.6870; train_gene_expr_recon_loss: 34896417.4809; train_masked_gp_l1_reg_loss: 106557.1270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114884.3990; train_chrom_access_recon_loss: 6086043.9733; train_global_loss: 44150847.1145; train_optim_loss: 44150847.1145; val_kl_reg_loss: 143320.3385; val_edge_recon_loss: 2796607.7667; val_gene_expr_recon_loss: 35112588.0000; val_masked_gp_l1_reg_loss: 107672.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112428.3672; val_chrom_access_recon_loss: 6120559.3333; val_global_loss: 44393175.2000; val_optim_loss: 44393175.2000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9598; val_auprc_score: 0.9486; val_best_acc_score: 0.9030; val_best_f1_score: 0.9059; train_kl_reg_loss: 143038.1294; train_edge_recon_loss: 2799476.1031; train_gene_expr_recon_loss: 34769284.9008; train_masked_gp_l1_reg_loss: 108520.2021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110182.7947; train_chrom_access_recon_loss: 6065392.2786; train_global_loss: 43995894.4427; train_optim_loss: 43995894.4427; val_kl_reg_loss: 138734.7458; val_edge_recon_loss: 2793298.6167; val_gene_expr_recon_loss: 34915580.8000; val_masked_gp_l1_reg_loss: 109588.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107952.4688; val_chrom_access_recon_loss: 6093608.7000; val_global_loss: 44158763.2000; val_optim_loss: 44158763.2000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9627; val_auprc_score: 0.9547; val_best_acc_score: 0.9043; val_best_f1_score: 0.9060; train_kl_reg_loss: 140602.7245; train_edge_recon_loss: 2784586.5534; train_gene_expr_recon_loss: 34720656.0000; train_masked_gp_l1_reg_loss: 110435.7287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105790.3048; train_chrom_access_recon_loss: 6062656.6794; train_global_loss: 43924728.0611; train_optim_loss: 43924728.0611; val_kl_reg_loss: 138752.1187; val_edge_recon_loss: 2783433.3833; val_gene_expr_recon_loss: 34893391.0667; val_masked_gp_l1_reg_loss: 111559.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103787.1562; val_chrom_access_recon_loss: 6069852.9000; val_global_loss: 44100777.3333; val_optim_loss: 44100777.3333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9660; val_auprc_score: 0.9581; val_best_acc_score: 0.9139; val_best_f1_score: 0.9157; train_kl_reg_loss: 137706.8693; train_edge_recon_loss: 2777745.3034; train_gene_expr_recon_loss: 34603004.3359; train_masked_gp_l1_reg_loss: 112437.9845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101847.5711; train_chrom_access_recon_loss: 6041070.4198; train_global_loss: 43773812.3053; train_optim_loss: 43773812.3053; val_kl_reg_loss: 137862.5708; val_edge_recon_loss: 2768341.4167; val_gene_expr_recon_loss: 34748976.0000; val_masked_gp_l1_reg_loss: 113291.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99911.9297; val_chrom_access_recon_loss: 6076693.3000; val_global_loss: 43945077.3333; val_optim_loss: 43945077.3333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9664; val_auprc_score: 0.9578; val_best_acc_score: 0.9127; val_best_f1_score: 0.9148; train_kl_reg_loss: 135741.0429; train_edge_recon_loss: 2768113.0897; train_gene_expr_recon_loss: 34561816.5802; train_masked_gp_l1_reg_loss: 114203.7928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98156.8979; train_chrom_access_recon_loss: 6042309.4198; train_global_loss: 43720340.8855; train_optim_loss: 43720340.8855; val_kl_reg_loss: 134223.6760; val_edge_recon_loss: 2756435.5167; val_gene_expr_recon_loss: 34839966.1333; val_masked_gp_l1_reg_loss: 115311.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96438.6484; val_chrom_access_recon_loss: 6104866.7667; val_global_loss: 44047243.4667; val_optim_loss: 44047243.4667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9693; val_auprc_score: 0.9626; val_best_acc_score: 0.9150; val_best_f1_score: 0.9171; train_kl_reg_loss: 133847.1645; train_edge_recon_loss: 2767132.3416; train_gene_expr_recon_loss: 34513155.3740; train_masked_gp_l1_reg_loss: 116131.8106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94851.4191; train_chrom_access_recon_loss: 6038243.2634; train_global_loss: 43663360.8855; train_optim_loss: 43663360.8855; val_kl_reg_loss: 131756.4526; val_edge_recon_loss: 2776828.1833; val_gene_expr_recon_loss: 34730222.1333; val_masked_gp_l1_reg_loss: 117202.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93258.7891; val_chrom_access_recon_loss: 6086055.2000; val_global_loss: 43935325.8667; val_optim_loss: 43935325.8667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9701; val_auprc_score: 0.9635; val_best_acc_score: 0.9166; val_best_f1_score: 0.9197; train_kl_reg_loss: 130825.7227; train_edge_recon_loss: 2763803.6069; train_gene_expr_recon_loss: 34440613.3893; train_masked_gp_l1_reg_loss: 118030.2042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91712.1246; train_chrom_access_recon_loss: 6028674.9313; train_global_loss: 43573659.9695; train_optim_loss: 43573659.9695; val_kl_reg_loss: 130809.5635; val_edge_recon_loss: 2769178.2000; val_gene_expr_recon_loss: 34672223.0667; val_masked_gp_l1_reg_loss: 119020.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90212.6953; val_chrom_access_recon_loss: 6075808.6667; val_global_loss: 43857251.7333; val_optim_loss: 43857251.7333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9682; val_auprc_score: 0.9591; val_best_acc_score: 0.9171; val_best_f1_score: 0.9207; train_kl_reg_loss: 129633.1146; train_edge_recon_loss: 2756303.8893; train_gene_expr_recon_loss: 34392867.5573; train_masked_gp_l1_reg_loss: 119843.5299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88790.0211; train_chrom_access_recon_loss: 6025585.2405; train_global_loss: 43513023.4809; train_optim_loss: 43513023.4809; val_kl_reg_loss: 128116.6339; val_edge_recon_loss: 2767237.3333; val_gene_expr_recon_loss: 34732380.2667; val_masked_gp_l1_reg_loss: 120825.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87361.8438; val_chrom_access_recon_loss: 6090983.4000; val_global_loss: 43926901.0667; val_optim_loss: 43926901.0667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9750; val_auprc_score: 0.9689; val_best_acc_score: 0.9223; val_best_f1_score: 0.9248; train_kl_reg_loss: 127164.9036; train_edge_recon_loss: 2759469.7672; train_gene_expr_recon_loss: 34331428.1374; train_masked_gp_l1_reg_loss: 121842.0432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86016.5831; train_chrom_access_recon_loss: 6018695.2328; train_global_loss: 43444616.8855; train_optim_loss: 43444616.8855; val_kl_reg_loss: 125646.0188; val_edge_recon_loss: 2760353.1833; val_gene_expr_recon_loss: 34609021.4667; val_masked_gp_l1_reg_loss: 122649.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84756.8125; val_chrom_access_recon_loss: 6072396.8000; val_global_loss: 43774820.5333; val_optim_loss: 43774820.5333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9719; val_auprc_score: 0.9641; val_best_acc_score: 0.9201; val_best_f1_score: 0.9234; train_kl_reg_loss: 125825.0521; train_edge_recon_loss: 2750746.1126; train_gene_expr_recon_loss: 34268954.6565; train_masked_gp_l1_reg_loss: 123630.0270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83464.1490; train_chrom_access_recon_loss: 6007327.7099; train_global_loss: 43359947.5420; train_optim_loss: 43359947.5420; val_kl_reg_loss: 123099.3500; val_edge_recon_loss: 2764511.1500; val_gene_expr_recon_loss: 34480536.9333; val_masked_gp_l1_reg_loss: 124448.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82202.0078; val_chrom_access_recon_loss: 6071948.3667; val_global_loss: 43646747.4667; val_optim_loss: 43646747.4667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9740; val_auprc_score: 0.9689; val_best_acc_score: 0.9204; val_best_f1_score: 0.9232; train_kl_reg_loss: 123868.4732; train_edge_recon_loss: 2744943.0229; train_gene_expr_recon_loss: 34238600.8550; train_masked_gp_l1_reg_loss: 125482.5793; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81123.1138; train_chrom_access_recon_loss: 6011044.4046; train_global_loss: 43325062.8092; train_optim_loss: 43325062.8092; val_kl_reg_loss: 123748.3698; val_edge_recon_loss: 2752986.5000; val_gene_expr_recon_loss: 34577506.0000; val_masked_gp_l1_reg_loss: 126484.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80106.0703; val_chrom_access_recon_loss: 6065106.5667; val_global_loss: 43725939.4667; val_optim_loss: 43725939.4667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9724; val_auprc_score: 0.9659; val_best_acc_score: 0.9221; val_best_f1_score: 0.9242; train_kl_reg_loss: 133524.4859; train_edge_recon_loss: 2811058.9389; train_gene_expr_recon_loss: 35616679.5115; train_masked_gp_l1_reg_loss: 126506.7698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81432.3694; train_chrom_access_recon_loss: 6102523.2328; train_global_loss: 44871725.4962; train_optim_loss: 44871725.4962; val_kl_reg_loss: 66835.0003; val_edge_recon_loss: 2790381.5000; val_gene_expr_recon_loss: 35704310.4000; val_masked_gp_l1_reg_loss: 127003.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81666.1250; val_chrom_access_recon_loss: 6130251.0667; val_global_loss: 44900449.6000; val_optim_loss: 44900449.6000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9718; val_auprc_score: 0.9657; val_best_acc_score: 0.9193; val_best_f1_score: 0.9221; train_kl_reg_loss: 129473.2335; train_edge_recon_loss: 2771262.9065; train_gene_expr_recon_loss: 35478912.9313; train_masked_gp_l1_reg_loss: 127522.9599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81130.2051; train_chrom_access_recon_loss: 6087768.8053; train_global_loss: 44676071.2061; train_optim_loss: 44676071.2061; val_kl_reg_loss: 73468.9453; val_edge_recon_loss: 2779576.4667; val_gene_expr_recon_loss: 35652760.8000; val_masked_gp_l1_reg_loss: 127885.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80401.8750; val_chrom_access_recon_loss: 6126376.4000; val_global_loss: 44840466.6667; val_optim_loss: 44840466.6667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9731; val_auprc_score: 0.9657; val_best_acc_score: 0.9220; val_best_f1_score: 0.9242; train_kl_reg_loss: 121151.5534; train_edge_recon_loss: 2761041.4294; train_gene_expr_recon_loss: 35414366.4885; train_masked_gp_l1_reg_loss: 128084.9841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79619.4059; train_chrom_access_recon_loss: 6083424.3893; train_global_loss: 44587688.1221; train_optim_loss: 44587688.1221; val_kl_reg_loss: 78600.5990; val_edge_recon_loss: 2740961.5000; val_gene_expr_recon_loss: 35679838.4000; val_masked_gp_l1_reg_loss: 128223.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78867.5078; val_chrom_access_recon_loss: 6128067.3333; val_global_loss: 44834559.4667; val_optim_loss: 44834559.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9756; val_auprc_score: 0.9681; val_best_acc_score: 0.9271; val_best_f1_score: 0.9289; train_kl_reg_loss: 119321.3874; train_edge_recon_loss: 2746922.8874; train_gene_expr_recon_loss: 35267018.8397; train_masked_gp_l1_reg_loss: 127846.5764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78549.0540; train_chrom_access_recon_loss: 6067319.0687; train_global_loss: 44406978.0153; train_optim_loss: 44406978.0153; val_kl_reg_loss: 78513.7396; val_edge_recon_loss: 2751208.9167; val_gene_expr_recon_loss: 35504305.0667; val_masked_gp_l1_reg_loss: 127720.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78281.5781; val_chrom_access_recon_loss: 6089443.6333; val_global_loss: 44629471.2000; val_optim_loss: 44629471.2000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9732; val_auprc_score: 0.9672; val_best_acc_score: 0.9247; val_best_f1_score: 0.9269; train_kl_reg_loss: 118378.9129; train_edge_recon_loss: 2745470.2366; train_gene_expr_recon_loss: 35290720.8244; train_masked_gp_l1_reg_loss: 127659.6363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78059.8646; train_chrom_access_recon_loss: 6067923.5305; train_global_loss: 44428213.0076; train_optim_loss: 44428213.0076; val_kl_reg_loss: 79819.5240; val_edge_recon_loss: 2753856.6167; val_gene_expr_recon_loss: 35790560.2667; val_masked_gp_l1_reg_loss: 127624.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77854.9219; val_chrom_access_recon_loss: 6153045.1333; val_global_loss: 44982761.8667; val_optim_loss: 44982761.8667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9761; val_auprc_score: 0.9693; val_best_acc_score: 0.9267; val_best_f1_score: 0.9288; train_kl_reg_loss: 117499.0938; train_edge_recon_loss: 2744511.9618; train_gene_expr_recon_loss: 35288349.8168; train_masked_gp_l1_reg_loss: 127587.8930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77659.8259; train_chrom_access_recon_loss: 6070897.5649; train_global_loss: 44426505.7405; train_optim_loss: 44426505.7405; val_kl_reg_loss: 79929.7786; val_edge_recon_loss: 2732323.3333; val_gene_expr_recon_loss: 35525458.9333; val_masked_gp_l1_reg_loss: 127538.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77457.9609; val_chrom_access_recon_loss: 6105422.0667; val_global_loss: 44648130.1333; val_optim_loss: 44648130.1333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9729; val_auprc_score: 0.9671; val_best_acc_score: 0.9210; val_best_f1_score: 0.9229; train_kl_reg_loss: 116626.9352; train_edge_recon_loss: 2744266.0763; train_gene_expr_recon_loss: 35288658.0305; train_masked_gp_l1_reg_loss: 127495.4395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77260.8815; train_chrom_access_recon_loss: 6074111.4618; train_global_loss: 44428419.1450; train_optim_loss: 44428419.1450; val_kl_reg_loss: 80904.7635; val_edge_recon_loss: 2761995.8667; val_gene_expr_recon_loss: 35397578.1333; val_masked_gp_l1_reg_loss: 127448.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77045.2031; val_chrom_access_recon_loss: 6096600.1333; val_global_loss: 44541570.1333; val_optim_loss: 44541570.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 33 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9739
val AUPRC score: 0.9686
val best accuracy score: 0.9227
val best F1 score: 0.9260
val target rna MSE score: 1.2527
val source rna MSE score: 24.3325
val target atac MSE score: 0.5881
val source atac MSE score: 4.7281
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
