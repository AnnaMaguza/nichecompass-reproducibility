[True]
Run timestamp: 07082023_183252_41.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_41']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8934; val_auprc_score: 0.9088; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 7784.9452; train_edge_recon_loss: 35590.7335; train_gene_expr_recon_loss: 1240059.0278; train_masked_gp_l1_reg_loss: 8430.1790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119405.8568; train_chrom_access_recon_loss: 978720.6354; train_global_loss: 2389991.3194; train_optim_loss: 2389991.3194; val_kl_reg_loss: 5547.0059; val_edge_recon_loss: 40658.9766; val_gene_expr_recon_loss: 1148268.2500; val_masked_gp_l1_reg_loss: 6659.1113; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117114.7344; val_chrom_access_recon_loss: 554817.5625; val_global_loss: 1873065.7500; val_optim_loss: 1873065.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8950; val_auprc_score: 0.9128; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6925.5218; train_edge_recon_loss: 36754.6128; train_gene_expr_recon_loss: 1055681.4375; train_masked_gp_l1_reg_loss: 6122.2122; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115723.0955; train_chrom_access_recon_loss: 531247.0486; train_global_loss: 1752453.9028; train_optim_loss: 1752453.9028; val_kl_reg_loss: 8609.8867; val_edge_recon_loss: 40661.0039; val_gene_expr_recon_loss: 945636.6250; val_masked_gp_l1_reg_loss: 5846.0640; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114031.6875; val_chrom_access_recon_loss: 493343.5625; val_global_loss: 1608128.7500; val_optim_loss: 1608128.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8986; val_auprc_score: 0.9136; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 11774.7972; train_edge_recon_loss: 37707.4653; train_gene_expr_recon_loss: 880741.7292; train_masked_gp_l1_reg_loss: 6112.4176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112685.4314; train_chrom_access_recon_loss: 487697.6354; train_global_loss: 1536719.5139; train_optim_loss: 1536719.5139; val_kl_reg_loss: 14922.1426; val_edge_recon_loss: 40661.2734; val_gene_expr_recon_loss: 829381.1250; val_masked_gp_l1_reg_loss: 6382.1675; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110966.7344; val_chrom_access_recon_loss: 473280.6250; val_global_loss: 1475594.1250; val_optim_loss: 1475594.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8916; val_auprc_score: 0.9084; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 16874.6857; train_edge_recon_loss: 38424.8602; train_gene_expr_recon_loss: 796577.9306; train_masked_gp_l1_reg_loss: 6425.4444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109504.6528; train_chrom_access_recon_loss: 470475.5208; train_global_loss: 1438283.0972; train_optim_loss: 1438283.0972; val_kl_reg_loss: 16762.3066; val_edge_recon_loss: 40660.3398; val_gene_expr_recon_loss: 777871.2500; val_masked_gp_l1_reg_loss: 6454.8096; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107603.3438; val_chrom_access_recon_loss: 455905.1250; val_global_loss: 1405257.1250; val_optim_loss: 1405257.1250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8803; val_auprc_score: 0.8973; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 17802.1417; train_edge_recon_loss: 38532.9549; train_gene_expr_recon_loss: 756948.9722; train_masked_gp_l1_reg_loss: 6486.5934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105971.6545; train_chrom_access_recon_loss: 455270.3924; train_global_loss: 1381012.7083; train_optim_loss: 1381012.7083; val_kl_reg_loss: 19026.1738; val_edge_recon_loss: 40659.6289; val_gene_expr_recon_loss: 744732.2500; val_masked_gp_l1_reg_loss: 6504.4004; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103870.7969; val_chrom_access_recon_loss: 447938.4375; val_global_loss: 1362731.7500; val_optim_loss: 1362731.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8742; val_auprc_score: 0.8865; val_best_acc_score: 0.5063; val_best_f1_score: 0.6695; train_kl_reg_loss: 19813.4957; train_edge_recon_loss: 38755.3194; train_gene_expr_recon_loss: 728320.7222; train_masked_gp_l1_reg_loss: 6489.4824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102100.5000; train_chrom_access_recon_loss: 448835.1667; train_global_loss: 1344314.6944; train_optim_loss: 1344314.6944; val_kl_reg_loss: 18756.3867; val_edge_recon_loss: 40656.1602; val_gene_expr_recon_loss: 725420.8750; val_masked_gp_l1_reg_loss: 6456.0459; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99839.6875; val_chrom_access_recon_loss: 443782.9062; val_global_loss: 1334912.1250; val_optim_loss: 1334912.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8718; val_auprc_score: 0.8788; val_best_acc_score: 0.5129; val_best_f1_score: 0.6722; train_kl_reg_loss: 19661.2925; train_edge_recon_loss: 38702.8329; train_gene_expr_recon_loss: 713585.6667; train_masked_gp_l1_reg_loss: 6452.7593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97981.6128; train_chrom_access_recon_loss: 448287.4097; train_global_loss: 1324671.5972; train_optim_loss: 1324671.5972; val_kl_reg_loss: 19509.7246; val_edge_recon_loss: 40649.4375; val_gene_expr_recon_loss: 709863.6875; val_masked_gp_l1_reg_loss: 6434.6396; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95637.8750; val_chrom_access_recon_loss: 440723.0625; val_global_loss: 1312818.5000; val_optim_loss: 1312818.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8718; val_auprc_score: 0.8724; val_best_acc_score: 0.5198; val_best_f1_score: 0.6745; train_kl_reg_loss: 20213.0393; train_edge_recon_loss: 38796.5473; train_gene_expr_recon_loss: 696151.0972; train_masked_gp_l1_reg_loss: 6416.5097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93741.8602; train_chrom_access_recon_loss: 442776.8229; train_global_loss: 1298095.8889; train_optim_loss: 1298095.8889; val_kl_reg_loss: 20156.7637; val_edge_recon_loss: 40637.3516; val_gene_expr_recon_loss: 697272.7500; val_masked_gp_l1_reg_loss: 6391.1108; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91369.3359; val_chrom_access_recon_loss: 438723.0625; val_global_loss: 1294550.3750; val_optim_loss: 1294550.3750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8570; val_auprc_score: 0.8551; val_best_acc_score: 0.5492; val_best_f1_score: 0.6859; train_kl_reg_loss: 20394.4221; train_edge_recon_loss: 38804.0951; train_gene_expr_recon_loss: 685370.2986; train_masked_gp_l1_reg_loss: 6374.2937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89472.4444; train_chrom_access_recon_loss: 441789.1458; train_global_loss: 1282204.7222; train_optim_loss: 1282204.7222; val_kl_reg_loss: 19461.1777; val_edge_recon_loss: 40615.8555; val_gene_expr_recon_loss: 688288.3750; val_masked_gp_l1_reg_loss: 6348.4126; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87107.7734; val_chrom_access_recon_loss: 437024.7500; val_global_loss: 1278846.2500; val_optim_loss: 1278846.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8414; val_auprc_score: 0.8433; val_best_acc_score: 0.5624; val_best_f1_score: 0.6913; train_kl_reg_loss: 20286.7936; train_edge_recon_loss: 38839.9857; train_gene_expr_recon_loss: 675223.3889; train_masked_gp_l1_reg_loss: 6336.0600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85241.2257; train_chrom_access_recon_loss: 438862.6840; train_global_loss: 1264790.1250; train_optim_loss: 1264790.1250; val_kl_reg_loss: 20590.2598; val_edge_recon_loss: 40604.6094; val_gene_expr_recon_loss: 680158.8125; val_masked_gp_l1_reg_loss: 6319.2485; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82928.1953; val_chrom_access_recon_loss: 435626.4062; val_global_loss: 1266227.5000; val_optim_loss: 1266227.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8318; val_auprc_score: 0.8323; val_best_acc_score: 0.6013; val_best_f1_score: 0.7090; train_kl_reg_loss: 20676.2852; train_edge_recon_loss: 38860.2474; train_gene_expr_recon_loss: 671462.2292; train_masked_gp_l1_reg_loss: 6308.3837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81114.0373; train_chrom_access_recon_loss: 438884.7396; train_global_loss: 1257305.9167; train_optim_loss: 1257305.9167; val_kl_reg_loss: 19628.5039; val_edge_recon_loss: 40579.7344; val_gene_expr_recon_loss: 675431.1875; val_masked_gp_l1_reg_loss: 6287.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78871.8906; val_chrom_access_recon_loss: 434198.0938; val_global_loss: 1254997.2500; val_optim_loss: 1254997.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8380; val_auprc_score: 0.8377; val_best_acc_score: 0.6222; val_best_f1_score: 0.7192; train_kl_reg_loss: 20508.3531; train_edge_recon_loss: 38867.7114; train_gene_expr_recon_loss: 665863.5694; train_masked_gp_l1_reg_loss: 6277.5771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77129.7960; train_chrom_access_recon_loss: 436496.0451; train_global_loss: 1245143.0694; train_optim_loss: 1245143.0694; val_kl_reg_loss: 20213.2695; val_edge_recon_loss: 40565.3555; val_gene_expr_recon_loss: 670391.0000; val_masked_gp_l1_reg_loss: 6257.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74977.4688; val_chrom_access_recon_loss: 433106.4062; val_global_loss: 1245510.8750; val_optim_loss: 1245510.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8390; val_auprc_score: 0.8319; val_best_acc_score: 0.6539; val_best_f1_score: 0.7360; train_kl_reg_loss: 20231.1415; train_edge_recon_loss: 38862.2643; train_gene_expr_recon_loss: 662009.9306; train_masked_gp_l1_reg_loss: 6250.8250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73308.7179; train_chrom_access_recon_loss: 436557.1424; train_global_loss: 1237220.0139; train_optim_loss: 1237220.0139; val_kl_reg_loss: 19690.1621; val_edge_recon_loss: 40547.1172; val_gene_expr_recon_loss: 667177.5000; val_masked_gp_l1_reg_loss: 6240.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71252.0391; val_chrom_access_recon_loss: 432143.0312; val_global_loss: 1237050.7500; val_optim_loss: 1237050.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8481; val_auprc_score: 0.8456; val_best_acc_score: 0.6809; val_best_f1_score: 0.7504; train_kl_reg_loss: 20133.6934; train_edge_recon_loss: 38831.6675; train_gene_expr_recon_loss: 663278.8958; train_masked_gp_l1_reg_loss: 6239.1954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69664.4045; train_chrom_access_recon_loss: 435958.1215; train_global_loss: 1234105.9861; train_optim_loss: 1234105.9861; val_kl_reg_loss: 18772.8789; val_edge_recon_loss: 40527.7500; val_gene_expr_recon_loss: 665014.6875; val_masked_gp_l1_reg_loss: 6228.1616; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67710.7188; val_chrom_access_recon_loss: 431306.9688; val_global_loss: 1229561.2500; val_optim_loss: 1229561.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8671; val_auprc_score: 0.8627; val_best_acc_score: 0.7183; val_best_f1_score: 0.7712; train_kl_reg_loss: 19492.2882; train_edge_recon_loss: 38801.8433; train_gene_expr_recon_loss: 657656.9792; train_masked_gp_l1_reg_loss: 6229.8974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66209.5681; train_chrom_access_recon_loss: 434341.6319; train_global_loss: 1222732.1806; train_optim_loss: 1222732.1806; val_kl_reg_loss: 18733.0195; val_edge_recon_loss: 40504.6367; val_gene_expr_recon_loss: 662025.7500; val_masked_gp_l1_reg_loss: 6227.6807; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64360.2344; val_chrom_access_recon_loss: 430464.0000; val_global_loss: 1222315.2500; val_optim_loss: 1222315.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8708; val_auprc_score: 0.8651; val_best_acc_score: 0.7458; val_best_f1_score: 0.7854; train_kl_reg_loss: 19306.0573; train_edge_recon_loss: 38761.9666; train_gene_expr_recon_loss: 653183.2431; train_masked_gp_l1_reg_loss: 6233.8267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62946.2261; train_chrom_access_recon_loss: 433938.1667; train_global_loss: 1214369.5000; train_optim_loss: 1214369.5000; val_kl_reg_loss: 17985.9824; val_edge_recon_loss: 40460.1797; val_gene_expr_recon_loss: 660395.0000; val_masked_gp_l1_reg_loss: 6231.0713; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61209.3945; val_chrom_access_recon_loss: 429757.6250; val_global_loss: 1216039.2500; val_optim_loss: 1216039.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8858; val_auprc_score: 0.8777; val_best_acc_score: 0.7819; val_best_f1_score: 0.8078; train_kl_reg_loss: 18898.1910; train_edge_recon_loss: 38716.0512; train_gene_expr_recon_loss: 654481.0764; train_masked_gp_l1_reg_loss: 6233.2528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59885.5308; train_chrom_access_recon_loss: 432755.2014; train_global_loss: 1210969.2778; train_optim_loss: 1210969.2778; val_kl_reg_loss: 18204.8203; val_edge_recon_loss: 40413.5742; val_gene_expr_recon_loss: 657555.8750; val_masked_gp_l1_reg_loss: 6230.8687; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58254.6445; val_chrom_access_recon_loss: 428844.8750; val_global_loss: 1209504.6250; val_optim_loss: 1209504.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9073; val_auprc_score: 0.9023; val_best_acc_score: 0.8242; val_best_f1_score: 0.8357; train_kl_reg_loss: 18731.6361; train_edge_recon_loss: 38669.9766; train_gene_expr_recon_loss: 650828.9028; train_masked_gp_l1_reg_loss: 6235.7851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57012.5399; train_chrom_access_recon_loss: 430867.1076; train_global_loss: 1202345.9722; train_optim_loss: 1202345.9722; val_kl_reg_loss: 18241.2656; val_edge_recon_loss: 40332.9570; val_gene_expr_recon_loss: 655421.1250; val_masked_gp_l1_reg_loss: 6239.0767; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55489.3398; val_chrom_access_recon_loss: 428003.4062; val_global_loss: 1203727.1250; val_optim_loss: 1203727.1250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9104; val_auprc_score: 0.9024; val_best_acc_score: 0.8306; val_best_f1_score: 0.8364; train_kl_reg_loss: 18415.8754; train_edge_recon_loss: 38593.9297; train_gene_expr_recon_loss: 645540.6667; train_masked_gp_l1_reg_loss: 6243.1436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54328.0282; train_chrom_access_recon_loss: 429466.2326; train_global_loss: 1192587.8889; train_optim_loss: 1192587.8889; val_kl_reg_loss: 17655.5664; val_edge_recon_loss: 40256.5859; val_gene_expr_recon_loss: 654014.5625; val_masked_gp_l1_reg_loss: 6243.9160; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52900.2383; val_chrom_access_recon_loss: 427522.5625; val_global_loss: 1198593.5000; val_optim_loss: 1198593.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9172; val_auprc_score: 0.9061; val_best_acc_score: 0.8480; val_best_f1_score: 0.8464; train_kl_reg_loss: 18236.2467; train_edge_recon_loss: 38538.5126; train_gene_expr_recon_loss: 646592.9792; train_masked_gp_l1_reg_loss: 6250.5188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51814.4826; train_chrom_access_recon_loss: 430708.1806; train_global_loss: 1192140.9306; train_optim_loss: 1192140.9306; val_kl_reg_loss: 17290.0039; val_edge_recon_loss: 40172.0508; val_gene_expr_recon_loss: 652547.6250; val_masked_gp_l1_reg_loss: 6255.9956; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50475.5273; val_chrom_access_recon_loss: 426733.0000; val_global_loss: 1193474.2500; val_optim_loss: 1193474.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9191; val_auprc_score: 0.9112; val_best_acc_score: 0.8410; val_best_f1_score: 0.8364; train_kl_reg_loss: 17888.8090; train_edge_recon_loss: 38485.9028; train_gene_expr_recon_loss: 643870.6389; train_masked_gp_l1_reg_loss: 6264.8621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49458.7352; train_chrom_access_recon_loss: 430179.6632; train_global_loss: 1186148.5972; train_optim_loss: 1186148.5972; val_kl_reg_loss: 17050.6602; val_edge_recon_loss: 40115.1406; val_gene_expr_recon_loss: 651209.1250; val_masked_gp_l1_reg_loss: 6263.3428; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48201.6328; val_chrom_access_recon_loss: 426173.6250; val_global_loss: 1189013.5000; val_optim_loss: 1189013.5000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9239; val_auprc_score: 0.9146; val_best_acc_score: 0.8411; val_best_f1_score: 0.8330; train_kl_reg_loss: 17708.1762; train_edge_recon_loss: 38407.8312; train_gene_expr_recon_loss: 645491.2917; train_masked_gp_l1_reg_loss: 6268.9694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47243.0339; train_chrom_access_recon_loss: 431570.3299; train_global_loss: 1186689.6111; train_optim_loss: 1186689.6111; val_kl_reg_loss: 16842.9570; val_edge_recon_loss: 40051.2734; val_gene_expr_recon_loss: 649940.7500; val_masked_gp_l1_reg_loss: 6271.9976; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46061.8164; val_chrom_access_recon_loss: 425684.0000; val_global_loss: 1184852.7500; val_optim_loss: 1184852.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9260; val_auprc_score: 0.9149; val_best_acc_score: 0.8372; val_best_f1_score: 0.8262; train_kl_reg_loss: 17480.1710; train_edge_recon_loss: 38351.5872; train_gene_expr_recon_loss: 639660.7917; train_masked_gp_l1_reg_loss: 6277.5773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45164.5859; train_chrom_access_recon_loss: 427336.3507; train_global_loss: 1174271.0694; train_optim_loss: 1174271.0694; val_kl_reg_loss: 16816.9434; val_edge_recon_loss: 39964.8945; val_gene_expr_recon_loss: 648417.7500; val_masked_gp_l1_reg_loss: 6277.0747; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44052.0312; val_chrom_access_recon_loss: 424975.9375; val_global_loss: 1180504.5000; val_optim_loss: 1180504.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9318; val_auprc_score: 0.9200; val_best_acc_score: 0.8328; val_best_f1_score: 0.8181; train_kl_reg_loss: 17329.6463; train_edge_recon_loss: 38284.1662; train_gene_expr_recon_loss: 645771.3750; train_masked_gp_l1_reg_loss: 6281.7130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43206.1076; train_chrom_access_recon_loss: 427062.1458; train_global_loss: 1177935.1389; train_optim_loss: 1177935.1389; val_kl_reg_loss: 16565.3301; val_edge_recon_loss: 39895.3594; val_gene_expr_recon_loss: 647388.2500; val_masked_gp_l1_reg_loss: 6284.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42159.7812; val_chrom_access_recon_loss: 424319.1875; val_global_loss: 1176612.0000; val_optim_loss: 1176612.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9337; val_auprc_score: 0.9232; val_best_acc_score: 0.8300; val_best_f1_score: 0.8239; train_kl_reg_loss: 17166.8129; train_edge_recon_loss: 38224.8750; train_gene_expr_recon_loss: 643594.3958; train_masked_gp_l1_reg_loss: 6294.1395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41368.6636; train_chrom_access_recon_loss: 428372.7257; train_global_loss: 1175021.5972; train_optim_loss: 1175021.5972; val_kl_reg_loss: 16669.8652; val_edge_recon_loss: 39821.8164; val_gene_expr_recon_loss: 646004.0000; val_masked_gp_l1_reg_loss: 6298.7676; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40387.7500; val_chrom_access_recon_loss: 423919.0000; val_global_loss: 1173101.2500; val_optim_loss: 1173101.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9319; val_auprc_score: 0.9248; val_best_acc_score: 0.8632; val_best_f1_score: 0.8687; train_kl_reg_loss: 14162.6480; train_edge_recon_loss: 39856.5872; train_gene_expr_recon_loss: 955450.3472; train_masked_gp_l1_reg_loss: 6427.0617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39526.7044; train_chrom_access_recon_loss: 452242.3438; train_global_loss: 1507665.6667; train_optim_loss: 1507665.6667; val_kl_reg_loss: 12609.5664; val_edge_recon_loss: 40294.8516; val_gene_expr_recon_loss: 949237.6250; val_masked_gp_l1_reg_loss: 6673.0908; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38393.4414; val_chrom_access_recon_loss: 447513.3438; val_global_loss: 1494721.8750; val_optim_loss: 1494721.8750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9230; val_auprc_score: 0.9096; val_best_acc_score: 0.8506; val_best_f1_score: 0.8582; train_kl_reg_loss: 13192.0649; train_edge_recon_loss: 39953.2391; train_gene_expr_recon_loss: 942699.1389; train_masked_gp_l1_reg_loss: 6887.4794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37470.4141; train_chrom_access_recon_loss: 453210.5660; train_global_loss: 1493412.8750; train_optim_loss: 1493412.8750; val_kl_reg_loss: 12266.6328; val_edge_recon_loss: 40314.0312; val_gene_expr_recon_loss: 941808.5625; val_masked_gp_l1_reg_loss: 7144.2002; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36333.3281; val_chrom_access_recon_loss: 446772.5938; val_global_loss: 1484639.3750; val_optim_loss: 1484639.3750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9342; val_auprc_score: 0.9251; val_best_acc_score: 0.8627; val_best_f1_score: 0.8670; train_kl_reg_loss: 13029.7178; train_edge_recon_loss: 39952.7457; train_gene_expr_recon_loss: 934727.3194; train_masked_gp_l1_reg_loss: 7302.3364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35463.7279; train_chrom_access_recon_loss: 450987.4444; train_global_loss: 1481463.2778; train_optim_loss: 1481463.2778; val_kl_reg_loss: 12110.2002; val_edge_recon_loss: 40267.5039; val_gene_expr_recon_loss: 936304.5625; val_masked_gp_l1_reg_loss: 7480.5176; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34403.0703; val_chrom_access_recon_loss: 446149.3750; val_global_loss: 1476715.2500; val_optim_loss: 1476715.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9330; val_auprc_score: 0.9245; val_best_acc_score: 0.8616; val_best_f1_score: 0.8623; train_kl_reg_loss: 12822.4514; train_edge_recon_loss: 39912.8416; train_gene_expr_recon_loss: 926431.2847; train_masked_gp_l1_reg_loss: 7583.1764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33597.1680; train_chrom_access_recon_loss: 447354.5625; train_global_loss: 1467701.4722; train_optim_loss: 1467701.4722; val_kl_reg_loss: 11889.0039; val_edge_recon_loss: 40193.2852; val_gene_expr_recon_loss: 931897.4375; val_masked_gp_l1_reg_loss: 7690.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32616.0840; val_chrom_access_recon_loss: 445638.4688; val_global_loss: 1469924.6250; val_optim_loss: 1469924.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9320; val_auprc_score: 0.9180; val_best_acc_score: 0.8623; val_best_f1_score: 0.8624; train_kl_reg_loss: 12839.0813; train_edge_recon_loss: 39883.9562; train_gene_expr_recon_loss: 929768.6528; train_masked_gp_l1_reg_loss: 7660.4715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32503.1111; train_chrom_access_recon_loss: 450462.2153; train_global_loss: 1473117.4861; train_optim_loss: 1473117.4861; val_kl_reg_loss: 11821.6016; val_edge_recon_loss: 40189.7148; val_gene_expr_recon_loss: 931495.6250; val_masked_gp_l1_reg_loss: 7636.0278; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32366.8164; val_chrom_access_recon_loss: 445502.2500; val_global_loss: 1469012.0000; val_optim_loss: 1469012.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9343; val_auprc_score: 0.9232; val_best_acc_score: 0.8622; val_best_f1_score: 0.8623; train_kl_reg_loss: 12817.5216; train_edge_recon_loss: 39879.9041; train_gene_expr_recon_loss: 924875.5000; train_masked_gp_l1_reg_loss: 7632.9353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32272.4164; train_chrom_access_recon_loss: 448324.9062; train_global_loss: 1465803.1944; train_optim_loss: 1465803.1944; val_kl_reg_loss: 11952.0703; val_edge_recon_loss: 40178.9648; val_gene_expr_recon_loss: 930964.5000; val_masked_gp_l1_reg_loss: 7625.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32153.7070; val_chrom_access_recon_loss: 445414.4375; val_global_loss: 1468289.2500; val_optim_loss: 1468289.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9316; val_auprc_score: 0.9207; val_best_acc_score: 0.8614; val_best_f1_score: 0.8614; train_kl_reg_loss: 12979.1757; train_edge_recon_loss: 39883.6484; train_gene_expr_recon_loss: 926814.9028; train_masked_gp_l1_reg_loss: 7622.6766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32064.1968; train_chrom_access_recon_loss: 449887.5035; train_global_loss: 1469252.0833; train_optim_loss: 1469252.0833; val_kl_reg_loss: 11980.3809; val_edge_recon_loss: 40189.7461; val_gene_expr_recon_loss: 930639.6875; val_masked_gp_l1_reg_loss: 7619.2080; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31953.9414; val_chrom_access_recon_loss: 445388.1250; val_global_loss: 1467771.0000; val_optim_loss: 1467771.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9306; val_auprc_score: 0.9194; val_best_acc_score: 0.8581; val_best_f1_score: 0.8584; train_kl_reg_loss: 12877.8557; train_edge_recon_loss: 39876.9527; train_gene_expr_recon_loss: 925042.8125; train_masked_gp_l1_reg_loss: 7617.6376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31868.2391; train_chrom_access_recon_loss: 448626.9375; train_global_loss: 1465910.4306; train_optim_loss: 1465910.4306; val_kl_reg_loss: 11908.0391; val_edge_recon_loss: 40174.0430; val_gene_expr_recon_loss: 930362.1875; val_masked_gp_l1_reg_loss: 7616.6792; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31764.1641; val_chrom_access_recon_loss: 445359.6250; val_global_loss: 1467184.7500; val_optim_loss: 1467184.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 32 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9293
val AUPRC score: 0.9199
val best accuracy score: 0.8618
val best F1 score: 0.8666
val target rna MSE score: 3.7464
val source rna MSE score: 3.1556
val target atac MSE score: 0.1316
val source atac MSE score: 0.0194
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
