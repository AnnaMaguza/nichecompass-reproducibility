[True]
Run timestamp: 29072023_105521_41.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_41']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb, include_chrom_access_recon_loss: True, atac_pred_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2108, n_latent: 2098, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 2694
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2098, n_cat_covariates_embed_input: 0, n_addon_gp_input: 10, n_output: 12366

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8760; val_auprc_score: 0.9012; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 2446.3509; train_edge_recon_loss: 350481.6736; train_gene_expr_recon_loss: 76300873.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1916685.4167; train_global_loss: 78570487.1111; train_optim_loss: 78570487.1111; val_kl_reg_loss: 5402.1406; val_edge_recon_loss: 406592.9375; val_gene_expr_recon_loss: 67104416.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1768926.8750; val_global_loss: 69285336.0000; val_optim_loss: 69285336.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8958; val_auprc_score: 0.9079; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 26387.3925; train_edge_recon_loss: 369176.9340; train_gene_expr_recon_loss: 63280256.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1828269.9028; train_global_loss: 65504089.7778; train_optim_loss: 65504089.7778; val_kl_reg_loss: 49182.8008; val_edge_recon_loss: 406626.1250; val_gene_expr_recon_loss: 62145928.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1908514.7500; val_global_loss: 64510252.0000; val_optim_loss: 64510252.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9014; val_auprc_score: 0.9117; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 43741.2439; train_edge_recon_loss: 391999.8021; train_gene_expr_recon_loss: 59026981.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1780963.6667; train_global_loss: 61243686.6667; train_optim_loss: 61243686.6667; val_kl_reg_loss: 53801.6641; val_edge_recon_loss: 406624.5938; val_gene_expr_recon_loss: 57801860.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1756425.7500; val_global_loss: 60018712.0000; val_optim_loss: 60018712.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8921; val_auprc_score: 0.8995; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 82128.0842; train_edge_recon_loss: 395982.1701; train_gene_expr_recon_loss: 55732257.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1747006.8056; train_global_loss: 57957374.6667; train_optim_loss: 57957374.6667; val_kl_reg_loss: 94413.0469; val_edge_recon_loss: 406623.8750; val_gene_expr_recon_loss: 54505732.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1763297.5000; val_global_loss: 56770064.0000; val_optim_loss: 56770064.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8845; val_auprc_score: 0.8928; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 99776.8568; train_edge_recon_loss: 400212.7118; train_gene_expr_recon_loss: 52761679.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1727885.6111; train_global_loss: 54989555.5556; train_optim_loss: 54989555.5556; val_kl_reg_loss: 114870.4219; val_edge_recon_loss: 406620.8125; val_gene_expr_recon_loss: 51960880.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1753329.7500; val_global_loss: 54235700.0000; val_optim_loss: 54235700.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8821; val_auprc_score: 0.8897; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 121643.2726; train_edge_recon_loss: 401183.9444; train_gene_expr_recon_loss: 50648490.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1711452.7639; train_global_loss: 52882769.3333; train_optim_loss: 52882769.3333; val_kl_reg_loss: 121231.0078; val_edge_recon_loss: 406615.8125; val_gene_expr_recon_loss: 49761816.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1714040.2500; val_global_loss: 52003704.0000; val_optim_loss: 52003704.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8819; val_auprc_score: 0.8870; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 132142.5104; train_edge_recon_loss: 403688.7639; train_gene_expr_recon_loss: 48001092.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1683326.4306; train_global_loss: 50220249.7778; train_optim_loss: 50220249.7778; val_kl_reg_loss: 134532.7188; val_edge_recon_loss: 406611.9375; val_gene_expr_recon_loss: 47544184.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1694572.7500; val_global_loss: 49779900.0000; val_optim_loss: 49779900.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8816; val_auprc_score: 0.8868; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 138736.0243; train_edge_recon_loss: 404470.0382; train_gene_expr_recon_loss: 46370045.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1675638.5833; train_global_loss: 48588889.3333; train_optim_loss: 48588889.3333; val_kl_reg_loss: 129529.1172; val_edge_recon_loss: 406604.7188; val_gene_expr_recon_loss: 45720752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1667981.2500; val_global_loss: 47924864.0000; val_optim_loss: 47924864.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8771; val_auprc_score: 0.8827; val_best_acc_score: 0.5004; val_best_f1_score: 0.6668; train_kl_reg_loss: 135397.8333; train_edge_recon_loss: 404593.4688; train_gene_expr_recon_loss: 44665972.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1652192.8194; train_global_loss: 46858155.5556; train_optim_loss: 46858155.5556; val_kl_reg_loss: 128869.8125; val_edge_recon_loss: 406596.0000; val_gene_expr_recon_loss: 44129848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1648261.5000; val_global_loss: 46313572.0000; val_optim_loss: 46313572.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8761; val_auprc_score: 0.8809; val_best_acc_score: 0.5019; val_best_f1_score: 0.6675; train_kl_reg_loss: 132389.4054; train_edge_recon_loss: 404562.0069; train_gene_expr_recon_loss: 43388197.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1627032.9722; train_global_loss: 45552181.7778; train_optim_loss: 45552181.7778; val_kl_reg_loss: 129057.3203; val_edge_recon_loss: 406585.6250; val_gene_expr_recon_loss: 42822032.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1629211.7500; val_global_loss: 44986888.0000; val_optim_loss: 44986888.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8687; val_auprc_score: 0.8703; val_best_acc_score: 0.5031; val_best_f1_score: 0.6680; train_kl_reg_loss: 127334.7847; train_edge_recon_loss: 404421.1250; train_gene_expr_recon_loss: 42129521.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1605507.3472; train_global_loss: 44266784.0000; train_optim_loss: 44266784.0000; val_kl_reg_loss: 122198.7344; val_edge_recon_loss: 406574.8125; val_gene_expr_recon_loss: 41825912.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1612645.5000; val_global_loss: 43967328.0000; val_optim_loss: 43967328.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8679; val_auprc_score: 0.8681; val_best_acc_score: 0.5044; val_best_f1_score: 0.6685; train_kl_reg_loss: 122377.2344; train_edge_recon_loss: 404263.1111; train_gene_expr_recon_loss: 41257888.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1590798.5278; train_global_loss: 43375326.2222; train_optim_loss: 43375326.2222; val_kl_reg_loss: 118472.1094; val_edge_recon_loss: 406560.5000; val_gene_expr_recon_loss: 41080172.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1600748.2500; val_global_loss: 43205952.0000; val_optim_loss: 43205952.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8686; val_auprc_score: 0.8719; val_best_acc_score: 0.5084; val_best_f1_score: 0.6703; train_kl_reg_loss: 119043.2257; train_edge_recon_loss: 404035.0868; train_gene_expr_recon_loss: 40605993.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1588694.8750; train_global_loss: 42717767.5556; train_optim_loss: 42717767.5556; val_kl_reg_loss: 111798.6172; val_edge_recon_loss: 406535.8125; val_gene_expr_recon_loss: 40468880.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1583477.2500; val_global_loss: 42570692.0000; val_optim_loss: 42570692.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8636; val_auprc_score: 0.8649; val_best_acc_score: 0.5110; val_best_f1_score: 0.6715; train_kl_reg_loss: 115864.4774; train_edge_recon_loss: 403661.6667; train_gene_expr_recon_loss: 40007857.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1564089.3611; train_global_loss: 42091472.4444; train_optim_loss: 42091472.4444; val_kl_reg_loss: 107509.2344; val_edge_recon_loss: 406509.1562; val_gene_expr_recon_loss: 40066536.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1576426.7500; val_global_loss: 42156984.0000; val_optim_loss: 42156984.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8681; val_auprc_score: 0.8719; val_best_acc_score: 0.5159; val_best_f1_score: 0.6737; train_kl_reg_loss: 113210.5139; train_edge_recon_loss: 403534.2014; train_gene_expr_recon_loss: 39488670.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1557795.3194; train_global_loss: 41563209.7778; train_optim_loss: 41563209.7778; val_kl_reg_loss: 103073.8281; val_edge_recon_loss: 406474.5938; val_gene_expr_recon_loss: 39779116.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1568375.2500; val_global_loss: 41857040.0000; val_optim_loss: 41857040.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8672; val_auprc_score: 0.8658; val_best_acc_score: 0.5194; val_best_f1_score: 0.6752; train_kl_reg_loss: 109795.0833; train_edge_recon_loss: 403420.3160; train_gene_expr_recon_loss: 39457974.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1554365.4167; train_global_loss: 41525554.2222; train_optim_loss: 41525554.2222; val_kl_reg_loss: 99745.0781; val_edge_recon_loss: 406430.6562; val_gene_expr_recon_loss: 39599772.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1567319.7500; val_global_loss: 41673268.0000; val_optim_loss: 41673268.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8686; val_auprc_score: 0.8684; val_best_acc_score: 0.5221; val_best_f1_score: 0.6764; train_kl_reg_loss: 108429.1302; train_edge_recon_loss: 403030.2708; train_gene_expr_recon_loss: 39224418.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1551918.9861; train_global_loss: 41287796.8889; train_optim_loss: 41287796.8889; val_kl_reg_loss: 96521.7500; val_edge_recon_loss: 406393.6875; val_gene_expr_recon_loss: 39418616.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1560735.7500; val_global_loss: 41482268.0000; val_optim_loss: 41482268.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8624; val_auprc_score: 0.8566; val_best_acc_score: 0.5314; val_best_f1_score: 0.6806; train_kl_reg_loss: 106031.1432; train_edge_recon_loss: 402746.0312; train_gene_expr_recon_loss: 39088563.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1546584.5972; train_global_loss: 41143924.8889; train_optim_loss: 41143924.8889; val_kl_reg_loss: 95507.5312; val_edge_recon_loss: 406350.0938; val_gene_expr_recon_loss: 39312664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1558222.0000; val_global_loss: 41372744.0000; val_optim_loss: 41372744.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8680; val_auprc_score: 0.8666; val_best_acc_score: 0.5431; val_best_f1_score: 0.6859; train_kl_reg_loss: 104663.6415; train_edge_recon_loss: 402371.0764; train_gene_expr_recon_loss: 39085144.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1538147.9444; train_global_loss: 41130327.5556; train_optim_loss: 41130327.5556; val_kl_reg_loss: 92658.1094; val_edge_recon_loss: 406284.6875; val_gene_expr_recon_loss: 39187504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1554136.0000; val_global_loss: 41240584.0000; val_optim_loss: 41240584.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8676; val_auprc_score: 0.8643; val_best_acc_score: 0.5516; val_best_f1_score: 0.6898; train_kl_reg_loss: 102044.8880; train_edge_recon_loss: 401848.6076; train_gene_expr_recon_loss: 38871356.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1536961.0278; train_global_loss: 40912210.2222; train_optim_loss: 40912210.2222; val_kl_reg_loss: 92673.3672; val_edge_recon_loss: 406227.0938; val_gene_expr_recon_loss: 39033952.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1551774.5000; val_global_loss: 41084628.0000; val_optim_loss: 41084628.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8659; val_auprc_score: 0.8591; val_best_acc_score: 0.5707; val_best_f1_score: 0.6988; train_kl_reg_loss: 100053.6866; train_edge_recon_loss: 401605.2778; train_gene_expr_recon_loss: 38796555.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1538615.1806; train_global_loss: 40836828.8889; train_optim_loss: 40836828.8889; val_kl_reg_loss: 91668.9297; val_edge_recon_loss: 406156.3125; val_gene_expr_recon_loss: 38945404.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1550833.5000; val_global_loss: 40994060.0000; val_optim_loss: 40994060.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8714; val_auprc_score: 0.8680; val_best_acc_score: 0.5939; val_best_f1_score: 0.7097; train_kl_reg_loss: 99000.3420; train_edge_recon_loss: 400779.3785; train_gene_expr_recon_loss: 38632472.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1533670.8333; train_global_loss: 40665923.5556; train_optim_loss: 40665923.5556; val_kl_reg_loss: 87725.6406; val_edge_recon_loss: 406039.7188; val_gene_expr_recon_loss: 38867792.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1548897.2500; val_global_loss: 40910452.0000; val_optim_loss: 40910452.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8687; val_auprc_score: 0.8623; val_best_acc_score: 0.6082; val_best_f1_score: 0.7166; train_kl_reg_loss: 97292.1076; train_edge_recon_loss: 399952.1319; train_gene_expr_recon_loss: 38603292.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1533498.8750; train_global_loss: 40634035.5556; train_optim_loss: 40634035.5556; val_kl_reg_loss: 84010.8828; val_edge_recon_loss: 405965.0625; val_gene_expr_recon_loss: 38837960.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1545851.6250; val_global_loss: 40873788.0000; val_optim_loss: 40873788.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8706; val_auprc_score: 0.8656; val_best_acc_score: 0.6269; val_best_f1_score: 0.7261; train_kl_reg_loss: 94264.3594; train_edge_recon_loss: 399506.6910; train_gene_expr_recon_loss: 38558326.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1526383.5556; train_global_loss: 40578482.2222; train_optim_loss: 40578482.2222; val_kl_reg_loss: 83590.3047; val_edge_recon_loss: 405818.6562; val_gene_expr_recon_loss: 38751264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1546438.5000; val_global_loss: 40787112.0000; val_optim_loss: 40787112.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8767; val_auprc_score: 0.8729; val_best_acc_score: 0.6463; val_best_f1_score: 0.7358; train_kl_reg_loss: 93650.5877; train_edge_recon_loss: 398774.3889; train_gene_expr_recon_loss: 38467939.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1525814.0000; train_global_loss: 40486177.3333; train_optim_loss: 40486177.3333; val_kl_reg_loss: 79491.4062; val_edge_recon_loss: 405681.4062; val_gene_expr_recon_loss: 38765560.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1544678.1250; val_global_loss: 40795412.0000; val_optim_loss: 40795412.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8722; val_auprc_score: 0.8598; val_best_acc_score: 0.6525; val_best_f1_score: 0.7392; train_kl_reg_loss: 95079.7040; train_edge_recon_loss: 400237.9271; train_gene_expr_recon_loss: 38967716.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1540065.3194; train_global_loss: 41003099.1111; train_optim_loss: 41003099.1111; val_kl_reg_loss: 76507.5156; val_edge_recon_loss: 405597.5625; val_gene_expr_recon_loss: 39005412.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1549041.0000; val_global_loss: 41036556.0000; val_optim_loss: 41036556.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8734; val_auprc_score: 0.8661; val_best_acc_score: 0.6687; val_best_f1_score: 0.7474; train_kl_reg_loss: 94320.8507; train_edge_recon_loss: 398356.3646; train_gene_expr_recon_loss: 38737014.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1526604.5417; train_global_loss: 40756296.4444; train_optim_loss: 40756296.4444; val_kl_reg_loss: 72042.6016; val_edge_recon_loss: 405400.0625; val_gene_expr_recon_loss: 39077656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1547346.0000; val_global_loss: 41102448.0000; val_optim_loss: 41102448.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8697; val_auprc_score: 0.8626; val_best_acc_score: 0.6746; val_best_f1_score: 0.7497; train_kl_reg_loss: 91751.4158; train_edge_recon_loss: 398061.5868; train_gene_expr_recon_loss: 38452075.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1522846.4861; train_global_loss: 40464734.6667; train_optim_loss: 40464734.6667; val_kl_reg_loss: 70701.8125; val_edge_recon_loss: 405289.6250; val_gene_expr_recon_loss: 39003484.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1549055.0000; val_global_loss: 41028532.0000; val_optim_loss: 41028532.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8699; val_auprc_score: 0.8610; val_best_acc_score: 0.6748; val_best_f1_score: 0.7502; train_kl_reg_loss: 83682.7092; train_edge_recon_loss: 399589.9271; train_gene_expr_recon_loss: 38638512.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1524850.9306; train_global_loss: 40646636.0000; train_optim_loss: 40646636.0000; val_kl_reg_loss: 80043.6797; val_edge_recon_loss: 405350.5000; val_gene_expr_recon_loss: 38869852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1547103.7500; val_global_loss: 40902352.0000; val_optim_loss: 40902352.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8650; val_auprc_score: 0.8574; val_best_acc_score: 0.6605; val_best_f1_score: 0.7421; train_kl_reg_loss: 94091.5408; train_edge_recon_loss: 396858.9861; train_gene_expr_recon_loss: 38607006.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1536358.1528; train_global_loss: 40634315.5556; train_optim_loss: 40634315.5556; val_kl_reg_loss: 83011.8359; val_edge_recon_loss: 405408.0312; val_gene_expr_recon_loss: 38806832.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1544369.2500; val_global_loss: 40839620.0000; val_optim_loss: 40839620.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8660; val_auprc_score: 0.8567; val_best_acc_score: 0.6765; val_best_f1_score: 0.7510; train_kl_reg_loss: 91103.3672; train_edge_recon_loss: 396740.4514; train_gene_expr_recon_loss: 38531367.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1531951.4444; train_global_loss: 40551162.2222; train_optim_loss: 40551162.2222; val_kl_reg_loss: 78051.4844; val_edge_recon_loss: 405301.9375; val_gene_expr_recon_loss: 38767136.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1543822.2500; val_global_loss: 40794312.0000; val_optim_loss: 40794312.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8759; val_auprc_score: 0.8678; val_best_acc_score: 0.6816; val_best_f1_score: 0.7539; train_kl_reg_loss: 89731.2865; train_edge_recon_loss: 396195.0347; train_gene_expr_recon_loss: 38636463.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 1536505.5139; train_global_loss: 40658894.6667; train_optim_loss: 40658894.6667; val_kl_reg_loss: 81430.2031; val_edge_recon_loss: 405275.5625; val_gene_expr_recon_loss: 38797752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 1544723.1250; val_global_loss: 40829180.0000; val_optim_loss: 40829180.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 32 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.8664
val AUPRC score: 0.8563
val best accuracy score: 0.6253
val best F1 score: 0.7256
val target rna MSE score: 2.4454
val source rna MSE score: 1.5074
val target atac MSE score: 0.1244
val source atac MSE score: 0.0184
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
