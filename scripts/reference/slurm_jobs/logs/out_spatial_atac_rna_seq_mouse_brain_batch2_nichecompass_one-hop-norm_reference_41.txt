[True]
Run timestamp: 26072023_014826_41.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_41']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8978; val_auprc_score: 0.9086; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6560.8712; train_edge_recon_loss: 351550.0660; train_gene_expr_recon_loss: 31941414.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1091143.5972; train_global_loss: 33390668.4444; train_optim_loss: 33390668.4444; val_kl_reg_loss: 13448.0625; val_edge_recon_loss: 406600.6250; val_gene_expr_recon_loss: 30293908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1071722.1250; val_global_loss: 31785678.0000; val_optim_loss: 31785678.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8862; val_auprc_score: 0.8962; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 30799.3061; train_edge_recon_loss: 369566.0451; train_gene_expr_recon_loss: 28889862.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1068665.9444; train_global_loss: 30358893.5556; train_optim_loss: 30358893.5556; val_kl_reg_loss: 44968.6719; val_edge_recon_loss: 406608.1562; val_gene_expr_recon_loss: 27425230.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1046680.1250; val_global_loss: 28923486.0000; val_optim_loss: 28923486.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8779; val_auprc_score: 0.8817; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 55005.2313; train_edge_recon_loss: 388344.6875; train_gene_expr_recon_loss: 26422211.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1042375.0833; train_global_loss: 27907936.6667; train_optim_loss: 27907936.6667; val_kl_reg_loss: 69156.9844; val_edge_recon_loss: 406604.6250; val_gene_expr_recon_loss: 25277218.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1026705.6875; val_global_loss: 26779686.0000; val_optim_loss: 26779686.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8646; val_auprc_score: 0.8671; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 91656.7708; train_edge_recon_loss: 397071.9028; train_gene_expr_recon_loss: 24489133.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1020191.4236; train_global_loss: 25998053.7778; train_optim_loss: 25998053.7778; val_kl_reg_loss: 108834.9062; val_edge_recon_loss: 406603.5312; val_gene_expr_recon_loss: 23834684.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1010818.3125; val_global_loss: 25360940.0000; val_optim_loss: 25360940.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8544; val_auprc_score: 0.8592; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 116276.1172; train_edge_recon_loss: 402798.1806; train_gene_expr_recon_loss: 23114889.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 999536.4931; train_global_loss: 24633500.0000; train_optim_loss: 24633500.0000; val_kl_reg_loss: 124495.1875; val_edge_recon_loss: 406594.0625; val_gene_expr_recon_loss: 22976356.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 997914.6875; val_global_loss: 24505360.0000; val_optim_loss: 24505360.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8578; val_auprc_score: 0.8528; val_best_acc_score: 0.5038; val_best_f1_score: 0.6683; train_kl_reg_loss: 130000.2882; train_edge_recon_loss: 404204.4896; train_gene_expr_recon_loss: 22533256.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 991450.8125; train_global_loss: 24058912.6667; train_optim_loss: 24058912.6667; val_kl_reg_loss: 125135.0625; val_edge_recon_loss: 406564.5625; val_gene_expr_recon_loss: 22319920.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 990823.6875; val_global_loss: 23842444.0000; val_optim_loss: 23842444.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8652; val_auprc_score: 0.8594; val_best_acc_score: 0.5089; val_best_f1_score: 0.6706; train_kl_reg_loss: 132683.0087; train_edge_recon_loss: 404621.5382; train_gene_expr_recon_loss: 21972192.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 987837.4861; train_global_loss: 23497334.4444; train_optim_loss: 23497334.4444; val_kl_reg_loss: 139166.5938; val_edge_recon_loss: 406532.2188; val_gene_expr_recon_loss: 21888170.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 985818.3125; val_global_loss: 23419686.0000; val_optim_loss: 23419686.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8654; val_auprc_score: 0.8551; val_best_acc_score: 0.5124; val_best_f1_score: 0.6722; train_kl_reg_loss: 143267.6319; train_edge_recon_loss: 404896.1215; train_gene_expr_recon_loss: 21629094.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 982614.4722; train_global_loss: 23159873.3333; train_optim_loss: 23159873.3333; val_kl_reg_loss: 138547.3750; val_edge_recon_loss: 406486.9062; val_gene_expr_recon_loss: 21579576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 982256.3125; val_global_loss: 23106866.0000; val_optim_loss: 23106866.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8674; val_auprc_score: 0.8515; val_best_acc_score: 0.5229; val_best_f1_score: 0.6764; train_kl_reg_loss: 140188.5660; train_edge_recon_loss: 404882.4062; train_gene_expr_recon_loss: 21387429.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 980768.4861; train_global_loss: 22913269.3333; train_optim_loss: 22913269.3333; val_kl_reg_loss: 131461.0000; val_edge_recon_loss: 406370.2188; val_gene_expr_recon_loss: 21396970.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 979613.0625; val_global_loss: 22914416.0000; val_optim_loss: 22914416.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8774; val_auprc_score: 0.8607; val_best_acc_score: 0.5515; val_best_f1_score: 0.6891; train_kl_reg_loss: 133198.7908; train_edge_recon_loss: 404497.8125; train_gene_expr_recon_loss: 21212681.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973650.5764; train_global_loss: 22724028.6667; train_optim_loss: 22724028.6667; val_kl_reg_loss: 129302.1719; val_edge_recon_loss: 406207.5312; val_gene_expr_recon_loss: 21292638.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 978060.0625; val_global_loss: 22806208.0000; val_optim_loss: 22806208.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8745; val_auprc_score: 0.8647; val_best_acc_score: 0.5951; val_best_f1_score: 0.7097; train_kl_reg_loss: 127956.1354; train_edge_recon_loss: 404256.1250; train_gene_expr_recon_loss: 21144186.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978812.1944; train_global_loss: 22655211.1111; train_optim_loss: 22655211.1111; val_kl_reg_loss: 124824.6250; val_edge_recon_loss: 405960.6562; val_gene_expr_recon_loss: 21198502.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 977549.8750; val_global_loss: 22706838.0000; val_optim_loss: 22706838.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8816; val_auprc_score: 0.8626; val_best_acc_score: 0.6548; val_best_f1_score: 0.7397; train_kl_reg_loss: 124458.7283; train_edge_recon_loss: 403685.4028; train_gene_expr_recon_loss: 21124377.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 978009.2986; train_global_loss: 22630530.4444; train_optim_loss: 22630530.4444; val_kl_reg_loss: 119611.4688; val_edge_recon_loss: 405514.3438; val_gene_expr_recon_loss: 21111430.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 974752.0000; val_global_loss: 22611308.0000; val_optim_loss: 22611308.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8850; val_auprc_score: 0.8769; val_best_acc_score: 0.6862; val_best_f1_score: 0.7560; train_kl_reg_loss: 121277.1467; train_edge_recon_loss: 403077.2708; train_gene_expr_recon_loss: 20858782.2222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 972695.6875; train_global_loss: 22355832.2222; train_optim_loss: 22355832.2222; val_kl_reg_loss: 116973.0938; val_edge_recon_loss: 405070.8438; val_gene_expr_recon_loss: 21073948.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 975233.5625; val_global_loss: 22571226.0000; val_optim_loss: 22571226.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8889; val_auprc_score: 0.8793; val_best_acc_score: 0.7348; val_best_f1_score: 0.7835; train_kl_reg_loss: 118779.0312; train_edge_recon_loss: 402403.7917; train_gene_expr_recon_loss: 20882718.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 976887.1389; train_global_loss: 22380788.2222; train_optim_loss: 22380788.2222; val_kl_reg_loss: 112837.2422; val_edge_recon_loss: 404504.4375; val_gene_expr_recon_loss: 21005702.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971939.1250; val_global_loss: 22494984.0000; val_optim_loss: 22494984.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8922; val_auprc_score: 0.8802; val_best_acc_score: 0.7559; val_best_f1_score: 0.7948; train_kl_reg_loss: 115237.9227; train_edge_recon_loss: 401732.0868; train_gene_expr_recon_loss: 20949223.1111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 973985.6111; train_global_loss: 22440178.6667; train_optim_loss: 22440178.6667; val_kl_reg_loss: 112010.5781; val_edge_recon_loss: 403929.1875; val_gene_expr_recon_loss: 20947154.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 971275.1875; val_global_loss: 22434370.0000; val_optim_loss: 22434370.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9027; val_auprc_score: 0.8919; val_best_acc_score: 0.7924; val_best_f1_score: 0.8180; train_kl_reg_loss: 113822.7326; train_edge_recon_loss: 401005.5799; train_gene_expr_recon_loss: 20784516.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 969143.9514; train_global_loss: 22268488.4444; train_optim_loss: 22268488.4444; val_kl_reg_loss: 108360.5078; val_edge_recon_loss: 403166.4375; val_gene_expr_recon_loss: 20908956.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 969713.0625; val_global_loss: 22390196.0000; val_optim_loss: 22390196.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9104; val_auprc_score: 0.8981; val_best_acc_score: 0.8180; val_best_f1_score: 0.8354; train_kl_reg_loss: 112020.5095; train_edge_recon_loss: 400251.3542; train_gene_expr_recon_loss: 20826772.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 971280.7500; train_global_loss: 22310325.5556; train_optim_loss: 22310325.5556; val_kl_reg_loss: 106437.3906; val_edge_recon_loss: 402826.3750; val_gene_expr_recon_loss: 20880896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 970298.3125; val_global_loss: 22360458.0000; val_optim_loss: 22360458.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9154; val_auprc_score: 0.9024; val_best_acc_score: 0.8387; val_best_f1_score: 0.8499; train_kl_reg_loss: 109382.1450; train_edge_recon_loss: 399583.1111; train_gene_expr_recon_loss: 20622877.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 967587.6042; train_global_loss: 22099430.6667; train_optim_loss: 22099430.6667; val_kl_reg_loss: 105514.8750; val_edge_recon_loss: 402142.7812; val_gene_expr_recon_loss: 20860998.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968649.8750; val_global_loss: 22337306.0000; val_optim_loss: 22337306.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9180; val_auprc_score: 0.9091; val_best_acc_score: 0.8460; val_best_f1_score: 0.8534; train_kl_reg_loss: 107525.5269; train_edge_recon_loss: 398844.3819; train_gene_expr_recon_loss: 20682351.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 965197.2292; train_global_loss: 22153918.8889; train_optim_loss: 22153918.8889; val_kl_reg_loss: 101388.0156; val_edge_recon_loss: 401382.8438; val_gene_expr_recon_loss: 20827100.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 968451.8125; val_global_loss: 22298322.0000; val_optim_loss: 22298322.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9136; val_auprc_score: 0.8983; val_best_acc_score: 0.8453; val_best_f1_score: 0.8518; train_kl_reg_loss: 105861.1319; train_edge_recon_loss: 397668.3125; train_gene_expr_recon_loss: 20513042.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 961537.4167; train_global_loss: 21978109.1111; train_optim_loss: 21978109.1111; val_kl_reg_loss: 101348.6719; val_edge_recon_loss: 400876.4062; val_gene_expr_recon_loss: 20780168.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 967397.5625; val_global_loss: 22249792.0000; val_optim_loss: 22249792.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9213; val_auprc_score: 0.9096; val_best_acc_score: 0.8515; val_best_f1_score: 0.8545; train_kl_reg_loss: 103993.8707; train_edge_recon_loss: 396772.5694; train_gene_expr_recon_loss: 20614857.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 966968.5208; train_global_loss: 22082592.2222; train_optim_loss: 22082592.2222; val_kl_reg_loss: 98890.8125; val_edge_recon_loss: 399969.5625; val_gene_expr_recon_loss: 20755094.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 966144.0625; val_global_loss: 22220098.0000; val_optim_loss: 22220098.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9207; val_auprc_score: 0.9077; val_best_acc_score: 0.8480; val_best_f1_score: 0.8494; train_kl_reg_loss: 102192.3689; train_edge_recon_loss: 396009.0521; train_gene_expr_recon_loss: 20587162.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963600.7222; train_global_loss: 22048965.1111; train_optim_loss: 22048965.1111; val_kl_reg_loss: 95541.2812; val_edge_recon_loss: 399472.1562; val_gene_expr_recon_loss: 20716838.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964191.0625; val_global_loss: 22176044.0000; val_optim_loss: 22176044.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9212; val_auprc_score: 0.9074; val_best_acc_score: 0.8476; val_best_f1_score: 0.8464; train_kl_reg_loss: 100415.1467; train_edge_recon_loss: 394778.4896; train_gene_expr_recon_loss: 20574991.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964887.7778; train_global_loss: 22035073.3333; train_optim_loss: 22035073.3333; val_kl_reg_loss: 92293.0547; val_edge_recon_loss: 398798.3438; val_gene_expr_recon_loss: 20713104.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964822.1250; val_global_loss: 22169018.0000; val_optim_loss: 22169018.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9262; val_auprc_score: 0.9144; val_best_acc_score: 0.8469; val_best_f1_score: 0.8435; train_kl_reg_loss: 99226.7344; train_edge_recon_loss: 394252.1493; train_gene_expr_recon_loss: 20476509.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957861.7361; train_global_loss: 21927850.0000; train_optim_loss: 21927850.0000; val_kl_reg_loss: 90580.5469; val_edge_recon_loss: 398001.5000; val_gene_expr_recon_loss: 20676398.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963138.2500; val_global_loss: 22128118.0000; val_optim_loss: 22128118.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9292; val_auprc_score: 0.9197; val_best_acc_score: 0.8455; val_best_f1_score: 0.8392; train_kl_reg_loss: 97685.4670; train_edge_recon_loss: 393345.7535; train_gene_expr_recon_loss: 20599976.8889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964136.9931; train_global_loss: 22055145.1111; train_optim_loss: 22055145.1111; val_kl_reg_loss: 88914.0391; val_edge_recon_loss: 397170.0000; val_gene_expr_recon_loss: 20677496.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963272.6875; val_global_loss: 22126852.0000; val_optim_loss: 22126852.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9280; val_auprc_score: 0.9138; val_best_acc_score: 0.8430; val_best_f1_score: 0.8344; train_kl_reg_loss: 101404.0773; train_edge_recon_loss: 393514.4306; train_gene_expr_recon_loss: 21001284.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 960413.0556; train_global_loss: 22456616.0000; train_optim_loss: 22456616.0000; val_kl_reg_loss: 79578.5469; val_edge_recon_loss: 396170.1562; val_gene_expr_recon_loss: 21014732.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 964917.8750; val_global_loss: 22455398.0000; val_optim_loss: 22455398.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9283; val_auprc_score: 0.9187; val_best_acc_score: 0.8409; val_best_f1_score: 0.8324; train_kl_reg_loss: 95741.7856; train_edge_recon_loss: 392114.3056; train_gene_expr_recon_loss: 20970195.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 964996.0972; train_global_loss: 22423048.2222; train_optim_loss: 22423048.2222; val_kl_reg_loss: 80981.0469; val_edge_recon_loss: 396046.1250; val_gene_expr_recon_loss: 21035842.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962401.6875; val_global_loss: 22475272.0000; val_optim_loss: 22475272.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9342; val_auprc_score: 0.9242; val_best_acc_score: 0.8428; val_best_f1_score: 0.8326; train_kl_reg_loss: 93234.2413; train_edge_recon_loss: 391919.9444; train_gene_expr_recon_loss: 20876765.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 963772.6944; train_global_loss: 22325692.4444; train_optim_loss: 22325692.4444; val_kl_reg_loss: 79361.3750; val_edge_recon_loss: 395009.4688; val_gene_expr_recon_loss: 21021392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 963123.8750; val_global_loss: 22458886.0000; val_optim_loss: 22458886.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9287; val_auprc_score: 0.9162; val_best_acc_score: 0.8323; val_best_f1_score: 0.8328; train_kl_reg_loss: 91543.1241; train_edge_recon_loss: 390683.7708; train_gene_expr_recon_loss: 20757810.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 954002.0833; train_global_loss: 22194039.7778; train_optim_loss: 22194039.7778; val_kl_reg_loss: 81832.2500; val_edge_recon_loss: 394373.6875; val_gene_expr_recon_loss: 20995156.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962219.4375; val_global_loss: 22433582.0000; val_optim_loss: 22433582.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9306; val_auprc_score: 0.9180; val_best_acc_score: 0.8329; val_best_f1_score: 0.8374; train_kl_reg_loss: 89113.4774; train_edge_recon_loss: 391191.1979; train_gene_expr_recon_loss: 20827466.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 960451.1181; train_global_loss: 22268222.4444; train_optim_loss: 22268222.4444; val_kl_reg_loss: 79798.9844; val_edge_recon_loss: 394212.4688; val_gene_expr_recon_loss: 20976988.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962141.6250; val_global_loss: 22413142.0000; val_optim_loss: 22413142.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9379; val_auprc_score: 0.9302; val_best_acc_score: 0.8376; val_best_f1_score: 0.8443; train_kl_reg_loss: 89665.7786; train_edge_recon_loss: 390453.4444; train_gene_expr_recon_loss: 20819165.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 962667.3681; train_global_loss: 22261952.2222; train_optim_loss: 22261952.2222; val_kl_reg_loss: 81553.2656; val_edge_recon_loss: 393574.9375; val_gene_expr_recon_loss: 20950316.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 960746.8750; val_global_loss: 22386190.0000; val_optim_loss: 22386190.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9317; val_auprc_score: 0.9232; val_best_acc_score: 0.8320; val_best_f1_score: 0.8366; train_kl_reg_loss: 90590.4418; train_edge_recon_loss: 389737.2188; train_gene_expr_recon_loss: 20838396.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 957889.2847; train_global_loss: 22276613.3333; train_optim_loss: 22276613.3333; val_kl_reg_loss: 81754.7812; val_edge_recon_loss: 393890.0000; val_gene_expr_recon_loss: 20972398.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 962564.3750; val_global_loss: 22410606.0000; val_optim_loss: 22410606.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9335; val_auprc_score: 0.9220; val_best_acc_score: 0.8328; val_best_f1_score: 0.8372; train_kl_reg_loss: 89746.1701; train_edge_recon_loss: 389639.6528; train_gene_expr_recon_loss: 20657343.7778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 955702.2847; train_global_loss: 22092431.7778; train_optim_loss: 22092431.7778; val_kl_reg_loss: 81159.5312; val_edge_recon_loss: 393562.1250; val_gene_expr_recon_loss: 20960376.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 960532.9375; val_global_loss: 22395630.0000; val_optim_loss: 22395630.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 36 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9246
Val AUPRC score: 0.9109
Val best accuracy score: 0.8482
Val best F1 score: 0.8432
Val gene expr MSE score: 0.6592
Val chrom access MSE score: 0.0869
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
