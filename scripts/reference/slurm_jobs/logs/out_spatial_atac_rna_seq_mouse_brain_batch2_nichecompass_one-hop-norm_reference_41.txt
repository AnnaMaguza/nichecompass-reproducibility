[True]
Run timestamp: 07092023_135413_41.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_41']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 795 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3522, n_cat_covariates_embed_input: 0, n_hidden: 2313, n_latent: 2213, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2727
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 795
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2213, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 795

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7626; val_auprc_score: 0.7846; val_best_acc_score: 0.5462; val_best_f1_score: 0.6845; train_kl_reg_loss: 78818.0877; train_edge_recon_loss: 3539669.2519; train_gene_expr_recon_loss: 12710768.9008; train_masked_gp_l1_reg_loss: 111601.8791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3101643.6504; train_chrom_access_recon_loss: 4520428.5706; train_global_loss: 24062930.2748; train_optim_loss: 24062930.2748; val_kl_reg_loss: 97143.5130; val_edge_recon_loss: 4062485.2000; val_gene_expr_recon_loss: 11911811.0000; val_masked_gp_l1_reg_loss: 100801.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224523.2656; val_chrom_access_recon_loss: 4362380.1667; val_global_loss: 20759144.9333; val_optim_loss: 20759144.9333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8084; val_auprc_score: 0.8148; val_best_acc_score: 0.7145; val_best_f1_score: 0.7402; train_kl_reg_loss: 91695.4107; train_edge_recon_loss: 3510805.1584; train_gene_expr_recon_loss: 11855278.7786; train_masked_gp_l1_reg_loss: 102255.6019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140111.3925; train_chrom_access_recon_loss: 4333663.2767; train_global_loss: 20033809.6641; train_optim_loss: 20033809.6641; val_kl_reg_loss: 84639.0661; val_edge_recon_loss: 3804620.3000; val_gene_expr_recon_loss: 11734970.2000; val_masked_gp_l1_reg_loss: 105841.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105336.7500; val_chrom_access_recon_loss: 4306054.5833; val_global_loss: 20141462.1333; val_optim_loss: 20141462.1333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8584; val_auprc_score: 0.8490; val_best_acc_score: 0.7707; val_best_f1_score: 0.7795; train_kl_reg_loss: 103496.9219; train_edge_recon_loss: 3145013.2424; train_gene_expr_recon_loss: 11707633.1069; train_masked_gp_l1_reg_loss: 113706.0976; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96243.0022; train_chrom_access_recon_loss: 4283301.2863; train_global_loss: 19449393.7252; train_optim_loss: 19449393.7252; val_kl_reg_loss: 82058.9057; val_edge_recon_loss: 3104451.8167; val_gene_expr_recon_loss: 11600912.9333; val_masked_gp_l1_reg_loss: 120696.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92069.0234; val_chrom_access_recon_loss: 4250616.7000; val_global_loss: 19250805.4667; val_optim_loss: 19250805.4667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8990; val_auprc_score: 0.8841; val_best_acc_score: 0.8150; val_best_f1_score: 0.8304; train_kl_reg_loss: 104172.2000; train_edge_recon_loss: 2933902.4637; train_gene_expr_recon_loss: 11559865.3740; train_masked_gp_l1_reg_loss: 123563.5642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85689.8903; train_chrom_access_recon_loss: 4230672.2042; train_global_loss: 19037865.7405; train_optim_loss: 19037865.7405; val_kl_reg_loss: 110589.1703; val_edge_recon_loss: 2886726.8667; val_gene_expr_recon_loss: 11466036.5333; val_masked_gp_l1_reg_loss: 126195.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81511.2344; val_chrom_access_recon_loss: 4194718.2667; val_global_loss: 18865776.6667; val_optim_loss: 18865776.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9164; val_auprc_score: 0.9012; val_best_acc_score: 0.8433; val_best_f1_score: 0.8541; train_kl_reg_loss: 106686.9196; train_edge_recon_loss: 2858691.3664; train_gene_expr_recon_loss: 11457952.4122; train_masked_gp_l1_reg_loss: 130677.6204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79819.0666; train_chrom_access_recon_loss: 4187268.7462; train_global_loss: 18821096.1679; train_optim_loss: 18821096.1679; val_kl_reg_loss: 106221.1292; val_edge_recon_loss: 2835737.1000; val_gene_expr_recon_loss: 11338293.8000; val_masked_gp_l1_reg_loss: 132769.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78763.6406; val_chrom_access_recon_loss: 4156065.9500; val_global_loss: 18647851.4667; val_optim_loss: 18647851.4667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9304; val_auprc_score: 0.9170; val_best_acc_score: 0.8626; val_best_f1_score: 0.8704; train_kl_reg_loss: 106227.4384; train_edge_recon_loss: 2822877.5763; train_gene_expr_recon_loss: 11338011.2061; train_masked_gp_l1_reg_loss: 133721.3238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77765.1516; train_chrom_access_recon_loss: 4147661.1336; train_global_loss: 18626263.9084; train_optim_loss: 18626263.9084; val_kl_reg_loss: 105975.8172; val_edge_recon_loss: 2811458.6667; val_gene_expr_recon_loss: 11235606.6667; val_masked_gp_l1_reg_loss: 134721.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77394.4141; val_chrom_access_recon_loss: 4128774.7333; val_global_loss: 18493932.0000; val_optim_loss: 18493932.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9320; val_auprc_score: 0.9170; val_best_acc_score: 0.8667; val_best_f1_score: 0.8754; train_kl_reg_loss: 105202.3158; train_edge_recon_loss: 2807527.2519; train_gene_expr_recon_loss: 11243546.7023; train_masked_gp_l1_reg_loss: 135743.4670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77440.9893; train_chrom_access_recon_loss: 4119509.7672; train_global_loss: 18488970.4427; train_optim_loss: 18488970.4427; val_kl_reg_loss: 105526.4312; val_edge_recon_loss: 2829117.2667; val_gene_expr_recon_loss: 11161046.4000; val_masked_gp_l1_reg_loss: 136603.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77789.6250; val_chrom_access_recon_loss: 4090518.2333; val_global_loss: 18400601.6000; val_optim_loss: 18400601.6000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9376; val_auprc_score: 0.9210; val_best_acc_score: 0.8766; val_best_f1_score: 0.8840; train_kl_reg_loss: 106242.0268; train_edge_recon_loss: 2784240.6851; train_gene_expr_recon_loss: 11171833.0000; train_masked_gp_l1_reg_loss: 137296.7917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78384.6087; train_chrom_access_recon_loss: 4087025.8130; train_global_loss: 18365022.9008; train_optim_loss: 18365022.9008; val_kl_reg_loss: 105618.6302; val_edge_recon_loss: 2790461.1500; val_gene_expr_recon_loss: 11063297.7333; val_masked_gp_l1_reg_loss: 138776.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78746.3047; val_chrom_access_recon_loss: 4067736.0667; val_global_loss: 18244636.8000; val_optim_loss: 18244636.8000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9459; val_auprc_score: 0.9336; val_best_acc_score: 0.8821; val_best_f1_score: 0.8882; train_kl_reg_loss: 104337.9624; train_edge_recon_loss: 2786218.9752; train_gene_expr_recon_loss: 11079886.8397; train_masked_gp_l1_reg_loss: 139082.8391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78709.9963; train_chrom_access_recon_loss: 4055769.3607; train_global_loss: 18244005.8779; train_optim_loss: 18244005.8779; val_kl_reg_loss: 97767.0250; val_edge_recon_loss: 2790733.6833; val_gene_expr_recon_loss: 11009692.4000; val_masked_gp_l1_reg_loss: 139511.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78786.5312; val_chrom_access_recon_loss: 4041846.1667; val_global_loss: 18158337.3333; val_optim_loss: 18158337.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9553; val_auprc_score: 0.9461; val_best_acc_score: 0.8923; val_best_f1_score: 0.8967; train_kl_reg_loss: 102709.3192; train_edge_recon_loss: 2768046.9027; train_gene_expr_recon_loss: 11029166.3359; train_masked_gp_l1_reg_loss: 140490.4649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78621.0096; train_chrom_access_recon_loss: 4035104.9656; train_global_loss: 18154139.0687; train_optim_loss: 18154139.0687; val_kl_reg_loss: 101655.0146; val_edge_recon_loss: 2781354.7333; val_gene_expr_recon_loss: 10968864.6667; val_masked_gp_l1_reg_loss: 141596.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79172.0547; val_chrom_access_recon_loss: 4027048.5000; val_global_loss: 18099690.8000; val_optim_loss: 18099690.8000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9544; val_auprc_score: 0.9416; val_best_acc_score: 0.8941; val_best_f1_score: 0.8988; train_kl_reg_loss: 101705.4905; train_edge_recon_loss: 2759233.0229; train_gene_expr_recon_loss: 10960570.1221; train_masked_gp_l1_reg_loss: 142034.4746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78748.2894; train_chrom_access_recon_loss: 4008045.5573; train_global_loss: 18050337.1145; train_optim_loss: 18050337.1145; val_kl_reg_loss: 99084.4542; val_edge_recon_loss: 2755312.5667; val_gene_expr_recon_loss: 10980852.3333; val_masked_gp_l1_reg_loss: 143112.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79117.6562; val_chrom_access_recon_loss: 4022729.2500; val_global_loss: 18080209.6000; val_optim_loss: 18080209.6000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9596; val_auprc_score: 0.9492; val_best_acc_score: 0.9030; val_best_f1_score: 0.9065; train_kl_reg_loss: 100157.8647; train_edge_recon_loss: 2748035.5859; train_gene_expr_recon_loss: 10914092.1527; train_masked_gp_l1_reg_loss: 143469.6589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78176.0383; train_chrom_access_recon_loss: 3991438.0382; train_global_loss: 17975369.3130; train_optim_loss: 17975369.3130; val_kl_reg_loss: 101468.5573; val_edge_recon_loss: 2732601.5000; val_gene_expr_recon_loss: 10835428.6667; val_masked_gp_l1_reg_loss: 144021.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77806.7422; val_chrom_access_recon_loss: 3968600.5833; val_global_loss: 17859927.0667; val_optim_loss: 17859927.0667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9608; val_auprc_score: 0.9505; val_best_acc_score: 0.9041; val_best_f1_score: 0.9076; train_kl_reg_loss: 100686.1933; train_edge_recon_loss: 2743275.0935; train_gene_expr_recon_loss: 10860477.8626; train_masked_gp_l1_reg_loss: 144368.5093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77865.3374; train_chrom_access_recon_loss: 3969208.6431; train_global_loss: 17895881.6183; train_optim_loss: 17895881.6183; val_kl_reg_loss: 103485.2250; val_edge_recon_loss: 2748574.7833; val_gene_expr_recon_loss: 10765329.0667; val_masked_gp_l1_reg_loss: 145083.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77737.5703; val_chrom_access_recon_loss: 3951834.1000; val_global_loss: 17792045.2000; val_optim_loss: 17792045.2000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9634; val_auprc_score: 0.9544; val_best_acc_score: 0.9078; val_best_f1_score: 0.9115; train_kl_reg_loss: 99557.3888; train_edge_recon_loss: 2735874.0210; train_gene_expr_recon_loss: 10816969.4733; train_masked_gp_l1_reg_loss: 145498.6976; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78007.6254; train_chrom_access_recon_loss: 3952445.4447; train_global_loss: 17828352.7252; train_optim_loss: 17828352.7252; val_kl_reg_loss: 99658.9870; val_edge_recon_loss: 2737997.7500; val_gene_expr_recon_loss: 10770839.2667; val_masked_gp_l1_reg_loss: 145803.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78246.9453; val_chrom_access_recon_loss: 3949643.0333; val_global_loss: 17782189.2000; val_optim_loss: 17782189.2000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9627; val_auprc_score: 0.9515; val_best_acc_score: 0.9103; val_best_f1_score: 0.9151; train_kl_reg_loss: 99354.3356; train_edge_recon_loss: 2726743.9427; train_gene_expr_recon_loss: 10779980.7023; train_masked_gp_l1_reg_loss: 145969.3823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78830.3396; train_chrom_access_recon_loss: 3936579.6050; train_global_loss: 17767458.3511; train_optim_loss: 17767458.3511; val_kl_reg_loss: 100217.4604; val_edge_recon_loss: 2739743.8500; val_gene_expr_recon_loss: 10709559.3333; val_masked_gp_l1_reg_loss: 147001.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80248.5547; val_chrom_access_recon_loss: 3929855.6833; val_global_loss: 17706626.2667; val_optim_loss: 17706626.2667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9676; val_auprc_score: 0.9559; val_best_acc_score: 0.9212; val_best_f1_score: 0.9232; train_kl_reg_loss: 98698.0827; train_edge_recon_loss: 2724877.4599; train_gene_expr_recon_loss: 10742466.6260; train_masked_gp_l1_reg_loss: 146905.0162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80514.2604; train_chrom_access_recon_loss: 3925194.2615; train_global_loss: 17718655.7099; train_optim_loss: 17718655.7099; val_kl_reg_loss: 99711.3667; val_edge_recon_loss: 2722417.8500; val_gene_expr_recon_loss: 10653211.0667; val_masked_gp_l1_reg_loss: 146838.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81071.5703; val_chrom_access_recon_loss: 3908868.6167; val_global_loss: 17612119.7333; val_optim_loss: 17612119.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9690; val_auprc_score: 0.9591; val_best_acc_score: 0.9165; val_best_f1_score: 0.9188; train_kl_reg_loss: 99072.1858; train_edge_recon_loss: 2711843.5592; train_gene_expr_recon_loss: 10705443.8855; train_masked_gp_l1_reg_loss: 147331.3443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81635.2201; train_chrom_access_recon_loss: 3911999.6737; train_global_loss: 17657325.9160; train_optim_loss: 17657325.9160; val_kl_reg_loss: 98514.8776; val_edge_recon_loss: 2728254.0500; val_gene_expr_recon_loss: 10626237.3333; val_masked_gp_l1_reg_loss: 147609.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82110.3516; val_chrom_access_recon_loss: 3896077.4667; val_global_loss: 17578803.7333; val_optim_loss: 17578803.7333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9703; val_auprc_score: 0.9613; val_best_acc_score: 0.9202; val_best_f1_score: 0.9222; train_kl_reg_loss: 99543.8316; train_edge_recon_loss: 2720427.0763; train_gene_expr_recon_loss: 10669562.7023; train_masked_gp_l1_reg_loss: 147516.7520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81958.4140; train_chrom_access_recon_loss: 3895663.0076; train_global_loss: 17614671.8473; train_optim_loss: 17614671.8473; val_kl_reg_loss: 93506.7276; val_edge_recon_loss: 2735850.6000; val_gene_expr_recon_loss: 10604692.1333; val_masked_gp_l1_reg_loss: 148314.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82461.9922; val_chrom_access_recon_loss: 3894708.9833; val_global_loss: 17559534.5333; val_optim_loss: 17559534.5333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9665; val_auprc_score: 0.9558; val_best_acc_score: 0.9153; val_best_f1_score: 0.9183; train_kl_reg_loss: 98387.0270; train_edge_recon_loss: 2717506.2901; train_gene_expr_recon_loss: 10645288.7557; train_masked_gp_l1_reg_loss: 148171.0281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81919.6221; train_chrom_access_recon_loss: 3885871.0115; train_global_loss: 17577143.6718; train_optim_loss: 17577143.6718; val_kl_reg_loss: 102589.9240; val_edge_recon_loss: 2731642.0000; val_gene_expr_recon_loss: 10624998.5333; val_masked_gp_l1_reg_loss: 148417.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82332.4297; val_chrom_access_recon_loss: 3905541.8833; val_global_loss: 17595521.2000; val_optim_loss: 17595521.2000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9688; val_auprc_score: 0.9607; val_best_acc_score: 0.9186; val_best_f1_score: 0.9218; train_kl_reg_loss: 97892.9990; train_edge_recon_loss: 2721768.9179; train_gene_expr_recon_loss: 10615225.9237; train_masked_gp_l1_reg_loss: 148182.2439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81989.5251; train_chrom_access_recon_loss: 3869453.3187; train_global_loss: 17534513.0305; train_optim_loss: 17534513.0305; val_kl_reg_loss: 97649.2760; val_edge_recon_loss: 2736387.6000; val_gene_expr_recon_loss: 10585845.8667; val_masked_gp_l1_reg_loss: 148169.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81379.1797; val_chrom_access_recon_loss: 3870660.2500; val_global_loss: 17520090.9333; val_optim_loss: 17520090.9333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9693; val_auprc_score: 0.9600; val_best_acc_score: 0.9214; val_best_f1_score: 0.9236; train_kl_reg_loss: 97401.0127; train_edge_recon_loss: 2714038.1221; train_gene_expr_recon_loss: 10583714.4885; train_masked_gp_l1_reg_loss: 148260.9789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81937.7835; train_chrom_access_recon_loss: 3860033.6469; train_global_loss: 17485386.0305; train_optim_loss: 17485386.0305; val_kl_reg_loss: 96428.7099; val_edge_recon_loss: 2732795.2167; val_gene_expr_recon_loss: 10554257.4000; val_masked_gp_l1_reg_loss: 148082.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81129.0703; val_chrom_access_recon_loss: 3864307.0500; val_global_loss: 17477000.2667; val_optim_loss: 17477000.2667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9723; val_auprc_score: 0.9644; val_best_acc_score: 0.9239; val_best_f1_score: 0.9265; train_kl_reg_loss: 97924.8483; train_edge_recon_loss: 2709883.0324; train_gene_expr_recon_loss: 10572454.5954; train_masked_gp_l1_reg_loss: 148088.4388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81893.3349; train_chrom_access_recon_loss: 3854133.4981; train_global_loss: 17464377.8015; train_optim_loss: 17464377.8015; val_kl_reg_loss: 101793.8193; val_edge_recon_loss: 2712003.8167; val_gene_expr_recon_loss: 10530751.5333; val_masked_gp_l1_reg_loss: 148249.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82216.0859; val_chrom_access_recon_loss: 3848032.3000; val_global_loss: 17423046.4000; val_optim_loss: 17423046.4000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9703; val_auprc_score: 0.9603; val_best_acc_score: 0.9240; val_best_f1_score: 0.9266; train_kl_reg_loss: 97226.6907; train_edge_recon_loss: 2714943.9122; train_gene_expr_recon_loss: 10551130.7557; train_masked_gp_l1_reg_loss: 148078.0644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81701.0632; train_chrom_access_recon_loss: 3841913.9065; train_global_loss: 17434994.4733; train_optim_loss: 17434994.4733; val_kl_reg_loss: 95318.7688; val_edge_recon_loss: 2707779.9167; val_gene_expr_recon_loss: 10496614.3333; val_masked_gp_l1_reg_loss: 148205.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81760.4219; val_chrom_access_recon_loss: 3826771.0667; val_global_loss: 17356450.4000; val_optim_loss: 17356450.4000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9736; val_auprc_score: 0.9667; val_best_acc_score: 0.9255; val_best_f1_score: 0.9280; train_kl_reg_loss: 96893.9725; train_edge_recon_loss: 2704894.9294; train_gene_expr_recon_loss: 10530280.3817; train_masked_gp_l1_reg_loss: 147898.2309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81770.4961; train_chrom_access_recon_loss: 3833079.5649; train_global_loss: 17394817.5344; train_optim_loss: 17394817.5344; val_kl_reg_loss: 96713.3568; val_edge_recon_loss: 2719250.2833; val_gene_expr_recon_loss: 10498988.4000; val_masked_gp_l1_reg_loss: 147881.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82013.1484; val_chrom_access_recon_loss: 3867697.4167; val_global_loss: 17412543.8000; val_optim_loss: 17412543.8000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9718; val_auprc_score: 0.9638; val_best_acc_score: 0.9220; val_best_f1_score: 0.9249; train_kl_reg_loss: 96881.9804; train_edge_recon_loss: 2712035.0420; train_gene_expr_recon_loss: 10514465.6336; train_masked_gp_l1_reg_loss: 147873.5833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82160.5379; train_chrom_access_recon_loss: 3824549.3760; train_global_loss: 17377966.1603; train_optim_loss: 17377966.1603; val_kl_reg_loss: 98674.2422; val_edge_recon_loss: 2733990.4167; val_gene_expr_recon_loss: 10504750.6667; val_masked_gp_l1_reg_loss: 147836.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82313.3984; val_chrom_access_recon_loss: 3836295.8500; val_global_loss: 17403860.0667; val_optim_loss: 17403860.0667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9761; val_auprc_score: 0.9702; val_best_acc_score: 0.9282; val_best_f1_score: 0.9311; train_kl_reg_loss: 104180.4480; train_edge_recon_loss: 2729775.9924; train_gene_expr_recon_loss: 10226013.2366; train_masked_gp_l1_reg_loss: 146309.7799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80236.6871; train_chrom_access_recon_loss: 3716696.0821; train_global_loss: 17003212.2595; train_optim_loss: 17003212.2595; val_kl_reg_loss: 71926.7604; val_edge_recon_loss: 2731826.9000; val_gene_expr_recon_loss: 10176011.0000; val_masked_gp_l1_reg_loss: 146518.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80102.1484; val_chrom_access_recon_loss: 3699254.2500; val_global_loss: 16905638.8667; val_optim_loss: 16905638.8667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9751; val_auprc_score: 0.9674; val_best_acc_score: 0.9278; val_best_f1_score: 0.9302; train_kl_reg_loss: 97417.8879; train_edge_recon_loss: 2715355.1927; train_gene_expr_recon_loss: 10187812.6794; train_masked_gp_l1_reg_loss: 146129.0959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80429.5244; train_chrom_access_recon_loss: 3701744.3282; train_global_loss: 16928888.6183; train_optim_loss: 16928888.6183; val_kl_reg_loss: 75857.7104; val_edge_recon_loss: 2711271.9333; val_gene_expr_recon_loss: 10155759.0667; val_masked_gp_l1_reg_loss: 146087.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80847.1406; val_chrom_access_recon_loss: 3697104.3833; val_global_loss: 16866928.2000; val_optim_loss: 16866928.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9763; val_auprc_score: 0.9710; val_best_acc_score: 0.9321; val_best_f1_score: 0.9343; train_kl_reg_loss: 92578.0919; train_edge_recon_loss: 2713051.1183; train_gene_expr_recon_loss: 10152696.1985; train_masked_gp_l1_reg_loss: 145557.9053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80116.9218; train_chrom_access_recon_loss: 3686688.1851; train_global_loss: 16870688.3359; train_optim_loss: 16870688.3359; val_kl_reg_loss: 79957.6318; val_edge_recon_loss: 2714248.9333; val_gene_expr_recon_loss: 10095855.2000; val_masked_gp_l1_reg_loss: 144816.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79751.9453; val_chrom_access_recon_loss: 3666770.4833; val_global_loss: 16781400.0000; val_optim_loss: 16781400.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9766; val_auprc_score: 0.9682; val_best_acc_score: 0.9310; val_best_f1_score: 0.9326; train_kl_reg_loss: 91119.5465; train_edge_recon_loss: 2703049.1641; train_gene_expr_recon_loss: 10136519.5954; train_masked_gp_l1_reg_loss: 144662.8257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79833.0204; train_chrom_access_recon_loss: 3677093.4962; train_global_loss: 16832277.6336; train_optim_loss: 16832277.6336; val_kl_reg_loss: 82303.0276; val_edge_recon_loss: 2713834.9833; val_gene_expr_recon_loss: 10070294.4667; val_masked_gp_l1_reg_loss: 144249.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79746.8828; val_chrom_access_recon_loss: 3677556.4333; val_global_loss: 16767984.7333; val_optim_loss: 16767984.7333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9755; val_auprc_score: 0.9656; val_best_acc_score: 0.9272; val_best_f1_score: 0.9298; train_kl_reg_loss: 90909.1646; train_edge_recon_loss: 2703106.6660; train_gene_expr_recon_loss: 10113017.3969; train_masked_gp_l1_reg_loss: 143891.1833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79420.8086; train_chrom_access_recon_loss: 3668831.3874; train_global_loss: 16799176.6031; train_optim_loss: 16799176.6031; val_kl_reg_loss: 84725.6755; val_edge_recon_loss: 2728136.6167; val_gene_expr_recon_loss: 10055992.3333; val_masked_gp_l1_reg_loss: 143516.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79383.7031; val_chrom_access_recon_loss: 3650460.3500; val_global_loss: 16742214.8667; val_optim_loss: 16742214.8667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9805; val_auprc_score: 0.9773; val_best_acc_score: 0.9332; val_best_f1_score: 0.9357; train_kl_reg_loss: 88873.9860; train_edge_recon_loss: 2706814.3340; train_gene_expr_recon_loss: 10098865.6336; train_masked_gp_l1_reg_loss: 143235.5716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79166.8158; train_chrom_access_recon_loss: 3661675.4256; train_global_loss: 16778631.7023; train_optim_loss: 16778631.7023; val_kl_reg_loss: 86716.8333; val_edge_recon_loss: 2712142.8833; val_gene_expr_recon_loss: 10073941.7333; val_masked_gp_l1_reg_loss: 143221.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79187.2344; val_chrom_access_recon_loss: 3655626.8500; val_global_loss: 16750837.2667; val_optim_loss: 16750837.2667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9752; val_auprc_score: 0.9679; val_best_acc_score: 0.9314; val_best_f1_score: 0.9331; train_kl_reg_loss: 89201.1622; train_edge_recon_loss: 2699320.2557; train_gene_expr_recon_loss: 10093956.2977; train_masked_gp_l1_reg_loss: 142893.6206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78992.9434; train_chrom_access_recon_loss: 3660658.7595; train_global_loss: 16765023.1069; train_optim_loss: 16765023.1069; val_kl_reg_loss: 87962.2396; val_edge_recon_loss: 2706124.5000; val_gene_expr_recon_loss: 10067928.8667; val_masked_gp_l1_reg_loss: 142663.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78986.7188; val_chrom_access_recon_loss: 3644116.2833; val_global_loss: 16727783.0000; val_optim_loss: 16727783.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9780; val_auprc_score: 0.9721; val_best_acc_score: 0.9302; val_best_f1_score: 0.9328; train_kl_reg_loss: 88517.9855; train_edge_recon_loss: 2696921.6374; train_gene_expr_recon_loss: 10089224.4198; train_masked_gp_l1_reg_loss: 142447.8251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78722.0479; train_chrom_access_recon_loss: 3658455.3912; train_global_loss: 16754289.3282; train_optim_loss: 16754289.3282; val_kl_reg_loss: 84134.3719; val_edge_recon_loss: 2701998.1000; val_gene_expr_recon_loss: 10024067.6000; val_masked_gp_l1_reg_loss: 142410.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79211.6406; val_chrom_access_recon_loss: 3644783.9167; val_global_loss: 16676606.8000; val_optim_loss: 16676606.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9799; val_auprc_score: 0.9723; val_best_acc_score: 0.9380; val_best_f1_score: 0.9390; train_kl_reg_loss: 87860.2668; train_edge_recon_loss: 2698872.0534; train_gene_expr_recon_loss: 10064628.7939; train_masked_gp_l1_reg_loss: 142150.7216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78646.0966; train_chrom_access_recon_loss: 3649536.5782; train_global_loss: 16721694.5725; train_optim_loss: 16721694.5725; val_kl_reg_loss: 87808.7990; val_edge_recon_loss: 2698053.5333; val_gene_expr_recon_loss: 10048659.5333; val_masked_gp_l1_reg_loss: 141782.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79189.8359; val_chrom_access_recon_loss: 3655580.1500; val_global_loss: 16711073.8667; val_optim_loss: 16711073.8667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9782; val_auprc_score: 0.9713; val_best_acc_score: 0.9341; val_best_f1_score: 0.9362; train_kl_reg_loss: 89211.4944; train_edge_recon_loss: 2691104.9237; train_gene_expr_recon_loss: 10057045.2519; train_masked_gp_l1_reg_loss: 141503.2445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78697.6536; train_chrom_access_recon_loss: 3647803.8092; train_global_loss: 16705366.4504; train_optim_loss: 16705366.4504; val_kl_reg_loss: 90016.4307; val_edge_recon_loss: 2710913.5000; val_gene_expr_recon_loss: 10035972.3333; val_masked_gp_l1_reg_loss: 141161.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78354.6797; val_chrom_access_recon_loss: 3638589.8167; val_global_loss: 16695009.2667; val_optim_loss: 16695009.2667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9796; val_auprc_score: 0.9732; val_best_acc_score: 0.9392; val_best_f1_score: 0.9409; train_kl_reg_loss: 88169.9587; train_edge_recon_loss: 2702797.3817; train_gene_expr_recon_loss: 10046811.7634; train_masked_gp_l1_reg_loss: 140958.7040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78422.4970; train_chrom_access_recon_loss: 3643959.7042; train_global_loss: 16701120.0305; train_optim_loss: 16701120.0305; val_kl_reg_loss: 85269.9302; val_edge_recon_loss: 2719794.2167; val_gene_expr_recon_loss: 10072674.4667; val_masked_gp_l1_reg_loss: 141084.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78828.9375; val_chrom_access_recon_loss: 3668247.7833; val_global_loss: 16765898.9333; val_optim_loss: 16765898.9333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9783; val_auprc_score: 0.9707; val_best_acc_score: 0.9372; val_best_f1_score: 0.9386; train_kl_reg_loss: 88110.9231; train_edge_recon_loss: 2694242.7366; train_gene_expr_recon_loss: 10042386.1221; train_masked_gp_l1_reg_loss: 140578.9990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78404.0057; train_chrom_access_recon_loss: 3638785.5191; train_global_loss: 16682508.3435; train_optim_loss: 16682508.3435; val_kl_reg_loss: 86447.1281; val_edge_recon_loss: 2699985.9500; val_gene_expr_recon_loss: 9997844.8000; val_masked_gp_l1_reg_loss: 140482.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79200.7891; val_chrom_access_recon_loss: 3639385.8500; val_global_loss: 16643347.8000; val_optim_loss: 16643347.8000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9810; val_auprc_score: 0.9755; val_best_acc_score: 0.9391; val_best_f1_score: 0.9410; train_kl_reg_loss: 87464.9476; train_edge_recon_loss: 2693152.4866; train_gene_expr_recon_loss: 10030461.1756; train_masked_gp_l1_reg_loss: 140248.8132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78378.4843; train_chrom_access_recon_loss: 3640160.5191; train_global_loss: 16669866.3664; train_optim_loss: 16669866.3664; val_kl_reg_loss: 86531.7703; val_edge_recon_loss: 2716997.2833; val_gene_expr_recon_loss: 10009890.4000; val_masked_gp_l1_reg_loss: 140121.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77734.5234; val_chrom_access_recon_loss: 3639281.2000; val_global_loss: 16670557.6667; val_optim_loss: 16670557.6667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9808; val_auprc_score: 0.9748; val_best_acc_score: 0.9386; val_best_f1_score: 0.9404; train_kl_reg_loss: 87913.8130; train_edge_recon_loss: 2698133.0134; train_gene_expr_recon_loss: 10024507.9847; train_masked_gp_l1_reg_loss: 139805.7387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78235.9458; train_chrom_access_recon_loss: 3635701.1107; train_global_loss: 16664297.5420; train_optim_loss: 16664297.5420; val_kl_reg_loss: 85051.9271; val_edge_recon_loss: 2709044.5167; val_gene_expr_recon_loss: 9983449.3333; val_masked_gp_l1_reg_loss: 139606.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78416.3125; val_chrom_access_recon_loss: 3638960.0333; val_global_loss: 16634528.8000; val_optim_loss: 16634528.8000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9809; val_auprc_score: 0.9736; val_best_acc_score: 0.9392; val_best_f1_score: 0.9412; train_kl_reg_loss: 88577.6172; train_edge_recon_loss: 2693396.1355; train_gene_expr_recon_loss: 10022568.4885; train_masked_gp_l1_reg_loss: 139316.0625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78355.0169; train_chrom_access_recon_loss: 3632873.7500; train_global_loss: 16655087.0382; train_optim_loss: 16655087.0382; val_kl_reg_loss: 87196.4880; val_edge_recon_loss: 2709103.6333; val_gene_expr_recon_loss: 10015103.0667; val_masked_gp_l1_reg_loss: 139004.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78194.3594; val_chrom_access_recon_loss: 3631152.0500; val_global_loss: 16659753.3333; val_optim_loss: 16659753.3333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9827; val_auprc_score: 0.9781; val_best_acc_score: 0.9414; val_best_f1_score: 0.9432; train_kl_reg_loss: 87844.6242; train_edge_recon_loss: 2694265.1908; train_gene_expr_recon_loss: 10012487.7252; train_masked_gp_l1_reg_loss: 138684.8046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78276.0299; train_chrom_access_recon_loss: 3628097.1412; train_global_loss: 16639655.5267; train_optim_loss: 16639655.5267; val_kl_reg_loss: 85885.0276; val_edge_recon_loss: 2707072.6667; val_gene_expr_recon_loss: 9968071.6000; val_masked_gp_l1_reg_loss: 138526.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78091.3203; val_chrom_access_recon_loss: 3636608.8167; val_global_loss: 16614256.0000; val_optim_loss: 16614256.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9821; val_auprc_score: 0.9766; val_best_acc_score: 0.9438; val_best_f1_score: 0.9453; train_kl_reg_loss: 88131.2610; train_edge_recon_loss: 2684321.1889; train_gene_expr_recon_loss: 10003005.2061; train_masked_gp_l1_reg_loss: 138236.8867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78367.7387; train_chrom_access_recon_loss: 3623972.1240; train_global_loss: 16616034.4733; train_optim_loss: 16616034.4733; val_kl_reg_loss: 86073.0115; val_edge_recon_loss: 2689259.6000; val_gene_expr_recon_loss: 9980026.7333; val_masked_gp_l1_reg_loss: 138215.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78512.8125; val_chrom_access_recon_loss: 3635005.7333; val_global_loss: 16607094.2000; val_optim_loss: 16607094.2000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9823; val_auprc_score: 0.9780; val_best_acc_score: 0.9431; val_best_f1_score: 0.9445; train_kl_reg_loss: 87210.5804; train_edge_recon_loss: 2687403.9504; train_gene_expr_recon_loss: 9995531.6565; train_masked_gp_l1_reg_loss: 137849.6357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78311.5796; train_chrom_access_recon_loss: 3618534.4198; train_global_loss: 16604841.8931; train_optim_loss: 16604841.8931; val_kl_reg_loss: 86598.3214; val_edge_recon_loss: 2696874.0167; val_gene_expr_recon_loss: 9940157.0000; val_masked_gp_l1_reg_loss: 137470.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78062.8438; val_chrom_access_recon_loss: 3608504.6667; val_global_loss: 16547667.1333; val_optim_loss: 16547667.1333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9843; val_auprc_score: 0.9789; val_best_acc_score: 0.9493; val_best_f1_score: 0.9506; train_kl_reg_loss: 87124.2987; train_edge_recon_loss: 2690150.9141; train_gene_expr_recon_loss: 9990562.8397; train_masked_gp_l1_reg_loss: 137491.7657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78441.2091; train_chrom_access_recon_loss: 3616405.3168; train_global_loss: 16600176.2443; train_optim_loss: 16600176.2443; val_kl_reg_loss: 85943.6073; val_edge_recon_loss: 2692784.1167; val_gene_expr_recon_loss: 9983984.6000; val_masked_gp_l1_reg_loss: 137368.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78002.0547; val_chrom_access_recon_loss: 3618814.3667; val_global_loss: 16596896.7333; val_optim_loss: 16596896.7333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9828; val_auprc_score: 0.9765; val_best_acc_score: 0.9430; val_best_f1_score: 0.9450; train_kl_reg_loss: 86740.1985; train_edge_recon_loss: 2689760.6088; train_gene_expr_recon_loss: 9990367.6641; train_masked_gp_l1_reg_loss: 137251.5359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78338.0478; train_chrom_access_recon_loss: 3611591.2958; train_global_loss: 16594049.2443; train_optim_loss: 16594049.2443; val_kl_reg_loss: 84211.4323; val_edge_recon_loss: 2684434.2667; val_gene_expr_recon_loss: 9968323.1333; val_masked_gp_l1_reg_loss: 137232.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78143.3516; val_chrom_access_recon_loss: 3606887.7167; val_global_loss: 16559231.4000; val_optim_loss: 16559231.4000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9837; val_auprc_score: 0.9789; val_best_acc_score: 0.9450; val_best_f1_score: 0.9465; train_kl_reg_loss: 86673.0834; train_edge_recon_loss: 2686441.9218; train_gene_expr_recon_loss: 9977201.5267; train_masked_gp_l1_reg_loss: 136954.1578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78136.6305; train_chrom_access_recon_loss: 3602806.3149; train_global_loss: 16568213.6183; train_optim_loss: 16568213.6183; val_kl_reg_loss: 86822.6458; val_edge_recon_loss: 2687140.2667; val_gene_expr_recon_loss: 9984944.4000; val_masked_gp_l1_reg_loss: 136576.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77474.4453; val_chrom_access_recon_loss: 3619985.2333; val_global_loss: 16592942.7333; val_optim_loss: 16592942.7333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9810; val_auprc_score: 0.9723; val_best_acc_score: 0.9414; val_best_f1_score: 0.9427; train_kl_reg_loss: 86466.5462; train_edge_recon_loss: 2683357.1775; train_gene_expr_recon_loss: 9981670.5878; train_masked_gp_l1_reg_loss: 136578.6188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78340.6533; train_chrom_access_recon_loss: 3605929.5611; train_global_loss: 16572343.1221; train_optim_loss: 16572343.1221; val_kl_reg_loss: 85986.0042; val_edge_recon_loss: 2715329.5833; val_gene_expr_recon_loss: 9969279.2667; val_masked_gp_l1_reg_loss: 136366.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78021.8359; val_chrom_access_recon_loss: 3596419.2167; val_global_loss: 16581402.0667; val_optim_loss: 16581402.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9857; val_auprc_score: 0.9810; val_best_acc_score: 0.9479; val_best_f1_score: 0.9494; train_kl_reg_loss: 87743.6272; train_edge_recon_loss: 2687975.6985; train_gene_expr_recon_loss: 9953958.1832; train_masked_gp_l1_reg_loss: 133571.5732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59710.3350; train_chrom_access_recon_loss: 3594877.6565; train_global_loss: 16517837.1069; train_optim_loss: 16517837.1069; val_kl_reg_loss: 88361.3104; val_edge_recon_loss: 2680824.7000; val_gene_expr_recon_loss: 9957927.9333; val_masked_gp_l1_reg_loss: 132759.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57620.6211; val_chrom_access_recon_loss: 3608675.5667; val_global_loss: 16526169.4000; val_optim_loss: 16526169.4000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9843; val_auprc_score: 0.9807; val_best_acc_score: 0.9465; val_best_f1_score: 0.9479; train_kl_reg_loss: 88854.1321; train_edge_recon_loss: 2678596.1889; train_gene_expr_recon_loss: 9952308.2519; train_masked_gp_l1_reg_loss: 132593.1634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57373.6532; train_chrom_access_recon_loss: 3590638.4046; train_global_loss: 16500363.6641; train_optim_loss: 16500363.6641; val_kl_reg_loss: 88194.4359; val_edge_recon_loss: 2688007.8833; val_gene_expr_recon_loss: 9907463.5333; val_masked_gp_l1_reg_loss: 132449.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57248.8320; val_chrom_access_recon_loss: 3585712.6333; val_global_loss: 16459076.4667; val_optim_loss: 16459076.4667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9835; val_auprc_score: 0.9798; val_best_acc_score: 0.9433; val_best_f1_score: 0.9453; train_kl_reg_loss: 89584.6625; train_edge_recon_loss: 2687046.6298; train_gene_expr_recon_loss: 9948048.4580; train_masked_gp_l1_reg_loss: 132377.9176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57105.9405; train_chrom_access_recon_loss: 3588357.5477; train_global_loss: 16502521.1908; train_optim_loss: 16502521.1908; val_kl_reg_loss: 88944.9479; val_edge_recon_loss: 2702769.4167; val_gene_expr_recon_loss: 9937199.4667; val_masked_gp_l1_reg_loss: 132256.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56852.1953; val_chrom_access_recon_loss: 3601801.8000; val_global_loss: 16519823.4667; val_optim_loss: 16519823.4667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9822; val_auprc_score: 0.9771; val_best_acc_score: 0.9433; val_best_f1_score: 0.9449; train_kl_reg_loss: 89908.0387; train_edge_recon_loss: 2681653.8607; train_gene_expr_recon_loss: 9941341.0763; train_masked_gp_l1_reg_loss: 132207.4829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56731.4794; train_chrom_access_recon_loss: 3589010.8378; train_global_loss: 16490852.7252; train_optim_loss: 16490852.7252; val_kl_reg_loss: 89088.9859; val_edge_recon_loss: 2701495.7167; val_gene_expr_recon_loss: 9948336.4000; val_masked_gp_l1_reg_loss: 132152.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56659.2227; val_chrom_access_recon_loss: 3603789.8500; val_global_loss: 16531521.8000; val_optim_loss: 16531521.8000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9840; val_auprc_score: 0.9788; val_best_acc_score: 0.9426; val_best_f1_score: 0.9441; train_kl_reg_loss: 90170.0082; train_edge_recon_loss: 2677876.9561; train_gene_expr_recon_loss: 9945299.0382; train_masked_gp_l1_reg_loss: 132084.5796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56455.2403; train_chrom_access_recon_loss: 3592952.6718; train_global_loss: 16494838.4656; train_optim_loss: 16494838.4656; val_kl_reg_loss: 89892.5276; val_edge_recon_loss: 2693729.8833; val_gene_expr_recon_loss: 9931344.6000; val_masked_gp_l1_reg_loss: 132050.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56400.6055; val_chrom_access_recon_loss: 3605088.0333; val_global_loss: 16508506.0667; val_optim_loss: 16508506.0667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9832; val_auprc_score: 0.9782; val_best_acc_score: 0.9452; val_best_f1_score: 0.9466; train_kl_reg_loss: 90357.1001; train_edge_recon_loss: 2674080.0210; train_gene_expr_recon_loss: 9941503.2137; train_masked_gp_l1_reg_loss: 131987.2282; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56325.2080; train_chrom_access_recon_loss: 3591950.6756; train_global_loss: 16486203.3588; train_optim_loss: 16486203.3588; val_kl_reg_loss: 88656.7073; val_edge_recon_loss: 2687625.2667; val_gene_expr_recon_loss: 9965791.5333; val_masked_gp_l1_reg_loss: 131919.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56142.8242; val_chrom_access_recon_loss: 3611177.0833; val_global_loss: 16541313.9333; val_optim_loss: 16541313.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9815; val_auprc_score: 0.9762; val_best_acc_score: 0.9411; val_best_f1_score: 0.9429; train_kl_reg_loss: 90481.3381; train_edge_recon_loss: 2679863.8950; train_gene_expr_recon_loss: 9938557.0458; train_masked_gp_l1_reg_loss: 131631.9399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54108.3775; train_chrom_access_recon_loss: 3587321.5134; train_global_loss: 16481963.9847; train_optim_loss: 16481963.9847; val_kl_reg_loss: 88791.4307; val_edge_recon_loss: 2712789.0000; val_gene_expr_recon_loss: 9943807.5333; val_masked_gp_l1_reg_loss: 131540.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53898.2812; val_chrom_access_recon_loss: 3627249.8000; val_global_loss: 16558076.8667; val_optim_loss: 16558076.8667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9819; val_auprc_score: 0.9759; val_best_acc_score: 0.9442; val_best_f1_score: 0.9458; train_kl_reg_loss: 90391.2599; train_edge_recon_loss: 2679813.9962; train_gene_expr_recon_loss: 9935376.0992; train_masked_gp_l1_reg_loss: 131510.1900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53878.0032; train_chrom_access_recon_loss: 3588359.2767; train_global_loss: 16479328.8473; train_optim_loss: 16479328.8473; val_kl_reg_loss: 88582.6182; val_edge_recon_loss: 2698852.7833; val_gene_expr_recon_loss: 9950893.8667; val_masked_gp_l1_reg_loss: 131480.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53840.6055; val_chrom_access_recon_loss: 3586531.3333; val_global_loss: 16510182.6000; val_optim_loss: 16510182.6000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9840; val_auprc_score: 0.9793; val_best_acc_score: 0.9456; val_best_f1_score: 0.9471; train_kl_reg_loss: 90521.3190; train_edge_recon_loss: 2677758.4561; train_gene_expr_recon_loss: 9950015.5038; train_masked_gp_l1_reg_loss: 131464.0427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53811.5995; train_chrom_access_recon_loss: 3592253.5954; train_global_loss: 16495824.5115; train_optim_loss: 16495824.5115; val_kl_reg_loss: 88812.6708; val_edge_recon_loss: 2678449.8667; val_gene_expr_recon_loss: 9972568.0000; val_masked_gp_l1_reg_loss: 131449.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53798.3867; val_chrom_access_recon_loss: 3608761.9667; val_global_loss: 16533840.4000; val_optim_loss: 16533840.4000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9836; val_auprc_score: 0.9800; val_best_acc_score: 0.9417; val_best_f1_score: 0.9439; train_kl_reg_loss: 90534.5234; train_edge_recon_loss: 2685185.9466; train_gene_expr_recon_loss: 9939286.9160; train_masked_gp_l1_reg_loss: 131439.9457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53779.7459; train_chrom_access_recon_loss: 3588790.6202; train_global_loss: 16489017.8321; train_optim_loss: 16489017.8321; val_kl_reg_loss: 88530.8740; val_edge_recon_loss: 2695757.8333; val_gene_expr_recon_loss: 9917685.1333; val_masked_gp_l1_reg_loss: 131426.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53757.1641; val_chrom_access_recon_loss: 3591966.8833; val_global_loss: 16479124.7333; val_optim_loss: 16479124.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 69 min 20 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9826
val AUPRC score: 0.9783
val best accuracy score: 0.9425
val best F1 score: 0.9441
val target rna MSE score: 1.4114
val source rna MSE score: 0.3570
val target atac MSE score: 0.4894
val source atac MSE score: 0.0767
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
