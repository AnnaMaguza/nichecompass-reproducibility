[True]
Run timestamp: 10082023_235236_105.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_105']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7140; val_auprc_score: 0.7467; val_best_acc_score: 0.5024; val_best_f1_score: 0.6671; train_kl_reg_loss: 169593.0779; train_edge_recon_loss: 3785913.4924; train_gene_expr_recon_loss: 48528944.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 29478660.7176; train_global_loss: 81963111.7252; train_optim_loss: 81963111.7252; val_kl_reg_loss: 145926.3292; val_edge_recon_loss: 4065185.1833; val_gene_expr_recon_loss: 39129786.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 26061495.6000; val_global_loss: 69402394.1333; val_optim_loss: 69402394.1333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7672; val_auprc_score: 0.7895; val_best_acc_score: 0.5345; val_best_f1_score: 0.6782; train_kl_reg_loss: 133765.5954; train_edge_recon_loss: 3751889.8340; train_gene_expr_recon_loss: 39705169.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 26114375.0534; train_global_loss: 69705200.0916; train_optim_loss: 69705200.0916; val_kl_reg_loss: 158242.3813; val_edge_recon_loss: 4062584.4833; val_gene_expr_recon_loss: 38005997.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25866199.2000; val_global_loss: 68093023.2000; val_optim_loss: 68093023.2000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8335; val_auprc_score: 0.8471; val_best_acc_score: 0.7502; val_best_f1_score: 0.7626; train_kl_reg_loss: 161671.2628; train_edge_recon_loss: 3599601.4389; train_gene_expr_recon_loss: 37407241.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25691161.6794; train_global_loss: 66859675.9695; train_optim_loss: 66859675.9695; val_kl_reg_loss: 162915.3000; val_edge_recon_loss: 4037869.1333; val_gene_expr_recon_loss: 36860098.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25482865.8667; val_global_loss: 66543749.3333; val_optim_loss: 66543749.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9087; val_auprc_score: 0.8989; val_best_acc_score: 0.8289; val_best_f1_score: 0.8390; train_kl_reg_loss: 154707.2405; train_edge_recon_loss: 3533450.5172; train_gene_expr_recon_loss: 36704293.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25460916.7176; train_global_loss: 65853367.5725; train_optim_loss: 65853367.5725; val_kl_reg_loss: 132531.1505; val_edge_recon_loss: 3785009.2167; val_gene_expr_recon_loss: 36340033.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25214744.1333; val_global_loss: 65472317.8667; val_optim_loss: 65472317.8667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8962; val_auprc_score: 0.8870; val_best_acc_score: 0.8085; val_best_f1_score: 0.8226; train_kl_reg_loss: 145629.4154; train_edge_recon_loss: 3233779.2271; train_gene_expr_recon_loss: 36400081.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25280187.0840; train_global_loss: 65059677.1298; train_optim_loss: 65059677.1298; val_kl_reg_loss: 171817.2062; val_edge_recon_loss: 3048219.3167; val_gene_expr_recon_loss: 36189404.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25098404.5333; val_global_loss: 64507845.6000; val_optim_loss: 64507845.6000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9009; val_auprc_score: 0.8906; val_best_acc_score: 0.8149; val_best_f1_score: 0.8318; train_kl_reg_loss: 177639.1485; train_edge_recon_loss: 3018421.1832; train_gene_expr_recon_loss: 36200700.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25190994.8244; train_global_loss: 64587755.4809; train_optim_loss: 64587755.4809; val_kl_reg_loss: 176377.6917; val_edge_recon_loss: 2978552.1000; val_gene_expr_recon_loss: 35946620.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 25133287.4667; val_global_loss: 64234838.6667; val_optim_loss: 64234838.6667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9144; val_auprc_score: 0.9050; val_best_acc_score: 0.8321; val_best_f1_score: 0.8425; train_kl_reg_loss: 172649.7359; train_edge_recon_loss: 2962281.4714; train_gene_expr_recon_loss: 35974893.8626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 25071535.2061; train_global_loss: 64181360.1832; train_optim_loss: 64181360.1832; val_kl_reg_loss: 166802.1010; val_edge_recon_loss: 2958449.3000; val_gene_expr_recon_loss: 35749891.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24940413.3333; val_global_loss: 63815556.5333; val_optim_loss: 63815556.5333
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9211; val_auprc_score: 0.9079; val_best_acc_score: 0.8452; val_best_f1_score: 0.8539; train_kl_reg_loss: 165945.4896; train_edge_recon_loss: 2931855.8893; train_gene_expr_recon_loss: 35785060.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24953040.7481; train_global_loss: 63835902.5649; train_optim_loss: 63835902.5649; val_kl_reg_loss: 159721.3854; val_edge_recon_loss: 2923532.6833; val_gene_expr_recon_loss: 35730993.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24843019.8667; val_global_loss: 63657268.0000; val_optim_loss: 63657268.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9236; val_auprc_score: 0.9130; val_best_acc_score: 0.8482; val_best_f1_score: 0.8596; train_kl_reg_loss: 161624.0489; train_edge_recon_loss: 2901256.9160; train_gene_expr_recon_loss: 35652719.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24889896.6412; train_global_loss: 63605497.3435; train_optim_loss: 63605497.3435; val_kl_reg_loss: 156856.6198; val_edge_recon_loss: 2906126.1500; val_gene_expr_recon_loss: 35530345.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24753027.6000; val_global_loss: 63346355.4667; val_optim_loss: 63346355.4667
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9260; val_auprc_score: 0.9129; val_best_acc_score: 0.8542; val_best_f1_score: 0.8633; train_kl_reg_loss: 156812.8620; train_edge_recon_loss: 2881503.5821; train_gene_expr_recon_loss: 35476971.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24797901.6794; train_global_loss: 63313189.9237; train_optim_loss: 63313189.9237; val_kl_reg_loss: 154275.2250; val_edge_recon_loss: 2897505.1833; val_gene_expr_recon_loss: 35254597.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24560900.8000; val_global_loss: 62867278.4000; val_optim_loss: 62867278.4000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9322; val_auprc_score: 0.9168; val_best_acc_score: 0.8597; val_best_f1_score: 0.8688; train_kl_reg_loss: 153741.2041; train_edge_recon_loss: 2859559.1412; train_gene_expr_recon_loss: 35365461.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24728558.5344; train_global_loss: 63107320.8244; train_optim_loss: 63107320.8244; val_kl_reg_loss: 153250.7469; val_edge_recon_loss: 2842342.0000; val_gene_expr_recon_loss: 35216250.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24685943.0667; val_global_loss: 62897786.4000; val_optim_loss: 62897786.4000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9403; val_auprc_score: 0.9273; val_best_acc_score: 0.8727; val_best_f1_score: 0.8808; train_kl_reg_loss: 150636.1800; train_edge_recon_loss: 2846511.2844; train_gene_expr_recon_loss: 35171341.1450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24615936.8855; train_global_loss: 62784425.5267; train_optim_loss: 62784425.5267; val_kl_reg_loss: 149652.1750; val_edge_recon_loss: 2824510.7833; val_gene_expr_recon_loss: 34904142.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24426904.5333; val_global_loss: 62305210.4000; val_optim_loss: 62305210.4000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9433; val_auprc_score: 0.9323; val_best_acc_score: 0.8731; val_best_f1_score: 0.8800; train_kl_reg_loss: 147765.6498; train_edge_recon_loss: 2823163.0897; train_gene_expr_recon_loss: 35084521.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24565013.7863; train_global_loss: 62620464.0000; train_optim_loss: 62620464.0000; val_kl_reg_loss: 145312.7854; val_edge_recon_loss: 2832284.5500; val_gene_expr_recon_loss: 35039066.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24598279.8667; val_global_loss: 62614943.4667; val_optim_loss: 62614943.4667
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9455; val_auprc_score: 0.9345; val_best_acc_score: 0.8806; val_best_f1_score: 0.8862; train_kl_reg_loss: 144072.3596; train_edge_recon_loss: 2815099.4332; train_gene_expr_recon_loss: 35035237.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24544605.3893; train_global_loss: 62539014.3206; train_optim_loss: 62539014.3206; val_kl_reg_loss: 139471.9552; val_edge_recon_loss: 2828839.0500; val_gene_expr_recon_loss: 34716349.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24317760.5333; val_global_loss: 62002421.0667; val_optim_loss: 62002421.0667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9493; val_auprc_score: 0.9405; val_best_acc_score: 0.8856; val_best_f1_score: 0.8902; train_kl_reg_loss: 141138.8375; train_edge_recon_loss: 2809558.3645; train_gene_expr_recon_loss: 34884364.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24435492.6260; train_global_loss: 62270553.9237; train_optim_loss: 62270553.9237; val_kl_reg_loss: 139895.8813; val_edge_recon_loss: 2816035.3167; val_gene_expr_recon_loss: 34681938.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24324188.2667; val_global_loss: 61962057.8667; val_optim_loss: 61962057.8667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9507; val_auprc_score: 0.9394; val_best_acc_score: 0.8859; val_best_f1_score: 0.8903; train_kl_reg_loss: 138728.0179; train_edge_recon_loss: 2795007.7195; train_gene_expr_recon_loss: 34834179.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24431629.6336; train_global_loss: 62199544.7023; train_optim_loss: 62199544.7023; val_kl_reg_loss: 133609.3474; val_edge_recon_loss: 2803826.2667; val_gene_expr_recon_loss: 34781543.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24349644.6667; val_global_loss: 62068624.5333; val_optim_loss: 62068624.5333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9543; val_auprc_score: 0.9456; val_best_acc_score: 0.8910; val_best_f1_score: 0.8949; train_kl_reg_loss: 136781.9118; train_edge_recon_loss: 2776967.7405; train_gene_expr_recon_loss: 34753708.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24381942.7176; train_global_loss: 62049400.8244; train_optim_loss: 62049400.8244; val_kl_reg_loss: 133239.4802; val_edge_recon_loss: 2797155.2167; val_gene_expr_recon_loss: 34640892.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24248796.8000; val_global_loss: 61820083.7333; val_optim_loss: 61820083.7333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9566; val_auprc_score: 0.9495; val_best_acc_score: 0.8918; val_best_f1_score: 0.8947; train_kl_reg_loss: 131940.1485; train_edge_recon_loss: 2780133.3435; train_gene_expr_recon_loss: 34751610.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24401383.5420; train_global_loss: 62065067.7863; train_optim_loss: 62065067.7863; val_kl_reg_loss: 130875.1083; val_edge_recon_loss: 2807065.5000; val_gene_expr_recon_loss: 34629981.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24260019.4667; val_global_loss: 61827941.8667; val_optim_loss: 61827941.8667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9565; val_auprc_score: 0.9460; val_best_acc_score: 0.8940; val_best_f1_score: 0.8979; train_kl_reg_loss: 129096.7241; train_edge_recon_loss: 2775014.5611; train_gene_expr_recon_loss: 34638085.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24314801.0534; train_global_loss: 61856998.1985; train_optim_loss: 61856998.1985; val_kl_reg_loss: 126334.7141; val_edge_recon_loss: 2796746.2167; val_gene_expr_recon_loss: 34656465.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24268220.0000; val_global_loss: 61847766.1333; val_optim_loss: 61847766.1333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9581; val_auprc_score: 0.9493; val_best_acc_score: 0.8961; val_best_f1_score: 0.8996; train_kl_reg_loss: 126509.7628; train_edge_recon_loss: 2774072.6221; train_gene_expr_recon_loss: 34621034.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24335184.1069; train_global_loss: 61856801.1298; train_optim_loss: 61856801.1298; val_kl_reg_loss: 125941.2109; val_edge_recon_loss: 2779473.9833; val_gene_expr_recon_loss: 34618969.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24299825.6000; val_global_loss: 61824209.8667; val_optim_loss: 61824209.8667
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9624; val_auprc_score: 0.9565; val_best_acc_score: 0.8971; val_best_f1_score: 0.9022; train_kl_reg_loss: 124251.1924; train_edge_recon_loss: 2761070.0267; train_gene_expr_recon_loss: 34572394.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24310207.1145; train_global_loss: 61767922.2901; train_optim_loss: 61767922.2901; val_kl_reg_loss: 123570.6740; val_edge_recon_loss: 2757243.8500; val_gene_expr_recon_loss: 34389596.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24188153.4667; val_global_loss: 61458564.2667; val_optim_loss: 61458564.2667
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9625; val_auprc_score: 0.9557; val_best_acc_score: 0.9003; val_best_f1_score: 0.9045; train_kl_reg_loss: 122867.4424; train_edge_recon_loss: 2757377.9179; train_gene_expr_recon_loss: 34521815.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24284578.8244; train_global_loss: 61686639.8779; train_optim_loss: 61686639.8779; val_kl_reg_loss: 120801.6573; val_edge_recon_loss: 2788318.8667; val_gene_expr_recon_loss: 34538584.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24332319.0667; val_global_loss: 61780024.5333; val_optim_loss: 61780024.5333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9643; val_auprc_score: 0.9578; val_best_acc_score: 0.9023; val_best_f1_score: 0.9067; train_kl_reg_loss: 119041.0308; train_edge_recon_loss: 2764952.2061; train_gene_expr_recon_loss: 34422708.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24226243.0534; train_global_loss: 61532945.1603; train_optim_loss: 61532945.1603; val_kl_reg_loss: 117235.9609; val_edge_recon_loss: 2764016.4167; val_gene_expr_recon_loss: 34259229.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24047725.2000; val_global_loss: 61188206.9333; val_optim_loss: 61188206.9333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9611; val_auprc_score: 0.9517; val_best_acc_score: 0.9022; val_best_f1_score: 0.9046; train_kl_reg_loss: 117059.4414; train_edge_recon_loss: 2751149.5496; train_gene_expr_recon_loss: 34423158.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24250952.9618; train_global_loss: 61542320.8855; train_optim_loss: 61542320.8855; val_kl_reg_loss: 116983.5411; val_edge_recon_loss: 2763916.2500; val_gene_expr_recon_loss: 34305338.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24104919.6000; val_global_loss: 61291157.0667; val_optim_loss: 61291157.0667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9657; val_auprc_score: 0.9587; val_best_acc_score: 0.9082; val_best_f1_score: 0.9111; train_kl_reg_loss: 116174.5261; train_edge_recon_loss: 2742452.6069; train_gene_expr_recon_loss: 34389196.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24216272.7939; train_global_loss: 61464096.1832; train_optim_loss: 61464096.1832; val_kl_reg_loss: 114777.9927; val_edge_recon_loss: 2770299.0167; val_gene_expr_recon_loss: 34408483.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24148696.2667; val_global_loss: 61442256.2667; val_optim_loss: 61442256.2667
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9574; val_auprc_score: 0.9457; val_best_acc_score: 0.8976; val_best_f1_score: 0.9028; train_kl_reg_loss: 131322.8822; train_edge_recon_loss: 2860139.7863; train_gene_expr_recon_loss: 37430966.2901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24901237.8168; train_global_loss: 65323666.9313; train_optim_loss: 65323666.9313; val_kl_reg_loss: 40551.2247; val_edge_recon_loss: 2837748.2333; val_gene_expr_recon_loss: 36801866.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24704371.0667; val_global_loss: 64384537.3333; val_optim_loss: 64384537.3333
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9581; val_auprc_score: 0.9460; val_best_acc_score: 0.8964; val_best_f1_score: 0.8992; train_kl_reg_loss: 127610.3268; train_edge_recon_loss: 2795131.6660; train_gene_expr_recon_loss: 36767524.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24748855.5267; train_global_loss: 64439122.2595; train_optim_loss: 64439122.2595; val_kl_reg_loss: 46164.4750; val_edge_recon_loss: 2797902.2167; val_gene_expr_recon_loss: 36405740.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24527069.0667; val_global_loss: 63776876.5333; val_optim_loss: 63776876.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9595; val_auprc_score: 0.9490; val_best_acc_score: 0.9027; val_best_f1_score: 0.9061; train_kl_reg_loss: 117416.3862; train_edge_recon_loss: 2781916.9008; train_gene_expr_recon_loss: 36586945.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24688513.8626; train_global_loss: 64174792.9160; train_optim_loss: 64174792.9160; val_kl_reg_loss: 48249.8268; val_edge_recon_loss: 2776863.0500; val_gene_expr_recon_loss: 36418604.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24507956.1333; val_global_loss: 63751673.3333; val_optim_loss: 63751673.3333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9598; val_auprc_score: 0.9494; val_best_acc_score: 0.8998; val_best_f1_score: 0.9037; train_kl_reg_loss: 116385.7026; train_edge_recon_loss: 2778487.0859; train_gene_expr_recon_loss: 36577998.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24699667.9084; train_global_loss: 64172539.0229; train_optim_loss: 64172539.0229; val_kl_reg_loss: 49559.6469; val_edge_recon_loss: 2756646.9667; val_gene_expr_recon_loss: 36514787.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24606070.9333; val_global_loss: 63927065.0667; val_optim_loss: 63927065.0667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9599; val_auprc_score: 0.9509; val_best_acc_score: 0.8983; val_best_f1_score: 0.9011; train_kl_reg_loss: 114516.1736; train_edge_recon_loss: 2774181.2519; train_gene_expr_recon_loss: 36550295.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24688069.9695; train_global_loss: 64127062.4733; train_optim_loss: 64127062.4733; val_kl_reg_loss: 49611.5260; val_edge_recon_loss: 2786039.0167; val_gene_expr_recon_loss: 36562951.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24642863.2000; val_global_loss: 64041465.0667; val_optim_loss: 64041465.0667
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9601; val_auprc_score: 0.9500; val_best_acc_score: 0.9010; val_best_f1_score: 0.9044; train_kl_reg_loss: 112717.5420; train_edge_recon_loss: 2765765.8130; train_gene_expr_recon_loss: 36532521.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 24675863.0840; train_global_loss: 64086867.6031; train_optim_loss: 64086867.6031; val_kl_reg_loss: 50511.3695; val_edge_recon_loss: 2772858.6667; val_gene_expr_recon_loss: 36399733.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 24576719.3333; val_global_loss: 63799823.2000; val_optim_loss: 63799823.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 23 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9596
val AUPRC score: 0.9484
val best accuracy score: 0.9007
val best F1 score: 0.9050
val target rna MSE score: 1.4235
val source rna MSE score: 32.4264
val target atac MSE score: 0.3492
val source atac MSE score: 3.0159
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
