[True]
Run timestamp: 27072023_033509_141.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_141']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8745; val_auprc_score: 0.9755; val_best_acc_score: 0.8537; val_best_f1_score: 0.9211; train_kl_reg_loss: 424987.4558; train_edge_recon_loss: 10754479.7860; train_gene_expr_recon_loss: 26127602.8000; train_masked_gp_l1_reg_loss: 8188.2641; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37315258.3628; train_optim_loss: 37315258.3628; val_kl_reg_loss: 294078.0859; val_edge_recon_loss: 11882543.8750; val_gene_expr_recon_loss: 21379077.9167; val_masked_gp_l1_reg_loss: 8690.9492; val_group_lasso_reg_loss: 0.0000; val_global_loss: 33564391.0000; val_optim_loss: 33564391.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8503; val_auprc_score: 0.9707; val_best_acc_score: 0.8637; val_best_f1_score: 0.9261; train_kl_reg_loss: 336443.7246; train_edge_recon_loss: 10785939.0744; train_gene_expr_recon_loss: 21100456.3256; train_masked_gp_l1_reg_loss: 9006.2597; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32231845.3860; train_optim_loss: 32231845.3860; val_kl_reg_loss: 264860.8457; val_edge_recon_loss: 11756310.5833; val_gene_expr_recon_loss: 20762216.4167; val_masked_gp_l1_reg_loss: 9338.3516; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32792726.0833; val_optim_loss: 32792726.0833
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8363; val_auprc_score: 0.9678; val_best_acc_score: 0.8538; val_best_f1_score: 0.9207; train_kl_reg_loss: 248955.0352; train_edge_recon_loss: 10498957.7907; train_gene_expr_recon_loss: 20240955.7767; train_masked_gp_l1_reg_loss: 9713.3609; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30998581.8977; train_optim_loss: 30998581.8977; val_kl_reg_loss: 17389.1875; val_edge_recon_loss: 12182615.1667; val_gene_expr_recon_loss: 15374132.0000; val_masked_gp_l1_reg_loss: 10457.8174; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27584594.4167; val_optim_loss: 27584594.4167
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7954; val_auprc_score: 0.9593; val_best_acc_score: 0.8616; val_best_f1_score: 0.9251; train_kl_reg_loss: 131455.5434; train_edge_recon_loss: 10485587.4837; train_gene_expr_recon_loss: 10318966.9581; train_masked_gp_l1_reg_loss: 11511.5652; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20947521.5907; train_optim_loss: 20947521.5907; val_kl_reg_loss: 146163.7428; val_edge_recon_loss: 11555532.1667; val_gene_expr_recon_loss: 9595903.5417; val_masked_gp_l1_reg_loss: 11643.4688; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21309243.4167; val_optim_loss: 21309243.4167
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8088; val_auprc_score: 0.9574; val_best_acc_score: 0.8737; val_best_f1_score: 0.9303; train_kl_reg_loss: 124057.1464; train_edge_recon_loss: 10265324.7860; train_gene_expr_recon_loss: 9472111.2977; train_masked_gp_l1_reg_loss: 11877.3125; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19873370.4465; train_optim_loss: 19873370.4465; val_kl_reg_loss: 83298.6898; val_edge_recon_loss: 10619599.0833; val_gene_expr_recon_loss: 9314261.8750; val_masked_gp_l1_reg_loss: 12124.5957; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20029283.6667; val_optim_loss: 20029283.6667
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8377; val_auprc_score: 0.9629; val_best_acc_score: 0.8825; val_best_f1_score: 0.9347; train_kl_reg_loss: 111160.1201; train_edge_recon_loss: 9504081.7535; train_gene_expr_recon_loss: 9195925.9488; train_masked_gp_l1_reg_loss: 12390.6947; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18823558.5395; train_optim_loss: 18823558.5395; val_kl_reg_loss: 137828.0527; val_edge_recon_loss: 9211822.0417; val_gene_expr_recon_loss: 9055831.3333; val_masked_gp_l1_reg_loss: 12686.0010; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18418167.6667; val_optim_loss: 18418167.6667
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8406; val_auprc_score: 0.9618; val_best_acc_score: 0.8844; val_best_f1_score: 0.9353; train_kl_reg_loss: 161234.8656; train_edge_recon_loss: 8987860.5930; train_gene_expr_recon_loss: 8943223.4279; train_masked_gp_l1_reg_loss: 12991.2999; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18105310.3814; train_optim_loss: 18105310.3814; val_kl_reg_loss: 159256.7272; val_edge_recon_loss: 9192594.0000; val_gene_expr_recon_loss: 8823681.5417; val_masked_gp_l1_reg_loss: 13287.7520; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18188820.0000; val_optim_loss: 18188820.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8432; val_auprc_score: 0.9628; val_best_acc_score: 0.8883; val_best_f1_score: 0.9379; train_kl_reg_loss: 160918.3677; train_edge_recon_loss: 8760054.4070; train_gene_expr_recon_loss: 8739578.9442; train_masked_gp_l1_reg_loss: 13536.0548; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17674087.7674; train_optim_loss: 17674087.7674; val_kl_reg_loss: 142274.8867; val_edge_recon_loss: 8739833.7083; val_gene_expr_recon_loss: 8648229.5417; val_masked_gp_l1_reg_loss: 13790.9229; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17544128.2917; val_optim_loss: 17544128.2917
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8506; val_auprc_score: 0.9628; val_best_acc_score: 0.8946; val_best_f1_score: 0.9407; train_kl_reg_loss: 146255.0521; train_edge_recon_loss: 8614855.0116; train_gene_expr_recon_loss: 8582879.9535; train_masked_gp_l1_reg_loss: 14033.9966; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17358023.9721; train_optim_loss: 17358023.9721; val_kl_reg_loss: 127845.7757; val_edge_recon_loss: 8768192.8750; val_gene_expr_recon_loss: 8519133.0625; val_masked_gp_l1_reg_loss: 14292.8359; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17429464.0833; val_optim_loss: 17429464.0833
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8675; val_auprc_score: 0.9666; val_best_acc_score: 0.9014; val_best_f1_score: 0.9443; train_kl_reg_loss: 131683.6758; train_edge_recon_loss: 8331355.6163; train_gene_expr_recon_loss: 8449539.3116; train_masked_gp_l1_reg_loss: 14580.0243; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16927158.5953; train_optim_loss: 16927158.5953; val_kl_reg_loss: 124486.7943; val_edge_recon_loss: 8651891.9167; val_gene_expr_recon_loss: 8376037.0208; val_masked_gp_l1_reg_loss: 14863.7744; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17167279.8333; val_optim_loss: 17167279.8333
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8790; val_auprc_score: 0.9704; val_best_acc_score: 0.9056; val_best_f1_score: 0.9465; train_kl_reg_loss: 130204.1623; train_edge_recon_loss: 8260492.1372; train_gene_expr_recon_loss: 8303636.8047; train_masked_gp_l1_reg_loss: 15121.0645; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16709454.1767; train_optim_loss: 16709454.1767; val_kl_reg_loss: 129035.9141; val_edge_recon_loss: 8408716.3333; val_gene_expr_recon_loss: 8230632.0625; val_masked_gp_l1_reg_loss: 15365.7676; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16783750.4583; val_optim_loss: 16783750.4583
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8809; val_auprc_score: 0.9716; val_best_acc_score: 0.9041; val_best_f1_score: 0.9455; train_kl_reg_loss: 122417.7020; train_edge_recon_loss: 8259856.6442; train_gene_expr_recon_loss: 8170920.4884; train_masked_gp_l1_reg_loss: 15598.3126; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16568793.1349; train_optim_loss: 16568793.1349; val_kl_reg_loss: 114485.2747; val_edge_recon_loss: 8463762.0833; val_gene_expr_recon_loss: 8112110.8542; val_masked_gp_l1_reg_loss: 15814.2266; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16706172.0833; val_optim_loss: 16706172.0833
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8898; val_auprc_score: 0.9748; val_best_acc_score: 0.9050; val_best_f1_score: 0.9459; train_kl_reg_loss: 114072.3408; train_edge_recon_loss: 8175540.6326; train_gene_expr_recon_loss: 8060750.4419; train_masked_gp_l1_reg_loss: 16018.8600; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16366382.3023; train_optim_loss: 16366382.3023; val_kl_reg_loss: 104060.5296; val_edge_recon_loss: 8318665.7917; val_gene_expr_recon_loss: 8003278.8958; val_masked_gp_l1_reg_loss: 16204.5820; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16442209.8750; val_optim_loss: 16442209.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8998; val_auprc_score: 0.9772; val_best_acc_score: 0.9039; val_best_f1_score: 0.9453; train_kl_reg_loss: 100361.1555; train_edge_recon_loss: 8179108.4023; train_gene_expr_recon_loss: 7956017.3791; train_masked_gp_l1_reg_loss: 16390.1088; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16251877.0093; train_optim_loss: 16251877.0093; val_kl_reg_loss: 93030.4704; val_edge_recon_loss: 8262654.0625; val_gene_expr_recon_loss: 7903021.2292; val_masked_gp_l1_reg_loss: 16570.5625; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16275276.5000; val_optim_loss: 16275276.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9040; val_auprc_score: 0.9779; val_best_acc_score: 0.9076; val_best_f1_score: 0.9473; train_kl_reg_loss: 87963.0902; train_edge_recon_loss: 8004477.8651; train_gene_expr_recon_loss: 7867780.5047; train_masked_gp_l1_reg_loss: 16735.4957; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15976957.0047; train_optim_loss: 15976957.0047; val_kl_reg_loss: 81919.3415; val_edge_recon_loss: 8393470.7500; val_gene_expr_recon_loss: 7821170.6667; val_masked_gp_l1_reg_loss: 16892.5273; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16313453.6667; val_optim_loss: 16313453.6667
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9149; val_auprc_score: 0.9806; val_best_acc_score: 0.9118; val_best_f1_score: 0.9493; train_kl_reg_loss: 78488.4484; train_edge_recon_loss: 8015632.5070; train_gene_expr_recon_loss: 7783897.8488; train_masked_gp_l1_reg_loss: 17046.6411; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15895065.3860; train_optim_loss: 15895065.3860; val_kl_reg_loss: 71375.0371; val_edge_recon_loss: 8362427.6042; val_gene_expr_recon_loss: 7733184.0417; val_masked_gp_l1_reg_loss: 17192.1602; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16184178.5833; val_optim_loss: 16184178.5833
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9176; val_auprc_score: 0.9823; val_best_acc_score: 0.9146; val_best_f1_score: 0.9515; train_kl_reg_loss: 70316.9983; train_edge_recon_loss: 7878263.8233; train_gene_expr_recon_loss: 7704377.0256; train_masked_gp_l1_reg_loss: 17315.1453; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15670272.9581; train_optim_loss: 15670272.9581; val_kl_reg_loss: 64175.6986; val_edge_recon_loss: 7994124.2292; val_gene_expr_recon_loss: 7664255.1667; val_masked_gp_l1_reg_loss: 17439.3340; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15739994.2917; val_optim_loss: 15739994.2917
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9220; val_auprc_score: 0.9825; val_best_acc_score: 0.9196; val_best_f1_score: 0.9541; train_kl_reg_loss: 63079.6355; train_edge_recon_loss: 7906746.4163; train_gene_expr_recon_loss: 7623596.4581; train_masked_gp_l1_reg_loss: 17552.0918; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15610974.6093; train_optim_loss: 15610974.6093; val_kl_reg_loss: 55628.1481; val_edge_recon_loss: 7892930.8125; val_gene_expr_recon_loss: 7603218.5417; val_masked_gp_l1_reg_loss: 17660.3086; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15569437.5000; val_optim_loss: 15569437.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9293; val_auprc_score: 0.9845; val_best_acc_score: 0.9170; val_best_f1_score: 0.9525; train_kl_reg_loss: 56919.3569; train_edge_recon_loss: 7891582.2442; train_gene_expr_recon_loss: 7559533.4070; train_masked_gp_l1_reg_loss: 17714.8641; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15525749.8837; train_optim_loss: 15525749.8837; val_kl_reg_loss: 50750.7134; val_edge_recon_loss: 8292658.3750; val_gene_expr_recon_loss: 7516904.3125; val_masked_gp_l1_reg_loss: 17771.8027; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15878085.2083; val_optim_loss: 15878085.2083
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9345; val_auprc_score: 0.9842; val_best_acc_score: 0.9272; val_best_f1_score: 0.9580; train_kl_reg_loss: 51332.1292; train_edge_recon_loss: 7858545.9140; train_gene_expr_recon_loss: 7497683.3651; train_masked_gp_l1_reg_loss: 17792.9556; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15425354.3953; train_optim_loss: 15425354.3953; val_kl_reg_loss: 46836.7650; val_edge_recon_loss: 8121463.2500; val_gene_expr_recon_loss: 7458641.2708; val_masked_gp_l1_reg_loss: 17793.6328; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15644735.3333; val_optim_loss: 15644735.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9374; val_auprc_score: 0.9865; val_best_acc_score: 0.9267; val_best_f1_score: 0.9577; train_kl_reg_loss: 46619.6409; train_edge_recon_loss: 7853464.9884; train_gene_expr_recon_loss: 7443008.7000; train_masked_gp_l1_reg_loss: 17777.9947; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15360871.3302; train_optim_loss: 15360871.3302; val_kl_reg_loss: 41863.0099; val_edge_recon_loss: 7981763.3333; val_gene_expr_recon_loss: 7404642.9167; val_masked_gp_l1_reg_loss: 17744.3281; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15446013.3750; val_optim_loss: 15446013.3750
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9401; val_auprc_score: 0.9860; val_best_acc_score: 0.9321; val_best_f1_score: 0.9608; train_kl_reg_loss: 43283.2186; train_edge_recon_loss: 7781486.5628; train_gene_expr_recon_loss: 7395340.1209; train_masked_gp_l1_reg_loss: 17650.9119; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15237760.8419; train_optim_loss: 15237760.8419; val_kl_reg_loss: 39986.8218; val_edge_recon_loss: 7843816.4583; val_gene_expr_recon_loss: 7364841.1042; val_masked_gp_l1_reg_loss: 17574.7109; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15266219.5417; val_optim_loss: 15266219.5417
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9422; val_auprc_score: 0.9867; val_best_acc_score: 0.9327; val_best_f1_score: 0.9607; train_kl_reg_loss: 41214.8092; train_edge_recon_loss: 7855893.1558; train_gene_expr_recon_loss: 7347406.5023; train_masked_gp_l1_reg_loss: 17479.4406; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15261993.9163; train_optim_loss: 15261993.9163; val_kl_reg_loss: 38436.5654; val_edge_recon_loss: 8208122.5000; val_gene_expr_recon_loss: 7327273.1042; val_masked_gp_l1_reg_loss: 17371.7148; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15591204.1250; val_optim_loss: 15591204.1250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9402; val_auprc_score: 0.9860; val_best_acc_score: 0.9362; val_best_f1_score: 0.9631; train_kl_reg_loss: 39099.2159; train_edge_recon_loss: 7825527.0209; train_gene_expr_recon_loss: 7309935.1558; train_masked_gp_l1_reg_loss: 17245.5012; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15191806.9209; train_optim_loss: 15191806.9209; val_kl_reg_loss: 37132.1156; val_edge_recon_loss: 8026111.0417; val_gene_expr_recon_loss: 7293037.3542; val_masked_gp_l1_reg_loss: 17098.1953; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15373378.3333; val_optim_loss: 15373378.3333
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9433; val_auprc_score: 0.9874; val_best_acc_score: 0.9321; val_best_f1_score: 0.9606; train_kl_reg_loss: 38148.4658; train_edge_recon_loss: 7728419.7977; train_gene_expr_recon_loss: 7266036.1814; train_masked_gp_l1_reg_loss: 16954.7684; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15049559.2047; train_optim_loss: 15049559.2047; val_kl_reg_loss: 36698.3687; val_edge_recon_loss: 7921393.0417; val_gene_expr_recon_loss: 7265398.6458; val_masked_gp_l1_reg_loss: 16798.9688; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15240289.0417; val_optim_loss: 15240289.0417
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9491; val_auprc_score: 0.9875; val_best_acc_score: 0.9381; val_best_f1_score: 0.9642; train_kl_reg_loss: 36589.0647; train_edge_recon_loss: 7776557.1628; train_gene_expr_recon_loss: 7382937.3140; train_masked_gp_l1_reg_loss: 16833.2640; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15212916.8140; train_optim_loss: 15212916.8140; val_kl_reg_loss: 12794.8258; val_edge_recon_loss: 7991892.3958; val_gene_expr_recon_loss: 7332889.9375; val_masked_gp_l1_reg_loss: 16709.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15354285.9583; val_optim_loss: 15354285.9583
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9518; val_auprc_score: 0.9890; val_best_acc_score: 0.9421; val_best_f1_score: 0.9665; train_kl_reg_loss: 35225.2431; train_edge_recon_loss: 7750192.4093; train_gene_expr_recon_loss: 7329303.4116; train_masked_gp_l1_reg_loss: 16532.5792; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15131253.5860; train_optim_loss: 15131253.5860; val_kl_reg_loss: 12045.5042; val_edge_recon_loss: 7921418.4375; val_gene_expr_recon_loss: 7302787.0000; val_masked_gp_l1_reg_loss: 16313.0322; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15252564.0000; val_optim_loss: 15252564.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9514; val_auprc_score: 0.9898; val_best_acc_score: 0.9452; val_best_f1_score: 0.9687; train_kl_reg_loss: 32925.8918; train_edge_recon_loss: 7595123.1372; train_gene_expr_recon_loss: 7299493.3093; train_masked_gp_l1_reg_loss: 16114.2893; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14943656.5814; train_optim_loss: 14943656.5814; val_kl_reg_loss: 11549.9981; val_edge_recon_loss: 7445731.0417; val_gene_expr_recon_loss: 7295889.2083; val_masked_gp_l1_reg_loss: 15891.0664; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14769061.1667; val_optim_loss: 14769061.1667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9554; val_auprc_score: 0.9900; val_best_acc_score: 0.9477; val_best_f1_score: 0.9696; train_kl_reg_loss: 30374.0559; train_edge_recon_loss: 7788842.1767; train_gene_expr_recon_loss: 7280097.6767; train_masked_gp_l1_reg_loss: 15693.5444; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15115007.4884; train_optim_loss: 15115007.4884; val_kl_reg_loss: 10905.7292; val_edge_recon_loss: 7785872.0833; val_gene_expr_recon_loss: 7269856.9583; val_masked_gp_l1_reg_loss: 15481.2393; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15082115.7083; val_optim_loss: 15082115.7083
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9523; val_auprc_score: 0.9885; val_best_acc_score: 0.9463; val_best_f1_score: 0.9689; train_kl_reg_loss: 29218.3280; train_edge_recon_loss: 7667632.8791; train_gene_expr_recon_loss: 7259352.0884; train_masked_gp_l1_reg_loss: 15259.9288; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14971463.1860; train_optim_loss: 14971463.1860; val_kl_reg_loss: 10785.5399; val_edge_recon_loss: 7751846.3958; val_gene_expr_recon_loss: 7239502.1458; val_masked_gp_l1_reg_loss: 15019.4287; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15017153.1250; val_optim_loss: 15017153.1250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9590; val_auprc_score: 0.9904; val_best_acc_score: 0.9475; val_best_f1_score: 0.9695; train_kl_reg_loss: 27923.3268; train_edge_recon_loss: 7725118.4953; train_gene_expr_recon_loss: 7242042.1163; train_masked_gp_l1_reg_loss: 14811.1587; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15009895.0744; train_optim_loss: 15009895.0744; val_kl_reg_loss: 10502.1483; val_edge_recon_loss: 7864456.7083; val_gene_expr_recon_loss: 7228001.3125; val_masked_gp_l1_reg_loss: 14592.2305; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15117552.1250; val_optim_loss: 15117552.1250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9553; val_auprc_score: 0.9890; val_best_acc_score: 0.9483; val_best_f1_score: 0.9700; train_kl_reg_loss: 27641.4310; train_edge_recon_loss: 7636239.8837; train_gene_expr_recon_loss: 7226274.6372; train_masked_gp_l1_reg_loss: 14360.2967; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14904516.2698; train_optim_loss: 14904516.2698; val_kl_reg_loss: 10220.6332; val_edge_recon_loss: 7993072.6667; val_gene_expr_recon_loss: 7217992.0417; val_masked_gp_l1_reg_loss: 14121.3828; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15235406.3333; val_optim_loss: 15235406.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9563; val_auprc_score: 0.9892; val_best_acc_score: 0.9510; val_best_f1_score: 0.9717; train_kl_reg_loss: 27558.8373; train_edge_recon_loss: 7581461.5953; train_gene_expr_recon_loss: 7197326.9860; train_masked_gp_l1_reg_loss: 14096.4821; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14820443.8791; train_optim_loss: 14820443.8791; val_kl_reg_loss: 10394.3730; val_edge_recon_loss: 7729411.5833; val_gene_expr_recon_loss: 7192343.5208; val_masked_gp_l1_reg_loss: 14076.7891; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14946226.5417; val_optim_loss: 14946226.5417
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9557; val_auprc_score: 0.9883; val_best_acc_score: 0.9500; val_best_f1_score: 0.9710; train_kl_reg_loss: 27326.9064; train_edge_recon_loss: 7734898.8581; train_gene_expr_recon_loss: 7195596.5349; train_masked_gp_l1_reg_loss: 14060.4415; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14971882.6977; train_optim_loss: 14971882.6977; val_kl_reg_loss: 10429.2647; val_edge_recon_loss: 7976049.0000; val_gene_expr_recon_loss: 7188695.3542; val_masked_gp_l1_reg_loss: 14042.0410; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15189215.6250; val_optim_loss: 15189215.6250
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9608; val_auprc_score: 0.9910; val_best_acc_score: 0.9479; val_best_f1_score: 0.9697; train_kl_reg_loss: 27270.9425; train_edge_recon_loss: 7721280.1233; train_gene_expr_recon_loss: 7195023.7372; train_masked_gp_l1_reg_loss: 14020.2923; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14957595.1116; train_optim_loss: 14957595.1116; val_kl_reg_loss: 10318.5958; val_edge_recon_loss: 7933585.6667; val_gene_expr_recon_loss: 7197960.7708; val_masked_gp_l1_reg_loss: 14000.0020; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15155865.0000; val_optim_loss: 15155865.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9628; val_auprc_score: 0.9908; val_best_acc_score: 0.9528; val_best_f1_score: 0.9726; train_kl_reg_loss: 26699.3027; train_edge_recon_loss: 7720562.6419; train_gene_expr_recon_loss: 7191831.6535; train_masked_gp_l1_reg_loss: 13976.6539; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14953070.2372; train_optim_loss: 14953070.2372; val_kl_reg_loss: 10311.9558; val_edge_recon_loss: 7702447.3750; val_gene_expr_recon_loss: 7197752.5625; val_masked_gp_l1_reg_loss: 13954.2051; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14924465.9167; val_optim_loss: 14924465.9167

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 25 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
Val AUROC score: 0.9514
Val AUPRC score: 0.9881
Val best accuracy score: 0.9409
Val best F1 score: 0.9655
Val gene expr MSE score: 63920.8905
Val cat covariate0 mean sim diff: -0.0032

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
