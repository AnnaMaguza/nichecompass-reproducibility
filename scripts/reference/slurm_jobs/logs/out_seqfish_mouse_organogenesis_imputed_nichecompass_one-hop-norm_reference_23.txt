[True]
Run timestamp: 01082023_070504_23.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_23']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9079; val_auprc_score: 0.9820; val_best_acc_score: 0.8518; val_best_f1_score: 0.9199; train_kl_reg_loss: 157091.1159; train_edge_recon_loss: 11841.3477; train_gene_expr_recon_loss: 5159033.9815; train_masked_gp_l1_reg_loss: 12942.9696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58683.3053; train_global_loss: 5399592.7500; train_optim_loss: 5399592.7500; val_kl_reg_loss: 143415.1276; val_edge_recon_loss: 12047.3394; val_gene_expr_recon_loss: 4621109.1667; val_masked_gp_l1_reg_loss: 12749.3467; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54332.9766; val_global_loss: 4843654.0833; val_optim_loss: 4843654.0833
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8860; val_auprc_score: 0.9767; val_best_acc_score: 0.8463; val_best_f1_score: 0.9167; train_kl_reg_loss: 117744.0194; train_edge_recon_loss: 11986.6390; train_gene_expr_recon_loss: 4088985.8333; train_masked_gp_l1_reg_loss: 12149.2392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50847.1117; train_global_loss: 4281712.8981; train_optim_loss: 4281712.8981; val_kl_reg_loss: 94173.4896; val_edge_recon_loss: 12504.5399; val_gene_expr_recon_loss: 3453775.4167; val_masked_gp_l1_reg_loss: 11572.4912; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47496.7109; val_global_loss: 3619522.7083; val_optim_loss: 3619522.7083
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8684; val_auprc_score: 0.9745; val_best_acc_score: 0.8647; val_best_f1_score: 0.9265; train_kl_reg_loss: 87398.0919; train_edge_recon_loss: 11889.0035; train_gene_expr_recon_loss: 3088483.0324; train_masked_gp_l1_reg_loss: 11155.1490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44720.9649; train_global_loss: 3243646.2222; train_optim_loss: 3243646.2222; val_kl_reg_loss: 69187.8451; val_edge_recon_loss: 11854.5090; val_gene_expr_recon_loss: 2619647.6667; val_masked_gp_l1_reg_loss: 10789.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42079.1797; val_global_loss: 2753558.5417; val_optim_loss: 2753558.5417
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8440; val_auprc_score: 0.9672; val_best_acc_score: 0.8701; val_best_f1_score: 0.9273; train_kl_reg_loss: 76301.6547; train_edge_recon_loss: 11787.0547; train_gene_expr_recon_loss: 2811011.7130; train_masked_gp_l1_reg_loss: 10638.9447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40001.5367; train_global_loss: 2949740.8935; train_optim_loss: 2949740.8935; val_kl_reg_loss: 70184.2682; val_edge_recon_loss: 12184.4679; val_gene_expr_recon_loss: 2800818.6667; val_masked_gp_l1_reg_loss: 10413.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38093.9688; val_global_loss: 2931694.6250; val_optim_loss: 2931694.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8450; val_auprc_score: 0.9674; val_best_acc_score: 0.8729; val_best_f1_score: 0.9305; train_kl_reg_loss: 65725.2726; train_edge_recon_loss: 11818.2312; train_gene_expr_recon_loss: 2775481.4769; train_masked_gp_l1_reg_loss: 10284.8734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36743.4813; train_global_loss: 2900053.3287; train_optim_loss: 2900053.3287; val_kl_reg_loss: 57424.0729; val_edge_recon_loss: 11809.0664; val_gene_expr_recon_loss: 2751349.2083; val_masked_gp_l1_reg_loss: 10198.4268; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35590.8281; val_global_loss: 2866371.5833; val_optim_loss: 2866371.5833
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8431; val_auprc_score: 0.9679; val_best_acc_score: 0.8766; val_best_f1_score: 0.9321; train_kl_reg_loss: 47596.0061; train_edge_recon_loss: 11824.5003; train_gene_expr_recon_loss: 2440160.2778; train_masked_gp_l1_reg_loss: 10337.8747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34971.5752; train_global_loss: 2544890.2130; train_optim_loss: 2544890.2130; val_kl_reg_loss: 44712.6608; val_edge_recon_loss: 11711.3877; val_gene_expr_recon_loss: 2230896.8750; val_masked_gp_l1_reg_loss: 10451.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34577.3398; val_global_loss: 2332349.9167; val_optim_loss: 2332349.9167
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8505; val_auprc_score: 0.9678; val_best_acc_score: 0.8735; val_best_f1_score: 0.9300; train_kl_reg_loss: 45520.7147; train_edge_recon_loss: 11804.1668; train_gene_expr_recon_loss: 2207067.2824; train_masked_gp_l1_reg_loss: 10356.2797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34331.4964; train_global_loss: 2309079.9259; train_optim_loss: 2309079.9259; val_kl_reg_loss: 42973.6387; val_edge_recon_loss: 11899.9372; val_gene_expr_recon_loss: 2185444.1250; val_masked_gp_l1_reg_loss: 10294.6924; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34072.1250; val_global_loss: 2284684.6667; val_optim_loss: 2284684.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8629; val_auprc_score: 0.9722; val_best_acc_score: 0.8763; val_best_f1_score: 0.9320; train_kl_reg_loss: 43161.8364; train_edge_recon_loss: 11786.3569; train_gene_expr_recon_loss: 2174407.1111; train_masked_gp_l1_reg_loss: 10279.1906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33811.9813; train_global_loss: 2273446.4722; train_optim_loss: 2273446.4722; val_kl_reg_loss: 40411.7227; val_edge_recon_loss: 11575.1880; val_gene_expr_recon_loss: 2159125.9583; val_masked_gp_l1_reg_loss: 10281.4111; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33536.7930; val_global_loss: 2254931.1250; val_optim_loss: 2254931.1250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8716; val_auprc_score: 0.9735; val_best_acc_score: 0.8776; val_best_f1_score: 0.9322; train_kl_reg_loss: 40798.6339; train_edge_recon_loss: 11759.8778; train_gene_expr_recon_loss: 2147994.0787; train_masked_gp_l1_reg_loss: 10305.1043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33262.9672; train_global_loss: 2244120.6481; train_optim_loss: 2244120.6481; val_kl_reg_loss: 38346.5397; val_edge_recon_loss: 11711.3429; val_gene_expr_recon_loss: 2135981.9583; val_masked_gp_l1_reg_loss: 10342.9697; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32975.3594; val_global_loss: 2229358.0833; val_optim_loss: 2229358.0833
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8792; val_auprc_score: 0.9754; val_best_acc_score: 0.8788; val_best_f1_score: 0.9328; train_kl_reg_loss: 38816.7551; train_edge_recon_loss: 11693.7775; train_gene_expr_recon_loss: 2124519.8287; train_masked_gp_l1_reg_loss: 10392.3842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32690.4128; train_global_loss: 2218113.1759; train_optim_loss: 2218113.1759; val_kl_reg_loss: 36384.4186; val_edge_recon_loss: 11441.3893; val_gene_expr_recon_loss: 2117000.0417; val_masked_gp_l1_reg_loss: 10448.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32393.6230; val_global_loss: 2207667.7917; val_optim_loss: 2207667.7917
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8841; val_auprc_score: 0.9758; val_best_acc_score: 0.8827; val_best_f1_score: 0.9338; train_kl_reg_loss: 37025.9769; train_edge_recon_loss: 11591.4226; train_gene_expr_recon_loss: 2102895.7639; train_masked_gp_l1_reg_loss: 10509.2808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32105.2734; train_global_loss: 2194127.7083; train_optim_loss: 2194127.7083; val_kl_reg_loss: 34942.3021; val_edge_recon_loss: 11543.8898; val_gene_expr_recon_loss: 2093806.9583; val_masked_gp_l1_reg_loss: 10575.9863; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31806.1895; val_global_loss: 2182675.3750; val_optim_loss: 2182675.3750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8889; val_auprc_score: 0.9766; val_best_acc_score: 0.8796; val_best_f1_score: 0.9312; train_kl_reg_loss: 35472.2436; train_edge_recon_loss: 11777.0493; train_gene_expr_recon_loss: 2082484.8310; train_masked_gp_l1_reg_loss: 10640.7344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31518.3806; train_global_loss: 2171893.2546; train_optim_loss: 2171893.2546; val_kl_reg_loss: 33581.0768; val_edge_recon_loss: 11916.6670; val_gene_expr_recon_loss: 2071677.0000; val_masked_gp_l1_reg_loss: 10712.0986; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31221.3398; val_global_loss: 2159108.0000; val_optim_loss: 2159108.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8866; val_auprc_score: 0.9767; val_best_acc_score: 0.8826; val_best_f1_score: 0.9344; train_kl_reg_loss: 34120.7640; train_edge_recon_loss: 11519.6765; train_gene_expr_recon_loss: 2063353.3472; train_masked_gp_l1_reg_loss: 10780.1546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30935.0116; train_global_loss: 2150708.9676; train_optim_loss: 2150708.9676; val_kl_reg_loss: 32393.2721; val_edge_recon_loss: 11487.9220; val_gene_expr_recon_loss: 2053706.4583; val_masked_gp_l1_reg_loss: 10853.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30637.7031; val_global_loss: 2139078.8333; val_optim_loss: 2139078.8333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9014; val_auprc_score: 0.9797; val_best_acc_score: 0.8863; val_best_f1_score: 0.9358; train_kl_reg_loss: 32953.1564; train_edge_recon_loss: 11554.8208; train_gene_expr_recon_loss: 2044361.4259; train_masked_gp_l1_reg_loss: 10922.2948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30352.3903; train_global_loss: 2130144.0926; train_optim_loss: 2130144.0926; val_kl_reg_loss: 31427.5098; val_edge_recon_loss: 11450.5124; val_gene_expr_recon_loss: 2036058.3125; val_masked_gp_l1_reg_loss: 10994.8770; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30054.7344; val_global_loss: 2119985.8750; val_optim_loss: 2119985.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8973; val_auprc_score: 0.9793; val_best_acc_score: 0.8861; val_best_f1_score: 0.9356; train_kl_reg_loss: 31881.6620; train_edge_recon_loss: 11544.5723; train_gene_expr_recon_loss: 2027233.5648; train_masked_gp_l1_reg_loss: 11066.8026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29767.2404; train_global_loss: 2111493.8472; train_optim_loss: 2111493.8472; val_kl_reg_loss: 30419.2555; val_edge_recon_loss: 11308.1569; val_gene_expr_recon_loss: 2017079.2083; val_masked_gp_l1_reg_loss: 11143.2627; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29467.2227; val_global_loss: 2099417.1042; val_optim_loss: 2099417.1042
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9044; val_auprc_score: 0.9793; val_best_acc_score: 0.8903; val_best_f1_score: 0.9374; train_kl_reg_loss: 30892.7219; train_edge_recon_loss: 11624.5512; train_gene_expr_recon_loss: 2010267.7407; train_masked_gp_l1_reg_loss: 11215.6638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29177.0418; train_global_loss: 2093177.7083; train_optim_loss: 2093177.7083; val_kl_reg_loss: 29415.2233; val_edge_recon_loss: 11541.3701; val_gene_expr_recon_loss: 2005260.6667; val_masked_gp_l1_reg_loss: 11292.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28875.0508; val_global_loss: 2086385.1458; val_optim_loss: 2086385.1458
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9067; val_auprc_score: 0.9808; val_best_acc_score: 0.8933; val_best_f1_score: 0.9391; train_kl_reg_loss: 29995.3828; train_edge_recon_loss: 11411.4416; train_gene_expr_recon_loss: 1994677.7940; train_masked_gp_l1_reg_loss: 11365.8578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28583.5878; train_global_loss: 2076034.0718; train_optim_loss: 2076034.0718; val_kl_reg_loss: 28658.6123; val_edge_recon_loss: 11312.0080; val_gene_expr_recon_loss: 1986946.6875; val_masked_gp_l1_reg_loss: 11443.1973; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28279.7227; val_global_loss: 2066640.2917; val_optim_loss: 2066640.2917
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9126; val_auprc_score: 0.9823; val_best_acc_score: 0.8940; val_best_f1_score: 0.9389; train_kl_reg_loss: 29159.2137; train_edge_recon_loss: 11445.1169; train_gene_expr_recon_loss: 1979745.1343; train_masked_gp_l1_reg_loss: 11513.7027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27987.4014; train_global_loss: 2059850.5810; train_optim_loss: 2059850.5810; val_kl_reg_loss: 27767.7861; val_edge_recon_loss: 11656.5452; val_gene_expr_recon_loss: 1973050.7083; val_masked_gp_l1_reg_loss: 11589.2686; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27684.2461; val_global_loss: 2051748.5625; val_optim_loss: 2051748.5625
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9058; val_auprc_score: 0.9801; val_best_acc_score: 0.8945; val_best_f1_score: 0.9390; train_kl_reg_loss: 28399.9924; train_edge_recon_loss: 11403.4188; train_gene_expr_recon_loss: 1965542.9861; train_masked_gp_l1_reg_loss: 11657.3678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27390.4839; train_global_loss: 2044394.2569; train_optim_loss: 2044394.2569; val_kl_reg_loss: 27107.1406; val_edge_recon_loss: 11590.3807; val_gene_expr_recon_loss: 1960192.9375; val_masked_gp_l1_reg_loss: 11734.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27087.7461; val_global_loss: 2037712.3333; val_optim_loss: 2037712.3333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9098; val_auprc_score: 0.9813; val_best_acc_score: 0.8960; val_best_f1_score: 0.9400; train_kl_reg_loss: 27687.0372; train_edge_recon_loss: 11368.4680; train_gene_expr_recon_loss: 1951736.0856; train_masked_gp_l1_reg_loss: 11799.6430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26795.3109; train_global_loss: 2029386.5532; train_optim_loss: 2029386.5532; val_kl_reg_loss: 26358.6810; val_edge_recon_loss: 11319.3737; val_gene_expr_recon_loss: 1948101.6458; val_masked_gp_l1_reg_loss: 11872.3652; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26492.6250; val_global_loss: 2024144.7292; val_optim_loss: 2024144.7292
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9113; val_auprc_score: 0.9818; val_best_acc_score: 0.8951; val_best_f1_score: 0.9391; train_kl_reg_loss: 27027.9425; train_edge_recon_loss: 11304.4470; train_gene_expr_recon_loss: 1938254.4306; train_masked_gp_l1_reg_loss: 11936.4554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26202.0787; train_global_loss: 2014725.3657; train_optim_loss: 2014725.3657; val_kl_reg_loss: 25877.6234; val_edge_recon_loss: 11537.0246; val_gene_expr_recon_loss: 1932412.6250; val_masked_gp_l1_reg_loss: 12006.4668; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25901.5410; val_global_loss: 2007735.2708; val_optim_loss: 2007735.2708
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9115; val_auprc_score: 0.9808; val_best_acc_score: 0.8976; val_best_f1_score: 0.9402; train_kl_reg_loss: 26409.1834; train_edge_recon_loss: 11505.1527; train_gene_expr_recon_loss: 1925792.7315; train_masked_gp_l1_reg_loss: 12069.4418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25612.6963; train_global_loss: 2001389.2037; train_optim_loss: 2001389.2037; val_kl_reg_loss: 25204.5869; val_edge_recon_loss: 11685.6584; val_gene_expr_recon_loss: 1919810.7917; val_masked_gp_l1_reg_loss: 12136.6514; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25313.7695; val_global_loss: 1994151.3958; val_optim_loss: 1994151.3958
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9159; val_auprc_score: 0.9831; val_best_acc_score: 0.8993; val_best_f1_score: 0.9419; train_kl_reg_loss: 25823.6893; train_edge_recon_loss: 11323.6854; train_gene_expr_recon_loss: 1913129.7917; train_masked_gp_l1_reg_loss: 12198.5127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25028.0744; train_global_loss: 1987503.7315; train_optim_loss: 1987503.7315; val_kl_reg_loss: 24792.3887; val_edge_recon_loss: 11314.2147; val_gene_expr_recon_loss: 1907184.1250; val_masked_gp_l1_reg_loss: 12265.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24734.1875; val_global_loss: 1980290.4583; val_optim_loss: 1980290.4583
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9149; val_auprc_score: 0.9826; val_best_acc_score: 0.8986; val_best_f1_score: 0.9409; train_kl_reg_loss: 25297.8772; train_edge_recon_loss: 11383.5325; train_gene_expr_recon_loss: 1901490.6968; train_masked_gp_l1_reg_loss: 12326.8464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24449.9965; train_global_loss: 1974948.9491; train_optim_loss: 1974948.9491; val_kl_reg_loss: 24170.4616; val_edge_recon_loss: 11352.2443; val_gene_expr_recon_loss: 1897703.8958; val_masked_gp_l1_reg_loss: 12392.0752; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24156.3359; val_global_loss: 1969775.1250; val_optim_loss: 1969775.1250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9177; val_auprc_score: 0.9827; val_best_acc_score: 0.8986; val_best_f1_score: 0.9415; train_kl_reg_loss: 24794.5165; train_edge_recon_loss: 11391.4745; train_gene_expr_recon_loss: 1890372.3356; train_masked_gp_l1_reg_loss: 12451.1147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23876.6340; train_global_loss: 1962886.0741; train_optim_loss: 1962886.0741; val_kl_reg_loss: 23636.4928; val_edge_recon_loss: 11600.6763; val_gene_expr_recon_loss: 1886544.4792; val_masked_gp_l1_reg_loss: 12513.4629; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23586.2070; val_global_loss: 1957881.4167; val_optim_loss: 1957881.4167
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8873; val_auprc_score: 0.9768; val_best_acc_score: 0.8793; val_best_f1_score: 0.9327; train_kl_reg_loss: 19816.7813; train_edge_recon_loss: 11676.7427; train_gene_expr_recon_loss: 3758872.2315; train_masked_gp_l1_reg_loss: 14626.7300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23175.3192; train_global_loss: 3828167.7963; train_optim_loss: 3828167.7963; val_kl_reg_loss: 21169.2747; val_edge_recon_loss: 11799.1877; val_gene_expr_recon_loss: 3416030.6667; val_masked_gp_l1_reg_loss: 14897.2871; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22715.4590; val_global_loss: 3486611.8750; val_optim_loss: 3486611.8750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8918; val_auprc_score: 0.9774; val_best_acc_score: 0.8842; val_best_f1_score: 0.9335; train_kl_reg_loss: 23401.5433; train_edge_recon_loss: 11616.3600; train_gene_expr_recon_loss: 3258358.0000; train_masked_gp_l1_reg_loss: 14735.0524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22271.3348; train_global_loss: 3330382.2963; train_optim_loss: 3330382.2963; val_kl_reg_loss: 22312.0918; val_edge_recon_loss: 11724.4035; val_gene_expr_recon_loss: 3101542.1667; val_masked_gp_l1_reg_loss: 14627.8271; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21813.5391; val_global_loss: 3172019.9583; val_optim_loss: 3172019.9583
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8968; val_auprc_score: 0.9770; val_best_acc_score: 0.8872; val_best_f1_score: 0.9356; train_kl_reg_loss: 23080.7902; train_edge_recon_loss: 11639.7670; train_gene_expr_recon_loss: 2969146.8102; train_masked_gp_l1_reg_loss: 14608.4386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21379.2157; train_global_loss: 3039855.0231; train_optim_loss: 3039855.0231; val_kl_reg_loss: 21288.9688; val_edge_recon_loss: 11832.7635; val_gene_expr_recon_loss: 2838143.8333; val_masked_gp_l1_reg_loss: 14607.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20931.8789; val_global_loss: 2906805.2500; val_optim_loss: 2906805.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9081; val_auprc_score: 0.9809; val_best_acc_score: 0.8902; val_best_f1_score: 0.9367; train_kl_reg_loss: 22060.9601; train_edge_recon_loss: 11486.1274; train_gene_expr_recon_loss: 2721961.8287; train_masked_gp_l1_reg_loss: 14624.9926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20507.0730; train_global_loss: 2790640.9537; train_optim_loss: 2790640.9537; val_kl_reg_loss: 20390.1768; val_edge_recon_loss: 11941.6139; val_gene_expr_recon_loss: 2611548.4167; val_masked_gp_l1_reg_loss: 14647.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20069.6074; val_global_loss: 2678597.4167; val_optim_loss: 2678597.4167

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9085; val_auprc_score: 0.9807; val_best_acc_score: 0.8967; val_best_f1_score: 0.9404; train_kl_reg_loss: 21432.5432; train_edge_recon_loss: 11468.0059; train_gene_expr_recon_loss: 2603266.1528; train_masked_gp_l1_reg_loss: 14617.4140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20009.9510; train_global_loss: 2670794.0741; train_optim_loss: 2670794.0741; val_kl_reg_loss: 20314.7188; val_edge_recon_loss: 11714.1587; val_gene_expr_recon_loss: 2576518.0000; val_masked_gp_l1_reg_loss: 14611.3369; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19961.9043; val_global_loss: 2643120.1250; val_optim_loss: 2643120.1250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9045; val_auprc_score: 0.9810; val_best_acc_score: 0.8971; val_best_f1_score: 0.9410; train_kl_reg_loss: 21319.7914; train_edge_recon_loss: 11538.0105; train_gene_expr_recon_loss: 2586761.8750; train_masked_gp_l1_reg_loss: 14612.1330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19918.3340; train_global_loss: 2654150.1250; train_optim_loss: 2654150.1250; val_kl_reg_loss: 20169.2116; val_edge_recon_loss: 11178.8359; val_gene_expr_recon_loss: 2580634.3333; val_masked_gp_l1_reg_loss: 14614.1592; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19872.8203; val_global_loss: 2646469.3333; val_optim_loss: 2646469.3333
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9105; val_auprc_score: 0.9821; val_best_acc_score: 0.8996; val_best_f1_score: 0.9422; train_kl_reg_loss: 21195.3464; train_edge_recon_loss: 11561.2845; train_gene_expr_recon_loss: 2568354.0093; train_masked_gp_l1_reg_loss: 14616.1339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19828.2202; train_global_loss: 2635554.9861; train_optim_loss: 2635554.9861; val_kl_reg_loss: 20152.9902; val_edge_recon_loss: 11312.1370; val_gene_expr_recon_loss: 2551250.8750; val_masked_gp_l1_reg_loss: 14618.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19781.5781; val_global_loss: 2617116.0000; val_optim_loss: 2617116.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9076; val_auprc_score: 0.9817; val_best_acc_score: 0.8957; val_best_f1_score: 0.9400; train_kl_reg_loss: 21093.9265; train_edge_recon_loss: 11522.3218; train_gene_expr_recon_loss: 2555616.3426; train_masked_gp_l1_reg_loss: 14620.5592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19735.7696; train_global_loss: 2622588.9167; train_optim_loss: 2622588.9167; val_kl_reg_loss: 19941.8939; val_edge_recon_loss: 11430.7979; val_gene_expr_recon_loss: 2550311.9167; val_masked_gp_l1_reg_loss: 14623.3262; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19687.8066; val_global_loss: 2615995.5833; val_optim_loss: 2615995.5833

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 41 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9191
val AUPRC score: 0.9837
val best accuracy score: 0.9004
val best F1 score: 0.9424
val target rna MSE score: 27.1137
val source rna MSE score: 154.9695
Val cat covariate0 mean sim diff: -0.0006

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
