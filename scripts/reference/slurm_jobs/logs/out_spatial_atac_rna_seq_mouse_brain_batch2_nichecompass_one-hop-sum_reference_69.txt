[True]
Run timestamp: 10082023_220259_69.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_69']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2999 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 7150, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 2999

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7607; val_auprc_score: 0.7845; val_best_acc_score: 0.5164; val_best_f1_score: 0.6727; train_kl_reg_loss: 198044.6106; train_edge_recon_loss: 3760870.6870; train_gene_expr_recon_loss: 43816868.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5440530.2366; train_global_loss: 53216313.9542; train_optim_loss: 53216313.9542; val_kl_reg_loss: 276677.6063; val_edge_recon_loss: 4063936.0333; val_gene_expr_recon_loss: 38029107.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5210582.0333; val_global_loss: 47580302.9333; val_optim_loss: 47580302.9333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8493; val_auprc_score: 0.8569; val_best_acc_score: 0.7526; val_best_f1_score: 0.7759; train_kl_reg_loss: 247985.7253; train_edge_recon_loss: 3618099.3511; train_gene_expr_recon_loss: 37452037.7099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5134666.3931; train_global_loss: 46452789.3130; train_optim_loss: 46452789.3130; val_kl_reg_loss: 218353.9583; val_edge_recon_loss: 4034442.6500; val_gene_expr_recon_loss: 37164331.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5150127.9333; val_global_loss: 46567256.8000; val_optim_loss: 46567256.8000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9042; val_auprc_score: 0.8968; val_best_acc_score: 0.8213; val_best_f1_score: 0.8365; train_kl_reg_loss: 201135.3299; train_edge_recon_loss: 3561949.8702; train_gene_expr_recon_loss: 36844054.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5090983.5763; train_global_loss: 45698123.1145; train_optim_loss: 45698123.1145; val_kl_reg_loss: 196177.6063; val_edge_recon_loss: 3861307.6167; val_gene_expr_recon_loss: 36779057.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5132521.8000; val_global_loss: 45969063.7333; val_optim_loss: 45969063.7333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9064; val_auprc_score: 0.8985; val_best_acc_score: 0.8200; val_best_f1_score: 0.8296; train_kl_reg_loss: 178618.7139; train_edge_recon_loss: 3282719.6240; train_gene_expr_recon_loss: 36580704.3664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5069680.7939; train_global_loss: 45111723.8779; train_optim_loss: 45111723.8779; val_kl_reg_loss: 204373.0583; val_edge_recon_loss: 3057244.2333; val_gene_expr_recon_loss: 36489010.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5117951.4000; val_global_loss: 44868580.2667; val_optim_loss: 44868580.2667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9052; val_auprc_score: 0.8969; val_best_acc_score: 0.8215; val_best_f1_score: 0.8343; train_kl_reg_loss: 206434.3126; train_edge_recon_loss: 3021639.9485; train_gene_expr_recon_loss: 36231775.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5036764.7519; train_global_loss: 44496614.9313; train_optim_loss: 44496614.9313; val_kl_reg_loss: 205601.1031; val_edge_recon_loss: 3025250.5833; val_gene_expr_recon_loss: 36255851.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5063186.9667; val_global_loss: 44549889.3333; val_optim_loss: 44549889.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9143; val_auprc_score: 0.9036; val_best_acc_score: 0.8335; val_best_f1_score: 0.8457; train_kl_reg_loss: 194374.2832; train_edge_recon_loss: 2975038.5038; train_gene_expr_recon_loss: 36011144.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5013962.1908; train_global_loss: 44194519.9084; train_optim_loss: 44194519.9084; val_kl_reg_loss: 188172.5333; val_edge_recon_loss: 2982102.5667; val_gene_expr_recon_loss: 35777015.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5031551.5000; val_global_loss: 43978842.1333; val_optim_loss: 43978842.1333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9225; val_auprc_score: 0.9073; val_best_acc_score: 0.8529; val_best_f1_score: 0.8603; train_kl_reg_loss: 184099.1466; train_edge_recon_loss: 2931411.2271; train_gene_expr_recon_loss: 35802164.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4997896.9084; train_global_loss: 43915571.9389; train_optim_loss: 43915571.9389; val_kl_reg_loss: 181341.2771; val_edge_recon_loss: 2939530.7667; val_gene_expr_recon_loss: 35719600.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5016246.2667; val_global_loss: 43856719.2000; val_optim_loss: 43856719.2000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9349; val_auprc_score: 0.9232; val_best_acc_score: 0.8723; val_best_f1_score: 0.8803; train_kl_reg_loss: 173775.7551; train_edge_recon_loss: 2900479.0344; train_gene_expr_recon_loss: 35623780.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4975696.7252; train_global_loss: 43673732.3969; train_optim_loss: 43673732.3969; val_kl_reg_loss: 166896.1771; val_edge_recon_loss: 2897390.2000; val_gene_expr_recon_loss: 35570820.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5000300.0000; val_global_loss: 43635406.1333; val_optim_loss: 43635406.1333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9374; val_auprc_score: 0.9252; val_best_acc_score: 0.8681; val_best_f1_score: 0.8767; train_kl_reg_loss: 168282.9444; train_edge_recon_loss: 2876273.4542; train_gene_expr_recon_loss: 35470973.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4960012.5725; train_global_loss: 43475542.6565; train_optim_loss: 43475542.6565; val_kl_reg_loss: 166403.5260; val_edge_recon_loss: 2873960.9500; val_gene_expr_recon_loss: 35452693.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5004135.6667; val_global_loss: 43497194.4000; val_optim_loss: 43497194.4000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9431; val_auprc_score: 0.9297; val_best_acc_score: 0.8798; val_best_f1_score: 0.8851; train_kl_reg_loss: 162454.4286; train_edge_recon_loss: 2851735.1336; train_gene_expr_recon_loss: 35318294.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4945350.6336; train_global_loss: 43277834.4427; train_optim_loss: 43277834.4427; val_kl_reg_loss: 158880.4521; val_edge_recon_loss: 2867476.2833; val_gene_expr_recon_loss: 35297607.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4981233.0333; val_global_loss: 43305197.6000; val_optim_loss: 43305197.6000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9531; val_auprc_score: 0.9420; val_best_acc_score: 0.8940; val_best_f1_score: 0.8978; train_kl_reg_loss: 156205.8975; train_edge_recon_loss: 2837148.8111; train_gene_expr_recon_loss: 35235365.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4939441.3053; train_global_loss: 43168161.1908; train_optim_loss: 43168161.1908; val_kl_reg_loss: 151255.1521; val_edge_recon_loss: 2822155.8333; val_gene_expr_recon_loss: 35065306.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4947002.2333; val_global_loss: 42985720.0000; val_optim_loss: 42985720.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9527; val_auprc_score: 0.9391; val_best_acc_score: 0.8934; val_best_f1_score: 0.8994; train_kl_reg_loss: 152178.1116; train_edge_recon_loss: 2813740.2366; train_gene_expr_recon_loss: 35120397.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4930641.9885; train_global_loss: 43016958.3206; train_optim_loss: 43016958.3206; val_kl_reg_loss: 148148.8937; val_edge_recon_loss: 2828205.5000; val_gene_expr_recon_loss: 35009081.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4961263.0667; val_global_loss: 42946698.6667; val_optim_loss: 42946698.6667
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9610; val_auprc_score: 0.9519; val_best_acc_score: 0.9031; val_best_f1_score: 0.9070; train_kl_reg_loss: 147273.5104; train_edge_recon_loss: 2801833.9389; train_gene_expr_recon_loss: 34995518.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4916214.1794; train_global_loss: 42860840.5191; train_optim_loss: 42860840.5191; val_kl_reg_loss: 144727.2302; val_edge_recon_loss: 2799088.5667; val_gene_expr_recon_loss: 35120604.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4966414.9667; val_global_loss: 43030835.2000; val_optim_loss: 43030835.2000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9595; val_auprc_score: 0.9460; val_best_acc_score: 0.9041; val_best_f1_score: 0.9078; train_kl_reg_loss: 143516.2527; train_edge_recon_loss: 2787468.6107; train_gene_expr_recon_loss: 34903455.7252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4908755.2748; train_global_loss: 42743196.0000; train_optim_loss: 42743196.0000; val_kl_reg_loss: 142132.6198; val_edge_recon_loss: 2803151.1667; val_gene_expr_recon_loss: 34880900.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4948109.1667; val_global_loss: 42774293.8667; val_optim_loss: 42774293.8667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9674; val_auprc_score: 0.9598; val_best_acc_score: 0.9131; val_best_f1_score: 0.9160; train_kl_reg_loss: 139672.0558; train_edge_recon_loss: 2786275.5248; train_gene_expr_recon_loss: 34812556.9924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4902516.4580; train_global_loss: 42641021.1603; train_optim_loss: 42641021.1603; val_kl_reg_loss: 140073.7563; val_edge_recon_loss: 2789881.9167; val_gene_expr_recon_loss: 34583104.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4915426.0333; val_global_loss: 42428486.1333; val_optim_loss: 42428486.1333
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9677; val_auprc_score: 0.9605; val_best_acc_score: 0.9169; val_best_f1_score: 0.9196; train_kl_reg_loss: 135653.0673; train_edge_recon_loss: 2776905.6489; train_gene_expr_recon_loss: 34712739.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4889900.9504; train_global_loss: 42515199.7252; train_optim_loss: 42515199.7252; val_kl_reg_loss: 134631.9594; val_edge_recon_loss: 2786274.0667; val_gene_expr_recon_loss: 34778611.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4947528.9333; val_global_loss: 42647045.6000; val_optim_loss: 42647045.6000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9692; val_auprc_score: 0.9615; val_best_acc_score: 0.9154; val_best_f1_score: 0.9186; train_kl_reg_loss: 131786.1614; train_edge_recon_loss: 2767230.9447; train_gene_expr_recon_loss: 34586677.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4876773.2672; train_global_loss: 42362468.4275; train_optim_loss: 42362468.4275; val_kl_reg_loss: 130462.1797; val_edge_recon_loss: 2773209.9167; val_gene_expr_recon_loss: 34755200.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4946751.2000; val_global_loss: 42605622.4000; val_optim_loss: 42605622.4000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9698; val_auprc_score: 0.9631; val_best_acc_score: 0.9178; val_best_f1_score: 0.9203; train_kl_reg_loss: 128666.7542; train_edge_recon_loss: 2765969.6469; train_gene_expr_recon_loss: 34535987.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4875675.0611; train_global_loss: 42306298.5038; train_optim_loss: 42306298.5038; val_kl_reg_loss: 126895.3792; val_edge_recon_loss: 2773425.7000; val_gene_expr_recon_loss: 34537876.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4920235.9667; val_global_loss: 42358432.5333; val_optim_loss: 42358432.5333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9743; val_auprc_score: 0.9687; val_best_acc_score: 0.9271; val_best_f1_score: 0.9292; train_kl_reg_loss: 126785.2663; train_edge_recon_loss: 2753841.1679; train_gene_expr_recon_loss: 34441344.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4870387.2366; train_global_loss: 42192358.6260; train_optim_loss: 42192358.6260; val_kl_reg_loss: 121294.2109; val_edge_recon_loss: 2745244.9167; val_gene_expr_recon_loss: 34434847.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4901099.0667; val_global_loss: 42202485.8667; val_optim_loss: 42202485.8667
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9732; val_auprc_score: 0.9664; val_best_acc_score: 0.9255; val_best_f1_score: 0.9272; train_kl_reg_loss: 123542.2753; train_edge_recon_loss: 2748709.5763; train_gene_expr_recon_loss: 34392316.5191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4872747.2290; train_global_loss: 42137315.5725; train_optim_loss: 42137315.5725; val_kl_reg_loss: 121510.0432; val_edge_recon_loss: 2766451.8000; val_gene_expr_recon_loss: 34330858.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4888645.7333; val_global_loss: 42107464.8000; val_optim_loss: 42107464.8000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9743; val_auprc_score: 0.9689; val_best_acc_score: 0.9286; val_best_f1_score: 0.9303; train_kl_reg_loss: 121532.1122; train_edge_recon_loss: 2746516.5382; train_gene_expr_recon_loss: 34327667.7863; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4869267.5840; train_global_loss: 42064984.0611; train_optim_loss: 42064984.0611; val_kl_reg_loss: 122802.0250; val_edge_recon_loss: 2748943.5000; val_gene_expr_recon_loss: 34318484.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4891059.7333; val_global_loss: 42081289.6000; val_optim_loss: 42081289.6000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9756; val_auprc_score: 0.9706; val_best_acc_score: 0.9270; val_best_f1_score: 0.9296; train_kl_reg_loss: 119766.4915; train_edge_recon_loss: 2744488.9103; train_gene_expr_recon_loss: 34204127.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4858062.2252; train_global_loss: 41926444.8244; train_optim_loss: 41926444.8244; val_kl_reg_loss: 117500.3010; val_edge_recon_loss: 2745741.5167; val_gene_expr_recon_loss: 34279978.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4902339.3667; val_global_loss: 42045560.2667; val_optim_loss: 42045560.2667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9773; val_auprc_score: 0.9723; val_best_acc_score: 0.9268; val_best_f1_score: 0.9287; train_kl_reg_loss: 116691.9511; train_edge_recon_loss: 2739661.2786; train_gene_expr_recon_loss: 34150223.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4857036.2099; train_global_loss: 41863613.2824; train_optim_loss: 41863613.2824; val_kl_reg_loss: 113892.0099; val_edge_recon_loss: 2760915.3167; val_gene_expr_recon_loss: 34328718.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4918886.7333; val_global_loss: 42122413.3333; val_optim_loss: 42122413.3333
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9781; val_auprc_score: 0.9744; val_best_acc_score: 0.9310; val_best_f1_score: 0.9323; train_kl_reg_loss: 114616.3098; train_edge_recon_loss: 2739090.5973; train_gene_expr_recon_loss: 34149256.6107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4862007.9656; train_global_loss: 41864971.5420; train_optim_loss: 41864971.5420; val_kl_reg_loss: 113356.9740; val_edge_recon_loss: 2742373.2667; val_gene_expr_recon_loss: 34246837.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4886658.6667; val_global_loss: 41989226.4000; val_optim_loss: 41989226.4000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9794; val_auprc_score: 0.9745; val_best_acc_score: 0.9329; val_best_f1_score: 0.9341; train_kl_reg_loss: 113176.2928; train_edge_recon_loss: 2736190.5630; train_gene_expr_recon_loss: 34015807.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 4853328.2405; train_global_loss: 41718502.6870; train_optim_loss: 41718502.6870; val_kl_reg_loss: 111664.1411; val_edge_recon_loss: 2743609.1500; val_gene_expr_recon_loss: 34163588.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 4894376.4667; val_global_loss: 41913238.4000; val_optim_loss: 41913238.4000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9566; val_auprc_score: 0.9464; val_best_acc_score: 0.8985; val_best_f1_score: 0.9029; train_kl_reg_loss: 133698.4527; train_edge_recon_loss: 2936193.9847; train_gene_expr_recon_loss: 40949156.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5062475.6183; train_global_loss: 49081524.7328; train_optim_loss: 49081524.7328; val_kl_reg_loss: 17119.3706; val_edge_recon_loss: 2814647.2667; val_gene_expr_recon_loss: 41245564.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5098665.9333; val_global_loss: 49175997.0667; val_optim_loss: 49175997.0667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9618; val_auprc_score: 0.9532; val_best_acc_score: 0.9043; val_best_f1_score: 0.9089; train_kl_reg_loss: 82581.1251; train_edge_recon_loss: 2786240.3092; train_gene_expr_recon_loss: 40894167.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5044338.6870; train_global_loss: 48807327.2061; train_optim_loss: 48807327.2061; val_kl_reg_loss: 20393.6710; val_edge_recon_loss: 2759712.4333; val_gene_expr_recon_loss: 40503705.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5082204.0667; val_global_loss: 48366015.7333; val_optim_loss: 48366015.7333
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9608; val_auprc_score: 0.9460; val_best_acc_score: 0.9119; val_best_f1_score: 0.9155; train_kl_reg_loss: 63074.7009; train_edge_recon_loss: 2723379.2176; train_gene_expr_recon_loss: 40176287.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5024977.4084; train_global_loss: 47987719.0534; train_optim_loss: 47987719.0534; val_kl_reg_loss: 26586.9755; val_edge_recon_loss: 2707582.3167; val_gene_expr_recon_loss: 39998866.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5065253.9333; val_global_loss: 47798290.1333; val_optim_loss: 47798290.1333
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9630; val_auprc_score: 0.9469; val_best_acc_score: 0.9162; val_best_f1_score: 0.9200; train_kl_reg_loss: 53008.2287; train_edge_recon_loss: 2696655.0324; train_gene_expr_recon_loss: 39622548.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5016359.4504; train_global_loss: 47388570.6870; train_optim_loss: 47388570.6870; val_kl_reg_loss: 28966.6898; val_edge_recon_loss: 2708478.4667; val_gene_expr_recon_loss: 39481982.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5060519.1000; val_global_loss: 47279947.2000; val_optim_loss: 47279947.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9644; val_auprc_score: 0.9531; val_best_acc_score: 0.9186; val_best_f1_score: 0.9213; train_kl_reg_loss: 49065.0848; train_edge_recon_loss: 2696765.3321; train_gene_expr_recon_loss: 39362067.0229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5013962.8588; train_global_loss: 47121860.2748; train_optim_loss: 47121860.2748; val_kl_reg_loss: 29627.7992; val_edge_recon_loss: 2715728.7333; val_gene_expr_recon_loss: 39452287.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5082501.4667; val_global_loss: 47280145.3333; val_optim_loss: 47280145.3333
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9678; val_auprc_score: 0.9563; val_best_acc_score: 0.9217; val_best_f1_score: 0.9247; train_kl_reg_loss: 48778.2662; train_edge_recon_loss: 2694095.9160; train_gene_expr_recon_loss: 39368253.6183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5015564.2748; train_global_loss: 47126692.3969; train_optim_loss: 47126692.3969; val_kl_reg_loss: 30180.0608; val_edge_recon_loss: 2693384.1500; val_gene_expr_recon_loss: 39233078.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5042354.0667; val_global_loss: 46998997.0667; val_optim_loss: 46998997.0667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9640; val_auprc_score: 0.9505; val_best_acc_score: 0.9197; val_best_f1_score: 0.9213; train_kl_reg_loss: 48702.4855; train_edge_recon_loss: 2693347.9676; train_gene_expr_recon_loss: 39332008.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5016612.4809; train_global_loss: 47090671.7557; train_optim_loss: 47090671.7557; val_kl_reg_loss: 30671.7737; val_edge_recon_loss: 2712865.7833; val_gene_expr_recon_loss: 39214814.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5046372.1000; val_global_loss: 47004724.0000; val_optim_loss: 47004724.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9623; val_auprc_score: 0.9453; val_best_acc_score: 0.9170; val_best_f1_score: 0.9210; train_kl_reg_loss: 48285.5591; train_edge_recon_loss: 2685766.3416; train_gene_expr_recon_loss: 39226759.9084; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 5004491.1718; train_global_loss: 46965303.1145; train_optim_loss: 46965303.1145; val_kl_reg_loss: 31497.5706; val_edge_recon_loss: 2712088.0833; val_gene_expr_recon_loss: 39222413.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 5062050.9333; val_global_loss: 47028049.6000; val_optim_loss: 47028049.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 41 min 3 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9762
val AUPRC score: 0.9726
val best accuracy score: 0.9281
val best F1 score: 0.9305
val target rna MSE score: 1.7172
val source rna MSE score: 145.7455
val target atac MSE score: 0.3710
val source atac MSE score: 3.3589
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
