[True]
Run timestamp: 07082023_195008_80.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '50', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_80']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2623, n_latent: 2573, n_addon_latent: 50, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 50, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8788; val_auprc_score: 0.9001; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 18869.0170; train_edge_recon_loss: 350820.4375; train_gene_expr_recon_loss: 1308994.1389; train_masked_gp_l1_reg_loss: 16094.6819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119327.3637; train_chrom_access_recon_loss: 2586640.9444; train_global_loss: 4400746.6389; train_optim_loss: 4400746.6389; val_kl_reg_loss: 9433.2246; val_edge_recon_loss: 406587.8438; val_gene_expr_recon_loss: 1151579.1250; val_masked_gp_l1_reg_loss: 11696.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117049.1875; val_chrom_access_recon_loss: 1709795.1250; val_global_loss: 3406141.0000; val_optim_loss: 3406141.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8864; val_auprc_score: 0.9034; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 7953.1078; train_edge_recon_loss: 352465.7847; train_gene_expr_recon_loss: 1051888.8611; train_masked_gp_l1_reg_loss: 10287.1566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115722.2257; train_chrom_access_recon_loss: 1564592.7222; train_global_loss: 3102909.7778; train_optim_loss: 3102909.7778; val_kl_reg_loss: 6104.6660; val_edge_recon_loss: 406577.2188; val_gene_expr_recon_loss: 966189.2500; val_masked_gp_l1_reg_loss: 9479.7549; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114171.3750; val_chrom_access_recon_loss: 1449514.0000; val_global_loss: 2952036.2500; val_optim_loss: 2952036.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8918; val_auprc_score: 0.9062; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 7012.4597; train_edge_recon_loss: 352479.7986; train_gene_expr_recon_loss: 924343.0764; train_masked_gp_l1_reg_loss: 9894.0706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113041.5139; train_chrom_access_recon_loss: 1439690.7500; train_global_loss: 2846461.6667; train_optim_loss: 2846461.6667; val_kl_reg_loss: 9663.3848; val_edge_recon_loss: 406590.0000; val_gene_expr_recon_loss: 876252.8750; val_masked_gp_l1_reg_loss: 10281.5566; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111647.3047; val_chrom_access_recon_loss: 1411658.0000; val_global_loss: 2826093.0000; val_optim_loss: 2826093.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8892; val_auprc_score: 0.9049; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13191.9231; train_edge_recon_loss: 356023.3299; train_gene_expr_recon_loss: 838503.0972; train_masked_gp_l1_reg_loss: 10327.1743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110496.5078; train_chrom_access_recon_loss: 1402678.8472; train_global_loss: 2731220.8889; train_optim_loss: 2731220.8889; val_kl_reg_loss: 15596.8223; val_edge_recon_loss: 406603.6875; val_gene_expr_recon_loss: 804660.2500; val_masked_gp_l1_reg_loss: 10379.7617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108995.1484; val_chrom_access_recon_loss: 1383455.7500; val_global_loss: 2729691.5000; val_optim_loss: 2729691.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8833; val_auprc_score: 0.8991; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 17849.1998; train_edge_recon_loss: 359227.5139; train_gene_expr_recon_loss: 778336.0486; train_masked_gp_l1_reg_loss: 10408.7466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107662.9323; train_chrom_access_recon_loss: 1374683.2361; train_global_loss: 2648167.6667; train_optim_loss: 2648167.6667; val_kl_reg_loss: 18758.0664; val_edge_recon_loss: 406602.9375; val_gene_expr_recon_loss: 763777.6250; val_masked_gp_l1_reg_loss: 10413.5117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105899.4531; val_chrom_access_recon_loss: 1358836.5000; val_global_loss: 2664288.0000; val_optim_loss: 2664288.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8804; val_auprc_score: 0.9009; val_best_acc_score: 0.5001; val_best_f1_score: 0.6667; train_kl_reg_loss: 19868.5979; train_edge_recon_loss: 360146.1840; train_gene_expr_recon_loss: 755117.8819; train_masked_gp_l1_reg_loss: 10392.7580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104344.8559; train_chrom_access_recon_loss: 1360040.3750; train_global_loss: 2609910.6389; train_optim_loss: 2609910.6389; val_kl_reg_loss: 19701.1367; val_edge_recon_loss: 406598.2188; val_gene_expr_recon_loss: 740154.6250; val_masked_gp_l1_reg_loss: 10344.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102327.9297; val_chrom_access_recon_loss: 1342849.2500; val_global_loss: 2621975.5000; val_optim_loss: 2621975.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8709; val_auprc_score: 0.8891; val_best_acc_score: 0.5030; val_best_f1_score: 0.6680; train_kl_reg_loss: 20662.8312; train_edge_recon_loss: 360559.5590; train_gene_expr_recon_loss: 730769.2708; train_masked_gp_l1_reg_loss: 10310.8635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100630.0087; train_chrom_access_recon_loss: 1343201.6389; train_global_loss: 2566134.1944; train_optim_loss: 2566134.1944; val_kl_reg_loss: 21610.5488; val_edge_recon_loss: 406587.7500; val_gene_expr_recon_loss: 724028.6875; val_masked_gp_l1_reg_loss: 10251.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98478.0781; val_chrom_access_recon_loss: 1333767.0000; val_global_loss: 2594724.0000; val_optim_loss: 2594724.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8698; val_auprc_score: 0.8905; val_best_acc_score: 0.5050; val_best_f1_score: 0.6689; train_kl_reg_loss: 22050.9865; train_edge_recon_loss: 361022.0694; train_gene_expr_recon_loss: 714140.2153; train_masked_gp_l1_reg_loss: 10199.4100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96723.2700; train_chrom_access_recon_loss: 1337853.9722; train_global_loss: 2541989.9167; train_optim_loss: 2541989.9167; val_kl_reg_loss: 21958.0098; val_edge_recon_loss: 406575.0938; val_gene_expr_recon_loss: 712438.3750; val_masked_gp_l1_reg_loss: 10119.7988; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94514.3359; val_chrom_access_recon_loss: 1327070.1250; val_global_loss: 2572675.7500; val_optim_loss: 2572675.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8597; val_auprc_score: 0.8745; val_best_acc_score: 0.5104; val_best_f1_score: 0.6713; train_kl_reg_loss: 22391.4603; train_edge_recon_loss: 360922.4410; train_gene_expr_recon_loss: 705070.4514; train_masked_gp_l1_reg_loss: 10065.1490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92740.2526; train_chrom_access_recon_loss: 1331192.5417; train_global_loss: 2522382.3333; train_optim_loss: 2522382.3333; val_kl_reg_loss: 22718.8438; val_edge_recon_loss: 406553.7812; val_gene_expr_recon_loss: 703561.5625; val_masked_gp_l1_reg_loss: 9980.9082; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90525.9453; val_chrom_access_recon_loss: 1321927.5000; val_global_loss: 2555268.5000; val_optim_loss: 2555268.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8509; val_auprc_score: 0.8655; val_best_acc_score: 0.5131; val_best_f1_score: 0.6723; train_kl_reg_loss: 23027.8103; train_edge_recon_loss: 361023.2361; train_gene_expr_recon_loss: 696765.8264; train_masked_gp_l1_reg_loss: 9918.4559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88768.1693; train_chrom_access_recon_loss: 1327244.3750; train_global_loss: 2506747.9444; train_optim_loss: 2506747.9444; val_kl_reg_loss: 22277.3125; val_edge_recon_loss: 406526.5000; val_gene_expr_recon_loss: 697110.0000; val_masked_gp_l1_reg_loss: 9828.5117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86577.4531; val_chrom_access_recon_loss: 1318094.8750; val_global_loss: 2540414.5000; val_optim_loss: 2540414.5000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8486; val_auprc_score: 0.8604; val_best_acc_score: 0.5147; val_best_f1_score: 0.6728; train_kl_reg_loss: 23098.6549; train_edge_recon_loss: 360785.5590; train_gene_expr_recon_loss: 693829.4514; train_masked_gp_l1_reg_loss: 9779.4818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84850.4531; train_chrom_access_recon_loss: 1320521.1250; train_global_loss: 2492864.6944; train_optim_loss: 2492864.6944; val_kl_reg_loss: 22045.8008; val_edge_recon_loss: 406492.5000; val_gene_expr_recon_loss: 691043.6875; val_masked_gp_l1_reg_loss: 9709.6865; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82709.4922; val_chrom_access_recon_loss: 1314103.2500; val_global_loss: 2526104.5000; val_optim_loss: 2526104.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8401; val_auprc_score: 0.8459; val_best_acc_score: 0.5182; val_best_f1_score: 0.6741; train_kl_reg_loss: 22874.7394; train_edge_recon_loss: 360626.4062; train_gene_expr_recon_loss: 684693.9792; train_masked_gp_l1_reg_loss: 9673.4243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81030.5156; train_chrom_access_recon_loss: 1315108.2500; train_global_loss: 2474007.3056; train_optim_loss: 2474007.3056; val_kl_reg_loss: 22252.7344; val_edge_recon_loss: 406436.6250; val_gene_expr_recon_loss: 686291.1250; val_masked_gp_l1_reg_loss: 9626.3193; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78955.0391; val_chrom_access_recon_loss: 1311048.0000; val_global_loss: 2514610.0000; val_optim_loss: 2514610.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8424; val_auprc_score: 0.8486; val_best_acc_score: 0.5317; val_best_f1_score: 0.6795; train_kl_reg_loss: 23020.7821; train_edge_recon_loss: 360491.0000; train_gene_expr_recon_loss: 681000.3750; train_masked_gp_l1_reg_loss: 9602.3124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77334.8776; train_chrom_access_recon_loss: 1315334.3056; train_global_loss: 2466783.6389; train_optim_loss: 2466783.6389; val_kl_reg_loss: 21712.6016; val_edge_recon_loss: 406299.6875; val_gene_expr_recon_loss: 681784.6875; val_masked_gp_l1_reg_loss: 9560.0889; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75327.1797; val_chrom_access_recon_loss: 1307895.5000; val_global_loss: 2502579.7500; val_optim_loss: 2502579.7500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8450; val_auprc_score: 0.8459; val_best_acc_score: 0.5593; val_best_f1_score: 0.6909; train_kl_reg_loss: 22618.8331; train_edge_recon_loss: 360097.4826; train_gene_expr_recon_loss: 674973.1667; train_masked_gp_l1_reg_loss: 9546.6844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73761.8290; train_chrom_access_recon_loss: 1307756.5972; train_global_loss: 2448754.6389; train_optim_loss: 2448754.6389; val_kl_reg_loss: 22688.6836; val_edge_recon_loss: 406074.7812; val_gene_expr_recon_loss: 676170.1250; val_masked_gp_l1_reg_loss: 9519.8154; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71829.8984; val_chrom_access_recon_loss: 1304886.3750; val_global_loss: 2491169.7500; val_optim_loss: 2491169.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8364; val_auprc_score: 0.8350; val_best_acc_score: 0.6002; val_best_f1_score: 0.7087; train_kl_reg_loss: 22566.0556; train_edge_recon_loss: 359851.5104; train_gene_expr_recon_loss: 673491.8125; train_masked_gp_l1_reg_loss: 9511.0063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70328.9384; train_chrom_access_recon_loss: 1313041.3056; train_global_loss: 2448790.6111; train_optim_loss: 2448790.6111; val_kl_reg_loss: 22308.4961; val_edge_recon_loss: 405759.6562; val_gene_expr_recon_loss: 671057.0625; val_masked_gp_l1_reg_loss: 9488.9131; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68475.3516; val_chrom_access_recon_loss: 1301666.7500; val_global_loss: 2478756.2500; val_optim_loss: 2478756.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8323; val_auprc_score: 0.8243; val_best_acc_score: 0.6739; val_best_f1_score: 0.7441; train_kl_reg_loss: 22578.9086; train_edge_recon_loss: 359406.8472; train_gene_expr_recon_loss: 665804.1667; train_masked_gp_l1_reg_loss: 9483.7079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67040.4870; train_chrom_access_recon_loss: 1301023.4167; train_global_loss: 2425337.5278; train_optim_loss: 2425337.5278; val_kl_reg_loss: 21576.8789; val_edge_recon_loss: 404998.9062; val_gene_expr_recon_loss: 666584.2500; val_masked_gp_l1_reg_loss: 9465.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65268.9453; val_chrom_access_recon_loss: 1298506.6250; val_global_loss: 2466401.0000; val_optim_loss: 2466401.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8252; val_auprc_score: 0.8170; val_best_acc_score: 0.7234; val_best_f1_score: 0.7633; train_kl_reg_loss: 22386.5158; train_edge_recon_loss: 358936.9479; train_gene_expr_recon_loss: 663131.6944; train_masked_gp_l1_reg_loss: 9462.4448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63901.2561; train_chrom_access_recon_loss: 1301719.9861; train_global_loss: 2419538.8611; train_optim_loss: 2419538.8611; val_kl_reg_loss: 20785.9414; val_edge_recon_loss: 403694.4062; val_gene_expr_recon_loss: 663571.6250; val_masked_gp_l1_reg_loss: 9441.0137; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62218.5586; val_chrom_access_recon_loss: 1295818.3750; val_global_loss: 2455530.0000; val_optim_loss: 2455530.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8296; val_auprc_score: 0.8259; val_best_acc_score: 0.7440; val_best_f1_score: 0.7594; train_kl_reg_loss: 22220.3553; train_edge_recon_loss: 358540.2153; train_gene_expr_recon_loss: 663020.7778; train_masked_gp_l1_reg_loss: 9437.0494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60927.8780; train_chrom_access_recon_loss: 1301224.0417; train_global_loss: 2415370.3056; train_optim_loss: 2415370.3056; val_kl_reg_loss: 21052.7832; val_edge_recon_loss: 402354.7812; val_gene_expr_recon_loss: 660644.9375; val_masked_gp_l1_reg_loss: 9426.4043; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59344.7695; val_chrom_access_recon_loss: 1293585.5000; val_global_loss: 2446409.0000; val_optim_loss: 2446409.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8253; val_auprc_score: 0.8202; val_best_acc_score: 0.7334; val_best_f1_score: 0.7456; train_kl_reg_loss: 21858.4110; train_edge_recon_loss: 357901.1632; train_gene_expr_recon_loss: 657710.8403; train_masked_gp_l1_reg_loss: 9427.8121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58136.1562; train_chrom_access_recon_loss: 1297859.5417; train_global_loss: 2402893.8889; train_optim_loss: 2402893.8889; val_kl_reg_loss: 20746.3750; val_edge_recon_loss: 400124.6875; val_gene_expr_recon_loss: 658632.7500; val_masked_gp_l1_reg_loss: 9408.4072; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56653.2500; val_chrom_access_recon_loss: 1291372.2500; val_global_loss: 2436937.5000; val_optim_loss: 2436937.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8253; val_auprc_score: 0.8144; val_best_acc_score: 0.7199; val_best_f1_score: 0.7654; train_kl_reg_loss: 21349.4579; train_edge_recon_loss: 357051.6389; train_gene_expr_recon_loss: 655557.4722; train_masked_gp_l1_reg_loss: 9402.9478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55526.5503; train_chrom_access_recon_loss: 1293830.4028; train_global_loss: 2392718.5000; train_optim_loss: 2392718.5000; val_kl_reg_loss: 20632.8594; val_edge_recon_loss: 396654.0000; val_gene_expr_recon_loss: 656870.8750; val_masked_gp_l1_reg_loss: 9388.1748; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54143.2422; val_chrom_access_recon_loss: 1289674.5000; val_global_loss: 2427363.5000; val_optim_loss: 2427363.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8438; val_auprc_score: 0.8356; val_best_acc_score: 0.7509; val_best_f1_score: 0.7744; train_kl_reg_loss: 20965.2422; train_edge_recon_loss: 355700.3681; train_gene_expr_recon_loss: 654962.2083; train_masked_gp_l1_reg_loss: 9389.6233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53090.4006; train_chrom_access_recon_loss: 1293640.0833; train_global_loss: 2387747.9722; train_optim_loss: 2387747.9722; val_kl_reg_loss: 20169.2070; val_edge_recon_loss: 390531.9688; val_gene_expr_recon_loss: 655781.2500; val_masked_gp_l1_reg_loss: 9383.2607; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51797.6875; val_chrom_access_recon_loss: 1287809.3750; val_global_loss: 2415473.0000; val_optim_loss: 2415473.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8573; val_auprc_score: 0.8504; val_best_acc_score: 0.7730; val_best_f1_score: 0.7898; train_kl_reg_loss: 20199.5033; train_edge_recon_loss: 353268.5903; train_gene_expr_recon_loss: 654525.5556; train_masked_gp_l1_reg_loss: 9392.2402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50812.8828; train_chrom_access_recon_loss: 1293469.2639; train_global_loss: 2381668.0278; train_optim_loss: 2381668.0278; val_kl_reg_loss: 19131.8984; val_edge_recon_loss: 379510.8125; val_gene_expr_recon_loss: 655309.8125; val_masked_gp_l1_reg_loss: 9389.0342; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49599.7344; val_chrom_access_recon_loss: 1286016.1250; val_global_loss: 2398957.5000; val_optim_loss: 2398957.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8698; val_auprc_score: 0.8603; val_best_acc_score: 0.7890; val_best_f1_score: 0.7996; train_kl_reg_loss: 19436.0388; train_edge_recon_loss: 347654.9444; train_gene_expr_recon_loss: 653463.7639; train_masked_gp_l1_reg_loss: 9398.2470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48671.2470; train_chrom_access_recon_loss: 1285526.7083; train_global_loss: 2364150.9444; train_optim_loss: 2364150.9444; val_kl_reg_loss: 19081.6406; val_edge_recon_loss: 359914.5312; val_gene_expr_recon_loss: 655434.2500; val_masked_gp_l1_reg_loss: 9409.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47530.2266; val_chrom_access_recon_loss: 1284663.6250; val_global_loss: 2376033.7500; val_optim_loss: 2376033.7500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8761; val_auprc_score: 0.8615; val_best_acc_score: 0.7914; val_best_f1_score: 0.8050; train_kl_reg_loss: 20945.3086; train_edge_recon_loss: 335658.3542; train_gene_expr_recon_loss: 652396.6458; train_masked_gp_l1_reg_loss: 9433.4144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46662.3663; train_chrom_access_recon_loss: 1284939.5972; train_global_loss: 2350035.6389; train_optim_loss: 2350035.6389; val_kl_reg_loss: 23431.6484; val_edge_recon_loss: 330048.2188; val_gene_expr_recon_loss: 656284.0000; val_masked_gp_l1_reg_loss: 9459.9541; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45593.4180; val_chrom_access_recon_loss: 1284316.8750; val_global_loss: 2349134.0000; val_optim_loss: 2349134.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8795; val_auprc_score: 0.8687; val_best_acc_score: 0.7935; val_best_f1_score: 0.8075; train_kl_reg_loss: 27433.7231; train_edge_recon_loss: 319726.0312; train_gene_expr_recon_loss: 651997.0903; train_masked_gp_l1_reg_loss: 9483.6216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44780.4800; train_chrom_access_recon_loss: 1283987.3611; train_global_loss: 2337408.2778; train_optim_loss: 2337408.2778; val_kl_reg_loss: 30088.9473; val_edge_recon_loss: 315874.3438; val_gene_expr_recon_loss: 655057.8750; val_masked_gp_l1_reg_loss: 9521.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43781.9297; val_chrom_access_recon_loss: 1282164.3750; val_global_loss: 2336488.7500; val_optim_loss: 2336488.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9045; val_auprc_score: 0.8882; val_best_acc_score: 0.8238; val_best_f1_score: 0.8379; train_kl_reg_loss: 28385.1248; train_edge_recon_loss: 356652.6389; train_gene_expr_recon_loss: 916077.1875; train_masked_gp_l1_reg_loss: 9652.5034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42905.2122; train_chrom_access_recon_loss: 1359883.8194; train_global_loss: 2713556.4444; train_optim_loss: 2713556.4444; val_kl_reg_loss: 12085.3555; val_edge_recon_loss: 364482.3750; val_gene_expr_recon_loss: 915613.8125; val_masked_gp_l1_reg_loss: 9884.5713; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41749.3906; val_chrom_access_recon_loss: 1354535.0000; val_global_loss: 2698350.5000; val_optim_loss: 2698350.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9097; val_auprc_score: 0.8920; val_best_acc_score: 0.8319; val_best_f1_score: 0.8420; train_kl_reg_loss: 22748.5093; train_edge_recon_loss: 347351.0694; train_gene_expr_recon_loss: 912485.2639; train_masked_gp_l1_reg_loss: 10119.6914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40794.4388; train_chrom_access_recon_loss: 1360717.7222; train_global_loss: 2694216.6111; train_optim_loss: 2694216.6111; val_kl_reg_loss: 13047.1777; val_edge_recon_loss: 363637.4062; val_gene_expr_recon_loss: 911626.8750; val_masked_gp_l1_reg_loss: 10393.9180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39610.7812; val_chrom_access_recon_loss: 1352802.8750; val_global_loss: 2691119.0000; val_optim_loss: 2691119.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9123; val_auprc_score: 0.8985; val_best_acc_score: 0.8319; val_best_f1_score: 0.8424; train_kl_reg_loss: 19517.1895; train_edge_recon_loss: 341533.3160; train_gene_expr_recon_loss: 913852.2153; train_masked_gp_l1_reg_loss: 10585.9435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38694.4740; train_chrom_access_recon_loss: 1357450.0694; train_global_loss: 2681633.2222; train_optim_loss: 2681633.2222; val_kl_reg_loss: 11190.0742; val_edge_recon_loss: 341455.8750; val_gene_expr_recon_loss: 909921.7500; val_masked_gp_l1_reg_loss: 10805.1865; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37570.9961; val_chrom_access_recon_loss: 1352113.3750; val_global_loss: 2663057.2500; val_optim_loss: 2663057.2500
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8979; val_auprc_score: 0.8729; val_best_acc_score: 0.8203; val_best_f1_score: 0.8313; train_kl_reg_loss: 18597.1710; train_edge_recon_loss: 326989.4201; train_gene_expr_recon_loss: 913798.4097; train_masked_gp_l1_reg_loss: 10953.7748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36713.0981; train_chrom_access_recon_loss: 1361774.6250; train_global_loss: 2668826.5000; train_optim_loss: 2668826.5000; val_kl_reg_loss: 11329.4697; val_edge_recon_loss: 321634.5000; val_gene_expr_recon_loss: 910604.5000; val_masked_gp_l1_reg_loss: 11121.1816; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35666.7891; val_chrom_access_recon_loss: 1352723.0000; val_global_loss: 2643079.5000; val_optim_loss: 2643079.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9077; val_auprc_score: 0.8897; val_best_acc_score: 0.8246; val_best_f1_score: 0.8351; train_kl_reg_loss: 17998.0069; train_edge_recon_loss: 318324.2812; train_gene_expr_recon_loss: 907489.3681; train_masked_gp_l1_reg_loss: 11057.3447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35551.2114; train_chrom_access_recon_loss: 1363413.2917; train_global_loss: 2653833.4722; train_optim_loss: 2653833.4722; val_kl_reg_loss: 11153.5664; val_edge_recon_loss: 319024.1250; val_gene_expr_recon_loss: 910975.8750; val_masked_gp_l1_reg_loss: 11006.0400; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35410.6172; val_chrom_access_recon_loss: 1353843.6250; val_global_loss: 2641413.7500; val_optim_loss: 2641413.7500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9013; val_auprc_score: 0.8815; val_best_acc_score: 0.8204; val_best_f1_score: 0.8316; train_kl_reg_loss: 17757.6274; train_edge_recon_loss: 317433.5625; train_gene_expr_recon_loss: 911386.3125; train_masked_gp_l1_reg_loss: 10998.1608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35311.2105; train_chrom_access_recon_loss: 1361100.7778; train_global_loss: 2653987.6389; train_optim_loss: 2653987.6389; val_kl_reg_loss: 11219.7129; val_edge_recon_loss: 319857.9375; val_gene_expr_recon_loss: 910884.7500; val_masked_gp_l1_reg_loss: 10981.2002; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35186.1484; val_chrom_access_recon_loss: 1353896.7500; val_global_loss: 2642026.5000; val_optim_loss: 2642026.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8968; val_auprc_score: 0.8718; val_best_acc_score: 0.8185; val_best_f1_score: 0.8307; train_kl_reg_loss: 17651.0953; train_edge_recon_loss: 317493.6528; train_gene_expr_recon_loss: 909462.8264; train_masked_gp_l1_reg_loss: 10974.3860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35091.3008; train_chrom_access_recon_loss: 1360723.6806; train_global_loss: 2651396.9722; train_optim_loss: 2651396.9722; val_kl_reg_loss: 11326.8047; val_edge_recon_loss: 318699.8125; val_gene_expr_recon_loss: 910578.3750; val_masked_gp_l1_reg_loss: 10967.1436; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34974.3008; val_chrom_access_recon_loss: 1353754.0000; val_global_loss: 2640300.5000; val_optim_loss: 2640300.5000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9022; val_auprc_score: 0.8822; val_best_acc_score: 0.8234; val_best_f1_score: 0.8336; train_kl_reg_loss: 17481.1122; train_edge_recon_loss: 316365.0278; train_gene_expr_recon_loss: 902852.0347; train_masked_gp_l1_reg_loss: 10964.4010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34883.3008; train_chrom_access_recon_loss: 1351813.1806; train_global_loss: 2634359.0278; train_optim_loss: 2634359.0278; val_kl_reg_loss: 11516.5527; val_edge_recon_loss: 318459.5938; val_gene_expr_recon_loss: 909875.0625; val_masked_gp_l1_reg_loss: 10961.8633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34772.5742; val_chrom_access_recon_loss: 1353247.2500; val_global_loss: 2638833.0000; val_optim_loss: 2638833.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9023
val AUPRC score: 0.8878
val best accuracy score: 0.8189
val best F1 score: 0.8310
val target rna MSE score: 4.0148
val source rna MSE score: 3.1949
val target atac MSE score: 0.1358
val source atac MSE score: 0.0196
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
