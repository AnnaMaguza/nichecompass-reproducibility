[True]
Run timestamp: 10102023_001134_80.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_80']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6821; val_auprc_score: 0.6613; val_best_acc_score: 0.5175; val_best_f1_score: 0.6743; train_kl_reg_loss: 52849.8451; train_edge_recon_loss: 3524043.9280; train_gene_expr_recon_loss: 13965239.2273; train_masked_gp_l1_reg_loss: 135073.8533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4523737.8295; train_chrom_access_recon_loss: 6991653.8485; train_global_loss: 29192598.2424; train_optim_loss: 29192598.2424; val_kl_reg_loss: 107524.4570; val_edge_recon_loss: 4064260.9062; val_gene_expr_recon_loss: 12990296.0000; val_masked_gp_l1_reg_loss: 107796.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2074707.5000; val_chrom_access_recon_loss: 6636068.2500; val_global_loss: 25980653.7500; val_optim_loss: 25980653.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6718; val_auprc_score: 0.6431; val_best_acc_score: 0.5801; val_best_f1_score: 0.6984; train_kl_reg_loss: 103637.3576; train_edge_recon_loss: 3526057.7689; train_gene_expr_recon_loss: 12804762.7879; train_masked_gp_l1_reg_loss: 101530.0140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 956974.7519; train_chrom_access_recon_loss: 6636323.1818; train_global_loss: 24129285.7879; train_optim_loss: 24129285.7879; val_kl_reg_loss: 89598.0439; val_edge_recon_loss: 4061522.9375; val_gene_expr_recon_loss: 12881160.7500; val_masked_gp_l1_reg_loss: 98580.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 392140.8125; val_chrom_access_recon_loss: 6708666.0625; val_global_loss: 24231668.5000; val_optim_loss: 24231668.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7563; val_auprc_score: 0.7317; val_best_acc_score: 0.6846; val_best_f1_score: 0.7121; train_kl_reg_loss: 97136.5015; train_edge_recon_loss: 3518710.8371; train_gene_expr_recon_loss: 12649394.3939; train_masked_gp_l1_reg_loss: 98440.9157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 266821.1134; train_chrom_access_recon_loss: 6586284.8561; train_global_loss: 23216788.7576; train_optim_loss: 23216788.7576; val_kl_reg_loss: 86484.2568; val_edge_recon_loss: 4033019.4375; val_gene_expr_recon_loss: 12840199.5000; val_masked_gp_l1_reg_loss: 99141.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189499.8281; val_chrom_access_recon_loss: 6721984.5625; val_global_loss: 23970329.2500; val_optim_loss: 23970329.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8229; val_auprc_score: 0.7965; val_best_acc_score: 0.7437; val_best_f1_score: 0.7666; train_kl_reg_loss: 80917.8061; train_edge_recon_loss: 3486519.9356; train_gene_expr_recon_loss: 12557226.6212; train_masked_gp_l1_reg_loss: 100631.7987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 156036.4619; train_chrom_access_recon_loss: 6540058.1136; train_global_loss: 22921390.8182; train_optim_loss: 22921390.8182; val_kl_reg_loss: 64566.5488; val_edge_recon_loss: 3629521.1562; val_gene_expr_recon_loss: 12648033.0000; val_masked_gp_l1_reg_loss: 103928.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132640.5469; val_chrom_access_recon_loss: 6583142.0000; val_global_loss: 23161831.2500; val_optim_loss: 23161831.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8207; val_auprc_score: 0.7893; val_best_acc_score: 0.7399; val_best_f1_score: 0.7873; train_kl_reg_loss: 85617.4974; train_edge_recon_loss: 3129792.5833; train_gene_expr_recon_loss: 12500062.5152; train_masked_gp_l1_reg_loss: 109937.7011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120284.9336; train_chrom_access_recon_loss: 6508912.9545; train_global_loss: 22454608.0909; train_optim_loss: 22454608.0909; val_kl_reg_loss: 115722.6758; val_edge_recon_loss: 2997910.1875; val_gene_expr_recon_loss: 12457363.8750; val_masked_gp_l1_reg_loss: 113960.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110547.0625; val_chrom_access_recon_loss: 6468583.8125; val_global_loss: 22264088.2500; val_optim_loss: 22264088.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8551; val_auprc_score: 0.8254; val_best_acc_score: 0.7614; val_best_f1_score: 0.7973; train_kl_reg_loss: 109215.4757; train_edge_recon_loss: 2955223.8674; train_gene_expr_recon_loss: 12413907.9848; train_masked_gp_l1_reg_loss: 114973.4112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104903.9065; train_chrom_access_recon_loss: 6462453.0758; train_global_loss: 22160677.7576; train_optim_loss: 22160677.7576; val_kl_reg_loss: 104922.0312; val_edge_recon_loss: 2920660.4688; val_gene_expr_recon_loss: 12557610.3750; val_masked_gp_l1_reg_loss: 115666.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100640.1406; val_chrom_access_recon_loss: 6506776.6250; val_global_loss: 22306276.0000; val_optim_loss: 22306276.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8566; val_auprc_score: 0.8187; val_best_acc_score: 0.7818; val_best_f1_score: 0.7984; train_kl_reg_loss: 106603.3361; train_edge_recon_loss: 2925098.4848; train_gene_expr_recon_loss: 12350443.6061; train_masked_gp_l1_reg_loss: 116605.4736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96681.9259; train_chrom_access_recon_loss: 6436762.9545; train_global_loss: 22032196.0000; train_optim_loss: 22032196.0000; val_kl_reg_loss: 102980.0098; val_edge_recon_loss: 2946870.0312; val_gene_expr_recon_loss: 12425932.0000; val_masked_gp_l1_reg_loss: 117419.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93502.4531; val_chrom_access_recon_loss: 6422283.3125; val_global_loss: 22108986.2500; val_optim_loss: 22108986.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8660; val_auprc_score: 0.8276; val_best_acc_score: 0.7947; val_best_f1_score: 0.8138; train_kl_reg_loss: 101549.4432; train_edge_recon_loss: 2910428.2348; train_gene_expr_recon_loss: 12294904.1212; train_masked_gp_l1_reg_loss: 118223.2144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90948.2035; train_chrom_access_recon_loss: 6410583.6515; train_global_loss: 21926636.7879; train_optim_loss: 21926636.7879; val_kl_reg_loss: 100181.6943; val_edge_recon_loss: 2892611.8438; val_gene_expr_recon_loss: 12410030.8750; val_masked_gp_l1_reg_loss: 119091.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89104.0469; val_chrom_access_recon_loss: 6449745.4375; val_global_loss: 22060764.7500; val_optim_loss: 22060764.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8719; val_auprc_score: 0.8325; val_best_acc_score: 0.8087; val_best_f1_score: 0.8250; train_kl_reg_loss: 101010.3664; train_edge_recon_loss: 2887278.9015; train_gene_expr_recon_loss: 12247348.8939; train_masked_gp_l1_reg_loss: 120054.6258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87843.8407; train_chrom_access_recon_loss: 6379269.4545; train_global_loss: 21822806.2424; train_optim_loss: 21822806.2424; val_kl_reg_loss: 104822.9990; val_edge_recon_loss: 2913413.1562; val_gene_expr_recon_loss: 12402434.3750; val_masked_gp_l1_reg_loss: 121046.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86994.7812; val_chrom_access_recon_loss: 6461451.9375; val_global_loss: 22090164.5000; val_optim_loss: 22090164.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8780; val_auprc_score: 0.8258; val_best_acc_score: 0.8200; val_best_f1_score: 0.8369; train_kl_reg_loss: 99705.6945; train_edge_recon_loss: 2859387.7689; train_gene_expr_recon_loss: 12193184.5152; train_masked_gp_l1_reg_loss: 122035.9629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86886.8718; train_chrom_access_recon_loss: 6358580.1970; train_global_loss: 21719781.0000; train_optim_loss: 21719781.0000; val_kl_reg_loss: 99126.4824; val_edge_recon_loss: 2954384.4062; val_gene_expr_recon_loss: 12244070.6250; val_masked_gp_l1_reg_loss: 123565.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87462.4922; val_chrom_access_recon_loss: 6392192.0000; val_global_loss: 21900801.5000; val_optim_loss: 21900801.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8920; val_auprc_score: 0.8506; val_best_acc_score: 0.8385; val_best_f1_score: 0.8499; train_kl_reg_loss: 101215.0400; train_edge_recon_loss: 2844250.7462; train_gene_expr_recon_loss: 12149491.3485; train_masked_gp_l1_reg_loss: 123917.5500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86664.8357; train_chrom_access_recon_loss: 6340181.9242; train_global_loss: 21645721.5455; train_optim_loss: 21645721.5455; val_kl_reg_loss: 102347.4639; val_edge_recon_loss: 2858784.7812; val_gene_expr_recon_loss: 12205734.2500; val_masked_gp_l1_reg_loss: 124435.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86278.7344; val_chrom_access_recon_loss: 6393057.7500; val_global_loss: 21770638.0000; val_optim_loss: 21770638.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8880; val_auprc_score: 0.8508; val_best_acc_score: 0.8302; val_best_f1_score: 0.8454; train_kl_reg_loss: 101832.0548; train_edge_recon_loss: 2814632.1705; train_gene_expr_recon_loss: 12098386.1212; train_masked_gp_l1_reg_loss: 125195.5054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85069.0598; train_chrom_access_recon_loss: 6312244.2576; train_global_loss: 21537359.0909; train_optim_loss: 21537359.0909; val_kl_reg_loss: 101481.3730; val_edge_recon_loss: 2870225.7812; val_gene_expr_recon_loss: 12170689.6250; val_masked_gp_l1_reg_loss: 125854.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83892.3203; val_chrom_access_recon_loss: 6316127.1875; val_global_loss: 21668269.5000; val_optim_loss: 21668269.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8958; val_auprc_score: 0.8540; val_best_acc_score: 0.8409; val_best_f1_score: 0.8548; train_kl_reg_loss: 103014.8009; train_edge_recon_loss: 2792866.7424; train_gene_expr_recon_loss: 12068518.3939; train_masked_gp_l1_reg_loss: 126513.5524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83696.1219; train_chrom_access_recon_loss: 6299867.8561; train_global_loss: 21474477.4848; train_optim_loss: 21474477.4848; val_kl_reg_loss: 105206.3232; val_edge_recon_loss: 2843642.5625; val_gene_expr_recon_loss: 12264995.5000; val_masked_gp_l1_reg_loss: 127139.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83037.1641; val_chrom_access_recon_loss: 6401809.2500; val_global_loss: 21825829.2500; val_optim_loss: 21825829.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9042; val_auprc_score: 0.8741; val_best_acc_score: 0.8415; val_best_f1_score: 0.8558; train_kl_reg_loss: 100748.3797; train_edge_recon_loss: 2789813.0152; train_gene_expr_recon_loss: 12021354.5758; train_masked_gp_l1_reg_loss: 127837.5144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82704.6913; train_chrom_access_recon_loss: 6279676.1667; train_global_loss: 21402134.4242; train_optim_loss: 21402134.4242; val_kl_reg_loss: 105144.8877; val_edge_recon_loss: 2805560.6562; val_gene_expr_recon_loss: 12197734.5000; val_masked_gp_l1_reg_loss: 128331.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81916.6719; val_chrom_access_recon_loss: 6384274.8750; val_global_loss: 21702963.5000; val_optim_loss: 21702963.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9019; val_auprc_score: 0.8597; val_best_acc_score: 0.8450; val_best_f1_score: 0.8589; train_kl_reg_loss: 101194.7399; train_edge_recon_loss: 2776439.6856; train_gene_expr_recon_loss: 11975656.9697; train_masked_gp_l1_reg_loss: 128754.2002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81321.5041; train_chrom_access_recon_loss: 6246958.5000; train_global_loss: 21310325.5455; train_optim_loss: 21310325.5455; val_kl_reg_loss: 105306.3545; val_edge_recon_loss: 2818412.0000; val_gene_expr_recon_loss: 12103440.1250; val_masked_gp_l1_reg_loss: 129530.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80978.8281; val_chrom_access_recon_loss: 6282594.8125; val_global_loss: 21520263.2500; val_optim_loss: 21520263.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9163; val_auprc_score: 0.8880; val_best_acc_score: 0.8555; val_best_f1_score: 0.8657; train_kl_reg_loss: 101819.9645; train_edge_recon_loss: 2778356.2121; train_gene_expr_recon_loss: 11965231.2121; train_masked_gp_l1_reg_loss: 129537.3594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80455.1938; train_chrom_access_recon_loss: 6245189.1439; train_global_loss: 21300589.1515; train_optim_loss: 21300589.1515; val_kl_reg_loss: 99696.3408; val_edge_recon_loss: 2781362.5625; val_gene_expr_recon_loss: 12009749.0000; val_masked_gp_l1_reg_loss: 129710.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79850.4453; val_chrom_access_recon_loss: 6268988.9375; val_global_loss: 21369357.0000; val_optim_loss: 21369357.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9108; val_auprc_score: 0.8705; val_best_acc_score: 0.8512; val_best_f1_score: 0.8618; train_kl_reg_loss: 99375.5607; train_edge_recon_loss: 2771748.1098; train_gene_expr_recon_loss: 11933795.0000; train_masked_gp_l1_reg_loss: 129973.3822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79454.0984; train_chrom_access_recon_loss: 6225144.5379; train_global_loss: 21239490.5758; train_optim_loss: 21239490.5758; val_kl_reg_loss: 98715.0645; val_edge_recon_loss: 2808720.5312; val_gene_expr_recon_loss: 11999836.8750; val_masked_gp_l1_reg_loss: 130415.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79538.7734; val_chrom_access_recon_loss: 6232251.4375; val_global_loss: 21349479.2500; val_optim_loss: 21349479.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9196; val_auprc_score: 0.8948; val_best_acc_score: 0.8541; val_best_f1_score: 0.8645; train_kl_reg_loss: 99721.7382; train_edge_recon_loss: 2759611.4924; train_gene_expr_recon_loss: 11892855.3485; train_masked_gp_l1_reg_loss: 130567.8374; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78754.9867; train_chrom_access_recon_loss: 6194115.1288; train_global_loss: 21155626.5152; train_optim_loss: 21155626.5152; val_kl_reg_loss: 103949.7803; val_edge_recon_loss: 2820476.1562; val_gene_expr_recon_loss: 12027158.2500; val_masked_gp_l1_reg_loss: 130734.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78244.6250; val_chrom_access_recon_loss: 6229367.5000; val_global_loss: 21389930.5000; val_optim_loss: 21389930.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9168; val_auprc_score: 0.8892; val_best_acc_score: 0.8565; val_best_f1_score: 0.8658; train_kl_reg_loss: 98490.7634; train_edge_recon_loss: 2764373.8561; train_gene_expr_recon_loss: 11866068.0606; train_masked_gp_l1_reg_loss: 130895.2185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77689.4401; train_chrom_access_recon_loss: 6178539.2803; train_global_loss: 21116056.6667; train_optim_loss: 21116056.6667; val_kl_reg_loss: 98422.8545; val_edge_recon_loss: 2788191.0000; val_gene_expr_recon_loss: 11978006.3750; val_masked_gp_l1_reg_loss: 131414.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77701.7422; val_chrom_access_recon_loss: 6250945.6875; val_global_loss: 21324683.2500; val_optim_loss: 21324683.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9116; val_auprc_score: 0.8780; val_best_acc_score: 0.8517; val_best_f1_score: 0.8631; train_kl_reg_loss: 97995.1403; train_edge_recon_loss: 2768144.4432; train_gene_expr_recon_loss: 11845951.5455; train_masked_gp_l1_reg_loss: 131521.4527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77158.5361; train_chrom_access_recon_loss: 6170409.4621; train_global_loss: 21091180.6364; train_optim_loss: 21091180.6364; val_kl_reg_loss: 101009.3740; val_edge_recon_loss: 2811779.7188; val_gene_expr_recon_loss: 11931940.8750; val_masked_gp_l1_reg_loss: 131874.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77017.7734; val_chrom_access_recon_loss: 6253124.6250; val_global_loss: 21306747.0000; val_optim_loss: 21306747.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9201; val_auprc_score: 0.8936; val_best_acc_score: 0.8595; val_best_f1_score: 0.8707; train_kl_reg_loss: 97923.3789; train_edge_recon_loss: 2758980.6364; train_gene_expr_recon_loss: 11819955.0758; train_masked_gp_l1_reg_loss: 131968.4358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76640.2802; train_chrom_access_recon_loss: 6153451.5682; train_global_loss: 21038919.5152; train_optim_loss: 21038919.5152; val_kl_reg_loss: 97050.3809; val_edge_recon_loss: 2792070.3438; val_gene_expr_recon_loss: 11950613.1250; val_masked_gp_l1_reg_loss: 132135.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76389.2969; val_chrom_access_recon_loss: 6171217.8125; val_global_loss: 21219476.7500; val_optim_loss: 21219476.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9280; val_auprc_score: 0.9045; val_best_acc_score: 0.8675; val_best_f1_score: 0.8756; train_kl_reg_loss: 98639.7602; train_edge_recon_loss: 2756569.9583; train_gene_expr_recon_loss: 11791704.6818; train_masked_gp_l1_reg_loss: 132185.6274; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75978.4259; train_chrom_access_recon_loss: 6134504.0606; train_global_loss: 20989582.2121; train_optim_loss: 20989582.2121; val_kl_reg_loss: 97027.1621; val_edge_recon_loss: 2770114.9062; val_gene_expr_recon_loss: 11870320.3750; val_masked_gp_l1_reg_loss: 132012.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75825.2734; val_chrom_access_recon_loss: 6161389.7500; val_global_loss: 21106690.7500; val_optim_loss: 21106690.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9223; val_auprc_score: 0.8973; val_best_acc_score: 0.8646; val_best_f1_score: 0.8736; train_kl_reg_loss: 96219.6567; train_edge_recon_loss: 2746990.8295; train_gene_expr_recon_loss: 11763828.8939; train_masked_gp_l1_reg_loss: 132390.9664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75577.2878; train_chrom_access_recon_loss: 6120458.9621; train_global_loss: 20935466.6364; train_optim_loss: 20935466.6364; val_kl_reg_loss: 97852.4590; val_edge_recon_loss: 2776310.5625; val_gene_expr_recon_loss: 11846886.7500; val_masked_gp_l1_reg_loss: 132809.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75383.6484; val_chrom_access_recon_loss: 6181061.7500; val_global_loss: 21110304.7500; val_optim_loss: 21110304.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9263; val_auprc_score: 0.8981; val_best_acc_score: 0.8681; val_best_f1_score: 0.8786; train_kl_reg_loss: 96878.2124; train_edge_recon_loss: 2748062.5000; train_gene_expr_recon_loss: 11741011.0000; train_masked_gp_l1_reg_loss: 132649.5627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75303.1547; train_chrom_access_recon_loss: 6106444.0379; train_global_loss: 20900348.3636; train_optim_loss: 20900348.3636; val_kl_reg_loss: 98077.6602; val_edge_recon_loss: 2786346.5312; val_gene_expr_recon_loss: 11880561.1250; val_masked_gp_l1_reg_loss: 132650.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74930.8281; val_chrom_access_recon_loss: 6162764.7500; val_global_loss: 21135332.2500; val_optim_loss: 21135332.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9297; val_auprc_score: 0.9031; val_best_acc_score: 0.8748; val_best_f1_score: 0.8811; train_kl_reg_loss: 96971.5038; train_edge_recon_loss: 2737450.3712; train_gene_expr_recon_loss: 11719682.7727; train_masked_gp_l1_reg_loss: 132742.6946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74788.6462; train_chrom_access_recon_loss: 6088336.1136; train_global_loss: 20849971.9091; train_optim_loss: 20849971.9091; val_kl_reg_loss: 96066.1953; val_edge_recon_loss: 2778070.8125; val_gene_expr_recon_loss: 11821943.2500; val_masked_gp_l1_reg_loss: 132712.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74545.4688; val_chrom_access_recon_loss: 6150988.5625; val_global_loss: 21054326.5000; val_optim_loss: 21054326.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9222; val_auprc_score: 0.8969; val_best_acc_score: 0.8600; val_best_f1_score: 0.8717; train_kl_reg_loss: 123057.0115; train_edge_recon_loss: 2856712.2500; train_gene_expr_recon_loss: 11056000.2879; train_masked_gp_l1_reg_loss: 133668.2488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75002.8748; train_chrom_access_recon_loss: 5850869.8258; train_global_loss: 20095310.3636; train_optim_loss: 20095310.3636; val_kl_reg_loss: 45457.3760; val_edge_recon_loss: 2838088.9688; val_gene_expr_recon_loss: 11163511.2500; val_masked_gp_l1_reg_loss: 134213.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75273.3672; val_chrom_access_recon_loss: 5793246.8750; val_global_loss: 20049790.2500; val_optim_loss: 20049790.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9271; val_auprc_score: 0.9001; val_best_acc_score: 0.8694; val_best_f1_score: 0.8784; train_kl_reg_loss: 101360.6410; train_edge_recon_loss: 2768509.6818; train_gene_expr_recon_loss: 11005249.1212; train_masked_gp_l1_reg_loss: 134063.2124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75288.8601; train_chrom_access_recon_loss: 5787460.0833; train_global_loss: 19871931.5152; train_optim_loss: 19871931.5152; val_kl_reg_loss: 54773.5747; val_edge_recon_loss: 2769047.8438; val_gene_expr_recon_loss: 11163863.2500; val_masked_gp_l1_reg_loss: 133559.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74851.2500; val_chrom_access_recon_loss: 5852312.1875; val_global_loss: 20048407.0000; val_optim_loss: 20048407.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9344; val_auprc_score: 0.9097; val_best_acc_score: 0.8802; val_best_f1_score: 0.8870; train_kl_reg_loss: 87062.5438; train_edge_recon_loss: 2743843.1629; train_gene_expr_recon_loss: 10986458.4697; train_masked_gp_l1_reg_loss: 132644.0836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74509.7940; train_chrom_access_recon_loss: 5774334.9545; train_global_loss: 19798852.9697; train_optim_loss: 19798852.9697; val_kl_reg_loss: 63399.6694; val_edge_recon_loss: 2748353.0938; val_gene_expr_recon_loss: 11119643.0000; val_masked_gp_l1_reg_loss: 131716.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73943.8203; val_chrom_access_recon_loss: 5791797.0000; val_global_loss: 19928852.7500; val_optim_loss: 19928852.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9222; val_auprc_score: 0.8884; val_best_acc_score: 0.8667; val_best_f1_score: 0.8765; train_kl_reg_loss: 83337.7868; train_edge_recon_loss: 2739328.3561; train_gene_expr_recon_loss: 10964434.3788; train_masked_gp_l1_reg_loss: 130699.9581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73448.8074; train_chrom_access_recon_loss: 5765372.9242; train_global_loss: 19756622.1515; train_optim_loss: 19756622.1515; val_kl_reg_loss: 67550.7061; val_edge_recon_loss: 2810349.5312; val_gene_expr_recon_loss: 11144685.5000; val_masked_gp_l1_reg_loss: 129814.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73300.7422; val_chrom_access_recon_loss: 5838111.1250; val_global_loss: 20063813.0000; val_optim_loss: 20063813.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9275; val_auprc_score: 0.8998; val_best_acc_score: 0.8689; val_best_f1_score: 0.8761; train_kl_reg_loss: 80892.8137; train_edge_recon_loss: 2736078.2614; train_gene_expr_recon_loss: 10941915.6364; train_masked_gp_l1_reg_loss: 128803.4866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72881.3153; train_chrom_access_recon_loss: 5751558.1288; train_global_loss: 19712129.6061; train_optim_loss: 19712129.6061; val_kl_reg_loss: 70536.3906; val_edge_recon_loss: 2778977.9688; val_gene_expr_recon_loss: 11097462.8750; val_masked_gp_l1_reg_loss: 127889.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71861.3281; val_chrom_access_recon_loss: 5804306.5625; val_global_loss: 19951033.7500; val_optim_loss: 19951033.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9327; val_auprc_score: 0.9020; val_best_acc_score: 0.8794; val_best_f1_score: 0.8867; train_kl_reg_loss: 79078.3084; train_edge_recon_loss: 2732480.5379; train_gene_expr_recon_loss: 10932082.1667; train_masked_gp_l1_reg_loss: 127142.0350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72202.5782; train_chrom_access_recon_loss: 5754381.9015; train_global_loss: 19697367.4848; train_optim_loss: 19697367.4848; val_kl_reg_loss: 62041.8354; val_edge_recon_loss: 2746053.7188; val_gene_expr_recon_loss: 11046184.3750; val_masked_gp_l1_reg_loss: 126471.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71302.5391; val_chrom_access_recon_loss: 5766038.5000; val_global_loss: 19818093.2500; val_optim_loss: 19818093.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9334; val_auprc_score: 0.9124; val_best_acc_score: 0.8735; val_best_f1_score: 0.8819; train_kl_reg_loss: 78337.0065; train_edge_recon_loss: 2725376.8485; train_gene_expr_recon_loss: 10909465.3030; train_masked_gp_l1_reg_loss: 126125.2908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71739.2625; train_chrom_access_recon_loss: 5734467.9924; train_global_loss: 19645511.6970; train_optim_loss: 19645511.6970; val_kl_reg_loss: 70773.5498; val_edge_recon_loss: 2769284.5938; val_gene_expr_recon_loss: 11035680.2500; val_masked_gp_l1_reg_loss: 125566.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71413.5469; val_chrom_access_recon_loss: 5763808.4375; val_global_loss: 19836528.0000; val_optim_loss: 19836528.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9322; val_auprc_score: 0.9030; val_best_acc_score: 0.8753; val_best_f1_score: 0.8827; train_kl_reg_loss: 79623.2480; train_edge_recon_loss: 2722256.8977; train_gene_expr_recon_loss: 10899542.8636; train_masked_gp_l1_reg_loss: 125147.4041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71180.2350; train_chrom_access_recon_loss: 5726205.5909; train_global_loss: 19623956.1515; train_optim_loss: 19623956.1515; val_kl_reg_loss: 70685.7510; val_edge_recon_loss: 2761027.2812; val_gene_expr_recon_loss: 11006447.6250; val_masked_gp_l1_reg_loss: 124672.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71099.1719; val_chrom_access_recon_loss: 5737609.2500; val_global_loss: 19771540.7500; val_optim_loss: 19771540.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9396; val_auprc_score: 0.9147; val_best_acc_score: 0.8802; val_best_f1_score: 0.8873; train_kl_reg_loss: 81446.7891; train_edge_recon_loss: 2721236.8750; train_gene_expr_recon_loss: 10875724.7879; train_masked_gp_l1_reg_loss: 124122.6568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70785.4487; train_chrom_access_recon_loss: 5707999.9470; train_global_loss: 19581316.6364; train_optim_loss: 19581316.6364; val_kl_reg_loss: 70263.2129; val_edge_recon_loss: 2712145.1250; val_gene_expr_recon_loss: 11012726.7500; val_masked_gp_l1_reg_loss: 123618.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70816.4453; val_chrom_access_recon_loss: 5740135.2500; val_global_loss: 19729705.2500; val_optim_loss: 19729705.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9379; val_auprc_score: 0.9159; val_best_acc_score: 0.8791; val_best_f1_score: 0.8877; train_kl_reg_loss: 78578.5213; train_edge_recon_loss: 2721414.0758; train_gene_expr_recon_loss: 10859946.1061; train_masked_gp_l1_reg_loss: 123281.8382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70918.8336; train_chrom_access_recon_loss: 5695846.8485; train_global_loss: 19549986.2424; train_optim_loss: 19549986.2424; val_kl_reg_loss: 72249.9912; val_edge_recon_loss: 2726081.8750; val_gene_expr_recon_loss: 10981576.2500; val_masked_gp_l1_reg_loss: 122969.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70815.1328; val_chrom_access_recon_loss: 5722335.6250; val_global_loss: 19696029.0000; val_optim_loss: 19696029.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9341; val_auprc_score: 0.9068; val_best_acc_score: 0.8751; val_best_f1_score: 0.8836; train_kl_reg_loss: 78362.6501; train_edge_recon_loss: 2728777.4508; train_gene_expr_recon_loss: 10848054.0606; train_masked_gp_l1_reg_loss: 122361.9818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70618.4160; train_chrom_access_recon_loss: 5688867.0076; train_global_loss: 19537041.6364; train_optim_loss: 19537041.6364; val_kl_reg_loss: 70568.1074; val_edge_recon_loss: 2779716.1250; val_gene_expr_recon_loss: 11034568.6250; val_masked_gp_l1_reg_loss: 121879.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70635.8984; val_chrom_access_recon_loss: 5808184.0625; val_global_loss: 19885552.2500; val_optim_loss: 19885552.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9431; val_auprc_score: 0.9207; val_best_acc_score: 0.8853; val_best_f1_score: 0.8898; train_kl_reg_loss: 77365.3741; train_edge_recon_loss: 2707684.9205; train_gene_expr_recon_loss: 10833630.2879; train_masked_gp_l1_reg_loss: 121594.3292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70462.1875; train_chrom_access_recon_loss: 5680505.3030; train_global_loss: 19491242.3333; train_optim_loss: 19491242.3333; val_kl_reg_loss: 72534.0117; val_edge_recon_loss: 2704460.1250; val_gene_expr_recon_loss: 10807842.3750; val_masked_gp_l1_reg_loss: 121139.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70255.5078; val_chrom_access_recon_loss: 5684703.5625; val_global_loss: 19460935.7500; val_optim_loss: 19460935.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9460; val_auprc_score: 0.9280; val_best_acc_score: 0.8866; val_best_f1_score: 0.8925; train_kl_reg_loss: 76649.9477; train_edge_recon_loss: 2718441.3220; train_gene_expr_recon_loss: 10816162.5152; train_masked_gp_l1_reg_loss: 120891.0531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70251.0112; train_chrom_access_recon_loss: 5666809.0379; train_global_loss: 19469204.8788; train_optim_loss: 19469204.8788; val_kl_reg_loss: 72425.2744; val_edge_recon_loss: 2726212.9688; val_gene_expr_recon_loss: 10969884.3750; val_masked_gp_l1_reg_loss: 120502.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70215.6406; val_chrom_access_recon_loss: 5791862.6250; val_global_loss: 19751104.2500; val_optim_loss: 19751104.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9469; val_auprc_score: 0.9293; val_best_acc_score: 0.8909; val_best_f1_score: 0.8950; train_kl_reg_loss: 76137.2634; train_edge_recon_loss: 2719094.1364; train_gene_expr_recon_loss: 10799927.2424; train_masked_gp_l1_reg_loss: 120252.1106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70097.2474; train_chrom_access_recon_loss: 5660891.0455; train_global_loss: 19446398.9394; train_optim_loss: 19446398.9394; val_kl_reg_loss: 74547.0830; val_edge_recon_loss: 2724038.4375; val_gene_expr_recon_loss: 10880652.0000; val_masked_gp_l1_reg_loss: 119944.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69988.0547; val_chrom_access_recon_loss: 5699042.2500; val_global_loss: 19568212.0000; val_optim_loss: 19568212.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9393; val_auprc_score: 0.9096; val_best_acc_score: 0.8858; val_best_f1_score: 0.8913; train_kl_reg_loss: 75289.7824; train_edge_recon_loss: 2705140.2879; train_gene_expr_recon_loss: 10785432.4394; train_masked_gp_l1_reg_loss: 119700.2520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70016.1927; train_chrom_access_recon_loss: 5648711.1136; train_global_loss: 19404289.9394; train_optim_loss: 19404289.9394; val_kl_reg_loss: 73424.6914; val_edge_recon_loss: 2752252.9375; val_gene_expr_recon_loss: 10862972.7500; val_masked_gp_l1_reg_loss: 119401.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70083.9062; val_chrom_access_recon_loss: 5652997.7500; val_global_loss: 19531133.2500; val_optim_loss: 19531133.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9442; val_auprc_score: 0.9232; val_best_acc_score: 0.8907; val_best_f1_score: 0.8968; train_kl_reg_loss: 75456.0550; train_edge_recon_loss: 2703627.7689; train_gene_expr_recon_loss: 10765577.1970; train_masked_gp_l1_reg_loss: 119228.0090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69887.3857; train_chrom_access_recon_loss: 5627838.5985; train_global_loss: 19361614.9394; train_optim_loss: 19361614.9394; val_kl_reg_loss: 71899.0566; val_edge_recon_loss: 2728612.5625; val_gene_expr_recon_loss: 10854969.0000; val_masked_gp_l1_reg_loss: 118984.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69791.2109; val_chrom_access_recon_loss: 5648185.1250; val_global_loss: 19492440.7500; val_optim_loss: 19492440.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9428; val_auprc_score: 0.9163; val_best_acc_score: 0.8882; val_best_f1_score: 0.8942; train_kl_reg_loss: 76161.5419; train_edge_recon_loss: 2699560.6250; train_gene_expr_recon_loss: 10750873.4848; train_masked_gp_l1_reg_loss: 115984.4653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57465.7305; train_chrom_access_recon_loss: 5623384.4697; train_global_loss: 19323430.3333; train_optim_loss: 19323430.3333; val_kl_reg_loss: 72509.2461; val_edge_recon_loss: 2724232.0625; val_gene_expr_recon_loss: 10730843.8750; val_masked_gp_l1_reg_loss: 115073.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55106.9883; val_chrom_access_recon_loss: 5608859.0625; val_global_loss: 19306624.2500; val_optim_loss: 19306624.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9428; val_auprc_score: 0.9223; val_best_acc_score: 0.8847; val_best_f1_score: 0.8914; train_kl_reg_loss: 77792.6224; train_edge_recon_loss: 2703647.1856; train_gene_expr_recon_loss: 10754080.5000; train_masked_gp_l1_reg_loss: 114922.9458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54816.5275; train_chrom_access_recon_loss: 5622127.8409; train_global_loss: 19327387.6667; train_optim_loss: 19327387.6667; val_kl_reg_loss: 73518.9180; val_edge_recon_loss: 2743366.3438; val_gene_expr_recon_loss: 10861875.8750; val_masked_gp_l1_reg_loss: 114838.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54599.2617; val_chrom_access_recon_loss: 5642353.0625; val_global_loss: 19490552.7500; val_optim_loss: 19490552.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9419; val_auprc_score: 0.9163; val_best_acc_score: 0.8788; val_best_f1_score: 0.8853; train_kl_reg_loss: 77840.0782; train_edge_recon_loss: 2714850.6174; train_gene_expr_recon_loss: 10754172.9091; train_masked_gp_l1_reg_loss: 114779.7127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54488.3348; train_chrom_access_recon_loss: 5624956.0076; train_global_loss: 19341087.7273; train_optim_loss: 19341087.7273; val_kl_reg_loss: 73248.3662; val_edge_recon_loss: 2739816.2500; val_gene_expr_recon_loss: 10827977.2500; val_masked_gp_l1_reg_loss: 114713.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54322.2578; val_chrom_access_recon_loss: 5670272.5000; val_global_loss: 19480349.2500; val_optim_loss: 19480349.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9403; val_auprc_score: 0.9111; val_best_acc_score: 0.8858; val_best_f1_score: 0.8916; train_kl_reg_loss: 78344.5924; train_edge_recon_loss: 2707943.1326; train_gene_expr_recon_loss: 10762539.3485; train_masked_gp_l1_reg_loss: 114690.3219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54231.8767; train_chrom_access_recon_loss: 5628037.3712; train_global_loss: 19345786.5758; train_optim_loss: 19345786.5758; val_kl_reg_loss: 75064.7422; val_edge_recon_loss: 2742394.0000; val_gene_expr_recon_loss: 10915427.1250; val_masked_gp_l1_reg_loss: 114646.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54129.4375; val_chrom_access_recon_loss: 5756923.5000; val_global_loss: 19658585.0000; val_optim_loss: 19658585.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9465; val_auprc_score: 0.9300; val_best_acc_score: 0.8866; val_best_f1_score: 0.8929; train_kl_reg_loss: 78554.1219; train_edge_recon_loss: 2703609.2197; train_gene_expr_recon_loss: 10743198.9545; train_masked_gp_l1_reg_loss: 114582.4853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54005.7218; train_chrom_access_recon_loss: 5610281.6288; train_global_loss: 19304232.1212; train_optim_loss: 19304232.1212; val_kl_reg_loss: 74526.9023; val_edge_recon_loss: 2727393.5625; val_gene_expr_recon_loss: 10899590.5000; val_masked_gp_l1_reg_loss: 114591.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53976.7266; val_chrom_access_recon_loss: 5654710.6875; val_global_loss: 19524790.7500; val_optim_loss: 19524790.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9450; val_auprc_score: 0.9211; val_best_acc_score: 0.8933; val_best_f1_score: 0.8991; train_kl_reg_loss: 78209.4411; train_edge_recon_loss: 2715221.2500; train_gene_expr_recon_loss: 10741286.4394; train_masked_gp_l1_reg_loss: 114286.9395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52606.5964; train_chrom_access_recon_loss: 5614924.7652; train_global_loss: 19316535.4848; train_optim_loss: 19316535.4848; val_kl_reg_loss: 73867.2773; val_edge_recon_loss: 2713341.5000; val_gene_expr_recon_loss: 10780380.1250; val_masked_gp_l1_reg_loss: 114179.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52339.9961; val_chrom_access_recon_loss: 5604140.1250; val_global_loss: 19338248.2500; val_optim_loss: 19338248.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9417; val_auprc_score: 0.9199; val_best_acc_score: 0.8845; val_best_f1_score: 0.8914; train_kl_reg_loss: 78388.3891; train_edge_recon_loss: 2714943.0871; train_gene_expr_recon_loss: 10740526.8030; train_masked_gp_l1_reg_loss: 114150.6561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52313.0405; train_chrom_access_recon_loss: 5608006.5152; train_global_loss: 19308328.3939; train_optim_loss: 19308328.3939; val_kl_reg_loss: 74325.1611; val_edge_recon_loss: 2737081.9062; val_gene_expr_recon_loss: 10874063.0000; val_masked_gp_l1_reg_loss: 114131.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52290.9766; val_chrom_access_recon_loss: 5654725.5625; val_global_loss: 19506617.7500; val_optim_loss: 19506617.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9439; val_auprc_score: 0.9189; val_best_acc_score: 0.8893; val_best_f1_score: 0.8956; train_kl_reg_loss: 78389.0902; train_edge_recon_loss: 2702980.7083; train_gene_expr_recon_loss: 10748658.5606; train_masked_gp_l1_reg_loss: 114122.0884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52273.2269; train_chrom_access_recon_loss: 5616428.0000; train_global_loss: 19312851.6970; train_optim_loss: 19312851.6970; val_kl_reg_loss: 74331.1465; val_edge_recon_loss: 2708071.5938; val_gene_expr_recon_loss: 10873579.0000; val_masked_gp_l1_reg_loss: 114110.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52253.4297; val_chrom_access_recon_loss: 5663453.5625; val_global_loss: 19485799.5000; val_optim_loss: 19485799.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9411; val_auprc_score: 0.9118; val_best_acc_score: 0.8837; val_best_f1_score: 0.8902; train_kl_reg_loss: 78358.2184; train_edge_recon_loss: 2701893.4432; train_gene_expr_recon_loss: 10747032.5303; train_masked_gp_l1_reg_loss: 114103.1837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52237.7454; train_chrom_access_recon_loss: 5615423.0303; train_global_loss: 19309048.1212; train_optim_loss: 19309048.1212; val_kl_reg_loss: 73983.2354; val_edge_recon_loss: 2753749.4062; val_gene_expr_recon_loss: 10830711.3750; val_masked_gp_l1_reg_loss: 114097.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52220.9414; val_chrom_access_recon_loss: 5659303.6875; val_global_loss: 19484067.0000; val_optim_loss: 19484067.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 8 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9472
val AUPRC score: 0.9237
val best accuracy score: 0.8952
val best F1 score: 0.8998
val target rna MSE score: 1.9567
val source rna MSE score: 1.1088
val target atac MSE score: 0.3294
val source atac MSE score: 0.1360
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
