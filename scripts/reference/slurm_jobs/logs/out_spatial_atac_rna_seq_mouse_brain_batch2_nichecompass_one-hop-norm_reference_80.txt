[True]
Run timestamp: 07092023_184103_80.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_80']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 18578 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3394 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7897, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3394

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6501; val_auprc_score: 0.6376; val_best_acc_score: 0.5056; val_best_f1_score: 0.6689; train_kl_reg_loss: 81091.1851; train_edge_recon_loss: 3596224.0379; train_gene_expr_recon_loss: 27740669.7273; train_masked_gp_l1_reg_loss: 214316.3061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10870593.1439; train_chrom_access_recon_loss: 8977825.8939; train_global_loss: 51480720.3030; train_optim_loss: 51480720.3030; val_kl_reg_loss: 152554.5547; val_edge_recon_loss: 4065262.1562; val_gene_expr_recon_loss: 25513051.7500; val_masked_gp_l1_reg_loss: 186466.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 4757370.5000; val_chrom_access_recon_loss: 8571232.2500; val_global_loss: 43245937.0000; val_optim_loss: 43245937.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6838; val_auprc_score: 0.6637; val_best_acc_score: 0.5416; val_best_f1_score: 0.6805; train_kl_reg_loss: 159397.9490; train_edge_recon_loss: 3570799.9318; train_gene_expr_recon_loss: 24721334.6364; train_masked_gp_l1_reg_loss: 169832.0786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2121915.9366; train_chrom_access_recon_loss: 8503236.1667; train_global_loss: 39246516.9091; train_optim_loss: 39246516.9091; val_kl_reg_loss: 151373.9766; val_edge_recon_loss: 4062553.5625; val_gene_expr_recon_loss: 24798670.0000; val_masked_gp_l1_reg_loss: 160724.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 849014.3750; val_chrom_access_recon_loss: 8422861.8750; val_global_loss: 38445197.5000; val_optim_loss: 38445197.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6831; val_auprc_score: 0.6672; val_best_acc_score: 0.5951; val_best_f1_score: 0.6920; train_kl_reg_loss: 153784.0975; train_edge_recon_loss: 3554628.9318; train_gene_expr_recon_loss: 24374220.2121; train_masked_gp_l1_reg_loss: 158242.1972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 578880.2822; train_chrom_access_recon_loss: 8420827.1288; train_global_loss: 37240582.9697; train_optim_loss: 37240582.9697; val_kl_reg_loss: 148799.2031; val_edge_recon_loss: 4059170.3750; val_gene_expr_recon_loss: 24644262.0000; val_masked_gp_l1_reg_loss: 157956.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 411282.2188; val_chrom_access_recon_loss: 8355155.1250; val_global_loss: 37776624.0000; val_optim_loss: 37776624.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7368; val_auprc_score: 0.7278; val_best_acc_score: 0.6650; val_best_f1_score: 0.7009; train_kl_reg_loss: 141780.8653; train_edge_recon_loss: 3543627.3939; train_gene_expr_recon_loss: 24198610.7576; train_masked_gp_l1_reg_loss: 158093.2010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 339754.8783; train_chrom_access_recon_loss: 8367238.5455; train_global_loss: 36749105.4545; train_optim_loss: 36749105.4545; val_kl_reg_loss: 136734.5273; val_edge_recon_loss: 4048646.6250; val_gene_expr_recon_loss: 24705723.0000; val_masked_gp_l1_reg_loss: 158696.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 287153.8750; val_chrom_access_recon_loss: 8328923.6875; val_global_loss: 37665877.5000; val_optim_loss: 37665877.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8219; val_auprc_score: 0.8002; val_best_acc_score: 0.7039; val_best_f1_score: 0.7562; train_kl_reg_loss: 130338.4239; train_edge_recon_loss: 3534458.3295; train_gene_expr_recon_loss: 24026015.9394; train_masked_gp_l1_reg_loss: 160805.0343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 258086.2952; train_chrom_access_recon_loss: 8311978.0303; train_global_loss: 36421682.0606; train_optim_loss: 36421682.0606; val_kl_reg_loss: 124756.5889; val_edge_recon_loss: 3978594.1250; val_gene_expr_recon_loss: 24335464.7500; val_masked_gp_l1_reg_loss: 163610.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 233947.4531; val_chrom_access_recon_loss: 8333349.7500; val_global_loss: 37169724.0000; val_optim_loss: 37169724.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8643; val_auprc_score: 0.8332; val_best_acc_score: 0.7985; val_best_f1_score: 0.8209; train_kl_reg_loss: 111435.2118; train_edge_recon_loss: 3465392.5606; train_gene_expr_recon_loss: 23877271.0000; train_masked_gp_l1_reg_loss: 168033.1683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 218393.5445; train_chrom_access_recon_loss: 8256961.0000; train_global_loss: 36097486.3636; train_optim_loss: 36097486.3636; val_kl_reg_loss: 102157.8711; val_edge_recon_loss: 3508789.9688; val_gene_expr_recon_loss: 24293982.0000; val_masked_gp_l1_reg_loss: 175439.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 205725.2969; val_chrom_access_recon_loss: 8294593.8750; val_global_loss: 36580689.5000; val_optim_loss: 36580689.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8555; val_auprc_score: 0.8171; val_best_acc_score: 0.7797; val_best_f1_score: 0.8007; train_kl_reg_loss: 119785.0636; train_edge_recon_loss: 3152909.5038; train_gene_expr_recon_loss: 23875350.7576; train_masked_gp_l1_reg_loss: 181879.6158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 197078.2947; train_chrom_access_recon_loss: 8238731.4091; train_global_loss: 35765734.4242; train_optim_loss: 35765734.4242; val_kl_reg_loss: 144659.6074; val_edge_recon_loss: 3073038.7812; val_gene_expr_recon_loss: 24243159.7500; val_masked_gp_l1_reg_loss: 185258.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 188153.8438; val_chrom_access_recon_loss: 8227973.3750; val_global_loss: 36062243.5000; val_optim_loss: 36062243.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8794; val_auprc_score: 0.8445; val_best_acc_score: 0.8020; val_best_f1_score: 0.8183; train_kl_reg_loss: 152124.7102; train_edge_recon_loss: 2981587.0152; train_gene_expr_recon_loss: 23694029.3030; train_masked_gp_l1_reg_loss: 187132.7848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180911.7841; train_chrom_access_recon_loss: 8177531.4697; train_global_loss: 35373316.9697; train_optim_loss: 35373316.9697; val_kl_reg_loss: 146232.3008; val_edge_recon_loss: 2990472.6562; val_gene_expr_recon_loss: 23983919.0000; val_masked_gp_l1_reg_loss: 189456.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175376.1406; val_chrom_access_recon_loss: 8175359.6875; val_global_loss: 35660815.5000; val_optim_loss: 35660815.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8829; val_auprc_score: 0.8488; val_best_acc_score: 0.8135; val_best_f1_score: 0.8247; train_kl_reg_loss: 152697.9276; train_edge_recon_loss: 2937087.8826; train_gene_expr_recon_loss: 23621592.5758; train_masked_gp_l1_reg_loss: 191576.3871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171949.0066; train_chrom_access_recon_loss: 8158541.4015; train_global_loss: 35233445.2727; train_optim_loss: 35233445.2727; val_kl_reg_loss: 148486.1855; val_edge_recon_loss: 2975508.2188; val_gene_expr_recon_loss: 24005249.2500; val_masked_gp_l1_reg_loss: 193547.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168204.5000; val_chrom_access_recon_loss: 8185184.8750; val_global_loss: 35676180.5000; val_optim_loss: 35676180.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8866; val_auprc_score: 0.8534; val_best_acc_score: 0.8130; val_best_f1_score: 0.8309; train_kl_reg_loss: 145958.8288; train_edge_recon_loss: 2950791.3371; train_gene_expr_recon_loss: 23552202.9394; train_masked_gp_l1_reg_loss: 194875.3523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165207.1468; train_chrom_access_recon_loss: 8125359.1212; train_global_loss: 35134394.7879; train_optim_loss: 35134394.7879; val_kl_reg_loss: 159788.4297; val_edge_recon_loss: 2964950.1562; val_gene_expr_recon_loss: 24094967.2500; val_masked_gp_l1_reg_loss: 195359.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161527.4062; val_chrom_access_recon_loss: 8137483.6875; val_global_loss: 35714077.5000; val_optim_loss: 35714077.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9081; val_auprc_score: 0.8783; val_best_acc_score: 0.8393; val_best_f1_score: 0.8512; train_kl_reg_loss: 159703.8899; train_edge_recon_loss: 2901924.5758; train_gene_expr_recon_loss: 23428777.0303; train_masked_gp_l1_reg_loss: 195052.0575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158403.2076; train_chrom_access_recon_loss: 8085761.8485; train_global_loss: 34929622.5758; train_optim_loss: 34929622.5758; val_kl_reg_loss: 159594.7070; val_edge_recon_loss: 2874565.2188; val_gene_expr_recon_loss: 23964855.7500; val_masked_gp_l1_reg_loss: 196663.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156622.5469; val_chrom_access_recon_loss: 8096241.0000; val_global_loss: 35448542.0000; val_optim_loss: 35448542.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8956; val_auprc_score: 0.8635; val_best_acc_score: 0.8278; val_best_f1_score: 0.8415; train_kl_reg_loss: 158235.9455; train_edge_recon_loss: 2878727.9091; train_gene_expr_recon_loss: 23341990.3939; train_masked_gp_l1_reg_loss: 198102.1444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155287.6998; train_chrom_access_recon_loss: 8054995.1667; train_global_loss: 34787339.3939; train_optim_loss: 34787339.3939; val_kl_reg_loss: 154319.3809; val_edge_recon_loss: 2939466.7812; val_gene_expr_recon_loss: 23745683.5000; val_masked_gp_l1_reg_loss: 200128.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153638.2812; val_chrom_access_recon_loss: 8018696.5625; val_global_loss: 35211932.5000; val_optim_loss: 35211932.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9054; val_auprc_score: 0.8713; val_best_acc_score: 0.8361; val_best_f1_score: 0.8491; train_kl_reg_loss: 156652.1385; train_edge_recon_loss: 2861200.5265; train_gene_expr_recon_loss: 23284069.6364; train_masked_gp_l1_reg_loss: 201095.3321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152987.7938; train_chrom_access_recon_loss: 8034989.7424; train_global_loss: 34690995.2424; train_optim_loss: 34690995.2424; val_kl_reg_loss: 159325.1367; val_edge_recon_loss: 2880018.2500; val_gene_expr_recon_loss: 23733680.0000; val_masked_gp_l1_reg_loss: 202324.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152153.2031; val_chrom_access_recon_loss: 8017664.9375; val_global_loss: 35145167.5000; val_optim_loss: 35145167.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9082; val_auprc_score: 0.8748; val_best_acc_score: 0.8407; val_best_f1_score: 0.8528; train_kl_reg_loss: 157247.6314; train_edge_recon_loss: 2866472.3523; train_gene_expr_recon_loss: 23197107.0909; train_masked_gp_l1_reg_loss: 203283.0173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151222.4543; train_chrom_access_recon_loss: 8001222.4848; train_global_loss: 34576555.0000; train_optim_loss: 34576555.0000; val_kl_reg_loss: 152404.6562; val_edge_recon_loss: 2897782.7812; val_gene_expr_recon_loss: 23567183.7500; val_masked_gp_l1_reg_loss: 204407.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151101.9062; val_chrom_access_recon_loss: 8027367.5625; val_global_loss: 35000248.5000; val_optim_loss: 35000248.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9095; val_auprc_score: 0.8734; val_best_acc_score: 0.8506; val_best_f1_score: 0.8589; train_kl_reg_loss: 153238.0587; train_edge_recon_loss: 2849701.8561; train_gene_expr_recon_loss: 23129122.7879; train_masked_gp_l1_reg_loss: 205213.4306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150463.9524; train_chrom_access_recon_loss: 7983727.8788; train_global_loss: 34471467.9091; train_optim_loss: 34471467.9091; val_kl_reg_loss: 154072.6992; val_edge_recon_loss: 2856486.5000; val_gene_expr_recon_loss: 23642636.0000; val_masked_gp_l1_reg_loss: 206622.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150850.2656; val_chrom_access_recon_loss: 8040418.4375; val_global_loss: 35051085.0000; val_optim_loss: 35051085.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9192; val_auprc_score: 0.8987; val_best_acc_score: 0.8495; val_best_f1_score: 0.8581; train_kl_reg_loss: 151032.0535; train_edge_recon_loss: 2836086.6742; train_gene_expr_recon_loss: 23039450.5152; train_masked_gp_l1_reg_loss: 207309.2393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150590.0166; train_chrom_access_recon_loss: 7950759.0758; train_global_loss: 34335227.3333; train_optim_loss: 34335227.3333; val_kl_reg_loss: 150463.8730; val_edge_recon_loss: 2885804.7188; val_gene_expr_recon_loss: 23481922.7500; val_masked_gp_l1_reg_loss: 208217.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149844.0312; val_chrom_access_recon_loss: 8005018.3125; val_global_loss: 34881271.0000; val_optim_loss: 34881271.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9128; val_auprc_score: 0.8776; val_best_acc_score: 0.8568; val_best_f1_score: 0.8642; train_kl_reg_loss: 152545.3575; train_edge_recon_loss: 2833357.5720; train_gene_expr_recon_loss: 23006706.9394; train_masked_gp_l1_reg_loss: 208591.7673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149384.0315; train_chrom_access_recon_loss: 7935443.8030; train_global_loss: 34286029.8485; train_optim_loss: 34286029.8485; val_kl_reg_loss: 149603.8984; val_edge_recon_loss: 2825771.6875; val_gene_expr_recon_loss: 23397904.2500; val_masked_gp_l1_reg_loss: 209795.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149789.0938; val_chrom_access_recon_loss: 7949824.0000; val_global_loss: 34682690.5000; val_optim_loss: 34682690.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9139; val_auprc_score: 0.8877; val_best_acc_score: 0.8471; val_best_f1_score: 0.8580; train_kl_reg_loss: 149275.7713; train_edge_recon_loss: 2827607.4091; train_gene_expr_recon_loss: 22944748.8485; train_masked_gp_l1_reg_loss: 210157.4692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149418.7375; train_chrom_access_recon_loss: 7913330.6288; train_global_loss: 34194538.5758; train_optim_loss: 34194538.5758; val_kl_reg_loss: 151338.9727; val_edge_recon_loss: 2875236.8750; val_gene_expr_recon_loss: 23301797.2500; val_masked_gp_l1_reg_loss: 210977.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149523.4844; val_chrom_access_recon_loss: 7970492.6250; val_global_loss: 34659367.0000; val_optim_loss: 34659367.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9170; val_auprc_score: 0.8889; val_best_acc_score: 0.8538; val_best_f1_score: 0.8614; train_kl_reg_loss: 149271.1428; train_edge_recon_loss: 2825212.5417; train_gene_expr_recon_loss: 22866823.7273; train_masked_gp_l1_reg_loss: 211451.0779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148586.0185; train_chrom_access_recon_loss: 7884230.7576; train_global_loss: 34085575.2121; train_optim_loss: 34085575.2121; val_kl_reg_loss: 151778.3242; val_edge_recon_loss: 2845863.8438; val_gene_expr_recon_loss: 23304130.0000; val_masked_gp_l1_reg_loss: 212432.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148598.2344; val_chrom_access_recon_loss: 7927882.7500; val_global_loss: 34590686.0000; val_optim_loss: 34590686.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9216; val_auprc_score: 0.8958; val_best_acc_score: 0.8649; val_best_f1_score: 0.8708; train_kl_reg_loss: 148246.4955; train_edge_recon_loss: 2820136.9242; train_gene_expr_recon_loss: 22808138.0303; train_masked_gp_l1_reg_loss: 212749.7289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147681.2441; train_chrom_access_recon_loss: 7862919.3333; train_global_loss: 33999871.7273; train_optim_loss: 33999871.7273; val_kl_reg_loss: 147357.2520; val_edge_recon_loss: 2851881.4688; val_gene_expr_recon_loss: 23127859.0000; val_masked_gp_l1_reg_loss: 213447.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148283.0938; val_chrom_access_recon_loss: 7835710.5000; val_global_loss: 34324540.5000; val_optim_loss: 34324540.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9334; val_auprc_score: 0.9153; val_best_acc_score: 0.8659; val_best_f1_score: 0.8721; train_kl_reg_loss: 147983.6430; train_edge_recon_loss: 2811859.7008; train_gene_expr_recon_loss: 22763757.0000; train_masked_gp_l1_reg_loss: 213681.6323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147509.9621; train_chrom_access_recon_loss: 7848458.1515; train_global_loss: 33933250.3333; train_optim_loss: 33933250.3333; val_kl_reg_loss: 147261.1465; val_edge_recon_loss: 2849222.4688; val_gene_expr_recon_loss: 23085501.7500; val_masked_gp_l1_reg_loss: 214289.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147371.5156; val_chrom_access_recon_loss: 7807560.6875; val_global_loss: 34251207.7500; val_optim_loss: 34251207.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9272; val_auprc_score: 0.8984; val_best_acc_score: 0.8713; val_best_f1_score: 0.8770; train_kl_reg_loss: 147091.5021; train_edge_recon_loss: 2809604.2992; train_gene_expr_recon_loss: 22737250.5152; train_masked_gp_l1_reg_loss: 214765.7389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146687.5611; train_chrom_access_recon_loss: 7829674.0227; train_global_loss: 33885074.0606; train_optim_loss: 33885074.0606; val_kl_reg_loss: 147512.4102; val_edge_recon_loss: 2839322.9062; val_gene_expr_recon_loss: 23002591.0000; val_masked_gp_l1_reg_loss: 215478.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147069.3438; val_chrom_access_recon_loss: 7807076.5625; val_global_loss: 34159051.0000; val_optim_loss: 34159051.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9321; val_auprc_score: 0.9107; val_best_acc_score: 0.8718; val_best_f1_score: 0.8779; train_kl_reg_loss: 143611.8871; train_edge_recon_loss: 2809546.5682; train_gene_expr_recon_loss: 22680118.1212; train_masked_gp_l1_reg_loss: 216203.4560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146293.5052; train_chrom_access_recon_loss: 7809654.9848; train_global_loss: 33805428.3939; train_optim_loss: 33805428.3939; val_kl_reg_loss: 146325.0898; val_edge_recon_loss: 2843308.8438; val_gene_expr_recon_loss: 23003933.7500; val_masked_gp_l1_reg_loss: 217194.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145764.9531; val_chrom_access_recon_loss: 7800080.6250; val_global_loss: 34156606.5000; val_optim_loss: 34156606.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9296; val_auprc_score: 0.9091; val_best_acc_score: 0.8667; val_best_f1_score: 0.8731; train_kl_reg_loss: 144863.8009; train_edge_recon_loss: 2800948.5909; train_gene_expr_recon_loss: 22609460.5152; train_masked_gp_l1_reg_loss: 217888.1922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145230.2453; train_chrom_access_recon_loss: 7790896.3106; train_global_loss: 33709287.9697; train_optim_loss: 33709287.9697; val_kl_reg_loss: 147226.4590; val_edge_recon_loss: 2834486.8125; val_gene_expr_recon_loss: 23171001.2500; val_masked_gp_l1_reg_loss: 218607.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145631.1875; val_chrom_access_recon_loss: 7876433.5625; val_global_loss: 34393388.0000; val_optim_loss: 34393388.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9229; val_auprc_score: 0.9003; val_best_acc_score: 0.8603; val_best_f1_score: 0.8701; train_kl_reg_loss: 142841.3781; train_edge_recon_loss: 2798108.9621; train_gene_expr_recon_loss: 22570244.6970; train_masked_gp_l1_reg_loss: 218954.5028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145564.2798; train_chrom_access_recon_loss: 7778941.4773; train_global_loss: 33654655.3030; train_optim_loss: 33654655.3030; val_kl_reg_loss: 141853.4512; val_edge_recon_loss: 2856650.2188; val_gene_expr_recon_loss: 23039184.2500; val_masked_gp_l1_reg_loss: 219074.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145619.5156; val_chrom_access_recon_loss: 7831297.3125; val_global_loss: 34233679.5000; val_optim_loss: 34233679.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9308; val_auprc_score: 0.9120; val_best_acc_score: 0.8718; val_best_f1_score: 0.8788; train_kl_reg_loss: 148400.6294; train_edge_recon_loss: 2862609.0682; train_gene_expr_recon_loss: 22077390.6364; train_masked_gp_l1_reg_loss: 216928.4512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 145966.5239; train_chrom_access_recon_loss: 7678822.8409; train_global_loss: 33130118.2727; train_optim_loss: 33130118.2727; val_kl_reg_loss: 101529.0352; val_edge_recon_loss: 2874994.5312; val_gene_expr_recon_loss: 22405194.5000; val_masked_gp_l1_reg_loss: 215749.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145210.4531; val_chrom_access_recon_loss: 7641925.1250; val_global_loss: 33384603.0000; val_optim_loss: 33384603.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9286; val_auprc_score: 0.9073; val_best_acc_score: 0.8643; val_best_f1_score: 0.8704; train_kl_reg_loss: 152237.6494; train_edge_recon_loss: 2819309.3106; train_gene_expr_recon_loss: 21919783.8788; train_masked_gp_l1_reg_loss: 214969.9759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143684.2929; train_chrom_access_recon_loss: 7572410.1667; train_global_loss: 32822395.1212; train_optim_loss: 32822395.1212; val_kl_reg_loss: 107586.5557; val_edge_recon_loss: 2867662.6250; val_gene_expr_recon_loss: 22186189.5000; val_masked_gp_l1_reg_loss: 214379.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142372.8281; val_chrom_access_recon_loss: 7610553.1250; val_global_loss: 33128744.2500; val_optim_loss: 33128744.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9376; val_auprc_score: 0.9168; val_best_acc_score: 0.8786; val_best_f1_score: 0.8854; train_kl_reg_loss: 147112.2019; train_edge_recon_loss: 2815043.2462; train_gene_expr_recon_loss: 21835977.1212; train_masked_gp_l1_reg_loss: 213853.8248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140975.5109; train_chrom_access_recon_loss: 7546937.3788; train_global_loss: 32699899.3333; train_optim_loss: 32699899.3333; val_kl_reg_loss: 108212.6758; val_edge_recon_loss: 2836419.1875; val_gene_expr_recon_loss: 22224204.5000; val_masked_gp_l1_reg_loss: 213259.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139820.2500; val_chrom_access_recon_loss: 7550312.2500; val_global_loss: 33072228.5000; val_optim_loss: 33072228.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9376; val_auprc_score: 0.9094; val_best_acc_score: 0.8810; val_best_f1_score: 0.8860; train_kl_reg_loss: 143009.0320; train_edge_recon_loss: 2795069.4394; train_gene_expr_recon_loss: 21765343.3939; train_masked_gp_l1_reg_loss: 212726.1660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139086.6544; train_chrom_access_recon_loss: 7519635.6742; train_global_loss: 32574870.7273; train_optim_loss: 32574870.7273; val_kl_reg_loss: 117659.4189; val_edge_recon_loss: 2820043.4062; val_gene_expr_recon_loss: 22514004.0000; val_masked_gp_l1_reg_loss: 212375.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139206.3594; val_chrom_access_recon_loss: 7608336.6875; val_global_loss: 33411625.0000; val_optim_loss: 33411625.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9358; val_auprc_score: 0.9113; val_best_acc_score: 0.8767; val_best_f1_score: 0.8814; train_kl_reg_loss: 139855.3061; train_edge_recon_loss: 2781480.8939; train_gene_expr_recon_loss: 21694155.9394; train_masked_gp_l1_reg_loss: 211908.0062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138427.3932; train_chrom_access_recon_loss: 7486850.5379; train_global_loss: 32452678.1818; train_optim_loss: 32452678.1818; val_kl_reg_loss: 119164.2021; val_edge_recon_loss: 2836102.0000; val_gene_expr_recon_loss: 22235660.7500; val_masked_gp_l1_reg_loss: 211444.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136754.7656; val_chrom_access_recon_loss: 7488679.7500; val_global_loss: 33027805.5000; val_optim_loss: 33027805.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9459; val_auprc_score: 0.9222; val_best_acc_score: 0.8888; val_best_f1_score: 0.8943; train_kl_reg_loss: 136951.2464; train_edge_recon_loss: 2784664.2273; train_gene_expr_recon_loss: 21667669.0000; train_masked_gp_l1_reg_loss: 210887.6210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137576.2723; train_chrom_access_recon_loss: 7482320.3864; train_global_loss: 32420068.7576; train_optim_loss: 32420068.7576; val_kl_reg_loss: 117013.2607; val_edge_recon_loss: 2778852.0312; val_gene_expr_recon_loss: 22009929.2500; val_masked_gp_l1_reg_loss: 210424.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136866.5156; val_chrom_access_recon_loss: 7461854.5625; val_global_loss: 32714939.0000; val_optim_loss: 32714939.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9326; val_auprc_score: 0.9062; val_best_acc_score: 0.8772; val_best_f1_score: 0.8839; train_kl_reg_loss: 135249.9640; train_edge_recon_loss: 2776177.7727; train_gene_expr_recon_loss: 21663055.2424; train_masked_gp_l1_reg_loss: 210100.0909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136842.2043; train_chrom_access_recon_loss: 7479166.8561; train_global_loss: 32400592.3939; train_optim_loss: 32400592.3939; val_kl_reg_loss: 120463.2021; val_edge_recon_loss: 2835737.8125; val_gene_expr_recon_loss: 22094958.7500; val_masked_gp_l1_reg_loss: 209897.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137512.2344; val_chrom_access_recon_loss: 7435140.8125; val_global_loss: 32833710.5000; val_optim_loss: 32833710.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9353; val_auprc_score: 0.9112; val_best_acc_score: 0.8818; val_best_f1_score: 0.8875; train_kl_reg_loss: 133471.3691; train_edge_recon_loss: 2770088.1212; train_gene_expr_recon_loss: 21617115.9697; train_masked_gp_l1_reg_loss: 209637.6252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136185.6809; train_chrom_access_recon_loss: 7462574.8712; train_global_loss: 32329073.4545; train_optim_loss: 32329073.4545; val_kl_reg_loss: 125816.1543; val_edge_recon_loss: 2812565.1562; val_gene_expr_recon_loss: 22051720.5000; val_masked_gp_l1_reg_loss: 209410.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136271.5469; val_chrom_access_recon_loss: 7448195.2500; val_global_loss: 32783979.2500; val_optim_loss: 32783979.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9450; val_auprc_score: 0.9217; val_best_acc_score: 0.8936; val_best_f1_score: 0.8981; train_kl_reg_loss: 132993.9632; train_edge_recon_loss: 2776709.9318; train_gene_expr_recon_loss: 21598341.5758; train_masked_gp_l1_reg_loss: 209228.9841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135719.8667; train_chrom_access_recon_loss: 7451089.0076; train_global_loss: 32304083.0303; train_optim_loss: 32304083.0303; val_kl_reg_loss: 125487.2783; val_edge_recon_loss: 2767677.8750; val_gene_expr_recon_loss: 21953354.5000; val_masked_gp_l1_reg_loss: 209020.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134877.3750; val_chrom_access_recon_loss: 7482041.3750; val_global_loss: 32672459.0000; val_optim_loss: 32672459.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9423; val_auprc_score: 0.9212; val_best_acc_score: 0.8869; val_best_f1_score: 0.8923; train_kl_reg_loss: 132397.1294; train_edge_recon_loss: 2779629.2652; train_gene_expr_recon_loss: 21575419.1515; train_masked_gp_l1_reg_loss: 208732.9893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134986.3442; train_chrom_access_recon_loss: 7442238.2348; train_global_loss: 32273403.2727; train_optim_loss: 32273403.2727; val_kl_reg_loss: 125296.0195; val_edge_recon_loss: 2803008.3125; val_gene_expr_recon_loss: 22025627.2500; val_masked_gp_l1_reg_loss: 208731.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134683.0469; val_chrom_access_recon_loss: 7481898.8125; val_global_loss: 32779246.5000; val_optim_loss: 32779246.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9453; val_auprc_score: 0.9216; val_best_acc_score: 0.8882; val_best_f1_score: 0.8939; train_kl_reg_loss: 132486.1103; train_edge_recon_loss: 2770853.0000; train_gene_expr_recon_loss: 21525802.1818; train_masked_gp_l1_reg_loss: 208677.1951; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134837.2431; train_chrom_access_recon_loss: 7420009.1212; train_global_loss: 32192664.8182; train_optim_loss: 32192664.8182; val_kl_reg_loss: 125429.0908; val_edge_recon_loss: 2773780.4062; val_gene_expr_recon_loss: 21949202.5000; val_masked_gp_l1_reg_loss: 208323.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134358.0625; val_chrom_access_recon_loss: 7403747.1875; val_global_loss: 32594841.0000; val_optim_loss: 32594841.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9459; val_auprc_score: 0.9246; val_best_acc_score: 0.8915; val_best_f1_score: 0.8957; train_kl_reg_loss: 132550.9665; train_edge_recon_loss: 2770297.4848; train_gene_expr_recon_loss: 21475550.1212; train_masked_gp_l1_reg_loss: 208156.9100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134307.2907; train_chrom_access_recon_loss: 7407154.5000; train_global_loss: 32128017.2121; train_optim_loss: 32128017.2121; val_kl_reg_loss: 125589.4941; val_edge_recon_loss: 2804025.3125; val_gene_expr_recon_loss: 21744935.2500; val_masked_gp_l1_reg_loss: 208065.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134418.2500; val_chrom_access_recon_loss: 7364044.3750; val_global_loss: 32381078.5000; val_optim_loss: 32381078.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9494; val_auprc_score: 0.9311; val_best_acc_score: 0.8966; val_best_f1_score: 0.9010; train_kl_reg_loss: 131844.8255; train_edge_recon_loss: 2755459.6742; train_gene_expr_recon_loss: 21466819.9697; train_masked_gp_l1_reg_loss: 208157.1061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134321.3125; train_chrom_access_recon_loss: 7397067.0379; train_global_loss: 32093670.0606; train_optim_loss: 32093670.0606; val_kl_reg_loss: 125601.0781; val_edge_recon_loss: 2761871.5938; val_gene_expr_recon_loss: 21807049.7500; val_masked_gp_l1_reg_loss: 208064.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134181.2344; val_chrom_access_recon_loss: 7453154.1250; val_global_loss: 32489922.5000; val_optim_loss: 32489922.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9473; val_auprc_score: 0.9284; val_best_acc_score: 0.8923; val_best_f1_score: 0.8971; train_kl_reg_loss: 131841.4308; train_edge_recon_loss: 2755453.0417; train_gene_expr_recon_loss: 21438085.0000; train_masked_gp_l1_reg_loss: 208142.6316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133784.1390; train_chrom_access_recon_loss: 7379197.4394; train_global_loss: 32046503.9697; train_optim_loss: 32046503.9697; val_kl_reg_loss: 127584.9561; val_edge_recon_loss: 2791196.0938; val_gene_expr_recon_loss: 21726439.2500; val_masked_gp_l1_reg_loss: 208417.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133953.0781; val_chrom_access_recon_loss: 7410404.4375; val_global_loss: 32397996.5000; val_optim_loss: 32397996.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9464; val_auprc_score: 0.9277; val_best_acc_score: 0.8898; val_best_f1_score: 0.8950; train_kl_reg_loss: 132467.2985; train_edge_recon_loss: 2755037.7917; train_gene_expr_recon_loss: 21425481.7273; train_masked_gp_l1_reg_loss: 208435.0369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133894.3359; train_chrom_access_recon_loss: 7384088.2727; train_global_loss: 32039404.6364; train_optim_loss: 32039404.6364; val_kl_reg_loss: 127234.4707; val_edge_recon_loss: 2802126.3438; val_gene_expr_recon_loss: 21943343.5000; val_masked_gp_l1_reg_loss: 208540.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133371.1094; val_chrom_access_recon_loss: 7414897.0000; val_global_loss: 32629512.7500; val_optim_loss: 32629512.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9504; val_auprc_score: 0.9328; val_best_acc_score: 0.8947; val_best_f1_score: 0.8994; train_kl_reg_loss: 132252.7454; train_edge_recon_loss: 2758106.0038; train_gene_expr_recon_loss: 21395633.5758; train_masked_gp_l1_reg_loss: 208585.8047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133285.0661; train_chrom_access_recon_loss: 7368562.5227; train_global_loss: 31996425.6061; train_optim_loss: 31996425.6061; val_kl_reg_loss: 128496.0000; val_edge_recon_loss: 2790144.0000; val_gene_expr_recon_loss: 21891017.5000; val_masked_gp_l1_reg_loss: 208597.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132919.8281; val_chrom_access_recon_loss: 7412937.1250; val_global_loss: 32564113.0000; val_optim_loss: 32564113.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9490; val_auprc_score: 0.9215; val_best_acc_score: 0.9019; val_best_f1_score: 0.9055; train_kl_reg_loss: 132525.9872; train_edge_recon_loss: 2756942.4924; train_gene_expr_recon_loss: 21355629.5758; train_masked_gp_l1_reg_loss: 205587.9614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102082.1019; train_chrom_access_recon_loss: 7356935.7197; train_global_loss: 31909703.9091; train_optim_loss: 31909703.9091; val_kl_reg_loss: 127847.0605; val_edge_recon_loss: 2795798.6875; val_gene_expr_recon_loss: 21958529.7500; val_masked_gp_l1_reg_loss: 204381.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95957.7656; val_chrom_access_recon_loss: 7487845.8750; val_global_loss: 32670361.2500; val_optim_loss: 32670361.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9503; val_auprc_score: 0.9338; val_best_acc_score: 0.8949; val_best_f1_score: 0.8993; train_kl_reg_loss: 133957.7464; train_edge_recon_loss: 2756952.1591; train_gene_expr_recon_loss: 21321696.1818; train_masked_gp_l1_reg_loss: 204062.9761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95356.6791; train_chrom_access_recon_loss: 7349760.6818; train_global_loss: 31861786.3333; train_optim_loss: 31861786.3333; val_kl_reg_loss: 127268.2520; val_edge_recon_loss: 2767408.1875; val_gene_expr_recon_loss: 21616206.7500; val_masked_gp_l1_reg_loss: 203863.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95026.1562; val_chrom_access_recon_loss: 7306817.0000; val_global_loss: 32116590.5000; val_optim_loss: 32116590.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9434; val_auprc_score: 0.9201; val_best_acc_score: 0.8872; val_best_f1_score: 0.8937; train_kl_reg_loss: 134412.1609; train_edge_recon_loss: 2753103.0758; train_gene_expr_recon_loss: 21325641.1515; train_masked_gp_l1_reg_loss: 203721.7045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94735.9962; train_chrom_access_recon_loss: 7346265.6061; train_global_loss: 31857879.6667; train_optim_loss: 31857879.6667; val_kl_reg_loss: 129204.0723; val_edge_recon_loss: 2807954.3438; val_gene_expr_recon_loss: 21846146.7500; val_masked_gp_l1_reg_loss: 203596.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94409.4375; val_chrom_access_recon_loss: 7436643.4375; val_global_loss: 32517954.5000; val_optim_loss: 32517954.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9497; val_auprc_score: 0.9275; val_best_acc_score: 0.8949; val_best_f1_score: 0.8999; train_kl_reg_loss: 134658.7498; train_edge_recon_loss: 2750413.0492; train_gene_expr_recon_loss: 21323015.1818; train_masked_gp_l1_reg_loss: 203518.5954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94212.5572; train_chrom_access_recon_loss: 7350853.5455; train_global_loss: 31856671.9091; train_optim_loss: 31856671.9091; val_kl_reg_loss: 128722.0488; val_edge_recon_loss: 2775254.9062; val_gene_expr_recon_loss: 21774850.0000; val_masked_gp_l1_reg_loss: 203456.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94141.1016; val_chrom_access_recon_loss: 7367295.3125; val_global_loss: 32343720.0000; val_optim_loss: 32343720.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9510; val_auprc_score: 0.9306; val_best_acc_score: 0.8968; val_best_f1_score: 0.9020; train_kl_reg_loss: 135020.8596; train_edge_recon_loss: 2748595.3295; train_gene_expr_recon_loss: 21323936.2424; train_masked_gp_l1_reg_loss: 203411.7206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93915.8045; train_chrom_access_recon_loss: 7352174.1742; train_global_loss: 31857053.8485; train_optim_loss: 31857053.8485; val_kl_reg_loss: 128727.2549; val_edge_recon_loss: 2780944.8750; val_gene_expr_recon_loss: 21725037.7500; val_masked_gp_l1_reg_loss: 203376.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93828.1172; val_chrom_access_recon_loss: 7359851.5000; val_global_loss: 32291765.0000; val_optim_loss: 32291765.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9456; val_auprc_score: 0.9198; val_best_acc_score: 0.8952; val_best_f1_score: 0.9007; train_kl_reg_loss: 135203.6605; train_edge_recon_loss: 2737054.2803; train_gene_expr_recon_loss: 21302422.8485; train_masked_gp_l1_reg_loss: 203324.5107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93630.4420; train_chrom_access_recon_loss: 7340226.5000; train_global_loss: 31811862.3939; train_optim_loss: 31811862.3939; val_kl_reg_loss: 130512.4805; val_edge_recon_loss: 2794519.9375; val_gene_expr_recon_loss: 21786980.7500; val_masked_gp_l1_reg_loss: 203286.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93424.4609; val_chrom_access_recon_loss: 7339375.3125; val_global_loss: 32348098.2500; val_optim_loss: 32348098.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9507; val_auprc_score: 0.9336; val_best_acc_score: 0.8925; val_best_f1_score: 0.8980; train_kl_reg_loss: 135541.1375; train_edge_recon_loss: 2742339.5265; train_gene_expr_recon_loss: 21303156.2424; train_masked_gp_l1_reg_loss: 202990.2824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90056.3993; train_chrom_access_recon_loss: 7342361.0000; train_global_loss: 31816444.6061; train_optim_loss: 31816444.6061; val_kl_reg_loss: 129466.4844; val_edge_recon_loss: 2778945.2500; val_gene_expr_recon_loss: 21577350.2500; val_masked_gp_l1_reg_loss: 202850.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89402.6016; val_chrom_access_recon_loss: 7337335.4375; val_global_loss: 32115349.5000; val_optim_loss: 32115349.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9436; val_auprc_score: 0.9207; val_best_acc_score: 0.8912; val_best_f1_score: 0.8972; train_kl_reg_loss: 135540.3679; train_edge_recon_loss: 2749942.0265; train_gene_expr_recon_loss: 21307536.3636; train_masked_gp_l1_reg_loss: 202799.1402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89324.1574; train_chrom_access_recon_loss: 7340434.9545; train_global_loss: 31825577.0000; train_optim_loss: 31825577.0000; val_kl_reg_loss: 129532.1318; val_edge_recon_loss: 2806585.4062; val_gene_expr_recon_loss: 21814311.2500; val_masked_gp_l1_reg_loss: 202759.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89280.9141; val_chrom_access_recon_loss: 7363995.2500; val_global_loss: 32406464.5000; val_optim_loss: 32406464.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9488; val_auprc_score: 0.9314; val_best_acc_score: 0.8968; val_best_f1_score: 0.9011; train_kl_reg_loss: 135568.3011; train_edge_recon_loss: 2749148.7235; train_gene_expr_recon_loss: 21312549.6061; train_masked_gp_l1_reg_loss: 202736.0968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89236.4804; train_chrom_access_recon_loss: 7341843.2273; train_global_loss: 31831082.4545; train_optim_loss: 31831082.4545; val_kl_reg_loss: 129812.9795; val_edge_recon_loss: 2792958.1250; val_gene_expr_recon_loss: 21746988.5000; val_masked_gp_l1_reg_loss: 202713.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89197.1094; val_chrom_access_recon_loss: 7345082.8125; val_global_loss: 32306753.7500; val_optim_loss: 32306753.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9467; val_auprc_score: 0.9281; val_best_acc_score: 0.8936; val_best_f1_score: 0.8975; train_kl_reg_loss: 135376.7607; train_edge_recon_loss: 2756984.0227; train_gene_expr_recon_loss: 21297139.7879; train_masked_gp_l1_reg_loss: 202696.6463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89175.3227; train_chrom_access_recon_loss: 7338417.4318; train_global_loss: 31819790.1212; train_optim_loss: 31819790.1212; val_kl_reg_loss: 130574.4727; val_edge_recon_loss: 2815121.4688; val_gene_expr_recon_loss: 22038253.0000; val_masked_gp_l1_reg_loss: 202680.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89142.2344; val_chrom_access_recon_loss: 7486597.5000; val_global_loss: 32762368.2500; val_optim_loss: 32762368.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9502; val_auprc_score: 0.9333; val_best_acc_score: 0.8949; val_best_f1_score: 0.9004; train_kl_reg_loss: 135273.4351; train_edge_recon_loss: 2748937.1402; train_gene_expr_recon_loss: 21299030.1212; train_masked_gp_l1_reg_loss: 202670.1799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89117.6922; train_chrom_access_recon_loss: 7342230.8106; train_global_loss: 31817259.2424; train_optim_loss: 31817259.2424; val_kl_reg_loss: 129810.7646; val_edge_recon_loss: 2790177.5938; val_gene_expr_recon_loss: 21745459.0000; val_masked_gp_l1_reg_loss: 202660.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89095.9922; val_chrom_access_recon_loss: 7369198.6875; val_global_loss: 32326401.7500; val_optim_loss: 32326401.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9485; val_auprc_score: 0.9216; val_best_acc_score: 0.8974; val_best_f1_score: 0.9006; train_kl_reg_loss: 135307.6013; train_edge_recon_loss: 2743981.3295; train_gene_expr_recon_loss: 21298550.9091; train_masked_gp_l1_reg_loss: 202629.2514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88752.3958; train_chrom_access_recon_loss: 7336741.7424; train_global_loss: 31805963.3030; train_optim_loss: 31805963.3030; val_kl_reg_loss: 130249.2891; val_edge_recon_loss: 2785557.3750; val_gene_expr_recon_loss: 21759220.5000; val_masked_gp_l1_reg_loss: 202615.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88685.0156; val_chrom_access_recon_loss: 7362495.8750; val_global_loss: 32328825.2500; val_optim_loss: 32328825.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9472; val_auprc_score: 0.9270; val_best_acc_score: 0.8958; val_best_f1_score: 0.9002; train_kl_reg_loss: 135475.9773; train_edge_recon_loss: 2747540.6250; train_gene_expr_recon_loss: 21288326.3333; train_masked_gp_l1_reg_loss: 202610.7990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88679.3479; train_chrom_access_recon_loss: 7335654.0455; train_global_loss: 31798287.0303; train_optim_loss: 31798287.0303; val_kl_reg_loss: 131046.8428; val_edge_recon_loss: 2787999.1875; val_gene_expr_recon_loss: 21815729.0000; val_masked_gp_l1_reg_loss: 202606.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88673.6953; val_chrom_access_recon_loss: 7384314.8125; val_global_loss: 32410369.7500; val_optim_loss: 32410369.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9547; val_auprc_score: 0.9353; val_best_acc_score: 0.9030; val_best_f1_score: 0.9067; train_kl_reg_loss: 135609.2848; train_edge_recon_loss: 2759647.2197; train_gene_expr_recon_loss: 21306174.0000; train_masked_gp_l1_reg_loss: 202604.2642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88669.1967; train_chrom_access_recon_loss: 7339017.9545; train_global_loss: 31831721.6667; train_optim_loss: 31831721.6667; val_kl_reg_loss: 130411.3525; val_edge_recon_loss: 2767343.0625; val_gene_expr_recon_loss: 21686670.0000; val_masked_gp_l1_reg_loss: 202601.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88664.6406; val_chrom_access_recon_loss: 7335603.4375; val_global_loss: 32211293.5000; val_optim_loss: 32211293.5000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9477; val_auprc_score: 0.9176; val_best_acc_score: 0.8968; val_best_f1_score: 0.9010; train_kl_reg_loss: 135327.6690; train_edge_recon_loss: 2749882.4811; train_gene_expr_recon_loss: 21293518.4848; train_masked_gp_l1_reg_loss: 202599.5059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88660.5902; train_chrom_access_recon_loss: 7335327.7879; train_global_loss: 31805316.6970; train_optim_loss: 31805316.6970; val_kl_reg_loss: 130168.5234; val_edge_recon_loss: 2807497.7188; val_gene_expr_recon_loss: 21724481.2500; val_masked_gp_l1_reg_loss: 202597.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88657.1719; val_chrom_access_recon_loss: 7385788.3750; val_global_loss: 32339191.5000; val_optim_loss: 32339191.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 7 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9511
val AUPRC score: 0.9316
val best accuracy score: 0.8979
val best F1 score: 0.9030
val target rna MSE score: 0.9885
val source rna MSE score: 0.3125
val target atac MSE score: 0.3313
val source atac MSE score: 0.0719
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
