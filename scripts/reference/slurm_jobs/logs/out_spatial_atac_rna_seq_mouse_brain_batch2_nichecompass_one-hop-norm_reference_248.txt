[True]
Run timestamp: 07092023_030031_248.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_248']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 26065 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 30568, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 26065
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 26065

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6981; val_auprc_score: 0.6755; val_best_acc_score: 0.5298; val_best_f1_score: 0.6764; train_kl_reg_loss: 64956.8052; train_edge_recon_loss: 3676227.4508; train_gene_expr_recon_loss: 17307019.5758; train_masked_gp_l1_reg_loss: 50034.3721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10256492.9280; train_chrom_access_recon_loss: 59279305.1515; train_global_loss: 90634036.0000; train_optim_loss: 90634036.0000; val_kl_reg_loss: 165570.4922; val_edge_recon_loss: 4062706.5938; val_gene_expr_recon_loss: 15228471.5000; val_masked_gp_l1_reg_loss: 48312.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3941691.2500; val_chrom_access_recon_loss: 55603902.5000; val_global_loss: 79050654.0000; val_optim_loss: 79050654.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7194; val_auprc_score: 0.7091; val_best_acc_score: 0.5938; val_best_f1_score: 0.6948; train_kl_reg_loss: 156435.8420; train_edge_recon_loss: 3606006.5227; train_gene_expr_recon_loss: 15025487.0303; train_masked_gp_l1_reg_loss: 43382.6937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1555372.8447; train_chrom_access_recon_loss: 55861098.2424; train_global_loss: 76247783.6364; train_optim_loss: 76247783.6364; val_kl_reg_loss: 177835.3379; val_edge_recon_loss: 4059577.2812; val_gene_expr_recon_loss: 14587313.7500; val_masked_gp_l1_reg_loss: 40200.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 582926.8750; val_chrom_access_recon_loss: 54568667.5000; val_global_loss: 74016519.0000; val_optim_loss: 74016519.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7823; val_auprc_score: 0.7664; val_best_acc_score: 0.7131; val_best_f1_score: 0.7059; train_kl_reg_loss: 154338.1951; train_edge_recon_loss: 3555055.4508; train_gene_expr_recon_loss: 14696689.7576; train_masked_gp_l1_reg_loss: 39238.9841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 430979.9735; train_chrom_access_recon_loss: 55375131.6364; train_global_loss: 74251433.5758; train_optim_loss: 74251433.5758; val_kl_reg_loss: 148305.9551; val_edge_recon_loss: 4036453.8750; val_gene_expr_recon_loss: 14463294.6250; val_masked_gp_l1_reg_loss: 39020.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 328741.1562; val_chrom_access_recon_loss: 54553268.0000; val_global_loss: 73569086.0000; val_optim_loss: 73569086.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8245; val_auprc_score: 0.8006; val_best_acc_score: 0.7389; val_best_f1_score: 0.7661; train_kl_reg_loss: 135896.5781; train_edge_recon_loss: 3533096.7879; train_gene_expr_recon_loss: 14550079.5152; train_masked_gp_l1_reg_loss: 39720.8458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 283236.6929; train_chrom_access_recon_loss: 55013128.6667; train_global_loss: 73555159.1515; train_optim_loss: 73555159.1515; val_kl_reg_loss: 124359.3623; val_edge_recon_loss: 3915112.6875; val_gene_expr_recon_loss: 14244609.7500; val_masked_gp_l1_reg_loss: 40547.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 249069.1094; val_chrom_access_recon_loss: 53663752.0000; val_global_loss: 72237451.0000; val_optim_loss: 72237451.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8240; val_auprc_score: 0.7934; val_best_acc_score: 0.7402; val_best_f1_score: 0.7746; train_kl_reg_loss: 111685.0965; train_edge_recon_loss: 3385482.2462; train_gene_expr_recon_loss: 14455563.7121; train_masked_gp_l1_reg_loss: 41352.5737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 229258.7098; train_chrom_access_recon_loss: 54690183.9394; train_global_loss: 72913526.3030; train_optim_loss: 72913526.3030; val_kl_reg_loss: 124246.8799; val_edge_recon_loss: 3198323.8438; val_gene_expr_recon_loss: 14292895.6250; val_masked_gp_l1_reg_loss: 42412.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 213108.7656; val_chrom_access_recon_loss: 53866002.5000; val_global_loss: 71736988.0000; val_optim_loss: 71736988.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8296; val_auprc_score: 0.7964; val_best_acc_score: 0.7558; val_best_f1_score: 0.7781; train_kl_reg_loss: 148719.1207; train_edge_recon_loss: 3054884.7765; train_gene_expr_recon_loss: 14372836.6364; train_masked_gp_l1_reg_loss: 43194.4373; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 202279.9735; train_chrom_access_recon_loss: 54415480.4848; train_global_loss: 72237395.0303; train_optim_loss: 72237395.0303; val_kl_reg_loss: 152256.4453; val_edge_recon_loss: 3106402.7500; val_gene_expr_recon_loss: 14022177.0000; val_masked_gp_l1_reg_loss: 44066.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192768.0312; val_chrom_access_recon_loss: 53041506.5000; val_global_loss: 70559177.0000; val_optim_loss: 70559177.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8343; val_auprc_score: 0.7946; val_best_acc_score: 0.7617; val_best_f1_score: 0.7889; train_kl_reg_loss: 152102.7962; train_edge_recon_loss: 3009839.7159; train_gene_expr_recon_loss: 14289592.9242; train_masked_gp_l1_reg_loss: 44824.4873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 186912.6233; train_chrom_access_recon_loss: 54135455.8182; train_global_loss: 71818728.2424; train_optim_loss: 71818728.2424; val_kl_reg_loss: 148165.2402; val_edge_recon_loss: 3030050.5312; val_gene_expr_recon_loss: 14238488.6250; val_masked_gp_l1_reg_loss: 45657.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 181817.2812; val_chrom_access_recon_loss: 53371945.5000; val_global_loss: 71016127.0000; val_optim_loss: 71016127.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8383; val_auprc_score: 0.8016; val_best_acc_score: 0.7732; val_best_f1_score: 0.8019; train_kl_reg_loss: 145779.6747; train_edge_recon_loss: 2980028.9053; train_gene_expr_recon_loss: 14228148.7424; train_masked_gp_l1_reg_loss: 46255.1923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 177269.2817; train_chrom_access_recon_loss: 53937666.3030; train_global_loss: 71515148.1818; train_optim_loss: 71515148.1818; val_kl_reg_loss: 138814.9668; val_edge_recon_loss: 2984029.7500; val_gene_expr_recon_loss: 13964785.1250; val_masked_gp_l1_reg_loss: 46975.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173221.0312; val_chrom_access_recon_loss: 52661900.5000; val_global_loss: 69969729.0000; val_optim_loss: 69969729.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8571; val_auprc_score: 0.8190; val_best_acc_score: 0.7888; val_best_f1_score: 0.8142; train_kl_reg_loss: 262968.7630; train_edge_recon_loss: 2944383.7045; train_gene_expr_recon_loss: 14179504.0303; train_masked_gp_l1_reg_loss: 47704.5912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170791.5623; train_chrom_access_recon_loss: 53727355.0303; train_global_loss: 71332708.1212; train_optim_loss: 71332708.1212; val_kl_reg_loss: 140483.0449; val_edge_recon_loss: 2963542.9375; val_gene_expr_recon_loss: 13940151.1250; val_masked_gp_l1_reg_loss: 48523.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168759.4375; val_chrom_access_recon_loss: 53414575.0000; val_global_loss: 70676035.0000; val_optim_loss: 70676035.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8550; val_auprc_score: 0.8167; val_best_acc_score: 0.7926; val_best_f1_score: 0.8167; train_kl_reg_loss: 295739.7808; train_edge_recon_loss: 2946836.0227; train_gene_expr_recon_loss: 14237478.5303; train_masked_gp_l1_reg_loss: 49645.3319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165381.2244; train_chrom_access_recon_loss: 54037685.6364; train_global_loss: 71732766.4242; train_optim_loss: 71732766.4242; val_kl_reg_loss: 199980.6270; val_edge_recon_loss: 2979139.9688; val_gene_expr_recon_loss: 13944730.1250; val_masked_gp_l1_reg_loss: 50380.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161032.3906; val_chrom_access_recon_loss: 52844381.0000; val_global_loss: 70179644.0000; val_optim_loss: 70179644.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8682; val_auprc_score: 0.8358; val_best_acc_score: 0.7985; val_best_f1_score: 0.8199; train_kl_reg_loss: 818936.4646; train_edge_recon_loss: 2939853.4318; train_gene_expr_recon_loss: 14279456.0758; train_masked_gp_l1_reg_loss: 50756.6360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158409.5393; train_chrom_access_recon_loss: 53956816.2424; train_global_loss: 72204228.4848; train_optim_loss: 72204228.4848; val_kl_reg_loss: 126905.8730; val_edge_recon_loss: 3012547.0938; val_gene_expr_recon_loss: 14220908.3750; val_masked_gp_l1_reg_loss: 51376.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158111.4375; val_chrom_access_recon_loss: 53292742.0000; val_global_loss: 70862591.0000; val_optim_loss: 70862591.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8736; val_auprc_score: 0.8459; val_best_acc_score: 0.8057; val_best_f1_score: 0.8274; train_kl_reg_loss: 13715933.1999; train_edge_recon_loss: 2958138.7841; train_gene_expr_recon_loss: 14229868.1970; train_masked_gp_l1_reg_loss: 53185.8581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154897.8965; train_chrom_access_recon_loss: 53932407.8788; train_global_loss: 85044431.6364; train_optim_loss: 85044431.6364; val_kl_reg_loss: 129968.5967; val_edge_recon_loss: 3053071.5625; val_gene_expr_recon_loss: 14008688.6250; val_masked_gp_l1_reg_loss: 55689.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147021.3594; val_chrom_access_recon_loss: 52752891.0000; val_global_loss: 70147332.0000; val_optim_loss: 70147332.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8646; val_auprc_score: 0.8300; val_best_acc_score: 0.7977; val_best_f1_score: 0.8189; train_kl_reg_loss: 139772.9506; train_edge_recon_loss: 2968023.5303; train_gene_expr_recon_loss: 14155814.3333; train_masked_gp_l1_reg_loss: 54660.4038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109752.8809; train_chrom_access_recon_loss: 53495342.8485; train_global_loss: 70923366.6667; train_optim_loss: 70923366.6667; val_kl_reg_loss: 144396.8086; val_edge_recon_loss: 2994122.0625; val_gene_expr_recon_loss: 13980453.2500; val_masked_gp_l1_reg_loss: 53914.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101839.8438; val_chrom_access_recon_loss: 52922353.0000; val_global_loss: 70197079.0000; val_optim_loss: 70197079.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8759; val_auprc_score: 0.8373; val_best_acc_score: 0.8125; val_best_f1_score: 0.8298; train_kl_reg_loss: 146422.6179; train_edge_recon_loss: 2940543.1439; train_gene_expr_recon_loss: 14105066.7121; train_masked_gp_l1_reg_loss: 53586.0036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100769.4455; train_chrom_access_recon_loss: 53343884.3636; train_global_loss: 70690272.0000; train_optim_loss: 70690272.0000; val_kl_reg_loss: 148763.0195; val_edge_recon_loss: 2929656.3125; val_gene_expr_recon_loss: 13870937.3750; val_masked_gp_l1_reg_loss: 53316.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100015.3047; val_chrom_access_recon_loss: 52272127.0000; val_global_loss: 69374815.0000; val_optim_loss: 69374815.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8602; val_auprc_score: 0.8251; val_best_acc_score: 0.7945; val_best_f1_score: 0.8183; train_kl_reg_loss: 149598.1584; train_edge_recon_loss: 2922002.1061; train_gene_expr_recon_loss: 14064889.0152; train_masked_gp_l1_reg_loss: 53170.5943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99094.4767; train_chrom_access_recon_loss: 53173230.1212; train_global_loss: 70461984.7273; train_optim_loss: 70461984.7273; val_kl_reg_loss: 155207.8340; val_edge_recon_loss: 2957607.1250; val_gene_expr_recon_loss: 13995881.0000; val_masked_gp_l1_reg_loss: 53007.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98144.3750; val_chrom_access_recon_loss: 52619490.0000; val_global_loss: 69879337.0000; val_optim_loss: 69879337.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8666; val_auprc_score: 0.8291; val_best_acc_score: 0.8036; val_best_f1_score: 0.8250; train_kl_reg_loss: 170537.6293; train_edge_recon_loss: 2911352.1629; train_gene_expr_recon_loss: 14061539.2424; train_masked_gp_l1_reg_loss: 52887.8902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97699.8182; train_chrom_access_recon_loss: 53131904.6061; train_global_loss: 70425921.4545; train_optim_loss: 70425921.4545; val_kl_reg_loss: 153639.1992; val_edge_recon_loss: 2963291.1562; val_gene_expr_recon_loss: 13887046.8750; val_masked_gp_l1_reg_loss: 52793.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97189.7422; val_chrom_access_recon_loss: 52617790.5000; val_global_loss: 69771752.0000; val_optim_loss: 69771752.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8617; val_auprc_score: 0.8249; val_best_acc_score: 0.8006; val_best_f1_score: 0.8237; train_kl_reg_loss: 153824.0327; train_edge_recon_loss: 2893635.1780; train_gene_expr_recon_loss: 14030124.6061; train_masked_gp_l1_reg_loss: 52711.1186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96617.3751; train_chrom_access_recon_loss: 53053083.3333; train_global_loss: 70279996.1818; train_optim_loss: 70279996.1818; val_kl_reg_loss: 155300.9453; val_edge_recon_loss: 2940440.6250; val_gene_expr_recon_loss: 13913710.2500; val_masked_gp_l1_reg_loss: 52625.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96254.8359; val_chrom_access_recon_loss: 52681575.5000; val_global_loss: 69839907.0000; val_optim_loss: 69839907.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8733; val_auprc_score: 0.8360; val_best_acc_score: 0.8009; val_best_f1_score: 0.8235; train_kl_reg_loss: 154069.2017; train_edge_recon_loss: 2893189.8523; train_gene_expr_recon_loss: 14049362.1212; train_masked_gp_l1_reg_loss: 52552.5009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95797.4684; train_chrom_access_recon_loss: 53116737.3333; train_global_loss: 70361708.4848; train_optim_loss: 70361708.4848; val_kl_reg_loss: 155688.2832; val_edge_recon_loss: 2883680.1250; val_gene_expr_recon_loss: 13826098.0000; val_masked_gp_l1_reg_loss: 52480.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95264.8125; val_chrom_access_recon_loss: 52355449.0000; val_global_loss: 69368661.0000; val_optim_loss: 69368661.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8704; val_auprc_score: 0.8411; val_best_acc_score: 0.8031; val_best_f1_score: 0.8270; train_kl_reg_loss: 155125.0279; train_edge_recon_loss: 2882414.8902; train_gene_expr_recon_loss: 14002225.2727; train_masked_gp_l1_reg_loss: 52428.2726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94905.0528; train_chrom_access_recon_loss: 52976475.8788; train_global_loss: 70163574.4848; train_optim_loss: 70163574.4848; val_kl_reg_loss: 156690.6172; val_edge_recon_loss: 2898582.2188; val_gene_expr_recon_loss: 14038046.2500; val_masked_gp_l1_reg_loss: 52386.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94606.1562; val_chrom_access_recon_loss: 53128715.5000; val_global_loss: 70369027.0000; val_optim_loss: 70369027.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8652; val_auprc_score: 0.8234; val_best_acc_score: 0.8031; val_best_f1_score: 0.8239; train_kl_reg_loss: 153172.7926; train_edge_recon_loss: 2904853.3333; train_gene_expr_recon_loss: 13991701.3636; train_masked_gp_l1_reg_loss: 52340.2424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94308.2549; train_chrom_access_recon_loss: 52946125.9394; train_global_loss: 70142502.0606; train_optim_loss: 70142502.0606; val_kl_reg_loss: 152771.7656; val_edge_recon_loss: 2928775.0625; val_gene_expr_recon_loss: 13843271.2500; val_masked_gp_l1_reg_loss: 52292.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93997.5391; val_chrom_access_recon_loss: 52080312.0000; val_global_loss: 69151420.0000; val_optim_loss: 69151420.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8784; val_auprc_score: 0.8417; val_best_acc_score: 0.8109; val_best_f1_score: 0.8302; train_kl_reg_loss: 152839.9875; train_edge_recon_loss: 2893177.4015; train_gene_expr_recon_loss: 13987292.1970; train_masked_gp_l1_reg_loss: 52271.4609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93820.7428; train_chrom_access_recon_loss: 52945260.7879; train_global_loss: 70124663.2727; train_optim_loss: 70124663.2727; val_kl_reg_loss: 152677.8438; val_edge_recon_loss: 2882374.5312; val_gene_expr_recon_loss: 13776653.7500; val_masked_gp_l1_reg_loss: 52251.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93757.4766; val_chrom_access_recon_loss: 52214160.5000; val_global_loss: 69171876.5000; val_optim_loss: 69171876.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8715; val_auprc_score: 0.8383; val_best_acc_score: 0.7998; val_best_f1_score: 0.8220; train_kl_reg_loss: 152641.4891; train_edge_recon_loss: 2885704.9924; train_gene_expr_recon_loss: 13971160.3788; train_masked_gp_l1_reg_loss: 52233.6151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93493.3068; train_chrom_access_recon_loss: 52889255.3939; train_global_loss: 70044489.3939; train_optim_loss: 70044489.3939; val_kl_reg_loss: 153853.3418; val_edge_recon_loss: 2930986.6875; val_gene_expr_recon_loss: 13999897.0000; val_masked_gp_l1_reg_loss: 52203.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93364.7109; val_chrom_access_recon_loss: 52661589.0000; val_global_loss: 69891895.0000; val_optim_loss: 69891895.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8736; val_auprc_score: 0.8423; val_best_acc_score: 0.8076; val_best_f1_score: 0.8275; train_kl_reg_loss: 153348.3847; train_edge_recon_loss: 2889759.0152; train_gene_expr_recon_loss: 13979873.7727; train_masked_gp_l1_reg_loss: 52193.4647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93225.8499; train_chrom_access_recon_loss: 52903790.2424; train_global_loss: 70072190.7879; train_optim_loss: 70072190.7879; val_kl_reg_loss: 152229.6426; val_edge_recon_loss: 2892990.4688; val_gene_expr_recon_loss: 13881837.3750; val_masked_gp_l1_reg_loss: 52190.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93030.9141; val_chrom_access_recon_loss: 52230160.0000; val_global_loss: 69302438.0000; val_optim_loss: 69302438.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8730; val_auprc_score: 0.8376; val_best_acc_score: 0.8023; val_best_f1_score: 0.8258; train_kl_reg_loss: 151139.0511; train_edge_recon_loss: 2892032.9356; train_gene_expr_recon_loss: 13948451.3939; train_masked_gp_l1_reg_loss: 52178.1657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92740.2455; train_chrom_access_recon_loss: 52841379.0909; train_global_loss: 69977920.6061; train_optim_loss: 69977920.6061; val_kl_reg_loss: 150990.6035; val_edge_recon_loss: 2905159.3438; val_gene_expr_recon_loss: 13841835.2500; val_masked_gp_l1_reg_loss: 52173.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92649.5312; val_chrom_access_recon_loss: 52528711.5000; val_global_loss: 69571520.5000; val_optim_loss: 69571520.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8713; val_auprc_score: 0.8353; val_best_acc_score: 0.8036; val_best_f1_score: 0.8277; train_kl_reg_loss: 150727.1446; train_edge_recon_loss: 2897407.1667; train_gene_expr_recon_loss: 13948668.8030; train_masked_gp_l1_reg_loss: 52091.1957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89003.2217; train_chrom_access_recon_loss: 52787062.7273; train_global_loss: 69924960.2424; train_optim_loss: 69924960.2424; val_kl_reg_loss: 150806.4238; val_edge_recon_loss: 2922986.0625; val_gene_expr_recon_loss: 13702579.3750; val_masked_gp_l1_reg_loss: 52021.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88290.7812; val_chrom_access_recon_loss: 52182226.5000; val_global_loss: 69098910.0000; val_optim_loss: 69098910.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8722; val_auprc_score: 0.8467; val_best_acc_score: 0.7974; val_best_f1_score: 0.8239; train_kl_reg_loss: 150728.0668; train_edge_recon_loss: 2879184.8030; train_gene_expr_recon_loss: 13949543.5303; train_masked_gp_l1_reg_loss: 51992.4520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88233.5817; train_chrom_access_recon_loss: 52829716.5455; train_global_loss: 69949398.5455; train_optim_loss: 69949398.5455; val_kl_reg_loss: 151585.7324; val_edge_recon_loss: 2913940.8125; val_gene_expr_recon_loss: 13738135.6250; val_masked_gp_l1_reg_loss: 51971.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88205.6719; val_chrom_access_recon_loss: 52056513.5000; val_global_loss: 69000353.0000; val_optim_loss: 69000353.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8683; val_auprc_score: 0.8319; val_best_acc_score: 0.7996; val_best_f1_score: 0.8251; train_kl_reg_loss: 150991.9991; train_edge_recon_loss: 2885947.2803; train_gene_expr_recon_loss: 13953613.1364; train_masked_gp_l1_reg_loss: 51959.5459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88185.0831; train_chrom_access_recon_loss: 52841167.7576; train_global_loss: 69971864.4848; train_optim_loss: 69971864.4848; val_kl_reg_loss: 151615.5332; val_edge_recon_loss: 2926899.0312; val_gene_expr_recon_loss: 13830297.1250; val_masked_gp_l1_reg_loss: 51948.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88177.8047; val_chrom_access_recon_loss: 52456250.0000; val_global_loss: 69505188.0000; val_optim_loss: 69505188.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8763; val_auprc_score: 0.8452; val_best_acc_score: 0.8041; val_best_f1_score: 0.8302; train_kl_reg_loss: 150690.4837; train_edge_recon_loss: 2887662.0265; train_gene_expr_recon_loss: 13950426.7273; train_masked_gp_l1_reg_loss: 51938.8632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88151.9709; train_chrom_access_recon_loss: 52825496.3030; train_global_loss: 69954366.5455; train_optim_loss: 69954366.5455; val_kl_reg_loss: 151433.2598; val_edge_recon_loss: 2894310.4375; val_gene_expr_recon_loss: 13755854.7500; val_masked_gp_l1_reg_loss: 51929.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88125.8984; val_chrom_access_recon_loss: 51938521.0000; val_global_loss: 68880174.5000; val_optim_loss: 68880174.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8674; val_auprc_score: 0.8307; val_best_acc_score: 0.7985; val_best_f1_score: 0.8245; train_kl_reg_loss: 150990.5741; train_edge_recon_loss: 2880326.4545; train_gene_expr_recon_loss: 13942712.0000; train_masked_gp_l1_reg_loss: 51926.5887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88091.1239; train_chrom_access_recon_loss: 52785470.2424; train_global_loss: 69899517.3333; train_optim_loss: 69899517.3333; val_kl_reg_loss: 151442.3184; val_edge_recon_loss: 2879318.2812; val_gene_expr_recon_loss: 13742602.1250; val_masked_gp_l1_reg_loss: 51920.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88065.6562; val_chrom_access_recon_loss: 51689977.0000; val_global_loss: 68603325.0000; val_optim_loss: 68603325.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8646; val_auprc_score: 0.8237; val_best_acc_score: 0.7969; val_best_f1_score: 0.8255; train_kl_reg_loss: 151042.4924; train_edge_recon_loss: 2868940.1856; train_gene_expr_recon_loss: 13943657.9394; train_masked_gp_l1_reg_loss: 51918.3456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88059.3986; train_chrom_access_recon_loss: 52781423.2121; train_global_loss: 69885041.8182; train_optim_loss: 69885041.8182; val_kl_reg_loss: 151478.5254; val_edge_recon_loss: 2911694.8750; val_gene_expr_recon_loss: 13754184.1250; val_masked_gp_l1_reg_loss: 51914.0508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88025.5469; val_chrom_access_recon_loss: 52249284.0000; val_global_loss: 69206581.0000; val_optim_loss: 69206581.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8694; val_auprc_score: 0.8297; val_best_acc_score: 0.8012; val_best_f1_score: 0.8251; train_kl_reg_loss: 151279.2704; train_edge_recon_loss: 2881147.9508; train_gene_expr_recon_loss: 13945658.2273; train_masked_gp_l1_reg_loss: 51911.5497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87995.2952; train_chrom_access_recon_loss: 52783503.1515; train_global_loss: 69901495.8182; train_optim_loss: 69901495.8182; val_kl_reg_loss: 150918.6289; val_edge_recon_loss: 2924274.9062; val_gene_expr_recon_loss: 13758694.2500; val_masked_gp_l1_reg_loss: 51905.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87969.2969; val_chrom_access_recon_loss: 51847657.5000; val_global_loss: 68821423.0000; val_optim_loss: 68821423.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8739; val_auprc_score: 0.8464; val_best_acc_score: 0.8031; val_best_f1_score: 0.8281; train_kl_reg_loss: 151216.3961; train_edge_recon_loss: 2881067.7538; train_gene_expr_recon_loss: 13946671.8939; train_masked_gp_l1_reg_loss: 51907.2418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87932.4125; train_chrom_access_recon_loss: 52771935.5152; train_global_loss: 69890730.9091; train_optim_loss: 69890730.9091; val_kl_reg_loss: 152337.2090; val_edge_recon_loss: 2907078.4688; val_gene_expr_recon_loss: 13771896.6250; val_masked_gp_l1_reg_loss: 51900.0117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87902.6328; val_chrom_access_recon_loss: 52644682.5000; val_global_loss: 69615796.5000; val_optim_loss: 69615796.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8773; val_auprc_score: 0.8436; val_best_acc_score: 0.8084; val_best_f1_score: 0.8328; train_kl_reg_loss: 151188.9901; train_edge_recon_loss: 2887417.0720; train_gene_expr_recon_loss: 13949732.7727; train_masked_gp_l1_reg_loss: 51901.9080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87881.8318; train_chrom_access_recon_loss: 52788874.9697; train_global_loss: 69916997.6364; train_optim_loss: 69916997.6364; val_kl_reg_loss: 151574.8711; val_edge_recon_loss: 2862800.0938; val_gene_expr_recon_loss: 13772046.3750; val_masked_gp_l1_reg_loss: 51899.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87855.1641; val_chrom_access_recon_loss: 52418430.5000; val_global_loss: 69344606.0000; val_optim_loss: 69344606.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8838; val_auprc_score: 0.8563; val_best_acc_score: 0.8103; val_best_f1_score: 0.8322; train_kl_reg_loss: 151102.5911; train_edge_recon_loss: 2886969.3371; train_gene_expr_recon_loss: 13945149.3333; train_masked_gp_l1_reg_loss: 51891.1067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87489.2401; train_chrom_access_recon_loss: 52789012.4848; train_global_loss: 69911614.5455; train_optim_loss: 69911614.5455; val_kl_reg_loss: 150709.8691; val_edge_recon_loss: 2862949.8125; val_gene_expr_recon_loss: 13801638.5000; val_masked_gp_l1_reg_loss: 51884.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87419.7969; val_chrom_access_recon_loss: 52480922.0000; val_global_loss: 69435524.0000; val_optim_loss: 69435524.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8724; val_auprc_score: 0.8356; val_best_acc_score: 0.8028; val_best_f1_score: 0.8286; train_kl_reg_loss: 151081.8035; train_edge_recon_loss: 2882639.4167; train_gene_expr_recon_loss: 13947924.3636; train_masked_gp_l1_reg_loss: 51881.3937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87415.8062; train_chrom_access_recon_loss: 52829592.4848; train_global_loss: 69950535.3333; train_optim_loss: 69950535.3333; val_kl_reg_loss: 151896.5508; val_edge_recon_loss: 2905896.8750; val_gene_expr_recon_loss: 13993943.6250; val_masked_gp_l1_reg_loss: 51878.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87411.5938; val_chrom_access_recon_loss: 52605559.0000; val_global_loss: 69796585.0000; val_optim_loss: 69796585.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8815; val_auprc_score: 0.8497; val_best_acc_score: 0.8082; val_best_f1_score: 0.8294; train_kl_reg_loss: 151132.4782; train_edge_recon_loss: 2877012.9205; train_gene_expr_recon_loss: 13948505.8788; train_masked_gp_l1_reg_loss: 51877.3456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87408.6115; train_chrom_access_recon_loss: 52800786.7273; train_global_loss: 69916724.0000; train_optim_loss: 69916724.0000; val_kl_reg_loss: 152580.2344; val_edge_recon_loss: 2901656.0625; val_gene_expr_recon_loss: 13811988.7500; val_masked_gp_l1_reg_loss: 51875.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87408.0469; val_chrom_access_recon_loss: 52013111.0000; val_global_loss: 69018620.5000; val_optim_loss: 69018620.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8667; val_auprc_score: 0.8338; val_best_acc_score: 0.7961; val_best_f1_score: 0.8220; train_kl_reg_loss: 151189.1113; train_edge_recon_loss: 2885611.3788; train_gene_expr_recon_loss: 13928903.9697; train_masked_gp_l1_reg_loss: 51874.7611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87404.0220; train_chrom_access_recon_loss: 52743175.8788; train_global_loss: 69848159.3939; train_optim_loss: 69848159.3939; val_kl_reg_loss: 151150.9355; val_edge_recon_loss: 2931438.4062; val_gene_expr_recon_loss: 13789047.1250; val_masked_gp_l1_reg_loss: 51873.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87399.9453; val_chrom_access_recon_loss: 52050401.5000; val_global_loss: 69061310.0000; val_optim_loss: 69061310.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 37 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.8718
val AUPRC score: 0.8366
val best accuracy score: 0.8004
val best F1 score: 0.8270
val target rna MSE score: 1.4026
val source rna MSE score: 0.5920
val target atac MSE score: 0.1482
val source atac MSE score: 0.0289
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
