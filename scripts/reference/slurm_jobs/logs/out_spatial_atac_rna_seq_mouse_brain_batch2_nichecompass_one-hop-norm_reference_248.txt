[True]
Run timestamp: 10102023_111514_248.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_248']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6550; val_auprc_score: 0.6331; val_best_acc_score: 0.5046; val_best_f1_score: 0.6687; train_kl_reg_loss: 30086.5080; train_edge_recon_loss: 726992.6212; train_gene_expr_recon_loss: 23696100.8182; train_masked_gp_l1_reg_loss: 109197.2113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3286825.5341; train_chrom_access_recon_loss: 11608593.1818; train_global_loss: 39457795.6364; train_optim_loss: 39457795.6364; val_kl_reg_loss: 65926.0513; val_edge_recon_loss: 813055.2422; val_gene_expr_recon_loss: 21712111.2500; val_masked_gp_l1_reg_loss: 92179.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2191003.7500; val_chrom_access_recon_loss: 11025491.1250; val_global_loss: 35899768.0000; val_optim_loss: 35899768.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6956; val_auprc_score: 0.6767; val_best_acc_score: 0.5629; val_best_f1_score: 0.6928; train_kl_reg_loss: 75713.4267; train_edge_recon_loss: 743125.4858; train_gene_expr_recon_loss: 21296386.8182; train_masked_gp_l1_reg_loss: 84375.3745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1401697.3286; train_chrom_access_recon_loss: 11002811.8636; train_global_loss: 34604110.4545; train_optim_loss: 34604110.4545; val_kl_reg_loss: 80443.7412; val_edge_recon_loss: 812468.5781; val_gene_expr_recon_loss: 21349258.7500; val_masked_gp_l1_reg_loss: 80356.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 817788.5625; val_chrom_access_recon_loss: 10915847.7500; val_global_loss: 34056163.0000; val_optim_loss: 34056163.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7420; val_auprc_score: 0.7277; val_best_acc_score: 0.5860; val_best_f1_score: 0.7000; train_kl_reg_loss: 73455.8214; train_edge_recon_loss: 734740.0767; train_gene_expr_recon_loss: 21042818.3030; train_masked_gp_l1_reg_loss: 78639.8237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 562965.8404; train_chrom_access_recon_loss: 10911556.5303; train_global_loss: 33404176.3030; train_optim_loss: 33404176.3030; val_kl_reg_loss: 77949.2871; val_edge_recon_loss: 812064.7578; val_gene_expr_recon_loss: 21166642.2500; val_masked_gp_l1_reg_loss: 77661.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 386162.0625; val_chrom_access_recon_loss: 10989431.6250; val_global_loss: 33509912.2500; val_optim_loss: 33509912.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8341; val_auprc_score: 0.8091; val_best_acc_score: 0.7515; val_best_f1_score: 0.7808; train_kl_reg_loss: 68258.6288; train_edge_recon_loss: 729867.8438; train_gene_expr_recon_loss: 20883180.8788; train_masked_gp_l1_reg_loss: 77491.2333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 301382.8272; train_chrom_access_recon_loss: 10844583.2727; train_global_loss: 32904764.7879; train_optim_loss: 32904764.7879; val_kl_reg_loss: 65858.3496; val_edge_recon_loss: 808775.2734; val_gene_expr_recon_loss: 20950750.0000; val_masked_gp_l1_reg_loss: 77809.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 239668.9219; val_chrom_access_recon_loss: 10855829.1250; val_global_loss: 32998690.7500; val_optim_loss: 32998690.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8644; val_auprc_score: 0.8314; val_best_acc_score: 0.7585; val_best_f1_score: 0.7711; train_kl_reg_loss: 63142.5678; train_edge_recon_loss: 726682.0237; train_gene_expr_recon_loss: 20714450.3636; train_masked_gp_l1_reg_loss: 78548.8304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 209096.9624; train_chrom_access_recon_loss: 10765306.2727; train_global_loss: 32557227.2121; train_optim_loss: 32557227.2121; val_kl_reg_loss: 62855.6831; val_edge_recon_loss: 800847.5234; val_gene_expr_recon_loss: 20645548.0000; val_masked_gp_l1_reg_loss: 79692.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 185078.2500; val_chrom_access_recon_loss: 10659342.3750; val_global_loss: 32433364.0000; val_optim_loss: 32433364.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8730; val_auprc_score: 0.8315; val_best_acc_score: 0.8055; val_best_f1_score: 0.8293; train_kl_reg_loss: 59749.3029; train_edge_recon_loss: 721174.0644; train_gene_expr_recon_loss: 20591621.1515; train_masked_gp_l1_reg_loss: 80511.4786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 168119.8411; train_chrom_access_recon_loss: 10720889.6667; train_global_loss: 32342065.3939; train_optim_loss: 32342065.3939; val_kl_reg_loss: 61254.9668; val_edge_recon_loss: 784485.3281; val_gene_expr_recon_loss: 20825604.7500; val_masked_gp_l1_reg_loss: 81608.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153762.4375; val_chrom_access_recon_loss: 10678006.7500; val_global_loss: 32584722.0000; val_optim_loss: 32584722.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8723; val_auprc_score: 0.8393; val_best_acc_score: 0.8023; val_best_f1_score: 0.8238; train_kl_reg_loss: 56066.2322; train_edge_recon_loss: 712254.9877; train_gene_expr_recon_loss: 20462760.5152; train_masked_gp_l1_reg_loss: 82578.6185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142178.3662; train_chrom_access_recon_loss: 10669251.8788; train_global_loss: 32125090.4848; train_optim_loss: 32125090.4848; val_kl_reg_loss: 55423.2461; val_edge_recon_loss: 746411.2969; val_gene_expr_recon_loss: 20682278.0000; val_masked_gp_l1_reg_loss: 83407.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131374.9062; val_chrom_access_recon_loss: 10604184.3750; val_global_loss: 32303079.0000; val_optim_loss: 32303079.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8660; val_auprc_score: 0.8341; val_best_acc_score: 0.8025; val_best_f1_score: 0.8270; train_kl_reg_loss: 53977.1871; train_edge_recon_loss: 684671.8381; train_gene_expr_recon_loss: 20378962.0303; train_masked_gp_l1_reg_loss: 84508.9002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122583.4110; train_chrom_access_recon_loss: 10634353.3485; train_global_loss: 31959056.5758; train_optim_loss: 31959056.5758; val_kl_reg_loss: 57373.2100; val_edge_recon_loss: 668368.1797; val_gene_expr_recon_loss: 20679987.7500; val_masked_gp_l1_reg_loss: 85934.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114668.2422; val_chrom_access_recon_loss: 10617694.2500; val_global_loss: 32224025.5000; val_optim_loss: 32224025.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8691; val_auprc_score: 0.8425; val_best_acc_score: 0.7972; val_best_f1_score: 0.8226; train_kl_reg_loss: 64649.2901; train_edge_recon_loss: 638178.0900; train_gene_expr_recon_loss: 20289229.9394; train_masked_gp_l1_reg_loss: 86573.0294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108880.8220; train_chrom_access_recon_loss: 10577435.3636; train_global_loss: 31764946.4848; train_optim_loss: 31764946.4848; val_kl_reg_loss: 66792.1514; val_edge_recon_loss: 630215.7031; val_gene_expr_recon_loss: 20483427.0000; val_masked_gp_l1_reg_loss: 87422.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103454.2969; val_chrom_access_recon_loss: 10608631.1250; val_global_loss: 31979941.7500; val_optim_loss: 31979941.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8750; val_auprc_score: 0.8412; val_best_acc_score: 0.7998; val_best_f1_score: 0.8238; train_kl_reg_loss: 69223.9957; train_edge_recon_loss: 625186.5568; train_gene_expr_recon_loss: 20212159.8182; train_masked_gp_l1_reg_loss: 87968.4560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98965.9007; train_chrom_access_recon_loss: 10547161.3636; train_global_loss: 31640666.0303; train_optim_loss: 31640666.0303; val_kl_reg_loss: 70693.0615; val_edge_recon_loss: 624451.2734; val_gene_expr_recon_loss: 20361038.7500; val_masked_gp_l1_reg_loss: 88616.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95781.2656; val_chrom_access_recon_loss: 10493902.3750; val_global_loss: 31734483.5000; val_optim_loss: 31734483.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8837; val_auprc_score: 0.8543; val_best_acc_score: 0.8033; val_best_f1_score: 0.8284; train_kl_reg_loss: 68605.6116; train_edge_recon_loss: 619664.0938; train_gene_expr_recon_loss: 20120775.9394; train_masked_gp_l1_reg_loss: 89155.8757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92612.2022; train_chrom_access_recon_loss: 10509042.4545; train_global_loss: 31499856.1212; train_optim_loss: 31499856.1212; val_kl_reg_loss: 68928.5615; val_edge_recon_loss: 618075.9844; val_gene_expr_recon_loss: 20159515.7500; val_masked_gp_l1_reg_loss: 89754.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90453.3047; val_chrom_access_recon_loss: 10490246.6250; val_global_loss: 31516974.7500; val_optim_loss: 31516974.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8891; val_auprc_score: 0.8614; val_best_acc_score: 0.8047; val_best_f1_score: 0.8270; train_kl_reg_loss: 67782.7343; train_edge_recon_loss: 616438.5540; train_gene_expr_recon_loss: 20041456.0606; train_masked_gp_l1_reg_loss: 90099.0393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88194.6991; train_chrom_access_recon_loss: 10462838.2576; train_global_loss: 31366809.2727; train_optim_loss: 31366809.2727; val_kl_reg_loss: 66889.8711; val_edge_recon_loss: 622467.0547; val_gene_expr_recon_loss: 20125494.7500; val_masked_gp_l1_reg_loss: 90678.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86589.3281; val_chrom_access_recon_loss: 10406804.6250; val_global_loss: 31398924.7500; val_optim_loss: 31398924.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8993; val_auprc_score: 0.8766; val_best_acc_score: 0.8160; val_best_f1_score: 0.8351; train_kl_reg_loss: 66898.3584; train_edge_recon_loss: 613489.0246; train_gene_expr_recon_loss: 19992329.3939; train_masked_gp_l1_reg_loss: 91006.3332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84846.4692; train_chrom_access_recon_loss: 10440380.7121; train_global_loss: 31288950.3030; train_optim_loss: 31288950.3030; val_kl_reg_loss: 65178.5210; val_edge_recon_loss: 615031.9688; val_gene_expr_recon_loss: 19891878.0000; val_masked_gp_l1_reg_loss: 91532.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83290.7578; val_chrom_access_recon_loss: 10254206.2500; val_global_loss: 31001116.7500; val_optim_loss: 31001116.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9011; val_auprc_score: 0.8757; val_best_acc_score: 0.8197; val_best_f1_score: 0.8387; train_kl_reg_loss: 65796.0780; train_edge_recon_loss: 613226.6089; train_gene_expr_recon_loss: 19918018.0606; train_masked_gp_l1_reg_loss: 91798.5062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81876.4614; train_chrom_access_recon_loss: 10394131.5606; train_global_loss: 31164847.1515; train_optim_loss: 31164847.1515; val_kl_reg_loss: 64564.8853; val_edge_recon_loss: 617631.8750; val_gene_expr_recon_loss: 20098023.2500; val_masked_gp_l1_reg_loss: 92392.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80932.7812; val_chrom_access_recon_loss: 10351184.1250; val_global_loss: 31304728.2500; val_optim_loss: 31304728.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9118; val_auprc_score: 0.8864; val_best_acc_score: 0.8326; val_best_f1_score: 0.8453; train_kl_reg_loss: 65207.3177; train_edge_recon_loss: 608209.7472; train_gene_expr_recon_loss: 19859768.1818; train_masked_gp_l1_reg_loss: 92692.3738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79553.9190; train_chrom_access_recon_loss: 10367519.4697; train_global_loss: 31072951.0606; train_optim_loss: 31072951.0606; val_kl_reg_loss: 64864.2271; val_edge_recon_loss: 611510.1641; val_gene_expr_recon_loss: 20166318.2500; val_masked_gp_l1_reg_loss: 92923.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78409.8516; val_chrom_access_recon_loss: 10413027.0000; val_global_loss: 31427054.2500; val_optim_loss: 31427054.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9186; val_auprc_score: 0.8947; val_best_acc_score: 0.8447; val_best_f1_score: 0.8569; train_kl_reg_loss: 65059.3458; train_edge_recon_loss: 604901.7008; train_gene_expr_recon_loss: 19783386.6364; train_masked_gp_l1_reg_loss: 93369.2308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77368.9788; train_chrom_access_recon_loss: 10325275.9697; train_global_loss: 30949361.9091; train_optim_loss: 30949361.9091; val_kl_reg_loss: 63955.4224; val_edge_recon_loss: 602827.4688; val_gene_expr_recon_loss: 19861964.0000; val_masked_gp_l1_reg_loss: 93847.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76484.4609; val_chrom_access_recon_loss: 10246543.5000; val_global_loss: 30945622.5000; val_optim_loss: 30945622.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9180; val_auprc_score: 0.8908; val_best_acc_score: 0.8509; val_best_f1_score: 0.8611; train_kl_reg_loss: 64726.1657; train_edge_recon_loss: 599773.7794; train_gene_expr_recon_loss: 19733988.8485; train_masked_gp_l1_reg_loss: 94016.6745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75658.7498; train_chrom_access_recon_loss: 10298264.5152; train_global_loss: 30866428.7879; train_optim_loss: 30866428.7879; val_kl_reg_loss: 64739.5684; val_edge_recon_loss: 604083.4062; val_gene_expr_recon_loss: 19949092.7500; val_masked_gp_l1_reg_loss: 94544.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74956.0234; val_chrom_access_recon_loss: 10234383.7500; val_global_loss: 31021799.7500; val_optim_loss: 31021799.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9227; val_auprc_score: 0.8971; val_best_acc_score: 0.8565; val_best_f1_score: 0.8672; train_kl_reg_loss: 64441.1318; train_edge_recon_loss: 600820.0748; train_gene_expr_recon_loss: 19690767.4848; train_masked_gp_l1_reg_loss: 94694.7558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74166.5743; train_chrom_access_recon_loss: 10274373.1364; train_global_loss: 30799263.2424; train_optim_loss: 30799263.2424; val_kl_reg_loss: 64245.2217; val_edge_recon_loss: 600170.5859; val_gene_expr_recon_loss: 19866438.0000; val_masked_gp_l1_reg_loss: 95177.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73710.1562; val_chrom_access_recon_loss: 10296759.7500; val_global_loss: 30996501.5000; val_optim_loss: 30996501.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9296; val_auprc_score: 0.9073; val_best_acc_score: 0.8603; val_best_f1_score: 0.8707; train_kl_reg_loss: 64083.0371; train_edge_recon_loss: 595758.5881; train_gene_expr_recon_loss: 19658438.8485; train_masked_gp_l1_reg_loss: 95439.8714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73177.8319; train_chrom_access_recon_loss: 10248620.6818; train_global_loss: 30735518.8182; train_optim_loss: 30735518.8182; val_kl_reg_loss: 63604.6704; val_edge_recon_loss: 598332.6250; val_gene_expr_recon_loss: 19691740.2500; val_masked_gp_l1_reg_loss: 95974.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72868.8828; val_chrom_access_recon_loss: 10188442.2500; val_global_loss: 30710962.2500; val_optim_loss: 30710962.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9340; val_auprc_score: 0.9158; val_best_acc_score: 0.8686; val_best_f1_score: 0.8780; train_kl_reg_loss: 63576.7188; train_edge_recon_loss: 596873.3125; train_gene_expr_recon_loss: 19609509.3030; train_masked_gp_l1_reg_loss: 96025.9325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72091.3602; train_chrom_access_recon_loss: 10212788.9697; train_global_loss: 30650865.4545; train_optim_loss: 30650865.4545; val_kl_reg_loss: 63341.1489; val_edge_recon_loss: 597008.4688; val_gene_expr_recon_loss: 19722293.0000; val_masked_gp_l1_reg_loss: 96359.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71956.6719; val_chrom_access_recon_loss: 10308559.7500; val_global_loss: 30859518.2500; val_optim_loss: 30859518.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9331; val_auprc_score: 0.9106; val_best_acc_score: 0.8692; val_best_f1_score: 0.8800; train_kl_reg_loss: 63469.6071; train_edge_recon_loss: 592385.4100; train_gene_expr_recon_loss: 19564244.2424; train_masked_gp_l1_reg_loss: 96608.8786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71143.1977; train_chrom_access_recon_loss: 10182932.9242; train_global_loss: 30570784.3030; train_optim_loss: 30570784.3030; val_kl_reg_loss: 62763.2349; val_edge_recon_loss: 595654.4844; val_gene_expr_recon_loss: 19593764.7500; val_masked_gp_l1_reg_loss: 96936.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71021.9609; val_chrom_access_recon_loss: 10218740.6250; val_global_loss: 30638881.5000; val_optim_loss: 30638881.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9305; val_auprc_score: 0.9046; val_best_acc_score: 0.8702; val_best_f1_score: 0.8786; train_kl_reg_loss: 63133.5098; train_edge_recon_loss: 591393.3845; train_gene_expr_recon_loss: 19509808.3636; train_masked_gp_l1_reg_loss: 97124.5314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70447.1338; train_chrom_access_recon_loss: 10140024.5303; train_global_loss: 30471931.1212; train_optim_loss: 30471931.1212; val_kl_reg_loss: 63176.9243; val_edge_recon_loss: 594956.2578; val_gene_expr_recon_loss: 19468487.5000; val_masked_gp_l1_reg_loss: 97434.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69631.2734; val_chrom_access_recon_loss: 9990129.6250; val_global_loss: 30283816.2500; val_optim_loss: 30283816.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9341; val_auprc_score: 0.9136; val_best_acc_score: 0.8692; val_best_f1_score: 0.8791; train_kl_reg_loss: 62536.1924; train_edge_recon_loss: 591927.8617; train_gene_expr_recon_loss: 19474412.2121; train_masked_gp_l1_reg_loss: 97518.5162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69714.3191; train_chrom_access_recon_loss: 10121479.8030; train_global_loss: 30417589.0303; train_optim_loss: 30417589.0303; val_kl_reg_loss: 62900.8892; val_edge_recon_loss: 600475.1797; val_gene_expr_recon_loss: 19728180.7500; val_masked_gp_l1_reg_loss: 97856.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69835.2656; val_chrom_access_recon_loss: 10135313.5000; val_global_loss: 30694562.5000; val_optim_loss: 30694562.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9344; val_auprc_score: 0.9000; val_best_acc_score: 0.8764; val_best_f1_score: 0.8825; train_kl_reg_loss: 62683.7498; train_edge_recon_loss: 588509.0038; train_gene_expr_recon_loss: 19427417.3636; train_masked_gp_l1_reg_loss: 98069.0567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69428.9309; train_chrom_access_recon_loss: 10075726.2273; train_global_loss: 30321834.6364; train_optim_loss: 30321834.6364; val_kl_reg_loss: 62682.4028; val_edge_recon_loss: 592844.1641; val_gene_expr_recon_loss: 19690832.2500; val_masked_gp_l1_reg_loss: 98426.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69134.6875; val_chrom_access_recon_loss: 10065949.0000; val_global_loss: 30579867.7500; val_optim_loss: 30579867.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9425; val_auprc_score: 0.9256; val_best_acc_score: 0.8802; val_best_f1_score: 0.8878; train_kl_reg_loss: 62058.5899; train_edge_recon_loss: 589873.7027; train_gene_expr_recon_loss: 19384653.6061; train_masked_gp_l1_reg_loss: 98571.1204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69183.0687; train_chrom_access_recon_loss: 10044488.0909; train_global_loss: 30248828.1212; train_optim_loss: 30248828.1212; val_kl_reg_loss: 62650.5435; val_edge_recon_loss: 592394.8672; val_gene_expr_recon_loss: 19609252.7500; val_masked_gp_l1_reg_loss: 98990.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69115.0547; val_chrom_access_recon_loss: 10114215.8750; val_global_loss: 30546619.7500; val_optim_loss: 30546619.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8735; val_auprc_score: 0.8434; val_best_acc_score: 0.7939; val_best_f1_score: 0.8165; train_kl_reg_loss: 40930.6952; train_edge_recon_loss: 757415.7566; train_gene_expr_recon_loss: 18559249.6364; train_masked_gp_l1_reg_loss: 99392.3053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67388.5763; train_chrom_access_recon_loss: 9722271.9848; train_global_loss: 29246648.9697; train_optim_loss: 29246648.9697; val_kl_reg_loss: 11653.3651; val_edge_recon_loss: 790942.6953; val_gene_expr_recon_loss: 18404793.2500; val_masked_gp_l1_reg_loss: 102134.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76168.9531; val_chrom_access_recon_loss: 9582009.7500; val_global_loss: 28967701.2500; val_optim_loss: 28967701.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8789; val_auprc_score: 0.8443; val_best_acc_score: 0.8074; val_best_f1_score: 0.8234; train_kl_reg_loss: 20948.7531; train_edge_recon_loss: 770230.7131; train_gene_expr_recon_loss: 18275382.5455; train_masked_gp_l1_reg_loss: 100933.3664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77790.9781; train_chrom_access_recon_loss: 9566103.3636; train_global_loss: 28811389.8485; train_optim_loss: 28811389.8485; val_kl_reg_loss: 6900.1940; val_edge_recon_loss: 777861.7500; val_gene_expr_recon_loss: 18619443.0000; val_masked_gp_l1_reg_loss: 98954.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78527.6953; val_chrom_access_recon_loss: 9520573.3750; val_global_loss: 29102260.5000; val_optim_loss: 29102260.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8680; val_auprc_score: 0.8286; val_best_acc_score: 0.7934; val_best_f1_score: 0.8129; train_kl_reg_loss: 18634.9035; train_edge_recon_loss: 762561.2566; train_gene_expr_recon_loss: 18205109.8182; train_masked_gp_l1_reg_loss: 100007.8263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81135.7392; train_chrom_access_recon_loss: 9526615.0455; train_global_loss: 28694064.4545; train_optim_loss: 28694064.4545; val_kl_reg_loss: 11144.0597; val_edge_recon_loss: 762890.0000; val_gene_expr_recon_loss: 18328511.0000; val_masked_gp_l1_reg_loss: 98199.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79915.6562; val_chrom_access_recon_loss: 9556336.0000; val_global_loss: 28836997.0000; val_optim_loss: 28836997.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8701; val_auprc_score: 0.8364; val_best_acc_score: 0.7934; val_best_f1_score: 0.8126; train_kl_reg_loss: 20037.1429; train_edge_recon_loss: 751639.3134; train_gene_expr_recon_loss: 18076244.6364; train_masked_gp_l1_reg_loss: 96157.8028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78775.7501; train_chrom_access_recon_loss: 9489991.2121; train_global_loss: 28512845.8182; train_optim_loss: 28512845.8182; val_kl_reg_loss: 12462.5955; val_edge_recon_loss: 752581.1484; val_gene_expr_recon_loss: 18214753.2500; val_masked_gp_l1_reg_loss: 94316.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77705.0234; val_chrom_access_recon_loss: 9567801.7500; val_global_loss: 28719620.7500; val_optim_loss: 28719620.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8705; val_auprc_score: 0.8358; val_best_acc_score: 0.7899; val_best_f1_score: 0.8160; train_kl_reg_loss: 19777.2561; train_edge_recon_loss: 735566.2708; train_gene_expr_recon_loss: 17981778.3939; train_masked_gp_l1_reg_loss: 92863.9134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76971.9833; train_chrom_access_recon_loss: 9460836.9697; train_global_loss: 28367794.9697; train_optim_loss: 28367794.9697; val_kl_reg_loss: 12432.8704; val_edge_recon_loss: 727590.4297; val_gene_expr_recon_loss: 18144287.0000; val_masked_gp_l1_reg_loss: 91546.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75627.1250; val_chrom_access_recon_loss: 9337063.1250; val_global_loss: 28388547.2500; val_optim_loss: 28388547.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8531; val_auprc_score: 0.8054; val_best_acc_score: 0.7877; val_best_f1_score: 0.8168; train_kl_reg_loss: 21323.0898; train_edge_recon_loss: 718165.0578; train_gene_expr_recon_loss: 17998517.4545; train_masked_gp_l1_reg_loss: 91429.5906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76241.8751; train_chrom_access_recon_loss: 9457222.4242; train_global_loss: 28362899.6667; train_optim_loss: 28362899.6667; val_kl_reg_loss: 16886.3243; val_edge_recon_loss: 725828.5547; val_gene_expr_recon_loss: 18126203.5000; val_masked_gp_l1_reg_loss: 90604.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75763.7734; val_chrom_access_recon_loss: 9473511.8750; val_global_loss: 28508798.0000; val_optim_loss: 28508798.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8594; val_auprc_score: 0.8199; val_best_acc_score: 0.7974; val_best_f1_score: 0.8241; train_kl_reg_loss: 22565.7353; train_edge_recon_loss: 707797.4072; train_gene_expr_recon_loss: 17925406.9091; train_masked_gp_l1_reg_loss: 89858.1019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74782.2807; train_chrom_access_recon_loss: 9433662.4545; train_global_loss: 28254072.7576; train_optim_loss: 28254072.7576; val_kl_reg_loss: 15520.9255; val_edge_recon_loss: 712532.9219; val_gene_expr_recon_loss: 17930545.1250; val_masked_gp_l1_reg_loss: 89210.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73771.5156; val_chrom_access_recon_loss: 9386303.5000; val_global_loss: 28207883.7500; val_optim_loss: 28207883.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8548; val_auprc_score: 0.8053; val_best_acc_score: 0.7963; val_best_f1_score: 0.8234; train_kl_reg_loss: 22509.5038; train_edge_recon_loss: 695365.5568; train_gene_expr_recon_loss: 17913032.0909; train_masked_gp_l1_reg_loss: 88855.5002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73020.3027; train_chrom_access_recon_loss: 9425944.0606; train_global_loss: 28218727.1515; train_optim_loss: 28218727.1515; val_kl_reg_loss: 16524.6450; val_edge_recon_loss: 691161.8516; val_gene_expr_recon_loss: 18061574.2500; val_masked_gp_l1_reg_loss: 88716.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72957.8359; val_chrom_access_recon_loss: 9375249.0000; val_global_loss: 28306183.7500; val_optim_loss: 28306183.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8649; val_auprc_score: 0.8276; val_best_acc_score: 0.7945; val_best_f1_score: 0.8227; train_kl_reg_loss: 23189.1466; train_edge_recon_loss: 676842.3731; train_gene_expr_recon_loss: 17853821.0303; train_masked_gp_l1_reg_loss: 88397.6486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72187.0191; train_chrom_access_recon_loss: 9406158.3636; train_global_loss: 28120595.6667; train_optim_loss: 28120595.6667; val_kl_reg_loss: 18335.4221; val_edge_recon_loss: 679286.8672; val_gene_expr_recon_loss: 17977840.0000; val_masked_gp_l1_reg_loss: 88153.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71720.4922; val_chrom_access_recon_loss: 9361758.8750; val_global_loss: 28197095.0000; val_optim_loss: 28197095.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8744; val_auprc_score: 0.8390; val_best_acc_score: 0.8114; val_best_f1_score: 0.8339; train_kl_reg_loss: 24081.3539; train_edge_recon_loss: 664112.4744; train_gene_expr_recon_loss: 17819315.0000; train_masked_gp_l1_reg_loss: 87894.1899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71263.8832; train_chrom_access_recon_loss: 9391024.6364; train_global_loss: 28057691.6061; train_optim_loss: 28057691.6061; val_kl_reg_loss: 18887.5649; val_edge_recon_loss: 655732.2891; val_gene_expr_recon_loss: 18131029.7500; val_masked_gp_l1_reg_loss: 87636.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70694.7344; val_chrom_access_recon_loss: 9356647.6250; val_global_loss: 28320628.0000; val_optim_loss: 28320628.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8496; val_auprc_score: 0.7963; val_best_acc_score: 0.7931; val_best_f1_score: 0.8217; train_kl_reg_loss: 25178.2455; train_edge_recon_loss: 651022.0388; train_gene_expr_recon_loss: 17805303.1818; train_masked_gp_l1_reg_loss: 87338.2615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69693.2371; train_chrom_access_recon_loss: 9379975.8485; train_global_loss: 28018510.8788; train_optim_loss: 28018510.8788; val_kl_reg_loss: 20128.1135; val_edge_recon_loss: 648745.1172; val_gene_expr_recon_loss: 17848041.5000; val_masked_gp_l1_reg_loss: 87258.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69535.4219; val_chrom_access_recon_loss: 9253878.3750; val_global_loss: 27927587.0000; val_optim_loss: 27927587.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8672; val_auprc_score: 0.8254; val_best_acc_score: 0.8057; val_best_f1_score: 0.8303; train_kl_reg_loss: 26520.4042; train_edge_recon_loss: 639133.1875; train_gene_expr_recon_loss: 17769159.2727; train_masked_gp_l1_reg_loss: 86876.4407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68705.5213; train_chrom_access_recon_loss: 9354167.1667; train_global_loss: 27944562.0909; train_optim_loss: 27944562.0909; val_kl_reg_loss: 21782.7068; val_edge_recon_loss: 635473.6953; val_gene_expr_recon_loss: 17908094.0000; val_masked_gp_l1_reg_loss: 86611.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67977.9531; val_chrom_access_recon_loss: 9362744.1250; val_global_loss: 28082684.2500; val_optim_loss: 28082684.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8629; val_auprc_score: 0.8273; val_best_acc_score: 0.8012; val_best_f1_score: 0.8254; train_kl_reg_loss: 27846.7156; train_edge_recon_loss: 629564.0786; train_gene_expr_recon_loss: 17733203.6667; train_masked_gp_l1_reg_loss: 86393.5078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67323.8899; train_chrom_access_recon_loss: 9338297.9545; train_global_loss: 27882630.1818; train_optim_loss: 27882630.1818; val_kl_reg_loss: 21895.2715; val_edge_recon_loss: 637012.2500; val_gene_expr_recon_loss: 17937291.7500; val_masked_gp_l1_reg_loss: 86157.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66844.0938; val_chrom_access_recon_loss: 9282163.5000; val_global_loss: 28031364.7500; val_optim_loss: 28031364.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8688; val_auprc_score: 0.8338; val_best_acc_score: 0.8092; val_best_f1_score: 0.8333; train_kl_reg_loss: 29618.4916; train_edge_recon_loss: 629290.4062; train_gene_expr_recon_loss: 17704912.8333; train_masked_gp_l1_reg_loss: 85944.6501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66206.0556; train_chrom_access_recon_loss: 9326459.9091; train_global_loss: 27842432.3939; train_optim_loss: 27842432.3939; val_kl_reg_loss: 24215.8350; val_edge_recon_loss: 622320.2500; val_gene_expr_recon_loss: 17821896.5000; val_masked_gp_l1_reg_loss: 85819.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65751.1719; val_chrom_access_recon_loss: 9268085.7500; val_global_loss: 27888090.5000; val_optim_loss: 27888090.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8514; val_auprc_score: 0.8103; val_best_acc_score: 0.7875; val_best_f1_score: 0.8189; train_kl_reg_loss: 31254.8369; train_edge_recon_loss: 620092.2301; train_gene_expr_recon_loss: 17678574.1515; train_masked_gp_l1_reg_loss: 85556.0094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65368.1184; train_chrom_access_recon_loss: 9310236.2727; train_global_loss: 27791081.6061; train_optim_loss: 27791081.6061; val_kl_reg_loss: 25981.0930; val_edge_recon_loss: 628287.0547; val_gene_expr_recon_loss: 17795711.5000; val_masked_gp_l1_reg_loss: 85495.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64946.9883; val_chrom_access_recon_loss: 9286088.0000; val_global_loss: 27886509.2500; val_optim_loss: 27886509.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8527; val_auprc_score: 0.8124; val_best_acc_score: 0.7877; val_best_f1_score: 0.8174; train_kl_reg_loss: 32785.7747; train_edge_recon_loss: 615246.0483; train_gene_expr_recon_loss: 17662920.0606; train_masked_gp_l1_reg_loss: 85260.1548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64573.7354; train_chrom_access_recon_loss: 9294425.7727; train_global_loss: 27755211.5455; train_optim_loss: 27755211.5455; val_kl_reg_loss: 28128.9666; val_edge_recon_loss: 622846.1406; val_gene_expr_recon_loss: 17817799.5000; val_masked_gp_l1_reg_loss: 85048.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63998.1719; val_chrom_access_recon_loss: 9320303.0000; val_global_loss: 27938124.2500; val_optim_loss: 27938124.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8645; val_auprc_score: 0.8285; val_best_acc_score: 0.7920; val_best_f1_score: 0.8217; train_kl_reg_loss: 34138.1385; train_edge_recon_loss: 609243.8409; train_gene_expr_recon_loss: 17635871.6364; train_masked_gp_l1_reg_loss: 84792.2524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63733.2096; train_chrom_access_recon_loss: 9274973.7424; train_global_loss: 27702752.6667; train_optim_loss: 27702752.6667; val_kl_reg_loss: 29914.8420; val_edge_recon_loss: 612649.9766; val_gene_expr_recon_loss: 17632068.0000; val_masked_gp_l1_reg_loss: 84595.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63454.4766; val_chrom_access_recon_loss: 9174982.3750; val_global_loss: 27597665.2500; val_optim_loss: 27597665.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8576; val_auprc_score: 0.8186; val_best_acc_score: 0.7953; val_best_f1_score: 0.8231; train_kl_reg_loss: 35217.5494; train_edge_recon_loss: 604731.1146; train_gene_expr_recon_loss: 17602051.0909; train_masked_gp_l1_reg_loss: 84257.8905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63067.8016; train_chrom_access_recon_loss: 9249849.6667; train_global_loss: 27639175.3333; train_optim_loss: 27639175.3333; val_kl_reg_loss: 30233.2571; val_edge_recon_loss: 611053.2578; val_gene_expr_recon_loss: 17517862.2500; val_masked_gp_l1_reg_loss: 83985.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62530.4727; val_chrom_access_recon_loss: 9108777.6250; val_global_loss: 27414442.5000; val_optim_loss: 27414442.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8662; val_auprc_score: 0.8286; val_best_acc_score: 0.8047; val_best_f1_score: 0.8320; train_kl_reg_loss: 36387.9830; train_edge_recon_loss: 601124.2822; train_gene_expr_recon_loss: 17574749.5758; train_masked_gp_l1_reg_loss: 83711.7678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62226.6615; train_chrom_access_recon_loss: 9239970.7879; train_global_loss: 27598170.9697; train_optim_loss: 27598170.9697; val_kl_reg_loss: 33570.2510; val_edge_recon_loss: 600669.2812; val_gene_expr_recon_loss: 17853024.0000; val_masked_gp_l1_reg_loss: 83477.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62136.7188; val_chrom_access_recon_loss: 9280198.3750; val_global_loss: 27913076.0000; val_optim_loss: 27913076.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8606; val_auprc_score: 0.8204; val_best_acc_score: 0.8012; val_best_f1_score: 0.8260; train_kl_reg_loss: 37232.3092; train_edge_recon_loss: 596395.0028; train_gene_expr_recon_loss: 17522457.8182; train_masked_gp_l1_reg_loss: 83198.6860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61691.7022; train_chrom_access_recon_loss: 9230231.8333; train_global_loss: 27531207.3636; train_optim_loss: 27531207.3636; val_kl_reg_loss: 34899.4048; val_edge_recon_loss: 609305.8594; val_gene_expr_recon_loss: 17473071.7500; val_masked_gp_l1_reg_loss: 82983.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61387.4219; val_chrom_access_recon_loss: 9200901.0000; val_global_loss: 27462550.2500; val_optim_loss: 27462550.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8747; val_auprc_score: 0.8387; val_best_acc_score: 0.8162; val_best_f1_score: 0.8352; train_kl_reg_loss: 38109.4281; train_edge_recon_loss: 594099.4119; train_gene_expr_recon_loss: 17508866.1515; train_masked_gp_l1_reg_loss: 82618.0169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61198.1048; train_chrom_access_recon_loss: 9220324.0606; train_global_loss: 27505215.1818; train_optim_loss: 27505215.1818; val_kl_reg_loss: 36011.1128; val_edge_recon_loss: 594977.9141; val_gene_expr_recon_loss: 17771090.0000; val_masked_gp_l1_reg_loss: 82346.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60946.6445; val_chrom_access_recon_loss: 9185338.3750; val_global_loss: 27730709.5000; val_optim_loss: 27730709.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8695; val_auprc_score: 0.8314; val_best_acc_score: 0.8047; val_best_f1_score: 0.8282; train_kl_reg_loss: 38532.2316; train_edge_recon_loss: 597021.0975; train_gene_expr_recon_loss: 17488656.0303; train_masked_gp_l1_reg_loss: 82079.6761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60647.2312; train_chrom_access_recon_loss: 9213924.3333; train_global_loss: 27480860.5455; train_optim_loss: 27480860.5455; val_kl_reg_loss: 36061.4141; val_edge_recon_loss: 603363.0547; val_gene_expr_recon_loss: 17433131.5000; val_masked_gp_l1_reg_loss: 81847.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60418.9375; val_chrom_access_recon_loss: 9127786.0000; val_global_loss: 27342608.0000; val_optim_loss: 27342608.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8659; val_auprc_score: 0.8260; val_best_acc_score: 0.7966; val_best_f1_score: 0.8236; train_kl_reg_loss: 39116.2447; train_edge_recon_loss: 590791.1402; train_gene_expr_recon_loss: 17479106.4545; train_masked_gp_l1_reg_loss: 81573.7321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60203.9805; train_chrom_access_recon_loss: 9200693.9697; train_global_loss: 27451485.2727; train_optim_loss: 27451485.2727; val_kl_reg_loss: 37799.1196; val_edge_recon_loss: 602964.0781; val_gene_expr_recon_loss: 17718777.0000; val_masked_gp_l1_reg_loss: 81419.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59867.7422; val_chrom_access_recon_loss: 9175158.7500; val_global_loss: 27675986.7500; val_optim_loss: 27675986.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8729; val_auprc_score: 0.8386; val_best_acc_score: 0.8049; val_best_f1_score: 0.8285; train_kl_reg_loss: 39595.4825; train_edge_recon_loss: 593389.7888; train_gene_expr_recon_loss: 17470636.4545; train_masked_gp_l1_reg_loss: 81123.9583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59655.9495; train_chrom_access_recon_loss: 9197521.5606; train_global_loss: 27441923.2727; train_optim_loss: 27441923.2727; val_kl_reg_loss: 37997.5728; val_edge_recon_loss: 597365.7500; val_gene_expr_recon_loss: 17597184.2500; val_masked_gp_l1_reg_loss: 80922.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59705.0430; val_chrom_access_recon_loss: 9106547.3750; val_global_loss: 27479722.7500; val_optim_loss: 27479722.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8765; val_auprc_score: 0.8411; val_best_acc_score: 0.8057; val_best_f1_score: 0.8260; train_kl_reg_loss: 39901.4865; train_edge_recon_loss: 588608.3419; train_gene_expr_recon_loss: 17457515.5758; train_masked_gp_l1_reg_loss: 80717.4089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59352.4704; train_chrom_access_recon_loss: 9198030.3333; train_global_loss: 27424125.4848; train_optim_loss: 27424125.4848; val_kl_reg_loss: 38210.8877; val_edge_recon_loss: 597290.6250; val_gene_expr_recon_loss: 17593605.5000; val_masked_gp_l1_reg_loss: 80592.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59117.2383; val_chrom_access_recon_loss: 9141617.6250; val_global_loss: 27510435.2500; val_optim_loss: 27510435.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8773; val_auprc_score: 0.8437; val_best_acc_score: 0.8106; val_best_f1_score: 0.8296; train_kl_reg_loss: 40202.2157; train_edge_recon_loss: 589207.3248; train_gene_expr_recon_loss: 17447088.3333; train_masked_gp_l1_reg_loss: 80379.2534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58997.8455; train_chrom_access_recon_loss: 9192481.5909; train_global_loss: 27408356.7576; train_optim_loss: 27408356.7576; val_kl_reg_loss: 38841.1045; val_edge_recon_loss: 597775.6719; val_gene_expr_recon_loss: 17582041.2500; val_masked_gp_l1_reg_loss: 80327.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58828.4453; val_chrom_access_recon_loss: 9082971.5000; val_global_loss: 27440786.0000; val_optim_loss: 27440786.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8817; val_auprc_score: 0.8478; val_best_acc_score: 0.8122; val_best_f1_score: 0.8307; train_kl_reg_loss: 40522.6421; train_edge_recon_loss: 590233.0303; train_gene_expr_recon_loss: 17430279.6667; train_masked_gp_l1_reg_loss: 78735.1229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51342.9912; train_chrom_access_recon_loss: 9188189.7424; train_global_loss: 27379303.1515; train_optim_loss: 27379303.1515; val_kl_reg_loss: 39727.5361; val_edge_recon_loss: 592585.2500; val_gene_expr_recon_loss: 17529386.7500; val_masked_gp_l1_reg_loss: 78185.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49768.6211; val_chrom_access_recon_loss: 9207140.5000; val_global_loss: 27496794.2500; val_optim_loss: 27496794.2500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8797; val_auprc_score: 0.8431; val_best_acc_score: 0.8074; val_best_f1_score: 0.8321; train_kl_reg_loss: 40933.1648; train_edge_recon_loss: 590033.9877; train_gene_expr_recon_loss: 17426312.3485; train_masked_gp_l1_reg_loss: 78073.8144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49530.4390; train_chrom_access_recon_loss: 9182375.0758; train_global_loss: 27367258.8485; train_optim_loss: 27367258.8485; val_kl_reg_loss: 39222.2300; val_edge_recon_loss: 590557.1719; val_gene_expr_recon_loss: 17436630.2500; val_masked_gp_l1_reg_loss: 77999.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49352.3281; val_chrom_access_recon_loss: 9145241.8750; val_global_loss: 27339003.7500; val_optim_loss: 27339003.7500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8809; val_auprc_score: 0.8478; val_best_acc_score: 0.8098; val_best_f1_score: 0.8335; train_kl_reg_loss: 41074.2302; train_edge_recon_loss: 589003.3390; train_gene_expr_recon_loss: 17429711.8939; train_masked_gp_l1_reg_loss: 77922.7362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49224.5719; train_chrom_access_recon_loss: 9184733.8030; train_global_loss: 27371670.4848; train_optim_loss: 27371670.4848; val_kl_reg_loss: 39702.4199; val_edge_recon_loss: 589890.1484; val_gene_expr_recon_loss: 17552410.2500; val_masked_gp_l1_reg_loss: 77873.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49061.4453; val_chrom_access_recon_loss: 9171660.1250; val_global_loss: 27480598.7500; val_optim_loss: 27480598.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8804; val_auprc_score: 0.8473; val_best_acc_score: 0.8111; val_best_f1_score: 0.8347; train_kl_reg_loss: 41227.9494; train_edge_recon_loss: 587302.9678; train_gene_expr_recon_loss: 17404996.5303; train_masked_gp_l1_reg_loss: 77838.5659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48980.2587; train_chrom_access_recon_loss: 9176382.3333; train_global_loss: 27336728.8182; train_optim_loss: 27336728.8182; val_kl_reg_loss: 39712.9331; val_edge_recon_loss: 590642.9922; val_gene_expr_recon_loss: 17724431.5000; val_masked_gp_l1_reg_loss: 77784.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48865.3125; val_chrom_access_recon_loss: 9216523.2500; val_global_loss: 27697961.0000; val_optim_loss: 27697961.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8780; val_auprc_score: 0.8432; val_best_acc_score: 0.8063; val_best_f1_score: 0.8311; train_kl_reg_loss: 41234.9099; train_edge_recon_loss: 588873.4953; train_gene_expr_recon_loss: 17405991.8636; train_masked_gp_l1_reg_loss: 77741.5969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48777.0304; train_chrom_access_recon_loss: 9169320.2424; train_global_loss: 27331939.0909; train_optim_loss: 27331939.0909; val_kl_reg_loss: 39951.1846; val_edge_recon_loss: 593032.1641; val_gene_expr_recon_loss: 17576031.5000; val_masked_gp_l1_reg_loss: 77717.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48702.0820; val_chrom_access_recon_loss: 9142129.5000; val_global_loss: 27477564.2500; val_optim_loss: 27477564.2500
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.8677; val_auprc_score: 0.8306; val_best_acc_score: 0.7963; val_best_f1_score: 0.8217; train_kl_reg_loss: 41400.1998; train_edge_recon_loss: 584859.4091; train_gene_expr_recon_loss: 17389869.7576; train_masked_gp_l1_reg_loss: 77684.6864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48616.1574; train_chrom_access_recon_loss: 9161735.2727; train_global_loss: 27304165.2727; train_optim_loss: 27304165.2727; val_kl_reg_loss: 39996.5464; val_edge_recon_loss: 600728.0312; val_gene_expr_recon_loss: 17609120.7500; val_masked_gp_l1_reg_loss: 77641.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48512.8438; val_chrom_access_recon_loss: 9168271.1250; val_global_loss: 27544271.0000; val_optim_loss: 27544271.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.8768; val_auprc_score: 0.8372; val_best_acc_score: 0.8095; val_best_f1_score: 0.8307; train_kl_reg_loss: 41421.3403; train_edge_recon_loss: 586371.4801; train_gene_expr_recon_loss: 17395568.6061; train_masked_gp_l1_reg_loss: 77484.5156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47742.6571; train_chrom_access_recon_loss: 9167182.0152; train_global_loss: 27315770.7576; train_optim_loss: 27315770.7576; val_kl_reg_loss: 40139.5957; val_edge_recon_loss: 592982.6172; val_gene_expr_recon_loss: 17719800.0000; val_masked_gp_l1_reg_loss: 77425.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47590.0000; val_chrom_access_recon_loss: 9191969.0000; val_global_loss: 27669907.2500; val_optim_loss: 27669907.2500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.8820; val_auprc_score: 0.8507; val_best_acc_score: 0.8111; val_best_f1_score: 0.8286; train_kl_reg_loss: 41421.4273; train_edge_recon_loss: 588851.5019; train_gene_expr_recon_loss: 17397530.0000; train_masked_gp_l1_reg_loss: 77404.3576; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47568.0233; train_chrom_access_recon_loss: 9168091.4697; train_global_loss: 27320866.6061; train_optim_loss: 27320866.6061; val_kl_reg_loss: 40092.0952; val_edge_recon_loss: 595497.0859; val_gene_expr_recon_loss: 17537196.7500; val_masked_gp_l1_reg_loss: 77391.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47552.6680; val_chrom_access_recon_loss: 9170220.6250; val_global_loss: 27467950.5000; val_optim_loss: 27467950.5000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.8848; val_auprc_score: 0.8464; val_best_acc_score: 0.8127; val_best_f1_score: 0.8352; train_kl_reg_loss: 41382.1448; train_edge_recon_loss: 587927.9915; train_gene_expr_recon_loss: 17388193.4242; train_masked_gp_l1_reg_loss: 77380.7322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47538.1253; train_chrom_access_recon_loss: 9163269.8788; train_global_loss: 27305692.2121; train_optim_loss: 27305692.2121; val_kl_reg_loss: 39861.9375; val_edge_recon_loss: 592125.0234; val_gene_expr_recon_loss: 17618986.3750; val_masked_gp_l1_reg_loss: 77369.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47523.4531; val_chrom_access_recon_loss: 9175839.1250; val_global_loss: 27551706.5000; val_optim_loss: 27551706.5000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.8770; val_auprc_score: 0.8416; val_best_acc_score: 0.8076; val_best_f1_score: 0.8313; train_kl_reg_loss: 41440.3844; train_edge_recon_loss: 586084.6098; train_gene_expr_recon_loss: 17386664.3636; train_masked_gp_l1_reg_loss: 77363.9624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47511.4647; train_chrom_access_recon_loss: 9166433.8030; train_global_loss: 27305498.5152; train_optim_loss: 27305498.5152; val_kl_reg_loss: 39610.4741; val_edge_recon_loss: 595464.9062; val_gene_expr_recon_loss: 17519090.7500; val_masked_gp_l1_reg_loss: 77355.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47497.8711; val_chrom_access_recon_loss: 9103364.7500; val_global_loss: 27382384.2500; val_optim_loss: 27382384.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 28 min 46 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.8757
val AUPRC score: 0.8458
val best accuracy score: 0.8052
val best F1 score: 0.8231
val target rna MSE score: 1.8529
val source rna MSE score: 0.8222
val target atac MSE score: 0.3104
val source atac MSE score: 0.1352
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
