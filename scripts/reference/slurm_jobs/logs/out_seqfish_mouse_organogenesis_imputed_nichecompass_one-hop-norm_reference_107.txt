[True]
Run timestamp: 01082023_054132_107.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '12', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '5', '--edge_batch_size', '2048', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_107']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_pred_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1548, n_latent: 1538, n_addon_latent: 10, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1538, n_cat_covariates_embed_input: 3, n_addon_gp_input: 10, n_output: 4032

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9143; val_auprc_score: 0.9831; val_best_acc_score: 0.8533; val_best_f1_score: 0.9209; train_kl_reg_loss: 192019.2096; train_edge_recon_loss: 1136682.7740; train_gene_expr_recon_loss: 40960313.0000; train_masked_gp_l1_reg_loss: 15236.2386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52252.4955; train_global_loss: 42356503.5385; train_optim_loss: 42356503.5385; val_kl_reg_loss: 234202.3559; val_edge_recon_loss: 1185951.5104; val_gene_expr_recon_loss: 27000577.6667; val_masked_gp_l1_reg_loss: 15348.9980; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43523.5547; val_global_loss: 28479603.4444; val_optim_loss: 28479603.4444
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8730; val_auprc_score: 0.9741; val_best_acc_score: 0.8677; val_best_f1_score: 0.9280; train_kl_reg_loss: 201824.5009; train_edge_recon_loss: 1155368.1919; train_gene_expr_recon_loss: 23856887.5385; train_masked_gp_l1_reg_loss: 15124.8541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39109.1932; train_global_loss: 25268314.2692; train_optim_loss: 25268314.2692; val_kl_reg_loss: 169188.1788; val_edge_recon_loss: 1173927.7708; val_gene_expr_recon_loss: 22634466.4444; val_masked_gp_l1_reg_loss: 14890.8701; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36723.1562; val_global_loss: 24029196.3333; val_optim_loss: 24029196.3333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8552; val_auprc_score: 0.9683; val_best_acc_score: 0.8781; val_best_f1_score: 0.9323; train_kl_reg_loss: 156890.3730; train_edge_recon_loss: 1124127.8710; train_gene_expr_recon_loss: 22410468.1410; train_masked_gp_l1_reg_loss: 14815.2318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36612.9847; train_global_loss: 23742914.6026; train_optim_loss: 23742914.6026; val_kl_reg_loss: 132899.3385; val_edge_recon_loss: 1197239.3264; val_gene_expr_recon_loss: 22015556.8889; val_masked_gp_l1_reg_loss: 14745.8184; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36501.6484; val_global_loss: 23396943.7778; val_optim_loss: 23396943.7778
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8627; val_auprc_score: 0.9689; val_best_acc_score: 0.8899; val_best_f1_score: 0.9390; train_kl_reg_loss: 133647.2143; train_edge_recon_loss: 1112544.9559; train_gene_expr_recon_loss: 21739392.1667; train_masked_gp_l1_reg_loss: 14739.1926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36439.1641; train_global_loss: 23036762.7308; train_optim_loss: 23036762.7308; val_kl_reg_loss: 125977.4019; val_edge_recon_loss: 1174065.2639; val_gene_expr_recon_loss: 21485802.4444; val_masked_gp_l1_reg_loss: 14779.0293; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36377.0117; val_global_loss: 22837003.0000; val_optim_loss: 22837003.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8787; val_auprc_score: 0.9715; val_best_acc_score: 0.9020; val_best_f1_score: 0.9443; train_kl_reg_loss: 118435.7492; train_edge_recon_loss: 1092035.5020; train_gene_expr_recon_loss: 21264595.4615; train_masked_gp_l1_reg_loss: 14936.4366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36315.4764; train_global_loss: 22526318.6923; train_optim_loss: 22526318.6923; val_kl_reg_loss: 110686.1810; val_edge_recon_loss: 1133016.2500; val_gene_expr_recon_loss: 21041253.4444; val_masked_gp_l1_reg_loss: 15131.0342; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36251.3203; val_global_loss: 22336340.0000; val_optim_loss: 22336340.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8850; val_auprc_score: 0.9728; val_best_acc_score: 0.9052; val_best_f1_score: 0.9465; train_kl_reg_loss: 109819.1649; train_edge_recon_loss: 1056104.8842; train_gene_expr_recon_loss: 20842832.6795; train_masked_gp_l1_reg_loss: 15341.0607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36190.8336; train_global_loss: 22060288.5256; train_optim_loss: 22060288.5256; val_kl_reg_loss: 106527.9453; val_edge_recon_loss: 1063178.1319; val_gene_expr_recon_loss: 20627703.7778; val_masked_gp_l1_reg_loss: 15567.7246; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36132.4688; val_global_loss: 21849109.7778; val_optim_loss: 21849109.7778
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8872; val_auprc_score: 0.9728; val_best_acc_score: 0.9049; val_best_f1_score: 0.9459; train_kl_reg_loss: 109297.0072; train_edge_recon_loss: 1012700.0717; train_gene_expr_recon_loss: 20448082.8718; train_masked_gp_l1_reg_loss: 15786.0741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36082.3174; train_global_loss: 21621948.3590; train_optim_loss: 21621948.3590; val_kl_reg_loss: 105491.5621; val_edge_recon_loss: 1026540.1042; val_gene_expr_recon_loss: 20250132.5556; val_masked_gp_l1_reg_loss: 16005.3037; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36039.2891; val_global_loss: 21434210.0000; val_optim_loss: 21434210.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8943; val_auprc_score: 0.9743; val_best_acc_score: 0.9047; val_best_f1_score: 0.9458; train_kl_reg_loss: 108145.8312; train_edge_recon_loss: 986510.2264; train_gene_expr_recon_loss: 20066504.7949; train_masked_gp_l1_reg_loss: 16226.7000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36009.4538; train_global_loss: 21213396.9615; train_optim_loss: 21213396.9615; val_kl_reg_loss: 103782.5460; val_edge_recon_loss: 1011233.0521; val_gene_expr_recon_loss: 19877827.3333; val_masked_gp_l1_reg_loss: 16457.6309; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35975.7227; val_global_loss: 21045276.8889; val_optim_loss: 21045276.8889
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9026; val_auprc_score: 0.9773; val_best_acc_score: 0.9094; val_best_f1_score: 0.9486; train_kl_reg_loss: 103788.4319; train_edge_recon_loss: 966506.4519; train_gene_expr_recon_loss: 19719916.9487; train_masked_gp_l1_reg_loss: 16705.9673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35930.3231; train_global_loss: 20842848.1026; train_optim_loss: 20842848.1026; val_kl_reg_loss: 97629.5278; val_edge_recon_loss: 967799.7708; val_gene_expr_recon_loss: 19544256.3333; val_masked_gp_l1_reg_loss: 16980.7090; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35874.9688; val_global_loss: 20662539.5556; val_optim_loss: 20662539.5556
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9052; val_auprc_score: 0.9782; val_best_acc_score: 0.9104; val_best_f1_score: 0.9490; train_kl_reg_loss: 98634.4270; train_edge_recon_loss: 962708.7340; train_gene_expr_recon_loss: 19396413.7692; train_masked_gp_l1_reg_loss: 17238.8514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35809.0311; train_global_loss: 20510804.8205; train_optim_loss: 20510804.8205; val_kl_reg_loss: 94876.2127; val_edge_recon_loss: 951099.8021; val_gene_expr_recon_loss: 19249485.4444; val_masked_gp_l1_reg_loss: 17496.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35734.9766; val_global_loss: 20348691.4444; val_optim_loss: 20348691.4444
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9105; val_auprc_score: 0.9793; val_best_acc_score: 0.9140; val_best_f1_score: 0.9512; train_kl_reg_loss: 93823.7581; train_edge_recon_loss: 938702.6494; train_gene_expr_recon_loss: 19103832.7821; train_masked_gp_l1_reg_loss: 17737.5689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35652.6365; train_global_loss: 20189749.3974; train_optim_loss: 20189749.3974; val_kl_reg_loss: 90707.7795; val_edge_recon_loss: 945236.9722; val_gene_expr_recon_loss: 18973500.7778; val_masked_gp_l1_reg_loss: 17974.3574; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35563.8711; val_global_loss: 20062983.5556; val_optim_loss: 20062983.5556
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9211; val_auprc_score: 0.9826; val_best_acc_score: 0.9212; val_best_f1_score: 0.9550; train_kl_reg_loss: 91448.6229; train_edge_recon_loss: 922632.4038; train_gene_expr_recon_loss: 18842058.4231; train_masked_gp_l1_reg_loss: 18193.5108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35468.7165; train_global_loss: 19909801.7308; train_optim_loss: 19909801.7308; val_kl_reg_loss: 88860.1766; val_edge_recon_loss: 910451.3785; val_gene_expr_recon_loss: 18725072.5556; val_masked_gp_l1_reg_loss: 18407.4199; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35368.9062; val_global_loss: 19778160.2222; val_optim_loss: 19778160.2222
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9210; val_auprc_score: 0.9822; val_best_acc_score: 0.9275; val_best_f1_score: 0.9584; train_kl_reg_loss: 90311.3005; train_edge_recon_loss: 908422.6891; train_gene_expr_recon_loss: 18593070.5128; train_masked_gp_l1_reg_loss: 18640.4747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35263.8491; train_global_loss: 19645708.8974; train_optim_loss: 19645708.8974; val_kl_reg_loss: 85136.4336; val_edge_recon_loss: 900405.0208; val_gene_expr_recon_loss: 18522091.7778; val_masked_gp_l1_reg_loss: 19024.3066; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35155.0586; val_global_loss: 19561813.3333; val_optim_loss: 19561813.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9276; val_auprc_score: 0.9838; val_best_acc_score: 0.9340; val_best_f1_score: 0.9623; train_kl_reg_loss: 88212.1313; train_edge_recon_loss: 886008.8538; train_gene_expr_recon_loss: 17941633.2821; train_masked_gp_l1_reg_loss: 19382.8679; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35072.8576; train_global_loss: 18970309.8462; train_optim_loss: 18970309.8462; val_kl_reg_loss: 87804.0065; val_edge_recon_loss: 877751.3472; val_gene_expr_recon_loss: 17822946.8889; val_masked_gp_l1_reg_loss: 19551.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34962.4922; val_global_loss: 18843016.1111; val_optim_loss: 18843016.1111
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9338; val_auprc_score: 0.9855; val_best_acc_score: 0.9363; val_best_f1_score: 0.9636; train_kl_reg_loss: 87672.8654; train_edge_recon_loss: 884299.9223; train_gene_expr_recon_loss: 17707118.9872; train_masked_gp_l1_reg_loss: 19750.2817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34846.0309; train_global_loss: 18733688.0769; train_optim_loss: 18733688.0769; val_kl_reg_loss: 85236.0226; val_edge_recon_loss: 877817.9062; val_gene_expr_recon_loss: 17613044.0000; val_masked_gp_l1_reg_loss: 19966.7559; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34727.9648; val_global_loss: 18630791.7778; val_optim_loss: 18630791.7778
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9355; val_auprc_score: 0.9857; val_best_acc_score: 0.9374; val_best_f1_score: 0.9642; train_kl_reg_loss: 85206.3386; train_edge_recon_loss: 877495.2524; train_gene_expr_recon_loss: 17514609.6795; train_masked_gp_l1_reg_loss: 20186.8194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34608.4477; train_global_loss: 18532106.6154; train_optim_loss: 18532106.6154; val_kl_reg_loss: 82625.0686; val_edge_recon_loss: 876104.7500; val_gene_expr_recon_loss: 17426808.1111; val_masked_gp_l1_reg_loss: 20424.2793; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34485.5117; val_global_loss: 18440447.8889; val_optim_loss: 18440447.8889
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9392; val_auprc_score: 0.9867; val_best_acc_score: 0.9367; val_best_f1_score: 0.9639; train_kl_reg_loss: 82607.2319; train_edge_recon_loss: 873821.2981; train_gene_expr_recon_loss: 17334578.3333; train_masked_gp_l1_reg_loss: 20655.2066; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34357.8861; train_global_loss: 18346019.9487; train_optim_loss: 18346019.9487; val_kl_reg_loss: 79893.7426; val_edge_recon_loss: 876292.9201; val_gene_expr_recon_loss: 17254695.2222; val_masked_gp_l1_reg_loss: 20892.9902; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34224.5352; val_global_loss: 18265997.8889; val_optim_loss: 18265997.8889
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9433; val_auprc_score: 0.9875; val_best_acc_score: 0.9379; val_best_f1_score: 0.9646; train_kl_reg_loss: 79102.3473; train_edge_recon_loss: 865344.7252; train_gene_expr_recon_loss: 17164458.9359; train_masked_gp_l1_reg_loss: 21132.5984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34086.2854; train_global_loss: 18164124.8333; train_optim_loss: 18164124.8333; val_kl_reg_loss: 76391.9727; val_edge_recon_loss: 876508.8542; val_gene_expr_recon_loss: 17088637.7778; val_masked_gp_l1_reg_loss: 21384.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33941.5742; val_global_loss: 18096864.7778; val_optim_loss: 18096864.7778
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9449; val_auprc_score: 0.9880; val_best_acc_score: 0.9403; val_best_f1_score: 0.9659; train_kl_reg_loss: 76770.0329; train_edge_recon_loss: 857271.8233; train_gene_expr_recon_loss: 17006796.1026; train_masked_gp_l1_reg_loss: 21607.8273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33794.6030; train_global_loss: 17996240.4872; train_optim_loss: 17996240.4872; val_kl_reg_loss: 73897.8290; val_edge_recon_loss: 863431.5451; val_gene_expr_recon_loss: 16944297.4444; val_masked_gp_l1_reg_loss: 21852.9785; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33641.9844; val_global_loss: 17937120.8889; val_optim_loss: 17937120.8889
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9543; val_auprc_score: 0.9901; val_best_acc_score: 0.9434; val_best_f1_score: 0.9676; train_kl_reg_loss: 74102.6503; train_edge_recon_loss: 857590.1282; train_gene_expr_recon_loss: 16860661.5705; train_masked_gp_l1_reg_loss: 22080.3837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33485.5819; train_global_loss: 17847920.4872; train_optim_loss: 17847920.4872; val_kl_reg_loss: 71853.6398; val_edge_recon_loss: 858426.3542; val_gene_expr_recon_loss: 16792343.2222; val_masked_gp_l1_reg_loss: 22310.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33322.8945; val_global_loss: 17778255.1111; val_optim_loss: 17778255.1111
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9551; val_auprc_score: 0.9902; val_best_acc_score: 0.9452; val_best_f1_score: 0.9685; train_kl_reg_loss: 71997.8685; train_edge_recon_loss: 853722.0901; train_gene_expr_recon_loss: 16722365.0962; train_masked_gp_l1_reg_loss: 22548.8486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33160.4747; train_global_loss: 17703794.2949; train_optim_loss: 17703794.2949; val_kl_reg_loss: 69509.8008; val_edge_recon_loss: 845057.3924; val_gene_expr_recon_loss: 16666282.1667; val_masked_gp_l1_reg_loss: 22784.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32991.5273; val_global_loss: 17636625.3333; val_optim_loss: 17636625.3333
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9603; val_auprc_score: 0.9912; val_best_acc_score: 0.9481; val_best_f1_score: 0.9700; train_kl_reg_loss: 69753.0817; train_edge_recon_loss: 850312.4988; train_gene_expr_recon_loss: 16595992.7179; train_masked_gp_l1_reg_loss: 23014.4295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32820.2139; train_global_loss: 17571892.9872; train_optim_loss: 17571892.9872; val_kl_reg_loss: 66871.4779; val_edge_recon_loss: 857395.9931; val_gene_expr_recon_loss: 16539179.1111; val_masked_gp_l1_reg_loss: 23251.8965; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32646.6094; val_global_loss: 17519344.3333; val_optim_loss: 17519344.3333
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9657; val_auprc_score: 0.9928; val_best_acc_score: 0.9531; val_best_f1_score: 0.9729; train_kl_reg_loss: 67148.9928; train_edge_recon_loss: 842261.8858; train_gene_expr_recon_loss: 16476653.6154; train_masked_gp_l1_reg_loss: 23481.4658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32476.1042; train_global_loss: 17442022.0385; train_optim_loss: 17442022.0385; val_kl_reg_loss: 65357.9284; val_edge_recon_loss: 837152.9688; val_gene_expr_recon_loss: 16416331.8889; val_masked_gp_l1_reg_loss: 23709.3184; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32301.2598; val_global_loss: 17374855.0000; val_optim_loss: 17374855.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9641; val_auprc_score: 0.9923; val_best_acc_score: 0.9539; val_best_f1_score: 0.9734; train_kl_reg_loss: 65361.6709; train_edge_recon_loss: 838052.7308; train_gene_expr_recon_loss: 16361914.3590; train_masked_gp_l1_reg_loss: 23948.6108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32129.1343; train_global_loss: 17321406.5128; train_optim_loss: 17321406.5128; val_kl_reg_loss: 62907.8598; val_edge_recon_loss: 829868.4306; val_gene_expr_recon_loss: 16327248.6667; val_masked_gp_l1_reg_loss: 24167.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31954.7949; val_global_loss: 17276146.8889; val_optim_loss: 17276146.8889
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9672; val_auprc_score: 0.9922; val_best_acc_score: 0.9570; val_best_f1_score: 0.9751; train_kl_reg_loss: 63441.1389; train_edge_recon_loss: 832900.7885; train_gene_expr_recon_loss: 16256404.0962; train_masked_gp_l1_reg_loss: 24402.0641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31782.5838; train_global_loss: 17208930.5000; train_optim_loss: 17208930.5000; val_kl_reg_loss: 61532.7431; val_edge_recon_loss: 837891.4201; val_gene_expr_recon_loss: 16217147.0556; val_masked_gp_l1_reg_loss: 24629.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31607.6836; val_global_loss: 17172809.2222; val_optim_loss: 17172809.2222
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9352; val_auprc_score: 0.9857; val_best_acc_score: 0.9204; val_best_f1_score: 0.9545; train_kl_reg_loss: 15375.5048; train_edge_recon_loss: 1096094.7468; train_gene_expr_recon_loss: 28272373.6923; train_masked_gp_l1_reg_loss: 32813.6603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31257.6670; train_global_loss: 29447915.2308; train_optim_loss: 29447915.2308; val_kl_reg_loss: 7024.9030; val_edge_recon_loss: 1183883.1111; val_gene_expr_recon_loss: 20529019.0000; val_masked_gp_l1_reg_loss: 34247.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30880.2441; val_global_loss: 21785055.1111; val_optim_loss: 21785055.1111
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9088; val_auprc_score: 0.9799; val_best_acc_score: 0.9108; val_best_f1_score: 0.9491; train_kl_reg_loss: 10460.9542; train_edge_recon_loss: 1058911.0974; train_gene_expr_recon_loss: 19032151.9744; train_masked_gp_l1_reg_loss: 33769.0039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30498.2883; train_global_loss: 20165791.2692; train_optim_loss: 20165791.2692; val_kl_reg_loss: 9712.9980; val_edge_recon_loss: 1076006.2569; val_gene_expr_recon_loss: 18227975.4444; val_masked_gp_l1_reg_loss: 33188.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30107.1074; val_global_loss: 19376990.8889; val_optim_loss: 19376990.8889
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9015; val_auprc_score: 0.9770; val_best_acc_score: 0.9100; val_best_f1_score: 0.9487; train_kl_reg_loss: 12527.6088; train_edge_recon_loss: 1008088.7536; train_gene_expr_recon_loss: 17908371.7436; train_masked_gp_l1_reg_loss: 32772.3938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29712.8979; train_global_loss: 18991473.4487; train_optim_loss: 18991473.4487; val_kl_reg_loss: 9358.6010; val_edge_recon_loss: 1019999.5764; val_gene_expr_recon_loss: 17691729.4444; val_masked_gp_l1_reg_loss: 32490.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29309.4141; val_global_loss: 18782887.4444; val_optim_loss: 18782887.4444
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8935; val_auprc_score: 0.9761; val_best_acc_score: 0.9064; val_best_f1_score: 0.9471; train_kl_reg_loss: 12837.5781; train_edge_recon_loss: 970932.6759; train_gene_expr_recon_loss: 17544775.5128; train_masked_gp_l1_reg_loss: 32171.4111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28902.6156; train_global_loss: 18589619.7692; train_optim_loss: 18589619.7692; val_kl_reg_loss: 10627.7881; val_edge_recon_loss: 964539.6181; val_gene_expr_recon_loss: 17441557.5556; val_masked_gp_l1_reg_loss: 31860.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28486.7188; val_global_loss: 18477070.6667; val_optim_loss: 18477070.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8931; val_auprc_score: 0.9753; val_best_acc_score: 0.9053; val_best_f1_score: 0.9462; train_kl_reg_loss: 13253.9156; train_edge_recon_loss: 952001.6242; train_gene_expr_recon_loss: 17421009.1923; train_masked_gp_l1_reg_loss: 31802.5844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28425.7958; train_global_loss: 18446493.0897; train_optim_loss: 18446493.0897; val_kl_reg_loss: 10767.3077; val_edge_recon_loss: 965958.7361; val_gene_expr_recon_loss: 17429635.7778; val_masked_gp_l1_reg_loss: 31763.7324; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28380.4922; val_global_loss: 18466505.7778; val_optim_loss: 18466505.7778
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8931; val_auprc_score: 0.9765; val_best_acc_score: 0.9055; val_best_f1_score: 0.9467; train_kl_reg_loss: 13314.8560; train_edge_recon_loss: 952133.3145; train_gene_expr_recon_loss: 17404485.8462; train_masked_gp_l1_reg_loss: 31729.6423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28334.8001; train_global_loss: 18429998.4744; train_optim_loss: 18429998.4744; val_kl_reg_loss: 10843.4173; val_edge_recon_loss: 948428.0660; val_gene_expr_recon_loss: 17421572.6667; val_masked_gp_l1_reg_loss: 31695.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28287.3867; val_global_loss: 18440828.1111; val_optim_loss: 18440828.1111
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8943; val_auprc_score: 0.9766; val_best_acc_score: 0.9061; val_best_f1_score: 0.9471; train_kl_reg_loss: 13344.4104; train_edge_recon_loss: 948895.3914; train_gene_expr_recon_loss: 17391691.8205; train_masked_gp_l1_reg_loss: 31661.6402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28238.2214; train_global_loss: 18413831.6154; train_optim_loss: 18413831.6154; val_kl_reg_loss: 10864.3005; val_edge_recon_loss: 936937.7431; val_gene_expr_recon_loss: 17409659.1111; val_masked_gp_l1_reg_loss: 31626.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28187.2109; val_global_loss: 18417275.0000; val_optim_loss: 18417275.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8881; val_auprc_score: 0.9752; val_best_acc_score: 0.9029; val_best_f1_score: 0.9451; train_kl_reg_loss: 13345.8563; train_edge_recon_loss: 942975.6995; train_gene_expr_recon_loss: 17369747.1026; train_masked_gp_l1_reg_loss: 31593.1310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28134.4773; train_global_loss: 18385796.3462; train_optim_loss: 18385796.3462; val_kl_reg_loss: 10850.5298; val_edge_recon_loss: 945424.4549; val_gene_expr_recon_loss: 17382487.5556; val_masked_gp_l1_reg_loss: 31556.2402; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28079.7539; val_global_loss: 18398398.3333; val_optim_loss: 18398398.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 92 min 9 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9678
val AUPRC score: 0.9929
val best accuracy score: 0.9567
val best F1 score: 0.9750
val target rna MSE score: 21.0587
val source rna MSE score: 175.8525
Val cat covariate0 mean sim diff: -0.0029

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
