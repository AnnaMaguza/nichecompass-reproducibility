[True]
Run timestamp: 07092023_001249_216.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_216']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3385 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7888, n_cat_covariates_embed_input: 0, n_hidden: 2436, n_latent: 2336, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4503
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3385
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2336, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3385

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6386; val_auprc_score: 0.6310; val_best_acc_score: 0.5027; val_best_f1_score: 0.6679; train_kl_reg_loss: 64101.2792; train_edge_recon_loss: 3568625.5909; train_gene_expr_recon_loss: 16929184.9242; train_masked_gp_l1_reg_loss: 48885.3453; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9887647.4508; train_chrom_access_recon_loss: 8947520.3485; train_global_loss: 39445964.9394; train_optim_loss: 39445964.9394; val_kl_reg_loss: 93373.5176; val_edge_recon_loss: 4065561.8750; val_gene_expr_recon_loss: 15364397.7500; val_masked_gp_l1_reg_loss: 46218.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3494413.5000; val_chrom_access_recon_loss: 8608711.5000; val_global_loss: 31672676.7500; val_optim_loss: 31672676.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6967; val_auprc_score: 0.6886; val_best_acc_score: 0.5379; val_best_f1_score: 0.6791; train_kl_reg_loss: 127350.0734; train_edge_recon_loss: 3548086.0492; train_gene_expr_recon_loss: 14957158.1818; train_masked_gp_l1_reg_loss: 42257.9068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1267470.0118; train_chrom_access_recon_loss: 8504725.8106; train_global_loss: 28447047.9394; train_optim_loss: 28447047.9394; val_kl_reg_loss: 130633.4531; val_edge_recon_loss: 4062481.4062; val_gene_expr_recon_loss: 14786762.6250; val_masked_gp_l1_reg_loss: 39924.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 406777.5938; val_chrom_access_recon_loss: 8508447.3750; val_global_loss: 27935026.7500; val_optim_loss: 27935026.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7775; val_auprc_score: 0.7666; val_best_acc_score: 0.6112; val_best_f1_score: 0.7130; train_kl_reg_loss: 122003.6771; train_edge_recon_loss: 3535029.6818; train_gene_expr_recon_loss: 14696410.8939; train_masked_gp_l1_reg_loss: 39707.6779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 304750.9231; train_chrom_access_recon_loss: 8433900.2348; train_global_loss: 27131803.1212; train_optim_loss: 27131803.1212; val_kl_reg_loss: 104703.1963; val_edge_recon_loss: 4059049.7812; val_gene_expr_recon_loss: 14546030.2500; val_masked_gp_l1_reg_loss: 40007.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 245997.4688; val_chrom_access_recon_loss: 8479799.2500; val_global_loss: 27475588.5000; val_optim_loss: 27475588.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8212; val_auprc_score: 0.8060; val_best_acc_score: 0.7474; val_best_f1_score: 0.7577; train_kl_reg_loss: 110590.9013; train_edge_recon_loss: 3525556.4394; train_gene_expr_recon_loss: 14544981.8636; train_masked_gp_l1_reg_loss: 40558.9593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 217019.6937; train_chrom_access_recon_loss: 8369598.1818; train_global_loss: 26808305.9394; train_optim_loss: 26808305.9394; val_kl_reg_loss: 109095.1865; val_edge_recon_loss: 4035716.6250; val_gene_expr_recon_loss: 14476181.6250; val_masked_gp_l1_reg_loss: 41311.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 196521.9375; val_chrom_access_recon_loss: 8336051.1250; val_global_loss: 27194878.7500; val_optim_loss: 27194878.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8476; val_auprc_score: 0.8228; val_best_acc_score: 0.7663; val_best_f1_score: 0.7828; train_kl_reg_loss: 99146.1083; train_edge_recon_loss: 3509165.0379; train_gene_expr_recon_loss: 14449296.3939; train_masked_gp_l1_reg_loss: 42514.0317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 185611.3132; train_chrom_access_recon_loss: 8314389.0758; train_global_loss: 26600121.8182; train_optim_loss: 26600121.8182; val_kl_reg_loss: 86335.9248; val_edge_recon_loss: 3860799.5625; val_gene_expr_recon_loss: 14508219.5000; val_masked_gp_l1_reg_loss: 43791.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175739.8438; val_chrom_access_recon_loss: 8357062.9375; val_global_loss: 27031949.7500; val_optim_loss: 27031949.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8416; val_auprc_score: 0.8091; val_best_acc_score: 0.7630; val_best_f1_score: 0.7955; train_kl_reg_loss: 83652.6435; train_edge_recon_loss: 3310368.4318; train_gene_expr_recon_loss: 14380794.3030; train_masked_gp_l1_reg_loss: 45502.8948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 169142.7467; train_chrom_access_recon_loss: 8269186.5152; train_global_loss: 26258647.5152; train_optim_loss: 26258647.5152; val_kl_reg_loss: 98881.0674; val_edge_recon_loss: 3092497.5625; val_gene_expr_recon_loss: 14414587.6250; val_masked_gp_l1_reg_loss: 47419.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 164399.8438; val_chrom_access_recon_loss: 8338147.4375; val_global_loss: 26155934.0000; val_optim_loss: 26155934.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8497; val_auprc_score: 0.8187; val_best_acc_score: 0.7620; val_best_f1_score: 0.7965; train_kl_reg_loss: 115043.4922; train_edge_recon_loss: 3024601.0227; train_gene_expr_recon_loss: 14305933.3333; train_masked_gp_l1_reg_loss: 48592.8688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158705.9498; train_chrom_access_recon_loss: 8222058.2121; train_global_loss: 25874935.1212; train_optim_loss: 25874935.1212; val_kl_reg_loss: 118227.5000; val_edge_recon_loss: 2982877.4375; val_gene_expr_recon_loss: 14188781.8750; val_masked_gp_l1_reg_loss: 49385.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154358.5000; val_chrom_access_recon_loss: 8255012.1250; val_global_loss: 25748642.5000; val_optim_loss: 25748642.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8625; val_auprc_score: 0.8323; val_best_acc_score: 0.7724; val_best_f1_score: 0.8022; train_kl_reg_loss: 119289.9575; train_edge_recon_loss: 2949672.1477; train_gene_expr_recon_loss: 14228843.6515; train_masked_gp_l1_reg_loss: 50224.4943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150360.4732; train_chrom_access_recon_loss: 8179983.2197; train_global_loss: 25678374.0303; train_optim_loss: 25678374.0303; val_kl_reg_loss: 117000.7109; val_edge_recon_loss: 2937372.0625; val_gene_expr_recon_loss: 14316161.8750; val_masked_gp_l1_reg_loss: 51107.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 146201.9375; val_chrom_access_recon_loss: 8262951.6875; val_global_loss: 25830796.7500; val_optim_loss: 25830796.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8769; val_auprc_score: 0.8396; val_best_acc_score: 0.8009; val_best_f1_score: 0.8235; train_kl_reg_loss: 116818.5393; train_edge_recon_loss: 2929596.5758; train_gene_expr_recon_loss: 14150651.4242; train_masked_gp_l1_reg_loss: 51993.2777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143756.7907; train_chrom_access_recon_loss: 8141394.1364; train_global_loss: 25534210.7879; train_optim_loss: 25534210.7879; val_kl_reg_loss: 104481.8838; val_edge_recon_loss: 2897412.5938; val_gene_expr_recon_loss: 14239382.6250; val_masked_gp_l1_reg_loss: 52835.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142180.4219; val_chrom_access_recon_loss: 8278642.5625; val_global_loss: 25714935.5000; val_optim_loss: 25714935.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8773; val_auprc_score: 0.8406; val_best_acc_score: 0.8098; val_best_f1_score: 0.8244; train_kl_reg_loss: 114113.2655; train_edge_recon_loss: 2900345.6742; train_gene_expr_recon_loss: 14113004.6970; train_masked_gp_l1_reg_loss: 53629.7740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139737.0144; train_chrom_access_recon_loss: 8112102.4924; train_global_loss: 25432933.0000; train_optim_loss: 25432933.0000; val_kl_reg_loss: 108559.1016; val_edge_recon_loss: 2923410.9688; val_gene_expr_recon_loss: 14129392.6250; val_masked_gp_l1_reg_loss: 54410.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138182.0000; val_chrom_access_recon_loss: 8139176.6250; val_global_loss: 25493130.7500; val_optim_loss: 25493130.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8915; val_auprc_score: 0.8602; val_best_acc_score: 0.8251; val_best_f1_score: 0.8360; train_kl_reg_loss: 115781.4478; train_edge_recon_loss: 2857134.9129; train_gene_expr_recon_loss: 14051991.9242; train_masked_gp_l1_reg_loss: 55190.6386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 136208.0514; train_chrom_access_recon_loss: 8073094.0985; train_global_loss: 25289401.1212; train_optim_loss: 25289401.1212; val_kl_reg_loss: 111425.6914; val_edge_recon_loss: 2880173.8438; val_gene_expr_recon_loss: 14163166.6250; val_masked_gp_l1_reg_loss: 55924.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135211.5625; val_chrom_access_recon_loss: 8180913.2500; val_global_loss: 25526815.7500; val_optim_loss: 25526815.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8979; val_auprc_score: 0.8700; val_best_acc_score: 0.8307; val_best_f1_score: 0.8403; train_kl_reg_loss: 115785.9966; train_edge_recon_loss: 2847532.8258; train_gene_expr_recon_loss: 14001659.2273; train_masked_gp_l1_reg_loss: 56615.8602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134625.6795; train_chrom_access_recon_loss: 8047378.8409; train_global_loss: 25203598.4848; train_optim_loss: 25203598.4848; val_kl_reg_loss: 112343.3018; val_edge_recon_loss: 2870224.1250; val_gene_expr_recon_loss: 13918916.3750; val_masked_gp_l1_reg_loss: 57191.6367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134321.5781; val_chrom_access_recon_loss: 8013215.3750; val_global_loss: 25106212.7500; val_optim_loss: 25106212.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9040; val_auprc_score: 0.8771; val_best_acc_score: 0.8369; val_best_f1_score: 0.8483; train_kl_reg_loss: 112197.7164; train_edge_recon_loss: 2839549.5189; train_gene_expr_recon_loss: 13957665.9394; train_masked_gp_l1_reg_loss: 57855.6867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133911.2820; train_chrom_access_recon_loss: 8019977.6136; train_global_loss: 25121157.7576; train_optim_loss: 25121157.7576; val_kl_reg_loss: 110846.2744; val_edge_recon_loss: 2904461.4375; val_gene_expr_recon_loss: 14005112.1250; val_masked_gp_l1_reg_loss: 58482.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133305.3438; val_chrom_access_recon_loss: 8093178.5000; val_global_loss: 25305386.7500; val_optim_loss: 25305386.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9106; val_auprc_score: 0.8816; val_best_acc_score: 0.8512; val_best_f1_score: 0.8614; train_kl_reg_loss: 112607.2098; train_edge_recon_loss: 2823632.7765; train_gene_expr_recon_loss: 13910182.3939; train_masked_gp_l1_reg_loss: 59047.3028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132826.5329; train_chrom_access_recon_loss: 7998408.8788; train_global_loss: 25036704.9091; train_optim_loss: 25036704.9091; val_kl_reg_loss: 113810.3828; val_edge_recon_loss: 2828922.1562; val_gene_expr_recon_loss: 13952919.2500; val_masked_gp_l1_reg_loss: 59639.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132362.7656; val_chrom_access_recon_loss: 8061208.2500; val_global_loss: 25148862.2500; val_optim_loss: 25148862.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9086; val_auprc_score: 0.8755; val_best_acc_score: 0.8514; val_best_f1_score: 0.8636; train_kl_reg_loss: 111630.9828; train_edge_recon_loss: 2811264.6212; train_gene_expr_recon_loss: 13870215.9848; train_masked_gp_l1_reg_loss: 60150.1096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131910.4519; train_chrom_access_recon_loss: 7973795.2197; train_global_loss: 24958967.3030; train_optim_loss: 24958967.3030; val_kl_reg_loss: 113028.7598; val_edge_recon_loss: 2829247.2812; val_gene_expr_recon_loss: 13826568.2500; val_masked_gp_l1_reg_loss: 60671.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132044.1719; val_chrom_access_recon_loss: 8104953.0625; val_global_loss: 25066513.0000; val_optim_loss: 25066513.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9171; val_auprc_score: 0.8876; val_best_acc_score: 0.8520; val_best_f1_score: 0.8639; train_kl_reg_loss: 109056.4902; train_edge_recon_loss: 2805716.0947; train_gene_expr_recon_loss: 13818906.5758; train_masked_gp_l1_reg_loss: 61239.8053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131831.9380; train_chrom_access_recon_loss: 7936653.9924; train_global_loss: 24863404.7576; train_optim_loss: 24863404.7576; val_kl_reg_loss: 106679.8486; val_edge_recon_loss: 2837803.3438; val_gene_expr_recon_loss: 13738253.6250; val_masked_gp_l1_reg_loss: 61791.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132126.1094; val_chrom_access_recon_loss: 7915910.8750; val_global_loss: 24792565.7500; val_optim_loss: 24792565.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9219; val_auprc_score: 0.8918; val_best_acc_score: 0.8638; val_best_f1_score: 0.8703; train_kl_reg_loss: 107636.9018; train_edge_recon_loss: 2793511.4280; train_gene_expr_recon_loss: 13786937.5758; train_masked_gp_l1_reg_loss: 62314.3091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131929.9538; train_chrom_access_recon_loss: 7917857.8712; train_global_loss: 24800188.0606; train_optim_loss: 24800188.0606; val_kl_reg_loss: 108973.9834; val_edge_recon_loss: 2809639.8750; val_gene_expr_recon_loss: 13840759.0000; val_masked_gp_l1_reg_loss: 62827.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131618.7344; val_chrom_access_recon_loss: 7958004.9375; val_global_loss: 24911824.2500; val_optim_loss: 24911824.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9225; val_auprc_score: 0.8920; val_best_acc_score: 0.8646; val_best_f1_score: 0.8735; train_kl_reg_loss: 109754.6557; train_edge_recon_loss: 2782841.3220; train_gene_expr_recon_loss: 13756531.8485; train_masked_gp_l1_reg_loss: 63204.4677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131515.0707; train_chrom_access_recon_loss: 7903818.6439; train_global_loss: 24747665.9091; train_optim_loss: 24747665.9091; val_kl_reg_loss: 110512.3457; val_edge_recon_loss: 2817381.0938; val_gene_expr_recon_loss: 13841039.6250; val_masked_gp_l1_reg_loss: 63630.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131654.4375; val_chrom_access_recon_loss: 7983739.5000; val_global_loss: 24947957.2500; val_optim_loss: 24947957.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9183; val_auprc_score: 0.8882; val_best_acc_score: 0.8576; val_best_f1_score: 0.8668; train_kl_reg_loss: 107405.4545; train_edge_recon_loss: 2776328.8030; train_gene_expr_recon_loss: 13710390.7727; train_masked_gp_l1_reg_loss: 64102.8382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131911.0900; train_chrom_access_recon_loss: 7870628.0379; train_global_loss: 24660767.0000; train_optim_loss: 24660767.0000; val_kl_reg_loss: 109416.3975; val_edge_recon_loss: 2820263.8438; val_gene_expr_recon_loss: 13692093.8750; val_masked_gp_l1_reg_loss: 64564.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131656.1094; val_chrom_access_recon_loss: 7880284.0625; val_global_loss: 24698278.7500; val_optim_loss: 24698278.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9215; val_auprc_score: 0.8950; val_best_acc_score: 0.8555; val_best_f1_score: 0.8655; train_kl_reg_loss: 106345.0111; train_edge_recon_loss: 2774329.9735; train_gene_expr_recon_loss: 13686846.9242; train_masked_gp_l1_reg_loss: 64889.2704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131559.0843; train_chrom_access_recon_loss: 7856910.1515; train_global_loss: 24620880.5152; train_optim_loss: 24620880.5152; val_kl_reg_loss: 109251.2354; val_edge_recon_loss: 2822634.3438; val_gene_expr_recon_loss: 13698090.8750; val_masked_gp_l1_reg_loss: 65306.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131687.2812; val_chrom_access_recon_loss: 7909270.4375; val_global_loss: 24736239.7500; val_optim_loss: 24736239.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9248; val_auprc_score: 0.8952; val_best_acc_score: 0.8667; val_best_f1_score: 0.8747; train_kl_reg_loss: 106179.4454; train_edge_recon_loss: 2779093.1098; train_gene_expr_recon_loss: 13657373.9242; train_masked_gp_l1_reg_loss: 65743.7350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131385.7615; train_chrom_access_recon_loss: 7835116.8561; train_global_loss: 24574892.8182; train_optim_loss: 24574892.8182; val_kl_reg_loss: 110622.0117; val_edge_recon_loss: 2795194.4375; val_gene_expr_recon_loss: 13607865.3750; val_masked_gp_l1_reg_loss: 66141.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131255.9844; val_chrom_access_recon_loss: 7920862.5000; val_global_loss: 24631942.0000; val_optim_loss: 24631942.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9288; val_auprc_score: 0.9016; val_best_acc_score: 0.8673; val_best_f1_score: 0.8745; train_kl_reg_loss: 105544.5836; train_edge_recon_loss: 2778635.5644; train_gene_expr_recon_loss: 13621768.7121; train_masked_gp_l1_reg_loss: 66467.9045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131682.1281; train_chrom_access_recon_loss: 7814225.9091; train_global_loss: 24518324.6364; train_optim_loss: 24518324.6364; val_kl_reg_loss: 104542.3926; val_edge_recon_loss: 2824733.1562; val_gene_expr_recon_loss: 13672442.0000; val_masked_gp_l1_reg_loss: 66952.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132423.7031; val_chrom_access_recon_loss: 7896201.6250; val_global_loss: 24697295.5000; val_optim_loss: 24697295.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9262; val_auprc_score: 0.8932; val_best_acc_score: 0.8726; val_best_f1_score: 0.8782; train_kl_reg_loss: 104540.0669; train_edge_recon_loss: 2757828.5189; train_gene_expr_recon_loss: 13594387.6818; train_masked_gp_l1_reg_loss: 67167.2440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132202.6030; train_chrom_access_recon_loss: 7793885.5606; train_global_loss: 24450011.8182; train_optim_loss: 24450011.8182; val_kl_reg_loss: 103310.4355; val_edge_recon_loss: 2794050.8750; val_gene_expr_recon_loss: 13597652.6250; val_masked_gp_l1_reg_loss: 67559.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132534.8438; val_chrom_access_recon_loss: 7868987.1875; val_global_loss: 24564095.2500; val_optim_loss: 24564095.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9347; val_auprc_score: 0.9040; val_best_acc_score: 0.8786; val_best_f1_score: 0.8851; train_kl_reg_loss: 102444.2563; train_edge_recon_loss: 2750738.9318; train_gene_expr_recon_loss: 13575444.3333; train_masked_gp_l1_reg_loss: 67875.2772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132593.8480; train_chrom_access_recon_loss: 7780666.7576; train_global_loss: 24409763.4848; train_optim_loss: 24409763.4848; val_kl_reg_loss: 101371.7871; val_edge_recon_loss: 2785854.6875; val_gene_expr_recon_loss: 13431003.2500; val_masked_gp_l1_reg_loss: 68242.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132868.0781; val_chrom_access_recon_loss: 7737143.3125; val_global_loss: 24256483.0000; val_optim_loss: 24256483.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9326; val_auprc_score: 0.9119; val_best_acc_score: 0.8670; val_best_f1_score: 0.8749; train_kl_reg_loss: 102807.4364; train_edge_recon_loss: 2753335.3598; train_gene_expr_recon_loss: 13544293.8030; train_masked_gp_l1_reg_loss: 68602.1767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133024.9337; train_chrom_access_recon_loss: 7764749.4848; train_global_loss: 24366813.0000; train_optim_loss: 24366813.0000; val_kl_reg_loss: 101227.2432; val_edge_recon_loss: 2808236.1875; val_gene_expr_recon_loss: 13500612.1250; val_masked_gp_l1_reg_loss: 68952.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133497.7344; val_chrom_access_recon_loss: 7770337.5000; val_global_loss: 24382864.2500; val_optim_loss: 24382864.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9405; val_auprc_score: 0.9239; val_best_acc_score: 0.8764; val_best_f1_score: 0.8829; train_kl_reg_loss: 117994.9695; train_edge_recon_loss: 2836495.3598; train_gene_expr_recon_loss: 12848900.4394; train_masked_gp_l1_reg_loss: 68326.0233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133686.9841; train_chrom_access_recon_loss: 7397581.1742; train_global_loss: 23402984.7576; train_optim_loss: 23402984.7576; val_kl_reg_loss: 50270.9844; val_edge_recon_loss: 2840319.4688; val_gene_expr_recon_loss: 12773758.5000; val_masked_gp_l1_reg_loss: 67589.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133054.3906; val_chrom_access_recon_loss: 7335059.4375; val_global_loss: 23200052.2500; val_optim_loss: 23200052.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9355; val_auprc_score: 0.9082; val_best_acc_score: 0.8810; val_best_f1_score: 0.8873; train_kl_reg_loss: 119918.2759; train_edge_recon_loss: 2796434.4167; train_gene_expr_recon_loss: 12591487.2273; train_masked_gp_l1_reg_loss: 67354.3317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131365.4004; train_chrom_access_recon_loss: 7207867.2576; train_global_loss: 22914427.0000; train_optim_loss: 22914427.0000; val_kl_reg_loss: 50819.8921; val_edge_recon_loss: 2808705.3750; val_gene_expr_recon_loss: 12461657.5000; val_masked_gp_l1_reg_loss: 67130.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130580.6250; val_chrom_access_recon_loss: 7212036.7500; val_global_loss: 22730930.7500; val_optim_loss: 22730930.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9377; val_auprc_score: 0.9128; val_best_acc_score: 0.8823; val_best_f1_score: 0.8892; train_kl_reg_loss: 113828.6937; train_edge_recon_loss: 2789575.7045; train_gene_expr_recon_loss: 12388808.5606; train_masked_gp_l1_reg_loss: 66889.3196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129865.4767; train_chrom_access_recon_loss: 7102932.8939; train_global_loss: 22591900.6667; train_optim_loss: 22591900.6667; val_kl_reg_loss: 50039.3940; val_edge_recon_loss: 2797384.5625; val_gene_expr_recon_loss: 12206035.3750; val_masked_gp_l1_reg_loss: 66625.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129679.4453; val_chrom_access_recon_loss: 7047783.9375; val_global_loss: 22297547.5000; val_optim_loss: 22297547.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9413; val_auprc_score: 0.9163; val_best_acc_score: 0.8850; val_best_f1_score: 0.8917; train_kl_reg_loss: 110864.9695; train_edge_recon_loss: 2777719.5152; train_gene_expr_recon_loss: 12209087.8333; train_masked_gp_l1_reg_loss: 66379.5503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129598.1428; train_chrom_access_recon_loss: 6993545.2348; train_global_loss: 22287195.1515; train_optim_loss: 22287195.1515; val_kl_reg_loss: 53848.7271; val_edge_recon_loss: 2793773.4062; val_gene_expr_recon_loss: 12114932.7500; val_masked_gp_l1_reg_loss: 66125.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129676.9531; val_chrom_access_recon_loss: 7057437.3125; val_global_loss: 22215795.5000; val_optim_loss: 22215795.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9271; val_auprc_score: 0.8967; val_best_acc_score: 0.8721; val_best_f1_score: 0.8813; train_kl_reg_loss: 109971.9457; train_edge_recon_loss: 2781962.2273; train_gene_expr_recon_loss: 11872975.2727; train_masked_gp_l1_reg_loss: 65942.2927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129752.3814; train_chrom_access_recon_loss: 6816172.7500; train_global_loss: 21776776.9091; train_optim_loss: 21776776.9091; val_kl_reg_loss: 47164.8613; val_edge_recon_loss: 2810058.9688; val_gene_expr_recon_loss: 11680340.5000; val_masked_gp_l1_reg_loss: 65647.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129380.0625; val_chrom_access_recon_loss: 6678933.5625; val_global_loss: 21411524.7500; val_optim_loss: 21411524.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9285; val_auprc_score: 0.9089; val_best_acc_score: 0.8649; val_best_f1_score: 0.8728; train_kl_reg_loss: 103327.4845; train_edge_recon_loss: 2768018.6250; train_gene_expr_recon_loss: 11581346.5000; train_masked_gp_l1_reg_loss: 65370.5936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130246.6422; train_chrom_access_recon_loss: 6636456.5909; train_global_loss: 21284766.4545; train_optim_loss: 21284766.4545; val_kl_reg_loss: 51047.3613; val_edge_recon_loss: 2828260.4688; val_gene_expr_recon_loss: 11620659.3750; val_masked_gp_l1_reg_loss: 65034.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130339.6016; val_chrom_access_recon_loss: 6662977.1875; val_global_loss: 21358319.0000; val_optim_loss: 21358319.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9291; val_auprc_score: 0.9046; val_best_acc_score: 0.8657; val_best_f1_score: 0.8762; train_kl_reg_loss: 102026.3441; train_edge_recon_loss: 2790068.8068; train_gene_expr_recon_loss: 11308443.1515; train_masked_gp_l1_reg_loss: 64677.7126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130160.0719; train_chrom_access_recon_loss: 6471292.7879; train_global_loss: 20866668.9394; train_optim_loss: 20866668.9394; val_kl_reg_loss: 33009.1575; val_edge_recon_loss: 2842641.5625; val_gene_expr_recon_loss: 10864541.7500; val_masked_gp_l1_reg_loss: 64372.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131694.1094; val_chrom_access_recon_loss: 6255029.3125; val_global_loss: 20191287.7500; val_optim_loss: 20191287.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9335; val_auprc_score: 0.9139; val_best_acc_score: 0.8759; val_best_f1_score: 0.8811; train_kl_reg_loss: 107898.2416; train_edge_recon_loss: 2809135.0530; train_gene_expr_recon_loss: 10325996.4394; train_masked_gp_l1_reg_loss: 63898.7451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132455.7037; train_chrom_access_recon_loss: 5885926.7273; train_global_loss: 19325310.9394; train_optim_loss: 19325310.9394; val_kl_reg_loss: 30067.3469; val_edge_recon_loss: 2825549.8750; val_gene_expr_recon_loss: 10201921.0000; val_masked_gp_l1_reg_loss: 63215.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132995.5156; val_chrom_access_recon_loss: 5812096.3750; val_global_loss: 19065845.5000; val_optim_loss: 19065845.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9315; val_auprc_score: 0.9105; val_best_acc_score: 0.8694; val_best_f1_score: 0.8769; train_kl_reg_loss: 100391.7430; train_edge_recon_loss: 2789394.2008; train_gene_expr_recon_loss: 9819873.1212; train_masked_gp_l1_reg_loss: 62383.0824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133937.6103; train_chrom_access_recon_loss: 5572878.5000; train_global_loss: 18478858.3030; train_optim_loss: 18478858.3030; val_kl_reg_loss: 33613.8774; val_edge_recon_loss: 2845717.0625; val_gene_expr_recon_loss: 9630949.5000; val_masked_gp_l1_reg_loss: 61374.4258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134165.1719; val_chrom_access_recon_loss: 5503047.9375; val_global_loss: 18208867.5000; val_optim_loss: 18208867.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9257; val_auprc_score: 0.8981; val_best_acc_score: 0.8675; val_best_f1_score: 0.8770; train_kl_reg_loss: 89488.1119; train_edge_recon_loss: 2757305.5265; train_gene_expr_recon_loss: 9295533.4545; train_masked_gp_l1_reg_loss: 60087.2557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133355.5012; train_chrom_access_recon_loss: 5237620.8864; train_global_loss: 17573390.6212; train_optim_loss: 17573390.6212; val_kl_reg_loss: 39113.6143; val_edge_recon_loss: 2820163.9688; val_gene_expr_recon_loss: 9075993.6250; val_masked_gp_l1_reg_loss: 58778.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131482.8125; val_chrom_access_recon_loss: 5115623.4375; val_global_loss: 17241156.5000; val_optim_loss: 17241156.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9271; val_auprc_score: 0.8969; val_best_acc_score: 0.8694; val_best_f1_score: 0.8777; train_kl_reg_loss: 80821.2693; train_edge_recon_loss: 2747021.2652; train_gene_expr_recon_loss: 9019269.4394; train_masked_gp_l1_reg_loss: 57585.0924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130473.4447; train_chrom_access_recon_loss: 5048918.8485; train_global_loss: 17084089.3485; train_optim_loss: 17084089.3485; val_kl_reg_loss: 43258.5171; val_edge_recon_loss: 2796251.2812; val_gene_expr_recon_loss: 8955382.5000; val_masked_gp_l1_reg_loss: 56359.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129915.4375; val_chrom_access_recon_loss: 5062089.4375; val_global_loss: 17043256.2500; val_optim_loss: 17043256.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9367; val_auprc_score: 0.9119; val_best_acc_score: 0.8799; val_best_f1_score: 0.8865; train_kl_reg_loss: 75854.1307; train_edge_recon_loss: 2736787.1326; train_gene_expr_recon_loss: 8859790.7424; train_masked_gp_l1_reg_loss: 55208.2915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129136.5749; train_chrom_access_recon_loss: 4931731.4773; train_global_loss: 16788508.4091; train_optim_loss: 16788508.4091; val_kl_reg_loss: 47153.2876; val_edge_recon_loss: 2748523.3125; val_gene_expr_recon_loss: 8761063.1250; val_masked_gp_l1_reg_loss: 54009.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128611.3906; val_chrom_access_recon_loss: 4878416.7500; val_global_loss: 16617777.6250; val_optim_loss: 16617777.6250
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9439; val_auprc_score: 0.9224; val_best_acc_score: 0.8893; val_best_f1_score: 0.8957; train_kl_reg_loss: 72006.9709; train_edge_recon_loss: 2728113.3864; train_gene_expr_recon_loss: 8649996.3333; train_masked_gp_l1_reg_loss: 52816.3849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127525.2972; train_chrom_access_recon_loss: 4784648.7955; train_global_loss: 16415107.2576; train_optim_loss: 16415107.2576; val_kl_reg_loss: 48297.2061; val_edge_recon_loss: 2741625.8750; val_gene_expr_recon_loss: 8694766.2500; val_masked_gp_l1_reg_loss: 51643.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127088.0703; val_chrom_access_recon_loss: 4833064.8750; val_global_loss: 16496486.1250; val_optim_loss: 16496486.1250
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9333; val_auprc_score: 0.8997; val_best_acc_score: 0.8783; val_best_f1_score: 0.8848; train_kl_reg_loss: 69123.9279; train_edge_recon_loss: 2730741.8030; train_gene_expr_recon_loss: 8618377.9697; train_masked_gp_l1_reg_loss: 50570.2079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126829.5909; train_chrom_access_recon_loss: 4763125.6288; train_global_loss: 16358769.1364; train_optim_loss: 16358769.1364; val_kl_reg_loss: 52215.7339; val_edge_recon_loss: 2769601.5625; val_gene_expr_recon_loss: 8528589.8125; val_masked_gp_l1_reg_loss: 49490.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126231.4297; val_chrom_access_recon_loss: 4691743.2500; val_global_loss: 16217871.2500; val_optim_loss: 16217871.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9430; val_auprc_score: 0.9168; val_best_acc_score: 0.8907; val_best_f1_score: 0.8963; train_kl_reg_loss: 69620.7326; train_edge_recon_loss: 2731681.9735; train_gene_expr_recon_loss: 8498357.2121; train_masked_gp_l1_reg_loss: 48485.0663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126048.6122; train_chrom_access_recon_loss: 4697806.0909; train_global_loss: 16171999.5303; train_optim_loss: 16171999.5303; val_kl_reg_loss: 55686.2212; val_edge_recon_loss: 2713751.9062; val_gene_expr_recon_loss: 8429096.1250; val_masked_gp_l1_reg_loss: 47444.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125973.8672; val_chrom_access_recon_loss: 4718184.0000; val_global_loss: 16090137.1250; val_optim_loss: 16090137.1250
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9451; val_auprc_score: 0.9257; val_best_acc_score: 0.8928; val_best_f1_score: 0.8969; train_kl_reg_loss: 65426.8062; train_edge_recon_loss: 2723191.4962; train_gene_expr_recon_loss: 8407840.8333; train_masked_gp_l1_reg_loss: 46494.3232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125818.4283; train_chrom_access_recon_loss: 4633078.4545; train_global_loss: 16001850.3333; train_optim_loss: 16001850.3333; val_kl_reg_loss: 52433.1221; val_edge_recon_loss: 2721898.4062; val_gene_expr_recon_loss: 8344967.6875; val_masked_gp_l1_reg_loss: 45533.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125896.5781; val_chrom_access_recon_loss: 4677812.8750; val_global_loss: 15968543.1250; val_optim_loss: 15968543.1250
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9409; val_auprc_score: 0.9151; val_best_acc_score: 0.8837; val_best_f1_score: 0.8902; train_kl_reg_loss: 66387.4732; train_edge_recon_loss: 2719294.6515; train_gene_expr_recon_loss: 8330175.2652; train_masked_gp_l1_reg_loss: 44612.2132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125640.4893; train_chrom_access_recon_loss: 4574708.1439; train_global_loss: 15860818.2121; train_optim_loss: 15860818.2121; val_kl_reg_loss: 55793.6396; val_edge_recon_loss: 2743013.0625; val_gene_expr_recon_loss: 8362336.3750; val_masked_gp_l1_reg_loss: 43687.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125383.0938; val_chrom_access_recon_loss: 4619354.0000; val_global_loss: 15949567.0000; val_optim_loss: 15949567.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9345; val_auprc_score: 0.9091; val_best_acc_score: 0.8751; val_best_f1_score: 0.8813; train_kl_reg_loss: 65987.9553; train_edge_recon_loss: 2715805.8258; train_gene_expr_recon_loss: 8323900.7500; train_masked_gp_l1_reg_loss: 42813.5646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125630.7683; train_chrom_access_recon_loss: 4571433.2652; train_global_loss: 15845572.1364; train_optim_loss: 15845572.1364; val_kl_reg_loss: 56408.6997; val_edge_recon_loss: 2770508.6562; val_gene_expr_recon_loss: 8352499.0625; val_masked_gp_l1_reg_loss: 41917.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125914.2188; val_chrom_access_recon_loss: 4614390.3125; val_global_loss: 15961638.7500; val_optim_loss: 15961638.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9372; val_auprc_score: 0.9122; val_best_acc_score: 0.8823; val_best_f1_score: 0.8898; train_kl_reg_loss: 63691.4174; train_edge_recon_loss: 2727975.7879; train_gene_expr_recon_loss: 8312996.0758; train_masked_gp_l1_reg_loss: 41106.3246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125614.7476; train_chrom_access_recon_loss: 4562868.7652; train_global_loss: 15834253.0758; train_optim_loss: 15834253.0758; val_kl_reg_loss: 55567.8394; val_edge_recon_loss: 2739470.8438; val_gene_expr_recon_loss: 8343434.1250; val_masked_gp_l1_reg_loss: 40289.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124953.3281; val_chrom_access_recon_loss: 4584989.8750; val_global_loss: 15888704.8750; val_optim_loss: 15888704.8750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9446; val_auprc_score: 0.9178; val_best_acc_score: 0.8944; val_best_f1_score: 0.9014; train_kl_reg_loss: 63510.1194; train_edge_recon_loss: 2719675.2879; train_gene_expr_recon_loss: 8240183.9621; train_masked_gp_l1_reg_loss: 39534.0619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125980.8783; train_chrom_access_recon_loss: 4514190.3712; train_global_loss: 15703074.6212; train_optim_loss: 15703074.6212; val_kl_reg_loss: 53607.7319; val_edge_recon_loss: 2717529.5000; val_gene_expr_recon_loss: 8162093.2500; val_masked_gp_l1_reg_loss: 38770.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125796.2500; val_chrom_access_recon_loss: 4504768.9375; val_global_loss: 15602565.6250; val_optim_loss: 15602565.6250
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9406; val_auprc_score: 0.9100; val_best_acc_score: 0.8855; val_best_f1_score: 0.8922; train_kl_reg_loss: 65291.9067; train_edge_recon_loss: 2714414.3788; train_gene_expr_recon_loss: 8213673.7727; train_masked_gp_l1_reg_loss: 38038.9827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126135.9421; train_chrom_access_recon_loss: 4496750.3939; train_global_loss: 15654305.4091; train_optim_loss: 15654305.4091; val_kl_reg_loss: 58238.2451; val_edge_recon_loss: 2732458.3438; val_gene_expr_recon_loss: 8222302.4375; val_masked_gp_l1_reg_loss: 37321.4883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126406.5703; val_chrom_access_recon_loss: 4514375.8125; val_global_loss: 15691102.8750; val_optim_loss: 15691102.8750
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9493; val_auprc_score: 0.9255; val_best_acc_score: 0.8976; val_best_f1_score: 0.9006; train_kl_reg_loss: 64497.3569; train_edge_recon_loss: 2705046.7614; train_gene_expr_recon_loss: 8162548.0682; train_masked_gp_l1_reg_loss: 36587.8285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126105.1210; train_chrom_access_recon_loss: 4477656.9773; train_global_loss: 15572442.1212; train_optim_loss: 15572442.1212; val_kl_reg_loss: 56732.2183; val_edge_recon_loss: 2717759.8125; val_gene_expr_recon_loss: 8234147.0625; val_masked_gp_l1_reg_loss: 35877.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126128.4609; val_chrom_access_recon_loss: 4534662.4375; val_global_loss: 15705307.5000; val_optim_loss: 15705307.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9418; val_auprc_score: 0.9202; val_best_acc_score: 0.8866; val_best_f1_score: 0.8938; train_kl_reg_loss: 62295.5767; train_edge_recon_loss: 2701929.4811; train_gene_expr_recon_loss: 8162206.4394; train_masked_gp_l1_reg_loss: 35242.0504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126519.3460; train_chrom_access_recon_loss: 4477647.1250; train_global_loss: 15565840.0152; train_optim_loss: 15565840.0152; val_kl_reg_loss: 54506.4937; val_edge_recon_loss: 2741573.9688; val_gene_expr_recon_loss: 8125696.0625; val_masked_gp_l1_reg_loss: 34613.3555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126773.9375; val_chrom_access_recon_loss: 4479700.1250; val_global_loss: 15562863.5000; val_optim_loss: 15562863.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9470; val_auprc_score: 0.9203; val_best_acc_score: 0.8982; val_best_f1_score: 0.9033; train_kl_reg_loss: 62862.4673; train_edge_recon_loss: 2703271.8068; train_gene_expr_recon_loss: 8093155.5909; train_masked_gp_l1_reg_loss: 34016.1602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126552.9218; train_chrom_access_recon_loss: 4432650.1364; train_global_loss: 15452509.0152; train_optim_loss: 15452509.0152; val_kl_reg_loss: 54964.8442; val_edge_recon_loss: 2712940.3125; val_gene_expr_recon_loss: 8089242.6875; val_masked_gp_l1_reg_loss: 33425.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126937.8750; val_chrom_access_recon_loss: 4514261.0000; val_global_loss: 15531773.1250; val_optim_loss: 15531773.1250
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9478; val_auprc_score: 0.9264; val_best_acc_score: 0.8923; val_best_f1_score: 0.8991; train_kl_reg_loss: 61671.8675; train_edge_recon_loss: 2705155.1591; train_gene_expr_recon_loss: 8077221.3106; train_masked_gp_l1_reg_loss: 32870.9700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126744.8514; train_chrom_access_recon_loss: 4424996.4318; train_global_loss: 15428660.5606; train_optim_loss: 15428660.5606; val_kl_reg_loss: 55384.6948; val_edge_recon_loss: 2729376.8438; val_gene_expr_recon_loss: 7958208.9375; val_masked_gp_l1_reg_loss: 32305.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125853.7891; val_chrom_access_recon_loss: 4392637.4688; val_global_loss: 15293767.8750; val_optim_loss: 15293767.8750
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9502; val_auprc_score: 0.9295; val_best_acc_score: 0.8944; val_best_f1_score: 0.9001; train_kl_reg_loss: 60697.0262; train_edge_recon_loss: 2693939.3523; train_gene_expr_recon_loss: 8073904.8030; train_masked_gp_l1_reg_loss: 31785.7204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126922.2354; train_chrom_access_recon_loss: 4425650.8712; train_global_loss: 15412900.0909; train_optim_loss: 15412900.0909; val_kl_reg_loss: 53263.5967; val_edge_recon_loss: 2724151.8438; val_gene_expr_recon_loss: 8049949.1250; val_masked_gp_l1_reg_loss: 31257.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127318.7188; val_chrom_access_recon_loss: 4434008.1250; val_global_loss: 15419948.6250; val_optim_loss: 15419948.6250
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9443; val_auprc_score: 0.9203; val_best_acc_score: 0.8893; val_best_f1_score: 0.8957; train_kl_reg_loss: 60787.9029; train_edge_recon_loss: 2698022.8258; train_gene_expr_recon_loss: 8063208.1742; train_masked_gp_l1_reg_loss: 30795.0900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127327.0279; train_chrom_access_recon_loss: 4420056.5455; train_global_loss: 15400197.6515; train_optim_loss: 15400197.6515; val_kl_reg_loss: 54795.9922; val_edge_recon_loss: 2730986.5938; val_gene_expr_recon_loss: 8041025.6875; val_masked_gp_l1_reg_loss: 30310.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127700.9375; val_chrom_access_recon_loss: 4381425.6875; val_global_loss: 15366245.1250; val_optim_loss: 15366245.1250
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9459; val_auprc_score: 0.9184; val_best_acc_score: 0.8960; val_best_f1_score: 0.9012; train_kl_reg_loss: 61117.3483; train_edge_recon_loss: 2714408.5265; train_gene_expr_recon_loss: 8049671.1515; train_masked_gp_l1_reg_loss: 29874.0990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127106.2202; train_chrom_access_recon_loss: 4410937.7386; train_global_loss: 15393115.2424; train_optim_loss: 15393115.2424; val_kl_reg_loss: 56718.2896; val_edge_recon_loss: 2741944.4062; val_gene_expr_recon_loss: 8158008.6875; val_masked_gp_l1_reg_loss: 29451.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127047.8203; val_chrom_access_recon_loss: 4458186.8125; val_global_loss: 15571358.0000; val_optim_loss: 15571358.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9469; val_auprc_score: 0.9207; val_best_acc_score: 0.8925; val_best_f1_score: 0.8979; train_kl_reg_loss: 60638.4469; train_edge_recon_loss: 2704751.4848; train_gene_expr_recon_loss: 8048470.8333; train_masked_gp_l1_reg_loss: 29050.9068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126926.1761; train_chrom_access_recon_loss: 4412306.6326; train_global_loss: 15382144.4545; train_optim_loss: 15382144.4545; val_kl_reg_loss: 55057.0200; val_edge_recon_loss: 2747224.8125; val_gene_expr_recon_loss: 8100217.5625; val_masked_gp_l1_reg_loss: 28645.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126752.8203; val_chrom_access_recon_loss: 4440749.5000; val_global_loss: 15498647.1250; val_optim_loss: 15498647.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9542; val_auprc_score: 0.9348; val_best_acc_score: 0.9057; val_best_f1_score: 0.9104; train_kl_reg_loss: 59859.8217; train_edge_recon_loss: 2699780.4470; train_gene_expr_recon_loss: 8048450.4242; train_masked_gp_l1_reg_loss: 28394.8844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97096.8875; train_chrom_access_recon_loss: 4412231.7955; train_global_loss: 15345814.3182; train_optim_loss: 15345814.3182; val_kl_reg_loss: 56048.6562; val_edge_recon_loss: 2669322.5000; val_gene_expr_recon_loss: 8100371.9375; val_masked_gp_l1_reg_loss: 28316.1621; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92167.0547; val_chrom_access_recon_loss: 4448923.4375; val_global_loss: 15395149.3750; val_optim_loss: 15395149.3750
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9535; val_auprc_score: 0.9317; val_best_acc_score: 0.9011; val_best_f1_score: 0.9055; train_kl_reg_loss: 60607.9183; train_edge_recon_loss: 2693822.6970; train_gene_expr_recon_loss: 8028786.9394; train_masked_gp_l1_reg_loss: 28274.7881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92035.6419; train_chrom_access_recon_loss: 4390941.0720; train_global_loss: 15294469.1667; train_optim_loss: 15294469.1667; val_kl_reg_loss: 56134.1597; val_edge_recon_loss: 2709181.5625; val_gene_expr_recon_loss: 8013070.6250; val_masked_gp_l1_reg_loss: 28234.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91931.8203; val_chrom_access_recon_loss: 4406161.0625; val_global_loss: 15304714.5000; val_optim_loss: 15304714.5000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9441; val_auprc_score: 0.9150; val_best_acc_score: 0.8907; val_best_f1_score: 0.8969; train_kl_reg_loss: 60705.8652; train_edge_recon_loss: 2692562.6250; train_gene_expr_recon_loss: 8017488.1439; train_masked_gp_l1_reg_loss: 28192.3490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91830.0153; train_chrom_access_recon_loss: 4384022.6553; train_global_loss: 15274801.6364; train_optim_loss: 15274801.6364; val_kl_reg_loss: 56911.8247; val_edge_recon_loss: 2763293.2812; val_gene_expr_recon_loss: 8082159.7500; val_masked_gp_l1_reg_loss: 28149.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91686.1250; val_chrom_access_recon_loss: 4431203.8125; val_global_loss: 15453404.3750; val_optim_loss: 15453404.3750
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9553; val_auprc_score: 0.9354; val_best_acc_score: 0.9060; val_best_f1_score: 0.9106; train_kl_reg_loss: 60656.7514; train_edge_recon_loss: 2688373.3674; train_gene_expr_recon_loss: 8020485.7197; train_masked_gp_l1_reg_loss: 28106.1420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91646.8052; train_chrom_access_recon_loss: 4386761.5455; train_global_loss: 15276030.2879; train_optim_loss: 15276030.2879; val_kl_reg_loss: 57094.2334; val_edge_recon_loss: 2676342.0938; val_gene_expr_recon_loss: 8024841.0000; val_masked_gp_l1_reg_loss: 28063.7461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91655.0156; val_chrom_access_recon_loss: 4450130.5625; val_global_loss: 15328127.1250; val_optim_loss: 15328127.1250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 43 sec.
Using best model state, which was in epoch 50.

--- MODEL EVALUATION ---
val AUROC score: 0.9478
val AUPRC score: 0.9263
val best accuracy score: 0.8931
val best F1 score: 0.8986
val target rna MSE score: 3.9968
val source rna MSE score: 1.8045
val target atac MSE score: 0.3515
val source atac MSE score: 0.0769
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
