[True]
Run timestamp: 10102023_093339_216.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_216']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6455; val_auprc_score: 0.6337; val_best_acc_score: 0.5073; val_best_f1_score: 0.6693; train_kl_reg_loss: 38290.3188; train_edge_recon_loss: 727920.8333; train_gene_expr_recon_loss: 23353506.8485; train_masked_gp_l1_reg_loss: 105364.5859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3324918.3750; train_chrom_access_recon_loss: 6983538.5227; train_global_loss: 34533539.4545; train_optim_loss: 34533539.4545; val_kl_reg_loss: 62309.3765; val_edge_recon_loss: 813019.9609; val_gene_expr_recon_loss: 21574909.5000; val_masked_gp_l1_reg_loss: 84692.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2256585.0000; val_chrom_access_recon_loss: 6665407.5625; val_global_loss: 31456922.5000; val_optim_loss: 31456922.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7085; val_auprc_score: 0.6977; val_best_acc_score: 0.5387; val_best_f1_score: 0.6797; train_kl_reg_loss: 80691.7792; train_edge_recon_loss: 742683.0530; train_gene_expr_recon_loss: 21250074.8485; train_masked_gp_l1_reg_loss: 77195.2384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1473136.3286; train_chrom_access_recon_loss: 6603596.0530; train_global_loss: 30227377.3030; train_optim_loss: 30227377.3030; val_kl_reg_loss: 80239.4531; val_edge_recon_loss: 812533.9141; val_gene_expr_recon_loss: 21242487.0000; val_masked_gp_l1_reg_loss: 73836.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 878001.1875; val_chrom_access_recon_loss: 6589511.7500; val_global_loss: 29676610.2500; val_optim_loss: 29676610.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8139; val_auprc_score: 0.7988; val_best_acc_score: 0.6953; val_best_f1_score: 0.7465; train_kl_reg_loss: 76890.7495; train_edge_recon_loss: 735300.3731; train_gene_expr_recon_loss: 21006309.0303; train_masked_gp_l1_reg_loss: 73041.6926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 606337.7098; train_chrom_access_recon_loss: 6549958.7424; train_global_loss: 29047838.4242; train_optim_loss: 29047838.4242; val_kl_reg_loss: 90457.9717; val_edge_recon_loss: 808484.0000; val_gene_expr_recon_loss: 21085434.5000; val_masked_gp_l1_reg_loss: 73373.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 414776.0625; val_chrom_access_recon_loss: 6528545.1250; val_global_loss: 29001071.5000; val_optim_loss: 29001071.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8479; val_auprc_score: 0.8308; val_best_acc_score: 0.7665; val_best_f1_score: 0.7472; train_kl_reg_loss: 70546.5672; train_edge_recon_loss: 729200.6742; train_gene_expr_recon_loss: 20825207.1515; train_masked_gp_l1_reg_loss: 74148.3614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 324930.7988; train_chrom_access_recon_loss: 6505402.7576; train_global_loss: 28529436.1818; train_optim_loss: 28529436.1818; val_kl_reg_loss: 63546.4438; val_edge_recon_loss: 796757.1094; val_gene_expr_recon_loss: 20772315.2500; val_masked_gp_l1_reg_loss: 75147.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 255714.2969; val_chrom_access_recon_loss: 6486065.8750; val_global_loss: 28449546.5000; val_optim_loss: 28449546.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8622; val_auprc_score: 0.8394; val_best_acc_score: 0.7832; val_best_f1_score: 0.7995; train_kl_reg_loss: 64744.7421; train_edge_recon_loss: 719941.6136; train_gene_expr_recon_loss: 20687063.5758; train_masked_gp_l1_reg_loss: 76312.8350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 216348.4979; train_chrom_access_recon_loss: 6468726.7500; train_global_loss: 28233138.1515; train_optim_loss: 28233138.1515; val_kl_reg_loss: 63546.9614; val_edge_recon_loss: 762763.4688; val_gene_expr_recon_loss: 20636831.0000; val_masked_gp_l1_reg_loss: 78006.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 185015.2969; val_chrom_access_recon_loss: 6391698.3125; val_global_loss: 28117861.2500; val_optim_loss: 28117861.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8631; val_auprc_score: 0.8272; val_best_acc_score: 0.7896; val_best_f1_score: 0.8103; train_kl_reg_loss: 62490.9992; train_edge_recon_loss: 693410.2320; train_gene_expr_recon_loss: 20559691.6364; train_masked_gp_l1_reg_loss: 79349.2138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163756.1451; train_chrom_access_recon_loss: 6432774.7803; train_global_loss: 27991473.0303; train_optim_loss: 27991473.0303; val_kl_reg_loss: 63972.0894; val_edge_recon_loss: 680157.6094; val_gene_expr_recon_loss: 20763553.5000; val_masked_gp_l1_reg_loss: 80749.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145252.2344; val_chrom_access_recon_loss: 6500783.6875; val_global_loss: 28234468.7500; val_optim_loss: 28234468.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8630; val_auprc_score: 0.8295; val_best_acc_score: 0.7910; val_best_f1_score: 0.8140; train_kl_reg_loss: 70621.0154; train_edge_recon_loss: 646933.9896; train_gene_expr_recon_loss: 20457198.2424; train_masked_gp_l1_reg_loss: 81863.7137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131812.1837; train_chrom_access_recon_loss: 6411902.2576; train_global_loss: 27800331.5455; train_optim_loss: 27800331.5455; val_kl_reg_loss: 75322.4521; val_edge_recon_loss: 639578.5859; val_gene_expr_recon_loss: 20637284.2500; val_masked_gp_l1_reg_loss: 83073.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120818.8125; val_chrom_access_recon_loss: 6445838.0625; val_global_loss: 28001915.2500; val_optim_loss: 28001915.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8787; val_auprc_score: 0.8415; val_best_acc_score: 0.8055; val_best_f1_score: 0.8280; train_kl_reg_loss: 73496.6551; train_edge_recon_loss: 630681.8722; train_gene_expr_recon_loss: 20361670.8788; train_masked_gp_l1_reg_loss: 83714.5147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112622.7893; train_chrom_access_recon_loss: 6376100.2879; train_global_loss: 27638287.1515; train_optim_loss: 27638287.1515; val_kl_reg_loss: 74282.5312; val_edge_recon_loss: 623765.7266; val_gene_expr_recon_loss: 20477105.0000; val_masked_gp_l1_reg_loss: 84664.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105766.0391; val_chrom_access_recon_loss: 6355447.6250; val_global_loss: 27721030.7500; val_optim_loss: 27721030.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8835; val_auprc_score: 0.8544; val_best_acc_score: 0.8082; val_best_f1_score: 0.8271; train_kl_reg_loss: 71916.0627; train_edge_recon_loss: 627154.9242; train_gene_expr_recon_loss: 20265700.1515; train_masked_gp_l1_reg_loss: 85336.9240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100373.0170; train_chrom_access_recon_loss: 6349558.3258; train_global_loss: 27500039.1212; train_optim_loss: 27500039.1212; val_kl_reg_loss: 70295.7119; val_edge_recon_loss: 626304.7656; val_gene_expr_recon_loss: 20511245.5000; val_masked_gp_l1_reg_loss: 86183.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96161.5156; val_chrom_access_recon_loss: 6360563.3750; val_global_loss: 27750755.5000; val_optim_loss: 27750755.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8763; val_auprc_score: 0.8435; val_best_acc_score: 0.7996; val_best_f1_score: 0.8240; train_kl_reg_loss: 70479.4399; train_edge_recon_loss: 620164.2775; train_gene_expr_recon_loss: 20207993.2727; train_masked_gp_l1_reg_loss: 86703.2346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92473.3693; train_chrom_access_recon_loss: 6330592.9242; train_global_loss: 27408406.5455; train_optim_loss: 27408406.5455; val_kl_reg_loss: 69933.7266; val_edge_recon_loss: 627064.6250; val_gene_expr_recon_loss: 20202433.7500; val_masked_gp_l1_reg_loss: 87317.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89142.1406; val_chrom_access_recon_loss: 6245096.0625; val_global_loss: 27320987.7500; val_optim_loss: 27320987.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8947; val_auprc_score: 0.8715; val_best_acc_score: 0.8130; val_best_f1_score: 0.8340; train_kl_reg_loss: 69812.7151; train_edge_recon_loss: 615239.7765; train_gene_expr_recon_loss: 20118955.6364; train_masked_gp_l1_reg_loss: 87918.8996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87692.0204; train_chrom_access_recon_loss: 6309200.4773; train_global_loss: 27288819.2727; train_optim_loss: 27288819.2727; val_kl_reg_loss: 68412.5166; val_edge_recon_loss: 616179.2891; val_gene_expr_recon_loss: 20293815.5000; val_masked_gp_l1_reg_loss: 88593.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86382.2109; val_chrom_access_recon_loss: 6298322.5000; val_global_loss: 27451706.2500; val_optim_loss: 27451706.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9002; val_auprc_score: 0.8764; val_best_acc_score: 0.8138; val_best_f1_score: 0.8332; train_kl_reg_loss: 68616.7602; train_edge_recon_loss: 613180.6752; train_gene_expr_recon_loss: 20053948.7273; train_masked_gp_l1_reg_loss: 88936.4626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84556.4759; train_chrom_access_recon_loss: 6287214.3939; train_global_loss: 27196453.6970; train_optim_loss: 27196453.6970; val_kl_reg_loss: 67999.8721; val_edge_recon_loss: 619970.1484; val_gene_expr_recon_loss: 20131151.2500; val_masked_gp_l1_reg_loss: 89946.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83436.1719; val_chrom_access_recon_loss: 6289790.4375; val_global_loss: 27282294.0000; val_optim_loss: 27282294.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8997; val_auprc_score: 0.8710; val_best_acc_score: 0.8189; val_best_f1_score: 0.8370; train_kl_reg_loss: 67857.3350; train_edge_recon_loss: 606259.3778; train_gene_expr_recon_loss: 19955245.8788; train_masked_gp_l1_reg_loss: 90119.8221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81837.1576; train_chrom_access_recon_loss: 6262841.2576; train_global_loss: 27064160.7879; train_optim_loss: 27064160.7879; val_kl_reg_loss: 66315.6558; val_edge_recon_loss: 611437.6094; val_gene_expr_recon_loss: 20050367.7500; val_masked_gp_l1_reg_loss: 90633.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81586.2891; val_chrom_access_recon_loss: 6290724.2500; val_global_loss: 27191065.0000; val_optim_loss: 27191065.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9089; val_auprc_score: 0.8850; val_best_acc_score: 0.8305; val_best_f1_score: 0.8424; train_kl_reg_loss: 66478.1995; train_edge_recon_loss: 608351.3030; train_gene_expr_recon_loss: 19903052.0606; train_masked_gp_l1_reg_loss: 90906.4909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79773.5095; train_chrom_access_recon_loss: 6242138.9394; train_global_loss: 26990700.4848; train_optim_loss: 26990700.4848; val_kl_reg_loss: 65650.8379; val_edge_recon_loss: 609901.8359; val_gene_expr_recon_loss: 19960502.5000; val_masked_gp_l1_reg_loss: 91575.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79493.4375; val_chrom_access_recon_loss: 6209424.7500; val_global_loss: 27016550.2500; val_optim_loss: 27016550.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9157; val_auprc_score: 0.8927; val_best_acc_score: 0.8391; val_best_f1_score: 0.8470; train_kl_reg_loss: 65847.8331; train_edge_recon_loss: 604478.2509; train_gene_expr_recon_loss: 19842087.8182; train_masked_gp_l1_reg_loss: 91864.0719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77808.2358; train_chrom_access_recon_loss: 6215761.3561; train_global_loss: 26897847.4848; train_optim_loss: 26897847.4848; val_kl_reg_loss: 65461.6694; val_edge_recon_loss: 609432.8984; val_gene_expr_recon_loss: 19784763.0000; val_masked_gp_l1_reg_loss: 92413.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76712.2031; val_chrom_access_recon_loss: 6152715.1250; val_global_loss: 26781498.5000; val_optim_loss: 26781498.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9226; val_auprc_score: 0.8997; val_best_acc_score: 0.8452; val_best_f1_score: 0.8559; train_kl_reg_loss: 65677.6268; train_edge_recon_loss: 600442.3646; train_gene_expr_recon_loss: 19809883.0909; train_masked_gp_l1_reg_loss: 92602.8459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75964.9169; train_chrom_access_recon_loss: 6209988.0985; train_global_loss: 26854558.8182; train_optim_loss: 26854558.8182; val_kl_reg_loss: 65792.8945; val_edge_recon_loss: 602648.2891; val_gene_expr_recon_loss: 19871338.7500; val_masked_gp_l1_reg_loss: 93066.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75611.4297; val_chrom_access_recon_loss: 6183986.8750; val_global_loss: 26892445.0000; val_optim_loss: 26892445.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9307; val_auprc_score: 0.9126; val_best_acc_score: 0.8587; val_best_f1_score: 0.8683; train_kl_reg_loss: 64829.7022; train_edge_recon_loss: 599238.8030; train_gene_expr_recon_loss: 19737602.7879; train_masked_gp_l1_reg_loss: 93425.3652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74822.4232; train_chrom_access_recon_loss: 6186004.4091; train_global_loss: 26755923.7576; train_optim_loss: 26755923.7576; val_kl_reg_loss: 64687.8496; val_edge_recon_loss: 599983.8516; val_gene_expr_recon_loss: 19874698.5000; val_masked_gp_l1_reg_loss: 93800.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74173.9219; val_chrom_access_recon_loss: 6181045.5000; val_global_loss: 26888389.7500; val_optim_loss: 26888389.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9322; val_auprc_score: 0.9122; val_best_acc_score: 0.8603; val_best_f1_score: 0.8686; train_kl_reg_loss: 64550.4393; train_edge_recon_loss: 596752.8305; train_gene_expr_recon_loss: 19677198.5455; train_masked_gp_l1_reg_loss: 94218.9827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73445.9536; train_chrom_access_recon_loss: 6165830.7197; train_global_loss: 26671997.3636; train_optim_loss: 26671997.3636; val_kl_reg_loss: 64902.6123; val_edge_recon_loss: 602583.0156; val_gene_expr_recon_loss: 19857133.5000; val_masked_gp_l1_reg_loss: 94759.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73474.7031; val_chrom_access_recon_loss: 6174267.9375; val_global_loss: 26867120.5000; val_optim_loss: 26867120.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9359; val_auprc_score: 0.9192; val_best_acc_score: 0.8705; val_best_f1_score: 0.8742; train_kl_reg_loss: 64306.0031; train_edge_recon_loss: 594435.8854; train_gene_expr_recon_loss: 19637621.9091; train_masked_gp_l1_reg_loss: 95056.8636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72792.6082; train_chrom_access_recon_loss: 6149846.7424; train_global_loss: 26614059.7273; train_optim_loss: 26614059.7273; val_kl_reg_loss: 64399.7896; val_edge_recon_loss: 602652.4766; val_gene_expr_recon_loss: 19851118.5000; val_masked_gp_l1_reg_loss: 95506.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72362.4531; val_chrom_access_recon_loss: 6225757.1875; val_global_loss: 26911796.2500; val_optim_loss: 26911796.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9375; val_auprc_score: 0.9216; val_best_acc_score: 0.8670; val_best_f1_score: 0.8734; train_kl_reg_loss: 63937.2640; train_edge_recon_loss: 595269.0076; train_gene_expr_recon_loss: 19579877.7576; train_masked_gp_l1_reg_loss: 92241.3184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58276.7214; train_chrom_access_recon_loss: 6127608.7500; train_global_loss: 26517210.6667; train_optim_loss: 26517210.6667; val_kl_reg_loss: 65121.9238; val_edge_recon_loss: 597215.1250; val_gene_expr_recon_loss: 19809638.0000; val_masked_gp_l1_reg_loss: 90792.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53627.2617; val_chrom_access_recon_loss: 6154595.1250; val_global_loss: 26770990.5000; val_optim_loss: 26770990.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9331; val_auprc_score: 0.9144; val_best_acc_score: 0.8595; val_best_f1_score: 0.8716; train_kl_reg_loss: 64650.6877; train_edge_recon_loss: 594291.1383; train_gene_expr_recon_loss: 19582348.3636; train_masked_gp_l1_reg_loss: 90537.8136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52934.9666; train_chrom_access_recon_loss: 6120002.7273; train_global_loss: 26504765.7273; train_optim_loss: 26504765.7273; val_kl_reg_loss: 65050.1953; val_edge_recon_loss: 603154.4219; val_gene_expr_recon_loss: 19695349.0000; val_masked_gp_l1_reg_loss: 90443.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52576.1914; val_chrom_access_recon_loss: 6167636.0625; val_global_loss: 26674209.5000; val_optim_loss: 26674209.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9330; val_auprc_score: 0.9135; val_best_acc_score: 0.8686; val_best_f1_score: 0.8742; train_kl_reg_loss: 65113.9804; train_edge_recon_loss: 592039.7235; train_gene_expr_recon_loss: 19560350.7576; train_masked_gp_l1_reg_loss: 90386.5743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52240.0073; train_chrom_access_recon_loss: 6113344.2803; train_global_loss: 26473475.3636; train_optim_loss: 26473475.3636; val_kl_reg_loss: 65593.3511; val_edge_recon_loss: 599659.2188; val_gene_expr_recon_loss: 19858583.0000; val_masked_gp_l1_reg_loss: 90346.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52040.9531; val_chrom_access_recon_loss: 6179469.8750; val_global_loss: 26845691.0000; val_optim_loss: 26845691.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9314; val_auprc_score: 0.9065; val_best_acc_score: 0.8641; val_best_f1_score: 0.8741; train_kl_reg_loss: 65431.7490; train_edge_recon_loss: 591360.6420; train_gene_expr_recon_loss: 19582654.9394; train_masked_gp_l1_reg_loss: 90340.3421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51782.7601; train_chrom_access_recon_loss: 6119549.9545; train_global_loss: 26501120.3939; train_optim_loss: 26501120.3939; val_kl_reg_loss: 65893.6299; val_edge_recon_loss: 595921.6875; val_gene_expr_recon_loss: 19769552.0000; val_masked_gp_l1_reg_loss: 90382.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51628.0469; val_chrom_access_recon_loss: 6134333.5625; val_global_loss: 26707711.0000; val_optim_loss: 26707711.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9363; val_auprc_score: 0.9184; val_best_acc_score: 0.8678; val_best_f1_score: 0.8768; train_kl_reg_loss: 65416.4165; train_edge_recon_loss: 591263.7737; train_gene_expr_recon_loss: 19563220.8182; train_masked_gp_l1_reg_loss: 90381.9714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51441.3963; train_chrom_access_recon_loss: 6110919.4318; train_global_loss: 26472643.7576; train_optim_loss: 26472643.7576; val_kl_reg_loss: 66191.4409; val_edge_recon_loss: 596399.1484; val_gene_expr_recon_loss: 19605823.5000; val_masked_gp_l1_reg_loss: 90427.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51294.5703; val_chrom_access_recon_loss: 6119035.7500; val_global_loss: 26529172.0000; val_optim_loss: 26529172.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9405; val_auprc_score: 0.9232; val_best_acc_score: 0.8745; val_best_f1_score: 0.8805; train_kl_reg_loss: 65682.8037; train_edge_recon_loss: 591677.9631; train_gene_expr_recon_loss: 19574038.3030; train_masked_gp_l1_reg_loss: 90422.0228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51092.5355; train_chrom_access_recon_loss: 6117183.4545; train_global_loss: 26490097.1515; train_optim_loss: 26490097.1515; val_kl_reg_loss: 66010.6445; val_edge_recon_loss: 593529.2031; val_gene_expr_recon_loss: 19842452.0000; val_masked_gp_l1_reg_loss: 90438.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50931.7656; val_chrom_access_recon_loss: 6172070.5000; val_global_loss: 26815432.5000; val_optim_loss: 26815432.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9376; val_auprc_score: 0.9226; val_best_acc_score: 0.8641; val_best_f1_score: 0.8730; train_kl_reg_loss: 63352.4682; train_edge_recon_loss: 689876.6771; train_gene_expr_recon_loss: 18848319.4545; train_masked_gp_l1_reg_loss: 90375.7637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50248.0732; train_chrom_access_recon_loss: 6200843.1742; train_global_loss: 25943015.4848; train_optim_loss: 25943015.4848; val_kl_reg_loss: 30255.8286; val_edge_recon_loss: 690126.5078; val_gene_expr_recon_loss: 19173201.0000; val_masked_gp_l1_reg_loss: 90406.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50313.9297; val_chrom_access_recon_loss: 6025210.0000; val_global_loss: 26059513.2500; val_optim_loss: 26059513.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9309; val_auprc_score: 0.9054; val_best_acc_score: 0.8665; val_best_f1_score: 0.8745; train_kl_reg_loss: 63828.1760; train_edge_recon_loss: 674823.2188; train_gene_expr_recon_loss: 18773724.3636; train_masked_gp_l1_reg_loss: 90383.5882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50423.9201; train_chrom_access_recon_loss: 5951960.1515; train_global_loss: 25605143.3333; train_optim_loss: 25605143.3333; val_kl_reg_loss: 30220.2568; val_edge_recon_loss: 677324.6172; val_gene_expr_recon_loss: 19039209.5000; val_masked_gp_l1_reg_loss: 90331.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50491.8633; val_chrom_access_recon_loss: 6004417.2500; val_global_loss: 25891995.5000; val_optim_loss: 25891995.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9285; val_auprc_score: 0.9096; val_best_acc_score: 0.8573; val_best_f1_score: 0.8647; train_kl_reg_loss: 62698.6433; train_edge_recon_loss: 666132.6449; train_gene_expr_recon_loss: 18765655.1818; train_masked_gp_l1_reg_loss: 90292.8493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50430.0022; train_chrom_access_recon_loss: 5933311.1136; train_global_loss: 25568520.4242; train_optim_loss: 25568520.4242; val_kl_reg_loss: 31235.0161; val_edge_recon_loss: 672210.5000; val_gene_expr_recon_loss: 18941438.0000; val_masked_gp_l1_reg_loss: 90217.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50269.2539; val_chrom_access_recon_loss: 5903252.1875; val_global_loss: 25688623.5000; val_optim_loss: 25688623.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9336; val_auprc_score: 0.9186; val_best_acc_score: 0.8667; val_best_f1_score: 0.8739; train_kl_reg_loss: 62267.1750; train_edge_recon_loss: 656509.2907; train_gene_expr_recon_loss: 18737317.6667; train_masked_gp_l1_reg_loss: 90161.5588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50112.7705; train_chrom_access_recon_loss: 5912856.2197; train_global_loss: 25509224.5758; train_optim_loss: 25509224.5758; val_kl_reg_loss: 32327.8557; val_edge_recon_loss: 658156.1953; val_gene_expr_recon_loss: 18959074.2500; val_masked_gp_l1_reg_loss: 90089.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49944.5156; val_chrom_access_recon_loss: 5942843.3750; val_global_loss: 25732435.5000; val_optim_loss: 25732435.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9371; val_auprc_score: 0.9246; val_best_acc_score: 0.8678; val_best_f1_score: 0.8743; train_kl_reg_loss: 61549.9127; train_edge_recon_loss: 648640.0928; train_gene_expr_recon_loss: 18754683.2424; train_masked_gp_l1_reg_loss: 90008.8733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49724.8724; train_chrom_access_recon_loss: 5914508.9545; train_global_loss: 25519115.8182; train_optim_loss: 25519115.8182; val_kl_reg_loss: 33146.7920; val_edge_recon_loss: 652073.0234; val_gene_expr_recon_loss: 18901822.2500; val_masked_gp_l1_reg_loss: 89932.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49505.2383; val_chrom_access_recon_loss: 5939627.3750; val_global_loss: 25666107.5000; val_optim_loss: 25666107.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9342; val_auprc_score: 0.9175; val_best_acc_score: 0.8651; val_best_f1_score: 0.8719; train_kl_reg_loss: 60865.2202; train_edge_recon_loss: 643010.3722; train_gene_expr_recon_loss: 18721211.4848; train_masked_gp_l1_reg_loss: 89865.0125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49315.5248; train_chrom_access_recon_loss: 5901045.9848; train_global_loss: 25465313.6970; train_optim_loss: 25465313.6970; val_kl_reg_loss: 34279.7217; val_edge_recon_loss: 643409.8203; val_gene_expr_recon_loss: 18870091.0000; val_masked_gp_l1_reg_loss: 89782.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49106.6172; val_chrom_access_recon_loss: 5910723.8125; val_global_loss: 25597392.0000; val_optim_loss: 25597392.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9314; val_auprc_score: 0.9079; val_best_acc_score: 0.8665; val_best_f1_score: 0.8735; train_kl_reg_loss: 60563.4636; train_edge_recon_loss: 637432.0085; train_gene_expr_recon_loss: 18717887.9091; train_masked_gp_l1_reg_loss: 89705.4353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48886.0333; train_chrom_access_recon_loss: 5895396.7727; train_global_loss: 25449871.4848; train_optim_loss: 25449871.4848; val_kl_reg_loss: 34575.1372; val_edge_recon_loss: 641833.5781; val_gene_expr_recon_loss: 18891732.0000; val_masked_gp_l1_reg_loss: 89630.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48674.8867; val_chrom_access_recon_loss: 5866286.0625; val_global_loss: 25572730.7500; val_optim_loss: 25572730.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9351; val_auprc_score: 0.9123; val_best_acc_score: 0.8686; val_best_f1_score: 0.8746; train_kl_reg_loss: 60414.0331; train_edge_recon_loss: 631909.7027; train_gene_expr_recon_loss: 18705953.1818; train_masked_gp_l1_reg_loss: 89563.7533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48468.9142; train_chrom_access_recon_loss: 5893137.2879; train_global_loss: 25429446.6667; train_optim_loss: 25429446.6667; val_kl_reg_loss: 36344.7988; val_edge_recon_loss: 633194.1875; val_gene_expr_recon_loss: 18612315.1250; val_masked_gp_l1_reg_loss: 89459.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48289.3438; val_chrom_access_recon_loss: 5777335.6250; val_global_loss: 25196940.0000; val_optim_loss: 25196940.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9336; val_auprc_score: 0.9126; val_best_acc_score: 0.8662; val_best_f1_score: 0.8738; train_kl_reg_loss: 59929.3761; train_edge_recon_loss: 626698.1155; train_gene_expr_recon_loss: 18697566.7576; train_masked_gp_l1_reg_loss: 89372.8600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48097.5346; train_chrom_access_recon_loss: 5887023.1667; train_global_loss: 25408687.7273; train_optim_loss: 25408687.7273; val_kl_reg_loss: 38212.7437; val_edge_recon_loss: 618193.3594; val_gene_expr_recon_loss: 18657821.5000; val_masked_gp_l1_reg_loss: 89280.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47921.0352; val_chrom_access_recon_loss: 5828576.1875; val_global_loss: 25280005.7500; val_optim_loss: 25280005.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9330; val_auprc_score: 0.9164; val_best_acc_score: 0.8649; val_best_f1_score: 0.8731; train_kl_reg_loss: 59791.9669; train_edge_recon_loss: 621976.4612; train_gene_expr_recon_loss: 18706812.6667; train_masked_gp_l1_reg_loss: 89188.1797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47741.1373; train_chrom_access_recon_loss: 5892993.9545; train_global_loss: 25418504.5758; train_optim_loss: 25418504.5758; val_kl_reg_loss: 40120.9160; val_edge_recon_loss: 624812.4141; val_gene_expr_recon_loss: 18929532.7500; val_masked_gp_l1_reg_loss: 89107.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47547.5195; val_chrom_access_recon_loss: 5958068.6875; val_global_loss: 25689191.2500; val_optim_loss: 25689191.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9284; val_auprc_score: 0.9119; val_best_acc_score: 0.8598; val_best_f1_score: 0.8687; train_kl_reg_loss: 59480.1430; train_edge_recon_loss: 617591.8381; train_gene_expr_recon_loss: 18688149.4848; train_masked_gp_l1_reg_loss: 89029.1368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47380.3114; train_chrom_access_recon_loss: 5886780.0985; train_global_loss: 25388411.1818; train_optim_loss: 25388411.1818; val_kl_reg_loss: 41991.6616; val_edge_recon_loss: 618750.1016; val_gene_expr_recon_loss: 18917377.5000; val_masked_gp_l1_reg_loss: 88920.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47219.3828; val_chrom_access_recon_loss: 5948973.6875; val_global_loss: 25663232.5000; val_optim_loss: 25663232.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9316; val_auprc_score: 0.9123; val_best_acc_score: 0.8632; val_best_f1_score: 0.8703; train_kl_reg_loss: 59479.2646; train_edge_recon_loss: 614683.2670; train_gene_expr_recon_loss: 18685166.3636; train_masked_gp_l1_reg_loss: 88836.6613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47069.8101; train_chrom_access_recon_loss: 5889784.5076; train_global_loss: 25385020.0000; train_optim_loss: 25385020.0000; val_kl_reg_loss: 43316.3613; val_edge_recon_loss: 611439.5234; val_gene_expr_recon_loss: 18830766.2500; val_masked_gp_l1_reg_loss: 88755.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46864.0234; val_chrom_access_recon_loss: 5855605.6875; val_global_loss: 25476747.5000; val_optim_loss: 25476747.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9330; val_auprc_score: 0.9166; val_best_acc_score: 0.8632; val_best_f1_score: 0.8705; train_kl_reg_loss: 59231.2280; train_edge_recon_loss: 613840.2472; train_gene_expr_recon_loss: 18683585.1212; train_masked_gp_l1_reg_loss: 88567.7854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46139.4222; train_chrom_access_recon_loss: 5884268.7273; train_global_loss: 25375632.8485; train_optim_loss: 25375632.8485; val_kl_reg_loss: 43446.7129; val_edge_recon_loss: 610744.8047; val_gene_expr_recon_loss: 18780772.5000; val_masked_gp_l1_reg_loss: 88467.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45957.1523; val_chrom_access_recon_loss: 5872694.6250; val_global_loss: 25442084.5000; val_optim_loss: 25442084.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9255; val_auprc_score: 0.9086; val_best_acc_score: 0.8592; val_best_f1_score: 0.8668; train_kl_reg_loss: 59169.9513; train_edge_recon_loss: 612195.1657; train_gene_expr_recon_loss: 18683173.0000; train_masked_gp_l1_reg_loss: 88426.2605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45909.3175; train_chrom_access_recon_loss: 5885859.3030; train_global_loss: 25374733.1818; train_optim_loss: 25374733.1818; val_kl_reg_loss: 43808.6040; val_edge_recon_loss: 617471.7031; val_gene_expr_recon_loss: 18859814.0000; val_masked_gp_l1_reg_loss: 88389.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45861.3867; val_chrom_access_recon_loss: 5874931.0625; val_global_loss: 25530277.7500; val_optim_loss: 25530277.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9296; val_auprc_score: 0.9123; val_best_acc_score: 0.8581; val_best_f1_score: 0.8664; train_kl_reg_loss: 59279.2479; train_edge_recon_loss: 611055.0426; train_gene_expr_recon_loss: 18676741.2727; train_masked_gp_l1_reg_loss: 88366.1378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45829.4856; train_chrom_access_recon_loss: 5887270.0758; train_global_loss: 25368541.3030; train_optim_loss: 25368541.3030; val_kl_reg_loss: 43985.1377; val_edge_recon_loss: 613871.0469; val_gene_expr_recon_loss: 18967702.2500; val_masked_gp_l1_reg_loss: 88343.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45790.2539; val_chrom_access_recon_loss: 5889928.6875; val_global_loss: 25649620.7500; val_optim_loss: 25649620.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9308; val_auprc_score: 0.9025; val_best_acc_score: 0.8654; val_best_f1_score: 0.8737; train_kl_reg_loss: 59376.9645; train_edge_recon_loss: 612174.8011; train_gene_expr_recon_loss: 18671872.4545; train_masked_gp_l1_reg_loss: 88325.8475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45764.1474; train_chrom_access_recon_loss: 5879065.9697; train_global_loss: 25356580.1818; train_optim_loss: 25356580.1818; val_kl_reg_loss: 44109.2295; val_edge_recon_loss: 602584.9297; val_gene_expr_recon_loss: 18735866.5000; val_masked_gp_l1_reg_loss: 88306.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45733.2969; val_chrom_access_recon_loss: 5847061.7500; val_global_loss: 25363662.5000; val_optim_loss: 25363662.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 13 min 39 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.9297
val AUPRC score: 0.9107
val best accuracy score: 0.8646
val best F1 score: 0.8716
val target rna MSE score: 1.3479
val source rna MSE score: 1.9037
val target atac MSE score: 0.3173
val source atac MSE score: 0.1368
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
