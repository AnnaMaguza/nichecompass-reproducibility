[True]
Run timestamp: 07092023_002703_221.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_221']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2363 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5088, n_cat_covariates_embed_input: 0, n_hidden: 2312, n_latent: 2212, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2363
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2363

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7702; val_auprc_score: 0.7946; val_best_acc_score: 0.5256; val_best_f1_score: 0.6763; train_kl_reg_loss: 67685.8193; train_edge_recon_loss: 3540656.5649; train_gene_expr_recon_loss: 12724268.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 672464.1801; train_chrom_access_recon_loss: 10617661.4427; train_global_loss: 27622736.3969; train_optim_loss: 27622736.3969; val_kl_reg_loss: 93710.7547; val_edge_recon_loss: 4063519.3167; val_gene_expr_recon_loss: 11956964.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 384481.6250; val_chrom_access_recon_loss: 10258374.3333; val_global_loss: 26757051.2000; val_optim_loss: 26757051.2000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8563; val_auprc_score: 0.8636; val_best_acc_score: 0.7774; val_best_f1_score: 0.7829; train_kl_reg_loss: 83783.3398; train_edge_recon_loss: 3511559.8893; train_gene_expr_recon_loss: 11804528.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 244213.0380; train_chrom_access_recon_loss: 10158407.2519; train_global_loss: 25802491.8931; train_optim_loss: 25802491.8931; val_kl_reg_loss: 77691.9094; val_edge_recon_loss: 4006778.7833; val_gene_expr_recon_loss: 11735977.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152883.9844; val_chrom_access_recon_loss: 10119777.0000; val_global_loss: 26093109.2000; val_optim_loss: 26093109.2000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8726; val_auprc_score: 0.8714; val_best_acc_score: 0.7634; val_best_f1_score: 0.7882; train_kl_reg_loss: 70788.4065; train_edge_recon_loss: 3231152.1660; train_gene_expr_recon_loss: 11610821.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115674.0651; train_chrom_access_recon_loss: 10015864.4733; train_global_loss: 25044300.3664; train_optim_loss: 25044300.3664; val_kl_reg_loss: 90345.1193; val_edge_recon_loss: 2990828.3000; val_gene_expr_recon_loss: 11571410.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87565.7812; val_chrom_access_recon_loss: 9990364.2000; val_global_loss: 24730513.7333; val_optim_loss: 24730513.7333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8956; val_auprc_score: 0.8836; val_best_acc_score: 0.7960; val_best_f1_score: 0.8150; train_kl_reg_loss: 90056.2408; train_edge_recon_loss: 2941794.1737; train_gene_expr_recon_loss: 11457159.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71662.3355; train_chrom_access_recon_loss: 9899048.2290; train_global_loss: 24459720.4733; train_optim_loss: 24459720.4733; val_kl_reg_loss: 83407.7995; val_edge_recon_loss: 2884844.3833; val_gene_expr_recon_loss: 11467311.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59434.3008; val_chrom_access_recon_loss: 9908551.0000; val_global_loss: 24403548.4000; val_optim_loss: 24403548.4000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9047; val_auprc_score: 0.8905; val_best_acc_score: 0.8259; val_best_f1_score: 0.8389; train_kl_reg_loss: 82146.8019; train_edge_recon_loss: 2895558.6832; train_gene_expr_recon_loss: 11335883.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51679.8665; train_chrom_access_recon_loss: 9802413.5725; train_global_loss: 24167682.7481; train_optim_loss: 24167682.7481; val_kl_reg_loss: 82244.6755; val_edge_recon_loss: 2875225.9333; val_gene_expr_recon_loss: 11351611.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45747.6562; val_chrom_access_recon_loss: 9836252.7333; val_global_loss: 24191082.5333; val_optim_loss: 24191082.5333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9245; val_auprc_score: 0.9104; val_best_acc_score: 0.8558; val_best_f1_score: 0.8658; train_kl_reg_loss: 79826.7733; train_edge_recon_loss: 2820911.9447; train_gene_expr_recon_loss: 11229185.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41752.6725; train_chrom_access_recon_loss: 9721187.2977; train_global_loss: 23892863.8779; train_optim_loss: 23892863.8779; val_kl_reg_loss: 83524.1401; val_edge_recon_loss: 2815595.7000; val_gene_expr_recon_loss: 11207656.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38783.8984; val_chrom_access_recon_loss: 9659341.3333; val_global_loss: 23804901.8667; val_optim_loss: 23804901.8667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9358; val_auprc_score: 0.9169; val_best_acc_score: 0.8747; val_best_f1_score: 0.8815; train_kl_reg_loss: 79443.3814; train_edge_recon_loss: 2778392.1279; train_gene_expr_recon_loss: 11135819.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37059.4237; train_chrom_access_recon_loss: 9643865.1527; train_global_loss: 23674579.4809; train_optim_loss: 23674579.4809; val_kl_reg_loss: 79336.9359; val_edge_recon_loss: 2764523.1833; val_gene_expr_recon_loss: 11143940.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35462.6328; val_chrom_access_recon_loss: 9616132.0000; val_global_loss: 23639395.3333; val_optim_loss: 23639395.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9456; val_auprc_score: 0.9338; val_best_acc_score: 0.8808; val_best_f1_score: 0.8873; train_kl_reg_loss: 79061.1162; train_edge_recon_loss: 2754231.9218; train_gene_expr_recon_loss: 11060013.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34667.0868; train_chrom_access_recon_loss: 9581890.7061; train_global_loss: 23509864.6565; train_optim_loss: 23509864.6565; val_kl_reg_loss: 79189.6667; val_edge_recon_loss: 2760479.0833; val_gene_expr_recon_loss: 11042298.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34187.4023; val_chrom_access_recon_loss: 9551075.6000; val_global_loss: 23467230.5333; val_optim_loss: 23467230.5333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9457; val_auprc_score: 0.9294; val_best_acc_score: 0.8895; val_best_f1_score: 0.8939; train_kl_reg_loss: 77470.8977; train_edge_recon_loss: 2740494.3378; train_gene_expr_recon_loss: 10981325.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33383.9932; train_chrom_access_recon_loss: 9521029.3511; train_global_loss: 23353704.3817; train_optim_loss: 23353704.3817; val_kl_reg_loss: 76336.9865; val_edge_recon_loss: 2741016.9000; val_gene_expr_recon_loss: 11016996.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32827.6445; val_chrom_access_recon_loss: 9544284.7333; val_global_loss: 23411462.6667; val_optim_loss: 23411462.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9488; val_auprc_score: 0.9363; val_best_acc_score: 0.8825; val_best_f1_score: 0.8899; train_kl_reg_loss: 74685.5976; train_edge_recon_loss: 2728761.0496; train_gene_expr_recon_loss: 10920353.4733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32339.8574; train_chrom_access_recon_loss: 9459514.8702; train_global_loss: 23215654.8244; train_optim_loss: 23215654.8244; val_kl_reg_loss: 72848.0214; val_edge_recon_loss: 2741279.2167; val_gene_expr_recon_loss: 10904522.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32170.1230; val_chrom_access_recon_loss: 9458589.5333; val_global_loss: 23209408.8000; val_optim_loss: 23209408.8000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9530; val_auprc_score: 0.9421; val_best_acc_score: 0.8938; val_best_f1_score: 0.8992; train_kl_reg_loss: 71591.5921; train_edge_recon_loss: 2721246.7576; train_gene_expr_recon_loss: 10856525.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31586.7449; train_chrom_access_recon_loss: 9407015.6183; train_global_loss: 23087966.3969; train_optim_loss: 23087966.3969; val_kl_reg_loss: 68968.3927; val_edge_recon_loss: 2728516.5167; val_gene_expr_recon_loss: 10865170.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31098.3613; val_chrom_access_recon_loss: 9393977.0000; val_global_loss: 23087730.5333; val_optim_loss: 23087730.5333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9567; val_auprc_score: 0.9450; val_best_acc_score: 0.8998; val_best_f1_score: 0.9041; train_kl_reg_loss: 69968.7045; train_edge_recon_loss: 2709320.6145; train_gene_expr_recon_loss: 10801268.1756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30919.6000; train_chrom_access_recon_loss: 9352750.7328; train_global_loss: 22964227.8015; train_optim_loss: 22964227.8015; val_kl_reg_loss: 66847.3216; val_edge_recon_loss: 2707999.6167; val_gene_expr_recon_loss: 10826031.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30575.9883; val_chrom_access_recon_loss: 9371908.6000; val_global_loss: 23003363.0667; val_optim_loss: 23003363.0667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9593; val_auprc_score: 0.9465; val_best_acc_score: 0.9020; val_best_f1_score: 0.9066; train_kl_reg_loss: 66152.5998; train_edge_recon_loss: 2712433.0630; train_gene_expr_recon_loss: 10753002.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30414.7545; train_chrom_access_recon_loss: 9314210.9084; train_global_loss: 22876214.1374; train_optim_loss: 22876214.1374; val_kl_reg_loss: 64685.4664; val_edge_recon_loss: 2719478.1167; val_gene_expr_recon_loss: 10799091.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30254.1016; val_chrom_access_recon_loss: 9320478.3333; val_global_loss: 22933987.0667; val_optim_loss: 22933987.0667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9597; val_auprc_score: 0.9503; val_best_acc_score: 0.9018; val_best_f1_score: 0.9054; train_kl_reg_loss: 65321.1869; train_edge_recon_loss: 2706225.4332; train_gene_expr_recon_loss: 10703806.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29978.6433; train_chrom_access_recon_loss: 9270080.9198; train_global_loss: 22775412.8092; train_optim_loss: 22775412.8092; val_kl_reg_loss: 63999.3638; val_edge_recon_loss: 2721345.5167; val_gene_expr_recon_loss: 10697728.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29729.6699; val_chrom_access_recon_loss: 9251360.0000; val_global_loss: 22764163.4667; val_optim_loss: 22764163.4667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9614; val_auprc_score: 0.9504; val_best_acc_score: 0.9050; val_best_f1_score: 0.9099; train_kl_reg_loss: 65319.7763; train_edge_recon_loss: 2700017.1775; train_gene_expr_recon_loss: 10666184.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29674.3021; train_chrom_access_recon_loss: 9230642.9084; train_global_loss: 22691839.1298; train_optim_loss: 22691839.1298; val_kl_reg_loss: 64179.2117; val_edge_recon_loss: 2709863.7333; val_gene_expr_recon_loss: 10678336.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29384.6152; val_chrom_access_recon_loss: 9194436.0667; val_global_loss: 22676200.0000; val_optim_loss: 22676200.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9656; val_auprc_score: 0.9557; val_best_acc_score: 0.9107; val_best_f1_score: 0.9140; train_kl_reg_loss: 63157.5410; train_edge_recon_loss: 2692022.6851; train_gene_expr_recon_loss: 10629097.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29467.9608; train_chrom_access_recon_loss: 9190591.1450; train_global_loss: 22604336.5954; train_optim_loss: 22604336.5954; val_kl_reg_loss: 63007.1633; val_edge_recon_loss: 2694755.8667; val_gene_expr_recon_loss: 10687849.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29525.1035; val_chrom_access_recon_loss: 9208631.2667; val_global_loss: 22683769.2000; val_optim_loss: 22683769.2000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9674; val_auprc_score: 0.9579; val_best_acc_score: 0.9150; val_best_f1_score: 0.9175; train_kl_reg_loss: 62532.2988; train_edge_recon_loss: 2683638.8092; train_gene_expr_recon_loss: 10603654.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29360.4616; train_chrom_access_recon_loss: 9165802.7901; train_global_loss: 22544988.9008; train_optim_loss: 22544988.9008; val_kl_reg_loss: 61091.0182; val_edge_recon_loss: 2693000.8167; val_gene_expr_recon_loss: 10647950.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29408.8203; val_chrom_access_recon_loss: 9170456.3333; val_global_loss: 22601907.8667; val_optim_loss: 22601907.8667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9709; val_auprc_score: 0.9641; val_best_acc_score: 0.9197; val_best_f1_score: 0.9229; train_kl_reg_loss: 60657.1949; train_edge_recon_loss: 2681164.1469; train_gene_expr_recon_loss: 10574225.0840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29293.5371; train_chrom_access_recon_loss: 9135099.0878; train_global_loss: 22480438.9466; train_optim_loss: 22480438.9466; val_kl_reg_loss: 58565.0456; val_edge_recon_loss: 2692379.2833; val_gene_expr_recon_loss: 10565253.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29127.0879; val_chrom_access_recon_loss: 9105714.9333; val_global_loss: 22451039.2000; val_optim_loss: 22451039.2000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9716; val_auprc_score: 0.9635; val_best_acc_score: 0.9200; val_best_f1_score: 0.9230; train_kl_reg_loss: 59402.6793; train_edge_recon_loss: 2679120.4962; train_gene_expr_recon_loss: 10542078.2595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29214.6253; train_chrom_access_recon_loss: 9106753.1221; train_global_loss: 22416569.2824; train_optim_loss: 22416569.2824; val_kl_reg_loss: 57590.4552; val_edge_recon_loss: 2692176.6500; val_gene_expr_recon_loss: 10562539.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29175.5547; val_chrom_access_recon_loss: 9109457.8667; val_global_loss: 22450940.4000; val_optim_loss: 22450940.4000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9738; val_auprc_score: 0.9672; val_best_acc_score: 0.9263; val_best_f1_score: 0.9282; train_kl_reg_loss: 58107.3602; train_edge_recon_loss: 2678881.5534; train_gene_expr_recon_loss: 10509594.6947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29150.2750; train_chrom_access_recon_loss: 9067888.1298; train_global_loss: 22343621.9695; train_optim_loss: 22343621.9695; val_kl_reg_loss: 58028.5107; val_edge_recon_loss: 2683069.9000; val_gene_expr_recon_loss: 10549225.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29172.8145; val_chrom_access_recon_loss: 9116750.5333; val_global_loss: 22436247.3333; val_optim_loss: 22436247.3333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9759; val_auprc_score: 0.9683; val_best_acc_score: 0.9290; val_best_f1_score: 0.9315; train_kl_reg_loss: 58059.3315; train_edge_recon_loss: 2666902.2672; train_gene_expr_recon_loss: 10486824.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29169.4957; train_chrom_access_recon_loss: 9050985.5840; train_global_loss: 22291941.1145; train_optim_loss: 22291941.1145; val_kl_reg_loss: 57490.3260; val_edge_recon_loss: 2667484.3333; val_gene_expr_recon_loss: 10555621.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29308.4219; val_chrom_access_recon_loss: 9099187.7667; val_global_loss: 22409091.6000; val_optim_loss: 22409091.6000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9752; val_auprc_score: 0.9694; val_best_acc_score: 0.9270; val_best_f1_score: 0.9296; train_kl_reg_loss: 57343.0842; train_edge_recon_loss: 2666936.6164; train_gene_expr_recon_loss: 10459896.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29287.4401; train_chrom_access_recon_loss: 9030367.5725; train_global_loss: 22243831.5725; train_optim_loss: 22243831.5725; val_kl_reg_loss: 55528.2568; val_edge_recon_loss: 2678258.3667; val_gene_expr_recon_loss: 10492891.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29230.4961; val_chrom_access_recon_loss: 9023929.2667; val_global_loss: 22279837.7333; val_optim_loss: 22279837.7333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9772; val_auprc_score: 0.9717; val_best_acc_score: 0.9298; val_best_f1_score: 0.9323; train_kl_reg_loss: 56544.1706; train_edge_recon_loss: 2666202.6126; train_gene_expr_recon_loss: 10448919.8779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29252.5310; train_chrom_access_recon_loss: 9014016.4198; train_global_loss: 22214935.5573; train_optim_loss: 22214935.5573; val_kl_reg_loss: 55297.8646; val_edge_recon_loss: 2677625.8333; val_gene_expr_recon_loss: 10484150.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29330.2891; val_chrom_access_recon_loss: 9048906.3333; val_global_loss: 22295310.2667; val_optim_loss: 22295310.2667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9778; val_auprc_score: 0.9707; val_best_acc_score: 0.9333; val_best_f1_score: 0.9358; train_kl_reg_loss: 55299.1297; train_edge_recon_loss: 2669234.1756; train_gene_expr_recon_loss: 10424283.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29374.6812; train_chrom_access_recon_loss: 8986210.6565; train_global_loss: 22164402.7023; train_optim_loss: 22164402.7023; val_kl_reg_loss: 54916.5159; val_edge_recon_loss: 2671368.3667; val_gene_expr_recon_loss: 10499961.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29223.4160; val_chrom_access_recon_loss: 9044175.8000; val_global_loss: 22299644.4000; val_optim_loss: 22299644.4000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9809; val_auprc_score: 0.9746; val_best_acc_score: 0.9415; val_best_f1_score: 0.9429; train_kl_reg_loss: 54700.2155; train_edge_recon_loss: 2668010.0363; train_gene_expr_recon_loss: 10404917.6565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29420.9942; train_chrom_access_recon_loss: 8959311.2939; train_global_loss: 22116360.3511; train_optim_loss: 22116360.3511; val_kl_reg_loss: 53161.2487; val_edge_recon_loss: 2667891.6667; val_gene_expr_recon_loss: 10427715.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29715.2578; val_chrom_access_recon_loss: 8968179.5667; val_global_loss: 22146662.6667; val_optim_loss: 22146662.6667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9801; val_auprc_score: 0.9734; val_best_acc_score: 0.9355; val_best_f1_score: 0.9376; train_kl_reg_loss: 53754.3541; train_edge_recon_loss: 2659892.2347; train_gene_expr_recon_loss: 10389610.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29565.6709; train_chrom_access_recon_loss: 8946317.4351; train_global_loss: 22079140.3206; train_optim_loss: 22079140.3206; val_kl_reg_loss: 53399.6388; val_edge_recon_loss: 2671245.5000; val_gene_expr_recon_loss: 10423484.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29800.0977; val_chrom_access_recon_loss: 8961585.7333; val_global_loss: 22139515.0667; val_optim_loss: 22139515.0667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9816; val_auprc_score: 0.9741; val_best_acc_score: 0.9400; val_best_f1_score: 0.9422; train_kl_reg_loss: 53286.0202; train_edge_recon_loss: 2662002.4256; train_gene_expr_recon_loss: 10356841.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29745.9770; train_chrom_access_recon_loss: 8915062.5573; train_global_loss: 22016938.6565; train_optim_loss: 22016938.6565; val_kl_reg_loss: 51920.2076; val_edge_recon_loss: 2669209.1333; val_gene_expr_recon_loss: 10427962.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29684.7344; val_chrom_access_recon_loss: 8954255.4667; val_global_loss: 22133032.0000; val_optim_loss: 22133032.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9810; val_auprc_score: 0.9764; val_best_acc_score: 0.9371; val_best_f1_score: 0.9383; train_kl_reg_loss: 52673.8518; train_edge_recon_loss: 2662350.4447; train_gene_expr_recon_loss: 10346106.2137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29775.2346; train_chrom_access_recon_loss: 8896280.6450; train_global_loss: 21987186.5344; train_optim_loss: 21987186.5344; val_kl_reg_loss: 50390.0385; val_edge_recon_loss: 2668798.9667; val_gene_expr_recon_loss: 10424040.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29931.2871; val_chrom_access_recon_loss: 8998081.2667; val_global_loss: 22171241.0667; val_optim_loss: 22171241.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9805; val_auprc_score: 0.9746; val_best_acc_score: 0.9372; val_best_f1_score: 0.9391; train_kl_reg_loss: 52473.6478; train_edge_recon_loss: 2659681.1336; train_gene_expr_recon_loss: 10330097.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29955.4142; train_chrom_access_recon_loss: 8877858.7672; train_global_loss: 21950066.7634; train_optim_loss: 21950066.7634; val_kl_reg_loss: 51423.7724; val_edge_recon_loss: 2675950.4667; val_gene_expr_recon_loss: 10406880.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30145.2148; val_chrom_access_recon_loss: 8938327.3667; val_global_loss: 22102726.8000; val_optim_loss: 22102726.8000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9848; val_auprc_score: 0.9805; val_best_acc_score: 0.9462; val_best_f1_score: 0.9475; train_kl_reg_loss: 52533.4833; train_edge_recon_loss: 2646426.6336; train_gene_expr_recon_loss: 10321200.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30092.2673; train_chrom_access_recon_loss: 8866517.1947; train_global_loss: 21916770.4580; train_optim_loss: 21916770.4580; val_kl_reg_loss: 53377.2388; val_edge_recon_loss: 2644258.4167; val_gene_expr_recon_loss: 10395252.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29983.1719; val_chrom_access_recon_loss: 8908716.6000; val_global_loss: 22031588.0000; val_optim_loss: 22031588.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9819; val_auprc_score: 0.9774; val_best_acc_score: 0.9445; val_best_f1_score: 0.9460; train_kl_reg_loss: 51768.4876; train_edge_recon_loss: 2655999.7844; train_gene_expr_recon_loss: 10307273.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30225.5684; train_chrom_access_recon_loss: 8849616.1718; train_global_loss: 21894882.9924; train_optim_loss: 21894882.9924; val_kl_reg_loss: 51375.2594; val_edge_recon_loss: 2660209.6000; val_gene_expr_recon_loss: 10396269.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30555.9883; val_chrom_access_recon_loss: 8898910.4000; val_global_loss: 22037320.6667; val_optim_loss: 22037320.6667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9814; val_auprc_score: 0.9737; val_best_acc_score: 0.9402; val_best_f1_score: 0.9416; train_kl_reg_loss: 51625.7675; train_edge_recon_loss: 2648771.8588; train_gene_expr_recon_loss: 10290781.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30392.7984; train_chrom_access_recon_loss: 8832930.6794; train_global_loss: 21854502.4733; train_optim_loss: 21854502.4733; val_kl_reg_loss: 51086.7487; val_edge_recon_loss: 2669286.7333; val_gene_expr_recon_loss: 10395694.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30408.6582; val_chrom_access_recon_loss: 8904736.9333; val_global_loss: 22051213.4667; val_optim_loss: 22051213.4667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9812; val_auprc_score: 0.9763; val_best_acc_score: 0.9411; val_best_f1_score: 0.9434; train_kl_reg_loss: 51006.6897; train_edge_recon_loss: 2655294.7939; train_gene_expr_recon_loss: 10286326.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30434.6410; train_chrom_access_recon_loss: 8819122.6336; train_global_loss: 21842185.1298; train_optim_loss: 21842185.1298; val_kl_reg_loss: 52107.2812; val_edge_recon_loss: 2660284.1000; val_gene_expr_recon_loss: 10383117.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30618.8203; val_chrom_access_recon_loss: 8928792.9333; val_global_loss: 22054920.8000; val_optim_loss: 22054920.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9860; val_auprc_score: 0.9811; val_best_acc_score: 0.9497; val_best_f1_score: 0.9508; train_kl_reg_loss: 50627.5307; train_edge_recon_loss: 2658384.7576; train_gene_expr_recon_loss: 10276006.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30650.5306; train_chrom_access_recon_loss: 8813267.0611; train_global_loss: 21828936.5038; train_optim_loss: 21828936.5038; val_kl_reg_loss: 49150.1604; val_edge_recon_loss: 2656868.5000; val_gene_expr_recon_loss: 10320898.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30921.6133; val_chrom_access_recon_loss: 8887100.2667; val_global_loss: 21944940.2667; val_optim_loss: 21944940.2667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9855; val_auprc_score: 0.9827; val_best_acc_score: 0.9462; val_best_f1_score: 0.9478; train_kl_reg_loss: 50264.6927; train_edge_recon_loss: 2651081.2385; train_gene_expr_recon_loss: 10265487.8550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30846.8917; train_chrom_access_recon_loss: 8798783.7405; train_global_loss: 21796464.3969; train_optim_loss: 21796464.3969; val_kl_reg_loss: 49137.3227; val_edge_recon_loss: 2653719.9833; val_gene_expr_recon_loss: 10349275.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30804.2734; val_chrom_access_recon_loss: 8888555.0333; val_global_loss: 21971491.7333; val_optim_loss: 21971491.7333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9867; val_auprc_score: 0.9811; val_best_acc_score: 0.9493; val_best_f1_score: 0.9505; train_kl_reg_loss: 50303.4570; train_edge_recon_loss: 2648281.9924; train_gene_expr_recon_loss: 10254296.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30911.9736; train_chrom_access_recon_loss: 8789253.8664; train_global_loss: 21773047.4504; train_optim_loss: 21773047.4504; val_kl_reg_loss: 50877.8773; val_edge_recon_loss: 2647784.1167; val_gene_expr_recon_loss: 10351834.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30865.2832; val_chrom_access_recon_loss: 8924264.8333; val_global_loss: 22005626.9333; val_optim_loss: 22005626.9333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9860; val_auprc_score: 0.9818; val_best_acc_score: 0.9481; val_best_f1_score: 0.9487; train_kl_reg_loss: 49972.1106; train_edge_recon_loss: 2643260.9027; train_gene_expr_recon_loss: 10228653.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31006.5690; train_chrom_access_recon_loss: 8758470.9313; train_global_loss: 21711363.9695; train_optim_loss: 21711363.9695; val_kl_reg_loss: 50441.1250; val_edge_recon_loss: 2661907.3167; val_gene_expr_recon_loss: 10332649.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30943.4883; val_chrom_access_recon_loss: 8875470.7667; val_global_loss: 21951411.8667; val_optim_loss: 21951411.8667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9874; val_auprc_score: 0.9849; val_best_acc_score: 0.9530; val_best_f1_score: 0.9534; train_kl_reg_loss: 49899.1975; train_edge_recon_loss: 2641879.5534; train_gene_expr_recon_loss: 10233801.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31089.6232; train_chrom_access_recon_loss: 8759267.4351; train_global_loss: 21715936.9618; train_optim_loss: 21715936.9618; val_kl_reg_loss: 49550.3779; val_edge_recon_loss: 2640494.1500; val_gene_expr_recon_loss: 10354143.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31373.8672; val_chrom_access_recon_loss: 8887684.2000; val_global_loss: 21963246.2667; val_optim_loss: 21963246.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9868; val_auprc_score: 0.9799; val_best_acc_score: 0.9503; val_best_f1_score: 0.9517; train_kl_reg_loss: 50552.9844; train_edge_recon_loss: 2639444.2691; train_gene_expr_recon_loss: 10210009.4427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26057.9262; train_chrom_access_recon_loss: 8731017.6641; train_global_loss: 21657082.3664; train_optim_loss: 21657082.3664; val_kl_reg_loss: 51213.8135; val_edge_recon_loss: 2648400.5667; val_gene_expr_recon_loss: 10334513.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24887.5156; val_chrom_access_recon_loss: 8865603.2667; val_global_loss: 21924619.6000; val_optim_loss: 21924619.6000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9857; val_auprc_score: 0.9818; val_best_acc_score: 0.9477; val_best_f1_score: 0.9489; train_kl_reg_loss: 51520.8322; train_edge_recon_loss: 2640619.1565; train_gene_expr_recon_loss: 10204418.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24686.3497; train_chrom_access_recon_loss: 8729730.4351; train_global_loss: 21650975.2519; train_optim_loss: 21650975.2519; val_kl_reg_loss: 51632.5849; val_edge_recon_loss: 2649691.9500; val_gene_expr_recon_loss: 10327406.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24553.4355; val_chrom_access_recon_loss: 8851535.3333; val_global_loss: 21904819.6000; val_optim_loss: 21904819.6000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9851; val_auprc_score: 0.9821; val_best_acc_score: 0.9485; val_best_f1_score: 0.9498; train_kl_reg_loss: 51977.7349; train_edge_recon_loss: 2638671.5210; train_gene_expr_recon_loss: 10204105.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24445.8684; train_chrom_access_recon_loss: 8722550.2748; train_global_loss: 21641751.4198; train_optim_loss: 21641751.4198; val_kl_reg_loss: 51605.6310; val_edge_recon_loss: 2651285.4833; val_gene_expr_recon_loss: 10331625.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24378.2539; val_chrom_access_recon_loss: 8871898.6000; val_global_loss: 21930793.3333; val_optim_loss: 21930793.3333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9882; val_auprc_score: 0.9810; val_best_acc_score: 0.9545; val_best_f1_score: 0.9557; train_kl_reg_loss: 51545.1632; train_edge_recon_loss: 2642538.3779; train_gene_expr_recon_loss: 10204451.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24323.9918; train_chrom_access_recon_loss: 8724090.6679; train_global_loss: 21646950.0305; train_optim_loss: 21646950.0305; val_kl_reg_loss: 52151.8542; val_edge_recon_loss: 2639062.5000; val_gene_expr_recon_loss: 10332336.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24280.2207; val_chrom_access_recon_loss: 8872643.8000; val_global_loss: 21920474.4000; val_optim_loss: 21920474.4000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9878; val_auprc_score: 0.9840; val_best_acc_score: 0.9519; val_best_f1_score: 0.9528; train_kl_reg_loss: 51966.7729; train_edge_recon_loss: 2639048.9733; train_gene_expr_recon_loss: 10201863.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24212.9818; train_chrom_access_recon_loss: 8716479.8473; train_global_loss: 21633571.6794; train_optim_loss: 21633571.6794; val_kl_reg_loss: 51899.1979; val_edge_recon_loss: 2651209.8167; val_gene_expr_recon_loss: 10332395.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24210.2617; val_chrom_access_recon_loss: 8841284.4667; val_global_loss: 21900998.4000; val_optim_loss: 21900998.4000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9882; val_auprc_score: 0.9845; val_best_acc_score: 0.9524; val_best_f1_score: 0.9533; train_kl_reg_loss: 51817.4826; train_edge_recon_loss: 2642526.8511; train_gene_expr_recon_loss: 10194723.7786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24147.7581; train_chrom_access_recon_loss: 8708947.6336; train_global_loss: 21622163.4351; train_optim_loss: 21622163.4351; val_kl_reg_loss: 51451.8531; val_edge_recon_loss: 2654083.0833; val_gene_expr_recon_loss: 10316562.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24120.1719; val_chrom_access_recon_loss: 8860678.4667; val_global_loss: 21906896.5333; val_optim_loss: 21906896.5333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9902; val_auprc_score: 0.9881; val_best_acc_score: 0.9576; val_best_f1_score: 0.9583; train_kl_reg_loss: 51877.4788; train_edge_recon_loss: 2641361.1889; train_gene_expr_recon_loss: 10194683.8855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24070.8092; train_chrom_access_recon_loss: 8713716.0038; train_global_loss: 21625709.4198; train_optim_loss: 21625709.4198; val_kl_reg_loss: 51530.2003; val_edge_recon_loss: 2632717.7333; val_gene_expr_recon_loss: 10331427.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24041.3691; val_chrom_access_recon_loss: 8854368.9333; val_global_loss: 21894084.6667; val_optim_loss: 21894084.6667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9867; val_auprc_score: 0.9817; val_best_acc_score: 0.9510; val_best_f1_score: 0.9520; train_kl_reg_loss: 51843.8957; train_edge_recon_loss: 2637015.3206; train_gene_expr_recon_loss: 10208697.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24006.5548; train_chrom_access_recon_loss: 8718756.0382; train_global_loss: 21640318.9160; train_optim_loss: 21640318.9160; val_kl_reg_loss: 52108.5771; val_edge_recon_loss: 2649776.0833; val_gene_expr_recon_loss: 10304846.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23983.3750; val_chrom_access_recon_loss: 8862176.4333; val_global_loss: 21892890.8000; val_optim_loss: 21892890.8000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9879; val_auprc_score: 0.9822; val_best_acc_score: 0.9526; val_best_f1_score: 0.9530; train_kl_reg_loss: 51871.5853; train_edge_recon_loss: 2635506.3798; train_gene_expr_recon_loss: 10195674.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23953.3506; train_chrom_access_recon_loss: 8706528.9237; train_global_loss: 21613534.8855; train_optim_loss: 21613534.8855; val_kl_reg_loss: 51640.2182; val_edge_recon_loss: 2650024.5833; val_gene_expr_recon_loss: 10314599.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23917.0742; val_chrom_access_recon_loss: 8850517.7333; val_global_loss: 21890698.9333; val_optim_loss: 21890698.9333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9881; val_auprc_score: 0.9803; val_best_acc_score: 0.9538; val_best_f1_score: 0.9549; train_kl_reg_loss: 51532.2514; train_edge_recon_loss: 2638210.1660; train_gene_expr_recon_loss: 10189245.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23892.0387; train_chrom_access_recon_loss: 8705615.6641; train_global_loss: 21608495.5420; train_optim_loss: 21608495.5420; val_kl_reg_loss: 51807.4297; val_edge_recon_loss: 2634149.0500; val_gene_expr_recon_loss: 10296158.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23863.0078; val_chrom_access_recon_loss: 8804197.0333; val_global_loss: 21810174.5333; val_optim_loss: 21810174.5333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9884; val_auprc_score: 0.9862; val_best_acc_score: 0.9528; val_best_f1_score: 0.9538; train_kl_reg_loss: 51185.9825; train_edge_recon_loss: 2637056.2844; train_gene_expr_recon_loss: 10189992.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23843.5251; train_chrom_access_recon_loss: 8705130.5573; train_global_loss: 21607209.0840; train_optim_loss: 21607209.0840; val_kl_reg_loss: 51569.6344; val_edge_recon_loss: 2653111.3167; val_gene_expr_recon_loss: 10294797.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23815.1895; val_chrom_access_recon_loss: 8842370.4667; val_global_loss: 21865663.7333; val_optim_loss: 21865663.7333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9886; val_auprc_score: 0.9853; val_best_acc_score: 0.9555; val_best_f1_score: 0.9567; train_kl_reg_loss: 51493.3375; train_edge_recon_loss: 2640442.1374; train_gene_expr_recon_loss: 10189771.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23792.4145; train_chrom_access_recon_loss: 8705600.9122; train_global_loss: 21611100.0153; train_optim_loss: 21611100.0153; val_kl_reg_loss: 51503.3909; val_edge_recon_loss: 2643480.0667; val_gene_expr_recon_loss: 10318109.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23738.0449; val_chrom_access_recon_loss: 8824201.3333; val_global_loss: 21861032.4000; val_optim_loss: 21861032.4000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9885; val_auprc_score: 0.9826; val_best_acc_score: 0.9545; val_best_f1_score: 0.9553; train_kl_reg_loss: 51403.1068; train_edge_recon_loss: 2636348.9084; train_gene_expr_recon_loss: 10181121.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23723.7270; train_chrom_access_recon_loss: 8692845.7099; train_global_loss: 21585442.5038; train_optim_loss: 21585442.5038; val_kl_reg_loss: 51276.1612; val_edge_recon_loss: 2636061.7167; val_gene_expr_recon_loss: 10337144.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23714.6816; val_chrom_access_recon_loss: 8869624.2667; val_global_loss: 21917821.4667; val_optim_loss: 21917821.4667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9891; val_auprc_score: 0.9871; val_best_acc_score: 0.9545; val_best_f1_score: 0.9557; train_kl_reg_loss: 51365.7665; train_edge_recon_loss: 2636066.2309; train_gene_expr_recon_loss: 10185849.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23673.5845; train_chrom_access_recon_loss: 8700468.3092; train_global_loss: 21597423.8168; train_optim_loss: 21597423.8168; val_kl_reg_loss: 51312.9938; val_edge_recon_loss: 2654302.7167; val_gene_expr_recon_loss: 10356968.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23641.7344; val_chrom_access_recon_loss: 8881571.7333; val_global_loss: 21967798.5333; val_optim_loss: 21967798.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9859; val_auprc_score: 0.9809; val_best_acc_score: 0.9491; val_best_f1_score: 0.9503; train_kl_reg_loss: 51253.8049; train_edge_recon_loss: 2633128.2118; train_gene_expr_recon_loss: 10194670.7557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23100.0048; train_chrom_access_recon_loss: 8698389.9885; train_global_loss: 21600542.7939; train_optim_loss: 21600542.7939; val_kl_reg_loss: 51612.8339; val_edge_recon_loss: 2663541.5167; val_gene_expr_recon_loss: 10337536.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22977.3105; val_chrom_access_recon_loss: 8857846.8667; val_global_loss: 21933514.8000; val_optim_loss: 21933514.8000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9882; val_auprc_score: 0.9828; val_best_acc_score: 0.9550; val_best_f1_score: 0.9558; train_kl_reg_loss: 51390.9210; train_edge_recon_loss: 2636339.0553; train_gene_expr_recon_loss: 10183204.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22953.5369; train_chrom_access_recon_loss: 8701744.9275; train_global_loss: 21595632.5954; train_optim_loss: 21595632.5954; val_kl_reg_loss: 51471.8086; val_edge_recon_loss: 2645882.6000; val_gene_expr_recon_loss: 10330257.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22936.2246; val_chrom_access_recon_loss: 8855670.5333; val_global_loss: 21906218.4000; val_optim_loss: 21906218.4000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9882; val_auprc_score: 0.9856; val_best_acc_score: 0.9538; val_best_f1_score: 0.9551; train_kl_reg_loss: 51457.8117; train_edge_recon_loss: 2635261.7519; train_gene_expr_recon_loss: 10183780.5344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22925.1343; train_chrom_access_recon_loss: 8693941.9504; train_global_loss: 21587367.1756; train_optim_loss: 21587367.1756; val_kl_reg_loss: 51528.2445; val_edge_recon_loss: 2640937.8833; val_gene_expr_recon_loss: 10291075.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22912.9609; val_chrom_access_recon_loss: 8845096.5333; val_global_loss: 21851551.6000; val_optim_loss: 21851551.6000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9888; val_auprc_score: 0.9860; val_best_acc_score: 0.9541; val_best_f1_score: 0.9549; train_kl_reg_loss: 51528.3123; train_edge_recon_loss: 2634334.9408; train_gene_expr_recon_loss: 10187083.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22905.3581; train_chrom_access_recon_loss: 8700489.9847; train_global_loss: 21596342.5038; train_optim_loss: 21596342.5038; val_kl_reg_loss: 51709.7099; val_edge_recon_loss: 2659027.0167; val_gene_expr_recon_loss: 10326451.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22896.7207; val_chrom_access_recon_loss: 8866011.2667; val_global_loss: 21926096.4000; val_optim_loss: 21926096.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 84 min 6 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9888
val AUPRC score: 0.9873
val best accuracy score: 0.9526
val best F1 score: 0.9536
val target rna MSE score: 1.1332
val source rna MSE score: 0.2141
val target atac MSE score: 0.3389
val source atac MSE score: 0.0518
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
