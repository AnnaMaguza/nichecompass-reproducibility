[True]
Run timestamp: 10102023_021934_113.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_113']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7686; val_auprc_score: 0.7855; val_best_acc_score: 0.6696; val_best_f1_score: 0.7163; train_kl_reg_loss: 67831.6389; train_edge_recon_loss: 3507459.6221; train_gene_expr_recon_loss: 13463133.0534; train_masked_gp_l1_reg_loss: 34351.8503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2420635.0339; train_chrom_access_recon_loss: 4782052.8130; train_global_loss: 24275463.9695; train_optim_loss: 24275463.9695; val_kl_reg_loss: 77197.2615; val_edge_recon_loss: 4049136.9167; val_gene_expr_recon_loss: 12815936.0000; val_masked_gp_l1_reg_loss: 39675.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 588920.5625; val_chrom_access_recon_loss: 4585525.3667; val_global_loss: 22156392.1333; val_optim_loss: 22156392.1333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8024; val_auprc_score: 0.8106; val_best_acc_score: 0.7145; val_best_f1_score: 0.7472; train_kl_reg_loss: 69864.0155; train_edge_recon_loss: 3384176.4008; train_gene_expr_recon_loss: 12650229.8702; train_masked_gp_l1_reg_loss: 42699.2428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 308512.7958; train_chrom_access_recon_loss: 4593324.9466; train_global_loss: 21048807.2824; train_optim_loss: 21048807.2824; val_kl_reg_loss: 73156.4797; val_edge_recon_loss: 3164629.3500; val_gene_expr_recon_loss: 12684155.2000; val_masked_gp_l1_reg_loss: 46587.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173336.1875; val_chrom_access_recon_loss: 4557790.8667; val_global_loss: 20699656.0000; val_optim_loss: 20699656.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8276; val_auprc_score: 0.8400; val_best_acc_score: 0.7259; val_best_f1_score: 0.7512; train_kl_reg_loss: 83664.5576; train_edge_recon_loss: 3066814.6088; train_gene_expr_recon_loss: 12524615.8626; train_masked_gp_l1_reg_loss: 49641.3929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134223.0217; train_chrom_access_recon_loss: 4556083.1679; train_global_loss: 20415042.5802; train_optim_loss: 20415042.5802; val_kl_reg_loss: 91819.6203; val_edge_recon_loss: 3092795.7667; val_gene_expr_recon_loss: 12452606.4000; val_masked_gp_l1_reg_loss: 52220.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107736.1797; val_chrom_access_recon_loss: 4479947.5333; val_global_loss: 20277126.2667; val_optim_loss: 20277126.2667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8787; val_auprc_score: 0.8724; val_best_acc_score: 0.7937; val_best_f1_score: 0.8013; train_kl_reg_loss: 81963.7774; train_edge_recon_loss: 3002435.5305; train_gene_expr_recon_loss: 12369158.4809; train_masked_gp_l1_reg_loss: 54163.7631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96918.4987; train_chrom_access_recon_loss: 4504139.1775; train_global_loss: 20108779.3893; train_optim_loss: 20108779.3893; val_kl_reg_loss: 73293.9414; val_edge_recon_loss: 3034321.4667; val_gene_expr_recon_loss: 12312206.0667; val_masked_gp_l1_reg_loss: 56514.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91277.5156; val_chrom_access_recon_loss: 4446577.3667; val_global_loss: 20014190.8000; val_optim_loss: 20014190.8000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9360; val_auprc_score: 0.9259; val_best_acc_score: 0.8650; val_best_f1_score: 0.8707; train_kl_reg_loss: 83014.1871; train_edge_recon_loss: 2838167.9332; train_gene_expr_recon_loss: 12229963.3664; train_masked_gp_l1_reg_loss: 58965.2194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93625.6522; train_chrom_access_recon_loss: 4458156.4008; train_global_loss: 19761892.7328; train_optim_loss: 19761892.7328; val_kl_reg_loss: 87059.9411; val_edge_recon_loss: 2817098.0000; val_gene_expr_recon_loss: 12190188.3333; val_masked_gp_l1_reg_loss: 60846.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94910.7031; val_chrom_access_recon_loss: 4414970.5000; val_global_loss: 19665073.8667; val_optim_loss: 19665073.8667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9362; val_auprc_score: 0.9241; val_best_acc_score: 0.8685; val_best_f1_score: 0.8755; train_kl_reg_loss: 86952.2974; train_edge_recon_loss: 2788448.0973; train_gene_expr_recon_loss: 12116638.9084; train_masked_gp_l1_reg_loss: 62266.3281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94479.7018; train_chrom_access_recon_loss: 4427313.3702; train_global_loss: 19576098.6870; train_optim_loss: 19576098.6870; val_kl_reg_loss: 87318.0057; val_edge_recon_loss: 2802257.8500; val_gene_expr_recon_loss: 12090443.4667; val_masked_gp_l1_reg_loss: 63488.3320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93753.3438; val_chrom_access_recon_loss: 4389888.7667; val_global_loss: 19527149.0667; val_optim_loss: 19527149.0667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9385; val_auprc_score: 0.9262; val_best_acc_score: 0.8769; val_best_f1_score: 0.8824; train_kl_reg_loss: 84947.4381; train_edge_recon_loss: 2768296.7195; train_gene_expr_recon_loss: 12026845.3817; train_masked_gp_l1_reg_loss: 64557.1226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91314.1877; train_chrom_access_recon_loss: 4401142.4885; train_global_loss: 19437103.2824; train_optim_loss: 19437103.2824; val_kl_reg_loss: 82818.3370; val_edge_recon_loss: 2796000.8500; val_gene_expr_recon_loss: 12030104.0667; val_masked_gp_l1_reg_loss: 65516.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88741.5000; val_chrom_access_recon_loss: 4350626.8667; val_global_loss: 19413808.6667; val_optim_loss: 19413808.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9390; val_auprc_score: 0.9239; val_best_acc_score: 0.8789; val_best_f1_score: 0.8847; train_kl_reg_loss: 81654.3332; train_edge_recon_loss: 2753784.9504; train_gene_expr_recon_loss: 11939614.4275; train_masked_gp_l1_reg_loss: 66436.4037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86917.1895; train_chrom_access_recon_loss: 4367823.9122; train_global_loss: 19296231.2214; train_optim_loss: 19296231.2214; val_kl_reg_loss: 80178.2891; val_edge_recon_loss: 2773460.7333; val_gene_expr_recon_loss: 11933391.5333; val_masked_gp_l1_reg_loss: 67325.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85340.7109; val_chrom_access_recon_loss: 4331208.6000; val_global_loss: 19270905.8667; val_optim_loss: 19270905.8667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9395; val_auprc_score: 0.9266; val_best_acc_score: 0.8746; val_best_f1_score: 0.8816; train_kl_reg_loss: 80484.8059; train_edge_recon_loss: 2744728.8702; train_gene_expr_recon_loss: 11880402.8244; train_masked_gp_l1_reg_loss: 68049.1840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83885.1179; train_chrom_access_recon_loss: 4350054.2080; train_global_loss: 19207604.9618; train_optim_loss: 19207604.9618; val_kl_reg_loss: 76334.0578; val_edge_recon_loss: 2782655.2167; val_gene_expr_recon_loss: 11878947.4000; val_masked_gp_l1_reg_loss: 68766.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83273.0000; val_chrom_access_recon_loss: 4326821.7500; val_global_loss: 19216797.3333; val_optim_loss: 19216797.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9495; val_auprc_score: 0.9392; val_best_acc_score: 0.8833; val_best_f1_score: 0.8892; train_kl_reg_loss: 78202.3306; train_edge_recon_loss: 2738340.7901; train_gene_expr_recon_loss: 11795962.7710; train_masked_gp_l1_reg_loss: 69454.2951; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82127.5742; train_chrom_access_recon_loss: 4315905.9504; train_global_loss: 19079993.7252; train_optim_loss: 19079993.7252; val_kl_reg_loss: 77886.2615; val_edge_recon_loss: 2746573.8000; val_gene_expr_recon_loss: 11866107.2667; val_masked_gp_l1_reg_loss: 70199.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81245.2031; val_chrom_access_recon_loss: 4301356.0000; val_global_loss: 19143367.7333; val_optim_loss: 19143367.7333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9474; val_auprc_score: 0.9336; val_best_acc_score: 0.8829; val_best_f1_score: 0.8888; train_kl_reg_loss: 77359.3534; train_edge_recon_loss: 2739910.6450; train_gene_expr_recon_loss: 11738206.4885; train_masked_gp_l1_reg_loss: 70626.5711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81103.3429; train_chrom_access_recon_loss: 4298293.8492; train_global_loss: 19005500.3359; train_optim_loss: 19005500.3359; val_kl_reg_loss: 71967.3698; val_edge_recon_loss: 2759877.9000; val_gene_expr_recon_loss: 11752280.9333; val_masked_gp_l1_reg_loss: 71271.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81305.3984; val_chrom_access_recon_loss: 4265953.5667; val_global_loss: 19002656.0000; val_optim_loss: 19002656.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9538; val_auprc_score: 0.9464; val_best_acc_score: 0.8907; val_best_f1_score: 0.8952; train_kl_reg_loss: 76047.4597; train_edge_recon_loss: 2721604.0840; train_gene_expr_recon_loss: 11702118.4427; train_masked_gp_l1_reg_loss: 71701.5425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80908.2835; train_chrom_access_recon_loss: 4285152.3740; train_global_loss: 18937532.1069; train_optim_loss: 18937532.1069; val_kl_reg_loss: 76810.2927; val_edge_recon_loss: 2738395.2167; val_gene_expr_recon_loss: 11712276.4667; val_masked_gp_l1_reg_loss: 72149.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81017.3281; val_chrom_access_recon_loss: 4253210.2500; val_global_loss: 18933858.9333; val_optim_loss: 18933858.9333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9545; val_auprc_score: 0.9431; val_best_acc_score: 0.8972; val_best_f1_score: 0.9008; train_kl_reg_loss: 73961.0633; train_edge_recon_loss: 2712467.2233; train_gene_expr_recon_loss: 11647248.8702; train_masked_gp_l1_reg_loss: 72531.2133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80520.4252; train_chrom_access_recon_loss: 4266287.6240; train_global_loss: 18853016.4733; train_optim_loss: 18853016.4733; val_kl_reg_loss: 73285.1615; val_edge_recon_loss: 2737072.0333; val_gene_expr_recon_loss: 11649781.8667; val_masked_gp_l1_reg_loss: 72914.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80108.6406; val_chrom_access_recon_loss: 4216687.9333; val_global_loss: 18829850.6667; val_optim_loss: 18829850.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9609; val_auprc_score: 0.9514; val_best_acc_score: 0.9018; val_best_f1_score: 0.9051; train_kl_reg_loss: 74330.3887; train_edge_recon_loss: 2712843.5954; train_gene_expr_recon_loss: 11595951.5725; train_masked_gp_l1_reg_loss: 73318.1115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80024.0272; train_chrom_access_recon_loss: 4246657.9027; train_global_loss: 18783125.5573; train_optim_loss: 18783125.5573; val_kl_reg_loss: 75980.1656; val_edge_recon_loss: 2715224.1833; val_gene_expr_recon_loss: 11642158.5333; val_masked_gp_l1_reg_loss: 73652.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79830.0469; val_chrom_access_recon_loss: 4224122.9000; val_global_loss: 18810967.6000; val_optim_loss: 18810967.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9604; val_auprc_score: 0.9506; val_best_acc_score: 0.9050; val_best_f1_score: 0.9088; train_kl_reg_loss: 73045.1397; train_edge_recon_loss: 2703359.5019; train_gene_expr_recon_loss: 11569890.4122; train_masked_gp_l1_reg_loss: 73957.7900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79227.7056; train_chrom_access_recon_loss: 4235113.9771; train_global_loss: 18734594.4733; train_optim_loss: 18734594.4733; val_kl_reg_loss: 73187.5870; val_edge_recon_loss: 2714124.2333; val_gene_expr_recon_loss: 11567580.4667; val_masked_gp_l1_reg_loss: 74312.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79171.7344; val_chrom_access_recon_loss: 4183333.5833; val_global_loss: 18691710.1333; val_optim_loss: 18691710.1333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9589; val_auprc_score: 0.9460; val_best_acc_score: 0.9039; val_best_f1_score: 0.9080; train_kl_reg_loss: 73304.0376; train_edge_recon_loss: 2699534.6450; train_gene_expr_recon_loss: 11534838.6794; train_masked_gp_l1_reg_loss: 74484.6370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78537.4144; train_chrom_access_recon_loss: 4216820.2443; train_global_loss: 18677519.6947; train_optim_loss: 18677519.6947; val_kl_reg_loss: 73598.1693; val_edge_recon_loss: 2740813.3833; val_gene_expr_recon_loss: 11563950.3333; val_masked_gp_l1_reg_loss: 74639.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78381.4531; val_chrom_access_recon_loss: 4209356.6667; val_global_loss: 18740739.4667; val_optim_loss: 18740739.4667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9637; val_auprc_score: 0.9522; val_best_acc_score: 0.9099; val_best_f1_score: 0.9131; train_kl_reg_loss: 72428.5797; train_edge_recon_loss: 2694122.4447; train_gene_expr_recon_loss: 11505418.2061; train_masked_gp_l1_reg_loss: 74728.4498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77893.8669; train_chrom_access_recon_loss: 4205183.5782; train_global_loss: 18629775.1450; train_optim_loss: 18629775.1450; val_kl_reg_loss: 72695.6297; val_edge_recon_loss: 2718694.4500; val_gene_expr_recon_loss: 11536704.8667; val_masked_gp_l1_reg_loss: 74939.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77950.3984; val_chrom_access_recon_loss: 4179302.1000; val_global_loss: 18660287.0667; val_optim_loss: 18660287.0667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9687; val_auprc_score: 0.9620; val_best_acc_score: 0.9186; val_best_f1_score: 0.9208; train_kl_reg_loss: 71036.0558; train_edge_recon_loss: 2693642.8531; train_gene_expr_recon_loss: 11477011.8931; train_masked_gp_l1_reg_loss: 75078.9743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77614.8457; train_chrom_access_recon_loss: 4194557.1088; train_global_loss: 18588941.7557; train_optim_loss: 18588941.7557; val_kl_reg_loss: 72331.9802; val_edge_recon_loss: 2700089.6167; val_gene_expr_recon_loss: 11522139.1333; val_masked_gp_l1_reg_loss: 75141.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77552.5469; val_chrom_access_recon_loss: 4177635.6333; val_global_loss: 18624891.2000; val_optim_loss: 18624891.2000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9704; val_auprc_score: 0.9629; val_best_acc_score: 0.9189; val_best_f1_score: 0.9214; train_kl_reg_loss: 71152.5464; train_edge_recon_loss: 2691096.9008; train_gene_expr_recon_loss: 11446318.6565; train_masked_gp_l1_reg_loss: 75237.6647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77089.8019; train_chrom_access_recon_loss: 4178069.1546; train_global_loss: 18538964.6870; train_optim_loss: 18538964.6870; val_kl_reg_loss: 69359.9755; val_edge_recon_loss: 2702670.7833; val_gene_expr_recon_loss: 11493963.7333; val_masked_gp_l1_reg_loss: 75333.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77228.9062; val_chrom_access_recon_loss: 4156203.5000; val_global_loss: 18574761.0667; val_optim_loss: 18574761.0667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9729; val_auprc_score: 0.9657; val_best_acc_score: 0.9254; val_best_f1_score: 0.9279; train_kl_reg_loss: 71449.7152; train_edge_recon_loss: 2689425.4771; train_gene_expr_recon_loss: 11424921.5878; train_masked_gp_l1_reg_loss: 75349.5728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77065.7951; train_chrom_access_recon_loss: 4164841.2863; train_global_loss: 18503053.4962; train_optim_loss: 18503053.4962; val_kl_reg_loss: 71214.1854; val_edge_recon_loss: 2696931.1333; val_gene_expr_recon_loss: 11527852.0667; val_masked_gp_l1_reg_loss: 75316.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76953.7500; val_chrom_access_recon_loss: 4185193.6833; val_global_loss: 18633461.2000; val_optim_loss: 18633461.2000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9685; val_auprc_score: 0.9558; val_best_acc_score: 0.9208; val_best_f1_score: 0.9235; train_kl_reg_loss: 70234.1809; train_edge_recon_loss: 2685856.2004; train_gene_expr_recon_loss: 11396926.5344; train_masked_gp_l1_reg_loss: 75394.8330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76840.3198; train_chrom_access_recon_loss: 4153761.8302; train_global_loss: 18459013.8321; train_optim_loss: 18459013.8321; val_kl_reg_loss: 69045.2784; val_edge_recon_loss: 2709335.0333; val_gene_expr_recon_loss: 11433362.0000; val_masked_gp_l1_reg_loss: 75527.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77127.5547; val_chrom_access_recon_loss: 4133031.1000; val_global_loss: 18497429.2000; val_optim_loss: 18497429.2000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9675; val_auprc_score: 0.9593; val_best_acc_score: 0.9177; val_best_f1_score: 0.9216; train_kl_reg_loss: 69322.9831; train_edge_recon_loss: 2685087.7500; train_gene_expr_recon_loss: 11382547.6489; train_masked_gp_l1_reg_loss: 75434.4439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76586.9562; train_chrom_access_recon_loss: 4140078.5382; train_global_loss: 18429058.3359; train_optim_loss: 18429058.3359; val_kl_reg_loss: 69867.7656; val_edge_recon_loss: 2702496.8500; val_gene_expr_recon_loss: 11412432.3333; val_masked_gp_l1_reg_loss: 75588.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77441.6016; val_chrom_access_recon_loss: 4130773.9333; val_global_loss: 18468602.0000; val_optim_loss: 18468602.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9704; val_auprc_score: 0.9625; val_best_acc_score: 0.9190; val_best_f1_score: 0.9221; train_kl_reg_loss: 69085.2165; train_edge_recon_loss: 2683365.2137; train_gene_expr_recon_loss: 11364171.0229; train_masked_gp_l1_reg_loss: 75595.2253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76800.7130; train_chrom_access_recon_loss: 4130128.6050; train_global_loss: 18399146.0000; train_optim_loss: 18399146.0000; val_kl_reg_loss: 68856.1135; val_edge_recon_loss: 2713255.5167; val_gene_expr_recon_loss: 11443756.9333; val_masked_gp_l1_reg_loss: 75585.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77117.8359; val_chrom_access_recon_loss: 4155668.2667; val_global_loss: 18534240.0000; val_optim_loss: 18534240.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9721; val_auprc_score: 0.9651; val_best_acc_score: 0.9235; val_best_f1_score: 0.9259; train_kl_reg_loss: 68558.6582; train_edge_recon_loss: 2689763.1870; train_gene_expr_recon_loss: 11341773.8702; train_masked_gp_l1_reg_loss: 75468.2499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76719.7403; train_chrom_access_recon_loss: 4115229.0019; train_global_loss: 18367512.6870; train_optim_loss: 18367512.6870; val_kl_reg_loss: 68023.1026; val_edge_recon_loss: 2705590.5333; val_gene_expr_recon_loss: 11353760.4000; val_masked_gp_l1_reg_loss: 75436.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76796.8125; val_chrom_access_recon_loss: 4087091.9000; val_global_loss: 18366698.9333; val_optim_loss: 18366698.9333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9727; val_auprc_score: 0.9623; val_best_acc_score: 0.9251; val_best_f1_score: 0.9280; train_kl_reg_loss: 67954.2478; train_edge_recon_loss: 2683265.6527; train_gene_expr_recon_loss: 11332546.3664; train_masked_gp_l1_reg_loss: 75353.2629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76697.6860; train_chrom_access_recon_loss: 4107244.0706; train_global_loss: 18343061.3282; train_optim_loss: 18343061.3282; val_kl_reg_loss: 67511.3391; val_edge_recon_loss: 2701568.5333; val_gene_expr_recon_loss: 11374967.9333; val_masked_gp_l1_reg_loss: 75307.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77343.5156; val_chrom_access_recon_loss: 4078387.8833; val_global_loss: 18375086.9333; val_optim_loss: 18375086.9333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9711; val_auprc_score: 0.9606; val_best_acc_score: 0.9233; val_best_f1_score: 0.9259; train_kl_reg_loss: 81141.1117; train_edge_recon_loss: 2736913.4351; train_gene_expr_recon_loss: 10454748.8397; train_masked_gp_l1_reg_loss: 74963.5211; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75251.3748; train_chrom_access_recon_loss: 3827115.9046; train_global_loss: 17250134.1679; train_optim_loss: 17250134.1679; val_kl_reg_loss: 31896.1038; val_edge_recon_loss: 2726421.0333; val_gene_expr_recon_loss: 10474580.8000; val_masked_gp_l1_reg_loss: 74399.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76092.9141; val_chrom_access_recon_loss: 3801808.3167; val_global_loss: 17185198.0000; val_optim_loss: 17185198.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9707; val_auprc_score: 0.9633; val_best_acc_score: 0.9224; val_best_f1_score: 0.9247; train_kl_reg_loss: 65212.8516; train_edge_recon_loss: 2689789.3683; train_gene_expr_recon_loss: 10417755.8321; train_masked_gp_l1_reg_loss: 73645.6701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76503.3357; train_chrom_access_recon_loss: 3798670.8817; train_global_loss: 17121577.8779; train_optim_loss: 17121577.8779; val_kl_reg_loss: 39069.6068; val_edge_recon_loss: 2692635.0833; val_gene_expr_recon_loss: 10486772.4667; val_masked_gp_l1_reg_loss: 72654.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76395.8438; val_chrom_access_recon_loss: 3806230.4833; val_global_loss: 17173758.7333; val_optim_loss: 17173758.7333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9712; val_auprc_score: 0.9620; val_best_acc_score: 0.9205; val_best_f1_score: 0.9238; train_kl_reg_loss: 57467.0549; train_edge_recon_loss: 2685725.6775; train_gene_expr_recon_loss: 10407113.6031; train_masked_gp_l1_reg_loss: 71689.1451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76461.9614; train_chrom_access_recon_loss: 3798671.6756; train_global_loss: 17097129.0611; train_optim_loss: 17097129.0611; val_kl_reg_loss: 42934.9135; val_edge_recon_loss: 2695396.3333; val_gene_expr_recon_loss: 10401898.4000; val_masked_gp_l1_reg_loss: 70535.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75858.8828; val_chrom_access_recon_loss: 3764423.6500; val_global_loss: 17051047.4000; val_optim_loss: 17051047.4000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9719; val_auprc_score: 0.9631; val_best_acc_score: 0.9229; val_best_f1_score: 0.9259; train_kl_reg_loss: 56179.9272; train_edge_recon_loss: 2677171.4962; train_gene_expr_recon_loss: 10381565.4733; train_masked_gp_l1_reg_loss: 69506.3448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75857.3797; train_chrom_access_recon_loss: 3784464.5687; train_global_loss: 17044745.1603; train_optim_loss: 17044745.1603; val_kl_reg_loss: 46366.3419; val_edge_recon_loss: 2688803.5333; val_gene_expr_recon_loss: 10398267.5333; val_masked_gp_l1_reg_loss: 68379.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75521.8906; val_chrom_access_recon_loss: 3773187.3667; val_global_loss: 17050525.8667; val_optim_loss: 17050525.8667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9734; val_auprc_score: 0.9637; val_best_acc_score: 0.9281; val_best_f1_score: 0.9300; train_kl_reg_loss: 54376.8743; train_edge_recon_loss: 2670477.5420; train_gene_expr_recon_loss: 10351750.1527; train_masked_gp_l1_reg_loss: 67439.3569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75297.5197; train_chrom_access_recon_loss: 3774938.3664; train_global_loss: 16994279.6718; train_optim_loss: 16994279.6718; val_kl_reg_loss: 48719.5615; val_edge_recon_loss: 2688692.0333; val_gene_expr_recon_loss: 10415338.0667; val_masked_gp_l1_reg_loss: 66431.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74967.5078; val_chrom_access_recon_loss: 3783614.1667; val_global_loss: 17077763.6000; val_optim_loss: 17077763.6000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9735; val_auprc_score: 0.9632; val_best_acc_score: 0.9293; val_best_f1_score: 0.9304; train_kl_reg_loss: 52575.8371; train_edge_recon_loss: 2678022.4790; train_gene_expr_recon_loss: 10364086.4656; train_masked_gp_l1_reg_loss: 65645.2621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74912.3235; train_chrom_access_recon_loss: 3778961.9179; train_global_loss: 17014204.3206; train_optim_loss: 17014204.3206; val_kl_reg_loss: 46750.5591; val_edge_recon_loss: 2689371.1000; val_gene_expr_recon_loss: 10368412.9333; val_masked_gp_l1_reg_loss: 64898.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74873.8203; val_chrom_access_recon_loss: 3757001.2667; val_global_loss: 17001307.7333; val_optim_loss: 17001307.7333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9707; val_auprc_score: 0.9594; val_best_acc_score: 0.9267; val_best_f1_score: 0.9294; train_kl_reg_loss: 52348.5335; train_edge_recon_loss: 2671065.5477; train_gene_expr_recon_loss: 10345494.6947; train_masked_gp_l1_reg_loss: 64281.9648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74583.1823; train_chrom_access_recon_loss: 3776052.4408; train_global_loss: 16983826.2519; train_optim_loss: 16983826.2519; val_kl_reg_loss: 46615.8042; val_edge_recon_loss: 2694895.5167; val_gene_expr_recon_loss: 10353514.0667; val_masked_gp_l1_reg_loss: 63726.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74133.9219; val_chrom_access_recon_loss: 3734052.7833; val_global_loss: 16966938.1333; val_optim_loss: 16966938.1333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9727; val_auprc_score: 0.9645; val_best_acc_score: 0.9268; val_best_f1_score: 0.9297; train_kl_reg_loss: 52003.3087; train_edge_recon_loss: 2671294.8149; train_gene_expr_recon_loss: 10342424.2595; train_masked_gp_l1_reg_loss: 63204.1047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74282.4287; train_chrom_access_recon_loss: 3772114.0515; train_global_loss: 16975322.9924; train_optim_loss: 16975322.9924; val_kl_reg_loss: 48234.9721; val_edge_recon_loss: 2693646.3667; val_gene_expr_recon_loss: 10370230.0000; val_masked_gp_l1_reg_loss: 62826.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74305.3750; val_chrom_access_recon_loss: 3746699.0333; val_global_loss: 16995942.3333; val_optim_loss: 16995942.3333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9771; val_auprc_score: 0.9676; val_best_acc_score: 0.9352; val_best_f1_score: 0.9371; train_kl_reg_loss: 53087.5417; train_edge_recon_loss: 2664898.3130; train_gene_expr_recon_loss: 10326966.9237; train_masked_gp_l1_reg_loss: 62349.2874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73866.1357; train_chrom_access_recon_loss: 3768162.4752; train_global_loss: 16949330.6031; train_optim_loss: 16949330.6031; val_kl_reg_loss: 49107.6109; val_edge_recon_loss: 2673037.2500; val_gene_expr_recon_loss: 10381156.0000; val_masked_gp_l1_reg_loss: 61864.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73515.0703; val_chrom_access_recon_loss: 3748030.8000; val_global_loss: 16986711.5333; val_optim_loss: 16986711.5333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9744; val_auprc_score: 0.9632; val_best_acc_score: 0.9329; val_best_f1_score: 0.9354; train_kl_reg_loss: 51438.7438; train_edge_recon_loss: 2669241.1221; train_gene_expr_recon_loss: 10326690.3359; train_masked_gp_l1_reg_loss: 61529.1252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73438.4670; train_chrom_access_recon_loss: 3766918.9580; train_global_loss: 16949256.8092; train_optim_loss: 16949256.8092; val_kl_reg_loss: 48286.1005; val_edge_recon_loss: 2664017.6000; val_gene_expr_recon_loss: 10384028.4000; val_masked_gp_l1_reg_loss: 61218.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73166.0469; val_chrom_access_recon_loss: 3757198.3167; val_global_loss: 16987914.4000; val_optim_loss: 16987914.4000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9747; val_auprc_score: 0.9684; val_best_acc_score: 0.9286; val_best_f1_score: 0.9307; train_kl_reg_loss: 51653.9694; train_edge_recon_loss: 2667391.0954; train_gene_expr_recon_loss: 10323920.6794; train_masked_gp_l1_reg_loss: 60772.6769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72964.3560; train_chrom_access_recon_loss: 3762321.0782; train_global_loss: 16939023.8397; train_optim_loss: 16939023.8397; val_kl_reg_loss: 46487.8292; val_edge_recon_loss: 2690069.9167; val_gene_expr_recon_loss: 10320883.3333; val_masked_gp_l1_reg_loss: 60409.8008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72556.0000; val_chrom_access_recon_loss: 3737226.3500; val_global_loss: 16927633.4000; val_optim_loss: 16927633.4000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9752; val_auprc_score: 0.9665; val_best_acc_score: 0.9303; val_best_f1_score: 0.9330; train_kl_reg_loss: 51723.6092; train_edge_recon_loss: 2664772.5935; train_gene_expr_recon_loss: 10297225.3893; train_masked_gp_l1_reg_loss: 60070.3705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72432.5577; train_chrom_access_recon_loss: 3749098.7500; train_global_loss: 16895323.2824; train_optim_loss: 16895323.2824; val_kl_reg_loss: 49670.7016; val_edge_recon_loss: 2677872.3500; val_gene_expr_recon_loss: 10361186.1333; val_masked_gp_l1_reg_loss: 59852.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72580.7812; val_chrom_access_recon_loss: 3729699.1500; val_global_loss: 16950862.2667; val_optim_loss: 16950862.2667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9758; val_auprc_score: 0.9667; val_best_acc_score: 0.9332; val_best_f1_score: 0.9352; train_kl_reg_loss: 51902.3476; train_edge_recon_loss: 2663193.9905; train_gene_expr_recon_loss: 10292234.4809; train_masked_gp_l1_reg_loss: 59522.5918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72285.1486; train_chrom_access_recon_loss: 3743977.8111; train_global_loss: 16883116.4122; train_optim_loss: 16883116.4122; val_kl_reg_loss: 47729.8555; val_edge_recon_loss: 2673888.2833; val_gene_expr_recon_loss: 10307343.4667; val_masked_gp_l1_reg_loss: 59143.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71819.9453; val_chrom_access_recon_loss: 3715353.4667; val_global_loss: 16875279.1333; val_optim_loss: 16875279.1333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9772; val_auprc_score: 0.9683; val_best_acc_score: 0.9344; val_best_f1_score: 0.9358; train_kl_reg_loss: 50631.1065; train_edge_recon_loss: 2659928.9351; train_gene_expr_recon_loss: 10277920.1527; train_masked_gp_l1_reg_loss: 59021.5955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71871.1093; train_chrom_access_recon_loss: 3740136.0992; train_global_loss: 16859509.0305; train_optim_loss: 16859509.0305; val_kl_reg_loss: 47303.1969; val_edge_recon_loss: 2669064.1167; val_gene_expr_recon_loss: 10342445.0667; val_masked_gp_l1_reg_loss: 58827.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71551.0781; val_chrom_access_recon_loss: 3722162.8500; val_global_loss: 16911354.4000; val_optim_loss: 16911354.4000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9767; val_auprc_score: 0.9658; val_best_acc_score: 0.9371; val_best_f1_score: 0.9393; train_kl_reg_loss: 50283.3655; train_edge_recon_loss: 2661436.6260; train_gene_expr_recon_loss: 10268429.4885; train_masked_gp_l1_reg_loss: 58645.3585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71552.3205; train_chrom_access_recon_loss: 3734811.9408; train_global_loss: 16845159.1756; train_optim_loss: 16845159.1756; val_kl_reg_loss: 48197.6336; val_edge_recon_loss: 2676908.6000; val_gene_expr_recon_loss: 10354704.9333; val_masked_gp_l1_reg_loss: 58389.6523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71577.9766; val_chrom_access_recon_loss: 3720924.4000; val_global_loss: 16930703.4000; val_optim_loss: 16930703.4000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9762; val_auprc_score: 0.9669; val_best_acc_score: 0.9326; val_best_f1_score: 0.9348; train_kl_reg_loss: 50890.9476; train_edge_recon_loss: 2661902.4714; train_gene_expr_recon_loss: 10271707.5267; train_masked_gp_l1_reg_loss: 58229.4927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71034.5355; train_chrom_access_recon_loss: 3736135.6145; train_global_loss: 16849900.5954; train_optim_loss: 16849900.5954; val_kl_reg_loss: 48204.6435; val_edge_recon_loss: 2676153.5833; val_gene_expr_recon_loss: 10330859.9333; val_masked_gp_l1_reg_loss: 58019.1523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70892.3906; val_chrom_access_recon_loss: 3727400.1167; val_global_loss: 16911529.1333; val_optim_loss: 16911529.1333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9761; val_auprc_score: 0.9665; val_best_acc_score: 0.9357; val_best_f1_score: 0.9377; train_kl_reg_loss: 50785.1985; train_edge_recon_loss: 2659678.4160; train_gene_expr_recon_loss: 10253751.5725; train_masked_gp_l1_reg_loss: 57772.2367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70627.8649; train_chrom_access_recon_loss: 3726759.5076; train_global_loss: 16819374.7328; train_optim_loss: 16819374.7328; val_kl_reg_loss: 47010.2305; val_edge_recon_loss: 2688047.5333; val_gene_expr_recon_loss: 10299266.4667; val_masked_gp_l1_reg_loss: 57516.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70509.7422; val_chrom_access_recon_loss: 3710426.7000; val_global_loss: 16872777.9333; val_optim_loss: 16872777.9333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9786; val_auprc_score: 0.9725; val_best_acc_score: 0.9391; val_best_f1_score: 0.9403; train_kl_reg_loss: 50124.2708; train_edge_recon_loss: 2654245.4523; train_gene_expr_recon_loss: 10249083.6718; train_masked_gp_l1_reg_loss: 57352.0274; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70244.3556; train_chrom_access_recon_loss: 3724541.5172; train_global_loss: 16805591.2977; train_optim_loss: 16805591.2977; val_kl_reg_loss: 47587.9630; val_edge_recon_loss: 2663382.4000; val_gene_expr_recon_loss: 10307624.2667; val_masked_gp_l1_reg_loss: 57219.7461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70260.2891; val_chrom_access_recon_loss: 3716391.0667; val_global_loss: 16862465.8000; val_optim_loss: 16862465.8000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9779; val_auprc_score: 0.9721; val_best_acc_score: 0.9402; val_best_f1_score: 0.9414; train_kl_reg_loss: 50021.7258; train_edge_recon_loss: 2657490.6317; train_gene_expr_recon_loss: 10241827.6718; train_masked_gp_l1_reg_loss: 57082.5398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69958.2074; train_chrom_access_recon_loss: 3720358.7958; train_global_loss: 16796739.5878; train_optim_loss: 16796739.5878; val_kl_reg_loss: 47574.3706; val_edge_recon_loss: 2670314.8000; val_gene_expr_recon_loss: 10235523.4667; val_masked_gp_l1_reg_loss: 56941.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69960.2109; val_chrom_access_recon_loss: 3700629.2500; val_global_loss: 16780942.6667; val_optim_loss: 16780942.6667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9794; val_auprc_score: 0.9721; val_best_acc_score: 0.9379; val_best_f1_score: 0.9392; train_kl_reg_loss: 49109.3090; train_edge_recon_loss: 2663351.9847; train_gene_expr_recon_loss: 10239972.7099; train_masked_gp_l1_reg_loss: 56821.7764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69796.8010; train_chrom_access_recon_loss: 3725425.3092; train_global_loss: 16804477.8092; train_optim_loss: 16804477.8092; val_kl_reg_loss: 48008.0505; val_edge_recon_loss: 2669850.2667; val_gene_expr_recon_loss: 10235122.0000; val_masked_gp_l1_reg_loss: 56751.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69307.4609; val_chrom_access_recon_loss: 3690078.8333; val_global_loss: 16769118.2000; val_optim_loss: 16769118.2000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9810; val_auprc_score: 0.9778; val_best_acc_score: 0.9365; val_best_f1_score: 0.9383; train_kl_reg_loss: 49013.2491; train_edge_recon_loss: 2656296.2672; train_gene_expr_recon_loss: 10216804.7252; train_masked_gp_l1_reg_loss: 56517.3479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69331.4701; train_chrom_access_recon_loss: 3715557.5802; train_global_loss: 16763520.6947; train_optim_loss: 16763520.6947; val_kl_reg_loss: 48413.0638; val_edge_recon_loss: 2659631.9833; val_gene_expr_recon_loss: 10285626.6000; val_masked_gp_l1_reg_loss: 56324.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69097.2656; val_chrom_access_recon_loss: 3700511.4333; val_global_loss: 16819604.8667; val_optim_loss: 16819604.8667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9793; val_auprc_score: 0.9738; val_best_acc_score: 0.9380; val_best_f1_score: 0.9398; train_kl_reg_loss: 49224.6721; train_edge_recon_loss: 2656970.4618; train_gene_expr_recon_loss: 10223007.4809; train_masked_gp_l1_reg_loss: 56146.9207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69024.1599; train_chrom_access_recon_loss: 3717517.8473; train_global_loss: 16771891.4962; train_optim_loss: 16771891.4962; val_kl_reg_loss: 49431.8323; val_edge_recon_loss: 2677146.1000; val_gene_expr_recon_loss: 10272659.6000; val_masked_gp_l1_reg_loss: 55897.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68408.6797; val_chrom_access_recon_loss: 3698116.6500; val_global_loss: 16821660.0000; val_optim_loss: 16821660.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9777; val_auprc_score: 0.9670; val_best_acc_score: 0.9330; val_best_f1_score: 0.9351; train_kl_reg_loss: 49827.7290; train_edge_recon_loss: 2655724.2214; train_gene_expr_recon_loss: 10209421.4733; train_masked_gp_l1_reg_loss: 55781.6631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68779.4889; train_chrom_access_recon_loss: 3712427.0916; train_global_loss: 16751961.5344; train_optim_loss: 16751961.5344; val_kl_reg_loss: 47840.0701; val_edge_recon_loss: 2688724.6333; val_gene_expr_recon_loss: 10254097.2667; val_masked_gp_l1_reg_loss: 55634.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69088.7422; val_chrom_access_recon_loss: 3686520.2667; val_global_loss: 16801905.0000; val_optim_loss: 16801905.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9809; val_auprc_score: 0.9747; val_best_acc_score: 0.9406; val_best_f1_score: 0.9418; train_kl_reg_loss: 48701.4443; train_edge_recon_loss: 2654849.5515; train_gene_expr_recon_loss: 10210147.4275; train_masked_gp_l1_reg_loss: 55543.2451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68677.1908; train_chrom_access_recon_loss: 3703861.0038; train_global_loss: 16741779.8092; train_optim_loss: 16741779.8092; val_kl_reg_loss: 45208.8568; val_edge_recon_loss: 2677587.9000; val_gene_expr_recon_loss: 10261053.4667; val_masked_gp_l1_reg_loss: 55470.5117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68727.0000; val_chrom_access_recon_loss: 3673455.7167; val_global_loss: 16781503.9333; val_optim_loss: 16781503.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9815; val_auprc_score: 0.9770; val_best_acc_score: 0.9395; val_best_f1_score: 0.9409; train_kl_reg_loss: 48583.9197; train_edge_recon_loss: 2655769.5573; train_gene_expr_recon_loss: 10195284.0153; train_masked_gp_l1_reg_loss: 54981.5639; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57655.9928; train_chrom_access_recon_loss: 3702333.2347; train_global_loss: 16714608.2824; train_optim_loss: 16714608.2824; val_kl_reg_loss: 47040.2409; val_edge_recon_loss: 2669408.8333; val_gene_expr_recon_loss: 10200201.3333; val_masked_gp_l1_reg_loss: 54789.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55970.3398; val_chrom_access_recon_loss: 3670087.6333; val_global_loss: 16697498.0000; val_optim_loss: 16697498.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9818; val_auprc_score: 0.9742; val_best_acc_score: 0.9411; val_best_f1_score: 0.9429; train_kl_reg_loss: 50174.7331; train_edge_recon_loss: 2651940.9332; train_gene_expr_recon_loss: 10193951.4046; train_masked_gp_l1_reg_loss: 54726.9034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55520.3354; train_chrom_access_recon_loss: 3702101.5534; train_global_loss: 16708415.8397; train_optim_loss: 16708415.8397; val_kl_reg_loss: 47957.8854; val_edge_recon_loss: 2648839.6167; val_gene_expr_recon_loss: 10206061.2667; val_masked_gp_l1_reg_loss: 54698.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55171.7070; val_chrom_access_recon_loss: 3665752.7500; val_global_loss: 16678482.4000; val_optim_loss: 16678482.4000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9800; val_auprc_score: 0.9732; val_best_acc_score: 0.9419; val_best_f1_score: 0.9435; train_kl_reg_loss: 50518.0045; train_edge_recon_loss: 2649840.3263; train_gene_expr_recon_loss: 10199577.1985; train_masked_gp_l1_reg_loss: 54673.7540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54947.6917; train_chrom_access_recon_loss: 3703703.1050; train_global_loss: 16713260.2519; train_optim_loss: 16713260.2519; val_kl_reg_loss: 48535.6857; val_edge_recon_loss: 2653638.5000; val_gene_expr_recon_loss: 10257274.0000; val_masked_gp_l1_reg_loss: 54641.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54669.2227; val_chrom_access_recon_loss: 3681834.1833; val_global_loss: 16750593.4667; val_optim_loss: 16750593.4667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9815; val_auprc_score: 0.9738; val_best_acc_score: 0.9448; val_best_f1_score: 0.9459; train_kl_reg_loss: 50808.9679; train_edge_recon_loss: 2651448.0305; train_gene_expr_recon_loss: 10193771.1298; train_masked_gp_l1_reg_loss: 54621.0608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54497.4046; train_chrom_access_recon_loss: 3703695.0553; train_global_loss: 16708841.6260; train_optim_loss: 16708841.6260; val_kl_reg_loss: 48887.4409; val_edge_recon_loss: 2656507.2167; val_gene_expr_recon_loss: 10206610.2667; val_masked_gp_l1_reg_loss: 54603.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54337.1992; val_chrom_access_recon_loss: 3662101.3667; val_global_loss: 16683046.2000; val_optim_loss: 16683046.2000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9808; val_auprc_score: 0.9708; val_best_acc_score: 0.9419; val_best_f1_score: 0.9431; train_kl_reg_loss: 51141.2861; train_edge_recon_loss: 2648967.3607; train_gene_expr_recon_loss: 10190616.9847; train_masked_gp_l1_reg_loss: 54584.8299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54140.1972; train_chrom_access_recon_loss: 3699225.6260; train_global_loss: 16698676.2748; train_optim_loss: 16698676.2748; val_kl_reg_loss: 49481.0474; val_edge_recon_loss: 2646396.0167; val_gene_expr_recon_loss: 10263755.2667; val_masked_gp_l1_reg_loss: 54559.4102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53985.0117; val_chrom_access_recon_loss: 3687778.8000; val_global_loss: 16755955.0000; val_optim_loss: 16755955.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9793; val_auprc_score: 0.9726; val_best_acc_score: 0.9414; val_best_f1_score: 0.9428; train_kl_reg_loss: 51696.5406; train_edge_recon_loss: 2652435.5191; train_gene_expr_recon_loss: 10195401.4733; train_masked_gp_l1_reg_loss: 54535.1359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53820.4628; train_chrom_access_recon_loss: 3703422.7366; train_global_loss: 16711311.8931; train_optim_loss: 16711311.8931; val_kl_reg_loss: 49033.0365; val_edge_recon_loss: 2660245.9667; val_gene_expr_recon_loss: 10221636.7333; val_masked_gp_l1_reg_loss: 54510.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53611.3828; val_chrom_access_recon_loss: 3685642.7667; val_global_loss: 16724680.6667; val_optim_loss: 16724680.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9806; val_auprc_score: 0.9757; val_best_acc_score: 0.9404; val_best_f1_score: 0.9418; train_kl_reg_loss: 51078.4709; train_edge_recon_loss: 2652295.5802; train_gene_expr_recon_loss: 10182066.5115; train_masked_gp_l1_reg_loss: 54461.2716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52475.7302; train_chrom_access_recon_loss: 3696369.0668; train_global_loss: 16688746.6641; train_optim_loss: 16688746.6641; val_kl_reg_loss: 49164.4352; val_edge_recon_loss: 2669895.8833; val_gene_expr_recon_loss: 10215439.6667; val_masked_gp_l1_reg_loss: 54441.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52306.9805; val_chrom_access_recon_loss: 3675621.1833; val_global_loss: 16716869.2000; val_optim_loss: 16716869.2000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9825; val_auprc_score: 0.9763; val_best_acc_score: 0.9441; val_best_f1_score: 0.9455; train_kl_reg_loss: 51255.4314; train_edge_recon_loss: 2653878.6011; train_gene_expr_recon_loss: 10194907.8092; train_masked_gp_l1_reg_loss: 54431.7805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52259.8772; train_chrom_access_recon_loss: 3702486.7653; train_global_loss: 16709220.2214; train_optim_loss: 16709220.2214; val_kl_reg_loss: 49401.8359; val_edge_recon_loss: 2652616.7333; val_gene_expr_recon_loss: 10240033.6000; val_masked_gp_l1_reg_loss: 54424.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52213.5508; val_chrom_access_recon_loss: 3684944.5833; val_global_loss: 16733635.6667; val_optim_loss: 16733635.6667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9795; val_auprc_score: 0.9720; val_best_acc_score: 0.9386; val_best_f1_score: 0.9408; train_kl_reg_loss: 51302.6133; train_edge_recon_loss: 2653194.5439; train_gene_expr_recon_loss: 10183739.8473; train_masked_gp_l1_reg_loss: 54418.2892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52175.1202; train_chrom_access_recon_loss: 3697541.2557; train_global_loss: 16692371.7634; train_optim_loss: 16692371.7634; val_kl_reg_loss: 48975.0745; val_edge_recon_loss: 2659223.0167; val_gene_expr_recon_loss: 10201476.5333; val_masked_gp_l1_reg_loss: 54414.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52138.7070; val_chrom_access_recon_loss: 3677869.8333; val_global_loss: 16694097.4667; val_optim_loss: 16694097.4667
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9799; val_auprc_score: 0.9742; val_best_acc_score: 0.9386; val_best_f1_score: 0.9404; train_kl_reg_loss: 51198.8094; train_edge_recon_loss: 2647739.5897; train_gene_expr_recon_loss: 10191399.5344; train_masked_gp_l1_reg_loss: 54410.8452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52116.5912; train_chrom_access_recon_loss: 3702882.1908; train_global_loss: 16699747.7023; train_optim_loss: 16699747.7023; val_kl_reg_loss: 49352.2133; val_edge_recon_loss: 2655207.5500; val_gene_expr_recon_loss: 10229144.0000; val_masked_gp_l1_reg_loss: 54406.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52088.3984; val_chrom_access_recon_loss: 3659777.1167; val_global_loss: 16699976.1333; val_optim_loss: 16699976.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 52 min 18 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9792
val AUPRC score: 0.9711
val best accuracy score: 0.9388
val best F1 score: 0.9402
val target rna MSE score: 1.4909
val source rna MSE score: 0.4982
val target atac MSE score: 0.4866
val source atac MSE score: 0.1490
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
