[True]
Run timestamp: 26072023_032025_113.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_113']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9633; val_auprc_score: 0.9646; val_best_acc_score: 0.8189; val_best_f1_score: 0.8444; train_kl_reg_loss: 906.1999; train_edge_recon_loss: 34651488.8889; train_gene_expr_recon_loss: 320115.8993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1078523.7222; train_global_loss: 36051035.1111; train_optim_loss: 36051035.1111; val_kl_reg_loss: 359.9856; val_edge_recon_loss: 39690576.0000; val_gene_expr_recon_loss: 328058.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1101656.3750; val_global_loss: 41120652.0000; val_optim_loss: 41120652.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8888; val_auprc_score: 0.8769; val_best_acc_score: 0.8015; val_best_f1_score: 0.8154; train_kl_reg_loss: 627.8389; train_edge_recon_loss: 34319080.4444; train_gene_expr_recon_loss: 317433.1910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1081179.4167; train_global_loss: 35718320.8889; train_optim_loss: 35718320.8889; val_kl_reg_loss: 1674.0374; val_edge_recon_loss: 32170122.0000; val_gene_expr_recon_loss: 325516.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1101310.6250; val_global_loss: 33598624.0000; val_optim_loss: 33598624.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8796; val_auprc_score: 0.8733; val_best_acc_score: 0.7832; val_best_f1_score: 0.7961; train_kl_reg_loss: 8146.8985; train_edge_recon_loss: 30226070.6667; train_gene_expr_recon_loss: 317411.7743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1077042.7500; train_global_loss: 31628672.0000; train_optim_loss: 31628672.0000; val_kl_reg_loss: 22667.7031; val_edge_recon_loss: 28363692.0000; val_gene_expr_recon_loss: 328506.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1101021.1250; val_global_loss: 29815888.0000; val_optim_loss: 29815888.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8804; val_auprc_score: 0.8634; val_best_acc_score: 0.7862; val_best_f1_score: 0.8089; train_kl_reg_loss: 33922.6254; train_edge_recon_loss: 28243497.1111; train_gene_expr_recon_loss: 313799.0625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1071818.1528; train_global_loss: 29663037.7778; train_optim_loss: 29663037.7778; val_kl_reg_loss: 43868.7031; val_edge_recon_loss: 28004124.0000; val_gene_expr_recon_loss: 320283.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1097350.2500; val_global_loss: 29465626.0000; val_optim_loss: 29465626.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9023; val_auprc_score: 0.8755; val_best_acc_score: 0.8316; val_best_f1_score: 0.8448; train_kl_reg_loss: 49036.4874; train_edge_recon_loss: 27821572.8889; train_gene_expr_recon_loss: 310226.6736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1066803.2014; train_global_loss: 29247639.1111; train_optim_loss: 29247639.1111; val_kl_reg_loss: 52672.4141; val_edge_recon_loss: 27434492.0000; val_gene_expr_recon_loss: 318952.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1093261.6250; val_global_loss: 28899378.0000; val_optim_loss: 28899378.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9154; val_auprc_score: 0.8871; val_best_acc_score: 0.8570; val_best_f1_score: 0.8673; train_kl_reg_loss: 54059.8572; train_edge_recon_loss: 27364300.8889; train_gene_expr_recon_loss: 307164.6528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1063277.7431; train_global_loss: 28788802.6667; train_optim_loss: 28788802.6667; val_kl_reg_loss: 55587.0703; val_edge_recon_loss: 27254928.0000; val_gene_expr_recon_loss: 316856.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1093054.3750; val_global_loss: 28720426.0000; val_optim_loss: 28720426.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9259; val_auprc_score: 0.9057; val_best_acc_score: 0.8618; val_best_f1_score: 0.8697; train_kl_reg_loss: 55601.3372; train_edge_recon_loss: 27044544.4444; train_gene_expr_recon_loss: 307398.7604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1064024.1944; train_global_loss: 28471567.7778; train_optim_loss: 28471567.7778; val_kl_reg_loss: 55854.4336; val_edge_recon_loss: 27214256.0000; val_gene_expr_recon_loss: 324304.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1088730.5000; val_global_loss: 28683144.0000; val_optim_loss: 28683144.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9272; val_auprc_score: 0.9060; val_best_acc_score: 0.8639; val_best_f1_score: 0.8712; train_kl_reg_loss: 53849.7352; train_edge_recon_loss: 26990266.8889; train_gene_expr_recon_loss: 307649.7257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1061666.5139; train_global_loss: 28413432.8889; train_optim_loss: 28413432.8889; val_kl_reg_loss: 53103.8555; val_edge_recon_loss: 27105612.0000; val_gene_expr_recon_loss: 315318.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1086515.7500; val_global_loss: 28560550.0000; val_optim_loss: 28560550.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9321; val_auprc_score: 0.9105; val_best_acc_score: 0.8717; val_best_f1_score: 0.8780; train_kl_reg_loss: 49953.3802; train_edge_recon_loss: 26972774.6667; train_gene_expr_recon_loss: 303783.3542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1062406.9028; train_global_loss: 28388918.4444; train_optim_loss: 28388918.4444; val_kl_reg_loss: 48905.7969; val_edge_recon_loss: 27045388.0000; val_gene_expr_recon_loss: 313306.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1082373.8750; val_global_loss: 28489974.0000; val_optim_loss: 28489974.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9438; val_auprc_score: 0.9249; val_best_acc_score: 0.8875; val_best_f1_score: 0.8938; train_kl_reg_loss: 45193.6359; train_edge_recon_loss: 26855634.0000; train_gene_expr_recon_loss: 301635.3403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1058709.4236; train_global_loss: 28261172.4444; train_optim_loss: 28261172.4444; val_kl_reg_loss: 43618.4805; val_edge_recon_loss: 27037736.0000; val_gene_expr_recon_loss: 310374.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1084083.0000; val_global_loss: 28475812.0000; val_optim_loss: 28475812.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9492; val_auprc_score: 0.9296; val_best_acc_score: 0.8950; val_best_f1_score: 0.9002; train_kl_reg_loss: 41552.8980; train_edge_recon_loss: 26816185.1111; train_gene_expr_recon_loss: 301132.4479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1058760.0833; train_global_loss: 28217630.2222; train_optim_loss: 28217630.2222; val_kl_reg_loss: 39662.0000; val_edge_recon_loss: 26691052.0000; val_gene_expr_recon_loss: 310042.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1085985.7500; val_global_loss: 28126742.0000; val_optim_loss: 28126742.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9572; val_auprc_score: 0.9393; val_best_acc_score: 0.9085; val_best_f1_score: 0.9117; train_kl_reg_loss: 38241.9674; train_edge_recon_loss: 26613695.1111; train_gene_expr_recon_loss: 298584.0174; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1056145.1042; train_global_loss: 28006666.2222; train_optim_loss: 28006666.2222; val_kl_reg_loss: 37467.8516; val_edge_recon_loss: 26403740.0000; val_gene_expr_recon_loss: 310824.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1083891.3750; val_global_loss: 27835924.0000; val_optim_loss: 27835924.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9604; val_auprc_score: 0.9456; val_best_acc_score: 0.9086; val_best_f1_score: 0.9125; train_kl_reg_loss: 36990.6215; train_edge_recon_loss: 26541820.6667; train_gene_expr_recon_loss: 298049.2257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1059516.4236; train_global_loss: 27936376.8889; train_optim_loss: 27936376.8889; val_kl_reg_loss: 36772.7891; val_edge_recon_loss: 26472476.0000; val_gene_expr_recon_loss: 307345.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1085428.7500; val_global_loss: 27902022.0000; val_optim_loss: 27902022.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9562; val_auprc_score: 0.9379; val_best_acc_score: 0.9054; val_best_f1_score: 0.9104; train_kl_reg_loss: 36932.2483; train_edge_recon_loss: 26396549.1111; train_gene_expr_recon_loss: 295795.1354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1059516.7431; train_global_loss: 27788793.3333; train_optim_loss: 27788793.3333; val_kl_reg_loss: 37854.1094; val_edge_recon_loss: 26628694.0000; val_gene_expr_recon_loss: 307333.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1081143.5000; val_global_loss: 28055026.0000; val_optim_loss: 28055026.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9619; val_auprc_score: 0.9449; val_best_acc_score: 0.9088; val_best_f1_score: 0.9131; train_kl_reg_loss: 37403.9379; train_edge_recon_loss: 26386480.4444; train_gene_expr_recon_loss: 294437.4340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1057016.7986; train_global_loss: 27775338.2222; train_optim_loss: 27775338.2222; val_kl_reg_loss: 38054.2109; val_edge_recon_loss: 26590500.0000; val_gene_expr_recon_loss: 301857.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1077502.1250; val_global_loss: 28007914.0000; val_optim_loss: 28007914.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9630; val_auprc_score: 0.9479; val_best_acc_score: 0.9179; val_best_f1_score: 0.9213; train_kl_reg_loss: 37086.7201; train_edge_recon_loss: 26376616.2222; train_gene_expr_recon_loss: 291719.4097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1049423.0278; train_global_loss: 27754845.3333; train_optim_loss: 27754845.3333; val_kl_reg_loss: 36891.4297; val_edge_recon_loss: 26431376.0000; val_gene_expr_recon_loss: 303236.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1078204.0000; val_global_loss: 27849708.0000; val_optim_loss: 27849708.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9647; val_auprc_score: 0.9492; val_best_acc_score: 0.9158; val_best_f1_score: 0.9195; train_kl_reg_loss: 36384.3086; train_edge_recon_loss: 26366039.7778; train_gene_expr_recon_loss: 291307.7674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1048004.4236; train_global_loss: 27741736.2222; train_optim_loss: 27741736.2222; val_kl_reg_loss: 36971.0586; val_edge_recon_loss: 26443514.0000; val_gene_expr_recon_loss: 299238.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1075151.8750; val_global_loss: 27854876.0000; val_optim_loss: 27854876.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9653; val_auprc_score: 0.9517; val_best_acc_score: 0.9169; val_best_f1_score: 0.9198; train_kl_reg_loss: 36448.6220; train_edge_recon_loss: 26409779.7778; train_gene_expr_recon_loss: 291744.5278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1055778.2431; train_global_loss: 27793750.6667; train_optim_loss: 27793750.6667; val_kl_reg_loss: 36687.7969; val_edge_recon_loss: 26476378.0000; val_gene_expr_recon_loss: 301716.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1077102.5000; val_global_loss: 27891884.0000; val_optim_loss: 27891884.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9633; val_auprc_score: 0.9470; val_best_acc_score: 0.9198; val_best_f1_score: 0.9233; train_kl_reg_loss: 36374.8420; train_edge_recon_loss: 26358343.3333; train_gene_expr_recon_loss: 291468.9826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1053969.9167; train_global_loss: 27740156.8889; train_optim_loss: 27740156.8889; val_kl_reg_loss: 36168.8594; val_edge_recon_loss: 26348248.0000; val_gene_expr_recon_loss: 299976.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1075311.0000; val_global_loss: 27759704.0000; val_optim_loss: 27759704.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9608; val_auprc_score: 0.9438; val_best_acc_score: 0.9169; val_best_f1_score: 0.9207; train_kl_reg_loss: 35662.1875; train_edge_recon_loss: 26366776.0000; train_gene_expr_recon_loss: 291188.6354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1051298.9236; train_global_loss: 27744926.6667; train_optim_loss: 27744926.6667; val_kl_reg_loss: 36056.0078; val_edge_recon_loss: 26610038.0000; val_gene_expr_recon_loss: 300298.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1076199.0000; val_global_loss: 28022592.0000; val_optim_loss: 28022592.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9687; val_auprc_score: 0.9565; val_best_acc_score: 0.9198; val_best_f1_score: 0.9239; train_kl_reg_loss: 35480.1332; train_edge_recon_loss: 26428889.5556; train_gene_expr_recon_loss: 291211.0451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1051832.2083; train_global_loss: 27807413.1111; train_optim_loss: 27807413.1111; val_kl_reg_loss: 36079.9609; val_edge_recon_loss: 26318750.0000; val_gene_expr_recon_loss: 300476.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1076160.6250; val_global_loss: 27731466.0000; val_optim_loss: 27731466.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9645; val_auprc_score: 0.9497; val_best_acc_score: 0.9169; val_best_f1_score: 0.9200; train_kl_reg_loss: 35409.2791; train_edge_recon_loss: 26304072.4444; train_gene_expr_recon_loss: 292219.3403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1055410.5972; train_global_loss: 27687111.1111; train_optim_loss: 27687111.1111; val_kl_reg_loss: 35883.5039; val_edge_recon_loss: 26498876.0000; val_gene_expr_recon_loss: 299475.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1073585.5000; val_global_loss: 27907822.0000; val_optim_loss: 27907822.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9632; val_auprc_score: 0.9481; val_best_acc_score: 0.9167; val_best_f1_score: 0.9203; train_kl_reg_loss: 35392.6337; train_edge_recon_loss: 26305866.6667; train_gene_expr_recon_loss: 291305.1354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1050624.2153; train_global_loss: 27683189.3333; train_optim_loss: 27683189.3333; val_kl_reg_loss: 35351.0781; val_edge_recon_loss: 26511446.0000; val_gene_expr_recon_loss: 299977.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1074944.2500; val_global_loss: 27921720.0000; val_optim_loss: 27921720.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9641; val_auprc_score: 0.9457; val_best_acc_score: 0.9166; val_best_f1_score: 0.9199; train_kl_reg_loss: 35089.6840; train_edge_recon_loss: 26343969.1111; train_gene_expr_recon_loss: 289870.6806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1052103.9583; train_global_loss: 27721033.5556; train_optim_loss: 27721033.5556; val_kl_reg_loss: 35359.5898; val_edge_recon_loss: 26593658.0000; val_gene_expr_recon_loss: 299481.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1074891.8750; val_global_loss: 28003392.0000; val_optim_loss: 28003392.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9652; val_auprc_score: 0.9479; val_best_acc_score: 0.9185; val_best_f1_score: 0.9220; train_kl_reg_loss: 35019.2999; train_edge_recon_loss: 26287378.6667; train_gene_expr_recon_loss: 292386.2535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1055063.7569; train_global_loss: 27669847.3333; train_optim_loss: 27669847.3333; val_kl_reg_loss: 35164.9531; val_edge_recon_loss: 26402444.0000; val_gene_expr_recon_loss: 299594.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1075549.6250; val_global_loss: 27812752.0000; val_optim_loss: 27812752.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9655; val_auprc_score: 0.9529; val_best_acc_score: 0.9167; val_best_f1_score: 0.9199; train_kl_reg_loss: 35252.8559; train_edge_recon_loss: 26380002.2222; train_gene_expr_recon_loss: 291350.8368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1054084.1875; train_global_loss: 27760690.2222; train_optim_loss: 27760690.2222; val_kl_reg_loss: 29173.8555; val_edge_recon_loss: 26572042.0000; val_gene_expr_recon_loss: 300061.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1075270.2500; val_global_loss: 27976548.0000; val_optim_loss: 27976548.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9666; val_auprc_score: 0.9520; val_best_acc_score: 0.9201; val_best_f1_score: 0.9243; train_kl_reg_loss: 35175.1567; train_edge_recon_loss: 26334608.4444; train_gene_expr_recon_loss: 291342.5069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1053368.5972; train_global_loss: 27714494.2222; train_optim_loss: 27714494.2222; val_kl_reg_loss: 29375.0996; val_edge_recon_loss: 26369124.0000; val_gene_expr_recon_loss: 300397.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1075934.0000; val_global_loss: 27774832.0000; val_optim_loss: 27774832.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9646; val_auprc_score: 0.9464; val_best_acc_score: 0.9220; val_best_f1_score: 0.9246; train_kl_reg_loss: 34777.1085; train_edge_recon_loss: 26378958.8889; train_gene_expr_recon_loss: 292190.5868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1054259.7222; train_global_loss: 27760186.2222; train_optim_loss: 27760186.2222; val_kl_reg_loss: 29249.6211; val_edge_recon_loss: 26405508.0000; val_gene_expr_recon_loss: 300817.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1076261.6250; val_global_loss: 27811838.0000; val_optim_loss: 27811838.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9607; val_auprc_score: 0.9419; val_best_acc_score: 0.9146; val_best_f1_score: 0.9188; train_kl_reg_loss: 35235.0777; train_edge_recon_loss: 26312575.3333; train_gene_expr_recon_loss: 290641.4722; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 1051167.7431; train_global_loss: 27689619.7778; train_optim_loss: 27689619.7778; val_kl_reg_loss: 29151.5156; val_edge_recon_loss: 26517084.0000; val_gene_expr_recon_loss: 300894.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 1075445.6250; val_global_loss: 27922576.0000; val_optim_loss: 27922576.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 55 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
Val AUROC score: 0.9603
Val AUPRC score: 0.9409
Val best accuracy score: 0.9124
Val best F1 score: 0.9168
Val gene expr MSE score: 0.9101
Val chrom access MSE score: 0.0946
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
