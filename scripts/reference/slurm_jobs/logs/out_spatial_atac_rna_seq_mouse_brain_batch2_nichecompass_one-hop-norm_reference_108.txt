[True]
Run timestamp: 26072023_031338_108.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '30000', '--lambda_chrom_access_recon', '30000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_108']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2098, n_latent: 2098, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2098, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9027; val_auprc_score: 0.9124; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 13398.9922; train_edge_recon_loss: 3500182.3056; train_gene_expr_recon_loss: 32016813.5556; train_masked_gp_l1_reg_loss: 1933.4605; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 107439376.0000; train_global_loss: 142971706.6667; train_optim_loss: 142971706.6667; val_kl_reg_loss: 69991.7031; val_edge_recon_loss: 4065791.2500; val_gene_expr_recon_loss: 30335218.0000; val_masked_gp_l1_reg_loss: 2004.0651; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 106995056.0000; val_global_loss: 141468064.0000; val_optim_loss: 141468064.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8734; val_auprc_score: 0.8822; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 78828.9922; train_edge_recon_loss: 3595376.9722; train_gene_expr_recon_loss: 28756559.3333; train_masked_gp_l1_reg_loss: 2112.7694; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 106709907.5556; train_global_loss: 139142785.7778; train_optim_loss: 139142785.7778; val_kl_reg_loss: 71358.3594; val_edge_recon_loss: 4065945.5000; val_gene_expr_recon_loss: 27154844.0000; val_masked_gp_l1_reg_loss: 2264.1675; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 104489544.0000; val_global_loss: 135783952.0000; val_optim_loss: 135783952.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8841; val_auprc_score: 0.8917; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 104453.9731; train_edge_recon_loss: 3685120.0000; train_gene_expr_recon_loss: 26101909.5556; train_masked_gp_l1_reg_loss: 2386.3266; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 102661256.0000; train_global_loss: 132555125.3333; train_optim_loss: 132555125.3333; val_kl_reg_loss: 169493.0938; val_edge_recon_loss: 4066082.0000; val_gene_expr_recon_loss: 24754856.0000; val_masked_gp_l1_reg_loss: 2523.4011; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 102127584.0000; val_global_loss: 131120544.0000; val_optim_loss: 131120544.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8812; val_auprc_score: 0.8883; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 156019.5252; train_edge_recon_loss: 3728851.6944; train_gene_expr_recon_loss: 24383767.1111; train_masked_gp_l1_reg_loss: 2597.7529; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 101559516.4444; train_global_loss: 129830752.0000; train_optim_loss: 129830752.0000; val_kl_reg_loss: 143008.4219; val_edge_recon_loss: 4066112.2500; val_gene_expr_recon_loss: 23754852.0000; val_masked_gp_l1_reg_loss: 2671.3687; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 100962080.0000; val_global_loss: 128928720.0000; val_optim_loss: 128928720.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8836; val_auprc_score: 0.8907; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 168840.2066; train_edge_recon_loss: 3734122.5278; train_gene_expr_recon_loss: 23397811.1111; train_masked_gp_l1_reg_loss: 2706.7663; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 99775931.5556; train_global_loss: 127079411.5556; train_optim_loss: 127079411.5556; val_kl_reg_loss: 150281.1094; val_edge_recon_loss: 4066098.0000; val_gene_expr_recon_loss: 22901688.0000; val_masked_gp_l1_reg_loss: 2740.5605; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99864616.0000; val_global_loss: 126985424.0000; val_optim_loss: 126985424.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8855; val_auprc_score: 0.8904; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 195456.5972; train_edge_recon_loss: 3725938.2222; train_gene_expr_recon_loss: 22601112.4444; train_masked_gp_l1_reg_loss: 2753.2611; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98893464.0000; train_global_loss: 125418724.4444; train_optim_loss: 125418724.4444; val_kl_reg_loss: 207744.8438; val_edge_recon_loss: 4066029.2500; val_gene_expr_recon_loss: 22272540.0000; val_masked_gp_l1_reg_loss: 2761.2910; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 99184640.0000; val_global_loss: 125733712.0000; val_optim_loss: 125733712.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8910; val_auprc_score: 0.8944; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 234040.4601; train_edge_recon_loss: 3699094.0556; train_gene_expr_recon_loss: 21995939.1111; train_masked_gp_l1_reg_loss: 2759.5811; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98133843.5556; train_global_loss: 124065676.4444; train_optim_loss: 124065676.4444; val_kl_reg_loss: 205374.6562; val_edge_recon_loss: 4065887.2500; val_gene_expr_recon_loss: 21765748.0000; val_masked_gp_l1_reg_loss: 2754.5095; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98549560.0000; val_global_loss: 124589328.0000; val_optim_loss: 124589328.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8842; val_auprc_score: 0.8836; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 243757.0642; train_edge_recon_loss: 3697403.7222; train_gene_expr_recon_loss: 21684576.2222; train_masked_gp_l1_reg_loss: 2748.4750; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98045528.8889; train_global_loss: 123674015.1111; train_optim_loss: 123674015.1111; val_kl_reg_loss: 212282.5312; val_edge_recon_loss: 4065655.2500; val_gene_expr_recon_loss: 21479476.0000; val_masked_gp_l1_reg_loss: 2740.7847; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98342752.0000; val_global_loss: 124102904.0000; val_optim_loss: 124102904.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8827; val_auprc_score: 0.8828; val_best_acc_score: 0.5031; val_best_f1_score: 0.6680; train_kl_reg_loss: 250282.8594; train_edge_recon_loss: 3679333.8611; train_gene_expr_recon_loss: 21360507.5556; train_masked_gp_l1_reg_loss: 2734.1302; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97715800.8889; train_global_loss: 123008659.5556; train_optim_loss: 123008659.5556; val_kl_reg_loss: 245394.8438; val_edge_recon_loss: 4065320.0000; val_gene_expr_recon_loss: 21274044.0000; val_masked_gp_l1_reg_loss: 2726.4377; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 98061048.0000; val_global_loss: 123648536.0000; val_optim_loss: 123648536.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8780; val_auprc_score: 0.8777; val_best_acc_score: 0.5104; val_best_f1_score: 0.6713; train_kl_reg_loss: 262316.1823; train_edge_recon_loss: 3663695.1944; train_gene_expr_recon_loss: 21276292.6667; train_masked_gp_l1_reg_loss: 2721.6031; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 98235216.0000; train_global_loss: 123440241.7778; train_optim_loss: 123440241.7778; val_kl_reg_loss: 210493.9531; val_edge_recon_loss: 4064740.2500; val_gene_expr_recon_loss: 21151490.0000; val_masked_gp_l1_reg_loss: 2715.4788; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97943592.0000; val_global_loss: 123373032.0000; val_optim_loss: 123373032.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8726; val_auprc_score: 0.8683; val_best_acc_score: 0.5195; val_best_f1_score: 0.6752; train_kl_reg_loss: 253369.4653; train_edge_recon_loss: 3661467.1944; train_gene_expr_recon_loss: 21101152.6667; train_masked_gp_l1_reg_loss: 2712.3408; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96931928.8889; train_global_loss: 121950631.1111; train_optim_loss: 121950631.1111; val_kl_reg_loss: 230945.5312; val_edge_recon_loss: 4064078.7500; val_gene_expr_recon_loss: 21059800.0000; val_masked_gp_l1_reg_loss: 2709.2427; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97835800.0000; val_global_loss: 123193336.0000; val_optim_loss: 123193336.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8759; val_auprc_score: 0.8750; val_best_acc_score: 0.5384; val_best_f1_score: 0.6834; train_kl_reg_loss: 260835.4583; train_edge_recon_loss: 3648494.7778; train_gene_expr_recon_loss: 21118764.4444; train_masked_gp_l1_reg_loss: 2708.4877; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97921968.8889; train_global_loss: 122952773.3333; train_optim_loss: 122952773.3333; val_kl_reg_loss: 212976.4219; val_edge_recon_loss: 4062943.2500; val_gene_expr_recon_loss: 20989758.0000; val_masked_gp_l1_reg_loss: 2707.7039; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97682472.0000; val_global_loss: 122950856.0000; val_optim_loss: 122950856.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8777; val_auprc_score: 0.8729; val_best_acc_score: 0.5719; val_best_f1_score: 0.6989; train_kl_reg_loss: 250603.8507; train_edge_recon_loss: 3651346.5000; train_gene_expr_recon_loss: 21048581.7778; train_masked_gp_l1_reg_loss: 2708.9418; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97462605.3333; train_global_loss: 122415846.2222; train_optim_loss: 122415846.2222; val_kl_reg_loss: 191848.5625; val_edge_recon_loss: 4061392.5000; val_gene_expr_recon_loss: 20942178.0000; val_masked_gp_l1_reg_loss: 2709.3516; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97604160.0000; val_global_loss: 122802288.0000; val_optim_loss: 122802288.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8860; val_auprc_score: 0.8773; val_best_acc_score: 0.6058; val_best_f1_score: 0.7144; train_kl_reg_loss: 247511.0347; train_edge_recon_loss: 3646115.2222; train_gene_expr_recon_loss: 20847021.1111; train_masked_gp_l1_reg_loss: 2710.7561; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96374366.2222; train_global_loss: 121117723.5556; train_optim_loss: 121117723.5556; val_kl_reg_loss: 213746.2500; val_edge_recon_loss: 4059363.2500; val_gene_expr_recon_loss: 20847626.0000; val_masked_gp_l1_reg_loss: 2713.5901; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97313416.0000; val_global_loss: 122436864.0000; val_optim_loss: 122436864.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8879; val_auprc_score: 0.8810; val_best_acc_score: 0.6752; val_best_f1_score: 0.7500; train_kl_reg_loss: 255534.6337; train_edge_recon_loss: 3627301.1111; train_gene_expr_recon_loss: 20869961.5556; train_masked_gp_l1_reg_loss: 2717.0563; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96906200.8889; train_global_loss: 121661715.5556; train_optim_loss: 121661715.5556; val_kl_reg_loss: 209706.2031; val_edge_recon_loss: 4055518.5000; val_gene_expr_recon_loss: 20797780.0000; val_masked_gp_l1_reg_loss: 2721.5576; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97134800.0000; val_global_loss: 122200528.0000; val_optim_loss: 122200528.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8901; val_auprc_score: 0.8853; val_best_acc_score: 0.7158; val_best_f1_score: 0.7713; train_kl_reg_loss: 241426.4010; train_edge_recon_loss: 3637733.4444; train_gene_expr_recon_loss: 20849523.1111; train_masked_gp_l1_reg_loss: 2725.5637; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97179664.0000; train_global_loss: 121911072.8889; train_optim_loss: 121911072.8889; val_kl_reg_loss: 201900.1562; val_edge_recon_loss: 4051511.5000; val_gene_expr_recon_loss: 20799426.0000; val_masked_gp_l1_reg_loss: 2729.5308; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97259600.0000; val_global_loss: 122315168.0000; val_optim_loss: 122315168.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8949; val_auprc_score: 0.8902; val_best_acc_score: 0.7642; val_best_f1_score: 0.7998; train_kl_reg_loss: 242878.7396; train_edge_recon_loss: 3625928.6389; train_gene_expr_recon_loss: 20769546.6667; train_masked_gp_l1_reg_loss: 2733.8507; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96832612.4444; train_global_loss: 121473700.4444; train_optim_loss: 121473700.4444; val_kl_reg_loss: 213779.9375; val_edge_recon_loss: 4046193.7500; val_gene_expr_recon_loss: 20763506.0000; val_masked_gp_l1_reg_loss: 2739.5669; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 97200824.0000; val_global_loss: 122227040.0000; val_optim_loss: 122227040.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8975; val_auprc_score: 0.8943; val_best_acc_score: 0.7928; val_best_f1_score: 0.8153; train_kl_reg_loss: 241130.4549; train_edge_recon_loss: 3618167.3056; train_gene_expr_recon_loss: 20690912.4444; train_masked_gp_l1_reg_loss: 2744.2935; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96298988.4444; train_global_loss: 120851942.2222; train_optim_loss: 120851942.2222; val_kl_reg_loss: 186810.3125; val_edge_recon_loss: 4037712.2500; val_gene_expr_recon_loss: 20690780.0000; val_masked_gp_l1_reg_loss: 2749.4829; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96954616.0000; val_global_loss: 121872672.0000; val_optim_loss: 121872672.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8971; val_auprc_score: 0.8887; val_best_acc_score: 0.8131; val_best_f1_score: 0.8263; train_kl_reg_loss: 234089.6059; train_edge_recon_loss: 3622015.9444; train_gene_expr_recon_loss: 20672950.4444; train_masked_gp_l1_reg_loss: 2754.2306; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96733856.8889; train_global_loss: 121265667.5556; train_optim_loss: 121265667.5556; val_kl_reg_loss: 208422.2031; val_edge_recon_loss: 4030131.5000; val_gene_expr_recon_loss: 20666546.0000; val_masked_gp_l1_reg_loss: 2759.4927; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96951192.0000; val_global_loss: 121859056.0000; val_optim_loss: 121859056.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8923; val_auprc_score: 0.8839; val_best_acc_score: 0.8157; val_best_f1_score: 0.8213; train_kl_reg_loss: 237621.8715; train_edge_recon_loss: 3605345.1667; train_gene_expr_recon_loss: 20648052.2222; train_masked_gp_l1_reg_loss: 2763.5144; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95918672.8889; train_global_loss: 120412455.1111; train_optim_loss: 120412455.1111; val_kl_reg_loss: 193645.4375; val_edge_recon_loss: 4018747.2500; val_gene_expr_recon_loss: 20640328.0000; val_masked_gp_l1_reg_loss: 2768.2571; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96716832.0000; val_global_loss: 121572320.0000; val_optim_loss: 121572320.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8955; val_auprc_score: 0.8856; val_best_acc_score: 0.8191; val_best_f1_score: 0.8175; train_kl_reg_loss: 227006.4340; train_edge_recon_loss: 3609627.1944; train_gene_expr_recon_loss: 20603734.2222; train_masked_gp_l1_reg_loss: 2772.3323; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96351526.2222; train_global_loss: 120794665.7778; train_optim_loss: 120794665.7778; val_kl_reg_loss: 195326.9688; val_edge_recon_loss: 4005875.5000; val_gene_expr_recon_loss: 20610582.0000; val_masked_gp_l1_reg_loss: 2776.2400; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96684976.0000; val_global_loss: 121499536.0000; val_optim_loss: 121499536.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8984; val_auprc_score: 0.8900; val_best_acc_score: 0.8137; val_best_f1_score: 0.8049; train_kl_reg_loss: 226641.0642; train_edge_recon_loss: 3599916.5556; train_gene_expr_recon_loss: 20513682.4444; train_masked_gp_l1_reg_loss: 2780.1756; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95955227.5556; train_global_loss: 120298247.1111; train_optim_loss: 120298247.1111; val_kl_reg_loss: 188893.7812; val_edge_recon_loss: 3986612.7500; val_gene_expr_recon_loss: 20595242.0000; val_masked_gp_l1_reg_loss: 2784.3755; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96719176.0000; val_global_loss: 121492704.0000; val_optim_loss: 121492704.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8948; val_auprc_score: 0.8818; val_best_acc_score: 0.7959; val_best_f1_score: 0.8000; train_kl_reg_loss: 223868.5729; train_edge_recon_loss: 3593746.2222; train_gene_expr_recon_loss: 20515795.5556; train_masked_gp_l1_reg_loss: 2788.5913; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96145028.4444; train_global_loss: 120481226.6667; train_optim_loss: 120481226.6667; val_kl_reg_loss: 186921.7188; val_edge_recon_loss: 3961452.5000; val_gene_expr_recon_loss: 20574380.0000; val_masked_gp_l1_reg_loss: 2792.5220; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96560504.0000; val_global_loss: 121286048.0000; val_optim_loss: 121286048.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8978; val_auprc_score: 0.8846; val_best_acc_score: 0.7871; val_best_f1_score: 0.8125; train_kl_reg_loss: 216533.8299; train_edge_recon_loss: 3587417.6944; train_gene_expr_recon_loss: 20599683.5556; train_masked_gp_l1_reg_loss: 2796.2663; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96139590.2222; train_global_loss: 120546022.2222; train_optim_loss: 120546022.2222; val_kl_reg_loss: 176495.1094; val_edge_recon_loss: 3936965.5000; val_gene_expr_recon_loss: 20543318.0000; val_masked_gp_l1_reg_loss: 2801.0601; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96502816.0000; val_global_loss: 121162400.0000; val_optim_loss: 121162400.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9026; val_auprc_score: 0.8939; val_best_acc_score: 0.7983; val_best_f1_score: 0.8216; train_kl_reg_loss: 215044.8542; train_edge_recon_loss: 3575996.6667; train_gene_expr_recon_loss: 20527154.0000; train_masked_gp_l1_reg_loss: 2805.9416; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96008788.4444; train_global_loss: 120329789.3333; train_optim_loss: 120329789.3333; val_kl_reg_loss: 178961.6250; val_edge_recon_loss: 3905299.2500; val_gene_expr_recon_loss: 20518000.0000; val_masked_gp_l1_reg_loss: 2811.5991; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96267368.0000; val_global_loss: 120872440.0000; val_optim_loss: 120872440.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8998; val_auprc_score: 0.8827; val_best_acc_score: 0.8204; val_best_f1_score: 0.8168; train_kl_reg_loss: 174347.9384; train_edge_recon_loss: 3848526.6111; train_gene_expr_recon_loss: 21840015.3333; train_masked_gp_l1_reg_loss: 2818.9561; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96564594.6667; train_global_loss: 122430303.1111; train_optim_loss: 122430303.1111; val_kl_reg_loss: 74533.1719; val_edge_recon_loss: 3993627.5000; val_gene_expr_recon_loss: 20973612.0000; val_masked_gp_l1_reg_loss: 2836.2219; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96900824.0000; val_global_loss: 121945432.0000; val_optim_loss: 121945432.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8933; val_auprc_score: 0.8810; val_best_acc_score: 0.8131; val_best_f1_score: 0.8256; train_kl_reg_loss: 96360.3464; train_edge_recon_loss: 3908060.5556; train_gene_expr_recon_loss: 21028015.7778; train_masked_gp_l1_reg_loss: 2860.5776; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96159348.4444; train_global_loss: 121194644.4444; train_optim_loss: 121194644.4444; val_kl_reg_loss: 76778.9453; val_edge_recon_loss: 4026746.5000; val_gene_expr_recon_loss: 20983390.0000; val_masked_gp_l1_reg_loss: 2890.5261; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96838736.0000; val_global_loss: 121928544.0000; val_optim_loss: 121928544.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8717; val_auprc_score: 0.8581; val_best_acc_score: 0.7499; val_best_f1_score: 0.7892; train_kl_reg_loss: 81399.2648; train_edge_recon_loss: 3955205.2500; train_gene_expr_recon_loss: 21567733.3333; train_masked_gp_l1_reg_loss: 2920.1264; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96919734.2222; train_global_loss: 122526992.8889; train_optim_loss: 122526992.8889; val_kl_reg_loss: 93396.0703; val_edge_recon_loss: 4046046.7500; val_gene_expr_recon_loss: 20921064.0000; val_masked_gp_l1_reg_loss: 2956.1104; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96741872.0000; val_global_loss: 121805336.0000; val_optim_loss: 121805336.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8805; val_auprc_score: 0.8693; val_best_acc_score: 0.7689; val_best_f1_score: 0.8022; train_kl_reg_loss: 78958.5352; train_edge_recon_loss: 3916569.7778; train_gene_expr_recon_loss: 21340274.2222; train_masked_gp_l1_reg_loss: 2975.2918; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 97046840.0000; train_global_loss: 122385617.7778; train_optim_loss: 122385617.7778; val_kl_reg_loss: 68088.8125; val_edge_recon_loss: 4045863.2500; val_gene_expr_recon_loss: 20879800.0000; val_masked_gp_l1_reg_loss: 2999.6025; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96707800.0000; val_global_loss: 121704552.0000; val_optim_loss: 121704552.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8812; val_auprc_score: 0.8675; val_best_acc_score: 0.7677; val_best_f1_score: 0.8015; train_kl_reg_loss: 76903.8351; train_edge_recon_loss: 3928678.0556; train_gene_expr_recon_loss: 20860267.3333; train_masked_gp_l1_reg_loss: 3001.2872; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96180360.8889; train_global_loss: 121049211.5556; train_optim_loss: 121049211.5556; val_kl_reg_loss: 73902.3125; val_edge_recon_loss: 4045997.5000; val_gene_expr_recon_loss: 20854520.0000; val_masked_gp_l1_reg_loss: 3003.1401; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96734016.0000; val_global_loss: 121711440.0000; val_optim_loss: 121711440.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8799; val_auprc_score: 0.8595; val_best_acc_score: 0.7705; val_best_f1_score: 0.8034; train_kl_reg_loss: 89805.2743; train_edge_recon_loss: 3873083.3056; train_gene_expr_recon_loss: 20775297.3333; train_masked_gp_l1_reg_loss: 3004.1663; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 95803745.7778; train_global_loss: 120544936.0000; train_optim_loss: 120544936.0000; val_kl_reg_loss: 88446.0781; val_edge_recon_loss: 4045448.5000; val_gene_expr_recon_loss: 20847458.0000; val_masked_gp_l1_reg_loss: 3005.1919; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96747464.0000; val_global_loss: 121731824.0000; val_optim_loss: 121731824.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8784; val_auprc_score: 0.8549; val_best_acc_score: 0.7758; val_best_f1_score: 0.8066; train_kl_reg_loss: 94328.7656; train_edge_recon_loss: 3872481.1111; train_gene_expr_recon_loss: 20839661.3333; train_masked_gp_l1_reg_loss: 3005.6865; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96342360.8889; train_global_loss: 121151837.3333; train_optim_loss: 121151837.3333; val_kl_reg_loss: 84661.2969; val_edge_recon_loss: 4044775.7500; val_gene_expr_recon_loss: 20813854.0000; val_masked_gp_l1_reg_loss: 3006.1870; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96609056.0000; val_global_loss: 121555352.0000; val_optim_loss: 121555352.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8836; val_auprc_score: 0.8693; val_best_acc_score: 0.7804; val_best_f1_score: 0.8087; train_kl_reg_loss: 96746.6927; train_edge_recon_loss: 3851976.2500; train_gene_expr_recon_loss: 20901476.4444; train_masked_gp_l1_reg_loss: 3006.4365; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 96668501.3333; train_global_loss: 121521705.7778; train_optim_loss: 121521705.7778; val_kl_reg_loss: 89817.8516; val_edge_recon_loss: 4043918.0000; val_gene_expr_recon_loss: 20792552.0000; val_masked_gp_l1_reg_loss: 3006.6904; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 96432512.0000; val_global_loss: 121361808.0000; val_optim_loss: 121361808.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 41 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9028
Val AUPRC score: 0.8870
Val best accuracy score: 0.8195
Val best F1 score: 0.8140
Val gene expr MSE score: 0.5507
Val chrom access MSE score: 0.0871
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
