[True]
Run timestamp: 07082023_204721_108.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '20', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_108']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8921; val_auprc_score: 0.9063; val_best_acc_score: 0.5110; val_best_f1_score: 0.6716; train_kl_reg_loss: 15938.0656; train_edge_recon_loss: 349808.1319; train_gene_expr_recon_loss: 1191853.1458; train_masked_gp_l1_reg_loss: 15672.6844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166748.6285; train_chrom_access_recon_loss: 710230.4062; train_global_loss: 2450251.0694; train_optim_loss: 2450251.0694; val_kl_reg_loss: 8979.2861; val_edge_recon_loss: 406474.4375; val_gene_expr_recon_loss: 992920.0000; val_masked_gp_l1_reg_loss: 10333.9053; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161960.6406; val_chrom_access_recon_loss: 510025.0938; val_global_loss: 2090693.3750; val_optim_loss: 2090693.3750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8909; val_auprc_score: 0.9029; val_best_acc_score: 0.5101; val_best_f1_score: 0.6712; train_kl_reg_loss: 12035.5310; train_edge_recon_loss: 355376.3715; train_gene_expr_recon_loss: 894478.9167; train_masked_gp_l1_reg_loss: 8508.2362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 158759.9722; train_chrom_access_recon_loss: 486288.1424; train_global_loss: 1915447.1389; train_optim_loss: 1915447.1389; val_kl_reg_loss: 16524.5586; val_edge_recon_loss: 406509.4062; val_gene_expr_recon_loss: 838589.1250; val_masked_gp_l1_reg_loss: 7361.1284; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154596.2500; val_chrom_access_recon_loss: 475446.4375; val_global_loss: 1899027.0000; val_optim_loss: 1899027.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8794; val_auprc_score: 0.8880; val_best_acc_score: 0.5199; val_best_f1_score: 0.6754; train_kl_reg_loss: 16743.3236; train_edge_recon_loss: 357902.1979; train_gene_expr_recon_loss: 807800.6667; train_masked_gp_l1_reg_loss: 7710.5877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150838.6840; train_chrom_access_recon_loss: 463708.6354; train_global_loss: 1804704.1111; train_optim_loss: 1804704.1111; val_kl_reg_loss: 16359.4336; val_edge_recon_loss: 406422.7188; val_gene_expr_recon_loss: 784292.8750; val_masked_gp_l1_reg_loss: 7946.7134; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145864.4062; val_chrom_access_recon_loss: 459984.3125; val_global_loss: 1820870.5000; val_optim_loss: 1820870.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8641; val_auprc_score: 0.8724; val_best_acc_score: 0.5406; val_best_f1_score: 0.6831; train_kl_reg_loss: 18467.2339; train_edge_recon_loss: 358124.1667; train_gene_expr_recon_loss: 764511.9028; train_masked_gp_l1_reg_loss: 7935.4188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141572.2639; train_chrom_access_recon_loss: 453664.1458; train_global_loss: 1744275.1389; train_optim_loss: 1744275.1389; val_kl_reg_loss: 18045.5742; val_edge_recon_loss: 406183.4375; val_gene_expr_recon_loss: 748462.3125; val_masked_gp_l1_reg_loss: 8006.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136056.6250; val_chrom_access_recon_loss: 454898.9688; val_global_loss: 1771653.3750; val_optim_loss: 1771653.3750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8658; val_auprc_score: 0.8674; val_best_acc_score: 0.5790; val_best_f1_score: 0.6991; train_kl_reg_loss: 19683.3670; train_edge_recon_loss: 358904.9549; train_gene_expr_recon_loss: 734326.5208; train_masked_gp_l1_reg_loss: 8058.5851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131502.3420; train_chrom_access_recon_loss: 450050.1979; train_global_loss: 1702525.9861; train_optim_loss: 1702525.9861; val_kl_reg_loss: 18903.8164; val_edge_recon_loss: 405654.5938; val_gene_expr_recon_loss: 727414.5000; val_masked_gp_l1_reg_loss: 8099.3188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125766.8047; val_chrom_access_recon_loss: 451248.8750; val_global_loss: 1737087.8750; val_optim_loss: 1737087.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8635; val_auprc_score: 0.8634; val_best_acc_score: 0.6288; val_best_f1_score: 0.7222; train_kl_reg_loss: 20333.3385; train_edge_recon_loss: 358438.7431; train_gene_expr_recon_loss: 717008.5764; train_masked_gp_l1_reg_loss: 8146.7256; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121184.4036; train_chrom_access_recon_loss: 445443.0417; train_global_loss: 1670554.8472; train_optim_loss: 1670554.8472; val_kl_reg_loss: 20844.2480; val_edge_recon_loss: 404982.7812; val_gene_expr_recon_loss: 712823.1250; val_masked_gp_l1_reg_loss: 8191.8057; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115482.0312; val_chrom_access_recon_loss: 448900.3750; val_global_loss: 1711224.2500; val_optim_loss: 1711224.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8638; val_auprc_score: 0.8651; val_best_acc_score: 0.7017; val_best_f1_score: 0.7583; train_kl_reg_loss: 20278.7617; train_edge_recon_loss: 357810.4306; train_gene_expr_recon_loss: 705636.0000; train_masked_gp_l1_reg_loss: 8229.0469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111021.1780; train_chrom_access_recon_loss: 446197.7118; train_global_loss: 1649173.1111; train_optim_loss: 1649173.1111; val_kl_reg_loss: 19667.3594; val_edge_recon_loss: 403433.5312; val_gene_expr_recon_loss: 702881.0000; val_masked_gp_l1_reg_loss: 8259.6982; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105526.7969; val_chrom_access_recon_loss: 447004.4062; val_global_loss: 1686772.7500; val_optim_loss: 1686772.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8485; val_auprc_score: 0.8488; val_best_acc_score: 0.7536; val_best_f1_score: 0.7789; train_kl_reg_loss: 19997.0625; train_edge_recon_loss: 357169.2153; train_gene_expr_recon_loss: 696941.2639; train_masked_gp_l1_reg_loss: 8306.2204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101311.8750; train_chrom_access_recon_loss: 442350.7396; train_global_loss: 1626076.3750; train_optim_loss: 1626076.3750; val_kl_reg_loss: 18731.2383; val_edge_recon_loss: 401542.3125; val_gene_expr_recon_loss: 696219.6250; val_masked_gp_l1_reg_loss: 8342.7793; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96149.3359; val_chrom_access_recon_loss: 445586.9062; val_global_loss: 1666572.2500; val_optim_loss: 1666572.2500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8562; val_auprc_score: 0.8565; val_best_acc_score: 0.7813; val_best_f1_score: 0.7775; train_kl_reg_loss: 19919.5749; train_edge_recon_loss: 356302.6667; train_gene_expr_recon_loss: 691875.4028; train_masked_gp_l1_reg_loss: 8380.6964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92234.2995; train_chrom_access_recon_loss: 443264.4965; train_global_loss: 1611977.1667; train_optim_loss: 1611977.1667; val_kl_reg_loss: 20545.7031; val_edge_recon_loss: 398380.3438; val_gene_expr_recon_loss: 689415.2500; val_masked_gp_l1_reg_loss: 8418.6191; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87464.2812; val_chrom_access_recon_loss: 444278.0625; val_global_loss: 1648502.2500; val_optim_loss: 1648502.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8591; val_auprc_score: 0.8523; val_best_acc_score: 0.7579; val_best_f1_score: 0.7768; train_kl_reg_loss: 20040.5707; train_edge_recon_loss: 355101.0938; train_gene_expr_recon_loss: 687285.0139; train_masked_gp_l1_reg_loss: 8453.4558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83877.2326; train_chrom_access_recon_loss: 440601.8542; train_global_loss: 1595359.2222; train_optim_loss: 1595359.2222; val_kl_reg_loss: 20368.8750; val_edge_recon_loss: 392601.1875; val_gene_expr_recon_loss: 685416.9375; val_masked_gp_l1_reg_loss: 8487.2715; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79524.6484; val_chrom_access_recon_loss: 443205.1875; val_global_loss: 1629604.0000; val_optim_loss: 1629604.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8732; val_auprc_score: 0.8707; val_best_acc_score: 0.7870; val_best_f1_score: 0.8008; train_kl_reg_loss: 19684.6133; train_edge_recon_loss: 352956.4375; train_gene_expr_recon_loss: 682883.0486; train_masked_gp_l1_reg_loss: 8527.3959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76293.2023; train_chrom_access_recon_loss: 439545.8333; train_global_loss: 1579890.5417; train_optim_loss: 1579890.5417; val_kl_reg_loss: 18936.0684; val_edge_recon_loss: 383831.9062; val_gene_expr_recon_loss: 682463.0000; val_masked_gp_l1_reg_loss: 8560.6777; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72401.1094; val_chrom_access_recon_loss: 442062.3125; val_global_loss: 1608255.0000; val_optim_loss: 1608255.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8824; val_auprc_score: 0.8771; val_best_acc_score: 0.7970; val_best_f1_score: 0.8086; train_kl_reg_loss: 19159.9642; train_edge_recon_loss: 348640.8368; train_gene_expr_recon_loss: 681278.6736; train_masked_gp_l1_reg_loss: 8599.9225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69544.1797; train_chrom_access_recon_loss: 438880.4340; train_global_loss: 1566103.9861; train_optim_loss: 1566103.9861; val_kl_reg_loss: 19113.5547; val_edge_recon_loss: 365938.3750; val_gene_expr_recon_loss: 680661.3750; val_masked_gp_l1_reg_loss: 8643.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66114.2344; val_chrom_access_recon_loss: 441389.7812; val_global_loss: 1581860.8750; val_optim_loss: 1581860.8750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8847; val_auprc_score: 0.8776; val_best_acc_score: 0.7936; val_best_f1_score: 0.8080; train_kl_reg_loss: 19698.3674; train_edge_recon_loss: 337980.4722; train_gene_expr_recon_loss: 678095.6597; train_masked_gp_l1_reg_loss: 8698.6775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63593.0595; train_chrom_access_recon_loss: 437726.7326; train_global_loss: 1545792.9583; train_optim_loss: 1545792.9583; val_kl_reg_loss: 20640.6895; val_edge_recon_loss: 337863.4375; val_gene_expr_recon_loss: 680887.5000; val_masked_gp_l1_reg_loss: 8759.0615; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60559.6484; val_chrom_access_recon_loss: 441058.6875; val_global_loss: 1549769.0000; val_optim_loss: 1549769.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8973; val_auprc_score: 0.8920; val_best_acc_score: 0.8111; val_best_f1_score: 0.8148; train_kl_reg_loss: 24316.9679; train_edge_recon_loss: 322760.6632; train_gene_expr_recon_loss: 677019.8889; train_masked_gp_l1_reg_loss: 8824.3840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58327.7188; train_chrom_access_recon_loss: 437149.1597; train_global_loss: 1528398.7500; train_optim_loss: 1528398.7500; val_kl_reg_loss: 27929.1328; val_edge_recon_loss: 318957.0625; val_gene_expr_recon_loss: 678352.2500; val_masked_gp_l1_reg_loss: 8905.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55636.6250; val_chrom_access_recon_loss: 440071.9688; val_global_loss: 1529852.2500; val_optim_loss: 1529852.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9000; val_auprc_score: 0.8819; val_best_acc_score: 0.8173; val_best_f1_score: 0.8301; train_kl_reg_loss: 29019.3260; train_edge_recon_loss: 313201.7014; train_gene_expr_recon_loss: 678496.9931; train_masked_gp_l1_reg_loss: 8965.9932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53650.2183; train_chrom_access_recon_loss: 439034.6667; train_global_loss: 1522368.8472; train_optim_loss: 1522368.8472; val_kl_reg_loss: 26312.2500; val_edge_recon_loss: 312823.8750; val_gene_expr_recon_loss: 677489.5000; val_masked_gp_l1_reg_loss: 9037.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51251.1797; val_chrom_access_recon_loss: 439343.6562; val_global_loss: 1516258.1250; val_optim_loss: 1516258.1250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9070; val_auprc_score: 0.8870; val_best_acc_score: 0.8274; val_best_f1_score: 0.8371; train_kl_reg_loss: 26210.2051; train_edge_recon_loss: 311153.7326; train_gene_expr_recon_loss: 670062.0347; train_masked_gp_l1_reg_loss: 9098.3835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49486.3464; train_chrom_access_recon_loss: 434309.8194; train_global_loss: 1500320.5139; train_optim_loss: 1500320.5139; val_kl_reg_loss: 26263.4297; val_edge_recon_loss: 311106.2812; val_gene_expr_recon_loss: 674754.3125; val_masked_gp_l1_reg_loss: 9161.5225; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47336.4844; val_chrom_access_recon_loss: 438660.3125; val_global_loss: 1507282.2500; val_optim_loss: 1507282.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9207; val_auprc_score: 0.9019; val_best_acc_score: 0.8463; val_best_f1_score: 0.8550; train_kl_reg_loss: 27084.4902; train_edge_recon_loss: 304924.4722; train_gene_expr_recon_loss: 671058.3958; train_masked_gp_l1_reg_loss: 9205.5252; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45743.6580; train_chrom_access_recon_loss: 435710.9097; train_global_loss: 1493727.4583; train_optim_loss: 1493727.4583; val_kl_reg_loss: 26549.6836; val_edge_recon_loss: 304002.0000; val_gene_expr_recon_loss: 673457.6250; val_masked_gp_l1_reg_loss: 9261.8467; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43818.6953; val_chrom_access_recon_loss: 437768.3125; val_global_loss: 1494858.2500; val_optim_loss: 1494858.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9324; val_auprc_score: 0.9127; val_best_acc_score: 0.8616; val_best_f1_score: 0.8687; train_kl_reg_loss: 26931.4878; train_edge_recon_loss: 302313.7708; train_gene_expr_recon_loss: 671939.4861; train_masked_gp_l1_reg_loss: 9308.8625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42395.7604; train_chrom_access_recon_loss: 435868.1458; train_global_loss: 1488757.5417; train_optim_loss: 1488757.5417; val_kl_reg_loss: 26388.7188; val_edge_recon_loss: 300222.5000; val_gene_expr_recon_loss: 670796.0625; val_masked_gp_l1_reg_loss: 9363.7510; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40665.5000; val_chrom_access_recon_loss: 436829.5000; val_global_loss: 1484266.0000; val_optim_loss: 1484266.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9334; val_auprc_score: 0.9152; val_best_acc_score: 0.8670; val_best_f1_score: 0.8710; train_kl_reg_loss: 26607.3971; train_edge_recon_loss: 300269.5069; train_gene_expr_recon_loss: 671414.4028; train_masked_gp_l1_reg_loss: 9399.2711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39381.0616; train_chrom_access_recon_loss: 433862.4583; train_global_loss: 1480934.1111; train_optim_loss: 1480934.1111; val_kl_reg_loss: 26845.1914; val_edge_recon_loss: 297691.3438; val_gene_expr_recon_loss: 669746.6250; val_masked_gp_l1_reg_loss: 9439.0615; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37816.6055; val_chrom_access_recon_loss: 436133.5938; val_global_loss: 1477672.3750; val_optim_loss: 1477672.3750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9375; val_auprc_score: 0.9191; val_best_acc_score: 0.8707; val_best_f1_score: 0.8779; train_kl_reg_loss: 27621.5195; train_edge_recon_loss: 296484.6458; train_gene_expr_recon_loss: 666624.1875; train_masked_gp_l1_reg_loss: 9480.5669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36660.4488; train_chrom_access_recon_loss: 434946.2222; train_global_loss: 1471817.5972; train_optim_loss: 1471817.5972; val_kl_reg_loss: 26790.4141; val_edge_recon_loss: 298759.5625; val_gene_expr_recon_loss: 669422.8750; val_masked_gp_l1_reg_loss: 9520.5068; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35246.6875; val_chrom_access_recon_loss: 435521.1562; val_global_loss: 1475261.2500; val_optim_loss: 1475261.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9453; val_auprc_score: 0.9312; val_best_acc_score: 0.8798; val_best_f1_score: 0.8842; train_kl_reg_loss: 27166.6576; train_edge_recon_loss: 295642.7083; train_gene_expr_recon_loss: 665505.0000; train_masked_gp_l1_reg_loss: 9545.6688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34204.6632; train_chrom_access_recon_loss: 431061.1632; train_global_loss: 1463125.8472; train_optim_loss: 1463125.8472; val_kl_reg_loss: 27460.9160; val_edge_recon_loss: 295594.3750; val_gene_expr_recon_loss: 666940.0000; val_masked_gp_l1_reg_loss: 9581.3535; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32927.4062; val_chrom_access_recon_loss: 434681.6875; val_global_loss: 1467185.7500; val_optim_loss: 1467185.7500
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9475; val_auprc_score: 0.9292; val_best_acc_score: 0.8860; val_best_f1_score: 0.8915; train_kl_reg_loss: 27933.4920; train_edge_recon_loss: 294668.2778; train_gene_expr_recon_loss: 660950.0833; train_masked_gp_l1_reg_loss: 9608.4637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31978.7109; train_chrom_access_recon_loss: 430732.3785; train_global_loss: 1455871.4306; train_optim_loss: 1455871.4306; val_kl_reg_loss: 26720.5000; val_edge_recon_loss: 294404.3750; val_gene_expr_recon_loss: 666436.8750; val_masked_gp_l1_reg_loss: 9628.9541; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30814.8809; val_chrom_access_recon_loss: 434187.0625; val_global_loss: 1462192.6250; val_optim_loss: 1462192.6250
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9488; val_auprc_score: 0.9353; val_best_acc_score: 0.8856; val_best_f1_score: 0.8898; train_kl_reg_loss: 27206.7261; train_edge_recon_loss: 294306.8264; train_gene_expr_recon_loss: 661353.2014; train_masked_gp_l1_reg_loss: 9651.4028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29955.7355; train_chrom_access_recon_loss: 431040.0417; train_global_loss: 1453513.9444; train_optim_loss: 1453513.9444; val_kl_reg_loss: 27325.3516; val_edge_recon_loss: 293343.9062; val_gene_expr_recon_loss: 663346.0625; val_masked_gp_l1_reg_loss: 9677.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28892.4199; val_chrom_access_recon_loss: 433076.0312; val_global_loss: 1455661.1250; val_optim_loss: 1455661.1250
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9567; val_auprc_score: 0.9465; val_best_acc_score: 0.8963; val_best_f1_score: 0.9013; train_kl_reg_loss: 27424.3991; train_edge_recon_loss: 293160.1146; train_gene_expr_recon_loss: 658350.3403; train_masked_gp_l1_reg_loss: 9693.7577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 28107.3192; train_chrom_access_recon_loss: 431042.3160; train_global_loss: 1447778.2639; train_optim_loss: 1447778.2639; val_kl_reg_loss: 26641.6055; val_edge_recon_loss: 292425.3438; val_gene_expr_recon_loss: 663173.3750; val_masked_gp_l1_reg_loss: 9715.0557; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27143.8965; val_chrom_access_recon_loss: 432535.6562; val_global_loss: 1451634.8750; val_optim_loss: 1451634.8750
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9598; val_auprc_score: 0.9460; val_best_acc_score: 0.9051; val_best_f1_score: 0.9080; train_kl_reg_loss: 27081.6543; train_edge_recon_loss: 292818.0174; train_gene_expr_recon_loss: 661325.5069; train_masked_gp_l1_reg_loss: 9732.2780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26434.2413; train_chrom_access_recon_loss: 430893.4826; train_global_loss: 1448285.1944; train_optim_loss: 1448285.1944; val_kl_reg_loss: 27966.5273; val_edge_recon_loss: 289653.4062; val_gene_expr_recon_loss: 660765.5000; val_masked_gp_l1_reg_loss: 9757.5645; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25565.1797; val_chrom_access_recon_loss: 431873.1875; val_global_loss: 1445581.3750; val_optim_loss: 1445581.3750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9495; val_auprc_score: 0.9391; val_best_acc_score: 0.8841; val_best_f1_score: 0.8893; train_kl_reg_loss: 26584.2331; train_edge_recon_loss: 305365.9583; train_gene_expr_recon_loss: 1006984.6458; train_masked_gp_l1_reg_loss: 9882.2784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24746.6654; train_chrom_access_recon_loss: 456242.4931; train_global_loss: 1829806.2639; train_optim_loss: 1829806.2639; val_kl_reg_loss: 10169.0508; val_edge_recon_loss: 302718.7500; val_gene_expr_recon_loss: 1003337.8750; val_masked_gp_l1_reg_loss: 10084.6475; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23614.9414; val_chrom_access_recon_loss: 458200.8750; val_global_loss: 1808126.2500; val_optim_loss: 1808126.2500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9534; val_auprc_score: 0.9427; val_best_acc_score: 0.8905; val_best_f1_score: 0.8939; train_kl_reg_loss: 23114.0642; train_edge_recon_loss: 297173.9792; train_gene_expr_recon_loss: 1002063.1319; train_masked_gp_l1_reg_loss: 10299.6573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22666.8116; train_chrom_access_recon_loss: 455683.2569; train_global_loss: 1811000.9167; train_optim_loss: 1811000.9167; val_kl_reg_loss: 10939.1387; val_edge_recon_loss: 293480.0938; val_gene_expr_recon_loss: 1000064.7500; val_masked_gp_l1_reg_loss: 10572.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21497.6973; val_chrom_access_recon_loss: 457822.2188; val_global_loss: 1794376.3750; val_optim_loss: 1794376.3750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9567; val_auprc_score: 0.9444; val_best_acc_score: 0.8946; val_best_f1_score: 0.8968; train_kl_reg_loss: 19887.4612; train_edge_recon_loss: 292358.0625; train_gene_expr_recon_loss: 998656.4653; train_masked_gp_l1_reg_loss: 10768.5731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20616.1810; train_chrom_access_recon_loss: 454323.9306; train_global_loss: 1796610.6667; train_optim_loss: 1796610.6667; val_kl_reg_loss: 12568.9297; val_edge_recon_loss: 291271.4688; val_gene_expr_recon_loss: 995155.0625; val_masked_gp_l1_reg_loss: 10988.1826; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 19550.4336; val_chrom_access_recon_loss: 457314.5625; val_global_loss: 1786848.5000; val_optim_loss: 1786848.5000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9584; val_auprc_score: 0.9480; val_best_acc_score: 0.8967; val_best_f1_score: 0.9004; train_kl_reg_loss: 19414.2463; train_edge_recon_loss: 288761.6319; train_gene_expr_recon_loss: 986824.6597; train_masked_gp_l1_reg_loss: 11134.3711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18767.0740; train_chrom_access_recon_loss: 453393.7465; train_global_loss: 1778295.7361; train_optim_loss: 1778295.7361; val_kl_reg_loss: 14498.6104; val_edge_recon_loss: 287228.3125; val_gene_expr_recon_loss: 990005.2500; val_masked_gp_l1_reg_loss: 11301.0527; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17829.5078; val_chrom_access_recon_loss: 456582.6562; val_global_loss: 1777445.3750; val_optim_loss: 1777445.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9556; val_auprc_score: 0.9393; val_best_acc_score: 0.8983; val_best_f1_score: 0.9017; train_kl_reg_loss: 19391.1897; train_edge_recon_loss: 287022.3542; train_gene_expr_recon_loss: 982408.6319; train_masked_gp_l1_reg_loss: 11231.6393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17660.0844; train_chrom_access_recon_loss: 452385.1354; train_global_loss: 1770099.0278; train_optim_loss: 1770099.0278; val_kl_reg_loss: 14545.0020; val_edge_recon_loss: 288188.5625; val_gene_expr_recon_loss: 989463.1250; val_masked_gp_l1_reg_loss: 11176.6777; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17478.0430; val_chrom_access_recon_loss: 456490.9062; val_global_loss: 1777342.2500; val_optim_loss: 1777342.2500
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9605; val_auprc_score: 0.9464; val_best_acc_score: 0.9038; val_best_f1_score: 0.9049; train_kl_reg_loss: 19114.7847; train_edge_recon_loss: 287112.2951; train_gene_expr_recon_loss: 981661.9722; train_masked_gp_l1_reg_loss: 11170.0919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17376.6408; train_chrom_access_recon_loss: 452157.3681; train_global_loss: 1768593.1667; train_optim_loss: 1768593.1667; val_kl_reg_loss: 14552.7207; val_edge_recon_loss: 286798.9062; val_gene_expr_recon_loss: 989115.4375; val_masked_gp_l1_reg_loss: 11154.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17243.4609; val_chrom_access_recon_loss: 456499.4062; val_global_loss: 1775364.3750; val_optim_loss: 1775364.3750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9587; val_auprc_score: 0.9475; val_best_acc_score: 0.9004; val_best_f1_score: 0.9036; train_kl_reg_loss: 18970.1819; train_edge_recon_loss: 287199.2049; train_gene_expr_recon_loss: 989357.5069; train_masked_gp_l1_reg_loss: 11149.2790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17149.4564; train_chrom_access_recon_loss: 455240.0417; train_global_loss: 1779065.6944; train_optim_loss: 1779065.6944; val_kl_reg_loss: 14563.6523; val_edge_recon_loss: 287584.0312; val_gene_expr_recon_loss: 988555.6250; val_masked_gp_l1_reg_loss: 11145.0146; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17035.2305; val_chrom_access_recon_loss: 456325.8750; val_global_loss: 1775209.3750; val_optim_loss: 1775209.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9574; val_auprc_score: 0.9433; val_best_acc_score: 0.8959; val_best_f1_score: 0.8996; train_kl_reg_loss: 18764.9562; train_edge_recon_loss: 288055.3993; train_gene_expr_recon_loss: 986285.1458; train_masked_gp_l1_reg_loss: 11145.1565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16949.7018; train_chrom_access_recon_loss: 454859.7604; train_global_loss: 1776060.0972; train_optim_loss: 1776060.0972; val_kl_reg_loss: 14525.3252; val_edge_recon_loss: 287356.7500; val_gene_expr_recon_loss: 988004.6250; val_masked_gp_l1_reg_loss: 11146.9863; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16848.5723; val_chrom_access_recon_loss: 456201.1250; val_global_loss: 1774083.5000; val_optim_loss: 1774083.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 37 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9584
val AUPRC score: 0.9457
val best accuracy score: 0.8991
val best F1 score: 0.9030
val target rna MSE score: 3.9032
val source rna MSE score: 3.2292
val target atac MSE score: 0.1374
val source atac MSE score: 0.0211
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
