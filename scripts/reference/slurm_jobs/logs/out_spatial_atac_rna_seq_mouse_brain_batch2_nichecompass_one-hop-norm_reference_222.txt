[True]
Run timestamp: 07092023_003220_222.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_222']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2393 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5107, n_cat_covariates_embed_input: 0, n_hidden: 2324, n_latent: 2224, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2714
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2393
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2224, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2393

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6441; val_auprc_score: 0.6218; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 47960.8218; train_edge_recon_loss: 3556404.2197; train_gene_expr_recon_loss: 12529741.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 827151.8542; train_chrom_access_recon_loss: 10278010.6364; train_global_loss: 27239269.1515; train_optim_loss: 27239269.1515; val_kl_reg_loss: 80096.6602; val_edge_recon_loss: 4065323.7500; val_gene_expr_recon_loss: 11458425.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 643823.9375; val_chrom_access_recon_loss: 9797951.2500; val_global_loss: 26045620.7500; val_optim_loss: 26045620.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6786; val_auprc_score: 0.6620; val_best_acc_score: 0.5320; val_best_f1_score: 0.6785; train_kl_reg_loss: 95550.2932; train_edge_recon_loss: 3526284.5379; train_gene_expr_recon_loss: 11297177.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 481691.0530; train_chrom_access_recon_loss: 9760165.2576; train_global_loss: 25160869.0303; train_optim_loss: 25160869.0303; val_kl_reg_loss: 110678.5537; val_edge_recon_loss: 4063539.4688; val_gene_expr_recon_loss: 11261054.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 343109.6562; val_chrom_access_recon_loss: 9743842.8750; val_global_loss: 25522225.0000; val_optim_loss: 25522225.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7614; val_auprc_score: 0.7489; val_best_acc_score: 0.6341; val_best_f1_score: 0.7193; train_kl_reg_loss: 90530.1745; train_edge_recon_loss: 3516187.4394; train_gene_expr_recon_loss: 11121408.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 259732.7270; train_chrom_access_recon_loss: 9667115.0000; train_global_loss: 24654973.5758; train_optim_loss: 24654973.5758; val_kl_reg_loss: 91749.9990; val_edge_recon_loss: 4055216.9688; val_gene_expr_recon_loss: 11021966.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 193620.2812; val_chrom_access_recon_loss: 9553244.2500; val_global_loss: 24915797.7500; val_optim_loss: 24915797.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8264; val_auprc_score: 0.8034; val_best_acc_score: 0.7324; val_best_f1_score: 0.7706; train_kl_reg_loss: 80362.5143; train_edge_recon_loss: 3503788.8144; train_gene_expr_recon_loss: 11021611.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155539.0890; train_chrom_access_recon_loss: 9590922.9091; train_global_loss: 24352224.8788; train_optim_loss: 24352224.8788; val_kl_reg_loss: 70082.4756; val_edge_recon_loss: 3938027.3750; val_gene_expr_recon_loss: 10987312.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125311.2578; val_chrom_access_recon_loss: 9594640.8750; val_global_loss: 24715374.0000; val_optim_loss: 24715374.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8235; val_auprc_score: 0.7880; val_best_acc_score: 0.7461; val_best_f1_score: 0.7866; train_kl_reg_loss: 63398.8597; train_edge_recon_loss: 3296427.6136; train_gene_expr_recon_loss: 10944166.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107137.1430; train_chrom_access_recon_loss: 9538897.3182; train_global_loss: 23950026.9091; train_optim_loss: 23950026.9091; val_kl_reg_loss: 75492.5645; val_edge_recon_loss: 3098902.3750; val_gene_expr_recon_loss: 11065444.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91714.1328; val_chrom_access_recon_loss: 9584699.2500; val_global_loss: 23916253.0000; val_optim_loss: 23916253.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8535; val_auprc_score: 0.8200; val_best_acc_score: 0.7735; val_best_f1_score: 0.7944; train_kl_reg_loss: 91523.7183; train_edge_recon_loss: 2975863.6742; train_gene_expr_recon_loss: 10875847.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81047.7163; train_chrom_access_recon_loss: 9491445.3030; train_global_loss: 23515728.0303; train_optim_loss: 23515728.0303; val_kl_reg_loss: 91506.4912; val_edge_recon_loss: 2930862.3750; val_gene_expr_recon_loss: 10865584.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71974.3047; val_chrom_access_recon_loss: 9422258.3750; val_global_loss: 23382186.0000; val_optim_loss: 23382186.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8705; val_auprc_score: 0.8447; val_best_acc_score: 0.7910; val_best_f1_score: 0.8055; train_kl_reg_loss: 89771.3761; train_edge_recon_loss: 2942847.3523; train_gene_expr_recon_loss: 10811366.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65295.7701; train_chrom_access_recon_loss: 9436209.9697; train_global_loss: 23345490.7576; train_optim_loss: 23345490.7576; val_kl_reg_loss: 88352.5498; val_edge_recon_loss: 2946559.1875; val_gene_expr_recon_loss: 10762965.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59344.4453; val_chrom_access_recon_loss: 9307431.2500; val_global_loss: 23164652.0000; val_optim_loss: 23164652.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8703; val_auprc_score: 0.8261; val_best_acc_score: 0.8044; val_best_f1_score: 0.8224; train_kl_reg_loss: 84673.9240; train_edge_recon_loss: 2913346.7917; train_gene_expr_recon_loss: 10732726.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54947.0736; train_chrom_access_recon_loss: 9380349.1818; train_global_loss: 23166043.1515; train_optim_loss: 23166043.1515; val_kl_reg_loss: 82226.8027; val_edge_recon_loss: 2910853.5312; val_gene_expr_recon_loss: 10568629.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50800.4922; val_chrom_access_recon_loss: 9249212.6875; val_global_loss: 22861722.2500; val_optim_loss: 22861722.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8913; val_auprc_score: 0.8507; val_best_acc_score: 0.8278; val_best_f1_score: 0.8427; train_kl_reg_loss: 82680.0754; train_edge_recon_loss: 2857009.2273; train_gene_expr_recon_loss: 10694908.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47962.3489; train_chrom_access_recon_loss: 9348271.7879; train_global_loss: 23030831.4848; train_optim_loss: 23030831.4848; val_kl_reg_loss: 82787.8242; val_edge_recon_loss: 2843416.4688; val_gene_expr_recon_loss: 10763444.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45381.4102; val_chrom_access_recon_loss: 9428456.7500; val_global_loss: 23163487.0000; val_optim_loss: 23163487.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8985; val_auprc_score: 0.8653; val_best_acc_score: 0.8332; val_best_f1_score: 0.8457; train_kl_reg_loss: 82886.6043; train_edge_recon_loss: 2827171.3144; train_gene_expr_recon_loss: 10663256.2424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43502.9363; train_chrom_access_recon_loss: 9316971.3939; train_global_loss: 22933788.4242; train_optim_loss: 22933788.4242; val_kl_reg_loss: 82723.3916; val_edge_recon_loss: 2847601.2188; val_gene_expr_recon_loss: 10739743.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41767.5625; val_chrom_access_recon_loss: 9316685.0000; val_global_loss: 23028521.2500; val_optim_loss: 23028521.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9076; val_auprc_score: 0.8676; val_best_acc_score: 0.8525; val_best_f1_score: 0.8640; train_kl_reg_loss: 81707.2075; train_edge_recon_loss: 2818257.1705; train_gene_expr_recon_loss: 10606290.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40201.3145; train_chrom_access_recon_loss: 9276976.0909; train_global_loss: 22823432.3939; train_optim_loss: 22823432.3939; val_kl_reg_loss: 78605.0967; val_edge_recon_loss: 2812888.4688; val_gene_expr_recon_loss: 10539112.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39031.2695; val_chrom_access_recon_loss: 9200214.8750; val_global_loss: 22669851.5000; val_optim_loss: 22669851.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9112; val_auprc_score: 0.8798; val_best_acc_score: 0.8501; val_best_f1_score: 0.8585; train_kl_reg_loss: 83132.6632; train_edge_recon_loss: 2789286.7576; train_gene_expr_recon_loss: 10561319.6212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37868.4679; train_chrom_access_recon_loss: 9234854.6515; train_global_loss: 22706462.3333; train_optim_loss: 22706462.3333; val_kl_reg_loss: 80519.1611; val_edge_recon_loss: 2807148.6250; val_gene_expr_recon_loss: 10558705.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37028.5586; val_chrom_access_recon_loss: 9179545.7500; val_global_loss: 22662947.5000; val_optim_loss: 22662947.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9177; val_auprc_score: 0.8825; val_best_acc_score: 0.8581; val_best_f1_score: 0.8703; train_kl_reg_loss: 82341.5805; train_edge_recon_loss: 2773755.5000; train_gene_expr_recon_loss: 10541698.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36332.3743; train_chrom_access_recon_loss: 9209036.8939; train_global_loss: 22643165.0303; train_optim_loss: 22643165.0303; val_kl_reg_loss: 80130.3916; val_edge_recon_loss: 2796415.0938; val_gene_expr_recon_loss: 10447138.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 35670.7461; val_chrom_access_recon_loss: 9221471.7500; val_global_loss: 22580827.0000; val_optim_loss: 22580827.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9197; val_auprc_score: 0.8843; val_best_acc_score: 0.8611; val_best_f1_score: 0.8701; train_kl_reg_loss: 80168.7443; train_edge_recon_loss: 2770382.2803; train_gene_expr_recon_loss: 10491484.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35194.2359; train_chrom_access_recon_loss: 9168790.0909; train_global_loss: 22546019.5455; train_optim_loss: 22546019.5455; val_kl_reg_loss: 79296.1553; val_edge_recon_loss: 2770796.3750; val_gene_expr_recon_loss: 10394675.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34769.7070; val_chrom_access_recon_loss: 9037428.3750; val_global_loss: 22316966.2500; val_optim_loss: 22316966.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9216; val_auprc_score: 0.8923; val_best_acc_score: 0.8611; val_best_f1_score: 0.8696; train_kl_reg_loss: 80713.5560; train_edge_recon_loss: 2742516.5455; train_gene_expr_recon_loss: 10464211.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 34334.1412; train_chrom_access_recon_loss: 9142086.2424; train_global_loss: 22463862.0000; train_optim_loss: 22463862.0000; val_kl_reg_loss: 81289.2451; val_edge_recon_loss: 2773258.9375; val_gene_expr_recon_loss: 10511363.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33893.2188; val_chrom_access_recon_loss: 9157842.6250; val_global_loss: 22557647.5000; val_optim_loss: 22557647.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9217; val_auprc_score: 0.8870; val_best_acc_score: 0.8622; val_best_f1_score: 0.8724; train_kl_reg_loss: 78495.3391; train_edge_recon_loss: 2755485.1818; train_gene_expr_recon_loss: 10430053.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33680.2288; train_chrom_access_recon_loss: 9118462.1970; train_global_loss: 22416176.5152; train_optim_loss: 22416176.5152; val_kl_reg_loss: 77910.7939; val_edge_recon_loss: 2772354.8438; val_gene_expr_recon_loss: 10392044.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 33324.7461; val_chrom_access_recon_loss: 9146795.3750; val_global_loss: 22422430.2500; val_optim_loss: 22422430.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9177; val_auprc_score: 0.8889; val_best_acc_score: 0.8571; val_best_f1_score: 0.8667; train_kl_reg_loss: 78759.9264; train_edge_recon_loss: 2738460.3977; train_gene_expr_recon_loss: 10402646.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33028.0763; train_chrom_access_recon_loss: 9094952.7424; train_global_loss: 22347847.1515; train_optim_loss: 22347847.1515; val_kl_reg_loss: 78116.6182; val_edge_recon_loss: 2798005.9375; val_gene_expr_recon_loss: 10398240.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32789.6133; val_chrom_access_recon_loss: 9068060.5000; val_global_loss: 22375213.0000; val_optim_loss: 22375213.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9296; val_auprc_score: 0.9082; val_best_acc_score: 0.8678; val_best_f1_score: 0.8731; train_kl_reg_loss: 76341.5940; train_edge_recon_loss: 2731760.9129; train_gene_expr_recon_loss: 10369859.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32545.8134; train_chrom_access_recon_loss: 9068960.1061; train_global_loss: 22279467.6061; train_optim_loss: 22279467.6061; val_kl_reg_loss: 72139.0488; val_edge_recon_loss: 2758316.5625; val_gene_expr_recon_loss: 10402737.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32506.4023; val_chrom_access_recon_loss: 9045857.0000; val_global_loss: 22311556.2500; val_optim_loss: 22311556.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9268; val_auprc_score: 0.9025; val_best_acc_score: 0.8608; val_best_f1_score: 0.8700; train_kl_reg_loss: 74853.7837; train_edge_recon_loss: 2725811.7462; train_gene_expr_recon_loss: 10343872.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32187.0877; train_chrom_access_recon_loss: 9036420.0303; train_global_loss: 22213144.9697; train_optim_loss: 22213144.9697; val_kl_reg_loss: 73081.6182; val_edge_recon_loss: 2779296.6562; val_gene_expr_recon_loss: 10256483.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31973.3711; val_chrom_access_recon_loss: 9009709.2500; val_global_loss: 22150543.5000; val_optim_loss: 22150543.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9253; val_auprc_score: 0.9005; val_best_acc_score: 0.8675; val_best_f1_score: 0.8760; train_kl_reg_loss: 74839.7723; train_edge_recon_loss: 2728548.2614; train_gene_expr_recon_loss: 10317114.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31727.4197; train_chrom_access_recon_loss: 9020806.6212; train_global_loss: 22173036.2727; train_optim_loss: 22173036.2727; val_kl_reg_loss: 73536.2979; val_edge_recon_loss: 2748386.5625; val_gene_expr_recon_loss: 10346934.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31643.5664; val_chrom_access_recon_loss: 9060417.5000; val_global_loss: 22260919.5000; val_optim_loss: 22260919.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9320; val_auprc_score: 0.9005; val_best_acc_score: 0.8740; val_best_f1_score: 0.8814; train_kl_reg_loss: 73236.8735; train_edge_recon_loss: 2713976.0492; train_gene_expr_recon_loss: 10288700.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 31346.6085; train_chrom_access_recon_loss: 8986240.1212; train_global_loss: 22093500.3333; train_optim_loss: 22093500.3333; val_kl_reg_loss: 73621.0254; val_edge_recon_loss: 2738576.5000; val_gene_expr_recon_loss: 10271162.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31217.2461; val_chrom_access_recon_loss: 8919832.1250; val_global_loss: 22034409.5000; val_optim_loss: 22034409.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9329; val_auprc_score: 0.9055; val_best_acc_score: 0.8788; val_best_f1_score: 0.8842; train_kl_reg_loss: 72557.3546; train_edge_recon_loss: 2713037.7803; train_gene_expr_recon_loss: 10256635.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30985.8087; train_chrom_access_recon_loss: 8960702.5758; train_global_loss: 22033918.9697; train_optim_loss: 22033918.9697; val_kl_reg_loss: 69673.7812; val_edge_recon_loss: 2752287.2500; val_gene_expr_recon_loss: 10204306.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30957.8574; val_chrom_access_recon_loss: 8985095.0000; val_global_loss: 22042320.7500; val_optim_loss: 22042320.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9355; val_auprc_score: 0.9092; val_best_acc_score: 0.8775; val_best_f1_score: 0.8833; train_kl_reg_loss: 70463.8931; train_edge_recon_loss: 2718245.8977; train_gene_expr_recon_loss: 10252424.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30767.9422; train_chrom_access_recon_loss: 8942046.7121; train_global_loss: 22013948.7273; train_optim_loss: 22013948.7273; val_kl_reg_loss: 69036.6709; val_edge_recon_loss: 2766608.5938; val_gene_expr_recon_loss: 10184582.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30539.0723; val_chrom_access_recon_loss: 8820392.8750; val_global_loss: 21871159.2500; val_optim_loss: 21871159.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9420; val_auprc_score: 0.9204; val_best_acc_score: 0.8850; val_best_f1_score: 0.8907; train_kl_reg_loss: 69799.0621; train_edge_recon_loss: 2704288.0152; train_gene_expr_recon_loss: 10222329.9697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30441.4921; train_chrom_access_recon_loss: 8915058.2727; train_global_loss: 21941916.8788; train_optim_loss: 21941916.8788; val_kl_reg_loss: 68670.5391; val_edge_recon_loss: 2725256.0938; val_gene_expr_recon_loss: 10261045.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30376.0684; val_chrom_access_recon_loss: 8939237.6250; val_global_loss: 22024586.0000; val_optim_loss: 22024586.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9450; val_auprc_score: 0.9230; val_best_acc_score: 0.8896; val_best_f1_score: 0.8970; train_kl_reg_loss: 68942.0266; train_edge_recon_loss: 2716918.5341; train_gene_expr_recon_loss: 10212679.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30247.8967; train_chrom_access_recon_loss: 8902884.7803; train_global_loss: 21931672.9091; train_optim_loss: 21931672.9091; val_kl_reg_loss: 66591.5684; val_edge_recon_loss: 2703384.2500; val_gene_expr_recon_loss: 10168069.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30040.1641; val_chrom_access_recon_loss: 8886932.3750; val_global_loss: 21855017.7500; val_optim_loss: 21855017.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9410; val_auprc_score: 0.9206; val_best_acc_score: 0.8812; val_best_f1_score: 0.8886; train_kl_reg_loss: 67617.2058; train_edge_recon_loss: 2692468.3939; train_gene_expr_recon_loss: 10185435.8788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29955.4550; train_chrom_access_recon_loss: 8888494.5758; train_global_loss: 21863971.3939; train_optim_loss: 21863971.3939; val_kl_reg_loss: 65591.2466; val_edge_recon_loss: 2742635.6562; val_gene_expr_recon_loss: 10236641.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 30014.6699; val_chrom_access_recon_loss: 8904615.8750; val_global_loss: 21979499.0000; val_optim_loss: 21979499.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9455; val_auprc_score: 0.9262; val_best_acc_score: 0.8896; val_best_f1_score: 0.8943; train_kl_reg_loss: 66817.0779; train_edge_recon_loss: 2701545.2803; train_gene_expr_recon_loss: 10164425.1364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29869.2239; train_chrom_access_recon_loss: 8862785.2045; train_global_loss: 21825441.9394; train_optim_loss: 21825441.9394; val_kl_reg_loss: 64373.0654; val_edge_recon_loss: 2719798.6250; val_gene_expr_recon_loss: 10143719.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29828.5527; val_chrom_access_recon_loss: 8832333.7500; val_global_loss: 21790054.0000; val_optim_loss: 21790054.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9460; val_auprc_score: 0.9254; val_best_acc_score: 0.8917; val_best_f1_score: 0.8972; train_kl_reg_loss: 66475.1323; train_edge_recon_loss: 2691355.9924; train_gene_expr_recon_loss: 10151721.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29696.0001; train_chrom_access_recon_loss: 8842774.6061; train_global_loss: 21782023.2424; train_optim_loss: 21782023.2424; val_kl_reg_loss: 65682.8359; val_edge_recon_loss: 2711015.7812; val_gene_expr_recon_loss: 10218555.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29690.8438; val_chrom_access_recon_loss: 9016778.0000; val_global_loss: 22041722.7500; val_optim_loss: 22041722.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9499; val_auprc_score: 0.9297; val_best_acc_score: 0.8941; val_best_f1_score: 0.8978; train_kl_reg_loss: 64952.6549; train_edge_recon_loss: 2690122.5114; train_gene_expr_recon_loss: 10136413.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29569.5892; train_chrom_access_recon_loss: 8829352.1136; train_global_loss: 21750410.4242; train_optim_loss: 21750410.4242; val_kl_reg_loss: 64105.6938; val_edge_recon_loss: 2712000.4375; val_gene_expr_recon_loss: 10180467.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29627.0391; val_chrom_access_recon_loss: 8852839.2500; val_global_loss: 21839040.0000; val_optim_loss: 21839040.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9530; val_auprc_score: 0.9339; val_best_acc_score: 0.8968; val_best_f1_score: 0.9024; train_kl_reg_loss: 64355.1471; train_edge_recon_loss: 2701359.4697; train_gene_expr_recon_loss: 10121601.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29543.8156; train_chrom_access_recon_loss: 8805694.1591; train_global_loss: 21722553.8788; train_optim_loss: 21722553.8788; val_kl_reg_loss: 62518.8677; val_edge_recon_loss: 2704204.5000; val_gene_expr_recon_loss: 10207703.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29515.2832; val_chrom_access_recon_loss: 8891492.0000; val_global_loss: 21895434.2500; val_optim_loss: 21895434.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9428; val_auprc_score: 0.9226; val_best_acc_score: 0.8850; val_best_f1_score: 0.8911; train_kl_reg_loss: 63393.5913; train_edge_recon_loss: 2687642.9924; train_gene_expr_recon_loss: 10105698.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29422.6571; train_chrom_access_recon_loss: 8783532.4621; train_global_loss: 21669689.5758; train_optim_loss: 21669689.5758; val_kl_reg_loss: 64268.6177; val_edge_recon_loss: 2734592.8125; val_gene_expr_recon_loss: 10148344.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 29400.2227; val_chrom_access_recon_loss: 8822417.7500; val_global_loss: 21799023.5000; val_optim_loss: 21799023.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9483; val_auprc_score: 0.9290; val_best_acc_score: 0.8920; val_best_f1_score: 0.8962; train_kl_reg_loss: 64219.4844; train_edge_recon_loss: 2683982.9394; train_gene_expr_recon_loss: 10085486.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26409.8518; train_chrom_access_recon_loss: 8761785.9318; train_global_loss: 21621884.6364; train_optim_loss: 21621884.6364; val_kl_reg_loss: 64291.8086; val_edge_recon_loss: 2714113.9375; val_gene_expr_recon_loss: 10070144.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25451.6641; val_chrom_access_recon_loss: 8744565.6250; val_global_loss: 21618567.7500; val_optim_loss: 21618567.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9462; val_auprc_score: 0.9222; val_best_acc_score: 0.8882; val_best_f1_score: 0.8936; train_kl_reg_loss: 64466.4752; train_edge_recon_loss: 2681405.6515; train_gene_expr_recon_loss: 10074186.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25300.1275; train_chrom_access_recon_loss: 8750690.4848; train_global_loss: 21596048.9091; train_optim_loss: 21596048.9091; val_kl_reg_loss: 64797.0405; val_edge_recon_loss: 2714401.4688; val_gene_expr_recon_loss: 10184893.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25193.8691; val_chrom_access_recon_loss: 8788512.5000; val_global_loss: 21777798.7500; val_optim_loss: 21777798.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9409; val_auprc_score: 0.9200; val_best_acc_score: 0.8831; val_best_f1_score: 0.8893; train_kl_reg_loss: 64661.1115; train_edge_recon_loss: 2671173.2803; train_gene_expr_recon_loss: 10073541.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25125.5525; train_chrom_access_recon_loss: 8747518.5985; train_global_loss: 21582019.9697; train_optim_loss: 21582019.9697; val_kl_reg_loss: 65121.9141; val_edge_recon_loss: 2762407.9688; val_gene_expr_recon_loss: 10109076.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25072.2891; val_chrom_access_recon_loss: 8796814.5000; val_global_loss: 21758492.7500; val_optim_loss: 21758492.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9502; val_auprc_score: 0.9289; val_best_acc_score: 0.8915; val_best_f1_score: 0.8969; train_kl_reg_loss: 64601.6026; train_edge_recon_loss: 2688140.3788; train_gene_expr_recon_loss: 10071534.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25026.5049; train_chrom_access_recon_loss: 8751437.2273; train_global_loss: 21600740.5152; train_optim_loss: 21600740.5152; val_kl_reg_loss: 64149.4106; val_edge_recon_loss: 2734257.8125; val_gene_expr_recon_loss: 10074823.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24975.1074; val_chrom_access_recon_loss: 8745794.7500; val_global_loss: 21644000.2500; val_optim_loss: 21644000.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9530; val_auprc_score: 0.9335; val_best_acc_score: 0.8966; val_best_f1_score: 0.9021; train_kl_reg_loss: 64332.5128; train_edge_recon_loss: 2685245.0682; train_gene_expr_recon_loss: 10075210.7273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24942.5014; train_chrom_access_recon_loss: 8763622.4773; train_global_loss: 21613353.1212; train_optim_loss: 21613353.1212; val_kl_reg_loss: 64836.1357; val_edge_recon_loss: 2681543.4375; val_gene_expr_recon_loss: 10115842.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24904.5898; val_chrom_access_recon_loss: 8820968.8750; val_global_loss: 21708096.0000; val_optim_loss: 21708096.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9464; val_auprc_score: 0.9199; val_best_acc_score: 0.8912; val_best_f1_score: 0.8961; train_kl_reg_loss: 64553.4264; train_edge_recon_loss: 2685794.1250; train_gene_expr_recon_loss: 10066325.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24614.7671; train_chrom_access_recon_loss: 8742584.0000; train_global_loss: 21583872.1515; train_optim_loss: 21583872.1515; val_kl_reg_loss: 64009.7690; val_edge_recon_loss: 2714790.7500; val_gene_expr_recon_loss: 10040038.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24526.4160; val_chrom_access_recon_loss: 8708669.2500; val_global_loss: 21552034.2500; val_optim_loss: 21552034.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9491; val_auprc_score: 0.9290; val_best_acc_score: 0.8968; val_best_f1_score: 0.9016; train_kl_reg_loss: 64421.2173; train_edge_recon_loss: 2682802.6856; train_gene_expr_recon_loss: 10064466.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24508.5703; train_chrom_access_recon_loss: 8739674.4545; train_global_loss: 21575873.2727; train_optim_loss: 21575873.2727; val_kl_reg_loss: 64043.4595; val_edge_recon_loss: 2701827.0000; val_gene_expr_recon_loss: 10123162.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24496.9863; val_chrom_access_recon_loss: 8808753.2500; val_global_loss: 21722282.5000; val_optim_loss: 21722282.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9496; val_auprc_score: 0.9226; val_best_acc_score: 0.8944; val_best_f1_score: 0.8996; train_kl_reg_loss: 64394.9769; train_edge_recon_loss: 2682874.7121; train_gene_expr_recon_loss: 10072626.2121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24488.5091; train_chrom_access_recon_loss: 8745683.5076; train_global_loss: 21590067.7879; train_optim_loss: 21590067.7879; val_kl_reg_loss: 64472.5830; val_edge_recon_loss: 2696742.5000; val_gene_expr_recon_loss: 10075119.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24480.9609; val_chrom_access_recon_loss: 8750118.7500; val_global_loss: 21610934.7500; val_optim_loss: 21610934.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9435; val_auprc_score: 0.9169; val_best_acc_score: 0.8909; val_best_f1_score: 0.8957; train_kl_reg_loss: 64541.5958; train_edge_recon_loss: 2676245.1780; train_gene_expr_recon_loss: 10067668.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24474.4795; train_chrom_access_recon_loss: 8742743.6970; train_global_loss: 21575673.3333; train_optim_loss: 21575673.3333; val_kl_reg_loss: 64588.6357; val_edge_recon_loss: 2717816.4375; val_gene_expr_recon_loss: 10081535.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24468.2344; val_chrom_access_recon_loss: 8712664.6250; val_global_loss: 21601072.5000; val_optim_loss: 21601072.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9563; val_auprc_score: 0.9381; val_best_acc_score: 0.9044; val_best_f1_score: 0.9094; train_kl_reg_loss: 64594.1651; train_edge_recon_loss: 2688476.3788; train_gene_expr_recon_loss: 10065654.9848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24462.9497; train_chrom_access_recon_loss: 8753439.7652; train_global_loss: 21596628.3333; train_optim_loss: 21596628.3333; val_kl_reg_loss: 64079.8799; val_edge_recon_loss: 2673077.6250; val_gene_expr_recon_loss: 10172389.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24457.5566; val_chrom_access_recon_loss: 8768179.0000; val_global_loss: 21702184.2500; val_optim_loss: 21702184.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9465; val_auprc_score: 0.9278; val_best_acc_score: 0.8917; val_best_f1_score: 0.8982; train_kl_reg_loss: 64640.1542; train_edge_recon_loss: 2690077.3561; train_gene_expr_recon_loss: 10067322.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24427.9825; train_chrom_access_recon_loss: 8743743.6742; train_global_loss: 21590211.0606; train_optim_loss: 21590211.0606; val_kl_reg_loss: 65066.2920; val_edge_recon_loss: 2707624.0312; val_gene_expr_recon_loss: 10130405.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24418.9629; val_chrom_access_recon_loss: 8820172.5000; val_global_loss: 21747686.7500; val_optim_loss: 21747686.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9506; val_auprc_score: 0.9322; val_best_acc_score: 0.8963; val_best_f1_score: 0.9004; train_kl_reg_loss: 64588.6394; train_edge_recon_loss: 2691892.2500; train_gene_expr_recon_loss: 10069375.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24417.4140; train_chrom_access_recon_loss: 8744031.4394; train_global_loss: 21594304.8182; train_optim_loss: 21594304.8182; val_kl_reg_loss: 64363.9756; val_edge_recon_loss: 2727665.3125; val_gene_expr_recon_loss: 10128193.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24416.1035; val_chrom_access_recon_loss: 8815120.5000; val_global_loss: 21759759.2500; val_optim_loss: 21759759.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9450; val_auprc_score: 0.9244; val_best_acc_score: 0.8874; val_best_f1_score: 0.8948; train_kl_reg_loss: 64556.1555; train_edge_recon_loss: 2684918.7045; train_gene_expr_recon_loss: 10069329.2576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24415.2477; train_chrom_access_recon_loss: 8752082.3409; train_global_loss: 21595301.8182; train_optim_loss: 21595301.8182; val_kl_reg_loss: 64414.0596; val_edge_recon_loss: 2726791.6250; val_gene_expr_recon_loss: 10068629.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24414.4473; val_chrom_access_recon_loss: 8698881.8750; val_global_loss: 21583130.7500; val_optim_loss: 21583130.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9513; val_auprc_score: 0.9366; val_best_acc_score: 0.8952; val_best_f1_score: 0.8993; train_kl_reg_loss: 64640.2910; train_edge_recon_loss: 2695326.7803; train_gene_expr_recon_loss: 10068047.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24413.7114; train_chrom_access_recon_loss: 8737317.6439; train_global_loss: 21589745.9394; train_optim_loss: 21589745.9394; val_kl_reg_loss: 63927.8535; val_edge_recon_loss: 2721410.3438; val_gene_expr_recon_loss: 10038344.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24412.9941; val_chrom_access_recon_loss: 8683757.5000; val_global_loss: 21531852.7500; val_optim_loss: 21531852.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9486; val_auprc_score: 0.9286; val_best_acc_score: 0.8874; val_best_f1_score: 0.8938; train_kl_reg_loss: 64554.9032; train_edge_recon_loss: 2691523.1629; train_gene_expr_recon_loss: 10066379.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24412.3768; train_chrom_access_recon_loss: 8745834.2803; train_global_loss: 21592704.7879; train_optim_loss: 21592704.7879; val_kl_reg_loss: 64579.9326; val_edge_recon_loss: 2739047.4062; val_gene_expr_recon_loss: 10100929.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24411.6309; val_chrom_access_recon_loss: 8818967.1250; val_global_loss: 21747936.0000; val_optim_loss: 21747936.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9438; val_auprc_score: 0.9192; val_best_acc_score: 0.8912; val_best_f1_score: 0.8965; train_kl_reg_loss: 64523.4787; train_edge_recon_loss: 2691996.5038; train_gene_expr_recon_loss: 10071329.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24411.0927; train_chrom_access_recon_loss: 8748513.6136; train_global_loss: 21600773.9394; train_optim_loss: 21600773.9394; val_kl_reg_loss: 64859.0562; val_edge_recon_loss: 2740561.5312; val_gene_expr_recon_loss: 10111249.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24410.4551; val_chrom_access_recon_loss: 8950460.1250; val_global_loss: 21891540.2500; val_optim_loss: 21891540.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9499; val_auprc_score: 0.9326; val_best_acc_score: 0.8896; val_best_f1_score: 0.8965; train_kl_reg_loss: 64593.9163; train_edge_recon_loss: 2680856.3258; train_gene_expr_recon_loss: 10063287.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24409.8843; train_chrom_access_recon_loss: 8743509.5758; train_global_loss: 21576656.7576; train_optim_loss: 21576656.7576; val_kl_reg_loss: 64592.0630; val_edge_recon_loss: 2731809.1250; val_gene_expr_recon_loss: 10103010.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24409.2949; val_chrom_access_recon_loss: 8734811.2500; val_global_loss: 21658632.5000; val_optim_loss: 21658632.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9457; val_auprc_score: 0.9189; val_best_acc_score: 0.8912; val_best_f1_score: 0.8972; train_kl_reg_loss: 64594.9958; train_edge_recon_loss: 2680856.6932; train_gene_expr_recon_loss: 10066549.3788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24408.7185; train_chrom_access_recon_loss: 8740283.4394; train_global_loss: 21576693.0303; train_optim_loss: 21576693.0303; val_kl_reg_loss: 64202.1455; val_edge_recon_loss: 2732054.5000; val_gene_expr_recon_loss: 10065439.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24408.1953; val_chrom_access_recon_loss: 8766443.1250; val_global_loss: 21652547.0000; val_optim_loss: 21652547.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9529; val_auprc_score: 0.9349; val_best_acc_score: 0.8998; val_best_f1_score: 0.9043; train_kl_reg_loss: 64605.9815; train_edge_recon_loss: 2677115.7159; train_gene_expr_recon_loss: 10080999.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24405.1087; train_chrom_access_recon_loss: 8757086.0000; train_global_loss: 21604212.3030; train_optim_loss: 21604212.3030; val_kl_reg_loss: 64647.0522; val_edge_recon_loss: 2692230.7500; val_gene_expr_recon_loss: 10076471.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24404.1758; val_chrom_access_recon_loss: 8845405.3750; val_global_loss: 21703158.5000; val_optim_loss: 21703158.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9485; val_auprc_score: 0.9288; val_best_acc_score: 0.8952; val_best_f1_score: 0.8996; train_kl_reg_loss: 64652.1823; train_edge_recon_loss: 2683894.9280; train_gene_expr_recon_loss: 10069352.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24404.0093; train_chrom_access_recon_loss: 8746440.2273; train_global_loss: 21588744.3030; train_optim_loss: 21588744.3030; val_kl_reg_loss: 64845.6362; val_edge_recon_loss: 2707585.6250; val_gene_expr_recon_loss: 10097790.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24403.8809; val_chrom_access_recon_loss: 8821481.2500; val_global_loss: 21716106.7500; val_optim_loss: 21716106.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9509; val_auprc_score: 0.9346; val_best_acc_score: 0.8941; val_best_f1_score: 0.8993; train_kl_reg_loss: 64578.9177; train_edge_recon_loss: 2690788.3447; train_gene_expr_recon_loss: 10067106.0152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24403.7896; train_chrom_access_recon_loss: 8744501.0455; train_global_loss: 21591378.3333; train_optim_loss: 21591378.3333; val_kl_reg_loss: 64900.0098; val_edge_recon_loss: 2717648.5000; val_gene_expr_recon_loss: 10163846.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24403.7012; val_chrom_access_recon_loss: 8802070.8750; val_global_loss: 21772869.5000; val_optim_loss: 21772869.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9544; val_auprc_score: 0.9373; val_best_acc_score: 0.8992; val_best_f1_score: 0.9031; train_kl_reg_loss: 64562.8018; train_edge_recon_loss: 2684240.8485; train_gene_expr_recon_loss: 10071588.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24403.6235; train_chrom_access_recon_loss: 8751856.7803; train_global_loss: 21596652.6061; train_optim_loss: 21596652.6061; val_kl_reg_loss: 64672.8223; val_edge_recon_loss: 2705175.4688; val_gene_expr_recon_loss: 10076891.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24403.5566; val_chrom_access_recon_loss: 8781329.8750; val_global_loss: 21652473.0000; val_optim_loss: 21652473.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 29 min 13 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9506
val AUPRC score: 0.9316
val best accuracy score: 0.8990
val best F1 score: 0.9026
val target rna MSE score: 1.1689
val source rna MSE score: 0.3344
val target atac MSE score: 0.3197
val source atac MSE score: 0.0707
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
