[True]
Run timestamp: 10102023_094812_222.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_222']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7548; val_auprc_score: 0.7673; val_best_acc_score: 0.5524; val_best_f1_score: 0.6890; train_kl_reg_loss: 56397.9896; train_edge_recon_loss: 735599.8502; train_gene_expr_recon_loss: 22088657.8321; train_masked_gp_l1_reg_loss: 137376.3965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3336588.7323; train_chrom_access_recon_loss: 6723498.6107; train_global_loss: 33078119.2824; train_optim_loss: 33078119.2824; val_kl_reg_loss: 73441.1583; val_edge_recon_loss: 812526.9667; val_gene_expr_recon_loss: 21029211.3333; val_masked_gp_l1_reg_loss: 112218.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 819578.1875; val_chrom_access_recon_loss: 6505788.3000; val_global_loss: 29352763.7333; val_optim_loss: 29352763.7333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8785; val_auprc_score: 0.8808; val_best_acc_score: 0.7551; val_best_f1_score: 0.7924; train_kl_reg_loss: 71863.1690; train_edge_recon_loss: 733875.4265; train_gene_expr_recon_loss: 20825806.2443; train_masked_gp_l1_reg_loss: 107603.9112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 416368.7458; train_chrom_access_recon_loss: 6476357.2824; train_global_loss: 28631874.5954; train_optim_loss: 28631874.5954; val_kl_reg_loss: 66489.4302; val_edge_recon_loss: 807584.7750; val_gene_expr_recon_loss: 20763193.3333; val_masked_gp_l1_reg_loss: 106137.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 230639.4375; val_chrom_access_recon_loss: 6444265.9000; val_global_loss: 28418311.3333; val_optim_loss: 28418311.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8960; val_auprc_score: 0.8891; val_best_acc_score: 0.8007; val_best_f1_score: 0.8214; train_kl_reg_loss: 64053.1197; train_edge_recon_loss: 721737.1479; train_gene_expr_recon_loss: 20542126.7328; train_masked_gp_l1_reg_loss: 107319.7773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 184480.5766; train_chrom_access_recon_loss: 6396104.8664; train_global_loss: 28015822.2443; train_optim_loss: 28015822.2443; val_kl_reg_loss: 63552.3802; val_edge_recon_loss: 757512.5625; val_gene_expr_recon_loss: 20641606.5333; val_masked_gp_l1_reg_loss: 108989.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155991.3750; val_chrom_access_recon_loss: 6393408.7667; val_global_loss: 28121062.2667; val_optim_loss: 28121062.2667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8990; val_auprc_score: 0.8915; val_best_acc_score: 0.8119; val_best_f1_score: 0.8260; train_kl_reg_loss: 65452.3781; train_edge_recon_loss: 667214.7748; train_gene_expr_recon_loss: 20335522.0611; train_masked_gp_l1_reg_loss: 111787.6805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141290.5102; train_chrom_access_recon_loss: 6339775.4198; train_global_loss: 27661042.9618; train_optim_loss: 27661042.9618; val_kl_reg_loss: 75006.2188; val_edge_recon_loss: 637852.3125; val_gene_expr_recon_loss: 20343685.0667; val_masked_gp_l1_reg_loss: 113524.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130342.9531; val_chrom_access_recon_loss: 6345137.1667; val_global_loss: 27645546.8000; val_optim_loss: 27645546.8000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9069; val_auprc_score: 0.8977; val_best_acc_score: 0.8174; val_best_f1_score: 0.8291; train_kl_reg_loss: 72888.6128; train_edge_recon_loss: 631314.7362; train_gene_expr_recon_loss: 20115425.4962; train_masked_gp_l1_reg_loss: 114335.7306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123636.8105; train_chrom_access_recon_loss: 6274778.3626; train_global_loss: 27332379.6183; train_optim_loss: 27332379.6183; val_kl_reg_loss: 75128.0969; val_edge_recon_loss: 627199.2458; val_gene_expr_recon_loss: 20146014.1333; val_masked_gp_l1_reg_loss: 115264.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118771.4141; val_chrom_access_recon_loss: 6253371.5333; val_global_loss: 27335748.9333; val_optim_loss: 27335748.9333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9185; val_auprc_score: 0.9069; val_best_acc_score: 0.8294; val_best_f1_score: 0.8403; train_kl_reg_loss: 72005.3609; train_edge_recon_loss: 621404.2820; train_gene_expr_recon_loss: 19966747.3282; train_masked_gp_l1_reg_loss: 115728.4664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113501.9543; train_chrom_access_recon_loss: 6229510.6489; train_global_loss: 27118897.9542; train_optim_loss: 27118897.9542; val_kl_reg_loss: 71027.8458; val_edge_recon_loss: 620767.6375; val_gene_expr_recon_loss: 20099512.6667; val_masked_gp_l1_reg_loss: 117131.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110661.5312; val_chrom_access_recon_loss: 6251832.4333; val_global_loss: 27270934.5333; val_optim_loss: 27270934.5333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9320; val_auprc_score: 0.9232; val_best_acc_score: 0.8491; val_best_f1_score: 0.8583; train_kl_reg_loss: 71055.8961; train_edge_recon_loss: 613303.8364; train_gene_expr_recon_loss: 19830219.4656; train_masked_gp_l1_reg_loss: 117362.7801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107178.3275; train_chrom_access_recon_loss: 6179567.9237; train_global_loss: 26918688.2137; train_optim_loss: 26918688.2137; val_kl_reg_loss: 70593.2359; val_edge_recon_loss: 610088.5292; val_gene_expr_recon_loss: 19886938.5333; val_masked_gp_l1_reg_loss: 118069.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105617.9531; val_chrom_access_recon_loss: 6192331.9000; val_global_loss: 26983640.1333; val_optim_loss: 26983640.1333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9333; val_auprc_score: 0.9232; val_best_acc_score: 0.8554; val_best_f1_score: 0.8625; train_kl_reg_loss: 71106.6122; train_edge_recon_loss: 607899.1045; train_gene_expr_recon_loss: 19700250.4885; train_masked_gp_l1_reg_loss: 118395.8281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103831.5174; train_chrom_access_recon_loss: 6149260.1489; train_global_loss: 26750743.5420; train_optim_loss: 26750743.5420; val_kl_reg_loss: 70223.2266; val_edge_recon_loss: 608393.0917; val_gene_expr_recon_loss: 19782212.4000; val_masked_gp_l1_reg_loss: 119067.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102414.0938; val_chrom_access_recon_loss: 6137610.4000; val_global_loss: 26819920.9333; val_optim_loss: 26819920.9333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9399; val_auprc_score: 0.9252; val_best_acc_score: 0.8697; val_best_f1_score: 0.8762; train_kl_reg_loss: 70033.3938; train_edge_recon_loss: 605748.9103; train_gene_expr_recon_loss: 19618409.9542; train_masked_gp_l1_reg_loss: 119059.7996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100556.0945; train_chrom_access_recon_loss: 6120743.6756; train_global_loss: 26634551.8168; train_optim_loss: 26634551.8168; val_kl_reg_loss: 70690.8495; val_edge_recon_loss: 605588.0958; val_gene_expr_recon_loss: 19675648.4000; val_masked_gp_l1_reg_loss: 119812.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99813.0938; val_chrom_access_recon_loss: 6109393.6000; val_global_loss: 26680946.9333; val_optim_loss: 26680946.9333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9417; val_auprc_score: 0.9256; val_best_acc_score: 0.8771; val_best_f1_score: 0.8801; train_kl_reg_loss: 69601.3342; train_edge_recon_loss: 602202.8793; train_gene_expr_recon_loss: 19487592.6870; train_masked_gp_l1_reg_loss: 120042.6214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98009.4522; train_chrom_access_recon_loss: 6076140.2328; train_global_loss: 26453589.3282; train_optim_loss: 26453589.3282; val_kl_reg_loss: 67324.2417; val_edge_recon_loss: 603709.2792; val_gene_expr_recon_loss: 19617482.4000; val_masked_gp_l1_reg_loss: 120523.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96908.6250; val_chrom_access_recon_loss: 6094398.2333; val_global_loss: 26600345.7333; val_optim_loss: 26600345.7333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9480; val_auprc_score: 0.9372; val_best_acc_score: 0.8805; val_best_f1_score: 0.8865; train_kl_reg_loss: 69125.1693; train_edge_recon_loss: 599203.9031; train_gene_expr_recon_loss: 19408729.0534; train_masked_gp_l1_reg_loss: 120714.1710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95909.3184; train_chrom_access_recon_loss: 6051765.1107; train_global_loss: 26345446.7176; train_optim_loss: 26345446.7176; val_kl_reg_loss: 69294.0604; val_edge_recon_loss: 601694.6042; val_gene_expr_recon_loss: 19515977.6000; val_masked_gp_l1_reg_loss: 120796.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94839.6641; val_chrom_access_recon_loss: 6085110.0000; val_global_loss: 26487712.0000; val_optim_loss: 26487712.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9558; val_auprc_score: 0.9455; val_best_acc_score: 0.8930; val_best_f1_score: 0.8975; train_kl_reg_loss: 68509.5438; train_edge_recon_loss: 597871.4981; train_gene_expr_recon_loss: 19322264.5954; train_masked_gp_l1_reg_loss: 121294.8669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93992.4710; train_chrom_access_recon_loss: 6018759.1298; train_global_loss: 26222691.9695; train_optim_loss: 26222691.9695; val_kl_reg_loss: 69440.5255; val_edge_recon_loss: 591394.8333; val_gene_expr_recon_loss: 19476469.6000; val_masked_gp_l1_reg_loss: 122187.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93583.9531; val_chrom_access_recon_loss: 6037098.4333; val_global_loss: 26390175.3333; val_optim_loss: 26390175.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9579; val_auprc_score: 0.9493; val_best_acc_score: 0.8956; val_best_f1_score: 0.8991; train_kl_reg_loss: 68476.3231; train_edge_recon_loss: 593303.9594; train_gene_expr_recon_loss: 19256619.4046; train_masked_gp_l1_reg_loss: 122147.6842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92656.4917; train_chrom_access_recon_loss: 5994116.2710; train_global_loss: 26127320.1374; train_optim_loss: 26127320.1374; val_kl_reg_loss: 67970.7341; val_edge_recon_loss: 595159.3208; val_gene_expr_recon_loss: 19308460.1333; val_masked_gp_l1_reg_loss: 122313.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92173.8516; val_chrom_access_recon_loss: 5999694.3667; val_global_loss: 26185772.5333; val_optim_loss: 26185772.5333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9539; val_auprc_score: 0.9413; val_best_acc_score: 0.8953; val_best_f1_score: 0.8989; train_kl_reg_loss: 67672.7507; train_edge_recon_loss: 594143.3869; train_gene_expr_recon_loss: 19188585.4504; train_masked_gp_l1_reg_loss: 122922.4393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91469.0816; train_chrom_access_recon_loss: 5962256.1565; train_global_loss: 26027049.3893; train_optim_loss: 26027049.3893; val_kl_reg_loss: 65676.7367; val_edge_recon_loss: 596178.6042; val_gene_expr_recon_loss: 19211529.4667; val_masked_gp_l1_reg_loss: 123043.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90672.8984; val_chrom_access_recon_loss: 5973347.8333; val_global_loss: 26060448.8000; val_optim_loss: 26060448.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9621; val_auprc_score: 0.9513; val_best_acc_score: 0.9015; val_best_f1_score: 0.9054; train_kl_reg_loss: 67461.3226; train_edge_recon_loss: 590312.5668; train_gene_expr_recon_loss: 19118850.0458; train_masked_gp_l1_reg_loss: 123683.5982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90365.4142; train_chrom_access_recon_loss: 5935055.0229; train_global_loss: 25925727.8168; train_optim_loss: 25925727.8168; val_kl_reg_loss: 68434.2052; val_edge_recon_loss: 594635.5917; val_gene_expr_recon_loss: 19238613.8667; val_masked_gp_l1_reg_loss: 124214.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90531.2344; val_chrom_access_recon_loss: 5957456.8333; val_global_loss: 26073886.4000; val_optim_loss: 26073886.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9604; val_auprc_score: 0.9498; val_best_acc_score: 0.9088; val_best_f1_score: 0.9116; train_kl_reg_loss: 66982.8669; train_edge_recon_loss: 590657.8149; train_gene_expr_recon_loss: 19050846.9313; train_masked_gp_l1_reg_loss: 124645.0237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89909.3873; train_chrom_access_recon_loss: 5902720.0382; train_global_loss: 25825761.9542; train_optim_loss: 25825761.9542; val_kl_reg_loss: 65083.9367; val_edge_recon_loss: 591952.0542; val_gene_expr_recon_loss: 19152403.3333; val_masked_gp_l1_reg_loss: 125198.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89765.3828; val_chrom_access_recon_loss: 5905056.9667; val_global_loss: 25929460.2667; val_optim_loss: 25929460.2667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9640; val_auprc_score: 0.9551; val_best_acc_score: 0.9084; val_best_f1_score: 0.9124; train_kl_reg_loss: 66763.0648; train_edge_recon_loss: 588856.4213; train_gene_expr_recon_loss: 18979548.3511; train_masked_gp_l1_reg_loss: 125541.5476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89340.8910; train_chrom_access_recon_loss: 5868084.2595; train_global_loss: 25718134.6107; train_optim_loss: 25718134.6107; val_kl_reg_loss: 64657.8253; val_edge_recon_loss: 587904.8542; val_gene_expr_recon_loss: 19069259.2000; val_masked_gp_l1_reg_loss: 125996.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89328.9609; val_chrom_access_recon_loss: 5883637.6000; val_global_loss: 25820783.6000; val_optim_loss: 25820783.6000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9662; val_auprc_score: 0.9580; val_best_acc_score: 0.9167; val_best_f1_score: 0.9197; train_kl_reg_loss: 66842.8174; train_edge_recon_loss: 588000.2552; train_gene_expr_recon_loss: 18943543.6641; train_masked_gp_l1_reg_loss: 126614.5550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88955.8180; train_chrom_access_recon_loss: 5853418.1565; train_global_loss: 25667375.2824; train_optim_loss: 25667375.2824; val_kl_reg_loss: 65979.5044; val_edge_recon_loss: 586645.9542; val_gene_expr_recon_loss: 19044439.6000; val_masked_gp_l1_reg_loss: 127360.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89341.8672; val_chrom_access_recon_loss: 5868455.2333; val_global_loss: 25782222.4000; val_optim_loss: 25782222.4000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9638; val_auprc_score: 0.9518; val_best_acc_score: 0.9105; val_best_f1_score: 0.9138; train_kl_reg_loss: 66404.2085; train_edge_recon_loss: 587673.4332; train_gene_expr_recon_loss: 18883329.8168; train_masked_gp_l1_reg_loss: 127942.6783; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88958.1636; train_chrom_access_recon_loss: 5829478.7099; train_global_loss: 25583787.0840; train_optim_loss: 25583787.0840; val_kl_reg_loss: 67074.4914; val_edge_recon_loss: 588041.0750; val_gene_expr_recon_loss: 18990838.6667; val_masked_gp_l1_reg_loss: 128733.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89359.4922; val_chrom_access_recon_loss: 5857408.2667; val_global_loss: 25721456.5333; val_optim_loss: 25721456.5333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9642; val_auprc_score: 0.9541; val_best_acc_score: 0.9081; val_best_f1_score: 0.9131; train_kl_reg_loss: 66294.9738; train_edge_recon_loss: 587379.2615; train_gene_expr_recon_loss: 18828446.7023; train_masked_gp_l1_reg_loss: 129250.3471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89079.4441; train_chrom_access_recon_loss: 5811508.6641; train_global_loss: 25511959.6489; train_optim_loss: 25511959.6489; val_kl_reg_loss: 66273.7807; val_edge_recon_loss: 590558.4875; val_gene_expr_recon_loss: 18959035.2000; val_masked_gp_l1_reg_loss: 129848.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89608.9609; val_chrom_access_recon_loss: 5836886.1000; val_global_loss: 25672209.0667; val_optim_loss: 25672209.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9598; val_auprc_score: 0.9471; val_best_acc_score: 0.9058; val_best_f1_score: 0.9089; train_kl_reg_loss: 65887.1612; train_edge_recon_loss: 587254.7576; train_gene_expr_recon_loss: 18745854.7481; train_masked_gp_l1_reg_loss: 130539.7399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89258.2029; train_chrom_access_recon_loss: 5780499.0305; train_global_loss: 25399293.5573; train_optim_loss: 25399293.5573; val_kl_reg_loss: 67157.6742; val_edge_recon_loss: 593697.1500; val_gene_expr_recon_loss: 18964115.2000; val_masked_gp_l1_reg_loss: 131281.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89904.6875; val_chrom_access_recon_loss: 5815328.9333; val_global_loss: 25661484.9333; val_optim_loss: 25661484.9333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9599; val_auprc_score: 0.9463; val_best_acc_score: 0.9051; val_best_f1_score: 0.9104; train_kl_reg_loss: 65909.4058; train_edge_recon_loss: 586998.5864; train_gene_expr_recon_loss: 18691341.1756; train_masked_gp_l1_reg_loss: 131900.9852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89466.2877; train_chrom_access_recon_loss: 5765018.0802; train_global_loss: 25330634.3511; train_optim_loss: 25330634.3511; val_kl_reg_loss: 65708.3591; val_edge_recon_loss: 588956.6042; val_gene_expr_recon_loss: 18888366.6667; val_masked_gp_l1_reg_loss: 132688.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89845.7656; val_chrom_access_recon_loss: 5817245.6000; val_global_loss: 25582811.3333; val_optim_loss: 25582811.3333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9659; val_auprc_score: 0.9543; val_best_acc_score: 0.9166; val_best_f1_score: 0.9199; train_kl_reg_loss: 66174.2671; train_edge_recon_loss: 586446.0530; train_gene_expr_recon_loss: 18638786.3511; train_masked_gp_l1_reg_loss: 133016.6009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89725.2266; train_chrom_access_recon_loss: 5741364.0725; train_global_loss: 25255512.4885; train_optim_loss: 25255512.4885; val_kl_reg_loss: 66767.8969; val_edge_recon_loss: 587476.6042; val_gene_expr_recon_loss: 18917596.8000; val_masked_gp_l1_reg_loss: 134116.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90532.0625; val_chrom_access_recon_loss: 5801994.4333; val_global_loss: 25598483.8667; val_optim_loss: 25598483.8667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9632; val_auprc_score: 0.9529; val_best_acc_score: 0.9100; val_best_f1_score: 0.9133; train_kl_reg_loss: 65901.6692; train_edge_recon_loss: 586242.3411; train_gene_expr_recon_loss: 18593570.8092; train_masked_gp_l1_reg_loss: 134294.1419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90159.9275; train_chrom_access_recon_loss: 5723416.3053; train_global_loss: 25193585.2824; train_optim_loss: 25193585.2824; val_kl_reg_loss: 66640.9599; val_edge_recon_loss: 591156.9208; val_gene_expr_recon_loss: 18733397.4667; val_masked_gp_l1_reg_loss: 134896.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90192.0156; val_chrom_access_recon_loss: 5773972.6333; val_global_loss: 25390256.0000; val_optim_loss: 25390256.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9607; val_auprc_score: 0.9477; val_best_acc_score: 0.9107; val_best_f1_score: 0.9142; train_kl_reg_loss: 65749.9970; train_edge_recon_loss: 587722.9871; train_gene_expr_recon_loss: 18525768.8550; train_masked_gp_l1_reg_loss: 135330.2140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90504.8899; train_chrom_access_recon_loss: 5706670.7748; train_global_loss: 25111747.6031; train_optim_loss: 25111747.6031; val_kl_reg_loss: 67141.1562; val_edge_recon_loss: 592698.7833; val_gene_expr_recon_loss: 18773628.0000; val_masked_gp_l1_reg_loss: 136007.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91006.6406; val_chrom_access_recon_loss: 5763009.8667; val_global_loss: 25423491.8667; val_optim_loss: 25423491.8667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9410; val_auprc_score: 0.9293; val_best_acc_score: 0.8705; val_best_f1_score: 0.8761; train_kl_reg_loss: 58955.9283; train_edge_recon_loss: 643983.5219; train_gene_expr_recon_loss: 18081102.4885; train_masked_gp_l1_reg_loss: 134034.2617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82405.8601; train_chrom_access_recon_loss: 5685097.0687; train_global_loss: 24685579.2061; train_optim_loss: 24685579.2061; val_kl_reg_loss: 32086.9802; val_edge_recon_loss: 653188.6458; val_gene_expr_recon_loss: 18293037.6000; val_masked_gp_l1_reg_loss: 131983.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80586.4297; val_chrom_access_recon_loss: 5682891.3333; val_global_loss: 24873774.6667; val_optim_loss: 24873774.6667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9363; val_auprc_score: 0.9223; val_best_acc_score: 0.8673; val_best_f1_score: 0.8720; train_kl_reg_loss: 56124.2496; train_edge_recon_loss: 613851.5997; train_gene_expr_recon_loss: 18073678.2290; train_masked_gp_l1_reg_loss: 127600.3627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79997.8303; train_chrom_access_recon_loss: 5662864.2863; train_global_loss: 24614116.4885; train_optim_loss: 24614116.4885; val_kl_reg_loss: 46511.0122; val_edge_recon_loss: 611506.7667; val_gene_expr_recon_loss: 18201424.6667; val_masked_gp_l1_reg_loss: 124672.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79195.2031; val_chrom_access_recon_loss: 5682538.6000; val_global_loss: 24745849.2000; val_optim_loss: 24745849.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9399; val_auprc_score: 0.9225; val_best_acc_score: 0.8744; val_best_f1_score: 0.8814; train_kl_reg_loss: 59043.4424; train_edge_recon_loss: 603887.1369; train_gene_expr_recon_loss: 18032192.4275; train_masked_gp_l1_reg_loss: 122335.9382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78353.7533; train_chrom_access_recon_loss: 5650899.1107; train_global_loss: 24546711.7710; train_optim_loss: 24546711.7710; val_kl_reg_loss: 51571.6081; val_edge_recon_loss: 599295.7625; val_gene_expr_recon_loss: 18091259.6000; val_masked_gp_l1_reg_loss: 120443.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76854.9844; val_chrom_access_recon_loss: 5640780.8000; val_global_loss: 24580205.4667; val_optim_loss: 24580205.4667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9446; val_auprc_score: 0.9291; val_best_acc_score: 0.8778; val_best_f1_score: 0.8840; train_kl_reg_loss: 60791.8332; train_edge_recon_loss: 599271.3144; train_gene_expr_recon_loss: 17982646.0840; train_masked_gp_l1_reg_loss: 119005.7149; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76857.5661; train_chrom_access_recon_loss: 5642571.4809; train_global_loss: 24481143.8626; train_optim_loss: 24481143.8626; val_kl_reg_loss: 51614.1990; val_edge_recon_loss: 597017.7417; val_gene_expr_recon_loss: 18091663.6000; val_masked_gp_l1_reg_loss: 118193.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76496.9688; val_chrom_access_recon_loss: 5669075.1667; val_global_loss: 24604060.9333; val_optim_loss: 24604060.9333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9367; val_auprc_score: 0.9194; val_best_acc_score: 0.8681; val_best_f1_score: 0.8766; train_kl_reg_loss: 71111.1101; train_edge_recon_loss: 598869.6336; train_gene_expr_recon_loss: 17908294.2443; train_masked_gp_l1_reg_loss: 117640.5890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76931.6483; train_chrom_access_recon_loss: 5632935.9389; train_global_loss: 24405783.0687; train_optim_loss: 24405783.0687; val_kl_reg_loss: 48836.9034; val_edge_recon_loss: 608097.1750; val_gene_expr_recon_loss: 18145989.4667; val_masked_gp_l1_reg_loss: 116726.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76210.2656; val_chrom_access_recon_loss: 5649097.2000; val_global_loss: 24644956.9333; val_optim_loss: 24644956.9333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9471; val_auprc_score: 0.9322; val_best_acc_score: 0.8875; val_best_f1_score: 0.8925; train_kl_reg_loss: 62574.4233; train_edge_recon_loss: 595304.8946; train_gene_expr_recon_loss: 17929767.3893; train_masked_gp_l1_reg_loss: 114776.4948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76563.4676; train_chrom_access_recon_loss: 5634666.4771; train_global_loss: 24413653.2061; train_optim_loss: 24413653.2061; val_kl_reg_loss: 54919.8977; val_edge_recon_loss: 595783.0000; val_gene_expr_recon_loss: 18062071.3333; val_masked_gp_l1_reg_loss: 113795.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76795.1562; val_chrom_access_recon_loss: 5646375.9000; val_global_loss: 24549742.8000; val_optim_loss: 24549742.8000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9450; val_auprc_score: 0.9263; val_best_acc_score: 0.8802; val_best_f1_score: 0.8855; train_kl_reg_loss: 60790.7941; train_edge_recon_loss: 597634.5105; train_gene_expr_recon_loss: 17929181.9618; train_masked_gp_l1_reg_loss: 113554.6435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77067.3692; train_chrom_access_recon_loss: 5625438.3092; train_global_loss: 24403667.7405; train_optim_loss: 24403667.7405; val_kl_reg_loss: 56360.2065; val_edge_recon_loss: 596940.4208; val_gene_expr_recon_loss: 17983609.4667; val_masked_gp_l1_reg_loss: 112539.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76649.6328; val_chrom_access_recon_loss: 5630307.3333; val_global_loss: 24456407.6000; val_optim_loss: 24456407.6000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9445; val_auprc_score: 0.9278; val_best_acc_score: 0.8829; val_best_f1_score: 0.8890; train_kl_reg_loss: 61334.5527; train_edge_recon_loss: 596070.0964; train_gene_expr_recon_loss: 17919633.7786; train_masked_gp_l1_reg_loss: 112776.8981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77415.8737; train_chrom_access_recon_loss: 5626362.1832; train_global_loss: 24393593.2519; train_optim_loss: 24393593.2519; val_kl_reg_loss: 61292.4701; val_edge_recon_loss: 597503.2417; val_gene_expr_recon_loss: 18021350.6667; val_masked_gp_l1_reg_loss: 112540.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77837.9297; val_chrom_access_recon_loss: 5624629.2333; val_global_loss: 24495153.7333; val_optim_loss: 24495153.7333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9455; val_auprc_score: 0.9293; val_best_acc_score: 0.8847; val_best_f1_score: 0.8906; train_kl_reg_loss: 64957.1914; train_edge_recon_loss: 593525.5663; train_gene_expr_recon_loss: 17945100.8702; train_masked_gp_l1_reg_loss: 111952.6410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77548.2186; train_chrom_access_recon_loss: 5630822.4542; train_global_loss: 24423906.9924; train_optim_loss: 24423906.9924; val_kl_reg_loss: 59890.2688; val_edge_recon_loss: 593532.1667; val_gene_expr_recon_loss: 18008581.0667; val_masked_gp_l1_reg_loss: 111550.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77470.1172; val_chrom_access_recon_loss: 5658413.4667; val_global_loss: 24509436.9333; val_optim_loss: 24509436.9333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9467; val_auprc_score: 0.9340; val_best_acc_score: 0.8822; val_best_f1_score: 0.8880; train_kl_reg_loss: 62497.9577; train_edge_recon_loss: 590571.8197; train_gene_expr_recon_loss: 17822438.1603; train_masked_gp_l1_reg_loss: 111134.7071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77399.9101; train_chrom_access_recon_loss: 5604459.0458; train_global_loss: 24268501.6794; train_optim_loss: 24268501.6794; val_kl_reg_loss: 59018.9008; val_edge_recon_loss: 593929.2167; val_gene_expr_recon_loss: 17966856.5333; val_masked_gp_l1_reg_loss: 111048.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77621.2344; val_chrom_access_recon_loss: 5612057.9667; val_global_loss: 24420532.0000; val_optim_loss: 24420532.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9503; val_auprc_score: 0.9357; val_best_acc_score: 0.8906; val_best_f1_score: 0.8942; train_kl_reg_loss: 62900.8095; train_edge_recon_loss: 588393.5210; train_gene_expr_recon_loss: 17800995.6947; train_masked_gp_l1_reg_loss: 110930.0601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77119.0823; train_chrom_access_recon_loss: 5606167.0000; train_global_loss: 24246506.0611; train_optim_loss: 24246506.0611; val_kl_reg_loss: 58009.3661; val_edge_recon_loss: 591720.9333; val_gene_expr_recon_loss: 17967068.6667; val_masked_gp_l1_reg_loss: 111225.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77152.8281; val_chrom_access_recon_loss: 5624781.6333; val_global_loss: 24429958.4000; val_optim_loss: 24429958.4000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9522; val_auprc_score: 0.9396; val_best_acc_score: 0.8918; val_best_f1_score: 0.8972; train_kl_reg_loss: 60284.1848; train_edge_recon_loss: 590910.4976; train_gene_expr_recon_loss: 17781525.7557; train_masked_gp_l1_reg_loss: 110909.4759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77341.9615; train_chrom_access_recon_loss: 5605025.4656; train_global_loss: 24225997.2977; train_optim_loss: 24225997.2977; val_kl_reg_loss: 57493.4628; val_edge_recon_loss: 591658.7500; val_gene_expr_recon_loss: 17996994.9333; val_masked_gp_l1_reg_loss: 110738.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77198.5391; val_chrom_access_recon_loss: 5624791.8667; val_global_loss: 24458874.9333; val_optim_loss: 24458874.9333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9501; val_auprc_score: 0.9345; val_best_acc_score: 0.8923; val_best_f1_score: 0.8972; train_kl_reg_loss: 60636.8959; train_edge_recon_loss: 587074.6446; train_gene_expr_recon_loss: 17745987.3893; train_masked_gp_l1_reg_loss: 110995.3482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77047.7882; train_chrom_access_recon_loss: 5595097.1107; train_global_loss: 24176839.0229; train_optim_loss: 24176839.0229; val_kl_reg_loss: 57921.8823; val_edge_recon_loss: 591731.1417; val_gene_expr_recon_loss: 17972898.6667; val_masked_gp_l1_reg_loss: 111452.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77048.2578; val_chrom_access_recon_loss: 5623279.7667; val_global_loss: 24434331.4667; val_optim_loss: 24434331.4667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9512; val_auprc_score: 0.9353; val_best_acc_score: 0.8915; val_best_f1_score: 0.8961; train_kl_reg_loss: 60395.8726; train_edge_recon_loss: 586643.5596; train_gene_expr_recon_loss: 17730470.4580; train_masked_gp_l1_reg_loss: 111397.5586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76964.3620; train_chrom_access_recon_loss: 5604773.8588; train_global_loss: 24170645.5573; train_optim_loss: 24170645.5573; val_kl_reg_loss: 57212.0315; val_edge_recon_loss: 591260.7750; val_gene_expr_recon_loss: 17935513.3333; val_masked_gp_l1_reg_loss: 111799.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77334.8906; val_chrom_access_recon_loss: 5660421.4667; val_global_loss: 24433541.4667; val_optim_loss: 24433541.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9544; val_auprc_score: 0.9400; val_best_acc_score: 0.9010; val_best_f1_score: 0.9055; train_kl_reg_loss: 59938.3697; train_edge_recon_loss: 586622.4361; train_gene_expr_recon_loss: 17705485.6718; train_masked_gp_l1_reg_loss: 107552.1552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62265.9071; train_chrom_access_recon_loss: 5589841.1794; train_global_loss: 24111705.6947; train_optim_loss: 24111705.6947; val_kl_reg_loss: 58253.4974; val_edge_recon_loss: 584922.9250; val_gene_expr_recon_loss: 17996001.0667; val_masked_gp_l1_reg_loss: 106434.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59911.5781; val_chrom_access_recon_loss: 5657036.9667; val_global_loss: 24462560.8000; val_optim_loss: 24462560.8000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9527; val_auprc_score: 0.9412; val_best_acc_score: 0.8905; val_best_f1_score: 0.8966; train_kl_reg_loss: 61115.8178; train_edge_recon_loss: 587594.1751; train_gene_expr_recon_loss: 17675115.1145; train_masked_gp_l1_reg_loss: 106257.9240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59319.9503; train_chrom_access_recon_loss: 5579872.4351; train_global_loss: 24069275.5115; train_optim_loss: 24069275.5115; val_kl_reg_loss: 59365.7544; val_edge_recon_loss: 591484.7333; val_gene_expr_recon_loss: 17896282.9333; val_masked_gp_l1_reg_loss: 106076.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58834.5547; val_chrom_access_recon_loss: 5600926.1333; val_global_loss: 24312969.8667; val_optim_loss: 24312969.8667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9539; val_auprc_score: 0.9421; val_best_acc_score: 0.8944; val_best_f1_score: 0.8991; train_kl_reg_loss: 61942.8029; train_edge_recon_loss: 585846.4294; train_gene_expr_recon_loss: 17667280.6336; train_masked_gp_l1_reg_loss: 106020.1814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58463.0867; train_chrom_access_recon_loss: 5583522.8015; train_global_loss: 24063075.9237; train_optim_loss: 24063075.9237; val_kl_reg_loss: 59735.3091; val_edge_recon_loss: 586266.5292; val_gene_expr_recon_loss: 17880935.8667; val_masked_gp_l1_reg_loss: 105975.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58189.7500; val_chrom_access_recon_loss: 5612671.2667; val_global_loss: 24303774.9333; val_optim_loss: 24303774.9333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9556; val_auprc_score: 0.9425; val_best_acc_score: 0.8972; val_best_f1_score: 0.9013; train_kl_reg_loss: 62346.7265; train_edge_recon_loss: 586705.3077; train_gene_expr_recon_loss: 17657503.1374; train_masked_gp_l1_reg_loss: 105906.8820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57899.9803; train_chrom_access_recon_loss: 5578941.0802; train_global_loss: 24049303.0076; train_optim_loss: 24049303.0076; val_kl_reg_loss: 60076.2367; val_edge_recon_loss: 584923.1667; val_gene_expr_recon_loss: 17819783.3333; val_masked_gp_l1_reg_loss: 105885.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57678.3906; val_chrom_access_recon_loss: 5598597.5000; val_global_loss: 24226944.1333; val_optim_loss: 24226944.1333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9507; val_auprc_score: 0.9356; val_best_acc_score: 0.8952; val_best_f1_score: 0.8997; train_kl_reg_loss: 62662.1100; train_edge_recon_loss: 586517.9580; train_gene_expr_recon_loss: 17651546.8626; train_masked_gp_l1_reg_loss: 105824.7295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57421.2883; train_chrom_access_recon_loss: 5581671.3702; train_global_loss: 24045644.3664; train_optim_loss: 24045644.3664; val_kl_reg_loss: 60449.7766; val_edge_recon_loss: 588161.4292; val_gene_expr_recon_loss: 17889377.0000; val_masked_gp_l1_reg_loss: 105776.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57177.0781; val_chrom_access_recon_loss: 5607239.6667; val_global_loss: 24308182.2667; val_optim_loss: 24308182.2667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9498; val_auprc_score: 0.9364; val_best_acc_score: 0.8879; val_best_f1_score: 0.8916; train_kl_reg_loss: 62860.1401; train_edge_recon_loss: 583398.8936; train_gene_expr_recon_loss: 17665154.4656; train_masked_gp_l1_reg_loss: 105758.1893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56996.2121; train_chrom_access_recon_loss: 5583092.4389; train_global_loss: 24057260.3359; train_optim_loss: 24057260.3359; val_kl_reg_loss: 61042.5914; val_edge_recon_loss: 592498.4917; val_gene_expr_recon_loss: 17870892.4000; val_masked_gp_l1_reg_loss: 105759.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56739.6445; val_chrom_access_recon_loss: 5611819.0667; val_global_loss: 24298752.5333; val_optim_loss: 24298752.5333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9551; val_auprc_score: 0.9409; val_best_acc_score: 0.8972; val_best_f1_score: 0.9031; train_kl_reg_loss: 63050.1678; train_edge_recon_loss: 583972.9012; train_gene_expr_recon_loss: 17664343.6641; train_masked_gp_l1_reg_loss: 105717.2975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56540.4133; train_chrom_access_recon_loss: 5584232.1565; train_global_loss: 24057856.6260; train_optim_loss: 24057856.6260; val_kl_reg_loss: 60814.2974; val_edge_recon_loss: 584136.5208; val_gene_expr_recon_loss: 17854492.4000; val_masked_gp_l1_reg_loss: 105710.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56330.7969; val_chrom_access_recon_loss: 5613235.3667; val_global_loss: 24274718.4000; val_optim_loss: 24274718.4000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9538; val_auprc_score: 0.9424; val_best_acc_score: 0.8957; val_best_f1_score: 0.8998; train_kl_reg_loss: 7613108.5302; train_edge_recon_loss: 586882.8793; train_gene_expr_recon_loss: 17650306.3893; train_masked_gp_l1_reg_loss: 105702.0227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56132.7317; train_chrom_access_recon_loss: 5577423.4618; train_global_loss: 31589556.0305; train_optim_loss: 31589556.0305; val_kl_reg_loss: 62259.2250; val_edge_recon_loss: 587246.8875; val_gene_expr_recon_loss: 17886406.4667; val_masked_gp_l1_reg_loss: 105639.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55790.8125; val_chrom_access_recon_loss: 5593787.9667; val_global_loss: 24291130.8000; val_optim_loss: 24291130.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9547; val_auprc_score: 0.9428; val_best_acc_score: 0.8946; val_best_f1_score: 0.8993; train_kl_reg_loss: 64643.8118; train_edge_recon_loss: 585686.3411; train_gene_expr_recon_loss: 17646125.5725; train_masked_gp_l1_reg_loss: 105149.8426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54229.2923; train_chrom_access_recon_loss: 5580242.7557; train_global_loss: 24036077.7405; train_optim_loss: 24036077.7405; val_kl_reg_loss: 62122.0789; val_edge_recon_loss: 587985.1833; val_gene_expr_recon_loss: 17858320.8667; val_masked_gp_l1_reg_loss: 104956.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53955.5039; val_chrom_access_recon_loss: 5583026.5333; val_global_loss: 24250366.8000; val_optim_loss: 24250366.8000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9541; val_auprc_score: 0.9403; val_best_acc_score: 0.8975; val_best_f1_score: 0.9016; train_kl_reg_loss: 64383.0992; train_edge_recon_loss: 585241.7304; train_gene_expr_recon_loss: 17635457.8321; train_masked_gp_l1_reg_loss: 104892.6729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53859.1900; train_chrom_access_recon_loss: 5569145.3664; train_global_loss: 24012979.9084; train_optim_loss: 24012979.9084; val_kl_reg_loss: 62195.4805; val_edge_recon_loss: 586370.2292; val_gene_expr_recon_loss: 17925514.4000; val_masked_gp_l1_reg_loss: 104837.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53769.3125; val_chrom_access_recon_loss: 5618156.0000; val_global_loss: 24350844.6667; val_optim_loss: 24350844.6667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9575; val_auprc_score: 0.9446; val_best_acc_score: 0.9000; val_best_f1_score: 0.9021; train_kl_reg_loss: 64413.2245; train_edge_recon_loss: 584856.2366; train_gene_expr_recon_loss: 17632600.1603; train_masked_gp_l1_reg_loss: 104809.1345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53702.6379; train_chrom_access_recon_loss: 5569945.4847; train_global_loss: 24010326.8244; train_optim_loss: 24010326.8244; val_kl_reg_loss: 62211.7763; val_edge_recon_loss: 587238.4208; val_gene_expr_recon_loss: 17843792.6667; val_masked_gp_l1_reg_loss: 104784.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53631.4609; val_chrom_access_recon_loss: 5581921.8333; val_global_loss: 24233580.6667; val_optim_loss: 24233580.6667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9521; val_auprc_score: 0.9393; val_best_acc_score: 0.8933; val_best_f1_score: 0.8965; train_kl_reg_loss: 64304.5994; train_edge_recon_loss: 584747.9924; train_gene_expr_recon_loss: 17629981.1985; train_masked_gp_l1_reg_loss: 104761.8989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53581.4898; train_chrom_access_recon_loss: 5571842.9656; train_global_loss: 24009220.3053; train_optim_loss: 24009220.3053; val_kl_reg_loss: 62257.2216; val_edge_recon_loss: 589422.1125; val_gene_expr_recon_loss: 17875542.4000; val_masked_gp_l1_reg_loss: 104740.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53525.6953; val_chrom_access_recon_loss: 5598063.9000; val_global_loss: 24283551.6000; val_optim_loss: 24283551.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 36 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9524
val AUPRC score: 0.9412
val best accuracy score: 0.8946
val best F1 score: 0.8991
val target rna MSE score: 1.2825
val source rna MSE score: 0.5066
val target atac MSE score: 0.3587
val source atac MSE score: 0.1029
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
