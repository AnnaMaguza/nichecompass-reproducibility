[True]
Run timestamp: 27072023_033906_142.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '5', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '-1', '--timestamp_suffix', '_142']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29452 genes.
Keeping 29452 genes after filtering genes with expression in 0 cells.
Keeping 4032 highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4032, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1540, n_latent: 1540, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1540, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 8064
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8871; val_auprc_score: 0.9770; val_best_acc_score: 0.8502; val_best_f1_score: 0.9190; train_kl_reg_loss: 491281.7963; train_edge_recon_loss: 11018878.9070; train_gene_expr_recon_loss: 23658403.7442; train_masked_gp_l1_reg_loss: 7423.9078; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35175988.6326; train_optim_loss: 35175988.6326; val_kl_reg_loss: 331893.8073; val_edge_recon_loss: 12158181.8333; val_gene_expr_recon_loss: 12746890.5833; val_masked_gp_l1_reg_loss: 8019.7598; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25244986.0833; val_optim_loss: 25244986.0833
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8777; val_auprc_score: 0.9759; val_best_acc_score: 0.8518; val_best_f1_score: 0.9200; train_kl_reg_loss: 337076.6483; train_edge_recon_loss: 10851696.5093; train_gene_expr_recon_loss: 12403983.4605; train_masked_gp_l1_reg_loss: 8306.3129; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23601062.9023; train_optim_loss: 23601062.9023; val_kl_reg_loss: 299885.9883; val_edge_recon_loss: 12015168.8750; val_gene_expr_recon_loss: 11961146.9167; val_masked_gp_l1_reg_loss: 8562.3213; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24284763.9167; val_optim_loss: 24284763.9167
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8570; val_auprc_score: 0.9699; val_best_acc_score: 0.8554; val_best_f1_score: 0.9215; train_kl_reg_loss: 286943.7666; train_edge_recon_loss: 10668631.2465; train_gene_expr_recon_loss: 11612998.0605; train_masked_gp_l1_reg_loss: 8817.0071; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22577390.0651; train_optim_loss: 22577390.0651; val_kl_reg_loss: 235252.5091; val_edge_recon_loss: 12223020.6667; val_gene_expr_recon_loss: 11335257.1667; val_masked_gp_l1_reg_loss: 9050.7090; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23802580.2500; val_optim_loss: 23802580.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8478; val_auprc_score: 0.9686; val_best_acc_score: 0.8582; val_best_f1_score: 0.9227; train_kl_reg_loss: 240936.9516; train_edge_recon_loss: 10533460.4140; train_gene_expr_recon_loss: 11276397.6605; train_masked_gp_l1_reg_loss: 9350.0627; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22060145.0605; train_optim_loss: 22060145.0605; val_kl_reg_loss: 146043.2754; val_edge_recon_loss: 12100346.5000; val_gene_expr_recon_loss: 11160277.5000; val_masked_gp_l1_reg_loss: 9814.2861; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23416481.2500; val_optim_loss: 23416481.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8458; val_auprc_score: 0.9670; val_best_acc_score: 0.8681; val_best_f1_score: 0.9262; train_kl_reg_loss: 151306.4763; train_edge_recon_loss: 10567442.3512; train_gene_expr_recon_loss: 10740100.1302; train_masked_gp_l1_reg_loss: 10387.4035; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21469236.2977; train_optim_loss: 21469236.2977; val_kl_reg_loss: 150168.5046; val_edge_recon_loss: 11813130.3333; val_gene_expr_recon_loss: 10197354.5417; val_masked_gp_l1_reg_loss: 10817.5879; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22171471.4167; val_optim_loss: 22171471.4167
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8529; val_auprc_score: 0.9672; val_best_acc_score: 0.8833; val_best_f1_score: 0.9350; train_kl_reg_loss: 129621.1829; train_edge_recon_loss: 10509428.1651; train_gene_expr_recon_loss: 10213680.2977; train_masked_gp_l1_reg_loss: 11209.4908; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20863939.2372; train_optim_loss: 20863939.2372; val_kl_reg_loss: 136545.5658; val_edge_recon_loss: 11571889.6250; val_gene_expr_recon_loss: 9965226.2500; val_masked_gp_l1_reg_loss: 11614.4131; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21685275.5000; val_optim_loss: 21685275.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8487; val_auprc_score: 0.9648; val_best_acc_score: 0.8865; val_best_f1_score: 0.9368; train_kl_reg_loss: 93931.1739; train_edge_recon_loss: 10213778.6163; train_gene_expr_recon_loss: 9854194.7070; train_masked_gp_l1_reg_loss: 11967.8199; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20173872.3070; train_optim_loss: 20173872.3070; val_kl_reg_loss: 63368.9593; val_edge_recon_loss: 9932448.4792; val_gene_expr_recon_loss: 9730054.0833; val_masked_gp_l1_reg_loss: 12353.4219; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19738225.5000; val_optim_loss: 19738225.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8369; val_auprc_score: 0.9605; val_best_acc_score: 0.8872; val_best_f1_score: 0.9370; train_kl_reg_loss: 89917.1245; train_edge_recon_loss: 9252966.0698; train_gene_expr_recon_loss: 9601522.3535; train_masked_gp_l1_reg_loss: 12792.4198; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18957197.9302; train_optim_loss: 18957197.9302; val_kl_reg_loss: 117313.8210; val_edge_recon_loss: 9081353.5000; val_gene_expr_recon_loss: 9454313.8750; val_masked_gp_l1_reg_loss: 13189.5137; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18666171.3333; val_optim_loss: 18666171.3333
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8448; val_auprc_score: 0.9640; val_best_acc_score: 0.8899; val_best_f1_score: 0.9385; train_kl_reg_loss: 135861.7393; train_edge_recon_loss: 8856046.3767; train_gene_expr_recon_loss: 9184943.1256; train_masked_gp_l1_reg_loss: 13521.0657; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18190372.2372; train_optim_loss: 18190372.2372; val_kl_reg_loss: 142767.4961; val_edge_recon_loss: 8999339.5625; val_gene_expr_recon_loss: 8931694.6667; val_masked_gp_l1_reg_loss: 13850.6885; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18087651.7500; val_optim_loss: 18087651.7500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8483; val_auprc_score: 0.9646; val_best_acc_score: 0.8970; val_best_f1_score: 0.9424; train_kl_reg_loss: 148635.1951; train_edge_recon_loss: 8729990.2767; train_gene_expr_recon_loss: 8812447.7488; train_masked_gp_l1_reg_loss: 14150.6194; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17705223.7488; train_optim_loss: 17705223.7488; val_kl_reg_loss: 140098.4199; val_edge_recon_loss: 8708440.1667; val_gene_expr_recon_loss: 8684653.5000; val_masked_gp_l1_reg_loss: 14447.4072; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17547639.6250; val_optim_loss: 17547639.6250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8500; val_auprc_score: 0.9661; val_best_acc_score: 0.8962; val_best_f1_score: 0.9419; train_kl_reg_loss: 143436.6653; train_edge_recon_loss: 8662194.3674; train_gene_expr_recon_loss: 8612267.7070; train_masked_gp_l1_reg_loss: 14726.3168; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17432625.0651; train_optim_loss: 17432625.0651; val_kl_reg_loss: 128271.0003; val_edge_recon_loss: 8937610.5417; val_gene_expr_recon_loss: 8543136.8750; val_masked_gp_l1_reg_loss: 14994.8965; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17624012.3333; val_optim_loss: 17624012.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8549; val_auprc_score: 0.9674; val_best_acc_score: 0.9020; val_best_f1_score: 0.9452; train_kl_reg_loss: 130762.8309; train_edge_recon_loss: 8568167.6256; train_gene_expr_recon_loss: 8475280.9047; train_masked_gp_l1_reg_loss: 15241.3949; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17189452.8000; train_optim_loss: 17189452.8000; val_kl_reg_loss: 123782.5404; val_edge_recon_loss: 8636583.7083; val_gene_expr_recon_loss: 8414403.8542; val_masked_gp_l1_reg_loss: 15485.0352; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17190256.0000; val_optim_loss: 17190256.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8642; val_auprc_score: 0.9690; val_best_acc_score: 0.9068; val_best_f1_score: 0.9473; train_kl_reg_loss: 117061.2528; train_edge_recon_loss: 8486717.5302; train_gene_expr_recon_loss: 8308879.6349; train_masked_gp_l1_reg_loss: 15748.7773; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16928407.1302; train_optim_loss: 16928407.1302; val_kl_reg_loss: 111415.4489; val_edge_recon_loss: 8443138.3542; val_gene_expr_recon_loss: 8160773.9167; val_masked_gp_l1_reg_loss: 16043.2402; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16731371.3333; val_optim_loss: 16731371.3333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8656; val_auprc_score: 0.9686; val_best_acc_score: 0.9059; val_best_f1_score: 0.9466; train_kl_reg_loss: 106328.0533; train_edge_recon_loss: 8478258.2558; train_gene_expr_recon_loss: 8106562.6116; train_masked_gp_l1_reg_loss: 16298.9417; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16707447.8744; train_optim_loss: 16707447.8744; val_kl_reg_loss: 96751.3711; val_edge_recon_loss: 8636237.7292; val_gene_expr_recon_loss: 8046708.2917; val_masked_gp_l1_reg_loss: 16544.9395; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16796241.9167; val_optim_loss: 16796241.9167
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8883; val_auprc_score: 0.9754; val_best_acc_score: 0.9147; val_best_f1_score: 0.9517; train_kl_reg_loss: 91238.7699; train_edge_recon_loss: 8272655.5977; train_gene_expr_recon_loss: 7999517.9837; train_masked_gp_l1_reg_loss: 16782.5346; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16380194.9209; train_optim_loss: 16380194.9209; val_kl_reg_loss: 80064.5589; val_edge_recon_loss: 8051755.6875; val_gene_expr_recon_loss: 7943780.9792; val_masked_gp_l1_reg_loss: 17014.1426; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16092615.2500; val_optim_loss: 16092615.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8940; val_auprc_score: 0.9762; val_best_acc_score: 0.9148; val_best_f1_score: 0.9513; train_kl_reg_loss: 77635.8043; train_edge_recon_loss: 8180894.6116; train_gene_expr_recon_loss: 7899382.6977; train_masked_gp_l1_reg_loss: 17229.8404; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16175142.9721; train_optim_loss: 16175142.9721; val_kl_reg_loss: 68327.9525; val_edge_recon_loss: 8433291.7708; val_gene_expr_recon_loss: 7874496.3333; val_masked_gp_l1_reg_loss: 17441.9316; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16393558.0833; val_optim_loss: 16393558.0833
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9020; val_auprc_score: 0.9773; val_best_acc_score: 0.9150; val_best_f1_score: 0.9515; train_kl_reg_loss: 69685.7785; train_edge_recon_loss: 8055335.9000; train_gene_expr_recon_loss: 7809202.9651; train_masked_gp_l1_reg_loss: 17630.6119; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15951855.2837; train_optim_loss: 15951855.2837; val_kl_reg_loss: 65484.9826; val_edge_recon_loss: 8323227.1042; val_gene_expr_recon_loss: 7766957.8125; val_masked_gp_l1_reg_loss: 17810.3203; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16173479.8333; val_optim_loss: 16173479.8333
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9140; val_auprc_score: 0.9805; val_best_acc_score: 0.9229; val_best_f1_score: 0.9557; train_kl_reg_loss: 66192.6960; train_edge_recon_loss: 8077520.8279; train_gene_expr_recon_loss: 7724469.6326; train_masked_gp_l1_reg_loss: 17966.0660; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15886149.2372; train_optim_loss: 15886149.2372; val_kl_reg_loss: 62814.2834; val_edge_recon_loss: 8050624.4583; val_gene_expr_recon_loss: 7682752.0000; val_masked_gp_l1_reg_loss: 18114.5723; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15814305.6250; val_optim_loss: 15814305.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9062; val_auprc_score: 0.9787; val_best_acc_score: 0.9183; val_best_f1_score: 0.9532; train_kl_reg_loss: 62087.0238; train_edge_recon_loss: 8029621.4442; train_gene_expr_recon_loss: 7647558.4326; train_masked_gp_l1_reg_loss: 18246.2984; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15757513.1488; train_optim_loss: 15757513.1488; val_kl_reg_loss: 58403.6224; val_edge_recon_loss: 8286665.1667; val_gene_expr_recon_loss: 7626563.1042; val_masked_gp_l1_reg_loss: 18378.0723; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15990009.8750; val_optim_loss: 15990009.8750
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9205; val_auprc_score: 0.9823; val_best_acc_score: 0.9238; val_best_f1_score: 0.9564; train_kl_reg_loss: 56935.8424; train_edge_recon_loss: 7808215.3953; train_gene_expr_recon_loss: 7576027.3791; train_masked_gp_l1_reg_loss: 18489.5257; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15459668.1163; train_optim_loss: 15459668.1163; val_kl_reg_loss: 53436.5848; val_edge_recon_loss: 7993842.3958; val_gene_expr_recon_loss: 7548128.1042; val_masked_gp_l1_reg_loss: 18591.1836; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15613998.2083; val_optim_loss: 15613998.2083
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9220; val_auprc_score: 0.9825; val_best_acc_score: 0.9199; val_best_f1_score: 0.9540; train_kl_reg_loss: 51593.6146; train_edge_recon_loss: 7932363.4302; train_gene_expr_recon_loss: 7514443.8930; train_masked_gp_l1_reg_loss: 18662.3993; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15517063.2977; train_optim_loss: 15517063.2977; val_kl_reg_loss: 48777.2645; val_edge_recon_loss: 8245694.5625; val_gene_expr_recon_loss: 7492889.2708; val_masked_gp_l1_reg_loss: 18725.3086; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15806086.2917; val_optim_loss: 15806086.2917
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9250; val_auprc_score: 0.9824; val_best_acc_score: 0.9217; val_best_f1_score: 0.9551; train_kl_reg_loss: 45647.5295; train_edge_recon_loss: 7926777.4279; train_gene_expr_recon_loss: 7461486.5023; train_masked_gp_l1_reg_loss: 18751.9689; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15452663.3860; train_optim_loss: 15452663.3860; val_kl_reg_loss: 44658.6720; val_edge_recon_loss: 8008579.3125; val_gene_expr_recon_loss: 7444194.9167; val_masked_gp_l1_reg_loss: 18761.1543; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15516193.9583; val_optim_loss: 15516193.9583
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9282; val_auprc_score: 0.9839; val_best_acc_score: 0.9272; val_best_f1_score: 0.9580; train_kl_reg_loss: 42258.3303; train_edge_recon_loss: 7799942.8698; train_gene_expr_recon_loss: 7409072.4488; train_masked_gp_l1_reg_loss: 18740.2428; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15270013.8930; train_optim_loss: 15270013.8930; val_kl_reg_loss: 38718.9170; val_edge_recon_loss: 8036096.4583; val_gene_expr_recon_loss: 7398121.0208; val_masked_gp_l1_reg_loss: 18708.3965; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15491644.5000; val_optim_loss: 15491644.5000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9275; val_auprc_score: 0.9834; val_best_acc_score: 0.9256; val_best_f1_score: 0.9571; train_kl_reg_loss: 38110.1388; train_edge_recon_loss: 7882451.1767; train_gene_expr_recon_loss: 7360348.4442; train_masked_gp_l1_reg_loss: 18655.2381; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15299564.9860; train_optim_loss: 15299564.9860; val_kl_reg_loss: 36656.1838; val_edge_recon_loss: 8075809.1667; val_gene_expr_recon_loss: 7344470.0208; val_masked_gp_l1_reg_loss: 18588.4590; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15475523.5000; val_optim_loss: 15475523.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9382; val_auprc_score: 0.9871; val_best_acc_score: 0.9307; val_best_f1_score: 0.9602; train_kl_reg_loss: 37356.5044; train_edge_recon_loss: 7823960.0698; train_gene_expr_recon_loss: 7313840.7721; train_masked_gp_l1_reg_loss: 18499.0019; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15193656.3628; train_optim_loss: 15193656.3628; val_kl_reg_loss: 35781.1320; val_edge_recon_loss: 7845318.4375; val_gene_expr_recon_loss: 7307418.8125; val_masked_gp_l1_reg_loss: 18397.0918; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15206915.4167; val_optim_loss: 15206915.4167
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9484; val_auprc_score: 0.9889; val_best_acc_score: 0.9376; val_best_f1_score: 0.9639; train_kl_reg_loss: 37665.8845; train_edge_recon_loss: 7819101.3023; train_gene_expr_recon_loss: 7351198.9233; train_masked_gp_l1_reg_loss: 18412.6743; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15226378.7953; train_optim_loss: 15226378.7953; val_kl_reg_loss: 10302.2416; val_edge_recon_loss: 7683033.6875; val_gene_expr_recon_loss: 7351850.5833; val_masked_gp_l1_reg_loss: 18372.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15063558.5833; val_optim_loss: 15063558.5833
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9480; val_auprc_score: 0.9876; val_best_acc_score: 0.9380; val_best_f1_score: 0.9641; train_kl_reg_loss: 33981.9318; train_edge_recon_loss: 7855956.6349; train_gene_expr_recon_loss: 7317500.1628; train_masked_gp_l1_reg_loss: 18258.3653; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15225697.0512; train_optim_loss: 15225697.0512; val_kl_reg_loss: 9562.9781; val_edge_recon_loss: 8015565.2708; val_gene_expr_recon_loss: 7309751.7708; val_masked_gp_l1_reg_loss: 18108.7207; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15352989.0417; val_optim_loss: 15352989.0417
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9564; val_auprc_score: 0.9905; val_best_acc_score: 0.9432; val_best_f1_score: 0.9673; train_kl_reg_loss: 31754.5517; train_edge_recon_loss: 7801878.9140; train_gene_expr_recon_loss: 7291747.5837; train_masked_gp_l1_reg_loss: 17956.5307; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15143337.6186; train_optim_loss: 15143337.6186; val_kl_reg_loss: 9065.4442; val_edge_recon_loss: 7808131.6042; val_gene_expr_recon_loss: 7297822.1042; val_masked_gp_l1_reg_loss: 17776.9609; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15132796.1250; val_optim_loss: 15132796.1250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9579; val_auprc_score: 0.9906; val_best_acc_score: 0.9423; val_best_f1_score: 0.9666; train_kl_reg_loss: 30391.1179; train_edge_recon_loss: 7702570.3488; train_gene_expr_recon_loss: 7263117.0791; train_masked_gp_l1_reg_loss: 17594.5884; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15013673.1302; train_optim_loss: 15013673.1302; val_kl_reg_loss: 9399.3614; val_edge_recon_loss: 7921659.2500; val_gene_expr_recon_loss: 7268779.6667; val_masked_gp_l1_reg_loss: 17377.9609; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15217216.2083; val_optim_loss: 15217216.2083
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9556; val_auprc_score: 0.9894; val_best_acc_score: 0.9458; val_best_f1_score: 0.9687; train_kl_reg_loss: 28446.1555; train_edge_recon_loss: 7735494.7070; train_gene_expr_recon_loss: 7236917.6791; train_masked_gp_l1_reg_loss: 17202.0766; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15018060.6605; train_optim_loss: 15018060.6605; val_kl_reg_loss: 9197.4417; val_edge_recon_loss: 7672866.4167; val_gene_expr_recon_loss: 7229191.8542; val_masked_gp_l1_reg_loss: 16983.8828; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14928239.7083; val_optim_loss: 14928239.7083
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9570; val_auprc_score: 0.9899; val_best_acc_score: 0.9480; val_best_f1_score: 0.9700; train_kl_reg_loss: 26620.4763; train_edge_recon_loss: 7683610.4605; train_gene_expr_recon_loss: 7223314.0721; train_masked_gp_l1_reg_loss: 16774.5599; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14950319.5721; train_optim_loss: 14950319.5721; val_kl_reg_loss: 9068.2193; val_edge_recon_loss: 7870463.7083; val_gene_expr_recon_loss: 7243426.4792; val_masked_gp_l1_reg_loss: 16539.1992; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15139497.3750; val_optim_loss: 15139497.3750
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9585; val_auprc_score: 0.9898; val_best_acc_score: 0.9514; val_best_f1_score: 0.9718; train_kl_reg_loss: 25474.9538; train_edge_recon_loss: 7729553.4628; train_gene_expr_recon_loss: 7200580.2558; train_masked_gp_l1_reg_loss: 16343.6657; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14971952.3163; train_optim_loss: 14971952.3163; val_kl_reg_loss: 8719.3352; val_edge_recon_loss: 7847931.9792; val_gene_expr_recon_loss: 7206708.8542; val_masked_gp_l1_reg_loss: 16118.7500; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15079479.1250; val_optim_loss: 15079479.1250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9600; val_auprc_score: 0.9903; val_best_acc_score: 0.9485; val_best_f1_score: 0.9702; train_kl_reg_loss: 25666.4569; train_edge_recon_loss: 7701582.4605; train_gene_expr_recon_loss: 7174602.2721; train_masked_gp_l1_reg_loss: 15915.1362; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14917766.3628; train_optim_loss: 14917766.3628; val_kl_reg_loss: 8692.1992; val_edge_recon_loss: 7929573.2917; val_gene_expr_recon_loss: 7192670.2917; val_masked_gp_l1_reg_loss: 15713.6211; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15146649.8750; val_optim_loss: 15146649.8750
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9614; val_auprc_score: 0.9908; val_best_acc_score: 0.9490; val_best_f1_score: 0.9702; train_kl_reg_loss: 23614.6084; train_edge_recon_loss: 7706416.6093; train_gene_expr_recon_loss: 7161007.9860; train_masked_gp_l1_reg_loss: 15511.7533; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14906551.0000; train_optim_loss: 14906551.0000; val_kl_reg_loss: 8580.9636; val_edge_recon_loss: 7898719.3542; val_gene_expr_recon_loss: 7173918.2083; val_masked_gp_l1_reg_loss: 15304.2100; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15096522.5833; val_optim_loss: 15096522.5833

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9564; val_auprc_score: 0.9898; val_best_acc_score: 0.9486; val_best_f1_score: 0.9703; train_kl_reg_loss: 22627.7630; train_edge_recon_loss: 7631951.3233; train_gene_expr_recon_loss: 7132643.4977; train_masked_gp_l1_reg_loss: 15275.3376; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14802497.9163; train_optim_loss: 14802497.9163; val_kl_reg_loss: 8846.6319; val_edge_recon_loss: 7855279.1458; val_gene_expr_recon_loss: 7146444.0000; val_masked_gp_l1_reg_loss: 15256.9092; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15025826.7917; val_optim_loss: 15025826.7917
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9640; val_auprc_score: 0.9908; val_best_acc_score: 0.9525; val_best_f1_score: 0.9723; train_kl_reg_loss: 22606.5856; train_edge_recon_loss: 7702135.2930; train_gene_expr_recon_loss: 7127737.0721; train_masked_gp_l1_reg_loss: 15239.0600; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14867717.9721; train_optim_loss: 14867717.9721; val_kl_reg_loss: 8739.8307; val_edge_recon_loss: 7835166.9583; val_gene_expr_recon_loss: 7145701.4792; val_masked_gp_l1_reg_loss: 15221.9629; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15004830.3750; val_optim_loss: 15004830.3750
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9602; val_auprc_score: 0.9908; val_best_acc_score: 0.9483; val_best_f1_score: 0.9699; train_kl_reg_loss: 22209.3414; train_edge_recon_loss: 7671230.5767; train_gene_expr_recon_loss: 7126124.1233; train_masked_gp_l1_reg_loss: 15202.7612; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14834766.7767; train_optim_loss: 14834766.7767; val_kl_reg_loss: 8863.4589; val_edge_recon_loss: 7961746.5208; val_gene_expr_recon_loss: 7143435.3542; val_masked_gp_l1_reg_loss: 15185.7109; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15129231.3333; val_optim_loss: 15129231.3333
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9590; val_auprc_score: 0.9911; val_best_acc_score: 0.9496; val_best_f1_score: 0.9709; train_kl_reg_loss: 22180.9742; train_edge_recon_loss: 7705698.5791; train_gene_expr_recon_loss: 7126169.6302; train_masked_gp_l1_reg_loss: 15166.6932; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14869215.8605; train_optim_loss: 14869215.8605; val_kl_reg_loss: 8972.4009; val_edge_recon_loss: 7765494.6458; val_gene_expr_recon_loss: 7145596.5208; val_masked_gp_l1_reg_loss: 15146.2148; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14935209.4583; val_optim_loss: 14935209.4583

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 31 min 58 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9567
Val AUPRC score: 0.9899
Val best accuracy score: 0.9456
Val best F1 score: 0.9686
Val gene expr MSE score: 83462.9550
Val cat covariate0 mean sim diff: -0.0018

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
