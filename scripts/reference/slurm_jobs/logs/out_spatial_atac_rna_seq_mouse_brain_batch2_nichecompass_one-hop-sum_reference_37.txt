[True]
Run timestamp: 10082023_202353_37.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-sum_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '20', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-sum', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_37']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 4429 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 23741 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-sum
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP SUM NODE LABEL AGGREGATOR
ENCODER -> n_input: 27892, n_cat_covariates_embed_input: 0, n_hidden: 2622, n_latent: 2602, n_addon_latent: 20, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 4151
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2602, n_addon_gp_input: 20, n_cat_covariates_embed_input: 0, n_output: 23741

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7504; val_auprc_score: 0.7799; val_best_acc_score: 0.5658; val_best_f1_score: 0.6898; train_kl_reg_loss: 167122.7209; train_edge_recon_loss: 3899599.7901; train_gene_expr_recon_loss: 28629517.5267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 125940359.8168; train_global_loss: 158636599.8168; train_optim_loss: 158636599.8168; val_kl_reg_loss: 281452.0385; val_edge_recon_loss: 4061429.4667; val_gene_expr_recon_loss: 23493097.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 115401849.6000; val_global_loss: 143237826.1333; val_optim_loss: 143237826.1333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7912; val_auprc_score: 0.8073; val_best_acc_score: 0.7064; val_best_f1_score: 0.7161; train_kl_reg_loss: 193117.9907; train_edge_recon_loss: 3777941.4714; train_gene_expr_recon_loss: 23030517.9237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 115918281.4046; train_global_loss: 142919859.2366; train_optim_loss: 142919859.2366; val_kl_reg_loss: 176645.7760; val_edge_recon_loss: 4024706.4000; val_gene_expr_recon_loss: 22698577.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 114783256.0000; val_global_loss: 141683185.0667; val_optim_loss: 141683185.0667
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8590; val_auprc_score: 0.8541; val_best_acc_score: 0.7668; val_best_f1_score: 0.7832; train_kl_reg_loss: 197559.5180; train_edge_recon_loss: 3511794.1737; train_gene_expr_recon_loss: 22315676.5649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 114563109.1298; train_global_loss: 140588139.2977; train_optim_loss: 140588139.2977; val_kl_reg_loss: 189757.3385; val_edge_recon_loss: 3347778.1833; val_gene_expr_recon_loss: 22330508.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 113714137.0667; val_global_loss: 139582181.3333; val_optim_loss: 139582181.3333
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8814; val_auprc_score: 0.8718; val_best_acc_score: 0.7941; val_best_f1_score: 0.8109; train_kl_reg_loss: 221066.5292; train_edge_recon_loss: 3125380.4447; train_gene_expr_recon_loss: 22067564.9313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 113531006.3511; train_global_loss: 138945018.3817; train_optim_loss: 138945018.3817; val_kl_reg_loss: 227079.4917; val_edge_recon_loss: 3049796.9667; val_gene_expr_recon_loss: 22115554.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 112547895.4667; val_global_loss: 137940325.8667; val_optim_loss: 137940325.8667
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8819; val_auprc_score: 0.8665; val_best_acc_score: 0.8026; val_best_f1_score: 0.8203; train_kl_reg_loss: 218790.9764; train_edge_recon_loss: 3030718.2996; train_gene_expr_recon_loss: 21905378.9466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 113102536.5496; train_global_loss: 138257423.8779; train_optim_loss: 138257423.8779; val_kl_reg_loss: 207668.9979; val_edge_recon_loss: 3035919.7000; val_gene_expr_recon_loss: 21928823.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 112202863.4667; val_global_loss: 137375276.8000; val_optim_loss: 137375276.8000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8970; val_auprc_score: 0.8807; val_best_acc_score: 0.8169; val_best_f1_score: 0.8307; train_kl_reg_loss: 205412.8509; train_edge_recon_loss: 2989656.7252; train_gene_expr_recon_loss: 21755454.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 112454601.8931; train_global_loss: 137405126.1069; train_optim_loss: 137405126.1069; val_kl_reg_loss: 195422.2938; val_edge_recon_loss: 3005541.2833; val_gene_expr_recon_loss: 21782556.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 111350910.4000; val_global_loss: 136334430.9333; val_optim_loss: 136334430.9333
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9090; val_auprc_score: 0.8935; val_best_acc_score: 0.8362; val_best_f1_score: 0.8490; train_kl_reg_loss: 196941.9398; train_edge_recon_loss: 2944245.1698; train_gene_expr_recon_loss: 21632093.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111835719.3282; train_global_loss: 136608999.5725; train_optim_loss: 136608999.5725; val_kl_reg_loss: 190950.9302; val_edge_recon_loss: 2948470.5833; val_gene_expr_recon_loss: 21649168.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110780471.4667; val_global_loss: 135569064.0000; val_optim_loss: 135569064.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9173; val_auprc_score: 0.9014; val_best_acc_score: 0.8460; val_best_f1_score: 0.8566; train_kl_reg_loss: 190495.8756; train_edge_recon_loss: 2904136.3073; train_gene_expr_recon_loss: 21526770.0458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 111442810.1985; train_global_loss: 136064212.6412; train_optim_loss: 136064212.6412; val_kl_reg_loss: 191377.3844; val_edge_recon_loss: 2918076.1667; val_gene_expr_recon_loss: 21561763.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 110423604.8000; val_global_loss: 135094821.8667; val_optim_loss: 135094821.8667
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9259; val_auprc_score: 0.9110; val_best_acc_score: 0.8560; val_best_f1_score: 0.8671; train_kl_reg_loss: 187178.2777; train_edge_recon_loss: 2879916.4752; train_gene_expr_recon_loss: 21430604.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110933383.2061; train_global_loss: 135431081.8931; train_optim_loss: 135431081.8931; val_kl_reg_loss: 183140.5073; val_edge_recon_loss: 2889906.1000; val_gene_expr_recon_loss: 21485080.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109843318.9333; val_global_loss: 134401446.4000; val_optim_loss: 134401446.4000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9310; val_auprc_score: 0.9157; val_best_acc_score: 0.8627; val_best_f1_score: 0.8716; train_kl_reg_loss: 182103.9767; train_edge_recon_loss: 2868005.8798; train_gene_expr_recon_loss: 21340815.6336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110376051.7252; train_global_loss: 134766977.5878; train_optim_loss: 134766977.5878; val_kl_reg_loss: 178700.5510; val_edge_recon_loss: 2881412.8000; val_gene_expr_recon_loss: 21358711.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109028837.3333; val_global_loss: 133447661.8667; val_optim_loss: 133447661.8667
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9299; val_auprc_score: 0.9146; val_best_acc_score: 0.8641; val_best_f1_score: 0.8726; train_kl_reg_loss: 175589.8339; train_edge_recon_loss: 2855619.6298; train_gene_expr_recon_loss: 21272765.6794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 110060385.8321; train_global_loss: 134364361.2214; train_optim_loss: 134364361.2214; val_kl_reg_loss: 172325.1854; val_edge_recon_loss: 2882939.2500; val_gene_expr_recon_loss: 21376470.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109472113.0667; val_global_loss: 133903846.4000; val_optim_loss: 133903846.4000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9390; val_auprc_score: 0.9260; val_best_acc_score: 0.8750; val_best_f1_score: 0.8811; train_kl_reg_loss: 173168.3256; train_edge_recon_loss: 2833158.5916; train_gene_expr_recon_loss: 21195633.0534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109567380.2748; train_global_loss: 133769340.1527; train_optim_loss: 133769340.1527; val_kl_reg_loss: 170151.8552; val_edge_recon_loss: 2859548.0667; val_gene_expr_recon_loss: 21421177.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109963780.8000; val_global_loss: 134414658.1333; val_optim_loss: 134414658.1333
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9436; val_auprc_score: 0.9308; val_best_acc_score: 0.8821; val_best_f1_score: 0.8873; train_kl_reg_loss: 168198.6910; train_edge_recon_loss: 2823385.1107; train_gene_expr_recon_loss: 21121515.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 109222485.5573; train_global_loss: 133335584.2443; train_optim_loss: 133335584.2443; val_kl_reg_loss: 165140.4625; val_edge_recon_loss: 2839282.5333; val_gene_expr_recon_loss: 21317987.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 109262393.0667; val_global_loss: 133584803.7333; val_optim_loss: 133584803.7333
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9430; val_auprc_score: 0.9295; val_best_acc_score: 0.8795; val_best_f1_score: 0.8844; train_kl_reg_loss: 163539.6964; train_edge_recon_loss: 2820001.3626; train_gene_expr_recon_loss: 21056411.3130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108825880.5496; train_global_loss: 132865833.0382; train_optim_loss: 132865833.0382; val_kl_reg_loss: 163410.9354; val_edge_recon_loss: 2827853.2333; val_gene_expr_recon_loss: 21146384.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 108280897.0667; val_global_loss: 132418545.0667; val_optim_loss: 132418545.0667
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9471; val_auprc_score: 0.9372; val_best_acc_score: 0.8836; val_best_f1_score: 0.8893; train_kl_reg_loss: 162510.7172; train_edge_recon_loss: 2804111.4160; train_gene_expr_recon_loss: 21022224.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108561336.7328; train_global_loss: 132550183.6336; train_optim_loss: 132550183.6336; val_kl_reg_loss: 158032.1677; val_edge_recon_loss: 2819710.5000; val_gene_expr_recon_loss: 21116516.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107591064.0000; val_global_loss: 131685323.2000; val_optim_loss: 131685323.2000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9503; val_auprc_score: 0.9398; val_best_acc_score: 0.8866; val_best_f1_score: 0.8913; train_kl_reg_loss: 157759.8329; train_edge_recon_loss: 2805110.7882; train_gene_expr_recon_loss: 20994886.0611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108479753.2824; train_global_loss: 132437509.8626; train_optim_loss: 132437509.8626; val_kl_reg_loss: 155824.2656; val_edge_recon_loss: 2811781.1333; val_gene_expr_recon_loss: 21030127.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107333872.5333; val_global_loss: 131331604.8000; val_optim_loss: 131331604.8000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9489; val_auprc_score: 0.9396; val_best_acc_score: 0.8835; val_best_f1_score: 0.8905; train_kl_reg_loss: 155290.7673; train_edge_recon_loss: 2786058.5725; train_gene_expr_recon_loss: 20937016.7939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 108128108.6412; train_global_loss: 132006474.3206; train_optim_loss: 132006474.3206; val_kl_reg_loss: 153471.0198; val_edge_recon_loss: 2827834.5333; val_gene_expr_recon_loss: 21056022.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107858429.8667; val_global_loss: 131895756.8000; val_optim_loss: 131895756.8000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9498; val_auprc_score: 0.9404; val_best_acc_score: 0.8853; val_best_f1_score: 0.8907; train_kl_reg_loss: 153481.7797; train_edge_recon_loss: 2789275.6050; train_gene_expr_recon_loss: 20912254.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107889328.2443; train_global_loss: 131744340.0916; train_optim_loss: 131744340.0916; val_kl_reg_loss: 151222.1406; val_edge_recon_loss: 2816018.0000; val_gene_expr_recon_loss: 21033731.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107422330.6667; val_global_loss: 131423301.8667; val_optim_loss: 131423301.8667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9547; val_auprc_score: 0.9472; val_best_acc_score: 0.8875; val_best_f1_score: 0.8930; train_kl_reg_loss: 148038.5719; train_edge_recon_loss: 2789881.0286; train_gene_expr_recon_loss: 20848357.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107556851.9084; train_global_loss: 131343129.0992; train_optim_loss: 131343129.0992; val_kl_reg_loss: 141579.4271; val_edge_recon_loss: 2793209.8333; val_gene_expr_recon_loss: 20973846.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107043103.4667; val_global_loss: 130951739.7333; val_optim_loss: 130951739.7333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9525; val_auprc_score: 0.9443; val_best_acc_score: 0.8874; val_best_f1_score: 0.8939; train_kl_reg_loss: 146470.7736; train_edge_recon_loss: 2782902.7939; train_gene_expr_recon_loss: 20811910.6718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107344225.8321; train_global_loss: 131085509.9237; train_optim_loss: 131085509.9237; val_kl_reg_loss: 148772.9958; val_edge_recon_loss: 2804456.7167; val_gene_expr_recon_loss: 20961501.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107230895.4667; val_global_loss: 131145627.2000; val_optim_loss: 131145627.2000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9554; val_auprc_score: 0.9495; val_best_acc_score: 0.8876; val_best_f1_score: 0.8928; train_kl_reg_loss: 143609.3532; train_edge_recon_loss: 2775512.8092; train_gene_expr_recon_loss: 20798393.2672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107255787.6641; train_global_loss: 130973303.2672; train_optim_loss: 130973303.2672; val_kl_reg_loss: 137789.4156; val_edge_recon_loss: 2803929.1833; val_gene_expr_recon_loss: 20944417.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106699477.8667; val_global_loss: 130585614.4000; val_optim_loss: 130585614.4000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9603; val_auprc_score: 0.9548; val_best_acc_score: 0.8956; val_best_f1_score: 0.9007; train_kl_reg_loss: 140901.8335; train_edge_recon_loss: 2773294.7004; train_gene_expr_recon_loss: 20790237.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107192564.7634; train_global_loss: 130896999.0840; train_optim_loss: 130896999.0840; val_kl_reg_loss: 138945.2167; val_edge_recon_loss: 2805447.4667; val_gene_expr_recon_loss: 20974825.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 107302095.4667; val_global_loss: 131221314.6667; val_optim_loss: 131221314.6667
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9550; val_auprc_score: 0.9444; val_best_acc_score: 0.8911; val_best_f1_score: 0.8964; train_kl_reg_loss: 138412.5741; train_edge_recon_loss: 2785416.6336; train_gene_expr_recon_loss: 20846439.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107487764.6412; train_global_loss: 131258033.7099; train_optim_loss: 131258033.7099; val_kl_reg_loss: 131351.2927; val_edge_recon_loss: 2812758.8333; val_gene_expr_recon_loss: 20832458.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 105968028.2667; val_global_loss: 129744597.8667; val_optim_loss: 129744597.8667
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9532; val_auprc_score: 0.9430; val_best_acc_score: 0.8845; val_best_f1_score: 0.8934; train_kl_reg_loss: 125074.2498; train_edge_recon_loss: 2798199.3798; train_gene_expr_recon_loss: 20859801.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107422893.8626; train_global_loss: 131205969.3435; train_optim_loss: 131205969.3435; val_kl_reg_loss: 127460.7370; val_edge_recon_loss: 2814414.3000; val_gene_expr_recon_loss: 20895298.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106326325.8667; val_global_loss: 130163500.2667; val_optim_loss: 130163500.2667
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9591; val_auprc_score: 0.9523; val_best_acc_score: 0.8953; val_best_f1_score: 0.8992; train_kl_reg_loss: 136313.7648; train_edge_recon_loss: 2780192.3740; train_gene_expr_recon_loss: 20778630.0153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107155000.5496; train_global_loss: 130850136.7939; train_optim_loss: 130850136.7939; val_kl_reg_loss: 134630.4979; val_edge_recon_loss: 2793088.7500; val_gene_expr_recon_loss: 20871057.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106272762.6667; val_global_loss: 130071539.2000; val_optim_loss: 130071539.2000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9628; val_auprc_score: 0.9562; val_best_acc_score: 0.9012; val_best_f1_score: 0.9065; train_kl_reg_loss: 141897.6370; train_edge_recon_loss: 2795851.6202; train_gene_expr_recon_loss: 21080186.1374; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107558199.6336; train_global_loss: 131576135.1450; train_optim_loss: 131576135.1450; val_kl_reg_loss: 97405.1740; val_edge_recon_loss: 2801990.5333; val_gene_expr_recon_loss: 21150430.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106787483.7333; val_global_loss: 130837309.8667; val_optim_loss: 130837309.8667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9612; val_auprc_score: 0.9552; val_best_acc_score: 0.8983; val_best_f1_score: 0.9040; train_kl_reg_loss: 145361.3230; train_edge_recon_loss: 2780964.9294; train_gene_expr_recon_loss: 20989996.1985; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107336010.0763; train_global_loss: 131252332.3359; train_optim_loss: 131252332.3359; val_kl_reg_loss: 99718.6880; val_edge_recon_loss: 2779607.3500; val_gene_expr_recon_loss: 21050504.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106762479.4667; val_global_loss: 130692310.4000; val_optim_loss: 130692310.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9618; val_auprc_score: 0.9550; val_best_acc_score: 0.9004; val_best_f1_score: 0.9052; train_kl_reg_loss: 143247.0224; train_edge_recon_loss: 2777219.4676; train_gene_expr_recon_loss: 20937560.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107060172.1527; train_global_loss: 130918199.2672; train_optim_loss: 130918199.2672; val_kl_reg_loss: 100714.4198; val_edge_recon_loss: 2776838.6833; val_gene_expr_recon_loss: 21002661.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106501428.8000; val_global_loss: 130381642.6667; val_optim_loss: 130381642.6667
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9621; val_auprc_score: 0.9528; val_best_acc_score: 0.9015; val_best_f1_score: 0.9067; train_kl_reg_loss: 143084.2828; train_edge_recon_loss: 2778530.6431; train_gene_expr_recon_loss: 20935385.4809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107122073.9542; train_global_loss: 130979074.1985; train_optim_loss: 130979074.1985; val_kl_reg_loss: 101157.8375; val_edge_recon_loss: 2770212.5500; val_gene_expr_recon_loss: 20995524.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106018478.9333; val_global_loss: 129885373.8667; val_optim_loss: 129885373.8667
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9586; val_auprc_score: 0.9493; val_best_acc_score: 0.8949; val_best_f1_score: 0.9016; train_kl_reg_loss: 142940.6857; train_edge_recon_loss: 2773875.8740; train_gene_expr_recon_loss: 20949797.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107254922.7481; train_global_loss: 131121537.5267; train_optim_loss: 131121537.5267; val_kl_reg_loss: 100676.6458; val_edge_recon_loss: 2790677.1500; val_gene_expr_recon_loss: 21089612.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106395296.0000; val_global_loss: 130376262.4000; val_optim_loss: 130376262.4000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9625; val_auprc_score: 0.9555; val_best_acc_score: 0.9014; val_best_f1_score: 0.9062; train_kl_reg_loss: 142305.0641; train_edge_recon_loss: 2768594.6412; train_gene_expr_recon_loss: 20930504.7634; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_chrom_access_recon_loss: 107097053.4351; train_global_loss: 130938458.1374; train_optim_loss: 130938458.1374; val_kl_reg_loss: 101450.9349; val_edge_recon_loss: 2773741.8667; val_gene_expr_recon_loss: 21027504.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_chrom_access_recon_loss: 106375538.6667; val_global_loss: 130278235.2000; val_optim_loss: 130278235.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 45 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9578
val AUPRC score: 0.9499
val best accuracy score: 0.8934
val best F1 score: 0.8984
val target rna MSE score: 1.3678
val source rna MSE score: 35.8850
val target atac MSE score: 0.1222
val source atac MSE score: 0.8891
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
