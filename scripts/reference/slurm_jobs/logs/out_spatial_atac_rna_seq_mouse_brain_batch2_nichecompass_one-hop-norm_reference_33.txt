[True]
Run timestamp: 07082023_181238_33.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '4000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '100', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '10', '--lambda_l1_addon', '10.', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '8', '--timestamp_suffix', '_33']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5114 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19267 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM NODE LABEL AGGREGATOR
ENCODER -> n_input: 23942, n_cat_covariates_embed_input: 0, n_hidden: 2673, n_latent: 2573, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4675
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2573, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19267

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8918; val_auprc_score: 0.9030; val_best_acc_score: 0.5050; val_best_f1_score: 0.6689; train_kl_reg_loss: 14271.0119; train_edge_recon_loss: 35783.4358; train_gene_expr_recon_loss: 1170532.0556; train_masked_gp_l1_reg_loss: 8470.8923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167233.6788; train_chrom_access_recon_loss: 769950.9549; train_global_loss: 2166242.0556; train_optim_loss: 2166242.0556; val_kl_reg_loss: 8924.8242; val_edge_recon_loss: 40653.5820; val_gene_expr_recon_loss: 969448.5000; val_masked_gp_l1_reg_loss: 6837.7202; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162710.1875; val_chrom_access_recon_loss: 501794.9375; val_global_loss: 1690369.7500; val_optim_loss: 1690369.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8919; val_auprc_score: 0.9041; val_best_acc_score: 0.5016; val_best_f1_score: 0.6674; train_kl_reg_loss: 13903.7496; train_edge_recon_loss: 37907.5317; train_gene_expr_recon_loss: 893391.6111; train_masked_gp_l1_reg_loss: 6354.0816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159801.0642; train_chrom_access_recon_loss: 491869.1771; train_global_loss: 1603227.2222; train_optim_loss: 1603227.2222; val_kl_reg_loss: 18043.8398; val_edge_recon_loss: 40656.5586; val_gene_expr_recon_loss: 812356.6250; val_masked_gp_l1_reg_loss: 6043.7373; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156090.2969; val_chrom_access_recon_loss: 465467.3750; val_global_loss: 1498658.5000; val_optim_loss: 1498658.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8813; val_auprc_score: 0.8924; val_best_acc_score: 0.5049; val_best_f1_score: 0.6688; train_kl_reg_loss: 20070.6259; train_edge_recon_loss: 38676.0707; train_gene_expr_recon_loss: 796762.0278; train_masked_gp_l1_reg_loss: 6163.6633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 152819.5399; train_chrom_access_recon_loss: 464518.8750; train_global_loss: 1479010.7917; train_optim_loss: 1479010.7917; val_kl_reg_loss: 21204.0332; val_edge_recon_loss: 40654.8516; val_gene_expr_recon_loss: 760675.1875; val_masked_gp_l1_reg_loss: 6295.1226; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148503.5625; val_chrom_access_recon_loss: 452333.9375; val_global_loss: 1429666.7500; val_optim_loss: 1429666.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8569; val_auprc_score: 0.8687; val_best_acc_score: 0.5163; val_best_f1_score: 0.6739; train_kl_reg_loss: 23016.6658; train_edge_recon_loss: 38877.0295; train_gene_expr_recon_loss: 753447.0208; train_masked_gp_l1_reg_loss: 6265.3543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144688.5747; train_chrom_access_recon_loss: 458789.6458; train_global_loss: 1425084.3194; train_optim_loss: 1425084.3194; val_kl_reg_loss: 21538.3535; val_edge_recon_loss: 40647.7109; val_gene_expr_recon_loss: 731549.8750; val_masked_gp_l1_reg_loss: 6210.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 139734.2500; val_chrom_access_recon_loss: 446490.7812; val_global_loss: 1386171.7500; val_optim_loss: 1386171.7500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8411; val_auprc_score: 0.8491; val_best_acc_score: 0.5376; val_best_f1_score: 0.6825; train_kl_reg_loss: 22143.8700; train_edge_recon_loss: 38840.7105; train_gene_expr_recon_loss: 727433.2014; train_masked_gp_l1_reg_loss: 6188.7935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135594.4201; train_chrom_access_recon_loss: 448897.0347; train_global_loss: 1379098.0417; train_optim_loss: 1379098.0417; val_kl_reg_loss: 21587.9199; val_edge_recon_loss: 40624.2266; val_gene_expr_recon_loss: 712168.1250; val_masked_gp_l1_reg_loss: 6156.4404; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130367.5156; val_chrom_access_recon_loss: 443072.4688; val_global_loss: 1353976.6250; val_optim_loss: 1353976.6250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8391; val_auprc_score: 0.8445; val_best_acc_score: 0.5463; val_best_f1_score: 0.6844; train_kl_reg_loss: 22506.4371; train_edge_recon_loss: 38865.1115; train_gene_expr_recon_loss: 713441.0486; train_masked_gp_l1_reg_loss: 6130.3594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126160.6207; train_chrom_access_recon_loss: 448050.6944; train_global_loss: 1355154.2222; train_optim_loss: 1355154.2222; val_kl_reg_loss: 21433.4648; val_edge_recon_loss: 40597.0234; val_gene_expr_recon_loss: 697905.5000; val_masked_gp_l1_reg_loss: 6092.7988; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120910.4375; val_chrom_access_recon_loss: 440551.6562; val_global_loss: 1327490.8750; val_optim_loss: 1327490.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8523; val_auprc_score: 0.8504; val_best_acc_score: 0.5722; val_best_f1_score: 0.6950; train_kl_reg_loss: 22681.5267; train_edge_recon_loss: 38860.8247; train_gene_expr_recon_loss: 701251.7361; train_masked_gp_l1_reg_loss: 6073.5865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116777.8585; train_chrom_access_recon_loss: 445759.7604; train_global_loss: 1331405.3056; train_optim_loss: 1331405.3056; val_kl_reg_loss: 21535.3086; val_edge_recon_loss: 40558.9688; val_gene_expr_recon_loss: 685692.1250; val_masked_gp_l1_reg_loss: 6042.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111671.9375; val_chrom_access_recon_loss: 438680.0312; val_global_loss: 1304180.6250; val_optim_loss: 1304180.6250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8618; val_auprc_score: 0.8598; val_best_acc_score: 0.5846; val_best_f1_score: 0.7000; train_kl_reg_loss: 22654.0894; train_edge_recon_loss: 38891.3759; train_gene_expr_recon_loss: 683723.9861; train_masked_gp_l1_reg_loss: 6030.6204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107711.5035; train_chrom_access_recon_loss: 440132.5868; train_global_loss: 1299144.1806; train_optim_loss: 1299144.1806; val_kl_reg_loss: 23124.5859; val_edge_recon_loss: 40534.8945; val_gene_expr_recon_loss: 676161.5625; val_masked_gp_l1_reg_loss: 6010.0366; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102849.7812; val_chrom_access_recon_loss: 437080.6250; val_global_loss: 1285761.5000; val_optim_loss: 1285761.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8501; val_auprc_score: 0.8528; val_best_acc_score: 0.6136; val_best_f1_score: 0.7135; train_kl_reg_loss: 22850.1560; train_edge_recon_loss: 38898.0699; train_gene_expr_recon_loss: 681326.9167; train_masked_gp_l1_reg_loss: 6004.2706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99128.0009; train_chrom_access_recon_loss: 439965.6910; train_global_loss: 1288173.0972; train_optim_loss: 1288173.0972; val_kl_reg_loss: 21659.2539; val_edge_recon_loss: 40493.5312; val_gene_expr_recon_loss: 670200.2500; val_masked_gp_l1_reg_loss: 5996.4937; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94588.9062; val_chrom_access_recon_loss: 435514.5000; val_global_loss: 1268453.0000; val_optim_loss: 1268453.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8515; val_auprc_score: 0.8526; val_best_acc_score: 0.6194; val_best_f1_score: 0.7165; train_kl_reg_loss: 22612.1000; train_edge_recon_loss: 38893.3203; train_gene_expr_recon_loss: 666786.0278; train_masked_gp_l1_reg_loss: 5998.0517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91157.0729; train_chrom_access_recon_loss: 436298.7812; train_global_loss: 1261745.3472; train_optim_loss: 1261745.3472; val_kl_reg_loss: 22507.9766; val_edge_recon_loss: 40521.1133; val_gene_expr_recon_loss: 664923.6875; val_masked_gp_l1_reg_loss: 5991.9341; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86980.7344; val_chrom_access_recon_loss: 434272.2500; val_global_loss: 1255197.7500; val_optim_loss: 1255197.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8567; val_auprc_score: 0.8582; val_best_acc_score: 0.6481; val_best_f1_score: 0.7302; train_kl_reg_loss: 22145.2912; train_edge_recon_loss: 38880.3333; train_gene_expr_recon_loss: 669498.2431; train_masked_gp_l1_reg_loss: 5989.2493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83840.8047; train_chrom_access_recon_loss: 439007.1736; train_global_loss: 1259361.0972; train_optim_loss: 1259361.0972; val_kl_reg_loss: 21636.9824; val_edge_recon_loss: 40478.5820; val_gene_expr_recon_loss: 660836.7500; val_masked_gp_l1_reg_loss: 5988.5669; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80052.3438; val_chrom_access_recon_loss: 433155.9688; val_global_loss: 1242149.2500; val_optim_loss: 1242149.2500
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8639; val_auprc_score: 0.8666; val_best_acc_score: 0.6832; val_best_f1_score: 0.7487; train_kl_reg_loss: 21973.2459; train_edge_recon_loss: 38874.2721; train_gene_expr_recon_loss: 664616.6111; train_masked_gp_l1_reg_loss: 5992.5885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77238.2839; train_chrom_access_recon_loss: 439893.6736; train_global_loss: 1248588.6944; train_optim_loss: 1248588.6944; val_kl_reg_loss: 20889.0391; val_edge_recon_loss: 40474.3086; val_gene_expr_recon_loss: 657979.3125; val_masked_gp_l1_reg_loss: 5997.7676; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73842.3047; val_chrom_access_recon_loss: 432096.4375; val_global_loss: 1231279.2500; val_optim_loss: 1231279.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8782; val_auprc_score: 0.8786; val_best_acc_score: 0.7274; val_best_f1_score: 0.7741; train_kl_reg_loss: 21542.6107; train_edge_recon_loss: 38850.9058; train_gene_expr_recon_loss: 663184.1042; train_masked_gp_l1_reg_loss: 6007.4781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71320.3672; train_chrom_access_recon_loss: 436586.6215; train_global_loss: 1237492.0972; train_optim_loss: 1237492.0972; val_kl_reg_loss: 20528.5391; val_edge_recon_loss: 40441.0586; val_gene_expr_recon_loss: 655004.5625; val_masked_gp_l1_reg_loss: 6006.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68272.3359; val_chrom_access_recon_loss: 431110.6875; val_global_loss: 1221363.8750; val_optim_loss: 1221363.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8864; val_auprc_score: 0.8838; val_best_acc_score: 0.7758; val_best_f1_score: 0.8036; train_kl_reg_loss: 21239.6309; train_edge_recon_loss: 38803.7305; train_gene_expr_recon_loss: 656397.9861; train_masked_gp_l1_reg_loss: 6010.2581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66002.7834; train_chrom_access_recon_loss: 435294.5278; train_global_loss: 1223748.9028; train_optim_loss: 1223748.9028; val_kl_reg_loss: 19969.6094; val_edge_recon_loss: 40382.5625; val_gene_expr_recon_loss: 652620.8750; val_masked_gp_l1_reg_loss: 6009.4043; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63244.0547; val_chrom_access_recon_loss: 430171.0938; val_global_loss: 1212397.6250; val_optim_loss: 1212397.6250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9020; val_auprc_score: 0.8950; val_best_acc_score: 0.8150; val_best_f1_score: 0.8311; train_kl_reg_loss: 20976.9162; train_edge_recon_loss: 38761.6341; train_gene_expr_recon_loss: 662186.0069; train_masked_gp_l1_reg_loss: 6017.4130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61199.0582; train_chrom_access_recon_loss: 435574.0972; train_global_loss: 1224715.1250; train_optim_loss: 1224715.1250; val_kl_reg_loss: 20704.2930; val_edge_recon_loss: 40336.0742; val_gene_expr_recon_loss: 649080.8750; val_masked_gp_l1_reg_loss: 6024.8633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58732.9375; val_chrom_access_recon_loss: 429250.9375; val_global_loss: 1204130.0000; val_optim_loss: 1204130.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9127; val_auprc_score: 0.9055; val_best_acc_score: 0.8422; val_best_f1_score: 0.8486; train_kl_reg_loss: 20856.2333; train_edge_recon_loss: 38734.6823; train_gene_expr_recon_loss: 655291.4653; train_masked_gp_l1_reg_loss: 6039.3675; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56896.9132; train_chrom_access_recon_loss: 434299.6771; train_global_loss: 1212118.3333; train_optim_loss: 1212118.3333; val_kl_reg_loss: 19393.1934; val_edge_recon_loss: 40239.5078; val_gene_expr_recon_loss: 648280.3750; val_masked_gp_l1_reg_loss: 6047.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54651.9766; val_chrom_access_recon_loss: 428519.1875; val_global_loss: 1197132.2500; val_optim_loss: 1197132.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9139; val_auprc_score: 0.9058; val_best_acc_score: 0.8434; val_best_f1_score: 0.8465; train_kl_reg_loss: 20442.0911; train_edge_recon_loss: 38675.2001; train_gene_expr_recon_loss: 652987.2639; train_masked_gp_l1_reg_loss: 6057.5634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52979.1875; train_chrom_access_recon_loss: 433980.9514; train_global_loss: 1205122.2917; train_optim_loss: 1205122.2917; val_kl_reg_loss: 19128.0176; val_edge_recon_loss: 40179.3672; val_gene_expr_recon_loss: 646326.3750; val_masked_gp_l1_reg_loss: 6059.7197; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50942.1836; val_chrom_access_recon_loss: 427653.2188; val_global_loss: 1190288.8750; val_optim_loss: 1190288.8750
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9132; val_auprc_score: 0.8987; val_best_acc_score: 0.8457; val_best_f1_score: 0.8460; train_kl_reg_loss: 20176.1569; train_edge_recon_loss: 38607.5143; train_gene_expr_recon_loss: 652425.4167; train_masked_gp_l1_reg_loss: 6068.5443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49425.6489; train_chrom_access_recon_loss: 433200.2326; train_global_loss: 1199903.5556; train_optim_loss: 1199903.5556; val_kl_reg_loss: 19332.7695; val_edge_recon_loss: 40126.1641; val_gene_expr_recon_loss: 643889.2500; val_masked_gp_l1_reg_loss: 6071.6611; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47580.2031; val_chrom_access_recon_loss: 426900.7812; val_global_loss: 1183900.8750; val_optim_loss: 1183900.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9213; val_auprc_score: 0.9112; val_best_acc_score: 0.8461; val_best_f1_score: 0.8428; train_kl_reg_loss: 19941.3394; train_edge_recon_loss: 38556.9184; train_gene_expr_recon_loss: 648281.7361; train_masked_gp_l1_reg_loss: 6079.0935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46206.8155; train_chrom_access_recon_loss: 431095.2743; train_global_loss: 1190161.1667; train_optim_loss: 1190161.1667; val_kl_reg_loss: 19070.0508; val_edge_recon_loss: 40036.4453; val_gene_expr_recon_loss: 642439.8125; val_masked_gp_l1_reg_loss: 6083.8140; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44529.3125; val_chrom_access_recon_loss: 426387.0000; val_global_loss: 1178546.5000; val_optim_loss: 1178546.5000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9262; val_auprc_score: 0.9158; val_best_acc_score: 0.8475; val_best_f1_score: 0.8418; train_kl_reg_loss: 19679.7033; train_edge_recon_loss: 38490.4327; train_gene_expr_recon_loss: 649755.0278; train_masked_gp_l1_reg_loss: 6090.6236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43281.0056; train_chrom_access_recon_loss: 430101.0729; train_global_loss: 1187397.8750; train_optim_loss: 1187397.8750; val_kl_reg_loss: 19197.1211; val_edge_recon_loss: 40002.0625; val_gene_expr_recon_loss: 640723.9375; val_masked_gp_l1_reg_loss: 6096.4448; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41754.0078; val_chrom_access_recon_loss: 425638.7812; val_global_loss: 1173412.3750; val_optim_loss: 1173412.3750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9307; val_auprc_score: 0.9211; val_best_acc_score: 0.8441; val_best_f1_score: 0.8340; train_kl_reg_loss: 19500.9405; train_edge_recon_loss: 38439.6823; train_gene_expr_recon_loss: 645984.4931; train_masked_gp_l1_reg_loss: 6106.8287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 40610.9601; train_chrom_access_recon_loss: 431518.7292; train_global_loss: 1182161.6111; train_optim_loss: 1182161.6111; val_kl_reg_loss: 18482.1230; val_edge_recon_loss: 39896.6719; val_gene_expr_recon_loss: 639759.6250; val_masked_gp_l1_reg_loss: 6113.3916; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 39213.9297; val_chrom_access_recon_loss: 424888.1875; val_global_loss: 1168354.0000; val_optim_loss: 1168354.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9291; val_auprc_score: 0.9177; val_best_acc_score: 0.8336; val_best_f1_score: 0.8205; train_kl_reg_loss: 19296.5577; train_edge_recon_loss: 38386.9171; train_gene_expr_recon_loss: 645243.5625; train_masked_gp_l1_reg_loss: 6122.5182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38170.0404; train_chrom_access_recon_loss: 429758.8333; train_global_loss: 1176978.4028; train_optim_loss: 1176978.4028; val_kl_reg_loss: 17953.6094; val_edge_recon_loss: 39844.4062; val_gene_expr_recon_loss: 639140.2500; val_masked_gp_l1_reg_loss: 6125.9258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36889.2266; val_chrom_access_recon_loss: 424305.7500; val_global_loss: 1164259.2500; val_optim_loss: 1164259.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9335; val_auprc_score: 0.9214; val_best_acc_score: 0.8325; val_best_f1_score: 0.8227; train_kl_reg_loss: 19138.3969; train_edge_recon_loss: 38349.6593; train_gene_expr_recon_loss: 645340.1389; train_masked_gp_l1_reg_loss: 6136.3141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 35934.4436; train_chrom_access_recon_loss: 430188.6250; train_global_loss: 1175087.5972; train_optim_loss: 1175087.5972; val_kl_reg_loss: 17354.8906; val_edge_recon_loss: 39757.3555; val_gene_expr_recon_loss: 639032.3750; val_masked_gp_l1_reg_loss: 6141.7524; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34753.7891; val_chrom_access_recon_loss: 423825.0625; val_global_loss: 1160865.2500; val_optim_loss: 1160865.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9347; val_auprc_score: 0.9245; val_best_acc_score: 0.8393; val_best_f1_score: 0.8262; train_kl_reg_loss: 18837.3411; train_edge_recon_loss: 38301.1389; train_gene_expr_recon_loss: 643307.0347; train_masked_gp_l1_reg_loss: 6155.8041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33894.5386; train_chrom_access_recon_loss: 427948.6007; train_global_loss: 1168444.4722; train_optim_loss: 1168444.4722; val_kl_reg_loss: 18318.8516; val_edge_recon_loss: 39778.6484; val_gene_expr_recon_loss: 635836.3750; val_masked_gp_l1_reg_loss: 6162.4814; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 32832.6328; val_chrom_access_recon_loss: 423063.0312; val_global_loss: 1155992.0000; val_optim_loss: 1155992.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9391; val_auprc_score: 0.9312; val_best_acc_score: 0.8312; val_best_f1_score: 0.8388; train_kl_reg_loss: 18614.3947; train_edge_recon_loss: 38231.8524; train_gene_expr_recon_loss: 639980.4444; train_masked_gp_l1_reg_loss: 6173.0522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 32027.4729; train_chrom_access_recon_loss: 428523.1806; train_global_loss: 1163550.4167; train_optim_loss: 1163550.4167; val_kl_reg_loss: 17517.6035; val_edge_recon_loss: 39678.8789; val_gene_expr_recon_loss: 635564.0000; val_masked_gp_l1_reg_loss: 6178.5278; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31032.5586; val_chrom_access_recon_loss: 422535.7500; val_global_loss: 1152507.2500; val_optim_loss: 1152507.2500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9318; val_auprc_score: 0.9166; val_best_acc_score: 0.8402; val_best_f1_score: 0.8302; train_kl_reg_loss: 15250.5941; train_edge_recon_loss: 39338.1619; train_gene_expr_recon_loss: 954622.5764; train_masked_gp_l1_reg_loss: 6334.7384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 30132.9332; train_chrom_access_recon_loss: 449795.7326; train_global_loss: 1495474.6944; train_optim_loss: 1495474.6944; val_kl_reg_loss: 11625.2432; val_edge_recon_loss: 39834.7344; val_gene_expr_recon_loss: 946198.6250; val_masked_gp_l1_reg_loss: 6622.0996; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28906.2520; val_chrom_access_recon_loss: 446509.4375; val_global_loss: 1479696.5000; val_optim_loss: 1479696.5000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9320; val_auprc_score: 0.9173; val_best_acc_score: 0.8491; val_best_f1_score: 0.8418; train_kl_reg_loss: 14242.0846; train_edge_recon_loss: 39418.8459; train_gene_expr_recon_loss: 951466.4722; train_masked_gp_l1_reg_loss: 6872.3955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27907.3687; train_chrom_access_recon_loss: 452366.0035; train_global_loss: 1492273.1806; train_optim_loss: 1492273.1806; val_kl_reg_loss: 11898.0332; val_edge_recon_loss: 39879.4648; val_gene_expr_recon_loss: 938049.8750; val_masked_gp_l1_reg_loss: 7145.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26690.6133; val_chrom_access_recon_loss: 445443.2188; val_global_loss: 1469106.6250; val_optim_loss: 1469106.6250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9401; val_auprc_score: 0.9276; val_best_acc_score: 0.8507; val_best_f1_score: 0.8412; train_kl_reg_loss: 14192.8422; train_edge_recon_loss: 39392.8872; train_gene_expr_recon_loss: 939678.7778; train_masked_gp_l1_reg_loss: 7321.9514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25783.1502; train_chrom_access_recon_loss: 450111.5104; train_global_loss: 1476481.1528; train_optim_loss: 1476481.1528; val_kl_reg_loss: 12678.5332; val_edge_recon_loss: 39822.6719; val_gene_expr_recon_loss: 931146.0000; val_masked_gp_l1_reg_loss: 7500.7197; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24690.7852; val_chrom_access_recon_loss: 444499.2188; val_global_loss: 1460338.0000; val_optim_loss: 1460338.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9428; val_auprc_score: 0.9304; val_best_acc_score: 0.8428; val_best_f1_score: 0.8415; train_kl_reg_loss: 14377.4965; train_edge_recon_loss: 39301.7791; train_gene_expr_recon_loss: 936767.7431; train_masked_gp_l1_reg_loss: 7615.0487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23885.9525; train_chrom_access_recon_loss: 448873.1910; train_global_loss: 1470821.2361; train_optim_loss: 1470821.2361; val_kl_reg_loss: 13174.2969; val_edge_recon_loss: 39695.5352; val_gene_expr_recon_loss: 925989.6875; val_masked_gp_l1_reg_loss: 7738.3018; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22920.9492; val_chrom_access_recon_loss: 443775.6875; val_global_loss: 1453294.5000; val_optim_loss: 1453294.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9348; val_auprc_score: 0.9212; val_best_acc_score: 0.8363; val_best_f1_score: 0.8344; train_kl_reg_loss: 14370.4920; train_edge_recon_loss: 39238.3611; train_gene_expr_recon_loss: 933224.0694; train_masked_gp_l1_reg_loss: 7712.8637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22755.4353; train_chrom_access_recon_loss: 448371.6146; train_global_loss: 1465672.8472; train_optim_loss: 1465672.8472; val_kl_reg_loss: 13427.3574; val_edge_recon_loss: 39727.0664; val_gene_expr_recon_loss: 925402.6250; val_masked_gp_l1_reg_loss: 7691.0015; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22573.4609; val_chrom_access_recon_loss: 443726.4688; val_global_loss: 1452548.0000; val_optim_loss: 1452548.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9409; val_auprc_score: 0.9278; val_best_acc_score: 0.8409; val_best_f1_score: 0.8421; train_kl_reg_loss: 14476.3196; train_edge_recon_loss: 39241.4661; train_gene_expr_recon_loss: 930238.3194; train_masked_gp_l1_reg_loss: 7687.5289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22469.5827; train_chrom_access_recon_loss: 447275.0556; train_global_loss: 1461388.2639; train_optim_loss: 1461388.2639; val_kl_reg_loss: 13391.0215; val_edge_recon_loss: 39671.9766; val_gene_expr_recon_loss: 925016.7500; val_masked_gp_l1_reg_loss: 7680.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22334.9395; val_chrom_access_recon_loss: 443613.7188; val_global_loss: 1451708.6250; val_optim_loss: 1451708.6250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9388; val_auprc_score: 0.9244; val_best_acc_score: 0.8385; val_best_f1_score: 0.8390; train_kl_reg_loss: 14401.7071; train_edge_recon_loss: 39228.9761; train_gene_expr_recon_loss: 936094.3958; train_masked_gp_l1_reg_loss: 7677.8414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22238.7990; train_chrom_access_recon_loss: 450013.2222; train_global_loss: 1469654.9028; train_optim_loss: 1469654.9028; val_kl_reg_loss: 13357.4141; val_edge_recon_loss: 39690.0000; val_gene_expr_recon_loss: 924740.8750; val_masked_gp_l1_reg_loss: 7675.6812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22121.9434; val_chrom_access_recon_loss: 443692.6875; val_global_loss: 1451278.6250; val_optim_loss: 1451278.6250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9393; val_auprc_score: 0.9259; val_best_acc_score: 0.8370; val_best_f1_score: 0.8428; train_kl_reg_loss: 14480.7269; train_edge_recon_loss: 39228.8598; train_gene_expr_recon_loss: 932670.5139; train_masked_gp_l1_reg_loss: 7675.8314; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22033.6298; train_chrom_access_recon_loss: 449702.9410; train_global_loss: 1465792.5139; train_optim_loss: 1465792.5139; val_kl_reg_loss: 13416.8486; val_edge_recon_loss: 39689.3516; val_gene_expr_recon_loss: 924240.5000; val_masked_gp_l1_reg_loss: 7676.5830; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21928.3828; val_chrom_access_recon_loss: 443482.6250; val_global_loss: 1450434.2500; val_optim_loss: 1450434.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 52 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9412
val AUPRC score: 0.9308
val best accuracy score: 0.8600
val best F1 score: 0.8541
val target rna MSE score: 3.7905
val source rna MSE score: 3.1151
val target atac MSE score: 0.1298
val source atac MSE score: 0.0190
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
