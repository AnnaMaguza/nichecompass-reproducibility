[True]
Run timestamp: 09102023_205015_33.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_33']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8184; val_auprc_score: 0.8293; val_best_acc_score: 0.6188; val_best_f1_score: 0.7175; train_kl_reg_loss: 57666.2643; train_edge_recon_loss: 3497327.0821; train_gene_expr_recon_loss: 13380199.4504; train_masked_gp_l1_reg_loss: 32425.1981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2325031.7281; train_chrom_access_recon_loss: 955964.9466; train_global_loss: 20248614.6718; train_optim_loss: 20248614.6718; val_kl_reg_loss: 90441.2990; val_edge_recon_loss: 4058780.8667; val_gene_expr_recon_loss: 12723901.1333; val_masked_gp_l1_reg_loss: 38149.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 511698.1875; val_chrom_access_recon_loss: 918113.9542; val_global_loss: 18341085.0667; val_optim_loss: 18341085.0667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8198; val_auprc_score: 0.8268; val_best_acc_score: 0.7265; val_best_f1_score: 0.7494; train_kl_reg_loss: 64774.6394; train_edge_recon_loss: 3390673.2786; train_gene_expr_recon_loss: 12624592.8931; train_masked_gp_l1_reg_loss: 41343.6982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 267128.1555; train_chrom_access_recon_loss: 922505.9337; train_global_loss: 17311018.5878; train_optim_loss: 17311018.5878; val_kl_reg_loss: 69149.2229; val_edge_recon_loss: 3172001.3333; val_gene_expr_recon_loss: 12554040.7333; val_masked_gp_l1_reg_loss: 45882.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155507.5625; val_chrom_access_recon_loss: 910198.7542; val_global_loss: 16906779.9333; val_optim_loss: 16906779.9333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9095; val_auprc_score: 0.9004; val_best_acc_score: 0.8277; val_best_f1_score: 0.8365; train_kl_reg_loss: 77381.7577; train_edge_recon_loss: 3012401.5973; train_gene_expr_recon_loss: 12503067.8702; train_masked_gp_l1_reg_loss: 49357.8354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126022.6674; train_chrom_access_recon_loss: 913798.9461; train_global_loss: 16682030.6870; train_optim_loss: 16682030.6870; val_kl_reg_loss: 69986.1370; val_edge_recon_loss: 2873197.4667; val_gene_expr_recon_loss: 12418908.7333; val_masked_gp_l1_reg_loss: 52493.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110809.3516; val_chrom_access_recon_loss: 898937.5125; val_global_loss: 16424332.9333; val_optim_loss: 16424332.9333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9216; val_auprc_score: 0.9038; val_best_acc_score: 0.8546; val_best_f1_score: 0.8626; train_kl_reg_loss: 88853.6060; train_edge_recon_loss: 2809716.8034; train_gene_expr_recon_loss: 12312390.5191; train_masked_gp_l1_reg_loss: 55265.0545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105688.5132; train_chrom_access_recon_loss: 903184.7743; train_global_loss: 16275099.2595; train_optim_loss: 16275099.2595; val_kl_reg_loss: 90885.7307; val_edge_recon_loss: 2779214.7000; val_gene_expr_recon_loss: 12260278.8667; val_masked_gp_l1_reg_loss: 57297.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101113.6562; val_chrom_access_recon_loss: 891535.4083; val_global_loss: 16180326.6000; val_optim_loss: 16180326.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9316; val_auprc_score: 0.9205; val_best_acc_score: 0.8628; val_best_f1_score: 0.8697; train_kl_reg_loss: 86457.3235; train_edge_recon_loss: 2788135.2901; train_gene_expr_recon_loss: 12189514.3588; train_masked_gp_l1_reg_loss: 58980.3299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94444.5143; train_chrom_access_recon_loss: 896394.3927; train_global_loss: 16113926.1908; train_optim_loss: 16113926.1908; val_kl_reg_loss: 89806.5651; val_edge_recon_loss: 2802815.0667; val_gene_expr_recon_loss: 12121440.2667; val_masked_gp_l1_reg_loss: 60485.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89312.0156; val_chrom_access_recon_loss: 884130.3417; val_global_loss: 16047989.3333; val_optim_loss: 16047989.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9296; val_auprc_score: 0.9123; val_best_acc_score: 0.8627; val_best_f1_score: 0.8697; train_kl_reg_loss: 82908.8562; train_edge_recon_loss: 2780994.1469; train_gene_expr_recon_loss: 12084381.4275; train_masked_gp_l1_reg_loss: 61808.1195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86132.6923; train_chrom_access_recon_loss: 888460.0553; train_global_loss: 15984685.2977; train_optim_loss: 15984685.2977; val_kl_reg_loss: 81119.3990; val_edge_recon_loss: 2801151.3000; val_gene_expr_recon_loss: 12046063.9333; val_masked_gp_l1_reg_loss: 63109.4883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84260.9219; val_chrom_access_recon_loss: 877619.7042; val_global_loss: 15953324.4667; val_optim_loss: 15953324.4667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9300; val_auprc_score: 0.9138; val_best_acc_score: 0.8641; val_best_f1_score: 0.8716; train_kl_reg_loss: 80190.9541; train_edge_recon_loss: 2776980.7061; train_gene_expr_recon_loss: 11994755.8855; train_masked_gp_l1_reg_loss: 64165.6316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81091.0144; train_chrom_access_recon_loss: 882296.2538; train_global_loss: 15879480.4885; train_optim_loss: 15879480.4885; val_kl_reg_loss: 80247.2682; val_edge_recon_loss: 2799112.5333; val_gene_expr_recon_loss: 11945812.2667; val_masked_gp_l1_reg_loss: 65192.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78740.2188; val_chrom_access_recon_loss: 875498.5208; val_global_loss: 15844602.7333; val_optim_loss: 15844602.7333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9392; val_auprc_score: 0.9259; val_best_acc_score: 0.8785; val_best_f1_score: 0.8836; train_kl_reg_loss: 77454.0505; train_edge_recon_loss: 2767607.4103; train_gene_expr_recon_loss: 11924998.0687; train_masked_gp_l1_reg_loss: 66098.0567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77612.9132; train_chrom_access_recon_loss: 877807.5639; train_global_loss: 15791578.0534; train_optim_loss: 15791578.0534; val_kl_reg_loss: 81321.9568; val_edge_recon_loss: 2757882.9500; val_gene_expr_recon_loss: 11893108.8000; val_masked_gp_l1_reg_loss: 66862.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76760.9688; val_chrom_access_recon_loss: 866278.7708; val_global_loss: 15742215.4000; val_optim_loss: 15742215.4000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9467; val_auprc_score: 0.9353; val_best_acc_score: 0.8847; val_best_f1_score: 0.8907; train_kl_reg_loss: 75334.7226; train_edge_recon_loss: 2752658.0057; train_gene_expr_recon_loss: 11845189.4885; train_masked_gp_l1_reg_loss: 67631.4945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77593.0225; train_chrom_access_recon_loss: 871910.9303; train_global_loss: 15690317.7023; train_optim_loss: 15690317.7023; val_kl_reg_loss: 77156.4417; val_edge_recon_loss: 2741471.3333; val_gene_expr_recon_loss: 11877843.9333; val_masked_gp_l1_reg_loss: 68337.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78404.4062; val_chrom_access_recon_loss: 863923.8125; val_global_loss: 15707137.4667; val_optim_loss: 15707137.4667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9442; val_auprc_score: 0.9311; val_best_acc_score: 0.8825; val_best_f1_score: 0.8864; train_kl_reg_loss: 74367.2802; train_edge_recon_loss: 2734039.2233; train_gene_expr_recon_loss: 11795708.8321; train_masked_gp_l1_reg_loss: 68967.4831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78443.1379; train_chrom_access_recon_loss: 868114.0010; train_global_loss: 15619639.8931; train_optim_loss: 15619639.8931; val_kl_reg_loss: 74592.2120; val_edge_recon_loss: 2742795.0000; val_gene_expr_recon_loss: 11799682.5333; val_masked_gp_l1_reg_loss: 69741.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78483.3281; val_chrom_access_recon_loss: 860141.6500; val_global_loss: 15625436.4000; val_optim_loss: 15625436.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9468; val_auprc_score: 0.9304; val_best_acc_score: 0.8849; val_best_f1_score: 0.8918; train_kl_reg_loss: 74909.5610; train_edge_recon_loss: 2727781.4504; train_gene_expr_recon_loss: 11738800.6947; train_masked_gp_l1_reg_loss: 70232.8754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77396.8123; train_chrom_access_recon_loss: 865072.8302; train_global_loss: 15554194.2290; train_optim_loss: 15554194.2290; val_kl_reg_loss: 73464.8740; val_edge_recon_loss: 2742773.1167; val_gene_expr_recon_loss: 11717700.6667; val_masked_gp_l1_reg_loss: 70631.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77148.0469; val_chrom_access_recon_loss: 853801.0250; val_global_loss: 15535519.7333; val_optim_loss: 15535519.7333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9516; val_auprc_score: 0.9398; val_best_acc_score: 0.8872; val_best_f1_score: 0.8924; train_kl_reg_loss: 71832.4062; train_edge_recon_loss: 2727253.2729; train_gene_expr_recon_loss: 11683592.5725; train_masked_gp_l1_reg_loss: 71120.4026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76684.3152; train_chrom_access_recon_loss: 859980.7281; train_global_loss: 15490463.6641; train_optim_loss: 15490463.6641; val_kl_reg_loss: 70312.8000; val_edge_recon_loss: 2758754.0000; val_gene_expr_recon_loss: 11658316.5333; val_masked_gp_l1_reg_loss: 71626.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76339.9844; val_chrom_access_recon_loss: 850839.6875; val_global_loss: 15486190.1333; val_optim_loss: 15486190.1333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9555; val_auprc_score: 0.9442; val_best_acc_score: 0.8928; val_best_f1_score: 0.8977; train_kl_reg_loss: 72322.0050; train_edge_recon_loss: 2707546.2405; train_gene_expr_recon_loss: 11638249.4504; train_masked_gp_l1_reg_loss: 72074.2731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76032.2801; train_chrom_access_recon_loss: 856660.4275; train_global_loss: 15422884.7099; train_optim_loss: 15422884.7099; val_kl_reg_loss: 72133.8344; val_edge_recon_loss: 2727931.1333; val_gene_expr_recon_loss: 11654390.0000; val_masked_gp_l1_reg_loss: 72526.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75524.4062; val_chrom_access_recon_loss: 848206.4708; val_global_loss: 15450712.4000; val_optim_loss: 15450712.4000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9589; val_auprc_score: 0.9486; val_best_acc_score: 0.9010; val_best_f1_score: 0.9049; train_kl_reg_loss: 71142.9501; train_edge_recon_loss: 2713022.7156; train_gene_expr_recon_loss: 11605644.7710; train_masked_gp_l1_reg_loss: 72878.1973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75807.5212; train_chrom_access_recon_loss: 855129.7085; train_global_loss: 15393625.8626; train_optim_loss: 15393625.8626; val_kl_reg_loss: 72327.9734; val_edge_recon_loss: 2727964.0333; val_gene_expr_recon_loss: 11585416.8667; val_masked_gp_l1_reg_loss: 73315.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75663.7188; val_chrom_access_recon_loss: 842761.6583; val_global_loss: 15377450.6667; val_optim_loss: 15377450.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9601; val_auprc_score: 0.9483; val_best_acc_score: 0.9020; val_best_f1_score: 0.9057; train_kl_reg_loss: 70816.5319; train_edge_recon_loss: 2694813.0763; train_gene_expr_recon_loss: 11560664.1145; train_masked_gp_l1_reg_loss: 73563.8610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75411.1927; train_chrom_access_recon_loss: 850901.3960; train_global_loss: 15326170.1985; train_optim_loss: 15326170.1985; val_kl_reg_loss: 68329.1615; val_edge_recon_loss: 2720795.8167; val_gene_expr_recon_loss: 11610794.6667; val_masked_gp_l1_reg_loss: 73964.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76052.5156; val_chrom_access_recon_loss: 843552.1375; val_global_loss: 15393489.6667; val_optim_loss: 15393489.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9649; val_auprc_score: 0.9527; val_best_acc_score: 0.9138; val_best_f1_score: 0.9168; train_kl_reg_loss: 69765.9291; train_edge_recon_loss: 2697851.7672; train_gene_expr_recon_loss: 11526050.2901; train_masked_gp_l1_reg_loss: 74158.5058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75239.0602; train_chrom_access_recon_loss: 848123.6832; train_global_loss: 15291189.2137; train_optim_loss: 15291189.2137; val_kl_reg_loss: 73779.0828; val_edge_recon_loss: 2694346.1333; val_gene_expr_recon_loss: 11514369.4000; val_masked_gp_l1_reg_loss: 74343.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75574.5547; val_chrom_access_recon_loss: 835624.8792; val_global_loss: 15268037.6000; val_optim_loss: 15268037.6000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9649; val_auprc_score: 0.9561; val_best_acc_score: 0.9113; val_best_f1_score: 0.9145; train_kl_reg_loss: 69330.5900; train_edge_recon_loss: 2698065.7615; train_gene_expr_recon_loss: 11500756.2748; train_masked_gp_l1_reg_loss: 74551.5163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74803.7169; train_chrom_access_recon_loss: 846901.1880; train_global_loss: 15264408.9847; train_optim_loss: 15264408.9847; val_kl_reg_loss: 69664.2068; val_edge_recon_loss: 2720555.6000; val_gene_expr_recon_loss: 11492687.0000; val_masked_gp_l1_reg_loss: 74618.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74697.8906; val_chrom_access_recon_loss: 836219.5417; val_global_loss: 15268442.2000; val_optim_loss: 15268442.2000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9701; val_auprc_score: 0.9630; val_best_acc_score: 0.9182; val_best_f1_score: 0.9215; train_kl_reg_loss: 68202.5409; train_edge_recon_loss: 2698117.4141; train_gene_expr_recon_loss: 11474057.2672; train_masked_gp_l1_reg_loss: 74874.9480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74496.9968; train_chrom_access_recon_loss: 844924.7032; train_global_loss: 15234673.9160; train_optim_loss: 15234673.9160; val_kl_reg_loss: 70847.9698; val_edge_recon_loss: 2700293.6500; val_gene_expr_recon_loss: 11450305.2667; val_masked_gp_l1_reg_loss: 75068.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74234.2734; val_chrom_access_recon_loss: 831688.0375; val_global_loss: 15202438.0667; val_optim_loss: 15202438.0667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9664; val_auprc_score: 0.9568; val_best_acc_score: 0.9132; val_best_f1_score: 0.9161; train_kl_reg_loss: 67134.6173; train_edge_recon_loss: 2689988.5649; train_gene_expr_recon_loss: 11444841.7710; train_masked_gp_l1_reg_loss: 75178.4058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74217.4286; train_chrom_access_recon_loss: 842118.2610; train_global_loss: 15193479.1374; train_optim_loss: 15193479.1374; val_kl_reg_loss: 68376.6010; val_edge_recon_loss: 2719037.3333; val_gene_expr_recon_loss: 11456495.0000; val_masked_gp_l1_reg_loss: 75398.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74149.5703; val_chrom_access_recon_loss: 836134.4417; val_global_loss: 15229592.2000; val_optim_loss: 15229592.2000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9705; val_auprc_score: 0.9625; val_best_acc_score: 0.9217; val_best_f1_score: 0.9247; train_kl_reg_loss: 67465.4471; train_edge_recon_loss: 2686544.3817; train_gene_expr_recon_loss: 11423689.5954; train_masked_gp_l1_reg_loss: 75490.7181; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73915.1374; train_chrom_access_recon_loss: 840177.2061; train_global_loss: 15167282.5115; train_optim_loss: 15167282.5115; val_kl_reg_loss: 64685.5766; val_edge_recon_loss: 2698425.3833; val_gene_expr_recon_loss: 11415900.5333; val_masked_gp_l1_reg_loss: 75550.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73919.0938; val_chrom_access_recon_loss: 832086.7000; val_global_loss: 15160568.2667; val_optim_loss: 15160568.2667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9654; val_auprc_score: 0.9563; val_best_acc_score: 0.9131; val_best_f1_score: 0.9160; train_kl_reg_loss: 67426.1891; train_edge_recon_loss: 2686447.7328; train_gene_expr_recon_loss: 11403072.3206; train_masked_gp_l1_reg_loss: 75550.2373; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73538.8269; train_chrom_access_recon_loss: 839671.3387; train_global_loss: 15145706.6565; train_optim_loss: 15145706.6565; val_kl_reg_loss: 68501.0547; val_edge_recon_loss: 2720535.4000; val_gene_expr_recon_loss: 11426271.3333; val_masked_gp_l1_reg_loss: 75570.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73680.4844; val_chrom_access_recon_loss: 832863.0625; val_global_loss: 15197421.7333; val_optim_loss: 15197421.7333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9695; val_auprc_score: 0.9581; val_best_acc_score: 0.9198; val_best_f1_score: 0.9220; train_kl_reg_loss: 66660.3001; train_edge_recon_loss: 2684442.7309; train_gene_expr_recon_loss: 11384459.0000; train_masked_gp_l1_reg_loss: 75547.4701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73392.8745; train_chrom_access_recon_loss: 836610.5186; train_global_loss: 15121112.9389; train_optim_loss: 15121112.9389; val_kl_reg_loss: 66625.2289; val_edge_recon_loss: 2712841.9167; val_gene_expr_recon_loss: 11383860.0667; val_masked_gp_l1_reg_loss: 75654.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73653.0547; val_chrom_access_recon_loss: 831538.2417; val_global_loss: 15144173.3333; val_optim_loss: 15144173.3333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9708; val_auprc_score: 0.9612; val_best_acc_score: 0.9245; val_best_f1_score: 0.9277; train_kl_reg_loss: 66167.6373; train_edge_recon_loss: 2684726.0095; train_gene_expr_recon_loss: 11360670.0840; train_masked_gp_l1_reg_loss: 75584.9628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73141.7430; train_chrom_access_recon_loss: 835594.7748; train_global_loss: 15095885.2137; train_optim_loss: 15095885.2137; val_kl_reg_loss: 62881.5477; val_edge_recon_loss: 2696750.2333; val_gene_expr_recon_loss: 11327730.2667; val_masked_gp_l1_reg_loss: 75580.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73138.9922; val_chrom_access_recon_loss: 824218.4792; val_global_loss: 15060300.5333; val_optim_loss: 15060300.5333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9741; val_auprc_score: 0.9664; val_best_acc_score: 0.9237; val_best_f1_score: 0.9270; train_kl_reg_loss: 66020.4084; train_edge_recon_loss: 2682219.5076; train_gene_expr_recon_loss: 11338428.4962; train_masked_gp_l1_reg_loss: 75517.8770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72789.3232; train_chrom_access_recon_loss: 833645.8597; train_global_loss: 15068621.4733; train_optim_loss: 15068621.4733; val_kl_reg_loss: 66437.2297; val_edge_recon_loss: 2681697.5500; val_gene_expr_recon_loss: 11394507.4000; val_masked_gp_l1_reg_loss: 75468.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72782.5859; val_chrom_access_recon_loss: 830542.3667; val_global_loss: 15121435.6000; val_optim_loss: 15121435.6000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9727; val_auprc_score: 0.9623; val_best_acc_score: 0.9252; val_best_f1_score: 0.9281; train_kl_reg_loss: 66040.3821; train_edge_recon_loss: 2675512.2519; train_gene_expr_recon_loss: 11330726.6947; train_masked_gp_l1_reg_loss: 75487.7648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72798.0113; train_chrom_access_recon_loss: 833285.7443; train_global_loss: 15053850.8702; train_optim_loss: 15053850.8702; val_kl_reg_loss: 66217.4906; val_edge_recon_loss: 2678008.1000; val_gene_expr_recon_loss: 11377894.9333; val_masked_gp_l1_reg_loss: 75422.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72722.2031; val_chrom_access_recon_loss: 824045.6250; val_global_loss: 15094310.3333; val_optim_loss: 15094310.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9756; val_auprc_score: 0.9668; val_best_acc_score: 0.9266; val_best_f1_score: 0.9288; train_kl_reg_loss: 65085.1236; train_edge_recon_loss: 2678479.7958; train_gene_expr_recon_loss: 11313870.4275; train_masked_gp_l1_reg_loss: 75391.7971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72696.5457; train_chrom_access_recon_loss: 832300.2605; train_global_loss: 15037824.0305; train_optim_loss: 15037824.0305; val_kl_reg_loss: 63235.7221; val_edge_recon_loss: 2695148.0833; val_gene_expr_recon_loss: 11353113.4667; val_masked_gp_l1_reg_loss: 75187.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72274.3750; val_chrom_access_recon_loss: 829261.4542; val_global_loss: 15088220.6667; val_optim_loss: 15088220.6667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9733; val_auprc_score: 0.9636; val_best_acc_score: 0.9262; val_best_f1_score: 0.9290; train_kl_reg_loss: 65272.7482; train_edge_recon_loss: 2670189.9885; train_gene_expr_recon_loss: 11300478.8779; train_masked_gp_l1_reg_loss: 75210.9588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72568.5134; train_chrom_access_recon_loss: 831580.9905; train_global_loss: 15015302.0534; train_optim_loss: 15015302.0534; val_kl_reg_loss: 66777.7680; val_edge_recon_loss: 2682890.1500; val_gene_expr_recon_loss: 11320037.4667; val_masked_gp_l1_reg_loss: 75128.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73803.6562; val_chrom_access_recon_loss: 826754.7625; val_global_loss: 15045393.1333; val_optim_loss: 15045393.1333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9738; val_auprc_score: 0.9653; val_best_acc_score: 0.9299; val_best_f1_score: 0.9323; train_kl_reg_loss: 64019.2441; train_edge_recon_loss: 2682104.4370; train_gene_expr_recon_loss: 11276489.1985; train_masked_gp_l1_reg_loss: 75081.1568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73301.6803; train_chrom_access_recon_loss: 829955.2347; train_global_loss: 15000950.8931; train_optim_loss: 15000950.8931; val_kl_reg_loss: 67051.8375; val_edge_recon_loss: 2692034.4333; val_gene_expr_recon_loss: 11343404.6667; val_masked_gp_l1_reg_loss: 75056.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73771.6172; val_chrom_access_recon_loss: 824988.7792; val_global_loss: 15076308.4667; val_optim_loss: 15076308.4667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9745; val_auprc_score: 0.9688; val_best_acc_score: 0.9306; val_best_f1_score: 0.9334; train_kl_reg_loss: 63439.8348; train_edge_recon_loss: 2664757.3855; train_gene_expr_recon_loss: 11271270.9008; train_masked_gp_l1_reg_loss: 74976.6255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73173.1692; train_chrom_access_recon_loss: 828779.7433; train_global_loss: 14976397.6565; train_optim_loss: 14976397.6565; val_kl_reg_loss: 62640.7063; val_edge_recon_loss: 2695776.2167; val_gene_expr_recon_loss: 11311118.9333; val_masked_gp_l1_reg_loss: 74900.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73607.6094; val_chrom_access_recon_loss: 823592.1958; val_global_loss: 15041636.2000; val_optim_loss: 15041636.2000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9780; val_auprc_score: 0.9729; val_best_acc_score: 0.9329; val_best_f1_score: 0.9341; train_kl_reg_loss: 63924.9798; train_edge_recon_loss: 2671377.8588; train_gene_expr_recon_loss: 11269452.5878; train_masked_gp_l1_reg_loss: 74797.8777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73472.0500; train_chrom_access_recon_loss: 829020.9413; train_global_loss: 14982046.2748; train_optim_loss: 14982046.2748; val_kl_reg_loss: 63420.3451; val_edge_recon_loss: 2688418.2000; val_gene_expr_recon_loss: 11294040.9333; val_masked_gp_l1_reg_loss: 74707.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74141.9062; val_chrom_access_recon_loss: 823105.6375; val_global_loss: 15017834.8667; val_optim_loss: 15017834.8667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9762; val_auprc_score: 0.9696; val_best_acc_score: 0.9318; val_best_f1_score: 0.9343; train_kl_reg_loss: 63251.2217; train_edge_recon_loss: 2667349.2309; train_gene_expr_recon_loss: 11251672.6336; train_masked_gp_l1_reg_loss: 74615.1804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74112.1508; train_chrom_access_recon_loss: 827688.0267; train_global_loss: 14958688.4809; train_optim_loss: 14958688.4809; val_kl_reg_loss: 62361.2620; val_edge_recon_loss: 2692417.0333; val_gene_expr_recon_loss: 11245911.8000; val_masked_gp_l1_reg_loss: 74547.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74164.9531; val_chrom_access_recon_loss: 818742.2083; val_global_loss: 14968145.5333; val_optim_loss: 14968145.5333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9789; val_auprc_score: 0.9740; val_best_acc_score: 0.9357; val_best_f1_score: 0.9379; train_kl_reg_loss: 63086.3518; train_edge_recon_loss: 2664403.9084; train_gene_expr_recon_loss: 11248072.4504; train_masked_gp_l1_reg_loss: 74521.9843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74305.8176; train_chrom_access_recon_loss: 827486.3793; train_global_loss: 14951876.9771; train_optim_loss: 14951876.9771; val_kl_reg_loss: 63241.0122; val_edge_recon_loss: 2668425.5667; val_gene_expr_recon_loss: 11265329.0000; val_masked_gp_l1_reg_loss: 74271.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74326.0547; val_chrom_access_recon_loss: 820827.4000; val_global_loss: 14966420.1333; val_optim_loss: 14966420.1333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9801; val_auprc_score: 0.9734; val_best_acc_score: 0.9402; val_best_f1_score: 0.9413; train_kl_reg_loss: 61901.7183; train_edge_recon_loss: 2665662.1908; train_gene_expr_recon_loss: 11230189.8244; train_masked_gp_l1_reg_loss: 74306.6477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74457.7734; train_chrom_access_recon_loss: 825499.0964; train_global_loss: 14932017.2443; train_optim_loss: 14932017.2443; val_kl_reg_loss: 63249.6857; val_edge_recon_loss: 2675619.7500; val_gene_expr_recon_loss: 11306496.7333; val_masked_gp_l1_reg_loss: 74362.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75612.8203; val_chrom_access_recon_loss: 821404.0125; val_global_loss: 15016745.1333; val_optim_loss: 15016745.1333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9786; val_auprc_score: 0.9722; val_best_acc_score: 0.9378; val_best_f1_score: 0.9388; train_kl_reg_loss: 63341.0469; train_edge_recon_loss: 2664607.2557; train_gene_expr_recon_loss: 11237331.3282; train_masked_gp_l1_reg_loss: 74231.1236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75078.3064; train_chrom_access_recon_loss: 826889.5716; train_global_loss: 14941478.6336; train_optim_loss: 14941478.6336; val_kl_reg_loss: 63979.4602; val_edge_recon_loss: 2674820.2833; val_gene_expr_recon_loss: 11248883.1333; val_masked_gp_l1_reg_loss: 74065.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75650.8438; val_chrom_access_recon_loss: 820201.9750; val_global_loss: 14957601.8667; val_optim_loss: 14957601.8667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9789; val_auprc_score: 0.9732; val_best_acc_score: 0.9344; val_best_f1_score: 0.9370; train_kl_reg_loss: 62204.5151; train_edge_recon_loss: 2664345.4275; train_gene_expr_recon_loss: 11221418.6794; train_masked_gp_l1_reg_loss: 73976.9482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75423.0570; train_chrom_access_recon_loss: 824846.2424; train_global_loss: 14922214.9084; train_optim_loss: 14922214.9084; val_kl_reg_loss: 60552.9273; val_edge_recon_loss: 2674355.3833; val_gene_expr_recon_loss: 11263574.6000; val_masked_gp_l1_reg_loss: 73821.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75589.8906; val_chrom_access_recon_loss: 817969.9167; val_global_loss: 14965863.8000; val_optim_loss: 14965863.8000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9812; val_auprc_score: 0.9758; val_best_acc_score: 0.9406; val_best_f1_score: 0.9420; train_kl_reg_loss: 61466.5526; train_edge_recon_loss: 2667070.8683; train_gene_expr_recon_loss: 11205443.9618; train_masked_gp_l1_reg_loss: 73716.5343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75409.7794; train_chrom_access_recon_loss: 822906.6336; train_global_loss: 14906014.3664; train_optim_loss: 14906014.3664; val_kl_reg_loss: 60174.5714; val_edge_recon_loss: 2682039.8500; val_gene_expr_recon_loss: 11281770.7333; val_masked_gp_l1_reg_loss: 73566.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76619.7969; val_chrom_access_recon_loss: 818286.1417; val_global_loss: 14992458.2000; val_optim_loss: 14992458.2000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9809; val_auprc_score: 0.9733; val_best_acc_score: 0.9411; val_best_f1_score: 0.9422; train_kl_reg_loss: 61143.2425; train_edge_recon_loss: 2665410.7424; train_gene_expr_recon_loss: 11207249.7786; train_masked_gp_l1_reg_loss: 73559.7420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75994.6425; train_chrom_access_recon_loss: 823273.6073; train_global_loss: 14906631.8168; train_optim_loss: 14906631.8168; val_kl_reg_loss: 61926.3544; val_edge_recon_loss: 2678520.2167; val_gene_expr_recon_loss: 11212554.3333; val_masked_gp_l1_reg_loss: 73332.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75977.1406; val_chrom_access_recon_loss: 815350.2708; val_global_loss: 14917660.0000; val_optim_loss: 14917660.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9777; val_auprc_score: 0.9703; val_best_acc_score: 0.9352; val_best_f1_score: 0.9366; train_kl_reg_loss: 61575.0529; train_edge_recon_loss: 2659024.8588; train_gene_expr_recon_loss: 11197977.7634; train_masked_gp_l1_reg_loss: 73335.6922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76118.9695; train_chrom_access_recon_loss: 823320.4442; train_global_loss: 14891352.8244; train_optim_loss: 14891352.8244; val_kl_reg_loss: 64849.2953; val_edge_recon_loss: 2681399.9167; val_gene_expr_recon_loss: 11232941.9333; val_masked_gp_l1_reg_loss: 73144.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75445.1875; val_chrom_access_recon_loss: 820051.5667; val_global_loss: 14947831.6000; val_optim_loss: 14947831.6000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9812; val_auprc_score: 0.9749; val_best_acc_score: 0.9422; val_best_f1_score: 0.9439; train_kl_reg_loss: 61603.3711; train_edge_recon_loss: 2654570.4237; train_gene_expr_recon_loss: 11182571.8626; train_masked_gp_l1_reg_loss: 73059.8475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76167.9890; train_chrom_access_recon_loss: 821226.8907; train_global_loss: 14869200.3282; train_optim_loss: 14869200.3282; val_kl_reg_loss: 61518.4258; val_edge_recon_loss: 2666341.4333; val_gene_expr_recon_loss: 11263643.6667; val_masked_gp_l1_reg_loss: 73067.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76661.0625; val_chrom_access_recon_loss: 819918.2750; val_global_loss: 14961149.8667; val_optim_loss: 14961149.8667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9831; val_auprc_score: 0.9778; val_best_acc_score: 0.9476; val_best_f1_score: 0.9484; train_kl_reg_loss: 61706.7558; train_edge_recon_loss: 2660322.2156; train_gene_expr_recon_loss: 11182119.0153; train_masked_gp_l1_reg_loss: 72890.0126; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76509.2100; train_chrom_access_recon_loss: 821938.1851; train_global_loss: 14875485.3893; train_optim_loss: 14875485.3893; val_kl_reg_loss: 59020.9237; val_edge_recon_loss: 2669844.0667; val_gene_expr_recon_loss: 11184668.0667; val_masked_gp_l1_reg_loss: 72774.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77549.8750; val_chrom_access_recon_loss: 815004.6792; val_global_loss: 14878861.8000; val_optim_loss: 14878861.8000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9819; val_auprc_score: 0.9751; val_best_acc_score: 0.9421; val_best_f1_score: 0.9430; train_kl_reg_loss: 61589.2568; train_edge_recon_loss: 2649374.1851; train_gene_expr_recon_loss: 11179691.7634; train_masked_gp_l1_reg_loss: 72566.1752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76876.6923; train_chrom_access_recon_loss: 821015.9494; train_global_loss: 14861114.0153; train_optim_loss: 14861114.0153; val_kl_reg_loss: 61542.7268; val_edge_recon_loss: 2669823.3500; val_gene_expr_recon_loss: 11227922.3333; val_masked_gp_l1_reg_loss: 72417.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77022.3281; val_chrom_access_recon_loss: 817600.6125; val_global_loss: 14926329.2000; val_optim_loss: 14926329.2000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9827; val_auprc_score: 0.9748; val_best_acc_score: 0.9438; val_best_f1_score: 0.9455; train_kl_reg_loss: 60315.9105; train_edge_recon_loss: 2654660.2347; train_gene_expr_recon_loss: 11167124.5115; train_masked_gp_l1_reg_loss: 72398.8544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77096.5332; train_chrom_access_recon_loss: 820017.4447; train_global_loss: 14851613.4580; train_optim_loss: 14851613.4580; val_kl_reg_loss: 59811.0706; val_edge_recon_loss: 2669360.4000; val_gene_expr_recon_loss: 11143252.2000; val_masked_gp_l1_reg_loss: 72432.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77824.1484; val_chrom_access_recon_loss: 808833.5583; val_global_loss: 14831514.3333; val_optim_loss: 14831514.3333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9823; val_auprc_score: 0.9768; val_best_acc_score: 0.9444; val_best_f1_score: 0.9464; train_kl_reg_loss: 60386.5383; train_edge_recon_loss: 2656896.7195; train_gene_expr_recon_loss: 11168433.1221; train_masked_gp_l1_reg_loss: 72270.5153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77345.0447; train_chrom_access_recon_loss: 819375.0730; train_global_loss: 14854707.0229; train_optim_loss: 14854707.0229; val_kl_reg_loss: 58740.0138; val_edge_recon_loss: 2662604.1833; val_gene_expr_recon_loss: 11210872.5333; val_masked_gp_l1_reg_loss: 72261.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77726.9062; val_chrom_access_recon_loss: 813622.7042; val_global_loss: 14895828.4667; val_optim_loss: 14895828.4667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9821; val_auprc_score: 0.9779; val_best_acc_score: 0.9442; val_best_f1_score: 0.9460; train_kl_reg_loss: 60303.5022; train_edge_recon_loss: 2648069.9275; train_gene_expr_recon_loss: 11150475.6489; train_masked_gp_l1_reg_loss: 72185.6115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77505.3438; train_chrom_access_recon_loss: 818170.0825; train_global_loss: 14826710.0611; train_optim_loss: 14826710.0611; val_kl_reg_loss: 61656.0138; val_edge_recon_loss: 2672009.8500; val_gene_expr_recon_loss: 11220521.1333; val_masked_gp_l1_reg_loss: 72136.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78032.4062; val_chrom_access_recon_loss: 818696.6583; val_global_loss: 14923052.6000; val_optim_loss: 14923052.6000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9854; val_auprc_score: 0.9817; val_best_acc_score: 0.9499; val_best_f1_score: 0.9505; train_kl_reg_loss: 59543.9677; train_edge_recon_loss: 2654819.4218; train_gene_expr_recon_loss: 11151271.4885; train_masked_gp_l1_reg_loss: 72114.4159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78079.6264; train_chrom_access_recon_loss: 818006.4738; train_global_loss: 14833835.3817; train_optim_loss: 14833835.3817; val_kl_reg_loss: 58656.7544; val_edge_recon_loss: 2656290.1167; val_gene_expr_recon_loss: 11183205.6000; val_masked_gp_l1_reg_loss: 72217.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78225.2344; val_chrom_access_recon_loss: 813429.1042; val_global_loss: 14862024.6000; val_optim_loss: 14862024.6000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9843; val_auprc_score: 0.9788; val_best_acc_score: 0.9495; val_best_f1_score: 0.9508; train_kl_reg_loss: 60018.8712; train_edge_recon_loss: 2657068.1622; train_gene_expr_recon_loss: 11147960.1679; train_masked_gp_l1_reg_loss: 72071.4741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78068.3919; train_chrom_access_recon_loss: 817139.3979; train_global_loss: 14832326.5038; train_optim_loss: 14832326.5038; val_kl_reg_loss: 59368.0039; val_edge_recon_loss: 2663095.1000; val_gene_expr_recon_loss: 11173291.8667; val_masked_gp_l1_reg_loss: 71921.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77903.3672; val_chrom_access_recon_loss: 813431.9458; val_global_loss: 14859011.9333; val_optim_loss: 14859011.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9845; val_auprc_score: 0.9794; val_best_acc_score: 0.9458; val_best_f1_score: 0.9471; train_kl_reg_loss: 60437.8511; train_edge_recon_loss: 2652966.0076; train_gene_expr_recon_loss: 11131219.1603; train_masked_gp_l1_reg_loss: 70815.7934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61734.2120; train_chrom_access_recon_loss: 814640.2071; train_global_loss: 14791813.2595; train_optim_loss: 14791813.2595; val_kl_reg_loss: 61717.1430; val_edge_recon_loss: 2666639.8667; val_gene_expr_recon_loss: 11143323.0000; val_masked_gp_l1_reg_loss: 70442.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58622.4805; val_chrom_access_recon_loss: 807061.0542; val_global_loss: 14807804.9333; val_optim_loss: 14807804.9333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9845; val_auprc_score: 0.9808; val_best_acc_score: 0.9479; val_best_f1_score: 0.9495; train_kl_reg_loss: 62173.6548; train_edge_recon_loss: 2643070.8130; train_gene_expr_recon_loss: 11125294.1603; train_masked_gp_l1_reg_loss: 70359.1322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57993.7145; train_chrom_access_recon_loss: 813986.7323; train_global_loss: 14772878.1450; train_optim_loss: 14772878.1450; val_kl_reg_loss: 63187.9013; val_edge_recon_loss: 2667859.0833; val_gene_expr_recon_loss: 11179795.6667; val_masked_gp_l1_reg_loss: 70298.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57429.9688; val_chrom_access_recon_loss: 813184.9333; val_global_loss: 14851755.6000; val_optim_loss: 14851755.6000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9844; val_auprc_score: 0.9789; val_best_acc_score: 0.9531; val_best_f1_score: 0.9540; train_kl_reg_loss: 63081.6107; train_edge_recon_loss: 2643901.5859; train_gene_expr_recon_loss: 11126420.5344; train_masked_gp_l1_reg_loss: 70277.3787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57138.0587; train_chrom_access_recon_loss: 814431.1627; train_global_loss: 14775250.4046; train_optim_loss: 14775250.4046; val_kl_reg_loss: 63256.6630; val_edge_recon_loss: 2642589.8833; val_gene_expr_recon_loss: 11170786.9333; val_masked_gp_l1_reg_loss: 70234.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56902.3789; val_chrom_access_recon_loss: 810107.9792; val_global_loss: 14813877.7333; val_optim_loss: 14813877.7333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9848; val_auprc_score: 0.9802; val_best_acc_score: 0.9522; val_best_f1_score: 0.9531; train_kl_reg_loss: 62768.9462; train_edge_recon_loss: 2648110.9065; train_gene_expr_recon_loss: 11125977.5191; train_masked_gp_l1_reg_loss: 70218.8136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56615.4369; train_chrom_access_recon_loss: 814941.4490; train_global_loss: 14778633.0687; train_optim_loss: 14778633.0687; val_kl_reg_loss: 63495.7794; val_edge_recon_loss: 2654279.7667; val_gene_expr_recon_loss: 11177816.8667; val_masked_gp_l1_reg_loss: 70209.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56517.8711; val_chrom_access_recon_loss: 811552.0542; val_global_loss: 14833872.4000; val_optim_loss: 14833872.4000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9852; val_auprc_score: 0.9795; val_best_acc_score: 0.9495; val_best_f1_score: 0.9508; train_kl_reg_loss: 62939.3277; train_edge_recon_loss: 2644894.4695; train_gene_expr_recon_loss: 11119458.5038; train_masked_gp_l1_reg_loss: 70190.1336; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56388.3540; train_chrom_access_recon_loss: 814294.3936; train_global_loss: 14768165.2290; train_optim_loss: 14768165.2290; val_kl_reg_loss: 63848.5112; val_edge_recon_loss: 2665402.6833; val_gene_expr_recon_loss: 11190460.0667; val_masked_gp_l1_reg_loss: 70172.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56157.3750; val_chrom_access_recon_loss: 809004.7083; val_global_loss: 14855044.8667; val_optim_loss: 14855044.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9840; val_auprc_score: 0.9771; val_best_acc_score: 0.9495; val_best_f1_score: 0.9507; train_kl_reg_loss: 63048.4251; train_edge_recon_loss: 2652883.4809; train_gene_expr_recon_loss: 11107951.4809; train_masked_gp_l1_reg_loss: 70052.3513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54593.3088; train_chrom_access_recon_loss: 812948.1116; train_global_loss: 14761477.1985; train_optim_loss: 14761477.1985; val_kl_reg_loss: 63638.4714; val_edge_recon_loss: 2651826.9833; val_gene_expr_recon_loss: 11233316.8667; val_masked_gp_l1_reg_loss: 69997.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54283.7305; val_chrom_access_recon_loss: 813172.6917; val_global_loss: 14886235.9333; val_optim_loss: 14886235.9333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9832; val_auprc_score: 0.9775; val_best_acc_score: 0.9458; val_best_f1_score: 0.9475; train_kl_reg_loss: 63174.4607; train_edge_recon_loss: 2641098.6813; train_gene_expr_recon_loss: 11117236.6870; train_masked_gp_l1_reg_loss: 69983.7443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54179.8290; train_chrom_access_recon_loss: 813313.0167; train_global_loss: 14758986.4733; train_optim_loss: 14758986.4733; val_kl_reg_loss: 64038.7341; val_edge_recon_loss: 2664111.9333; val_gene_expr_recon_loss: 11169779.0000; val_masked_gp_l1_reg_loss: 69973.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54088.2617; val_chrom_access_recon_loss: 814363.3833; val_global_loss: 14836354.9333; val_optim_loss: 14836354.9333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9856; val_auprc_score: 0.9790; val_best_acc_score: 0.9510; val_best_f1_score: 0.9523; train_kl_reg_loss: 63298.1977; train_edge_recon_loss: 2640682.4065; train_gene_expr_recon_loss: 11114709.1221; train_masked_gp_l1_reg_loss: 69966.0971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54025.4071; train_chrom_access_recon_loss: 812909.4719; train_global_loss: 14755590.5496; train_optim_loss: 14755590.5496; val_kl_reg_loss: 64075.5208; val_edge_recon_loss: 2649836.0833; val_gene_expr_recon_loss: 11159980.3333; val_masked_gp_l1_reg_loss: 69960.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53964.6055; val_chrom_access_recon_loss: 808718.5625; val_global_loss: 14806536.3333; val_optim_loss: 14806536.3333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9860; val_auprc_score: 0.9801; val_best_acc_score: 0.9542; val_best_f1_score: 0.9554; train_kl_reg_loss: 63641.1740; train_edge_recon_loss: 2646255.5382; train_gene_expr_recon_loss: 11132132.0229; train_masked_gp_l1_reg_loss: 69956.6761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53923.5940; train_chrom_access_recon_loss: 814722.5110; train_global_loss: 14780631.4275; train_optim_loss: 14780631.4275; val_kl_reg_loss: 64492.9044; val_edge_recon_loss: 2653439.9333; val_gene_expr_recon_loss: 11138476.2000; val_masked_gp_l1_reg_loss: 69953.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53870.9453; val_chrom_access_recon_loss: 808665.4583; val_global_loss: 14788898.5333; val_optim_loss: 14788898.5333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9869; val_auprc_score: 0.9823; val_best_acc_score: 0.9526; val_best_f1_score: 0.9540; train_kl_reg_loss: 63573.6567; train_edge_recon_loss: 2640541.2099; train_gene_expr_recon_loss: 11125044.6031; train_masked_gp_l1_reg_loss: 69948.1104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53834.4685; train_chrom_access_recon_loss: 814309.5425; train_global_loss: 14767251.6870; train_optim_loss: 14767251.6870; val_kl_reg_loss: 64097.5503; val_edge_recon_loss: 2655019.2000; val_gene_expr_recon_loss: 11166190.3333; val_masked_gp_l1_reg_loss: 69941.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53795.2188; val_chrom_access_recon_loss: 813227.5583; val_global_loss: 14822271.6667; val_optim_loss: 14822271.6667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9871; val_auprc_score: 0.9828; val_best_acc_score: 0.9530; val_best_f1_score: 0.9538; train_kl_reg_loss: 63597.9433; train_edge_recon_loss: 2640425.6202; train_gene_expr_recon_loss: 11116417.4809; train_masked_gp_l1_reg_loss: 69939.4167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53757.3687; train_chrom_access_recon_loss: 813327.3416; train_global_loss: 14757465.1069; train_optim_loss: 14757465.1069; val_kl_reg_loss: 64114.9102; val_edge_recon_loss: 2657150.1333; val_gene_expr_recon_loss: 11216921.8667; val_masked_gp_l1_reg_loss: 69936.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53714.4297; val_chrom_access_recon_loss: 815788.6458; val_global_loss: 14877626.4667; val_optim_loss: 14877626.4667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9855; val_auprc_score: 0.9810; val_best_acc_score: 0.9508; val_best_f1_score: 0.9518; train_kl_reg_loss: 63742.2237; train_edge_recon_loss: 2646276.3187; train_gene_expr_recon_loss: 11127482.2824; train_masked_gp_l1_reg_loss: 69932.0802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53682.7490; train_chrom_access_recon_loss: 814265.7629; train_global_loss: 14775381.3588; train_optim_loss: 14775381.3588; val_kl_reg_loss: 64313.8760; val_edge_recon_loss: 2657165.4333; val_gene_expr_recon_loss: 11147851.5333; val_masked_gp_l1_reg_loss: 69929.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53651.6055; val_chrom_access_recon_loss: 812660.8792; val_global_loss: 14805573.6000; val_optim_loss: 14805573.6000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9827; val_auprc_score: 0.9763; val_best_acc_score: 0.9453; val_best_f1_score: 0.9467; train_kl_reg_loss: 63743.0185; train_edge_recon_loss: 2645516.5859; train_gene_expr_recon_loss: 11121115.8550; train_masked_gp_l1_reg_loss: 69928.3953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53620.7068; train_chrom_access_recon_loss: 814852.4785; train_global_loss: 14768777.0076; train_optim_loss: 14768777.0076; val_kl_reg_loss: 64737.2206; val_edge_recon_loss: 2669896.2333; val_gene_expr_recon_loss: 11178625.5333; val_masked_gp_l1_reg_loss: 69924.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53596.2969; val_chrom_access_recon_loss: 810637.8667; val_global_loss: 14847416.9333; val_optim_loss: 14847416.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9850; val_auprc_score: 0.9803; val_best_acc_score: 0.9523; val_best_f1_score: 0.9535; train_kl_reg_loss: 63569.5947; train_edge_recon_loss: 2642799.2481; train_gene_expr_recon_loss: 11118354.2061; train_masked_gp_l1_reg_loss: 69912.3961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53443.1811; train_chrom_access_recon_loss: 812842.2347; train_global_loss: 14760920.8550; train_optim_loss: 14760920.8550; val_kl_reg_loss: 64184.6914; val_edge_recon_loss: 2665039.9333; val_gene_expr_recon_loss: 11137481.7333; val_masked_gp_l1_reg_loss: 69906.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53415.8711; val_chrom_access_recon_loss: 810625.7792; val_global_loss: 14800655.0667; val_optim_loss: 14800655.0667
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9841; val_auprc_score: 0.9797; val_best_acc_score: 0.9473; val_best_f1_score: 0.9487; train_kl_reg_loss: 63620.2430; train_edge_recon_loss: 2639518.1069; train_gene_expr_recon_loss: 11124025.1221; train_masked_gp_l1_reg_loss: 69904.9416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53406.5629; train_chrom_access_recon_loss: 814958.1670; train_global_loss: 14765433.2901; train_optim_loss: 14765433.2901; val_kl_reg_loss: 63867.7326; val_edge_recon_loss: 2651593.8167; val_gene_expr_recon_loss: 11180514.8000; val_masked_gp_l1_reg_loss: 69903.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53398.6445; val_chrom_access_recon_loss: 810332.0500; val_global_loss: 14829611.4667; val_optim_loss: 14829611.4667
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9841; val_auprc_score: 0.9756; val_best_acc_score: 0.9512; val_best_f1_score: 0.9529; train_kl_reg_loss: 63666.8343; train_edge_recon_loss: 2644377.1202; train_gene_expr_recon_loss: 11117481.8473; train_masked_gp_l1_reg_loss: 69902.4331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53392.3966; train_chrom_access_recon_loss: 813267.9494; train_global_loss: 14762088.5649; train_optim_loss: 14762088.5649; val_kl_reg_loss: 64177.1385; val_edge_recon_loss: 2654573.6000; val_gene_expr_recon_loss: 11179297.4000; val_masked_gp_l1_reg_loss: 69901.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53385.6602; val_chrom_access_recon_loss: 810180.6458; val_global_loss: 14831515.6667; val_optim_loss: 14831515.6667
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9844; val_auprc_score: 0.9797; val_best_acc_score: 0.9481; val_best_f1_score: 0.9498; train_kl_reg_loss: 63641.8030; train_edge_recon_loss: 2645095.9218; train_gene_expr_recon_loss: 11121033.8092; train_masked_gp_l1_reg_loss: 69901.1030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53379.9142; train_chrom_access_recon_loss: 813815.6904; train_global_loss: 14766868.1832; train_optim_loss: 14766868.1832; val_kl_reg_loss: 64061.8487; val_edge_recon_loss: 2647990.0500; val_gene_expr_recon_loss: 11168662.6667; val_masked_gp_l1_reg_loss: 69900.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53375.5234; val_chrom_access_recon_loss: 815011.3458; val_global_loss: 14819003.0000; val_optim_loss: 14819003.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 39 min 22 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9840
val AUPRC score: 0.9788
val best accuracy score: 0.9479
val best F1 score: 0.9494
val target rna MSE score: 1.1484
val source rna MSE score: 0.3781
val target atac MSE score: 0.4873
val source atac MSE score: 0.1416
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
