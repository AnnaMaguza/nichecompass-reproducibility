[True]
Run timestamp: 24072023_163344_33.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '3000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.0005', '--model_label', 'one-hop-norm_reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.1', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '300', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--edge_batch_size', '4096', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_33']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3396.
Number of gene programs after filtering and combining: 2766.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3011 highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 121068 peaks after filtering  peaks with counts in less than 4 cells.
Keeping 12366 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb, include_chrom_access_recon_loss: True, chrom_access_recon_dist: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.1
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ENCODER -> n_input: 15060, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 2102, n_latent: 2102, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 5388
MASKED CHROMATIN ACCESSIBILITY DECODER -> n_input: 2102, n_cat_covariates_embed_input: 0, n_addon_input: 0, n_output: 24732
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9627; val_auprc_score: 0.9677; val_best_acc_score: 0.5668; val_best_f1_score: 0.6976; train_kl_reg_loss: 3512.6882; train_edge_recon_loss: 3471618.2778; train_gene_expr_recon_loss: 321628.8056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10822806.5556; train_global_loss: 14619566.3333; train_optim_loss: 14619566.3333; val_kl_reg_loss: 6394.2598; val_edge_recon_loss: 4060926.5000; val_gene_expr_recon_loss: 305536.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10455927.0000; val_global_loss: 14828784.0000; val_optim_loss: 14828784.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9423; val_auprc_score: 0.9455; val_best_acc_score: 0.5274; val_best_f1_score: 0.6790; train_kl_reg_loss: 20134.7815; train_edge_recon_loss: 3487167.5833; train_gene_expr_recon_loss: 301497.6736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10670896.8889; train_global_loss: 14479696.7778; train_optim_loss: 14479696.7778; val_kl_reg_loss: 16754.2578; val_edge_recon_loss: 4063225.5000; val_gene_expr_recon_loss: 284632.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10300827.0000; val_global_loss: 14665439.0000; val_optim_loss: 14665439.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9368; val_auprc_score: 0.9384; val_best_acc_score: 0.5131; val_best_f1_score: 0.6725; train_kl_reg_loss: 29336.2747; train_edge_recon_loss: 3500030.9444; train_gene_expr_recon_loss: 282022.2465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10435933.6667; train_global_loss: 14247322.8889; train_optim_loss: 14247322.8889; val_kl_reg_loss: 33288.3945; val_edge_recon_loss: 4064179.2500; val_gene_expr_recon_loss: 265453.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 10113929.0000; val_global_loss: 14476850.0000; val_optim_loss: 14476850.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9300; val_auprc_score: 0.9348; val_best_acc_score: 0.5234; val_best_f1_score: 0.6772; train_kl_reg_loss: 52529.6319; train_edge_recon_loss: 3508940.3056; train_gene_expr_recon_loss: 260678.5712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10247731.3333; train_global_loss: 14069879.8889; train_optim_loss: 14069879.8889; val_kl_reg_loss: 55868.2422; val_edge_recon_loss: 4063615.0000; val_gene_expr_recon_loss: 248967.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9930618.0000; val_global_loss: 14299068.0000; val_optim_loss: 14299068.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9203; val_auprc_score: 0.9218; val_best_acc_score: 0.5659; val_best_f1_score: 0.6971; train_kl_reg_loss: 68284.3932; train_edge_recon_loss: 3516605.2500; train_gene_expr_recon_loss: 247195.4340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10147422.0000; train_global_loss: 13979507.2222; train_optim_loss: 13979507.2222; val_kl_reg_loss: 48033.5547; val_edge_recon_loss: 4061588.7500; val_gene_expr_recon_loss: 240041.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9806049.0000; val_global_loss: 14155713.0000; val_optim_loss: 14155713.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9029; val_auprc_score: 0.9016; val_best_acc_score: 0.6009; val_best_f1_score: 0.7137; train_kl_reg_loss: 74096.0091; train_edge_recon_loss: 3521101.8333; train_gene_expr_recon_loss: 241363.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 10025818.7778; train_global_loss: 13862380.4444; train_optim_loss: 13862380.4444; val_kl_reg_loss: 50327.5625; val_edge_recon_loss: 4059942.0000; val_gene_expr_recon_loss: 233457.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9733592.0000; val_global_loss: 14077320.0000; val_optim_loss: 14077320.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8988; val_auprc_score: 0.8997; val_best_acc_score: 0.6432; val_best_f1_score: 0.7333; train_kl_reg_loss: 77447.7569; train_edge_recon_loss: 3521000.5000; train_gene_expr_recon_loss: 234263.1302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9915994.3333; train_global_loss: 13748705.8889; train_optim_loss: 13748705.8889; val_kl_reg_loss: 63034.4453; val_edge_recon_loss: 4057414.5000; val_gene_expr_recon_loss: 228640.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9670551.0000; val_global_loss: 14019640.0000; val_optim_loss: 14019640.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8942; val_auprc_score: 0.8951; val_best_acc_score: 0.7259; val_best_f1_score: 0.7765; train_kl_reg_loss: 78541.7691; train_edge_recon_loss: 3519700.6667; train_gene_expr_recon_loss: 231547.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9916639.7778; train_global_loss: 13746430.0000; train_optim_loss: 13746430.0000; val_kl_reg_loss: 63284.7266; val_edge_recon_loss: 4050597.5000; val_gene_expr_recon_loss: 225700.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9631670.0000; val_global_loss: 13971253.0000; val_optim_loss: 13971253.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8905; val_auprc_score: 0.8907; val_best_acc_score: 0.7860; val_best_f1_score: 0.8078; train_kl_reg_loss: 78361.8229; train_edge_recon_loss: 3516613.7222; train_gene_expr_recon_loss: 228025.8628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9817707.2222; train_global_loss: 13640708.6667; train_optim_loss: 13640708.6667; val_kl_reg_loss: 79312.6172; val_edge_recon_loss: 4038508.0000; val_gene_expr_recon_loss: 222386.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9602162.0000; val_global_loss: 13942368.0000; val_optim_loss: 13942368.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8863; val_auprc_score: 0.8855; val_best_acc_score: 0.7970; val_best_f1_score: 0.7872; train_kl_reg_loss: 78747.2795; train_edge_recon_loss: 3509613.5000; train_gene_expr_recon_loss: 225457.8038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9870468.5556; train_global_loss: 13684287.2222; train_optim_loss: 13684287.2222; val_kl_reg_loss: 50306.2500; val_edge_recon_loss: 4001649.2500; val_gene_expr_recon_loss: 222270.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9586108.0000; val_global_loss: 13860334.0000; val_optim_loss: 13860334.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8873; val_auprc_score: 0.8805; val_best_acc_score: 0.7854; val_best_f1_score: 0.8089; train_kl_reg_loss: 74091.9657; train_edge_recon_loss: 3505228.7222; train_gene_expr_recon_loss: 224331.8229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9847807.0000; train_global_loss: 13651459.5556; train_optim_loss: 13651459.5556; val_kl_reg_loss: 42016.8828; val_edge_recon_loss: 3897513.7500; val_gene_expr_recon_loss: 222023.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9573268.0000; val_global_loss: 13734822.0000; val_optim_loss: 13734822.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8878; val_auprc_score: 0.8771; val_best_acc_score: 0.7982; val_best_f1_score: 0.8093; train_kl_reg_loss: 60657.6697; train_edge_recon_loss: 3460910.3056; train_gene_expr_recon_loss: 224087.1267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9820514.3333; train_global_loss: 13566169.4444; train_optim_loss: 13566169.4444; val_kl_reg_loss: 49832.8008; val_edge_recon_loss: 3570068.5000; val_gene_expr_recon_loss: 221150.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9584240.0000; val_global_loss: 13425292.0000; val_optim_loss: 13425292.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8608; val_auprc_score: 0.8414; val_best_acc_score: 0.7755; val_best_f1_score: 0.7982; train_kl_reg_loss: 46472.2704; train_edge_recon_loss: 3228799.1667; train_gene_expr_recon_loss: 229308.5712; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9907139.7778; train_global_loss: 13411719.6667; train_optim_loss: 13411719.6667; val_kl_reg_loss: 53536.4062; val_edge_recon_loss: 3069569.2500; val_gene_expr_recon_loss: 227828.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9628239.0000; val_global_loss: 12979173.0000; val_optim_loss: 12979173.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8661; val_auprc_score: 0.8498; val_best_acc_score: 0.7697; val_best_f1_score: 0.8058; train_kl_reg_loss: 90986.6141; train_edge_recon_loss: 2982573.1111; train_gene_expr_recon_loss: 228292.5434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9866545.7778; train_global_loss: 13168398.1111; train_optim_loss: 13168398.1111; val_kl_reg_loss: 109970.1562; val_edge_recon_loss: 2932396.7500; val_gene_expr_recon_loss: 223127.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9583961.0000; val_global_loss: 12849455.0000; val_optim_loss: 12849455.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8802; val_auprc_score: 0.8587; val_best_acc_score: 0.7877; val_best_f1_score: 0.8099; train_kl_reg_loss: 109309.8759; train_edge_recon_loss: 2930274.5000; train_gene_expr_recon_loss: 222931.3490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9786477.1111; train_global_loss: 13048992.7778; train_optim_loss: 13048992.7778; val_kl_reg_loss: 86265.7969; val_edge_recon_loss: 2942952.0000; val_gene_expr_recon_loss: 220866.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9556903.0000; val_global_loss: 12806987.0000; val_optim_loss: 12806987.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8981; val_auprc_score: 0.8737; val_best_acc_score: 0.8142; val_best_f1_score: 0.8285; train_kl_reg_loss: 94882.3819; train_edge_recon_loss: 2899808.5833; train_gene_expr_recon_loss: 224358.2639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9835715.4444; train_global_loss: 13054764.7778; train_optim_loss: 13054764.7778; val_kl_reg_loss: 86786.6250; val_edge_recon_loss: 2891489.5000; val_gene_expr_recon_loss: 220684.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9558992.0000; val_global_loss: 12757953.0000; val_optim_loss: 12757953.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9133; val_auprc_score: 0.8893; val_best_acc_score: 0.8402; val_best_f1_score: 0.8498; train_kl_reg_loss: 95502.6007; train_edge_recon_loss: 2869214.5556; train_gene_expr_recon_loss: 222547.1319; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9771835.3333; train_global_loss: 12959099.7778; train_optim_loss: 12959099.7778; val_kl_reg_loss: 91889.1250; val_edge_recon_loss: 2895150.0000; val_gene_expr_recon_loss: 218704.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9530632.0000; val_global_loss: 12736375.0000; val_optim_loss: 12736375.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9250; val_auprc_score: 0.9036; val_best_acc_score: 0.8599; val_best_f1_score: 0.8673; train_kl_reg_loss: 98746.1345; train_edge_recon_loss: 2839868.7222; train_gene_expr_recon_loss: 221641.2743; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9752765.4444; train_global_loss: 12913021.4444; train_optim_loss: 12913021.4444; val_kl_reg_loss: 89565.0312; val_edge_recon_loss: 2812003.7500; val_gene_expr_recon_loss: 219125.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9525031.0000; val_global_loss: 12645725.0000; val_optim_loss: 12645725.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9283; val_auprc_score: 0.9047; val_best_acc_score: 0.8618; val_best_f1_score: 0.8680; train_kl_reg_loss: 101288.9792; train_edge_recon_loss: 2810094.3056; train_gene_expr_recon_loss: 220754.1372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9716440.0000; train_global_loss: 12848577.3333; train_optim_loss: 12848577.3333; val_kl_reg_loss: 98505.7656; val_edge_recon_loss: 2844176.2500; val_gene_expr_recon_loss: 217129.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9498420.0000; val_global_loss: 12658232.0000; val_optim_loss: 12658232.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9336; val_auprc_score: 0.9137; val_best_acc_score: 0.8676; val_best_f1_score: 0.8762; train_kl_reg_loss: 101012.9245; train_edge_recon_loss: 2802407.0556; train_gene_expr_recon_loss: 219763.5226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9736688.7778; train_global_loss: 12859872.2222; train_optim_loss: 12859872.2222; val_kl_reg_loss: 92637.5391; val_edge_recon_loss: 2818880.0000; val_gene_expr_recon_loss: 217065.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9505055.0000; val_global_loss: 12633638.0000; val_optim_loss: 12633638.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9397; val_auprc_score: 0.9194; val_best_acc_score: 0.8786; val_best_f1_score: 0.8833; train_kl_reg_loss: 98457.1319; train_edge_recon_loss: 2788123.3611; train_gene_expr_recon_loss: 218812.2830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9726291.4444; train_global_loss: 12831684.1111; train_optim_loss: 12831684.1111; val_kl_reg_loss: 91464.6719; val_edge_recon_loss: 2800166.2500; val_gene_expr_recon_loss: 216796.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9493406.0000; val_global_loss: 12601834.0000; val_optim_loss: 12601834.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9454; val_auprc_score: 0.9272; val_best_acc_score: 0.8841; val_best_f1_score: 0.8889; train_kl_reg_loss: 96579.7361; train_edge_recon_loss: 2789723.8333; train_gene_expr_recon_loss: 219495.9427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9693570.2222; train_global_loss: 12799369.5556; train_optim_loss: 12799369.5556; val_kl_reg_loss: 91754.7969; val_edge_recon_loss: 2801720.5000; val_gene_expr_recon_loss: 215520.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9468721.0000; val_global_loss: 12577717.0000; val_optim_loss: 12577717.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9525; val_auprc_score: 0.9359; val_best_acc_score: 0.8953; val_best_f1_score: 0.8994; train_kl_reg_loss: 95331.8247; train_edge_recon_loss: 2782375.0556; train_gene_expr_recon_loss: 217768.5382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9684403.5556; train_global_loss: 12779879.0000; train_optim_loss: 12779879.0000; val_kl_reg_loss: 88575.2969; val_edge_recon_loss: 2769849.2500; val_gene_expr_recon_loss: 215205.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9469433.0000; val_global_loss: 12543064.0000; val_optim_loss: 12543064.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9540; val_auprc_score: 0.9395; val_best_acc_score: 0.8954; val_best_f1_score: 0.9004; train_kl_reg_loss: 92461.2014; train_edge_recon_loss: 2761731.2500; train_gene_expr_recon_loss: 219014.9618; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9693527.1111; train_global_loss: 12766734.6667; train_optim_loss: 12766734.6667; val_kl_reg_loss: 87978.8750; val_edge_recon_loss: 2777954.7500; val_gene_expr_recon_loss: 215548.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9469759.0000; val_global_loss: 12551241.0000; val_optim_loss: 12551241.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9503; val_auprc_score: 0.9315; val_best_acc_score: 0.8941; val_best_f1_score: 0.8992; train_kl_reg_loss: 93438.3203; train_edge_recon_loss: 2768235.7222; train_gene_expr_recon_loss: 218353.6753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9708693.2222; train_global_loss: 12788721.1111; train_optim_loss: 12788721.1111; val_kl_reg_loss: 90730.7500; val_edge_recon_loss: 2787496.7500; val_gene_expr_recon_loss: 213958.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9458391.0000; val_global_loss: 12550577.0000; val_optim_loss: 12550577.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9449; val_auprc_score: 0.9273; val_best_acc_score: 0.8871; val_best_f1_score: 0.8944; train_kl_reg_loss: 115759.9444; train_edge_recon_loss: 2888982.0833; train_gene_expr_recon_loss: 223873.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9756244.1111; train_global_loss: 12984859.7778; train_optim_loss: 12984859.7778; val_kl_reg_loss: 39114.4688; val_edge_recon_loss: 2849396.7500; val_gene_expr_recon_loss: 220832.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9491154.0000; val_global_loss: 12600498.0000; val_optim_loss: 12600498.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9544; val_auprc_score: 0.9389; val_best_acc_score: 0.8957; val_best_f1_score: 0.9010; train_kl_reg_loss: 129512.1997; train_edge_recon_loss: 2813405.3889; train_gene_expr_recon_loss: 222350.6076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9717317.7778; train_global_loss: 12882585.8889; train_optim_loss: 12882585.8889; val_kl_reg_loss: 37660.4570; val_edge_recon_loss: 2816921.7500; val_gene_expr_recon_loss: 220075.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9499846.0000; val_global_loss: 12574504.0000; val_optim_loss: 12574504.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9552; val_auprc_score: 0.9388; val_best_acc_score: 0.8987; val_best_f1_score: 0.9041; train_kl_reg_loss: 110956.7439; train_edge_recon_loss: 2799071.0000; train_gene_expr_recon_loss: 221095.5122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9709719.3333; train_global_loss: 12840842.4444; train_optim_loss: 12840842.4444; val_kl_reg_loss: 38559.3750; val_edge_recon_loss: 2825217.5000; val_gene_expr_recon_loss: 218801.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9480538.0000; val_global_loss: 12563116.0000; val_optim_loss: 12563116.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9559; val_auprc_score: 0.9412; val_best_acc_score: 0.8975; val_best_f1_score: 0.9013; train_kl_reg_loss: 111647.1024; train_edge_recon_loss: 2805887.7500; train_gene_expr_recon_loss: 221804.9774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9699978.5556; train_global_loss: 12839318.3333; train_optim_loss: 12839318.3333; val_kl_reg_loss: 38029.3516; val_edge_recon_loss: 2808781.0000; val_gene_expr_recon_loss: 219111.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9488143.0000; val_global_loss: 12554065.0000; val_optim_loss: 12554065.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9557; val_auprc_score: 0.9410; val_best_acc_score: 0.8961; val_best_f1_score: 0.9015; train_kl_reg_loss: 110162.2595; train_edge_recon_loss: 2802034.9444; train_gene_expr_recon_loss: 221583.2882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9690371.3333; train_global_loss: 12824152.0000; train_optim_loss: 12824152.0000; val_kl_reg_loss: 38741.8828; val_edge_recon_loss: 2810356.5000; val_gene_expr_recon_loss: 218949.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9491744.0000; val_global_loss: 12559792.0000; val_optim_loss: 12559792.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9566; val_auprc_score: 0.9391; val_best_acc_score: 0.8983; val_best_f1_score: 0.9035; train_kl_reg_loss: 109962.2465; train_edge_recon_loss: 2803683.3611; train_gene_expr_recon_loss: 221549.7101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9741445.5556; train_global_loss: 12876640.8889; train_optim_loss: 12876640.8889; val_kl_reg_loss: 39239.7383; val_edge_recon_loss: 2790793.7500; val_gene_expr_recon_loss: 218601.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9483250.0000; val_global_loss: 12531886.0000; val_optim_loss: 12531886.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9574; val_auprc_score: 0.9421; val_best_acc_score: 0.9020; val_best_f1_score: 0.9076; train_kl_reg_loss: 108820.0582; train_edge_recon_loss: 2798070.4444; train_gene_expr_recon_loss: 221013.4097; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9691643.5556; train_global_loss: 12819547.4444; train_optim_loss: 12819547.4444; val_kl_reg_loss: 39481.8281; val_edge_recon_loss: 2806168.2500; val_gene_expr_recon_loss: 218687.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9477795.0000; val_global_loss: 12542132.0000; val_optim_loss: 12542132.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9526; val_auprc_score: 0.9371; val_best_acc_score: 0.8928; val_best_f1_score: 0.8994; train_kl_reg_loss: 107695.3785; train_edge_recon_loss: 2798086.7500; train_gene_expr_recon_loss: 220801.5885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9716769.2222; train_global_loss: 12843352.8889; train_optim_loss: 12843352.8889; val_kl_reg_loss: 39720.3359; val_edge_recon_loss: 2835472.2500; val_gene_expr_recon_loss: 218512.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9460398.0000; val_global_loss: 12554103.0000; val_optim_loss: 12554103.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9601; val_auprc_score: 0.9489; val_best_acc_score: 0.9016; val_best_f1_score: 0.9062; train_kl_reg_loss: 105687.5694; train_edge_recon_loss: 2800284.5556; train_gene_expr_recon_loss: 219759.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9662676.6667; train_global_loss: 12788408.0000; train_optim_loss: 12788408.0000; val_kl_reg_loss: 40218.2344; val_edge_recon_loss: 2813446.7500; val_gene_expr_recon_loss: 218642.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9482479.0000; val_global_loss: 12554787.0000; val_optim_loss: 12554787.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9552; val_auprc_score: 0.9414; val_best_acc_score: 0.8977; val_best_f1_score: 0.9030; train_kl_reg_loss: 104785.0634; train_edge_recon_loss: 2792275.1944; train_gene_expr_recon_loss: 222699.1493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9703712.8889; train_global_loss: 12823472.3333; train_optim_loss: 12823472.3333; val_kl_reg_loss: 40143.9922; val_edge_recon_loss: 2825392.2500; val_gene_expr_recon_loss: 218571.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9471467.0000; val_global_loss: 12555575.0000; val_optim_loss: 12555575.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9596; val_auprc_score: 0.9469; val_best_acc_score: 0.9056; val_best_f1_score: 0.9097; train_kl_reg_loss: 103594.3481; train_edge_recon_loss: 2785830.9167; train_gene_expr_recon_loss: 221529.4115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9744648.5556; train_global_loss: 12855603.1111; train_optim_loss: 12855603.1111; val_kl_reg_loss: 40198.6758; val_edge_recon_loss: 2781634.0000; val_gene_expr_recon_loss: 218819.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9471227.0000; val_global_loss: 12511880.0000; val_optim_loss: 12511880.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9562; val_auprc_score: 0.9394; val_best_acc_score: 0.8983; val_best_f1_score: 0.9033; train_kl_reg_loss: 103352.1302; train_edge_recon_loss: 2782255.6389; train_gene_expr_recon_loss: 221069.0243; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9684189.0000; train_global_loss: 12790865.6667; train_optim_loss: 12790865.6667; val_kl_reg_loss: 40117.9375; val_edge_recon_loss: 2810385.2500; val_gene_expr_recon_loss: 218773.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9480346.0000; val_global_loss: 12549622.0000; val_optim_loss: 12549622.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9587; val_auprc_score: 0.9471; val_best_acc_score: 0.8991; val_best_f1_score: 0.9034; train_kl_reg_loss: 103251.6172; train_edge_recon_loss: 2789353.4722; train_gene_expr_recon_loss: 221089.9028; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9655474.2222; train_global_loss: 12769169.2222; train_optim_loss: 12769169.2222; val_kl_reg_loss: 40312.9883; val_edge_recon_loss: 2818735.7500; val_gene_expr_recon_loss: 218798.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9478240.0000; val_global_loss: 12556088.0000; val_optim_loss: 12556088.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9572; val_auprc_score: 0.9405; val_best_acc_score: 0.9029; val_best_f1_score: 0.9072; train_kl_reg_loss: 103245.3984; train_edge_recon_loss: 2799684.9722; train_gene_expr_recon_loss: 221597.4340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9704861.4444; train_global_loss: 12829389.4444; train_optim_loss: 12829389.4444; val_kl_reg_loss: 40254.0000; val_edge_recon_loss: 2800944.7500; val_gene_expr_recon_loss: 218652.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9470084.0000; val_global_loss: 12529935.0000; val_optim_loss: 12529935.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9565; val_auprc_score: 0.9402; val_best_acc_score: 0.9015; val_best_f1_score: 0.9061; train_kl_reg_loss: 102612.4575; train_edge_recon_loss: 2787746.4444; train_gene_expr_recon_loss: 220903.0052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9674873.1111; train_global_loss: 12786135.2222; train_optim_loss: 12786135.2222; val_kl_reg_loss: 40345.8086; val_edge_recon_loss: 2790704.0000; val_gene_expr_recon_loss: 218557.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9469948.0000; val_global_loss: 12519555.0000; val_optim_loss: 12519555.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9600; val_auprc_score: 0.9446; val_best_acc_score: 0.9033; val_best_f1_score: 0.9062; train_kl_reg_loss: 102846.5017; train_edge_recon_loss: 2784465.4722; train_gene_expr_recon_loss: 220998.2361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9693378.0000; train_global_loss: 12801688.4444; train_optim_loss: 12801688.4444; val_kl_reg_loss: 40457.8125; val_edge_recon_loss: 2792424.5000; val_gene_expr_recon_loss: 218711.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9482832.0000; val_global_loss: 12534426.0000; val_optim_loss: 12534426.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9571; val_auprc_score: 0.9442; val_best_acc_score: 0.8984; val_best_f1_score: 0.9034; train_kl_reg_loss: 102818.7109; train_edge_recon_loss: 2792627.0278; train_gene_expr_recon_loss: 221539.8455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9731719.5556; train_global_loss: 12848705.2222; train_optim_loss: 12848705.2222; val_kl_reg_loss: 40330.4219; val_edge_recon_loss: 2807875.0000; val_gene_expr_recon_loss: 218718.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9475170.0000; val_global_loss: 12542094.0000; val_optim_loss: 12542094.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9559; val_auprc_score: 0.9420; val_best_acc_score: 0.8995; val_best_f1_score: 0.9053; train_kl_reg_loss: 102766.6415; train_edge_recon_loss: 2792411.1944; train_gene_expr_recon_loss: 219826.8264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9665508.5556; train_global_loss: 12780513.1111; train_optim_loss: 12780513.1111; val_kl_reg_loss: 40566.4609; val_edge_recon_loss: 2809083.5000; val_gene_expr_recon_loss: 218742.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9487132.0000; val_global_loss: 12555524.0000; val_optim_loss: 12555524.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9601; val_auprc_score: 0.9486; val_best_acc_score: 0.9014; val_best_f1_score: 0.9066; train_kl_reg_loss: 102716.1892; train_edge_recon_loss: 2792097.5000; train_gene_expr_recon_loss: 220996.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_chrom_access_recon_loss: 9712250.1111; train_global_loss: 12828060.3333; train_optim_loss: 12828060.3333; val_kl_reg_loss: 40359.2773; val_edge_recon_loss: 2800903.2500; val_gene_expr_recon_loss: 218466.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_chrom_access_recon_loss: 9466824.0000; val_global_loss: 12526553.0000; val_optim_loss: 12526553.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 3 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.9570
Val AUPRC score: 0.9404
Val best accuracy score: 0.9025
Val best F1 score: 0.9070
Val gene expr MSE score: 0.5218
Val chrom access MSE score: 0.0829
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
